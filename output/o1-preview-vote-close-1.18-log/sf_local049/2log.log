2025-01-18 16:52:19 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 16:53:11 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 16:53:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:53:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:53:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:53:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 15
2025-01-18 16:53:12 - snowflake.connector.connection - INFO - closed
2025-01-18 16:53:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:53:13 - root - INFO - SQL:
SELECT DISTINCT "industry"
   FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES"
   LIMIT 1000;
Results:
industry
Fintech
Internet software & services
E-commerce & direct-to-consumer
Health
Consumer & retail
Hardware
Other
Mobile & telecommunications
Artificial intelligence
Auto & transportation
Cybersecurity
Data management & analytics
Edtech
"""Supply chain, logistics, & delivery"""
Travel

2025-01-18 16:53:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:53:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:53:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:53:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 16:53:14 - snowflake.connector.connection - INFO - closed
2025-01-18 16:53:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:53:15 - root - INFO - SQL:
SELECT "company_id", "valuation"
   FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING"
   WHERE "valuation" >= 1000000000
   LIMIT 1000;
Results:
Too long, hard cut:
company_id,valuation
548,2000000000
645,1000000000
615,1000000000
51,10000000000
680,1000000000
457,2000000000
429,2000000000
933,1000000000
568,2000000000
478,2000000000
881,1000000000
189,4000000000
848,1000000000
556,2000000000
999,1000000000
396,2000000000
931,1000000000
364,2000000000
732,1000000000
906,1000000000
72,8000000000
983,1000000000
898,1000000000
844,1000000000
894,1000000000
813,1000000000
743,1000000000
226,4000000000
963,1000000000
764,1000000000
839,1000000000
1033,1000000000
725,1000000000
549,2000000000
667,1000000000
755,1000000000
782,1000000000
175,4000000000
398,2000000000
814,1000000000
436,2000000000
1046,1000000000
565,2000000000
781,1000000000
997,1000000000
194,4000000000
249,3000000000
434,2000000000
1035,1000000000
969,1000000000
1018,1000000000
355,2000000000
934,1000000000
1054,1000000000
901,1000000000
173,4000000000
738,1000000000
422,2000000000
830,1000000000
1004,1000000000
951,1000000000
734,1000000000
1063,1000000000
623,1000000000
846,1000000000
823,1000000000
944,1000000000
1030,1000000000
824,1000000000
930,1000000000
370,2000000000
618,1000000000
456,2000000000
893,1000000000
812,1000000000
1001,1000000000
703,1000000000
884,1000000000
404,2000000000
952,1000000000
625,1000000000
971,1000000000
796,1000000000
909,1000000000
587,2000000000
273,3000000000
771,1000000000
1005,1000000000
758,1000000000
652,1000000000
8,38000000000
760,1000000000
394,2000000000
393,2000000000
870,1000000000
804,1000000000
1041,1000000000
443,2000000000
978,1000000000
612,1000000000
714,1000000000
925,1000000000
421,2000000000
449,2000000000
1022,1000000000
240,3000000000
644,1000000000
718,1000000000
920,1000000000
1048,1000000000
1024,1000000000
929,1000000000
751,1000000000
1012,1000000000
863,1000000000
662,1000000000
1027,1000000000
783,1000000000
592,2000000000
1023,1000000000
1051,1000000000
633,1000000000
635,1000000000
750,1000000000
697,1000000000
886,1000000000
826,1000000000
1000,1000000000
740,1000000000
798,1000000000
1008,1000000000
761,1000000000
701,1000000000
825,1000000000
344,3000000000
695,1000000000
876,1000000000
643,1000000000
509,2000000000
979,1000000000
1031,1000000000
817,1000000000
943,1000000000
975,1000000000
647,1000000000
426,2000000000
705,1000000000
724,1000000000
464,2000000000
942,1000000000
354,3000000000
688,1000000000
1045,1000000000
391,2000000000
891,1000000000
1066,1000000000
579,2000000000
686,1000000000
822,1000000000
882,1000000000
816,1000000000
369,2000000000
340,3000000000
1058,1000000000
129,5000000000
862,1000000000
363,2000000000
603,1000000000
645,1000000000
769,1000000000
788,1000000000
452,2000000000
420,2000000000
996,1000000000
763,1000000000
803,1000000000
765,1000000000
989,1000000000
409,2000000000
580,2000000000
513,2000000000
809,1000000000
791,1000000000
998,1000000000
455,2000000000
477,2000000000
896,1000000000
797,1000000000
361,2000000000
250,3000000000
229,4000000000
540,2000000000
73,8000000000
852,1000000000
78,8000000000
79,8000000000
632,1000000000
314,3000000000
82,8000000000
164,5000000000
85,7000000000
212,4000000000
65,9000000000
258,3000000000
63,9000000000
58,10000000000
31,12000000000
248,3000000000
32,12000000000
252,3000000000
33,12000000000
287,3000000000
251,3000000000
243,3000000000
40,11000000000
44,11000000000
45,11000000000
211,4000000000
50,10000000000
53,10000000000
285,3000000000
217,4000000000
134,5000000000
317,3000000000
365,2000000000
91,7000000000
185,4000000000
121,6000000000
335,3000000000
1014,1000000000
191,4000000000
334,3000000000
118,6000000000
115,6000000000
113,6000000000
147,5000000000
136,5000000000
130,5000000000
321,3000000000
327,3000000000
641,1000000000
352,3000000000
972,1000000000
201,4000000000
168,4000000000
104,6000000000
171,4000000000
350,3000000000
101,7000000000
239,4000000000
1065,1000000000
938,1000000000
828,1000000000
941,1000000000
988,1000000000
484,2000000000
864,1000000000
383,2000000000
1060,1000000000
595,2000000000
840,1000000000
290,3000000000
742,1000000000
964,1000000000
712,1000000000
837,1000000000
583,2000000000
411,2000000000
430,2000000000
875,1000000000
810,1000000000
805,1000000000
953,1000000000
606,1000000000
679,1000000000
907,1000000000
880,1000000000
834,1000000000
542,2000000000
1043,1000000000
410,2000000000
637,1000000000
616,1000000000
611,1000000000
1064,1000000000
1032,1000000000
737,1000000000
374,2000000000
172,4000000000
414,2000000000
845,1000000000
1055,1000000000
416,2000000000
682,1000000000
967,1000000000
551,2000000000
491,2000000000
446,2000000000
982,1000000000
850,1000000000
928,1000000000
380,2000000000
451,2000000000
987,1000000000
842,1000000000
620,1000000000
356,2000000000
872,1000000000
417,2000000000
427,2000000000
255,3000000000
397,2000000000
857,1000000000
588,2000000000
609,1000000000
619,1000000000
681,1000000000
489,2000000000
626,1000000000
649,1000000000
234,4000000000
770,1000000000
614,1000000000
482,2000000000
968,1000000000
899,1000000000
386,2000000000
665,1000000000
1039,1000000000
800,1000000000
457,200

2025-01-18 16:53:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:53:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:53:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:53:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 16:53:16 - snowflake.connector.connection - INFO - closed
2025-01-18 16:53:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:53:16 - root - INFO - SQL:
SELECT "company_id", "date_joined"
   FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES"
   LIMIT 1000;
Results:
Too long, hard cut:
company_id,date_joined
109,2020-09-08T00:00:00.000
821,2019-05-16T00:00:00.000
153,2019-07-11T00:00:00.000
972,2018-10-17T00:00:00.000
1022,2021-06-02T00:00:00.000
433,2021-04-17T00:00:00.000
747,2018-03-27T00:00:00.000
902,2021-01-27T00:00:00.000
1065,2021-06-01T00:00:00.000
388,2018-05-30T00:00:00.000
748,2019-02-14T00:00:00.000
189,2017-06-24T00:00:00.000
848,2021-06-01T00:00:00.000
556,2022-02-15T00:00:00.000
999,2021-11-17T00:00:00.000
396,2021-10-21T00:00:00.000
931,2021-09-24T00:00:00.000
364,2019-02-01T00:00:00.000
732,2022-01-27T00:00:00.000
906,2021-06-10T00:00:00.000
72,2015-01-23T00:00:00.000
983,2019-08-22T00:00:00.000
898,2022-01-25T00:00:00.000
844,2021-07-07T00:00:00.000
894,2021-12-06T00:00:00.000
813,2021-08-10T00:00:00.000
743,2020-12-24T00:00:00.000
226,2021-01-24T00:00:00.000
963,2021-10-05T00:00:00.000
764,2021-12-07T00:00:00.000
839,2021-12-28T00:00:00.000
1033,2021-01-27T00:00:00.000
725,2022-01-25T00:00:00.000
549,2021-09-22T00:00:00.000
667,2015-01-16T00:00:00.000
755,2021-09-08T00:00:00.000
782,2022-01-31T00:00:00.000
175,2019-06-25T00:00:00.000
398,2021-10-15T00:00:00.000
814,2021-11-16T00:00:00.000
436,2017-04-14T00:00:00.000
1046,2021-06-16T00:00:00.000
565,2021-04-21T00:00:00.000
781,2021-08-31T00:00:00.000
997,2021-12-06T00:00:00.000
194,2021-03-18T00:00:00.000
249,2021-06-29T00:00:00.000
434,2021-05-19T00:00:00.000
1035,2021-11-18T00:00:00.000
969,2022-01-26T00:00:00.000
1018,2021-02-18T00:00:00.000
355,2021-09-14T00:00:00.000
934,2020-03-17T00:00:00.000
1054,2021-05-18T00:00:00.000
901,2021-11-08T00:00:00.000
173,2021-12-20T00:00:00.000
738,2022-01-11T00:00:00.000
422,2022-02-16T00:00:00.000
830,2021-03-30T00:00:00.000
1004,2021-05-24T00:00:00.000
951,2015-03-06T00:00:00.000
734,2022-01-27T00:00:00.000
1063,2021-11-10T00:00:00.000
623,2015-04-21T00:00:00.000
846,2019-10-21T00:00:00.000
823,2019-05-21T00:00:00.000
944,2021-07-22T00:00:00.000
1030,2021-08-09T00:00:00.000
824,2016-04-14T00:00:00.000
930,2022-02-22T00:00:00.000
370,2018-07-09T00:00:00.000
618,2018-10-18T00:00:00.000
456,2020-01-29T00:00:00.000
893,2021-09-02T00:00:00.000
812,2022-03-31T00:00:00.000
1001,2020-09-21T00:00:00.000
703,2021-12-02T00:00:00.000
884,2021-12-14T00:00:00.000
404,2021-03-19T00:00:00.000
952,2022-03-30T00:00:00.000
625,2020-01-28T00:00:00.000
971,2021-11-02T00:00:00.000
796,2017-07-20T00:00:00.000
909,2022-01-27T00:00:00.000
587,2018-05-17T00:00:00.000
273,2022-04-05T00:00:00.000
771,2021-09-28T00:00:00.000
758,2021-12-21T00:00:00.000
652,2021-06-15T00:00:00.000
8,2017-12-20T00:00:00.000
760,2020-11-17T00:00:00.000
394,2022-01-31T00:00:00.000
393,2021-09-27T00:00:00.000
870,2021-02-16T00:00:00.000
804,2021-09-16T00:00:00.000
1041,2021-11-02T00:00:00.000
443,2022-03-17T00:00:00.000
978,2021-01-07T00:00:00.000
612,2021-12-31T00:00:00.000
714,2017-10-17T00:00:00.000
925,2022-03-21T00:00:00.000
421,2020-11-16T00:00:00.000
449,2021-07-03T00:00:00.000
1022,2021-06-02T00:00:00.000
240,2016-05-11T00:00:00.000
644,2021-01-25T00:00:00.000
718,2021-09-30T00:00:00.000
920,2021-08-10T00:00:00.000
1048,2021-09-30T00:00:00.000
1024,2021-04-22T00:00:00.000
929,2021-12-22T00:00:00.000
751,2022-01-13T00:00:00.000
1012,2017-10-23T00:00:00.000
863,2021-12-07T00:00:00.000
662,2020-12-21T00:00:00.000
1027,2021-06-24T00:00:00.000
783,2021-03-26T00:00:00.000
592,2021-11-17T00:00:00.000
1023,2021-01-26T00:00:00.000
1051,2021-11-03T00:00:00.000
633,2021-04-07T00:00:00.000
635,2021-06-02T00:00:00.000
750,2022-01-26T00:00:00.000
697,2021-12-20T00:00:00.000
886,2021-03-30T00:00:00.000
826,2022-01-13T00:00:00.000
1000,2022-01-12T00:00:00.000
740,2022-03-16T00:00:00.000
798,2021-02-11T00:00:00.000
1008,2021-11-08T00:00:00.000
761,2022-02-28T00:00:00.000
701,2020-12-31T00:00:00.000
825,2021-10-13T00:00:00.000
344,2021-06-29T00:00:00.000
695,2022-01-11T00:00:00.000
876,2018-11-06T00:00:00.000
643,2021-12-15T00:00:00.000
509,2021-08-04T00:00:00.000
979,2021-02-25T00:00:00.000
1031,2021-10-07T00:00:00.000
817,2021-05-04T00:00:00.000
943,2019-03-22T00:00:00.000
975,2021-04-30T00:00:00.000
647,2020-12-10T00:00:00.000
426,2022-01-26T00:00:00.000
705,2021-12-07T00:00:00.000
724,2022-01-24T00:00:00.000
464,2022-03-17T00:00:00.000
942,2021-04-20T00:00:00.000
354,2019-12-05T00:00:00.000
688,2019-05-15T00:00:00.000
1045,2022-02-22T00:00:00.000
391,2021-12-17T00:00:00.000
891,2022-02-22T00:00:00.000
1066,2017-09-21T00:00:00.000
579,2021-10-06T00:00:00.000
686,2021-07-28T00:00:00.000
822,2021-12-28T00:00:00.000
882,2021-06-16T00:00:00.000
816,2022-02-22T00:00:00.000
369,2021-03-01T00:00:00.000
340,2022-01-13T00:00:00.000
1058,2019-05-07T00:00:00.000
129,2020-09-29T00:00:00.000
862,2021-07-13T00:00:00.000
363,2017-10-30T00:00:00.000
603,2021-01-25T00:00:00.000
645,2021-05-06T00:00:00.000
769,2021-05-18T00:00:00.000
788,2022-01-12T00:00:00.000
452,2021-06-08T00:00:00.000
420,2022-01-04T00:00:00.000
996,2022-01-11T00:00:00.000
763,2021-05-07T00:00:00.000
803,2022-02-08T00:00:00.000
765,2021-06-03T00:00:00.000
989,2020-06-17T00:00:00.000

2025-01-18 16:53:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:53:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:53:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:53:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 16:53:17 - snowflake.connector.connection - INFO - closed
2025-01-18 16:53:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:53:43 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 16:53:43 - root - INFO - ```sql
SELECT i."industry", COUNT(*) AS "unicorn_count"
FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
  ON i."company_id" = d."company_id"
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
  ON i."company_id" = f."company_id"
WHERE f."valuation" >= 1000000000
  AND TRY_TO_TIMESTAMP(d."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3') BETWEEN '2019-01-01' AND '2021-12-31'
GROUP BY i."industry"
ORDER BY "unicorn_count" DESC
LIMIT 1000;
```
2025-01-18 16:53:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:53:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:53:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:53:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 15
2025-01-18 16:53:45 - snowflake.connector.connection - INFO - closed
2025-01-18 16:53:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:53:45 - root - INFO - SQL:
SELECT i."industry", COUNT(*) AS "unicorn_count"
FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
  ON i."company_id" = d."company_id"
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
  ON i."company_id" = f."company_id"
WHERE f."valuation" >= 1000000000
  AND TRY_TO_TIMESTAMP(d."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3') BETWEEN '2019-01-01' AND '2021-12-31'
GROUP BY i."industry"
ORDER BY "unicorn_count" DESC
LIMIT 1000;
Results:
industry,unicorn_count
Fintech,181
Internet software & services,157
E-commerce & direct-to-consumer,76
Health,53
Artificial intelligence,53
Other,44
Cybersecurity,38
"""Supply chain, logistics, & delivery""",36
Data management & analytics,31
Mobile & telecommunications,18
Edtech,17
Auto & transportation,16
Hardware,15
Consumer & retail,11
Travel,7

2025-01-18 16:53:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:53:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:53:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:53:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 16:53:47 - snowflake.connector.connection - INFO - closed
2025-01-18 16:53:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:53:47 - root - INFO - SQL:
SELECT d."company_id", d."date_joined", f."valuation"
   FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
   JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
   ON d."company_id" = f."company_id"
   WHERE f."valuation" >= 1000000000
   LIMIT 1000;
Results:
Too long, hard cut:
company_id,date_joined,valuation
109,2020-09-08T00:00:00.000,6000000000
821,2019-05-16T00:00:00.000,1000000000
153,2019-07-11T00:00:00.000,5000000000
972,2018-10-17T00:00:00.000,1000000000
1022,2021-06-02T00:00:00.000,1000000000
433,2021-04-17T00:00:00.000,2000000000
747,2018-03-27T00:00:00.000,1000000000
902,2021-01-27T00:00:00.000,1000000000
1065,2021-06-01T00:00:00.000,1000000000
388,2018-05-30T00:00:00.000,2000000000
748,2019-02-14T00:00:00.000,1000000000
189,2017-06-24T00:00:00.000,4000000000
848,2021-06-01T00:00:00.000,1000000000
556,2022-02-15T00:00:00.000,2000000000
999,2021-11-17T00:00:00.000,1000000000
396,2021-10-21T00:00:00.000,2000000000
931,2021-09-24T00:00:00.000,1000000000
364,2019-02-01T00:00:00.000,2000000000
732,2022-01-27T00:00:00.000,1000000000
906,2021-06-10T00:00:00.000,1000000000
72,2015-01-23T00:00:00.000,8000000000
983,2019-08-22T00:00:00.000,1000000000
898,2022-01-25T00:00:00.000,1000000000
844,2021-07-07T00:00:00.000,1000000000
894,2021-12-06T00:00:00.000,1000000000
813,2021-08-10T00:00:00.000,1000000000
743,2020-12-24T00:00:00.000,1000000000
226,2021-01-24T00:00:00.000,4000000000
963,2021-10-05T00:00:00.000,1000000000
764,2021-12-07T00:00:00.000,1000000000
839,2021-12-28T00:00:00.000,1000000000
1033,2021-01-27T00:00:00.000,1000000000
725,2022-01-25T00:00:00.000,1000000000
549,2021-09-22T00:00:00.000,2000000000
667,2015-01-16T00:00:00.000,1000000000
755,2021-09-08T00:00:00.000,1000000000
782,2022-01-31T00:00:00.000,1000000000
175,2019-06-25T00:00:00.000,4000000000
398,2021-10-15T00:00:00.000,2000000000
814,2021-11-16T00:00:00.000,1000000000
436,2017-04-14T00:00:00.000,2000000000
1046,2021-06-16T00:00:00.000,1000000000
565,2021-04-21T00:00:00.000,2000000000
781,2021-08-31T00:00:00.000,1000000000
997,2021-12-06T00:00:00.000,1000000000
194,2021-03-18T00:00:00.000,4000000000
249,2021-06-29T00:00:00.000,3000000000
434,2021-05-19T00:00:00.000,2000000000
1035,2021-11-18T00:00:00.000,1000000000
969,2022-01-26T00:00:00.000,1000000000
1018,2021-02-18T00:00:00.000,1000000000
355,2021-09-14T00:00:00.000,2000000000
934,2020-03-17T00:00:00.000,1000000000
1054,2021-05-18T00:00:00.000,1000000000
901,2021-11-08T00:00:00.000,1000000000
173,2021-12-20T00:00:00.000,4000000000
738,2022-01-11T00:00:00.000,1000000000
422,2022-02-16T00:00:00.000,2000000000
830,2021-03-30T00:00:00.000,1000000000
1004,2021-05-24T00:00:00.000,1000000000
951,2015-03-06T00:00:00.000,1000000000
734,2022-01-27T00:00:00.000,1000000000
1063,2021-11-10T00:00:00.000,1000000000
623,2015-04-21T00:00:00.000,1000000000
846,2019-10-21T00:00:00.000,1000000000
823,2019-05-21T00:00:00.000,1000000000
944,2021-07-22T00:00:00.000,1000000000
1030,2021-08-09T00:00:00.000,1000000000
824,2016-04-14T00:00:00.000,1000000000
930,2022-02-22T00:00:00.000,1000000000
370,2018-07-09T00:00:00.000,2000000000
618,2018-10-18T00:00:00.000,1000000000
456,2020-01-29T00:00:00.000,2000000000
893,2021-09-02T00:00:00.000,1000000000
812,2022-03-31T00:00:00.000,1000000000
1001,2020-09-21T00:00:00.000,1000000000
703,2021-12-02T00:00:00.000,1000000000
884,2021-12-14T00:00:00.000,1000000000
404,2021-03-19T00:00:00.000,2000000000
952,2022-03-30T00:00:00.000,1000000000
625,2020-01-28T00:00:00.000,1000000000
971,2021-11-02T00:00:00.000,1000000000
796,2017-07-20T00:00:00.000,1000000000
909,2022-01-27T00:00:00.000,1000000000
587,2018-05-17T00:00:00.000,2000000000
273,2022-04-05T00:00:00.000,3000000000
771,2021-09-28T00:00:00.000,1000000000
758,2021-12-21T00:00:00.000,1000000000
652,2021-06-15T00:00:00.000,1000000000
8,2017-12-20T00:00:00.000,38000000000
760,2020-11-17T00:00:00.000,1000000000
394,2022-01-31T00:00:00.000,2000000000
393,2021-09-27T00:00:00.000,2000000000
870,2021-02-16T00:00:00.000,1000000000
804,2021-09-16T00:00:00.000,1000000000
1041,2021-11-02T00:00:00.000,1000000000
443,2022-03-17T00:00:00.000,2000000000
978,2021-01-07T00:00:00.000,1000000000
612,2021-12-31T00:00:00.000,1000000000
714,2017-10-17T00:00:00.000,1000000000
925,2022-03-21T00:00:00.000,1000000000
421,2020-11-16T00:00:00.000,2000000000
449,2021-07-03T00:00:00.000,2000000000
1022,2021-06-02T00:00:00.000,1000000000
240,2016-05-11T00:00:00.000,3000000000
644,2021-01-25T00:00:00.000,1000000000
718,2021-09-30T00:00:00.000,1000000000
920,2021-08-10T00:00:00.000,1000000000
1048,2021-09-30T00:00:00.000,1000000000
1024,2021-04-22T00:00:00.000,1000000000
929,2021-12-22T00:00:00.000,1000000000
751,2022-01-13T00:00:00.000,1000000000
1012,2017-10-23T00:00:00.000,1000000000
863,2021-12-07T00:00:00.000,1000000000
662,2020-12-21T00:00:00.000,1000000000
1027,2021-06-24T00:00:00.000,1000000000
783,2021-03-26T00:00:00.000,1000000000
592,2021-11-17T00:00:00.000,2000000000
1023,2021-01-26T00:00:00.000,1000000000
1051,2021-11-03T00:00:00.000,1000000000
633,2021-04-07T00:00:00.000,1000000000
635,2021-06-02T00:00:00.000,1000000000
750,2022-01-26T00:00:00.000,1000000000
697,2021-12-20T00:00:00.000,1000000000
886,2021-03-30T00:00:00.000,1000000000
826,2022-01-13T00:00:00.000,1000000000
1000,2022-01-12T00:00:00.000,1000000

2025-01-18 16:53:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:53:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:53:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:53:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 15
2025-01-18 16:53:49 - snowflake.connector.connection - INFO - closed
2025-01-18 16:53:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:53:49 - root - INFO - SQL:
SELECT i."industry", COUNT(*) AS "unicorn_count"
   FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
   JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
   ON i."company_id" = f."company_id"
   WHERE f."valuation" >= 1000000000
   GROUP BY i."industry"
   ORDER BY "unicorn_count" DESC
   LIMIT 1000;
Results:
industry,unicorn_count
Fintech,233
Internet software & services,209
E-commerce & direct-to-consumer,113
Artificial intelligence,84
Health,75
Other,59
"""Supply chain, logistics, & delivery""",57
Cybersecurity,50
Data management & analytics,41
Mobile & telecommunications,39
Hardware,34
Auto & transportation,34
Edtech,28
Consumer & retail,26
Travel,14

2025-01-18 16:53:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:53:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:53:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:53:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 16:53:50 - snowflake.connector.connection - INFO - closed
2025-01-18 16:53:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:54:16 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 16:54:16 - root - INFO - ```sql
SELECT i."industry", COUNT(*) AS "unicorn_count"
FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
  ON i."company_id" = d."company_id"
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
  ON i."company_id" = f."company_id"
WHERE f."valuation" >= 1000000000
  AND TRY_TO_DATE(SUBSTR(d."date_joined", 1, 10), 'YYYY-MM-DD') BETWEEN '2019-01-01' AND '2021-12-31'
GROUP BY i."industry"
ORDER BY "unicorn_count" DESC
LIMIT 1000;
```
2025-01-18 16:54:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:54:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:54:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:54:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 15
2025-01-18 16:54:17 - snowflake.connector.connection - INFO - closed
2025-01-18 16:54:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:54:18 - root - INFO - SQL:
SELECT i."industry", COUNT(*) AS "unicorn_count"
FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
  ON i."company_id" = d."company_id"
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
  ON i."company_id" = f."company_id"
WHERE f."valuation" >= 1000000000
  AND TRY_TO_DATE(SUBSTR(d."date_joined", 1, 10), 'YYYY-MM-DD') BETWEEN '2019-01-01' AND '2021-12-31'
GROUP BY i."industry"
ORDER BY "unicorn_count" DESC
LIMIT 1000;
Results:
industry,unicorn_count
Fintech,181
Internet software & services,157
E-commerce & direct-to-consumer,76
Health,53
Artificial intelligence,53
Other,44
Cybersecurity,38
"""Supply chain, logistics, & delivery""",36
Data management & analytics,31
Mobile & telecommunications,18
Edtech,17
Auto & transportation,16
Hardware,15
Consumer & retail,11
Travel,7

2025-01-18 16:54:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:54:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:54:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:54:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-18 16:54:19 - snowflake.connector.connection - INFO - closed
2025-01-18 16:54:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:55:18 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 16:55:18 - root - INFO - ```sql
SELECT EXTRACT(YEAR FROM TRY_TO_TIMESTAMP(d."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) AS "year",
       COUNT(*) AS "unicorns"
FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
  ON d."company_id" = i."company_id"
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
  ON d."company_id" = f."company_id"
WHERE f."valuation" >= 1000000000
  AND i."industry" = 'Fintech'
  AND TRY_TO_TIMESTAMP(d."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3') IS NOT NULL
  AND EXTRACT(YEAR FROM TRY_TO_TIMESTAMP(d."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
GROUP BY "year"
ORDER BY "year";
```
2025-01-18 16:55:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:55:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:55:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:55:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-18 16:55:19 - snowflake.connector.connection - INFO - closed
2025-01-18 16:55:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:55:20 - root - INFO - SQL:
SELECT EXTRACT(YEAR FROM TRY_TO_TIMESTAMP(d."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) AS "year",
       COUNT(*) AS "unicorns"
FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
  ON d."company_id" = i."company_id"
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
  ON d."company_id" = f."company_id"
WHERE f."valuation" >= 1000000000
  AND i."industry" = 'Fintech'
  AND TRY_TO_TIMESTAMP(d."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3') IS NOT NULL
  AND EXTRACT(YEAR FROM TRY_TO_TIMESTAMP(d."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
GROUP BY "year"
ORDER BY "year";
Results:
year,unicorns
2019,21
2020,18
2021,142

2025-01-18 16:55:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:55:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:55:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:55:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 16:55:21 - snowflake.connector.connection - INFO - closed
2025-01-18 16:55:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:56:23 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 16:56:23 - root - INFO - ```sql
SELECT TO_NUMBER(SUBSTRING(d."date_joined", 1, 4)) AS "year",
       COUNT(*) AS "unicorns"
FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
  ON d."company_id" = i."company_id"
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
  ON d."company_id" = f."company_id"
WHERE f."valuation" >= 1000000000
  AND i."industry" = 'Fintech'
  AND TO_NUMBER(SUBSTRING(d."date_joined", 1, 4)) BETWEEN 2019 AND 2021
GROUP BY "year"
ORDER BY "year";
```
2025-01-18 16:56:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:56:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:56:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:56:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-18 16:56:25 - snowflake.connector.connection - INFO - closed
2025-01-18 16:56:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:56:25 - root - INFO - SQL:
SELECT TO_NUMBER(SUBSTRING(d."date_joined", 1, 4)) AS "year",
       COUNT(*) AS "unicorns"
FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
  ON d."company_id" = i."company_id"
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
  ON d."company_id" = f."company_id"
WHERE f."valuation" >= 1000000000
  AND i."industry" = 'Fintech'
  AND TO_NUMBER(SUBSTRING(d."date_joined", 1, 4)) BETWEEN 2019 AND 2021
GROUP BY "year"
ORDER BY "year";
Results:
year,unicorns
2019,21
2020,18
2021,142

2025-01-18 16:56:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:56:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:56:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:56:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 16:56:26 - snowflake.connector.connection - INFO - closed
2025-01-18 16:56:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:57:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 16:57:25 - root - INFO - ```sql
SELECT AVG("unicorns") AS average_number_of_new_unicorn_companies_per_year
FROM (
    SELECT TO_NUMBER(SUBSTRING(d."date_joined", 1, 4)) AS "year",
           COUNT(*) AS "unicorns"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
      ON d."company_id" = i."company_id"
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
      ON d."company_id" = f."company_id"
    WHERE f."valuation" >= 1000000000
      AND TO_NUMBER(SUBSTRING(d."date_joined", 1, 4)) BETWEEN 2019 AND 2021
      AND i."industry" = (
        SELECT i2."industry"
        FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i2
        JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d2
          ON i2."company_id" = d2."company_id"
        JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f2
          ON i2."company_id" = f2."company_id"
        WHERE f2."valuation" >= 1000000000
          AND TO_NUMBER(SUBSTRING(d2."date_joined", 1, 4)) BETWEEN 2019 AND 2021
        GROUP BY i2."industry"
        ORDER BY COUNT(*) DESC
        LIMIT 1
      )
    GROUP BY "year"
) sub;
```

This query calculates the average number of new unicorn companies per year in the top industry from 2019 to 2021. It first identifies the top industry by counting the number of unicorns per industry within the specified years, then computes the average annual number of unicorns in that industry over the three-year period.
2025-01-18 16:57:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:57:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:57:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:57:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-18 16:57:27 - snowflake.connector.connection - INFO - closed
2025-01-18 16:57:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:57:27 - root - INFO - SQL:
SELECT AVG("unicorns") AS average_number_of_new_unicorn_companies_per_year
FROM (
    SELECT TO_NUMBER(SUBSTRING(d."date_joined", 1, 4)) AS "year",
           COUNT(*) AS "unicorns"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
      ON d."company_id" = i."company_id"
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
      ON d."company_id" = f."company_id"
    WHERE f."valuation" >= 1000000000
      AND TO_NUMBER(SUBSTRING(d."date_joined", 1, 4)) BETWEEN 2019 AND 2021
      AND i."industry" = (
        SELECT i2."industry"
        FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i2
        JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d2
          ON i2."company_id" = d2."company_id"
        JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f2
          ON i2."company_id" = f2."company_id"
        WHERE f2."valuation" >= 1000000000
          AND TO_NUMBER(SUBSTRING(d2."date_joined", 1, 4)) BETWEEN 2019 AND 2021
        GROUP BY i2."industry"
        ORDER BY COUNT(*) DESC
        LIMIT 1
      )
    GROUP BY "year"
) sub;
Results:
AVERAGE_NUMBER_OF_NEW_UNICORN_COMPANIES_PER_YEAR
60.333333

2025-01-18 16:57:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:57:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:57:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:57:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 16:57:29 - snowflake.connector.connection - INFO - closed
2025-01-18 16:57:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:57:29 - root - INFO - SQL:
SELECT d."company_id", d."year_founded"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
    ON d."company_id" = f."company_id"
    WHERE f."valuation" >= 1000000000
    LIMIT 1000;
Results:
Too long, hard cut:
company_id,year_founded
109,2004
821,2009
153,2016
972,2016
1022,2013
433,2013
747,2011
902,2015
1065,2015
388,2009
748,2009
189,1919
848,2019
556,2011
999,2020
396,2021
931,2020
364,2015
732,2017
906,2017
72,2006
983,1999
898,2015
844,2018
894,2020
813,2017
743,2015
226,2020
963,2017
764,2018
839,2016
1033,2006
725,2010
549,2016
667,2014
755,2017
782,2021
175,2011
398,2017
814,2014
436,2006
1046,2014
565,2013
781,2018
997,2011
194,2001
249,2019
434,2014
1035,2020
969,2014
1018,2011
355,2017
934,2011
1054,2016
901,2020
173,2018
738,2018
422,2019
830,2017
1004,2016
951,2011
734,2012
1063,2018
623,2013
846,2015
823,2000
944,2005
1030,2019
824,2012
930,2017
370,2010
618,2009
456,2016
893,2020
812,2019
1001,2020
703,2018
884,2020
404,2010
952,2021
625,2012
971,2015
796,2012
909,2015
587,2014
273,2013
771,2017
758,2016
652,2015
8,2015
760,2016
394,2016
393,2013
870,2016
804,2019
1041,2015
443,2017
978,2015
612,2016
714,2021
925,2012
421,2009
449,2019
1022,2013
240,2006
644,2016
718,2015
920,2004
1048,2014
1024,2011
929,2019
751,2015
1012,2015
863,2019
662,2015
1027,2012
783,2016
592,2018
1023,2018
1051,2009
633,2011
635,2011
750,2014
697,2018
886,2016
826,2012
1000,2016
740,2016
798,2017
1008,2020
761,2012
701,2007
825,2014
344,2010
695,2013
876,2011
643,2016
509,2014
979,2013
1031,2017
817,2014
943,2014
975,2015
647,2000
426,2015
705,2018
724,2008
464,2019
942,2018
354,2011
688,2015
1045,2015
391,2020
891,2014
1066,1997
579,2018
686,2014
822,2021
882,2013
816,2001
369,2015
340,2017
1058,2012
129,1994
862,2016
363,2014
603,2013
645,2015
645,2015
769,2016
788,2017
452,2013
420,2012
996,2015
763,2016
803,2009
765,2012
989,2016
409,2013
580,2011
513,2018
809,2019
791,2015
998,2011
455,2014
477,2016
896,2012
797,2017
361,2000
250,2015
229,2011
540,2015
73,2012
852,2015
78,2019
79,1996
632,1999
314,2021
82,2018
164,2017
85,2014
212,2016
65,2015
258,2016
63,2016
58,2005
31,2017
248,2015
32,2013
252,2011
33,2017
287,2015
251,2010
243,2015
40,2013
44,2014
45,2011
211,1995
50,2012
53,2015
285,2014
217,2009
134,2015
317,2020
365,2015
91,2012
185,2014
121,2001
335,2013
1014,2019
191,2017
334,2011
118,1994
115,2012
113,2014
147,2008
136,2013
130,2015
321,2016
327,2017
641,2011
352,2012
972,2016
201,2015
168,2019
104,2010
171,2012
350,2012
101,2017
239,2011
1065,2015
938,2015
828,2017
941,2006
988,2013
484,2018
864,2021
383,2010
1060,2017
595,1999
840,1990
290,2008
742,2014
964,2014
712,2017
837,2016
583,2014
411,2018
430,2016
875,2018
810,2019
805,2015
953,2019
606,2009
679,2015
907,2016
880,2018
834,2016
542,2016
1043,1993
410,2004
637,2017
616,2010
611,2016
1064,2014
1032,2005
737,2020
374,2008
172,2012
414,2020
845,2014
1055,2010
416,2018
682,2006
967,2021
551,2012
491,2014
446,2012
982,2020
850,2013
928,2017
380,2007
451,2004
987,2012
842,2008
620,2001
356,2015
872,2011
417,2010
427,2019
255,2012
397,2016
857,2014
588,2009
1005,2015
609,2017
619,2015
681,2019
489,2005
626,2010
649,2016
234,2000
770,2013
614,2015
482,2019
968,2011
899,2014
386,2007
665,2011
1039,2016
800,2010
457,2019
457,2019
676,2018
1050,2007
694,2018
481,2011
878,2013
995,2018
1034,2017
855,2018
345,2015
691,2014
860,2008
511,2016
704,2016
881,2014
881,2014
747,2011
861,2019
407,2016
858,2018
749,2015
841,2014
282,2013
1026,2015
630,2009
621,2016
847,2009
223,2011
1009,2000
563,2011
476,2011
970,2012
990,2017
728,2013
415,2016
956,2014
418,2012
892,2019
991,2016
1028,2003
454,2016
400,2011
1042,2012
753,2015
911,2016
819,2012
507,2012
910,2012
756,2018
480,2014
405,2008
683,2012
959,2011
954,2015
203,2016
170,2015
698,2019
790,2008
962,2017
865,2015
461,2014
670,2015
529,2019
634,2017
897,2014
924,2007
768,2013
707,2016
673,2016
1049,2016
1017,2009
856,2017
1007,2015
462,2015
832,2004
265,2016
485,2015
490,2010
723,2017
913,2009
534,2017
494,2013
849,2009
908,2015
264,2018
550,2013
778,2012
624,2011
958,2007
440,2017
921,2011
926,2015
584,2012
980,2014
468,2019
709,2013
138,2014
719,2018
505,2001
811,2012
395,2015
746,2016
1052,2014
806,2016
873,2013
966,2016
545,2011
912,2015
187,2016
47,2012
868,2011
671,2017
521,2014
591,2016
593,2015
84,1998
459,2020
514,2005
425,2016
561,2010
303,2014
914,2012
957,2014
368,2018
204,2015
14,2013
1010,2015
10,2015
220,2014
615,2016
615,2016
6,2012
3,2010
34,2015
12,2018
657,2016
169,2011
2,2008
26,2017
93,2011
176,2015
86,2011
66,2016
64,2016
62,2005
60,2018
71,2007
640,2008
56,2013
76,2015
83,2013
149,2015
67,2013
155,2018
103,1999
523,2018
789,2019
961,2013
854,2014
554,2021
522,2017
935,2010
552,2017
687,2015
815,2017
895,2016
510,2013
531,2016
949,2014
833,2014
650,2013
1057,2011
785,2008
408,2011
1015,2018
642,2013
617,2015
779,2015
475,2012
349,2019
272,2015
708,2014
916,2011
289,2014
675,2015
266,2017
784,2019
471,2011
622,1998
574,2011
766,2012
693,2012
390,2004
413,2015
684,2015
801,2019
748,2009
206,2018
752,2014
820,2013
965,2007
448,2011
902,2015
1036,2016
304,2016
325,2015
1019,2015
690,2015
636,2007
342,2015
343,2014
933,2016
933,2016
1011,2007
1062,2009
428,2010
1021,2014
332,2013
950,2017
54,2012
3

2025-01-18 16:57:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:57:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:57:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:57:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 16:57:31 - snowflake.connector.connection - INFO - closed
2025-01-18 16:57:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:57:31 - root - INFO - SQL:
SELECT "company_id", "select_investors"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING"
    WHERE "valuation" >= 1000000000
    LIMIT 1000;
Results:
Too long, hard cut:
company_id,select_investors
548,"""Accel Partners, Index Ventures, Insight Venture Partners"""
645,"""Sequoia Capital China, China Life Investment Holding Company, Qiming Venture Partners"""
615,"""CreditEase Fintech Investment Fund, BMW i Ventures, SoftBank Group"""
51,"""DFJ Growth Fund, Coatue Management, Addition"""
680,"""China Grand Prosperity Investment, CSC Group"""
457,"""QED Investors, DST Global, Left Lane Capital"""
429,"""Sodexo Ventures, SoftBank Group"""
933,Ginko Ventures
568,"""CRV, Blue Cloud Ventures, Index Ventures"""
478,"""Thrive Capital, Tiger Global Management, Temasek"""
881,"""WRVI Capital, Caffeinated Capital, Y Combinator"""
189,EQT Partners
848,"""Dragonfly Captial, Qiming Venture Partners, DST Global"""
556,"""Blackstone, Bessemer Venture Partners"""
999,"""Goldman Sachs Asset Management, 3L"""
396,"""Insight Partners, Softbank Group, Connect Ventures"""
931,"""Tencent Holdings, Hillhouse Capital Management"""
364,"""K2VC, Lightspeed China Partners, Sky9 Capital"""
732,"""Initialized Capital, General Catalyst, Kraken Ventures"""
906,"""Delian Capital, China International Capital Corporation, Sequoia Capital China"""
72,"""Accel Partners, Sequoia Capital"""
983,"""Investment Corporation of Dubai, Centralway"""
898,"""Lightspeed India Partners, Sequoia Capital India, Endiya Partners"""
844,"""General Catalyst, Future Ventures, AU21"""
894,"""DST Global, General Catalyst, Monashees+"""
813,"""Polychain Capital, Coinbase Ventures, Jump Capital"""
743,"""Coatue Management, H Capital, Capital Today"""
226,"""Andreessen Horowitz, TQ Ventures"""
963,"""Left Lane Capital, Galaxy Interactive, Tru Arrow Partners"""
764,"""Craft Ventures, Caffeinated Capital, Operator Collective"""
839,"""Fireside Ventures, Sequoia Capital India, Stellaris Venture Partners"""
1033,"""Storm Ventures, DFJ DragonFund, New Enterprise Associates"""
725,"""SC.Holdings, Not Boring Capital, Bolt Ventures"""
549,"""Northern Light Venture Capital, Xiaomi, FutureX Capital"""
667,"""Redpoint Ventures, QiMing Venture Partners, Chengwei Capital"""
755,"""Passion Capital, Hedosophia, Outrun Ventures"""
782,"""Paradigm, Andreessen Horowitz, Jump Capital"""
175,"""Bnk To The Future, Trammell Ventures, SBI Investment"""
398,"""Accomplice, Polychain Capital, GoldenTree Asset Management"""
814,"""M13, Lightspeed Venture Partners, Lone Pine Capital"""
436,GAM Holding
1046,"""Insight Partners, Ignition Partners, Georgian Partners"""
565,"""Tomales Bay Capital, Bain & Company, General Catalyst"""
781,"""Pantera Capital, Polychain Capital, Lightspeed Venture Partners"""
997,"""Prysm Capital, Baillie Gifford & Co., TDM Growth Partners"""
194,"""Silver Lake, ICONIQ Capital"""
249,"""Day One Ventures, Coinbase Ventures, Andreessen Horowitz"""
434,"""Shunwei Capital Partners, China Media Group, Guangzhou Huiyin Aofeng Equity Investment Fund"""
1035,"""Index Ventures, Benchmark, Thrive Capital"""
969,"""General Catalyst, Nexus Venture Partners, Dell Technologies Capital"""
1018,"""New Enterprise Associates, Accel, Bond"""
355,"""VGames, Lakestar, Galaxy Interactive"""
934,"""Technology Crossover Ventures, Alkeon Capital Management, General Atlantic"""
1054,"""Sequoia Capital, Founders Fund, Bling Capital"""
901,"""Cowboy Ventures, Leaders Fund, GGV Capital"""
173,"""Foundation Capital, Frontier Ventures, AltaIR Capital"""
738,"""Left Lane Capital, Walden Venture Capital"""
422,"""Amplify Partners, Addition, Madrona Venture Group"""
830,"""Thrive Capital, Khosla Ventures, Tiger Global Management"""
1004,Bregal Sagemount
951,"""5Y Capital, Matrix Partners China, K2VC"""
734,"""Zeev Ventures, GSV Ventures"""
1063,"""Equal Ventures, Uncork Capital, Andreessen Horowitz"""
623,"""Matrix Partners China, Ventech China, Shunwei Capital Partners"""
846,"""New Enterprise Associates, Greylock Partners, Andreessen Horowitz"""
823,"""Ardian, Tiger Global Management, KKR"""
944,"""Kleiner Perkins Caufield & Byers, NightDragon Security, Venrock"""
1030,"""Greylock Partners, Google Ventures, BlackRock"""
824,"""Tiantu Capital, SAIF Partners China, Newsion Venture Capital"""
930,"""Nexus Venture Partners, Vertex Ventures, STRIVE"""
370,"""Boxin Capital, DT Capital Partners, IDG Capital"""
618,"""U.S.-China Green Fund, Founder H Fund, Richland Equities"""
456,"""next47, First Round Capital, Sequoia Capital"""
893,"""Andreessen Horowitz, DST Global, IDG Capital"""
812,"""General Catalyst, Inspired Capital, Flybridge Capital Partners"""
1001,"""Sozo Ventures, Caffeinated Capital, Sequoia Capital"""
703,"""Innovation Endeavors, s28 Capital, Lightspeed Venture Partners"""
884,"""Thrive Capital, General Catalyst, Coatue Management"""
404,"""Moonshots Capital, BoxGroup, Blu Venture Investors"""
952,"""Andreessen Horowitz, FTX Ventures, Tiger Global Management"""
625,"""Index Ventures, Thrive Capital, Bain Capital Ventures"""
971,"""GGV Capital, GSR Ventures, FreesFund"""
796,"""Sequoia Capital China, Qiming Venture Partners, Tencent Holdings"""
909,"""Next Pl

2025-01-18 16:57:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:57:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:57:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:57:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-18 16:57:32 - snowflake.connector.connection - INFO - closed
2025-01-18 16:57:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:57:33 - root - INFO - SQL:
SELECT COUNT(*) AS "total_unicorns"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING"
    WHERE "valuation" >= 1000000000
    LIMIT 1000;
Results:
total_unicorns
1085

2025-01-18 16:57:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:57:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:57:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:57:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 15
2025-01-18 16:57:34 - snowflake.connector.connection - INFO - closed
2025-01-18 16:57:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:57:35 - root - INFO - SQL:
SELECT i."industry", AVG(f."valuation") AS "average_valuation"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
    ON i."company_id" = f."company_id"
    GROUP BY i."industry"
    ORDER BY "average_valuation" DESC
    LIMIT 1000;
Results:
industry,average_valuation
Artificial intelligence,4488095238.095238
Other,4288135593.220339
Consumer & retail,4153846153.846154
Fintech,3909871244.635193
E-commerce & direct-to-consumer,3787610619.469027
Edtech,3571428571.428571
Data management & analytics,3317073170.731707
Travel,3285714285.714286
"""Supply chain, logistics, & delivery""",3105263157.894737
Auto & transportation,3029411764.705882
Hardware,2911764705.882353
Internet software & services,2885167464.114833
Health,2653333333.333333
Cybersecurity,2580000000.000000
Mobile & telecommunications,2307692307.692308

2025-01-18 16:57:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:57:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:57:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:57:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 16:57:36 - snowflake.connector.connection - INFO - closed
2025-01-18 16:57:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:57:36 - root - INFO - SQL:
SELECT "company_id", "funding"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING"
    LIMIT 1000;
Results:
Too long, hard cut:
company_id,funding
548,449000000
645,188000000
615,2000000000
51,564000000
680,362000000
457,236000000
429,340000000
933,330000000
568,342000000
478,792000000
881,241000000
189,0
848,100000000
556,100000000
999,100000000
396,100000000
931,100000000
364,101000000
732,102000000
906,105000000
72,105000000
983,105000000
898,107000000
844,107000000
894,109000000
813,109000000
743,10000000
226,110000000
963,110000000
764,111000000
839,111000000
1033,114000000
725,115000000
549,115000000
667,116000000
755,116000000
782,118000000
175,119000000
398,119000000
814,120000000
436,120000000
1046,120000000
565,121000000
781,124000000
997,125000000
194,125000000
249,125000000
434,125000000
1035,126000000
969,126000000
1018,127000000
355,127000000
934,127000000
1054,128000000
901,128000000
173,128000000
738,128000000
422,129000000
830,130000000
1004,130000000
951,130000000
734,130000000
1063,131000000
623,131000000
846,132000000
823,134000000
944,135000000
1030,135000000
824,136000000
930,137000000
370,137000000
618,139000000
456,139000000
893,140000000
812,140000000
1001,140000000
703,141000000
884,141000000
404,142000000
952,143000000
625,143000000
971,144000000
796,144000000
909,145000000
587,147000000
273,148000000
771,148000000
1005,226000000
758,148000000
652,149000000
8,14000000000
760,14000000
394,150000000
393,150000000
870,150000000
804,150000000
1041,151000000
443,151000000
978,151000000
612,151000000
714,151000000
925,152000000
421,152000000
449,152000000
1022,154000000
240,154000000
644,154000000
718,156000000
920,156000000
1048,156000000
1024,157000000
929,157000000
751,157000000
1012,15000000
863,160000000
662,160000000
1027,161000000
783,161000000
592,161000000
1023,163000000
1051,163000000
633,163000000
635,164000000
750,165000000
697,165000000
886,165000000
826,166000000
1000,166000000
740,166000000
798,167000000
1008,167000000
761,167000000
701,169000000
825,169000000
344,170000000
695,170000000
876,170000000
643,171000000
509,172000000
979,172000000
1031,172000000
817,172000000
943,173000000
975,174000000
647,174000000
426,177000000
705,177000000
724,178000000
464,179000000
942,17000000
354,180000000
688,181000000
1045,181000000
391,181000000
891,182000000
1066,182000000
579,183000000
686,183000000
822,185000000
882,185000000
816,186000000
369,186000000
340,187000000
1058,187000000
129,187000000
862,187000000
363,188000000
603,188000000
645,188000000
769,189000000
788,189000000
452,190000000
420,190000000
996,190000000
763,191000000
803,192000000
765,192000000
989,192000000
409,192000000
580,192000000
513,193000000
809,193000000
791,194000000
998,195000000
455,195000000
477,195000000
896,196000000
797,197000000
361,19000000
250,1000000000
229,1000000000
540,1000000000
73,1000000000
852,1000000000
78,1000000000
79,1000000000
632,1000000000
314,1000000000
82,1000000000
164,1000000000
85,1000000000
212,1000000000
65,1000000000
258,1000000000
63,1000000000
58,1000000000
31,1000000000
248,1000000000
32,1000000000
252,1000000000
33,1000000000
287,1000000000
251,1000000000
243,1000000000
40,1000000000
44,1000000000
45,1000000000
211,1000000000
50,1000000000
53,1000000000
285,1000000000
217,1000000000
134,1000000000
317,1000000000
365,1000000000
91,1000000000
185,1000000000
121,1000000000
335,1000000000
1014,1000000000
191,1000000000
334,1000000000
118,1000000000
115,1000000000
113,1000000000
147,1000000000
136,1000000000
130,1000000000
321,1000000000
327,1000000000
641,1000000000
352,1000000000
972,1000000000
201,1000000000
168,1000000000
104,1000000000
171,1000000000
350,1000000000
101,1000000000
239,1000000
1065,200000000
938,200000000
828,200000000
941,200000000
988,200000000
484,200000000
864,200000000
383,200000000
1060,200000000
595,200000000
840,200000000
290,200000000
742,201000000
964,202000000
712,202000000
837,202000000
583,202000000
411,203000000
430,204000000
875,205000000
810,205000000
805,205000000
953,205000000
606,206000000
679,207000000
907,209000000
880,210000000
834,210000000
542,210000000
1043,210000000
410,211000000
637,211000000
616,211000000
611,214000000
1064,215000000
1032,215000000
737,215000000
374,216000000
172,216000000
414,217000000
845,217000000
1055,217000000
416,218000000
682,218000000
967,218000000
551,218000000
491,218000000
446,219000000
982,220000000
850,221000000
928,221000000
380,221000000
451,222000000
987,223000000
842,223000000
620,223000000
356,224000000
872,224000000
417,225000000
427,225000000
255,225000000
397,225000000
857,226000000
588,226000000
609,227000000
619,227000000
681,228000000
489,229000000
626,229000000
649,230000000
234,230000000
770,230000000
614,231000000
482,231000000
968,232000000
899,232000000
386,233000000
665,235000000
1039,235000000
800,236000000
457,236000000
676,236000000
1050,237000000
694,237000000
481,237000000
878,238000000
995,239000000
1034,239000000
855,240000000
345,240000000
691,240000000
860,240000000
511,240000000
704,241000000
881,241000000
747,241000000
861,243000000
407,245000000
858,245000000
749,246000000
841,247000000
282,24

2025-01-18 16:57:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:57:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:57:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:57:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 871
2025-01-18 16:57:37 - snowflake.connector.connection - INFO - closed
2025-01-18 16:57:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:57:38 - root - INFO - SQL:
SELECT d."company_id", d."year_founded", f."valuation"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
    ON d."company_id" = f."company_id"
    WHERE f."valuation" >= 1000000000
      AND d."year_founded" > 2010
    LIMIT 1000;
Results:
Too long, hard cut:
company_id,year_founded,valuation
645,2015,1000000000
615,2016,1000000000
51,2017,10000000000
680,2016,1000000000
457,2019,2000000000
429,2015,2000000000
933,2016,1000000000
568,2013,2000000000
478,2013,2000000000
881,2014,1000000000
848,2019,1000000000
556,2011,2000000000
999,2020,1000000000
396,2021,2000000000
931,2020,1000000000
364,2015,2000000000
732,2017,1000000000
906,2017,1000000000
898,2015,1000000000
844,2018,1000000000
894,2020,1000000000
813,2017,1000000000
743,2015,1000000000
226,2020,4000000000
963,2017,1000000000
764,2018,1000000000
839,2016,1000000000
549,2016,2000000000
667,2014,1000000000
755,2017,1000000000
782,2021,1000000000
175,2011,4000000000
398,2017,2000000000
814,2014,1000000000
1046,2014,1000000000
565,2013,2000000000
781,2018,1000000000
997,2011,1000000000
249,2019,3000000000
434,2014,2000000000
1035,2020,1000000000
969,2014,1000000000
1018,2011,1000000000
355,2017,2000000000
934,2011,1000000000
1054,2016,1000000000
901,2020,1000000000
173,2018,4000000000
738,2018,1000000000
422,2019,2000000000
830,2017,1000000000
1004,2016,1000000000
951,2011,1000000000
734,2012,1000000000
1063,2018,1000000000
623,2013,1000000000
846,2015,1000000000
1030,2019,1000000000
824,2012,1000000000
930,2017,1000000000
456,2016,2000000000
893,2020,1000000000
812,2019,1000000000
1001,2020,1000000000
703,2018,1000000000
884,2020,1000000000
952,2021,1000000000
625,2012,1000000000
971,2015,1000000000
796,2012,1000000000
909,2015,1000000000
587,2014,2000000000
273,2013,3000000000
771,2017,1000000000
1005,2015,1000000000
758,2016,1000000000
652,2015,1000000000
8,2015,38000000000
760,2016,1000000000
394,2016,2000000000
393,2013,2000000000
870,2016,1000000000
804,2019,1000000000
1041,2015,1000000000
443,2017,2000000000
978,2015,1000000000
612,2016,1000000000
714,2021,1000000000
925,2012,1000000000
449,2019,2000000000
1022,2013,1000000000
1022,2013,1000000000
644,2016,1000000000
718,2015,1000000000
1048,2014,1000000000
1024,2011,1000000000
929,2019,1000000000
751,2015,1000000000
1012,2015,1000000000
863,2019,1000000000
662,2015,1000000000
1027,2012,1000000000
783,2016,1000000000
592,2018,2000000000
1023,2018,1000000000
633,2011,1000000000
635,2011,1000000000
750,2014,1000000000
697,2018,1000000000
886,2016,1000000000
826,2012,1000000000
1000,2016,1000000000
740,2016,1000000000
798,2017,1000000000
1008,2020,1000000000
761,2012,1000000000
825,2014,1000000000
695,2013,1000000000
876,2011,1000000000
643,2016,1000000000
509,2014,2000000000
979,2013,1000000000
1031,2017,1000000000
817,2014,1000000000
943,2014,1000000000
975,2015,1000000000
426,2015,2000000000
705,2018,1000000000
464,2019,2000000000
942,2018,1000000000
354,2011,3000000000
688,2015,1000000000
1045,2015,1000000000
391,2020,2000000000
891,2014,1000000000
579,2018,2000000000
686,2014,1000000000
822,2021,1000000000
882,2013,1000000000
369,2015,2000000000
340,2017,3000000000
1058,2012,1000000000
862,2016,1000000000
363,2014,2000000000
603,2013,1000000000
645,2015,1000000000
769,2016,1000000000
788,2017,1000000000
452,2013,2000000000
420,2012,2000000000
996,2015,1000000000
763,2016,1000000000
765,2012,1000000000
989,2016,1000000000
409,2013,2000000000
580,2011,2000000000
513,2018,2000000000
809,2019,1000000000
791,2015,1000000000
998,2011,1000000000
455,2014,2000000000
477,2016,2000000000
896,2012,1000000000
797,2017,1000000000
250,2015,3000000000
229,2011,4000000000
540,2015,2000000000
73,2012,8000000000
852,2015,1000000000
78,2019,8000000000
314,2021,3000000000
82,2018,8000000000
164,2017,5000000000
85,2014,7000000000
212,2016,4000000000
65,2015,9000000000
258,2016,3000000000
63,2016,9000000000
31,2017,12000000000
248,2015,3000000000
32,2013,12000000000
252,2011,3000000000
33,2017,12000000000
287,2015,3000000000
243,2015,3000000000
40,2013,11000000000
44,2014,11000000000
45,2011,11000000000
50,2012,10000000000
53,2015,10000000000
285,2014,3000000000
134,2015,5000000000
317,2020,3000000000
365,2015,2000000000
91,2012,7000000000
185,2014,4000000000
335,2013,3000000000
1014,2019,1000000000
191,2017,4000000000
334,2011,3000000000
115,2012,6000000000
113,2014,6000000000
136,2013,5000000000
130,2015,5000000000
321,2016,3000000000
327,2017,3000000000
641,2011,1000000000
352,2012,3000000000
972,2016,1000000000
972,2016,1000000000
201,2015,4000000000
168,2019,4000000000
171,2012,4000000000
350,2012,3000000000
101,2017,7000000000
239,2011,4000000000
1065,2015,1000000000
1065,2015,1000000000
938,2015,1000000000
828,2017,1000000000
988,2013,1000000000
484,2018,2000000000
864,2021,1000000000
1060,2017,1000000000
742,2014,1000000000
964,2014,1000000000
712,2017,1000000000
837,2016,1000000000
583,2014,2000000000
411,2018,2000000000
430,2016,2000000000
875,2018,1000000000
810,2019,1000000000
805,2015,1000000000
953,2019,1000000000
679,2015,1000000000
907,2016,1000000000
880,2018,1000000000
834,2016,1000000000
542,2016,2000000000
637,2017,1000000000
611,2016,1000000000
1064,2014,1000000000
737,2020,1000000000
172,2012,4000000000
414,2020,2000000000
845,2014,1000000000
416,201

2025-01-18 16:57:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:57:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:57:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:57:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-18 16:57:39 - snowflake.connector.connection - INFO - closed
2025-01-18 16:57:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:58:12 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 16:58:12 - root - INFO - ```sql
SELECT MIN(TRY_TO_TIMESTAMP(d."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) AS "earliest_join_date"
FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
  ON d."company_id" = f."company_id"
WHERE f."valuation" >= 1000000000
  AND TRY_TO_TIMESTAMP(d."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3') IS NOT NULL;
```
2025-01-18 16:58:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:58:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:58:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:58:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-18 16:58:13 - snowflake.connector.connection - INFO - closed
2025-01-18 16:58:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:58:14 - root - INFO - SQL:
SELECT MIN(TRY_TO_TIMESTAMP(d."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) AS "earliest_join_date"
FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
  ON d."company_id" = f."company_id"
WHERE f."valuation" >= 1000000000
  AND TRY_TO_TIMESTAMP(d."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3') IS NOT NULL;
Results:
earliest_join_date
2007-07-02

2025-01-18 16:58:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:58:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:58:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:58:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 16:58:15 - snowflake.connector.connection - INFO - closed
2025-01-18 16:58:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:58:31 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 16:58:31 - root - INFO - ```sql
SELECT MIN(TRY_TO_DATE(SUBSTRING(d."date_joined", 1, 10), 'YYYY-MM-DD')) AS "earliest_join_date"
FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
  ON d."company_id" = f."company_id"
WHERE f."valuation" >= 1000000000
  AND TRY_TO_DATE(SUBSTRING(d."date_joined", 1, 10), 'YYYY-MM-DD') IS NOT NULL;
```
2025-01-18 16:58:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:58:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:58:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:58:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-18 16:58:32 - snowflake.connector.connection - INFO - closed
2025-01-18 16:58:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:58:33 - root - INFO - SQL:
SELECT MIN(TRY_TO_DATE(SUBSTRING(d."date_joined", 1, 10), 'YYYY-MM-DD')) AS "earliest_join_date"
FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
  ON d."company_id" = f."company_id"
WHERE f."valuation" >= 1000000000
  AND TRY_TO_DATE(SUBSTRING(d."date_joined", 1, 10), 'YYYY-MM-DD') IS NOT NULL;
Results:
earliest_join_date
2007-07-02

2025-01-18 16:58:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:58:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:58:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:58:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 35
2025-01-18 16:58:34 - snowflake.connector.connection - INFO - closed
2025-01-18 16:58:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:58:35 - root - INFO - SQL:
SELECT d."year_founded", COUNT(*) AS "unicorns"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
    ON d."company_id" = f."company_id"
    WHERE f."valuation" >= 1000000000
    GROUP BY d."year_founded"
    ORDER BY d."year_founded"
    LIMIT 1000;
Results:
year_founded,unicorns
1919,1
1979,1
1984,1
1990,1
1991,1
1992,1
1993,1
1994,2
1995,2
1996,1
1997,1
1998,5
1999,8
2000,11
2001,9
2002,4
2003,8
2004,9
2005,14
2006,16
2007,24
2008,27
2009,37
2010,40
2011,83
2012,95
2013,91
2014,110
2015,159
2016,115
2017,75
2018,61
2019,46
2020,25
2021,11

2025-01-18 16:58:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:58:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:58:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:58:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 15
2025-01-18 16:58:36 - snowflake.connector.connection - INFO - closed
2025-01-18 16:58:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:58:36 - root - INFO - SQL:
SELECT i."industry", SUM(f."funding") AS "total_funding"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
    ON i."company_id" = f."company_id"
    GROUP BY i."industry"
    ORDER BY "total_funding" DESC
    LIMIT 1000;
Results:
industry,total_funding
Fintech,111977000000
E-commerce & direct-to-consumer,75162000000
Internet software & services,74061000000
Artificial intelligence,46802000000
"""Supply chain, logistics, & delivery""",44393000000
Other,40285000000
Auto & transportation,37885000000
Health,34132000000
Consumer & retail,26284000000
Cybersecurity,21932000000
Edtech,21875000000
Hardware,21385000000
Data management & analytics,17981000000
Mobile & telecommunications,15214000000
Travel,12626000000

2025-01-18 16:58:36 - root - INFO - itercount: 0
2025-01-18 16:58:36 - root - INFO - Database Name: MODERN_DATA
Schema Name: MODERN_DATA
DDL describes table information.
,0
table_name,PIZZA_NAMES
description,
DDL,"create or replace TABLE PIZZA_NAMES (
	""pizza_id"" NUMBER(38,0),
	""pizza_name"" VARCHAR(16777216)
);"

,1
table_name,COMPANIES_DATES
description,
DDL,"create or replace TABLE COMPANIES_DATES (
	""company_id"" NUMBER(38,0),
	""date_joined"" VARCHAR(16777216),
	""year_founded"" NUMBER(38,0)
);"

,2
table_name,COMPANIES_INDUSTRIES
description,
DDL,"create or replace TABLE COMPANIES_INDUSTRIES (
	""company_id"" NUMBER(38,0),
	""industry"" VARCHAR(16777216)
);"

,3
table_name,PIZZA_CLEAN_RUNNER_ORDERS
description,
DDL,"create or replace TABLE PIZZA_CLEAN_RUNNER_ORDERS (
	""order_id"" NUMBER(38,0),
	""runner_id"" NUMBER(38,0),
	""pickup_time"" VARCHAR(16777216),
	""distance"" FLOAT,
	""duration"" FLOAT,
	""cancellation"" VARCHAR(16777216)
);"

,4
table_name,PIZZA_GET_EXCLUSIONS
description,
DDL,"create or replace TABLE PIZZA_GET_EXCLUSIONS (
	""row_id"" NUMBER(38,0),
	""order_id"" NUMBER(38,0),
	""exclusions"" NUMBER(38,0),
	""total_exclusions"" NUMBER(38,0)
);"

,5
table_name,PIZZA_RECIPES
description,
DDL,"create or replace TABLE PIZZA_RECIPES (
	""pizza_id"" NUMBER(38,0),
	""toppings"" VARCHAR(16777216)
);"

,6
table_name,WORD_LIST
description,
DDL,"create or replace TABLE WORD_LIST (
	""words"" VARCHAR(16777216)
);"

,7
table_name,COMPANIES_FUNDING
description,
DDL,"create or replace TABLE COMPANIES_FUNDING (
	""company_id"" NUMBER(38,0),
	""valuation"" NUMBER(38,0),
	""funding"" NUMBER(38,0),
	""select_investors"" VARCHAR(16777216)
);"

,8
table_name,INCOME_TREES
description,
DDL,"create or replace TABLE INCOME_TREES (
	""zipcode"" NUMBER(38,0),
	""Estimate_Total"" NUMBER(38,0),
	""Margin_of_Error_Total"" NUMBER(38,0),
	""Estimate_Median_income"" NUMBER(38,0),
	""Margin_of_Error_Median_income"" NUMBER(38,0),
	""Estimate_Mean_income"" NUMBER(38,0),
	""Margin_of_Error_Mean_income"" NUMBER(38,0)
);"

,9
table_name,PIZZA_CLEAN_CUSTOMER_ORDERS
description,
DDL,"create or replace TABLE PIZZA_CLEAN_CUSTOMER_ORDERS (
	""order_id"" NUMBER(38,0),
	""customer_id"" NUMBER(38,0),
	""pizza_id"" NUMBER(38,0),
	""exclusions"" VARCHAR(16777216),
	""extras"" VARCHAR(16777216),
	""order_time"" VARCHAR(16777216)
);"

,10
table_name,PIZZA_CUSTOMER_ORDERS
description,
DDL,"create or replace TABLE PIZZA_CUSTOMER_ORDERS (
	""order_id"" NUMBER(38,0),
	""customer_id"" NUMBER(38,0),
	""pizza_id"" NUMBER(38,0),
	""exclusions"" VARCHAR(16777216),
	""extras"" VARCHAR(16777216),
	""order_time"" VARCHAR(16777216)
);"

,11
table_name,PIZZA_RUNNERS
description,
DDL,"create or replace TABLE PIZZA_RUNNERS (
	""runner_id"" NUMBER(38,0),
	""registration_date"" VARCHAR(16777216)
);"

,12
table_name,PIZZA_RUNNER_ORDERS
description,
DDL,"create or replace TABLE PIZZA_RUNNER_ORDERS (
	""order_id"" NUMBER(38,0),
	""runner_id"" NUMBER(38,0),
	""pickup_time"" VARCHAR(16777216),
	""distance"" VARCHAR(16777216),
	""duration"" VARCHAR(16777216),
	""cancellation"" VARCHAR(16777216)
);"

,13
table_name,PIZZA_GET_EXTRAS
description,
DDL,"create or replace TABLE PIZZA_GET_EXTRAS (
	""row_id"" NUMBER(38,0),
	""order_id"" NUMBER(38,0),
	""extras"" NUMBER(38,0),
	""extras_count"" NUMBER(38,0)
);"

,14
table_name,PIZZA_TOPPINGS
description,
DDL,"create or replace TABLE PIZZA_TOPPINGS (
	""topping_id"" NUMBER(38,0),
	""topping_name"" VARCHAR(16777216)
);"

,15
table_name,STATISTICS
description,
DDL,"create or replace TABLE STATISTICS (
	""date"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""total_cases"" NUMBER(38,0),
	""total_deaths"" NUMBER(38,0)
);"

,16
table_name,TREES
description,
DDL,"create or replace TABLE TREES (
	""idx"" NUMBER(38,0),
	""tree_id"" NUMBER(38,0),
	""tree_dbh"" NUMBER(38,0),
	""stump_diam"" NUMBER(38,0),
	""status"" VARCHAR(16777216),
	""health"" VARCHAR(16777216),
	""spc_latin"" VARCHAR(16777216),
	""spc_common"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""zipcode"" NUMBER(38,0),
	""borocode"" NUMBER(38,0),
	""boroname"" VARCHAR(16777216),
	""nta_name"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'MODERN_DATA': {'MODERN_DATA': ['COMPANIES_DATES', 'COMPANIES_FUNDING', 'COMPANIES_INDUSTRIES', 'INCOME_TREES', 'PIZZA_CLEAN_CUSTOMER_ORDERS', 'PIZZA_CLEAN_RUNNER_ORDERS', 'PIZZA_CUSTOMER_ORDERS', 'PIZZA_GET_EXCLUSIONS', 'PIZZA_GET_EXTRAS', 'PIZZA_NAMES', 'PIZZA_RECIPES', 'PIZZA_RUNNERS', 'PIZZA_RUNNER_ORDERS', 'PIZZA_TOPPINGS', 'STATISTICS', 'TREES', 'WORD_LIST']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table:** `COMPANIES_DATES`
  - `"company_id"`: Used to join with other tables.
  - `"date_joined"`: Potentially the date when a company became a unicorn.
  - `"year_founded"`: The year the company was founded.

- **Table:** `COMPANIES_INDUSTRIES`
  - `"company_id"`: Used to join with other tables.
  - `"industry"`: The industry sector of the company.

- **Table:** `COMPANIES_FUNDING`
  - `"company_id"`: Used to join with other tables.
  - `"valuation"`: Company's valuation; a valuation of 1,000,000,000 or more may indicate unicorn status.
  - `"funding"`: Amount of funding received.
  - `"select_investors"`: Names of select investors.

**Potential Conditions to Use:**

- Companies with a `"valuation"` greater than or equal to 1,000,000,000 to identify unicorns.
- `"date_joined"` between 2019-01-01 and 2021-12-31 to filter the relevant time period.
- Parsing `"date_joined"` to a date format using `TRY_TO_DATE`.
- Grouping by `"industry"` to find the top industry by unicorn count.

**SQL Queries:**

1. **List distinct industries:**
   ```sql
   SELECT DISTINCT "industry"
   FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES"
   LIMIT 1000;
   ```

2. **Find companies with valuation  1,000,000,000:**
   ```sql
   SELECT "company_id", "valuation"
   FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING"
   WHERE "valuation" >= 1000000000
   LIMIT 1000;
   ```

3. **View all company join dates:**
   ```sql
   SELECT "company_id", "date_joined"
   FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES"
   LIMIT 1000;
   ```

4. **Parse join dates into date format:**
   ```sql
   SELECT "company_id", TRY_TO_DATE("date_joined", 'YYYY-MM-DD') AS "parsed_date"
   FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES"
   WHERE TRY_TO_DATE("date_joined", 'YYYY-MM-DD') IS NOT NULL
   LIMIT 1000;
   ```

5. **Find unicorn companies with join dates:**
   ```sql
   SELECT d."company_id", d."date_joined", f."valuation"
   FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
   JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
   ON d."company_id" = f."company_id"
   WHERE f."valuation" >= 1000000000
   LIMIT 1000;
   ```

6. **Count unicorn companies per industry:**
   ```sql
   SELECT i."industry", COUNT(*) AS "unicorn_count"
   FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
   JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
   ON i."company_id" = f."company_id"
   WHERE f."valuation" >= 1000000000
   GROUP BY i."industry"
   ORDER BY "unicorn_count" DESC
   LIMIT 1000;
   ```

7. **Find unicorns between 2019 and 2021:**
   ```sql
   SELECT d."company_id", d."date_joined", f."valuation"
   FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
   JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
   ON d."company_id" = f."company_id"
   WHERE f."valuation" >= 1000000000
     AND TRY_TO_DATE(d."date_joined", 'YYYY-MM-DD') BETWEEN '2019-01-01' AND '2021-12-31'
   LIMIT 1000;
   ```

8. **Count new unicorns per year:**
   ```sql
   SELECT EXTRACT(YEAR FROM TRY_TO_DATE(d."date_joined", 'YYYY-MM-DD')) AS "year", COUNT(*) AS "unicorns"
   FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
   JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
   ON d."company_id" = f."company_id"
   WHERE f."valuation" >= 1000000000
   GROUP BY "year"
   ORDER BY "year"
   LIMIT 1000;
   ```

9. **Find top industry for unicorns (2019-2021):**
   ```sql
   SELECT i."industry", COUNT(*) AS "unicorn_count"
   FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
   JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
   ON i."company_id" = d."company_id"
   JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
   ON i."company_id" = f."company_id"
   WHERE f."valuation" >= 1000000000
     AND TRY_TO_DATE(d."date_joined", 'YYYY-MM-DD') BETWEEN '2019-01-01' AND '2021-12-31'
   GROUP BY i."industry"
   ORDER BY "unicorn_count" DESC
   LIMIT 1000;
   ```

10. **List companies and industries for 2019-2021 unicorns:**
    ```sql
    SELECT d."company_id", i."industry", d."date_joined"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
    ON d."company_id" = i."company_id"
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
    ON d."company_id" = f."company_id"
    WHERE f."valuation" >= 1000000000
      AND TRY_TO_DATE(d."date_joined", 'YYYY-MM-DD') BETWEEN '2019-01-01' AND '2021-12-31'
    LIMIT 1000;
    ```

11. **Display year founded for unicorns:**
    ```sql
    SELECT d."company_id", d."year_founded"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
    ON d."company_id" = f."company_id"
    WHERE f."valuation" >= 1000000000
    LIMIT 1000;
    ```

12. **Get select investors for unicorn companies:**
    ```sql
    SELECT "company_id", "select_investors"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING"
    WHERE "valuation" >= 1000000000
    LIMIT 1000;
    ```

13. **Count total unicorn companies:**
    ```sql
    SELECT COUNT(*) AS "total_unicorns"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING"
    WHERE "valuation" >= 1000000000
    LIMIT 1000;
    ```

14. **List industries with their average valuations:**
    ```sql
    SELECT i."industry", AVG(f."valuation") AS "average_valuation"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
    ON i."company_id" = f."company_id"
    GROUP BY i."industry"
    ORDER BY "average_valuation" DESC
    LIMIT 1000;
    ```

15. **Find companies with funding amounts:**
    ```sql
    SELECT "company_id", "funding"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING"
    LIMIT 1000;
    ```

16. **List companies founded after 2010 with valuations  1B:**
    ```sql
    SELECT d."company_id", d."year_founded", f."valuation"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
    ON d."company_id" = f."company_id"
    WHERE f."valuation" >= 1000000000
      AND d."year_founded" > 2010
    LIMIT 1000;
    ```

17. **Find the earliest date_joined for unicorns:**
    ```sql
    SELECT MIN(TRY_TO_DATE("date_joined", 'YYYY-MM-DD')) AS "earliest_join_date"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
    ON d."company_id" = f."company_id"
    WHERE f."valuation" >= 1000000000;
    ```

18. **List companies without select investors:**
    ```sql
    SELECT "company_id"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING"
    WHERE "select_investors" IS NULL
    LIMIT 1000;
    ```

19. **Count unicorns per year founded:**
    ```sql
    SELECT d."year_founded", COUNT(*) AS "unicorns"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
    ON d."company_id" = f."company_id"
    WHERE f."valuation" >= 1000000000
    GROUP BY d."year_founded"
    ORDER BY d."year_founded"
    LIMIT 1000;
    ```

20. **List industries with total funding amounts:**
    ```sql
    SELECT i."industry", SUM(f."funding") AS "total_funding"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
    ON i."company_id" = f."company_id"
    GROUP BY i."industry"
    ORDER BY "total_funding" DESC
    LIMIT 1000;
    ```

These queries are designed to explore the data related to the task, helping to understand the distribution of unicorn companies across industries and years, as well as their valuations and funding details.Query:
SELECT DISTINCT "industry"
   FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES"
   LIMIT 1000;
Answer:
industry
Fintech
Internet software & services
E-commerce & direct-to-consumer
Health
Consumer & retail
Hardware
Other
Mobile & telecommunications
Artificial intelligence
Auto & transportation
Cybersecurity
Data management & analytics
Edtech
"""Supply chain, logistics, & delivery"""
Travel
Query:
SELECT "company_id", "valuation"
   FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING"
   WHERE "valuation" >= 1000000000
   LIMIT 1000;
Answer:
Too long, hard cut:
company_id,valuation
548,2000000000
645,1000000000
615,1000000000
51,10000000000
680,1000000000
457,2000000000
429,2000000000
933,1000000000
568,2000000000
478,2000000000
881,1000000000
189,4000000000
848,1000000000
556,2000000000
999,1000000000
396,2000000000
931,1000000000
364,2000000000
732,1000000000
906,1000000000
72,8000000000
983,1000000000
898,1000000000
844,1000000000
894,1000000000
813,1000000000
743,1000000000
226,4000000000
963,1000000000
764,1000000000
839,1000000000
1033,1000000000
725,1000000000
549,2000000000
667,1000000000
755,1000000000
782,1000000000
175,4000000000
398,2000000000
814,1000000000
436,2000000000
1046,1000000000
565,2000000000
781,1000000000
997,1000000000
194,4000000000
249,3000000000
434,2000000000
1035,1000000000
969,1000000000
1018,1000000000
355,2000000000
934,1000000000
1054,1000000000
901,1000000000
173,4000000000
738,1000000000
422,2000000000
830,1000000000
1004,1000000000
951,1000000000
734,1000000000
1063,1000000000
623,1000000000
846,1000000000
823,1000000000
944,1000000000
1030,1000000000
824,1000000000
930,1000000000
370,2000000000
618,1000000000
456,2000000000
893,1000000000
812,1000000000
1001,1000000000
703,1000000000
884,1000000000
404,2000000000
952,1000000000
625,1000000000
971,1000000000
796,1000000000
909,1000000000
587,2000000000
273,3000000000
771,1000000000
1005,1000000000
758,1000000000
652,1000000000
8,38000000000
760,1000000000
394,2000000000
393,2000000000
870,1000000000
804,1000000000
1041,1000000000
443,2000000000
978,1000000000
612,1000000000
714,1000000000
925,1000000000
421,2000000000
449,2000000000
1022,1000000000
240,3000000000
644,1000000000
718,1000000000
920,1000000000
1048,1000000000
1024,1000000000
929,1000000000
751,1000000000
1012,1000000000
863,1000000000
662,1000000000
1027,1000000000
783,1000000000
592,2000000000
1023,1000000000
1051,1000000000
633,1000000000
635,1000000000
750,1000000000
697,1000000000
886,1000000000
826,1000000000
1000,1000000000
740,1000000000
798,1000000000
1008,1000000000
761,1000000000
701,1000000000
825,1000000000
344,3000000000
695,1000000000
876,1000000000
643,1000000000
509,2000000000
979,1000000000
1031,1000000000
817,1000000000
943,1000000000
975,1000000000
647,1000000000
426,2000000000
705,1000000000
724,1000000000
464,2000000000
942,1000000000
354,3000000000
688,1000000000
1045,1000000000
391,2000000000
891,1000000000
1066,1000000000
579,2000000000
686,1000000000
822,1000000000
882,1000000000
816,1000000000
369,2000000000
340,3000000000
1058,1000000000
129,5000000000
862,1000000000
363,2000000000
603,1000000000
645,1000000000
769,1000000000
788,1000000000
452,2000000000
420,2000000000
996,1000000000
763,1000000000
803,1000000000
765,1000000000
989,1000000000
409,2000000000
580,2000000000
513,2000000000
809,1000000000
791,1000000000
998,1000000000
455,2000000000
477,2000000000
896,1000000000
797,1000000000
361,2000000000
250,3000000000
229,4000000000
540,2000000000
73,8000000000
852,1000000000
78,8000000000
79,8000000000
632,1000000000
314,3000000000
82,8000000000
164,5000000000
85,7000000000
212,4000000000
65,9000000000
258,3000000000
63,9000000000
58,10000000000
31,12000000000
248,3000000000
32,12000000000
252,3000000000
33,12000000000
287,3000000000
251,3000000000
243,3000000000
40,11000000000
44,11000000000
45,11000000000
211,4000000000
50,10000000000
53,10000000000
285,3000000000
217,4000000000
134,5000000000
317,3000000000
365,2000000000
91,7000000000
185,4000000000
121,6000000000
335,3000000000
1014,1000000000
191,4000000000
334,3000000000
118,6000000000
115,6000000000
113,6000000000
147,5000000000
136,5000000000
130,5000000000
321,3000000000
327,3000000000
641,1000000000
352,3000000000
972,1000000000
201,4000000000
168,4000000000
104,6000000000
171,4000000000
350,3000000000
101,7000000000
239,4000000000
1065,1000000000
938,1000000000
828,1000000000
941,1000000000
988,1000000000
484,2000000000
864,1000000000
383,2000000000
1060,1000000000
595,2000000000
840,1000000000
290,3000000000
742,1000000000
964,1000000000
712,1000000000
837,1000000000
583,2000000000
411,2000000000
430,2000000000
875,1000000000
810,1000000000
805,1000000000
953,1000000000
606,1000000000
679,1000000000
907,1000000000
880,1000000000
834,1000000000
542,2000000000
1043,1000000000
410,2000000000
637,1000000000
616,1000000000
611,1000000000
1064,1000000000
1032,1000000000
737,1000000000
374,2000000000
172,4000000000
414,2000000000
845,1000000000
1055,1000000000
416,2000000000
682,1000000000
967,1000000000
551,2000000000
491,2000000000
446,2000000000
982,1000000000
850,1000000000
928,1000000000
380,2000000000
451,2000000000
987,1000000000
842,1000000000
620,1000000000
356,2000000000
872,1000000000
417,2000000000
427,2000000000
255,3000000000
397,2000000000
857,1000000000
588,2000000000
609,1000000000
619,1000000000
681,1000000000
489,2000000000
626,1000000000
649,1000000000
234,4000000000
770,1000000000
614,1000000000
482,2000000000
968,1000000000
899,1000000000
386,2000000000
665,1000000000
1039,1000000000
800,1000000000
457,200
Query:
SELECT "company_id", "date_joined"
   FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES"
   LIMIT 1000;
Answer:
Too long, hard cut:
company_id,date_joined
109,2020-09-08T00:00:00.000
821,2019-05-16T00:00:00.000
153,2019-07-11T00:00:00.000
972,2018-10-17T00:00:00.000
1022,2021-06-02T00:00:00.000
433,2021-04-17T00:00:00.000
747,2018-03-27T00:00:00.000
902,2021-01-27T00:00:00.000
1065,2021-06-01T00:00:00.000
388,2018-05-30T00:00:00.000
748,2019-02-14T00:00:00.000
189,2017-06-24T00:00:00.000
848,2021-06-01T00:00:00.000
556,2022-02-15T00:00:00.000
999,2021-11-17T00:00:00.000
396,2021-10-21T00:00:00.000
931,2021-09-24T00:00:00.000
364,2019-02-01T00:00:00.000
732,2022-01-27T00:00:00.000
906,2021-06-10T00:00:00.000
72,2015-01-23T00:00:00.000
983,2019-08-22T00:00:00.000
898,2022-01-25T00:00:00.000
844,2021-07-07T00:00:00.000
894,2021-12-06T00:00:00.000
813,2021-08-10T00:00:00.000
743,2020-12-24T00:00:00.000
226,2021-01-24T00:00:00.000
963,2021-10-05T00:00:00.000
764,2021-12-07T00:00:00.000
839,2021-12-28T00:00:00.000
1033,2021-01-27T00:00:00.000
725,2022-01-25T00:00:00.000
549,2021-09-22T00:00:00.000
667,2015-01-16T00:00:00.000
755,2021-09-08T00:00:00.000
782,2022-01-31T00:00:00.000
175,2019-06-25T00:00:00.000
398,2021-10-15T00:00:00.000
814,2021-11-16T00:00:00.000
436,2017-04-14T00:00:00.000
1046,2021-06-16T00:00:00.000
565,2021-04-21T00:00:00.000
781,2021-08-31T00:00:00.000
997,2021-12-06T00:00:00.000
194,2021-03-18T00:00:00.000
249,2021-06-29T00:00:00.000
434,2021-05-19T00:00:00.000
1035,2021-11-18T00:00:00.000
969,2022-01-26T00:00:00.000
1018,2021-02-18T00:00:00.000
355,2021-09-14T00:00:00.000
934,2020-03-17T00:00:00.000
1054,2021-05-18T00:00:00.000
901,2021-11-08T00:00:00.000
173,2021-12-20T00:00:00.000
738,2022-01-11T00:00:00.000
422,2022-02-16T00:00:00.000
830,2021-03-30T00:00:00.000
1004,2021-05-24T00:00:00.000
951,2015-03-06T00:00:00.000
734,2022-01-27T00:00:00.000
1063,2021-11-10T00:00:00.000
623,2015-04-21T00:00:00.000
846,2019-10-21T00:00:00.000
823,2019-05-21T00:00:00.000
944,2021-07-22T00:00:00.000
1030,2021-08-09T00:00:00.000
824,2016-04-14T00:00:00.000
930,2022-02-22T00:00:00.000
370,2018-07-09T00:00:00.000
618,2018-10-18T00:00:00.000
456,2020-01-29T00:00:00.000
893,2021-09-02T00:00:00.000
812,2022-03-31T00:00:00.000
1001,2020-09-21T00:00:00.000
703,2021-12-02T00:00:00.000
884,2021-12-14T00:00:00.000
404,2021-03-19T00:00:00.000
952,2022-03-30T00:00:00.000
625,2020-01-28T00:00:00.000
971,2021-11-02T00:00:00.000
796,2017-07-20T00:00:00.000
909,2022-01-27T00:00:00.000
587,2018-05-17T00:00:00.000
273,2022-04-05T00:00:00.000
771,2021-09-28T00:00:00.000
758,2021-12-21T00:00:00.000
652,2021-06-15T00:00:00.000
8,2017-12-20T00:00:00.000
760,2020-11-17T00:00:00.000
394,2022-01-31T00:00:00.000
393,2021-09-27T00:00:00.000
870,2021-02-16T00:00:00.000
804,2021-09-16T00:00:00.000
1041,2021-11-02T00:00:00.000
443,2022-03-17T00:00:00.000
978,2021-01-07T00:00:00.000
612,2021-12-31T00:00:00.000
714,2017-10-17T00:00:00.000
925,2022-03-21T00:00:00.000
421,2020-11-16T00:00:00.000
449,2021-07-03T00:00:00.000
1022,2021-06-02T00:00:00.000
240,2016-05-11T00:00:00.000
644,2021-01-25T00:00:00.000
718,2021-09-30T00:00:00.000
920,2021-08-10T00:00:00.000
1048,2021-09-30T00:00:00.000
1024,2021-04-22T00:00:00.000
929,2021-12-22T00:00:00.000
751,2022-01-13T00:00:00.000
1012,2017-10-23T00:00:00.000
863,2021-12-07T00:00:00.000
662,2020-12-21T00:00:00.000
1027,2021-06-24T00:00:00.000
783,2021-03-26T00:00:00.000
592,2021-11-17T00:00:00.000
1023,2021-01-26T00:00:00.000
1051,2021-11-03T00:00:00.000
633,2021-04-07T00:00:00.000
635,2021-06-02T00:00:00.000
750,2022-01-26T00:00:00.000
697,2021-12-20T00:00:00.000
886,2021-03-30T00:00:00.000
826,2022-01-13T00:00:00.000
1000,2022-01-12T00:00:00.000
740,2022-03-16T00:00:00.000
798,2021-02-11T00:00:00.000
1008,2021-11-08T00:00:00.000
761,2022-02-28T00:00:00.000
701,2020-12-31T00:00:00.000
825,2021-10-13T00:00:00.000
344,2021-06-29T00:00:00.000
695,2022-01-11T00:00:00.000
876,2018-11-06T00:00:00.000
643,2021-12-15T00:00:00.000
509,2021-08-04T00:00:00.000
979,2021-02-25T00:00:00.000
1031,2021-10-07T00:00:00.000
817,2021-05-04T00:00:00.000
943,2019-03-22T00:00:00.000
975,2021-04-30T00:00:00.000
647,2020-12-10T00:00:00.000
426,2022-01-26T00:00:00.000
705,2021-12-07T00:00:00.000
724,2022-01-24T00:00:00.000
464,2022-03-17T00:00:00.000
942,2021-04-20T00:00:00.000
354,2019-12-05T00:00:00.000
688,2019-05-15T00:00:00.000
1045,2022-02-22T00:00:00.000
391,2021-12-17T00:00:00.000
891,2022-02-22T00:00:00.000
1066,2017-09-21T00:00:00.000
579,2021-10-06T00:00:00.000
686,2021-07-28T00:00:00.000
822,2021-12-28T00:00:00.000
882,2021-06-16T00:00:00.000
816,2022-02-22T00:00:00.000
369,2021-03-01T00:00:00.000
340,2022-01-13T00:00:00.000
1058,2019-05-07T00:00:00.000
129,2020-09-29T00:00:00.000
862,2021-07-13T00:00:00.000
363,2017-10-30T00:00:00.000
603,2021-01-25T00:00:00.000
645,2021-05-06T00:00:00.000
769,2021-05-18T00:00:00.000
788,2022-01-12T00:00:00.000
452,2021-06-08T00:00:00.000
420,2022-01-04T00:00:00.000
996,2022-01-11T00:00:00.000
763,2021-05-07T00:00:00.000
803,2022-02-08T00:00:00.000
765,2021-06-03T00:00:00.000
989,2020-06-17T00:00:00.000
Query:
SELECT i."industry", COUNT(*) AS "unicorn_count"
FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
  ON i."company_id" = d."company_id"
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
  ON i."company_id" = f."company_id"
WHERE f."valuation" >= 1000000000
  AND TRY_TO_TIMESTAMP(d."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3') BETWEEN '2019-01-01' AND '2021-12-31'
GROUP BY i."industry"
ORDER BY "unicorn_count" DESC
LIMIT 1000;
Answer:
industry,unicorn_count
Fintech,181
Internet software & services,157
E-commerce & direct-to-consumer,76
Health,53
Artificial intelligence,53
Other,44
Cybersecurity,38
"""Supply chain, logistics, & delivery""",36
Data management & analytics,31
Mobile & telecommunications,18
Edtech,17
Auto & transportation,16
Hardware,15
Consumer & retail,11
Travel,7
Query:
SELECT d."company_id", d."date_joined", f."valuation"
   FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
   JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
   ON d."company_id" = f."company_id"
   WHERE f."valuation" >= 1000000000
   LIMIT 1000;
Answer:
Too long, hard cut:
company_id,date_joined,valuation
109,2020-09-08T00:00:00.000,6000000000
821,2019-05-16T00:00:00.000,1000000000
153,2019-07-11T00:00:00.000,5000000000
972,2018-10-17T00:00:00.000,1000000000
1022,2021-06-02T00:00:00.000,1000000000
433,2021-04-17T00:00:00.000,2000000000
747,2018-03-27T00:00:00.000,1000000000
902,2021-01-27T00:00:00.000,1000000000
1065,2021-06-01T00:00:00.000,1000000000
388,2018-05-30T00:00:00.000,2000000000
748,2019-02-14T00:00:00.000,1000000000
189,2017-06-24T00:00:00.000,4000000000
848,2021-06-01T00:00:00.000,1000000000
556,2022-02-15T00:00:00.000,2000000000
999,2021-11-17T00:00:00.000,1000000000
396,2021-10-21T00:00:00.000,2000000000
931,2021-09-24T00:00:00.000,1000000000
364,2019-02-01T00:00:00.000,2000000000
732,2022-01-27T00:00:00.000,1000000000
906,2021-06-10T00:00:00.000,1000000000
72,2015-01-23T00:00:00.000,8000000000
983,2019-08-22T00:00:00.000,1000000000
898,2022-01-25T00:00:00.000,1000000000
844,2021-07-07T00:00:00.000,1000000000
894,2021-12-06T00:00:00.000,1000000000
813,2021-08-10T00:00:00.000,1000000000
743,2020-12-24T00:00:00.000,1000000000
226,2021-01-24T00:00:00.000,4000000000
963,2021-10-05T00:00:00.000,1000000000
764,2021-12-07T00:00:00.000,1000000000
839,2021-12-28T00:00:00.000,1000000000
1033,2021-01-27T00:00:00.000,1000000000
725,2022-01-25T00:00:00.000,1000000000
549,2021-09-22T00:00:00.000,2000000000
667,2015-01-16T00:00:00.000,1000000000
755,2021-09-08T00:00:00.000,1000000000
782,2022-01-31T00:00:00.000,1000000000
175,2019-06-25T00:00:00.000,4000000000
398,2021-10-15T00:00:00.000,2000000000
814,2021-11-16T00:00:00.000,1000000000
436,2017-04-14T00:00:00.000,2000000000
1046,2021-06-16T00:00:00.000,1000000000
565,2021-04-21T00:00:00.000,2000000000
781,2021-08-31T00:00:00.000,1000000000
997,2021-12-06T00:00:00.000,1000000000
194,2021-03-18T00:00:00.000,4000000000
249,2021-06-29T00:00:00.000,3000000000
434,2021-05-19T00:00:00.000,2000000000
1035,2021-11-18T00:00:00.000,1000000000
969,2022-01-26T00:00:00.000,1000000000
1018,2021-02-18T00:00:00.000,1000000000
355,2021-09-14T00:00:00.000,2000000000
934,2020-03-17T00:00:00.000,1000000000
1054,2021-05-18T00:00:00.000,1000000000
901,2021-11-08T00:00:00.000,1000000000
173,2021-12-20T00:00:00.000,4000000000
738,2022-01-11T00:00:00.000,1000000000
422,2022-02-16T00:00:00.000,2000000000
830,2021-03-30T00:00:00.000,1000000000
1004,2021-05-24T00:00:00.000,1000000000
951,2015-03-06T00:00:00.000,1000000000
734,2022-01-27T00:00:00.000,1000000000
1063,2021-11-10T00:00:00.000,1000000000
623,2015-04-21T00:00:00.000,1000000000
846,2019-10-21T00:00:00.000,1000000000
823,2019-05-21T00:00:00.000,1000000000
944,2021-07-22T00:00:00.000,1000000000
1030,2021-08-09T00:00:00.000,1000000000
824,2016-04-14T00:00:00.000,1000000000
930,2022-02-22T00:00:00.000,1000000000
370,2018-07-09T00:00:00.000,2000000000
618,2018-10-18T00:00:00.000,1000000000
456,2020-01-29T00:00:00.000,2000000000
893,2021-09-02T00:00:00.000,1000000000
812,2022-03-31T00:00:00.000,1000000000
1001,2020-09-21T00:00:00.000,1000000000
703,2021-12-02T00:00:00.000,1000000000
884,2021-12-14T00:00:00.000,1000000000
404,2021-03-19T00:00:00.000,2000000000
952,2022-03-30T00:00:00.000,1000000000
625,2020-01-28T00:00:00.000,1000000000
971,2021-11-02T00:00:00.000,1000000000
796,2017-07-20T00:00:00.000,1000000000
909,2022-01-27T00:00:00.000,1000000000
587,2018-05-17T00:00:00.000,2000000000
273,2022-04-05T00:00:00.000,3000000000
771,2021-09-28T00:00:00.000,1000000000
758,2021-12-21T00:00:00.000,1000000000
652,2021-06-15T00:00:00.000,1000000000
8,2017-12-20T00:00:00.000,38000000000
760,2020-11-17T00:00:00.000,1000000000
394,2022-01-31T00:00:00.000,2000000000
393,2021-09-27T00:00:00.000,2000000000
870,2021-02-16T00:00:00.000,1000000000
804,2021-09-16T00:00:00.000,1000000000
1041,2021-11-02T00:00:00.000,1000000000
443,2022-03-17T00:00:00.000,2000000000
978,2021-01-07T00:00:00.000,1000000000
612,2021-12-31T00:00:00.000,1000000000
714,2017-10-17T00:00:00.000,1000000000
925,2022-03-21T00:00:00.000,1000000000
421,2020-11-16T00:00:00.000,2000000000
449,2021-07-03T00:00:00.000,2000000000
1022,2021-06-02T00:00:00.000,1000000000
240,2016-05-11T00:00:00.000,3000000000
644,2021-01-25T00:00:00.000,1000000000
718,2021-09-30T00:00:00.000,1000000000
920,2021-08-10T00:00:00.000,1000000000
1048,2021-09-30T00:00:00.000,1000000000
1024,2021-04-22T00:00:00.000,1000000000
929,2021-12-22T00:00:00.000,1000000000
751,2022-01-13T00:00:00.000,1000000000
1012,2017-10-23T00:00:00.000,1000000000
863,2021-12-07T00:00:00.000,1000000000
662,2020-12-21T00:00:00.000,1000000000
1027,2021-06-24T00:00:00.000,1000000000
783,2021-03-26T00:00:00.000,1000000000
592,2021-11-17T00:00:00.000,2000000000
1023,2021-01-26T00:00:00.000,1000000000
1051,2021-11-03T00:00:00.000,1000000000
633,2021-04-07T00:00:00.000,1000000000
635,2021-06-02T00:00:00.000,1000000000
750,2022-01-26T00:00:00.000,1000000000
697,2021-12-20T00:00:00.000,1000000000
886,2021-03-30T00:00:00.000,1000000000
826,2022-01-13T00:00:00.000,1000000000
1000,2022-01-12T00:00:00.000,1000000
Query:
SELECT i."industry", COUNT(*) AS "unicorn_count"
   FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
   JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
   ON i."company_id" = f."company_id"
   WHERE f."valuation" >= 1000000000
   GROUP BY i."industry"
   ORDER BY "unicorn_count" DESC
   LIMIT 1000;
Answer:
industry,unicorn_count
Fintech,233
Internet software & services,209
E-commerce & direct-to-consumer,113
Artificial intelligence,84
Health,75
Other,59
"""Supply chain, logistics, & delivery""",57
Cybersecurity,50
Data management & analytics,41
Mobile & telecommunications,39
Hardware,34
Auto & transportation,34
Edtech,28
Consumer & retail,26
Travel,14
Query:
SELECT i."industry", COUNT(*) AS "unicorn_count"
FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
  ON i."company_id" = d."company_id"
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
  ON i."company_id" = f."company_id"
WHERE f."valuation" >= 1000000000
  AND TRY_TO_DATE(SUBSTR(d."date_joined", 1, 10), 'YYYY-MM-DD') BETWEEN '2019-01-01' AND '2021-12-31'
GROUP BY i."industry"
ORDER BY "unicorn_count" DESC
LIMIT 1000;
Answer:
industry,unicorn_count
Fintech,181
Internet software & services,157
E-commerce & direct-to-consumer,76
Health,53
Artificial intelligence,53
Other,44
Cybersecurity,38
"""Supply chain, logistics, & delivery""",36
Data management & analytics,31
Mobile & telecommunications,18
Edtech,17
Auto & transportation,16
Hardware,15
Consumer & retail,11
Travel,7
Query:
SELECT EXTRACT(YEAR FROM TRY_TO_TIMESTAMP(d."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) AS "year",
       COUNT(*) AS "unicorns"
FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
  ON d."company_id" = i."company_id"
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
  ON d."company_id" = f."company_id"
WHERE f."valuation" >= 1000000000
  AND i."industry" = 'Fintech'
  AND TRY_TO_TIMESTAMP(d."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3') IS NOT NULL
  AND EXTRACT(YEAR FROM TRY_TO_TIMESTAMP(d."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) BETWEEN 2019 AND 2021
GROUP BY "year"
ORDER BY "year";
Answer:
year,unicorns
2019,21
2020,18
2021,142
Query:
SELECT TO_NUMBER(SUBSTRING(d."date_joined", 1, 4)) AS "year",
       COUNT(*) AS "unicorns"
FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
  ON d."company_id" = i."company_id"
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
  ON d."company_id" = f."company_id"
WHERE f."valuation" >= 1000000000
  AND i."industry" = 'Fintech'
  AND TO_NUMBER(SUBSTRING(d."date_joined", 1, 4)) BETWEEN 2019 AND 2021
GROUP BY "year"
ORDER BY "year";
Answer:
year,unicorns
2019,21
2020,18
2021,142
Query:
SELECT AVG("unicorns") AS average_number_of_new_unicorn_companies_per_year
FROM (
    SELECT TO_NUMBER(SUBSTRING(d."date_joined", 1, 4)) AS "year",
           COUNT(*) AS "unicorns"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
      ON d."company_id" = i."company_id"
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
      ON d."company_id" = f."company_id"
    WHERE f."valuation" >= 1000000000
      AND TO_NUMBER(SUBSTRING(d."date_joined", 1, 4)) BETWEEN 2019 AND 2021
      AND i."industry" = (
        SELECT i2."industry"
        FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i2
        JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d2
          ON i2."company_id" = d2."company_id"
        JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f2
          ON i2."company_id" = f2."company_id"
        WHERE f2."valuation" >= 1000000000
          AND TO_NUMBER(SUBSTRING(d2."date_joined", 1, 4)) BETWEEN 2019 AND 2021
        GROUP BY i2."industry"
        ORDER BY COUNT(*) DESC
        LIMIT 1
      )
    GROUP BY "year"
) sub;
Answer:
AVERAGE_NUMBER_OF_NEW_UNICORN_COMPANIES_PER_YEAR
60.333333
Query:
SELECT d."company_id", d."year_founded"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
    ON d."company_id" = f."company_id"
    WHERE f."valuation" >= 1000000000
    LIMIT 1000;
Answer:
Too long, hard cut:
company_id,year_founded
109,2004
821,2009
153,2016
972,2016
1022,2013
433,2013
747,2011
902,2015
1065,2015
388,2009
748,2009
189,1919
848,2019
556,2011
999,2020
396,2021
931,2020
364,2015
732,2017
906,2017
72,2006
983,1999
898,2015
844,2018
894,2020
813,2017
743,2015
226,2020
963,2017
764,2018
839,2016
1033,2006
725,2010
549,2016
667,2014
755,2017
782,2021
175,2011
398,2017
814,2014
436,2006
1046,2014
565,2013
781,2018
997,2011
194,2001
249,2019
434,2014
1035,2020
969,2014
1018,2011
355,2017
934,2011
1054,2016
901,2020
173,2018
738,2018
422,2019
830,2017
1004,2016
951,2011
734,2012
1063,2018
623,2013
846,2015
823,2000
944,2005
1030,2019
824,2012
930,2017
370,2010
618,2009
456,2016
893,2020
812,2019
1001,2020
703,2018
884,2020
404,2010
952,2021
625,2012
971,2015
796,2012
909,2015
587,2014
273,2013
771,2017
758,2016
652,2015
8,2015
760,2016
394,2016
393,2013
870,2016
804,2019
1041,2015
443,2017
978,2015
612,2016
714,2021
925,2012
421,2009
449,2019
1022,2013
240,2006
644,2016
718,2015
920,2004
1048,2014
1024,2011
929,2019
751,2015
1012,2015
863,2019
662,2015
1027,2012
783,2016
592,2018
1023,2018
1051,2009
633,2011
635,2011
750,2014
697,2018
886,2016
826,2012
1000,2016
740,2016
798,2017
1008,2020
761,2012
701,2007
825,2014
344,2010
695,2013
876,2011
643,2016
509,2014
979,2013
1031,2017
817,2014
943,2014
975,2015
647,2000
426,2015
705,2018
724,2008
464,2019
942,2018
354,2011
688,2015
1045,2015
391,2020
891,2014
1066,1997
579,2018
686,2014
822,2021
882,2013
816,2001
369,2015
340,2017
1058,2012
129,1994
862,2016
363,2014
603,2013
645,2015
645,2015
769,2016
788,2017
452,2013
420,2012
996,2015
763,2016
803,2009
765,2012
989,2016
409,2013
580,2011
513,2018
809,2019
791,2015
998,2011
455,2014
477,2016
896,2012
797,2017
361,2000
250,2015
229,2011
540,2015
73,2012
852,2015
78,2019
79,1996
632,1999
314,2021
82,2018
164,2017
85,2014
212,2016
65,2015
258,2016
63,2016
58,2005
31,2017
248,2015
32,2013
252,2011
33,2017
287,2015
251,2010
243,2015
40,2013
44,2014
45,2011
211,1995
50,2012
53,2015
285,2014
217,2009
134,2015
317,2020
365,2015
91,2012
185,2014
121,2001
335,2013
1014,2019
191,2017
334,2011
118,1994
115,2012
113,2014
147,2008
136,2013
130,2015
321,2016
327,2017
641,2011
352,2012
972,2016
201,2015
168,2019
104,2010
171,2012
350,2012
101,2017
239,2011
1065,2015
938,2015
828,2017
941,2006
988,2013
484,2018
864,2021
383,2010
1060,2017
595,1999
840,1990
290,2008
742,2014
964,2014
712,2017
837,2016
583,2014
411,2018
430,2016
875,2018
810,2019
805,2015
953,2019
606,2009
679,2015
907,2016
880,2018
834,2016
542,2016
1043,1993
410,2004
637,2017
616,2010
611,2016
1064,2014
1032,2005
737,2020
374,2008
172,2012
414,2020
845,2014
1055,2010
416,2018
682,2006
967,2021
551,2012
491,2014
446,2012
982,2020
850,2013
928,2017
380,2007
451,2004
987,2012
842,2008
620,2001
356,2015
872,2011
417,2010
427,2019
255,2012
397,2016
857,2014
588,2009
1005,2015
609,2017
619,2015
681,2019
489,2005
626,2010
649,2016
234,2000
770,2013
614,2015
482,2019
968,2011
899,2014
386,2007
665,2011
1039,2016
800,2010
457,2019
457,2019
676,2018
1050,2007
694,2018
481,2011
878,2013
995,2018
1034,2017
855,2018
345,2015
691,2014
860,2008
511,2016
704,2016
881,2014
881,2014
747,2011
861,2019
407,2016
858,2018
749,2015
841,2014
282,2013
1026,2015
630,2009
621,2016
847,2009
223,2011
1009,2000
563,2011
476,2011
970,2012
990,2017
728,2013
415,2016
956,2014
418,2012
892,2019
991,2016
1028,2003
454,2016
400,2011
1042,2012
753,2015
911,2016
819,2012
507,2012
910,2012
756,2018
480,2014
405,2008
683,2012
959,2011
954,2015
203,2016
170,2015
698,2019
790,2008
962,2017
865,2015
461,2014
670,2015
529,2019
634,2017
897,2014
924,2007
768,2013
707,2016
673,2016
1049,2016
1017,2009
856,2017
1007,2015
462,2015
832,2004
265,2016
485,2015
490,2010
723,2017
913,2009
534,2017
494,2013
849,2009
908,2015
264,2018
550,2013
778,2012
624,2011
958,2007
440,2017
921,2011
926,2015
584,2012
980,2014
468,2019
709,2013
138,2014
719,2018
505,2001
811,2012
395,2015
746,2016
1052,2014
806,2016
873,2013
966,2016
545,2011
912,2015
187,2016
47,2012
868,2011
671,2017
521,2014
591,2016
593,2015
84,1998
459,2020
514,2005
425,2016
561,2010
303,2014
914,2012
957,2014
368,2018
204,2015
14,2013
1010,2015
10,2015
220,2014
615,2016
615,2016
6,2012
3,2010
34,2015
12,2018
657,2016
169,2011
2,2008
26,2017
93,2011
176,2015
86,2011
66,2016
64,2016
62,2005
60,2018
71,2007
640,2008
56,2013
76,2015
83,2013
149,2015
67,2013
155,2018
103,1999
523,2018
789,2019
961,2013
854,2014
554,2021
522,2017
935,2010
552,2017
687,2015
815,2017
895,2016
510,2013
531,2016
949,2014
833,2014
650,2013
1057,2011
785,2008
408,2011
1015,2018
642,2013
617,2015
779,2015
475,2012
349,2019
272,2015
708,2014
916,2011
289,2014
675,2015
266,2017
784,2019
471,2011
622,1998
574,2011
766,2012
693,2012
390,2004
413,2015
684,2015
801,2019
748,2009
206,2018
752,2014
820,2013
965,2007
448,2011
902,2015
1036,2016
304,2016
325,2015
1019,2015
690,2015
636,2007
342,2015
343,2014
933,2016
933,2016
1011,2007
1062,2009
428,2010
1021,2014
332,2013
950,2017
54,2012
3
Query:
SELECT "company_id", "select_investors"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING"
    WHERE "valuation" >= 1000000000
    LIMIT 1000;
Answer:
Too long, hard cut:
company_id,select_investors
548,"""Accel Partners, Index Ventures, Insight Venture Partners"""
645,"""Sequoia Capital China, China Life Investment Holding Company, Qiming Venture Partners"""
615,"""CreditEase Fintech Investment Fund, BMW i Ventures, SoftBank Group"""
51,"""DFJ Growth Fund, Coatue Management, Addition"""
680,"""China Grand Prosperity Investment, CSC Group"""
457,"""QED Investors, DST Global, Left Lane Capital"""
429,"""Sodexo Ventures, SoftBank Group"""
933,Ginko Ventures
568,"""CRV, Blue Cloud Ventures, Index Ventures"""
478,"""Thrive Capital, Tiger Global Management, Temasek"""
881,"""WRVI Capital, Caffeinated Capital, Y Combinator"""
189,EQT Partners
848,"""Dragonfly Captial, Qiming Venture Partners, DST Global"""
556,"""Blackstone, Bessemer Venture Partners"""
999,"""Goldman Sachs Asset Management, 3L"""
396,"""Insight Partners, Softbank Group, Connect Ventures"""
931,"""Tencent Holdings, Hillhouse Capital Management"""
364,"""K2VC, Lightspeed China Partners, Sky9 Capital"""
732,"""Initialized Capital, General Catalyst, Kraken Ventures"""
906,"""Delian Capital, China International Capital Corporation, Sequoia Capital China"""
72,"""Accel Partners, Sequoia Capital"""
983,"""Investment Corporation of Dubai, Centralway"""
898,"""Lightspeed India Partners, Sequoia Capital India, Endiya Partners"""
844,"""General Catalyst, Future Ventures, AU21"""
894,"""DST Global, General Catalyst, Monashees+"""
813,"""Polychain Capital, Coinbase Ventures, Jump Capital"""
743,"""Coatue Management, H Capital, Capital Today"""
226,"""Andreessen Horowitz, TQ Ventures"""
963,"""Left Lane Capital, Galaxy Interactive, Tru Arrow Partners"""
764,"""Craft Ventures, Caffeinated Capital, Operator Collective"""
839,"""Fireside Ventures, Sequoia Capital India, Stellaris Venture Partners"""
1033,"""Storm Ventures, DFJ DragonFund, New Enterprise Associates"""
725,"""SC.Holdings, Not Boring Capital, Bolt Ventures"""
549,"""Northern Light Venture Capital, Xiaomi, FutureX Capital"""
667,"""Redpoint Ventures, QiMing Venture Partners, Chengwei Capital"""
755,"""Passion Capital, Hedosophia, Outrun Ventures"""
782,"""Paradigm, Andreessen Horowitz, Jump Capital"""
175,"""Bnk To The Future, Trammell Ventures, SBI Investment"""
398,"""Accomplice, Polychain Capital, GoldenTree Asset Management"""
814,"""M13, Lightspeed Venture Partners, Lone Pine Capital"""
436,GAM Holding
1046,"""Insight Partners, Ignition Partners, Georgian Partners"""
565,"""Tomales Bay Capital, Bain & Company, General Catalyst"""
781,"""Pantera Capital, Polychain Capital, Lightspeed Venture Partners"""
997,"""Prysm Capital, Baillie Gifford & Co., TDM Growth Partners"""
194,"""Silver Lake, ICONIQ Capital"""
249,"""Day One Ventures, Coinbase Ventures, Andreessen Horowitz"""
434,"""Shunwei Capital Partners, China Media Group, Guangzhou Huiyin Aofeng Equity Investment Fund"""
1035,"""Index Ventures, Benchmark, Thrive Capital"""
969,"""General Catalyst, Nexus Venture Partners, Dell Technologies Capital"""
1018,"""New Enterprise Associates, Accel, Bond"""
355,"""VGames, Lakestar, Galaxy Interactive"""
934,"""Technology Crossover Ventures, Alkeon Capital Management, General Atlantic"""
1054,"""Sequoia Capital, Founders Fund, Bling Capital"""
901,"""Cowboy Ventures, Leaders Fund, GGV Capital"""
173,"""Foundation Capital, Frontier Ventures, AltaIR Capital"""
738,"""Left Lane Capital, Walden Venture Capital"""
422,"""Amplify Partners, Addition, Madrona Venture Group"""
830,"""Thrive Capital, Khosla Ventures, Tiger Global Management"""
1004,Bregal Sagemount
951,"""5Y Capital, Matrix Partners China, K2VC"""
734,"""Zeev Ventures, GSV Ventures"""
1063,"""Equal Ventures, Uncork Capital, Andreessen Horowitz"""
623,"""Matrix Partners China, Ventech China, Shunwei Capital Partners"""
846,"""New Enterprise Associates, Greylock Partners, Andreessen Horowitz"""
823,"""Ardian, Tiger Global Management, KKR"""
944,"""Kleiner Perkins Caufield & Byers, NightDragon Security, Venrock"""
1030,"""Greylock Partners, Google Ventures, BlackRock"""
824,"""Tiantu Capital, SAIF Partners China, Newsion Venture Capital"""
930,"""Nexus Venture Partners, Vertex Ventures, STRIVE"""
370,"""Boxin Capital, DT Capital Partners, IDG Capital"""
618,"""U.S.-China Green Fund, Founder H Fund, Richland Equities"""
456,"""next47, First Round Capital, Sequoia Capital"""
893,"""Andreessen Horowitz, DST Global, IDG Capital"""
812,"""General Catalyst, Inspired Capital, Flybridge Capital Partners"""
1001,"""Sozo Ventures, Caffeinated Capital, Sequoia Capital"""
703,"""Innovation Endeavors, s28 Capital, Lightspeed Venture Partners"""
884,"""Thrive Capital, General Catalyst, Coatue Management"""
404,"""Moonshots Capital, BoxGroup, Blu Venture Investors"""
952,"""Andreessen Horowitz, FTX Ventures, Tiger Global Management"""
625,"""Index Ventures, Thrive Capital, Bain Capital Ventures"""
971,"""GGV Capital, GSR Ventures, FreesFund"""
796,"""Sequoia Capital China, Qiming Venture Partners, Tencent Holdings"""
909,"""Next Pl
Query:
SELECT COUNT(*) AS "total_unicorns"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING"
    WHERE "valuation" >= 1000000000
    LIMIT 1000;
Answer:
total_unicorns
1085
Query:
SELECT i."industry", AVG(f."valuation") AS "average_valuation"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
    ON i."company_id" = f."company_id"
    GROUP BY i."industry"
    ORDER BY "average_valuation" DESC
    LIMIT 1000;
Answer:
industry,average_valuation
Artificial intelligence,4488095238.095238
Other,4288135593.220339
Consumer & retail,4153846153.846154
Fintech,3909871244.635193
E-commerce & direct-to-consumer,3787610619.469027
Edtech,3571428571.428571
Data management & analytics,3317073170.731707
Travel,3285714285.714286
"""Supply chain, logistics, & delivery""",3105263157.894737
Auto & transportation,3029411764.705882
Hardware,2911764705.882353
Internet software & services,2885167464.114833
Health,2653333333.333333
Cybersecurity,2580000000.000000
Mobile & telecommunications,2307692307.692308
Query:
SELECT "company_id", "funding"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING"
    LIMIT 1000;
Answer:
Too long, hard cut:
company_id,funding
548,449000000
645,188000000
615,2000000000
51,564000000
680,362000000
457,236000000
429,340000000
933,330000000
568,342000000
478,792000000
881,241000000
189,0
848,100000000
556,100000000
999,100000000
396,100000000
931,100000000
364,101000000
732,102000000
906,105000000
72,105000000
983,105000000
898,107000000
844,107000000
894,109000000
813,109000000
743,10000000
226,110000000
963,110000000
764,111000000
839,111000000
1033,114000000
725,115000000
549,115000000
667,116000000
755,116000000
782,118000000
175,119000000
398,119000000
814,120000000
436,120000000
1046,120000000
565,121000000
781,124000000
997,125000000
194,125000000
249,125000000
434,125000000
1035,126000000
969,126000000
1018,127000000
355,127000000
934,127000000
1054,128000000
901,128000000
173,128000000
738,128000000
422,129000000
830,130000000
1004,130000000
951,130000000
734,130000000
1063,131000000
623,131000000
846,132000000
823,134000000
944,135000000
1030,135000000
824,136000000
930,137000000
370,137000000
618,139000000
456,139000000
893,140000000
812,140000000
1001,140000000
703,141000000
884,141000000
404,142000000
952,143000000
625,143000000
971,144000000
796,144000000
909,145000000
587,147000000
273,148000000
771,148000000
1005,226000000
758,148000000
652,149000000
8,14000000000
760,14000000
394,150000000
393,150000000
870,150000000
804,150000000
1041,151000000
443,151000000
978,151000000
612,151000000
714,151000000
925,152000000
421,152000000
449,152000000
1022,154000000
240,154000000
644,154000000
718,156000000
920,156000000
1048,156000000
1024,157000000
929,157000000
751,157000000
1012,15000000
863,160000000
662,160000000
1027,161000000
783,161000000
592,161000000
1023,163000000
1051,163000000
633,163000000
635,164000000
750,165000000
697,165000000
886,165000000
826,166000000
1000,166000000
740,166000000
798,167000000
1008,167000000
761,167000000
701,169000000
825,169000000
344,170000000
695,170000000
876,170000000
643,171000000
509,172000000
979,172000000
1031,172000000
817,172000000
943,173000000
975,174000000
647,174000000
426,177000000
705,177000000
724,178000000
464,179000000
942,17000000
354,180000000
688,181000000
1045,181000000
391,181000000
891,182000000
1066,182000000
579,183000000
686,183000000
822,185000000
882,185000000
816,186000000
369,186000000
340,187000000
1058,187000000
129,187000000
862,187000000
363,188000000
603,188000000
645,188000000
769,189000000
788,189000000
452,190000000
420,190000000
996,190000000
763,191000000
803,192000000
765,192000000
989,192000000
409,192000000
580,192000000
513,193000000
809,193000000
791,194000000
998,195000000
455,195000000
477,195000000
896,196000000
797,197000000
361,19000000
250,1000000000
229,1000000000
540,1000000000
73,1000000000
852,1000000000
78,1000000000
79,1000000000
632,1000000000
314,1000000000
82,1000000000
164,1000000000
85,1000000000
212,1000000000
65,1000000000
258,1000000000
63,1000000000
58,1000000000
31,1000000000
248,1000000000
32,1000000000
252,1000000000
33,1000000000
287,1000000000
251,1000000000
243,1000000000
40,1000000000
44,1000000000
45,1000000000
211,1000000000
50,1000000000
53,1000000000
285,1000000000
217,1000000000
134,1000000000
317,1000000000
365,1000000000
91,1000000000
185,1000000000
121,1000000000
335,1000000000
1014,1000000000
191,1000000000
334,1000000000
118,1000000000
115,1000000000
113,1000000000
147,1000000000
136,1000000000
130,1000000000
321,1000000000
327,1000000000
641,1000000000
352,1000000000
972,1000000000
201,1000000000
168,1000000000
104,1000000000
171,1000000000
350,1000000000
101,1000000000
239,1000000
1065,200000000
938,200000000
828,200000000
941,200000000
988,200000000
484,200000000
864,200000000
383,200000000
1060,200000000
595,200000000
840,200000000
290,200000000
742,201000000
964,202000000
712,202000000
837,202000000
583,202000000
411,203000000
430,204000000
875,205000000
810,205000000
805,205000000
953,205000000
606,206000000
679,207000000
907,209000000
880,210000000
834,210000000
542,210000000
1043,210000000
410,211000000
637,211000000
616,211000000
611,214000000
1064,215000000
1032,215000000
737,215000000
374,216000000
172,216000000
414,217000000
845,217000000
1055,217000000
416,218000000
682,218000000
967,218000000
551,218000000
491,218000000
446,219000000
982,220000000
850,221000000
928,221000000
380,221000000
451,222000000
987,223000000
842,223000000
620,223000000
356,224000000
872,224000000
417,225000000
427,225000000
255,225000000
397,225000000
857,226000000
588,226000000
609,227000000
619,227000000
681,228000000
489,229000000
626,229000000
649,230000000
234,230000000
770,230000000
614,231000000
482,231000000
968,232000000
899,232000000
386,233000000
665,235000000
1039,235000000
800,236000000
457,236000000
676,236000000
1050,237000000
694,237000000
481,237000000
878,238000000
995,239000000
1034,239000000
855,240000000
345,240000000
691,240000000
860,240000000
511,240000000
704,241000000
881,241000000
747,241000000
861,243000000
407,245000000
858,245000000
749,246000000
841,247000000
282,24
Query:
SELECT d."company_id", d."year_founded", f."valuation"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
    ON d."company_id" = f."company_id"
    WHERE f."valuation" >= 1000000000
      AND d."year_founded" > 2010
    LIMIT 1000;
Answer:
Too long, hard cut:
company_id,year_founded,valuation
645,2015,1000000000
615,2016,1000000000
51,2017,10000000000
680,2016,1000000000
457,2019,2000000000
429,2015,2000000000
933,2016,1000000000
568,2013,2000000000
478,2013,2000000000
881,2014,1000000000
848,2019,1000000000
556,2011,2000000000
999,2020,1000000000
396,2021,2000000000
931,2020,1000000000
364,2015,2000000000
732,2017,1000000000
906,2017,1000000000
898,2015,1000000000
844,2018,1000000000
894,2020,1000000000
813,2017,1000000000
743,2015,1000000000
226,2020,4000000000
963,2017,1000000000
764,2018,1000000000
839,2016,1000000000
549,2016,2000000000
667,2014,1000000000
755,2017,1000000000
782,2021,1000000000
175,2011,4000000000
398,2017,2000000000
814,2014,1000000000
1046,2014,1000000000
565,2013,2000000000
781,2018,1000000000
997,2011,1000000000
249,2019,3000000000
434,2014,2000000000
1035,2020,1000000000
969,2014,1000000000
1018,2011,1000000000
355,2017,2000000000
934,2011,1000000000
1054,2016,1000000000
901,2020,1000000000
173,2018,4000000000
738,2018,1000000000
422,2019,2000000000
830,2017,1000000000
1004,2016,1000000000
951,2011,1000000000
734,2012,1000000000
1063,2018,1000000000
623,2013,1000000000
846,2015,1000000000
1030,2019,1000000000
824,2012,1000000000
930,2017,1000000000
456,2016,2000000000
893,2020,1000000000
812,2019,1000000000
1001,2020,1000000000
703,2018,1000000000
884,2020,1000000000
952,2021,1000000000
625,2012,1000000000
971,2015,1000000000
796,2012,1000000000
909,2015,1000000000
587,2014,2000000000
273,2013,3000000000
771,2017,1000000000
1005,2015,1000000000
758,2016,1000000000
652,2015,1000000000
8,2015,38000000000
760,2016,1000000000
394,2016,2000000000
393,2013,2000000000
870,2016,1000000000
804,2019,1000000000
1041,2015,1000000000
443,2017,2000000000
978,2015,1000000000
612,2016,1000000000
714,2021,1000000000
925,2012,1000000000
449,2019,2000000000
1022,2013,1000000000
1022,2013,1000000000
644,2016,1000000000
718,2015,1000000000
1048,2014,1000000000
1024,2011,1000000000
929,2019,1000000000
751,2015,1000000000
1012,2015,1000000000
863,2019,1000000000
662,2015,1000000000
1027,2012,1000000000
783,2016,1000000000
592,2018,2000000000
1023,2018,1000000000
633,2011,1000000000
635,2011,1000000000
750,2014,1000000000
697,2018,1000000000
886,2016,1000000000
826,2012,1000000000
1000,2016,1000000000
740,2016,1000000000
798,2017,1000000000
1008,2020,1000000000
761,2012,1000000000
825,2014,1000000000
695,2013,1000000000
876,2011,1000000000
643,2016,1000000000
509,2014,2000000000
979,2013,1000000000
1031,2017,1000000000
817,2014,1000000000
943,2014,1000000000
975,2015,1000000000
426,2015,2000000000
705,2018,1000000000
464,2019,2000000000
942,2018,1000000000
354,2011,3000000000
688,2015,1000000000
1045,2015,1000000000
391,2020,2000000000
891,2014,1000000000
579,2018,2000000000
686,2014,1000000000
822,2021,1000000000
882,2013,1000000000
369,2015,2000000000
340,2017,3000000000
1058,2012,1000000000
862,2016,1000000000
363,2014,2000000000
603,2013,1000000000
645,2015,1000000000
769,2016,1000000000
788,2017,1000000000
452,2013,2000000000
420,2012,2000000000
996,2015,1000000000
763,2016,1000000000
765,2012,1000000000
989,2016,1000000000
409,2013,2000000000
580,2011,2000000000
513,2018,2000000000
809,2019,1000000000
791,2015,1000000000
998,2011,1000000000
455,2014,2000000000
477,2016,2000000000
896,2012,1000000000
797,2017,1000000000
250,2015,3000000000
229,2011,4000000000
540,2015,2000000000
73,2012,8000000000
852,2015,1000000000
78,2019,8000000000
314,2021,3000000000
82,2018,8000000000
164,2017,5000000000
85,2014,7000000000
212,2016,4000000000
65,2015,9000000000
258,2016,3000000000
63,2016,9000000000
31,2017,12000000000
248,2015,3000000000
32,2013,12000000000
252,2011,3000000000
33,2017,12000000000
287,2015,3000000000
243,2015,3000000000
40,2013,11000000000
44,2014,11000000000
45,2011,11000000000
50,2012,10000000000
53,2015,10000000000
285,2014,3000000000
134,2015,5000000000
317,2020,3000000000
365,2015,2000000000
91,2012,7000000000
185,2014,4000000000
335,2013,3000000000
1014,2019,1000000000
191,2017,4000000000
334,2011,3000000000
115,2012,6000000000
113,2014,6000000000
136,2013,5000000000
130,2015,5000000000
321,2016,3000000000
327,2017,3000000000
641,2011,1000000000
352,2012,3000000000
972,2016,1000000000
972,2016,1000000000
201,2015,4000000000
168,2019,4000000000
171,2012,4000000000
350,2012,3000000000
101,2017,7000000000
239,2011,4000000000
1065,2015,1000000000
1065,2015,1000000000
938,2015,1000000000
828,2017,1000000000
988,2013,1000000000
484,2018,2000000000
864,2021,1000000000
1060,2017,1000000000
742,2014,1000000000
964,2014,1000000000
712,2017,1000000000
837,2016,1000000000
583,2014,2000000000
411,2018,2000000000
430,2016,2000000000
875,2018,1000000000
810,2019,1000000000
805,2015,1000000000
953,2019,1000000000
679,2015,1000000000
907,2016,1000000000
880,2018,1000000000
834,2016,1000000000
542,2016,2000000000
637,2017,1000000000
611,2016,1000000000
1064,2014,1000000000
737,2020,1000000000
172,2012,4000000000
414,2020,2000000000
845,2014,1000000000
416,201
Query:
SELECT MIN(TRY_TO_TIMESTAMP(d."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3')) AS "earliest_join_date"
FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
  ON d."company_id" = f."company_id"
WHERE f."valuation" >= 1000000000
  AND TRY_TO_TIMESTAMP(d."date_joined", 'YYYY-MM-DD"T"HH24:MI:SS.FF3') IS NOT NULL;
Answer:
earliest_join_date
2007-07-02
Query:
SELECT MIN(TRY_TO_DATE(SUBSTRING(d."date_joined", 1, 10), 'YYYY-MM-DD')) AS "earliest_join_date"
FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
  ON d."company_id" = f."company_id"
WHERE f."valuation" >= 1000000000
  AND TRY_TO_DATE(SUBSTRING(d."date_joined", 1, 10), 'YYYY-MM-DD') IS NOT NULL;
Answer:
earliest_join_date
2007-07-02
Query:
SELECT d."year_founded", COUNT(*) AS "unicorns"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
    ON d."company_id" = f."company_id"
    WHERE f."valuation" >= 1000000000
    GROUP BY d."year_founded"
    ORDER BY d."year_founded"
    LIMIT 1000;
Answer:
year_founded,unicorns
1919,1
1979,1
1984,1
1990,1
1991,1
1992,1
1993,1
1994,2
1995,2
1996,1
1997,1
1998,5
1999,8
2000,11
2001,9
2002,4
2003,8
2004,9
2005,14
2006,16
2007,24
2008,27
2009,37
2010,40
2011,83
2012,95
2013,91
2014,110
2015,159
2016,115
2017,75
2018,61
2019,46
2020,25
2021,11
Query:
SELECT i."industry", SUM(f."funding") AS "total_funding"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
    ON i."company_id" = f."company_id"
    GROUP BY i."industry"
    ORDER BY "total_funding" DESC
    LIMIT 1000;
Answer:
industry,total_funding
Fintech,111977000000
E-commerce & direct-to-consumer,75162000000
Internet software & services,74061000000
Artificial intelligence,46802000000
"""Supply chain, logistics, & delivery""",44393000000
Other,40285000000
Auto & transportation,37885000000
Health,34132000000
Consumer & retail,26284000000
Cybersecurity,21932000000
Edtech,21875000000
Hardware,21385000000
Data management & analytics,17981000000
Mobile & telecommunications,15214000000
Travel,12626000000
End Exploring Related Columns
Task: Can you help me calculate the average number of new unicorn companies per year in the top industry from 2019 to 2021?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: SELECT S."Column_Name" FROM {Database Name}.{Schema Name}.{Table_name} (ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
average_number_of_new_unicorn_companies_per_year
value:int > 0
(Attention: answer in one row)
```

To calculate the average number of new unicorn companies per year in the top industry from 2019 to 2021, we identified the industry with the highest total number of companies that became unicorns during this period using the `COMPANIES_DATES` and `COMPANIES_INDUSTRIES` tables. We then counted the number of new unicorn companies in that industry for each year, summed them up, and divided by three to get the average per year..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'MODERN_DATA': {'MODERN_DATA': ['COMPANIES_DATES', 'COMPANIES_FUNDING', 'COMPANIES_INDUSTRIES', 'INCOME_TREES', 'PIZZA_CLEAN_CUSTOMER_ORDERS', 'PIZZA_CLEAN_RUNNER_ORDERS', 'PIZZA_CUSTOMER_ORDERS', 'PIZZA_GET_EXCLUSIONS', 'PIZZA_GET_EXTRAS', 'PIZZA_NAMES', 'PIZZA_RECIPES', 'PIZZA_RUNNERS', 'PIZZA_RUNNER_ORDERS', 'PIZZA_TOPPINGS', 'STATISTICS', 'TREES', 'WORD_LIST']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
Keep all decimals to four decimal places.
You need to follow the format's positive and negative signs.

2025-01-18 16:59:28 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 16:59:28 - root - INFO - ```sql
WITH TopIndustry AS (
    SELECT i."industry"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
        ON i."company_id" = d."company_id"
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
        ON i."company_id" = f."company_id"
    WHERE f."valuation" >= 1000000000
        AND TRY_TO_DATE(SUBSTRING(d."date_joined", 1, 10), 'YYYY-MM-DD') BETWEEN '2019-01-01' AND '2021-12-31'
    GROUP BY i."industry"
    ORDER BY COUNT(*) DESC NULLS LAST
    LIMIT 1
)
SELECT ROUND(AVG("unicorns"), 4) AS "average_number_of_new_unicorn_companies_per_year"
FROM (
    SELECT EXTRACT(YEAR FROM TRY_TO_DATE(SUBSTRING(d."date_joined", 1, 10), 'YYYY-MM-DD')) AS "year",
           COUNT(*) AS "unicorns"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
        ON d."company_id" = i."company_id"
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
        ON d."company_id" = f."company_id"
    JOIN TopIndustry t
        ON i."industry" = t."industry"
    WHERE f."valuation" >= 1000000000
        AND TRY_TO_DATE(SUBSTRING(d."date_joined", 1, 10), 'YYYY-MM-DD') BETWEEN '2019-01-01' AND '2021-12-31'
    GROUP BY EXTRACT(YEAR FROM TRY_TO_DATE(SUBSTRING(d."date_joined", 1, 10), 'YYYY-MM-DD'))
) sub;
```
2025-01-18 16:59:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:59:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:59:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:59:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-18 16:59:30 - snowflake.connector.connection - INFO - closed
2025-01-18 16:59:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:59:30 - root - INFO - itercount: 1
2025-01-18 16:59:30 - root - INFO - 0
2025-01-18 16:59:30 - root - INFO - results: 
average_number_of_new_unicorn_companies_per_year
60.3333


2025-01-18 16:59:30 - root - INFO - Please check the answer again by reviewing Can you help me calculate the average number of new unicorn companies per year in the top industry from 2019 to 2021?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
average_number_of_new_unicorn_companies_per_year
value:int > 0
(Attention: answer in one row)
```

To calculate the average number of new unicorn companies per year in the top industry from 2019 to 2021, we identified the industry with the highest total number of companies that became unicorns during this period using the `COMPANIES_DATES` and `COMPANIES_INDUSTRIES` tables. We then counted the number of new unicorn companies in that industry for each year, summed them up, and divided by three to get the average per year. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
average_number_of_new_unicorn_companies_per_year
60.3333
Current sql:
WITH TopIndustry AS (
    SELECT i."industry"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
        ON i."company_id" = d."company_id"
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
        ON i."company_id" = f."company_id"
    WHERE f."valuation" >= 1000000000
        AND TRY_TO_DATE(SUBSTRING(d."date_joined", 1, 10), 'YYYY-MM-DD') BETWEEN '2019-01-01' AND '2021-12-31'
    GROUP BY i."industry"
    ORDER BY COUNT(*) DESC NULLS LAST
    LIMIT 1
)
SELECT ROUND(AVG("unicorns"), 4) AS "average_number_of_new_unicorn_companies_per_year"
FROM (
    SELECT EXTRACT(YEAR FROM TRY_TO_DATE(SUBSTRING(d."date_joined", 1, 10), 'YYYY-MM-DD')) AS "year",
           COUNT(*) AS "unicorns"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
        ON d."company_id" = i."company_id"
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
        ON d."company_id" = f."company_id"
    JOIN TopIndustry t
        ON i."industry" = t."industry"
    WHERE f."valuation" >= 1000000000
        AND TRY_TO_DATE(SUBSTRING(d."date_joined", 1, 10), 'YYYY-MM-DD') BETWEEN '2019-01-01' AND '2021-12-31'
    GROUP BY EXTRACT(YEAR FROM TRY_TO_DATE(SUBSTRING(d."date_joined", 1, 10), 'YYYY-MM-DD'))
) sub;When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-18 16:59:51 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 16:59:51 - root - INFO - ```sql
WITH TopIndustry AS (
    SELECT i."industry"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
        ON i."company_id" = d."company_id"
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
        ON i."company_id" = f."company_id"
    WHERE f."valuation" >= 1000000000
        AND TRY_TO_DATE(SUBSTRING(d."date_joined", 1, 10), 'YYYY-MM-DD') BETWEEN '2019-01-01' AND '2021-12-31'
    GROUP BY i."industry"
    ORDER BY COUNT(*) DESC NULLS LAST
    LIMIT 1
)
SELECT ROUND(AVG("unicorns"), 4) AS "average_number_of_new_unicorn_companies_per_year"
FROM (
    SELECT EXTRACT(YEAR FROM TRY_TO_DATE(SUBSTRING(d."date_joined", 1, 10), 'YYYY-MM-DD')) AS "year",
           COUNT(*) AS "unicorns"
    FROM "MODERN_DATA"."MODERN_DATA"."COMPANIES_DATES" d
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_INDUSTRIES" i
        ON d."company_id" = i."company_id"
    JOIN "MODERN_DATA"."MODERN_DATA"."COMPANIES_FUNDING" f
        ON d."company_id" = f."company_id"
    JOIN TopIndustry t
        ON i."industry" = t."industry"
    WHERE f."valuation" >= 1000000000
        AND TRY_TO_DATE(SUBSTRING(d."date_joined", 1, 10), 'YYYY-MM-DD') BETWEEN '2019-01-01' AND '2021-12-31'
    GROUP BY EXTRACT(YEAR FROM TRY_TO_DATE(SUBSTRING(d."date_joined", 1, 10), 'YYYY-MM-DD'))
) sub;
```
2025-01-18 16:59:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:59:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:59:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:59:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-18 16:59:52 - snowflake.connector.connection - INFO - closed
2025-01-18 16:59:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:59:53 - root - INFO - itercount: 2
2025-01-18 16:59:53 - root - INFO - 0
2025-01-18 16:59:53 - root - INFO - Total iteration counts: 2
