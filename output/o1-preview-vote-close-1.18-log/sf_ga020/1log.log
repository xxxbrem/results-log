2025-01-18 16:05:44 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 16:06:36 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 16:06:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:06:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:06:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:06:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 33
2025-01-18 16:06:38 - snowflake.connector.connection - INFO - closed
2025-01-18 16:06:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:06:39 - root - INFO - SQL:
-- 1. Get distinct event names to identify event types
SELECT DISTINCT "event_name"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000;
Results:
event_name
session_start
level_complete_quickplay
screen_view
post_score
level_start_quickplay
level_end_quickplay
level_fail_quickplay
user_engagement
os_update
app_update
level_complete
level_up
level_end
level_fail
app_exception
select_content
error
level_start
level_retry_quickplay
use_extra_steps
level_reset
level_reset_quickplay
no_more_extra_steps
level_retry
app_remove
firebase_campaign
in_app_purchase
spend_virtual_currency
completed_5_levels
dynamic_link_app_open
ad_reward
challenge_a_friend
first_open

2025-01-18 16:06:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:06:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:06:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:06:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-18 16:06:40 - snowflake.connector.connection - INFO - closed
2025-01-18 16:06:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:06:41 - root - INFO - SQL:
-- 2. Retrieve distinct event dates to understand date formats and ranges
SELECT DISTINCT "event_date"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000;
Results:
event_date
20180801

2025-01-18 16:06:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:06:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:06:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:06:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 447
2025-01-18 16:06:42 - snowflake.connector.connection - INFO - closed
2025-01-18 16:06:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:06:43 - root - INFO - SQL:
-- 3. Get unique user IDs to assess the number of users
SELECT DISTINCT "user_pseudo_id"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000;
Results:
Too long, hard cut:
user_pseudo_id
B458770ED6E295374FEEB3A68902CC28
841A68D5D1F94857BEB64225193B2432
27293EA0B2F41A672E15EF7B1FA21298
EE99F8CB32999A0FDAABBA18B05D4E48
2B5ABA17A30D32531C09DAF2865F9E55
159002C6F393752AD79B3C2E8C7104C7
A8D7DCCA39D8703F2928AD2D7BBB6BE9
F4634EFF4D9470DCA00051E3304B81AF
EBC3581ADA874D494FBE2C7CCF53BF99
D41AA91B61872612B5F5F4E42870042C
45BDDEC4DF8773F88DC51D1AFD145521
CEBD783B8F2E96E9F3B9424D4FB130E7
D9AA0EC27AF47514DDB5C664A6EF758A
55BFC405FFA33C0781DE73101011E45B
CFA0F8C5E25A71062E573EF8E6BC9F76
EFB696A82D093B3AFBE92FF526DD5CEA
04EF01C1F4723249F90F920DF018F16C
DA48D36D07835B1918BDF831AF83B5EF
5E624075FDFE3003C34E1138546B2450
210C3692734E251EEF4E952BC57DD998
B1D1ED35873581A23E48C4CD03DDFF81
C80CEE0983AB5B21D3F4B46089FDD9EB
AA35092B507100A45CBF225A23D56864
91814809BD9374D5CEDFC6A31727CC55
CC81C3C01DE545318860C5BFDC6AD31E
91F5161F80D1083CA7B37A08DEC9EC78
B54ED4ED7A122CAD69ED8771E62F4D72
46D808E730894AB0AC6E0F493B6FC864
1F0D27B8A7E058446D4A6409E2E73B19
934A101CA7B97944D05E0FC2ED3E203D
372D9BB5088C4E9000C65B06459B403A
6B7F85DBAABE78A99689D49CAE22072E
56FA726AC14329729C5A9B020B508034
7ED8C235689771F6B0F29BBF295A346F
1D435E381B7264B0A2DDDC9D911F9AE8
CD327D0141209436D7C03D644B969700
81E2E892D1C23CE76B072FA71310829F
6683CAFB77FB7B60C78CD233EB2B62F7
A7AAA5EF977926DBCF801D15F83EE4A5
96161BF2E55C7E32ED5F411432875ECB
FDA4BBBCF1EA2D95CDD77BFC5F00A837
F4EA0F2888792BD62555AD46ED534839
0F93A84CB0774C5BAB3E5FF8A72A694D
E66C3B8A38C424C7CBE0B5388EE5F77E
E643F6549E6C7EA0FD01EF4BF7A40F76
0EAC48BCE6DA434412A01656309CB1FF
32DC4BE3AF515BD8BD59B4DC0052A3AB
33E5EA9FE1E29AC3127D975A5494213D
7CA838857E3B7B8C9FC6A34E975FBF22
137944D29FEB9F2C96187C5F6604F5DB
EEBCB25D5F056CCF59DDE654388ACD2B
C74B58C4CD2770A1E97D6DC13D42CCAC
81F5705397CE9F0236B2B672AE113154
C464722AE0E9423DE721E72B8A524141
B99FD965B0874192EE94E8A8FE85EA9E
59772415A60A0B7E16588D219D7B85F1
A1FB1AAB886471FD9FFEADD8221847E8
914089851FFF3E8C0B3F64C73C8C6444
A064A84CD3CF7058F39333D6212E8615
9C2DD86B2DCB9FFB2356BC97F1ACE65F
17934EF7C1BC1CF2C7D942401FDE84CE
E19F04BAB15FBA761833F71BCF5D97D3
01562149DD13E75D732F0A9CA2D8CF5C
0E05F56141200FF41FCC0C7FA297FF08
3FC8ECFC8F2976C5B56D0D782F36BD7F
EF7772819E807EDBD8DB0F0B5210030E
AEB21692315E4F72D255C75E3584C12E
AFA6BA99FB329CB459E8E57FDE1DF9AE
FCB218A1B5C858D56B849CA70EDCF6B4
377303AA2F5C5C80E5AAAD26C029BD5A
EC1A759709685E136767F2C1BA4751ED
68C5F7CFAEAB93924B7B55D7129C0286
C60EACB47CF25AEEFD16C5E332078852
27B1CD26769B068D16FAAF82D4F2C1A8
38328F5729077611D47495753D2C04D1
70646770530D6BDEB05AFC16DD2559C2
CA51DAF1373B5C2A16C174AFBD2132A4
628E501EA1130A3A1C63DC1A3DF9D43A
13E6C8A193FF140F7D4222B569DD5B50
84E491A60BE52A4C6A438A89FADE283C
3E5101BCD089218A0E026C6750673B33
A72750663D0181C7817F61B3DD2CA656
FCA08F9B0DCB6E33A74F672CE7F73BE3
64EA802089E68A699EC86438C9504F94
8065F8E98407106A65D35195984B2258
C74E5AF2DAC240FA7F3B1612D5AEAA78
27C6D0E213A8121BF39FEA92C19D9144
B621164BDFE39D8021DDA4F652A284A5
2F4A6CF5C60E72BC578CA0E5189505F7
EF500E0CF578004836D1D38C8901862B
428B364B8F2B42ED8D7C5AD1020705EF
396CD60DADAB9CBA7DDCAF239B477135
EF028BE6C2230A5166A1A247D4687BA3
76690E22DDCE2B1FFA98C6A4376B8EA2
328DC7FE55E8881B2EA668C9A2855BB7
2B90CE94C6039DF03E72FE15B5320ABA
674EAE8D70D203FEDBE60DEAE2F834CC
01C784BDB7AF4DC8DAD6DCD21AF56E25
5A7EB17BF7D867AADECA2FDAF0941E88
0C777BD44F304574371C97674DCD0702
C2B541CA130165D03BA9BA7DC0E79273
E9DCE2D958652BD58E846DCE86BDD90A
E594F4CE9B23146A461021258CC7ACA2
12E5626928FE0885DEEF068683E8BD63
D47DCBB00B2B462C916A5A07DCFAB039
682A8CD0767A569DC68E7AA0201BFBA3
C4411A9EA6C9822AD521C60A4ED25F25
4593E981ECEF849FC7DA0F7FDA0F250E
E53BC2A0AD86417B443AF14EE3082C0F
53717D02C147929860D981CD68CE2D9A
8F6C5F7611B67A4A437FF283B6C10181
A1927ED722EA16A3B82E7EE0FA22FF4F
8941AB73D7CE7EF67AE0D6B866A8B5D0
6C654E9F5D2B57F4F2E2D9F240EC882C
9F61F3B36299C77519005F1B90A90108
03A75C48AFA4420AF4B3C23D7EDAC213
76B29DA61902BE1C9F957B66B017DA47
706C748E6D1E0768BFEFE6362B5D3F67
48C39ABD5CE13587DC55ADCAA366F951
ED244919E490C36963714E4C3E3025AB
85B9BAA3105AD395E7D84C61108F0D7E
6A2F4E7AB1816D2F6EC741BC92141766
1FDB055D4BD4AEC379A7B2F34E862913
D4A45A0CA838C439F64D565450B9A7D6
5FFBFE051291F79717B99F5D72B02CDC
7BCFAF1D468E309D866E9FEA7795FF85
AC14799A5E8C340D6CADCBAE72037D81
38AE6258A71E0D270D87AF7EFB0D419C
B215751EAC030DECC9124D90D2AC41A9
184B6DE721CD75D84BB9975E19003195
85C63B84706E6DD9752813675F9FB5F8
1A5905FC810CA20956805F3BACBEBCEF
C8859A791226C6027B90F72F880C3528
28C4A09298C441D5AFD39E749D9F3DA3
D11624EBD7C1693F9C3B4803A8D71DBA
A62D86FAFF43F1EC89D6F867915D7D56
D4B90F489AEED383CB46669EEEB12E92
42421044D6B3F0190A37145A20403036
8211CABE9A3F1FE1BF3154E0C8D30368
476409D7DFD0B2B2B0AB11E5F6D7DDBE
887A958AF69B7172916C3748444BFF0B
EBE661044C1949546986A852F35083A1
7D05DF6F0141D016FD20F7B8E71FAB0A
82486A3B62D50DB914F1C6857733DAB2
8601A3659DC5C1F0444E5CCDA5ED3E14
A944897CEB774B1BC2AFEA13A907B39E
1DC9B625F2C4F54E9281D4D19F9FEBBB
C7E2273D8B11257FCCC915D27C1FCA24
82D556A8003F97B39A2D2E8E5520F9B6
053914EB0DA99A613D6AF0E92FCA9940
39BE7CAB9B8602ABD10A1BFB4E66BBB2
EF

2025-01-18 16:06:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:06:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:06:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:06:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-18 16:06:44 - snowflake.connector.connection - INFO - closed
2025-01-18 16:06:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:08:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 16:08:10 - root - INFO - ```sql
WITH events AS (
    -- Union of event tables from August 1 to August 29, 2018
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180802"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180803"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180804"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180805"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180806"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180807"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180808"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180809"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180810"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180811"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180812"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180813"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180814"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180815"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180816"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180817"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180818"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180819"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180820"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180821"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180822"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180823"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180824"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180825"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180826"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180827"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180828"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180829"
),
-- Identify users who first engaged between August 1 and August 15, 2018
initial_engagement AS (
    SELECT
        "user_pseudo_id",
        MIN("event_timestamp") AS initial_timestamp
    FROM events
    WHERE "event_date" BETWEEN '20180801' AND '20180815'
    GROUP BY "user_pseudo_id"
),
-- Filter for quickplay event types during initial engagement
quickplay_initial AS (
    SELECT
        ie."user_pseudo_id",
        e."event_name",
        ie.initial_timestamp
    FROM initial_engagement ie
    JOIN events e ON ie."user_pseudo_id" = e."user_pseudo_id"
        AND ie.initial_timestamp = e."event_timestamp"
    WHERE e."event_name" IN (
        'level_complete_quickplay',
        'level_start_quickplay',
        'level_end_quickplay',
        'level_fail_quickplay',
        'level_reset_quickplay',
        'level_retry_quickplay'
    )
),
-- Check for user activity during the second week after initial engagement
second_week_activity AS (
    SELECT
        qi."event_name" AS quickplay_event_type,
        qi."user_pseudo_id"
    FROM quickplay_initial qi
    JOIN events e ON qi."user_pseudo_id" = e."user_pseudo_id"
    WHERE e."event_timestamp" BETWEEN qi.initial_timestamp + (7 * 86400000)
                                  AND qi.initial_timestamp + (14 * 86400000)
),
-- Calculate retention rates
retention_rates AS (
    SELECT
        qi."event_name" AS quickplay_event_type,
        COUNT(DISTINCT qi."user_pseudo_id") AS initial_users,
        COUNT(DISTINCT swa."user_pseudo_id") AS returning_users,
        (COUNT(DISTINCT swa."user_pseudo_id")::FLOAT / COUNT(DISTINCT qi."user_pseudo_id")) * 100 AS second_week_retention_rate
    FROM quickplay_initial qi
    LEFT JOIN second_week_activity swa ON qi."user_pseudo_id" = swa."user_pseudo_id"
        AND qi."event_name" = swa."quickplay_event_type"
    GROUP BY qi."event_name"
)
-- Select the quickplay event type with the lowest retention rate
SELECT
    quickplay_event_type,
    second_week_retention_rate
FROM retention_rates
ORDER BY second_week_retention_rate ASC
LIMIT 1;
```
2025-01-18 16:08:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:08:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:08:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:08:12 - snowflake.connector.connection - INFO - closed
2025-01-18 16:08:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:08:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 16:08:56 - root - INFO - It seems you're encountering an error while executing the query to explore keys in `event_params`. The error message indicates:

```
SQL compilation error:
invalid number of result columns for set operator input branches, expected 19, got 20 in branch 28
```

This error usually arises when there's a mismatch in the number of columns during a `UNION` operation. However, since your query doesn't involve a `UNION`, the issue might be stemming from previous queries in your session or how `event_params` is being accessed.

Let's focus on correcting the query to retrieve the keys from `event_params`. The `event_params` column is of `VARIANT` type and contains an array of key-value pairs. Here's how you can adjust your query:

```sql
SELECT DISTINCT f.value:name::STRING AS key_name
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 1000;
```

**Explanation:**

- `f.value:name::STRING`: Extracts the `"name"` field from each key-value pair in `event_params` and casts it to `STRING`.
- `key_name`: Alias for the extracted key names.

If you want to explore both the keys and values within `event_params`, you can modify the query:

```sql
SELECT DISTINCT
    f.value:name::STRING AS key_name,
    f.value:string_value::STRING AS string_value,
    f.value:int_value::NUMBER AS int_value,
    f.value:float_value::FLOAT AS float_value,
    f.value:double_value::FLOAT AS double_value
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 1000;
```

**Additional Steps:**

1. **Inspect the Structure of `event_params`:**

   Before querying, it's helpful to understand the structure of `event_params`. Run the following query to see some sample data:

   ```sql
   SELECT t."event_params"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t
   LIMIT 10;
   ```

2. **Check for Null or Empty Values:**

   Ensure that `event_params` is not null or empty to avoid errors during flattening:

   ```sql
   SELECT DISTINCT f.value:name::STRING AS key_name
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
   LATERAL FLATTEN(input => t."event_params") f
   WHERE t."event_params" IS NOT NULL
   LIMIT 1000;
   ```

3. **Confirm Data Types:**

   Verify the data types within `event_params` to correctly cast them in your query.

**Note on the Error Message:**

The error you received mentions a mismatch in columns during a `UNION` operation:

```
invalid number of result columns for set operator input branches, expected 19, got 20 in branch 28
```

This suggests that in previous queries or steps, there might have been a `UNION` of multiple `SELECT` statements where the columns didn't match. Ensure that:

- All `SELECT` statements in a `UNION` have the same number of columns.
- The columns are in the same order and have compatible data types.

**Example of Correct Union Usage:**

```sql
-- Correct usage with matching columns
SELECT column1, column2 FROM table1
UNION ALL
SELECT column1, column2 FROM table2;
```

If you have combined multiple event tables (e.g., from different dates) using `UNION ALL`, ensure consistency:

```sql
-- Combining event tables with matching columns
SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
UNION ALL
SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180802";
```

**Summary:**

- Adjust your query to correctly extract keys from `event_params`.
- Inspect `event_params` to understand its structure.
- Ensure all `UNION` operations have matching columns.

**Corrected Query:**

```sql
SELECT DISTINCT f.value:name::STRING AS key_name
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 1000;
```

This should help you retrieve the keys within `event_params` without encountering the previous error. If you continue to experience issues, please provide more details, and I'll be glad to assist further.
2025-01-18 16:08:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:08:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:08:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:08:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-18 16:08:57 - snowflake.connector.connection - INFO - closed
2025-01-18 16:08:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:08:58 - root - INFO - SQL:
SELECT DISTINCT
    f.value:name::STRING AS key_name,
    f.value:string_value::STRING AS string_value,
    f.value:int_value::NUMBER AS int_value,
    f.value:float_value::FLOAT AS float_value,
    f.value:double_value::FLOAT AS double_value
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 1000;
Results:
KEY_NAME,STRING_VALUE,INT_VALUE,FLOAT_VALUE,DOUBLE_VALUE
,,,,

2025-01-18 16:08:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:08:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:08:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:08:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 16:08:59 - snowflake.connector.connection - INFO - closed
2025-01-18 16:08:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:10:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 16:10:13 - root - INFO - ```sql
WITH events AS (
    -- Combine event tables from August 1 to August 31, 2018
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180802"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180803"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180804"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180805"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180806"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180807"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180808"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180809"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180810"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180811"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180812"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180813"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180814"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180815"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180816"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180817"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180818"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180819"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180820"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180821"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180822"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180823"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180824"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180825"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180826"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180827"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180828"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180829"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180830"
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180831"
),
initial_engagement AS (
    -- Identify users who first engaged between August 1 and August 15, 2018
    SELECT
        "user_pseudo_id",
        MIN("event_timestamp") AS initial_timestamp
    FROM events
    WHERE "event_date" BETWEEN '20180801' AND '20180815'
    GROUP BY "user_pseudo_id"
),
quickplay_initial AS (
    -- Users who had quickplay events during the initial period
    SELECT DISTINCT
        e."user_pseudo_id",
        e."event_name",
        ie.initial_timestamp
    FROM initial_engagement ie
    INNER JOIN events e ON ie."user_pseudo_id" = e."user_pseudo_id"
    WHERE e."event_name" IN (
        'level_start_quickplay',
        'level_end_quickplay',
        'level_fail_quickplay',
        'level_complete_quickplay',
        'level_reset_quickplay',
        'level_retry_quickplay'
    )
    AND e."event_timestamp" BETWEEN ie.initial_timestamp AND ie.initial_timestamp + (7 * 86400000)
),
second_week_activity AS (
    -- Users who returned in the second week after initial engagement
    SELECT DISTINCT
        qi."user_pseudo_id",
        qi."event_name"
    FROM quickplay_initial qi
    INNER JOIN events e ON qi."user_pseudo_id" = e."user_pseudo_id"
    WHERE e."event_timestamp" BETWEEN qi.initial_timestamp + (7 * 86400000) AND qi.initial_timestamp + (14 * 86400000)
),
retention AS (
    -- Calculate retention rates for each quickplay event type
    SELECT
        qi."event_name" AS quickplay_event_type,
        COUNT(DISTINCT qi."user_pseudo_id") AS initial_users,
        COUNT(DISTINCT swa."user_pseudo_id") AS retained_users,
        (COUNT(DISTINCT swa."user_pseudo_id")::FLOAT / COUNT(DISTINCT qi."user_pseudo_id")) * 100 AS retention_rate
    FROM quickplay_initial qi
    LEFT JOIN second_week_activity swa ON qi."user_pseudo_id" = swa."user_pseudo_id" AND qi."event_name" = swa."event_name"
    GROUP BY qi."event_name"
)
-- Select the quickplay event type with the lowest second-week retention rate
SELECT
    quickplay_event_type,
    retention_rate
FROM retention
ORDER BY retention_rate ASC
LIMIT 1;
```
2025-01-18 16:10:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:10:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:10:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:10:15 - snowflake.connector.connection - INFO - closed
2025-01-18 16:10:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:10:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 16:10:40 - root - INFO - ```sql
SELECT 
    f.value:"key"::STRING AS key_name,
    f.value:"value":"string_value"::STRING AS string_value,
    f.value:"value":"int_value"::NUMBER AS int_value,
    f.value:"value":"float_value"::FLOAT AS float_value,
    f.value:"value":"double_value"::FLOAT AS double_value
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
WHERE f.value:"key"::STRING = 'quickplay_type'
LIMIT 1000;
```
2025-01-18 16:10:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:10:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:10:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:10:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 16:10:42 - snowflake.connector.connection - INFO - closed
2025-01-18 16:10:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:11:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 16:11:08 - root - INFO - ```sql
SELECT 
    f.value:"name"::STRING AS param_name,
    f.value:"value":"string_value"::STRING AS string_value
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 1000;
```
2025-01-18 16:11:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:11:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:11:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:11:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 16:11:10 - snowflake.connector.connection - INFO - closed
2025-01-18 16:11:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:11:10 - root - INFO - SQL:
SELECT 
    f.value:"name"::STRING AS param_name,
    f.value:"value":"string_value"::STRING AS string_value
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 1000;
Results:
Too long, hard cut:
PARAM_NAME,STRING_VALUE
,FIRootViewController
,auto
,
,
,FIRootViewController
,auto
,
,
,
,FIRootViewController
,app+gtm
,
,S
,
,FIRootViewController
,app+gtm
,
,S
,
,auto
,
,GADOInterstitialViewController
,FIRootViewController/Interstitial
,GADOInterstitialViewController
,
,auto
,
,FIRootViewController/Interstitial
,GADOInterstitialViewController
,FIRootViewController
,
,FIMainMenuViewController
,auto
,
,FIRootViewController
,
,main_menu
,auto
,
,FIMainMenuViewController
,
,FIRootViewController
,auto
,
,main_menu
,
,FIOutOfStepsViewController
,auto
,
,FIRootViewController
,
,iap
,auto
,
,FIOutOfStepsViewController
,
,out_of_steps
,auto
,
,iap
,
,extra_steps
,auto
,
,out_of_steps
,
,FIRootViewController
,auto
,
,extra_steps
,
,FIGameOverViewController
,auto
,
,FIRootViewController
,
,game_over
,auto
,
,FIGameOverViewController
,
,FIRootViewController
,auto
,
,game_over
,
,GADOInterstitialViewController
,auto
,
,FIRootViewController
,
,FIGameOverViewController
,auto
,
,FIRootViewController
,
,game_over
,auto
,
,FIGameOverViewController
,
,FIRootViewController
,auto
,
,game_over
,
,FIGameOverViewController
,auto
,
,FIRootViewController
,
,game_over
,auto
,
,FIGameOverViewController
,app+gtm
,
,level_0
,FIRootViewController
,
,
,app+gtm
,
,level_0
,FIRootViewController
,
,
,FIRootViewController
,auto
,
,main_menu
,app+gtm
,
,S
,FIRootViewController
,app+gtm
,
,S
,FIRootViewController
,app+gtm
,
,S
,game_over
,app+gtm
,
,S
,FIRootViewController
,app+gtm
,
,S
,game_over
,app+gtm
,
,S
,FIRootViewController
,app+gtm
,
,S
,main_menu
,app+gtm
,
,mode
,Quickplay
,main_menu
,auto
,
,
,FIRootViewController
,auto
,
,
,extra_steps
,auto
,
,
,game_over
,auto
,
,
,FIRootViewController
,auto
,
,
,game_over
,auto
,
,
,game_over
,auto
,
,
,FIRootViewController
,auto
,
,
,game_over
,auto
,
,
,GADOInterstitialViewController
,auto
,
,
,FIRootViewController/Interstitial
,main_menu
,auto
,11.4
,
,FIRootViewController
,auto
,
,
,
,FIMainMenuViewController
,auto
,
,FIRootViewController
,
,main_menu
,auto
,
,FIMainMenuViewController
,
,FIRootViewController
,auto
,
,main_menu
,FIRootViewController
,auto
,
,main_menu
,app+gtm
,
,S
,main_menu
,app+gtm
,
,mode
,Quickplay
,main_menu
,auto
,
,
,FIRootViewController
,auto
,
,
,auto
,
,FIRootViewController/Interstitial
,
,GADNFullScreenAdViewController
,ad_click
,
,FIRootViewController
,app+gtm
,
,S
,
,auto
,
,GADNFullScreenAdViewController
,FIRootViewController/Interstitial
,GADNFullScreenAdViewController
,
,FIMainMenuViewController
,auto
,
,FIRootViewController
,
,main_menu
,auto
,
,FIMainMenuViewController
,
,FIRootViewController
,auto
,
,main_menu
,
,FIGameOverViewController
,auto
,
,FIRootViewController
,
,game_over
,auto
,
,FIGameOverViewController
,
,FIRootViewController
,auto
,
,game_over
,
,GADNFullScreenAdViewController
,auto
,
,FIRootViewController
,app+gtm
,
,level_0
,FIRootViewController
,
,
,FIRootViewController
,auto
,
,main_menu
,app+gtm
,
,S
,FIRootViewController
,app+gtm
,
,S
,game_over
,app+gtm
,
,S
,main_menu
,app+gtm
,
,mode
,Quickplay
,main_menu
,auto
,
,
,FIRootViewController
,auto
,
,
,game_over
,auto
,
,
,GADNFullScreenAdViewController
,auto
,
,
,FIRootViewController/Interstitial
,FIRootViewController
,auto
,
,2.6.30
,FIRootViewController
,auto
,
,
,
,app+gtm
,
,level_1
,FIRootViewController
,
,
,
,app+gtm
,
,level_2
,FIRootViewController
,
,
,
,app+gtm
,
,level_3
,FIRootViewController
,
,
,
,app+gtm
,
,level_4
,FIRootViewController
,
,
,
,app+gtm
,
,level_1
,FIRootViewController
,
,
,app+gtm
,
,level_2
,FIRootViewController
,
,
,app+gtm
,
,level_3
,FIRootViewController
,
,
,app+gtm
,
,level_4
,FIRootViewController
,
,
,auto
,
,GADNFullScreenAdViewController
,FIRootViewController/Interstitial
,GADNFullScreenAdViewController
,
,auto
,
,GADNFullScreenAdViewController
,FIRootViewController/Interstitial
,GADNFullScreenAdViewController
,
,auto
,
,FIRootViewController/Interstitial
,GADNFullScreenAdViewController
,FIRootViewController
,
,auto
,
,FIRootViewController/Interstitial
,GADNFullScreenAdViewController
,FIRootViewController
,
,FIMainMenuViewController
,auto
,
,FIRootViewController
,
,main_menu
,auto
,
,FIMainMenuViewController
,
,FIRootViewController
,auto
,
,main_menu
,
,FIOutOfStepsViewController
,auto
,
,FIRootViewController
,
,iap
,auto
,
,FIOutOfStepsViewController
,
,out_of_steps
,auto
,
,iap
,
,extra_steps
,auto
,
,out_of_steps
,
,FIRootViewController
,auto
,
,extra_steps
,
,FIGameOverViewController
,auto
,
,FIRootViewController
,
,game_over
,auto
,
,FIGameOverViewController
,
,FIRootViewController
,auto
,
,game_over
,
,FIOutOfStepsViewController
,auto
,
,FIRootViewController
,
,iap
,auto
,
,FIOutOfStepsViewController
,
,out_of_steps
,auto
,
,iap
,
,extra_steps
,auto
,
,out_of_steps
,
,FIRootViewController
,auto
,
,extra_steps
,
,FIGameOverViewController
,auto
,
,FIRootViewController
,
,game_over
,auto
,
,FIGameOverViewController
,
,FIRootViewController
,auto
,
,game_over
,
,FIMainMenuViewController
,auto
,
,FIRootViewController
,
,main_menu
,auto
,
,FIMainMe

2025-01-18 16:11:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:11:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:11:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:11:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-18 16:11:12 - snowflake.connector.connection - INFO - closed
2025-01-18 16:11:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:11:12 - root - INFO - SQL:
-- 6. Find event names related to 'quickplay' using fuzzy matching
SELECT DISTINCT "event_name"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
WHERE "event_name" ILIKE '%quickplay%'
LIMIT 1000;
Results:
event_name
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_retry_quickplay
level_reset_quickplay

2025-01-18 16:11:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:11:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:11:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:11:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 16:11:14 - snowflake.connector.connection - INFO - closed
2025-01-18 16:11:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:11:14 - root - INFO - SQL:
-- 7. Get user first touch timestamps to identify initial engagements
SELECT "user_first_touch_timestamp"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000;
Results:
Too long, hard cut:
user_first_touch_timestamp
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1510416265184000
1510416265184000
1510416265184000
1510416265184000
1510416265184000
1510416265184000
1510416265184000
1510416265184000
1510416265184000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1486608183392000
1486608183392000
1486608183392000
1486608183392000
1486608183392000
1486608183392000
1486608183392000
1486608183392000
1486608183392000
1486608183392000
1486608183392000
1486608183392000
1486608183392000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1501257623221000
1501257623221000
1501257623221000
1501257623221000
1501257623221000
1501257623221000
1501257623221000
1501257623221000
1501257623221000
1501257623221000
1501257623221000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
146542765

2025-01-18 16:11:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:11:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:11:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:11:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-18 16:11:15 - snowflake.connector.connection - INFO - closed
2025-01-18 16:11:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:11:16 - root - INFO - SQL:
-- 8. Extract platforms used by users
SELECT DISTINCT "platform"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000;
Results:
platform
IOS
ANDROID

2025-01-18 16:11:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:11:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:11:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:11:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 862
2025-01-18 16:11:18 - snowflake.connector.connection - INFO - closed
2025-01-18 16:11:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:11:18 - root - INFO - SQL:
-- 9. Retrieve user properties to understand user attributes
SELECT f.value
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."user_properties") f
LIMIT 1000;
Results:
Too long, hard cut:
VALUE
"{
  ""key"": ""firebase_exp_3"",
  ""value"": {
    ""set_timestamp_micros"": 1528374603614000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464610100753000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1486124557706000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464609977006000,
    ""string_value"": ""20""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464609963675000,
    ""set_timestamp_micros"": 1464609973675000
  }
}"
"{
  ""key"": ""firebase_exp_3"",
  ""value"": {
    ""set_timestamp_micros"": 1528374613614000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464610110753000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1486124567706000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464609987006000,
    ""string_value"": ""20""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464609963675000,
    ""set_timestamp_micros"": 1464609983675000
  }
}"
"{
  ""key"": ""firebase_exp_3"",
  ""value"": {
    ""set_timestamp_micros"": 1528374639614000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464610136753000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1486124593706000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464610013006000,
    ""string_value"": ""20""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464609963675000,
    ""set_timestamp_micros"": 1464610009675000
  }
}"
"{
  ""key"": ""firebase_exp_3"",
  ""value"": {
    ""set_timestamp_micros"": 1528374686614000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464610183753000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1486124640706000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464610060006000,
    ""string_value"": ""20""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464609963675000,
    ""set_timestamp_micros"": 1464610056675000
  }
}"
"{
  ""key"": ""firebase_exp_3"",
  ""value"": {
    ""set_timestamp_micros"": 1528374666614000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464610163753000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1486124620706000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464610040006000,
    ""string_value"": ""20""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464609963675000,
    ""set_timestamp_micros"": 1464610036675000
  }
}"
"{
  ""key"": ""firebase_exp_3"",
  ""value"": {
    ""set_timestamp_micros"": 1528374663614000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464610160753000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1486124617706000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464610037006000,
    ""string_value"": ""20""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464609963675000,
    ""set_timestamp_micros"": 1464610033675000
  }
}"
"{
  ""key"": ""firebase_exp_3"",
  ""value"": {
    ""set_timestamp_micros"": 1528374674614000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464610171753000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1486124628706000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464610048006000,
    ""string_value"": ""20""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464609963675000,
    ""set_timestamp_micros"": 1464610044675000
  }
}"
"{
  ""key"": ""firebase_exp_3"",
  ""value"": {
    ""set_timestamp_micros"": 1528374686614000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464610183753000,
    ""string_value"": ""t

2025-01-18 16:11:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:11:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:11:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:11:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 16:11:20 - snowflake.connector.connection - INFO - closed
2025-01-18 16:11:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:11:20 - root - INFO - SQL:
-- 10. Get event timestamps for analyzing event occurrence times
SELECT "event_timestamp"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000;
Results:
Too long, hard cut:
event_timestamp
1533178516177000
1533186548206000
1533178706133033
1533186675592002
1533178649867023
1533178654065028
1533178577238001
1533178589239002
1533178544470012
1533178619839003
1533178634839004
1533178592839005
1533178622840006
1533178572533010
1533178645114013
1533178637114014
1533178632893019
1533178659866022
1533178680673037
1533178700673038
1533186529737004
1533186639178006
1533186655178007
1533178694133031
1533186632592000
1533178513674000
1533178505779007
1533178604533011
1533178616533012
1533178652337015
1533178757133032
1533186595977000
1533186658592001
1533178513778006
1533178510469009
1533178587838000
1533178625531007
1533178606892016
1533178728673034
1533178759086039
1533186577737001
1533186608176003
1533186609960008
1533178609064025
1533176867427006
1533176872452000
1533176888209004
1533176912209005
1533176930248002
1533176913629003
1533176878339008
1533176917337007
1533176882247001
1533153346436000
1533153565261001
1533153427747002
1533153526463016
1533153306935005
1533153390935006
1533153403144011
1533153501316006
1533153480317007
1533153500660012
1533153552462015
1533153501747000
1533153386415003
1533153377417008
1533153501747001
1533153554895008
1533153354416007
1533153335144010
1533153440315003
1533153483659009
1533153572283002
1533146745626004
1533146807631000
1533146992865000
1533146982986000
1533147027807000
1533147036897000
1533146989865070
1533146947986003
1533146975807003
1533147097897008
1533146967161058
1533147030181018
1533146924401064
1533147007327003
1533146766012005
1533146807013006
1533146800896004
1533146868046003
1533146883046004
1533146907046005
1533146836046006
1533146862339010
1533146904894013
1533146818895014
1533146820473019
1533146958762023
1533146950762024
1533146932763025
1533146935763026
1533146927994030
1533146946539033
1533146946540034
1533146906458038
1533146893020039
1533146948020040
1533146961209045
1533146972210046
1533146908920050
1533146962485053
1533146939160057
1533146965390074
1533146935391075
1533146909204079
1533146977731081
1533146953539007
1533146997539008
1533147000264009
1533146993794012
1533147010349007
1533146961349008
1533146961100012
1533146957627014
1533147025179017
1533147075452012
1533147073453013
1533147048781017
1533147090305019
1533147127724003
1533147144724004
1533147123724005
1533147111724006
1533147136233010
1533146984865067
1533147014986000
1533147046807000
1533147057897005
1533146822471003
1533146786346001
1533146819339011
1533146862339012
1533146893947015
1533146965994031
1533146889994032
1533146910920052
1533146983865068
1533146923204080
1533146990986001
1533146986265010
1533146963807001
1533146973100013
1533147046897006
1533147021782018
1533147060234011
1533147104234012
1533146789345000
1533146901814041
1533146950917051
1533146829895003
1533146879045000
1533146914337007
1533146823472016
1533146882761020
1533146945993027
1533146903457035
1533146897207042
1533146952918047
1533146966158056
1533146989389071
1533146929203076
1533146932538004
1533146964793011
1533147035348004
1533146974099009
1533147039179016
1533147097451009
1533147023777014
1533147110723000
1533147094232007
1533147139463013
1533146954400061
1533147024327000
1533178473346000
1533178541554007
1533178506618000
1533178628867002
1533178462868005
1533178512028006
1533178516220011
1533178558512006
1533178640512007
1533178572867000
1533178475404004
1533178526568009
1533178634867001
1533178535566008
1533178639511003
1533178651162008
1533170414038000
1533170404257002
1533170400225001
1533170322225002
1533170414304012
1533170402811006
1533170447811007
1533170435329011
1533170482888012
1533170402888013
1533170486257000
1533170340691000
1533170328331007
1533170428257001
1533170344330006
1533170327304009
1533170398810003
1533170471328008
1533170476820014
1533173292504000
1533173221311010
1533173318931000
1533173377932002
1533173224964001
1533173237964002
1533173352600006
1533173332601007
1533173285313011
1533173380932001
1533173255781000
1533173309599005
1533173294729010
1533122520370000
1533122646518002
1533122793839016
1533122510176004
1533122530519006
1533122530815011
1533122627102006
1533122638102007
1533122713268013
1533122797416020
1533122778416021
1533122605518000
1533122765839014
1533122511977003
1533122457793008
1533122614518001
1533122692329008
1533122815839015
1533122536793007
1533122534815010
1533122641100003
1533122721267010
1533122768414017
1533122752900022
1533142701338000
1533142798077002
1533142707512006
1533142785657006
1533142750657007
1533142734077000
1533142657327001
1533142708077001
1533142685511003
1533142797654003
1533142775375008
1533148961854000
1533149528704051
1533149317986043
1533149329894048
1533148932154001
1533148949155002
1533149017764010
1533149142573003
1533149114575004
1533149212576005
1533149171264009
1533149134880012
1533149130881013
1533149208197019
1533149366774023
1533149311774024
1533149342774025
1533149305857029
1533149289456032
1533149360457033
1533149295322039
1533149342984042
1533149544361055
1533149483363056
1533149512703049
153

2025-01-18 16:11:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:11:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:11:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:11:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 62
2025-01-18 16:11:22 - snowflake.connector.connection - INFO - closed
2025-01-18 16:11:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:11:22 - root - INFO - SQL:
-- 11. Find distinct values of 'geo' data
SELECT DISTINCT f.value
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."geo") f
LIMIT 1000;
Results:
VALUE
"""Americas"""
"""Mexico"""
"""United States"""
"""Europe"""
"""United Kingdom"""
"""Asia"""
"""Japan"""
"""Gibraltar"""
"""Brazil"""
"""Canada"""
"""United Arab Emirates"""
"""Denmark"""
"""Oceania"""
"""Sydney"""
"""New South Wales"""
"""Australia"""
"""Colombia"""
"""Indonesia"""
"""Hong Kong"""
"""Taiwan"""
"""Russia"""
"""Thailand"""
"""Israel"""
"""Lebanon"""
"""Africa"""
"""Pakistan"""
"""Telangana"""
"""Spain"""
"""Illinois"""
""""""
"""Jordan"""
"""London"""
"""England"""
"""Morocco"""
"""Romania"""
"""Puerto Rico"""
"""China"""
"""Croatia"""
"""Germany"""
"""Belgium"""
"""Netherlands"""
"""Austria"""
"""Serbia"""
"""India"""
"""Hyderabad"""
"""South Africa"""
"""Chicago"""
"""Egypt"""
"""Vietnam"""
"""Dominican Republic"""
"""Afghanistan"""
"""Greece"""
"""Sweden"""
"""France"""
"""Kenya"""
"""South Korea"""
"""Peru"""
"""Slovenia"""
"""Turkey"""
"""Nigeria"""
"""Argentina"""
"""Italy"""

2025-01-18 16:11:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:11:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:11:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:11:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 16:11:23 - snowflake.connector.connection - INFO - closed
2025-01-18 16:11:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:11:24 - root - INFO - SQL:
-- 12. Retrieve app information from 'app_info' column
SELECT f.value
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."app_info") f
LIMIT 1000;
Results:
Too long, hard cut:
VALUE
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.27"""
"""1:300830567303:ios:09b1

2025-01-18 16:11:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:11:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:11:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:11:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 16:11:25 - snowflake.connector.connection - INFO - closed
2025-01-18 16:11:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:11:26 - root - INFO - SQL:
-- 13. Get traffic source details to understand acquisition channels
SELECT f.value
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."traffic_source") f
LIMIT 1000;
Results:
Too long, hard cut:
VALUE
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(no

2025-01-18 16:11:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:11:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:11:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:11:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 16:11:27 - snowflake.connector.connection - INFO - closed
2025-01-18 16:11:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:11:27 - root - INFO - SQL:
-- 14. Identify devices used by users
SELECT f.value
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."device") f
LIMIT 1000;
Results:
Too long, hard cut:
VALUE
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"

2025-01-18 16:11:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:11:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:11:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:11:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-18 16:11:28 - snowflake.connector.connection - INFO - closed
2025-01-18 16:11:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:11:29 - root - INFO - SQL:
-- 15. Extract stream IDs for event grouping
SELECT DISTINCT "stream_id"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000;
Results:
stream_id
1051193347
1051193346

2025-01-18 16:11:29 - root - INFO - itercount: 0
2025-01-18 16:11:29 - root - INFO - Database Name: FIREBASE
Schema Name: ANALYTICS_153293282
DDL describes table information.
,0
table_name,EVENTS_20180613
description,
DDL,"create or replace TABLE EVENTS_20180613 (
	""event_date"" VARCHAR(16777216),
	""event_timestamp"" NUMBER(38,0),
	""event_name"" VARCHAR(16777216),
	""event_params"" VARIANT,
	""event_previous_timestamp"" NUMBER(38,0),
	""user_id"" VARCHAR(16777216),
	""user_pseudo_id"" VARCHAR(16777216),
	""user_properties"" VARIANT,
	""user_first_touch_timestamp"" NUMBER(38,0),
	""user_ltv"" VARIANT,
	""device"" VARIANT,
	""geo"" VARIANT,
	""app_info"" VARIANT,
	""traffic_source"" VARIANT,
	""stream_id"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']
External knowledge that might be helpful: 
How to Calculate User Retention in Big Query from Google Demo Game Analytics Data

As a Product / Website Analyst, I was pretty psyched to discover Googles public Google Analytics 4 (GA4) gaming event dataset called `firebase-public-project.analytics_153293282.events_*`. The table allows experienced developers and learners alike to experiment with raw GA4 data in Big Query for free. Event data is basically a log of user interactions with your product for analysis .For newbies interested in learning more about event data and GA4, visit my prior blog. This article provides SQL queries for a quick table overview and explains how to utilize Google Big Query to calculate user retention.


What is Retention?
User retention rates are key indicators for whether your product team meets user needs. Improving retention is often central to long term growth strategies.

**Retention measures how often and for how long users tend to return to your product.**

The metric can be a powerful proxy for product usefulness and user opinion. Its analysis can reveal critical information like how well your site converts new visitors to users and which items and features are associated with users coming back. If user data is available, retention can also help a business understand the profiles of its most active users (power users). Finally, retention is a great guardrail metric for A/B tests. Successful, product oriented companies prioritize a healthy user bases over short term profits.


**Common Retention Calculation Strategies**

Two common strategies to calculate retention are: 

a) N-Day retention

b) Unbounded Retention.


a) For N-Day retention, analysts calculate how many users with certain characteristics return over successive periods. It is called N days because we define the length of each period. For example, with N=7 day retention, if User A becomes part of our cohort of interest on day 0 and returns to the product day 5 and day 15, they are counted as retained for week 1 (17 days) and week 3 (1521 days) but not week 2 (814 days).


b) For Unbounded Retention, a user is counted as retained each week so long as their most recent product contact was after the week. For example, if User A becomes part of the cohort on day 0 and last returned to the site on day 21, they will be counted as retained in week 1 (17 days), week 2 (814 days), and week 3 (1521 days) but not week 4 (2228 days).

By calculating these metrics, companies can evaluate how well their products hold users interests. It also them closer to identifying the patterns that generate return users.



The table structure information is ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}
Begin Exploring Related Columns
**Columns and Potential Usage:**

- `"event_date"`: Used to filter events within specific date ranges.
- `"event_timestamp"`: Helps determine the exact timing of events for retention calculations.
- `"event_name"`: Identifies the type of event; useful for isolating "quickplay" events.
- `"user_pseudo_id"`: Unique identifier for users; essential for tracking individual user activity and retention.
- `"user_first_touch_timestamp"`: Indicates the initial engagement date of the user; used to find users who first engaged between August 1 and August 15, 2018.
- `"event_params"`: Contains additional event details; may include specific "quickplay" event types.
- `"platform"`: Could be used to segment data based on user platforms (e.g., iOS, Android).
- `"geo"`: May provide location data; potentially useful for geographic segmentation.

**Conditions That May Be Used:**

- Users with `"user_first_touch_timestamp"` between August 1 and August 15, 2018.
- Events where `"event_name"` is related to "quickplay".
- Filtering `"event_params"` to extract specific quickplay event types.
- Events occurring during the second week after the user's initial engagement.
- Using `"event_date"` to filter events within specific weeks.

**Sample SQL Queries:**

```sql
-- 1. Get distinct event names to identify event types
SELECT DISTINCT "event_name"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000;
```

```sql
-- 2. Retrieve distinct event dates to understand date formats and ranges
SELECT DISTINCT "event_date"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000;
```

```sql
-- 3. Get unique user IDs to assess the number of users
SELECT DISTINCT "user_pseudo_id"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000;
```

```sql
-- 4. Explore keys in event_params to find relevant parameters
SELECT DISTINCT f.key
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 1000;
```

```sql
-- 5. Retrieve values where event_params key is 'quickplay_type'
SELECT f.value
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
WHERE f.key = 'quickplay_type'
LIMIT 1000;
```

```sql
-- 6. Find event names related to 'quickplay' using fuzzy matching
SELECT DISTINCT "event_name"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
WHERE "event_name" ILIKE '%quickplay%'
LIMIT 1000;
```

```sql
-- 7. Get user first touch timestamps to identify initial engagements
SELECT "user_first_touch_timestamp"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000;
```

```sql
-- 8. Extract platforms used by users
SELECT DISTINCT "platform"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000;
```

```sql
-- 9. Retrieve user properties to understand user attributes
SELECT f.value
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."user_properties") f
LIMIT 1000;
```

```sql
-- 10. Get event timestamps for analyzing event occurrence times
SELECT "event_timestamp"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000;
```

```sql
-- 11. Find distinct values of 'geo' data
SELECT DISTINCT f.value
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."geo") f
LIMIT 1000;
```

```sql
-- 12. Retrieve app information from 'app_info' column
SELECT f.value
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."app_info") f
LIMIT 1000;
```

```sql
-- 13. Get traffic source details to understand acquisition channels
SELECT f.value
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."traffic_source") f
LIMIT 1000;
```

```sql
-- 14. Identify devices used by users
SELECT f.value
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."device") f
LIMIT 1000;
```

```sql
-- 15. Extract stream IDs for event grouping
SELECT DISTINCT "stream_id"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000;
```

These queries help in understanding the structure and contents of the relevant columns, which is essential for calculating user retention rates based on specific event types and user engagement periods.Query:
-- 1. Get distinct event names to identify event types
SELECT DISTINCT "event_name"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000;
Answer:
event_name
session_start
level_complete_quickplay
screen_view
post_score
level_start_quickplay
level_end_quickplay
level_fail_quickplay
user_engagement
os_update
app_update
level_complete
level_up
level_end
level_fail
app_exception
select_content
error
level_start
level_retry_quickplay
use_extra_steps
level_reset
level_reset_quickplay
no_more_extra_steps
level_retry
app_remove
firebase_campaign
in_app_purchase
spend_virtual_currency
completed_5_levels
dynamic_link_app_open
ad_reward
challenge_a_friend
first_open
Query:
-- 2. Retrieve distinct event dates to understand date formats and ranges
SELECT DISTINCT "event_date"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000;
Answer:
event_date
20180801
Query:
-- 3. Get unique user IDs to assess the number of users
SELECT DISTINCT "user_pseudo_id"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000;
Answer:
Too long, hard cut:
user_pseudo_id
B458770ED6E295374FEEB3A68902CC28
841A68D5D1F94857BEB64225193B2432
27293EA0B2F41A672E15EF7B1FA21298
EE99F8CB32999A0FDAABBA18B05D4E48
2B5ABA17A30D32531C09DAF2865F9E55
159002C6F393752AD79B3C2E8C7104C7
A8D7DCCA39D8703F2928AD2D7BBB6BE9
F4634EFF4D9470DCA00051E3304B81AF
EBC3581ADA874D494FBE2C7CCF53BF99
D41AA91B61872612B5F5F4E42870042C
45BDDEC4DF8773F88DC51D1AFD145521
CEBD783B8F2E96E9F3B9424D4FB130E7
D9AA0EC27AF47514DDB5C664A6EF758A
55BFC405FFA33C0781DE73101011E45B
CFA0F8C5E25A71062E573EF8E6BC9F76
EFB696A82D093B3AFBE92FF526DD5CEA
04EF01C1F4723249F90F920DF018F16C
DA48D36D07835B1918BDF831AF83B5EF
5E624075FDFE3003C34E1138546B2450
210C3692734E251EEF4E952BC57DD998
B1D1ED35873581A23E48C4CD03DDFF81
C80CEE0983AB5B21D3F4B46089FDD9EB
AA35092B507100A45CBF225A23D56864
91814809BD9374D5CEDFC6A31727CC55
CC81C3C01DE545318860C5BFDC6AD31E
91F5161F80D1083CA7B37A08DEC9EC78
B54ED4ED7A122CAD69ED8771E62F4D72
46D808E730894AB0AC6E0F493B6FC864
1F0D27B8A7E058446D4A6409E2E73B19
934A101CA7B97944D05E0FC2ED3E203D
372D9BB5088C4E9000C65B06459B403A
6B7F85DBAABE78A99689D49CAE22072E
56FA726AC14329729C5A9B020B508034
7ED8C235689771F6B0F29BBF295A346F
1D435E381B7264B0A2DDDC9D911F9AE8
CD327D0141209436D7C03D644B969700
81E2E892D1C23CE76B072FA71310829F
6683CAFB77FB7B60C78CD233EB2B62F7
A7AAA5EF977926DBCF801D15F83EE4A5
96161BF2E55C7E32ED5F411432875ECB
FDA4BBBCF1EA2D95CDD77BFC5F00A837
F4EA0F2888792BD62555AD46ED534839
0F93A84CB0774C5BAB3E5FF8A72A694D
E66C3B8A38C424C7CBE0B5388EE5F77E
E643F6549E6C7EA0FD01EF4BF7A40F76
0EAC48BCE6DA434412A01656309CB1FF
32DC4BE3AF515BD8BD59B4DC0052A3AB
33E5EA9FE1E29AC3127D975A5494213D
7CA838857E3B7B8C9FC6A34E975FBF22
137944D29FEB9F2C96187C5F6604F5DB
EEBCB25D5F056CCF59DDE654388ACD2B
C74B58C4CD2770A1E97D6DC13D42CCAC
81F5705397CE9F0236B2B672AE113154
C464722AE0E9423DE721E72B8A524141
B99FD965B0874192EE94E8A8FE85EA9E
59772415A60A0B7E16588D219D7B85F1
A1FB1AAB886471FD9FFEADD8221847E8
914089851FFF3E8C0B3F64C73C8C6444
A064A84CD3CF7058F39333D6212E8615
9C2DD86B2DCB9FFB2356BC97F1ACE65F
17934EF7C1BC1CF2C7D942401FDE84CE
E19F04BAB15FBA761833F71BCF5D97D3
01562149DD13E75D732F0A9CA2D8CF5C
0E05F56141200FF41FCC0C7FA297FF08
3FC8ECFC8F2976C5B56D0D782F36BD7F
EF7772819E807EDBD8DB0F0B5210030E
AEB21692315E4F72D255C75E3584C12E
AFA6BA99FB329CB459E8E57FDE1DF9AE
FCB218A1B5C858D56B849CA70EDCF6B4
377303AA2F5C5C80E5AAAD26C029BD5A
EC1A759709685E136767F2C1BA4751ED
68C5F7CFAEAB93924B7B55D7129C0286
C60EACB47CF25AEEFD16C5E332078852
27B1CD26769B068D16FAAF82D4F2C1A8
38328F5729077611D47495753D2C04D1
70646770530D6BDEB05AFC16DD2559C2
CA51DAF1373B5C2A16C174AFBD2132A4
628E501EA1130A3A1C63DC1A3DF9D43A
13E6C8A193FF140F7D4222B569DD5B50
84E491A60BE52A4C6A438A89FADE283C
3E5101BCD089218A0E026C6750673B33
A72750663D0181C7817F61B3DD2CA656
FCA08F9B0DCB6E33A74F672CE7F73BE3
64EA802089E68A699EC86438C9504F94
8065F8E98407106A65D35195984B2258
C74E5AF2DAC240FA7F3B1612D5AEAA78
27C6D0E213A8121BF39FEA92C19D9144
B621164BDFE39D8021DDA4F652A284A5
2F4A6CF5C60E72BC578CA0E5189505F7
EF500E0CF578004836D1D38C8901862B
428B364B8F2B42ED8D7C5AD1020705EF
396CD60DADAB9CBA7DDCAF239B477135
EF028BE6C2230A5166A1A247D4687BA3
76690E22DDCE2B1FFA98C6A4376B8EA2
328DC7FE55E8881B2EA668C9A2855BB7
2B90CE94C6039DF03E72FE15B5320ABA
674EAE8D70D203FEDBE60DEAE2F834CC
01C784BDB7AF4DC8DAD6DCD21AF56E25
5A7EB17BF7D867AADECA2FDAF0941E88
0C777BD44F304574371C97674DCD0702
C2B541CA130165D03BA9BA7DC0E79273
E9DCE2D958652BD58E846DCE86BDD90A
E594F4CE9B23146A461021258CC7ACA2
12E5626928FE0885DEEF068683E8BD63
D47DCBB00B2B462C916A5A07DCFAB039
682A8CD0767A569DC68E7AA0201BFBA3
C4411A9EA6C9822AD521C60A4ED25F25
4593E981ECEF849FC7DA0F7FDA0F250E
E53BC2A0AD86417B443AF14EE3082C0F
53717D02C147929860D981CD68CE2D9A
8F6C5F7611B67A4A437FF283B6C10181
A1927ED722EA16A3B82E7EE0FA22FF4F
8941AB73D7CE7EF67AE0D6B866A8B5D0
6C654E9F5D2B57F4F2E2D9F240EC882C
9F61F3B36299C77519005F1B90A90108
03A75C48AFA4420AF4B3C23D7EDAC213
76B29DA61902BE1C9F957B66B017DA47
706C748E6D1E0768BFEFE6362B5D3F67
48C39ABD5CE13587DC55ADCAA366F951
ED244919E490C36963714E4C3E3025AB
85B9BAA3105AD395E7D84C61108F0D7E
6A2F4E7AB1816D2F6EC741BC92141766
1FDB055D4BD4AEC379A7B2F34E862913
D4A45A0CA838C439F64D565450B9A7D6
5FFBFE051291F79717B99F5D72B02CDC
7BCFAF1D468E309D866E9FEA7795FF85
AC14799A5E8C340D6CADCBAE72037D81
38AE6258A71E0D270D87AF7EFB0D419C
B215751EAC030DECC9124D90D2AC41A9
184B6DE721CD75D84BB9975E19003195
85C63B84706E6DD9752813675F9FB5F8
1A5905FC810CA20956805F3BACBEBCEF
C8859A791226C6027B90F72F880C3528
28C4A09298C441D5AFD39E749D9F3DA3
D11624EBD7C1693F9C3B4803A8D71DBA
A62D86FAFF43F1EC89D6F867915D7D56
D4B90F489AEED383CB46669EEEB12E92
42421044D6B3F0190A37145A20403036
8211CABE9A3F1FE1BF3154E0C8D30368
476409D7DFD0B2B2B0AB11E5F6D7DDBE
887A958AF69B7172916C3748444BFF0B
EBE661044C1949546986A852F35083A1
7D05DF6F0141D016FD20F7B8E71FAB0A
82486A3B62D50DB914F1C6857733DAB2
8601A3659DC5C1F0444E5CCDA5ED3E14
A944897CEB774B1BC2AFEA13A907B39E
1DC9B625F2C4F54E9281D4D19F9FEBBB
C7E2273D8B11257FCCC915D27C1FCA24
82D556A8003F97B39A2D2E8E5520F9B6
053914EB0DA99A613D6AF0E92FCA9940
39BE7CAB9B8602ABD10A1BFB4E66BBB2
EF
Query:
SELECT DISTINCT
    f.value:name::STRING AS key_name,
    f.value:string_value::STRING AS string_value,
    f.value:int_value::NUMBER AS int_value,
    f.value:float_value::FLOAT AS float_value,
    f.value:double_value::FLOAT AS double_value
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 1000;
Answer:
KEY_NAME,STRING_VALUE,INT_VALUE,FLOAT_VALUE,DOUBLE_VALUE
,,,,
Query:
SELECT 
    f.value:"name"::STRING AS param_name,
    f.value:"value":"string_value"::STRING AS string_value
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 1000;
Answer:
Too long, hard cut:
PARAM_NAME,STRING_VALUE
,FIRootViewController
,auto
,
,
,FIRootViewController
,auto
,
,
,
,FIRootViewController
,app+gtm
,
,S
,
,FIRootViewController
,app+gtm
,
,S
,
,auto
,
,GADOInterstitialViewController
,FIRootViewController/Interstitial
,GADOInterstitialViewController
,
,auto
,
,FIRootViewController/Interstitial
,GADOInterstitialViewController
,FIRootViewController
,
,FIMainMenuViewController
,auto
,
,FIRootViewController
,
,main_menu
,auto
,
,FIMainMenuViewController
,
,FIRootViewController
,auto
,
,main_menu
,
,FIOutOfStepsViewController
,auto
,
,FIRootViewController
,
,iap
,auto
,
,FIOutOfStepsViewController
,
,out_of_steps
,auto
,
,iap
,
,extra_steps
,auto
,
,out_of_steps
,
,FIRootViewController
,auto
,
,extra_steps
,
,FIGameOverViewController
,auto
,
,FIRootViewController
,
,game_over
,auto
,
,FIGameOverViewController
,
,FIRootViewController
,auto
,
,game_over
,
,GADOInterstitialViewController
,auto
,
,FIRootViewController
,
,FIGameOverViewController
,auto
,
,FIRootViewController
,
,game_over
,auto
,
,FIGameOverViewController
,
,FIRootViewController
,auto
,
,game_over
,
,FIGameOverViewController
,auto
,
,FIRootViewController
,
,game_over
,auto
,
,FIGameOverViewController
,app+gtm
,
,level_0
,FIRootViewController
,
,
,app+gtm
,
,level_0
,FIRootViewController
,
,
,FIRootViewController
,auto
,
,main_menu
,app+gtm
,
,S
,FIRootViewController
,app+gtm
,
,S
,FIRootViewController
,app+gtm
,
,S
,game_over
,app+gtm
,
,S
,FIRootViewController
,app+gtm
,
,S
,game_over
,app+gtm
,
,S
,FIRootViewController
,app+gtm
,
,S
,main_menu
,app+gtm
,
,mode
,Quickplay
,main_menu
,auto
,
,
,FIRootViewController
,auto
,
,
,extra_steps
,auto
,
,
,game_over
,auto
,
,
,FIRootViewController
,auto
,
,
,game_over
,auto
,
,
,game_over
,auto
,
,
,FIRootViewController
,auto
,
,
,game_over
,auto
,
,
,GADOInterstitialViewController
,auto
,
,
,FIRootViewController/Interstitial
,main_menu
,auto
,11.4
,
,FIRootViewController
,auto
,
,
,
,FIMainMenuViewController
,auto
,
,FIRootViewController
,
,main_menu
,auto
,
,FIMainMenuViewController
,
,FIRootViewController
,auto
,
,main_menu
,FIRootViewController
,auto
,
,main_menu
,app+gtm
,
,S
,main_menu
,app+gtm
,
,mode
,Quickplay
,main_menu
,auto
,
,
,FIRootViewController
,auto
,
,
,auto
,
,FIRootViewController/Interstitial
,
,GADNFullScreenAdViewController
,ad_click
,
,FIRootViewController
,app+gtm
,
,S
,
,auto
,
,GADNFullScreenAdViewController
,FIRootViewController/Interstitial
,GADNFullScreenAdViewController
,
,FIMainMenuViewController
,auto
,
,FIRootViewController
,
,main_menu
,auto
,
,FIMainMenuViewController
,
,FIRootViewController
,auto
,
,main_menu
,
,FIGameOverViewController
,auto
,
,FIRootViewController
,
,game_over
,auto
,
,FIGameOverViewController
,
,FIRootViewController
,auto
,
,game_over
,
,GADNFullScreenAdViewController
,auto
,
,FIRootViewController
,app+gtm
,
,level_0
,FIRootViewController
,
,
,FIRootViewController
,auto
,
,main_menu
,app+gtm
,
,S
,FIRootViewController
,app+gtm
,
,S
,game_over
,app+gtm
,
,S
,main_menu
,app+gtm
,
,mode
,Quickplay
,main_menu
,auto
,
,
,FIRootViewController
,auto
,
,
,game_over
,auto
,
,
,GADNFullScreenAdViewController
,auto
,
,
,FIRootViewController/Interstitial
,FIRootViewController
,auto
,
,2.6.30
,FIRootViewController
,auto
,
,
,
,app+gtm
,
,level_1
,FIRootViewController
,
,
,
,app+gtm
,
,level_2
,FIRootViewController
,
,
,
,app+gtm
,
,level_3
,FIRootViewController
,
,
,
,app+gtm
,
,level_4
,FIRootViewController
,
,
,
,app+gtm
,
,level_1
,FIRootViewController
,
,
,app+gtm
,
,level_2
,FIRootViewController
,
,
,app+gtm
,
,level_3
,FIRootViewController
,
,
,app+gtm
,
,level_4
,FIRootViewController
,
,
,auto
,
,GADNFullScreenAdViewController
,FIRootViewController/Interstitial
,GADNFullScreenAdViewController
,
,auto
,
,GADNFullScreenAdViewController
,FIRootViewController/Interstitial
,GADNFullScreenAdViewController
,
,auto
,
,FIRootViewController/Interstitial
,GADNFullScreenAdViewController
,FIRootViewController
,
,auto
,
,FIRootViewController/Interstitial
,GADNFullScreenAdViewController
,FIRootViewController
,
,FIMainMenuViewController
,auto
,
,FIRootViewController
,
,main_menu
,auto
,
,FIMainMenuViewController
,
,FIRootViewController
,auto
,
,main_menu
,
,FIOutOfStepsViewController
,auto
,
,FIRootViewController
,
,iap
,auto
,
,FIOutOfStepsViewController
,
,out_of_steps
,auto
,
,iap
,
,extra_steps
,auto
,
,out_of_steps
,
,FIRootViewController
,auto
,
,extra_steps
,
,FIGameOverViewController
,auto
,
,FIRootViewController
,
,game_over
,auto
,
,FIGameOverViewController
,
,FIRootViewController
,auto
,
,game_over
,
,FIOutOfStepsViewController
,auto
,
,FIRootViewController
,
,iap
,auto
,
,FIOutOfStepsViewController
,
,out_of_steps
,auto
,
,iap
,
,extra_steps
,auto
,
,out_of_steps
,
,FIRootViewController
,auto
,
,extra_steps
,
,FIGameOverViewController
,auto
,
,FIRootViewController
,
,game_over
,auto
,
,FIGameOverViewController
,
,FIRootViewController
,auto
,
,game_over
,
,FIMainMenuViewController
,auto
,
,FIRootViewController
,
,main_menu
,auto
,
,FIMainMe
Query:
-- 6. Find event names related to 'quickplay' using fuzzy matching
SELECT DISTINCT "event_name"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
WHERE "event_name" ILIKE '%quickplay%'
LIMIT 1000;
Answer:
event_name
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_retry_quickplay
level_reset_quickplay
Query:
-- 7. Get user first touch timestamps to identify initial engagements
SELECT "user_first_touch_timestamp"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000;
Answer:
Too long, hard cut:
user_first_touch_timestamp
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1464609963675000
1510416265184000
1510416265184000
1510416265184000
1510416265184000
1510416265184000
1510416265184000
1510416265184000
1510416265184000
1510416265184000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1520149684096000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1476052728192000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1503708448544000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1531049556960000
1486608183392000
1486608183392000
1486608183392000
1486608183392000
1486608183392000
1486608183392000
1486608183392000
1486608183392000
1486608183392000
1486608183392000
1486608183392000
1486608183392000
1486608183392000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1527943269056000
1501257623221000
1501257623221000
1501257623221000
1501257623221000
1501257623221000
1501257623221000
1501257623221000
1501257623221000
1501257623221000
1501257623221000
1501257623221000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
1465427655893000
146542765
Query:
-- 8. Extract platforms used by users
SELECT DISTINCT "platform"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000;
Answer:
platform
IOS
ANDROID
Query:
-- 9. Retrieve user properties to understand user attributes
SELECT f.value
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."user_properties") f
LIMIT 1000;
Answer:
Too long, hard cut:
VALUE
"{
  ""key"": ""firebase_exp_3"",
  ""value"": {
    ""set_timestamp_micros"": 1528374603614000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464610100753000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1486124557706000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464609977006000,
    ""string_value"": ""20""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464609963675000,
    ""set_timestamp_micros"": 1464609973675000
  }
}"
"{
  ""key"": ""firebase_exp_3"",
  ""value"": {
    ""set_timestamp_micros"": 1528374613614000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464610110753000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1486124567706000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464609987006000,
    ""string_value"": ""20""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464609963675000,
    ""set_timestamp_micros"": 1464609983675000
  }
}"
"{
  ""key"": ""firebase_exp_3"",
  ""value"": {
    ""set_timestamp_micros"": 1528374639614000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464610136753000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1486124593706000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464610013006000,
    ""string_value"": ""20""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464609963675000,
    ""set_timestamp_micros"": 1464610009675000
  }
}"
"{
  ""key"": ""firebase_exp_3"",
  ""value"": {
    ""set_timestamp_micros"": 1528374686614000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464610183753000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1486124640706000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464610060006000,
    ""string_value"": ""20""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464609963675000,
    ""set_timestamp_micros"": 1464610056675000
  }
}"
"{
  ""key"": ""firebase_exp_3"",
  ""value"": {
    ""set_timestamp_micros"": 1528374666614000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464610163753000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1486124620706000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464610040006000,
    ""string_value"": ""20""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464609963675000,
    ""set_timestamp_micros"": 1464610036675000
  }
}"
"{
  ""key"": ""firebase_exp_3"",
  ""value"": {
    ""set_timestamp_micros"": 1528374663614000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464610160753000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1486124617706000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464610037006000,
    ""string_value"": ""20""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464609963675000,
    ""set_timestamp_micros"": 1464610033675000
  }
}"
"{
  ""key"": ""firebase_exp_3"",
  ""value"": {
    ""set_timestamp_micros"": 1528374674614000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464610171753000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1486124628706000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464610048006000,
    ""string_value"": ""20""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464609963675000,
    ""set_timestamp_micros"": 1464610044675000
  }
}"
"{
  ""key"": ""firebase_exp_3"",
  ""value"": {
    ""set_timestamp_micros"": 1528374686614000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464610183753000,
    ""string_value"": ""t
Query:
-- 10. Get event timestamps for analyzing event occurrence times
SELECT "event_timestamp"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000;
Answer:
Too long, hard cut:
event_timestamp
1533178516177000
1533186548206000
1533178706133033
1533186675592002
1533178649867023
1533178654065028
1533178577238001
1533178589239002
1533178544470012
1533178619839003
1533178634839004
1533178592839005
1533178622840006
1533178572533010
1533178645114013
1533178637114014
1533178632893019
1533178659866022
1533178680673037
1533178700673038
1533186529737004
1533186639178006
1533186655178007
1533178694133031
1533186632592000
1533178513674000
1533178505779007
1533178604533011
1533178616533012
1533178652337015
1533178757133032
1533186595977000
1533186658592001
1533178513778006
1533178510469009
1533178587838000
1533178625531007
1533178606892016
1533178728673034
1533178759086039
1533186577737001
1533186608176003
1533186609960008
1533178609064025
1533176867427006
1533176872452000
1533176888209004
1533176912209005
1533176930248002
1533176913629003
1533176878339008
1533176917337007
1533176882247001
1533153346436000
1533153565261001
1533153427747002
1533153526463016
1533153306935005
1533153390935006
1533153403144011
1533153501316006
1533153480317007
1533153500660012
1533153552462015
1533153501747000
1533153386415003
1533153377417008
1533153501747001
1533153554895008
1533153354416007
1533153335144010
1533153440315003
1533153483659009
1533153572283002
1533146745626004
1533146807631000
1533146992865000
1533146982986000
1533147027807000
1533147036897000
1533146989865070
1533146947986003
1533146975807003
1533147097897008
1533146967161058
1533147030181018
1533146924401064
1533147007327003
1533146766012005
1533146807013006
1533146800896004
1533146868046003
1533146883046004
1533146907046005
1533146836046006
1533146862339010
1533146904894013
1533146818895014
1533146820473019
1533146958762023
1533146950762024
1533146932763025
1533146935763026
1533146927994030
1533146946539033
1533146946540034
1533146906458038
1533146893020039
1533146948020040
1533146961209045
1533146972210046
1533146908920050
1533146962485053
1533146939160057
1533146965390074
1533146935391075
1533146909204079
1533146977731081
1533146953539007
1533146997539008
1533147000264009
1533146993794012
1533147010349007
1533146961349008
1533146961100012
1533146957627014
1533147025179017
1533147075452012
1533147073453013
1533147048781017
1533147090305019
1533147127724003
1533147144724004
1533147123724005
1533147111724006
1533147136233010
1533146984865067
1533147014986000
1533147046807000
1533147057897005
1533146822471003
1533146786346001
1533146819339011
1533146862339012
1533146893947015
1533146965994031
1533146889994032
1533146910920052
1533146983865068
1533146923204080
1533146990986001
1533146986265010
1533146963807001
1533146973100013
1533147046897006
1533147021782018
1533147060234011
1533147104234012
1533146789345000
1533146901814041
1533146950917051
1533146829895003
1533146879045000
1533146914337007
1533146823472016
1533146882761020
1533146945993027
1533146903457035
1533146897207042
1533146952918047
1533146966158056
1533146989389071
1533146929203076
1533146932538004
1533146964793011
1533147035348004
1533146974099009
1533147039179016
1533147097451009
1533147023777014
1533147110723000
1533147094232007
1533147139463013
1533146954400061
1533147024327000
1533178473346000
1533178541554007
1533178506618000
1533178628867002
1533178462868005
1533178512028006
1533178516220011
1533178558512006
1533178640512007
1533178572867000
1533178475404004
1533178526568009
1533178634867001
1533178535566008
1533178639511003
1533178651162008
1533170414038000
1533170404257002
1533170400225001
1533170322225002
1533170414304012
1533170402811006
1533170447811007
1533170435329011
1533170482888012
1533170402888013
1533170486257000
1533170340691000
1533170328331007
1533170428257001
1533170344330006
1533170327304009
1533170398810003
1533170471328008
1533170476820014
1533173292504000
1533173221311010
1533173318931000
1533173377932002
1533173224964001
1533173237964002
1533173352600006
1533173332601007
1533173285313011
1533173380932001
1533173255781000
1533173309599005
1533173294729010
1533122520370000
1533122646518002
1533122793839016
1533122510176004
1533122530519006
1533122530815011
1533122627102006
1533122638102007
1533122713268013
1533122797416020
1533122778416021
1533122605518000
1533122765839014
1533122511977003
1533122457793008
1533122614518001
1533122692329008
1533122815839015
1533122536793007
1533122534815010
1533122641100003
1533122721267010
1533122768414017
1533122752900022
1533142701338000
1533142798077002
1533142707512006
1533142785657006
1533142750657007
1533142734077000
1533142657327001
1533142708077001
1533142685511003
1533142797654003
1533142775375008
1533148961854000
1533149528704051
1533149317986043
1533149329894048
1533148932154001
1533148949155002
1533149017764010
1533149142573003
1533149114575004
1533149212576005
1533149171264009
1533149134880012
1533149130881013
1533149208197019
1533149366774023
1533149311774024
1533149342774025
1533149305857029
1533149289456032
1533149360457033
1533149295322039
1533149342984042
1533149544361055
1533149483363056
1533149512703049
153
Query:
-- 11. Find distinct values of 'geo' data
SELECT DISTINCT f.value
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."geo") f
LIMIT 1000;
Answer:
VALUE
"""Americas"""
"""Mexico"""
"""United States"""
"""Europe"""
"""United Kingdom"""
"""Asia"""
"""Japan"""
"""Gibraltar"""
"""Brazil"""
"""Canada"""
"""United Arab Emirates"""
"""Denmark"""
"""Oceania"""
"""Sydney"""
"""New South Wales"""
"""Australia"""
"""Colombia"""
"""Indonesia"""
"""Hong Kong"""
"""Taiwan"""
"""Russia"""
"""Thailand"""
"""Israel"""
"""Lebanon"""
"""Africa"""
"""Pakistan"""
"""Telangana"""
"""Spain"""
"""Illinois"""
""""""
"""Jordan"""
"""London"""
"""England"""
"""Morocco"""
"""Romania"""
"""Puerto Rico"""
"""China"""
"""Croatia"""
"""Germany"""
"""Belgium"""
"""Netherlands"""
"""Austria"""
"""Serbia"""
"""India"""
"""Hyderabad"""
"""South Africa"""
"""Chicago"""
"""Egypt"""
"""Vietnam"""
"""Dominican Republic"""
"""Afghanistan"""
"""Greece"""
"""Sweden"""
"""France"""
"""Kenya"""
"""South Korea"""
"""Peru"""
"""Slovenia"""
"""Turkey"""
"""Nigeria"""
"""Argentina"""
"""Italy"""
Query:
-- 12. Retrieve app information from 'app_info' column
SELECT f.value
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."app_info") f
LIMIT 1000;
Answer:
Too long, hard cut:
VALUE
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.31"""
"""1:300830567303:ios:09b1ab1d3ca29bda"""
"""com.google.flood2"""
"""iTunes"""
"""2.6.27"""
"""1:300830567303:ios:09b1
Query:
-- 13. Get traffic source details to understand acquisition channels
SELECT f.value
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."traffic_source") f
LIMIT 1000;
Answer:
Too long, hard cut:
VALUE
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(none)"""
"""(direct)"""
"""(direct)"""
"""(no
Query:
-- 14. Identify devices used by users
SELECT f.value
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."device") f
LIMIT 1000;
Answer:
Too long, hard cut:
VALUE
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""IOS"""
"""not available in demo dataset"""
-18000
"""mobile"""
"""No"""
"""es-mx"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"""not available in demo dataset"""
"
Query:
-- 15. Extract stream IDs for event grouping
SELECT DISTINCT "stream_id"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000;
Answer:
stream_id
1051193347
1051193346
End Exploring Related Columns
Task: Which quickplay event type had the lowest user retention rate during the second week after their initial engagement, for users who first engaged between August 1 and August 15, 2018?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: SELECT S."Column_Name" FROM {Database Name}.{Schema Name}.{Table_name} (ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
event_type,second_week_retention_rate
event_type_name:str,rate:float
(Attention: answer in one row)
```

This table represents the quickplay event type that had the lowest user retention rate during the second week after their initial engagement for users who first engaged between August 1 and August 15, 2018. The `event_type` column specifies the name of the event, and the `second_week_retention_rate` column provides the corresponding retention rate as a floating-point number..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
Keep all decimals to four decimal places.

2025-01-18 16:12:49 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 16:12:49 - root - INFO - ```sql
WITH all_events AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180802"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180803"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180804"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180805"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180806"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180807"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180808"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180809"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180810"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180811"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180812"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180813"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180814"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180815"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180816"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180817"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180818"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180819"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180820"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180821"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180822"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180823"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180824"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180825"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180826"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180827"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180828"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180829"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180830"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180831"
),
user_first_engagement AS (
  SELECT DISTINCT e."user_pseudo_id",
       (e."user_first_touch_timestamp" / 1000000)::TIMESTAMP AS first_touch_time
  FROM all_events e
  WHERE DATE((e."user_first_touch_timestamp" / 1000000)::TIMESTAMP) BETWEEN '2018-08-01' AND '2018-08-15'
),
initial_engagement_events AS (
  SELECT e."user_pseudo_id", e."event_name", u.first_touch_time
  FROM all_events e
  JOIN user_first_engagement u ON e."user_pseudo_id" = u."user_pseudo_id"
  WHERE DATE((e."event_timestamp" / 1000000)::TIMESTAMP) = DATE(u.first_touch_time)
    AND e."event_name" LIKE '%quickplay%'
),
user_event_counts AS (
  SELECT "event_name", COUNT(DISTINCT "user_pseudo_id") AS initial_user_count
  FROM initial_engagement_events
  GROUP BY "event_name"
),
retention_events AS (
  SELECT DISTINCT e."user_pseudo_id"
  FROM all_events e
  JOIN user_first_engagement u ON e."user_pseudo_id" = u."user_pseudo_id"
  WHERE ((e."event_timestamp" / 1000000)::TIMESTAMP) >= (u.first_touch_time + INTERVAL '7 DAY')
    AND ((e."event_timestamp" / 1000000)::TIMESTAMP) < (u.first_touch_time + INTERVAL '14 DAY')
),
user_retained AS (
  SELECT ie."event_name", COUNT(DISTINCT ie."user_pseudo_id") AS retained_user_count
  FROM initial_engagement_events ie
  JOIN retention_events re ON ie."user_pseudo_id" = re."user_pseudo_id"
  GROUP BY ie."event_name"
)
SELECT uec."event_name" AS event_type,
       ROUND((COALESCE(ur.retained_user_count, 0)::FLOAT / uec.initial_user_count), 4) AS second_week_retention_rate
FROM user_event_counts uec
LEFT JOIN user_retained ur ON uec."event_name" = ur."event_name"
ORDER BY second_week_retention_rate ASC NULLS LAST
LIMIT 1;
```
2025-01-18 16:12:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:12:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:12:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:12:50 - snowflake.connector.connection - INFO - closed
2025-01-18 16:12:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:12:51 - root - INFO - itercount: 1
2025-01-18 16:12:51 - root - INFO - 001789 (42601): 01b9cc0c-0004-7b16-0001-11c300ee5c32: SQL compilation error:
invalid number of result columns for set operator input branches, expected 19, got 20 in branch 28
2025-01-18 16:12:51 - root - INFO - Input sql:
WITH all_events AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180802"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180803"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180804"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180805"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180806"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180807"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180808"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180809"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180810"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180811"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180812"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180813"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180814"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180815"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180816"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180817"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180818"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180819"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180820"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180821"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180822"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180823"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180824"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180825"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180826"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180827"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180828"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180829"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180830"
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180831"
),
user_first_engagement AS (
  SELECT DISTINCT e."user_pseudo_id",
       (e."user_first_touch_timestamp" / 1000000)::TIMESTAMP AS first_touch_time
  FROM all_events e
  WHERE DATE((e."user_first_touch_timestamp" / 1000000)::TIMESTAMP) BETWEEN '2018-08-01' AND '2018-08-15'
),
initial_engagement_events AS (
  SELECT e."user_pseudo_id", e."event_name", u.first_touch_time
  FROM all_events e
  JOIN user_first_engagement u ON e."user_pseudo_id" = u."user_pseudo_id"
  WHERE DATE((e."event_timestamp" / 1000000)::TIMESTAMP) = DATE(u.first_touch_time)
    AND e."event_name" LIKE '%quickplay%'
),
user_event_counts AS (
  SELECT "event_name", COUNT(DISTINCT "user_pseudo_id") AS initial_user_count
  FROM initial_engagement_events
  GROUP BY "event_name"
),
retention_events AS (
  SELECT DISTINCT e."user_pseudo_id"
  FROM all_events e
  JOIN user_first_engagement u ON e."user_pseudo_id" = u."user_pseudo_id"
  WHERE ((e."event_timestamp" / 1000000)::TIMESTAMP) >= (u.first_touch_time + INTERVAL '7 DAY')
    AND ((e."event_timestamp" / 1000000)::TIMESTAMP) < (u.first_touch_time + INTERVAL '14 DAY')
),
user_retained AS (
  SELECT ie."event_name", COUNT(DISTINCT ie."user_pseudo_id") AS retained_user_count
  FROM initial_engagement_events ie
  JOIN retention_events re ON ie."user_pseudo_id" = re."user_pseudo_id"
  GROUP BY ie."event_name"
)
SELECT uec."event_name" AS event_type,
       ROUND((COALESCE(ur.retained_user_count, 0)::FLOAT / uec.initial_user_count), 4) AS second_week_retention_rate
FROM user_event_counts uec
LEFT JOIN user_retained ur ON uec."event_name" = ur."event_name"
ORDER BY second_week_retention_rate ASC NULLS LAST
LIMIT 1;
The error information is:
001789 (42601): 01b9cc0c-0004-7b16-0001-11c300ee5c32: SQL compilation error:
invalid number of result columns for set operator input branches, expected 19, got 20 in branch 28
Please correct it and output only 1 complete SQL query.
2025-01-18 16:14:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 16:14:05 - root - INFO - ```sql
WITH all_events AS (
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180802"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180803"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180804"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180805"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180806"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180807"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180808"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180809"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180810"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180811"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180812"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180813"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180814"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180815"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180816"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180817"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180818"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180819"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180820"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180821"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180822"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180823"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180824"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180825"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180826"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180827"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180828"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180829"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180830"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180831"
),
user_first_engagement AS (
    SELECT DISTINCT e."user_pseudo_id",
         (e."user_first_touch_timestamp" / 1000000)::TIMESTAMP AS first_touch_time
    FROM all_events e
    WHERE DATE((e."user_first_touch_timestamp" / 1000000)::TIMESTAMP) BETWEEN '2018-08-01' AND '2018-08-15'
),
initial_engagement_events AS (
    SELECT e."user_pseudo_id", e."event_name", u.first_touch_time
    FROM all_events e
    JOIN user_first_engagement u ON e."user_pseudo_id" = u."user_pseudo_id"
    WHERE DATE((e."event_timestamp" / 1000000)::TIMESTAMP) = DATE(u.first_touch_time)
      AND e."event_name" LIKE '%quickplay%'
),
user_event_counts AS (
    SELECT "event_name", COUNT(DISTINCT "user_pseudo_id") AS initial_user_count
    FROM initial_engagement_events
    GROUP BY "event_name"
),
retention_events AS (
    SELECT DISTINCT e."user_pseudo_id"
    FROM all_events e
    JOIN user_first_engagement u ON e."user_pseudo_id" = u."user_pseudo_id"
    WHERE ((e."event_timestamp" / 1000000)::TIMESTAMP) >= (u.first_touch_time + INTERVAL '7 DAY')
      AND ((e."event_timestamp" / 1000000)::TIMESTAMP) < (u.first_touch_time + INTERVAL '14 DAY')
),
user_retained AS (
    SELECT ie."event_name", COUNT(DISTINCT ie."user_pseudo_id") AS retained_user_count
    FROM initial_engagement_events ie
    JOIN retention_events re ON ie."user_pseudo_id" = re."user_pseudo_id"
    GROUP BY ie."event_name"
)
SELECT uec."event_name" AS event_type,
       ROUND((COALESCE(ur.retained_user_count, 0)::FLOAT / uec.initial_user_count), 4) AS second_week_retention_rate
FROM user_event_counts uec
LEFT JOIN user_retained ur ON uec."event_name" = ur."event_name"
ORDER BY second_week_retention_rate ASC NULLS LAST
LIMIT 1;
```
2025-01-18 16:14:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:14:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:14:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:14:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-18 16:14:08 - snowflake.connector.connection - INFO - closed
2025-01-18 16:14:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:14:08 - root - INFO - itercount: 2
2025-01-18 16:14:08 - root - INFO - 0
2025-01-18 16:14:08 - root - INFO - results: 
EVENT_TYPE,SECOND_WEEK_RETENTION_RATE
level_start_quickplay,0.1748


2025-01-18 16:14:08 - root - INFO - Please check the answer again by reviewing Which quickplay event type had the lowest user retention rate during the second week after their initial engagement, for users who first engaged between August 1 and August 15, 2018?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
event_type,second_week_retention_rate
event_type_name:str,rate:float
(Attention: answer in one row)
```

This table represents the quickplay event type that had the lowest user retention rate during the second week after their initial engagement for users who first engaged between August 1 and August 15, 2018. The `event_type` column specifies the name of the event, and the `second_week_retention_rate` column provides the corresponding retention rate as a floating-point number. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
EVENT_TYPE,SECOND_WEEK_RETENTION_RATE
level_start_quickplay,0.1748
Current sql:
WITH all_events AS (
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180802"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180803"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180804"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180805"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180806"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180807"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180808"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180809"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180810"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180811"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180812"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180813"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180814"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180815"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180816"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180817"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180818"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180819"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180820"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180821"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180822"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180823"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180824"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180825"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180826"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180827"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180828"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180829"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180830"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180831"
),
user_first_engagement AS (
    SELECT DISTINCT e."user_pseudo_id",
         (e."user_first_touch_timestamp" / 1000000)::TIMESTAMP AS first_touch_time
    FROM all_events e
    WHERE DATE((e."user_first_touch_timestamp" / 1000000)::TIMESTAMP) BETWEEN '2018-08-01' AND '2018-08-15'
),
initial_engagement_events AS (
    SELECT e."user_pseudo_id", e."event_name", u.first_touch_time
    FROM all_events e
    JOIN user_first_engagement u ON e."user_pseudo_id" = u."user_pseudo_id"
    WHERE DATE((e."event_timestamp" / 1000000)::TIMESTAMP) = DATE(u.first_touch_time)
      AND e."event_name" LIKE '%quickplay%'
),
user_event_counts AS (
    SELECT "event_name", COUNT(DISTINCT "user_pseudo_id") AS initial_user_count
    FROM initial_engagement_events
    GROUP BY "event_name"
),
retention_events AS (
    SELECT DISTINCT e."user_pseudo_id"
    FROM all_events e
    JOIN user_first_engagement u ON e."user_pseudo_id" = u."user_pseudo_id"
    WHERE ((e."event_timestamp" / 1000000)::TIMESTAMP) >= (u.first_touch_time + INTERVAL '7 DAY')
      AND ((e."event_timestamp" / 1000000)::TIMESTAMP) < (u.first_touch_time + INTERVAL '14 DAY')
),
user_retained AS (
    SELECT ie."event_name", COUNT(DISTINCT ie."user_pseudo_id") AS retained_user_count
    FROM initial_engagement_events ie
    JOIN retention_events re ON ie."user_pseudo_id" = re."user_pseudo_id"
    GROUP BY ie."event_name"
)
SELECT uec."event_name" AS event_type,
       ROUND((COALESCE(ur.retained_user_count, 0)::FLOAT / uec.initial_user_count), 4) AS second_week_retention_rate
FROM user_event_counts uec
LEFT JOIN user_retained ur ON uec."event_name" = ur."event_name"
ORDER BY second_week_retention_rate ASC NULLS LAST
LIMIT 1;
2025-01-18 16:14:48 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 16:14:48 - root - INFO - ```csv
event_type,second_week_retention_rate
level_start_quickplay,0.1748
```

```sql
WITH all_events AS (
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180802"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180803"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180804"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180805"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180806"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180807"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180808"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180809"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180810"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180811"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180812"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180813"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180814"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180815"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180816"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180817"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180818"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180819"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180820"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180821"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180822"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180823"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180824"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180825"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180826"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180827"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180828"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180829"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180830"
    UNION ALL
    SELECT "event_timestamp", "event_name", "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180831"
),
user_first_engagement AS (
    SELECT DISTINCT e."user_pseudo_id",
         (e."user_first_touch_timestamp" / 1000000)::TIMESTAMP AS first_touch_time
    FROM all_events e
    WHERE DATE((e."user_first_touch_timestamp" / 1000000)::TIMESTAMP) BETWEEN '2018-08-01' AND '2018-08-15'
),
initial_engagement_events AS (
    SELECT e."user_pseudo_id", e."event_name", u.first_touch_time
    FROM all_events e
    JOIN user_first_engagement u ON e."user_pseudo_id" = u."user_pseudo_id"
    WHERE DATE((e."event_timestamp" / 1000000)::TIMESTAMP) = DATE(u.first_touch_time)
      AND e."event_name" LIKE '%quickplay%'
),
user_event_counts AS (
    SELECT "event_name", COUNT(DISTINCT "user_pseudo_id") AS initial_user_count
    FROM initial_engagement_events
    GROUP BY "event_name"
),
retention_events AS (
    SELECT DISTINCT e."user_pseudo_id"
    FROM all_events e
    JOIN user_first_engagement u ON e."user_pseudo_id" = u."user_pseudo_id"
    WHERE ((e."event_timestamp" / 1000000)::TIMESTAMP) >= (u.first_touch_time + INTERVAL '7 DAY')
      AND ((e."event_timestamp" / 1000000)::TIMESTAMP) < (u.first_touch_time + INTERVAL '14 DAY')
),
user_retained AS (
    SELECT ie."event_name", COUNT(DISTINCT ie."user_pseudo_id") AS retained_user_count
    FROM initial_engagement_events ie
    JOIN retention_events re ON ie."user_pseudo_id" = re."user_pseudo_id"
    GROUP BY ie."event_name"
)
SELECT uec."event_name" AS event_type,
       ROUND((COALESCE(ur.retained_user_count, 0)::FLOAT / uec.initial_user_count), 4) AS second_week_retention_rate
FROM user_event_counts uec
LEFT JOIN user_retained ur ON uec."event_name" = ur."event_name"
ORDER BY second_week_retention_rate ASC NULLS LAST
LIMIT 1;
```
2025-01-18 16:14:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 16:14:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 16:14:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 16:14:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-18 16:14:50 - snowflake.connector.connection - INFO - closed
2025-01-18 16:14:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 16:14:50 - root - INFO - itercount: 3
2025-01-18 16:14:50 - root - INFO - 0
2025-01-18 16:14:50 - root - INFO - Total iteration counts: 3
