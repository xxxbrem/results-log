2025-01-18 12:53:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 12:54:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 12:54:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:54:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:54:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:54:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 12:54:15 - snowflake.connector.connection - INFO - closed
2025-01-18 12:54:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:54:35 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 12:54:35 - root - INFO - ```sql
SELECT
  condition_name,
  (COUNT(DISTINCT "person_id") * 100.0 / (SELECT COUNT(DISTINCT "person_id") FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON")) AS percentage
FROM (
  SELECT
    "person_id",
    CASE
      WHEN "condition_source_value" LIKE 'L70%' THEN 'Acne (L70)'
      WHEN "condition_source_value" LIKE 'L20%' THEN 'Atopic dermatitis (L20)'
      WHEN "condition_source_value" LIKE 'L40%' THEN 'Psoriasis (L40)'
      WHEN "condition_source_value" LIKE 'L80%' THEN 'Vitiligo (L80)'
      ELSE NULL
    END AS condition_name
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE"
  WHERE "condition_source_value" LIKE 'L70%'
     OR "condition_source_value" LIKE 'L20%'
     OR "condition_source_value" LIKE 'L40%'
     OR "condition_source_value" LIKE 'L80%'
) t
WHERE condition_name IS NOT NULL
GROUP BY condition_name;
```
2025-01-18 12:54:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:54:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:54:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:54:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 12:54:38 - snowflake.connector.connection - INFO - closed
2025-01-18 12:54:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:55:00 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 12:55:00 - root - INFO - ```sql
SELECT
  CASE
    WHEN c."concept_code" LIKE 'L70%' THEN 'Acne (L70)'
    WHEN c."concept_code" LIKE 'L20%' THEN 'Atopic dermatitis (L20)'
    WHEN c."concept_code" LIKE 'L40%' THEN 'Psoriasis (L40)'
    WHEN c."concept_code" LIKE 'L80%' THEN 'Vitiligo (L80)'
    ELSE 'Other'
  END AS condition_name,
  (COUNT(DISTINCT co."person_id") * 100.0) / (SELECT COUNT(DISTINCT "person_id") FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON") AS percentage
FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE" co
JOIN "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT" c
  ON co."condition_concept_id" = c."concept_id"
WHERE c."vocabulary_id" = 'ICD10CM'
  AND (
    c."concept_code" LIKE 'L70%'
    OR c."concept_code" LIKE 'L20%'
    OR c."concept_code" LIKE 'L40%'
    OR c."concept_code" LIKE 'L80%'
  )
GROUP BY condition_name;
```
2025-01-18 12:55:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:55:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:55:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:55:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 12:55:02 - snowflake.connector.connection - INFO - closed
2025-01-18 12:55:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:55:31 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 12:55:31 - root - INFO - ```sql
SELECT
  c."concept_name" AS Condition,
  (COUNT(DISTINCT co."person_id") * 100.0) / (SELECT COUNT(DISTINCT "person_id") FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON") AS Percentage
FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE" co
JOIN "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT" c
  ON co."condition_concept_id" = c."concept_id"
WHERE c."concept_name" ILIKE '%acne%'
   OR c."concept_name" ILIKE '%dermatitis%'
   OR c."concept_name" ILIKE '%psoriasis%'
   OR c."concept_name" ILIKE '%vitiligo%'
GROUP BY c."concept_name";
```
2025-01-18 12:55:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:55:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:55:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:55:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 29
2025-01-18 12:55:34 - snowflake.connector.connection - INFO - closed
2025-01-18 12:55:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:55:34 - root - INFO - SQL:
SELECT
  c."concept_name" AS Condition,
  (COUNT(DISTINCT co."person_id") * 100.0) / (SELECT COUNT(DISTINCT "person_id") FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON") AS Percentage
FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE" co
JOIN "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT" c
  ON co."condition_concept_id" = c."concept_id"
WHERE c."concept_name" ILIKE '%acne%'
   OR c."concept_name" ILIKE '%dermatitis%'
   OR c."concept_name" ILIKE '%psoriasis%'
   OR c."concept_name" ILIKE '%vitiligo%'
GROUP BY c."concept_name";
Results:
CONDITION,PERCENTAGE
Chronic phototoxic dermatitis,3.689442
Contact dermatitis due to detergent,0.372864
Seborrheic dermatitis of scalp,0.241485
Seborrheic dermatitis,3.509500
Infantile seborrheic dermatitis,0.186991
Dermatitis factitia,0.300405
Contact or allergic eyelid dermatitis,0.300276
Psoriasis,0.259105
Dermatitis herpetiformis,0.243848
Acne varioliformis,1.159934
Atopic dermatitis,2.374921
Radiation dermatitis,0.297139
Dermatitis due to drug AND/OR medicine taken internally,0.829359
"Contact dermatitis due to plants, except food",0.851578
Contact dermatitis due to cosmetics,0.275522
Herpes zoster dermatitis of eyelids,0.320862
Contact dermatitis due to solar radiation,1.926419
Contact dermatitis due to food in contact with skin,0.285278
Herpes simplex eyelid dermatitis,0.106496
Psoriasis with arthropathy,1.298275
Parapsoriasis,0.253905
Vitiligo,1.348515
Contact dermatitis,0.940024
Photodermatitis due to sun,0.958031
Atopic dermatitis due to animal dander,0.256097
Acrodermatitis continua,4.542481
Ingestion dermatitis due to food,0.459418
Eczematous dermatitis of eyelid,0.193437
Dermatitis due to substances taken internally,0.530200

2025-01-18 12:55:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:55:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:55:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:55:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-18 12:55:35 - snowflake.connector.connection - INFO - closed
2025-01-18 12:55:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:55:36 - root - INFO - SQL:
SELECT COUNT(DISTINCT "person_id")
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON";
Results:
"COUNT(DISTINCT ""PERSON_ID"")"
2326856

2025-01-18 12:55:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:55:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:55:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:55:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 9
2025-01-18 12:55:37 - snowflake.connector.connection - INFO - closed
2025-01-18 12:55:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:55:38 - root - INFO - SQL:
SELECT DISTINCT "concept_code", "concept_name"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
   WHERE "concept_code" LIKE 'L20%' AND "vocabulary_id" = 'ICD10CM';
Results:
concept_code,concept_name
L20,Atopic dermatitis
L20.81,Atopic neurodermatitis
L20.89,Other atopic dermatitis
L20.83,Infantile (acute) (chronic) eczema
L20.9,"Atopic dermatitis, unspecified"
L20.84,Intrinsic (allergic) eczema
L20.0,Besnier's prurigo
L20.82,Flexural eczema
L20.8,Other atopic dermatitis

2025-01-18 12:55:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:55:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:55:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:55:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 8251
2025-01-18 12:55:39 - snowflake.connector.connection - INFO - closed
2025-01-18 12:55:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:55:40 - root - INFO - SQL:
SELECT DISTINCT "condition_concept_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE";
Results:
Too long, hard cut:
condition_concept_id
437514
432282
435237
434340
378419
4105631
442766
257007
77317
76725
192958
198195
4266046
442747
137944
442256
192422
73866
435127
444393
27438
441760
4150614
312543
441215
439723
436920
193721
133438
201531
439248
438126
436372
440084
374634
443446
40480435
441011
433757
444068
380397
433491
437878
261904
78232
253328
74763
435402
140609
444362
442116
4095167
433730
441260
433524
200164
441928
134718
438536
435138
444239
439656
134879
432299
433992
436953
374641
434927
443538
437851
376119
432919
434047
373488
40481763
31339
199870
437943
137945
75622
77072
321661
136205
138545
73872
438570
441697
438576
442330
443799
140259
134510
434821
4333977
438983
436671
442147
135777
193277
433706
193897
75692
440016
81380
441002
435855
440755
75865
4064178
40483107
201366
4117722
439910
201675
133351
440921
4279309
437177
434557
433738
374021
436283
4323686
444218
4094863
441731
432975
199178
439880
80467
73282
199891
4042220
76750
81923
439430
193830
30978
4100382
437840
440993
436675
372880
380428
320416
317893
432937
436996
193519
195599
139899
141370
136185
438865
142033
440895
432586
4022071
4165091
139759
434881
134305
134596
438398
374326
438727
438393
374905
436684
40481345
443616
438738
437847
435814
437542
43530687
133510
40481327
435299
4197477
78227
75898
442792
80512
31967
440256
443371
79758
200974
439201
81902
73068
4206460
4138466
198402
133436
194325
440387
4150795
4331953
376104
436108
381557
375267
381027
374363
136710
437881
435571
438796
444102
194395
194983
192364
199875
77348
40479260
76783
440195
197672
378264
442598
4015764
81713
442280
436841
137735
142032
442920
73537
75210
194001
138713
436090
441431
432375
438412
376400
252911
437594
199855
4340954
434766
78267
438277
199959
81723
4181481
198978
75488
197042
28248
444198
438894
193142
438491
81178
194523
432682
440010
442795
196182
436767
192979
434715
440777
4064175
437445
435021
437834
436091
380394
318772
26711
198803
194412
195321
200877
137733
373648
437194
40481547
434568
135194
439285
195761
434300
140976
4029270
141831
437242
380986
435218
435243
439795
374032
434637
379009
432623
441560
375265
435284
376698
374040
381576
372654
40481335
442075
197035
192676
4064172
433844
73574
198861
197988
78273
80229
25965
372547
380650
40490993
4008988
442367
4098475
432810
436785
4168873
4184252
132841
437505
4278365
138099
136367
439000
434910
436079
434348
436972
374036
374351
374648
375278
381585
321052
73231
441063
4062686
137626
4063686
43531054
74448
4181251
440243
444281
73366
4184875
40479565
443739
375490
372569
432582
140364
140018
4148231
432695
435902
433052
443878
435472
200153
378048
444036
374647
381865
139046
77335
77956
77650
443944
437990
436247
194516
438946
4016358
45767018
435470
442152
433588
442581
4060675
196476
318247
312846
192978
4055472
196172
196490
320456
437756
443435
432520
24909
4101602
376383
434903
4201930
381551
78149
378436
319041
22350
441628
437359
138864
4319150
436586
4163058
443217
441776
4309542
193739
432300
439253
43021158
435534
434019
432878
373461
372903
437276
379821
376408
377283
381031
375275
439058
435880
75617
78516
196813
441976
433330
72460
74768
139210
444076
434247
435418
434554
195212
4094854
201824
434883
40490826
439483
314659
134661
194152
379185
316631
201807
140664
439770
373188
373771
433776
374946
381296
378763
378157
441311
439051
4060672
44782447
4188191
80801
76499
44783376
441940
80497
77665
438546
435912
23865
197654
78574
433047
74777
441977
441152
4021807
4238737
192591
444228
438344
433702
436045
81247
141825
443952
132420
4071063
317713
438478
200151
442219
441261
373775
4068379
253009
437120
442186
438039
433704
198101
196654
437251
192819
433149
132862
23164
441775
313980
440550
443978
442005
319049
442151
442021
72390
315013
201356
442059
439095
200789
196764
434241
194702
440933
438391
436093
4302954
440691
376961
443607
378135
376395
376415
4147638
321586
40481919
436430
321882
259043
139057
201901
81623
133547
137967
261116
198246
437763
382034
81454
4014454
316356
376085
432865
441834
436958
372605
432621
376107
374028
374933
374934
381569
381024
442634
40480603
257907
4318718
22665
76191
81939
77362
314463
438552
78560
141411
439166
381440
444058
196925
196325
433981
434605
200451
40480627
196734
443174
4268980
4193869
200319
140352
432589
440080
441543
374342
374922
4314161
376691
441298
376420
258780
30442
76467
437629
72714
4116936
78834
80187
199913
141955
441963
437374
4206591
440863
441153
441434
193354
197714
195401
136309
442012
40480077
437461
254591
432244
77517
315505
133726
140357
4091173
192376
435395
434112
442616
436944
436370
439815
372906
372650
380733
193793
4273095
40482685
80802
133003
72469
442538
436843
75413
440358
195498
254561
261679
195328
432750
4095755
433950
435173
439129
201503
196484
40318618
4064579
196488
441629
442575
25518
434008
378144
139841
74396
196468
136184
139902
4065355
77630
132416
434467
436539
77421
198030
433647
435371
4015718
4080568
4261933
196895
439674
192824
200662
432271
377252
434917


2025-01-18 12:55:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:55:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:55:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:55:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 41
2025-01-18 12:55:41 - snowflake.connector.connection - INFO - closed
2025-01-18 12:55:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:55:42 - root - INFO - SQL:
SELECT DISTINCT "vocabulary_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT";
Results:
vocabulary_id
ICD10CM
HCPCS
UCUM
Observation Type
Relationship
Concept Class
VA Class
Drug Type
Note Type
Specialty
ABMS
Revenue Code
RxNorm
Currency
Meas Type
Condition Type
Ethnicity
Device Type
RxNorm Extension
Gender
NUCC
LOINC
Domain
SNOMED
SPL
Visit
Procedure Type
ATC
Race
Visit Type
ICD9CM
Vocabulary
Death Type
Obs Period Type
NDFRT
CPT4
NDC
Place of Service
Cost Type
None
ICD9Proc

2025-01-18 12:55:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:55:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:55:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:55:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 12:55:43 - snowflake.connector.connection - INFO - closed
2025-01-18 12:55:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:57:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 12:57:14 - root - INFO - ```sql
SELECT
  t.Condition,
  (COUNT(DISTINCT co."person_id") * 100.0) / (SELECT COUNT(DISTINCT "person_id") FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON") AS Percentage
FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE" co
JOIN (
  SELECT "concept_id", 'Acne (L70)' AS Condition
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
  WHERE "concept_code" LIKE 'L70%' AND "vocabulary_id" = 'ICD10CM'

  UNION ALL

  SELECT "concept_id", 'Atopic dermatitis (L20)' AS Condition
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
  WHERE "concept_code" LIKE 'L20%' AND "vocabulary_id" = 'ICD10CM'

  UNION ALL

  SELECT "concept_id", 'Psoriasis (L40)' AS Condition
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
  WHERE "concept_code" LIKE 'L40%' AND "vocabulary_id" = 'ICD10CM'

  UNION ALL

  SELECT "concept_id", 'Vitiligo (L80)' AS Condition
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
  WHERE "concept_code" LIKE 'L80%' AND "vocabulary_id" = 'ICD10CM'
) t ON co."condition_concept_id" = t."concept_id"
GROUP BY t.Condition;
```
2025-01-18 12:57:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:57:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:57:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:57:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 12:57:15 - snowflake.connector.connection - INFO - closed
2025-01-18 12:57:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:58:51 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 12:58:51 - root - INFO - ```sql
SELECT
  c."concept_name" AS Condition,
  (COUNT(DISTINCT co."person_id") * 100.0) / (SELECT COUNT(DISTINCT "person_id") FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON") AS Percentage
FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE" co
JOIN "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT" c
  ON co."condition_concept_id" = c."concept_id"
WHERE c."concept_name" ILIKE '%acne%'
   OR c."concept_name" ILIKE '%dermatitis%'
   OR c."concept_name" ILIKE '%psoriasis%'
   OR c."concept_name" ILIKE '%vitiligo%'
GROUP BY c."concept_name";
```
2025-01-18 12:58:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:58:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:58:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:58:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 29
2025-01-18 12:58:52 - snowflake.connector.connection - INFO - closed
2025-01-18 12:58:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:58:53 - root - INFO - SQL:
SELECT
  c."concept_name" AS Condition,
  (COUNT(DISTINCT co."person_id") * 100.0) / (SELECT COUNT(DISTINCT "person_id") FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON") AS Percentage
FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE" co
JOIN "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT" c
  ON co."condition_concept_id" = c."concept_id"
WHERE c."concept_name" ILIKE '%acne%'
   OR c."concept_name" ILIKE '%dermatitis%'
   OR c."concept_name" ILIKE '%psoriasis%'
   OR c."concept_name" ILIKE '%vitiligo%'
GROUP BY c."concept_name";
Results:
CONDITION,PERCENTAGE
Chronic phototoxic dermatitis,3.689442
Contact dermatitis due to detergent,0.372864
Seborrheic dermatitis of scalp,0.241485
Seborrheic dermatitis,3.509500
Infantile seborrheic dermatitis,0.186991
Dermatitis factitia,0.300405
Contact or allergic eyelid dermatitis,0.300276
Psoriasis,0.259105
Dermatitis herpetiformis,0.243848
Acne varioliformis,1.159934
Atopic dermatitis,2.374921
Radiation dermatitis,0.297139
Dermatitis due to drug AND/OR medicine taken internally,0.829359
"Contact dermatitis due to plants, except food",0.851578
Contact dermatitis due to cosmetics,0.275522
Herpes zoster dermatitis of eyelids,0.320862
Contact dermatitis due to solar radiation,1.926419
Contact dermatitis due to food in contact with skin,0.285278
Herpes simplex eyelid dermatitis,0.106496
Psoriasis with arthropathy,1.298275
Parapsoriasis,0.253905
Vitiligo,1.348515
Contact dermatitis,0.940024
Photodermatitis due to sun,0.958031
Atopic dermatitis due to animal dander,0.256097
Acrodermatitis continua,4.542481
Ingestion dermatitis due to food,0.459418
Eczematous dermatitis of eyelid,0.193437
Dermatitis due to substances taken internally,0.530200

2025-01-18 12:58:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:58:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:58:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:58:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-18 12:58:54 - snowflake.connector.connection - INFO - closed
2025-01-18 12:58:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:58:55 - root - INFO - SQL:
SELECT DISTINCT "concept_id", "concept_code"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
   WHERE "concept_code" LIKE 'L80%' AND "vocabulary_id" = 'ICD10CM';
Results:
concept_id,concept_code
35208655,L80

2025-01-18 12:58:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:58:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:58:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:58:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 12:58:56 - snowflake.connector.connection - INFO - closed
2025-01-18 12:58:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:58:56 - root - INFO - SQL:
SELECT DISTINCT "condition_source_value"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE"
   LIMIT 1000;
Results:
Too long, hard cut:
condition_source_value
1832
1962
2409
2362
2830
3569
3970
4111
4588
4910
5238
5680
6820
7571
13100
30441
30503
37313
1748
5997
27402
1918
5173
9594
29593
6205
29645
38014
6248
28481
7323
7682
9569
9689
9858
9881
V448
V487
05471
05600
20248
01506
20117
01701
34401
36511
677
6174
6943
20520
20901
20966
24281
24910
27785
27786
31223
32732
34501
01664
36131
36270
36404
36472
09811
3580
4170
01351
0088
1103
1533
1551
2572
2750
2900
3368
4358
5778
5780
4918
5713
7596
8260
9604
9986
E915
04111
07071
30723
33520
34700
36234
38612
9630
30002
1489
9878
00861
38619
3335
5834
1948
2540
22800
7587
7084
7335
7353
7395
9500
9792
04611
09482
09834
20005
20014
20034
20113
20235
37900
10081
35579
09851
09959
20602
20681
23331
23876
25950
29656
30010
30289
34652
32735
01626
01890
01652
4800
5262
5227
36314
36331
36362
36403
7616
4932
2758
4118
3235
01322
1716
0400
0417
1960
1972
2638
3480
3589
3694
4148
5715
20300
8360
25041
29592
31400
04102
5966
19881
24980
35801
8676
07953
29636
7130
8474
9587
9682
V342
V414
V486
V493
01641
05314
07279
20125
05900
37189
20114
29626
31321
33944
36024
01354
5217
6068
6121
6284
6395
5216
36334
36340
36371
36454
36455
01080
3544
1844
2740
2875
3659
3968
4380
4536
5951
6010
6272
6961
V270
05329
25003
29990
30742
30924
36816
37993
01190
27650
1950
9340
23770
36616
3099
6983
7173
7390
20270
7465
8629
8679
9158
9478
9564
9598
9892
V692
00809
05920
20038
20260
20128
3431
30422
09955
13102
8069
20482
20682
20701
20915
29583
33912
33989
34671
01141
01155
5228
5243
6178
6187
6394
36181
36215
7293
3066
3151
7618
2963
1840
2893
3310
3449
3689
5560
6164
7224
8820
V641
00845
04185
28864
29532
31401
34510
1725
2828
30483
6179
36510
7175
7216
7233
7365
7459
7506
7570
9283
9300
9579
9850
V495
01192
05829
05901
9490
13109
20401
29584
40210
2281
20285
32371
38914
5205
5355
6198
6225
6240
6280
3100
01750
01774
20231
7190
09836
27701
30653
32730
33911
34560
34701
36031
01562
2530
36272
36305
2326
37141
01181
2972
3579
1706
1125
1580
2841
2858
4568
4659
5990
6825
7213
25052
30440
34580
25001
30000
37430
25201
2459
6279
9584
9680
E989
29042
2468
30272
7500
9687
V483
V698
00849
04520
05442
20224
20061
05310
20912
24201
24211
25021
27787
29681
30110
30652
31532
32720
35923
36019
36061
7039
20272
20274
4761
4958
6080
01763
04672
3434
36335
36350
36352
2140
01794
2661
2880
2908
3007
3759
01751
2374
1540
2113
2114
2331
2869
3361
5401
5920
7458
V446
7015
V642
25090
3575
30571
0839
2528
6266
03844
05313
20590
7311
7424
7567
8760
9700
9839
9949
01756
05921
07021
11505
20033
20207
20194
1951
3380
30413
34603
2137
2781
28739
4340
4710
5233
6083
6213
28269
33529
37810
34670
20101
01386
09483
20173
27906
38900
20964
24930
27410
29502
29544
30533
32700
36052
29655
36310
36405
2831
3212
3461
36720
1849
1885
2558
2727
2910
2967
3071
3314
4474
5568
5853
5756
5856
04109
7220
07032
31231
38910
40301
40390
25070
4560
30470
34461
5931
6954
22804
29660
1759
36812
7201
7589
8322
9562
9898
V096
V489
V629
03285
09485
09830
20140
09951
20172
9620
30443
30789
2537
33812
4331
5274
6206
6222
6298
25030
30530
30580
9719
01604
6398
20581
20956
33382
34633
34681
36107
29551
36243
36322
36424
36460
1612
3358
3440
1966
2148
2825
4371
5716
4589
5439
9100
7262
25542
27542
29650
30189
30981
34982
29041
30461
9916
34591
1338
2112
2698
2725
8439
29580
36967
37852
7202
7370
7461
8058
8068
V403
01162
03284
05811
20007
20012
20072
20075
20107
9561
V274
04513
20157
4295
4771
5820
5832
5888
6108
30751
37630
36204
9460
20492
25802
27905
27909
29646
36030
20267
01183
01586
34939
36130
2712
2973
3278
0463
36489
2776
3384
4553
4619
4779
5770
5851
5855
5949
6930
V453
03842
25002
25042
29623
34290
3490
3629
4350
5259
9190
33920
37515
38604
7232
7337
7519
7605
9048
9552
9874
V410
V665
00581
01623
09381
09832
20155
20203
9897
05101
4644
5207
5263
6001
6925
3080
1307
36811
9405
01315
01590
38922
20622
29901
30122
33941
34651
36104
01205
36223
36226
36320
2332
2711
2730
3124
3231
2650
37931
1460
1510
2111
2381
2452
2521
2564
3093
3360
4372
4556
8500
28731
35800
35781
6259
27669
36207
8798
9238
9766
9796
V026
03283
05412
05474
20042
20060
20081
20156
4375
4957
5308
5930
6104
6148
6169
09814
4954
20914
22803
30753
32729
34632
34641
8451
36281
01642
8210
36372
1613
3023
3448
6332
37532
539
0382
1611
2662
3558
4417
5772
3453
3688
5969
6253
9471
V090
05443
28522
28983
28989
29644
33821
4200
8064
36231
37854
1881
1569
4847
36441
V694
30271
7438
7684
8797
9178
9586
01104
03281
07272
08882
11512
20045
6270
01140
09956
09389
29514
20943
20973
25513
31322
30740
31235
32721
32753
34672
36004
30284
2190
20295
01703
5208
5643
0490
8631
36236
36289
36457
36481
3708
4250
3200
7683
0549
0542
2881
3370
4408
5932
6170
6945
7514
E887
V143
24291
25022
29570
29632
30401
38801
0415
0979
3240
4830
7320
8247
8770
20810
20020
27540
7575
2808
9745
0661
8796
20240
29682
6944
9040
9660
9809
9877
V655
01574
01656
07053
03642
09322
11503
20153
20238
20256
20028
7150
01325
09953
20162
4320
25093
35971
01015
29535
20591
27501
30252
30746
31210
32709
32737
34631
34643
5270
6022
6147
36312
36464
272

2025-01-18 12:58:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:58:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:58:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:58:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-18 12:58:58 - snowflake.connector.connection - INFO - closed
2025-01-18 12:58:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:58:58 - root - INFO - SQL:
SELECT DISTINCT "gender_concept_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON";
Results:
gender_concept_id
8532
8507

2025-01-18 12:58:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:58:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:58:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:59:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 4
2025-01-18 12:59:00 - snowflake.connector.connection - INFO - closed
2025-01-18 12:59:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:59:00 - root - INFO - SQL:
SELECT "concept_id", "concept_name", "vocabulary_id"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
    WHERE "concept_code" IN ('L70', 'L20', 'L40', 'L80');
Results:
concept_id,concept_name,vocabulary_id
1569765,Atopic dermatitis,ICD10CM
1569777,Psoriasis,ICD10CM
1569798,Acne,ICD10CM
35208655,Vitiligo,ICD10CM

2025-01-18 12:59:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:59:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:59:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:59:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10177
2025-01-18 12:59:03 - snowflake.connector.connection - INFO - closed
2025-01-18 12:59:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:59:03 - root - INFO - SQL:
SELECT DISTINCT "condition_source_value"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE"
    WHERE "condition_source_value" IS NOT NULL;
Results:
Too long, hard cut:
condition_source_value
4358
4800
4918
5262
5713
5778
5780
7084
7335
7353
7395
7587
7596
8260
9500
9792
9878
9986
E915
00861
01280
04111
07071
09834
09851
20005
20014
20113
20681
22800
23331
25950
36314
36331
36362
36403
37144
37211
37233
38612
38619
52470
53321
61800
64190
69515
70583
70720
71106
71598
71854
72769
75027
80150
80371
80700
82534
88120
2750
01224
0957
94855
5834
9604
9630
01773
01890
09482
09959
20034
20235
20602
23876
29656
30002
30010
33520
34700
35579
36234
36922
36976
37900
38642
38652
40413
53271
56031
62135
70402
71596
71846
71880
72191
72991
73036
75161
76400
78900
80133
80426
80510
82000
83315
85156
86504
94224
95208
99568
V4450
0088
2900
3368
65981
E8548
0623
0720
0790
1278
1489
1551
1716
1948
2556
3235
3335
4118
85102
86409
94250
E9056
01343
65983
86390
65661
65130
30289
30723
32735
34652
37059
37940
38640
43311
52453
52462
52463
56409
59081
72231
78071
80049
80195
94323
1103
1533
2572
2540
2758
5227
04611
63451
80074
80096
80312
80636
90142
94215
65903
67642
75531
66541
10081
95206
60000
72401
01172
01652
0913
E9325
E9339
64214
65673
80631
64253
65993
63481
67444
E9311
67910
01626
63402
65563
94453
E8629
01322
01620
66524
7616
E8631
E9491
65464
65381
E8640
E8658
67604
4932
E8641
E8367
76404
E9980
4380
4536
5243
5951
6010
6178
6187
6272
6961
6983
7173
7390
8629
9158
9340
9564
9598
9892
V270
V692
00809
05920
13102
20038
20128
20260
20270
20482
20701
20915
23770
25003
29583
30742
30924
33912
36616
36816
37521
38521
45989
52101
52133
69559
71143
71179
72664
74783
80237
84500
94309
2740
2875
3431
3151
67330
7465
8679
9478
01190
01602
05329
27650
29990
30422
33989
34671
36181
36215
37635
37803
37963
37993
38052
38201
38424
38648
45184
48240
52113
52114
52403
53121
53501
56030
71125
71533
71839
72471
73079
73722
75619
78821
79391
80445
80630
81109
83920
85203
94873
99640
99673
E8780
3099
3659
3968
E8585
1218
1950
2963
5228
64290
65923
71175
74312
80419
80423
67301
1339
80499
20682
38501
38653
41410
53360
64900
72661
80123
80443
80449
80476
81113
83101
83979
85306
99674
99851
118
0261
0910
1329
1405
2082
09955
94122
94242
3066
7618
8069
E8554
94555
64653
1844
65490
94316
67121
E8698
E9555
01560
E9423
66994
64942
67692
76490
66233
63440
77985
01144
E9397
01211
66934
6394
7293
76498
E8680
76516
6078
79951
7274
01155
E9960
01141
V909
V351
6470
E9792
65371
5715
5966
6068
6121
6284
7130
8360
8676
9587
9682
V414
V486
V493
01354
01406
05900
19881
07953
20114
20125
20300
24980
25041
29626
29636
31321
33944
36334
36340
36454
36651
37189
41050
41404
41512
52452
53471
57481
57490
69461
71113
71128
71535
71667
71939
78905
85406
92820
99521
E9465
0400
0417
2089
2136
2156
2351
94332
8474
04102
05314
07279
29592
31400
35801
36024
36371
36455
37482
38089
38654
38656
53311
53430
57411
59960
59971
64633
71165
71214
71226
71666
71888
72979
73081
73733
75833
78552
79413
80084
80224
80386
80430
80513
80660
81011
81317
81510
83512
83905
85255
90253
99883
1972
3694
2232
2500
3480
3544
3589
5216
01882
75435
80140
80179
94239
01286
65221
85120
94147
37110
37823
51900
55202
69271
72766
74356
78039
78491
80451
81513
82030
90256
94503
99679
V4966
2638
4148
E9357
0360
1268
2380
5217
66943
80070
94406
01404
92311
1960
94200
85249
64614
64862
E8449
66140
E8699
67004
6395
67803
E9521
63732
65402
V342
01641
64500
64924
V3501
01080
77183
64523
67811
01346
01334
66050
E8622
2901
66300
79953
65391
4330
4351
4404
5128
5248
5287
5379
5730
5763
5769
6803
6960
7149
8830
9057
9553
9693
9720
V027
V872
01303
05311
05449
05812
11592
20284
24970
25043
25061
27901
28730
30283
30302
31220
33511
34403
34551
34673
36227
36422
36531
37006
37483
37716
37721
43490
53350
67380
71159
72670
74341
74483
78834
80605
81418
85236
87363
94356
94421
1570
1000
6020
7082
7248
20036
20104
20111
20152
20903
24241
28809
29663
30285
34691
34831
36308
38050
38106
42499
45621
45919
48281
61882
62132
64204
65963
68100
70711
71950
72669
73316
74742
75314
78093
78943
80346
80492
81103
81259
82524
86131
87369
87410
87412
99684
E8786
E9314
E9361
2864
2989
3439
E9317
E9457
0219
0220
0540
0980
3301
3442
01310
94414
52102
86384
36401
45183
71110
71618
73039
80405
80441
80515
83109
87341
4150
0770
0786
1026
1100
1469
1528
2393
2458
2872
52404
75656
71142
0914
75433
85144
71805
2569
E9440
01650
01746
66823
86399
94150
65440
86383
66381
63702
67694
E9951
66090
65591
63762
E9318
E8707
77431
01312
66340
01552
01676
5130
5250
5277
5563
5959
6009
6160
6189
7059
7105
7327
7463
9565
9854
V292
01610
07798
10089
20190
20592
20917
30462
30521
31289
32710
33389
34590
34663
35922
36610
36631
37158
37250
37420
37543
37802
37843
45383
52141
52401
64890
71601
71621
73031
74251
74609
75489
80717
82332
88102
E8798
E9426
3488
3158
3817
94204
7170
05881
34581
36081
36330
36470
36502
36522
37275
37311
37412
37731
38420
49321
51181
53782
55321
56960
59659
60824
71608
71629
71662
71969
72704
73074
73329
75264
78639
81003
83810
86391
99569
E9323
E9871
V0990
V6289
587
0703
1270
1491
1610
1719
2150
2389
2511
3068
7484
52426
52542
64643
67382
73084
80031
90227
90082
64510
76061
36032
40501
414

2025-01-18 12:59:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:59:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:59:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:59:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 75
2025-01-18 12:59:05 - snowflake.connector.connection - INFO - closed
2025-01-18 12:59:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:59:05 - root - INFO - SQL:
SELECT DISTINCT "year_of_birth"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON";
Results:
year_of_birth
1912
1913
1917
1958
1966
1909
1916
1965
1969
1910
1967
1979
1928
1934
1936
1938
1954
1942
1946
1956
1957
1982
1919
1951
1952
1925
1964
1968
1970
1976
1972
1973
1915
1975
1911
1977
1921
1932
1935
1941
1960
1943
1945
1949
1953
1961
1920
1914
1974
1978
1983
1918
1971
1981
1980
1922
1923
1926
1927
1929
1930
1931
1933
1937
1939
1947
1950
1955
1962
1963
1924
1940
1944
1948
1959

2025-01-18 12:59:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:59:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:59:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:59:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 12:59:07 - snowflake.connector.connection - INFO - closed
2025-01-18 12:59:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:59:52 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 12:59:52 - root - INFO - ```sql
SELECT
  c."concept_name" AS Condition,
  (COUNT(DISTINCT co."person_id") * 100.0) / (SELECT COUNT(DISTINCT p."person_id") FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON" p) AS Percentage
FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE" co
JOIN "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT" c
  ON co."condition_concept_id" = c."concept_id"
WHERE c."concept_name" ILIKE '%acne%'
   OR c."concept_name" ILIKE '%dermatitis%'
   OR c."concept_name" ILIKE '%psoriasis%'
   OR c."concept_name" ILIKE '%vitiligo%'
GROUP BY c."concept_name";
```
2025-01-18 12:59:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:59:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:59:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:59:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 29
2025-01-18 12:59:54 - snowflake.connector.connection - INFO - closed
2025-01-18 12:59:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:59:55 - root - INFO - SQL:
SELECT
  c."concept_name" AS Condition,
  (COUNT(DISTINCT co."person_id") * 100.0) / (SELECT COUNT(DISTINCT p."person_id") FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON" p) AS Percentage
FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE" co
JOIN "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT" c
  ON co."condition_concept_id" = c."concept_id"
WHERE c."concept_name" ILIKE '%acne%'
   OR c."concept_name" ILIKE '%dermatitis%'
   OR c."concept_name" ILIKE '%psoriasis%'
   OR c."concept_name" ILIKE '%vitiligo%'
GROUP BY c."concept_name";
Results:
CONDITION,PERCENTAGE
Contact dermatitis due to detergent,0.372864
Chronic phototoxic dermatitis,3.689442
Seborrheic dermatitis of scalp,0.241485
Seborrheic dermatitis,3.509500
Infantile seborrheic dermatitis,0.186991
Dermatitis factitia,0.300405
Contact or allergic eyelid dermatitis,0.300276
Psoriasis,0.259105
Dermatitis herpetiformis,0.243848
Acne varioliformis,1.159934
Atopic dermatitis,2.374921
Radiation dermatitis,0.297139
Dermatitis due to drug AND/OR medicine taken internally,0.829359
"Contact dermatitis due to plants, except food",0.851578
Contact dermatitis due to cosmetics,0.275522
Herpes zoster dermatitis of eyelids,0.320862
Contact dermatitis due to solar radiation,1.926419
Contact dermatitis due to food in contact with skin,0.285278
Herpes simplex eyelid dermatitis,0.106496
Psoriasis with arthropathy,1.298275
Parapsoriasis,0.253905
Contact dermatitis,0.940024
Vitiligo,1.348515
Photodermatitis due to sun,0.958031
Atopic dermatitis due to animal dander,0.256097
Acrodermatitis continua,4.542481
Ingestion dermatitis due to food,0.459418
Dermatitis due to substances taken internally,0.530200
Eczematous dermatitis of eyelid,0.193437

2025-01-18 12:59:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:59:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:59:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:59:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 946
2025-01-18 12:59:56 - snowflake.connector.connection - INFO - closed
2025-01-18 12:59:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:59:57 - root - INFO - SQL:
SELECT DISTINCT "concept_name"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
    WHERE "concept_code" LIKE 'L%' AND "vocabulary_id" = 'ICD10CM';
Results:
Too long, hard cut:
concept_name
Chromhidrosis
"Alopecia areata, unspecified"
Drug-induced pemphigus
Bromhidrosis
Acne tropica
Other rosacea
Postprocedural seroma of skin and subcutaneous tissue following a dermatologic procedure
Periorbital cellulitis
"Arthropathic psoriasis, unspecified"
Cellulitis of right toe
"Pressure ulcer of unspecified buttock, unstageable"
"Pressure ulcer of left ankle, stage 1"
Cutaneous abscess of umbilicus
Atrophic disorders of skin
Lupus erythematosus
Vibratory urticaria
Allergic contact dermatitis due to food in contact with the skin
"Acute lymphadenitis, unspecified"
Lichen simplex chronicus
Subacute (active) lichen planus
Ophiasis
Pityriasis alba
"Pressure ulcer of right hip, unstageable"
Non-pressure chronic ulcer of other part of unspecified lower leg limited to breakdown of skin
"Pressure ulcer of unspecified part of back, stage 4"
"Pressure ulcer of right elbow, stage 3"
"Furuncle of head [any part, except face]"
Non-pressure chronic ulcer of unspecified part of unspecified lower leg with unspecified severity
"Pressure ulcer of other site, unstageable"
Non-pressure chronic ulcer of skin of other sites with unspecified severity
Disseminated superficial actinic porokeratosis (DSAP)
Cutis rhomboidalis nuchae
Hypertrophic scar
"Acute skin change due to ultraviolet radiation, unspecified"
"Granulomatous disorder of the skin and subcutaneous tissue, unspecified"
Exfoliation due to erythematous condition involving 70-79 percent of body surface
Anagen effluvium
Other specified papulosquamous disorders
Postprocedural hematoma of skin and subcutaneous tissue following other procedure
Non-pressure chronic ulcer of unspecified part of unspecified lower leg
Cutaneous abscess of left lower limb
Non-pressure chronic ulcer of right calf with necrosis of bone
Postprocedural hematoma of skin and subcutaneous tissue following a dermatologic procedure
Non-pressure chronic ulcer of unspecified ankle with necrosis of bone
"Pressure ulcer of left upper back, stage 1"
"Pressure ulcer of unspecified heel, unspecified stage"
Pemphigus foliaceous
Infantile acne
Transient acantholytic dermatosis [Grover]
Actinic granuloma
Irritant contact dermatitis due to detergents
"Pressure ulcer of left lower back, stage 1"
Non-pressure chronic ulcer of right thigh with necrosis of bone
"Primary focal hyperhidrosis, axilla"
"Pressure ulcer of left upper back, stage 2"
Cellulitis of right axilla
Non-pressure chronic ulcer of back with unspecified severity
Lichen planus
Other specified dermatitis
Erythema annulare centrifugum
Paraneoplastic pemphigus
Pemphigus erythematosus
"Cutaneous abscess, furuncle and carbuncle of neck"
Other postprocedural complications of skin and subcutaneous tissue
Non-pressure chronic ulcer of left ankle
"Pressure ulcer of unspecified site, stage 1"
Cellulitis of perineum
Non-pressure chronic ulcer of unspecified heel and midfoot limited to breakdown of skin
"Cutaneous abscess of limb, unspecified"
Lymphomatoid papulosis
Androgenic alopecia
Psoriasis vulgaris
Non-pressure chronic ulcer of left calf
"Pemphigoid, unspecified"
Pressure ulcer of unspecified heel
Non-pressure chronic ulcer of other part of right foot with necrosis of bone
"Pressure ulcer of right hip, stage 4"
Cellulitis of right finger
"Pressure ulcer of left ankle, stage 3"
Non-pressure chronic ulcer of buttock with fat layer exposed
Non-pressure chronic ulcer of left thigh with necrosis of bone
Non-pressure chronic ulcer of unspecified part of left lower leg with unspecified severity
Intraoperative and postprocedural complications of skin and subcutaneous tissue
Acrodermatitis continua
"Pemphigus, unspecified"
Pressure ulcer of hip
Cellulitis and acute lymphangitis of trunk
Other psoriatic arthropathy
Furuncle of limb
Non-pressure chronic ulcer of left thigh with unspecified severity
"Pressure ulcer of right ankle, unstageable"
"Pressure ulcer of right elbow, unstageable"
Pruritus
Exfoliation due to erythematous condition involving 40-49 percent of body surface
Other follicular cysts of the skin and subcutaneous tissue
Pilonidal cyst and sinus without abscess
Acquired hypertrichosis lanuginosa
"Cutaneous abscess, furuncle and carbuncle, unspecified"
Irritant contact dermatitis due to metals
Furuncle of right axilla
Non-pressure chronic ulcer of unspecified part of left lower leg limited to breakdown of skin
Non-pressure chronic ulcer of unspecified calf with fat layer exposed
"Pressure ulcer of left hip, stage 1"
Furuncle of abdominal wall
Cellulitis of right upper limb
Folliculitis ulerythematosa reticulata
Keratosis punctata (palmaris et plantaris)
Linear scleroderma
Anetoderma of Jadassohn-Pellizzari
Other transepidermal elimination disorders
Non-pressure chronic ulcer of other part of lower leg
Non-pressure chronic ulcer of other part of unspecified lower leg
"Pressure ulcer of right heel, stage 1"
"Pressure ulcer of unspecified hip, stage 3"
"Pressure ulcer of right upper back, stage 3"
Acute lymphangitis of back [any part except buttoc

2025-01-18 12:59:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:59:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:59:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:59:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-18 12:59:58 - snowflake.connector.connection - INFO - closed
2025-01-18 12:59:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:01:20 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 13:01:20 - root - INFO - ```sql
SELECT
  CASE
    WHEN "condition_source_value" LIKE '706%' THEN 'Acne (ICD-9 706.x)'
    WHEN "condition_source_value" LIKE '691%' THEN 'Atopic dermatitis (ICD-9 691.x)'
    WHEN "condition_source_value" LIKE '6961%' THEN 'Psoriasis (ICD-9 696.1)'
    WHEN "condition_source_value" = '70901' THEN 'Vitiligo (ICD-9 709.01)'
    ELSE NULL
  END AS Condition,
  (COUNT(DISTINCT "person_id") * 100.0) / (SELECT COUNT(DISTINCT "person_id") FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON") AS Percentage
FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE"
WHERE
  "condition_source_value" LIKE '706%'
  OR "condition_source_value" LIKE '691%'
  OR "condition_source_value" LIKE '6961%'
  OR "condition_source_value" = '70901'
GROUP BY Condition
HAVING Condition IS NOT NULL;
```

This query calculates the percentage of participants diagnosed with Acne, Atopic dermatitis, Psoriasis, or Vitiligo by matching the corresponding ICD-9 codes (since `condition_source_value` contains ICD-9 codes). It includes subcategories by using the `%` wildcard. The `HAVING` clause ensures that only the specified conditions are included in the results.
2025-01-18 13:01:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 13:01:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 13:01:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 13:01:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 4
2025-01-18 13:01:22 - snowflake.connector.connection - INFO - closed
2025-01-18 13:01:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:01:23 - root - INFO - SQL:
SELECT
  CASE
    WHEN "condition_source_value" LIKE '706%' THEN 'Acne (ICD-9 706.x)'
    WHEN "condition_source_value" LIKE '691%' THEN 'Atopic dermatitis (ICD-9 691.x)'
    WHEN "condition_source_value" LIKE '6961%' THEN 'Psoriasis (ICD-9 696.1)'
    WHEN "condition_source_value" = '70901' THEN 'Vitiligo (ICD-9 709.01)'
    ELSE NULL
  END AS Condition,
  (COUNT(DISTINCT "person_id") * 100.0) / (SELECT COUNT(DISTINCT "person_id") FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON") AS Percentage
FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE"
WHERE
  "condition_source_value" LIKE '706%'
  OR "condition_source_value" LIKE '691%'
  OR "condition_source_value" LIKE '6961%'
  OR "condition_source_value" = '70901'
GROUP BY Condition
HAVING Condition IS NOT NULL;
Results:
CONDITION,PERCENTAGE
Atopic dermatitis (ICD-9 691.x),2.648123
Vitiligo (ICD-9 709.01),1.348515
Acne (ICD-9 706.x),6.794447
Psoriasis (ICD-9 696.1),4.542481

2025-01-18 13:01:23 - root - INFO - itercount: 0
2025-01-18 13:01:23 - root - INFO - Database Name: CMS_DATA
Schema Name: CMS_CODES
DDL describes table information.
,0
table_name,HCPCS
description,
DDL,"create or replace TABLE HCPCS (
	HCPC VARCHAR(16777216),
	SEQNUM VARCHAR(16777216),
	RECID NUMBER(38,0),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216),
	PRICE1 VARCHAR(16777216),
	PRICE2 VARCHAR(16777216),
	PRICE3 VARCHAR(16777216),
	PRICE4 VARCHAR(16777216),
	MULT_PI VARCHAR(16777216),
	CIM1 VARCHAR(16777216),
	CIM2 VARCHAR(16777216),
	CIM3 VARCHAR(16777216),
	MCM1 FLOAT,
	MCM2 NUMBER(38,0),
	MCM3 VARCHAR(16777216),
	STATUTE VARCHAR(16777216),
	LABCERT1 VARCHAR(16777216),
	LABCERT2 VARCHAR(16777216),
	LABCERT3 VARCHAR(16777216),
	LABCERT4 VARCHAR(16777216),
	LABCERT5 VARCHAR(16777216),
	LABCERT6 VARCHAR(16777216),
	LABCERT7 VARCHAR(16777216),
	LABCERT8 VARCHAR(16777216),
	XREF1 VARCHAR(16777216),
	XREF2 VARCHAR(16777216),
	XREF3 VARCHAR(16777216),
	XREF4 VARCHAR(16777216),
	XREF5 VARCHAR(16777216),
	COV VARCHAR(16777216),
	ASC_GRP VARCHAR(16777216),
	ASC_DT VARCHAR(16777216),
	OPPS VARCHAR(16777216),
	OPPS_PI VARCHAR(16777216),
	OPPS_DT VARCHAR(16777216),
	PROCNOTE VARCHAR(16777216),
	BETOS VARCHAR(16777216),
	TOS1 VARCHAR(16777216),
	TOS2 VARCHAR(16777216),
	TOS3 VARCHAR(16777216),
	TOS4 VARCHAR(16777216),
	TOS5 VARCHAR(16777216),
	ANEST_BU VARCHAR(16777216),
	ADD_DT VARCHAR(16777216),
	ACT_EFF_DT VARCHAR(16777216),
	TERM_DT VARCHAR(16777216),
	ACTION_CD BOOLEAN
);"

,1
table_name,ICD10_PROCEDURES_2019
description,
DDL,"create or replace TABLE ICD10_PROCEDURES_2019 (
	""order_number"" VARCHAR(16777216),
	""pcs_code"" VARCHAR(16777216),
	""is_header_code"" BOOLEAN,
	""short_description"" VARCHAR(16777216),
	""long_description"" VARCHAR(16777216)
);"

,2
table_name,ICD9_DIAGNOSES
description,
DDL,"create or replace TABLE ICD9_DIAGNOSES (
	DIAGNOSIS_CODE VARCHAR(16777216),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216)
);"

,3
table_name,ICD10_DIAGNOSES_2019
description,
DDL,"create or replace TABLE ICD10_DIAGNOSES_2019 (
	""order_number"" VARCHAR(16777216),
	""cm_code"" VARCHAR(16777216),
	""is_header_code"" BOOLEAN,
	""short_description"" VARCHAR(16777216),
	""long_description"" VARCHAR(16777216)
);"

,4
table_name,ICD9_PROCEDURES
description,
DDL,"create or replace TABLE ICD9_PROCEDURES (
	PROCEDURE_CODE VARCHAR(16777216),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_MEDICARE
DDL describes table information.
,0
table_name,HOME_HEALTH_AGENCIES_2013
description,
DDL,"create or replace TABLE HOME_HEALTH_AGENCIES_2013 (
	""provider_id"" VARCHAR(16777216),
	""agency_name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""total_episodes_non_lupa"" NUMBER(38,0),
	""distinct_users_non_lupa"" NUMBER(38,0),
	""total_hha_charge_amount_non_lupa"" NUMBER(38,0),
	""total_hha_medicare_payment_amount_non_lupa"" NUMBER(38,0),
	""total_hha_medicare_standard_payment_amount_non_lupa"" NUMBER(38,0),
	""outlier_payments_as_a_percent_of_medicare_payment_amount_non_lupa"" NUMBER(38,0),
	""total_lupa_episodes"" NUMBER(38,0),
	""total_hha_medicare_payment_amount_for_lupas"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014']
,1
table_name,HOSPICE_PROVIDERS_2014
description,
DDL,"create or replace TABLE HOSPICE_PROVIDERS_2014 (
	""provider_id"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""hrr"" VARCHAR(16777216),
	""hospice_beneficiaries"" NUMBER(38,0),
	""total_days"" NUMBER(38,0),
	""total_medicare_payment_amount"" NUMBER(38,0),
	""total_medicare_standard_payment_amount"" NUMBER(38,0),
	""total_charge_amount"" NUMBER(38,0),
	""percent_routine_home_care_days"" NUMBER(38,0),
	""physician_services"" NUMBER(38,0),
	""home_health_visit_hours_per_day"" FLOAT,
	""skilled_nursing_visit_hours_per_day"" FLOAT,
	""social_service_visit_hours_per_day"" FLOAT,
	""total_live_discharges"" NUMBER(38,0),
	""hospice_beneficiaries_with_seven_or_fewer_hospice_care_days"" NUMBER(38,0),
	""hospice_beneficiaries_with_more_than_sixty_hospice_care_days"" NUMBER(38,0),
	""hospice_beneficiaries_with_more_than_one_hundred_eighty_hospice_care_days"" NUMBER(38,0),
	""home_health_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""skilled_nursing_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""social_service_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""average_age"" FLOAT,
	""male_hospice_beneficiaries"" NUMBER(38,0),
	""female_hospice_beneficiaries"" NUMBER(38,0),
	""white_hospice_beneficiaries"" NUMBER(38,0),
	""black_hospice_beneficiaries"" NUMBER(38,0),
	""asian_hospice_beneficiaries"" NUMBER(38,0),
	""hispanic_hospice_beneficiaries"" NUMBER(38,0),
	""other_unknown_race_hospice_beneficiaries"" NUMBER(38,0),
	""medicare_advantage_hospice_beneficiaries"" NUMBER(38,0),
	""medicaid_eligible_hospice_beneficiaries"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_cancer"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_dementia"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_stroke"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_circulatory_heart_disease"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_respiratory_disease"" NUMBER(38,0),
	""hospice_beneficiaries_with_other_primary_diagnoses"" NUMBER(38,0),
	""site_of_service_home_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_assisted_living_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_long_term_care_or_non_skilled_nursing_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_skilled_nursing_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_inpatient_hospital_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_inpatient_hospice_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_other_facility_hospice_beneficiaries"" NUMBER(38,0)
);"

,2
table_name,HOSPITAL_GENERAL_INFO
description,
DDL,"create or replace TABLE HOSPITAL_GENERAL_INFO (
	""provider_id"" VARCHAR(16777216),
	""hospital_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""phone_number"" VARCHAR(16777216),
	""hospital_type"" VARCHAR(16777216),
	""hospital_ownership"" VARCHAR(16777216),
	""emergency_services"" BOOLEAN,
	""meets_criteria_for_promoting_interoperability_of_ehrs"" BOOLEAN,
	""hospital_overall_rating"" VARCHAR(16777216),
	""hospital_overall_rating_footnote"" VARCHAR(16777216),
	""mortality_group_measure_count"" VARCHAR(16777216),
	""facility_mortaility_measures_count"" VARCHAR(16777216),
	""mortality_measures_better_count"" VARCHAR(16777216),
	""mortality_measures_no_different_count"" VARCHAR(16777216),
	""mortality_measures_worse_count"" VARCHAR(16777216),
	""mortaility_group_footnote"" VARCHAR(16777216),
	""safety_measures_count"" VARCHAR(16777216),
	""facility_care_safety_measures_count"" VARCHAR(16777216),
	""safety_measures_better_count"" VARCHAR(16777216),
	""safety_measures_no_different_count"" VARCHAR(16777216),
	""safety_measures_worse_count"" VARCHAR(16777216),
	""safety_group_footnote"" VARCHAR(16777216),
	""readmission_measures_count"" VARCHAR(16777216),
	""facility_readmission_measures_count"" VARCHAR(16777216),
	""readmission_measures_better_count"" VARCHAR(16777216),
	""readmission_measures_no_different_count"" VARCHAR(16777216),
	""readmission_measures_worse_count"" VARCHAR(16777216),
	""readmission_measures_footnote"" VARCHAR(16777216),
	""patient_experience_measures_count"" VARCHAR(16777216),
	""facility_patient_experience_measures_count"" VARCHAR(16777216),
	""patient_experience_measures_footnote"" VARCHAR(16777216),
	""timely_and_effective_care_measures_count"" VARCHAR(16777216),
	""facility_timely_and_effective_care_measures_count"" VARCHAR(16777216),
	""timely_and_effective_care_measures_footnote"" VARCHAR(16777216)
);"

,3
table_name,INPATIENT_CHARGES_2011
description,
DDL,"create or replace TABLE INPATIENT_CHARGES_2011 (
	""provider_id"" VARCHAR(16777216),
	""provider_name"" VARCHAR(16777216),
	""provider_street_address"" VARCHAR(16777216),
	""provider_city"" VARCHAR(16777216),
	""provider_state"" VARCHAR(16777216),
	""provider_zipcode"" VARCHAR(16777216),
	""drg_definition"" VARCHAR(16777216),
	""hospital_referral_region_description"" VARCHAR(16777216),
	""total_discharges"" NUMBER(38,0),
	""average_covered_charges"" FLOAT,
	""average_total_payments"" FLOAT,
	""average_medicare_payments"" FLOAT
);"

Some other tables have the similar structure: ['INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2015']
,4
table_name,NURSING_FACILITIES_2014
description,
DDL,"create or replace TABLE NURSING_FACILITIES_2014 (
	""provider_id"" VARCHAR(16777216),
	""facility_name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""total_stays"" NUMBER(38,0),
	""distinct_beneficiaries_per_provider"" NUMBER(38,0),
	""average_length_of_stays_days"" FLOAT,
	""total_snf_charge_amount"" NUMBER(38,0),
	""total_snf_medicare_allowed_amount"" NUMBER(38,0),
	""total_snf_medicare_payment_amount"" NUMBER(38,0),
	""total_snf_medicare_standard_payment_amount"" NUMBER(38,0),
	""average_age"" NUMBER(38,0),
	""male_beneficiaries"" NUMBER(38,0),
	""female_beneficiaries"" NUMBER(38,0),
	""nondual_beneficiaries"" NUMBER(38,0),
	""dual_beneficiaries"" NUMBER(38,0),
	""white_beneficiaries"" NUMBER(38,0),
	""black_beneficiaries"" NUMBER(38,0),
	""asian_pacific_islander_beneficiaries"" NUMBER(38,0),
	""hispanic_beneficiaries"" NUMBER(38,0),
	""american_indian_or_alaska_native_beneficiaries"" NUMBER(38,0),
	""other_unknown_beneficiaries"" NUMBER(38,0),
	""average_hcc_score"" FLOAT,
	""percent_of_beneficiaries_with_atrial_fibrillation"" NUMBER(38,0),
	""percent_of_beneficiaries_with_alzheimers"" NUMBER(38,0),
	""percent_of_beneficiaries_with_asthma"" NUMBER(38,0),
	""percent_of_beneficiaries_with_cancer"" NUMBER(38,0),
	""percent_of_beneficiaries_with_chf"" NUMBER(38,0),
	""percent_of_beneficiaries_with_chronic_kidney_disease"" NUMBER(38,0),
	""percent_of_beneficiaries_with_copd"" NUMBER(38,0),
	""percent_of_beneficiaries_with_depression"" NUMBER(38,0),
	""percent_of_beneficiaries_with_diabetes"" NUMBER(38,0),
	""percent_of_beneficiaries_with_hyperlipidemia"" NUMBER(38,0),
	""percent_of_beneficiaries_with_hypertension"" NUMBER(38,0),
	""percent_of_beneficiaries_with_ihd"" NUMBER(38,0),
	""percent_of_beneficiaries_with_osteoporosis"" NUMBER(38,0),
	""percent_of_beneficiaries_with_ra_oa"" NUMBER(38,0),
	""percent_of_beneficiaries_with_schizophrenia"" NUMBER(38,0),
	""percent_of_beneficiaries_with_stroke"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['NURSING_FACILITIES_2014', 'NURSING_FACILITIES_2013']
,5
table_name,OUTPATIENT_CHARGES_2012
description,
DDL,"create or replace TABLE OUTPATIENT_CHARGES_2012 (
	""provider_id"" VARCHAR(16777216),
	""provider_name"" VARCHAR(16777216),
	""provider_street_address"" VARCHAR(16777216),
	""provider_city"" VARCHAR(16777216),
	""provider_state"" VARCHAR(16777216),
	""provider_zipcode"" VARCHAR(16777216),
	""apc"" VARCHAR(16777216),
	""hospital_referral_region"" VARCHAR(16777216),
	""outpatient_services"" NUMBER(38,0),
	""average_estimated_submitted_charges"" FLOAT,
	""average_total_payments"" FLOAT
);"

Some other tables have the similar structure: ['OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2015']
,6
table_name,PART_D_PRESCRIBER_2014
description,
DDL,"create or replace TABLE PART_D_PRESCRIBER_2014 (
	""npi"" VARCHAR(16777216),
	""nppes_provider_last_org_name"" VARCHAR(16777216),
	""nppes_provider_first_name"" VARCHAR(16777216),
	""nppes_provider_city"" VARCHAR(16777216),
	""nppes_provider_state"" VARCHAR(16777216),
	""specialty_description"" VARCHAR(16777216),
	""description_flag"" VARCHAR(16777216),
	""drug_name"" VARCHAR(16777216),
	""generic_name"" VARCHAR(16777216),
	""bene_count"" NUMBER(38,0),
	""total_claim_count"" NUMBER(38,0),
	""total_day_supply"" NUMBER(38,0),
	""total_drug_cost"" FLOAT,
	""bene_count_ge65"" NUMBER(38,0),
	""bene_count_ge65_suppress_flag"" VARCHAR(16777216),
	""total_claim_count_ge65"" NUMBER(38,0),
	""ge65_suppress_flag"" VARCHAR(16777216),
	""total_day_supply_ge65"" NUMBER(38,0),
	""total_drug_cost_ge65"" FLOAT,
	""total_30_day_fill_count"" FLOAT,
	""total_30_day_fill_count_ge65"" FLOAT
);"

,7
table_name,REFERRING_DURABLE_MEDICAL_EQUIP_2013
description,
DDL,"create or replace TABLE REFERRING_DURABLE_MEDICAL_EQUIP_2013 (
	""referring_npi"" VARCHAR(16777216),
	""referring_provider_last_name_organization_name"" VARCHAR(16777216),
	""referring_provider_first_name"" VARCHAR(16777216),
	""referring_provider_middle_initial"" VARCHAR(16777216),
	""referring_provider_credentials"" VARCHAR(16777216),
	""referring_provider_gender"" VARCHAR(16777216),
	""referring_provider_entity_code"" VARCHAR(16777216),
	""referring_provider_street_1"" VARCHAR(16777216),
	""referring_provider_street_2"" VARCHAR(16777216),
	""referring_provider_city"" VARCHAR(16777216),
	""referring_provider_state"" VARCHAR(16777216),
	""referring_provider_zip"" VARCHAR(16777216),
	""referring_provider_country"" VARCHAR(16777216),
	""referring_provider_type"" VARCHAR(16777216),
	""referring_provider_type_flag"" VARCHAR(16777216),
	""number_of_suppliers"" NUMBER(38,0),
	""number_of_supplier_hcpcs"" NUMBER(38,0),
	""number_of_supplier_beneficiaries"" NUMBER(38,0),
	""number_of_supplier_claims"" NUMBER(38,0),
	""number_of_supplier_services"" NUMBER(38,0),
	""supplier_submitted_charges"" FLOAT,
	""supplier_medicare_allowed_amount"" FLOAT,
	""supplier_medicare_payment_amount"" FLOAT,
	""durable_medical_equipment_suppression_indicator"" VARCHAR(16777216),
	""number_of_durable_medical_equipment_suppliers"" NUMBER(38,0),
	""number_of_durable_medical_equipment_hcpcs"" NUMBER(38,0),
	""number_of_durable_medical_equipment_beneficiaries"" NUMBER(38,0),
	""number_of_durable_medical_equipment_claims"" NUMBER(38,0),
	""number_of_durable_medical_equipment_services"" NUMBER(38,0),
	""durable_medical_equipment_submitted_charges"" FLOAT,
	""durable_medical_equipment_medicare_allowed_amount"" FLOAT,
	""durable_medical_equipment_medicare_payment_amount"" FLOAT,
	""prosthetic_and_orthotic_suppression_indicator"" VARCHAR(16777216),
	""number_of_prosthetic_and_orthotic_suppliers"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_hcpcs"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_beneficiaries"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_claims"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_services"" NUMBER(38,0),
	""prosthetic_and_orthotic_submitted_charges"" FLOAT,
	""prosthetic_and_orthotic_medicare_allowed_amount"" FLOAT,
	""prosthetic_and_orthotic_medicare_payment_amount"" FLOAT,
	""drug_and_nutritional_suppression_indicator"" VARCHAR(16777216),
	""number_of_drug_and_nutritional_products_suppliers"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_hcpcs"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_beneficiaries"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_claims"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_services"" NUMBER(38,0),
	""drug_and_nutritional_products_submitted_charges"" FLOAT,
	""drug_and_nutritional_products_medicare_allowed_amount"" FLOAT,
	""drug_and_nutritional_products_medicare_payment_amount"" FLOAT
);"

Some other tables have the similar structure: ['REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014']
,8
table_name,PHYSICIANS_AND_OTHER_SUPPLIER_2015
description,
DDL,"create or replace TABLE PHYSICIANS_AND_OTHER_SUPPLIER_2015 (
	""npi"" VARCHAR(16777216),
	""nppes_provider_last_org_name"" VARCHAR(16777216),
	""nppes_provider_first_name"" VARCHAR(16777216),
	""nppes_provider_mi"" VARCHAR(16777216),
	""nppes_credentials"" VARCHAR(16777216),
	""nppes_provider_gender"" VARCHAR(16777216),
	""nppes_entity_code"" VARCHAR(16777216),
	""nppes_provider_street1"" VARCHAR(16777216),
	""nppes_provider_street2"" VARCHAR(16777216),
	""nppes_provider_city"" VARCHAR(16777216),
	""nppes_provider_zip"" VARCHAR(16777216),
	""nppes_provider_state"" VARCHAR(16777216),
	""nppes_provider_country"" VARCHAR(16777216),
	""provider_type"" VARCHAR(16777216),
	""medicare_participation_indicator"" VARCHAR(16777216),
	""place_of_service"" VARCHAR(16777216),
	""hcpcs_code"" VARCHAR(16777216),
	""hcpcs_description"" VARCHAR(16777216),
	""hcpcs_drug_indicator"" VARCHAR(16777216),
	""line_srvc_cnt"" FLOAT,
	""bene_unique_cnt"" NUMBER(38,0),
	""bene_day_srvc_cnt"" NUMBER(38,0),
	""average_medicare_allowed_amt"" FLOAT,
	""average_submitted_chrg_amt"" FLOAT,
	""average_medicare_payment_amt"" FLOAT,
	""average_medicare_standard_amt"" FLOAT
);"

Some other tables have the similar structure: ['PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014']
Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
DDL describes table information.
,0
table_name,CONDITION_OCCURRENCE
description,
DDL,"create or replace TABLE CONDITION_OCCURRENCE (
	""condition_occurrence_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""condition_concept_id"" NUMBER(38,0),
	""condition_start_date"" DATE,
	""condition_start_datetime"" NUMBER(38,0),
	""condition_end_date"" DATE,
	""condition_end_datetime"" NUMBER(38,0),
	""condition_type_concept_id"" NUMBER(38,0),
	""stop_reason"" VARCHAR(16777216),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""condition_source_value"" VARCHAR(16777216),
	""condition_source_concept_id"" NUMBER(38,0),
	""condition_status_source_value"" VARCHAR(16777216),
	""condition_status_concept_id"" NUMBER(38,0)
);"

,1
table_name,DRUG_ERA
description,
DDL,"create or replace TABLE DRUG_ERA (
	""drug_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""drug_era_start_date"" DATE,
	""drug_era_end_date"" DATE,
	""drug_exposure_count"" NUMBER(38,0),
	""gap_days"" NUMBER(38,0)
);"

,2
table_name,LOCATION
description,
DDL,"create or replace TABLE LOCATION (
	""location_id"" NUMBER(38,0),
	""address_1"" VARCHAR(16777216),
	""address_2"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""location_source_value"" VARCHAR(16777216)
);"

,3
table_name,PERSON
description,
DDL,"create or replace TABLE PERSON (
	""race_concept_id"" NUMBER(38,0),
	""ethnicity_concept_id"" NUMBER(38,0),
	""location_id"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""care_site_id"" NUMBER(38,0),
	""person_source_value"" VARCHAR(16777216),
	""gender_source_value"" VARCHAR(16777216),
	""gender_source_concept_id"" NUMBER(38,0),
	""race_source_value"" VARCHAR(16777216),
	""race_source_concept_id"" NUMBER(38,0),
	""ethnicity_source_value"" VARCHAR(16777216),
	""ethnicity_source_concept_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""gender_concept_id"" NUMBER(38,0),
	""year_of_birth"" NUMBER(38,0),
	""month_of_birth"" NUMBER(38,0),
	""day_of_birth"" NUMBER(38,0),
	""birth_datetime"" NUMBER(38,0)
);"

,4
table_name,CONDITION_ERA
description,
DDL,"create or replace TABLE CONDITION_ERA (
	""condition_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""condition_concept_id"" NUMBER(38,0),
	""condition_era_start_date"" DATE,
	""condition_era_end_date"" DATE,
	""condition_occurrence_count"" NUMBER(38,0)
);"

,5
table_name,DEVICE_EXPOSURE
description,
DDL,"create or replace TABLE DEVICE_EXPOSURE (
	""device_exposure_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""device_concept_id"" NUMBER(38,0),
	""device_exposure_start_date"" DATE,
	""device_exposure_start_datetime"" NUMBER(38,0),
	""device_exposure_end_date"" DATE,
	""device_exposure_end_datetime"" NUMBER(38,0),
	""device_type_concept_id"" NUMBER(38,0),
	""unique_device_id"" VARCHAR(16777216),
	""quantity"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""device_source_value"" VARCHAR(16777216),
	""device_source_concept_id"" NUMBER(38,0)
);"

,6
table_name,DOMAIN
description,
DDL,"create or replace TABLE DOMAIN (
	""domain_id"" VARCHAR(16777216),
	""domain_name"" VARCHAR(16777216),
	""domain_concept_id"" NUMBER(38,0)
);"

,7
table_name,DOSE_ERA
description,
DDL,"create or replace TABLE DOSE_ERA (
	""dose_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""unit_concept_id"" NUMBER(38,0),
	""dose_value"" FLOAT,
	""dose_era_start_date"" DATE,
	""dose_era_end_date"" DATE
);"

,8
table_name,OBSERVATION
description,
DDL,"create or replace TABLE OBSERVATION (
	""observation_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""observation_concept_id"" NUMBER(38,0),
	""observation_date"" DATE,
	""observation_datetime"" NUMBER(38,0),
	""observation_type_concept_id"" NUMBER(38,0),
	""value_as_number"" FLOAT,
	""value_as_string"" VARCHAR(16777216),
	""value_as_concept_id"" NUMBER(38,0),
	""qualifier_concept_id"" NUMBER(38,0),
	""unit_concept_id"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""observation_source_value"" VARCHAR(16777216),
	""observation_source_concept_id"" NUMBER(38,0),
	""unit_source_value"" VARCHAR(16777216),
	""qualifier_source_value"" VARCHAR(16777216)
);"

,9
table_name,COST
description,
DDL,"create or replace TABLE COST (
	""cost_id"" NUMBER(38,0),
	""cost_event_id"" NUMBER(38,0),
	""cost_domain_id"" VARCHAR(16777216),
	""cost_type_concept_id"" NUMBER(38,0),
	""currency_concept_id"" NUMBER(38,0),
	""total_charge"" FLOAT,
	""total_cost"" FLOAT,
	""total_paid"" FLOAT,
	""paid_by_payer"" FLOAT,
	""paid_by_patient"" FLOAT,
	""paid_patient_copay"" FLOAT,
	""paid_patient_coinsurance"" FLOAT,
	""paid_patient_deductible"" FLOAT,
	""paid_by_primary"" FLOAT,
	""paid_ingredient_cost"" FLOAT,
	""paid_dispensing_fee"" FLOAT,
	""payer_plan_period_id"" NUMBER(38,0),
	""amount_allowed"" FLOAT,
	""revenue_code_concept_id"" NUMBER(38,0),
	""revenue_code_source_value"" VARCHAR(16777216),
	""drg_concept_id"" NUMBER(38,0),
	""drg_source_value"" VARCHAR(16777216)
);"

,10
table_name,PROVIDER
description,
DDL,"create or replace TABLE PROVIDER (
	""provider_id"" NUMBER(38,0),
	""provider_name"" VARCHAR(16777216),
	""npi"" VARCHAR(16777216),
	""dea"" VARCHAR(16777216),
	""specialty_concept_id"" NUMBER(38,0),
	""care_site_id"" NUMBER(38,0),
	""year_of_birth"" NUMBER(38,0),
	""gender_concept_id"" NUMBER(38,0),
	""provider_source_value"" VARCHAR(16777216),
	""specialty_source_value"" VARCHAR(16777216),
	""specialty_source_concept_id"" NUMBER(38,0),
	""gender_source_value"" VARCHAR(16777216),
	""gender_source_concept_id"" NUMBER(38,0)
);"

,11
table_name,CARE_SITE
description,
DDL,"create or replace TABLE CARE_SITE (
	""care_site_id"" NUMBER(38,0),
	""care_site_name"" VARCHAR(16777216),
	""place_of_service_concept_id"" NUMBER(38,0),
	""location_id"" NUMBER(38,0),
	""care_site_source_value"" VARCHAR(16777216),
	""place_of_service_source_value"" VARCHAR(16777216)
);"

,12
table_name,CONCEPT_ANCESTOR
description,
DDL,"create or replace TABLE CONCEPT_ANCESTOR (
	""ancestor_concept_id"" NUMBER(38,0),
	""descendant_concept_id"" NUMBER(38,0),
	""min_levels_of_separation"" NUMBER(38,0),
	""max_levels_of_separation"" NUMBER(38,0)
);"

,13
table_name,CONCEPT_RELATIONSHIP
description,
DDL,"create or replace TABLE CONCEPT_RELATIONSHIP (
	""concept_id_1"" NUMBER(38,0),
	""concept_id_2"" NUMBER(38,0),
	""relationship_id"" VARCHAR(16777216),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

,14
table_name,DEATH
description,
DDL,"create or replace TABLE DEATH (
	""person_id"" NUMBER(38,0),
	""death_date"" DATE,
	""death_datetime"" NUMBER(38,0),
	""death_type_concept_id"" NUMBER(38,0),
	""cause_concept_id"" NUMBER(38,0),
	""cause_source_value"" VARCHAR(16777216),
	""cause_source_concept_id"" NUMBER(38,0)
);"

,15
table_name,DRUG_STRENGTH
description,
DDL,"create or replace TABLE DRUG_STRENGTH (
	""drug_concept_id"" NUMBER(38,0),
	""ingredient_concept_id"" NUMBER(38,0),
	""amount_value"" FLOAT,
	""amount_unit_concept_id"" NUMBER(38,0),
	""numerator_value"" FLOAT,
	""numerator_unit_concept_id"" NUMBER(38,0),
	""denominator_value"" FLOAT,
	""denominator_unit_concept_id"" NUMBER(38,0),
	""box_size"" NUMBER(38,0),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

,16
table_name,CONCEPT
description,
DDL,"create or replace TABLE CONCEPT (
	""concept_id"" NUMBER(38,0),
	""concept_name"" VARCHAR(16777216),
	""domain_id"" VARCHAR(16777216),
	""vocabulary_id"" VARCHAR(16777216),
	""concept_class_id"" VARCHAR(16777216),
	""standard_concept"" VARCHAR(16777216),
	""concept_code"" VARCHAR(16777216),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

,17
table_name,CONCEPT_CLASS
description,
DDL,"create or replace TABLE CONCEPT_CLASS (
	""concept_class_id"" VARCHAR(16777216),
	""concept_class_name"" VARCHAR(16777216),
	""concept_class_concept_id"" NUMBER(38,0)
);"

,18
table_name,DRUG_EXPOSURE
description,
DDL,"create or replace TABLE DRUG_EXPOSURE (
	""drug_type_concept_id"" NUMBER(38,0),
	""stop_reason"" VARCHAR(16777216),
	""refills"" NUMBER(38,0),
	""quantity"" FLOAT,
	""days_supply"" NUMBER(38,0),
	""sig"" VARCHAR(16777216),
	""route_concept_id"" NUMBER(38,0),
	""lot_number"" VARCHAR(16777216),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""drug_source_value"" VARCHAR(16777216),
	""drug_source_concept_id"" NUMBER(38,0),
	""route_source_value"" VARCHAR(16777216),
	""dose_unit_source_value"" VARCHAR(16777216),
	""drug_exposure_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""drug_exposure_start_date"" DATE,
	""drug_exposure_start_datetime"" NUMBER(38,0),
	""drug_exposure_end_date"" DATE,
	""drug_exposure_end_datetime"" NUMBER(38,0),
	""verbatim_end_date"" DATE
);"

,19
table_name,OBSERVATION_PERIOD
description,
DDL,"create or replace TABLE OBSERVATION_PERIOD (
	""observation_period_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""observation_period_start_date"" DATE,
	""observation_period_end_date"" DATE,
	""period_type_concept_id"" NUMBER(38,0)
);"

,20
table_name,PAYER_PLAN_PERIOD
description,
DDL,"create or replace TABLE PAYER_PLAN_PERIOD (
	""payer_concept_id"" NUMBER(38,0),
	""payer_source_value"" VARCHAR(16777216),
	""payer_source_concept_id"" NUMBER(38,0),
	""plan_concept_id"" NUMBER(38,0),
	""plan_source_value"" VARCHAR(16777216),
	""plan_source_concept_id"" NUMBER(38,0),
	""sponsor_concept_id"" NUMBER(38,0),
	""sponsor_source_value"" VARCHAR(16777216),
	""sponsor_source_concept_id"" NUMBER(38,0),
	""family_source_value"" VARCHAR(16777216),
	""stop_reason_concept_id"" NUMBER(38,0),
	""stop_reason_source_value"" VARCHAR(16777216),
	""stop_reason_source_concept_id"" NUMBER(38,0),
	""payer_plan_period_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""payer_plan_period_start_date"" DATE,
	""payer_plan_period_end_date"" DATE
);"

,21
table_name,RELATIONSHIP
description,
DDL,"create or replace TABLE RELATIONSHIP (
	""relationship_id"" VARCHAR(16777216),
	""relationship_name"" VARCHAR(16777216),
	""is_hierarchical"" VARCHAR(16777216),
	""defines_ancestry"" VARCHAR(16777216),
	""reverse_relationship_id"" VARCHAR(16777216),
	""relationship_concept_id"" NUMBER(38,0)
);"

,22
table_name,VOCABULARY
description,
DDL,"create or replace TABLE VOCABULARY (
	""vocabulary_id"" VARCHAR(16777216),
	""vocabulary_name"" VARCHAR(16777216),
	""vocabulary_reference"" VARCHAR(16777216),
	""vocabulary_version"" VARCHAR(16777216),
	""vocabulary_concept_id"" NUMBER(38,0)
);"

,23
table_name,PROCEDURE_OCCURRENCE
description,
DDL,"create or replace TABLE PROCEDURE_OCCURRENCE (
	""procedure_type_concept_id"" NUMBER(38,0),
	""modifier_concept_id"" NUMBER(38,0),
	""quantity"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""procedure_source_value"" VARCHAR(16777216),
	""procedure_source_concept_id"" NUMBER(38,0),
	""modifier_source_value"" VARCHAR(16777216),
	""procedure_occurrence_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""procedure_concept_id"" NUMBER(38,0),
	""procedure_dat"" DATE,
	""procedure_datetime"" NUMBER(38,0)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'CMS_DATA': {'CMS_CODES': ['HCPCS', 'ICD10_DIAGNOSES_2019', 'ICD10_PROCEDURES_2019', 'ICD9_DIAGNOSES', 'ICD9_PROCEDURES'], 'CMS_MEDICARE': ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014', 'HOSPICE_PROVIDERS_2014', 'HOSPITAL_GENERAL_INFO', 'INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2015', 'NURSING_FACILITIES_2013', 'NURSING_FACILITIES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2015', 'PART_D_PRESCRIBER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014'], 'CMS_SYNTHETIC_PATIENT_DATA_OMOP': ['CARE_SITE', 'CONCEPT', 'CONCEPT_ANCESTOR', 'CONCEPT_CLASS', 'CONCEPT_RELATIONSHIP', 'CONDITION_ERA', 'CONDITION_OCCURRENCE', 'COST', 'DEATH', 'DEVICE_EXPOSURE', 'DOMAIN', 'DOSE_ERA', 'DRUG_ERA', 'DRUG_EXPOSURE', 'DRUG_STRENGTH', 'LOCATION', 'OBSERVATION', 'OBSERVATION_PERIOD', 'PAYER_PLAN_PERIOD', 'PERSON', 'PROCEDURE_OCCURRENCE', 'PROVIDER', 'RELATIONSHIP', 'VOCABULARY']}}
Begin Exploring Related Columns
**Columns and Potential Usage:**

1. **`"condition_source_value"`**: Contains the ICD-10-CM codes for conditions; can be used to identify conditions L70 (Acne), L20 (Atopic dermatitis), L40 (Psoriasis), and L80 (Vitiligo), including their subcategories.

2. **`"person_id"`**: Unique identifier for each participant; used to count the number of participants with specific conditions.

3. **`"condition_occurrence_id"`**: Unique identifier for each condition occurrence; helps in tracking occurrences of conditions.

4. **`"condition_concept_id"`**: Standardized concept ID for conditions; can be joined with the `CONCEPT` table to retrieve detailed information.

5. **`"concept_code"`** (from **`CONCEPT`** table): Contains the standard codes like ICD-10-CM codes; used to map concept IDs to actual codes (e.g., L70, L20).

6. **`"vocabulary_id"`** (from **`CONCEPT`** table): Indicates the coding system used (e.g., 'ICD10CM'); essential for filtering ICD-10-CM codes.

7. **`"concept_name"`** (from **`CONCEPT`** table): Provides the description of the concept; useful for verifying the condition associated with a code.

8. **`"gender_concept_id"`** (from **`PERSON`** table): Represents the gender of participants; may be used for demographic analysis.

9. **`"year_of_birth"`** (from **`PERSON`** table): Indicates the birth year of participants; useful for age-related analysis.

10. **`"condition_start_date"`**: The date when the condition started; can be used to analyze the time frame of condition occurrences.

**Conditions That May Be Used:**

- Filtering **`"condition_source_value"`** in the **`CONDITION_OCCURRENCE`** table using patterns like `'L70%'`, `'L20%'`, `'L40%'`, and `'L80%'` to include all subcategories of the specified conditions.
- Joining **`CONDITION_OCCURRENCE`** with **`CONCEPT`** table on **`"condition_concept_id"`** to get **`"concept_code"`** and **`"concept_name"`**.
- Using **`"vocabulary_id" = 'ICD10CM'`** in the **`CONCEPT`** table to ensure codes are from the ICD-10-CM classification.

---

**Sample SQL Queries:**

1. **Retrieve distinct condition source values for Acne (L70):**
   ```sql
   SELECT DISTINCT "condition_source_value"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE"
   WHERE "condition_source_value" LIKE 'L70%';
   ```

2. **Count total number of participants:**
   ```sql
   SELECT COUNT(DISTINCT "person_id")
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON";
   ```

3. **Get concept codes and names for Atopic dermatitis (L20):**
   ```sql
   SELECT DISTINCT "concept_code", "concept_name"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
   WHERE "concept_code" LIKE 'L20%' AND "vocabulary_id" = 'ICD10CM';
   ```

4. **Retrieve distinct condition concept IDs:**
   ```sql
   SELECT DISTINCT "condition_concept_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE";
   ```

5. **List all vocabulary IDs available:**
   ```sql
   SELECT DISTINCT "vocabulary_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT";
   ```

6. **Find participants with Psoriasis (L40) conditions:**
   ```sql
   SELECT "person_id", "condition_source_value"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE"
   WHERE "condition_source_value" LIKE 'L40%';
   ```

7. **Get concept IDs and codes for Vitiligo (L80):**
   ```sql
   SELECT DISTINCT "concept_id", "concept_code"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
   WHERE "concept_code" LIKE 'L80%' AND "vocabulary_id" = 'ICD10CM';
   ```

8. **Retrieve distinct condition source values (limited to 1000 records):**
   ```sql
   SELECT DISTINCT "condition_source_value"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE"
   LIMIT 1000;
   ```

9. **List distinct genders of participants:**
   ```sql
   SELECT DISTINCT "gender_concept_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON";
   ```

10. **Get concept IDs, names, and vocabulary IDs for specific conditions:**
    ```sql
    SELECT "concept_id", "concept_name", "vocabulary_id"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
    WHERE "concept_code" IN ('L70', 'L20', 'L40', 'L80');
    ```

11. **Retrieve all non-null condition source values:**
    ```sql
    SELECT DISTINCT "condition_source_value"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE"
    WHERE "condition_source_value" IS NOT NULL;
    ```

12. **Find participants' year of birth:**
    ```sql
    SELECT DISTINCT "year_of_birth"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON";
    ```

13. **Retrieve condition start dates for Acne (L70):**
    ```sql
    SELECT "condition_start_date"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE"
    WHERE "condition_source_value" LIKE 'L70%';
    ```

14. **List all concept names for ICD-10-CM codes starting with 'L':**
    ```sql
    SELECT DISTINCT "concept_name"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
    WHERE "concept_code" LIKE 'L%' AND "vocabulary_id" = 'ICD10CM';
    ```

15. **Count occurrences of Vitiligo (L80) conditions:**
    ```sql
    SELECT COUNT(*) AS "occurrence_count"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE"
    WHERE "condition_source_value" LIKE 'L80%';
    ```

These queries help in understanding the structure and content of the relevant tables and columns, which can be used to calculate the percentage of participants with the specified skin conditions.Query:
SELECT
  c."concept_name" AS Condition,
  (COUNT(DISTINCT co."person_id") * 100.0) / (SELECT COUNT(DISTINCT "person_id") FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON") AS Percentage
FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE" co
JOIN "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT" c
  ON co."condition_concept_id" = c."concept_id"
WHERE c."concept_name" ILIKE '%acne%'
   OR c."concept_name" ILIKE '%dermatitis%'
   OR c."concept_name" ILIKE '%psoriasis%'
   OR c."concept_name" ILIKE '%vitiligo%'
GROUP BY c."concept_name";
Answer:
CONDITION,PERCENTAGE
Chronic phototoxic dermatitis,3.689442
Contact dermatitis due to detergent,0.372864
Seborrheic dermatitis of scalp,0.241485
Seborrheic dermatitis,3.509500
Infantile seborrheic dermatitis,0.186991
Dermatitis factitia,0.300405
Contact or allergic eyelid dermatitis,0.300276
Psoriasis,0.259105
Dermatitis herpetiformis,0.243848
Acne varioliformis,1.159934
Atopic dermatitis,2.374921
Radiation dermatitis,0.297139
Dermatitis due to drug AND/OR medicine taken internally,0.829359
"Contact dermatitis due to plants, except food",0.851578
Contact dermatitis due to cosmetics,0.275522
Herpes zoster dermatitis of eyelids,0.320862
Contact dermatitis due to solar radiation,1.926419
Contact dermatitis due to food in contact with skin,0.285278
Herpes simplex eyelid dermatitis,0.106496
Psoriasis with arthropathy,1.298275
Parapsoriasis,0.253905
Vitiligo,1.348515
Contact dermatitis,0.940024
Photodermatitis due to sun,0.958031
Atopic dermatitis due to animal dander,0.256097
Acrodermatitis continua,4.542481
Ingestion dermatitis due to food,0.459418
Eczematous dermatitis of eyelid,0.193437
Dermatitis due to substances taken internally,0.530200
Query:
SELECT COUNT(DISTINCT "person_id")
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON";
Answer:
"COUNT(DISTINCT ""PERSON_ID"")"
2326856
Query:
SELECT DISTINCT "concept_code", "concept_name"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
   WHERE "concept_code" LIKE 'L20%' AND "vocabulary_id" = 'ICD10CM';
Answer:
concept_code,concept_name
L20,Atopic dermatitis
L20.81,Atopic neurodermatitis
L20.89,Other atopic dermatitis
L20.83,Infantile (acute) (chronic) eczema
L20.9,"Atopic dermatitis, unspecified"
L20.84,Intrinsic (allergic) eczema
L20.0,Besnier's prurigo
L20.82,Flexural eczema
L20.8,Other atopic dermatitis
Query:
SELECT DISTINCT "condition_concept_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE";
Answer:
Too long, hard cut:
condition_concept_id
437514
432282
435237
434340
378419
4105631
442766
257007
77317
76725
192958
198195
4266046
442747
137944
442256
192422
73866
435127
444393
27438
441760
4150614
312543
441215
439723
436920
193721
133438
201531
439248
438126
436372
440084
374634
443446
40480435
441011
433757
444068
380397
433491
437878
261904
78232
253328
74763
435402
140609
444362
442116
4095167
433730
441260
433524
200164
441928
134718
438536
435138
444239
439656
134879
432299
433992
436953
374641
434927
443538
437851
376119
432919
434047
373488
40481763
31339
199870
437943
137945
75622
77072
321661
136205
138545
73872
438570
441697
438576
442330
443799
140259
134510
434821
4333977
438983
436671
442147
135777
193277
433706
193897
75692
440016
81380
441002
435855
440755
75865
4064178
40483107
201366
4117722
439910
201675
133351
440921
4279309
437177
434557
433738
374021
436283
4323686
444218
4094863
441731
432975
199178
439880
80467
73282
199891
4042220
76750
81923
439430
193830
30978
4100382
437840
440993
436675
372880
380428
320416
317893
432937
436996
193519
195599
139899
141370
136185
438865
142033
440895
432586
4022071
4165091
139759
434881
134305
134596
438398
374326
438727
438393
374905
436684
40481345
443616
438738
437847
435814
437542
43530687
133510
40481327
435299
4197477
78227
75898
442792
80512
31967
440256
443371
79758
200974
439201
81902
73068
4206460
4138466
198402
133436
194325
440387
4150795
4331953
376104
436108
381557
375267
381027
374363
136710
437881
435571
438796
444102
194395
194983
192364
199875
77348
40479260
76783
440195
197672
378264
442598
4015764
81713
442280
436841
137735
142032
442920
73537
75210
194001
138713
436090
441431
432375
438412
376400
252911
437594
199855
4340954
434766
78267
438277
199959
81723
4181481
198978
75488
197042
28248
444198
438894
193142
438491
81178
194523
432682
440010
442795
196182
436767
192979
434715
440777
4064175
437445
435021
437834
436091
380394
318772
26711
198803
194412
195321
200877
137733
373648
437194
40481547
434568
135194
439285
195761
434300
140976
4029270
141831
437242
380986
435218
435243
439795
374032
434637
379009
432623
441560
375265
435284
376698
374040
381576
372654
40481335
442075
197035
192676
4064172
433844
73574
198861
197988
78273
80229
25965
372547
380650
40490993
4008988
442367
4098475
432810
436785
4168873
4184252
132841
437505
4278365
138099
136367
439000
434910
436079
434348
436972
374036
374351
374648
375278
381585
321052
73231
441063
4062686
137626
4063686
43531054
74448
4181251
440243
444281
73366
4184875
40479565
443739
375490
372569
432582
140364
140018
4148231
432695
435902
433052
443878
435472
200153
378048
444036
374647
381865
139046
77335
77956
77650
443944
437990
436247
194516
438946
4016358
45767018
435470
442152
433588
442581
4060675
196476
318247
312846
192978
4055472
196172
196490
320456
437756
443435
432520
24909
4101602
376383
434903
4201930
381551
78149
378436
319041
22350
441628
437359
138864
4319150
436586
4163058
443217
441776
4309542
193739
432300
439253
43021158
435534
434019
432878
373461
372903
437276
379821
376408
377283
381031
375275
439058
435880
75617
78516
196813
441976
433330
72460
74768
139210
444076
434247
435418
434554
195212
4094854
201824
434883
40490826
439483
314659
134661
194152
379185
316631
201807
140664
439770
373188
373771
433776
374946
381296
378763
378157
441311
439051
4060672
44782447
4188191
80801
76499
44783376
441940
80497
77665
438546
435912
23865
197654
78574
433047
74777
441977
441152
4021807
4238737
192591
444228
438344
433702
436045
81247
141825
443952
132420
4071063
317713
438478
200151
442219
441261
373775
4068379
253009
437120
442186
438039
433704
198101
196654
437251
192819
433149
132862
23164
441775
313980
440550
443978
442005
319049
442151
442021
72390
315013
201356
442059
439095
200789
196764
434241
194702
440933
438391
436093
4302954
440691
376961
443607
378135
376395
376415
4147638
321586
40481919
436430
321882
259043
139057
201901
81623
133547
137967
261116
198246
437763
382034
81454
4014454
316356
376085
432865
441834
436958
372605
432621
376107
374028
374933
374934
381569
381024
442634
40480603
257907
4318718
22665
76191
81939
77362
314463
438552
78560
141411
439166
381440
444058
196925
196325
433981
434605
200451
40480627
196734
443174
4268980
4193869
200319
140352
432589
440080
441543
374342
374922
4314161
376691
441298
376420
258780
30442
76467
437629
72714
4116936
78834
80187
199913
141955
441963
437374
4206591
440863
441153
441434
193354
197714
195401
136309
442012
40480077
437461
254591
432244
77517
315505
133726
140357
4091173
192376
435395
434112
442616
436944
436370
439815
372906
372650
380733
193793
4273095
40482685
80802
133003
72469
442538
436843
75413
440358
195498
254561
261679
195328
432750
4095755
433950
435173
439129
201503
196484
40318618
4064579
196488
441629
442575
25518
434008
378144
139841
74396
196468
136184
139902
4065355
77630
132416
434467
436539
77421
198030
433647
435371
4015718
4080568
4261933
196895
439674
192824
200662
432271
377252
434917

Query:
SELECT DISTINCT "vocabulary_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT";
Answer:
vocabulary_id
ICD10CM
HCPCS
UCUM
Observation Type
Relationship
Concept Class
VA Class
Drug Type
Note Type
Specialty
ABMS
Revenue Code
RxNorm
Currency
Meas Type
Condition Type
Ethnicity
Device Type
RxNorm Extension
Gender
NUCC
LOINC
Domain
SNOMED
SPL
Visit
Procedure Type
ATC
Race
Visit Type
ICD9CM
Vocabulary
Death Type
Obs Period Type
NDFRT
CPT4
NDC
Place of Service
Cost Type
None
ICD9Proc
Query:
SELECT DISTINCT "concept_id", "concept_code"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
   WHERE "concept_code" LIKE 'L80%' AND "vocabulary_id" = 'ICD10CM';
Answer:
concept_id,concept_code
35208655,L80
Query:
SELECT DISTINCT "condition_source_value"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE"
   LIMIT 1000;
Answer:
Too long, hard cut:
condition_source_value
1832
1962
2409
2362
2830
3569
3970
4111
4588
4910
5238
5680
6820
7571
13100
30441
30503
37313
1748
5997
27402
1918
5173
9594
29593
6205
29645
38014
6248
28481
7323
7682
9569
9689
9858
9881
V448
V487
05471
05600
20248
01506
20117
01701
34401
36511
677
6174
6943
20520
20901
20966
24281
24910
27785
27786
31223
32732
34501
01664
36131
36270
36404
36472
09811
3580
4170
01351
0088
1103
1533
1551
2572
2750
2900
3368
4358
5778
5780
4918
5713
7596
8260
9604
9986
E915
04111
07071
30723
33520
34700
36234
38612
9630
30002
1489
9878
00861
38619
3335
5834
1948
2540
22800
7587
7084
7335
7353
7395
9500
9792
04611
09482
09834
20005
20014
20034
20113
20235
37900
10081
35579
09851
09959
20602
20681
23331
23876
25950
29656
30010
30289
34652
32735
01626
01890
01652
4800
5262
5227
36314
36331
36362
36403
7616
4932
2758
4118
3235
01322
1716
0400
0417
1960
1972
2638
3480
3589
3694
4148
5715
20300
8360
25041
29592
31400
04102
5966
19881
24980
35801
8676
07953
29636
7130
8474
9587
9682
V342
V414
V486
V493
01641
05314
07279
20125
05900
37189
20114
29626
31321
33944
36024
01354
5217
6068
6121
6284
6395
5216
36334
36340
36371
36454
36455
01080
3544
1844
2740
2875
3659
3968
4380
4536
5951
6010
6272
6961
V270
05329
25003
29990
30742
30924
36816
37993
01190
27650
1950
9340
23770
36616
3099
6983
7173
7390
20270
7465
8629
8679
9158
9478
9564
9598
9892
V692
00809
05920
20038
20260
20128
3431
30422
09955
13102
8069
20482
20682
20701
20915
29583
33912
33989
34671
01141
01155
5228
5243
6178
6187
6394
36181
36215
7293
3066
3151
7618
2963
1840
2893
3310
3449
3689
5560
6164
7224
8820
V641
00845
04185
28864
29532
31401
34510
1725
2828
30483
6179
36510
7175
7216
7233
7365
7459
7506
7570
9283
9300
9579
9850
V495
01192
05829
05901
9490
13109
20401
29584
40210
2281
20285
32371
38914
5205
5355
6198
6225
6240
6280
3100
01750
01774
20231
7190
09836
27701
30653
32730
33911
34560
34701
36031
01562
2530
36272
36305
2326
37141
01181
2972
3579
1706
1125
1580
2841
2858
4568
4659
5990
6825
7213
25052
30440
34580
25001
30000
37430
25201
2459
6279
9584
9680
E989
29042
2468
30272
7500
9687
V483
V698
00849
04520
05442
20224
20061
05310
20912
24201
24211
25021
27787
29681
30110
30652
31532
32720
35923
36019
36061
7039
20272
20274
4761
4958
6080
01763
04672
3434
36335
36350
36352
2140
01794
2661
2880
2908
3007
3759
01751
2374
1540
2113
2114
2331
2869
3361
5401
5920
7458
V446
7015
V642
25090
3575
30571
0839
2528
6266
03844
05313
20590
7311
7424
7567
8760
9700
9839
9949
01756
05921
07021
11505
20033
20207
20194
1951
3380
30413
34603
2137
2781
28739
4340
4710
5233
6083
6213
28269
33529
37810
34670
20101
01386
09483
20173
27906
38900
20964
24930
27410
29502
29544
30533
32700
36052
29655
36310
36405
2831
3212
3461
36720
1849
1885
2558
2727
2910
2967
3071
3314
4474
5568
5853
5756
5856
04109
7220
07032
31231
38910
40301
40390
25070
4560
30470
34461
5931
6954
22804
29660
1759
36812
7201
7589
8322
9562
9898
V096
V489
V629
03285
09485
09830
20140
09951
20172
9620
30443
30789
2537
33812
4331
5274
6206
6222
6298
25030
30530
30580
9719
01604
6398
20581
20956
33382
34633
34681
36107
29551
36243
36322
36424
36460
1612
3358
3440
1966
2148
2825
4371
5716
4589
5439
9100
7262
25542
27542
29650
30189
30981
34982
29041
30461
9916
34591
1338
2112
2698
2725
8439
29580
36967
37852
7202
7370
7461
8058
8068
V403
01162
03284
05811
20007
20012
20072
20075
20107
9561
V274
04513
20157
4295
4771
5820
5832
5888
6108
30751
37630
36204
9460
20492
25802
27905
27909
29646
36030
20267
01183
01586
34939
36130
2712
2973
3278
0463
36489
2776
3384
4553
4619
4779
5770
5851
5855
5949
6930
V453
03842
25002
25042
29623
34290
3490
3629
4350
5259
9190
33920
37515
38604
7232
7337
7519
7605
9048
9552
9874
V410
V665
00581
01623
09381
09832
20155
20203
9897
05101
4644
5207
5263
6001
6925
3080
1307
36811
9405
01315
01590
38922
20622
29901
30122
33941
34651
36104
01205
36223
36226
36320
2332
2711
2730
3124
3231
2650
37931
1460
1510
2111
2381
2452
2521
2564
3093
3360
4372
4556
8500
28731
35800
35781
6259
27669
36207
8798
9238
9766
9796
V026
03283
05412
05474
20042
20060
20081
20156
4375
4957
5308
5930
6104
6148
6169
09814
4954
20914
22803
30753
32729
34632
34641
8451
36281
01642
8210
36372
1613
3023
3448
6332
37532
539
0382
1611
2662
3558
4417
5772
3453
3688
5969
6253
9471
V090
05443
28522
28983
28989
29644
33821
4200
8064
36231
37854
1881
1569
4847
36441
V694
30271
7438
7684
8797
9178
9586
01104
03281
07272
08882
11512
20045
6270
01140
09956
09389
29514
20943
20973
25513
31322
30740
31235
32721
32753
34672
36004
30284
2190
20295
01703
5208
5643
0490
8631
36236
36289
36457
36481
3708
4250
3200
7683
0549
0542
2881
3370
4408
5932
6170
6945
7514
E887
V143
24291
25022
29570
29632
30401
38801
0415
0979
3240
4830
7320
8247
8770
20810
20020
27540
7575
2808
9745
0661
8796
20240
29682
6944
9040
9660
9809
9877
V655
01574
01656
07053
03642
09322
11503
20153
20238
20256
20028
7150
01325
09953
20162
4320
25093
35971
01015
29535
20591
27501
30252
30746
31210
32709
32737
34631
34643
5270
6022
6147
36312
36464
272
Query:
SELECT DISTINCT "gender_concept_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON";
Answer:
gender_concept_id
8532
8507
Query:
SELECT "concept_id", "concept_name", "vocabulary_id"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
    WHERE "concept_code" IN ('L70', 'L20', 'L40', 'L80');
Answer:
concept_id,concept_name,vocabulary_id
1569765,Atopic dermatitis,ICD10CM
1569777,Psoriasis,ICD10CM
1569798,Acne,ICD10CM
35208655,Vitiligo,ICD10CM
Query:
SELECT DISTINCT "condition_source_value"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE"
    WHERE "condition_source_value" IS NOT NULL;
Answer:
Too long, hard cut:
condition_source_value
4358
4800
4918
5262
5713
5778
5780
7084
7335
7353
7395
7587
7596
8260
9500
9792
9878
9986
E915
00861
01280
04111
07071
09834
09851
20005
20014
20113
20681
22800
23331
25950
36314
36331
36362
36403
37144
37211
37233
38612
38619
52470
53321
61800
64190
69515
70583
70720
71106
71598
71854
72769
75027
80150
80371
80700
82534
88120
2750
01224
0957
94855
5834
9604
9630
01773
01890
09482
09959
20034
20235
20602
23876
29656
30002
30010
33520
34700
35579
36234
36922
36976
37900
38642
38652
40413
53271
56031
62135
70402
71596
71846
71880
72191
72991
73036
75161
76400
78900
80133
80426
80510
82000
83315
85156
86504
94224
95208
99568
V4450
0088
2900
3368
65981
E8548
0623
0720
0790
1278
1489
1551
1716
1948
2556
3235
3335
4118
85102
86409
94250
E9056
01343
65983
86390
65661
65130
30289
30723
32735
34652
37059
37940
38640
43311
52453
52462
52463
56409
59081
72231
78071
80049
80195
94323
1103
1533
2572
2540
2758
5227
04611
63451
80074
80096
80312
80636
90142
94215
65903
67642
75531
66541
10081
95206
60000
72401
01172
01652
0913
E9325
E9339
64214
65673
80631
64253
65993
63481
67444
E9311
67910
01626
63402
65563
94453
E8629
01322
01620
66524
7616
E8631
E9491
65464
65381
E8640
E8658
67604
4932
E8641
E8367
76404
E9980
4380
4536
5243
5951
6010
6178
6187
6272
6961
6983
7173
7390
8629
9158
9340
9564
9598
9892
V270
V692
00809
05920
13102
20038
20128
20260
20270
20482
20701
20915
23770
25003
29583
30742
30924
33912
36616
36816
37521
38521
45989
52101
52133
69559
71143
71179
72664
74783
80237
84500
94309
2740
2875
3431
3151
67330
7465
8679
9478
01190
01602
05329
27650
29990
30422
33989
34671
36181
36215
37635
37803
37963
37993
38052
38201
38424
38648
45184
48240
52113
52114
52403
53121
53501
56030
71125
71533
71839
72471
73079
73722
75619
78821
79391
80445
80630
81109
83920
85203
94873
99640
99673
E8780
3099
3659
3968
E8585
1218
1950
2963
5228
64290
65923
71175
74312
80419
80423
67301
1339
80499
20682
38501
38653
41410
53360
64900
72661
80123
80443
80449
80476
81113
83101
83979
85306
99674
99851
118
0261
0910
1329
1405
2082
09955
94122
94242
3066
7618
8069
E8554
94555
64653
1844
65490
94316
67121
E8698
E9555
01560
E9423
66994
64942
67692
76490
66233
63440
77985
01144
E9397
01211
66934
6394
7293
76498
E8680
76516
6078
79951
7274
01155
E9960
01141
V909
V351
6470
E9792
65371
5715
5966
6068
6121
6284
7130
8360
8676
9587
9682
V414
V486
V493
01354
01406
05900
19881
07953
20114
20125
20300
24980
25041
29626
29636
31321
33944
36334
36340
36454
36651
37189
41050
41404
41512
52452
53471
57481
57490
69461
71113
71128
71535
71667
71939
78905
85406
92820
99521
E9465
0400
0417
2089
2136
2156
2351
94332
8474
04102
05314
07279
29592
31400
35801
36024
36371
36455
37482
38089
38654
38656
53311
53430
57411
59960
59971
64633
71165
71214
71226
71666
71888
72979
73081
73733
75833
78552
79413
80084
80224
80386
80430
80513
80660
81011
81317
81510
83512
83905
85255
90253
99883
1972
3694
2232
2500
3480
3544
3589
5216
01882
75435
80140
80179
94239
01286
65221
85120
94147
37110
37823
51900
55202
69271
72766
74356
78039
78491
80451
81513
82030
90256
94503
99679
V4966
2638
4148
E9357
0360
1268
2380
5217
66943
80070
94406
01404
92311
1960
94200
85249
64614
64862
E8449
66140
E8699
67004
6395
67803
E9521
63732
65402
V342
01641
64500
64924
V3501
01080
77183
64523
67811
01346
01334
66050
E8622
2901
66300
79953
65391
4330
4351
4404
5128
5248
5287
5379
5730
5763
5769
6803
6960
7149
8830
9057
9553
9693
9720
V027
V872
01303
05311
05449
05812
11592
20284
24970
25043
25061
27901
28730
30283
30302
31220
33511
34403
34551
34673
36227
36422
36531
37006
37483
37716
37721
43490
53350
67380
71159
72670
74341
74483
78834
80605
81418
85236
87363
94356
94421
1570
1000
6020
7082
7248
20036
20104
20111
20152
20903
24241
28809
29663
30285
34691
34831
36308
38050
38106
42499
45621
45919
48281
61882
62132
64204
65963
68100
70711
71950
72669
73316
74742
75314
78093
78943
80346
80492
81103
81259
82524
86131
87369
87410
87412
99684
E8786
E9314
E9361
2864
2989
3439
E9317
E9457
0219
0220
0540
0980
3301
3442
01310
94414
52102
86384
36401
45183
71110
71618
73039
80405
80441
80515
83109
87341
4150
0770
0786
1026
1100
1469
1528
2393
2458
2872
52404
75656
71142
0914
75433
85144
71805
2569
E9440
01650
01746
66823
86399
94150
65440
86383
66381
63702
67694
E9951
66090
65591
63762
E9318
E8707
77431
01312
66340
01552
01676
5130
5250
5277
5563
5959
6009
6160
6189
7059
7105
7327
7463
9565
9854
V292
01610
07798
10089
20190
20592
20917
30462
30521
31289
32710
33389
34590
34663
35922
36610
36631
37158
37250
37420
37543
37802
37843
45383
52141
52401
64890
71601
71621
73031
74251
74609
75489
80717
82332
88102
E8798
E9426
3488
3158
3817
94204
7170
05881
34581
36081
36330
36470
36502
36522
37275
37311
37412
37731
38420
49321
51181
53782
55321
56960
59659
60824
71608
71629
71662
71969
72704
73074
73329
75264
78639
81003
83810
86391
99569
E9323
E9871
V0990
V6289
587
0703
1270
1491
1610
1719
2150
2389
2511
3068
7484
52426
52542
64643
67382
73084
80031
90227
90082
64510
76061
36032
40501
414
Query:
SELECT DISTINCT "year_of_birth"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON";
Answer:
year_of_birth
1912
1913
1917
1958
1966
1909
1916
1965
1969
1910
1967
1979
1928
1934
1936
1938
1954
1942
1946
1956
1957
1982
1919
1951
1952
1925
1964
1968
1970
1976
1972
1973
1915
1975
1911
1977
1921
1932
1935
1941
1960
1943
1945
1949
1953
1961
1920
1914
1974
1978
1983
1918
1971
1981
1980
1922
1923
1926
1927
1929
1930
1931
1933
1937
1939
1947
1950
1955
1962
1963
1924
1940
1944
1948
1959
Query:
SELECT
  c."concept_name" AS Condition,
  (COUNT(DISTINCT co."person_id") * 100.0) / (SELECT COUNT(DISTINCT p."person_id") FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON" p) AS Percentage
FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE" co
JOIN "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT" c
  ON co."condition_concept_id" = c."concept_id"
WHERE c."concept_name" ILIKE '%acne%'
   OR c."concept_name" ILIKE '%dermatitis%'
   OR c."concept_name" ILIKE '%psoriasis%'
   OR c."concept_name" ILIKE '%vitiligo%'
GROUP BY c."concept_name";
Answer:
CONDITION,PERCENTAGE
Contact dermatitis due to detergent,0.372864
Chronic phototoxic dermatitis,3.689442
Seborrheic dermatitis of scalp,0.241485
Seborrheic dermatitis,3.509500
Infantile seborrheic dermatitis,0.186991
Dermatitis factitia,0.300405
Contact or allergic eyelid dermatitis,0.300276
Psoriasis,0.259105
Dermatitis herpetiformis,0.243848
Acne varioliformis,1.159934
Atopic dermatitis,2.374921
Radiation dermatitis,0.297139
Dermatitis due to drug AND/OR medicine taken internally,0.829359
"Contact dermatitis due to plants, except food",0.851578
Contact dermatitis due to cosmetics,0.275522
Herpes zoster dermatitis of eyelids,0.320862
Contact dermatitis due to solar radiation,1.926419
Contact dermatitis due to food in contact with skin,0.285278
Herpes simplex eyelid dermatitis,0.106496
Psoriasis with arthropathy,1.298275
Parapsoriasis,0.253905
Contact dermatitis,0.940024
Vitiligo,1.348515
Photodermatitis due to sun,0.958031
Atopic dermatitis due to animal dander,0.256097
Acrodermatitis continua,4.542481
Ingestion dermatitis due to food,0.459418
Dermatitis due to substances taken internally,0.530200
Eczematous dermatitis of eyelid,0.193437
Query:
SELECT DISTINCT "concept_name"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
    WHERE "concept_code" LIKE 'L%' AND "vocabulary_id" = 'ICD10CM';
Answer:
Too long, hard cut:
concept_name
Chromhidrosis
"Alopecia areata, unspecified"
Drug-induced pemphigus
Bromhidrosis
Acne tropica
Other rosacea
Postprocedural seroma of skin and subcutaneous tissue following a dermatologic procedure
Periorbital cellulitis
"Arthropathic psoriasis, unspecified"
Cellulitis of right toe
"Pressure ulcer of unspecified buttock, unstageable"
"Pressure ulcer of left ankle, stage 1"
Cutaneous abscess of umbilicus
Atrophic disorders of skin
Lupus erythematosus
Vibratory urticaria
Allergic contact dermatitis due to food in contact with the skin
"Acute lymphadenitis, unspecified"
Lichen simplex chronicus
Subacute (active) lichen planus
Ophiasis
Pityriasis alba
"Pressure ulcer of right hip, unstageable"
Non-pressure chronic ulcer of other part of unspecified lower leg limited to breakdown of skin
"Pressure ulcer of unspecified part of back, stage 4"
"Pressure ulcer of right elbow, stage 3"
"Furuncle of head [any part, except face]"
Non-pressure chronic ulcer of unspecified part of unspecified lower leg with unspecified severity
"Pressure ulcer of other site, unstageable"
Non-pressure chronic ulcer of skin of other sites with unspecified severity
Disseminated superficial actinic porokeratosis (DSAP)
Cutis rhomboidalis nuchae
Hypertrophic scar
"Acute skin change due to ultraviolet radiation, unspecified"
"Granulomatous disorder of the skin and subcutaneous tissue, unspecified"
Exfoliation due to erythematous condition involving 70-79 percent of body surface
Anagen effluvium
Other specified papulosquamous disorders
Postprocedural hematoma of skin and subcutaneous tissue following other procedure
Non-pressure chronic ulcer of unspecified part of unspecified lower leg
Cutaneous abscess of left lower limb
Non-pressure chronic ulcer of right calf with necrosis of bone
Postprocedural hematoma of skin and subcutaneous tissue following a dermatologic procedure
Non-pressure chronic ulcer of unspecified ankle with necrosis of bone
"Pressure ulcer of left upper back, stage 1"
"Pressure ulcer of unspecified heel, unspecified stage"
Pemphigus foliaceous
Infantile acne
Transient acantholytic dermatosis [Grover]
Actinic granuloma
Irritant contact dermatitis due to detergents
"Pressure ulcer of left lower back, stage 1"
Non-pressure chronic ulcer of right thigh with necrosis of bone
"Primary focal hyperhidrosis, axilla"
"Pressure ulcer of left upper back, stage 2"
Cellulitis of right axilla
Non-pressure chronic ulcer of back with unspecified severity
Lichen planus
Other specified dermatitis
Erythema annulare centrifugum
Paraneoplastic pemphigus
Pemphigus erythematosus
"Cutaneous abscess, furuncle and carbuncle of neck"
Other postprocedural complications of skin and subcutaneous tissue
Non-pressure chronic ulcer of left ankle
"Pressure ulcer of unspecified site, stage 1"
Cellulitis of perineum
Non-pressure chronic ulcer of unspecified heel and midfoot limited to breakdown of skin
"Cutaneous abscess of limb, unspecified"
Lymphomatoid papulosis
Androgenic alopecia
Psoriasis vulgaris
Non-pressure chronic ulcer of left calf
"Pemphigoid, unspecified"
Pressure ulcer of unspecified heel
Non-pressure chronic ulcer of other part of right foot with necrosis of bone
"Pressure ulcer of right hip, stage 4"
Cellulitis of right finger
"Pressure ulcer of left ankle, stage 3"
Non-pressure chronic ulcer of buttock with fat layer exposed
Non-pressure chronic ulcer of left thigh with necrosis of bone
Non-pressure chronic ulcer of unspecified part of left lower leg with unspecified severity
Intraoperative and postprocedural complications of skin and subcutaneous tissue
Acrodermatitis continua
"Pemphigus, unspecified"
Pressure ulcer of hip
Cellulitis and acute lymphangitis of trunk
Other psoriatic arthropathy
Furuncle of limb
Non-pressure chronic ulcer of left thigh with unspecified severity
"Pressure ulcer of right ankle, unstageable"
"Pressure ulcer of right elbow, unstageable"
Pruritus
Exfoliation due to erythematous condition involving 40-49 percent of body surface
Other follicular cysts of the skin and subcutaneous tissue
Pilonidal cyst and sinus without abscess
Acquired hypertrichosis lanuginosa
"Cutaneous abscess, furuncle and carbuncle, unspecified"
Irritant contact dermatitis due to metals
Furuncle of right axilla
Non-pressure chronic ulcer of unspecified part of left lower leg limited to breakdown of skin
Non-pressure chronic ulcer of unspecified calf with fat layer exposed
"Pressure ulcer of left hip, stage 1"
Furuncle of abdominal wall
Cellulitis of right upper limb
Folliculitis ulerythematosa reticulata
Keratosis punctata (palmaris et plantaris)
Linear scleroderma
Anetoderma of Jadassohn-Pellizzari
Other transepidermal elimination disorders
Non-pressure chronic ulcer of other part of lower leg
Non-pressure chronic ulcer of other part of unspecified lower leg
"Pressure ulcer of right heel, stage 1"
"Pressure ulcer of unspecified hip, stage 3"
"Pressure ulcer of right upper back, stage 3"
Acute lymphangitis of back [any part except buttoc
Query:
SELECT
  CASE
    WHEN "condition_source_value" LIKE '706%' THEN 'Acne (ICD-9 706.x)'
    WHEN "condition_source_value" LIKE '691%' THEN 'Atopic dermatitis (ICD-9 691.x)'
    WHEN "condition_source_value" LIKE '6961%' THEN 'Psoriasis (ICD-9 696.1)'
    WHEN "condition_source_value" = '70901' THEN 'Vitiligo (ICD-9 709.01)'
    ELSE NULL
  END AS Condition,
  (COUNT(DISTINCT "person_id") * 100.0) / (SELECT COUNT(DISTINCT "person_id") FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON") AS Percentage
FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE"
WHERE
  "condition_source_value" LIKE '706%'
  OR "condition_source_value" LIKE '691%'
  OR "condition_source_value" LIKE '6961%'
  OR "condition_source_value" = '70901'
GROUP BY Condition
HAVING Condition IS NOT NULL;
Answer:
CONDITION,PERCENTAGE
Atopic dermatitis (ICD-9 691.x),2.648123
Vitiligo (ICD-9 709.01),1.348515
Acne (ICD-9 706.x),6.794447
Psoriasis (ICD-9 696.1),4.542481
End Exploring Related Columns
Task: Could you provide the percentage of participants for standard acne, atopic dermatitis, psoriasis, and vitiligo defined by the International Classification of Diseases 10-CM(ICD-10-CM), including their subcategories? The ICD-10 codes are: Acne (L70), Atopic dermatitis (L20), Psoriasis (L40), and Vitiligo (L80). 

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: SELECT S."Column_Name" FROM {Database Name}.{Schema Name}.{Table_name} (ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Condition,Percentage
Acne (L70),percentage:float
Atopic dermatitis (L20),percentage:float
Psoriasis (L40),percentage:float
Vitiligo (L80),percentage:float
```

The table above shows the percentage of participants diagnosed with each skin condition, including their subcategories, as defined by the specified ICD-10-CM codes..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'CMS_DATA': {'CMS_CODES': ['HCPCS', 'ICD10_DIAGNOSES_2019', 'ICD10_PROCEDURES_2019', 'ICD9_DIAGNOSES', 'ICD9_PROCEDURES'], 'CMS_MEDICARE': ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014', 'HOSPICE_PROVIDERS_2014', 'HOSPITAL_GENERAL_INFO', 'INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2015', 'NURSING_FACILITIES_2013', 'NURSING_FACILITIES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2015', 'PART_D_PRESCRIBER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014'], 'CMS_SYNTHETIC_PATIENT_DATA_OMOP': ['CARE_SITE', 'CONCEPT', 'CONCEPT_ANCESTOR', 'CONCEPT_CLASS', 'CONCEPT_RELATIONSHIP', 'CONDITION_ERA', 'CONDITION_OCCURRENCE', 'COST', 'DEATH', 'DEVICE_EXPOSURE', 'DOMAIN', 'DOSE_ERA', 'DRUG_ERA', 'DRUG_EXPOSURE', 'DRUG_STRENGTH', 'LOCATION', 'OBSERVATION', 'OBSERVATION_PERIOD', 'PAYER_PLAN_PERIOD', 'PERSON', 'PROCEDURE_OCCURRENCE', 'PROVIDER', 'RELATIONSHIP', 'VOCABULARY']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
Keep all decimals to four decimal places.

2025-01-18 13:02:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 13:02:02 - root - INFO - ```sql
WITH total_participants AS (
  SELECT COUNT(DISTINCT "person_id") AS total
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON"
),
condition_counts AS (
  SELECT
    CASE
      WHEN co."condition_source_value" LIKE 'L70%' THEN 'Acne (L70)'
      WHEN co."condition_source_value" LIKE 'L20%' THEN 'Atopic dermatitis (L20)'
      WHEN co."condition_source_value" LIKE 'L40%' THEN 'Psoriasis (L40)'
      WHEN co."condition_source_value" LIKE 'L80%' THEN 'Vitiligo (L80)'
      ELSE NULL
    END AS Condition,
    co."person_id"
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE" co
  WHERE co."condition_source_value" LIKE 'L70%'
     OR co."condition_source_value" LIKE 'L20%'
     OR co."condition_source_value" LIKE 'L40%'
     OR co."condition_source_value" LIKE 'L80%'
)
SELECT
  Condition,
  ROUND((COUNT(DISTINCT "person_id") * 100.0) / tp.total, 4) AS Percentage
FROM condition_counts cc
CROSS JOIN total_participants tp
WHERE Condition IS NOT NULL
GROUP BY Condition
ORDER BY Condition;
```
2025-01-18 13:02:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 13:02:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 13:02:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 13:02:03 - snowflake.connector.connection - INFO - closed
2025-01-18 13:02:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:02:04 - root - INFO - itercount: 1
2025-01-18 13:02:04 - root - INFO - 001104 (42601): 01b9cb4e-0004-7d9a-0001-11c300ee40fe: SQL compilation error: error line 23 at position 48
'TP.TOTAL' in select clause is neither an aggregate nor in the group by clause.
2025-01-18 13:02:04 - root - INFO - Input sql:
WITH total_participants AS (
  SELECT COUNT(DISTINCT "person_id") AS total
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON"
),
condition_counts AS (
  SELECT
    CASE
      WHEN co."condition_source_value" LIKE 'L70%' THEN 'Acne (L70)'
      WHEN co."condition_source_value" LIKE 'L20%' THEN 'Atopic dermatitis (L20)'
      WHEN co."condition_source_value" LIKE 'L40%' THEN 'Psoriasis (L40)'
      WHEN co."condition_source_value" LIKE 'L80%' THEN 'Vitiligo (L80)'
      ELSE NULL
    END AS Condition,
    co."person_id"
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE" co
  WHERE co."condition_source_value" LIKE 'L70%'
     OR co."condition_source_value" LIKE 'L20%'
     OR co."condition_source_value" LIKE 'L40%'
     OR co."condition_source_value" LIKE 'L80%'
)
SELECT
  Condition,
  ROUND((COUNT(DISTINCT "person_id") * 100.0) / tp.total, 4) AS Percentage
FROM condition_counts cc
CROSS JOIN total_participants tp
WHERE Condition IS NOT NULL
GROUP BY Condition
ORDER BY Condition;
The error information is:
001104 (42601): 01b9cb4e-0004-7d9a-0001-11c300ee40fe: SQL compilation error: error line 23 at position 48
'TP.TOTAL' in select clause is neither an aggregate nor in the group by clause.
Please correct it and output only 1 complete SQL query.
2025-01-18 13:02:41 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 13:02:41 - root - INFO - ```sql
WITH total_participants AS (
  SELECT COUNT(DISTINCT "person_id") AS total
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON"
),
condition_counts AS (
  SELECT
    CASE
      WHEN co."condition_source_value" LIKE 'L70%' THEN 'Acne (L70)'
      WHEN co."condition_source_value" LIKE 'L20%' THEN 'Atopic dermatitis (L20)'
      WHEN co."condition_source_value" LIKE 'L40%' THEN 'Psoriasis (L40)'
      WHEN co."condition_source_value" LIKE 'L80%' THEN 'Vitiligo (L80)'
      ELSE NULL
    END AS Condition,
    co."person_id"
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE" co
  WHERE co."condition_source_value" LIKE 'L70%'
     OR co."condition_source_value" LIKE 'L20%'
     OR co."condition_source_value" LIKE 'L40%'
     OR co."condition_source_value" LIKE 'L80%'
)
SELECT
  Condition,
  ROUND((COUNT(DISTINCT "person_id") * 100.0) / MAX(tp.total), 4) AS Percentage
FROM condition_counts cc
CROSS JOIN total_participants tp
WHERE Condition IS NOT NULL
GROUP BY Condition
ORDER BY Condition;
```
2025-01-18 13:02:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 13:02:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 13:02:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 13:02:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 13:02:43 - snowflake.connector.connection - INFO - closed
2025-01-18 13:02:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:02:43 - root - INFO - itercount: 2
2025-01-18 13:02:43 - root - INFO - No data found for the specified query.

2025-01-18 13:02:43 - root - INFO - Input sql:
WITH total_participants AS (
  SELECT COUNT(DISTINCT "person_id") AS total
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON"
),
condition_counts AS (
  SELECT
    CASE
      WHEN co."condition_source_value" LIKE 'L70%' THEN 'Acne (L70)'
      WHEN co."condition_source_value" LIKE 'L20%' THEN 'Atopic dermatitis (L20)'
      WHEN co."condition_source_value" LIKE 'L40%' THEN 'Psoriasis (L40)'
      WHEN co."condition_source_value" LIKE 'L80%' THEN 'Vitiligo (L80)'
      ELSE NULL
    END AS Condition,
    co."person_id"
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE" co
  WHERE co."condition_source_value" LIKE 'L70%'
     OR co."condition_source_value" LIKE 'L20%'
     OR co."condition_source_value" LIKE 'L40%'
     OR co."condition_source_value" LIKE 'L80%'
)
SELECT
  Condition,
  ROUND((COUNT(DISTINCT "person_id") * 100.0) / MAX(tp.total), 4) AS Percentage
FROM condition_counts cc
CROSS JOIN total_participants tp
WHERE Condition IS NOT NULL
GROUP BY Condition
ORDER BY Condition;
The error information is:
 No data found for the specified query.

2025-01-18 13:03:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 13:03:33 - root - INFO - ```sql
WITH total_participants AS (
  SELECT COUNT(DISTINCT "person_id") AS total
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON"
),
condition_counts AS (
  SELECT
    CASE
      WHEN c."concept_code" LIKE 'L70%' AND c."vocabulary_id" = 'ICD10CM' THEN 'Acne (L70)'
      WHEN c."concept_code" LIKE 'L20%' AND c."vocabulary_id" = 'ICD10CM' THEN 'Atopic dermatitis (L20)'
      WHEN c."concept_code" LIKE 'L40%' AND c."vocabulary_id" = 'ICD10CM' THEN 'Psoriasis (L40)'
      WHEN c."concept_code" LIKE 'L80%' AND c."vocabulary_id" = 'ICD10CM' THEN 'Vitiligo (L80)'
      ELSE NULL
    END AS Condition,
    co."person_id"
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE" co
  JOIN "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT" c
    ON co."condition_concept_id" = c."concept_id"
)
SELECT
  Condition,
  ROUND((COUNT(DISTINCT "person_id") * 100.0) / MAX(tp.total), 4) AS Percentage
FROM condition_counts cc
CROSS JOIN total_participants tp
WHERE Condition IS NOT NULL
GROUP BY Condition
ORDER BY Condition;
```
2025-01-18 13:03:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 13:03:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 13:03:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 13:03:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 13:03:35 - snowflake.connector.connection - INFO - closed
2025-01-18 13:03:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:03:35 - root - INFO - itercount: 3
2025-01-18 13:03:35 - root - INFO - No data found for the specified query.

2025-01-18 13:03:35 - root - INFO - Input sql:
WITH total_participants AS (
  SELECT COUNT(DISTINCT "person_id") AS total
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON"
),
condition_counts AS (
  SELECT
    CASE
      WHEN c."concept_code" LIKE 'L70%' AND c."vocabulary_id" = 'ICD10CM' THEN 'Acne (L70)'
      WHEN c."concept_code" LIKE 'L20%' AND c."vocabulary_id" = 'ICD10CM' THEN 'Atopic dermatitis (L20)'
      WHEN c."concept_code" LIKE 'L40%' AND c."vocabulary_id" = 'ICD10CM' THEN 'Psoriasis (L40)'
      WHEN c."concept_code" LIKE 'L80%' AND c."vocabulary_id" = 'ICD10CM' THEN 'Vitiligo (L80)'
      ELSE NULL
    END AS Condition,
    co."person_id"
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE" co
  JOIN "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT" c
    ON co."condition_concept_id" = c."concept_id"
)
SELECT
  Condition,
  ROUND((COUNT(DISTINCT "person_id") * 100.0) / MAX(tp.total), 4) AS Percentage
FROM condition_counts cc
CROSS JOIN total_participants tp
WHERE Condition IS NOT NULL
GROUP BY Condition
ORDER BY Condition;
The error information is:
 No data found for the specified query.

2025-01-18 13:04:12 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 13:04:12 - root - INFO - ```sql
WITH total_participants AS (
  SELECT COUNT(DISTINCT "person_id") AS total
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON"
),
condition_counts AS (
  SELECT
    CASE
      WHEN co."condition_source_value" LIKE '706%' THEN 'Acne (ICD-9 706.x)'
      WHEN co."condition_source_value" LIKE '691%' THEN 'Atopic dermatitis (ICD-9 691.x)'
      WHEN co."condition_source_value" LIKE '6961%' THEN 'Psoriasis (ICD-9 696.1)'
      WHEN co."condition_source_value" = '70901' THEN 'Vitiligo (ICD-9 709.01)'
      ELSE NULL
    END AS Condition,
    co."person_id"
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE" co
  WHERE co."condition_source_value" LIKE '706%'
     OR co."condition_source_value" LIKE '691%'
     OR co."condition_source_value" LIKE '6961%'
     OR co."condition_source_value" = '70901'
)
SELECT
  Condition,
  ROUND((COUNT(DISTINCT "person_id") * 100.0) / MAX(tp.total), 4) AS Percentage
FROM condition_counts cc
CROSS JOIN total_participants tp
WHERE Condition IS NOT NULL
GROUP BY Condition
ORDER BY Condition;
```
2025-01-18 13:04:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 13:04:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 13:04:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 13:04:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 4
2025-01-18 13:04:14 - snowflake.connector.connection - INFO - closed
2025-01-18 13:04:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:04:15 - root - INFO - itercount: 4
2025-01-18 13:04:15 - root - INFO - 0
2025-01-18 13:04:15 - root - INFO - results: 
CONDITION,PERCENTAGE
Acne (ICD-9 706.x),6.7944
Atopic dermatitis (ICD-9 691.x),2.6481
Psoriasis (ICD-9 696.1),4.5425
Vitiligo (ICD-9 709.01),1.3485


2025-01-18 13:04:15 - root - INFO - Please check the answer again by reviewing Could you provide the percentage of participants for standard acne, atopic dermatitis, psoriasis, and vitiligo defined by the International Classification of Diseases 10-CM(ICD-10-CM), including their subcategories? The ICD-10 codes are: Acne (L70), Atopic dermatitis (L20), Psoriasis (L40), and Vitiligo (L80). , reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Condition,Percentage
Acne (L70),percentage:float
Atopic dermatitis (L20),percentage:float
Psoriasis (L40),percentage:float
Vitiligo (L80),percentage:float
```

The table above shows the percentage of participants diagnosed with each skin condition, including their subcategories, as defined by the specified ICD-10-CM codes. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
CONDITION,PERCENTAGE
Acne (ICD-9 706.x),6.7944
Atopic dermatitis (ICD-9 691.x),2.6481
Psoriasis (ICD-9 696.1),4.5425
Vitiligo (ICD-9 709.01),1.3485
Current sql:
WITH total_participants AS (
  SELECT COUNT(DISTINCT "person_id") AS total
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON"
),
condition_counts AS (
  SELECT
    CASE
      WHEN co."condition_source_value" LIKE '706%' THEN 'Acne (ICD-9 706.x)'
      WHEN co."condition_source_value" LIKE '691%' THEN 'Atopic dermatitis (ICD-9 691.x)'
      WHEN co."condition_source_value" LIKE '6961%' THEN 'Psoriasis (ICD-9 696.1)'
      WHEN co."condition_source_value" = '70901' THEN 'Vitiligo (ICD-9 709.01)'
      ELSE NULL
    END AS Condition,
    co."person_id"
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE" co
  WHERE co."condition_source_value" LIKE '706%'
     OR co."condition_source_value" LIKE '691%'
     OR co."condition_source_value" LIKE '6961%'
     OR co."condition_source_value" = '70901'
)
SELECT
  Condition,
  ROUND((COUNT(DISTINCT "person_id") * 100.0) / MAX(tp.total), 4) AS Percentage
FROM condition_counts cc
CROSS JOIN total_participants tp
WHERE Condition IS NOT NULL
GROUP BY Condition
ORDER BY Condition;
2025-01-18 13:05:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 13:05:09 - root - INFO - ```sql
WITH total_participants AS (
  SELECT COUNT(DISTINCT "person_id") AS total
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON"
),
condition_counts AS (
  SELECT
    CASE
      WHEN co."condition_source_value" LIKE '706%' THEN 'Acne (ICD-9 706.x)'
      WHEN co."condition_source_value" LIKE '691%' THEN 'Atopic dermatitis (ICD-9 691.x)'
      WHEN co."condition_source_value" LIKE '6961%' THEN 'Psoriasis (ICD-9 696.1)'
      WHEN co."condition_source_value" = '70901' THEN 'Vitiligo (ICD-9 709.01)'
      ELSE NULL
    END AS Condition,
    co."person_id"
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONDITION_OCCURRENCE" co
  WHERE co."condition_source_value" LIKE '706%'
     OR co."condition_source_value" LIKE '691%'
     OR co."condition_source_value" LIKE '6961%'
     OR co."condition_source_value" = '70901'
)
SELECT
  Condition,
  ROUND((COUNT(DISTINCT "person_id") * 100.0) / MAX(tp.total), 4) AS Percentage
FROM condition_counts cc
CROSS JOIN total_participants tp
WHERE Condition IS NOT NULL
GROUP BY Condition
ORDER BY Condition;
```
2025-01-18 13:05:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 13:05:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 13:05:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 13:05:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 4
2025-01-18 13:05:10 - snowflake.connector.connection - INFO - closed
2025-01-18 13:05:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:05:11 - root - INFO - itercount: 5
2025-01-18 13:05:11 - root - INFO - 0
2025-01-18 13:05:11 - root - INFO - Total iteration counts: 5
