2025-01-18 12:53:27 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 12:54:35 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 12:54:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:54:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:54:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:54:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 12:54:37 - snowflake.connector.connection - INFO - closed
2025-01-18 12:54:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:54:37 - root - INFO - SQL:
SELECT DISTINCT "condition_source_value"
   FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE
   LIMIT 1000;
Results:
Too long, hard cut:
condition_source_value
7084
7335
7353
7395
7587
7596
8260
9500
9630
9792
9878
9986
E915
00861
04111
04611
07071
09834
20005
20014
20113
9604
09482
20034
20235
0088
1533
1551
1103
2540
2750
2900
3368
4358
5778
5780
33520
34700
36234
38612
5713
30002
01890
10081
20602
20681
22800
23331
23876
25950
29656
30010
30289
34652
35579
30723
32735
01626
4918
5834
38619
2572
1489
2758
3335
4118
4800
5227
5262
37900
1716
36922
36314
36331
36362
36403
1948
4932
7616
3235
01620
09959
01652
7059
7105
7170
7327
7463
9565
9854
V292
01610
05881
07798
20190
7482
1610
2337
2511
3159
3488
5130
30521
31289
34590
3430
5959
587
3158
38420
2389
5563
6160
1719
2150
37311
5277
3077
3817
5250
6009
6189
7484
9252
10089
3068
20592
20917
30462
32710
33389
34581
34663
35922
36032
36081
36330
36470
36631
V233
01795
36522
09882
01880
7480
8790
9559
9980
V662
01170
04181
05889
07042
07421
V092
20165
1101
4480
20280
20411
23875
25541
30393
5118
20511
20822
20953
25512
27911
27953
28869
30081
30159
30743
32381
33981
28319
3014
3139
3309
4722
5837
6030
6038
6201
6254
9472
9600
9797
09150
0538
0319
01500
36213
01571
36282
36321
7660
V392
2966
7136
7100
7507
8370
8678
8787
9518
9603
9853
V029
00329
00862
01796
04512
06640
20064
20110
20198
0380
2550
2983
3180
6258
29573
33119
34839
40391
34680
20711
23873
29182
29541
30983
33381
33399
33709
36069
32089
34611
3005
5940
6214
6227
6243
6251
6940
0362
2116
38635
01363
20253
01185
01700
36253
2210
1843
30253
36113
36132
36400
11591
7627
0382
1569
2662
3453
3558
4417
3688
5772
6253
V090
28522
28983
28989
29514
29644
33821
37854
1611
2190
4200
5969
1881
5643
4847
5208
6270
7438
8064
8631
8797
9178
9586
20973
20943
25513
30271
31235
31322
32721
32753
34672
36004
30284
30740
36231
4250
9471
V694
01703
03281
05443
07272
09389
11512
20045
08882
3708
7684
3200
20295
539
01104
36441
36236
36289
36457
36481
01140
09956
1830
1738
2720
3207
3682
5690
5941
6953
7292
9696
20283
20972
27401
30011
33811
36840
27800
0272
1600
5952
9411
24210
30181
30780
36844
2153
24921
37730
38300
7585
8780
9757
9967
00866
01110
05821
07043
13621
20202
09833
2339
4171
20412
20952
24950
25952
29581
30492
33921
33943
34561
36054
9279
2822
3454
3672
4760
4789
5246
6023
6159
6246
3213
30754
2680
01790
01085
2532
4010
4558
5070
5609
V144
03811
20073
V443
30431
38630
2706
28749
32723
33390
2533
3649
6273
V488
29635
33721
3300
3410
6200
7249
3538
5220
7313
V468
24941
38920
20955
30572
32715
34683
36210
36370
7070
7443
7445
8290
9177
9197
9739
9790
V402
V479
01753
07041
20008
11500
3819
3879
5160
5294
6151
6175
7488
9493
9686
01754
20063
20251
09841
1340
01645
7195
9495
01501
40403
01553
7266
37157
32351
1120
1548
1820
2357
2839
3102
3315
4321
4374
6989
7283
E969
08881
25000
28529
28982
29284
30301
30501
38610
25081
2141
2734
5226
8900
9245
24280
24960
29604
32724
4780
9060
7042
7137
7215
7389
7449
04103
20011
20043
20255
20481
20530
20582
20922
30270
30531
34620
36011
36063
9767
20297
4460
2705
2780
2918
3643
5063
5236
5288
5937
6140
6920
6931
0796
01200
09831
2300
36221
01601
01895
01220
1460
1510
1613
2111
2521
2564
4372
4556
6259
8500
8798
27669
28731
35781
35800
2452
9238
6169
36207
9766
9796
V026
03283
05412
05474
20042
20060
20081
2660
3360
20914
22803
30753
32729
34632
34641
2381
3023
3093
3448
4375
4957
5308
5930
6104
6148
4954
36281
8451
20156
09814
36372
6332
01642
8210
1888
1977
2443
2689
2948
2971
3013
25023
28249
29624
1532
20930
7285
7422
7595
9510
9578
V279
V411
V482
00842
01600
05444
20276
20151
20247
20380
20781
20931
23330
27731
28863
29524
30113
31211
32725
33984
31213
34622
6103
8501
9746
01380
01781
09323
9664
2739
2862
2980
4472
6145
37210
1764
7634
09189
36301
36471
38110
8420
01565
475
1123
1976
3019
3090
3568
5120
6918
04104
05479
20282
29285
30403
30481
3182
32727
6910
1504
7103
7141
2798
5600
5881
20920
4718
6176
7018
7452
8504
9517
9831
E851
V025
9760
20712
20927
27784
28802
29552
32744
33903
34610
36041
3920
20381
40400
1901
V475
00323
04511
04593
11502
13629
20013
20116
20222
20258
V253
01883
38589
38023
V271
36237
36255
7553
7140
7324
7325
8364
8600
V028
01614
07033
20022
20121
20170
09849
0090
1490
2397
3017
3340
4479
4809
5811
5964
6185
29534
30014
37652
2793
3108
3590
4801
5813
27709
33372
33523
20911
20925
20974
22801
24940
28801
29389
30402
31201
31222
32714
32743
33901
36003
2710
2889
2981
2984
3006
3091
3418
3709
5210
5229
6143
2249
01182
20226
3067
7152
20195
1448
7637
32301
36224
36285
36402
36453
01503
1125
1580
2140
2858
3007
4568
4659
5990
6825
7213
25021
25052
29042
2841
25001
30000
34580
25201
2459
2468
6279
9584
E989
V698
27787
37430
00849
30440
4958
37203
30272
32720
7039
7500
9680
9687
V483
04520
04672
05442
20224
20272
20274
20061
05310
2880
2908
3434
3759
4761
6080
2661
20912
24201
24211
29681
30110
30652
31532
35923
36019
36061
2374
01763
36335
36350
36352
01751
7328
7517
8280
8748
8788
9934
V272
V661
00841
03641
09489
11515
19882
20070
20084
20206
9127
0414
1728
1978
1983
2832
4430
4732
5168
4489
23332
24220
25202
29633
30781
34690
40310
34460
5961
4738
23872
29564
1321
29020
34489
4378
34

2025-01-18 12:54:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:54:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:54:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:54:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-18 12:54:38 - snowflake.connector.connection - INFO - closed
2025-01-18 12:54:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:54:39 - root - INFO - SQL:
SELECT COUNT(*) AS "total_participants"
   FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON;
Results:
total_participants
2326856

2025-01-18 12:54:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:54:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:54:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:54:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 12:54:40 - snowflake.connector.connection - INFO - closed
2025-01-18 12:54:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:55:49 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 12:55:49 - root - INFO - ```sql
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN c."condition_source_value" LIKE '706%' THEN 'Acne'
            WHEN c."condition_source_value" LIKE '691%' THEN 'Atopic dermatitis'
            WHEN c."condition_source_value" LIKE '696%' THEN 'Psoriasis'
            WHEN c."condition_source_value" = '70901' THEN 'Vitiligo'
        END AS Condition,
        c."person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE c
    WHERE
        c."condition_source_value" LIKE '706%'
        OR c."condition_source_value" LIKE '691%'
        OR c."condition_source_value" LIKE '696%'
        OR c."condition_source_value" = '70901'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / t.total, 2) AS Percentage
FROM
    conditions
    CROSS JOIN total_participants t
GROUP BY
    Condition, t.total;
```
2025-01-18 12:55:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:55:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:55:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:55:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 4
2025-01-18 12:55:51 - snowflake.connector.connection - INFO - closed
2025-01-18 12:55:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:55:52 - root - INFO - SQL:
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN c."condition_source_value" LIKE '706%' THEN 'Acne'
            WHEN c."condition_source_value" LIKE '691%' THEN 'Atopic dermatitis'
            WHEN c."condition_source_value" LIKE '696%' THEN 'Psoriasis'
            WHEN c."condition_source_value" = '70901' THEN 'Vitiligo'
        END AS Condition,
        c."person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE c
    WHERE
        c."condition_source_value" LIKE '706%'
        OR c."condition_source_value" LIKE '691%'
        OR c."condition_source_value" LIKE '696%'
        OR c."condition_source_value" = '70901'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / t.total, 2) AS Percentage
FROM
    conditions
    CROSS JOIN total_participants t
GROUP BY
    Condition, t.total;
Results:
CONDITION,PERCENTAGE
Psoriasis,6.29
Atopic dermatitis,2.65
Vitiligo,1.35
Acne,6.79

2025-01-18 12:55:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:55:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:55:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:55:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 12:55:53 - snowflake.connector.connection - INFO - closed
2025-01-18 12:55:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:56:35 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 12:56:35 - root - INFO - ```sql
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN c."condition_source_value" LIKE '706%' THEN 'Acne'
            WHEN c."condition_source_value" LIKE '691%' THEN 'Atopic dermatitis'
            WHEN c."condition_source_value" LIKE '696%' THEN 'Psoriasis'
            WHEN c."condition_source_value" LIKE '709%' THEN 'Vitiligo'
        END AS Condition,
        c."person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE c
    WHERE
        c."condition_source_value" LIKE '706%'
        OR c."condition_source_value" LIKE '691%'
        OR c."condition_source_value" LIKE '696%'
        OR c."condition_source_value" LIKE '709%'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / t.total, 2) AS Percentage
FROM
    conditions
    CROSS JOIN total_participants t
WHERE Condition IS NOT NULL
GROUP BY
    Condition, t.total;
```
2025-01-18 12:56:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:56:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:56:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:56:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 4
2025-01-18 12:56:37 - snowflake.connector.connection - INFO - closed
2025-01-18 12:56:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:56:37 - root - INFO - SQL:
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN c."condition_source_value" LIKE '706%' THEN 'Acne'
            WHEN c."condition_source_value" LIKE '691%' THEN 'Atopic dermatitis'
            WHEN c."condition_source_value" LIKE '696%' THEN 'Psoriasis'
            WHEN c."condition_source_value" LIKE '709%' THEN 'Vitiligo'
        END AS Condition,
        c."person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE c
    WHERE
        c."condition_source_value" LIKE '706%'
        OR c."condition_source_value" LIKE '691%'
        OR c."condition_source_value" LIKE '696%'
        OR c."condition_source_value" LIKE '709%'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / t.total, 2) AS Percentage
FROM
    conditions
    CROSS JOIN total_participants t
WHERE Condition IS NOT NULL
GROUP BY
    Condition, t.total;
Results:
CONDITION,PERCENTAGE
Psoriasis,6.29
Atopic dermatitis,2.65
Vitiligo,14.29
Acne,6.79

2025-01-18 12:56:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:56:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:56:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:56:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 12:56:39 - snowflake.connector.connection - INFO - closed
2025-01-18 12:56:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:57:11 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 12:57:11 - root - INFO - ```sql
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN LOWER(concept."concept_name") LIKE '%acne%' THEN 'Acne'
            WHEN LOWER(concept."concept_name") LIKE '%atopic dermatitis%' THEN 'Atopic dermatitis'
            WHEN LOWER(concept."concept_name") LIKE '%psoriasis%' THEN 'Psoriasis'
            WHEN LOWER(concept."concept_name") LIKE '%vitiligo%' THEN 'Vitiligo'
        END AS Condition,
        c."person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE c
        JOIN CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONCEPT concept
          ON c."condition_source_concept_id" = concept."concept_id"
    WHERE
        LOWER(concept."concept_name") LIKE '%acne%'
        OR LOWER(concept."concept_name") LIKE '%atopic dermatitis%'
        OR LOWER(concept."concept_name") LIKE '%psoriasis%'
        OR LOWER(concept."concept_name") LIKE '%vitiligo%'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / t.total, 2) AS Percentage
FROM
    conditions
    CROSS JOIN total_participants t
WHERE Condition IS NOT NULL
GROUP BY
    Condition, t.total;
```
2025-01-18 12:57:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:57:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:57:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:57:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 4
2025-01-18 12:57:13 - snowflake.connector.connection - INFO - closed
2025-01-18 12:57:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:57:13 - root - INFO - SQL:
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN LOWER(concept."concept_name") LIKE '%acne%' THEN 'Acne'
            WHEN LOWER(concept."concept_name") LIKE '%atopic dermatitis%' THEN 'Atopic dermatitis'
            WHEN LOWER(concept."concept_name") LIKE '%psoriasis%' THEN 'Psoriasis'
            WHEN LOWER(concept."concept_name") LIKE '%vitiligo%' THEN 'Vitiligo'
        END AS Condition,
        c."person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE c
        JOIN CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONCEPT concept
          ON c."condition_source_concept_id" = concept."concept_id"
    WHERE
        LOWER(concept."concept_name") LIKE '%acne%'
        OR LOWER(concept."concept_name") LIKE '%atopic dermatitis%'
        OR LOWER(concept."concept_name") LIKE '%psoriasis%'
        OR LOWER(concept."concept_name") LIKE '%vitiligo%'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / t.total, 2) AS Percentage
FROM
    conditions
    CROSS JOIN total_participants t
WHERE Condition IS NOT NULL
GROUP BY
    Condition, t.total;
Results:
CONDITION,PERCENTAGE
Psoriasis,4.90
Atopic dermatitis,2.37
Vitiligo,1.35
Acne,1.16

2025-01-18 12:57:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:57:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:57:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:57:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 12:57:15 - snowflake.connector.connection - INFO - closed
2025-01-18 12:57:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:58:12 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 12:58:12 - root - INFO - ```sql
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN c."concept_code" LIKE 'L70%' THEN 'Acne'
            WHEN c."concept_code" LIKE 'L20%' THEN 'Atopic dermatitis'
            WHEN c."concept_code" LIKE 'L40%' THEN 'Psoriasis'
            WHEN c."concept_code" LIKE 'L80%' THEN 'Vitiligo'
        END AS Condition,
        occ."person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE occ
        JOIN CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONCEPT c
          ON occ."condition_source_concept_id" = c."concept_id"
    WHERE
        c."concept_code" LIKE 'L70%'
        OR c."concept_code" LIKE 'L20%'
        OR c."concept_code" LIKE 'L40%'
        OR c."concept_code" LIKE 'L80%'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / t.total, 2) AS Percentage
FROM
    conditions
    CROSS JOIN total_participants t
WHERE Condition IS NOT NULL
GROUP BY
    Condition, t.total;
```
2025-01-18 12:58:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:58:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:58:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:58:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 12:58:14 - snowflake.connector.connection - INFO - closed
2025-01-18 12:58:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 12:59:44 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 12:59:44 - root - INFO - ```sql
SELECT
    'Total Participants with Conditions' AS Condition,
    ROUND((COUNT(DISTINCT c."person_id") * 100.0) / t.total, 2) AS Percentage
FROM
    CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE c
    CROSS JOIN (
        SELECT COUNT(*) AS total
        FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
    ) t;
```
2025-01-18 12:59:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 12:59:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 12:59:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 12:59:46 - snowflake.connector.connection - INFO - closed
2025-01-18 12:59:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:00:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 13:00:21 - root - INFO - ```sql
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN c."condition_source_value" LIKE 'L70%' THEN 'Acne'
            WHEN c."condition_source_value" LIKE 'L20%' THEN 'Atopic dermatitis'
            WHEN c."condition_source_value" LIKE 'L40%' THEN 'Psoriasis'
            WHEN c."condition_source_value" LIKE 'L80%' THEN 'Vitiligo'
            ELSE NULL
        END AS Condition,
        c."person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE c
    WHERE
        c."condition_source_value" LIKE 'L70%'
        OR c."condition_source_value" LIKE 'L20%'
        OR c."condition_source_value" LIKE 'L40%'
        OR c."condition_source_value" LIKE 'L80%'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / (SELECT total FROM total_participants), 2) AS Percentage
FROM
    conditions
WHERE
    Condition IS NOT NULL
GROUP BY
    Condition;
```
2025-01-18 13:00:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 13:00:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 13:00:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 13:00:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 13:00:23 - snowflake.connector.connection - INFO - closed
2025-01-18 13:00:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:00:23 - root - INFO - SQL:
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN c."condition_source_value" LIKE 'L70%' THEN 'Acne'
            WHEN c."condition_source_value" LIKE 'L20%' THEN 'Atopic dermatitis'
            WHEN c."condition_source_value" LIKE 'L40%' THEN 'Psoriasis'
            WHEN c."condition_source_value" LIKE 'L80%' THEN 'Vitiligo'
            ELSE NULL
        END AS Condition,
        c."person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE c
    WHERE
        c."condition_source_value" LIKE 'L70%'
        OR c."condition_source_value" LIKE 'L20%'
        OR c."condition_source_value" LIKE 'L40%'
        OR c."condition_source_value" LIKE 'L80%'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / (SELECT total FROM total_participants), 2) AS Percentage
FROM
    conditions
WHERE
    Condition IS NOT NULL
GROUP BY
    Condition;
Results:
No data found for the specified query.

2025-01-18 13:00:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 13:00:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 13:00:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 13:00:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 13:00:25 - snowflake.connector.connection - INFO - closed
2025-01-18 13:00:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:01:18 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 13:01:18 - root - INFO - ```sql
SELECT
    'Psoriasis' AS Condition,
    ROUND((COUNT(DISTINCT c."person_id") * 100.0) / (
        SELECT COUNT(*) FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
    ), 2) AS Percentage
FROM
    CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE c
WHERE
    c."condition_source_value" LIKE '696%';
```
2025-01-18 13:01:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 13:01:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 13:01:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 13:01:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-18 13:01:20 - snowflake.connector.connection - INFO - closed
2025-01-18 13:01:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:01:20 - root - INFO - SQL:
SELECT
    'Psoriasis' AS Condition,
    ROUND((COUNT(DISTINCT c."person_id") * 100.0) / (
        SELECT COUNT(*) FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
    ), 2) AS Percentage
FROM
    CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE c
WHERE
    c."condition_source_value" LIKE '696%';
Results:
CONDITION,PERCENTAGE
Psoriasis,6.29

2025-01-18 13:01:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 13:01:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 13:01:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 13:01:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-18 13:01:22 - snowflake.connector.connection - INFO - closed
2025-01-18 13:01:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:02:12 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 13:02:12 - root - INFO - ```sql
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN c."condition_source_value" LIKE '696%' THEN 'Psoriasis'
            WHEN c."condition_source_value" LIKE '706%' THEN 'Acne'
        END AS Condition,
        c."person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE c
    WHERE
        c."condition_source_value" LIKE '696%'
        OR c."condition_source_value" LIKE '706%'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / (SELECT total FROM total_participants), 2) AS Percentage
FROM
    conditions
WHERE
    Condition IS NOT NULL
GROUP BY
    Condition;
```
2025-01-18 13:02:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 13:02:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 13:02:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 13:02:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-18 13:02:14 - snowflake.connector.connection - INFO - closed
2025-01-18 13:02:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:02:14 - root - INFO - SQL:
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN c."condition_source_value" LIKE '696%' THEN 'Psoriasis'
            WHEN c."condition_source_value" LIKE '706%' THEN 'Acne'
        END AS Condition,
        c."person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE c
    WHERE
        c."condition_source_value" LIKE '696%'
        OR c."condition_source_value" LIKE '706%'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / (SELECT total FROM total_participants), 2) AS Percentage
FROM
    conditions
WHERE
    Condition IS NOT NULL
GROUP BY
    Condition;
Results:
CONDITION,PERCENTAGE
Psoriasis,6.29
Acne,6.79

2025-01-18 13:02:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 13:02:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 13:02:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 13:02:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-18 13:02:16 - snowflake.connector.connection - INFO - closed
2025-01-18 13:02:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:03:06 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 13:03:06 - root - INFO - ```sql
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN c."condition_source_value" LIKE '696%' THEN 'Psoriasis'
            WHEN c."condition_source_value" LIKE '706%' THEN 'Acne'
            WHEN c."condition_source_value" LIKE '691%' THEN 'Atopic dermatitis'
            WHEN c."condition_source_value" LIKE '709%' THEN 'Vitiligo'
        END AS Condition,
        c."person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE c
    WHERE
        c."condition_source_value" LIKE '696%'
        OR c."condition_source_value" LIKE '706%'
        OR c."condition_source_value" LIKE '691%'
        OR c."condition_source_value" LIKE '709%'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / (SELECT total FROM total_participants), 2) AS Percentage
FROM
    conditions
WHERE
    Condition IS NOT NULL
GROUP BY
    Condition;
```
2025-01-18 13:03:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 13:03:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 13:03:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 13:03:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 4
2025-01-18 13:03:08 - snowflake.connector.connection - INFO - closed
2025-01-18 13:03:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:03:08 - root - INFO - SQL:
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN c."condition_source_value" LIKE '696%' THEN 'Psoriasis'
            WHEN c."condition_source_value" LIKE '706%' THEN 'Acne'
            WHEN c."condition_source_value" LIKE '691%' THEN 'Atopic dermatitis'
            WHEN c."condition_source_value" LIKE '709%' THEN 'Vitiligo'
        END AS Condition,
        c."person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE c
    WHERE
        c."condition_source_value" LIKE '696%'
        OR c."condition_source_value" LIKE '706%'
        OR c."condition_source_value" LIKE '691%'
        OR c."condition_source_value" LIKE '709%'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / (SELECT total FROM total_participants), 2) AS Percentage
FROM
    conditions
WHERE
    Condition IS NOT NULL
GROUP BY
    Condition;
Results:
CONDITION,PERCENTAGE
Psoriasis,6.29
Atopic dermatitis,2.65
Vitiligo,14.29
Acne,6.79

2025-01-18 13:03:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 13:03:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 13:03:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 13:03:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-18 13:03:10 - snowflake.connector.connection - INFO - closed
2025-01-18 13:03:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:04:04 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 13:04:04 - root - INFO - ```sql
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN c."condition_source_value" LIKE '696%' THEN 'Psoriasis'
            WHEN c."condition_source_value" LIKE '706%' THEN 'Acne'
            WHEN c."condition_source_value" LIKE '691%' THEN 'Atopic dermatitis'
            WHEN c."condition_source_value" = '70901' THEN 'Vitiligo'
        END AS Condition,
        c."person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE c
    WHERE
        c."condition_source_value" LIKE '696%'
        OR c."condition_source_value" LIKE '706%'
        OR c."condition_source_value" LIKE '691%'
        OR c."condition_source_value" = '70901'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT c."person_id") * 100.0) / (SELECT total FROM total_participants), 2) AS Percentage
FROM
    conditions
WHERE
    Condition IS NOT NULL
GROUP BY
    Condition;
```
2025-01-18 13:04:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 13:04:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 13:04:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 13:04:05 - snowflake.connector.connection - INFO - closed
2025-01-18 13:04:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:04:36 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 13:04:36 - root - INFO - ```sql
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN "condition_source_value" LIKE '706%' THEN 'Acne'
            WHEN "condition_source_value" LIKE '691%' THEN 'Atopic dermatitis'
            WHEN "condition_source_value" LIKE '696%' THEN 'Psoriasis'
            WHEN "condition_source_value" = '70901' THEN 'Vitiligo'
        END AS Condition,
        "person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE
    WHERE
        "condition_source_value" LIKE '706%'
        OR "condition_source_value" LIKE '691%'
        OR "condition_source_value" LIKE '696%'
        OR "condition_source_value" = '70901'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / (SELECT total FROM total_participants), 2) AS Percentage
FROM
    conditions
WHERE
    Condition IS NOT NULL
GROUP BY
    Condition;
```
2025-01-18 13:04:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 13:04:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 13:04:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 13:04:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 4
2025-01-18 13:04:37 - snowflake.connector.connection - INFO - closed
2025-01-18 13:04:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:04:38 - root - INFO - SQL:
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN "condition_source_value" LIKE '706%' THEN 'Acne'
            WHEN "condition_source_value" LIKE '691%' THEN 'Atopic dermatitis'
            WHEN "condition_source_value" LIKE '696%' THEN 'Psoriasis'
            WHEN "condition_source_value" = '70901' THEN 'Vitiligo'
        END AS Condition,
        "person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE
    WHERE
        "condition_source_value" LIKE '706%'
        OR "condition_source_value" LIKE '691%'
        OR "condition_source_value" LIKE '696%'
        OR "condition_source_value" = '70901'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / (SELECT total FROM total_participants), 2) AS Percentage
FROM
    conditions
WHERE
    Condition IS NOT NULL
GROUP BY
    Condition;
Results:
CONDITION,PERCENTAGE
Psoriasis,6.29
Atopic dermatitis,2.65
Vitiligo,1.35
Acne,6.79

2025-01-18 13:04:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 13:04:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 13:04:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 13:04:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 13:04:39 - snowflake.connector.connection - INFO - closed
2025-01-18 13:04:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:05:49 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 13:05:49 - root - INFO - ```sql
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN "condition_source_value" LIKE '696%' THEN 'Psoriasis'
            WHEN "condition_source_value" LIKE '706%' THEN 'Acne'
        END AS Condition,
        "person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE
    WHERE
        "condition_source_value" LIKE '696%'
        OR "condition_source_value" LIKE '706%'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / (SELECT total FROM total_participants), 2) AS Percentage
FROM
    conditions
WHERE
    Condition IS NOT NULL
GROUP BY
    Condition;
```
2025-01-18 13:05:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 13:05:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 13:05:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 13:05:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-18 13:05:50 - snowflake.connector.connection - INFO - closed
2025-01-18 13:05:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:05:51 - root - INFO - SQL:
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN "condition_source_value" LIKE '696%' THEN 'Psoriasis'
            WHEN "condition_source_value" LIKE '706%' THEN 'Acne'
        END AS Condition,
        "person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE
    WHERE
        "condition_source_value" LIKE '696%'
        OR "condition_source_value" LIKE '706%'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / (SELECT total FROM total_participants), 2) AS Percentage
FROM
    conditions
WHERE
    Condition IS NOT NULL
GROUP BY
    Condition;
Results:
CONDITION,PERCENTAGE
Psoriasis,6.29
Acne,6.79

2025-01-18 13:05:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 13:05:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 13:05:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 13:05:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-18 13:05:52 - snowflake.connector.connection - INFO - closed
2025-01-18 13:05:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:05:53 - root - INFO - SQL:
SELECT COUNT(*) AS "total_condition_occurrences"
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE;
Results:
total_condition_occurrences
289182385

2025-01-18 13:05:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 13:05:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 13:05:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 13:05:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 13:05:54 - snowflake.connector.connection - INFO - closed
2025-01-18 13:05:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:05:55 - root - INFO - SQL:
SELECT DISTINCT "person_id"
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE
    LIMIT 1000;
Results:
Too long, hard cut:
person_id
967336
1462074
185763
2141968
1607295
1555993
1677113
1907183
23275
717012
1305562
2055520
2262041
71816
237637
204476
1137195
1703398
563419
2064454
907041
979414
1114735
1490780
1100116
965176
761217
601150
1138788
890108
1349655
423882
689704
263433
1228512
2087353
1092764
41630
1754627
1740271
181021
897908
589069
1436258
606328
2210733
310182
2042968
205035
799483
1853026
2018990
989938
317952
754903
673316
22735
1937972
2150295
244062
1363820
1806960
1290011
714750
1914785
683882
2053200
722755
2056872
584184
1975574
92915
2171243
523515
727022
773340
580819
2077447
329123
1334076
438582
1426601
1276516
2156124
1510477
788198
385260
2312577
1461716
13240
779308
837381
1739552
1993460
1574528
2302023
94875
938102
1433381
1219105
2162329
1708756
94054
48514
45999
189148
1808067
1056644
804737
211824
2029421
965543
1751653
1194020
334033
1471848
1469133
1093089
15164
2023180
1325310
1843877
2035477
1134852
848387
1567558
1524930
14730
1597253
1326217
1510342
407552
1706831
1447720
2304927
1605150
2098616
699607
1506299
965317
701786
2097360
1490242
42582
170787
263735
2184487
1193248
2183063
564180
571759
1808386
1548519
448824
132977
802602
78323
849987
2094217
2273844
1463764
1158491
1299660
1558307
475889
1770601
616481
615605
404354
1208925
163133
1696263
1581828
140080
888385
2121389
53179
1944062
1774209
349724
1933718
2221
1108462
2242088
1665645
2274519
98324
1101435
1622872
1913562
1776283
178787
219497
2276598
94850
1303529
1775402
48880
1284184
1856797
221961
2162642
1406345
852906
106896
2146789
740819
2043281
1312983
1605765
862101
321009
2217515
1632523
171452
649522
2053071
1962769
983329
939332
1643231
725310
302972
159708
1392911
997609
853089
709631
1906442
931799
1219373
423392
613545
1838117
857917
1904177
217654
2201842
1212754
737047
2285604
2027061
1459895
2003298
2214364
1470164
514123
664159
2081451
2111138
2111004
684719
1044227
16898
1933143
8685
1049280
1816678
2023411
1457473
1878497
486261
1318406
887987
1029799
735743
1863963
1688092
722187
1203978
577106
1183615
1033041
1387205
2140119
690590
9919
486606
937456
427012
372980
188408
2186321
1017789
1185692
589212
1731056
875593
2174344
1215008
63406
698220
391594
2301036
1036782
439166
1890853
1723616
584931
1424724
2202424
1468492
1690384
1170235
63982
205044
608098
1188567
640497
35098
1136841
75671
2198906
589665
1115191
1470185
617736
1125671
1780180
898270
1187535
1306027
513554
513638
841191
1873336
959963
1289742
1641650
1272838
2290504
1985709
1357518
2055665
1216893
777018
2130222
1009751
1357621
1567660
964755
2140293
1172352
111561
1850348
924307
259119
879978
907857
904332
990397
892890
2067049
1900637
2274464
623624
235516
1063582
1696389
1416934
2250193
1032793
1090386
1587024
606449
1897761
1234009
703565
807444
1170629
59741
1282398
159458
540239
1692
1075929
888279
1616181
2293901
1790891
1962125
2196833
891398
1171778
1944439
1275195
647879
742857
986164
274829
2159475
1864648
172242
414116
72890
924977
680430
778667
602863
729153
817951
865587
440264
1355654
439172
785466
517113
1015887
1200946
2171574
2087540
327268
1361978
321554
777714
1787693
1006384
1391905
816203
377348
490461
1481663
1996934
333971
2100552
1277474
2165272
1278347
1011754
1372157
1920864
329017
1378329
2167511
768919
724751
898423
1656271
669519
1272754
453740
879797
2216474
2034747
211123
1683819
1781598
1929333
2243878
2267614
1452402
473999
895127
647475
930988
2135402
469732
1472712
2175201
20826
1409785
738020
1499076
185530
415429
489509
1438428
1896307
1391577
1371611
2313162
1056675
223603
854850
2300235
1578050
2138341
484418
3729
986627
1397352
2241945
924043
394457
2206569
2109817
317474
2197500
1808559
2115909
1438158
1090996
2089631
1976214
1688622
2184429
1406835
347323
1096853
751002
1603479
997672
1677521
975009
716215
1962449
1686759
2043557
1716170
1962658
198722
408340
519737
1946119
2061585
730885
850750
1145755
745502
1615162
1027456
1213329
722603
371648
1769790
1359066
1316631
2104606
1012352
508810
1486219
2269498
270532
131386
461293
467660
1568071
1694516
999315
988857
923304
2097356
987266
2167480
1807847
1156377
1986055
741635
74316
1808126
491090
2247421
1383757
394946
404899
1019276
925147
532584
484123
653462
2078167
41594
743389
752182
1908161
655759
1691059
2226864
1923973
1437594
2078929
509937
1401328
47475
389973
126872
1288689
1194374
1760964
516148
1076958
154347
1139357
2233272
912327
931943
1143635
53234
1865943
1003244
627878
779242
1542623
1815532
462516
2007174
1235482
1496890
1752822
747342
186257
898127
1192799
80516
372146
1669430
439798
913006
2197440
1293530
1371497
622514
1951243
347070
1334361
721698
586460
1853769
259956
80704
2041897
1309548
2215542
1183025
2193318
1910668
810677
1492710
842374
1050799
231006
1887710
964433
2018109
2294910
670479
327322
67683
911194
62611
2298921
300785
1556007
1524963
1044900
785062
1393612
1278592
2180439
1224040
1359425
410991
1565727
1294346
110027
662421
1882332
41138
242289
1234798
183019
144735
944403
1534060
1642423
2238573
228155

2025-01-18 13:05:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 13:05:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 13:05:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 13:05:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 13:05:56 - snowflake.connector.connection - INFO - closed
2025-01-18 13:05:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:05:56 - root - INFO - SQL:
SELECT "condition_source_value", "condition_concept_id"
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE
    LIMIT 1000;
Results:
Too long, hard cut:
condition_source_value,condition_concept_id
179,197230
V08,4241530
V08,4241530
V08,4241530
V08,4241530
V08,4241530
V08,4241530
V08,4241530
V08,4241530
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0090,198062
0310,4174281
0312,4347525
0312,4347525
0318,440631
0340,28060
0340,28060
0380,40489908
0380,40489908
0380,40489908
0380,40489908
0380,40489908
0380,40489908
0380,40489908
0380,40489908
0380,40489908
0380,40489908
0380,40489908
0380,40489908
0380,40489908
0380,40489908
0380,40489908
0382,0
0382,0
0382,0
0382,0
0388,132797
0388,132797
0388,132797
0388,132797
0388,132797
0388,132797
0388,132797
0388,132797
0388,132797
0388,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0400,433696
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0415,434277
0416,433405
0416,433405
0416,433405
0416,433405
0416,433405
0416,433405
0416,433405
0416,433405
0416,433405
0416,433405
0416,433405
0416,433405
0416,433405
0416,433405
0416,433405
0416,433405
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0542,140027
0549,440021
0549,440021
0549,440021
0549,440021
0549,440021
0549,440021
0579,140020
0785,440032
0796,437222
0796,437222
0940,373962
0940,373962
0940,373962
1101,140648
1101,140648
1101,140648
1102,80946
1104,133141
1104,133141
1104,133141
1104,133141
1105,137497
1119,137213
1120,29735
1120,29735
1120,29735
1120,29735
1120,29735
1120,297

2025-01-18 13:05:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 13:05:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 13:05:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 13:05:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-01-18 13:05:58 - snowflake.connector.connection - INFO - closed
2025-01-18 13:05:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:05:58 - root - INFO - SQL:
SELECT DISTINCT "concept_code", "concept_name"
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONCEPT
    WHERE "concept_code" LIKE 'L70%'
    LIMIT 1000;
Results:
concept_code,concept_name
L7035,ELECTRONIC GREIFER
L70.1,Acne conglobata
L7040,"Prehensile actuator, switch controlled"
L7009,"Electric hook, switch or myoelectric controlled, adult"
L70.0,Acne vulgaris
L70.4,Infantile acne
L7020,ELECTRONIC GREIFER
L7025,ELECTRONIC HAND
L70.9,"Acne, unspecified"
L70.5,Acne excoriee
L70,Acne
L70.3,Acne tropica
L70.8,Other acne
L7045,"Electric hook, switch or myoelectric controlled, pediatric"
L7008,"Electric hand, switch or myoelectric, controlled, pediatric"
L70.2,Acne varioliformis
L7030,ELECTRONIC HAND CONTROLLED
L7015,ELECTRONIC HAND
L7007,"Electric hand, switch or myoelectric controlled, adult"
L7010,ELECTRONIC HAND

2025-01-18 13:05:58 - root - INFO - itercount: 0
2025-01-18 13:05:58 - root - INFO - Database Name: CMS_DATA
Schema Name: CMS_CODES
DDL describes table information.
,0
table_name,HCPCS
description,
DDL,"create or replace TABLE HCPCS (
	HCPC VARCHAR(16777216),
	SEQNUM VARCHAR(16777216),
	RECID NUMBER(38,0),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216),
	PRICE1 VARCHAR(16777216),
	PRICE2 VARCHAR(16777216),
	PRICE3 VARCHAR(16777216),
	PRICE4 VARCHAR(16777216),
	MULT_PI VARCHAR(16777216),
	CIM1 VARCHAR(16777216),
	CIM2 VARCHAR(16777216),
	CIM3 VARCHAR(16777216),
	MCM1 FLOAT,
	MCM2 NUMBER(38,0),
	MCM3 VARCHAR(16777216),
	STATUTE VARCHAR(16777216),
	LABCERT1 VARCHAR(16777216),
	LABCERT2 VARCHAR(16777216),
	LABCERT3 VARCHAR(16777216),
	LABCERT4 VARCHAR(16777216),
	LABCERT5 VARCHAR(16777216),
	LABCERT6 VARCHAR(16777216),
	LABCERT7 VARCHAR(16777216),
	LABCERT8 VARCHAR(16777216),
	XREF1 VARCHAR(16777216),
	XREF2 VARCHAR(16777216),
	XREF3 VARCHAR(16777216),
	XREF4 VARCHAR(16777216),
	XREF5 VARCHAR(16777216),
	COV VARCHAR(16777216),
	ASC_GRP VARCHAR(16777216),
	ASC_DT VARCHAR(16777216),
	OPPS VARCHAR(16777216),
	OPPS_PI VARCHAR(16777216),
	OPPS_DT VARCHAR(16777216),
	PROCNOTE VARCHAR(16777216),
	BETOS VARCHAR(16777216),
	TOS1 VARCHAR(16777216),
	TOS2 VARCHAR(16777216),
	TOS3 VARCHAR(16777216),
	TOS4 VARCHAR(16777216),
	TOS5 VARCHAR(16777216),
	ANEST_BU VARCHAR(16777216),
	ADD_DT VARCHAR(16777216),
	ACT_EFF_DT VARCHAR(16777216),
	TERM_DT VARCHAR(16777216),
	ACTION_CD BOOLEAN
);"

,1
table_name,ICD10_PROCEDURES_2019
description,
DDL,"create or replace TABLE ICD10_PROCEDURES_2019 (
	""order_number"" VARCHAR(16777216),
	""pcs_code"" VARCHAR(16777216),
	""is_header_code"" BOOLEAN,
	""short_description"" VARCHAR(16777216),
	""long_description"" VARCHAR(16777216)
);"

,2
table_name,ICD9_DIAGNOSES
description,
DDL,"create or replace TABLE ICD9_DIAGNOSES (
	DIAGNOSIS_CODE VARCHAR(16777216),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216)
);"

,3
table_name,ICD10_DIAGNOSES_2019
description,
DDL,"create or replace TABLE ICD10_DIAGNOSES_2019 (
	""order_number"" VARCHAR(16777216),
	""cm_code"" VARCHAR(16777216),
	""is_header_code"" BOOLEAN,
	""short_description"" VARCHAR(16777216),
	""long_description"" VARCHAR(16777216)
);"

,4
table_name,ICD9_PROCEDURES
description,
DDL,"create or replace TABLE ICD9_PROCEDURES (
	PROCEDURE_CODE VARCHAR(16777216),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_MEDICARE
DDL describes table information.
,0
table_name,HOME_HEALTH_AGENCIES_2013
description,
DDL,"create or replace TABLE HOME_HEALTH_AGENCIES_2013 (
	""provider_id"" VARCHAR(16777216),
	""agency_name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""total_episodes_non_lupa"" NUMBER(38,0),
	""distinct_users_non_lupa"" NUMBER(38,0),
	""total_hha_charge_amount_non_lupa"" NUMBER(38,0),
	""total_hha_medicare_payment_amount_non_lupa"" NUMBER(38,0),
	""total_hha_medicare_standard_payment_amount_non_lupa"" NUMBER(38,0),
	""outlier_payments_as_a_percent_of_medicare_payment_amount_non_lupa"" NUMBER(38,0),
	""total_lupa_episodes"" NUMBER(38,0),
	""total_hha_medicare_payment_amount_for_lupas"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014']
,1
table_name,HOSPICE_PROVIDERS_2014
description,
DDL,"create or replace TABLE HOSPICE_PROVIDERS_2014 (
	""provider_id"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""hrr"" VARCHAR(16777216),
	""hospice_beneficiaries"" NUMBER(38,0),
	""total_days"" NUMBER(38,0),
	""total_medicare_payment_amount"" NUMBER(38,0),
	""total_medicare_standard_payment_amount"" NUMBER(38,0),
	""total_charge_amount"" NUMBER(38,0),
	""percent_routine_home_care_days"" NUMBER(38,0),
	""physician_services"" NUMBER(38,0),
	""home_health_visit_hours_per_day"" FLOAT,
	""skilled_nursing_visit_hours_per_day"" FLOAT,
	""social_service_visit_hours_per_day"" FLOAT,
	""total_live_discharges"" NUMBER(38,0),
	""hospice_beneficiaries_with_seven_or_fewer_hospice_care_days"" NUMBER(38,0),
	""hospice_beneficiaries_with_more_than_sixty_hospice_care_days"" NUMBER(38,0),
	""hospice_beneficiaries_with_more_than_one_hundred_eighty_hospice_care_days"" NUMBER(38,0),
	""home_health_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""skilled_nursing_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""social_service_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""average_age"" FLOAT,
	""male_hospice_beneficiaries"" NUMBER(38,0),
	""female_hospice_beneficiaries"" NUMBER(38,0),
	""white_hospice_beneficiaries"" NUMBER(38,0),
	""black_hospice_beneficiaries"" NUMBER(38,0),
	""asian_hospice_beneficiaries"" NUMBER(38,0),
	""hispanic_hospice_beneficiaries"" NUMBER(38,0),
	""other_unknown_race_hospice_beneficiaries"" NUMBER(38,0),
	""medicare_advantage_hospice_beneficiaries"" NUMBER(38,0),
	""medicaid_eligible_hospice_beneficiaries"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_cancer"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_dementia"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_stroke"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_circulatory_heart_disease"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_respiratory_disease"" NUMBER(38,0),
	""hospice_beneficiaries_with_other_primary_diagnoses"" NUMBER(38,0),
	""site_of_service_home_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_assisted_living_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_long_term_care_or_non_skilled_nursing_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_skilled_nursing_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_inpatient_hospital_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_inpatient_hospice_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_other_facility_hospice_beneficiaries"" NUMBER(38,0)
);"

,2
table_name,HOSPITAL_GENERAL_INFO
description,
DDL,"create or replace TABLE HOSPITAL_GENERAL_INFO (
	""provider_id"" VARCHAR(16777216),
	""hospital_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""phone_number"" VARCHAR(16777216),
	""hospital_type"" VARCHAR(16777216),
	""hospital_ownership"" VARCHAR(16777216),
	""emergency_services"" BOOLEAN,
	""meets_criteria_for_promoting_interoperability_of_ehrs"" BOOLEAN,
	""hospital_overall_rating"" VARCHAR(16777216),
	""hospital_overall_rating_footnote"" VARCHAR(16777216),
	""mortality_group_measure_count"" VARCHAR(16777216),
	""facility_mortaility_measures_count"" VARCHAR(16777216),
	""mortality_measures_better_count"" VARCHAR(16777216),
	""mortality_measures_no_different_count"" VARCHAR(16777216),
	""mortality_measures_worse_count"" VARCHAR(16777216),
	""mortaility_group_footnote"" VARCHAR(16777216),
	""safety_measures_count"" VARCHAR(16777216),
	""facility_care_safety_measures_count"" VARCHAR(16777216),
	""safety_measures_better_count"" VARCHAR(16777216),
	""safety_measures_no_different_count"" VARCHAR(16777216),
	""safety_measures_worse_count"" VARCHAR(16777216),
	""safety_group_footnote"" VARCHAR(16777216),
	""readmission_measures_count"" VARCHAR(16777216),
	""facility_readmission_measures_count"" VARCHAR(16777216),
	""readmission_measures_better_count"" VARCHAR(16777216),
	""readmission_measures_no_different_count"" VARCHAR(16777216),
	""readmission_measures_worse_count"" VARCHAR(16777216),
	""readmission_measures_footnote"" VARCHAR(16777216),
	""patient_experience_measures_count"" VARCHAR(16777216),
	""facility_patient_experience_measures_count"" VARCHAR(16777216),
	""patient_experience_measures_footnote"" VARCHAR(16777216),
	""timely_and_effective_care_measures_count"" VARCHAR(16777216),
	""facility_timely_and_effective_care_measures_count"" VARCHAR(16777216),
	""timely_and_effective_care_measures_footnote"" VARCHAR(16777216)
);"

,3
table_name,INPATIENT_CHARGES_2011
description,
DDL,"create or replace TABLE INPATIENT_CHARGES_2011 (
	""provider_id"" VARCHAR(16777216),
	""provider_name"" VARCHAR(16777216),
	""provider_street_address"" VARCHAR(16777216),
	""provider_city"" VARCHAR(16777216),
	""provider_state"" VARCHAR(16777216),
	""provider_zipcode"" VARCHAR(16777216),
	""drg_definition"" VARCHAR(16777216),
	""hospital_referral_region_description"" VARCHAR(16777216),
	""total_discharges"" NUMBER(38,0),
	""average_covered_charges"" FLOAT,
	""average_total_payments"" FLOAT,
	""average_medicare_payments"" FLOAT
);"

Some other tables have the similar structure: ['INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2015']
,4
table_name,NURSING_FACILITIES_2014
description,
DDL,"create or replace TABLE NURSING_FACILITIES_2014 (
	""provider_id"" VARCHAR(16777216),
	""facility_name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""total_stays"" NUMBER(38,0),
	""distinct_beneficiaries_per_provider"" NUMBER(38,0),
	""average_length_of_stays_days"" FLOAT,
	""total_snf_charge_amount"" NUMBER(38,0),
	""total_snf_medicare_allowed_amount"" NUMBER(38,0),
	""total_snf_medicare_payment_amount"" NUMBER(38,0),
	""total_snf_medicare_standard_payment_amount"" NUMBER(38,0),
	""average_age"" NUMBER(38,0),
	""male_beneficiaries"" NUMBER(38,0),
	""female_beneficiaries"" NUMBER(38,0),
	""nondual_beneficiaries"" NUMBER(38,0),
	""dual_beneficiaries"" NUMBER(38,0),
	""white_beneficiaries"" NUMBER(38,0),
	""black_beneficiaries"" NUMBER(38,0),
	""asian_pacific_islander_beneficiaries"" NUMBER(38,0),
	""hispanic_beneficiaries"" NUMBER(38,0),
	""american_indian_or_alaska_native_beneficiaries"" NUMBER(38,0),
	""other_unknown_beneficiaries"" NUMBER(38,0),
	""average_hcc_score"" FLOAT,
	""percent_of_beneficiaries_with_atrial_fibrillation"" NUMBER(38,0),
	""percent_of_beneficiaries_with_alzheimers"" NUMBER(38,0),
	""percent_of_beneficiaries_with_asthma"" NUMBER(38,0),
	""percent_of_beneficiaries_with_cancer"" NUMBER(38,0),
	""percent_of_beneficiaries_with_chf"" NUMBER(38,0),
	""percent_of_beneficiaries_with_chronic_kidney_disease"" NUMBER(38,0),
	""percent_of_beneficiaries_with_copd"" NUMBER(38,0),
	""percent_of_beneficiaries_with_depression"" NUMBER(38,0),
	""percent_of_beneficiaries_with_diabetes"" NUMBER(38,0),
	""percent_of_beneficiaries_with_hyperlipidemia"" NUMBER(38,0),
	""percent_of_beneficiaries_with_hypertension"" NUMBER(38,0),
	""percent_of_beneficiaries_with_ihd"" NUMBER(38,0),
	""percent_of_beneficiaries_with_osteoporosis"" NUMBER(38,0),
	""percent_of_beneficiaries_with_ra_oa"" NUMBER(38,0),
	""percent_of_beneficiaries_with_schizophrenia"" NUMBER(38,0),
	""percent_of_beneficiaries_with_stroke"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['NURSING_FACILITIES_2014', 'NURSING_FACILITIES_2013']
,5
table_name,OUTPATIENT_CHARGES_2012
description,
DDL,"create or replace TABLE OUTPATIENT_CHARGES_2012 (
	""provider_id"" VARCHAR(16777216),
	""provider_name"" VARCHAR(16777216),
	""provider_street_address"" VARCHAR(16777216),
	""provider_city"" VARCHAR(16777216),
	""provider_state"" VARCHAR(16777216),
	""provider_zipcode"" VARCHAR(16777216),
	""apc"" VARCHAR(16777216),
	""hospital_referral_region"" VARCHAR(16777216),
	""outpatient_services"" NUMBER(38,0),
	""average_estimated_submitted_charges"" FLOAT,
	""average_total_payments"" FLOAT
);"

Some other tables have the similar structure: ['OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2015']
,6
table_name,PART_D_PRESCRIBER_2014
description,
DDL,"create or replace TABLE PART_D_PRESCRIBER_2014 (
	""npi"" VARCHAR(16777216),
	""nppes_provider_last_org_name"" VARCHAR(16777216),
	""nppes_provider_first_name"" VARCHAR(16777216),
	""nppes_provider_city"" VARCHAR(16777216),
	""nppes_provider_state"" VARCHAR(16777216),
	""specialty_description"" VARCHAR(16777216),
	""description_flag"" VARCHAR(16777216),
	""drug_name"" VARCHAR(16777216),
	""generic_name"" VARCHAR(16777216),
	""bene_count"" NUMBER(38,0),
	""total_claim_count"" NUMBER(38,0),
	""total_day_supply"" NUMBER(38,0),
	""total_drug_cost"" FLOAT,
	""bene_count_ge65"" NUMBER(38,0),
	""bene_count_ge65_suppress_flag"" VARCHAR(16777216),
	""total_claim_count_ge65"" NUMBER(38,0),
	""ge65_suppress_flag"" VARCHAR(16777216),
	""total_day_supply_ge65"" NUMBER(38,0),
	""total_drug_cost_ge65"" FLOAT,
	""total_30_day_fill_count"" FLOAT,
	""total_30_day_fill_count_ge65"" FLOAT
);"

,7
table_name,REFERRING_DURABLE_MEDICAL_EQUIP_2013
description,
DDL,"create or replace TABLE REFERRING_DURABLE_MEDICAL_EQUIP_2013 (
	""referring_npi"" VARCHAR(16777216),
	""referring_provider_last_name_organization_name"" VARCHAR(16777216),
	""referring_provider_first_name"" VARCHAR(16777216),
	""referring_provider_middle_initial"" VARCHAR(16777216),
	""referring_provider_credentials"" VARCHAR(16777216),
	""referring_provider_gender"" VARCHAR(16777216),
	""referring_provider_entity_code"" VARCHAR(16777216),
	""referring_provider_street_1"" VARCHAR(16777216),
	""referring_provider_street_2"" VARCHAR(16777216),
	""referring_provider_city"" VARCHAR(16777216),
	""referring_provider_state"" VARCHAR(16777216),
	""referring_provider_zip"" VARCHAR(16777216),
	""referring_provider_country"" VARCHAR(16777216),
	""referring_provider_type"" VARCHAR(16777216),
	""referring_provider_type_flag"" VARCHAR(16777216),
	""number_of_suppliers"" NUMBER(38,0),
	""number_of_supplier_hcpcs"" NUMBER(38,0),
	""number_of_supplier_beneficiaries"" NUMBER(38,0),
	""number_of_supplier_claims"" NUMBER(38,0),
	""number_of_supplier_services"" NUMBER(38,0),
	""supplier_submitted_charges"" FLOAT,
	""supplier_medicare_allowed_amount"" FLOAT,
	""supplier_medicare_payment_amount"" FLOAT,
	""durable_medical_equipment_suppression_indicator"" VARCHAR(16777216),
	""number_of_durable_medical_equipment_suppliers"" NUMBER(38,0),
	""number_of_durable_medical_equipment_hcpcs"" NUMBER(38,0),
	""number_of_durable_medical_equipment_beneficiaries"" NUMBER(38,0),
	""number_of_durable_medical_equipment_claims"" NUMBER(38,0),
	""number_of_durable_medical_equipment_services"" NUMBER(38,0),
	""durable_medical_equipment_submitted_charges"" FLOAT,
	""durable_medical_equipment_medicare_allowed_amount"" FLOAT,
	""durable_medical_equipment_medicare_payment_amount"" FLOAT,
	""prosthetic_and_orthotic_suppression_indicator"" VARCHAR(16777216),
	""number_of_prosthetic_and_orthotic_suppliers"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_hcpcs"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_beneficiaries"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_claims"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_services"" NUMBER(38,0),
	""prosthetic_and_orthotic_submitted_charges"" FLOAT,
	""prosthetic_and_orthotic_medicare_allowed_amount"" FLOAT,
	""prosthetic_and_orthotic_medicare_payment_amount"" FLOAT,
	""drug_and_nutritional_suppression_indicator"" VARCHAR(16777216),
	""number_of_drug_and_nutritional_products_suppliers"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_hcpcs"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_beneficiaries"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_claims"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_services"" NUMBER(38,0),
	""drug_and_nutritional_products_submitted_charges"" FLOAT,
	""drug_and_nutritional_products_medicare_allowed_amount"" FLOAT,
	""drug_and_nutritional_products_medicare_payment_amount"" FLOAT
);"

Some other tables have the similar structure: ['REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014']
,8
table_name,PHYSICIANS_AND_OTHER_SUPPLIER_2015
description,
DDL,"create or replace TABLE PHYSICIANS_AND_OTHER_SUPPLIER_2015 (
	""npi"" VARCHAR(16777216),
	""nppes_provider_last_org_name"" VARCHAR(16777216),
	""nppes_provider_first_name"" VARCHAR(16777216),
	""nppes_provider_mi"" VARCHAR(16777216),
	""nppes_credentials"" VARCHAR(16777216),
	""nppes_provider_gender"" VARCHAR(16777216),
	""nppes_entity_code"" VARCHAR(16777216),
	""nppes_provider_street1"" VARCHAR(16777216),
	""nppes_provider_street2"" VARCHAR(16777216),
	""nppes_provider_city"" VARCHAR(16777216),
	""nppes_provider_zip"" VARCHAR(16777216),
	""nppes_provider_state"" VARCHAR(16777216),
	""nppes_provider_country"" VARCHAR(16777216),
	""provider_type"" VARCHAR(16777216),
	""medicare_participation_indicator"" VARCHAR(16777216),
	""place_of_service"" VARCHAR(16777216),
	""hcpcs_code"" VARCHAR(16777216),
	""hcpcs_description"" VARCHAR(16777216),
	""hcpcs_drug_indicator"" VARCHAR(16777216),
	""line_srvc_cnt"" FLOAT,
	""bene_unique_cnt"" NUMBER(38,0),
	""bene_day_srvc_cnt"" NUMBER(38,0),
	""average_medicare_allowed_amt"" FLOAT,
	""average_submitted_chrg_amt"" FLOAT,
	""average_medicare_payment_amt"" FLOAT,
	""average_medicare_standard_amt"" FLOAT
);"

Some other tables have the similar structure: ['PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014']
Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
DDL describes table information.
,0
table_name,CONDITION_OCCURRENCE
description,
DDL,"create or replace TABLE CONDITION_OCCURRENCE (
	""condition_occurrence_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""condition_concept_id"" NUMBER(38,0),
	""condition_start_date"" DATE,
	""condition_start_datetime"" NUMBER(38,0),
	""condition_end_date"" DATE,
	""condition_end_datetime"" NUMBER(38,0),
	""condition_type_concept_id"" NUMBER(38,0),
	""stop_reason"" VARCHAR(16777216),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""condition_source_value"" VARCHAR(16777216),
	""condition_source_concept_id"" NUMBER(38,0),
	""condition_status_source_value"" VARCHAR(16777216),
	""condition_status_concept_id"" NUMBER(38,0)
);"

,1
table_name,DRUG_ERA
description,
DDL,"create or replace TABLE DRUG_ERA (
	""drug_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""drug_era_start_date"" DATE,
	""drug_era_end_date"" DATE,
	""drug_exposure_count"" NUMBER(38,0),
	""gap_days"" NUMBER(38,0)
);"

,2
table_name,LOCATION
description,
DDL,"create or replace TABLE LOCATION (
	""location_id"" NUMBER(38,0),
	""address_1"" VARCHAR(16777216),
	""address_2"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""location_source_value"" VARCHAR(16777216)
);"

,3
table_name,PERSON
description,
DDL,"create or replace TABLE PERSON (
	""race_concept_id"" NUMBER(38,0),
	""ethnicity_concept_id"" NUMBER(38,0),
	""location_id"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""care_site_id"" NUMBER(38,0),
	""person_source_value"" VARCHAR(16777216),
	""gender_source_value"" VARCHAR(16777216),
	""gender_source_concept_id"" NUMBER(38,0),
	""race_source_value"" VARCHAR(16777216),
	""race_source_concept_id"" NUMBER(38,0),
	""ethnicity_source_value"" VARCHAR(16777216),
	""ethnicity_source_concept_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""gender_concept_id"" NUMBER(38,0),
	""year_of_birth"" NUMBER(38,0),
	""month_of_birth"" NUMBER(38,0),
	""day_of_birth"" NUMBER(38,0),
	""birth_datetime"" NUMBER(38,0)
);"

,4
table_name,CONDITION_ERA
description,
DDL,"create or replace TABLE CONDITION_ERA (
	""condition_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""condition_concept_id"" NUMBER(38,0),
	""condition_era_start_date"" DATE,
	""condition_era_end_date"" DATE,
	""condition_occurrence_count"" NUMBER(38,0)
);"

,5
table_name,DEVICE_EXPOSURE
description,
DDL,"create or replace TABLE DEVICE_EXPOSURE (
	""device_exposure_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""device_concept_id"" NUMBER(38,0),
	""device_exposure_start_date"" DATE,
	""device_exposure_start_datetime"" NUMBER(38,0),
	""device_exposure_end_date"" DATE,
	""device_exposure_end_datetime"" NUMBER(38,0),
	""device_type_concept_id"" NUMBER(38,0),
	""unique_device_id"" VARCHAR(16777216),
	""quantity"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""device_source_value"" VARCHAR(16777216),
	""device_source_concept_id"" NUMBER(38,0)
);"

,6
table_name,DOMAIN
description,
DDL,"create or replace TABLE DOMAIN (
	""domain_id"" VARCHAR(16777216),
	""domain_name"" VARCHAR(16777216),
	""domain_concept_id"" NUMBER(38,0)
);"

,7
table_name,DOSE_ERA
description,
DDL,"create or replace TABLE DOSE_ERA (
	""dose_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""unit_concept_id"" NUMBER(38,0),
	""dose_value"" FLOAT,
	""dose_era_start_date"" DATE,
	""dose_era_end_date"" DATE
);"

,8
table_name,OBSERVATION
description,
DDL,"create or replace TABLE OBSERVATION (
	""observation_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""observation_concept_id"" NUMBER(38,0),
	""observation_date"" DATE,
	""observation_datetime"" NUMBER(38,0),
	""observation_type_concept_id"" NUMBER(38,0),
	""value_as_number"" FLOAT,
	""value_as_string"" VARCHAR(16777216),
	""value_as_concept_id"" NUMBER(38,0),
	""qualifier_concept_id"" NUMBER(38,0),
	""unit_concept_id"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""observation_source_value"" VARCHAR(16777216),
	""observation_source_concept_id"" NUMBER(38,0),
	""unit_source_value"" VARCHAR(16777216),
	""qualifier_source_value"" VARCHAR(16777216)
);"

,9
table_name,COST
description,
DDL,"create or replace TABLE COST (
	""cost_id"" NUMBER(38,0),
	""cost_event_id"" NUMBER(38,0),
	""cost_domain_id"" VARCHAR(16777216),
	""cost_type_concept_id"" NUMBER(38,0),
	""currency_concept_id"" NUMBER(38,0),
	""total_charge"" FLOAT,
	""total_cost"" FLOAT,
	""total_paid"" FLOAT,
	""paid_by_payer"" FLOAT,
	""paid_by_patient"" FLOAT,
	""paid_patient_copay"" FLOAT,
	""paid_patient_coinsurance"" FLOAT,
	""paid_patient_deductible"" FLOAT,
	""paid_by_primary"" FLOAT,
	""paid_ingredient_cost"" FLOAT,
	""paid_dispensing_fee"" FLOAT,
	""payer_plan_period_id"" NUMBER(38,0),
	""amount_allowed"" FLOAT,
	""revenue_code_concept_id"" NUMBER(38,0),
	""revenue_code_source_value"" VARCHAR(16777216),
	""drg_concept_id"" NUMBER(38,0),
	""drg_source_value"" VARCHAR(16777216)
);"

,10
table_name,PROVIDER
description,
DDL,"create or replace TABLE PROVIDER (
	""provider_id"" NUMBER(38,0),
	""provider_name"" VARCHAR(16777216),
	""npi"" VARCHAR(16777216),
	""dea"" VARCHAR(16777216),
	""specialty_concept_id"" NUMBER(38,0),
	""care_site_id"" NUMBER(38,0),
	""year_of_birth"" NUMBER(38,0),
	""gender_concept_id"" NUMBER(38,0),
	""provider_source_value"" VARCHAR(16777216),
	""specialty_source_value"" VARCHAR(16777216),
	""specialty_source_concept_id"" NUMBER(38,0),
	""gender_source_value"" VARCHAR(16777216),
	""gender_source_concept_id"" NUMBER(38,0)
);"

,11
table_name,CARE_SITE
description,
DDL,"create or replace TABLE CARE_SITE (
	""care_site_id"" NUMBER(38,0),
	""care_site_name"" VARCHAR(16777216),
	""place_of_service_concept_id"" NUMBER(38,0),
	""location_id"" NUMBER(38,0),
	""care_site_source_value"" VARCHAR(16777216),
	""place_of_service_source_value"" VARCHAR(16777216)
);"

,12
table_name,CONCEPT_ANCESTOR
description,
DDL,"create or replace TABLE CONCEPT_ANCESTOR (
	""ancestor_concept_id"" NUMBER(38,0),
	""descendant_concept_id"" NUMBER(38,0),
	""min_levels_of_separation"" NUMBER(38,0),
	""max_levels_of_separation"" NUMBER(38,0)
);"

,13
table_name,CONCEPT_RELATIONSHIP
description,
DDL,"create or replace TABLE CONCEPT_RELATIONSHIP (
	""concept_id_1"" NUMBER(38,0),
	""concept_id_2"" NUMBER(38,0),
	""relationship_id"" VARCHAR(16777216),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

,14
table_name,DEATH
description,
DDL,"create or replace TABLE DEATH (
	""person_id"" NUMBER(38,0),
	""death_date"" DATE,
	""death_datetime"" NUMBER(38,0),
	""death_type_concept_id"" NUMBER(38,0),
	""cause_concept_id"" NUMBER(38,0),
	""cause_source_value"" VARCHAR(16777216),
	""cause_source_concept_id"" NUMBER(38,0)
);"

,15
table_name,DRUG_STRENGTH
description,
DDL,"create or replace TABLE DRUG_STRENGTH (
	""drug_concept_id"" NUMBER(38,0),
	""ingredient_concept_id"" NUMBER(38,0),
	""amount_value"" FLOAT,
	""amount_unit_concept_id"" NUMBER(38,0),
	""numerator_value"" FLOAT,
	""numerator_unit_concept_id"" NUMBER(38,0),
	""denominator_value"" FLOAT,
	""denominator_unit_concept_id"" NUMBER(38,0),
	""box_size"" NUMBER(38,0),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

,16
table_name,CONCEPT
description,
DDL,"create or replace TABLE CONCEPT (
	""concept_id"" NUMBER(38,0),
	""concept_name"" VARCHAR(16777216),
	""domain_id"" VARCHAR(16777216),
	""vocabulary_id"" VARCHAR(16777216),
	""concept_class_id"" VARCHAR(16777216),
	""standard_concept"" VARCHAR(16777216),
	""concept_code"" VARCHAR(16777216),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

,17
table_name,CONCEPT_CLASS
description,
DDL,"create or replace TABLE CONCEPT_CLASS (
	""concept_class_id"" VARCHAR(16777216),
	""concept_class_name"" VARCHAR(16777216),
	""concept_class_concept_id"" NUMBER(38,0)
);"

,18
table_name,DRUG_EXPOSURE
description,
DDL,"create or replace TABLE DRUG_EXPOSURE (
	""drug_type_concept_id"" NUMBER(38,0),
	""stop_reason"" VARCHAR(16777216),
	""refills"" NUMBER(38,0),
	""quantity"" FLOAT,
	""days_supply"" NUMBER(38,0),
	""sig"" VARCHAR(16777216),
	""route_concept_id"" NUMBER(38,0),
	""lot_number"" VARCHAR(16777216),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""drug_source_value"" VARCHAR(16777216),
	""drug_source_concept_id"" NUMBER(38,0),
	""route_source_value"" VARCHAR(16777216),
	""dose_unit_source_value"" VARCHAR(16777216),
	""drug_exposure_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""drug_exposure_start_date"" DATE,
	""drug_exposure_start_datetime"" NUMBER(38,0),
	""drug_exposure_end_date"" DATE,
	""drug_exposure_end_datetime"" NUMBER(38,0),
	""verbatim_end_date"" DATE
);"

,19
table_name,OBSERVATION_PERIOD
description,
DDL,"create or replace TABLE OBSERVATION_PERIOD (
	""observation_period_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""observation_period_start_date"" DATE,
	""observation_period_end_date"" DATE,
	""period_type_concept_id"" NUMBER(38,0)
);"

,20
table_name,PAYER_PLAN_PERIOD
description,
DDL,"create or replace TABLE PAYER_PLAN_PERIOD (
	""payer_concept_id"" NUMBER(38,0),
	""payer_source_value"" VARCHAR(16777216),
	""payer_source_concept_id"" NUMBER(38,0),
	""plan_concept_id"" NUMBER(38,0),
	""plan_source_value"" VARCHAR(16777216),
	""plan_source_concept_id"" NUMBER(38,0),
	""sponsor_concept_id"" NUMBER(38,0),
	""sponsor_source_value"" VARCHAR(16777216),
	""sponsor_source_concept_id"" NUMBER(38,0),
	""family_source_value"" VARCHAR(16777216),
	""stop_reason_concept_id"" NUMBER(38,0),
	""stop_reason_source_value"" VARCHAR(16777216),
	""stop_reason_source_concept_id"" NUMBER(38,0),
	""payer_plan_period_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""payer_plan_period_start_date"" DATE,
	""payer_plan_period_end_date"" DATE
);"

,21
table_name,RELATIONSHIP
description,
DDL,"create or replace TABLE RELATIONSHIP (
	""relationship_id"" VARCHAR(16777216),
	""relationship_name"" VARCHAR(16777216),
	""is_hierarchical"" VARCHAR(16777216),
	""defines_ancestry"" VARCHAR(16777216),
	""reverse_relationship_id"" VARCHAR(16777216),
	""relationship_concept_id"" NUMBER(38,0)
);"

,22
table_name,VOCABULARY
description,
DDL,"create or replace TABLE VOCABULARY (
	""vocabulary_id"" VARCHAR(16777216),
	""vocabulary_name"" VARCHAR(16777216),
	""vocabulary_reference"" VARCHAR(16777216),
	""vocabulary_version"" VARCHAR(16777216),
	""vocabulary_concept_id"" NUMBER(38,0)
);"

,23
table_name,PROCEDURE_OCCURRENCE
description,
DDL,"create or replace TABLE PROCEDURE_OCCURRENCE (
	""procedure_type_concept_id"" NUMBER(38,0),
	""modifier_concept_id"" NUMBER(38,0),
	""quantity"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""procedure_source_value"" VARCHAR(16777216),
	""procedure_source_concept_id"" NUMBER(38,0),
	""modifier_source_value"" VARCHAR(16777216),
	""procedure_occurrence_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""procedure_concept_id"" NUMBER(38,0),
	""procedure_dat"" DATE,
	""procedure_datetime"" NUMBER(38,0)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'CMS_DATA': {'CMS_CODES': ['HCPCS', 'ICD10_DIAGNOSES_2019', 'ICD10_PROCEDURES_2019', 'ICD9_DIAGNOSES', 'ICD9_PROCEDURES'], 'CMS_MEDICARE': ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014', 'HOSPICE_PROVIDERS_2014', 'HOSPITAL_GENERAL_INFO', 'INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2015', 'NURSING_FACILITIES_2013', 'NURSING_FACILITIES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2015', 'PART_D_PRESCRIBER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014'], 'CMS_SYNTHETIC_PATIENT_DATA_OMOP': ['CARE_SITE', 'CONCEPT', 'CONCEPT_ANCESTOR', 'CONCEPT_CLASS', 'CONCEPT_RELATIONSHIP', 'CONDITION_ERA', 'CONDITION_OCCURRENCE', 'COST', 'DEATH', 'DEVICE_EXPOSURE', 'DOMAIN', 'DOSE_ERA', 'DRUG_ERA', 'DRUG_EXPOSURE', 'DRUG_STRENGTH', 'LOCATION', 'OBSERVATION', 'OBSERVATION_PERIOD', 'PAYER_PLAN_PERIOD', 'PERSON', 'PROCEDURE_OCCURRENCE', 'PROVIDER', 'RELATIONSHIP', 'VOCABULARY']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table:** `CONDITION_OCCURRENCE` (in `CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP`)
  - `"condition_source_value"`: Potential usage - Contains the ICD-10-CM codes for conditions, such as L70, L20, L40, L80, including their subcategories.
  - `"person_id"`: Potential usage - Identifies unique participants associated with each condition.

- **Table:** `PERSON` (in `CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP`)
  - `"person_id"`: Potential usage - To identify the total number of participants.

**Conditions that may be used:**

- `"condition_source_value"` LIKE 'L70%' (for Acne and its subcategories)
- `"condition_source_value"` LIKE 'L20%' (for Atopic dermatitis and its subcategories)
- `"condition_source_value"` LIKE 'L40%' (for Psoriasis and its subcategories)
- `"condition_source_value"` LIKE 'L80%' (for Vitiligo and its subcategories)

---

**SQL Queries:**

1. **List distinct condition source values from `CONDITION_OCCURRENCE`:**

   ```sql
   SELECT DISTINCT "condition_source_value"
   FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE
   LIMIT 1000;
   ```

2. **Count total number of participants in the `PERSON` table:**

   ```sql
   SELECT COUNT(*) AS "total_participants"
   FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON;
   ```

3. **List distinct condition source values for Acne (codes starting with 'L70'):**

   ```sql
   SELECT DISTINCT "condition_source_value"
   FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE
   WHERE "condition_source_value" LIKE 'L70%'
   LIMIT 1000;
   ```

4. **List distinct condition source values for Atopic dermatitis (codes starting with 'L20'):**

   ```sql
   SELECT DISTINCT "condition_source_value"
   FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE
   WHERE "condition_source_value" LIKE 'L20%'
   LIMIT 1000;
   ```

5. **List distinct condition source values for Psoriasis (codes starting with 'L40'):**

   ```sql
   SELECT DISTINCT "condition_source_value"
   FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE
   WHERE "condition_source_value" LIKE 'L40%'
   LIMIT 1000;
   ```

6. **List distinct condition source values for Vitiligo (codes starting with 'L80'):**

   ```sql
   SELECT DISTINCT "condition_source_value"
   FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE
   WHERE "condition_source_value" LIKE 'L80%'
   LIMIT 1000;
   ```

7. **Select `person_id` and `condition_source_value` for Acne conditions:**

   ```sql
   SELECT "person_id", "condition_source_value"
   FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE
   WHERE "condition_source_value" LIKE 'L70%'
   LIMIT 1000;
   ```

8. **Count distinct participants with Atopic dermatitis:**

   ```sql
   SELECT COUNT(DISTINCT "person_id") AS "participants_with_atopic_dermatitis"
   FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE
   WHERE "condition_source_value" LIKE 'L20%';
   ```

9. **Count distinct participants with Psoriasis:**

   ```sql
   SELECT COUNT(DISTINCT "person_id") AS "participants_with_psoriasis"
   FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE
   WHERE "condition_source_value" LIKE 'L40%';
   ```

10. **Count distinct participants with Vitiligo:**

    ```sql
    SELECT COUNT(DISTINCT "person_id") AS "participants_with_vitiligo"
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE
    WHERE "condition_source_value" LIKE 'L80%';
    ```

11. **Select `person_id` and `condition_source_value` for Vitiligo conditions:**

    ```sql
    SELECT "person_id", "condition_source_value"
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE
    WHERE "condition_source_value" LIKE 'L80%'
    LIMIT 1000;
    ```

12. **Count total number of condition occurrences:**

    ```sql
    SELECT COUNT(*) AS "total_condition_occurrences"
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE;
    ```

13. **List distinct `person_id` values from `CONDITION_OCCURRENCE`:**

    ```sql
    SELECT DISTINCT "person_id"
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE
    LIMIT 1000;
    ```

14. **Select `condition_source_value` and `condition_concept_id` for analysis:**

    ```sql
    SELECT "condition_source_value", "condition_concept_id"
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE
    LIMIT 1000;
    ```

15. **List distinct `concept_code` and `concept_name` from `CONCEPT` table for Acne codes:**

    ```sql
    SELECT DISTINCT "concept_code", "concept_name"
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONCEPT
    WHERE "concept_code" LIKE 'L70%'
    LIMIT 1000;
    ```

These queries help in understanding the values and distributions in the relevant columns, enabling further analysis to compute the percentage of participants diagnosed with Acne, Atopic dermatitis, Psoriasis, and Vitiligo, including their subcategories defined by the specified ICD-10-CM codes.Query:
SELECT DISTINCT "condition_source_value"
   FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE
   LIMIT 1000;
Answer:
Too long, hard cut:
condition_source_value
7084
7335
7353
7395
7587
7596
8260
9500
9630
9792
9878
9986
E915
00861
04111
04611
07071
09834
20005
20014
20113
9604
09482
20034
20235
0088
1533
1551
1103
2540
2750
2900
3368
4358
5778
5780
33520
34700
36234
38612
5713
30002
01890
10081
20602
20681
22800
23331
23876
25950
29656
30010
30289
34652
35579
30723
32735
01626
4918
5834
38619
2572
1489
2758
3335
4118
4800
5227
5262
37900
1716
36922
36314
36331
36362
36403
1948
4932
7616
3235
01620
09959
01652
7059
7105
7170
7327
7463
9565
9854
V292
01610
05881
07798
20190
7482
1610
2337
2511
3159
3488
5130
30521
31289
34590
3430
5959
587
3158
38420
2389
5563
6160
1719
2150
37311
5277
3077
3817
5250
6009
6189
7484
9252
10089
3068
20592
20917
30462
32710
33389
34581
34663
35922
36032
36081
36330
36470
36631
V233
01795
36522
09882
01880
7480
8790
9559
9980
V662
01170
04181
05889
07042
07421
V092
20165
1101
4480
20280
20411
23875
25541
30393
5118
20511
20822
20953
25512
27911
27953
28869
30081
30159
30743
32381
33981
28319
3014
3139
3309
4722
5837
6030
6038
6201
6254
9472
9600
9797
09150
0538
0319
01500
36213
01571
36282
36321
7660
V392
2966
7136
7100
7507
8370
8678
8787
9518
9603
9853
V029
00329
00862
01796
04512
06640
20064
20110
20198
0380
2550
2983
3180
6258
29573
33119
34839
40391
34680
20711
23873
29182
29541
30983
33381
33399
33709
36069
32089
34611
3005
5940
6214
6227
6243
6251
6940
0362
2116
38635
01363
20253
01185
01700
36253
2210
1843
30253
36113
36132
36400
11591
7627
0382
1569
2662
3453
3558
4417
3688
5772
6253
V090
28522
28983
28989
29514
29644
33821
37854
1611
2190
4200
5969
1881
5643
4847
5208
6270
7438
8064
8631
8797
9178
9586
20973
20943
25513
30271
31235
31322
32721
32753
34672
36004
30284
30740
36231
4250
9471
V694
01703
03281
05443
07272
09389
11512
20045
08882
3708
7684
3200
20295
539
01104
36441
36236
36289
36457
36481
01140
09956
1830
1738
2720
3207
3682
5690
5941
6953
7292
9696
20283
20972
27401
30011
33811
36840
27800
0272
1600
5952
9411
24210
30181
30780
36844
2153
24921
37730
38300
7585
8780
9757
9967
00866
01110
05821
07043
13621
20202
09833
2339
4171
20412
20952
24950
25952
29581
30492
33921
33943
34561
36054
9279
2822
3454
3672
4760
4789
5246
6023
6159
6246
3213
30754
2680
01790
01085
2532
4010
4558
5070
5609
V144
03811
20073
V443
30431
38630
2706
28749
32723
33390
2533
3649
6273
V488
29635
33721
3300
3410
6200
7249
3538
5220
7313
V468
24941
38920
20955
30572
32715
34683
36210
36370
7070
7443
7445
8290
9177
9197
9739
9790
V402
V479
01753
07041
20008
11500
3819
3879
5160
5294
6151
6175
7488
9493
9686
01754
20063
20251
09841
1340
01645
7195
9495
01501
40403
01553
7266
37157
32351
1120
1548
1820
2357
2839
3102
3315
4321
4374
6989
7283
E969
08881
25000
28529
28982
29284
30301
30501
38610
25081
2141
2734
5226
8900
9245
24280
24960
29604
32724
4780
9060
7042
7137
7215
7389
7449
04103
20011
20043
20255
20481
20530
20582
20922
30270
30531
34620
36011
36063
9767
20297
4460
2705
2780
2918
3643
5063
5236
5288
5937
6140
6920
6931
0796
01200
09831
2300
36221
01601
01895
01220
1460
1510
1613
2111
2521
2564
4372
4556
6259
8500
8798
27669
28731
35781
35800
2452
9238
6169
36207
9766
9796
V026
03283
05412
05474
20042
20060
20081
2660
3360
20914
22803
30753
32729
34632
34641
2381
3023
3093
3448
4375
4957
5308
5930
6104
6148
4954
36281
8451
20156
09814
36372
6332
01642
8210
1888
1977
2443
2689
2948
2971
3013
25023
28249
29624
1532
20930
7285
7422
7595
9510
9578
V279
V411
V482
00842
01600
05444
20276
20151
20247
20380
20781
20931
23330
27731
28863
29524
30113
31211
32725
33984
31213
34622
6103
8501
9746
01380
01781
09323
9664
2739
2862
2980
4472
6145
37210
1764
7634
09189
36301
36471
38110
8420
01565
475
1123
1976
3019
3090
3568
5120
6918
04104
05479
20282
29285
30403
30481
3182
32727
6910
1504
7103
7141
2798
5600
5881
20920
4718
6176
7018
7452
8504
9517
9831
E851
V025
9760
20712
20927
27784
28802
29552
32744
33903
34610
36041
3920
20381
40400
1901
V475
00323
04511
04593
11502
13629
20013
20116
20222
20258
V253
01883
38589
38023
V271
36237
36255
7553
7140
7324
7325
8364
8600
V028
01614
07033
20022
20121
20170
09849
0090
1490
2397
3017
3340
4479
4809
5811
5964
6185
29534
30014
37652
2793
3108
3590
4801
5813
27709
33372
33523
20911
20925
20974
22801
24940
28801
29389
30402
31201
31222
32714
32743
33901
36003
2710
2889
2981
2984
3006
3091
3418
3709
5210
5229
6143
2249
01182
20226
3067
7152
20195
1448
7637
32301
36224
36285
36402
36453
01503
1125
1580
2140
2858
3007
4568
4659
5990
6825
7213
25021
25052
29042
2841
25001
30000
34580
25201
2459
2468
6279
9584
E989
V698
27787
37430
00849
30440
4958
37203
30272
32720
7039
7500
9680
9687
V483
04520
04672
05442
20224
20272
20274
20061
05310
2880
2908
3434
3759
4761
6080
2661
20912
24201
24211
29681
30110
30652
31532
35923
36019
36061
2374
01763
36335
36350
36352
01751
7328
7517
8280
8748
8788
9934
V272
V661
00841
03641
09489
11515
19882
20070
20084
20206
9127
0414
1728
1978
1983
2832
4430
4732
5168
4489
23332
24220
25202
29633
30781
34690
40310
34460
5961
4738
23872
29564
1321
29020
34489
4378
34
Query:
SELECT COUNT(*) AS "total_participants"
   FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON;
Answer:
total_participants
2326856
Query:
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN c."condition_source_value" LIKE '706%' THEN 'Acne'
            WHEN c."condition_source_value" LIKE '691%' THEN 'Atopic dermatitis'
            WHEN c."condition_source_value" LIKE '696%' THEN 'Psoriasis'
            WHEN c."condition_source_value" = '70901' THEN 'Vitiligo'
        END AS Condition,
        c."person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE c
    WHERE
        c."condition_source_value" LIKE '706%'
        OR c."condition_source_value" LIKE '691%'
        OR c."condition_source_value" LIKE '696%'
        OR c."condition_source_value" = '70901'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / t.total, 2) AS Percentage
FROM
    conditions
    CROSS JOIN total_participants t
GROUP BY
    Condition, t.total;
Answer:
CONDITION,PERCENTAGE
Psoriasis,6.29
Atopic dermatitis,2.65
Vitiligo,1.35
Acne,6.79
Query:
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN c."condition_source_value" LIKE '706%' THEN 'Acne'
            WHEN c."condition_source_value" LIKE '691%' THEN 'Atopic dermatitis'
            WHEN c."condition_source_value" LIKE '696%' THEN 'Psoriasis'
            WHEN c."condition_source_value" LIKE '709%' THEN 'Vitiligo'
        END AS Condition,
        c."person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE c
    WHERE
        c."condition_source_value" LIKE '706%'
        OR c."condition_source_value" LIKE '691%'
        OR c."condition_source_value" LIKE '696%'
        OR c."condition_source_value" LIKE '709%'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / t.total, 2) AS Percentage
FROM
    conditions
    CROSS JOIN total_participants t
WHERE Condition IS NOT NULL
GROUP BY
    Condition, t.total;
Answer:
CONDITION,PERCENTAGE
Psoriasis,6.29
Atopic dermatitis,2.65
Vitiligo,14.29
Acne,6.79
Query:
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN LOWER(concept."concept_name") LIKE '%acne%' THEN 'Acne'
            WHEN LOWER(concept."concept_name") LIKE '%atopic dermatitis%' THEN 'Atopic dermatitis'
            WHEN LOWER(concept."concept_name") LIKE '%psoriasis%' THEN 'Psoriasis'
            WHEN LOWER(concept."concept_name") LIKE '%vitiligo%' THEN 'Vitiligo'
        END AS Condition,
        c."person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE c
        JOIN CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONCEPT concept
          ON c."condition_source_concept_id" = concept."concept_id"
    WHERE
        LOWER(concept."concept_name") LIKE '%acne%'
        OR LOWER(concept."concept_name") LIKE '%atopic dermatitis%'
        OR LOWER(concept."concept_name") LIKE '%psoriasis%'
        OR LOWER(concept."concept_name") LIKE '%vitiligo%'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / t.total, 2) AS Percentage
FROM
    conditions
    CROSS JOIN total_participants t
WHERE Condition IS NOT NULL
GROUP BY
    Condition, t.total;
Answer:
CONDITION,PERCENTAGE
Psoriasis,4.90
Atopic dermatitis,2.37
Vitiligo,1.35
Acne,1.16
Query:
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN c."condition_source_value" LIKE 'L70%' THEN 'Acne'
            WHEN c."condition_source_value" LIKE 'L20%' THEN 'Atopic dermatitis'
            WHEN c."condition_source_value" LIKE 'L40%' THEN 'Psoriasis'
            WHEN c."condition_source_value" LIKE 'L80%' THEN 'Vitiligo'
            ELSE NULL
        END AS Condition,
        c."person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE c
    WHERE
        c."condition_source_value" LIKE 'L70%'
        OR c."condition_source_value" LIKE 'L20%'
        OR c."condition_source_value" LIKE 'L40%'
        OR c."condition_source_value" LIKE 'L80%'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / (SELECT total FROM total_participants), 2) AS Percentage
FROM
    conditions
WHERE
    Condition IS NOT NULL
GROUP BY
    Condition;
Answer:
No data found for the specified query.
Query:
SELECT
    'Psoriasis' AS Condition,
    ROUND((COUNT(DISTINCT c."person_id") * 100.0) / (
        SELECT COUNT(*) FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
    ), 2) AS Percentage
FROM
    CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE c
WHERE
    c."condition_source_value" LIKE '696%';
Answer:
CONDITION,PERCENTAGE
Psoriasis,6.29
Query:
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN c."condition_source_value" LIKE '696%' THEN 'Psoriasis'
            WHEN c."condition_source_value" LIKE '706%' THEN 'Acne'
        END AS Condition,
        c."person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE c
    WHERE
        c."condition_source_value" LIKE '696%'
        OR c."condition_source_value" LIKE '706%'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / (SELECT total FROM total_participants), 2) AS Percentage
FROM
    conditions
WHERE
    Condition IS NOT NULL
GROUP BY
    Condition;
Answer:
CONDITION,PERCENTAGE
Psoriasis,6.29
Acne,6.79
Query:
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN c."condition_source_value" LIKE '696%' THEN 'Psoriasis'
            WHEN c."condition_source_value" LIKE '706%' THEN 'Acne'
            WHEN c."condition_source_value" LIKE '691%' THEN 'Atopic dermatitis'
            WHEN c."condition_source_value" LIKE '709%' THEN 'Vitiligo'
        END AS Condition,
        c."person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE c
    WHERE
        c."condition_source_value" LIKE '696%'
        OR c."condition_source_value" LIKE '706%'
        OR c."condition_source_value" LIKE '691%'
        OR c."condition_source_value" LIKE '709%'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / (SELECT total FROM total_participants), 2) AS Percentage
FROM
    conditions
WHERE
    Condition IS NOT NULL
GROUP BY
    Condition;
Answer:
CONDITION,PERCENTAGE
Psoriasis,6.29
Atopic dermatitis,2.65
Vitiligo,14.29
Acne,6.79
Query:
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN "condition_source_value" LIKE '706%' THEN 'Acne'
            WHEN "condition_source_value" LIKE '691%' THEN 'Atopic dermatitis'
            WHEN "condition_source_value" LIKE '696%' THEN 'Psoriasis'
            WHEN "condition_source_value" = '70901' THEN 'Vitiligo'
        END AS Condition,
        "person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE
    WHERE
        "condition_source_value" LIKE '706%'
        OR "condition_source_value" LIKE '691%'
        OR "condition_source_value" LIKE '696%'
        OR "condition_source_value" = '70901'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / (SELECT total FROM total_participants), 2) AS Percentage
FROM
    conditions
WHERE
    Condition IS NOT NULL
GROUP BY
    Condition;
Answer:
CONDITION,PERCENTAGE
Psoriasis,6.29
Atopic dermatitis,2.65
Vitiligo,1.35
Acne,6.79
Query:
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON
),
conditions AS (
    SELECT
        CASE
            WHEN "condition_source_value" LIKE '696%' THEN 'Psoriasis'
            WHEN "condition_source_value" LIKE '706%' THEN 'Acne'
        END AS Condition,
        "person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE
    WHERE
        "condition_source_value" LIKE '696%'
        OR "condition_source_value" LIKE '706%'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / (SELECT total FROM total_participants), 2) AS Percentage
FROM
    conditions
WHERE
    Condition IS NOT NULL
GROUP BY
    Condition;
Answer:
CONDITION,PERCENTAGE
Psoriasis,6.29
Acne,6.79
Query:
SELECT COUNT(*) AS "total_condition_occurrences"
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE;
Answer:
total_condition_occurrences
289182385
Query:
SELECT DISTINCT "person_id"
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE
    LIMIT 1000;
Answer:
Too long, hard cut:
person_id
967336
1462074
185763
2141968
1607295
1555993
1677113
1907183
23275
717012
1305562
2055520
2262041
71816
237637
204476
1137195
1703398
563419
2064454
907041
979414
1114735
1490780
1100116
965176
761217
601150
1138788
890108
1349655
423882
689704
263433
1228512
2087353
1092764
41630
1754627
1740271
181021
897908
589069
1436258
606328
2210733
310182
2042968
205035
799483
1853026
2018990
989938
317952
754903
673316
22735
1937972
2150295
244062
1363820
1806960
1290011
714750
1914785
683882
2053200
722755
2056872
584184
1975574
92915
2171243
523515
727022
773340
580819
2077447
329123
1334076
438582
1426601
1276516
2156124
1510477
788198
385260
2312577
1461716
13240
779308
837381
1739552
1993460
1574528
2302023
94875
938102
1433381
1219105
2162329
1708756
94054
48514
45999
189148
1808067
1056644
804737
211824
2029421
965543
1751653
1194020
334033
1471848
1469133
1093089
15164
2023180
1325310
1843877
2035477
1134852
848387
1567558
1524930
14730
1597253
1326217
1510342
407552
1706831
1447720
2304927
1605150
2098616
699607
1506299
965317
701786
2097360
1490242
42582
170787
263735
2184487
1193248
2183063
564180
571759
1808386
1548519
448824
132977
802602
78323
849987
2094217
2273844
1463764
1158491
1299660
1558307
475889
1770601
616481
615605
404354
1208925
163133
1696263
1581828
140080
888385
2121389
53179
1944062
1774209
349724
1933718
2221
1108462
2242088
1665645
2274519
98324
1101435
1622872
1913562
1776283
178787
219497
2276598
94850
1303529
1775402
48880
1284184
1856797
221961
2162642
1406345
852906
106896
2146789
740819
2043281
1312983
1605765
862101
321009
2217515
1632523
171452
649522
2053071
1962769
983329
939332
1643231
725310
302972
159708
1392911
997609
853089
709631
1906442
931799
1219373
423392
613545
1838117
857917
1904177
217654
2201842
1212754
737047
2285604
2027061
1459895
2003298
2214364
1470164
514123
664159
2081451
2111138
2111004
684719
1044227
16898
1933143
8685
1049280
1816678
2023411
1457473
1878497
486261
1318406
887987
1029799
735743
1863963
1688092
722187
1203978
577106
1183615
1033041
1387205
2140119
690590
9919
486606
937456
427012
372980
188408
2186321
1017789
1185692
589212
1731056
875593
2174344
1215008
63406
698220
391594
2301036
1036782
439166
1890853
1723616
584931
1424724
2202424
1468492
1690384
1170235
63982
205044
608098
1188567
640497
35098
1136841
75671
2198906
589665
1115191
1470185
617736
1125671
1780180
898270
1187535
1306027
513554
513638
841191
1873336
959963
1289742
1641650
1272838
2290504
1985709
1357518
2055665
1216893
777018
2130222
1009751
1357621
1567660
964755
2140293
1172352
111561
1850348
924307
259119
879978
907857
904332
990397
892890
2067049
1900637
2274464
623624
235516
1063582
1696389
1416934
2250193
1032793
1090386
1587024
606449
1897761
1234009
703565
807444
1170629
59741
1282398
159458
540239
1692
1075929
888279
1616181
2293901
1790891
1962125
2196833
891398
1171778
1944439
1275195
647879
742857
986164
274829
2159475
1864648
172242
414116
72890
924977
680430
778667
602863
729153
817951
865587
440264
1355654
439172
785466
517113
1015887
1200946
2171574
2087540
327268
1361978
321554
777714
1787693
1006384
1391905
816203
377348
490461
1481663
1996934
333971
2100552
1277474
2165272
1278347
1011754
1372157
1920864
329017
1378329
2167511
768919
724751
898423
1656271
669519
1272754
453740
879797
2216474
2034747
211123
1683819
1781598
1929333
2243878
2267614
1452402
473999
895127
647475
930988
2135402
469732
1472712
2175201
20826
1409785
738020
1499076
185530
415429
489509
1438428
1896307
1391577
1371611
2313162
1056675
223603
854850
2300235
1578050
2138341
484418
3729
986627
1397352
2241945
924043
394457
2206569
2109817
317474
2197500
1808559
2115909
1438158
1090996
2089631
1976214
1688622
2184429
1406835
347323
1096853
751002
1603479
997672
1677521
975009
716215
1962449
1686759
2043557
1716170
1962658
198722
408340
519737
1946119
2061585
730885
850750
1145755
745502
1615162
1027456
1213329
722603
371648
1769790
1359066
1316631
2104606
1012352
508810
1486219
2269498
270532
131386
461293
467660
1568071
1694516
999315
988857
923304
2097356
987266
2167480
1807847
1156377
1986055
741635
74316
1808126
491090
2247421
1383757
394946
404899
1019276
925147
532584
484123
653462
2078167
41594
743389
752182
1908161
655759
1691059
2226864
1923973
1437594
2078929
509937
1401328
47475
389973
126872
1288689
1194374
1760964
516148
1076958
154347
1139357
2233272
912327
931943
1143635
53234
1865943
1003244
627878
779242
1542623
1815532
462516
2007174
1235482
1496890
1752822
747342
186257
898127
1192799
80516
372146
1669430
439798
913006
2197440
1293530
1371497
622514
1951243
347070
1334361
721698
586460
1853769
259956
80704
2041897
1309548
2215542
1183025
2193318
1910668
810677
1492710
842374
1050799
231006
1887710
964433
2018109
2294910
670479
327322
67683
911194
62611
2298921
300785
1556007
1524963
1044900
785062
1393612
1278592
2180439
1224040
1359425
410991
1565727
1294346
110027
662421
1882332
41138
242289
1234798
183019
144735
944403
1534060
1642423
2238573
228155
Query:
SELECT "condition_source_value", "condition_concept_id"
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONDITION_OCCURRENCE
    LIMIT 1000;
Answer:
Too long, hard cut:
condition_source_value,condition_concept_id
179,197230
V08,4241530
V08,4241530
V08,4241530
V08,4241530
V08,4241530
V08,4241530
V08,4241530
V08,4241530
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0088,198678
0090,198062
0310,4174281
0312,4347525
0312,4347525
0318,440631
0340,28060
0340,28060
0380,40489908
0380,40489908
0380,40489908
0380,40489908
0380,40489908
0380,40489908
0380,40489908
0380,40489908
0380,40489908
0380,40489908
0380,40489908
0380,40489908
0380,40489908
0380,40489908
0380,40489908
0382,0
0382,0
0382,0
0382,0
0388,132797
0388,132797
0388,132797
0388,132797
0388,132797
0388,132797
0388,132797
0388,132797
0388,132797
0388,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0389,132797
0400,433696
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0413,436339
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0414,440320
0415,434277
0416,433405
0416,433405
0416,433405
0416,433405
0416,433405
0416,433405
0416,433405
0416,433405
0416,433405
0416,433405
0416,433405
0416,433405
0416,433405
0416,433405
0416,433405
0416,433405
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0417,438064
0542,140027
0549,440021
0549,440021
0549,440021
0549,440021
0549,440021
0549,440021
0579,140020
0785,440032
0796,437222
0796,437222
0940,373962
0940,373962
0940,373962
1101,140648
1101,140648
1101,140648
1102,80946
1104,133141
1104,133141
1104,133141
1104,133141
1105,137497
1119,137213
1120,29735
1120,29735
1120,29735
1120,29735
1120,29735
1120,297
Query:
SELECT DISTINCT "concept_code", "concept_name"
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONCEPT
    WHERE "concept_code" LIKE 'L70%'
    LIMIT 1000;
Answer:
concept_code,concept_name
L7035,ELECTRONIC GREIFER
L70.1,Acne conglobata
L7040,"Prehensile actuator, switch controlled"
L7009,"Electric hook, switch or myoelectric controlled, adult"
L70.0,Acne vulgaris
L70.4,Infantile acne
L7020,ELECTRONIC GREIFER
L7025,ELECTRONIC HAND
L70.9,"Acne, unspecified"
L70.5,Acne excoriee
L70,Acne
L70.3,Acne tropica
L70.8,Other acne
L7045,"Electric hook, switch or myoelectric controlled, pediatric"
L7008,"Electric hand, switch or myoelectric, controlled, pediatric"
L70.2,Acne varioliformis
L7030,ELECTRONIC HAND CONTROLLED
L7015,ELECTRONIC HAND
L7007,"Electric hand, switch or myoelectric controlled, adult"
L7010,ELECTRONIC HAND
End Exploring Related Columns
Task: Could you provide the percentage of participants for standard acne, atopic dermatitis, psoriasis, and vitiligo defined by the International Classification of Diseases 10-CM(ICD-10-CM), including their subcategories? The ICD-10 codes are: Acne (L70), Atopic dermatitis (L20), Psoriasis (L40), and Vitiligo (L80). 

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: SELECT S."Column_Name" FROM {Database Name}.{Schema Name}.{Table_name} (ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Condition,Percentage
Acne:str,percentage:float
Atopic dermatitis:str,percentage:float
Psoriasis:str,percentage:float
Vitiligo:str,percentage:float
```

The table above represents the percentage of participants diagnosed with Acne (L70), Atopic dermatitis (L20), Psoriasis (L40), and Vitiligo (L80), including all their subcategories as defined by the ICD-10-CM codes..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'CMS_DATA': {'CMS_CODES': ['HCPCS', 'ICD10_DIAGNOSES_2019', 'ICD10_PROCEDURES_2019', 'ICD9_DIAGNOSES', 'ICD9_PROCEDURES'], 'CMS_MEDICARE': ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014', 'HOSPICE_PROVIDERS_2014', 'HOSPITAL_GENERAL_INFO', 'INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2015', 'NURSING_FACILITIES_2013', 'NURSING_FACILITIES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2015', 'PART_D_PRESCRIBER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014'], 'CMS_SYNTHETIC_PATIENT_DATA_OMOP': ['CARE_SITE', 'CONCEPT', 'CONCEPT_ANCESTOR', 'CONCEPT_CLASS', 'CONCEPT_RELATIONSHIP', 'CONDITION_ERA', 'CONDITION_OCCURRENCE', 'COST', 'DEATH', 'DEVICE_EXPOSURE', 'DOMAIN', 'DOSE_ERA', 'DRUG_ERA', 'DRUG_EXPOSURE', 'DRUG_STRENGTH', 'LOCATION', 'OBSERVATION', 'OBSERVATION_PERIOD', 'PAYER_PLAN_PERIOD', 'PERSON', 'PROCEDURE_OCCURRENCE', 'PROVIDER', 'RELATIONSHIP', 'VOCABULARY']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
Keep all decimals to four decimal places.

2025-01-18 13:06:46 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 13:06:46 - root - INFO - ```sql
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP."PERSON"
),
conditions AS (
    SELECT
        CASE
            WHEN concept."concept_code" LIKE 'L70%' THEN 'Acne'
            WHEN concept."concept_code" LIKE 'L20%' THEN 'Atopic dermatitis'
            WHEN concept."concept_code" LIKE 'L40%' THEN 'Psoriasis'
            WHEN concept."concept_code" LIKE 'L80%' THEN 'Vitiligo'
        END AS Condition,
        c."person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP."CONDITION_OCCURRENCE" c
        JOIN CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP."CONCEPT" concept
            ON c."condition_source_concept_id" = concept."concept_id"
    WHERE
        concept."concept_code" LIKE 'L70%'
        OR concept."concept_code" LIKE 'L20%'
        OR concept."concept_code" LIKE 'L40%'
        OR concept."concept_code" LIKE 'L80%'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / (SELECT total FROM total_participants), 4) AS Percentage
FROM
    conditions
WHERE Condition IS NOT NULL
GROUP BY
    Condition
ORDER BY
    Condition;
```
2025-01-18 13:06:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 13:06:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 13:06:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 13:06:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 13:06:47 - snowflake.connector.connection - INFO - closed
2025-01-18 13:06:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:06:48 - root - INFO - itercount: 1
2025-01-18 13:06:48 - root - INFO - No data found for the specified query.

2025-01-18 13:06:48 - root - INFO - Input sql:
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP."PERSON"
),
conditions AS (
    SELECT
        CASE
            WHEN concept."concept_code" LIKE 'L70%' THEN 'Acne'
            WHEN concept."concept_code" LIKE 'L20%' THEN 'Atopic dermatitis'
            WHEN concept."concept_code" LIKE 'L40%' THEN 'Psoriasis'
            WHEN concept."concept_code" LIKE 'L80%' THEN 'Vitiligo'
        END AS Condition,
        c."person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP."CONDITION_OCCURRENCE" c
        JOIN CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP."CONCEPT" concept
            ON c."condition_source_concept_id" = concept."concept_id"
    WHERE
        concept."concept_code" LIKE 'L70%'
        OR concept."concept_code" LIKE 'L20%'
        OR concept."concept_code" LIKE 'L40%'
        OR concept."concept_code" LIKE 'L80%'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / (SELECT total FROM total_participants), 4) AS Percentage
FROM
    conditions
WHERE Condition IS NOT NULL
GROUP BY
    Condition
ORDER BY
    Condition;
The error information is:
 No data found for the specified query.

2025-01-18 13:07:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 13:07:29 - root - INFO - It appears that you're receiving the error "No data found for the specified query" because the `CONCEPT` table and the `CONDITION_OCCURRENCE` table in your database contain **ICD-9-CM codes** rather than **ICD-10-CM codes**. The ICD-10 codes (`L70%`, `L20%`, `L40%`, `L80%`) you're using in your query do not match any records in the database, resulting in no data being returned.

To resolve this issue, we can adjust the query to use the corresponding **ICD-9-CM codes** for the conditions:

- **Acne**: Codes starting with `706`
- **Atopic dermatitis**: Codes starting with `691`
- **Psoriasis**: Codes starting with `696`
- **Vitiligo**: Code `709.01` (or `70901` without the dot)

Here's the corrected SQL query using ICD-9-CM codes:

```sql
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP."PERSON"
),
conditions AS (
    SELECT
        CASE
            WHEN c."condition_source_value" LIKE '706%' THEN 'Acne'
            WHEN c."condition_source_value" LIKE '691%' THEN 'Atopic dermatitis'
            WHEN c."condition_source_value" LIKE '696%' THEN 'Psoriasis'
            WHEN c."condition_source_value" = '70901' THEN 'Vitiligo'
        END AS Condition,
        c."person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP."CONDITION_OCCURRENCE" c
    WHERE
        c."condition_source_value" LIKE '706%'
        OR c."condition_source_value" LIKE '691%'
        OR c."condition_source_value" LIKE '696%'
        OR c."condition_source_value" = '70901'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / (SELECT total FROM total_participants), 4) AS Percentage
FROM
    conditions
WHERE
    Condition IS NOT NULL
GROUP BY
    Condition
ORDER BY
    Condition;
```

**Explanation:**

- **total_participants**: Counts the total number of participants in the `PERSON` table.
- **conditions**: Selects participants diagnosed with the specified conditions using ICD-9-CM codes from the `CONDITION_OCCURRENCE` table.
- The `CASE` statement categorizes the conditions based on the ICD-9-CM codes.
- The final `SELECT` calculates the percentage of participants for each condition.

**Note:** Ensure that you have the appropriate permissions to access the database and that the table and column names are correct, including case sensitivity.

**Example Output:**

Assuming the query runs successfully, you might get a result like:

```csv
Condition,Percentage
Acne,6.7900
Atopic dermatitis,2.6500
Psoriasis,6.2900
Vitiligo,1.3500
```

This table represents the percentage of participants diagnosed with Acne, Atopic dermatitis, Psoriasis, and Vitiligo, including all their subcategories as defined by the ICD-9-CM codes.

**If you have ICD-10-CM codes stored elsewhere:**

If your database contains ICD-10-CM codes in another table or column, please provide details, and I can modify the query accordingly. Alternatively, if you wish to map ICD-9-CM codes to ICD-10-CM codes, additional steps may be required, such as joining with a mapping table.
2025-01-18 13:07:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 13:07:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 13:07:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 13:07:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 4
2025-01-18 13:07:30 - snowflake.connector.connection - INFO - closed
2025-01-18 13:07:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:07:31 - root - INFO - itercount: 2
2025-01-18 13:07:31 - root - INFO - 0
2025-01-18 13:07:31 - root - INFO - results: 
CONDITION,PERCENTAGE
Acne,6.7944
Atopic dermatitis,2.6481
Psoriasis,6.2877
Vitiligo,1.3485


2025-01-18 13:07:31 - root - INFO - Please check the answer again by reviewing Could you provide the percentage of participants for standard acne, atopic dermatitis, psoriasis, and vitiligo defined by the International Classification of Diseases 10-CM(ICD-10-CM), including their subcategories? The ICD-10 codes are: Acne (L70), Atopic dermatitis (L20), Psoriasis (L40), and Vitiligo (L80). , reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Condition,Percentage
Acne:str,percentage:float
Atopic dermatitis:str,percentage:float
Psoriasis:str,percentage:float
Vitiligo:str,percentage:float
```

The table above represents the percentage of participants diagnosed with Acne (L70), Atopic dermatitis (L20), Psoriasis (L40), and Vitiligo (L80), including all their subcategories as defined by the ICD-10-CM codes. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
CONDITION,PERCENTAGE
Acne,6.7944
Atopic dermatitis,2.6481
Psoriasis,6.2877
Vitiligo,1.3485
Current sql:
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP."PERSON"
),
conditions AS (
    SELECT
        CASE
            WHEN c."condition_source_value" LIKE '706%' THEN 'Acne'
            WHEN c."condition_source_value" LIKE '691%' THEN 'Atopic dermatitis'
            WHEN c."condition_source_value" LIKE '696%' THEN 'Psoriasis'
            WHEN c."condition_source_value" = '70901' THEN 'Vitiligo'
        END AS Condition,
        c."person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP."CONDITION_OCCURRENCE" c
    WHERE
        c."condition_source_value" LIKE '706%'
        OR c."condition_source_value" LIKE '691%'
        OR c."condition_source_value" LIKE '696%'
        OR c."condition_source_value" = '70901'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / (SELECT total FROM total_participants), 4) AS Percentage
FROM
    conditions
WHERE
    Condition IS NOT NULL
GROUP BY
    Condition
ORDER BY
    Condition;
2025-01-18 13:08:16 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 13:08:16 - root - INFO - ```sql
WITH total_participants AS (
    SELECT COUNT(*) AS total
    FROM CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP."PERSON"
),
conditions AS (
    SELECT
        CASE
            WHEN c."condition_source_value" LIKE '706%' THEN 'Acne'
            WHEN c."condition_source_value" LIKE '691%' THEN 'Atopic dermatitis'
            WHEN c."condition_source_value" LIKE '696%' THEN 'Psoriasis'
            WHEN c."condition_source_value" LIKE '70901' THEN 'Vitiligo'
        END AS Condition,
        c."person_id"
    FROM
        CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP."CONDITION_OCCURRENCE" c
    WHERE
        c."condition_source_value" LIKE '706%'
        OR c."condition_source_value" LIKE '691%'
        OR c."condition_source_value" LIKE '696%'
        OR c."condition_source_value" = '70901'
)
SELECT
    Condition,
    ROUND((COUNT(DISTINCT "person_id") * 100.0) / (SELECT total FROM total_participants), 4) AS Percentage
FROM
    conditions
WHERE
    Condition IS NOT NULL
GROUP BY
    Condition
ORDER BY
    Condition;
```

```csv
Condition,Percentage
Acne,6.7944
Atopic dermatitis,2.6481
Psoriasis,6.2877
Vitiligo,1.3485
```
2025-01-18 13:08:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 13:08:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 13:08:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 13:08:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 4
2025-01-18 13:08:18 - snowflake.connector.connection - INFO - closed
2025-01-18 13:08:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 13:08:19 - root - INFO - itercount: 3
2025-01-18 13:08:19 - root - INFO - 0
2025-01-18 13:08:19 - root - INFO - Total iteration counts: 3
