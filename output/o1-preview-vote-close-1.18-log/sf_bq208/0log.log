2025-01-18 09:05:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 09:06:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 09:06:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:06:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:06:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:06:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 09:06:15 - snowflake.connector.connection - INFO - closed
2025-01-18 09:06:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:06:16 - root - INFO - SQL:
SELECT DISTINCT "usaf"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
   LIMIT 1000;
Results:
Too long, hard cut:
usaf
007018
007026
007070
008268
008307
010016
010017
010071
010190
010240
010303
010320
010340
010470
010510
010530
010610
010660
010671
010750
010884
011133
011501
011630
011691
011700
011760
011890
012273
012580
012960
013220
013720
014110
014740
011340
011490
011530
011720
011980
012210
012350
012823
013160
013280
013410
013671
013839
014450
014460
015000
020450
020480
020560
020880
020960
021560
022340
014321
014970
021160
021360
023100
023230
010670
011030
011051
011380
011540
011680
011840
011930
011960
012070
012150
012310
012430
012740
012780
012891
013250
013471
014750
021180
021460
022160
023540
011100
011130
012390
012520
013060
013180
013510
013743
014000
014010
014035
014280
014330
014611
014960
020180
020200
020260
020711
021420
021580
021820
021900
022240
022620
022640
022660
022700
022740
022780
022890
023000
023180
023240
023700
024060
024240
024280
024620
012161
013390
013560
013690
014211
020320
020510
020840
020860
021040
021200
021230
021270
021290
021600
021720
021850
022060
022440
022920
023140
023191
023280
024120
024220
024510
024740
025020
025040
021220
021300
025070
025080
025120
025150
025940
026500
027030
027130
027150
027290
027620
028744
029600
030010
030400
030490
030560
030770
030850
031190
031500
032230
032610
033380
033631
034040
035540
035671
036010
036150
036530
037850
039650
033220
039740
012091
012920
012950
013910
024390
011310
011560
012360
012771
012890
013790
013801
014120
020120
020920
020970
021080
021120
021280
021430
021440
021590
021640
022000
022861
023110
023420
023600
023750
023980
024000
024100
024300
024360
024710
024950
011841
012160
012980
013591
014320
020230
020430
020600
020800
021050
021520
022220
022320
022330
022480
022520
022580
022830
022960
023020
023030
023040
023130
023201
023260
023300
023321
023360
023451
023490
023640
023760
024090
024130
024161
024200
024330
024373
024440
024650
024730
024850
024990
021450
022170
022560
023060
023370
023460
024480
025010
025100
025105
025210
025230
025240
025270
025300
025330
025361
025430
025530
025531
025550
025640
025720
025950
025970
026020
026030
026060
026090
026200
026240
026241
026260
026270
026390
026540
026850
027160
027280
028230
028480
028520
028670
028790
029010
029120
029210
029244
029530
029650
029750
030040
030065
030070
030130
030250
030270
030330
030370
030380
030410
030460
030500
030530
030540
030610
030640
030650
030670
030710
030840
030890
030900
030930
031020
031053
031060
031070
031160
031200
031210
031300
031404
031411
031413
031450
031490
031540
031560
031570
031610
031620
031680
031770
031850
032050
032110
032150
032280
032410
032490
032800
032910
033030
033080
033090
033230
033290
033420
033430
033550
033600
034030
034080
034150
034610
034870
034875
034925
034960
035010
035050
035051
035210
035250
035460
035480
035500
035510
035520
035571
035621
035630
035860
035905
035953
035963
036060
036100
036140
036240
036280
036283
036383
036551
037010
037170
037435
037480
037630
037740
037815
037900
037950
038020
038040
038110
038170
038273
038341
038410
038450
038550
038600
038630
038793
038860
039090
039130
039600
039610
039790
040230
040440
040450
040810
041100
042070
042740
042800
043100
043301
044160
049999
060050
060080
061655
025660
027480
029730
030570
030755
030760
031051
031390
031470
031640
032070
032370
033390
033480
033880
034020
034053
034145
034530
035031
035270
035360
035471
035490
035570
035580
035623
035830
035930
036330
036550
036731
036740
037061
037440
037450
037640
037670
038150
038320
038330
038740
039030
039050
039220
039520
039640
040500
040530
040590
040750
040831
040910
040920
041270
042025
042160
042163
042350
042400
044520
060090
060130
060335
060760
061730
061790
038840
040680
060620
062440
062530
062697
063850
064160
064480
064505
064520
064620
064740
065850
065970
066840
067430
067570
067881
068480
068500
070160
070330
070570
070590
070700
070891
071080
071230
071540
071660
071710
071790
071860
072760
072950
072955
074385
074420
075173
075290
075615
075860
075870
076303
076310
076510
076560
076630
076770
077385
080030
080810
080830
081570
081820
083900
084750
085030
085080
085430
085470
085500
085520
089480
089580
093590
094900
094920
094960
095460
095570
095670
095690
100010
100260
100340
101220
103090
103120
103620
104090
104340
105040
105080
105090
105325
105360
105490
105510
106260
106334
106400
107250
107640
108340
108580
109710
109711
110030
110080
110140
110163
110900
111060
111130
111770
112340
112480
112950
113150
113520
116500
121120
123320
123720
123740
123764
124260
125190
126800
128550
131120
131290
131590
132140
132160
132600
133290
133400
135820
150550
151400
154470
154930
155460
014870
020540
023141
014980
021690
022150
022180
024020
024040
024720
024940
023710
025170
025280
025380
025410
025600
025680
025700
025760
025810
025910
026291
026400
026800
026810
027110
027230
027300
027830
029050
029140
029680
030064
030110
030320
030600
030700
030820
031310
031370
031430
031573
031590
032160
032290
032420
032431
032460
032620
032660
032820
0333

2025-01-18 09:06:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:06:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:06:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:06:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 09:06:17 - snowflake.connector.connection - INFO - closed
2025-01-18 09:06:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:06:18 - root - INFO - SQL:
SELECT "usaf", "name", "lat", "lon"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
   LIMIT 1000;
Results:
Too long, hard cut:
usaf,name,lat,lon
007018,WXPOD 7018                   ,0.0,0.0
007026,WXPOD 7026                   ,0.0,0.0
007070,WXPOD 7070                   ,0.0,0.0
008268,WXPOD8278                    ,32.95,65.567
008307,WXPOD 8318                   ,0.0,0.0
010016,RORVIK/RYUM,64.85,11.233
010017,FRIGG,59.98,2.25
010071,LONGYEARBYEN,78.217,15.583
010190,SVARTTANGEN,77.517,20.817
010240,PYRAMIDEN,78.65,16.367
010303,TROMSO/SKATTURA,69.7,19.017
010320,OVERBYGD,69.017,19.283
010340,FUGLOYKALVEN FYR,70.317,20.15
010470,KAUTOKEINO II,69.017,23.067
010510,SUOLOVUOPMI,69.583,23.533
010530,HAMMERFEST RADIO,70.683,23.683
010610,BRENNELV,70.067,25.117
010660,HELNES FYR,71.067,26.233
010670,LEVAJOK-EVJEN,69.9,26.417
010671,LEVAJOK-EVJEN,69.9,26.417
010750,RUSTEFJELBMA,70.4,28.2
010884,GEITERYGGEN,59.185,9.567
011030,LEKA,65.1,11.7
011051,SKOMVAER (LGT-H)             ,67.417,11.883
011100,YTTERHOLMEN FYR,66.0,11.683
011130,GLOMFJORD,66.8,13.983
011133,DAGALI,60.417,8.513
011310,GLAPEN LIGHTHOUSE,67.883,13.05
011340,MAJAVATN III,65.183,13.417
011380,TENNHOLMEN (LGT-H)           ,67.3,13.5
011490,RANA-BASMOEN,66.333,14.1
011501,HATTFJELLDAL-KRUTA,65.683,14.167
011530,BODO-VAGONES,67.283,14.45
011540,LITLOY FYR,68.583,14.3
011560,BO I VESTERALEN,68.6,14.433
011630,BOLNA,66.5,15.25
011680,KLEIVA I SORTLAND,68.65,15.283
011691,OVRE SALTDAL,66.967,15.317
011700,FAUSKE-VETEN,67.233,15.317
011720,FINNOY I HAMAROY,68.0,15.617
011760,KONGSVIK,68.567,16.267
011840,SANDSOY I SENJA,68.933,16.683
011841,SANDSOY,68.933,16.683
011890,LILAND,68.483,16.883
011930,NARVIK III/FRAMNES,68.467,17.5
011960,TENNEVOLL,68.75,17.817
011980,DIVIDALEN II,68.783,19.7
012070,FISKABYGD,62.1,5.583
012091,ORSTA-VOLDA/HOVD,62.183,6.05
012150,HJELVIK MYRBO,62.62,7.23
012160,HJELVIK I ROMSDAL,62.617,7.217
012161,GJERMUNDNES,62.617,7.167
012210,TAGDALEN,63.05,9.083
012273,TINGVOLL-HANEM,62.833,8.3
012310,LESJASKOG,62.233,8.367
012350,DOMBAS-KIRKENAER,62.083,9.133
012360,KJOREMSGRENDE,62.1,9.05
012390,HJERKINN II,62.217,9.55
012430,SONGLI,63.333,9.65
012520,BERKAK-LYNGHOLT,62.817,10.017
012580,TRONDHEIM (TYHOLT)           ,63.417,10.433
012740,SELBU-STUBBE,63.2,11.117
012771,LEVANGER-EGGEN,63.717,11.233
012780,VERDAL-REPPE,63.783,11.683
012823,RORVIK/RYUM,64.85,11.233
012890,ROROS LUFTHAVN,62.583,11.35
012891,ROROS/AIRPORT,62.583,11.383
012920,MERAKER-UTSYN,63.417,11.7
012950,HOYLANDET,64.55,12.15
012960,BERG I SNASA,64.25,12.417
012980,NORDLI-HOLAND,64.45,13.717
013060,HELLISOY FYR,60.75,4.717
013160,BERGEN-FREDRIKSBERG,60.4,5.317
013180,SANDANE,61.783,6.183
013220,FORDE-TEFRE,61.467,5.917
013250,MODALEN II,60.833,5.95
013280,KVAMSKOGEN,60.4,5.917
013390,VANGSNES,61.167,6.65
013410,EIDFJORD-BU,60.467,6.867
013471,SOGNDAL/HAUKASEN,61.167,7.133
013510,FINSE III,60.6,7.5
013560,FANNARAKI,61.517,7.9
013591,HAUGASTOL,60.517,7.867
013671,BEITOSTOLEN,61.233,8.933
013690,ABJORSBRATEN,60.917,9.283
013720,NESBYEN-SKOGLUND,60.567,9.133
013743,FAGERNES/LEIRIN   &          ,61.0,9.3
013790,SOR-NESSET,61.883,10.15
013801,KITTILBU,61.167,9.967
013839,HAMAR / STAFSBERG,60.817,11.067
013910,FLISA,60.617,12.017
014000,EKOFISK,56.55,3.217
014010,FRIGG,59.983,2.25
014035,KARMOY,59.35,5.217
014110,KVITSOY - NORDBO,59.067,5.417
014120,OBRESTAD,58.65,5.567
014211,INDRE MATRE,59.85,6.0
014280,LISTA,58.099,6.626
014320,SIRDAL-TJORHOM,58.883,6.85
014321,FIDJELAND,58.967,6.933
014330,MIDTLAEGER,59.833,6.983
014450,SKAFSA,59.45,8.0
014460,OYFJELL-TROVATN,59.567,8.2
014611,GAUSTATOPPEN,59.85,8.65
014740,LYNGDAL I NUMEDAL,59.9,9.533
014750,SKIEN-GEITERYGGEN,59.183,9.567
014870,ALNA,59.933,10.833
014960,HOLAND-FOSSER,59.817,11.483
014970,PRESTEBAKKE,59.0,11.533
014980,MAGNOR,59.967,12.217
015000,RAKKESTAD,59.383,11.383
020120,RITSEM,67.733,17.467
020180,SUORVA,67.533,18.233
020200,KATTERJAKK,68.417,18.167
020230,TORNEHAMN (AUT)              ,68.433,18.633
020260,ALUOKTA,67.317,18.883
020320,TORNETRASK LAKE,68.217,19.717
020430,ESRANGE,67.933,21.067
020450,KIRUNA-SOL,67.833,20.417
020480,MALMBERGET,67.167,20.667
020510,KARESUANDO,68.45,22.5
020540,NEDRE SOPPERO,68.05,21.75
020560,STENSELE,65.067,17.167
020600,NAIMAKKA,68.683,21.533
020711,BORLANGE,60.417,15.517
020800,KARESUANDO,68.45,22.45
020840,LANNAVAARA        &          ,68.05,22.0
020860,LAINIO,67.767,22.35
020880,KOMPELUSVAARA,67.083,22.217
020920,MUODOSLOMPOLO,67.95,23.467
020960,PAJALA,67.217,23.4
020970,MALMO /BULLTOFTON,55.6,13.067
021040,HEMAVAN,65.817,15.083
021050,ABELVATTNET,65.533,14.983
021080,KLIMPFJALL,65.067,14.8
021120,SYLARNA,63.05,12.267
021160,MORSIL,63.317,13.65
021180,DIKANAS/SKANSNAS,65.317,16.033
021200,KVIKKJOKK-ARRENJARKA,66.883,18.017
021220,STENUDDEN,66.533,17.667
021230,JAKKVIK,66.317,17.1
021270,STENSELE,65.067,17.167
021280,GUNNARN,65.0,17.7
021290,GUNNARN SOL (AUT)            ,64.967,17.7
021300,ROPARUDDEN,66.483,16.417
021360,STORBERG,65.5,18.95
021420,JOKKMOKK,66.496,20.147
021430,PALJAMYREN,66.217,19.133
021440,ABRAUR,65.983,18.933
021450,TELLEJAUR,66.15,19.633
021460,VAJMAT,66.5,19.683
021520,SUDOK,66.3,20.41

2025-01-18 09:06:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:06:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:06:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:06:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 137
2025-01-18 09:06:19 - snowflake.connector.connection - INFO - closed
2025-01-18 09:06:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:06:19 - root - INFO - SQL:
SELECT "usaf", "name", "state"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
   WHERE "state" = 'NY'
   LIMIT 1000;
Results:
usaf,name,state
725010,UPTON,NY
725033,NYC CENTRAL PARK,NY
725034,CALVERTON/GRUMMAN,NY
725035,LONG ISLAND MAC ART,NY
725060,NEW YORK CENTRAL PARK,NY
725184,ALBANY (NEXRAD)              ,NY
725185,FLOYD BENNETT MEM,NY
725187,CLINTON COUNTY AIRPORT,NY
725195,OSWEGO COAST GUARD STATION,NY
725196,GRIFFISS AIRPARK,NY
725197,ONEIDA COUNTY AIRPORT,NY
725198,MILLBROOK/SKY ACRES,NY
725230,DANSVILLE/MUNICIPAL,NY
725230,DANSVILLE MUNICIPAL,NY
725283,CATTARAUGUS CO OLEAN,NY
725285,BUFFALO COAST GUARD STATION,NY
725288,NIAGARA COAST GUARD STATION,NY
726221,MASSENA AP,NY
726225,PLATTSBURGH INTL,NY
744976,NTPD AIR OPS HELIPORT,NY
749105,MITCHEL FIELD,NY
998168,NIAGARA CG STATION,NY
998436,BARCELONA HARBOR,NY
999999,GENEVA SAMPSON AFB,NY
999999,NIAGARA FALLS,NY
999999,SCHENECTADY,NY
999999,SCHENECTADY,NY
999999,HEMPSTEAD MITCHELL FLD AFB,NY
999999,BINGHAMTON TRI-CITIES ARPT,NY
999999,CANTON 4 SE                  ,NY
999999,DUNKIRK CHAUTAUQUA CO AP,NY
999999,ELMIRA AIRPORT,NY
999999,FORT PLAIN WB AP,NY
999999,GLENS FALLS AP,NY
999999,POUGHKEEPSIE DUTCHESS CO AP,NY
999999,TICONDEROGA 3 NE             ,NY
999999,UTICA CAA AP,NY
999999,NEW YORK FLOYD BENNE,NY
999999,BEAR MOUNTAIN WB,NY
999999,NEW YORK SHOALS AFS,NY
999999,DANSVILLE MUNI AP,NY
999999,NEW YORK CENTRAL PARK,NY
999999,WATERTOWN AP,NY
999999,UTICA ONEIDA COUNTY AP,NY
994100,AMBROSE LIGHT  NY,NY
724098,AMBROSE / FT. TILDEN,NY
725039,EATONS NECK COAST GUARD STATI,NY
744975,SHORT BEACH COAST GUARD STATI,NY
998267,ROCHESTER,NY
725028,BAY SHORE / FIRE ISLAND,NY
744859,FREEPORT,NY
997272,BERGEN POINT,NY
749108,ELIZABETH AAF,NY
999999,BINGHAMTON BROOME COUNTY ARPT,NY
999999,NEW YORK LAGUARDIA ARPT,NY
999999,BUFFALO BUFFALO ARPT,NY
999999,ALBANY COUNTY AP,NY
999999,ROCHESTER MONROE CO ARPT,NY
999999,SYRACUSE MUNICIPL AP,NY
999999,MASSENA AP,NY
999999,WHITE PLAINS WESTCHESTER CO A,NY
999999,NEW YORK FORT TOTTEN,NY
724988,DANSVILLE MUNI,NY
725036,DUTCHESS CO,NY
725156,ELMIRA CORNING RGNL,NY
725287,NIAGARA FALLS INTL,NY
744865,WESTHAMPTON BEACH,NY
744989,CHAUTAUQUA CO DUNKIR,NY
744994,SCHENECTADY CO,NY
725038,STEWART INTL,NY
722098,EAST HAMPTON,NY
725015,ORANGE CO,NY
725016,BROOKHAVEN,NY
725145,SULLIVAN CO INTL,NY
725146,OSWEGO CO,NY
725155,ITHACA TOMPKINS RGNL,NY
725157,WELLSVILLE MUNI,NY
725187,CLINTON CO,NY
725194,PENN YAN,NY
725235,CHATAUQUA CO JAMESTO,NY
726228,ADIRONDACK RGNL,NY
743700,FORT DRUM/WHEELER-S,NY
744864,REPUBLIC,NY
725014,MONTAUK,NY
994590,THOUSAND I. BRDG.  NY,NY
994930,SOUTH MIDDLE SOUND,NY
999999,MILLBROOK 3 W                ,NY
999999,ITHACA 13 E                  ,NY
720553,PORT AUTH DOWNTN MANHATTAN WA,NY
725186,OGDENSBURG INTL,NY
997989,OLCOTT HARBOR,NY
998009,ROCHESTER,NY
998235,NIAGRA INTAKE,NY
998266,STURGEON POINT,NY
998223,ALEXANDRIA BAY,NY
997271,THE BATTERY,NY
997280,KINGS POINT,NY
997282,MONTAUK,NY
998435,OGDENSBURG,NY
997991,HUDSON RIVER RESERVE,NY
722098,EAST HAMPTON AIRPORT,NY
724988,DANSVILLE MUNICIPAL ARPT,NY
725014,MONTAUK AIRPORT,NY
725016,BROOKHAVEN AIRPORT,NY
725030,LA GUARDIA AIRPORT,NY
725036,DUTCHESS COUNTY AIRPORT,NY
725037,WESTCHESTER COUNTY AIRPORT,NY
725038,STEWART INTERNATIONAL AIRPORT,NY
725050,LONG ISLAND MAC ARTHUR AIRPOR,NY
725053,CENTRAL PARK,NY
725145,SULLIVAN COUNTY INTL ARPT,NY
725146,OSWEGO COUNTY AIRPORT,NY
725150,GREATER BINGHAMTON/E A LINK F,NY
725155,ITHACA TOMPKINS REGIONAL AIRP,NY
725156,ELMIRA/CORNING RGNL ARPT,NY
725157,MUNI ARPT TARANTINE FLD AP,NY
725180,ALBANY INTERNATIONAL AIRPORT,NY
725190,SYRACUSE HANCOCK INTERNATIONA,NY
725194,PENN YAN AIRPORT,NY
725196,GRIFFIS AIRFIELD,NY
725220,FLOYD BENNETT MEMO AIRPORT,NY
725235,CHAUTAUQUA CO/JAMESTOWN AP,NY
725280,BUFFALO NIAGARA INTERNATIONAL,NY
725283,CATTARAUGUS COUNTY OLEAN AIRP,NY
725287,NIAGARA FALLS INTL AIRPORT,NY
725290,GREATER ROCHESTER INTERNATION,NY
726223,MASSENA INTL/RCHARDS FD AP,NY
726225,PLATTSBURGH INTERNATIONAL AIR,NY
726227,WATERTOWN INTL AIRPORT,NY
726228,ADIRONDACK REGIONAL ARPT,NY
743700,WHEELER-SACK AAF AIRPORT,NY
744860,JOHN F KENNEDY INTERNATIONAL,NY
744864,REPUBLIC AIRPORT,NY
744865,FRANCIS S GABRESKI AP,NY
744994,SCHENECTADY COUNTY AIRPORT,NY
725015,ORANGE COUNTY AIRPORT,NY
744989,CHAUTAUQUA CO/DUNKIRK ARPT,NY

2025-01-18 09:06:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:06:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:06:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:06:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 09:06:21 - snowflake.connector.connection - INFO - closed
2025-01-18 09:06:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:06:21 - root - INFO - SQL:
SELECT "usaf", "begin", "end"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
   LIMIT 1000;
Results:
Too long, hard cut:
usaf,begin,end
007018,20110309,20130730
007026,20120713,20170822
007070,20140923,20150926
008268,20100519,20120323
008307,20100421,20100421
010016,19870116,19910806
010017,19880320,20050228
010071,20050210,20050210
010190,20100825,20140523
010240,19730101,20210918
010303,20140522,20150108
010320,19730101,20140523
010340,19871202,20140523
010470,19730101,20210917
010510,19730102,20140523
010530,19730101,19871226
010610,19730101,19840707
010660,19730101,20040619
010670,19730103,19820924
010671,20070307,20070307
010750,19730101,20130531
010884,20050103,20151109
011030,19730101,20070307
011051,20070307,20070307
011100,19961201,20050319
011130,20040406,20091216
011133,19860509,20030427
011310,19730101,19850625
011340,19730101,20070630
011380,19850912,20070307
011490,19730101,20070228
011501,20020312,20020312
011530,20111003,20140611
011540,19940406,20170801
011560,20040510,20210913
011630,19730101,19770823
011680,19730101,20060611
011691,19730101,19781008
011700,19730101,19900307
011720,19730101,20060311
011760,19730101,19780118
011840,19730101,19780613
011841,20070307,20070307
011890,19730102,20050302
011930,20010706,20170403
011960,19730101,20020808
011980,20100114,20210918
012070,20040510,20180630
012091,19840910,19841127
012150,19730101,20090630
012160,19731226,20020527
012161,20040412,20040412
012210,20080115,20210909
012273,20050101,20150108
012310,19771030,20080731
012350,19360101,19760602
012360,20050218,20100104
012390,20100907,20210906
012430,19730101,19761119
012520,19730101,20080930
012580,19730101,19810714
012740,19730101,20061115
012771,19730101,19730216
012780,19850102,20181031
012823,19910827,19950831
012890,19840909,20041230
012891,19790301,19840817
012920,19730101,20040930
012950,19730101,20070612
012960,19730101,19770606
012980,19730101,20191016
013060,19730101,20041229
013160,19730101,19851230
013180,20050614,20171231
013220,19730101,20171223
013250,19730101,20080924
013280,19730101,20060726
013390,19730101,20011102
013410,19830101,20070227
013471,19840801,19841217
013510,19730102,20011210
013560,19881125,20140827
013591,20070307,20070307
013671,19730101,19801105
013690,19881001,20171230
013720,19730101,20040121
013743,19880105,19880913
013790,19730101,20051209
013801,19741114,19840827
013839,19870205,19900222
013910,19730101,20050331
014000,19981223,20200901
014010,20010601,20060718
014035,19751101,19840807
014110,20050612,20210915
014120,19730101,20210909
014211,20020314,20020314
014280,19730101,20070813
014320,19741114,20100331
014321,20070307,20070307
014330,19730101,20150528
014450,19730101,19891113
014460,19830101,20040731
014611,20140605,20181022
014740,19730101,20060831
014750,19850717,20041230
014870,20040924,20150601
014960,19730101,20071020
014970,19730101,20100409
014980,19830101,20050831
015000,20090708,20091216
020120,19810801,20050924
020180,19350101,19381231
020200,19770701,20190401
020230,19860427,20050526
020260,20021023,20050930
020320,19770701,20030909
020430,19940301,19990630
020450,19950401,20030922
020480,19350101,19910505
020510,19550101,19591231
020540,19550101,20160421
020560,19550101,19591231
020600,19550101,20041021
020711,19730101,19730121
020800,19350101,20120831
020840,19550101,20040507
020860,19550101,20050317
020880,19730101,20020521
020920,19730101,20040917
020960,19550101,20080218
020970,19550101,19740702
021040,19770701,20080218
021050,19730101,20040221
021080,19770701,20050921
021120,19770701,20040821
021160,19730101,20050221
021180,19730101,20050121
021200,19350101,20130331
021220,19790802,20040321
021230,19730101,20160421
021270,19310103,20050823
021280,19730101,20130402
021290,19730101,19861125
021300,19730101,20160421
021360,20030519,20040829
021420,19770701,20000510
021430,19730101,20030731
021440,19770701,20040626
021450,20030725,20040322
021460,20010701,20160421
021520,19730101,20050919
021560,19770701,20031028
021580,19790726,20020807
021590,19960801,20050629
021600,20010829,20050307
021640,19730501,20030719
021690,20020530,20020801
021720,19790710,19791123
021820,19790803,20020602
021850,20010402,20011008
021900,20010716,20040402
022000,19770701,20041225
022060,19350101,20130228
022150,19970901,20040822
022160,19730101,20160421
022170,20010701,20160421
022180,19730105,20050924
022220,19770701,20080218
022240,20020609,20020609
022320,19770701,20040903
022330,20010701,20160421
022340,19790105,19951130
022440,19960201,20080218
022480,19770704,20050218
022520,19830201,20040922
022560,20010701,20160421
022580,20011104,20041216
022620,19730101,20040306
022640,19730101,20021028
022660,20020608,20020608
022700,20010614,20030914
022740,19960501,20000509
022780,19770701,20041015
022830,19840712,19840712
022861,20040706,20120103
022890,19730101,20010920
022920,20010701,20160421
022960,19350101,20031222
023000,20020523,20060102
023020,20010701,20160421
023030,20010701,20160421
023040,19770701,20040123
023060,19770701,20171208
023100,19770701,20050123
023110,20010701,20160421
023130,19731209,19731209
023140,20010729,20050523
023141,20160801,20190909
023180,197

2025-01-18 09:06:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:06:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:06:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:06:22 - snowflake.connector.connection - INFO - closed
2025-01-18 09:06:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:06:48 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 09:06:48 - root - INFO - The error you're encountering is due to the way the `ST_MAKEPOINT` function and type casting are used in your query. In Snowflake, `ST_MAKEPOINT` creates a `GEOMETRY` object, and casting it directly to `GEOGRAPHY` may lead to issues. Instead, you should use the `GEOGRAPHY_POINT` function to create `GEOGRAPHY` points from latitude and longitude values.

Here's the corrected query:

```sql
SELECT "usaf", "name", "lat", "lon"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
WHERE ST_DWITHIN(
    GEOGRAPHY_POINT("lat", "lon"),
    GEOGRAPHY_POINT(41.197, -73.764),
    32186.8
)
LIMIT 1000;
```

**Explanation:**

- **GEOGRAPHY_POINT(lat, lon):** This function creates a `GEOGRAPHY` point from latitude and longitude values. Ensure that you pass the parameters in the order of latitude first, then longitude.
- **ST_DWITHIN(geog1, geog2, distance):** This function checks if the minimum geodesic distance between two `GEOGRAPHY` objects is within the specified distance.

**Notes:**

- Make sure that the `"lat"` and `"lon"` columns in your `"STATIONS"` table are of type `FLOAT` or a numeric type compatible with the `GEOGRAPHY_POINT` function. If they are stored as strings, you may need to cast them to `FLOAT`:

  ```sql
  GEOGRAPHY_POINT(TO_FLOAT("lat"), TO_FLOAT("lon"))
  ```

- Verify that the latitude and longitude values are valid (latitude between -90 and 90, longitude between -180 and 180) and not `NULL`.

**Example Applying Type Casting (if necessary):**

If your latitude and longitude columns are strings or might contain `NULL` values, you can modify the query to handle these cases:

```sql
SELECT "usaf", "name", "lat", "lon"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
WHERE "lat" IS NOT NULL AND "lon" IS NOT NULL
  AND ST_DWITHIN(
      GEOGRAPHY_POINT(TO_FLOAT("lat"), TO_FLOAT("lon")),
      GEOGRAPHY_POINT(41.197, -73.764),
      32186.8
  )
LIMIT 1000;
```

**Additional Considerations:**

- **Distance Unit:** The distance in `ST_DWITHIN` is specified in meters. Since 20 miles is approximately 32,186.8 meters, the value used in the query is correct.
- **Order of Parameters:** Ensure that when using `GEOGRAPHY_POINT`, the order is `(latitude, longitude)`. This order is important to create the point accurately.
- **Data Validity:** It's a good idea to check for any anomalous latitude or longitude values in your data that might cause errors.

**Testing the Query:**

After making these changes, try running the query again. It should now execute without the previous error and return the stations within a 20-mile radius of Chappaqua, New York.

---

**Next Steps:**

With this corrected query, you can proceed to:

1. **Identify Relevant Stations:** Get the list of weather stations within the specified radius.
2. **Count Temperature Observations:** For each station, query the GSOD tables from 2011 to 2020 (e.g., `GSOD2011`, `GSOD2012`, ..., `GSOD2020`) to count the number of valid temperature observations where `"temp"` is not `NULL`.

**Example Query to Count Observations:**

Here's an example of how you might count the number of valid temperature observations for each station:

```sql
SELECT
    s."usaf" AS station_id,
    s."name" AS station_name,
    COUNT(g."temp") AS number_of_temperature_observations
FROM
    "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS" s
JOIN
    (
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
        UNION ALL
        ...
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
    ) g
    ON s."usaf" = g."stn"
WHERE
    s."lat" IS NOT NULL AND s."lon" IS NOT NULL
    AND ST_DWITHIN(
        GEOGRAPHY_POINT(s."lat", s."lon"),
        GEOGRAPHY_POINT(41.197, -73.764),
        32186.8
    )
    AND g."temp" IS NOT NULL
GROUP BY
    s."usaf", s."name";
```

**Formatting the Results:**

Finally, present the results in the required CSV format:

```csv
station_id,station_name,number_of_temperature_observations
station1_id:str,station1_name:str,observations1:int
station2_id:str,station2_name:str,observations2:int
...
```
2025-01-18 09:06:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:06:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:06:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:06:50 - snowflake.connector.connection - INFO - closed
2025-01-18 09:06:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:07:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 09:07:39 - root - INFO - I understand that you're still encountering an error when running your SQL query. Let's look at your query and the error message:

**Your Query:**

```sql
SELECT "usaf", "name", "lat", "lon"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
   WHERE ST_DWITHIN(
       ST_MAKEPOINT("lon", "lat")::GEOGRAPHY,
       ST_MAKEPOINT(-73.764, 41.197)::GEOGRAPHY,
       32186.8
   )
   LIMIT 1000;
```

**Error Message:**

```
001003 (42000): 01b9ca62-0004-7b17-0001-11c300ee237a: SQL compilation error:
syntax error line 15 at position 8 unexpected '.'.
syntax error line 17 at position 8 unexpected 'FROM'.
```

---

### **Diagnosis of the Error:**

The error message indicates a syntax error, specifically at positions where a `.` (dot) and the keyword `FROM` are unexpected. This suggests that there might be issues with the way the functions and casting are used in your query.

Additionally, the use of `ST_MAKEPOINT` and casting to `GEOGRAPHY` is causing problems.

---

### **Solution:**

To fix the error and obtain the desired results, we need to:

1. **Use the Correct Functions:**
   - In Snowflake, to create `GEOGRAPHY` points from latitude and longitude, we should use `GEOGRAPHY_POINT(latitude, longitude)`.
   - Note that the order is **`GEOGRAPHY_POINT(latitude, longitude)`**, which is **latitude first**, then longitude.

2. **Avoid Unnecessary Casting:**
   - Casting `ST_MAKEPOINT` to `GEOGRAPHY` is unnecessary and might cause errors.
   - Instead, use `GEOGRAPHY_POINT`, which directly creates a `GEOGRAPHY` object.

3. **Ensure Data Types Are Correct:**
   - Make sure that `"lat"` and `"lon"` are of numeric types (e.g., `FLOAT`).
   - If they are strings, convert them using `TO_DOUBLE` or `CAST`.

4. **Check for NULL Values:**
   - Include conditions to handle any `NULL` values in `"lat"` and `"lon"`.

---

### **Corrected Query:**

Here's the corrected SQL query:

```sql
SELECT "usaf", "name", "lat", "lon"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
WHERE "lat" IS NOT NULL AND "lon" IS NOT NULL
  AND ST_DWITHIN(
      GEOGRAPHY_POINT(TO_DOUBLE("lat"), TO_DOUBLE("lon")),
      GEOGRAPHY_POINT(41.197, -73.764),
      32186.8
  )
LIMIT 1000;
```

---

### **Explanation:**

- **GEOGRAPHY_POINT Function:**
  - `GEOGRAPHY_POINT(latitude, longitude)` creates a geographic point.
  - We use `TO_DOUBLE("lat")` and `TO_DOUBLE("lon")` to ensure the values are of numeric type.

- **ST_DWITHIN Function:**
  - `ST_DWITHIN(geog1, geog2, distance_in_meters)` returns `TRUE` if the distance between `geog1` and `geog2` is within the specified distance.
  - We compare the station's location to the location of Chappaqua, NY.

- **Handling NULL Values:**
  - We add `WHERE "lat" IS NOT NULL AND "lon" IS NOT NULL` to ensure that calculations are only performed on valid data.

---

### **Next Steps:**

Now that we have identified the weather stations within a 20-mile radius of Chappaqua, NY, we need to:

1. **Identify the Station IDs:**
   - Use the above query to get the `usaf` codes of the stations within the radius.

2. **Count Temperature Observations for Each Station:**
   - For each station, count the number of valid temperature observations from 2011 to 2020.
   - The temperature data is in the `GSODYYYY` tables (`GSOD2011` to `GSOD2020`).

---

### **Query to Count Temperature Observations:**

```sql
SELECT
    s."usaf" AS station_id,
    s."name" AS station_name,
    COUNT(g."temp") AS number_of_temperature_observations
FROM
    "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS" s
JOIN
    (
        SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011" UNION ALL
        SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012" UNION ALL
        SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013" UNION ALL
        SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014" UNION ALL
        SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015" UNION ALL
        SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016" UNION ALL
        SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017" UNION ALL
        SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018" UNION ALL
        SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019" UNION ALL
        SELECT "stn", "temp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
    ) g ON s."usaf" = g."stn"
WHERE
    s."lat" IS NOT NULL AND s."lon" IS NOT NULL
    AND ST_DWITHIN(
        GEOGRAPHY_POINT(TO_DOUBLE(s."lat"), TO_DOUBLE(s."lon")),
        GEOGRAPHY_POINT(41.197, -73.764),
        32186.8
    )
    AND g."temp" IS NOT NULL
GROUP BY
    s."usaf", s."name";
```

**Note:**

- Replace `UNION ALL` with a `UNION ALL` of the `GSOD` tables from 2011 to 2020.
- Ensure that you have access to all these tables and that they are named correctly.

---

### **Final Output Format:**

The result will be in the following CSV format:

```csv
station_id,station_name,number_of_temperature_observations
station1_id:str,station1_name:str,observations1:int
station2_id:str,station2_name:str,observations2:int
...
```

---

### **Summary:**

- **Issue:** Syntax errors in SQL query due to incorrect function usage and casting.
- **Solution:** Use `GEOGRAPHY_POINT` instead of `ST_MAKEPOINT` and avoid casting. Ensure data types are correct and handle `NULL` values.
- **Next Steps:** Run the corrected query to get the stations within a 20-mile radius and count their valid temperature observations from 2011 to 2020.

---

### **Additional Tips:**

- **Verify Function Availability:**
  - Make sure that `GEOGRAPHY_POINT` and `ST_DWITHIN` functions are available in your instance of Snowflake.

- **Check Data Types:**
  - Ensure that the `"lat"` and `"lon"` columns are stored as numeric types (`FLOAT`). If they are stored as strings, use `TO_DOUBLE` to convert them.

- **Test Incrementally:**
  - Test your query step by step. Start with selecting the data without the `WHERE` clause, then add conditions progressively to isolate any potential issues.

---

**I hope this helps you resolve the error and successfully retrieve the required data. Let me know if you have any questions or need further assistance!**
2025-01-18 09:07:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:07:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:07:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:07:40 - snowflake.connector.connection - INFO - closed
2025-01-18 09:07:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:08:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 09:08:25 - root - INFO - I see that you're encountering an error indicating that the functions `GEOGRAPHY_POINT` are unknown:

```
SQL compilation error:
Unknown functions GEOGRAPHY_POINT, GEOGRAPHY_POINT
```

This suggests that `GEOGRAPHY_POINT` is not a recognized function in your SQL environment. In Snowflake SQL, to create a `GEOGRAPHY` object from latitude and longitude coordinates, you can use the `ST_POINT` function and then cast it to `GEOGRAPHY`. Alternatively, you can construct the `GEOGRAPHY` object directly using the `TO_GEOGRAPHY` function with a Well-Known Text (WKT) representation.

**Here's how you can modify your query using `TO_GEOGRAPHY`:**

```sql
SELECT "usaf", "name", "lat", "lon"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
WHERE "lat" IS NOT NULL AND "lon" IS NOT NULL
  AND ST_DWITHIN(
      TO_GEOGRAPHY('POINT(' || "lon" || ' ' || "lat" || ')'),
      TO_GEOGRAPHY('POINT(-73.764 41.197)'),
      32186.8
  )
LIMIT 1000;
```

**Explanation:**

- **Creating `GEOGRAPHY` Points:**
  - **Station Locations:**
    - We use `TO_GEOGRAPHY` to convert a WKT string into a `GEOGRAPHY` object.
    - The WKT format for a point is `'POINT(<longitude> <latitude>)'`.
    - We concatenate the longitude and latitude values into this format using `||`.
  - **Chappaqua Location:**
    - We specify Chappaqua's location directly using its longitude and latitude in the WKT format.

- **Handling Data Types:**
  - Ensure that the `"lon"` and `"lat"` columns are of numeric types (`FLOAT` or similar). If they are stored as strings, you might need to cast them to numeric types using `TO_DOUBLE("lon")` and `TO_DOUBLE("lat")`.

- **Checking for `NULL` Values:**
  - We include `WHERE "lat" IS NOT NULL AND "lon" IS NOT NULL` to avoid errors from missing coordinate data.

**Alternative Using `ST_POINT` Cast to `GEOGRAPHY`:**

If `ST_POINT` is available in your environment, you can create a `GEOGRAPHY` object by casting a `GEOMETRY` point:

```sql
SELECT "usaf", "name", "lat", "lon"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
WHERE "lat" IS NOT NULL AND "lon" IS NOT NULL
  AND ST_DWITHIN(
      ST_POINT("lon", "lat")::GEOGRAPHY,
      ST_POINT(-73.764, 41.197)::GEOGRAPHY,
      32186.8
  )
LIMIT 1000;
```

**Note:**

- **Order of Coordinates:**
  - When using `ST_POINT`, the order of coordinates is `(longitude, latitude)`.

- **Casting to `GEOGRAPHY`:**
  - We cast the `GEOMETRY` point to `GEOGRAPHY` using `::GEOGRAPHY`.

**Next Steps to Count Temperature Observations:**

Once you have the list of stations within a 20-mile radius, you can count the number of valid temperature observations from 2011 to 2020.

**Consolidated Query:**

```sql
WITH nearby_stations AS (
    SELECT "usaf", "name"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    WHERE "lat" IS NOT NULL AND "lon" IS NOT NULL
      AND ST_DWITHIN(
          TO_GEOGRAPHY('POINT(' || "lon" || ' ' || "lat" || ')'),
          TO_GEOGRAPHY('POINT(-73.764 41.197)'),
          32186.8
      )
)

SELECT
    ns."usaf" AS station_id,
    ns."name" AS station_name,
    COUNT(g."temp") AS number_of_temperature_observations
FROM
    nearby_stations ns
JOIN
    (
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
    ) g ON ns."usaf" = g."stn"
WHERE
    g."temp" IS NOT NULL
GROUP BY
    ns."usaf", ns."name";
```

**Explanation:**

- **Common Table Expression (`WITH` Clause):**
  - We first identify all nearby stations within the 20-mile radius.

- **Joining Observations:**
  - We create a unified set of temperature observations from 2011 to 2020 using `UNION ALL`.

- **Filtering Valid Temperatures:**
  - We ensure that only records where `"temp"` is not `NULL` are counted.

- **Counting Observations:**
  - We count the number of valid temperature observations for each station.

**Final Output Format:**

```csv
station_id,station_name,number_of_temperature_observations
station1_id:str,station1_name:str,observations1:int
station2_id:str,station2_name:str,observations2:int
...
```

**Additional Tips:**

- **Verifying Function Availability:**
  - Ensure that the functions `ST_DWITHIN`, `ST_POINT`, and `TO_GEOGRAPHY` are available in your Snowflake environment. Their availability might depend on your Snowflake edition and whether the Spatial Data Extensions are enabled.

- **Data Types:**
  - If you face issues with data types, you can explicitly cast the latitude and longitude to numerical types.

    ```sql
    TO_GEOGRAPHY('POINT(' || TO_DOUBLE("lon") || ' ' || TO_DOUBLE("lat") || ')')
    ```

- **Testing the Query:**
  - Before running the full query, test parts of it to ensure each section works correctly.

**Summary:**

- **Issue:** The function `GEOGRAPHY_POINT` is unknown in your SQL environment.
- **Solution:** Use `TO_GEOGRAPHY` with WKT strings to create `GEOGRAPHY` objects, or use `ST_POINT` and cast to `GEOGRAPHY`.
- **Action:** Modify your query accordingly and proceed to count the valid temperature observations for the nearby stations.

---

Feel free to let me know if you have any questions or need further assistance!
2025-01-18 09:08:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:08:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:08:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:08:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-18 09:08:31 - snowflake.connector.connection - INFO - closed
2025-01-18 09:08:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:08:32 - root - INFO - SQL:
WITH nearby_stations AS (
    SELECT "usaf", "name"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    WHERE "lat" IS NOT NULL AND "lon" IS NOT NULL
      AND ST_DWITHIN(
          TO_GEOGRAPHY('POINT(' || "lon" || ' ' || "lat" || ')'),
          TO_GEOGRAPHY('POINT(-73.764 41.197)'),
          32186.8
      )
)

SELECT
    ns."usaf" AS station_id,
    ns."name" AS station_name,
    COUNT(g."temp") AS number_of_temperature_observations
FROM
    nearby_stations ns
JOIN
    (
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
    ) g ON ns."usaf" = g."stn"
WHERE
    g."temp" IS NOT NULL
GROUP BY
    ns."usaf", ns."name";
Results:
STATION_ID,STATION_NAME,NUMBER_OF_TEMPERATURE_OBSERVATIONS
725086,DANBURY MUNICIPAL AIRPORT,3649
999999,WHITE PLAINS WESTCHESTER CO A,1123769
725086,DANBURY MUNI ARPT,3649
999999,BEAR MOUNTAIN WB,1123769
997186,WESTERN LONG ISLAND SOUND,1532
725037,WESTCHESTER COUNTY AIRPORT,3653

2025-01-18 09:08:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:08:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:08:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:08:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 09:08:33 - snowflake.connector.connection - INFO - closed
2025-01-18 09:08:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:08:34 - root - INFO - SQL:
SELECT "stn", "wban", "year", "mo", "da", "temp"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
   LIMIT 1000;
Results:
Too long, hard cut:
stn,wban,year,mo,da,temp
387340,99999,2011,11,08,28.6
387250,99999,2011,02,04,31.5
388440,99999,2011,02,07,24.4
724293,99999,2011,11,13,24.3
061080,99999,2011,07,22,59.9
388460,99999,2011,11,09,32.5
388440,99999,2011,02,26,17.3
388440,99999,2011,11,09,23.8
387340,99999,2011,10,05,46.3
023020,99999,2011,04,12,32.9
021300,99999,2011,02,28,30.5
680025,99999,2011,01,28,71.2
023020,99999,2011,06,11,62.2
023030,99999,2011,08,31,44.7
026020,99999,2011,11,27,48.0
021300,99999,2011,05,31,42.6
022330,99999,2011,01,14,-14.0
020540,99999,2011,05,03,29.8
025210,99999,2011,06,07,65.2
026460,99999,2011,01,25,31.7
026460,99999,2011,08,06,66.1
023020,99999,2011,10,06,42.9
025210,99999,2011,08,08,59.1
022560,99999,2011,12,19,23.6
023370,99999,2011,03,13,22.9
023370,99999,2011,03,25,23.4
022160,99999,2011,03,09,30.7
023030,99999,2011,04,04,30.3
026520,99999,2011,02,22,20.3
010231,99999,2011,03,11,34.0
023020,99999,2011,12,25,33.6
722857,99999,2011,12,03,29.0
021230,99999,2011,01,09,13.0
024130,99999,2011,12,09,31.5
021460,99999,2011,04,10,30.3
021460,99999,2011,01,14,-12.5
023370,99999,2011,02,11,5.4
023110,99999,2011,02,07,24.8
022330,99999,2011,03,11,11.3
020540,99999,2011,01,16,8.8
022170,99999,2011,02,02,30.4
022560,99999,2011,11,27,23.0
024130,99999,2011,02,23,3.9
022170,99999,2011,03,06,25.4
026460,99999,2011,02,19,20.6
023110,99999,2011,01,08,16.2
022920,99999,2011,02,19,4.8
024130,99999,2011,02,07,12.5
720654,99999,2011,06,26,83.6
023020,99999,2011,03,07,28.3
025070,99999,2011,08,24,57.8
026520,99999,2011,08,18,62.5
026460,99999,2011,06,14,60.9
026090,99999,2011,09,30,58.4
025070,99999,2011,06,05,62.3
022560,99999,2011,09,16,43.4
026090,99999,2011,12,09,42.0
026520,99999,2011,06,22,64.7
024720,99999,2011,02,25,26.3
021460,99999,2011,12,08,10.9
025070,99999,2011,01,04,31.5
023370,99999,2011,02,04,16.7
022560,99999,2011,12,30,13.9
021230,99999,2011,02,22,-10.6
021230,99999,2011,02,11,12.5
023020,99999,2011,02,18,3.0
026460,99999,2011,01,21,28.4
023030,99999,2011,02,06,21.7
021300,99999,2011,03,28,16.1
022170,99999,2011,01,15,13.2
022330,99999,2011,12,17,26.6
026520,99999,2011,02,21,22.1
023020,99999,2011,10,20,32.6
025210,99999,2011,03,01,28.6
022170,99999,2011,03,22,32.5
021700,99999,2011,01,16,14.5
023020,99999,2011,01,12,19.2
021700,99999,2011,12,21,21.5
022160,99999,2011,02,15,7.8
022560,99999,2011,01,26,10.5
026520,99999,2011,02,23,19.4
024130,99999,2011,01,15,6.8
020540,99999,2011,01,02,14.5
023030,99999,2011,01,06,14.6
022170,99999,2011,01,01,25.8
022330,99999,2011,12,03,23.9
022920,99999,2011,11,28,28.5
023490,99999,2011,01,15,-4.8
025530,99999,2011,12,05,31.8
022560,99999,2011,02,15,-1.0
023540,99999,2011,03,14,30.4
021300,99999,2011,02,07,6.0
023020,99999,2011,08,01,57.0
022330,99999,2011,09,14,49.1
024130,99999,2011,05,01,41.2
022920,99999,2011,11,25,37.0
026520,99999,2011,08,17,62.2
022160,99999,2011,10,28,41.7
025950,99999,2011,06,05,60.1
023490,99999,2011,02,24,3.1
024130,99999,2011,01,24,22.0
023370,99999,2011,09,30,53.5
022330,99999,2011,04,06,36.3
026460,99999,2011,07,11,64.3
023110,99999,2011,04,06,38.8
022330,99999,2011,04,05,37.5
021230,99999,2011,12,02,30.4
021460,99999,2011,12,10,23.2
022160,99999,2011,12,28,28.4
023110,99999,2011,10,20,30.9
020540,99999,2011,01,03,0.7
022920,99999,2011,02,04,16.4
020540,99999,2011,01,09,4.8
020540,99999,2011,01,07,3.2
025530,99999,2011,02,28,24.6
021230,99999,2011,11,20,22.0
021700,99999,2011,12,19,31.9
021300,99999,2011,12,05,25.1
022160,99999,2011,02,18,4.0
022560,99999,2011,12,25,25.0
023030,99999,2011,11,27,23.1
023490,99999,2011,01,01,19.4
026520,99999,2011,01,03,17.6
023370,99999,2011,02,17,10.6
024720,99999,2011,12,09,32.0
021230,99999,2011,12,30,13.1
022560,99999,2011,12,31,12.7
023020,99999,2011,02,16,8.2
022560,99999,2011,02,04,12.6
023020,99999,2011,11,27,29.3
023020,99999,2011,04,09,35.9
024130,99999,2011,04,12,38.2
025530,99999,2011,09,01,50.4
023030,99999,2011,03,25,12.8
026460,99999,2011,08,24,61.3
026520,99999,2011,08,22,62.0
680025,99999,2011,01,13,73.2
026030,99999,2011,09,18,57.3
022160,99999,2011,08,17,52.3
023030,99999,2011,02,24,5.8
024130,99999,2011,02,24,5.0
026460,99999,2011,06,20,58.0
022920,99999,2011,04,05,38.9
022330,99999,2011,10,07,40.8
021700,99999,2011,06,04,56.0
026520,99999,2011,08,10,58.0
021700,99999,2011,02,19,-9.3
022160,99999,2011,02,17,11.5
720747,99999,2011,12,08,23.4
022330,99999,2011,01,13,-6.5
025950,99999,2011,02,14,17.3
023110,99999,2011,12,14,29.4
023020,99999,2011,01,11,28.0
021300,99999,2011,01,10,9.9
020540,99999,2011,12,29,12.8
023110,99999,2011,11,26,29.5
025530,99999,2011,02,22,10.3
023110,99999,2011,02,16,9.1
020540,99999,2011,01,11,16.0
020540,99999,2011,12,05,28.0
026020,99999,2011,01,28,27.9
021460,99999,2011,12,27,25.6
022170,99999,2011,12,12,19.7
024130,99999,2011,02,22,6.0
021300,99999,2011,01,03,-1.8
023490,99999,2011,02,21,13.6
022330,99999,2011,01,06,11.4
022560,99999,2011,12,29,21.3
021230,99999,2011,12,21,16.0
023370,99999,2011,01,05,20.1
021700,99999,2011,02,26,29.0
025950,99999,2011,02,22,14.1
023

2025-01-18 09:08:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:08:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:08:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:08:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 09:08:35 - snowflake.connector.connection - INFO - closed
2025-01-18 09:08:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:08:35 - root - INFO - SQL:
SELECT DISTINCT "stn"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
   LIMIT 1000;
Results:
Too long, hard cut:
stn
484150
488300
977220
873490
610960
247680
319870
345040
285880
333770
961630
471500
404170
370850
483600
973400
874480
360640
970480
383880
412460
427540
432130
620550
028720
484000
293480
875480
385990
874670
308620
296450
292820
470350
388950
297360
485320
249590
383410
330190
028140
133890
227210
432260
226210
357000
295570
610910
470700
710735
984300
624400
624170
542920
372790
766920
337610
252820
347300
314890
343910
288070
610750
297120
294050
260290
280490
967910
263890
325830
483580
360960
471620
335870
471400
484200
345790
360580
261340
319150
278570
985310
484800
234120
485570
296250
299370
282140
272080
261440
710823
574260
423280
915510
719494
040130
423610
350110
427060
265180
597580
524180
504340
592930
535640
514310
543370
507270
314840
488030
982220
590230
323890
306730
485740
309350
470750
483720
319690
324080
634510
612400
961790
623250
727840
596630
576620
572970
543740
471560
470280
253560
433140
538450
584770
549090
470600
291220
966450
060110
471350
278350
345450
221270
984440
426230
960870
471920
402650
718432
400300
691226
986460
624550
985380
987470
326180
719064
423140
379250
996440
509150
599970
221000
387250
022170
020540
021230
026090
682905
720605
720406
720743
369820
369740
680300
035660
679770
722907
679750
965050
643600
720411
040131
841490
842700
630210
840760
637420
085020
634740
839420
474770
836720
653765
677650
837780
255520
858360
637720
030220
604592
787935
484076
167341
722666
702755
637090
722201
155257
720623
131160
722177
444540
676930
010881
416200
679910
384010
744659
064280
476830
162210
475670
265020
830630
167193
726764
037663
726396
232210
722211
338388
409040
035413
783334
066580
722052
766546
478720
827641
851960
803420
844550
977800
067940
722032
400830
844440
480250
480200
720371
722089
725495
722866
858640
724833
722334
725453
823170
724043
477890
475420
478560
407807
475690
825991
642100
682677
330005
407823
722182
804100
766580
162591
021610
162592
648100
804230
787450
787670
836724
166990
477350
068065
720375
106164
784390
032145
837590
485575
801390
804470
238045
109470
852450
725479
693614
021205
787140
163500
619840
948955
333931
722163
720602
670850
842260
172050
612970
701338
679610
650020
172550
724026
132890
029470
554720
722128
768556
700638
726553
723761
787410
766127
672830
725454
649500
827040
155256
672970
868910
024930
720739
633310
432210
113080
643900
027140
858320
844250
266295
108370
722369
108560
726391
723055
722081
684420
031350
725457
835250
720345
726603
237010
066820
060100
744653
654720
692164
720627
720583
720254
683210
692174
636580
353948
070700
836490
786470
723529
722091
723676
256770
027570
483770
027590
873710
273690
341520
485170
485700
239550
253780
260590
268870
483070
249510
970860
433290
431890
383340
433460
430860
266450
388060
485660
443470
228450
306030
321650
252480
347200
484580
443290
135830
310880
484250
246390
385110
027690
421110
874160
655050
262260
483740
969870
443850
350260
876410
265240
259540
860970
471880
589110
279950
526520
511560
484550
248560
279280
341710
876450
442370
134620
251380
471360
297240
973000
279060
027890
236620
484770
333170
348800
060120
355760
965290
470950
484010
285730
314450
470520
976900
313000
263590
282400
332750
348660
610990
292310
320980
960730
309490
484090
962950
484530
655100
484130
296050
433210
336630
360380
470610
442170
331350
485810
986440
485550
470460
219310
424520
428860
987410
548430
516440
536140
561870
509490
540260
318250
763930
412700
578660
524950
533910
442120
317020
442130
895320
355320
471520
969350
483250
331770
214320
484350
021510
285410
320610
314780
428400
585560
596320
433330
040050
995400
623870
571780
540270
132780
272420
360610
303370
624320
531490
442560
485610
344150
537980
294300
718437
314740
988510
975700
247240
306860
470580
290230
402550
862210
916100
864600
692484
996570
623050
718442
428740
425590
710354
431170
582030
599810
577990
202920
889680
976300
620120
575840
433530
378510
509630
579320
784860
421820
021300
024130
023540
025070
724293
384620
720381
066120
067450
800630
846730
112410
489410
476435
480370
111460
484075
112520
678690
846580
702647
804370
840360
031140
836725
636304
702550
634020
720374
841430
034920
042025
073170
726404
875060
470220
839810
067530
108600
038030
010885
744672
646650
701196
749171
685380
684380
720494
804340
804570
702711
010883
704140
720257
854590
413410
787945
786390
160595
879340
414520
476600
787625
720339
701719
722214
165420
847350
700634
010014
106163
401761
475490
475530
031394
747808
786445
010876
726544
042605
128605
155258
161220
266661
720867
783841
720632
766534
740002
724090
407127
835880
804130
720544
692214
637140
693254
171290
171900
123765
917830
726564
724694
720631
477940
711970
745966
720326
720278
474790
485577
831110
039240
724517
637910
725337
381417
637410
419780
836980
342140
787421
785140
286760
725484
121053
820305
677790
348610
804120
677610
474900
433360
477790
701040
723144
637260
470050
478500
478570
407821
786630
111490
636710
307390
804160
876400
693594
63717

2025-01-18 09:08:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:08:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:08:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:08:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 09:08:37 - snowflake.connector.connection - INFO - closed
2025-01-18 09:08:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:08:37 - root - INFO - SQL:
SELECT "stn", "year", "mo", "da", "temp"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
   WHERE "temp" IS NOT NULL
   LIMIT 1000;
Results:
Too long, hard cut:
stn,year,mo,da,temp
387340,2011,11,08,28.6
387250,2011,02,04,31.5
388440,2011,02,07,24.4
724293,2011,11,13,24.3
061080,2011,07,22,59.9
388460,2011,11,09,32.5
388440,2011,02,26,17.3
388440,2011,11,09,23.8
387340,2011,10,05,46.3
023020,2011,04,12,32.9
021300,2011,02,28,30.5
680025,2011,01,28,71.2
023020,2011,06,11,62.2
023030,2011,08,31,44.7
026020,2011,11,27,48.0
021300,2011,05,31,42.6
022330,2011,01,14,-14.0
020540,2011,05,03,29.8
025210,2011,06,07,65.2
026460,2011,01,25,31.7
026460,2011,08,06,66.1
023020,2011,10,06,42.9
025210,2011,08,08,59.1
022560,2011,12,19,23.6
023370,2011,03,13,22.9
023370,2011,03,25,23.4
022160,2011,03,09,30.7
023030,2011,04,04,30.3
026520,2011,02,22,20.3
010231,2011,03,11,34.0
023020,2011,12,25,33.6
722857,2011,12,03,29.0
021230,2011,01,09,13.0
024130,2011,12,09,31.5
021460,2011,04,10,30.3
021460,2011,01,14,-12.5
023370,2011,02,11,5.4
023110,2011,02,07,24.8
022330,2011,03,11,11.3
020540,2011,01,16,8.8
022170,2011,02,02,30.4
022560,2011,11,27,23.0
024130,2011,02,23,3.9
022170,2011,03,06,25.4
026460,2011,02,19,20.6
023110,2011,01,08,16.2
022920,2011,02,19,4.8
024130,2011,02,07,12.5
720654,2011,06,26,83.6
023020,2011,03,07,28.3
025070,2011,08,24,57.8
026520,2011,08,18,62.5
026460,2011,06,14,60.9
026090,2011,09,30,58.4
025070,2011,06,05,62.3
022560,2011,09,16,43.4
026090,2011,12,09,42.0
026520,2011,06,22,64.7
024720,2011,02,25,26.3
021460,2011,12,08,10.9
025070,2011,01,04,31.5
023370,2011,02,04,16.7
022560,2011,12,30,13.9
021230,2011,02,22,-10.6
021230,2011,02,11,12.5
023020,2011,02,18,3.0
026460,2011,01,21,28.4
023030,2011,02,06,21.7
021300,2011,03,28,16.1
022170,2011,01,15,13.2
022330,2011,12,17,26.6
026520,2011,02,21,22.1
023020,2011,10,20,32.6
025210,2011,03,01,28.6
022170,2011,03,22,32.5
021700,2011,01,16,14.5
023020,2011,01,12,19.2
021700,2011,12,21,21.5
022160,2011,02,15,7.8
022560,2011,01,26,10.5
026520,2011,02,23,19.4
024130,2011,01,15,6.8
020540,2011,01,02,14.5
023030,2011,01,06,14.6
022170,2011,01,01,25.8
022330,2011,12,03,23.9
022920,2011,11,28,28.5
023490,2011,01,15,-4.8
025530,2011,12,05,31.8
022560,2011,02,15,-1.0
023540,2011,03,14,30.4
021300,2011,02,07,6.0
023020,2011,08,01,57.0
022330,2011,09,14,49.1
024130,2011,05,01,41.2
022920,2011,11,25,37.0
026520,2011,08,17,62.2
022160,2011,10,28,41.7
025950,2011,06,05,60.1
023490,2011,02,24,3.1
024130,2011,01,24,22.0
023370,2011,09,30,53.5
022330,2011,04,06,36.3
026460,2011,07,11,64.3
023110,2011,04,06,38.8
022330,2011,04,05,37.5
021230,2011,12,02,30.4
021460,2011,12,10,23.2
022160,2011,12,28,28.4
023110,2011,10,20,30.9
020540,2011,01,03,0.7
022920,2011,02,04,16.4
020540,2011,01,09,4.8
020540,2011,01,07,3.2
025530,2011,02,28,24.6
021230,2011,11,20,22.0
021700,2011,12,19,31.9
021300,2011,12,05,25.1
022160,2011,02,18,4.0
022560,2011,12,25,25.0
023030,2011,11,27,23.1
023490,2011,01,01,19.4
026520,2011,01,03,17.6
023370,2011,02,17,10.6
024720,2011,12,09,32.0
021230,2011,12,30,13.1
022560,2011,12,31,12.7
023020,2011,02,16,8.2
022560,2011,02,04,12.6
023020,2011,11,27,29.3
023020,2011,04,09,35.9
024130,2011,04,12,38.2
025530,2011,09,01,50.4
023030,2011,03,25,12.8
026460,2011,08,24,61.3
026520,2011,08,22,62.0
680025,2011,01,13,73.2
026030,2011,09,18,57.3
022160,2011,08,17,52.3
023030,2011,02,24,5.8
024130,2011,02,24,5.0
026460,2011,06,20,58.0
022920,2011,04,05,38.9
022330,2011,10,07,40.8
021700,2011,06,04,56.0
026520,2011,08,10,58.0
021700,2011,02,19,-9.3
022160,2011,02,17,11.5
720747,2011,12,08,23.4
022330,2011,01,13,-6.5
025950,2011,02,14,17.3
023110,2011,12,14,29.4
023020,2011,01,11,28.0
021300,2011,01,10,9.9
020540,2011,12,29,12.8
023110,2011,11,26,29.5
025530,2011,02,22,10.3
023110,2011,02,16,9.1
020540,2011,01,11,16.0
020540,2011,12,05,28.0
026020,2011,01,28,27.9
021460,2011,12,27,25.6
022170,2011,12,12,19.7
024130,2011,02,22,6.0
021300,2011,01,03,-1.8
023490,2011,02,21,13.6
022330,2011,01,06,11.4
022560,2011,12,29,21.3
021230,2011,12,21,16.0
023370,2011,01,05,20.1
021700,2011,02,26,29.0
025950,2011,02,22,14.1
023030,2011,02,23,-0.4
023490,2011,02,02,25.7
023490,2011,06,23,53.7
023490,2011,12,25,30.0
024720,2011,04,19,48.5
720605,2011,05,27,70.6
025070,2011,08,28,56.6
022560,2011,10,03,40.7
023110,2011,10,18,38.2
025150,2011,10,04,56.5
026030,2011,07,02,67.6
026460,2011,03,28,36.2
022160,2011,06,28,65.1
023110,2011,05,15,38.8
023110,2011,07,26,54.8
023540,2011,04,10,42.6
021230,2011,05,26,36.9
025530,2011,08,05,61.7
022330,2011,04,08,30.9
720654,2011,08,17,77.4
023030,2011,10,31,37.1
023540,2011,07,15,56.8
025950,2011,07,26,64.8
720654,2011,10,03,55.9
720654,2011,06,25,79.3
022170,2011,05,28,45.4
011440,2011,06,07,50.3
025150,2011,03,13,37.6
023490,2011,09,04,58.2
021460,2011,12,23,25.4
021700,2011,07,11,67.1
023370,2011,05,15,41.1
720654,2011,10,24,57.3
025070,2011,12,25,44.1
720505,2011,10,12,71.7
023030,2011,07,14,51.9
026460,2011,01,05,30.6
021230,2011,11,09,29.2
025070,2011,07,08,61.1
023110,2011,11,05,39.0
026090,2011,08,27,64.9
026460,2011,05,10,54.6
022560,2011,09,10,49.0
024130,2011,11,04,43.3
025070,2011,11,24,47.3
72065

2025-01-18 09:08:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:08:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:08:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:08:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 09:08:39 - snowflake.connector.connection - INFO - closed
2025-01-18 09:08:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:08:39 - root - INFO - SQL:
SELECT "stn", COUNT("temp") AS "temp_count"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
   WHERE "temp" IS NOT NULL
   GROUP BY "stn"
   LIMIT 1000;
Results:
Too long, hard cut:
stn,temp_count
484150,364
488300,364
977220,356
873490,365
610960,362
247680,356
319870,365
345040,365
285880,365
333770,365
961630,365
471500,365
404170,363
370850,365
483600,363
973400,364
874480,364
360640,365
970480,365
383880,365
412460,338
427540,360
432130,360
620550,64
028720,363
484000,365
293480,365
875480,365
385990,359
874670,364
308620,365
296450,365
292820,365
470350,361
388950,365
297360,365
485320,365
249590,358
383410,365
330190,322
028140,363
133890,365
227210,365
432260,360
226210,365
357000,365
295570,365
610910,363
470700,355
710735,303
984300,365
624400,365
624170,360
542920,365
372790,358
766920,363
400300,346
789880,365
997738,364
691534,344
998007,363
723115,365
785350,352
337610,365
252820,360
347300,365
314890,365
343910,365
288070,365
610750,364
297120,365
294050,365
260290,362
280490,365
967910,360
263890,365
325830,365
483580,364
360960,365
471620,365
335870,365
471400,365
484200,364
345790,365
360580,365
261340,363
319150,365
278570,365
985310,352
484800,365
234120,365
485570,362
296250,365
299370,365
282140,365
272080,365
261440,363
710823,268
574260,365
423280,358
915510,356
719494,313
040130,364
423610,360
350110,365
427060,360
265180,365
597580,365
524180,365
504340,365
592930,365
535640,365
514310,365
543370,365
507270,365
314840,365
488030,364
982220,364
590230,365
323890,365
471920,365
966450,365
960870,365
345450,365
426230,360
402650,358
488870,364
221270,365
379250,310
423140,360
624550,363
624030,364
616950,364
108560,360
255630,365
672970,169
624190,261
875760,365
403610,364
870970,365
403570,364
406500,365
670020,365
574940,365
404390,364
027800,365
998426,365
997202,361
994780,194
128300,365
997258,365
129100,365
694604,244
995250,257
696824,218
722909,352
717334,246
995270,256
027280,258
997694,365
066100,365
718830,365
030080,365
719674,365
041650,365
994007,364
012250,365
997372,365
997257,340
725105,365
043390,364
723927,365
014670,342
720383,362
725755,365
027900,365
030940,365
994200,365
069900,365
995910,365
994042,263
027140,349
722180,365
722906,365
724020,365
726546,365
306730,365
485740,364
309350,365
470750,355
483720,364
319690,365
324080,365
634510,156
612400,340
961790,365
623250,351
727840,363
596630,365
538450,365
576620,365
572970,365
543740,365
470600,355
291220,365
471560,365
470280,355
253560,321
433140,360
509150,365
985380,365
766540,364
471350,365
599970,361
986460,365
326180,365
471540,365
485670,365
278350,363
987470,365
984440,365
710355,237
624230,365
718432,325
622590,83
782430,260
287190,3
654720,356
616000,363
351080,365
672830,171
172550,365
614150,358
279620,365
847820,365
040630,365
766753,365
768056,365
865800,365
845010,365
374840,365
042700,365
997386,362
994043,362
997224,325
997232,233
691226,354
028730,365
720952,61
710940,322
710964,365
027010,365
995720,329
997196,152
943170,352
995330,360
696464,57
722813,331
700638,355
697514,335
108570,365
106130,360
998442,193
027470,365
710930,362
747186,365
027310,346
702686,361
998266,363
997315,364
997993,359
997784,356
691344,346
718900,365
722485,365
725347,363
701338,335
998199,314
997434,346
011020,355
012380,346
010330,364
997293,364
992220,227
994033,365
997360,320
012120,361
076610,362
722535,365
742060,365
916420,75
013830,365
710563,364
747950,365
698444,351
996440,355
997299,364
997210,29
992090,174
704890,365
028760,365
997255,365
998254,362
994650,305
995700,363
997030,365
064280,362
028890,365
720361,364
722110,365
996470,365
030100,357
008404,95
128700,365
691284,2
698264,365
697284,365
995340,316
061970,270
061510,365
998405,365
061740,365
723105,365
747900,364
724505,365
725119,365
724275,365
067050,365
129250,363
998477,104
997197,186
998234,365
998434,277
992370,365
067600,365
998342,365
471270,365
725499,365
725420,365
066460,365
998226,365
994430,365
992620,302
992110,114
013400,365
691294,13
719130,365
039560,365
029640,365
107550,365
725763,353
725045,365
725717,365
726223,365
722069,365
726519,361
725514,364
722487,364
725945,365
722489,365
702670,365
725116,365
722060,365
727530,365
725025,365
722446,365
723676,363
725070,365
726654,365
722405,365
725300,365
725190,365
725320,365
723035,365
035200,365
726350,365
725555,365
722595,364
711510,365
699604,363
584770,365
549090,365
719064,310
764593,365
703054,359
898320,341
717365,349
010550,323
892690,144
697094,312
122120,350
010190,228
998436,303
108370,359
693684,198
042110,362
064960,361
712080,365
121540,350
066660,365
996490,365
102680,365
722269,365
710640,361
062520,363
725075,365
725395,365
994090,344
997207,365
725063,365
722650,365
727675,365
726435,365
724040,365
994044,365
994230,365
722541,365
723037,363
997205,258
997200,106
994350,365
998204,362
717390,365
725287,365
725460,365
720198,365
998486,68
039610,365
718960,365
061470,347
039760,365
725376,365
722039,365
726930,365
724463,365
726620,365
724453,365
722500,365
997192,238
724066,365
723170,365
745046,365
725016,365
723346,365
221000,4
060110,365
642100,363
414430,361
800010,365
862180,365
896670,365
998005,365
722151,365
011350,33
745056,

2025-01-18 09:08:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:08:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:08:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:08:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 09:08:41 - snowflake.connector.connection - INFO - closed
2025-01-18 09:08:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:08:41 - root - INFO - SQL:
SELECT "stn", "year", "mo", "da", "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
    WHERE "temp" IS NOT NULL
    LIMIT 1000;
Results:
Too long, hard cut:
stn,year,mo,da,temp
010070,2020,11,10,25.2
010070,2020,11,19,18.8
010350,2020,04,12,19.3
010370,2020,12,28,33.1
010420,2020,03,01,18.0
010430,2020,02,29,22.8
011020,2020,10,13,47.9
011020,2020,09,30,56.4
011070,2020,12,19,39.7
011210,2020,10,20,38.7
011440,2020,11,28,43.8
011480,2020,10,11,44.8
011580,2020,09,12,52.4
011980,2020,12,09,34.0
012120,2020,09,26,49.8
012210,2020,10,12,39.2
012500,2020,03,08,28.6
012620,2020,11,24,44.9
012820,2020,11,14,44.5
012820,2020,12,19,41.0
012870,2020,09,08,44.8
012880,2020,10,14,34.3
012900,2020,11,07,46.4
013360,2020,12,25,23.8
013450,2020,10,22,36.5
013450,2020,12,10,28.8
013460,2020,12,25,17.0
013470,2020,12,25,22.4
013570,2020,10,05,49.3
013590,2020,12,17,25.5
013590,2020,10,12,33.6
013590,2020,11,18,41.3
013590,2020,12,02,26.7
013590,2020,09,04,48.4
013590,2020,11,04,35.0
013600,2020,01,06,37.5
013620,2020,11,02,26.7
013680,2020,12,29,27.9
013680,2020,12,20,34.9
013760,2020,09,24,53.6
013780,2020,10,11,46.9
014140,2020,11,02,51.3
014140,2020,11,01,50.9
014400,2020,10,31,36.2
014400,2020,12,08,28.9
014660,2020,09,10,54.7
014840,2020,10,06,50.9
014881,2020,09,18,54.9
024960,2020,12,22,42.4
034145,2020,06,14,60.8
034145,2020,11,11,51.8
038060,2020,11,14,54.0
038060,2020,01,11,50.0
040131,2020,12,24,43.2
040340,2020,01,26,33.6
040340,2020,12,04,20.8
040640,2020,03,17,34.2
040655,2020,08,25,48.2
040655,2020,04,23,43.2
040730,2020,10,27,29.6
040850,2020,10,05,43.8
041620,2020,12,26,9.2
070530,2020,04,24,59.2
070530,2020,03,02,43.7
070530,2020,08,03,61.8
070530,2020,07,27,71.7
070530,2020,08,15,69.8
070530,2020,01,09,52.8
070530,2020,03,31,42.6
070530,2020,03,09,44.9
070530,2020,07,02,64.0
070530,2020,10,18,43.4
070530,2020,03,01,42.8
070530,2020,09,05,61.6
070530,2020,09,24,52.6
070530,2020,06,06,56.8
070530,2020,04,14,44.4
070530,2020,07,06,60.9
070530,2020,10,17,47.9
070530,2020,09,11,64.2
070530,2020,01,12,44.2
072553,2020,06,15,67.6
076780,2020,09,15,77.1
084580,2020,05,13,60.4
084580,2020,04,02,56.6
085020,2020,08,23,74.8
085020,2020,11,10,59.7
085020,2020,09,20,69.6
085020,2020,01,06,63.9
085020,2020,02,13,60.2
085020,2020,04,25,61.3
085020,2020,09,02,76.7
085020,2020,02,12,62.3
085020,2020,05,20,61.5
085020,2020,02,14,59.8
085020,2020,10,20,63.6
085020,2020,01,26,57.0
085020,2020,02,03,56.3
085020,2020,06,17,63.6
085020,2020,05,30,64.4
085020,2020,10,09,71.7
085020,2020,06,26,67.3
085095,2020,02,18,57.3
085095,2020,10,16,66.2
085440,2020,12,28,53.4
085440,2020,10,03,56.9
085440,2020,10,26,57.1
085440,2020,12,01,58.6
085440,2020,11,21,59.0
085440,2020,12,24,48.3
085830,2020,06,22,79.4
085830,2020,12,29,73.0
085830,2020,07,21,80.8
085830,2020,01,18,72.2
085830,2020,07,10,81.9
085830,2020,01,05,71.7
085830,2020,01,27,72.2
085830,2020,04,03,74.7
085830,2020,04,12,74.9
085830,2020,05,29,77.6
085830,2020,01,17,72.2
085830,2020,12,11,74.5
085890,2020,07,20,81.1
085890,2020,10,11,80.6
085890,2020,04,15,75.0
085890,2020,08,18,82.0
085890,2020,08,27,80.1
085890,2020,01,03,73.6
085890,2020,11,04,79.0
085890,2020,01,30,78.1
085890,2020,01,23,74.8
085890,2020,12,28,73.5
085890,2020,09,27,81.6
085890,2020,06,19,79.7
085890,2020,12,04,77.1
085890,2020,07,05,78.7
085890,2020,02,14,80.6
085890,2020,03,03,78.3
085890,2020,05,14,74.5
085944,2020,06,05,80.6
085944,2020,06,16,84.2
120010,2020,08,30,65.6
120010,2020,09,18,57.2
120010,2020,04,21,43.8
120010,2020,12,15,39.6
120010,2020,07,21,60.7
120010,2020,07,29,60.8
120010,2020,05,26,44.4
120010,2020,05,16,46.5
120010,2020,06,17,55.0
120010,2020,09,27,63.8
120010,2020,06,30,62.9
120010,2020,06,29,65.3
120010,2020,10,09,56.0
120010,2020,01,16,43.3
120010,2020,10,26,51.8
120010,2020,06,23,58.7
120010,2020,04,06,46.7
120010,2020,07,23,59.0
120010,2020,04,22,45.0
125000,2020,04,13,37.6
125000,2020,10,07,55.7
133630,2020,12,22,36.3
133630,2020,08,10,67.6
134615,2020,03,11,47.1
134930,2020,04,10,52.9
135750,2020,12,31,40.5
135750,2020,04,10,57.2
135760,2020,02,21,32.9
135760,2020,01,31,39.9
135760,2020,02,15,33.1
135760,2020,04,04,32.5
135760,2020,02,23,38.7
135770,2020,04,04,35.7
135770,2020,04,21,45.4
135800,2020,12,25,53.0
135880,2020,04,23,58.9
135880,2020,04,12,63.6
135910,2020,04,12,62.2
135940,2020,05,07,56.6
135950,2020,01,16,32.8
135950,2020,05,04,62.1
135970,2020,03,27,47.8
135970,2020,09,15,81.5
135970,2020,06,29,89.9
135970,2020,12,25,43.9
140070,2020,03,14,37.6
140150,2020,03,14,48.2
141180,2020,03,11,48.5
144430,2020,01,11,54.9
144460,2020,01,09,49.5
146480,2020,09,13,83.8
155257,2020,01,03,34.2
161010,2020,06,04,64.8
162580,2020,02,07,35.9
163160,2020,11,16,54.5
164340,2020,03,27,35.6
164340,2020,01,10,45.5
165310,2020,02,10,62.2
165410,2020,06,12,64.0
165420,2020,03,27,46.9
165420,2020,07,24,86.9
165420,2020,09,18,79.7
165420,2020,08,21,85.1
165420,2020,10,02,71.1
165990,2020,02,01,58.3
165990,2020,01,10,52.7
166140,2020,03,02,46.7
166181,2020,10,30,57.6
166653,2020,12,26,64.0
166653,2020,06,08,77.4
166653,2020,12,01,47.8
166653,2020,12,12,58.1
166750,2020,10,28,56.5
167100,2020,10,21,53.2
167190,2020,04,03,57.4
167190,2020,0

2025-01-18 09:08:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:08:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:08:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:08:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 09:08:43 - snowflake.connector.connection - INFO - closed
2025-01-18 09:08:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:08:43 - root - INFO - SQL:
SELECT DISTINCT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    WHERE "stn" IN (
        SELECT "usaf"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    )
    LIMIT 1000;
Results:
Too long, hard cut:
stn
484150
488300
337610
319870
404170
873490
345040
247680
252820
285880
471500
314890
288070
360640
388950
297120
249590
260290
432130
343910
333770
970480
973400
874480
383880
620550
875480
874670
383410
306730
028140
412460
385990
296450
330190
292820
470350
360580
278570
985310
484800
299370
488870
710355
287190
427540
967910
227210
471620
357000
470750
710823
623250
514310
314840
471560
986460
345450
984440
616000
121540
701338
718432
722535
347300
484000
610960
961630
977220
297360
280490
325830
263890
483580
360960
335870
471400
484200
295570
261440
982220
597580
542920
535640
543370
766540
966450
624550
694604
998007
027280
483600
610750
293480
485320
294050
308620
485740
226210
345790
261340
319150
234120
485570
610910
296250
470700
319690
324080
634510
612400
309350
433140
524180
504340
596630
538450
584770
543740
549090
372790
291220
323890
471920
599970
326180
960870
471540
485670
379250
622590
654720
351080
108560
672970
279620
847820
403610
406500
768056
865800
374840
042700
697094
691534
723115
998436
108570
106130
042110
722909
997784
997434
030080
012120
722269
742060
996440
726435
061510
723105
725119
997197
998234
717390
725025
624400
766920
614150
870970
997202
898320
010550
892690
696824
710930
066660
012380
994650
997030
725063
128700
043390
725499
039760
725763
725070
370850
028720
471350
719064
574940
432260
483720
282140
961790
423280
915510
040130
350110
624170
427060
265180
727840
592930
576620
590230
470280
253560
488030
509150
985380
426230
221270
400300
423140
782430
672830
616950
875760
040630
403570
703054
789880
027800
997386
998426
994043
994780
128300
997258
995250
710940
010190
696464
722813
995270
702686
997694
066100
998266
747186
697514
997315
712080
691344
718900
725347
719674
997293
785350
012250
725075
698444
997372
725395
704890
997255
998254
028890
030100
727675
998405
724040
724275
722541
066460
998226
997200
994042
998204
992110
039560
107550
722906
998486
725514
722487
745046
725300
726350
272080
710735
984300
574260
507270
470600
987470
624230
172550
764593
766753
670020
845010
404390
717365
129100
028730
720952
122120
710964
108370
027470
995720
717334
997993
718830
722485
011020
010330
041650
996490
994033
102680
997360
710640
013830
710563
747950
997299
997257
992090
028760
064280
720361
722110
725105
722650
698264
697284
014670
061970
027900
067050
129250
998477
998434
067600
994230
994200
069900
471270
725420
723037
997205
994350
013400
691294
029640
722180
725045
725717
725287
726223
725460
724066
720198
726519
725945
702670
727530
725016
726930
724020
723676
724463
726654
726546
722500
722595
997224
064960
995700
691284
030940
992370
995910
718960
061470
722060
722446
723035
711510
699604
997192
278350
624190
997232
997196
994007
997210
720383
994430
133890
719494
423610
572970
402650
624030
255630
997738
027310
943170
995330
700638
998442
992220
062520
994090
997207
996470
723927
995340
061740
747900
725755
994044
998342
992620
719130
027140
722069
725376
723170
726620
724453
725320
035200
723346
725555
916420
724505
039610
722489
725190
027010
722039
725116
722405
076610
998199
724250
060110
414430
862180
722151
011350
725214
726818
722195
722678
025630
726824
221000
642100
800010
896670
998005
745056
722190
746410
727910
725374
085450
722014
723320
726517
726410
718210
726667
727810
722517
725125
725240
725260
725100
722170
724988
029470
942160
010890
013500
911650
727850
747400
746120
716340
474280
724455
724645
476530
727676
700637
722416
722358
020440
948750
028640
022610
076780
911860
723710
943270
013210
062100
727976
722764
702910
747590
387250
022170
021230
682905
720743
369740
035660
676930
020540
026090
720605
720406
369820
680300
643600
679770
720411
965050
842700
637420
604592
787935
637090
677650
480250
722907
679750
040131
841490
804230
634740
839420
836720
837780
255520
416200
030220
166990
167341
787450
744659
409040
726764
836724
858360
722201
162210
720623
265020
726396
787670
066580
827641
784390
844550
977800
725495
407807
333931
720627
786470
912460
378630
013755
692164
723122
646500
060100
475150
466960
692174
720283
840760
085020
474770
653765
010881
679910
637720
484076
722211
338388
476830
475670
131160
068065
720375
037663
722177
232210
384010
722666
155257
477350
106164
035413
444540
830630
783334
722052
478720
619840
837590
485575
067940
400830
844440
480200
720371
722163
722089
238045
858640
948955
724833
722334
021610
852450
823170
162592
475420
475690
021205
787140
163500
722182
162591
724043
477890
825991
827040
471280
726391
931190
026510
720254
649500
835250
132420
722073
726468
720295
682400
720622
838400
726405
858320
742078
722081
431285
287220
720869
720165
282250
307100
232215
279622
024853
722183
353948
720565
156150
289520
275155
080001
471630
123767
720612
720583
031600
725406
060800
172410
013110
085120
024930
060300
720608
833620
802220
725408
725489
726548
726553
744661
720327
722154
742513
722071
723761
723055
726603
171700
824000
410360
161790
483270
686140
864500
844250
432210
298020
601850
443480
86360

2025-01-18 09:08:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:08:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:08:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:08:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 09:08:45 - snowflake.connector.connection - INFO - closed
2025-01-18 09:08:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:08:45 - root - INFO - SQL:
SELECT DISTINCT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    WHERE "year" BETWEEN '2011' AND '2020'
    LIMIT 1000;
Results:
Too long, hard cut:
stn
484150
488300
977220
873490
610960
247680
319870
345040
285880
333770
961630
471500
404170
370850
483600
973400
874480
360640
970480
383880
412460
427540
432130
620550
028720
484000
293480
875480
385990
874670
308620
296450
292820
470350
388950
297360
485320
249590
383410
330190
028140
133890
227210
432260
226210
357000
295570
610910
470700
710735
984300
624400
624170
542920
372790
766920
337610
252820
347300
314890
343910
288070
610750
297120
294050
260290
280490
967910
263890
325830
483580
360960
471620
335870
471400
484200
345790
360580
261340
319150
278570
985310
484800
234120
485570
296250
299370
282140
272080
261440
710823
574260
423280
915510
719494
040130
423610
350110
427060
265180
597580
524180
504340
592930
535640
514310
543370
507270
314840
488030
982220
590230
323890
306730
485740
309350
470750
483720
319690
324080
634510
612400
961790
623250
727840
596630
576620
572970
543740
471560
470280
253560
433140
538450
584770
549090
470600
291220
966450
060110
471350
278350
345450
221270
984440
426230
960870
471920
402650
718432
400300
691226
986460
624550
326180
379250
996440
719064
509150
599970
221000
985380
987470
423140
387250
026090
022170
020540
021230
720605
369820
369740
726603
702755
787935
844550
021610
237010
965050
670850
720406
720743
480200
637090
679610
840760
066820
977800
067940
633310
836720
085020
725495
839420
630210
035660
722907
162210
637720
338388
060100
679770
744653
858360
255520
726396
400830
654720
804230
722032
677650
672970
692164
475670
155257
409040
131160
172550
040131
444540
803420
720627
484076
676930
722081
010881
722201
167341
653765
693614
679750
384010
679910
477350
725454
474770
830630
035413
032145
037663
167193
837780
720583
634740
722052
476830
744659
851960
836724
766546
478720
619840
827641
837590
683210
692174
783334
722334
722089
722177
070700
637420
823170
722866
766580
109470
836490
155256
723055
725457
478560
475690
475420
477890
682677
724043
162592
330005
649500
162591
827040
804100
407807
232210
723529
265020
722091
027140
801390
787670
238045
172050
068065
787450
604592
485575
858320
720254
106164
784390
787140
722163
480250
723676
680300
636580
353948
766127
852450
163500
786470
021205
333931
416200
682905
720602
842260
612970
701338
722182
650020
724026
132890
029470
166990
554720
722128
724833
768556
700638
726553
723761
787410
066580
672830
804470
407823
868910
024930
720739
643600
720411
841490
842700
030220
722666
720623
064280
726764
722211
720375
844440
720371
858640
725453
725479
825991
642100
948955
648100
432210
113080
643900
844250
266295
108370
722369
108560
726391
684420
031350
835250
720345
256770
027570
483770
027590
873710
273690
341520
485170
485700
239550
253780
260590
268870
483070
249510
970860
433290
431890
383340
433460
430860
266450
388060
485660
443470
228450
306030
321650
252480
347200
484580
443290
135830
310880
484250
246390
385110
027690
421110
874160
655050
262260
483740
969870
443850
350260
876410
265240
259540
860970
471880
589110
279950
526520
511560
484550
248560
279280
341710
876450
442370
134620
251380
471360
297240
973000
279060
027890
236620
484770
333170
348800
060120
355760
965290
470950
484010
285730
314450
470520
976900
313000
263590
282400
332750
348660
610990
292310
320980
960730
309490
484090
962950
484530
655100
484130
296050
433210
336630
360380
470610
442170
331350
485810
986440
485550
470460
219310
424520
428860
987410
548430
516440
536140
561870
509490
540260
318250
763930
412700
578660
524950
533910
442120
317020
442130
895320
355320
471520
969350
483250
331770
214320
484350
021510
285410
320610
314780
428400
585560
596320
433330
040050
995400
623870
571780
540270
132780
272420
360610
303370
624320
531490
442560
485610
344150
537980
294300
718437
314740
988510
975700
247240
306860
470580
290230
402550
862210
916100
864600
692484
996570
623050
718442
428740
425590
710354
431170
582030
599810
577990
202920
889680
976300
620120
575840
433530
378510
509630
579320
784860
421820
010014
025070
021300
023540
024130
725621
384620
720381
112410
066120
112520
108600
678690
820305
010885
686680
846730
312850
703056
634020
067450
701719
847350
042605
036440
701196
702550
636304
010883
407127
720853
875060
836725
034920
073170
702711
700634
702647
470220
787421
724293
484075
488460
740002
804570
637140
476435
637410
749171
718755
476600
401761
348610
786390
470050
685380
067530
804120
031140
038030
637260
839810
031394
879340
854590
160595
787625
266661
720339
414370
161220
787945
475490
475530
477790
851040
155258
786445
835880
639320
917830
414520
783841
010876
720257
747808
831110
766534
846580
720867
812000
652500
692214
646010
684380
693594
620100
804340
128605
160520
474790
477940
836980
039240
485577
286760
381417
724395
342140
725337
703870
828240
800970
165420
800630
785140
106163
711810
121053
724694
652010
677790
804130
042025
474900
677610
787930
724165
726417
724014
726404
478570
014033
726568
407821
489410
480370
111460
804370
840360
720374
841430
744672
646650
720494
704140
413410
722214
43336

2025-01-18 09:08:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:08:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:08:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:08:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-18 09:08:46 - snowflake.connector.connection - INFO - closed
2025-01-18 09:08:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:09:59 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 09:09:59 - root - INFO - ```sql
WITH nearby_stations AS (
    SELECT LPAD(TRIM("usaf"), 6, '0') AS station_id, "name"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    WHERE "lat" IS NOT NULL AND "lon" IS NOT NULL
      AND "usaf" IS NOT NULL AND TRIM("usaf") != ''
      AND ST_DWITHIN(
          TO_GEOGRAPHY('POINT(' || "lon" || ' ' || "lat" || ')'),
          TO_GEOGRAPHY('POINT(-73.764 41.197)'),
          32186.8
      )
)

SELECT
    ns.station_id,
    ns."name" AS station_name,
    COUNT(g."temp") AS number_of_temperature_observations
FROM
    nearby_stations ns
JOIN (
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
) g ON ns.station_id = g.station_id
GROUP BY
    ns.station_id, ns."name";
```
2025-01-18 09:09:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:09:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:09:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:10:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-18 09:10:01 - snowflake.connector.connection - INFO - closed
2025-01-18 09:10:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:10:01 - root - INFO - SQL:
WITH nearby_stations AS (
    SELECT LPAD(TRIM("usaf"), 6, '0') AS station_id, "name"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    WHERE "lat" IS NOT NULL AND "lon" IS NOT NULL
      AND "usaf" IS NOT NULL AND TRIM("usaf") != ''
      AND ST_DWITHIN(
          TO_GEOGRAPHY('POINT(' || "lon" || ' ' || "lat" || ')'),
          TO_GEOGRAPHY('POINT(-73.764 41.197)'),
          32186.8
      )
)

SELECT
    ns.station_id,
    ns."name" AS station_name,
    COUNT(g."temp") AS number_of_temperature_observations
FROM
    nearby_stations ns
JOIN (
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
) g ON ns.station_id = g.station_id
GROUP BY
    ns.station_id, ns."name";
Results:
STATION_ID,STATION_NAME,NUMBER_OF_TEMPERATURE_OBSERVATIONS
999999,WHITE PLAINS WESTCHESTER CO A,1123769
725086,DANBURY MUNI ARPT,3649
999999,BEAR MOUNTAIN WB,1123769
997186,WESTERN LONG ISLAND SOUND,1532
725037,WESTCHESTER COUNTY AIRPORT,3653
725086,DANBURY MUNICIPAL AIRPORT,3649

2025-01-18 09:10:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:10:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:10:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:10:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 09:10:03 - snowflake.connector.connection - INFO - closed
2025-01-18 09:10:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:11:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 09:11:05 - root - INFO - ```sql
WITH nearby_stations AS (
    SELECT "usaf" AS station_id, "name"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    WHERE ST_DWITHIN(
        TO_GEOGRAPHY('POINT(' || "lon" || ' ' || "lat" || ')'),
        TO_GEOGRAPHY('POINT(-73.764 41.197)'),
        32186.8
    )
)

SELECT
    ns.station_id,
    ns."name" AS station_name,
    COUNT(*) AS number_of_temperature_observations
FROM
    nearby_stations ns
JOIN (
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
) g ON ns.station_id = g."stn"
GROUP BY
    ns.station_id, ns."name";
```
2025-01-18 09:11:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:11:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:11:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:11:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-18 09:11:07 - snowflake.connector.connection - INFO - closed
2025-01-18 09:11:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:11:07 - root - INFO - SQL:
WITH nearby_stations AS (
    SELECT "usaf" AS station_id, "name"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    WHERE ST_DWITHIN(
        TO_GEOGRAPHY('POINT(' || "lon" || ' ' || "lat" || ')'),
        TO_GEOGRAPHY('POINT(-73.764 41.197)'),
        32186.8
    )
)

SELECT
    ns.station_id,
    ns."name" AS station_name,
    COUNT(*) AS number_of_temperature_observations
FROM
    nearby_stations ns
JOIN (
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
) g ON ns.station_id = g."stn"
GROUP BY
    ns.station_id, ns."name";
Results:
STATION_ID,STATION_NAME,NUMBER_OF_TEMPERATURE_OBSERVATIONS
725086,DANBURY MUNICIPAL AIRPORT,3649
999999,WHITE PLAINS WESTCHESTER CO A,1123769
725086,DANBURY MUNI ARPT,3649
999999,BEAR MOUNTAIN WB,1123769
997186,WESTERN LONG ISLAND SOUND,1532
725037,WESTCHESTER COUNTY AIRPORT,3653

2025-01-18 09:11:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:11:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:11:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:11:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 09:11:09 - snowflake.connector.connection - INFO - closed
2025-01-18 09:11:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:11:09 - root - INFO - SQL:
SELECT "stn", COUNT(*) AS "days_of_data"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    WHERE "temp" IS NOT NULL
    GROUP BY "stn"
    LIMIT 1000;
Results:
Too long, hard cut:
stn,days_of_data
484150,364
488300,364
977220,356
873490,365
610960,362
247680,356
319870,365
345040,365
285880,365
333770,365
961630,365
471500,365
404170,363
370850,365
483600,363
973400,364
874480,364
360640,365
970480,365
383880,365
412460,338
427540,360
432130,360
620550,64
028720,363
484000,365
293480,365
875480,365
385990,359
874670,364
308620,365
296450,365
292820,365
470350,361
388950,365
297360,365
485320,365
249590,358
383410,365
330190,322
028140,363
133890,365
227210,365
432260,360
226210,365
357000,365
295570,365
610910,363
470700,355
710735,303
984300,365
624400,365
624170,360
542920,365
372790,358
766920,363
400300,346
789880,365
997738,364
691534,344
998007,363
723115,365
785350,352
337610,365
252820,360
347300,365
314890,365
343910,365
288070,365
610750,364
297120,365
294050,365
260290,362
280490,365
967910,360
263890,365
325830,365
483580,364
360960,365
471620,365
335870,365
471400,365
484200,364
345790,365
360580,365
261340,363
319150,365
278570,365
985310,352
484800,365
234120,365
485570,362
296250,365
299370,365
282140,365
272080,365
261440,363
710823,268
574260,365
423280,358
915510,356
719494,313
040130,364
423610,360
350110,365
427060,360
265180,365
597580,365
524180,365
504340,365
592930,365
535640,365
514310,365
543370,365
507270,365
314840,365
488030,364
982220,364
590230,365
323890,365
471920,365
966450,365
960870,365
345450,365
426230,360
402650,358
488870,364
221270,365
379250,310
423140,360
624550,363
624030,364
616950,364
108560,360
255630,365
672970,169
624190,261
875760,365
403610,364
870970,365
403570,364
406500,365
670020,365
574940,365
404390,364
027800,365
998426,365
997202,361
994780,194
128300,365
997258,365
129100,365
694604,244
995250,257
696824,218
722909,352
717334,246
995270,256
027280,258
997694,365
066100,365
718830,365
030080,365
719674,365
041650,365
994007,364
012250,365
997372,365
997257,340
725105,365
043390,364
723927,365
014670,342
720383,362
725755,365
027900,365
030940,365
994200,365
069900,365
995910,365
994042,263
027140,349
722180,365
722906,365
724020,365
726546,365
306730,365
485740,364
309350,365
470750,355
483720,364
319690,365
324080,365
634510,156
612400,340
961790,365
623250,351
727840,363
596630,365
538450,365
576620,365
572970,365
543740,365
470600,355
291220,365
471560,365
470280,355
253560,321
433140,360
509150,365
985380,365
766540,364
471350,365
599970,361
986460,365
326180,365
471540,365
485670,365
278350,363
987470,365
984440,365
710355,237
624230,365
718432,325
622590,83
782430,260
287190,3
654720,356
616000,363
351080,365
672830,171
172550,365
614150,358
279620,365
847820,365
040630,365
766753,365
768056,365
865800,365
845010,365
374840,365
042700,365
997386,362
994043,362
997224,325
997232,233
691226,354
028730,365
720952,61
710940,322
710964,365
027010,365
995720,329
997196,152
943170,352
995330,360
696464,57
722813,331
700638,355
697514,335
108570,365
106130,360
998442,193
027470,365
710930,362
747186,365
027310,346
702686,361
998266,363
997315,364
997993,359
997784,356
691344,346
718900,365
722485,365
725347,363
701338,335
998199,314
997434,346
011020,355
012380,346
010330,364
997293,364
992220,227
994033,365
997360,320
012120,361
076610,362
722535,365
742060,365
916420,75
013830,365
710563,364
747950,365
698444,351
996440,355
997299,364
997210,29
992090,174
704890,365
028760,365
997255,365
998254,362
994650,305
995700,363
997030,365
064280,362
028890,365
720361,364
722110,365
996470,365
030100,357
008404,95
128700,365
691284,2
698264,365
697284,365
995340,316
061970,270
061510,365
998405,365
061740,365
723105,365
747900,364
724505,365
725119,365
724275,365
067050,365
129250,363
998477,104
997197,186
998234,365
998434,277
992370,365
067600,365
998342,365
471270,365
725499,365
725420,365
066460,365
998226,365
994430,365
992620,302
992110,114
013400,365
691294,13
719130,365
039560,365
029640,365
107550,365
725763,353
725045,365
725717,365
726223,365
722069,365
726519,361
725514,364
722487,364
725945,365
722489,365
702670,365
725116,365
722060,365
727530,365
725025,365
722446,365
723676,363
725070,365
726654,365
722405,365
725300,365
725190,365
725320,365
723035,365
035200,365
726350,365
725555,365
722595,364
711510,365
699604,363
584770,365
549090,365
719064,310
764593,365
703054,359
898320,341
717365,349
010550,323
892690,144
697094,312
122120,350
010190,228
998436,303
108370,359
693684,198
042110,362
064960,361
712080,365
121540,350
066660,365
996490,365
102680,365
722269,365
710640,361
062520,363
725075,365
725395,365
994090,344
997207,365
725063,365
722650,365
727675,365
726435,365
724040,365
994044,365
994230,365
722541,365
723037,363
997205,258
997200,106
994350,365
998204,362
717390,365
725287,365
725460,365
720198,365
998486,68
039610,365
718960,365
061470,347
039760,365
725376,365
722039,365
726930,365
724463,365
726620,365
724453,365
722500,365
997192,238
724066,365
723170,365
745046,365
725016,365
723346,365
060110,365
029470,363
800010,365
414430,361
942160,355
010890,362
746120,365
896670,365
013500,322
722195,365
71

2025-01-18 09:11:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:11:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:11:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:11:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-18 09:11:10 - snowflake.connector.connection - INFO - closed
2025-01-18 09:11:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:11:11 - root - INFO - SQL:
SELECT DISTINCT "year"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    LIMIT 1000;
Results:
year
2011

2025-01-18 09:11:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:11:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:11:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:11:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 09:11:13 - snowflake.connector.connection - INFO - closed
2025-01-18 09:11:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:11:13 - root - INFO - SQL:
SELECT "usaf", "name", "begin", "end"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    WHERE "begin" <= '20110101' AND "end" >= '20201231'
    LIMIT 1000;
Results:
Too long, hard cut:
usaf,name,begin,end
010240,PYRAMIDEN,19730101,20210918
010470,KAUTOKEINO II,19730101,20210917
011560,BO I VESTERALEN,20040510,20210913
011980,DIVIDALEN II,20100114,20210918
012210,TAGDALEN,20080115,20210909
012390,HJERKINN II,20100907,20210906
014110,KVITSOY - NORDBO,20050612,20210915
014120,OBRESTAD,19730101,20210909
025010,VADEROARNA,19770804,20210916
030410,AONACH MOR,19920302,20210916
030650,CAIRNGORM SUMMIT,19850106,20210610
031620,ESKDALEMUIR,19291001,20210916
032660,LINTON ON OUSE,19730101,20210901
034145,COSFORD,19940831,20210914
035715,CAMBRIDGE,19770201,20210917
039520,ROCHES POINT,19291001,20210913
039610,OAK PARK - CARLOW,20080721,20210918
039790,BALLYHAISE,20080721,20210918
060110,TORSHAVN,19310103,20210701
060440,HALS,19860614,20210827
060994,OKSBOEL,20050530,20210826
070220,VIGITE DU HAUMET,19760302,20210715
070290,PORT EN BESSIN,19840101,20210715
070340,CARTERET,19861001,20210715
070530,CORMEILLES,19730107,20210715
070570,CREIL,19400713,20210728
070590,MEAULTE,19400617,20210818
071020,POINTE ST MATHIEU,19831208,20210715
071030,POINTE DU RAZ,19730101,20210715
071160,BATZ ISLAND,19760708,20210715
071210,BREHAT ISLAND,19360105,20210715
071330,POINTE DU ROC,19730101,20210715
072000,PENMARCH,19360102,20210715
072160,CHEMOULIN,20010919,20210715
073170,BISCAROSSE / PARENTIS,20040803,20210715
074770,LES SAUVAGES,19730101,20210715
074870,GRENONBLE LVD,20050201,20210715
074990,CHAMONIX-OBS,20100612,20210614
075860,CARPENTRAS,19760309,20210715
075890,ST CHRISTOPHE,19360702,20210714
075900,LES PORTES EN VALGAUDEMAR,20060109,20210714
075910,EMBRUN,19730101,20210624
075930,BRIANCON,19340801,20210707
076280,MURET-LHERM,20100611,20210715
076293,LHERM,20100611,20210714
076310,FRANCAZAL,19310101,20210715
076510,L'ESPIGUETTE,19841201,20210715
076530,CAP COURONNE,19750715,20210715
076560,BEC DE LAIGLE,19760309,20210715
076770,CAPE CAMARAT,19750715,20210715
076780,TOULON/ILE DU LEVAN,19760309,20210715
076810,LE DRAMONT,20090801,20210715
076880,LA GAROUPE,19750916,20210715
077520,LA PARATA,19360617,20210715
077680,LA CHIAPPA,19360615,20210715
077910,CAPE SAGRO,19431204,20210715
078760,LE GRAND BORNAND,20090901,20210326
081570,DAROCA I,19730101,20210419
085155,GRACIOSA,20050719,20210509
085300,CABO CARVOEIRO,19480111,20210821
085490,COIMBRA,19480111,20210104
089600,VALDELINARES  'ESQUI'        ,20031222,20210917
110080,ROHRBACH,19761101,20210702
111090,ST ANTON AM ARLBERG,19820301,20210327
111440,ZELL AM SEE (AUT)            ,19661003,20210826
111730,FISHBACH,20060711,20210219
111930,BAD TATZMANNSDORF,20060726,20210219
112340,BAD EISENKAPPEL,20040619,20210413
112600,MALLNITZ-BAD,19901201,20210910
112630,WEISSENSEE/GATSCHACH,20040610,20210219
112780,POERTSCHACH,20080310,20210324
113480,MARIAPFARR,19911102,20210219
123764,NOWA DEBA,20090908,20210609
125560,KRAKOW/BALICE,20020601,20210810
160140,VIPITENO,20050727,20210804
160230,TRENTO,20070605,20210804
160600,TORINO VENARIA,20050727,20210127
160890,DESENZANO,20050727,20210531
161320,BOLOGNA,20050727,20210519
161900,ANCONA,19490403,20210917
162880,CASERTA,20050727,20210309
163180,MARTINA FRANCA,19730915,20210901
165840,BARI PALESE,20070822,20210128
221000,VERKHOV'E R LOTTA,19600220,20210708
226860,VENDINGA,19590101,20210915
229960,OB'JACEVO,19590101,20210908
233300,SALEHARD,19320101,20210903
237110,TROICKO-PECHERSKOE,19320101,20210911
238230,VONEGAN,19700108,20210618
262980,BOLOGOE,19590807,20210918
263890,OSTASKOV,19590102,20210907
263930,VYSNIJ VOLOCEK,19320101,20210918
264790,TOROPEC,19631204,20210914
265020,PALANGA INTL,19590101,20210905
265780,VELIZH,19590803,20210918
265850,BELYJ,19480101,20210914
267110,CHERNYAHOVSK,19590101,20210918
267840,POCHINOK,19881201,20210818
271640,KOLOGRIV,19590103,20210918
272080,MAKSATIKHA,19881201,20210917
272420,BUJ,19460102,20210912
272520,NIKOLO-POLOMA,19590101,20210914
272710,SAR'JA,19361231,20210916
273160,KASIN,19590101,20210910
273470,IVANOVO,19361231,20210918
273550,JUR'EVEC,19550301,20210911
274020,TVER'                        ,19460101,20210914
274170,KLIN,19840511,20210906
275230,PAVLOVSKIJ POSAD,19590101,20210827
275320,VLADIMIR,19460307,20210914
275390,GUS'-HRUSTAL'NYJ,19590101,20210904
276270,KASIRA,19590823,20210917
276970,TETYUSHI,19620414,20210918
277760,SURSKOE,19590101,20210905
278350,RJAZSK,19881108,20210629
278580,PACELMA,19590101,20210911
278720,INZA,19570701,20210917
278940,NOVODEVIC'E,19620621,20210916
279550,BELINSKIY,19740820,20210906
279830,SYZRAN'                      ,19590101,20210914
279950,SAMARA (BEZENCHUK)           ,19320102,20210903
281160,KUDYMKAR,19460309,20210712
283660,JARKOVO,19530216,20210809
283670,TYUMEN'                      ,19320101,20210905
284650,JALTUROVOSK,19530216,20210918
284910,BOL'SIE UKI,19550101,20210913
285060,ELABUGA,19460101,20210914
285170,MENZELINSK,20050828,20210827
285930,BOL'SHERECH'E,19480101,20210809
286870,BULAJEVO,19590101,20210102
287040,CULPANOVO,19590101,20210917
287050,CELNO-VERSINY,19611205,20210911
305540,BAGDARIN,19480101,20210918
308220,BABUSKIN,19530216,

2025-01-18 09:11:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:11:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:11:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:11:14 - snowflake.connector.connection - INFO - closed
2025-01-18 09:11:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:11:35 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 09:11:35 - root - INFO - ```sql
SELECT "stn", "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    WHERE "temp" IS NOT NULL AND TRY_TO_NUMBER("temp") IS NOT NULL
    LIMIT 1000;
```
2025-01-18 09:11:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:11:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:11:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:11:37 - snowflake.connector.connection - INFO - closed
2025-01-18 09:11:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:12:16 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 09:12:16 - root - INFO - ```sql
SELECT "stn", "temp"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "temp" IS NOT NULL
LIMIT 1000;
```
2025-01-18 09:12:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:12:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:12:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:12:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 09:12:17 - snowflake.connector.connection - INFO - closed
2025-01-18 09:12:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:12:18 - root - INFO - SQL:
SELECT "stn", "temp"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "temp" IS NOT NULL
LIMIT 1000;
Results:
Too long, hard cut:
stn,temp
387340,28.6
387250,31.5
388440,24.4
724293,24.3
061080,59.9
388460,32.5
388440,17.3
388440,23.8
387340,46.3
023020,32.9
021300,30.5
680025,71.2
023020,62.2
023030,44.7
026020,48.0
021300,42.6
022330,-14.0
020540,29.8
025210,65.2
026460,31.7
026460,66.1
023020,42.9
025210,59.1
022560,23.6
023370,22.9
023370,23.4
022160,30.7
023030,30.3
026520,20.3
010231,34.0
023020,33.6
722857,29.0
021230,13.0
024130,31.5
021460,30.3
021460,-12.5
023370,5.4
023110,24.8
022330,11.3
020540,8.8
022170,30.4
022560,23.0
024130,3.9
022170,25.4
026460,20.6
023110,16.2
022920,4.8
024130,12.5
720654,83.6
023020,28.3
025070,57.8
026520,62.5
026460,60.9
026090,58.4
025070,62.3
022560,43.4
026090,42.0
026520,64.7
024720,26.3
021460,10.9
025070,31.5
023370,16.7
022560,13.9
021230,-10.6
021230,12.5
023020,3.0
026460,28.4
023030,21.7
021300,16.1
022170,13.2
022330,26.6
026520,22.1
023020,32.6
025210,28.6
022170,32.5
021700,14.5
023020,19.2
021700,21.5
022160,7.8
022560,10.5
026520,19.4
024130,6.8
020540,14.5
023030,14.6
022170,25.8
022330,23.9
022920,28.5
023490,-4.8
025530,31.8
022560,-1.0
023540,30.4
021300,6.0
023020,57.0
022330,49.1
024130,41.2
022920,37.0
026520,62.2
022160,41.7
025950,60.1
023490,3.1
024130,22.0
023370,53.5
022330,36.3
026460,64.3
023110,38.8
022330,37.5
021230,30.4
021460,23.2
022160,28.4
023110,30.9
020540,0.7
022920,16.4
020540,4.8
020540,3.2
025530,24.6
021230,22.0
021700,31.9
021300,25.1
022160,4.0
022560,25.0
023030,23.1
023490,19.4
026520,17.6
023370,10.6
024720,32.0
021230,13.1
022560,12.7
023020,8.2
022560,12.6
023020,29.3
023020,35.9
024130,38.2
025530,50.4
023030,12.8
026460,61.3
026520,62.0
680025,73.2
026030,57.3
022160,52.3
023030,5.8
024130,5.0
026460,58.0
022920,38.9
022330,40.8
021700,56.0
026520,58.0
021700,-9.3
022160,11.5
720747,23.4
022330,-6.5
025950,17.3
023110,29.4
023020,28.0
021300,9.9
020540,12.8
023110,29.5
025530,10.3
023110,9.1
020540,16.0
020540,28.0
026020,27.9
021460,25.6
022170,19.7
024130,6.0
021300,-1.8
023490,13.6
022330,11.4
022560,21.3
021230,16.0
023370,20.1
021700,29.0
025950,14.1
023030,-0.4
023490,25.7
023490,53.7
023490,30.0
024720,48.5
720605,70.6
025070,56.6
022560,40.7
023110,38.2
025150,56.5
026030,67.6
026460,36.2
022160,65.1
023110,38.8
023110,54.8
023540,42.6
021230,36.9
025530,61.7
022330,30.9
720654,77.4
023030,37.1
023540,56.8
025950,64.8
720654,55.9
720654,79.3
022170,45.4
011440,50.3
025150,37.6
023490,58.2
021460,25.4
021700,67.1
023370,41.1
720654,57.3
025070,44.1
720505,71.7
023030,51.9
026460,30.6
021230,29.2
025070,61.1
023110,39.0
026090,64.9
026460,54.6
022560,49.0
024130,43.3
025070,47.3
720654,80.6
025530,32.1
025530,45.0
022920,37.3
023030,45.3
026090,57.2
025070,66.1
720787,73.2
024130,37.5
026090,65.3
026520,55.3
023540,38.1
026020,31.0
022160,48.6
023020,56.7
720654,78.2
026090,50.1
024130,64.7
025950,41.3
025070,44.0
023030,52.4
720654,78.5
025210,55.9
021300,62.6
026030,61.7
024130,21.9
023030,51.0
023370,51.4
021230,55.2
026030,57.1
021230,36.3
022330,35.2
026030,39.3
022330,43.7
026460,63.8
010231,50.3
025150,32.8
024720,66.7
022920,57.8
025150,37.7
023030,39.6
720654,73.5
720605,75.3
024130,51.3
025950,39.8
720406,70.1
026030,45.4
023030,40.3
023110,61.6
026030,67.8
022170,58.4
023490,46.3
023490,59.9
023490,63.2
023370,58.2
720654,71.1
026460,60.1
021460,46.5
010231,56.8
021700,54.2
025950,34.7
026030,59.7
720743,69.6
720406,45.5
026090,47.7
023030,49.2
026090,39.0
025150,44.5
026030,56.4
026020,61.3
022160,57.9
026090,47.7
011440,55.3
025150,65.1
025530,67.1
024130,55.9
024720,52.9
024720,66.3
026020,34.7
720654,82.5
023370,46.6
024130,37.7
023020,23.4
720743,84.3
026090,62.1
020540,49.5
025530,52.7
011440,51.1
025530,44.5
720406,59.6
026020,56.1
023540,57.8
026460,58.6
022160,50.1
021230,32.3
023490,52.2
010231,55.0
035661,46.1
010231,55.0
022160,36.3
022330,60.2
023030,39.6
021700,36.0
025150,46.0
022330,50.2
026020,38.9
022160,49.5
024130,53.8
720505,82.4
023540,49.9
021700,41.8
022920,49.2
022170,50.9
025070,35.3
022920,45.0
026020,56.6
025070,34.7
022170,55.8
023020,49.5
720406,68.5
023540,29.8
720654,55.2
025530,33.9
022160,52.4
026460,57.4
026020,62.1
022560,38.6
025070,52.8
021230,27.7
022170,59.1
022920,46.5
023110,54.2
026030,30.2
025950,44.5
023030,47.2
022920,58.4
022920,57.6
025530,35.5
025530,54.3
025150,51.3
022330,50.8
011440,59.1
022170,49.4
023370,52.4
025950,60.2
023030,47.4
023110,49.1
021300,47.8
022920,44.7
022560,30.3
026020,55.2
025150,39.6
025150,42.1
720747,37.9
021700,63.8
026030,61.8
023020,48.6
025150,52.2
024130,62.3
023030,26.9
023110,54.7
025070,56.1
021700,39.1
026020,39.5
011440,53.3
022330,29.7
021460,36.1
022560,50.7
023030,46.3
025070,44.4
026460,63.4
025210,37.2
023540,45.5
022160,34.0
021230,43.3
023370,48.9
021230,36.4
022920,34.7
369740,53.6
680300,64.8
389540,41.2
023490,53.2
023490,35.4
720654,87.9
025950,34.3
026020,66.5
022330,35.8
026460,63.5
720406,64.6
025210,48.0
025950,65.5
025210,30.9
720654,84.8
024720,37.6
026030,59.5
021700,56.0
021700,45.9
021300,61.3
026020,64.0
720654,86.2
026

2025-01-18 09:12:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:12:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:12:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:12:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 09:12:19 - snowflake.connector.connection - INFO - closed
2025-01-18 09:12:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:12:20 - root - INFO - SQL:
SELECT "usaf", "lat", "lon"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    WHERE "lat" IS NOT NULL AND "lon" IS NOT NULL
    LIMIT 1000;
Results:
Too long, hard cut:
usaf,lat,lon
007018,0.0,0.0
007026,0.0,0.0
007070,0.0,0.0
008268,32.95,65.567
008307,0.0,0.0
010016,64.85,11.233
010017,59.98,2.25
010071,78.217,15.583
010190,77.517,20.817
010240,78.65,16.367
010303,69.7,19.017
010320,69.017,19.283
010340,70.317,20.15
010470,69.017,23.067
010510,69.583,23.533
010530,70.683,23.683
010610,70.067,25.117
010660,71.067,26.233
010670,69.9,26.417
010671,69.9,26.417
010750,70.4,28.2
010884,59.185,9.567
011030,65.1,11.7
011051,67.417,11.883
011100,66.0,11.683
011130,66.8,13.983
011133,60.417,8.513
011310,67.883,13.05
011340,65.183,13.417
011380,67.3,13.5
011490,66.333,14.1
011501,65.683,14.167
011530,67.283,14.45
011540,68.583,14.3
011560,68.6,14.433
011630,66.5,15.25
011680,68.65,15.283
011691,66.967,15.317
011700,67.233,15.317
011720,68.0,15.617
011760,68.567,16.267
011840,68.933,16.683
011841,68.933,16.683
011890,68.483,16.883
011930,68.467,17.5
011960,68.75,17.817
011980,68.783,19.7
012070,62.1,5.583
012091,62.183,6.05
012150,62.62,7.23
012160,62.617,7.217
012161,62.617,7.167
012210,63.05,9.083
012273,62.833,8.3
012310,62.233,8.367
012350,62.083,9.133
012360,62.1,9.05
012390,62.217,9.55
012430,63.333,9.65
012520,62.817,10.017
012580,63.417,10.433
012740,63.2,11.117
012771,63.717,11.233
012780,63.783,11.683
012823,64.85,11.233
012890,62.583,11.35
012891,62.583,11.383
012920,63.417,11.7
012950,64.55,12.15
012960,64.25,12.417
012980,64.45,13.717
013060,60.75,4.717
013160,60.4,5.317
013180,61.783,6.183
013220,61.467,5.917
013250,60.833,5.95
013280,60.4,5.917
013390,61.167,6.65
013410,60.467,6.867
013471,61.167,7.133
013510,60.6,7.5
013560,61.517,7.9
013591,60.517,7.867
013671,61.233,8.933
013690,60.917,9.283
013720,60.567,9.133
013743,61.0,9.3
013790,61.883,10.15
013801,61.167,9.967
013839,60.817,11.067
013910,60.617,12.017
014000,56.55,3.217
014010,59.983,2.25
014035,59.35,5.217
014110,59.067,5.417
014120,58.65,5.567
014211,59.85,6.0
014280,58.099,6.626
014320,58.883,6.85
014321,58.967,6.933
014330,59.833,6.983
014450,59.45,8.0
014460,59.567,8.2
014611,59.85,8.65
014740,59.9,9.533
014750,59.183,9.567
014870,59.933,10.833
014960,59.817,11.483
014970,59.0,11.533
014980,59.967,12.217
015000,59.383,11.383
020120,67.733,17.467
020180,67.533,18.233
020200,68.417,18.167
020230,68.433,18.633
020260,67.317,18.883
020320,68.217,19.717
020430,67.933,21.067
020450,67.833,20.417
020480,67.167,20.667
020510,68.45,22.5
020540,68.05,21.75
020560,65.067,17.167
020600,68.683,21.533
020711,60.417,15.517
020800,68.45,22.45
020840,68.05,22.0
020860,67.767,22.35
020880,67.083,22.217
020920,67.95,23.467
020960,67.217,23.4
020970,55.6,13.067
021040,65.817,15.083
021050,65.533,14.983
021080,65.067,14.8
021120,63.05,12.267
021160,63.317,13.65
021180,65.317,16.033
021200,66.883,18.017
021220,66.533,17.667
021230,66.317,17.1
021270,65.067,17.167
021280,65.0,17.7
021290,64.967,17.7
021300,66.483,16.417
021360,65.5,18.95
021420,66.496,20.147
021430,66.217,19.133
021440,65.983,18.933
021450,66.15,19.633
021460,66.5,19.683
021520,66.3,20.417
021560,63.967,13.717
021580,65.133,20.783
021590,65.12,20.77
021600,66.75,21.05
021640,66.383,21.633
021690,65.867,21.45
021720,65.683,20.967
021820,66.267,22.833
021850,65.55,22.133
021900,66.85,23.033
022000,63.983,12.867
022060,63.283,12.133
022150,63.433,13.083
022160,63.3,13.883
022170,63.367,13.167
022180,63.317,13.65
022220,64.5,14.167
022240,63.767,14.433
022320,64.433,15.633
022330,64.967,15.383
022340,63.867,15.583
022440,63.683,16.95
022480,63.167,16.167
022520,64.45,17.083
022560,64.733,17.4
022580,65.817,16.717
022620,66.567,16.35
022640,64.083,18.417
022660,64.583,16.85
022700,64.917,19.467
022740,64.217,19.717
022780,63.15,16.167
022830,63.817,20.233
022861,61.267,17.1
022890,63.333,20.183
022920,64.433,21.283
022960,64.483,21.583
023000,62.583,12.217
023020,61.833,12.283
023030,62.733,12.733
023040,61.85,12.267
023060,61.133,12.817
023100,62.8,13.067
023110,61.15,13.117
023130,58.1,14.4
023140,62.1,13.25
023141,58.017,16.067
023180,61.167,13.017
023191,57.417,13.283
023201,57.967,13.85
023230,62.533,14.2
023240,62.017,14.183
023260,64.083,18.417
023280,63.05,17.767
023300,62.75,15.1
023321,57.15,15.667
023360,61.383,15.833
023370,62.267,15.667
023420,62.517,16.183
023451,55.633,13.7
023460,61.783,16.55
023490,62.767,16.733
023540,62.433,17.35
023600,64.633,21.083
023640,63.4,18.967
023700,60.6,16.95
023710,60.433,15.5
023750,59.35,16.717
023760,61.267,17.1
023980,55.917,14.083
024000,60.35,12.65
024020,59.867,11.967
024040,59.667,12.583
024060,59.283,12.05
024090,59.05,12.7
024100,60.683,13.7
024120,60.15,13.8
024130,60.75,12.767
024161,59.617,13.733
024200,60.517,14.95
024220,59.617,14.183
024240,59.95,14.95
024280,59.1,14.367
024300,60.917,15.117
024330,60.617,15.667
024360,59.267,15.333
024373,59.387,15.924
024390,59.533,15.583
024440,60.167,16.317
024480,59.2,16.917
024510,60.883,17.917
024620,59.867,17.633
024650,59.35,17.967
024710,60.5,18.867
024720,60.117,15.117
024730,60.283,18.917
024740,60.167,18.75
024850,59.35,18.067
024940,64.483,21.583
024950,5

2025-01-18 09:12:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:12:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:12:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:12:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 74
2025-01-18 09:12:21 - snowflake.connector.connection - INFO - closed
2025-01-18 09:12:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:12:22 - root - INFO - SQL:
SELECT DISTINCT "state"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    LIMIT 1000;
Results:
state
""
NM
CA
MI
NV
TX
WA
AZ
OR
NC
FL
KY
IN
GA
CO
NU
NS
MT
IL
LA
MD
KS
WY
SC
NJ
VT
ME
AL
TN
ND
MS
NE
DE
NY
PR
PC
PW
RI
MH
JQ
DC
UM
QC
MP
AS
AR
YK
BC
VA
MO
OK
PA
OH
NH
AK
UT
NB
WV
WI
MN
IA
ID
MA
NT
VI
HI
GU
CR
ON
MB
SD
CT
FM
YT

2025-01-18 09:12:22 - root - INFO - itercount: 0
2025-01-18 09:12:22 - root - INFO - Database Name: NEW_YORK_NOAA
Schema Name: NEW_YORK
DDL describes table information.
,0
table_name,_311_SERVICE_REQUESTS
description,
DDL,"create or replace TABLE _311_SERVICE_REQUESTS (
	""unique_key"" NUMBER(38,0),
	""created_date"" NUMBER(38,0),
	""closed_date"" NUMBER(38,0),
	""agency"" VARCHAR(16777216),
	""agency_name"" VARCHAR(16777216),
	""complaint_type"" VARCHAR(16777216),
	""descriptor"" VARCHAR(16777216),
	""location_type"" VARCHAR(16777216),
	""incident_zip"" VARCHAR(16777216),
	""incident_address"" VARCHAR(16777216),
	""street_name"" VARCHAR(16777216),
	""cross_street_1"" VARCHAR(16777216),
	""cross_street_2"" VARCHAR(16777216),
	""intersection_street_1"" VARCHAR(16777216),
	""intersection_street_2"" VARCHAR(16777216),
	""address_type"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""landmark"" VARCHAR(16777216),
	""facility_type"" VARCHAR(16777216),
	""status"" VARCHAR(16777216),
	""due_date"" NUMBER(38,0),
	""resolution_description"" VARCHAR(16777216),
	""resolution_action_updated_date"" NUMBER(38,0),
	""community_board"" VARCHAR(16777216),
	""borough"" VARCHAR(16777216),
	""x_coordinate"" NUMBER(38,0),
	""y_coordinate"" NUMBER(38,0),
	""park_facility_name"" VARCHAR(16777216),
	""park_borough"" VARCHAR(16777216),
	""bbl"" NUMBER(38,0),
	""open_data_channel_type"" VARCHAR(16777216),
	""vehicle_type"" VARCHAR(16777216),
	""taxi_company_borough"" VARCHAR(16777216),
	""taxi_pickup_location"" VARCHAR(16777216),
	""bridge_highway_name"" VARCHAR(16777216),
	""bridge_highway_direction"" VARCHAR(16777216),
	""road_ramp"" VARCHAR(16777216),
	""bridge_highway_segment"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""location"" VARCHAR(16777216)
);"

,1
table_name,TLC_YELLOW_TRIPS_2012
description,
DDL,"create or replace TABLE TLC_YELLOW_TRIPS_2012 (
	""vendor_id"" VARCHAR(16777216),
	""pickup_datetime"" NUMBER(38,0),
	""dropoff_datetime"" NUMBER(38,0),
	""passenger_count"" NUMBER(38,0),
	""trip_distance"" FLOAT,
	""pickup_longitude"" FLOAT,
	""pickup_latitude"" FLOAT,
	""rate_code"" NUMBER(38,0),
	""store_and_fwd_flag"" VARCHAR(16777216),
	""dropoff_longitude"" FLOAT,
	""dropoff_latitude"" FLOAT,
	""payment_type"" VARCHAR(16777216),
	""fare_amount"" FLOAT,
	""extra"" FLOAT,
	""mta_tax"" FLOAT,
	""tip_amount"" FLOAT,
	""tolls_amount"" FLOAT,
	""imp_surcharge"" FLOAT,
	""total_amount"" FLOAT
);"

Some other tables have the similar structure: ['TLC_YELLOW_TRIPS_2012', 'TLC_YELLOW_TRIPS_2013', 'TLC_YELLOW_TRIPS_2014', 'TLC_YELLOW_TRIPS_2011', 'TLC_YELLOW_TRIPS_2009', 'TLC_YELLOW_TRIPS_2010', 'TLC_YELLOW_TRIPS_2015', 'TLC_YELLOW_TRIPS_2016']
,2
table_name,CITIBIKE_STATIONS
description,
DDL,"create or replace TABLE CITIBIKE_STATIONS (
	""station_id"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""short_name"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""region_id"" NUMBER(38,0),
	""rental_methods"" VARCHAR(16777216),
	""capacity"" NUMBER(38,0),
	""eightd_has_key_dispenser"" BOOLEAN,
	""num_bikes_available"" NUMBER(38,0),
	""num_bikes_disabled"" NUMBER(38,0),
	""num_docks_available"" NUMBER(38,0),
	""num_docks_disabled"" NUMBER(38,0),
	""is_installed"" BOOLEAN,
	""is_renting"" BOOLEAN,
	""is_returning"" BOOLEAN,
	""eightd_has_available_keys"" BOOLEAN,
	""last_reported"" NUMBER(38,0)
);"

,3
table_name,TLC_FHV_TRIPS_2015
description,
DDL,"create or replace TABLE TLC_FHV_TRIPS_2015 (
	""location_id"" NUMBER(38,0),
	""pickup_datetime"" NUMBER(38,0),
	""dispatching_base_num"" VARCHAR(16777216),
	""borough"" VARCHAR(16777216),
	""zone"" VARCHAR(16777216),
	""service_zone"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['TLC_FHV_TRIPS_2015', 'TLC_FHV_TRIPS_2016']
,4
table_name,TREE_CENSUS_2005
description,
DDL,"create or replace TABLE TREE_CENSUS_2005 (
	""objectid"" NUMBER(38,0),
	""cen_year"" NUMBER(38,0),
	""tree_dbh"" NUMBER(38,0),
	""tree_loc"" VARCHAR(16777216),
	""pit_type"" VARCHAR(16777216),
	""soil_lvl"" VARCHAR(16777216),
	""status"" VARCHAR(16777216),
	""spc_latin"" VARCHAR(16777216),
	""spc_common"" VARCHAR(16777216),
	""vert_other"" VARCHAR(16777216),
	""vert_pgrd"" VARCHAR(16777216),
	""vert_tgrd"" VARCHAR(16777216),
	""vert_wall"" VARCHAR(16777216),
	""horz_blck"" VARCHAR(16777216),
	""horz_grate"" VARCHAR(16777216),
	""horz_plant"" VARCHAR(16777216),
	""horz_other"" VARCHAR(16777216),
	""sidw_crack"" VARCHAR(16777216),
	""sidw_raise"" VARCHAR(16777216),
	""wire_htap"" VARCHAR(16777216),
	""wire_prime"" VARCHAR(16777216),
	""wire_2nd"" VARCHAR(16777216),
	""wire_other"" VARCHAR(16777216),
	""inf_canopy"" VARCHAR(16777216),
	""inf_guard"" VARCHAR(16777216),
	""inf_wires"" VARCHAR(16777216),
	""inf_paving"" VARCHAR(16777216),
	""inf_outlet"" VARCHAR(16777216),
	""inf_shoes"" VARCHAR(16777216),
	""inf_lights"" VARCHAR(16777216),
	""inf_other"" VARCHAR(16777216),
	""trunk_dmg"" VARCHAR(16777216),
	""zipcode"" NUMBER(38,0),
	""zip_city"" VARCHAR(16777216),
	""cb_num"" NUMBER(38,0),
	""borocode"" NUMBER(38,0),
	""boroname"" VARCHAR(16777216),
	""cncldist"" NUMBER(38,0),
	""st_assem"" NUMBER(38,0),
	""st_senate"" NUMBER(38,0),
	""nta"" VARCHAR(16777216),
	""nta_name"" VARCHAR(16777216),
	""boro_ct"" NUMBER(38,0),
	""x_sp"" NUMBER(38,0),
	""y_sp"" NUMBER(38,0),
	""objectid_1"" NUMBER(38,0),
	""location_1"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['TREE_CENSUS_2005', 'TREE_CENSUS_1995', 'TREE_CENSUS_2015']
,5
table_name,TREE_SPECIES
description,
DDL,"create or replace TABLE TREE_SPECIES (
	""species_scientific_name"" VARCHAR(16777216),
	""species_common_name"" VARCHAR(16777216),
	""form"" VARCHAR(16777216),
	""growth_rate"" VARCHAR(16777216),
	""fall_color"" VARCHAR(16777216),
	""environmental_tolerances"" VARCHAR(16777216),
	""location_tolerances"" VARCHAR(16777216),
	""notes_suggested_cultivars"" VARCHAR(16777216),
	""tree_size"" VARCHAR(16777216),
	""comments"" VARCHAR(16777216)
);"

,6
table_name,TLC_GREEN_TRIPS_2013
description,
DDL,"create or replace TABLE TLC_GREEN_TRIPS_2013 (
	""vendor_id"" VARCHAR(16777216),
	""pickup_datetime"" NUMBER(38,0),
	""dropoff_datetime"" NUMBER(38,0),
	""store_and_fwd_flag"" VARCHAR(16777216),
	""rate_code"" NUMBER(38,0),
	""pickup_longitude"" FLOAT,
	""pickup_latitude"" FLOAT,
	""dropoff_longitude"" FLOAT,
	""dropoff_latitude"" FLOAT,
	""passenger_count"" NUMBER(38,0),
	""trip_distance"" FLOAT,
	""fare_amount"" FLOAT,
	""extra"" FLOAT,
	""mta_tax"" FLOAT,
	""tip_amount"" FLOAT,
	""tolls_amount"" FLOAT,
	""ehail_fee"" FLOAT,
	""total_amount"" FLOAT,
	""payment_type"" NUMBER(38,0),
	""distance_between_service"" FLOAT,
	""time_between_service"" NUMBER(38,0),
	""trip_type"" NUMBER(38,0),
	""imp_surcharge"" FLOAT
);"

Some other tables have the similar structure: ['TLC_GREEN_TRIPS_2013', 'TLC_GREEN_TRIPS_2014', 'TLC_GREEN_TRIPS_2016', 'TLC_GREEN_TRIPS_2015']
,7
table_name,CITIBIKE_TRIPS
description,
DDL,"create or replace TABLE CITIBIKE_TRIPS (
	""tripduration"" NUMBER(38,0),
	""starttime"" NUMBER(38,0),
	""stoptime"" NUMBER(38,0),
	""start_station_id"" NUMBER(38,0),
	""start_station_name"" VARCHAR(16777216),
	""start_station_latitude"" FLOAT,
	""start_station_longitude"" FLOAT,
	""end_station_id"" NUMBER(38,0),
	""end_station_name"" VARCHAR(16777216),
	""end_station_latitude"" FLOAT,
	""end_station_longitude"" FLOAT,
	""bikeid"" NUMBER(38,0),
	""usertype"" VARCHAR(16777216),
	""birth_year"" NUMBER(38,0),
	""gender"" VARCHAR(16777216)
);"

,8
table_name,NYPD_MV_COLLISIONS
description,
DDL,"create or replace TABLE NYPD_MV_COLLISIONS (
	""borough"" VARCHAR(16777216),
	""contributing_factor_vehicle_1"" VARCHAR(16777216),
	""contributing_factor_vehicle_2"" VARCHAR(16777216),
	""contributing_factor_vehicle_3"" VARCHAR(16777216),
	""contributing_factor_vehicle_4"" VARCHAR(16777216),
	""contributing_factor_vehicle_5"" VARCHAR(16777216),
	""cross_street_name"" VARCHAR(16777216),
	""timestamp"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""location"" VARCHAR(16777216),
	""number_of_cyclist_injured"" NUMBER(38,0),
	""number_of_cyclist_killed"" NUMBER(38,0),
	""number_of_motorist_injured"" NUMBER(38,0),
	""number_of_motorist_killed"" NUMBER(38,0),
	""number_of_pedestrians_injured"" NUMBER(38,0),
	""number_of_pedestrians_killed"" NUMBER(38,0),
	""number_of_persons_injured"" NUMBER(38,0),
	""number_of_persons_killed"" NUMBER(38,0),
	""off_street_name"" VARCHAR(16777216),
	""on_street_name"" VARCHAR(16777216),
	""unique_key"" NUMBER(38,0),
	""vehicle_type_code1"" VARCHAR(16777216),
	""vehicle_type_code2"" VARCHAR(16777216),
	""vehicle_type_code_3"" VARCHAR(16777216),
	""vehicle_type_code_4"" VARCHAR(16777216),
	""vehicle_type_code_5"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0)
);"

Database Name: NEW_YORK_NOAA
Schema Name: NOAA_GSOD
DDL describes table information.
,0
table_name,GSOD1935
description,
DDL,"create or replace TABLE GSOD1935 (
	""stn"" VARCHAR(16777216),
	""wban"" VARCHAR(16777216),
	""year"" VARCHAR(16777216),
	""mo"" VARCHAR(16777216),
	""da"" VARCHAR(16777216),
	""temp"" FLOAT,
	""count_temp"" NUMBER(38,0),
	""dewp"" FLOAT,
	""count_dewp"" NUMBER(38,0),
	""slp"" FLOAT,
	""count_slp"" NUMBER(38,0),
	""stp"" FLOAT,
	""count_stp"" NUMBER(38,0),
	""visib"" FLOAT,
	""count_visib"" NUMBER(38,0),
	""wdsp"" VARCHAR(16777216),
	""count_wdsp"" VARCHAR(16777216),
	""mxpsd"" VARCHAR(16777216),
	""gust"" FLOAT,
	""max"" FLOAT,
	""flag_max"" VARCHAR(16777216),
	""min"" FLOAT,
	""flag_min"" VARCHAR(16777216),
	""prcp"" FLOAT,
	""flag_prcp"" VARCHAR(16777216),
	""sndp"" FLOAT,
	""fog"" VARCHAR(16777216),
	""rain_drizzle"" VARCHAR(16777216),
	""snow_ice_pellets"" VARCHAR(16777216),
	""hail"" VARCHAR(16777216),
	""thunder"" VARCHAR(16777216),
	""tornado_funnel_cloud"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['GSOD1935', 'GSOD1946', 'GSOD1951', 'GSOD1961', 'GSOD1964', 'GSOD1970', 'GSOD1976', 'GSOD1977', 'GSOD2008', 'GSOD1962', 'GSOD1965', 'GSOD1978', 'GSOD1983', 'GSOD1985', 'GSOD1992', 'GSOD2000', 'GSOD2019', 'GSOD2021', 'GSOD1967', 'GSOD1975', 'GSOD1986', 'GSOD1997', 'GSOD1996', 'GSOD1960', 'GSOD1930', 'GSOD1936', 'GSOD1939', 'GSOD1940', 'GSOD1948', 'GSOD1953', 'GSOD1959', 'GSOD1968', 'GSOD1973', 'GSOD2013', 'GSOD2023', 'GSOD1982', 'GSOD2001', 'GSOD2006', 'GSOD2010', 'GSOD2011', 'GSOD2024', 'GSOD1981', 'GSOD1991', 'GSOD2015', 'GSOD1931', 'GSOD1934', 'GSOD1937', 'GSOD1938', 'GSOD1942', 'GSOD1944', 'GSOD1947', 'GSOD1949', 'GSOD1955', 'GSOD1958', 'GSOD1980', 'GSOD1994', 'GSOD2004', 'GSOD2007', 'GSOD1941', 'GSOD1952', 'GSOD1969', 'GSOD1999', 'GSOD2012', 'GSOD2020', 'GSOD1987', 'GSOD1988', 'GSOD2005', 'GSOD2022', 'GSOD1972', 'GSOD1929', 'GSOD1932', 'GSOD1933', 'GSOD1943', 'GSOD1945', 'GSOD1950', 'GSOD1956', 'GSOD1957', 'GSOD1966', 'GSOD2003', 'GSOD2014', 'GSOD2016', 'GSOD1954', 'GSOD1963', 'GSOD1971', 'GSOD1974', 'GSOD1979', 'GSOD1990', 'GSOD1993', 'GSOD2009', 'GSOD2017', 'GSOD2018', 'GSOD1984', 'GSOD1995', 'GSOD1989', 'GSOD1998', 'GSOD2002']
,1
table_name,STATIONS
description,
DDL,"create or replace TABLE STATIONS (
	""usaf"" VARCHAR(16777216),
	""wban"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""call"" VARCHAR(16777216),
	""lat"" FLOAT,
	""lon"" FLOAT,
	""elev"" VARCHAR(16777216),
	""begin"" VARCHAR(16777216),
	""end"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
Categories: Geospatial functions


## ST_DWITHIN

Returns TRUE if the minimum geodesic distance between two points (two GEOGRAPHY objects) is within the specified distance. Otherwise, returns FALSE.
If the parameters are GEOGRAPHY values that are not points (e.g. lines or polygons), this returns TRUE or FALSE based on the minimum geodesic distance between the two closest points of the two values.

Tip You can use the search optimization service to improve the performance of queries that call this function.
For details, see Search Optimization Service.

## Syntax

ST_DWITHIN( <geography_expression_1> , <geography_expression_2> , <distance_in_meters> )


## Arguments


geography_expression_1The argument must be an expression of type GEOGRAPHY.

geography_expression_2The argument must be an expression of type GEOGRAPHY.

distance_in_metersThe argument must be an expression of type REAL. The distance is in meters.


## Returns

Returns a BOOLEAN.

## Usage notes


Returns NULL if any input is NULL.


## Examples

This returns TRUE because the distance in meters between two points 1 degree apart along the equator is less than 150,000 meters:

SELECT ST_DWITHIN (ST_MAKEPOINT(0, 0), ST_MAKEPOINT(1, 0), 150000);
+-------------------------------------------------------------+
| ST_DWITHIN (ST_MAKEPOINT(0, 0), ST_MAKEPOINT(1, 0), 150000) |
|-------------------------------------------------------------|
| True                                                        |
+-------------------------------------------------------------+
The table structure information is ({database name: {schema name: {table name}}}): 
{'NEW_YORK_NOAA': {'NEW_YORK': ['CITIBIKE_STATIONS', 'CITIBIKE_TRIPS', 'NYPD_MV_COLLISIONS', 'TLC_FHV_TRIPS_2015', 'TLC_FHV_TRIPS_2016', 'TLC_GREEN_TRIPS_2013', 'TLC_GREEN_TRIPS_2014', 'TLC_GREEN_TRIPS_2015', 'TLC_GREEN_TRIPS_2016', 'TLC_YELLOW_TRIPS_2009', 'TLC_YELLOW_TRIPS_2010', 'TLC_YELLOW_TRIPS_2011', 'TLC_YELLOW_TRIPS_2012', 'TLC_YELLOW_TRIPS_2013', 'TLC_YELLOW_TRIPS_2014', 'TLC_YELLOW_TRIPS_2015', 'TLC_YELLOW_TRIPS_2016', 'TREE_CENSUS_1995', 'TREE_CENSUS_2005', 'TREE_CENSUS_2015', 'TREE_SPECIES', '_311_SERVICE_REQUESTS'], 'NOAA_GSOD': ['GSOD1929', 'GSOD1930', 'GSOD1931', 'GSOD1932', 'GSOD1933', 'GSOD1934', 'GSOD1935', 'GSOD1936', 'GSOD1937', 'GSOD1938', 'GSOD1939', 'GSOD1940', 'GSOD1941', 'GSOD1942', 'GSOD1943', 'GSOD1944', 'GSOD1945', 'GSOD1946', 'GSOD1947', 'GSOD1948', 'GSOD1949', 'GSOD1950', 'GSOD1951', 'GSOD1952', 'GSOD1953', 'GSOD1954', 'GSOD1955', 'GSOD1956', 'GSOD1957', 'GSOD1958', 'GSOD1959', 'GSOD1960', 'GSOD1961', 'GSOD1962', 'GSOD1963', 'GSOD1964', 'GSOD1965', 'GSOD1966', 'GSOD1967', 'GSOD1968', 'GSOD1969', 'GSOD1970', 'GSOD1971', 'GSOD1972', 'GSOD1973', 'GSOD1974', 'GSOD1975', 'GSOD1976', 'GSOD1977', 'GSOD1978', 'GSOD1979', 'GSOD1980', 'GSOD1981', 'GSOD1982', 'GSOD1983', 'GSOD1984', 'GSOD1985', 'GSOD1986', 'GSOD1987', 'GSOD1988', 'GSOD1989', 'GSOD1990', 'GSOD1991', 'GSOD1992', 'GSOD1993', 'GSOD1994', 'GSOD1995', 'GSOD1996', 'GSOD1997', 'GSOD1998', 'GSOD1999', 'GSOD2000', 'GSOD2001', 'GSOD2002', 'GSOD2003', 'GSOD2004', 'GSOD2005', 'GSOD2006', 'GSOD2007', 'GSOD2008', 'GSOD2009', 'GSOD2010', 'GSOD2011', 'GSOD2012', 'GSOD2013', 'GSOD2014', 'GSOD2015', 'GSOD2016', 'GSOD2017', 'GSOD2018', 'GSOD2019', 'GSOD2020', 'GSOD2021', 'GSOD2022', 'GSOD2023', 'GSOD2024', 'STATIONS']}}
Begin Exploring Related Columns
**Columns and Potential Usage:**

From the `"STATIONS"` table in the `"NOAA_GSOD"` schema:

- `"usaf"`: Unique station identifier (USAF code); used to link stations with observations.
- `"wban"`: Weather Bureau Army Navy identifier; used for additional station identification.
- `"name"`: Name of the weather station; provides station information.
- `"lat"`: Latitude of the station; used to calculate distance from Chappaqua.
- `"lon"`: Longitude of the station; used to calculate distance from Chappaqua.
- `"state"`: State where the station is located; can filter stations within New York.
- `"begin"`: Starting date of data recording; to check data availability.
- `"end"`: Ending date of data recording; to check data availability.

From the `"GSODYYYY"` tables (where `YYYY` ranges from 2011 to 2020) in the `"NOAA_GSOD"` schema:

- `"stn"`: Station identifier (USAF code); used to link observations with stations.
- `"wban"`: Weather Bureau Army Navy identifier; used for additional station identification.
- `"year"`: Year of observation; ensures data falls within 2011 to 2020.
- `"mo"`: Month of observation; part of the date components.
- `"da"`: Day of observation; part of the date components.
- `"temp"`: Mean temperature of the day; used to count valid temperature observations.
- `"count_temp"`: Number of observations used to calculate the mean temperature; can indicate data reliability.

**Conditions That May Be Used:**

- Stations located within New York state (`"state" = 'NY'`).
- Stations within a 20-mile radius (32,186.8 meters) of Chappaqua, NY, using geospatial functions.
- Observations recorded between 2011 and 2020 (`"year" BETWEEN 2011 AND 2020`).
- Valid temperature observations where `"temp"` is not `NULL`.

**SQL Queries:**

1. **Retrieve distinct station identifiers from the `STATIONS` table:**
   ```sql
   SELECT DISTINCT "usaf"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
   LIMIT 1000;
   ```

2. **List station names and their locations (latitude and longitude):**
   ```sql
   SELECT "usaf", "name", "lat", "lon"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
   LIMIT 1000;
   ```

3. **Find stations located in New York state:**
   ```sql
   SELECT "usaf", "name", "state"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
   WHERE "state" = 'NY'
   LIMIT 1000;
   ```

4. **Get the data availability period for stations:**
   ```sql
   SELECT "usaf", "begin", "end"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
   LIMIT 1000;
   ```

5. **Select stations within a 20-mile radius of Chappaqua, NY:**
   ```sql
   SELECT "usaf", "name", "lat", "lon"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
   WHERE ST_DWITHIN(
       ST_MAKEPOINT("lon", "lat")::GEOGRAPHY,
       ST_MAKEPOINT(-73.764, 41.197)::GEOGRAPHY,
       32186.8
   )
   LIMIT 1000;
   ```

6. **Retrieve temperature observations from `GSOD2011`:**
   ```sql
   SELECT "stn", "wban", "year", "mo", "da", "temp"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
   LIMIT 1000;
   ```

7. **Find distinct station identifiers in `GSOD2011`:**
   ```sql
   SELECT DISTINCT "stn"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
   LIMIT 1000;
   ```

8. **Select valid temperature observations where temperature is not NULL:**
   ```sql
   SELECT "stn", "year", "mo", "da", "temp"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
   WHERE "temp" IS NOT NULL
   LIMIT 1000;
   ```

9. **Count the number of valid temperature observations per station in 2011:**
   ```sql
   SELECT "stn", COUNT("temp") AS "temp_count"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
   WHERE "temp" IS NOT NULL
   GROUP BY "stn"
   LIMIT 1000;
   ```

10. **Retrieve temperature observations from `GSOD2020`:**
    ```sql
    SELECT "stn", "year", "mo", "da", "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
    WHERE "temp" IS NOT NULL
    LIMIT 1000;
    ```

11. **List stations that have data in both `STATIONS` and `GSOD2011`:**
    ```sql
    SELECT DISTINCT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    WHERE "stn" IN (
        SELECT "usaf"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    )
    LIMIT 1000;
    ```

12. **Find stations with observations between 2011 and 2020:**
    ```sql
    SELECT DISTINCT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    WHERE "year" BETWEEN '2011' AND '2020'
    LIMIT 1000;
    ```

13. **Check for NULL temperature values in `GSOD2011`:**
    ```sql
    SELECT COUNT(*)
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    WHERE "temp" IS NULL;
    ```

14. **Retrieve temperature observations for a specific station in 2011:**
    ```sql
    SELECT "year", "mo", "da", "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    WHERE "stn" = 'INSERT_STATION_ID'
    LIMIT 1000;
    ```

15. **Count the number of days with temperature data per station in 2011:**
    ```sql
    SELECT "stn", COUNT(*) AS "days_of_data"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    WHERE "temp" IS NOT NULL
    GROUP BY "stn"
    LIMIT 1000;
    ```

16. **List all years available in the `GSOD` tables from 2011 to 2020:**
    ```sql
    SELECT DISTINCT "year"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    LIMIT 1000;
    ```

17. **Get stations with their starting and ending dates of data recording:**
    ```sql
    SELECT "usaf", "name", "begin", "end"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    WHERE "begin" <= '20110101' AND "end" >= '20201231'
    LIMIT 1000;
    ```

18. **Select temperature data where `"temp"` is a valid float value:**
    ```sql
    SELECT "stn", "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    WHERE "temp" IS NOT NULL AND TRY_TO_FLOAT("temp") IS NOT NULL
    LIMIT 1000;
    ```

19. **Retrieve stations with valid latitude and longitude values:**
    ```sql
    SELECT "usaf", "lat", "lon"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    WHERE "lat" IS NOT NULL AND "lon" IS NOT NULL
    LIMIT 1000;
    ```

20. **List unique states available in the `STATIONS` table:**
    ```sql
    SELECT DISTINCT "state"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    LIMIT 1000;
    ```

These queries help in understanding the relevant tables and columns required to identify weather stations within a 20-mile radius of Chappaqua, NY, and to count the number of valid temperature observations they have recorded from 2011 to 2020.Query:
SELECT DISTINCT "usaf"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
   LIMIT 1000;
Answer:
Too long, hard cut:
usaf
007018
007026
007070
008268
008307
010016
010017
010071
010190
010240
010303
010320
010340
010470
010510
010530
010610
010660
010671
010750
010884
011133
011501
011630
011691
011700
011760
011890
012273
012580
012960
013220
013720
014110
014740
011340
011490
011530
011720
011980
012210
012350
012823
013160
013280
013410
013671
013839
014450
014460
015000
020450
020480
020560
020880
020960
021560
022340
014321
014970
021160
021360
023100
023230
010670
011030
011051
011380
011540
011680
011840
011930
011960
012070
012150
012310
012430
012740
012780
012891
013250
013471
014750
021180
021460
022160
023540
011100
011130
012390
012520
013060
013180
013510
013743
014000
014010
014035
014280
014330
014611
014960
020180
020200
020260
020711
021420
021580
021820
021900
022240
022620
022640
022660
022700
022740
022780
022890
023000
023180
023240
023700
024060
024240
024280
024620
012161
013390
013560
013690
014211
020320
020510
020840
020860
021040
021200
021230
021270
021290
021600
021720
021850
022060
022440
022920
023140
023191
023280
024120
024220
024510
024740
025020
025040
021220
021300
025070
025080
025120
025150
025940
026500
027030
027130
027150
027290
027620
028744
029600
030010
030400
030490
030560
030770
030850
031190
031500
032230
032610
033380
033631
034040
035540
035671
036010
036150
036530
037850
039650
033220
039740
012091
012920
012950
013910
024390
011310
011560
012360
012771
012890
013790
013801
014120
020120
020920
020970
021080
021120
021280
021430
021440
021590
021640
022000
022861
023110
023420
023600
023750
023980
024000
024100
024300
024360
024710
024950
011841
012160
012980
013591
014320
020230
020430
020600
020800
021050
021520
022220
022320
022330
022480
022520
022580
022830
022960
023020
023030
023040
023130
023201
023260
023300
023321
023360
023451
023490
023640
023760
024090
024130
024161
024200
024330
024373
024440
024650
024730
024850
024990
021450
022170
022560
023060
023370
023460
024480
025010
025100
025105
025210
025230
025240
025270
025300
025330
025361
025430
025530
025531
025550
025640
025720
025950
025970
026020
026030
026060
026090
026200
026240
026241
026260
026270
026390
026540
026850
027160
027280
028230
028480
028520
028670
028790
029010
029120
029210
029244
029530
029650
029750
030040
030065
030070
030130
030250
030270
030330
030370
030380
030410
030460
030500
030530
030540
030610
030640
030650
030670
030710
030840
030890
030900
030930
031020
031053
031060
031070
031160
031200
031210
031300
031404
031411
031413
031450
031490
031540
031560
031570
031610
031620
031680
031770
031850
032050
032110
032150
032280
032410
032490
032800
032910
033030
033080
033090
033230
033290
033420
033430
033550
033600
034030
034080
034150
034610
034870
034875
034925
034960
035010
035050
035051
035210
035250
035460
035480
035500
035510
035520
035571
035621
035630
035860
035905
035953
035963
036060
036100
036140
036240
036280
036283
036383
036551
037010
037170
037435
037480
037630
037740
037815
037900
037950
038020
038040
038110
038170
038273
038341
038410
038450
038550
038600
038630
038793
038860
039090
039130
039600
039610
039790
040230
040440
040450
040810
041100
042070
042740
042800
043100
043301
044160
049999
060050
060080
061655
025660
027480
029730
030570
030755
030760
031051
031390
031470
031640
032070
032370
033390
033480
033880
034020
034053
034145
034530
035031
035270
035360
035471
035490
035570
035580
035623
035830
035930
036330
036550
036731
036740
037061
037440
037450
037640
037670
038150
038320
038330
038740
039030
039050
039220
039520
039640
040500
040530
040590
040750
040831
040910
040920
041270
042025
042160
042163
042350
042400
044520
060090
060130
060335
060760
061730
061790
038840
040680
060620
062440
062530
062697
063850
064160
064480
064505
064520
064620
064740
065850
065970
066840
067430
067570
067881
068480
068500
070160
070330
070570
070590
070700
070891
071080
071230
071540
071660
071710
071790
071860
072760
072950
072955
074385
074420
075173
075290
075615
075860
075870
076303
076310
076510
076560
076630
076770
077385
080030
080810
080830
081570
081820
083900
084750
085030
085080
085430
085470
085500
085520
089480
089580
093590
094900
094920
094960
095460
095570
095670
095690
100010
100260
100340
101220
103090
103120
103620
104090
104340
105040
105080
105090
105325
105360
105490
105510
106260
106334
106400
107250
107640
108340
108580
109710
109711
110030
110080
110140
110163
110900
111060
111130
111770
112340
112480
112950
113150
113520
116500
121120
123320
123720
123740
123764
124260
125190
126800
128550
131120
131290
131590
132140
132160
132600
133290
133400
135820
150550
151400
154470
154930
155460
014870
020540
023141
014980
021690
022150
022180
024020
024040
024720
024940
023710
025170
025280
025380
025410
025600
025680
025700
025760
025810
025910
026291
026400
026800
026810
027110
027230
027300
027830
029050
029140
029680
030064
030110
030320
030600
030700
030820
031310
031370
031430
031573
031590
032160
032290
032420
032431
032460
032620
032660
032820
0333
Query:
SELECT "usaf", "name", "lat", "lon"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
   LIMIT 1000;
Answer:
Too long, hard cut:
usaf,name,lat,lon
007018,WXPOD 7018                   ,0.0,0.0
007026,WXPOD 7026                   ,0.0,0.0
007070,WXPOD 7070                   ,0.0,0.0
008268,WXPOD8278                    ,32.95,65.567
008307,WXPOD 8318                   ,0.0,0.0
010016,RORVIK/RYUM,64.85,11.233
010017,FRIGG,59.98,2.25
010071,LONGYEARBYEN,78.217,15.583
010190,SVARTTANGEN,77.517,20.817
010240,PYRAMIDEN,78.65,16.367
010303,TROMSO/SKATTURA,69.7,19.017
010320,OVERBYGD,69.017,19.283
010340,FUGLOYKALVEN FYR,70.317,20.15
010470,KAUTOKEINO II,69.017,23.067
010510,SUOLOVUOPMI,69.583,23.533
010530,HAMMERFEST RADIO,70.683,23.683
010610,BRENNELV,70.067,25.117
010660,HELNES FYR,71.067,26.233
010670,LEVAJOK-EVJEN,69.9,26.417
010671,LEVAJOK-EVJEN,69.9,26.417
010750,RUSTEFJELBMA,70.4,28.2
010884,GEITERYGGEN,59.185,9.567
011030,LEKA,65.1,11.7
011051,SKOMVAER (LGT-H)             ,67.417,11.883
011100,YTTERHOLMEN FYR,66.0,11.683
011130,GLOMFJORD,66.8,13.983
011133,DAGALI,60.417,8.513
011310,GLAPEN LIGHTHOUSE,67.883,13.05
011340,MAJAVATN III,65.183,13.417
011380,TENNHOLMEN (LGT-H)           ,67.3,13.5
011490,RANA-BASMOEN,66.333,14.1
011501,HATTFJELLDAL-KRUTA,65.683,14.167
011530,BODO-VAGONES,67.283,14.45
011540,LITLOY FYR,68.583,14.3
011560,BO I VESTERALEN,68.6,14.433
011630,BOLNA,66.5,15.25
011680,KLEIVA I SORTLAND,68.65,15.283
011691,OVRE SALTDAL,66.967,15.317
011700,FAUSKE-VETEN,67.233,15.317
011720,FINNOY I HAMAROY,68.0,15.617
011760,KONGSVIK,68.567,16.267
011840,SANDSOY I SENJA,68.933,16.683
011841,SANDSOY,68.933,16.683
011890,LILAND,68.483,16.883
011930,NARVIK III/FRAMNES,68.467,17.5
011960,TENNEVOLL,68.75,17.817
011980,DIVIDALEN II,68.783,19.7
012070,FISKABYGD,62.1,5.583
012091,ORSTA-VOLDA/HOVD,62.183,6.05
012150,HJELVIK MYRBO,62.62,7.23
012160,HJELVIK I ROMSDAL,62.617,7.217
012161,GJERMUNDNES,62.617,7.167
012210,TAGDALEN,63.05,9.083
012273,TINGVOLL-HANEM,62.833,8.3
012310,LESJASKOG,62.233,8.367
012350,DOMBAS-KIRKENAER,62.083,9.133
012360,KJOREMSGRENDE,62.1,9.05
012390,HJERKINN II,62.217,9.55
012430,SONGLI,63.333,9.65
012520,BERKAK-LYNGHOLT,62.817,10.017
012580,TRONDHEIM (TYHOLT)           ,63.417,10.433
012740,SELBU-STUBBE,63.2,11.117
012771,LEVANGER-EGGEN,63.717,11.233
012780,VERDAL-REPPE,63.783,11.683
012823,RORVIK/RYUM,64.85,11.233
012890,ROROS LUFTHAVN,62.583,11.35
012891,ROROS/AIRPORT,62.583,11.383
012920,MERAKER-UTSYN,63.417,11.7
012950,HOYLANDET,64.55,12.15
012960,BERG I SNASA,64.25,12.417
012980,NORDLI-HOLAND,64.45,13.717
013060,HELLISOY FYR,60.75,4.717
013160,BERGEN-FREDRIKSBERG,60.4,5.317
013180,SANDANE,61.783,6.183
013220,FORDE-TEFRE,61.467,5.917
013250,MODALEN II,60.833,5.95
013280,KVAMSKOGEN,60.4,5.917
013390,VANGSNES,61.167,6.65
013410,EIDFJORD-BU,60.467,6.867
013471,SOGNDAL/HAUKASEN,61.167,7.133
013510,FINSE III,60.6,7.5
013560,FANNARAKI,61.517,7.9
013591,HAUGASTOL,60.517,7.867
013671,BEITOSTOLEN,61.233,8.933
013690,ABJORSBRATEN,60.917,9.283
013720,NESBYEN-SKOGLUND,60.567,9.133
013743,FAGERNES/LEIRIN   &          ,61.0,9.3
013790,SOR-NESSET,61.883,10.15
013801,KITTILBU,61.167,9.967
013839,HAMAR / STAFSBERG,60.817,11.067
013910,FLISA,60.617,12.017
014000,EKOFISK,56.55,3.217
014010,FRIGG,59.983,2.25
014035,KARMOY,59.35,5.217
014110,KVITSOY - NORDBO,59.067,5.417
014120,OBRESTAD,58.65,5.567
014211,INDRE MATRE,59.85,6.0
014280,LISTA,58.099,6.626
014320,SIRDAL-TJORHOM,58.883,6.85
014321,FIDJELAND,58.967,6.933
014330,MIDTLAEGER,59.833,6.983
014450,SKAFSA,59.45,8.0
014460,OYFJELL-TROVATN,59.567,8.2
014611,GAUSTATOPPEN,59.85,8.65
014740,LYNGDAL I NUMEDAL,59.9,9.533
014750,SKIEN-GEITERYGGEN,59.183,9.567
014870,ALNA,59.933,10.833
014960,HOLAND-FOSSER,59.817,11.483
014970,PRESTEBAKKE,59.0,11.533
014980,MAGNOR,59.967,12.217
015000,RAKKESTAD,59.383,11.383
020120,RITSEM,67.733,17.467
020180,SUORVA,67.533,18.233
020200,KATTERJAKK,68.417,18.167
020230,TORNEHAMN (AUT)              ,68.433,18.633
020260,ALUOKTA,67.317,18.883
020320,TORNETRASK LAKE,68.217,19.717
020430,ESRANGE,67.933,21.067
020450,KIRUNA-SOL,67.833,20.417
020480,MALMBERGET,67.167,20.667
020510,KARESUANDO,68.45,22.5
020540,NEDRE SOPPERO,68.05,21.75
020560,STENSELE,65.067,17.167
020600,NAIMAKKA,68.683,21.533
020711,BORLANGE,60.417,15.517
020800,KARESUANDO,68.45,22.45
020840,LANNAVAARA        &          ,68.05,22.0
020860,LAINIO,67.767,22.35
020880,KOMPELUSVAARA,67.083,22.217
020920,MUODOSLOMPOLO,67.95,23.467
020960,PAJALA,67.217,23.4
020970,MALMO /BULLTOFTON,55.6,13.067
021040,HEMAVAN,65.817,15.083
021050,ABELVATTNET,65.533,14.983
021080,KLIMPFJALL,65.067,14.8
021120,SYLARNA,63.05,12.267
021160,MORSIL,63.317,13.65
021180,DIKANAS/SKANSNAS,65.317,16.033
021200,KVIKKJOKK-ARRENJARKA,66.883,18.017
021220,STENUDDEN,66.533,17.667
021230,JAKKVIK,66.317,17.1
021270,STENSELE,65.067,17.167
021280,GUNNARN,65.0,17.7
021290,GUNNARN SOL (AUT)            ,64.967,17.7
021300,ROPARUDDEN,66.483,16.417
021360,STORBERG,65.5,18.95
021420,JOKKMOKK,66.496,20.147
021430,PALJAMYREN,66.217,19.133
021440,ABRAUR,65.983,18.933
021450,TELLEJAUR,66.15,19.633
021460,VAJMAT,66.5,19.683
021520,SUDOK,66.3,20.41
Query:
SELECT "usaf", "name", "state"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
   WHERE "state" = 'NY'
   LIMIT 1000;
Answer:
usaf,name,state
725010,UPTON,NY
725033,NYC CENTRAL PARK,NY
725034,CALVERTON/GRUMMAN,NY
725035,LONG ISLAND MAC ART,NY
725060,NEW YORK CENTRAL PARK,NY
725184,ALBANY (NEXRAD)              ,NY
725185,FLOYD BENNETT MEM,NY
725187,CLINTON COUNTY AIRPORT,NY
725195,OSWEGO COAST GUARD STATION,NY
725196,GRIFFISS AIRPARK,NY
725197,ONEIDA COUNTY AIRPORT,NY
725198,MILLBROOK/SKY ACRES,NY
725230,DANSVILLE/MUNICIPAL,NY
725230,DANSVILLE MUNICIPAL,NY
725283,CATTARAUGUS CO OLEAN,NY
725285,BUFFALO COAST GUARD STATION,NY
725288,NIAGARA COAST GUARD STATION,NY
726221,MASSENA AP,NY
726225,PLATTSBURGH INTL,NY
744976,NTPD AIR OPS HELIPORT,NY
749105,MITCHEL FIELD,NY
998168,NIAGARA CG STATION,NY
998436,BARCELONA HARBOR,NY
999999,GENEVA SAMPSON AFB,NY
999999,NIAGARA FALLS,NY
999999,SCHENECTADY,NY
999999,SCHENECTADY,NY
999999,HEMPSTEAD MITCHELL FLD AFB,NY
999999,BINGHAMTON TRI-CITIES ARPT,NY
999999,CANTON 4 SE                  ,NY
999999,DUNKIRK CHAUTAUQUA CO AP,NY
999999,ELMIRA AIRPORT,NY
999999,FORT PLAIN WB AP,NY
999999,GLENS FALLS AP,NY
999999,POUGHKEEPSIE DUTCHESS CO AP,NY
999999,TICONDEROGA 3 NE             ,NY
999999,UTICA CAA AP,NY
999999,NEW YORK FLOYD BENNE,NY
999999,BEAR MOUNTAIN WB,NY
999999,NEW YORK SHOALS AFS,NY
999999,DANSVILLE MUNI AP,NY
999999,NEW YORK CENTRAL PARK,NY
999999,WATERTOWN AP,NY
999999,UTICA ONEIDA COUNTY AP,NY
994100,AMBROSE LIGHT  NY,NY
724098,AMBROSE / FT. TILDEN,NY
725039,EATONS NECK COAST GUARD STATI,NY
744975,SHORT BEACH COAST GUARD STATI,NY
998267,ROCHESTER,NY
725028,BAY SHORE / FIRE ISLAND,NY
744859,FREEPORT,NY
997272,BERGEN POINT,NY
749108,ELIZABETH AAF,NY
999999,BINGHAMTON BROOME COUNTY ARPT,NY
999999,NEW YORK LAGUARDIA ARPT,NY
999999,BUFFALO BUFFALO ARPT,NY
999999,ALBANY COUNTY AP,NY
999999,ROCHESTER MONROE CO ARPT,NY
999999,SYRACUSE MUNICIPL AP,NY
999999,MASSENA AP,NY
999999,WHITE PLAINS WESTCHESTER CO A,NY
999999,NEW YORK FORT TOTTEN,NY
724988,DANSVILLE MUNI,NY
725036,DUTCHESS CO,NY
725156,ELMIRA CORNING RGNL,NY
725287,NIAGARA FALLS INTL,NY
744865,WESTHAMPTON BEACH,NY
744989,CHAUTAUQUA CO DUNKIR,NY
744994,SCHENECTADY CO,NY
725038,STEWART INTL,NY
722098,EAST HAMPTON,NY
725015,ORANGE CO,NY
725016,BROOKHAVEN,NY
725145,SULLIVAN CO INTL,NY
725146,OSWEGO CO,NY
725155,ITHACA TOMPKINS RGNL,NY
725157,WELLSVILLE MUNI,NY
725187,CLINTON CO,NY
725194,PENN YAN,NY
725235,CHATAUQUA CO JAMESTO,NY
726228,ADIRONDACK RGNL,NY
743700,FORT DRUM/WHEELER-S,NY
744864,REPUBLIC,NY
725014,MONTAUK,NY
994590,THOUSAND I. BRDG.  NY,NY
994930,SOUTH MIDDLE SOUND,NY
999999,MILLBROOK 3 W                ,NY
999999,ITHACA 13 E                  ,NY
720553,PORT AUTH DOWNTN MANHATTAN WA,NY
725186,OGDENSBURG INTL,NY
997989,OLCOTT HARBOR,NY
998009,ROCHESTER,NY
998235,NIAGRA INTAKE,NY
998266,STURGEON POINT,NY
998223,ALEXANDRIA BAY,NY
997271,THE BATTERY,NY
997280,KINGS POINT,NY
997282,MONTAUK,NY
998435,OGDENSBURG,NY
997991,HUDSON RIVER RESERVE,NY
722098,EAST HAMPTON AIRPORT,NY
724988,DANSVILLE MUNICIPAL ARPT,NY
725014,MONTAUK AIRPORT,NY
725016,BROOKHAVEN AIRPORT,NY
725030,LA GUARDIA AIRPORT,NY
725036,DUTCHESS COUNTY AIRPORT,NY
725037,WESTCHESTER COUNTY AIRPORT,NY
725038,STEWART INTERNATIONAL AIRPORT,NY
725050,LONG ISLAND MAC ARTHUR AIRPOR,NY
725053,CENTRAL PARK,NY
725145,SULLIVAN COUNTY INTL ARPT,NY
725146,OSWEGO COUNTY AIRPORT,NY
725150,GREATER BINGHAMTON/E A LINK F,NY
725155,ITHACA TOMPKINS REGIONAL AIRP,NY
725156,ELMIRA/CORNING RGNL ARPT,NY
725157,MUNI ARPT TARANTINE FLD AP,NY
725180,ALBANY INTERNATIONAL AIRPORT,NY
725190,SYRACUSE HANCOCK INTERNATIONA,NY
725194,PENN YAN AIRPORT,NY
725196,GRIFFIS AIRFIELD,NY
725220,FLOYD BENNETT MEMO AIRPORT,NY
725235,CHAUTAUQUA CO/JAMESTOWN AP,NY
725280,BUFFALO NIAGARA INTERNATIONAL,NY
725283,CATTARAUGUS COUNTY OLEAN AIRP,NY
725287,NIAGARA FALLS INTL AIRPORT,NY
725290,GREATER ROCHESTER INTERNATION,NY
726223,MASSENA INTL/RCHARDS FD AP,NY
726225,PLATTSBURGH INTERNATIONAL AIR,NY
726227,WATERTOWN INTL AIRPORT,NY
726228,ADIRONDACK REGIONAL ARPT,NY
743700,WHEELER-SACK AAF AIRPORT,NY
744860,JOHN F KENNEDY INTERNATIONAL,NY
744864,REPUBLIC AIRPORT,NY
744865,FRANCIS S GABRESKI AP,NY
744994,SCHENECTADY COUNTY AIRPORT,NY
725015,ORANGE COUNTY AIRPORT,NY
744989,CHAUTAUQUA CO/DUNKIRK ARPT,NY
Query:
SELECT "usaf", "begin", "end"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
   LIMIT 1000;
Answer:
Too long, hard cut:
usaf,begin,end
007018,20110309,20130730
007026,20120713,20170822
007070,20140923,20150926
008268,20100519,20120323
008307,20100421,20100421
010016,19870116,19910806
010017,19880320,20050228
010071,20050210,20050210
010190,20100825,20140523
010240,19730101,20210918
010303,20140522,20150108
010320,19730101,20140523
010340,19871202,20140523
010470,19730101,20210917
010510,19730102,20140523
010530,19730101,19871226
010610,19730101,19840707
010660,19730101,20040619
010670,19730103,19820924
010671,20070307,20070307
010750,19730101,20130531
010884,20050103,20151109
011030,19730101,20070307
011051,20070307,20070307
011100,19961201,20050319
011130,20040406,20091216
011133,19860509,20030427
011310,19730101,19850625
011340,19730101,20070630
011380,19850912,20070307
011490,19730101,20070228
011501,20020312,20020312
011530,20111003,20140611
011540,19940406,20170801
011560,20040510,20210913
011630,19730101,19770823
011680,19730101,20060611
011691,19730101,19781008
011700,19730101,19900307
011720,19730101,20060311
011760,19730101,19780118
011840,19730101,19780613
011841,20070307,20070307
011890,19730102,20050302
011930,20010706,20170403
011960,19730101,20020808
011980,20100114,20210918
012070,20040510,20180630
012091,19840910,19841127
012150,19730101,20090630
012160,19731226,20020527
012161,20040412,20040412
012210,20080115,20210909
012273,20050101,20150108
012310,19771030,20080731
012350,19360101,19760602
012360,20050218,20100104
012390,20100907,20210906
012430,19730101,19761119
012520,19730101,20080930
012580,19730101,19810714
012740,19730101,20061115
012771,19730101,19730216
012780,19850102,20181031
012823,19910827,19950831
012890,19840909,20041230
012891,19790301,19840817
012920,19730101,20040930
012950,19730101,20070612
012960,19730101,19770606
012980,19730101,20191016
013060,19730101,20041229
013160,19730101,19851230
013180,20050614,20171231
013220,19730101,20171223
013250,19730101,20080924
013280,19730101,20060726
013390,19730101,20011102
013410,19830101,20070227
013471,19840801,19841217
013510,19730102,20011210
013560,19881125,20140827
013591,20070307,20070307
013671,19730101,19801105
013690,19881001,20171230
013720,19730101,20040121
013743,19880105,19880913
013790,19730101,20051209
013801,19741114,19840827
013839,19870205,19900222
013910,19730101,20050331
014000,19981223,20200901
014010,20010601,20060718
014035,19751101,19840807
014110,20050612,20210915
014120,19730101,20210909
014211,20020314,20020314
014280,19730101,20070813
014320,19741114,20100331
014321,20070307,20070307
014330,19730101,20150528
014450,19730101,19891113
014460,19830101,20040731
014611,20140605,20181022
014740,19730101,20060831
014750,19850717,20041230
014870,20040924,20150601
014960,19730101,20071020
014970,19730101,20100409
014980,19830101,20050831
015000,20090708,20091216
020120,19810801,20050924
020180,19350101,19381231
020200,19770701,20190401
020230,19860427,20050526
020260,20021023,20050930
020320,19770701,20030909
020430,19940301,19990630
020450,19950401,20030922
020480,19350101,19910505
020510,19550101,19591231
020540,19550101,20160421
020560,19550101,19591231
020600,19550101,20041021
020711,19730101,19730121
020800,19350101,20120831
020840,19550101,20040507
020860,19550101,20050317
020880,19730101,20020521
020920,19730101,20040917
020960,19550101,20080218
020970,19550101,19740702
021040,19770701,20080218
021050,19730101,20040221
021080,19770701,20050921
021120,19770701,20040821
021160,19730101,20050221
021180,19730101,20050121
021200,19350101,20130331
021220,19790802,20040321
021230,19730101,20160421
021270,19310103,20050823
021280,19730101,20130402
021290,19730101,19861125
021300,19730101,20160421
021360,20030519,20040829
021420,19770701,20000510
021430,19730101,20030731
021440,19770701,20040626
021450,20030725,20040322
021460,20010701,20160421
021520,19730101,20050919
021560,19770701,20031028
021580,19790726,20020807
021590,19960801,20050629
021600,20010829,20050307
021640,19730501,20030719
021690,20020530,20020801
021720,19790710,19791123
021820,19790803,20020602
021850,20010402,20011008
021900,20010716,20040402
022000,19770701,20041225
022060,19350101,20130228
022150,19970901,20040822
022160,19730101,20160421
022170,20010701,20160421
022180,19730105,20050924
022220,19770701,20080218
022240,20020609,20020609
022320,19770701,20040903
022330,20010701,20160421
022340,19790105,19951130
022440,19960201,20080218
022480,19770704,20050218
022520,19830201,20040922
022560,20010701,20160421
022580,20011104,20041216
022620,19730101,20040306
022640,19730101,20021028
022660,20020608,20020608
022700,20010614,20030914
022740,19960501,20000509
022780,19770701,20041015
022830,19840712,19840712
022861,20040706,20120103
022890,19730101,20010920
022920,20010701,20160421
022960,19350101,20031222
023000,20020523,20060102
023020,20010701,20160421
023030,20010701,20160421
023040,19770701,20040123
023060,19770701,20171208
023100,19770701,20050123
023110,20010701,20160421
023130,19731209,19731209
023140,20010729,20050523
023141,20160801,20190909
023180,197
Query:
WITH nearby_stations AS (
    SELECT "usaf", "name"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    WHERE "lat" IS NOT NULL AND "lon" IS NOT NULL
      AND ST_DWITHIN(
          TO_GEOGRAPHY('POINT(' || "lon" || ' ' || "lat" || ')'),
          TO_GEOGRAPHY('POINT(-73.764 41.197)'),
          32186.8
      )
)

SELECT
    ns."usaf" AS station_id,
    ns."name" AS station_name,
    COUNT(g."temp") AS number_of_temperature_observations
FROM
    nearby_stations ns
JOIN
    (
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
    ) g ON ns."usaf" = g."stn"
WHERE
    g."temp" IS NOT NULL
GROUP BY
    ns."usaf", ns."name";
Answer:
STATION_ID,STATION_NAME,NUMBER_OF_TEMPERATURE_OBSERVATIONS
725086,DANBURY MUNICIPAL AIRPORT,3649
999999,WHITE PLAINS WESTCHESTER CO A,1123769
725086,DANBURY MUNI ARPT,3649
999999,BEAR MOUNTAIN WB,1123769
997186,WESTERN LONG ISLAND SOUND,1532
725037,WESTCHESTER COUNTY AIRPORT,3653
Query:
SELECT "stn", "wban", "year", "mo", "da", "temp"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
   LIMIT 1000;
Answer:
Too long, hard cut:
stn,wban,year,mo,da,temp
387340,99999,2011,11,08,28.6
387250,99999,2011,02,04,31.5
388440,99999,2011,02,07,24.4
724293,99999,2011,11,13,24.3
061080,99999,2011,07,22,59.9
388460,99999,2011,11,09,32.5
388440,99999,2011,02,26,17.3
388440,99999,2011,11,09,23.8
387340,99999,2011,10,05,46.3
023020,99999,2011,04,12,32.9
021300,99999,2011,02,28,30.5
680025,99999,2011,01,28,71.2
023020,99999,2011,06,11,62.2
023030,99999,2011,08,31,44.7
026020,99999,2011,11,27,48.0
021300,99999,2011,05,31,42.6
022330,99999,2011,01,14,-14.0
020540,99999,2011,05,03,29.8
025210,99999,2011,06,07,65.2
026460,99999,2011,01,25,31.7
026460,99999,2011,08,06,66.1
023020,99999,2011,10,06,42.9
025210,99999,2011,08,08,59.1
022560,99999,2011,12,19,23.6
023370,99999,2011,03,13,22.9
023370,99999,2011,03,25,23.4
022160,99999,2011,03,09,30.7
023030,99999,2011,04,04,30.3
026520,99999,2011,02,22,20.3
010231,99999,2011,03,11,34.0
023020,99999,2011,12,25,33.6
722857,99999,2011,12,03,29.0
021230,99999,2011,01,09,13.0
024130,99999,2011,12,09,31.5
021460,99999,2011,04,10,30.3
021460,99999,2011,01,14,-12.5
023370,99999,2011,02,11,5.4
023110,99999,2011,02,07,24.8
022330,99999,2011,03,11,11.3
020540,99999,2011,01,16,8.8
022170,99999,2011,02,02,30.4
022560,99999,2011,11,27,23.0
024130,99999,2011,02,23,3.9
022170,99999,2011,03,06,25.4
026460,99999,2011,02,19,20.6
023110,99999,2011,01,08,16.2
022920,99999,2011,02,19,4.8
024130,99999,2011,02,07,12.5
720654,99999,2011,06,26,83.6
023020,99999,2011,03,07,28.3
025070,99999,2011,08,24,57.8
026520,99999,2011,08,18,62.5
026460,99999,2011,06,14,60.9
026090,99999,2011,09,30,58.4
025070,99999,2011,06,05,62.3
022560,99999,2011,09,16,43.4
026090,99999,2011,12,09,42.0
026520,99999,2011,06,22,64.7
024720,99999,2011,02,25,26.3
021460,99999,2011,12,08,10.9
025070,99999,2011,01,04,31.5
023370,99999,2011,02,04,16.7
022560,99999,2011,12,30,13.9
021230,99999,2011,02,22,-10.6
021230,99999,2011,02,11,12.5
023020,99999,2011,02,18,3.0
026460,99999,2011,01,21,28.4
023030,99999,2011,02,06,21.7
021300,99999,2011,03,28,16.1
022170,99999,2011,01,15,13.2
022330,99999,2011,12,17,26.6
026520,99999,2011,02,21,22.1
023020,99999,2011,10,20,32.6
025210,99999,2011,03,01,28.6
022170,99999,2011,03,22,32.5
021700,99999,2011,01,16,14.5
023020,99999,2011,01,12,19.2
021700,99999,2011,12,21,21.5
022160,99999,2011,02,15,7.8
022560,99999,2011,01,26,10.5
026520,99999,2011,02,23,19.4
024130,99999,2011,01,15,6.8
020540,99999,2011,01,02,14.5
023030,99999,2011,01,06,14.6
022170,99999,2011,01,01,25.8
022330,99999,2011,12,03,23.9
022920,99999,2011,11,28,28.5
023490,99999,2011,01,15,-4.8
025530,99999,2011,12,05,31.8
022560,99999,2011,02,15,-1.0
023540,99999,2011,03,14,30.4
021300,99999,2011,02,07,6.0
023020,99999,2011,08,01,57.0
022330,99999,2011,09,14,49.1
024130,99999,2011,05,01,41.2
022920,99999,2011,11,25,37.0
026520,99999,2011,08,17,62.2
022160,99999,2011,10,28,41.7
025950,99999,2011,06,05,60.1
023490,99999,2011,02,24,3.1
024130,99999,2011,01,24,22.0
023370,99999,2011,09,30,53.5
022330,99999,2011,04,06,36.3
026460,99999,2011,07,11,64.3
023110,99999,2011,04,06,38.8
022330,99999,2011,04,05,37.5
021230,99999,2011,12,02,30.4
021460,99999,2011,12,10,23.2
022160,99999,2011,12,28,28.4
023110,99999,2011,10,20,30.9
020540,99999,2011,01,03,0.7
022920,99999,2011,02,04,16.4
020540,99999,2011,01,09,4.8
020540,99999,2011,01,07,3.2
025530,99999,2011,02,28,24.6
021230,99999,2011,11,20,22.0
021700,99999,2011,12,19,31.9
021300,99999,2011,12,05,25.1
022160,99999,2011,02,18,4.0
022560,99999,2011,12,25,25.0
023030,99999,2011,11,27,23.1
023490,99999,2011,01,01,19.4
026520,99999,2011,01,03,17.6
023370,99999,2011,02,17,10.6
024720,99999,2011,12,09,32.0
021230,99999,2011,12,30,13.1
022560,99999,2011,12,31,12.7
023020,99999,2011,02,16,8.2
022560,99999,2011,02,04,12.6
023020,99999,2011,11,27,29.3
023020,99999,2011,04,09,35.9
024130,99999,2011,04,12,38.2
025530,99999,2011,09,01,50.4
023030,99999,2011,03,25,12.8
026460,99999,2011,08,24,61.3
026520,99999,2011,08,22,62.0
680025,99999,2011,01,13,73.2
026030,99999,2011,09,18,57.3
022160,99999,2011,08,17,52.3
023030,99999,2011,02,24,5.8
024130,99999,2011,02,24,5.0
026460,99999,2011,06,20,58.0
022920,99999,2011,04,05,38.9
022330,99999,2011,10,07,40.8
021700,99999,2011,06,04,56.0
026520,99999,2011,08,10,58.0
021700,99999,2011,02,19,-9.3
022160,99999,2011,02,17,11.5
720747,99999,2011,12,08,23.4
022330,99999,2011,01,13,-6.5
025950,99999,2011,02,14,17.3
023110,99999,2011,12,14,29.4
023020,99999,2011,01,11,28.0
021300,99999,2011,01,10,9.9
020540,99999,2011,12,29,12.8
023110,99999,2011,11,26,29.5
025530,99999,2011,02,22,10.3
023110,99999,2011,02,16,9.1
020540,99999,2011,01,11,16.0
020540,99999,2011,12,05,28.0
026020,99999,2011,01,28,27.9
021460,99999,2011,12,27,25.6
022170,99999,2011,12,12,19.7
024130,99999,2011,02,22,6.0
021300,99999,2011,01,03,-1.8
023490,99999,2011,02,21,13.6
022330,99999,2011,01,06,11.4
022560,99999,2011,12,29,21.3
021230,99999,2011,12,21,16.0
023370,99999,2011,01,05,20.1
021700,99999,2011,02,26,29.0
025950,99999,2011,02,22,14.1
023
Query:
SELECT DISTINCT "stn"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
   LIMIT 1000;
Answer:
Too long, hard cut:
stn
484150
488300
977220
873490
610960
247680
319870
345040
285880
333770
961630
471500
404170
370850
483600
973400
874480
360640
970480
383880
412460
427540
432130
620550
028720
484000
293480
875480
385990
874670
308620
296450
292820
470350
388950
297360
485320
249590
383410
330190
028140
133890
227210
432260
226210
357000
295570
610910
470700
710735
984300
624400
624170
542920
372790
766920
337610
252820
347300
314890
343910
288070
610750
297120
294050
260290
280490
967910
263890
325830
483580
360960
471620
335870
471400
484200
345790
360580
261340
319150
278570
985310
484800
234120
485570
296250
299370
282140
272080
261440
710823
574260
423280
915510
719494
040130
423610
350110
427060
265180
597580
524180
504340
592930
535640
514310
543370
507270
314840
488030
982220
590230
323890
306730
485740
309350
470750
483720
319690
324080
634510
612400
961790
623250
727840
596630
576620
572970
543740
471560
470280
253560
433140
538450
584770
549090
470600
291220
966450
060110
471350
278350
345450
221270
984440
426230
960870
471920
402650
718432
400300
691226
986460
624550
985380
987470
326180
719064
423140
379250
996440
509150
599970
221000
387250
022170
020540
021230
026090
682905
720605
720406
720743
369820
369740
680300
035660
679770
722907
679750
965050
643600
720411
040131
841490
842700
630210
840760
637420
085020
634740
839420
474770
836720
653765
677650
837780
255520
858360
637720
030220
604592
787935
484076
167341
722666
702755
637090
722201
155257
720623
131160
722177
444540
676930
010881
416200
679910
384010
744659
064280
476830
162210
475670
265020
830630
167193
726764
037663
726396
232210
722211
338388
409040
035413
783334
066580
722052
766546
478720
827641
851960
803420
844550
977800
067940
722032
400830
844440
480250
480200
720371
722089
725495
722866
858640
724833
722334
725453
823170
724043
477890
475420
478560
407807
475690
825991
642100
682677
330005
407823
722182
804100
766580
162591
021610
162592
648100
804230
787450
787670
836724
166990
477350
068065
720375
106164
784390
032145
837590
485575
801390
804470
238045
109470
852450
725479
693614
021205
787140
163500
619840
948955
333931
722163
720602
670850
842260
172050
612970
701338
679610
650020
172550
724026
132890
029470
554720
722128
768556
700638
726553
723761
787410
766127
672830
725454
649500
827040
155256
672970
868910
024930
720739
633310
432210
113080
643900
027140
858320
844250
266295
108370
722369
108560
726391
723055
722081
684420
031350
725457
835250
720345
726603
237010
066820
060100
744653
654720
692164
720627
720583
720254
683210
692174
636580
353948
070700
836490
786470
723529
722091
723676
256770
027570
483770
027590
873710
273690
341520
485170
485700
239550
253780
260590
268870
483070
249510
970860
433290
431890
383340
433460
430860
266450
388060
485660
443470
228450
306030
321650
252480
347200
484580
443290
135830
310880
484250
246390
385110
027690
421110
874160
655050
262260
483740
969870
443850
350260
876410
265240
259540
860970
471880
589110
279950
526520
511560
484550
248560
279280
341710
876450
442370
134620
251380
471360
297240
973000
279060
027890
236620
484770
333170
348800
060120
355760
965290
470950
484010
285730
314450
470520
976900
313000
263590
282400
332750
348660
610990
292310
320980
960730
309490
484090
962950
484530
655100
484130
296050
433210
336630
360380
470610
442170
331350
485810
986440
485550
470460
219310
424520
428860
987410
548430
516440
536140
561870
509490
540260
318250
763930
412700
578660
524950
533910
442120
317020
442130
895320
355320
471520
969350
483250
331770
214320
484350
021510
285410
320610
314780
428400
585560
596320
433330
040050
995400
623870
571780
540270
132780
272420
360610
303370
624320
531490
442560
485610
344150
537980
294300
718437
314740
988510
975700
247240
306860
470580
290230
402550
862210
916100
864600
692484
996570
623050
718442
428740
425590
710354
431170
582030
599810
577990
202920
889680
976300
620120
575840
433530
378510
509630
579320
784860
421820
021300
024130
023540
025070
724293
384620
720381
066120
067450
800630
846730
112410
489410
476435
480370
111460
484075
112520
678690
846580
702647
804370
840360
031140
836725
636304
702550
634020
720374
841430
034920
042025
073170
726404
875060
470220
839810
067530
108600
038030
010885
744672
646650
701196
749171
685380
684380
720494
804340
804570
702711
010883
704140
720257
854590
413410
787945
786390
160595
879340
414520
476600
787625
720339
701719
722214
165420
847350
700634
010014
106163
401761
475490
475530
031394
747808
786445
010876
726544
042605
128605
155258
161220
266661
720867
783841
720632
766534
740002
724090
407127
835880
804130
720544
692214
637140
693254
171290
171900
123765
917830
726564
724694
720631
477940
711970
745966
720326
720278
474790
485577
831110
039240
724517
637910
725337
381417
637410
419780
836980
342140
787421
785140
286760
725484
121053
820305
677790
348610
804120
677610
474900
433360
477790
701040
723144
637260
470050
478500
478570
407821
786630
111490
636710
307390
804160
876400
693594
63717
Query:
SELECT "stn", "year", "mo", "da", "temp"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
   WHERE "temp" IS NOT NULL
   LIMIT 1000;
Answer:
Too long, hard cut:
stn,year,mo,da,temp
387340,2011,11,08,28.6
387250,2011,02,04,31.5
388440,2011,02,07,24.4
724293,2011,11,13,24.3
061080,2011,07,22,59.9
388460,2011,11,09,32.5
388440,2011,02,26,17.3
388440,2011,11,09,23.8
387340,2011,10,05,46.3
023020,2011,04,12,32.9
021300,2011,02,28,30.5
680025,2011,01,28,71.2
023020,2011,06,11,62.2
023030,2011,08,31,44.7
026020,2011,11,27,48.0
021300,2011,05,31,42.6
022330,2011,01,14,-14.0
020540,2011,05,03,29.8
025210,2011,06,07,65.2
026460,2011,01,25,31.7
026460,2011,08,06,66.1
023020,2011,10,06,42.9
025210,2011,08,08,59.1
022560,2011,12,19,23.6
023370,2011,03,13,22.9
023370,2011,03,25,23.4
022160,2011,03,09,30.7
023030,2011,04,04,30.3
026520,2011,02,22,20.3
010231,2011,03,11,34.0
023020,2011,12,25,33.6
722857,2011,12,03,29.0
021230,2011,01,09,13.0
024130,2011,12,09,31.5
021460,2011,04,10,30.3
021460,2011,01,14,-12.5
023370,2011,02,11,5.4
023110,2011,02,07,24.8
022330,2011,03,11,11.3
020540,2011,01,16,8.8
022170,2011,02,02,30.4
022560,2011,11,27,23.0
024130,2011,02,23,3.9
022170,2011,03,06,25.4
026460,2011,02,19,20.6
023110,2011,01,08,16.2
022920,2011,02,19,4.8
024130,2011,02,07,12.5
720654,2011,06,26,83.6
023020,2011,03,07,28.3
025070,2011,08,24,57.8
026520,2011,08,18,62.5
026460,2011,06,14,60.9
026090,2011,09,30,58.4
025070,2011,06,05,62.3
022560,2011,09,16,43.4
026090,2011,12,09,42.0
026520,2011,06,22,64.7
024720,2011,02,25,26.3
021460,2011,12,08,10.9
025070,2011,01,04,31.5
023370,2011,02,04,16.7
022560,2011,12,30,13.9
021230,2011,02,22,-10.6
021230,2011,02,11,12.5
023020,2011,02,18,3.0
026460,2011,01,21,28.4
023030,2011,02,06,21.7
021300,2011,03,28,16.1
022170,2011,01,15,13.2
022330,2011,12,17,26.6
026520,2011,02,21,22.1
023020,2011,10,20,32.6
025210,2011,03,01,28.6
022170,2011,03,22,32.5
021700,2011,01,16,14.5
023020,2011,01,12,19.2
021700,2011,12,21,21.5
022160,2011,02,15,7.8
022560,2011,01,26,10.5
026520,2011,02,23,19.4
024130,2011,01,15,6.8
020540,2011,01,02,14.5
023030,2011,01,06,14.6
022170,2011,01,01,25.8
022330,2011,12,03,23.9
022920,2011,11,28,28.5
023490,2011,01,15,-4.8
025530,2011,12,05,31.8
022560,2011,02,15,-1.0
023540,2011,03,14,30.4
021300,2011,02,07,6.0
023020,2011,08,01,57.0
022330,2011,09,14,49.1
024130,2011,05,01,41.2
022920,2011,11,25,37.0
026520,2011,08,17,62.2
022160,2011,10,28,41.7
025950,2011,06,05,60.1
023490,2011,02,24,3.1
024130,2011,01,24,22.0
023370,2011,09,30,53.5
022330,2011,04,06,36.3
026460,2011,07,11,64.3
023110,2011,04,06,38.8
022330,2011,04,05,37.5
021230,2011,12,02,30.4
021460,2011,12,10,23.2
022160,2011,12,28,28.4
023110,2011,10,20,30.9
020540,2011,01,03,0.7
022920,2011,02,04,16.4
020540,2011,01,09,4.8
020540,2011,01,07,3.2
025530,2011,02,28,24.6
021230,2011,11,20,22.0
021700,2011,12,19,31.9
021300,2011,12,05,25.1
022160,2011,02,18,4.0
022560,2011,12,25,25.0
023030,2011,11,27,23.1
023490,2011,01,01,19.4
026520,2011,01,03,17.6
023370,2011,02,17,10.6
024720,2011,12,09,32.0
021230,2011,12,30,13.1
022560,2011,12,31,12.7
023020,2011,02,16,8.2
022560,2011,02,04,12.6
023020,2011,11,27,29.3
023020,2011,04,09,35.9
024130,2011,04,12,38.2
025530,2011,09,01,50.4
023030,2011,03,25,12.8
026460,2011,08,24,61.3
026520,2011,08,22,62.0
680025,2011,01,13,73.2
026030,2011,09,18,57.3
022160,2011,08,17,52.3
023030,2011,02,24,5.8
024130,2011,02,24,5.0
026460,2011,06,20,58.0
022920,2011,04,05,38.9
022330,2011,10,07,40.8
021700,2011,06,04,56.0
026520,2011,08,10,58.0
021700,2011,02,19,-9.3
022160,2011,02,17,11.5
720747,2011,12,08,23.4
022330,2011,01,13,-6.5
025950,2011,02,14,17.3
023110,2011,12,14,29.4
023020,2011,01,11,28.0
021300,2011,01,10,9.9
020540,2011,12,29,12.8
023110,2011,11,26,29.5
025530,2011,02,22,10.3
023110,2011,02,16,9.1
020540,2011,01,11,16.0
020540,2011,12,05,28.0
026020,2011,01,28,27.9
021460,2011,12,27,25.6
022170,2011,12,12,19.7
024130,2011,02,22,6.0
021300,2011,01,03,-1.8
023490,2011,02,21,13.6
022330,2011,01,06,11.4
022560,2011,12,29,21.3
021230,2011,12,21,16.0
023370,2011,01,05,20.1
021700,2011,02,26,29.0
025950,2011,02,22,14.1
023030,2011,02,23,-0.4
023490,2011,02,02,25.7
023490,2011,06,23,53.7
023490,2011,12,25,30.0
024720,2011,04,19,48.5
720605,2011,05,27,70.6
025070,2011,08,28,56.6
022560,2011,10,03,40.7
023110,2011,10,18,38.2
025150,2011,10,04,56.5
026030,2011,07,02,67.6
026460,2011,03,28,36.2
022160,2011,06,28,65.1
023110,2011,05,15,38.8
023110,2011,07,26,54.8
023540,2011,04,10,42.6
021230,2011,05,26,36.9
025530,2011,08,05,61.7
022330,2011,04,08,30.9
720654,2011,08,17,77.4
023030,2011,10,31,37.1
023540,2011,07,15,56.8
025950,2011,07,26,64.8
720654,2011,10,03,55.9
720654,2011,06,25,79.3
022170,2011,05,28,45.4
011440,2011,06,07,50.3
025150,2011,03,13,37.6
023490,2011,09,04,58.2
021460,2011,12,23,25.4
021700,2011,07,11,67.1
023370,2011,05,15,41.1
720654,2011,10,24,57.3
025070,2011,12,25,44.1
720505,2011,10,12,71.7
023030,2011,07,14,51.9
026460,2011,01,05,30.6
021230,2011,11,09,29.2
025070,2011,07,08,61.1
023110,2011,11,05,39.0
026090,2011,08,27,64.9
026460,2011,05,10,54.6
022560,2011,09,10,49.0
024130,2011,11,04,43.3
025070,2011,11,24,47.3
72065
Query:
SELECT "stn", COUNT("temp") AS "temp_count"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
   WHERE "temp" IS NOT NULL
   GROUP BY "stn"
   LIMIT 1000;
Answer:
Too long, hard cut:
stn,temp_count
484150,364
488300,364
977220,356
873490,365
610960,362
247680,356
319870,365
345040,365
285880,365
333770,365
961630,365
471500,365
404170,363
370850,365
483600,363
973400,364
874480,364
360640,365
970480,365
383880,365
412460,338
427540,360
432130,360
620550,64
028720,363
484000,365
293480,365
875480,365
385990,359
874670,364
308620,365
296450,365
292820,365
470350,361
388950,365
297360,365
485320,365
249590,358
383410,365
330190,322
028140,363
133890,365
227210,365
432260,360
226210,365
357000,365
295570,365
610910,363
470700,355
710735,303
984300,365
624400,365
624170,360
542920,365
372790,358
766920,363
400300,346
789880,365
997738,364
691534,344
998007,363
723115,365
785350,352
337610,365
252820,360
347300,365
314890,365
343910,365
288070,365
610750,364
297120,365
294050,365
260290,362
280490,365
967910,360
263890,365
325830,365
483580,364
360960,365
471620,365
335870,365
471400,365
484200,364
345790,365
360580,365
261340,363
319150,365
278570,365
985310,352
484800,365
234120,365
485570,362
296250,365
299370,365
282140,365
272080,365
261440,363
710823,268
574260,365
423280,358
915510,356
719494,313
040130,364
423610,360
350110,365
427060,360
265180,365
597580,365
524180,365
504340,365
592930,365
535640,365
514310,365
543370,365
507270,365
314840,365
488030,364
982220,364
590230,365
323890,365
471920,365
966450,365
960870,365
345450,365
426230,360
402650,358
488870,364
221270,365
379250,310
423140,360
624550,363
624030,364
616950,364
108560,360
255630,365
672970,169
624190,261
875760,365
403610,364
870970,365
403570,364
406500,365
670020,365
574940,365
404390,364
027800,365
998426,365
997202,361
994780,194
128300,365
997258,365
129100,365
694604,244
995250,257
696824,218
722909,352
717334,246
995270,256
027280,258
997694,365
066100,365
718830,365
030080,365
719674,365
041650,365
994007,364
012250,365
997372,365
997257,340
725105,365
043390,364
723927,365
014670,342
720383,362
725755,365
027900,365
030940,365
994200,365
069900,365
995910,365
994042,263
027140,349
722180,365
722906,365
724020,365
726546,365
306730,365
485740,364
309350,365
470750,355
483720,364
319690,365
324080,365
634510,156
612400,340
961790,365
623250,351
727840,363
596630,365
538450,365
576620,365
572970,365
543740,365
470600,355
291220,365
471560,365
470280,355
253560,321
433140,360
509150,365
985380,365
766540,364
471350,365
599970,361
986460,365
326180,365
471540,365
485670,365
278350,363
987470,365
984440,365
710355,237
624230,365
718432,325
622590,83
782430,260
287190,3
654720,356
616000,363
351080,365
672830,171
172550,365
614150,358
279620,365
847820,365
040630,365
766753,365
768056,365
865800,365
845010,365
374840,365
042700,365
997386,362
994043,362
997224,325
997232,233
691226,354
028730,365
720952,61
710940,322
710964,365
027010,365
995720,329
997196,152
943170,352
995330,360
696464,57
722813,331
700638,355
697514,335
108570,365
106130,360
998442,193
027470,365
710930,362
747186,365
027310,346
702686,361
998266,363
997315,364
997993,359
997784,356
691344,346
718900,365
722485,365
725347,363
701338,335
998199,314
997434,346
011020,355
012380,346
010330,364
997293,364
992220,227
994033,365
997360,320
012120,361
076610,362
722535,365
742060,365
916420,75
013830,365
710563,364
747950,365
698444,351
996440,355
997299,364
997210,29
992090,174
704890,365
028760,365
997255,365
998254,362
994650,305
995700,363
997030,365
064280,362
028890,365
720361,364
722110,365
996470,365
030100,357
008404,95
128700,365
691284,2
698264,365
697284,365
995340,316
061970,270
061510,365
998405,365
061740,365
723105,365
747900,364
724505,365
725119,365
724275,365
067050,365
129250,363
998477,104
997197,186
998234,365
998434,277
992370,365
067600,365
998342,365
471270,365
725499,365
725420,365
066460,365
998226,365
994430,365
992620,302
992110,114
013400,365
691294,13
719130,365
039560,365
029640,365
107550,365
725763,353
725045,365
725717,365
726223,365
722069,365
726519,361
725514,364
722487,364
725945,365
722489,365
702670,365
725116,365
722060,365
727530,365
725025,365
722446,365
723676,363
725070,365
726654,365
722405,365
725300,365
725190,365
725320,365
723035,365
035200,365
726350,365
725555,365
722595,364
711510,365
699604,363
584770,365
549090,365
719064,310
764593,365
703054,359
898320,341
717365,349
010550,323
892690,144
697094,312
122120,350
010190,228
998436,303
108370,359
693684,198
042110,362
064960,361
712080,365
121540,350
066660,365
996490,365
102680,365
722269,365
710640,361
062520,363
725075,365
725395,365
994090,344
997207,365
725063,365
722650,365
727675,365
726435,365
724040,365
994044,365
994230,365
722541,365
723037,363
997205,258
997200,106
994350,365
998204,362
717390,365
725287,365
725460,365
720198,365
998486,68
039610,365
718960,365
061470,347
039760,365
725376,365
722039,365
726930,365
724463,365
726620,365
724453,365
722500,365
997192,238
724066,365
723170,365
745046,365
725016,365
723346,365
221000,4
060110,365
642100,363
414430,361
800010,365
862180,365
896670,365
998005,365
722151,365
011350,33
745056,
Query:
SELECT "stn", "year", "mo", "da", "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
    WHERE "temp" IS NOT NULL
    LIMIT 1000;
Answer:
Too long, hard cut:
stn,year,mo,da,temp
010070,2020,11,10,25.2
010070,2020,11,19,18.8
010350,2020,04,12,19.3
010370,2020,12,28,33.1
010420,2020,03,01,18.0
010430,2020,02,29,22.8
011020,2020,10,13,47.9
011020,2020,09,30,56.4
011070,2020,12,19,39.7
011210,2020,10,20,38.7
011440,2020,11,28,43.8
011480,2020,10,11,44.8
011580,2020,09,12,52.4
011980,2020,12,09,34.0
012120,2020,09,26,49.8
012210,2020,10,12,39.2
012500,2020,03,08,28.6
012620,2020,11,24,44.9
012820,2020,11,14,44.5
012820,2020,12,19,41.0
012870,2020,09,08,44.8
012880,2020,10,14,34.3
012900,2020,11,07,46.4
013360,2020,12,25,23.8
013450,2020,10,22,36.5
013450,2020,12,10,28.8
013460,2020,12,25,17.0
013470,2020,12,25,22.4
013570,2020,10,05,49.3
013590,2020,12,17,25.5
013590,2020,10,12,33.6
013590,2020,11,18,41.3
013590,2020,12,02,26.7
013590,2020,09,04,48.4
013590,2020,11,04,35.0
013600,2020,01,06,37.5
013620,2020,11,02,26.7
013680,2020,12,29,27.9
013680,2020,12,20,34.9
013760,2020,09,24,53.6
013780,2020,10,11,46.9
014140,2020,11,02,51.3
014140,2020,11,01,50.9
014400,2020,10,31,36.2
014400,2020,12,08,28.9
014660,2020,09,10,54.7
014840,2020,10,06,50.9
014881,2020,09,18,54.9
024960,2020,12,22,42.4
034145,2020,06,14,60.8
034145,2020,11,11,51.8
038060,2020,11,14,54.0
038060,2020,01,11,50.0
040131,2020,12,24,43.2
040340,2020,01,26,33.6
040340,2020,12,04,20.8
040640,2020,03,17,34.2
040655,2020,08,25,48.2
040655,2020,04,23,43.2
040730,2020,10,27,29.6
040850,2020,10,05,43.8
041620,2020,12,26,9.2
070530,2020,04,24,59.2
070530,2020,03,02,43.7
070530,2020,08,03,61.8
070530,2020,07,27,71.7
070530,2020,08,15,69.8
070530,2020,01,09,52.8
070530,2020,03,31,42.6
070530,2020,03,09,44.9
070530,2020,07,02,64.0
070530,2020,10,18,43.4
070530,2020,03,01,42.8
070530,2020,09,05,61.6
070530,2020,09,24,52.6
070530,2020,06,06,56.8
070530,2020,04,14,44.4
070530,2020,07,06,60.9
070530,2020,10,17,47.9
070530,2020,09,11,64.2
070530,2020,01,12,44.2
072553,2020,06,15,67.6
076780,2020,09,15,77.1
084580,2020,05,13,60.4
084580,2020,04,02,56.6
085020,2020,08,23,74.8
085020,2020,11,10,59.7
085020,2020,09,20,69.6
085020,2020,01,06,63.9
085020,2020,02,13,60.2
085020,2020,04,25,61.3
085020,2020,09,02,76.7
085020,2020,02,12,62.3
085020,2020,05,20,61.5
085020,2020,02,14,59.8
085020,2020,10,20,63.6
085020,2020,01,26,57.0
085020,2020,02,03,56.3
085020,2020,06,17,63.6
085020,2020,05,30,64.4
085020,2020,10,09,71.7
085020,2020,06,26,67.3
085095,2020,02,18,57.3
085095,2020,10,16,66.2
085440,2020,12,28,53.4
085440,2020,10,03,56.9
085440,2020,10,26,57.1
085440,2020,12,01,58.6
085440,2020,11,21,59.0
085440,2020,12,24,48.3
085830,2020,06,22,79.4
085830,2020,12,29,73.0
085830,2020,07,21,80.8
085830,2020,01,18,72.2
085830,2020,07,10,81.9
085830,2020,01,05,71.7
085830,2020,01,27,72.2
085830,2020,04,03,74.7
085830,2020,04,12,74.9
085830,2020,05,29,77.6
085830,2020,01,17,72.2
085830,2020,12,11,74.5
085890,2020,07,20,81.1
085890,2020,10,11,80.6
085890,2020,04,15,75.0
085890,2020,08,18,82.0
085890,2020,08,27,80.1
085890,2020,01,03,73.6
085890,2020,11,04,79.0
085890,2020,01,30,78.1
085890,2020,01,23,74.8
085890,2020,12,28,73.5
085890,2020,09,27,81.6
085890,2020,06,19,79.7
085890,2020,12,04,77.1
085890,2020,07,05,78.7
085890,2020,02,14,80.6
085890,2020,03,03,78.3
085890,2020,05,14,74.5
085944,2020,06,05,80.6
085944,2020,06,16,84.2
120010,2020,08,30,65.6
120010,2020,09,18,57.2
120010,2020,04,21,43.8
120010,2020,12,15,39.6
120010,2020,07,21,60.7
120010,2020,07,29,60.8
120010,2020,05,26,44.4
120010,2020,05,16,46.5
120010,2020,06,17,55.0
120010,2020,09,27,63.8
120010,2020,06,30,62.9
120010,2020,06,29,65.3
120010,2020,10,09,56.0
120010,2020,01,16,43.3
120010,2020,10,26,51.8
120010,2020,06,23,58.7
120010,2020,04,06,46.7
120010,2020,07,23,59.0
120010,2020,04,22,45.0
125000,2020,04,13,37.6
125000,2020,10,07,55.7
133630,2020,12,22,36.3
133630,2020,08,10,67.6
134615,2020,03,11,47.1
134930,2020,04,10,52.9
135750,2020,12,31,40.5
135750,2020,04,10,57.2
135760,2020,02,21,32.9
135760,2020,01,31,39.9
135760,2020,02,15,33.1
135760,2020,04,04,32.5
135760,2020,02,23,38.7
135770,2020,04,04,35.7
135770,2020,04,21,45.4
135800,2020,12,25,53.0
135880,2020,04,23,58.9
135880,2020,04,12,63.6
135910,2020,04,12,62.2
135940,2020,05,07,56.6
135950,2020,01,16,32.8
135950,2020,05,04,62.1
135970,2020,03,27,47.8
135970,2020,09,15,81.5
135970,2020,06,29,89.9
135970,2020,12,25,43.9
140070,2020,03,14,37.6
140150,2020,03,14,48.2
141180,2020,03,11,48.5
144430,2020,01,11,54.9
144460,2020,01,09,49.5
146480,2020,09,13,83.8
155257,2020,01,03,34.2
161010,2020,06,04,64.8
162580,2020,02,07,35.9
163160,2020,11,16,54.5
164340,2020,03,27,35.6
164340,2020,01,10,45.5
165310,2020,02,10,62.2
165410,2020,06,12,64.0
165420,2020,03,27,46.9
165420,2020,07,24,86.9
165420,2020,09,18,79.7
165420,2020,08,21,85.1
165420,2020,10,02,71.1
165990,2020,02,01,58.3
165990,2020,01,10,52.7
166140,2020,03,02,46.7
166181,2020,10,30,57.6
166653,2020,12,26,64.0
166653,2020,06,08,77.4
166653,2020,12,01,47.8
166653,2020,12,12,58.1
166750,2020,10,28,56.5
167100,2020,10,21,53.2
167190,2020,04,03,57.4
167190,2020,0
Query:
SELECT DISTINCT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    WHERE "stn" IN (
        SELECT "usaf"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    )
    LIMIT 1000;
Answer:
Too long, hard cut:
stn
484150
488300
337610
319870
404170
873490
345040
247680
252820
285880
471500
314890
288070
360640
388950
297120
249590
260290
432130
343910
333770
970480
973400
874480
383880
620550
875480
874670
383410
306730
028140
412460
385990
296450
330190
292820
470350
360580
278570
985310
484800
299370
488870
710355
287190
427540
967910
227210
471620
357000
470750
710823
623250
514310
314840
471560
986460
345450
984440
616000
121540
701338
718432
722535
347300
484000
610960
961630
977220
297360
280490
325830
263890
483580
360960
335870
471400
484200
295570
261440
982220
597580
542920
535640
543370
766540
966450
624550
694604
998007
027280
483600
610750
293480
485320
294050
308620
485740
226210
345790
261340
319150
234120
485570
610910
296250
470700
319690
324080
634510
612400
309350
433140
524180
504340
596630
538450
584770
543740
549090
372790
291220
323890
471920
599970
326180
960870
471540
485670
379250
622590
654720
351080
108560
672970
279620
847820
403610
406500
768056
865800
374840
042700
697094
691534
723115
998436
108570
106130
042110
722909
997784
997434
030080
012120
722269
742060
996440
726435
061510
723105
725119
997197
998234
717390
725025
624400
766920
614150
870970
997202
898320
010550
892690
696824
710930
066660
012380
994650
997030
725063
128700
043390
725499
039760
725763
725070
370850
028720
471350
719064
574940
432260
483720
282140
961790
423280
915510
040130
350110
624170
427060
265180
727840
592930
576620
590230
470280
253560
488030
509150
985380
426230
221270
400300
423140
782430
672830
616950
875760
040630
403570
703054
789880
027800
997386
998426
994043
994780
128300
997258
995250
710940
010190
696464
722813
995270
702686
997694
066100
998266
747186
697514
997315
712080
691344
718900
725347
719674
997293
785350
012250
725075
698444
997372
725395
704890
997255
998254
028890
030100
727675
998405
724040
724275
722541
066460
998226
997200
994042
998204
992110
039560
107550
722906
998486
725514
722487
745046
725300
726350
272080
710735
984300
574260
507270
470600
987470
624230
172550
764593
766753
670020
845010
404390
717365
129100
028730
720952
122120
710964
108370
027470
995720
717334
997993
718830
722485
011020
010330
041650
996490
994033
102680
997360
710640
013830
710563
747950
997299
997257
992090
028760
064280
720361
722110
725105
722650
698264
697284
014670
061970
027900
067050
129250
998477
998434
067600
994230
994200
069900
471270
725420
723037
997205
994350
013400
691294
029640
722180
725045
725717
725287
726223
725460
724066
720198
726519
725945
702670
727530
725016
726930
724020
723676
724463
726654
726546
722500
722595
997224
064960
995700
691284
030940
992370
995910
718960
061470
722060
722446
723035
711510
699604
997192
278350
624190
997232
997196
994007
997210
720383
994430
133890
719494
423610
572970
402650
624030
255630
997738
027310
943170
995330
700638
998442
992220
062520
994090
997207
996470
723927
995340
061740
747900
725755
994044
998342
992620
719130
027140
722069
725376
723170
726620
724453
725320
035200
723346
725555
916420
724505
039610
722489
725190
027010
722039
725116
722405
076610
998199
724250
060110
414430
862180
722151
011350
725214
726818
722195
722678
025630
726824
221000
642100
800010
896670
998005
745056
722190
746410
727910
725374
085450
722014
723320
726517
726410
718210
726667
727810
722517
725125
725240
725260
725100
722170
724988
029470
942160
010890
013500
911650
727850
747400
746120
716340
474280
724455
724645
476530
727676
700637
722416
722358
020440
948750
028640
022610
076780
911860
723710
943270
013210
062100
727976
722764
702910
747590
387250
022170
021230
682905
720743
369740
035660
676930
020540
026090
720605
720406
369820
680300
643600
679770
720411
965050
842700
637420
604592
787935
637090
677650
480250
722907
679750
040131
841490
804230
634740
839420
836720
837780
255520
416200
030220
166990
167341
787450
744659
409040
726764
836724
858360
722201
162210
720623
265020
726396
787670
066580
827641
784390
844550
977800
725495
407807
333931
720627
786470
912460
378630
013755
692164
723122
646500
060100
475150
466960
692174
720283
840760
085020
474770
653765
010881
679910
637720
484076
722211
338388
476830
475670
131160
068065
720375
037663
722177
232210
384010
722666
155257
477350
106164
035413
444540
830630
783334
722052
478720
619840
837590
485575
067940
400830
844440
480200
720371
722163
722089
238045
858640
948955
724833
722334
021610
852450
823170
162592
475420
475690
021205
787140
163500
722182
162591
724043
477890
825991
827040
471280
726391
931190
026510
720254
649500
835250
132420
722073
726468
720295
682400
720622
838400
726405
858320
742078
722081
431285
287220
720869
720165
282250
307100
232215
279622
024853
722183
353948
720565
156150
289520
275155
080001
471630
123767
720612
720583
031600
725406
060800
172410
013110
085120
024930
060300
720608
833620
802220
725408
725489
726548
726553
744661
720327
722154
742513
722071
723761
723055
726603
171700
824000
410360
161790
483270
686140
864500
844250
432210
298020
601850
443480
86360
Query:
SELECT DISTINCT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    WHERE "year" BETWEEN '2011' AND '2020'
    LIMIT 1000;
Answer:
Too long, hard cut:
stn
484150
488300
977220
873490
610960
247680
319870
345040
285880
333770
961630
471500
404170
370850
483600
973400
874480
360640
970480
383880
412460
427540
432130
620550
028720
484000
293480
875480
385990
874670
308620
296450
292820
470350
388950
297360
485320
249590
383410
330190
028140
133890
227210
432260
226210
357000
295570
610910
470700
710735
984300
624400
624170
542920
372790
766920
337610
252820
347300
314890
343910
288070
610750
297120
294050
260290
280490
967910
263890
325830
483580
360960
471620
335870
471400
484200
345790
360580
261340
319150
278570
985310
484800
234120
485570
296250
299370
282140
272080
261440
710823
574260
423280
915510
719494
040130
423610
350110
427060
265180
597580
524180
504340
592930
535640
514310
543370
507270
314840
488030
982220
590230
323890
306730
485740
309350
470750
483720
319690
324080
634510
612400
961790
623250
727840
596630
576620
572970
543740
471560
470280
253560
433140
538450
584770
549090
470600
291220
966450
060110
471350
278350
345450
221270
984440
426230
960870
471920
402650
718432
400300
691226
986460
624550
326180
379250
996440
719064
509150
599970
221000
985380
987470
423140
387250
026090
022170
020540
021230
720605
369820
369740
726603
702755
787935
844550
021610
237010
965050
670850
720406
720743
480200
637090
679610
840760
066820
977800
067940
633310
836720
085020
725495
839420
630210
035660
722907
162210
637720
338388
060100
679770
744653
858360
255520
726396
400830
654720
804230
722032
677650
672970
692164
475670
155257
409040
131160
172550
040131
444540
803420
720627
484076
676930
722081
010881
722201
167341
653765
693614
679750
384010
679910
477350
725454
474770
830630
035413
032145
037663
167193
837780
720583
634740
722052
476830
744659
851960
836724
766546
478720
619840
827641
837590
683210
692174
783334
722334
722089
722177
070700
637420
823170
722866
766580
109470
836490
155256
723055
725457
478560
475690
475420
477890
682677
724043
162592
330005
649500
162591
827040
804100
407807
232210
723529
265020
722091
027140
801390
787670
238045
172050
068065
787450
604592
485575
858320
720254
106164
784390
787140
722163
480250
723676
680300
636580
353948
766127
852450
163500
786470
021205
333931
416200
682905
720602
842260
612970
701338
722182
650020
724026
132890
029470
166990
554720
722128
724833
768556
700638
726553
723761
787410
066580
672830
804470
407823
868910
024930
720739
643600
720411
841490
842700
030220
722666
720623
064280
726764
722211
720375
844440
720371
858640
725453
725479
825991
642100
948955
648100
432210
113080
643900
844250
266295
108370
722369
108560
726391
684420
031350
835250
720345
256770
027570
483770
027590
873710
273690
341520
485170
485700
239550
253780
260590
268870
483070
249510
970860
433290
431890
383340
433460
430860
266450
388060
485660
443470
228450
306030
321650
252480
347200
484580
443290
135830
310880
484250
246390
385110
027690
421110
874160
655050
262260
483740
969870
443850
350260
876410
265240
259540
860970
471880
589110
279950
526520
511560
484550
248560
279280
341710
876450
442370
134620
251380
471360
297240
973000
279060
027890
236620
484770
333170
348800
060120
355760
965290
470950
484010
285730
314450
470520
976900
313000
263590
282400
332750
348660
610990
292310
320980
960730
309490
484090
962950
484530
655100
484130
296050
433210
336630
360380
470610
442170
331350
485810
986440
485550
470460
219310
424520
428860
987410
548430
516440
536140
561870
509490
540260
318250
763930
412700
578660
524950
533910
442120
317020
442130
895320
355320
471520
969350
483250
331770
214320
484350
021510
285410
320610
314780
428400
585560
596320
433330
040050
995400
623870
571780
540270
132780
272420
360610
303370
624320
531490
442560
485610
344150
537980
294300
718437
314740
988510
975700
247240
306860
470580
290230
402550
862210
916100
864600
692484
996570
623050
718442
428740
425590
710354
431170
582030
599810
577990
202920
889680
976300
620120
575840
433530
378510
509630
579320
784860
421820
010014
025070
021300
023540
024130
725621
384620
720381
112410
066120
112520
108600
678690
820305
010885
686680
846730
312850
703056
634020
067450
701719
847350
042605
036440
701196
702550
636304
010883
407127
720853
875060
836725
034920
073170
702711
700634
702647
470220
787421
724293
484075
488460
740002
804570
637140
476435
637410
749171
718755
476600
401761
348610
786390
470050
685380
067530
804120
031140
038030
637260
839810
031394
879340
854590
160595
787625
266661
720339
414370
161220
787945
475490
475530
477790
851040
155258
786445
835880
639320
917830
414520
783841
010876
720257
747808
831110
766534
846580
720867
812000
652500
692214
646010
684380
693594
620100
804340
128605
160520
474790
477940
836980
039240
485577
286760
381417
724395
342140
725337
703870
828240
800970
165420
800630
785140
106163
711810
121053
724694
652010
677790
804130
042025
474900
677610
787930
724165
726417
724014
726404
478570
014033
726568
407821
489410
480370
111460
804370
840360
720374
841430
744672
646650
720494
704140
413410
722214
43336
Query:
WITH nearby_stations AS (
    SELECT LPAD(TRIM("usaf"), 6, '0') AS station_id, "name"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    WHERE "lat" IS NOT NULL AND "lon" IS NOT NULL
      AND "usaf" IS NOT NULL AND TRIM("usaf") != ''
      AND ST_DWITHIN(
          TO_GEOGRAPHY('POINT(' || "lon" || ' ' || "lat" || ')'),
          TO_GEOGRAPHY('POINT(-73.764 41.197)'),
          32186.8
      )
)

SELECT
    ns.station_id,
    ns."name" AS station_name,
    COUNT(g."temp") AS number_of_temperature_observations
FROM
    nearby_stations ns
JOIN (
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
    UNION ALL
    SELECT LPAD(TRIM("stn"), 6, '0') AS station_id, "temp"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
    WHERE "temp" IS NOT NULL AND "stn" IS NOT NULL AND TRIM("stn") != ''
) g ON ns.station_id = g.station_id
GROUP BY
    ns.station_id, ns."name";
Answer:
STATION_ID,STATION_NAME,NUMBER_OF_TEMPERATURE_OBSERVATIONS
999999,WHITE PLAINS WESTCHESTER CO A,1123769
725086,DANBURY MUNI ARPT,3649
999999,BEAR MOUNTAIN WB,1123769
997186,WESTERN LONG ISLAND SOUND,1532
725037,WESTCHESTER COUNTY AIRPORT,3653
725086,DANBURY MUNICIPAL AIRPORT,3649
Query:
WITH nearby_stations AS (
    SELECT "usaf" AS station_id, "name"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    WHERE ST_DWITHIN(
        TO_GEOGRAPHY('POINT(' || "lon" || ' ' || "lat" || ')'),
        TO_GEOGRAPHY('POINT(-73.764 41.197)'),
        32186.8
    )
)

SELECT
    ns.station_id,
    ns."name" AS station_name,
    COUNT(*) AS number_of_temperature_observations
FROM
    nearby_stations ns
JOIN (
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
    UNION ALL
    SELECT "stn"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
) g ON ns.station_id = g."stn"
GROUP BY
    ns.station_id, ns."name";
Answer:
STATION_ID,STATION_NAME,NUMBER_OF_TEMPERATURE_OBSERVATIONS
725086,DANBURY MUNICIPAL AIRPORT,3649
999999,WHITE PLAINS WESTCHESTER CO A,1123769
725086,DANBURY MUNI ARPT,3649
999999,BEAR MOUNTAIN WB,1123769
997186,WESTERN LONG ISLAND SOUND,1532
725037,WESTCHESTER COUNTY AIRPORT,3653
Query:
SELECT "stn", COUNT(*) AS "days_of_data"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    WHERE "temp" IS NOT NULL
    GROUP BY "stn"
    LIMIT 1000;
Answer:
Too long, hard cut:
stn,days_of_data
484150,364
488300,364
977220,356
873490,365
610960,362
247680,356
319870,365
345040,365
285880,365
333770,365
961630,365
471500,365
404170,363
370850,365
483600,363
973400,364
874480,364
360640,365
970480,365
383880,365
412460,338
427540,360
432130,360
620550,64
028720,363
484000,365
293480,365
875480,365
385990,359
874670,364
308620,365
296450,365
292820,365
470350,361
388950,365
297360,365
485320,365
249590,358
383410,365
330190,322
028140,363
133890,365
227210,365
432260,360
226210,365
357000,365
295570,365
610910,363
470700,355
710735,303
984300,365
624400,365
624170,360
542920,365
372790,358
766920,363
400300,346
789880,365
997738,364
691534,344
998007,363
723115,365
785350,352
337610,365
252820,360
347300,365
314890,365
343910,365
288070,365
610750,364
297120,365
294050,365
260290,362
280490,365
967910,360
263890,365
325830,365
483580,364
360960,365
471620,365
335870,365
471400,365
484200,364
345790,365
360580,365
261340,363
319150,365
278570,365
985310,352
484800,365
234120,365
485570,362
296250,365
299370,365
282140,365
272080,365
261440,363
710823,268
574260,365
423280,358
915510,356
719494,313
040130,364
423610,360
350110,365
427060,360
265180,365
597580,365
524180,365
504340,365
592930,365
535640,365
514310,365
543370,365
507270,365
314840,365
488030,364
982220,364
590230,365
323890,365
471920,365
966450,365
960870,365
345450,365
426230,360
402650,358
488870,364
221270,365
379250,310
423140,360
624550,363
624030,364
616950,364
108560,360
255630,365
672970,169
624190,261
875760,365
403610,364
870970,365
403570,364
406500,365
670020,365
574940,365
404390,364
027800,365
998426,365
997202,361
994780,194
128300,365
997258,365
129100,365
694604,244
995250,257
696824,218
722909,352
717334,246
995270,256
027280,258
997694,365
066100,365
718830,365
030080,365
719674,365
041650,365
994007,364
012250,365
997372,365
997257,340
725105,365
043390,364
723927,365
014670,342
720383,362
725755,365
027900,365
030940,365
994200,365
069900,365
995910,365
994042,263
027140,349
722180,365
722906,365
724020,365
726546,365
306730,365
485740,364
309350,365
470750,355
483720,364
319690,365
324080,365
634510,156
612400,340
961790,365
623250,351
727840,363
596630,365
538450,365
576620,365
572970,365
543740,365
470600,355
291220,365
471560,365
470280,355
253560,321
433140,360
509150,365
985380,365
766540,364
471350,365
599970,361
986460,365
326180,365
471540,365
485670,365
278350,363
987470,365
984440,365
710355,237
624230,365
718432,325
622590,83
782430,260
287190,3
654720,356
616000,363
351080,365
672830,171
172550,365
614150,358
279620,365
847820,365
040630,365
766753,365
768056,365
865800,365
845010,365
374840,365
042700,365
997386,362
994043,362
997224,325
997232,233
691226,354
028730,365
720952,61
710940,322
710964,365
027010,365
995720,329
997196,152
943170,352
995330,360
696464,57
722813,331
700638,355
697514,335
108570,365
106130,360
998442,193
027470,365
710930,362
747186,365
027310,346
702686,361
998266,363
997315,364
997993,359
997784,356
691344,346
718900,365
722485,365
725347,363
701338,335
998199,314
997434,346
011020,355
012380,346
010330,364
997293,364
992220,227
994033,365
997360,320
012120,361
076610,362
722535,365
742060,365
916420,75
013830,365
710563,364
747950,365
698444,351
996440,355
997299,364
997210,29
992090,174
704890,365
028760,365
997255,365
998254,362
994650,305
995700,363
997030,365
064280,362
028890,365
720361,364
722110,365
996470,365
030100,357
008404,95
128700,365
691284,2
698264,365
697284,365
995340,316
061970,270
061510,365
998405,365
061740,365
723105,365
747900,364
724505,365
725119,365
724275,365
067050,365
129250,363
998477,104
997197,186
998234,365
998434,277
992370,365
067600,365
998342,365
471270,365
725499,365
725420,365
066460,365
998226,365
994430,365
992620,302
992110,114
013400,365
691294,13
719130,365
039560,365
029640,365
107550,365
725763,353
725045,365
725717,365
726223,365
722069,365
726519,361
725514,364
722487,364
725945,365
722489,365
702670,365
725116,365
722060,365
727530,365
725025,365
722446,365
723676,363
725070,365
726654,365
722405,365
725300,365
725190,365
725320,365
723035,365
035200,365
726350,365
725555,365
722595,364
711510,365
699604,363
584770,365
549090,365
719064,310
764593,365
703054,359
898320,341
717365,349
010550,323
892690,144
697094,312
122120,350
010190,228
998436,303
108370,359
693684,198
042110,362
064960,361
712080,365
121540,350
066660,365
996490,365
102680,365
722269,365
710640,361
062520,363
725075,365
725395,365
994090,344
997207,365
725063,365
722650,365
727675,365
726435,365
724040,365
994044,365
994230,365
722541,365
723037,363
997205,258
997200,106
994350,365
998204,362
717390,365
725287,365
725460,365
720198,365
998486,68
039610,365
718960,365
061470,347
039760,365
725376,365
722039,365
726930,365
724463,365
726620,365
724453,365
722500,365
997192,238
724066,365
723170,365
745046,365
725016,365
723346,365
060110,365
029470,363
800010,365
414430,361
942160,355
010890,362
746120,365
896670,365
013500,322
722195,365
71
Query:
SELECT DISTINCT "year"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    LIMIT 1000;
Answer:
year
2011
Query:
SELECT "usaf", "name", "begin", "end"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    WHERE "begin" <= '20110101' AND "end" >= '20201231'
    LIMIT 1000;
Answer:
Too long, hard cut:
usaf,name,begin,end
010240,PYRAMIDEN,19730101,20210918
010470,KAUTOKEINO II,19730101,20210917
011560,BO I VESTERALEN,20040510,20210913
011980,DIVIDALEN II,20100114,20210918
012210,TAGDALEN,20080115,20210909
012390,HJERKINN II,20100907,20210906
014110,KVITSOY - NORDBO,20050612,20210915
014120,OBRESTAD,19730101,20210909
025010,VADEROARNA,19770804,20210916
030410,AONACH MOR,19920302,20210916
030650,CAIRNGORM SUMMIT,19850106,20210610
031620,ESKDALEMUIR,19291001,20210916
032660,LINTON ON OUSE,19730101,20210901
034145,COSFORD,19940831,20210914
035715,CAMBRIDGE,19770201,20210917
039520,ROCHES POINT,19291001,20210913
039610,OAK PARK - CARLOW,20080721,20210918
039790,BALLYHAISE,20080721,20210918
060110,TORSHAVN,19310103,20210701
060440,HALS,19860614,20210827
060994,OKSBOEL,20050530,20210826
070220,VIGITE DU HAUMET,19760302,20210715
070290,PORT EN BESSIN,19840101,20210715
070340,CARTERET,19861001,20210715
070530,CORMEILLES,19730107,20210715
070570,CREIL,19400713,20210728
070590,MEAULTE,19400617,20210818
071020,POINTE ST MATHIEU,19831208,20210715
071030,POINTE DU RAZ,19730101,20210715
071160,BATZ ISLAND,19760708,20210715
071210,BREHAT ISLAND,19360105,20210715
071330,POINTE DU ROC,19730101,20210715
072000,PENMARCH,19360102,20210715
072160,CHEMOULIN,20010919,20210715
073170,BISCAROSSE / PARENTIS,20040803,20210715
074770,LES SAUVAGES,19730101,20210715
074870,GRENONBLE LVD,20050201,20210715
074990,CHAMONIX-OBS,20100612,20210614
075860,CARPENTRAS,19760309,20210715
075890,ST CHRISTOPHE,19360702,20210714
075900,LES PORTES EN VALGAUDEMAR,20060109,20210714
075910,EMBRUN,19730101,20210624
075930,BRIANCON,19340801,20210707
076280,MURET-LHERM,20100611,20210715
076293,LHERM,20100611,20210714
076310,FRANCAZAL,19310101,20210715
076510,L'ESPIGUETTE,19841201,20210715
076530,CAP COURONNE,19750715,20210715
076560,BEC DE LAIGLE,19760309,20210715
076770,CAPE CAMARAT,19750715,20210715
076780,TOULON/ILE DU LEVAN,19760309,20210715
076810,LE DRAMONT,20090801,20210715
076880,LA GAROUPE,19750916,20210715
077520,LA PARATA,19360617,20210715
077680,LA CHIAPPA,19360615,20210715
077910,CAPE SAGRO,19431204,20210715
078760,LE GRAND BORNAND,20090901,20210326
081570,DAROCA I,19730101,20210419
085155,GRACIOSA,20050719,20210509
085300,CABO CARVOEIRO,19480111,20210821
085490,COIMBRA,19480111,20210104
089600,VALDELINARES  'ESQUI'        ,20031222,20210917
110080,ROHRBACH,19761101,20210702
111090,ST ANTON AM ARLBERG,19820301,20210327
111440,ZELL AM SEE (AUT)            ,19661003,20210826
111730,FISHBACH,20060711,20210219
111930,BAD TATZMANNSDORF,20060726,20210219
112340,BAD EISENKAPPEL,20040619,20210413
112600,MALLNITZ-BAD,19901201,20210910
112630,WEISSENSEE/GATSCHACH,20040610,20210219
112780,POERTSCHACH,20080310,20210324
113480,MARIAPFARR,19911102,20210219
123764,NOWA DEBA,20090908,20210609
125560,KRAKOW/BALICE,20020601,20210810
160140,VIPITENO,20050727,20210804
160230,TRENTO,20070605,20210804
160600,TORINO VENARIA,20050727,20210127
160890,DESENZANO,20050727,20210531
161320,BOLOGNA,20050727,20210519
161900,ANCONA,19490403,20210917
162880,CASERTA,20050727,20210309
163180,MARTINA FRANCA,19730915,20210901
165840,BARI PALESE,20070822,20210128
221000,VERKHOV'E R LOTTA,19600220,20210708
226860,VENDINGA,19590101,20210915
229960,OB'JACEVO,19590101,20210908
233300,SALEHARD,19320101,20210903
237110,TROICKO-PECHERSKOE,19320101,20210911
238230,VONEGAN,19700108,20210618
262980,BOLOGOE,19590807,20210918
263890,OSTASKOV,19590102,20210907
263930,VYSNIJ VOLOCEK,19320101,20210918
264790,TOROPEC,19631204,20210914
265020,PALANGA INTL,19590101,20210905
265780,VELIZH,19590803,20210918
265850,BELYJ,19480101,20210914
267110,CHERNYAHOVSK,19590101,20210918
267840,POCHINOK,19881201,20210818
271640,KOLOGRIV,19590103,20210918
272080,MAKSATIKHA,19881201,20210917
272420,BUJ,19460102,20210912
272520,NIKOLO-POLOMA,19590101,20210914
272710,SAR'JA,19361231,20210916
273160,KASIN,19590101,20210910
273470,IVANOVO,19361231,20210918
273550,JUR'EVEC,19550301,20210911
274020,TVER'                        ,19460101,20210914
274170,KLIN,19840511,20210906
275230,PAVLOVSKIJ POSAD,19590101,20210827
275320,VLADIMIR,19460307,20210914
275390,GUS'-HRUSTAL'NYJ,19590101,20210904
276270,KASIRA,19590823,20210917
276970,TETYUSHI,19620414,20210918
277760,SURSKOE,19590101,20210905
278350,RJAZSK,19881108,20210629
278580,PACELMA,19590101,20210911
278720,INZA,19570701,20210917
278940,NOVODEVIC'E,19620621,20210916
279550,BELINSKIY,19740820,20210906
279830,SYZRAN'                      ,19590101,20210914
279950,SAMARA (BEZENCHUK)           ,19320102,20210903
281160,KUDYMKAR,19460309,20210712
283660,JARKOVO,19530216,20210809
283670,TYUMEN'                      ,19320101,20210905
284650,JALTUROVOSK,19530216,20210918
284910,BOL'SIE UKI,19550101,20210913
285060,ELABUGA,19460101,20210914
285170,MENZELINSK,20050828,20210827
285930,BOL'SHERECH'E,19480101,20210809
286870,BULAJEVO,19590101,20210102
287040,CULPANOVO,19590101,20210917
287050,CELNO-VERSINY,19611205,20210911
305540,BAGDARIN,19480101,20210918
308220,BABUSKIN,19530216,
Query:
SELECT "stn", "temp"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "temp" IS NOT NULL
LIMIT 1000;
Answer:
Too long, hard cut:
stn,temp
387340,28.6
387250,31.5
388440,24.4
724293,24.3
061080,59.9
388460,32.5
388440,17.3
388440,23.8
387340,46.3
023020,32.9
021300,30.5
680025,71.2
023020,62.2
023030,44.7
026020,48.0
021300,42.6
022330,-14.0
020540,29.8
025210,65.2
026460,31.7
026460,66.1
023020,42.9
025210,59.1
022560,23.6
023370,22.9
023370,23.4
022160,30.7
023030,30.3
026520,20.3
010231,34.0
023020,33.6
722857,29.0
021230,13.0
024130,31.5
021460,30.3
021460,-12.5
023370,5.4
023110,24.8
022330,11.3
020540,8.8
022170,30.4
022560,23.0
024130,3.9
022170,25.4
026460,20.6
023110,16.2
022920,4.8
024130,12.5
720654,83.6
023020,28.3
025070,57.8
026520,62.5
026460,60.9
026090,58.4
025070,62.3
022560,43.4
026090,42.0
026520,64.7
024720,26.3
021460,10.9
025070,31.5
023370,16.7
022560,13.9
021230,-10.6
021230,12.5
023020,3.0
026460,28.4
023030,21.7
021300,16.1
022170,13.2
022330,26.6
026520,22.1
023020,32.6
025210,28.6
022170,32.5
021700,14.5
023020,19.2
021700,21.5
022160,7.8
022560,10.5
026520,19.4
024130,6.8
020540,14.5
023030,14.6
022170,25.8
022330,23.9
022920,28.5
023490,-4.8
025530,31.8
022560,-1.0
023540,30.4
021300,6.0
023020,57.0
022330,49.1
024130,41.2
022920,37.0
026520,62.2
022160,41.7
025950,60.1
023490,3.1
024130,22.0
023370,53.5
022330,36.3
026460,64.3
023110,38.8
022330,37.5
021230,30.4
021460,23.2
022160,28.4
023110,30.9
020540,0.7
022920,16.4
020540,4.8
020540,3.2
025530,24.6
021230,22.0
021700,31.9
021300,25.1
022160,4.0
022560,25.0
023030,23.1
023490,19.4
026520,17.6
023370,10.6
024720,32.0
021230,13.1
022560,12.7
023020,8.2
022560,12.6
023020,29.3
023020,35.9
024130,38.2
025530,50.4
023030,12.8
026460,61.3
026520,62.0
680025,73.2
026030,57.3
022160,52.3
023030,5.8
024130,5.0
026460,58.0
022920,38.9
022330,40.8
021700,56.0
026520,58.0
021700,-9.3
022160,11.5
720747,23.4
022330,-6.5
025950,17.3
023110,29.4
023020,28.0
021300,9.9
020540,12.8
023110,29.5
025530,10.3
023110,9.1
020540,16.0
020540,28.0
026020,27.9
021460,25.6
022170,19.7
024130,6.0
021300,-1.8
023490,13.6
022330,11.4
022560,21.3
021230,16.0
023370,20.1
021700,29.0
025950,14.1
023030,-0.4
023490,25.7
023490,53.7
023490,30.0
024720,48.5
720605,70.6
025070,56.6
022560,40.7
023110,38.2
025150,56.5
026030,67.6
026460,36.2
022160,65.1
023110,38.8
023110,54.8
023540,42.6
021230,36.9
025530,61.7
022330,30.9
720654,77.4
023030,37.1
023540,56.8
025950,64.8
720654,55.9
720654,79.3
022170,45.4
011440,50.3
025150,37.6
023490,58.2
021460,25.4
021700,67.1
023370,41.1
720654,57.3
025070,44.1
720505,71.7
023030,51.9
026460,30.6
021230,29.2
025070,61.1
023110,39.0
026090,64.9
026460,54.6
022560,49.0
024130,43.3
025070,47.3
720654,80.6
025530,32.1
025530,45.0
022920,37.3
023030,45.3
026090,57.2
025070,66.1
720787,73.2
024130,37.5
026090,65.3
026520,55.3
023540,38.1
026020,31.0
022160,48.6
023020,56.7
720654,78.2
026090,50.1
024130,64.7
025950,41.3
025070,44.0
023030,52.4
720654,78.5
025210,55.9
021300,62.6
026030,61.7
024130,21.9
023030,51.0
023370,51.4
021230,55.2
026030,57.1
021230,36.3
022330,35.2
026030,39.3
022330,43.7
026460,63.8
010231,50.3
025150,32.8
024720,66.7
022920,57.8
025150,37.7
023030,39.6
720654,73.5
720605,75.3
024130,51.3
025950,39.8
720406,70.1
026030,45.4
023030,40.3
023110,61.6
026030,67.8
022170,58.4
023490,46.3
023490,59.9
023490,63.2
023370,58.2
720654,71.1
026460,60.1
021460,46.5
010231,56.8
021700,54.2
025950,34.7
026030,59.7
720743,69.6
720406,45.5
026090,47.7
023030,49.2
026090,39.0
025150,44.5
026030,56.4
026020,61.3
022160,57.9
026090,47.7
011440,55.3
025150,65.1
025530,67.1
024130,55.9
024720,52.9
024720,66.3
026020,34.7
720654,82.5
023370,46.6
024130,37.7
023020,23.4
720743,84.3
026090,62.1
020540,49.5
025530,52.7
011440,51.1
025530,44.5
720406,59.6
026020,56.1
023540,57.8
026460,58.6
022160,50.1
021230,32.3
023490,52.2
010231,55.0
035661,46.1
010231,55.0
022160,36.3
022330,60.2
023030,39.6
021700,36.0
025150,46.0
022330,50.2
026020,38.9
022160,49.5
024130,53.8
720505,82.4
023540,49.9
021700,41.8
022920,49.2
022170,50.9
025070,35.3
022920,45.0
026020,56.6
025070,34.7
022170,55.8
023020,49.5
720406,68.5
023540,29.8
720654,55.2
025530,33.9
022160,52.4
026460,57.4
026020,62.1
022560,38.6
025070,52.8
021230,27.7
022170,59.1
022920,46.5
023110,54.2
026030,30.2
025950,44.5
023030,47.2
022920,58.4
022920,57.6
025530,35.5
025530,54.3
025150,51.3
022330,50.8
011440,59.1
022170,49.4
023370,52.4
025950,60.2
023030,47.4
023110,49.1
021300,47.8
022920,44.7
022560,30.3
026020,55.2
025150,39.6
025150,42.1
720747,37.9
021700,63.8
026030,61.8
023020,48.6
025150,52.2
024130,62.3
023030,26.9
023110,54.7
025070,56.1
021700,39.1
026020,39.5
011440,53.3
022330,29.7
021460,36.1
022560,50.7
023030,46.3
025070,44.4
026460,63.4
025210,37.2
023540,45.5
022160,34.0
021230,43.3
023370,48.9
021230,36.4
022920,34.7
369740,53.6
680300,64.8
389540,41.2
023490,53.2
023490,35.4
720654,87.9
025950,34.3
026020,66.5
022330,35.8
026460,63.5
720406,64.6
025210,48.0
025950,65.5
025210,30.9
720654,84.8
024720,37.6
026030,59.5
021700,56.0
021700,45.9
021300,61.3
026020,64.0
720654,86.2
026
Query:
SELECT "usaf", "lat", "lon"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    WHERE "lat" IS NOT NULL AND "lon" IS NOT NULL
    LIMIT 1000;
Answer:
Too long, hard cut:
usaf,lat,lon
007018,0.0,0.0
007026,0.0,0.0
007070,0.0,0.0
008268,32.95,65.567
008307,0.0,0.0
010016,64.85,11.233
010017,59.98,2.25
010071,78.217,15.583
010190,77.517,20.817
010240,78.65,16.367
010303,69.7,19.017
010320,69.017,19.283
010340,70.317,20.15
010470,69.017,23.067
010510,69.583,23.533
010530,70.683,23.683
010610,70.067,25.117
010660,71.067,26.233
010670,69.9,26.417
010671,69.9,26.417
010750,70.4,28.2
010884,59.185,9.567
011030,65.1,11.7
011051,67.417,11.883
011100,66.0,11.683
011130,66.8,13.983
011133,60.417,8.513
011310,67.883,13.05
011340,65.183,13.417
011380,67.3,13.5
011490,66.333,14.1
011501,65.683,14.167
011530,67.283,14.45
011540,68.583,14.3
011560,68.6,14.433
011630,66.5,15.25
011680,68.65,15.283
011691,66.967,15.317
011700,67.233,15.317
011720,68.0,15.617
011760,68.567,16.267
011840,68.933,16.683
011841,68.933,16.683
011890,68.483,16.883
011930,68.467,17.5
011960,68.75,17.817
011980,68.783,19.7
012070,62.1,5.583
012091,62.183,6.05
012150,62.62,7.23
012160,62.617,7.217
012161,62.617,7.167
012210,63.05,9.083
012273,62.833,8.3
012310,62.233,8.367
012350,62.083,9.133
012360,62.1,9.05
012390,62.217,9.55
012430,63.333,9.65
012520,62.817,10.017
012580,63.417,10.433
012740,63.2,11.117
012771,63.717,11.233
012780,63.783,11.683
012823,64.85,11.233
012890,62.583,11.35
012891,62.583,11.383
012920,63.417,11.7
012950,64.55,12.15
012960,64.25,12.417
012980,64.45,13.717
013060,60.75,4.717
013160,60.4,5.317
013180,61.783,6.183
013220,61.467,5.917
013250,60.833,5.95
013280,60.4,5.917
013390,61.167,6.65
013410,60.467,6.867
013471,61.167,7.133
013510,60.6,7.5
013560,61.517,7.9
013591,60.517,7.867
013671,61.233,8.933
013690,60.917,9.283
013720,60.567,9.133
013743,61.0,9.3
013790,61.883,10.15
013801,61.167,9.967
013839,60.817,11.067
013910,60.617,12.017
014000,56.55,3.217
014010,59.983,2.25
014035,59.35,5.217
014110,59.067,5.417
014120,58.65,5.567
014211,59.85,6.0
014280,58.099,6.626
014320,58.883,6.85
014321,58.967,6.933
014330,59.833,6.983
014450,59.45,8.0
014460,59.567,8.2
014611,59.85,8.65
014740,59.9,9.533
014750,59.183,9.567
014870,59.933,10.833
014960,59.817,11.483
014970,59.0,11.533
014980,59.967,12.217
015000,59.383,11.383
020120,67.733,17.467
020180,67.533,18.233
020200,68.417,18.167
020230,68.433,18.633
020260,67.317,18.883
020320,68.217,19.717
020430,67.933,21.067
020450,67.833,20.417
020480,67.167,20.667
020510,68.45,22.5
020540,68.05,21.75
020560,65.067,17.167
020600,68.683,21.533
020711,60.417,15.517
020800,68.45,22.45
020840,68.05,22.0
020860,67.767,22.35
020880,67.083,22.217
020920,67.95,23.467
020960,67.217,23.4
020970,55.6,13.067
021040,65.817,15.083
021050,65.533,14.983
021080,65.067,14.8
021120,63.05,12.267
021160,63.317,13.65
021180,65.317,16.033
021200,66.883,18.017
021220,66.533,17.667
021230,66.317,17.1
021270,65.067,17.167
021280,65.0,17.7
021290,64.967,17.7
021300,66.483,16.417
021360,65.5,18.95
021420,66.496,20.147
021430,66.217,19.133
021440,65.983,18.933
021450,66.15,19.633
021460,66.5,19.683
021520,66.3,20.417
021560,63.967,13.717
021580,65.133,20.783
021590,65.12,20.77
021600,66.75,21.05
021640,66.383,21.633
021690,65.867,21.45
021720,65.683,20.967
021820,66.267,22.833
021850,65.55,22.133
021900,66.85,23.033
022000,63.983,12.867
022060,63.283,12.133
022150,63.433,13.083
022160,63.3,13.883
022170,63.367,13.167
022180,63.317,13.65
022220,64.5,14.167
022240,63.767,14.433
022320,64.433,15.633
022330,64.967,15.383
022340,63.867,15.583
022440,63.683,16.95
022480,63.167,16.167
022520,64.45,17.083
022560,64.733,17.4
022580,65.817,16.717
022620,66.567,16.35
022640,64.083,18.417
022660,64.583,16.85
022700,64.917,19.467
022740,64.217,19.717
022780,63.15,16.167
022830,63.817,20.233
022861,61.267,17.1
022890,63.333,20.183
022920,64.433,21.283
022960,64.483,21.583
023000,62.583,12.217
023020,61.833,12.283
023030,62.733,12.733
023040,61.85,12.267
023060,61.133,12.817
023100,62.8,13.067
023110,61.15,13.117
023130,58.1,14.4
023140,62.1,13.25
023141,58.017,16.067
023180,61.167,13.017
023191,57.417,13.283
023201,57.967,13.85
023230,62.533,14.2
023240,62.017,14.183
023260,64.083,18.417
023280,63.05,17.767
023300,62.75,15.1
023321,57.15,15.667
023360,61.383,15.833
023370,62.267,15.667
023420,62.517,16.183
023451,55.633,13.7
023460,61.783,16.55
023490,62.767,16.733
023540,62.433,17.35
023600,64.633,21.083
023640,63.4,18.967
023700,60.6,16.95
023710,60.433,15.5
023750,59.35,16.717
023760,61.267,17.1
023980,55.917,14.083
024000,60.35,12.65
024020,59.867,11.967
024040,59.667,12.583
024060,59.283,12.05
024090,59.05,12.7
024100,60.683,13.7
024120,60.15,13.8
024130,60.75,12.767
024161,59.617,13.733
024200,60.517,14.95
024220,59.617,14.183
024240,59.95,14.95
024280,59.1,14.367
024300,60.917,15.117
024330,60.617,15.667
024360,59.267,15.333
024373,59.387,15.924
024390,59.533,15.583
024440,60.167,16.317
024480,59.2,16.917
024510,60.883,17.917
024620,59.867,17.633
024650,59.35,17.967
024710,60.5,18.867
024720,60.117,15.117
024730,60.283,18.917
024740,60.167,18.75
024850,59.35,18.067
024940,64.483,21.583
024950,5
Query:
SELECT DISTINCT "state"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    LIMIT 1000;
Answer:
state
""
NM
CA
MI
NV
TX
WA
AZ
OR
NC
FL
KY
IN
GA
CO
NU
NS
MT
IL
LA
MD
KS
WY
SC
NJ
VT
ME
AL
TN
ND
MS
NE
DE
NY
PR
PC
PW
RI
MH
JQ
DC
UM
QC
MP
AS
AR
YK
BC
VA
MO
OK
PA
OH
NH
AK
UT
NB
WV
WI
MN
IA
ID
MA
NT
VI
HI
GU
CR
ON
MB
SD
CT
FM
YT
End Exploring Related Columns
Task: Can you provide weather stations within a 20-mile radius of Chappaqua, New York (Latitude: 41.197, Longitude: -73.764), and tell me the number of valid temperature observations they have recorded from 2011 to 2020?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: SELECT S."Column_Name" FROM {Database Name}.{Schema Name}.{Table_name} (ensure all column names are enclosed in double quotations)
Follow the answer format like: We identified weather stations within a 20-mile radius of Chappaqua, New York (Latitude: 41.197, Longitude: -73.764) by selecting stations from the `STATIONS` table where the distance between the station's location and Chappaqua is less than or equal to 32,186.8 meters (which is 20 miles). For each of these stations, we counted the number of valid temperature observations (where `temp` is not NULL) recorded from 2011 to 2020 in the GSOD tables (`GSOD2011` to `GSOD2020`). The results are provided below:

```csv
station_id,station_name,number_of_temperature_observations
station1_id:str,station1_name:str,observations1:int
station2_id:str,station2_name:str,observations2:int
...
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'NEW_YORK_NOAA': {'NEW_YORK': ['CITIBIKE_STATIONS', 'CITIBIKE_TRIPS', 'NYPD_MV_COLLISIONS', 'TLC_FHV_TRIPS_2015', 'TLC_FHV_TRIPS_2016', 'TLC_GREEN_TRIPS_2013', 'TLC_GREEN_TRIPS_2014', 'TLC_GREEN_TRIPS_2015', 'TLC_GREEN_TRIPS_2016', 'TLC_YELLOW_TRIPS_2009', 'TLC_YELLOW_TRIPS_2010', 'TLC_YELLOW_TRIPS_2011', 'TLC_YELLOW_TRIPS_2012', 'TLC_YELLOW_TRIPS_2013', 'TLC_YELLOW_TRIPS_2014', 'TLC_YELLOW_TRIPS_2015', 'TLC_YELLOW_TRIPS_2016', 'TREE_CENSUS_1995', 'TREE_CENSUS_2005', 'TREE_CENSUS_2015', 'TREE_SPECIES', '_311_SERVICE_REQUESTS'], 'NOAA_GSOD': ['GSOD1929', 'GSOD1930', 'GSOD1931', 'GSOD1932', 'GSOD1933', 'GSOD1934', 'GSOD1935', 'GSOD1936', 'GSOD1937', 'GSOD1938', 'GSOD1939', 'GSOD1940', 'GSOD1941', 'GSOD1942', 'GSOD1943', 'GSOD1944', 'GSOD1945', 'GSOD1946', 'GSOD1947', 'GSOD1948', 'GSOD1949', 'GSOD1950', 'GSOD1951', 'GSOD1952', 'GSOD1953', 'GSOD1954', 'GSOD1955', 'GSOD1956', 'GSOD1957', 'GSOD1958', 'GSOD1959', 'GSOD1960', 'GSOD1961', 'GSOD1962', 'GSOD1963', 'GSOD1964', 'GSOD1965', 'GSOD1966', 'GSOD1967', 'GSOD1968', 'GSOD1969', 'GSOD1970', 'GSOD1971', 'GSOD1972', 'GSOD1973', 'GSOD1974', 'GSOD1975', 'GSOD1976', 'GSOD1977', 'GSOD1978', 'GSOD1979', 'GSOD1980', 'GSOD1981', 'GSOD1982', 'GSOD1983', 'GSOD1984', 'GSOD1985', 'GSOD1986', 'GSOD1987', 'GSOD1988', 'GSOD1989', 'GSOD1990', 'GSOD1991', 'GSOD1992', 'GSOD1993', 'GSOD1994', 'GSOD1995', 'GSOD1996', 'GSOD1997', 'GSOD1998', 'GSOD1999', 'GSOD2000', 'GSOD2001', 'GSOD2002', 'GSOD2003', 'GSOD2004', 'GSOD2005', 'GSOD2006', 'GSOD2007', 'GSOD2008', 'GSOD2009', 'GSOD2010', 'GSOD2011', 'GSOD2012', 'GSOD2013', 'GSOD2014', 'GSOD2015', 'GSOD2016', 'GSOD2017', 'GSOD2018', 'GSOD2019', 'GSOD2020', 'GSOD2021', 'GSOD2022', 'GSOD2023', 'GSOD2024', 'STATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
Keep all decimals to four decimal places.

2025-01-18 09:13:28 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 09:13:28 - root - INFO - ```sql
WITH nearby_stations AS (
    SELECT 
        LPAD(TRIM("usaf"), 6, '0') AS station_id, 
        "name"
    FROM 
        "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    WHERE 
        "lat" IS NOT NULL 
        AND "lon" IS NOT NULL 
        AND "usaf" IS NOT NULL 
        AND TRIM("usaf") != ''
        AND ST_DWITHIN(
            ST_MAKEPOINT("lon", "lat")::GEOGRAPHY,
            ST_MAKEPOINT(-73.764, 41.197)::GEOGRAPHY,
            32186.8
        )
)

SELECT
    ns.station_id,
    ns."name" AS station_name,
    COUNT(*) AS number_of_temperature_observations
FROM
    nearby_stations ns
JOIN (
    SELECT 
        LPAD(TRIM("stn"), 6, '0') AS station_id
    FROM (
        SELECT "stn", "temp" 
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
    ) all_obs
    WHERE 
        "temp" IS NOT NULL 
        AND "stn" IS NOT NULL 
        AND TRIM("stn") != ''
) g
ON ns.station_id = g.station_id
GROUP BY
    ns.station_id, ns."name";
```
2025-01-18 09:13:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:13:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:13:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:13:30 - snowflake.connector.connection - INFO - closed
2025-01-18 09:13:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:13:30 - root - INFO - itercount: 1
2025-01-18 09:13:30 - root - INFO - 001007 (22023): 01b9ca69-0004-7b17-0001-11c300ee262e: SQL compilation error:
invalid type [CAST(ST_MAKEPOINT(STATIONS."lon", STATIONS."lat") AS GEOGRAPHY)] for parameter 'TO_GEOGRAPHY'
2025-01-18 09:13:30 - root - INFO - Input sql:
WITH nearby_stations AS (
    SELECT 
        LPAD(TRIM("usaf"), 6, '0') AS station_id, 
        "name"
    FROM 
        "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    WHERE 
        "lat" IS NOT NULL 
        AND "lon" IS NOT NULL 
        AND "usaf" IS NOT NULL 
        AND TRIM("usaf") != ''
        AND ST_DWITHIN(
            ST_MAKEPOINT("lon", "lat")::GEOGRAPHY,
            ST_MAKEPOINT(-73.764, 41.197)::GEOGRAPHY,
            32186.8
        )
)

SELECT
    ns.station_id,
    ns."name" AS station_name,
    COUNT(*) AS number_of_temperature_observations
FROM
    nearby_stations ns
JOIN (
    SELECT 
        LPAD(TRIM("stn"), 6, '0') AS station_id
    FROM (
        SELECT "stn", "temp" 
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
    ) all_obs
    WHERE 
        "temp" IS NOT NULL 
        AND "stn" IS NOT NULL 
        AND TRIM("stn") != ''
) g
ON ns.station_id = g.station_id
GROUP BY
    ns.station_id, ns."name";
The error information is:
001007 (22023): 01b9ca69-0004-7b17-0001-11c300ee262e: SQL compilation error:
invalid type [CAST(ST_MAKEPOINT(STATIONS."lon", STATIONS."lat") AS GEOGRAPHY)] for parameter 'TO_GEOGRAPHY'
Please correct it and output only 1 complete SQL query.
2025-01-18 09:14:03 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 09:14:03 - root - INFO - ```sql
WITH nearby_stations AS (
    SELECT 
        LPAD(TRIM("usaf"), 6, '0') AS station_id, 
        "name"
    FROM 
        "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    WHERE 
        "lat" IS NOT NULL 
        AND "lon" IS NOT NULL 
        AND "usaf" IS NOT NULL 
        AND TRIM("usaf") != ''
        AND ST_DWITHIN(
            ST_POINT("lon", "lat"),
            ST_POINT(-73.764, 41.197),
            32186.8
        )
)

SELECT
    ns.station_id,
    ns."name" AS station_name,
    COUNT(*) AS number_of_temperature_observations
FROM
    nearby_stations ns
JOIN (
    SELECT 
        LPAD(TRIM("stn"), 6, '0') AS station_id
    FROM (
        SELECT "stn", "temp" 
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
    ) all_obs
    WHERE 
        "temp" IS NOT NULL 
        AND "stn" IS NOT NULL 
        AND TRIM("stn") != ''
    ) g
ON ns.station_id = g.station_id
GROUP BY
    ns.station_id, ns."name";
```
2025-01-18 09:14:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:14:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:14:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:14:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-18 09:14:05 - snowflake.connector.connection - INFO - closed
2025-01-18 09:14:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:14:06 - root - INFO - itercount: 2
2025-01-18 09:14:06 - root - INFO - 0
2025-01-18 09:14:06 - root - INFO - results: 
STATION_ID,STATION_NAME,NUMBER_OF_TEMPERATURE_OBSERVATIONS
999999,WHITE PLAINS WESTCHESTER CO A,1123769
725086,DANBURY MUNI ARPT,3649
999999,BEAR MOUNTAIN WB,1123769
997186,WESTERN LONG ISLAND SOUND,1532
725037,WESTCHESTER COUNTY AIRPORT,3653
725086,DANBURY MUNICIPAL AIRPORT,3649


2025-01-18 09:14:06 - root - INFO - Please check the answer again by reviewing Can you provide weather stations within a 20-mile radius of Chappaqua, New York (Latitude: 41.197, Longitude: -73.764), and tell me the number of valid temperature observations they have recorded from 2011 to 2020?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: We identified weather stations within a 20-mile radius of Chappaqua, New York (Latitude: 41.197, Longitude: -73.764) by selecting stations from the `STATIONS` table where the distance between the station's location and Chappaqua is less than or equal to 32,186.8 meters (which is 20 miles). For each of these stations, we counted the number of valid temperature observations (where `temp` is not NULL) recorded from 2011 to 2020 in the GSOD tables (`GSOD2011` to `GSOD2020`). The results are provided below:

```csv
station_id,station_name,number_of_temperature_observations
station1_id:str,station1_name:str,observations1:int
station2_id:str,station2_name:str,observations2:int
...
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
STATION_ID,STATION_NAME,NUMBER_OF_TEMPERATURE_OBSERVATIONS
999999,WHITE PLAINS WESTCHESTER CO A,1123769
725086,DANBURY MUNI ARPT,3649
999999,BEAR MOUNTAIN WB,1123769
997186,WESTERN LONG ISLAND SOUND,1532
725037,WESTCHESTER COUNTY AIRPORT,3653
725086,DANBURY MUNICIPAL AIRPORT,3649
Current sql:
WITH nearby_stations AS (
    SELECT 
        LPAD(TRIM("usaf"), 6, '0') AS station_id, 
        "name"
    FROM 
        "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    WHERE 
        "lat" IS NOT NULL 
        AND "lon" IS NOT NULL 
        AND "usaf" IS NOT NULL 
        AND TRIM("usaf") != ''
        AND ST_DWITHIN(
            ST_POINT("lon", "lat"),
            ST_POINT(-73.764, 41.197),
            32186.8
        )
)

SELECT
    ns.station_id,
    ns."name" AS station_name,
    COUNT(*) AS number_of_temperature_observations
FROM
    nearby_stations ns
JOIN (
    SELECT 
        LPAD(TRIM("stn"), 6, '0') AS station_id
    FROM (
        SELECT "stn", "temp" 
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
    ) all_obs
    WHERE 
        "temp" IS NOT NULL 
        AND "stn" IS NOT NULL 
        AND TRIM("stn") != ''
    ) g
ON ns.station_id = g.station_id
GROUP BY
    ns.station_id, ns."name";
2025-01-18 09:14:52 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 09:14:52 - root - INFO - We identified weather stations within a 20-mile radius of Chappaqua, New York (Latitude: 41.1970, Longitude: -73.7640) by selecting stations from the `STATIONS` table where the distance between the station's location and Chappaqua is less than or equal to 32,186.8 meters (which is 20 miles). For each of these stations, we counted the number of valid temperature observations (where `temp` is not NULL) recorded from 2011 to 2020 in the GSOD tables (`GSOD2011` to `GSOD2020`). The SQL query to retrieve these results is provided below:

```sql
WITH nearby_stations AS (
    SELECT 
        LPAD(TRIM("usaf"), 6, '0') AS station_id, 
        "name"
    FROM 
        "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
    WHERE 
        "lat" IS NOT NULL 
        AND "lon" IS NOT NULL 
        AND "usaf" IS NOT NULL 
        AND TRIM("usaf") != ''
        AND ST_DWITHIN(
            ST_POINT("lon", "lat"),
            ST_POINT(-73.7640, 41.1970),
            32186.8
        )
)

SELECT
    ns.station_id,
    ns."name" AS station_name,
    COUNT(*) AS number_of_temperature_observations
FROM
    nearby_stations ns
JOIN (
    SELECT 
        LPAD(TRIM("stn"), 6, '0') AS station_id
    FROM (
        SELECT "stn", "temp" 
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
        UNION ALL
        SELECT "stn", "temp"
        FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
    ) all_obs
    WHERE 
        "temp" IS NOT NULL 
        AND "stn" IS NOT NULL 
        AND TRIM("stn") != ''
) g
ON ns.station_id = g.station_id
GROUP BY
    ns.station_id, ns."name";
```
2025-01-18 09:14:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 09:14:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 09:14:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 09:14:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-18 09:14:54 - snowflake.connector.connection - INFO - closed
2025-01-18 09:14:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 09:14:55 - root - INFO - itercount: 3
2025-01-18 09:14:55 - root - INFO - 0
2025-01-18 09:14:55 - root - INFO - Total iteration counts: 3
