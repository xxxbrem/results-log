2025-01-23 01:58:58 - openai._base_client - INFO - Retrying request to /chat/completions in 0.485098 seconds
2025-01-23 02:00:41 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 02:00:43 - root - INFO - SQL:
SELECT * FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` LIMIT 100;
Results:
country_code,country_name,year,sex,population,age
NR,Nauru,2001,Male,152,0
NR,Nauru,2001,Male,126,1
NR,Nauru,2001,Male,132,2
NR,Nauru,2001,Male,140,3
NR,Nauru,2001,Male,153,4
NR,Nauru,2001,Male,134,5
NR,Nauru,2001,Male,123,6
NR,Nauru,2001,Male,129,7
NR,Nauru,2001,Male,119,8
NR,Nauru,2001,Male,133,9
NR,Nauru,2001,Male,138,10
NR,Nauru,2001,Male,136,11
NR,Nauru,2001,Male,132,12
NR,Nauru,2001,Male,129,13
NR,Nauru,2001,Male,124,14
NR,Nauru,2001,Male,117,15
NR,Nauru,2001,Male,109,16
NR,Nauru,2001,Male,111,17
NR,Nauru,2001,Male,103,18
NR,Nauru,2001,Male,100,19
NR,Nauru,2001,Male,97,20
NR,Nauru,2001,Male,91,21
NR,Nauru,2001,Male,89,22
NR,Nauru,2001,Male,85,23
NR,Nauru,2001,Male,83,24
NR,Nauru,2001,Male,74,25
NR,Nauru,2001,Male,72,26
NR,Nauru,2001,Male,68,27
NR,Nauru,2001,Male,72,28
NR,Nauru,2001,Male,74,29
NR,Nauru,2001,Male,75,30
NR,Nauru,2001,Male,77,31
NR,Nauru,2001,Male,72,32
NR,Nauru,2001,Male,78,33
NR,Nauru,2001,Male,76,34
NR,Nauru,2001,Male,78,35
NR,Nauru,2001,Male,78,36
NR,Nauru,2001,Male,73,37
NR,Nauru,2001,Male,69,38
NR,Nauru,2001,Male,66,39
NR,Nauru,2001,Male,65,40
NR,Nauru,2001,Male,59,41
NR,Nauru,2001,Male,58,42
NR,Nauru,2001,Male,56,43
NR,Nauru,2001,Male,53,44
NR,Nauru,2001,Male,53,45
NR,Nauru,2001,Male,52,46
NR,Nauru,2001,Male,49,47

2025-01-23 02:00:44 - root - INFO - SQL:
SELECT DISTINCT `year` FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` ORDER BY `year`;
Results:
year
1950
1951
1952
1953
1954
1955
1956
1957
1958
1959
1960
1961
1962
1963
1964
1965
1966
1967
1968
1969
1970
1971
1972
1973
1974
1975
1976
1977
1978
1979
1980
1981
1982
1983
1984
1985
1986
1987
1988
1989
1990
1991
1992
1993
1994
1995
1996
1997
1998
1999
2000
2001
2002
2003
2004
2005
2006
2007
2008
2009
2010
2011
2012
2013
2014
2015
2016
2017
2018
2019
2020
2021
2022
2023
2024
2025
2026
2027
2028
2029
2030
2031
2032
2033
2034
2035
2036
2037
2038
2039
2040
2041
2042
2043
2044
2045
2046
2047
2048
2049
2050

2025-01-23 02:00:46 - root - INFO - SQL:
SELECT DISTINCT `country_name` FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` LIMIT 100;
Results:
country_name
Nauru
Suriname
New Zealand
South Sudan
Peru
Pakistan
Poland
Panama
Portugal
Papua New Guinea
Palau
Guinea-Bissau
Qatar
Serbia
Marshall Islands
Saint Martin
Romania
Philippines
Puerto Rico
Russia
Rwanda
Saudi Arabia
Saint Pierre and Miquelon
Saint Kitts and Nevis
Seychelles
South Africa
Senegal
"Saint Helena, Ascension, and Tristan da Cunha"
Slovenia
San Marino
Singapore
Spain
Saint Lucia
Sudan
Sweden
Syria
Switzerland
Saint Barthelemy
Trinidad and Tobago
Thailand
Tajikistan
Turks and Caicos Islands
Tonga
Georgia
Gibraltar
Grenada
Guernsey
Greenland
Germany
Guam
Greece
Guatemala
Guyana
Gaza Strip
Hong Kong
Croatia
Hungary
Iceland
Indonesia
Isle of Man
India
Iran
Israel
Italy
Iraq
Japan
Jersey
Jamaica
Jordan
Kenya
Kyrgyzstan
"Korea, North"
Kiribati
"Korea, South"
Kuwait
Kosovo
Kazakhstan
Laos
Latvia
Lithuania
Slovakia
Liechtenstein
Lesotho
Luxembourg
Libya
Togo
Sao Tome and Principe
Tunisia
Timor-Leste
Turkey
Tuvalu
Taiwan
Turkmenistan
Tanzania
Curacao
United Kingdom
Ukraine
United States
Burkina Faso
Uruguay

2025-01-23 02:01:12 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 02:01:12 - root - INFO - ```sql
SELECT `country_name`, 
       (SUM(CASE WHEN `age` < 25 THEN `population` ELSE 0 END) / SUM(`population`)) * 100 AS `percentage_under_25` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017
GROUP BY `country_name` 
ORDER BY `percentage_under_25` DESC 
LIMIT 1;
```
2025-01-23 02:02:50 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 02:02:50 - root - INFO - SQL:
SELECT `country_name`, 
       (SUM(CASE WHEN `age` < 25 THEN `population` ELSE 0 END) / SUM(`population`)) * 100 AS `percentage_under_25` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017
GROUP BY `country_name` 
ORDER BY `percentage_under_25` DESC 
LIMIT 1;
Results:
country_name,percentage_under_25
Uganda,69.1457886473697

2025-01-23 02:02:52 - root - INFO - SQL:
SELECT `country_name`, SUM(`population`) AS `total_population` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 
GROUP BY `country_name` 
LIMIT 100
Results:
country_name,total_population
Nauru,9642
Suriname,591919
New Zealand,4510327
South Sudan,10507520
Peru,31036656
Pakistan,204924861
Poland,38476269
Panama,3753142
Portugal,10383790
Papua New Guinea,6909701
Palau,21431
Guinea-Bissau,1788610
Qatar,2314307
Serbia,7111024
Marshall Islands,74539
Saint Martin,32125
Romania,21529967
Philippines,104256076
Puerto Rico,3351827
Russia,142257519
Rwanda,11901484
Saudi Arabia,32548604
Saint Pierre and Miquelon,5533
Saint Kitts and Nevis,52715
Seychelles,93920
South Africa,54841552
Senegal,14668522
"Saint Helena, Ascension, and Tristan da Cunha",7828
Slovenia,2101416
San Marino,33537
Singapore,5888926
Spain,48958159
Saint Lucia,164994
Sudan,41824518
Sweden,9960487
Syria,18028549
Switzerland,8236303
Saint Barthelemy,7184
Trinidad and Tobago,1218208
Thailand,68414135
Tajikistan,8468555
Turks and Caicos Islands,52570
Gibraltar,29396
Grenada,111724
Guernsey,66502
Greenland,57713
Germany,80594017
Guam,167358
Greece,10768477
Guatemala,16296181
Guyana,737718
Gaza Strip,1795183
Hong Kong,7191503
Croatia,4292095
Hungary,9850845
Iceland,339747
Indonesia,260580739
Isle of Man,88815
India,1281935911
Iran,82021564
Israel,8299706
Italy,62137802
Iraq,39192111
Japan,126451398
Jersey,98840
Jamaica,2813340
Jordan,10248069
Kenya,47615739
Kyrgyzstan,5789122
"Korea, North",25248140
Kiribati,108145
"Korea, South",51181299
Kuwait,2875422
Kosovo,1895250
Kazakhstan,18556698
Laos,7126706
Latvia,1944643
Lithuania,2823859
Slovakia,5445829
Liechtenstein,38244
Lesotho,1958042
Luxembourg,594130
Libya,6653210
Tonga,106479
Togo,7965055
Sao Tome and Principe,201025
Tunisia,11403800

2025-01-23 02:02:53 - root - INFO - SQL:
SELECT `country_name`, SUM(`population`) AS `population_under_25` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 AND `age` < 25 
GROUP BY `country_name` 
LIMIT 100
Results:
country_name,population_under_25
Nauru,4591
Suriname,248920
New Zealand,1490152
South Sudan,6717849
Peru,13848747
Pakistan,107589438
Poland,9793667
Panama,1628317
Portugal,2607964
Papua New Guinea,3685959
Palau,7795
Guinea-Bissau,1142376
Qatar,578187
Serbia,1831982
Marshall Islands,39418
Saint Martin,11749
Romania,5371246
Philippines,54794408
Puerto Rico,988208
Russia,37806888
Rwanda,7226072
Saudi Arabia,13656525
Saint Pierre and Miquelon,1347
Saint Kitts and Nevis,18377
Seychelles,31101
South Africa,25160724
Senegal,9071879
"Saint Helena, Ascension, and Tristan da Cunha",2204
Slovenia,502472
San Marino,8969
Singapore,1730345
Spain,12221093
Saint Lucia,58395
Sudan,26527909
Sweden,2862833
Syria,9223941
Switzerland,2144920
Saint Barthelemy,1699
Trinidad and Tobago,379734
Thailand,21278754
Tajikistan,4313782
Turks and Caicos Islands,18782
Gibraltar,10160
Grenada,43598
Guernsey,17049
Greenland,21116
Germany,18464905
Guam,73914
Greece,2531224
Guatemala,9031561
Guyana,352509
Gaza Strip,1185377
Hong Kong,1626759
Croatia,1092367
Hungary,2528814
Iceland,115154
Indonesia,109476701
Isle of Man,24618
India,579949092
Iran,31897846
Israel,3572500
Italy,14486265
Iraq,23008289
Japan,28432645
Jersey,29792
Jamaica,1264359
Jordan,5610991
Kenya,28175486
Kyrgyzstan,2726431
"Korea, North",9184995
Kiribati,54879
"Korea, South",13242524
Kuwait,1153514
Kosovo,800354
Kazakhstan,7415630
Laos,3843766
Latvia,478314
Lithuania,737133
Slovakia,1418283
Liechtenstein,10293
Lesotho,1009495
Luxembourg,171986
Libya,2855932

2025-01-23 02:02:55 - root - INFO - SQL:
SELECT `country_name`, 
       SUM(CASE WHEN `age` < 25 THEN `population` ELSE 0 END) AS `population_under_25`, 
       SUM(`population`) AS `total_population` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 
GROUP BY `country_name` 
LIMIT 100
Results:
country_name,population_under_25,total_population
Nauru,4591,9642
Suriname,248920,591919
New Zealand,1490152,4510327
South Sudan,6717849,10507520
Peru,13848747,31036656
Pakistan,107589438,204924861
Poland,9793667,38476269
Panama,1628317,3753142
Portugal,2607964,10383790
Papua New Guinea,3685959,6909701
Palau,7795,21431
Guinea-Bissau,1142376,1788610
Qatar,578187,2314307
Serbia,1831982,7111024
Marshall Islands,39418,74539
Saint Martin,11749,32125
Romania,5371246,21529967
Philippines,54794408,104256076
Puerto Rico,988208,3351827
Russia,37806888,142257519
Rwanda,7226072,11901484
Saudi Arabia,13656525,32548604
Saint Pierre and Miquelon,1347,5533
Saint Kitts and Nevis,18377,52715
Seychelles,31101,93920
South Africa,25160724,54841552
Senegal,9071879,14668522
"Saint Helena, Ascension, and Tristan da Cunha",2204,7828
Slovenia,502472,2101416
San Marino,8969,33537
Singapore,1730345,5888926
Spain,12221093,48958159
Saint Lucia,58395,164994
Sudan,26527909,41824518
Sweden,2862833,9960487
Syria,9223941,18028549
Switzerland,2144920,8236303
Saint Barthelemy,1699,7184
Trinidad and Tobago,379734,1218208
Thailand,21278754,68414135
Tajikistan,4313782,8468555
Turks and Caicos Islands,18782,52570
Gibraltar,10160,29396
Grenada,43598,111724
Guernsey,17049,66502
Greenland,21116,57713
Germany,18464905,80594017
Guam,73914,167358
Greece,2531224,10768477
Guatemala,9031561,16296181
Guyana,352509,737718
Gaza Strip,1185377,1795183
Hong Kong,1626759,7191503
Croatia,1092367,4292095
Hungary,2528814,9850845
Iceland,115154,339747

2025-01-23 02:02:57 - root - INFO - SQL:
SELECT `country_name`, 
       (SUM(CASE WHEN `age` < 25 THEN `population` ELSE 0 END) / SUM(`population`)) * 100 AS `percentage_under_25` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 
GROUP BY `country_name` 
ORDER BY `percentage_under_25` DESC 
LIMIT 100
Results:
country_name,percentage_under_25
Uganda,69.1457886473697
Niger,68.11082202531688
Chad,67.42454630438175
Mali,67.01576634818254
Malawi,66.88810926886434
Angola,66.36923852602806
Mozambique,66.28719005169998
Gaza Strip,66.03098402781221
Zambia,66.02077385424494
Burkina Faso,64.73825780484853
Burundi,64.71763243239849
South Sudan,63.93372556036058
Guinea-Bissau,63.869485242730384
Tanzania,63.601251766999034
Ethiopia,63.57544592777485
Sudan,63.42669388323854
Liberia,63.38291084642189
Congo (Kinshasa),63.20058770856599
Afghanistan,63.1420112480623
Benin,63.08832341906574
Sao Tome and Principe,62.53550553413755
Nigeria,62.36660870315772
Somalia,62.18200505358076
Cameroon,61.94653826172834
Senegal,61.845896948581455
Timor-Leste,61.23600117086044
Yemen,61.03616068707341
Rwanda,60.71572250989876
Guinea,60.67921208263418
Sierra Leone,60.38324278235558
Madagascar,60.200950253333176
Central African Republic,60.023754168357
Gabon,60.02307340244353
Cote d'Ivoire,59.8807567443196
Eritrea,59.74521698979155
Equatorial Guinea,59.52916267321721
Togo,59.49131550252949
Zimbabwe,59.36693322546969
Kenya,59.17263197364216
Comoros,58.88340263340264
Congo (Brazzaville),58.7687504768225
Iraq,58.70642946484816
Mauritania,58.36790099215898
"Gambia, The",57.91032596376166
West Bank,57.86692082041003
Namibia,57.31718703466705
Western Sahara,56.766398177878926
Ghana,56.640676534233336
Vanuatu,55.52836846832193
Guatemala,55.42133460594234
Jordan,54.751690294044664
Solomon Islands,54.576184292003624
Eswatini,54.476148078073486
Haiti,54.05596506114468
Honduras,53.94667244033212
Laos,53.93467893862886
Tonga,53.52041247569943
Papua New Guinea,53.34469610190079
Marshall Islands,52.88238371859026
Belize,52.82702114854663
Philippines,52.557520004877226
Pakistan,52.50189629261235
Djibouti,52.46230354329935
Egypt,52.23273089975757
Nepal,51.93305798671991
Lesotho,51.556350680935346
Bolivia,51.31464287785658
Samoa,51.16986827113359
Syria,51.162969354882634
Tajikistan,50.938820141098454
Botswana,50.86095812914417

2025-01-23 02:02:58 - root - INFO - SQL:
SELECT `country_name`, `age`, `population` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 AND `age` BETWEEN 20 AND 24 
ORDER BY `country_name`, `age` 
LIMIT 100
Results:
country_name,age,population
Afghanistan,20,389601
Afghanistan,20,375728
Afghanistan,21,362431
Afghanistan,21,375946
Afghanistan,22,348060
Afghanistan,22,361190
Afghanistan,23,345085
Afghanistan,23,332452
Afghanistan,24,312908
Afghanistan,24,324946
Albania,20,28409
Albania,20,26804
Albania,21,30641
Albania,21,28578
Albania,22,28736
Albania,22,31089
Albania,23,29044
Albania,23,27334
Albania,24,27712
Albania,24,28945
Algeria,20,313558
Algeria,20,299453
Algeria,21,326618
Algeria,21,311608
Algeria,22,355553
Algeria,22,339064
Algeria,23,351966
Algeria,23,369467
Algeria,24,356005
Algeria,24,374121
American Samoa,20,445
American Samoa,20,438
American Samoa,21,476
American Samoa,21,466
American Samoa,22,500
American Samoa,22,495
American Samoa,23,514
American Samoa,23,498
American Samoa,24,501
American Samoa,24,488
Andorra,20,345
Andorra,20,414
Andorra,21,394
Andorra,21,347
Andorra,22,347
Andorra,22,396
Andorra,23,352
Andorra,23,393
Andorra,24,393
Andorra,24,411
Angola,20,266470
Angola,20,249721
Angola,21,240137
Angola,21,258273
Angola,22,251119
Angola,22,231680
Angola,23,223150
Angola,23,243694
Angola,24,236935
Angola,24,215539
Anguilla,20,115
Anguilla,20,114
Anguilla,21,112
Anguilla,21,117
Anguilla,22,111
Anguilla,22,118
Anguilla,23,115
Anguilla,23,112
Anguilla,24,111
Anguilla,24,104
Antigua and Barbuda,20,850
Antigua and Barbuda,20,854
Antigua and Barbuda,21,826
Antigua and Barbuda,21,811
Antigua and Barbuda,22,761
Antigua and Barbuda,22,774
Antigua and Barbuda,23,720
Antigua and Barbuda,23,746
Antigua and Barbuda,24,717
Antigua and Barbuda,24,742
Argentina,20,346527
Argentina,20,332659

2025-01-23 02:03:00 - root - INFO - SQL:
SELECT `age`, SUM(`population`) AS `total_population_by_age` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 
GROUP BY `age` 
ORDER BY `age` 
LIMIT 100
Results:
age,total_population_by_age
0,132682146
1,131127352
2,130131725
3,129137233
4,128326357
5,127506146
6,126607406
7,125886557
8,125305498
9,124699003
10,123508718
11,122238836
12,121240490
13,120397487
14,119483671
15,118943649
16,118655789
17,118311926
18,118132670
19,118152025
20,118064876
21,118319066
22,118494686
23,118065588
24,117530610
25,117777540
26,118306562
27,125172859
28,120750817
29,118234759
30,118512044
31,113408750
32,110154736
33,109056764
34,108229169
35,110283524
36,102984129
37,102352848
38,100389448
39,98136854
40,97147218
41,96805508
42,96805165
43,97150541
44,96976015
45,95989304
46,96261355
47,94558160
48,93731497
49,89345060
50,85947677
51,86336282
52,84822950
53,84131796
54,84138642
55,71965250
56,66596254
57,67512083
58,65433558
59,67706141
60,64941557
61,62187109
62,61830185
63,58405873
64,55377874
65,52979137
66,49055197
67,48064498
68,44097339
69,41632447
70,39206205
71,34401714
72,32040334
73,30456373
74,28830945
75,27729302
76,26226350
77,24398620
78,22417674
79,20941603
80,19000004
81,17153388
82,15200611
83,13435054
84,11993324
85,10422317
86,9152402
87,7930471
88,6574806
89,5498046
90,4424164
91,3550609
92,2825111
93,2159463
94,1626128
95,1221194
96,904459
97,628441
98,396842
99,264676

2025-01-23 02:03:02 - root - INFO - SQL:
SELECT `country_name`, MAX(`population`) AS `max_population_age` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 
GROUP BY `country_name` 
LIMIT 100
Results:
country_name,max_population_age
Nauru,124
Suriname,5860
New Zealand,33189
South Sudan,181502
Peru,297813
Pakistan,2290115
Poland,341969
Panama,34529
Portugal,89907
Papua New Guinea,81027
Palau,225
Guinea-Bissau,32006
Qatar,65539
Serbia,58207
Marshall Islands,911
Saint Martin,356
Romania,215419
Philippines,1236194
Puerto Rico,24680
Russia,1287767
Rwanda,180404
Saudi Arabia,439859
Saint Pierre and Miquelon,60
Saint Kitts and Nevis,444
Seychelles,1004
South Africa,566756
Senegal,237467
"Saint Helena, Ascension, and Tristan da Cunha",81
Slovenia,17622
San Marino,307
Singapore,69669
Spain,450318
Saint Lucia,1405
Sudan,702979
Sweden,73158
Syria,201495
Switzerland,67925
Saint Barthelemy,72
Trinidad and Tobago,12511
Thailand,569743
Tajikistan,98197
Turks and Caicos Islands,604
Gibraltar,283
Grenada,1082
Guernsey,560
Greenland,607
Germany,725665
Guam,1685
Greece,85292
Guatemala,206407
Guyana,8592
Gaza Strip,28560
Hong Kong,75086
Croatia,33855
Hungary,92085
Iceland,2559
Indonesia,2306498
Isle of Man,711
India,12479419
Iran,909091
Israel,84147
Italy,519884
Iraq,586460
Japan,1107967
Jersey,922
Jamaica,27336
Jordan,133445
Kenya,682187
Kyrgyzstan,64654
"Korea, North",228984
Kiribati,1219
"Korea, South",469642
Kuwait,43957
Kosovo,19680
Kazakhstan,181794
Laos,81971
Latvia,16552
Lithuania,25543
Slovakia,47917
Liechtenstein,333
Lesotho,23277
Luxembourg,4703
Libya,69428
Tonga,1269
Togo,128713
Sao Tome and Principe,3164
Tunisia,113254

2025-01-23 02:03:03 - root - INFO - SQL:
SELECT `country_name`, `age`, `population` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 AND `country_name` = 'Niger' 
ORDER BY `age` 
LIMIT 100
Results:
country_name,age,population
Niger,0,402795
Niger,0,393277
Niger,1,371849
Niger,1,379195
Niger,2,364876
Niger,2,357854
Niger,3,346218
Niger,3,353096
Niger,4,342661
Niger,4,335875
Niger,5,333161
Niger,5,326517
Niger,6,317928
Niger,6,324342
Niger,7,309960
Niger,7,316150
Niger,8,302290
Niger,8,308270
Niger,9,300534
Niger,9,294710
Niger,10,291978
Niger,10,286720
Niger,11,280272
Niger,11,276129
Niger,12,263519
Niger,12,266473
Niger,13,253314
Niger,13,251532
Niger,14,240059
Niger,14,240689
Niger,15,228551
Niger,15,229057
Niger,16,218504
Niger,16,216888
Niger,17,205734
Niger,17,208390
Niger,18,195007
Niger,18,198649
Niger,19,184759
Niger,19,189273
Niger,20,174922
Niger,20,180240
Niger,21,171488
Niger,21,165534
Niger,22,156442
Niger,22,162934
Niger,23,147786
Niger,23,154649
Niger,24,140066
Niger,24,147046
Niger,25,133115
Niger,25,140036
Niger,26,127809
Niger,26,134542
Niger,27,123146
Niger,27,129562
Niger,28,118716
Niger,28,124656
Niger,29,114639
Niger,29,120004
Niger,30,115356
Niger,30,110685
Niger,31,111019
Niger,31,106984
Niger,32,103614
Niger,32,106948
Niger,33,100422
Niger,33,103125
Niger,34,97324
Niger,34,99451
Niger,35,95808
Niger,35,94381
Niger,36,92268
Niger,36,91388
Niger,37,88685
Niger,37,88396
Niger,38,85224
Niger,38,85505
Niger,39,82603
Niger,39,83365
Niger,40,76688
Niger,40,79390
Niger,41,73311
Niger,41,76590
Niger,42,70574
Niger,42,73916
Niger,43,67566

2025-01-23 02:03:05 - root - INFO - SQL:
SELECT `country_name`, SUM(`population`) AS `population_over_60` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 AND `age` >= 60 
GROUP BY `country_name` 
LIMIT 100
Results:
country_name,population_over_60
Nauru,524
Suriname,53968
New Zealand,934744
South Sudan,411591
Peru,3388505
Pakistan,14109177
Poland,9267754
Panama,446024
Portugal,2700896
Papua New Guinea,461709
Palau,2616
Guinea-Bissau,82738
Qatar,51381
Serbia,1842333
Marshall Islands,5001
Saint Martin,3866
Romania,4938536
Philippines,7435885
Puerto Rico,865335
Russia,29799445
Rwanda,498207
Saudi Arabia,1721064
Saint Pierre and Miquelon,1497
Saint Kitts and Nevis,7260
Seychelles,10872
South Africa,4768609
Senegal,686714
"Saint Helena, Ascension, and Tristan da Cunha",1668
Slovenia,561416
San Marino,8493
Singapore,849115
Spain,11514425
Saint Lucia,26616
Sudan,1933966
Sweden,2581201
Syria,1177644
Switzerland,1968553
Saint Barthelemy,1739
Trinidad and Tobago,196201
Thailand,10878304
Tajikistan,467232
Turks and Caicos Islands,3720
Gibraltar,6223
Grenada,16317
Guernsey,16972
Greenland,8393
Germany,23172119
Guam,21639
Greece,2925975
Guatemala,1091704
Guyana,72011
Gaza Strip,71084
Hong Kong,1708139
Croatia,1153098
Hungary,2597086
Iceland,67940
Indonesia,28353378
Isle of Man,23498
India,122148693
Iran,6945873
Israel,1280179
Italy,17138686
Iraq,2116489
Japan,43106028
Jersey,21800
Jamaica,344117
Jordan,538573
Kenya,2235631
Kyrgyzstan,494346
"Korea, North",3444536
Kiribati,7276
"Korea, South",10421946
Kuwait,129199
Kosovo,202781
Kazakhstan,2214072
Laos,444164
Latvia,505907
Lithuania,729801
Slovakia,1205394
Liechtenstein,9172
Lesotho,151782
Luxembourg,121011
Libya,438595
Tonga,9736
Togo,422439

2025-01-23 02:03:06 - root - INFO - SQL:
SELECT `country_name`, AVG(`population`) AS `average_population_per_age` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 
GROUP BY `country_name` 
LIMIT 100
Results:
country_name,average_population_per_age
Nauru,47.73267326732674
Suriname,2930.29207920792
New Zealand,22328.351485148527
South Sudan,52017.42574257426
Peru,153646.81188118825
Pakistan,1014479.5099009905
Poland,190476.57920792067
Panama,18579.910891089112
Portugal,51404.900990099006
Papua New Guinea,34206.44059405939
Palau,106.09405940594057
Guinea-Bissau,8854.504950495042
Qatar,11456.965346534656
Serbia,35203.0891089109
Marshall Islands,369.0049504950494
Saint Martin,159.03465346534645
Romania,106583.9950495049
Philippines,516119.1881188118
Puerto Rico,16593.20297029702
Russia,704245.1435643564
Rwanda,58918.23762376243
Saudi Arabia,161131.702970297
Saint Pierre and Miquelon,27.391089108910883
Saint Kitts and Nevis,260.9653465346536
Seychelles,464.9504950495052
South Africa,271492.83168316836
Senegal,72616.44554455444
"Saint Helena, Ascension, and Tristan da Cunha",38.75247524752477
Slovenia,10403.049504950503
San Marino,166.02475247524742
Singapore,29153.099009900998
Spain,242367.1237623764
Saint Lucia,816.8019801980201
Sudan,207052.06930693059
Sweden,49309.34158415841
Syria,89250.2425742574
Switzerland,40773.77722772276
Saint Barthelemy,35.56435643564355
Trinidad and Tobago,6030.732673267327
Thailand,338683.8366336633
Tajikistan,41923.53960396041
Turks and Caicos Islands,260.24752475247533
Gibraltar,145.52475247524754
Grenada,553.0891089108912
Guernsey,329.21782178217813
Greenland,285.70792079207905
Germany,398980.2821782178
Guam,828.5049504950499
Greece,53309.29207920788
Guatemala,80674.16336633667
Guyana,3652.0693069306926
Gaza Strip,8887.044554455431
Hong Kong,35601.500000000015
Croatia,21247.995049504956
Hungary,48766.55940594059
Iceland,1681.9158415841591
Indonesia,1290003.6584158416
Isle of Man,439.67821782178186
India,6346217.381188119
Iran,406047.34653465316
Israel,41087.65346534654
Italy,307612.8811881188
Iraq,194020.35148514842
Japan,625997.0198019804

2025-01-23 02:03:08 - root - INFO - SQL:
SELECT `country_name`, 
       SUM(CASE WHEN `age` BETWEEN 0 AND 14 THEN `population` ELSE 0 END) AS `population_0_14`, 
       SUM(CASE WHEN `age` BETWEEN 15 AND 24 THEN `population` ELSE 0 END) AS `population_15_24`, 
       SUM(`population`) AS `total_population` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 
GROUP BY `country_name` 
LIMIT 100
Results:
country_name,population_0_14,population_15_24,total_population
Nauru,3028,1563,9642
Suriname,145703,103217,591919
New Zealand,887859,602293,4510327
South Sudan,4562672,2155177,10507520
Peru,8165560,5683187,31036656
Pakistan,64271086,43318352,204924861
Poland,5677276,4116391,38476269
Panama,990691,637626,3753142
Portugal,1478548,1129416,10383790
Papua New Guinea,2309816,1376143,6909701
Palau,4220,3575,21431
Guinea-Bissau,781830,360546,1788610
Qatar,292273,285914,2314307
Serbia,1031239,800743,7111024
Marshall Islands,26004,13414,74539
Saint Martin,8423,3326,32125
Romania,3089840,2281406,21529967
Philippines,34814994,19979414,104256076
Puerto Rico,528729,459479,3351827
Russia,24352817,13454071,142257519
Rwanda,4924487,2301585,11901484
Saudi Arabia,8518244,5138281,32548604
Saint Pierre and Miquelon,846,501,5533
Saint Kitts and Nevis,10710,7667,52715
Seychelles,18667,12434,93920
South Africa,15502666,9658058,54841552
Senegal,6089093,2982786,14668522
"Saint Helena, Ascension, and Tristan da Cunha",1250,954,7828
Slovenia,309287,193185,2101416
San Marino,5105,3864,33537
Singapore,755013,975332,5888926
Spain,7529312,4691781,48958159
Saint Lucia,33033,25362,164994
Sudan,18225538,8302371,41824518
Sweden,1735837,1126996,9960487
Syria,5700887,3523054,18028549
Switzerland,1248503,896417,8236303
Saint Barthelemy,1179,520,7184
Trinidad and Tobago,234999,144735,1218208
Thailand,11583133,9695621,68414135
Tajikistan,2737629,1576153,8468555
Turks and Caicos Islands,11430,7352,52570
Gibraltar,5944,4216,29396
Grenada,26807,16791,111724

2025-01-23 02:03:10 - root - INFO - SQL:
SELECT `country_name`, 
       (SUM(CASE WHEN `age` < 25 THEN `population` ELSE 0 END) / SUM(`population`)) * 100 AS `percentage_under_25` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 
GROUP BY `country_name` 
ORDER BY `percentage_under_25` DESC 
LIMIT 100
Results:
country_name,percentage_under_25
Uganda,69.1457886473697
Niger,68.11082202531688
Chad,67.42454630438175
Mali,67.01576634818254
Malawi,66.88810926886434
Angola,66.36923852602806
Mozambique,66.28719005169998
Gaza Strip,66.03098402781221
Zambia,66.02077385424494
Burkina Faso,64.73825780484853
Burundi,64.71763243239849
South Sudan,63.93372556036058
Guinea-Bissau,63.869485242730384
Tanzania,63.601251766999034
Ethiopia,63.57544592777485
Sudan,63.42669388323854
Liberia,63.38291084642189
Congo (Kinshasa),63.20058770856599
Afghanistan,63.1420112480623
Benin,63.08832341906574
Sao Tome and Principe,62.53550553413755
Nigeria,62.36660870315772
Somalia,62.18200505358076
Cameroon,61.94653826172834
Senegal,61.845896948581455
Timor-Leste,61.23600117086044
Yemen,61.03616068707341
Rwanda,60.71572250989876
Guinea,60.67921208263418
Sierra Leone,60.38324278235558
Madagascar,60.200950253333176
Central African Republic,60.023754168357
Gabon,60.02307340244353
Cote d'Ivoire,59.8807567443196
Eritrea,59.74521698979155
Equatorial Guinea,59.52916267321721
Togo,59.49131550252949
Zimbabwe,59.36693322546969
Kenya,59.17263197364216
Comoros,58.88340263340264
Congo (Brazzaville),58.7687504768225
Iraq,58.70642946484816
Mauritania,58.36790099215898
"Gambia, The",57.91032596376166
West Bank,57.86692082041003
Namibia,57.31718703466705
Western Sahara,56.766398177878926
Ghana,56.640676534233336
Vanuatu,55.52836846832193
Guatemala,55.42133460594234
Jordan,54.751690294044664
Solomon Islands,54.576184292003624
Eswatini,54.476148078073486
Haiti,54.05596506114468
Honduras,53.94667244033212
Laos,53.93467893862886
Tonga,53.52041247569943
Papua New Guinea,53.34469610190079
Marshall Islands,52.88238371859026
Belize,52.82702114854663
Philippines,52.557520004877226
Pakistan,52.50189629261235
Djibouti,52.46230354329935
Egypt,52.23273089975757
Nepal,51.93305798671991
Lesotho,51.556350680935346
Bolivia,51.31464287785658
Samoa,51.16986827113359
Syria,51.162969354882634
Tajikistan,50.938820141098454
Botswana,50.86095812914417

2025-01-23 02:03:11 - root - INFO - SQL:
SELECT `country_name`, `year`, `sex`, `age`, `population` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `country_name` = 'Niger' AND `year` = 2017 
ORDER BY `age` 
LIMIT 100
Results:
country_name,year,sex,age,population
Niger,2017,Male,0,402795
Niger,2017,Female,0,393277
Niger,2017,Female,1,371849
Niger,2017,Male,1,379195
Niger,2017,Male,2,364876
Niger,2017,Female,2,357854
Niger,2017,Female,3,346218
Niger,2017,Male,3,353096
Niger,2017,Male,4,342661
Niger,2017,Female,4,335875
Niger,2017,Male,5,333161
Niger,2017,Female,5,326517
Niger,2017,Female,6,317928
Niger,2017,Male,6,324342
Niger,2017,Female,7,309960
Niger,2017,Male,7,316150
Niger,2017,Female,8,302290
Niger,2017,Male,8,308270
Niger,2017,Male,9,300534
Niger,2017,Female,9,294710
Niger,2017,Male,10,291978
Niger,2017,Female,10,286720
Niger,2017,Male,11,280272
Niger,2017,Female,11,276129
Niger,2017,Female,12,263519
Niger,2017,Male,12,266473
Niger,2017,Male,13,253314
Niger,2017,Female,13,251532
Niger,2017,Female,14,240059
Niger,2017,Male,14,240689
Niger,2017,Male,15,228551
Niger,2017,Female,15,229057
Niger,2017,Female,16,218504
Niger,2017,Male,16,216888
Niger,2017,Male,17,205734
Niger,2017,Female,17,208390
Niger,2017,Male,18,195007
Niger,2017,Female,18,198649
Niger,2017,Male,19,184759
Niger,2017,Female,19,189273
Niger,2017,Male,20,174922
Niger,2017,Female,20,180240
Niger,2017,Female,21,171488
Niger,2017,Male,21,165534
Niger,2017,Male,22,156442
Niger,2017,Female,22,162934
Niger,2017,Male,23,147786
Niger,2017,Female,23,154649
Niger,2017,Male,24,140066
Niger,2017,Female,24,147046
Niger,2017,Male,25,133115
Niger,2017,Female,25,140036
Niger,2017,Male,26,127809
Niger,2017,Female,26,134542
Niger,2017,Male,27,123146
Niger,2017,Female,27,129562
Niger,2017,Male,28,118716
Niger,2017,Female,28,124656

2025-01-23 02:03:13 - root - INFO - SQL:
SELECT DISTINCT `sex` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific`
Results:
sex
Male
Female

2025-01-23 02:03:15 - root - INFO - SQL:
SELECT `country_name`, SUM(`population`) AS `population_between_25_64` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 AND `age` BETWEEN 25 AND 64 
GROUP BY `country_name` 
LIMIT 100
Results:
country_name,population_between_25_64
Nauru,4800
Suriname,307452
New Zealand,2332237
South Sudan,3533915
Peru,14888418
Pakistan,88163412
Poland,22197303
Panama,1810994
Portugal,5706340
Papua New Guinea,2928019
Palau,11904
Guinea-Bissau,592165
Qatar,1712971
Serbia,3968596
Marshall Islands,32126
Saint Martin,17801
Romania,12625016
Philippines,44782453
Puerto Rico,1710536
Russia,84139317
Rwanda,4386608
Saudi Arabia,17856952
Saint Pierre and Miquelon,3061
Saint Kitts and Nevis,29783
Seychelles,55640
South Africa,26563263
Senegal,5159226
"Saint Helena, Ascension, and Tristan da Cunha",4440
Slovenia,1187598
San Marino,18008
Singapore,3591535
Spain,27932340
Saint Lucia,87385
Sudan,14050766
Sweden,5080091
Syria,8045854
Switzerland,4596675
Saint Barthelemy,4282
Trinidad and Tobago,708709
Thailand,39897133
Tajikistan,3873844
Turks and Caicos Islands,31388
Gibraltar,14507
Grenada,56868
Guernsey,36433
Greenland,31264
Germany,44349440
Guam,79060
Greece,5985127
Guatemala,6554799
Guyana,340329
Gaza Strip,564141
Hong Kong,4376223
Croatia,2370999
Hungary,5445915
Iceland,175604
Indonesia,132844754
Isle of Man,46112
India,622057932
Iran,45759082
Israel,3787203
Italy,34273095
Iraq,14827590
Japan,62773685
Jersey,52899
Jamaica,1309577
Jordan,4283405
Kenya,18012182
Kyrgyzstan,2757701
"Korea, North",13648401
Kiribati,48692
"Korea, South",30714023
Kuwait,1648823
Kosovo,956986
Kazakhstan,9722270
Laos,3005458

2025-01-23 02:03:16 - root - INFO - SQL:
SELECT `country_name`, 
       (SUM(CASE WHEN `age` >= 65 THEN `population` ELSE 0 END) / SUM(`population`)) * 100 AS `percentage_over_65` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 
GROUP BY `country_name` 
ORDER BY `percentage_over_65` DESC 
LIMIT 100
Results:
country_name,percentage_over_65
Monaco,32.20753793441018
Japan,27.87242257297938
Germany,22.060783990950593
Italy,21.53027878263219
Finland,21.09609883061505
Greece,20.91406240641086
Isle of Man,20.362551370827
Saint Pierre and Miquelon,20.332550153623714
Sweden,20.255666213911027
Malta,20.10520702790146
Portugal,19.92996776706771
Estonia,19.848655420623995
Lithuania,19.674884617114383
Guernsey,19.578358545607653
Slovenia,19.574705817410738
San Marino,19.56048543399827
Latvia,19.54600407375544
Puerto Rico,19.48438866325738
France,19.478061038240586
Croatia,19.308263214118046
Bulgaria,19.278913921123817
Austria,19.260137715686934
Denmark,19.16840869658749
Hungary,19.045229114862735
Czechia,18.97553688278375
Netherlands,18.725283102402795
Canada,18.62540590977687
Belgium,18.583010206115105
Serbia,18.428372622564627
Switzerland,18.147802478854892
United Kingdom,18.042930176404763
Spain,17.98418523049447
Bermuda,17.978098893655453
"Virgin Islands, U.S.",17.546705448036693
Liechtenstein,17.411881602342852
Poland,16.85532191283931
Faroe Islands,16.75931401537552
Saint Barthelemy,16.74554565701559
Norway,16.709125580704676
Hong Kong,16.52673995964404
Romania,16.412960595805835
Jersey,16.338526912181305
Ukraine,16.30451592789678
Australia,16.141672412590115
Gibraltar,16.087222751394748
Georgia,16.005444215064767
United States,15.614272181418807
Andorra,15.609904086252364
Slovakia,15.429606768776619
New Zealand,15.25250829928739
"Saint Helena, Ascension, and Tristan da Cunha",15.125191619826264
Curacao,15.102106276061155
Luxembourg,15.01742042987225
Belarus,14.952846394778835
Cuba,14.93842469374268
Montenegro,14.66633348964528
Bosnia and Herzegovina,14.42587886823777
Iceland,14.419259036871553
Russia,14.277849172949516
Uruguay,14.247259346909718
"Korea, South",14.115999674021559
Taiwan,13.719888033347019
Aruba,13.589298123697011
Ireland,13.073052594020238
Macedonia,12.9891808053869
Moldova,12.644838795194527
Cayman Islands,12.588764737085265
Cook Islands,12.16361679224973
Cyprus,12.08948638163512
Albania,11.890470661456233
Barbados,11.80798806852389

2025-01-23 02:03:16 - root - INFO - itercount: 0
2025-01-23 02:03:16 - root - INFO - Database Name: bigquery-public-data
Schema Name: census_bureau_international
DDL describes table information.
,0
table_name,midyear_population
ddl,"CREATE TABLE `bigquery-public-data.census_bureau_international.midyear_population`
(
  country_code STRING NOT NULL OPTIONS(description=""Federal Information Processing Standard (FIPS) country/area code""),
  country_name STRING OPTIONS(description=""Country or area name""),
  year INT64 NOT NULL OPTIONS(description=""Year""),
  midyear_population INT64 OPTIONS(description=""Both sexes midyear population"")
)
OPTIONS(
  labels=[(""freebqcovid"", """")]
);"

,1
table_name,birth_death_growth_rates
ddl,"CREATE TABLE `bigquery-public-data.census_bureau_international.birth_death_growth_rates`
(
  country_code STRING NOT NULL OPTIONS(description=""Federal Information Processing Standard (FIPS) country/area code""),
  country_name STRING OPTIONS(description=""Country or area name""),
  year INT64 NOT NULL OPTIONS(description=""Year""),
  crude_birth_rate FLOAT64 OPTIONS(description=""Crude birth rate (births per 1,000 population)""),
  crude_death_rate FLOAT64 OPTIONS(description=""Crude death rate (deaths per 1,000 population)""),
  net_migration FLOAT64 OPTIONS(description=""Net migration rate (net number of migrants per 1,000 population)""),
  rate_natural_increase FLOAT64 OPTIONS(description=""Rate of natural increase (percent)""),
  growth_rate FLOAT64 OPTIONS(description=""Growth rate (percent)"")
)
OPTIONS(
  labels=[(""freebqcovid"", """")]
);"

,2
table_name,country_names_area
ddl,"CREATE TABLE `bigquery-public-data.census_bureau_international.country_names_area`
(
  country_code STRING NOT NULL OPTIONS(description=""Federal Information Processing Standard (FIPS) country/area code""),
  country_name STRING OPTIONS(description=""Country or area name""),
  country_area FLOAT64 OPTIONS(description=""Area in square kilometers"")
)
OPTIONS(
  labels=[(""freebqcovid"", """")]
);"

,3
table_name,midyear_population_agespecific
ddl,"CREATE TABLE `bigquery-public-data.census_bureau_international.midyear_population_agespecific`
(
  country_code STRING NOT NULL OPTIONS(description=""Federal Information Processing Standard (FIPS) country/area code""),
  country_name STRING OPTIONS(description=""Country or area name""),
  year INT64 NOT NULL OPTIONS(description=""Year""),
  sex STRING OPTIONS(description=""Gender""),
  population INT64 OPTIONS(description=""Total count of individuals""),
  age INT64 OPTIONS(description=""Age in years"")
)
OPTIONS(
  labels=[(""freebqcovid"", """")]
);"

,4
table_name,midyear_population_5yr_age_sex
ddl,"CREATE TABLE `bigquery-public-data.census_bureau_international.midyear_population_5yr_age_sex`
(
  country_code STRING NOT NULL OPTIONS(description=""Federal Information Processing Standard (FIPS) country/area code""),
  country_name STRING OPTIONS(description=""Country or area name""),
  year INT64 NOT NULL OPTIONS(description=""Year""),
  total_flag STRING OPTIONS(description=""Total flag: \""*\""=Total, all ages; \""A\""=Individual age group""),
  starting_age INT64 OPTIONS(description=""Starting age (0 to 100)""),
  age_group_indicator STRING OPTIONS(description=""Age group indicator: \""-\""=5-year age group; \""+\""=open-ended age group""),
  ending_age INT64 OPTIONS(description=""Ending age (4 to 99; set to 0 if G=\""+\"")""),
  midyear_population INT64 OPTIONS(description=""Both sexes midyear population in the age group""),
  midyear_population_male INT64 OPTIONS(description=""Male midyear population in the age group""),
  midyear_population_female INT64 OPTIONS(description=""Female midyear population in the age group"")
)
OPTIONS(
  labels=[(""freebqcovid"", """")]
);"

,5
table_name,midyear_population_age_sex
ddl,"CREATE TABLE `bigquery-public-data.census_bureau_international.midyear_population_age_sex`
(
  country_code STRING NOT NULL OPTIONS(description=""Federal Information Processing Standard (FIPS) country/area code""),
  country_name STRING OPTIONS(description=""Country or area name""),
  year INT64 NOT NULL OPTIONS(description=""Year""),
  sex STRING OPTIONS(description=""Gender""),
  max_age INT64 OPTIONS(description=""The last age in the distribution with a value greater than zero""),
  population_age_0 INT64 OPTIONS(description=""Population at Age 0""),
  population_age_1 INT64 OPTIONS(description=""Population at Age 1""),
  population_age_2 INT64 OPTIONS(description=""Population at Age 2""),
  population_age_3 INT64 OPTIONS(description=""Population at Age 3""),
  population_age_4 INT64 OPTIONS(description=""Population at Age 4""),
  population_age_5 INT64 OPTIONS(description=""Population at Age 5""),
  population_age_6 INT64 OPTIONS(description=""Population at Age 6""),
  population_age_7 INT64 OPTIONS(description=""Population at Age 7""),
  population_age_8 INT64 OPTIONS(description=""Population at Age 8""),
  population_age_9 INT64 OPTIONS(description=""Population at Age 9""),
  population_age_10 INT64 OPTIONS(description=""Population at Age 10""),
  population_age_11 INT64 OPTIONS(description=""Population at Age 11""),
  population_age_12 INT64 OPTIONS(description=""Population at Age 12""),
  population_age_13 INT64 OPTIONS(description=""Population at Age 13""),
  population_age_14 INT64 OPTIONS(description=""Population at Age 14""),
  population_age_15 INT64 OPTIONS(description=""Population at Age 15""),
  population_age_16 INT64 OPTIONS(description=""Population at Age 16""),
  population_age_17 INT64 OPTIONS(description=""Population at Age 17""),
  population_age_18 INT64 OPTIONS(description=""Population at Age 18""),
  population_age_19 INT64 OPTIONS(description=""Population at Age 19""),
  population_age_20 INT64 OPTIONS(description=""Population at Age 20""),
  population_age_21 INT64 OPTIONS(description=""Population at Age 21""),
  population_age_22 INT64 OPTIONS(description=""Population at Age 22""),
  population_age_23 INT64 OPTIONS(description=""Population at Age 23""),
  population_age_24 INT64 OPTIONS(description=""Population at Age 24""),
  population_age_25 INT64 OPTIONS(description=""Population at Age 25""),
  population_age_26 INT64 OPTIONS(description=""Population at Age 26""),
  population_age_27 INT64 OPTIONS(description=""Population at Age 27""),
  population_age_28 INT64 OPTIONS(description=""Population at Age 28""),
  population_age_29 INT64 OPTIONS(description=""Population at Age 29""),
  population_age_30 INT64 OPTIONS(description=""Population at Age 30""),
  population_age_31 INT64 OPTIONS(description=""Population at Age 31""),
  population_age_32 INT64 OPTIONS(description=""Population at Age 32""),
  population_age_33 INT64 OPTIONS(description=""Population at Age 33""),
  population_age_34 INT64 OPTIONS(description=""Population at Age 34""),
  population_age_35 INT64 OPTIONS(description=""Population at Age 35""),
  population_age_36 INT64 OPTIONS(description=""Population at Age 36""),
  population_age_37 INT64 OPTIONS(description=""Population at Age 37""),
  population_age_38 INT64 OPTIONS(description=""Population at Age 38""),
  population_age_39 INT64 OPTIONS(description=""Population at Age 39""),
  population_age_40 INT64 OPTIONS(description=""Population at Age 40""),
  population_age_41 INT64 OPTIONS(description=""Population at Age 41""),
  population_age_42 INT64 OPTIONS(description=""Population at Age 42""),
  population_age_43 INT64 OPTIONS(description=""Population at Age 43""),
  population_age_44 INT64 OPTIONS(description=""Population at Age 44""),
  population_age_45 INT64 OPTIONS(description=""Population at Age 45""),
  population_age_46 INT64 OPTIONS(description=""Population at Age 46""),
  population_age_47 INT64 OPTIONS(description=""Population at Age 47""),
  population_age_48 INT64 OPTIONS(description=""Population at Age 48""),
  population_age_49 INT64 OPTIONS(description=""Population at Age 49""),
  population_age_50 INT64 OPTIONS(description=""Population at Age 50""),
  population_age_51 INT64 OPTIONS(description=""Population at Age 51""),
  population_age_52 INT64 OPTIONS(description=""Population at Age 52""),
  population_age_53 INT64 OPTIONS(description=""Population at Age 53""),
  population_age_54 INT64 OPTIONS(description=""Population at Age 54""),
  population_age_55 INT64 OPTIONS(description=""Population at Age 55""),
  population_age_56 INT64 OPTIONS(description=""Population at Age 56""),
  population_age_57 INT64 OPTIONS(description=""Population at Age 57""),
  population_age_58 INT64 OPTIONS(description=""Population at Age 58""),
  population_age_59 INT64 OPTIONS(description=""Population at Age 59""),
  population_age_60 INT64 OPTIONS(description=""Population at Age 60""),
  population_age_61 INT64 OPTIONS(description=""Population at Age 61""),
  population_age_62 INT64 OPTIONS(description=""Population at Age 62""),
  population_age_63 INT64 OPTIONS(description=""Population at Age 63""),
  population_age_64 INT64 OPTIONS(description=""Population at Age 64""),
  population_age_65 INT64 OPTIONS(description=""Population at Age 65""),
  population_age_66 INT64 OPTIONS(description=""Population at Age 66""),
  population_age_67 INT64 OPTIONS(description=""Population at Age 67""),
  population_age_68 INT64 OPTIONS(description=""Population at Age 68""),
  population_age_69 INT64 OPTIONS(description=""Population at Age 69""),
  population_age_70 INT64 OPTIONS(description=""Population at Age 70""),
  population_age_71 INT64 OPTIONS(description=""Population at Age 71""),
  population_age_72 INT64 OPTIONS(description=""Population at Age 72""),
  population_age_73 INT64 OPTIONS(description=""Population at Age 73""),
  population_age_74 INT64 OPTIONS(description=""Population at Age 74""),
  population_age_75 INT64 OPTIONS(description=""Population at Age 75""),
  population_age_76 INT64 OPTIONS(description=""Population at Age 76""),
  population_age_77 INT64 OPTIONS(description=""Population at Age 77""),
  population_age_78 INT64 OPTIONS(description=""Population at Age 78""),
  population_age_79 INT64 OPTIONS(description=""Population at Age 79""),
  population_age_80 INT64 OPTIONS(description=""Population at Age 80""),
  population_age_81 INT64 OPTIONS(description=""Population at Age 81""),
  population_age_82 INT64 OPTIONS(description=""Population at Age 82""),
  population_age_83 INT64 OPTIONS(description=""Population at Age 83""),
  population_age_84 INT64 OPTIONS(description=""Population at Age 84""),
  population_age_85 INT64 OPTIONS(description=""Population at Age 85""),
  population_age_86 INT64 OPTIONS(description=""Population at Age 86""),
  population_age_87 INT64 OPTIONS(description=""Population at Age 87""),
  population_age_88 INT64 OPTIONS(description=""Population at Age 88""),
  population_age_89 INT64 OPTIONS(description=""Population at Age 89""),
  population_age_90 INT64 OPTIONS(description=""Population at Age 90""),
  population_age_91 INT64 OPTIONS(description=""Population at Age 91""),
  population_age_92 INT64 OPTIONS(description=""Population at Age 92""),
  population_age_93 INT64 OPTIONS(description=""Population at Age 93""),
  population_age_94 INT64 OPTIONS(description=""Population at Age 94""),
  population_age_95 INT64 OPTIONS(description=""Population at Age 95""),
  population_age_96 INT64 OPTIONS(description=""Population at Age 96""),
  population_age_97 INT64 OPTIONS(description=""Population at Age 97""),
  population_age_98 INT64 OPTIONS(description=""Population at Age 98""),
  population_age_99 INT64 OPTIONS(description=""Population at Age 99""),
  population_age_100 INT64 OPTIONS(description=""Population at Age 100"")
)
OPTIONS(
  labels=[(""freebqcovid"", """")]
);"

,6
table_name,age_specific_fertility_rates
ddl,"CREATE TABLE `bigquery-public-data.census_bureau_international.age_specific_fertility_rates`
(
  country_code STRING NOT NULL OPTIONS(description=""Federal Information Processing Standard (FIPS) country/area code""),
  country_name STRING OPTIONS(description=""Country or area name""),
  year INT64 NOT NULL OPTIONS(description=""Year""),
  fertility_rate_15_19 FLOAT64 OPTIONS(description=""Age specific fertility rate for age 15-19 (births per 1,000 population)""),
  fertility_rate_20_24 FLOAT64 OPTIONS(description=""Age specific fertility rate for age 20-24 (births per 1,000 population)""),
  fertility_rate_25_29 FLOAT64 OPTIONS(description=""Age specific fertility rate for age 25-29 (births per 1,000 population)""),
  fertility_rate_30_34 FLOAT64 OPTIONS(description=""Age specific fertility rate for age 30-34 (births per 1,000 population)""),
  fertility_rate_35_39 FLOAT64 OPTIONS(description=""Age specific fertility rate for age 35-39 (births per 1,000 population)""),
  fertility_rate_40_44 FLOAT64 OPTIONS(description=""Age specific fertility rate for age 40-44 (births per 1,000 population)""),
  fertility_rate_45_49 FLOAT64 OPTIONS(description=""Age specific fertility rate for age 45-49 (births per 1,000 population)""),
  total_fertility_rate FLOAT64 OPTIONS(description=""Total fertility rate (lifetime births per woman)""),
  gross_reproduction_rate FLOAT64 OPTIONS(description=""Gross reproduction rate (lifetime female births per woman)""),
  sex_ratio_at_birth FLOAT64 OPTIONS(description=""Sex ratio at birth (male births per female birth)"")
)
OPTIONS(
  labels=[(""freebqcovid"", """")]
);"

,7
table_name,mortality_life_expectancy
ddl,"CREATE TABLE `bigquery-public-data.census_bureau_international.mortality_life_expectancy`
(
  country_code STRING NOT NULL OPTIONS(description=""Federal Information Processing Standard (FIPS) country/area code""),
  country_name STRING OPTIONS(description=""Country or area name""),
  year INT64 NOT NULL OPTIONS(description=""Year""),
  infant_mortality FLOAT64 OPTIONS(description=""Both sexes infant mortality rate (infant deaths per 1,000 population)""),
  infant_mortality_male FLOAT64 OPTIONS(description=""Male infant mortality rate (infant deaths per 1,000 population)""),
  infant_mortality_female FLOAT64 OPTIONS(description=""Female infant mortality rate (infant deaths per 1,000 population)""),
  life_expectancy FLOAT64 OPTIONS(description=""Both sexes life expectancy at birth (years)""),
  life_expectancy_male FLOAT64 OPTIONS(description=""Male life expectancy at birth (years)""),
  life_expectancy_female FLOAT64 OPTIONS(description=""Female life expectancy at birth (years)""),
  mortality_rate_under5 FLOAT64 OPTIONS(description=""Both sexes under-5 mortality rate (probability of dying between ages 0 and 5)""),
  mortality_rate_under5_male FLOAT64 OPTIONS(description=""Male sexes under-5 mortality rate (probability of dying between ages 0 and 5)""),
  mortality_rate_under5_female FLOAT64 OPTIONS(description=""Female sexes under-5 mortality rate (probability of dying between ages 0 and 5)""),
  mortality_rate_1to4 FLOAT64 OPTIONS(description=""Both sexes child mortality rate (probability of dying between ages 1 and 4)""),
  mortality_rate_1to4_male FLOAT64 OPTIONS(description=""Male sexes child mortality rate (probability of dying between ages 1 and 4)""),
  mortality_rate_1to4_female FLOAT64 OPTIONS(description=""Female sexes child mortality rate (probability of dying between ages 1 and 4)"")
)
OPTIONS(
  labels=[(""freebqcovid"", """")]
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'census_bureau_international': ['age_specific_fertility_rates', 'birth_death_growth_rates', 'country_names_area', 'midyear_population', 'midyear_population_5yr_age_sex', 'midyear_population_age_sex', 'midyear_population_agespecific', 'mortality_life_expectancy']}}
Begin Exploring Related Columns
**Columns and Potential Usage:**

- `country_name`: Identifies the country.
- `year`: To filter data for the year 2017.
- `sex`: To select or aggregate over sexes.
- `age`: Age of individuals.
- `population`: Total count of individuals at a specific age.

**Conditions that may be used:**

- `year` = 2017
- `sex` = 'Both Sexes'
- `age` < 25
- Aggregate population data to calculate total populations.

**SQL Queries:**

1. ```sql
   SELECT * FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` LIMIT 100;
   ```

2. ```sql
   SELECT DISTINCT `year` FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` ORDER BY `year`;
   ```

3. ```sql
   SELECT DISTINCT `country_name` FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` LIMIT 100;
   ```

4. ```sql
   SELECT `country_name`, `year`, `sex`, `age`, `population` 
   FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
   WHERE `year` = 2017 AND `age` = 0 AND `sex` = 'Both Sexes' 
   LIMIT 100;
   ```

5. ```sql
   SELECT `country_name`, SUM(`population`) AS `total_population` 
   FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
   WHERE `year` = 2017 AND `sex` = 'Both Sexes' 
   GROUP BY `country_name` 
   LIMIT 100;
   ```

6. ```sql
   SELECT `country_name`, SUM(`population`) AS `population_under_25` 
   FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
   WHERE `year` = 2017 AND `sex` = 'Both Sexes' AND `age` < 25 
   GROUP BY `country_name` 
   LIMIT 100;
   ```

7. ```sql
   SELECT `country_name`, 
          SUM(CASE WHEN `age` < 25 THEN `population` ELSE 0 END) AS `population_under_25`, 
          SUM(`population`) AS `total_population` 
   FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
   WHERE `year` = 2017 AND `sex` = 'Both Sexes' 
   GROUP BY `country_name` 
   LIMIT 100;
   ```

8. ```sql
   SELECT `country_name`, 
          (SUM(CASE WHEN `age` < 25 THEN `population` ELSE 0 END) / SUM(`population`)) * 100 AS `percentage_under_25` 
   FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
   WHERE `year` = 2017 AND `sex` = 'Both Sexes' 
   GROUP BY `country_name` 
   ORDER BY `percentage_under_25` DESC 
   LIMIT 100;
   ```

9. ```sql
   SELECT `country_name`, `age`, `population` 
   FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
   WHERE `year` = 2017 AND `sex` = 'Both Sexes' AND `age` BETWEEN 20 AND 24 
   ORDER BY `country_name`, `age` 
   LIMIT 100;
   ```

10. ```sql
    SELECT `age`, SUM(`population`) AS `total_population_by_age` 
    FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
    WHERE `year` = 2017 AND `sex` = 'Both Sexes' 
    GROUP BY `age` 
    ORDER BY `age` 
    LIMIT 100;
    ```

11. ```sql
    SELECT `country_name`, MAX(`population`) AS `max_population_age` 
    FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
    WHERE `year` = 2017 AND `sex` = 'Both Sexes' 
    GROUP BY `country_name` 
    LIMIT 100;
    ```

12. ```sql
    SELECT `country_name`, `age`, `population` 
    FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
    WHERE `year` = 2017 AND `sex` = 'Both Sexes' AND `country_name` = 'Niger' 
    ORDER BY `age` 
    LIMIT 100;
    ```

13. ```sql
    SELECT `country_name`, SUM(`population`) AS `population_over_60` 
    FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
    WHERE `year` = 2017 AND `sex` = 'Both Sexes' AND `age` >= 60 
    GROUP BY `country_name` 
    LIMIT 100;
    ```

14. ```sql
    SELECT `country_name`, AVG(`population`) AS `average_population_per_age` 
    FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
    WHERE `year` = 2017 AND `sex` = 'Both Sexes' 
    GROUP BY `country_name` 
    LIMIT 100;
    ```

15. ```sql
    SELECT `country_name`, 
           SUM(CASE WHEN `age` BETWEEN 0 AND 14 THEN `population` ELSE 0 END) AS `population_0_14`, 
           SUM(CASE WHEN `age` BETWEEN 15 AND 24 THEN `population` ELSE 0 END) AS `population_15_24`, 
           SUM(`population`) AS `total_population` 
    FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
    WHERE `year` = 2017 AND `sex` = 'Both Sexes' 
    GROUP BY `country_name` 
    LIMIT 100;
    ```

16. ```sql
    SELECT `country_name`, 
           (SUM(CASE WHEN `age` < 25 THEN `population` ELSE 0 END) / SUM(`population`)) * 100 AS `percentage_under_25` 
    FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
    WHERE `year` = 2017 AND `sex` = 'Both Sexes' 
    GROUP BY `country_name` 
    ORDER BY `percentage_under_25` DESC 
    LIMIT 100;
    ```

17. ```sql
    SELECT `country_name`, `year`, `sex`, `age`, `population` 
    FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
    WHERE `country_name` = 'Niger' AND `year` = 2017 AND `sex` = 'Both Sexes' 
    ORDER BY `age` 
    LIMIT 100;
    ```

18. ```sql
    SELECT DISTINCT `sex` 
    FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific`;
    ```

19. ```sql
    SELECT `country_name`, SUM(`population`) AS `population_between_25_64` 
    FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
    WHERE `year` = 2017 AND `sex` = 'Both Sexes' AND `age` BETWEEN 25 AND 64 
    GROUP BY `country_name` 
    LIMIT 100;
    ```

20. ```sql
    SELECT `country_name`, 
           (SUM(CASE WHEN `age` >= 65 THEN `population` ELSE 0 END) / SUM(`population`)) * 100 AS `percentage_over_65` 
    FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
    WHERE `year` = 2017 AND `sex` = 'Both Sexes' 
    GROUP BY `country_name` 
    ORDER BY `percentage_over_65` DESC 
    LIMIT 100;
    ```Query:
SELECT * FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` LIMIT 100;
Answer:
country_code,country_name,year,sex,population,age
NR,Nauru,2001,Male,152,0
NR,Nauru,2001,Male,126,1
NR,Nauru,2001,Male,132,2
NR,Nauru,2001,Male,140,3
NR,Nauru,2001,Male,153,4
NR,Nauru,2001,Male,134,5
NR,Nauru,2001,Male,123,6
NR,Nauru,2001,Male,129,7
NR,Nauru,2001,Male,119,8
NR,Nauru,2001,Male,133,9
NR,Nauru,2001,Male,138,10
NR,Nauru,2001,Male,136,11
NR,Nauru,2001,Male,132,12
NR,Nauru,2001,Male,129,13
NR,Nauru,2001,Male,124,14
NR,Nauru,2001,Male,117,15
NR,Nauru,2001,Male,109,16
NR,Nauru,2001,Male,111,17
NR,Nauru,2001,Male,103,18
NR,Nauru,2001,Male,100,19
NR,Nauru,2001,Male,97,20
NR,Nauru,2001,Male,91,21
NR,Nauru,2001,Male,89,22
NR,Nauru,2001,Male,85,23
NR,Nauru,2001,Male,83,24
NR,Nauru,2001,Male,74,25
NR,Nauru,2001,Male,72,26
NR,Nauru,2001,Male,68,27
NR,Nauru,2001,Male,72,28
NR,Nauru,2001,Male,74,29
NR,Nauru,2001,Male,75,30
NR,Nauru,2001,Male,77,31
NR,Nauru,2001,Male,72,32
NR,Nauru,2001,Male,78,33
NR,Nauru,2001,Male,76,34
NR,Nauru,2001,Male,78,35
NR,Nauru,2001,Male,78,36
NR,Nauru,2001,Male,73,37
NR,Nauru,2001,Male,69,38
NR,Nauru,2001,Male,66,39
NR,Nauru,2001,Male,65,40
NR,Nauru,2001,Male,59,41
NR,Nauru,2001,Male,58,42
NR,Nauru,2001,Male,56,43
NR,Nauru,2001,Male,53,44
NR,Nauru,2001,Male,53,45
NR,Nauru,2001,Male,52,46
NR,Nauru,2001,Male,49,47
Query:
SELECT DISTINCT `year` FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` ORDER BY `year`;
Answer:
year
1950
1951
1952
1953
1954
1955
1956
1957
1958
1959
1960
1961
1962
1963
1964
1965
1966
1967
1968
1969
1970
1971
1972
1973
1974
1975
1976
1977
1978
1979
1980
1981
1982
1983
1984
1985
1986
1987
1988
1989
1990
1991
1992
1993
1994
1995
1996
1997
1998
1999
2000
2001
2002
2003
2004
2005
2006
2007
2008
2009
2010
2011
2012
2013
2014
2015
2016
2017
2018
2019
2020
2021
2022
2023
2024
2025
2026
2027
2028
2029
2030
2031
2032
2033
2034
2035
2036
2037
2038
2039
2040
2041
2042
2043
2044
2045
2046
2047
2048
2049
2050
Query:
SELECT DISTINCT `country_name` FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` LIMIT 100;
Answer:
country_name
Nauru
Suriname
New Zealand
South Sudan
Peru
Pakistan
Poland
Panama
Portugal
Papua New Guinea
Palau
Guinea-Bissau
Qatar
Serbia
Marshall Islands
Saint Martin
Romania
Philippines
Puerto Rico
Russia
Rwanda
Saudi Arabia
Saint Pierre and Miquelon
Saint Kitts and Nevis
Seychelles
South Africa
Senegal
"Saint Helena, Ascension, and Tristan da Cunha"
Slovenia
San Marino
Singapore
Spain
Saint Lucia
Sudan
Sweden
Syria
Switzerland
Saint Barthelemy
Trinidad and Tobago
Thailand
Tajikistan
Turks and Caicos Islands
Tonga
Georgia
Gibraltar
Grenada
Guernsey
Greenland
Germany
Guam
Greece
Guatemala
Guyana
Gaza Strip
Hong Kong
Croatia
Hungary
Iceland
Indonesia
Isle of Man
India
Iran
Israel
Italy
Iraq
Japan
Jersey
Jamaica
Jordan
Kenya
Kyrgyzstan
"Korea, North"
Kiribati
"Korea, South"
Kuwait
Kosovo
Kazakhstan
Laos
Latvia
Lithuania
Slovakia
Liechtenstein
Lesotho
Luxembourg
Libya
Togo
Sao Tome and Principe
Tunisia
Timor-Leste
Turkey
Tuvalu
Taiwan
Turkmenistan
Tanzania
Curacao
United Kingdom
Ukraine
United States
Burkina Faso
Uruguay
Query:
SELECT `country_name`, 
       (SUM(CASE WHEN `age` < 25 THEN `population` ELSE 0 END) / SUM(`population`)) * 100 AS `percentage_under_25` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017
GROUP BY `country_name` 
ORDER BY `percentage_under_25` DESC 
LIMIT 1;
Answer:
country_name,percentage_under_25
Uganda,69.1457886473697
Query:
SELECT `country_name`, SUM(`population`) AS `total_population` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 
GROUP BY `country_name` 
LIMIT 100
Answer:
country_name,total_population
Nauru,9642
Suriname,591919
New Zealand,4510327
South Sudan,10507520
Peru,31036656
Pakistan,204924861
Poland,38476269
Panama,3753142
Portugal,10383790
Papua New Guinea,6909701
Palau,21431
Guinea-Bissau,1788610
Qatar,2314307
Serbia,7111024
Marshall Islands,74539
Saint Martin,32125
Romania,21529967
Philippines,104256076
Puerto Rico,3351827
Russia,142257519
Rwanda,11901484
Saudi Arabia,32548604
Saint Pierre and Miquelon,5533
Saint Kitts and Nevis,52715
Seychelles,93920
South Africa,54841552
Senegal,14668522
"Saint Helena, Ascension, and Tristan da Cunha",7828
Slovenia,2101416
San Marino,33537
Singapore,5888926
Spain,48958159
Saint Lucia,164994
Sudan,41824518
Sweden,9960487
Syria,18028549
Switzerland,8236303
Saint Barthelemy,7184
Trinidad and Tobago,1218208
Thailand,68414135
Tajikistan,8468555
Turks and Caicos Islands,52570
Gibraltar,29396
Grenada,111724
Guernsey,66502
Greenland,57713
Germany,80594017
Guam,167358
Greece,10768477
Guatemala,16296181
Guyana,737718
Gaza Strip,1795183
Hong Kong,7191503
Croatia,4292095
Hungary,9850845
Iceland,339747
Indonesia,260580739
Isle of Man,88815
India,1281935911
Iran,82021564
Israel,8299706
Italy,62137802
Iraq,39192111
Japan,126451398
Jersey,98840
Jamaica,2813340
Jordan,10248069
Kenya,47615739
Kyrgyzstan,5789122
"Korea, North",25248140
Kiribati,108145
"Korea, South",51181299
Kuwait,2875422
Kosovo,1895250
Kazakhstan,18556698
Laos,7126706
Latvia,1944643
Lithuania,2823859
Slovakia,5445829
Liechtenstein,38244
Lesotho,1958042
Luxembourg,594130
Libya,6653210
Tonga,106479
Togo,7965055
Sao Tome and Principe,201025
Tunisia,11403800
Query:
SELECT `country_name`, SUM(`population`) AS `population_under_25` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 AND `age` < 25 
GROUP BY `country_name` 
LIMIT 100
Answer:
country_name,population_under_25
Nauru,4591
Suriname,248920
New Zealand,1490152
South Sudan,6717849
Peru,13848747
Pakistan,107589438
Poland,9793667
Panama,1628317
Portugal,2607964
Papua New Guinea,3685959
Palau,7795
Guinea-Bissau,1142376
Qatar,578187
Serbia,1831982
Marshall Islands,39418
Saint Martin,11749
Romania,5371246
Philippines,54794408
Puerto Rico,988208
Russia,37806888
Rwanda,7226072
Saudi Arabia,13656525
Saint Pierre and Miquelon,1347
Saint Kitts and Nevis,18377
Seychelles,31101
South Africa,25160724
Senegal,9071879
"Saint Helena, Ascension, and Tristan da Cunha",2204
Slovenia,502472
San Marino,8969
Singapore,1730345
Spain,12221093
Saint Lucia,58395
Sudan,26527909
Sweden,2862833
Syria,9223941
Switzerland,2144920
Saint Barthelemy,1699
Trinidad and Tobago,379734
Thailand,21278754
Tajikistan,4313782
Turks and Caicos Islands,18782
Gibraltar,10160
Grenada,43598
Guernsey,17049
Greenland,21116
Germany,18464905
Guam,73914
Greece,2531224
Guatemala,9031561
Guyana,352509
Gaza Strip,1185377
Hong Kong,1626759
Croatia,1092367
Hungary,2528814
Iceland,115154
Indonesia,109476701
Isle of Man,24618
India,579949092
Iran,31897846
Israel,3572500
Italy,14486265
Iraq,23008289
Japan,28432645
Jersey,29792
Jamaica,1264359
Jordan,5610991
Kenya,28175486
Kyrgyzstan,2726431
"Korea, North",9184995
Kiribati,54879
"Korea, South",13242524
Kuwait,1153514
Kosovo,800354
Kazakhstan,7415630
Laos,3843766
Latvia,478314
Lithuania,737133
Slovakia,1418283
Liechtenstein,10293
Lesotho,1009495
Luxembourg,171986
Libya,2855932
Query:
SELECT `country_name`, 
       SUM(CASE WHEN `age` < 25 THEN `population` ELSE 0 END) AS `population_under_25`, 
       SUM(`population`) AS `total_population` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 
GROUP BY `country_name` 
LIMIT 100
Answer:
country_name,population_under_25,total_population
Nauru,4591,9642
Suriname,248920,591919
New Zealand,1490152,4510327
South Sudan,6717849,10507520
Peru,13848747,31036656
Pakistan,107589438,204924861
Poland,9793667,38476269
Panama,1628317,3753142
Portugal,2607964,10383790
Papua New Guinea,3685959,6909701
Palau,7795,21431
Guinea-Bissau,1142376,1788610
Qatar,578187,2314307
Serbia,1831982,7111024
Marshall Islands,39418,74539
Saint Martin,11749,32125
Romania,5371246,21529967
Philippines,54794408,104256076
Puerto Rico,988208,3351827
Russia,37806888,142257519
Rwanda,7226072,11901484
Saudi Arabia,13656525,32548604
Saint Pierre and Miquelon,1347,5533
Saint Kitts and Nevis,18377,52715
Seychelles,31101,93920
South Africa,25160724,54841552
Senegal,9071879,14668522
"Saint Helena, Ascension, and Tristan da Cunha",2204,7828
Slovenia,502472,2101416
San Marino,8969,33537
Singapore,1730345,5888926
Spain,12221093,48958159
Saint Lucia,58395,164994
Sudan,26527909,41824518
Sweden,2862833,9960487
Syria,9223941,18028549
Switzerland,2144920,8236303
Saint Barthelemy,1699,7184
Trinidad and Tobago,379734,1218208
Thailand,21278754,68414135
Tajikistan,4313782,8468555
Turks and Caicos Islands,18782,52570
Gibraltar,10160,29396
Grenada,43598,111724
Guernsey,17049,66502
Greenland,21116,57713
Germany,18464905,80594017
Guam,73914,167358
Greece,2531224,10768477
Guatemala,9031561,16296181
Guyana,352509,737718
Gaza Strip,1185377,1795183
Hong Kong,1626759,7191503
Croatia,1092367,4292095
Hungary,2528814,9850845
Iceland,115154,339747
Query:
SELECT `country_name`, 
       (SUM(CASE WHEN `age` < 25 THEN `population` ELSE 0 END) / SUM(`population`)) * 100 AS `percentage_under_25` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 
GROUP BY `country_name` 
ORDER BY `percentage_under_25` DESC 
LIMIT 100
Answer:
country_name,percentage_under_25
Uganda,69.1457886473697
Niger,68.11082202531688
Chad,67.42454630438175
Mali,67.01576634818254
Malawi,66.88810926886434
Angola,66.36923852602806
Mozambique,66.28719005169998
Gaza Strip,66.03098402781221
Zambia,66.02077385424494
Burkina Faso,64.73825780484853
Burundi,64.71763243239849
South Sudan,63.93372556036058
Guinea-Bissau,63.869485242730384
Tanzania,63.601251766999034
Ethiopia,63.57544592777485
Sudan,63.42669388323854
Liberia,63.38291084642189
Congo (Kinshasa),63.20058770856599
Afghanistan,63.1420112480623
Benin,63.08832341906574
Sao Tome and Principe,62.53550553413755
Nigeria,62.36660870315772
Somalia,62.18200505358076
Cameroon,61.94653826172834
Senegal,61.845896948581455
Timor-Leste,61.23600117086044
Yemen,61.03616068707341
Rwanda,60.71572250989876
Guinea,60.67921208263418
Sierra Leone,60.38324278235558
Madagascar,60.200950253333176
Central African Republic,60.023754168357
Gabon,60.02307340244353
Cote d'Ivoire,59.8807567443196
Eritrea,59.74521698979155
Equatorial Guinea,59.52916267321721
Togo,59.49131550252949
Zimbabwe,59.36693322546969
Kenya,59.17263197364216
Comoros,58.88340263340264
Congo (Brazzaville),58.7687504768225
Iraq,58.70642946484816
Mauritania,58.36790099215898
"Gambia, The",57.91032596376166
West Bank,57.86692082041003
Namibia,57.31718703466705
Western Sahara,56.766398177878926
Ghana,56.640676534233336
Vanuatu,55.52836846832193
Guatemala,55.42133460594234
Jordan,54.751690294044664
Solomon Islands,54.576184292003624
Eswatini,54.476148078073486
Haiti,54.05596506114468
Honduras,53.94667244033212
Laos,53.93467893862886
Tonga,53.52041247569943
Papua New Guinea,53.34469610190079
Marshall Islands,52.88238371859026
Belize,52.82702114854663
Philippines,52.557520004877226
Pakistan,52.50189629261235
Djibouti,52.46230354329935
Egypt,52.23273089975757
Nepal,51.93305798671991
Lesotho,51.556350680935346
Bolivia,51.31464287785658
Samoa,51.16986827113359
Syria,51.162969354882634
Tajikistan,50.938820141098454
Botswana,50.86095812914417
Query:
SELECT `country_name`, `age`, `population` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 AND `age` BETWEEN 20 AND 24 
ORDER BY `country_name`, `age` 
LIMIT 100
Answer:
country_name,age,population
Afghanistan,20,389601
Afghanistan,20,375728
Afghanistan,21,362431
Afghanistan,21,375946
Afghanistan,22,348060
Afghanistan,22,361190
Afghanistan,23,345085
Afghanistan,23,332452
Afghanistan,24,312908
Afghanistan,24,324946
Albania,20,28409
Albania,20,26804
Albania,21,30641
Albania,21,28578
Albania,22,28736
Albania,22,31089
Albania,23,29044
Albania,23,27334
Albania,24,27712
Albania,24,28945
Algeria,20,313558
Algeria,20,299453
Algeria,21,326618
Algeria,21,311608
Algeria,22,355553
Algeria,22,339064
Algeria,23,351966
Algeria,23,369467
Algeria,24,356005
Algeria,24,374121
American Samoa,20,445
American Samoa,20,438
American Samoa,21,476
American Samoa,21,466
American Samoa,22,500
American Samoa,22,495
American Samoa,23,514
American Samoa,23,498
American Samoa,24,501
American Samoa,24,488
Andorra,20,345
Andorra,20,414
Andorra,21,394
Andorra,21,347
Andorra,22,347
Andorra,22,396
Andorra,23,352
Andorra,23,393
Andorra,24,393
Andorra,24,411
Angola,20,266470
Angola,20,249721
Angola,21,240137
Angola,21,258273
Angola,22,251119
Angola,22,231680
Angola,23,223150
Angola,23,243694
Angola,24,236935
Angola,24,215539
Anguilla,20,115
Anguilla,20,114
Anguilla,21,112
Anguilla,21,117
Anguilla,22,111
Anguilla,22,118
Anguilla,23,115
Anguilla,23,112
Anguilla,24,111
Anguilla,24,104
Antigua and Barbuda,20,850
Antigua and Barbuda,20,854
Antigua and Barbuda,21,826
Antigua and Barbuda,21,811
Antigua and Barbuda,22,761
Antigua and Barbuda,22,774
Antigua and Barbuda,23,720
Antigua and Barbuda,23,746
Antigua and Barbuda,24,717
Antigua and Barbuda,24,742
Argentina,20,346527
Argentina,20,332659
Query:
SELECT `age`, SUM(`population`) AS `total_population_by_age` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 
GROUP BY `age` 
ORDER BY `age` 
LIMIT 100
Answer:
age,total_population_by_age
0,132682146
1,131127352
2,130131725
3,129137233
4,128326357
5,127506146
6,126607406
7,125886557
8,125305498
9,124699003
10,123508718
11,122238836
12,121240490
13,120397487
14,119483671
15,118943649
16,118655789
17,118311926
18,118132670
19,118152025
20,118064876
21,118319066
22,118494686
23,118065588
24,117530610
25,117777540
26,118306562
27,125172859
28,120750817
29,118234759
30,118512044
31,113408750
32,110154736
33,109056764
34,108229169
35,110283524
36,102984129
37,102352848
38,100389448
39,98136854
40,97147218
41,96805508
42,96805165
43,97150541
44,96976015
45,95989304
46,96261355
47,94558160
48,93731497
49,89345060
50,85947677
51,86336282
52,84822950
53,84131796
54,84138642
55,71965250
56,66596254
57,67512083
58,65433558
59,67706141
60,64941557
61,62187109
62,61830185
63,58405873
64,55377874
65,52979137
66,49055197
67,48064498
68,44097339
69,41632447
70,39206205
71,34401714
72,32040334
73,30456373
74,28830945
75,27729302
76,26226350
77,24398620
78,22417674
79,20941603
80,19000004
81,17153388
82,15200611
83,13435054
84,11993324
85,10422317
86,9152402
87,7930471
88,6574806
89,5498046
90,4424164
91,3550609
92,2825111
93,2159463
94,1626128
95,1221194
96,904459
97,628441
98,396842
99,264676
Query:
SELECT `country_name`, MAX(`population`) AS `max_population_age` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 
GROUP BY `country_name` 
LIMIT 100
Answer:
country_name,max_population_age
Nauru,124
Suriname,5860
New Zealand,33189
South Sudan,181502
Peru,297813
Pakistan,2290115
Poland,341969
Panama,34529
Portugal,89907
Papua New Guinea,81027
Palau,225
Guinea-Bissau,32006
Qatar,65539
Serbia,58207
Marshall Islands,911
Saint Martin,356
Romania,215419
Philippines,1236194
Puerto Rico,24680
Russia,1287767
Rwanda,180404
Saudi Arabia,439859
Saint Pierre and Miquelon,60
Saint Kitts and Nevis,444
Seychelles,1004
South Africa,566756
Senegal,237467
"Saint Helena, Ascension, and Tristan da Cunha",81
Slovenia,17622
San Marino,307
Singapore,69669
Spain,450318
Saint Lucia,1405
Sudan,702979
Sweden,73158
Syria,201495
Switzerland,67925
Saint Barthelemy,72
Trinidad and Tobago,12511
Thailand,569743
Tajikistan,98197
Turks and Caicos Islands,604
Gibraltar,283
Grenada,1082
Guernsey,560
Greenland,607
Germany,725665
Guam,1685
Greece,85292
Guatemala,206407
Guyana,8592
Gaza Strip,28560
Hong Kong,75086
Croatia,33855
Hungary,92085
Iceland,2559
Indonesia,2306498
Isle of Man,711
India,12479419
Iran,909091
Israel,84147
Italy,519884
Iraq,586460
Japan,1107967
Jersey,922
Jamaica,27336
Jordan,133445
Kenya,682187
Kyrgyzstan,64654
"Korea, North",228984
Kiribati,1219
"Korea, South",469642
Kuwait,43957
Kosovo,19680
Kazakhstan,181794
Laos,81971
Latvia,16552
Lithuania,25543
Slovakia,47917
Liechtenstein,333
Lesotho,23277
Luxembourg,4703
Libya,69428
Tonga,1269
Togo,128713
Sao Tome and Principe,3164
Tunisia,113254
Query:
SELECT `country_name`, `age`, `population` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 AND `country_name` = 'Niger' 
ORDER BY `age` 
LIMIT 100
Answer:
country_name,age,population
Niger,0,402795
Niger,0,393277
Niger,1,371849
Niger,1,379195
Niger,2,364876
Niger,2,357854
Niger,3,346218
Niger,3,353096
Niger,4,342661
Niger,4,335875
Niger,5,333161
Niger,5,326517
Niger,6,317928
Niger,6,324342
Niger,7,309960
Niger,7,316150
Niger,8,302290
Niger,8,308270
Niger,9,300534
Niger,9,294710
Niger,10,291978
Niger,10,286720
Niger,11,280272
Niger,11,276129
Niger,12,263519
Niger,12,266473
Niger,13,253314
Niger,13,251532
Niger,14,240059
Niger,14,240689
Niger,15,228551
Niger,15,229057
Niger,16,218504
Niger,16,216888
Niger,17,205734
Niger,17,208390
Niger,18,195007
Niger,18,198649
Niger,19,184759
Niger,19,189273
Niger,20,174922
Niger,20,180240
Niger,21,171488
Niger,21,165534
Niger,22,156442
Niger,22,162934
Niger,23,147786
Niger,23,154649
Niger,24,140066
Niger,24,147046
Niger,25,133115
Niger,25,140036
Niger,26,127809
Niger,26,134542
Niger,27,123146
Niger,27,129562
Niger,28,118716
Niger,28,124656
Niger,29,114639
Niger,29,120004
Niger,30,115356
Niger,30,110685
Niger,31,111019
Niger,31,106984
Niger,32,103614
Niger,32,106948
Niger,33,100422
Niger,33,103125
Niger,34,97324
Niger,34,99451
Niger,35,95808
Niger,35,94381
Niger,36,92268
Niger,36,91388
Niger,37,88685
Niger,37,88396
Niger,38,85224
Niger,38,85505
Niger,39,82603
Niger,39,83365
Niger,40,76688
Niger,40,79390
Niger,41,73311
Niger,41,76590
Niger,42,70574
Niger,42,73916
Niger,43,67566
Query:
SELECT `country_name`, SUM(`population`) AS `population_over_60` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 AND `age` >= 60 
GROUP BY `country_name` 
LIMIT 100
Answer:
country_name,population_over_60
Nauru,524
Suriname,53968
New Zealand,934744
South Sudan,411591
Peru,3388505
Pakistan,14109177
Poland,9267754
Panama,446024
Portugal,2700896
Papua New Guinea,461709
Palau,2616
Guinea-Bissau,82738
Qatar,51381
Serbia,1842333
Marshall Islands,5001
Saint Martin,3866
Romania,4938536
Philippines,7435885
Puerto Rico,865335
Russia,29799445
Rwanda,498207
Saudi Arabia,1721064
Saint Pierre and Miquelon,1497
Saint Kitts and Nevis,7260
Seychelles,10872
South Africa,4768609
Senegal,686714
"Saint Helena, Ascension, and Tristan da Cunha",1668
Slovenia,561416
San Marino,8493
Singapore,849115
Spain,11514425
Saint Lucia,26616
Sudan,1933966
Sweden,2581201
Syria,1177644
Switzerland,1968553
Saint Barthelemy,1739
Trinidad and Tobago,196201
Thailand,10878304
Tajikistan,467232
Turks and Caicos Islands,3720
Gibraltar,6223
Grenada,16317
Guernsey,16972
Greenland,8393
Germany,23172119
Guam,21639
Greece,2925975
Guatemala,1091704
Guyana,72011
Gaza Strip,71084
Hong Kong,1708139
Croatia,1153098
Hungary,2597086
Iceland,67940
Indonesia,28353378
Isle of Man,23498
India,122148693
Iran,6945873
Israel,1280179
Italy,17138686
Iraq,2116489
Japan,43106028
Jersey,21800
Jamaica,344117
Jordan,538573
Kenya,2235631
Kyrgyzstan,494346
"Korea, North",3444536
Kiribati,7276
"Korea, South",10421946
Kuwait,129199
Kosovo,202781
Kazakhstan,2214072
Laos,444164
Latvia,505907
Lithuania,729801
Slovakia,1205394
Liechtenstein,9172
Lesotho,151782
Luxembourg,121011
Libya,438595
Tonga,9736
Togo,422439
Query:
SELECT `country_name`, AVG(`population`) AS `average_population_per_age` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 
GROUP BY `country_name` 
LIMIT 100
Answer:
country_name,average_population_per_age
Nauru,47.73267326732674
Suriname,2930.29207920792
New Zealand,22328.351485148527
South Sudan,52017.42574257426
Peru,153646.81188118825
Pakistan,1014479.5099009905
Poland,190476.57920792067
Panama,18579.910891089112
Portugal,51404.900990099006
Papua New Guinea,34206.44059405939
Palau,106.09405940594057
Guinea-Bissau,8854.504950495042
Qatar,11456.965346534656
Serbia,35203.0891089109
Marshall Islands,369.0049504950494
Saint Martin,159.03465346534645
Romania,106583.9950495049
Philippines,516119.1881188118
Puerto Rico,16593.20297029702
Russia,704245.1435643564
Rwanda,58918.23762376243
Saudi Arabia,161131.702970297
Saint Pierre and Miquelon,27.391089108910883
Saint Kitts and Nevis,260.9653465346536
Seychelles,464.9504950495052
South Africa,271492.83168316836
Senegal,72616.44554455444
"Saint Helena, Ascension, and Tristan da Cunha",38.75247524752477
Slovenia,10403.049504950503
San Marino,166.02475247524742
Singapore,29153.099009900998
Spain,242367.1237623764
Saint Lucia,816.8019801980201
Sudan,207052.06930693059
Sweden,49309.34158415841
Syria,89250.2425742574
Switzerland,40773.77722772276
Saint Barthelemy,35.56435643564355
Trinidad and Tobago,6030.732673267327
Thailand,338683.8366336633
Tajikistan,41923.53960396041
Turks and Caicos Islands,260.24752475247533
Gibraltar,145.52475247524754
Grenada,553.0891089108912
Guernsey,329.21782178217813
Greenland,285.70792079207905
Germany,398980.2821782178
Guam,828.5049504950499
Greece,53309.29207920788
Guatemala,80674.16336633667
Guyana,3652.0693069306926
Gaza Strip,8887.044554455431
Hong Kong,35601.500000000015
Croatia,21247.995049504956
Hungary,48766.55940594059
Iceland,1681.9158415841591
Indonesia,1290003.6584158416
Isle of Man,439.67821782178186
India,6346217.381188119
Iran,406047.34653465316
Israel,41087.65346534654
Italy,307612.8811881188
Iraq,194020.35148514842
Japan,625997.0198019804
Query:
SELECT `country_name`, 
       SUM(CASE WHEN `age` BETWEEN 0 AND 14 THEN `population` ELSE 0 END) AS `population_0_14`, 
       SUM(CASE WHEN `age` BETWEEN 15 AND 24 THEN `population` ELSE 0 END) AS `population_15_24`, 
       SUM(`population`) AS `total_population` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 
GROUP BY `country_name` 
LIMIT 100
Answer:
country_name,population_0_14,population_15_24,total_population
Nauru,3028,1563,9642
Suriname,145703,103217,591919
New Zealand,887859,602293,4510327
South Sudan,4562672,2155177,10507520
Peru,8165560,5683187,31036656
Pakistan,64271086,43318352,204924861
Poland,5677276,4116391,38476269
Panama,990691,637626,3753142
Portugal,1478548,1129416,10383790
Papua New Guinea,2309816,1376143,6909701
Palau,4220,3575,21431
Guinea-Bissau,781830,360546,1788610
Qatar,292273,285914,2314307
Serbia,1031239,800743,7111024
Marshall Islands,26004,13414,74539
Saint Martin,8423,3326,32125
Romania,3089840,2281406,21529967
Philippines,34814994,19979414,104256076
Puerto Rico,528729,459479,3351827
Russia,24352817,13454071,142257519
Rwanda,4924487,2301585,11901484
Saudi Arabia,8518244,5138281,32548604
Saint Pierre and Miquelon,846,501,5533
Saint Kitts and Nevis,10710,7667,52715
Seychelles,18667,12434,93920
South Africa,15502666,9658058,54841552
Senegal,6089093,2982786,14668522
"Saint Helena, Ascension, and Tristan da Cunha",1250,954,7828
Slovenia,309287,193185,2101416
San Marino,5105,3864,33537
Singapore,755013,975332,5888926
Spain,7529312,4691781,48958159
Saint Lucia,33033,25362,164994
Sudan,18225538,8302371,41824518
Sweden,1735837,1126996,9960487
Syria,5700887,3523054,18028549
Switzerland,1248503,896417,8236303
Saint Barthelemy,1179,520,7184
Trinidad and Tobago,234999,144735,1218208
Thailand,11583133,9695621,68414135
Tajikistan,2737629,1576153,8468555
Turks and Caicos Islands,11430,7352,52570
Gibraltar,5944,4216,29396
Grenada,26807,16791,111724
Query:
SELECT `country_name`, `year`, `sex`, `age`, `population` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `country_name` = 'Niger' AND `year` = 2017 
ORDER BY `age` 
LIMIT 100
Answer:
country_name,year,sex,age,population
Niger,2017,Male,0,402795
Niger,2017,Female,0,393277
Niger,2017,Female,1,371849
Niger,2017,Male,1,379195
Niger,2017,Male,2,364876
Niger,2017,Female,2,357854
Niger,2017,Female,3,346218
Niger,2017,Male,3,353096
Niger,2017,Male,4,342661
Niger,2017,Female,4,335875
Niger,2017,Male,5,333161
Niger,2017,Female,5,326517
Niger,2017,Female,6,317928
Niger,2017,Male,6,324342
Niger,2017,Female,7,309960
Niger,2017,Male,7,316150
Niger,2017,Female,8,302290
Niger,2017,Male,8,308270
Niger,2017,Male,9,300534
Niger,2017,Female,9,294710
Niger,2017,Male,10,291978
Niger,2017,Female,10,286720
Niger,2017,Male,11,280272
Niger,2017,Female,11,276129
Niger,2017,Female,12,263519
Niger,2017,Male,12,266473
Niger,2017,Male,13,253314
Niger,2017,Female,13,251532
Niger,2017,Female,14,240059
Niger,2017,Male,14,240689
Niger,2017,Male,15,228551
Niger,2017,Female,15,229057
Niger,2017,Female,16,218504
Niger,2017,Male,16,216888
Niger,2017,Male,17,205734
Niger,2017,Female,17,208390
Niger,2017,Male,18,195007
Niger,2017,Female,18,198649
Niger,2017,Male,19,184759
Niger,2017,Female,19,189273
Niger,2017,Male,20,174922
Niger,2017,Female,20,180240
Niger,2017,Female,21,171488
Niger,2017,Male,21,165534
Niger,2017,Male,22,156442
Niger,2017,Female,22,162934
Niger,2017,Male,23,147786
Niger,2017,Female,23,154649
Niger,2017,Male,24,140066
Niger,2017,Female,24,147046
Niger,2017,Male,25,133115
Niger,2017,Female,25,140036
Niger,2017,Male,26,127809
Niger,2017,Female,26,134542
Niger,2017,Male,27,123146
Niger,2017,Female,27,129562
Niger,2017,Male,28,118716
Niger,2017,Female,28,124656
Query:
SELECT DISTINCT `sex` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific`
Answer:
sex
Male
Female
Query:
SELECT `country_name`, SUM(`population`) AS `population_between_25_64` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 AND `age` BETWEEN 25 AND 64 
GROUP BY `country_name` 
LIMIT 100
Answer:
country_name,population_between_25_64
Nauru,4800
Suriname,307452
New Zealand,2332237
South Sudan,3533915
Peru,14888418
Pakistan,88163412
Poland,22197303
Panama,1810994
Portugal,5706340
Papua New Guinea,2928019
Palau,11904
Guinea-Bissau,592165
Qatar,1712971
Serbia,3968596
Marshall Islands,32126
Saint Martin,17801
Romania,12625016
Philippines,44782453
Puerto Rico,1710536
Russia,84139317
Rwanda,4386608
Saudi Arabia,17856952
Saint Pierre and Miquelon,3061
Saint Kitts and Nevis,29783
Seychelles,55640
South Africa,26563263
Senegal,5159226
"Saint Helena, Ascension, and Tristan da Cunha",4440
Slovenia,1187598
San Marino,18008
Singapore,3591535
Spain,27932340
Saint Lucia,87385
Sudan,14050766
Sweden,5080091
Syria,8045854
Switzerland,4596675
Saint Barthelemy,4282
Trinidad and Tobago,708709
Thailand,39897133
Tajikistan,3873844
Turks and Caicos Islands,31388
Gibraltar,14507
Grenada,56868
Guernsey,36433
Greenland,31264
Germany,44349440
Guam,79060
Greece,5985127
Guatemala,6554799
Guyana,340329
Gaza Strip,564141
Hong Kong,4376223
Croatia,2370999
Hungary,5445915
Iceland,175604
Indonesia,132844754
Isle of Man,46112
India,622057932
Iran,45759082
Israel,3787203
Italy,34273095
Iraq,14827590
Japan,62773685
Jersey,52899
Jamaica,1309577
Jordan,4283405
Kenya,18012182
Kyrgyzstan,2757701
"Korea, North",13648401
Kiribati,48692
"Korea, South",30714023
Kuwait,1648823
Kosovo,956986
Kazakhstan,9722270
Laos,3005458
Query:
SELECT `country_name`, 
       (SUM(CASE WHEN `age` >= 65 THEN `population` ELSE 0 END) / SUM(`population`)) * 100 AS `percentage_over_65` 
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific` 
WHERE `year` = 2017 
GROUP BY `country_name` 
ORDER BY `percentage_over_65` DESC 
LIMIT 100
Answer:
country_name,percentage_over_65
Monaco,32.20753793441018
Japan,27.87242257297938
Germany,22.060783990950593
Italy,21.53027878263219
Finland,21.09609883061505
Greece,20.91406240641086
Isle of Man,20.362551370827
Saint Pierre and Miquelon,20.332550153623714
Sweden,20.255666213911027
Malta,20.10520702790146
Portugal,19.92996776706771
Estonia,19.848655420623995
Lithuania,19.674884617114383
Guernsey,19.578358545607653
Slovenia,19.574705817410738
San Marino,19.56048543399827
Latvia,19.54600407375544
Puerto Rico,19.48438866325738
France,19.478061038240586
Croatia,19.308263214118046
Bulgaria,19.278913921123817
Austria,19.260137715686934
Denmark,19.16840869658749
Hungary,19.045229114862735
Czechia,18.97553688278375
Netherlands,18.725283102402795
Canada,18.62540590977687
Belgium,18.583010206115105
Serbia,18.428372622564627
Switzerland,18.147802478854892
United Kingdom,18.042930176404763
Spain,17.98418523049447
Bermuda,17.978098893655453
"Virgin Islands, U.S.",17.546705448036693
Liechtenstein,17.411881602342852
Poland,16.85532191283931
Faroe Islands,16.75931401537552
Saint Barthelemy,16.74554565701559
Norway,16.709125580704676
Hong Kong,16.52673995964404
Romania,16.412960595805835
Jersey,16.338526912181305
Ukraine,16.30451592789678
Australia,16.141672412590115
Gibraltar,16.087222751394748
Georgia,16.005444215064767
United States,15.614272181418807
Andorra,15.609904086252364
Slovakia,15.429606768776619
New Zealand,15.25250829928739
"Saint Helena, Ascension, and Tristan da Cunha",15.125191619826264
Curacao,15.102106276061155
Luxembourg,15.01742042987225
Belarus,14.952846394778835
Cuba,14.93842469374268
Montenegro,14.66633348964528
Bosnia and Herzegovina,14.42587886823777
Iceland,14.419259036871553
Russia,14.277849172949516
Uruguay,14.247259346909718
"Korea, South",14.115999674021559
Taiwan,13.719888033347019
Aruba,13.589298123697011
Ireland,13.073052594020238
Macedonia,12.9891808053869
Moldova,12.644838795194527
Cayman Islands,12.588764737085265
Cook Islands,12.16361679224973
Cyprus,12.08948638163512
Albania,11.890470661456233
Barbados,11.80798806852389
End Exploring Related Columns
Task: Which country has the highest percentage of population under the age of 25 in 2017?

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
Country_Name,Percentage_Under_25
Niger,66.03
(Attention: answer in one row)
```

In 2017, Niger had the highest percentage of population under the age of 25, with approximately 66.03% of its population being under 25 years old..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'census_bureau_international': ['age_specific_fertility_rates', 'birth_death_growth_rates', 'country_names_area', 'midyear_population', 'midyear_population_5yr_age_sex', 'midyear_population_age_sex', 'midyear_population_agespecific', 'mortality_life_expectancy']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-23 02:03:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 02:03:38 - root - INFO - ```sql
SELECT `country_name`, 
       ROUND((SUM(CASE WHEN `age` < 25 THEN `population` ELSE 0 END) / SUM(`population`)) * 100, 4) AS `Percentage_Under_25`
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific`
WHERE `year` = 2017
GROUP BY `country_name`
ORDER BY `Percentage_Under_25` DESC
LIMIT 1;
```
2025-01-23 02:03:40 - root - INFO - itercount: 1
2025-01-23 02:03:40 - root - INFO - 0
2025-01-23 02:03:40 - root - INFO - results: 
country_name,Percentage_Under_25
Uganda,69.1458


2025-01-23 02:03:40 - root - INFO - Please check the answer again by reviewing Which country has the highest percentage of population under the age of 25 in 2017?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Country_Name,Percentage_Under_25
Niger,66.03
(Attention: answer in one row)
```

In 2017, Niger had the highest percentage of population under the age of 25, with approximately 66.03% of its population being under 25 years old. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
country_name,Percentage_Under_25
Uganda,69.1458
Current sql:
SELECT `country_name`, 
       ROUND((SUM(CASE WHEN `age` < 25 THEN `population` ELSE 0 END) / SUM(`population`)) * 100, 4) AS `Percentage_Under_25`
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific`
WHERE `year` = 2017
GROUP BY `country_name`
ORDER BY `Percentage_Under_25` DESC
LIMIT 1;
2025-01-23 02:04:26 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 02:04:26 - root - INFO - ```sql
SELECT `country_name`, 
       ROUND((SUM(CASE WHEN `age` < 25 THEN `population` ELSE 0 END) / SUM(`population`)) * 100, 4) AS `Percentage_Under_25`
FROM `bigquery-public-data.census_bureau_international.midyear_population_agespecific`
WHERE `year` = 2017
GROUP BY `country_name`
ORDER BY `Percentage_Under_25` DESC
LIMIT 1;
```

```csv
Country_Name,Percentage_Under_25
Uganda,69.1458
```
2025-01-23 02:04:27 - root - INFO - itercount: 2
2025-01-23 02:04:27 - root - INFO - 0
2025-01-23 02:04:27 - root - INFO - Total iteration counts: 2
