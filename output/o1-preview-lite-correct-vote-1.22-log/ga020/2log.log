2025-01-23 14:41:57 - openai._base_client - INFO - Retrying request to /chat/completions in 0.400868 seconds
2025-01-23 14:42:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 14:42:37 - root - INFO - SQL:
SELECT DISTINCT event_name
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE event_date BETWEEN '20180801' AND '20180815'
   LIMIT 100;
Results:
event_name
level_reset
level_complete
firebase_campaign
os_update
in_app_purchase
level_complete_quickplay
session_start
select_content
challenge_a_friend
level_retry_quickplay
use_extra_steps
app_remove
app_clear_data
ad_reward
user_engagement
level_fail_quickplay
completed_5_levels
level_end
level_start
level_start_quickplay
post_score
screen_view
level_fail
level_retry
level_up
app_exception
no_more_extra_steps
error
level_end_quickplay
level_reset_quickplay
app_update
dynamic_link_app_open
spend_virtual_currency
first_open

2025-01-23 14:43:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 14:43:13 - root - INFO - ```sql
SELECT DISTINCT user_pseudo_id, event_name,
  DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp), 'UTC'),
            TIMESTAMP_MICROS(user_first_touch_timestamp), DAY) AS days_since_first_touch
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE event_name LIKE '%quickplay%'
  AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp), 'UTC') BETWEEN '2018-08-01' AND '2018-08-15'
LIMIT 100;
```
2025-01-23 14:43:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 14:43:33 - root - INFO - ```sql
SELECT DISTINCT user_pseudo_id, event_name,
  DATE_DIFF(
    DATE(TIMESTAMP_MICROS(event_timestamp), 'UTC'),
    DATE(TIMESTAMP_MICROS(user_first_touch_timestamp), 'UTC'),
    DAY) AS days_since_first_touch
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE event_name LIKE '%quickplay%'
  AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp), 'UTC') BETWEEN '2018-08-01' AND '2018-08-15'
LIMIT 100;
```
2025-01-23 14:44:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 14:44:56 - root - INFO - SQL:
SELECT DISTINCT user_pseudo_id, event_name,
  DATE_DIFF(
    DATE(TIMESTAMP_MICROS(event_timestamp), 'UTC'),
    DATE(TIMESTAMP_MICROS(user_first_touch_timestamp), 'UTC'),
    DAY) AS days_since_first_touch
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE event_name LIKE '%quickplay%'
  AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp), 'UTC') BETWEEN '2018-08-01' AND '2018-08-15'
LIMIT 100;
Results:
user_pseudo_id,event_name,days_since_first_touch
A976A39B8E08829A5BC5CD3827C942A2,level_complete_quickplay,13
A976A39B8E08829A5BC5CD3827C942A2,level_end_quickplay,13
B2D359D114428D8DD085DFAFF11195CE,level_retry_quickplay,13
57EC50FBC6C7277B8EDCCE44C1352BD4,level_complete_quickplay,19
E0664E9E7883956A6E3084FD68AA274B,level_complete_quickplay,15
E0664E9E7883956A6E3084FD68AA274B,level_end_quickplay,14
B529E84EE03C578C7E92CE5836AB1C1D,level_fail_quickplay,10
9FCA0F0AF9D385AB53DD8742397B25ED,level_start_quickplay,18
D8F0003FCBEE71C9DDA3B5E7F71E2E87,level_fail_quickplay,15
B2D359D114428D8DD085DFAFF11195CE,level_start_quickplay,16
C679FF00E17790E7E16AB903212EE05C,level_end_quickplay,18
C679FF00E17790E7E16AB903212EE05C,level_start_quickplay,18
82F141D1C5A86CB8F5F4DFC7E09E5513,level_end_quickplay,24
7D50D96761E1353DED4D2C8DC3384A37,level_start_quickplay,46
359A34F575B808FEFE58BC5B40816F09,level_end_quickplay,40
359A34F575B808FEFE58BC5B40816F09,level_start_quickplay,39
359A34F575B808FEFE58BC5B40816F09,level_start_quickplay,40
EEED36297DE224E3E34468ECB0BA7AF5,level_fail_quickplay,40
AC4C761C946B5E45F9A040FED66576D0,level_end_quickplay,46
AC4C761C946B5E45F9A040FED66576D0,level_complete_quickplay,46
C6D97C0D6DA580A6FDB44BB2C3015A85,level_end_quickplay,8
7CC61FB109657777ADD59480BC290F29,level_fail_quickplay,12
F7292D95AC282F0F0B7E82EDED18F599,level_complete_quickplay,12
E0664E9E7883956A6E3084FD68AA274B,level_start_quickplay,10
0DB2864E7EC7D29DA4EC1540FFDC419A,level_complete_quickplay,17
B087A865A90AD52D1864A36482983BD2,level_fail_quickplay,18
AC14799A5E8C340D6CADCBAE72037D81,level_reset_quickplay,26
82F141D1C5A86CB8F5F4DFC7E09E5513,level_end_quickplay,23
E0664E9E7883956A6E3084FD68AA274B,level_end_quickplay,17
E0664E9E7883956A6E3084FD68AA274B,level_fail_quickplay,17
5ACF1A6BFE350F7BB661BF389AF7E2F0,level_start_quickplay,29
AC14799A5E8C340D6CADCBAE72037D81,level_start_quickplay,35
459FD97ABE14D7762CD58C3A3104D183,level_start_quickplay,29
D4DDA67EF184AFBC5E2D52FBDEDD7837,level_fail_quickplay,25
DAD23DD885EEE844890417FC965052F0,level_end_quickplay,23
E8950841C7635FFAE97EE03DE2A92072,level_complete_quickplay,25
8F41FC08B49819D339D864572A1CA136,level_complete_quickplay,24
EEED36297DE224E3E34468ECB0BA7AF5,level_complete_quickplay,27
EEED36297DE224E3E34468ECB0BA7AF5,level_start_quickplay,26
D4A45A0CA838C439F64D565450B9A7D6,level_start_quickplay,4
38D65030548914B5E167CE85B035CA8F,level_complete_quickplay,0

2025-01-23 14:45:03 - root - INFO - SQL:
SELECT DISTINCT user_pseudo_id, user_first_touch_timestamp
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE DATE(TIMESTAMP_MICROS(user_first_touch_timestamp), 'UTC') BETWEEN '2018-08-01' AND '2018-08-15'
LIMIT 100
Results:
user_pseudo_id,user_first_touch_timestamp
F3A2F44C99758CC6006BFE28AC78EBFE,1533780422392000
F89FB7FA61F2B6CAA3679E739CAB2477,1534265080102000
D75565A913EE0D3AB4E50643A86CCE7D,1534133239638000
F454E0D882BF2C7E1E0DF7F96DF78F3B,1533201985309000
F4EA0F2888792BD62555AD46ED534839,1533140322832000
E1A3C786B2E4D56629EE808A3A174995,1533422394271000
4F7248CFE9A405BBD16E16EF2B0D3473,1533716592979000
8F9D2E21E1B2D41941545BAD0182F182,1533736723496000
717636DB6BB28A28CD06680B18ACE076,1533716352902000
38C4E3FBD09FA68179F2DE3F133D942D,1533673531578000
54506E5CFFDC0AFD69A379427447BE95,1533739160559000
370BAFBB7AFD77B12726F4712DB42DF8,1533712395044000
9C82775812A959D5A1446FDA75CC2C88,1533775929858000
73E94C02345779D2299155829DF524E9,1533739388041000
55F725AB1CC8281CDAC2FFEDC35423F4,1533756653084000
210C3692734E251EEF4E952BC57DD998,1533160438590000
E1CA3A181B0EBFCF0E8DA26EBEF7DFC6,1533562516320000
0DF6A14F536F6514A6F18BC12A532A82,1533345487556000
D3147C34750B3B6DDBF2382678BAC86D,1533549271156000
AC4C761C946B5E45F9A040FED66576D0,1533407007334000
4593E981ECEF849FC7DA0F7FDA0F250E,1533119429750000
270BB513258E82FEB9BB23091073E82D,1533186025918000
AB48D576008899542044F575FF8DF525,1533191244838000
43B8EEA09D7D62EC90F40D0E3716E960,1533105623504000
9991D4763C564343D9B899E4BEA9D4F8,1533147975691000
6C31CA4020CECC2B055E465813E2C541,1533182083020000
9272B4C8E7F4F0364558B43B977990D0,1533137209809000
4FCB0434161F0EE1E92046C850A90DD1,1533569000872000
A153C00220FEE4D83DF879F7D5A6CB07,1533583626149000
1010A9A4D76FDDAB3C456113CC4E6C95,1533586697700000
7432B1A3C0CB18E6BA5E0F14F1105980,1533261856075000
76F4F164AEBC9FBC1198E2BF42AC2F77,1534088628259000
310D44D95961BF9754C9948AF6F437EA,1533198529541000
96B108514A10609B9E8F4F78B47B6776,1534364313386000
ED5C290C8F82C28C033482D31299D8CD,1534253696287000
250BB57A7B602E74E169896CD19C8504,1533965510992000
6344D6DD4B7741E868D17A8CC19E03C8,1534014971342000
8BF7E118BDC4D008D6B28FCCEDC38083,1534007703437000
3CE1655CEC10EC3111E5A5A7B267C017,1533998026540000
EC9CF53549FB38AAE4906989B4B050E4,1534027135443000
B2912116E7B957900D6B69D4E50F0F9A,1533101297682000
336BDA268CA6379F6EE567B4C16A1090,1533222430431000
BADBF9D1D46555F52F506538DB8C3011,1534199326738000
C175523CE4F5BB5E65A4EC3CF6B1345C,1534215660691000
7F7DD65D0E41B3A00DB98B07B60264CF,1533349331498000
C9E1BDDF758FECF6F07DE045B1FFF1A3,1533281285260000
E90B98235AB244B2A25A73706E2FC370,1533265554521000
3D7382CF3E5091189D2961E0EA3A2ACE,1533670977945000
D5544C064404DC6067412B1272F848D6,1533472860789000
335156392A0F885ACF5A91CE029E159D,1533812810377000

2025-01-23 14:45:09 - root - INFO - SQL:
SELECT event_name, COUNT(*) AS event_count
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE event_date BETWEEN '20180801' AND '20180815'
GROUP BY event_name
ORDER BY event_count DESC
LIMIT 100
Results:
event_name,event_count
screen_view,302996
user_engagement,169570
level_start_quickplay,66339
level_end_quickplay,42845
post_score,32684
level_complete_quickplay,27107
level_reset_quickplay,17797
level_fail_quickplay,15738
select_content,13930
level_start,10866
session_start,9412
level_end,7964
level_retry,6779
level_up,5577
level_complete,5499
level_retry_quickplay,3671
level_fail,2387
spend_virtual_currency,1415
use_extra_steps,1366
level_reset,1276
firebase_campaign,1060
first_open,728
app_exception,672
app_remove,439
no_more_extra_steps,351
os_update,343
app_update,324
completed_5_levels,311
error,241
ad_reward,217
challenge_a_friend,89
in_app_purchase,4
dynamic_link_app_open,2
app_clear_data,1

2025-01-23 14:46:07 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 14:46:07 - root - INFO - ```sql
SELECT DISTINCT user_pseudo_id, event_name
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE event_name LIKE '%quickplay%'
  AND event_date BETWEEN '20180801' AND '20180815'
LIMIT 100;
```
2025-01-23 14:47:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 14:47:13 - root - INFO - SQL:
SELECT DISTINCT user_pseudo_id, event_name
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE event_name LIKE '%quickplay%'
  AND event_date BETWEEN '20180801' AND '20180815'
LIMIT 100;
Results:
user_pseudo_id,event_name
B4653EE7AA5AB38E47F66AAE2F708BD9,level_complete_quickplay
276EA0F867FD5E24356C984081FA959F,level_complete_quickplay
57EC50FBC6C7277B8EDCCE44C1352BD4,level_start_quickplay
E920D72AFB16365797955E46913E2599,level_fail_quickplay
D0F280B12652EB0D74F6BC74AB13606F,level_complete_quickplay
D0F280B12652EB0D74F6BC74AB13606F,level_end_quickplay
D34924C19421D7E083FD387D97765F94,level_start_quickplay
475B281839C403CCF826D0D44890BFA5,level_start_quickplay
CC0EF7F0565D2D90455B2B2E416609B8,level_fail_quickplay
7E832B95E7313AD2E9F24D9D2AA33E97,level_fail_quickplay
D5F25FE843F01514F448B1AA94028D2D,level_end_quickplay
4A93C01615B33FF5804AF8D19895247F,level_end_quickplay
C1BDCF7765C5EDD7643D476B84BD2B30,level_fail_quickplay
61F5B317AB1EF10E3C7E68C930A1018C,level_reset_quickplay
2AC0EF5047BC538BDA6388E644409B5D,level_start_quickplay
A8D7DCCA39D8703F2928AD2D7BBB6BE9,level_complete_quickplay
F4634EFF4D9470DCA00051E3304B81AF,level_complete_quickplay
67D3D76504CC5C4CBFC78EE4FC397C8B,level_start_quickplay
CCE1B466B4C26A8190A10FD0D7A9402C,level_start_quickplay
97533889633426FCBD7C424143F2A869,level_start_quickplay
359A34F575B808FEFE58BC5B40816F09,level_complete_quickplay
959635567E419A061EECCCA478EDC718,level_retry_quickplay
BE36C49B1AB3968D420923AEC4FDD7AE,level_end_quickplay
9E29F60A2AC264DFAB9AD5A7D9B0455F,level_start_quickplay
67C46D47D98A618D1124FA4CA727C19B,level_end_quickplay
2F48607C41ECC4015FA296500F0A2C4B,level_complete_quickplay
7CBF44EFDDB9E6401F31786BEE071196,level_start_quickplay
D81B390EB1BB12AB50085C9675367308,level_fail_quickplay
91A06057C6272653B6006D7A8791DF81,level_retry_quickplay
56F37FD95FB21AB3976C83E803D7AEA7,level_start_quickplay
0B427C5E490A982FADF586F82E797ACB,level_complete_quickplay
7CF3B98BA255D1BAEBCC34B9B876439A,level_start_quickplay
CA51DAF1373B5C2A16C174AFBD2132A4,level_fail_quickplay
5EE0642EFFD04FFBBAE5ADBF64876D83,level_fail_quickplay
53C62BFF7D715334B8C3C4904EC34880,level_fail_quickplay
3DEB0C12C49AD19D7ACE68FA59E7ACD6,level_end_quickplay
D5F9D9AF22EF5073E10342973D48FB2C,level_start_quickplay
BB29F8B0FF330F326605FA421BB37BC1,level_complete_quickplay
E66C3B8A38C424C7CBE0B5388EE5F77E,level_complete_quickplay
AED716F2A571507087AF004F331D9949,level_reset_quickplay
CEE2B7FC14A535398A13AF03AC95EF96,level_end_quickplay
DAA3F353F320A717A0C418A8205292B2,level_start_quickplay
343B740C7B3BD9C2CFA46BF097A8856E,level_end_quickplay
D48F1681EB572CC9F7EB6BC7958646FD,level_end_quickplay
328DC7FE55E8881B2EA668C9A2855BB7,level_fail_quickplay
3DF2D70B5C3E5DA6CCE82B37E8275632,level_complete_quickplay
3DF2D70B5C3E5DA6CCE82B37E8275632,level_fail_quickplay
59454BAC415BB1F18517C6FD2C023E49,level_complete_quickplay
59454BAC415BB1F18517C6FD2C023E49,level_retry_quickplay
D6F5820E5B2C721C1677E1BC873B074A,level_end_quickplay
49309C5759610DBF6C829C0D4AB23943,level_reset_quickplay
44759496F6F519B1A4BEF55BE55C631C,level_end_quickplay
84D4A14B2F6F8A8AF3DF58E6C67A79D5,level_start_quickplay
472451071AED6FF801BC0FE66706FD27,level_complete_quickplay

2025-01-23 14:47:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 14:47:37 - root - INFO - ```sql
SELECT DISTINCT user_pseudo_id, ep.key, ep.value.string_value
FROM `firebase-public-project.analytics_153293282.events_*`,
UNNEST(event_params) AS ep
WHERE event_name LIKE '%quickplay%'
  AND event_date BETWEEN '20180801' AND '20180815'
LIMIT 100;
```
2025-01-23 14:48:44 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 14:48:44 - root - INFO - SQL:
SELECT DISTINCT user_pseudo_id, ep.key, ep.value.string_value
FROM `firebase-public-project.analytics_153293282.events_*`,
UNNEST(event_params) AS ep
WHERE event_name LIKE '%quickplay%'
  AND event_date BETWEEN '20180801' AND '20180815'
LIMIT 100;
Results:
user_pseudo_id,key,string_value
525E3BEE74AD824923CC04FE45E45B40,board,S
BB5383D0C13918205EC27BEC707E1152,value,
CB284BFA662EC30C6D96E32278213CD4,value,
15955C2770D8FE60B329BCD0805BB35E,board,S
59483477E9365F4C9A834CD88B37BA41,firebase_event_origin,app+gtm
980DEC5BA17132A841D7D7A140333114,value,
980DEC5BA17132A841D7D7A140333114,firebase_screen_id,
FC2DDF0F37BB211D565307010B1B30A1,firebase_screen_id,
39BE7CAB9B8602ABD10A1BFB4E66BBB2,value,
909A16079F7183140ACF4C71A6CCDF3D,firebase_screen_id,
B99FD965B0874192EE94E8A8FE85EA9E,value,
0440FFD9E8480E870EA2C22C5F54648D,firebase_event_origin,app+gtm
6A2F4E7AB1816D2F6EC741BC92141766,firebase_screen_id,
C66BF8A9ACA5CD56597E18B0729181C4,value,
0E05F56141200FF41FCC0C7FA297FF08,firebase_event_origin,app+gtm
0ED6BC1D319AB5BD1F245628EA47EDBB,firebase_screen_class,AdActivity
A421EBCE8AA69A980AAFC4F141BDEFFB,firebase_screen_class,game_board
A421EBCE8AA69A980AAFC4F141BDEFFB,firebase_screen_id,
EDE016882F21502CDE760922CD8DC0B5,value,
44A600997B9B6499325D518A19B51FEC,board,S
44A600997B9B6499325D518A19B51FEC,value,
BFC4C22D2C9FF3D314BC4F1D86E92044,firebase_screen_id,
3DEB0C12C49AD19D7ACE68FA59E7ACD6,board,S
6E0CE4D9DE17F3D771906937B9ED37FD,firebase_screen_class,game_board
920DB84FCC0F4421650B9E257E33180B,firebase_event_origin,app+gtm
C052BC38A0F39A40678E5AF5E7C84B77,board,S
C052BC38A0F39A40678E5AF5E7C84B77,firebase_screen_class,game_over
D5F9D9AF22EF5073E10342973D48FB2C,firebase_event_origin,app+gtm
BD23A737D75442D2C32CE2259D15D624,firebase_event_origin,app+gtm
FEDC59699D8832A11B88BFCCCAD0951D,board,S
D7EA8E3645EFFBD6443946179ED704A6,firebase_screen_class,game_board
734AC9568F0674F7BBE59D45B5B90EA7,firebase_screen_class,game_over
475B281839C403CCF826D0D44890BFA5,firebase_event_origin,app+gtm
475B281839C403CCF826D0D44890BFA5,firebase_screen_class,game_over
8EDB9A9856CDB5AFC42546106EE46734,value,
8EDB9A9856CDB5AFC42546106EE46734,firebase_screen_class,game_over
8F69F63C94FC7045651B1B164AE7B379,firebase_screen_class,game_board
CA04708DA02378999ECB402481FF1AE4,firebase_screen_class,game_over
B5C5E0E0C3984E096C77B2A34AEE0BA7,board,S
3D03A380687FE3369E93915D50C572CB,firebase_screen_class,game_board
635808C1DDFBC662DC3015097E26E62A,firebase_screen_class,AdActivity
AC14F9B5C6CA275BA54C2C0ABDC087F5,firebase_event_origin,app+gtm
932AAF56DDE9C55359B9CCFA18E7FB95,board,S
932AAF56DDE9C55359B9CCFA18E7FB95,firebase_screen_id,
E512079B53179DF9A608CF4ADE47DE9D,firebase_event_origin,app+gtm
1D763A3E95386CEEF80C5174E6216F8C,board,S
424C01CD3ACB4454BB6B2D2899511997,value,
C3A2E093D521D3F6AF2C54A7860CF68F,firebase_screen_class,game_board
021E703A207ECD0CC248918F28426D95,board,S

2025-01-23 14:48:51 - root - INFO - SQL:
SELECT DISTINCT user_pseudo_id, event_name
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE event_name LIKE '%quickplay%'
  AND event_date BETWEEN '20180801' AND '20180815'
LIMIT 100
Results:
user_pseudo_id,event_name
B458770ED6E295374FEEB3A68902CC28,level_start_quickplay
27293EA0B2F41A672E15EF7B1FA21298,level_start_quickplay
EE99F8CB32999A0FDAABBA18B05D4E48,level_end_quickplay
2B5ABA17A30D32531C09DAF2865F9E55,level_complete_quickplay
EBC3581ADA874D494FBE2C7CCF53BF99,level_complete_quickplay
EFB696A82D093B3AFBE92FF526DD5CEA,level_complete_quickplay
91814809BD9374D5CEDFC6A31727CC55,level_start_quickplay
377303AA2F5C5C80E5AAAD26C029BD5A,level_start_quickplay
CC81C3C01DE545318860C5BFDC6AD31E,level_end_quickplay
EC1A759709685E136767F2C1BA4751ED,level_start_quickplay
46D808E730894AB0AC6E0F493B6FC864,level_start_quickplay
372D9BB5088C4E9000C65B06459B403A,level_start_quickplay
C60EACB47CF25AEEFD16C5E332078852,level_start_quickplay
CA51DAF1373B5C2A16C174AFBD2132A4,level_end_quickplay
6683CAFB77FB7B60C78CD233EB2B62F7,level_complete_quickplay
84E491A60BE52A4C6A438A89FADE283C,level_end_quickplay
84E491A60BE52A4C6A438A89FADE283C,level_fail_quickplay
A7AAA5EF977926DBCF801D15F83EE4A5,level_complete_quickplay
A72750663D0181C7817F61B3DD2CA656,level_complete_quickplay
FDA4BBBCF1EA2D95CDD77BFC5F00A837,level_start_quickplay
2BFF75BDF9645D51E99CE5148F4847CA,level_start_quickplay
8065F8E98407106A65D35195984B2258,level_end_quickplay
E643F6549E6C7EA0FD01EF4BF7A40F76,level_end_quickplay
2F4A6CF5C60E72BC578CA0E5189505F7,level_start_quickplay
76690E22DDCE2B1FFA98C6A4376B8EA2,level_fail_quickplay
674EAE8D70D203FEDBE60DEAE2F834CC,level_complete_quickplay
674EAE8D70D203FEDBE60DEAE2F834CC,level_end_quickplay
674EAE8D70D203FEDBE60DEAE2F834CC,level_fail_quickplay
01C784BDB7AF4DC8DAD6DCD21AF56E25,level_complete_quickplay
5A7EB17BF7D867AADECA2FDAF0941E88,level_end_quickplay
06A302E3A4767793ADBC884143708660,level_end_quickplay
E9DCE2D958652BD58E846DCE86BDD90A,level_complete_quickplay
E9DCE2D958652BD58E846DCE86BDD90A,level_start_quickplay
12E5626928FE0885DEEF068683E8BD63,level_complete_quickplay
C1A0D9FB3527654CA715A732B5FB5202,level_fail_quickplay
827848D9C0FD18D44110098CEC982CDE,level_end_quickplay
53717D02C147929860D981CD68CE2D9A,level_start_quickplay
53717D02C147929860D981CD68CE2D9A,level_end_quickplay
4593E981ECEF849FC7DA0F7FDA0F250E,level_start_quickplay
4593E981ECEF849FC7DA0F7FDA0F250E,level_reset_quickplay
C74B58C4CD2770A1E97D6DC13D42CCAC,level_start_quickplay
C74B58C4CD2770A1E97D6DC13D42CCAC,level_fail_quickplay
B99FD965B0874192EE94E8A8FE85EA9E,level_complete_quickplay
3EF8FC940E379D53BBD3FEFDAF626BB2,level_start_quickplay
35CF08DA631AC27582D6A0FE710131F7,level_reset_quickplay
B83E97CDE1FCF1D681206DFFC5F1898E,level_retry_quickplay
28C4A09298C441D5AFD39E749D9F3DA3,level_end_quickplay
44A600997B9B6499325D518A19B51FEC,level_start_quickplay
F5DAD8DD17B689CF672D65A0A81CF4AC,level_start_quickplay
A1FA05C0618ED3CB04CDB44FBE35DDB6,level_complete_quickplay
A1FA05C0618ED3CB04CDB44FBE35DDB6,level_end_quickplay
EBE661044C1949546986A852F35083A1,level_complete_quickplay
85DB15BDADAB65F9CC1E33B872745B87,level_end_quickplay
E5D16173400729E05DFFB4883FA6EF1C,level_fail_quickplay

2025-01-23 14:48:57 - root - INFO - SQL:
SELECT user_pseudo_id,
     DATE_DIFF(
       DATE(TIMESTAMP_MICROS(event_timestamp), 'UTC'),
       DATE(TIMESTAMP_MICROS(user_first_touch_timestamp), 'UTC'),
       DAY) AS days_since_first_touch
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE DATE(TIMESTAMP_MICROS(user_first_touch_timestamp), 'UTC') BETWEEN '2018-08-01' AND '2018-08-15'
LIMIT 100
Results:
user_pseudo_id,days_since_first_touch
2381980E778280D6A575BDA13B563B72,44
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
609EDE15DFE17B9241415C5216D10BFC,54
609EDE15DFE17B9241415C5216D10BFC,54
609EDE15DFE17B9241415C5216D10BFC,54
609EDE15DFE17B9241415C5216D10BFC,54
609EDE15DFE17B9241415C5216D10BFC,54
609EDE15DFE17B9241415C5216D10BFC,54
609EDE15DFE17B9241415C5216D10BFC,54
609EDE15DFE17B9241415C5216D10BFC,54
609EDE15DFE17B9241415C5216D10BFC,54
609EDE15DFE17B9241415C5216D10BFC,54
609EDE15DFE17B9241415C5216D10BFC,54
BB4B7F8EB20FC2E38E2891C3052E7229,53
BB4B7F8EB20FC2E38E2891C3052E7229,53
BB4B7F8EB20FC2E38E2891C3052E7229,53
BB4B7F8EB20FC2E38E2891C3052E7229,53
BB4B7F8EB20FC2E38E2891C3052E7229,53
BB4B7F8EB20FC2E38E2891C3052E7229,53
BB4B7F8EB20FC2E38E2891C3052E7229,53
BB4B7F8EB20FC2E38E2891C3052E7229,53
BB4B7F8EB20FC2E38E2891C3052E7229,53
BB4B7F8EB20FC2E38E2891C3052E7229,53
BB4B7F8EB20FC2E38E2891C3052E7229,53
BB4B7F8EB20FC2E38E2891C3052E7229,53
8680E9C6F3ABE3B95FCF44EA5D7DB200,54
8680E9C6F3ABE3B95FCF44EA5D7DB200,54
8680E9C6F3ABE3B95FCF44EA5D7DB200,54
8680E9C6F3ABE3B95FCF44EA5D7DB200,54

2025-01-23 14:49:04 - root - INFO - SQL:
SELECT DISTINCT user_pseudo_id
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE DATE(TIMESTAMP_MICROS(user_first_touch_timestamp), 'UTC') BETWEEN '2018-08-01' AND '2018-08-15'
  AND DATE_DIFF(
        DATE(TIMESTAMP_MICROS(event_timestamp), 'UTC'),
        DATE(TIMESTAMP_MICROS(user_first_touch_timestamp), 'UTC'),
        DAY) BETWEEN 8 AND 14
LIMIT 100
Results:
user_pseudo_id
E0664E9E7883956A6E3084FD68AA274B
B529E84EE03C578C7E92CE5836AB1C1D
59772415A60A0B7E16588D219D7B85F1
383F4B98EC31DD2A915427D36A30354E
C6D97C0D6DA580A6FDB44BB2C3015A85
1FEB41A72F244D352EA79982CC259EA0
90315F3CE85BB427F960EF2F78972EA6
D0E006B5E441969283C94713E308A11D
84F55D39B331B4D51467A32FECD5F0A5
D5544C064404DC6067412B1272F848D6
1AE6C4E5DFF6715503FC7C79A7C0C363
A976A39B8E08829A5BC5CD3827C942A2
B96742012753A7FC58537387657DED5A
8F69F63C94FC7045651B1B164AE7B379
81A07F200581534596EAE948BDEE015E
5E3CBF1204F069C8F4474D492A361CCD
4A8D4276A1EBBD17E6CB7EE30FE71CC2
0DF6A14F536F6514A6F18BC12A532A82
F5B3C520B6C16AEF201A60393DD5AE91
378D3B51D99A076B2E978EDB669581D0
9C4FD2B8EFBE7F68A56C522FF0C52491
C3CF8D010A218064A32EC45C3F446B2E
88E99CE30B65345ED0B118869B6AD035
276EA0F867FD5E24356C984081FA959F
7D9E4CD01C4E4F1768A0DF5CDFDD7753
45FB547C5857493104687C234EDCDE37
1814CCF8B0BD30480C6D375743010FAE
F4EA0F2888792BD62555AD46ED534839
43D27F6D77E6A3B68872B6786AD0DAB4
A62D86FAFF43F1EC89D6F867915D7D56
3C24334270603160F1C27BAAC3B9B714
6870FFBF31EA0EC710FF2A8A867B99DF
62E1AFE2AD1BED1937E861582EB84BE8
BFE99B51F316372640BDD14B9625C0F2
E730097121F6790373D1BBCA545FD946
B2D359D114428D8DD085DFAFF11195CE
5C17C05950C71938CFA82EA7C517748B
BB322D2CA948F548EA3A05A2BD93B1A3
F454E0D882BF2C7E1E0DF7F96DF78F3B
7DC72A0249398C477779B804F1EA3454
88AD03F6828BDD86AA72AA556D87387B
DF2FC56E807EAF16E852AEAB67E0127A
EC895C732092BA9A3CE9F507ED888726
310D44D95961BF9754C9948AF6F437EA
A6A77DA8F2C4102A83EED1D5216EB318
39C210B833FE2D53C723E354AB1FAC4D
D75565A913EE0D3AB4E50643A86CCE7D
E0189D91AD0A138AA65CB66338B82161
16C1832522326ACE532DC54C9C82D49C
A64D09F4DE2FB21E17EE29D7B77081EB
4091F647A1B6367AC7945DA0917CDA7D
3A1B5A55C33A7EF1A37C909A753606B8
4E6F4A73B5D05B33DC73B11547E39004
210C3692734E251EEF4E952BC57DD998
03B685883D78D1DB9F67A86635F9D788
51F21B36EB9D6FF7B5D7ACB89FF62B03
7439CA3E049F434742CB5C63A55FC24D
019FCC6C080A33E9B697CAA476C4156E
CE24B98FDB40DFD8FA769844135C2852
DAD23DD885EEE844890417FC965052F0
F7292D95AC282F0F0B7E82EDED18F599
E1CA3A181B0EBFCF0E8DA26EBEF7DFC6
17636078D57884AD7EA5406C60E2BD10
A0903E7042C13251799B68B16FD1EBA6
4CC453DA57531954D7C053B93A20B5D0
67D3D76504CC5C4CBFC78EE4FC397C8B
5BFDC0426DE9C09CA5FF18E4982F2506
01A2CCF65B4BB5DF87B1F9177616C5AF
F0945E5A97F876E9C084AC260BA4A6F1
B2F661E88136265632545A030F09A88A
2E1CBCBC408A270FE9B39E79958C28FB
C0D247C7C087F68E0504E5B5E5BBFB11
5C4773A411EA7DA0CE90122B51F37E5D
1845E883F5E20391CD3BD68F488A3C5E
359A34F575B808FEFE58BC5B40816F09
6C40A2B1B7C2336EDCE4B9F346682A72
29D576429D004584017D0A0FE1601455
FE5DCCE817A179E9E89DECF8406E4D97
B087A865A90AD52D1864A36482983BD2
0AFE3DE6A443BD660CDD5B1FA36686F6
38D65030548914B5E167CE85B035CA8F
058AE4BB2F67DEA4C6ACAA22AEB71BF2
F89FB7FA61F2B6CAA3679E739CAB2477
3D7382CF3E5091189D2961E0EA3A2ACE
27D0B01EBF8B78EA0B61171428EFD542
59FBC4CB04E905D3C1E7548C67392E1A
0DB2864E7EC7D29DA4EC1540FFDC419A
57EC50FBC6C7277B8EDCCE44C1352BD4
30C9F1FCEBB2E40593350BBB662344E7
DB6EA53027EF973B908E170B76755C2D
E920D72AFB16365797955E46913E2599
7A4FEFDB59BC17432C70DA5781EEFDD1
B7D2B63ABE215157570ABD2E2E6EC9BE

2025-01-23 14:49:53 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 14:49:53 - root - INFO - ```sql
SELECT DISTINCT user_pseudo_id
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-08-01' AND '2018-08-15'
  AND DATE_DIFF(
        DATE(TIMESTAMP_MICROS(event_timestamp)),
        DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)),
        DAY) BETWEEN 0 AND 14
LIMIT 100;
```
2025-01-23 14:50:35 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 14:50:35 - root - INFO - SQL:
SELECT DISTINCT user_pseudo_id
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-08-01' AND '2018-08-15'
  AND DATE_DIFF(
        DATE(TIMESTAMP_MICROS(event_timestamp)),
        DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)),
        DAY) BETWEEN 0 AND 14
LIMIT 100;
Results:
user_pseudo_id
A6A77DA8F2C4102A83EED1D5216EB318
D75565A913EE0D3AB4E50643A86CCE7D
E0189D91AD0A138AA65CB66338B82161
39C210B833FE2D53C723E354AB1FAC4D
5C17C05950C71938CFA82EA7C517748B
89C1D9AF4193728E41F48DC623DEE51F
BB322D2CA948F548EA3A05A2BD93B1A3
B6E6FA98F04FE22CC272DB5183B48763
8D76B80E2CCAE0EDD0F2D50D1ABCC0B3
146B1C215275774027FAEF96E5AA3713
71760E83C4579A53FE11B8C808677711
336FED02BA10D201C1B88C1CECB2E9D1
2CCA4395A5281BAC61DD7C846837F50B
A64D09F4DE2FB21E17EE29D7B77081EB
7432B1A3C0CB18E6BA5E0F14F1105980
B2D359D114428D8DD085DFAFF11195CE
16C1832522326ACE532DC54C9C82D49C
3151F3461C50299BC4F328702654F9C5
4091F647A1B6367AC7945DA0917CDA7D
72FC15A9C0E3262CFCF42B619ECF3774
DABD5F8DD42B23039CE6055C9C93E50F
0A7AAC29C353686D279F1752D120A53F
4E6F4A73B5D05B33DC73B11547E39004
3A1B5A55C33A7EF1A37C909A753606B8
7C14D1AD9F8CAC89B3ECC681C500D50D
EE2010FFDAF663BCC722160AB9954A1E
F27F046DF960AB50CE65B9F4364C981E
1D89281562AC3FEFB76A42ED406BF1B5
F454E0D882BF2C7E1E0DF7F96DF78F3B
7C8D8B75790229C5B05F6D31E9BE6254
ABF3E5FB92EF4F36B295E43812F8CD04
171871CA6AF9A891FB7B3E19CD144B2E
43B8EEA09D7D62EC90F40D0E3716E960
7C7C8524146AA5006BE260A041101DF3
C59286E780962666D2A9C13A478542C8
7CB9FDA17938289CE3019602888EEC58
310D44D95961BF9754C9948AF6F437EA
741158B569CC8819D22360847628CA7D
12D15CA29CFE3CBA400CE28F31CDFEFC
CC8DFD648FF20954F47DA8DFD9AE58B5
E67E5D7AF8E668290F7BAEBE7A7683B7
988E20C1031C6FA5301C7D2FBD90A4BF
ECC86F55D599ABD6E88F68C3E7CF53CC
C006BDD387158B17AD45F2BC0F346048
C8E20454CE52ADC3197F86EAE910BD5C
45DF5BA054826C546308F865405709B3
2B5D7D51F2F3BCC0B01B60FF5E37A255
30138B542CDF56A289C3B3059EC03D5E
C7B4A196FEDE305ADF8ECAE47820A5C0
DF2FC56E807EAF16E852AEAB67E0127A
E79B4E11B6B31650841081E4EC76C0FD
D7987E1129FA0207F04061FF4700BC6E
0CFD16A46A05B5BD29D3A37284B94CBB
CAD42025ACBC42A48B3500AB25DA7E35
BC4BF50150618EF80F3F62D886CF20B9
EC895C732092BA9A3CE9F507ED888726
88AD03F6828BDD86AA72AA556D87387B
567422321BBB432EC2CC014A510E61BD
DBA105E7A2FDD3D01E3D719BDE49069A
BDCB9DF32FAD5A3701822466CDE6CD0A
7DC72A0249398C477779B804F1EA3454
62440E2EC0A24E9FB2CF09E230FFDEC4
8BC72D1925A8866050D5A6FB01148518
BC575A719C37E1C2237B79FE7FD3F7E1
C7FE9CCE94D88A610CDB2C53D3004AF0
2D23CD90AE51556D7B8FAD2C358D308A
8831528D3CCC3AF25C1001256C389428
AE5C3CFC7F5F1225DC2E5190DF8CE3E6
DA4BCFC16C1735AFFAD960E8B9064525
DA814428F7E26F091284C8793DE748BD
1BA8A3FE9D6AD54C6C77BC8A350BF2DA
EA60D1DFDD9E06777E874E280C6417CC
E11BE37FB066E143A0B4C29D2842223A
7FBA8F50097D2948AEA898B7AFA3B72A
362C4170BE71B71630D1C7790927BD4C
162DCBBB07A1E42728E66853A66556B5
346CD6014841FFAB8A094411970DDD9E
2B6D0DB9D76C581ACB986BBE2408220C
1AAA1DF04F833632645A01D5B1C282CA
DC7B46EBC100B639364CC9789DE001B0
85BA81CA205F8D8F786495ED93FE3F92
103A2011A9093A6E5D9AED85C81FFEC7
918AB13390C2B040E4B0D5086EBF3349
AA6C185B662F56BA9006BDA50DF5E142
5646899D197E5F36BA6CE0E08456B026
A976A39B8E08829A5BC5CD3827C942A2
0DF6A14F536F6514A6F18BC12A532A82
9C4FD2B8EFBE7F68A56C522FF0C52491
F5B3C520B6C16AEF201A60393DD5AE91
AEEFEB2B840AB521A60BDFB354D06F32
5E3CBF1204F069C8F4474D492A361CCD
378D3B51D99A076B2E978EDB669581D0
76633D2AB766B70D281F018B53E3314C

2025-01-23 14:50:41 - root - INFO - SQL:
SELECT event_name,
  COUNT(DISTINCT CASE WHEN DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)),
                                     DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)),
                                     DAY) BETWEEN 8 AND 14 THEN user_pseudo_id END) AS retained_users,
  COUNT(DISTINCT user_pseudo_id) AS total_users,
  SAFE_DIVIDE(
    COUNT(DISTINCT CASE WHEN DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)),
                                       DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)),
                                       DAY) BETWEEN 8 AND 14 THEN user_pseudo_id END),
    COUNT(DISTINCT user_pseudo_id)
  ) AS retention_rate
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE event_name LIKE '%quickplay%'
  AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-08-01' AND '2018-08-15'
GROUP BY event_name
ORDER BY retention_rate ASC
LIMIT 1
Results:
event_name,retained_users,total_users,retention_rate
level_retry_quickplay,15,182,0.08241758241758242

2025-01-23 14:50:41 - root - INFO - itercount: 0
2025-01-23 14:50:41 - root - INFO - Database Name: firebase-public-project
Schema Name: analytics_153293282
DDL describes table information.
,0
table_name,events_20180801
ddl,"CREATE TABLE `firebase-public-project.analytics_153293282.events_20180801`
(
  event_date STRING,
  event_timestamp INT64,
  event_name STRING,
  event_params ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64>>>,
  event_previous_timestamp INT64,
  event_value_in_usd FLOAT64,
  event_bundle_sequence_id INT64,
  event_server_timestamp_offset INT64,
  user_id STRING,
  user_pseudo_id STRING,
  user_properties ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64, set_timestamp_micros INT64>>>,
  user_first_touch_timestamp INT64,
  user_ltv STRUCT<revenue FLOAT64, currency STRING>,
  device STRUCT<category STRING, mobile_brand_name STRING, mobile_model_name STRING, mobile_marketing_name STRING, mobile_os_hardware_model STRING, operating_system STRING, operating_system_version STRING, vendor_id STRING, advertising_id STRING, language STRING, is_limited_ad_tracking STRING, time_zone_offset_seconds INT64>,
  geo STRUCT<continent STRING, country STRING, region STRING, city STRING>,
  app_info STRUCT<id STRING, version STRING, install_store STRING, firebase_app_id STRING, install_source STRING>,
  traffic_source STRUCT<name STRING, medium STRING, source STRING>,
  stream_id STRING,
  platform STRING
);"

Some other tables have the similar structure: ['events_20180801', 'events_20180621', 'events_20180616', 'events_20180912', 'events_20180814', 'events_20180716', 'events_20181003', 'events_20180620', 'events_20180624', 'events_20180918', 'events_20180612', 'events_20180911', 'events_20180724', 'events_20180807', 'events_20180710', 'events_20180808', 'events_20180702', 'events_20180719', 'events_20180914', 'events_20180913', 'events_20180915', 'events_20180728', 'events_20180817', 'events_20180628', 'events_20180906', 'events_20180704', 'events_20180711', 'events_20180720', 'events_20180706', 'events_20180926', 'events_20180924', 'events_20180731', 'events_20180804', 'events_20180920', 'events_20180715', 'events_20180709', 'events_20180928', 'events_20180904', 'events_20180903', 'events_20180818', 'events_20180820', 'events_20180707', 'events_20180930', 'events_20180821', 'events_20180812', 'events_20180830', 'events_20180908', 'events_20180708', 'events_20180910', 'events_20180922', 'events_20180713', 'events_20180618', 'events_20180811', 'events_20181001', 'events_20180626', 'events_20180828', 'events_20180717', 'events_20180806', 'events_20180721', 'events_20180725', 'events_20180824', 'events_20180923', 'events_20180627', 'events_20180726', 'events_20180729', 'events_20180929', 'events_20180925', 'events_20180722', 'events_20180630', 'events_20180730', 'events_20180831', 'events_20180701', 'events_20180619', 'events_20180810', 'events_20180822', 'events_20180921', 'events_20180819', 'events_20180927', 'events_20180905', 'events_20180816', 'events_20180622', 'events_20180802', 'events_20180826', 'events_20180714', 'events_20180901', 'events_20180916', 'events_20180809', 'events_20181002', 'events_20180703', 'events_20180617', 'events_20180902', 'events_20180625', 'events_20180827', 'events_20180805', 'events_20180825', 'events_20180919', 'events_20180917', 'events_20180705', 'events_20180613', 'events_20180907', 'events_20180909', 'events_20180727', 'events_20180813', 'events_20180614', 'events_20180623', 'events_20180829', 'events_20180615', 'events_20180712', 'events_20180718', 'events_20180815', 'events_20180629', 'events_20180803', 'events_20180823', 'events_20180723']
External knowledge that might be helpful: 
How to Calculate User Retention in Big Query from Google Demo Game Analytics Data

As a Product / Website Analyst, I was pretty psyched to discover Google’s public Google Analytics 4 (GA4) gaming event dataset called `firebase-public-project.analytics_153293282.events_*`. The table allows experienced developers and learners alike to experiment with raw GA4 data in Big Query for free. Event data is basically a log of user interactions with your product for analysis .For newbies interested in learning more about event data and GA4, visit my prior blog. This article provides SQL queries for a quick table overview and explains how to utilize Google Big Query to calculate user retention.


What is Retention?
User retention rates are key indicators for whether your product team meets user needs. Improving retention is often central to long term growth strategies.

**Retention measure’s how often and for how long users tend to return to your product.**

The metric can be a powerful proxy for product usefulness and user opinion. Its analysis can reveal critical information like how well your site converts new visitors to users and which items and features are associated with users coming back. If user data is available, retention can also help a business understand the profiles of its most active users (power users). Finally, retention is a great guardrail metric for A/B tests. Successful, product oriented companies prioritize a healthy user bases over short term profits.


**Common Retention Calculation Strategies**

Two common strategies to calculate retention are: 

a) N-Day retention

b) Unbounded Retention.


a) For N-Day retention, analysts calculate how many users with certain characteristics return over successive periods. It is called N days because we define the length of each period. For example, with N=7 day retention, if User A becomes part of our cohort of interest on day 0 and returns to the product day 5 and day 15, they are counted as retained for week 1 (1–7 days) and week 3 (15–21 days) but not week 2 (8–14 days).


b) For Unbounded Retention, a user is counted as retained each week so long as their most recent product contact was after the week. For example, if User A becomes part of the cohort on day 0 and last returned to the site on day 21, they will be counted as retained in week 1 (1–7 days), week 2 (8–14 days), and week 3 (15–21 days) but not week 4 (22–28 days).

By calculating these metrics, companies can evaluate how well their products hold users’ interests. It also them closer to identifying the patterns that generate return users.



The table structure information is ({database name: {schema name: {table name}}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180612', 'events_20180613', 'events_20180614', 'events_20180615', 'events_20180616', 'events_20180617', 'events_20180618', 'events_20180619', 'events_20180620', 'events_20180621', 'events_20180622', 'events_20180623', 'events_20180624', 'events_20180625', 'events_20180626', 'events_20180627', 'events_20180628', 'events_20180629', 'events_20180630', 'events_20180701', 'events_20180702', 'events_20180703', 'events_20180704', 'events_20180705', 'events_20180706', 'events_20180707', 'events_20180708', 'events_20180709', 'events_20180710', 'events_20180711', 'events_20180712', 'events_20180713', 'events_20180714', 'events_20180715', 'events_20180716', 'events_20180717', 'events_20180718', 'events_20180719', 'events_20180720', 'events_20180721', 'events_20180722', 'events_20180723', 'events_20180724', 'events_20180725', 'events_20180726', 'events_20180727', 'events_20180728', 'events_20180729', 'events_20180730', 'events_20180731', 'events_20180801', 'events_20180802', 'events_20180803', 'events_20180804', 'events_20180805', 'events_20180806', 'events_20180807', 'events_20180808', 'events_20180809', 'events_20180810', 'events_20180811', 'events_20180812', 'events_20180813', 'events_20180814', 'events_20180815', 'events_20180816', 'events_20180817', 'events_20180818', 'events_20180819', 'events_20180820', 'events_20180821', 'events_20180822', 'events_20180823', 'events_20180824', 'events_20180825', 'events_20180826', 'events_20180827', 'events_20180828', 'events_20180829', 'events_20180830', 'events_20180831', 'events_20180901', 'events_20180902', 'events_20180903', 'events_20180904', 'events_20180905', 'events_20180906', 'events_20180907', 'events_20180908', 'events_20180909', 'events_20180910', 'events_20180911', 'events_20180912', 'events_20180913', 'events_20180914', 'events_20180915', 'events_20180916', 'events_20180917', 'events_20180918', 'events_20180919', 'events_20180920', 'events_20180921', 'events_20180922', 'events_20180923', 'events_20180924', 'events_20180925', 'events_20180926', 'events_20180927', 'events_20180928', 'events_20180929', 'events_20180930', 'events_20181001', 'events_20181002', 'events_20181003']}}
Begin Exploring Related Columns
**Relevant Columns and Potential Usage:**

- `event_date`: Used to filter events by specific dates.
- `event_timestamp`: Used to calculate the exact time of events and time differences.
- `event_name`: Identifies the type of event, useful to find 'quickplay' events.
- `event_params`: Contains additional details about events, such as event types within 'quickplay' events.
- `user_pseudo_id`: Unique identifier for users, used to track user activities and calculate retention.
- `user_first_touch_timestamp`: Timestamp of the user's first engagement, used to determine the cohort of users who first engaged between August 1 and August 15, 2018.
- `user_properties`: May contain additional user attributes that could be relevant.

**Conditions that may be used:**

- `user_first_touch_timestamp` between '2018-08-01' and '2018-08-15'.
- `event_name` equals 'quickplay' to filter quickplay events.
- Time difference between `event_timestamp` and `user_first_touch_timestamp` to calculate days since initial engagement.
- Extracting `event_type` from `event_params` to differentiate quickplay event types.

---

**SQL Queries:**

1. **List Distinct Event Names to Identify Quickplay Events**

   ```sql
   SELECT DISTINCT event_name
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE event_date BETWEEN '20180801' AND '20180815'
   LIMIT 100;
   ```

2. **Get Sample Event Parameters for 'quickplay' Events**

   ```sql
   SELECT event_params
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE event_name = 'quickplay'
   LIMIT 100;
   ```

3. **List Distinct Users Who First Engaged Between August 1 and 15, 2018**

   ```sql
   SELECT DISTINCT user_pseudo_id, user_first_touch_timestamp
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-08-01' AND '2018-08-15'
   LIMIT 100;
   ```

4. **Count of Events Per Event Name Between August 1 and 15, 2018**

   ```sql
   SELECT event_name, COUNT(*) AS event_count
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE event_date BETWEEN '20180801' AND '20180815'
   GROUP BY event_name
   ORDER BY event_count DESC
   LIMIT 100;
   ```

5. **Extract Distinct Quickplay Event Types from Event Parameters**

   ```sql
   SELECT DISTINCT ep.value.string_value AS quickplay_event_type
   FROM `firebase-public-project.analytics_153293282.events_*`,
   UNNEST(event_params) AS ep
   WHERE ep.key = 'event_type' AND event_name = 'quickplay'
   LIMIT 100;
   ```

6. **List Users and Quickplay Event Types in August 2018**

   ```sql
   SELECT DISTINCT user_pseudo_id, ep.value.string_value AS quickplay_event_type
   FROM `firebase-public-project.analytics_153293282.events_*`,
   UNNEST(event_params) AS ep
   WHERE event_name = 'quickplay'
     AND event_date BETWEEN '20180801' AND '20180831'
     AND ep.key = 'event_type'
   LIMIT 100;
   ```

7. **Users Who Had 'quickplay' Events After Initial Engagement Between August 1-15, 2018**

   ```sql
   SELECT DISTINCT user_pseudo_id, event_name
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE event_name = 'quickplay'
     AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-08-01' AND '2018-08-15'
   LIMIT 100;
   ```

8. **Calculate Days Since Initial Engagement for Users**

   ```sql
   SELECT user_pseudo_id,
     DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)),
               DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), DAY) AS days_since_first_touch
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-08-01' AND '2018-08-15'
   LIMIT 100;
   ```

9. **Identify Users Who Returned During the Second Week After Initial Engagement**

   ```sql
   SELECT DISTINCT user_pseudo_id
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-08-01' AND '2018-08-15'
     AND DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)),
                   DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), DAY) BETWEEN 8 AND 14
   LIMIT 100;
   ```

10. **List Quickplay Event Types with Days Since First Touch for Users**

    ```sql
    SELECT user_pseudo_id, ep.value.string_value AS quickplay_event_type,
      DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)),
                DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), DAY) AS days_since_first_touch
    FROM `firebase-public-project.analytics_153293282.events_*`,
    UNNEST(event_params) AS ep
    WHERE event_name = 'quickplay'
      AND ep.key = 'event_type'
      AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-08-01' AND '2018-08-15'
    LIMIT 100;
    ```

---

These queries progressively explore the data necessary to determine which quickplay event type had the lowest user retention rate during the second week after initial engagement for users who first engaged between August 1 and August 15, 2018. By examining event names, event parameters, user identifiers, and calculating the days since initial engagement, you can gather insights to compute the retention rates for each quickplay event type.Query:
SELECT DISTINCT event_name
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE event_date BETWEEN '20180801' AND '20180815'
   LIMIT 100;
Answer:
event_name
level_reset
level_complete
firebase_campaign
os_update
in_app_purchase
level_complete_quickplay
session_start
select_content
challenge_a_friend
level_retry_quickplay
use_extra_steps
app_remove
app_clear_data
ad_reward
user_engagement
level_fail_quickplay
completed_5_levels
level_end
level_start
level_start_quickplay
post_score
screen_view
level_fail
level_retry
level_up
app_exception
no_more_extra_steps
error
level_end_quickplay
level_reset_quickplay
app_update
dynamic_link_app_open
spend_virtual_currency
first_open
Query:
SELECT DISTINCT user_pseudo_id, event_name,
  DATE_DIFF(
    DATE(TIMESTAMP_MICROS(event_timestamp), 'UTC'),
    DATE(TIMESTAMP_MICROS(user_first_touch_timestamp), 'UTC'),
    DAY) AS days_since_first_touch
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE event_name LIKE '%quickplay%'
  AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp), 'UTC') BETWEEN '2018-08-01' AND '2018-08-15'
LIMIT 100;
Answer:
user_pseudo_id,event_name,days_since_first_touch
A976A39B8E08829A5BC5CD3827C942A2,level_complete_quickplay,13
A976A39B8E08829A5BC5CD3827C942A2,level_end_quickplay,13
B2D359D114428D8DD085DFAFF11195CE,level_retry_quickplay,13
57EC50FBC6C7277B8EDCCE44C1352BD4,level_complete_quickplay,19
E0664E9E7883956A6E3084FD68AA274B,level_complete_quickplay,15
E0664E9E7883956A6E3084FD68AA274B,level_end_quickplay,14
B529E84EE03C578C7E92CE5836AB1C1D,level_fail_quickplay,10
9FCA0F0AF9D385AB53DD8742397B25ED,level_start_quickplay,18
D8F0003FCBEE71C9DDA3B5E7F71E2E87,level_fail_quickplay,15
B2D359D114428D8DD085DFAFF11195CE,level_start_quickplay,16
C679FF00E17790E7E16AB903212EE05C,level_end_quickplay,18
C679FF00E17790E7E16AB903212EE05C,level_start_quickplay,18
82F141D1C5A86CB8F5F4DFC7E09E5513,level_end_quickplay,24
7D50D96761E1353DED4D2C8DC3384A37,level_start_quickplay,46
359A34F575B808FEFE58BC5B40816F09,level_end_quickplay,40
359A34F575B808FEFE58BC5B40816F09,level_start_quickplay,39
359A34F575B808FEFE58BC5B40816F09,level_start_quickplay,40
EEED36297DE224E3E34468ECB0BA7AF5,level_fail_quickplay,40
AC4C761C946B5E45F9A040FED66576D0,level_end_quickplay,46
AC4C761C946B5E45F9A040FED66576D0,level_complete_quickplay,46
C6D97C0D6DA580A6FDB44BB2C3015A85,level_end_quickplay,8
7CC61FB109657777ADD59480BC290F29,level_fail_quickplay,12
F7292D95AC282F0F0B7E82EDED18F599,level_complete_quickplay,12
E0664E9E7883956A6E3084FD68AA274B,level_start_quickplay,10
0DB2864E7EC7D29DA4EC1540FFDC419A,level_complete_quickplay,17
B087A865A90AD52D1864A36482983BD2,level_fail_quickplay,18
AC14799A5E8C340D6CADCBAE72037D81,level_reset_quickplay,26
82F141D1C5A86CB8F5F4DFC7E09E5513,level_end_quickplay,23
E0664E9E7883956A6E3084FD68AA274B,level_end_quickplay,17
E0664E9E7883956A6E3084FD68AA274B,level_fail_quickplay,17
5ACF1A6BFE350F7BB661BF389AF7E2F0,level_start_quickplay,29
AC14799A5E8C340D6CADCBAE72037D81,level_start_quickplay,35
459FD97ABE14D7762CD58C3A3104D183,level_start_quickplay,29
D4DDA67EF184AFBC5E2D52FBDEDD7837,level_fail_quickplay,25
DAD23DD885EEE844890417FC965052F0,level_end_quickplay,23
E8950841C7635FFAE97EE03DE2A92072,level_complete_quickplay,25
8F41FC08B49819D339D864572A1CA136,level_complete_quickplay,24
EEED36297DE224E3E34468ECB0BA7AF5,level_complete_quickplay,27
EEED36297DE224E3E34468ECB0BA7AF5,level_start_quickplay,26
D4A45A0CA838C439F64D565450B9A7D6,level_start_quickplay,4
38D65030548914B5E167CE85B035CA8F,level_complete_quickplay,0
Query:
SELECT DISTINCT user_pseudo_id, user_first_touch_timestamp
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE DATE(TIMESTAMP_MICROS(user_first_touch_timestamp), 'UTC') BETWEEN '2018-08-01' AND '2018-08-15'
LIMIT 100
Answer:
user_pseudo_id,user_first_touch_timestamp
F3A2F44C99758CC6006BFE28AC78EBFE,1533780422392000
F89FB7FA61F2B6CAA3679E739CAB2477,1534265080102000
D75565A913EE0D3AB4E50643A86CCE7D,1534133239638000
F454E0D882BF2C7E1E0DF7F96DF78F3B,1533201985309000
F4EA0F2888792BD62555AD46ED534839,1533140322832000
E1A3C786B2E4D56629EE808A3A174995,1533422394271000
4F7248CFE9A405BBD16E16EF2B0D3473,1533716592979000
8F9D2E21E1B2D41941545BAD0182F182,1533736723496000
717636DB6BB28A28CD06680B18ACE076,1533716352902000
38C4E3FBD09FA68179F2DE3F133D942D,1533673531578000
54506E5CFFDC0AFD69A379427447BE95,1533739160559000
370BAFBB7AFD77B12726F4712DB42DF8,1533712395044000
9C82775812A959D5A1446FDA75CC2C88,1533775929858000
73E94C02345779D2299155829DF524E9,1533739388041000
55F725AB1CC8281CDAC2FFEDC35423F4,1533756653084000
210C3692734E251EEF4E952BC57DD998,1533160438590000
E1CA3A181B0EBFCF0E8DA26EBEF7DFC6,1533562516320000
0DF6A14F536F6514A6F18BC12A532A82,1533345487556000
D3147C34750B3B6DDBF2382678BAC86D,1533549271156000
AC4C761C946B5E45F9A040FED66576D0,1533407007334000
4593E981ECEF849FC7DA0F7FDA0F250E,1533119429750000
270BB513258E82FEB9BB23091073E82D,1533186025918000
AB48D576008899542044F575FF8DF525,1533191244838000
43B8EEA09D7D62EC90F40D0E3716E960,1533105623504000
9991D4763C564343D9B899E4BEA9D4F8,1533147975691000
6C31CA4020CECC2B055E465813E2C541,1533182083020000
9272B4C8E7F4F0364558B43B977990D0,1533137209809000
4FCB0434161F0EE1E92046C850A90DD1,1533569000872000
A153C00220FEE4D83DF879F7D5A6CB07,1533583626149000
1010A9A4D76FDDAB3C456113CC4E6C95,1533586697700000
7432B1A3C0CB18E6BA5E0F14F1105980,1533261856075000
76F4F164AEBC9FBC1198E2BF42AC2F77,1534088628259000
310D44D95961BF9754C9948AF6F437EA,1533198529541000
96B108514A10609B9E8F4F78B47B6776,1534364313386000
ED5C290C8F82C28C033482D31299D8CD,1534253696287000
250BB57A7B602E74E169896CD19C8504,1533965510992000
6344D6DD4B7741E868D17A8CC19E03C8,1534014971342000
8BF7E118BDC4D008D6B28FCCEDC38083,1534007703437000
3CE1655CEC10EC3111E5A5A7B267C017,1533998026540000
EC9CF53549FB38AAE4906989B4B050E4,1534027135443000
B2912116E7B957900D6B69D4E50F0F9A,1533101297682000
336BDA268CA6379F6EE567B4C16A1090,1533222430431000
BADBF9D1D46555F52F506538DB8C3011,1534199326738000
C175523CE4F5BB5E65A4EC3CF6B1345C,1534215660691000
7F7DD65D0E41B3A00DB98B07B60264CF,1533349331498000
C9E1BDDF758FECF6F07DE045B1FFF1A3,1533281285260000
E90B98235AB244B2A25A73706E2FC370,1533265554521000
3D7382CF3E5091189D2961E0EA3A2ACE,1533670977945000
D5544C064404DC6067412B1272F848D6,1533472860789000
335156392A0F885ACF5A91CE029E159D,1533812810377000
Query:
SELECT event_name, COUNT(*) AS event_count
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE event_date BETWEEN '20180801' AND '20180815'
GROUP BY event_name
ORDER BY event_count DESC
LIMIT 100
Answer:
event_name,event_count
screen_view,302996
user_engagement,169570
level_start_quickplay,66339
level_end_quickplay,42845
post_score,32684
level_complete_quickplay,27107
level_reset_quickplay,17797
level_fail_quickplay,15738
select_content,13930
level_start,10866
session_start,9412
level_end,7964
level_retry,6779
level_up,5577
level_complete,5499
level_retry_quickplay,3671
level_fail,2387
spend_virtual_currency,1415
use_extra_steps,1366
level_reset,1276
firebase_campaign,1060
first_open,728
app_exception,672
app_remove,439
no_more_extra_steps,351
os_update,343
app_update,324
completed_5_levels,311
error,241
ad_reward,217
challenge_a_friend,89
in_app_purchase,4
dynamic_link_app_open,2
app_clear_data,1
Query:
SELECT DISTINCT user_pseudo_id, event_name
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE event_name LIKE '%quickplay%'
  AND event_date BETWEEN '20180801' AND '20180815'
LIMIT 100;
Answer:
user_pseudo_id,event_name
B4653EE7AA5AB38E47F66AAE2F708BD9,level_complete_quickplay
276EA0F867FD5E24356C984081FA959F,level_complete_quickplay
57EC50FBC6C7277B8EDCCE44C1352BD4,level_start_quickplay
E920D72AFB16365797955E46913E2599,level_fail_quickplay
D0F280B12652EB0D74F6BC74AB13606F,level_complete_quickplay
D0F280B12652EB0D74F6BC74AB13606F,level_end_quickplay
D34924C19421D7E083FD387D97765F94,level_start_quickplay
475B281839C403CCF826D0D44890BFA5,level_start_quickplay
CC0EF7F0565D2D90455B2B2E416609B8,level_fail_quickplay
7E832B95E7313AD2E9F24D9D2AA33E97,level_fail_quickplay
D5F25FE843F01514F448B1AA94028D2D,level_end_quickplay
4A93C01615B33FF5804AF8D19895247F,level_end_quickplay
C1BDCF7765C5EDD7643D476B84BD2B30,level_fail_quickplay
61F5B317AB1EF10E3C7E68C930A1018C,level_reset_quickplay
2AC0EF5047BC538BDA6388E644409B5D,level_start_quickplay
A8D7DCCA39D8703F2928AD2D7BBB6BE9,level_complete_quickplay
F4634EFF4D9470DCA00051E3304B81AF,level_complete_quickplay
67D3D76504CC5C4CBFC78EE4FC397C8B,level_start_quickplay
CCE1B466B4C26A8190A10FD0D7A9402C,level_start_quickplay
97533889633426FCBD7C424143F2A869,level_start_quickplay
359A34F575B808FEFE58BC5B40816F09,level_complete_quickplay
959635567E419A061EECCCA478EDC718,level_retry_quickplay
BE36C49B1AB3968D420923AEC4FDD7AE,level_end_quickplay
9E29F60A2AC264DFAB9AD5A7D9B0455F,level_start_quickplay
67C46D47D98A618D1124FA4CA727C19B,level_end_quickplay
2F48607C41ECC4015FA296500F0A2C4B,level_complete_quickplay
7CBF44EFDDB9E6401F31786BEE071196,level_start_quickplay
D81B390EB1BB12AB50085C9675367308,level_fail_quickplay
91A06057C6272653B6006D7A8791DF81,level_retry_quickplay
56F37FD95FB21AB3976C83E803D7AEA7,level_start_quickplay
0B427C5E490A982FADF586F82E797ACB,level_complete_quickplay
7CF3B98BA255D1BAEBCC34B9B876439A,level_start_quickplay
CA51DAF1373B5C2A16C174AFBD2132A4,level_fail_quickplay
5EE0642EFFD04FFBBAE5ADBF64876D83,level_fail_quickplay
53C62BFF7D715334B8C3C4904EC34880,level_fail_quickplay
3DEB0C12C49AD19D7ACE68FA59E7ACD6,level_end_quickplay
D5F9D9AF22EF5073E10342973D48FB2C,level_start_quickplay
BB29F8B0FF330F326605FA421BB37BC1,level_complete_quickplay
E66C3B8A38C424C7CBE0B5388EE5F77E,level_complete_quickplay
AED716F2A571507087AF004F331D9949,level_reset_quickplay
CEE2B7FC14A535398A13AF03AC95EF96,level_end_quickplay
DAA3F353F320A717A0C418A8205292B2,level_start_quickplay
343B740C7B3BD9C2CFA46BF097A8856E,level_end_quickplay
D48F1681EB572CC9F7EB6BC7958646FD,level_end_quickplay
328DC7FE55E8881B2EA668C9A2855BB7,level_fail_quickplay
3DF2D70B5C3E5DA6CCE82B37E8275632,level_complete_quickplay
3DF2D70B5C3E5DA6CCE82B37E8275632,level_fail_quickplay
59454BAC415BB1F18517C6FD2C023E49,level_complete_quickplay
59454BAC415BB1F18517C6FD2C023E49,level_retry_quickplay
D6F5820E5B2C721C1677E1BC873B074A,level_end_quickplay
49309C5759610DBF6C829C0D4AB23943,level_reset_quickplay
44759496F6F519B1A4BEF55BE55C631C,level_end_quickplay
84D4A14B2F6F8A8AF3DF58E6C67A79D5,level_start_quickplay
472451071AED6FF801BC0FE66706FD27,level_complete_quickplay
Query:
SELECT DISTINCT user_pseudo_id, ep.key, ep.value.string_value
FROM `firebase-public-project.analytics_153293282.events_*`,
UNNEST(event_params) AS ep
WHERE event_name LIKE '%quickplay%'
  AND event_date BETWEEN '20180801' AND '20180815'
LIMIT 100;
Answer:
user_pseudo_id,key,string_value
525E3BEE74AD824923CC04FE45E45B40,board,S
BB5383D0C13918205EC27BEC707E1152,value,
CB284BFA662EC30C6D96E32278213CD4,value,
15955C2770D8FE60B329BCD0805BB35E,board,S
59483477E9365F4C9A834CD88B37BA41,firebase_event_origin,app+gtm
980DEC5BA17132A841D7D7A140333114,value,
980DEC5BA17132A841D7D7A140333114,firebase_screen_id,
FC2DDF0F37BB211D565307010B1B30A1,firebase_screen_id,
39BE7CAB9B8602ABD10A1BFB4E66BBB2,value,
909A16079F7183140ACF4C71A6CCDF3D,firebase_screen_id,
B99FD965B0874192EE94E8A8FE85EA9E,value,
0440FFD9E8480E870EA2C22C5F54648D,firebase_event_origin,app+gtm
6A2F4E7AB1816D2F6EC741BC92141766,firebase_screen_id,
C66BF8A9ACA5CD56597E18B0729181C4,value,
0E05F56141200FF41FCC0C7FA297FF08,firebase_event_origin,app+gtm
0ED6BC1D319AB5BD1F245628EA47EDBB,firebase_screen_class,AdActivity
A421EBCE8AA69A980AAFC4F141BDEFFB,firebase_screen_class,game_board
A421EBCE8AA69A980AAFC4F141BDEFFB,firebase_screen_id,
EDE016882F21502CDE760922CD8DC0B5,value,
44A600997B9B6499325D518A19B51FEC,board,S
44A600997B9B6499325D518A19B51FEC,value,
BFC4C22D2C9FF3D314BC4F1D86E92044,firebase_screen_id,
3DEB0C12C49AD19D7ACE68FA59E7ACD6,board,S
6E0CE4D9DE17F3D771906937B9ED37FD,firebase_screen_class,game_board
920DB84FCC0F4421650B9E257E33180B,firebase_event_origin,app+gtm
C052BC38A0F39A40678E5AF5E7C84B77,board,S
C052BC38A0F39A40678E5AF5E7C84B77,firebase_screen_class,game_over
D5F9D9AF22EF5073E10342973D48FB2C,firebase_event_origin,app+gtm
BD23A737D75442D2C32CE2259D15D624,firebase_event_origin,app+gtm
FEDC59699D8832A11B88BFCCCAD0951D,board,S
D7EA8E3645EFFBD6443946179ED704A6,firebase_screen_class,game_board
734AC9568F0674F7BBE59D45B5B90EA7,firebase_screen_class,game_over
475B281839C403CCF826D0D44890BFA5,firebase_event_origin,app+gtm
475B281839C403CCF826D0D44890BFA5,firebase_screen_class,game_over
8EDB9A9856CDB5AFC42546106EE46734,value,
8EDB9A9856CDB5AFC42546106EE46734,firebase_screen_class,game_over
8F69F63C94FC7045651B1B164AE7B379,firebase_screen_class,game_board
CA04708DA02378999ECB402481FF1AE4,firebase_screen_class,game_over
B5C5E0E0C3984E096C77B2A34AEE0BA7,board,S
3D03A380687FE3369E93915D50C572CB,firebase_screen_class,game_board
635808C1DDFBC662DC3015097E26E62A,firebase_screen_class,AdActivity
AC14F9B5C6CA275BA54C2C0ABDC087F5,firebase_event_origin,app+gtm
932AAF56DDE9C55359B9CCFA18E7FB95,board,S
932AAF56DDE9C55359B9CCFA18E7FB95,firebase_screen_id,
E512079B53179DF9A608CF4ADE47DE9D,firebase_event_origin,app+gtm
1D763A3E95386CEEF80C5174E6216F8C,board,S
424C01CD3ACB4454BB6B2D2899511997,value,
C3A2E093D521D3F6AF2C54A7860CF68F,firebase_screen_class,game_board
021E703A207ECD0CC248918F28426D95,board,S
Query:
SELECT DISTINCT user_pseudo_id, event_name
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE event_name LIKE '%quickplay%'
  AND event_date BETWEEN '20180801' AND '20180815'
LIMIT 100
Answer:
user_pseudo_id,event_name
B458770ED6E295374FEEB3A68902CC28,level_start_quickplay
27293EA0B2F41A672E15EF7B1FA21298,level_start_quickplay
EE99F8CB32999A0FDAABBA18B05D4E48,level_end_quickplay
2B5ABA17A30D32531C09DAF2865F9E55,level_complete_quickplay
EBC3581ADA874D494FBE2C7CCF53BF99,level_complete_quickplay
EFB696A82D093B3AFBE92FF526DD5CEA,level_complete_quickplay
91814809BD9374D5CEDFC6A31727CC55,level_start_quickplay
377303AA2F5C5C80E5AAAD26C029BD5A,level_start_quickplay
CC81C3C01DE545318860C5BFDC6AD31E,level_end_quickplay
EC1A759709685E136767F2C1BA4751ED,level_start_quickplay
46D808E730894AB0AC6E0F493B6FC864,level_start_quickplay
372D9BB5088C4E9000C65B06459B403A,level_start_quickplay
C60EACB47CF25AEEFD16C5E332078852,level_start_quickplay
CA51DAF1373B5C2A16C174AFBD2132A4,level_end_quickplay
6683CAFB77FB7B60C78CD233EB2B62F7,level_complete_quickplay
84E491A60BE52A4C6A438A89FADE283C,level_end_quickplay
84E491A60BE52A4C6A438A89FADE283C,level_fail_quickplay
A7AAA5EF977926DBCF801D15F83EE4A5,level_complete_quickplay
A72750663D0181C7817F61B3DD2CA656,level_complete_quickplay
FDA4BBBCF1EA2D95CDD77BFC5F00A837,level_start_quickplay
2BFF75BDF9645D51E99CE5148F4847CA,level_start_quickplay
8065F8E98407106A65D35195984B2258,level_end_quickplay
E643F6549E6C7EA0FD01EF4BF7A40F76,level_end_quickplay
2F4A6CF5C60E72BC578CA0E5189505F7,level_start_quickplay
76690E22DDCE2B1FFA98C6A4376B8EA2,level_fail_quickplay
674EAE8D70D203FEDBE60DEAE2F834CC,level_complete_quickplay
674EAE8D70D203FEDBE60DEAE2F834CC,level_end_quickplay
674EAE8D70D203FEDBE60DEAE2F834CC,level_fail_quickplay
01C784BDB7AF4DC8DAD6DCD21AF56E25,level_complete_quickplay
5A7EB17BF7D867AADECA2FDAF0941E88,level_end_quickplay
06A302E3A4767793ADBC884143708660,level_end_quickplay
E9DCE2D958652BD58E846DCE86BDD90A,level_complete_quickplay
E9DCE2D958652BD58E846DCE86BDD90A,level_start_quickplay
12E5626928FE0885DEEF068683E8BD63,level_complete_quickplay
C1A0D9FB3527654CA715A732B5FB5202,level_fail_quickplay
827848D9C0FD18D44110098CEC982CDE,level_end_quickplay
53717D02C147929860D981CD68CE2D9A,level_start_quickplay
53717D02C147929860D981CD68CE2D9A,level_end_quickplay
4593E981ECEF849FC7DA0F7FDA0F250E,level_start_quickplay
4593E981ECEF849FC7DA0F7FDA0F250E,level_reset_quickplay
C74B58C4CD2770A1E97D6DC13D42CCAC,level_start_quickplay
C74B58C4CD2770A1E97D6DC13D42CCAC,level_fail_quickplay
B99FD965B0874192EE94E8A8FE85EA9E,level_complete_quickplay
3EF8FC940E379D53BBD3FEFDAF626BB2,level_start_quickplay
35CF08DA631AC27582D6A0FE710131F7,level_reset_quickplay
B83E97CDE1FCF1D681206DFFC5F1898E,level_retry_quickplay
28C4A09298C441D5AFD39E749D9F3DA3,level_end_quickplay
44A600997B9B6499325D518A19B51FEC,level_start_quickplay
F5DAD8DD17B689CF672D65A0A81CF4AC,level_start_quickplay
A1FA05C0618ED3CB04CDB44FBE35DDB6,level_complete_quickplay
A1FA05C0618ED3CB04CDB44FBE35DDB6,level_end_quickplay
EBE661044C1949546986A852F35083A1,level_complete_quickplay
85DB15BDADAB65F9CC1E33B872745B87,level_end_quickplay
E5D16173400729E05DFFB4883FA6EF1C,level_fail_quickplay
Query:
SELECT user_pseudo_id,
     DATE_DIFF(
       DATE(TIMESTAMP_MICROS(event_timestamp), 'UTC'),
       DATE(TIMESTAMP_MICROS(user_first_touch_timestamp), 'UTC'),
       DAY) AS days_since_first_touch
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE DATE(TIMESTAMP_MICROS(user_first_touch_timestamp), 'UTC') BETWEEN '2018-08-01' AND '2018-08-15'
LIMIT 100
Answer:
user_pseudo_id,days_since_first_touch
2381980E778280D6A575BDA13B563B72,44
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
B529E84EE03C578C7E92CE5836AB1C1D,41
609EDE15DFE17B9241415C5216D10BFC,54
609EDE15DFE17B9241415C5216D10BFC,54
609EDE15DFE17B9241415C5216D10BFC,54
609EDE15DFE17B9241415C5216D10BFC,54
609EDE15DFE17B9241415C5216D10BFC,54
609EDE15DFE17B9241415C5216D10BFC,54
609EDE15DFE17B9241415C5216D10BFC,54
609EDE15DFE17B9241415C5216D10BFC,54
609EDE15DFE17B9241415C5216D10BFC,54
609EDE15DFE17B9241415C5216D10BFC,54
609EDE15DFE17B9241415C5216D10BFC,54
BB4B7F8EB20FC2E38E2891C3052E7229,53
BB4B7F8EB20FC2E38E2891C3052E7229,53
BB4B7F8EB20FC2E38E2891C3052E7229,53
BB4B7F8EB20FC2E38E2891C3052E7229,53
BB4B7F8EB20FC2E38E2891C3052E7229,53
BB4B7F8EB20FC2E38E2891C3052E7229,53
BB4B7F8EB20FC2E38E2891C3052E7229,53
BB4B7F8EB20FC2E38E2891C3052E7229,53
BB4B7F8EB20FC2E38E2891C3052E7229,53
BB4B7F8EB20FC2E38E2891C3052E7229,53
BB4B7F8EB20FC2E38E2891C3052E7229,53
BB4B7F8EB20FC2E38E2891C3052E7229,53
8680E9C6F3ABE3B95FCF44EA5D7DB200,54
8680E9C6F3ABE3B95FCF44EA5D7DB200,54
8680E9C6F3ABE3B95FCF44EA5D7DB200,54
8680E9C6F3ABE3B95FCF44EA5D7DB200,54
Query:
SELECT DISTINCT user_pseudo_id
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE DATE(TIMESTAMP_MICROS(user_first_touch_timestamp), 'UTC') BETWEEN '2018-08-01' AND '2018-08-15'
  AND DATE_DIFF(
        DATE(TIMESTAMP_MICROS(event_timestamp), 'UTC'),
        DATE(TIMESTAMP_MICROS(user_first_touch_timestamp), 'UTC'),
        DAY) BETWEEN 8 AND 14
LIMIT 100
Answer:
user_pseudo_id
E0664E9E7883956A6E3084FD68AA274B
B529E84EE03C578C7E92CE5836AB1C1D
59772415A60A0B7E16588D219D7B85F1
383F4B98EC31DD2A915427D36A30354E
C6D97C0D6DA580A6FDB44BB2C3015A85
1FEB41A72F244D352EA79982CC259EA0
90315F3CE85BB427F960EF2F78972EA6
D0E006B5E441969283C94713E308A11D
84F55D39B331B4D51467A32FECD5F0A5
D5544C064404DC6067412B1272F848D6
1AE6C4E5DFF6715503FC7C79A7C0C363
A976A39B8E08829A5BC5CD3827C942A2
B96742012753A7FC58537387657DED5A
8F69F63C94FC7045651B1B164AE7B379
81A07F200581534596EAE948BDEE015E
5E3CBF1204F069C8F4474D492A361CCD
4A8D4276A1EBBD17E6CB7EE30FE71CC2
0DF6A14F536F6514A6F18BC12A532A82
F5B3C520B6C16AEF201A60393DD5AE91
378D3B51D99A076B2E978EDB669581D0
9C4FD2B8EFBE7F68A56C522FF0C52491
C3CF8D010A218064A32EC45C3F446B2E
88E99CE30B65345ED0B118869B6AD035
276EA0F867FD5E24356C984081FA959F
7D9E4CD01C4E4F1768A0DF5CDFDD7753
45FB547C5857493104687C234EDCDE37
1814CCF8B0BD30480C6D375743010FAE
F4EA0F2888792BD62555AD46ED534839
43D27F6D77E6A3B68872B6786AD0DAB4
A62D86FAFF43F1EC89D6F867915D7D56
3C24334270603160F1C27BAAC3B9B714
6870FFBF31EA0EC710FF2A8A867B99DF
62E1AFE2AD1BED1937E861582EB84BE8
BFE99B51F316372640BDD14B9625C0F2
E730097121F6790373D1BBCA545FD946
B2D359D114428D8DD085DFAFF11195CE
5C17C05950C71938CFA82EA7C517748B
BB322D2CA948F548EA3A05A2BD93B1A3
F454E0D882BF2C7E1E0DF7F96DF78F3B
7DC72A0249398C477779B804F1EA3454
88AD03F6828BDD86AA72AA556D87387B
DF2FC56E807EAF16E852AEAB67E0127A
EC895C732092BA9A3CE9F507ED888726
310D44D95961BF9754C9948AF6F437EA
A6A77DA8F2C4102A83EED1D5216EB318
39C210B833FE2D53C723E354AB1FAC4D
D75565A913EE0D3AB4E50643A86CCE7D
E0189D91AD0A138AA65CB66338B82161
16C1832522326ACE532DC54C9C82D49C
A64D09F4DE2FB21E17EE29D7B77081EB
4091F647A1B6367AC7945DA0917CDA7D
3A1B5A55C33A7EF1A37C909A753606B8
4E6F4A73B5D05B33DC73B11547E39004
210C3692734E251EEF4E952BC57DD998
03B685883D78D1DB9F67A86635F9D788
51F21B36EB9D6FF7B5D7ACB89FF62B03
7439CA3E049F434742CB5C63A55FC24D
019FCC6C080A33E9B697CAA476C4156E
CE24B98FDB40DFD8FA769844135C2852
DAD23DD885EEE844890417FC965052F0
F7292D95AC282F0F0B7E82EDED18F599
E1CA3A181B0EBFCF0E8DA26EBEF7DFC6
17636078D57884AD7EA5406C60E2BD10
A0903E7042C13251799B68B16FD1EBA6
4CC453DA57531954D7C053B93A20B5D0
67D3D76504CC5C4CBFC78EE4FC397C8B
5BFDC0426DE9C09CA5FF18E4982F2506
01A2CCF65B4BB5DF87B1F9177616C5AF
F0945E5A97F876E9C084AC260BA4A6F1
B2F661E88136265632545A030F09A88A
2E1CBCBC408A270FE9B39E79958C28FB
C0D247C7C087F68E0504E5B5E5BBFB11
5C4773A411EA7DA0CE90122B51F37E5D
1845E883F5E20391CD3BD68F488A3C5E
359A34F575B808FEFE58BC5B40816F09
6C40A2B1B7C2336EDCE4B9F346682A72
29D576429D004584017D0A0FE1601455
FE5DCCE817A179E9E89DECF8406E4D97
B087A865A90AD52D1864A36482983BD2
0AFE3DE6A443BD660CDD5B1FA36686F6
38D65030548914B5E167CE85B035CA8F
058AE4BB2F67DEA4C6ACAA22AEB71BF2
F89FB7FA61F2B6CAA3679E739CAB2477
3D7382CF3E5091189D2961E0EA3A2ACE
27D0B01EBF8B78EA0B61171428EFD542
59FBC4CB04E905D3C1E7548C67392E1A
0DB2864E7EC7D29DA4EC1540FFDC419A
57EC50FBC6C7277B8EDCCE44C1352BD4
30C9F1FCEBB2E40593350BBB662344E7
DB6EA53027EF973B908E170B76755C2D
E920D72AFB16365797955E46913E2599
7A4FEFDB59BC17432C70DA5781EEFDD1
B7D2B63ABE215157570ABD2E2E6EC9BE
Query:
SELECT DISTINCT user_pseudo_id
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-08-01' AND '2018-08-15'
  AND DATE_DIFF(
        DATE(TIMESTAMP_MICROS(event_timestamp)),
        DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)),
        DAY) BETWEEN 0 AND 14
LIMIT 100;
Answer:
user_pseudo_id
A6A77DA8F2C4102A83EED1D5216EB318
D75565A913EE0D3AB4E50643A86CCE7D
E0189D91AD0A138AA65CB66338B82161
39C210B833FE2D53C723E354AB1FAC4D
5C17C05950C71938CFA82EA7C517748B
89C1D9AF4193728E41F48DC623DEE51F
BB322D2CA948F548EA3A05A2BD93B1A3
B6E6FA98F04FE22CC272DB5183B48763
8D76B80E2CCAE0EDD0F2D50D1ABCC0B3
146B1C215275774027FAEF96E5AA3713
71760E83C4579A53FE11B8C808677711
336FED02BA10D201C1B88C1CECB2E9D1
2CCA4395A5281BAC61DD7C846837F50B
A64D09F4DE2FB21E17EE29D7B77081EB
7432B1A3C0CB18E6BA5E0F14F1105980
B2D359D114428D8DD085DFAFF11195CE
16C1832522326ACE532DC54C9C82D49C
3151F3461C50299BC4F328702654F9C5
4091F647A1B6367AC7945DA0917CDA7D
72FC15A9C0E3262CFCF42B619ECF3774
DABD5F8DD42B23039CE6055C9C93E50F
0A7AAC29C353686D279F1752D120A53F
4E6F4A73B5D05B33DC73B11547E39004
3A1B5A55C33A7EF1A37C909A753606B8
7C14D1AD9F8CAC89B3ECC681C500D50D
EE2010FFDAF663BCC722160AB9954A1E
F27F046DF960AB50CE65B9F4364C981E
1D89281562AC3FEFB76A42ED406BF1B5
F454E0D882BF2C7E1E0DF7F96DF78F3B
7C8D8B75790229C5B05F6D31E9BE6254
ABF3E5FB92EF4F36B295E43812F8CD04
171871CA6AF9A891FB7B3E19CD144B2E
43B8EEA09D7D62EC90F40D0E3716E960
7C7C8524146AA5006BE260A041101DF3
C59286E780962666D2A9C13A478542C8
7CB9FDA17938289CE3019602888EEC58
310D44D95961BF9754C9948AF6F437EA
741158B569CC8819D22360847628CA7D
12D15CA29CFE3CBA400CE28F31CDFEFC
CC8DFD648FF20954F47DA8DFD9AE58B5
E67E5D7AF8E668290F7BAEBE7A7683B7
988E20C1031C6FA5301C7D2FBD90A4BF
ECC86F55D599ABD6E88F68C3E7CF53CC
C006BDD387158B17AD45F2BC0F346048
C8E20454CE52ADC3197F86EAE910BD5C
45DF5BA054826C546308F865405709B3
2B5D7D51F2F3BCC0B01B60FF5E37A255
30138B542CDF56A289C3B3059EC03D5E
C7B4A196FEDE305ADF8ECAE47820A5C0
DF2FC56E807EAF16E852AEAB67E0127A
E79B4E11B6B31650841081E4EC76C0FD
D7987E1129FA0207F04061FF4700BC6E
0CFD16A46A05B5BD29D3A37284B94CBB
CAD42025ACBC42A48B3500AB25DA7E35
BC4BF50150618EF80F3F62D886CF20B9
EC895C732092BA9A3CE9F507ED888726
88AD03F6828BDD86AA72AA556D87387B
567422321BBB432EC2CC014A510E61BD
DBA105E7A2FDD3D01E3D719BDE49069A
BDCB9DF32FAD5A3701822466CDE6CD0A
7DC72A0249398C477779B804F1EA3454
62440E2EC0A24E9FB2CF09E230FFDEC4
8BC72D1925A8866050D5A6FB01148518
BC575A719C37E1C2237B79FE7FD3F7E1
C7FE9CCE94D88A610CDB2C53D3004AF0
2D23CD90AE51556D7B8FAD2C358D308A
8831528D3CCC3AF25C1001256C389428
AE5C3CFC7F5F1225DC2E5190DF8CE3E6
DA4BCFC16C1735AFFAD960E8B9064525
DA814428F7E26F091284C8793DE748BD
1BA8A3FE9D6AD54C6C77BC8A350BF2DA
EA60D1DFDD9E06777E874E280C6417CC
E11BE37FB066E143A0B4C29D2842223A
7FBA8F50097D2948AEA898B7AFA3B72A
362C4170BE71B71630D1C7790927BD4C
162DCBBB07A1E42728E66853A66556B5
346CD6014841FFAB8A094411970DDD9E
2B6D0DB9D76C581ACB986BBE2408220C
1AAA1DF04F833632645A01D5B1C282CA
DC7B46EBC100B639364CC9789DE001B0
85BA81CA205F8D8F786495ED93FE3F92
103A2011A9093A6E5D9AED85C81FFEC7
918AB13390C2B040E4B0D5086EBF3349
AA6C185B662F56BA9006BDA50DF5E142
5646899D197E5F36BA6CE0E08456B026
A976A39B8E08829A5BC5CD3827C942A2
0DF6A14F536F6514A6F18BC12A532A82
9C4FD2B8EFBE7F68A56C522FF0C52491
F5B3C520B6C16AEF201A60393DD5AE91
AEEFEB2B840AB521A60BDFB354D06F32
5E3CBF1204F069C8F4474D492A361CCD
378D3B51D99A076B2E978EDB669581D0
76633D2AB766B70D281F018B53E3314C
Query:
SELECT event_name,
  COUNT(DISTINCT CASE WHEN DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)),
                                     DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)),
                                     DAY) BETWEEN 8 AND 14 THEN user_pseudo_id END) AS retained_users,
  COUNT(DISTINCT user_pseudo_id) AS total_users,
  SAFE_DIVIDE(
    COUNT(DISTINCT CASE WHEN DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)),
                                       DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)),
                                       DAY) BETWEEN 8 AND 14 THEN user_pseudo_id END),
    COUNT(DISTINCT user_pseudo_id)
  ) AS retention_rate
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE event_name LIKE '%quickplay%'
  AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-08-01' AND '2018-08-15'
GROUP BY event_name
ORDER BY retention_rate ASC
LIMIT 1
Answer:
event_name,retained_users,total_users,retention_rate
level_retry_quickplay,15,182,0.08241758241758242
End Exploring Related Columns
Task: Which quickplay event type had the lowest user retention rate during the second week after their initial engagement, for users who first engaged between August 1 and August 15, 2018?

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
Event_Type,Second_Week_Retention_Rate
event_type:str,retention_rate:float
(Attention: answer in one row)
```

**Explanation:**

To identify the quickplay event type with the lowest user retention rate during the second week after initial engagement for users who first engaged between August 1 and August 15, 2018, we would perform the following steps:

1. **Filter Users by Initial Engagement Date:**
   - Select users whose first engagement (`user_first_touch_timestamp`) occurred between August 1 and August 15, 2018.

2. **Identify Quickplay Event Types:**
   - From the `event_name` field, filter events related to quickplay activities.
   - Extract the specific quickplay event types from the `event_params` where applicable.

3. **Calculate Second Week Retention Rate:**
   - For each quickplay event type, calculate the proportion of users who returned to engage with the app during the second week (days 8-14 after their initial engagement).

4. **Determine the Lowest Retention Rate:**
   - Compare the retention rates across all quickplay event types.
   - Identify the event type with the lowest retention rate.

Without access to the actual dataset, we cannot provide the specific event type and retention rate. However, the result should be formatted as shown above, with one row indicating the quickplay event type that had the lowest retention during the specified period..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180612', 'events_20180613', 'events_20180614', 'events_20180615', 'events_20180616', 'events_20180617', 'events_20180618', 'events_20180619', 'events_20180620', 'events_20180621', 'events_20180622', 'events_20180623', 'events_20180624', 'events_20180625', 'events_20180626', 'events_20180627', 'events_20180628', 'events_20180629', 'events_20180630', 'events_20180701', 'events_20180702', 'events_20180703', 'events_20180704', 'events_20180705', 'events_20180706', 'events_20180707', 'events_20180708', 'events_20180709', 'events_20180710', 'events_20180711', 'events_20180712', 'events_20180713', 'events_20180714', 'events_20180715', 'events_20180716', 'events_20180717', 'events_20180718', 'events_20180719', 'events_20180720', 'events_20180721', 'events_20180722', 'events_20180723', 'events_20180724', 'events_20180725', 'events_20180726', 'events_20180727', 'events_20180728', 'events_20180729', 'events_20180730', 'events_20180731', 'events_20180801', 'events_20180802', 'events_20180803', 'events_20180804', 'events_20180805', 'events_20180806', 'events_20180807', 'events_20180808', 'events_20180809', 'events_20180810', 'events_20180811', 'events_20180812', 'events_20180813', 'events_20180814', 'events_20180815', 'events_20180816', 'events_20180817', 'events_20180818', 'events_20180819', 'events_20180820', 'events_20180821', 'events_20180822', 'events_20180823', 'events_20180824', 'events_20180825', 'events_20180826', 'events_20180827', 'events_20180828', 'events_20180829', 'events_20180830', 'events_20180831', 'events_20180901', 'events_20180902', 'events_20180903', 'events_20180904', 'events_20180905', 'events_20180906', 'events_20180907', 'events_20180908', 'events_20180909', 'events_20180910', 'events_20180911', 'events_20180912', 'events_20180913', 'events_20180914', 'events_20180915', 'events_20180916', 'events_20180917', 'events_20180918', 'events_20180919', 'events_20180920', 'events_20180921', 'events_20180922', 'events_20180923', 'events_20180924', 'events_20180925', 'events_20180926', 'events_20180927', 'events_20180928', 'events_20180929', 'events_20180930', 'events_20181001', 'events_20181002', 'events_20181003']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-23 14:51:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 14:51:13 - root - INFO - ```sql
SELECT
  ep.value.string_value AS Event_Type,
  SAFE_DIVIDE(
    COUNT(DISTINCT CASE WHEN DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)),
                                       DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)),
                                       DAY) BETWEEN 8 AND 14 THEN user_pseudo_id END),
    COUNT(DISTINCT user_pseudo_id)
  ) AS Second_Week_Retention_Rate
FROM `firebase-public-project.analytics_153293282.events_*`,
UNNEST(event_params) AS ep
WHERE event_name = 'quickplay'
  AND ep.key = 'event_type'
  AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-08-01' AND '2018-08-15'
GROUP BY Event_Type
ORDER BY Second_Week_Retention_Rate ASC
LIMIT 1
```
2025-01-23 14:51:21 - root - INFO - itercount: 1
2025-01-23 14:51:21 - root - INFO - No data found for the specified query.

2025-01-23 14:51:21 - root - INFO - Input sql:
SELECT
  ep.value.string_value AS Event_Type,
  SAFE_DIVIDE(
    COUNT(DISTINCT CASE WHEN DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)),
                                       DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)),
                                       DAY) BETWEEN 8 AND 14 THEN user_pseudo_id END),
    COUNT(DISTINCT user_pseudo_id)
  ) AS Second_Week_Retention_Rate
FROM `firebase-public-project.analytics_153293282.events_*`,
UNNEST(event_params) AS ep
WHERE event_name = 'quickplay'
  AND ep.key = 'event_type'
  AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-08-01' AND '2018-08-15'
GROUP BY Event_Type
ORDER BY Second_Week_Retention_Rate ASC
LIMIT 1
The error information is:
 No data found for the specified query.

2025-01-23 14:52:11 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 14:52:11 - root - INFO - ```sql
SELECT
  event_name AS Event_Type,
  SAFE_DIVIDE(
    COUNT(DISTINCT CASE WHEN DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)),
                                       DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)),
                                       DAY) BETWEEN 8 AND 14 THEN user_pseudo_id END),
    COUNT(DISTINCT user_pseudo_id)
  ) AS Second_Week_Retention_Rate
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE event_name LIKE '%_quickplay'
  AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-08-01' AND '2018-08-15'
GROUP BY Event_Type
ORDER BY Second_Week_Retention_Rate ASC
LIMIT 1
```
2025-01-23 14:52:18 - root - INFO - itercount: 2
2025-01-23 14:52:18 - root - INFO - 0
2025-01-23 14:52:18 - root - INFO - results: 
Event_Type,Second_Week_Retention_Rate
level_retry_quickplay,0.08241758241758242


2025-01-23 14:52:18 - root - INFO - Please check the answer again by reviewing Which quickplay event type had the lowest user retention rate during the second week after their initial engagement, for users who first engaged between August 1 and August 15, 2018?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Event_Type,Second_Week_Retention_Rate
event_type:str,retention_rate:float
(Attention: answer in one row)
```

**Explanation:**

To identify the quickplay event type with the lowest user retention rate during the second week after initial engagement for users who first engaged between August 1 and August 15, 2018, we would perform the following steps:

1. **Filter Users by Initial Engagement Date:**
   - Select users whose first engagement (`user_first_touch_timestamp`) occurred between August 1 and August 15, 2018.

2. **Identify Quickplay Event Types:**
   - From the `event_name` field, filter events related to quickplay activities.
   - Extract the specific quickplay event types from the `event_params` where applicable.

3. **Calculate Second Week Retention Rate:**
   - For each quickplay event type, calculate the proportion of users who returned to engage with the app during the second week (days 8-14 after their initial engagement).

4. **Determine the Lowest Retention Rate:**
   - Compare the retention rates across all quickplay event types.
   - Identify the event type with the lowest retention rate.

Without access to the actual dataset, we cannot provide the specific event type and retention rate. However, the result should be formatted as shown above, with one row indicating the quickplay event type that had the lowest retention during the specified period. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Event_Type,Second_Week_Retention_Rate
level_retry_quickplay,0.08241758241758242
Current sql:
SELECT
  event_name AS Event_Type,
  SAFE_DIVIDE(
    COUNT(DISTINCT CASE WHEN DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)),
                                       DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)),
                                       DAY) BETWEEN 8 AND 14 THEN user_pseudo_id END),
    COUNT(DISTINCT user_pseudo_id)
  ) AS Second_Week_Retention_Rate
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE event_name LIKE '%_quickplay'
  AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-08-01' AND '2018-08-15'
GROUP BY Event_Type
ORDER BY Second_Week_Retention_Rate ASC
LIMIT 1
2025-01-23 14:53:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 14:53:05 - root - INFO - ```sql
SELECT
  event_name AS Event_Type,
  ROUND(
    SAFE_DIVIDE(
      COUNT(DISTINCT CASE WHEN DATE_DIFF(DATE(TIMESTAMP_MICROS(event_timestamp)),
                                         DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)),
                                         DAY) BETWEEN 8 AND 14 THEN user_pseudo_id END),
      COUNT(DISTINCT user_pseudo_id)
    ),
    4
  ) AS Second_Week_Retention_Rate
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE event_name LIKE '%_quickplay'
  AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-08-01' AND '2018-08-15'
GROUP BY Event_Type
ORDER BY Second_Week_Retention_Rate ASC
LIMIT 1
```
2025-01-23 14:53:12 - root - INFO - itercount: 3
2025-01-23 14:53:12 - root - INFO - 0
2025-01-23 14:53:12 - root - INFO - Total iteration counts: 3
