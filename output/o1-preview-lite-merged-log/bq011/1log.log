2025-01-23 22:42:56 - openai._base_client - INFO - Retrying request to /chat/completions in 0.377894 seconds
2025-01-23 22:44:12 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-23 22:44:14 - root - INFO - SQL:
SELECT DISTINCT user_pseudo_id, event_date
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210106`
   LIMIT 100;
Results:
user_pseudo_id,event_date
1001303.4827739208,20210106
1014060.1100191558,20210106
1015239.8458513676,20210106
1023213.5350684501,20210106
1025773.0920505617,20210106
1033020.5841925327,20210106
1042140.6802444773,20210106
1045720.9269650087,20210106
1049106.9990499157,20210106
1049739.7909391395,20210106
1060274.1098179258,20210106
1065322.6541302193,20210106
1069165.2811408476,20210106
1069494.0113686800,20210106
1072513.2161702512,20210106
1075240.7394043586,20210106
1075333.9269112947,20210106
1078788.8328338285,20210106
1081165.5314971225,20210106
1083792.6034832516,20210106
1084471.2677471598,20210106
1086668.0925005810,20210106
1086843.9052907013,20210106
1087271.0550084610,20210106
1087808.3711873816,20210106
1095740.4839642689,20210106
1111626.7442894456,20210106
1114964.3576383224,20210106
1115377.5526866793,20210106
1118833.2974558782,20210106
1126378.6956818362,20210106
1128261.6033595713,20210106
1128289.3662024583,20210106
1130911.8567954377,20210106
1133313.1103337373,20210106
1133962.3740970739,20210106
1135774.0646413552,20210106
1141870.4386338572,20210106
1144150.5821344535,20210106
1144792.8191246270,20210106
1146837.4730107711,20210106
1148615.3691736909,20210106
1151687.1996189042,20210106
1153093.0119048067,20210106
1160488.2375923167,20210106
1163998.9977514528,20210106
1169456.0744217795,20210106
1170673.0496256889,20210106
1173439.7311015929,20210106
1175417.7164964556,20210106
1177018.6074439798,20210106
1180762.6954492448,20210106
1185502.9456478888,20210106
1185607.4529846208,20210106
1211099.8247563235,20210106
1213730.2023854144,20210106
1214408.9886831537,20210106
1214882.5762650867,20210106
1216128.7020381390,20210106
1218031.2772164166,20210106
1221611.6181416961,20210106
1223402.7111643409,20210106
1224512.5360000287,20210106
1230929.5891057900,20210106
1243180.2889994882,20210106
1245742.1517954276,20210106
1250075.3055872841,20210106
1251677.0033366371,20210106
1252675.9812778248,20210106
1253621.4143036992,20210106
1255130.2864074728,20210106
1256871.5825332697,20210106
1257670.9852008771,20210106
1259037.7018534149,20210106
1264306.5410019941,20210106
1270650.6052564575,20210106

2025-01-23 22:44:15 - root - INFO - SQL:
SELECT DISTINCT user_pseudo_id, event_date
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210107`
   LIMIT 100;
Results:
user_pseudo_id,event_date
1000557.2911835023,20210107
1002616.3660015684,20210107
1008726.7423030385,20210107
1009541.6887464068,20210107
1009676.4905193951,20210107
1016428.1065641732,20210107
1019574.8776308935,20210107
1020795.7432964012,20210107
1028144.2081628525,20210107
1030326.1353640844,20210107
1036021.1054561259,20210107
1043511.9901401232,20210107
1046404.1129546883,20210107
1056020.6709260931,20210107
1063386.3828577009,20210107
1066407.3757892113,20210107
1072012.7284818935,20210107
1073430.9059120582,20210107
1087808.3711873816,20210107
1091162.1989694199,20210107
1098584.0776604006,20210107
1099671.3398238118,20210107
1100949.9283905733,20210107
1104189.1961360907,20210107
1107549.5710254296,20210107
1109808.6106046131,20210107
1114216.0904812151,20210107
1116865.4647068394,20210107
1122146.8997157148,20210107
1124540.2333393152,20210107
1132479.2425986879,20210107
1132946.8730897471,20210107
1138520.5891734753,20210107
1144754.6830399719,20210107
1149393.9441120966,20210107
1150257.3416332583,20210107
1150418.5729329589,20210107
1151529.7874029554,20210107
1151687.1996189042,20210107
1163998.9977514528,20210107
1166484.2621554560,20210107
1168153.2069804316,20210107
1169660.2704170325,20210107
1172211.4577928962,20210107
1174920.8866835138,20210107
1177876.9777589683,20210107
1181141.8389731329,20210107
1182923.0909175622,20210107
1186421.2997808469,20210107
1194177.8166317724,20210107
1195966.3969559148,20210107
1196040.9501767394,20210107
1209023.5496836341,20210107
1224731.3666771048,20210107
1227321.4549113942,20210107
1231601.8963574336,20210107
1237924.3309856915,20210107
1242735.7779476738,20210107
1246241.1259892311,20210107
1247293.4194247843,20210107
1256871.5825332697,20210107
1263510.2346903431,20210107
1266942.9616912837,20210107
1272559.2391561764,20210107
1275281.1401174806,20210107
1276927.7607362138,20210107
1280885.4587684428,20210107
1283562.7271739130,20210107
1287483.1535140122,20210107
1289021.8467378906,20210107
1291324.6496937233,20210107
1295828.0586489111,20210107
1296777.6630043403,20210107
1299775.3014967415,20210107
1304171.0604038711,20210107
1309980.6522015685,20210107

2025-01-23 22:44:18 - root - INFO - SQL:
SELECT DISTINCT user_pseudo_id, event_date
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
   LIMIT 100;
Results:
user_pseudo_id,event_date
1005484.1092567297,20210102
1019468.5334749980,20210102
1020695.6921096883,20210102
1034552.3956022963,20210102
1035433.9962487028,20210102
1054184.5156674867,20210102
1055969.5872512303,20210102
1104189.1961360907,20210102
1127197.7845904071,20210102
1134613.7634894426,20210102
1137060.9310088729,20210102
1140798.4477437179,20210102
1160488.2375923167,20210102
1161350.5694934880,20210102
1164110.7921696016,20210102
1219168.5485233162,20210102
1239682.4582755521,20210102
1246097.1442578537,20210102
1250553.7197007147,20210102
1253534.6863073074,20210102
1254621.7726451069,20210102
1272248.3527408128,20210102
1273851.7434031787,20210102
1274599.3928448053,20210102
1278408.9014565519,20210102
1279602.6727600031,20210102
1293446.1816560362,20210102
1296701.2382814729,20210102
1299487.6744511638,20210102
1314847.4544971351,20210102
1315049.1291069189,20210102
1325116.8912286004,20210102
1334700.6047036975,20210102
1359861.1338029424,20210102
1364085.2107948688,20210102
1370461.9318815596,20210102
1380837.6952136083,20210102
1381565.5047705405,20210102
1382535.7283137323,20210102
1390300.4796021112,20210102
1392466.8272664309,20210102
1402138.5184246691,20210102
1405619.5662753913,20210102
1413270.7201714861,20210102
1440319.2684459003,20210102
1441065.6470414018,20210102
1442997.6750483462,20210102
1470601.3891204117,20210102
1482331.8123183039,20210102
1505379.6854768255,20210102
1507645.2354095566,20210102
1508520.3631208357,20210102
1524258.4980135729,20210102
1537916.6494875994,20210102
1550647.9864364390,20210102
1587120.7886409442,20210102
1587333.3490610470,20210102
1595062.2978681339,20210102
1619900.3195973863,20210102
1621047.1809785712,20210102
1650186.4171427739,20210102
1652787.4806754655,20210102
1653230.5444867771,20210102
1661549.9249699570,20210102
1664037.8368386837,20210102
1664926.0864851694,20210102
1679710.5467997846,20210102
1684439.4801767659,20210102
1688021.5951717579,20210102
1689822.6628262328,20210102
1695729.1971283274,20210102
1698322.2974178584,20210102
1699537.8074625037,20210102
1704767.6168359047,20210102
1708071.1093492535,20210102
1720808.5659233423,20210102

2025-01-23 22:44:20 - root - INFO - SQL:
SELECT COUNT(DISTINCT user_pseudo_id) AS num_users
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105';
Results:
num_users
16204

2025-01-23 22:44:22 - root - INFO - SQL:
SELECT DISTINCT user_pseudo_id
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
   LIMIT 100;
Results:
user_pseudo_id
1005484.1092567297
1019468.5334749980
1020695.6921096883
1034552.3956022963
1035433.9962487028
1054184.5156674867
1055969.5872512303
1104189.1961360907
1127197.7845904071
1134613.7634894426
1137060.9310088729
1140798.4477437179
1160488.2375923167
1161350.5694934880
1164110.7921696016
1219168.5485233162
1239682.4582755521
1246097.1442578537
1250553.7197007147
1253534.6863073074
1254621.7726451069
1272248.3527408128
1273851.7434031787
1274599.3928448053
1278408.9014565519
1279602.6727600031
1293446.1816560362
1296701.2382814729
1299487.6744511638
1314847.4544971351
1315049.1291069189
1325116.8912286004
1334700.6047036975
1359861.1338029424
1364085.2107948688
1370461.9318815596
1380837.6952136083
1381565.5047705405
1382535.7283137323
1390300.4796021112
1392466.8272664309
1402138.5184246691
1405619.5662753913
1413270.7201714861
1440319.2684459003
1441065.6470414018
1442997.6750483462
1470601.3891204117
1482331.8123183039
1505379.6854768255
1507645.2354095566
1508520.3631208357
1524258.4980135729
1537916.6494875994
1550647.9864364390
1587120.7886409442
1587333.3490610470
1595062.2978681339
1619900.3195973863
1621047.1809785712
1650186.4171427739
1652787.4806754655
1653230.5444867771
1661549.9249699570
1664037.8368386837
1664926.0864851694
1679710.5467997846
1684439.4801767659
1688021.5951717579
1689822.6628262328
1695729.1971283274
1698322.2974178584
1699537.8074625037
1704767.6168359047
1708071.1093492535
1720808.5659233423
1721354.6818865235
1722117.4481798918
1746667.8607565392
1778028.3352091849
1788337.3157672800
1793640.9588973139
1804084.9503910975
1810164.8096235223
1821461.3337986263
1824121.5656787337
1846974.0316175078
1849787.1417367270
1862279.2644343817
1873058.4156402266
1928081.8451007978
1929880.8943789391
1941137.5727282147
1946378.2604112351
1946567.8498627659
1966814.1086113170
1977599.8253595252
1988973.6797776774
1989653.0310679976
1990491.3893000361

2025-01-23 22:44:24 - root - INFO - SQL:
SELECT DISTINCT user_pseudo_id
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX IN ('20210106', '20210107')
   LIMIT 100;
Results:
user_pseudo_id
1000557.2911835023
1002616.3660015684
1008726.7423030385
1009541.6887464068
1009676.4905193951
1016428.1065641732
1019574.8776308935
1020795.7432964012
1028144.2081628525
1030326.1353640844
1036021.1054561259
1043511.9901401232
1046404.1129546883
1056020.6709260931
1063386.3828577009
1066407.3757892113
1072012.7284818935
1073430.9059120582
1087808.3711873816
1091162.1989694199
1098584.0776604006
1099671.3398238118
1100949.9283905733
1104189.1961360907
1107549.5710254296
1109808.6106046131
1114216.0904812151
1116865.4647068394
1122146.8997157148
1124540.2333393152
1132479.2425986879
1132946.8730897471
1138520.5891734753
1144754.6830399719
1149393.9441120966
1150257.3416332583
1150418.5729329589
1151529.7874029554
1151687.1996189042
1163998.9977514528
1166484.2621554560
1168153.2069804316
1169660.2704170325
1172211.4577928962
1174920.8866835138
1177876.9777589683
1181141.8389731329
1182923.0909175622
1186421.2997808469
1194177.8166317724
1195966.3969559148
1196040.9501767394
1209023.5496836341
1224731.3666771048
1227321.4549113942
1231601.8963574336
1237924.3309856915
1242735.7779476738
1246241.1259892311
1247293.4194247843
1256871.5825332697
1263510.2346903431
1266942.9616912837
1272559.2391561764
1275281.1401174806
1276927.7607362138
1280885.4587684428
1283562.7271739130
1287483.1535140122
1289021.8467378906
1291324.6496937233
1295828.0586489111
1296777.6630043403
1299775.3014967415
1304171.0604038711
1309980.6522015685
1317681.8410322222
1320383.7530644264
1329436.8221805419
1332979.8914503740
1333728.0047687977
1342173.6511298548
1342397.5707081379
1357251.3765617872
1359026.8307338454
1362228.4966015575
1364505.7481550412
1366103.4269040146
1366281.7261580221
1366363.8080922440
1369023.5738995470
1374932.4478575733
1378696.4627477130
1385336.9757682390
1390701.8959589858
1403236.7518250436
1404246.6716592021
1404269.7082895339
1406007.4609789626
1406098.2272398299

2025-01-23 22:44:27 - root - INFO - SQL:
SELECT DISTINCT user_pseudo_id
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
     AND user_pseudo_id NOT IN (
       SELECT DISTINCT user_pseudo_id
       FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
       WHERE _TABLE_SUFFIX IN ('20210106', '20210107')
     )
   LIMIT 100;
Results:
user_pseudo_id
1008499.5928445086
1013760.9231029745
1014209.5295344253
1026137.2290719007
1028167.1226079449
1032092.5249707229
1053193.3273260382
1057066.6724870774
1057265.5844727802
1065673.0722289663
1067841.4647153954
1075223.2681702246
1082690.0377265261
1103286.8251708796
1109836.9501901728
1113469.1950253831
1114181.7368629788
1121518.2859510925
1130810.6137694456
1134613.7634894426
1158637.0383647084
1164741.6860607634
1181674.5265741661
1185078.3105419781
1194575.2891034137
1214573.9183644653
1215389.2295507570
1222867.5284822262
1227012.8467411408
1238230.5582832258
1243221.1777211525
1252690.3944441209
1284535.4676055384
1288248.9113459714
1289319.0865612371
1297488.8153560940
1299487.6744511638
1307038.3688504236
1309149.1848587742
1313329.6311058857
1314747.6066644573
1320284.3859724504
1325688.1519909745
1334969.6157017719
1339205.5397897099
1373324.8357357420
1385090.1246142947
1385662.1127085473
1401785.6584445113
1402228.3482241994
1403129.5580554677
1445737.4102905419
1450787.9898569840
1458803.4123039458
1466910.4554610435
1470241.3611852177
1471187.8226858001
1488009.3142808321
1493030.0825468207
1497130.5055593166
1500615.9964438412
1504953.0746977838
1509456.3177418451
1519189.6398973848
1522857.5896662267
1536105.5891820566
1544748.2905250855
1556885.1837167077
1560589.3791460585
1578948.0834575091
1586022.1800460720
1588332.2823326217
1588666.3949365829
1590715.7165540392
1607100.0381093527
1622235.9923526878
1624884.8451928269
1629639.2044968342
1632927.1894987991
1634789.3752037441
1639296.9002795622
1648032.7331818100
1656975.3346712388
1659842.4321850950
1665661.9122532614
1668023.4150976276
1668416.2014466630
1672632.0859250572
1690623.2302780540
1702019.9842929153
1702845.7520261284
1703253.2388947937
1707319.9934501562
1711048.6268268364
1711971.4968010332
1726993.2463217900
1730497.6226428479
1732811.6786855240
1745835.9106014489
1751599.1685077136

2025-01-23 22:44:29 - root - INFO - SQL:
SELECT COUNT(DISTINCT user_pseudo_id) AS num_inactive_last_2_days
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
     AND user_pseudo_id NOT IN (
       SELECT DISTINCT user_pseudo_id
       FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
       WHERE _TABLE_SUFFIX IN ('20210106', '20210107')
     );
Results:
num_inactive_last_2_days
15717

2025-01-23 22:44:35 - root - INFO - SQL:
SELECT user_pseudo_id, MAX(event_date) AS last_active_date
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   GROUP BY user_pseudo_id
   ORDER BY last_active_date DESC
   LIMIT 100;
Results:
user_pseudo_id,last_active_date
5384477.9498815631,20210131
54181384.6639346152,20210131
2306891.5881158976,20210131
3970566.6686455359,20210131
6188924.0795024082,20210131
6837066.8369852470,20210131
7053762.4921201809,20210131
5707727.8343681091,20210131
2232307.9659041751,20210131
1452608.3167122597,20210131
2731138.9741032000,20210131
4204202.0575386809,20210131
4395997.6326699835,20210131
6098555.6597219815,20210131
6037143.3698637442,20210131
6381734.4884917250,20210131
6447209.1288995618,20210131
6887977.7283471204,20210131
2550351.4004742366,20210131
7295539.7639750860,20210131
7355211.5896529973,20210131
36219200.2450144482,20210131
62372594.2230785944,20210131
80472823.8221568698,20210131
1414481.4058323058,20210131
89646304.1267047297,20210131
1542823.5350910604,20210131
3949118.2086925672,20210131
2504135.3103808694,20210131
3377476.0397619798,20210131
3654210.8993375670,20210131
4360208.7303031029,20210131
4261558.6534177854,20210131
4524491.1203839244,20210131
4572500.9649745259,20210131
6581752.7028135402,20210131
5423500.0718346384,20210131
6085099.3469751032,20210131
1701304.3521647771,20210131
6580553.2974136047,20210131
6294121.4760347945,20210131
6550128.6556885931,20210131
6509428.5351700845,20210131
7607516.8270926536,20210131
6746274.5485589022,20210131
6863554.1519524743,20210131
6852600.3732416116,20210131
7594533.9551776618,20210131
7278331.4509008097,20210131
7437038.9583984363,20210131
7366860.4627232501,20210131
25804281.1662573356,20210131
52437634.0997373243,20210131
46687121.4792925719,20210131
7219615.9655825331,20210131
61900815.4495081739,20210131
5706715.6852183826,20210131
1908420.3631481360,20210131
5613969.9742050087,20210131
1114805.9678711833,20210131
3124160.8176335256,20210131
1770895.0629130836,20210131
1513929.8132540010,20210131
1660287.8904776521,20210131
1565274.6149340210,20210131
5096303.3218407804,20210131
2177092.9819667753,20210131
2567984.2109902410,20210131
2540425.9025017966,20210131
3929705.5453066142,20210131

2025-01-23 22:44:37 - root - INFO - SQL:
SELECT user_pseudo_id, COUNT(*) AS total_events
    FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
    WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
    GROUP BY user_pseudo_id
    ORDER BY total_events DESC
    LIMIT 100;
Results:
user_pseudo_id,total_events
72522849.6381089738,1011
1160488.2375923167,486
8826950.4971866604,453
91675873.1352298917,388
8962597.7306180902,375
77052125.0799530822,367
75073588.1859607099,346
5995428.1774914766,324
2783014.3813479767,318
2885429.0157235569,308
61443972.0251565668,285
10273164.5274553015,277
5237743.2231683146,274
28134106.1591086954,274
73370809.3757379160,258
1181671929.7227404022,255
5528825.5598647448,254
7509303346.8821447922,246
3481692.1528741899,241
59533896.5320638489,238
75571709.1157982540,236
18637647.0398129287,236
6283343.2195449706,234
25712283.2548580985,233
77137495.6810904691,224
2962062.5636750914,224
30168787.8236845550,220
68044587.8089465417,219
6580445.4141083514,215
4379421.9669036501,214
5563930.3593101391,207
7329327.2927230381,201
3593045.4474754034,198
8447373.0647826021,196
65723051.6260769230,196
84647660.6681637188,193
4361543.5487737593,193
6457394.0467289981,192
53550354.6354713181,191
7801689.0887224805,190
1831988.5850596638,189
32721322.9309758062,189
77327261.9614153178,185
38593238.7395910294,184
87047667.1042912591,181
76004533.4024306206,181
26275601.6544751761,180
8316881.1639820242,178
7658396.5746251975,177
8186100.1619066340,175
56934240.7101927692,171
5476414.5180022673,171
5712577.1182625340,167
80435974.9462183494,165
68546038.8820428933,163
59487571.9263599382,161
4256704.8631439486,158
87116489.5307133653,155
12171949.5894096795,152
35618258.9089360337,152
51620649.6628743276,152
46574324.9683380755,151
24207018.3974015161,151
1662132.7705678436,150
87600401.0863764142,150
15046526.4562004600,150
6867779.6634381231,149
3218982.5426906645,149
53104811.8176614311,148
6693629.3972852700,146
3830673.4752434108,145
17007406.8391181695,144
5206026.1238630154,143
9013012176.4270996551,142
7515221.4303230400,141
2838161.4781702653,141
39214432.1935349913,140
7312667.0266395141,139
2689155.5329072803,139
72065348.6852495696,138
4823937.0668099247,138
5765850.5948282569,137

2025-01-23 22:44:39 - root - INFO - SQL:
SELECT user_pseudo_id, COUNT(DISTINCT event_date) AS active_days
    FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
    WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
    GROUP BY user_pseudo_id
    ORDER BY active_days DESC
    LIMIT 100;
Results:
user_pseudo_id,active_days
35626767.1610925268,4
85143797.2924753997,4
1620024.8966870933,4
87031079.7645841833,4
40706056.2511798572,4
6062554.7906717165,4
1160488.2375923167,4
7708361.6535656281,4
79738620.9762581140,4
1846974.0316175078,4
9197973422.7962893360,4
67866911.1234232513,4
2914301.0348640426,4
17494077.2658372366,3
53550354.6354713181,3
11715287.1856783702,3
87431455.4720611025,3
6867779.6634381231,3
57603603.5966139385,3
6003584.8390086616,3
26521546.0674230641,3
8233454.3379625056,3
4879339583.5496818035,3
7870833.4699729595,3
82341069.9606353557,3
64740644.1898496568,3
76643441.1450027892,3
1272248.3527408128,3
35803369.9832881217,3
58751681.2860417490,3
2415858.4972221670,3
54849802.7178369899,3
30168787.8236845550,3
50578688.8876839400,3
34624309.5002944900,3
28863050.0190727043,3
22359493.8173138206,3
32881481.2798882282,3
75073588.1859607099,3
24270666.3229091625,3
8474319.5976877954,3
11321750.4742481705,3
1296701.2382814729,3
8321773.5852938935,3
74526828.7802183173,3
2116278.5223204033,3
4739295590.7137248905,3
82573497.6736006028,3
6508378.3076839473,3
3218982.5426906645,3
77095533.4633569673,3
2885429.0157235569,3
6512021.3913056139,3
3608752.7415487370,3
70783127.9745040800,3
3807842.5003018860,3
3024189.6101670146,3
4980906.4887239358,3
87047667.1042912591,3
15493794.4663857188,3
8317362.6638454021,3
1134613.7634894426,3
70969614.1264783832,3
92683406.5958530398,3
73401773.9247733438,3
38979725.4080855713,3
628363132.9737513033,3
4613600.3132097866,3
5237743.2231683146,3
29057959.6356005819,3
2364299980.1335009029,3
5533943.3723773395,3
4998829.5943843958,3
5298013.7728745800,3
39580321.2479069337,3
3593045.4474754034,3
15817556.8554808751,3
31997071.8879272719,3
5687566.9810985467,3
478573643.2008174418,3
39400502.5089704609,3
41491167.6079853280,3
28134106.1591086954,3
6340026.2480718860,3
31588757.8825339636,3
43190558.9792678700,3

2025-01-23 22:44:42 - root - INFO - SQL:
SELECT event_name, COUNT(*) AS event_count
    FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
    WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
      AND user_pseudo_id NOT IN (
        SELECT DISTINCT user_pseudo_id
        FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
        WHERE _TABLE_SUFFIX IN ('20210106', '20210107')
      )
    GROUP BY event_name
    ORDER BY event_count DESC
    LIMIT 100;
Results:
event_name,event_count
page_view,55785
user_engagement,32013
session_start,17350
scroll,15948
first_visit,14326
view_item,9680
view_promotion,6620
add_to_cart,1953
view_search_results,1091
select_item,1084
begin_checkout,1043
select_promotion,382
add_shipping_info,350
add_payment_info,238
purchase,98
click,46
view_item_list,2

2025-01-23 22:44:44 - root - INFO - SQL:
SELECT DISTINCT user_pseudo_id
    FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20201231`
    LIMIT 100;
Results:
user_pseudo_id
1005538.3649404164
1007822.0143885764
1012230.4994195474
1017550.8288979991
1023023.2921190090
1028911.7693473709
1029606.8656858595
1037158.8475831089
1051653.5256730522
1057601.7061041846
1064366.5469179996
1067524.5286739051
1068031.1881049163
1068648.9747588990
1081526.2412894517
1092386.7291273764
1097358.9593491100
1099576.0088122125
1112823.8475775772
1118372.6021864798
1135884.3844671728
1140362.3036690432
1142186.0437190455
1146958.5854170549
1154103.8686878196
1162882.0752628116
1168346.1523648950
1172807.9635433168
1181405.5477188586
1187761.9507381898
1192426.0949360808
1194648.3751143691
1195792.9356819846
1215072.9069605727
1216338.5369962039
1224050.4895876793
1243710.2264579308
1244346.0466737657
1246635.4183548484
1251850.4420344250
1256938.4560037658
1265302.9612079936
1266626.9045303725
1291623.5148415230
1296701.2382814729
1298008.7517139276
1313851.6501590410
1314671.9936382428
1322502.1007573387
1322713.7189196627
1330572.5811248888
1333375.4691057157
1341286.4997396694
1361848.9776305937
1381989.0678727048
1396394.0876521065
1396456.6482506733
1406426.9025557519
1407963.5410246985
1415261.6242394832
1418897.7549791129
1418940.5985366597
1431095.2661797808
1434548.8581092193
1439772.4403592593
1441360.7472237203
1455644.0190003959
1460777.6123243529
1476543.3841079300
1482350.8184957804
1491881.7963023734
1495750.4504271032
1499937.3663407621
1509573.7234095332
1518064.1016389841
1526283.2496942169
1549949.8165053292
1553572.5420163769
1555813.6193358968
1560771.0603511985
1575426.1027777782
1577045.7886668013
1586485.6838328335
1594068.4547320568
1601055.6961895519
1618110.1083676156
1620024.8966870933
1630738.7454569511
1641229.7584272112
1643795.2271280716
1650911.7579654264
1651839.0439255088
1652779.1906012580
1662132.7705678436
1664798.4020266855
1680111.9495223086
1680557.0646673079
1691420.3038930273
1699660.5250609225
1706250.4002681288

2025-01-23 22:44:46 - root - INFO - SQL:
SELECT event_count, COUNT(*) AS num_users
    FROM (
      SELECT user_pseudo_id, COUNT(*) AS event_count
      FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
      WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
      GROUP BY user_pseudo_id
    )
    GROUP BY event_count
    ORDER BY event_count ASC
    LIMIT 100;
Results:
event_count,num_users
1,12
2,198
3,816
4,1688
5,4781
6,3038
7,817
8,592
9,598
10,423
11,344
12,298
13,243
14,202
15,182
16,170
17,160
18,119
19,101
20,93
21,82
22,79
23,79
24,61
25,51
26,55
27,38
28,51
29,39
30,34
31,37
32,31
33,30
34,34
35,29
36,16
37,17
38,24
39,19
40,17
41,13
42,14
43,12
44,15
45,14
46,17
47,12
48,7
49,9
50,9
51,11
52,6
53,8
54,7
55,9
56,11
57,11
58,9
59,5
60,1
61,8
62,6
63,6
64,4
65,5
66,3
67,11
68,5
69,7
70,9
71,7
72,3
73,6
74,3
75,4
76,6
77,5
78,1
79,4
80,4
81,2
82,3
83,1
84,5
85,3
86,5
87,1
88,3
89,2
90,3
91,3
92,5
93,3
94,5
95,3
96,2
97,2
98,1
99,6
100,3

2025-01-23 22:44:48 - root - INFO - SQL:
SELECT DISTINCT user_pseudo_id
    FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
    WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
      AND user_pseudo_id NOT IN (
        SELECT DISTINCT user_pseudo_id
        FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
        WHERE _TABLE_SUFFIX > '20210105' AND _TABLE_SUFFIX <= '20210107'
      )
    LIMIT 100;
Results:
user_pseudo_id
1006764.2593478041
1011730.5937310445
1025554.7155857902
1028337.8871283783
1031058.2518048614
1032606.3576924541
1056329.7612609650
1068701.3018406914
1071257.2904972531
1075223.2681702246
1079374.1910653935
1082920.8892141550
1086535.4875940498
1089575.2761256602
1096553.1505774248
1102947.5096330985
1113194.4596973553
1115003.4680616065
1117874.3324542795
1122855.4085911936
1124854.6111785259
1129742.7402804867
1132555.2301002365
1133964.7947497780
1141770.2200021598
1172217.8534916097
1186112.8377343718
1187482.7824786316
1192643.6460701245
1197568.4892852272
1203853.5073281021
1204844.2691721789
1215841.5184851096
1218242.9191016186
1222409.1951536768
1225314.7220680786
1226878.4100446319
1241220.1441674551
1241629.8724178917
1243376.8542545034
1244606.6899321311
1247686.2070404262
1254011.7545907964
1258911.4567959870
1260992.5282234785
1261100.0843906075
1264993.3645153639
1272248.3527408128
1274495.5184398589
1275384.3626297214
1276342.9126460945
1278427.6141690556
1280266.1333397958
1284133.7579148747
1286945.3645505196
1291228.5655196810
1292185.5593921414
1301862.0758294607
1307038.3688504236
1307807.0071561878
1309149.1848587742
1318068.2020052683
1318879.8038263711
1321029.7577861325
1321742.4551192896
1325482.4574108673
1325688.1519909745
1326179.1742099424
1336694.6432583433
1342157.7728855384
1345509.3936713223
1348068.1593058656
1352587.0117468163
1356010.8691002356
1360671.0435504959
1379775.2562814073
1397822.5235180436
1399527.2790058720
1404886.4182310055
1414193.2963567157
1432451.2006018969
1434548.8581092193
1439687.4557873700
1455644.0190003959
1455809.7208111760
1457888.4327764965
1460768.9286238752
1469643.2045997031
1474066.3112067437
1484308.7242312753
1487082.6524856404
1490370.6853135246
1492265.2880623974
1493519.8322170424
1499710.7075498493
1512868.5635891160
1529263.1215051275
1529884.1932366182
1535511.8717950286
1537312.2917195558

2025-01-23 22:44:48 - root - INFO - itercount: 0
2025-01-23 22:44:48 - root - INFO - Database Name: bigquery-public-data
Schema Name: ga4_obfuscated_sample_ecommerce
DDL describes table information.
,0
table_name,events_20210109
ddl,"CREATE TABLE `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210109`
(
  event_date STRING,
  event_timestamp INT64,
  event_name STRING,
  event_params ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64>>>,
  event_previous_timestamp INT64,
  event_value_in_usd FLOAT64,
  event_bundle_sequence_id INT64,
  event_server_timestamp_offset INT64,
  user_id STRING,
  user_pseudo_id STRING,
  privacy_info STRUCT<analytics_storage INT64, ads_storage INT64, uses_transient_token STRING>,
  user_properties ARRAY<STRUCT<key INT64, value STRUCT<string_value INT64, int_value INT64, float_value INT64, double_value INT64, set_timestamp_micros INT64>>>,
  user_first_touch_timestamp INT64,
  user_ltv STRUCT<revenue FLOAT64, currency STRING>,
  device STRUCT<category STRING, mobile_brand_name STRING, mobile_model_name STRING, mobile_marketing_name STRING, mobile_os_hardware_model INT64, operating_system STRING, operating_system_version STRING, vendor_id INT64, advertising_id INT64, language STRING, is_limited_ad_tracking STRING, time_zone_offset_seconds INT64, web_info STRUCT<browser STRING, browser_version STRING>>,
  geo STRUCT<continent STRING, sub_continent STRING, country STRING, region STRING, city STRING, metro STRING>,
  app_info STRUCT<id STRING, version STRING, install_store STRING, firebase_app_id STRING, install_source STRING>,
  traffic_source STRUCT<medium STRING, name STRING, source STRING>,
  stream_id INT64,
  platform STRING,
  event_dimensions STRUCT<hostname STRING>,
  ecommerce STRUCT<total_item_quantity INT64, purchase_revenue_in_usd FLOAT64, purchase_revenue FLOAT64, refund_value_in_usd FLOAT64, refund_value FLOAT64, shipping_value_in_usd FLOAT64, shipping_value FLOAT64, tax_value_in_usd FLOAT64, tax_value FLOAT64, unique_items INT64, transaction_id STRING>,
  items ARRAY<STRUCT<item_id STRING, item_name STRING, item_brand STRING, item_variant STRING, item_category STRING, item_category2 STRING, item_category3 STRING, item_category4 STRING, item_category5 STRING, price_in_usd FLOAT64, price FLOAT64, quantity INT64, item_revenue_in_usd FLOAT64, item_revenue FLOAT64, item_refund_in_usd FLOAT64, item_refund FLOAT64, coupon STRING, affiliation STRING, location_id STRING, item_list_id STRING, item_list_name STRING, item_list_index STRING, promotion_id STRING, promotion_name STRING, creative_name STRING, creative_slot STRING>>
);"

Some other tables have the similar structure: ['events_20210109', 'events_20201109', 'events_20210110', 'events_20210123', 'events_20201107', 'events_20201111', 'events_20201228', 'events_20201224', 'events_20210119', 'events_20201105', 'events_20210131', 'events_20201218', 'events_20210124', 'events_20201222', 'events_20210103', 'events_20210127', 'events_20210108', 'events_20201120', 'events_20201130', 'events_20201124', 'events_20210104', 'events_20201115', 'events_20210128', 'events_20210121', 'events_20201114', 'events_20201127', 'events_20210111', 'events_20210118', 'events_20210113', 'events_20201212', 'events_20201113', 'events_20201221', 'events_20210112', 'events_20210120', 'events_20210101', 'events_20201209', 'events_20201206', 'events_20201225', 'events_20201129', 'events_20201112', 'events_20201230', 'events_20210115', 'events_20210107', 'events_20201210', 'events_20201121', 'events_20201215', 'events_20201229', 'events_20201123', 'events_20201204', 'events_20201201', 'events_20210102', 'events_20210106', 'events_20201205', 'events_20201226', 'events_20201211', 'events_20201203', 'events_20201102', 'events_20201106', 'events_20201213', 'events_20201128', 'events_20210105', 'events_20201220', 'events_20201117', 'events_20201231', 'events_20201208', 'events_20201108', 'events_20201214', 'events_20201207', 'events_20201223', 'events_20210117', 'events_20201219', 'events_20201110', 'events_20201122', 'events_20210130', 'events_20201216', 'events_20210126', 'events_20210129', 'events_20210125', 'events_20201227', 'events_20201126', 'events_20201217', 'events_20201101', 'events_20201116', 'events_20201103', 'events_20210122', 'events_20201104', 'events_20210114', 'events_20210116', 'events_20201119', 'events_20201125', 'events_20201118', 'events_20201202']
External knowledge that might be helpful: 
# GA4 - BigQuery Export schema

This article explains the format and schema of the Google Analytics 4 property data and the Google Analytics for Firebase data that is exported to BigQuery.

## Datasets

For each Google Analytics 4 property and each Firebase project that is linked to BigQuery, a single dataset named "analytics_<property_id>" is added to your BigQuery project. Property ID refers to your Analytics Property ID, which you can find in the property settings for your Google Analytics 4 property, and in App Analytics Settings in Firebase. Each Google Analytics 4 property and each app for which BigQuery exporting is enabled will export its data to that single dataset.

## Tables

Within each dataset, a table named `events_YYYYMMDD` is created each day if the Daily export option is enabled.

If the Streaming export option is enabled, a table named`events_intraday_YYYYMMDD`is created. This table is populated continuously as events are recorded throughout the day. This table is deleted at the end of each day once `events_YYYYMMDD` is complete.

Not all devices on which events are triggered send their data to Analytics on the same day the events are triggered. To account for this latency, Analytics will update the daily tables (`events_YYYYMMDD`) with events for those dates for up to three days after the dates of the events. Events will have the correct time stamp regardless of arriving late. Events that arrive after that three-day window are not recorded.

## Columns

Each column in the `events_YYYYMMDD`table represents an event-specific parameter. Note that some parameters are nested within RECORDS, and some RECORDS such as
`[items](https://support.google.com/analytics/answer/7029846?hl=en&ref_topic=9359001&sjid=16041154979191290935-EU#items)`
and
`[event_params](https://support.google.com/analytics/answer/7029846?hl=en&ref_topic=9359001&sjid=16041154979191290935-EU#event_params)`
are repeatable. Table columns are described below.

### event

The event fields contain information that uniquely identifies an event.

| Field name | Data type | Description |
|---|---|---|
| batch_event_index | INTEGER | A number indicating the sequential order of each event within a batch based on their order of occurrence on the device. |
| batch_ordering_id | INTEGER | A monotonically increasing number that is incremented each time a network request is sent from a given page. |
| batch_page_id | INTEGER | A sequential number assigned to a page that increases for each subsequent page within an engagement. |
| event_date | STRING | The date when the event was logged (YYYYMMDD format in the registered timezone of your app). |
| event_timestamp | INTEGER | The time (in microseconds, UTC) when the event was logged on the client. |
| event_previous_timestamp | INTEGER | The time (in microseconds, UTC) when the event was previously logged on the client. |
| event_name | STRING | The name of the event. |
| event_value_in_usd | FLOAT | The currency-converted value (in USD) of the event's "value" parameter. |
| event_bundle_sequence_id | INTEGER | The sequential ID of the bundle in which these events were uploaded. |
| event_server_timestamp_offset | INTEGER | Timestamp offset between collection time and upload time in micros. |

#### event_params RECORD

The event_params RECORD can store campaign-level and contextual event parameters as well as any user-defined event parameters. The event_params RECORD is repeated for each key that is associated with an event. The set of parameters stored in the event_params RECORD is unique to each implementation. To see the complete list of event parameters for your implementation, query the event parameter list.

| Field name | Data type | Description |
|---|---|---|
| event_params.key | STRING | The name of the event parameter. |
| event_params.value | RECORD | A record containing the event parameter's value. |
| event_params.value.string_value | STRING | If the event parameter is represented by a string, such as a URL or campaign name, it is populated in this field. |
| event_params.value.int_value | INTEGER | If the event parameter is represented by an integer, it is populated in this field. |
| event_params.value.double_value | FLOAT | If the event parameter is represented by a double value, it is populated in this field. |
| event_params.value.float_value | FLOAT | If the event parameter is represented by a floating point value, it is populated in this field. This field is not currently in use. |

#### item_params RECORD

The item_params RECORD can store item parameters as well as any user-defined item parameters. The set of parameters stored in the item_params RECORD is unique to each implementation.

| Field name | Data type | Description |
|---|---|---|
| item_params.key | STRING | The name of the item parameter. |
| item_params.value | RECORD | A record containing the item parameter’s value. |
| item_params.value.string_value | STRING | If the item parameter is represented by a string, it is populated in this field. |
| item_params.value.int_value | INTEGER | If the item parameter is represented by an integer, it is populated in this field. |
| item_params.value.double_value | FLOAT | If the item parameter is represented by a double value, it is populated in this field. |
| item_params.value.float_value | FLOAT | If the item parameter is represented by a floating point value, it is populated in this field. | 

### user

The user fields contain information that uniquely identifies the user associated with the event.

| Field name | Data type | Description |
|---|---|---|
| is_active_user | BOOLEAN | Whether the user was active (True) or inactive (False) at any point in the calendar day Included in only the daily tables ( events_YYYYMMDD) . |
| user_id | STRING | The unique ID assigned to a user. |
| user_pseudo_id | STRING | The pseudonymous id (e.g., app instance ID) for the user. |
| user_first_touch_timestamp | INTEGER | The time (in microseconds) at which the user first opened the app or visited the site. |

#### privacy_info fields

The privacy_info fields contain information based on the consent status of a user when consent mode is enabled .

| Field name | Data type | Description |
|---|---|---|
| privacy_info.ads_storage | STRING | Whether ad targeting is enabled for a user. Possible values: Yes, No, Unset |
| privacy_info.analytics_storage | STRING | Whether Analytics storage is enabled for the user. Possible values: Yes, No, Unset |
| privacy_info.uses_transient_token | STRING | Whether a web user has denied Analytics storage and the developer has enabled measurement without cookies based on transient tokens in server data. Possible values: Yes, No, Unset |

#### user_properties RECORD

The user_properties RECORD contains any user properties that you have set. It is repeated for each key that is associated with a user.

| Field name | Data type | Description |
|---|---|---|
| user_properties.key | STRING | The name of the user property. |
| user_properties.value | RECORD | A record for the user property value. |
| user_properties.value.string_value | STRING | The string value of the user property. |
| user_properties.value.int_value | INTEGER | The integer value of the user property. |
| user_properties.value.double_value | FLOAT | The double value of the user property. |
| user_properties.value.float_value | FLOAT | This field is currently unused. |
| user_properties.value.set_timestamp_micros | INTEGER | The time (in microseconds) at which the user property was last set. |

#### user_ltv RECORD

The user_ltv RECORD contains Lifetime Value information about the user. This RECORD is not populated in intraday tables.

| Field name | Data type | Description |
|---|---|---|
| user_ltv.revenue | FLOAT | The Lifetime Value (revenue) of the user. This field is not populated in intraday tables. |
| user_ltv.currency | STRING | The Lifetime Value (currency) of the user. This field is not populated in intraday tables. | 

### device

The device RECORD contains information about the device from which the event originated.

| Field name | Data type | Description |
|---|---|---|
| device.category | STRING | The device category (mobile, tablet, desktop). |
| device.mobile_brand_name | STRING | The device brand name. |
| device.mobile_model_name | STRING | The device model name. |
| device.mobile_marketing_name | STRING | The device marketing name. |
| device.mobile_os_hardware_model | STRING | The device model information retrieved directly from the operating system. |
| device.operating_system | STRING | The operating system of the device. |
| device.operating_system_version | STRING | The OS version. |
| device.vendor_id | STRING | IDFV (present only if IDFA is not collected). |
| device.advertising_id | STRING | Advertising ID/IDFA. |
| device.language | STRING | The OS language. |
| device.time_zone_offset_seconds | INTEGER | The offset from GMT in seconds. |
| device.is_limited_ad_tracking | BOOLEAN | The device's Limit Ad Tracking setting. On iOS14+, returns false if the IDFA is non-zero. |
| device.web_info.browser | STRING | The browser in which the user viewed content. |
| device.web_info.browser_version | STRING | The version of the browser in which the user viewed content. |
| device.web_info.hostname | STRING | The hostname associated with the logged event. | 

### geo

The geo RECORD contains information about the geographic location where the event was initiated.

| Field name | Data type | Description |
|---|---|---|
| geo.continent | STRING | The continent from which events were reported, based on IP address. |
| geo.sub_continent | STRING | The subcontinent from which events were reported, based on IP address. |
| geo.country | STRING | The country from which events were reported, based on IP address. |
| geo.region | STRING | The region from which events were reported, based on IP address. |
| geo.metro | STRING | The metro from which events were reported, based on IP address. |
| geo.city | STRING | The city from which events were reported, based on IP address. | 

### app_info

The app_info RECORD contains information about the app in which the event was initiated. | Field name | Data type | Description |
|---|---|---|
| app_info.id | STRING | The package name or bundle ID of the app. |
| app_info.firebase_app_id | STRING | The Firebase App ID associated with the app |
| app_info.install_source | STRING | The store that installed the app. |
| app_info.version | STRING | The app's versionName (Android) or short bundle version. | 

### collected_traffic_source

The collected_traffic_source RECORD contains the traffic source data that was collected with the event.

| Field name | Data type | Description |
|---|---|---|
| manual_campaign_id | STRING | The manual campaign id (utm_id) that was collected with the event. |
| manual_campaign_name | STRING | The manual campaign name (utm_campaign) that was collected with the event. |
| manual_source | STRING | The manual campaign source (utm_source) that was collected with the event. Also includes parsed parameters from referral params, not just UTM values. |
| manual_medium | STRING | The manual campaign medium (utm_medium) that was collected with the event. Also includes parsed parameters from referral params, not just UTM values. |
| manual_term | STRING | The manual campaign keyword/term (utm_term) that was collected with the event. |
| manual_content | STRING | The additional manual campaign metadata (utm_content) that was collected with the event. |
| manual_creative_format | STRING | The manual campaign creative format (utm_creative_format) that was collected with the event. |
| manual_marketing_tactic | STRING | The manual campaign marketing tactic (utm_marketing_tactic) that was collected with the event. |
| manual_source_platform | STRING | The manual campaign source platform (utm_source_platform) that was collected with the event. |
| gclid | STRING | The Google click identifier that was collected with the event. |
| dclid | STRING | The DoubleClick Click Identifier for Display and Video 360 and Campaign Manager 360 that was collected with the event. |
| srsltid | STRING | The Google Merchant Center identifier that was collected with the event. | 

### session_traffic_source_last_click

The session_traffic_source_last_click RECORD contains the last-click attributed session traffic source data across Google ads and manual contexts, where available.

| Field Name | Data Type | Description |
|---|---|---|
| session_traffic_source_last_click. manual_campaign.campaign_id | STRING | The ID of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.campaign_name | STRING | The name of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.medium | STRING | The medium of the last clicked manual campaign (e.g., paid search, organic search, email) |
| session_traffic_source_last_click. manual_campaign.term | STRING | The keyword/search term of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.content | STRING | Additional metadata of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.source_platform | STRING | The platform of the last clicked manual campaign (e.g., search engine, social media) |
| session_traffic_source_last_click. manual_campaign.source | STRING | The specific source within the platform of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.creative_format | STRING | The format of the creative of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.marketing_tactic | STRING | The marketing tactic of the last clicked manual campaign |
| session_traffic_source_last_click. google_ads_campaign.customer_id | STRING | The customer ID associated with the Google Ads account |
| session_traffic_source_last_click. google_ads_campaign.account_name | STRING | The name of the Google Ads account |
| session_traffic_source_last_click. google_ads_campaign.campaign_id | STRING | The ID of the Google Ads campaign |
| session_traffic_source_last_click. google_ads_campaign.campaign_name | STRING | The name of the Google Ads campaign |
| session_traffic_source_last_click. google_ads_campaign.ad_group_id | STRING | The ID of the ad group within the Google Ads campaign |
| session_traffic_source_last_click. google_ads_campaign.ad_group_name | STRING | The name of the ad group within the Google Ads campaign | 

### traffic_source

The traffic_source RECORD contains information about the traffic source that first acquired the user. This record is not populated in intraday tables. Note: The traffic_source values do not change if the user interacts with subsequent campaigns after installation.

| Field name | Data type | Description |
|---|---|---|
| traffic_source.name | STRING | Name of the marketing campaign that first acquired the user. This field is not populated in intraday tables. |
| traffic_source.medium | STRING | Name of the medium (paid search, organic search, email, etc.) that first acquired the user. This field is not populated in intraday tables. |
| traffic_source.source | STRING | Name of the network that first acquired the user. This field is not populated in intraday tables. | 

### stream and platform

The stream and platform fields contain information about the stream and the app platform.

| Field name | Data type | Description |
|---|---|---|
| stream_id | STRING | The numeric ID of the data stream from which the event originated. |
| platform | STRING | The data stream platform (Web, IOS or Android) from which the event originated. | 

### ecommerce

This ecommerce RECORD contains information about any ecommerce events that have been setup on a website or app.

| Field name | Data type | Description |
|---|---|---|
| ecommerce.total_item_quantity | INTEGER | Total number of items in this event, which is the sum of items.quantity. |
| ecommerce.purchase_revenue_in_usd | FLOAT | Purchase revenue of this event, represented in USD with standard unit. Populated for purchase event only. |
| ecommerce.purchase_revenue | FLOAT | Purchase revenue of this event, represented in local currency with standard unit. Populated for purchase event only. |
| ecommerce.refund_value_in_usd | FLOAT | The amount of refund in this event, represented in USD with standard unit. Populated for refund event only. |
| ecommerce.refund_value | FLOAT | The amount of refund in this event, represented in local currency with standard unit. Populated for refund event only. |
| ecommerce.shipping_value_in_usd | FLOAT | The shipping cost in this event, represented in USD with standard unit. |
| ecommerce.shipping_value | FLOAT | The shipping cost in this event, represented in local currency. |
| ecommerce.tax_value_in_usd | FLOAT | The tax value in this event, represented in USD with standard unit. |
| ecommerce.tax_value | FLOAT | The tax value in this event, represented in local currency with standard unit. |
| ecommerce.transaction_id | STRING | The transaction ID of the ecommerce transaction. |
| ecommerce.unique_items | INTEGER | The number of unique items in this event, based on item_id, item_name, and item_brand. | 

### items

The items RECORD contains information about items included in an event. It is repeated for each item.

| Field name | Data type | Description |
|---|---|---|
| items.item_id | STRING | The ID of the item. |
| items.item_name | STRING | The name of the item. |
| items.item_brand | STRING | The brand of the item. |
| items.item_variant | STRING | The variant of the item. |
| items.item_category | STRING | The category of the item. |
| items.item_category2 | STRING | The sub category of the item. |
| items.item_category3 | STRING | The sub category of the item. |
| items.item_category4 | STRING | The sub category of the item. |
| items.item_category5 | STRING | The sub category of the item. |
| items.price_in_usd | FLOAT | The price of the item, in USD with standard unit. |
| items.price | FLOAT | The price of the item in local currency. |
| items.quantity | INTEGER | The quantity of the item. Quantity set to 1 if not specified. |
| items.item_revenue_in_usd | FLOAT | The revenue of this item, calculated as price_in_usd * quantity. It is populated for purchase events only, in USD with standard unit. |
| items.item_revenue | FLOAT | The revenue of this item, calculated as price * quantity. It is populated for purchase events only, in local currency with standard unit. |
| items.item_refund_in_usd | FLOAT | The refund value of this item, calculated as price_in_usd * quantity. It is populated for refund events only, in USD with standard unit. |
| items.item_refund | FLOAT | The refund value of this item, calculated as price * quantity. It is populated for refund events only, in local currency with standard unit. |
| items.coupon | STRING | Coupon code applied to this item. |
| items.affiliation | STRING | A product affiliation to designate a supplying company or brick and mortar store location. |
| items.location_id | STRING | The location associated with the item. |
| items.item_list_id | STRING | The ID of the list in which the item was presented to the user. |
| items.item_list_name | STRING | The name of the list in which the item was presented to the user. |
| Items.item_list_index | STRING | The position of the item in a list. |
| items.promotion_id | STRING | The ID of a product promotion. |
| items.promotion_name | STRING | The name of a product promotion. |
| items.creative_name | STRING | The name of a creative used in a promotional spot. |
| items.creative_slot | STRING | The name of a creative slot. |

#### item_params RECORD

The item_params RECORD stores the custom item parameters that you defined. Note that predefined item parameters like item_id, item_name etc, are not included here, instead they are exported as explicit fields. The set of parameters stored in the item_params RECORD is unique to each implementation. To learn more about ecommerce implementations and the Google Analytics 4 items array, see Measure ecommerce .

| Field name | Data type | Description |
|---|---|---|
| items.item_params.key | STRING | The name of the item parameter. |
| items.item_params.value | RECORD | A record containing the item parameter’s value. |
| items.item_params.value.string_value | STRING | If the item parameter is represented by a string, it is populated in this field. |
| items.item_params.value.int_value | INTEGER | If the item parameter is represented by an integer, it is populated in this field. |
| items.item_params.value.double_value | FLOAT | If the item parameter is represented by a double value, it is populated in this field. |
| items.item_params.value.float_value | FLOAT | If the item parameter is represented by a floating point value, it is populated in this field. | 

## Rows

Data for a single event may be represented in one or multiple rows, depending on whether it contains repeated RECORDS. A `page_view` event with multiple
`[event_params](https://support.google.com/analytics/answer/7029846?hl=en&ref_topic=9359001&sjid=16041154979191290935-EU#event_params)`,
for example, would look similar to the following table. The initial row contains the event name, date, timestamp and other non-repeated data items. The
`[event_params](https://support.google.com/analytics/answer/7029846?hl=en&ref_topic=9359001&sjid=16041154979191290935-EU#event_params)`
RECORD is repeated for each parameter associated with the event. These repeated RECORDS are populated in subsequent rows directly under the initial event row.

| event_date | event_timestamp | event_name | event_params.key | event_params_value.string_value |
|---|---|---|---|---|
| 20220222 | 1643673600483790 | page_view | page_location | https://example.com |
| - | - | - | page_title | Home |
| - | - | - | medium | referral |
| - | - | - | source | google |
| - | - | - | page_referrer | https://www.google.com |
| - | - | - | parameters... | values... |
The table structure information is ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'ga4_obfuscated_sample_ecommerce': ['events_20201101', 'events_20201102', 'events_20201103', 'events_20201104', 'events_20201105', 'events_20201106', 'events_20201107', 'events_20201108', 'events_20201109', 'events_20201110', 'events_20201111', 'events_20201112', 'events_20201113', 'events_20201114', 'events_20201115', 'events_20201116', 'events_20201117', 'events_20201118', 'events_20201119', 'events_20201120', 'events_20201121', 'events_20201122', 'events_20201123', 'events_20201124', 'events_20201125', 'events_20201126', 'events_20201127', 'events_20201128', 'events_20201129', 'events_20201130', 'events_20201201', 'events_20201202', 'events_20201203', 'events_20201204', 'events_20201205', 'events_20201206', 'events_20201207', 'events_20201208', 'events_20201209', 'events_20201210', 'events_20201211', 'events_20201212', 'events_20201213', 'events_20201214', 'events_20201215', 'events_20201216', 'events_20201217', 'events_20201218', 'events_20201219', 'events_20201220', 'events_20201221', 'events_20201222', 'events_20201223', 'events_20201224', 'events_20201225', 'events_20201226', 'events_20201227', 'events_20201228', 'events_20201229', 'events_20201230', 'events_20201231', 'events_20210101', 'events_20210102', 'events_20210103', 'events_20210104', 'events_20210105', 'events_20210106', 'events_20210107', 'events_20210108', 'events_20210109', 'events_20210110', 'events_20210111', 'events_20210112', 'events_20210113', 'events_20210114', 'events_20210115', 'events_20210116', 'events_20210117', 'events_20210118', 'events_20210119', 'events_20210120', 'events_20210121', 'events_20210122', 'events_20210123', 'events_20210124', 'events_20210125', 'events_20210126', 'events_20210127', 'events_20210128', 'events_20210129', 'events_20210130', 'events_20210131']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Tables:**
  - We will use the `events_YYYYMMDD` tables in the `bigquery-public-data.ga4_obfuscated_sample_ecommerce` dataset. These tables contain event data for each day.
  
- **Columns:**

  - `user_pseudo_id`: **Potential usage** - To uniquely identify pseudo users.
  - `event_date`: **Potential usage** - To filter events within specific date ranges.

**Conditions to be Used:**

- **Last 7 days activity (as of January 7, 2021):**
  - `event_date` between `'20201231'` and `'20210105'` (December 31, 2020, to January 5, 2021).
  
- **Last 2 days inactivity (as of January 7, 2021):**
  - `event_date` in `'20210106'` and `'20210107'` (January 6 and 7, 2021).

---

**BigQuery SQL Queries:**

1. **Select distinct `user_pseudo_id` and `event_date` from events on January 6, 2021:**

   ```sql
   SELECT DISTINCT user_pseudo_id, event_date
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210106`
   LIMIT 100;
   ```

2. **Select distinct `user_pseudo_id` and `event_date` from events on January 7, 2021:**

   ```sql
   SELECT DISTINCT user_pseudo_id, event_date
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210107`
   LIMIT 100;
   ```

3. **Select distinct `user_pseudo_id` and `event_date` from the last 7 days (December 31, 2020, to January 5, 2021):**

   ```sql
   SELECT DISTINCT user_pseudo_id, event_date
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
   LIMIT 100;
   ```

4. **Count the number of unique users active in the last 7 days:**

   ```sql
   SELECT COUNT(DISTINCT user_pseudo_id) AS num_users
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105';
   ```

5. **List `user_pseudo_id` values active in the last 7 days:**

   ```sql
   SELECT DISTINCT user_pseudo_id
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
   LIMIT 100;
   ```

6. **List `user_pseudo_id` values active in the last 2 days (January 6 and 7, 2021):**

   ```sql
   SELECT DISTINCT user_pseudo_id
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX IN ('20210106', '20210107')
   LIMIT 100;
   ```

7. **Find users active in the last 7 days but not in the last 2 days:**

   ```sql
   SELECT DISTINCT user_pseudo_id
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
     AND user_pseudo_id NOT IN (
       SELECT DISTINCT user_pseudo_id
       FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
       WHERE _TABLE_SUFFIX IN ('20210106', '20210107')
     )
   LIMIT 100;
   ```

8. **Count the number of users active in the last 7 days but inactive in the last 2 days:**

   ```sql
   SELECT COUNT(DISTINCT user_pseudo_id) AS num_inactive_last_2_days
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
     AND user_pseudo_id NOT IN (
       SELECT DISTINCT user_pseudo_id
       FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
       WHERE _TABLE_SUFFIX IN ('20210106', '20210107')
     );
   ```

9. **List `user_pseudo_id` along with their last active date:**

   ```sql
   SELECT user_pseudo_id, MAX(event_date) AS last_active_date
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   GROUP BY user_pseudo_id
   ORDER BY last_active_date DESC
   LIMIT 100;
   ```

10. **Find users active in the last 7 days and count their total events:**

    ```sql
    SELECT user_pseudo_id, COUNT(*) AS total_events
    FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
    WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
    GROUP BY user_pseudo_id
    ORDER BY total_events DESC
    LIMIT 100;
    ```

11. **Count the number of days each user was active in the last 7 days:**

    ```sql
    SELECT user_pseudo_id, COUNT(DISTINCT event_date) AS active_days
    FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
    WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
    GROUP BY user_pseudo_id
    ORDER BY active_days DESC
    LIMIT 100;
    ```

12. **List events performed by users active in the last 7 days but not in the last 2 days:**

    ```sql
    SELECT event_name, COUNT(*) AS event_count
    FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
    WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
      AND user_pseudo_id NOT IN (
        SELECT DISTINCT user_pseudo_id
        FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
        WHERE _TABLE_SUFFIX IN ('20210106', '20210107')
      )
    GROUP BY event_name
    ORDER BY event_count DESC
    LIMIT 100;
    ```

13. **Identify users who were active exactly 7 days ago (on December 31, 2020):**

    ```sql
    SELECT DISTINCT user_pseudo_id
    FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20201231`
    LIMIT 100;
    ```

14. **Get the distribution of event counts per user in the last 7 days:**

    ```sql
    SELECT event_count, COUNT(*) AS num_users
    FROM (
      SELECT user_pseudo_id, COUNT(*) AS event_count
      FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
      WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
      GROUP BY user_pseudo_id
    )
    GROUP BY event_count
    ORDER BY event_count ASC
    LIMIT 100;
    ```

15. **Find users who became inactive in the last 2 days:**

    ```sql
    SELECT DISTINCT user_pseudo_id
    FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
    WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
      AND user_pseudo_id NOT IN (
        SELECT DISTINCT user_pseudo_id
        FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
        WHERE _TABLE_SUFFIX > '20210105' AND _TABLE_SUFFIX <= '20210107'
      )
    LIMIT 100;
    ```
    
These queries explore the relevant data and columns to understand user activity patterns, which will help in determining the number of pseudo users who were active in the last 7 days but inactive in the last 2 days as of January 7, 2021.Query:
SELECT DISTINCT user_pseudo_id, event_date
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210106`
   LIMIT 100;
Answer:
user_pseudo_id,event_date
1001303.4827739208,20210106
1014060.1100191558,20210106
1015239.8458513676,20210106
1023213.5350684501,20210106
1025773.0920505617,20210106
1033020.5841925327,20210106
1042140.6802444773,20210106
1045720.9269650087,20210106
1049106.9990499157,20210106
1049739.7909391395,20210106
1060274.1098179258,20210106
1065322.6541302193,20210106
1069165.2811408476,20210106
1069494.0113686800,20210106
1072513.2161702512,20210106
1075240.7394043586,20210106
1075333.9269112947,20210106
1078788.8328338285,20210106
1081165.5314971225,20210106
1083792.6034832516,20210106
1084471.2677471598,20210106
1086668.0925005810,20210106
1086843.9052907013,20210106
1087271.0550084610,20210106
1087808.3711873816,20210106
1095740.4839642689,20210106
1111626.7442894456,20210106
1114964.3576383224,20210106
1115377.5526866793,20210106
1118833.2974558782,20210106
1126378.6956818362,20210106
1128261.6033595713,20210106
1128289.3662024583,20210106
1130911.8567954377,20210106
1133313.1103337373,20210106
1133962.3740970739,20210106
1135774.0646413552,20210106
1141870.4386338572,20210106
1144150.5821344535,20210106
1144792.8191246270,20210106
1146837.4730107711,20210106
1148615.3691736909,20210106
1151687.1996189042,20210106
1153093.0119048067,20210106
1160488.2375923167,20210106
1163998.9977514528,20210106
1169456.0744217795,20210106
1170673.0496256889,20210106
1173439.7311015929,20210106
1175417.7164964556,20210106
1177018.6074439798,20210106
1180762.6954492448,20210106
1185502.9456478888,20210106
1185607.4529846208,20210106
1211099.8247563235,20210106
1213730.2023854144,20210106
1214408.9886831537,20210106
1214882.5762650867,20210106
1216128.7020381390,20210106
1218031.2772164166,20210106
1221611.6181416961,20210106
1223402.7111643409,20210106
1224512.5360000287,20210106
1230929.5891057900,20210106
1243180.2889994882,20210106
1245742.1517954276,20210106
1250075.3055872841,20210106
1251677.0033366371,20210106
1252675.9812778248,20210106
1253621.4143036992,20210106
1255130.2864074728,20210106
1256871.5825332697,20210106
1257670.9852008771,20210106
1259037.7018534149,20210106
1264306.5410019941,20210106
1270650.6052564575,20210106
Query:
SELECT DISTINCT user_pseudo_id, event_date
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210107`
   LIMIT 100;
Answer:
user_pseudo_id,event_date
1000557.2911835023,20210107
1002616.3660015684,20210107
1008726.7423030385,20210107
1009541.6887464068,20210107
1009676.4905193951,20210107
1016428.1065641732,20210107
1019574.8776308935,20210107
1020795.7432964012,20210107
1028144.2081628525,20210107
1030326.1353640844,20210107
1036021.1054561259,20210107
1043511.9901401232,20210107
1046404.1129546883,20210107
1056020.6709260931,20210107
1063386.3828577009,20210107
1066407.3757892113,20210107
1072012.7284818935,20210107
1073430.9059120582,20210107
1087808.3711873816,20210107
1091162.1989694199,20210107
1098584.0776604006,20210107
1099671.3398238118,20210107
1100949.9283905733,20210107
1104189.1961360907,20210107
1107549.5710254296,20210107
1109808.6106046131,20210107
1114216.0904812151,20210107
1116865.4647068394,20210107
1122146.8997157148,20210107
1124540.2333393152,20210107
1132479.2425986879,20210107
1132946.8730897471,20210107
1138520.5891734753,20210107
1144754.6830399719,20210107
1149393.9441120966,20210107
1150257.3416332583,20210107
1150418.5729329589,20210107
1151529.7874029554,20210107
1151687.1996189042,20210107
1163998.9977514528,20210107
1166484.2621554560,20210107
1168153.2069804316,20210107
1169660.2704170325,20210107
1172211.4577928962,20210107
1174920.8866835138,20210107
1177876.9777589683,20210107
1181141.8389731329,20210107
1182923.0909175622,20210107
1186421.2997808469,20210107
1194177.8166317724,20210107
1195966.3969559148,20210107
1196040.9501767394,20210107
1209023.5496836341,20210107
1224731.3666771048,20210107
1227321.4549113942,20210107
1231601.8963574336,20210107
1237924.3309856915,20210107
1242735.7779476738,20210107
1246241.1259892311,20210107
1247293.4194247843,20210107
1256871.5825332697,20210107
1263510.2346903431,20210107
1266942.9616912837,20210107
1272559.2391561764,20210107
1275281.1401174806,20210107
1276927.7607362138,20210107
1280885.4587684428,20210107
1283562.7271739130,20210107
1287483.1535140122,20210107
1289021.8467378906,20210107
1291324.6496937233,20210107
1295828.0586489111,20210107
1296777.6630043403,20210107
1299775.3014967415,20210107
1304171.0604038711,20210107
1309980.6522015685,20210107
Query:
SELECT DISTINCT user_pseudo_id, event_date
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
   LIMIT 100;
Answer:
user_pseudo_id,event_date
1005484.1092567297,20210102
1019468.5334749980,20210102
1020695.6921096883,20210102
1034552.3956022963,20210102
1035433.9962487028,20210102
1054184.5156674867,20210102
1055969.5872512303,20210102
1104189.1961360907,20210102
1127197.7845904071,20210102
1134613.7634894426,20210102
1137060.9310088729,20210102
1140798.4477437179,20210102
1160488.2375923167,20210102
1161350.5694934880,20210102
1164110.7921696016,20210102
1219168.5485233162,20210102
1239682.4582755521,20210102
1246097.1442578537,20210102
1250553.7197007147,20210102
1253534.6863073074,20210102
1254621.7726451069,20210102
1272248.3527408128,20210102
1273851.7434031787,20210102
1274599.3928448053,20210102
1278408.9014565519,20210102
1279602.6727600031,20210102
1293446.1816560362,20210102
1296701.2382814729,20210102
1299487.6744511638,20210102
1314847.4544971351,20210102
1315049.1291069189,20210102
1325116.8912286004,20210102
1334700.6047036975,20210102
1359861.1338029424,20210102
1364085.2107948688,20210102
1370461.9318815596,20210102
1380837.6952136083,20210102
1381565.5047705405,20210102
1382535.7283137323,20210102
1390300.4796021112,20210102
1392466.8272664309,20210102
1402138.5184246691,20210102
1405619.5662753913,20210102
1413270.7201714861,20210102
1440319.2684459003,20210102
1441065.6470414018,20210102
1442997.6750483462,20210102
1470601.3891204117,20210102
1482331.8123183039,20210102
1505379.6854768255,20210102
1507645.2354095566,20210102
1508520.3631208357,20210102
1524258.4980135729,20210102
1537916.6494875994,20210102
1550647.9864364390,20210102
1587120.7886409442,20210102
1587333.3490610470,20210102
1595062.2978681339,20210102
1619900.3195973863,20210102
1621047.1809785712,20210102
1650186.4171427739,20210102
1652787.4806754655,20210102
1653230.5444867771,20210102
1661549.9249699570,20210102
1664037.8368386837,20210102
1664926.0864851694,20210102
1679710.5467997846,20210102
1684439.4801767659,20210102
1688021.5951717579,20210102
1689822.6628262328,20210102
1695729.1971283274,20210102
1698322.2974178584,20210102
1699537.8074625037,20210102
1704767.6168359047,20210102
1708071.1093492535,20210102
1720808.5659233423,20210102
Query:
SELECT COUNT(DISTINCT user_pseudo_id) AS num_users
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105';
Answer:
num_users
16204
Query:
SELECT DISTINCT user_pseudo_id
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
   LIMIT 100;
Answer:
user_pseudo_id
1005484.1092567297
1019468.5334749980
1020695.6921096883
1034552.3956022963
1035433.9962487028
1054184.5156674867
1055969.5872512303
1104189.1961360907
1127197.7845904071
1134613.7634894426
1137060.9310088729
1140798.4477437179
1160488.2375923167
1161350.5694934880
1164110.7921696016
1219168.5485233162
1239682.4582755521
1246097.1442578537
1250553.7197007147
1253534.6863073074
1254621.7726451069
1272248.3527408128
1273851.7434031787
1274599.3928448053
1278408.9014565519
1279602.6727600031
1293446.1816560362
1296701.2382814729
1299487.6744511638
1314847.4544971351
1315049.1291069189
1325116.8912286004
1334700.6047036975
1359861.1338029424
1364085.2107948688
1370461.9318815596
1380837.6952136083
1381565.5047705405
1382535.7283137323
1390300.4796021112
1392466.8272664309
1402138.5184246691
1405619.5662753913
1413270.7201714861
1440319.2684459003
1441065.6470414018
1442997.6750483462
1470601.3891204117
1482331.8123183039
1505379.6854768255
1507645.2354095566
1508520.3631208357
1524258.4980135729
1537916.6494875994
1550647.9864364390
1587120.7886409442
1587333.3490610470
1595062.2978681339
1619900.3195973863
1621047.1809785712
1650186.4171427739
1652787.4806754655
1653230.5444867771
1661549.9249699570
1664037.8368386837
1664926.0864851694
1679710.5467997846
1684439.4801767659
1688021.5951717579
1689822.6628262328
1695729.1971283274
1698322.2974178584
1699537.8074625037
1704767.6168359047
1708071.1093492535
1720808.5659233423
1721354.6818865235
1722117.4481798918
1746667.8607565392
1778028.3352091849
1788337.3157672800
1793640.9588973139
1804084.9503910975
1810164.8096235223
1821461.3337986263
1824121.5656787337
1846974.0316175078
1849787.1417367270
1862279.2644343817
1873058.4156402266
1928081.8451007978
1929880.8943789391
1941137.5727282147
1946378.2604112351
1946567.8498627659
1966814.1086113170
1977599.8253595252
1988973.6797776774
1989653.0310679976
1990491.3893000361
Query:
SELECT DISTINCT user_pseudo_id
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX IN ('20210106', '20210107')
   LIMIT 100;
Answer:
user_pseudo_id
1000557.2911835023
1002616.3660015684
1008726.7423030385
1009541.6887464068
1009676.4905193951
1016428.1065641732
1019574.8776308935
1020795.7432964012
1028144.2081628525
1030326.1353640844
1036021.1054561259
1043511.9901401232
1046404.1129546883
1056020.6709260931
1063386.3828577009
1066407.3757892113
1072012.7284818935
1073430.9059120582
1087808.3711873816
1091162.1989694199
1098584.0776604006
1099671.3398238118
1100949.9283905733
1104189.1961360907
1107549.5710254296
1109808.6106046131
1114216.0904812151
1116865.4647068394
1122146.8997157148
1124540.2333393152
1132479.2425986879
1132946.8730897471
1138520.5891734753
1144754.6830399719
1149393.9441120966
1150257.3416332583
1150418.5729329589
1151529.7874029554
1151687.1996189042
1163998.9977514528
1166484.2621554560
1168153.2069804316
1169660.2704170325
1172211.4577928962
1174920.8866835138
1177876.9777589683
1181141.8389731329
1182923.0909175622
1186421.2997808469
1194177.8166317724
1195966.3969559148
1196040.9501767394
1209023.5496836341
1224731.3666771048
1227321.4549113942
1231601.8963574336
1237924.3309856915
1242735.7779476738
1246241.1259892311
1247293.4194247843
1256871.5825332697
1263510.2346903431
1266942.9616912837
1272559.2391561764
1275281.1401174806
1276927.7607362138
1280885.4587684428
1283562.7271739130
1287483.1535140122
1289021.8467378906
1291324.6496937233
1295828.0586489111
1296777.6630043403
1299775.3014967415
1304171.0604038711
1309980.6522015685
1317681.8410322222
1320383.7530644264
1329436.8221805419
1332979.8914503740
1333728.0047687977
1342173.6511298548
1342397.5707081379
1357251.3765617872
1359026.8307338454
1362228.4966015575
1364505.7481550412
1366103.4269040146
1366281.7261580221
1366363.8080922440
1369023.5738995470
1374932.4478575733
1378696.4627477130
1385336.9757682390
1390701.8959589858
1403236.7518250436
1404246.6716592021
1404269.7082895339
1406007.4609789626
1406098.2272398299
Query:
SELECT DISTINCT user_pseudo_id
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
     AND user_pseudo_id NOT IN (
       SELECT DISTINCT user_pseudo_id
       FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
       WHERE _TABLE_SUFFIX IN ('20210106', '20210107')
     )
   LIMIT 100;
Answer:
user_pseudo_id
1008499.5928445086
1013760.9231029745
1014209.5295344253
1026137.2290719007
1028167.1226079449
1032092.5249707229
1053193.3273260382
1057066.6724870774
1057265.5844727802
1065673.0722289663
1067841.4647153954
1075223.2681702246
1082690.0377265261
1103286.8251708796
1109836.9501901728
1113469.1950253831
1114181.7368629788
1121518.2859510925
1130810.6137694456
1134613.7634894426
1158637.0383647084
1164741.6860607634
1181674.5265741661
1185078.3105419781
1194575.2891034137
1214573.9183644653
1215389.2295507570
1222867.5284822262
1227012.8467411408
1238230.5582832258
1243221.1777211525
1252690.3944441209
1284535.4676055384
1288248.9113459714
1289319.0865612371
1297488.8153560940
1299487.6744511638
1307038.3688504236
1309149.1848587742
1313329.6311058857
1314747.6066644573
1320284.3859724504
1325688.1519909745
1334969.6157017719
1339205.5397897099
1373324.8357357420
1385090.1246142947
1385662.1127085473
1401785.6584445113
1402228.3482241994
1403129.5580554677
1445737.4102905419
1450787.9898569840
1458803.4123039458
1466910.4554610435
1470241.3611852177
1471187.8226858001
1488009.3142808321
1493030.0825468207
1497130.5055593166
1500615.9964438412
1504953.0746977838
1509456.3177418451
1519189.6398973848
1522857.5896662267
1536105.5891820566
1544748.2905250855
1556885.1837167077
1560589.3791460585
1578948.0834575091
1586022.1800460720
1588332.2823326217
1588666.3949365829
1590715.7165540392
1607100.0381093527
1622235.9923526878
1624884.8451928269
1629639.2044968342
1632927.1894987991
1634789.3752037441
1639296.9002795622
1648032.7331818100
1656975.3346712388
1659842.4321850950
1665661.9122532614
1668023.4150976276
1668416.2014466630
1672632.0859250572
1690623.2302780540
1702019.9842929153
1702845.7520261284
1703253.2388947937
1707319.9934501562
1711048.6268268364
1711971.4968010332
1726993.2463217900
1730497.6226428479
1732811.6786855240
1745835.9106014489
1751599.1685077136
Query:
SELECT COUNT(DISTINCT user_pseudo_id) AS num_inactive_last_2_days
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
     AND user_pseudo_id NOT IN (
       SELECT DISTINCT user_pseudo_id
       FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
       WHERE _TABLE_SUFFIX IN ('20210106', '20210107')
     );
Answer:
num_inactive_last_2_days
15717
Query:
SELECT user_pseudo_id, MAX(event_date) AS last_active_date
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   GROUP BY user_pseudo_id
   ORDER BY last_active_date DESC
   LIMIT 100;
Answer:
user_pseudo_id,last_active_date
5384477.9498815631,20210131
54181384.6639346152,20210131
2306891.5881158976,20210131
3970566.6686455359,20210131
6188924.0795024082,20210131
6837066.8369852470,20210131
7053762.4921201809,20210131
5707727.8343681091,20210131
2232307.9659041751,20210131
1452608.3167122597,20210131
2731138.9741032000,20210131
4204202.0575386809,20210131
4395997.6326699835,20210131
6098555.6597219815,20210131
6037143.3698637442,20210131
6381734.4884917250,20210131
6447209.1288995618,20210131
6887977.7283471204,20210131
2550351.4004742366,20210131
7295539.7639750860,20210131
7355211.5896529973,20210131
36219200.2450144482,20210131
62372594.2230785944,20210131
80472823.8221568698,20210131
1414481.4058323058,20210131
89646304.1267047297,20210131
1542823.5350910604,20210131
3949118.2086925672,20210131
2504135.3103808694,20210131
3377476.0397619798,20210131
3654210.8993375670,20210131
4360208.7303031029,20210131
4261558.6534177854,20210131
4524491.1203839244,20210131
4572500.9649745259,20210131
6581752.7028135402,20210131
5423500.0718346384,20210131
6085099.3469751032,20210131
1701304.3521647771,20210131
6580553.2974136047,20210131
6294121.4760347945,20210131
6550128.6556885931,20210131
6509428.5351700845,20210131
7607516.8270926536,20210131
6746274.5485589022,20210131
6863554.1519524743,20210131
6852600.3732416116,20210131
7594533.9551776618,20210131
7278331.4509008097,20210131
7437038.9583984363,20210131
7366860.4627232501,20210131
25804281.1662573356,20210131
52437634.0997373243,20210131
46687121.4792925719,20210131
7219615.9655825331,20210131
61900815.4495081739,20210131
5706715.6852183826,20210131
1908420.3631481360,20210131
5613969.9742050087,20210131
1114805.9678711833,20210131
3124160.8176335256,20210131
1770895.0629130836,20210131
1513929.8132540010,20210131
1660287.8904776521,20210131
1565274.6149340210,20210131
5096303.3218407804,20210131
2177092.9819667753,20210131
2567984.2109902410,20210131
2540425.9025017966,20210131
3929705.5453066142,20210131
Query:
SELECT user_pseudo_id, COUNT(*) AS total_events
    FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
    WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
    GROUP BY user_pseudo_id
    ORDER BY total_events DESC
    LIMIT 100;
Answer:
user_pseudo_id,total_events
72522849.6381089738,1011
1160488.2375923167,486
8826950.4971866604,453
91675873.1352298917,388
8962597.7306180902,375
77052125.0799530822,367
75073588.1859607099,346
5995428.1774914766,324
2783014.3813479767,318
2885429.0157235569,308
61443972.0251565668,285
10273164.5274553015,277
5237743.2231683146,274
28134106.1591086954,274
73370809.3757379160,258
1181671929.7227404022,255
5528825.5598647448,254
7509303346.8821447922,246
3481692.1528741899,241
59533896.5320638489,238
75571709.1157982540,236
18637647.0398129287,236
6283343.2195449706,234
25712283.2548580985,233
77137495.6810904691,224
2962062.5636750914,224
30168787.8236845550,220
68044587.8089465417,219
6580445.4141083514,215
4379421.9669036501,214
5563930.3593101391,207
7329327.2927230381,201
3593045.4474754034,198
8447373.0647826021,196
65723051.6260769230,196
84647660.6681637188,193
4361543.5487737593,193
6457394.0467289981,192
53550354.6354713181,191
7801689.0887224805,190
1831988.5850596638,189
32721322.9309758062,189
77327261.9614153178,185
38593238.7395910294,184
87047667.1042912591,181
76004533.4024306206,181
26275601.6544751761,180
8316881.1639820242,178
7658396.5746251975,177
8186100.1619066340,175
56934240.7101927692,171
5476414.5180022673,171
5712577.1182625340,167
80435974.9462183494,165
68546038.8820428933,163
59487571.9263599382,161
4256704.8631439486,158
87116489.5307133653,155
12171949.5894096795,152
35618258.9089360337,152
51620649.6628743276,152
46574324.9683380755,151
24207018.3974015161,151
1662132.7705678436,150
87600401.0863764142,150
15046526.4562004600,150
6867779.6634381231,149
3218982.5426906645,149
53104811.8176614311,148
6693629.3972852700,146
3830673.4752434108,145
17007406.8391181695,144
5206026.1238630154,143
9013012176.4270996551,142
7515221.4303230400,141
2838161.4781702653,141
39214432.1935349913,140
7312667.0266395141,139
2689155.5329072803,139
72065348.6852495696,138
4823937.0668099247,138
5765850.5948282569,137
Query:
SELECT user_pseudo_id, COUNT(DISTINCT event_date) AS active_days
    FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
    WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
    GROUP BY user_pseudo_id
    ORDER BY active_days DESC
    LIMIT 100;
Answer:
user_pseudo_id,active_days
35626767.1610925268,4
85143797.2924753997,4
1620024.8966870933,4
87031079.7645841833,4
40706056.2511798572,4
6062554.7906717165,4
1160488.2375923167,4
7708361.6535656281,4
79738620.9762581140,4
1846974.0316175078,4
9197973422.7962893360,4
67866911.1234232513,4
2914301.0348640426,4
17494077.2658372366,3
53550354.6354713181,3
11715287.1856783702,3
87431455.4720611025,3
6867779.6634381231,3
57603603.5966139385,3
6003584.8390086616,3
26521546.0674230641,3
8233454.3379625056,3
4879339583.5496818035,3
7870833.4699729595,3
82341069.9606353557,3
64740644.1898496568,3
76643441.1450027892,3
1272248.3527408128,3
35803369.9832881217,3
58751681.2860417490,3
2415858.4972221670,3
54849802.7178369899,3
30168787.8236845550,3
50578688.8876839400,3
34624309.5002944900,3
28863050.0190727043,3
22359493.8173138206,3
32881481.2798882282,3
75073588.1859607099,3
24270666.3229091625,3
8474319.5976877954,3
11321750.4742481705,3
1296701.2382814729,3
8321773.5852938935,3
74526828.7802183173,3
2116278.5223204033,3
4739295590.7137248905,3
82573497.6736006028,3
6508378.3076839473,3
3218982.5426906645,3
77095533.4633569673,3
2885429.0157235569,3
6512021.3913056139,3
3608752.7415487370,3
70783127.9745040800,3
3807842.5003018860,3
3024189.6101670146,3
4980906.4887239358,3
87047667.1042912591,3
15493794.4663857188,3
8317362.6638454021,3
1134613.7634894426,3
70969614.1264783832,3
92683406.5958530398,3
73401773.9247733438,3
38979725.4080855713,3
628363132.9737513033,3
4613600.3132097866,3
5237743.2231683146,3
29057959.6356005819,3
2364299980.1335009029,3
5533943.3723773395,3
4998829.5943843958,3
5298013.7728745800,3
39580321.2479069337,3
3593045.4474754034,3
15817556.8554808751,3
31997071.8879272719,3
5687566.9810985467,3
478573643.2008174418,3
39400502.5089704609,3
41491167.6079853280,3
28134106.1591086954,3
6340026.2480718860,3
31588757.8825339636,3
43190558.9792678700,3
Query:
SELECT event_name, COUNT(*) AS event_count
    FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
    WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
      AND user_pseudo_id NOT IN (
        SELECT DISTINCT user_pseudo_id
        FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
        WHERE _TABLE_SUFFIX IN ('20210106', '20210107')
      )
    GROUP BY event_name
    ORDER BY event_count DESC
    LIMIT 100;
Answer:
event_name,event_count
page_view,55785
user_engagement,32013
session_start,17350
scroll,15948
first_visit,14326
view_item,9680
view_promotion,6620
add_to_cart,1953
view_search_results,1091
select_item,1084
begin_checkout,1043
select_promotion,382
add_shipping_info,350
add_payment_info,238
purchase,98
click,46
view_item_list,2
Query:
SELECT DISTINCT user_pseudo_id
    FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20201231`
    LIMIT 100;
Answer:
user_pseudo_id
1005538.3649404164
1007822.0143885764
1012230.4994195474
1017550.8288979991
1023023.2921190090
1028911.7693473709
1029606.8656858595
1037158.8475831089
1051653.5256730522
1057601.7061041846
1064366.5469179996
1067524.5286739051
1068031.1881049163
1068648.9747588990
1081526.2412894517
1092386.7291273764
1097358.9593491100
1099576.0088122125
1112823.8475775772
1118372.6021864798
1135884.3844671728
1140362.3036690432
1142186.0437190455
1146958.5854170549
1154103.8686878196
1162882.0752628116
1168346.1523648950
1172807.9635433168
1181405.5477188586
1187761.9507381898
1192426.0949360808
1194648.3751143691
1195792.9356819846
1215072.9069605727
1216338.5369962039
1224050.4895876793
1243710.2264579308
1244346.0466737657
1246635.4183548484
1251850.4420344250
1256938.4560037658
1265302.9612079936
1266626.9045303725
1291623.5148415230
1296701.2382814729
1298008.7517139276
1313851.6501590410
1314671.9936382428
1322502.1007573387
1322713.7189196627
1330572.5811248888
1333375.4691057157
1341286.4997396694
1361848.9776305937
1381989.0678727048
1396394.0876521065
1396456.6482506733
1406426.9025557519
1407963.5410246985
1415261.6242394832
1418897.7549791129
1418940.5985366597
1431095.2661797808
1434548.8581092193
1439772.4403592593
1441360.7472237203
1455644.0190003959
1460777.6123243529
1476543.3841079300
1482350.8184957804
1491881.7963023734
1495750.4504271032
1499937.3663407621
1509573.7234095332
1518064.1016389841
1526283.2496942169
1549949.8165053292
1553572.5420163769
1555813.6193358968
1560771.0603511985
1575426.1027777782
1577045.7886668013
1586485.6838328335
1594068.4547320568
1601055.6961895519
1618110.1083676156
1620024.8966870933
1630738.7454569511
1641229.7584272112
1643795.2271280716
1650911.7579654264
1651839.0439255088
1652779.1906012580
1662132.7705678436
1664798.4020266855
1680111.9495223086
1680557.0646673079
1691420.3038930273
1699660.5250609225
1706250.4002681288
Query:
SELECT event_count, COUNT(*) AS num_users
    FROM (
      SELECT user_pseudo_id, COUNT(*) AS event_count
      FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
      WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
      GROUP BY user_pseudo_id
    )
    GROUP BY event_count
    ORDER BY event_count ASC
    LIMIT 100;
Answer:
event_count,num_users
1,12
2,198
3,816
4,1688
5,4781
6,3038
7,817
8,592
9,598
10,423
11,344
12,298
13,243
14,202
15,182
16,170
17,160
18,119
19,101
20,93
21,82
22,79
23,79
24,61
25,51
26,55
27,38
28,51
29,39
30,34
31,37
32,31
33,30
34,34
35,29
36,16
37,17
38,24
39,19
40,17
41,13
42,14
43,12
44,15
45,14
46,17
47,12
48,7
49,9
50,9
51,11
52,6
53,8
54,7
55,9
56,11
57,11
58,9
59,5
60,1
61,8
62,6
63,6
64,4
65,5
66,3
67,11
68,5
69,7
70,9
71,7
72,3
73,6
74,3
75,4
76,6
77,5
78,1
79,4
80,4
81,2
82,3
83,1
84,5
85,3
86,5
87,1
88,3
89,2
90,3
91,3
92,5
93,3
94,5
95,3
96,2
97,2
98,1
99,6
100,3
Query:
SELECT DISTINCT user_pseudo_id
    FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
    WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
      AND user_pseudo_id NOT IN (
        SELECT DISTINCT user_pseudo_id
        FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
        WHERE _TABLE_SUFFIX > '20210105' AND _TABLE_SUFFIX <= '20210107'
      )
    LIMIT 100;
Answer:
user_pseudo_id
1006764.2593478041
1011730.5937310445
1025554.7155857902
1028337.8871283783
1031058.2518048614
1032606.3576924541
1056329.7612609650
1068701.3018406914
1071257.2904972531
1075223.2681702246
1079374.1910653935
1082920.8892141550
1086535.4875940498
1089575.2761256602
1096553.1505774248
1102947.5096330985
1113194.4596973553
1115003.4680616065
1117874.3324542795
1122855.4085911936
1124854.6111785259
1129742.7402804867
1132555.2301002365
1133964.7947497780
1141770.2200021598
1172217.8534916097
1186112.8377343718
1187482.7824786316
1192643.6460701245
1197568.4892852272
1203853.5073281021
1204844.2691721789
1215841.5184851096
1218242.9191016186
1222409.1951536768
1225314.7220680786
1226878.4100446319
1241220.1441674551
1241629.8724178917
1243376.8542545034
1244606.6899321311
1247686.2070404262
1254011.7545907964
1258911.4567959870
1260992.5282234785
1261100.0843906075
1264993.3645153639
1272248.3527408128
1274495.5184398589
1275384.3626297214
1276342.9126460945
1278427.6141690556
1280266.1333397958
1284133.7579148747
1286945.3645505196
1291228.5655196810
1292185.5593921414
1301862.0758294607
1307038.3688504236
1307807.0071561878
1309149.1848587742
1318068.2020052683
1318879.8038263711
1321029.7577861325
1321742.4551192896
1325482.4574108673
1325688.1519909745
1326179.1742099424
1336694.6432583433
1342157.7728855384
1345509.3936713223
1348068.1593058656
1352587.0117468163
1356010.8691002356
1360671.0435504959
1379775.2562814073
1397822.5235180436
1399527.2790058720
1404886.4182310055
1414193.2963567157
1432451.2006018969
1434548.8581092193
1439687.4557873700
1455644.0190003959
1455809.7208111760
1457888.4327764965
1460768.9286238752
1469643.2045997031
1474066.3112067437
1484308.7242312753
1487082.6524856404
1490370.6853135246
1492265.2880623974
1493519.8322170424
1499710.7075498493
1512868.5635891160
1529263.1215051275
1529884.1932366182
1535511.8717950286
1537312.2917195558
End Exploring Related Columns
Task: How many pseudo users were active in the last 7 days but inactive in the last 2 days as of January 7, 2021?

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
Number_of_pseudo_users
num:int
(Attention: answer in one row)
```

This represents the number of unique pseudo users (`user_pseudo_id`) who were active between December 31, 2020, and January 5, 2021 (the last 7 days as of January 7, 2021), but inactive on January 6 and January 7, 2021 (the last 2 days as of January 7, 2021)..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'ga4_obfuscated_sample_ecommerce': ['events_20201101', 'events_20201102', 'events_20201103', 'events_20201104', 'events_20201105', 'events_20201106', 'events_20201107', 'events_20201108', 'events_20201109', 'events_20201110', 'events_20201111', 'events_20201112', 'events_20201113', 'events_20201114', 'events_20201115', 'events_20201116', 'events_20201117', 'events_20201118', 'events_20201119', 'events_20201120', 'events_20201121', 'events_20201122', 'events_20201123', 'events_20201124', 'events_20201125', 'events_20201126', 'events_20201127', 'events_20201128', 'events_20201129', 'events_20201130', 'events_20201201', 'events_20201202', 'events_20201203', 'events_20201204', 'events_20201205', 'events_20201206', 'events_20201207', 'events_20201208', 'events_20201209', 'events_20201210', 'events_20201211', 'events_20201212', 'events_20201213', 'events_20201214', 'events_20201215', 'events_20201216', 'events_20201217', 'events_20201218', 'events_20201219', 'events_20201220', 'events_20201221', 'events_20201222', 'events_20201223', 'events_20201224', 'events_20201225', 'events_20201226', 'events_20201227', 'events_20201228', 'events_20201229', 'events_20201230', 'events_20201231', 'events_20210101', 'events_20210102', 'events_20210103', 'events_20210104', 'events_20210105', 'events_20210106', 'events_20210107', 'events_20210108', 'events_20210109', 'events_20210110', 'events_20210111', 'events_20210112', 'events_20210113', 'events_20210114', 'events_20210115', 'events_20210116', 'events_20210117', 'events_20210118', 'events_20210119', 'events_20210120', 'events_20210121', 'events_20210122', 'events_20210123', 'events_20210124', 'events_20210125', 'events_20210126', 'events_20210127', 'events_20210128', 'events_20210129', 'events_20210130', 'events_20210131']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-23 22:45:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-23 22:45:09 - root - INFO - ```sql
SELECT COUNT(DISTINCT user_pseudo_id) AS Number_of_pseudo_users
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
  AND user_pseudo_id NOT IN (
    SELECT DISTINCT user_pseudo_id
    FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
    WHERE _TABLE_SUFFIX IN ('20210106', '20210107')
  );
```
2025-01-23 22:45:12 - root - INFO - itercount: 1
2025-01-23 22:45:12 - root - INFO - 0
2025-01-23 22:45:12 - root - INFO - results: 
Number_of_pseudo_users
15717


2025-01-23 22:45:12 - root - INFO - Please check the answer again by reviewing How many pseudo users were active in the last 7 days but inactive in the last 2 days as of January 7, 2021?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Number_of_pseudo_users
num:int
(Attention: answer in one row)
```

This represents the number of unique pseudo users (`user_pseudo_id`) who were active between December 31, 2020, and January 5, 2021 (the last 7 days as of January 7, 2021), but inactive on January 6 and January 7, 2021 (the last 2 days as of January 7, 2021). The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Number_of_pseudo_users
15717
Current sql:
SELECT COUNT(DISTINCT user_pseudo_id) AS Number_of_pseudo_users
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
  AND user_pseudo_id NOT IN (
    SELECT DISTINCT user_pseudo_id
    FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
    WHERE _TABLE_SUFFIX IN ('20210106', '20210107')
  );
2025-01-23 22:45:27 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-23 22:45:27 - root - INFO - ```sql
SELECT COUNT(DISTINCT user_pseudo_id) AS Number_of_pseudo_users
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20201231' AND '20210105'
  AND user_pseudo_id NOT IN (
    SELECT DISTINCT user_pseudo_id
    FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
    WHERE _TABLE_SUFFIX IN ('20210106', '20210107')
  );
```
2025-01-23 22:45:29 - root - INFO - itercount: 2
2025-01-23 22:45:29 - root - INFO - 0
2025-01-23 22:45:29 - root - INFO - Total iteration counts: 2
