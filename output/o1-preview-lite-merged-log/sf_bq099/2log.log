2025-01-20 21:54:24 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 21:54:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:54:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:54:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:54:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 21:54:25 - snowflake.connector.connection - INFO - closed
2025-01-20 21:54:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:54:26 - root - INFO - SQL:
SELECT t."cpc"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    LIMIT 100;
Results:
Too long, hard cut:
cpc
[]
[]
[]
"[
  {
    ""code"": ""H02M5/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""A01N47/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D521/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""Y02A40/81"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""Y02E30/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""Y10T83/465"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""B26F1/42"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""B22D11/086"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""C07D471/16"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D471/22"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""G01N33/48728"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""C11B5/0064"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/35"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C11B5/0035"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M135/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C09K15/30"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D263/56"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/44"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D235/12"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/3447"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/48"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/46"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D277/64"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/47"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/224"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/102"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/106"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/104"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/10"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/221"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/226"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/225"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/22"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10L1/14"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""E02D5/808"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/385"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/26"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/28"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/54"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
[]
[]
"[
  {
    ""code"": ""C07D213/32"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/51"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/51"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/22"",
    ""first"": true,
    ""inventive"": true,
    ""t

2025-01-20 21:54:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:54:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:54:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:54:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 21:54:27 - snowflake.connector.connection - INFO - closed
2025-01-20 21:54:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:54:28 - root - INFO - SQL:
SELECT c.value AS "cpc_entry"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") c
    LIMIT 100;
Results:
Too long, hard cut:
cpc_entry
"{
  ""code"": ""C23F1/26"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L21/3212"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C23F3/06"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L21/32134"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C23F3/06"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C09G1/02"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L21/32115"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C23F3/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C23F1/18"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C09G1/02"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C23F3/06"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L21/32115"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L21/3212"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C23F1/18"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C23F3/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L21/32134"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""A61N1/05"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""A61N1/05"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""A61N1/056"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""A61N1/056"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""A61B7/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""A61B5/318"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""A61B7/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""A61B5/0816"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""A61B5/0816"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""A61B5/318"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/0421"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/3095"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/3072"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/02476"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/0217"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/18308"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/18375"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/18377"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/04253"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/04252"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/18369"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/18375"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/18369"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/18308"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/0217"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/3072"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/02476"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/18377"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/0421"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/3095"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/04253"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/04252"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/18375"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/3095"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/18377"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/02476"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/0217"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/18369"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code

2025-01-20 21:54:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:54:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:54:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:54:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 21:54:29 - snowflake.connector.connection - INFO - closed
2025-01-20 21:54:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:54:54 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 21:54:54 - root - INFO - ```sql
SELECT t."application_number", a.value:"name"::STRING AS "assignee_name", YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) AS "filing_year", t."country_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."cpc") c,
LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value:"code"::STRING LIKE 'A01B3%'
LIMIT 100;
```
2025-01-20 21:54:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:54:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:54:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:54:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 21:54:55 - snowflake.connector.connection - INFO - closed
2025-01-20 21:54:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:56:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 21:56:22 - root - INFO - SQL:
SELECT t."application_number", a.value:"name"::STRING AS "assignee_name", YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) AS "filing_year", t."country_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."cpc") c,
LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value:"code"::STRING LIKE 'A01B3%'
LIMIT 100;
Results:
application_number,assignee_name,filing_year,country_code
PL-44042622-A,OTULAK PRZEMYSLAW PRO CNC,1970,PL
PL-44042622-A,OTULAK PRZEMYSLAW PRO CNC,1970,PL
PL-44042622-A,OTULAK PRZEMYSLAW PRO CNC,1970,PL
PL-44042622-A,OTULAK PRZEMYSLAW PRO CNC,1970,PL
US-50994255-A,JIM ALEX SMITH,1970,US
US-50994255-A,JIM ALEX SMITH,1970,US
US-52103631-A,GLASIER HAROLD H,1970,US
US-52103631-A,GLASIER HAROLD H,1970,US
US-964648-A,AUGUST SETTERGREN OTTO GORAN,1970,US
US-964648-A,BOTVID SETTERGREN ANDERS GOSTA,1970,US
US-964648-A,AUGUST SETTERGREN OTTO GORAN,1970,US
US-964648-A,BOTVID SETTERGREN ANDERS GOSTA,1970,US
CA-163445-A,GUERBET FRANCOIS,1970,CA
US-41054454-A,TRECKER FRANCIS J,1970,US
US-1209525-A,FISHER VAN E,1970,US
US-1209525-A,FISHER VAN E,1970,US
US-20046750-A,SHEPPARD RICHARD H,1970,US
US-20046750-A,SHEPPARD RICHARD H,1970,US
KR-19960029894-A,KIM BYUNG SUB,1970,KR
KR-19960029894-A,KIM BYUNG SUB,1970,KR
US-1904197554-A,ALLEN SAMUEL L,1970,US
US-6966360-A,RICHARD CO,1970,US
US-6966360-A,RICHARD CO,1970,US
US-202217990129-A,CNH IND AMERICA LLC,1970,US
US-202217990129-A,CNH IND AMERICA LLC,1970,US
US-202217990129-A,CNH IND AMERICA LLC,1970,US
US-5637735-A,CAMPBELL CLARENCE L,1970,US
US-5637735-A,CAMPBELL CLARENCE L,1970,US
AU-7115874-A,NEW ZEALAND INVENTIONS DEV,1970,AU
GB-1095134-A,WILLIAM HENRY HONY FROST,1970,GB
GB-1095134-A,WILLIAM HENRY HONY FROST,1970,GB
GB-585551-A,ARTHUR BROOKS SPURR,1970,GB
IL-26862419-A,AGSOILWORKS TECH COMPANY LLC,1970,IL
IL-26862419-A,AGSOILWORKS TECH COMPANY LLC,1970,IL
KR-20000035371-A,KIM JAE KEUN,1970,KR
US-51933174-A,CARLUCCI JAMES J,1970,US
US-51933174-A,CARLUCCI JAMES J,1970,US
US-51933174-A,CARLUCCI JAMES J,1970,US
US-51933174-A,CARLUCCI JAMES J,1970,US
US-77445391-A,HARRELL DANNY H,1970,US
US-77445391-A,HARRELL DANNY H,1970,US
KR-20120005914-A,BULLS CO LTD,1970,KR
KR-20150076822-A,LIM HEON HO,1970,KR
US-71336434-A,CHOATE STOREY NORMAN,1970,US
US-71336434-A,RUDOLPH HASSON PAUL,1970,US
US-71336434-A,CHOATE STOREY NORMAN,1970,US
US-71336434-A,RUDOLPH HASSON PAUL,1970,US
US-201916456505-A,LG ELECTRONICS INC,1970,US
FR-7531218-A,TEXAS INDUSTRIES INC,1970,FR
FR-7531218-A,TEXAS INDUSTRIES INC,1970,FR
FR-7531218-A,TEXAS INDUSTRIES INC,1970,FR
FR-7531218-A,TEXAS INDUSTRIES INC,1970,FR
FR-7531218-A,TEXAS INDUSTRIES INC,1970,FR
FR-7531218-A,TEXAS INDUSTRIES INC,1970,FR
GB-202013028-A,ARWAC LTD,1970,GB
GB-202013028-A,ARWAC LTD,1970,GB
GB-202013028-A,ARWAC LTD,1970,GB
US-1901066531-A,GEORGE A KELLY PLOW COMPANY,1970,US
KR-20000011273-A,KUBOTA KK,1970,KR
CN-201510892651-A,CHONGQING TIANJI IND CO LTD,1970,CN
CN-201510892651-A,CHONGQING TIANJI IND CO LTD,1970,CN
KR-20010007666-A,KIM JONG JIN,1970,KR
BE-9300543-A,LEIJENAAR SYTZE,1970,BE
BE-9300543-A,LEIJENAAR SYTZE,1970,BE
CN-201580056876-A,AMAZONEN-WERKE H DREYER GMBH & CO KG,1970,CN
CN-201580056876-A,BETEK GMBH & CO KG,1970,CN
CN-201580056876-A,AMAZONEN-WERKE H DREYER GMBH & CO KG,1970,CN
CN-201580056876-A,BETEK GMBH & CO KG,1970,CN
CN-201580056876-A,AMAZONEN-WERKE H DREYER GMBH & CO KG,1970,CN
CN-201580056876-A,BETEK GMBH & CO KG,1970,CN
CN-201710636376-A,UNIV TONGJI,1970,CN
CN-201710636376-A,UNIV TONGJI,1970,CN
CN-201810758930-A,HUBEI SHUANGYU MACHINERY TECH CO LTD,1970,CN
CN-201810758930-A,HUBEI SHUANGYU MACHINERY TECH CO LTD,1970,CN
US-1912673206-A,SOUTHERN PLOW COMPANY,1970,US
GB-616956-A,INT HARVESTER GREAT BRITAIN,1970,GB
CN-202210179147-A,GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1970,CN
CN-202210179147-A,GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1970,CN
CN-202210179147-A,GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1970,CN
US-1913771943-A,SALGE HENRY F,1970,US
KR-20060032729-A,SAMSUNG SDI CO LTD,1970,KR
KR-20060032729-A,SAMSUNG SDI CO LTD,1970,KR
CN-202210625064-A,WANG XUEDONG,1970,CN
CN-202210625064-A,WANG XUEDONG,1970,CN
CN-202111095366-A,ZHANG LIJIN,1970,CN
CN-202111095366-A,ZHANG LIJIN,1970,CN
CN-201811558564-A,DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,1970,CN
CN-201811558564-A,DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,1970,CN
GB-8100746-A,TWOSE OF TIVERTON LTD,1970,GB
GB-8100746-A,TWOSE OF TIVERTON LTD,1970,GB
GB-8100746-A,TWOSE OF TIVERTON LTD,1970,GB
GB-8100746-A,TWOSE OF TIVERTON LTD,1970,GB
ZA-808003-A,MCKAY RALPH LTD,1970,ZA
ZA-808003-A,MCKAY RALPH LTD,1970,ZA
ZA-808003-A,MCKAY RALPH LTD,1970,ZA
ZA-808003-A,MCKAY RALPH LTD,1970,ZA
GB-8136897-A,LELY NV C VAN DER,1970,GB
IT-3003576-A,LELY NV C VAN DER,1970,IT
IT-3003576-A,LELY NV C VAN DER,1970,IT
US-38733520-A,KORSMEYER ERNEST H,1970,US

2025-01-20 21:56:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:56:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:56:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:56:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 21:56:24 - snowflake.connector.connection - INFO - closed
2025-01-20 21:56:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:56:24 - root - INFO - SQL:
SELECT t."application_number", a.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."assignee_harmonized") a
LIMIT 100
Results:
application_number,assignee_name
US-85984810-A,YAMAHA MOTOR CO LTD
US-89124010-A,BIODEL INC
US-89753110-A,PONGPEERAPAT ADCHARA
US-89753110-A,HIBI TORU
US-89759810-A,PAJIC NICK
US-90603310-A,CHESTNUT HILL SOUND INC
US-90739510-A,JI SUNG HOON
US-91151710-A,BOSTON SCIENT SCIMED INC
US-91238010-A,PITTS IAN
US-91435610-A,APERIO TECHNOLOGIES INC
US-92496510-A,QUICK NATHANIEL R
US-92496510-A,KAR ARAVINDA
US-94145110-A,SASA NOBORU
US-95717810-A,GALVIN JEFFREY A
US-95717810-A,LAI ZHENNAN
US-95717810-A,YANG QIANG
US-97637810-A,ZHANG MAOYONG
US-97637810-A,WANG JIANLIANG
US-201113006324-A,KOREA ADVANCED INST SCI & TECH
US-201113012430-A,FUJI KIKO KK
US-201113048581-A,VADERS DENNIS HENRY
US-201113097202-A,Sanovel IIac Sanayi Ve Ticaret Anonim Sirketi
US-200913127336-A,ERICSSON TELEFON AB L M
US-201113186515-A,SHIN DONG-SUK
US-201113186515-A,LEE YONG-JOO
US-201113186515-A,KIM DONG-HYUK
US-201113186515-A,KIM MYUNG-SUN
US-201113186515-A,CHUNG HOI-SUNG
US-201113187366-A,PARK DAE-WOO
US-201113187366-A,HONG YU-MI
US-201113187366-A,SAMSUNG ELECTRONICS CO LTD
US-201113312095-A,MEI RICHARD Y
US-201113312095-A,MACAULEY DANIEL W
US-201113312095-A,GERMAN MICHAEL
US-201013321088-A,HAN JIN KYU
US-201013321088-A,CHO JOON YOUNG
US-201013321088-A,LEE JU HO
US-201013321088-A,SAMSUNG ELECTRONICS CO LTD
US-201013377225-A,GODEL FRANCK
US-201013377225-A,GUEIT NICOLAS MARIE PIERRE
US-201013377225-A,MAILLE JULIEN MARCEL ROGER
US-201013377225-A,SNECMA
US-201313912184-A,MICROSOFT CORP
US-201313928199-A,LANDVOICE DATA LLC
US-201314076307-A,MITSUBISHI ELECTRIC RES LAB
US-201314079549-A,NETAPP INC
US-201314102772-A,ASIA VITAL COMPONENTS CO LTD
US-201314106335-A,VISIER SOLUTIONS INC
US-201414185303-A,HONEYWELL INT INC
US-201414198203-A,TOSHIBA KK
US-201414205742-A,JOHN KEELER & CO INC
US-201414280242-A,UNIV NOTRE DAME DU LAC
US-201414293602-A,SYNERSCOPE B V
US-201414299080-A,EATON CORP
US-201414301643-A,CURRAN SEAMUS
US-201414301643-A,ALLEY NIGEL
US-201414301643-A,LIAO KANG-SHYANG
US-201414301643-A,HALDAR AMRITA
US-201414301643-A,UNIV HOUSTON
US-201414320535-A,SLATER RICHARD LEE
US-201414320535-A,GEYER RANDALL
US-201414320535-A,STEFANESCU MUGUR
US-201414320535-A,INTUIT INC
US-201414328250-A,HONEYWELL INT INC
US-201214367790-A,3M INNOVATIVE PROPERTIES CO
US-201314383870-A,DIAMOND ENGINEERING LTD
US-201314389742-A,IDEAWARE INC
US-201314411860-A,NIPPON TELEGRAPH & TELEPHONE
US-201314411860-A,NTT ELECTRONICS CORP
US-201314414736-A,GREYSTONE TECHNOLOGIES PTY LTD
US-201314414736-A,MAREL AS
US-201314422722-A,SKF AB
US-201414426377-A,SHENZHEN CHINA STAR OPTOELECT
US-201314426935-A,KANGTANSANUP CO LTD
US-201314433372-A,XSYNCHRO INC
US-201414457074-A,KHACHATURIAN MARK
US-201414457074-A,SMITH MICHAEL G
US-201414457074-A,ARC DEVICES LTD
US-201414486211-A,XEROX CORP
US-201414506479-A,BANK OF AMERICA
US-201414506965-A,DUCK PLEIGHTS LLC
US-201414525026-A,BLACKER RACHEL KATHRYN
US-201414526030-A,HOFFMANN LA ROCHE
US-201414551874-A,TAIWAN SEMICONDUCTOR MFG
US-201414557169-A,GEN ELECTRIC
US-201414557777-A,BROADCOM CORP
US-201414567958-A,TENCENT TECH SHENZHEN CO LTD
US-201414578748-A,HELIOFOCUS LTD
US-201514589442-A,ARUN SOBTI & ASSOCIATES LLC
US-201514603918-A,SEIKO EPSON CORP
US-201514620997-A,WRIGHT DENNIS L
US-201514620997-A,ANDERSON AMY C
US-201514620997-A,SORMUNEN GRANT
US-201514638874-A,FUTUREWEI TECHNOLOGIES INC
US-201314649343-A,CHINA NAT OFFSHORE OIL CORP
US-201314649343-A,CHINA OILFIELD SERVICES LTD
US-201514667729-A,HALLA VISTEON CLIMATE CONTROL
US-201514669279-A,COMMISSARIAT ENERGIE ATOMIQUE
US-201514669279-A,ALTIS SEMICONDUCTOR SNC
US-201514670950-A,UNITED TECHNOLOGIES CORP

2025-01-20 21:56:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:56:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:56:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:56:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 21:56:26 - snowflake.connector.connection - INFO - closed
2025-01-20 21:56:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:56:26 - root - INFO - SQL:
SELECT t."application_number",
       TO_DATE(TO_VARCHAR(t."filing_date")) AS "filing_date_formatted",
       YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 100
Results:
application_number,filing_date_formatted,filing_year
CR-5634-A,1970-08-20,1970
CR-5990-A,1970-08-20,1970
FI-429D-A,1970-01-01,1970
HK-6083-A,1970-08-18,1970
HU-7590-A,1970-08-19,1970
JP-4890-A,1970-08-19,1970
JP-6286-A,1970-08-18,1970
US-416D-A,1970-01-01,1970
US-9948-A,1970-08-14,1970
AT-41580-A,1970-08-18,1970
AT-47682-A,1970-08-18,1970
AT-63682-A,1970-08-18,1970
CA-72337-A,1970-08-17,1970
CA-75688-A,1970-08-17,1970
CA-81627-A,1970-08-17,1970
CA-9086D-A,1970-01-01,1970
CH-3256D-A,1970-08-07,1970
CH-32972-A,1970-08-16,1970
CH-59566-A,1970-08-16,1970
CH-8494D-A,1970-08-08,1970
CH-9587D-A,1970-08-08,1970
CH-9968D-A,1970-08-08,1970
DD-8297D-A,1970-01-01,1970
FR-19873-A,1970-08-16,1970
FR-20966-A,1970-08-16,1970
FR-56170-A,1970-08-16,1970
FR-60658-A,1970-08-16,1970
FR-68041-A,1970-08-16,1970
FR-70755-A,1970-08-16,1970
FR-84394-A,1970-08-16,1970
GB-15660-A,1970-08-15,1970
GB-50958-A,1970-08-15,1970
GB-54729-A,1970-08-12,1970
GB-93140-A,1970-08-13,1970
HK-39487-A,1970-08-18,1970
HK-52284-A,1970-08-18,1970
HK-55992-A,1970-08-19,1970
HK-60178-A,1970-08-17,1970
HK-82486-A,1970-08-18,1970
HU-62391-A,1970-08-19,1970
JP-42386-A,1970-08-18,1970
JP-67093-A,1970-08-19,1970
MA-42286-A,1970-08-22,1970
OA-58112-A,1970-08-18,1970
OA-58887-A,1970-08-18,1970
PH-14999-A,1970-08-17,1970
PH-21568-A,1970-08-17,1970
PH-27280-A,1970-08-18,1970
PH-36517-A,1970-08-19,1970
TR-25990-A,1970-08-19,1970
US-4613D-A,1970-01-01,1970
US-59779-A,1970-08-18,1970
US-6310D-A,1970-01-01,1970
US-8947D-A,1970-01-01,1970
YU-24971-A,1970-08-17,1970
YU-51397-A,1970-08-20,1970
YU-53588-A,1970-08-19,1970
YU-94082-A,1970-08-18,1970
AT-134275-A,1970-08-17,1970
AT-160683-A,1970-08-18,1970
AT-168281-A,1970-08-18,1970
AT-179178-A,1970-08-17,1970
AT-196182-A,1970-08-18,1970
AT-202882-A,1970-08-18,1970
AT-205780-A,1970-08-18,1970
AT-245590-A,1970-08-19,1970
AT-250686-A,1970-08-18,1970
AT-269985-A,1970-08-18,1970
AT-272073-A,1970-08-17,1970
AT-312885-A,1970-08-18,1970
AT-404675-A,1970-08-17,1970
AT-482077-A,1970-08-17,1970
AT-519575-A,1970-08-17,1970
AT-710279-A,1970-08-18,1970
AT-735378-A,1970-08-17,1970
AT-876472-A,1970-08-17,1970
AT-906278-A,1970-08-17,1970
BE-135378-A,1970-08-17,1970
BE-137212-A,1970-08-17,1970
BE-142905-A,1970-08-17,1970
BE-151562-A,1970-08-17,1970
BE-153592-A,1970-08-17,1970
BE-160369-A,1970-08-17,1970
BE-163314-A,1970-08-17,1970
BE-163757-A,1970-08-17,1970
BE-165719-A,1970-08-17,1970
BE-172709-A,1970-08-17,1970
BE-176081-A,1970-08-17,1970
BE-176682-A,1970-08-17,1970
BE-179841-A,1970-08-17,1970
BE-182921-A,1970-08-17,1970
BE-187407-A,1970-08-17,1970
BE-188538-A,1970-08-17,1970
BE-189232-A,1970-08-17,1970
BE-189327-A,1970-08-17,1970
BE-191250-A,1970-08-17,1970
BE-192832-A,1970-08-18,1970
BE-196360-A,1970-08-18,1970
BE-202146-A,1970-08-18,1970
BE-509322-A,1970-08-14,1970

2025-01-20 21:56:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:56:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:56:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:56:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 21:56:27 - snowflake.connector.connection - INFO - closed
2025-01-20 21:56:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:56:28 - root - INFO - SQL:
SELECT t."application_number",
       a.value:"name"::STRING AS "assignee_name",
       YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value:"code"::STRING LIKE 'A01B3%'
LIMIT 100
Results:
application_number,assignee_name,filing_year
US-41054454-A,TRECKER FRANCIS J,1970
GB-585551-A,ARTHUR BROOKS SPURR,1970
IL-26862419-A,AGSOILWORKS TECH COMPANY LLC,1970
IL-26862419-A,AGSOILWORKS TECH COMPANY LLC,1970
KR-19970019112-U,CHO SUNG GU,1970
US-50994255-A,JIM ALEX SMITH,1970
US-50994255-A,JIM ALEX SMITH,1970
US-52103631-A,GLASIER HAROLD H,1970
US-52103631-A,GLASIER HAROLD H,1970
US-20046750-A,SHEPPARD RICHARD H,1970
US-20046750-A,SHEPPARD RICHARD H,1970
US-201916456505-A,LG ELECTRONICS INC,1970
US-1912673206-A,SOUTHERN PLOW COMPANY,1970
US-51933174-A,CARLUCCI JAMES J,1970
US-51933174-A,CARLUCCI JAMES J,1970
US-51933174-A,CARLUCCI JAMES J,1970
US-51933174-A,CARLUCCI JAMES J,1970
US-964648-A,AUGUST SETTERGREN OTTO GORAN,1970
US-964648-A,BOTVID SETTERGREN ANDERS GOSTA,1970
US-964648-A,AUGUST SETTERGREN OTTO GORAN,1970
US-964648-A,BOTVID SETTERGREN ANDERS GOSTA,1970
US-5637735-A,CAMPBELL CLARENCE L,1970
US-5637735-A,CAMPBELL CLARENCE L,1970
AU-7115874-A,NEW ZEALAND INVENTIONS DEV,1970
GB-1095134-A,WILLIAM HENRY HONY FROST,1970
GB-1095134-A,WILLIAM HENRY HONY FROST,1970
US-77445391-A,HARRELL DANNY H,1970
US-77445391-A,HARRELL DANNY H,1970
US-71336434-A,CHOATE STOREY NORMAN,1970
US-71336434-A,RUDOLPH HASSON PAUL,1970
US-71336434-A,CHOATE STOREY NORMAN,1970
US-71336434-A,RUDOLPH HASSON PAUL,1970
CN-201580056876-A,AMAZONEN-WERKE H DREYER GMBH & CO KG,1970
CN-201580056876-A,BETEK GMBH & CO KG,1970
CN-201580056876-A,AMAZONEN-WERKE H DREYER GMBH & CO KG,1970
CN-201580056876-A,BETEK GMBH & CO KG,1970
CN-201580056876-A,AMAZONEN-WERKE H DREYER GMBH & CO KG,1970
CN-201580056876-A,BETEK GMBH & CO KG,1970
US-68923896-A,QUINSTAR CORP,1970
US-68923896-A,QUINSTAR CORP,1970
KR-20120005914-A,BULLS CO LTD,1970
KR-20150076822-A,LIM HEON HO,1970
US-202217990129-A,CNH IND AMERICA LLC,1970
US-202217990129-A,CNH IND AMERICA LLC,1970
US-202217990129-A,CNH IND AMERICA LLC,1970
KR-20000035371-A,KIM JAE KEUN,1970
US-9826126-A,WILLIAM DREFKE,1970
US-9826126-A,WILLIAM DREFKE,1970
US-5528360-A,SIGFRID ANDERSON ANDERS,1970
US-5528360-A,SIGFRID ANDERSON ANDERS,1970
FR-508965D-A,EDMOND HEE,1970
FR-508965D-A,EDMOND HEE,1970
KR-20000009753-U,DAEHO FARMING MACHINERY CO LTD,1970
KR-20000011273-A,KUBOTA KK,1970
CN-201510892651-A,CHONGQING TIANJI IND CO LTD,1970
CN-201510892651-A,CHONGQING TIANJI IND CO LTD,1970
PL-44042622-A,OTULAK PRZEMYSLAW PRO CNC,1970
PL-44042622-A,OTULAK PRZEMYSLAW PRO CNC,1970
PL-44042622-A,OTULAK PRZEMYSLAW PRO CNC,1970
PL-44042622-A,OTULAK PRZEMYSLAW PRO CNC,1970
GB-202013028-A,ARWAC LTD,1970
GB-202013028-A,ARWAC LTD,1970
GB-202013028-A,ARWAC LTD,1970
CN-201810758930-A,HUBEI SHUANGYU MACHINERY TECH CO LTD,1970
CN-201810758930-A,HUBEI SHUANGYU MACHINERY TECH CO LTD,1970
FR-7531218-A,TEXAS INDUSTRIES INC,1970
FR-7531218-A,TEXAS INDUSTRIES INC,1970
FR-7531218-A,TEXAS INDUSTRIES INC,1970
FR-7531218-A,TEXAS INDUSTRIES INC,1970
FR-7531218-A,TEXAS INDUSTRIES INC,1970
FR-7531218-A,TEXAS INDUSTRIES INC,1970
FR-0901549-A,GERBER HUBERT,1970
FR-0901549-A,GERBER MAURICE,1970
CN-202210625064-A,WANG XUEDONG,1970
CN-202210625064-A,WANG XUEDONG,1970
US-1913771943-A,SALGE HENRY F,1970
KR-20060032729-A,SAMSUNG SDI CO LTD,1970
KR-20060032729-A,SAMSUNG SDI CO LTD,1970
KR-20010007666-A,KIM JONG JIN,1970
CN-201710322359-A,CHONGQING YUBAO AGRICULTURE EXPL CO LTD,1970
CN-201710322359-A,CHONGQING YUBAO AGRICULTURE EXPL CO LTD,1970
CA-2543900-A,EDWARDS JOHN W,1970
CA-2543900-A,EDWARDS JOHN W,1970
CA-163445-A,GUERBET FRANCOIS,1970
BE-9300543-A,LEIJENAAR SYTZE,1970
BE-9300543-A,LEIJENAAR SYTZE,1970
US-72598847-A,WALTER ROWAN JAMES,1970
US-72598847-A,WALTER ROWAN JAMES,1970
US-72598847-A,WALTER ROWAN JAMES,1970
US-72598847-A,WALTER ROWAN JAMES,1970
CN-201710636376-A,UNIV TONGJI,1970
CN-201710636376-A,UNIV TONGJI,1970
CN-202111095366-A,ZHANG LIJIN,1970
CN-202111095366-A,ZHANG LIJIN,1970
BE-192096-A,PATENT CONCERN NV,1970
BE-192096-A,PATENT CONCERN NV,1970
BE-192096-A,PATENT CONCERN NV,1970
CN-202210179147-A,GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1970
CN-202210179147-A,GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1970
CN-202210179147-A,GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1970

2025-01-20 21:56:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:56:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:56:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:56:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 87
2025-01-20 21:56:29 - snowflake.connector.connection - INFO - closed
2025-01-20 21:56:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:56:30 - root - INFO - SQL:
SELECT a.value:"name"::STRING AS "assignee_name",
       COUNT(DISTINCT t."application_number") AS "total_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value:"code"::STRING LIKE 'A01B3%'
GROUP BY a.value:"name"::STRING
ORDER BY "total_applications" DESC
LIMIT 100
Results:
assignee_name,total_applications
LELY NV C VAN DER,5
DEERE & CO,4
AMAZONEN WERKE DREYER H,2
KIM JAE KEUN,1
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1
KUBOTA KK,1
KUHN SA,1
FISHER VAN E,1
PREC PLANTING LLC,1
LEMKEN GMBH & CO KG,1
TRECKER FRANCIS J,1
ELEOS ROBOTICS INC,1
GERBER HUBERT,1
HUBEI SHUANGYU MACHINERY TECH CO LTD,1
INT HARVESTER GREAT BRITAIN,1
TWOSE OF TIVERTON LTD,1
BULLS CO LTD,1
DAEHO FARMING MACHINERY CO LTD,1
QUINSTAR CORP,1
NEW ZEALAND INVENTIONS DEV,1
LG ELECTRONICS INC,1
AMAZONEN-WERKE H DREYER GMBH & CO KG,1
KIM BYUNG SUB,1
WILLIAM HENRY HONY FROST,1
MARTIN DOMINIC R,1
SOUTHERN PLOW COMPANY,1
NIEMEYER SOEHNE STAHL PFLUG,1
GEORGE A KELLY PLOW COMPANY,1
RUDOLPH HASSON PAUL,1
WANG XUEDONG,1
MARTIN CHARLES H,1
GUERBET FRANCOIS,1
CHOATE STOREY NORMAN,1
ARTHUR BROOKS SPURR,1
CAMPBELL CLARENCE L,1
KORSMEYER ERNEST H,1
LEINFELDER DIPL-LANDW HERMANN,1
UNIV HEILONGJIANG SCI & TECH,1
HUBER FRANZ FERDINAND,1
RICHARD CO,1
LIM HEON HO,1
HOLGER LETH,1
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,1
MCKAY RALPH LTD,1
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,1
CHRISTEN ARNE JENSEN,1
CHO SUNG GU,1
GLASIER HAROLD H,1
GERBER MAURICE,1
EMPR IMPORT EXPORT Y DISTRIB P,1
CARLUCCI JAMES J,1
ZHANG LIJIN,1
WILLIAM DREFKE,1
SIGFRID ANDERSON ANDERS,1
TEXAS INDUSTRIES INC,1
SJOEHOLMS MEKANISKA AB,1
CHRISTOPHER H R WOODWARD,1
WALTER ROWAN JAMES,1
UNIV CHUNG ANG IND,1
HARRELL DANNY H,1
AUGUST SETTERGREN OTTO GORAN,1
SHEPPARD RICHARD H,1
ALLEN SAMUEL L,1
AGSOILWORKS TECH COMPANY LLC,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,1
CHONGQING TIANJI IND CO LTD,1
DAIYO TANGO CO LTD,1
SAMSUNG KWANGJU ELECTRONICS CO,1
EDMOND HEE,1
UNIV JIANGSU,1
UNIV TONGJI,1
PATENT CONCERN NV,1
OTULAK PRZEMYSLAW PRO CNC,1
KIM JONG JIN,1
SALGE HENRY F,1
SAPHIR MASCHB GMBH,1
Liu Yueshang,1
LEIJENAAR SYTZE,1
CNH IND AMERICA LLC,1
UNIV SYDNEY,1
BETEK GMBH & CO KG,1
EDWARDS JOHN W,1
ARWAC LTD,1
WALLNER KLAUS,1
SAMSUNG SDI CO LTD,1
JIM ALEX SMITH,1
BOTVID SETTERGREN ANDERS GOSTA,1

2025-01-20 21:56:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:56:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:56:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:56:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 87
2025-01-20 21:56:31 - snowflake.connector.connection - INFO - closed
2025-01-20 21:56:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:56:32 - root - INFO - SQL:
SELECT a.value:"name"::STRING AS "assignee_name",
       YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) AS "filing_year",
       COUNT(DISTINCT t."application_number") AS "applications_in_year"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value:"code"::STRING LIKE 'A01B3%'
GROUP BY a.value:"name"::STRING, "filing_year"
ORDER BY a.value:"name"::STRING, "applications_in_year" DESC
LIMIT 100
Results:
assignee_name,filing_year,applications_in_year
AGSOILWORKS TECH COMPANY LLC,1970,1
ALLEN SAMUEL L,1970,1
AMAZONEN WERKE DREYER H,1970,2
AMAZONEN-WERKE H DREYER GMBH & CO KG,1970,1
ARTHUR BROOKS SPURR,1970,1
ARWAC LTD,1970,1
AUGUST SETTERGREN OTTO GORAN,1970,1
BETEK GMBH & CO KG,1970,1
BOTVID SETTERGREN ANDERS GOSTA,1970,1
BULLS CO LTD,1970,1
CAMPBELL CLARENCE L,1970,1
CARLUCCI JAMES J,1970,1
CHO SUNG GU,1970,1
CHOATE STOREY NORMAN,1970,1
CHONGQING TIANJI IND CO LTD,1970,1
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,1970,1
CHRISTEN ARNE JENSEN,1970,1
CHRISTOPHER H R WOODWARD,1970,1
CNH IND AMERICA LLC,1970,1
DAEHO FARMING MACHINERY CO LTD,1970,1
DAIYO TANGO CO LTD,1970,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,1970,1
DEERE & CO,1970,4
EDMOND HEE,1970,1
EDWARDS JOHN W,1970,1
ELEOS ROBOTICS INC,1970,1
EMPR IMPORT EXPORT Y DISTRIB P,1970,1
FISHER VAN E,1970,1
GEORGE A KELLY PLOW COMPANY,1970,1
GERBER HUBERT,1970,1
GERBER MAURICE,1970,1
GLASIER HAROLD H,1970,1
GUERBET FRANCOIS,1970,1
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1970,1
HARRELL DANNY H,1970,1
HOLGER LETH,1970,1
HUBEI SHUANGYU MACHINERY TECH CO LTD,1970,1
HUBER FRANZ FERDINAND,1970,1
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,1970,1
INT HARVESTER GREAT BRITAIN,1970,1
JIM ALEX SMITH,1970,1
KIM BYUNG SUB,1970,1
KIM JAE KEUN,1970,1
KIM JONG JIN,1970,1
KORSMEYER ERNEST H,1970,1
KUBOTA KK,1970,1
KUHN SA,1970,1
LEIJENAAR SYTZE,1970,1
LEINFELDER DIPL-LANDW HERMANN,1970,1
LELY NV C VAN DER,1970,5
LEMKEN GMBH & CO KG,1970,1
LG ELECTRONICS INC,1970,1
LIM HEON HO,1970,1
Liu Yueshang,1970,1
MARTIN CHARLES H,1970,1
MARTIN DOMINIC R,1970,1
MCKAY RALPH LTD,1970,1
NEW ZEALAND INVENTIONS DEV,1970,1
NIEMEYER SOEHNE STAHL PFLUG,1970,1
OTULAK PRZEMYSLAW PRO CNC,1970,1
PATENT CONCERN NV,1970,1
PREC PLANTING LLC,1970,1
QUINSTAR CORP,1970,1
RICHARD CO,1970,1
RUDOLPH HASSON PAUL,1970,1
SALGE HENRY F,1970,1
SAMSUNG KWANGJU ELECTRONICS CO,1970,1
SAMSUNG SDI CO LTD,1970,1
SAPHIR MASCHB GMBH,1970,1
SHEPPARD RICHARD H,1970,1
SIGFRID ANDERSON ANDERS,1970,1
SJOEHOLMS MEKANISKA AB,1970,1
SOUTHERN PLOW COMPANY,1970,1
TEXAS INDUSTRIES INC,1970,1
TRECKER FRANCIS J,1970,1
TWOSE OF TIVERTON LTD,1970,1
UNIV CHUNG ANG IND,1970,1
UNIV HEILONGJIANG SCI & TECH,1970,1
UNIV JIANGSU,1970,1
UNIV SYDNEY,1970,1
UNIV TONGJI,1970,1
WALLNER KLAUS,1970,1
WALTER ROWAN JAMES,1970,1
WANG XUEDONG,1970,1
WILLIAM DREFKE,1970,1
WILLIAM HENRY HONY FROST,1970,1
ZHANG LIJIN,1970,1

2025-01-20 21:56:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:56:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:56:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:56:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 93
2025-01-20 21:56:33 - snowflake.connector.connection - INFO - closed
2025-01-20 21:56:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:56:34 - root - INFO - SQL:
SELECT a.value:"name"::STRING AS "assignee_name",
       YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) AS "filing_year",
       t."country_code",
       COUNT(DISTINCT t."application_number") AS "applications_in_country"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value:"code"::STRING LIKE 'A01B3%'
GROUP BY a.value:"name"::STRING, "filing_year", t."country_code"
ORDER BY a.value:"name"::STRING, "filing_year", "applications_in_country" DESC
LIMIT 100
Results:
assignee_name,filing_year,country_code,applications_in_country
AGSOILWORKS TECH COMPANY LLC,1970,IL,1
ALLEN SAMUEL L,1970,US,1
AMAZONEN WERKE DREYER H,1970,AT,1
AMAZONEN WERKE DREYER H,1970,GB,1
AMAZONEN-WERKE H DREYER GMBH & CO KG,1970,CN,1
ARTHUR BROOKS SPURR,1970,GB,1
ARWAC LTD,1970,GB,1
AUGUST SETTERGREN OTTO GORAN,1970,US,1
BETEK GMBH & CO KG,1970,CN,1
BOTVID SETTERGREN ANDERS GOSTA,1970,US,1
BULLS CO LTD,1970,KR,1
CAMPBELL CLARENCE L,1970,US,1
CARLUCCI JAMES J,1970,US,1
CHO SUNG GU,1970,KR,1
CHOATE STOREY NORMAN,1970,US,1
CHONGQING TIANJI IND CO LTD,1970,CN,1
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,1970,CN,1
CHRISTEN ARNE JENSEN,1970,DE,1
CHRISTOPHER H R WOODWARD,1970,US,1
CNH IND AMERICA LLC,1970,US,1
DAEHO FARMING MACHINERY CO LTD,1970,KR,1
DAIYO TANGO CO LTD,1970,KR,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,1970,CN,1
DEERE & CO,1970,NL,1
DEERE & CO,1970,EP,1
DEERE & CO,1970,CA,1
DEERE & CO,1970,AU,1
EDMOND HEE,1970,FR,1
EDWARDS JOHN W,1970,CA,1
ELEOS ROBOTICS INC,1970,CA,1
EMPR IMPORT EXPORT Y DISTRIB P,1970,NO,1
FISHER VAN E,1970,US,1
GEORGE A KELLY PLOW COMPANY,1970,US,1
GERBER HUBERT,1970,FR,1
GERBER MAURICE,1970,FR,1
GLASIER HAROLD H,1970,US,1
GUERBET FRANCOIS,1970,CA,1
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1970,CN,1
HARRELL DANNY H,1970,US,1
HOLGER LETH,1970,DE,1
HUBEI SHUANGYU MACHINERY TECH CO LTD,1970,CN,1
HUBER FRANZ FERDINAND,1970,DE,1
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,1970,CN,1
INT HARVESTER GREAT BRITAIN,1970,GB,1
JIM ALEX SMITH,1970,US,1
KIM BYUNG SUB,1970,KR,1
KIM JAE KEUN,1970,KR,1
KIM JONG JIN,1970,KR,1
KORSMEYER ERNEST H,1970,US,1
KUBOTA KK,1970,KR,1
KUHN SA,1970,CA,1
LEIJENAAR SYTZE,1970,BE,1
LEINFELDER DIPL-LANDW HERMANN,1970,DE,1
LELY NV C VAN DER,1970,IT,3
LELY NV C VAN DER,1970,GB,1
LELY NV C VAN DER,1970,NL,1
LEMKEN GMBH & CO KG,1970,DE,1
LG ELECTRONICS INC,1970,US,1
LIM HEON HO,1970,KR,1
Liu Yueshang,1970,CN,1
MARTIN CHARLES H,1970,US,1
MARTIN DOMINIC R,1970,US,1
MCKAY RALPH LTD,1970,ZA,1
NEW ZEALAND INVENTIONS DEV,1970,AU,1
NIEMEYER SOEHNE STAHL PFLUG,1970,DE,1
OTULAK PRZEMYSLAW PRO CNC,1970,PL,1
PATENT CONCERN NV,1970,BE,1
PREC PLANTING LLC,1970,CN,1
QUINSTAR CORP,1970,US,1
RICHARD CO,1970,US,1
RUDOLPH HASSON PAUL,1970,US,1
SALGE HENRY F,1970,US,1
SAMSUNG KWANGJU ELECTRONICS CO,1970,CN,1
SAMSUNG SDI CO LTD,1970,KR,1
SAPHIR MASCHB GMBH,1970,EP,1
SHEPPARD RICHARD H,1970,US,1
SIGFRID ANDERSON ANDERS,1970,US,1
SJOEHOLMS MEKANISKA AB,1970,NO,1
SOUTHERN PLOW COMPANY,1970,US,1
TEXAS INDUSTRIES INC,1970,FR,1
TRECKER FRANCIS J,1970,US,1
TWOSE OF TIVERTON LTD,1970,GB,1
UNIV CHUNG ANG IND,1970,KR,1
UNIV HEILONGJIANG SCI & TECH,1970,CN,1
UNIV JIANGSU,1970,CN,1
UNIV SYDNEY,1970,AU,1
UNIV TONGJI,1970,CN,1
WALLNER KLAUS,1970,HU,1
WALTER ROWAN JAMES,1970,US,1
WANG XUEDONG,1970,CN,1
WILLIAM DREFKE,1970,US,1
WILLIAM HENRY HONY FROST,1970,GB,1
ZHANG LIJIN,1970,CN,1

2025-01-20 21:56:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:56:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:56:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:56:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 87
2025-01-20 21:56:35 - snowflake.connector.connection - INFO - closed
2025-01-20 21:56:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:56:36 - root - INFO - SQL:
SELECT
    main."assignee_name",
    main."total_applications",
    main."top_year",
    main."applications_in_top_year",
    country_stats."top_country_code"
FROM
(
    SELECT
        assignee_stats."assignee_name",
        assignee_stats."total_applications",
        yearly_stats."filing_year" AS "top_year",
        yearly_stats."applications_in_year" AS "applications_in_top_year"
    FROM
    (
        SELECT a.value:"name"::STRING AS "assignee_name",
               COUNT(DISTINCT t."application_number") AS "total_applications"
        FROM PATENTS.PATENTS.PUBLICATIONS t,
             LATERAL FLATTEN(input => t."cpc") c,
             LATERAL FLATTEN(input => t."assignee_harmonized") a
        WHERE c.value:"code"::STRING LIKE 'A01B3%'
        GROUP BY a.value:"name"::STRING
    ) assignee_stats
    JOIN
    (
        SELECT a.value:"name"::STRING AS "assignee_name",
               YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) AS "filing_year",
               COUNT(DISTINCT t."application_number") AS "applications_in_year"
        FROM PATENTS.PATENTS.PUBLICATIONS t,
             LATERAL FLATTEN(input => t."cpc") c,
             LATERAL FLATTEN(input => t."assignee_harmonized") a
        WHERE c.value:"code"::STRING LIKE 'A01B3%'
        GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(TO_VARCHAR(t."filing_date")))
    ) yearly_stats
    ON assignee_stats."assignee_name" = yearly_stats."assignee_name"
    QUALIFY ROW_NUMBER() OVER (PARTITION BY assignee_stats."assignee_name"
                               ORDER BY yearly_stats."applications_in_year" DESC) = 1
) main
JOIN
(
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) AS "filing_year",
        t."country_code" AS "top_country_code",
        COUNT(DISTINCT t."application_number") AS "applications_in_country"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."cpc") c,
         LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))), t."country_code"
    QUALIFY ROW_NUMBER() OVER (PARTITION BY a.value:"name"::STRING, YEAR(TO_DATE(TO_VARCHAR(t."filing_date")))
                               ORDER BY COUNT(DISTINCT t."application_number") DESC) = 1
) country_stats
ON main."assignee_name" = country_stats."assignee_name" AND main."top_year" = country_stats."filing_year"
ORDER BY main."total_applications" DESC
LIMIT 100
Results:
assignee_name,total_applications,top_year,applications_in_top_year,top_country_code
LELY NV C VAN DER,5,1970,5,IT
DEERE & CO,4,1970,4,NL
AMAZONEN WERKE DREYER H,2,1970,2,GB
SIGFRID ANDERSON ANDERS,1,1970,1,US
DAIYO TANGO CO LTD,1,1970,1,KR
BOTVID SETTERGREN ANDERS GOSTA,1,1970,1,US
EMPR IMPORT EXPORT Y DISTRIB P,1,1970,1,NO
UNIV SYDNEY,1,1970,1,AU
GERBER HUBERT,1,1970,1,FR
PATENT CONCERN NV,1,1970,1,BE
HOLGER LETH,1,1970,1,DE
MCKAY RALPH LTD,1,1970,1,ZA
KIM JONG JIN,1,1970,1,KR
NEW ZEALAND INVENTIONS DEV,1,1970,1,AU
KUBOTA KK,1,1970,1,KR
GEORGE A KELLY PLOW COMPANY,1,1970,1,US
ARWAC LTD,1,1970,1,GB
GUERBET FRANCOIS,1,1970,1,CA
TRECKER FRANCIS J,1,1970,1,US
KIM BYUNG SUB,1,1970,1,KR
ARTHUR BROOKS SPURR,1,1970,1,GB
KUHN SA,1,1970,1,CA
SHEPPARD RICHARD H,1,1970,1,US
HUBEI SHUANGYU MACHINERY TECH CO LTD,1,1970,1,CN
LG ELECTRONICS INC,1,1970,1,US
HUBER FRANZ FERDINAND,1,1970,1,DE
CHRISTEN ARNE JENSEN,1,1970,1,DE
LEINFELDER DIPL-LANDW HERMANN,1,1970,1,DE
CHOATE STOREY NORMAN,1,1970,1,US
CHO SUNG GU,1,1970,1,KR
PREC PLANTING LLC,1,1970,1,CN
UNIV TONGJI,1,1970,1,CN
SALGE HENRY F,1,1970,1,US
TWOSE OF TIVERTON LTD,1,1970,1,GB
KIM JAE KEUN,1,1970,1,KR
WALLNER KLAUS,1,1970,1,HU
MARTIN CHARLES H,1,1970,1,US
AMAZONEN-WERKE H DREYER GMBH & CO KG,1,1970,1,CN
HARRELL DANNY H,1,1970,1,US
JIM ALEX SMITH,1,1970,1,US
CHRISTOPHER H R WOODWARD,1,1970,1,US
INT HARVESTER GREAT BRITAIN,1,1970,1,GB
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,1,1970,1,CN
WALTER ROWAN JAMES,1,1970,1,US
CHONGQING TIANJI IND CO LTD,1,1970,1,CN
KORSMEYER ERNEST H,1,1970,1,US
LIM HEON HO,1,1970,1,KR
CAMPBELL CLARENCE L,1,1970,1,US
WILLIAM DREFKE,1,1970,1,US
LEIJENAAR SYTZE,1,1970,1,BE
EDWARDS JOHN W,1,1970,1,CA
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,1,1970,1,CN
MARTIN DOMINIC R,1,1970,1,US
ELEOS ROBOTICS INC,1,1970,1,CA
SAPHIR MASCHB GMBH,1,1970,1,EP
UNIV CHUNG ANG IND,1,1970,1,KR
SAMSUNG SDI CO LTD,1,1970,1,KR
WILLIAM HENRY HONY FROST,1,1970,1,GB
SJOEHOLMS MEKANISKA AB,1,1970,1,NO
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1,1970,1,CN
EDMOND HEE,1,1970,1,FR
RUDOLPH HASSON PAUL,1,1970,1,US
SAMSUNG KWANGJU ELECTRONICS CO,1,1970,1,CN
UNIV HEILONGJIANG SCI & TECH,1,1970,1,CN
QUINSTAR CORP,1,1970,1,US
OTULAK PRZEMYSLAW PRO CNC,1,1970,1,PL
ALLEN SAMUEL L,1,1970,1,US
Liu Yueshang,1,1970,1,CN
WANG XUEDONG,1,1970,1,CN
CNH IND AMERICA LLC,1,1970,1,US
AGSOILWORKS TECH COMPANY LLC,1,1970,1,IL
GLASIER HAROLD H,1,1970,1,US
CARLUCCI JAMES J,1,1970,1,US
BETEK GMBH & CO KG,1,1970,1,CN
SOUTHERN PLOW COMPANY,1,1970,1,US
FISHER VAN E,1,1970,1,US
GERBER MAURICE,1,1970,1,FR
BULLS CO LTD,1,1970,1,KR
TEXAS INDUSTRIES INC,1,1970,1,FR
AUGUST SETTERGREN OTTO GORAN,1,1970,1,US
ZHANG LIJIN,1,1970,1,CN
DAEHO FARMING MACHINERY CO LTD,1,1970,1,KR
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,1,1970,1,CN
LEMKEN GMBH & CO KG,1,1970,1,DE
UNIV JIANGSU,1,1970,1,CN
NIEMEYER SOEHNE STAHL PFLUG,1,1970,1,DE
RICHARD CO,1,1970,1,US

2025-01-20 21:56:36 - root - INFO - itercount: 0
2025-01-20 21:56:36 - root - INFO - Database Name: PATENTS
Schema Name: PATENTS
DDL describes table information.
,0
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,1
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""spif_publication_number"" VARCHAR(16777216),
	""spif_application_number"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""claims_localized_html"" VARIANT,
	""description_localized"" VARIANT,
	""description_localized_html"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""locarno"" VARIANT,
	""citation"" VARIANT,
	""parent"" VARIANT,
	""child"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,2
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table:** `PATENTS.PATENTS.PUBLICATIONS`

  - **"cpc"**: VARIANT - Contains the CPC classification codes for each patent. Used to identify patents classified under A01B3.

  - **"assignee_harmonized"**: VARIANT - Contains standardized assignee information. Used to extract assignee names.

  - **"filing_date"**: NUMBER(38,0) - Filing date of the patent application. Used to extract the year for determining the year with the most applications.

  - **"country_code"**: VARCHAR - Indicates the country where the patent application was filed.

  - **"application_number"**: VARCHAR - Unique identifier for each application. Used for counting total applications.

**Conditions that may be used:**

- Filtering patents where `"cpc"` contains the code `'A01B3'`.

- Extracting assignee names from `"assignee_harmonized"`.

- Converting `"filing_date"` to a date format and extracting the year.

- Grouping by assignee names, years, and country codes to perform counts.

---

**SQL Queries:**

1. **Retrieve sample CPC entries to understand the structure:**

    ```sql
    SELECT t."cpc"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    LIMIT 100;
    ```

2. **Flatten the "cpc" column to inspect individual CPC codes:**

    ```sql
    SELECT c.value AS "cpc_entry"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") c
    LIMIT 100;
    ```

3. **Select patents classified under CPC code 'A01B3':**

    ```sql
    SELECT t."application_number", c.value:"symbol"::STRING AS "cpc_symbol"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") c
    WHERE c.value:"symbol"::STRING = 'A01B3'
    LIMIT 100;
    ```

4. **Extract assignee names from the "assignee_harmonized" column:**

    ```sql
    SELECT t."application_number", a.value:"name"::STRING AS "assignee_name"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a
    LIMIT 100;
    ```

5. **Convert "filing_date" to date format and extract the year:**

    ```sql
    SELECT t."application_number", DATE_FROM_PARTS(TO_VARCHAR(t."filing_date")) AS "filing_date_formatted", YEAR(DATE_FROM_PARTS(TO_VARCHAR(t."filing_date"))) AS "filing_year"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    LIMIT 100;
    ```

6. **List patents in CPC 'A01B3' with assignee names and filing years:**

    ```sql
    SELECT t."application_number", a.value:"name"::STRING AS "assignee_name", YEAR(DATE_FROM_PARTS(TO_VARCHAR(t."filing_date"))) AS "filing_year"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") c,
    LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"symbol"::STRING = 'A01B3'
    LIMIT 100;
    ```

7. **Count total applications per assignee for CPC 'A01B3':**

    ```sql
    SELECT a.value:"name"::STRING AS "assignee_name", COUNT(DISTINCT t."application_number") AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") c,
    LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"symbol"::STRING = 'A01B3'
    GROUP BY "assignee_name"
    ORDER BY "total_applications" DESC
    LIMIT 100;
    ```

8. **Find the year with the most applications per assignee:**

    ```sql
    SELECT a.value:"name"::STRING AS "assignee_name", YEAR(DATE_FROM_PARTS(TO_VARCHAR(t."filing_date"))) AS "filing_year", COUNT(DISTINCT t."application_number") AS "applications_in_year"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") c,
    LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"symbol"::STRING = 'A01B3'
    GROUP BY "assignee_name", "filing_year"
    ORDER BY "assignee_name", "applications_in_year" DESC
    LIMIT 100;
    ```

9. **Determine the country code with the most applications per assignee and year:**

    ```sql
    SELECT a.value:"name"::STRING AS "assignee_name", YEAR(DATE_FROM_PARTS(TO_VARCHAR(t."filing_date"))) AS "filing_year", t."country_code", COUNT(DISTINCT t."application_number") AS "applications_in_country"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") c,
    LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"symbol"::STRING = 'A01B3'
    GROUP BY "assignee_name", "filing_year", t."country_code"
    ORDER BY "assignee_name", "filing_year", "applications_in_country" DESC
    LIMIT 100;
    ```

10. **Compile total applications, top year, and top country code per assignee:**

    ```sql
    SELECT
        main."assignee_name",
        main."total_applications",
        main."top_year",
        main."applications_in_top_year",
        country_stats."top_country_code"
    FROM
    (
        SELECT
            assignee_stats."assignee_name",
            assignee_stats."total_applications",
            yearly_stats."filing_year" AS "top_year",
            yearly_stats."applications_in_year" AS "applications_in_top_year"
        FROM
        (
            SELECT a.value:"name"::STRING AS "assignee_name", COUNT(DISTINCT t."application_number") AS "total_applications"
            FROM PATENTS.PATENTS.PUBLICATIONS t,
            LATERAL FLATTEN(input => t."cpc") c,
            LATERAL FLATTEN(input => t."assignee_harmonized") a
            WHERE c.value:"symbol"::STRING = 'A01B3'
            GROUP BY "assignee_name"
        ) assignee_stats
        JOIN
        (
            SELECT a.value:"name"::STRING AS "assignee_name", YEAR(DATE_FROM_PARTS(TO_VARCHAR(t."filing_date"))) AS "filing_year", COUNT(DISTINCT t."application_number") AS "applications_in_year"
            FROM PATENTS.PATENTS.PUBLICATIONS t,
            LATERAL FLATTEN(input => t."cpc") c,
            LATERAL FLATTEN(input => t."assignee_harmonized") a
            WHERE c.value:"symbol"::STRING = 'A01B3'
            GROUP BY "assignee_name", "filing_year"
        ) yearly_stats
        ON assignee_stats."assignee_name" = yearly_stats."assignee_name"
        QUALIFY ROW_NUMBER() OVER (PARTITION BY assignee_stats."assignee_name" ORDER BY yearly_stats."applications_in_year" DESC) = 1
    ) main
    JOIN
    (
        SELECT
            a.value:"name"::STRING AS "assignee_name",
            YEAR(DATE_FROM_PARTS(TO_VARCHAR(t."filing_date"))) AS "filing_year",
            t."country_code",
            COUNT(DISTINCT t."application_number") AS "applications_in_country"
        FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
        WHERE c.value:"symbol"::STRING = 'A01B3'
        GROUP BY "assignee_name", "filing_year", t."country_code"
        QUALIFY ROW_NUMBER() OVER (PARTITION BY "assignee_name", "filing_year" ORDER BY COUNT(DISTINCT t."application_number") DESC) = 1
    ) country_stats
    ON main."assignee_name" = country_stats."assignee_name" AND main."top_year" = country_stats."filing_year"
    ORDER BY main."total_applications" DESC
    LIMIT 100;
    ```

**Explanation:**

The queries above progressively explore the data required to analyze the top assignees for patent class A01B3:

- Queries 1-2: Understand the structure of the "cpc" column to identify how CPC codes are stored.

- Query 3: Retrieve patents specifically classified under CPC code 'A01B3'.

- Queries 4-5: Extract assignee names and handle date conversions to prepare for aggregation.

- Queries 6-7: List patents with their assignees and count total applications per assignee.

- Queries 8-9: Determine the year with the most applications per assignee and identify the country codes associated with those applications.

- Query 10: Compile the required information by combining previous aggregations, focusing on total applications, top years, and top country codes per assignee.

All column names are enclosed in double quotations, and the queries limit results to 100 rows as instructed. The queries are designed to help understand the data and relationships between the relevant columns without directly providing the final analysis requested in the task.Query:
SELECT t."cpc"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    LIMIT 100;
Answer:
Too long, hard cut:
cpc
[]
[]
[]
"[
  {
    ""code"": ""H02M5/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""A01N47/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D521/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""Y02A40/81"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""Y02E30/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""Y10T83/465"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""B26F1/42"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""B22D11/086"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""C07D471/16"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D471/22"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""G01N33/48728"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""C11B5/0064"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/35"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C11B5/0035"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M135/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C09K15/30"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D263/56"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/44"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D235/12"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/3447"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/48"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/46"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D277/64"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/47"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/224"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/102"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/106"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/104"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/10"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/221"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/226"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/225"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/22"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10L1/14"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""E02D5/808"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/385"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/26"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/28"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/54"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
[]
[]
"[
  {
    ""code"": ""C07D213/32"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/51"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/51"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/22"",
    ""first"": true,
    ""inventive"": true,
    ""t
Query:
SELECT c.value AS "cpc_entry"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") c
    LIMIT 100;
Answer:
Too long, hard cut:
cpc_entry
"{
  ""code"": ""C23F1/26"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L21/3212"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C23F3/06"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L21/32134"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C23F3/06"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C09G1/02"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L21/32115"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C23F3/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C23F1/18"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C09G1/02"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C23F3/06"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L21/32115"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L21/3212"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C23F1/18"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C23F3/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L21/32134"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""A61N1/05"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""A61N1/05"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""A61N1/056"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""A61N1/056"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""A61B7/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""A61B5/318"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""A61B7/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""A61B5/0816"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""A61B5/0816"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""A61B5/318"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/0421"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/3095"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/3072"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/02476"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/0217"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/18308"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/18375"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/18377"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/04253"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/04252"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/18369"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/18375"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/18369"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/18308"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/0217"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/3072"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/02476"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/18377"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/0421"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/3095"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/04253"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/04252"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/18375"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/3095"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/18377"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/02476"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/0217"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01S5/18369"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code
Query:
SELECT t."application_number", a.value:"name"::STRING AS "assignee_name", YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) AS "filing_year", t."country_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."cpc") c,
LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value:"code"::STRING LIKE 'A01B3%'
LIMIT 100;
Answer:
application_number,assignee_name,filing_year,country_code
PL-44042622-A,OTULAK PRZEMYSLAW PRO CNC,1970,PL
PL-44042622-A,OTULAK PRZEMYSLAW PRO CNC,1970,PL
PL-44042622-A,OTULAK PRZEMYSLAW PRO CNC,1970,PL
PL-44042622-A,OTULAK PRZEMYSLAW PRO CNC,1970,PL
US-50994255-A,JIM ALEX SMITH,1970,US
US-50994255-A,JIM ALEX SMITH,1970,US
US-52103631-A,GLASIER HAROLD H,1970,US
US-52103631-A,GLASIER HAROLD H,1970,US
US-964648-A,AUGUST SETTERGREN OTTO GORAN,1970,US
US-964648-A,BOTVID SETTERGREN ANDERS GOSTA,1970,US
US-964648-A,AUGUST SETTERGREN OTTO GORAN,1970,US
US-964648-A,BOTVID SETTERGREN ANDERS GOSTA,1970,US
CA-163445-A,GUERBET FRANCOIS,1970,CA
US-41054454-A,TRECKER FRANCIS J,1970,US
US-1209525-A,FISHER VAN E,1970,US
US-1209525-A,FISHER VAN E,1970,US
US-20046750-A,SHEPPARD RICHARD H,1970,US
US-20046750-A,SHEPPARD RICHARD H,1970,US
KR-19960029894-A,KIM BYUNG SUB,1970,KR
KR-19960029894-A,KIM BYUNG SUB,1970,KR
US-1904197554-A,ALLEN SAMUEL L,1970,US
US-6966360-A,RICHARD CO,1970,US
US-6966360-A,RICHARD CO,1970,US
US-202217990129-A,CNH IND AMERICA LLC,1970,US
US-202217990129-A,CNH IND AMERICA LLC,1970,US
US-202217990129-A,CNH IND AMERICA LLC,1970,US
US-5637735-A,CAMPBELL CLARENCE L,1970,US
US-5637735-A,CAMPBELL CLARENCE L,1970,US
AU-7115874-A,NEW ZEALAND INVENTIONS DEV,1970,AU
GB-1095134-A,WILLIAM HENRY HONY FROST,1970,GB
GB-1095134-A,WILLIAM HENRY HONY FROST,1970,GB
GB-585551-A,ARTHUR BROOKS SPURR,1970,GB
IL-26862419-A,AGSOILWORKS TECH COMPANY LLC,1970,IL
IL-26862419-A,AGSOILWORKS TECH COMPANY LLC,1970,IL
KR-20000035371-A,KIM JAE KEUN,1970,KR
US-51933174-A,CARLUCCI JAMES J,1970,US
US-51933174-A,CARLUCCI JAMES J,1970,US
US-51933174-A,CARLUCCI JAMES J,1970,US
US-51933174-A,CARLUCCI JAMES J,1970,US
US-77445391-A,HARRELL DANNY H,1970,US
US-77445391-A,HARRELL DANNY H,1970,US
KR-20120005914-A,BULLS CO LTD,1970,KR
KR-20150076822-A,LIM HEON HO,1970,KR
US-71336434-A,CHOATE STOREY NORMAN,1970,US
US-71336434-A,RUDOLPH HASSON PAUL,1970,US
US-71336434-A,CHOATE STOREY NORMAN,1970,US
US-71336434-A,RUDOLPH HASSON PAUL,1970,US
US-201916456505-A,LG ELECTRONICS INC,1970,US
FR-7531218-A,TEXAS INDUSTRIES INC,1970,FR
FR-7531218-A,TEXAS INDUSTRIES INC,1970,FR
FR-7531218-A,TEXAS INDUSTRIES INC,1970,FR
FR-7531218-A,TEXAS INDUSTRIES INC,1970,FR
FR-7531218-A,TEXAS INDUSTRIES INC,1970,FR
FR-7531218-A,TEXAS INDUSTRIES INC,1970,FR
GB-202013028-A,ARWAC LTD,1970,GB
GB-202013028-A,ARWAC LTD,1970,GB
GB-202013028-A,ARWAC LTD,1970,GB
US-1901066531-A,GEORGE A KELLY PLOW COMPANY,1970,US
KR-20000011273-A,KUBOTA KK,1970,KR
CN-201510892651-A,CHONGQING TIANJI IND CO LTD,1970,CN
CN-201510892651-A,CHONGQING TIANJI IND CO LTD,1970,CN
KR-20010007666-A,KIM JONG JIN,1970,KR
BE-9300543-A,LEIJENAAR SYTZE,1970,BE
BE-9300543-A,LEIJENAAR SYTZE,1970,BE
CN-201580056876-A,AMAZONEN-WERKE H DREYER GMBH & CO KG,1970,CN
CN-201580056876-A,BETEK GMBH & CO KG,1970,CN
CN-201580056876-A,AMAZONEN-WERKE H DREYER GMBH & CO KG,1970,CN
CN-201580056876-A,BETEK GMBH & CO KG,1970,CN
CN-201580056876-A,AMAZONEN-WERKE H DREYER GMBH & CO KG,1970,CN
CN-201580056876-A,BETEK GMBH & CO KG,1970,CN
CN-201710636376-A,UNIV TONGJI,1970,CN
CN-201710636376-A,UNIV TONGJI,1970,CN
CN-201810758930-A,HUBEI SHUANGYU MACHINERY TECH CO LTD,1970,CN
CN-201810758930-A,HUBEI SHUANGYU MACHINERY TECH CO LTD,1970,CN
US-1912673206-A,SOUTHERN PLOW COMPANY,1970,US
GB-616956-A,INT HARVESTER GREAT BRITAIN,1970,GB
CN-202210179147-A,GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1970,CN
CN-202210179147-A,GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1970,CN
CN-202210179147-A,GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1970,CN
US-1913771943-A,SALGE HENRY F,1970,US
KR-20060032729-A,SAMSUNG SDI CO LTD,1970,KR
KR-20060032729-A,SAMSUNG SDI CO LTD,1970,KR
CN-202210625064-A,WANG XUEDONG,1970,CN
CN-202210625064-A,WANG XUEDONG,1970,CN
CN-202111095366-A,ZHANG LIJIN,1970,CN
CN-202111095366-A,ZHANG LIJIN,1970,CN
CN-201811558564-A,DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,1970,CN
CN-201811558564-A,DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,1970,CN
GB-8100746-A,TWOSE OF TIVERTON LTD,1970,GB
GB-8100746-A,TWOSE OF TIVERTON LTD,1970,GB
GB-8100746-A,TWOSE OF TIVERTON LTD,1970,GB
GB-8100746-A,TWOSE OF TIVERTON LTD,1970,GB
ZA-808003-A,MCKAY RALPH LTD,1970,ZA
ZA-808003-A,MCKAY RALPH LTD,1970,ZA
ZA-808003-A,MCKAY RALPH LTD,1970,ZA
ZA-808003-A,MCKAY RALPH LTD,1970,ZA
GB-8136897-A,LELY NV C VAN DER,1970,GB
IT-3003576-A,LELY NV C VAN DER,1970,IT
IT-3003576-A,LELY NV C VAN DER,1970,IT
US-38733520-A,KORSMEYER ERNEST H,1970,US
Query:
SELECT t."application_number", a.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."assignee_harmonized") a
LIMIT 100
Answer:
application_number,assignee_name
US-85984810-A,YAMAHA MOTOR CO LTD
US-89124010-A,BIODEL INC
US-89753110-A,PONGPEERAPAT ADCHARA
US-89753110-A,HIBI TORU
US-89759810-A,PAJIC NICK
US-90603310-A,CHESTNUT HILL SOUND INC
US-90739510-A,JI SUNG HOON
US-91151710-A,BOSTON SCIENT SCIMED INC
US-91238010-A,PITTS IAN
US-91435610-A,APERIO TECHNOLOGIES INC
US-92496510-A,QUICK NATHANIEL R
US-92496510-A,KAR ARAVINDA
US-94145110-A,SASA NOBORU
US-95717810-A,GALVIN JEFFREY A
US-95717810-A,LAI ZHENNAN
US-95717810-A,YANG QIANG
US-97637810-A,ZHANG MAOYONG
US-97637810-A,WANG JIANLIANG
US-201113006324-A,KOREA ADVANCED INST SCI & TECH
US-201113012430-A,FUJI KIKO KK
US-201113048581-A,VADERS DENNIS HENRY
US-201113097202-A,Sanovel IIac Sanayi Ve Ticaret Anonim Sirketi
US-200913127336-A,ERICSSON TELEFON AB L M
US-201113186515-A,SHIN DONG-SUK
US-201113186515-A,LEE YONG-JOO
US-201113186515-A,KIM DONG-HYUK
US-201113186515-A,KIM MYUNG-SUN
US-201113186515-A,CHUNG HOI-SUNG
US-201113187366-A,PARK DAE-WOO
US-201113187366-A,HONG YU-MI
US-201113187366-A,SAMSUNG ELECTRONICS CO LTD
US-201113312095-A,MEI RICHARD Y
US-201113312095-A,MACAULEY DANIEL W
US-201113312095-A,GERMAN MICHAEL
US-201013321088-A,HAN JIN KYU
US-201013321088-A,CHO JOON YOUNG
US-201013321088-A,LEE JU HO
US-201013321088-A,SAMSUNG ELECTRONICS CO LTD
US-201013377225-A,GODEL FRANCK
US-201013377225-A,GUEIT NICOLAS MARIE PIERRE
US-201013377225-A,MAILLE JULIEN MARCEL ROGER
US-201013377225-A,SNECMA
US-201313912184-A,MICROSOFT CORP
US-201313928199-A,LANDVOICE DATA LLC
US-201314076307-A,MITSUBISHI ELECTRIC RES LAB
US-201314079549-A,NETAPP INC
US-201314102772-A,ASIA VITAL COMPONENTS CO LTD
US-201314106335-A,VISIER SOLUTIONS INC
US-201414185303-A,HONEYWELL INT INC
US-201414198203-A,TOSHIBA KK
US-201414205742-A,JOHN KEELER & CO INC
US-201414280242-A,UNIV NOTRE DAME DU LAC
US-201414293602-A,SYNERSCOPE B V
US-201414299080-A,EATON CORP
US-201414301643-A,CURRAN SEAMUS
US-201414301643-A,ALLEY NIGEL
US-201414301643-A,LIAO KANG-SHYANG
US-201414301643-A,HALDAR AMRITA
US-201414301643-A,UNIV HOUSTON
US-201414320535-A,SLATER RICHARD LEE
US-201414320535-A,GEYER RANDALL
US-201414320535-A,STEFANESCU MUGUR
US-201414320535-A,INTUIT INC
US-201414328250-A,HONEYWELL INT INC
US-201214367790-A,3M INNOVATIVE PROPERTIES CO
US-201314383870-A,DIAMOND ENGINEERING LTD
US-201314389742-A,IDEAWARE INC
US-201314411860-A,NIPPON TELEGRAPH & TELEPHONE
US-201314411860-A,NTT ELECTRONICS CORP
US-201314414736-A,GREYSTONE TECHNOLOGIES PTY LTD
US-201314414736-A,MAREL AS
US-201314422722-A,SKF AB
US-201414426377-A,SHENZHEN CHINA STAR OPTOELECT
US-201314426935-A,KANGTANSANUP CO LTD
US-201314433372-A,XSYNCHRO INC
US-201414457074-A,KHACHATURIAN MARK
US-201414457074-A,SMITH MICHAEL G
US-201414457074-A,ARC DEVICES LTD
US-201414486211-A,XEROX CORP
US-201414506479-A,BANK OF AMERICA
US-201414506965-A,DUCK PLEIGHTS LLC
US-201414525026-A,BLACKER RACHEL KATHRYN
US-201414526030-A,HOFFMANN LA ROCHE
US-201414551874-A,TAIWAN SEMICONDUCTOR MFG
US-201414557169-A,GEN ELECTRIC
US-201414557777-A,BROADCOM CORP
US-201414567958-A,TENCENT TECH SHENZHEN CO LTD
US-201414578748-A,HELIOFOCUS LTD
US-201514589442-A,ARUN SOBTI & ASSOCIATES LLC
US-201514603918-A,SEIKO EPSON CORP
US-201514620997-A,WRIGHT DENNIS L
US-201514620997-A,ANDERSON AMY C
US-201514620997-A,SORMUNEN GRANT
US-201514638874-A,FUTUREWEI TECHNOLOGIES INC
US-201314649343-A,CHINA NAT OFFSHORE OIL CORP
US-201314649343-A,CHINA OILFIELD SERVICES LTD
US-201514667729-A,HALLA VISTEON CLIMATE CONTROL
US-201514669279-A,COMMISSARIAT ENERGIE ATOMIQUE
US-201514669279-A,ALTIS SEMICONDUCTOR SNC
US-201514670950-A,UNITED TECHNOLOGIES CORP
Query:
SELECT t."application_number",
       TO_DATE(TO_VARCHAR(t."filing_date")) AS "filing_date_formatted",
       YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 100
Answer:
application_number,filing_date_formatted,filing_year
CR-5634-A,1970-08-20,1970
CR-5990-A,1970-08-20,1970
FI-429D-A,1970-01-01,1970
HK-6083-A,1970-08-18,1970
HU-7590-A,1970-08-19,1970
JP-4890-A,1970-08-19,1970
JP-6286-A,1970-08-18,1970
US-416D-A,1970-01-01,1970
US-9948-A,1970-08-14,1970
AT-41580-A,1970-08-18,1970
AT-47682-A,1970-08-18,1970
AT-63682-A,1970-08-18,1970
CA-72337-A,1970-08-17,1970
CA-75688-A,1970-08-17,1970
CA-81627-A,1970-08-17,1970
CA-9086D-A,1970-01-01,1970
CH-3256D-A,1970-08-07,1970
CH-32972-A,1970-08-16,1970
CH-59566-A,1970-08-16,1970
CH-8494D-A,1970-08-08,1970
CH-9587D-A,1970-08-08,1970
CH-9968D-A,1970-08-08,1970
DD-8297D-A,1970-01-01,1970
FR-19873-A,1970-08-16,1970
FR-20966-A,1970-08-16,1970
FR-56170-A,1970-08-16,1970
FR-60658-A,1970-08-16,1970
FR-68041-A,1970-08-16,1970
FR-70755-A,1970-08-16,1970
FR-84394-A,1970-08-16,1970
GB-15660-A,1970-08-15,1970
GB-50958-A,1970-08-15,1970
GB-54729-A,1970-08-12,1970
GB-93140-A,1970-08-13,1970
HK-39487-A,1970-08-18,1970
HK-52284-A,1970-08-18,1970
HK-55992-A,1970-08-19,1970
HK-60178-A,1970-08-17,1970
HK-82486-A,1970-08-18,1970
HU-62391-A,1970-08-19,1970
JP-42386-A,1970-08-18,1970
JP-67093-A,1970-08-19,1970
MA-42286-A,1970-08-22,1970
OA-58112-A,1970-08-18,1970
OA-58887-A,1970-08-18,1970
PH-14999-A,1970-08-17,1970
PH-21568-A,1970-08-17,1970
PH-27280-A,1970-08-18,1970
PH-36517-A,1970-08-19,1970
TR-25990-A,1970-08-19,1970
US-4613D-A,1970-01-01,1970
US-59779-A,1970-08-18,1970
US-6310D-A,1970-01-01,1970
US-8947D-A,1970-01-01,1970
YU-24971-A,1970-08-17,1970
YU-51397-A,1970-08-20,1970
YU-53588-A,1970-08-19,1970
YU-94082-A,1970-08-18,1970
AT-134275-A,1970-08-17,1970
AT-160683-A,1970-08-18,1970
AT-168281-A,1970-08-18,1970
AT-179178-A,1970-08-17,1970
AT-196182-A,1970-08-18,1970
AT-202882-A,1970-08-18,1970
AT-205780-A,1970-08-18,1970
AT-245590-A,1970-08-19,1970
AT-250686-A,1970-08-18,1970
AT-269985-A,1970-08-18,1970
AT-272073-A,1970-08-17,1970
AT-312885-A,1970-08-18,1970
AT-404675-A,1970-08-17,1970
AT-482077-A,1970-08-17,1970
AT-519575-A,1970-08-17,1970
AT-710279-A,1970-08-18,1970
AT-735378-A,1970-08-17,1970
AT-876472-A,1970-08-17,1970
AT-906278-A,1970-08-17,1970
BE-135378-A,1970-08-17,1970
BE-137212-A,1970-08-17,1970
BE-142905-A,1970-08-17,1970
BE-151562-A,1970-08-17,1970
BE-153592-A,1970-08-17,1970
BE-160369-A,1970-08-17,1970
BE-163314-A,1970-08-17,1970
BE-163757-A,1970-08-17,1970
BE-165719-A,1970-08-17,1970
BE-172709-A,1970-08-17,1970
BE-176081-A,1970-08-17,1970
BE-176682-A,1970-08-17,1970
BE-179841-A,1970-08-17,1970
BE-182921-A,1970-08-17,1970
BE-187407-A,1970-08-17,1970
BE-188538-A,1970-08-17,1970
BE-189232-A,1970-08-17,1970
BE-189327-A,1970-08-17,1970
BE-191250-A,1970-08-17,1970
BE-192832-A,1970-08-18,1970
BE-196360-A,1970-08-18,1970
BE-202146-A,1970-08-18,1970
BE-509322-A,1970-08-14,1970
Query:
SELECT t."application_number",
       a.value:"name"::STRING AS "assignee_name",
       YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value:"code"::STRING LIKE 'A01B3%'
LIMIT 100
Answer:
application_number,assignee_name,filing_year
US-41054454-A,TRECKER FRANCIS J,1970
GB-585551-A,ARTHUR BROOKS SPURR,1970
IL-26862419-A,AGSOILWORKS TECH COMPANY LLC,1970
IL-26862419-A,AGSOILWORKS TECH COMPANY LLC,1970
KR-19970019112-U,CHO SUNG GU,1970
US-50994255-A,JIM ALEX SMITH,1970
US-50994255-A,JIM ALEX SMITH,1970
US-52103631-A,GLASIER HAROLD H,1970
US-52103631-A,GLASIER HAROLD H,1970
US-20046750-A,SHEPPARD RICHARD H,1970
US-20046750-A,SHEPPARD RICHARD H,1970
US-201916456505-A,LG ELECTRONICS INC,1970
US-1912673206-A,SOUTHERN PLOW COMPANY,1970
US-51933174-A,CARLUCCI JAMES J,1970
US-51933174-A,CARLUCCI JAMES J,1970
US-51933174-A,CARLUCCI JAMES J,1970
US-51933174-A,CARLUCCI JAMES J,1970
US-964648-A,AUGUST SETTERGREN OTTO GORAN,1970
US-964648-A,BOTVID SETTERGREN ANDERS GOSTA,1970
US-964648-A,AUGUST SETTERGREN OTTO GORAN,1970
US-964648-A,BOTVID SETTERGREN ANDERS GOSTA,1970
US-5637735-A,CAMPBELL CLARENCE L,1970
US-5637735-A,CAMPBELL CLARENCE L,1970
AU-7115874-A,NEW ZEALAND INVENTIONS DEV,1970
GB-1095134-A,WILLIAM HENRY HONY FROST,1970
GB-1095134-A,WILLIAM HENRY HONY FROST,1970
US-77445391-A,HARRELL DANNY H,1970
US-77445391-A,HARRELL DANNY H,1970
US-71336434-A,CHOATE STOREY NORMAN,1970
US-71336434-A,RUDOLPH HASSON PAUL,1970
US-71336434-A,CHOATE STOREY NORMAN,1970
US-71336434-A,RUDOLPH HASSON PAUL,1970
CN-201580056876-A,AMAZONEN-WERKE H DREYER GMBH & CO KG,1970
CN-201580056876-A,BETEK GMBH & CO KG,1970
CN-201580056876-A,AMAZONEN-WERKE H DREYER GMBH & CO KG,1970
CN-201580056876-A,BETEK GMBH & CO KG,1970
CN-201580056876-A,AMAZONEN-WERKE H DREYER GMBH & CO KG,1970
CN-201580056876-A,BETEK GMBH & CO KG,1970
US-68923896-A,QUINSTAR CORP,1970
US-68923896-A,QUINSTAR CORP,1970
KR-20120005914-A,BULLS CO LTD,1970
KR-20150076822-A,LIM HEON HO,1970
US-202217990129-A,CNH IND AMERICA LLC,1970
US-202217990129-A,CNH IND AMERICA LLC,1970
US-202217990129-A,CNH IND AMERICA LLC,1970
KR-20000035371-A,KIM JAE KEUN,1970
US-9826126-A,WILLIAM DREFKE,1970
US-9826126-A,WILLIAM DREFKE,1970
US-5528360-A,SIGFRID ANDERSON ANDERS,1970
US-5528360-A,SIGFRID ANDERSON ANDERS,1970
FR-508965D-A,EDMOND HEE,1970
FR-508965D-A,EDMOND HEE,1970
KR-20000009753-U,DAEHO FARMING MACHINERY CO LTD,1970
KR-20000011273-A,KUBOTA KK,1970
CN-201510892651-A,CHONGQING TIANJI IND CO LTD,1970
CN-201510892651-A,CHONGQING TIANJI IND CO LTD,1970
PL-44042622-A,OTULAK PRZEMYSLAW PRO CNC,1970
PL-44042622-A,OTULAK PRZEMYSLAW PRO CNC,1970
PL-44042622-A,OTULAK PRZEMYSLAW PRO CNC,1970
PL-44042622-A,OTULAK PRZEMYSLAW PRO CNC,1970
GB-202013028-A,ARWAC LTD,1970
GB-202013028-A,ARWAC LTD,1970
GB-202013028-A,ARWAC LTD,1970
CN-201810758930-A,HUBEI SHUANGYU MACHINERY TECH CO LTD,1970
CN-201810758930-A,HUBEI SHUANGYU MACHINERY TECH CO LTD,1970
FR-7531218-A,TEXAS INDUSTRIES INC,1970
FR-7531218-A,TEXAS INDUSTRIES INC,1970
FR-7531218-A,TEXAS INDUSTRIES INC,1970
FR-7531218-A,TEXAS INDUSTRIES INC,1970
FR-7531218-A,TEXAS INDUSTRIES INC,1970
FR-7531218-A,TEXAS INDUSTRIES INC,1970
FR-0901549-A,GERBER HUBERT,1970
FR-0901549-A,GERBER MAURICE,1970
CN-202210625064-A,WANG XUEDONG,1970
CN-202210625064-A,WANG XUEDONG,1970
US-1913771943-A,SALGE HENRY F,1970
KR-20060032729-A,SAMSUNG SDI CO LTD,1970
KR-20060032729-A,SAMSUNG SDI CO LTD,1970
KR-20010007666-A,KIM JONG JIN,1970
CN-201710322359-A,CHONGQING YUBAO AGRICULTURE EXPL CO LTD,1970
CN-201710322359-A,CHONGQING YUBAO AGRICULTURE EXPL CO LTD,1970
CA-2543900-A,EDWARDS JOHN W,1970
CA-2543900-A,EDWARDS JOHN W,1970
CA-163445-A,GUERBET FRANCOIS,1970
BE-9300543-A,LEIJENAAR SYTZE,1970
BE-9300543-A,LEIJENAAR SYTZE,1970
US-72598847-A,WALTER ROWAN JAMES,1970
US-72598847-A,WALTER ROWAN JAMES,1970
US-72598847-A,WALTER ROWAN JAMES,1970
US-72598847-A,WALTER ROWAN JAMES,1970
CN-201710636376-A,UNIV TONGJI,1970
CN-201710636376-A,UNIV TONGJI,1970
CN-202111095366-A,ZHANG LIJIN,1970
CN-202111095366-A,ZHANG LIJIN,1970
BE-192096-A,PATENT CONCERN NV,1970
BE-192096-A,PATENT CONCERN NV,1970
BE-192096-A,PATENT CONCERN NV,1970
CN-202210179147-A,GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1970
CN-202210179147-A,GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1970
CN-202210179147-A,GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1970
Query:
SELECT a.value:"name"::STRING AS "assignee_name",
       COUNT(DISTINCT t."application_number") AS "total_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value:"code"::STRING LIKE 'A01B3%'
GROUP BY a.value:"name"::STRING
ORDER BY "total_applications" DESC
LIMIT 100
Answer:
assignee_name,total_applications
LELY NV C VAN DER,5
DEERE & CO,4
AMAZONEN WERKE DREYER H,2
KIM JAE KEUN,1
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1
KUBOTA KK,1
KUHN SA,1
FISHER VAN E,1
PREC PLANTING LLC,1
LEMKEN GMBH & CO KG,1
TRECKER FRANCIS J,1
ELEOS ROBOTICS INC,1
GERBER HUBERT,1
HUBEI SHUANGYU MACHINERY TECH CO LTD,1
INT HARVESTER GREAT BRITAIN,1
TWOSE OF TIVERTON LTD,1
BULLS CO LTD,1
DAEHO FARMING MACHINERY CO LTD,1
QUINSTAR CORP,1
NEW ZEALAND INVENTIONS DEV,1
LG ELECTRONICS INC,1
AMAZONEN-WERKE H DREYER GMBH & CO KG,1
KIM BYUNG SUB,1
WILLIAM HENRY HONY FROST,1
MARTIN DOMINIC R,1
SOUTHERN PLOW COMPANY,1
NIEMEYER SOEHNE STAHL PFLUG,1
GEORGE A KELLY PLOW COMPANY,1
RUDOLPH HASSON PAUL,1
WANG XUEDONG,1
MARTIN CHARLES H,1
GUERBET FRANCOIS,1
CHOATE STOREY NORMAN,1
ARTHUR BROOKS SPURR,1
CAMPBELL CLARENCE L,1
KORSMEYER ERNEST H,1
LEINFELDER DIPL-LANDW HERMANN,1
UNIV HEILONGJIANG SCI & TECH,1
HUBER FRANZ FERDINAND,1
RICHARD CO,1
LIM HEON HO,1
HOLGER LETH,1
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,1
MCKAY RALPH LTD,1
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,1
CHRISTEN ARNE JENSEN,1
CHO SUNG GU,1
GLASIER HAROLD H,1
GERBER MAURICE,1
EMPR IMPORT EXPORT Y DISTRIB P,1
CARLUCCI JAMES J,1
ZHANG LIJIN,1
WILLIAM DREFKE,1
SIGFRID ANDERSON ANDERS,1
TEXAS INDUSTRIES INC,1
SJOEHOLMS MEKANISKA AB,1
CHRISTOPHER H R WOODWARD,1
WALTER ROWAN JAMES,1
UNIV CHUNG ANG IND,1
HARRELL DANNY H,1
AUGUST SETTERGREN OTTO GORAN,1
SHEPPARD RICHARD H,1
ALLEN SAMUEL L,1
AGSOILWORKS TECH COMPANY LLC,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,1
CHONGQING TIANJI IND CO LTD,1
DAIYO TANGO CO LTD,1
SAMSUNG KWANGJU ELECTRONICS CO,1
EDMOND HEE,1
UNIV JIANGSU,1
UNIV TONGJI,1
PATENT CONCERN NV,1
OTULAK PRZEMYSLAW PRO CNC,1
KIM JONG JIN,1
SALGE HENRY F,1
SAPHIR MASCHB GMBH,1
Liu Yueshang,1
LEIJENAAR SYTZE,1
CNH IND AMERICA LLC,1
UNIV SYDNEY,1
BETEK GMBH & CO KG,1
EDWARDS JOHN W,1
ARWAC LTD,1
WALLNER KLAUS,1
SAMSUNG SDI CO LTD,1
JIM ALEX SMITH,1
BOTVID SETTERGREN ANDERS GOSTA,1
Query:
SELECT a.value:"name"::STRING AS "assignee_name",
       YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) AS "filing_year",
       COUNT(DISTINCT t."application_number") AS "applications_in_year"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value:"code"::STRING LIKE 'A01B3%'
GROUP BY a.value:"name"::STRING, "filing_year"
ORDER BY a.value:"name"::STRING, "applications_in_year" DESC
LIMIT 100
Answer:
assignee_name,filing_year,applications_in_year
AGSOILWORKS TECH COMPANY LLC,1970,1
ALLEN SAMUEL L,1970,1
AMAZONEN WERKE DREYER H,1970,2
AMAZONEN-WERKE H DREYER GMBH & CO KG,1970,1
ARTHUR BROOKS SPURR,1970,1
ARWAC LTD,1970,1
AUGUST SETTERGREN OTTO GORAN,1970,1
BETEK GMBH & CO KG,1970,1
BOTVID SETTERGREN ANDERS GOSTA,1970,1
BULLS CO LTD,1970,1
CAMPBELL CLARENCE L,1970,1
CARLUCCI JAMES J,1970,1
CHO SUNG GU,1970,1
CHOATE STOREY NORMAN,1970,1
CHONGQING TIANJI IND CO LTD,1970,1
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,1970,1
CHRISTEN ARNE JENSEN,1970,1
CHRISTOPHER H R WOODWARD,1970,1
CNH IND AMERICA LLC,1970,1
DAEHO FARMING MACHINERY CO LTD,1970,1
DAIYO TANGO CO LTD,1970,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,1970,1
DEERE & CO,1970,4
EDMOND HEE,1970,1
EDWARDS JOHN W,1970,1
ELEOS ROBOTICS INC,1970,1
EMPR IMPORT EXPORT Y DISTRIB P,1970,1
FISHER VAN E,1970,1
GEORGE A KELLY PLOW COMPANY,1970,1
GERBER HUBERT,1970,1
GERBER MAURICE,1970,1
GLASIER HAROLD H,1970,1
GUERBET FRANCOIS,1970,1
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1970,1
HARRELL DANNY H,1970,1
HOLGER LETH,1970,1
HUBEI SHUANGYU MACHINERY TECH CO LTD,1970,1
HUBER FRANZ FERDINAND,1970,1
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,1970,1
INT HARVESTER GREAT BRITAIN,1970,1
JIM ALEX SMITH,1970,1
KIM BYUNG SUB,1970,1
KIM JAE KEUN,1970,1
KIM JONG JIN,1970,1
KORSMEYER ERNEST H,1970,1
KUBOTA KK,1970,1
KUHN SA,1970,1
LEIJENAAR SYTZE,1970,1
LEINFELDER DIPL-LANDW HERMANN,1970,1
LELY NV C VAN DER,1970,5
LEMKEN GMBH & CO KG,1970,1
LG ELECTRONICS INC,1970,1
LIM HEON HO,1970,1
Liu Yueshang,1970,1
MARTIN CHARLES H,1970,1
MARTIN DOMINIC R,1970,1
MCKAY RALPH LTD,1970,1
NEW ZEALAND INVENTIONS DEV,1970,1
NIEMEYER SOEHNE STAHL PFLUG,1970,1
OTULAK PRZEMYSLAW PRO CNC,1970,1
PATENT CONCERN NV,1970,1
PREC PLANTING LLC,1970,1
QUINSTAR CORP,1970,1
RICHARD CO,1970,1
RUDOLPH HASSON PAUL,1970,1
SALGE HENRY F,1970,1
SAMSUNG KWANGJU ELECTRONICS CO,1970,1
SAMSUNG SDI CO LTD,1970,1
SAPHIR MASCHB GMBH,1970,1
SHEPPARD RICHARD H,1970,1
SIGFRID ANDERSON ANDERS,1970,1
SJOEHOLMS MEKANISKA AB,1970,1
SOUTHERN PLOW COMPANY,1970,1
TEXAS INDUSTRIES INC,1970,1
TRECKER FRANCIS J,1970,1
TWOSE OF TIVERTON LTD,1970,1
UNIV CHUNG ANG IND,1970,1
UNIV HEILONGJIANG SCI & TECH,1970,1
UNIV JIANGSU,1970,1
UNIV SYDNEY,1970,1
UNIV TONGJI,1970,1
WALLNER KLAUS,1970,1
WALTER ROWAN JAMES,1970,1
WANG XUEDONG,1970,1
WILLIAM DREFKE,1970,1
WILLIAM HENRY HONY FROST,1970,1
ZHANG LIJIN,1970,1
Query:
SELECT a.value:"name"::STRING AS "assignee_name",
       YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) AS "filing_year",
       t."country_code",
       COUNT(DISTINCT t."application_number") AS "applications_in_country"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value:"code"::STRING LIKE 'A01B3%'
GROUP BY a.value:"name"::STRING, "filing_year", t."country_code"
ORDER BY a.value:"name"::STRING, "filing_year", "applications_in_country" DESC
LIMIT 100
Answer:
assignee_name,filing_year,country_code,applications_in_country
AGSOILWORKS TECH COMPANY LLC,1970,IL,1
ALLEN SAMUEL L,1970,US,1
AMAZONEN WERKE DREYER H,1970,AT,1
AMAZONEN WERKE DREYER H,1970,GB,1
AMAZONEN-WERKE H DREYER GMBH & CO KG,1970,CN,1
ARTHUR BROOKS SPURR,1970,GB,1
ARWAC LTD,1970,GB,1
AUGUST SETTERGREN OTTO GORAN,1970,US,1
BETEK GMBH & CO KG,1970,CN,1
BOTVID SETTERGREN ANDERS GOSTA,1970,US,1
BULLS CO LTD,1970,KR,1
CAMPBELL CLARENCE L,1970,US,1
CARLUCCI JAMES J,1970,US,1
CHO SUNG GU,1970,KR,1
CHOATE STOREY NORMAN,1970,US,1
CHONGQING TIANJI IND CO LTD,1970,CN,1
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,1970,CN,1
CHRISTEN ARNE JENSEN,1970,DE,1
CHRISTOPHER H R WOODWARD,1970,US,1
CNH IND AMERICA LLC,1970,US,1
DAEHO FARMING MACHINERY CO LTD,1970,KR,1
DAIYO TANGO CO LTD,1970,KR,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,1970,CN,1
DEERE & CO,1970,NL,1
DEERE & CO,1970,EP,1
DEERE & CO,1970,CA,1
DEERE & CO,1970,AU,1
EDMOND HEE,1970,FR,1
EDWARDS JOHN W,1970,CA,1
ELEOS ROBOTICS INC,1970,CA,1
EMPR IMPORT EXPORT Y DISTRIB P,1970,NO,1
FISHER VAN E,1970,US,1
GEORGE A KELLY PLOW COMPANY,1970,US,1
GERBER HUBERT,1970,FR,1
GERBER MAURICE,1970,FR,1
GLASIER HAROLD H,1970,US,1
GUERBET FRANCOIS,1970,CA,1
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1970,CN,1
HARRELL DANNY H,1970,US,1
HOLGER LETH,1970,DE,1
HUBEI SHUANGYU MACHINERY TECH CO LTD,1970,CN,1
HUBER FRANZ FERDINAND,1970,DE,1
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,1970,CN,1
INT HARVESTER GREAT BRITAIN,1970,GB,1
JIM ALEX SMITH,1970,US,1
KIM BYUNG SUB,1970,KR,1
KIM JAE KEUN,1970,KR,1
KIM JONG JIN,1970,KR,1
KORSMEYER ERNEST H,1970,US,1
KUBOTA KK,1970,KR,1
KUHN SA,1970,CA,1
LEIJENAAR SYTZE,1970,BE,1
LEINFELDER DIPL-LANDW HERMANN,1970,DE,1
LELY NV C VAN DER,1970,IT,3
LELY NV C VAN DER,1970,GB,1
LELY NV C VAN DER,1970,NL,1
LEMKEN GMBH & CO KG,1970,DE,1
LG ELECTRONICS INC,1970,US,1
LIM HEON HO,1970,KR,1
Liu Yueshang,1970,CN,1
MARTIN CHARLES H,1970,US,1
MARTIN DOMINIC R,1970,US,1
MCKAY RALPH LTD,1970,ZA,1
NEW ZEALAND INVENTIONS DEV,1970,AU,1
NIEMEYER SOEHNE STAHL PFLUG,1970,DE,1
OTULAK PRZEMYSLAW PRO CNC,1970,PL,1
PATENT CONCERN NV,1970,BE,1
PREC PLANTING LLC,1970,CN,1
QUINSTAR CORP,1970,US,1
RICHARD CO,1970,US,1
RUDOLPH HASSON PAUL,1970,US,1
SALGE HENRY F,1970,US,1
SAMSUNG KWANGJU ELECTRONICS CO,1970,CN,1
SAMSUNG SDI CO LTD,1970,KR,1
SAPHIR MASCHB GMBH,1970,EP,1
SHEPPARD RICHARD H,1970,US,1
SIGFRID ANDERSON ANDERS,1970,US,1
SJOEHOLMS MEKANISKA AB,1970,NO,1
SOUTHERN PLOW COMPANY,1970,US,1
TEXAS INDUSTRIES INC,1970,FR,1
TRECKER FRANCIS J,1970,US,1
TWOSE OF TIVERTON LTD,1970,GB,1
UNIV CHUNG ANG IND,1970,KR,1
UNIV HEILONGJIANG SCI & TECH,1970,CN,1
UNIV JIANGSU,1970,CN,1
UNIV SYDNEY,1970,AU,1
UNIV TONGJI,1970,CN,1
WALLNER KLAUS,1970,HU,1
WALTER ROWAN JAMES,1970,US,1
WANG XUEDONG,1970,CN,1
WILLIAM DREFKE,1970,US,1
WILLIAM HENRY HONY FROST,1970,GB,1
ZHANG LIJIN,1970,CN,1
Query:
SELECT
    main."assignee_name",
    main."total_applications",
    main."top_year",
    main."applications_in_top_year",
    country_stats."top_country_code"
FROM
(
    SELECT
        assignee_stats."assignee_name",
        assignee_stats."total_applications",
        yearly_stats."filing_year" AS "top_year",
        yearly_stats."applications_in_year" AS "applications_in_top_year"
    FROM
    (
        SELECT a.value:"name"::STRING AS "assignee_name",
               COUNT(DISTINCT t."application_number") AS "total_applications"
        FROM PATENTS.PATENTS.PUBLICATIONS t,
             LATERAL FLATTEN(input => t."cpc") c,
             LATERAL FLATTEN(input => t."assignee_harmonized") a
        WHERE c.value:"code"::STRING LIKE 'A01B3%'
        GROUP BY a.value:"name"::STRING
    ) assignee_stats
    JOIN
    (
        SELECT a.value:"name"::STRING AS "assignee_name",
               YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) AS "filing_year",
               COUNT(DISTINCT t."application_number") AS "applications_in_year"
        FROM PATENTS.PATENTS.PUBLICATIONS t,
             LATERAL FLATTEN(input => t."cpc") c,
             LATERAL FLATTEN(input => t."assignee_harmonized") a
        WHERE c.value:"code"::STRING LIKE 'A01B3%'
        GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(TO_VARCHAR(t."filing_date")))
    ) yearly_stats
    ON assignee_stats."assignee_name" = yearly_stats."assignee_name"
    QUALIFY ROW_NUMBER() OVER (PARTITION BY assignee_stats."assignee_name"
                               ORDER BY yearly_stats."applications_in_year" DESC) = 1
) main
JOIN
(
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) AS "filing_year",
        t."country_code" AS "top_country_code",
        COUNT(DISTINCT t."application_number") AS "applications_in_country"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."cpc") c,
         LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))), t."country_code"
    QUALIFY ROW_NUMBER() OVER (PARTITION BY a.value:"name"::STRING, YEAR(TO_DATE(TO_VARCHAR(t."filing_date")))
                               ORDER BY COUNT(DISTINCT t."application_number") DESC) = 1
) country_stats
ON main."assignee_name" = country_stats."assignee_name" AND main."top_year" = country_stats."filing_year"
ORDER BY main."total_applications" DESC
LIMIT 100
Answer:
assignee_name,total_applications,top_year,applications_in_top_year,top_country_code
LELY NV C VAN DER,5,1970,5,IT
DEERE & CO,4,1970,4,NL
AMAZONEN WERKE DREYER H,2,1970,2,GB
SIGFRID ANDERSON ANDERS,1,1970,1,US
DAIYO TANGO CO LTD,1,1970,1,KR
BOTVID SETTERGREN ANDERS GOSTA,1,1970,1,US
EMPR IMPORT EXPORT Y DISTRIB P,1,1970,1,NO
UNIV SYDNEY,1,1970,1,AU
GERBER HUBERT,1,1970,1,FR
PATENT CONCERN NV,1,1970,1,BE
HOLGER LETH,1,1970,1,DE
MCKAY RALPH LTD,1,1970,1,ZA
KIM JONG JIN,1,1970,1,KR
NEW ZEALAND INVENTIONS DEV,1,1970,1,AU
KUBOTA KK,1,1970,1,KR
GEORGE A KELLY PLOW COMPANY,1,1970,1,US
ARWAC LTD,1,1970,1,GB
GUERBET FRANCOIS,1,1970,1,CA
TRECKER FRANCIS J,1,1970,1,US
KIM BYUNG SUB,1,1970,1,KR
ARTHUR BROOKS SPURR,1,1970,1,GB
KUHN SA,1,1970,1,CA
SHEPPARD RICHARD H,1,1970,1,US
HUBEI SHUANGYU MACHINERY TECH CO LTD,1,1970,1,CN
LG ELECTRONICS INC,1,1970,1,US
HUBER FRANZ FERDINAND,1,1970,1,DE
CHRISTEN ARNE JENSEN,1,1970,1,DE
LEINFELDER DIPL-LANDW HERMANN,1,1970,1,DE
CHOATE STOREY NORMAN,1,1970,1,US
CHO SUNG GU,1,1970,1,KR
PREC PLANTING LLC,1,1970,1,CN
UNIV TONGJI,1,1970,1,CN
SALGE HENRY F,1,1970,1,US
TWOSE OF TIVERTON LTD,1,1970,1,GB
KIM JAE KEUN,1,1970,1,KR
WALLNER KLAUS,1,1970,1,HU
MARTIN CHARLES H,1,1970,1,US
AMAZONEN-WERKE H DREYER GMBH & CO KG,1,1970,1,CN
HARRELL DANNY H,1,1970,1,US
JIM ALEX SMITH,1,1970,1,US
CHRISTOPHER H R WOODWARD,1,1970,1,US
INT HARVESTER GREAT BRITAIN,1,1970,1,GB
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,1,1970,1,CN
WALTER ROWAN JAMES,1,1970,1,US
CHONGQING TIANJI IND CO LTD,1,1970,1,CN
KORSMEYER ERNEST H,1,1970,1,US
LIM HEON HO,1,1970,1,KR
CAMPBELL CLARENCE L,1,1970,1,US
WILLIAM DREFKE,1,1970,1,US
LEIJENAAR SYTZE,1,1970,1,BE
EDWARDS JOHN W,1,1970,1,CA
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,1,1970,1,CN
MARTIN DOMINIC R,1,1970,1,US
ELEOS ROBOTICS INC,1,1970,1,CA
SAPHIR MASCHB GMBH,1,1970,1,EP
UNIV CHUNG ANG IND,1,1970,1,KR
SAMSUNG SDI CO LTD,1,1970,1,KR
WILLIAM HENRY HONY FROST,1,1970,1,GB
SJOEHOLMS MEKANISKA AB,1,1970,1,NO
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1,1970,1,CN
EDMOND HEE,1,1970,1,FR
RUDOLPH HASSON PAUL,1,1970,1,US
SAMSUNG KWANGJU ELECTRONICS CO,1,1970,1,CN
UNIV HEILONGJIANG SCI & TECH,1,1970,1,CN
QUINSTAR CORP,1,1970,1,US
OTULAK PRZEMYSLAW PRO CNC,1,1970,1,PL
ALLEN SAMUEL L,1,1970,1,US
Liu Yueshang,1,1970,1,CN
WANG XUEDONG,1,1970,1,CN
CNH IND AMERICA LLC,1,1970,1,US
AGSOILWORKS TECH COMPANY LLC,1,1970,1,IL
GLASIER HAROLD H,1,1970,1,US
CARLUCCI JAMES J,1,1970,1,US
BETEK GMBH & CO KG,1,1970,1,CN
SOUTHERN PLOW COMPANY,1,1970,1,US
FISHER VAN E,1,1970,1,US
GERBER MAURICE,1,1970,1,FR
BULLS CO LTD,1,1970,1,KR
TEXAS INDUSTRIES INC,1,1970,1,FR
AUGUST SETTERGREN OTTO GORAN,1,1970,1,US
ZHANG LIJIN,1,1970,1,CN
DAEHO FARMING MACHINERY CO LTD,1,1970,1,KR
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,1,1970,1,CN
LEMKEN GMBH & CO KG,1,1970,1,DE
UNIV JIANGSU,1,1970,1,CN
NIEMEYER SOEHNE STAHL PFLUG,1,1970,1,DE
RICHARD CO,1,1970,1,US
End Exploring Related Columns
Task: For patent class A01B3, I want to analyze the information of the top 3 assignees based on the total number of applications. Please provide the following five pieces of information: the name of this assignee,  total number of applications, the year with the most applications, the number of applications in that year, and the country code with the most applications during that year.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Assignee_Name,Total_Applications,Year_With_Most_Applications,Applications_In_That_Year,Country_Code_With_Most_Applications
assignee1:str,total_applications1:int,year1:int,applications_in_that_year1:int,country_code1:str
assignee2:str,total_applications2:int,year2:int,applications_in_that_year2:int,country_code2:str
assignee3:str,total_applications3:int,year3:int,applications_in_that_year3:int,country_code3:str
```

The table above lists the top 3 assignees for patent class A01B3 based on the total number of applications. For each assignee, it shows their name, the total number of applications they have filed, the year in which they had the most applications, the number of applications in that year, and the country code with the most applications during that year..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-20 21:57:46 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 21:57:46 - root - INFO - ```sql
WITH AssigneeApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        COUNT(DISTINCT t."application_number") AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING
),
TopAssignees AS (
    SELECT
        "assignee_name",
        "total_applications",
        ROW_NUMBER() OVER (ORDER BY "total_applications" DESC) AS rn
    FROM AssigneeApps
    WHERE "assignee_name" IS NOT NULL
),
AssigneeTopYear AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) AS "Year_With_Most_Applications",
        COUNT(DISTINCT t."application_number") AS "Applications_In_That_Year",
        ROW_NUMBER() OVER (PARTITION BY a.value:"name"::STRING ORDER BY COUNT(DISTINCT t."application_number") DESC) AS rn
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(TO_VARCHAR(t."filing_date")))
    HAVING rn = 1
),
AssigneeTopCountry AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) AS "Year_With_Most_Applications",
        t."country_code" AS "Country_Code_With_Most_Applications",
        COUNT(DISTINCT t."application_number") AS "Applications_In_Country",
        ROW_NUMBER() OVER (PARTITION BY a.value:"name"::STRING, YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) ORDER BY COUNT(DISTINCT t."application_number") DESC) AS rn
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))), t."country_code"
    HAVING rn = 1
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Applications",
    aty."Year_With_Most_Applications",
    aty."Applications_In_That_Year",
    atc."Country_Code_With_Most_Applications"
FROM TopAssignees ta
JOIN AssigneeTopYear aty ON ta."assignee_name" = aty."assignee_name"
JOIN AssigneeTopCountry atc ON ta."assignee_name" = atc."assignee_name" AND aty."Year_With_Most_Applications" = atc."Year_With_Most_Applications"
WHERE ta.rn <= 3
ORDER BY ta."Total_Applications" DESC;
```
2025-01-20 21:57:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:57:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:57:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:57:48 - snowflake.connector.connection - INFO - closed
2025-01-20 21:57:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:57:48 - root - INFO - itercount: 1
2025-01-20 21:57:48 - root - INFO - 000904 (42000): 01b9d8a5-0004-7ed2-0001-11c300f2cfa6: SQL compilation error: error line 56 at position 9
invalid identifier 'TA."Total_Applications"'
2025-01-20 21:57:48 - root - INFO - Input sql:
WITH AssigneeApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        COUNT(DISTINCT t."application_number") AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING
),
TopAssignees AS (
    SELECT
        "assignee_name",
        "total_applications",
        ROW_NUMBER() OVER (ORDER BY "total_applications" DESC) AS rn
    FROM AssigneeApps
    WHERE "assignee_name" IS NOT NULL
),
AssigneeTopYear AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) AS "Year_With_Most_Applications",
        COUNT(DISTINCT t."application_number") AS "Applications_In_That_Year",
        ROW_NUMBER() OVER (PARTITION BY a.value:"name"::STRING ORDER BY COUNT(DISTINCT t."application_number") DESC) AS rn
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(TO_VARCHAR(t."filing_date")))
    HAVING rn = 1
),
AssigneeTopCountry AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) AS "Year_With_Most_Applications",
        t."country_code" AS "Country_Code_With_Most_Applications",
        COUNT(DISTINCT t."application_number") AS "Applications_In_Country",
        ROW_NUMBER() OVER (PARTITION BY a.value:"name"::STRING, YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) ORDER BY COUNT(DISTINCT t."application_number") DESC) AS rn
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))), t."country_code"
    HAVING rn = 1
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Applications",
    aty."Year_With_Most_Applications",
    aty."Applications_In_That_Year",
    atc."Country_Code_With_Most_Applications"
FROM TopAssignees ta
JOIN AssigneeTopYear aty ON ta."assignee_name" = aty."assignee_name"
JOIN AssigneeTopCountry atc ON ta."assignee_name" = atc."assignee_name" AND aty."Year_With_Most_Applications" = atc."Year_With_Most_Applications"
WHERE ta.rn <= 3
ORDER BY ta."Total_Applications" DESC;
The error information is:
000904 (42000): 01b9d8a5-0004-7ed2-0001-11c300f2cfa6: SQL compilation error: error line 56 at position 9
invalid identifier 'TA."Total_Applications"'
Please correct it and output only 1 complete SQL query.When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-20 21:58:49 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 21:58:49 - root - INFO - ```sql
WITH AssigneeApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        COUNT(DISTINCT t."application_number") AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING
),
TopAssignees AS (
    SELECT
        "assignee_name",
        "total_applications",
        ROW_NUMBER() OVER (ORDER BY "total_applications" DESC NULLS LAST) AS rn
    FROM AssigneeApps
    WHERE "assignee_name" IS NOT NULL
),
AssigneeTopYear AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) AS "Year_With_Most_Applications",
        COUNT(DISTINCT t."application_number") AS "Applications_In_That_Year",
        ROW_NUMBER() OVER (
            PARTITION BY a.value:"name"::STRING 
            ORDER BY COUNT(DISTINCT t."application_number") DESC
        ) AS rn
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(TO_VARCHAR(t."filing_date")))
    QUALIFY rn = 1
),
AssigneeTopCountry AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) AS "Year_With_Most_Applications",
        t."country_code" AS "Country_Code_With_Most_Applications",
        COUNT(DISTINCT t."application_number") AS "Applications_In_Country",
        ROW_NUMBER() OVER (
            PARTITION BY a.value:"name"::STRING, YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) 
            ORDER BY COUNT(DISTINCT t."application_number") DESC
        ) AS rn
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))), t."country_code"
    QUALIFY rn = 1
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Applications",
    aty."Year_With_Most_Applications",
    aty."Applications_In_That_Year",
    atc."Country_Code_With_Most_Applications"
FROM TopAssignees ta
JOIN AssigneeTopYear aty ON ta."assignee_name" = aty."assignee_name"
JOIN AssigneeTopCountry atc ON 
    ta."assignee_name" = atc."assignee_name" 
    AND aty."Year_With_Most_Applications" = atc."Year_With_Most_Applications"
WHERE ta.rn <= 3
ORDER BY ta."total_applications" DESC NULLS LAST;
```
2025-01-20 21:58:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:58:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:58:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:58:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-20 21:58:51 - snowflake.connector.connection - INFO - closed
2025-01-20 21:58:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:58:51 - root - INFO - itercount: 2
2025-01-20 21:58:51 - root - INFO - 0
2025-01-20 21:58:51 - root - INFO - results: 
Assignee_Name,Total_Applications,Year_With_Most_Applications,Applications_In_That_Year,Country_Code_With_Most_Applications
LELY NV C VAN DER,5,1970,5,IT
DEERE & CO,4,1970,4,CA
AMAZONEN WERKE DREYER H,2,1970,2,GB


2025-01-20 21:58:51 - root - INFO - Please check the answer again by reviewing For patent class A01B3, I want to analyze the information of the top 3 assignees based on the total number of applications. Please provide the following five pieces of information: the name of this assignee,  total number of applications, the year with the most applications, the number of applications in that year, and the country code with the most applications during that year., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Assignee_Name,Total_Applications,Year_With_Most_Applications,Applications_In_That_Year,Country_Code_With_Most_Applications
assignee1:str,total_applications1:int,year1:int,applications_in_that_year1:int,country_code1:str
assignee2:str,total_applications2:int,year2:int,applications_in_that_year2:int,country_code2:str
assignee3:str,total_applications3:int,year3:int,applications_in_that_year3:int,country_code3:str
```

The table above lists the top 3 assignees for patent class A01B3 based on the total number of applications. For each assignee, it shows their name, the total number of applications they have filed, the year in which they had the most applications, the number of applications in that year, and the country code with the most applications during that year. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Assignee_Name,Total_Applications,Year_With_Most_Applications,Applications_In_That_Year,Country_Code_With_Most_Applications
LELY NV C VAN DER,5,1970,5,IT
DEERE & CO,4,1970,4,CA
AMAZONEN WERKE DREYER H,2,1970,2,GB
Current sql:
WITH AssigneeApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        COUNT(DISTINCT t."application_number") AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING
),
TopAssignees AS (
    SELECT
        "assignee_name",
        "total_applications",
        ROW_NUMBER() OVER (ORDER BY "total_applications" DESC NULLS LAST) AS rn
    FROM AssigneeApps
    WHERE "assignee_name" IS NOT NULL
),
AssigneeTopYear AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) AS "Year_With_Most_Applications",
        COUNT(DISTINCT t."application_number") AS "Applications_In_That_Year",
        ROW_NUMBER() OVER (
            PARTITION BY a.value:"name"::STRING 
            ORDER BY COUNT(DISTINCT t."application_number") DESC
        ) AS rn
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(TO_VARCHAR(t."filing_date")))
    QUALIFY rn = 1
),
AssigneeTopCountry AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) AS "Year_With_Most_Applications",
        t."country_code" AS "Country_Code_With_Most_Applications",
        COUNT(DISTINCT t."application_number") AS "Applications_In_Country",
        ROW_NUMBER() OVER (
            PARTITION BY a.value:"name"::STRING, YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))) 
            ORDER BY COUNT(DISTINCT t."application_number") DESC
        ) AS rn
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(TO_VARCHAR(t."filing_date"))), t."country_code"
    QUALIFY rn = 1
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Applications",
    aty."Year_With_Most_Applications",
    aty."Applications_In_That_Year",
    atc."Country_Code_With_Most_Applications"
FROM TopAssignees ta
JOIN AssigneeTopYear aty ON ta."assignee_name" = aty."assignee_name"
JOIN AssigneeTopCountry atc ON 
    ta."assignee_name" = atc."assignee_name" 
    AND aty."Year_With_Most_Applications" = atc."Year_With_Most_Applications"
WHERE ta.rn <= 3
ORDER BY ta."total_applications" DESC NULLS LAST;
2025-01-20 21:59:54 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 21:59:54 - root - INFO - ```sql
WITH AssigneeApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        COUNT(DISTINCT t."application_number") AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING
),
TopAssignees AS (
    SELECT
        "assignee_name",
        "total_applications",
        ROW_NUMBER() OVER (ORDER BY "total_applications" DESC NULLS LAST) AS rn
    FROM AssigneeApps
    WHERE "assignee_name" IS NOT NULL
),
AssigneeTopYear AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')) AS "Year_With_Most_Applications",
        COUNT(DISTINCT t."application_number") AS "Applications_In_That_Year",
        ROW_NUMBER() OVER (
            PARTITION BY a.value:"name"::STRING 
            ORDER BY COUNT(DISTINCT t."application_number") DESC
        ) AS rn
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'))
    QUALIFY rn = 1
),
AssigneeTopCountry AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')) AS "Year_With_Most_Applications",
        t."country_code" AS "Country_Code_With_Most_Applications",
        COUNT(DISTINCT t."application_number") AS "Applications_In_Country",
        ROW_NUMBER() OVER (
            PARTITION BY a.value:"name"::STRING, YEAR(TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')) 
            ORDER BY COUNT(DISTINCT t."application_number") DESC
        ) AS rn
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')), t."country_code"
    QUALIFY rn = 1
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Applications",
    aty."Year_With_Most_Applications",
    aty."Applications_In_That_Year",
    atc."Country_Code_With_Most_Applications"
FROM TopAssignees ta
JOIN AssigneeTopYear aty ON ta."assignee_name" = aty."assignee_name"
JOIN AssigneeTopCountry atc ON 
    ta."assignee_name" = atc."assignee_name" 
    AND aty."Year_With_Most_Applications" = atc."Year_With_Most_Applications"
WHERE ta.rn <= 3
ORDER BY ta."total_applications" DESC NULLS LAST;
```
2025-01-20 21:59:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 21:59:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 21:59:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 21:59:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-20 21:59:56 - snowflake.connector.connection - INFO - closed
2025-01-20 21:59:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 21:59:57 - root - INFO - itercount: 3
2025-01-20 21:59:57 - root - INFO - 0
2025-01-20 21:59:57 - root - INFO - results: 
Assignee_Name,Total_Applications,Year_With_Most_Applications,Applications_In_That_Year,Country_Code_With_Most_Applications
LELY NV C VAN DER,5,1981,1,GB
DEERE & CO,4,2002,1,AU
AMAZONEN WERKE DREYER H,2,1979,2,GB


2025-01-20 21:59:57 - root - INFO - Please check the answer again by reviewing For patent class A01B3, I want to analyze the information of the top 3 assignees based on the total number of applications. Please provide the following five pieces of information: the name of this assignee,  total number of applications, the year with the most applications, the number of applications in that year, and the country code with the most applications during that year., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Assignee_Name,Total_Applications,Year_With_Most_Applications,Applications_In_That_Year,Country_Code_With_Most_Applications
assignee1:str,total_applications1:int,year1:int,applications_in_that_year1:int,country_code1:str
assignee2:str,total_applications2:int,year2:int,applications_in_that_year2:int,country_code2:str
assignee3:str,total_applications3:int,year3:int,applications_in_that_year3:int,country_code3:str
```

The table above lists the top 3 assignees for patent class A01B3 based on the total number of applications. For each assignee, it shows their name, the total number of applications they have filed, the year in which they had the most applications, the number of applications in that year, and the country code with the most applications during that year. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Assignee_Name,Total_Applications,Year_With_Most_Applications,Applications_In_That_Year,Country_Code_With_Most_Applications
LELY NV C VAN DER,5,1981,1,GB
DEERE & CO,4,2002,1,AU
AMAZONEN WERKE DREYER H,2,1979,2,GB
Current sql:
WITH AssigneeApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        COUNT(DISTINCT t."application_number") AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING
),
TopAssignees AS (
    SELECT
        "assignee_name",
        "total_applications",
        ROW_NUMBER() OVER (ORDER BY "total_applications" DESC NULLS LAST) AS rn
    FROM AssigneeApps
    WHERE "assignee_name" IS NOT NULL
),
AssigneeTopYear AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')) AS "Year_With_Most_Applications",
        COUNT(DISTINCT t."application_number") AS "Applications_In_That_Year",
        ROW_NUMBER() OVER (
            PARTITION BY a.value:"name"::STRING 
            ORDER BY COUNT(DISTINCT t."application_number") DESC
        ) AS rn
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'))
    QUALIFY rn = 1
),
AssigneeTopCountry AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')) AS "Year_With_Most_Applications",
        t."country_code" AS "Country_Code_With_Most_Applications",
        COUNT(DISTINCT t."application_number") AS "Applications_In_Country",
        ROW_NUMBER() OVER (
            PARTITION BY a.value:"name"::STRING, YEAR(TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')) 
            ORDER BY COUNT(DISTINCT t."application_number") DESC
        ) AS rn
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')), t."country_code"
    QUALIFY rn = 1
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Applications",
    aty."Year_With_Most_Applications",
    aty."Applications_In_That_Year",
    atc."Country_Code_With_Most_Applications"
FROM TopAssignees ta
JOIN AssigneeTopYear aty ON ta."assignee_name" = aty."assignee_name"
JOIN AssigneeTopCountry atc ON 
    ta."assignee_name" = atc."assignee_name" 
    AND aty."Year_With_Most_Applications" = atc."Year_With_Most_Applications"
WHERE ta.rn <= 3
ORDER BY ta."total_applications" DESC NULLS LAST;
2025-01-20 22:00:26 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 22:00:26 - root - INFO - ```sql
WITH AssigneeApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        COUNT(DISTINCT t."application_number") AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING
),
TopAssignees AS (
    SELECT
        "assignee_name",
        "total_applications",
        ROW_NUMBER() OVER (ORDER BY "total_applications" DESC NULLS LAST) AS rn
    FROM AssigneeApps
    WHERE "assignee_name" IS NOT NULL
),
AssigneeTopYear AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(TO_CHAR(t."filing_date"), 'YYYYMMDD')) AS "Year_With_Most_Applications",
        COUNT(DISTINCT t."application_number") AS "Applications_In_That_Year",
        ROW_NUMBER() OVER (
            PARTITION BY a.value:"name"::STRING 
            ORDER BY COUNT(DISTINCT t."application_number") DESC
        ) AS rn
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(TO_CHAR(t."filing_date"), 'YYYYMMDD'))
    QUALIFY rn = 1
),
AssigneeTopCountry AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(TO_CHAR(t."filing_date"), 'YYYYMMDD')) AS "Year_With_Most_Applications",
        t."country_code" AS "Country_Code_With_Most_Applications",
        COUNT(DISTINCT t."application_number") AS "Applications_In_Country",
        ROW_NUMBER() OVER (
            PARTITION BY a.value:"name"::STRING, YEAR(TO_DATE(TO_CHAR(t."filing_date"), 'YYYYMMDD')) 
            ORDER BY COUNT(DISTINCT t."application_number") DESC
        ) AS rn
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(TO_CHAR(t."filing_date"), 'YYYYMMDD')), t."country_code"
    QUALIFY rn = 1
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Applications",
    aty."Year_With_Most_Applications",
    aty."Applications_In_That_Year",
    atc."Country_Code_With_Most_Applications"
FROM TopAssignees ta
JOIN AssigneeTopYear aty ON ta."assignee_name" = aty."assignee_name"
JOIN AssigneeTopCountry atc ON 
    ta."assignee_name" = atc."assignee_name" 
    AND aty."Year_With_Most_Applications" = atc."Year_With_Most_Applications"
WHERE ta.rn <= 3
ORDER BY ta."total_applications" DESC NULLS LAST;
```
2025-01-20 22:00:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 22:00:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 22:00:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 22:00:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-20 22:00:28 - snowflake.connector.connection - INFO - closed
2025-01-20 22:00:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 22:00:29 - root - INFO - itercount: 4
2025-01-20 22:00:29 - root - INFO - 0
2025-01-20 22:00:29 - root - INFO - results: 
Assignee_Name,Total_Applications,Year_With_Most_Applications,Applications_In_That_Year,Country_Code_With_Most_Applications
LELY NV C VAN DER,5,1981,1,GB
DEERE & CO,4,1979,1,NL
AMAZONEN WERKE DREYER H,2,1979,2,GB


2025-01-20 22:00:29 - root - INFO - Please check the answer again by reviewing For patent class A01B3, I want to analyze the information of the top 3 assignees based on the total number of applications. Please provide the following five pieces of information: the name of this assignee,  total number of applications, the year with the most applications, the number of applications in that year, and the country code with the most applications during that year., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Assignee_Name,Total_Applications,Year_With_Most_Applications,Applications_In_That_Year,Country_Code_With_Most_Applications
assignee1:str,total_applications1:int,year1:int,applications_in_that_year1:int,country_code1:str
assignee2:str,total_applications2:int,year2:int,applications_in_that_year2:int,country_code2:str
assignee3:str,total_applications3:int,year3:int,applications_in_that_year3:int,country_code3:str
```

The table above lists the top 3 assignees for patent class A01B3 based on the total number of applications. For each assignee, it shows their name, the total number of applications they have filed, the year in which they had the most applications, the number of applications in that year, and the country code with the most applications during that year. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Assignee_Name,Total_Applications,Year_With_Most_Applications,Applications_In_That_Year,Country_Code_With_Most_Applications
LELY NV C VAN DER,5,1981,1,GB
DEERE & CO,4,1979,1,NL
AMAZONEN WERKE DREYER H,2,1979,2,GB
Current sql:
WITH AssigneeApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        COUNT(DISTINCT t."application_number") AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING
),
TopAssignees AS (
    SELECT
        "assignee_name",
        "total_applications",
        ROW_NUMBER() OVER (ORDER BY "total_applications" DESC NULLS LAST) AS rn
    FROM AssigneeApps
    WHERE "assignee_name" IS NOT NULL
),
AssigneeTopYear AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(TO_CHAR(t."filing_date"), 'YYYYMMDD')) AS "Year_With_Most_Applications",
        COUNT(DISTINCT t."application_number") AS "Applications_In_That_Year",
        ROW_NUMBER() OVER (
            PARTITION BY a.value:"name"::STRING 
            ORDER BY COUNT(DISTINCT t."application_number") DESC
        ) AS rn
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(TO_CHAR(t."filing_date"), 'YYYYMMDD'))
    QUALIFY rn = 1
),
AssigneeTopCountry AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(TO_CHAR(t."filing_date"), 'YYYYMMDD')) AS "Year_With_Most_Applications",
        t."country_code" AS "Country_Code_With_Most_Applications",
        COUNT(DISTINCT t."application_number") AS "Applications_In_Country",
        ROW_NUMBER() OVER (
            PARTITION BY a.value:"name"::STRING, YEAR(TO_DATE(TO_CHAR(t."filing_date"), 'YYYYMMDD')) 
            ORDER BY COUNT(DISTINCT t."application_number") DESC
        ) AS rn
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(TO_CHAR(t."filing_date"), 'YYYYMMDD')), t."country_code"
    QUALIFY rn = 1
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Applications",
    aty."Year_With_Most_Applications",
    aty."Applications_In_That_Year",
    atc."Country_Code_With_Most_Applications"
FROM TopAssignees ta
JOIN AssigneeTopYear aty ON ta."assignee_name" = aty."assignee_name"
JOIN AssigneeTopCountry atc ON 
    ta."assignee_name" = atc."assignee_name" 
    AND aty."Year_With_Most_Applications" = atc."Year_With_Most_Applications"
WHERE ta.rn <= 3
ORDER BY ta."total_applications" DESC NULLS LAST;
2025-01-20 22:01:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 22:01:22 - root - INFO - ```sql
WITH AssigneeApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        COUNT(DISTINCT t."application_number") AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING
),
TopAssignees AS (
    SELECT
        "assignee_name",
        "total_applications",
        ROW_NUMBER() OVER (ORDER BY "total_applications" DESC NULLS LAST) AS rn
    FROM AssigneeApps
    WHERE "assignee_name" IS NOT NULL
),
AssigneeTopYear AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "Year_With_Most_Applications",
        COUNT(DISTINCT t."application_number") AS "Applications_In_That_Year",
        ROW_NUMBER() OVER (
            PARTITION BY a.value:"name"::STRING 
            ORDER BY COUNT(DISTINCT t."application_number") DESC
        ) AS rn
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'))
    QUALIFY rn = 1
),
AssigneeTopCountry AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "Year_With_Most_Applications",
        t."country_code" AS "Country_Code_With_Most_Applications",
        COUNT(DISTINCT t."application_number") AS "Applications_In_Country",
        ROW_NUMBER() OVER (
            PARTITION BY a.value:"name"::STRING, YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) 
            ORDER BY COUNT(DISTINCT t."application_number") DESC
        ) AS rn
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')), t."country_code"
    QUALIFY rn = 1
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Applications",
    aty."Year_With_Most_Applications",
    aty."Applications_In_That_Year",
    atc."Country_Code_With_Most_Applications"
FROM TopAssignees ta
JOIN AssigneeTopYear aty ON ta."assignee_name" = aty."assignee_name"
JOIN AssigneeTopCountry atc ON 
    ta."assignee_name" = atc."assignee_name" 
    AND aty."Year_With_Most_Applications" = atc."Year_With_Most_Applications"
WHERE ta.rn <= 3
ORDER BY ta."total_applications" DESC NULLS LAST;
```
2025-01-20 22:01:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 22:01:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 22:01:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 22:01:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-20 22:01:23 - snowflake.connector.connection - INFO - closed
2025-01-20 22:01:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 22:01:24 - root - INFO - itercount: 5
2025-01-20 22:01:24 - root - INFO - 0
2025-01-20 22:01:24 - root - INFO - results: 
Assignee_Name,Total_Applications,Year_With_Most_Applications,Applications_In_That_Year,Country_Code_With_Most_Applications
LELY NV C VAN DER,5,1985,1,IT
DEERE & CO,4,2002,1,AU
AMAZONEN WERKE DREYER H,2,1979,2,AT


2025-01-20 22:01:24 - root - INFO - Please check the answer again by reviewing For patent class A01B3, I want to analyze the information of the top 3 assignees based on the total number of applications. Please provide the following five pieces of information: the name of this assignee,  total number of applications, the year with the most applications, the number of applications in that year, and the country code with the most applications during that year., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Assignee_Name,Total_Applications,Year_With_Most_Applications,Applications_In_That_Year,Country_Code_With_Most_Applications
assignee1:str,total_applications1:int,year1:int,applications_in_that_year1:int,country_code1:str
assignee2:str,total_applications2:int,year2:int,applications_in_that_year2:int,country_code2:str
assignee3:str,total_applications3:int,year3:int,applications_in_that_year3:int,country_code3:str
```

The table above lists the top 3 assignees for patent class A01B3 based on the total number of applications. For each assignee, it shows their name, the total number of applications they have filed, the year in which they had the most applications, the number of applications in that year, and the country code with the most applications during that year. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Assignee_Name,Total_Applications,Year_With_Most_Applications,Applications_In_That_Year,Country_Code_With_Most_Applications
LELY NV C VAN DER,5,1985,1,IT
DEERE & CO,4,2002,1,AU
AMAZONEN WERKE DREYER H,2,1979,2,AT
Current sql:
WITH AssigneeApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        COUNT(DISTINCT t."application_number") AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING
),
TopAssignees AS (
    SELECT
        "assignee_name",
        "total_applications",
        ROW_NUMBER() OVER (ORDER BY "total_applications" DESC NULLS LAST) AS rn
    FROM AssigneeApps
    WHERE "assignee_name" IS NOT NULL
),
AssigneeTopYear AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "Year_With_Most_Applications",
        COUNT(DISTINCT t."application_number") AS "Applications_In_That_Year",
        ROW_NUMBER() OVER (
            PARTITION BY a.value:"name"::STRING 
            ORDER BY COUNT(DISTINCT t."application_number") DESC
        ) AS rn
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'))
    QUALIFY rn = 1
),
AssigneeTopCountry AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "Year_With_Most_Applications",
        t."country_code" AS "Country_Code_With_Most_Applications",
        COUNT(DISTINCT t."application_number") AS "Applications_In_Country",
        ROW_NUMBER() OVER (
            PARTITION BY a.value:"name"::STRING, YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) 
            ORDER BY COUNT(DISTINCT t."application_number") DESC
        ) AS rn
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')), t."country_code"
    QUALIFY rn = 1
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Applications",
    aty."Year_With_Most_Applications",
    aty."Applications_In_That_Year",
    atc."Country_Code_With_Most_Applications"
FROM TopAssignees ta
JOIN AssigneeTopYear aty ON ta."assignee_name" = aty."assignee_name"
JOIN AssigneeTopCountry atc ON 
    ta."assignee_name" = atc."assignee_name" 
    AND aty."Year_With_Most_Applications" = atc."Year_With_Most_Applications"
WHERE ta.rn <= 3
ORDER BY ta."total_applications" DESC NULLS LAST;
2025-01-20 22:02:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 22:02:33 - root - INFO - ```sql
WITH AssigneeApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        COUNT(DISTINCT t."application_number") AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING
),
TopAssignees AS (
    SELECT
        "assignee_name",
        "total_applications",
        ROW_NUMBER() OVER (ORDER BY "total_applications" DESC NULLS LAST) AS rn
    FROM AssigneeApps
    WHERE "assignee_name" IS NOT NULL
),
AssigneeYearlyApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "Year",
        COUNT(DISTINCT t."application_number") AS "Applications_In_That_Year"
    FROM PATENTS.PATENTS.PUBLICATIONS t
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'))
),
AssigneeTopYear AS (
    SELECT
        "assignee_name",
        "Year" AS "Year_With_Most_Applications",
        "Applications_In_That_Year",
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name" ORDER BY "Applications_In_That_Year" DESC, "Year"
        ) AS rn
    FROM AssigneeYearlyApps
),
AssigneeYearCountryApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "Year",
        t."country_code" AS "Country_Code",
        COUNT(DISTINCT t."application_number") AS "Applications_In_Country"
    FROM PATENTS.PATENTS.PUBLICATIONS t
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')), t."country_code"
),
AssigneeTopCountry AS (
    SELECT
        "assignee_name",
        "Year",
        "Country_Code" AS "Country_Code_With_Most_Applications",
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name", "Year" ORDER BY "Applications_In_Country" DESC
        ) AS rn
    FROM AssigneeYearCountryApps
),
FinalAssigneeTopCountry AS (
    SELECT
        "assignee_name",
        "Year",
        "Country_Code_With_Most_Applications"
    FROM AssigneeTopCountry
    WHERE rn = 1
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Applications",
    aty."Year_With_Most_Applications",
    aty."Applications_In_That_Year",
    atc."Country_Code_With_Most_Applications"
FROM TopAssignees ta
JOIN AssigneeTopYear aty ON ta."assignee_name" = aty."assignee_name" AND aty.rn = 1
JOIN FinalAssigneeTopCountry atc ON 
    ta."assignee_name" = atc."assignee_name" 
    AND aty."Year_With_Most_Applications" = atc."Year"
WHERE ta.rn <= 3
ORDER BY ta."total_applications" DESC NULLS LAST;
```
2025-01-20 22:02:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 22:02:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 22:02:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 22:02:35 - snowflake.connector.connection - INFO - closed
2025-01-20 22:02:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 22:02:36 - root - INFO - itercount: 6
2025-01-20 22:02:36 - root - INFO - 001003 (42000): 01b9d8aa-0004-7ed2-0001-11c300f2cfd6: SQL compilation error:
syntax error line 6 at position 8 unexpected 'LATERAL'.
syntax error line 6 at position 24 unexpected 'input'.
syntax error line 6 at position 42 unexpected 'c'.
2025-01-20 22:02:36 - root - INFO - Input sql:
WITH AssigneeApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        COUNT(DISTINCT t."application_number") AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING
),
TopAssignees AS (
    SELECT
        "assignee_name",
        "total_applications",
        ROW_NUMBER() OVER (ORDER BY "total_applications" DESC NULLS LAST) AS rn
    FROM AssigneeApps
    WHERE "assignee_name" IS NOT NULL
),
AssigneeYearlyApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "Year",
        COUNT(DISTINCT t."application_number") AS "Applications_In_That_Year"
    FROM PATENTS.PATENTS.PUBLICATIONS t
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'))
),
AssigneeTopYear AS (
    SELECT
        "assignee_name",
        "Year" AS "Year_With_Most_Applications",
        "Applications_In_That_Year",
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name" ORDER BY "Applications_In_That_Year" DESC, "Year"
        ) AS rn
    FROM AssigneeYearlyApps
),
AssigneeYearCountryApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "Year",
        t."country_code" AS "Country_Code",
        COUNT(DISTINCT t."application_number") AS "Applications_In_Country"
    FROM PATENTS.PATENTS.PUBLICATIONS t
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')), t."country_code"
),
AssigneeTopCountry AS (
    SELECT
        "assignee_name",
        "Year",
        "Country_Code" AS "Country_Code_With_Most_Applications",
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name", "Year" ORDER BY "Applications_In_Country" DESC
        ) AS rn
    FROM AssigneeYearCountryApps
),
FinalAssigneeTopCountry AS (
    SELECT
        "assignee_name",
        "Year",
        "Country_Code_With_Most_Applications"
    FROM AssigneeTopCountry
    WHERE rn = 1
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Applications",
    aty."Year_With_Most_Applications",
    aty."Applications_In_That_Year",
    atc."Country_Code_With_Most_Applications"
FROM TopAssignees ta
JOIN AssigneeTopYear aty ON ta."assignee_name" = aty."assignee_name" AND aty.rn = 1
JOIN FinalAssigneeTopCountry atc ON 
    ta."assignee_name" = atc."assignee_name" 
    AND aty."Year_With_Most_Applications" = atc."Year"
WHERE ta.rn <= 3
ORDER BY ta."total_applications" DESC NULLS LAST;
The error information is:
001003 (42000): 01b9d8aa-0004-7ed2-0001-11c300f2cfd6: SQL compilation error:
syntax error line 6 at position 8 unexpected 'LATERAL'.
syntax error line 6 at position 24 unexpected 'input'.
syntax error line 6 at position 42 unexpected 'c'.
Please correct it and output only 1 complete SQL query.
2025-01-20 22:03:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 22:03:10 - root - INFO - ```sql
WITH AssigneeApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        COUNT(DISTINCT t."application_number") AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING
),
TopAssignees AS (
    SELECT
        "assignee_name",
        "total_applications",
        ROW_NUMBER() OVER (ORDER BY "total_applications" DESC NULLS LAST) AS rn
    FROM AssigneeApps
    WHERE "assignee_name" IS NOT NULL
),
AssigneeYearlyApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "Year",
        COUNT(DISTINCT t."application_number") AS "Applications_In_That_Year"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'))
),
AssigneeTopYear AS (
    SELECT
        "assignee_name",
        "Year" AS "Year_With_Most_Applications",
        "Applications_In_That_Year",
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name" ORDER BY "Applications_In_That_Year" DESC, "Year"
        ) AS rn
    FROM AssigneeYearlyApps
    WHERE rn = 1
),
AssigneeYearCountryApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "Year",
        t."country_code" AS "Country_Code",
        COUNT(DISTINCT t."application_number") AS "Applications_In_Country"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')), t."country_code"
),
AssigneeTopCountry AS (
    SELECT
        "assignee_name",
        "Year",
        "Country_Code" AS "Country_Code_With_Most_Applications",
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name", "Year" ORDER BY "Applications_In_Country" DESC
        ) AS rn
    FROM AssigneeYearCountryApps
    WHERE rn = 1
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Applications",
    aty."Year_With_Most_Applications",
    aty."Applications_In_That_Year",
    atc."Country_Code_With_Most_Applications"
FROM TopAssignees ta
JOIN AssigneeTopYear aty ON ta."assignee_name" = aty."assignee_name" AND aty.rn = 1
JOIN AssigneeTopCountry atc ON 
    ta."assignee_name" = atc."assignee_name" 
    AND aty."Year_With_Most_Applications" = atc."Year"
WHERE ta.rn <= 3
ORDER BY ta."total_applications" DESC NULLS LAST;
```
2025-01-20 22:03:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 22:03:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 22:03:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 22:03:11 - snowflake.connector.connection - INFO - closed
2025-01-20 22:03:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 22:03:12 - root - INFO - itercount: 7
2025-01-20 22:03:12 - root - INFO - 002063 (42601): 01b9d8ab-0004-7ed2-0001-11c300f2cfda: SQL compilation error:
Window function [ROW_NUMBER() OVER (PARTITION BY ASSIGNEEYEARLYAPPS."assignee_name" ORDER BY ASSIGNEEYEARLYAPPS."Applications_In_That_Year" DESC NULLS FIRST, ASSIGNEEYEARLYAPPS."Year" ASC NULLS LAST)] appears outside of SELECT, QUALIFY, and ORDER BY clauses.
2025-01-20 22:03:12 - root - INFO - Input sql:
WITH AssigneeApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        COUNT(DISTINCT t."application_number") AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING
),
TopAssignees AS (
    SELECT
        "assignee_name",
        "total_applications",
        ROW_NUMBER() OVER (ORDER BY "total_applications" DESC NULLS LAST) AS rn
    FROM AssigneeApps
    WHERE "assignee_name" IS NOT NULL
),
AssigneeYearlyApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "Year",
        COUNT(DISTINCT t."application_number") AS "Applications_In_That_Year"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'))
),
AssigneeTopYear AS (
    SELECT
        "assignee_name",
        "Year" AS "Year_With_Most_Applications",
        "Applications_In_That_Year",
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name" ORDER BY "Applications_In_That_Year" DESC, "Year"
        ) AS rn
    FROM AssigneeYearlyApps
    WHERE rn = 1
),
AssigneeYearCountryApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "Year",
        t."country_code" AS "Country_Code",
        COUNT(DISTINCT t."application_number") AS "Applications_In_Country"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')), t."country_code"
),
AssigneeTopCountry AS (
    SELECT
        "assignee_name",
        "Year",
        "Country_Code" AS "Country_Code_With_Most_Applications",
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name", "Year" ORDER BY "Applications_In_Country" DESC
        ) AS rn
    FROM AssigneeYearCountryApps
    WHERE rn = 1
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Applications",
    aty."Year_With_Most_Applications",
    aty."Applications_In_That_Year",
    atc."Country_Code_With_Most_Applications"
FROM TopAssignees ta
JOIN AssigneeTopYear aty ON ta."assignee_name" = aty."assignee_name" AND aty.rn = 1
JOIN AssigneeTopCountry atc ON 
    ta."assignee_name" = atc."assignee_name" 
    AND aty."Year_With_Most_Applications" = atc."Year"
WHERE ta.rn <= 3
ORDER BY ta."total_applications" DESC NULLS LAST;
The error information is:
002063 (42601): 01b9d8ab-0004-7ed2-0001-11c300f2cfda: SQL compilation error:
Window function [ROW_NUMBER() OVER (PARTITION BY ASSIGNEEYEARLYAPPS."assignee_name" ORDER BY ASSIGNEEYEARLYAPPS."Applications_In_That_Year" DESC NULLS FIRST, ASSIGNEEYEARLYAPPS."Year" ASC NULLS LAST)] appears outside of SELECT, QUALIFY, and ORDER BY clauses.
Please correct it and output only 1 complete SQL query.
2025-01-20 22:03:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 22:03:37 - root - INFO - ```sql
WITH AssigneeApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        COUNT(DISTINCT t."application_number") AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING
),
TopAssignees AS (
    SELECT
        "assignee_name",
        "total_applications",
        ROW_NUMBER() OVER (ORDER BY "total_applications" DESC NULLS LAST) AS rn
    FROM AssigneeApps
    WHERE "assignee_name" IS NOT NULL
),
AssigneeYearlyApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "Year",
        COUNT(DISTINCT t."application_number") AS "Applications_In_That_Year"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'))
),
AssigneeTopYear AS (
    SELECT
        "assignee_name",
        "Year" AS "Year_With_Most_Applications",
        "Applications_In_That_Year",
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name" ORDER BY "Applications_In_That_Year" DESC, "Year"
        ) AS rn
    FROM AssigneeYearlyApps
    QUALIFY rn = 1
),
AssigneeYearCountryApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "Year",
        t."country_code" AS "Country_Code",
        COUNT(DISTINCT t."application_number") AS "Applications_In_Country"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')), t."country_code"
),
AssigneeTopCountry AS (
    SELECT
        "assignee_name",
        "Year",
        "Country_Code" AS "Country_Code_With_Most_Applications",
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name", "Year" ORDER BY "Applications_In_Country" DESC
        ) AS rn
    FROM AssigneeYearCountryApps
    QUALIFY rn = 1
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Applications",
    aty."Year_With_Most_Applications",
    aty."Applications_In_That_Year",
    atc."Country_Code_With_Most_Applications"
FROM TopAssignees ta
JOIN AssigneeTopYear aty ON ta."assignee_name" = aty."assignee_name"
JOIN AssigneeTopCountry atc ON 
    ta."assignee_name" = atc."assignee_name" 
    AND aty."Year_With_Most_Applications" = atc."Year"
WHERE ta.rn <= 3
ORDER BY ta."total_applications" DESC NULLS LAST;
```
2025-01-20 22:03:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 22:03:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 22:03:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 22:03:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-20 22:03:39 - snowflake.connector.connection - INFO - closed
2025-01-20 22:03:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 22:03:39 - root - INFO - itercount: 8
2025-01-20 22:03:39 - root - INFO - 0
2025-01-20 22:03:39 - root - INFO - results: 
Assignee_Name,Total_Applications,Year_With_Most_Applications,Applications_In_That_Year,Country_Code_With_Most_Applications
LELY NV C VAN DER,5,1975,1,NL
DEERE & CO,4,1979,1,NL
AMAZONEN WERKE DREYER H,2,1979,2,AT


2025-01-20 22:03:39 - root - INFO - Please check the answer again by reviewing For patent class A01B3, I want to analyze the information of the top 3 assignees based on the total number of applications. Please provide the following five pieces of information: the name of this assignee,  total number of applications, the year with the most applications, the number of applications in that year, and the country code with the most applications during that year., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Assignee_Name,Total_Applications,Year_With_Most_Applications,Applications_In_That_Year,Country_Code_With_Most_Applications
assignee1:str,total_applications1:int,year1:int,applications_in_that_year1:int,country_code1:str
assignee2:str,total_applications2:int,year2:int,applications_in_that_year2:int,country_code2:str
assignee3:str,total_applications3:int,year3:int,applications_in_that_year3:int,country_code3:str
```

The table above lists the top 3 assignees for patent class A01B3 based on the total number of applications. For each assignee, it shows their name, the total number of applications they have filed, the year in which they had the most applications, the number of applications in that year, and the country code with the most applications during that year. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Assignee_Name,Total_Applications,Year_With_Most_Applications,Applications_In_That_Year,Country_Code_With_Most_Applications
LELY NV C VAN DER,5,1975,1,NL
DEERE & CO,4,1979,1,NL
AMAZONEN WERKE DREYER H,2,1979,2,AT
Current sql:
WITH AssigneeApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        COUNT(DISTINCT t."application_number") AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING
),
TopAssignees AS (
    SELECT
        "assignee_name",
        "total_applications",
        ROW_NUMBER() OVER (ORDER BY "total_applications" DESC NULLS LAST) AS rn
    FROM AssigneeApps
    WHERE "assignee_name" IS NOT NULL
),
AssigneeYearlyApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "Year",
        COUNT(DISTINCT t."application_number") AS "Applications_In_That_Year"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'))
),
AssigneeTopYear AS (
    SELECT
        "assignee_name",
        "Year" AS "Year_With_Most_Applications",
        "Applications_In_That_Year",
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name" ORDER BY "Applications_In_That_Year" DESC, "Year"
        ) AS rn
    FROM AssigneeYearlyApps
    QUALIFY rn = 1
),
AssigneeYearCountryApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "Year",
        t."country_code" AS "Country_Code",
        COUNT(DISTINCT t."application_number") AS "Applications_In_Country"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')), t."country_code"
),
AssigneeTopCountry AS (
    SELECT
        "assignee_name",
        "Year",
        "Country_Code" AS "Country_Code_With_Most_Applications",
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name", "Year" ORDER BY "Applications_In_Country" DESC
        ) AS rn
    FROM AssigneeYearCountryApps
    QUALIFY rn = 1
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Applications",
    aty."Year_With_Most_Applications",
    aty."Applications_In_That_Year",
    atc."Country_Code_With_Most_Applications"
FROM TopAssignees ta
JOIN AssigneeTopYear aty ON ta."assignee_name" = aty."assignee_name"
JOIN AssigneeTopCountry atc ON 
    ta."assignee_name" = atc."assignee_name" 
    AND aty."Year_With_Most_Applications" = atc."Year"
WHERE ta.rn <= 3
ORDER BY ta."total_applications" DESC NULLS LAST;
2025-01-20 22:04:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 22:04:29 - root - INFO - ```sql
WITH AssigneeApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        COUNT(DISTINCT t."application_number") AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING
),
TopAssignees AS (
    SELECT
        "assignee_name",
        "total_applications",
        ROW_NUMBER() OVER (ORDER BY "total_applications" DESC NULLS LAST) AS rn
    FROM AssigneeApps
    WHERE "assignee_name" IS NOT NULL
),
AssigneeYearlyApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "Year",
        COUNT(DISTINCT t."application_number") AS "Applications_In_That_Year"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'))
),
AssigneeTopYear AS (
    SELECT
        "assignee_name",
        "Year" AS "Year_With_Most_Applications",
        "Applications_In_That_Year",
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name" ORDER BY "Applications_In_That_Year" DESC, "Year" ASC
        ) AS rn
    FROM AssigneeYearlyApps
    QUALIFY rn = 1
),
AssigneeYearCountryApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "Year",
        t."country_code" AS "Country_Code",
        COUNT(DISTINCT t."application_number") AS "Applications_In_Country"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')), t."country_code"
),
AssigneeTopCountry AS (
    SELECT
        "assignee_name",
        "Year",
        "Country_Code" AS "Country_Code_With_Most_Applications",
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name", "Year" ORDER BY "Applications_In_Country" DESC
        ) AS rn
    FROM AssigneeYearCountryApps
    QUALIFY rn = 1
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Applications",
    aty."Year_With_Most_Applications",
    aty."Applications_In_That_Year",
    atc."Country_Code_With_Most_Applications"
FROM TopAssignees ta
JOIN AssigneeTopYear aty ON ta."assignee_name" = aty."assignee_name"
JOIN AssigneeTopCountry atc ON 
    ta."assignee_name" = atc."assignee_name" 
    AND aty."Year_With_Most_Applications" = atc."Year"
WHERE ta.rn <= 3
ORDER BY ta."total_applications" DESC NULLS LAST;
```
2025-01-20 22:04:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 22:04:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 22:04:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 22:04:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-20 22:04:31 - snowflake.connector.connection - INFO - closed
2025-01-20 22:04:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 22:04:31 - root - INFO - itercount: 9
2025-01-20 22:04:31 - root - INFO - 0
2025-01-20 22:04:31 - root - INFO - results: 
Assignee_Name,Total_Applications,Year_With_Most_Applications,Applications_In_That_Year,Country_Code_With_Most_Applications
LELY NV C VAN DER,5,1975,1,NL
DEERE & CO,4,1979,1,NL
AMAZONEN WERKE DREYER H,2,1979,2,GB


2025-01-20 22:04:31 - root - INFO - Please check the answer again by reviewing For patent class A01B3, I want to analyze the information of the top 3 assignees based on the total number of applications. Please provide the following five pieces of information: the name of this assignee,  total number of applications, the year with the most applications, the number of applications in that year, and the country code with the most applications during that year., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Assignee_Name,Total_Applications,Year_With_Most_Applications,Applications_In_That_Year,Country_Code_With_Most_Applications
assignee1:str,total_applications1:int,year1:int,applications_in_that_year1:int,country_code1:str
assignee2:str,total_applications2:int,year2:int,applications_in_that_year2:int,country_code2:str
assignee3:str,total_applications3:int,year3:int,applications_in_that_year3:int,country_code3:str
```

The table above lists the top 3 assignees for patent class A01B3 based on the total number of applications. For each assignee, it shows their name, the total number of applications they have filed, the year in which they had the most applications, the number of applications in that year, and the country code with the most applications during that year. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Assignee_Name,Total_Applications,Year_With_Most_Applications,Applications_In_That_Year,Country_Code_With_Most_Applications
LELY NV C VAN DER,5,1975,1,NL
DEERE & CO,4,1979,1,NL
AMAZONEN WERKE DREYER H,2,1979,2,GB
Current sql:
WITH AssigneeApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        COUNT(DISTINCT t."application_number") AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING
),
TopAssignees AS (
    SELECT
        "assignee_name",
        "total_applications",
        ROW_NUMBER() OVER (ORDER BY "total_applications" DESC NULLS LAST) AS rn
    FROM AssigneeApps
    WHERE "assignee_name" IS NOT NULL
),
AssigneeYearlyApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "Year",
        COUNT(DISTINCT t."application_number") AS "Applications_In_That_Year"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'))
),
AssigneeTopYear AS (
    SELECT
        "assignee_name",
        "Year" AS "Year_With_Most_Applications",
        "Applications_In_That_Year",
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name" ORDER BY "Applications_In_That_Year" DESC, "Year" ASC
        ) AS rn
    FROM AssigneeYearlyApps
    QUALIFY rn = 1
),
AssigneeYearCountryApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')) AS "Year",
        t."country_code" AS "Country_Code",
        COUNT(DISTINCT t."application_number") AS "Applications_In_Country"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING, YEAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD')), t."country_code"
),
AssigneeTopCountry AS (
    SELECT
        "assignee_name",
        "Year",
        "Country_Code" AS "Country_Code_With_Most_Applications",
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name", "Year" ORDER BY "Applications_In_Country" DESC
        ) AS rn
    FROM AssigneeYearCountryApps
    QUALIFY rn = 1
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Applications",
    aty."Year_With_Most_Applications",
    aty."Applications_In_That_Year",
    atc."Country_Code_With_Most_Applications"
FROM TopAssignees ta
JOIN AssigneeTopYear aty ON ta."assignee_name" = aty."assignee_name"
JOIN AssigneeTopCountry atc ON 
    ta."assignee_name" = atc."assignee_name" 
    AND aty."Year_With_Most_Applications" = atc."Year"
WHERE ta.rn <= 3
ORDER BY ta."total_applications" DESC NULLS LAST;
2025-01-20 22:05:23 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 22:05:23 - root - INFO - ```sql
WITH AssigneeApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        COUNT(DISTINCT t."application_number") AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
    GROUP BY a.value:"name"::STRING
),
TopAssignees AS (
    SELECT
        "assignee_name",
        "total_applications",
        ROW_NUMBER() OVER (ORDER BY "total_applications" DESC NULLS LAST) AS rn
    FROM AssigneeApps
    WHERE "assignee_name" IS NOT NULL
),
AssigneeYearlyApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(DATE_FROM_PARTS(TO_NUMBER(t."filing_date"))) AS "Year",
        COUNT(DISTINCT t."application_number") AS "Applications_In_That_Year"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
        AND t."filing_date" IS NOT NULL
    GROUP BY a.value:"name"::STRING, YEAR(DATE_FROM_PARTS(TO_NUMBER(t."filing_date")))
),
AssigneeTopYear AS (
    SELECT
        "assignee_name",
        "Year" AS "Year_With_Most_Applications",
        "Applications_In_That_Year",
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name" ORDER BY "Applications_In_That_Year" DESC, "Year" ASC
        ) AS rn
    FROM AssigneeYearlyApps
    QUALIFY rn = 1
),
AssigneeYearCountryApps AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        YEAR(DATE_FROM_PARTS(TO_NUMBER(t."filing_date"))) AS "Year",
        t."country_code" AS "Country_Code",
        COUNT(DISTINCT t."application_number") AS "Applications_In_Country"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A01B3%'
        AND t."filing_date" IS NOT NULL
    GROUP BY a.value:"name"::STRING, YEAR(DATE_FROM_PARTS(TO_NUMBER(t."filing_date"))), t."country_code"
),
AssigneeTopCountry AS (
    SELECT
        "assignee_name",
        "Year",
        "Country_Code" AS "Country_Code_With_Most_Applications",
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name", "Year" ORDER BY "Applications_In_Country" DESC
        ) AS rn
    FROM AssigneeYearCountryApps
    QUALIFY rn = 1
)
SELECT
    ta."assignee_name" AS "Assignee_Name",
    ta."total_applications" AS "Total_Applications",
    aty."Year_With_Most_Applications",
    aty."Applications_In_That_Year",
    atc."Country_Code_With_Most_Applications"
FROM TopAssignees ta
JOIN AssigneeTopYear aty ON ta."assignee_name" = aty."assignee_name"
JOIN AssigneeTopCountry atc ON 
    ta."assignee_name" = atc."assignee_name" 
    AND aty."Year_With_Most_Applications" = atc."Year"
WHERE ta.rn <= 3
ORDER BY ta."total_applications" DESC NULLS LAST;
```
2025-01-20 22:05:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 22:05:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 22:05:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 22:05:25 - snowflake.connector.connection - INFO - closed
2025-01-20 22:05:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 22:05:25 - root - INFO - Total iteration counts: 10
