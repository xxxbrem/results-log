2025-01-24 04:33:36 - openai._base_client - INFO - Retrying request to /chat/completions in 0.395900 seconds
2025-01-24 04:34:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 04:34:23 - root - INFO - SQL:
SELECT id, drugType, hasBeenWithdrawn
   FROM `open-targets-prod.platform.molecule`
   WHERE isApproved = TRUE
     AND blackBoxWarning = TRUE
   LIMIT 100;
Results:
id,drugType,hasBeenWithdrawn
CHEMBL1237122,Small molecule,False
CHEMBL3989520,Small molecule,False
CHEMBL3989509,Small molecule,False
CHEMBL3989824,Small molecule,False
CHEMBL1201486,Small molecule,False
CHEMBL1200463,Small molecule,False
CHEMBL1187417,Small molecule,False
CHEMBL1201485,Unknown,False
CHEMBL2218913,Protein,False
CHEMBL2108448,Oligosaccharide,False
CHEMBL5315048,Protein,False
CHEMBL1963684,Protein,True
CHEMBL1201159,Small molecule,False
CHEMBL5314649,Small molecule,False
CHEMBL1201544,Unknown,False
CHEMBL3989861,Small molecule,False
CHEMBL3989522,Small molecule,False
CHEMBL1753,Small molecule,False
CHEMBL1204187,Small molecule,False
CHEMBL3989973,Small molecule,False
CHEMBL4802239,Small molecule,False
CHEMBL3833353,Protein,False
CHEMBL2108035,Unknown,False
CHEMBL1200475,Small molecule,False
CHEMBL2364649,Antibody,False
CHEMBL3039540,Antibody,False
CHEMBL3989751,Unknown,False
CHEMBL3989843,Small molecule,False
CHEMBL1200850,Small molecule,False
CHEMBL3085504,Small molecule,False
CHEMBL100116,Small molecule,False
CHEMBL2364623,Small molecule,False
CHEMBL3989564,Small molecule,False
CHEMBL1201289,Small molecule,False
CHEMBL5095051,Small molecule,False
CHEMBL2108508,Protein,False
CHEMBL2105709,Small molecule,False
CHEMBL5314379,Protein,False
CHEMBL2107841,Protein,False
CHEMBL4297839,Protein,False
CHEMBL1201557,Protein,False
CHEMBL3301574,Cell,False
CHEMBL4594320,Enzyme,False
CHEMBL5315119,Small molecule,False
CHEMBL3707358,Enzyme,False
CHEMBL5315125,Small molecule,False
CHEMBL3137358,Small molecule,False
CHEMBL3989989,Gene,False
CHEMBL4297862,Protein,False
CHEMBL2108667,Antibody drug conjugate,False
CHEMBL3301589,Antibody drug conjugate,False
CHEMBL4298209,Antibody drug conjugate,False
CHEMBL4298211,Protein,False
CHEMBL4594505,Antibody,False
CHEMBL4066936,Small molecule,False
CHEMBL2303621,Small molecule,False
CHEMBL1533310,Small molecule,False
CHEMBL865,Small molecule,True
CHEMBL427,Small molecule,False
CHEMBL535,Small molecule,False
CHEMBL41355,Small molecule,False
CHEMBL3655081,Small molecule,False
CHEMBL2105720,Small molecule,False
CHEMBL4065616,Small molecule,False
CHEMBL231813,Protein,False

2025-01-24 04:34:48 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 04:34:48 - root - INFO - ```sql
SELECT id, drugType, hasBeenWithdrawn
FROM `open-targets-prod.platform.molecule` AS m
LEFT JOIN UNNEST(m.tradeNames.list) AS tn
LEFT JOIN UNNEST(m.synonyms.list) AS s
WHERE m.isApproved = TRUE
  AND (
    LOWER(m.name) IN ('keytruda', 'vioxx', 'premarin', 'humira') OR
    LOWER(tn.element) IN ('keytruda', 'vioxx', 'premarin', 'humira') OR
    LOWER(s.element) IN ('keytruda', 'vioxx', 'premarin', 'humira')
  )
LIMIT 100;
```
2025-01-24 04:35:59 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 04:35:59 - root - INFO - SQL:
SELECT id, drugType, hasBeenWithdrawn
FROM `open-targets-prod.platform.molecule` AS m
LEFT JOIN UNNEST(m.tradeNames.list) AS tn
LEFT JOIN UNNEST(m.synonyms.list) AS s
WHERE m.isApproved = TRUE
  AND (
    LOWER(m.name) IN ('keytruda', 'vioxx', 'premarin', 'humira') OR
    LOWER(tn.element) IN ('keytruda', 'vioxx', 'premarin', 'humira') OR
    LOWER(s.element) IN ('keytruda', 'vioxx', 'premarin', 'humira')
  )
LIMIT 100;
Results:
id,drugType,hasBeenWithdrawn
CHEMBL122,Small molecule,True
CHEMBL122,Small molecule,True
CHEMBL122,Small molecule,True
CHEMBL122,Small molecule,True
CHEMBL122,Small molecule,True
CHEMBL122,Small molecule,True
CHEMBL122,Small molecule,True
CHEMBL122,Small molecule,True
CHEMBL122,Small molecule,True
CHEMBL1201649,Unknown,False
CHEMBL1201649,Unknown,False
CHEMBL1201649,Unknown,False
CHEMBL1201649,Unknown,False
CHEMBL1201649,Unknown,False
CHEMBL1201649,Unknown,False
CHEMBL1201649,Unknown,False
CHEMBL3137343,Antibody,False
CHEMBL3137343,Antibody,False
CHEMBL3137343,Antibody,False
CHEMBL3137343,Antibody,False
CHEMBL3137343,Antibody,False
CHEMBL3137343,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False

2025-01-24 04:36:00 - root - INFO - SQL:
-- Corrected Query 1
SELECT m.id, m.drugType, m.hasBeenWithdrawn
FROM `open-targets-prod.platform.molecule` AS m
JOIN UNNEST(m.tradeNames.list) AS tn
WHERE m.isApproved = TRUE
  AND LOWER(tn.element) IN ('keytruda', 'vioxx', 'premarin', 'humira')
LIMIT 100
Results:
id,drugType,hasBeenWithdrawn
CHEMBL122,Small molecule,True
CHEMBL1201649,Unknown,False
CHEMBL3137343,Antibody,False
CHEMBL1201580,Antibody,False

2025-01-24 04:36:41 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 04:36:41 - root - INFO - ```sql
SELECT id, drugType, hasBeenWithdrawn
FROM `open-targets-prod.platform.molecule` AS m
WHERE (
  LOWER(m.name) LIKE '%keytruda%' OR LOWER(m.name) LIKE '%vioxx%' OR LOWER(m.name) LIKE '%premarin%' OR LOWER(m.name) LIKE '%humira%' OR
  EXISTS (
    SELECT 1 FROM UNNEST(m.tradeNames.list) AS tn
    WHERE LOWER(tn.element) LIKE '%keytruda%' OR LOWER(tn.element) LIKE '%vioxx%' OR LOWER(tn.element) LIKE '%premarin%' OR LOWER(tn.element) LIKE '%humira%'
  ) OR
  EXISTS (
    SELECT 1 FROM UNNEST(m.synonyms.list) AS s
    WHERE LOWER(s.element) LIKE '%keytruda%' OR LOWER(s.element) LIKE '%vioxx%' OR LOWER(s.element) LIKE '%premarin%' OR LOWER(s.element) LIKE '%humira%'
  )
)
LIMIT 100;
```

This query simplifies the previous conditions by removing the requirements for `isApproved = TRUE` and `blackBoxWarning = TRUE`. It uses the `LIKE` operator with wildcards to match any variations of the drug names in the `name`, `tradeNames`, and `synonyms` fields. This should return the drug ID, drug type, and withdrawal status for the specified drugs, even if the exact names vary slightly in the dataset.
2025-01-24 04:37:46 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 04:37:46 - root - INFO - SQL:
SELECT id, drugType, hasBeenWithdrawn
FROM `open-targets-prod.platform.molecule` AS m
WHERE (
  LOWER(m.name) LIKE '%keytruda%' OR LOWER(m.name) LIKE '%vioxx%' OR LOWER(m.name) LIKE '%premarin%' OR LOWER(m.name) LIKE '%humira%' OR
  EXISTS (
    SELECT 1 FROM UNNEST(m.tradeNames.list) AS tn
    WHERE LOWER(tn.element) LIKE '%keytruda%' OR LOWER(tn.element) LIKE '%vioxx%' OR LOWER(tn.element) LIKE '%premarin%' OR LOWER(tn.element) LIKE '%humira%'
  ) OR
  EXISTS (
    SELECT 1 FROM UNNEST(m.synonyms.list) AS s
    WHERE LOWER(s.element) LIKE '%keytruda%' OR LOWER(s.element) LIKE '%vioxx%' OR LOWER(s.element) LIKE '%premarin%' OR LOWER(s.element) LIKE '%humira%'
  )
)
LIMIT 100;
Results:
id,drugType,hasBeenWithdrawn
CHEMBL122,Small molecule,True
CHEMBL1201649,Unknown,False
CHEMBL3137343,Antibody,False
CHEMBL1201580,Antibody,False

2025-01-24 04:38:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 04:38:25 - root - INFO - ```sql
SELECT id, drugType, hasBeenWithdrawn
FROM `open-targets-prod.platform.molecule`
WHERE id IN ('CHEMBL122', 'CHEMBL1201649', 'CHEMBL3137343', 'CHEMBL1201580');
```
2025-01-24 04:39:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 04:39:30 - root - INFO - SQL:
SELECT id, drugType, hasBeenWithdrawn
FROM `open-targets-prod.platform.molecule`
WHERE id IN ('CHEMBL122', 'CHEMBL1201649', 'CHEMBL3137343', 'CHEMBL1201580');
Results:
id,drugType,hasBeenWithdrawn
CHEMBL122,Small molecule,True
CHEMBL1201649,Unknown,False
CHEMBL3137343,Antibody,False
CHEMBL1201580,Antibody,False

2025-01-24 04:39:32 - root - INFO - SQL:
-- Corrected Query 4
SELECT DISTINCT m.id, m.drugType, m.hasBeenWithdrawn
FROM `open-targets-prod.platform.molecule` AS m
WHERE m.id IN ('CHEMBL122', 'CHEMBL1201649', 'CHEMBL3137343', 'CHEMBL1201580')
LIMIT 100
Results:
id,drugType,hasBeenWithdrawn
CHEMBL122,Small molecule,True
CHEMBL1201649,Unknown,False
CHEMBL3137343,Antibody,False
CHEMBL1201580,Antibody,False

2025-01-24 04:39:33 - root - INFO - SQL:
-- Corrected Query 5
SELECT DISTINCT m.id, m.drugType, m.hasBeenWithdrawn
FROM `open-targets-prod.platform.molecule` AS m
WHERE m.id IN ('CHEMBL122', 'CHEMBL1201649', 'CHEMBL3137343', 'CHEMBL1201580')
LIMIT 100
Results:
id,drugType,hasBeenWithdrawn
CHEMBL122,Small molecule,True
CHEMBL1201649,Unknown,False
CHEMBL3137343,Antibody,False
CHEMBL1201580,Antibody,False

2025-01-24 04:39:34 - root - INFO - SQL:
-- Corrected Query 6
SELECT DISTINCT m.drugType
FROM `open-targets-prod.platform.molecule` AS m
WHERE m.id IN ('CHEMBL122', 'CHEMBL1201649', 'CHEMBL3137343', 'CHEMBL1201580')
LIMIT 100
Results:
drugType
Small molecule
Unknown
Antibody

2025-01-24 04:39:36 - root - INFO - SQL:
-- Corrected Query 7
SELECT m.*
FROM `open-targets-prod.platform.molecule` AS m
WHERE m.id IN ('CHEMBL122', 'CHEMBL1201649', 'CHEMBL3137343', 'CHEMBL1201580')
LIMIT 100
Results:
Too long, hard cut:
id,canonicalSmiles,inchiKey,drugType,blackBoxWarning,name,yearOfFirstApproval,maximumClinicalTrialPhase,parentId,hasBeenWithdrawn,isApproved,tradeNames,synonyms,crossReferences,childChemblIds,linkedDiseases,linkedTargets,description
CHEMBL122,CS(=O)(=O)c1ccc(C2=C(c3ccccc3)C(=O)OC2)cc1,RZJQGNCSTQAWON-UHFFFAOYSA-N,Small molecule,True,ROFECOXIB,1999,4.0,,True,True,{'list': [{'element': 'Vioxx'}]},"{'list': [{'element': 'M01AH02'}, {'element': 'MK-0966'}, {'element': 'MK-966'}, {'element': 'MK0966'}, {'element': 'NSC-720256'}, {'element': 'NSC-758705'}, {'element': 'Rofecoxib'}, {'element': 'TRM-201'}, {'element': 'TRM201'}]}","{'key_value': [{'key': 'PubChem', 'value': {'list': [{'element': '144204983'}, {'element': '174007305'}, {'element': '26748942'}, {'element': '49665949'}, {'element': '535364'}]}}, {'key': 'Wikipedia', 'value': {'list': [{'element': 'Rofecoxib'}]}}, {'key': 'drugbank', 'value': {'list': [{'element': 'DB00533'}]}}, {'key': 'chEBI', 'value': {'list': [{'element': '8887'}]}}]}","{'list': [{'element': 'CHEMBL5171570'}, {'element': 'CHEMBL4465601'}]}","{'rows': {'list': [{'element': 'EFO_0005755'}, {'element': 'MONDO_0005178'}, {'element': 'EFO_0003833'}, {'element': 'EFO_0005543'}, {'element': 'MONDO_0008315'}, {'element': 'EFO_0005406'}, {'element': 'EFO_0004616'}, {'element': 'EFO_0003843'}, {'element': 'EFO_0003897'}, {'element': 'EFO_1001951'}, {'element': 'EFO_0003060'}, {'element': 'MONDO_0004975'}, {'element': 'HP_0003040'}]}, 'count': 13}","{'rows': {'list': [{'element': 'ENSG00000073756'}]}, 'count': 1}",Small molecule drug with a maximum clinical trial phase of IV (across all indications) that was first approved in 1999 and is indicated for rheumatic disease and has 12 investigational indications. It was withdrawn in at least one region. This drug has a black box warning from the FDA.
CHEMBL1201649,,,Unknown,True,"ESTROGENS, CONJUGATED",1942,4.0,,False,True,"{'list': [{'element': 'Cenestin'}, {'element': 'Oestrogen'}, {'element': 'Premarin'}, {'element': 'Premarin Cream'}]}","{'list': [{'element': 'Conjugated estrogens'}, {'element': 'Estrogen, conjugated (class)'}, {'element': 'Estrogens conjugated'}, {'element': 'Estrogens, conjugated'}, {'element': 'Estrogens,conjugated'}, {'element': 'G03CA57'}, {'element': 'Oestrogens conjugated'}]}","{'key_value': [{'key': 'DailyMed', 'value': {'list': [{'element': 'estrogens,%20conjugated'}]}}, {'key': 'DrugCentral', 'value': {'list': [{'element': '4855'}]}}]}",,"{'rows': {'list': [{'element': 'HP_0000938'}, {'element': 'MONDO_0008315'}, {'element': 'GO_0042697'}, {'element': 'EFO_0000612'}, {'element': 'MONDO_0007915'}, {'element': 'EFO_0000712'}, {'element': 'MONDO_0004975'}, {'element': 'EFO_0004288'}, {'element': 'MONDO_0001410'}, {'element': 'EFO_0000400'}, {'element': 'EFO_0001072'}, {'element': 'EFO_1000781'}, {'element': 'HP_0030016'}, {'element': 'MONDO_0002146'}, {'element': 'HP_0031273'}, {'element': 'EFO_0000537'}, {'element': 'HP_0031217'}, {'element': 'MONDO_0043510'}, {'element': 'EFO_1000985'}, {'element': 'EFO_0001663'}, {'element': 'EFO_1001375'}, {'element': 'EFO_0002687'}, {'element': 'EFO_1000096'}, {'element': 'MONDO_0011962'}, {'element': 'EFO_0003869'}, {'element': 'EFO_0008507'}, {'element': 'MONDO_0000831'}, {'element': 'EFO_0001645'}, {'element': 'EFO_0003882'}, {'element': 'HP_0003124'}, {'element': 'MONDO_0007254'}, {'element': 'MONDO_0019499'}, {'element': 'EFO_0004266'}, {'element': 'MONDO_0005351'}, {'element': 'EFO_0003854'}]}, 'count': 35}","{'rows': {'list': [{'element': 'ENSG00000140009'}, {'element': 'ENSG00000091831'}]}, 'count': 2}",Unknown drug with a maximum clinical trial phase of IV (across all indications) that was first approved in 1942 and has 10 approved and 25 investigational indications. This drug has a black box warning from the FDA.
CHEMBL3137343,,,Antibody,False,PEMBROLIZUMAB,2014,4.0,,False,True,{'list': [{'element': 'Keytruda'}]},"{'list': [{'element': 'KEYLYNK-010 COMPONENT PEMBROLIZUMAB'}, {'element': 'Lambrolizumab'}, {'element': 'MK-3475'}, {'element': 'PEMBROLIZUMAB COMPONENT OF KEYLYNK-010'}, {'element': 'Pembrolizumab'}, {'element': 'SCH-900475'}]}","{'key_value': [{'key': 'DailyMed', 'value': {'list': [{'element': 'pembrolizumab'}]}}, {'key': 'DrugCentral', 'value': {'list': [{'element': '4924'}]}}, {'key': 'EMA', 'value': {'list': [{'element': 'https://www.ema.europa.eu/en/medicines/human/EPAR/keytruda'}]}}]}",,"{'rows': {'list': [{'element': 'EFO_1001471'}, {'element': 'EFO_0000588'}, {'element': 'EFO_0009708'}, {'element': 'EFO_0000673'}, {'element': 'EFO_0000707'}, {'element': 'MONDO_0003660'}, {'element': 'EFO_0000181'}, {'element': 'EFO_0005540'}, {'element': 'EFO_1001951'}, {'element': 'EFO_1000251'}, {'element': 'EFO_0000519'}, {'element': 'MONDO_0018531'}, {'element': 'MONDO_0005411'}, {'element': 'EFO_0000183'}, {'element': 'EFO_0000094'}, {'element': 'MONDO_0002108'}, {'element': 'MONDO_0002363'}, {'element': 'EFO_0003851'}, {'element': 'MONDO_0002120'}, {'element': 'MO

2025-01-24 04:39:37 - root - INFO - SQL:
-- Corrected Query 8
SELECT COUNT(DISTINCT m.id) AS num_drugs
FROM `open-targets-prod.platform.molecule` AS m
WHERE m.id IN ('CHEMBL122', 'CHEMBL1201649', 'CHEMBL3137343', 'CHEMBL1201580')
Results:
num_drugs
4

2025-01-24 04:39:38 - root - INFO - SQL:
-- Corrected Query 9
SELECT m.id, m.drugType, m.hasBeenWithdrawn, tn.element AS tradeName
FROM `open-targets-prod.platform.molecule` AS m
LEFT JOIN UNNEST(m.tradeNames.list) AS tn ON TRUE
WHERE m.id IN ('CHEMBL122', 'CHEMBL1201649', 'CHEMBL3137343', 'CHEMBL1201580')
LIMIT 100
Results:
id,drugType,hasBeenWithdrawn,tradeName
CHEMBL122,Small molecule,True,Vioxx
CHEMBL1201649,Unknown,False,Cenestin
CHEMBL1201649,Unknown,False,Oestrogen
CHEMBL1201649,Unknown,False,Premarin
CHEMBL1201649,Unknown,False,Premarin Cream
CHEMBL3137343,Antibody,False,Keytruda
CHEMBL1201580,Antibody,False,Amgevita
CHEMBL1201580,Antibody,False,Humira

2025-01-24 04:39:39 - root - INFO - SQL:
-- Corrected Query 10
SELECT m.id, m.drugType, m.hasBeenWithdrawn, s.element AS synonym
FROM `open-targets-prod.platform.molecule` AS m
LEFT JOIN UNNEST(m.synonyms.list) AS s ON TRUE
WHERE m.id IN ('CHEMBL122', 'CHEMBL1201649', 'CHEMBL3137343', 'CHEMBL1201580')
LIMIT 100
Results:
id,drugType,hasBeenWithdrawn,synonym
CHEMBL122,Small molecule,True,M01AH02
CHEMBL122,Small molecule,True,MK-0966
CHEMBL122,Small molecule,True,MK-966
CHEMBL122,Small molecule,True,MK0966
CHEMBL122,Small molecule,True,NSC-720256
CHEMBL122,Small molecule,True,NSC-758705
CHEMBL122,Small molecule,True,Rofecoxib
CHEMBL122,Small molecule,True,TRM-201
CHEMBL122,Small molecule,True,TRM201
CHEMBL1201649,Unknown,False,Conjugated estrogens
CHEMBL1201649,Unknown,False,"Estrogen, conjugated (class)"
CHEMBL1201649,Unknown,False,Estrogens conjugated
CHEMBL1201649,Unknown,False,"Estrogens, conjugated"
CHEMBL1201649,Unknown,False,"Estrogens,conjugated"
CHEMBL1201649,Unknown,False,G03CA57
CHEMBL1201649,Unknown,False,Oestrogens conjugated
CHEMBL3137343,Antibody,False,KEYLYNK-010 COMPONENT PEMBROLIZUMAB
CHEMBL3137343,Antibody,False,Lambrolizumab
CHEMBL3137343,Antibody,False,MK-3475
CHEMBL3137343,Antibody,False,PEMBROLIZUMAB COMPONENT OF KEYLYNK-010
CHEMBL3137343,Antibody,False,Pembrolizumab
CHEMBL3137343,Antibody,False,SCH-900475
CHEMBL1201580,Antibody,False,AVT-02
CHEMBL1201580,Antibody,False,Abp-501
CHEMBL1201580,Antibody,False,Abrilada
CHEMBL1201580,Antibody,False,Adalimumab
CHEMBL1201580,Antibody,False,Adalimumab (abbvie)
CHEMBL1201580,Antibody,False,Adalimumab (genetical recombination)
CHEMBL1201580,Antibody,False,Adalimumab (humira)
CHEMBL1201580,Antibody,False,Adalimumab aacf
CHEMBL1201580,Antibody,False,Adalimumab adaz
CHEMBL1201580,Antibody,False,Adalimumab adbm
CHEMBL1201580,Antibody,False,Adalimumab afzb
CHEMBL1201580,Antibody,False,Adalimumab aqvh
CHEMBL1201580,Antibody,False,Adalimumab atto
CHEMBL1201580,Antibody,False,Adalimumab beta
CHEMBL1201580,Antibody,False,Adalimumab biosimilar (alvotech)
CHEMBL1201580,Antibody,False,Adalimumab biosimilar (amgen)
CHEMBL1201580,Antibody,False,Adalimumab biosimilar (avt02)
CHEMBL1201580,Antibody,False,Adalimumab biosimilar (celltrion)
CHEMBL1201580,Antibody,False,Adalimumab biosimilar (ct-p17)
CHEMBL1201580,Antibody,False,Adalimumab biosimilar (fkb-327)
CHEMBL1201580,Antibody,False,Adalimumab biosimilar (msb11022)
CHEMBL1201580,Antibody,False,Adalimumab biosimilar (mylan)
CHEMBL1201580,Antibody,False,Adalimumab biosimilar (pfizer)
CHEMBL1201580,Antibody,False,Adalimumab biosimilar (sandoz)
CHEMBL1201580,Antibody,False,Adalimumab biosimilar (yusimry)

2025-01-24 04:39:41 - root - INFO - SQL:
-- Corrected Query 11
SELECT m.id, m.drugType, m.hasBeenWithdrawn, tn.element AS tradeName
FROM `open-targets-prod.platform.molecule` AS m
LEFT JOIN UNNEST(m.tradeNames.list) AS tn ON TRUE
WHERE m.id IN ('CHEMBL122', 'CHEMBL1201649', 'CHEMBL3137343', 'CHEMBL1201580')
LIMIT 100
Results:
id,drugType,hasBeenWithdrawn,tradeName
CHEMBL122,Small molecule,True,Vioxx
CHEMBL1201649,Unknown,False,Cenestin
CHEMBL1201649,Unknown,False,Oestrogen
CHEMBL1201649,Unknown,False,Premarin
CHEMBL1201649,Unknown,False,Premarin Cream
CHEMBL3137343,Antibody,False,Keytruda
CHEMBL1201580,Antibody,False,Amgevita
CHEMBL1201580,Antibody,False,Humira

2025-01-24 04:39:42 - root - INFO - SQL:
-- Corrected Query 12
SELECT m.id, m.drugType, m.hasBeenWithdrawn
FROM `open-targets-prod.platform.molecule` AS m
WHERE m.hasBeenWithdrawn = TRUE
  AND m.id = 'CHEMBL122'
LIMIT 100
Results:
id,drugType,hasBeenWithdrawn
CHEMBL122,Small molecule,True

2025-01-24 04:39:43 - root - INFO - SQL:
-- Corrected Query 13
SELECT m.id, m.drugType, m.hasBeenWithdrawn, s.element AS synonym
FROM `open-targets-prod.platform.molecule` AS m
LEFT JOIN UNNEST(m.synonyms.list) AS s ON TRUE
WHERE m.id = 'CHEMBL122'
LIMIT 100
Results:
id,drugType,hasBeenWithdrawn,synonym
CHEMBL122,Small molecule,True,M01AH02
CHEMBL122,Small molecule,True,MK-0966
CHEMBL122,Small molecule,True,MK-966
CHEMBL122,Small molecule,True,MK0966
CHEMBL122,Small molecule,True,NSC-720256
CHEMBL122,Small molecule,True,NSC-758705
CHEMBL122,Small molecule,True,Rofecoxib
CHEMBL122,Small molecule,True,TRM-201
CHEMBL122,Small molecule,True,TRM201

2025-01-24 04:39:44 - root - INFO - SQL:
-- Corrected Query 14
SELECT id, drugType, maximumClinicalTrialPhase
FROM `open-targets-prod.platform.molecule`
WHERE id IN ('CHEMBL122', 'CHEMBL1201649', 'CHEMBL3137343', 'CHEMBL1201580')
LIMIT 100
Results:
id,drugType,maximumClinicalTrialPhase
CHEMBL122,Small molecule,4.0
CHEMBL1201649,Unknown,4.0
CHEMBL3137343,Antibody,4.0
CHEMBL1201580,Antibody,4.0

2025-01-24 04:39:45 - root - INFO - SQL:
-- Corrected Query 15
SELECT id, drugType, yearOfFirstApproval
FROM `open-targets-prod.platform.molecule`
WHERE id IN ('CHEMBL122', 'CHEMBL1201649', 'CHEMBL3137343', 'CHEMBL1201580')
  AND yearOfFirstApproval IS NOT NULL
LIMIT 100
Results:
id,drugType,yearOfFirstApproval
CHEMBL122,Small molecule,1999
CHEMBL1201649,Unknown,1942
CHEMBL3137343,Antibody,2014
CHEMBL1201580,Antibody,2002

2025-01-24 04:39:47 - root - INFO - SQL:
-- Corrected Query 16
SELECT id, drugType, hasBeenWithdrawn
FROM `open-targets-prod.platform.molecule`
WHERE id IN ('CHEMBL122')
LIMIT 100
Results:
id,drugType,hasBeenWithdrawn
CHEMBL122,Small molecule,True

2025-01-24 04:39:48 - root - INFO - SQL:
-- Corrected Query 17
SELECT id, drugType, description
FROM `open-targets-prod.platform.molecule`
WHERE id IN ('CHEMBL122', 'CHEMBL1201649', 'CHEMBL3137343', 'CHEMBL1201580')
LIMIT 100
Results:
id,drugType,description
CHEMBL122,Small molecule,Small molecule drug with a maximum clinical trial phase of IV (across all indications) that was first approved in 1999 and is indicated for rheumatic disease and has 12 investigational indications. It was withdrawn in at least one region. This drug has a black box warning from the FDA.
CHEMBL1201649,Unknown,Unknown drug with a maximum clinical trial phase of IV (across all indications) that was first approved in 1942 and has 10 approved and 25 investigational indications. This drug has a black box warning from the FDA.
CHEMBL3137343,Antibody,Antibody drug with a maximum clinical trial phase of IV (across all indications) that was first approved in 2014 and has 22 approved and 161 investigational indications.
CHEMBL1201580,Antibody,Antibody drug with a maximum clinical trial phase of IV (across all indications) that was first approved in 2002 and has 9 approved and 23 investigational indications. This drug has a black box warning from the FDA.

2025-01-24 04:39:49 - root - INFO - SQL:
-- Corrected Query 18
SELECT id, drugType, hasBeenWithdrawn
FROM `open-targets-prod.platform.molecule`
WHERE hasBeenWithdrawn = TRUE
LIMIT 100
Results:
id,drugType,hasBeenWithdrawn
CHEMBL27193,Small molecule,True
CHEMBL2106829,Small molecule,True
CHEMBL2104793,Small molecule,True
CHEMBL1742471,Small molecule,True
CHEMBL3304486,Small molecule,True
CHEMBL1200903,Small molecule,True
CHEMBL1200695,Small molecule,True
CHEMBL1201535,Small molecule,True
CHEMBL1204165,Small molecule,True
CHEMBL3989556,Small molecule,True
CHEMBL2107495,Small molecule,True
CHEMBL4594242,Protein,True
CHEMBL2108139,Small molecule,True
CHEMBL3989830,Small molecule,True
CHEMBL61006,Small molecule,True
CHEMBL1963684,Protein,True
CHEMBL3989676,Small molecule,True
CHEMBL3989803,Small molecule,True
CHEMBL1200498,Small molecule,True
CHEMBL2109065,Protein,True
CHEMBL1863513,Small molecule,True
CHEMBL2105740,Small molecule,True
CHEMBL865,Small molecule,True
CHEMBL111,Small molecule,True
CHEMBL3142541,Small molecule,True
CHEMBL2107253,Small molecule,True
CHEMBL1200947,Small molecule,True
CHEMBL1788403,Small molecule,True
CHEMBL395110,Small molecule,True
CHEMBL1909285,Small molecule,True
CHEMBL515914,Small molecule,True
CHEMBL3187246,Small molecule,True
CHEMBL1712842,Small molecule,True
CHEMBL2355333,Small molecule,True
CHEMBL3188576,Small molecule,True
CHEMBL187709,Small molecule,True
CHEMBL13376,Small molecule,True
CHEMBL1256696,Small molecule,True
CHEMBL1334033,Small molecule,True
CHEMBL1200595,Small molecule,True
CHEMBL1256842,Small molecule,True
CHEMBL539770,Small molecule,True
CHEMBL1534525,Small molecule,True
CHEMBL1200393,Small molecule,True
CHEMBL1200549,Small molecule,True
CHEMBL404849,Small molecule,True
CHEMBL1568057,Small molecule,True
CHEMBL1364551,Small molecule,True
CHEMBL1887891,Small molecule,True
CHEMBL1255739,Small molecule,True
CHEMBL341812,Small molecule,True
CHEMBL16476,Small molecule,True
CHEMBL110691,Small molecule,True
CHEMBL2106155,Small molecule,True
CHEMBL1275,Small molecule,True
CHEMBL1200563,Small molecule,True
CHEMBL146095,Small molecule,True
CHEMBL3183453,Small molecule,True
CHEMBL1200779,Small molecule,True
CHEMBL1237104,Small molecule,True
CHEMBL1697856,Small molecule,True
CHEMBL1411979,Small molecule,True
CHEMBL232201,Small molecule,True
CHEMBL869,Small molecule,True

2025-01-24 04:39:49 - root - INFO - itercount: 0
2025-01-24 04:39:49 - root - INFO - Database Name: open-targets-prod
Schema Name: platform
DDL describes table information.
,0
table_name,pharmacogenomics
ddl,"CREATE TABLE `open-targets-prod.platform.pharmacogenomics`
(
  datasourceId STRING,
  datasourceVersion STRING,
  datatypeId STRING,
  directionality STRING,
  evidenceLevel STRING,
  genotype STRING,
  genotypeAnnotationText STRING,
  genotypeId STRING,
  haplotypeFromSourceId STRING,
  haplotypeId STRING,
  literature STRUCT<list ARRAY<STRUCT<element STRING>>>,
  pgxCategory STRING,
  phenotypeFromSourceId STRING,
  phenotypeText STRING,
  studyId STRING,
  targetFromSourceId STRING,
  variantFunctionalConsequenceId STRING,
  variantRsId STRING,
  isDirectTarget BOOL NOT NULL,
  drugs STRUCT<list ARRAY<STRUCT<element STRUCT<drugFromSource STRING, drugId STRING> NOT NULL>>> NOT NULL
);"

,1
table_name,interaction
ddl,"CREATE TABLE `open-targets-prod.platform.interaction`
(
  sourceDatabase STRING,
  targetA STRING,
  intA STRING,
  intABiologicalRole STRING,
  targetB STRING,
  intB STRING,
  intBBiologicalRole STRING,
  speciesA STRUCT<mnemonic STRING, scientific_name STRING, taxon_id INT64>,
  speciesB STRUCT<mnemonic STRING, scientific_name STRING, taxon_id INT64>,
  count INT64 NOT NULL,
  scoring FLOAT64
);"

,2
table_name,drugWarnings
ddl,"CREATE TABLE `open-targets-prod.platform.drugWarnings`
(
  chemblIds STRUCT<list ARRAY<STRUCT<element STRING>>>,
  toxicityClass STRING,
  country STRING,
  description STRING,
  id INT64,
  references STRUCT<list ARRAY<STRUCT<element STRUCT<ref_id STRING, ref_type STRING, ref_url STRING>>>>,
  warningType STRING,
  year INT64,
  efo_term STRING,
  efo_id STRING,
  efo_id_for_warning_class STRING
);"

,3
table_name,interactionEvidence
ddl,"CREATE TABLE `open-targets-prod.platform.interactionEvidence`
(
  hostOrganismTissue STRUCT<fullName STRING, shortName STRING, xrefs STRUCT<list ARRAY<STRUCT<element STRING>>>>,
  targetB STRING,
  evidenceScore FLOAT64,
  intBBiologicalRole STRING,
  interactionResources STRUCT<databaseVersion STRING, sourceDatabase STRING>,
  interactionTypeMiIdentifier STRING,
  interactionDetectionMethodShortName STRING,
  intA STRING,
  intBSource STRING,
  speciesB STRUCT<mnemonic STRING, scientificName STRING, taxonId INT64>,
  interactionIdentifier STRING,
  hostOrganismTaxId INT64,
  participantDetectionMethodA STRUCT<list ARRAY<STRUCT<element STRUCT<miIdentifier STRING, shortName STRING>>>>,
  expansionMethodShortName STRING,
  speciesA STRUCT<mnemonic STRING, scientificName STRING, taxonId INT64>,
  intASource STRING,
  intB STRING,
  pubmedId STRING,
  intABiologicalRole STRING,
  hostOrganismScientificName STRING,
  interactionScore FLOAT64,
  interactionTypeShortName STRING,
  expansionMethodMiIdentifier STRING,
  targetA STRING,
  participantDetectionMethodB STRUCT<list ARRAY<STRUCT<element STRUCT<miIdentifier STRING, shortName STRING>>>>,
  interactionDetectionMethodMiIdentifier STRING
);"

,4
table_name,mechanismOfAction
ddl,"CREATE TABLE `open-targets-prod.platform.mechanismOfAction`
(
  actionType STRING,
  mechanismOfAction STRING,
  chemblIds STRUCT<list ARRAY<STRUCT<element STRING>>>,
  targetName STRING,
  targetType STRING,
  targets STRUCT<list ARRAY<STRUCT<element STRING NOT NULL>>>,
  references STRUCT<list ARRAY<STRUCT<element STRUCT<source STRING, ids STRUCT<list ARRAY<STRUCT<element STRING NOT NULL>>> NOT NULL, urls STRUCT<list ARRAY<STRUCT<element STRING NOT NULL>>> NOT NULL> NOT NULL>>> NOT NULL
);"

,5
table_name,associationByDatasourceIndirect
ddl,"CREATE TABLE `open-targets-prod.platform.associationByDatasourceIndirect`
(
  datatypeId STRING,
  datasourceId STRING,
  diseaseId STRING,
  targetId STRING,
  score FLOAT64,
  evidenceCount INT64 NOT NULL
);"

,6
table_name,targetEssentiality
ddl,"CREATE TABLE `open-targets-prod.platform.targetEssentiality`
(
  id STRING,
  geneEssentiality STRUCT<list ARRAY<STRUCT<element STRUCT<depMapEssentiality STRUCT<list ARRAY<STRUCT<element STRUCT<screens STRUCT<list ARRAY<STRUCT<element STRUCT<cellLineName STRING, depmapId STRING, diseaseCellLineId STRING, diseaseFromSource STRING, expression FLOAT64, geneEffect FLOAT64, mutation STRING>>>>, tissueId STRING, tissueName STRING>>>>, isEssential BOOL> NOT NULL>>> NOT NULL
);"

,7
table_name,diseases
ddl,"CREATE TABLE `open-targets-prod.platform.diseases`
(
  id STRING,
  code STRING,
  dbXRefs STRUCT<list ARRAY<STRUCT<element STRING>>>,
  description STRING,
  name STRING,
  directLocationIds STRUCT<list ARRAY<STRUCT<element STRING>>>,
  obsoleteTerms STRUCT<list ARRAY<STRUCT<element STRING>>>,
  parents STRUCT<list ARRAY<STRUCT<element STRING>>>,
  synonyms STRUCT<hasBroadSynonym STRUCT<list ARRAY<STRUCT<element STRING>>>, hasExactSynonym STRUCT<list ARRAY<STRUCT<element STRING>>>, hasNarrowSynonym STRUCT<list ARRAY<STRUCT<element STRING>>>, hasRelatedSynonym STRUCT<list ARRAY<STRUCT<element STRING>>>>,
  ancestors STRUCT<list ARRAY<STRUCT<element STRING>>>,
  descendants STRUCT<list ARRAY<STRUCT<element STRING>>>,
  children STRUCT<list ARRAY<STRUCT<element STRING>>>,
  therapeuticAreas STRUCT<list ARRAY<STRUCT<element STRING>>>,
  indirectLocationIds STRUCT<list ARRAY<STRUCT<element STRING>>>,
  ontology STRUCT<isTherapeuticArea BOOL, leaf BOOL NOT NULL, sources STRUCT<url STRING, name STRING> NOT NULL> NOT NULL
);"

,8
table_name,knownDrugsAggregated
ddl,"CREATE TABLE `open-targets-prod.platform.knownDrugsAggregated`
(
  drugId STRING,
  targetId STRING,
  diseaseId STRING,
  phase FLOAT64,
  status STRING,
  urls STRUCT<list ARRAY<STRUCT<element STRUCT<niceName STRING, url STRING>>>> NOT NULL,
  ancestors STRUCT<list ARRAY<STRUCT<element STRING>>>,
  label STRING,
  approvedSymbol STRING,
  approvedName STRING,
  targetClass STRUCT<list ARRAY<STRUCT<element STRING>>>,
  prefName STRING,
  tradeNames STRUCT<list ARRAY<STRUCT<element STRING>>>,
  synonyms STRUCT<list ARRAY<STRUCT<element STRING>>>,
  drugType STRING,
  mechanismOfAction STRING,
  targetName STRING
);"

,9
table_name,targets
ddl,"CREATE TABLE `open-targets-prod.platform.targets`
(
  id STRING,
  approvedSymbol STRING,
  biotype STRING,
  transcriptIds STRUCT<list ARRAY<STRUCT<element STRING>>>,
  canonicalTranscript STRUCT<id STRING, chromosome STRING, start INT64, `end` INT64, strand STRING>,
  canonicalExons STRUCT<list ARRAY<STRUCT<element STRING>>>,
  genomicLocation STRUCT<chromosome STRING, start INT64, `end` INT64, strand INT64> NOT NULL,
  alternativeGenes STRUCT<list ARRAY<STRUCT<element STRING>>>,
  approvedName STRING NOT NULL,
  go STRUCT<list ARRAY<STRUCT<element STRUCT<id STRING, source STRING, evidence STRING, aspect STRING, geneProduct STRING, ecoId STRING>>>>,
  hallmarks STRUCT<attributes STRUCT<list ARRAY<STRUCT<element STRUCT<pmid INT64, description STRING, attribute_name STRING> NOT NULL>>>, cancerHallmarks STRUCT<list ARRAY<STRUCT<element STRUCT<pmid INT64, description STRING, impact STRING, label STRING> NOT NULL>>>>,
  synonyms STRUCT<list ARRAY<STRUCT<element STRUCT<label STRING, source STRING>>>> NOT NULL,
  symbolSynonyms STRUCT<list ARRAY<STRUCT<element STRUCT<label STRING, source STRING>>>> NOT NULL,
  nameSynonyms STRUCT<list ARRAY<STRUCT<element STRUCT<label STRING, source STRING>>>> NOT NULL,
  functionDescriptions STRUCT<list ARRAY<STRUCT<element STRING>>>,
  subcellularLocations STRUCT<list ARRAY<STRUCT<element STRUCT<location STRING, source STRING, termSL STRING, labelSL STRING>>>>,
  targetClass STRUCT<list ARRAY<STRUCT<element STRUCT<id INT64, label STRING, level STRING NOT NULL> NOT NULL>>>,
  obsoleteSymbols STRUCT<list ARRAY<STRUCT<element STRUCT<label STRING, source STRING>>>> NOT NULL,
  obsoleteNames STRUCT<list ARRAY<STRUCT<element STRUCT<label STRING, source STRING>>>> NOT NULL,
  constraint STRUCT<list ARRAY<STRUCT<element STRUCT<constraintType STRING NOT NULL, score FLOAT64, exp FLOAT64, obs INT64, oe FLOAT64, oeLower FLOAT64, oeUpper FLOAT64, upperRank INT64, upperBin INT64, upperBin6 INT64> NOT NULL>>>,
  tep STRUCT<targetFromSourceId STRING, description STRING, therapeuticArea STRING, url STRING>,
  proteinIds STRUCT<list ARRAY<STRUCT<element STRUCT<id STRING, source STRING> NOT NULL>>>,
  dbXrefs STRUCT<list ARRAY<STRUCT<element STRUCT<id STRING, source STRING>>>> NOT NULL,
  chemicalProbes STRUCT<list ARRAY<STRUCT<element STRUCT<control STRING, drugId STRING, id STRING, isHighQuality BOOL, mechanismOfAction STRUCT<list ARRAY<STRUCT<element STRING>>>, origin STRUCT<list ARRAY<STRUCT<element STRING>>>, probeMinerScore INT64, probesDrugsScore INT64, scoreInCells INT64, scoreInOrganisms INT64, targetFromSourceId STRING, urls STRUCT<list ARRAY<STRUCT<element STRUCT<niceName STRING, url STRING>>>>> NOT NULL>>>,
  homologues STRUCT<list ARRAY<STRUCT<element STRUCT<speciesId STRING, speciesName STRING, homologyType STRING, targetGeneId STRING, isHighConfidence STRING, targetGeneSymbol STRING, queryPercentageIdentity FLOAT64, targetPercentageIdentity FLOAT64, priority INT64> NOT NULL>>>,
  tractability STRUCT<list ARRAY<STRUCT<element STRUCT<modality STRING NOT NULL, id STRING NOT NULL, value BOOL NOT NULL> NOT NULL>>>,
  safetyLiabilities STRUCT<list ARRAY<STRUCT<element STRUCT<event STRING, eventId STRING, effects STRUCT<list ARRAY<STRUCT<element STRUCT<direction STRING, dosing STRING>>>>, biosamples STRUCT<list ARRAY<STRUCT<element STRUCT<cellFormat STRING, cellLabel STRING, tissueId STRING, tissueLabel STRING>>>>, datasource STRING, literature STRING, url STRING, studies STRUCT<list ARRAY<STRUCT<element STRUCT<description STRING, name STRING, type STRING>>>>> NOT NULL>>>,
  pathways STRUCT<list ARRAY<STRUCT<element STRUCT<pathwayId STRING, pathway STRING, topLevelTerm STRING> NOT NULL>>>
);"

,10
table_name,mousePhenotypes
ddl,"CREATE TABLE `open-targets-prod.platform.mousePhenotypes`
(
  biologicalModels STRUCT<list ARRAY<STRUCT<element STRUCT<allelicComposition STRING, geneticBackground STRING, id STRING, literature STRUCT<list ARRAY<STRUCT<element STRING>>>>>>>,
  modelPhenotypeClasses STRUCT<list ARRAY<STRUCT<element STRUCT<id STRING, label STRING>>>>,
  modelPhenotypeId STRING,
  modelPhenotypeLabel STRING,
  targetFromSourceId STRING,
  targetInModel STRING,
  targetInModelEnsemblId STRING,
  targetInModelMgiId STRING
);"

,11
table_name,associationByDatasourceDirect
ddl,"CREATE TABLE `open-targets-prod.platform.associationByDatasourceDirect`
(
  datatypeId STRING,
  datasourceId STRING,
  diseaseId STRING,
  targetId STRING,
  score FLOAT64,
  evidenceCount INT64 NOT NULL
);"

,12
table_name,associationByDatatypeIndirect
ddl,"CREATE TABLE `open-targets-prod.platform.associationByDatatypeIndirect`
(
  diseaseId STRING,
  targetId STRING,
  datatypeId STRING,
  score FLOAT64,
  evidenceCount INT64
);"

,13
table_name,ot_release
ddl,"CREATE TABLE `open-targets-prod.platform.ot_release`
(
  release STRING
);"

,14
table_name,indication
ddl,"CREATE TABLE `open-targets-prod.platform.indication`
(
  id STRING,
  indications STRUCT<list ARRAY<STRUCT<element STRUCT<disease STRING, efoName STRING, references STRUCT<list ARRAY<STRUCT<element STRUCT<source STRING, ids STRUCT<list ARRAY<STRUCT<element STRING>>> NOT NULL> NOT NULL>>> NOT NULL, maxPhaseForIndication FLOAT64> NOT NULL>>> NOT NULL,
  approvedIndications STRUCT<list ARRAY<STRUCT<element STRING NOT NULL>>> NOT NULL,
  indicationCount INT64 NOT NULL
);"

,15
table_name,go
ddl,"CREATE TABLE `open-targets-prod.platform.go`
(
  id STRING,
  name STRING
);"

,16
table_name,targetPrioritisation
ddl,"CREATE TABLE `open-targets-prod.platform.targetPrioritisation`
(
  targetId STRING,
  isInMembrane INT64,
  isSecreted INT64,
  hasSafetyEvent INT64,
  hasPocket INT64,
  hasLigand INT64,
  hasSmallMoleculeBinder INT64,
  geneticConstraint FLOAT64,
  paralogMaxIdentityPercentage FLOAT64,
  mouseOrthologMaxIdentityPercentage FLOAT64,
  isCancerDriverGene INT64,
  hasTEP INT64,
  mouseKOScore FLOAT64,
  hasHighQualityChemicalProbes INT64,
  maxClinicalTrialPhase FLOAT64,
  tissueSpecificity FLOAT64,
  tissueDistribution FLOAT64
);"

,17
table_name,associationByOverallIndirect
ddl,"CREATE TABLE `open-targets-prod.platform.associationByOverallIndirect`
(
  diseaseId STRING,
  targetId STRING,
  score FLOAT64,
  evidenceCount INT64
);"

,18
table_name,associationByDatatypeDirect
ddl,"CREATE TABLE `open-targets-prod.platform.associationByDatatypeDirect`
(
  diseaseId STRING,
  targetId STRING,
  datatypeId STRING,
  score FLOAT64,
  evidenceCount INT64
);"

,19
table_name,associationByOverallDirect
ddl,"CREATE TABLE `open-targets-prod.platform.associationByOverallDirect`
(
  diseaseId STRING,
  targetId STRING,
  score FLOAT64,
  evidenceCount INT64
);"

,20
table_name,diseaseToPhenotype
ddl,"CREATE TABLE `open-targets-prod.platform.diseaseToPhenotype`
(
  disease STRING,
  phenotype STRING,
  evidence STRUCT<list ARRAY<STRUCT<element STRUCT<aspect STRING, bioCuration STRING, diseaseFromSourceId STRING, diseaseFromSource STRING, diseaseName STRING, evidenceType STRING, frequency STRING, modifiers STRUCT<list ARRAY<STRUCT<element STRING>>>, onset STRUCT<list ARRAY<STRUCT<element STRING>>>, qualifier STRING, qualifierNot BOOL NOT NULL, references STRUCT<list ARRAY<STRUCT<element STRING>>>, sex STRING, resource STRING> NOT NULL>>> NOT NULL
);"

,21
table_name,evidence
ddl,"CREATE TABLE `open-targets-prod.platform.evidence`
(
  datasourceId STRING,
  targetId STRING,
  _corrupt_record STRING,
  alleleOrigins STRUCT<list ARRAY<STRUCT<element STRING>>>,
  allelicRequirements STRUCT<list ARRAY<STRUCT<element STRING>>>,
  ancestry STRING,
  ancestryId STRING,
  beta FLOAT64,
  betaConfidenceIntervalLower FLOAT64,
  betaConfidenceIntervalUpper FLOAT64,
  biologicalModelAllelicComposition STRING,
  biologicalModelGeneticBackground STRING,
  biologicalModelId STRING,
  biomarkerName STRING,
  biomarkers STRUCT<geneExpression STRUCT<list ARRAY<STRUCT<element STRUCT<id STRING, name STRING>>>>, variant STRUCT<list ARRAY<STRUCT<element STRUCT<functionalConsequenceId STRING, id STRING, name STRING>>>>>,
  biosamplesFromSource STRUCT<list ARRAY<STRUCT<element STRING>>>,
  cellType STRING,
  clinicalPhase FLOAT64,
  clinicalSignificances STRUCT<list ARRAY<STRUCT<element STRING>>>,
  clinicalStatus STRING,
  cohortDescription STRING,
  cohortId STRING,
  cohortPhenotypes STRUCT<list ARRAY<STRUCT<element STRING>>>,
  cohortShortName STRING,
  confidence STRING,
  contrast STRING,
  crisprScreenLibrary STRING,
  datatypeId STRING,
  diseaseCellLines STRUCT<list ARRAY<STRUCT<element STRUCT<id STRING, name STRING, tissue STRING, tissueId STRING>>>>,
  diseaseFromSource STRING,
  diseaseFromSourceId STRING,
  diseaseFromSourceMappedId STRING,
  diseaseModelAssociatedHumanPhenotypes STRUCT<list ARRAY<STRUCT<element STRUCT<id STRING, label STRING>>>>,
  diseaseModelAssociatedModelPhenotypes STRUCT<list ARRAY<STRUCT<element STRUCT<id STRING, label STRING>>>>,
  drugFromSource STRING,
  drugId STRING,
  drugResponse STRING,
  geneticBackground STRING,
  literature STRUCT<list ARRAY<STRUCT<element STRING>>>,
  log2FoldChangePercentileRank INT64,
  log2FoldChangeValue FLOAT64,
  mutatedSamples STRUCT<list ARRAY<STRUCT<element STRUCT<functionalConsequenceId STRING, numberMutatedSamples FLOAT64, numberSamplesTested FLOAT64, numberSamplesWithMutationType INT64>>>>,
  oddsRatio FLOAT64,
  oddsRatioConfidenceIntervalLower FLOAT64,
  oddsRatioConfidenceIntervalUpper FLOAT64,
  pValueExponent INT64,
  pValueMantissa FLOAT64,
  pathways STRUCT<list ARRAY<STRUCT<element STRUCT<id STRING, name STRING>>>>,
  pmcIds STRUCT<list ARRAY<STRUCT<element STRING>>>,
  projectId STRING,
  publicationFirstAuthor STRING,
  publicationYear INT64,
  reactionId STRING,
  reactionName STRING,
  releaseDate STRING,
  releaseVersion STRING,
  resourceScore FLOAT64,
  sex STRUCT<list ARRAY<STRUCT<element STRING>>>,
  significantDriverMethods STRUCT<list ARRAY<STRUCT<element STRING>>>,
  statisticalMethod STRING,
  statisticalMethodOverview STRING,
  statisticalTestTail STRING,
  studyCases INT64,
  studyCasesWithQualifyingVariants INT64,
  studyId STRING,
  studyOverview STRING,
  studySampleSize INT64,
  studyStartDate STRING,
  studyStopReason STRING,
  studyStopReasonCategories STRUCT<list ARRAY<STRUCT<element STRING>>>,
  targetFromSource STRING,
  targetFromSourceId STRING,
  targetInModel STRING,
  targetInModelEnsemblId STRING,
  targetInModelMgiId STRING,
  targetModulation STRING,
  textMiningSentences STRUCT<list ARRAY<STRUCT<element STRUCT<dEnd INT64, dStart INT64, section STRING, tEnd INT64, tStart INT64, text STRING>>>>,
  urls STRUCT<list ARRAY<STRUCT<element STRUCT<niceName STRING, url STRING>>>>,
  variantAminoacidDescriptions STRUCT<list ARRAY<STRUCT<element STRING>>>,
  variantFunctionalConsequenceFromQtlId STRING,
  variantFunctionalConsequenceId STRING,
  variantHgvsId STRING,
  variantId STRING,
  variantRsId STRING,
  diseaseId STRING,
  id STRING,
  score FLOAT64,
  variantEffect STRING,
  directionOnTrait STRING,
  sourceId STRING
);"

,22
table_name,reactome
ddl,"CREATE TABLE `open-targets-prod.platform.reactome`
(
  id STRING,
  label STRING,
  ancestors STRUCT<list ARRAY<STRUCT<element STRING>>>,
  descendants STRUCT<list ARRAY<STRUCT<element STRING>>>,
  children STRUCT<list ARRAY<STRUCT<element STRING>>>,
  parents STRUCT<list ARRAY<STRUCT<element STRING>>>,
  path STRUCT<list ARRAY<STRUCT<element STRUCT<list ARRAY<STRUCT<element STRING>>>>>>
);"

,23
table_name,significantAdverseDrugReactions
ddl,"CREATE TABLE `open-targets-prod.platform.significantAdverseDrugReactions`
(
  chembl_id STRING,
  event STRING,
  count INT64 NOT NULL,
  llr FLOAT64,
  critval FLOAT64,
  meddraCode STRING
);"

,24
table_name,molecule
ddl,"CREATE TABLE `open-targets-prod.platform.molecule`
(
  id STRING,
  canonicalSmiles STRING,
  inchiKey STRING,
  drugType STRING NOT NULL,
  blackBoxWarning BOOL,
  name STRING,
  yearOfFirstApproval INT64,
  maximumClinicalTrialPhase FLOAT64,
  parentId STRING,
  hasBeenWithdrawn BOOL,
  isApproved BOOL,
  tradeNames STRUCT<list ARRAY<STRUCT<element STRING>>> NOT NULL,
  synonyms STRUCT<list ARRAY<STRUCT<element STRING>>> NOT NULL,
  crossReferences STRUCT<key_value ARRAY<STRUCT<key STRING NOT NULL, value STRUCT<list ARRAY<STRUCT<element STRING>>>>>>,
  childChemblIds STRUCT<list ARRAY<STRUCT<element STRING NOT NULL>>>,
  linkedDiseases STRUCT<`rows` STRUCT<list ARRAY<STRUCT<element STRING>>> NOT NULL, count INT64 NOT NULL>,
  linkedTargets STRUCT<`rows` STRUCT<list ARRAY<STRUCT<element STRING NOT NULL>>> NOT NULL, count INT64 NOT NULL>,
  description STRING
);"

,25
table_name,baselineExpression
ddl,"CREATE TABLE `open-targets-prod.platform.baselineExpression`
(
  id STRING,
  tissues STRUCT<list ARRAY<STRUCT<element STRUCT<efo_code STRING, label STRING, organs STRUCT<list ARRAY<STRUCT<element STRING>>>, anatomical_systems STRUCT<list ARRAY<STRUCT<element STRING>>>, rna STRUCT<value FLOAT64, zscore INT64, level INT64, unit STRING> NOT NULL, protein STRUCT<reliability BOOL, level INT64, cell_type STRUCT<list ARRAY<STRUCT<element STRUCT<name STRING, reliability BOOL, level INT64> NOT NULL>>> NOT NULL> NOT NULL> NOT NULL>>> NOT NULL
);"

,26
table_name,hpo
ddl,"CREATE TABLE `open-targets-prod.platform.hpo`
(
  dbXRefs STRUCT<list ARRAY<STRUCT<element STRING>>>,
  description STRING,
  id STRING,
  name STRING,
  namespace STRUCT<list ARRAY<STRUCT<element STRING>>>,
  obsolete_terms STRUCT<list ARRAY<STRUCT<element STRING>>>,
  parents STRUCT<list ARRAY<STRUCT<element STRING>>>
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'open-targets-prod': {'platform': ['associationByDatasourceDirect', 'associationByDatasourceIndirect', 'associationByDatatypeDirect', 'associationByDatatypeIndirect', 'associationByOverallDirect', 'associationByOverallIndirect', 'baselineExpression', 'diseaseToPhenotype', 'diseases', 'drugWarnings', 'evidence', 'go', 'hpo', 'indication', 'interaction', 'interactionEvidence', 'knownDrugsAggregated', 'mechanismOfAction', 'molecule', 'mousePhenotypes', 'ot_release', 'pharmacogenomics', 'reactome', 'significantAdverseDrugReactions', 'targetEssentiality', 'targetPrioritisation', 'targets']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

Table: `open-targets-prod.platform.molecule`

- **id**: drug id (used to display the drug id)
- **drugType**: drug type (used to display the drug type)
- **hasBeenWithdrawn**: withdrawal status (used to display the withdrawal status)
- **isApproved**: indicates if the drug is approved (condition: approved drugs)
- **blackBoxWarning**: indicates if the drug has a black box warning (condition: drugs with a black box warning)
- **name**: primary drug name (used to match drug names)
- **tradeNames**: alternative drug names (nested field)
- **synonyms**: alternative drug names (nested field)

**Conditions:**

- `isApproved = TRUE` (to select approved drugs)
- `blackBoxWarning = TRUE` (to select drugs with a black box warning)
- Drug name matches one of 'Keytruda', 'Vioxx', 'Premarin', 'Humira' in `name`, `tradeNames`, or `synonyms`

---

**SQL Queries:**

1. **Select approved drugs with a black box warning:**
   ```sql
   SELECT id, drugType, hasBeenWithdrawn
   FROM `open-targets-prod.platform.molecule`
   WHERE isApproved = TRUE
     AND blackBoxWarning = TRUE
   LIMIT 100;
   ```

2. **Select drugs matching the specified names in the `name` field:**
   ```sql
   SELECT id, drugType, hasBeenWithdrawn
   FROM `open-targets-prod.platform.molecule`
   WHERE LOWER(name) IN ('keytruda', 'vioxx', 'premarin', 'humira')
   LIMIT 100;
   ```

3. **Select approved drugs matching the specified names in `tradeNames`:**
   ```sql
   SELECT id, drugType, hasBeenWithdrawn
   FROM `open-targets-prod.platform.molecule`,
   UNNEST(tradeNames.list) AS tn
   WHERE isApproved = TRUE
     AND LOWER(tn.element) IN ('keytruda', 'vioxx', 'premarin', 'humira')
   LIMIT 100;
   ```

4. **Select approved drugs matching the specified names in `synonyms`:**
   ```sql
   SELECT id, drugType, hasBeenWithdrawn
   FROM `open-targets-prod.platform.molecule`,
   UNNEST(synonyms.list) AS s
   WHERE isApproved = TRUE
     AND LOWER(s.element) IN ('keytruda', 'vioxx', 'premarin', 'humira')
   LIMIT 100;
   ```

5. **Select drugs with a black box warning matching specified names in `name`:**
   ```sql
   SELECT id, drugType, hasBeenWithdrawn
   FROM `open-targets-prod.platform.molecule`
   WHERE blackBoxWarning = TRUE
     AND LOWER(name) IN ('keytruda', 'vioxx', 'premarin', 'humira')
   LIMIT 100;
   ```

6. **Select approved drugs with a black box warning matching specified names in `name` or `tradeNames`:**
   ```sql
   SELECT DISTINCT m.id, m.drugType, m.hasBeenWithdrawn
   FROM `open-targets-prod.platform.molecule` AS m
   LEFT JOIN UNNEST(m.tradeNames.list) AS tn
   WHERE m.isApproved = TRUE
     AND m.blackBoxWarning = TRUE
     AND (LOWER(m.name) IN ('keytruda', 'vioxx', 'premarin', 'humira') OR LOWER(tn.element) IN ('keytruda', 'vioxx', 'premarin', 'humira'))
   LIMIT 100;
   ```

7. **Select approved drugs with a black box warning matching specified names in `name`, `tradeNames`, or `synonyms`:**
   ```sql
   SELECT DISTINCT m.id, m.drugType, m.hasBeenWithdrawn
   FROM `open-targets-prod.platform.molecule` AS m
   LEFT JOIN UNNEST(m.tradeNames.list) AS tn
   LEFT JOIN UNNEST(m.synonyms.list) AS s
   WHERE m.isApproved = TRUE
     AND m.blackBoxWarning = TRUE
     AND (
       LOWER(m.name) IN ('keytruda', 'vioxx', 'premarin', 'humira') OR
       LOWER(tn.element) IN ('keytruda', 'vioxx', 'premarin', 'humira') OR
       LOWER(s.element) IN ('keytruda', 'vioxx', 'premarin', 'humira')
     )
   LIMIT 100;
   ```

8. **Find all `drugType` values for the specified drugs:**
   ```sql
   SELECT DISTINCT m.drugType
   FROM `open-targets-prod.platform.molecule` AS m
   LEFT JOIN UNNEST(m.synonyms.list) AS s
   WHERE LOWER(m.name) IN ('keytruda', 'vioxx', 'premarin', 'humira')
     OR LOWER(s.element) IN ('keytruda', 'vioxx', 'premarin', 'humira')
   LIMIT 100;
   ```

9. **Get full information on the specified drugs:**
   ```sql
   SELECT m.*
   FROM `open-targets-prod.platform.molecule` AS m
   LEFT JOIN UNNEST(m.tradeNames.list) AS tn
   LEFT JOIN UNNEST(m.synonyms.list) AS s
   WHERE LOWER(m.name) IN ('keytruda', 'vioxx', 'premarin', 'humira')
     OR LOWER(tn.element) IN ('keytruda', 'vioxx', 'premarin', 'humira')
     OR LOWER(s.element) IN ('keytruda', 'vioxx', 'premarin', 'humira')
   LIMIT 100;
   ```

10. **Count the number of approved drugs with a black box warning matching the specified names:**
    ```sql
    SELECT COUNT(DISTINCT m.id) AS num_drugs
    FROM `open-targets-prod.platform.molecule` AS m
    LEFT JOIN UNNEST(m.tradeNames.list) AS tn
    LEFT JOIN UNNEST(m.synonyms.list) AS s
    WHERE m.isApproved = TRUE
      AND m.blackBoxWarning = TRUE
      AND (
        LOWER(m.name) IN ('keytruda', 'vioxx', 'premarin', 'humira') OR
        LOWER(tn.element) IN ('keytruda', 'vioxx', 'premarin', 'humira') OR
        LOWER(s.element) IN ('keytruda', 'vioxx', 'premarin', 'humira')
      );
    ```

11. **Select drugs with their trade names matching the specified names:**
    ```sql
    SELECT m.id, m.drugType, m.hasBeenWithdrawn, tn.element AS tradeName
    FROM `open-targets-prod.platform.molecule` AS m
    JOIN UNNEST(m.tradeNames.list) AS tn
    WHERE LOWER(tn.element) IN ('keytruda', 'vioxx', 'premarin', 'humira')
    LIMIT 100;
    ```

12. **Select drugs where any synonyms match the specified names:**
    ```sql
    SELECT m.id, m.drugType, m.hasBeenWithdrawn, s.element AS synonym
    FROM `open-targets-prod.platform.molecule` AS m
    JOIN UNNEST(m.synonyms.list) AS s
    WHERE LOWER(s.element) IN ('keytruda', 'vioxx', 'premarin', 'humira')
    LIMIT 100;
    ```

13. **Select approved drugs with black box warning and list all their trade names:**
    ```sql
    SELECT m.id, m.drugType, m.hasBeenWithdrawn, tn.element AS tradeName
    FROM `open-targets-prod.platform.molecule` AS m
    JOIN UNNEST(m.tradeNames.list) AS tn
    WHERE m.isApproved = TRUE
      AND m.blackBoxWarning = TRUE
    LIMIT 100;
    ```

14. **Find drugs that have been withdrawn and match the specified names:**
    ```sql
    SELECT m.id, m.drugType, m.hasBeenWithdrawn
    FROM `open-targets-prod.platform.molecule` AS m
    WHERE m.hasBeenWithdrawn = TRUE
      AND LOWER(m.name) IN ('keytruda', 'vioxx', 'premarin', 'humira')
    LIMIT 100;
    ```

15. **Select drugs with black box warnings and display their synonyms:**
    ```sql
    SELECT m.id, m.drugType, m.hasBeenWithdrawn, s.element AS synonym
    FROM `open-targets-prod.platform.molecule` AS m
    JOIN UNNEST(m.synonyms.list) AS s
    WHERE m.blackBoxWarning = TRUE
    LIMIT 100;
    ```

16. **List all approved drugs with their maximum clinical trial phase:**
    ```sql
    SELECT id, drugType, maximumClinicalTrialPhase
    FROM `open-targets-prod.platform.molecule`
    WHERE isApproved = TRUE
    LIMIT 100;
    ```

17. **Select drugs approved in a specific year (e.g., 2015):**
    ```sql
    SELECT id, drugType, yearOfFirstApproval
    FROM `open-targets-prod.platform.molecule`
    WHERE yearOfFirstApproval = 2015
    LIMIT 100;
    ```

18. **Find drugs with a black box warning that are not approved:**
    ```sql
    SELECT id, drugType, hasBeenWithdrawn
    FROM `open-targets-prod.platform.molecule`
    WHERE isApproved = FALSE
      AND blackBoxWarning = TRUE
    LIMIT 100;
    ```

19. **Select drugs with their description matching keywords (e.g., 'cancer'):**
    ```sql
    SELECT id, drugType, description
    FROM `open-targets-prod.platform.molecule`
    WHERE LOWER(description) LIKE '%cancer%'
    LIMIT 100;
    ```

20. **List all drug IDs and types for drugs that have been withdrawn:**
    ```sql
    SELECT id, drugType, hasBeenWithdrawn
    FROM `open-targets-prod.platform.molecule`
    WHERE hasBeenWithdrawn = TRUE
    LIMIT 100;
    ```

These queries explore various aspects of the `molecule` table to understand the data related to approved drugs with a black box warning and known drug types among 'Keytruda', 'Vioxx', 'Premarin', and 'Humira'.Query:
SELECT id, drugType, hasBeenWithdrawn
   FROM `open-targets-prod.platform.molecule`
   WHERE isApproved = TRUE
     AND blackBoxWarning = TRUE
   LIMIT 100;
Answer:
id,drugType,hasBeenWithdrawn
CHEMBL1237122,Small molecule,False
CHEMBL3989520,Small molecule,False
CHEMBL3989509,Small molecule,False
CHEMBL3989824,Small molecule,False
CHEMBL1201486,Small molecule,False
CHEMBL1200463,Small molecule,False
CHEMBL1187417,Small molecule,False
CHEMBL1201485,Unknown,False
CHEMBL2218913,Protein,False
CHEMBL2108448,Oligosaccharide,False
CHEMBL5315048,Protein,False
CHEMBL1963684,Protein,True
CHEMBL1201159,Small molecule,False
CHEMBL5314649,Small molecule,False
CHEMBL1201544,Unknown,False
CHEMBL3989861,Small molecule,False
CHEMBL3989522,Small molecule,False
CHEMBL1753,Small molecule,False
CHEMBL1204187,Small molecule,False
CHEMBL3989973,Small molecule,False
CHEMBL4802239,Small molecule,False
CHEMBL3833353,Protein,False
CHEMBL2108035,Unknown,False
CHEMBL1200475,Small molecule,False
CHEMBL2364649,Antibody,False
CHEMBL3039540,Antibody,False
CHEMBL3989751,Unknown,False
CHEMBL3989843,Small molecule,False
CHEMBL1200850,Small molecule,False
CHEMBL3085504,Small molecule,False
CHEMBL100116,Small molecule,False
CHEMBL2364623,Small molecule,False
CHEMBL3989564,Small molecule,False
CHEMBL1201289,Small molecule,False
CHEMBL5095051,Small molecule,False
CHEMBL2108508,Protein,False
CHEMBL2105709,Small molecule,False
CHEMBL5314379,Protein,False
CHEMBL2107841,Protein,False
CHEMBL4297839,Protein,False
CHEMBL1201557,Protein,False
CHEMBL3301574,Cell,False
CHEMBL4594320,Enzyme,False
CHEMBL5315119,Small molecule,False
CHEMBL3707358,Enzyme,False
CHEMBL5315125,Small molecule,False
CHEMBL3137358,Small molecule,False
CHEMBL3989989,Gene,False
CHEMBL4297862,Protein,False
CHEMBL2108667,Antibody drug conjugate,False
CHEMBL3301589,Antibody drug conjugate,False
CHEMBL4298209,Antibody drug conjugate,False
CHEMBL4298211,Protein,False
CHEMBL4594505,Antibody,False
CHEMBL4066936,Small molecule,False
CHEMBL2303621,Small molecule,False
CHEMBL1533310,Small molecule,False
CHEMBL865,Small molecule,True
CHEMBL427,Small molecule,False
CHEMBL535,Small molecule,False
CHEMBL41355,Small molecule,False
CHEMBL3655081,Small molecule,False
CHEMBL2105720,Small molecule,False
CHEMBL4065616,Small molecule,False
CHEMBL231813,Protein,False
Query:
SELECT id, drugType, hasBeenWithdrawn
FROM `open-targets-prod.platform.molecule` AS m
LEFT JOIN UNNEST(m.tradeNames.list) AS tn
LEFT JOIN UNNEST(m.synonyms.list) AS s
WHERE m.isApproved = TRUE
  AND (
    LOWER(m.name) IN ('keytruda', 'vioxx', 'premarin', 'humira') OR
    LOWER(tn.element) IN ('keytruda', 'vioxx', 'premarin', 'humira') OR
    LOWER(s.element) IN ('keytruda', 'vioxx', 'premarin', 'humira')
  )
LIMIT 100;
Answer:
id,drugType,hasBeenWithdrawn
CHEMBL122,Small molecule,True
CHEMBL122,Small molecule,True
CHEMBL122,Small molecule,True
CHEMBL122,Small molecule,True
CHEMBL122,Small molecule,True
CHEMBL122,Small molecule,True
CHEMBL122,Small molecule,True
CHEMBL122,Small molecule,True
CHEMBL122,Small molecule,True
CHEMBL1201649,Unknown,False
CHEMBL1201649,Unknown,False
CHEMBL1201649,Unknown,False
CHEMBL1201649,Unknown,False
CHEMBL1201649,Unknown,False
CHEMBL1201649,Unknown,False
CHEMBL1201649,Unknown,False
CHEMBL3137343,Antibody,False
CHEMBL3137343,Antibody,False
CHEMBL3137343,Antibody,False
CHEMBL3137343,Antibody,False
CHEMBL3137343,Antibody,False
CHEMBL3137343,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
CHEMBL1201580,Antibody,False
Query:
-- Corrected Query 1
SELECT m.id, m.drugType, m.hasBeenWithdrawn
FROM `open-targets-prod.platform.molecule` AS m
JOIN UNNEST(m.tradeNames.list) AS tn
WHERE m.isApproved = TRUE
  AND LOWER(tn.element) IN ('keytruda', 'vioxx', 'premarin', 'humira')
LIMIT 100
Answer:
id,drugType,hasBeenWithdrawn
CHEMBL122,Small molecule,True
CHEMBL1201649,Unknown,False
CHEMBL3137343,Antibody,False
CHEMBL1201580,Antibody,False
Query:
SELECT id, drugType, hasBeenWithdrawn
FROM `open-targets-prod.platform.molecule` AS m
WHERE (
  LOWER(m.name) LIKE '%keytruda%' OR LOWER(m.name) LIKE '%vioxx%' OR LOWER(m.name) LIKE '%premarin%' OR LOWER(m.name) LIKE '%humira%' OR
  EXISTS (
    SELECT 1 FROM UNNEST(m.tradeNames.list) AS tn
    WHERE LOWER(tn.element) LIKE '%keytruda%' OR LOWER(tn.element) LIKE '%vioxx%' OR LOWER(tn.element) LIKE '%premarin%' OR LOWER(tn.element) LIKE '%humira%'
  ) OR
  EXISTS (
    SELECT 1 FROM UNNEST(m.synonyms.list) AS s
    WHERE LOWER(s.element) LIKE '%keytruda%' OR LOWER(s.element) LIKE '%vioxx%' OR LOWER(s.element) LIKE '%premarin%' OR LOWER(s.element) LIKE '%humira%'
  )
)
LIMIT 100;
Answer:
id,drugType,hasBeenWithdrawn
CHEMBL122,Small molecule,True
CHEMBL1201649,Unknown,False
CHEMBL3137343,Antibody,False
CHEMBL1201580,Antibody,False
Query:
SELECT id, drugType, hasBeenWithdrawn
FROM `open-targets-prod.platform.molecule`
WHERE id IN ('CHEMBL122', 'CHEMBL1201649', 'CHEMBL3137343', 'CHEMBL1201580');
Answer:
id,drugType,hasBeenWithdrawn
CHEMBL122,Small molecule,True
CHEMBL1201649,Unknown,False
CHEMBL3137343,Antibody,False
CHEMBL1201580,Antibody,False
Query:
-- Corrected Query 4
SELECT DISTINCT m.id, m.drugType, m.hasBeenWithdrawn
FROM `open-targets-prod.platform.molecule` AS m
WHERE m.id IN ('CHEMBL122', 'CHEMBL1201649', 'CHEMBL3137343', 'CHEMBL1201580')
LIMIT 100
Answer:
id,drugType,hasBeenWithdrawn
CHEMBL122,Small molecule,True
CHEMBL1201649,Unknown,False
CHEMBL3137343,Antibody,False
CHEMBL1201580,Antibody,False
Query:
-- Corrected Query 5
SELECT DISTINCT m.id, m.drugType, m.hasBeenWithdrawn
FROM `open-targets-prod.platform.molecule` AS m
WHERE m.id IN ('CHEMBL122', 'CHEMBL1201649', 'CHEMBL3137343', 'CHEMBL1201580')
LIMIT 100
Answer:
id,drugType,hasBeenWithdrawn
CHEMBL122,Small molecule,True
CHEMBL1201649,Unknown,False
CHEMBL3137343,Antibody,False
CHEMBL1201580,Antibody,False
Query:
-- Corrected Query 6
SELECT DISTINCT m.drugType
FROM `open-targets-prod.platform.molecule` AS m
WHERE m.id IN ('CHEMBL122', 'CHEMBL1201649', 'CHEMBL3137343', 'CHEMBL1201580')
LIMIT 100
Answer:
drugType
Small molecule
Unknown
Antibody
Query:
-- Corrected Query 7
SELECT m.*
FROM `open-targets-prod.platform.molecule` AS m
WHERE m.id IN ('CHEMBL122', 'CHEMBL1201649', 'CHEMBL3137343', 'CHEMBL1201580')
LIMIT 100
Answer:
Too long, hard cut:
id,canonicalSmiles,inchiKey,drugType,blackBoxWarning,name,yearOfFirstApproval,maximumClinicalTrialPhase,parentId,hasBeenWithdrawn,isApproved,tradeNames,synonyms,crossReferences,childChemblIds,linkedDiseases,linkedTargets,description
CHEMBL122,CS(=O)(=O)c1ccc(C2=C(c3ccccc3)C(=O)OC2)cc1,RZJQGNCSTQAWON-UHFFFAOYSA-N,Small molecule,True,ROFECOXIB,1999,4.0,,True,True,{'list': [{'element': 'Vioxx'}]},"{'list': [{'element': 'M01AH02'}, {'element': 'MK-0966'}, {'element': 'MK-966'}, {'element': 'MK0966'}, {'element': 'NSC-720256'}, {'element': 'NSC-758705'}, {'element': 'Rofecoxib'}, {'element': 'TRM-201'}, {'element': 'TRM201'}]}","{'key_value': [{'key': 'PubChem', 'value': {'list': [{'element': '144204983'}, {'element': '174007305'}, {'element': '26748942'}, {'element': '49665949'}, {'element': '535364'}]}}, {'key': 'Wikipedia', 'value': {'list': [{'element': 'Rofecoxib'}]}}, {'key': 'drugbank', 'value': {'list': [{'element': 'DB00533'}]}}, {'key': 'chEBI', 'value': {'list': [{'element': '8887'}]}}]}","{'list': [{'element': 'CHEMBL5171570'}, {'element': 'CHEMBL4465601'}]}","{'rows': {'list': [{'element': 'EFO_0005755'}, {'element': 'MONDO_0005178'}, {'element': 'EFO_0003833'}, {'element': 'EFO_0005543'}, {'element': 'MONDO_0008315'}, {'element': 'EFO_0005406'}, {'element': 'EFO_0004616'}, {'element': 'EFO_0003843'}, {'element': 'EFO_0003897'}, {'element': 'EFO_1001951'}, {'element': 'EFO_0003060'}, {'element': 'MONDO_0004975'}, {'element': 'HP_0003040'}]}, 'count': 13}","{'rows': {'list': [{'element': 'ENSG00000073756'}]}, 'count': 1}",Small molecule drug with a maximum clinical trial phase of IV (across all indications) that was first approved in 1999 and is indicated for rheumatic disease and has 12 investigational indications. It was withdrawn in at least one region. This drug has a black box warning from the FDA.
CHEMBL1201649,,,Unknown,True,"ESTROGENS, CONJUGATED",1942,4.0,,False,True,"{'list': [{'element': 'Cenestin'}, {'element': 'Oestrogen'}, {'element': 'Premarin'}, {'element': 'Premarin Cream'}]}","{'list': [{'element': 'Conjugated estrogens'}, {'element': 'Estrogen, conjugated (class)'}, {'element': 'Estrogens conjugated'}, {'element': 'Estrogens, conjugated'}, {'element': 'Estrogens,conjugated'}, {'element': 'G03CA57'}, {'element': 'Oestrogens conjugated'}]}","{'key_value': [{'key': 'DailyMed', 'value': {'list': [{'element': 'estrogens,%20conjugated'}]}}, {'key': 'DrugCentral', 'value': {'list': [{'element': '4855'}]}}]}",,"{'rows': {'list': [{'element': 'HP_0000938'}, {'element': 'MONDO_0008315'}, {'element': 'GO_0042697'}, {'element': 'EFO_0000612'}, {'element': 'MONDO_0007915'}, {'element': 'EFO_0000712'}, {'element': 'MONDO_0004975'}, {'element': 'EFO_0004288'}, {'element': 'MONDO_0001410'}, {'element': 'EFO_0000400'}, {'element': 'EFO_0001072'}, {'element': 'EFO_1000781'}, {'element': 'HP_0030016'}, {'element': 'MONDO_0002146'}, {'element': 'HP_0031273'}, {'element': 'EFO_0000537'}, {'element': 'HP_0031217'}, {'element': 'MONDO_0043510'}, {'element': 'EFO_1000985'}, {'element': 'EFO_0001663'}, {'element': 'EFO_1001375'}, {'element': 'EFO_0002687'}, {'element': 'EFO_1000096'}, {'element': 'MONDO_0011962'}, {'element': 'EFO_0003869'}, {'element': 'EFO_0008507'}, {'element': 'MONDO_0000831'}, {'element': 'EFO_0001645'}, {'element': 'EFO_0003882'}, {'element': 'HP_0003124'}, {'element': 'MONDO_0007254'}, {'element': 'MONDO_0019499'}, {'element': 'EFO_0004266'}, {'element': 'MONDO_0005351'}, {'element': 'EFO_0003854'}]}, 'count': 35}","{'rows': {'list': [{'element': 'ENSG00000140009'}, {'element': 'ENSG00000091831'}]}, 'count': 2}",Unknown drug with a maximum clinical trial phase of IV (across all indications) that was first approved in 1942 and has 10 approved and 25 investigational indications. This drug has a black box warning from the FDA.
CHEMBL3137343,,,Antibody,False,PEMBROLIZUMAB,2014,4.0,,False,True,{'list': [{'element': 'Keytruda'}]},"{'list': [{'element': 'KEYLYNK-010 COMPONENT PEMBROLIZUMAB'}, {'element': 'Lambrolizumab'}, {'element': 'MK-3475'}, {'element': 'PEMBROLIZUMAB COMPONENT OF KEYLYNK-010'}, {'element': 'Pembrolizumab'}, {'element': 'SCH-900475'}]}","{'key_value': [{'key': 'DailyMed', 'value': {'list': [{'element': 'pembrolizumab'}]}}, {'key': 'DrugCentral', 'value': {'list': [{'element': '4924'}]}}, {'key': 'EMA', 'value': {'list': [{'element': 'https://www.ema.europa.eu/en/medicines/human/EPAR/keytruda'}]}}]}",,"{'rows': {'list': [{'element': 'EFO_1001471'}, {'element': 'EFO_0000588'}, {'element': 'EFO_0009708'}, {'element': 'EFO_0000673'}, {'element': 'EFO_0000707'}, {'element': 'MONDO_0003660'}, {'element': 'EFO_0000181'}, {'element': 'EFO_0005540'}, {'element': 'EFO_1001951'}, {'element': 'EFO_1000251'}, {'element': 'EFO_0000519'}, {'element': 'MONDO_0018531'}, {'element': 'MONDO_0005411'}, {'element': 'EFO_0000183'}, {'element': 'EFO_0000094'}, {'element': 'MONDO_0002108'}, {'element': 'MONDO_0002363'}, {'element': 'EFO_0003851'}, {'element': 'MONDO_0002120'}, {'element': 'MO
Query:
-- Corrected Query 8
SELECT COUNT(DISTINCT m.id) AS num_drugs
FROM `open-targets-prod.platform.molecule` AS m
WHERE m.id IN ('CHEMBL122', 'CHEMBL1201649', 'CHEMBL3137343', 'CHEMBL1201580')
Answer:
num_drugs
4
Query:
-- Corrected Query 9
SELECT m.id, m.drugType, m.hasBeenWithdrawn, tn.element AS tradeName
FROM `open-targets-prod.platform.molecule` AS m
LEFT JOIN UNNEST(m.tradeNames.list) AS tn ON TRUE
WHERE m.id IN ('CHEMBL122', 'CHEMBL1201649', 'CHEMBL3137343', 'CHEMBL1201580')
LIMIT 100
Answer:
id,drugType,hasBeenWithdrawn,tradeName
CHEMBL122,Small molecule,True,Vioxx
CHEMBL1201649,Unknown,False,Cenestin
CHEMBL1201649,Unknown,False,Oestrogen
CHEMBL1201649,Unknown,False,Premarin
CHEMBL1201649,Unknown,False,Premarin Cream
CHEMBL3137343,Antibody,False,Keytruda
CHEMBL1201580,Antibody,False,Amgevita
CHEMBL1201580,Antibody,False,Humira
Query:
-- Corrected Query 10
SELECT m.id, m.drugType, m.hasBeenWithdrawn, s.element AS synonym
FROM `open-targets-prod.platform.molecule` AS m
LEFT JOIN UNNEST(m.synonyms.list) AS s ON TRUE
WHERE m.id IN ('CHEMBL122', 'CHEMBL1201649', 'CHEMBL3137343', 'CHEMBL1201580')
LIMIT 100
Answer:
id,drugType,hasBeenWithdrawn,synonym
CHEMBL122,Small molecule,True,M01AH02
CHEMBL122,Small molecule,True,MK-0966
CHEMBL122,Small molecule,True,MK-966
CHEMBL122,Small molecule,True,MK0966
CHEMBL122,Small molecule,True,NSC-720256
CHEMBL122,Small molecule,True,NSC-758705
CHEMBL122,Small molecule,True,Rofecoxib
CHEMBL122,Small molecule,True,TRM-201
CHEMBL122,Small molecule,True,TRM201
CHEMBL1201649,Unknown,False,Conjugated estrogens
CHEMBL1201649,Unknown,False,"Estrogen, conjugated (class)"
CHEMBL1201649,Unknown,False,Estrogens conjugated
CHEMBL1201649,Unknown,False,"Estrogens, conjugated"
CHEMBL1201649,Unknown,False,"Estrogens,conjugated"
CHEMBL1201649,Unknown,False,G03CA57
CHEMBL1201649,Unknown,False,Oestrogens conjugated
CHEMBL3137343,Antibody,False,KEYLYNK-010 COMPONENT PEMBROLIZUMAB
CHEMBL3137343,Antibody,False,Lambrolizumab
CHEMBL3137343,Antibody,False,MK-3475
CHEMBL3137343,Antibody,False,PEMBROLIZUMAB COMPONENT OF KEYLYNK-010
CHEMBL3137343,Antibody,False,Pembrolizumab
CHEMBL3137343,Antibody,False,SCH-900475
CHEMBL1201580,Antibody,False,AVT-02
CHEMBL1201580,Antibody,False,Abp-501
CHEMBL1201580,Antibody,False,Abrilada
CHEMBL1201580,Antibody,False,Adalimumab
CHEMBL1201580,Antibody,False,Adalimumab (abbvie)
CHEMBL1201580,Antibody,False,Adalimumab (genetical recombination)
CHEMBL1201580,Antibody,False,Adalimumab (humira)
CHEMBL1201580,Antibody,False,Adalimumab aacf
CHEMBL1201580,Antibody,False,Adalimumab adaz
CHEMBL1201580,Antibody,False,Adalimumab adbm
CHEMBL1201580,Antibody,False,Adalimumab afzb
CHEMBL1201580,Antibody,False,Adalimumab aqvh
CHEMBL1201580,Antibody,False,Adalimumab atto
CHEMBL1201580,Antibody,False,Adalimumab beta
CHEMBL1201580,Antibody,False,Adalimumab biosimilar (alvotech)
CHEMBL1201580,Antibody,False,Adalimumab biosimilar (amgen)
CHEMBL1201580,Antibody,False,Adalimumab biosimilar (avt02)
CHEMBL1201580,Antibody,False,Adalimumab biosimilar (celltrion)
CHEMBL1201580,Antibody,False,Adalimumab biosimilar (ct-p17)
CHEMBL1201580,Antibody,False,Adalimumab biosimilar (fkb-327)
CHEMBL1201580,Antibody,False,Adalimumab biosimilar (msb11022)
CHEMBL1201580,Antibody,False,Adalimumab biosimilar (mylan)
CHEMBL1201580,Antibody,False,Adalimumab biosimilar (pfizer)
CHEMBL1201580,Antibody,False,Adalimumab biosimilar (sandoz)
CHEMBL1201580,Antibody,False,Adalimumab biosimilar (yusimry)
Query:
-- Corrected Query 11
SELECT m.id, m.drugType, m.hasBeenWithdrawn, tn.element AS tradeName
FROM `open-targets-prod.platform.molecule` AS m
LEFT JOIN UNNEST(m.tradeNames.list) AS tn ON TRUE
WHERE m.id IN ('CHEMBL122', 'CHEMBL1201649', 'CHEMBL3137343', 'CHEMBL1201580')
LIMIT 100
Answer:
id,drugType,hasBeenWithdrawn,tradeName
CHEMBL122,Small molecule,True,Vioxx
CHEMBL1201649,Unknown,False,Cenestin
CHEMBL1201649,Unknown,False,Oestrogen
CHEMBL1201649,Unknown,False,Premarin
CHEMBL1201649,Unknown,False,Premarin Cream
CHEMBL3137343,Antibody,False,Keytruda
CHEMBL1201580,Antibody,False,Amgevita
CHEMBL1201580,Antibody,False,Humira
Query:
-- Corrected Query 12
SELECT m.id, m.drugType, m.hasBeenWithdrawn
FROM `open-targets-prod.platform.molecule` AS m
WHERE m.hasBeenWithdrawn = TRUE
  AND m.id = 'CHEMBL122'
LIMIT 100
Answer:
id,drugType,hasBeenWithdrawn
CHEMBL122,Small molecule,True
Query:
-- Corrected Query 13
SELECT m.id, m.drugType, m.hasBeenWithdrawn, s.element AS synonym
FROM `open-targets-prod.platform.molecule` AS m
LEFT JOIN UNNEST(m.synonyms.list) AS s ON TRUE
WHERE m.id = 'CHEMBL122'
LIMIT 100
Answer:
id,drugType,hasBeenWithdrawn,synonym
CHEMBL122,Small molecule,True,M01AH02
CHEMBL122,Small molecule,True,MK-0966
CHEMBL122,Small molecule,True,MK-966
CHEMBL122,Small molecule,True,MK0966
CHEMBL122,Small molecule,True,NSC-720256
CHEMBL122,Small molecule,True,NSC-758705
CHEMBL122,Small molecule,True,Rofecoxib
CHEMBL122,Small molecule,True,TRM-201
CHEMBL122,Small molecule,True,TRM201
Query:
-- Corrected Query 14
SELECT id, drugType, maximumClinicalTrialPhase
FROM `open-targets-prod.platform.molecule`
WHERE id IN ('CHEMBL122', 'CHEMBL1201649', 'CHEMBL3137343', 'CHEMBL1201580')
LIMIT 100
Answer:
id,drugType,maximumClinicalTrialPhase
CHEMBL122,Small molecule,4.0
CHEMBL1201649,Unknown,4.0
CHEMBL3137343,Antibody,4.0
CHEMBL1201580,Antibody,4.0
Query:
-- Corrected Query 15
SELECT id, drugType, yearOfFirstApproval
FROM `open-targets-prod.platform.molecule`
WHERE id IN ('CHEMBL122', 'CHEMBL1201649', 'CHEMBL3137343', 'CHEMBL1201580')
  AND yearOfFirstApproval IS NOT NULL
LIMIT 100
Answer:
id,drugType,yearOfFirstApproval
CHEMBL122,Small molecule,1999
CHEMBL1201649,Unknown,1942
CHEMBL3137343,Antibody,2014
CHEMBL1201580,Antibody,2002
Query:
-- Corrected Query 16
SELECT id, drugType, hasBeenWithdrawn
FROM `open-targets-prod.platform.molecule`
WHERE id IN ('CHEMBL122')
LIMIT 100
Answer:
id,drugType,hasBeenWithdrawn
CHEMBL122,Small molecule,True
Query:
-- Corrected Query 17
SELECT id, drugType, description
FROM `open-targets-prod.platform.molecule`
WHERE id IN ('CHEMBL122', 'CHEMBL1201649', 'CHEMBL3137343', 'CHEMBL1201580')
LIMIT 100
Answer:
id,drugType,description
CHEMBL122,Small molecule,Small molecule drug with a maximum clinical trial phase of IV (across all indications) that was first approved in 1999 and is indicated for rheumatic disease and has 12 investigational indications. It was withdrawn in at least one region. This drug has a black box warning from the FDA.
CHEMBL1201649,Unknown,Unknown drug with a maximum clinical trial phase of IV (across all indications) that was first approved in 1942 and has 10 approved and 25 investigational indications. This drug has a black box warning from the FDA.
CHEMBL3137343,Antibody,Antibody drug with a maximum clinical trial phase of IV (across all indications) that was first approved in 2014 and has 22 approved and 161 investigational indications.
CHEMBL1201580,Antibody,Antibody drug with a maximum clinical trial phase of IV (across all indications) that was first approved in 2002 and has 9 approved and 23 investigational indications. This drug has a black box warning from the FDA.
Query:
-- Corrected Query 18
SELECT id, drugType, hasBeenWithdrawn
FROM `open-targets-prod.platform.molecule`
WHERE hasBeenWithdrawn = TRUE
LIMIT 100
Answer:
id,drugType,hasBeenWithdrawn
CHEMBL27193,Small molecule,True
CHEMBL2106829,Small molecule,True
CHEMBL2104793,Small molecule,True
CHEMBL1742471,Small molecule,True
CHEMBL3304486,Small molecule,True
CHEMBL1200903,Small molecule,True
CHEMBL1200695,Small molecule,True
CHEMBL1201535,Small molecule,True
CHEMBL1204165,Small molecule,True
CHEMBL3989556,Small molecule,True
CHEMBL2107495,Small molecule,True
CHEMBL4594242,Protein,True
CHEMBL2108139,Small molecule,True
CHEMBL3989830,Small molecule,True
CHEMBL61006,Small molecule,True
CHEMBL1963684,Protein,True
CHEMBL3989676,Small molecule,True
CHEMBL3989803,Small molecule,True
CHEMBL1200498,Small molecule,True
CHEMBL2109065,Protein,True
CHEMBL1863513,Small molecule,True
CHEMBL2105740,Small molecule,True
CHEMBL865,Small molecule,True
CHEMBL111,Small molecule,True
CHEMBL3142541,Small molecule,True
CHEMBL2107253,Small molecule,True
CHEMBL1200947,Small molecule,True
CHEMBL1788403,Small molecule,True
CHEMBL395110,Small molecule,True
CHEMBL1909285,Small molecule,True
CHEMBL515914,Small molecule,True
CHEMBL3187246,Small molecule,True
CHEMBL1712842,Small molecule,True
CHEMBL2355333,Small molecule,True
CHEMBL3188576,Small molecule,True
CHEMBL187709,Small molecule,True
CHEMBL13376,Small molecule,True
CHEMBL1256696,Small molecule,True
CHEMBL1334033,Small molecule,True
CHEMBL1200595,Small molecule,True
CHEMBL1256842,Small molecule,True
CHEMBL539770,Small molecule,True
CHEMBL1534525,Small molecule,True
CHEMBL1200393,Small molecule,True
CHEMBL1200549,Small molecule,True
CHEMBL404849,Small molecule,True
CHEMBL1568057,Small molecule,True
CHEMBL1364551,Small molecule,True
CHEMBL1887891,Small molecule,True
CHEMBL1255739,Small molecule,True
CHEMBL341812,Small molecule,True
CHEMBL16476,Small molecule,True
CHEMBL110691,Small molecule,True
CHEMBL2106155,Small molecule,True
CHEMBL1275,Small molecule,True
CHEMBL1200563,Small molecule,True
CHEMBL146095,Small molecule,True
CHEMBL3183453,Small molecule,True
CHEMBL1200779,Small molecule,True
CHEMBL1237104,Small molecule,True
CHEMBL1697856,Small molecule,True
CHEMBL1411979,Small molecule,True
CHEMBL232201,Small molecule,True
CHEMBL869,Small molecule,True
End Exploring Related Columns
Task: For the detailed molecule data, Please display the drug id, drug type and withdrawal status for approved drugs with a black box warning and known drug type among 'Keytruda', 'Vioxx', 'Premarin', and 'Humira'

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
drug_id,drug_type,hasBeenWithdrawn
id1:str,type1:str,status1:bool
id2:str,type2:str,status2:bool
...
```

This table displays the drug ID, drug type, and withdrawal status for approved drugs with a black box warning and known drug type among 'Keytruda', 'Vioxx', 'Premarin', and 'Humira'..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'open-targets-prod': {'platform': ['associationByDatasourceDirect', 'associationByDatasourceIndirect', 'associationByDatatypeDirect', 'associationByDatatypeIndirect', 'associationByOverallDirect', 'associationByOverallIndirect', 'baselineExpression', 'diseaseToPhenotype', 'diseases', 'drugWarnings', 'evidence', 'go', 'hpo', 'indication', 'interaction', 'interactionEvidence', 'knownDrugsAggregated', 'mechanismOfAction', 'molecule', 'mousePhenotypes', 'ot_release', 'pharmacogenomics', 'reactome', 'significantAdverseDrugReactions', 'targetEssentiality', 'targetPrioritisation', 'targets']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-24 04:40:15 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 04:40:15 - root - INFO - ```sql
SELECT DISTINCT m.id AS drug_id, m.drugType AS drug_type, m.hasBeenWithdrawn
FROM `open-targets-prod.platform.molecule` AS m
LEFT JOIN UNNEST(m.tradeNames.list) AS tn
LEFT JOIN UNNEST(m.synonyms.list) AS s
WHERE m.isApproved = TRUE
  AND m.blackBoxWarning = TRUE
  AND m.drugType IS NOT NULL
  AND LOWER(m.drugType) != 'unknown'
  AND (
    LOWER(m.name) IN ('keytruda', 'vioxx', 'premarin', 'humira') OR
    LOWER(tn.element) IN ('keytruda', 'vioxx', 'premarin', 'humira') OR
    LOWER(s.element) IN ('keytruda', 'vioxx', 'premarin', 'humira')
  );
```

```csv
drug_id,drug_type,hasBeenWithdrawn
CHEMBL122,Small molecule,True
CHEMBL1201580,Antibody,False
```
2025-01-24 04:40:16 - root - INFO - itercount: 1
2025-01-24 04:40:16 - root - INFO - 0
2025-01-24 04:40:16 - root - INFO - results: 
drug_id,drug_type,hasBeenWithdrawn
CHEMBL122,Small molecule,True
CHEMBL1201580,Antibody,False


2025-01-24 04:40:16 - root - INFO - Please check the answer again by reviewing For the detailed molecule data, Please display the drug id, drug type and withdrawal status for approved drugs with a black box warning and known drug type among 'Keytruda', 'Vioxx', 'Premarin', and 'Humira', reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
drug_id,drug_type,hasBeenWithdrawn
id1:str,type1:str,status1:bool
id2:str,type2:str,status2:bool
...
```

This table displays the drug ID, drug type, and withdrawal status for approved drugs with a black box warning and known drug type among 'Keytruda', 'Vioxx', 'Premarin', and 'Humira'. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
drug_id,drug_type,hasBeenWithdrawn
CHEMBL122,Small molecule,True
CHEMBL1201580,Antibody,False
Current sql:
SELECT DISTINCT m.id AS drug_id, m.drugType AS drug_type, m.hasBeenWithdrawn
FROM `open-targets-prod.platform.molecule` AS m
LEFT JOIN UNNEST(m.tradeNames.list) AS tn
LEFT JOIN UNNEST(m.synonyms.list) AS s
WHERE m.isApproved = TRUE
  AND m.blackBoxWarning = TRUE
  AND m.drugType IS NOT NULL
  AND LOWER(m.drugType) != 'unknown'
  AND (
    LOWER(m.name) IN ('keytruda', 'vioxx', 'premarin', 'humira') OR
    LOWER(tn.element) IN ('keytruda', 'vioxx', 'premarin', 'humira') OR
    LOWER(s.element) IN ('keytruda', 'vioxx', 'premarin', 'humira')
  );
2025-01-24 04:41:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 04:41:01 - root - INFO - ```sql
SELECT DISTINCT m.id AS drug_id, m.drugType AS drug_type, m.hasBeenWithdrawn
FROM `open-targets-prod.platform.molecule` AS m
LEFT JOIN UNNEST(m.tradeNames.list) AS tn
LEFT JOIN UNNEST(m.synonyms.list) AS s
WHERE m.isApproved = TRUE
  AND m.blackBoxWarning = TRUE
  AND m.drugType IS NOT NULL
  AND LOWER(m.drugType) != 'unknown'
  AND (
    LOWER(m.name) IN ('keytruda', 'vioxx', 'premarin', 'humira') OR
    LOWER(tn.element) IN ('keytruda', 'vioxx', 'premarin', 'humira') OR
    LOWER(s.element) IN ('keytruda', 'vioxx', 'premarin', 'humira')
  );
```
2025-01-24 04:41:02 - root - INFO - itercount: 2
2025-01-24 04:41:02 - root - INFO - 0
2025-01-24 04:41:02 - root - INFO - Total iteration counts: 2
