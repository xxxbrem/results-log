2025-01-23 12:14:32 - openai._base_client - INFO - Retrying request to /chat/completions in 0.384928 seconds
2025-01-23 12:15:11 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 12:15:13 - root - INFO - SQL:
SELECT DISTINCT id, name
   FROM `open-targets-prod.platform.diseases`
   WHERE LOWER(name) LIKE '%psoriasis%'
   LIMIT 100;
Results:
id,name
MONDO_0023297,guttate psoriasis
MONDO_0011269,psoriasis 2
EFO_1000747,parapsoriasis
MONDO_0013626,"psoriasis 14, pustular"
MONDO_0010652,X-linked intellectual disability-seizures-psoriasis syndrome
EFO_0007773,cutaneous psoriasis measurement
EFO_1001494,psoriasis vulgaris
EFO_0000676,psoriasis
EFO_0022382,psoriasis area and severity index
EFO_0009733,psoriasis-related juvenile idiopathic arthritis
Orphanet_3052,X-linked intellectual disability - seizures - psoriasis

2025-01-23 12:15:14 - root - INFO - SQL:
SELECT diseaseId, targetId, score
   FROM `open-targets-prod.platform.associationByOverallDirect`
   WHERE diseaseId = 'EFO_0000676'  -- Replace with actual disease ID for psoriasis
   LIMIT 100;
Results:
diseaseId,targetId,score
EFO_0000676,ENSG00000136634,0.13960796801479197
EFO_0000676,ENSG00000161638,0.004558446447384791
EFO_0000676,ENSG00000198887,0.005482597244792303
EFO_0000676,ENSG00000171428,0.010865647727730233
EFO_0000676,ENSG00000176635,0.024666813654276514
EFO_0000676,ENSG00000149532,0.0049296525550661914
EFO_0000676,ENSG00000099203,0.019394884790955007
EFO_0000676,ENSG00000221502,0.008603819017059857
EFO_0000676,ENSG00000142347,0.004105358916123505
EFO_0000676,ENSG00000146425,0.0022174791281082103
EFO_0000676,ENSG00000149257,0.004952986988091098
EFO_0000676,ENSG00000197653,0.013304874768649265
EFO_0000676,ENSG00000105649,0.006735011464134199
EFO_0000676,ENSG00000127663,0.007430647231850604
EFO_0000676,ENSG00000204655,0.004434958256216421
EFO_0000676,ENSG00000228742,0.018109412879550386
EFO_0000676,ENSG00000234289,0.0014783194187388074
EFO_0000676,ENSG00000264232,0.015211906818822327
EFO_0000676,ENSG00000147548,0.007876727452116632
EFO_0000676,ENSG00000213171,0.017385036364368372
EFO_0000676,ENSG00000226674,0.0036957985468470183
EFO_0000676,ENSG00000244405,0.00613160474813124
EFO_0000676,ENSG00000105135,0.007904259389936536
EFO_0000676,ENSG00000105971,0.0051741179655858255
EFO_0000676,ENSG00000161653,0.0022174791281082103
EFO_0000676,ENSG00000223572,0.010837004826594741
EFO_0000676,ENSG00000174837,0.0014783194187388074
EFO_0000676,ENSG00000115317,0.004919558628388815
EFO_0000676,ENSG00000144481,0.0014783194187388074
EFO_0000676,ENSG00000251432,0.0019080796274821299
EFO_0000676,ENSG00000160201,0.0036957985468470183
EFO_0000676,ENSG00000170255,0.012605751334296124
EFO_0000676,ENSG00000285946,0.014487530303640311
EFO_0000676,ENSG00000070961,0.006741780421058929
EFO_0000676,ENSG00000104371,0.022684811480546997
EFO_0000676,ENSG00000136144,0.008155937445563966
EFO_0000676,ENSG00000185222,0.009359163652184104
EFO_0000676,ENSG00000274315,0.0037096522600349063
EFO_0000676,ENSG00000115165,0.006121306443460442
EFO_0000676,ENSG00000144893,0.004434958256216421
EFO_0000676,ENSG00000196562,0.0059132776749552295
EFO_0000676,ENSG00000197943,0.03402352142227365
EFO_0000676,ENSG00000279317,0.020489507143719863
EFO_0000676,ENSG00000139767,0.0036957985468470183
EFO_0000676,ENSG00000151806,0.0017228229014515436
EFO_0000676,ENSG00000185069,0.019025970919168453
EFO_0000676,ENSG00000088256,0.005116660630317174
EFO_0000676,ENSG00000138385,0.0014783194187388074
EFO_0000676,ENSG00000198049,0.0041412298231645744
EFO_0000676,ENSG00000231160,0.005006441753343378
EFO_0000676,ENSG00000093144,0.02855070606149281
EFO_0000676,ENSG00000135678,0.0029566388374776147
EFO_0000676,ENSG00000119335,0.0014783194187388074
EFO_0000676,ENSG00000106459,0.005471291795901198
EFO_0000676,ENSG00000128585,0.007886834098971538
EFO_0000676,ENSG00000167333,0.005349814531307899

2025-01-23 12:15:16 - root - INFO - SQL:
SELECT AVG(score) AS average_score
   FROM `open-targets-prod.platform.associationByOverallDirect`
   WHERE diseaseId = 'EFO_0000676';  -- Replace with actual disease ID for psoriasis
Results:
average_score
0.03532404936249619

2025-01-23 12:15:17 - root - INFO - SQL:
SELECT DISTINCT targetId, score
   FROM `open-targets-prod.platform.associationByOverallDirect`
   WHERE diseaseId = 'EFO_0000676'
   LIMIT 100;
Results:
targetId,score
ENSG00000136634,0.13960796801479197
ENSG00000161638,0.004558446447384791
ENSG00000198887,0.005482597244792303
ENSG00000171428,0.010865647727730233
ENSG00000176635,0.024666813654276514
ENSG00000149532,0.0049296525550661914
ENSG00000099203,0.019394884790955007
ENSG00000221502,0.008603819017059857
ENSG00000142347,0.004105358916123505
ENSG00000146425,0.0022174791281082103
ENSG00000149257,0.004952986988091098
ENSG00000197653,0.013304874768649265
ENSG00000105649,0.006735011464134199
ENSG00000127663,0.007430647231850604
ENSG00000204655,0.004434958256216421
ENSG00000228742,0.018109412879550386
ENSG00000234289,0.0014783194187388074
ENSG00000264232,0.015211906818822327
ENSG00000147548,0.007876727452116632
ENSG00000213171,0.017385036364368372
ENSG00000226674,0.0036957985468470183
ENSG00000244405,0.00613160474813124
ENSG00000105135,0.007904259389936536
ENSG00000105971,0.0051741179655858255
ENSG00000161653,0.0022174791281082103
ENSG00000223572,0.010837004826594741
ENSG00000174837,0.0014783194187388074
ENSG00000115317,0.004919558628388815
ENSG00000144481,0.0014783194187388074
ENSG00000251432,0.0019080796274821299
ENSG00000160201,0.0036957985468470183
ENSG00000170255,0.012605751334296124
ENSG00000285946,0.014487530303640311
ENSG00000070961,0.006741780421058929
ENSG00000104371,0.022684811480546997
ENSG00000136144,0.008155937445563966
ENSG00000185222,0.009359163652184104
ENSG00000274315,0.0037096522600349063
ENSG00000115165,0.006121306443460442
ENSG00000144893,0.004434958256216421
ENSG00000196562,0.0059132776749552295
ENSG00000197943,0.03402352142227365
ENSG00000279317,0.020489507143719863
ENSG00000139767,0.0036957985468470183
ENSG00000151806,0.0017228229014515436
ENSG00000185069,0.019025970919168453
ENSG00000088256,0.005116660630317174
ENSG00000138385,0.0014783194187388074
ENSG00000198049,0.0041412298231645744
ENSG00000231160,0.005006441753343378
ENSG00000093144,0.02855070606149281
ENSG00000135678,0.0029566388374776147
ENSG00000119335,0.0014783194187388074
ENSG00000106459,0.005471291795901198
ENSG00000128585,0.007886834098971538
ENSG00000167333,0.005349814531307899
ENSG00000233517,0.022684811480546997
ENSG00000028203,0.0062581182445452625
ENSG00000095110,0.27844451273591103
ENSG00000089597,0.0071172210233823325
ENSG00000137871,0.0063584010991230965
ENSG00000152784,0.038011020071968944
ENSG00000125414,0.01593628333400434
ENSG00000132481,0.18892495214354832
ENSG00000153395,0.015522353896757478
ENSG00000179476,0.007886834098971538
ENSG00000234638,0.01593628333400434
ENSG00000251191,0.011265341046046545
ENSG00000003756,0.0036957985468470183
ENSG00000138623,0.004434958256216421
ENSG00000248019,0.002925703212440173
ENSG00000145687,0.004721560058667094
ENSG00000146094,0.00932080393514818
ENSG00000165475,0.0014783194187388074
ENSG00000168038,0.001220712189111615
ENSG00000203497,0.004663218689266202
ENSG00000171703,0.005058065735642375
ENSG00000249673,0.02200415804087765
ENSG00000110367,0.009543292396592391
ENSG00000126603,0.0014783194187388074
ENSG00000144119,0.021221275255995577

2025-01-23 12:15:19 - root - INFO - SQL:
SELECT targetId, score, ABS(score - AVG(score) OVER()) AS score_diff
   FROM `open-targets-prod.platform.associationByOverallDirect`
   WHERE diseaseId = 'EFO_0000676'
   LIMIT 100;
Results:
targetId,score,score_diff
ENSG00000124713,0.0036957985468470183,0.03162825081564917
ENSG00000259230,0.023416579592822707,0.011907469769673482
ENSG00000188211,0.1083180065851378,0.0729939572226416
ENSG00000234593,0.02414834770509841,0.011175701657397778
ENSG00000133265,0.005755588686553051,0.02956846067594314
ENSG00000204713,0.008849384298283693,0.026474665064212498
ENSG00000165379,0.004910877651363819,0.03041317171113237
ENSG00000095777,0.02081000986191048,0.014514039500585708
ENSG00000162616,0.1082500386393661,0.07292598927686991
ENSG00000118972,0.020323196209111747,0.015000853153384442
ENSG00000149970,0.014565115971417587,0.0207589333910786
ENSG00000140285,0.01761592959257161,0.01770811976992458
ENSG00000162711,0.09331044139992968,0.05798639203743349
ENSG00000080854,0.0013618651633808881,0.0339621841991153
ENSG00000065054,0.002824651759860173,0.03249939760263602
ENSG00000027075,0.07428555079162506,0.038961501429128874
ENSG00000079557,0.004750743709830349,0.03057330565266584
ENSG00000178919,0.03710050822629336,0.0017764588637971743
ENSG00000090339,0.021456227787834202,0.013867821574661987
ENSG00000197653,0.013304874768649265,0.022019174593846925
ENSG00000106459,0.005471291795901198,0.02985275756659499
ENSG00000030419,0.0036957985468470183,0.03162825081564917
ENSG00000257700,0.01975773903144416,0.01556631033105203
ENSG00000147588,0.0014768327653676388,0.03384721659712855
ENSG00000184601,0.0015318919539246063,0.03379215740857158
ENSG00000037749,0.0010934148448015265,0.03423063451769466
ENSG00000113810,0.0029566388374776147,0.032367410525018576
ENSG00000188738,0.0029185438205123868,0.0324055055419838
ENSG00000173198,0.07447034071896742,0.039146291356471234
ENSG00000111144,0.014967984114730423,0.020356065247765766
ENSG00000166105,0.01527406843707625,0.020049980925419937
ENSG00000104518,0.07523959944376342,0.03991555008126723
ENSG00000185499,0.029899693043103498,0.005424356319392691
ENSG00000137033,0.08361395429200308,0.04828990492950689
ENSG00000104093,0.004434958256216421,0.03088909110627977
ENSG00000177666,0.0014783194187388074,0.03384572994375738
ENSG00000143198,0.005860164984961227,0.02946388437753496
ENSG00000142494,0.008060208787743797,0.027263840574752393
ENSG00000165682,0.0014783194187388074,0.03384572994375738
ENSG00000182162,0.004232699892221178,0.03109134947027501
ENSG00000100311,0.21970246845246885,0.18437841908997266
ENSG00000095596,0.09304172841687366,0.057717679054377476
ENSG00000114346,0.012488898553442934,0.022835150809053253
ENSG00000095585,0.015351688593696662,0.019972360768799526
ENSG00000049768,0.057529875941657316,0.022205826579161127
ENSG00000002933,0.0036957985468470183,0.03162825081564917
ENSG00000203995,0.0033401234933068324,0.031983925869189356
ENSG00000082512,0.0034595232524737654,0.031864526110022426
ENSG00000180772,0.0029566388374776147,0.032367410525018576
ENSG00000237654,0.016660659849186354,0.018663389513309835
ENSG00000174171,0.0011875994688998145,0.03413644989359638
ENSG00000250802,0.0018950158814183098,0.03342903348107788

2025-01-23 12:15:20 - root - INFO - SQL:
SELECT targetId, score
   FROM `open-targets-prod.platform.associationByOverallDirect`
   WHERE diseaseId = 'EFO_0000676'
   ORDER BY ABS(score - (SELECT AVG(score) FROM `open-targets-prod.platform.associationByOverallDirect` WHERE diseaseId = 'EFO_0000676'))
   LIMIT 100;
Results:
targetId,score
ENSG00000185825,0.03527434390823987
ENSG00000136689,0.03526183437350078
ENSG00000196396,0.035479666049731365
ENSG00000156284,0.035482920552711954
ENSG00000116001,0.03514704418051514
ENSG00000073067,0.03512486938923406
ENSG00000145113,0.03512486938923406
ENSG00000130529,0.03554126269217882
ENSG00000165799,0.035075606558668246
ENSG00000112514,0.0355737948972908
ENSG00000164867,0.0355901293618538
ENSG00000173457,0.03504004833639889
ENSG00000178726,0.035032804501437545
ENSG00000131771,0.03568663824938455
ENSG00000102882,0.03491514472873955
ENSG00000163586,0.03490476405355517
ENSG00000094975,0.034852678612317896
ENSG00000198793,0.03580938301438523
ENSG00000108788,0.03581898781038527
ENSG00000253159,0.03584924590441607
ENSG00000111012,0.034788932449936485
ENSG00000168671,0.03477357261069378
ENSG00000140678,0.03475494337978222
ENSG00000115234,0.03595828615341448
ENSG00000165092,0.03600558866185543
ENSG00000112699,0.034641758853358545
ENSG00000121060,0.03605460010490674
ENSG00000158786,0.03609093415240992
ENSG00000166736,0.03609212408052661
ENSG00000204613,0.03609532880344971
ENSG00000113520,0.03610788317295996
ENSG00000263639,0.03452431317210581
ENSG00000124120,0.03621139014504639
ENSG00000285820,0.03439310127695835
ENSG00000149305,0.03439310127695835
ENSG00000162366,0.034390073180543684
ENSG00000163735,0.03628322652960314
ENSG00000151012,0.034354357886419155
ENSG00000123178,0.0343512171246488
ENSG00000090104,0.0363104209198193
ENSG00000167941,0.03431137763169509
ENSG00000077935,0.03634674532973201
ENSG00000147168,0.03429964507296677
ENSG00000159200,0.036369856155911054
ENSG00000117399,0.03637769850589762
ENSG00000057252,0.036378943820054674
ENSG00000275385,0.034255847468281087
ENSG00000142677,0.03423444910140846
ENSG00000085415,0.03642658895500025
ENSG00000075213,0.034212895713484924
ENSG00000138642,0.03650177808622224
ENSG00000196576,0.03653812150201236
ENSG00000070193,0.034103584486711976
ENSG00000179085,0.03659401249942672
ENSG00000019186,0.03660823872909848
ENSG00000144891,0.034028014912376725
ENSG00000197943,0.03402352142227365
ENSG00000214212,0.03664227653431194
ENSG00000143621,0.034001346630992565
ENSG00000141510,0.03399398286777612
ENSG00000101665,0.03393029259929315
ENSG00000004799,0.033923878658851866
ENSG00000161180,0.03391219525719754
ENSG00000026508,0.033909553328310485
ENSG00000135373,0.03389105974165758
ENSG00000273294,0.03389047267458716
ENSG00000112164,0.03677853713228717
ENSG00000183696,0.033833195524150955
ENSG00000163935,0.03381655670365022
ENSG00000115085,0.036848651428125954
ENSG00000145604,0.03379602448950107
ENSG00000109610,0.03686188523488163
ENSG00000205809,0.033749277515536726
ENSG00000092295,0.03374765991571966
ENSG00000142188,0.03690559082543376
ENSG00000134716,0.033721226996525945
ENSG00000145022,0.03694941960530419
ENSG00000120242,0.03695798546847018
ENSG00000233816,0.03695798546847018
ENSG00000186803,0.03695798546847018
ENSG00000214042,0.03695798546847018
ENSG00000236637,0.03695798546847018

2025-01-23 12:15:22 - root - INFO - SQL:
SELECT a.targetId, t.approvedSymbol, a.score
   FROM `open-targets-prod.platform.associationByOverallDirect` a
   JOIN `open-targets-prod.platform.targets` t ON a.targetId = t.id
   WHERE a.diseaseId = 'EFO_0000676'
   LIMIT 100;
Results:
targetId,approvedSymbol,score
ENSG00000277656,GSTT1,0.022448198076148566
ENSG00000290741,SAA3P,0.007391597093694037
ENSG00000293165,FABP5P3,0.004250168328874071
ENSG00000290929,ENSG00000290929,0.004784005896751974
ENSG00000292363,CRLF2,0.0036957985468470183
ENSG00000291122,CASTOR3P,0.0014783194187388074
ENSG00000235263,ENSG00000235263,0.02561188392964983
ENSG00000224260,ENSG00000224260,0.017385036364368372
ENSG00000229255,ENSG00000229255,0.02488011581737412
ENSG00000223745,CCDC18-AS1,0.012625721455923002
ENSG00000230630,DNM3OS,0.0029176565061850446
ENSG00000242125,SNHG3,0.011466946388385819
ENSG00000231999,LRRC8C-DT,0.0033973249438978745
ENSG00000203356,LINC01562,0.015211906818822327
ENSG00000284485,MIR205,0.0036957985468470183
ENSG00000199135,MIR101-1,0.0021905811515207075
ENSG00000233621,LITATS1,0.011756090816256629
ENSG00000162814,SPATA17,0.0034244532003346335
ENSG00000143842,SOX13,0.014078230394586362
ENSG00000116191,RALGPS2,0.007886834098971538
ENSG00000137960,GIPC2,0.09515542109536573
ENSG00000081721,DUSP12,0.007391597093694037
ENSG00000117399,CDC20,0.03637769850589762
ENSG00000131788,PIAS3,0.014044034478018668
ENSG00000162877,PM20D1,0.03163315499305648
ENSG00000284770,TBCE,0.052730423490952506
ENSG00000215910,C1orf167,0.08002308101258451
ENSG00000116685,KIAA2013,0.03042123803563735
ENSG00000282608,ADORA3,0.2981421474214322
ENSG00000133019,CHRM3,0.011057661783726176
ENSG00000178828,RNF186,0.20802674399605667
ENSG00000143106,PSMA5,0.00464260480304663
ENSG00000137941,TTLL7,0.001426893573113128
ENSG00000163568,AIM2,0.22991589052004385
ENSG00000118729,CASQ2,0.00578305270285049
ENSG00000188984,AADACL3,0.027889057362876776
ENSG00000204518,AADACL4,0.010667910474280281
ENSG00000163354,DCST2,0.0069316058226067305
ENSG00000163485,ADORA1,0.05261379875719713
ENSG00000253831,ETV3L,0.020489507143719863
ENSG00000134376,CRB1,0.032604816749372885
ENSG00000265972,TXNIP,0.028997766745247452
ENSG00000177272,KCNA3,0.02469668238593671
ENSG00000007341,ST7L,0.013635142804409401
ENSG00000084652,TXLNA,0.017361678061102243
ENSG00000197915,HRNR,0.20519177082752332
ENSG00000116661,FBXO2,0.0043125950495601015
ENSG00000143171,RXRG,0.5872230266530519
ENSG00000117505,DR1,0.006155218306265813
ENSG00000116288,PARK7,0.2450797794991136
ENSG00000143499,SMYD2,0.014783194187388073
ENSG00000066294,CD84,0.009234363313580258
ENSG00000159479,MED8,0.009817888839699107
ENSG00000162366,PDZK1IP1,0.034390073180543684
ENSG00000081019,RSBN1,0.07556395037092567
ENSG00000060718,COL11A1,0.03106022562261646

2025-01-23 12:15:23 - root - INFO - SQL:
SELECT a.targetId, t.approvedSymbol, a.score
   FROM `open-targets-prod.platform.associationByOverallDirect` a
   JOIN `open-targets-prod.platform.targets` t ON a.targetId = t.id
   WHERE a.diseaseId = 'EFO_0000676'
   ORDER BY ABS(a.score - (SELECT AVG(score) FROM `open-targets-prod.platform.associationByOverallDirect` WHERE diseaseId = 'EFO_0000676'))
   LIMIT 1;
Results:
targetId,approvedSymbol,score
ENSG00000185825,BCAP31,0.03527434390823987

2025-01-23 12:15:25 - root - INFO - SQL:
SELECT DISTINCT t.approvedSymbol
   FROM `open-targets-prod.platform.associationByOverallDirect` a
   JOIN `open-targets-prod.platform.targets` t ON a.targetId = t.id
   WHERE a.diseaseId = 'EFO_0000676'
   LIMIT 100;
Results:
approvedSymbol
PXDC1
MT4
SLC25A44
CRELD2
MLH1
LCE2B
ENSG00000251095
MARCHF2
GGA2
NKILA
CLTRN
LINC00667
SIKE1
ADAMTS1
IFNA13
PEG10
C8orf34-AS1
IRAG1
HTR1E
KAZN
RNF31
NPAS1
NCOR1
GDF7
UGT2A1
SLC1A3
GUCY1A2
FIRRM
ARHGDIB
TOM1L1
MYADM
AP2S1
FZD10
DCAF7
TMEM151B
HIBADH
FICD
LINC01345
MUC22
FHL3
SOWAHA
RAET1G
LINC02005
PLPPR5
CLCC1
TGS1
ALDH1L1
FAM151B
TXNRD3
PLEKHH1
RFX2
MLLT1
LINGO2
IZUMO1
EPB41L4A-DT
FAH
SLC32A1
AXIN1
SYT5
EMSLR
HEY2
NDUFA9
LMNA
OSGIN2
TRIM40
EME1
FADD
AARD
CLLU1
TOLLIP
CHRNA6
CERS6
ZNF675
OXCT2
LINC01133
ANHX
CHST10
KRTAP4-2
ABCD1
POU3F3
CORO2A
ACTR2
DNMT3L
SLC1A5
JAM3
TCIM
FANCE
SLC12A5
GCOM1
STK31
MYO16
PLPP3
WWC3
TUBB1
CFAP69
KIAA0319
DDIT4
LRP6
KIF21B
CFDP1

2025-01-23 12:15:27 - root - INFO - SQL:
SELECT a.targetId, t.approvedSymbol, a.score
    FROM `open-targets-prod.platform.associationByOverallDirect` a
    JOIN `open-targets-prod.platform.targets` t ON a.targetId = t.id
    WHERE a.diseaseId = 'EFO_0000676'
    ORDER BY ABS(a.score - (SELECT AVG(score) FROM `open-targets-prod.platform.associationByOverallDirect` WHERE diseaseId = 'EFO_0000676'))
    LIMIT 10;
Results:
targetId,approvedSymbol,score
ENSG00000185825,BCAP31,0.03527434390823987
ENSG00000136689,IL1RN,0.03526183437350078
ENSG00000196396,PTPN1,0.035479666049731365
ENSG00000156284,CLDN8,0.035482920552711954
ENSG00000116001,TIA1,0.03514704418051514
ENSG00000073067,CYP2W1,0.03512486938923406
ENSG00000145113,MUC4,0.03512486938923406
ENSG00000130529,TRPM4,0.03554126269217882
ENSG00000165799,RNASE7,0.035075606558668246
ENSG00000112514,CUTA,0.0355737948972908

2025-01-23 12:15:27 - root - INFO - itercount: 0
2025-01-23 12:15:27 - root - INFO - Database Name: open-targets-prod
Schema Name: platform
DDL describes table information.
,0
table_name,pharmacogenomics
ddl,"CREATE TABLE `open-targets-prod.platform.pharmacogenomics`
(
  datasourceId STRING,
  datasourceVersion STRING,
  datatypeId STRING,
  directionality STRING,
  evidenceLevel STRING,
  genotype STRING,
  genotypeAnnotationText STRING,
  genotypeId STRING,
  haplotypeFromSourceId STRING,
  haplotypeId STRING,
  literature STRUCT<list ARRAY<STRUCT<element STRING>>>,
  pgxCategory STRING,
  phenotypeFromSourceId STRING,
  phenotypeText STRING,
  studyId STRING,
  targetFromSourceId STRING,
  variantFunctionalConsequenceId STRING,
  variantRsId STRING,
  isDirectTarget BOOL NOT NULL,
  drugs STRUCT<list ARRAY<STRUCT<element STRUCT<drugFromSource STRING, drugId STRING> NOT NULL>>> NOT NULL
);"

,1
table_name,interaction
ddl,"CREATE TABLE `open-targets-prod.platform.interaction`
(
  sourceDatabase STRING,
  targetA STRING,
  intA STRING,
  intABiologicalRole STRING,
  targetB STRING,
  intB STRING,
  intBBiologicalRole STRING,
  speciesA STRUCT<mnemonic STRING, scientific_name STRING, taxon_id INT64>,
  speciesB STRUCT<mnemonic STRING, scientific_name STRING, taxon_id INT64>,
  count INT64 NOT NULL,
  scoring FLOAT64
);"

,2
table_name,drugWarnings
ddl,"CREATE TABLE `open-targets-prod.platform.drugWarnings`
(
  chemblIds STRUCT<list ARRAY<STRUCT<element STRING>>>,
  toxicityClass STRING,
  country STRING,
  description STRING,
  id INT64,
  references STRUCT<list ARRAY<STRUCT<element STRUCT<ref_id STRING, ref_type STRING, ref_url STRING>>>>,
  warningType STRING,
  year INT64,
  efo_term STRING,
  efo_id STRING,
  efo_id_for_warning_class STRING
);"

,3
table_name,interactionEvidence
ddl,"CREATE TABLE `open-targets-prod.platform.interactionEvidence`
(
  hostOrganismTissue STRUCT<fullName STRING, shortName STRING, xrefs STRUCT<list ARRAY<STRUCT<element STRING>>>>,
  targetB STRING,
  evidenceScore FLOAT64,
  intBBiologicalRole STRING,
  interactionResources STRUCT<databaseVersion STRING, sourceDatabase STRING>,
  interactionTypeMiIdentifier STRING,
  interactionDetectionMethodShortName STRING,
  intA STRING,
  intBSource STRING,
  speciesB STRUCT<mnemonic STRING, scientificName STRING, taxonId INT64>,
  interactionIdentifier STRING,
  hostOrganismTaxId INT64,
  participantDetectionMethodA STRUCT<list ARRAY<STRUCT<element STRUCT<miIdentifier STRING, shortName STRING>>>>,
  expansionMethodShortName STRING,
  speciesA STRUCT<mnemonic STRING, scientificName STRING, taxonId INT64>,
  intASource STRING,
  intB STRING,
  pubmedId STRING,
  intABiologicalRole STRING,
  hostOrganismScientificName STRING,
  interactionScore FLOAT64,
  interactionTypeShortName STRING,
  expansionMethodMiIdentifier STRING,
  targetA STRING,
  participantDetectionMethodB STRUCT<list ARRAY<STRUCT<element STRUCT<miIdentifier STRING, shortName STRING>>>>,
  interactionDetectionMethodMiIdentifier STRING
);"

,4
table_name,mechanismOfAction
ddl,"CREATE TABLE `open-targets-prod.platform.mechanismOfAction`
(
  actionType STRING,
  mechanismOfAction STRING,
  chemblIds STRUCT<list ARRAY<STRUCT<element STRING>>>,
  targetName STRING,
  targetType STRING,
  targets STRUCT<list ARRAY<STRUCT<element STRING NOT NULL>>>,
  references STRUCT<list ARRAY<STRUCT<element STRUCT<source STRING, ids STRUCT<list ARRAY<STRUCT<element STRING NOT NULL>>> NOT NULL, urls STRUCT<list ARRAY<STRUCT<element STRING NOT NULL>>> NOT NULL> NOT NULL>>> NOT NULL
);"

,5
table_name,associationByDatasourceIndirect
ddl,"CREATE TABLE `open-targets-prod.platform.associationByDatasourceIndirect`
(
  datatypeId STRING,
  datasourceId STRING,
  diseaseId STRING,
  targetId STRING,
  score FLOAT64,
  evidenceCount INT64 NOT NULL
);"

,6
table_name,targetEssentiality
ddl,"CREATE TABLE `open-targets-prod.platform.targetEssentiality`
(
  id STRING,
  geneEssentiality STRUCT<list ARRAY<STRUCT<element STRUCT<depMapEssentiality STRUCT<list ARRAY<STRUCT<element STRUCT<screens STRUCT<list ARRAY<STRUCT<element STRUCT<cellLineName STRING, depmapId STRING, diseaseCellLineId STRING, diseaseFromSource STRING, expression FLOAT64, geneEffect FLOAT64, mutation STRING>>>>, tissueId STRING, tissueName STRING>>>>, isEssential BOOL> NOT NULL>>> NOT NULL
);"

,7
table_name,diseases
ddl,"CREATE TABLE `open-targets-prod.platform.diseases`
(
  id STRING,
  code STRING,
  dbXRefs STRUCT<list ARRAY<STRUCT<element STRING>>>,
  description STRING,
  name STRING,
  directLocationIds STRUCT<list ARRAY<STRUCT<element STRING>>>,
  obsoleteTerms STRUCT<list ARRAY<STRUCT<element STRING>>>,
  parents STRUCT<list ARRAY<STRUCT<element STRING>>>,
  synonyms STRUCT<hasBroadSynonym STRUCT<list ARRAY<STRUCT<element STRING>>>, hasExactSynonym STRUCT<list ARRAY<STRUCT<element STRING>>>, hasNarrowSynonym STRUCT<list ARRAY<STRUCT<element STRING>>>, hasRelatedSynonym STRUCT<list ARRAY<STRUCT<element STRING>>>>,
  ancestors STRUCT<list ARRAY<STRUCT<element STRING>>>,
  descendants STRUCT<list ARRAY<STRUCT<element STRING>>>,
  children STRUCT<list ARRAY<STRUCT<element STRING>>>,
  therapeuticAreas STRUCT<list ARRAY<STRUCT<element STRING>>>,
  indirectLocationIds STRUCT<list ARRAY<STRUCT<element STRING>>>,
  ontology STRUCT<isTherapeuticArea BOOL, leaf BOOL NOT NULL, sources STRUCT<url STRING, name STRING> NOT NULL> NOT NULL
);"

,8
table_name,knownDrugsAggregated
ddl,"CREATE TABLE `open-targets-prod.platform.knownDrugsAggregated`
(
  drugId STRING,
  targetId STRING,
  diseaseId STRING,
  phase FLOAT64,
  status STRING,
  urls STRUCT<list ARRAY<STRUCT<element STRUCT<niceName STRING, url STRING>>>> NOT NULL,
  ancestors STRUCT<list ARRAY<STRUCT<element STRING>>>,
  label STRING,
  approvedSymbol STRING,
  approvedName STRING,
  targetClass STRUCT<list ARRAY<STRUCT<element STRING>>>,
  prefName STRING,
  tradeNames STRUCT<list ARRAY<STRUCT<element STRING>>>,
  synonyms STRUCT<list ARRAY<STRUCT<element STRING>>>,
  drugType STRING,
  mechanismOfAction STRING,
  targetName STRING
);"

,9
table_name,targets
ddl,"CREATE TABLE `open-targets-prod.platform.targets`
(
  id STRING,
  approvedSymbol STRING,
  biotype STRING,
  transcriptIds STRUCT<list ARRAY<STRUCT<element STRING>>>,
  canonicalTranscript STRUCT<id STRING, chromosome STRING, start INT64, `end` INT64, strand STRING>,
  canonicalExons STRUCT<list ARRAY<STRUCT<element STRING>>>,
  genomicLocation STRUCT<chromosome STRING, start INT64, `end` INT64, strand INT64> NOT NULL,
  alternativeGenes STRUCT<list ARRAY<STRUCT<element STRING>>>,
  approvedName STRING NOT NULL,
  go STRUCT<list ARRAY<STRUCT<element STRUCT<id STRING, source STRING, evidence STRING, aspect STRING, geneProduct STRING, ecoId STRING>>>>,
  hallmarks STRUCT<attributes STRUCT<list ARRAY<STRUCT<element STRUCT<pmid INT64, description STRING, attribute_name STRING> NOT NULL>>>, cancerHallmarks STRUCT<list ARRAY<STRUCT<element STRUCT<pmid INT64, description STRING, impact STRING, label STRING> NOT NULL>>>>,
  synonyms STRUCT<list ARRAY<STRUCT<element STRUCT<label STRING, source STRING>>>> NOT NULL,
  symbolSynonyms STRUCT<list ARRAY<STRUCT<element STRUCT<label STRING, source STRING>>>> NOT NULL,
  nameSynonyms STRUCT<list ARRAY<STRUCT<element STRUCT<label STRING, source STRING>>>> NOT NULL,
  functionDescriptions STRUCT<list ARRAY<STRUCT<element STRING>>>,
  subcellularLocations STRUCT<list ARRAY<STRUCT<element STRUCT<location STRING, source STRING, termSL STRING, labelSL STRING>>>>,
  targetClass STRUCT<list ARRAY<STRUCT<element STRUCT<id INT64, label STRING, level STRING NOT NULL> NOT NULL>>>,
  obsoleteSymbols STRUCT<list ARRAY<STRUCT<element STRUCT<label STRING, source STRING>>>> NOT NULL,
  obsoleteNames STRUCT<list ARRAY<STRUCT<element STRUCT<label STRING, source STRING>>>> NOT NULL,
  constraint STRUCT<list ARRAY<STRUCT<element STRUCT<constraintType STRING NOT NULL, score FLOAT64, exp FLOAT64, obs INT64, oe FLOAT64, oeLower FLOAT64, oeUpper FLOAT64, upperRank INT64, upperBin INT64, upperBin6 INT64> NOT NULL>>>,
  tep STRUCT<targetFromSourceId STRING, description STRING, therapeuticArea STRING, url STRING>,
  proteinIds STRUCT<list ARRAY<STRUCT<element STRUCT<id STRING, source STRING> NOT NULL>>>,
  dbXrefs STRUCT<list ARRAY<STRUCT<element STRUCT<id STRING, source STRING>>>> NOT NULL,
  chemicalProbes STRUCT<list ARRAY<STRUCT<element STRUCT<control STRING, drugId STRING, id STRING, isHighQuality BOOL, mechanismOfAction STRUCT<list ARRAY<STRUCT<element STRING>>>, origin STRUCT<list ARRAY<STRUCT<element STRING>>>, probeMinerScore INT64, probesDrugsScore INT64, scoreInCells INT64, scoreInOrganisms INT64, targetFromSourceId STRING, urls STRUCT<list ARRAY<STRUCT<element STRUCT<niceName STRING, url STRING>>>>> NOT NULL>>>,
  homologues STRUCT<list ARRAY<STRUCT<element STRUCT<speciesId STRING, speciesName STRING, homologyType STRING, targetGeneId STRING, isHighConfidence STRING, targetGeneSymbol STRING, queryPercentageIdentity FLOAT64, targetPercentageIdentity FLOAT64, priority INT64> NOT NULL>>>,
  tractability STRUCT<list ARRAY<STRUCT<element STRUCT<modality STRING NOT NULL, id STRING NOT NULL, value BOOL NOT NULL> NOT NULL>>>,
  safetyLiabilities STRUCT<list ARRAY<STRUCT<element STRUCT<event STRING, eventId STRING, effects STRUCT<list ARRAY<STRUCT<element STRUCT<direction STRING, dosing STRING>>>>, biosamples STRUCT<list ARRAY<STRUCT<element STRUCT<cellFormat STRING, cellLabel STRING, tissueId STRING, tissueLabel STRING>>>>, datasource STRING, literature STRING, url STRING, studies STRUCT<list ARRAY<STRUCT<element STRUCT<description STRING, name STRING, type STRING>>>>> NOT NULL>>>,
  pathways STRUCT<list ARRAY<STRUCT<element STRUCT<pathwayId STRING, pathway STRING, topLevelTerm STRING> NOT NULL>>>
);"

,10
table_name,mousePhenotypes
ddl,"CREATE TABLE `open-targets-prod.platform.mousePhenotypes`
(
  biologicalModels STRUCT<list ARRAY<STRUCT<element STRUCT<allelicComposition STRING, geneticBackground STRING, id STRING, literature STRUCT<list ARRAY<STRUCT<element STRING>>>>>>>,
  modelPhenotypeClasses STRUCT<list ARRAY<STRUCT<element STRUCT<id STRING, label STRING>>>>,
  modelPhenotypeId STRING,
  modelPhenotypeLabel STRING,
  targetFromSourceId STRING,
  targetInModel STRING,
  targetInModelEnsemblId STRING,
  targetInModelMgiId STRING
);"

,11
table_name,associationByDatasourceDirect
ddl,"CREATE TABLE `open-targets-prod.platform.associationByDatasourceDirect`
(
  datatypeId STRING,
  datasourceId STRING,
  diseaseId STRING,
  targetId STRING,
  score FLOAT64,
  evidenceCount INT64 NOT NULL
);"

,12
table_name,associationByDatatypeIndirect
ddl,"CREATE TABLE `open-targets-prod.platform.associationByDatatypeIndirect`
(
  diseaseId STRING,
  targetId STRING,
  datatypeId STRING,
  score FLOAT64,
  evidenceCount INT64
);"

,13
table_name,ot_release
ddl,"CREATE TABLE `open-targets-prod.platform.ot_release`
(
  release STRING
);"

,14
table_name,indication
ddl,"CREATE TABLE `open-targets-prod.platform.indication`
(
  id STRING,
  indications STRUCT<list ARRAY<STRUCT<element STRUCT<disease STRING, efoName STRING, references STRUCT<list ARRAY<STRUCT<element STRUCT<source STRING, ids STRUCT<list ARRAY<STRUCT<element STRING>>> NOT NULL> NOT NULL>>> NOT NULL, maxPhaseForIndication FLOAT64> NOT NULL>>> NOT NULL,
  approvedIndications STRUCT<list ARRAY<STRUCT<element STRING NOT NULL>>> NOT NULL,
  indicationCount INT64 NOT NULL
);"

,15
table_name,go
ddl,"CREATE TABLE `open-targets-prod.platform.go`
(
  id STRING,
  name STRING
);"

,16
table_name,targetPrioritisation
ddl,"CREATE TABLE `open-targets-prod.platform.targetPrioritisation`
(
  targetId STRING,
  isInMembrane INT64,
  isSecreted INT64,
  hasSafetyEvent INT64,
  hasPocket INT64,
  hasLigand INT64,
  hasSmallMoleculeBinder INT64,
  geneticConstraint FLOAT64,
  paralogMaxIdentityPercentage FLOAT64,
  mouseOrthologMaxIdentityPercentage FLOAT64,
  isCancerDriverGene INT64,
  hasTEP INT64,
  mouseKOScore FLOAT64,
  hasHighQualityChemicalProbes INT64,
  maxClinicalTrialPhase FLOAT64,
  tissueSpecificity FLOAT64,
  tissueDistribution FLOAT64
);"

,17
table_name,associationByOverallIndirect
ddl,"CREATE TABLE `open-targets-prod.platform.associationByOverallIndirect`
(
  diseaseId STRING,
  targetId STRING,
  score FLOAT64,
  evidenceCount INT64
);"

,18
table_name,associationByDatatypeDirect
ddl,"CREATE TABLE `open-targets-prod.platform.associationByDatatypeDirect`
(
  diseaseId STRING,
  targetId STRING,
  datatypeId STRING,
  score FLOAT64,
  evidenceCount INT64
);"

,19
table_name,associationByOverallDirect
ddl,"CREATE TABLE `open-targets-prod.platform.associationByOverallDirect`
(
  diseaseId STRING,
  targetId STRING,
  score FLOAT64,
  evidenceCount INT64
);"

,20
table_name,diseaseToPhenotype
ddl,"CREATE TABLE `open-targets-prod.platform.diseaseToPhenotype`
(
  disease STRING,
  phenotype STRING,
  evidence STRUCT<list ARRAY<STRUCT<element STRUCT<aspect STRING, bioCuration STRING, diseaseFromSourceId STRING, diseaseFromSource STRING, diseaseName STRING, evidenceType STRING, frequency STRING, modifiers STRUCT<list ARRAY<STRUCT<element STRING>>>, onset STRUCT<list ARRAY<STRUCT<element STRING>>>, qualifier STRING, qualifierNot BOOL NOT NULL, references STRUCT<list ARRAY<STRUCT<element STRING>>>, sex STRING, resource STRING> NOT NULL>>> NOT NULL
);"

,21
table_name,evidence
ddl,"CREATE TABLE `open-targets-prod.platform.evidence`
(
  datasourceId STRING,
  targetId STRING,
  _corrupt_record STRING,
  alleleOrigins STRUCT<list ARRAY<STRUCT<element STRING>>>,
  allelicRequirements STRUCT<list ARRAY<STRUCT<element STRING>>>,
  ancestry STRING,
  ancestryId STRING,
  beta FLOAT64,
  betaConfidenceIntervalLower FLOAT64,
  betaConfidenceIntervalUpper FLOAT64,
  biologicalModelAllelicComposition STRING,
  biologicalModelGeneticBackground STRING,
  biologicalModelId STRING,
  biomarkerName STRING,
  biomarkers STRUCT<geneExpression STRUCT<list ARRAY<STRUCT<element STRUCT<id STRING, name STRING>>>>, variant STRUCT<list ARRAY<STRUCT<element STRUCT<functionalConsequenceId STRING, id STRING, name STRING>>>>>,
  biosamplesFromSource STRUCT<list ARRAY<STRUCT<element STRING>>>,
  cellType STRING,
  clinicalPhase FLOAT64,
  clinicalSignificances STRUCT<list ARRAY<STRUCT<element STRING>>>,
  clinicalStatus STRING,
  cohortDescription STRING,
  cohortId STRING,
  cohortPhenotypes STRUCT<list ARRAY<STRUCT<element STRING>>>,
  cohortShortName STRING,
  confidence STRING,
  contrast STRING,
  crisprScreenLibrary STRING,
  datatypeId STRING,
  diseaseCellLines STRUCT<list ARRAY<STRUCT<element STRUCT<id STRING, name STRING, tissue STRING, tissueId STRING>>>>,
  diseaseFromSource STRING,
  diseaseFromSourceId STRING,
  diseaseFromSourceMappedId STRING,
  diseaseModelAssociatedHumanPhenotypes STRUCT<list ARRAY<STRUCT<element STRUCT<id STRING, label STRING>>>>,
  diseaseModelAssociatedModelPhenotypes STRUCT<list ARRAY<STRUCT<element STRUCT<id STRING, label STRING>>>>,
  drugFromSource STRING,
  drugId STRING,
  drugResponse STRING,
  geneticBackground STRING,
  literature STRUCT<list ARRAY<STRUCT<element STRING>>>,
  log2FoldChangePercentileRank INT64,
  log2FoldChangeValue FLOAT64,
  mutatedSamples STRUCT<list ARRAY<STRUCT<element STRUCT<functionalConsequenceId STRING, numberMutatedSamples FLOAT64, numberSamplesTested FLOAT64, numberSamplesWithMutationType INT64>>>>,
  oddsRatio FLOAT64,
  oddsRatioConfidenceIntervalLower FLOAT64,
  oddsRatioConfidenceIntervalUpper FLOAT64,
  pValueExponent INT64,
  pValueMantissa FLOAT64,
  pathways STRUCT<list ARRAY<STRUCT<element STRUCT<id STRING, name STRING>>>>,
  pmcIds STRUCT<list ARRAY<STRUCT<element STRING>>>,
  projectId STRING,
  publicationFirstAuthor STRING,
  publicationYear INT64,
  reactionId STRING,
  reactionName STRING,
  releaseDate STRING,
  releaseVersion STRING,
  resourceScore FLOAT64,
  sex STRUCT<list ARRAY<STRUCT<element STRING>>>,
  significantDriverMethods STRUCT<list ARRAY<STRUCT<element STRING>>>,
  statisticalMethod STRING,
  statisticalMethodOverview STRING,
  statisticalTestTail STRING,
  studyCases INT64,
  studyCasesWithQualifyingVariants INT64,
  studyId STRING,
  studyOverview STRING,
  studySampleSize INT64,
  studyStartDate STRING,
  studyStopReason STRING,
  studyStopReasonCategories STRUCT<list ARRAY<STRUCT<element STRING>>>,
  targetFromSource STRING,
  targetFromSourceId STRING,
  targetInModel STRING,
  targetInModelEnsemblId STRING,
  targetInModelMgiId STRING,
  targetModulation STRING,
  textMiningSentences STRUCT<list ARRAY<STRUCT<element STRUCT<dEnd INT64, dStart INT64, section STRING, tEnd INT64, tStart INT64, text STRING>>>>,
  urls STRUCT<list ARRAY<STRUCT<element STRUCT<niceName STRING, url STRING>>>>,
  variantAminoacidDescriptions STRUCT<list ARRAY<STRUCT<element STRING>>>,
  variantFunctionalConsequenceFromQtlId STRING,
  variantFunctionalConsequenceId STRING,
  variantHgvsId STRING,
  variantId STRING,
  variantRsId STRING,
  diseaseId STRING,
  id STRING,
  score FLOAT64,
  variantEffect STRING,
  directionOnTrait STRING,
  sourceId STRING
);"

,22
table_name,reactome
ddl,"CREATE TABLE `open-targets-prod.platform.reactome`
(
  id STRING,
  label STRING,
  ancestors STRUCT<list ARRAY<STRUCT<element STRING>>>,
  descendants STRUCT<list ARRAY<STRUCT<element STRING>>>,
  children STRUCT<list ARRAY<STRUCT<element STRING>>>,
  parents STRUCT<list ARRAY<STRUCT<element STRING>>>,
  path STRUCT<list ARRAY<STRUCT<element STRUCT<list ARRAY<STRUCT<element STRING>>>>>>
);"

,23
table_name,significantAdverseDrugReactions
ddl,"CREATE TABLE `open-targets-prod.platform.significantAdverseDrugReactions`
(
  chembl_id STRING,
  event STRING,
  count INT64 NOT NULL,
  llr FLOAT64,
  critval FLOAT64,
  meddraCode STRING
);"

,24
table_name,molecule
ddl,"CREATE TABLE `open-targets-prod.platform.molecule`
(
  id STRING,
  canonicalSmiles STRING,
  inchiKey STRING,
  drugType STRING NOT NULL,
  blackBoxWarning BOOL,
  name STRING,
  yearOfFirstApproval INT64,
  maximumClinicalTrialPhase FLOAT64,
  parentId STRING,
  hasBeenWithdrawn BOOL,
  isApproved BOOL,
  tradeNames STRUCT<list ARRAY<STRUCT<element STRING>>> NOT NULL,
  synonyms STRUCT<list ARRAY<STRUCT<element STRING>>> NOT NULL,
  crossReferences STRUCT<key_value ARRAY<STRUCT<key STRING NOT NULL, value STRUCT<list ARRAY<STRUCT<element STRING>>>>>>,
  childChemblIds STRUCT<list ARRAY<STRUCT<element STRING NOT NULL>>>,
  linkedDiseases STRUCT<`rows` STRUCT<list ARRAY<STRUCT<element STRING>>> NOT NULL, count INT64 NOT NULL>,
  linkedTargets STRUCT<`rows` STRUCT<list ARRAY<STRUCT<element STRING NOT NULL>>> NOT NULL, count INT64 NOT NULL>,
  description STRING
);"

,25
table_name,baselineExpression
ddl,"CREATE TABLE `open-targets-prod.platform.baselineExpression`
(
  id STRING,
  tissues STRUCT<list ARRAY<STRUCT<element STRUCT<efo_code STRING, label STRING, organs STRUCT<list ARRAY<STRUCT<element STRING>>>, anatomical_systems STRUCT<list ARRAY<STRUCT<element STRING>>>, rna STRUCT<value FLOAT64, zscore INT64, level INT64, unit STRING> NOT NULL, protein STRUCT<reliability BOOL, level INT64, cell_type STRUCT<list ARRAY<STRUCT<element STRUCT<name STRING, reliability BOOL, level INT64> NOT NULL>>> NOT NULL> NOT NULL> NOT NULL>>> NOT NULL
);"

,26
table_name,hpo
ddl,"CREATE TABLE `open-targets-prod.platform.hpo`
(
  dbXRefs STRUCT<list ARRAY<STRUCT<element STRING>>>,
  description STRING,
  id STRING,
  name STRING,
  namespace STRUCT<list ARRAY<STRUCT<element STRING>>>,
  obsolete_terms STRUCT<list ARRAY<STRUCT<element STRING>>>,
  parents STRUCT<list ARRAY<STRUCT<element STRING>>>
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'open-targets-prod': {'platform': ['associationByDatasourceDirect', 'associationByDatasourceIndirect', 'associationByDatatypeDirect', 'associationByDatatypeIndirect', 'associationByOverallDirect', 'associationByOverallIndirect', 'baselineExpression', 'diseaseToPhenotype', 'diseases', 'drugWarnings', 'evidence', 'go', 'hpo', 'indication', 'interaction', 'interactionEvidence', 'knownDrugsAggregated', 'mechanismOfAction', 'molecule', 'mousePhenotypes', 'ot_release', 'pharmacogenomics', 'reactome', 'significantAdverseDrugReactions', 'targetEssentiality', 'targetPrioritisation', 'targets']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- Table: `open-targets-prod.platform.diseases`
  - `id`: Used to obtain the disease ID for psoriasis.
  - `name`: Used to search for the disease "psoriasis".
  - **Condition:** `name` LIKE '%psoriasis%'

- Table: `open-targets-prod.platform.associationByOverallDirect`
  - `diseaseId`: Used to filter associations related to psoriasis.
  - `targetId`: Identifies the targets associated with psoriasis.
  - `score`: The overall association score between targets and psoriasis.
  - **Condition:** `diseaseId` matches the ID for psoriasis.

- Table: `open-targets-prod.platform.targets`
  - `id`: Used to join with `targetId` from the association table.
  - `approvedSymbol`: The approved symbol of the target.
  - **Condition:** `id` matches the `targetId` from associations.

**SQL Queries:**

1. **Retrieve the disease ID for psoriasis:**

   ```sql
   SELECT DISTINCT id, name
   FROM `open-targets-prod.platform.diseases`
   WHERE LOWER(name) LIKE '%psoriasis%'
   LIMIT 100;
   ```

2. **List all associations for psoriasis:**

   ```sql
   SELECT diseaseId, targetId, score
   FROM `open-targets-prod.platform.associationByOverallDirect`
   WHERE diseaseId = 'EFO_0000676'  -- Replace with actual disease ID for psoriasis
   LIMIT 100;
   ```

3. **Calculate the average association score for psoriasis:**

   ```sql
   SELECT AVG(score) AS average_score
   FROM `open-targets-prod.platform.associationByOverallDirect`
   WHERE diseaseId = 'EFO_0000676';  -- Replace with actual disease ID for psoriasis
   ```

4. **List target IDs and their scores for psoriasis associations:**

   ```sql
   SELECT DISTINCT targetId, score
   FROM `open-targets-prod.platform.associationByOverallDirect`
   WHERE diseaseId = 'EFO_0000676'
   LIMIT 100;
   ```

5. **Find the difference between each score and the average score:**

   ```sql
   SELECT targetId, score, ABS(score - AVG(score) OVER()) AS score_diff
   FROM `open-targets-prod.platform.associationByOverallDirect`
   WHERE diseaseId = 'EFO_0000676'
   LIMIT 100;
   ```

6. **Order targets by how close their score is to the average:**

   ```sql
   SELECT targetId, score
   FROM `open-targets-prod.platform.associationByOverallDirect`
   WHERE diseaseId = 'EFO_0000676'
   ORDER BY ABS(score - (SELECT AVG(score) FROM `open-targets-prod.platform.associationByOverallDirect` WHERE diseaseId = 'EFO_0000676'))
   LIMIT 100;
   ```

7. **Join association data with target symbols:**

   ```sql
   SELECT a.targetId, t.approvedSymbol, a.score
   FROM `open-targets-prod.platform.associationByOverallDirect` a
   JOIN `open-targets-prod.platform.targets` t ON a.targetId = t.id
   WHERE a.diseaseId = 'EFO_0000676'
   LIMIT 100;
   ```

8. **Find the target with the score closest to the average:**

   ```sql
   SELECT a.targetId, t.approvedSymbol, a.score
   FROM `open-targets-prod.platform.associationByOverallDirect` a
   JOIN `open-targets-prod.platform.targets` t ON a.targetId = t.id
   WHERE a.diseaseId = 'EFO_0000676'
   ORDER BY ABS(a.score - (SELECT AVG(score) FROM `open-targets-prod.platform.associationByOverallDirect` WHERE diseaseId = 'EFO_0000676'))
   LIMIT 1;
   ```

9. **List all target approved symbols associated with psoriasis:**

   ```sql
   SELECT DISTINCT t.approvedSymbol
   FROM `open-targets-prod.platform.associationByOverallDirect` a
   JOIN `open-targets-prod.platform.targets` t ON a.targetId = t.id
   WHERE a.diseaseId = 'EFO_0000676'
   LIMIT 100;
   ```

10. **Get the top 10 targets closest to the average score for psoriasis:**

    ```sql
    SELECT a.targetId, t.approvedSymbol, a.score
    FROM `open-targets-prod.platform.associationByOverallDirect` a
    JOIN `open-targets-prod.platform.targets` t ON a.targetId = t.id
    WHERE a.diseaseId = 'EFO_0000676'
    ORDER BY ABS(a.score - (SELECT AVG(score) FROM `open-targets-prod.platform.associationByOverallDirect` WHERE diseaseId = 'EFO_0000676'))
    LIMIT 10;
    ```

These queries help in understanding the data and identifying the target approved symbol whose association score with psoriasis is closest to the mean score.Query:
SELECT DISTINCT id, name
   FROM `open-targets-prod.platform.diseases`
   WHERE LOWER(name) LIKE '%psoriasis%'
   LIMIT 100;
Answer:
id,name
MONDO_0023297,guttate psoriasis
MONDO_0011269,psoriasis 2
EFO_1000747,parapsoriasis
MONDO_0013626,"psoriasis 14, pustular"
MONDO_0010652,X-linked intellectual disability-seizures-psoriasis syndrome
EFO_0007773,cutaneous psoriasis measurement
EFO_1001494,psoriasis vulgaris
EFO_0000676,psoriasis
EFO_0022382,psoriasis area and severity index
EFO_0009733,psoriasis-related juvenile idiopathic arthritis
Orphanet_3052,X-linked intellectual disability - seizures - psoriasis
Query:
SELECT diseaseId, targetId, score
   FROM `open-targets-prod.platform.associationByOverallDirect`
   WHERE diseaseId = 'EFO_0000676'  -- Replace with actual disease ID for psoriasis
   LIMIT 100;
Answer:
diseaseId,targetId,score
EFO_0000676,ENSG00000136634,0.13960796801479197
EFO_0000676,ENSG00000161638,0.004558446447384791
EFO_0000676,ENSG00000198887,0.005482597244792303
EFO_0000676,ENSG00000171428,0.010865647727730233
EFO_0000676,ENSG00000176635,0.024666813654276514
EFO_0000676,ENSG00000149532,0.0049296525550661914
EFO_0000676,ENSG00000099203,0.019394884790955007
EFO_0000676,ENSG00000221502,0.008603819017059857
EFO_0000676,ENSG00000142347,0.004105358916123505
EFO_0000676,ENSG00000146425,0.0022174791281082103
EFO_0000676,ENSG00000149257,0.004952986988091098
EFO_0000676,ENSG00000197653,0.013304874768649265
EFO_0000676,ENSG00000105649,0.006735011464134199
EFO_0000676,ENSG00000127663,0.007430647231850604
EFO_0000676,ENSG00000204655,0.004434958256216421
EFO_0000676,ENSG00000228742,0.018109412879550386
EFO_0000676,ENSG00000234289,0.0014783194187388074
EFO_0000676,ENSG00000264232,0.015211906818822327
EFO_0000676,ENSG00000147548,0.007876727452116632
EFO_0000676,ENSG00000213171,0.017385036364368372
EFO_0000676,ENSG00000226674,0.0036957985468470183
EFO_0000676,ENSG00000244405,0.00613160474813124
EFO_0000676,ENSG00000105135,0.007904259389936536
EFO_0000676,ENSG00000105971,0.0051741179655858255
EFO_0000676,ENSG00000161653,0.0022174791281082103
EFO_0000676,ENSG00000223572,0.010837004826594741
EFO_0000676,ENSG00000174837,0.0014783194187388074
EFO_0000676,ENSG00000115317,0.004919558628388815
EFO_0000676,ENSG00000144481,0.0014783194187388074
EFO_0000676,ENSG00000251432,0.0019080796274821299
EFO_0000676,ENSG00000160201,0.0036957985468470183
EFO_0000676,ENSG00000170255,0.012605751334296124
EFO_0000676,ENSG00000285946,0.014487530303640311
EFO_0000676,ENSG00000070961,0.006741780421058929
EFO_0000676,ENSG00000104371,0.022684811480546997
EFO_0000676,ENSG00000136144,0.008155937445563966
EFO_0000676,ENSG00000185222,0.009359163652184104
EFO_0000676,ENSG00000274315,0.0037096522600349063
EFO_0000676,ENSG00000115165,0.006121306443460442
EFO_0000676,ENSG00000144893,0.004434958256216421
EFO_0000676,ENSG00000196562,0.0059132776749552295
EFO_0000676,ENSG00000197943,0.03402352142227365
EFO_0000676,ENSG00000279317,0.020489507143719863
EFO_0000676,ENSG00000139767,0.0036957985468470183
EFO_0000676,ENSG00000151806,0.0017228229014515436
EFO_0000676,ENSG00000185069,0.019025970919168453
EFO_0000676,ENSG00000088256,0.005116660630317174
EFO_0000676,ENSG00000138385,0.0014783194187388074
EFO_0000676,ENSG00000198049,0.0041412298231645744
EFO_0000676,ENSG00000231160,0.005006441753343378
EFO_0000676,ENSG00000093144,0.02855070606149281
EFO_0000676,ENSG00000135678,0.0029566388374776147
EFO_0000676,ENSG00000119335,0.0014783194187388074
EFO_0000676,ENSG00000106459,0.005471291795901198
EFO_0000676,ENSG00000128585,0.007886834098971538
EFO_0000676,ENSG00000167333,0.005349814531307899
Query:
SELECT AVG(score) AS average_score
   FROM `open-targets-prod.platform.associationByOverallDirect`
   WHERE diseaseId = 'EFO_0000676';  -- Replace with actual disease ID for psoriasis
Answer:
average_score
0.03532404936249619
Query:
SELECT DISTINCT targetId, score
   FROM `open-targets-prod.platform.associationByOverallDirect`
   WHERE diseaseId = 'EFO_0000676'
   LIMIT 100;
Answer:
targetId,score
ENSG00000136634,0.13960796801479197
ENSG00000161638,0.004558446447384791
ENSG00000198887,0.005482597244792303
ENSG00000171428,0.010865647727730233
ENSG00000176635,0.024666813654276514
ENSG00000149532,0.0049296525550661914
ENSG00000099203,0.019394884790955007
ENSG00000221502,0.008603819017059857
ENSG00000142347,0.004105358916123505
ENSG00000146425,0.0022174791281082103
ENSG00000149257,0.004952986988091098
ENSG00000197653,0.013304874768649265
ENSG00000105649,0.006735011464134199
ENSG00000127663,0.007430647231850604
ENSG00000204655,0.004434958256216421
ENSG00000228742,0.018109412879550386
ENSG00000234289,0.0014783194187388074
ENSG00000264232,0.015211906818822327
ENSG00000147548,0.007876727452116632
ENSG00000213171,0.017385036364368372
ENSG00000226674,0.0036957985468470183
ENSG00000244405,0.00613160474813124
ENSG00000105135,0.007904259389936536
ENSG00000105971,0.0051741179655858255
ENSG00000161653,0.0022174791281082103
ENSG00000223572,0.010837004826594741
ENSG00000174837,0.0014783194187388074
ENSG00000115317,0.004919558628388815
ENSG00000144481,0.0014783194187388074
ENSG00000251432,0.0019080796274821299
ENSG00000160201,0.0036957985468470183
ENSG00000170255,0.012605751334296124
ENSG00000285946,0.014487530303640311
ENSG00000070961,0.006741780421058929
ENSG00000104371,0.022684811480546997
ENSG00000136144,0.008155937445563966
ENSG00000185222,0.009359163652184104
ENSG00000274315,0.0037096522600349063
ENSG00000115165,0.006121306443460442
ENSG00000144893,0.004434958256216421
ENSG00000196562,0.0059132776749552295
ENSG00000197943,0.03402352142227365
ENSG00000279317,0.020489507143719863
ENSG00000139767,0.0036957985468470183
ENSG00000151806,0.0017228229014515436
ENSG00000185069,0.019025970919168453
ENSG00000088256,0.005116660630317174
ENSG00000138385,0.0014783194187388074
ENSG00000198049,0.0041412298231645744
ENSG00000231160,0.005006441753343378
ENSG00000093144,0.02855070606149281
ENSG00000135678,0.0029566388374776147
ENSG00000119335,0.0014783194187388074
ENSG00000106459,0.005471291795901198
ENSG00000128585,0.007886834098971538
ENSG00000167333,0.005349814531307899
ENSG00000233517,0.022684811480546997
ENSG00000028203,0.0062581182445452625
ENSG00000095110,0.27844451273591103
ENSG00000089597,0.0071172210233823325
ENSG00000137871,0.0063584010991230965
ENSG00000152784,0.038011020071968944
ENSG00000125414,0.01593628333400434
ENSG00000132481,0.18892495214354832
ENSG00000153395,0.015522353896757478
ENSG00000179476,0.007886834098971538
ENSG00000234638,0.01593628333400434
ENSG00000251191,0.011265341046046545
ENSG00000003756,0.0036957985468470183
ENSG00000138623,0.004434958256216421
ENSG00000248019,0.002925703212440173
ENSG00000145687,0.004721560058667094
ENSG00000146094,0.00932080393514818
ENSG00000165475,0.0014783194187388074
ENSG00000168038,0.001220712189111615
ENSG00000203497,0.004663218689266202
ENSG00000171703,0.005058065735642375
ENSG00000249673,0.02200415804087765
ENSG00000110367,0.009543292396592391
ENSG00000126603,0.0014783194187388074
ENSG00000144119,0.021221275255995577
Query:
SELECT targetId, score, ABS(score - AVG(score) OVER()) AS score_diff
   FROM `open-targets-prod.platform.associationByOverallDirect`
   WHERE diseaseId = 'EFO_0000676'
   LIMIT 100;
Answer:
targetId,score,score_diff
ENSG00000124713,0.0036957985468470183,0.03162825081564917
ENSG00000259230,0.023416579592822707,0.011907469769673482
ENSG00000188211,0.1083180065851378,0.0729939572226416
ENSG00000234593,0.02414834770509841,0.011175701657397778
ENSG00000133265,0.005755588686553051,0.02956846067594314
ENSG00000204713,0.008849384298283693,0.026474665064212498
ENSG00000165379,0.004910877651363819,0.03041317171113237
ENSG00000095777,0.02081000986191048,0.014514039500585708
ENSG00000162616,0.1082500386393661,0.07292598927686991
ENSG00000118972,0.020323196209111747,0.015000853153384442
ENSG00000149970,0.014565115971417587,0.0207589333910786
ENSG00000140285,0.01761592959257161,0.01770811976992458
ENSG00000162711,0.09331044139992968,0.05798639203743349
ENSG00000080854,0.0013618651633808881,0.0339621841991153
ENSG00000065054,0.002824651759860173,0.03249939760263602
ENSG00000027075,0.07428555079162506,0.038961501429128874
ENSG00000079557,0.004750743709830349,0.03057330565266584
ENSG00000178919,0.03710050822629336,0.0017764588637971743
ENSG00000090339,0.021456227787834202,0.013867821574661987
ENSG00000197653,0.013304874768649265,0.022019174593846925
ENSG00000106459,0.005471291795901198,0.02985275756659499
ENSG00000030419,0.0036957985468470183,0.03162825081564917
ENSG00000257700,0.01975773903144416,0.01556631033105203
ENSG00000147588,0.0014768327653676388,0.03384721659712855
ENSG00000184601,0.0015318919539246063,0.03379215740857158
ENSG00000037749,0.0010934148448015265,0.03423063451769466
ENSG00000113810,0.0029566388374776147,0.032367410525018576
ENSG00000188738,0.0029185438205123868,0.0324055055419838
ENSG00000173198,0.07447034071896742,0.039146291356471234
ENSG00000111144,0.014967984114730423,0.020356065247765766
ENSG00000166105,0.01527406843707625,0.020049980925419937
ENSG00000104518,0.07523959944376342,0.03991555008126723
ENSG00000185499,0.029899693043103498,0.005424356319392691
ENSG00000137033,0.08361395429200308,0.04828990492950689
ENSG00000104093,0.004434958256216421,0.03088909110627977
ENSG00000177666,0.0014783194187388074,0.03384572994375738
ENSG00000143198,0.005860164984961227,0.02946388437753496
ENSG00000142494,0.008060208787743797,0.027263840574752393
ENSG00000165682,0.0014783194187388074,0.03384572994375738
ENSG00000182162,0.004232699892221178,0.03109134947027501
ENSG00000100311,0.21970246845246885,0.18437841908997266
ENSG00000095596,0.09304172841687366,0.057717679054377476
ENSG00000114346,0.012488898553442934,0.022835150809053253
ENSG00000095585,0.015351688593696662,0.019972360768799526
ENSG00000049768,0.057529875941657316,0.022205826579161127
ENSG00000002933,0.0036957985468470183,0.03162825081564917
ENSG00000203995,0.0033401234933068324,0.031983925869189356
ENSG00000082512,0.0034595232524737654,0.031864526110022426
ENSG00000180772,0.0029566388374776147,0.032367410525018576
ENSG00000237654,0.016660659849186354,0.018663389513309835
ENSG00000174171,0.0011875994688998145,0.03413644989359638
ENSG00000250802,0.0018950158814183098,0.03342903348107788
Query:
SELECT targetId, score
   FROM `open-targets-prod.platform.associationByOverallDirect`
   WHERE diseaseId = 'EFO_0000676'
   ORDER BY ABS(score - (SELECT AVG(score) FROM `open-targets-prod.platform.associationByOverallDirect` WHERE diseaseId = 'EFO_0000676'))
   LIMIT 100;
Answer:
targetId,score
ENSG00000185825,0.03527434390823987
ENSG00000136689,0.03526183437350078
ENSG00000196396,0.035479666049731365
ENSG00000156284,0.035482920552711954
ENSG00000116001,0.03514704418051514
ENSG00000073067,0.03512486938923406
ENSG00000145113,0.03512486938923406
ENSG00000130529,0.03554126269217882
ENSG00000165799,0.035075606558668246
ENSG00000112514,0.0355737948972908
ENSG00000164867,0.0355901293618538
ENSG00000173457,0.03504004833639889
ENSG00000178726,0.035032804501437545
ENSG00000131771,0.03568663824938455
ENSG00000102882,0.03491514472873955
ENSG00000163586,0.03490476405355517
ENSG00000094975,0.034852678612317896
ENSG00000198793,0.03580938301438523
ENSG00000108788,0.03581898781038527
ENSG00000253159,0.03584924590441607
ENSG00000111012,0.034788932449936485
ENSG00000168671,0.03477357261069378
ENSG00000140678,0.03475494337978222
ENSG00000115234,0.03595828615341448
ENSG00000165092,0.03600558866185543
ENSG00000112699,0.034641758853358545
ENSG00000121060,0.03605460010490674
ENSG00000158786,0.03609093415240992
ENSG00000166736,0.03609212408052661
ENSG00000204613,0.03609532880344971
ENSG00000113520,0.03610788317295996
ENSG00000263639,0.03452431317210581
ENSG00000124120,0.03621139014504639
ENSG00000285820,0.03439310127695835
ENSG00000149305,0.03439310127695835
ENSG00000162366,0.034390073180543684
ENSG00000163735,0.03628322652960314
ENSG00000151012,0.034354357886419155
ENSG00000123178,0.0343512171246488
ENSG00000090104,0.0363104209198193
ENSG00000167941,0.03431137763169509
ENSG00000077935,0.03634674532973201
ENSG00000147168,0.03429964507296677
ENSG00000159200,0.036369856155911054
ENSG00000117399,0.03637769850589762
ENSG00000057252,0.036378943820054674
ENSG00000275385,0.034255847468281087
ENSG00000142677,0.03423444910140846
ENSG00000085415,0.03642658895500025
ENSG00000075213,0.034212895713484924
ENSG00000138642,0.03650177808622224
ENSG00000196576,0.03653812150201236
ENSG00000070193,0.034103584486711976
ENSG00000179085,0.03659401249942672
ENSG00000019186,0.03660823872909848
ENSG00000144891,0.034028014912376725
ENSG00000197943,0.03402352142227365
ENSG00000214212,0.03664227653431194
ENSG00000143621,0.034001346630992565
ENSG00000141510,0.03399398286777612
ENSG00000101665,0.03393029259929315
ENSG00000004799,0.033923878658851866
ENSG00000161180,0.03391219525719754
ENSG00000026508,0.033909553328310485
ENSG00000135373,0.03389105974165758
ENSG00000273294,0.03389047267458716
ENSG00000112164,0.03677853713228717
ENSG00000183696,0.033833195524150955
ENSG00000163935,0.03381655670365022
ENSG00000115085,0.036848651428125954
ENSG00000145604,0.03379602448950107
ENSG00000109610,0.03686188523488163
ENSG00000205809,0.033749277515536726
ENSG00000092295,0.03374765991571966
ENSG00000142188,0.03690559082543376
ENSG00000134716,0.033721226996525945
ENSG00000145022,0.03694941960530419
ENSG00000120242,0.03695798546847018
ENSG00000233816,0.03695798546847018
ENSG00000186803,0.03695798546847018
ENSG00000214042,0.03695798546847018
ENSG00000236637,0.03695798546847018
Query:
SELECT a.targetId, t.approvedSymbol, a.score
   FROM `open-targets-prod.platform.associationByOverallDirect` a
   JOIN `open-targets-prod.platform.targets` t ON a.targetId = t.id
   WHERE a.diseaseId = 'EFO_0000676'
   LIMIT 100;
Answer:
targetId,approvedSymbol,score
ENSG00000277656,GSTT1,0.022448198076148566
ENSG00000290741,SAA3P,0.007391597093694037
ENSG00000293165,FABP5P3,0.004250168328874071
ENSG00000290929,ENSG00000290929,0.004784005896751974
ENSG00000292363,CRLF2,0.0036957985468470183
ENSG00000291122,CASTOR3P,0.0014783194187388074
ENSG00000235263,ENSG00000235263,0.02561188392964983
ENSG00000224260,ENSG00000224260,0.017385036364368372
ENSG00000229255,ENSG00000229255,0.02488011581737412
ENSG00000223745,CCDC18-AS1,0.012625721455923002
ENSG00000230630,DNM3OS,0.0029176565061850446
ENSG00000242125,SNHG3,0.011466946388385819
ENSG00000231999,LRRC8C-DT,0.0033973249438978745
ENSG00000203356,LINC01562,0.015211906818822327
ENSG00000284485,MIR205,0.0036957985468470183
ENSG00000199135,MIR101-1,0.0021905811515207075
ENSG00000233621,LITATS1,0.011756090816256629
ENSG00000162814,SPATA17,0.0034244532003346335
ENSG00000143842,SOX13,0.014078230394586362
ENSG00000116191,RALGPS2,0.007886834098971538
ENSG00000137960,GIPC2,0.09515542109536573
ENSG00000081721,DUSP12,0.007391597093694037
ENSG00000117399,CDC20,0.03637769850589762
ENSG00000131788,PIAS3,0.014044034478018668
ENSG00000162877,PM20D1,0.03163315499305648
ENSG00000284770,TBCE,0.052730423490952506
ENSG00000215910,C1orf167,0.08002308101258451
ENSG00000116685,KIAA2013,0.03042123803563735
ENSG00000282608,ADORA3,0.2981421474214322
ENSG00000133019,CHRM3,0.011057661783726176
ENSG00000178828,RNF186,0.20802674399605667
ENSG00000143106,PSMA5,0.00464260480304663
ENSG00000137941,TTLL7,0.001426893573113128
ENSG00000163568,AIM2,0.22991589052004385
ENSG00000118729,CASQ2,0.00578305270285049
ENSG00000188984,AADACL3,0.027889057362876776
ENSG00000204518,AADACL4,0.010667910474280281
ENSG00000163354,DCST2,0.0069316058226067305
ENSG00000163485,ADORA1,0.05261379875719713
ENSG00000253831,ETV3L,0.020489507143719863
ENSG00000134376,CRB1,0.032604816749372885
ENSG00000265972,TXNIP,0.028997766745247452
ENSG00000177272,KCNA3,0.02469668238593671
ENSG00000007341,ST7L,0.013635142804409401
ENSG00000084652,TXLNA,0.017361678061102243
ENSG00000197915,HRNR,0.20519177082752332
ENSG00000116661,FBXO2,0.0043125950495601015
ENSG00000143171,RXRG,0.5872230266530519
ENSG00000117505,DR1,0.006155218306265813
ENSG00000116288,PARK7,0.2450797794991136
ENSG00000143499,SMYD2,0.014783194187388073
ENSG00000066294,CD84,0.009234363313580258
ENSG00000159479,MED8,0.009817888839699107
ENSG00000162366,PDZK1IP1,0.034390073180543684
ENSG00000081019,RSBN1,0.07556395037092567
ENSG00000060718,COL11A1,0.03106022562261646
Query:
SELECT a.targetId, t.approvedSymbol, a.score
   FROM `open-targets-prod.platform.associationByOverallDirect` a
   JOIN `open-targets-prod.platform.targets` t ON a.targetId = t.id
   WHERE a.diseaseId = 'EFO_0000676'
   ORDER BY ABS(a.score - (SELECT AVG(score) FROM `open-targets-prod.platform.associationByOverallDirect` WHERE diseaseId = 'EFO_0000676'))
   LIMIT 1;
Answer:
targetId,approvedSymbol,score
ENSG00000185825,BCAP31,0.03527434390823987
Query:
SELECT DISTINCT t.approvedSymbol
   FROM `open-targets-prod.platform.associationByOverallDirect` a
   JOIN `open-targets-prod.platform.targets` t ON a.targetId = t.id
   WHERE a.diseaseId = 'EFO_0000676'
   LIMIT 100;
Answer:
approvedSymbol
PXDC1
MT4
SLC25A44
CRELD2
MLH1
LCE2B
ENSG00000251095
MARCHF2
GGA2
NKILA
CLTRN
LINC00667
SIKE1
ADAMTS1
IFNA13
PEG10
C8orf34-AS1
IRAG1
HTR1E
KAZN
RNF31
NPAS1
NCOR1
GDF7
UGT2A1
SLC1A3
GUCY1A2
FIRRM
ARHGDIB
TOM1L1
MYADM
AP2S1
FZD10
DCAF7
TMEM151B
HIBADH
FICD
LINC01345
MUC22
FHL3
SOWAHA
RAET1G
LINC02005
PLPPR5
CLCC1
TGS1
ALDH1L1
FAM151B
TXNRD3
PLEKHH1
RFX2
MLLT1
LINGO2
IZUMO1
EPB41L4A-DT
FAH
SLC32A1
AXIN1
SYT5
EMSLR
HEY2
NDUFA9
LMNA
OSGIN2
TRIM40
EME1
FADD
AARD
CLLU1
TOLLIP
CHRNA6
CERS6
ZNF675
OXCT2
LINC01133
ANHX
CHST10
KRTAP4-2
ABCD1
POU3F3
CORO2A
ACTR2
DNMT3L
SLC1A5
JAM3
TCIM
FANCE
SLC12A5
GCOM1
STK31
MYO16
PLPP3
WWC3
TUBB1
CFAP69
KIAA0319
DDIT4
LRP6
KIF21B
CFDP1
Query:
SELECT a.targetId, t.approvedSymbol, a.score
    FROM `open-targets-prod.platform.associationByOverallDirect` a
    JOIN `open-targets-prod.platform.targets` t ON a.targetId = t.id
    WHERE a.diseaseId = 'EFO_0000676'
    ORDER BY ABS(a.score - (SELECT AVG(score) FROM `open-targets-prod.platform.associationByOverallDirect` WHERE diseaseId = 'EFO_0000676'))
    LIMIT 10;
Answer:
targetId,approvedSymbol,score
ENSG00000185825,BCAP31,0.03527434390823987
ENSG00000136689,IL1RN,0.03526183437350078
ENSG00000196396,PTPN1,0.035479666049731365
ENSG00000156284,CLDN8,0.035482920552711954
ENSG00000116001,TIA1,0.03514704418051514
ENSG00000073067,CYP2W1,0.03512486938923406
ENSG00000145113,MUC4,0.03512486938923406
ENSG00000130529,TRPM4,0.03554126269217882
ENSG00000165799,RNASE7,0.035075606558668246
ENSG00000112514,CUTA,0.0355737948972908
End Exploring Related Columns
Task: Which target approved symbol has the overall association score closest to the mean score for psoriasis?

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
approvedSymbol
symbol:str
(Attention: answer in one row)
```

To find the target approved symbol with the overall association score closest to the mean score for psoriasis, we first select all target-disease associations for psoriasis from the `associationByOverallDirect` table where `diseaseId` corresponds to psoriasis. We then calculate the mean of the `score` for these associations. Next, we identify the target whose `score` is closest to this mean value. Finally, we retrieve the `approvedSymbol` of this target from the `targets` table..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'open-targets-prod': {'platform': ['associationByDatasourceDirect', 'associationByDatasourceIndirect', 'associationByDatatypeDirect', 'associationByDatatypeIndirect', 'associationByOverallDirect', 'associationByOverallIndirect', 'baselineExpression', 'diseaseToPhenotype', 'diseases', 'drugWarnings', 'evidence', 'go', 'hpo', 'indication', 'interaction', 'interactionEvidence', 'knownDrugsAggregated', 'mechanismOfAction', 'molecule', 'mousePhenotypes', 'ot_release', 'pharmacogenomics', 'reactome', 'significantAdverseDrugReactions', 'targetEssentiality', 'targetPrioritisation', 'targets']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-23 12:15:52 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 12:15:52 - root - INFO - ```sql
WITH avg_score AS (
    SELECT AVG(score) AS mean_score
    FROM `open-targets-prod.platform.associationByOverallDirect`
    WHERE diseaseId = 'EFO_0000676'
),
score_diffs AS (
    SELECT a.targetId, a.score, ABS(a.score - avg_score.mean_score) AS score_diff
    FROM `open-targets-prod.platform.associationByOverallDirect` a, avg_score
    WHERE a.diseaseId = 'EFO_0000676'
),
min_diff AS (
    SELECT MIN(score_diff) AS min_score_diff
    FROM score_diffs
),
closest_targets AS (
    SELECT sd.targetId, sd.score, sd.score_diff
    FROM score_diffs sd, min_diff md
    WHERE sd.score_diff = md.min_score_diff
)
SELECT t.approvedSymbol
FROM closest_targets ct
JOIN `open-targets-prod.platform.targets` t ON ct.targetId = t.id
LIMIT 1;
```

```csv
approvedSymbol
BCAP31
```
2025-01-23 12:15:54 - root - INFO - itercount: 1
2025-01-23 12:15:54 - root - INFO - 0
2025-01-23 12:15:54 - root - INFO - results: 
approvedSymbol
BCAP31


2025-01-23 12:15:54 - root - INFO - Please check the answer again by reviewing Which target approved symbol has the overall association score closest to the mean score for psoriasis?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
approvedSymbol
symbol:str
(Attention: answer in one row)
```

To find the target approved symbol with the overall association score closest to the mean score for psoriasis, we first select all target-disease associations for psoriasis from the `associationByOverallDirect` table where `diseaseId` corresponds to psoriasis. We then calculate the mean of the `score` for these associations. Next, we identify the target whose `score` is closest to this mean value. Finally, we retrieve the `approvedSymbol` of this target from the `targets` table. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
approvedSymbol
BCAP31
Current sql:
WITH avg_score AS (
    SELECT AVG(score) AS mean_score
    FROM `open-targets-prod.platform.associationByOverallDirect`
    WHERE diseaseId = 'EFO_0000676'
),
score_diffs AS (
    SELECT a.targetId, a.score, ABS(a.score - avg_score.mean_score) AS score_diff
    FROM `open-targets-prod.platform.associationByOverallDirect` a, avg_score
    WHERE a.diseaseId = 'EFO_0000676'
),
min_diff AS (
    SELECT MIN(score_diff) AS min_score_diff
    FROM score_diffs
),
closest_targets AS (
    SELECT sd.targetId, sd.score, sd.score_diff
    FROM score_diffs sd, min_diff md
    WHERE sd.score_diff = md.min_score_diff
)
SELECT t.approvedSymbol
FROM closest_targets ct
JOIN `open-targets-prod.platform.targets` t ON ct.targetId = t.id
LIMIT 1;
2025-01-23 12:16:12 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 12:16:12 - root - INFO - ```sql
WITH avg_score AS (
    SELECT AVG(score) AS mean_score
    FROM `open-targets-prod.platform.associationByOverallDirect`
    WHERE diseaseId = 'EFO_0000676'
),
score_diffs AS (
    SELECT a.targetId, a.score, ABS(a.score - avg_score.mean_score) AS score_diff
    FROM `open-targets-prod.platform.associationByOverallDirect` a, avg_score
    WHERE a.diseaseId = 'EFO_0000676'
),
min_diff AS (
    SELECT MIN(score_diff) AS min_score_diff
    FROM score_diffs
),
closest_targets AS (
    SELECT sd.targetId, sd.score, sd.score_diff
    FROM score_diffs sd, min_diff md
    WHERE sd.score_diff = md.min_score_diff
)
SELECT t.approvedSymbol
FROM closest_targets ct
JOIN `open-targets-prod.platform.targets` t ON ct.targetId = t.id
LIMIT 1;
```
2025-01-23 12:16:13 - root - INFO - itercount: 2
2025-01-23 12:16:13 - root - INFO - 0
2025-01-23 12:16:13 - root - INFO - Total iteration counts: 2
