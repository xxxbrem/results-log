2025-01-23 18:01:42 - openai._base_client - INFO - Retrying request to /chat/completions in 0.381620 seconds
2025-01-23 18:02:44 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 18:02:44 - root - INFO - SQL:
SELECT DISTINCT "interest_id"
   FROM "interest_metrics"
   LIMIT 100;
Results:
interest_id
32486.0
6106.0
18923.0
6344.0
100.0
69.0
79.0
6111.0
6214.0
19422.0
6110.0
4895.0
6217.0
4.0
6218.0
6123.0
171.0
19613.0
17.0
6.0
6013.0
4870.0
19423.0
6089.0
161.0
6286.0
5991.0
92.0
6184.0
19621.0
63.0
103.0
38.0
17786.0
6232.0
165.0
18351.0
15.0
""
17314.0
6151.0
4914.0
115.0
5968.0
36.0
5943.0
133.0
1.0
114.0
6107.0
150.0
60.0
96.0
22403.0
40.0
19758.0
17730.0
5938.0
4869.0
4897.0
6029.0
31.0
16137.0
6330.0
6334.0
6315.0
4852.0
16.0
6108.0
6206.0
6006.0
6228.0
20768.0
4902.0
6277.0
19757.0
4911.0
4910.0
6285.0
11974.0
6219.0
10250.0
6128.0
5946.0
158.0
15935.0
4855.0
149.0
16197.0
11067.0
17674.0
4913.0
56.0
6341.0
6316.0
18647.0
17803.0
23.0
132.0
6365.0

2025-01-23 18:02:44 - root - INFO - SQL:
SELECT DISTINCT "interest_name"
   FROM "interest_map"
   LIMIT 100;
Results:
interest_name
Fitness Enthusiasts
Gamers
Car Enthusiasts
Luxury Retail Researchers
Brides & Wedding Planners
Vacation Planners
Motorcycle Enthusiasts
Business News Readers
Thrift Store Shoppers
Advertising Professionals
NFL Fans
NBA Fans
NCAA Fans
MLB Fans
Nascar Fans
Eco-Conscious Consumers
Moviegoers
DIYers
Grill Masters
Techies
Home Design Enthusiasts
Doctors
Streaming Video Fans
Auto Insurance Shoppers
Teachers
College Students
Department Store Shoppers
Home Decor Shoppers
Kids Clothing Shoppers
Teen Girl Clothing Shoppers
Mens Clothing Shoppers
Baby Products Buyers
Jewelry & Watch Shoppers
Sporting Goods Shoppers
Furniture Shoppers
Bed & Bath Shoppers
Intimates Shoppers
Fast Fashion Shoppers
Apartment Hunters
Home Buyers
Moving Services Shoppers
Job Seekers
Charitable Donors
NHL Fans
Discount Big Box Shoppers
Black Friday Deal Shoppers
Hip Hop Fans
Online Investors
Seasonal Allergy Sufferers
Discount Device Shoppers
Mobile Phone Comparison Shoppers
Budget Wireless Shoppers
Menopause Researchers
Online Health Researchers
Beauty & Skincare Buyers
Streaming Device Shoppers
New & Expecting Parents
High-End Kids Furniture and Clothes Shoppers
Hands-On Parents
Fantasy & Comic Fans
Lawyers
Healthy Eaters
Drug Store Shoppers
Lawn & Garden Enthusiasts
Nurses
Mailing & Shipping Shoppers
Office Supply Shoppers
Ink & Toner Shoppers
Luxury Retail Shoppers
Contractors & Construction Professionals
Luxury Travel Researchers
Democrats
Republicans
HDTV Researchers
Hardware Shoppers
Reggaeton Fans
Online Movie Downloaders
Sale Seekers
Theme Park Researchers
Ski and Snowboard Enthusiasts
Travel Researchers
Coupon Researchers
Parents with Toddlers
Parents with Kids
Young Boomers
Day Care Users
Stay-at-Home Parents
Exercise and Gym Researchers
Home Kitchen Chefs
Restaurant Researchers
Order-in Eaters
Nutrition Conscious Eaters
Flower & Gift Basket Shoppers
Plus Size Women
Live Concert Fans
Country Music Fans
Comedy Fans
Cruise Travel Intenders
Pain Medication Users
Joint Pain Sufferers

2025-01-23 18:02:44 - root - INFO - SQL:
SELECT DISTINCT imt."interest_id", im."interest_name"
   FROM "interest_metrics" AS imt
   JOIN "interest_map" AS im ON imt."interest_id" = im."id"
   LIMIT 100;
Results:
interest_id,interest_name
32486.0,Vacation Rental Accommodation Researchers
6106.0,Luxury Second Home Owners
18923.0,Online Home Decor Shoppers
6344.0,Hair Care Shoppers
100.0,Nutrition Conscious Eaters
69.0,Healthy Eaters
79.0,Luxury Travel Researchers
6111.0,Wine Lovers
6214.0,Home Remodelers
19422.0,Home Design and Living Publication Readers
6110.0,Apartment Furniture Shoppers
4895.0,Mature Parents
6217.0,Weight Loss Researchers
4.0,Luxury Retail Researchers
6218.0,Running Enthusiasts
6123.0,Misc-Deal Seekers or Coupon Shoppers
171.0,Shoe Shoppers
19613.0,Land Rover Shoppers
17.0,MLB Fans
6.0,Vacation Planners
6013.0,Competitive Sports Participants
4870.0,Tech-Savvy Moms
19423.0,Kitchen Appliance Shoppers
6089.0,Mens Fitness Publication Readers
161.0,Travel Reward Points Enthusiasts
6286.0,Luxury Hotel Guests
5991.0,Gluten-Free Recipe Researchers
92.0,Parents with Kids
6184.0,Reusable Drinkware Shoppers
19621.0,Portugal Trip Planners
63.0,New & Expecting Parents
103.0,Live Concert Fans
38.0,Sporting Goods Shoppers
17786.0,Womens Fashion Brands Shoppers
6232.0,Golf Enthusiasts
165.0,Liberal News Readers
18351.0,Drama Show Watchers
15.0,NBA Fans
17314.0,Lobbyists
6151.0,Wedding Registrants
4914.0,Mens Health Researchers
115.0,Mens Shoe Shoppers
5968.0,Luxury Kitchen Goods Shoppers
36.0,Baby Products Buyers
5943.0,Financial News Readers
133.0,High End Camera Shoppers - Dupe
1.0,Fitness Enthusiasts
114.0,Womens Fashion Magazine Readers
6107.0,Ski House Second Home Owners
150.0,TV Junkies
60.0,Online Health Researchers
96.0,Exercise and Gym Researchers
22403.0,Pandora Jewelry Shoppers
40.0,Bed & Bath Shoppers
19758.0,Dog Lovers
17730.0,Luxury Department Store Shoppers
5938.0,Costa Rica Trip Planners
4869.0,Womens Fitness Enthusiasts
4897.0,Parents of Teenagers Going to College
6029.0,Indoor Cycling & Spinning Enthusiasts
31.0,Home Decor Shoppers
16137.0,Olympics Fans
6330.0,Pet Store Goers
6334.0,Supermarket Shoppers
6315.0,Boston Trip Planners
4852.0,Health & Fitness
16.0,NCAA Fans
6108.0,Beach House Second Home Owners
6206.0,Preppy Clothing Shoppers
6006.0,Breast Cancer Fund Raisers
6228.0,Paleo Eaters
20768.0,Beer Aficionados
4902.0,Yogis
6277.0,Harry Potter Fans
19757.0,Natural Pet Food Shoppers
4911.0,Dieters
4910.0,Cholesterol Researchers
6285.0,Competitive Tri-Athletes
11974.0,Price Conscious Home Shoppers
6219.0,Cycling Enthusiasts
10250.0,Halloween Costume Shoppers
6128.0,Realtors & Real Estate Researchers
5946.0,Readers of Filipinos Content
158.0,Flight and Hotel Shoppers
15935.0,Pregnancy Resources Researchers
4855.0,Entertainment & Tabloid Magazine Readers
149.0,Streaming Radio Listeners
16197.0,Financial Business Intelligence Researchers
11067.0,NCAA Football Fans
17674.0,Medical Advice Researchers
4913.0,Womens Health Researchers
56.0,Discount Device Shoppers
6341.0,Pharmacy Shoppers
6316.0,Philadelphia Trip Planners
18647.0,Gourmet Food & Wine Researchers
17803.0,TV Advertising Professionals
23.0,Techies
132.0,Apple Fans
6365.0,Executive and C-Suite
6378.0,Luggage Shoppers

2025-01-23 18:02:44 - root - INFO - SQL:
SELECT DISTINCT "month_year"
   FROM "interest_metrics"
   LIMIT 100;
Results:
month_year
07-2018
""
08-2018
09-2018
10-2018
11-2018
12-2018
01-2019
02-2019
03-2019
04-2019
05-2019
06-2019
07-2019
08-2019

2025-01-23 18:02:44 - root - INFO - SQL:
SELECT "interest_id", MAX("composition") AS "max_composition"
   FROM "interest_metrics"
   GROUP BY "interest_id"
   LIMIT 100;
Results:
interest_id,max_composition
,9.66
1.0,7.02
2.0,3.09
3.0,6.14
4.0,13.97
5.0,10.82
6.0,12.56
7.0,2.64
8.0,6.67
12.0,7.23
13.0,6.72
14.0,3.53
15.0,6.9
16.0,6.24
17.0,7.89
18.0,3.18
19.0,6.57
20.0,4.08
21.0,5.26
22.0,6.26
23.0,5.41
24.0,6.54
25.0,4.31
26.0,6.01
27.0,6.81
28.0,7.36
29.0,5.2
30.0,8.56
31.0,7.9
33.0,7.6
34.0,11.23
35.0,5.25
36.0,9.27
37.0,7.82
38.0,9.48
39.0,17.44
40.0,10.86
41.0,6.96
42.0,4.9
43.0,5.98
44.0,6.11
45.0,6.29
46.0,3.4
48.0,5.55
49.0,5.09
50.0,3.86
51.0,2.67
53.0,3.03
54.0,3.88
55.0,7.67
56.0,7.09
57.0,2.32
58.0,2.18
59.0,3.97
60.0,8.66
61.0,6.59
62.0,4.15
63.0,9.37
64.0,12.41
65.0,5.94
66.0,6.51
67.0,6.76
69.0,10.82
70.0,6.96
71.0,3.43
72.0,3.63
73.0,7.06
74.0,7.37
75.0,7.23
77.0,17.19
78.0,2.78
79.0,11.21
80.0,4.47
81.0,3.31
82.0,9.99
83.0,4.64
84.0,3.88
85.0,6.46
86.0,6.13
87.0,5.01
88.0,4.99
89.0,10.14
90.0,5.91
91.0,5.87
92.0,9.77
93.0,7.08
94.0,3.52
95.0,7.15
96.0,7.21
97.0,6.41
98.0,7.64
99.0,6.79
100.0,10.77
101.0,7.38
102.0,7.74
103.0,6.61
104.0,5.42
106.0,1.83
107.0,8.32
108.0,4.24

2025-01-23 18:03:15 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 18:03:15 - root - INFO - ```sql
SELECT
  im."month_year" AS "Time(MM-YYYY)",
  imap."interest_name" AS "Interest_Name",
  im."composition" AS "Composition_Value"
FROM "interest_metrics" AS im
JOIN (
  SELECT "interest_id", MAX("composition") AS "max_comp"
  FROM "interest_metrics"
  GROUP BY "interest_id"
) AS mc ON im."interest_id" = mc."interest_id" AND im."composition" = mc."max_comp"
JOIN "interest_map" AS imap ON im."interest_id" = imap."id"
ORDER BY im."composition" DESC
LIMIT 10;

UNION ALL

SELECT
  im."month_year" AS "Time(MM-YYYY)",
  imap."interest_name" AS "Interest_Name",
  im."composition" AS "Composition_Value"
FROM "interest_metrics" AS im
JOIN (
  SELECT "interest_id", MAX("composition") AS "max_comp"
  FROM "interest_metrics"
  GROUP BY "interest_id"
) AS mc ON im."interest_id" = mc."interest_id" AND im."composition" = mc."max_comp"
JOIN "interest_map" AS imap ON im."interest_id" = imap."id"
ORDER BY im."composition" ASC
LIMIT 10;
```
2025-01-23 18:04:35 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 18:04:35 - root - INFO - ```sql
SELECT
  im."month_year" AS "Time(MM-YYYY)",
  imap."interest_name" AS "Interest_Name",
  im."composition" AS "Composition_Value"
FROM
  (
    SELECT
      im."interest_id",
      MAX(im."composition") AS "max_composition"
    FROM "interest_metrics" AS im
    WHERE im."interest_id" IS NOT NULL
    GROUP BY im."interest_id"
  ) AS mc
JOIN "interest_metrics" AS im ON
  im."interest_id" = mc."interest_id" AND
  im."composition" = mc."max_composition"
JOIN "interest_map" AS imap ON
  im."interest_id" = imap."id"
WHERE im."interest_id" IS NOT NULL
ORDER BY im."composition" DESC
LIMIT 10

UNION ALL

SELECT
  im."month_year" AS "Time(MM-YYYY)",
  imap."interest_name" AS "Interest_Name",
  im."composition" AS "Composition_Value"
FROM
  (
    SELECT
      im."interest_id",
      MAX(im."composition") AS "max_composition"
    FROM "interest_metrics" AS im
    WHERE im."interest_id" IS NOT NULL
    GROUP BY im."interest_id"
  ) AS mc
JOIN "interest_metrics" AS im ON
  im."interest_id" = mc."interest_id" AND
  im."composition" = mc."max_composition"
JOIN "interest_map" AS imap ON
  im."interest_id" = imap."id"
WHERE im."interest_id" IS NOT NULL
ORDER BY im."composition" ASC
LIMIT 10;
```
2025-01-23 18:05:52 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 18:05:52 - root - INFO - ```sql
WITH max_compositions AS (
  SELECT
    im."month_year" AS "Time(MM-YYYY)",
    imap."interest_name" AS "Interest_Name",
    im."composition" AS "Composition_Value"
  FROM (
    SELECT
      "interest_id",
      MAX("composition") AS "max_comp"
    FROM "interest_metrics"
    WHERE "interest_id" IS NOT NULL
    GROUP BY "interest_id"
  ) AS mc
  JOIN "interest_metrics" AS im ON
    im."interest_id" = mc."interest_id" AND
    im."composition" = mc."max_comp"
  JOIN "interest_map" AS imap ON
    im."interest_id" = imap."id"
)
SELECT * FROM (
  SELECT * FROM max_compositions
  ORDER BY "Composition_Value" DESC
  LIMIT 10
)
UNION ALL
SELECT * FROM (
  SELECT * FROM max_compositions
  ORDER BY "Composition_Value" ASC
  LIMIT 10
)
ORDER BY "Composition_Value" DESC;
```

This query does the following:

- **Calculates the maximum composition value for each interest category:**
  - The `WITH max_compositions AS (...)` common table expression (CTE) computes the maximum `composition` for each `interest_id` and retrieves the corresponding `month_year` and `interest_name`.
  
- **Retrieves the top 10 interest categories:**
  - The first subquery selects from `max_compositions`, orders by `Composition_Value` descending, and limits the results to 10.

- **Retrieves the bottom 10 interest categories:**
  - The second subquery selects from `max_compositions`, orders by `Composition_Value` ascending, and limits the results to 10.

- **Combines the top and bottom categories:**
  - The `UNION ALL` combines the top 10 and bottom 10 records into a single result set.

- **Orders the final result:**
  - The final `ORDER BY "Composition_Value" DESC` sorts the combined result set by `Composition_Value` in descending order.

*Note:* By wrapping each subquery in parentheses, we ensure that the `ORDER BY` and `LIMIT` clauses apply to each subquery individually before the `UNION ALL`. The final `ORDER BY` applies to the combined result set.
2025-01-23 18:07:00 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 18:07:00 - root - INFO - SQL:
WITH max_compositions AS (
  SELECT
    im."month_year" AS "Time(MM-YYYY)",
    imap."interest_name" AS "Interest_Name",
    im."composition" AS "Composition_Value"
  FROM (
    SELECT
      "interest_id",
      MAX("composition") AS "max_comp"
    FROM "interest_metrics"
    WHERE "interest_id" IS NOT NULL
    GROUP BY "interest_id"
  ) AS mc
  JOIN "interest_metrics" AS im ON
    im."interest_id" = mc."interest_id" AND
    im."composition" = mc."max_comp"
  JOIN "interest_map" AS imap ON
    im."interest_id" = imap."id"
)
SELECT * FROM (
  SELECT * FROM max_compositions
  ORDER BY "Composition_Value" DESC
  LIMIT 10
)
UNION ALL
SELECT * FROM (
  SELECT * FROM max_compositions
  ORDER BY "Composition_Value" ASC
  LIMIT 10
)
ORDER BY "Composition_Value" DESC;
Results:
Time(MM-YYYY),Interest_Name,Composition_Value
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
07-2018,Readers of Jamaican Content,1.86
02-2019,Automotive News Readers,1.84
07-2018,Comedy Fans,1.83
08-2019,World of Warcraft Enthusiasts,1.82
08-2018,Miami Heat Fans,1.81
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2019,Hearthstone Video Game Fans,1.66
09-2018,Scifi Movie and TV Enthusiasts,1.61
09-2018,Action Movie and TV Enthusiasts,1.59
03-2019,The Sims Video Game Fans,1.57

2025-01-23 18:07:00 - root - INFO - SQL:
SELECT im."interest_name", MAX(imt."composition") AS "max_composition"
FROM "interest_metrics" AS imt
JOIN "interest_map" AS im ON imt."interest_id" = im."id"
GROUP BY im."interest_name"
ORDER BY "max_composition" DESC
LIMIT 100
Results:
interest_name,max_composition
Work Comes First Travelers,21.2
Gym Equipment Owners,18.82
Furniture Shoppers,17.44
Luxury Retail Shoppers,17.19
Luxury Boutique Hotel Researchers,15.15
Luxury Bedding Shoppers,15.05
Shoe Shoppers,14.91
Cosmetics and Beauty Shoppers,14.23
Luxury Hotel Guests,14.1
Luxury Retail Researchers,13.97
Womens Fashion Brands Shoppers,13.67
Reusable Drinkware Shoppers,13.35
Beach Supplies Shoppers,13.03
Parents of Teenagers Going to College,12.93
Luxury Kitchen Goods Shoppers,12.87
Land Rover Shoppers,12.62
Vacation Planners,12.56
High-End Kids Furniture and Clothes Shoppers,12.41
Pandora Jewelry Shoppers,12.27
Kitchen Appliance Shoppers,12.22
Christmas Celebration Researchers,12.16
Flight and Hotel Shoppers,11.97
Vacation Rental Accommodation Researchers,11.89
Harry Potter Fans,11.72
Mens Shoe Shoppers,11.68
Supermarket Shoppers,11.63
Costa Rica Trip Planners,11.63
Portugal Trip Planners,11.61
Apartment Furniture Shoppers,11.57
Travel Reward Points Enthusiasts,11.48
Halloween Costume Shoppers,11.4
Luxury Department Store Shoppers,11.38
Teen Girl Clothing Shoppers,11.23
Luxury Travel Researchers,11.21
Gluten-Free Recipe Researchers,11.04
Natural Pet Food Shoppers,10.95
High End Camera Shoppers - Dupe,10.91
Bed & Bath Shoppers,10.86
Online Home Decor Shoppers,10.85
Healthy Eaters,10.82
Brides & Wedding Planners,10.82
Weight Loss Researchers,10.8
Nutrition Conscious Eaters,10.77
Preppy Clothing Shoppers,10.76
Wine Lovers,10.71
Online Grocery Shoppers,10.7
New Years Eve Party Ticket Purchasers,10.62
New Zealand Trip Planners,10.61
Patio Furniture Shoppers,10.54
Winter Apparel Shoppers,10.46
Lobbyists,10.43
Chelsea Fans,10.36
Hair Care Shoppers,10.32
Las Vegas Trip Planners,10.3
Tech-Savvy Moms,10.29
Financial Advisors,10.24
Paleo Eaters,10.22
Travel Researchers,10.14
Home Design and Living Publication Readers,10.11
Indoor Cycling & Spinning Enthusiasts,10.05
HDTV Researchers,9.99
Alabama Trip Planners,9.98
Golf Enthusiasts,9.97
Competitive Tri-Athletes,9.97
Luxury Second Home Owners,9.93
Nursing and Physicians Assistant Journal Researchers,9.83
Parents with Kids,9.77
Home Remodelers,9.71
Recently Retired Individuals,9.67
Olympics Fans,9.65
Luggage Shoppers,9.64
Misc-Deal Seekers or Coupon Shoppers,9.49
Sporting Goods Shoppers,9.48
Mature Parents,9.47
Skin Care Researchers,9.46
Pre-Measured Grocery Shoppers,9.46
Japanese Luxury Car Enthusiasts,9.46
New & Expecting Parents,9.37
Competitive Sports Participants,9.35
Food Safety Decision Makers,9.33
Running Enthusiasts,9.29
Baby Products Buyers,9.27
Olympic Sports Enthusiasts,9.22
Luxury Home Fixture Shoppers,9.21
Asian Food Enthusiasts,9.15
Pregnancy Resources Researchers,9.13
Restaurant Supply Shoppers,9.03
"Work Hard, Play Hard Travelers",8.97
Investment Services Intenders,8.95
Ski House Second Home Owners,8.84
Special Olympics Fans,8.81
Credit Score Researchers,8.69
Online Health Researchers,8.66
Freelancers,8.65
At-Home Gym Intenders,8.64
Family Adventures Travelers,8.58
Department Store Shoppers,8.56
Life Insurance Researchers,8.54
Mid-Range Grocery Shoppers,8.5
Countdown to the Beach Travelers,8.5

2025-01-23 18:07:10 - root - INFO - SQL:
SELECT imt."interest_id", imt."month_year", imt."composition"
FROM "interest_metrics" AS imt
WHERE imt."composition" = (
  SELECT MAX("composition")
  FROM "interest_metrics"
  WHERE "interest_id" = imt."interest_id"
)
ORDER BY imt."interest_id"
LIMIT 100
Results:
interest_id,month_year,composition
1.0,07-2018,7.02
2.0,02-2019,3.09
3.0,07-2018,6.14
4.0,07-2018,13.97
5.0,07-2018,10.82
6.0,10-2018,12.56
7.0,07-2018,2.64
8.0,07-2018,6.67
12.0,07-2018,7.23
13.0,07-2018,6.72
14.0,07-2018,3.53
15.0,07-2018,6.9
16.0,07-2018,6.24
17.0,07-2018,7.89
18.0,07-2018,3.18
19.0,07-2018,6.57
20.0,07-2018,4.08
21.0,10-2018,5.26
22.0,07-2018,6.26
23.0,07-2018,5.41
24.0,07-2018,6.54
25.0,07-2018,4.31
26.0,07-2018,6.01
27.0,07-2018,6.81
28.0,10-2018,7.36
29.0,07-2018,5.2
30.0,10-2018,8.56
31.0,07-2018,7.9
33.0,07-2018,7.6
34.0,12-2018,11.23
35.0,07-2018,5.25
36.0,07-2018,9.27
37.0,07-2018,7.82
38.0,07-2018,9.48
39.0,07-2018,17.44
40.0,07-2018,10.86
41.0,07-2018,6.96
42.0,07-2018,4.9
43.0,07-2018,5.98
44.0,07-2018,6.11
45.0,07-2018,6.29
46.0,07-2018,3.4
48.0,10-2018,5.55
49.0,07-2018,5.09
50.0,10-2018,3.86
51.0,07-2018,2.67
53.0,07-2018,3.03
54.0,10-2018,3.88
55.0,10-2018,7.67
56.0,07-2018,7.09
57.0,07-2018,2.32
58.0,07-2018,2.18
59.0,07-2018,3.97
60.0,10-2018,8.66
61.0,07-2018,6.59
62.0,07-2018,4.15
63.0,07-2018,9.37
64.0,12-2018,12.41
65.0,07-2018,5.94
66.0,07-2018,6.51
67.0,10-2018,6.76
69.0,07-2018,10.82
70.0,07-2018,6.96
71.0,07-2018,3.43
72.0,07-2018,3.63
73.0,07-2018,7.06
74.0,07-2018,7.37
75.0,07-2018,7.23
77.0,07-2018,17.19
78.0,10-2018,2.78
79.0,07-2018,11.21
80.0,07-2018,4.47
81.0,07-2018,3.31
82.0,07-2018,9.99
83.0,10-2018,4.64
84.0,02-2019,3.88
85.0,07-2018,6.46
86.0,07-2018,6.13
87.0,07-2018,5.01
88.0,07-2018,4.99
89.0,10-2018,10.14
90.0,07-2018,5.91
91.0,07-2018,5.87
92.0,07-2018,9.77
93.0,07-2018,7.08
94.0,07-2018,3.52
95.0,07-2018,7.15
96.0,07-2018,7.21
97.0,07-2018,6.41
98.0,07-2018,7.64
99.0,07-2018,6.79
100.0,07-2018,10.77
101.0,07-2018,7.38
102.0,07-2018,7.74
103.0,07-2018,6.61
104.0,07-2018,5.42
106.0,07-2018,1.83
107.0,07-2018,8.32
108.0,07-2018,4.24
109.0,07-2018,6.75

2025-01-23 18:07:10 - root - INFO - SQL:
SELECT im."interest_name", MAX(imt."composition") AS "max_composition"
FROM "interest_metrics" AS imt
JOIN "interest_map" AS im ON imt."interest_id" = im."id"
GROUP BY im."interest_name"
ORDER BY "max_composition" DESC
LIMIT 10
Results:
interest_name,max_composition
Work Comes First Travelers,21.2
Gym Equipment Owners,18.82
Furniture Shoppers,17.44
Luxury Retail Shoppers,17.19
Luxury Boutique Hotel Researchers,15.15
Luxury Bedding Shoppers,15.05
Shoe Shoppers,14.91
Cosmetics and Beauty Shoppers,14.23
Luxury Hotel Guests,14.1
Luxury Retail Researchers,13.97

2025-01-23 18:07:10 - root - INFO - SQL:
SELECT im."interest_name", MAX(imt."composition") AS "max_composition"
FROM "interest_metrics" AS imt
JOIN "interest_map" AS im ON imt."interest_id" = im."id"
GROUP BY im."interest_name"
ORDER BY "max_composition" ASC
LIMIT 10
Results:
interest_name,max_composition
The Sims Video Game Fans,1.57
Action Movie and TV Enthusiasts,1.59
Scifi Movie and TV Enthusiasts,1.61
Hearthstone Video Game Fans,1.66
Online Role Playing Game Enthusiasts,1.73
Miami Heat Fans,1.81
World of Warcraft Enthusiasts,1.82
Comedy Fans,1.83
Automotive News Readers,1.84
Readers of Jamaican Content,1.86

2025-01-23 18:07:10 - root - INFO - SQL:
SELECT im."interest_name", imt."month_year", imt."composition"
FROM "interest_metrics" AS imt
JOIN "interest_map" AS im ON imt."interest_id" = im."id"
JOIN (
  SELECT "interest_id", MAX("composition") AS "max_composition"
  FROM "interest_metrics"
  GROUP BY "interest_id"
) AS mc ON imt."interest_id" = mc."interest_id" AND imt."composition" = mc."max_composition"
ORDER BY imt."composition" DESC
LIMIT 10
Results:
interest_name,month_year,composition
Work Comes First Travelers,12-2018,21.2
Gym Equipment Owners,07-2018,18.82
Furniture Shoppers,07-2018,17.44
Luxury Retail Shoppers,07-2018,17.19
Luxury Boutique Hotel Researchers,10-2018,15.15
Luxury Bedding Shoppers,12-2018,15.05
Shoe Shoppers,07-2018,14.91
Cosmetics and Beauty Shoppers,07-2018,14.23
Luxury Hotel Guests,07-2018,14.1
Luxury Retail Researchers,07-2018,13.97

2025-01-23 18:07:10 - root - INFO - SQL:
SELECT im."interest_name", imt."month_year", imt."composition"
FROM "interest_metrics" AS imt
JOIN "interest_map" AS im ON imt."interest_id" = im."id"
JOIN (
  SELECT "interest_id", MAX("composition") AS "max_composition"
  FROM "interest_metrics"
  GROUP BY "interest_id"
) AS mc ON imt."interest_id" = mc."interest_id" AND imt."composition" = mc."max_composition"
ORDER BY imt."composition" ASC
LIMIT 10
Results:
interest_name,month_year,composition
The Sims Video Game Fans,03-2019,1.57
Action Movie and TV Enthusiasts,09-2018,1.59
Scifi Movie and TV Enthusiasts,09-2018,1.61
Hearthstone Video Game Fans,08-2019,1.66
Online Role Playing Game Enthusiasts,07-2018,1.73
Miami Heat Fans,08-2018,1.81
World of Warcraft Enthusiasts,08-2019,1.82
Comedy Fans,07-2018,1.83
Automotive News Readers,02-2019,1.84
Readers of Jamaican Content,07-2018,1.86

2025-01-23 18:07:19 - root - INFO - SQL:
SELECT imt."interest_id", imt."month_year", imt."composition"
FROM "interest_metrics" AS imt
WHERE imt."composition" = (
  SELECT MIN("composition")
  FROM "interest_metrics"
  WHERE "interest_id" = imt."interest_id"
)
ORDER BY imt."interest_id"
LIMIT 100
Results:
interest_id,month_year,composition
1.0,05-2019,1.68
2.0,07-2018,1.81
3.0,12-2018,1.73
4.0,05-2019,3.43
5.0,05-2019,1.78
6.0,06-2019,2.87
7.0,04-2019,1.64
8.0,06-2019,1.58
12.0,05-2019,1.99
12.0,06-2019,1.99
13.0,06-2019,1.56
14.0,11-2018,1.56
15.0,05-2019,1.86
16.0,05-2019,2.29
17.0,06-2019,1.93
18.0,05-2019,1.71
19.0,04-2019,1.79
20.0,05-2019,1.74
21.0,07-2018,2.63
22.0,06-2019,1.7
23.0,09-2018,1.6
24.0,05-2019,1.58
25.0,05-2019,2.03
25.0,06-2019,2.03
26.0,08-2019,1.77
27.0,06-2019,1.58
28.0,06-2019,1.88
29.0,05-2019,1.64
30.0,06-2019,1.99
31.0,06-2019,2.73
33.0,06-2019,3.08
34.0,06-2019,2.36
35.0,06-2019,2.08
36.0,08-2019,2.43
37.0,06-2019,2.22
38.0,06-2019,2.86
39.0,06-2019,6.03
40.0,05-2019,2.34
41.0,05-2019,1.64
42.0,06-2019,2.16
43.0,06-2019,2.03
44.0,06-2019,2.06
45.0,06-2019,1.77
46.0,05-2019,1.65
48.0,06-2019,2.42
49.0,06-2019,2.43
50.0,06-2019,1.83
51.0,04-2019,1.98
53.0,10-2018,1.54
54.0,06-2019,1.73
55.0,06-2019,1.79
56.0,06-2019,2.21
57.0,04-2019,1.65
58.0,11-2018,1.64
59.0,06-2019,1.58
60.0,06-2019,1.66
61.0,05-2019,1.99
62.0,06-2019,1.72
63.0,05-2019,2.6
64.0,06-2019,3.17
65.0,06-2019,1.73
66.0,01-2019,1.55
67.0,07-2019,1.72
69.0,06-2019,1.64
70.0,05-2019,1.79
71.0,05-2019,1.56
72.0,06-2019,1.74
73.0,06-2019,1.68
74.0,06-2019,2.37
75.0,06-2019,2.18
77.0,06-2019,5.53
78.0,05-2019,1.72
79.0,05-2019,2.3
80.0,05-2019,1.69
81.0,07-2019,1.73
82.0,05-2019,4.05
82.0,06-2019,4.05
83.0,06-2019,1.89
84.0,06-2019,2.47
85.0,01-2019,1.9
86.0,05-2019,1.63
87.0,06-2019,1.65
88.0,06-2019,2.12
89.0,06-2019,2.55
90.0,09-2018,1.68
91.0,07-2019,1.77
92.0,05-2019,1.78
93.0,04-2019,2.03
94.0,06-2019,1.77
95.0,06-2019,2.26
96.0,06-2019,1.73
97.0,09-2018,1.93
98.0,06-2019,2.26
99.0,06-2019,2.4
100.0,06-2019,1.63
101.0,05-2019,2.35
102.0,06-2019,2.79
103.0,04-2019,1.74
104.0,01-2019,1.64
106.0,07-2018,1.83

2025-01-23 18:07:19 - root - INFO - SQL:
SELECT im."interest_name", AVG(imt."composition") AS "avg_composition"
FROM "interest_metrics" AS imt
JOIN "interest_map" AS im ON imt."interest_id" = im."id"
GROUP BY im."interest_name"
ORDER BY "avg_composition" DESC
LIMIT 100
Results:
interest_name,avg_composition
Work Comes First Travelers,17.4825
Luxury Bedding Shoppers,11.093571428571428
Gym Equipment Owners,10.48642857142857
Luxury Boutique Hotel Researchers,10.43357142857143
Luxury Retail Shoppers,9.762142857142857
Beach Supplies Shoppers,9.51142857142857
Furniture Shoppers,9.507857142857143
Luxury Hotel Guests,9.36357142857143
High-End Kids Furniture and Clothes Shoppers,8.86357142857143
Christmas Celebration Researchers,8.622142857142856
Vacation Planners,8.330714285714288
Portugal Trip Planners,7.999285714285714
Patio Furniture Shoppers,7.979999999999998
"Work Hard, Play Hard Travelers",7.8100000000000005
Family Adventures Travelers,7.65625
New Zealand Trip Planners,7.62
High End Camera Shoppers - Dupe,7.605
Winter Apparel Shoppers,7.580000000000002
Halloween Costume Shoppers,7.578571428571428
New Years Eve Party Ticket Purchasers,7.542857142857144
Online Grocery Shoppers,7.461428571428573
Teen Girl Clothing Shoppers,7.390000000000001
Flight and Hotel Shoppers,7.320714285714287
Alabama Trip Planners,7.15142857142857
Skin Care Researchers,6.993571428571428
Mens Shoe Shoppers,6.919285714285712
Chelsea Fans,6.857142857142856
Nursing and Physicians Assistant Journal Researchers,6.78
Luxury Home Fixture Shoppers,6.7542857142857144
Pre-Measured Grocery Shoppers,6.750000000000001
Financial Advisors,6.7285714285714295
Preppy Clothing Shoppers,6.723571428571427
Travel Researchers,6.707142857142856
Urban Skateboarding Sneaker Shoppers,6.681428571428571
Las Vegas Trip Planners,6.5514285714285725
Competitive Tri-Athletes,6.444999999999999
Shoe Shoppers,6.344285714285716
Indoor Cycling & Spinning Enthusiasts,6.303571428571429
Restaurant Supply Shoppers,6.3
Cosmetics and Beauty Shoppers,6.237142857142858
Luxury Retail Researchers,6.172857142857144
World Cup Enthusiasts,6.137857142857143
Parents of Teenagers Going to College,6.028571428571428
Life Insurance Researchers,5.994285714285715
Real Estate Decision Makers,5.967142857142858
Executive Travelers,5.956249999999999
Getting Off the Grid Travelers,5.9350000000000005
Lacrosse Enthusiasts,5.92857142857143
Womens Fashion Brands Shoppers,5.847142857142857
Luxury Kitchen Goods Shoppers,5.8149999999999995
HDTV Researchers,5.807857142857142
Recently Retired Individuals,5.77642857142857
Countdown to the Beach Travelers,5.69875
Food Safety Decision Makers,5.671428571428573
North Carolina Travel Researchers,5.615
Sports Medicine Health Care Professionals,5.595000000000001
Natural Pet Food Shoppers,5.588571428571429
Japanese Luxury Car Enthusiasts,5.562857142857142
NCAA Football Fans,5.56
Credit Score Researchers,5.557857142857142
Cruise Travel Intenders,5.522857142857142
Luxury Department Store Shoppers,5.515
Fishing Equipment Shoppers,5.497142857142859
Healthcare Provider Education Researchers,5.472142857142856
Freelancers,5.445
Pandora Jewelry Shoppers,5.434285714285715
Reusable Drinkware Shoppers,5.425
Big & Tall Men,5.405714285714287
Home Healthcare Researchers,5.387142857142856
Non-Profit Volunteers,5.359285714285716
Healthcare Discount Shoppers,5.307142857142857
Nissan Vehicle Shoppers,5.29
Vacuum Shoppers,5.272857142857143
Investment Services Intenders,5.267857142857143
At-Home Gym Intenders,5.22357142857143
Luggage Shoppers,5.212142857142856
Horror Movie Fans,5.21
Wine Lovers,5.1816666666666675
Weight Loss Researchers,5.141428571428571
Readers of African American Content,5.14
Teachers,5.077857142857143
Medicare Provider Researchers,5.0649999999999995
Major Airline Customers,5.055714285714287
Kids Clothing Shoppers,5.041428571428571
Vacation Rental Accommodation Researchers,5.025
Aspen Skiers and Snowboarders,5.025
Luxury Womens Brands Shoppers,4.978571428571429
Department Store Shoppers,4.972142857142857
Food Industry Professionals,4.9664285714285725
Kitchen Appliance Shoppers,4.965714285714286
Fitness Activity Tracker Users,4.963333333333333
Home Design and Living Publication Readers,4.9575
Olympics Fans,4.940714285714286
Online Health Researchers,4.938571428571428
Affordable Hotel Bookers,4.933571428571428
Russia Trip Planners,4.909285714285714
Business Incorporating & LLC Filing Researchers,4.902857142857142
Land Rover Shoppers,4.900714285714284
Online Education Intenders,4.89357142857143
Hanukkah Decorations Shoppers,4.8914285714285715

2025-01-23 18:07:19 - root - INFO - SQL:
SELECT im."interest_name", AVG(imt."composition") AS "avg_composition"
FROM "interest_metrics" AS imt
JOIN "interest_map" AS im ON imt."interest_id" = im."id"
GROUP BY im."interest_name"
ORDER BY "avg_composition" DESC
LIMIT 10
Results:
interest_name,avg_composition
Work Comes First Travelers,17.4825
Luxury Bedding Shoppers,11.093571428571428
Gym Equipment Owners,10.48642857142857
Luxury Boutique Hotel Researchers,10.43357142857143
Luxury Retail Shoppers,9.762142857142857
Beach Supplies Shoppers,9.51142857142857
Furniture Shoppers,9.507857142857143
Luxury Hotel Guests,9.36357142857143
High-End Kids Furniture and Clothes Shoppers,8.86357142857143
Christmas Celebration Researchers,8.622142857142856

2025-01-23 18:07:19 - root - INFO - SQL:
SELECT im."interest_name", imt."month_year", imt."composition"
FROM "interest_metrics" AS imt
JOIN "interest_map" AS im ON imt."interest_id" = im."id"
WHERE imt."composition" > 0.8
ORDER BY imt."composition" DESC
LIMIT 100
Results:
interest_name,month_year,composition
Work Comes First Travelers,12-2018,21.2
Work Comes First Travelers,10-2018,20.28
Work Comes First Travelers,11-2018,19.45
Work Comes First Travelers,01-2019,18.99
Gym Equipment Owners,07-2018,18.82
Work Comes First Travelers,02-2019,18.39
Work Comes First Travelers,09-2018,18.18
Furniture Shoppers,07-2018,17.44
Luxury Retail Shoppers,07-2018,17.19
Luxury Boutique Hotel Researchers,10-2018,15.15
Luxury Bedding Shoppers,12-2018,15.05
Luxury Bedding Shoppers,11-2018,14.92
Luxury Bedding Shoppers,01-2019,14.92
Shoe Shoppers,07-2018,14.91
Luxury Bedding Shoppers,02-2019,14.39
Luxury Bedding Shoppers,09-2018,14.29
Cosmetics and Beauty Shoppers,07-2018,14.23
Luxury Bedding Shoppers,10-2018,14.15
Luxury Hotel Guests,07-2018,14.1
Luxury Retail Researchers,07-2018,13.97
Gym Equipment Owners,08-2018,13.9
Luxury Boutique Hotel Researchers,12-2018,13.81
Womens Fashion Brands Shoppers,07-2018,13.67
Luxury Boutique Hotel Researchers,02-2019,13.64
Reusable Drinkware Shoppers,07-2018,13.35
Beach Supplies Shoppers,10-2018,13.03
Parents of Teenagers Going to College,07-2018,12.93
Luxury Kitchen Goods Shoppers,07-2018,12.87
Beach Supplies Shoppers,02-2019,12.85
Luxury Boutique Hotel Researchers,09-2018,12.8
Luxury Retail Shoppers,08-2018,12.73
Luxury Boutique Hotel Researchers,11-2018,12.68
Gym Equipment Owners,10-2018,12.64
Luxury Boutique Hotel Researchers,03-2019,12.64
Land Rover Shoppers,07-2018,12.62
Beach Supplies Shoppers,12-2018,12.62
Vacation Planners,10-2018,12.56
Luxury Hotel Guests,10-2018,12.47
Work Comes First Travelers,08-2018,12.42
High-End Kids Furniture and Clothes Shoppers,12-2018,12.41
Luxury Hotel Guests,02-2019,12.41
High-End Kids Furniture and Clothes Shoppers,10-2018,12.33
Luxury Bedding Shoppers,03-2019,12.3
Pandora Jewelry Shoppers,07-2018,12.27
Luxury Boutique Hotel Researchers,01-2019,12.26
Kitchen Appliance Shoppers,07-2018,12.22
Christmas Celebration Researchers,10-2018,12.16
Furniture Shoppers,08-2018,12.03
Vacation Planners,07-2018,11.99
Flight and Hotel Shoppers,10-2018,11.97
High-End Kids Furniture and Clothes Shoppers,09-2018,11.93
Beach Supplies Shoppers,11-2018,11.93
Vacation Rental Accommodation Researchers,07-2018,11.89
High-End Kids Furniture and Clothes Shoppers,01-2019,11.75
Beach Supplies Shoppers,09-2018,11.74
Luxury Retail Shoppers,12-2018,11.74
Luxury Retail Shoppers,10-2018,11.73
Harry Potter Fans,07-2018,11.72
Beach Supplies Shoppers,01-2019,11.71
Mens Shoe Shoppers,07-2018,11.68
Costa Rica Trip Planners,07-2018,11.63
Supermarket Shoppers,07-2018,11.63
Portugal Trip Planners,07-2018,11.61
Apartment Furniture Shoppers,07-2018,11.57
Christmas Celebration Researchers,12-2018,11.57
Luxury Hotel Guests,12-2018,11.5
Travel Reward Points Enthusiasts,07-2018,11.48
Halloween Costume Shoppers,07-2018,11.4
Luxury Department Store Shoppers,07-2018,11.38
Beach Supplies Shoppers,03-2019,11.27
Teen Girl Clothing Shoppers,12-2018,11.23
Luxury Travel Researchers,07-2018,11.21
Luxury Hotel Guests,09-2018,11.18
Luxury Bedding Shoppers,07-2018,11.15
Luxury Hotel Guests,11-2018,11.14
Furniture Shoppers,10-2018,11.1
Vacation Planners,12-2018,11.08
Gym Equipment Owners,09-2018,11.06
Gym Equipment Owners,11-2018,11.06
Gluten-Free Recipe Researchers,07-2018,11.04
Vacation Planners,02-2019,11.03
Luxury Bedding Shoppers,04-2019,11.01
Portugal Trip Planners,10-2018,11.0
High-End Kids Furniture and Clothes Shoppers,02-2019,10.99
Luxury Hotel Guests,03-2019,10.99
Christmas Celebration Researchers,01-2019,10.96
Natural Pet Food Shoppers,07-2018,10.95
Work Comes First Travelers,07-2018,10.95
High End Camera Shoppers - Dupe,07-2018,10.91
Gym Equipment Owners,12-2018,10.91
Halloween Costume Shoppers,10-2018,10.89
Christmas Celebration Researchers,11-2018,10.88
Bed & Bath Shoppers,07-2018,10.86
Online Home Decor Shoppers,07-2018,10.85
Luxury Bedding Shoppers,08-2018,10.85
Healthy Eaters,07-2018,10.82
Brides & Wedding Planners,07-2018,10.82
Weight Loss Researchers,07-2018,10.8
Luxury Boutique Hotel Researchers,07-2018,10.79
Nutrition Conscious Eaters,07-2018,10.77

2025-01-23 18:07:19 - root - INFO - SQL:
SELECT im."interest_name", COUNT(*) AS "max_count"
FROM "interest_metrics" AS imt
JOIN "interest_map" AS im ON imt."interest_id" = im."id"
GROUP BY im."interest_name"
ORDER BY "max_count" DESC
LIMIT 100
Results:
interest_name,max_count
Pizza Lovers,18
Zoo Visitors,14
Yogis,14
Yale University Fans,14
Yachting Enthusiasts,14
World Cup Enthusiasts,14
World Cup Apparel Shoppers,14
Womens Fashion Brands Shoppers,14
Womens Equality Advocates,14
Wireless Service Provider Researchers,14
Whiskey Lovers,14
Weight Loss Researchers,14
Weight Lifting Enthusiasts,14
Web Design Researchers,14
Water Park Visitors,14
Washington DC Trip Planners,14
Vitamin Shoppers,14
Videographers,14
Video Game Shoppers,14
Venture Capitalists,14
Vegans,14
Vaping Shoppers,14
Vacuum Shoppers,14
Vacation Rental Accommodation Researchers,14
Vacation Planners,14
Used Car Shoppers,14
Urban Skateboarding Sneaker Shoppers,14
United Arab Emirates Trip Planners,14
Travel Reward Points Enthusiasts,14
Travel Researchers,14
Tractor Shoppers,14
Toyota Vehicle Shopper,14
Tire Shoppers,14
Tire Researchers,14
Thrift Store Shoppers,14
Theme Park Researchers,14
Thanksgiving Meal Planners,14
Thanksgiving Entertaining Researchers,14
Texas Trip Planners,14
Texas Energy Providers,14
Tennis Players,14
Teen Girl Clothing Shoppers,14
Tech-Savvy Moms,14
Teachers,14
Tailgaters,14
Sweet Tooths,14
Surfers,14
Supply Chain Professionals,14
Supermarket Shoppers,14
Summer Festivals and Fairs Visitors,14
Summer Activities Researchers,14
Study Abroad Researchers,14
Streaming Music Enthusiasts,14
Stay-at-Home Parents,14
Sports Medicine Health Care Professionals,14
Sports Gamblers,14
Sporting Goods Shoppers,14
Special Olympics Fans,14
Spa and Pool Owners,14
Spa Goers,14
Sony Fans,14
Solar Energy Solution Shoppers,14
Software Directory Researchers,14
Soccer Fans,14
Smart Home Product Researchers,14
Small Business Employees,14
Sleep Disorder Researchers,14
Skin Care Researchers,14
Ski and Snowboard Enthusiasts,14
Ski House Second Home Owners,14
Sightseeing Travelers,14
Shoe Shoppers,14
Shared Work Space Researchers,14
Senior Living Center Researchers,14
Senior Caregivers,14
Seattle Trip Planners,14
Seasonal Allergy Sufferers,14
School Supply Shoppers,14
Satellite TV Buyers,14
Santa Monica Trip Planners,14
San Francisco Trip Planners,14
San Diego Trip Planners,14
Sale Seekers,14
Sailing Enthusiasts,14
SEO Specialists,14
Russia Trip Planners,14
Running Enthusiasts,14
Rugby Fans,14
Roommate Seekers,14
Right Wing Radicals,14
Rideshare App Users,14
Reusable Drinkware Shoppers,14
Retirement Planners,14
Retirees,14
Restaurant Supply Shoppers,14
Restaurant Researchers,14
Restaurant News Readers,14
Respirologists and Pulmonologists,14
Reggaeton Fans,14
Recreational Sports Participants,14

2025-01-23 18:07:50 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 18:07:50 - root - INFO - ```sql
WITH max_comp AS (
  SELECT
    imt."interest_id",
    imt."month_year",
    imt."composition"
  FROM "interest_metrics" imt
  JOIN (
    SELECT
      "interest_id",
      MAX("composition") AS "max_comp"
    FROM "interest_metrics"
    WHERE "composition" IS NOT NULL
    GROUP BY "interest_id"
  ) mc ON imt."interest_id" = mc."interest_id" AND imt."composition" = mc."max_comp"
),
full_data AS (
  SELECT
    im."interest_name" AS "Interest_Name",
    max_comp."month_year" AS "Time(MM-YYYY)",
    max_comp."composition" AS "Composition_Value"
  FROM max_comp
  JOIN "interest_map" im ON max_comp."interest_id" = im."id"
)
SELECT * FROM (
  SELECT * FROM full_data
  ORDER BY "Composition_Value" DESC
  LIMIT 10
)
UNION ALL
SELECT * FROM (
  SELECT * FROM full_data
  ORDER BY "Composition_Value" ASC
  LIMIT 10
)
ORDER BY "Composition_Value" DESC;
```
2025-01-23 18:08:18 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 18:08:18 - root - INFO - SQL:
WITH max_comp AS (
  SELECT
    imt."interest_id",
    imt."month_year",
    imt."composition"
  FROM "interest_metrics" imt
  JOIN (
    SELECT
      "interest_id",
      MAX("composition") AS "max_comp"
    FROM "interest_metrics"
    WHERE "composition" IS NOT NULL
    GROUP BY "interest_id"
  ) mc ON imt."interest_id" = mc."interest_id" AND imt."composition" = mc."max_comp"
),
full_data AS (
  SELECT
    im."interest_name" AS "Interest_Name",
    max_comp."month_year" AS "Time(MM-YYYY)",
    max_comp."composition" AS "Composition_Value"
  FROM max_comp
  JOIN "interest_map" im ON max_comp."interest_id" = im."id"
)
SELECT * FROM (
  SELECT * FROM full_data
  ORDER BY "Composition_Value" DESC
  LIMIT 10
)
UNION ALL
SELECT * FROM (
  SELECT * FROM full_data
  ORDER BY "Composition_Value" ASC
  LIMIT 10
)
ORDER BY "Composition_Value" DESC;
Results:
Interest_Name,Time(MM-YYYY),Composition_Value
Work Comes First Travelers,12-2018,21.2
Gym Equipment Owners,07-2018,18.82
Furniture Shoppers,07-2018,17.44
Luxury Retail Shoppers,07-2018,17.19
Luxury Boutique Hotel Researchers,10-2018,15.15
Luxury Bedding Shoppers,12-2018,15.05
Shoe Shoppers,07-2018,14.91
Cosmetics and Beauty Shoppers,07-2018,14.23
Luxury Hotel Guests,07-2018,14.1
Luxury Retail Researchers,07-2018,13.97
Readers of Jamaican Content,07-2018,1.86
Automotive News Readers,02-2019,1.84
Comedy Fans,07-2018,1.83
World of Warcraft Enthusiasts,08-2019,1.82
Miami Heat Fans,08-2018,1.81
Online Role Playing Game Enthusiasts,07-2018,1.73
Hearthstone Video Game Fans,08-2019,1.66
Scifi Movie and TV Enthusiasts,09-2018,1.61
Action Movie and TV Enthusiasts,09-2018,1.59
The Sims Video Game Fans,03-2019,1.57

2025-01-23 18:08:18 - root - INFO - SQL:
SELECT 
  im."interest_name", 
  imt1."composition" AS "composition_month1",
  imt2."composition" AS "composition_month2",
  (imt2."composition" - imt1."composition") AS "composition_change"
FROM "interest_metrics" AS imt1
JOIN "interest_metrics" AS imt2 ON imt1."interest_id" = imt2."interest_id"
JOIN "interest_map" AS im ON imt1."interest_id" = im."id"
WHERE imt1."month_year" = '01-2019' AND imt2."month_year" = '02-2019'
LIMIT 100
Results:
Too long, hard cut:
interest_name,composition_month1,composition_month2,composition_change
Winter Apparel Shoppers,9.1,9.85,0.75
Mens Shoe Shoppers,6.24,7.43,1.1899999999999995
Fitness Activity Tracker Users,5.29,5.37,0.08000000000000007
Luxury Retail Researchers,5.86,6.55,0.6899999999999995
Competitive Tri-Athletes,6.39,6.41,0.020000000000000462
Preppy Clothing Shoppers,6.33,6.88,0.5499999999999998
Luxury Home Fixture Shoppers,6.96,7.64,0.6799999999999997
Shoe Shoppers,5.28,6.59,1.3099999999999996
Running Enthusiasts,3.79,4.3,0.5099999999999998
Work Comes First Travelers,18.99,18.39,-0.5999999999999979
Family Adventures Travelers,7.88,7.51,-0.3700000000000001
Womens Fashion Brands Shoppers,6.15,5.94,-0.20999999999999996
Apartment Furniture Shoppers,4.08,4.68,0.5999999999999996
World Cup Enthusiasts,5.76,6.92,1.1600000000000001
"Work Hard, Play Hard Travelers",7.37,7.63,0.2599999999999998
Beach Supplies Shoppers,11.71,12.85,1.1399999999999988
At-Home Gym Intenders,4.74,5.65,0.9100000000000001
Aspen Skiers and Snowboarders,5.56,6.03,0.47000000000000064
Kids Clothing Shoppers,4.95,5.18,0.22999999999999954
Luxury Boutique Hotel Researchers,12.26,13.64,1.3800000000000008
Parents of Teenagers Going to College,5.75,6.09,0.33999999999999986
Competitive Sports Participants,3.69,4.64,0.9499999999999997
Luxury Bedding Shoppers,14.92,14.39,-0.5299999999999994
Vacation Planners,9.25,11.03,1.7799999999999994
Trendy Denim Shoppers,5.11,4.95,-0.16000000000000014
Ski and Snowboard Apparel Shoppers,4.91,5.92,1.0099999999999998
Luxury Retail Shoppers,10.42,9.99,-0.4299999999999997
Luxury Kitchen Goods Shoppers,5.25,6.06,0.8099999999999996
Big & Tall Men,4.7,5.6,0.8999999999999995
Swimming Enthusiasts,3.98,4.72,0.7399999999999998
Home Decor Shoppers,3.74,4.52,0.7799999999999994
High-End Kids Furniture and Clothes Shoppers,11.75,10.99,-0.7599999999999998
Colorado Skiers and Snowboarders,4.75,6.17,1.42
Lacrosse Enthusiasts,5.25,6.05,0.7999999999999998
Urban Skateboarding Sneaker Shoppers,7.0,7.54,0.54
Furniture Shoppers,9.23,10.08,0.8499999999999996
Cycling Enthusiasts,3.48,4.43,0.9499999999999997
Reusable Drinkware Shoppers,4.61,5.86,1.25
Vacation Rental Accommodation Researchers,4.22,5.01,0.79
Olympics Fans,4.13,5.36,1.2300000000000004
Golf Enthusiasts,3.84,5.06,1.2199999999999998
Japanese Luxury Car Enthusiasts,5.25,6.1,0.8499999999999996
Luggage Shoppers,4.58,5.97,1.3899999999999997
Vermont Trip Planners,4.7,5.44,0.7400000000000002
Fishing Equipment Shoppers,5.23,5.98,0.75
Luxury Hotel Guests,10.12,12.41,2.290000000000001
Sporting Goods Shoppers,3.54,4.83,1.29
Gym Equipment Owners,9.43,10.61,1.1799999999999997
World Cup Apparel Shoppers,4.53,4.83,0.2999999999999998
Western Canada Skiers and Snowboarders,4.38,5.35,0.9699999999999998
Kitchen Appliance Shoppers,3.84,5.08,1.2400000000000002
Sports Medicine Health Care Professionals,5.17,5.54,0.3700000000000001
Getting Off the Grid Travelers,5.75,6.59,0.8399999999999999
Luxury Womens Brands Shoppers,5.32,5.9,0.5800000000000001
Pandora Jewelry Shoppers,5.79,5.31,-0.4800000000000004
Flight and Hotel Shoppers,8.45,9.57,1.120000000000001
European Trip Planners,4.46,4.97,0.5099999999999998
Hanukkah Decorations Shoppers,4.85,5.16,0.3100000000000005
Utility Workwear Shoppers,3.88,5.59,1.71
Ski House Second Home Owners,3.37,4.36,0.9900000000000002
Sports Memorabilia Shoppers,3.51,4.54,1.0300000000000002
Luxury Department Store Shoppers,5.62,5.57,-0.04999999999999982
Leather Goods Shoppers,3.59,4.8,1.21
Big East Fans,3.38,3.77,0.3900000000000001
Discount Womens Shoes Shoppers,3.3,3.03,-0.27
Identity Theft Protection Researchers,4.72,5.1,0.3799999999999999
Luxury Travel Researchers,3.04,4.26,1.2199999999999998
Christmas Celebration Researchers,10.96,10.52,-0.4400000000000013
Affordable Hotel Bookers,4.36,5.06,0.6999999999999993
Costa Rica Trip Planners,4.47,4.68,0.20999999999999996
Major Airline Customers,4.7,5.58,0.8799999999999999
Price Conscious Home Shoppers,3.1,3.49,0.3900000000000001
North Carolina Football Fans,3.82,5.21,1.3900000000000001
Online Home Decor Shoppers,2.88,3.79,0.9100000000000001
Jewelry & Watch Shoppers,3.53,3.8,0.27
Indoor Cycling & Spinning Enthusiasts,6.77,7.68,0.9100000000000001
Sun Protection Shoppers,3.93,4.38,0.44999999999999973
Kitchen and Home Goods Shoppers,4.16,4.33,0.16999999999999993
Special Olympics Fans,3.97,4.19,0.2200000000000002
NCAA Fans,2.8,3.81,1.0100000000000002
New York Trip Planners,4.47,4.59,0.1200000000000001
Broadway Fans,3.43,4.04,0.6099999999999999
Soap Shoppers,3.51,3.92,0.41000000000000014
Countdown to the Beach Travelers,5.31,4.91,-0.39999999999999947
Neurologists,4.65,4.8,0.14999999999999947
Online Grocery Shoppers,8.29,8.96,0.6700000000000017
Jazz Festival Enthusiasts,3.81,3.75,-0.06000000000000005
Canoeing and Kayaking Enthusiasts,4.23,4.68,0.4499999999999993
Chandelier and Lamp Shoppers,3.56,3.73,0.16999999999999993
Halloween Costume Shoppers,8.9,9.3,0.40000000000000036
Embroidery Enthusiasts,4.3,5.3,1.0
Patio Furniture Shoppers,9.31,10.38,1.07000000

2025-01-23 18:08:42 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 18:08:42 - root - INFO - ```sql
SELECT im."interest_name", imt."month_year", imt."composition"
FROM "interest_metrics" AS imt
JOIN "interest_map" AS im ON imt."interest_id" = im."id"
WHERE imt."month_year" = (
  SELECT "month_year" FROM "interest_metrics"
  WHERE "month_year" IS NOT NULL AND "month_year" != ''
  ORDER BY SUBSTR("month_year", 4, 4) || SUBSTR("month_year", 1, 2) DESC
  LIMIT 1
)
AND imt."composition" = (
  SELECT MAX("composition")
  FROM "interest_metrics"
  WHERE "interest_id" = imt."interest_id"
)
ORDER BY imt."composition" DESC
LIMIT 100;
```

**Explanation:**

The error occurs because in the subquery within the `WHERE` clause, the alias `imt` is not defined. Inside the subquery, you're selecting from `"interest_metrics"` without any alias, so you should reference the columns directly without the `imt.` prefix.

I have corrected the subquery by removing `imt.` before `"month_year"` in the `ORDER BY` clause:

- Changed `ORDER BY SUBSTR(imt."month_year", 4, 4) || SUBSTR(imt."month_year", 1, 2) DESC` to `ORDER BY SUBSTR("month_year", 4, 4) || SUBSTR("month_year", 1, 2) DESC`.

This should resolve the error and allow the query to execute properly.
2025-01-23 18:08:53 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 18:08:53 - root - INFO - SQL:
SELECT im."interest_name", imt."month_year", imt."composition"
FROM "interest_metrics" AS imt
JOIN "interest_map" AS im ON imt."interest_id" = im."id"
WHERE imt."month_year" = (
  SELECT "month_year" FROM "interest_metrics"
  WHERE "month_year" IS NOT NULL AND "month_year" != ''
  ORDER BY SUBSTR("month_year", 4, 4) || SUBSTR("month_year", 1, 2) DESC
  LIMIT 1
)
AND imt."composition" = (
  SELECT MAX("composition")
  FROM "interest_metrics"
  WHERE "interest_id" = imt."interest_id"
)
ORDER BY imt."composition" DESC
LIMIT 100;
Results:
interest_name,month_year,composition
Elite Cycling Gear Shoppers,08-2019,4.75
Swimming Enthusiasts,08-2019,4.73
High School Sports Researchers,08-2019,4.57
Mens Business Clothes Shoppers,08-2019,4.47
Home Lending Researchers,08-2019,3.98
Duke Blue Devils Fans,08-2019,3.96
Cape Cod News Readers,08-2019,3.94
Mens Underwear Shoppers,08-2019,3.87
PBS Enthusiasts,08-2019,3.58
Online Calculator Users,08-2019,3.54
Fundraising Advocates,08-2019,3.54
Asheville Trip Planners,08-2019,3.52
Opera Enthusiasts,08-2019,3.51
Foot Health Researchers,08-2019,3.45
Kansas City Royals Fans,08-2019,3.44
ESPN Enthusiasts,08-2019,3.41
Self Storage Shoppers,08-2019,3.38
Craft Beer Enthusiasts,08-2019,3.3
Satellite TV Buyers,08-2019,3.26
Skin Disorder Researchers,08-2019,3.23
Cleveland Indians Fans,08-2019,3.19
Home Medical Supplies Shoppers,08-2019,3.14
Football Enthusiasts,08-2019,3.11
Medical Technology News Readers,08-2019,3.11
Syracuse Orange Fans,08-2019,3.07
Northwestern Wildcats Fans,08-2019,3.04
Rome Trip Planners,08-2019,3.04
Farm Finance Researchers,08-2019,3.03
Ebay Shoppers,08-2019,3.02
Brooklyn Nets Fans,08-2019,3.01
Notre Dame Fighting Irish Fans,08-2019,2.99
UNC Tar Heels Fans,08-2019,2.97
Jeep Vehicle Shoppers,08-2019,2.97
ACC Fans,08-2019,2.95
Utah Jazz Fans,08-2019,2.93
Food Delivery Service Users,08-2019,2.92
HGTV Enthusiasts,08-2019,2.88
Dairy Industry New Readers,08-2019,2.84
Agriculture and Climate Advocates,08-2019,2.84
Retired Budget Healthcare Shoppers,08-2019,2.83
Cattlemen and Pork Producers,08-2019,2.83
St. Louis Cardinals Fans,08-2019,2.82
Memphis Grizzlies Fans,08-2019,2.78
New Orleans Activities Researchers,08-2019,2.78
Philadelphia 76ers Fans,08-2019,2.77
Cincinnati Bengals Fans,08-2019,2.76
Agricultural and Food Issues Researchers,08-2019,2.76
Tractor Shoppers,08-2019,2.75
Kentucky Wildcats Fans,08-2019,2.74
Chicago Cubs Fans,08-2019,2.73
Horseback Riding Enthusiasts,08-2019,2.73
New York Jets Fans,08-2019,2.72
Minnesota Twins Fans,08-2019,2.72
Milwaukee Bucks Fans,08-2019,2.71
Veterinarians,08-2019,2.71
New York Knicks Fans,08-2019,2.7
New Orleans Saints Fans,08-2019,2.7
Denver Nuggets Fans,08-2019,2.69
Ice Cream Shoppers,08-2019,2.69
Tennessee Titans Fans,08-2019,2.68
New York Giants Fans,08-2019,2.68
Sudoku Players,08-2019,2.67
Pittsburgh Pirates Fans,08-2019,2.67
Arizona Cardinals Fans,08-2019,2.66
Jacksonville Jaguars Fans,08-2019,2.66
Tampa Bay Buccaneers Fans,08-2019,2.66
Los Angeles Rams Fans,08-2019,2.65
Indiana Hoosiers Fans,08-2019,2.64
Civil War History Buff,08-2019,2.64
Los Angeles Chargers Fans,08-2019,2.63
Portland Trail Blazers Fans,08-2019,2.63
Los Angeles Clippers Fans,08-2019,2.63
Pizza Lovers,08-2019,2.63
Homeschooling Parents,08-2019,2.63
Minnesota Timberwolves Fans,08-2019,2.61
Online Legal Document Service Researchers,08-2019,2.61
Indianapolis Colts Fans,08-2019,2.61
Ice Skating Enthusiasts,08-2019,2.61
Automotive Service Professionals,08-2019,2.61
Background Check Users,08-2019,2.61
Big Box Shoppers,08-2019,2.6
UConn Huskies Fans,08-2019,2.59
Bitcoin Enthusiasts,08-2019,2.59
Atlanta Hawks Fans,08-2019,2.58
Ohio State Buckeyes Fans,08-2019,2.57
Online Payroll Services Users,08-2019,2.57
Cosmetic Surgery Intenders,08-2019,2.56
Crossword Puzzles Players,08-2019,2.56
Cocktail Recipe Researchers,08-2019,2.56
Indiana Pacers Fans,08-2019,2.55
DIY Upcycle Home Project Planners,08-2019,2.55
Oklahoma City Thunder Fans,08-2019,2.54
Michigan Wolverines Fans,08-2019,2.54
Orlando Magic Fans,08-2019,2.54
Heart Surgery Researchers,08-2019,2.54
Board Game Enthusiasts,08-2019,2.52
Dallas Mavericks Fans,08-2019,2.51
Home Heating and Cooling Researchers,08-2019,2.51
Tea Party Policy Supporters,08-2019,2.5
Work Visa Researchers,08-2019,2.5

2025-01-23 18:08:53 - root - INFO - itercount: 0
2025-01-23 18:08:53 - root - INFO - Table: weekly_salesDDL:
CREATE TABLE "weekly_sales" (
"week_date" TEXT,
  "region" TEXT,
  "platform" TEXT,
  "segment" TEXT,
  "customer_type" TEXT,
  "transactions" INTEGER,
  "sales" INTEGER
)
Table: shopping_cart_usersDDL:
CREATE TABLE "shopping_cart_users" (
"user_id" INTEGER,
  "cookie_id" TEXT,
  "start_date" TEXT
)
Table: bitcoin_membersDDL:
CREATE TABLE "bitcoin_members" (
"member_id" TEXT,
  "first_name" TEXT,
  "region" TEXT
)
Table: interest_metricsDDL:
CREATE TABLE "interest_metrics" (
"_month" REAL,
  "_year" REAL,
  "month_year" TEXT,
  "interest_id" REAL,
  "composition" REAL,
  "index_value" REAL,
  "ranking" INTEGER,
  "percentile_ranking" REAL
)
Table: customer_regionsDDL:
CREATE TABLE "customer_regions" (
"region_id" INTEGER,
  "region_name" TEXT
)
Table: customer_transactionsDDL:
CREATE TABLE "customer_transactions" (
"customer_id" INTEGER,
  "txn_date" TEXT,
  "txn_type" TEXT,
  "txn_amount" INTEGER
)
Table: bitcoin_transactionsDDL:
CREATE TABLE "bitcoin_transactions" (
"txn_id" INTEGER,
  "member_id" TEXT,
  "ticker" TEXT,
  "txn_date" TEXT,
  "txn_type" TEXT,
  "quantity" REAL,
  "percentage_fee" REAL,
  "txn_time" TEXT
)
Table: customer_nodesDDL:
CREATE TABLE "customer_nodes" (
"customer_id" INTEGER,
  "region_id" INTEGER,
  "node_id" INTEGER,
  "start_date" TEXT,
  "end_date" TEXT
)
Table: cleaned_weekly_salesDDL:
CREATE TABLE "cleaned_weekly_sales" (
"week_date_formatted" TEXT,
  "week_date" TEXT,
  "region" TEXT,
  "platform" TEXT,
  "segment" TEXT,
  "customer_type" TEXT,
  "transactions" INTEGER,
  "sales" INTEGER,
  "week_number" INTEGER,
  "month_number" INTEGER,
  "calendar_year" INTEGER,
  "age_band" TEXT,
  "demographic" TEXT,
  "avg_transaction" REAL
)
Table: veg_txn_dfDDL:
CREATE TABLE "veg_txn_df" (
"index" INTEGER,
  "txn_date" TEXT,
  "txn_time" TEXT,
  "item_code" INTEGER,
  "qty_sold(kg)" REAL,
  "unit_selling_px_rmb/kg" REAL,
  "sale/return" TEXT,
  "discount(%)" INTEGER,
  "day_of_week" TEXT
)
Table: shopping_cart_eventsDDL:
CREATE TABLE "shopping_cart_events" (
"visit_id" TEXT,
  "cookie_id" TEXT,
  "page_id" INTEGER,
  "event_type" INTEGER,
  "sequence_number" INTEGER,
  "event_time" TEXT
)
Table: shopping_cart_page_hierarchyDDL:
CREATE TABLE "shopping_cart_page_hierarchy" (
"page_id" INTEGER,
  "page_name" TEXT,
  "product_category" TEXT,
  "product_id" REAL
)
Table: bitcoin_pricesDDL:
CREATE TABLE "bitcoin_prices" (
"ticker" TEXT,
  "market_date" TEXT,
  "price" REAL,
  "open" REAL,
  "high" REAL,
  "low" REAL,
  "volume" TEXT,
  "change" TEXT
)
Table: interest_mapDDL:
CREATE TABLE "interest_map" (
"id" INTEGER,
  "interest_name" TEXT,
  "interest_summary" TEXT,
  "created_at" TEXT,
  "last_modified" TEXT
)
Table: veg_loss_rate_dfDDL:
CREATE TABLE "veg_loss_rate_df" (
"index" INTEGER,
  "item_code" INTEGER,
  "item_name" TEXT,
  "loss_rate_%" REAL
)
Table: shopping_cart_campaign_identifierDDL:
CREATE TABLE "shopping_cart_campaign_identifier" (
"campaign_id" INTEGER,
  "products" TEXT,
  "campaign_name" TEXT,
  "start_date" TEXT,
  "end_date" TEXT
)
Table: veg_catDDL:
CREATE TABLE "veg_cat" (
"index" INTEGER,
  "item_code" INTEGER,
  "item_name" TEXT,
  "category_code" INTEGER,
  "category_name" TEXT
)
Table: veg_whsle_dfDDL:
CREATE TABLE "veg_whsle_df" (
"index" INTEGER,
  "whsle_date" TEXT,
  "item_code" INTEGER,
  "whsle_px_rmb-kg" REAL
)
Table: shopping_cart_event_identifierDDL:
CREATE TABLE "shopping_cart_event_identifier" (
"event_type" INTEGER,
  "event_name" TEXT
)
External knowledge that might be helpful: 
None
The table structure information is (table names): 
['weekly_sales', 'shopping_cart_users', 'bitcoin_members', 'interest_metrics', 'customer_regions', 'customer_transactions', 'bitcoin_transactions', 'customer_nodes', 'cleaned_weekly_sales', 'veg_txn_df', 'shopping_cart_events', 'shopping_cart_page_hierarchy', 'bitcoin_prices', 'interest_map', 'veg_loss_rate_df', 'shopping_cart_campaign_identifier', 'veg_cat', 'veg_whsle_df', 'shopping_cart_event_identifier']
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Tables:**
  - `"interest_metrics"`: Contains monthly metrics for various interest categories.
  - `"interest_map"`: Maps interest IDs to their names and summaries.

- **Columns in `"interest_metrics"`:**
  - `"interest_id"`: Identifies the interest category.
  - `"month_year"`: The time in 'MM-YYYY' format.
  - `"composition"`: The composition value for the interest category at a given time.

- **Columns in `"interest_map"`:**
  - `"id"`: Corresponds to `"interest_id"` in `"interest_metrics"`.
  - `"interest_name"`: The name of the interest category.

**Potential Usage:**

- **"interest_id"**: Used to link the metrics to the interest names.
- **"month_year"**: Used to identify the time period for each metric.
- **"composition"**: Used to find the highest and lowest composition values.
- **"interest_name"**: Used to display the names of the interest categories.

**Conditions That May Be Used:**

- Join `"interest_metrics"` and `"interest_map"` on `"interest_id"` = `"id"`.
- Group by `"interest_id"` or `"interest_name"` to aggregate data.
- Order by `"composition"` to find top and bottom interest categories.
- Use subqueries to find maximum composition values for each interest category.

---

**SQL Queries:**

1. **Retrieve distinct interest IDs from the interest metrics table:**
   ```sql
   SELECT DISTINCT "interest_id"
   FROM "interest_metrics"
   LIMIT 100;
   ```

2. **Retrieve distinct interest names from the interest map table:**
   ```sql
   SELECT DISTINCT "interest_name"
   FROM "interest_map"
   LIMIT 100;
   ```

3. **Join interest metrics with interest map to get interest IDs and their names:**
   ```sql
   SELECT DISTINCT imt."interest_id", im."interest_name"
   FROM "interest_metrics" AS imt
   JOIN "interest_map" AS im ON imt."interest_id" = im."id"
   LIMIT 100;
   ```

4. **List all distinct month-year values from the interest metrics table:**
   ```sql
   SELECT DISTINCT "month_year"
   FROM "interest_metrics"
   LIMIT 100;
   ```

5. **Get the maximum composition value for each interest category:**
   ```sql
   SELECT "interest_id", MAX("composition") AS "max_composition"
   FROM "interest_metrics"
   GROUP BY "interest_id"
   LIMIT 100;
   ```

6. **Retrieve composition values over time for each interest category:**
   ```sql
   SELECT "interest_id", "month_year", "composition"
   FROM "interest_metrics"
   ORDER BY "interest_id", "month_year"
   LIMIT 100;
   ```

7. **Find the highest composition value and corresponding interest name for each category:**
   ```sql
   SELECT im."interest_name", MAX(imt."composition") AS "max_composition"
   FROM "interest_metrics" AS imt
   JOIN "interest_map" AS im ON imt."interest_id" = im."id"
   GROUP BY im."interest_name"
   LIMIT 100;
   ```

8. **List interest categories with their maximum composition values and times:**
   ```sql
   SELECT imt."interest_id", imt."month_year", imt."composition"
   FROM "interest_metrics" AS imt
   WHERE imt."composition" = (
     SELECT MAX("composition")
     FROM "interest_metrics"
     WHERE "interest_id" = imt."interest_id"
   )
   ORDER BY imt."interest_id"
   LIMIT 100;
   ```

9. **Identify the top 10 interest categories based on their highest composition values:**
   ```sql
   SELECT im."interest_name", MAX(imt."composition") AS "max_composition"
   FROM "interest_metrics" AS imt
   JOIN "interest_map" AS im ON imt."interest_id" = im."id"
   GROUP BY im."interest_name"
   ORDER BY MAX(imt."composition") DESC
   LIMIT 10;
   ```

10. **Identify the bottom 10 interest categories based on their highest composition values:**
    ```sql
    SELECT im."interest_name", MAX(imt."composition") AS "max_composition"
    FROM "interest_metrics" AS imt
    JOIN "interest_map" AS im ON imt."interest_id" = im."id"
    GROUP BY im."interest_name"
    ORDER BY MAX(imt."composition") ASC
    LIMIT 10;
    ```

11. **Retrieve top 10 interest categories with the time of their highest composition values:**
    ```sql
    SELECT im."interest_name", imt."month_year", imt."composition"
    FROM "interest_metrics" AS imt
    JOIN "interest_map" AS im ON imt."interest_id" = im."id"
    WHERE imt."composition" = (
      SELECT MAX("composition")
      FROM "interest_metrics"
      WHERE "interest_id" = imt."interest_id"
    )
    ORDER BY imt."composition" DESC
    LIMIT 10;
    ```

12. **Retrieve bottom 10 interest categories with the time of their highest composition values:**
    ```sql
    SELECT im."interest_name", imt."month_year", imt."composition"
    FROM "interest_metrics" AS imt
    JOIN "interest_map" AS im ON imt."interest_id" = im."id"
    WHERE imt."composition" = (
      SELECT MAX("composition")
      FROM "interest_metrics"
      WHERE "interest_id" = imt."interest_id"
    )
    ORDER BY imt."composition" ASC
    LIMIT 10;
    ```

13. **List the interest categories along with their minimum composition values and times:**
    ```sql
    SELECT imt."interest_id", imt."month_year", imt."composition"
    FROM "interest_metrics" AS imt
    WHERE imt."composition" = (
      SELECT MIN("composition")
      FROM "interest_metrics"
      WHERE "interest_id" = imt."interest_id"
    )
    ORDER BY imt."interest_id"
    LIMIT 100;
    ```

14. **Find the average composition value for each interest category:**
    ```sql
    SELECT im."interest_name", AVG(imt."composition") AS "avg_composition"
    FROM "interest_metrics" AS imt
    JOIN "interest_map" AS im ON imt."interest_id" = im."id"
    GROUP BY im."interest_name"
    LIMIT 100;
    ```

15. **Retrieve the top 10 interest categories based on their average composition values:**
    ```sql
    SELECT im."interest_name", AVG(imt."composition") AS "avg_composition"
    FROM "interest_metrics" AS imt
    JOIN "interest_map" AS im ON imt."interest_id" = im."id"
    GROUP BY im."interest_name"
    ORDER BY AVG(imt."composition") DESC
    LIMIT 10;
    ```

16. **Identify interest categories with composition values greater than a threshold (e.g., 0.8):**
    ```sql
    SELECT im."interest_name", imt."month_year", imt."composition"
    FROM "interest_metrics" AS imt
    JOIN "interest_map" AS im ON imt."interest_id" = im."id"
    WHERE imt."composition" > 0.8
    ORDER BY imt."composition" DESC
    LIMIT 100;
    ```

17. **Count the number of times each interest category reached its maximum composition value:**
    ```sql
    SELECT im."interest_name", COUNT(*) AS "max_count"
    FROM "interest_metrics" AS imt
    JOIN "interest_map" AS im ON imt."interest_id" = im."id"
    WHERE imt."composition" = (
      SELECT MAX("composition")
      FROM "interest_metrics"
      WHERE "interest_id" = imt."interest_id"
    )
    GROUP BY im."interest_name"
    LIMIT 100;
    ```

18. **List interest categories and their composition values for a specific month (e.g., '06-2022'):**
    ```sql
    SELECT im."interest_name", imt."composition"
    FROM "interest_metrics" AS imt
    JOIN "interest_map" AS im ON imt."interest_id" = im."id"
    WHERE imt."month_year" = '06-2022'
    ORDER BY imt."composition" DESC
    LIMIT 100;
    ```

19. **Find the change in composition value for each interest category between two months:**
    ```sql
    SELECT im."interest_name", 
           imt1."composition" AS "composition_month1",
           imt2."composition" AS "composition_month2",
           (imt2."composition" - imt1."composition") AS "composition_change"
    FROM "interest_metrics" AS imt1
    JOIN "interest_metrics" AS imt2 ON imt1."interest_id" = imt2."interest_id"
    JOIN "interest_map" AS im ON imt1."interest_id" = im."id"
    WHERE imt1."month_year" = '01-2022' AND imt2."month_year" = '02-2022'
    LIMIT 100;
    ```

20. **Identify interest categories where the maximum composition value occurred in the latest month:**
    ```sql
    SELECT im."interest_name", imt."month_year", imt."composition"
    FROM "interest_metrics" AS imt
    JOIN "interest_map" AS im ON imt."interest_id" = im."id"
    WHERE imt."month_year" = (
      SELECT MAX("month_year") FROM "interest_metrics"
    )
    AND imt."composition" = (
      SELECT MAX("composition")
      FROM "interest_metrics"
      WHERE "interest_id" = imt."interest_id"
    )
    ORDER BY imt."composition" DESC
    LIMIT 100;
    ```

---

These queries progressively explore the data in the relevant tables, helping to understand the composition values for different interest categories over time. They range from simple data retrieval to more complex aggregations and calculations, building towards identifying the top 10 and bottom 10 interest categories based on their highest composition values.Query:
SELECT DISTINCT "interest_id"
   FROM "interest_metrics"
   LIMIT 100;
Answer:
interest_id
32486.0
6106.0
18923.0
6344.0
100.0
69.0
79.0
6111.0
6214.0
19422.0
6110.0
4895.0
6217.0
4.0
6218.0
6123.0
171.0
19613.0
17.0
6.0
6013.0
4870.0
19423.0
6089.0
161.0
6286.0
5991.0
92.0
6184.0
19621.0
63.0
103.0
38.0
17786.0
6232.0
165.0
18351.0
15.0
""
17314.0
6151.0
4914.0
115.0
5968.0
36.0
5943.0
133.0
1.0
114.0
6107.0
150.0
60.0
96.0
22403.0
40.0
19758.0
17730.0
5938.0
4869.0
4897.0
6029.0
31.0
16137.0
6330.0
6334.0
6315.0
4852.0
16.0
6108.0
6206.0
6006.0
6228.0
20768.0
4902.0
6277.0
19757.0
4911.0
4910.0
6285.0
11974.0
6219.0
10250.0
6128.0
5946.0
158.0
15935.0
4855.0
149.0
16197.0
11067.0
17674.0
4913.0
56.0
6341.0
6316.0
18647.0
17803.0
23.0
132.0
6365.0
Query:
SELECT DISTINCT "interest_name"
   FROM "interest_map"
   LIMIT 100;
Answer:
interest_name
Fitness Enthusiasts
Gamers
Car Enthusiasts
Luxury Retail Researchers
Brides & Wedding Planners
Vacation Planners
Motorcycle Enthusiasts
Business News Readers
Thrift Store Shoppers
Advertising Professionals
NFL Fans
NBA Fans
NCAA Fans
MLB Fans
Nascar Fans
Eco-Conscious Consumers
Moviegoers
DIYers
Grill Masters
Techies
Home Design Enthusiasts
Doctors
Streaming Video Fans
Auto Insurance Shoppers
Teachers
College Students
Department Store Shoppers
Home Decor Shoppers
Kids Clothing Shoppers
Teen Girl Clothing Shoppers
Mens Clothing Shoppers
Baby Products Buyers
Jewelry & Watch Shoppers
Sporting Goods Shoppers
Furniture Shoppers
Bed & Bath Shoppers
Intimates Shoppers
Fast Fashion Shoppers
Apartment Hunters
Home Buyers
Moving Services Shoppers
Job Seekers
Charitable Donors
NHL Fans
Discount Big Box Shoppers
Black Friday Deal Shoppers
Hip Hop Fans
Online Investors
Seasonal Allergy Sufferers
Discount Device Shoppers
Mobile Phone Comparison Shoppers
Budget Wireless Shoppers
Menopause Researchers
Online Health Researchers
Beauty & Skincare Buyers
Streaming Device Shoppers
New & Expecting Parents
High-End Kids Furniture and Clothes Shoppers
Hands-On Parents
Fantasy & Comic Fans
Lawyers
Healthy Eaters
Drug Store Shoppers
Lawn & Garden Enthusiasts
Nurses
Mailing & Shipping Shoppers
Office Supply Shoppers
Ink & Toner Shoppers
Luxury Retail Shoppers
Contractors & Construction Professionals
Luxury Travel Researchers
Democrats
Republicans
HDTV Researchers
Hardware Shoppers
Reggaeton Fans
Online Movie Downloaders
Sale Seekers
Theme Park Researchers
Ski and Snowboard Enthusiasts
Travel Researchers
Coupon Researchers
Parents with Toddlers
Parents with Kids
Young Boomers
Day Care Users
Stay-at-Home Parents
Exercise and Gym Researchers
Home Kitchen Chefs
Restaurant Researchers
Order-in Eaters
Nutrition Conscious Eaters
Flower & Gift Basket Shoppers
Plus Size Women
Live Concert Fans
Country Music Fans
Comedy Fans
Cruise Travel Intenders
Pain Medication Users
Joint Pain Sufferers
Query:
SELECT DISTINCT imt."interest_id", im."interest_name"
   FROM "interest_metrics" AS imt
   JOIN "interest_map" AS im ON imt."interest_id" = im."id"
   LIMIT 100;
Answer:
interest_id,interest_name
32486.0,Vacation Rental Accommodation Researchers
6106.0,Luxury Second Home Owners
18923.0,Online Home Decor Shoppers
6344.0,Hair Care Shoppers
100.0,Nutrition Conscious Eaters
69.0,Healthy Eaters
79.0,Luxury Travel Researchers
6111.0,Wine Lovers
6214.0,Home Remodelers
19422.0,Home Design and Living Publication Readers
6110.0,Apartment Furniture Shoppers
4895.0,Mature Parents
6217.0,Weight Loss Researchers
4.0,Luxury Retail Researchers
6218.0,Running Enthusiasts
6123.0,Misc-Deal Seekers or Coupon Shoppers
171.0,Shoe Shoppers
19613.0,Land Rover Shoppers
17.0,MLB Fans
6.0,Vacation Planners
6013.0,Competitive Sports Participants
4870.0,Tech-Savvy Moms
19423.0,Kitchen Appliance Shoppers
6089.0,Mens Fitness Publication Readers
161.0,Travel Reward Points Enthusiasts
6286.0,Luxury Hotel Guests
5991.0,Gluten-Free Recipe Researchers
92.0,Parents with Kids
6184.0,Reusable Drinkware Shoppers
19621.0,Portugal Trip Planners
63.0,New & Expecting Parents
103.0,Live Concert Fans
38.0,Sporting Goods Shoppers
17786.0,Womens Fashion Brands Shoppers
6232.0,Golf Enthusiasts
165.0,Liberal News Readers
18351.0,Drama Show Watchers
15.0,NBA Fans
17314.0,Lobbyists
6151.0,Wedding Registrants
4914.0,Mens Health Researchers
115.0,Mens Shoe Shoppers
5968.0,Luxury Kitchen Goods Shoppers
36.0,Baby Products Buyers
5943.0,Financial News Readers
133.0,High End Camera Shoppers - Dupe
1.0,Fitness Enthusiasts
114.0,Womens Fashion Magazine Readers
6107.0,Ski House Second Home Owners
150.0,TV Junkies
60.0,Online Health Researchers
96.0,Exercise and Gym Researchers
22403.0,Pandora Jewelry Shoppers
40.0,Bed & Bath Shoppers
19758.0,Dog Lovers
17730.0,Luxury Department Store Shoppers
5938.0,Costa Rica Trip Planners
4869.0,Womens Fitness Enthusiasts
4897.0,Parents of Teenagers Going to College
6029.0,Indoor Cycling & Spinning Enthusiasts
31.0,Home Decor Shoppers
16137.0,Olympics Fans
6330.0,Pet Store Goers
6334.0,Supermarket Shoppers
6315.0,Boston Trip Planners
4852.0,Health & Fitness
16.0,NCAA Fans
6108.0,Beach House Second Home Owners
6206.0,Preppy Clothing Shoppers
6006.0,Breast Cancer Fund Raisers
6228.0,Paleo Eaters
20768.0,Beer Aficionados
4902.0,Yogis
6277.0,Harry Potter Fans
19757.0,Natural Pet Food Shoppers
4911.0,Dieters
4910.0,Cholesterol Researchers
6285.0,Competitive Tri-Athletes
11974.0,Price Conscious Home Shoppers
6219.0,Cycling Enthusiasts
10250.0,Halloween Costume Shoppers
6128.0,Realtors & Real Estate Researchers
5946.0,Readers of Filipinos Content
158.0,Flight and Hotel Shoppers
15935.0,Pregnancy Resources Researchers
4855.0,Entertainment & Tabloid Magazine Readers
149.0,Streaming Radio Listeners
16197.0,Financial Business Intelligence Researchers
11067.0,NCAA Football Fans
17674.0,Medical Advice Researchers
4913.0,Womens Health Researchers
56.0,Discount Device Shoppers
6341.0,Pharmacy Shoppers
6316.0,Philadelphia Trip Planners
18647.0,Gourmet Food & Wine Researchers
17803.0,TV Advertising Professionals
23.0,Techies
132.0,Apple Fans
6365.0,Executive and C-Suite
6378.0,Luggage Shoppers
Query:
SELECT DISTINCT "month_year"
   FROM "interest_metrics"
   LIMIT 100;
Answer:
month_year
07-2018
""
08-2018
09-2018
10-2018
11-2018
12-2018
01-2019
02-2019
03-2019
04-2019
05-2019
06-2019
07-2019
08-2019
Query:
SELECT "interest_id", MAX("composition") AS "max_composition"
   FROM "interest_metrics"
   GROUP BY "interest_id"
   LIMIT 100;
Answer:
interest_id,max_composition
,9.66
1.0,7.02
2.0,3.09
3.0,6.14
4.0,13.97
5.0,10.82
6.0,12.56
7.0,2.64
8.0,6.67
12.0,7.23
13.0,6.72
14.0,3.53
15.0,6.9
16.0,6.24
17.0,7.89
18.0,3.18
19.0,6.57
20.0,4.08
21.0,5.26
22.0,6.26
23.0,5.41
24.0,6.54
25.0,4.31
26.0,6.01
27.0,6.81
28.0,7.36
29.0,5.2
30.0,8.56
31.0,7.9
33.0,7.6
34.0,11.23
35.0,5.25
36.0,9.27
37.0,7.82
38.0,9.48
39.0,17.44
40.0,10.86
41.0,6.96
42.0,4.9
43.0,5.98
44.0,6.11
45.0,6.29
46.0,3.4
48.0,5.55
49.0,5.09
50.0,3.86
51.0,2.67
53.0,3.03
54.0,3.88
55.0,7.67
56.0,7.09
57.0,2.32
58.0,2.18
59.0,3.97
60.0,8.66
61.0,6.59
62.0,4.15
63.0,9.37
64.0,12.41
65.0,5.94
66.0,6.51
67.0,6.76
69.0,10.82
70.0,6.96
71.0,3.43
72.0,3.63
73.0,7.06
74.0,7.37
75.0,7.23
77.0,17.19
78.0,2.78
79.0,11.21
80.0,4.47
81.0,3.31
82.0,9.99
83.0,4.64
84.0,3.88
85.0,6.46
86.0,6.13
87.0,5.01
88.0,4.99
89.0,10.14
90.0,5.91
91.0,5.87
92.0,9.77
93.0,7.08
94.0,3.52
95.0,7.15
96.0,7.21
97.0,6.41
98.0,7.64
99.0,6.79
100.0,10.77
101.0,7.38
102.0,7.74
103.0,6.61
104.0,5.42
106.0,1.83
107.0,8.32
108.0,4.24
Query:
WITH max_compositions AS (
  SELECT
    im."month_year" AS "Time(MM-YYYY)",
    imap."interest_name" AS "Interest_Name",
    im."composition" AS "Composition_Value"
  FROM (
    SELECT
      "interest_id",
      MAX("composition") AS "max_comp"
    FROM "interest_metrics"
    WHERE "interest_id" IS NOT NULL
    GROUP BY "interest_id"
  ) AS mc
  JOIN "interest_metrics" AS im ON
    im."interest_id" = mc."interest_id" AND
    im."composition" = mc."max_comp"
  JOIN "interest_map" AS imap ON
    im."interest_id" = imap."id"
)
SELECT * FROM (
  SELECT * FROM max_compositions
  ORDER BY "Composition_Value" DESC
  LIMIT 10
)
UNION ALL
SELECT * FROM (
  SELECT * FROM max_compositions
  ORDER BY "Composition_Value" ASC
  LIMIT 10
)
ORDER BY "Composition_Value" DESC;
Answer:
Time(MM-YYYY),Interest_Name,Composition_Value
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
07-2018,Readers of Jamaican Content,1.86
02-2019,Automotive News Readers,1.84
07-2018,Comedy Fans,1.83
08-2019,World of Warcraft Enthusiasts,1.82
08-2018,Miami Heat Fans,1.81
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2019,Hearthstone Video Game Fans,1.66
09-2018,Scifi Movie and TV Enthusiasts,1.61
09-2018,Action Movie and TV Enthusiasts,1.59
03-2019,The Sims Video Game Fans,1.57
Query:
SELECT im."interest_name", MAX(imt."composition") AS "max_composition"
FROM "interest_metrics" AS imt
JOIN "interest_map" AS im ON imt."interest_id" = im."id"
GROUP BY im."interest_name"
ORDER BY "max_composition" DESC
LIMIT 100
Answer:
interest_name,max_composition
Work Comes First Travelers,21.2
Gym Equipment Owners,18.82
Furniture Shoppers,17.44
Luxury Retail Shoppers,17.19
Luxury Boutique Hotel Researchers,15.15
Luxury Bedding Shoppers,15.05
Shoe Shoppers,14.91
Cosmetics and Beauty Shoppers,14.23
Luxury Hotel Guests,14.1
Luxury Retail Researchers,13.97
Womens Fashion Brands Shoppers,13.67
Reusable Drinkware Shoppers,13.35
Beach Supplies Shoppers,13.03
Parents of Teenagers Going to College,12.93
Luxury Kitchen Goods Shoppers,12.87
Land Rover Shoppers,12.62
Vacation Planners,12.56
High-End Kids Furniture and Clothes Shoppers,12.41
Pandora Jewelry Shoppers,12.27
Kitchen Appliance Shoppers,12.22
Christmas Celebration Researchers,12.16
Flight and Hotel Shoppers,11.97
Vacation Rental Accommodation Researchers,11.89
Harry Potter Fans,11.72
Mens Shoe Shoppers,11.68
Supermarket Shoppers,11.63
Costa Rica Trip Planners,11.63
Portugal Trip Planners,11.61
Apartment Furniture Shoppers,11.57
Travel Reward Points Enthusiasts,11.48
Halloween Costume Shoppers,11.4
Luxury Department Store Shoppers,11.38
Teen Girl Clothing Shoppers,11.23
Luxury Travel Researchers,11.21
Gluten-Free Recipe Researchers,11.04
Natural Pet Food Shoppers,10.95
High End Camera Shoppers - Dupe,10.91
Bed & Bath Shoppers,10.86
Online Home Decor Shoppers,10.85
Healthy Eaters,10.82
Brides & Wedding Planners,10.82
Weight Loss Researchers,10.8
Nutrition Conscious Eaters,10.77
Preppy Clothing Shoppers,10.76
Wine Lovers,10.71
Online Grocery Shoppers,10.7
New Years Eve Party Ticket Purchasers,10.62
New Zealand Trip Planners,10.61
Patio Furniture Shoppers,10.54
Winter Apparel Shoppers,10.46
Lobbyists,10.43
Chelsea Fans,10.36
Hair Care Shoppers,10.32
Las Vegas Trip Planners,10.3
Tech-Savvy Moms,10.29
Financial Advisors,10.24
Paleo Eaters,10.22
Travel Researchers,10.14
Home Design and Living Publication Readers,10.11
Indoor Cycling & Spinning Enthusiasts,10.05
HDTV Researchers,9.99
Alabama Trip Planners,9.98
Golf Enthusiasts,9.97
Competitive Tri-Athletes,9.97
Luxury Second Home Owners,9.93
Nursing and Physicians Assistant Journal Researchers,9.83
Parents with Kids,9.77
Home Remodelers,9.71
Recently Retired Individuals,9.67
Olympics Fans,9.65
Luggage Shoppers,9.64
Misc-Deal Seekers or Coupon Shoppers,9.49
Sporting Goods Shoppers,9.48
Mature Parents,9.47
Skin Care Researchers,9.46
Pre-Measured Grocery Shoppers,9.46
Japanese Luxury Car Enthusiasts,9.46
New & Expecting Parents,9.37
Competitive Sports Participants,9.35
Food Safety Decision Makers,9.33
Running Enthusiasts,9.29
Baby Products Buyers,9.27
Olympic Sports Enthusiasts,9.22
Luxury Home Fixture Shoppers,9.21
Asian Food Enthusiasts,9.15
Pregnancy Resources Researchers,9.13
Restaurant Supply Shoppers,9.03
"Work Hard, Play Hard Travelers",8.97
Investment Services Intenders,8.95
Ski House Second Home Owners,8.84
Special Olympics Fans,8.81
Credit Score Researchers,8.69
Online Health Researchers,8.66
Freelancers,8.65
At-Home Gym Intenders,8.64
Family Adventures Travelers,8.58
Department Store Shoppers,8.56
Life Insurance Researchers,8.54
Mid-Range Grocery Shoppers,8.5
Countdown to the Beach Travelers,8.5
Query:
SELECT imt."interest_id", imt."month_year", imt."composition"
FROM "interest_metrics" AS imt
WHERE imt."composition" = (
  SELECT MAX("composition")
  FROM "interest_metrics"
  WHERE "interest_id" = imt."interest_id"
)
ORDER BY imt."interest_id"
LIMIT 100
Answer:
interest_id,month_year,composition
1.0,07-2018,7.02
2.0,02-2019,3.09
3.0,07-2018,6.14
4.0,07-2018,13.97
5.0,07-2018,10.82
6.0,10-2018,12.56
7.0,07-2018,2.64
8.0,07-2018,6.67
12.0,07-2018,7.23
13.0,07-2018,6.72
14.0,07-2018,3.53
15.0,07-2018,6.9
16.0,07-2018,6.24
17.0,07-2018,7.89
18.0,07-2018,3.18
19.0,07-2018,6.57
20.0,07-2018,4.08
21.0,10-2018,5.26
22.0,07-2018,6.26
23.0,07-2018,5.41
24.0,07-2018,6.54
25.0,07-2018,4.31
26.0,07-2018,6.01
27.0,07-2018,6.81
28.0,10-2018,7.36
29.0,07-2018,5.2
30.0,10-2018,8.56
31.0,07-2018,7.9
33.0,07-2018,7.6
34.0,12-2018,11.23
35.0,07-2018,5.25
36.0,07-2018,9.27
37.0,07-2018,7.82
38.0,07-2018,9.48
39.0,07-2018,17.44
40.0,07-2018,10.86
41.0,07-2018,6.96
42.0,07-2018,4.9
43.0,07-2018,5.98
44.0,07-2018,6.11
45.0,07-2018,6.29
46.0,07-2018,3.4
48.0,10-2018,5.55
49.0,07-2018,5.09
50.0,10-2018,3.86
51.0,07-2018,2.67
53.0,07-2018,3.03
54.0,10-2018,3.88
55.0,10-2018,7.67
56.0,07-2018,7.09
57.0,07-2018,2.32
58.0,07-2018,2.18
59.0,07-2018,3.97
60.0,10-2018,8.66
61.0,07-2018,6.59
62.0,07-2018,4.15
63.0,07-2018,9.37
64.0,12-2018,12.41
65.0,07-2018,5.94
66.0,07-2018,6.51
67.0,10-2018,6.76
69.0,07-2018,10.82
70.0,07-2018,6.96
71.0,07-2018,3.43
72.0,07-2018,3.63
73.0,07-2018,7.06
74.0,07-2018,7.37
75.0,07-2018,7.23
77.0,07-2018,17.19
78.0,10-2018,2.78
79.0,07-2018,11.21
80.0,07-2018,4.47
81.0,07-2018,3.31
82.0,07-2018,9.99
83.0,10-2018,4.64
84.0,02-2019,3.88
85.0,07-2018,6.46
86.0,07-2018,6.13
87.0,07-2018,5.01
88.0,07-2018,4.99
89.0,10-2018,10.14
90.0,07-2018,5.91
91.0,07-2018,5.87
92.0,07-2018,9.77
93.0,07-2018,7.08
94.0,07-2018,3.52
95.0,07-2018,7.15
96.0,07-2018,7.21
97.0,07-2018,6.41
98.0,07-2018,7.64
99.0,07-2018,6.79
100.0,07-2018,10.77
101.0,07-2018,7.38
102.0,07-2018,7.74
103.0,07-2018,6.61
104.0,07-2018,5.42
106.0,07-2018,1.83
107.0,07-2018,8.32
108.0,07-2018,4.24
109.0,07-2018,6.75
Query:
SELECT im."interest_name", MAX(imt."composition") AS "max_composition"
FROM "interest_metrics" AS imt
JOIN "interest_map" AS im ON imt."interest_id" = im."id"
GROUP BY im."interest_name"
ORDER BY "max_composition" DESC
LIMIT 10
Answer:
interest_name,max_composition
Work Comes First Travelers,21.2
Gym Equipment Owners,18.82
Furniture Shoppers,17.44
Luxury Retail Shoppers,17.19
Luxury Boutique Hotel Researchers,15.15
Luxury Bedding Shoppers,15.05
Shoe Shoppers,14.91
Cosmetics and Beauty Shoppers,14.23
Luxury Hotel Guests,14.1
Luxury Retail Researchers,13.97
Query:
SELECT im."interest_name", MAX(imt."composition") AS "max_composition"
FROM "interest_metrics" AS imt
JOIN "interest_map" AS im ON imt."interest_id" = im."id"
GROUP BY im."interest_name"
ORDER BY "max_composition" ASC
LIMIT 10
Answer:
interest_name,max_composition
The Sims Video Game Fans,1.57
Action Movie and TV Enthusiasts,1.59
Scifi Movie and TV Enthusiasts,1.61
Hearthstone Video Game Fans,1.66
Online Role Playing Game Enthusiasts,1.73
Miami Heat Fans,1.81
World of Warcraft Enthusiasts,1.82
Comedy Fans,1.83
Automotive News Readers,1.84
Readers of Jamaican Content,1.86
Query:
SELECT im."interest_name", imt."month_year", imt."composition"
FROM "interest_metrics" AS imt
JOIN "interest_map" AS im ON imt."interest_id" = im."id"
JOIN (
  SELECT "interest_id", MAX("composition") AS "max_composition"
  FROM "interest_metrics"
  GROUP BY "interest_id"
) AS mc ON imt."interest_id" = mc."interest_id" AND imt."composition" = mc."max_composition"
ORDER BY imt."composition" DESC
LIMIT 10
Answer:
interest_name,month_year,composition
Work Comes First Travelers,12-2018,21.2
Gym Equipment Owners,07-2018,18.82
Furniture Shoppers,07-2018,17.44
Luxury Retail Shoppers,07-2018,17.19
Luxury Boutique Hotel Researchers,10-2018,15.15
Luxury Bedding Shoppers,12-2018,15.05
Shoe Shoppers,07-2018,14.91
Cosmetics and Beauty Shoppers,07-2018,14.23
Luxury Hotel Guests,07-2018,14.1
Luxury Retail Researchers,07-2018,13.97
Query:
SELECT im."interest_name", imt."month_year", imt."composition"
FROM "interest_metrics" AS imt
JOIN "interest_map" AS im ON imt."interest_id" = im."id"
JOIN (
  SELECT "interest_id", MAX("composition") AS "max_composition"
  FROM "interest_metrics"
  GROUP BY "interest_id"
) AS mc ON imt."interest_id" = mc."interest_id" AND imt."composition" = mc."max_composition"
ORDER BY imt."composition" ASC
LIMIT 10
Answer:
interest_name,month_year,composition
The Sims Video Game Fans,03-2019,1.57
Action Movie and TV Enthusiasts,09-2018,1.59
Scifi Movie and TV Enthusiasts,09-2018,1.61
Hearthstone Video Game Fans,08-2019,1.66
Online Role Playing Game Enthusiasts,07-2018,1.73
Miami Heat Fans,08-2018,1.81
World of Warcraft Enthusiasts,08-2019,1.82
Comedy Fans,07-2018,1.83
Automotive News Readers,02-2019,1.84
Readers of Jamaican Content,07-2018,1.86
Query:
SELECT imt."interest_id", imt."month_year", imt."composition"
FROM "interest_metrics" AS imt
WHERE imt."composition" = (
  SELECT MIN("composition")
  FROM "interest_metrics"
  WHERE "interest_id" = imt."interest_id"
)
ORDER BY imt."interest_id"
LIMIT 100
Answer:
interest_id,month_year,composition
1.0,05-2019,1.68
2.0,07-2018,1.81
3.0,12-2018,1.73
4.0,05-2019,3.43
5.0,05-2019,1.78
6.0,06-2019,2.87
7.0,04-2019,1.64
8.0,06-2019,1.58
12.0,05-2019,1.99
12.0,06-2019,1.99
13.0,06-2019,1.56
14.0,11-2018,1.56
15.0,05-2019,1.86
16.0,05-2019,2.29
17.0,06-2019,1.93
18.0,05-2019,1.71
19.0,04-2019,1.79
20.0,05-2019,1.74
21.0,07-2018,2.63
22.0,06-2019,1.7
23.0,09-2018,1.6
24.0,05-2019,1.58
25.0,05-2019,2.03
25.0,06-2019,2.03
26.0,08-2019,1.77
27.0,06-2019,1.58
28.0,06-2019,1.88
29.0,05-2019,1.64
30.0,06-2019,1.99
31.0,06-2019,2.73
33.0,06-2019,3.08
34.0,06-2019,2.36
35.0,06-2019,2.08
36.0,08-2019,2.43
37.0,06-2019,2.22
38.0,06-2019,2.86
39.0,06-2019,6.03
40.0,05-2019,2.34
41.0,05-2019,1.64
42.0,06-2019,2.16
43.0,06-2019,2.03
44.0,06-2019,2.06
45.0,06-2019,1.77
46.0,05-2019,1.65
48.0,06-2019,2.42
49.0,06-2019,2.43
50.0,06-2019,1.83
51.0,04-2019,1.98
53.0,10-2018,1.54
54.0,06-2019,1.73
55.0,06-2019,1.79
56.0,06-2019,2.21
57.0,04-2019,1.65
58.0,11-2018,1.64
59.0,06-2019,1.58
60.0,06-2019,1.66
61.0,05-2019,1.99
62.0,06-2019,1.72
63.0,05-2019,2.6
64.0,06-2019,3.17
65.0,06-2019,1.73
66.0,01-2019,1.55
67.0,07-2019,1.72
69.0,06-2019,1.64
70.0,05-2019,1.79
71.0,05-2019,1.56
72.0,06-2019,1.74
73.0,06-2019,1.68
74.0,06-2019,2.37
75.0,06-2019,2.18
77.0,06-2019,5.53
78.0,05-2019,1.72
79.0,05-2019,2.3
80.0,05-2019,1.69
81.0,07-2019,1.73
82.0,05-2019,4.05
82.0,06-2019,4.05
83.0,06-2019,1.89
84.0,06-2019,2.47
85.0,01-2019,1.9
86.0,05-2019,1.63
87.0,06-2019,1.65
88.0,06-2019,2.12
89.0,06-2019,2.55
90.0,09-2018,1.68
91.0,07-2019,1.77
92.0,05-2019,1.78
93.0,04-2019,2.03
94.0,06-2019,1.77
95.0,06-2019,2.26
96.0,06-2019,1.73
97.0,09-2018,1.93
98.0,06-2019,2.26
99.0,06-2019,2.4
100.0,06-2019,1.63
101.0,05-2019,2.35
102.0,06-2019,2.79
103.0,04-2019,1.74
104.0,01-2019,1.64
106.0,07-2018,1.83
Query:
SELECT im."interest_name", AVG(imt."composition") AS "avg_composition"
FROM "interest_metrics" AS imt
JOIN "interest_map" AS im ON imt."interest_id" = im."id"
GROUP BY im."interest_name"
ORDER BY "avg_composition" DESC
LIMIT 100
Answer:
interest_name,avg_composition
Work Comes First Travelers,17.4825
Luxury Bedding Shoppers,11.093571428571428
Gym Equipment Owners,10.48642857142857
Luxury Boutique Hotel Researchers,10.43357142857143
Luxury Retail Shoppers,9.762142857142857
Beach Supplies Shoppers,9.51142857142857
Furniture Shoppers,9.507857142857143
Luxury Hotel Guests,9.36357142857143
High-End Kids Furniture and Clothes Shoppers,8.86357142857143
Christmas Celebration Researchers,8.622142857142856
Vacation Planners,8.330714285714288
Portugal Trip Planners,7.999285714285714
Patio Furniture Shoppers,7.979999999999998
"Work Hard, Play Hard Travelers",7.8100000000000005
Family Adventures Travelers,7.65625
New Zealand Trip Planners,7.62
High End Camera Shoppers - Dupe,7.605
Winter Apparel Shoppers,7.580000000000002
Halloween Costume Shoppers,7.578571428571428
New Years Eve Party Ticket Purchasers,7.542857142857144
Online Grocery Shoppers,7.461428571428573
Teen Girl Clothing Shoppers,7.390000000000001
Flight and Hotel Shoppers,7.320714285714287
Alabama Trip Planners,7.15142857142857
Skin Care Researchers,6.993571428571428
Mens Shoe Shoppers,6.919285714285712
Chelsea Fans,6.857142857142856
Nursing and Physicians Assistant Journal Researchers,6.78
Luxury Home Fixture Shoppers,6.7542857142857144
Pre-Measured Grocery Shoppers,6.750000000000001
Financial Advisors,6.7285714285714295
Preppy Clothing Shoppers,6.723571428571427
Travel Researchers,6.707142857142856
Urban Skateboarding Sneaker Shoppers,6.681428571428571
Las Vegas Trip Planners,6.5514285714285725
Competitive Tri-Athletes,6.444999999999999
Shoe Shoppers,6.344285714285716
Indoor Cycling & Spinning Enthusiasts,6.303571428571429
Restaurant Supply Shoppers,6.3
Cosmetics and Beauty Shoppers,6.237142857142858
Luxury Retail Researchers,6.172857142857144
World Cup Enthusiasts,6.137857142857143
Parents of Teenagers Going to College,6.028571428571428
Life Insurance Researchers,5.994285714285715
Real Estate Decision Makers,5.967142857142858
Executive Travelers,5.956249999999999
Getting Off the Grid Travelers,5.9350000000000005
Lacrosse Enthusiasts,5.92857142857143
Womens Fashion Brands Shoppers,5.847142857142857
Luxury Kitchen Goods Shoppers,5.8149999999999995
HDTV Researchers,5.807857142857142
Recently Retired Individuals,5.77642857142857
Countdown to the Beach Travelers,5.69875
Food Safety Decision Makers,5.671428571428573
North Carolina Travel Researchers,5.615
Sports Medicine Health Care Professionals,5.595000000000001
Natural Pet Food Shoppers,5.588571428571429
Japanese Luxury Car Enthusiasts,5.562857142857142
NCAA Football Fans,5.56
Credit Score Researchers,5.557857142857142
Cruise Travel Intenders,5.522857142857142
Luxury Department Store Shoppers,5.515
Fishing Equipment Shoppers,5.497142857142859
Healthcare Provider Education Researchers,5.472142857142856
Freelancers,5.445
Pandora Jewelry Shoppers,5.434285714285715
Reusable Drinkware Shoppers,5.425
Big & Tall Men,5.405714285714287
Home Healthcare Researchers,5.387142857142856
Non-Profit Volunteers,5.359285714285716
Healthcare Discount Shoppers,5.307142857142857
Nissan Vehicle Shoppers,5.29
Vacuum Shoppers,5.272857142857143
Investment Services Intenders,5.267857142857143
At-Home Gym Intenders,5.22357142857143
Luggage Shoppers,5.212142857142856
Horror Movie Fans,5.21
Wine Lovers,5.1816666666666675
Weight Loss Researchers,5.141428571428571
Readers of African American Content,5.14
Teachers,5.077857142857143
Medicare Provider Researchers,5.0649999999999995
Major Airline Customers,5.055714285714287
Kids Clothing Shoppers,5.041428571428571
Vacation Rental Accommodation Researchers,5.025
Aspen Skiers and Snowboarders,5.025
Luxury Womens Brands Shoppers,4.978571428571429
Department Store Shoppers,4.972142857142857
Food Industry Professionals,4.9664285714285725
Kitchen Appliance Shoppers,4.965714285714286
Fitness Activity Tracker Users,4.963333333333333
Home Design and Living Publication Readers,4.9575
Olympics Fans,4.940714285714286
Online Health Researchers,4.938571428571428
Affordable Hotel Bookers,4.933571428571428
Russia Trip Planners,4.909285714285714
Business Incorporating & LLC Filing Researchers,4.902857142857142
Land Rover Shoppers,4.900714285714284
Online Education Intenders,4.89357142857143
Hanukkah Decorations Shoppers,4.8914285714285715
Query:
SELECT im."interest_name", AVG(imt."composition") AS "avg_composition"
FROM "interest_metrics" AS imt
JOIN "interest_map" AS im ON imt."interest_id" = im."id"
GROUP BY im."interest_name"
ORDER BY "avg_composition" DESC
LIMIT 10
Answer:
interest_name,avg_composition
Work Comes First Travelers,17.4825
Luxury Bedding Shoppers,11.093571428571428
Gym Equipment Owners,10.48642857142857
Luxury Boutique Hotel Researchers,10.43357142857143
Luxury Retail Shoppers,9.762142857142857
Beach Supplies Shoppers,9.51142857142857
Furniture Shoppers,9.507857142857143
Luxury Hotel Guests,9.36357142857143
High-End Kids Furniture and Clothes Shoppers,8.86357142857143
Christmas Celebration Researchers,8.622142857142856
Query:
SELECT im."interest_name", imt."month_year", imt."composition"
FROM "interest_metrics" AS imt
JOIN "interest_map" AS im ON imt."interest_id" = im."id"
WHERE imt."composition" > 0.8
ORDER BY imt."composition" DESC
LIMIT 100
Answer:
interest_name,month_year,composition
Work Comes First Travelers,12-2018,21.2
Work Comes First Travelers,10-2018,20.28
Work Comes First Travelers,11-2018,19.45
Work Comes First Travelers,01-2019,18.99
Gym Equipment Owners,07-2018,18.82
Work Comes First Travelers,02-2019,18.39
Work Comes First Travelers,09-2018,18.18
Furniture Shoppers,07-2018,17.44
Luxury Retail Shoppers,07-2018,17.19
Luxury Boutique Hotel Researchers,10-2018,15.15
Luxury Bedding Shoppers,12-2018,15.05
Luxury Bedding Shoppers,11-2018,14.92
Luxury Bedding Shoppers,01-2019,14.92
Shoe Shoppers,07-2018,14.91
Luxury Bedding Shoppers,02-2019,14.39
Luxury Bedding Shoppers,09-2018,14.29
Cosmetics and Beauty Shoppers,07-2018,14.23
Luxury Bedding Shoppers,10-2018,14.15
Luxury Hotel Guests,07-2018,14.1
Luxury Retail Researchers,07-2018,13.97
Gym Equipment Owners,08-2018,13.9
Luxury Boutique Hotel Researchers,12-2018,13.81
Womens Fashion Brands Shoppers,07-2018,13.67
Luxury Boutique Hotel Researchers,02-2019,13.64
Reusable Drinkware Shoppers,07-2018,13.35
Beach Supplies Shoppers,10-2018,13.03
Parents of Teenagers Going to College,07-2018,12.93
Luxury Kitchen Goods Shoppers,07-2018,12.87
Beach Supplies Shoppers,02-2019,12.85
Luxury Boutique Hotel Researchers,09-2018,12.8
Luxury Retail Shoppers,08-2018,12.73
Luxury Boutique Hotel Researchers,11-2018,12.68
Gym Equipment Owners,10-2018,12.64
Luxury Boutique Hotel Researchers,03-2019,12.64
Land Rover Shoppers,07-2018,12.62
Beach Supplies Shoppers,12-2018,12.62
Vacation Planners,10-2018,12.56
Luxury Hotel Guests,10-2018,12.47
Work Comes First Travelers,08-2018,12.42
High-End Kids Furniture and Clothes Shoppers,12-2018,12.41
Luxury Hotel Guests,02-2019,12.41
High-End Kids Furniture and Clothes Shoppers,10-2018,12.33
Luxury Bedding Shoppers,03-2019,12.3
Pandora Jewelry Shoppers,07-2018,12.27
Luxury Boutique Hotel Researchers,01-2019,12.26
Kitchen Appliance Shoppers,07-2018,12.22
Christmas Celebration Researchers,10-2018,12.16
Furniture Shoppers,08-2018,12.03
Vacation Planners,07-2018,11.99
Flight and Hotel Shoppers,10-2018,11.97
High-End Kids Furniture and Clothes Shoppers,09-2018,11.93
Beach Supplies Shoppers,11-2018,11.93
Vacation Rental Accommodation Researchers,07-2018,11.89
High-End Kids Furniture and Clothes Shoppers,01-2019,11.75
Beach Supplies Shoppers,09-2018,11.74
Luxury Retail Shoppers,12-2018,11.74
Luxury Retail Shoppers,10-2018,11.73
Harry Potter Fans,07-2018,11.72
Beach Supplies Shoppers,01-2019,11.71
Mens Shoe Shoppers,07-2018,11.68
Costa Rica Trip Planners,07-2018,11.63
Supermarket Shoppers,07-2018,11.63
Portugal Trip Planners,07-2018,11.61
Apartment Furniture Shoppers,07-2018,11.57
Christmas Celebration Researchers,12-2018,11.57
Luxury Hotel Guests,12-2018,11.5
Travel Reward Points Enthusiasts,07-2018,11.48
Halloween Costume Shoppers,07-2018,11.4
Luxury Department Store Shoppers,07-2018,11.38
Beach Supplies Shoppers,03-2019,11.27
Teen Girl Clothing Shoppers,12-2018,11.23
Luxury Travel Researchers,07-2018,11.21
Luxury Hotel Guests,09-2018,11.18
Luxury Bedding Shoppers,07-2018,11.15
Luxury Hotel Guests,11-2018,11.14
Furniture Shoppers,10-2018,11.1
Vacation Planners,12-2018,11.08
Gym Equipment Owners,09-2018,11.06
Gym Equipment Owners,11-2018,11.06
Gluten-Free Recipe Researchers,07-2018,11.04
Vacation Planners,02-2019,11.03
Luxury Bedding Shoppers,04-2019,11.01
Portugal Trip Planners,10-2018,11.0
High-End Kids Furniture and Clothes Shoppers,02-2019,10.99
Luxury Hotel Guests,03-2019,10.99
Christmas Celebration Researchers,01-2019,10.96
Natural Pet Food Shoppers,07-2018,10.95
Work Comes First Travelers,07-2018,10.95
High End Camera Shoppers - Dupe,07-2018,10.91
Gym Equipment Owners,12-2018,10.91
Halloween Costume Shoppers,10-2018,10.89
Christmas Celebration Researchers,11-2018,10.88
Bed & Bath Shoppers,07-2018,10.86
Online Home Decor Shoppers,07-2018,10.85
Luxury Bedding Shoppers,08-2018,10.85
Healthy Eaters,07-2018,10.82
Brides & Wedding Planners,07-2018,10.82
Weight Loss Researchers,07-2018,10.8
Luxury Boutique Hotel Researchers,07-2018,10.79
Nutrition Conscious Eaters,07-2018,10.77
Query:
SELECT im."interest_name", COUNT(*) AS "max_count"
FROM "interest_metrics" AS imt
JOIN "interest_map" AS im ON imt."interest_id" = im."id"
GROUP BY im."interest_name"
ORDER BY "max_count" DESC
LIMIT 100
Answer:
interest_name,max_count
Pizza Lovers,18
Zoo Visitors,14
Yogis,14
Yale University Fans,14
Yachting Enthusiasts,14
World Cup Enthusiasts,14
World Cup Apparel Shoppers,14
Womens Fashion Brands Shoppers,14
Womens Equality Advocates,14
Wireless Service Provider Researchers,14
Whiskey Lovers,14
Weight Loss Researchers,14
Weight Lifting Enthusiasts,14
Web Design Researchers,14
Water Park Visitors,14
Washington DC Trip Planners,14
Vitamin Shoppers,14
Videographers,14
Video Game Shoppers,14
Venture Capitalists,14
Vegans,14
Vaping Shoppers,14
Vacuum Shoppers,14
Vacation Rental Accommodation Researchers,14
Vacation Planners,14
Used Car Shoppers,14
Urban Skateboarding Sneaker Shoppers,14
United Arab Emirates Trip Planners,14
Travel Reward Points Enthusiasts,14
Travel Researchers,14
Tractor Shoppers,14
Toyota Vehicle Shopper,14
Tire Shoppers,14
Tire Researchers,14
Thrift Store Shoppers,14
Theme Park Researchers,14
Thanksgiving Meal Planners,14
Thanksgiving Entertaining Researchers,14
Texas Trip Planners,14
Texas Energy Providers,14
Tennis Players,14
Teen Girl Clothing Shoppers,14
Tech-Savvy Moms,14
Teachers,14
Tailgaters,14
Sweet Tooths,14
Surfers,14
Supply Chain Professionals,14
Supermarket Shoppers,14
Summer Festivals and Fairs Visitors,14
Summer Activities Researchers,14
Study Abroad Researchers,14
Streaming Music Enthusiasts,14
Stay-at-Home Parents,14
Sports Medicine Health Care Professionals,14
Sports Gamblers,14
Sporting Goods Shoppers,14
Special Olympics Fans,14
Spa and Pool Owners,14
Spa Goers,14
Sony Fans,14
Solar Energy Solution Shoppers,14
Software Directory Researchers,14
Soccer Fans,14
Smart Home Product Researchers,14
Small Business Employees,14
Sleep Disorder Researchers,14
Skin Care Researchers,14
Ski and Snowboard Enthusiasts,14
Ski House Second Home Owners,14
Sightseeing Travelers,14
Shoe Shoppers,14
Shared Work Space Researchers,14
Senior Living Center Researchers,14
Senior Caregivers,14
Seattle Trip Planners,14
Seasonal Allergy Sufferers,14
School Supply Shoppers,14
Satellite TV Buyers,14
Santa Monica Trip Planners,14
San Francisco Trip Planners,14
San Diego Trip Planners,14
Sale Seekers,14
Sailing Enthusiasts,14
SEO Specialists,14
Russia Trip Planners,14
Running Enthusiasts,14
Rugby Fans,14
Roommate Seekers,14
Right Wing Radicals,14
Rideshare App Users,14
Reusable Drinkware Shoppers,14
Retirement Planners,14
Retirees,14
Restaurant Supply Shoppers,14
Restaurant Researchers,14
Restaurant News Readers,14
Respirologists and Pulmonologists,14
Reggaeton Fans,14
Recreational Sports Participants,14
Query:
WITH max_comp AS (
  SELECT
    imt."interest_id",
    imt."month_year",
    imt."composition"
  FROM "interest_metrics" imt
  JOIN (
    SELECT
      "interest_id",
      MAX("composition") AS "max_comp"
    FROM "interest_metrics"
    WHERE "composition" IS NOT NULL
    GROUP BY "interest_id"
  ) mc ON imt."interest_id" = mc."interest_id" AND imt."composition" = mc."max_comp"
),
full_data AS (
  SELECT
    im."interest_name" AS "Interest_Name",
    max_comp."month_year" AS "Time(MM-YYYY)",
    max_comp."composition" AS "Composition_Value"
  FROM max_comp
  JOIN "interest_map" im ON max_comp."interest_id" = im."id"
)
SELECT * FROM (
  SELECT * FROM full_data
  ORDER BY "Composition_Value" DESC
  LIMIT 10
)
UNION ALL
SELECT * FROM (
  SELECT * FROM full_data
  ORDER BY "Composition_Value" ASC
  LIMIT 10
)
ORDER BY "Composition_Value" DESC;
Answer:
Interest_Name,Time(MM-YYYY),Composition_Value
Work Comes First Travelers,12-2018,21.2
Gym Equipment Owners,07-2018,18.82
Furniture Shoppers,07-2018,17.44
Luxury Retail Shoppers,07-2018,17.19
Luxury Boutique Hotel Researchers,10-2018,15.15
Luxury Bedding Shoppers,12-2018,15.05
Shoe Shoppers,07-2018,14.91
Cosmetics and Beauty Shoppers,07-2018,14.23
Luxury Hotel Guests,07-2018,14.1
Luxury Retail Researchers,07-2018,13.97
Readers of Jamaican Content,07-2018,1.86
Automotive News Readers,02-2019,1.84
Comedy Fans,07-2018,1.83
World of Warcraft Enthusiasts,08-2019,1.82
Miami Heat Fans,08-2018,1.81
Online Role Playing Game Enthusiasts,07-2018,1.73
Hearthstone Video Game Fans,08-2019,1.66
Scifi Movie and TV Enthusiasts,09-2018,1.61
Action Movie and TV Enthusiasts,09-2018,1.59
The Sims Video Game Fans,03-2019,1.57
Query:
SELECT 
  im."interest_name", 
  imt1."composition" AS "composition_month1",
  imt2."composition" AS "composition_month2",
  (imt2."composition" - imt1."composition") AS "composition_change"
FROM "interest_metrics" AS imt1
JOIN "interest_metrics" AS imt2 ON imt1."interest_id" = imt2."interest_id"
JOIN "interest_map" AS im ON imt1."interest_id" = im."id"
WHERE imt1."month_year" = '01-2019' AND imt2."month_year" = '02-2019'
LIMIT 100
Answer:
Too long, hard cut:
interest_name,composition_month1,composition_month2,composition_change
Winter Apparel Shoppers,9.1,9.85,0.75
Mens Shoe Shoppers,6.24,7.43,1.1899999999999995
Fitness Activity Tracker Users,5.29,5.37,0.08000000000000007
Luxury Retail Researchers,5.86,6.55,0.6899999999999995
Competitive Tri-Athletes,6.39,6.41,0.020000000000000462
Preppy Clothing Shoppers,6.33,6.88,0.5499999999999998
Luxury Home Fixture Shoppers,6.96,7.64,0.6799999999999997
Shoe Shoppers,5.28,6.59,1.3099999999999996
Running Enthusiasts,3.79,4.3,0.5099999999999998
Work Comes First Travelers,18.99,18.39,-0.5999999999999979
Family Adventures Travelers,7.88,7.51,-0.3700000000000001
Womens Fashion Brands Shoppers,6.15,5.94,-0.20999999999999996
Apartment Furniture Shoppers,4.08,4.68,0.5999999999999996
World Cup Enthusiasts,5.76,6.92,1.1600000000000001
"Work Hard, Play Hard Travelers",7.37,7.63,0.2599999999999998
Beach Supplies Shoppers,11.71,12.85,1.1399999999999988
At-Home Gym Intenders,4.74,5.65,0.9100000000000001
Aspen Skiers and Snowboarders,5.56,6.03,0.47000000000000064
Kids Clothing Shoppers,4.95,5.18,0.22999999999999954
Luxury Boutique Hotel Researchers,12.26,13.64,1.3800000000000008
Parents of Teenagers Going to College,5.75,6.09,0.33999999999999986
Competitive Sports Participants,3.69,4.64,0.9499999999999997
Luxury Bedding Shoppers,14.92,14.39,-0.5299999999999994
Vacation Planners,9.25,11.03,1.7799999999999994
Trendy Denim Shoppers,5.11,4.95,-0.16000000000000014
Ski and Snowboard Apparel Shoppers,4.91,5.92,1.0099999999999998
Luxury Retail Shoppers,10.42,9.99,-0.4299999999999997
Luxury Kitchen Goods Shoppers,5.25,6.06,0.8099999999999996
Big & Tall Men,4.7,5.6,0.8999999999999995
Swimming Enthusiasts,3.98,4.72,0.7399999999999998
Home Decor Shoppers,3.74,4.52,0.7799999999999994
High-End Kids Furniture and Clothes Shoppers,11.75,10.99,-0.7599999999999998
Colorado Skiers and Snowboarders,4.75,6.17,1.42
Lacrosse Enthusiasts,5.25,6.05,0.7999999999999998
Urban Skateboarding Sneaker Shoppers,7.0,7.54,0.54
Furniture Shoppers,9.23,10.08,0.8499999999999996
Cycling Enthusiasts,3.48,4.43,0.9499999999999997
Reusable Drinkware Shoppers,4.61,5.86,1.25
Vacation Rental Accommodation Researchers,4.22,5.01,0.79
Olympics Fans,4.13,5.36,1.2300000000000004
Golf Enthusiasts,3.84,5.06,1.2199999999999998
Japanese Luxury Car Enthusiasts,5.25,6.1,0.8499999999999996
Luggage Shoppers,4.58,5.97,1.3899999999999997
Vermont Trip Planners,4.7,5.44,0.7400000000000002
Fishing Equipment Shoppers,5.23,5.98,0.75
Luxury Hotel Guests,10.12,12.41,2.290000000000001
Sporting Goods Shoppers,3.54,4.83,1.29
Gym Equipment Owners,9.43,10.61,1.1799999999999997
World Cup Apparel Shoppers,4.53,4.83,0.2999999999999998
Western Canada Skiers and Snowboarders,4.38,5.35,0.9699999999999998
Kitchen Appliance Shoppers,3.84,5.08,1.2400000000000002
Sports Medicine Health Care Professionals,5.17,5.54,0.3700000000000001
Getting Off the Grid Travelers,5.75,6.59,0.8399999999999999
Luxury Womens Brands Shoppers,5.32,5.9,0.5800000000000001
Pandora Jewelry Shoppers,5.79,5.31,-0.4800000000000004
Flight and Hotel Shoppers,8.45,9.57,1.120000000000001
European Trip Planners,4.46,4.97,0.5099999999999998
Hanukkah Decorations Shoppers,4.85,5.16,0.3100000000000005
Utility Workwear Shoppers,3.88,5.59,1.71
Ski House Second Home Owners,3.37,4.36,0.9900000000000002
Sports Memorabilia Shoppers,3.51,4.54,1.0300000000000002
Luxury Department Store Shoppers,5.62,5.57,-0.04999999999999982
Leather Goods Shoppers,3.59,4.8,1.21
Big East Fans,3.38,3.77,0.3900000000000001
Discount Womens Shoes Shoppers,3.3,3.03,-0.27
Identity Theft Protection Researchers,4.72,5.1,0.3799999999999999
Luxury Travel Researchers,3.04,4.26,1.2199999999999998
Christmas Celebration Researchers,10.96,10.52,-0.4400000000000013
Affordable Hotel Bookers,4.36,5.06,0.6999999999999993
Costa Rica Trip Planners,4.47,4.68,0.20999999999999996
Major Airline Customers,4.7,5.58,0.8799999999999999
Price Conscious Home Shoppers,3.1,3.49,0.3900000000000001
North Carolina Football Fans,3.82,5.21,1.3900000000000001
Online Home Decor Shoppers,2.88,3.79,0.9100000000000001
Jewelry & Watch Shoppers,3.53,3.8,0.27
Indoor Cycling & Spinning Enthusiasts,6.77,7.68,0.9100000000000001
Sun Protection Shoppers,3.93,4.38,0.44999999999999973
Kitchen and Home Goods Shoppers,4.16,4.33,0.16999999999999993
Special Olympics Fans,3.97,4.19,0.2200000000000002
NCAA Fans,2.8,3.81,1.0100000000000002
New York Trip Planners,4.47,4.59,0.1200000000000001
Broadway Fans,3.43,4.04,0.6099999999999999
Soap Shoppers,3.51,3.92,0.41000000000000014
Countdown to the Beach Travelers,5.31,4.91,-0.39999999999999947
Neurologists,4.65,4.8,0.14999999999999947
Online Grocery Shoppers,8.29,8.96,0.6700000000000017
Jazz Festival Enthusiasts,3.81,3.75,-0.06000000000000005
Canoeing and Kayaking Enthusiasts,4.23,4.68,0.4499999999999993
Chandelier and Lamp Shoppers,3.56,3.73,0.16999999999999993
Halloween Costume Shoppers,8.9,9.3,0.40000000000000036
Embroidery Enthusiasts,4.3,5.3,1.0
Patio Furniture Shoppers,9.31,10.38,1.07000000
Query:
SELECT im."interest_name", imt."month_year", imt."composition"
FROM "interest_metrics" AS imt
JOIN "interest_map" AS im ON imt."interest_id" = im."id"
WHERE imt."month_year" = (
  SELECT "month_year" FROM "interest_metrics"
  WHERE "month_year" IS NOT NULL AND "month_year" != ''
  ORDER BY SUBSTR("month_year", 4, 4) || SUBSTR("month_year", 1, 2) DESC
  LIMIT 1
)
AND imt."composition" = (
  SELECT MAX("composition")
  FROM "interest_metrics"
  WHERE "interest_id" = imt."interest_id"
)
ORDER BY imt."composition" DESC
LIMIT 100;
Answer:
interest_name,month_year,composition
Elite Cycling Gear Shoppers,08-2019,4.75
Swimming Enthusiasts,08-2019,4.73
High School Sports Researchers,08-2019,4.57
Mens Business Clothes Shoppers,08-2019,4.47
Home Lending Researchers,08-2019,3.98
Duke Blue Devils Fans,08-2019,3.96
Cape Cod News Readers,08-2019,3.94
Mens Underwear Shoppers,08-2019,3.87
PBS Enthusiasts,08-2019,3.58
Online Calculator Users,08-2019,3.54
Fundraising Advocates,08-2019,3.54
Asheville Trip Planners,08-2019,3.52
Opera Enthusiasts,08-2019,3.51
Foot Health Researchers,08-2019,3.45
Kansas City Royals Fans,08-2019,3.44
ESPN Enthusiasts,08-2019,3.41
Self Storage Shoppers,08-2019,3.38
Craft Beer Enthusiasts,08-2019,3.3
Satellite TV Buyers,08-2019,3.26
Skin Disorder Researchers,08-2019,3.23
Cleveland Indians Fans,08-2019,3.19
Home Medical Supplies Shoppers,08-2019,3.14
Football Enthusiasts,08-2019,3.11
Medical Technology News Readers,08-2019,3.11
Syracuse Orange Fans,08-2019,3.07
Northwestern Wildcats Fans,08-2019,3.04
Rome Trip Planners,08-2019,3.04
Farm Finance Researchers,08-2019,3.03
Ebay Shoppers,08-2019,3.02
Brooklyn Nets Fans,08-2019,3.01
Notre Dame Fighting Irish Fans,08-2019,2.99
UNC Tar Heels Fans,08-2019,2.97
Jeep Vehicle Shoppers,08-2019,2.97
ACC Fans,08-2019,2.95
Utah Jazz Fans,08-2019,2.93
Food Delivery Service Users,08-2019,2.92
HGTV Enthusiasts,08-2019,2.88
Dairy Industry New Readers,08-2019,2.84
Agriculture and Climate Advocates,08-2019,2.84
Retired Budget Healthcare Shoppers,08-2019,2.83
Cattlemen and Pork Producers,08-2019,2.83
St. Louis Cardinals Fans,08-2019,2.82
Memphis Grizzlies Fans,08-2019,2.78
New Orleans Activities Researchers,08-2019,2.78
Philadelphia 76ers Fans,08-2019,2.77
Cincinnati Bengals Fans,08-2019,2.76
Agricultural and Food Issues Researchers,08-2019,2.76
Tractor Shoppers,08-2019,2.75
Kentucky Wildcats Fans,08-2019,2.74
Chicago Cubs Fans,08-2019,2.73
Horseback Riding Enthusiasts,08-2019,2.73
New York Jets Fans,08-2019,2.72
Minnesota Twins Fans,08-2019,2.72
Milwaukee Bucks Fans,08-2019,2.71
Veterinarians,08-2019,2.71
New York Knicks Fans,08-2019,2.7
New Orleans Saints Fans,08-2019,2.7
Denver Nuggets Fans,08-2019,2.69
Ice Cream Shoppers,08-2019,2.69
Tennessee Titans Fans,08-2019,2.68
New York Giants Fans,08-2019,2.68
Sudoku Players,08-2019,2.67
Pittsburgh Pirates Fans,08-2019,2.67
Arizona Cardinals Fans,08-2019,2.66
Jacksonville Jaguars Fans,08-2019,2.66
Tampa Bay Buccaneers Fans,08-2019,2.66
Los Angeles Rams Fans,08-2019,2.65
Indiana Hoosiers Fans,08-2019,2.64
Civil War History Buff,08-2019,2.64
Los Angeles Chargers Fans,08-2019,2.63
Portland Trail Blazers Fans,08-2019,2.63
Los Angeles Clippers Fans,08-2019,2.63
Pizza Lovers,08-2019,2.63
Homeschooling Parents,08-2019,2.63
Minnesota Timberwolves Fans,08-2019,2.61
Online Legal Document Service Researchers,08-2019,2.61
Indianapolis Colts Fans,08-2019,2.61
Ice Skating Enthusiasts,08-2019,2.61
Automotive Service Professionals,08-2019,2.61
Background Check Users,08-2019,2.61
Big Box Shoppers,08-2019,2.6
UConn Huskies Fans,08-2019,2.59
Bitcoin Enthusiasts,08-2019,2.59
Atlanta Hawks Fans,08-2019,2.58
Ohio State Buckeyes Fans,08-2019,2.57
Online Payroll Services Users,08-2019,2.57
Cosmetic Surgery Intenders,08-2019,2.56
Crossword Puzzles Players,08-2019,2.56
Cocktail Recipe Researchers,08-2019,2.56
Indiana Pacers Fans,08-2019,2.55
DIY Upcycle Home Project Planners,08-2019,2.55
Oklahoma City Thunder Fans,08-2019,2.54
Michigan Wolverines Fans,08-2019,2.54
Orlando Magic Fans,08-2019,2.54
Heart Surgery Researchers,08-2019,2.54
Board Game Enthusiasts,08-2019,2.52
Dallas Mavericks Fans,08-2019,2.51
Home Heating and Cooling Researchers,08-2019,2.51
Tea Party Policy Supporters,08-2019,2.5
Work Visa Researchers,08-2019,2.5
End Exploring Related Columns
Task: Identify the top 10 and bottom 10 interest categories based on their highest composition values across all months. For each category, display the time(MM-YYYY), interest name, and the composition value

Please answer only one complete SQL in sqlite dialect in ```sql``` format.
Usage example: ```sql
SELECT DISTINCT "column_name" FROM "table_name" WHERE ... ``` (Replace "table_name" with the actual table name. Enclose table and column names with double quotations if they contain special characters or match reserved keywords.)
Follow the answer format like: To identify the top 10 and bottom 10 interest categories based on their highest composition values across all months, we would analyze the `interest_metrics` table, joined with the `interest_map` table to get the interest names. For each interest category, we find the month where it had its highest composition value.

Here is the requested data in CSV format:

```csv
Time(MM-YYYY),Interest_Name,Composition_Value
MM-YYYY1:str,Interest_Name1:str,Composition_Value1:float
MM-YYYY2:str,Interest_Name2:str,Composition_Value2:float
...
```

*Note: Since the actual data is not provided, we've included the metanames and their data types.*.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: 

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-23 18:09:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 18:09:30 - root - INFO - ```sql
WITH max_compositions AS (
  SELECT
    im."interest_id",
    imap."interest_name" AS "Interest_Name",
    im."month_year" AS "Time(MM-YYYY)",
    im."composition" AS "Composition_Value"
  FROM "interest_metrics" AS im
  JOIN (
    SELECT
      "interest_id",
      MAX("composition") AS "max_comp"
    FROM "interest_metrics"
    WHERE "interest_id" IS NOT NULL
    GROUP BY "interest_id"
  ) AS mc ON im."interest_id" = mc."interest_id" AND im."composition" = mc."max_comp"
  JOIN "interest_map" AS imap ON im."interest_id" = imap."id"
),
top_10 AS (
  SELECT * FROM max_compositions
  ORDER BY "Composition_Value" DESC
  LIMIT 10
),
bottom_10 AS (
  SELECT * FROM max_compositions
  ORDER BY "Composition_Value" ASC
  LIMIT 10
)
SELECT "Time(MM-YYYY)", "Interest_Name", "Composition_Value" FROM top_10
UNION ALL
SELECT "Time(MM-YYYY)", "Interest_Name", "Composition_Value" FROM bottom_10
ORDER BY "Composition_Value" DESC;
```
2025-01-23 18:09:30 - root - INFO - itercount: 1
2025-01-23 18:09:30 - root - INFO - 0
2025-01-23 18:09:30 - root - INFO - results: 
Time(MM-YYYY),Interest_Name,Composition_Value
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
07-2018,Readers of Jamaican Content,1.86
02-2019,Automotive News Readers,1.84
07-2018,Comedy Fans,1.83
08-2019,World of Warcraft Enthusiasts,1.82
08-2018,Miami Heat Fans,1.81
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2019,Hearthstone Video Game Fans,1.66
09-2018,Scifi Movie and TV Enthusiasts,1.61
09-2018,Action Movie and TV Enthusiasts,1.59
03-2019,The Sims Video Game Fans,1.57


2025-01-23 18:09:30 - root - INFO - Please check the answer again by reviewing Identify the top 10 and bottom 10 interest categories based on their highest composition values across all months. For each category, display the time(MM-YYYY), interest name, and the composition value, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To identify the top 10 and bottom 10 interest categories based on their highest composition values across all months, we would analyze the `interest_metrics` table, joined with the `interest_map` table to get the interest names. For each interest category, we find the month where it had its highest composition value.

Here is the requested data in CSV format:

```csv
Time(MM-YYYY),Interest_Name,Composition_Value
MM-YYYY1:str,Interest_Name1:str,Composition_Value1:float
MM-YYYY2:str,Interest_Name2:str,Composition_Value2:float
...
```

*Note: Since the actual data is not provided, we've included the metanames and their data types.* The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Time(MM-YYYY),Interest_Name,Composition_Value
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
07-2018,Readers of Jamaican Content,1.86
02-2019,Automotive News Readers,1.84
07-2018,Comedy Fans,1.83
08-2019,World of Warcraft Enthusiasts,1.82
08-2018,Miami Heat Fans,1.81
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2019,Hearthstone Video Game Fans,1.66
09-2018,Scifi Movie and TV Enthusiasts,1.61
09-2018,Action Movie and TV Enthusiasts,1.59
03-2019,The Sims Video Game Fans,1.57
Current sql:
WITH max_compositions AS (
  SELECT
    im."interest_id",
    imap."interest_name" AS "Interest_Name",
    im."month_year" AS "Time(MM-YYYY)",
    im."composition" AS "Composition_Value"
  FROM "interest_metrics" AS im
  JOIN (
    SELECT
      "interest_id",
      MAX("composition") AS "max_comp"
    FROM "interest_metrics"
    WHERE "interest_id" IS NOT NULL
    GROUP BY "interest_id"
  ) AS mc ON im."interest_id" = mc."interest_id" AND im."composition" = mc."max_comp"
  JOIN "interest_map" AS imap ON im."interest_id" = imap."id"
),
top_10 AS (
  SELECT * FROM max_compositions
  ORDER BY "Composition_Value" DESC
  LIMIT 10
),
bottom_10 AS (
  SELECT * FROM max_compositions
  ORDER BY "Composition_Value" ASC
  LIMIT 10
)
SELECT "Time(MM-YYYY)", "Interest_Name", "Composition_Value" FROM top_10
UNION ALL
SELECT "Time(MM-YYYY)", "Interest_Name", "Composition_Value" FROM bottom_10
ORDER BY "Composition_Value" DESC;For tasks asking fullname or name, you may combine first name and last name into one column called name.

2025-01-23 18:10:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 18:10:05 - root - INFO - ```sql
WITH max_compositions AS (
  SELECT
    im."interest_id",
    imap."interest_name" AS "Interest_Name",
    im."month_year" AS "Time(MM-YYYY)",
    ROUND(im."composition", 4) AS "Composition_Value"
  FROM "interest_metrics" AS im
  JOIN (
    SELECT
      "interest_id",
      MAX("composition") AS "max_comp"
    FROM "interest_metrics"
    WHERE "interest_id" IS NOT NULL
    GROUP BY "interest_id"
  ) AS mc ON im."interest_id" = mc."interest_id" AND im."composition" = mc."max_comp"
  JOIN "interest_map" AS imap ON im."interest_id" = imap."id"
),
top_10 AS (
  SELECT * FROM max_compositions
  ORDER BY "Composition_Value" DESC
  LIMIT 10
),
bottom_10 AS (
  SELECT * FROM max_compositions
  ORDER BY "Composition_Value" ASC
  LIMIT 10
)
SELECT "Time(MM-YYYY)", "Interest_Name", "Composition_Value" FROM top_10
UNION ALL
SELECT "Time(MM-YYYY)", "Interest_Name", "Composition_Value" FROM bottom_10
ORDER BY "Composition_Value" DESC;
```
2025-01-23 18:10:05 - root - INFO - itercount: 2
2025-01-23 18:10:05 - root - INFO - 0
2025-01-23 18:10:05 - root - INFO - Total iteration counts: 2
