2025-01-24 05:01:02 - openai._base_client - INFO - Retrying request to /chat/completions in 0.403734 seconds
2025-01-24 05:01:35 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 05:01:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:01:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:01:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:01:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 05:01:37 - snowflake.connector.connection - INFO - closed
2025-01-24 05:01:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:01:37 - root - INFO - SQL:
SELECT DISTINCT "event_date"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
   LIMIT 100;
Results:
event_date
20180901

2025-01-24 05:01:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:01:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:01:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:01:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-24 05:01:38 - snowflake.connector.connection - INFO - closed
2025-01-24 05:01:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:02:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 05:02:21 - root - INFO - ```sql
SELECT DISTINCT "user_pseudo_id"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
WHERE "event_name" = 'first_open'
LIMIT 100;
```
2025-01-24 05:02:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:02:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:02:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:02:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 64
2025-01-24 05:02:22 - snowflake.connector.connection - INFO - closed
2025-01-24 05:02:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:03:15 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 05:03:15 - root - INFO - SQL:
SELECT DISTINCT "user_pseudo_id"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
WHERE "event_name" = 'first_open'
LIMIT 100;
Results:
user_pseudo_id
4EEE67C2E335213F6815144829801E0F
27C0BAADCE9520F17249A8B85F6477DA
D963E509346C0E5358ECFE56AF3BB2ED
4A2A03B50BDA6AC1687703BD39A91E3E
0E9150E8985138A744B88D56F015EDA7
FCD8DDE7775A7211BCA9F42768C3BB8B
6D6EB70E837A5007BE550C44FF276440
96333A5A97DA9F4AEBC7A70483AF6C5C
F4CB0B30E0A170AEB6A94EF1156738C8
EA89F979E0D4C374DBC95268982D18DE
34CAF47105A2D9D0AC7464BB3AF8DB2A
2C15FFDEDDA69390B7A8EB5808FB7ED6
6C333017CEA199B69BB27611BA5DE7B5
531E7B35DE9A21A1942F057C98B4E74C
14FC1A25D55E89AC7ECD600CD3A08C13
7331597E5500811253BA85AF851A193C
61BB31EC7781341B1D7B8D8A85688DA3
E0F1ED4167D0C0B2D6DCBA85CB020F52
177C0BEFFC69408F88D3377632F1BB60
5F5D7A3F5575008A81BB77CFE70C4285
387B532B7AF7A362DBF783E34C05BF54
1E882F0B9818614D6E47620DD31229F1
9F8885F0261FE69A58C8B6AE9176E437
D771048ADB1B9CACADFE001E6F9BA799
C7DD86F06FD4AA8A0967E27E20750FCD
E6E7FC8AC6D32935DA5ADCFFD14CC3A8
3E336ECE1F533064D663A350DAB00790
CCE5E30054C510608589FA6240615B0A
3B049329E3090DA7A4339C4A46EF0763
8DEB6CB6C3E85D0032D8557C73ADD49F
9E25C5FED0F3F775FBB2A5C76DD0511C
ADB20527463A407E77162C54D30435F1
879503A3ED5F2DCB6592E99C42E1BDFE
7AB9D5F7D122A38CA8769C9C93F3A12F
B9D800D33FDCF7AF2157CB66910A0797
AD7DEB9BF9C9B17C60B69DA2B3B6C59A
A305B55D5049F38F5139DA95B3DCE247
A5302213F1605BE400E8AA34992B18A8
9FD6E2CD74490F5DA5F52D249CBB750A
C09F65F2853D03DE23CFD90F97429735
5DA9B900E7C9F71714FB1AE9DA631C83
CEBA063FD7BF190D727CC948185CCEC8
ACA2E31E67D50F779611D7FDB674C370
D8B77A575B5308D161F95ACF515F9772
A6E8B0AC5E066F7670116136442F728F
1D5A0DC978A69FF28EC9D153F32EA871
B9A395E297106E5D6F72747F84AC7AE5
97D9D96077AD3E8859BF5C54C873E59D
5A66BC427F25EFFDFEDED4A07D8F9F91
37034A23CAFF85394E2E349C381788A6
B82793CB1270A48BB2697C51AEED3E4A
D6803CFD38D435F0364EB47684F7CCF6
C945C989CF380E22E1B1E4B28E26801A
D31F0611DE6B94A5F001584286883AB7
D2007D608FBB90EF5363BF5C8E08117A
0CBC523581751D977C4121B95429E8A9
DAD134C77F7E09BC552E290534CB90E8
66788E34B6E292DE03B1B54E797CADBF
2B6D9C77F287F5C021EC7297203D412B
2C45FDF91F91AE8A3A9E6F119E8BED13
37EFBD2BA398148336F96B4347392A8D
551B893D34A2A59971B8FF185C1CD0C8
B1885B70DEFAC440D7DCBB520854A651
D1C57A2E87382A82A40B1816E85277EA

2025-01-24 05:03:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:03:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:03:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:03:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 31
2025-01-24 05:03:16 - snowflake.connector.connection - INFO - closed
2025-01-24 05:03:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:03:17 - root - INFO - SQL:
SELECT "event_name", COUNT(*) AS "event_count"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
GROUP BY "event_name"
LIMIT 100
Results:
event_name,event_count
session_start,579
screen_view,20445
level_start_quickplay,4078
user_engagement,11536
post_score,2085
level_complete_quickplay,1647
level_end_quickplay,2700
select_content,925
level_fail_quickplay,1053
level_retry_quickplay,178
level_up,438
level_complete,438
level_start,921
level_end,613
level_retry,509
level_reset_quickplay,1044
level_fail,175
completed_5_levels,25
app_remove,44
app_exception,24
level_reset,137
no_more_extra_steps,20
os_update,25
error,24
firebase_campaign,54
app_update,9
use_extra_steps,95
spend_virtual_currency,98
ad_reward,12
challenge_a_friend,5
first_open,64

2025-01-24 05:03:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:03:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:03:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:03:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 05:03:18 - snowflake.connector.connection - INFO - closed
2025-01-24 05:03:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:03:18 - root - INFO - SQL:
SELECT "user_pseudo_id", "user_first_touch_timestamp"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
LIMIT 100
Results:
Too long, hard cut:
user_pseudo_id,user_first_touch_timestamp
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B

2025-01-24 05:03:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:03:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:03:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:03:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 05:03:20 - snowflake.connector.connection - INFO - closed
2025-01-24 05:03:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:03:20 - root - INFO - SQL:
SELECT f.value::VARIANT AS "event_param"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901" t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 100
Results:
Too long, hard cut:
event_param
"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 121566607420435696
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 5585962841668417286
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""MainMenuActivity""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FloodItActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417306
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 5585962841668417306
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417307
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""FloodItActivity""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 5585962841668417307
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 121566607420435695
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 121566607420435696
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""MainMenuActivity""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""MainMenuActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417286
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""MainMenuActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 121566607420435695
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417307
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""content_type"",
  ""value"": {
    ""string_value"": ""mode""
  }
}"
"{
  ""key"": ""item_id"",
  ""value"": {
    ""string_value"": ""quickplay""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""engagement_time_msec"",
  ""value"": {
    ""int_value"": 4945
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417307
  }
}"
"{
  ""key"": "

2025-01-24 05:03:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:03:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:03:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:03:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 05:03:22 - snowflake.connector.connection - INFO - closed
2025-01-24 05:03:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:03:22 - root - INFO - SQL:
SELECT "user_pseudo_id", "event_name", "event_timestamp"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180908"
WHERE "user_pseudo_id" IN (
  SELECT DISTINCT "user_pseudo_id"
  FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
)
LIMIT 100
Results:
Too long, hard cut:
user_pseudo_id,event_name,event_timestamp
E5A2CB7A471E740E758BE5E2E0C79BC2,app_exception,1536417891684015
E5A2CB7A471E740E758BE5E2E0C79BC2,level_end_quickplay,1536406993668011
E5A2CB7A471E740E758BE5E2E0C79BC2,level_retry_quickplay,1536407027794017
E5A2CB7A471E740E758BE5E2E0C79BC2,level_start_quickplay,1536407038840019
E5A2CB7A471E740E758BE5E2E0C79BC2,level_start_quickplay,1536417985937026
E5A2CB7A471E740E758BE5E2E0C79BC2,post_score,1536406950669012
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536406878694005
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536406949724006
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536406962877018
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536407904006001
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536417651051001
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536417666112005
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536417615149006
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536417972219012
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536417926970014
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536417960381022
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536407913862000
E5A2CB7A471E740E758BE5E2E0C79BC2,select_content,1536406934413003
E5A2CB7A471E740E758BE5E2E0C79BC2,select_content,1536417637872003
E5A2CB7A471E740E758BE5E2E0C79BC2,select_content,1536417854036002
E5A2CB7A471E740E758BE5E2E0C79BC2,user_engagement,1536406957753013
E5A2CB7A471E740E758BE5E2E0C79BC2,user_engagement,1536406986803016
E5A2CB7A471E740E758BE5E2E0C79BC2,user_engagement,1536417947178011
E5A2CB7A471E740E758BE5E2E0C79BC2,user_engagement,1536417950255028
E5A2CB7A471E740E758BE5E2E0C79BC2,user_engagement,1536417971736031
0289ACB4026B0C28A9FF7BF2560E2A7F,select_content,1536411115362009
0289ACB4026B0C28A9FF7BF2560E2A7F,user_engagement,1536411220255000
751B06814F2E7EFE53CF17EA6A435B58,post_score,1536411584573032
751B06814F2E7EFE53CF17EA6A435B58,level_complete_quickplay,1536411103784050
751B06814F2E7EFE53CF17EA6A435B58,level_complete_quickplay,1536411303837008
751B06814F2E7EFE53CF17EA6A435B58,level_complete_quickplay,1536411450374021
751B06814F2E7EFE53CF17EA6A435B58,level_start_quickplay,1536410693271014
751B06814F2E7EFE53CF17EA6A435B58,level_end_quickplay,1536410766371029
751B06814F2E7EFE53CF17EA6A435B58,level_fail_quickplay,1536410764371030
751B06814F2E7EFE53CF17EA6A435B58,level_start_quickplay,1536411268980000
751B06814F2E7EFE53CF17EA6A435B58,level_start_quickplay,1536411374613014
751B06814F2E7EFE53CF17EA6A435B58,level_start_quickplay,1536411501061027
751B06814F2E7EFE53CF17EA6A435B58,user_engagement,1536410915145043
751B06814F2E7EFE53CF17EA6A435B58,user_engagement,1536410133275009
751B06814F2E7EFE53CF17EA6A435B58,user_engagement,1536411014339051
751B06814F2E7EFE53CF17EA6A435B58,user_engagement,1536411095983056
751B06814F2E7EFE53CF17EA6A435B58,user_engagement,1536411381534015
751B06814F2E7EFE53CF17EA6A435B58,screen_view,1536410508984012
751B06814F2E7EFE53CF17EA6A435B58,screen_view,1536410815648022
751B06814F2E7EFE53CF17EA6A435B58,screen_view,1536411013340054
751B06814F2E7EFE53CF17EA6A435B58,screen_view,1536411357427012
751B06814F2E7EFE53CF17EA6A435B58,screen_view,1536411463940025
751B06814F2E7EFE53CF17EA6A435B58,screen_view,1536411558977031
018F03084C88E944163F76A0D0C2FBA1,level_start_quickplay,1536440870975044
018F03084C88E944163F76A0D0C2FBA1,level_end_quickplay,1536441912456094
018F03084C88E944163F76A0D0C2FBA1,screen_view,1536440584187017
018F03084C88E944163F76A0D0C2FBA1,screen_view,1536440557208018
018F03084C88E944163F76A0D0C2FBA1,screen_view,1536440621167023
018F03084C88E944163F76A0D0C2FBA1,screen_view,1536440621082026
018F03084C88E944163F76A0D0C2FBA1,select_content,1536440536134015
018F03084C88E944163F76A0D0C2FBA1,user_engagement,1536440850945042
635808C1DDFBC662DC3015097E26E62A,level_complete_quickplay,1536396746318010
635808C1DDFBC662DC3015097E26E62A,level_retry_quickplay,1536397174119094
635808C1DDFBC662DC3015097E26E62A,level_end_quickplay,1536397360862024
635808C1DDFBC662DC3015097E26E62A,screen_view,1536396926076042
B8ABD1FA94CF24CDEF5E10768CD6EF5C,level_start_quickplay,1536466834839018
B8ABD1FA94CF24CDEF5E10768CD6EF5C,screen_view,1536466863103025
724B99CB6F41846F3F6BB46C2F663F5E,level_start_quickplay,1536437591622006
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536418014954024
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536418034286029
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536406897291000
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536417860550000
0289ACB4026B0C28A9FF7BF2560E2A7F,session_start,1536411066573000
0289ACB4026B0C28A9FF7BF2560E2A7F,screen_view,1536411315259003
0289ACB4026B0C28A9FF7BF2560E2A7F,screen_view,1536411285262006
751B06814F2E7EFE53CF17EA6A435B58,post_score,1536411329837006
751B06814F2E7EFE53CF17EA6A435B58,post_score,1536411498374019
751B06814F2E7EFE53CF17EA6A435B58,level_start_quickplay,1536410363470001
751B06814F2E7EFE53CF17EA6A435B58,level_start_quickplay,1536410952522033
751B06814F2E7EFE53CF17EA6A435B58,level_end_quickplay,1536411683573033
751B06814F2E7E

2025-01-24 05:03:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:03:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:03:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:03:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 05:03:24 - snowflake.connector.connection - INFO - closed
2025-01-24 05:03:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:03:24 - root - INFO - SQL:
SELECT "event_date", COUNT(DISTINCT "user_pseudo_id") AS "daily_active_users"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
GROUP BY "event_date"
LIMIT 100
Results:
event_date,daily_active_users
20180901,465

2025-01-24 05:03:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:03:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:03:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:03:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 05:03:25 - snowflake.connector.connection - INFO - closed
2025-01-24 05:03:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:03:26 - root - INFO - SQL:
SELECT t."user_pseudo_id", t."geo"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901" t
LIMIT 100
Results:
Too long, hard cut:
user_pseudo_id,geo
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
0AF67C1A1C8F3785609B4210C3E04FC8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
0AF67C1A1C8F3785609B4210C3E04FC8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
0AF67C1A1C8F3785609B4210C3E04FC8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
0AF67C1A1C8F3785609B4210C3E04FC8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
0AF67C1A1C8F3785609B4210C3E04FC8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
0AF67C1A1C8F3785609B4210C3E04FC8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
0AF67C1A1C8F3785609B4210C3E04FC8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
0AF67C1A1C8F3785609B4210C3E04FC8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102C

2025-01-24 05:03:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:03:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:03:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:03:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-24 05:03:27 - snowflake.connector.connection - INFO - closed
2025-01-24 05:03:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:03:28 - root - INFO - SQL:
SELECT DISTINCT "platform"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
LIMIT 100
Results:
platform
ANDROID
IOS

2025-01-24 05:03:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:03:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:03:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:03:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 05:03:29 - snowflake.connector.connection - INFO - closed
2025-01-24 05:03:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:03:29 - root - INFO - SQL:
SELECT "user_pseudo_id", COUNT(*) AS "total_events"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901" t1
WHERE "user_pseudo_id" IN (
  SELECT DISTINCT "user_pseudo_id"
  FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
)
GROUP BY "user_pseudo_id"
LIMIT 100
Results:
user_pseudo_id,total_events
6080ACBD76F27089523A73026969036D,42
4D084D38156128AAA060303AA91E689D,15
F6C27759C6668FF8619110956AAAB1F0,32
5800569BC32997BCE5774BA3C675C4E4,30
B5395F8C2077B59B3D6C5719C0CA0339,582
037DAC225F0C1E54657770CD201CDDA7,58
75C00378B3BA26B12559020A83A74355,90
5C3E52036EA54498B6E571A50A45ABFD,5
14DE6B1CDA3BFD44679C7E9382644AC7,70
387B532B7AF7A362DBF783E34C05BF54,422
CA04708DA02378999ECB402481FF1AE4,163
B8984A29BE4798F85EA15F483E37877E,4
3E93326F1DF43AF5F27987897F2BB819,30
C576922AC96E60240D148752D36BF34C,1
A66F392F752B3A59F2644F4158644FF1,14
0289ACB4026B0C28A9FF7BF2560E2A7F,16
096C23E69254818F7EE03C1239005F2B,39
6E94F41FB1EB000C00CEAF43CF70938F,28
437E1E4F1A7DF0CC995FCE10EAC96350,15
F4CB0B30E0A170AEB6A94EF1156738C8,242
751B06814F2E7EFE53CF17EA6A435B58,83
7CB4F979C9025D90BBBA34B3F3BF80C4,34
6D32B47F6F516304209375F1D0CCE5A3,3
13AC12EF4C6A0EAF72795F720752AD98,394
AC5BB8A4162F0D60D28B10AB440DBC26,31
A0616D4E494DC3BCCB94B8B6E5B48380,244
03948FE68D30FD7BD6B46D1993062581,33
14FC1A25D55E89AC7ECD600CD3A08C13,305
25E47FA1836137C0429FABD59B15C11D,90
8D9D62A4402581BB1181D3AA73AD54E8,15
2B90CE94C6039DF03E72FE15B5320ABA,61
26FACA90F8AA62D614E65FD30CD978AB,21
6D6EB70E837A5007BE550C44FF276440,49
96161BF2E55C7E32ED5F411432875ECB,15
5FC0AF35EF724F7BBB10833E2281EB18,41
6C333017CEA199B69BB27611BA5DE7B5,27
4A986ED62BA3188AF4EF8217DB3F2776,34
B3A9A38A561B3648D280614B8E2D8E07,38
6722ACD286AC0F5CA22E745302CAEB89,13
5ACD59093D1C49F2EADAE29D7181A9CF,1
3B4A6FCA6DCB4C2749409DC4188A306E,1585
841727B396264112EC75FEB26C57E25C,194
33E5EA9FE1E29AC3127D975A5494213D,51
C3DDDD01BC219197FCB862218F7DC494,72
DA4F13B8835C8DF20ADF1C21E060E4B7,1
396CD60DADAB9CBA7DDCAF239B477135,1
7ED4165854463C38F1D739A2014001D9,24
7AB9D5F7D122A38CA8769C9C93F3A12F,131
F3C9D7235C2A60FBFBDE1F2EEFBA8B2B,3
5BB701762E3D47A7D00680C9C76FC5B8,12
FEDC59699D8832A11B88BFCCCAD0951D,19
C7DD86F06FD4AA8A0967E27E20750FCD,108
F4634EFF4D9470DCA00051E3304B81AF,28
CA51DAF1373B5C2A16C174AFBD2132A4,15
B8937995A71BAC9FD139C56F0CA68A73,3
8B8CA0D1ACB551E3A654AD05FC0F2CE2,16
635808C1DDFBC662DC3015097E26E62A,40
5A66BC427F25EFFDFEDED4A07D8F9F91,32
2902E47E243769C20EEFACE79EB4ECB3,3
B9A395E297106E5D6F72747F84AC7AE5,11
89427602D4335C85A7205E64B3347655,36
5469339F9A77954EF02C1A807D6AFE66,17
667A8D0FDB2FA1BA819DAB6C0F5C7BC4,26
D771048ADB1B9CACADFE001E6F9BA799,292
E5A2CB7A471E740E758BE5E2E0C79BC2,41
F9E25D9E79A408331969D9ED06679184,169
C945C989CF380E22E1B1E4B28E26801A,11
7A85F2041ECC509DEDAD05C9C09125FA,678
690730C8110E9A41E7C247A8AE212BFA,27
AD7DEB9BF9C9B17C60B69DA2B3B6C59A,88
372D9BB5088C4E9000C65B06459B403A,14
5DA9B900E7C9F71714FB1AE9DA631C83,58
EF7772819E807EDBD8DB0F0B5210030E,23
7E38A396789F21724DDEFB0400305685,179
2684EA4DDB1F988E3C979AB15CFF601F,72
9373B5D36107012F6F9137090C523FA1,12
6F90140F6B66544AAF9181C740122566,13
2AAC37325749A1E1CB4D43A48BACA2C9,51
81BFFE61CAB181676917D75F1B617CB2,37
F4F4EAE9439622EA3CA9489A52E7230F,26
D79D77E3F2698B89279D7C35AB034992,161
3E336ECE1F533064D663A350DAB00790,289
B7BA9E1AB4945183AEB5B58AA1FEB91F,7
5E9BF00B469B284E028094EA15A9F1FE,26
301AFECE7DEEE17ACC059F6C18017D80,20
E6E7FC8AC6D32935DA5ADCFFD14CC3A8,7
0D17D0247F158FA3E40D21EFF46D1651,165
D99BC96AD021DD4BC255489C45083668,9
75C0C246DE2188E02D984C2E71B7B4C0,14
869CD665A9D52E3398754C8DACF4426D,233
F4A3B9F9F0D4555ADC48F7BCBD5BEE9C,131
AFA25B217428A5328ECE8D2C4C583916,10
624E70EBAEC11C05B5235EE1A7989D7A,25
EEBCB25D5F056CCF59DDE654388ACD2B,61
34ADF71F1AADCA26EC8008496F7CC87E,164
A5BEE3FC4D5248D2B2C655F6B7C1E5A3,15
45116F98E0EE54636FE629BA54228131,18
DF67650EB85A06BB0B00BA7CABFD7647,13
8D0EAD73C85E48D958042757FEBB37BC,70
018F03084C88E944163F76A0D0C2FBA1,257

2025-01-24 05:03:29 - root - INFO - itercount: 0
2025-01-24 05:03:29 - root - INFO - Database Name: FIREBASE
Schema Name: ANALYTICS_153293282
DDL describes table information.
,0
table_name,EVENTS_20180613
description,
DDL,"create or replace TABLE EVENTS_20180613 (
	""event_date"" VARCHAR(16777216),
	""event_timestamp"" NUMBER(38,0),
	""event_name"" VARCHAR(16777216),
	""event_params"" VARIANT,
	""event_previous_timestamp"" NUMBER(38,0),
	""user_id"" VARCHAR(16777216),
	""user_pseudo_id"" VARCHAR(16777216),
	""user_properties"" VARIANT,
	""user_first_touch_timestamp"" NUMBER(38,0),
	""user_ltv"" VARIANT,
	""device"" VARIANT,
	""geo"" VARIANT,
	""app_info"" VARIANT,
	""traffic_source"" VARIANT,
	""stream_id"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']
External knowledge that might be helpful: 
How to Calculate User Retention in Big Query from Google Demo Game Analytics Data

As a Product / Website Analyst, I was pretty psyched to discover Google’s public Google Analytics 4 (GA4) gaming event dataset called `firebase-public-project.analytics_153293282.events_*`. The table allows experienced developers and learners alike to experiment with raw GA4 data in Big Query for free. Event data is basically a log of user interactions with your product for analysis .For newbies interested in learning more about event data and GA4, visit my prior blog. This article provides SQL queries for a quick table overview and explains how to utilize Google Big Query to calculate user retention.


What is Retention?
User retention rates are key indicators for whether your product team meets user needs. Improving retention is often central to long term growth strategies.

**Retention measure’s how often and for how long users tend to return to your product.**

The metric can be a powerful proxy for product usefulness and user opinion. Its analysis can reveal critical information like how well your site converts new visitors to users and which items and features are associated with users coming back. If user data is available, retention can also help a business understand the profiles of its most active users (power users). Finally, retention is a great guardrail metric for A/B tests. Successful, product oriented companies prioritize a healthy user bases over short term profits.


**Common Retention Calculation Strategies**

Two common strategies to calculate retention are: 

a) N-Day retention

b) Unbounded Retention.


a) For N-Day retention, analysts calculate how many users with certain characteristics return over successive periods. It is called N days because we define the length of each period. For example, with N=7 day retention, if User A becomes part of our cohort of interest on day 0 and returns to the product day 5 and day 15, they are counted as retained for week 1 (1–7 days) and week 3 (15–21 days) but not week 2 (8–14 days).


b) For Unbounded Retention, a user is counted as retained each week so long as their most recent product contact was after the week. For example, if User A becomes part of the cohort on day 0 and last returned to the site on day 21, they will be counted as retained in week 1 (1–7 days), week 2 (8–14 days), and week 3 (15–21 days) but not week 4 (22–28 days).

By calculating these metrics, companies can evaluate how well their products hold users’ interests. It also them closer to identifying the patterns that generate return users.



The table structure information is ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}
Begin Exploring Related Columns
**Relevant Columns and Their Potential Usage:**

- **"event_date"**: Used to filter events by specific dates.
- **"event_timestamp"**: Provides the exact timestamp of each event.
- **"event_name"**: Identifies the type of event (e.g., "first_open", "user_engagement").
- **"user_pseudo_id"**: Unique identifier for each user.
- **"user_first_touch_timestamp"**: Indicates when the user first used the app.
- **"platform"**: Specifies the platform used (e.g., iOS, Android).
- **"geo"**: Contains geographic information; can be used to determine timezone.

**Possible Conditions to Use:**

- **Date Range**: Filtering events between '20180901' and '20180907' for initial user activity.
- **User Cohort**: Selecting users whose **"user_first_touch_timestamp"** falls within the first week of September 2018.
- **Event Filtering**: Focusing on specific **"event_name"** values to identify relevant user actions.
- **Timezone Filtering**: Ensuring events are considered in the Shanghai timezone.

---

**Sample SQL Queries:**

1. **Retrieve distinct event dates in September 2018:**

   ```sql
   SELECT DISTINCT "event_date"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
   LIMIT 100;
   ```

2. **Get a list of unique users who first used the app in the first week of September 2018:**

   ```sql
   SELECT DISTINCT "user_pseudo_id"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
   WHERE "user_first_touch_timestamp" >= 1535731200000
     AND "user_first_touch_timestamp" < 1536336000000
   LIMIT 100;
   ```

   *Note: Timestamps are in microseconds since Unix epoch for September 1-7, 2018.*

3. **Count the number of events per event name in September 2018:**

   ```sql
   SELECT "event_name", COUNT(*) AS "event_count"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
   WHERE "event_date" BETWEEN '20180901' AND '20180930'
   GROUP BY "event_name"
   LIMIT 100;
   ```

4. **List users and their first touch timestamps who started using the app in early September 2018:**

   ```sql
   SELECT "user_pseudo_id", "user_first_touch_timestamp"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
   WHERE "user_first_touch_timestamp" >= 1535731200000
     AND "user_first_touch_timestamp" < 1536336000000
   LIMIT 100;
   ```

5. **Extract and display event parameters from the "event_params" column:**

   ```sql
   SELECT f.value::VARIANT AS "event_param"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901" t,
   LATERAL FLATTEN(input => t."event_params") f
   LIMIT 100;
   ```

6. **Find events for users from the initial cohort during the second week of September 2018:**

   ```sql
   SELECT "user_pseudo_id", "event_name", "event_timestamp"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180908"
   WHERE "user_pseudo_id" IN (
     SELECT DISTINCT "user_pseudo_id"
     FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
     WHERE "user_first_touch_timestamp" >= 1535731200000
       AND "user_first_touch_timestamp" < 1536336000000
   )
   LIMIT 100;
   ```

7. **Calculate daily active users (DAU) for September 2018:**

   ```sql
   SELECT "event_date", COUNT(DISTINCT "user_pseudo_id") AS "daily_active_users"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
   WHERE "event_date" BETWEEN '20180901' AND '20180930'
   GROUP BY "event_date"
   LIMIT 100;
   ```

8. **Identify users from Shanghai timezone who first used the app in early September 2018:**

   ```sql
   SELECT t."user_pseudo_id", g.value:"city"::STRING AS "city"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901" t,
   LATERAL FLATTEN(input => t."geo") g
   WHERE g.value:"city"::STRING = 'Shanghai'
     AND t."user_first_touch_timestamp" >= 1535731200000
     AND t."user_first_touch_timestamp" < 1536336000000
   LIMIT 100;
   ```

9. **List platforms used by new users in the first week of September 2018:**

   ```sql
   SELECT DISTINCT "platform"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
   WHERE "user_first_touch_timestamp" >= 1535731200000
     AND "user_first_touch_timestamp" < 1536336000000
   LIMIT 100;
   ```

10. **Count total events per user for users who started in early September 2018 over the next three weeks:**

    ```sql
    SELECT "user_pseudo_id", COUNT(*) AS "total_events"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901" t1
    WHERE "user_pseudo_id" IN (
      SELECT DISTINCT "user_pseudo_id"
      FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
      WHERE "user_first_touch_timestamp" >= 1535731200000
        AND "user_first_touch_timestamp" < 1536336000000
    )
      AND t1."event_date" BETWEEN '20180901' AND '20180921'
    GROUP BY "user_pseudo_id"
    LIMIT 100;
    ```

---

These queries are designed to help understand the data related to user retention for new users who first used the app in the first week of September 2018. By exploring event dates, user identifiers, timestamps, and event names, you can gain insights into user behavior and prepare for calculating retention rates.

- **Note on Timestamps**: The `user_first_touch_timestamp` and `event_timestamp` are likely in microseconds since the Unix epoch. Adjust the timestamp values accordingly to match the data.
- **Event Tables**: Since data is partitioned by date, you might need to query multiple tables (e.g., `EVENTS_20180901`, `EVENTS_20180908`, etc.) for different weeks.
- **Timezones**: Ensure that any date and time calculations consider the Shanghai timezone if necessary.

These queries should give you a good foundation to understand the data and proceed with the retention rate calculations.Query:
SELECT DISTINCT "event_date"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
   LIMIT 100;
Answer:
event_date
20180901
Query:
SELECT DISTINCT "user_pseudo_id"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
WHERE "event_name" = 'first_open'
LIMIT 100;
Answer:
user_pseudo_id
4EEE67C2E335213F6815144829801E0F
27C0BAADCE9520F17249A8B85F6477DA
D963E509346C0E5358ECFE56AF3BB2ED
4A2A03B50BDA6AC1687703BD39A91E3E
0E9150E8985138A744B88D56F015EDA7
FCD8DDE7775A7211BCA9F42768C3BB8B
6D6EB70E837A5007BE550C44FF276440
96333A5A97DA9F4AEBC7A70483AF6C5C
F4CB0B30E0A170AEB6A94EF1156738C8
EA89F979E0D4C374DBC95268982D18DE
34CAF47105A2D9D0AC7464BB3AF8DB2A
2C15FFDEDDA69390B7A8EB5808FB7ED6
6C333017CEA199B69BB27611BA5DE7B5
531E7B35DE9A21A1942F057C98B4E74C
14FC1A25D55E89AC7ECD600CD3A08C13
7331597E5500811253BA85AF851A193C
61BB31EC7781341B1D7B8D8A85688DA3
E0F1ED4167D0C0B2D6DCBA85CB020F52
177C0BEFFC69408F88D3377632F1BB60
5F5D7A3F5575008A81BB77CFE70C4285
387B532B7AF7A362DBF783E34C05BF54
1E882F0B9818614D6E47620DD31229F1
9F8885F0261FE69A58C8B6AE9176E437
D771048ADB1B9CACADFE001E6F9BA799
C7DD86F06FD4AA8A0967E27E20750FCD
E6E7FC8AC6D32935DA5ADCFFD14CC3A8
3E336ECE1F533064D663A350DAB00790
CCE5E30054C510608589FA6240615B0A
3B049329E3090DA7A4339C4A46EF0763
8DEB6CB6C3E85D0032D8557C73ADD49F
9E25C5FED0F3F775FBB2A5C76DD0511C
ADB20527463A407E77162C54D30435F1
879503A3ED5F2DCB6592E99C42E1BDFE
7AB9D5F7D122A38CA8769C9C93F3A12F
B9D800D33FDCF7AF2157CB66910A0797
AD7DEB9BF9C9B17C60B69DA2B3B6C59A
A305B55D5049F38F5139DA95B3DCE247
A5302213F1605BE400E8AA34992B18A8
9FD6E2CD74490F5DA5F52D249CBB750A
C09F65F2853D03DE23CFD90F97429735
5DA9B900E7C9F71714FB1AE9DA631C83
CEBA063FD7BF190D727CC948185CCEC8
ACA2E31E67D50F779611D7FDB674C370
D8B77A575B5308D161F95ACF515F9772
A6E8B0AC5E066F7670116136442F728F
1D5A0DC978A69FF28EC9D153F32EA871
B9A395E297106E5D6F72747F84AC7AE5
97D9D96077AD3E8859BF5C54C873E59D
5A66BC427F25EFFDFEDED4A07D8F9F91
37034A23CAFF85394E2E349C381788A6
B82793CB1270A48BB2697C51AEED3E4A
D6803CFD38D435F0364EB47684F7CCF6
C945C989CF380E22E1B1E4B28E26801A
D31F0611DE6B94A5F001584286883AB7
D2007D608FBB90EF5363BF5C8E08117A
0CBC523581751D977C4121B95429E8A9
DAD134C77F7E09BC552E290534CB90E8
66788E34B6E292DE03B1B54E797CADBF
2B6D9C77F287F5C021EC7297203D412B
2C45FDF91F91AE8A3A9E6F119E8BED13
37EFBD2BA398148336F96B4347392A8D
551B893D34A2A59971B8FF185C1CD0C8
B1885B70DEFAC440D7DCBB520854A651
D1C57A2E87382A82A40B1816E85277EA
Query:
SELECT "event_name", COUNT(*) AS "event_count"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
GROUP BY "event_name"
LIMIT 100
Answer:
event_name,event_count
session_start,579
screen_view,20445
level_start_quickplay,4078
user_engagement,11536
post_score,2085
level_complete_quickplay,1647
level_end_quickplay,2700
select_content,925
level_fail_quickplay,1053
level_retry_quickplay,178
level_up,438
level_complete,438
level_start,921
level_end,613
level_retry,509
level_reset_quickplay,1044
level_fail,175
completed_5_levels,25
app_remove,44
app_exception,24
level_reset,137
no_more_extra_steps,20
os_update,25
error,24
firebase_campaign,54
app_update,9
use_extra_steps,95
spend_virtual_currency,98
ad_reward,12
challenge_a_friend,5
first_open,64
Query:
SELECT "user_pseudo_id", "user_first_touch_timestamp"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
LIMIT 100
Answer:
Too long, hard cut:
user_pseudo_id,user_first_touch_timestamp
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B
Query:
SELECT f.value::VARIANT AS "event_param"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901" t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 100
Answer:
Too long, hard cut:
event_param
"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 121566607420435696
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 5585962841668417286
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""MainMenuActivity""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FloodItActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417306
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 5585962841668417306
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417307
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""FloodItActivity""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 5585962841668417307
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 121566607420435695
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 121566607420435696
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""MainMenuActivity""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""MainMenuActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417286
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""MainMenuActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 121566607420435695
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417307
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""content_type"",
  ""value"": {
    ""string_value"": ""mode""
  }
}"
"{
  ""key"": ""item_id"",
  ""value"": {
    ""string_value"": ""quickplay""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""engagement_time_msec"",
  ""value"": {
    ""int_value"": 4945
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417307
  }
}"
"{
  ""key"": "
Query:
SELECT "user_pseudo_id", "event_name", "event_timestamp"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180908"
WHERE "user_pseudo_id" IN (
  SELECT DISTINCT "user_pseudo_id"
  FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
)
LIMIT 100
Answer:
Too long, hard cut:
user_pseudo_id,event_name,event_timestamp
E5A2CB7A471E740E758BE5E2E0C79BC2,app_exception,1536417891684015
E5A2CB7A471E740E758BE5E2E0C79BC2,level_end_quickplay,1536406993668011
E5A2CB7A471E740E758BE5E2E0C79BC2,level_retry_quickplay,1536407027794017
E5A2CB7A471E740E758BE5E2E0C79BC2,level_start_quickplay,1536407038840019
E5A2CB7A471E740E758BE5E2E0C79BC2,level_start_quickplay,1536417985937026
E5A2CB7A471E740E758BE5E2E0C79BC2,post_score,1536406950669012
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536406878694005
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536406949724006
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536406962877018
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536407904006001
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536417651051001
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536417666112005
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536417615149006
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536417972219012
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536417926970014
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536417960381022
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536407913862000
E5A2CB7A471E740E758BE5E2E0C79BC2,select_content,1536406934413003
E5A2CB7A471E740E758BE5E2E0C79BC2,select_content,1536417637872003
E5A2CB7A471E740E758BE5E2E0C79BC2,select_content,1536417854036002
E5A2CB7A471E740E758BE5E2E0C79BC2,user_engagement,1536406957753013
E5A2CB7A471E740E758BE5E2E0C79BC2,user_engagement,1536406986803016
E5A2CB7A471E740E758BE5E2E0C79BC2,user_engagement,1536417947178011
E5A2CB7A471E740E758BE5E2E0C79BC2,user_engagement,1536417950255028
E5A2CB7A471E740E758BE5E2E0C79BC2,user_engagement,1536417971736031
0289ACB4026B0C28A9FF7BF2560E2A7F,select_content,1536411115362009
0289ACB4026B0C28A9FF7BF2560E2A7F,user_engagement,1536411220255000
751B06814F2E7EFE53CF17EA6A435B58,post_score,1536411584573032
751B06814F2E7EFE53CF17EA6A435B58,level_complete_quickplay,1536411103784050
751B06814F2E7EFE53CF17EA6A435B58,level_complete_quickplay,1536411303837008
751B06814F2E7EFE53CF17EA6A435B58,level_complete_quickplay,1536411450374021
751B06814F2E7EFE53CF17EA6A435B58,level_start_quickplay,1536410693271014
751B06814F2E7EFE53CF17EA6A435B58,level_end_quickplay,1536410766371029
751B06814F2E7EFE53CF17EA6A435B58,level_fail_quickplay,1536410764371030
751B06814F2E7EFE53CF17EA6A435B58,level_start_quickplay,1536411268980000
751B06814F2E7EFE53CF17EA6A435B58,level_start_quickplay,1536411374613014
751B06814F2E7EFE53CF17EA6A435B58,level_start_quickplay,1536411501061027
751B06814F2E7EFE53CF17EA6A435B58,user_engagement,1536410915145043
751B06814F2E7EFE53CF17EA6A435B58,user_engagement,1536410133275009
751B06814F2E7EFE53CF17EA6A435B58,user_engagement,1536411014339051
751B06814F2E7EFE53CF17EA6A435B58,user_engagement,1536411095983056
751B06814F2E7EFE53CF17EA6A435B58,user_engagement,1536411381534015
751B06814F2E7EFE53CF17EA6A435B58,screen_view,1536410508984012
751B06814F2E7EFE53CF17EA6A435B58,screen_view,1536410815648022
751B06814F2E7EFE53CF17EA6A435B58,screen_view,1536411013340054
751B06814F2E7EFE53CF17EA6A435B58,screen_view,1536411357427012
751B06814F2E7EFE53CF17EA6A435B58,screen_view,1536411463940025
751B06814F2E7EFE53CF17EA6A435B58,screen_view,1536411558977031
018F03084C88E944163F76A0D0C2FBA1,level_start_quickplay,1536440870975044
018F03084C88E944163F76A0D0C2FBA1,level_end_quickplay,1536441912456094
018F03084C88E944163F76A0D0C2FBA1,screen_view,1536440584187017
018F03084C88E944163F76A0D0C2FBA1,screen_view,1536440557208018
018F03084C88E944163F76A0D0C2FBA1,screen_view,1536440621167023
018F03084C88E944163F76A0D0C2FBA1,screen_view,1536440621082026
018F03084C88E944163F76A0D0C2FBA1,select_content,1536440536134015
018F03084C88E944163F76A0D0C2FBA1,user_engagement,1536440850945042
635808C1DDFBC662DC3015097E26E62A,level_complete_quickplay,1536396746318010
635808C1DDFBC662DC3015097E26E62A,level_retry_quickplay,1536397174119094
635808C1DDFBC662DC3015097E26E62A,level_end_quickplay,1536397360862024
635808C1DDFBC662DC3015097E26E62A,screen_view,1536396926076042
B8ABD1FA94CF24CDEF5E10768CD6EF5C,level_start_quickplay,1536466834839018
B8ABD1FA94CF24CDEF5E10768CD6EF5C,screen_view,1536466863103025
724B99CB6F41846F3F6BB46C2F663F5E,level_start_quickplay,1536437591622006
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536418014954024
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536418034286029
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536406897291000
E5A2CB7A471E740E758BE5E2E0C79BC2,screen_view,1536417860550000
0289ACB4026B0C28A9FF7BF2560E2A7F,session_start,1536411066573000
0289ACB4026B0C28A9FF7BF2560E2A7F,screen_view,1536411315259003
0289ACB4026B0C28A9FF7BF2560E2A7F,screen_view,1536411285262006
751B06814F2E7EFE53CF17EA6A435B58,post_score,1536411329837006
751B06814F2E7EFE53CF17EA6A435B58,post_score,1536411498374019
751B06814F2E7EFE53CF17EA6A435B58,level_start_quickplay,1536410363470001
751B06814F2E7EFE53CF17EA6A435B58,level_start_quickplay,1536410952522033
751B06814F2E7EFE53CF17EA6A435B58,level_end_quickplay,1536411683573033
751B06814F2E7E
Query:
SELECT "event_date", COUNT(DISTINCT "user_pseudo_id") AS "daily_active_users"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
GROUP BY "event_date"
LIMIT 100
Answer:
event_date,daily_active_users
20180901,465
Query:
SELECT t."user_pseudo_id", t."geo"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901" t
LIMIT 100
Answer:
Too long, hard cut:
user_pseudo_id,geo
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""continent"": ""Oceania"",
  ""country"": ""Australia""
}"
0AF67C1A1C8F3785609B4210C3E04FC8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
0AF67C1A1C8F3785609B4210C3E04FC8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
0AF67C1A1C8F3785609B4210C3E04FC8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
0AF67C1A1C8F3785609B4210C3E04FC8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
0AF67C1A1C8F3785609B4210C3E04FC8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
0AF67C1A1C8F3785609B4210C3E04FC8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
0AF67C1A1C8F3785609B4210C3E04FC8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
0AF67C1A1C8F3785609B4210C3E04FC8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102CC7D8CD5D3E861EACE1BAB97E61EC,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
102C
Query:
SELECT DISTINCT "platform"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
LIMIT 100
Answer:
platform
ANDROID
IOS
Query:
SELECT "user_pseudo_id", COUNT(*) AS "total_events"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901" t1
WHERE "user_pseudo_id" IN (
  SELECT DISTINCT "user_pseudo_id"
  FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
)
GROUP BY "user_pseudo_id"
LIMIT 100
Answer:
user_pseudo_id,total_events
6080ACBD76F27089523A73026969036D,42
4D084D38156128AAA060303AA91E689D,15
F6C27759C6668FF8619110956AAAB1F0,32
5800569BC32997BCE5774BA3C675C4E4,30
B5395F8C2077B59B3D6C5719C0CA0339,582
037DAC225F0C1E54657770CD201CDDA7,58
75C00378B3BA26B12559020A83A74355,90
5C3E52036EA54498B6E571A50A45ABFD,5
14DE6B1CDA3BFD44679C7E9382644AC7,70
387B532B7AF7A362DBF783E34C05BF54,422
CA04708DA02378999ECB402481FF1AE4,163
B8984A29BE4798F85EA15F483E37877E,4
3E93326F1DF43AF5F27987897F2BB819,30
C576922AC96E60240D148752D36BF34C,1
A66F392F752B3A59F2644F4158644FF1,14
0289ACB4026B0C28A9FF7BF2560E2A7F,16
096C23E69254818F7EE03C1239005F2B,39
6E94F41FB1EB000C00CEAF43CF70938F,28
437E1E4F1A7DF0CC995FCE10EAC96350,15
F4CB0B30E0A170AEB6A94EF1156738C8,242
751B06814F2E7EFE53CF17EA6A435B58,83
7CB4F979C9025D90BBBA34B3F3BF80C4,34
6D32B47F6F516304209375F1D0CCE5A3,3
13AC12EF4C6A0EAF72795F720752AD98,394
AC5BB8A4162F0D60D28B10AB440DBC26,31
A0616D4E494DC3BCCB94B8B6E5B48380,244
03948FE68D30FD7BD6B46D1993062581,33
14FC1A25D55E89AC7ECD600CD3A08C13,305
25E47FA1836137C0429FABD59B15C11D,90
8D9D62A4402581BB1181D3AA73AD54E8,15
2B90CE94C6039DF03E72FE15B5320ABA,61
26FACA90F8AA62D614E65FD30CD978AB,21
6D6EB70E837A5007BE550C44FF276440,49
96161BF2E55C7E32ED5F411432875ECB,15
5FC0AF35EF724F7BBB10833E2281EB18,41
6C333017CEA199B69BB27611BA5DE7B5,27
4A986ED62BA3188AF4EF8217DB3F2776,34
B3A9A38A561B3648D280614B8E2D8E07,38
6722ACD286AC0F5CA22E745302CAEB89,13
5ACD59093D1C49F2EADAE29D7181A9CF,1
3B4A6FCA6DCB4C2749409DC4188A306E,1585
841727B396264112EC75FEB26C57E25C,194
33E5EA9FE1E29AC3127D975A5494213D,51
C3DDDD01BC219197FCB862218F7DC494,72
DA4F13B8835C8DF20ADF1C21E060E4B7,1
396CD60DADAB9CBA7DDCAF239B477135,1
7ED4165854463C38F1D739A2014001D9,24
7AB9D5F7D122A38CA8769C9C93F3A12F,131
F3C9D7235C2A60FBFBDE1F2EEFBA8B2B,3
5BB701762E3D47A7D00680C9C76FC5B8,12
FEDC59699D8832A11B88BFCCCAD0951D,19
C7DD86F06FD4AA8A0967E27E20750FCD,108
F4634EFF4D9470DCA00051E3304B81AF,28
CA51DAF1373B5C2A16C174AFBD2132A4,15
B8937995A71BAC9FD139C56F0CA68A73,3
8B8CA0D1ACB551E3A654AD05FC0F2CE2,16
635808C1DDFBC662DC3015097E26E62A,40
5A66BC427F25EFFDFEDED4A07D8F9F91,32
2902E47E243769C20EEFACE79EB4ECB3,3
B9A395E297106E5D6F72747F84AC7AE5,11
89427602D4335C85A7205E64B3347655,36
5469339F9A77954EF02C1A807D6AFE66,17
667A8D0FDB2FA1BA819DAB6C0F5C7BC4,26
D771048ADB1B9CACADFE001E6F9BA799,292
E5A2CB7A471E740E758BE5E2E0C79BC2,41
F9E25D9E79A408331969D9ED06679184,169
C945C989CF380E22E1B1E4B28E26801A,11
7A85F2041ECC509DEDAD05C9C09125FA,678
690730C8110E9A41E7C247A8AE212BFA,27
AD7DEB9BF9C9B17C60B69DA2B3B6C59A,88
372D9BB5088C4E9000C65B06459B403A,14
5DA9B900E7C9F71714FB1AE9DA631C83,58
EF7772819E807EDBD8DB0F0B5210030E,23
7E38A396789F21724DDEFB0400305685,179
2684EA4DDB1F988E3C979AB15CFF601F,72
9373B5D36107012F6F9137090C523FA1,12
6F90140F6B66544AAF9181C740122566,13
2AAC37325749A1E1CB4D43A48BACA2C9,51
81BFFE61CAB181676917D75F1B617CB2,37
F4F4EAE9439622EA3CA9489A52E7230F,26
D79D77E3F2698B89279D7C35AB034992,161
3E336ECE1F533064D663A350DAB00790,289
B7BA9E1AB4945183AEB5B58AA1FEB91F,7
5E9BF00B469B284E028094EA15A9F1FE,26
301AFECE7DEEE17ACC059F6C18017D80,20
E6E7FC8AC6D32935DA5ADCFFD14CC3A8,7
0D17D0247F158FA3E40D21EFF46D1651,165
D99BC96AD021DD4BC255489C45083668,9
75C0C246DE2188E02D984C2E71B7B4C0,14
869CD665A9D52E3398754C8DACF4426D,233
F4A3B9F9F0D4555ADC48F7BCBD5BEE9C,131
AFA25B217428A5328ECE8D2C4C583916,10
624E70EBAEC11C05B5235EE1A7989D7A,25
EEBCB25D5F056CCF59DDE654388ACD2B,61
34ADF71F1AADCA26EC8008496F7CC87E,164
A5BEE3FC4D5248D2B2C655F6B7C1E5A3,15
45116F98E0EE54636FE629BA54228131,18
DF67650EB85A06BB0B00BA7CABFD7647,13
8D0EAD73C85E48D958042757FEBB37BC,70
018F03084C88E944163F76A0D0C2FBA1,257
End Exploring Related Columns
Task: Could you please help me get the weekly customer retention rate in September 2018 for new customers who first used our app within the first week starting from September 1st, 2018 (timezone in Shanghai)? The retention rates should cover the following 3-week period after the initial use and display them in column format.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: Sure! Here's the weekly customer retention rate format for new customers who first used the app within the first week starting from September 1st, 2018 (Shanghai time). The retention rates cover the following 3-week period after the initial use:

```csv
Week,Retention_Rate
Week 1,value1:0<=float<=100
Week 2,value2:0<=float<=100
Week 3,value3:0<=float<=100
```

**Explanation:**

- **Week**: Represents each week following the users' initial usage week.
  - **Week 1**: September 8 - September 14, 2018
  - **Week 2**: September 15 - September 21, 2018
  - **Week 3**: September 22 - September 28, 2018
- **Retention_Rate**: The percentage of users from the initial cohort who returned to use the app during that week. The values range from 0 to 100 and do not include the '%' symbol.

**How to Calculate:**

1. **Identify the Cohort**: Select all users who first used the app between **September 1 - September 7, 2018**.
2. **Track Weekly Usage**: For each subsequent week (Weeks 1 to 3), determine which users from the cohort returned to the app.
3. **Calculate Retention Rates**:
   - **Retention Rate (%)** = (Number of Returning Users in the Week ÷ Total Number of Users in Cohort) × 100
   - Repeat this calculation for each week to get the weekly retention rates.

This format will help you display the retention rates clearly for analysis..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-24 05:05:42 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 05:05:42 - root - INFO - Sure! Here's the SQL query to calculate the weekly customer retention rate for new customers who first used the app within the first week starting from September 1st, 2018 (Shanghai time). The retention rates cover the following 3-week period after the initial use:

```sql
WITH cohort AS (
  SELECT DISTINCT "user_pseudo_id"
  FROM (
    SELECT "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180902"
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180903"
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180904"
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180905"
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180906"
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180907"
  ) AS temp
  WHERE "user_first_touch_timestamp" BETWEEN 1535731200000000 AND 1536335999000000
),
events AS (
  SELECT
    "user_pseudo_id",
    CASE
      WHEN TO_DATE("event_date", 'YYYYMMDD') BETWEEN '2018-09-08'::DATE AND '2018-09-14'::DATE THEN 'Week 1'
      WHEN TO_DATE("event_date", 'YYYYMMDD') BETWEEN '2018-09-15'::DATE AND '2018-09-21'::DATE THEN 'Week 2'
      WHEN TO_DATE("event_date", 'YYYYMMDD') BETWEEN '2018-09-22'::DATE AND '2018-09-28'::DATE THEN 'Week 3'
      ELSE NULL
    END AS "Week"
  FROM (
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180908"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180909"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180910"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180911"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180912"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180913"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180914"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180916"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180917"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180918"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180919"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180920"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180921"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180922"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180923"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180924"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180925"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180926"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180927"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180928"
  ) AS temp
  WHERE "user_pseudo_id" IN (SELECT "user_pseudo_id" FROM cohort)
)
SELECT
  "Week",
  ROUND(COUNT(DISTINCT "user_pseudo_id") * 100.0 / (SELECT COUNT(*) FROM cohort), 2) AS "Retention_Rate"
FROM events
WHERE "Week" IS NOT NULL
GROUP BY "Week"
ORDER BY "Week";
```

**Explanation:**

- **Cohort Identification**:
  - The `cohort` CTE selects all unique `user_pseudo_id` values for users who first used the app between **September 1 - September 7, 2018**. The timestamps are adjusted for Shanghai time and converted to microseconds since the Unix epoch.
  - The `user_first_touch_timestamp` is filtered between `1535731200000000` and `1536335999000000`, corresponding to the specified date range in Shanghai time.

- **Event Collection and Week Assignment**:
  - The `events` CTE collects all events from **September 8 - September 28, 2018** for users in the cohort.
  - It assigns a `Week` label to each event based on its `event_date`:
    - **Week 1**: September 8 - September 14, 2018
    - **Week 2**: September 15 - September 21, 2018
    - **Week 3**: September 22 - September 28, 2018
  - Only events where `Week` is not `NULL` are considered.

- **Retention Rate Calculation**:
  - The final `SELECT` statement calculates the retention rate for each week:
    - It counts the distinct `user_pseudo_id` for each `Week`.
    - Divides by the total number of users in the cohort.
    - Multiplies by 100 to get a percentage.
    - Rounds the result to two decimal places for clarity.
  - The results are ordered by `Week` for presentation.

**Result Format**:

The query will return results in the following format:

```csv
Week,Retention_Rate
Week 1,value1
Week 2,value2
Week 3,value3
```

- **Week**: Indicates the week number after the initial cohort week.
- **Retention_Rate**: The percentage of users from the initial cohort who returned during that week, ranging from 0 to 100.

This SQL query will provide the weekly customer retention rates as requested, using the Snowflake SQL dialect and adhering to the specified formatting and data considerations.
2025-01-24 05:05:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:05:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:05:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:05:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-24 05:05:44 - snowflake.connector.connection - INFO - closed
2025-01-24 05:05:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:05:44 - root - INFO - itercount: 1
2025-01-24 05:05:44 - root - INFO - 0
2025-01-24 05:05:44 - root - INFO - results: 
Week,Retention_Rate
Week 1,20.05
Week 2,10.54
Week 3,6.94


2025-01-24 05:05:44 - root - INFO - Please check the answer again by reviewing Could you please help me get the weekly customer retention rate in September 2018 for new customers who first used our app within the first week starting from September 1st, 2018 (timezone in Shanghai)? The retention rates should cover the following 3-week period after the initial use and display them in column format., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: Sure! Here's the weekly customer retention rate format for new customers who first used the app within the first week starting from September 1st, 2018 (Shanghai time). The retention rates cover the following 3-week period after the initial use:

```csv
Week,Retention_Rate
Week 1,value1:0<=float<=100
Week 2,value2:0<=float<=100
Week 3,value3:0<=float<=100
```

**Explanation:**

- **Week**: Represents each week following the users' initial usage week.
  - **Week 1**: September 8 - September 14, 2018
  - **Week 2**: September 15 - September 21, 2018
  - **Week 3**: September 22 - September 28, 2018
- **Retention_Rate**: The percentage of users from the initial cohort who returned to use the app during that week. The values range from 0 to 100 and do not include the '%' symbol.

**How to Calculate:**

1. **Identify the Cohort**: Select all users who first used the app between **September 1 - September 7, 2018**.
2. **Track Weekly Usage**: For each subsequent week (Weeks 1 to 3), determine which users from the cohort returned to the app.
3. **Calculate Retention Rates**:
   - **Retention Rate (%)** = (Number of Returning Users in the Week ÷ Total Number of Users in Cohort) × 100
   - Repeat this calculation for each week to get the weekly retention rates.

This format will help you display the retention rates clearly for analysis. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Week,Retention_Rate
Week 1,20.05
Week 2,10.54
Week 3,6.94
Current sql:
WITH cohort AS (
  SELECT DISTINCT "user_pseudo_id"
  FROM (
    SELECT "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180902"
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180903"
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180904"
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180905"
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180906"
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180907"
  ) AS temp
  WHERE "user_first_touch_timestamp" BETWEEN 1535731200000000 AND 1536335999000000
),
events AS (
  SELECT
    "user_pseudo_id",
    CASE
      WHEN TO_DATE("event_date", 'YYYYMMDD') BETWEEN '2018-09-08'::DATE AND '2018-09-14'::DATE THEN 'Week 1'
      WHEN TO_DATE("event_date", 'YYYYMMDD') BETWEEN '2018-09-15'::DATE AND '2018-09-21'::DATE THEN 'Week 2'
      WHEN TO_DATE("event_date", 'YYYYMMDD') BETWEEN '2018-09-22'::DATE AND '2018-09-28'::DATE THEN 'Week 3'
      ELSE NULL
    END AS "Week"
  FROM (
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180908"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180909"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180910"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180911"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180912"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180913"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180914"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180916"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180917"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180918"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180919"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180920"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180921"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180922"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180923"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180924"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180925"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180926"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180927"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180928"
  ) AS temp
  WHERE "user_pseudo_id" IN (SELECT "user_pseudo_id" FROM cohort)
)
SELECT
  "Week",
  ROUND(COUNT(DISTINCT "user_pseudo_id") * 100.0 / (SELECT COUNT(*) FROM cohort), 2) AS "Retention_Rate"
FROM events
WHERE "Week" IS NOT NULL
GROUP BY "Week"
ORDER BY "Week";
2025-01-24 05:06:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 05:06:22 - root - INFO - Sure! Here's the SQL query to calculate the weekly customer retention rate, keeping all decimals to four decimal places:

```sql
WITH cohort AS (
  SELECT DISTINCT "user_pseudo_id"
  FROM (
    SELECT "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180901"
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180902"
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180903"
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180904"
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180905"
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180906"
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180907"
  ) AS temp
  WHERE "user_first_touch_timestamp" BETWEEN 1535731200000000 AND 1536335999000000
),
events AS (
  SELECT
    "user_pseudo_id",
    CASE
      WHEN TO_DATE("event_date", 'YYYYMMDD') BETWEEN '2018-09-08'::DATE AND '2018-09-14'::DATE THEN 'Week 1'
      WHEN TO_DATE("event_date", 'YYYYMMDD') BETWEEN '2018-09-15'::DATE AND '2018-09-21'::DATE THEN 'Week 2'
      WHEN TO_DATE("event_date", 'YYYYMMDD') BETWEEN '2018-09-22'::DATE AND '2018-09-28'::DATE THEN 'Week 3'
      ELSE NULL
    END AS "Week"
  FROM (
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180908"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180909"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180910"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180911"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180912"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180913"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180914"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180915"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180916"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180917"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180918"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180919"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180920"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180921"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180922"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180923"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180924"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180925"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180926"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180927"
    UNION ALL
    SELECT "user_pseudo_id", "event_date" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180928"
  ) AS temp
  WHERE "user_pseudo_id" IN (SELECT "user_pseudo_id" FROM cohort)
)
SELECT
  "Week",
  ROUND(COUNT(DISTINCT "user_pseudo_id") * 100.0 / (SELECT COUNT(*) FROM cohort), 4) AS "Retention_Rate"
FROM events
WHERE "Week" IS NOT NULL
GROUP BY "Week"
ORDER BY "Week";
```
2025-01-24 05:06:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:06:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:06:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:06:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-24 05:06:25 - snowflake.connector.connection - INFO - closed
2025-01-24 05:06:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:06:25 - root - INFO - itercount: 2
2025-01-24 05:06:25 - root - INFO - 0
2025-01-24 05:06:25 - root - INFO - Total iteration counts: 2
