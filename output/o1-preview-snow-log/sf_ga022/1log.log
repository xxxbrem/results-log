2025-01-24 05:01:02 - openai._base_client - INFO - Retrying request to /chat/completions in 0.442909 seconds
2025-01-24 05:02:12 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 05:02:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:02:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:02:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:02:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 05:02:13 - snowflake.connector.connection - INFO - closed
2025-01-24 05:02:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:02:13 - root - INFO - SQL:
SELECT DISTINCT "event_date"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   LIMIT 100;
Results:
event_date
20180901

2025-01-24 05:02:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:02:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:02:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:02:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 05:02:15 - snowflake.connector.connection - INFO - closed
2025-01-24 05:02:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:02:15 - root - INFO - SQL:
SELECT "user_pseudo_id", "user_first_touch_timestamp"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   LIMIT 100;
Results:
Too long, hard cut:
user_pseudo_id,user_first_touch_timestamp
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B

2025-01-24 05:02:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:02:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:02:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:02:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 74
2025-01-24 05:02:16 - snowflake.connector.connection - INFO - closed
2025-01-24 05:02:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:02:17 - root - INFO - SQL:
SELECT DISTINCT "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "user_first_touch_timestamp" >= 1535731200000000
     AND "user_first_touch_timestamp" < 1536336000000000
   LIMIT 100;
Results:
user_pseudo_id
34CAF47105A2D9D0AC7464BB3AF8DB2A
14FC1A25D55E89AC7ECD600CD3A08C13
34ADF71F1AADCA26EC8008496F7CC87E
C7DD86F06FD4AA8A0967E27E20750FCD
4EEE67C2E335213F6815144829801E0F
4A2A03B50BDA6AC1687703BD39A91E3E
6D6EB70E837A5007BE550C44FF276440
A2D0AAFA35E66B8372DDAD76450A82FF
F4CB0B30E0A170AEB6A94EF1156738C8
EA89F979E0D4C374DBC95268982D18DE
7FA778C27A7CD840454FC893B8200200
108522345C425B9AEB5F83FE07C1A3A4
97D9D96077AD3E8859BF5C54C873E59D
5A66BC427F25EFFDFEDED4A07D8F9F91
37EFBD2BA398148336F96B4347392A8D
37034A23CAFF85394E2E349C381788A6
387B532B7AF7A362DBF783E34C05BF54
1E882F0B9818614D6E47620DD31229F1
CEBA063FD7BF190D727CC948185CCEC8
D771048ADB1B9CACADFE001E6F9BA799
7AB9D5F7D122A38CA8769C9C93F3A12F
D6803CFD38D435F0364EB47684F7CCF6
3B049329E3090DA7A4339C4A46EF0763
B9D800D33FDCF7AF2157CB66910A0797
9E25C5FED0F3F775FBB2A5C76DD0511C
AD7DEB9BF9C9B17C60B69DA2B3B6C59A
879503A3ED5F2DCB6592E99C42E1BDFE
2B6D9C77F287F5C021EC7297203D412B
DAD134C77F7E09BC552E290534CB90E8
A5302213F1605BE400E8AA34992B18A8
6C333017CEA199B69BB27611BA5DE7B5
9FD6E2CD74490F5DA5F52D249CBB750A
0E9150E8985138A744B88D56F015EDA7
ACA2E31E67D50F779611D7FDB674C370
D8B8615DDE319FEBE0A2AC1364E2C2EC
D2007D608FBB90EF5363BF5C8E08117A
0DCD6B00CAB93941AA5EB18DE8C053EE
D963E509346C0E5358ECFE56AF3BB2ED
96333A5A97DA9F4AEBC7A70483AF6C5C
B9A395E297106E5D6F72747F84AC7AE5
531E7B35DE9A21A1942F057C98B4E74C
E6E7FC8AC6D32935DA5ADCFFD14CC3A8
D8B77A575B5308D161F95ACF515F9772
C945C989CF380E22E1B1E4B28E26801A
8B7110AC0A6E048628AB4BCC751E0A09
7331597E5500811253BA85AF851A193C
177C0BEFFC69408F88D3377632F1BB60
551B893D34A2A59971B8FF185C1CD0C8
0FDAC2A4A154F9E946D749BFE67B1FCD
9F8885F0261FE69A58C8B6AE9176E437
A305B55D5049F38F5139DA95B3DCE247
ADB20527463A407E77162C54D30435F1
8BB6E580D7771BBBE04D3953EA43F640
B50E2B0888440679A84A3D861332531C
B1885B70DEFAC440D7DCBB520854A651
66788E34B6E292DE03B1B54E797CADBF
2C45FDF91F91AE8A3A9E6F119E8BED13
FCD8DDE7775A7211BCA9F42768C3BB8B
61BB31EC7781341B1D7B8D8A85688DA3
D1C57A2E87382A82A40B1816E85277EA
3E336ECE1F533064D663A350DAB00790
CCE5E30054C510608589FA6240615B0A
D31F0611DE6B94A5F001584286883AB7
2C15FFDEDDA69390B7A8EB5808FB7ED6
C09F65F2853D03DE23CFD90F97429735
5DA9B900E7C9F71714FB1AE9DA631C83
E0F1ED4167D0C0B2D6DCBA85CB020F52
B82793CB1270A48BB2697C51AEED3E4A
8DEB6CB6C3E85D0032D8557C73ADD49F
A6E8B0AC5E066F7670116136442F728F
B0D104EE63ABB85675B078664B5924A8
27C0BAADCE9520F17249A8B85F6477DA
0CBC523581751D977C4121B95429E8A9
1D5A0DC978A69FF28EC9D153F32EA871

2025-01-24 05:02:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:02:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:02:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:02:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-24 05:02:18 - snowflake.connector.connection - INFO - closed
2025-01-24 05:02:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:02:19 - root - INFO - SQL:
SELECT DISTINCT "platform"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   LIMIT 100;
Results:
platform
ANDROID
IOS

2025-01-24 05:02:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:02:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:02:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:02:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 31
2025-01-24 05:02:20 - snowflake.connector.connection - INFO - closed
2025-01-24 05:02:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:02:20 - root - INFO - SQL:
SELECT "event_name", COUNT(*) AS "event_count"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   GROUP BY "event_name"
   ORDER BY "event_count" DESC
   LIMIT 100;
Results:
event_name,event_count
screen_view,20445
user_engagement,11536
level_start_quickplay,4078
level_end_quickplay,2700
post_score,2085
level_complete_quickplay,1647
level_fail_quickplay,1053
level_reset_quickplay,1044
select_content,925
level_start,921
level_end,613
session_start,579
level_retry,509
level_up,438
level_complete,438
level_retry_quickplay,178
level_fail,175
level_reset,137
spend_virtual_currency,98
use_extra_steps,95
first_open,64
firebase_campaign,54
app_remove,44
completed_5_levels,25
os_update,25
error,24
app_exception,24
no_more_extra_steps,20
ad_reward,12
app_update,9
challenge_a_friend,5

2025-01-24 05:02:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:02:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:02:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:02:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 05:02:22 - snowflake.connector.connection - INFO - closed
2025-01-24 05:02:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:02:22 - root - INFO - SQL:
SELECT f.VALUE::VARIANT
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t,
        LATERAL FLATTEN(input => t."event_params") f
   LIMIT 100;
Results:
Too long, hard cut:
F.VALUE::VARIANT
"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 121566607420435696
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 5585962841668417286
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""MainMenuActivity""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FloodItActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417306
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 5585962841668417306
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417307
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""FloodItActivity""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 5585962841668417307
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 121566607420435695
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 121566607420435696
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""MainMenuActivity""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""MainMenuActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417286
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""MainMenuActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 121566607420435695
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417307
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""content_type"",
  ""value"": {
    ""string_value"": ""mode""
  }
}"
"{
  ""key"": ""item_id"",
  ""value"": {
    ""string_value"": ""quickplay""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""engagement_time_msec"",
  ""value"": {
    ""int_value"": 4945
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417307
  }
}"
"{
  ""key

2025-01-24 05:02:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:02:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:02:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:02:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 05:02:24 - snowflake.connector.connection - INFO - closed
2025-01-24 05:02:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:02:24 - root - INFO - SQL:
SELECT t."user_pseudo_id", f.KEY, f.VALUE::VARIANT
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t,
        LATERAL FLATTEN(input => t."user_properties") f
   LIMIT 100;
Results:
Too long, hard cut:
user_pseudo_id,KEY,F.VALUE::VARIANT
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464484747233000,
    ""string_value"": ""3""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464527606769000,
    ""string_value"": ""true""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1535867175448000,
    ""string_value"": ""30""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1465413020916000,
    ""string_value"": ""856338239819935514""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1524118000433000,
    ""string_value"": ""0""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1509095669887000,
    ""string_value"": ""true""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1532903928606000,
    ""string_value"": ""0""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464484794147000,
    ""set_timestamp_micros"": 1464484747147000
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1488642763867000,
    ""string_value"": ""2""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464484724233000,
    ""string_value"": ""3""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464527583769000,
    ""string_value"": ""true""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1535849095055000,
    ""string_value"": ""30""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1465412997916000,
    ""string_value"": ""856338239819935514""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1524117977433000,
    ""string_value"": ""0""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1509095646887000,
    ""string_value"": ""true""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1532903905606000,
    ""string_value"": ""0""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464484794147000,
    ""set_timestamp_micros"": 1464484724147000
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1488642740867000,
    ""string_value"": ""2""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464484791233000,
    ""string_value"": ""3""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464527650769000,
    ""string_value"": ""true""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1535849162055000,
    ""string_value"": ""30""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1465413064916000,
    ""string_value"": ""856338239819935514""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1524118044433000,
    ""string_value"": ""0""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1509095713887000,
    ""string_value"": ""true""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1532903972606000,
    ""string_value"": ""0""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464484794147000,
    ""set_timestamp_micros"": 1464484791147000
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1488642807867000,
    ""string_value"": ""2""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464484778233000,
    ""string_value"": ""3""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464527637769000,
    "

2025-01-24 05:02:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:02:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:02:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:02:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 05:02:25 - snowflake.connector.connection - INFO - closed
2025-01-24 05:02:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:02:26 - root - INFO - SQL:
SELECT "user_pseudo_id", COUNT(*) AS "event_count"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   GROUP BY "user_pseudo_id"
   ORDER BY "event_count" DESC
   LIMIT 100;
Results:
user_pseudo_id,event_count
8F6C5F7611B67A4A437FF283B6C10181,2406
3875A92B5F5C2BBA1355CED06A986079,2372
3B4A6FCA6DCB4C2749409DC4188A306E,1585
57EC50FBC6C7277B8EDCCE44C1352BD4,1119
E0664E9E7883956A6E3084FD68AA274B,1040
3DEB0C12C49AD19D7ACE68FA59E7ACD6,1035
724B99CB6F41846F3F6BB46C2F663F5E,827
B63075B53A750A67A12F7F19ED5AA835,769
2F74E23BEA1E45E3897274EE4903DCC5,747
7A85F2041ECC509DEDAD05C9C09125FA,678
7E74A2BB6BBF4746DEE15F957B315401,614
A976A39B8E08829A5BC5CD3827C942A2,604
498C5BB583F33EFA29DE4783D40330FF,596
9FF3330617722CBCB12644B02BFC5EF5,594
34CAF47105A2D9D0AC7464BB3AF8DB2A,591
B5395F8C2077B59B3D6C5719C0CA0339,582
5E09265F12D64B9FA85FF9427A0A7FB0,582
05FB3382D94C7E963B408FD6CC357D33,550
DABC5234774C4E18EF0B59DE32DEFD2D,513
DC14701AE5C2808151BE7008898B13B8,511
2DB65B29C41328FF8AB9AC27B7C05537,511
472451071AED6FF801BC0FE66706FD27,487
10B0D468B5E036E16D13DB53A65F2D49,445
CCE5E30054C510608589FA6240615B0A,442
387B532B7AF7A362DBF783E34C05BF54,422
959635567E419A061EECCCA478EDC718,394
13AC12EF4C6A0EAF72795F720752AD98,394
625CF86657E00A4629BCE49F5B31A144,354
74375465CD17299EBC7C75A1B4047EE0,349
86F19DAB73E484FB7DD2F805DDD7957D,336
4EF964D59282E5A2C8692D30F011256B,336
EA35FE295A7C1F8F67836AEB608CEBBD,331
6202381695390EB9E0F6CC22E9E55443,313
14FC1A25D55E89AC7ECD600CD3A08C13,305
879503A3ED5F2DCB6592E99C42E1BDFE,303
D771048ADB1B9CACADFE001E6F9BA799,292
3E336ECE1F533064D663A350DAB00790,289
EA89F979E0D4C374DBC95268982D18DE,288
56B9CBB6CB58106DCCF3CAD660232CB2,276
27C88E1533471126F779ADE591D7915D,272
EBFE0623EF1109A89B392B9DF4375951,271
018F03084C88E944163F76A0D0C2FBA1,257
4BDC831A6940071E2461D0B5293A329E,254
7EB0099C021CF1B2C0688CB1C9D42ED0,245
A0616D4E494DC3BCCB94B8B6E5B48380,244
F4CB0B30E0A170AEB6A94EF1156738C8,242
DF0E6C6C5E4F3F34FEC6EE54FD945B05,238
0CAAA1B6F161BA4D363EB7A2DEF64A08,236
7331597E5500811253BA85AF851A193C,234
F3C82C9DB04064BA7965BBBD95864189,233
869CD665A9D52E3398754C8DACF4426D,233
67D3D76504CC5C4CBFC78EE4FC397C8B,233
977CBDF2D7B65AC0FDC885F87117A7F2,219
EFB696A82D093B3AFBE92FF526DD5CEA,219
48AB910A8DE8485D4C34238EA61F782C,218
487DE902636DD8A9844A2D61FE7BD568,217
9FD6E2CD74490F5DA5F52D249CBB750A,216
EF500E0CF578004836D1D38C8901862B,212
D6803CFD38D435F0364EB47684F7CCF6,210
DFDE5425237185986327A054407A09B4,209
D31F0611DE6B94A5F001584286883AB7,208
ACA2E31E67D50F779611D7FDB674C370,206
93CE02A528E41C078FDB04857CCDA48C,202
FCD8DDE7775A7211BCA9F42768C3BB8B,200
E80C958E3C33898989A30B8F5A4514F0,199
3B049329E3090DA7A4339C4A46EF0763,199
B8FE9AD137A133A89389656F7989B36C,197
841727B396264112EC75FEB26C57E25C,194
D7EA8E3645EFFBD6443946179ED704A6,191
FA30269453141794E79B8F15EE0BA5B9,189
2F2B5C88B72A5253AAF448B1E29333F5,180
7E38A396789F21724DDEFB0400305685,179
BA3E7A5857FD7BE68F02E4D2F5744BE8,177
D1C57A2E87382A82A40B1816E85277EA,177
6BEB06D064B7393657B25234BFF14E1D,176
5ACF1A6BFE350F7BB661BF389AF7E2F0,175
37034A23CAFF85394E2E349C381788A6,173
F9E25D9E79A408331969D9ED06679184,169
465B5DC1BA69633FE49EFA52F08CBB40,168
0D17D0247F158FA3E40D21EFF46D1651,165
34ADF71F1AADCA26EC8008496F7CC87E,164
7A8D1CAA45CDE7652260DA6E71068A13,164
F1555004E0D95599AF2F2B8EA130A9C3,164
F5DAD8DD17B689CF672D65A0A81CF4AC,163
CA04708DA02378999ECB402481FF1AE4,163
D79D77E3F2698B89279D7C35AB034992,161
EF0FBB41BE6F40A5CC1D68D8E1CD3591,157
4EEE67C2E335213F6815144829801E0F,153
377303AA2F5C5C80E5AAAD26C029BD5A,152
53866E32BA0ABFD846772D4B7B9B5921,152
FF20E4EE129C3700FC1C6CEF188E17BB,151
6E40E63C836A0C058685C1F69CFE1701,147
2B6D9C77F287F5C021EC7297203D412B,140
C028D1BCE3EE4626D117DF55D6A617B8,140
1AB36A765847D90D7F029C21FADFB3F4,135
77F125B832C748232EDA6AF8C7D08ED1,134
7AB9D5F7D122A38CA8769C9C93F3A12F,131
F4A3B9F9F0D4555ADC48F7BCBD5BEE9C,131
DB9D0368B6DC1CD2E03CDDBE7060DE31,131
17636078D57884AD7EA5406C60E2BD10,127

2025-01-24 05:02:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:02:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:02:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:02:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-24 05:02:27 - snowflake.connector.connection - INFO - closed
2025-01-24 05:02:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:03:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 05:03:37 - root - INFO - ```sql
SELECT DISTINCT "user_pseudo_id"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
LIMIT 100;
```
2025-01-24 05:03:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:03:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:03:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:03:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 05:03:38 - snowflake.connector.connection - INFO - closed
2025-01-24 05:03:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:03:59 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 05:03:59 - root - INFO - SQL:
SELECT DISTINCT "user_pseudo_id"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
LIMIT 100;
Results:
user_pseudo_id
9F7B0D1BFB822F5E26E91E184E2E437C
0AF67C1A1C8F3785609B4210C3E04FC8
102CC7D8CD5D3E861EACE1BAB97E61EC
A976A39B8E08829A5BC5CD3827C942A2
22DF34962481295121082D8C105EB436
B8FE9AD137A133A89389656F7989B36C
4E6F4A73B5D05B33DC73B11547E39004
6D32B47F6F516304209375F1D0CCE5A3
4B6BD3964DB295D02E54E59927ED73A0
B607C1DF4606F29FD7FA56A6D4DACFAC
487DE902636DD8A9844A2D61FE7BD568
690DA199396D35B845005CCD13ED8D67
9DB70702AD6350C1150E2AD452047208
14DE6B1CDA3BFD44679C7E9382644AC7
58230465C695B0FDDDAE08A481FAEECC
F26EC6056E284FDDEA7771F203B6BB8F
4BB019F8F6D1FE7BA78CA42A4698EF56
B0153FFD55333D4C4B546EC5B3FAC70E
945DE7C965AFB12E35C3C992CF9847E2
E30E8756808AB219B28276F129C51552
B2D359D114428D8DD085DFAFF11195CE
841727B396264112EC75FEB26C57E25C
7E74A2BB6BBF4746DEE15F957B315401
17636078D57884AD7EA5406C60E2BD10
2F2B5C88B72A5253AAF448B1E29333F5
39BE7CAB9B8602ABD10A1BFB4E66BBB2
5C5A0787542CD24F1E19F9EB778BA766
9DE7361ACCDEA6541AD5EA55D59B1C78
5ACF1A6BFE350F7BB661BF389AF7E2F0
3A73CDE17520867FB9C03E491F778B60
D2057EE2B8E8563B522E6C21B7BD4524
706C748E6D1E0768BFEFE6362B5D3F67
9FF3330617722CBCB12644B02BFC5EF5
B8984A29BE4798F85EA15F483E37877E
48AB910A8DE8485D4C34238EA61F782C
0579CD8B9F2F5C48A5F1ACECF88750A7
571B1FB7D9D44445BF25B75F0FD91660
1AB36A765847D90D7F029C21FADFB3F4
34CAF47105A2D9D0AC7464BB3AF8DB2A
6722ACD286AC0F5CA22E745302CAEB89
9A46DD24A6F7AD154E9143AA2D588310
DDDF330206C8FD63B6C78C3BFB13F801
192440EC48EB5C30C261D16F03D7D229
34ADF71F1AADCA26EC8008496F7CC87E
03948FE68D30FD7BD6B46D1993062581
8065F8E98407106A65D35195984B2258
31E8B3EB3D9167E813FDFB812898F2F6
FF20E4EE129C3700FC1C6CEF188E17BB
59454BAC415BB1F18517C6FD2C023E49
6C14B6297FCC1782508E14996A4DBB7C
EBFE0623EF1109A89B392B9DF4375951
D99BC96AD021DD4BC255489C45083668
FB88784404E4864870E5DABC75F2C70B
6A5F60408CAFD78C48447547A30BA926
5C3E52036EA54498B6E571A50A45ABFD
4A2A03B50BDA6AC1687703BD39A91E3E
B081E087ABDC8FE6FB390ACF48CD61D8
40E48F9F86A546EF73EDE7855625E2B2
F3917138A3D4B03ADA1C2E77E3B84649
3883FF0DFAB40ECD4EA781FC0D1CE18A
26FACA90F8AA62D614E65FD30CD978AB
57EC50FBC6C7277B8EDCCE44C1352BD4
E8124E2C2D99AB999ADC3CA7D481242E
186F51E5AACB37852E3650E7027E33B1
4D084D38156128AAA060303AA91E689D
8D0EAD73C85E48D958042757FEBB37BC
C66BF8A9ACA5CD56597E18B0729181C4
FA30269453141794E79B8F15EE0BA5B9
0A26E7281EC31038AD42F28C930FFF90
A7722F61A84758A6CAE3E2C03B9EF742
AC14799A5E8C340D6CADCBAE72037D81
7ED4165854463C38F1D739A2014001D9
A064A84CD3CF7058F39333D6212E8615
47EF903C26610B033B8734C8159B2ECA
9AAAE2A96BA29B283C25AA62182ECA9D
14FC1A25D55E89AC7ECD600CD3A08C13
C679FF00E17790E7E16AB903212EE05C
1B959D672ABAE4A3BFB9D720D415E064
93CE02A528E41C078FDB04857CCDA48C
D5F9D9AF22EF5073E10342973D48FB2C
3DC1C89C927D2FC9D264FBC21E401E5B
037DAC225F0C1E54657770CD201CDDA7
59BE43F3FE7AB3F91B016B56508D4C46
C7DD86F06FD4AA8A0967E27E20750FCD
FEDC59699D8832A11B88BFCCCAD0951D
D7EA8E3645EFFBD6443946179ED704A6
7A85F2041ECC509DEDAD05C9C09125FA
DC14701AE5C2808151BE7008898B13B8
3F4C49B7D999DB0D286AA09BED5C04A9
BF709EB51D61C3A7BF68C4CFD7F236BE
E4196C5E0A92A22F69DE4E3AA288D6EE
E80C958E3C33898989A30B8F5A4514F0
13AC12EF4C6A0EAF72795F720752AD98
5C5D78DD8E3D3B7FFC9118D4511E76BF
D3F06F9B7BD9D7FC8758BF78BF0705E9
4EEE67C2E335213F6815144829801E0F
DEADCFB9776A98526FE128254F93C278
8A512E5089AFA1272B677047B6CB7BFE
534D8E69233D917A9A5BC15E3953FEB8
7EB0099C021CF1B2C0688CB1C9D42ED0

2025-01-24 05:03:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:03:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:03:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:04:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 05:04:00 - snowflake.connector.connection - INFO - closed
2025-01-24 05:04:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:04:01 - root - INFO - SQL:
SELECT t."user_pseudo_id", t."device"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t
LIMIT 100
Results:
Too long, hard cut:
user_pseudo_id,device
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-au"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": 28800
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-au"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": 28800
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-au"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": 28800
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-au"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": 28800
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-au"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": 28800
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-au"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": 28800
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-au"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": 28800
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-au"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": 28800
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-au"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": 28800
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-au"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",


2025-01-24 05:04:01 - root - INFO - itercount: 0
2025-01-24 05:04:01 - root - INFO - Database Name: FIREBASE
Schema Name: ANALYTICS_153293282
DDL describes table information.
,0
table_name,EVENTS_20180613
description,
DDL,"create or replace TABLE EVENTS_20180613 (
	""event_date"" VARCHAR(16777216),
	""event_timestamp"" NUMBER(38,0),
	""event_name"" VARCHAR(16777216),
	""event_params"" VARIANT,
	""event_previous_timestamp"" NUMBER(38,0),
	""user_id"" VARCHAR(16777216),
	""user_pseudo_id"" VARCHAR(16777216),
	""user_properties"" VARIANT,
	""user_first_touch_timestamp"" NUMBER(38,0),
	""user_ltv"" VARIANT,
	""device"" VARIANT,
	""geo"" VARIANT,
	""app_info"" VARIANT,
	""traffic_source"" VARIANT,
	""stream_id"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']
External knowledge that might be helpful: 
How to Calculate User Retention in Big Query from Google Demo Game Analytics Data

As a Product / Website Analyst, I was pretty psyched to discover Google’s public Google Analytics 4 (GA4) gaming event dataset called `firebase-public-project.analytics_153293282.events_*`. The table allows experienced developers and learners alike to experiment with raw GA4 data in Big Query for free. Event data is basically a log of user interactions with your product for analysis .For newbies interested in learning more about event data and GA4, visit my prior blog. This article provides SQL queries for a quick table overview and explains how to utilize Google Big Query to calculate user retention.


What is Retention?
User retention rates are key indicators for whether your product team meets user needs. Improving retention is often central to long term growth strategies.

**Retention measure’s how often and for how long users tend to return to your product.**

The metric can be a powerful proxy for product usefulness and user opinion. Its analysis can reveal critical information like how well your site converts new visitors to users and which items and features are associated with users coming back. If user data is available, retention can also help a business understand the profiles of its most active users (power users). Finally, retention is a great guardrail metric for A/B tests. Successful, product oriented companies prioritize a healthy user bases over short term profits.


**Common Retention Calculation Strategies**

Two common strategies to calculate retention are: 

a) N-Day retention

b) Unbounded Retention.


a) For N-Day retention, analysts calculate how many users with certain characteristics return over successive periods. It is called N days because we define the length of each period. For example, with N=7 day retention, if User A becomes part of our cohort of interest on day 0 and returns to the product day 5 and day 15, they are counted as retained for week 1 (1–7 days) and week 3 (15–21 days) but not week 2 (8–14 days).


b) For Unbounded Retention, a user is counted as retained each week so long as their most recent product contact was after the week. For example, if User A becomes part of the cohort on day 0 and last returned to the site on day 21, they will be counted as retained in week 1 (1–7 days), week 2 (8–14 days), and week 3 (15–21 days) but not week 4 (22–28 days).

By calculating these metrics, companies can evaluate how well their products hold users’ interests. It also them closer to identifying the patterns that generate return users.



The table structure information is ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}
Begin Exploring Related Columns
**Relevant Columns and Potential Usage:**

- **"event_date"**: Used to filter events within specific date ranges (e.g., September 2018).
- **"event_timestamp"**: Provides the exact timestamp of the event; can be used for time-based analysis.
- **"event_name"**: Identifies the type of event (e.g., "app_open", "user_engagement"); useful for filtering specific user actions.
- **"user_pseudo_id"**: An anonymized unique identifier for users; essential for tracking user activity across sessions.
- **"user_first_touch_timestamp"**: Timestamp when the user first started using the app; crucial for identifying new users within the specified cohort.
- **"platform"**: Indicates the platform used (e.g., "ANDROID", "IOS"); can be used to segment retention rates by platform.
- **"event_params"**: Contains additional event parameters in JSON format; may hold valuable details about user interactions.
- **"user_properties"**: Contains user attributes in JSON format; useful for enriching user data.

**Conditions That May Be Used:**

- **Date Filtering**: Using "event_date" to select events during September 2018.
- **Timestamp Filtering**: Using "user_first_touch_timestamp" to identify users who first used the app between September 1st and September 7th, 2018 (Shanghai timezone).
- **Event Filtering**: Selecting events with specific "event_name" values to focus on relevant user actions.
- **User Identification**: Grouping or filtering data based on "user_pseudo_id".
- **Platform Segmentation**: Filtering data where "platform" matches a specific value.
- **JSON Data Extraction**: Utilizing `LATERAL FLATTEN` to extract fields from JSON columns like "event_params" and "user_properties".

---

**SQL Queries:**

1. **List Distinct Event Dates in September 2018**

   ```sql
   SELECT DISTINCT "event_date"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   LIMIT 100;
   ```

2. **Retrieve Sample User IDs and Their First Touch Timestamps**

   ```sql
   SELECT "user_pseudo_id", "user_first_touch_timestamp"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   LIMIT 100;
   ```

3. **Find Users Who First Used the App Between September 1-7, 2018**

   ```sql
   SELECT DISTINCT "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "user_first_touch_timestamp" >= 1535731200000000
     AND "user_first_touch_timestamp" < 1536336000000000
   LIMIT 100;
   ```

4. **List Distinct Platforms Used on September 1st, 2018**

   ```sql
   SELECT DISTINCT "platform"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   LIMIT 100;
   ```

5. **Get the Count of Events per Event Name on September 1st, 2018**

   ```sql
   SELECT "event_name", COUNT(*) AS "event_count"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   GROUP BY "event_name"
   ORDER BY "event_count" DESC
   LIMIT 100;
   ```

6. **Extract Event Parameters from "event_params" JSON Field**

   ```sql
   SELECT f.VALUE::VARIANT
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t,
        LATERAL FLATTEN(input => t."event_params") f
   LIMIT 100;
   ```

7. **Extract User Properties from "user_properties" JSON Field**

   ```sql
   SELECT t."user_pseudo_id", f.KEY, f.VALUE::VARIANT
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t,
        LATERAL FLATTEN(input => t."user_properties") f
   LIMIT 100;
   ```

8. **Count Number of Events Per User on September 1st, 2018**

   ```sql
   SELECT "user_pseudo_id", COUNT(*) AS "event_count"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   GROUP BY "user_pseudo_id"
   ORDER BY "event_count" DESC
   LIMIT 100;
   ```

9. **Retrieve Events for a Specific Event Name (e.g., "app_open")**

   ```sql
   SELECT *
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "event_name" = 'app_open'
   LIMIT 100;
   ```

10. **Get Sample of Device Information from "device" JSON Field**

    ```sql
    SELECT t."user_pseudo_id", t."device"::VARIANT
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t
    LIMIT 100;
    ```

**Note:** These queries are designed to explore the relevant data and understand the structure and content of the columns necessary for calculating the weekly customer retention rate. Adjust the table names (e.g., "EVENTS_20180901") and date ranges as needed to cover the entire period of interest (September 2018).

These queries avoid using time conversion functions unless the format is certain, and they use `LATERAL FLATTEN` to handle JSON nested columns like "event_params" and "user_properties". All column names are enclosed in double quotations as specified.Query:
SELECT DISTINCT "event_date"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   LIMIT 100;
Answer:
event_date
20180901
Query:
SELECT "user_pseudo_id", "user_first_touch_timestamp"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   LIMIT 100;
Answer:
Too long, hard cut:
user_pseudo_id,user_first_touch_timestamp
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
9F7B0D1BFB822F5E26E91E184E2E437C,1464484794147000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
0AF67C1A1C8F3785609B4210C3E04FC8,1498873240150000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
102CC7D8CD5D3E861EACE1BAB97E61EC,1528376472469000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B
Query:
SELECT DISTINCT "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   WHERE "user_first_touch_timestamp" >= 1535731200000000
     AND "user_first_touch_timestamp" < 1536336000000000
   LIMIT 100;
Answer:
user_pseudo_id
34CAF47105A2D9D0AC7464BB3AF8DB2A
14FC1A25D55E89AC7ECD600CD3A08C13
34ADF71F1AADCA26EC8008496F7CC87E
C7DD86F06FD4AA8A0967E27E20750FCD
4EEE67C2E335213F6815144829801E0F
4A2A03B50BDA6AC1687703BD39A91E3E
6D6EB70E837A5007BE550C44FF276440
A2D0AAFA35E66B8372DDAD76450A82FF
F4CB0B30E0A170AEB6A94EF1156738C8
EA89F979E0D4C374DBC95268982D18DE
7FA778C27A7CD840454FC893B8200200
108522345C425B9AEB5F83FE07C1A3A4
97D9D96077AD3E8859BF5C54C873E59D
5A66BC427F25EFFDFEDED4A07D8F9F91
37EFBD2BA398148336F96B4347392A8D
37034A23CAFF85394E2E349C381788A6
387B532B7AF7A362DBF783E34C05BF54
1E882F0B9818614D6E47620DD31229F1
CEBA063FD7BF190D727CC948185CCEC8
D771048ADB1B9CACADFE001E6F9BA799
7AB9D5F7D122A38CA8769C9C93F3A12F
D6803CFD38D435F0364EB47684F7CCF6
3B049329E3090DA7A4339C4A46EF0763
B9D800D33FDCF7AF2157CB66910A0797
9E25C5FED0F3F775FBB2A5C76DD0511C
AD7DEB9BF9C9B17C60B69DA2B3B6C59A
879503A3ED5F2DCB6592E99C42E1BDFE
2B6D9C77F287F5C021EC7297203D412B
DAD134C77F7E09BC552E290534CB90E8
A5302213F1605BE400E8AA34992B18A8
6C333017CEA199B69BB27611BA5DE7B5
9FD6E2CD74490F5DA5F52D249CBB750A
0E9150E8985138A744B88D56F015EDA7
ACA2E31E67D50F779611D7FDB674C370
D8B8615DDE319FEBE0A2AC1364E2C2EC
D2007D608FBB90EF5363BF5C8E08117A
0DCD6B00CAB93941AA5EB18DE8C053EE
D963E509346C0E5358ECFE56AF3BB2ED
96333A5A97DA9F4AEBC7A70483AF6C5C
B9A395E297106E5D6F72747F84AC7AE5
531E7B35DE9A21A1942F057C98B4E74C
E6E7FC8AC6D32935DA5ADCFFD14CC3A8
D8B77A575B5308D161F95ACF515F9772
C945C989CF380E22E1B1E4B28E26801A
8B7110AC0A6E048628AB4BCC751E0A09
7331597E5500811253BA85AF851A193C
177C0BEFFC69408F88D3377632F1BB60
551B893D34A2A59971B8FF185C1CD0C8
0FDAC2A4A154F9E946D749BFE67B1FCD
9F8885F0261FE69A58C8B6AE9176E437
A305B55D5049F38F5139DA95B3DCE247
ADB20527463A407E77162C54D30435F1
8BB6E580D7771BBBE04D3953EA43F640
B50E2B0888440679A84A3D861332531C
B1885B70DEFAC440D7DCBB520854A651
66788E34B6E292DE03B1B54E797CADBF
2C45FDF91F91AE8A3A9E6F119E8BED13
FCD8DDE7775A7211BCA9F42768C3BB8B
61BB31EC7781341B1D7B8D8A85688DA3
D1C57A2E87382A82A40B1816E85277EA
3E336ECE1F533064D663A350DAB00790
CCE5E30054C510608589FA6240615B0A
D31F0611DE6B94A5F001584286883AB7
2C15FFDEDDA69390B7A8EB5808FB7ED6
C09F65F2853D03DE23CFD90F97429735
5DA9B900E7C9F71714FB1AE9DA631C83
E0F1ED4167D0C0B2D6DCBA85CB020F52
B82793CB1270A48BB2697C51AEED3E4A
8DEB6CB6C3E85D0032D8557C73ADD49F
A6E8B0AC5E066F7670116136442F728F
B0D104EE63ABB85675B078664B5924A8
27C0BAADCE9520F17249A8B85F6477DA
0CBC523581751D977C4121B95429E8A9
1D5A0DC978A69FF28EC9D153F32EA871
Query:
SELECT DISTINCT "platform"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   LIMIT 100;
Answer:
platform
ANDROID
IOS
Query:
SELECT "event_name", COUNT(*) AS "event_count"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   GROUP BY "event_name"
   ORDER BY "event_count" DESC
   LIMIT 100;
Answer:
event_name,event_count
screen_view,20445
user_engagement,11536
level_start_quickplay,4078
level_end_quickplay,2700
post_score,2085
level_complete_quickplay,1647
level_fail_quickplay,1053
level_reset_quickplay,1044
select_content,925
level_start,921
level_end,613
session_start,579
level_retry,509
level_up,438
level_complete,438
level_retry_quickplay,178
level_fail,175
level_reset,137
spend_virtual_currency,98
use_extra_steps,95
first_open,64
firebase_campaign,54
app_remove,44
completed_5_levels,25
os_update,25
error,24
app_exception,24
no_more_extra_steps,20
ad_reward,12
app_update,9
challenge_a_friend,5
Query:
SELECT f.VALUE::VARIANT
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t,
        LATERAL FLATTEN(input => t."event_params") f
   LIMIT 100;
Answer:
Too long, hard cut:
F.VALUE::VARIANT
"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 121566607420435696
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 5585962841668417286
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""MainMenuActivity""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FloodItActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417306
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 5585962841668417306
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417307
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""FloodItActivity""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 5585962841668417307
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 121566607420435695
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 121566607420435696
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""MainMenuActivity""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""MainMenuActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417286
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""MainMenuActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 121566607420435695
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417307
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""content_type"",
  ""value"": {
    ""string_value"": ""mode""
  }
}"
"{
  ""key"": ""item_id"",
  ""value"": {
    ""string_value"": ""quickplay""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417287
  }
}"
"{
  ""key"": ""engagement_time_msec"",
  ""value"": {
    ""int_value"": 4945
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 5585962841668417307
  }
}"
"{
  ""key
Query:
SELECT t."user_pseudo_id", f.KEY, f.VALUE::VARIANT
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t,
        LATERAL FLATTEN(input => t."user_properties") f
   LIMIT 100;
Answer:
Too long, hard cut:
user_pseudo_id,KEY,F.VALUE::VARIANT
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464484747233000,
    ""string_value"": ""3""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464527606769000,
    ""string_value"": ""true""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1535867175448000,
    ""string_value"": ""30""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1465413020916000,
    ""string_value"": ""856338239819935514""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1524118000433000,
    ""string_value"": ""0""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1509095669887000,
    ""string_value"": ""true""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1532903928606000,
    ""string_value"": ""0""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464484794147000,
    ""set_timestamp_micros"": 1464484747147000
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1488642763867000,
    ""string_value"": ""2""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464484724233000,
    ""string_value"": ""3""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464527583769000,
    ""string_value"": ""true""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1535849095055000,
    ""string_value"": ""30""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1465412997916000,
    ""string_value"": ""856338239819935514""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1524117977433000,
    ""string_value"": ""0""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1509095646887000,
    ""string_value"": ""true""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1532903905606000,
    ""string_value"": ""0""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464484794147000,
    ""set_timestamp_micros"": 1464484724147000
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1488642740867000,
    ""string_value"": ""2""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464484791233000,
    ""string_value"": ""3""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464527650769000,
    ""string_value"": ""true""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1535849162055000,
    ""string_value"": ""30""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1465413064916000,
    ""string_value"": ""856338239819935514""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1524118044433000,
    ""string_value"": ""0""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1509095713887000,
    ""string_value"": ""true""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1532903972606000,
    ""string_value"": ""0""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1464484794147000,
    ""set_timestamp_micros"": 1464484791147000
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1488642807867000,
    ""string_value"": ""2""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1464484778233000,
    ""string_value"": ""3""
  }
}"
9F7B0D1BFB822F5E26E91E184E2E437C,,"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1464527637769000,
    "
Query:
SELECT "user_pseudo_id", COUNT(*) AS "event_count"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
   GROUP BY "user_pseudo_id"
   ORDER BY "event_count" DESC
   LIMIT 100;
Answer:
user_pseudo_id,event_count
8F6C5F7611B67A4A437FF283B6C10181,2406
3875A92B5F5C2BBA1355CED06A986079,2372
3B4A6FCA6DCB4C2749409DC4188A306E,1585
57EC50FBC6C7277B8EDCCE44C1352BD4,1119
E0664E9E7883956A6E3084FD68AA274B,1040
3DEB0C12C49AD19D7ACE68FA59E7ACD6,1035
724B99CB6F41846F3F6BB46C2F663F5E,827
B63075B53A750A67A12F7F19ED5AA835,769
2F74E23BEA1E45E3897274EE4903DCC5,747
7A85F2041ECC509DEDAD05C9C09125FA,678
7E74A2BB6BBF4746DEE15F957B315401,614
A976A39B8E08829A5BC5CD3827C942A2,604
498C5BB583F33EFA29DE4783D40330FF,596
9FF3330617722CBCB12644B02BFC5EF5,594
34CAF47105A2D9D0AC7464BB3AF8DB2A,591
B5395F8C2077B59B3D6C5719C0CA0339,582
5E09265F12D64B9FA85FF9427A0A7FB0,582
05FB3382D94C7E963B408FD6CC357D33,550
DABC5234774C4E18EF0B59DE32DEFD2D,513
DC14701AE5C2808151BE7008898B13B8,511
2DB65B29C41328FF8AB9AC27B7C05537,511
472451071AED6FF801BC0FE66706FD27,487
10B0D468B5E036E16D13DB53A65F2D49,445
CCE5E30054C510608589FA6240615B0A,442
387B532B7AF7A362DBF783E34C05BF54,422
959635567E419A061EECCCA478EDC718,394
13AC12EF4C6A0EAF72795F720752AD98,394
625CF86657E00A4629BCE49F5B31A144,354
74375465CD17299EBC7C75A1B4047EE0,349
86F19DAB73E484FB7DD2F805DDD7957D,336
4EF964D59282E5A2C8692D30F011256B,336
EA35FE295A7C1F8F67836AEB608CEBBD,331
6202381695390EB9E0F6CC22E9E55443,313
14FC1A25D55E89AC7ECD600CD3A08C13,305
879503A3ED5F2DCB6592E99C42E1BDFE,303
D771048ADB1B9CACADFE001E6F9BA799,292
3E336ECE1F533064D663A350DAB00790,289
EA89F979E0D4C374DBC95268982D18DE,288
56B9CBB6CB58106DCCF3CAD660232CB2,276
27C88E1533471126F779ADE591D7915D,272
EBFE0623EF1109A89B392B9DF4375951,271
018F03084C88E944163F76A0D0C2FBA1,257
4BDC831A6940071E2461D0B5293A329E,254
7EB0099C021CF1B2C0688CB1C9D42ED0,245
A0616D4E494DC3BCCB94B8B6E5B48380,244
F4CB0B30E0A170AEB6A94EF1156738C8,242
DF0E6C6C5E4F3F34FEC6EE54FD945B05,238
0CAAA1B6F161BA4D363EB7A2DEF64A08,236
7331597E5500811253BA85AF851A193C,234
F3C82C9DB04064BA7965BBBD95864189,233
869CD665A9D52E3398754C8DACF4426D,233
67D3D76504CC5C4CBFC78EE4FC397C8B,233
977CBDF2D7B65AC0FDC885F87117A7F2,219
EFB696A82D093B3AFBE92FF526DD5CEA,219
48AB910A8DE8485D4C34238EA61F782C,218
487DE902636DD8A9844A2D61FE7BD568,217
9FD6E2CD74490F5DA5F52D249CBB750A,216
EF500E0CF578004836D1D38C8901862B,212
D6803CFD38D435F0364EB47684F7CCF6,210
DFDE5425237185986327A054407A09B4,209
D31F0611DE6B94A5F001584286883AB7,208
ACA2E31E67D50F779611D7FDB674C370,206
93CE02A528E41C078FDB04857CCDA48C,202
FCD8DDE7775A7211BCA9F42768C3BB8B,200
E80C958E3C33898989A30B8F5A4514F0,199
3B049329E3090DA7A4339C4A46EF0763,199
B8FE9AD137A133A89389656F7989B36C,197
841727B396264112EC75FEB26C57E25C,194
D7EA8E3645EFFBD6443946179ED704A6,191
FA30269453141794E79B8F15EE0BA5B9,189
2F2B5C88B72A5253AAF448B1E29333F5,180
7E38A396789F21724DDEFB0400305685,179
BA3E7A5857FD7BE68F02E4D2F5744BE8,177
D1C57A2E87382A82A40B1816E85277EA,177
6BEB06D064B7393657B25234BFF14E1D,176
5ACF1A6BFE350F7BB661BF389AF7E2F0,175
37034A23CAFF85394E2E349C381788A6,173
F9E25D9E79A408331969D9ED06679184,169
465B5DC1BA69633FE49EFA52F08CBB40,168
0D17D0247F158FA3E40D21EFF46D1651,165
34ADF71F1AADCA26EC8008496F7CC87E,164
7A8D1CAA45CDE7652260DA6E71068A13,164
F1555004E0D95599AF2F2B8EA130A9C3,164
F5DAD8DD17B689CF672D65A0A81CF4AC,163
CA04708DA02378999ECB402481FF1AE4,163
D79D77E3F2698B89279D7C35AB034992,161
EF0FBB41BE6F40A5CC1D68D8E1CD3591,157
4EEE67C2E335213F6815144829801E0F,153
377303AA2F5C5C80E5AAAD26C029BD5A,152
53866E32BA0ABFD846772D4B7B9B5921,152
FF20E4EE129C3700FC1C6CEF188E17BB,151
6E40E63C836A0C058685C1F69CFE1701,147
2B6D9C77F287F5C021EC7297203D412B,140
C028D1BCE3EE4626D117DF55D6A617B8,140
1AB36A765847D90D7F029C21FADFB3F4,135
77F125B832C748232EDA6AF8C7D08ED1,134
7AB9D5F7D122A38CA8769C9C93F3A12F,131
F4A3B9F9F0D4555ADC48F7BCBD5BEE9C,131
DB9D0368B6DC1CD2E03CDDBE7060DE31,131
17636078D57884AD7EA5406C60E2BD10,127
Query:
SELECT DISTINCT "user_pseudo_id"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
LIMIT 100;
Answer:
user_pseudo_id
9F7B0D1BFB822F5E26E91E184E2E437C
0AF67C1A1C8F3785609B4210C3E04FC8
102CC7D8CD5D3E861EACE1BAB97E61EC
A976A39B8E08829A5BC5CD3827C942A2
22DF34962481295121082D8C105EB436
B8FE9AD137A133A89389656F7989B36C
4E6F4A73B5D05B33DC73B11547E39004
6D32B47F6F516304209375F1D0CCE5A3
4B6BD3964DB295D02E54E59927ED73A0
B607C1DF4606F29FD7FA56A6D4DACFAC
487DE902636DD8A9844A2D61FE7BD568
690DA199396D35B845005CCD13ED8D67
9DB70702AD6350C1150E2AD452047208
14DE6B1CDA3BFD44679C7E9382644AC7
58230465C695B0FDDDAE08A481FAEECC
F26EC6056E284FDDEA7771F203B6BB8F
4BB019F8F6D1FE7BA78CA42A4698EF56
B0153FFD55333D4C4B546EC5B3FAC70E
945DE7C965AFB12E35C3C992CF9847E2
E30E8756808AB219B28276F129C51552
B2D359D114428D8DD085DFAFF11195CE
841727B396264112EC75FEB26C57E25C
7E74A2BB6BBF4746DEE15F957B315401
17636078D57884AD7EA5406C60E2BD10
2F2B5C88B72A5253AAF448B1E29333F5
39BE7CAB9B8602ABD10A1BFB4E66BBB2
5C5A0787542CD24F1E19F9EB778BA766
9DE7361ACCDEA6541AD5EA55D59B1C78
5ACF1A6BFE350F7BB661BF389AF7E2F0
3A73CDE17520867FB9C03E491F778B60
D2057EE2B8E8563B522E6C21B7BD4524
706C748E6D1E0768BFEFE6362B5D3F67
9FF3330617722CBCB12644B02BFC5EF5
B8984A29BE4798F85EA15F483E37877E
48AB910A8DE8485D4C34238EA61F782C
0579CD8B9F2F5C48A5F1ACECF88750A7
571B1FB7D9D44445BF25B75F0FD91660
1AB36A765847D90D7F029C21FADFB3F4
34CAF47105A2D9D0AC7464BB3AF8DB2A
6722ACD286AC0F5CA22E745302CAEB89
9A46DD24A6F7AD154E9143AA2D588310
DDDF330206C8FD63B6C78C3BFB13F801
192440EC48EB5C30C261D16F03D7D229
34ADF71F1AADCA26EC8008496F7CC87E
03948FE68D30FD7BD6B46D1993062581
8065F8E98407106A65D35195984B2258
31E8B3EB3D9167E813FDFB812898F2F6
FF20E4EE129C3700FC1C6CEF188E17BB
59454BAC415BB1F18517C6FD2C023E49
6C14B6297FCC1782508E14996A4DBB7C
EBFE0623EF1109A89B392B9DF4375951
D99BC96AD021DD4BC255489C45083668
FB88784404E4864870E5DABC75F2C70B
6A5F60408CAFD78C48447547A30BA926
5C3E52036EA54498B6E571A50A45ABFD
4A2A03B50BDA6AC1687703BD39A91E3E
B081E087ABDC8FE6FB390ACF48CD61D8
40E48F9F86A546EF73EDE7855625E2B2
F3917138A3D4B03ADA1C2E77E3B84649
3883FF0DFAB40ECD4EA781FC0D1CE18A
26FACA90F8AA62D614E65FD30CD978AB
57EC50FBC6C7277B8EDCCE44C1352BD4
E8124E2C2D99AB999ADC3CA7D481242E
186F51E5AACB37852E3650E7027E33B1
4D084D38156128AAA060303AA91E689D
8D0EAD73C85E48D958042757FEBB37BC
C66BF8A9ACA5CD56597E18B0729181C4
FA30269453141794E79B8F15EE0BA5B9
0A26E7281EC31038AD42F28C930FFF90
A7722F61A84758A6CAE3E2C03B9EF742
AC14799A5E8C340D6CADCBAE72037D81
7ED4165854463C38F1D739A2014001D9
A064A84CD3CF7058F39333D6212E8615
47EF903C26610B033B8734C8159B2ECA
9AAAE2A96BA29B283C25AA62182ECA9D
14FC1A25D55E89AC7ECD600CD3A08C13
C679FF00E17790E7E16AB903212EE05C
1B959D672ABAE4A3BFB9D720D415E064
93CE02A528E41C078FDB04857CCDA48C
D5F9D9AF22EF5073E10342973D48FB2C
3DC1C89C927D2FC9D264FBC21E401E5B
037DAC225F0C1E54657770CD201CDDA7
59BE43F3FE7AB3F91B016B56508D4C46
C7DD86F06FD4AA8A0967E27E20750FCD
FEDC59699D8832A11B88BFCCCAD0951D
D7EA8E3645EFFBD6443946179ED704A6
7A85F2041ECC509DEDAD05C9C09125FA
DC14701AE5C2808151BE7008898B13B8
3F4C49B7D999DB0D286AA09BED5C04A9
BF709EB51D61C3A7BF68C4CFD7F236BE
E4196C5E0A92A22F69DE4E3AA288D6EE
E80C958E3C33898989A30B8F5A4514F0
13AC12EF4C6A0EAF72795F720752AD98
5C5D78DD8E3D3B7FFC9118D4511E76BF
D3F06F9B7BD9D7FC8758BF78BF0705E9
4EEE67C2E335213F6815144829801E0F
DEADCFB9776A98526FE128254F93C278
8A512E5089AFA1272B677047B6CB7BFE
534D8E69233D917A9A5BC15E3953FEB8
7EB0099C021CF1B2C0688CB1C9D42ED0
Query:
SELECT t."user_pseudo_id", t."device"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901" t
LIMIT 100
Answer:
Too long, hard cut:
user_pseudo_id,device
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-au"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": 28800
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-au"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": 28800
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-au"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": 28800
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-au"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": 28800
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-au"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": 28800
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-au"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": 28800
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-au"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": 28800
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-au"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": 28800
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-au"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": 28800
}"
9F7B0D1BFB822F5E26E91E184E2E437C,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-au"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",

End Exploring Related Columns
Task: Could you please help me get the weekly customer retention rate in September 2018 for new customers who first used our app within the first week starting from September 1st, 2018 (timezone in Shanghai)? The retention rates should cover the following 3-week period after the initial use and display them in column format.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: Sure! Here's the weekly customer retention rate format for new customers who first used the app within the first week starting from September 1st, 2018 (Shanghai time). The retention rates cover the following 3-week period after the initial use:

```csv
Week,Retention_Rate
Week 1,value1:0<=float<=100
Week 2,value2:0<=float<=100
Week 3,value3:0<=float<=100
```

**Explanation:**

- **Week**: Represents each week following the users' initial usage week.
  - **Week 1**: September 8 - September 14, 2018
  - **Week 2**: September 15 - September 21, 2018
  - **Week 3**: September 22 - September 28, 2018
- **Retention_Rate**: The percentage of users from the initial cohort who returned to use the app during that week. The values range from 0 to 100 and do not include the '%' symbol.

**How to Calculate:**

1. **Identify the Cohort**: Select all users who first used the app between **September 1 - September 7, 2018**.
2. **Track Weekly Usage**: For each subsequent week (Weeks 1 to 3), determine which users from the cohort returned to the app.
3. **Calculate Retention Rates**:
   - **Retention Rate (%)** = (Number of Returning Users in the Week ÷ Total Number of Users in Cohort) × 100
   - Repeat this calculation for each week to get the weekly retention rates.

This format will help you display the retention rates clearly for analysis..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-24 05:05:36 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 05:05:36 - root - INFO - ```sql
WITH 
cohort_users AS (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903"
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180904"
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180905"
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180906"
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180907"
    ) AS cohort
    WHERE "user_first_touch_timestamp" >= ((DATE_PART(EPOCH_SECOND, TO_TIMESTAMP_NTZ('2018-08-31 16:00:00', 'YYYY-MM-DD HH24:MI:SS'))) * 1000000)
      AND "user_first_touch_timestamp" < ((DATE_PART(EPOCH_SECOND, TO_TIMESTAMP_NTZ('2018-09-07 16:00:00', 'YYYY-MM-DD HH24:MI:SS'))) * 1000000)
),
events_weeks AS (
    SELECT DISTINCT "user_pseudo_id", 1 AS week
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180909"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180910"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180911"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180912"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180913"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180914"
    ) AS week1
    WHERE "user_pseudo_id" IN (SELECT "user_pseudo_id" FROM cohort_users)
    UNION ALL
    SELECT DISTINCT "user_pseudo_id", 2 AS week
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180916"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180917"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180918"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180919"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180920"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180921"
    ) AS week2
    WHERE "user_pseudo_id" IN (SELECT "user_pseudo_id" FROM cohort_users)
    UNION ALL
    SELECT DISTINCT "user_pseudo_id", 3 AS week
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180923"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180924"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180925"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180926"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180927"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180928"
    ) AS week3
    WHERE "user_pseudo_id" IN (SELECT "user_pseudo_id" FROM cohort_users)
),
retention AS (
    SELECT week, COUNT(DISTINCT "user_pseudo_id") AS returning_users
    FROM events_weeks
    GROUP BY week
),
total_users AS (
    SELECT COUNT(DISTINCT "user_pseudo_id") AS total_users FROM cohort_users
)
SELECT 
    CONCAT('Week ', CAST(week AS VARCHAR)) AS "Week", 
    ROUND((retention.returning_users / total_users.total_users) * 100, 4) AS "Retention_Rate"
FROM retention, total_users
ORDER BY week;
```
2025-01-24 05:05:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:05:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:05:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:05:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-24 05:05:41 - snowflake.connector.connection - INFO - closed
2025-01-24 05:05:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:05:41 - root - INFO - itercount: 1
2025-01-24 05:05:41 - root - INFO - 0
2025-01-24 05:05:41 - root - INFO - results: 
Week,Retention_Rate
Week 1,20.0514
Week 2,10.5398
Week 3,6.9409


2025-01-24 05:05:41 - root - INFO - Please check the answer again by reviewing Could you please help me get the weekly customer retention rate in September 2018 for new customers who first used our app within the first week starting from September 1st, 2018 (timezone in Shanghai)? The retention rates should cover the following 3-week period after the initial use and display them in column format., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: Sure! Here's the weekly customer retention rate format for new customers who first used the app within the first week starting from September 1st, 2018 (Shanghai time). The retention rates cover the following 3-week period after the initial use:

```csv
Week,Retention_Rate
Week 1,value1:0<=float<=100
Week 2,value2:0<=float<=100
Week 3,value3:0<=float<=100
```

**Explanation:**

- **Week**: Represents each week following the users' initial usage week.
  - **Week 1**: September 8 - September 14, 2018
  - **Week 2**: September 15 - September 21, 2018
  - **Week 3**: September 22 - September 28, 2018
- **Retention_Rate**: The percentage of users from the initial cohort who returned to use the app during that week. The values range from 0 to 100 and do not include the '%' symbol.

**How to Calculate:**

1. **Identify the Cohort**: Select all users who first used the app between **September 1 - September 7, 2018**.
2. **Track Weekly Usage**: For each subsequent week (Weeks 1 to 3), determine which users from the cohort returned to the app.
3. **Calculate Retention Rates**:
   - **Retention Rate (%)** = (Number of Returning Users in the Week ÷ Total Number of Users in Cohort) × 100
   - Repeat this calculation for each week to get the weekly retention rates.

This format will help you display the retention rates clearly for analysis. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Week,Retention_Rate
Week 1,20.0514
Week 2,10.5398
Week 3,6.9409
Current sql:
WITH 
cohort_users AS (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903"
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180904"
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180905"
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180906"
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180907"
    ) AS cohort
    WHERE "user_first_touch_timestamp" >= ((DATE_PART(EPOCH_SECOND, TO_TIMESTAMP_NTZ('2018-08-31 16:00:00', 'YYYY-MM-DD HH24:MI:SS'))) * 1000000)
      AND "user_first_touch_timestamp" < ((DATE_PART(EPOCH_SECOND, TO_TIMESTAMP_NTZ('2018-09-07 16:00:00', 'YYYY-MM-DD HH24:MI:SS'))) * 1000000)
),
events_weeks AS (
    SELECT DISTINCT "user_pseudo_id", 1 AS week
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180909"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180910"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180911"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180912"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180913"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180914"
    ) AS week1
    WHERE "user_pseudo_id" IN (SELECT "user_pseudo_id" FROM cohort_users)
    UNION ALL
    SELECT DISTINCT "user_pseudo_id", 2 AS week
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180916"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180917"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180918"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180919"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180920"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180921"
    ) AS week2
    WHERE "user_pseudo_id" IN (SELECT "user_pseudo_id" FROM cohort_users)
    UNION ALL
    SELECT DISTINCT "user_pseudo_id", 3 AS week
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180923"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180924"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180925"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180926"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180927"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180928"
    ) AS week3
    WHERE "user_pseudo_id" IN (SELECT "user_pseudo_id" FROM cohort_users)
),
retention AS (
    SELECT week, COUNT(DISTINCT "user_pseudo_id") AS returning_users
    FROM events_weeks
    GROUP BY week
),
total_users AS (
    SELECT COUNT(DISTINCT "user_pseudo_id") AS total_users FROM cohort_users
)
SELECT 
    CONCAT('Week ', CAST(week AS VARCHAR)) AS "Week", 
    ROUND((retention.returning_users / total_users.total_users) * 100, 4) AS "Retention_Rate"
FROM retention, total_users
ORDER BY week;
2025-01-24 05:06:26 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 05:06:26 - root - INFO - Sure! Here's the weekly customer retention rate for new customers who first used the app within the first week starting from September 1st, 2018 (Shanghai time). The retention rates cover the following 3-week period after the initial use:

```csv
Week,Retention_Rate
Week 1,20.0514
Week 2,10.5398
Week 3,6.9409
```

```sql
WITH 
cohort_users AS (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903"
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180904"
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180905"
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180906"
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180907"
    ) AS cohort
    WHERE "user_first_touch_timestamp" >= ((DATE_PART(EPOCH_SECOND, TO_TIMESTAMP_NTZ('2018-08-31 16:00:00', 'YYYY-MM-DD HH24:MI:SS'))) * 1000000)
      AND "user_first_touch_timestamp" < ((DATE_PART(EPOCH_SECOND, TO_TIMESTAMP_NTZ('2018-09-07 16:00:00', 'YYYY-MM-DD HH24:MI:SS'))) * 1000000)
),
events_weeks AS (
    SELECT DISTINCT "user_pseudo_id", 1 AS week
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180909"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180910"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180911"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180912"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180913"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180914"
    ) AS week1
    WHERE "user_pseudo_id" IN (SELECT "user_pseudo_id" FROM cohort_users)
    UNION ALL
    SELECT DISTINCT "user_pseudo_id", 2 AS week
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180916"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180917"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180918"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180919"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180920"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180921"
    ) AS week2
    WHERE "user_pseudo_id" IN (SELECT "user_pseudo_id" FROM cohort_users)
    UNION ALL
    SELECT DISTINCT "user_pseudo_id", 3 AS week
    FROM (
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180923"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180924"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180925"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180926"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180927"
        UNION ALL
        SELECT "user_pseudo_id" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180928"
    ) AS week3
    WHERE "user_pseudo_id" IN (SELECT "user_pseudo_id" FROM cohort_users)
),
retention AS (
    SELECT week, COUNT(DISTINCT "user_pseudo_id") AS returning_users
    FROM events_weeks
    GROUP BY week
),
total_users AS (
    SELECT COUNT(DISTINCT "user_pseudo_id") AS total_users FROM cohort_users
)
SELECT 
    CONCAT('Week ', CAST(week AS VARCHAR)) AS "Week", 
    ROUND((retention.returning_users / total_users.total_users) * 100, 4) AS "Retention_Rate"
FROM retention, total_users
ORDER BY week;
```
2025-01-24 05:06:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 05:06:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 05:06:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 05:06:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-24 05:06:27 - snowflake.connector.connection - INFO - closed
2025-01-24 05:06:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 05:06:28 - root - INFO - itercount: 2
2025-01-24 05:06:28 - root - INFO - 0
2025-01-24 05:06:28 - root - INFO - Total iteration counts: 2
