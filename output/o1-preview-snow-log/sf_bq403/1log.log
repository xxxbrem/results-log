2025-01-26 15:54:56 - openai._base_client - INFO - Retrying request to /chat/completions in 0.484049 seconds
2025-01-26 15:55:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 15:55:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:55:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:55:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:55:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:55:31 - snowflake.connector.connection - INFO - closed
2025-01-26 15:55:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:55:31 - root - INFO - SQL:
SELECT "totrevenue"
   FROM IRS_990.IRS_990.IRS_990_2012
   LIMIT 100;
Results:
totrevenue
615689
123398
339132
184876
194999
208324
110370
294294
252440
231889
816862
374605
2176110
57648
250907
326516
565417
6191901
1259941
368550
6263
887518
554010
1160268
217092
402615
267402
142654
3985749
1014987
214898
132489
404491
6853798
48737
205291
239009
799303
68693
41147
101615
117983
592366
246612
242673
245441
123757
106452
634918
1193694
391600
2334422
247695
162491
4679679
3711792
235470
2898551
153916
527281
1104162
19557978
1951296
4805178
652855
2125329
13852889
1192197
42612778
2812483
160381
1857316
346849
2727976
7554730
774388
11156787
1250968
21248493
493438
24018285
24409280
2730287
22424056
10006131
2221319
105775719
19299093
17980075
70036549
33508177
3183041
2788432
205587007
997037763
2783164
49034556
694874
21623111
2458179

2025-01-26 15:55:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:55:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:55:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:55:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:55:33 - snowflake.connector.connection - INFO - closed
2025-01-26 15:55:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:55:33 - root - INFO - SQL:
SELECT DISTINCT "totrevenue"
   FROM IRS_990.IRS_990.IRS_990_2012
   LIMIT 100;
Results:
totrevenue
339132
184876
208324
110370
1259941
887518
217092
3985749
1014987
132489
404491
6853798
68693
41147
246612
162491
4679679
1951296
4805178
652855
346849
24409280
3284806
531399
57648
142654
214898
101615
1192197
160381
1250968
493438
19299093
70036549
3183041
205587007
997037763
2603875
675478
322665
8578263
2847660
5147065
1999294
10577616
7794572
2094531
2916864
2898551
17980075
9610322
62720757
799983
906952
1782815
7330353
252440
239009
235470
19557978
24018285
49034556
235770
2176110
267402
245441
106452
21623111
3192479
4094881
31905167
86429284
555958
2761170
1465524
677840
48737
21248493
105775719
20020656
2917093
300130
1185514
5639787
2330926
836177
11251331
5006452
40237683
1002120
274250
9759682
752700
253848
24384008
6525159
5757895
10178834
676134
11981902

2025-01-26 15:55:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:55:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:55:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:55:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:55:35 - snowflake.connector.connection - INFO - closed
2025-01-26 15:55:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:55:36 - root - INFO - SQL:
SELECT "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2013
   WHERE "totfuncexpns" IS NOT NULL
   LIMIT 100;
Results:
totfuncexpns
233219
2288933
227663
355579
599928
2383014
2834679
2564742
27800070
16764161
7034850
2216131
16159574
159964
237306
179781
262734
567923
1879670
200209
1203782
335800
18203624
6777747
3752811
871965
369846
195393298
2072342
12266479
1586537
116871
0
28885
537077
115296
114117
258585
116733
278455
232567
247641
304915
82445
123099
318377
197502
40488
1326458
100868
3221
274338
218579
47303
61123
376031
303526
165337
239688
1453804
26133951
1112593
48684
691852
289714
17979683
2039803
5740392
517267
2182007
12589344
4140864
115499
338948
637842
4823367
12629291
63861951
36014678
40401
65527
254977
265657
283175
55551
1188694
88239
96664
53277
10680
184058
220090
251900
874012
77286
2105631
11714
209585
136959
68083

2025-01-26 15:55:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:55:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:55:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:55:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:55:37 - snowflake.connector.connection - INFO - closed
2025-01-26 15:55:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:55:38 - root - INFO - SQL:
SELECT "totrevenue", "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2014
   WHERE "totrevenue" > 0 AND "totfuncexpns" > 0
   LIMIT 100;
Results:
totrevenue,totfuncexpns
367901,351341
729380,971328
477224,449237
353430,336009
82388177,98087140
849237,792009
275493,290146
177440854,161503220
3183975,3746315
493200,494315
13181917,12685986
28652907,28389949
313238,323636
1195340,1113885
100271,158001
296427,646512
1230836,1148693
130369,105905
43720,44964
419928,409092
285670,311219
339287,308258
111416236,106741458
7735580,7947112
238731,213319
59342193,63056539
10261791,10208487
1121907,930946
1665148,193258
34267215,33418482
510309,473139
331643,382445
43536130,46180228
291887,41572
1002022,836380
113170,21114
47461503,8145861
97232,95766
46432,46770
60876457,59156347
232662,248288
53743,30246
236515,255572
8402,33267
4165808,3997553
159913,159950
271262,272948
517048,513335
363530,273843
672823,605984
238110,228806
682623,673707
212338,232028
290511,301039
499727,509816
232398,348357
44085,69135
2975067,2961126
1354702,1401283
231984,174205
299170,256112
378309,400382
20729785,18983172
232819,135828
1143947,1154976
23677418,22419806
68386212,66618557
454743,437272
2501424,2140101
5095977,3654775
611384,549767
1984600,2110183
326417,347417
157208,113059
172053,198769
315934,447101
656322,689409
560989,680232
200180,176118
252300,398603
1085096,857782
257451,257642
33290,35986
318184,305680
1159524,1122535
371737,310401
258475,258579
8048,28954
3238336,3061946
392323,291102
64991,34356
103254,105183
4565617,4238676
4662604,4516974
3615970,3218209
17070927,16753763
2156834,1741005
225010,220758
41950,41475
768970,749698

2025-01-26 15:55:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:55:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:55:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:55:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:55:39 - snowflake.connector.connection - INFO - closed
2025-01-26 15:55:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:55:40 - root - INFO - SQL:
SELECT "totrevenue", "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2015
   LIMIT 100;
Results:
totrevenue,totfuncexpns
79226,10716
69691,46507
565470,594117
919660,876681
196640,197060
287456,272165
1154253,1430994
329502,348482
1061767,670985
744619,636569
612222,575987
82274,427257
306876,290320
94153,133298
98428,68050
505005,244806
37341,27068
1025577,1029167
945745,999468
210093,179073
212718,181273
470522,737360
7501,48490
505289,570585
2032606,1884198
1069654,924002
2838381,3129743
133646,137182
609485,569610
5370,18058
253779,232749
63253,89266
104948,108652
882351,809780
24637,941
155723,123735
64817,88605
106594,60800
279975,193619
226465,207768
328848,355041
124183,107342
816800,797013
100878,72622
190755,139962
24672,52647
1641309,1500961
310359,330017
206001,274282
47417,50076
368629,318900
673623,558674
758987,650023
1582431,1516017
396441,466113
181133,217177
487579,485138
194563,213503
1223061,1163971
83384,86856
22808,46233
87125,95958
80515,128335
647283,610870
535465,363258
772400,817531
286326,302695
1486394,1374849
619001,435669
1854971,1901997
1954243,1793279
38272,36322
1122938,930460
301441,294166
192371,165038
46564,83168
102743,101312
1197018,1109017
66739,54980
768398,761949
897069,853500
291097,234324
124942,107684
161294,98428
174181,174181
920345,873721
86011,97990
105446,84737
194076,181084
63461,205446
221133,147009
1728910,1451817
498912,465316
601096,182145
51364,27895
393324,333606
1081819,1051561
146760,51121
99386,90148
474380,485665

2025-01-26 15:55:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:55:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:55:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:55:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:55:41 - snowflake.connector.connection - INFO - closed
2025-01-26 15:55:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:55:42 - root - INFO - SQL:
SELECT "ein", "totrevenue", "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2016
   WHERE "totrevenue" IS NOT NULL AND "totfuncexpns" IS NOT NULL
   LIMIT 100;
Results:
ein,totrevenue,totfuncexpns
382032501,281124,330710
263010938,235819,238967
942746487,2552190,2669341
112889774,32425648,32098696
263416084,320525,351666
270131664,71895,88763
160820608,324899,254431
680475602,2837482,2807835
411631246,418695,416577
470585186,3588013,3541336
202799021,954519,875799
363032700,2522077,2424594
263817958,213962,195282
720485727,441877,465581
943059287,297098,303187
237075704,8630374,4068797
461720815,401595,0
841606735,812435,825952
113237992,8800916,8804399
590876627,222935,222095
202966170,227088,198487
133008074,14444601,13631662
590626226,497791,414382
710916426,288044,276583
746062862,105620,97393
431307672,1284111,641602
720805656,1835152,1839043
721079718,63799,133204
464691123,454367,375392
911230960,91105,94542
463115731,224728,240526
911296139,64428,80427
421132140,413658,445372
10104905,507249,550897
223576391,93946,63512
731383156,547229,419381
742267667,209016,229679
232133293,280108,255848
510178981,216013,254466
460252876,1798994,1751480
237544345,5626,12614
133976090,71,59091
133559130,3780480,3566181
371307763,432724,382554
650321678,11784947,11725715
841408649,135815,130383
131825916,52800,37588
36010565,32124,26660
810471246,685972,629551
593753956,129973,68528
521792074,1554893,1471006
710615370,120359,137802
751806426,288407,248291
942497039,448341,523784
411618333,241561,239939
742383678,254246,246314
943309906,488981,500976
363526646,110749,237498
237155203,3616528,3612680
237043276,323944,460823
620452087,121076,202241
952480624,19216873,19742993
465215702,844831,931294
956131453,53268,55790
20669356,1631969,1543597
226082961,149544,151816
841149609,5292225,1345468
232595475,80738,164288
270232682,403099,399965
363264898,2775480,2737154
930594506,2280475,2204248
592120945,2180401,1036111
310784671,1004649,1048471
581295404,1216653,1303975
743068174,605128,691163
208675368,165213,141815
363586462,429152,296555
364026048,114657,186185
931329158,26812005,24130681
743041358,248058,226483
520891628,1164303,1349813
382959692,3165282,4348921
364412796,98526,178756
311012363,554244,531574
454845389,115273,119078
510238382,118461,103036
311234216,15771,0
741827630,452171,437574
237174336,99733,70758
274167030,158926,112974
860090134,2797845,2862377
390989783,3986674,4059124
310944769,248791,244005
421375644,390191,159212
161102449,34277,62275
541788059,194544,84289
363431222,629384,627025
621660029,479677,494719
861009613,1357145,1120765
430725282,1168966,1366751

2025-01-26 15:55:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:55:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:55:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:55:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:55:44 - snowflake.connector.connection - INFO - closed
2025-01-26 15:55:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:55:44 - root - INFO - SQL:
SELECT "ein", "totrevenue" - "totfuncexpns" AS "difference"
   FROM IRS_990.IRS_990.IRS_990_2017
   LIMIT 100;
Results:
ein,difference
300189270,3476
263208840,10112
356042156,-22790
760797012,28894
362202370,-25397
60646753,-24434
133643245,62977
43445912,99432
134214040,98490
46112075,119589
710845972,-2415
990347476,24020
742329384,59625
510515711,153452
222485332,422447
753056013,213556
260146595,-4366
223348540,-24012
222147463,23621
341657533,68764
720914730,29112
232013068,3811
314443574,67739
581028915,107737
421038039,48131
592887162,19669
237181129,6069
222484450,37941
237133503,243657
680164659,128387
311707319,193461
42677156,14445
861037570,118131
426603775,143900
43101427,36939
956050121,-66577
220887600,8571
131624065,75497
263653751,-4652
223043823,8069
42214867,43868
42383933,-6892
352246162,-1341891
231572645,18387
232616113,-8261
581393263,8304
10407276,48647
251153389,115718
954612730,-35580
951652837,-39233
420186460,-6484
131825916,-23592
381387795,5774
581716113,1915875
521598836,68763
910647440,84386
363507635,-78199
131740468,17241389
742728646,-152383
237147452,19902
382132707,-15548
134255387,-3747
330288930,-1027525
471129960,-974
720573879,-54366
631235903,99775
510182993,-5840
61423927,19398
382885443,148389
510195211,5001
60885694,22218
710600797,3680
133439360,-27402
742699667,236561
430549665,-13149
451457029,-704207
931248359,88468
237130173,16254
742379318,43570
205146418,26930
300699916,9336
204780320,-285843
870749129,-50362
311552336,159497
310999025,-3367
60868436,-48434
592021472,87990
582224949,260585
270049012,449955
521234660,-21229
560585448,144169
930740519,309548
381200590,30994
43208934,-4195
371606372,5995
10563134,10991
223619206,-13147
592263083,-9288
592828707,-1973642
570822541,15625

2025-01-26 15:55:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:55:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:55:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:55:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:55:45 - snowflake.connector.connection - INFO - closed
2025-01-26 15:55:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:55:46 - root - INFO - SQL:
SELECT "ein", ABS("totrevenue" - "totfuncexpns") AS "abs_difference"
   FROM IRS_990.IRS_990.IRS_990_2012
   WHERE "totrevenue" IS NOT NULL AND "totfuncexpns" IS NOT NULL
   LIMIT 100;
Results:
ein,abs_difference
250972074,203904
222094018,91160
382494084,28065
166094236,22187
231491160,102199
391449048,4640
382494635,3205
942412714,3438
510340553,31899
431860643,44217
411773248,1455
330316219,14459
720924871,2025060
133394305,2289
311090052,33622
911025090,33174
880181824,52811
860673370,26638
431110061,9576
221554536,44014
431488916,1951
133737760,113974
742328963,56281
311617260,110886
593089562,8549
841496701,172318
450339622,15735
841476613,25439
061427346,116603
450233749,6633
742544243,54354
351830590,27718
020468137,13017
860673370,54791
931141006,5517
562663346,19941
742208935,48021
562487490,528334
510183465,32939
161454215,4737
752434783,4955
020624596,49512
112727514,78470
841534209,2055
330776377,8869
742208935,21600
042429428,18014
141625139,26648
600001118,272711
042210747,110259
160866061,97580
132548780,151048
237331116,31263
350899077,9985
591312245,180191
231365194,239738
541136097,8520
132596500,2997890
526054081,15403
231628480,93235
020664475,19760
580566123,2346822
391394068,77447
340819149,486292
560579600,1863
742340423,261845
237042553,5290920
237087247,16493
346516654,280038
720542138,283127
630480594,123664
160743245,87519
911806943,36676
541870905,826002
952788856,633502
810367205,18702
112667021,5438164
237357226,235269
042105780,2818881
010207716,72108
362512404,1801638
131624146,1492235
020260158,406692
060653120,4015258
742431071,5738450
620511893,1033623
580633971,11871835
952543028,103295
590917284,6283181
951648180,5153186
237120898,24388107
941702753,227834
610444762,82308
131624100,25799626
530242652,144342555
111630813,1188648
941156300,5466787
351043456,59316
131675082,9581189
520403670,1183813

2025-01-26 15:55:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:55:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:55:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:55:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-26 15:55:47 - snowflake.connector.connection - INFO - closed
2025-01-26 15:55:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:55:47 - root - INFO - SQL:
SELECT COUNT(*)
   FROM IRS_990.IRS_990.IRS_990_2012
   WHERE "totrevenue" IS NOT NULL AND "totfuncexpns" IS NOT NULL;
Results:
COUNT(*)
294019

2025-01-26 15:55:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:55:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:55:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:55:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:55:49 - snowflake.connector.connection - INFO - closed
2025-01-26 15:55:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:55:49 - root - INFO - SQL:
SELECT "tax_pd", "totrevenue", "totfuncexpns"
    FROM IRS_990.IRS_990.IRS_990_2014
    LIMIT 100;
Results:
tax_pd,totrevenue,totfuncexpns
201312,20694,19468
201309,236657,301343
201312,19819,26396
201312,655125,578163
201306,847870,826451
201312,712182,712459
201312,366711,353922
201312,3447721,2909079
201309,2621632,1366326
201312,2871588,2928131
201312,1015877,1001174
201312,863595,530667
201306,51218,153153
201306,1185460,1172599
201312,6830751,6142934
201312,411892,506446
201312,117976,109535
201312,16330,25661
201312,527676,508423
201312,3996068,3814139
201312,31462,15677
201312,110869,75381
201312,196609,192972
201306,4856006,4435095
201306,646143,882350
201312,55653,54446
201306,36255767,37918684
201306,13401,42833
201306,2497066,1966300
201312,592497,579233
201312,526551,542168
201306,7598454,7415237
201307,688824,695361
201306,592390,548554
201309,1899805,1721268
201306,5275560,5094916
201312,29024,4300
201306,1430082,1180962
201312,10618,12506
201304,9344697,11265328
201312,150016,225798
201309,160825,162894
201312,177716,173485
201312,0,5280
201306,355783,341269
201312,200313,196189
201312,84804,318702
201312,988630,258610
201306,299418,164213
201312,721665,649140
201312,27944,19206
201312,375326,263299
201312,213389,214720
201312,205349,108411
201306,7323005,7706633
201306,504245,473816
201306,2893102,2718660
201312,469484,436588
201312,460476,713786
201312,309001,155099
201312,447640,439713
201309,27065,49924
201312,631519,656660
201312,156588,134766
201309,559483,141491
201306,8659447,8527621
201306,10947718,10717634
201312,1436783,1036703
201312,73239,66127
201306,2415779,2634196
201306,601371,740935
201306,135726,122830
201312,90930,63194
201309,8888752,9015272
201312,439578,315975
201403,466928,481516
201306,11389699,11169785
201306,8312329,6808366
201312,609859,516240
201306,20097194,17307341
201312,1079509,1091845
201310,1600525,1127166
201312,64356,87744
201312,9233,8946
201312,120116,123827
201310,21760972,20973199
201306,1327524,1299522
201312,104555,100085
201312,134958,15702
201312,1372261,157833
201312,684340,373909
201306,61713,0
201306,0,157
201306,152717,173234
201306,138876,157099
201306,2295981,2056378
201312,194497,193369
201312,244112,323411
201312,1200,5900
201306,571539,543849

2025-01-26 15:55:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:55:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:55:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:55:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:55:50 - snowflake.connector.connection - INFO - closed
2025-01-26 15:55:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:56:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 15:56:25 - root - INFO - ```sql
WITH medians AS (
    SELECT
        2012 AS "Year",
        APPROX_PERCENTILE("totrevenue", 0.5) AS "median_revenue",
        APPROX_PERCENTILE("totfuncexpns", 0.5) AS "median_expenses"
    FROM IRS_990.IRS_990.IRS_990_2012
    WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

    UNION ALL

    SELECT
        2013 AS "Year",
        APPROX_PERCENTILE("totrevenue", 0.5) AS "median_revenue",
        APPROX_PERCENTILE("totfuncexpns", 0.5) AS "median_expenses"
    FROM IRS_990.IRS_990.IRS_990_2013
    WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

    UNION ALL

    SELECT
        2014 AS "Year",
        APPROX_PERCENTILE("totrevenue", 0.5) AS "median_revenue",
        APPROX_PERCENTILE("totfuncexpns", 0.5) AS "median_expenses"
    FROM IRS_990.IRS_990.IRS_990_2014
    WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

    UNION ALL

    SELECT
        2015 AS "Year",
        APPROX_PERCENTILE("totrevenue", 0.5) AS "median_revenue",
        APPROX_PERCENTILE("totfuncexpns", 0.5) AS "median_expenses"
    FROM IRS_990.IRS_990.IRS_990_2015
    WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

    UNION ALL

    SELECT
        2016 AS "Year",
        APPROX_PERCENTILE("totrevenue", 0.5) AS "median_revenue",
        APPROX_PERCENTILE("totfuncexpns", 0.5) AS "median_expenses"
    FROM IRS_990.IRS_990.IRS_990_2016
    WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

    UNION ALL

    SELECT
        2017 AS "Year",
        APPROX_PERCENTILE("totrevenue", 0.5) AS "median_revenue",
        APPROX_PERCENTILE("totfuncexpns", 0.5) AS "median_expenses"
    FROM IRS_990.IRS_990.IRS_990_2017
    WHERE "totrevenue" > 0 AND "totfuncexpns" > 0
)
SELECT
    "Year",
    ABS("median_revenue" - "median_expenses") AS "Difference"
FROM medians
ORDER BY "Difference" ASC
LIMIT 3;
```
2025-01-26 15:56:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:56:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:56:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:56:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-26 15:56:27 - snowflake.connector.connection - INFO - closed
2025-01-26 15:56:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:57:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 15:57:02 - root - INFO - SQL:
WITH medians AS (
    SELECT
        2012 AS "Year",
        APPROX_PERCENTILE("totrevenue", 0.5) AS "median_revenue",
        APPROX_PERCENTILE("totfuncexpns", 0.5) AS "median_expenses"
    FROM IRS_990.IRS_990.IRS_990_2012
    WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

    UNION ALL

    SELECT
        2013 AS "Year",
        APPROX_PERCENTILE("totrevenue", 0.5) AS "median_revenue",
        APPROX_PERCENTILE("totfuncexpns", 0.5) AS "median_expenses"
    FROM IRS_990.IRS_990.IRS_990_2013
    WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

    UNION ALL

    SELECT
        2014 AS "Year",
        APPROX_PERCENTILE("totrevenue", 0.5) AS "median_revenue",
        APPROX_PERCENTILE("totfuncexpns", 0.5) AS "median_expenses"
    FROM IRS_990.IRS_990.IRS_990_2014
    WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

    UNION ALL

    SELECT
        2015 AS "Year",
        APPROX_PERCENTILE("totrevenue", 0.5) AS "median_revenue",
        APPROX_PERCENTILE("totfuncexpns", 0.5) AS "median_expenses"
    FROM IRS_990.IRS_990.IRS_990_2015
    WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

    UNION ALL

    SELECT
        2016 AS "Year",
        APPROX_PERCENTILE("totrevenue", 0.5) AS "median_revenue",
        APPROX_PERCENTILE("totfuncexpns", 0.5) AS "median_expenses"
    FROM IRS_990.IRS_990.IRS_990_2016
    WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

    UNION ALL

    SELECT
        2017 AS "Year",
        APPROX_PERCENTILE("totrevenue", 0.5) AS "median_revenue",
        APPROX_PERCENTILE("totfuncexpns", 0.5) AS "median_expenses"
    FROM IRS_990.IRS_990.IRS_990_2017
    WHERE "totrevenue" > 0 AND "totfuncexpns" > 0
)
SELECT
    "Year",
    ABS("median_revenue" - "median_expenses") AS "Difference"
FROM medians
ORDER BY "Difference" ASC
LIMIT 3;
Results:
Year,Difference
2012,20807.68602431519
2013,21579.555983036
2017,26870.32682308246

2025-01-26 15:57:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:57:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:57:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:57:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:57:04 - snowflake.connector.connection - INFO - closed
2025-01-26 15:57:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:57:04 - root - INFO - SQL:
-- Corrected SQL 1:
SELECT "totrevenue", "totfuncexpns"
FROM IRS_990.IRS_990.IRS_990_2016
WHERE "totrevenue" IS NOT NULL AND "totfuncexpns" IS NOT NULL AND "totrevenue" > 0 AND "totfuncexpns" > 0
ORDER BY "totrevenue" DESC
LIMIT 100
Results:
totrevenue,totfuncexpns
48466380486,48252710912
22589160782,20177137580
11117362273,10735291530
10588819964,10397939016
10093618664,9598768323
7766891918,7031439782
6627941524,6546010317
6609236543,4775458754
6493574288,6241795918
6294043000,5365056000
6202791309,6013922970
6035405120,5050927315
5873490598,5428669563
5797614000,5413130000
5588532117,5472832968
5461672525,3513798862
5393562395,2904271461
5356390727,4704630046
5328246960,5420536806
5161648176,5244142393
5134601111,4834543626
5133153576,5103578899
4910706402,4139274346
4816088296,4545788229
4774717370,4809182027
4716398592,4445052878
4638829461,4257472819
4504130397,4189634110
4473514886,4079538648
4372143740,1813161781
4351368015,3951934873
4311684452,5593549105
4183432761,4054537461
4106025478,3973335311
4042224000,3362019000
4025714365,3646887535
3989206369,3674604442
3953321746,4889356658
3937422813,3738011324
3876101208,3808703953
3867024714,3528902741
3863299939,3866118217
3747280284,3541811776
3643873548,3341897417
3566621530,3561486152
3548514745,3058760413
3544672148,3515591212
3537547291,3510646795
3525925969,3280678127
3468642039,3429310641
3449061000,3090294000
3428144743,3391520370
3411016895,3207510050
3351543535,3326555123
3333076637,3352267064
3259935496,3071848219
3214106912,2724203584
3203953559,2575896601
3199591275,2804331125
3178795190,4500095279
3129343358,2765086838
3080885746,3087726933
3071828318,3016490619
3035099104,2746184349
3030963951,2956856742
3030169520,2577346747
3027840937,2908625317
2978563000,1803109000
2943587980,2572294142
2924436906,2432399607
2763166156,2532008520
2743877191,2011897432
2731100296,2480390461
2726672619,2886003368
2686158659,2573092382
2657404837,2658726363
2621538541,2401392211
2612768116,2234135830
2598267000,2475783000
2594041401,2536483327
2577579491,2483941839
2571857701,2291183575
2558344913,2419780683
2551240199,2479801073
2548073099,2421302363
2544472361,2383977370
2520129473,2304404712
2516797916,2497728565
2483648665,2478142522
2452502888,2012397496
2421913636,2177684094
2405092512,2233609948
2343232119,2232588134
2302862483,2167859749
2231492139,2146355425
2231072418,2216859212
2229239192,2239305974
2227579157,2039964371
2219948393,2128505718
2219118944,2358753125

2025-01-26 15:57:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:57:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:57:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:57:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:57:06 - snowflake.connector.connection - INFO - closed
2025-01-26 15:57:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:57:06 - root - INFO - SQL:
-- Corrected SQL 2:
SELECT "ein", "totrevenue", "totfuncexpns"
FROM IRS_990.IRS_990.IRS_990_2017
WHERE "totfuncexpns" > "totrevenue" AND "totrevenue" IS NOT NULL AND "totfuncexpns" IS NOT NULL
LIMIT 100
Results:
ein,totrevenue,totfuncexpns
237405790,20128,23582
208416981,794992,822403
273699109,30,400
381650166,74986,97288
272691353,0,90826
370947122,128590,157266
460969758,223086,261225
461571045,342729,369988
350709681,80290,104959
251291588,10116126,10387142
232200495,59772,67533
273400989,1922865,1967635
260668563,170275,286482
46033783,39385,77077
460635108,235676,247267
371065889,256929,263595
201195276,0,125
440562050,355322,356191
521234086,555651,591446
710724522,785492,786526
450226771,134879,137785
237206092,687660,730206
760522196,391401,479301
383648590,360230,408645
113289644,0,66118
954378092,446143,481131
200344973,3981,7566
561649348,111886,148852
264769948,391921,464659
581509453,95615,101180
262934876,0,4074
116046761,740503,759523
920163309,10310,24067
562612221,9561,12670
746067204,-74877,0
436048958,380134,385490
232787770,63743,72099
41032811,15099,15886
364677522,21552,34989
421306327,132248,155809
113131155,484310,583956
382596556,23002,214511
521327135,65385,145008
430653311,56397,177633
461855613,208394,212058
161647860,201025,231022
364185647,22267,35533
202856026,15778,16220
221403386,111618,132140
166093842,124448,124529
942376641,365187,1118670
860907496,69140,129701
660421941,600,96655
660479375,280953,359994
840445294,144439,157162
621497109,299580,425685
521635549,263081,344704
953251598,-4108,34899
60775048,13967,15068
562644123,77434,95179
41729080,33,1777
956099148,127741,135177
450348626,154328,158459
521750739,10414,14005
204530754,0,18400
680611130,182978,187369
946107654,9487,11750
203331176,734090,745930
746063788,53205,59597
946103450,71552,85412
431295518,170965,183190
421321802,395491,411416
351759951,764646,768532
311009270,107468,121930
261117499,3898241,5856795
416025659,71954,87828
630784586,430009,439711
381435833,582987,590827
550171648,51917,52817
640808786,216943,231609
953797579,300319,317638
350340035,93695,97215
590842761,293413,297891
386069083,64106,137422
391170009,547373,556457
230781035,350073,354928
230998230,2908362,2967458
370661312,370540,387624
341097334,240999,290156
953087805,192604,249489
421516611,215585,229295
750713616,1394294,1444938
742583484,675736,678792
237171916,255776,265625
232909561,247917,261151
942930926,678329,786345
850413060,218721,241761
350173331,40858,79026
746085122,44515,69593
730660293,126132,140411

2025-01-26 15:57:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:57:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:57:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:57:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-26 15:57:07 - snowflake.connector.connection - INFO - closed
2025-01-26 15:57:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:57:08 - root - INFO - SQL:
-- Corrected SQL 3:
SELECT AVG("totrevenue") AS "avg_revenue", AVG("totfuncexpns") AS "avg_expenses"
FROM IRS_990.IRS_990.IRS_990_2014
WHERE "totrevenue" > 0 AND "totfuncexpns" > 0
Results:
avg_revenue,avg_expenses
7563524.593299,7120663.408566

2025-01-26 15:57:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:57:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:57:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:57:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-26 15:57:09 - snowflake.connector.connection - INFO - closed
2025-01-26 15:57:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:57:09 - root - INFO - SQL:
-- Corrected SQL 4:
SELECT APPROX_PERCENTILE("totrevenue", 0.5) AS "median_revenue"
FROM IRS_990.IRS_990.IRS_990_2015
WHERE "totrevenue" > 0
Results:
median_revenue
422785.4010380951

2025-01-26 15:57:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:57:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:57:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:57:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-26 15:57:11 - snowflake.connector.connection - INFO - closed
2025-01-26 15:57:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:57:11 - root - INFO - SQL:
-- Corrected SQL 5:
SELECT APPROX_PERCENTILE("totfuncexpns", 0.5) AS "median_expenses"
FROM IRS_990.IRS_990.IRS_990_2016
WHERE "totfuncexpns" > 0
Results:
median_expenses
394883.98098260164

2025-01-26 15:57:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:57:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:57:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:57:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:57:13 - snowflake.connector.connection - INFO - closed
2025-01-26 15:57:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:57:13 - root - INFO - SQL:
-- Corrected SQL 6:
SELECT "ein", "totrevenue"
FROM IRS_990.IRS_990.IRS_990_2017
WHERE "totrevenue" IS NOT NULL AND "totrevenue" > 0
ORDER BY "totrevenue" DESC
LIMIT 100
Results:
ein,totrevenue
941340523,51065716534
941105628,24251778809
208295721,11695858422
900656139,11297001725
941196203,10193378790
390123480,9680842150
390123480,9587415035
912153073,8907956801
113153422,8438339064
720502505,7216705808
941156365,6965956577
311143265,6440829493
450233470,6326720478
231352685,6286195000
520595110,6046472000
135562308,6043438258
133783732,6011909761
510216586,5953431215
941461312,5859550187
942854057,5619049200
133957095,5317043380
416011702,5152134383
980380092,5128139561
131828429,4931402574
951642394,4895423051
60646973,4807997730
314379427,4789153691
110303001,4780943595
135598093,4708225588
753052953,4658343974
611649250,4629361219
364724966,4620705638
362169147,4581585962
42103580,4458905923
431491162,4381625623
150532082,4369242548
741152597,4282066839
710569421,4236821221
311161086,4226007193
363261413,4103552249
42103594,3961420000
912154267,3938149398
840591617,3805780718
930798039,3757404559
351955872,3721532076
946174066,3705341644
453791176,3621661130
580566256,3589561177
131740114,3583255101
980123241,3557087000
440545275,3539081870
900059117,3535304000
382359234,3509403557
133971298,3507764725
410991680,3487488197
362154936,3452950120
520954463,3414413304
951644600,3319765238
590624458,3316774822
362177139,3244736644
160743209,3231905703
311774905,3231802694
910511770,3229090548
430653611,3185323683
562070036,3133177470
203674498,3126468204
611740292,3046771758
351330472,2877065236
581954432,2874233046
362167817,2833160505
381357020,2830348248
951643307,2793425000
560532129,2786082190
134115686,2785766626
951684089,2760691880
60646652,2709762778
381459362,2705865475
821406555,2686418339
382715520,2682911106
870409820,2681376558
530196605,2676037116
113601529,2668766064
314394942,2643979320
112241326,2634373351
900424876,2621279561
530196605,2618203252
540620889,2586420494
136171197,2583763337
651301877,2577123705
42932021,2564072884
411242261,2538424327
42674079,2526498562
141640868,2520075502
210634501,2495283000
910939479,2492720447
10649794,2490406503
382113393,2481440397
111562701,2467441460
131624096,2450589608
363673599,2437618536

2025-01-26 15:57:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:57:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:57:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:57:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:57:14 - snowflake.connector.connection - INFO - closed
2025-01-26 15:57:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:57:15 - root - INFO - SQL:
-- Corrected SQL 7:
SELECT "ein", "totrevenue", "totfuncexpns"
FROM IRS_990.IRS_990.IRS_990_2013
WHERE "totrevenue" > 1000000 AND "totfuncexpns" IS NOT NULL
LIMIT 100
Results:
ein,totrevenue,totfuncexpns
522385104,2208052,2288933
246021385,2371701,2383014
990213908,2666924,2834679
716076840,3219672,2564742
866052021,27339091,27800070
237122650,16381263,16764161
436158894,6610202,7034850
592719781,2201691,2216131
200946697,14993695,16159574
222842803,3443245,1879670
316064918,15930768,18203624
450493921,6604819,6777747
656088549,3348829,3752811
990269654,1008046,871965
436921041,1031181,369846
363489253,214551238,195393298
776224948,1322214,2072342
876128290,12409053,12266479
910853746,1682092,1586537
943048491,1341052,1326458
366191936,1458359,1453804
942375212,26101547,26133951
522305267,1275783,1112593
931204757,19654326,17979683
596134291,2082021,2039803
920018710,5409934,5740392
996046220,2386777,2182007
133810146,22164086,12589344
526047277,4298181,4140864
237104346,5067764,4823367
481165594,18504372,12629291
363978082,127539621,63861951
956049026,35416411,36014678
760681919,2772557,2105631
586054909,1270672,1215381
942919522,3465685,3206559
454737931,3787250,3360339
930948165,1414524,1374291
237000786,6670745,5393596
521118310,1527020396,1522495405
581910292,9061902,8585540
541546353,1255755,1258315
522256239,1297766,1133793
261218705,2359535,2321592
411954568,1289426,1474338
954020047,1433843,1427948
351444018,3661893,9073779
956134346,11394989,11246905
941229312,13505575,13982208
481084624,1656869,1604085
232196792,2863882,2863532
391969371,1775745,1592803
541812682,13942614,13208979
131928934,1296976,1235079
646034464,1357896,1159367
201872707,1033807,874697
870221322,12403651,11994949
383544316,9212075,8602584
680482902,1365342,1305109
237237228,3146014,3267663
411700724,3209683,3163890
520215218,30072782,26575981
411312839,17740618,16627962
522045099,14163102,14920558
251809780,657249964,689935296
621238720,18813104,20910842
582058681,1064051,1029929
133521368,9773461,10183477
752097176,1882785,1573005
222485816,1540680,1582177
846029106,7776583,8718493
880244888,15112927,14990548
943315557,3890059,2948031
232538149,1666455,885545
204874222,1712925,1786323
237228745,1213216,1110129
340967541,2472449,2031007
430821255,2084383,1032950
310991778,1059423,1038416
591872564,1168717,1069883
237081446,1140483,1088230
381969682,1290344,1171460
530143440,6289314,5620094
870281095,1099695,1065070
940577476,1207890,1134238
590816175,2289521,2148308
526279969,19299318,19751872
223644482,1544220,1968826
237086241,2129244,2221592
232121745,4564265,3884556
943192137,3285605,2412868
562256710,2017388,2026386
990054398,4295137,1291247
520978073,3776530,3458574
581048245,1183644,1232286
680224404,3266635,3418298
942856557,2226012,2105822
237155858,2175735,2189938
941108767,1119405,1075802
581030868,1447382,1485934

2025-01-26 15:57:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:57:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:57:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:57:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:57:16 - snowflake.connector.connection - INFO - closed
2025-01-26 15:57:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:57:17 - root - INFO - SQL:
-- Corrected SQL 8:
SELECT "ein", "totrevenue", "totfuncexpns"
FROM IRS_990.IRS_990.IRS_990_2014
WHERE "totrevenue" = "totfuncexpns" AND "totrevenue" IS NOT NULL AND "totfuncexpns" IS NOT NULL
LIMIT 100
Results:
ein,totrevenue,totfuncexpns
30553373,558342,558342
451336988,0,0
510188161,0,0
200076089,45735,45735
610133681,28996896,28996896
954059206,172437916,172437916
452744612,0,0
610337665,46840538,46840538
203288155,302650,302650
204639376,0,0
371532145,0,0
470943243,78677,78677
611509925,0,0
582066628,107308,107308
454671066,0,0
522021524,300101,300101
580246393,335584379,335584379
746182445,25093831,25093831
452280259,1010382,1010382
746211197,8364076,8364076
136116925,704565,704565
980031619,0,0
610169533,49799493,49799493
161644265,12609061,12609061
161742945,0,0
311540949,3886671,3886671
113773485,33000,33000
311768219,0,0
314411236,0,0
316041648,0,0
161658496,105,105
310785627,0,0
203756610,5711201,5711201
951684088,389057,389057
941339061,102801,102801
440518478,9487868,9487868
383878194,0,0
202979705,0,0
202979705,0,0
742604981,316353,316353
200672290,27000,27000
411836633,0,0
161000644,130926,130926
201536108,0,0
800920436,0,0
300021927,600,600
320204732,718220,718220
611245048,305044,305044
571142879,0,0
930412495,0,0
943399181,0,0
232028429,0,0
610329022,111605272,111605272
431948188,136449557,136449557
582587017,339929,339929
610235235,53069299,53069299
610158153,52751280,52751280
261471973,1650612,1650612
461501498,8400,8400
270932860,0,0
770471097,1116000,1116000
562570681,241486750,241486750
462168397,165816,165816
237097074,0,0
237584567,0,0
593816915,0,0
352476219,0,0
352390578,0,0
562023076,144083,144083
300597868,0,0
223608014,0,0
263711540,0,0
461741319,0,0
363817205,0,0
270932860,0,0
364705734,0,0
201283731,34670,34670
454739977,71862,71862
651197113,14995,14995
20724111,0,0
860653597,0,0
736105486,0,0
452208063,0,0
260190411,0,0
461720046,0,0
203633491,60,60
631130709,895203,895203
461741319,0,0
461741319,0,0
464187400,15433,15433
453070854,0,0
272195933,98064,98064
320394740,0,0
203949698,0,0
562331329,309250,309250
461012984,146853,146853
204704132,0,0
204704132,0,0
141843575,0,0
800481425,0,0

2025-01-26 15:57:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:57:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:57:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:57:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:57:18 - snowflake.connector.connection - INFO - closed
2025-01-26 15:57:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:57:19 - root - INFO - SQL:
-- Corrected SQL 9:
SELECT "subseccd", "totrevenue", "totfuncexpns"
FROM IRS_990.IRS_990.IRS_990_2015
WHERE "totrevenue" IS NOT NULL AND "totfuncexpns" IS NOT NULL AND "totrevenue" > 0 AND "totfuncexpns" > 0
LIMIT 100
Results:
subseccd,totrevenue,totfuncexpns
3,1903520,1921326
10,224671,323423
3,289696,303087
3,1057493,1045337
3,984708,866952
7,2430260,2199928
3,153512,114525
6,2342339,2579589
2,153758,153758
3,3017692,5432604
3,82088,128669
3,114075,129146
7,876456,863379
3,789503,699720
3,112680,28263
3,608511,116562
3,54868,69959
5,656183,681175
3,40000,45855
3,958458,986247
13,114405,181706
7,353231,313621
3,535566,396287
3,106129,59479
3,420687,86555
3,707973,387448
19,301999,299683
3,273774,269182
3,1285782,1267001
3,35467,51829
3,721084,781071
3,458555,450336
3,225096,205780
3,3025258,3022646
6,631675,537066
3,455860,470624
6,513080,565982
3,87550,88884
3,101666,136996
6,681530,641708
3,221066,400093
3,100851,43840
3,255911,46068
3,154960,137865
3,4653214,5874635
3,746082,642103
3,1290966,1117835
3,162728,92414
3,165326,144820
3,135340,142348
13,409363,395816
3,201672,88556
3,205302,181358
4,170648,177626
3,647090,92327
3,3839082,5588797
3,875056,1077892
13,116450,77596
3,382701,243741
9,158656,88741
3,441242,368133
3,1222774,1305463
4,963271,959680
3,4462845,4146969
4,540200,522483
2,112586,80362
3,106055,193911
3,78894,40008
3,149152,148761
3,11911,85
3,34736,42545
3,152442,305289
3,898262,839459
3,2107196,2069830
3,99376,47545
3,1186074,1227995
3,282428,197658
7,251133,239130
4,147584,110724
6,801528,713862
3,261486,162415
3,2249885,2108280
3,1159188,1196205
3,125435,122002
9,87424,44031
3,326711,378285
3,63256,93076
3,670272,450993
3,919714,850984
13,127388,162441
3,841333,893133
7,98740,91795
3,340537,365890
2,78669,130332
7,678506,467217
3,2068181,2127693
3,251168,288351
3,89897,12016
3,817043,689491
3,7278575,7712929

2025-01-26 15:57:19 - root - INFO - itercount: 0
2025-01-26 15:57:19 - root - INFO - Database Name: IRS_990
Schema Name: IRS_990
DDL describes table information.
,0
table_name,IRS_990_2012
description,
DDL,"create or replace TABLE IRS_990_2012 (
	""ein"" VARCHAR(16777216),
	""tax_pd"" VARCHAR(16777216),
	""subseccd"" VARCHAR(16777216),
	""unrelbusinccd"" VARCHAR(16777216),
	""initiationfees"" NUMBER(38,0),
	""grsrcptspublicuse"" NUMBER(38,0),
	""grsincmembers"" NUMBER(38,0),
	""grsincother"" NUMBER(38,0),
	""totcntrbgfts"" NUMBER(38,0),
	""totprgmrevnue"" NUMBER(38,0),
	""invstmntinc"" NUMBER(38,0),
	""txexmptbndsproceeds"" NUMBER(38,0),
	""royaltsinc"" NUMBER(38,0),
	""grsrntsreal"" NUMBER(38,0),
	""grsrntsprsnl"" NUMBER(38,0),
	""rntlexpnsreal"" NUMBER(38,0),
	""rntlexpnsprsnl"" NUMBER(38,0),
	""rntlincreal"" NUMBER(38,0),
	""rntlincprsnl"" NUMBER(38,0),
	""netrntlinc"" NUMBER(38,0),
	""grsalesecur"" NUMBER(38,0),
	""grsalesothr"" NUMBER(38,0),
	""cstbasisecur"" NUMBER(38,0),
	""cstbasisothr"" NUMBER(38,0),
	""gnlsecur"" NUMBER(38,0),
	""gnlsothr"" NUMBER(38,0),
	""netgnls"" NUMBER(38,0),
	""grsincfndrsng"" NUMBER(38,0),
	""lessdirfndrsng"" NUMBER(38,0),
	""netincfndrsng"" NUMBER(38,0),
	""grsincgaming"" NUMBER(38,0),
	""lessdirgaming"" NUMBER(38,0),
	""netincgaming"" NUMBER(38,0),
	""grsalesinvent"" NUMBER(38,0),
	""lesscstofgoods"" NUMBER(38,0),
	""netincsales"" NUMBER(38,0),
	""miscrevtot11e"" NUMBER(38,0),
	""totrevenue"" NUMBER(38,0),
	""compnsatncurrofcr"" NUMBER(38,0),
	""othrsalwages"" NUMBER(38,0),
	""payrolltx"" NUMBER(38,0),
	""profndraising"" NUMBER(38,0),
	""totfuncexpns"" NUMBER(38,0),
	""totassetsend"" NUMBER(38,0),
	""txexmptbndsend"" NUMBER(38,0),
	""secrdmrtgsend"" NUMBER(38,0),
	""unsecurednotesend"" NUMBER(38,0),
	""totliabend"" NUMBER(38,0),
	""retainedearnend"" NUMBER(38,0),
	""totnetassetend"" NUMBER(38,0),
	""nonpfrea"" VARCHAR(16777216),
	""gftgrntsrcvd170"" NUMBER(38,0),
	""txrevnuelevied170"" NUMBER(38,0),
	""srvcsval170"" NUMBER(38,0),
	""grsinc170"" NUMBER(38,0),
	""grsrcptsrelated170"" NUMBER(38,0),
	""totgftgrntrcvd509"" NUMBER(38,0),
	""grsrcptsadmissn509"" NUMBER(38,0),
	""txrevnuelevied509"" NUMBER(38,0),
	""srvcsval509"" NUMBER(38,0),
	""subtotsuppinc509"" NUMBER(38,0),
	""totsupp509"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['IRS_990_2012', 'IRS_990_2016', 'IRS_990_2013', 'IRS_990_2014', 'IRS_990_2017', 'IRS_990_2015']
,1
table_name,IRS_990_EZ_2015
description,
DDL,"create or replace TABLE IRS_990_EZ_2015 (
	""ein"" VARCHAR(16777216),
	""elf"" VARCHAR(16777216),
	""tax_pd"" NUMBER(38,0),
	""subseccd"" NUMBER(38,0),
	""totcntrbs"" NUMBER(38,0),
	""prgmservrev"" NUMBER(38,0),
	""duesassesmnts"" NUMBER(38,0),
	""othrinvstinc"" NUMBER(38,0),
	""grsamtsalesastothr"" NUMBER(38,0),
	""basisalesexpnsothr"" NUMBER(38,0),
	""gnsaleofastothr"" NUMBER(38,0),
	""grsincgaming"" NUMBER(38,0),
	""grsrevnuefndrsng"" NUMBER(38,0),
	""direxpns"" NUMBER(38,0),
	""netincfndrsng"" NUMBER(38,0),
	""grsalesminusret"" NUMBER(38,0),
	""costgoodsold"" NUMBER(38,0),
	""grsprft"" NUMBER(38,0),
	""othrevnue"" NUMBER(38,0),
	""totrevnue"" NUMBER(38,0),
	""totexpns"" NUMBER(38,0),
	""totexcessyr"" NUMBER(38,0),
	""othrchgsnetassetfnd"" NUMBER(38,0),
	""networthend"" NUMBER(38,0),
	""totassetsend"" NUMBER(38,0),
	""totliabend"" NUMBER(38,0),
	""totnetassetsend"" NUMBER(38,0),
	""actvtynotprevrptcd"" VARCHAR(16777216),
	""chngsinorgcd"" VARCHAR(16777216),
	""unrelbusincd"" VARCHAR(16777216),
	""filedf990tcd"" VARCHAR(16777216),
	""contractioncd"" VARCHAR(16777216),
	""politicalexpend"" NUMBER(38,0),
	""filedf1120polcd"" VARCHAR(16777216),
	""loanstoofficerscd"" VARCHAR(16777216),
	""loanstoofficers"" NUMBER(38,0),
	""initiationfee"" NUMBER(38,0),
	""grspublicrcpts"" NUMBER(38,0),
	""s4958excessbenefcd"" VARCHAR(16777216),
	""prohibtdtxshltrcd"" VARCHAR(16777216),
	""nonpfrea"" NUMBER(38,0),
	""totnooforgscnt"" NUMBER(38,0),
	""totsupport"" NUMBER(38,0),
	""gftgrntsrcvd170"" NUMBER(38,0),
	""txrevnuelevied170"" NUMBER(38,0),
	""srvcsval170"" NUMBER(38,0),
	""pubsuppsubtot170"" NUMBER(38,0),
	""exceeds2pct170"" NUMBER(38,0),
	""pubsupplesspct170"" NUMBER(38,0),
	""samepubsuppsubtot170"" NUMBER(38,0),
	""grsinc170"" NUMBER(38,0),
	""netincunreltd170"" NUMBER(38,0),
	""othrinc170"" NUMBER(38,0),
	""totsupp170"" NUMBER(38,0),
	""grsrcptsrelated170"" NUMBER(38,0),
	""totgftgrntrcvd509"" NUMBER(38,0),
	""grsrcptsadmissn509"" NUMBER(38,0),
	""grsrcptsactivities509"" NUMBER(38,0),
	""txrevnuelevied509"" NUMBER(38,0),
	""srvcsval509"" NUMBER(38,0),
	""pubsuppsubtot509"" NUMBER(38,0),
	""rcvdfrmdisqualsub509"" NUMBER(38,0),
	""exceeds1pct509"" NUMBER(38,0),
	""subtotpub509"" NUMBER(38,0),
	""pubsupplesub509"" NUMBER(38,0),
	""samepubsuppsubtot509"" NUMBER(38,0),
	""grsinc509"" NUMBER(38,0),
	""unreltxincls511tx509"" NUMBER(38,0),
	""subtotsuppinc509"" NUMBER(38,0),
	""netincunrelatd509"" NUMBER(38,0),
	""othrinc509"" NUMBER(38,0),
	""totsupp509"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['IRS_990_EZ_2015', 'IRS_990_EZ_2013', 'IRS_990_EZ_2016', 'IRS_990_EZ_2012', 'IRS_990_EZ_2017', 'IRS_990_EZ_2014']
,2
table_name,IRS_990_PF_2015
description,
DDL,"create or replace TABLE IRS_990_PF_2015 (
	""ein"" VARCHAR(16777216),
	""elf"" VARCHAR(16777216),
	""tax_prd"" VARCHAR(16777216),
	""eostatus"" VARCHAR(16777216),
	""tax_yr"" NUMBER(38,0),
	""operatingcd"" VARCHAR(16777216),
	""subcd"" VARCHAR(16777216),
	""fairmrktvalamt"" NUMBER(38,0),
	""grscontrgifts"" NUMBER(38,0),
	""schedbind"" VARCHAR(16777216),
	""intrstrvnue"" NUMBER(38,0),
	""dividndsamt"" NUMBER(38,0),
	""grsrents"" NUMBER(38,0),
	""grsslspramt"" NUMBER(38,0),
	""costsold"" NUMBER(38,0),
	""grsprofitbus"" NUMBER(38,0),
	""otherincamt"" NUMBER(38,0),
	""totrcptperbks"" NUMBER(38,0),
	""compofficers"" NUMBER(38,0),
	""pensplemplbenf"" NUMBER(38,0),
	""legalfeesamt"" NUMBER(38,0),
	""accountingfees"" NUMBER(38,0),
	""interestamt"" NUMBER(38,0),
	""depreciationamt"" NUMBER(38,0),
	""occupancyamt"" NUMBER(38,0),
	""travlconfmtngs"" NUMBER(38,0),
	""printingpubl"" NUMBER(38,0),
	""topradmnexpnsa"" NUMBER(38,0),
	""contrpdpbks"" NUMBER(38,0),
	""totexpnspbks"" NUMBER(38,0),
	""excessrcpts"" NUMBER(38,0),
	""totrcptnetinc"" NUMBER(38,0),
	""topradmnexpnsb"" NUMBER(38,0),
	""totexpnsnetinc"" NUMBER(38,0),
	""netinvstinc"" NUMBER(38,0),
	""trcptadjnetinc"" NUMBER(38,0),
	""totexpnsadjnet"" NUMBER(38,0),
	""adjnetinc"" NUMBER(38,0),
	""topradmnexpnsd"" NUMBER(38,0),
	""totexpnsexempt"" NUMBER(38,0),
	""othrcashamt"" NUMBER(38,0),
	""invstgovtoblig"" NUMBER(38,0),
	""invstcorpstk"" NUMBER(38,0),
	""invstcorpbnd"" NUMBER(38,0),
	""totinvstsec"" NUMBER(38,0),
	""mrtgloans"" NUMBER(38,0),
	""othrinvstend"" NUMBER(38,0),
	""othrassetseoy"" NUMBER(38,0),
	""totassetsend"" NUMBER(38,0),
	""mrtgnotespay"" NUMBER(38,0),
	""othrliabltseoy"" NUMBER(38,0),
	""totliabend"" NUMBER(38,0),
	""tfundnworth"" NUMBER(38,0),
	""fairmrktvaleoy"" NUMBER(38,0),
	""totexcapgnls"" NUMBER(38,0),
	""totexcapgn"" NUMBER(38,0),
	""totexcapls"" NUMBER(38,0),
	""invstexcisetx"" NUMBER(38,0),
	""sec4940notxcd"" VARCHAR(16777216),
	""sec4940redtxcd"" VARCHAR(16777216),
	""sect511tx"" NUMBER(38,0),
	""subtitleatx"" NUMBER(38,0),
	""totaxpyr"" NUMBER(38,0),
	""esttaxcr"" NUMBER(38,0),
	""txwithldsrc"" NUMBER(38,0),
	""txpaidf2758"" NUMBER(38,0),
	""erronbkupwthld"" NUMBER(38,0),
	""estpnlty"" NUMBER(38,0),
	""taxdue"" NUMBER(38,0),
	""overpay"" NUMBER(38,0),
	""crelamt"" NUMBER(38,0),
	""infleg"" VARCHAR(16777216),
	""actnotpr"" VARCHAR(16777216),
	""chgnprvrptcd"" VARCHAR(16777216),
	""filedf990tcd"" VARCHAR(16777216),
	""contractncd"" VARCHAR(16777216),
	""furnishcpycd"" VARCHAR(16777216),
	""claimstatcd"" VARCHAR(16777216),
	""cntrbtrstxyrcd"" VARCHAR(16777216),
	""distribdafcd"" VARCHAR(16777216),
	""orgcmplypubcd"" VARCHAR(16777216),
	""filedlf1041ind"" VARCHAR(16777216),
	""propexchcd"" VARCHAR(16777216),
	""brwlndmnycd"" VARCHAR(16777216),
	""furngoodscd"" VARCHAR(16777216),
	""paidcmpncd"" VARCHAR(16777216),
	""transfercd"" VARCHAR(16777216),
	""agremkpaycd"" VARCHAR(16777216),
	""exceptactsind"" VARCHAR(16777216),
	""prioractvcd"" VARCHAR(16777216),
	""undistrinccd"" VARCHAR(16777216),
	""applyprovind"" VARCHAR(16777216),
	""dirindirintcd"" VARCHAR(16777216),
	""excesshldcd"" VARCHAR(16777216),
	""invstjexmptcd"" VARCHAR(16777216),
	""prevjexmptcd"" VARCHAR(16777216),
	""propgndacd"" VARCHAR(16777216),
	""ipubelectcd"" VARCHAR(16777216),
	""grntindivcd"" VARCHAR(16777216),
	""nchrtygrntcd"" VARCHAR(16777216),
	""nreligiouscd"" VARCHAR(16777216),
	""excptransind"" VARCHAR(16777216),
	""rfprsnlbnftind"" VARCHAR(16777216),
	""pyprsnlbnftind"" VARCHAR(16777216),
	""tfairmrktunuse"" NUMBER(38,0),
	""valncharitassets"" NUMBER(38,0),
	""cmpmininvstret"" NUMBER(38,0),
	""distribamt"" NUMBER(38,0),
	""undistribincyr"" NUMBER(38,0),
	""adjnetinccola"" NUMBER(38,0),
	""adjnetinccolb"" NUMBER(38,0),
	""adjnetinccolc"" NUMBER(38,0),
	""adjnetinccold"" NUMBER(38,0),
	""adjnetinctot"" NUMBER(38,0),
	""qlfydistriba"" NUMBER(38,0),
	""qlfydistribb"" NUMBER(38,0),
	""qlfydistribc"" NUMBER(38,0),
	""qlfydistribd"" NUMBER(38,0),
	""qlfydistribtot"" NUMBER(38,0),
	""valassetscola"" NUMBER(38,0),
	""valassetscolb"" NUMBER(38,0),
	""valassetscolc"" NUMBER(38,0),
	""valassetscold"" NUMBER(38,0),
	""valassetstot"" NUMBER(38,0),
	""qlfyasseta"" NUMBER(38,0),
	""qlfyassetb"" NUMBER(38,0),
	""qlfyassetc"" NUMBER(38,0),
	""qlfyassetd"" NUMBER(38,0),
	""qlfyassettot"" NUMBER(38,0),
	""endwmntscola"" NUMBER(38,0),
	""endwmntscolb"" NUMBER(38,0),
	""endwmntscolc"" NUMBER(38,0),
	""endwmntscold"" NUMBER(38,0),
	""endwmntstot"" NUMBER(38,0),
	""totsuprtcola"" NUMBER(38,0),
	""totsuprtcolb"" NUMBER(38,0),
	""totsuprtcolc"" NUMBER(38,0),
	""totsuprtcold"" NUMBER(38,0),
	""totsuprttot"" NUMBER(38,0),
	""pubsuprtcola"" NUMBER(38,0),
	""pubsuprtcolb"" NUMBER(38,0),
	""pubsuprtcolc"" NUMBER(38,0),
	""pubsuprtcold"" NUMBER(38,0),
	""pubsuprttot"" NUMBER(38,0),
	""grsinvstinca"" NUMBER(38,0),
	""grsinvstincb"" NUMBER(38,0),
	""grsinvstincc"" NUMBER(38,0),
	""grsinvstincd"" NUMBER(38,0),
	""grsinvstinctot"" NUMBER(38,0),
	""grntapprvfut"" NUMBER(38,0),
	""progsrvcacold"" NUMBER(38,0),
	""progsrvcacole"" NUMBER(38,0),
	""progsrvcbcold"" NUMBER(38,0),
	""progsrvcbcole"" NUMBER(38,0),
	""progsrvcccold"" NUMBER(38,0),
	""progsrvcccole"" NUMBER(38,0),
	""progsrvcdcold"" NUMBER(38,0),
	""progsrvcdcole"" NUMBER(38,0),
	""progsrvcecold"" NUMBER(38,0),
	""progsrvcecole"" NUMBER(38,0),
	""progsrvcfcold"" NUMBER(38,0),
	""progsrvcfcole"" NUMBER(38,0),
	""progsrvcgcold"" NUMBER(38,0),
	""progsrvcgcole"" NUMBER(38,0),
	""membershpduesd"" NUMBER(38,0),
	""membershpduese"" NUMBER(38,0),
	""intonsvngsd"" NUMBER(38,0),
	""intonsvngse"" NUMBER(38,0),
	""dvdndsintd"" NUMBER(38,0),
	""dvdndsinte"" NUMBER(38,0),
	""trnsfrcashcd"" VARCHAR(16777216),
	""trnsothasstscd"" VARCHAR(16777216),
	""salesasstscd"" VARCHAR(16777216),
	""prchsasstscd"" VARCHAR(16777216),
	""rentlsfacltscd"" VARCHAR(16777216),
	""reimbrsmntscd"" VARCHAR(16777216),
	""loansguarcd"" VARCHAR(16777216),
	""perfservicescd"" VARCHAR(16777216),
	""sharngasstscd"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['IRS_990_PF_2015', 'IRS_990_PF_2016', 'IRS_990_PF_2012', 'IRS_990_PF_2014', 'IRS_990_PF_2013']
,3
table_name,IRS_990_EIN
description,
DDL,"create or replace TABLE IRS_990_EIN (
	""ein"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""ico"" VARCHAR(16777216),
	""street"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip"" VARCHAR(16777216),
	""group"" NUMBER(38,0),
	""subsection"" NUMBER(38,0),
	""affiliation"" NUMBER(38,0),
	""classification"" NUMBER(38,0),
	""ruling"" NUMBER(38,0),
	""deductibility"" NUMBER(38,0),
	""foundation"" NUMBER(38,0),
	""activity"" NUMBER(38,0),
	""organization"" NUMBER(38,0),
	""status"" NUMBER(38,0),
	""tax_period"" NUMBER(38,0),
	""asset_cd"" NUMBER(38,0),
	""income_cd"" NUMBER(38,0),
	""filing_req_cd"" NUMBER(38,0),
	""pf_filing_req_cd"" NUMBER(38,0),
	""acct_pd"" NUMBER(38,0),
	""asset_amt"" NUMBER(38,0),
	""income_amt"" NUMBER(38,0),
	""revenue_amt"" NUMBER(38,0),
	""ntee_cd"" VARCHAR(16777216),
	""sort_name"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'IRS_990': {'IRS_990': ['IRS_990_2012', 'IRS_990_2013', 'IRS_990_2014', 'IRS_990_2015', 'IRS_990_2016', 'IRS_990_2017', 'IRS_990_EIN', 'IRS_990_EZ_2012', 'IRS_990_EZ_2013', 'IRS_990_EZ_2014', 'IRS_990_EZ_2015', 'IRS_990_EZ_2016', 'IRS_990_EZ_2017', 'IRS_990_PF_2012', 'IRS_990_PF_2013', 'IRS_990_PF_2014', 'IRS_990_PF_2015', 'IRS_990_PF_2016']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Tables:**
  - `IRS_990_2012`, `IRS_990_2013`, `IRS_990_2014`, `IRS_990_2015`, `IRS_990_2016`, `IRS_990_2017` from the `IRS_990` database and `IRS_990` schema. These tables contain data for organizations filing IRS 990 forms from 2012 to 2017.

- **Columns:**
  - `"totrevenue"`: Potential usage - Represents the total revenue of organizations; used to calculate median revenue.
  - `"totfuncexpns"`: Potential usage - Represents the total functional expenses; used to calculate median functional expenses.
  - `"tax_pd"`: Potential usage - Tax period; can be used to verify the year of filing.
  - `"ein"`: Potential usage - Employer Identification Number; useful for identifying unique organizations.

**Conditions That May Be Used:**

- Exclude records where `"totrevenue"` or `"totfuncexpns"` are `NULL` or zero to ensure accurate median calculations.
- Limit queries to specific years by selecting from the corresponding yearly tables.
- Use `ABS("totrevenue" - "totfuncexpns")` to calculate the absolute difference between revenue and expenses.
- Use `DISTINCT` to eliminate duplicate records if necessary.

**Sample SQL Queries:**

1. **Retrieve Total Revenue for 2012:**
   ```sql
   SELECT "totrevenue"
   FROM IRS_990.IRS_990.IRS_990_2012
   LIMIT 100;
   ```

2. **Retrieve Distinct Total Revenues for 2012:**
   ```sql
   SELECT DISTINCT "totrevenue"
   FROM IRS_990.IRS_990.IRS_990_2012
   LIMIT 100;
   ```

3. **Retrieve Total Functional Expenses for 2013 (Non-Null Values):**
   ```sql
   SELECT "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2013
   WHERE "totfuncexpns" IS NOT NULL
   LIMIT 100;
   ```

4. **Retrieve Revenue and Expenses Where Both Are Greater Than Zero for 2014:**
   ```sql
   SELECT "totrevenue", "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2014
   WHERE "totrevenue" > 0 AND "totfuncexpns" > 0
   LIMIT 100;
   ```

5. **Retrieve Revenue and Expenses for 2015:**
   ```sql
   SELECT "totrevenue", "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2015
   LIMIT 100;
   ```

6. **Retrieve EIN, Revenue, and Expenses for Non-Null Values in 2016:**
   ```sql
   SELECT "ein", "totrevenue", "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2016
   WHERE "totrevenue" IS NOT NULL AND "totfuncexpns" IS NOT NULL
   LIMIT 100;
   ```

7. **Calculate Difference Between Revenue and Expenses for 2017:**
   ```sql
   SELECT "ein", "totrevenue" - "totfuncexpns" AS "difference"
   FROM IRS_990.IRS_990.IRS_990_2017
   LIMIT 100;
   ```

8. **Calculate Absolute Difference Between Revenue and Expenses for 2012:**
   ```sql
   SELECT "ein", ABS("totrevenue" - "totfuncexpns") AS "abs_difference"
   FROM IRS_990.IRS_990.IRS_990_2012
   WHERE "totrevenue" IS NOT NULL AND "totfuncexpns" IS NOT NULL
   LIMIT 100;
   ```

9. **Count Records with Non-Null Revenue and Expenses for 2012:**
   ```sql
   SELECT COUNT(*)
   FROM IRS_990.IRS_990.IRS_990_2012
   WHERE "totrevenue" IS NOT NULL AND "totfuncexpns" IS NOT NULL;
   ```

10. **Retrieve Tax Period, Revenue, and Expenses for 2014:**
    ```sql
    SELECT "tax_pd", "totrevenue", "totfuncexpns"
    FROM IRS_990.IRS_990.IRS_990_2014
    LIMIT 100;
    ```

11. **Retrieve Organizations with Zero Expenses in 2015:**
    ```sql
    SELECT "ein", "totrevenue", "totfuncexpns"
    FROM IRS_990.IRS_990.IRS_990_2015
    WHERE "totfuncexpns" = 0
    LIMIT 100;
    ```

12. **Retrieve Revenue and Expenses Sorted by Revenue for 2016:**
    ```sql
    SELECT "totrevenue", "totfuncexpns"
    FROM IRS_990.IRS_990.IRS_990_2016
    ORDER BY "totrevenue" DESC
    LIMIT 100;
    ```

13. **Retrieve Records Where Expenses Exceed Revenue in 2017:**
    ```sql
    SELECT "ein", "totrevenue", "totfuncexpns"
    FROM IRS_990.IRS_990.IRS_990_2017
    WHERE "totfuncexpns" > "totrevenue"
    LIMIT 100;
    ```

14. **Retrieve Average Revenue and Expenses for 2014:**
    ```sql
    SELECT AVG("totrevenue") AS "avg_revenue", AVG("totfuncexpns") AS "avg_expenses"
    FROM IRS_990.IRS_990.IRS_990_2014;
    ```

15. **Retrieve Median Revenue for 2015 (Using Approximate Median Function):**
    ```sql
    SELECT APPROX_PERCENTILE("totrevenue", 0.5) AS "median_revenue"
    FROM IRS_990.IRS_990.IRS_990_2015
    WHERE "totrevenue" IS NOT NULL;
    ```

16. **Retrieve Median Expenses for 2016 (Using Approximate Median Function):**
    ```sql
    SELECT APPROX_PERCENTILE("totfuncexpns", 0.5) AS "median_expenses"
    FROM IRS_990.IRS_990.IRS_990_2016
    WHERE "totfuncexpns" IS NOT NULL;
    ```

17. **Retrieve Top 100 Organizations by Revenue in 2017:**
    ```sql
    SELECT "ein", "totrevenue"
    FROM IRS_990.IRS_990.IRS_990_2017
    ORDER BY "totrevenue" DESC
    LIMIT 100;
    ```

18. **Retrieve Revenue and Expenses for Organizations with Revenue Above a Threshold in 2013:**
    ```sql
    SELECT "ein", "totrevenue", "totfuncexpns"
    FROM IRS_990.IRS_990.IRS_990_2013
    WHERE "totrevenue" > 1000000
    LIMIT 100;
    ```

19. **Retrieve Organizations with Equal Revenue and Expenses in 2014:**
    ```sql
    SELECT "ein", "totrevenue", "totfuncexpns"
    FROM IRS_990.IRS_990.IRS_990_2014
    WHERE "totrevenue" = "totfuncexpns"
    LIMIT 100;
    ```

20. **Retrieve Revenue and Expenses Along with Subsection Code for 2015:**
    ```sql
    SELECT "subseccd", "totrevenue", "totfuncexpns"
    FROM IRS_990.IRS_990.IRS_990_2015
    LIMIT 100;
    ```

These queries help in understanding the distribution of total revenue and functional expenses across different years and organizations, which is essential for calculating the median values and their differences as required by the task.Query:
SELECT "totrevenue"
   FROM IRS_990.IRS_990.IRS_990_2012
   LIMIT 100;
Answer:
totrevenue
615689
123398
339132
184876
194999
208324
110370
294294
252440
231889
816862
374605
2176110
57648
250907
326516
565417
6191901
1259941
368550
6263
887518
554010
1160268
217092
402615
267402
142654
3985749
1014987
214898
132489
404491
6853798
48737
205291
239009
799303
68693
41147
101615
117983
592366
246612
242673
245441
123757
106452
634918
1193694
391600
2334422
247695
162491
4679679
3711792
235470
2898551
153916
527281
1104162
19557978
1951296
4805178
652855
2125329
13852889
1192197
42612778
2812483
160381
1857316
346849
2727976
7554730
774388
11156787
1250968
21248493
493438
24018285
24409280
2730287
22424056
10006131
2221319
105775719
19299093
17980075
70036549
33508177
3183041
2788432
205587007
997037763
2783164
49034556
694874
21623111
2458179
Query:
SELECT DISTINCT "totrevenue"
   FROM IRS_990.IRS_990.IRS_990_2012
   LIMIT 100;
Answer:
totrevenue
339132
184876
208324
110370
1259941
887518
217092
3985749
1014987
132489
404491
6853798
68693
41147
246612
162491
4679679
1951296
4805178
652855
346849
24409280
3284806
531399
57648
142654
214898
101615
1192197
160381
1250968
493438
19299093
70036549
3183041
205587007
997037763
2603875
675478
322665
8578263
2847660
5147065
1999294
10577616
7794572
2094531
2916864
2898551
17980075
9610322
62720757
799983
906952
1782815
7330353
252440
239009
235470
19557978
24018285
49034556
235770
2176110
267402
245441
106452
21623111
3192479
4094881
31905167
86429284
555958
2761170
1465524
677840
48737
21248493
105775719
20020656
2917093
300130
1185514
5639787
2330926
836177
11251331
5006452
40237683
1002120
274250
9759682
752700
253848
24384008
6525159
5757895
10178834
676134
11981902
Query:
SELECT "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2013
   WHERE "totfuncexpns" IS NOT NULL
   LIMIT 100;
Answer:
totfuncexpns
233219
2288933
227663
355579
599928
2383014
2834679
2564742
27800070
16764161
7034850
2216131
16159574
159964
237306
179781
262734
567923
1879670
200209
1203782
335800
18203624
6777747
3752811
871965
369846
195393298
2072342
12266479
1586537
116871
0
28885
537077
115296
114117
258585
116733
278455
232567
247641
304915
82445
123099
318377
197502
40488
1326458
100868
3221
274338
218579
47303
61123
376031
303526
165337
239688
1453804
26133951
1112593
48684
691852
289714
17979683
2039803
5740392
517267
2182007
12589344
4140864
115499
338948
637842
4823367
12629291
63861951
36014678
40401
65527
254977
265657
283175
55551
1188694
88239
96664
53277
10680
184058
220090
251900
874012
77286
2105631
11714
209585
136959
68083
Query:
SELECT "totrevenue", "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2014
   WHERE "totrevenue" > 0 AND "totfuncexpns" > 0
   LIMIT 100;
Answer:
totrevenue,totfuncexpns
367901,351341
729380,971328
477224,449237
353430,336009
82388177,98087140
849237,792009
275493,290146
177440854,161503220
3183975,3746315
493200,494315
13181917,12685986
28652907,28389949
313238,323636
1195340,1113885
100271,158001
296427,646512
1230836,1148693
130369,105905
43720,44964
419928,409092
285670,311219
339287,308258
111416236,106741458
7735580,7947112
238731,213319
59342193,63056539
10261791,10208487
1121907,930946
1665148,193258
34267215,33418482
510309,473139
331643,382445
43536130,46180228
291887,41572
1002022,836380
113170,21114
47461503,8145861
97232,95766
46432,46770
60876457,59156347
232662,248288
53743,30246
236515,255572
8402,33267
4165808,3997553
159913,159950
271262,272948
517048,513335
363530,273843
672823,605984
238110,228806
682623,673707
212338,232028
290511,301039
499727,509816
232398,348357
44085,69135
2975067,2961126
1354702,1401283
231984,174205
299170,256112
378309,400382
20729785,18983172
232819,135828
1143947,1154976
23677418,22419806
68386212,66618557
454743,437272
2501424,2140101
5095977,3654775
611384,549767
1984600,2110183
326417,347417
157208,113059
172053,198769
315934,447101
656322,689409
560989,680232
200180,176118
252300,398603
1085096,857782
257451,257642
33290,35986
318184,305680
1159524,1122535
371737,310401
258475,258579
8048,28954
3238336,3061946
392323,291102
64991,34356
103254,105183
4565617,4238676
4662604,4516974
3615970,3218209
17070927,16753763
2156834,1741005
225010,220758
41950,41475
768970,749698
Query:
SELECT "totrevenue", "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2015
   LIMIT 100;
Answer:
totrevenue,totfuncexpns
79226,10716
69691,46507
565470,594117
919660,876681
196640,197060
287456,272165
1154253,1430994
329502,348482
1061767,670985
744619,636569
612222,575987
82274,427257
306876,290320
94153,133298
98428,68050
505005,244806
37341,27068
1025577,1029167
945745,999468
210093,179073
212718,181273
470522,737360
7501,48490
505289,570585
2032606,1884198
1069654,924002
2838381,3129743
133646,137182
609485,569610
5370,18058
253779,232749
63253,89266
104948,108652
882351,809780
24637,941
155723,123735
64817,88605
106594,60800
279975,193619
226465,207768
328848,355041
124183,107342
816800,797013
100878,72622
190755,139962
24672,52647
1641309,1500961
310359,330017
206001,274282
47417,50076
368629,318900
673623,558674
758987,650023
1582431,1516017
396441,466113
181133,217177
487579,485138
194563,213503
1223061,1163971
83384,86856
22808,46233
87125,95958
80515,128335
647283,610870
535465,363258
772400,817531
286326,302695
1486394,1374849
619001,435669
1854971,1901997
1954243,1793279
38272,36322
1122938,930460
301441,294166
192371,165038
46564,83168
102743,101312
1197018,1109017
66739,54980
768398,761949
897069,853500
291097,234324
124942,107684
161294,98428
174181,174181
920345,873721
86011,97990
105446,84737
194076,181084
63461,205446
221133,147009
1728910,1451817
498912,465316
601096,182145
51364,27895
393324,333606
1081819,1051561
146760,51121
99386,90148
474380,485665
Query:
SELECT "ein", "totrevenue", "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2016
   WHERE "totrevenue" IS NOT NULL AND "totfuncexpns" IS NOT NULL
   LIMIT 100;
Answer:
ein,totrevenue,totfuncexpns
382032501,281124,330710
263010938,235819,238967
942746487,2552190,2669341
112889774,32425648,32098696
263416084,320525,351666
270131664,71895,88763
160820608,324899,254431
680475602,2837482,2807835
411631246,418695,416577
470585186,3588013,3541336
202799021,954519,875799
363032700,2522077,2424594
263817958,213962,195282
720485727,441877,465581
943059287,297098,303187
237075704,8630374,4068797
461720815,401595,0
841606735,812435,825952
113237992,8800916,8804399
590876627,222935,222095
202966170,227088,198487
133008074,14444601,13631662
590626226,497791,414382
710916426,288044,276583
746062862,105620,97393
431307672,1284111,641602
720805656,1835152,1839043
721079718,63799,133204
464691123,454367,375392
911230960,91105,94542
463115731,224728,240526
911296139,64428,80427
421132140,413658,445372
10104905,507249,550897
223576391,93946,63512
731383156,547229,419381
742267667,209016,229679
232133293,280108,255848
510178981,216013,254466
460252876,1798994,1751480
237544345,5626,12614
133976090,71,59091
133559130,3780480,3566181
371307763,432724,382554
650321678,11784947,11725715
841408649,135815,130383
131825916,52800,37588
36010565,32124,26660
810471246,685972,629551
593753956,129973,68528
521792074,1554893,1471006
710615370,120359,137802
751806426,288407,248291
942497039,448341,523784
411618333,241561,239939
742383678,254246,246314
943309906,488981,500976
363526646,110749,237498
237155203,3616528,3612680
237043276,323944,460823
620452087,121076,202241
952480624,19216873,19742993
465215702,844831,931294
956131453,53268,55790
20669356,1631969,1543597
226082961,149544,151816
841149609,5292225,1345468
232595475,80738,164288
270232682,403099,399965
363264898,2775480,2737154
930594506,2280475,2204248
592120945,2180401,1036111
310784671,1004649,1048471
581295404,1216653,1303975
743068174,605128,691163
208675368,165213,141815
363586462,429152,296555
364026048,114657,186185
931329158,26812005,24130681
743041358,248058,226483
520891628,1164303,1349813
382959692,3165282,4348921
364412796,98526,178756
311012363,554244,531574
454845389,115273,119078
510238382,118461,103036
311234216,15771,0
741827630,452171,437574
237174336,99733,70758
274167030,158926,112974
860090134,2797845,2862377
390989783,3986674,4059124
310944769,248791,244005
421375644,390191,159212
161102449,34277,62275
541788059,194544,84289
363431222,629384,627025
621660029,479677,494719
861009613,1357145,1120765
430725282,1168966,1366751
Query:
SELECT "ein", "totrevenue" - "totfuncexpns" AS "difference"
   FROM IRS_990.IRS_990.IRS_990_2017
   LIMIT 100;
Answer:
ein,difference
300189270,3476
263208840,10112
356042156,-22790
760797012,28894
362202370,-25397
60646753,-24434
133643245,62977
43445912,99432
134214040,98490
46112075,119589
710845972,-2415
990347476,24020
742329384,59625
510515711,153452
222485332,422447
753056013,213556
260146595,-4366
223348540,-24012
222147463,23621
341657533,68764
720914730,29112
232013068,3811
314443574,67739
581028915,107737
421038039,48131
592887162,19669
237181129,6069
222484450,37941
237133503,243657
680164659,128387
311707319,193461
42677156,14445
861037570,118131
426603775,143900
43101427,36939
956050121,-66577
220887600,8571
131624065,75497
263653751,-4652
223043823,8069
42214867,43868
42383933,-6892
352246162,-1341891
231572645,18387
232616113,-8261
581393263,8304
10407276,48647
251153389,115718
954612730,-35580
951652837,-39233
420186460,-6484
131825916,-23592
381387795,5774
581716113,1915875
521598836,68763
910647440,84386
363507635,-78199
131740468,17241389
742728646,-152383
237147452,19902
382132707,-15548
134255387,-3747
330288930,-1027525
471129960,-974
720573879,-54366
631235903,99775
510182993,-5840
61423927,19398
382885443,148389
510195211,5001
60885694,22218
710600797,3680
133439360,-27402
742699667,236561
430549665,-13149
451457029,-704207
931248359,88468
237130173,16254
742379318,43570
205146418,26930
300699916,9336
204780320,-285843
870749129,-50362
311552336,159497
310999025,-3367
60868436,-48434
592021472,87990
582224949,260585
270049012,449955
521234660,-21229
560585448,144169
930740519,309548
381200590,30994
43208934,-4195
371606372,5995
10563134,10991
223619206,-13147
592263083,-9288
592828707,-1973642
570822541,15625
Query:
SELECT "ein", ABS("totrevenue" - "totfuncexpns") AS "abs_difference"
   FROM IRS_990.IRS_990.IRS_990_2012
   WHERE "totrevenue" IS NOT NULL AND "totfuncexpns" IS NOT NULL
   LIMIT 100;
Answer:
ein,abs_difference
250972074,203904
222094018,91160
382494084,28065
166094236,22187
231491160,102199
391449048,4640
382494635,3205
942412714,3438
510340553,31899
431860643,44217
411773248,1455
330316219,14459
720924871,2025060
133394305,2289
311090052,33622
911025090,33174
880181824,52811
860673370,26638
431110061,9576
221554536,44014
431488916,1951
133737760,113974
742328963,56281
311617260,110886
593089562,8549
841496701,172318
450339622,15735
841476613,25439
061427346,116603
450233749,6633
742544243,54354
351830590,27718
020468137,13017
860673370,54791
931141006,5517
562663346,19941
742208935,48021
562487490,528334
510183465,32939
161454215,4737
752434783,4955
020624596,49512
112727514,78470
841534209,2055
330776377,8869
742208935,21600
042429428,18014
141625139,26648
600001118,272711
042210747,110259
160866061,97580
132548780,151048
237331116,31263
350899077,9985
591312245,180191
231365194,239738
541136097,8520
132596500,2997890
526054081,15403
231628480,93235
020664475,19760
580566123,2346822
391394068,77447
340819149,486292
560579600,1863
742340423,261845
237042553,5290920
237087247,16493
346516654,280038
720542138,283127
630480594,123664
160743245,87519
911806943,36676
541870905,826002
952788856,633502
810367205,18702
112667021,5438164
237357226,235269
042105780,2818881
010207716,72108
362512404,1801638
131624146,1492235
020260158,406692
060653120,4015258
742431071,5738450
620511893,1033623
580633971,11871835
952543028,103295
590917284,6283181
951648180,5153186
237120898,24388107
941702753,227834
610444762,82308
131624100,25799626
530242652,144342555
111630813,1188648
941156300,5466787
351043456,59316
131675082,9581189
520403670,1183813
Query:
SELECT COUNT(*)
   FROM IRS_990.IRS_990.IRS_990_2012
   WHERE "totrevenue" IS NOT NULL AND "totfuncexpns" IS NOT NULL;
Answer:
COUNT(*)
294019
Query:
SELECT "tax_pd", "totrevenue", "totfuncexpns"
    FROM IRS_990.IRS_990.IRS_990_2014
    LIMIT 100;
Answer:
tax_pd,totrevenue,totfuncexpns
201312,20694,19468
201309,236657,301343
201312,19819,26396
201312,655125,578163
201306,847870,826451
201312,712182,712459
201312,366711,353922
201312,3447721,2909079
201309,2621632,1366326
201312,2871588,2928131
201312,1015877,1001174
201312,863595,530667
201306,51218,153153
201306,1185460,1172599
201312,6830751,6142934
201312,411892,506446
201312,117976,109535
201312,16330,25661
201312,527676,508423
201312,3996068,3814139
201312,31462,15677
201312,110869,75381
201312,196609,192972
201306,4856006,4435095
201306,646143,882350
201312,55653,54446
201306,36255767,37918684
201306,13401,42833
201306,2497066,1966300
201312,592497,579233
201312,526551,542168
201306,7598454,7415237
201307,688824,695361
201306,592390,548554
201309,1899805,1721268
201306,5275560,5094916
201312,29024,4300
201306,1430082,1180962
201312,10618,12506
201304,9344697,11265328
201312,150016,225798
201309,160825,162894
201312,177716,173485
201312,0,5280
201306,355783,341269
201312,200313,196189
201312,84804,318702
201312,988630,258610
201306,299418,164213
201312,721665,649140
201312,27944,19206
201312,375326,263299
201312,213389,214720
201312,205349,108411
201306,7323005,7706633
201306,504245,473816
201306,2893102,2718660
201312,469484,436588
201312,460476,713786
201312,309001,155099
201312,447640,439713
201309,27065,49924
201312,631519,656660
201312,156588,134766
201309,559483,141491
201306,8659447,8527621
201306,10947718,10717634
201312,1436783,1036703
201312,73239,66127
201306,2415779,2634196
201306,601371,740935
201306,135726,122830
201312,90930,63194
201309,8888752,9015272
201312,439578,315975
201403,466928,481516
201306,11389699,11169785
201306,8312329,6808366
201312,609859,516240
201306,20097194,17307341
201312,1079509,1091845
201310,1600525,1127166
201312,64356,87744
201312,9233,8946
201312,120116,123827
201310,21760972,20973199
201306,1327524,1299522
201312,104555,100085
201312,134958,15702
201312,1372261,157833
201312,684340,373909
201306,61713,0
201306,0,157
201306,152717,173234
201306,138876,157099
201306,2295981,2056378
201312,194497,193369
201312,244112,323411
201312,1200,5900
201306,571539,543849
Query:
WITH medians AS (
    SELECT
        2012 AS "Year",
        APPROX_PERCENTILE("totrevenue", 0.5) AS "median_revenue",
        APPROX_PERCENTILE("totfuncexpns", 0.5) AS "median_expenses"
    FROM IRS_990.IRS_990.IRS_990_2012
    WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

    UNION ALL

    SELECT
        2013 AS "Year",
        APPROX_PERCENTILE("totrevenue", 0.5) AS "median_revenue",
        APPROX_PERCENTILE("totfuncexpns", 0.5) AS "median_expenses"
    FROM IRS_990.IRS_990.IRS_990_2013
    WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

    UNION ALL

    SELECT
        2014 AS "Year",
        APPROX_PERCENTILE("totrevenue", 0.5) AS "median_revenue",
        APPROX_PERCENTILE("totfuncexpns", 0.5) AS "median_expenses"
    FROM IRS_990.IRS_990.IRS_990_2014
    WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

    UNION ALL

    SELECT
        2015 AS "Year",
        APPROX_PERCENTILE("totrevenue", 0.5) AS "median_revenue",
        APPROX_PERCENTILE("totfuncexpns", 0.5) AS "median_expenses"
    FROM IRS_990.IRS_990.IRS_990_2015
    WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

    UNION ALL

    SELECT
        2016 AS "Year",
        APPROX_PERCENTILE("totrevenue", 0.5) AS "median_revenue",
        APPROX_PERCENTILE("totfuncexpns", 0.5) AS "median_expenses"
    FROM IRS_990.IRS_990.IRS_990_2016
    WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

    UNION ALL

    SELECT
        2017 AS "Year",
        APPROX_PERCENTILE("totrevenue", 0.5) AS "median_revenue",
        APPROX_PERCENTILE("totfuncexpns", 0.5) AS "median_expenses"
    FROM IRS_990.IRS_990.IRS_990_2017
    WHERE "totrevenue" > 0 AND "totfuncexpns" > 0
)
SELECT
    "Year",
    ABS("median_revenue" - "median_expenses") AS "Difference"
FROM medians
ORDER BY "Difference" ASC
LIMIT 3;
Answer:
Year,Difference
2012,20807.68602431519
2013,21579.555983036
2017,26870.32682308246
Query:
-- Corrected SQL 1:
SELECT "totrevenue", "totfuncexpns"
FROM IRS_990.IRS_990.IRS_990_2016
WHERE "totrevenue" IS NOT NULL AND "totfuncexpns" IS NOT NULL AND "totrevenue" > 0 AND "totfuncexpns" > 0
ORDER BY "totrevenue" DESC
LIMIT 100
Answer:
totrevenue,totfuncexpns
48466380486,48252710912
22589160782,20177137580
11117362273,10735291530
10588819964,10397939016
10093618664,9598768323
7766891918,7031439782
6627941524,6546010317
6609236543,4775458754
6493574288,6241795918
6294043000,5365056000
6202791309,6013922970
6035405120,5050927315
5873490598,5428669563
5797614000,5413130000
5588532117,5472832968
5461672525,3513798862
5393562395,2904271461
5356390727,4704630046
5328246960,5420536806
5161648176,5244142393
5134601111,4834543626
5133153576,5103578899
4910706402,4139274346
4816088296,4545788229
4774717370,4809182027
4716398592,4445052878
4638829461,4257472819
4504130397,4189634110
4473514886,4079538648
4372143740,1813161781
4351368015,3951934873
4311684452,5593549105
4183432761,4054537461
4106025478,3973335311
4042224000,3362019000
4025714365,3646887535
3989206369,3674604442
3953321746,4889356658
3937422813,3738011324
3876101208,3808703953
3867024714,3528902741
3863299939,3866118217
3747280284,3541811776
3643873548,3341897417
3566621530,3561486152
3548514745,3058760413
3544672148,3515591212
3537547291,3510646795
3525925969,3280678127
3468642039,3429310641
3449061000,3090294000
3428144743,3391520370
3411016895,3207510050
3351543535,3326555123
3333076637,3352267064
3259935496,3071848219
3214106912,2724203584
3203953559,2575896601
3199591275,2804331125
3178795190,4500095279
3129343358,2765086838
3080885746,3087726933
3071828318,3016490619
3035099104,2746184349
3030963951,2956856742
3030169520,2577346747
3027840937,2908625317
2978563000,1803109000
2943587980,2572294142
2924436906,2432399607
2763166156,2532008520
2743877191,2011897432
2731100296,2480390461
2726672619,2886003368
2686158659,2573092382
2657404837,2658726363
2621538541,2401392211
2612768116,2234135830
2598267000,2475783000
2594041401,2536483327
2577579491,2483941839
2571857701,2291183575
2558344913,2419780683
2551240199,2479801073
2548073099,2421302363
2544472361,2383977370
2520129473,2304404712
2516797916,2497728565
2483648665,2478142522
2452502888,2012397496
2421913636,2177684094
2405092512,2233609948
2343232119,2232588134
2302862483,2167859749
2231492139,2146355425
2231072418,2216859212
2229239192,2239305974
2227579157,2039964371
2219948393,2128505718
2219118944,2358753125
Query:
-- Corrected SQL 2:
SELECT "ein", "totrevenue", "totfuncexpns"
FROM IRS_990.IRS_990.IRS_990_2017
WHERE "totfuncexpns" > "totrevenue" AND "totrevenue" IS NOT NULL AND "totfuncexpns" IS NOT NULL
LIMIT 100
Answer:
ein,totrevenue,totfuncexpns
237405790,20128,23582
208416981,794992,822403
273699109,30,400
381650166,74986,97288
272691353,0,90826
370947122,128590,157266
460969758,223086,261225
461571045,342729,369988
350709681,80290,104959
251291588,10116126,10387142
232200495,59772,67533
273400989,1922865,1967635
260668563,170275,286482
46033783,39385,77077
460635108,235676,247267
371065889,256929,263595
201195276,0,125
440562050,355322,356191
521234086,555651,591446
710724522,785492,786526
450226771,134879,137785
237206092,687660,730206
760522196,391401,479301
383648590,360230,408645
113289644,0,66118
954378092,446143,481131
200344973,3981,7566
561649348,111886,148852
264769948,391921,464659
581509453,95615,101180
262934876,0,4074
116046761,740503,759523
920163309,10310,24067
562612221,9561,12670
746067204,-74877,0
436048958,380134,385490
232787770,63743,72099
41032811,15099,15886
364677522,21552,34989
421306327,132248,155809
113131155,484310,583956
382596556,23002,214511
521327135,65385,145008
430653311,56397,177633
461855613,208394,212058
161647860,201025,231022
364185647,22267,35533
202856026,15778,16220
221403386,111618,132140
166093842,124448,124529
942376641,365187,1118670
860907496,69140,129701
660421941,600,96655
660479375,280953,359994
840445294,144439,157162
621497109,299580,425685
521635549,263081,344704
953251598,-4108,34899
60775048,13967,15068
562644123,77434,95179
41729080,33,1777
956099148,127741,135177
450348626,154328,158459
521750739,10414,14005
204530754,0,18400
680611130,182978,187369
946107654,9487,11750
203331176,734090,745930
746063788,53205,59597
946103450,71552,85412
431295518,170965,183190
421321802,395491,411416
351759951,764646,768532
311009270,107468,121930
261117499,3898241,5856795
416025659,71954,87828
630784586,430009,439711
381435833,582987,590827
550171648,51917,52817
640808786,216943,231609
953797579,300319,317638
350340035,93695,97215
590842761,293413,297891
386069083,64106,137422
391170009,547373,556457
230781035,350073,354928
230998230,2908362,2967458
370661312,370540,387624
341097334,240999,290156
953087805,192604,249489
421516611,215585,229295
750713616,1394294,1444938
742583484,675736,678792
237171916,255776,265625
232909561,247917,261151
942930926,678329,786345
850413060,218721,241761
350173331,40858,79026
746085122,44515,69593
730660293,126132,140411
Query:
-- Corrected SQL 3:
SELECT AVG("totrevenue") AS "avg_revenue", AVG("totfuncexpns") AS "avg_expenses"
FROM IRS_990.IRS_990.IRS_990_2014
WHERE "totrevenue" > 0 AND "totfuncexpns" > 0
Answer:
avg_revenue,avg_expenses
7563524.593299,7120663.408566
Query:
-- Corrected SQL 4:
SELECT APPROX_PERCENTILE("totrevenue", 0.5) AS "median_revenue"
FROM IRS_990.IRS_990.IRS_990_2015
WHERE "totrevenue" > 0
Answer:
median_revenue
422785.4010380951
Query:
-- Corrected SQL 5:
SELECT APPROX_PERCENTILE("totfuncexpns", 0.5) AS "median_expenses"
FROM IRS_990.IRS_990.IRS_990_2016
WHERE "totfuncexpns" > 0
Answer:
median_expenses
394883.98098260164
Query:
-- Corrected SQL 6:
SELECT "ein", "totrevenue"
FROM IRS_990.IRS_990.IRS_990_2017
WHERE "totrevenue" IS NOT NULL AND "totrevenue" > 0
ORDER BY "totrevenue" DESC
LIMIT 100
Answer:
ein,totrevenue
941340523,51065716534
941105628,24251778809
208295721,11695858422
900656139,11297001725
941196203,10193378790
390123480,9680842150
390123480,9587415035
912153073,8907956801
113153422,8438339064
720502505,7216705808
941156365,6965956577
311143265,6440829493
450233470,6326720478
231352685,6286195000
520595110,6046472000
135562308,6043438258
133783732,6011909761
510216586,5953431215
941461312,5859550187
942854057,5619049200
133957095,5317043380
416011702,5152134383
980380092,5128139561
131828429,4931402574
951642394,4895423051
60646973,4807997730
314379427,4789153691
110303001,4780943595
135598093,4708225588
753052953,4658343974
611649250,4629361219
364724966,4620705638
362169147,4581585962
42103580,4458905923
431491162,4381625623
150532082,4369242548
741152597,4282066839
710569421,4236821221
311161086,4226007193
363261413,4103552249
42103594,3961420000
912154267,3938149398
840591617,3805780718
930798039,3757404559
351955872,3721532076
946174066,3705341644
453791176,3621661130
580566256,3589561177
131740114,3583255101
980123241,3557087000
440545275,3539081870
900059117,3535304000
382359234,3509403557
133971298,3507764725
410991680,3487488197
362154936,3452950120
520954463,3414413304
951644600,3319765238
590624458,3316774822
362177139,3244736644
160743209,3231905703
311774905,3231802694
910511770,3229090548
430653611,3185323683
562070036,3133177470
203674498,3126468204
611740292,3046771758
351330472,2877065236
581954432,2874233046
362167817,2833160505
381357020,2830348248
951643307,2793425000
560532129,2786082190
134115686,2785766626
951684089,2760691880
60646652,2709762778
381459362,2705865475
821406555,2686418339
382715520,2682911106
870409820,2681376558
530196605,2676037116
113601529,2668766064
314394942,2643979320
112241326,2634373351
900424876,2621279561
530196605,2618203252
540620889,2586420494
136171197,2583763337
651301877,2577123705
42932021,2564072884
411242261,2538424327
42674079,2526498562
141640868,2520075502
210634501,2495283000
910939479,2492720447
10649794,2490406503
382113393,2481440397
111562701,2467441460
131624096,2450589608
363673599,2437618536
Query:
-- Corrected SQL 7:
SELECT "ein", "totrevenue", "totfuncexpns"
FROM IRS_990.IRS_990.IRS_990_2013
WHERE "totrevenue" > 1000000 AND "totfuncexpns" IS NOT NULL
LIMIT 100
Answer:
ein,totrevenue,totfuncexpns
522385104,2208052,2288933
246021385,2371701,2383014
990213908,2666924,2834679
716076840,3219672,2564742
866052021,27339091,27800070
237122650,16381263,16764161
436158894,6610202,7034850
592719781,2201691,2216131
200946697,14993695,16159574
222842803,3443245,1879670
316064918,15930768,18203624
450493921,6604819,6777747
656088549,3348829,3752811
990269654,1008046,871965
436921041,1031181,369846
363489253,214551238,195393298
776224948,1322214,2072342
876128290,12409053,12266479
910853746,1682092,1586537
943048491,1341052,1326458
366191936,1458359,1453804
942375212,26101547,26133951
522305267,1275783,1112593
931204757,19654326,17979683
596134291,2082021,2039803
920018710,5409934,5740392
996046220,2386777,2182007
133810146,22164086,12589344
526047277,4298181,4140864
237104346,5067764,4823367
481165594,18504372,12629291
363978082,127539621,63861951
956049026,35416411,36014678
760681919,2772557,2105631
586054909,1270672,1215381
942919522,3465685,3206559
454737931,3787250,3360339
930948165,1414524,1374291
237000786,6670745,5393596
521118310,1527020396,1522495405
581910292,9061902,8585540
541546353,1255755,1258315
522256239,1297766,1133793
261218705,2359535,2321592
411954568,1289426,1474338
954020047,1433843,1427948
351444018,3661893,9073779
956134346,11394989,11246905
941229312,13505575,13982208
481084624,1656869,1604085
232196792,2863882,2863532
391969371,1775745,1592803
541812682,13942614,13208979
131928934,1296976,1235079
646034464,1357896,1159367
201872707,1033807,874697
870221322,12403651,11994949
383544316,9212075,8602584
680482902,1365342,1305109
237237228,3146014,3267663
411700724,3209683,3163890
520215218,30072782,26575981
411312839,17740618,16627962
522045099,14163102,14920558
251809780,657249964,689935296
621238720,18813104,20910842
582058681,1064051,1029929
133521368,9773461,10183477
752097176,1882785,1573005
222485816,1540680,1582177
846029106,7776583,8718493
880244888,15112927,14990548
943315557,3890059,2948031
232538149,1666455,885545
204874222,1712925,1786323
237228745,1213216,1110129
340967541,2472449,2031007
430821255,2084383,1032950
310991778,1059423,1038416
591872564,1168717,1069883
237081446,1140483,1088230
381969682,1290344,1171460
530143440,6289314,5620094
870281095,1099695,1065070
940577476,1207890,1134238
590816175,2289521,2148308
526279969,19299318,19751872
223644482,1544220,1968826
237086241,2129244,2221592
232121745,4564265,3884556
943192137,3285605,2412868
562256710,2017388,2026386
990054398,4295137,1291247
520978073,3776530,3458574
581048245,1183644,1232286
680224404,3266635,3418298
942856557,2226012,2105822
237155858,2175735,2189938
941108767,1119405,1075802
581030868,1447382,1485934
Query:
-- Corrected SQL 8:
SELECT "ein", "totrevenue", "totfuncexpns"
FROM IRS_990.IRS_990.IRS_990_2014
WHERE "totrevenue" = "totfuncexpns" AND "totrevenue" IS NOT NULL AND "totfuncexpns" IS NOT NULL
LIMIT 100
Answer:
ein,totrevenue,totfuncexpns
30553373,558342,558342
451336988,0,0
510188161,0,0
200076089,45735,45735
610133681,28996896,28996896
954059206,172437916,172437916
452744612,0,0
610337665,46840538,46840538
203288155,302650,302650
204639376,0,0
371532145,0,0
470943243,78677,78677
611509925,0,0
582066628,107308,107308
454671066,0,0
522021524,300101,300101
580246393,335584379,335584379
746182445,25093831,25093831
452280259,1010382,1010382
746211197,8364076,8364076
136116925,704565,704565
980031619,0,0
610169533,49799493,49799493
161644265,12609061,12609061
161742945,0,0
311540949,3886671,3886671
113773485,33000,33000
311768219,0,0
314411236,0,0
316041648,0,0
161658496,105,105
310785627,0,0
203756610,5711201,5711201
951684088,389057,389057
941339061,102801,102801
440518478,9487868,9487868
383878194,0,0
202979705,0,0
202979705,0,0
742604981,316353,316353
200672290,27000,27000
411836633,0,0
161000644,130926,130926
201536108,0,0
800920436,0,0
300021927,600,600
320204732,718220,718220
611245048,305044,305044
571142879,0,0
930412495,0,0
943399181,0,0
232028429,0,0
610329022,111605272,111605272
431948188,136449557,136449557
582587017,339929,339929
610235235,53069299,53069299
610158153,52751280,52751280
261471973,1650612,1650612
461501498,8400,8400
270932860,0,0
770471097,1116000,1116000
562570681,241486750,241486750
462168397,165816,165816
237097074,0,0
237584567,0,0
593816915,0,0
352476219,0,0
352390578,0,0
562023076,144083,144083
300597868,0,0
223608014,0,0
263711540,0,0
461741319,0,0
363817205,0,0
270932860,0,0
364705734,0,0
201283731,34670,34670
454739977,71862,71862
651197113,14995,14995
20724111,0,0
860653597,0,0
736105486,0,0
452208063,0,0
260190411,0,0
461720046,0,0
203633491,60,60
631130709,895203,895203
461741319,0,0
461741319,0,0
464187400,15433,15433
453070854,0,0
272195933,98064,98064
320394740,0,0
203949698,0,0
562331329,309250,309250
461012984,146853,146853
204704132,0,0
204704132,0,0
141843575,0,0
800481425,0,0
Query:
-- Corrected SQL 9:
SELECT "subseccd", "totrevenue", "totfuncexpns"
FROM IRS_990.IRS_990.IRS_990_2015
WHERE "totrevenue" IS NOT NULL AND "totfuncexpns" IS NOT NULL AND "totrevenue" > 0 AND "totfuncexpns" > 0
LIMIT 100
Answer:
subseccd,totrevenue,totfuncexpns
3,1903520,1921326
10,224671,323423
3,289696,303087
3,1057493,1045337
3,984708,866952
7,2430260,2199928
3,153512,114525
6,2342339,2579589
2,153758,153758
3,3017692,5432604
3,82088,128669
3,114075,129146
7,876456,863379
3,789503,699720
3,112680,28263
3,608511,116562
3,54868,69959
5,656183,681175
3,40000,45855
3,958458,986247
13,114405,181706
7,353231,313621
3,535566,396287
3,106129,59479
3,420687,86555
3,707973,387448
19,301999,299683
3,273774,269182
3,1285782,1267001
3,35467,51829
3,721084,781071
3,458555,450336
3,225096,205780
3,3025258,3022646
6,631675,537066
3,455860,470624
6,513080,565982
3,87550,88884
3,101666,136996
6,681530,641708
3,221066,400093
3,100851,43840
3,255911,46068
3,154960,137865
3,4653214,5874635
3,746082,642103
3,1290966,1117835
3,162728,92414
3,165326,144820
3,135340,142348
13,409363,395816
3,201672,88556
3,205302,181358
4,170648,177626
3,647090,92327
3,3839082,5588797
3,875056,1077892
13,116450,77596
3,382701,243741
9,158656,88741
3,441242,368133
3,1222774,1305463
4,963271,959680
3,4462845,4146969
4,540200,522483
2,112586,80362
3,106055,193911
3,78894,40008
3,149152,148761
3,11911,85
3,34736,42545
3,152442,305289
3,898262,839459
3,2107196,2069830
3,99376,47545
3,1186074,1227995
3,282428,197658
7,251133,239130
4,147584,110724
6,801528,713862
3,261486,162415
3,2249885,2108280
3,1159188,1196205
3,125435,122002
9,87424,44031
3,326711,378285
3,63256,93076
3,670272,450993
3,919714,850984
13,127388,162441
3,841333,893133
7,98740,91795
3,340537,365890
2,78669,130332
7,678506,467217
3,2068181,2127693
3,251168,288351
3,89897,12016
3,817043,689491
3,7278575,7712929
End Exploring Related Columns
Task: Which three years in 2012-2017 have the smallest absolute difference between median revenue and median functional expenses for organizations filing IRS 990 forms? Please output three years and respective differences.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Year,Difference
year1:int,diff1:float>=0
year2:int,diff2:float>=0
year3:int,diff3:float>=0
(Attention: answer in three rows)
```

To determine the three years between 2012 and 2017 with the smallest absolute difference between median revenue and median functional expenses for organizations filing IRS 990 forms, we calculated the absolute difference between the medians of revenue and expenses for each year. The three years with the smallest differences are listed above..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'IRS_990': {'IRS_990': ['IRS_990_2012', 'IRS_990_2013', 'IRS_990_2014', 'IRS_990_2015', 'IRS_990_2016', 'IRS_990_2017', 'IRS_990_EIN', 'IRS_990_EZ_2012', 'IRS_990_EZ_2013', 'IRS_990_EZ_2014', 'IRS_990_EZ_2015', 'IRS_990_EZ_2016', 'IRS_990_EZ_2017', 'IRS_990_PF_2012', 'IRS_990_PF_2013', 'IRS_990_PF_2014', 'IRS_990_PF_2015', 'IRS_990_PF_2016']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-26 15:58:31 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 15:58:31 - root - INFO - ```sql
WITH data AS (
  SELECT 2012 AS "Year", "totrevenue", "totfuncexpns"
  FROM IRS_990.IRS_990.IRS_990_2012
  UNION ALL
  SELECT 2013 AS "Year", "totrevenue", "totfuncexpns"
  FROM IRS_990.IRS_990.IRS_990_2013
  UNION ALL
  SELECT 2014 AS "Year", "totrevenue", "totfuncexpns"
  FROM IRS_990.IRS_990.IRS_990_2014
  UNION ALL
  SELECT 2015 AS "Year", "totrevenue", "totfuncexpns"
  FROM IRS_990.IRS_990.IRS_990_2015
  UNION ALL
  SELECT 2016 AS "Year", "totrevenue", "totfuncexpns"
  FROM IRS_990.IRS_990.IRS_990_2016
  UNION ALL
  SELECT 2017 AS "Year", "totrevenue", "totfuncexpns"
  FROM IRS_990.IRS_990.IRS_990_2017
)
SELECT
  "Year",
  ABS(ROUND(APPROX_PERCENTILE("totrevenue", 0.5) - APPROX_PERCENTILE("totfuncexpns", 0.5), 4)) AS "Difference"
FROM data
WHERE "totrevenue" > 0 AND "totfuncexpns" > 0
GROUP BY "Year"
ORDER BY "Difference" ASC
LIMIT 3;
```

```csv
Year,Difference
2012,20807.6860
2013,21579.5560
2017,26870.3268
```
2025-01-26 15:58:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:58:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:58:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:58:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-26 15:58:33 - snowflake.connector.connection - INFO - closed
2025-01-26 15:58:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:58:33 - root - INFO - itercount: 1
2025-01-26 15:58:33 - root - INFO - 0
2025-01-26 15:58:33 - root - INFO - results: 
Year,Difference
2012,20807.686
2013,21440.9132
2017,26870.3268


2025-01-26 15:58:33 - root - INFO - Please check the answer again by reviewing Which three years in 2012-2017 have the smallest absolute difference between median revenue and median functional expenses for organizations filing IRS 990 forms? Please output three years and respective differences., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Year,Difference
year1:int,diff1:float>=0
year2:int,diff2:float>=0
year3:int,diff3:float>=0
(Attention: answer in three rows)
```

To determine the three years between 2012 and 2017 with the smallest absolute difference between median revenue and median functional expenses for organizations filing IRS 990 forms, we calculated the absolute difference between the medians of revenue and expenses for each year. The three years with the smallest differences are listed above. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Year,Difference
2012,20807.686
2013,21440.9132
2017,26870.3268
Current sql:
WITH data AS (
  SELECT 2012 AS "Year", "totrevenue", "totfuncexpns"
  FROM IRS_990.IRS_990.IRS_990_2012
  UNION ALL
  SELECT 2013 AS "Year", "totrevenue", "totfuncexpns"
  FROM IRS_990.IRS_990.IRS_990_2013
  UNION ALL
  SELECT 2014 AS "Year", "totrevenue", "totfuncexpns"
  FROM IRS_990.IRS_990.IRS_990_2014
  UNION ALL
  SELECT 2015 AS "Year", "totrevenue", "totfuncexpns"
  FROM IRS_990.IRS_990.IRS_990_2015
  UNION ALL
  SELECT 2016 AS "Year", "totrevenue", "totfuncexpns"
  FROM IRS_990.IRS_990.IRS_990_2016
  UNION ALL
  SELECT 2017 AS "Year", "totrevenue", "totfuncexpns"
  FROM IRS_990.IRS_990.IRS_990_2017
)
SELECT
  "Year",
  ABS(ROUND(APPROX_PERCENTILE("totrevenue", 0.5) - APPROX_PERCENTILE("totfuncexpns", 0.5), 4)) AS "Difference"
FROM data
WHERE "totrevenue" > 0 AND "totfuncexpns" > 0
GROUP BY "Year"
ORDER BY "Difference" ASC
LIMIT 3;
2025-01-26 15:59:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 15:59:17 - root - INFO - ```sql
WITH data AS (
  SELECT 2012 AS "Year", "totrevenue", "totfuncexpns"
  FROM IRS_990.IRS_990.IRS_990_2012
  UNION ALL
  SELECT 2013 AS "Year", "totrevenue", "totfuncexpns"
  FROM IRS_990.IRS_990.IRS_990_2013
  UNION ALL
  SELECT 2014 AS "Year", "totrevenue", "totfuncexpns"
  FROM IRS_990.IRS_990.IRS_990_2014
  UNION ALL
  SELECT 2015 AS "Year", "totrevenue", "totfuncexpns"
  FROM IRS_990.IRS_990.IRS_990_2015
  UNION ALL
  SELECT 2016 AS "Year", "totrevenue", "totfuncexpns"
  FROM IRS_990.IRS_990.IRS_990_2016
  UNION ALL
  SELECT 2017 AS "Year", "totrevenue", "totfuncexpns"
  FROM IRS_990.IRS_990.IRS_990_2017
)
SELECT
  "Year",
  ABS(ROUND(APPROX_PERCENTILE("totrevenue", 0.5) - APPROX_PERCENTILE("totfuncexpns", 0.5), 4)) AS "Difference"
FROM data
WHERE "totrevenue" > 0 AND "totfuncexpns" > 0
GROUP BY "Year"
ORDER BY "Difference" ASC
LIMIT 3;
```
2025-01-26 15:59:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:59:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:59:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:59:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-26 15:59:19 - snowflake.connector.connection - INFO - closed
2025-01-26 15:59:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:59:19 - root - INFO - itercount: 2
2025-01-26 15:59:19 - root - INFO - 0
2025-01-26 15:59:19 - root - INFO - Total iteration counts: 2
