2025-01-23 14:00:38 - openai._base_client - INFO - Retrying request to /chat/completions in 0.445809 seconds
2025-01-23 14:01:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 14:01:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:01:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:01:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:01:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 14:01:58 - snowflake.connector.connection - INFO - closed
2025-01-23 14:01:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:01:58 - root - INFO - SQL:
-- Query 1: Get distinct PatientIDs
SELECT DISTINCT "PatientID"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
LIMIT 100;
Results:
PatientID
124864
126698
214027
218489
209671
212933
VHP-M
TCGA-D3-A2JO
Adrenal_Ki67_Seg_013
Adrenal_Ki67_Seg_036
EA1141-2422978
EA1141-4203755
TCGA-US-A774
UPENN-GBM-00526
UPENN-GBM-00416
UPENN-GBM-00471
UPENN-GBM-00277
UPENN-GBM-00033
UPENN-GBM-00345
UPENN-GBM-00461
UPENN-GBM-00259
UPENN-GBM-00069
UPENN-GBM-00180
UPENN-GBM-00047
UPENN-GBM-00082
UPENN-GBM-00417
UPENN-GBM-00224
UPENN-GBM-00609
UPENN-GBM-00559
ACRIN-6698-103939
202019
218458
ACRIN-6698-294739
200362
205653
114946
115312
108175
120877
113769
127150
119535
114346
103632
108500
132186
104094
118939
124557
126923
115922
116882
125876
103561
125914
126291
119105
110276
107480
127058
127392
114981
128657
116935
119471
119795
117263
108996
116454
133662
101297
102317
119355
116014
123264
107441
208173
130228
102250
212225
116627
UPENN-GBM-00343
UPENN-GBM-00133
UPENN-GBM-00070
UPENN-GBM-00084
UPENN-GBM-00373
UPENN-GBM-00257
UPENN-GBM-00323
UPENN-GBM-00615
ACRIN-6698-283070
ACRIN-6698-971492
D1-1032
114311
121099
209555
212900
203358
213865
UPENN-GBM-00438
ACRIN-6698-178150

2025-01-23 14:01:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:01:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:01:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:02:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 24
2025-01-23 14:02:00 - snowflake.connector.connection - INFO - closed
2025-01-23 14:02:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:02:00 - root - INFO - SQL:
-- Query 2: Get distinct Modalities
SELECT DISTINCT "Modality"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
LIMIT 100;
Results:
Modality
NM
CT
PR
OT
KO
CR
RTDOSE
MG
SC
M3D
RF
RTSTRUCT
RTPLAN
FUSION
US
SM
XC
REG
MR
SEG
SR
PT
RWV
DX

2025-01-23 14:02:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:02:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:02:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:02:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 14:02:03 - snowflake.connector.connection - INFO - closed
2025-01-23 14:02:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:02:03 - root - INFO - SQL:
-- Query 3: Retrieve CT images from the 'nlst' collection
SELECT *
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
LIMIT 100;
Results:
Too long, hard cut:
PatientID,BodyPartExamined,SeriesInstanceUID,SliceThickness,SeriesNumber,SeriesDescription,StudyInstanceUID,StudyDescription,StudyDate,SOPInstanceUID,Modality,SOPClassUID,collection_id,AnatomicRegionSequence,FrameOfReferenceUID,crdc_study_uuid,crdc_series_uuid,crdc_instance_uuid,Program,tcia_tumorLocation,source_DOI,tcia_species,license_short_name,Manufacturer,ManufacturerModelName,instance_size,analysis_results_id,SamplesPerPixel,CancerType,Apparent_Diffusion_Coefficient,Internal_structure,Sphericity,Calcification,Lobular_Pattern,Spiculation,Margin,Texture,Subtlety_score,Malignancy,Volume,Diameter,Surface_area_of_mesh,Sphericity_quant,Volume_of_Mesh,illuminationType,primaryAnatomicStructure,ObjectiveLensPower,min_PixelSpacing,max_TotalPixelMatrixColumns,max_TotalPixelMatrixRows,SegmentedPropertyCategoryCodeSequence,SegmentedPropertyTypeCodeSequence,SegmentNumber,SegmentAlgorithmType,AdditionalPatientHistory,Allergies,ImageType,LastMenstrualDate,MedicalAlerts,EthnicGroup,Occupation,PatientAge,PatientSex,PatientComments,PatientSize,PatientWeight,PregnancyStatus,ReasonForStudy,RequestedProcedureComments,SmokingStatus,SeriesDate,access,gcs_url,aws_url,gcs_bucket,aws_bucket
204967,CHEST,1.3.6.1.4.1.14519.5.2.1.7009.9004.242419716572049390486363439790,2.0,2,"0,OPA,SE,SEN16,B,284,2,120,54,36,1.5",1.3.6.1.4.1.14519.5.2.1.7009.9004.778472803668624713529700511125,NLST-ACRIN,1999-01-02,1.3.6.1.4.1.14519.5.2.1.7009.9004.947767262213791990617807857377,CT,1.2.840.10008.5.1.4.1.1.2,nlst,,,cad2b013-4102-4365-8bd5-f2474c6df3c1,9c5d2724-6e5e-4c95-8a25-a81b7fb7c90a,2aa1e436-29a7-41d7-a74d-7713bb4163cd,NCI Trials,Chest,10.7937/TCIA.hmq8-j677,Human,CC BY 4.0,SIEMENS,Sensation 16,526984,,1,Lung Cancer,,,,,,,,,,,,,,,,,,,0.55,512,512,,,,,,,"ORIGINAL, PRIMARY, AXIAL, CT_SOM5 SPI",,,,,,,,,,,,,,,Public,gs://public-datasets-idc/9c5d2724-6e5e-4c95-8a25-a81b7fb7c90a/2aa1e436-29a7-41d7-a74d-7713bb4163cd.dcm,s3://idc-open-data/9c5d2724-6e5e-4c95-8a25-a81b7fb7c90a/2aa1e436-29a7-41d7-a74d-7713bb4163cd.dcm,public-datasets-idc,idc-open-data
218455,CHEST,1.3.6.1.4.1.14519.5.2.1.7009.9004.505187423497940223870392699671,2.0,2,"0,OPA,SE,SEN16,B,293,2,120,60,40,1.5",1.3.6.1.4.1.14519.5.2.1.7009.9004.256384441028048975960953953724,NLST-ACRIN,1999-01-02,1.3.6.1.4.1.14519.5.2.1.7009.9004.940018635558940048585348569359,CT,1.2.840.10008.5.1.4.1.1.2,nlst,,,e39a0abf-bb05-4e99-bb6b-4ec1fd610168,6db4116c-fc38-4aff-bd88-7ff840d38941,cde5694c-7a3d-45c5-a315-78800f62c353,NCI Trials,Chest,10.7937/TCIA.hmq8-j677,Human,CC BY 4.0,SIEMENS,Sensation 16,526726,,1,Lung Cancer,,,,,,,,,,,,,,,,,,,0.55,512,512,,,,,,,"ORIGINAL, PRIMARY, AXIAL, CT_SOM5 SPI",,,,,,,,,,,,,,,Public,gs://public-datasets-idc/6db4116c-fc38-4aff-bd88-7ff840d38941/cde5694c-7a3d-45c5-a315-78800f62c353.dcm,s3://idc-open-data/6db4116c-fc38-4aff-bd88-7ff840d38941/cde5694c-7a3d-45c5-a315-78800f62c353.dcm,public-datasets-idc,idc-open-data
206866,CHEST,1.3.6.1.4.1.14519.5.2.1.7009.9004.163903497580655762081824662915,2.0,2,"0,OPA,SE,SEN16,B,294,2,120,54,36,1.5",1.3.6.1.4.1.14519.5.2.1.7009.9004.315603051606094319132439807208,NLST-ACRIN,1999-01-02,1.3.6.1.4.1.14519.5.2.1.7009.9004.272280936076670315944379808904,CT,1.2.840.10008.5.1.4.1.1.2,nlst,,,0084de8a-1e48-42bb-bbca-36e895863110,58d5eeff-2f2b-4607-ab56-dc26da5b85c1,1ead7771-cbd5-4640-9aa5-80ecbacfe229,NCI Trials,Chest,10.7937/TCIA.hmq8-j677,Human,CC BY 4.0,SIEMENS,Sensation 16,526728,,1,Lung Cancer,,,,,,,,,,,,,,,,,,,0.57,512,512,,,,,,,"ORIGINAL, PRIMARY, AXIAL, CT_SOM5 SPI",,,,,,,,,,,,,,,Public,gs://public-datasets-idc/58d5eeff-2f2b-4607-ab56-dc26da5b85c1/1ead7771-cbd5-4640-9aa5-80ecbacfe229.dcm,s3://idc-open-data/58d5eeff-2f2b-4607-ab56-dc26da5b85c1/1ead7771-cbd5-4640-9aa5-80ecbacfe229.dcm,public-datasets-idc,idc-open-data
216409,CHEST,1.3.6.1.4.1.14519.5.2.1.7009.9004.272023982202096594627344150703,2.0,2,"0,OPA,SE,SEN16,B,318,2,120,51,34,1.5",1.3.6.1.4.1.14519.5.2.1.7009.9004.139487478873545785850130696172,NLST-ACRIN,1999-01-02,1.3.6.1.4.1.14519.5.2.1.7009.9004.183641994246121611231019809592,CT,1.2.840.10008.5.1.4.1.1.2,nlst,,,e5235e73-941d-49b5-b520-3d09da2a65b2,04db656f-5188-458a-b593-d0cb9af87dcc,cd38ea3e-9cad-4933-8820-c0715400820f,NCI Trials,Chest,10.7937/TCIA.hmq8-j677,Human,CC BY 4.0,SIEMENS,Sensation 16,526992,,1,Lung Cancer,,,,,,,,,,,,,,,,,,,0.62,512,512,,,,,,,"ORIGINAL, PRIMARY, AXIAL, CT_SOM5 SPI",,,,,,,,,,,,,,,Public,gs://public-datasets-idc/04db656f-5188-458a-b593-d0cb9af87dcc/cd38ea3e-9cad-4933-8820-c0715400820f.dcm,s3://idc-open-data/04db656f-5188-458a-b593-d0cb9af87dcc/cd38ea3e-9cad-4933-8820-c0715400820f.dcm,public-datasets-idc,idc-open-data
202418,CHEST,1.3.6.1.4.1.14519.5.2.1.7009.9004.304483750374475466158135376108,2.0,2,"0,OPA,SE,SEN16,B,332,2,120,51,34,1.5",1.3.6.1.4.1.14519.5.2.1.7009.9004.247172566772255115976874272374,NLST-ACRIN,1999-01-02,1.3.6.1.4.1.14519.5.2.1.7009.9004.164754224742418859440753311768,CT,1.2.840.10008.5.1.4.1.1.2,nlst,,,c1ee49da-ee5c-4328-8751-b7d93f66379d,a7b7891a-f4b6-44a6-9c6e-749ecf20d847,abed030b-b746-

2025-01-23 14:02:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:02:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:02:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:02:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 14:02:04 - snowflake.connector.connection - INFO - closed
2025-01-23 14:02:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:02:05 - root - INFO - SQL:
-- Query 4: Get SliceThickness values for CT images
SELECT "PatientID", "SliceThickness"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
LIMIT 100;
Results:
PatientID,SliceThickness
200479,
204967,2.0
218455,2.0
218455,2.0
207779,2.0
208053,2.0
209555,1.0
213154,2.0
217875,2.0
206864,2.0
210701,2.0
212344,2.0
201149,2.0
217440,2.0
214551,2.0
206846,2.0
211178,2.0
203414,2.0
203162,2.0
216275,2.0
217572,2.0
213754,2.0
218028,2.0
215733,2.0
215733,2.0
215733,2.0
214445,2.0
203806,2.0
203806,2.0
215664,2.0
218044,2.0
218044,2.0
218044,2.0
211259,2.0
215152,2.0
212714,2.0
215152,2.0
215152,2.0
214184,2.0
214184,2.0
213865,2.0
200525,2.0
212899,2.0
206331,2.0
201080,2.0
212899,2.0
201506,2.0
214852,2.0
202669,2.0
218791,2.0
206954,2.0
205220,2.0
203730,2.0
200520,2.0
212933,2.0
216957,2.0
206494,2.0
206494,2.0
207645,2.0
200887,2.0
207645,2.0
211005,2.0
209671,2.0
204244,2.0
208402,2.0
212419,2.0
204119,2.0
213523,2.0
204793,2.0
201151,2.0
201754,2.0
218608,2.0
209318,2.0
210894,2.0
210894,2.0
211829,2.0
207408,2.0
207826,2.0
203359,2.0
204170,2.0
204170,2.0
207954,2.0
212547,2.0
218013,2.0
216131,2.0
218013,2.0
211451,2.0
210814,2.0
208275,2.0
210814,2.0
215647,2.0
200183,2.0
207992,2.0
216340,2.0
212392,2.0
201049,2.0
212392,2.0
214415,2.0
210935,2.0
215755,2.0

2025-01-23 14:02:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:02:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:02:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:02:06 - snowflake.connector.connection - INFO - closed
2025-01-23 14:02:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:02:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 14:02:40 - root - INFO - It appears that the error occurs because the column `"Exposure"` does not exist in the table `"DICOM_PIVOT"`. Based on the DDL you provided, the `"DICOM_PIVOT"` table does not include an `"Exposure"` column.

**Relevant Information:**

- **Tables and Columns:**
  - **`"IDC"."IDC_V17"."DICOM_PIVOT"`**:
    - Contains columns like `"PatientID"`, `"SliceThickness"`, `"Modality"`, `"collection_id"`, etc.
    - **Does not include the `"Exposure"` column**.
  - **`"IDC"."IDC_V17"."DICOM_ALL"`**:
    - Contains columns including `"PatientID"`, `"Exposure"`, `"SliceThickness"`, `"Modality"`, `"collection_id"`, etc.
    - **Includes both `"Exposure"` and `"SliceThickness"` columns**, although they may be of type `VARCHAR`.

**Solution:**

To retrieve `"Exposure"` values, you should query the `"DICOM_ALL"` table instead of `"DICOM_PIVOT"`.

**Corrected SQL Query:**

```sql
-- Retrieve Exposure values for CT images from the 'nlst' collection
SELECT "PatientID", "Exposure"
FROM "IDC"."IDC_V17"."DICOM_ALL"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst' AND "Exposure" IS NOT NULL
LIMIT 100;
```

**Additional Steps:**

- **Casting to Numeric Types:**
  - Since `"Exposure"` is of type `VARCHAR`, you may need to cast it to a numeric type for calculations.
  - Example:
    ```sql
    SELECT "PatientID", CAST("Exposure" AS FLOAT) AS "Exposure"
    FROM "IDC"."IDC_V17"."DICOM_ALL"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst' AND "Exposure" IS NOT NULL
    LIMIT 100;
    ```
- **Ensuring Non-Null and Numeric Values:**
  - Use conditions to filter out non-numeric or null values.
  - Example:
    ```sql
    SELECT "PatientID", CAST("Exposure" AS FLOAT) AS "Exposure"
    FROM "IDC"."IDC_V17"."DICOM_ALL"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst' AND "Exposure" IS NOT NULL
      AND TRY_TO_FLOAT("Exposure") IS NOT NULL
    LIMIT 100;
    ```

**Updated Approach for Your Task:**

To accomplish your task of finding the average series sizes in MiB for the top 3 patients with the highest slice interval difference tolerance and the top 3 patients with the highest maximum exposure difference, consider the following steps:

1. **Use `"DICOM_ALL"` for Exposure Data:**

   - Since `"Exposure"` is available in `"DICOM_ALL"`, use this table for queries involving exposure.
   - Ensure that `"Exposure"` values are properly cast to numeric types.

2. **Combine Data as Needed:**

   - If you need data from both `"DICOM_PIVOT"` and `"DICOM_ALL"`, join the tables on common identifiers such as `"SOPInstanceUID"` or `"PatientID"`.

3. **Sample Query to Calculate Exposure Difference:**

   ```sql
   -- Calculate exposure difference per patient
   SELECT "PatientID", MAX(CAST("Exposure" AS FLOAT)) - MIN(CAST("Exposure" AS FLOAT)) AS "ExposureDifference"
   FROM "IDC"."IDC_V17"."DICOM_ALL"
   WHERE "Modality" = 'CT' AND "collection_id" = 'nlst' AND "Exposure" IS NOT NULL
     AND TRY_TO_FLOAT("Exposure") IS NOT NULL
   GROUP BY "PatientID"
   ORDER BY "ExposureDifference" DESC
   LIMIT 3;
   ```

4. **Sample Query to Calculate Slice Thickness Difference:**

   ```sql
   -- Calculate slice thickness difference per patient
   SELECT "PatientID", MAX(CAST("SliceThickness" AS FLOAT)) - MIN(CAST("SliceThickness" AS FLOAT)) AS "SliceThicknessDifference"
   FROM "IDC"."IDC_V17"."DICOM_ALL"
   WHERE "Modality" = 'CT' AND "collection_id" = 'nlst' AND "SliceThickness" IS NOT NULL
     AND TRY_TO_FLOAT("SliceThickness") IS NOT NULL
   GROUP BY "PatientID"
   ORDER BY "SliceThicknessDifference" DESC
   LIMIT 3;
   ```

5. **Calculating Average Series Sizes:**

   - Use `"instance_size"` from `"DICOM_PIVOT"` or `"DICOM_ALL"` to calculate series sizes.
   - Example:
     ```sql
     -- Compute series sizes in MiB
     SELECT "PatientID", "SeriesInstanceUID", SUM("instance_size") / (1024*1024) AS "SeriesSizeMiB"
     FROM "IDC"."IDC_V17"."DICOM_ALL"
     WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
     GROUP BY "PatientID", "SeriesInstanceUID";
     ```

   - Calculate average series size per patient:
     ```sql
     SELECT "PatientID", AVG("SeriesSizeMiB") AS "AverageSeriesSizeMiB"
     FROM (
         SELECT "PatientID", "SeriesInstanceUID", SUM("instance_size") / (1024*1024) AS "SeriesSizeMiB"
         FROM "IDC"."IDC_V17"."DICOM_ALL"
         WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
         GROUP BY "PatientID", "SeriesInstanceUID"
     )
     GROUP BY "PatientID";
     ```

**Summary:**

- The `"Exposure"` column is not present in `"DICOM_PIVOT"`, causing the SQL error.
- Switch to the `"DICOM_ALL"` table to access `"Exposure"` and `"SliceThickness"` columns.
- Ensure you handle data types correctly by casting strings to numeric types where necessary.
- Use appropriate filtering to exclude null or non-numeric values.
- Adjust your SQL queries accordingly to perform the required calculations.

**Let me know if you need further assistance with specific queries or calculations for your task.**
2025-01-23 14:02:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:02:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:02:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:02:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 14:02:42 - snowflake.connector.connection - INFO - closed
2025-01-23 14:02:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:04:07 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 14:04:07 - root - INFO - SQL:
-- Retrieve Exposure values for CT images from the 'nlst' collection
SELECT "PatientID", "Exposure"
FROM "IDC"."IDC_V17"."DICOM_ALL"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst' AND "Exposure" IS NOT NULL
LIMIT 100;
Results:
PatientID,Exposure
201814,50
100099,60
100364,60
100541,79
100597,39
100690,39
100772,39
102055,39
102184,60
102277,39
102973,60
103420,39
104009,39
104680,79
105344,39
106120,39
106268,60
106358,39
106546,39
106635,60
107055,39
107096,39
108082,39
108282,39
108304,39
108836,60
109303,39
109433,79
109685,39
110155,39
110195,39
111702,60
111800,39
112111,39
112665,79
112826,60
113879,79
115844,39
116201,39
116925,79
117844,39
118383,39
118599,60
118981,39
119414,39
119464,79
119971,60
120677,39
120677,39
121055,60
124188,39
124357,69
124374,39
124396,39
125306,50
126639,39
126639,39
127573,39
127597,39
127853,39
127962,39
128460,39
129188,79
129530,60
129541,39
129653,39
130506,39
130586,39
131387,60
132432,39
133428,60
133834,60
134553,79
200964,50
203910,50
206882,50
206992,50
215346,49
215425,50
203946,50
206065,50
206553,50
207402,50
211100,70
212010,50
213719,50
215962,70
217889,50
100696,39
101916,39
102038,50
102194,40
102502,39
103664,39
103903,39
104553,41
104628,39
105166,39
106343,80
107055,39

2025-01-23 14:04:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:04:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:04:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:04:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 14:04:08 - snowflake.connector.connection - INFO - closed
2025-01-23 14:04:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:04:09 - root - INFO - SQL:
-- Query 6: Get instance sizes per series
SELECT "PatientID", "SeriesInstanceUID", "instance_size"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
LIMIT 100;
Results:
Too long, hard cut:
PatientID,SeriesInstanceUID,instance_size
218802,1.3.6.1.4.1.14519.5.2.1.7009.9004.282826873088089260708693811407,526726
214027,1.3.6.1.4.1.14519.5.2.1.7009.9004.281053228755623457241559519489,526722
216409,1.3.6.1.4.1.14519.5.2.1.7009.9004.272023982202096594627344150703,526992
202418,1.3.6.1.4.1.14519.5.2.1.7009.9004.304483750374475466158135376108,526994
207375,1.3.6.1.4.1.14519.5.2.1.7009.9004.289234750051622959034086395316,526992
206864,1.3.6.1.4.1.14519.5.2.1.7009.9004.310678295138330979593131558590,526994
212344,1.3.6.1.4.1.14519.5.2.1.7009.9004.136898235852818907963554088508,526814
212077,1.3.6.1.4.1.14519.5.2.1.7009.9004.187034345344882291608546398185,526688
210993,1.3.6.1.4.1.14519.5.2.1.7009.9004.167771055072091219513807451033,526702
210993,1.3.6.1.4.1.14519.5.2.1.7009.9004.167771055072091219513807451033,526704
210644,1.3.6.1.4.1.14519.5.2.1.7009.9004.213541391925927155403272761946,526818
211178,1.3.6.1.4.1.14519.5.2.1.7009.9004.140604347861128746247858722287,526816
211178,1.3.6.1.4.1.14519.5.2.1.7009.9004.140604347861128746247858722287,526818
203414,1.3.6.1.4.1.14519.5.2.1.7009.9004.265590634801660242439261996857,526816
218072,1.3.6.1.4.1.14519.5.2.1.7009.9004.303645220436042603410098033943,526850
202394,1.3.6.1.4.1.14519.5.2.1.7009.9004.275837112032586883381221401092,526848
213056,1.3.6.1.4.1.14519.5.2.1.7009.9004.115656912299859183287044512123,526850
215026,1.3.6.1.4.1.14519.5.2.1.7009.9004.304823247557954224981770189677,526814
205076,1.3.6.1.4.1.14519.5.2.1.7009.9004.309433124880502014517257635181,526694
218044,1.3.6.1.4.1.14519.5.2.1.7009.9004.203456778051969137441797829295,526698
217744,1.3.6.1.4.1.14519.5.2.1.7009.9004.302823383130737750042548075708,526706
201021,1.3.6.1.4.1.14519.5.2.1.7009.9004.671438701513651643434457877886,526698
202477,1.3.6.1.4.1.14519.5.2.1.7009.9004.433141445470101318162470923426,526690
210880,1.3.6.1.4.1.14519.5.2.1.7009.9004.468613874626421534106160209837,526820
202477,1.3.6.1.4.1.14519.5.2.1.7009.9004.433141445470101318162470923426,526688
214184,1.3.6.1.4.1.14519.5.2.1.7009.9004.463033806964556482794230861295,526708
208269,1.3.6.1.4.1.14519.5.2.1.7009.9004.195866616247091714210520322516,526708
200242,1.3.6.1.4.1.14519.5.2.1.7009.9004.263970182035018500935940546948,526820
210980,1.3.6.1.4.1.14519.5.2.1.7009.9004.700421702622407997607866815100,526688
210070,1.3.6.1.4.1.14519.5.2.1.7009.9004.215276538887350318578299024351,526848
203727,1.3.6.1.4.1.14519.5.2.1.7009.9004.113294968820723117479808499375,526702
212582,1.3.6.1.4.1.14519.5.2.1.7009.9004.180991024533021344665170679793,526688
216704,1.3.6.1.4.1.14519.5.2.1.7009.9004.299448323138487327943235413212,526694
212582,1.3.6.1.4.1.14519.5.2.1.7009.9004.180991024533021344665170679793,526688
201552,1.3.6.1.4.1.14519.5.2.1.7009.9004.280371277839536323978988955654,526708
206954,1.3.6.1.4.1.14519.5.2.1.7009.9004.340070022361040175265294417022,526820
200520,1.3.6.1.4.1.14519.5.2.1.7009.9004.415193433515684236719844623243,526820
218872,1.3.6.1.4.1.14519.5.2.1.7009.9004.232055115282365494390761150581,526848
212488,1.3.6.1.4.1.14519.5.2.1.7009.9004.297607224765685620799553894188,526686
217951,1.3.6.1.4.1.14519.5.2.1.7009.9004.191138524272157073630374586032,526690
208731,1.3.6.1.4.1.14519.5.2.1.7009.9004.684525285407306263403166833254,526820
204879,1.3.6.1.4.1.14519.5.2.1.7009.9004.951689514406044216367597689054,526812
204113,1.3.6.1.4.1.14519.5.2.1.7009.9004.133627602614881769003055761524,526706
212933,1.3.6.1.4.1.14519.5.2.1.7009.9004.114140058557136667043874509446,526838
214598,1.3.6.1.4.1.14519.5.2.1.7009.9004.286236580274194373804531532886,526704
200604,1.3.6.1.4.1.14519.5.2.1.7009.9004.271669723590113307403942001518,526814
217690,1.3.6.1.4.1.14519.5.2.1.7009.9004.118660656090291087946014780040,526850
204350,1.3.6.1.4.1.14519.5.2.1.7009.9004.825757795413206596563173513157,526700
214410,1.3.6.1.4.1.14519.5.2.1.7009.9004.228297484309778907516849644467,526814
202744,1.3.6.1.4.1.14519.5.2.1.7009.9004.185079362893751975773755923032,526708
212340,1.3.6.1.4.1.14519.5.2.1.7009.9004.470020961830459946273810419883,526706
205163,1.3.6.1.4.1.14519.5.2.1.7009.9004.196068188801182520131443056832,526814
201154,1.3.6.1.4.1.14519.5.2.1.7009.9004.162457739805749888572144899128,526810
204119,1.3.6.1.4.1.14519.5.2.1.7009.9004.286271020588616024038664141479,526700
204119,1.3.6.1.4.1.14519.5.2.1.7009.9004.286271020588616024038664141479,526698
217130,1.3.6.1.4.1.14519.5.2.1.7009.9004.251304519644496070590518600451,526822
201904,1.3.6.1.4.1.14519.5.2.1.7009.9004.267609805920728375534581673222,526820
206974,1.3.6.1.4.1.14519.5.2.1.7009.9004.695822461535886014797383165285,526706
213223,1.3.6.1.4.1.14519.5.2.1.7009.9004.548094798828973690788870709733,526808
201754,1.3.6.1.4.1.14519.5.2.1.7009.9004.118862257776785305148084981321,526808
218608,1.3.6.1.4.1.14519.5.2.1.7009.9004.111255539694825413569678637745,526800
208834,1.3.6.1.4.1.14519.5.2.1.7009.9004.150377120082862401420832945191,526696
200785,1.3.6.1.4.1.14519.5.2.1.7009.9004.1621836230690461639

2025-01-23 14:04:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:04:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:04:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:04:10 - snowflake.connector.connection - INFO - closed
2025-01-23 14:04:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:05:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 14:05:21 - root - INFO - The error you're encountering is due to the fact that the `"Exposure"` column does not exist in the `"DICOM_PIVOT"` table. To fix this issue, you need to use the `"DICOM_ALL"` table, which includes the `"Exposure"` column. Below, I've corrected the SQL queries that had similar errors. Each corrected query is provided in `sql` format.

---

```sql
-- Query 6: Get instance sizes per series
SELECT "PatientID", "SeriesInstanceUID", "instance_size"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
LIMIT 100;
```
**Note:** This query is correct as is since `"instance_size"` exists in the `"DICOM_PIVOT"` table.

---

```sql
-- Query 7: Get exposure and slice thickness per patient
SELECT "PatientID", "SliceThickness", "Exposure"
FROM "IDC"."IDC_V17"."DICOM_ALL"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "SliceThickness" IS NOT NULL AND "Exposure" IS NOT NULL
LIMIT 100;
```
**Correction:** Changed the table from `"DICOM_PIVOT"` to `"DICOM_ALL"` because `"Exposure"` is present in `"DICOM_ALL"`.

---

```sql
-- Query 8: Calculate slice thickness difference per patient
SELECT "PatientID",
       MAX(CAST("SliceThickness" AS FLOAT)) - MIN(CAST("SliceThickness" AS FLOAT)) AS "SliceThicknessDifference"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "SliceThickness" IS NOT NULL AND TRY_TO_FLOAT("SliceThickness") IS NOT NULL
GROUP BY "PatientID"
LIMIT 100;
```
**Note:** `"SliceThickness"` exists in `"DICOM_PIVOT"`. Added `TRY_TO_FLOAT("SliceThickness") IS NOT NULL` to ensure values can be cast to `FLOAT`.

---

```sql
-- Query 9: Calculate exposure difference per patient
SELECT "PatientID",
       MAX(CAST("Exposure" AS FLOAT)) - MIN(CAST("Exposure" AS FLOAT)) AS "ExposureDifference"
FROM "IDC"."IDC_V17"."DICOM_ALL"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "Exposure" IS NOT NULL AND TRY_TO_FLOAT("Exposure") IS NOT NULL
GROUP BY "PatientID"
LIMIT 100;
```
**Correction:** Changed the table from `"DICOM_PIVOT"` to `"DICOM_ALL"` because `"Exposure"` is present in `"DICOM_ALL"`.

---

```sql
-- Query 10: Compute series sizes in MiB
SELECT "PatientID", "SeriesInstanceUID",
       SUM("instance_size") / (1024 * 1024) AS "SeriesSizeMiB"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
GROUP BY "PatientID", "SeriesInstanceUID"
LIMIT 100;
```
**Note:** This query is correct as is since `"instance_size"` exists in `"DICOM_PIVOT"`.

---

```sql
-- Query 11: Calculate average series size per patient
SELECT "PatientID", AVG("SeriesSizeMiB") AS "AverageSeriesSizeMiB"
FROM (
    SELECT "PatientID", "SeriesInstanceUID",
           SUM("instance_size") / (1024 * 1024) AS "SeriesSizeMiB"
    FROM "IDC"."IDC_V17"."DICOM_PIVOT"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
    GROUP BY "PatientID", "SeriesInstanceUID"
)
GROUP BY "PatientID"
LIMIT 100;
```
**Note:** This query is correct as is since `"instance_size"` exists in `"DICOM_PIVOT"`.

---

```sql
-- Query 12: Identify top 3 patients with highest slice thickness difference
SELECT "PatientID",
       MAX(CAST("SliceThickness" AS FLOAT)) - MIN(CAST("SliceThickness" AS FLOAT)) AS "SliceThicknessDifference"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "SliceThickness" IS NOT NULL AND TRY_TO_FLOAT("SliceThickness") IS NOT NULL
GROUP BY "PatientID"
ORDER BY "SliceThicknessDifference" DESC
LIMIT 3;
```
**Note:** `"SliceThickness"` exists in `"DICOM_PIVOT"`. Added `TRY_TO_FLOAT("SliceThickness") IS NOT NULL` to ensure values can be cast to `FLOAT`.

---

```sql
-- Query 13: Identify top 3 patients with highest exposure difference
SELECT "PatientID",
       MAX(CAST("Exposure" AS FLOAT)) - MIN(CAST("Exposure" AS FLOAT)) AS "ExposureDifference"
FROM "IDC"."IDC_V17"."DICOM_ALL"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "Exposure" IS NOT NULL AND TRY_TO_FLOAT("Exposure") IS NOT NULL
GROUP BY "PatientID"
ORDER BY "ExposureDifference" DESC
LIMIT 3;
```
**Correction:** Changed the table from `"DICOM_PIVOT"` to `"DICOM_ALL"` because `"Exposure"` is present in `"DICOM_ALL"`.

---

```sql
-- Query 14: Get average series size for top 3 patients with highest slice thickness difference
SELECT t."PatientID", AVG(t."SeriesSizeMiB") AS "AverageSeriesSizeMiB"
FROM (
    SELECT "PatientID", "SeriesInstanceUID",
           SUM("instance_size") / (1024 * 1024) AS "SeriesSizeMiB"
    FROM "IDC"."IDC_V17"."DICOM_PIVOT"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
    GROUP BY "PatientID", "SeriesInstanceUID"
) t
WHERE t."PatientID" IN (
    SELECT "PatientID"
    FROM (
        SELECT "PatientID",
               MAX(CAST("SliceThickness" AS FLOAT)) - MIN(CAST("SliceThickness" AS FLOAT)) AS "SliceThicknessDifference"
        FROM "IDC"."IDC_V17"."DICOM_PIVOT"
        WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
          AND "SliceThickness" IS NOT NULL AND TRY_TO_FLOAT("SliceThickness") IS NOT NULL
        GROUP BY "PatientID"
        ORDER BY "SliceThicknessDifference" DESC
        LIMIT 3
    )
)
GROUP BY t."PatientID";
```
**Note:** This query is correct as is since it uses `"SliceThickness"` and `"instance_size"` from `"DICOM_PIVOT"`. Added `TRY_TO_FLOAT("SliceThickness") IS NOT NULL` for safety.

---

```sql
-- Query 15: Get average series size for top 3 patients with highest exposure difference
SELECT t."PatientID", AVG(t."SeriesSizeMiB") AS "AverageSeriesSizeMiB"
FROM (
    SELECT "PatientID", "SeriesInstanceUID",
           SUM("instance_size") / (1024 * 1024) AS "SeriesSizeMiB"
    FROM "IDC"."IDC_V17"."DICOM_PIVOT"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
    GROUP BY "PatientID", "SeriesInstanceUID"
) t
WHERE t."PatientID" IN (
    SELECT "PatientID"
    FROM (
        SELECT "PatientID",
               MAX(CAST("Exposure" AS FLOAT)) - MIN(CAST("Exposure" AS FLOAT)) AS "ExposureDifference"
        FROM "IDC"."IDC_V17"."DICOM_ALL"
        WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
          AND "Exposure" IS NOT NULL AND TRY_TO_FLOAT("Exposure") IS NOT NULL
        GROUP BY "PatientID"
        ORDER BY "ExposureDifference" DESC
        LIMIT 3
    )
)
GROUP BY t."PatientID";
```
**Correction:** Changed the inner query to use `"DICOM_ALL"` for `"Exposure"` data.

---

```sql
-- Query 16: Get the number of series per patient
SELECT "PatientID", COUNT(DISTINCT "SeriesInstanceUID") AS "SeriesCount"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
GROUP BY "PatientID"
LIMIT 100;
```
**Note:** This query is correct as is since it uses columns present in `"DICOM_PIVOT"`.

---

```sql
-- Query 17: List Exposure values (as float) for CT images
SELECT "PatientID", CAST("Exposure" AS FLOAT) AS "Exposure"
FROM "IDC"."IDC_V17"."DICOM_ALL"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "Exposure" IS NOT NULL AND TRY_TO_FLOAT("Exposure") IS NOT NULL
LIMIT 100;
```
**Correction:** Changed the table from `"DICOM_PIVOT"` to `"DICOM_ALL"` because `"Exposure"` is present in `"DICOM_ALL"`.

---

```sql
-- Query 18: List SliceThickness values (as float) for CT images
SELECT "PatientID", CAST("SliceThickness" AS FLOAT) AS "SliceThickness"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "SliceThickness" IS NOT NULL AND TRY_TO_FLOAT("SliceThickness") IS NOT NULL
LIMIT 100;
```
**Note:** This query is correct as is since `"SliceThickness"` exists in `"DICOM_PIVOT"`.

---

```sql
-- Query 19: Calculate average SliceThickness per series
SELECT "PatientID", "SeriesInstanceUID",
       AVG(CAST("SliceThickness" AS FLOAT)) AS "AvgSliceThickness"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "SliceThickness" IS NOT NULL AND TRY_TO_FLOAT("SliceThickness") IS NOT NULL
GROUP BY "PatientID", "SeriesInstanceUID"
LIMIT 100;
```
**Note:** Added `TRY_TO_FLOAT("SliceThickness") IS NOT NULL` to ensure values can be cast to `FLOAT`.

---

```sql
-- Query 20: Retrieve instance sizes and modalities
SELECT "PatientID", "Modality", "instance_size"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "collection_id" = 'nlst'
LIMIT 100;
```
**Note:** This query is correct as is since it uses columns present in `"DICOM_PIVOT"`.

---

**Summary:**

- **Queries that required correction due to the missing `"Exposure"` column in `"DICOM_PIVOT"`:**
  - **Query 7**
  - **Query 9**
  - **Query 13**
  - **Query 15**
  - **Query 17**

- **Changes Made:**
  - Switched from `"DICOM_PIVOT"` to `"DICOM_ALL"` for queries needing the `"Exposure"` column.
  - Added `TRY_TO_FLOAT()` checks where casting to `FLOAT` to ensure values are numeric and to prevent errors during casting.

Let me know if you need further assistance or explanations for any of these queries.
2025-01-23 14:05:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:05:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:05:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:05:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 14:05:22 - snowflake.connector.connection - INFO - closed
2025-01-23 14:05:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:07:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 14:07:01 - root - INFO - SQL:
-- Query 6: Get instance sizes per series
SELECT "PatientID", "SeriesInstanceUID", "instance_size"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
LIMIT 100;
Results:
Too long, hard cut:
PatientID,SeriesInstanceUID,instance_size
218802,1.3.6.1.4.1.14519.5.2.1.7009.9004.282826873088089260708693811407,526726
214027,1.3.6.1.4.1.14519.5.2.1.7009.9004.281053228755623457241559519489,526722
216409,1.3.6.1.4.1.14519.5.2.1.7009.9004.272023982202096594627344150703,526992
202418,1.3.6.1.4.1.14519.5.2.1.7009.9004.304483750374475466158135376108,526994
207375,1.3.6.1.4.1.14519.5.2.1.7009.9004.289234750051622959034086395316,526992
206864,1.3.6.1.4.1.14519.5.2.1.7009.9004.310678295138330979593131558590,526994
212344,1.3.6.1.4.1.14519.5.2.1.7009.9004.136898235852818907963554088508,526814
212077,1.3.6.1.4.1.14519.5.2.1.7009.9004.187034345344882291608546398185,526688
210993,1.3.6.1.4.1.14519.5.2.1.7009.9004.167771055072091219513807451033,526702
210993,1.3.6.1.4.1.14519.5.2.1.7009.9004.167771055072091219513807451033,526704
210644,1.3.6.1.4.1.14519.5.2.1.7009.9004.213541391925927155403272761946,526818
211178,1.3.6.1.4.1.14519.5.2.1.7009.9004.140604347861128746247858722287,526816
211178,1.3.6.1.4.1.14519.5.2.1.7009.9004.140604347861128746247858722287,526818
203414,1.3.6.1.4.1.14519.5.2.1.7009.9004.265590634801660242439261996857,526816
218072,1.3.6.1.4.1.14519.5.2.1.7009.9004.303645220436042603410098033943,526850
202394,1.3.6.1.4.1.14519.5.2.1.7009.9004.275837112032586883381221401092,526848
213056,1.3.6.1.4.1.14519.5.2.1.7009.9004.115656912299859183287044512123,526850
215026,1.3.6.1.4.1.14519.5.2.1.7009.9004.304823247557954224981770189677,526814
205076,1.3.6.1.4.1.14519.5.2.1.7009.9004.309433124880502014517257635181,526694
218044,1.3.6.1.4.1.14519.5.2.1.7009.9004.203456778051969137441797829295,526698
217744,1.3.6.1.4.1.14519.5.2.1.7009.9004.302823383130737750042548075708,526706
201021,1.3.6.1.4.1.14519.5.2.1.7009.9004.671438701513651643434457877886,526698
202477,1.3.6.1.4.1.14519.5.2.1.7009.9004.433141445470101318162470923426,526690
210880,1.3.6.1.4.1.14519.5.2.1.7009.9004.468613874626421534106160209837,526820
202477,1.3.6.1.4.1.14519.5.2.1.7009.9004.433141445470101318162470923426,526688
214184,1.3.6.1.4.1.14519.5.2.1.7009.9004.463033806964556482794230861295,526708
208269,1.3.6.1.4.1.14519.5.2.1.7009.9004.195866616247091714210520322516,526708
200242,1.3.6.1.4.1.14519.5.2.1.7009.9004.263970182035018500935940546948,526820
210980,1.3.6.1.4.1.14519.5.2.1.7009.9004.700421702622407997607866815100,526688
210070,1.3.6.1.4.1.14519.5.2.1.7009.9004.215276538887350318578299024351,526848
203727,1.3.6.1.4.1.14519.5.2.1.7009.9004.113294968820723117479808499375,526702
212582,1.3.6.1.4.1.14519.5.2.1.7009.9004.180991024533021344665170679793,526688
216704,1.3.6.1.4.1.14519.5.2.1.7009.9004.299448323138487327943235413212,526694
212582,1.3.6.1.4.1.14519.5.2.1.7009.9004.180991024533021344665170679793,526688
201552,1.3.6.1.4.1.14519.5.2.1.7009.9004.280371277839536323978988955654,526708
206954,1.3.6.1.4.1.14519.5.2.1.7009.9004.340070022361040175265294417022,526820
200520,1.3.6.1.4.1.14519.5.2.1.7009.9004.415193433515684236719844623243,526820
218872,1.3.6.1.4.1.14519.5.2.1.7009.9004.232055115282365494390761150581,526848
212488,1.3.6.1.4.1.14519.5.2.1.7009.9004.297607224765685620799553894188,526686
217951,1.3.6.1.4.1.14519.5.2.1.7009.9004.191138524272157073630374586032,526690
208731,1.3.6.1.4.1.14519.5.2.1.7009.9004.684525285407306263403166833254,526820
204879,1.3.6.1.4.1.14519.5.2.1.7009.9004.951689514406044216367597689054,526812
204113,1.3.6.1.4.1.14519.5.2.1.7009.9004.133627602614881769003055761524,526706
212933,1.3.6.1.4.1.14519.5.2.1.7009.9004.114140058557136667043874509446,526838
214598,1.3.6.1.4.1.14519.5.2.1.7009.9004.286236580274194373804531532886,526704
200604,1.3.6.1.4.1.14519.5.2.1.7009.9004.271669723590113307403942001518,526814
217690,1.3.6.1.4.1.14519.5.2.1.7009.9004.118660656090291087946014780040,526850
204350,1.3.6.1.4.1.14519.5.2.1.7009.9004.825757795413206596563173513157,526700
214410,1.3.6.1.4.1.14519.5.2.1.7009.9004.228297484309778907516849644467,526814
202744,1.3.6.1.4.1.14519.5.2.1.7009.9004.185079362893751975773755923032,526708
212340,1.3.6.1.4.1.14519.5.2.1.7009.9004.470020961830459946273810419883,526706
205163,1.3.6.1.4.1.14519.5.2.1.7009.9004.196068188801182520131443056832,526814
201154,1.3.6.1.4.1.14519.5.2.1.7009.9004.162457739805749888572144899128,526810
204119,1.3.6.1.4.1.14519.5.2.1.7009.9004.286271020588616024038664141479,526700
204119,1.3.6.1.4.1.14519.5.2.1.7009.9004.286271020588616024038664141479,526698
217130,1.3.6.1.4.1.14519.5.2.1.7009.9004.251304519644496070590518600451,526822
201904,1.3.6.1.4.1.14519.5.2.1.7009.9004.267609805920728375534581673222,526820
206974,1.3.6.1.4.1.14519.5.2.1.7009.9004.695822461535886014797383165285,526706
213223,1.3.6.1.4.1.14519.5.2.1.7009.9004.548094798828973690788870709733,526808
201754,1.3.6.1.4.1.14519.5.2.1.7009.9004.118862257776785305148084981321,526808
218608,1.3.6.1.4.1.14519.5.2.1.7009.9004.111255539694825413569678637745,526800
208834,1.3.6.1.4.1.14519.5.2.1.7009.9004.150377120082862401420832945191,526696
200785,1.3.6.1.4.1.14519.5.2.1.7009.9004.1621836230690461639

2025-01-23 14:07:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:07:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:07:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:07:02 - snowflake.connector.connection - INFO - closed
2025-01-23 14:07:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:07:46 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 14:07:46 - root - INFO - ```sql
-- Query 8: Calculate slice thickness difference per patient
SELECT "PatientID",
       MAX(CAST("SliceThickness" AS FLOAT)) - MIN(CAST("SliceThickness" AS FLOAT)) AS "SliceThicknessDifference"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "SliceThickness" IS NOT NULL AND TRY_CAST("SliceThickness" AS FLOAT) IS NOT NULL
GROUP BY "PatientID"
LIMIT 100;
```

---

```sql
-- Query 9: Calculate exposure difference per patient
SELECT "PatientID",
       MAX(CAST("Exposure" AS FLOAT)) - MIN(CAST("Exposure" AS FLOAT)) AS "ExposureDifference"
FROM "IDC"."IDC_V17"."DICOM_ALL"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "Exposure" IS NOT NULL AND TRY_CAST("Exposure" AS FLOAT) IS NOT NULL
GROUP BY "PatientID"
LIMIT 100;
```

---

```sql
-- Query 10: Compute series sizes in MiB
SELECT "PatientID", "SeriesInstanceUID",
       SUM("instance_size") / (1024 * 1024) AS "SeriesSizeMiB"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
GROUP BY "PatientID", "SeriesInstanceUID"
LIMIT 100;
```

---

```sql
-- Query 11: Calculate average series size per patient
SELECT "PatientID", AVG("SeriesSizeMiB") AS "AverageSeriesSizeMiB"
FROM (
    SELECT "PatientID", "SeriesInstanceUID",
           SUM("instance_size") / (1024 * 1024) AS "SeriesSizeMiB"
    FROM "IDC"."IDC_V17"."DICOM_PIVOT"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
    GROUP BY "PatientID", "SeriesInstanceUID"
)
GROUP BY "PatientID"
LIMIT 100;
```

---

```sql
-- Query 12: Identify top 3 patients with highest slice thickness difference
SELECT "PatientID",
       MAX(CAST("SliceThickness" AS FLOAT)) - MIN(CAST("SliceThickness" AS FLOAT)) AS "SliceThicknessDifference"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "SliceThickness" IS NOT NULL AND TRY_CAST("SliceThickness" AS FLOAT) IS NOT NULL
GROUP BY "PatientID"
ORDER BY "SliceThicknessDifference" DESC
LIMIT 3;
```

---

```sql
-- Query 13: Identify top 3 patients with highest exposure difference
SELECT "PatientID",
       MAX(CAST("Exposure" AS FLOAT)) - MIN(CAST("Exposure" AS FLOAT)) AS "ExposureDifference"
FROM "IDC"."IDC_V17"."DICOM_ALL"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "Exposure" IS NOT NULL AND TRY_CAST("Exposure" AS FLOAT) IS NOT NULL
GROUP BY "PatientID"
ORDER BY "ExposureDifference" DESC
LIMIT 3;
```

---

```sql
-- Query 14: Get average series size for top 3 patients with highest slice thickness difference
SELECT t."PatientID", AVG(t."SeriesSizeMiB") AS "AverageSeriesSizeMiB"
FROM (
    SELECT "PatientID", "SeriesInstanceUID",
           SUM("instance_size") / (1024 * 1024) AS "SeriesSizeMiB"
    FROM "IDC"."IDC_V17"."DICOM_PIVOT"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
    GROUP BY "PatientID", "SeriesInstanceUID"
) t
WHERE t."PatientID" IN (
    SELECT "PatientID"
    FROM (
        SELECT "PatientID",
               MAX(CAST("SliceThickness" AS FLOAT)) - MIN(CAST("SliceThickness" AS FLOAT)) AS "SliceThicknessDifference"
        FROM "IDC"."IDC_V17"."DICOM_PIVOT"
        WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
          AND "SliceThickness" IS NOT NULL AND TRY_CAST("SliceThickness" AS FLOAT) IS NOT NULL
        GROUP BY "PatientID"
        ORDER BY "SliceThicknessDifference" DESC
        LIMIT 3
    )
)
GROUP BY t."PatientID";
```

---

```sql
-- Query 15: Get average series size for top 3 patients with highest exposure difference
SELECT t."PatientID", AVG(t."SeriesSizeMiB") AS "AverageSeriesSizeMiB"
FROM (
    SELECT "PatientID", "SeriesInstanceUID",
           SUM("instance_size") / (1024 * 1024) AS "SeriesSizeMiB"
    FROM "IDC"."IDC_V17"."DICOM_PIVOT"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
    GROUP BY "PatientID", "SeriesInstanceUID"
) t
WHERE t."PatientID" IN (
    SELECT "PatientID"
    FROM (
        SELECT "PatientID",
               MAX(CAST("Exposure" AS FLOAT)) - MIN(CAST("Exposure" AS FLOAT)) AS "ExposureDifference"
        FROM "IDC"."IDC_V17"."DICOM_ALL"
        WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
          AND "Exposure" IS NOT NULL AND TRY_CAST("Exposure" AS FLOAT) IS NOT NULL
        GROUP BY "PatientID"
        ORDER BY "ExposureDifference" DESC
        LIMIT 3
    )
)
GROUP BY t."PatientID";
```

---

```sql
-- Query 16: Get the number of series per patient
SELECT "PatientID", COUNT(DISTINCT "SeriesInstanceUID") AS "SeriesCount"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
GROUP BY "PatientID"
LIMIT 100;
```

---

```sql
-- Query 17: List Exposure values (as float) for CT images
SELECT "PatientID", CAST("Exposure" AS FLOAT) AS "Exposure"
FROM "IDC"."IDC_V17"."DICOM_ALL"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "Exposure" IS NOT NULL AND TRY_CAST("Exposure" AS FLOAT) IS NOT NULL
LIMIT 100;
```

---

```sql
-- Query 18: List SliceThickness values (as float) for CT images
SELECT "PatientID", CAST("SliceThickness" AS FLOAT) AS "SliceThickness"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "SliceThickness" IS NOT NULL AND TRY_CAST("SliceThickness" AS FLOAT) IS NOT NULL
LIMIT 100;
```

---

```sql
-- Query 19: Calculate average SliceThickness per series
SELECT "PatientID", "SeriesInstanceUID",
       AVG(CAST("SliceThickness" AS FLOAT)) AS "AvgSliceThickness"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "SliceThickness" IS NOT NULL AND TRY_CAST("SliceThickness" AS FLOAT) IS NOT NULL
GROUP BY "PatientID", "SeriesInstanceUID"
LIMIT 100;
```

---

```sql
-- Query 20: Retrieve instance sizes and modalities
SELECT "PatientID", "Modality", "instance_size"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "collection_id" = 'nlst'
LIMIT 100;
```

---

**Explanation:**

- **Issue:** The error `Unknown function TRY_TO_FLOAT` occurs because `TRY_TO_FLOAT` is not a recognized function in Snowflake SQL.
  
- **Solution:** Use `TRY_CAST(expression AS data_type)` instead. This function attempts to cast the expression to the specified data type and returns `NULL` if the cast fails, without raising an error.

- **Corrections Made:**
  - Replaced all instances of `TRY_TO_FLOAT(column_name)` with `TRY_CAST(column_name AS FLOAT)` in the queries.
  - Ensured that columns like `"SliceThickness"` and `"Exposure"` are properly cast to `FLOAT` and checked for successful casting using `TRY_CAST`.
  
- **Note:** Queries involving the `"Exposure"` column require querying the `"DICOM_ALL"` table, as `"Exposure"` does not exist in `"DICOM_PIVOT"`.

Let me know if you need any further assistance with these queries.
2025-01-23 14:07:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:07:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:07:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:07:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 14:07:48 - snowflake.connector.connection - INFO - closed
2025-01-23 14:07:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:08:44 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 14:08:44 - root - INFO - SQL:
-- Query 8: Calculate slice thickness difference per patient
SELECT "PatientID",
       MAX(CAST("SliceThickness" AS FLOAT)) - MIN(CAST("SliceThickness" AS FLOAT)) AS "SliceThicknessDifference"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "SliceThickness" IS NOT NULL AND TRY_CAST("SliceThickness" AS FLOAT) IS NOT NULL
GROUP BY "PatientID"
LIMIT 100;
Results:
PatientID,SliceThicknessDifference
205653,1.25
209477,1.25
132464,0.0
214914,1.25
201038,1.25
117075,0.0
110276,0.0
115441,0.0
116935,0.0
114981,0.0
124584,437.681793
128558,0.0
132935,372.590881
102406,0.0
132415,0.0
132053,0.0
112311,0.0
101297,0.0
103771,0.0
106226,0.0
114933,0.0
130274,0.0
119409,0.0
107441,0.0
111467,0.0
119355,0.0
122356,0.0
124973,0.0
126138,0.0
117016,0.0
110862,0.0
116553,0.0
123448,0.0
133292,0.0
110950,457.681793
122526,0.0
211416,427.681824
208430,0.0
210576,0.0
206363,7.5
101046,0.0
107124,0.0
103567,0.0
127392,0.0
110007,0.0
211050,0.5
209677,1.25
110684,0.0
201001,0.7000000000000002
212859,0.0
213562,0.0
206261,1.25
200311,1.25
201446,1.25
214332,0.0
218034,1.25
207880,1.25
212380,0.0
200103,0.0
201826,348.931824
117067,0.0
124382,0.0
103446,0.0
123330,0.0
105310,0.0
207999,0.0
131584,0.0
131183,407.681793
133293,0.0
108869,372.590881
104493,0.0
121972,0.0
100970,0.0
116454,0.0
102250,0.0
200714,0.0
212694,0.0
206333,0.0
203142,407.681824
200619,0.0
126031,0.0
125151,383.136383
117540,372.590881
210730,0.0
113957,0.0
116014,0.0
108387,407.681763
210264,0.0
216371,0.0
213758,0.0
218515,0.5
217515,0.0
211053,0.5
213218,0.0
207879,0.0
216951,0.5
216529,1.25
121597,0.0
205435,0.0
203508,0.0

2025-01-23 14:08:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:08:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:08:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:08:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 14:08:45 - snowflake.connector.connection - INFO - closed
2025-01-23 14:08:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:08:46 - root - INFO - SQL:
-- Query 9: Calculate exposure difference per patient
SELECT "PatientID",
       MAX(TRY_CAST("Exposure" AS FLOAT)) - MIN(TRY_CAST("Exposure" AS FLOAT)) AS "ExposureDifference"
FROM "IDC"."IDC_V17"."DICOM_ALL"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "Exposure" IS NOT NULL AND TRY_CAST("Exposure" AS FLOAT) IS NOT NULL
GROUP BY "PatientID"
LIMIT 100
Results:
PatientID,ExposureDifference
120209,74.0
112068,52.0
213951,70.0
205656,1660.0
218786,1017.0
203391,350.0
214595,632.0
130302,190.0
218320,709.0
214216,1459.0
207203,467.0
216594,737.0
212462,2153.0
103364,2037.0
107945,65.0
108051,135.0
202577,204.0
202878,0.0
101193,1274.0
111230,1438.0
200270,717.0
202426,484.0
203168,806.0
126330,100.0
130319,10.0
203049,840.0
213093,317.0
118912,1293.0
217798,1140.0
215467,692.0
131083,60.0
209692,140.0
129874,37.0
108146,160.0
120537,1290.0
108635,1970.0
214308,1083.0
214049,301.0
209372,2090.0
207028,439.0
212735,1900.0
206505,207.0
207294,403.0
215274,733.0
128923,161.0
215569,721.0
213627,560.0
208451,31.0
120409,198.0
106030,1847.0
202496,610.0
106528,122.0
134456,37.0
113781,125.0
125250,979.0
121348,420.0
105820,1040.0
125439,988.0
202645,923.0
207166,1170.0
207935,0.0
210802,1801.0
127646,320.0
107983,1691.0
118046,46.0
108579,240.0
205131,34.0
127539,612.0
124412,120.0
109376,1099.0
133497,240.0
119830,60.0
211580,3088.0
132741,0.0
209256,17.0
120070,48.0
118519,0.0
105464,0.0
100194,0.0
103120,30.0
124715,0.0
201348,531.0
212296,0.0
129753,0.0
128337,0.0
105920,110.0
209929,1113.0
122204,1394.0
115118,751.0
117282,1048.0
208735,351.0
108547,57.0
216553,233.0
131150,0.0
105653,185.0
121829,0.0
105801,23.0
132832,16.0
112603,0.0
204668,2.0

2025-01-23 14:08:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:08:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:08:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:08:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 14:08:47 - snowflake.connector.connection - INFO - closed
2025-01-23 14:08:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:08:48 - root - INFO - SQL:
-- Query 10: Compute series sizes in MiB
SELECT "PatientID", "SeriesInstanceUID",
       SUM("instance_size") / (1024 * 1024) AS "SeriesSizeMiB"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
GROUP BY "PatientID", "SeriesInstanceUID"
LIMIT 100
Results:
Too long, hard cut:
PatientID,SeriesInstanceUID,SeriesSizeMiB
205251,1.3.6.1.4.1.14519.5.2.1.7009.9004.166786708348672109504046243886,3.014626
200392,1.3.6.1.4.1.14519.5.2.1.7009.9004.172715049051355276659109603582,3.014612
217447,1.3.6.1.4.1.14519.5.2.1.7009.9004.664334745222970665922202267377,5.024477
113776,1.2.840.113654.2.55.113114655744419781597576534988577334225,1.506844
127418,1.2.840.113654.2.55.149486968974160624163974742891319976157,2.009125
108365,1.2.840.113654.2.55.69174893974355077079649479860941693492,1.506632
113718,1.2.840.113654.2.55.158879025388009511957925494689129171354,1.506628
113058,1.2.840.113654.2.55.147764327300292117442776308954168185265,2.511059
103211,1.2.840.113654.2.55.35382625923748387583501034133272419685,5.022083
125745,1.2.840.113654.2.55.153409574742532399938781472939807430831,2.008842
109529,1.2.840.113654.2.55.313553427447646394897354370705706647862,5.022108
109607,1.2.840.113654.2.55.58730600592330134300164375147313633127,5.022789
124455,1.2.840.113654.2.55.111348709748424202473326167648824387363,2.511068
112224,1.2.840.113654.2.55.190332823100530359546613860414964071692,2.511248
121452,1.2.840.113654.2.55.122245452802512735684319819062963140573,1.004496
106166,1.2.840.113654.2.55.161630102044158124436449083008296607340,4.017794
116104,1.2.840.113654.2.55.150823922671683956935716887107927488545,3.515745
124057,1.2.840.113654.2.55.261683184517775622513495965948359687189,3.013187
124340,1.2.840.113654.2.55.111180866924434897607720359162042562364,2.511002
112391,1.2.840.113654.2.55.190632441053645001032728063657529933617,1.506844
118118,1.2.840.113654.2.55.320623121349875573088786585747145307319,3.013687
102098,1.2.840.113654.2.55.305378366984007540765459839999597570,2.008860
110830,1.2.840.113654.2.55.179100388053842948203839938509434118217,1.506754
208688,1.3.6.1.4.1.14519.5.2.1.7009.9004.311368776571054822457849521605,3.518055
120830,1.2.840.113654.2.55.108400053299805110877829424744048000624,3.013258
126106,1.2.840.113654.2.55.138704018072945511578410912246716411561,2.008829
104324,1.2.840.113654.2.55.120151547746893195710029680921976316332,3.013248
127456,1.2.840.113654.2.55.34693575075452061867047287892150584227,1.506624
105447,1.2.840.113654.2.55.284338390702996493558512663603602787407,2.008839
103585,1.2.840.113654.2.55.315992417923297383327009740405959471882,3.013186
121397,1.2.840.113654.2.55.89889312077800995889914448771165180646,2.511341
134049,1.2.840.113654.2.55.64183646285795176590479040762493571138,2.008846
126909,1.2.840.113654.2.55.40760306340303249503603802897299710342,2.008852
110635,1.2.840.113654.2.55.241255060847971017189173652623119624605,1.004440
121596,1.2.840.113654.2.55.195448278380871016243166071934398511819,2.511242
203933,1.3.6.1.4.1.14519.5.2.1.7009.9004.494527862505367762798160206385,2.009762
100409,1.2.840.113654.2.55.46228917331601396505996564679098614397,1.004414
125284,1.2.840.113654.2.55.198784201488545313544645078888014167537,2.511044
111530,1.2.840.113654.2.55.336731026273387683114291446765132906381,1.506622
123207,1.2.840.113654.2.55.38417272971128123996254358246668387280,5.021980
121705,1.2.840.113654.2.55.314098678806633294973263553575460524243,1.506598
207629,1.3.6.1.4.1.14519.5.2.1.7009.9004.204637700157337980957883633209,4.020517
214758,1.3.6.1.4.1.14519.5.2.1.7009.9004.245399753032061631729608464379,3.518139
208784,1.3.6.1.4.1.14519.5.2.1.7009.9004.303103453425121613940011732534,5.025909
212563,1.3.6.1.4.1.14519.5.2.1.7009.9004.180280498949576820549494161658,1.005150
107904,1.2.840.113654.2.55.101845354817737295917753769384053353476,2.511086
109118,1.2.840.113654.2.55.217837652971613927634547927578087793698,3.013264
131356,1.2.840.113654.2.55.334225885534239163693050756129130499256,1.506641
118759,1.2.840.113654.2.55.7555821702401262093676885231612867736,2.009035
214760,1.3.6.1.4.1.14519.5.2.1.7009.9004.200740258895378524823408387010,2.010302
203413,1.3.6.1.4.1.14519.5.2.1.7009.9004.460174585185763011360261385346,1.507763
201207,1.3.6.1.4.1.14519.5.2.1.7009.9004.110980192286339995420834727714,4.521681
121562,1.2.840.113654.2.55.55054173252010781451107796553343735293,2.510921
217306,1.3.6.1.4.1.14519.5.2.1.7009.9004.131562159415486879638575032200,10.550835
216691,1.3.6.1.4.1.14519.5.2.1.7009.9004.949097060656219403603582770195,4.522303
214005,1.3.6.1.4.1.14519.5.2.1.7009.9004.328958760031526775832179404190,9.546326
118636,1.2.840.113654.2.55.331830863776278366581900980812580069250,3.013184
216518,1.3.6.1.4.1.14519.5.2.1.7009.9004.696956505299963806719435760407,8.550167
206422,1.3.6.1.4.1.14519.5.2.1.7009.9004.549716260446745480474041605838,4.523220
201907,1.3.6.1.4.1.14519.5.2.1.7009.9004.582426203700910996530569521196,6.031063
109357,1.2.840.113654.2.55.293669835708983923710827993418061843990,2.008823
113064,1.2.840.113654.2.55.128457270870306392480624908897688872299,5.022816
123458,1.2.840.113654.2.55.288469012560443951226104818156063448399,2.511082
132327,1.2.840.113654.2.55.237644688909414246280337103936047695257,3.515512
114568,1.2.840.113

2025-01-23 14:08:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:08:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:08:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:08:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 14:08:49 - snowflake.connector.connection - INFO - closed
2025-01-23 14:08:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:08:50 - root - INFO - SQL:
-- Query 11: Calculate average series size per patient
SELECT "PatientID", AVG("SeriesSizeMiB") AS "AverageSeriesSizeMiB"
FROM (
    SELECT "PatientID", "SeriesInstanceUID",
           SUM("instance_size") / (1024 * 1024) AS "SeriesSizeMiB"
    FROM "IDC"."IDC_V17"."DICOM_PIVOT"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
    GROUP BY "PatientID", "SeriesInstanceUID"
) AS subquery
GROUP BY "PatientID"
LIMIT 100
Results:
PatientID,AverageSeriesSizeMiB
108991,2.678511666667
126136,2.845812000000
114959,3.932328166667
121256,3.012500833333
103112,2.134395250000
134456,2.008923200000
200191,2.072939000000
203091,3.718602400000
216340,2.466426181818
204520,3.097560333333
214488,2.260396500000
102371,1.841468000000
113545,3.683180333333
218702,3.350177500000
211752,3.769262500000
129874,2.008835666667
203041,2.177936833333
126901,2.092499333333
132122,1.204733000000
132590,2.373517909091
216449,3.138550750000
216751,3.518100166667
129753,1.815172461538
115812,2.426668500000
132342,2.511302666667
119802,1.459312375000
130223,2.223521857143
200689,5.022424250000
120493,2.327793181818
212393,2.887387750000
114549,2.510345833333
212735,2.512860000000
200868,5.022966500000
115525,2.109266800000
100530,1.506615000000
113404,3.096945333333
207262,2.762366250000
203730,3.348711333333
126482,2.058586300000
204637,4.522207111111
120836,1.460590454545
204317,2.761965500000
109287,1.841406000000
218401,1.675386333333
106558,1.673622083333
112991,2.761369000000
214224,3.600937166667
117340,1.589904166667
203049,3.316551200000
212296,5.525078500000
212265,3.266349666667
115485,1.506212500000
101144,2.510418500000
123136,2.447632500000
105653,1.699389692308
130319,2.108050750000
206164,2.511565000000
115389,1.506601000000
214167,3.126478666667
132523,2.176177166667
128577,3.096158000000
134356,3.514779000000
128465,2.343676333333
214595,2.613448200000
110647,1.338905333333
132832,1.883325750000
121217,2.175828166667
110142,3.682057000000
123767,1.506623750000
132185,2.928704000000
200856,4.020123000000
203668,3.014878888889
126907,2.259345666667
126478,1.841369833333
119267,0.753238750000
118105,2.677610428571
216769,3.518120000000
212437,2.456223000000
120490,2.092448666667
207934,3.180606166667
210789,2.122081111111
117577,1.757635666667
122528,1.506296714286
106659,2.108682600000
212992,1.674924333333
122227,3.514235666667
113667,3.137733500000
114689,1.506618500000
215446,3.601024250000
132606,2.678509333333
215555,2.324460625000
114098,1.707527800000
121740,2.115198500000
200270,2.871729142857
100314,1.381095500000
215569,2.915051800000
103629,1.255531750000
113002,2.317301769231
107931,1.793144285714
114237,2.310283200000

2025-01-23 14:08:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:08:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:08:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:08:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-23 14:08:51 - snowflake.connector.connection - INFO - closed
2025-01-23 14:08:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:08:51 - root - INFO - SQL:
-- Query 12: Identify top 3 patients with highest slice thickness difference
SELECT "PatientID",
       MAX(TRY_CAST("SliceThickness" AS FLOAT)) - MIN(TRY_CAST("SliceThickness" AS FLOAT)) AS "SliceThicknessDifference"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "SliceThickness" IS NOT NULL AND TRY_CAST("SliceThickness" AS FLOAT) IS NOT NULL
GROUP BY "PatientID"
ORDER BY "SliceThicknessDifference" DESC
LIMIT 3
Results:
PatientID,SliceThicknessDifference
110260,497.681824
132882,497.681793
112625,477.681824

2025-01-23 14:08:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:08:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:08:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:08:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-23 14:08:53 - snowflake.connector.connection - INFO - closed
2025-01-23 14:08:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:08:53 - root - INFO - SQL:
-- Query 13: Identify top 3 patients with highest exposure difference
SELECT "PatientID",
       MAX(TRY_CAST("Exposure" AS FLOAT)) - MIN(TRY_CAST("Exposure" AS FLOAT)) AS "ExposureDifference"
FROM "IDC"."IDC_V17"."DICOM_ALL"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "Exposure" IS NOT NULL AND TRY_CAST("Exposure" AS FLOAT) IS NOT NULL
GROUP BY "PatientID"
ORDER BY "ExposureDifference" DESC
LIMIT 3
Results:
PatientID,ExposureDifference
212691,7740.0
109153,7170.0
109939,7120.0

2025-01-23 14:08:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:08:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:08:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:08:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-23 14:08:54 - snowflake.connector.connection - INFO - closed
2025-01-23 14:08:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:08:55 - root - INFO - SQL:
-- Query 14: Get average series size for top 3 patients with highest slice thickness difference
WITH TopPatients AS (
    SELECT "PatientID"
    FROM (
        SELECT "PatientID",
               MAX(TRY_CAST("SliceThickness" AS FLOAT)) - MIN(TRY_CAST("SliceThickness" AS FLOAT)) AS "SliceThicknessDifference"
        FROM "IDC"."IDC_V17"."DICOM_PIVOT"
        WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
          AND "SliceThickness" IS NOT NULL AND TRY_CAST("SliceThickness" AS FLOAT) IS NOT NULL
        GROUP BY "PatientID"
        ORDER BY "SliceThicknessDifference" DESC
        LIMIT 3
    )
)
SELECT t."PatientID", AVG(t."SeriesSizeMiB") AS "AverageSeriesSizeMiB"
FROM (
    SELECT "PatientID", "SeriesInstanceUID",
           SUM("instance_size") / (1024 * 1024) AS "SeriesSizeMiB"
    FROM "IDC"."IDC_V17"."DICOM_PIVOT"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
    GROUP BY "PatientID", "SeriesInstanceUID"
) t
WHERE t."PatientID" IN (SELECT "PatientID" FROM TopPatients)
GROUP BY t."PatientID"
Results:
PatientID,AverageSeriesSizeMiB
112625,1.377551750000
110260,2.020975000000
132882,1.770029250000

2025-01-23 14:08:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:08:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:08:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:08:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-23 14:08:56 - snowflake.connector.connection - INFO - closed
2025-01-23 14:08:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:08:57 - root - INFO - SQL:
-- Query 15: Get average series size for top 3 patients with highest exposure difference
WITH TopPatients AS (
    SELECT "PatientID"
    FROM (
        SELECT "PatientID",
               MAX(TRY_CAST("Exposure" AS FLOAT)) - MIN(TRY_CAST("Exposure" AS FLOAT)) AS "ExposureDifference"
        FROM "IDC"."IDC_V17"."DICOM_ALL"
        WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
          AND "Exposure" IS NOT NULL AND TRY_CAST("Exposure" AS FLOAT) IS NOT NULL
        GROUP BY "PatientID"
        ORDER BY "ExposureDifference" DESC
        LIMIT 3
    )
)
SELECT t."PatientID", AVG(t."SeriesSizeMiB") AS "AverageSeriesSizeMiB"
FROM (
    SELECT "PatientID", "SeriesInstanceUID",
           SUM("instance_size") / (1024 * 1024) AS "SeriesSizeMiB"
    FROM "IDC"."IDC_V17"."DICOM_PIVOT"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
    GROUP BY "PatientID", "SeriesInstanceUID"
) t
WHERE t."PatientID" IN (SELECT "PatientID" FROM TopPatients)
GROUP BY t."PatientID"
Results:
PatientID,AverageSeriesSizeMiB
212691,2.010678000000
109939,1.908028400000
109153,1.807914000000

2025-01-23 14:08:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:08:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:08:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:08:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 14:08:58 - snowflake.connector.connection - INFO - closed
2025-01-23 14:08:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:08:59 - root - INFO - SQL:
-- Query 16: Get the number of series per patient
SELECT "PatientID", COUNT(DISTINCT "SeriesInstanceUID") AS "SeriesCount"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
GROUP BY "PatientID"
LIMIT 100
Results:
PatientID,SeriesCount
117246,5
218197,4
216363,5
211908,6
207028,18
217345,6
205991,6
118912,3
203340,6
216769,5
214097,3
204917,3
106593,8
118077,6
122832,6
116037,12
210802,4
213627,4
134308,7
116358,6
213435,7
115118,6
210800,3
120537,6
210878,3
113038,5
118849,6
128405,6
126907,6
133676,5
216553,5
120493,11
126508,12
112189,2
207921,3
216594,5
114443,3
105820,6
200270,7
115418,8
111047,4
109943,6
212035,2
116846,7
120155,12
132278,8
124964,6
117207,4
133942,4
204637,9
114921,7
116688,13
117793,4
120685,13
120004,5
201600,9
106659,5
119903,6
118046,5
106130,3
214224,6
210789,9
133459,6
206122,9
217798,4
133373,3
116171,3
210651,6
128829,6
111014,7
103364,6
125461,4
215446,12
119468,2
209411,3
105922,6
131664,5
100658,4
124843,3
124715,5
103086,4
121719,7
204180,2
128294,6
105338,6
202648,6
113327,6
128163,3
103120,11
119802,8
202642,5
112482,3
100512,4
123320,7
121256,6
114662,6
131544,5
115841,4
106914,5
117696,12

2025-01-23 14:08:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:08:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:08:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:09:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 14:09:00 - snowflake.connector.connection - INFO - closed
2025-01-23 14:09:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:09:00 - root - INFO - SQL:
-- Query 17: List Exposure values (as float) for CT images
SELECT "PatientID", TRY_CAST("Exposure" AS FLOAT) AS "Exposure"
FROM "IDC"."IDC_V17"."DICOM_ALL"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "Exposure" IS NOT NULL AND TRY_CAST("Exposure" AS FLOAT) IS NOT NULL
LIMIT 100
Results:
PatientID,Exposure
121545,1260.0
107815,900.0
100037,1360.0
133235,960.0
104619,1050.0
209030,700.0
118516,1190.0
112776,1360.0
122857,1020.0
212460,1900.0
111862,1200.0
116181,900.0
113873,1200.0
132982,1470.0
210185,850.0
102826,1760.0
109398,1120.0
125808,1120.0
111945,1360.0
104129,850.0
130230,1440.0
116956,1050.0
121614,1200.0
208459,1500.0
120271,960.0
115225,800.0
209183,1700.0
131138,1050.0
109943,1440.0
122721,1020.0
109219,1140.0
133635,1200.0
212449,850.0
125368,1280.0
121214,1020.0
213866,1120.0
115770,1140.0
133438,1280.0
127633,1280.0
118973,1200.0
125149,1020.0
204839,1190.0
105066,1360.0
209085,850.0
116906,1360.0
106245,1080.0
207301,900.0
215115,900.0
133265,1360.0
121643,1360.0
110830,1020.0
218548,850.0
208036,750.0
213067,850.0
126134,1020.0
209813,850.0
216929,850.0
101373,1440.0
105260,1280.0
127577,1360.0
115806,1050.0
128660,1120.0
212483,800.0
106946,1280.0
131317,1120.0
204136,1330.0
111634,1120.0
100712,1120.0
125370,1360.0
200925,1050.0
203613,850.0
107668,1200.0
206087,900.0
211009,950.0
124450,780.0
123439,1500.0
209030,700.0
122642,1520.0
202222,850.0
112469,1280.0
130479,1200.0
211517,950.0
108395,1440.0
115936,80.0
108989,2000.0
110086,1710.0
209435,850.0
117367,1360.0
216250,800.0
202512,1700.0
108134,1440.0
208021,1330.0
127599,1440.0
131968,1200.0
204090,900.0
205014,1120.0
122632,1020.0
100813,1520.0
204548,850.0
200076,850.0

2025-01-23 14:09:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:09:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:09:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:09:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 14:09:02 - snowflake.connector.connection - INFO - closed
2025-01-23 14:09:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:09:02 - root - INFO - SQL:
-- Query 18: List SliceThickness values (as float) for CT images
SELECT "PatientID", TRY_CAST("SliceThickness" AS FLOAT) AS "SliceThickness"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "SliceThickness" IS NOT NULL AND TRY_CAST("SliceThickness" AS FLOAT) IS NOT NULL
LIMIT 100
Results:
PatientID,SliceThickness
205251,1.25
200810,1.25
215573,1.25
218618,1.25
204099,2.5
218618,2.5
217782,2.5
214067,1.25
200356,2.5
202775,1.25
205406,1.25
215186,1.25
202775,1.25
209631,1.25
202775,2.5
209631,2.5
216760,1.25
216760,2.5
211035,1.25
213245,1.25
213245,2.5
213245,2.5
202379,1.25
217562,1.25
202444,1.25
202444,2.5
200026,1.25
218467,1.25
215754,1.25
200392,2.5
200392,2.5
213311,2.5
210362,1.25
209737,1.25
209737,2.5
206622,1.25
202823,1.25
202823,1.25
202823,1.25
202823,1.25
217003,2.5
215967,2.5
215967,2.5
212732,1.25
212732,1.25
214226,1.25
214226,1.25
208169,1.25
214226,1.25
212662,1.25
212662,1.25
204638,1.25
201038,2.5
216424,2.5
215378,1.25
216962,1.25
218116,1.25
204631,1.25
206778,1.25
200740,1.25
217447,1.25
207363,1.25
204631,1.25
207632,1.25
200469,1.25
200469,1.25
203891,1.25
203891,1.25
207352,1.25
212114,1.25
206862,1.25
217604,1.25
216212,350.181824
208156,350.181824
206724,350.181824
207146,2.5
210528,10.0
206040,2.5
214952,2.5
204493,2.5
211086,2.5
200895,2.5
215784,2.5
217038,2.5
209767,2.5
209767,2.5
208980,2.5
208980,2.5
204993,2.5
204993,2.5
200298,2.5
212853,2.5
200656,2.5
218258,2.5
210517,2.5
206771,2.5
134199,2.5
105451,2.5
104445,2.5
128252,2.5

2025-01-23 14:09:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:09:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:09:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:09:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 14:09:03 - snowflake.connector.connection - INFO - closed
2025-01-23 14:09:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:09:04 - root - INFO - SQL:
-- Query 19: Calculate average SliceThickness per series
SELECT "PatientID", "SeriesInstanceUID",
       AVG(TRY_CAST("SliceThickness" AS FLOAT)) AS "AvgSliceThickness"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "SliceThickness" IS NOT NULL AND TRY_CAST("SliceThickness" AS FLOAT) IS NOT NULL
GROUP BY "PatientID", "SeriesInstanceUID"
LIMIT 100
Results:
Too long, hard cut:
PatientID,SeriesInstanceUID,AvgSliceThickness
201624,1.3.6.1.4.1.14519.5.2.1.7009.9004.872950544280486750164364222492,1.25
215294,1.3.6.1.4.1.14519.5.2.1.7009.9004.148996217492996027710406795964,1.25
218618,1.3.6.1.4.1.14519.5.2.1.7009.9004.128028015336285867103950085713,1.25
216581,1.3.6.1.4.1.14519.5.2.1.7009.9004.262426097308466281158875707087,8.0
114282,1.2.840.113654.2.55.17560461040854333561667957039414381749,2.5
105888,1.2.840.113654.2.55.241516360028450016141785435147776486277,2.5
207986,1.3.6.1.4.1.14519.5.2.1.7009.9004.336484125126141161263313049803,2.5
213311,1.3.6.1.4.1.14519.5.2.1.7009.9004.232103536767936541472215322514,2.5
204993,1.3.6.1.4.1.14519.5.2.1.7009.9004.215210098532561471587226848774,2.5
109550,1.2.840.113654.2.55.210368221908775074125212046342206118717,2.5
106354,1.2.840.113654.2.55.164120053300893326008778574902678325298,2.5
117163,1.2.840.113654.2.55.314538808778194111289143626244436294705,2.5
118424,1.2.840.113654.2.55.137820025635820668522795428103876669393,2.5
100849,1.2.840.113654.2.55.62517698801495864947396068783555419472,2.5
100985,1.2.840.113654.2.55.115379361403562413836974081585698733469,2.5
107232,1.2.840.113654.2.55.164439150633591405634966038690733081281,2.5
112945,1.2.840.113654.2.55.244160901200419701369313659477866332485,2.5
127858,1.2.840.113654.2.55.2979451774176230209030147822776258446,2.5
126928,1.2.840.113654.2.55.170922522888754100887405260838378168191,2.5
102102,1.2.840.113654.2.55.304485686743879874431061048557629280676,2.5
127938,1.2.840.113654.2.55.217732377532129327394517874717822184340,2.5
115388,1.2.840.113654.2.55.68839979435557396044792396490624478390,2.5
110849,1.2.840.113654.2.55.58902618525666276667193321422882611093,2.5
133780,1.2.840.113654.2.55.17393302237844930957004617322667037248,2.5
102525,1.2.840.113654.2.55.92281317175470358153339434661044409660,2.5
128844,1.2.840.113654.2.55.96222048191569460479923728002058381208,2.5
104166,1.2.840.113654.2.55.320676387020340071276620806555639149258,2.5
105438,1.2.840.113654.2.55.94325749271926026266603610362558445159,2.5
133157,1.2.840.113654.2.55.169666813924855096061062614037766819808,2.5
203152,1.3.6.1.4.1.14519.5.2.1.7009.9004.272979313968702004253925888126,2.5
212959,1.3.6.1.4.1.14519.5.2.1.7009.9004.138145380684928835602700805541,2.5
210143,1.3.6.1.4.1.14519.5.2.1.7009.9004.153626216127611087390637311170,2.5
118658,1.2.840.113654.2.55.158516527870983020948854432934661152686,2.5
127438,1.2.840.113654.2.55.24564153887935112344168423004104272502,2.5
112306,1.2.840.113654.2.55.280301093666335248852758368243139918745,2.5
132411,1.2.840.113654.2.55.107377563888297390993774648258524945286,2.5
132435,1.2.840.113654.2.55.144349371179813399726345144751834418667,2.5
121455,1.2.840.113654.2.55.165687000313861095782624872742991376992,2.5
133054,1.2.840.113654.2.55.87697866182233538079280208505712876749,2.5
100619,1.2.840.113654.2.55.66334213071113021727988667448950609147,2.5
119121,1.2.840.113654.2.55.256802285440352381262190782533389053249,2.5
120368,1.2.840.113654.2.55.6387274534890191804900590012251899042,2.5
124876,1.2.840.113654.2.55.18414394103476965190072207317747468570,2.5
113809,1.2.840.113654.2.55.311463558825839533513024152036866940966,2.5
112493,1.2.840.113654.2.55.189499765823498727892673052521689003350,2.5
125196,1.2.840.113654.2.55.166328916802974421568064200609150564728,2.5
119848,1.2.840.113654.2.55.260399906337798075822998531001095530523,410.181763
208887,1.3.6.1.4.1.14519.5.2.1.7009.9004.309928411295881565737818251629,2.5
124040,1.2.840.113654.2.55.221243239825254956683072873321692020191,2.5
131655,1.2.840.113654.2.55.279389246308829842705952482094121697603,2.5
206040,1.3.6.1.4.1.14519.5.2.1.7009.9004.230200647439277528585311506482,2.5
112393,1.2.840.113654.2.55.38503585584016580394507294669872309026,2.5
129855,1.2.840.113654.2.55.16311585226762540889737265027484095881,2.5
107075,1.2.840.113654.2.55.154249135141325908368553390627954945523,2.5
211210,1.3.6.1.4.1.14519.5.2.1.7009.9004.116386182560203108934842856639,1.25
218104,1.3.6.1.4.1.14519.5.2.1.7009.9004.160693177773959190679764150816,2.5
215183,1.3.6.1.4.1.14519.5.2.1.7009.9004.242512714639181063302679758993,2.5
200603,1.3.6.1.4.1.14519.5.2.1.7009.9004.133882312364950910761160323576,2.5
210024,1.3.6.1.4.1.14519.5.2.1.7009.9004.281921661738859751279886424742,1.25
206813,1.3.6.1.4.1.14519.5.2.1.7009.9004.175980167354564200724208099294,1.25
214635,1.3.6.1.4.1.14519.5.2.1.7009.9004.256417160893802490084870211608,1.25
218140,1.3.6.1.4.1.14519.5.2.1.7009.9004.258923181250292198207926792326,2.5
205870,1.3.6.1.4.1.14519.5.2.1.7009.9004.271542556486024060449508609669,1.25
100275,1.2.840.113654.2.55.303926167711378654478734754069371933834,2.5
101636,1.2.840.113654.2.55.274154068365140414724763120912714678714,2.5
107084,1.2.840.113654.2.55.86206168641018044803658998263032770295,2.5
101721,1.2.840.113654.2.55.150534496050157748137903377527558408117,2.5
125119,1.2.840.113654.2.55.11633115193927511333796499037562053925,2.5
105326,1.2.840.113654.2.55

2025-01-23 14:09:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:09:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:09:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:09:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 14:09:05 - snowflake.connector.connection - INFO - closed
2025-01-23 14:09:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:09:05 - root - INFO - SQL:
-- Query 20: Retrieve instance sizes and modalities
SELECT "PatientID", "Modality", "instance_size"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "collection_id" = 'nlst'
LIMIT 100
Results:
PatientID,Modality,instance_size
126277,SM,1657142
111859,SM,2339196
108625,SM,139460984
120907,SM,705382846
120316,SM,139450954
126520,SM,2137512
132422,SM,2628668
111833,SM,66872690
130630,SM,9581864
111355,SM,100506126
120410,SM,2481982
126657,SM,1945458
131174,SM,1945468
112326,SM,464844348
134354,SM,9029460
100703,SR,21914
117966,SR,25674
105713,SR,18132
105012,SR,23172
202665,SR,168440
132313,SR,139552
129534,SR,162896
134408,SR,159356
214700,SEG,15765146
107682,SEG,11742172
210581,SEG,10943574
105974,SEG,9245572
102736,SEG,9278596
106553,SEG,10475656
133301,SEG,9646190
206866,CT,526998
218802,CT,526728
218802,CT,526728
205332,CT,526980
205332,CT,526978
207779,CT,526718
207779,CT,526984
207779,CT,526980
204432,CT,526990
211177,CT,526996
210993,CT,526704
211178,CT,526822
203414,CT,526820
203414,CT,526822
216275,CT,526812
216275,CT,526812
205463,CT,526822
218028,CT,526688
218072,CT,526852
217572,CT,526852
215733,CT,526708
211920,CT,526708
203941,CT,526708
213815,CT,526704
202441,CT,526818
201021,CT,526704
201021,CT,526702
217730,CT,526708
213865,CT,526822
210021,CT,526706
206987,CT,526812
201506,CT,526690
201506,CT,526690
204969,CT,526696
213651,CT,526706
201552,CT,526706
206954,CT,526822
201664,CT,526842
217951,CT,526690
204879,CT,526814
215000,CT,526690
215736,CT,526704
206145,CT,526688
206145,CT,526684
214598,CT,526704
212304,CT,526706
212304,CT,526706
200887,CT,526702
207562,CT,526708
218660,CT,526816
218660,CT,526816
217130,CT,526816
217130,CT,526820
206974,CT,526702
216611,CT,526706
216611,CT,526702
201151,CT,526802
210894,CT,526688
205614,CT,526814
205540,CT,526702
212363,CT,526704
205008,CT,526822
207737,CT,526684
207737,CT,526686
214959,CT,526704
202841,CT,526702
202841,CT,526704
213144,CT,526700
203921,CT,526692
215053,CT,526700

2025-01-23 14:09:05 - root - INFO - itercount: 0
2025-01-23 14:09:05 - root - INFO - Database Name: IDC
Schema Name: IDC_V17
DDL describes table information.
,0
table_name,DICOM_METADATA
description,
DDL,"create or replace TABLE DICOM_METADATA (
	""MediaStorageSOPClassUID"" VARCHAR(16777216),
	""MediaStorageSOPInstanceUID"" VARCHAR(16777216),
	""TransferSyntaxUID"" VARCHAR(16777216),
	""ImplementationClassUID"" VARCHAR(16777216),
	""ImplementationVersionName"" VARCHAR(16777216),
	""SourceApplicationEntityTitle"" VARCHAR(16777216),
	""ReferencedFileID"" VARIANT,
	""ReferencedSOPInstanceUIDInFile"" VARCHAR(16777216),
	""LengthToEnd"" NUMBER(38,0),
	""SpecificCharacterSet"" VARIANT,
	""ImageType"" VARIANT,
	""RecognitionCode"" VARCHAR(16777216),
	""InstanceCreationDate"" DATE,
	""InstanceCreationTime"" TIME(9),
	""InstanceCreatorUID"" VARCHAR(16777216),
	""SOPClassUID"" VARCHAR(16777216),
	""SOPInstanceUID"" VARCHAR(16777216),
	""OriginalSpecializedSOPClassUID"" VARCHAR(16777216),
	""StudyDate"" DATE,
	""SeriesDate"" DATE,
	""AcquisitionDate"" DATE,
	""ContentDate"" DATE,
	""OverlayDate"" DATE,
	""CurveDate"" DATE,
	""AcquisitionDateTime"" NUMBER(38,0),
	""StudyTime"" TIME(9),
	""SeriesTime"" TIME(9),
	""AcquisitionTime"" TIME(9),
	""ContentTime"" TIME(9),
	""DataSetType"" NUMBER(38,0),
	""DataSetSubtype"" VARCHAR(16777216),
	""AccessionNumber"" VARCHAR(16777216),
	""IssuerOfAccessionNumberSequence"" VARIANT,
	""RetrieveAETitle"" VARIANT,
	""FailedSOPInstanceUIDList"" VARIANT,
	""Modality"" VARCHAR(16777216),
	""ModalitiesInStudy"" VARIANT,
	""ConversionType"" VARCHAR(16777216),
	""PresentationIntentType"" VARCHAR(16777216),
	""Manufacturer"" VARCHAR(16777216),
	""InstitutionName"" VARCHAR(16777216),
	""InstitutionAddress"" VARCHAR(16777216),
	""ReferringPhysicianName"" VARIANT,
	""ReferringPhysicianAddress"" VARCHAR(16777216),
	""ReferringPhysicianTelephoneNumbers"" VARIANT,
	""CodeValue"" VARCHAR(16777216),
	""CodingSchemeDesignator"" VARCHAR(16777216),
	""CodingSchemeUID"" VARCHAR(16777216),
	""ContextGroupExtensionCreatorUID"" VARCHAR(16777216),
	""ContextIdentifier"" VARCHAR(16777216),
	""CodingSchemeIdentificationSequence"" VARIANT,
	""ContextGroupIdentificationSequence"" VARIANT,
	""MappingResourceIdentificationSequence"" VARIANT,
	""TimezoneOffsetFromUTC"" VARCHAR(16777216),
	""StationName"" VARCHAR(16777216),
	""StudyDescription"" VARCHAR(16777216),
	""ProcedureCodeSequence"" VARIANT,
	""SeriesDescription"" VARCHAR(16777216),
	""InstitutionalDepartmentName"" VARCHAR(16777216),
	""PerformingPhysicianName"" VARIANT,
	""OperatorsName"" VARIANT,
	""AdmittingDiagnosesDescription"" VARIANT,
	""AdmittingDiagnosesCodeSequence"" VARIANT,
	""ManufacturerModelName"" VARCHAR(16777216),
	""ReferencedStudySequence"" VARIANT,
	""ReferencedPerformedProcedureStepSequence"" VARIANT,
	""ReferencedSeriesSequence"" VARIANT,
	""ReferencedPatientSequence"" VARIANT,
	""ReferencedImageSequence"" VARIANT,
	""ReferencedSOPClassUID"" VARCHAR(16777216),
	""ReferencedSOPInstanceUID"" VARCHAR(16777216),
	""TransactionUID"" VARCHAR(16777216),
	""StudiesContainingOtherReferencedInstancesSequence"" VARIANT,
	""RelatedSeriesSequence"" VARIANT,
	""LossyImageCompressionRetired"" VARCHAR(16777216),
	""DerivationDescription"" VARCHAR(16777216),
	""SourceImageSequence"" VARIANT,
	""StartTrim"" VARCHAR(16777216),
	""StopTrim"" VARCHAR(16777216),
	""RecommendedDisplayFrameRate"" VARCHAR(16777216),
	""AnatomicRegionSequence"" VARIANT,
	""IrradiationEventUID"" VARIANT,
	""SourceIrradiationEventSequence"" VARIANT,
	""FrameType"" VARIANT,
	""ReferencedImageEvidenceSequence"" VARIANT,
	""ReferencedRawDataSequence"" VARIANT,
	""CreatorVersionUID"" VARCHAR(16777216),
	""DerivationImageSequence"" VARIANT,
	""PixelPresentation"" VARCHAR(16777216),
	""VolumetricProperties"" VARCHAR(16777216),
	""VolumeBasedCalculationTechnique"" VARCHAR(16777216),
	""ComplexImageComponent"" VARCHAR(16777216),
	""AcquisitionContrast"" VARCHAR(16777216),
	""DerivationCodeSequence"" VARIANT,
	""PatientName"" VARIANT,
	""PatientID"" VARCHAR(16777216),
	""IssuerOfPatientID"" VARCHAR(16777216),
	""TypeOfPatientID"" VARCHAR(16777216),
	""IssuerOfPatientIDQualifiersSequence"" VARIANT,
	""SourcePatientGroupIdentificationSequence"" VARIANT,
	""PatientBirthDate"" DATE,
	""PatientBirthTime"" TIME(9),
	""PatientSex"" VARCHAR(16777216),
	""QualityControlSubject"" VARCHAR(16777216),
	""StrainDescription"" VARCHAR(16777216),
	""StrainNomenclature"" VARCHAR(16777216),
	""StrainCodeSequence"" VARIANT,
	""OtherPatientIDs"" VARIANT,
	""PatientAge"" VARCHAR(16777216),
	""PatientSize"" VARCHAR(16777216),
	""PatientWeight"" VARCHAR(16777216),
	""PatientAddress"" VARCHAR(16777216),
	""MedicalAlerts"" VARIANT,
	""Allergies"" VARIANT,
	""PatientTelephoneNumbers"" VARIANT,
	""EthnicGroup"" VARCHAR(16777216),
	""Occupation"" VARCHAR(16777216),
	""SmokingStatus"" VARCHAR(16777216),
	""AdditionalPatientHistory"" VARCHAR(16777216),
	""PregnancyStatus"" NUMBER(38,0),
	""LastMenstrualDate"" DATE,
	""PatientSpeciesDescription"" VARCHAR(16777216),
	""PatientSpeciesCodeSequence"" VARIANT,
	""PatientSexNeutered"" VARCHAR(16777216),
	""AnatomicalOrientationType"" VARCHAR(16777216),
	""PatientBreedDescription"" VARCHAR(16777216),
	""PatientBreedCodeSequence"" VARIANT,
	""ResponsibleOrganization"" VARCHAR(16777216),
	""PatientComments"" VARCHAR(16777216),
	""ClinicalTrialSponsorName"" VARCHAR(16777216),
	""ClinicalTrialProtocolID"" VARCHAR(16777216),
	""ClinicalTrialProtocolName"" VARCHAR(16777216),
	""ClinicalTrialSiteID"" VARCHAR(16777216),
	""ClinicalTrialSiteName"" VARCHAR(16777216),
	""ClinicalTrialSubjectID"" VARCHAR(16777216),
	""ClinicalTrialSubjectReadingID"" VARCHAR(16777216),
	""ClinicalTrialTimePointID"" VARCHAR(16777216),
	""ClinicalTrialTimePointDescription"" VARCHAR(16777216),
	""LongitudinalTemporalOffsetFromEvent"" FLOAT,
	""LongitudinalTemporalEventType"" VARCHAR(16777216),
	""ClinicalTrialCoordinatingCenterName"" VARCHAR(16777216),
	""PatientIdentityRemoved"" VARCHAR(16777216),
	""DeidentificationMethod"" VARIANT,
	""DeidentificationMethodCodeSequence"" VARIANT,
	""ClinicalTrialSeriesID"" VARCHAR(16777216),
	""FNumber"" VARCHAR(16777216),
	""FocalLength"" VARCHAR(16777216),
	""LensSpecification"" VARIANT,
	""LensMake"" VARCHAR(16777216),
	""LensModel"" VARCHAR(16777216),
	""ContrastBolusAgent"" VARCHAR(16777216),
	""BodyPartExamined"" VARCHAR(16777216),
	""ScanningSequence"" VARIANT,
	""SequenceVariant"" VARIANT,
	""ScanOptions"" VARIANT,
	""MRAcquisitionType"" VARCHAR(16777216),
	""SequenceName"" VARCHAR(16777216),
	""AngioFlag"" VARCHAR(16777216),
	""InterventionDrugInformationSequence"" VARIANT,
	""Radiopharmaceutical"" VARCHAR(16777216),
	""CineRate"" VARCHAR(16777216),
	""SliceThickness"" VARCHAR(16777216),
	KVP VARCHAR(16777216),
	""CountsAccumulated"" VARCHAR(16777216),
	""AcquisitionTerminationCondition"" VARCHAR(16777216),
	""EffectiveDuration"" VARCHAR(16777216),
	""AcquisitionStartCondition"" VARCHAR(16777216),
	""AcquisitionStartConditionData"" VARCHAR(16777216),
	""AcquisitionTerminationConditionData"" VARCHAR(16777216),
	""RepetitionTime"" VARCHAR(16777216),
	""EchoTime"" VARCHAR(16777216),
	""InversionTime"" VARCHAR(16777216),
	""NumberOfAverages"" VARCHAR(16777216),
	""ImagingFrequency"" VARCHAR(16777216),
	""ImagedNucleus"" VARCHAR(16777216),
	""EchoNumbers"" VARIANT,
	""MagneticFieldStrength"" VARCHAR(16777216),
	""SpacingBetweenSlices"" VARCHAR(16777216),
	""NumberOfPhaseEncodingSteps"" VARCHAR(16777216),
	""DataCollectionDiameter"" VARCHAR(16777216),
	""EchoTrainLength"" VARCHAR(16777216),
	""PercentSampling"" VARCHAR(16777216),
	""PercentPhaseFieldOfView"" VARCHAR(16777216),
	""PixelBandwidth"" VARCHAR(16777216),
	""DeviceSerialNumber"" VARCHAR(16777216),
	""DeviceUID"" VARCHAR(16777216),
	""PlateID"" VARCHAR(16777216),
	""GantryID"" VARCHAR(16777216),
	""SecondaryCaptureDeviceID"" VARCHAR(16777216),
	""DateOfSecondaryCapture"" DATE,
	""TimeOfSecondaryCapture"" TIME(9),
	""SecondaryCaptureDeviceManufacturer"" VARCHAR(16777216),
	""SecondaryCaptureDeviceManufacturerModelName"" VARCHAR(16777216),
	""SecondaryCaptureDeviceSoftwareVersions"" VARIANT,
	""SoftwareVersions"" VARIANT,
	""VideoImageFormatAcquired"" VARCHAR(16777216),
	""DigitalImageFormatAcquired"" VARCHAR(16777216),
	""ProtocolName"" VARCHAR(16777216),
	""ContrastBolusRoute"" VARCHAR(16777216),
	""ContrastBolusVolume"" VARCHAR(16777216),
	""ContrastBolusStartTime"" TIME(9),
	""ContrastBolusStopTime"" TIME(9),
	""ContrastBolusTotalDose"" VARCHAR(16777216),
	""ContrastFlowRate"" VARIANT,
	""ContrastFlowDuration"" VARIANT,
	""ContrastBolusIngredient"" VARCHAR(16777216),
	""ContrastBolusIngredientConcentration"" VARCHAR(16777216),
	""SpatialResolution"" VARCHAR(16777216),
	""TriggerTime"" VARCHAR(16777216),
	""TriggerSourceOrType"" VARCHAR(16777216),
	""NominalInterval"" VARCHAR(16777216),
	""FrameTime"" VARCHAR(16777216),
	""CardiacFramingType"" VARCHAR(16777216),
	""FrameDelay"" VARCHAR(16777216),
	""SynchronizationTrigger"" VARCHAR(16777216),
	""RadiopharmaceuticalVolume"" VARCHAR(16777216),
	""RadiopharmaceuticalStartTime"" TIME(9),
	""RadionuclideTotalDose"" VARCHAR(16777216),
	""BeatRejectionFlag"" VARCHAR(16777216),
	""LowRRValue"" VARCHAR(16777216),
	""HighRRValue"" VARCHAR(16777216),
	""IntervalsAcquired"" VARCHAR(16777216),
	""IntervalsRejected"" VARCHAR(16777216),
	""PVCRejection"" VARCHAR(16777216),
	""SkipBeats"" VARCHAR(16777216),
	""HeartRate"" VARCHAR(16777216),
	""CardiacNumberOfImages"" VARCHAR(16777216),
	""TriggerWindow"" VARCHAR(16777216),
	""ReconstructionDiameter"" VARCHAR(16777216),
	""DistanceSourceToDetector"" VARCHAR(16777216),
	""DistanceSourceToPatient"" VARCHAR(16777216),
	""EstimatedRadiographicMagnificationFactor"" VARCHAR(16777216),
	""GantryDetectorTilt"" VARCHAR(16777216),
	""GantryDetectorSlew"" VARCHAR(16777216),
	""TableHeight"" VARCHAR(16777216),
	""TableTraverse"" VARCHAR(16777216),
	""RotationDirection"" VARCHAR(16777216),
	""AngularPosition"" VARCHAR(16777216),
	""ScanArc"" VARCHAR(16777216),
	""FieldOfViewShape"" VARCHAR(16777216),
	""FieldOfViewDimensions"" VARIANT,
	""ExposureTime"" VARCHAR(16777216),
	""XRayTubeCurrent"" VARCHAR(16777216),
	""Exposure"" VARCHAR(16777216),
	""ExposureInuAs"" VARCHAR(16777216),
	""AveragePulseWidth"" VARCHAR(16777216),
	""RadiationSetting"" VARCHAR(16777216),
	""RectificationType"" VARCHAR(16777216),
	""RadiationMode"" VARCHAR(16777216),
	""ImageAndFluoroscopyAreaDoseProduct"" VARCHAR(16777216),
	""FilterType"" VARCHAR(16777216),
	""IntensifierSize"" VARCHAR(16777216),
	""ImagerPixelSpacing"" VARIANT,
	""Grid"" VARIANT,
	""GeneratorPower"" VARCHAR(16777216),
	""CollimatorGridName"" VARCHAR(16777216),
	""CollimatorType"" VARCHAR(16777216),
	""XFocusCenter"" VARIANT,
	""YFocusCenter"" VARIANT,
	""FocalSpots"" VARIANT,
	""AnodeTargetMaterial"" VARCHAR(16777216),
	""BodyPartThickness"" VARCHAR(16777216),
	""CompressionForce"" VARCHAR(16777216),
	""PaddleDescription"" VARCHAR(16777216),
	""DateOfLastCalibration"" VARIANT,
	""TimeOfLastCalibration"" VARIANT,
	""ConvolutionKernel"" VARIANT,
	""ActualFrameDuration"" VARCHAR(16777216),
	""CountRate"" VARCHAR(16777216),
	""PreferredPlaybackSequencing"" NUMBER(38,0),
	""ReceiveCoilName"" VARCHAR(16777216),
	""TransmitCoilName"" VARCHAR(16777216),
	""PlateType"" VARCHAR(16777216),
	""ScanVelocity"" VARCHAR(16777216),
	""WholeBodyTechnique"" VARIANT,
	""ScanLength"" VARCHAR(16777216),
	""AcquisitionMatrix"" VARIANT,
	""InPlanePhaseEncodingDirection"" VARCHAR(16777216),
	""FlipAngle"" VARCHAR(16777216),
	""VariableFlipAngleFlag"" VARCHAR(16777216),
	SAR VARCHAR(16777216),
	""dBdt"" VARCHAR(16777216),
	""B1rms"" FLOAT,
	""AcquisitionDeviceProcessingDescription"" VARCHAR(16777216),
	""AcquisitionDeviceProcessingCode"" VARCHAR(16777216),
	""CassetteOrientation"" VARCHAR(16777216),
	""CassetteSize"" VARCHAR(16777216),
	""ExposuresOnPlate"" NUMBER(38,0),
	""RelativeXRayExposure"" VARCHAR(16777216),
	""ExposureIndex"" VARCHAR(16777216),
	""TargetExposureIndex"" VARCHAR(16777216),
	""DeviationIndex"" VARCHAR(16777216),
	""TomoLayerHeight"" VARCHAR(16777216),
	""TomoAngle"" VARCHAR(16777216),
	""TomoTime"" VARCHAR(16777216),
	""TomoType"" VARCHAR(16777216),
	""TomoClass"" VARCHAR(16777216),
	""NumberOfTomosynthesisSourceImages"" VARCHAR(16777216),
	""PositionerMotion"" VARCHAR(16777216),
	""PositionerType"" VARCHAR(16777216),
	""PositionerPrimaryAngle"" VARCHAR(16777216),
	""PositionerSecondaryAngle"" VARCHAR(16777216),
	""DetectorSecondaryAngle"" VARCHAR(16777216),
	""ShutterShape"" VARIANT,
	""ShutterLeftVerticalEdge"" VARCHAR(16777216),
	""ShutterRightVerticalEdge"" VARCHAR(16777216),
	""ShutterUpperHorizontalEdge"" VARCHAR(16777216),
	""ShutterLowerHorizontalEdge"" VARCHAR(16777216),
	""CenterOfCircularShutter"" VARIANT,
	""RadiusOfCircularShutter"" VARCHAR(16777216),
	""VerticesOfThePolygonalShutter"" VARIANT,
	""ShutterPresentationValue"" NUMBER(38,0),
	""CollimatorShape"" VARIANT,
	""CollimatorLeftVerticalEdge"" VARCHAR(16777216),
	""CollimatorRightVerticalEdge"" VARCHAR(16777216),
	""CollimatorUpperHorizontalEdge"" VARCHAR(16777216),
	""CollimatorLowerHorizontalEdge"" VARCHAR(16777216),
	""VerticesOfThePolygonalCollimator"" VARIANT,
	""AcquisitionTimeSynchronized"" VARCHAR(16777216),
	""NominalScannedPixelSpacing"" VARIANT,
	""AcquisitionComments"" VARCHAR(16777216),
	""TransducerData"" VARIANT,
	""ProcessingFunction"" VARCHAR(16777216),
	""PostprocessingFunction"" VARCHAR(16777216),
	""MechanicalIndex"" VARCHAR(16777216),
	""BoneThermalIndex"" VARCHAR(16777216),
	""SoftTissueThermalIndex"" VARCHAR(16777216),
	""PatientPosition"" VARCHAR(16777216),
	""ViewPosition"" VARCHAR(16777216),
	""Sensitivity"" VARCHAR(16777216),
	""SequenceOfUltrasoundRegions"" VARIANT,
	""TransducerType"" VARCHAR(16777216),
	""DetectorConditionsNominalFlag"" VARCHAR(16777216),
	""DetectorTemperature"" VARCHAR(16777216),
	""DetectorType"" VARCHAR(16777216),
	""DetectorConfiguration"" VARCHAR(16777216),
	""DetectorDescription"" VARCHAR(16777216),
	""DetectorMode"" VARCHAR(16777216),
	""DetectorID"" VARCHAR(16777216),
	""DateOfLastDetectorCalibration"" DATE,
	""TimeOfLastDetectorCalibration"" TIME(9),
	""ExposuresOnDetectorSinceLastCalibration"" VARCHAR(16777216),
	""ExposuresOnDetectorSinceManufactured"" VARCHAR(16777216),
	""DetectorTimeSinceLastExposure"" VARCHAR(16777216),
	""DetectorActiveTime"" VARCHAR(16777216),
	""DetectorBinning"" VARIANT,
	""DetectorElementPhysicalSize"" VARIANT,
	""DetectorElementSpacing"" VARIANT,
	""DetectorActiveShape"" VARCHAR(16777216),
	""DetectorActiveDimensions"" VARIANT,
	""DetectorManufacturerName"" VARCHAR(16777216),
	""DetectorManufacturerModelName"" VARCHAR(16777216),
	""FieldOfViewOrigin"" VARIANT,
	""FieldOfViewRotation"" VARCHAR(16777216),
	""FieldOfViewHorizontalFlip"" VARCHAR(16777216),
	""GridAspectRatio"" VARIANT,
	""GridFocalDistance"" VARCHAR(16777216),
	""FilterMaterial"" VARIANT,
	""FilterThicknessMinimum"" VARIANT,
	""FilterThicknessMaximum"" VARIANT,
	""ExposureControlMode"" VARCHAR(16777216),
	""ExposureControlModeDescription"" VARCHAR(16777216),
	""ExposureStatus"" VARCHAR(16777216),
	""ExposureTimeInuS"" VARCHAR(16777216),
	""XRayTubeCurrentInuA"" VARCHAR(16777216),
	""ContentQualification"" VARCHAR(16777216),
	""PulseSequenceName"" VARCHAR(16777216),
	""EchoPulseSequence"" VARCHAR(16777216),
	""InversionRecovery"" VARCHAR(16777216),
	""MultipleSpinEcho"" VARCHAR(16777216),
	""MultiPlanarExcitation"" VARCHAR(16777216),
	""PhaseContrast"" VARCHAR(16777216),
	""TimeOfFlightContrast"" VARCHAR(16777216),
	""Spoiling"" VARCHAR(16777216),
	""SteadyStatePulseSequence"" VARCHAR(16777216),
	""EchoPlanarPulseSequence"" VARCHAR(16777216),
	""TagAngleFirstAxis"" FLOAT,
	""MagnetizationTransfer"" VARCHAR(16777216),
	""T2Preparation"" VARCHAR(16777216),
	""BloodSignalNulling"" VARCHAR(16777216),
	""SaturationRecovery"" VARCHAR(16777216),
	""SpectrallySelectedSuppression"" VARCHAR(16777216),
	""SpectrallySelectedExcitation"" VARCHAR(16777216),
	""SpatialPresaturation"" VARCHAR(16777216),
	""Tagging"" VARCHAR(16777216),
	""OversamplingPhase"" VARCHAR(16777216),
	""TagSpacingFirstDimension"" FLOAT,
	""GeometryOfKSpaceTraversal"" VARCHAR(16777216),
	""SegmentedKSpaceTraversal"" VARCHAR(16777216),
	""RectilinearPhaseEncodeReordering"" VARCHAR(16777216),
	""TagThickness"" FLOAT,
	""PartialFourierDirection"" VARCHAR(16777216),
	""CardiacSynchronizationTechnique"" VARCHAR(16777216),
	""ReceiveCoilType"" VARCHAR(16777216),
	""QuadratureReceiveCoil"" VARCHAR(16777216),
	""MultiCoilDefinitionSequence"" VARIANT,
	""MultiCoilElementName"" VARCHAR(16777216),
	""TransmitCoilType"" VARCHAR(16777216),
	""ChemicalShiftReference"" VARIANT,
	""MRAcquisitionFrequencyEncodingSteps"" NUMBER(38,0),
	""Decoupling"" VARCHAR(16777216),
	""KSpaceFiltering"" VARCHAR(16777216),
	""ParallelReductionFactorInPlane"" FLOAT,
	""AcquisitionDuration"" FLOAT,
	""FrameAcquisitionDateTime"" NUMBER(38,0),
	""DiffusionDirectionality"" VARCHAR(16777216),
	""ParallelAcquisition"" VARCHAR(16777216),
	""ParallelAcquisitionTechnique"" VARCHAR(16777216),
	""InversionTimes"" VARIANT,
	""MetaboliteMapDescription"" VARCHAR(16777216),
	""PartialFourier"" VARCHAR(16777216),
	""EffectiveEchoTime"" FLOAT,
	""CardiacSignalSource"" VARCHAR(16777216),
	""DiffusionBValue"" FLOAT,
	""DiffusionGradientOrientation"" VARIANT,
	""VelocityEncodingDirection"" VARIANT,
	""VelocityEncodingMinimumValue"" FLOAT,
	""NumberOfKSpaceTrajectories"" NUMBER(38,0),
	""CoverageOfKSpace"" VARCHAR(16777216),
	""FrequencyCorrection"" VARCHAR(16777216),
	""FrameReferenceDateTime"" NUMBER(38,0),
	""ParallelReductionFactorOutOfPlane"" FLOAT,
	""ParallelReductionFactorSecondInPlane"" FLOAT,
	""CardiacBeatRejectionTechnique"" VARCHAR(16777216),
	""RespiratoryMotionCompensationTechnique"" VARCHAR(16777216),
	""RespiratorySignalSource"" VARCHAR(16777216),
	""BulkMotionCompensationTechnique"" VARCHAR(16777216),
	""ApplicableSafetyStandardAgency"" VARCHAR(16777216),
	""SpecificAbsorptionRateDefinition"" VARCHAR(16777216),
	""GradientOutputType"" VARCHAR(16777216),
	""SpecificAbsorptionRateValue"" FLOAT,
	""GradientOutput"" FLOAT,
	""FlowCompensationDirection"" VARCHAR(16777216),
	""WaterReferencedPhaseCorrection"" VARCHAR(16777216),
	""FrameAcquisitionDuration"" FLOAT,
	""MRAcquisitionPhaseEncodingStepsInPlane"" NUMBER(38,0),
	""MRAcquisitionPhaseEncodingStepsOutOfPlane"" NUMBER(38,0),
	""RFEchoTrainLength"" NUMBER(38,0),
	""GradientEchoTrainLength"" NUMBER(38,0),
	""AcquisitionType"" VARCHAR(16777216),
	""TubeAngle"" FLOAT,
	""RevolutionTime"" FLOAT,
	""SingleCollimationWidth"" FLOAT,
	""TotalCollimationWidth"" FLOAT,
	""TableSpeed"" FLOAT,
	""TableFeedPerRotation"" FLOAT,
	""SpiralPitchFactor"" FLOAT,
	""DataCollectionCenterPatient"" VARIANT,
	""ReconstructionTargetCenterPatient"" VARIANT,
	""CTExposureSequence"" VARIANT,
	""ExposureModulationType"" VARIANT,
	""EstimatedDoseSaving"" FLOAT,
	""TablePosition"" FLOAT,
	""ExposureTimeInms"" FLOAT,
	""XRayTubeCurrentInmA"" FLOAT,
	""ExposureInmAs"" FLOAT,
	""FluoroscopyFlag"" VARCHAR(16777216),
	""CTDIvol"" FLOAT,
	""CTDIPhantomTypeCodeSequence"" VARIANT,
	""CalciumScoringMassFactorDevice"" VARIANT,
	""EnergyWeightingFactor"" FLOAT,
	""CTAdditionalXRaySourceSequence"" VARIANT,
	""ContributingSourcesSequence"" VARIANT,
	""XRay3DAcquisitionSequence"" VARIANT,
	""XRay3DReconstructionSequence"" VARIANT,
	""PositionerPrimaryAngleDirection"" VARCHAR(16777216),
	""DiffusionBValueXX"" FLOAT,
	""DiffusionBValueXY"" FLOAT,
	""DiffusionBValueXZ"" FLOAT,
	""DiffusionBValueYY"" FLOAT,
	""DiffusionBValueYZ"" FLOAT,
	""DiffusionBValueZZ"" FLOAT,
	""ContributingEquipmentSequence"" VARIANT,
	""StudyInstanceUID"" VARCHAR(16777216),
	""SeriesInstanceUID"" VARCHAR(16777216),
	""StudyID"" VARCHAR(16777216),
	""SeriesNumber"" VARCHAR(16777216),
	""AcquisitionNumber"" VARCHAR(16777216),
	""InstanceNumber"" VARCHAR(16777216),
	""ItemNumber"" VARCHAR(16777216),
	""PatientOrientation"" VARIANT,
	""ImagePosition"" VARIANT,
	""ImagePositionPatient"" VARIANT,
	""ImageOrientation"" VARIANT,
	""ImageOrientationPatient"" VARIANT,
	""Location"" VARCHAR(16777216),
	""FrameOfReferenceUID"" VARCHAR(16777216),
	""Laterality"" VARCHAR(16777216),
	""ImageLaterality"" VARCHAR(16777216),
	""ImageGeometryType"" VARCHAR(16777216),
	""TemporalPositionIdentifier"" VARCHAR(16777216),
	""NumberOfTemporalPositions"" VARCHAR(16777216),
	""TemporalResolution"" VARCHAR(16777216),
	""SynchronizationFrameOfReferenceUID"" VARCHAR(16777216),
	""AcquisitionsInSeries"" VARCHAR(16777216),
	""ImagesInAcquisition"" VARCHAR(16777216),
	""ImagesInSeries"" VARCHAR(16777216),
	""PositionReferenceIndicator"" VARCHAR(16777216),
	""SliceLocation"" VARCHAR(16777216),
	""NumberOfStudyRelatedSeries"" VARCHAR(16777216),
	""NumberOfStudyRelatedInstances"" VARCHAR(16777216),
	""NumberOfSeriesRelatedInstances"" VARCHAR(16777216),
	""ImageComments"" VARCHAR(16777216),
	""OriginalImageIdentification"" VARIANT,
	""OriginalImageIdentificationNomenclature"" VARIANT,
	""StackID"" VARCHAR(16777216),
	""InStackPositionNumber"" NUMBER(38,0),
	""FrameLaterality"" VARCHAR(16777216),
	""TemporalPositionIndex"" NUMBER(38,0),
	""DimensionIndexValues"" VARIANT,
	""FrameComments"" VARCHAR(16777216),
	""ConcatenationUID"" VARCHAR(16777216),
	""DimensionOrganizationUID"" VARCHAR(16777216),
	""DimensionOrganizationSequence"" VARIANT,
	""DimensionIndexSequence"" VARIANT,
	""NominalPercentageOfCardiacPhase"" FLOAT,
	""RespiratoryIntervalTime"" FLOAT,
	""NominalRespiratoryTriggerDelayTime"" FLOAT,
	""RespiratoryTriggerDelayThreshold"" FLOAT,
	""DimensionOrganizationType"" VARCHAR(16777216),
	""SamplesPerPixel"" NUMBER(38,0),
	""PhotometricInterpretation"" VARCHAR(16777216),
	""ImageDimensions"" NUMBER(38,0),
	""PlanarConfiguration"" NUMBER(38,0),
	""NumberOfFrames"" VARCHAR(16777216),
	""FrameIncrementPointer"" VARIANT,
	""Rows"" NUMBER(38,0),
	""Columns"" NUMBER(38,0),
	""Planes"" NUMBER(38,0),
	""UltrasoundColorDataPresent"" NUMBER(38,0),
	""PixelSpacing"" VARIANT,
	""ZoomFactor"" VARIANT,
	""ZoomCenter"" VARIANT,
	""PixelAspectRatio"" VARIANT,
	""ImageFormat"" VARCHAR(16777216),
	""ManipulatedImage"" VARIANT,
	""CorrectedImage"" VARIANT,
	""CompressionCode"" VARCHAR(16777216),
	""BitsAllocated"" NUMBER(38,0),
	""BitsStored"" NUMBER(38,0),
	""HighBit"" NUMBER(38,0),
	""PixelRepresentation"" NUMBER(38,0),
	""SmallestValidPixelValue"" NUMBER(38,0),
	""LargestValidPixelValue"" NUMBER(38,0),
	""SmallestImagePixelValue"" NUMBER(38,0),
	""LargestImagePixelValue"" NUMBER(38,0),
	""SmallestPixelValueInSeries"" NUMBER(38,0),
	""LargestPixelValueInSeries"" NUMBER(38,0),
	""PixelPaddingValue"" NUMBER(38,0),
	""PixelPaddingRangeLimit"" NUMBER(38,0),
	""ImageLocation"" NUMBER(38,0),
	""QualityControlImage"" VARCHAR(16777216),
	""BurnedInAnnotation"" VARCHAR(16777216),
	""RecognizableVisualFeatures"" VARCHAR(16777216),
	""LongitudinalTemporalInformationModified"" VARCHAR(16777216),
	""PixelSpacingCalibrationType"" VARCHAR(16777216),
	""PixelSpacingCalibrationDescription"" VARCHAR(16777216),
	""PixelIntensityRelationship"" VARCHAR(16777216),
	""PixelIntensityRelationshipSign"" NUMBER(38,0),
	""WindowCenter"" VARIANT,
	""WindowWidth"" VARIANT,
	""RescaleIntercept"" VARCHAR(16777216),
	""RescaleSlope"" VARCHAR(16777216),
	""RescaleType"" VARCHAR(16777216),
	""WindowCenterWidthExplanation"" VARIANT,
	""VOILUTFunction"" VARCHAR(16777216),
	""RedPaletteColorLookupTableDescriptor"" VARIANT,
	""GreenPaletteColorLookupTableDescriptor"" VARIANT,
	""BluePaletteColorLookupTableDescriptor"" VARIANT,
	""PaletteColorLookupTableUID"" VARCHAR(16777216),
	""LargePaletteColorLookupTableUID"" VARCHAR(16777216),
	""BreastImplantPresent"" VARCHAR(16777216),
	""PartialView"" VARCHAR(16777216),
	""LossyImageCompression"" VARCHAR(16777216),
	""LossyImageCompressionRatio"" VARIANT,
	""LossyImageCompressionMethod"" VARIANT,
	""LUTExplanation"" VARCHAR(16777216),
	""VOILUTSequence"" VARIANT,
	""SoftcopyVOILUTSequence"" VARIANT,
	""RepresentativeFrameNumber"" NUMBER(38,0),
	""FrameOfInterestDescription"" VARIANT,
	""DataPointRows"" NUMBER(38,0),
	""DataPointColumns"" NUMBER(38,0),
	""StudyStatusID"" VARCHAR(16777216),
	""StudyPriorityID"" VARCHAR(16777216),
	""StudyReadDate"" DATE,
	""StudyReadTime"" TIME(9),
	""ScheduledStudyStartDate"" DATE,
	""ScheduledStudyStartTime"" TIME(9),
	""ScheduledStudyLocation"" VARCHAR(16777216),
	""ScheduledStudyLocationAETitle"" VARIANT,
	""ReasonForStudy"" VARCHAR(16777216),
	""StudyArrivalDate"" DATE,
	""StudyArrivalTime"" TIME(9),
	""StudyCompletionDate"" DATE,
	""StudyCompletionTime"" TIME(9),
	""RequestedProcedureDescription"" VARCHAR(16777216),
	""RequestedProcedureCodeSequence"" VARIANT,
	""RequestedContrastAgent"" VARCHAR(16777216),
	""StudyComments"" VARCHAR(16777216),
	""RouteOfAdmissions"" VARCHAR(16777216),
	""AdmittingDate"" DATE,
	""AdmittingTime"" TIME(9),
	""DischargeTime"" TIME(9),
	""SpecialNeeds"" VARCHAR(16777216),
	""PatientState"" VARCHAR(16777216),
	""ScheduledProcedureStepStartDate"" DATE,
	""ScheduledProcedureStepStartTime"" TIME(9),
	""ScheduledProcedureStepEndDate"" DATE,
	""ScheduledProcedureStepEndTime"" TIME(9),
	""ScheduledProcedureStepDescription"" VARCHAR(16777216),
	""ScheduledProtocolCodeSequence"" VARIANT,
	""ScheduledProcedureStepID"" VARCHAR(16777216),
	""ScheduledStationName"" VARIANT,
	""ScheduledProcedureStepSequence"" VARIANT,
	""PerformedStationAETitle"" VARCHAR(16777216),
	""PerformedStationName"" VARCHAR(16777216),
	""PerformedProcedureStepStartDate"" DATE,
	""PerformedProcedureStepStartTime"" TIME(9),
	""PerformedProcedureStepEndDate"" DATE,
	""PerformedProcedureStepEndTime"" TIME(9),
	""PerformedProcedureStepID"" VARCHAR(16777216),
	""PerformedProcedureStepDescription"" VARCHAR(16777216),
	""PerformedProtocolCodeSequence"" VARIANT,
	""RequestAttributesSequence"" VARIANT,
	""CommentsOnThePerformedProcedureStep"" VARCHAR(16777216),
	""TotalNumberOfExposures"" NUMBER(38,0),
	""EntranceDose"" NUMBER(38,0),
	""ExposedArea"" VARIANT,
	""DistanceSourceToEntrance"" VARCHAR(16777216),
	""ExposureDoseSequence"" VARIANT,
	""CommentsOnRadiationDose"" VARCHAR(16777216),
	""HalfValueLayer"" VARCHAR(16777216),
	""OrganDose"" VARCHAR(16777216),
	""OrganExposed"" VARCHAR(16777216),
	""ContainerIdentifier"" VARCHAR(16777216),
	""ContainerTypeCodeSequence"" VARIANT,
	""AcquisitionContextSequence"" VARIANT,
	""SpecimenDescriptionSequence"" VARIANT,
	""RequestedProcedureID"" VARCHAR(16777216),
	""ReasonForTheRequestedProcedure"" VARCHAR(16777216),
	""RequestedProcedurePriority"" VARCHAR(16777216),
	""ConfidentialityCode"" VARCHAR(16777216),
	""ReasonForRequestedProcedureCodeSequence"" VARIANT,
	""RequestedProcedureComments"" VARCHAR(16777216),
	""ReasonForTheImagingServiceRequest"" VARCHAR(16777216),
	""IssueDateOfImagingServiceRequest"" DATE,
	""IssueTimeOfImagingServiceRequest"" TIME(9),
	""FillerOrderNumberImagingServiceRequest"" VARCHAR(16777216),
	""ImagingServiceRequestComments"" VARCHAR(16777216),
	""ReferencedGeneralPurposeScheduledProcedureStepTransactionUID"" VARCHAR(16777216),
	""EntranceDoseInmGy"" VARCHAR(16777216),
	""ReferencedImageRealWorldValueMappingSequence"" VARIANT,
	""RealWorldValueMappingSequence"" VARIANT,
	""LUTLabel"" VARCHAR(16777216),
	""ObservationDateTime"" NUMBER(38,0),
	""ValueType"" VARCHAR(16777216),
	""ConceptNameCodeSequence"" VARIANT,
	""ContinuityOfContent"" VARCHAR(16777216),
	""VerifyingObserverSequence"" VARIANT,
	""VerifyingObserverName"" VARIANT,
	""DateTime"" NUMBER(38,0),
	""PersonName"" VARIANT,
	UID VARCHAR(16777216),
	""PredecessorDocumentsSequence"" VARIANT,
	""ReferencedRequestSequence"" VARIANT,
	""PerformedProcedureCodeSequence"" VARIANT,
	""CurrentRequestedProcedureEvidenceSequence"" VARIANT,
	""CompletionFlag"" VARCHAR(16777216),
	""VerificationFlag"" VARCHAR(16777216),
	""PreliminaryFlag"" VARCHAR(16777216),
	""ContentTemplateSequence"" VARIANT,
	""ContentSequence"" VARIANT,
	""TemplateExtensionOrganizationUID"" VARCHAR(16777216),
	""TemplateExtensionCreatorUID"" VARCHAR(16777216),
	""MIMETypeOfEncapsulatedDocument"" VARCHAR(16777216),
	""EncapsulatedDocumentLength"" NUMBER(38,0),
	""ImagedVolumeWidth"" FLOAT,
	""ImagedVolumeHeight"" FLOAT,
	""ImagedVolumeDepth"" FLOAT,
	""TotalPixelMatrixColumns"" NUMBER(38,0),
	""TotalPixelMatrixRows"" NUMBER(38,0),
	""TotalPixelMatrixOriginSequence"" VARIANT,
	""SpecimenLabelInImage"" VARCHAR(16777216),
	""FocusMethod"" VARCHAR(16777216),
	""ExtendedDepthOfField"" VARCHAR(16777216),
	""RecommendedAbsentPixelCIELabValue"" VARIANT,
	""ImageOrientationSlide"" VARIANT,
	""OpticalPathSequence"" VARIANT,
	""NumberOfOpticalPaths"" NUMBER(38,0),
	""TotalPixelMatrixFocalPlanes"" NUMBER(38,0),
	""CalibrationImage"" VARCHAR(16777216),
	""EnergyWindowVector"" VARIANT,
	""NumberOfEnergyWindows"" NUMBER(38,0),
	""EnergyWindowInformationSequence"" VARIANT,
	""EnergyWindowRangeSequence"" VARIANT,
	""RadiopharmaceuticalInformationSequence"" VARIANT,
	""DetectorVector"" VARIANT,
	""NumberOfDetectors"" NUMBER(38,0),
	""DetectorInformationSequence"" VARIANT,
	""PhaseVector"" VARIANT,
	""NumberOfPhases"" NUMBER(38,0),
	""PhaseInformationSequence"" VARIANT,
	""NumberOfRotations"" NUMBER(38,0),
	""RotationInformationSequence"" VARIANT,
	""NumberOfRRIntervals"" NUMBER(38,0),
	""NumberOfTimeSlots"" NUMBER(38,0),
	""SliceVector"" VARIANT,
	""NumberOfSlices"" NUMBER(38,0),
	""TimeSliceVector"" VARIANT,
	""NumberOfTimeSlices"" NUMBER(38,0),
	""TypeOfDetectorMotion"" VARCHAR(16777216),
	""ViewCodeSequence"" VARIANT,
	""ViewModifierCodeSequence"" VARIANT,
	""ImageID"" VARCHAR(16777216),
	""PatientOrientationCodeSequence"" VARIANT,
	""PatientOrientationModifierCodeSequence"" VARIANT,
	""PatientGantryRelationshipCodeSequence"" VARIANT,
	""ScanProgressionDirection"" VARCHAR(16777216),
	""SeriesType"" VARIANT,
	""Units"" VARCHAR(16777216),
	""CountsSource"" VARCHAR(16777216),
	""ReprojectionMethod"" VARCHAR(16777216),
	""RandomsCorrectionMethod"" VARCHAR(16777216),
	""AttenuationCorrectionMethod"" VARCHAR(16777216),
	""DecayCorrection"" VARCHAR(16777216),
	""ReconstructionMethod"" VARCHAR(16777216),
	""DetectorLinesOfResponseUsed"" VARCHAR(16777216),
	""ScatterCorrectionMethod"" VARCHAR(16777216),
	""AxialAcceptance"" VARCHAR(16777216),
	""AxialMash"" VARIANT,
	""TransverseMash"" VARCHAR(16777216),
	""CoincidenceWindowWidth"" VARCHAR(16777216),
	""SecondaryCountsType"" VARIANT,
	""FrameReferenceTime"" VARCHAR(16777216),
	""PrimaryPromptsCountsAccumulated"" VARCHAR(16777216),
	""SecondaryCountsAccumulated"" VARIANT,
	""SliceSensitivityFactor"" VARCHAR(16777216),
	""DecayFactor"" VARCHAR(16777216),
	""DoseCalibrationFactor"" VARCHAR(16777216),
	""ScatterFractionFactor"" VARCHAR(16777216),
	""DeadTimeFactor"" VARCHAR(16777216),
	""ImageIndex"" NUMBER(38,0),
	""HistogramSequence"" VARIANT,
	""SegmentationType"" VARCHAR(16777216),
	""SegmentSequence"" VARIANT,
	""MaximumFractionalValue"" NUMBER(38,0),
	""SegmentationFractionalType"" VARCHAR(16777216),
	""SegmentsOverlap"" VARCHAR(16777216),
	""ImageRotation"" NUMBER(38,0),
	""DisplayedAreaSelectionSequence"" VARIANT,
	""GraphicLayerSequence"" VARIANT,
	""ContentLabel"" VARCHAR(16777216),
	""ContentDescription"" VARCHAR(16777216),
	""PresentationCreationDate"" DATE,
	""PresentationCreationTime"" TIME(9),
	""ContentCreatorName"" VARIANT,
	""RegistrationSequence"" VARIANT,
	""FiducialUID"" VARCHAR(16777216),
	""RelativeOpacity"" FLOAT,
	""AdvancedBlendingSequence"" VARIANT,
	""BlendingDisplaySequence"" VARIANT,
	""StorageMediaFileSetUID"" VARCHAR(16777216),
	""IconImageSequence"" VARIANT,
	""DigitalSignatureUID"" VARCHAR(16777216),
	""ImageDisplayFormat"" VARCHAR(16777216),
	""AnnotationDisplayFormatID"" VARCHAR(16777216),
	""FilmOrientation"" VARCHAR(16777216),
	""BorderDensity"" VARCHAR(16777216),
	""Trim"" VARCHAR(16777216),
	""ImageBoxPosition"" NUMBER(38,0),
	""PresentationLUTShape"" VARCHAR(16777216),
	""DoseUnits"" VARCHAR(16777216),
	""DoseType"" VARCHAR(16777216),
	""DoseComment"" VARCHAR(16777216),
	""DoseSummationType"" VARCHAR(16777216),
	""GridFrameOffsetVector"" VARIANT,
	""DoseGridScaling"" VARCHAR(16777216),
	""TissueHeterogeneityCorrection"" VARIANT,
	""StructureSetLabel"" VARCHAR(16777216),
	""StructureSetName"" VARCHAR(16777216),
	""StructureSetDate"" DATE,
	""StructureSetTime"" TIME(9),
	""ReferencedFrameOfReferenceSequence"" VARIANT,
	""StructureSetROISequence"" VARIANT,
	""ReferencedFrameOfReferenceUID"" VARCHAR(16777216),
	""ROIContourSequence"" VARIANT,
	""RTROIObservationsSequence"" VARIANT,
	""RelatedFrameOfReferenceUID"" VARCHAR(16777216),
	""RTPlanLabel"" VARCHAR(16777216),
	""RTPlanName"" VARCHAR(16777216),
	""RTPlanDescription"" VARCHAR(16777216),
	""RTPlanDate"" DATE,
	""RTPlanGeometry"" VARCHAR(16777216),
	""DoseReferenceSequence"" VARIANT,
	""DoseReferenceUID"" VARCHAR(16777216),
	""FractionGroupSequence"" VARIANT,
	""BeamSequence"" VARIANT,
	""GantryAngle"" VARCHAR(16777216),
	""PatientSupportAngle"" VARCHAR(16777216),
	""TableTopLongitudinalPosition"" VARCHAR(16777216),
	""TableTopLateralPosition"" VARCHAR(16777216),
	""TableTopPitchAngle"" FLOAT,
	""TableTopRollAngle"" FLOAT,
	""PatientSetupSequence"" VARIANT,
	""PatientSetupNumber"" VARCHAR(16777216),
	""ReferencedRTPlanSequence"" VARIANT,
	""ReferencedStructureSetSequence"" VARIANT,
	""ApprovalStatus"" VARCHAR(16777216),
	""InterpretationTypeID"" VARCHAR(16777216),
	""InterpretationStatusID"" VARCHAR(16777216),
	""CurveDimensions"" VARIANT,
	""NumberOfPoints"" VARIANT,
	""TypeOfData"" VARIANT,
	""DataValueRepresentation"" VARIANT,
	""SharedFunctionalGroupsSequence"" VARIANT,
	""PerFrameFunctionalGroupsSequence"" VARIANT,
	""OverlayRows"" VARIANT,
	""OverlayColumns"" VARIANT,
	""NumberOfFramesInOverlay"" VARIANT,
	""OverlayDescription"" VARIANT,
	""OverlayType"" VARIANT,
	""OverlayOrigin"" VARIANT,
	""ImageFrameOrigin"" VARIANT,
	""OverlayBitsAllocated"" VARIANT,
	""OverlayBitPosition"" VARIANT,
	""Tag_00091110"" VARIANT,
	""Tag_00291032"" VARIANT,
	""Tag_00291140"" VARIANT,
	""Tag_00551012"" VARIANT,
	""Tag_00551022"" VARIANT,
	""Tag_01171010"" VARIANT,
	""Tag_01171020"" VARIANT,
	""Tag_01171022"" VARIANT,
	""Tag_01171024"" VARIANT,
	""Tag_011710B0"" VARIANT,
	""Tag_01191180"" VARIANT,
	""Tag_01F31001"" VARIANT,
	""Tag_01F31011"" VARIANT,
	""Tag_2001105F"" VARIANT,
	""Tag_20019000"" VARIANT,
	""Tag_20051080"" VARIANT,
	""Tag_20051084"" VARIANT,
	""Tag_20051085"" VARIANT,
	""Tag_20051132"" VARIANT,
	""Tag_20051402"" VARIANT,
	""Tag_2005140E"" VARIANT,
	""Tag_2005140F"" VARIANT,
	""OtherElements"" VARIANT,
	""DroppedTags"" VARIANT,
	""Type"" VARCHAR(16777216),
	""LastUpdated"" NUMBER(38,0),
	""StorageClass"" VARCHAR(16777216),
	""BlobStorageSize"" NUMBER(38,0)
);"

,1
table_name,DICOM_METADATA_CURATED
description,
DDL,"create or replace TABLE DICOM_METADATA_CURATED (
	""SOPInstanceUID"" VARCHAR(16777216),
	""SliceThickness"" FLOAT,
	""BodyPartExamined"" VARCHAR(16777216)
);"

,2
table_name,AUXILIARY_METADATA
description,
DDL,"create or replace TABLE AUXILIARY_METADATA (
	""collection_name"" VARCHAR(16777216),
	""collection_id"" VARCHAR(16777216),
	""collection_timestamp"" NUMBER(38,0),
	""collection_hash"" VARCHAR(16777216),
	""collection_init_idc_version"" NUMBER(38,0),
	""collection_revised_idc_version"" NUMBER(38,0),
	""submitter_case_id"" VARCHAR(16777216),
	""idc_case_id"" VARCHAR(16777216),
	""patient_hash"" VARCHAR(16777216),
	""patient_init_idc_version"" NUMBER(38,0),
	""patient_revised_idc_version"" NUMBER(38,0),
	""StudyInstanceUID"" VARCHAR(16777216),
	""study_uuid"" VARCHAR(16777216),
	""study_instances"" NUMBER(38,0),
	""study_hash"" VARCHAR(16777216),
	""study_init_idc_version"" NUMBER(38,0),
	""study_revised_idc_version"" NUMBER(38,0),
	""study_final_idc_version"" NUMBER(38,0),
	""SeriesInstanceUID"" VARCHAR(16777216),
	""series_uuid"" VARCHAR(16777216),
	""series_gcs_url"" VARCHAR(16777216),
	""series_aws_url"" VARCHAR(16777216),
	""source_doi"" VARCHAR(16777216),
	""source_url"" VARCHAR(16777216),
	""series_instances"" NUMBER(38,0),
	""series_hash"" VARCHAR(16777216),
	""access"" VARCHAR(16777216),
	""series_init_idc_version"" NUMBER(38,0),
	""series_revised_idc_version"" NUMBER(38,0),
	""series_final_idc_version"" NUMBER(38,0),
	""SOPInstanceUID"" VARCHAR(16777216),
	""instance_uuid"" VARCHAR(16777216),
	""gcs_url"" VARCHAR(16777216),
	""gcs_bucket"" VARCHAR(16777216),
	""aws_url"" VARCHAR(16777216),
	""aws_bucket"" VARCHAR(16777216),
	""instance_size"" NUMBER(38,0),
	""instance_hash"" VARCHAR(16777216),
	""instance_init_idc_version"" NUMBER(38,0),
	""instance_revised_idc_version"" NUMBER(38,0),
	""instance_final_idc_version"" NUMBER(38,0),
	""license_url"" VARCHAR(16777216),
	""license_long_name"" VARCHAR(16777216),
	""license_short_name"" VARCHAR(16777216),
	""tcia_api_collection_id"" VARCHAR(16777216),
	""idc_webapp_collection_id"" VARCHAR(16777216)
);"

,3
table_name,DICOM_ALL
description,
DDL,"create or replace TABLE DICOM_ALL (
	""collection_name"" VARCHAR(16777216),
	""collection_id"" VARCHAR(16777216),
	""collection_timestamp"" NUMBER(38,0),
	""collection_hash"" VARCHAR(16777216),
	""collection_init_idc_version"" NUMBER(38,0),
	""collection_revised_idc_version"" NUMBER(38,0),
	""collection_tumorLocation"" VARCHAR(16777216),
	""collection_species"" VARCHAR(16777216),
	""collection_cancerType"" VARCHAR(16777216),
	""access"" VARCHAR(16777216),
	""PatientID"" VARCHAR(16777216),
	""idc_case_id"" VARCHAR(16777216),
	""patient_hash"" VARCHAR(16777216),
	""patient_init_idc_version"" NUMBER(38,0),
	""patient_revised_idc_version"" NUMBER(38,0),
	""StudyInstanceUID"" VARCHAR(16777216),
	""crdc_study_uuid"" VARCHAR(16777216),
	""study_hash"" VARCHAR(16777216),
	""study_init_idc_version"" NUMBER(38,0),
	""study_revised_idc_version"" NUMBER(38,0),
	""SeriesInstanceUID"" VARCHAR(16777216),
	""crdc_series_uuid"" VARCHAR(16777216),
	""series_gcs_url"" VARCHAR(16777216),
	""series_aws_url"" VARCHAR(16777216),
	""series_hash"" VARCHAR(16777216),
	""series_init_idc_version"" NUMBER(38,0),
	""series_revised_idc_version"" NUMBER(38,0),
	""SOPInstanceUID"" VARCHAR(16777216),
	""crdc_instance_uuid"" VARCHAR(16777216),
	""gcs_url"" VARCHAR(16777216),
	""gcs_bucket"" VARCHAR(16777216),
	""aws_url"" VARCHAR(16777216),
	""aws_bucket"" VARCHAR(16777216),
	""instance_size"" NUMBER(38,0),
	""instance_hash"" VARCHAR(16777216),
	""instance_init_idc_version"" NUMBER(38,0),
	""instance_revised_idc_version"" NUMBER(38,0),
	""Source_DOI"" VARCHAR(16777216),
	""Source_URL"" VARCHAR(16777216),
	""license_url"" VARCHAR(16777216),
	""license_long_name"" VARCHAR(16777216),
	""license_short_name"" VARCHAR(16777216),
	""tcia_api_collection_id"" VARCHAR(16777216),
	""idc_webapp_collection_id"" VARCHAR(16777216),
	""tcia_tumorLocation"" VARCHAR(16777216),
	""tcia_species"" VARCHAR(16777216),
	""tcia_cancerType"" VARCHAR(16777216),
	""MediaStorageSOPClassUID"" VARCHAR(16777216),
	""MediaStorageSOPInstanceUID"" VARCHAR(16777216),
	""TransferSyntaxUID"" VARCHAR(16777216),
	""ImplementationClassUID"" VARCHAR(16777216),
	""ImplementationVersionName"" VARCHAR(16777216),
	""SourceApplicationEntityTitle"" VARCHAR(16777216),
	""ReferencedFileID"" VARIANT,
	""ReferencedSOPInstanceUIDInFile"" VARCHAR(16777216),
	""LengthToEnd"" NUMBER(38,0),
	""SpecificCharacterSet"" VARIANT,
	""ImageType"" VARIANT,
	""RecognitionCode"" VARCHAR(16777216),
	""InstanceCreationDate"" DATE,
	""InstanceCreationTime"" TIME(9),
	""InstanceCreatorUID"" VARCHAR(16777216),
	""SOPClassUID"" VARCHAR(16777216),
	""OriginalSpecializedSOPClassUID"" VARCHAR(16777216),
	""StudyDate"" DATE,
	""SeriesDate"" DATE,
	""AcquisitionDate"" DATE,
	""ContentDate"" DATE,
	""OverlayDate"" DATE,
	""CurveDate"" DATE,
	""AcquisitionDateTime"" NUMBER(38,0),
	""StudyTime"" TIME(9),
	""SeriesTime"" TIME(9),
	""AcquisitionTime"" TIME(9),
	""ContentTime"" TIME(9),
	""DataSetType"" NUMBER(38,0),
	""DataSetSubtype"" VARCHAR(16777216),
	""AccessionNumber"" VARCHAR(16777216),
	""IssuerOfAccessionNumberSequence"" VARIANT,
	""RetrieveAETitle"" VARIANT,
	""FailedSOPInstanceUIDList"" VARIANT,
	""Modality"" VARCHAR(16777216),
	""ModalitiesInStudy"" VARIANT,
	""ConversionType"" VARCHAR(16777216),
	""PresentationIntentType"" VARCHAR(16777216),
	""Manufacturer"" VARCHAR(16777216),
	""InstitutionName"" VARCHAR(16777216),
	""InstitutionAddress"" VARCHAR(16777216),
	""ReferringPhysicianName"" VARIANT,
	""ReferringPhysicianAddress"" VARCHAR(16777216),
	""ReferringPhysicianTelephoneNumbers"" VARIANT,
	""CodeValue"" VARCHAR(16777216),
	""CodingSchemeDesignator"" VARCHAR(16777216),
	""CodingSchemeUID"" VARCHAR(16777216),
	""ContextGroupExtensionCreatorUID"" VARCHAR(16777216),
	""ContextIdentifier"" VARCHAR(16777216),
	""CodingSchemeIdentificationSequence"" VARIANT,
	""ContextGroupIdentificationSequence"" VARIANT,
	""MappingResourceIdentificationSequence"" VARIANT,
	""TimezoneOffsetFromUTC"" VARCHAR(16777216),
	""StationName"" VARCHAR(16777216),
	""StudyDescription"" VARCHAR(16777216),
	""ProcedureCodeSequence"" VARIANT,
	""SeriesDescription"" VARCHAR(16777216),
	""InstitutionalDepartmentName"" VARCHAR(16777216),
	""PerformingPhysicianName"" VARIANT,
	""OperatorsName"" VARIANT,
	""AdmittingDiagnosesDescription"" VARIANT,
	""AdmittingDiagnosesCodeSequence"" VARIANT,
	""ManufacturerModelName"" VARCHAR(16777216),
	""ReferencedStudySequence"" VARIANT,
	""ReferencedPerformedProcedureStepSequence"" VARIANT,
	""ReferencedSeriesSequence"" VARIANT,
	""ReferencedPatientSequence"" VARIANT,
	""ReferencedImageSequence"" VARIANT,
	""ReferencedSOPClassUID"" VARCHAR(16777216),
	""ReferencedSOPInstanceUID"" VARCHAR(16777216),
	""TransactionUID"" VARCHAR(16777216),
	""StudiesContainingOtherReferencedInstancesSequence"" VARIANT,
	""RelatedSeriesSequence"" VARIANT,
	""LossyImageCompressionRetired"" VARCHAR(16777216),
	""DerivationDescription"" VARCHAR(16777216),
	""SourceImageSequence"" VARIANT,
	""StartTrim"" VARCHAR(16777216),
	""StopTrim"" VARCHAR(16777216),
	""RecommendedDisplayFrameRate"" VARCHAR(16777216),
	""AnatomicRegionSequence"" VARIANT,
	""IrradiationEventUID"" VARIANT,
	""SourceIrradiationEventSequence"" VARIANT,
	""FrameType"" VARIANT,
	""ReferencedImageEvidenceSequence"" VARIANT,
	""ReferencedRawDataSequence"" VARIANT,
	""CreatorVersionUID"" VARCHAR(16777216),
	""DerivationImageSequence"" VARIANT,
	""PixelPresentation"" VARCHAR(16777216),
	""VolumetricProperties"" VARCHAR(16777216),
	""VolumeBasedCalculationTechnique"" VARCHAR(16777216),
	""ComplexImageComponent"" VARCHAR(16777216),
	""AcquisitionContrast"" VARCHAR(16777216),
	""DerivationCodeSequence"" VARIANT,
	""PatientName"" VARIANT,
	""IssuerOfPatientID"" VARCHAR(16777216),
	""TypeOfPatientID"" VARCHAR(16777216),
	""IssuerOfPatientIDQualifiersSequence"" VARIANT,
	""SourcePatientGroupIdentificationSequence"" VARIANT,
	""PatientBirthDate"" DATE,
	""PatientBirthTime"" TIME(9),
	""PatientSex"" VARCHAR(16777216),
	""QualityControlSubject"" VARCHAR(16777216),
	""StrainDescription"" VARCHAR(16777216),
	""StrainNomenclature"" VARCHAR(16777216),
	""StrainCodeSequence"" VARIANT,
	""OtherPatientIDs"" VARIANT,
	""PatientAge"" VARCHAR(16777216),
	""PatientSize"" VARCHAR(16777216),
	""PatientWeight"" VARCHAR(16777216),
	""PatientAddress"" VARCHAR(16777216),
	""MedicalAlerts"" VARIANT,
	""Allergies"" VARIANT,
	""PatientTelephoneNumbers"" VARIANT,
	""EthnicGroup"" VARCHAR(16777216),
	""Occupation"" VARCHAR(16777216),
	""SmokingStatus"" VARCHAR(16777216),
	""AdditionalPatientHistory"" VARCHAR(16777216),
	""PregnancyStatus"" NUMBER(38,0),
	""LastMenstrualDate"" DATE,
	""PatientSpeciesDescription"" VARCHAR(16777216),
	""PatientSpeciesCodeSequence"" VARIANT,
	""PatientSexNeutered"" VARCHAR(16777216),
	""AnatomicalOrientationType"" VARCHAR(16777216),
	""PatientBreedDescription"" VARCHAR(16777216),
	""PatientBreedCodeSequence"" VARIANT,
	""ResponsibleOrganization"" VARCHAR(16777216),
	""PatientComments"" VARCHAR(16777216),
	""ClinicalTrialSponsorName"" VARCHAR(16777216),
	""ClinicalTrialProtocolID"" VARCHAR(16777216),
	""ClinicalTrialProtocolName"" VARCHAR(16777216),
	""ClinicalTrialSiteID"" VARCHAR(16777216),
	""ClinicalTrialSiteName"" VARCHAR(16777216),
	""ClinicalTrialSubjectID"" VARCHAR(16777216),
	""ClinicalTrialSubjectReadingID"" VARCHAR(16777216),
	""ClinicalTrialTimePointID"" VARCHAR(16777216),
	""ClinicalTrialTimePointDescription"" VARCHAR(16777216),
	""LongitudinalTemporalOffsetFromEvent"" FLOAT,
	""LongitudinalTemporalEventType"" VARCHAR(16777216),
	""ClinicalTrialCoordinatingCenterName"" VARCHAR(16777216),
	""PatientIdentityRemoved"" VARCHAR(16777216),
	""DeidentificationMethod"" VARIANT,
	""DeidentificationMethodCodeSequence"" VARIANT,
	""ClinicalTrialSeriesID"" VARCHAR(16777216),
	""FNumber"" VARCHAR(16777216),
	""FocalLength"" VARCHAR(16777216),
	""LensSpecification"" VARIANT,
	""LensMake"" VARCHAR(16777216),
	""LensModel"" VARCHAR(16777216),
	""ContrastBolusAgent"" VARCHAR(16777216),
	""BodyPartExamined"" VARCHAR(16777216),
	""ScanningSequence"" VARIANT,
	""SequenceVariant"" VARIANT,
	""ScanOptions"" VARIANT,
	""MRAcquisitionType"" VARCHAR(16777216),
	""SequenceName"" VARCHAR(16777216),
	""AngioFlag"" VARCHAR(16777216),
	""InterventionDrugInformationSequence"" VARIANT,
	""Radiopharmaceutical"" VARCHAR(16777216),
	""CineRate"" VARCHAR(16777216),
	""SliceThickness"" VARCHAR(16777216),
	KVP VARCHAR(16777216),
	""CountsAccumulated"" VARCHAR(16777216),
	""AcquisitionTerminationCondition"" VARCHAR(16777216),
	""EffectiveDuration"" VARCHAR(16777216),
	""AcquisitionStartCondition"" VARCHAR(16777216),
	""AcquisitionStartConditionData"" VARCHAR(16777216),
	""AcquisitionTerminationConditionData"" VARCHAR(16777216),
	""RepetitionTime"" VARCHAR(16777216),
	""EchoTime"" VARCHAR(16777216),
	""InversionTime"" VARCHAR(16777216),
	""NumberOfAverages"" VARCHAR(16777216),
	""ImagingFrequency"" VARCHAR(16777216),
	""ImagedNucleus"" VARCHAR(16777216),
	""EchoNumbers"" VARIANT,
	""MagneticFieldStrength"" VARCHAR(16777216),
	""SpacingBetweenSlices"" VARCHAR(16777216),
	""NumberOfPhaseEncodingSteps"" VARCHAR(16777216),
	""DataCollectionDiameter"" VARCHAR(16777216),
	""EchoTrainLength"" VARCHAR(16777216),
	""PercentSampling"" VARCHAR(16777216),
	""PercentPhaseFieldOfView"" VARCHAR(16777216),
	""PixelBandwidth"" VARCHAR(16777216),
	""DeviceSerialNumber"" VARCHAR(16777216),
	""DeviceUID"" VARCHAR(16777216),
	""PlateID"" VARCHAR(16777216),
	""GantryID"" VARCHAR(16777216),
	""SecondaryCaptureDeviceID"" VARCHAR(16777216),
	""DateOfSecondaryCapture"" DATE,
	""TimeOfSecondaryCapture"" TIME(9),
	""SecondaryCaptureDeviceManufacturer"" VARCHAR(16777216),
	""SecondaryCaptureDeviceManufacturerModelName"" VARCHAR(16777216),
	""SecondaryCaptureDeviceSoftwareVersions"" VARIANT,
	""SoftwareVersions"" VARIANT,
	""VideoImageFormatAcquired"" VARCHAR(16777216),
	""DigitalImageFormatAcquired"" VARCHAR(16777216),
	""ProtocolName"" VARCHAR(16777216),
	""ContrastBolusRoute"" VARCHAR(16777216),
	""ContrastBolusVolume"" VARCHAR(16777216),
	""ContrastBolusStartTime"" TIME(9),
	""ContrastBolusStopTime"" TIME(9),
	""ContrastBolusTotalDose"" VARCHAR(16777216),
	""ContrastFlowRate"" VARIANT,
	""ContrastFlowDuration"" VARIANT,
	""ContrastBolusIngredient"" VARCHAR(16777216),
	""ContrastBolusIngredientConcentration"" VARCHAR(16777216),
	""SpatialResolution"" VARCHAR(16777216),
	""TriggerTime"" VARCHAR(16777216),
	""TriggerSourceOrType"" VARCHAR(16777216),
	""NominalInterval"" VARCHAR(16777216),
	""FrameTime"" VARCHAR(16777216),
	""CardiacFramingType"" VARCHAR(16777216),
	""FrameDelay"" VARCHAR(16777216),
	""SynchronizationTrigger"" VARCHAR(16777216),
	""RadiopharmaceuticalVolume"" VARCHAR(16777216),
	""RadiopharmaceuticalStartTime"" TIME(9),
	""RadionuclideTotalDose"" VARCHAR(16777216),
	""BeatRejectionFlag"" VARCHAR(16777216),
	""LowRRValue"" VARCHAR(16777216),
	""HighRRValue"" VARCHAR(16777216),
	""IntervalsAcquired"" VARCHAR(16777216),
	""IntervalsRejected"" VARCHAR(16777216),
	""PVCRejection"" VARCHAR(16777216),
	""SkipBeats"" VARCHAR(16777216),
	""HeartRate"" VARCHAR(16777216),
	""CardiacNumberOfImages"" VARCHAR(16777216),
	""TriggerWindow"" VARCHAR(16777216),
	""ReconstructionDiameter"" VARCHAR(16777216),
	""DistanceSourceToDetector"" VARCHAR(16777216),
	""DistanceSourceToPatient"" VARCHAR(16777216),
	""EstimatedRadiographicMagnificationFactor"" VARCHAR(16777216),
	""GantryDetectorTilt"" VARCHAR(16777216),
	""GantryDetectorSlew"" VARCHAR(16777216),
	""TableHeight"" VARCHAR(16777216),
	""TableTraverse"" VARCHAR(16777216),
	""RotationDirection"" VARCHAR(16777216),
	""AngularPosition"" VARCHAR(16777216),
	""ScanArc"" VARCHAR(16777216),
	""FieldOfViewShape"" VARCHAR(16777216),
	""FieldOfViewDimensions"" VARIANT,
	""ExposureTime"" VARCHAR(16777216),
	""XRayTubeCurrent"" VARCHAR(16777216),
	""Exposure"" VARCHAR(16777216),
	""ExposureInuAs"" VARCHAR(16777216),
	""AveragePulseWidth"" VARCHAR(16777216),
	""RadiationSetting"" VARCHAR(16777216),
	""RectificationType"" VARCHAR(16777216),
	""RadiationMode"" VARCHAR(16777216),
	""ImageAndFluoroscopyAreaDoseProduct"" VARCHAR(16777216),
	""FilterType"" VARCHAR(16777216),
	""IntensifierSize"" VARCHAR(16777216),
	""ImagerPixelSpacing"" VARIANT,
	""Grid"" VARIANT,
	""GeneratorPower"" VARCHAR(16777216),
	""CollimatorGridName"" VARCHAR(16777216),
	""CollimatorType"" VARCHAR(16777216),
	""XFocusCenter"" VARIANT,
	""YFocusCenter"" VARIANT,
	""FocalSpots"" VARIANT,
	""AnodeTargetMaterial"" VARCHAR(16777216),
	""BodyPartThickness"" VARCHAR(16777216),
	""CompressionForce"" VARCHAR(16777216),
	""PaddleDescription"" VARCHAR(16777216),
	""DateOfLastCalibration"" VARIANT,
	""TimeOfLastCalibration"" VARIANT,
	""ConvolutionKernel"" VARIANT,
	""ActualFrameDuration"" VARCHAR(16777216),
	""CountRate"" VARCHAR(16777216),
	""PreferredPlaybackSequencing"" NUMBER(38,0),
	""ReceiveCoilName"" VARCHAR(16777216),
	""TransmitCoilName"" VARCHAR(16777216),
	""PlateType"" VARCHAR(16777216),
	""ScanVelocity"" VARCHAR(16777216),
	""WholeBodyTechnique"" VARIANT,
	""ScanLength"" VARCHAR(16777216),
	""AcquisitionMatrix"" VARIANT,
	""InPlanePhaseEncodingDirection"" VARCHAR(16777216),
	""FlipAngle"" VARCHAR(16777216),
	""VariableFlipAngleFlag"" VARCHAR(16777216),
	SAR VARCHAR(16777216),
	""dBdt"" VARCHAR(16777216),
	""B1rms"" FLOAT,
	""AcquisitionDeviceProcessingDescription"" VARCHAR(16777216),
	""AcquisitionDeviceProcessingCode"" VARCHAR(16777216),
	""CassetteOrientation"" VARCHAR(16777216),
	""CassetteSize"" VARCHAR(16777216),
	""ExposuresOnPlate"" NUMBER(38,0),
	""RelativeXRayExposure"" VARCHAR(16777216),
	""ExposureIndex"" VARCHAR(16777216),
	""TargetExposureIndex"" VARCHAR(16777216),
	""DeviationIndex"" VARCHAR(16777216),
	""TomoLayerHeight"" VARCHAR(16777216),
	""TomoAngle"" VARCHAR(16777216),
	""TomoTime"" VARCHAR(16777216),
	""TomoType"" VARCHAR(16777216),
	""TomoClass"" VARCHAR(16777216),
	""NumberOfTomosynthesisSourceImages"" VARCHAR(16777216),
	""PositionerMotion"" VARCHAR(16777216),
	""PositionerType"" VARCHAR(16777216),
	""PositionerPrimaryAngle"" VARCHAR(16777216),
	""PositionerSecondaryAngle"" VARCHAR(16777216),
	""DetectorSecondaryAngle"" VARCHAR(16777216),
	""ShutterShape"" VARIANT,
	""ShutterLeftVerticalEdge"" VARCHAR(16777216),
	""ShutterRightVerticalEdge"" VARCHAR(16777216),
	""ShutterUpperHorizontalEdge"" VARCHAR(16777216),
	""ShutterLowerHorizontalEdge"" VARCHAR(16777216),
	""CenterOfCircularShutter"" VARIANT,
	""RadiusOfCircularShutter"" VARCHAR(16777216),
	""VerticesOfThePolygonalShutter"" VARIANT,
	""ShutterPresentationValue"" NUMBER(38,0),
	""CollimatorShape"" VARIANT,
	""CollimatorLeftVerticalEdge"" VARCHAR(16777216),
	""CollimatorRightVerticalEdge"" VARCHAR(16777216),
	""CollimatorUpperHorizontalEdge"" VARCHAR(16777216),
	""CollimatorLowerHorizontalEdge"" VARCHAR(16777216),
	""VerticesOfThePolygonalCollimator"" VARIANT,
	""AcquisitionTimeSynchronized"" VARCHAR(16777216),
	""NominalScannedPixelSpacing"" VARIANT,
	""AcquisitionComments"" VARCHAR(16777216),
	""TransducerData"" VARIANT,
	""ProcessingFunction"" VARCHAR(16777216),
	""PostprocessingFunction"" VARCHAR(16777216),
	""MechanicalIndex"" VARCHAR(16777216),
	""BoneThermalIndex"" VARCHAR(16777216),
	""SoftTissueThermalIndex"" VARCHAR(16777216),
	""PatientPosition"" VARCHAR(16777216),
	""ViewPosition"" VARCHAR(16777216),
	""Sensitivity"" VARCHAR(16777216),
	""SequenceOfUltrasoundRegions"" VARIANT,
	""TransducerType"" VARCHAR(16777216),
	""DetectorConditionsNominalFlag"" VARCHAR(16777216),
	""DetectorTemperature"" VARCHAR(16777216),
	""DetectorType"" VARCHAR(16777216),
	""DetectorConfiguration"" VARCHAR(16777216),
	""DetectorDescription"" VARCHAR(16777216),
	""DetectorMode"" VARCHAR(16777216),
	""DetectorID"" VARCHAR(16777216),
	""DateOfLastDetectorCalibration"" DATE,
	""TimeOfLastDetectorCalibration"" TIME(9),
	""ExposuresOnDetectorSinceLastCalibration"" VARCHAR(16777216),
	""ExposuresOnDetectorSinceManufactured"" VARCHAR(16777216),
	""DetectorTimeSinceLastExposure"" VARCHAR(16777216),
	""DetectorActiveTime"" VARCHAR(16777216),
	""DetectorBinning"" VARIANT,
	""DetectorElementPhysicalSize"" VARIANT,
	""DetectorElementSpacing"" VARIANT,
	""DetectorActiveShape"" VARCHAR(16777216),
	""DetectorActiveDimensions"" VARIANT,
	""DetectorManufacturerName"" VARCHAR(16777216),
	""DetectorManufacturerModelName"" VARCHAR(16777216),
	""FieldOfViewOrigin"" VARIANT,
	""FieldOfViewRotation"" VARCHAR(16777216),
	""FieldOfViewHorizontalFlip"" VARCHAR(16777216),
	""GridAspectRatio"" VARIANT,
	""GridFocalDistance"" VARCHAR(16777216),
	""FilterMaterial"" VARIANT,
	""FilterThicknessMinimum"" VARIANT,
	""FilterThicknessMaximum"" VARIANT,
	""ExposureControlMode"" VARCHAR(16777216),
	""ExposureControlModeDescription"" VARCHAR(16777216),
	""ExposureStatus"" VARCHAR(16777216),
	""ExposureTimeInuS"" VARCHAR(16777216),
	""XRayTubeCurrentInuA"" VARCHAR(16777216),
	""ContentQualification"" VARCHAR(16777216),
	""PulseSequenceName"" VARCHAR(16777216),
	""EchoPulseSequence"" VARCHAR(16777216),
	""InversionRecovery"" VARCHAR(16777216),
	""MultipleSpinEcho"" VARCHAR(16777216),
	""MultiPlanarExcitation"" VARCHAR(16777216),
	""PhaseContrast"" VARCHAR(16777216),
	""TimeOfFlightContrast"" VARCHAR(16777216),
	""Spoiling"" VARCHAR(16777216),
	""SteadyStatePulseSequence"" VARCHAR(16777216),
	""EchoPlanarPulseSequence"" VARCHAR(16777216),
	""TagAngleFirstAxis"" FLOAT,
	""MagnetizationTransfer"" VARCHAR(16777216),
	""T2Preparation"" VARCHAR(16777216),
	""BloodSignalNulling"" VARCHAR(16777216),
	""SaturationRecovery"" VARCHAR(16777216),
	""SpectrallySelectedSuppression"" VARCHAR(16777216),
	""SpectrallySelectedExcitation"" VARCHAR(16777216),
	""SpatialPresaturation"" VARCHAR(16777216),
	""Tagging"" VARCHAR(16777216),
	""OversamplingPhase"" VARCHAR(16777216),
	""TagSpacingFirstDimension"" FLOAT,
	""GeometryOfKSpaceTraversal"" VARCHAR(16777216),
	""SegmentedKSpaceTraversal"" VARCHAR(16777216),
	""RectilinearPhaseEncodeReordering"" VARCHAR(16777216),
	""TagThickness"" FLOAT,
	""PartialFourierDirection"" VARCHAR(16777216),
	""CardiacSynchronizationTechnique"" VARCHAR(16777216),
	""ReceiveCoilType"" VARCHAR(16777216),
	""QuadratureReceiveCoil"" VARCHAR(16777216),
	""MultiCoilDefinitionSequence"" VARIANT,
	""MultiCoilElementName"" VARCHAR(16777216),
	""TransmitCoilType"" VARCHAR(16777216),
	""ChemicalShiftReference"" VARIANT,
	""MRAcquisitionFrequencyEncodingSteps"" NUMBER(38,0),
	""Decoupling"" VARCHAR(16777216),
	""KSpaceFiltering"" VARCHAR(16777216),
	""ParallelReductionFactorInPlane"" FLOAT,
	""AcquisitionDuration"" FLOAT,
	""FrameAcquisitionDateTime"" NUMBER(38,0),
	""DiffusionDirectionality"" VARCHAR(16777216),
	""ParallelAcquisition"" VARCHAR(16777216),
	""ParallelAcquisitionTechnique"" VARCHAR(16777216),
	""InversionTimes"" VARIANT,
	""MetaboliteMapDescription"" VARCHAR(16777216),
	""PartialFourier"" VARCHAR(16777216),
	""EffectiveEchoTime"" FLOAT,
	""CardiacSignalSource"" VARCHAR(16777216),
	""DiffusionBValue"" FLOAT,
	""DiffusionGradientOrientation"" VARIANT,
	""VelocityEncodingDirection"" VARIANT,
	""VelocityEncodingMinimumValue"" FLOAT,
	""NumberOfKSpaceTrajectories"" NUMBER(38,0),
	""CoverageOfKSpace"" VARCHAR(16777216),
	""FrequencyCorrection"" VARCHAR(16777216),
	""FrameReferenceDateTime"" NUMBER(38,0),
	""ParallelReductionFactorOutOfPlane"" FLOAT,
	""ParallelReductionFactorSecondInPlane"" FLOAT,
	""CardiacBeatRejectionTechnique"" VARCHAR(16777216),
	""RespiratoryMotionCompensationTechnique"" VARCHAR(16777216),
	""RespiratorySignalSource"" VARCHAR(16777216),
	""BulkMotionCompensationTechnique"" VARCHAR(16777216),
	""ApplicableSafetyStandardAgency"" VARCHAR(16777216),
	""SpecificAbsorptionRateDefinition"" VARCHAR(16777216),
	""GradientOutputType"" VARCHAR(16777216),
	""SpecificAbsorptionRateValue"" FLOAT,
	""GradientOutput"" FLOAT,
	""FlowCompensationDirection"" VARCHAR(16777216),
	""WaterReferencedPhaseCorrection"" VARCHAR(16777216),
	""FrameAcquisitionDuration"" FLOAT,
	""MRAcquisitionPhaseEncodingStepsInPlane"" NUMBER(38,0),
	""MRAcquisitionPhaseEncodingStepsOutOfPlane"" NUMBER(38,0),
	""RFEchoTrainLength"" NUMBER(38,0),
	""GradientEchoTrainLength"" NUMBER(38,0),
	""AcquisitionType"" VARCHAR(16777216),
	""TubeAngle"" FLOAT,
	""RevolutionTime"" FLOAT,
	""SingleCollimationWidth"" FLOAT,
	""TotalCollimationWidth"" FLOAT,
	""TableSpeed"" FLOAT,
	""TableFeedPerRotation"" FLOAT,
	""SpiralPitchFactor"" FLOAT,
	""DataCollectionCenterPatient"" VARIANT,
	""ReconstructionTargetCenterPatient"" VARIANT,
	""CTExposureSequence"" VARIANT,
	""ExposureModulationType"" VARIANT,
	""EstimatedDoseSaving"" FLOAT,
	""TablePosition"" FLOAT,
	""ExposureTimeInms"" FLOAT,
	""XRayTubeCurrentInmA"" FLOAT,
	""ExposureInmAs"" FLOAT,
	""FluoroscopyFlag"" VARCHAR(16777216),
	""CTDIvol"" FLOAT,
	""CTDIPhantomTypeCodeSequence"" VARIANT,
	""CalciumScoringMassFactorDevice"" VARIANT,
	""EnergyWeightingFactor"" FLOAT,
	""CTAdditionalXRaySourceSequence"" VARIANT,
	""ContributingSourcesSequence"" VARIANT,
	""XRay3DAcquisitionSequence"" VARIANT,
	""XRay3DReconstructionSequence"" VARIANT,
	""PositionerPrimaryAngleDirection"" VARCHAR(16777216),
	""DiffusionBValueXX"" FLOAT,
	""DiffusionBValueXY"" FLOAT,
	""DiffusionBValueXZ"" FLOAT,
	""DiffusionBValueYY"" FLOAT,
	""DiffusionBValueYZ"" FLOAT,
	""DiffusionBValueZZ"" FLOAT,
	""ContributingEquipmentSequence"" VARIANT,
	""StudyID"" VARCHAR(16777216),
	""SeriesNumber"" VARCHAR(16777216),
	""AcquisitionNumber"" VARCHAR(16777216),
	""InstanceNumber"" VARCHAR(16777216),
	""ItemNumber"" VARCHAR(16777216),
	""PatientOrientation"" VARIANT,
	""ImagePosition"" VARIANT,
	""ImagePositionPatient"" VARIANT,
	""ImageOrientation"" VARIANT,
	""ImageOrientationPatient"" VARIANT,
	""Location"" VARCHAR(16777216),
	""FrameOfReferenceUID"" VARCHAR(16777216),
	""Laterality"" VARCHAR(16777216),
	""ImageLaterality"" VARCHAR(16777216),
	""ImageGeometryType"" VARCHAR(16777216),
	""TemporalPositionIdentifier"" VARCHAR(16777216),
	""NumberOfTemporalPositions"" VARCHAR(16777216),
	""TemporalResolution"" VARCHAR(16777216),
	""SynchronizationFrameOfReferenceUID"" VARCHAR(16777216),
	""AcquisitionsInSeries"" VARCHAR(16777216),
	""ImagesInAcquisition"" VARCHAR(16777216),
	""ImagesInSeries"" VARCHAR(16777216),
	""PositionReferenceIndicator"" VARCHAR(16777216),
	""SliceLocation"" VARCHAR(16777216),
	""NumberOfStudyRelatedSeries"" VARCHAR(16777216),
	""NumberOfStudyRelatedInstances"" VARCHAR(16777216),
	""NumberOfSeriesRelatedInstances"" VARCHAR(16777216),
	""ImageComments"" VARCHAR(16777216),
	""OriginalImageIdentification"" VARIANT,
	""OriginalImageIdentificationNomenclature"" VARIANT,
	""StackID"" VARCHAR(16777216),
	""InStackPositionNumber"" NUMBER(38,0),
	""FrameLaterality"" VARCHAR(16777216),
	""TemporalPositionIndex"" NUMBER(38,0),
	""DimensionIndexValues"" VARIANT,
	""FrameComments"" VARCHAR(16777216),
	""ConcatenationUID"" VARCHAR(16777216),
	""DimensionOrganizationUID"" VARCHAR(16777216),
	""DimensionOrganizationSequence"" VARIANT,
	""DimensionIndexSequence"" VARIANT,
	""NominalPercentageOfCardiacPhase"" FLOAT,
	""RespiratoryIntervalTime"" FLOAT,
	""NominalRespiratoryTriggerDelayTime"" FLOAT,
	""RespiratoryTriggerDelayThreshold"" FLOAT,
	""DimensionOrganizationType"" VARCHAR(16777216),
	""SamplesPerPixel"" NUMBER(38,0),
	""PhotometricInterpretation"" VARCHAR(16777216),
	""ImageDimensions"" NUMBER(38,0),
	""PlanarConfiguration"" NUMBER(38,0),
	""NumberOfFrames"" VARCHAR(16777216),
	""FrameIncrementPointer"" VARIANT,
	""Rows"" NUMBER(38,0),
	""Columns"" NUMBER(38,0),
	""Planes"" NUMBER(38,0),
	""UltrasoundColorDataPresent"" NUMBER(38,0),
	""PixelSpacing"" VARIANT,
	""ZoomFactor"" VARIANT,
	""ZoomCenter"" VARIANT,
	""PixelAspectRatio"" VARIANT,
	""ImageFormat"" VARCHAR(16777216),
	""ManipulatedImage"" VARIANT,
	""CorrectedImage"" VARIANT,
	""CompressionCode"" VARCHAR(16777216),
	""BitsAllocated"" NUMBER(38,0),
	""BitsStored"" NUMBER(38,0),
	""HighBit"" NUMBER(38,0),
	""PixelRepresentation"" NUMBER(38,0),
	""SmallestValidPixelValue"" NUMBER(38,0),
	""LargestValidPixelValue"" NUMBER(38,0),
	""SmallestImagePixelValue"" NUMBER(38,0),
	""LargestImagePixelValue"" NUMBER(38,0),
	""SmallestPixelValueInSeries"" NUMBER(38,0),
	""LargestPixelValueInSeries"" NUMBER(38,0),
	""PixelPaddingValue"" NUMBER(38,0),
	""PixelPaddingRangeLimit"" NUMBER(38,0),
	""ImageLocation"" NUMBER(38,0),
	""QualityControlImage"" VARCHAR(16777216),
	""BurnedInAnnotation"" VARCHAR(16777216),
	""RecognizableVisualFeatures"" VARCHAR(16777216),
	""LongitudinalTemporalInformationModified"" VARCHAR(16777216),
	""PixelSpacingCalibrationType"" VARCHAR(16777216),
	""PixelSpacingCalibrationDescription"" VARCHAR(16777216),
	""PixelIntensityRelationship"" VARCHAR(16777216),
	""PixelIntensityRelationshipSign"" NUMBER(38,0),
	""WindowCenter"" VARIANT,
	""WindowWidth"" VARIANT,
	""RescaleIntercept"" VARCHAR(16777216),
	""RescaleSlope"" VARCHAR(16777216),
	""RescaleType"" VARCHAR(16777216),
	""WindowCenterWidthExplanation"" VARIANT,
	""VOILUTFunction"" VARCHAR(16777216),
	""RedPaletteColorLookupTableDescriptor"" VARIANT,
	""GreenPaletteColorLookupTableDescriptor"" VARIANT,
	""BluePaletteColorLookupTableDescriptor"" VARIANT,
	""PaletteColorLookupTableUID"" VARCHAR(16777216),
	""LargePaletteColorLookupTableUID"" VARCHAR(16777216),
	""BreastImplantPresent"" VARCHAR(16777216),
	""PartialView"" VARCHAR(16777216),
	""LossyImageCompression"" VARCHAR(16777216),
	""LossyImageCompressionRatio"" VARIANT,
	""LossyImageCompressionMethod"" VARIANT,
	""LUTExplanation"" VARCHAR(16777216),
	""VOILUTSequence"" VARIANT,
	""SoftcopyVOILUTSequence"" VARIANT,
	""RepresentativeFrameNumber"" NUMBER(38,0),
	""FrameOfInterestDescription"" VARIANT,
	""DataPointRows"" NUMBER(38,0),
	""DataPointColumns"" NUMBER(38,0),
	""StudyStatusID"" VARCHAR(16777216),
	""StudyPriorityID"" VARCHAR(16777216),
	""StudyReadDate"" DATE,
	""StudyReadTime"" TIME(9),
	""ScheduledStudyStartDate"" DATE,
	""ScheduledStudyStartTime"" TIME(9),
	""ScheduledStudyLocation"" VARCHAR(16777216),
	""ScheduledStudyLocationAETitle"" VARIANT,
	""ReasonForStudy"" VARCHAR(16777216),
	""StudyArrivalDate"" DATE,
	""StudyArrivalTime"" TIME(9),
	""StudyCompletionDate"" DATE,
	""StudyCompletionTime"" TIME(9),
	""RequestedProcedureDescription"" VARCHAR(16777216),
	""RequestedProcedureCodeSequence"" VARIANT,
	""RequestedContrastAgent"" VARCHAR(16777216),
	""StudyComments"" VARCHAR(16777216),
	""RouteOfAdmissions"" VARCHAR(16777216),
	""AdmittingDate"" DATE,
	""AdmittingTime"" TIME(9),
	""DischargeTime"" TIME(9),
	""SpecialNeeds"" VARCHAR(16777216),
	""PatientState"" VARCHAR(16777216),
	""ScheduledProcedureStepStartDate"" DATE,
	""ScheduledProcedureStepStartTime"" TIME(9),
	""ScheduledProcedureStepEndDate"" DATE,
	""ScheduledProcedureStepEndTime"" TIME(9),
	""ScheduledProcedureStepDescription"" VARCHAR(16777216),
	""ScheduledProtocolCodeSequence"" VARIANT,
	""ScheduledProcedureStepID"" VARCHAR(16777216),
	""ScheduledStationName"" VARIANT,
	""ScheduledProcedureStepSequence"" VARIANT,
	""PerformedStationAETitle"" VARCHAR(16777216),
	""PerformedStationName"" VARCHAR(16777216),
	""PerformedProcedureStepStartDate"" DATE,
	""PerformedProcedureStepStartTime"" TIME(9),
	""PerformedProcedureStepEndDate"" DATE,
	""PerformedProcedureStepEndTime"" TIME(9),
	""PerformedProcedureStepID"" VARCHAR(16777216),
	""PerformedProcedureStepDescription"" VARCHAR(16777216),
	""PerformedProtocolCodeSequence"" VARIANT,
	""RequestAttributesSequence"" VARIANT,
	""CommentsOnThePerformedProcedureStep"" VARCHAR(16777216),
	""TotalNumberOfExposures"" NUMBER(38,0),
	""EntranceDose"" NUMBER(38,0),
	""ExposedArea"" VARIANT,
	""DistanceSourceToEntrance"" VARCHAR(16777216),
	""ExposureDoseSequence"" VARIANT,
	""CommentsOnRadiationDose"" VARCHAR(16777216),
	""HalfValueLayer"" VARCHAR(16777216),
	""OrganDose"" VARCHAR(16777216),
	""OrganExposed"" VARCHAR(16777216),
	""ContainerIdentifier"" VARCHAR(16777216),
	""ContainerTypeCodeSequence"" VARIANT,
	""AcquisitionContextSequence"" VARIANT,
	""SpecimenDescriptionSequence"" VARIANT,
	""RequestedProcedureID"" VARCHAR(16777216),
	""ReasonForTheRequestedProcedure"" VARCHAR(16777216),
	""RequestedProcedurePriority"" VARCHAR(16777216),
	""ConfidentialityCode"" VARCHAR(16777216),
	""ReasonForRequestedProcedureCodeSequence"" VARIANT,
	""RequestedProcedureComments"" VARCHAR(16777216),
	""ReasonForTheImagingServiceRequest"" VARCHAR(16777216),
	""IssueDateOfImagingServiceRequest"" DATE,
	""IssueTimeOfImagingServiceRequest"" TIME(9),
	""FillerOrderNumberImagingServiceRequest"" VARCHAR(16777216),
	""ImagingServiceRequestComments"" VARCHAR(16777216),
	""ReferencedGeneralPurposeScheduledProcedureStepTransactionUID"" VARCHAR(16777216),
	""EntranceDoseInmGy"" VARCHAR(16777216),
	""ReferencedImageRealWorldValueMappingSequence"" VARIANT,
	""RealWorldValueMappingSequence"" VARIANT,
	""LUTLabel"" VARCHAR(16777216),
	""ObservationDateTime"" NUMBER(38,0),
	""ValueType"" VARCHAR(16777216),
	""ConceptNameCodeSequence"" VARIANT,
	""ContinuityOfContent"" VARCHAR(16777216),
	""VerifyingObserverSequence"" VARIANT,
	""VerifyingObserverName"" VARIANT,
	""DateTime"" NUMBER(38,0),
	""PersonName"" VARIANT,
	UID VARCHAR(16777216),
	""PredecessorDocumentsSequence"" VARIANT,
	""ReferencedRequestSequence"" VARIANT,
	""PerformedProcedureCodeSequence"" VARIANT,
	""CurrentRequestedProcedureEvidenceSequence"" VARIANT,
	""CompletionFlag"" VARCHAR(16777216),
	""VerificationFlag"" VARCHAR(16777216),
	""PreliminaryFlag"" VARCHAR(16777216),
	""ContentTemplateSequence"" VARIANT,
	""ContentSequence"" VARIANT,
	""TemplateExtensionOrganizationUID"" VARCHAR(16777216),
	""TemplateExtensionCreatorUID"" VARCHAR(16777216),
	""MIMETypeOfEncapsulatedDocument"" VARCHAR(16777216),
	""EncapsulatedDocumentLength"" NUMBER(38,0),
	""ImagedVolumeWidth"" FLOAT,
	""ImagedVolumeHeight"" FLOAT,
	""ImagedVolumeDepth"" FLOAT,
	""TotalPixelMatrixColumns"" NUMBER(38,0),
	""TotalPixelMatrixRows"" NUMBER(38,0),
	""TotalPixelMatrixOriginSequence"" VARIANT,
	""SpecimenLabelInImage"" VARCHAR(16777216),
	""FocusMethod"" VARCHAR(16777216),
	""ExtendedDepthOfField"" VARCHAR(16777216),
	""RecommendedAbsentPixelCIELabValue"" VARIANT,
	""ImageOrientationSlide"" VARIANT,
	""OpticalPathSequence"" VARIANT,
	""NumberOfOpticalPaths"" NUMBER(38,0),
	""TotalPixelMatrixFocalPlanes"" NUMBER(38,0),
	""CalibrationImage"" VARCHAR(16777216),
	""EnergyWindowVector"" VARIANT,
	""NumberOfEnergyWindows"" NUMBER(38,0),
	""EnergyWindowInformationSequence"" VARIANT,
	""EnergyWindowRangeSequence"" VARIANT,
	""RadiopharmaceuticalInformationSequence"" VARIANT,
	""DetectorVector"" VARIANT,
	""NumberOfDetectors"" NUMBER(38,0),
	""DetectorInformationSequence"" VARIANT,
	""PhaseVector"" VARIANT,
	""NumberOfPhases"" NUMBER(38,0),
	""PhaseInformationSequence"" VARIANT,
	""NumberOfRotations"" NUMBER(38,0),
	""RotationInformationSequence"" VARIANT,
	""NumberOfRRIntervals"" NUMBER(38,0),
	""NumberOfTimeSlots"" NUMBER(38,0),
	""SliceVector"" VARIANT,
	""NumberOfSlices"" NUMBER(38,0),
	""TimeSliceVector"" VARIANT,
	""NumberOfTimeSlices"" NUMBER(38,0),
	""TypeOfDetectorMotion"" VARCHAR(16777216),
	""ViewCodeSequence"" VARIANT,
	""ViewModifierCodeSequence"" VARIANT,
	""ImageID"" VARCHAR(16777216),
	""PatientOrientationCodeSequence"" VARIANT,
	""PatientOrientationModifierCodeSequence"" VARIANT,
	""PatientGantryRelationshipCodeSequence"" VARIANT,
	""ScanProgressionDirection"" VARCHAR(16777216),
	""SeriesType"" VARIANT,
	""Units"" VARCHAR(16777216),
	""CountsSource"" VARCHAR(16777216),
	""ReprojectionMethod"" VARCHAR(16777216),
	""RandomsCorrectionMethod"" VARCHAR(16777216),
	""AttenuationCorrectionMethod"" VARCHAR(16777216),
	""DecayCorrection"" VARCHAR(16777216),
	""ReconstructionMethod"" VARCHAR(16777216),
	""DetectorLinesOfResponseUsed"" VARCHAR(16777216),
	""ScatterCorrectionMethod"" VARCHAR(16777216),
	""AxialAcceptance"" VARCHAR(16777216),
	""AxialMash"" VARIANT,
	""TransverseMash"" VARCHAR(16777216),
	""CoincidenceWindowWidth"" VARCHAR(16777216),
	""SecondaryCountsType"" VARIANT,
	""FrameReferenceTime"" VARCHAR(16777216),
	""PrimaryPromptsCountsAccumulated"" VARCHAR(16777216),
	""SecondaryCountsAccumulated"" VARIANT,
	""SliceSensitivityFactor"" VARCHAR(16777216),
	""DecayFactor"" VARCHAR(16777216),
	""DoseCalibrationFactor"" VARCHAR(16777216),
	""ScatterFractionFactor"" VARCHAR(16777216),
	""DeadTimeFactor"" VARCHAR(16777216),
	""ImageIndex"" NUMBER(38,0),
	""HistogramSequence"" VARIANT,
	""SegmentationType"" VARCHAR(16777216),
	""SegmentSequence"" VARIANT,
	""MaximumFractionalValue"" NUMBER(38,0),
	""SegmentationFractionalType"" VARCHAR(16777216),
	""SegmentsOverlap"" VARCHAR(16777216),
	""ImageRotation"" NUMBER(38,0),
	""DisplayedAreaSelectionSequence"" VARIANT,
	""GraphicLayerSequence"" VARIANT,
	""ContentLabel"" VARCHAR(16777216),
	""ContentDescription"" VARCHAR(16777216),
	""PresentationCreationDate"" DATE,
	""PresentationCreationTime"" TIME(9),
	""ContentCreatorName"" VARIANT,
	""RegistrationSequence"" VARIANT,
	""FiducialUID"" VARCHAR(16777216),
	""RelativeOpacity"" FLOAT,
	""AdvancedBlendingSequence"" VARIANT,
	""BlendingDisplaySequence"" VARIANT,
	""StorageMediaFileSetUID"" VARCHAR(16777216),
	""IconImageSequence"" VARIANT,
	""DigitalSignatureUID"" VARCHAR(16777216),
	""ImageDisplayFormat"" VARCHAR(16777216),
	""AnnotationDisplayFormatID"" VARCHAR(16777216),
	""FilmOrientation"" VARCHAR(16777216),
	""BorderDensity"" VARCHAR(16777216),
	""Trim"" VARCHAR(16777216),
	""ImageBoxPosition"" NUMBER(38,0),
	""PresentationLUTShape"" VARCHAR(16777216),
	""DoseUnits"" VARCHAR(16777216),
	""DoseType"" VARCHAR(16777216),
	""DoseComment"" VARCHAR(16777216),
	""DoseSummationType"" VARCHAR(16777216),
	""GridFrameOffsetVector"" VARIANT,
	""DoseGridScaling"" VARCHAR(16777216),
	""TissueHeterogeneityCorrection"" VARIANT,
	""StructureSetLabel"" VARCHAR(16777216),
	""StructureSetName"" VARCHAR(16777216),
	""StructureSetDate"" DATE,
	""StructureSetTime"" TIME(9),
	""ReferencedFrameOfReferenceSequence"" VARIANT,
	""StructureSetROISequence"" VARIANT,
	""ReferencedFrameOfReferenceUID"" VARCHAR(16777216),
	""ROIContourSequence"" VARIANT,
	""RTROIObservationsSequence"" VARIANT,
	""RelatedFrameOfReferenceUID"" VARCHAR(16777216),
	""RTPlanLabel"" VARCHAR(16777216),
	""RTPlanName"" VARCHAR(16777216),
	""RTPlanDescription"" VARCHAR(16777216),
	""RTPlanDate"" DATE,
	""RTPlanGeometry"" VARCHAR(16777216),
	""DoseReferenceSequence"" VARIANT,
	""DoseReferenceUID"" VARCHAR(16777216),
	""FractionGroupSequence"" VARIANT,
	""BeamSequence"" VARIANT,
	""GantryAngle"" VARCHAR(16777216),
	""PatientSupportAngle"" VARCHAR(16777216),
	""TableTopLongitudinalPosition"" VARCHAR(16777216),
	""TableTopLateralPosition"" VARCHAR(16777216),
	""TableTopPitchAngle"" FLOAT,
	""TableTopRollAngle"" FLOAT,
	""PatientSetupSequence"" VARIANT,
	""PatientSetupNumber"" VARCHAR(16777216),
	""ReferencedRTPlanSequence"" VARIANT,
	""ReferencedStructureSetSequence"" VARIANT,
	""ApprovalStatus"" VARCHAR(16777216),
	""InterpretationTypeID"" VARCHAR(16777216),
	""InterpretationStatusID"" VARCHAR(16777216),
	""CurveDimensions"" VARIANT,
	""NumberOfPoints"" VARIANT,
	""TypeOfData"" VARIANT,
	""DataValueRepresentation"" VARIANT,
	""SharedFunctionalGroupsSequence"" VARIANT,
	""PerFrameFunctionalGroupsSequence"" VARIANT,
	""OverlayRows"" VARIANT,
	""OverlayColumns"" VARIANT,
	""NumberOfFramesInOverlay"" VARIANT,
	""OverlayDescription"" VARIANT,
	""OverlayType"" VARIANT,
	""OverlayOrigin"" VARIANT,
	""ImageFrameOrigin"" VARIANT,
	""OverlayBitsAllocated"" VARIANT,
	""OverlayBitPosition"" VARIANT,
	""Tag_00091110"" VARIANT,
	""Tag_00291032"" VARIANT,
	""Tag_00291140"" VARIANT,
	""Tag_00551012"" VARIANT,
	""Tag_00551022"" VARIANT,
	""Tag_01171010"" VARIANT,
	""Tag_01171020"" VARIANT,
	""Tag_01171022"" VARIANT,
	""Tag_01171024"" VARIANT,
	""Tag_011710B0"" VARIANT,
	""Tag_01191180"" VARIANT,
	""Tag_01F31001"" VARIANT,
	""Tag_01F31011"" VARIANT,
	""Tag_2001105F"" VARIANT,
	""Tag_20019000"" VARIANT,
	""Tag_20051080"" VARIANT,
	""Tag_20051084"" VARIANT,
	""Tag_20051085"" VARIANT,
	""Tag_20051132"" VARIANT,
	""Tag_20051402"" VARIANT,
	""Tag_2005140E"" VARIANT,
	""Tag_2005140F"" VARIANT,
	""OtherElements"" VARIANT,
	""DroppedTags"" VARIANT,
	""Type"" VARCHAR(16777216),
	""LastUpdated"" NUMBER(38,0),
	""StorageClass"" VARCHAR(16777216),
	""BlobStorageSize"" NUMBER(38,0)
);"

,4
table_name,MUTABLE_METADATA
description,
DDL,"create or replace TABLE MUTABLE_METADATA (
	""crdc_study_uuid"" VARCHAR(16777216),
	""crdc_series_uuid"" VARCHAR(16777216),
	""crdc_instance_uuid"" VARCHAR(16777216),
	""gcs_url"" VARCHAR(16777216),
	""aws_url"" VARCHAR(16777216),
	""access"" VARCHAR(16777216),
	""source_url"" VARCHAR(16777216),
	""source_doi"" VARCHAR(16777216),
	""license_long_name"" VARCHAR(16777216),
	""license_short_name"" VARCHAR(16777216),
	""license_url"" VARCHAR(16777216)
);"

,5
table_name,SEGMENTATIONS
description,
DDL,"create or replace TABLE SEGMENTATIONS (
	""PatientID"" VARCHAR(16777216),
	""StudyInstanceUID"" VARCHAR(16777216),
	""SeriesInstanceUID"" VARCHAR(16777216),
	""SOPInstanceUID"" VARCHAR(16777216),
	""FrameOfReferenceUID"" VARCHAR(16777216),
	""AnatomicRegion"" VARIANT,
	""AnatomicRegionModifier"" VARIANT,
	""SegmentedPropertyCategory"" VARIANT,
	""SegmentedPropertyType"" VARIANT,
	""SegmentAlgorithmType"" VARCHAR(16777216),
	""SegmentAlgorithmName"" VARCHAR(16777216),
	""SegmentNumber"" NUMBER(38,0),
	""TrackingUID"" VARCHAR(16777216),
	""TrackingID"" VARCHAR(16777216),
	""segmented_SeriesInstanceUID"" VARCHAR(16777216),
	""viewer_url"" VARCHAR(16777216)
);"

,6
table_name,QUANTITATIVE_MEASUREMENTS
description,
DDL,"create or replace TABLE QUANTITATIVE_MEASUREMENTS (
	""PatientID"" VARCHAR(16777216),
	""SOPInstanceUID"" VARCHAR(16777216),
	""SeriesDescription"" VARCHAR(16777216),
	""measurementGroup_number"" NUMBER(38,0),
	""segmentationInstanceUID"" VARCHAR(16777216),
	""segmentationSegmentNumber"" VARIANT,
	""sourceSegmentedSeriesUID"" VARCHAR(16777216),
	""trackingIdentifier"" VARCHAR(16777216),
	""trackingUniqueIdentifier"" VARCHAR(16777216),
	""Quantity"" VARIANT,
	""derivationModifier"" VARIANT,
	""Value"" NUMBER(38,9),
	""Units"" VARIANT,
	""finding"" VARIANT,
	""findingSite"" VARIANT
);"

,7
table_name,ANALYSIS_RESULTS_METADATA
description,
DDL,"create or replace TABLE ANALYSIS_RESULTS_METADATA (
	ID VARCHAR(16777216),
	""Title"" VARCHAR(16777216),
	""Access"" VARCHAR(16777216),
	DOI VARCHAR(16777216),
	""CancerType"" VARCHAR(16777216),
	""Location"" VARCHAR(16777216),
	""Subjects"" NUMBER(38,0),
	""Collections"" VARCHAR(16777216),
	""AnalysisArtifacts"" VARCHAR(16777216),
	""Updated"" DATE,
	""license_url"" VARCHAR(16777216),
	""license_long_name"" VARCHAR(16777216),
	""license_short_name"" VARCHAR(16777216),
	""Description"" VARCHAR(16777216),
	""AnalysisArtifactsonTCIA"" VARCHAR(16777216)
);"

,8
table_name,QUALITATIVE_MEASUREMENTS
description,
DDL,"create or replace TABLE QUALITATIVE_MEASUREMENTS (
	""PatientID"" VARCHAR(16777216),
	""SOPInstanceUID"" VARCHAR(16777216),
	""measurementGroup_number"" NUMBER(38,0),
	""segmentationInstanceUID"" VARCHAR(16777216),
	""segmentationSegmentNumber"" VARIANT,
	""sourceSegmentedSeriesUID"" VARCHAR(16777216),
	""trackingIdentifier"" VARCHAR(16777216),
	""trackingUniqueIdentifier"" VARCHAR(16777216),
	""Quantity"" VARIANT,
	""Value"" VARIANT,
	""finding"" VARIANT,
	""findingSite"" VARIANT
);"

,9
table_name,TCGA_CLINICAL_REL9
description,
DDL,"create or replace TABLE TCGA_CLINICAL_REL9 (
	""case_gdc_id"" VARCHAR(16777216),
	""case_barcode"" VARCHAR(16777216),
	""program_name"" VARCHAR(16777216),
	""disease_code"" VARCHAR(16777216),
	""project_short_name"" VARCHAR(16777216),
	""age_at_diagnosis"" NUMBER(38,0),
	""age_began_smoking_in_years"" VARCHAR(16777216),
	""anatomic_neoplasm_subdivision"" VARCHAR(16777216),
	""batch_number"" NUMBER(38,0),
	""bcr"" VARCHAR(16777216),
	""bmi"" FLOAT,
	""clinical_M"" VARCHAR(16777216),
	""clinical_N"" VARCHAR(16777216),
	""clinical_stage"" VARCHAR(16777216),
	""clinical_T"" VARCHAR(16777216),
	""colorectal_cancer"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""days_to_birth"" NUMBER(38,0),
	""days_to_death"" NUMBER(38,0),
	""days_to_initial_pathologic_diagnosis"" NUMBER(38,0),
	""days_to_last_followup"" NUMBER(38,0),
	""days_to_last_known_alive"" NUMBER(38,0),
	""days_to_submitted_specimen_dx"" VARCHAR(16777216),
	""ethnicity"" VARCHAR(16777216),
	""gender"" VARCHAR(16777216),
	""gleason_score_combined"" VARCHAR(16777216),
	""h_pylori_infection"" VARCHAR(16777216),
	""height"" NUMBER(38,0),
	""histological_type"" VARCHAR(16777216),
	""history_of_colon_polyps"" VARCHAR(16777216),
	""history_of_neoadjuvant_treatment"" VARCHAR(16777216),
	""hpv_calls"" VARCHAR(16777216),
	""hpv_status"" VARCHAR(16777216),
	""icd_10"" VARCHAR(16777216),
	""icd_o_3_histology"" VARCHAR(16777216),
	""icd_o_3_site"" VARCHAR(16777216),
	""lymphatic_invasion"" VARCHAR(16777216),
	""lymphnodes_examined"" VARCHAR(16777216),
	""lymphovascular_invasion_present"" VARCHAR(16777216),
	""menopause_status"" VARCHAR(16777216),
	""mononucleotide_and_dinucleotide_marker_panel_analysis_status"" VARCHAR(16777216),
	""neoplasm_histologic_grade"" VARCHAR(16777216),
	""new_tumor_event_after_initial_treatment"" BOOLEAN,
	""number_of_lymphnodes_examined"" NUMBER(38,0),
	""number_of_lymphnodes_positive_by_he"" VARCHAR(16777216),
	""number_pack_years_smoked"" NUMBER(38,0),
	""other_dx"" VARCHAR(16777216),
	""other_malignancy_anatomic_site"" VARCHAR(16777216),
	""other_malignancy_histological_type"" VARCHAR(16777216),
	""other_malignancy_type"" VARCHAR(16777216),
	""pathologic_M"" VARCHAR(16777216),
	""pathologic_N"" VARCHAR(16777216),
	""pathologic_stage"" VARCHAR(16777216),
	""pathologic_T"" VARCHAR(16777216),
	""person_neoplasm_cancer_status"" VARCHAR(16777216),
	""pregnancies"" VARCHAR(16777216),
	""primary_neoplasm_melanoma_dx"" VARCHAR(16777216),
	""primary_therapy_outcome_success"" VARCHAR(16777216),
	""psa_value"" VARCHAR(16777216),
	""race"" VARCHAR(16777216),
	""residual_tumor"" VARCHAR(16777216),
	""stopped_smoking_year"" NUMBER(38,0),
	""tobacco_smoking_history"" NUMBER(38,0),
	""tss_code"" VARCHAR(16777216),
	""tumor_tissue_site"" VARCHAR(16777216),
	""tumor_type"" VARCHAR(16777216),
	""venous_invasion"" VARCHAR(16777216),
	""vital_status"" VARCHAR(16777216),
	""weight"" NUMBER(38,0),
	""year_of_diagnosis"" NUMBER(38,0),
	""year_of_tobacco_smoking_onset"" NUMBER(38,0),
	""project_name"" VARCHAR(16777216)
);"

,10
table_name,VERSION_METADATA
description,
DDL,"create or replace TABLE VERSION_METADATA (
	""idc_version"" NUMBER(38,0),
	""version_hash"" VARCHAR(16777216),
	""version_timestamp"" VARCHAR(16777216)
);"

,11
table_name,DICOM_METADATA_CURATED_SERIES_LEVEL
description,
DDL,"create or replace TABLE DICOM_METADATA_CURATED_SERIES_LEVEL (
	""SeriesInstanceUID"" VARCHAR(16777216),
	""min_PixelSpacing_2sf"" FLOAT,
	""max_TotalPixelMatrixColumns"" NUMBER(38,0),
	""max_TotalPixelMatrixRows"" NUMBER(38,0),
	""ObjectiveLensPower"" NUMBER(38,0),
	""primaryAnatomicStructure_code_designator_value_str"" VARCHAR(16777216),
	""primaryAnatomicStructure_CodeMeaning"" VARCHAR(16777216),
	""illuminationType_code_designator_value_str"" VARCHAR(16777216),
	""illuminationType_CodeMeaning"" VARCHAR(16777216),
	""Modality"" VARCHAR(16777216)
);"

,12
table_name,DICOM_PIVOT
description,
DDL,"create or replace TABLE DICOM_PIVOT (
	""PatientID"" VARCHAR(16777216),
	""BodyPartExamined"" VARCHAR(16777216),
	""SeriesInstanceUID"" VARCHAR(16777216),
	""SliceThickness"" FLOAT,
	""SeriesNumber"" VARCHAR(16777216),
	""SeriesDescription"" VARCHAR(16777216),
	""StudyInstanceUID"" VARCHAR(16777216),
	""StudyDescription"" VARCHAR(16777216),
	""StudyDate"" DATE,
	""SOPInstanceUID"" VARCHAR(16777216),
	""Modality"" VARCHAR(16777216),
	""SOPClassUID"" VARCHAR(16777216),
	""collection_id"" VARCHAR(16777216),
	""AnatomicRegionSequence"" VARCHAR(16777216),
	""FrameOfReferenceUID"" VARCHAR(16777216),
	""crdc_study_uuid"" VARCHAR(16777216),
	""crdc_series_uuid"" VARCHAR(16777216),
	""crdc_instance_uuid"" VARCHAR(16777216),
	""Program"" VARCHAR(16777216),
	""tcia_tumorLocation"" VARCHAR(16777216),
	""source_DOI"" VARCHAR(16777216),
	""tcia_species"" VARCHAR(16777216),
	""license_short_name"" VARCHAR(16777216),
	""Manufacturer"" VARCHAR(16777216),
	""ManufacturerModelName"" VARCHAR(16777216),
	""instance_size"" NUMBER(38,0),
	""analysis_results_id"" VARCHAR(16777216),
	""SamplesPerPixel"" NUMBER(38,0),
	""CancerType"" VARCHAR(16777216),
	""Apparent_Diffusion_Coefficient"" NUMBER(38,9),
	""Internal_structure"" VARCHAR(16777216),
	""Sphericity"" VARCHAR(16777216),
	""Calcification"" VARCHAR(16777216),
	""Lobular_Pattern"" VARCHAR(16777216),
	""Spiculation"" VARCHAR(16777216),
	""Margin"" VARCHAR(16777216),
	""Texture"" VARCHAR(16777216),
	""Subtlety_score"" VARCHAR(16777216),
	""Malignancy"" VARCHAR(16777216),
	""Volume"" NUMBER(38,9),
	""Diameter"" NUMBER(38,9),
	""Surface_area_of_mesh"" NUMBER(38,9),
	""Sphericity_quant"" NUMBER(38,9),
	""Volume_of_Mesh"" NUMBER(38,9),
	""illuminationType"" VARCHAR(16777216),
	""primaryAnatomicStructure"" VARCHAR(16777216),
	""ObjectiveLensPower"" NUMBER(38,0),
	""min_PixelSpacing"" FLOAT,
	""max_TotalPixelMatrixColumns"" NUMBER(38,0),
	""max_TotalPixelMatrixRows"" NUMBER(38,0),
	""SegmentedPropertyCategoryCodeSequence"" VARCHAR(16777216),
	""SegmentedPropertyTypeCodeSequence"" VARCHAR(16777216),
	""SegmentNumber"" NUMBER(38,0),
	""SegmentAlgorithmType"" VARCHAR(16777216),
	""AdditionalPatientHistory"" VARCHAR(16777216),
	""Allergies"" VARCHAR(16777216),
	""ImageType"" VARCHAR(16777216),
	""LastMenstrualDate"" DATE,
	""MedicalAlerts"" VARCHAR(16777216),
	""EthnicGroup"" VARCHAR(16777216),
	""Occupation"" VARCHAR(16777216),
	""PatientAge"" VARCHAR(16777216),
	""PatientSex"" VARCHAR(16777216),
	""PatientComments"" VARCHAR(16777216),
	""PatientSize"" VARCHAR(16777216),
	""PatientWeight"" VARCHAR(16777216),
	""PregnancyStatus"" NUMBER(38,0),
	""ReasonForStudy"" VARCHAR(16777216),
	""RequestedProcedureComments"" VARCHAR(16777216),
	""SmokingStatus"" VARCHAR(16777216),
	""SeriesDate"" DATE,
	""access"" VARCHAR(16777216),
	""gcs_url"" VARCHAR(16777216),
	""aws_url"" VARCHAR(16777216),
	""gcs_bucket"" VARCHAR(16777216),
	""aws_bucket"" VARCHAR(16777216)
);"

,13
table_name,ORIGINAL_COLLECTIONS_METADATA
description,
DDL,"create or replace TABLE ORIGINAL_COLLECTIONS_METADATA (
	""collection_name"" VARCHAR(16777216),
	""collection_id"" VARCHAR(16777216),
	""Program"" VARCHAR(16777216),
	""Status"" VARCHAR(16777216),
	""Updated"" DATE,
	""Access"" VARIANT,
	""ImageTypes"" VARCHAR(16777216),
	""Subjects"" NUMBER(38,0),
	DOI VARCHAR(16777216),
	URL VARCHAR(16777216),
	""CancerType"" VARCHAR(16777216),
	""SupportingData"" VARCHAR(16777216),
	""Species"" VARCHAR(16777216),
	""Location"" VARCHAR(16777216),
	""licenses"" VARIANT,
	""Description"" VARCHAR(16777216),
	""idc_webapp_collection_id"" VARCHAR(16777216),
	""tcia_api_collection_id"" VARCHAR(16777216),
	""tcia_wiki_collection_id"" VARCHAR(16777216)
);"

,14
table_name,MEASUREMENT_GROUPS
description,
DDL,"create or replace TABLE MEASUREMENT_GROUPS (
	""SOPInstanceUID"" VARCHAR(16777216),
	""measurementGroup_number"" NUMBER(38,0),
	""trackingUniqueIdentifier"" VARCHAR(16777216),
	""trackingIdentifier"" VARCHAR(16777216),
	""PatientID"" VARCHAR(16777216),
	""SeriesDescription"" VARCHAR(16777216),
	""finding"" VARIANT,
	""findingSite"" VARIANT,
	""sourceSegmentedSeriesUID"" VARCHAR(16777216),
	""segmentationInstanceUID"" VARCHAR(16777216),
	""segmentationSegmentNumber"" VARIANT,
	""contentSequence"" VARIANT
);"

,15
table_name,TCGA_BIOSPECIMEN_REL9
description,
DDL,"create or replace TABLE TCGA_BIOSPECIMEN_REL9 (
	""sample_barcode"" VARCHAR(16777216),
	""sample_gdc_id"" VARCHAR(16777216),
	""case_barcode"" VARCHAR(16777216),
	""case_gdc_id"" VARCHAR(16777216),
	""sample_type"" VARCHAR(16777216),
	""sample_type_name"" VARCHAR(16777216),
	""program_name"" VARCHAR(16777216),
	""project_short_name"" VARCHAR(16777216),
	""batch_number"" NUMBER(38,0),
	""bcr"" VARCHAR(16777216),
	""days_to_collection"" FLOAT,
	""days_to_sample_procurement"" FLOAT,
	""is_ffpe"" VARCHAR(16777216),
	""num_portions"" NUMBER(38,0),
	""num_slides"" NUMBER(38,0),
	""avg_percent_lymphocyte_infiltration"" FLOAT,
	""avg_percent_monocyte_infiltration"" FLOAT,
	""avg_percent_necrosis"" FLOAT,
	""avg_percent_neutrophil_infiltration"" FLOAT,
	""avg_percent_normal_cells"" FLOAT,
	""avg_percent_stromal_cells"" FLOAT,
	""avg_percent_tumor_cells"" FLOAT,
	""avg_percent_tumor_nuclei"" FLOAT,
	""max_percent_lymphocyte_infiltration"" FLOAT,
	""max_percent_monocyte_infiltration"" FLOAT,
	""max_percent_necrosis"" FLOAT,
	""max_percent_neutrophil_infiltration"" FLOAT,
	""max_percent_normal_cells"" FLOAT,
	""max_percent_stromal_cells"" FLOAT,
	""max_percent_tumor_cells"" FLOAT,
	""max_percent_tumor_nuclei"" FLOAT,
	""min_percent_lymphocyte_infiltration"" FLOAT,
	""min_percent_monocyte_infiltration"" FLOAT,
	""min_percent_necrosis"" FLOAT,
	""min_percent_neutrophil_infiltration"" FLOAT,
	""min_percent_normal_cells"" FLOAT,
	""min_percent_stromal_cells"" FLOAT,
	""min_percent_tumor_cells"" FLOAT,
	""min_percent_tumor_nuclei"" FLOAT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'IDC': {'IDC_V17': ['ANALYSIS_RESULTS_METADATA', 'AUXILIARY_METADATA', 'DICOM_ALL', 'DICOM_METADATA', 'DICOM_METADATA_CURATED', 'DICOM_METADATA_CURATED_SERIES_LEVEL', 'DICOM_PIVOT', 'MEASUREMENT_GROUPS', 'MUTABLE_METADATA', 'ORIGINAL_COLLECTIONS_METADATA', 'QUALITATIVE_MEASUREMENTS', 'QUANTITATIVE_MEASUREMENTS', 'SEGMENTATIONS', 'TCGA_BIOSPECIMEN_REL9', 'TCGA_CLINICAL_REL9', 'VERSION_METADATA']}}
Begin Exploring Related Columns
**Relevant Columns and Potential Usage:**

- **"PatientID"**: Identifies individual patients; used to group data by patient.
- **"SliceThickness"**: Used to compute slice interval difference tolerance per patient by finding the difference between maximum and minimum values.
- **"Exposure"**: Used to compute maximum exposure difference per patient by finding the difference between maximum and minimum values.
- **"SeriesInstanceUID"**: Identifies individual series; used to aggregate instance sizes per series.
- **"instance_size"**: Size of each image instance; used to calculate series sizes by summing instance sizes.
- **"Modality"**: Used to filter records to only include CT images.
- **"collection_id"**: Used to filter records to only include data from the 'nlst' collection.

**Conditions that May Be Used:**

- **"Modality" = 'CT'**: Restricts data to CT images.
- **"collection_id" = 'nlst'**: Restricts data to the 'nlst' collection.
- **"SliceThickness" IS NOT NULL** and **"Exposure" IS NOT NULL**: Ensures that slice thickness and exposure values are available for calculations.

**SQL Queries:**

```sql
-- Query 1: Get distinct PatientIDs
SELECT DISTINCT "PatientID"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
LIMIT 100;
```

```sql
-- Query 2: Get distinct Modalities
SELECT DISTINCT "Modality"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
LIMIT 100;
```

```sql
-- Query 3: Retrieve CT images from the 'nlst' collection
SELECT *
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
LIMIT 100;
```

```sql
-- Query 4: Get SliceThickness values for CT images
SELECT "PatientID", "SliceThickness"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
LIMIT 100;
```

```sql
-- Query 5: Get Exposure values for CT images
SELECT "PatientID", "Exposure"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
LIMIT 100;
```

```sql
-- Query 6: Get instance sizes per series
SELECT "PatientID", "SeriesInstanceUID", "instance_size"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
LIMIT 100;
```

```sql
-- Query 7: Get exposure and slice thickness per patient
SELECT "PatientID", "SliceThickness", "Exposure"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst' AND "SliceThickness" IS NOT NULL AND "Exposure" IS NOT NULL
LIMIT 100;
```

```sql
-- Query 8: Calculate slice thickness difference per patient
SELECT "PatientID", MAX(CAST("SliceThickness" AS FLOAT)) - MIN(CAST("SliceThickness" AS FLOAT)) AS "SliceThicknessDifference"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst' AND "SliceThickness" IS NOT NULL
GROUP BY "PatientID"
LIMIT 100;
```

```sql
-- Query 9: Calculate exposure difference per patient
SELECT "PatientID", MAX(CAST("Exposure" AS FLOAT)) - MIN(CAST("Exposure" AS FLOAT)) AS "ExposureDifference"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst' AND "Exposure" IS NOT NULL
GROUP BY "PatientID"
LIMIT 100;
```

```sql
-- Query 10: Compute series sizes in MiB
SELECT "PatientID", "SeriesInstanceUID", SUM("instance_size") / (1024*1024) AS "SeriesSizeMiB"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
GROUP BY "PatientID", "SeriesInstanceUID"
LIMIT 100;
```

```sql
-- Query 11: Calculate average series size per patient
SELECT "PatientID", AVG("SeriesSizeMiB") AS "AverageSeriesSizeMiB"
FROM (
    SELECT "PatientID", "SeriesInstanceUID", SUM("instance_size") / (1024*1024) AS "SeriesSizeMiB"
    FROM "IDC"."IDC_V17"."DICOM_PIVOT"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
    GROUP BY "PatientID", "SeriesInstanceUID"
)
GROUP BY "PatientID"
LIMIT 100;
```

```sql
-- Query 12: Identify top 3 patients with highest slice thickness difference
SELECT "PatientID", MAX(CAST("SliceThickness" AS FLOAT)) - MIN(CAST("SliceThickness" AS FLOAT)) AS "SliceThicknessDifference"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst' AND "SliceThickness" IS NOT NULL
GROUP BY "PatientID"
ORDER BY "SliceThicknessDifference" DESC
LIMIT 3;
```

```sql
-- Query 13: Identify top 3 patients with highest exposure difference
SELECT "PatientID", MAX(CAST("Exposure" AS FLOAT)) - MIN(CAST("Exposure" AS FLOAT)) AS "ExposureDifference"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst' AND "Exposure" IS NOT NULL
GROUP BY "PatientID"
ORDER BY "ExposureDifference" DESC
LIMIT 3;
```

```sql
-- Query 14: Get average series size for top 3 patients with highest slice thickness difference
SELECT t."PatientID", AVG(t."SeriesSizeMiB") AS "AverageSeriesSizeMiB"
FROM (
    SELECT "PatientID", "SeriesInstanceUID", SUM("instance_size") / (1024*1024) AS "SeriesSizeMiB"
    FROM "IDC"."IDC_V17"."DICOM_PIVOT"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
    GROUP BY "PatientID", "SeriesInstanceUID"
) t
WHERE t."PatientID" IN (
    SELECT "PatientID"
    FROM (
        SELECT "PatientID", MAX(CAST("SliceThickness" AS FLOAT)) - MIN(CAST("SliceThickness" AS FLOAT)) AS "SliceThicknessDifference"
        FROM "IDC"."IDC_V17"."DICOM_PIVOT"
        WHERE "Modality" = 'CT' AND "collection_id" = 'nlst' AND "SliceThickness" IS NOT NULL
        GROUP BY "PatientID"
        ORDER BY "SliceThicknessDifference" DESC
        LIMIT 3
    )
)
GROUP BY t."PatientID";
```

```sql
-- Query 15: Get average series size for top 3 patients with highest exposure difference
SELECT t."PatientID", AVG(t."SeriesSizeMiB") AS "AverageSeriesSizeMiB"
FROM (
    SELECT "PatientID", "SeriesInstanceUID", SUM("instance_size") / (1024*1024) AS "SeriesSizeMiB"
    FROM "IDC"."IDC_V17"."DICOM_PIVOT"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
    GROUP BY "PatientID", "SeriesInstanceUID"
) t
WHERE t."PatientID" IN (
    SELECT "PatientID"
    FROM (
        SELECT "PatientID", MAX(CAST("Exposure" AS FLOAT)) - MIN(CAST("Exposure" AS FLOAT)) AS "ExposureDifference"
        FROM "IDC"."IDC_V17"."DICOM_PIVOT"
        WHERE "Modality" = 'CT' AND "collection_id" = 'nlst' AND "Exposure" IS NOT NULL
        GROUP BY "PatientID"
        ORDER BY "ExposureDifference" DESC
        LIMIT 3
    )
)
GROUP BY t."PatientID";
```

```sql
-- Query 16: Get the number of series per patient
SELECT "PatientID", COUNT(DISTINCT "SeriesInstanceUID") AS "SeriesCount"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
GROUP BY "PatientID"
LIMIT 100;
```

```sql
-- Query 17: List Exposure values (as float) for CT images
SELECT "PatientID", CAST("Exposure" AS FLOAT) AS "Exposure"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst' AND "Exposure" IS NOT NULL
LIMIT 100;
```

```sql
-- Query 18: List SliceThickness values (as float) for CT images
SELECT "PatientID", CAST("SliceThickness" AS FLOAT) AS "SliceThickness"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst' AND "SliceThickness" IS NOT NULL
LIMIT 100;
```

```sql
-- Query 19: Calculate average SliceThickness per series
SELECT "PatientID", "SeriesInstanceUID", AVG(CAST("SliceThickness" AS FLOAT)) AS "AvgSliceThickness"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst' AND "SliceThickness" IS NOT NULL
GROUP BY "PatientID", "SeriesInstanceUID"
LIMIT 100;
```

```sql
-- Query 20: Retrieve instance sizes and modalities
SELECT "PatientID", "Modality", "instance_size"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "collection_id" = 'nlst'
LIMIT 100;
```Query:
-- Query 1: Get distinct PatientIDs
SELECT DISTINCT "PatientID"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
LIMIT 100;
Answer:
PatientID
124864
126698
214027
218489
209671
212933
VHP-M
TCGA-D3-A2JO
Adrenal_Ki67_Seg_013
Adrenal_Ki67_Seg_036
EA1141-2422978
EA1141-4203755
TCGA-US-A774
UPENN-GBM-00526
UPENN-GBM-00416
UPENN-GBM-00471
UPENN-GBM-00277
UPENN-GBM-00033
UPENN-GBM-00345
UPENN-GBM-00461
UPENN-GBM-00259
UPENN-GBM-00069
UPENN-GBM-00180
UPENN-GBM-00047
UPENN-GBM-00082
UPENN-GBM-00417
UPENN-GBM-00224
UPENN-GBM-00609
UPENN-GBM-00559
ACRIN-6698-103939
202019
218458
ACRIN-6698-294739
200362
205653
114946
115312
108175
120877
113769
127150
119535
114346
103632
108500
132186
104094
118939
124557
126923
115922
116882
125876
103561
125914
126291
119105
110276
107480
127058
127392
114981
128657
116935
119471
119795
117263
108996
116454
133662
101297
102317
119355
116014
123264
107441
208173
130228
102250
212225
116627
UPENN-GBM-00343
UPENN-GBM-00133
UPENN-GBM-00070
UPENN-GBM-00084
UPENN-GBM-00373
UPENN-GBM-00257
UPENN-GBM-00323
UPENN-GBM-00615
ACRIN-6698-283070
ACRIN-6698-971492
D1-1032
114311
121099
209555
212900
203358
213865
UPENN-GBM-00438
ACRIN-6698-178150
Query:
-- Query 2: Get distinct Modalities
SELECT DISTINCT "Modality"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
LIMIT 100;
Answer:
Modality
NM
CT
PR
OT
KO
CR
RTDOSE
MG
SC
M3D
RF
RTSTRUCT
RTPLAN
FUSION
US
SM
XC
REG
MR
SEG
SR
PT
RWV
DX
Query:
-- Query 3: Retrieve CT images from the 'nlst' collection
SELECT *
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
LIMIT 100;
Answer:
Too long, hard cut:
PatientID,BodyPartExamined,SeriesInstanceUID,SliceThickness,SeriesNumber,SeriesDescription,StudyInstanceUID,StudyDescription,StudyDate,SOPInstanceUID,Modality,SOPClassUID,collection_id,AnatomicRegionSequence,FrameOfReferenceUID,crdc_study_uuid,crdc_series_uuid,crdc_instance_uuid,Program,tcia_tumorLocation,source_DOI,tcia_species,license_short_name,Manufacturer,ManufacturerModelName,instance_size,analysis_results_id,SamplesPerPixel,CancerType,Apparent_Diffusion_Coefficient,Internal_structure,Sphericity,Calcification,Lobular_Pattern,Spiculation,Margin,Texture,Subtlety_score,Malignancy,Volume,Diameter,Surface_area_of_mesh,Sphericity_quant,Volume_of_Mesh,illuminationType,primaryAnatomicStructure,ObjectiveLensPower,min_PixelSpacing,max_TotalPixelMatrixColumns,max_TotalPixelMatrixRows,SegmentedPropertyCategoryCodeSequence,SegmentedPropertyTypeCodeSequence,SegmentNumber,SegmentAlgorithmType,AdditionalPatientHistory,Allergies,ImageType,LastMenstrualDate,MedicalAlerts,EthnicGroup,Occupation,PatientAge,PatientSex,PatientComments,PatientSize,PatientWeight,PregnancyStatus,ReasonForStudy,RequestedProcedureComments,SmokingStatus,SeriesDate,access,gcs_url,aws_url,gcs_bucket,aws_bucket
204967,CHEST,1.3.6.1.4.1.14519.5.2.1.7009.9004.242419716572049390486363439790,2.0,2,"0,OPA,SE,SEN16,B,284,2,120,54,36,1.5",1.3.6.1.4.1.14519.5.2.1.7009.9004.778472803668624713529700511125,NLST-ACRIN,1999-01-02,1.3.6.1.4.1.14519.5.2.1.7009.9004.947767262213791990617807857377,CT,1.2.840.10008.5.1.4.1.1.2,nlst,,,cad2b013-4102-4365-8bd5-f2474c6df3c1,9c5d2724-6e5e-4c95-8a25-a81b7fb7c90a,2aa1e436-29a7-41d7-a74d-7713bb4163cd,NCI Trials,Chest,10.7937/TCIA.hmq8-j677,Human,CC BY 4.0,SIEMENS,Sensation 16,526984,,1,Lung Cancer,,,,,,,,,,,,,,,,,,,0.55,512,512,,,,,,,"ORIGINAL, PRIMARY, AXIAL, CT_SOM5 SPI",,,,,,,,,,,,,,,Public,gs://public-datasets-idc/9c5d2724-6e5e-4c95-8a25-a81b7fb7c90a/2aa1e436-29a7-41d7-a74d-7713bb4163cd.dcm,s3://idc-open-data/9c5d2724-6e5e-4c95-8a25-a81b7fb7c90a/2aa1e436-29a7-41d7-a74d-7713bb4163cd.dcm,public-datasets-idc,idc-open-data
218455,CHEST,1.3.6.1.4.1.14519.5.2.1.7009.9004.505187423497940223870392699671,2.0,2,"0,OPA,SE,SEN16,B,293,2,120,60,40,1.5",1.3.6.1.4.1.14519.5.2.1.7009.9004.256384441028048975960953953724,NLST-ACRIN,1999-01-02,1.3.6.1.4.1.14519.5.2.1.7009.9004.940018635558940048585348569359,CT,1.2.840.10008.5.1.4.1.1.2,nlst,,,e39a0abf-bb05-4e99-bb6b-4ec1fd610168,6db4116c-fc38-4aff-bd88-7ff840d38941,cde5694c-7a3d-45c5-a315-78800f62c353,NCI Trials,Chest,10.7937/TCIA.hmq8-j677,Human,CC BY 4.0,SIEMENS,Sensation 16,526726,,1,Lung Cancer,,,,,,,,,,,,,,,,,,,0.55,512,512,,,,,,,"ORIGINAL, PRIMARY, AXIAL, CT_SOM5 SPI",,,,,,,,,,,,,,,Public,gs://public-datasets-idc/6db4116c-fc38-4aff-bd88-7ff840d38941/cde5694c-7a3d-45c5-a315-78800f62c353.dcm,s3://idc-open-data/6db4116c-fc38-4aff-bd88-7ff840d38941/cde5694c-7a3d-45c5-a315-78800f62c353.dcm,public-datasets-idc,idc-open-data
206866,CHEST,1.3.6.1.4.1.14519.5.2.1.7009.9004.163903497580655762081824662915,2.0,2,"0,OPA,SE,SEN16,B,294,2,120,54,36,1.5",1.3.6.1.4.1.14519.5.2.1.7009.9004.315603051606094319132439807208,NLST-ACRIN,1999-01-02,1.3.6.1.4.1.14519.5.2.1.7009.9004.272280936076670315944379808904,CT,1.2.840.10008.5.1.4.1.1.2,nlst,,,0084de8a-1e48-42bb-bbca-36e895863110,58d5eeff-2f2b-4607-ab56-dc26da5b85c1,1ead7771-cbd5-4640-9aa5-80ecbacfe229,NCI Trials,Chest,10.7937/TCIA.hmq8-j677,Human,CC BY 4.0,SIEMENS,Sensation 16,526728,,1,Lung Cancer,,,,,,,,,,,,,,,,,,,0.57,512,512,,,,,,,"ORIGINAL, PRIMARY, AXIAL, CT_SOM5 SPI",,,,,,,,,,,,,,,Public,gs://public-datasets-idc/58d5eeff-2f2b-4607-ab56-dc26da5b85c1/1ead7771-cbd5-4640-9aa5-80ecbacfe229.dcm,s3://idc-open-data/58d5eeff-2f2b-4607-ab56-dc26da5b85c1/1ead7771-cbd5-4640-9aa5-80ecbacfe229.dcm,public-datasets-idc,idc-open-data
216409,CHEST,1.3.6.1.4.1.14519.5.2.1.7009.9004.272023982202096594627344150703,2.0,2,"0,OPA,SE,SEN16,B,318,2,120,51,34,1.5",1.3.6.1.4.1.14519.5.2.1.7009.9004.139487478873545785850130696172,NLST-ACRIN,1999-01-02,1.3.6.1.4.1.14519.5.2.1.7009.9004.183641994246121611231019809592,CT,1.2.840.10008.5.1.4.1.1.2,nlst,,,e5235e73-941d-49b5-b520-3d09da2a65b2,04db656f-5188-458a-b593-d0cb9af87dcc,cd38ea3e-9cad-4933-8820-c0715400820f,NCI Trials,Chest,10.7937/TCIA.hmq8-j677,Human,CC BY 4.0,SIEMENS,Sensation 16,526992,,1,Lung Cancer,,,,,,,,,,,,,,,,,,,0.62,512,512,,,,,,,"ORIGINAL, PRIMARY, AXIAL, CT_SOM5 SPI",,,,,,,,,,,,,,,Public,gs://public-datasets-idc/04db656f-5188-458a-b593-d0cb9af87dcc/cd38ea3e-9cad-4933-8820-c0715400820f.dcm,s3://idc-open-data/04db656f-5188-458a-b593-d0cb9af87dcc/cd38ea3e-9cad-4933-8820-c0715400820f.dcm,public-datasets-idc,idc-open-data
202418,CHEST,1.3.6.1.4.1.14519.5.2.1.7009.9004.304483750374475466158135376108,2.0,2,"0,OPA,SE,SEN16,B,332,2,120,51,34,1.5",1.3.6.1.4.1.14519.5.2.1.7009.9004.247172566772255115976874272374,NLST-ACRIN,1999-01-02,1.3.6.1.4.1.14519.5.2.1.7009.9004.164754224742418859440753311768,CT,1.2.840.10008.5.1.4.1.1.2,nlst,,,c1ee49da-ee5c-4328-8751-b7d93f66379d,a7b7891a-f4b6-44a6-9c6e-749ecf20d847,abed030b-b746-
Query:
-- Query 4: Get SliceThickness values for CT images
SELECT "PatientID", "SliceThickness"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
LIMIT 100;
Answer:
PatientID,SliceThickness
200479,
204967,2.0
218455,2.0
218455,2.0
207779,2.0
208053,2.0
209555,1.0
213154,2.0
217875,2.0
206864,2.0
210701,2.0
212344,2.0
201149,2.0
217440,2.0
214551,2.0
206846,2.0
211178,2.0
203414,2.0
203162,2.0
216275,2.0
217572,2.0
213754,2.0
218028,2.0
215733,2.0
215733,2.0
215733,2.0
214445,2.0
203806,2.0
203806,2.0
215664,2.0
218044,2.0
218044,2.0
218044,2.0
211259,2.0
215152,2.0
212714,2.0
215152,2.0
215152,2.0
214184,2.0
214184,2.0
213865,2.0
200525,2.0
212899,2.0
206331,2.0
201080,2.0
212899,2.0
201506,2.0
214852,2.0
202669,2.0
218791,2.0
206954,2.0
205220,2.0
203730,2.0
200520,2.0
212933,2.0
216957,2.0
206494,2.0
206494,2.0
207645,2.0
200887,2.0
207645,2.0
211005,2.0
209671,2.0
204244,2.0
208402,2.0
212419,2.0
204119,2.0
213523,2.0
204793,2.0
201151,2.0
201754,2.0
218608,2.0
209318,2.0
210894,2.0
210894,2.0
211829,2.0
207408,2.0
207826,2.0
203359,2.0
204170,2.0
204170,2.0
207954,2.0
212547,2.0
218013,2.0
216131,2.0
218013,2.0
211451,2.0
210814,2.0
208275,2.0
210814,2.0
215647,2.0
200183,2.0
207992,2.0
216340,2.0
212392,2.0
201049,2.0
212392,2.0
214415,2.0
210935,2.0
215755,2.0
Query:
-- Retrieve Exposure values for CT images from the 'nlst' collection
SELECT "PatientID", "Exposure"
FROM "IDC"."IDC_V17"."DICOM_ALL"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst' AND "Exposure" IS NOT NULL
LIMIT 100;
Answer:
PatientID,Exposure
201814,50
100099,60
100364,60
100541,79
100597,39
100690,39
100772,39
102055,39
102184,60
102277,39
102973,60
103420,39
104009,39
104680,79
105344,39
106120,39
106268,60
106358,39
106546,39
106635,60
107055,39
107096,39
108082,39
108282,39
108304,39
108836,60
109303,39
109433,79
109685,39
110155,39
110195,39
111702,60
111800,39
112111,39
112665,79
112826,60
113879,79
115844,39
116201,39
116925,79
117844,39
118383,39
118599,60
118981,39
119414,39
119464,79
119971,60
120677,39
120677,39
121055,60
124188,39
124357,69
124374,39
124396,39
125306,50
126639,39
126639,39
127573,39
127597,39
127853,39
127962,39
128460,39
129188,79
129530,60
129541,39
129653,39
130506,39
130586,39
131387,60
132432,39
133428,60
133834,60
134553,79
200964,50
203910,50
206882,50
206992,50
215346,49
215425,50
203946,50
206065,50
206553,50
207402,50
211100,70
212010,50
213719,50
215962,70
217889,50
100696,39
101916,39
102038,50
102194,40
102502,39
103664,39
103903,39
104553,41
104628,39
105166,39
106343,80
107055,39
Query:
-- Query 6: Get instance sizes per series
SELECT "PatientID", "SeriesInstanceUID", "instance_size"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
LIMIT 100;
Answer:
Too long, hard cut:
PatientID,SeriesInstanceUID,instance_size
218802,1.3.6.1.4.1.14519.5.2.1.7009.9004.282826873088089260708693811407,526726
214027,1.3.6.1.4.1.14519.5.2.1.7009.9004.281053228755623457241559519489,526722
216409,1.3.6.1.4.1.14519.5.2.1.7009.9004.272023982202096594627344150703,526992
202418,1.3.6.1.4.1.14519.5.2.1.7009.9004.304483750374475466158135376108,526994
207375,1.3.6.1.4.1.14519.5.2.1.7009.9004.289234750051622959034086395316,526992
206864,1.3.6.1.4.1.14519.5.2.1.7009.9004.310678295138330979593131558590,526994
212344,1.3.6.1.4.1.14519.5.2.1.7009.9004.136898235852818907963554088508,526814
212077,1.3.6.1.4.1.14519.5.2.1.7009.9004.187034345344882291608546398185,526688
210993,1.3.6.1.4.1.14519.5.2.1.7009.9004.167771055072091219513807451033,526702
210993,1.3.6.1.4.1.14519.5.2.1.7009.9004.167771055072091219513807451033,526704
210644,1.3.6.1.4.1.14519.5.2.1.7009.9004.213541391925927155403272761946,526818
211178,1.3.6.1.4.1.14519.5.2.1.7009.9004.140604347861128746247858722287,526816
211178,1.3.6.1.4.1.14519.5.2.1.7009.9004.140604347861128746247858722287,526818
203414,1.3.6.1.4.1.14519.5.2.1.7009.9004.265590634801660242439261996857,526816
218072,1.3.6.1.4.1.14519.5.2.1.7009.9004.303645220436042603410098033943,526850
202394,1.3.6.1.4.1.14519.5.2.1.7009.9004.275837112032586883381221401092,526848
213056,1.3.6.1.4.1.14519.5.2.1.7009.9004.115656912299859183287044512123,526850
215026,1.3.6.1.4.1.14519.5.2.1.7009.9004.304823247557954224981770189677,526814
205076,1.3.6.1.4.1.14519.5.2.1.7009.9004.309433124880502014517257635181,526694
218044,1.3.6.1.4.1.14519.5.2.1.7009.9004.203456778051969137441797829295,526698
217744,1.3.6.1.4.1.14519.5.2.1.7009.9004.302823383130737750042548075708,526706
201021,1.3.6.1.4.1.14519.5.2.1.7009.9004.671438701513651643434457877886,526698
202477,1.3.6.1.4.1.14519.5.2.1.7009.9004.433141445470101318162470923426,526690
210880,1.3.6.1.4.1.14519.5.2.1.7009.9004.468613874626421534106160209837,526820
202477,1.3.6.1.4.1.14519.5.2.1.7009.9004.433141445470101318162470923426,526688
214184,1.3.6.1.4.1.14519.5.2.1.7009.9004.463033806964556482794230861295,526708
208269,1.3.6.1.4.1.14519.5.2.1.7009.9004.195866616247091714210520322516,526708
200242,1.3.6.1.4.1.14519.5.2.1.7009.9004.263970182035018500935940546948,526820
210980,1.3.6.1.4.1.14519.5.2.1.7009.9004.700421702622407997607866815100,526688
210070,1.3.6.1.4.1.14519.5.2.1.7009.9004.215276538887350318578299024351,526848
203727,1.3.6.1.4.1.14519.5.2.1.7009.9004.113294968820723117479808499375,526702
212582,1.3.6.1.4.1.14519.5.2.1.7009.9004.180991024533021344665170679793,526688
216704,1.3.6.1.4.1.14519.5.2.1.7009.9004.299448323138487327943235413212,526694
212582,1.3.6.1.4.1.14519.5.2.1.7009.9004.180991024533021344665170679793,526688
201552,1.3.6.1.4.1.14519.5.2.1.7009.9004.280371277839536323978988955654,526708
206954,1.3.6.1.4.1.14519.5.2.1.7009.9004.340070022361040175265294417022,526820
200520,1.3.6.1.4.1.14519.5.2.1.7009.9004.415193433515684236719844623243,526820
218872,1.3.6.1.4.1.14519.5.2.1.7009.9004.232055115282365494390761150581,526848
212488,1.3.6.1.4.1.14519.5.2.1.7009.9004.297607224765685620799553894188,526686
217951,1.3.6.1.4.1.14519.5.2.1.7009.9004.191138524272157073630374586032,526690
208731,1.3.6.1.4.1.14519.5.2.1.7009.9004.684525285407306263403166833254,526820
204879,1.3.6.1.4.1.14519.5.2.1.7009.9004.951689514406044216367597689054,526812
204113,1.3.6.1.4.1.14519.5.2.1.7009.9004.133627602614881769003055761524,526706
212933,1.3.6.1.4.1.14519.5.2.1.7009.9004.114140058557136667043874509446,526838
214598,1.3.6.1.4.1.14519.5.2.1.7009.9004.286236580274194373804531532886,526704
200604,1.3.6.1.4.1.14519.5.2.1.7009.9004.271669723590113307403942001518,526814
217690,1.3.6.1.4.1.14519.5.2.1.7009.9004.118660656090291087946014780040,526850
204350,1.3.6.1.4.1.14519.5.2.1.7009.9004.825757795413206596563173513157,526700
214410,1.3.6.1.4.1.14519.5.2.1.7009.9004.228297484309778907516849644467,526814
202744,1.3.6.1.4.1.14519.5.2.1.7009.9004.185079362893751975773755923032,526708
212340,1.3.6.1.4.1.14519.5.2.1.7009.9004.470020961830459946273810419883,526706
205163,1.3.6.1.4.1.14519.5.2.1.7009.9004.196068188801182520131443056832,526814
201154,1.3.6.1.4.1.14519.5.2.1.7009.9004.162457739805749888572144899128,526810
204119,1.3.6.1.4.1.14519.5.2.1.7009.9004.286271020588616024038664141479,526700
204119,1.3.6.1.4.1.14519.5.2.1.7009.9004.286271020588616024038664141479,526698
217130,1.3.6.1.4.1.14519.5.2.1.7009.9004.251304519644496070590518600451,526822
201904,1.3.6.1.4.1.14519.5.2.1.7009.9004.267609805920728375534581673222,526820
206974,1.3.6.1.4.1.14519.5.2.1.7009.9004.695822461535886014797383165285,526706
213223,1.3.6.1.4.1.14519.5.2.1.7009.9004.548094798828973690788870709733,526808
201754,1.3.6.1.4.1.14519.5.2.1.7009.9004.118862257776785305148084981321,526808
218608,1.3.6.1.4.1.14519.5.2.1.7009.9004.111255539694825413569678637745,526800
208834,1.3.6.1.4.1.14519.5.2.1.7009.9004.150377120082862401420832945191,526696
200785,1.3.6.1.4.1.14519.5.2.1.7009.9004.1621836230690461639
Query:
-- Query 8: Calculate slice thickness difference per patient
SELECT "PatientID",
       MAX(CAST("SliceThickness" AS FLOAT)) - MIN(CAST("SliceThickness" AS FLOAT)) AS "SliceThicknessDifference"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "SliceThickness" IS NOT NULL AND TRY_CAST("SliceThickness" AS FLOAT) IS NOT NULL
GROUP BY "PatientID"
LIMIT 100;
Answer:
PatientID,SliceThicknessDifference
205653,1.25
209477,1.25
132464,0.0
214914,1.25
201038,1.25
117075,0.0
110276,0.0
115441,0.0
116935,0.0
114981,0.0
124584,437.681793
128558,0.0
132935,372.590881
102406,0.0
132415,0.0
132053,0.0
112311,0.0
101297,0.0
103771,0.0
106226,0.0
114933,0.0
130274,0.0
119409,0.0
107441,0.0
111467,0.0
119355,0.0
122356,0.0
124973,0.0
126138,0.0
117016,0.0
110862,0.0
116553,0.0
123448,0.0
133292,0.0
110950,457.681793
122526,0.0
211416,427.681824
208430,0.0
210576,0.0
206363,7.5
101046,0.0
107124,0.0
103567,0.0
127392,0.0
110007,0.0
211050,0.5
209677,1.25
110684,0.0
201001,0.7000000000000002
212859,0.0
213562,0.0
206261,1.25
200311,1.25
201446,1.25
214332,0.0
218034,1.25
207880,1.25
212380,0.0
200103,0.0
201826,348.931824
117067,0.0
124382,0.0
103446,0.0
123330,0.0
105310,0.0
207999,0.0
131584,0.0
131183,407.681793
133293,0.0
108869,372.590881
104493,0.0
121972,0.0
100970,0.0
116454,0.0
102250,0.0
200714,0.0
212694,0.0
206333,0.0
203142,407.681824
200619,0.0
126031,0.0
125151,383.136383
117540,372.590881
210730,0.0
113957,0.0
116014,0.0
108387,407.681763
210264,0.0
216371,0.0
213758,0.0
218515,0.5
217515,0.0
211053,0.5
213218,0.0
207879,0.0
216951,0.5
216529,1.25
121597,0.0
205435,0.0
203508,0.0
Query:
-- Query 9: Calculate exposure difference per patient
SELECT "PatientID",
       MAX(TRY_CAST("Exposure" AS FLOAT)) - MIN(TRY_CAST("Exposure" AS FLOAT)) AS "ExposureDifference"
FROM "IDC"."IDC_V17"."DICOM_ALL"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "Exposure" IS NOT NULL AND TRY_CAST("Exposure" AS FLOAT) IS NOT NULL
GROUP BY "PatientID"
LIMIT 100
Answer:
PatientID,ExposureDifference
120209,74.0
112068,52.0
213951,70.0
205656,1660.0
218786,1017.0
203391,350.0
214595,632.0
130302,190.0
218320,709.0
214216,1459.0
207203,467.0
216594,737.0
212462,2153.0
103364,2037.0
107945,65.0
108051,135.0
202577,204.0
202878,0.0
101193,1274.0
111230,1438.0
200270,717.0
202426,484.0
203168,806.0
126330,100.0
130319,10.0
203049,840.0
213093,317.0
118912,1293.0
217798,1140.0
215467,692.0
131083,60.0
209692,140.0
129874,37.0
108146,160.0
120537,1290.0
108635,1970.0
214308,1083.0
214049,301.0
209372,2090.0
207028,439.0
212735,1900.0
206505,207.0
207294,403.0
215274,733.0
128923,161.0
215569,721.0
213627,560.0
208451,31.0
120409,198.0
106030,1847.0
202496,610.0
106528,122.0
134456,37.0
113781,125.0
125250,979.0
121348,420.0
105820,1040.0
125439,988.0
202645,923.0
207166,1170.0
207935,0.0
210802,1801.0
127646,320.0
107983,1691.0
118046,46.0
108579,240.0
205131,34.0
127539,612.0
124412,120.0
109376,1099.0
133497,240.0
119830,60.0
211580,3088.0
132741,0.0
209256,17.0
120070,48.0
118519,0.0
105464,0.0
100194,0.0
103120,30.0
124715,0.0
201348,531.0
212296,0.0
129753,0.0
128337,0.0
105920,110.0
209929,1113.0
122204,1394.0
115118,751.0
117282,1048.0
208735,351.0
108547,57.0
216553,233.0
131150,0.0
105653,185.0
121829,0.0
105801,23.0
132832,16.0
112603,0.0
204668,2.0
Query:
-- Query 10: Compute series sizes in MiB
SELECT "PatientID", "SeriesInstanceUID",
       SUM("instance_size") / (1024 * 1024) AS "SeriesSizeMiB"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
GROUP BY "PatientID", "SeriesInstanceUID"
LIMIT 100
Answer:
Too long, hard cut:
PatientID,SeriesInstanceUID,SeriesSizeMiB
205251,1.3.6.1.4.1.14519.5.2.1.7009.9004.166786708348672109504046243886,3.014626
200392,1.3.6.1.4.1.14519.5.2.1.7009.9004.172715049051355276659109603582,3.014612
217447,1.3.6.1.4.1.14519.5.2.1.7009.9004.664334745222970665922202267377,5.024477
113776,1.2.840.113654.2.55.113114655744419781597576534988577334225,1.506844
127418,1.2.840.113654.2.55.149486968974160624163974742891319976157,2.009125
108365,1.2.840.113654.2.55.69174893974355077079649479860941693492,1.506632
113718,1.2.840.113654.2.55.158879025388009511957925494689129171354,1.506628
113058,1.2.840.113654.2.55.147764327300292117442776308954168185265,2.511059
103211,1.2.840.113654.2.55.35382625923748387583501034133272419685,5.022083
125745,1.2.840.113654.2.55.153409574742532399938781472939807430831,2.008842
109529,1.2.840.113654.2.55.313553427447646394897354370705706647862,5.022108
109607,1.2.840.113654.2.55.58730600592330134300164375147313633127,5.022789
124455,1.2.840.113654.2.55.111348709748424202473326167648824387363,2.511068
112224,1.2.840.113654.2.55.190332823100530359546613860414964071692,2.511248
121452,1.2.840.113654.2.55.122245452802512735684319819062963140573,1.004496
106166,1.2.840.113654.2.55.161630102044158124436449083008296607340,4.017794
116104,1.2.840.113654.2.55.150823922671683956935716887107927488545,3.515745
124057,1.2.840.113654.2.55.261683184517775622513495965948359687189,3.013187
124340,1.2.840.113654.2.55.111180866924434897607720359162042562364,2.511002
112391,1.2.840.113654.2.55.190632441053645001032728063657529933617,1.506844
118118,1.2.840.113654.2.55.320623121349875573088786585747145307319,3.013687
102098,1.2.840.113654.2.55.305378366984007540765459839999597570,2.008860
110830,1.2.840.113654.2.55.179100388053842948203839938509434118217,1.506754
208688,1.3.6.1.4.1.14519.5.2.1.7009.9004.311368776571054822457849521605,3.518055
120830,1.2.840.113654.2.55.108400053299805110877829424744048000624,3.013258
126106,1.2.840.113654.2.55.138704018072945511578410912246716411561,2.008829
104324,1.2.840.113654.2.55.120151547746893195710029680921976316332,3.013248
127456,1.2.840.113654.2.55.34693575075452061867047287892150584227,1.506624
105447,1.2.840.113654.2.55.284338390702996493558512663603602787407,2.008839
103585,1.2.840.113654.2.55.315992417923297383327009740405959471882,3.013186
121397,1.2.840.113654.2.55.89889312077800995889914448771165180646,2.511341
134049,1.2.840.113654.2.55.64183646285795176590479040762493571138,2.008846
126909,1.2.840.113654.2.55.40760306340303249503603802897299710342,2.008852
110635,1.2.840.113654.2.55.241255060847971017189173652623119624605,1.004440
121596,1.2.840.113654.2.55.195448278380871016243166071934398511819,2.511242
203933,1.3.6.1.4.1.14519.5.2.1.7009.9004.494527862505367762798160206385,2.009762
100409,1.2.840.113654.2.55.46228917331601396505996564679098614397,1.004414
125284,1.2.840.113654.2.55.198784201488545313544645078888014167537,2.511044
111530,1.2.840.113654.2.55.336731026273387683114291446765132906381,1.506622
123207,1.2.840.113654.2.55.38417272971128123996254358246668387280,5.021980
121705,1.2.840.113654.2.55.314098678806633294973263553575460524243,1.506598
207629,1.3.6.1.4.1.14519.5.2.1.7009.9004.204637700157337980957883633209,4.020517
214758,1.3.6.1.4.1.14519.5.2.1.7009.9004.245399753032061631729608464379,3.518139
208784,1.3.6.1.4.1.14519.5.2.1.7009.9004.303103453425121613940011732534,5.025909
212563,1.3.6.1.4.1.14519.5.2.1.7009.9004.180280498949576820549494161658,1.005150
107904,1.2.840.113654.2.55.101845354817737295917753769384053353476,2.511086
109118,1.2.840.113654.2.55.217837652971613927634547927578087793698,3.013264
131356,1.2.840.113654.2.55.334225885534239163693050756129130499256,1.506641
118759,1.2.840.113654.2.55.7555821702401262093676885231612867736,2.009035
214760,1.3.6.1.4.1.14519.5.2.1.7009.9004.200740258895378524823408387010,2.010302
203413,1.3.6.1.4.1.14519.5.2.1.7009.9004.460174585185763011360261385346,1.507763
201207,1.3.6.1.4.1.14519.5.2.1.7009.9004.110980192286339995420834727714,4.521681
121562,1.2.840.113654.2.55.55054173252010781451107796553343735293,2.510921
217306,1.3.6.1.4.1.14519.5.2.1.7009.9004.131562159415486879638575032200,10.550835
216691,1.3.6.1.4.1.14519.5.2.1.7009.9004.949097060656219403603582770195,4.522303
214005,1.3.6.1.4.1.14519.5.2.1.7009.9004.328958760031526775832179404190,9.546326
118636,1.2.840.113654.2.55.331830863776278366581900980812580069250,3.013184
216518,1.3.6.1.4.1.14519.5.2.1.7009.9004.696956505299963806719435760407,8.550167
206422,1.3.6.1.4.1.14519.5.2.1.7009.9004.549716260446745480474041605838,4.523220
201907,1.3.6.1.4.1.14519.5.2.1.7009.9004.582426203700910996530569521196,6.031063
109357,1.2.840.113654.2.55.293669835708983923710827993418061843990,2.008823
113064,1.2.840.113654.2.55.128457270870306392480624908897688872299,5.022816
123458,1.2.840.113654.2.55.288469012560443951226104818156063448399,2.511082
132327,1.2.840.113654.2.55.237644688909414246280337103936047695257,3.515512
114568,1.2.840.113
Query:
-- Query 11: Calculate average series size per patient
SELECT "PatientID", AVG("SeriesSizeMiB") AS "AverageSeriesSizeMiB"
FROM (
    SELECT "PatientID", "SeriesInstanceUID",
           SUM("instance_size") / (1024 * 1024) AS "SeriesSizeMiB"
    FROM "IDC"."IDC_V17"."DICOM_PIVOT"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
    GROUP BY "PatientID", "SeriesInstanceUID"
) AS subquery
GROUP BY "PatientID"
LIMIT 100
Answer:
PatientID,AverageSeriesSizeMiB
108991,2.678511666667
126136,2.845812000000
114959,3.932328166667
121256,3.012500833333
103112,2.134395250000
134456,2.008923200000
200191,2.072939000000
203091,3.718602400000
216340,2.466426181818
204520,3.097560333333
214488,2.260396500000
102371,1.841468000000
113545,3.683180333333
218702,3.350177500000
211752,3.769262500000
129874,2.008835666667
203041,2.177936833333
126901,2.092499333333
132122,1.204733000000
132590,2.373517909091
216449,3.138550750000
216751,3.518100166667
129753,1.815172461538
115812,2.426668500000
132342,2.511302666667
119802,1.459312375000
130223,2.223521857143
200689,5.022424250000
120493,2.327793181818
212393,2.887387750000
114549,2.510345833333
212735,2.512860000000
200868,5.022966500000
115525,2.109266800000
100530,1.506615000000
113404,3.096945333333
207262,2.762366250000
203730,3.348711333333
126482,2.058586300000
204637,4.522207111111
120836,1.460590454545
204317,2.761965500000
109287,1.841406000000
218401,1.675386333333
106558,1.673622083333
112991,2.761369000000
214224,3.600937166667
117340,1.589904166667
203049,3.316551200000
212296,5.525078500000
212265,3.266349666667
115485,1.506212500000
101144,2.510418500000
123136,2.447632500000
105653,1.699389692308
130319,2.108050750000
206164,2.511565000000
115389,1.506601000000
214167,3.126478666667
132523,2.176177166667
128577,3.096158000000
134356,3.514779000000
128465,2.343676333333
214595,2.613448200000
110647,1.338905333333
132832,1.883325750000
121217,2.175828166667
110142,3.682057000000
123767,1.506623750000
132185,2.928704000000
200856,4.020123000000
203668,3.014878888889
126907,2.259345666667
126478,1.841369833333
119267,0.753238750000
118105,2.677610428571
216769,3.518120000000
212437,2.456223000000
120490,2.092448666667
207934,3.180606166667
210789,2.122081111111
117577,1.757635666667
122528,1.506296714286
106659,2.108682600000
212992,1.674924333333
122227,3.514235666667
113667,3.137733500000
114689,1.506618500000
215446,3.601024250000
132606,2.678509333333
215555,2.324460625000
114098,1.707527800000
121740,2.115198500000
200270,2.871729142857
100314,1.381095500000
215569,2.915051800000
103629,1.255531750000
113002,2.317301769231
107931,1.793144285714
114237,2.310283200000
Query:
-- Query 12: Identify top 3 patients with highest slice thickness difference
SELECT "PatientID",
       MAX(TRY_CAST("SliceThickness" AS FLOAT)) - MIN(TRY_CAST("SliceThickness" AS FLOAT)) AS "SliceThicknessDifference"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "SliceThickness" IS NOT NULL AND TRY_CAST("SliceThickness" AS FLOAT) IS NOT NULL
GROUP BY "PatientID"
ORDER BY "SliceThicknessDifference" DESC
LIMIT 3
Answer:
PatientID,SliceThicknessDifference
110260,497.681824
132882,497.681793
112625,477.681824
Query:
-- Query 13: Identify top 3 patients with highest exposure difference
SELECT "PatientID",
       MAX(TRY_CAST("Exposure" AS FLOAT)) - MIN(TRY_CAST("Exposure" AS FLOAT)) AS "ExposureDifference"
FROM "IDC"."IDC_V17"."DICOM_ALL"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "Exposure" IS NOT NULL AND TRY_CAST("Exposure" AS FLOAT) IS NOT NULL
GROUP BY "PatientID"
ORDER BY "ExposureDifference" DESC
LIMIT 3
Answer:
PatientID,ExposureDifference
212691,7740.0
109153,7170.0
109939,7120.0
Query:
-- Query 14: Get average series size for top 3 patients with highest slice thickness difference
WITH TopPatients AS (
    SELECT "PatientID"
    FROM (
        SELECT "PatientID",
               MAX(TRY_CAST("SliceThickness" AS FLOAT)) - MIN(TRY_CAST("SliceThickness" AS FLOAT)) AS "SliceThicknessDifference"
        FROM "IDC"."IDC_V17"."DICOM_PIVOT"
        WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
          AND "SliceThickness" IS NOT NULL AND TRY_CAST("SliceThickness" AS FLOAT) IS NOT NULL
        GROUP BY "PatientID"
        ORDER BY "SliceThicknessDifference" DESC
        LIMIT 3
    )
)
SELECT t."PatientID", AVG(t."SeriesSizeMiB") AS "AverageSeriesSizeMiB"
FROM (
    SELECT "PatientID", "SeriesInstanceUID",
           SUM("instance_size") / (1024 * 1024) AS "SeriesSizeMiB"
    FROM "IDC"."IDC_V17"."DICOM_PIVOT"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
    GROUP BY "PatientID", "SeriesInstanceUID"
) t
WHERE t."PatientID" IN (SELECT "PatientID" FROM TopPatients)
GROUP BY t."PatientID"
Answer:
PatientID,AverageSeriesSizeMiB
112625,1.377551750000
110260,2.020975000000
132882,1.770029250000
Query:
-- Query 15: Get average series size for top 3 patients with highest exposure difference
WITH TopPatients AS (
    SELECT "PatientID"
    FROM (
        SELECT "PatientID",
               MAX(TRY_CAST("Exposure" AS FLOAT)) - MIN(TRY_CAST("Exposure" AS FLOAT)) AS "ExposureDifference"
        FROM "IDC"."IDC_V17"."DICOM_ALL"
        WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
          AND "Exposure" IS NOT NULL AND TRY_CAST("Exposure" AS FLOAT) IS NOT NULL
        GROUP BY "PatientID"
        ORDER BY "ExposureDifference" DESC
        LIMIT 3
    )
)
SELECT t."PatientID", AVG(t."SeriesSizeMiB") AS "AverageSeriesSizeMiB"
FROM (
    SELECT "PatientID", "SeriesInstanceUID",
           SUM("instance_size") / (1024 * 1024) AS "SeriesSizeMiB"
    FROM "IDC"."IDC_V17"."DICOM_PIVOT"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
    GROUP BY "PatientID", "SeriesInstanceUID"
) t
WHERE t."PatientID" IN (SELECT "PatientID" FROM TopPatients)
GROUP BY t."PatientID"
Answer:
PatientID,AverageSeriesSizeMiB
212691,2.010678000000
109939,1.908028400000
109153,1.807914000000
Query:
-- Query 16: Get the number of series per patient
SELECT "PatientID", COUNT(DISTINCT "SeriesInstanceUID") AS "SeriesCount"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
GROUP BY "PatientID"
LIMIT 100
Answer:
PatientID,SeriesCount
117246,5
218197,4
216363,5
211908,6
207028,18
217345,6
205991,6
118912,3
203340,6
216769,5
214097,3
204917,3
106593,8
118077,6
122832,6
116037,12
210802,4
213627,4
134308,7
116358,6
213435,7
115118,6
210800,3
120537,6
210878,3
113038,5
118849,6
128405,6
126907,6
133676,5
216553,5
120493,11
126508,12
112189,2
207921,3
216594,5
114443,3
105820,6
200270,7
115418,8
111047,4
109943,6
212035,2
116846,7
120155,12
132278,8
124964,6
117207,4
133942,4
204637,9
114921,7
116688,13
117793,4
120685,13
120004,5
201600,9
106659,5
119903,6
118046,5
106130,3
214224,6
210789,9
133459,6
206122,9
217798,4
133373,3
116171,3
210651,6
128829,6
111014,7
103364,6
125461,4
215446,12
119468,2
209411,3
105922,6
131664,5
100658,4
124843,3
124715,5
103086,4
121719,7
204180,2
128294,6
105338,6
202648,6
113327,6
128163,3
103120,11
119802,8
202642,5
112482,3
100512,4
123320,7
121256,6
114662,6
131544,5
115841,4
106914,5
117696,12
Query:
-- Query 17: List Exposure values (as float) for CT images
SELECT "PatientID", TRY_CAST("Exposure" AS FLOAT) AS "Exposure"
FROM "IDC"."IDC_V17"."DICOM_ALL"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "Exposure" IS NOT NULL AND TRY_CAST("Exposure" AS FLOAT) IS NOT NULL
LIMIT 100
Answer:
PatientID,Exposure
121545,1260.0
107815,900.0
100037,1360.0
133235,960.0
104619,1050.0
209030,700.0
118516,1190.0
112776,1360.0
122857,1020.0
212460,1900.0
111862,1200.0
116181,900.0
113873,1200.0
132982,1470.0
210185,850.0
102826,1760.0
109398,1120.0
125808,1120.0
111945,1360.0
104129,850.0
130230,1440.0
116956,1050.0
121614,1200.0
208459,1500.0
120271,960.0
115225,800.0
209183,1700.0
131138,1050.0
109943,1440.0
122721,1020.0
109219,1140.0
133635,1200.0
212449,850.0
125368,1280.0
121214,1020.0
213866,1120.0
115770,1140.0
133438,1280.0
127633,1280.0
118973,1200.0
125149,1020.0
204839,1190.0
105066,1360.0
209085,850.0
116906,1360.0
106245,1080.0
207301,900.0
215115,900.0
133265,1360.0
121643,1360.0
110830,1020.0
218548,850.0
208036,750.0
213067,850.0
126134,1020.0
209813,850.0
216929,850.0
101373,1440.0
105260,1280.0
127577,1360.0
115806,1050.0
128660,1120.0
212483,800.0
106946,1280.0
131317,1120.0
204136,1330.0
111634,1120.0
100712,1120.0
125370,1360.0
200925,1050.0
203613,850.0
107668,1200.0
206087,900.0
211009,950.0
124450,780.0
123439,1500.0
209030,700.0
122642,1520.0
202222,850.0
112469,1280.0
130479,1200.0
211517,950.0
108395,1440.0
115936,80.0
108989,2000.0
110086,1710.0
209435,850.0
117367,1360.0
216250,800.0
202512,1700.0
108134,1440.0
208021,1330.0
127599,1440.0
131968,1200.0
204090,900.0
205014,1120.0
122632,1020.0
100813,1520.0
204548,850.0
200076,850.0
Query:
-- Query 18: List SliceThickness values (as float) for CT images
SELECT "PatientID", TRY_CAST("SliceThickness" AS FLOAT) AS "SliceThickness"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "SliceThickness" IS NOT NULL AND TRY_CAST("SliceThickness" AS FLOAT) IS NOT NULL
LIMIT 100
Answer:
PatientID,SliceThickness
205251,1.25
200810,1.25
215573,1.25
218618,1.25
204099,2.5
218618,2.5
217782,2.5
214067,1.25
200356,2.5
202775,1.25
205406,1.25
215186,1.25
202775,1.25
209631,1.25
202775,2.5
209631,2.5
216760,1.25
216760,2.5
211035,1.25
213245,1.25
213245,2.5
213245,2.5
202379,1.25
217562,1.25
202444,1.25
202444,2.5
200026,1.25
218467,1.25
215754,1.25
200392,2.5
200392,2.5
213311,2.5
210362,1.25
209737,1.25
209737,2.5
206622,1.25
202823,1.25
202823,1.25
202823,1.25
202823,1.25
217003,2.5
215967,2.5
215967,2.5
212732,1.25
212732,1.25
214226,1.25
214226,1.25
208169,1.25
214226,1.25
212662,1.25
212662,1.25
204638,1.25
201038,2.5
216424,2.5
215378,1.25
216962,1.25
218116,1.25
204631,1.25
206778,1.25
200740,1.25
217447,1.25
207363,1.25
204631,1.25
207632,1.25
200469,1.25
200469,1.25
203891,1.25
203891,1.25
207352,1.25
212114,1.25
206862,1.25
217604,1.25
216212,350.181824
208156,350.181824
206724,350.181824
207146,2.5
210528,10.0
206040,2.5
214952,2.5
204493,2.5
211086,2.5
200895,2.5
215784,2.5
217038,2.5
209767,2.5
209767,2.5
208980,2.5
208980,2.5
204993,2.5
204993,2.5
200298,2.5
212853,2.5
200656,2.5
218258,2.5
210517,2.5
206771,2.5
134199,2.5
105451,2.5
104445,2.5
128252,2.5
Query:
-- Query 19: Calculate average SliceThickness per series
SELECT "PatientID", "SeriesInstanceUID",
       AVG(TRY_CAST("SliceThickness" AS FLOAT)) AS "AvgSliceThickness"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
  AND "SliceThickness" IS NOT NULL AND TRY_CAST("SliceThickness" AS FLOAT) IS NOT NULL
GROUP BY "PatientID", "SeriesInstanceUID"
LIMIT 100
Answer:
Too long, hard cut:
PatientID,SeriesInstanceUID,AvgSliceThickness
201624,1.3.6.1.4.1.14519.5.2.1.7009.9004.872950544280486750164364222492,1.25
215294,1.3.6.1.4.1.14519.5.2.1.7009.9004.148996217492996027710406795964,1.25
218618,1.3.6.1.4.1.14519.5.2.1.7009.9004.128028015336285867103950085713,1.25
216581,1.3.6.1.4.1.14519.5.2.1.7009.9004.262426097308466281158875707087,8.0
114282,1.2.840.113654.2.55.17560461040854333561667957039414381749,2.5
105888,1.2.840.113654.2.55.241516360028450016141785435147776486277,2.5
207986,1.3.6.1.4.1.14519.5.2.1.7009.9004.336484125126141161263313049803,2.5
213311,1.3.6.1.4.1.14519.5.2.1.7009.9004.232103536767936541472215322514,2.5
204993,1.3.6.1.4.1.14519.5.2.1.7009.9004.215210098532561471587226848774,2.5
109550,1.2.840.113654.2.55.210368221908775074125212046342206118717,2.5
106354,1.2.840.113654.2.55.164120053300893326008778574902678325298,2.5
117163,1.2.840.113654.2.55.314538808778194111289143626244436294705,2.5
118424,1.2.840.113654.2.55.137820025635820668522795428103876669393,2.5
100849,1.2.840.113654.2.55.62517698801495864947396068783555419472,2.5
100985,1.2.840.113654.2.55.115379361403562413836974081585698733469,2.5
107232,1.2.840.113654.2.55.164439150633591405634966038690733081281,2.5
112945,1.2.840.113654.2.55.244160901200419701369313659477866332485,2.5
127858,1.2.840.113654.2.55.2979451774176230209030147822776258446,2.5
126928,1.2.840.113654.2.55.170922522888754100887405260838378168191,2.5
102102,1.2.840.113654.2.55.304485686743879874431061048557629280676,2.5
127938,1.2.840.113654.2.55.217732377532129327394517874717822184340,2.5
115388,1.2.840.113654.2.55.68839979435557396044792396490624478390,2.5
110849,1.2.840.113654.2.55.58902618525666276667193321422882611093,2.5
133780,1.2.840.113654.2.55.17393302237844930957004617322667037248,2.5
102525,1.2.840.113654.2.55.92281317175470358153339434661044409660,2.5
128844,1.2.840.113654.2.55.96222048191569460479923728002058381208,2.5
104166,1.2.840.113654.2.55.320676387020340071276620806555639149258,2.5
105438,1.2.840.113654.2.55.94325749271926026266603610362558445159,2.5
133157,1.2.840.113654.2.55.169666813924855096061062614037766819808,2.5
203152,1.3.6.1.4.1.14519.5.2.1.7009.9004.272979313968702004253925888126,2.5
212959,1.3.6.1.4.1.14519.5.2.1.7009.9004.138145380684928835602700805541,2.5
210143,1.3.6.1.4.1.14519.5.2.1.7009.9004.153626216127611087390637311170,2.5
118658,1.2.840.113654.2.55.158516527870983020948854432934661152686,2.5
127438,1.2.840.113654.2.55.24564153887935112344168423004104272502,2.5
112306,1.2.840.113654.2.55.280301093666335248852758368243139918745,2.5
132411,1.2.840.113654.2.55.107377563888297390993774648258524945286,2.5
132435,1.2.840.113654.2.55.144349371179813399726345144751834418667,2.5
121455,1.2.840.113654.2.55.165687000313861095782624872742991376992,2.5
133054,1.2.840.113654.2.55.87697866182233538079280208505712876749,2.5
100619,1.2.840.113654.2.55.66334213071113021727988667448950609147,2.5
119121,1.2.840.113654.2.55.256802285440352381262190782533389053249,2.5
120368,1.2.840.113654.2.55.6387274534890191804900590012251899042,2.5
124876,1.2.840.113654.2.55.18414394103476965190072207317747468570,2.5
113809,1.2.840.113654.2.55.311463558825839533513024152036866940966,2.5
112493,1.2.840.113654.2.55.189499765823498727892673052521689003350,2.5
125196,1.2.840.113654.2.55.166328916802974421568064200609150564728,2.5
119848,1.2.840.113654.2.55.260399906337798075822998531001095530523,410.181763
208887,1.3.6.1.4.1.14519.5.2.1.7009.9004.309928411295881565737818251629,2.5
124040,1.2.840.113654.2.55.221243239825254956683072873321692020191,2.5
131655,1.2.840.113654.2.55.279389246308829842705952482094121697603,2.5
206040,1.3.6.1.4.1.14519.5.2.1.7009.9004.230200647439277528585311506482,2.5
112393,1.2.840.113654.2.55.38503585584016580394507294669872309026,2.5
129855,1.2.840.113654.2.55.16311585226762540889737265027484095881,2.5
107075,1.2.840.113654.2.55.154249135141325908368553390627954945523,2.5
211210,1.3.6.1.4.1.14519.5.2.1.7009.9004.116386182560203108934842856639,1.25
218104,1.3.6.1.4.1.14519.5.2.1.7009.9004.160693177773959190679764150816,2.5
215183,1.3.6.1.4.1.14519.5.2.1.7009.9004.242512714639181063302679758993,2.5
200603,1.3.6.1.4.1.14519.5.2.1.7009.9004.133882312364950910761160323576,2.5
210024,1.3.6.1.4.1.14519.5.2.1.7009.9004.281921661738859751279886424742,1.25
206813,1.3.6.1.4.1.14519.5.2.1.7009.9004.175980167354564200724208099294,1.25
214635,1.3.6.1.4.1.14519.5.2.1.7009.9004.256417160893802490084870211608,1.25
218140,1.3.6.1.4.1.14519.5.2.1.7009.9004.258923181250292198207926792326,2.5
205870,1.3.6.1.4.1.14519.5.2.1.7009.9004.271542556486024060449508609669,1.25
100275,1.2.840.113654.2.55.303926167711378654478734754069371933834,2.5
101636,1.2.840.113654.2.55.274154068365140414724763120912714678714,2.5
107084,1.2.840.113654.2.55.86206168641018044803658998263032770295,2.5
101721,1.2.840.113654.2.55.150534496050157748137903377527558408117,2.5
125119,1.2.840.113654.2.55.11633115193927511333796499037562053925,2.5
105326,1.2.840.113654.2.55
Query:
-- Query 20: Retrieve instance sizes and modalities
SELECT "PatientID", "Modality", "instance_size"
FROM "IDC"."IDC_V17"."DICOM_PIVOT"
WHERE "collection_id" = 'nlst'
LIMIT 100
Answer:
PatientID,Modality,instance_size
126277,SM,1657142
111859,SM,2339196
108625,SM,139460984
120907,SM,705382846
120316,SM,139450954
126520,SM,2137512
132422,SM,2628668
111833,SM,66872690
130630,SM,9581864
111355,SM,100506126
120410,SM,2481982
126657,SM,1945458
131174,SM,1945468
112326,SM,464844348
134354,SM,9029460
100703,SR,21914
117966,SR,25674
105713,SR,18132
105012,SR,23172
202665,SR,168440
132313,SR,139552
129534,SR,162896
134408,SR,159356
214700,SEG,15765146
107682,SEG,11742172
210581,SEG,10943574
105974,SEG,9245572
102736,SEG,9278596
106553,SEG,10475656
133301,SEG,9646190
206866,CT,526998
218802,CT,526728
218802,CT,526728
205332,CT,526980
205332,CT,526978
207779,CT,526718
207779,CT,526984
207779,CT,526980
204432,CT,526990
211177,CT,526996
210993,CT,526704
211178,CT,526822
203414,CT,526820
203414,CT,526822
216275,CT,526812
216275,CT,526812
205463,CT,526822
218028,CT,526688
218072,CT,526852
217572,CT,526852
215733,CT,526708
211920,CT,526708
203941,CT,526708
213815,CT,526704
202441,CT,526818
201021,CT,526704
201021,CT,526702
217730,CT,526708
213865,CT,526822
210021,CT,526706
206987,CT,526812
201506,CT,526690
201506,CT,526690
204969,CT,526696
213651,CT,526706
201552,CT,526706
206954,CT,526822
201664,CT,526842
217951,CT,526690
204879,CT,526814
215000,CT,526690
215736,CT,526704
206145,CT,526688
206145,CT,526684
214598,CT,526704
212304,CT,526706
212304,CT,526706
200887,CT,526702
207562,CT,526708
218660,CT,526816
218660,CT,526816
217130,CT,526816
217130,CT,526820
206974,CT,526702
216611,CT,526706
216611,CT,526702
201151,CT,526802
210894,CT,526688
205614,CT,526814
205540,CT,526702
212363,CT,526704
205008,CT,526822
207737,CT,526684
207737,CT,526686
214959,CT,526704
202841,CT,526702
202841,CT,526704
213144,CT,526700
203921,CT,526692
215053,CT,526700
End Exploring Related Columns
Task: What are the average series sizes in MiB for the top 3 patients with the highest slice interval difference tolerance and the top 3 patients with the highest maximum exposure difference, considering only CT images from the 'nlst' collection?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To find the average series sizes in MiB for the specified patients, we performed the following steps:

1. **Filtered CT images from the 'nlst' collection**: Selected only the CT modality records from the 'nlst' collection.

2. **Calculated slice thickness difference per patient**:
   - For each patient, computed the maximum and minimum `SliceThickness` values.
   - Calculated the difference (max - min) to find the slice interval difference tolerance.

3. **Calculated exposure difference per patient**:
   - For each patient, extracted `Exposure` values and converted them to numeric values.
   - Computed the difference between the maximum and minimum exposures.

4. **Identified top 3 patients in each category**:
   - Selected the top 3 patients with the highest slice thickness difference.
   - Selected the top 3 patients with the highest exposure difference.

5. **Computed average series sizes**:
   - For each patient's series, summed the `instance_size` values to get the total series size.
   - Converted the series sizes to MiB (by dividing by 1024 * 1024).
   - Calculated the average series size per patient.

**Average Series Sizes for Top 3 Patients with Highest Slice Thickness Difference**:

```csv
PatientID,Average_Series_Size_MiB
patient1_id:str,avg_series_size1:float
patient2_id:str,avg_series_size2:float
patient3_id:str,avg_series_size3:float
(Attention: answer in three rows)
```

**Average Series Sizes for Top 3 Patients with Highest Exposure Difference**:

```csv
PatientID,Average_Series_Size_MiB
patient4_id:str,avg_series_size4:float
patient5_id:str,avg_series_size5:float
patient6_id:str,avg_series_size6:float
(Attention: answer in three rows)
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'IDC': {'IDC_V17': ['ANALYSIS_RESULTS_METADATA', 'AUXILIARY_METADATA', 'DICOM_ALL', 'DICOM_METADATA', 'DICOM_METADATA_CURATED', 'DICOM_METADATA_CURATED_SERIES_LEVEL', 'DICOM_PIVOT', 'MEASUREMENT_GROUPS', 'MUTABLE_METADATA', 'ORIGINAL_COLLECTIONS_METADATA', 'QUALITATIVE_MEASUREMENTS', 'QUANTITATIVE_MEASUREMENTS', 'SEGMENTATIONS', 'TCGA_BIOSPECIMEN_REL9', 'TCGA_CLINICAL_REL9', 'VERSION_METADATA']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-23 14:09:57 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 14:09:57 - root - INFO - ```sql
WITH
-- Filter CT images from the 'nlst' collection in DICOM_PIVOT table
CT_PIVOT AS (
    SELECT *
    FROM "IDC"."IDC_V17"."DICOM_PIVOT"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
),
-- Compute slice thickness difference per patient
SliceThicknessDiff AS (
    SELECT "PatientID",
           MAX(TRY_CAST("SliceThickness" AS FLOAT)) - MIN(TRY_CAST("SliceThickness" AS FLOAT)) AS "SliceThicknessDifference"
    FROM CT_PIVOT
    WHERE "SliceThickness" IS NOT NULL AND TRY_CAST("SliceThickness" AS FLOAT) IS NOT NULL
    GROUP BY "PatientID"
),
-- Get top 3 patients with highest slice thickness difference
Top3SlicePatients AS (
    SELECT "PatientID"
    FROM SliceThicknessDiff
    ORDER BY "SliceThicknessDifference" DESC NULLS LAST
    LIMIT 3
),
-- Filter CT images from the 'nlst' collection in DICOM_ALL table for Exposure
CT_ALL AS (
    SELECT *
    FROM "IDC"."IDC_V17"."DICOM_ALL"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
),
-- Compute exposure difference per patient
ExposureDiff AS (
    SELECT "PatientID",
           MAX(TRY_CAST("Exposure" AS FLOAT)) - MIN(TRY_CAST("Exposure" AS FLOAT)) AS "ExposureDifference"
    FROM CT_ALL
    WHERE "Exposure" IS NOT NULL AND TRY_CAST("Exposure" AS FLOAT) IS NOT NULL
    GROUP BY "PatientID"
),
-- Get top 3 patients with highest exposure difference
Top3ExposurePatients AS (
    SELECT "PatientID"
    FROM ExposureDiff
    ORDER BY "ExposureDifference" DESC NULLS LAST
    LIMIT 3
),
-- Combine top patients
TopPatients AS (
    SELECT "PatientID", 'SliceThicknessDifference' AS "Category" FROM Top3SlicePatients
    UNION ALL
    SELECT "PatientID", 'ExposureDifference' AS "Category" FROM Top3ExposurePatients
),
-- Compute series sizes
SeriesSizes AS (
    SELECT "PatientID", "SeriesInstanceUID", SUM("instance_size") / (1024 * 1024) AS "SeriesSizeMiB"
    FROM CT_PIVOT
    WHERE "PatientID" IN (SELECT "PatientID" FROM TopPatients)
    GROUP BY "PatientID", "SeriesInstanceUID"
),
-- Compute average series size per patient
AverageSeriesSize AS (
    SELECT "PatientID", AVG("SeriesSizeMiB") AS "Average_Series_Size_MiB"
    FROM SeriesSizes
    GROUP BY "PatientID"
)
-- Final output with categories
SELECT tp."Category", ass."PatientID", ass."Average_Series_Size_MiB"
FROM TopPatients tp
JOIN AverageSeriesSize ass ON tp."PatientID" = ass."PatientID"
ORDER BY tp."Category", ass."Average_Series_Size_MiB" DESC;
```
2025-01-23 14:09:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:09:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:09:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:09:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-23 14:09:59 - snowflake.connector.connection - INFO - closed
2025-01-23 14:09:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:09:59 - root - INFO - itercount: 1
2025-01-23 14:09:59 - root - INFO - 0
2025-01-23 14:09:59 - root - INFO - results: 
Category,PatientID,Average_Series_Size_MiB
ExposureDifference,212691,2.010678000000
ExposureDifference,109939,1.908028400000
ExposureDifference,109153,1.807914000000
SliceThicknessDifference,108650,2.132376571429
SliceThicknessDifference,110260,2.020975000000
SliceThicknessDifference,132882,1.770029250000


2025-01-23 14:09:59 - root - INFO - Please check the answer again by reviewing What are the average series sizes in MiB for the top 3 patients with the highest slice interval difference tolerance and the top 3 patients with the highest maximum exposure difference, considering only CT images from the 'nlst' collection?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To find the average series sizes in MiB for the specified patients, we performed the following steps:

1. **Filtered CT images from the 'nlst' collection**: Selected only the CT modality records from the 'nlst' collection.

2. **Calculated slice thickness difference per patient**:
   - For each patient, computed the maximum and minimum `SliceThickness` values.
   - Calculated the difference (max - min) to find the slice interval difference tolerance.

3. **Calculated exposure difference per patient**:
   - For each patient, extracted `Exposure` values and converted them to numeric values.
   - Computed the difference between the maximum and minimum exposures.

4. **Identified top 3 patients in each category**:
   - Selected the top 3 patients with the highest slice thickness difference.
   - Selected the top 3 patients with the highest exposure difference.

5. **Computed average series sizes**:
   - For each patient's series, summed the `instance_size` values to get the total series size.
   - Converted the series sizes to MiB (by dividing by 1024 * 1024).
   - Calculated the average series size per patient.

**Average Series Sizes for Top 3 Patients with Highest Slice Thickness Difference**:

```csv
PatientID,Average_Series_Size_MiB
patient1_id:str,avg_series_size1:float
patient2_id:str,avg_series_size2:float
patient3_id:str,avg_series_size3:float
(Attention: answer in three rows)
```

**Average Series Sizes for Top 3 Patients with Highest Exposure Difference**:

```csv
PatientID,Average_Series_Size_MiB
patient4_id:str,avg_series_size4:float
patient5_id:str,avg_series_size5:float
patient6_id:str,avg_series_size6:float
(Attention: answer in three rows)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Category,PatientID,Average_Series_Size_MiB
ExposureDifference,212691,2.010678000000
ExposureDifference,109939,1.908028400000
ExposureDifference,109153,1.807914000000
SliceThicknessDifference,108650,2.132376571429
SliceThicknessDifference,110260,2.020975000000
SliceThicknessDifference,132882,1.770029250000
Current sql:
WITH
-- Filter CT images from the 'nlst' collection in DICOM_PIVOT table
CT_PIVOT AS (
    SELECT *
    FROM "IDC"."IDC_V17"."DICOM_PIVOT"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
),
-- Compute slice thickness difference per patient
SliceThicknessDiff AS (
    SELECT "PatientID",
           MAX(TRY_CAST("SliceThickness" AS FLOAT)) - MIN(TRY_CAST("SliceThickness" AS FLOAT)) AS "SliceThicknessDifference"
    FROM CT_PIVOT
    WHERE "SliceThickness" IS NOT NULL AND TRY_CAST("SliceThickness" AS FLOAT) IS NOT NULL
    GROUP BY "PatientID"
),
-- Get top 3 patients with highest slice thickness difference
Top3SlicePatients AS (
    SELECT "PatientID"
    FROM SliceThicknessDiff
    ORDER BY "SliceThicknessDifference" DESC NULLS LAST
    LIMIT 3
),
-- Filter CT images from the 'nlst' collection in DICOM_ALL table for Exposure
CT_ALL AS (
    SELECT *
    FROM "IDC"."IDC_V17"."DICOM_ALL"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
),
-- Compute exposure difference per patient
ExposureDiff AS (
    SELECT "PatientID",
           MAX(TRY_CAST("Exposure" AS FLOAT)) - MIN(TRY_CAST("Exposure" AS FLOAT)) AS "ExposureDifference"
    FROM CT_ALL
    WHERE "Exposure" IS NOT NULL AND TRY_CAST("Exposure" AS FLOAT) IS NOT NULL
    GROUP BY "PatientID"
),
-- Get top 3 patients with highest exposure difference
Top3ExposurePatients AS (
    SELECT "PatientID"
    FROM ExposureDiff
    ORDER BY "ExposureDifference" DESC NULLS LAST
    LIMIT 3
),
-- Combine top patients
TopPatients AS (
    SELECT "PatientID", 'SliceThicknessDifference' AS "Category" FROM Top3SlicePatients
    UNION ALL
    SELECT "PatientID", 'ExposureDifference' AS "Category" FROM Top3ExposurePatients
),
-- Compute series sizes
SeriesSizes AS (
    SELECT "PatientID", "SeriesInstanceUID", SUM("instance_size") / (1024 * 1024) AS "SeriesSizeMiB"
    FROM CT_PIVOT
    WHERE "PatientID" IN (SELECT "PatientID" FROM TopPatients)
    GROUP BY "PatientID", "SeriesInstanceUID"
),
-- Compute average series size per patient
AverageSeriesSize AS (
    SELECT "PatientID", AVG("SeriesSizeMiB") AS "Average_Series_Size_MiB"
    FROM SeriesSizes
    GROUP BY "PatientID"
)
-- Final output with categories
SELECT tp."Category", ass."PatientID", ass."Average_Series_Size_MiB"
FROM TopPatients tp
JOIN AverageSeriesSize ass ON tp."PatientID" = ass."PatientID"
ORDER BY tp."Category", ass."Average_Series_Size_MiB" DESC;
2025-01-23 14:10:50 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 14:10:50 - root - INFO - To find the average series sizes in MiB for the specified patients, we performed the following steps:

1. **Filtered CT images from the 'nlst' collection**: Selected only the CT modality records from the 'nlst' collection.

2. **Calculated slice thickness difference per patient**:
   - For each patient, computed the maximum and minimum `SliceThickness` values.
   - Calculated the difference (max - min) to find the slice interval difference tolerance.

3. **Calculated exposure difference per patient**:
   - For each patient, extracted `Exposure` values and converted them to numeric values.
   - Computed the difference between the maximum and minimum exposures.

4. **Identified top 3 patients in each category**:
   - Selected the top 3 patients with the highest slice thickness difference.
   - Selected the top 3 patients with the highest exposure difference.

5. **Computed average series sizes**:
   - For each patient's series, summed the `instance_size` values to get the total series size.
   - Converted the series sizes to MiB (by dividing by 1024 * 1024).
   - Calculated the average series size per patient, rounded to four decimal places.

**Average Series Sizes for Top 3 Patients with Highest Slice Thickness Difference**:

```csv
PatientID,Average_Series_Size_MiB
110260,2.0210
132882,1.7700
112625,1.3776
```
(Attention: answer in three rows)

**Average Series Sizes for Top 3 Patients with Highest Exposure Difference**:

```csv
PatientID,Average_Series_Size_MiB
212691,2.0107
109939,1.9080
109153,1.8079
```
(Attention: answer in three rows)

```sql
WITH
-- Filter CT images from the 'nlst' collection in DICOM_PIVOT table
CT_PIVOT AS (
    SELECT *
    FROM "IDC"."IDC_V17"."DICOM_PIVOT"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
),
-- Compute slice thickness difference per patient
SliceThicknessDiff AS (
    SELECT "PatientID",
           MAX(TRY_CAST("SliceThickness" AS FLOAT)) - MIN(TRY_CAST("SliceThickness" AS FLOAT)) AS "SliceThicknessDifference"
    FROM CT_PIVOT
    WHERE "SliceThickness" IS NOT NULL AND TRY_CAST("SliceThickness" AS FLOAT) IS NOT NULL
    GROUP BY "PatientID"
),
-- Get top 3 patients with highest slice thickness difference
Top3SlicePatients AS (
    SELECT "PatientID"
    FROM SliceThicknessDiff
    ORDER BY "SliceThicknessDifference" DESC NULLS LAST
    LIMIT 3
),
-- Filter CT images from the 'nlst' collection in DICOM_ALL table for Exposure
CT_ALL AS (
    SELECT *
    FROM "IDC"."IDC_V17"."DICOM_ALL"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
),
-- Compute exposure difference per patient
ExposureDiff AS (
    SELECT "PatientID",
           MAX(TRY_CAST("Exposure" AS FLOAT)) - MIN(TRY_CAST("Exposure" AS FLOAT)) AS "ExposureDifference"
    FROM CT_ALL
    WHERE "Exposure" IS NOT NULL AND TRY_CAST("Exposure" AS FLOAT) IS NOT NULL
    GROUP BY "PatientID"
),
-- Get top 3 patients with highest exposure difference
Top3ExposurePatients AS (
    SELECT "PatientID"
    FROM ExposureDiff
    ORDER BY "ExposureDifference" DESC NULLS LAST
    LIMIT 3
),
-- Combine top patients
TopPatients AS (
    SELECT "PatientID", 'SliceThicknessDifference' AS "Category" FROM Top3SlicePatients
    UNION ALL
    SELECT "PatientID", 'ExposureDifference' AS "Category" FROM Top3ExposurePatients
),
-- Compute series sizes
SeriesSizes AS (
    SELECT "PatientID", "SeriesInstanceUID", SUM("instance_size") / (1024 * 1024) AS "SeriesSizeMiB"
    FROM CT_PIVOT
    WHERE "PatientID" IN (SELECT "PatientID" FROM TopPatients)
    GROUP BY "PatientID", "SeriesInstanceUID"
),
-- Compute average series size per patient
AverageSeriesSize AS (
    SELECT "PatientID", ROUND(AVG("SeriesSizeMiB"), 4) AS "Average_Series_Size_MiB"
    FROM SeriesSizes
    GROUP BY "PatientID"
)
-- Final output with categories
SELECT tp."Category", ass."PatientID", ass."Average_Series_Size_MiB"
FROM TopPatients tp
JOIN AverageSeriesSize ass ON tp."PatientID" = ass."PatientID"
ORDER BY tp."Category", ass."Average_Series_Size_MiB" DESC;
```
2025-01-23 14:10:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:10:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:10:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:10:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-23 14:10:52 - snowflake.connector.connection - INFO - closed
2025-01-23 14:10:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:10:52 - root - INFO - itercount: 2
2025-01-23 14:10:52 - root - INFO - 0
2025-01-23 14:10:52 - root - INFO - results: 
Category,PatientID,Average_Series_Size_MiB
ExposureDifference,212691,2.0107
ExposureDifference,109939,1.9080
ExposureDifference,109153,1.8079
SliceThicknessDifference,110260,2.0210
SliceThicknessDifference,132882,1.7700
SliceThicknessDifference,112625,1.3776


2025-01-23 14:10:52 - root - INFO - Please check the answer again by reviewing What are the average series sizes in MiB for the top 3 patients with the highest slice interval difference tolerance and the top 3 patients with the highest maximum exposure difference, considering only CT images from the 'nlst' collection?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To find the average series sizes in MiB for the specified patients, we performed the following steps:

1. **Filtered CT images from the 'nlst' collection**: Selected only the CT modality records from the 'nlst' collection.

2. **Calculated slice thickness difference per patient**:
   - For each patient, computed the maximum and minimum `SliceThickness` values.
   - Calculated the difference (max - min) to find the slice interval difference tolerance.

3. **Calculated exposure difference per patient**:
   - For each patient, extracted `Exposure` values and converted them to numeric values.
   - Computed the difference between the maximum and minimum exposures.

4. **Identified top 3 patients in each category**:
   - Selected the top 3 patients with the highest slice thickness difference.
   - Selected the top 3 patients with the highest exposure difference.

5. **Computed average series sizes**:
   - For each patient's series, summed the `instance_size` values to get the total series size.
   - Converted the series sizes to MiB (by dividing by 1024 * 1024).
   - Calculated the average series size per patient.

**Average Series Sizes for Top 3 Patients with Highest Slice Thickness Difference**:

```csv
PatientID,Average_Series_Size_MiB
patient1_id:str,avg_series_size1:float
patient2_id:str,avg_series_size2:float
patient3_id:str,avg_series_size3:float
(Attention: answer in three rows)
```

**Average Series Sizes for Top 3 Patients with Highest Exposure Difference**:

```csv
PatientID,Average_Series_Size_MiB
patient4_id:str,avg_series_size4:float
patient5_id:str,avg_series_size5:float
patient6_id:str,avg_series_size6:float
(Attention: answer in three rows)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Category,PatientID,Average_Series_Size_MiB
ExposureDifference,212691,2.0107
ExposureDifference,109939,1.9080
ExposureDifference,109153,1.8079
SliceThicknessDifference,110260,2.0210
SliceThicknessDifference,132882,1.7700
SliceThicknessDifference,112625,1.3776
Current sql:
WITH
-- Filter CT images from the 'nlst' collection in DICOM_PIVOT table
CT_PIVOT AS (
    SELECT *
    FROM "IDC"."IDC_V17"."DICOM_PIVOT"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
),
-- Compute slice thickness difference per patient
SliceThicknessDiff AS (
    SELECT "PatientID",
           MAX(TRY_CAST("SliceThickness" AS FLOAT)) - MIN(TRY_CAST("SliceThickness" AS FLOAT)) AS "SliceThicknessDifference"
    FROM CT_PIVOT
    WHERE "SliceThickness" IS NOT NULL AND TRY_CAST("SliceThickness" AS FLOAT) IS NOT NULL
    GROUP BY "PatientID"
),
-- Get top 3 patients with highest slice thickness difference
Top3SlicePatients AS (
    SELECT "PatientID"
    FROM SliceThicknessDiff
    ORDER BY "SliceThicknessDifference" DESC NULLS LAST
    LIMIT 3
),
-- Filter CT images from the 'nlst' collection in DICOM_ALL table for Exposure
CT_ALL AS (
    SELECT *
    FROM "IDC"."IDC_V17"."DICOM_ALL"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
),
-- Compute exposure difference per patient
ExposureDiff AS (
    SELECT "PatientID",
           MAX(TRY_CAST("Exposure" AS FLOAT)) - MIN(TRY_CAST("Exposure" AS FLOAT)) AS "ExposureDifference"
    FROM CT_ALL
    WHERE "Exposure" IS NOT NULL AND TRY_CAST("Exposure" AS FLOAT) IS NOT NULL
    GROUP BY "PatientID"
),
-- Get top 3 patients with highest exposure difference
Top3ExposurePatients AS (
    SELECT "PatientID"
    FROM ExposureDiff
    ORDER BY "ExposureDifference" DESC NULLS LAST
    LIMIT 3
),
-- Combine top patients
TopPatients AS (
    SELECT "PatientID", 'SliceThicknessDifference' AS "Category" FROM Top3SlicePatients
    UNION ALL
    SELECT "PatientID", 'ExposureDifference' AS "Category" FROM Top3ExposurePatients
),
-- Compute series sizes
SeriesSizes AS (
    SELECT "PatientID", "SeriesInstanceUID", SUM("instance_size") / (1024 * 1024) AS "SeriesSizeMiB"
    FROM CT_PIVOT
    WHERE "PatientID" IN (SELECT "PatientID" FROM TopPatients)
    GROUP BY "PatientID", "SeriesInstanceUID"
),
-- Compute average series size per patient
AverageSeriesSize AS (
    SELECT "PatientID", ROUND(AVG("SeriesSizeMiB"), 4) AS "Average_Series_Size_MiB"
    FROM SeriesSizes
    GROUP BY "PatientID"
)
-- Final output with categories
SELECT tp."Category", ass."PatientID", ass."Average_Series_Size_MiB"
FROM TopPatients tp
JOIN AverageSeriesSize ass ON tp."PatientID" = ass."PatientID"
ORDER BY tp."Category", ass."Average_Series_Size_MiB" DESC;
2025-01-23 14:11:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 14:11:25 - root - INFO - ```sql
WITH
-- Filter CT images from the 'nlst' collection in DICOM_PIVOT table
CT_PIVOT AS (
    SELECT *
    FROM "IDC"."IDC_V17"."DICOM_PIVOT"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
),
-- Compute slice thickness difference per patient
SliceThicknessDiff AS (
    SELECT "PatientID",
           MAX(TRY_CAST("SliceThickness" AS FLOAT)) - MIN(TRY_CAST("SliceThickness" AS FLOAT)) AS "SliceThicknessDifference"
    FROM CT_PIVOT
    WHERE "SliceThickness" IS NOT NULL AND TRY_CAST("SliceThickness" AS FLOAT) IS NOT NULL
    GROUP BY "PatientID"
),
-- Get top 3 patients with highest slice thickness difference
Top3SlicePatients AS (
    SELECT "PatientID"
    FROM SliceThicknessDiff
    ORDER BY "SliceThicknessDifference" DESC NULLS LAST
    LIMIT 3
),
-- Filter CT images from the 'nlst' collection in DICOM_ALL table for Exposure
CT_ALL AS (
    SELECT *
    FROM "IDC"."IDC_V17"."DICOM_ALL"
    WHERE "Modality" = 'CT' AND "collection_id" = 'nlst'
),
-- Compute exposure difference per patient
ExposureDiff AS (
    SELECT "PatientID",
           MAX(TRY_CAST("Exposure" AS FLOAT)) - MIN(TRY_CAST("Exposure" AS FLOAT)) AS "ExposureDifference"
    FROM CT_ALL
    WHERE "Exposure" IS NOT NULL AND TRY_CAST("Exposure" AS FLOAT) IS NOT NULL
    GROUP BY "PatientID"
),
-- Get top 3 patients with highest exposure difference
Top3ExposurePatients AS (
    SELECT "PatientID"
    FROM ExposureDiff
    ORDER BY "ExposureDifference" DESC NULLS LAST
    LIMIT 3
),
-- Combine top patients
TopPatients AS (
    SELECT "PatientID", 'SliceThicknessDifference' AS "Category" FROM Top3SlicePatients
    UNION ALL
    SELECT "PatientID", 'ExposureDifference' AS "Category" FROM Top3ExposurePatients
),
-- Compute series sizes
SeriesSizes AS (
    SELECT "PatientID", "SeriesInstanceUID", SUM("instance_size") / (1024 * 1024) AS "SeriesSizeMiB"
    FROM CT_PIVOT
    WHERE "PatientID" IN (SELECT "PatientID" FROM TopPatients)
    GROUP BY "PatientID", "SeriesInstanceUID"
),
-- Compute average series size per patient
AverageSeriesSize AS (
    SELECT "PatientID", ROUND(AVG("SeriesSizeMiB"), 4) AS "Average_Series_Size_MiB"
    FROM SeriesSizes
    GROUP BY "PatientID"
)
-- Final output with categories
SELECT tp."Category", ass."PatientID", ass."Average_Series_Size_MiB"
FROM TopPatients tp
JOIN AverageSeriesSize ass ON tp."PatientID" = ass."PatientID"
ORDER BY tp."Category", ass."Average_Series_Size_MiB" DESC;
```
2025-01-23 14:11:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 14:11:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 14:11:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 14:11:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-23 14:11:27 - snowflake.connector.connection - INFO - closed
2025-01-23 14:11:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 14:11:27 - root - INFO - itercount: 3
2025-01-23 14:11:27 - root - INFO - 0
2025-01-23 14:11:27 - root - INFO - Total iteration counts: 3
