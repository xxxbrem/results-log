2025-01-23 06:42:54 - openai._base_client - INFO - Retrying request to /chat/completions in 0.388318 seconds
2025-01-23 06:43:55 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 06:43:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:43:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:43:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:43:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 32
2025-01-23 06:43:56 - snowflake.connector.connection - INFO - closed
2025-01-23 06:43:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:43:56 - root - INFO - SQL:
SELECT DISTINCT "event_name"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   LIMIT 100;
Results:
event_name
level_complete_quickplay
session_start
screen_view
level_fail_quickplay
level_end_quickplay
post_score
level_start_quickplay
user_engagement
level_up
level_complete
select_content
level_fail
level_end
level_start
level_retry
completed_5_levels
no_more_extra_steps
level_retry_quickplay
level_reset
level_reset_quickplay
app_exception
os_update
app_remove
app_clear_data
app_update
firebase_campaign
error
ad_reward
use_extra_steps
spend_virtual_currency
challenge_a_friend
first_open

2025-01-23 06:43:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:43:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:43:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:43:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-23 06:43:58 - snowflake.connector.connection - INFO - closed
2025-01-23 06:43:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:44:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 06:44:17 - root - INFO - ```sql
SELECT "event_date", "event_name", "user_pseudo_id"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
WHERE "event_name" LIKE '%quickplay%'
LIMIT 100;
```
2025-01-23 06:44:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:44:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:44:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:44:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 06:44:19 - snowflake.connector.connection - INFO - closed
2025-01-23 06:44:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:45:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 06:45:02 - root - INFO - SQL:
SELECT "event_date", "event_name", "user_pseudo_id"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
WHERE "event_name" LIKE '%quickplay%'
LIMIT 100;
Results:
Too long, hard cut:
event_date,event_name,user_pseudo_id
20180702,level_complete_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_complete_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_complete_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_fail_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_fail_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_fail_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_fail_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_fail_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_fail_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_fail_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_fail_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_fail_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_fail_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_fail_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,65D7715C409E6A38667447CE2B52AFFE
20180702,level_start_quickplay,B205B117C82A24AA95E663FFB7D04718
20180702,level_start_quickplay,EF9E8CCCCBBB015CAE0C334AB1745417
20180702,level_start_quickplay,83D8C7F90DAF2C832F05A9DDD8693135
20180702,level_complete_quickplay,0F67E233B19D2898229CD156974A93AE
20180702,level_start_quickplay,0F67E233B19D2898229CD156974A93AE
20180702,level_end_quickplay,0F67E233B19D2898229CD156974A93AE
20180702,level_complete_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_complete_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_complete_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_complete_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_complete_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_complete_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_complete_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_fail_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_end_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_fail_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_end_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_fail_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_end_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_end_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_start_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_start_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_end_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_start_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_end_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_start_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_fail_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_end_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_start_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_end_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_start_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_start_quickplay,5217AB1A454DAED6243E1C9818BE6A20

2025-01-23 06:45:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:45:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:45:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:45:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-23 06:45:04 - snowflake.connector.connection - INFO - closed
2025-01-23 06:45:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:45:05 - root - INFO - SQL:
SELECT "event_date", COUNT(*) AS "quickplay_event_count"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180704"
   WHERE "event_name" LIKE '%quickplay%'
   GROUP BY "event_date"
   LIMIT 100
Results:
event_date,quickplay_event_count
20180704,11747

2025-01-23 06:45:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:45:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:45:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:45:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 06:45:06 - snowflake.connector.connection - INFO - closed
2025-01-23 06:45:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:45:07 - root - INFO - SQL:
SELECT DISTINCT "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180705"
   WHERE "event_name" LIKE '%quickplay%'
   LIMIT 100
Results:
user_pseudo_id
654F30C1312F6C1A26DFDA9F076A62D8
3A0C188E07D23B3FA107E338476821D8
0F67E233B19D2898229CD156974A93AE
5217AB1A454DAED6243E1C9818BE6A20
16DB8E847B4DDC16F3F250637F2D8C89
2A79E63E7E0E7F4F2CFCAFCB449CE389
224C6AE85D60A605AC6164FA86738DF6
15955C2770D8FE60B329BCD0805BB35E
10DD4C2B3060AB868E928AA66B81E459
3BDA016D41EB1108EFF393D77AFA3348
08D399C66188D9A356AFAD5E2B2BA45E
9DE7361ACCDEA6541AD5EA55D59B1C78
4A47A98F4565C38DBABBE20B803D7FFB
0155220BAB309646CC7AC980AB75A212
706C748E6D1E0768BFEFE6362B5D3F67
E6FEE8B98E75EA5311FE004F98559A27
6CD2676098B3E076AD66D10BF4565BFA
346CA8A816ECDF5226D821892E18B502
DEAFC2BFCF3A46C685EF4CE67F8A1248
22DC6A6AE86C0AA33EBB8C3164A26925
570495249052C5E40EC34A2B054DA1A1
1406751556EEDB1D112BF86CACAE9C88
41CA0FA528C7227EA1E592DCC4733C40
B56E67847E1AE8D6411A5ECCA26585CA
A064A84CD3CF7058F39333D6212E8615
E5AFF3DE508996512D61B49A63D1D063
22430BD1EDFC8E2E980313F10148A53E
7566596A1D6ACA781692A7A0B89B06EF
7842C62D45ECE888132F21C9F4417B21
2C0308CAAC49EAE73174F5110D76F2C6
B35B079A68D98EDEBA184E73C2F6FB51
3DEB0C12C49AD19D7ACE68FA59E7ACD6
E2372AFD5CBA85F1395201FB687AEC46
D8A4973047AF2FA8E9061F6F52E6BD61
757F371D73A59AA7B6FB5CF1E6483B33
D5F9D9AF22EF5073E10342973D48FB2C
B71CB5D517BE99FEEED64A0F57842032
3109942E3428ED1CC49E093965E1748C
27954A1D70BCD7F326F926A5D5B666E6
EBFE0623EF1109A89B392B9DF4375951
CA04708DA02378999ECB402481FF1AE4
6D8B6C8E0800777A88BA604FA3435B16
2D4660CA182ACFAB37A5CDC0D78C4C37
D7EA8E3645EFFBD6443946179ED704A6
3D03A380687FE3369E93915D50C572CB
05FB3382D94C7E963B408FD6CC357D33
2D9E81829DC070224ABDE3EAA0F34C2E
B75FCD833DE643B45B326D2E7AC413E4
ADDE80C89BB3F6190538E50E541BACD5
E512079B53179DF9A608CF4ADE47DE9D
B5D8ACA33A57FF52CFC01C59EBD0E9EC
03A9D32C44665A9E15CFCCEDC9F68EDB
77F5E9A5630151C9E831156AEAB4DA11
0446949CDEB27AEA0A1151792973D6FB
48AB910A8DE8485D4C34238EA61F782C
5145D8121071A9EA903A1098034962F6
F94E005EB49AFB8DA0A78030D4ABB44B
0A7D79D18034304FAF741FB55EA85073
C77E351A1740BEE7A57B58DC5003A54D
1B2FC37816CC4DDAACA97A75E685756F
2741C47CC50AE98B39CC5B561BFEA504
59BE43F3FE7AB3F91B016B56508D4C46
A65FAEAB5577A16B517735A9D9C54958
537B074515EB8F5DDF89269910D94309
B75F91EB6C7FDA9A329567E763CF9E44
7480AE90D76538F44A066A153F448198
369C245CB9986DCBF1A7F0965D5303CE
FFA9AE78B23263835F8AAED57713EBE9
E4196C5E0A92A22F69DE4E3AA288D6EE
0ADEF480C4FB4D83D7746125E2662BEE
11A8D6037368A4C4508B11ADB4353BC4
9DF8D27CC9F5377D6DF1872853ECC583
D3F06F9B7BD9D7FC8758BF78BF0705E9
D299D5763E03F1CC4DA8550AF1B4CEE4
3F6BC08D796DEE0902E221D5ADC88FC5
BBBB2C46108622C7B2A5444C3B823176
E4D0CD43ECF1890C6D20D2EC09153E02
CE7404D5A8831F2DE46BD0A013A8ED64
4789C778386485B99F4077B97DFE34E3
332FF17A7140DA319A07A72CA1CB6A5A
932AAF56DDE9C55359B9CCFA18E7FB95
A9E807665E94FF89025596B115E09C5C
0FE7AA892150DE7C58D1B2988580346D
F6452CD221C4FDE0AF59C2DD379AC28E
9D7FBEE36126EDDACD5524F832FCCA6A
EB1A430BACB37E6EA72592BF838E64A6
C9412C4191106BA79EB392D0769EEE65
0D17D0247F158FA3E40D21EFF46D1651
B5F3D00E28A57C9522F2DEE3CB903DD1
BD23A737D75442D2C32CE2259D15D624
8EDB9A9856CDB5AFC42546106EE46734
DAA3F353F320A717A0C418A8205292B2
FEDC59699D8832A11B88BFCCCAD0951D
8040FC9C0479C3B9A74ED298DD8F357D
62AC87CFE11DD7CC707AEDE576B728AE
10B0D468B5E036E16D13DB53A65F2D49
372E8CE8A7D150B1374696B670B927A3
004D2DFEB866BFB00427DB2F530C1F3D
0CAAA1B6F161BA4D363EB7A2DEF64A08
99860CEFD3C6829FF1B668DC090F03AF

2025-01-23 06:45:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:45:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:45:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:45:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 06:45:08 - snowflake.connector.connection - INFO - closed
2025-01-23 06:45:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:45:09 - root - INFO - SQL:
SELECT t."event_params"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180706" t
   WHERE t."event_name" LIKE '%quickplay%'
   LIMIT 100
Results:
Too long, hard cut:
event_params
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""L""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""L""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""L""
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 4497965592468327206
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""L""
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 4497965592468327206
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 19
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 2875908802993843912
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 21
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 2875908802993843912
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 21
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 2875908802993843912
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 2875908802993843912
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 2875908802993843912
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 2875908802993843912
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 28759

2025-01-23 06:45:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:45:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:45:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:45:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 06:45:10 - snowflake.connector.connection - INFO - closed
2025-01-23 06:45:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:45:11 - root - INFO - SQL:
SELECT f.value
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180707" t, LATERAL FLATTEN(input => t."event_params") f
   WHERE t."event_name" LIKE '%quickplay%'
   LIMIT 100
Results:
Too long, hard cut:
VALUE
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8155157388420242254
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8155157388420242254
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8155157388420242254
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8155157388420242254
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8155157388420242254
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8155157388420242254
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8155157388420242254
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8155157388420242254
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8155157388420242254
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8155157388420242254
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8155157388420242254
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 21
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -6237111278173532775
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 21
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
   

2025-01-23 06:45:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:45:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:45:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:45:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 06:45:12 - snowflake.connector.connection - INFO - closed
2025-01-23 06:45:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:45:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 06:45:33 - root - INFO - ```sql
SELECT t."user_pseudo_id", SPLIT_PART(t."event_name", '_quickplay', 1) AS "quickplay_event_type"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180708" t
WHERE t."event_name" LIKE '%quickplay%'
LIMIT 100;
```
2025-01-23 06:45:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:45:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:45:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:45:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 06:45:34 - snowflake.connector.connection - INFO - closed
2025-01-23 06:45:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:46:16 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 06:46:16 - root - INFO - SQL:
SELECT t."user_pseudo_id", SPLIT_PART(t."event_name", '_quickplay', 1) AS "quickplay_event_type"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180708" t
WHERE t."event_name" LIKE '%quickplay%'
LIMIT 100;
Results:
user_pseudo_id,quickplay_event_type
FC55032FC8C06EB1A1220D1ABD1164C9,level_complete
FC55032FC8C06EB1A1220D1ABD1164C9,level_complete
FC55032FC8C06EB1A1220D1ABD1164C9,level_start
FC55032FC8C06EB1A1220D1ABD1164C9,level_fail
FC55032FC8C06EB1A1220D1ABD1164C9,level_end
FC55032FC8C06EB1A1220D1ABD1164C9,level_start
FC55032FC8C06EB1A1220D1ABD1164C9,level_end
FC55032FC8C06EB1A1220D1ABD1164C9,level_start
FC55032FC8C06EB1A1220D1ABD1164C9,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_start
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_start
22DC6A6AE86C0AA33EBB8C3164A26925,level_start
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_start

2025-01-23 06:46:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:46:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:46:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:46:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 06:46:17 - snowflake.connector.connection - INFO - closed
2025-01-23 06:46:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:46:18 - root - INFO - SQL:
SELECT "user_pseudo_id", MIN("event_timestamp") AS "first_quickplay_event"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
WHERE "event_name" LIKE '%quickplay%'
GROUP BY "user_pseudo_id"
LIMIT 100
Results:
Too long, hard cut:
user_pseudo_id,first_quickplay_event
3B7AC9CAE2D7BB661BE66F3DE36DD005,1531167020160007
9D535D543FD07B8247DEADB4669FADE6,1531154673662013
22DC6A6AE86C0AA33EBB8C3164A26925,1531176840162008
EF9E8CCCCBBB015CAE0C334AB1745417,1531146872262008
5217AB1A454DAED6243E1C9818BE6A20,1531132346468008
5256B2B115955E80DDB7449775D92325,1531168190368023
E0F91AA200D6F12DBE53B0D166AFD87B,1531171938815010
2F0F260BD7B876C346B41977D0D03D62,1531176124268007
E2B530ADD7430BEA6BC7F3D431C8A6FF,1531167718676008
71746D859E4E6D655FEE8FFBC3B6C7E9,1531152119531008
945DE7C965AFB12E35C3C992CF9847E2,1531197663417008
980DEC5BA17132A841D7D7A140333114,1531154965023005
0373DF7959F6867CDFB1C905D39CE67C,1531147143909008
49309C5759610DBF6C829C0D4AB23943,1531134392250008
5F824D23AE3CF750894A96098818E789,1531148141498008
0160043392B1572A375E5C3BE1BB0C31,1531128656397014
77F5E9A5630151C9E831156AEAB4DA11,1531141647543008
9F3EAF490630617EF2CB47A8BD2CBBCC,1531125104805015
5C5A0787542CD24F1E19F9EB778BA766,1531138187209008
23A7E8D987ADCC38EB026096DC513F85,1531144328100008
D7D49CC32C4A23AD56E8DEAE6878EC7B,1531187313160008
6E018CE86D4601A362A9154B2500348A,1531157493400008
706C748E6D1E0768BFEFE6362B5D3F67,1531140264102007
F815B0069F973BFA743EF90A85224109,1531148865600008
05F7B2C58D627CE948B06C10E39CDF91,1531154978745002
AB32482D193E2CE166B59F82EF78D8BB,1531174890365007
2F5B044B41268F6643EB4D0EF15D4E87,1531153897280016
7566596A1D6ACA781692A7A0B89B06EF,1531165659087007
A29EBFE2A58D7C4D6FDA23C3A53742FF,1531163537364008
7F2B633C86B765201C93FDB6FF261143,1531122638201008
60ACC539CFC3DB94C60921D5572C3A4D,1531200784878008
4BDC831A6940071E2461D0B5293A329E,1531178872485006
D5F9D9AF22EF5073E10342973D48FB2C,1531136613085008
17515C32D8E535AA8A1B18BA774BB90C,1531163883338003
84AFEFA3875BA1F17232CB41D06B6EF4,1531194546968010
037DAC225F0C1E54657770CD201CDDA7,1531135928712008
88A41BFED275BB69125BE1F5524F3B42,1531176792435008
1B2FC37816CC4DDAACA97A75E685756F,1531174728893010
7537C0AA6291AC7B99DC4D2D695EEF1D,1531158572418047
FEC117631F54C2699CB76603EBB98CF0,1531194946865009
38DEEAB5F723A89A66CF180A175808D5,1531202088992010
C795AFA7F574C2BB09D3647AD90A9719,1531133001494002
FEDC59699D8832A11B88BFCCCAD0951D,1531137995957008
D7EA8E3645EFFBD6443946179ED704A6,1531140146309008
B75F91EB6C7FDA9A329567E763CF9E44,1531182703484016
8040FC9C0479C3B9A74ED298DD8F357D,1531134542663010
D299D5763E03F1CC4DA8550AF1B4CEE4,1531145969240008
A05ACB383D79E187B98B95E9C749C416,1531175199742006
B323329B7260E172FC3D1CC3AFF5C38C,1531185942651007
301AFECE7DEEE17ACC059F6C18017D80,1531178577513010
03A9D32C44665A9E15CFCCEDC9F68EDB,1531130621650008
5E68049FB5C4C88B7A0B8EACC6413E1B,1531200030593008
8C7A0CAF2B29D568268B8D331E37ABF6,1531181283700007
F8EBD8316C0FAA906D1335B3D2C04C83,1531126726943008
8FA82E7952616AA4904B29201BDC06FB,1531139799967011
E4C074EBC3729FB45CFA48D9F6EA4DFD,1531136173558009
DA48D36D07835B1918BDF831AF83B5EF,1531134058798008
0046A2D1B1135C0AB4462B8FF036739E,1531179618382009
2B90CE94C6039DF03E72FE15B5320ABA,1531155381198007
E9DCE2D958652BD58E846DCE86BDD90A,1531137422135007
5E4B8BBBE58491A3A1B462A95DC287E4,1531159677601007
93A7A5C31807490E878F4164A6418BFC,1531187130809007
C6DE585349744A40725DB0AB17041BA3,1531147956588006
C136A7CE1D0A52B8D4E5F144DF114EB7,1531124870628008
4BF98D09CA8359FC59ADAF56D00338F8,1531171413710007
60603343AB8FEECD78B1009C957D193D,1531182852968001
4D084D38156128AAA060303AA91E689D,1531180775948007
48AB910A8DE8485D4C34238EA61F782C,1531146355849006
29845B6298FB882DF53607D21F0E1DF7,1531164042599039
3EF8FC940E379D53BBD3FEFDAF626BB2,1531205386511007
E6FEE8B98E75EA5311FE004F98559A27,1531164815112008
B56E67847E1AE8D6411A5ECCA26585CA,1531166431273008
0E05F56141200FF41FCC0C7FA297FF08,1531141290606002
9038CCC5F7D7ABDA6E296D18FFDD1AAA,1531125756943005
59BE43F3FE7AB3F91B016B56508D4C46,1531157021719008
FFFE80A7B9667187D501CE6037876955,1531139453529005
A65FAEAB5577A16B517735A9D9C54958,1531142674388004
84F5D9204EDAE98B3B542AEA93F40BED,1531136109487008
017CF202552235BBA4338E0D82A53F43,1531201194759014
EBFE0623EF1109A89B392B9DF4375951,1531179571911008
CA04708DA02378999ECB402481FF1AE4,1531142479964008
E4196C5E0A92A22F69DE4E3AA288D6EE,1531187745592010
2F5BBABE9DD0271DCD62E501F76DA736,1531171850690008
10522BF919A454B898540F51FFDCB292,1531162084088007
59454BAC415BB1F18517C6FD2C023E49,1531187434663008
8BE7BF90C971453A34C1FF6FF2A0ACAE,1531165675056008
6D4F9673F3DADCB39EE913EFCA2AE282,1531184588390005
359B5B95C8B1DF723D939A5A8AFF0904,1531181010068447
2C84CF723999D48F8F069AFFC184C4DC,1531140141218008
F3917138A3D4B03ADA1C2E77E3B84649,1531159613600008
CE7404D5A8831F2DE46BD0A013A8ED64,1531151473701008
3BBC4DD5C8CA9027CECBEA5C39F80E3A,1531189952134029
1B2A9E461E99FB1D165894AFE613AD73,1531200785561005
9B18A1CBA96D52D05CFA7CB7C9011EDE,1531121830266010
2D9E81829DC070224ABDE3EAA0F34C2E,1531204813306008
9CD32E150A48D09944338963BBE1EA18,1531173934162006
B75FCD833DE643B45B326D2E7AC413E4,1531161285330008
932AAF56DDE9C55359B9CCFA18E7FB95,1531147040182007
E512079B53179DF9A608CF4ADE47DE9D,1531165708219008
B458770ED6E29

2025-01-23 06:46:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:46:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:46:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:46:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 06:46:19 - snowflake.connector.connection - INFO - closed
2025-01-23 06:46:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:46:20 - root - INFO - SQL:
SELECT "user_pseudo_id", COUNT(*) AS "return_events"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180710"
WHERE "event_name" LIKE '%quickplay%' AND "event_timestamp" > ("user_first_touch_timestamp" + 1209600000000)
GROUP BY "user_pseudo_id"
LIMIT 100
Results:
user_pseudo_id,return_events
5217AB1A454DAED6243E1C9818BE6A20,112
F17EA6A3B57963F44F7B81C5D761F9F2,4
E2B530ADD7430BEA6BC7F3D431C8A6FF,3
F26EC6056E284FDDEA7771F203B6BB8F,4
224C6AE85D60A605AC6164FA86738DF6,5
0373DF7959F6867CDFB1C905D39CE67C,16
092890FA0561E3456ED710E3F88750B3,96
59483477E9365F4C9A834CD88B37BA41,5
49309C5759610DBF6C829C0D4AB23943,12
9F3EAF490630617EF2CB47A8BD2CBBCC,6
9DE7361ACCDEA6541AD5EA55D59B1C78,44
7E40E634997585B0C69B6F67C01C191B,4
706C748E6D1E0768BFEFE6362B5D3F67,21
0AF862AFEB5358EBFDA7AFE3AC908844,27
3EF8FC940E379D53BBD3FEFDAF626BB2,83
2DB65B29C41328FF8AB9AC27B7C05537,160
16AD1C031AF106322F082EE8EA61C295,1
E6FEE8B98E75EA5311FE004F98559A27,37
48AB910A8DE8485D4C34238EA61F782C,42
1CF315BC6864E7A71A81E47925E18A61,1
F815B0069F973BFA743EF90A85224109,3
0E05F56141200FF41FCC0C7FA297FF08,204
81D3DD49AA2304FD1ED8C498747B5FC6,6
F9E81248456FBD71D00697C06259396E,1
26E86A2E3E01E89467AE434BBF204817,3
A29EBFE2A58D7C4D6FDA23C3A53742FF,7
BE36C49B1AB3968D420923AEC4FDD7AE,7
4AB0441290F6077849CBE9C74A828F0A,17
32C3039A18B8BC54D469BD784E3E65F8,15
7842C62D45ECE888132F21C9F4417B21,4
0A7D79D18034304FAF741FB55EA85073,30
757F371D73A59AA7B6FB5CF1E6483B33,3
D5F9D9AF22EF5073E10342973D48FB2C,14
488908B4727978E9813DD50CB3E7F330,3
41CA0FA528C7227EA1E592DCC4733C40,1
89BD2B0E233951461CF06C9B4FDA0D81,6
84AFEFA3875BA1F17232CB41D06B6EF4,5
8065F8E98407106A65D35195984B2258,19
9D0C09CBAF30B0F179FF4F1B61679458,7
FEDC59699D8832A11B88BFCCCAD0951D,5
D7EA8E3645EFFBD6443946179ED704A6,90
A2261EC97FA1796DC8910C0652034AAA,1
CD936C60130D12C06E388F8EDFEA7105,46
475B281839C403CCF826D0D44890BFA5,7
84D135997D8A4D9CB35D4ECA46EF6861,34
A0616D4E494DC3BCCB94B8B6E5B48380,48
6D4F9673F3DADCB39EE913EFCA2AE282,10
C6DE585349744A40725DB0AB17041BA3,68
3D03A380687FE3369E93915D50C572CB,47
C962AE7EF8A83B7013D2610349D7D36E,5
2D9E81829DC070224ABDE3EAA0F34C2E,3
E512079B53179DF9A608CF4ADE47DE9D,11
7548E849537562672CF9C567B9C0EC87,11
472451071AED6FF801BC0FE66706FD27,206
5CC434A43CB09640FC6BE2D7A18183E4,147
A74C05E503F6274BAA9457B2265471F5,10
644C1993FE93C6E2B214E3B7B7D94D8E,11
E5A2CB7A471E740E758BE5E2E0C79BC2,27
874599EBF4EF79D625A0C161F74C0C0E,34
CC81C3C01DE545318860C5BFDC6AD31E,9
21CAD1B7EDE08AF9B92990553670D4BE,3
E9DCE2D958652BD58E846DCE86BDD90A,7
B78DB4E683651327A612372A48B5734C,17
60603343AB8FEECD78B1009C957D193D,12
FB9AD160115DC0E6F045BB654344287B,23
4D084D38156128AAA060303AA91E689D,6
68149A4353C4E6C2AF49CF5F35FBB78C,5
FA30269453141794E79B8F15EE0BA5B9,36
40B501E0460E254E289A776CFC31DCF2,20
AB32482D193E2CE166B59F82EF78D8BB,9
959635567E419A061EECCCA478EDC718,162
A95BA9143018CA81430258E8A725C3E6,6
E5AFF3DE508996512D61B49A63D1D063,7
2F48607C41ECC4015FA296500F0A2C4B,37
1B2FC37816CC4DDAACA97A75E685756F,3
418C1FE4FF01EA36F511E5D9073F11BD,53
037DAC225F0C1E54657770CD201CDDA7,59
2741C47CC50AE98B39CC5B561BFEA504,3
4E236A0193F3627F00BCAD5B8CADA1D5,18
CCE4BDDE62CA393AC9563B8718F5CFB9,3
1235BA39F8C700F0529EC1A33470BF0C,16
BD74B8017BBAE328A55C1B7D1164A5E2,2
20E6318A74DB55D2953059D9D9C47C68,14
59454BAC415BB1F18517C6FD2C023E49,5
DC6051D104A07C8E1FFB5718A68238BB,5
BC52B9AFFA3C0A471D06D90400771809,1
018F03084C88E944163F76A0D0C2FBA1,11
CA04708DA02378999ECB402481FF1AE4,68
E4196C5E0A92A22F69DE4E3AA288D6EE,6
41F6537F5D6EB1798536910D0722A344,1
3875A92B5F5C2BBA1355CED06A986079,47
C87CDC0C4F86B10B7467281D516929B5,12
BBDCBE2491658165B7F20540DE652E3A,163
229254D7C810F98F72C89A8060E194D4,24
3F6EEEB2D589AF8A25897D2851CA23A6,10
D3F06F9B7BD9D7FC8758BF78BF0705E9,1
FDD20A9EF4FE8B5E51F9EC2F98F51991,19
47216088A078D06F9220263FAF964F10,102
0081AD106B7DBC9A4B70CE88CCC8AAB8,27
F3917138A3D4B03ADA1C2E77E3B84649,5

2025-01-23 06:46:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:46:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:46:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:46:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-23 06:46:21 - snowflake.connector.connection - INFO - closed
2025-01-23 06:46:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:46:22 - root - INFO - SQL:
SELECT DISTINCT "platform"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180711"
WHERE "event_name" LIKE '%quickplay%'
LIMIT 100
Results:
platform
IOS
ANDROID

2025-01-23 06:46:22 - root - INFO - itercount: 0
2025-01-23 06:46:22 - root - INFO - Database Name: FIREBASE
Schema Name: ANALYTICS_153293282
DDL describes table information.
,0
table_name,EVENTS_20180613
description,
DDL,"create or replace TABLE EVENTS_20180613 (
	""event_date"" VARCHAR(16777216),
	""event_timestamp"" NUMBER(38,0),
	""event_name"" VARCHAR(16777216),
	""event_params"" VARIANT,
	""event_previous_timestamp"" NUMBER(38,0),
	""user_id"" VARCHAR(16777216),
	""user_pseudo_id"" VARCHAR(16777216),
	""user_properties"" VARIANT,
	""user_first_touch_timestamp"" NUMBER(38,0),
	""user_ltv"" VARIANT,
	""device"" VARIANT,
	""geo"" VARIANT,
	""app_info"" VARIANT,
	""traffic_source"" VARIANT,
	""stream_id"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']
External knowledge that might be helpful: 
How to Calculate User Retention in Big Query from Google Demo Game Analytics Data

As a Product / Website Analyst, I was pretty psyched to discover Googleâ€™s public Google Analytics 4 (GA4) gaming event dataset called `firebase-public-project.analytics_153293282.events_*`. The table allows experienced developers and learners alike to experiment with raw GA4 data in Big Query for free. Event data is basically a log of user interactions with your product for analysis .For newbies interested in learning more about event data and GA4, visit my prior blog. This article provides SQL queries for a quick table overview and explains how to utilize Google Big Query to calculate user retention.


What is Retention?
User retention rates are key indicators for whether your product team meets user needs. Improving retention is often central to long term growth strategies.

**Retention measureâ€™s how often and for how long users tend to return to your product.**

The metric can be a powerful proxy for product usefulness and user opinion. Its analysis can reveal critical information like how well your site converts new visitors to users and which items and features are associated with users coming back. If user data is available, retention can also help a business understand the profiles of its most active users (power users). Finally, retention is a great guardrail metric for A/B tests. Successful, product oriented companies prioritize a healthy user bases over short term profits.


**Common Retention Calculation Strategies**

Two common strategies to calculate retention are: 

a) N-Day retention

b) Unbounded Retention.


a) For N-Day retention, analysts calculate how many users with certain characteristics return over successive periods. It is called N days because we define the length of each period. For example, with N=7 day retention, if User A becomes part of our cohort of interest on day 0 and returns to the product day 5 and day 15, they are counted as retained for week 1 (1â€“7 days) and week 3 (15â€“21 days) but not week 2 (8â€“14 days).


b) For Unbounded Retention, a user is counted as retained each week so long as their most recent product contact was after the week. For example, if User A becomes part of the cohort on day 0 and last returned to the site on day 21, they will be counted as retained in week 1 (1â€“7 days), week 2 (8â€“14 days), and week 3 (15â€“21 days) but not week 4 (22â€“28 days).

By calculating these metrics, companies can evaluate how well their products hold usersâ€™ interests. It also them closer to identifying the patterns that generate return users.



The table structure information is ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}
Begin Exploring Related Columns
**Columns and their potential usage:**

- **"event_date"**: Used to filter events within the period from July 2, 2018, to July 16, 2018.
- **"event_name"**: To identify "quickplay" events.
- **"event_params"**: Contains details to extract specific quickplay event types.
- **"user_pseudo_id"**: Unique identifier for users to track their activities.
- **"event_timestamp"**: Used to determine when events occurred.
- **"user_first_touch_timestamp"**: To find the first interaction time of users.
- **"platform"**: To analyze events based on different platforms.
- **"device"**: Contains device information which might be relevant.
- **"geo"**: Contains geographic information of the events.
- **"user_properties"**: Additional properties of users that may be useful.

**Conditions that may be used:**

- **Date Range Filter**: `"event_date"` between '20180702' and '20180716'.
- **Event Filter**: `"event_name"` = 'quickplay'.
- **Extracting Event Types**: Parsing `"event_params"` to get quickplay event types.
- **User Identification**: Using `"user_pseudo_id"` to track unique users.
- **Timestamp Comparisons**: Comparing `"event_timestamp"` for retention calculations.

**SQL Queries:**

1. **Retrieve distinct event names to verify the presence of 'quickplay' events:**
   ```sql
   SELECT DISTINCT "event_name"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   LIMIT 100;
   ```

2. **List all quickplay events within the specified date range:**
   ```sql
   SELECT "event_date", "event_name", "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180703"
   WHERE "event_name" = 'quickplay' AND "event_date" BETWEEN '20180702' AND '20180716'
   LIMIT 100;
   ```

3. **Count the number of quickplay events per day:**
   ```sql
   SELECT "event_date", COUNT(*) AS "quickplay_event_count"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180704"
   WHERE "event_name" = 'quickplay'
   GROUP BY "event_date"
   LIMIT 100;
   ```

4. **Get distinct users who performed quickplay events:**
   ```sql
   SELECT DISTINCT "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180705"
   WHERE "event_name" = 'quickplay'
   LIMIT 100;
   ```

5. **Extract event parameters for quickplay events:**
   ```sql
   SELECT t."event_params"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180706" t
   WHERE t."event_name" = 'quickplay'
   LIMIT 100;
   ```

6. **Flatten and view the key-value pairs in event_params for quickplay events:**
   ```sql
   SELECT f.value
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180707" t, LATERAL FLATTEN(input => t."event_params") f
   WHERE t."event_name" = 'quickplay'
   LIMIT 100;
   ```

7. **Extract specific quickplay event types from event_params:**
   ```sql
   SELECT t."user_pseudo_id", f.value:"quickplay_event_type"::STRING AS "quickplay_event_type"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180708" t, LATERAL FLATTEN(input => t."event_params") f
   WHERE t."event_name" = 'quickplay'
   LIMIT 100;
   ```

8. **Identify the first quickplay event timestamp for each user:**
   ```sql
   SELECT "user_pseudo_id", MIN("event_timestamp") AS "first_quickplay_event"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
   WHERE "event_name" = 'quickplay'
   GROUP BY "user_pseudo_id"
   LIMIT 100;
   ```

9. **Count the number of users who returned after two weeks from their first quickplay event:**
   ```sql
   SELECT "user_pseudo_id", COUNT(*) AS "return_events"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180710"
   WHERE "event_name" = 'quickplay' AND "event_timestamp" > ("user_first_touch_timestamp" + 1209600000)
   GROUP BY "user_pseudo_id"
   LIMIT 100;
   ```

10. **Check the platforms used for quickplay events:**
    ```sql
    SELECT DISTINCT "platform"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180711"
    WHERE "event_name" = 'quickplay'
    LIMIT 100;
    ```

These queries help in exploring the data necessary for calculating the retention rate for users two weeks after their initial quickplay event, specifically by:

- Identifying the relevant event names and ensuring 'quickplay' events are present.
- Filtering events within the specific date range.
- Extracting and analyzing the event parameters to determine different quickplay event types.
- Identifying unique users and their initial interaction timestamps.
- Examining user return behavior after two weeks.
- Exploring platform distribution for these events.Query:
SELECT DISTINCT "event_name"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   LIMIT 100;
Answer:
event_name
level_complete_quickplay
session_start
screen_view
level_fail_quickplay
level_end_quickplay
post_score
level_start_quickplay
user_engagement
level_up
level_complete
select_content
level_fail
level_end
level_start
level_retry
completed_5_levels
no_more_extra_steps
level_retry_quickplay
level_reset
level_reset_quickplay
app_exception
os_update
app_remove
app_clear_data
app_update
firebase_campaign
error
ad_reward
use_extra_steps
spend_virtual_currency
challenge_a_friend
first_open
Query:
SELECT "event_date", "event_name", "user_pseudo_id"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
WHERE "event_name" LIKE '%quickplay%'
LIMIT 100;
Answer:
Too long, hard cut:
event_date,event_name,user_pseudo_id
20180702,level_complete_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_complete_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_complete_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_fail_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_fail_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_fail_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_fail_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_fail_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_fail_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_fail_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_fail_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_fail_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_fail_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_fail_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_end_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,654F30C1312F6C1A26DFDA9F076A62D8
20180702,level_start_quickplay,65D7715C409E6A38667447CE2B52AFFE
20180702,level_start_quickplay,B205B117C82A24AA95E663FFB7D04718
20180702,level_start_quickplay,EF9E8CCCCBBB015CAE0C334AB1745417
20180702,level_start_quickplay,83D8C7F90DAF2C832F05A9DDD8693135
20180702,level_complete_quickplay,0F67E233B19D2898229CD156974A93AE
20180702,level_start_quickplay,0F67E233B19D2898229CD156974A93AE
20180702,level_end_quickplay,0F67E233B19D2898229CD156974A93AE
20180702,level_complete_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_complete_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_complete_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_complete_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_complete_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_complete_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_complete_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_fail_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_end_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_fail_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_end_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_fail_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_end_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_end_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_start_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_start_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_end_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_start_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_end_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_start_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_fail_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_end_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_start_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_end_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_start_quickplay,5217AB1A454DAED6243E1C9818BE6A20
20180702,level_start_quickplay,5217AB1A454DAED6243E1C9818BE6A20
Query:
SELECT "event_date", COUNT(*) AS "quickplay_event_count"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180704"
   WHERE "event_name" LIKE '%quickplay%'
   GROUP BY "event_date"
   LIMIT 100
Answer:
event_date,quickplay_event_count
20180704,11747
Query:
SELECT DISTINCT "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180705"
   WHERE "event_name" LIKE '%quickplay%'
   LIMIT 100
Answer:
user_pseudo_id
654F30C1312F6C1A26DFDA9F076A62D8
3A0C188E07D23B3FA107E338476821D8
0F67E233B19D2898229CD156974A93AE
5217AB1A454DAED6243E1C9818BE6A20
16DB8E847B4DDC16F3F250637F2D8C89
2A79E63E7E0E7F4F2CFCAFCB449CE389
224C6AE85D60A605AC6164FA86738DF6
15955C2770D8FE60B329BCD0805BB35E
10DD4C2B3060AB868E928AA66B81E459
3BDA016D41EB1108EFF393D77AFA3348
08D399C66188D9A356AFAD5E2B2BA45E
9DE7361ACCDEA6541AD5EA55D59B1C78
4A47A98F4565C38DBABBE20B803D7FFB
0155220BAB309646CC7AC980AB75A212
706C748E6D1E0768BFEFE6362B5D3F67
E6FEE8B98E75EA5311FE004F98559A27
6CD2676098B3E076AD66D10BF4565BFA
346CA8A816ECDF5226D821892E18B502
DEAFC2BFCF3A46C685EF4CE67F8A1248
22DC6A6AE86C0AA33EBB8C3164A26925
570495249052C5E40EC34A2B054DA1A1
1406751556EEDB1D112BF86CACAE9C88
41CA0FA528C7227EA1E592DCC4733C40
B56E67847E1AE8D6411A5ECCA26585CA
A064A84CD3CF7058F39333D6212E8615
E5AFF3DE508996512D61B49A63D1D063
22430BD1EDFC8E2E980313F10148A53E
7566596A1D6ACA781692A7A0B89B06EF
7842C62D45ECE888132F21C9F4417B21
2C0308CAAC49EAE73174F5110D76F2C6
B35B079A68D98EDEBA184E73C2F6FB51
3DEB0C12C49AD19D7ACE68FA59E7ACD6
E2372AFD5CBA85F1395201FB687AEC46
D8A4973047AF2FA8E9061F6F52E6BD61
757F371D73A59AA7B6FB5CF1E6483B33
D5F9D9AF22EF5073E10342973D48FB2C
B71CB5D517BE99FEEED64A0F57842032
3109942E3428ED1CC49E093965E1748C
27954A1D70BCD7F326F926A5D5B666E6
EBFE0623EF1109A89B392B9DF4375951
CA04708DA02378999ECB402481FF1AE4
6D8B6C8E0800777A88BA604FA3435B16
2D4660CA182ACFAB37A5CDC0D78C4C37
D7EA8E3645EFFBD6443946179ED704A6
3D03A380687FE3369E93915D50C572CB
05FB3382D94C7E963B408FD6CC357D33
2D9E81829DC070224ABDE3EAA0F34C2E
B75FCD833DE643B45B326D2E7AC413E4
ADDE80C89BB3F6190538E50E541BACD5
E512079B53179DF9A608CF4ADE47DE9D
B5D8ACA33A57FF52CFC01C59EBD0E9EC
03A9D32C44665A9E15CFCCEDC9F68EDB
77F5E9A5630151C9E831156AEAB4DA11
0446949CDEB27AEA0A1151792973D6FB
48AB910A8DE8485D4C34238EA61F782C
5145D8121071A9EA903A1098034962F6
F94E005EB49AFB8DA0A78030D4ABB44B
0A7D79D18034304FAF741FB55EA85073
C77E351A1740BEE7A57B58DC5003A54D
1B2FC37816CC4DDAACA97A75E685756F
2741C47CC50AE98B39CC5B561BFEA504
59BE43F3FE7AB3F91B016B56508D4C46
A65FAEAB5577A16B517735A9D9C54958
537B074515EB8F5DDF89269910D94309
B75F91EB6C7FDA9A329567E763CF9E44
7480AE90D76538F44A066A153F448198
369C245CB9986DCBF1A7F0965D5303CE
FFA9AE78B23263835F8AAED57713EBE9
E4196C5E0A92A22F69DE4E3AA288D6EE
0ADEF480C4FB4D83D7746125E2662BEE
11A8D6037368A4C4508B11ADB4353BC4
9DF8D27CC9F5377D6DF1872853ECC583
D3F06F9B7BD9D7FC8758BF78BF0705E9
D299D5763E03F1CC4DA8550AF1B4CEE4
3F6BC08D796DEE0902E221D5ADC88FC5
BBBB2C46108622C7B2A5444C3B823176
E4D0CD43ECF1890C6D20D2EC09153E02
CE7404D5A8831F2DE46BD0A013A8ED64
4789C778386485B99F4077B97DFE34E3
332FF17A7140DA319A07A72CA1CB6A5A
932AAF56DDE9C55359B9CCFA18E7FB95
A9E807665E94FF89025596B115E09C5C
0FE7AA892150DE7C58D1B2988580346D
F6452CD221C4FDE0AF59C2DD379AC28E
9D7FBEE36126EDDACD5524F832FCCA6A
EB1A430BACB37E6EA72592BF838E64A6
C9412C4191106BA79EB392D0769EEE65
0D17D0247F158FA3E40D21EFF46D1651
B5F3D00E28A57C9522F2DEE3CB903DD1
BD23A737D75442D2C32CE2259D15D624
8EDB9A9856CDB5AFC42546106EE46734
DAA3F353F320A717A0C418A8205292B2
FEDC59699D8832A11B88BFCCCAD0951D
8040FC9C0479C3B9A74ED298DD8F357D
62AC87CFE11DD7CC707AEDE576B728AE
10B0D468B5E036E16D13DB53A65F2D49
372E8CE8A7D150B1374696B670B927A3
004D2DFEB866BFB00427DB2F530C1F3D
0CAAA1B6F161BA4D363EB7A2DEF64A08
99860CEFD3C6829FF1B668DC090F03AF
Query:
SELECT t."event_params"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180706" t
   WHERE t."event_name" LIKE '%quickplay%'
   LIMIT 100
Answer:
Too long, hard cut:
event_params
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""L""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""L""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""L""
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 4497965592468327206
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""L""
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 4497965592468327206
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 19
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 2875908802993843912
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 21
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 2875908802993843912
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""value"",
    ""value"": {
      ""int_value"": 21
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 2875908802993843912
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 2875908802993843912
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 2875908802993843912
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 2875908802993843912
    }
  }
]"
"[
  {
    ""key"": ""board"",
    ""value"": {
      ""string_value"": ""S""
    }
  },
  {
    ""key"": ""firebase_screen_class"",
    ""value"": {
      ""string_value"": ""game_board""
    }
  },
  {
    ""key"": ""firebase_event_origin"",
    ""value"": {
      ""string_value"": ""app+gtm""
    }
  },
  {
    ""key"": ""firebase_screen_id"",
    ""value"": {
      ""int_value"": 28759
Query:
SELECT f.value
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180707" t, LATERAL FLATTEN(input => t."event_params") f
   WHERE t."event_name" LIKE '%quickplay%'
   LIMIT 100
Answer:
Too long, hard cut:
VALUE
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8155157388420242254
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8155157388420242254
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8155157388420242254
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8155157388420242254
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8155157388420242254
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8155157388420242254
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8155157388420242254
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8155157388420242254
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8155157388420242254
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8155157388420242254
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8155157388420242254
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 21
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -6237111278173532775
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 21
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
   
Query:
SELECT t."user_pseudo_id", SPLIT_PART(t."event_name", '_quickplay', 1) AS "quickplay_event_type"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180708" t
WHERE t."event_name" LIKE '%quickplay%'
LIMIT 100;
Answer:
user_pseudo_id,quickplay_event_type
FC55032FC8C06EB1A1220D1ABD1164C9,level_complete
FC55032FC8C06EB1A1220D1ABD1164C9,level_complete
FC55032FC8C06EB1A1220D1ABD1164C9,level_start
FC55032FC8C06EB1A1220D1ABD1164C9,level_fail
FC55032FC8C06EB1A1220D1ABD1164C9,level_end
FC55032FC8C06EB1A1220D1ABD1164C9,level_start
FC55032FC8C06EB1A1220D1ABD1164C9,level_end
FC55032FC8C06EB1A1220D1ABD1164C9,level_start
FC55032FC8C06EB1A1220D1ABD1164C9,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_complete
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_start
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_start
22DC6A6AE86C0AA33EBB8C3164A26925,level_start
22DC6A6AE86C0AA33EBB8C3164A26925,level_fail
22DC6A6AE86C0AA33EBB8C3164A26925,level_end
22DC6A6AE86C0AA33EBB8C3164A26925,level_start
Query:
SELECT "user_pseudo_id", MIN("event_timestamp") AS "first_quickplay_event"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
WHERE "event_name" LIKE '%quickplay%'
GROUP BY "user_pseudo_id"
LIMIT 100
Answer:
Too long, hard cut:
user_pseudo_id,first_quickplay_event
3B7AC9CAE2D7BB661BE66F3DE36DD005,1531167020160007
9D535D543FD07B8247DEADB4669FADE6,1531154673662013
22DC6A6AE86C0AA33EBB8C3164A26925,1531176840162008
EF9E8CCCCBBB015CAE0C334AB1745417,1531146872262008
5217AB1A454DAED6243E1C9818BE6A20,1531132346468008
5256B2B115955E80DDB7449775D92325,1531168190368023
E0F91AA200D6F12DBE53B0D166AFD87B,1531171938815010
2F0F260BD7B876C346B41977D0D03D62,1531176124268007
E2B530ADD7430BEA6BC7F3D431C8A6FF,1531167718676008
71746D859E4E6D655FEE8FFBC3B6C7E9,1531152119531008
945DE7C965AFB12E35C3C992CF9847E2,1531197663417008
980DEC5BA17132A841D7D7A140333114,1531154965023005
0373DF7959F6867CDFB1C905D39CE67C,1531147143909008
49309C5759610DBF6C829C0D4AB23943,1531134392250008
5F824D23AE3CF750894A96098818E789,1531148141498008
0160043392B1572A375E5C3BE1BB0C31,1531128656397014
77F5E9A5630151C9E831156AEAB4DA11,1531141647543008
9F3EAF490630617EF2CB47A8BD2CBBCC,1531125104805015
5C5A0787542CD24F1E19F9EB778BA766,1531138187209008
23A7E8D987ADCC38EB026096DC513F85,1531144328100008
D7D49CC32C4A23AD56E8DEAE6878EC7B,1531187313160008
6E018CE86D4601A362A9154B2500348A,1531157493400008
706C748E6D1E0768BFEFE6362B5D3F67,1531140264102007
F815B0069F973BFA743EF90A85224109,1531148865600008
05F7B2C58D627CE948B06C10E39CDF91,1531154978745002
AB32482D193E2CE166B59F82EF78D8BB,1531174890365007
2F5B044B41268F6643EB4D0EF15D4E87,1531153897280016
7566596A1D6ACA781692A7A0B89B06EF,1531165659087007
A29EBFE2A58D7C4D6FDA23C3A53742FF,1531163537364008
7F2B633C86B765201C93FDB6FF261143,1531122638201008
60ACC539CFC3DB94C60921D5572C3A4D,1531200784878008
4BDC831A6940071E2461D0B5293A329E,1531178872485006
D5F9D9AF22EF5073E10342973D48FB2C,1531136613085008
17515C32D8E535AA8A1B18BA774BB90C,1531163883338003
84AFEFA3875BA1F17232CB41D06B6EF4,1531194546968010
037DAC225F0C1E54657770CD201CDDA7,1531135928712008
88A41BFED275BB69125BE1F5524F3B42,1531176792435008
1B2FC37816CC4DDAACA97A75E685756F,1531174728893010
7537C0AA6291AC7B99DC4D2D695EEF1D,1531158572418047
FEC117631F54C2699CB76603EBB98CF0,1531194946865009
38DEEAB5F723A89A66CF180A175808D5,1531202088992010
C795AFA7F574C2BB09D3647AD90A9719,1531133001494002
FEDC59699D8832A11B88BFCCCAD0951D,1531137995957008
D7EA8E3645EFFBD6443946179ED704A6,1531140146309008
B75F91EB6C7FDA9A329567E763CF9E44,1531182703484016
8040FC9C0479C3B9A74ED298DD8F357D,1531134542663010
D299D5763E03F1CC4DA8550AF1B4CEE4,1531145969240008
A05ACB383D79E187B98B95E9C749C416,1531175199742006
B323329B7260E172FC3D1CC3AFF5C38C,1531185942651007
301AFECE7DEEE17ACC059F6C18017D80,1531178577513010
03A9D32C44665A9E15CFCCEDC9F68EDB,1531130621650008
5E68049FB5C4C88B7A0B8EACC6413E1B,1531200030593008
8C7A0CAF2B29D568268B8D331E37ABF6,1531181283700007
F8EBD8316C0FAA906D1335B3D2C04C83,1531126726943008
8FA82E7952616AA4904B29201BDC06FB,1531139799967011
E4C074EBC3729FB45CFA48D9F6EA4DFD,1531136173558009
DA48D36D07835B1918BDF831AF83B5EF,1531134058798008
0046A2D1B1135C0AB4462B8FF036739E,1531179618382009
2B90CE94C6039DF03E72FE15B5320ABA,1531155381198007
E9DCE2D958652BD58E846DCE86BDD90A,1531137422135007
5E4B8BBBE58491A3A1B462A95DC287E4,1531159677601007
93A7A5C31807490E878F4164A6418BFC,1531187130809007
C6DE585349744A40725DB0AB17041BA3,1531147956588006
C136A7CE1D0A52B8D4E5F144DF114EB7,1531124870628008
4BF98D09CA8359FC59ADAF56D00338F8,1531171413710007
60603343AB8FEECD78B1009C957D193D,1531182852968001
4D084D38156128AAA060303AA91E689D,1531180775948007
48AB910A8DE8485D4C34238EA61F782C,1531146355849006
29845B6298FB882DF53607D21F0E1DF7,1531164042599039
3EF8FC940E379D53BBD3FEFDAF626BB2,1531205386511007
E6FEE8B98E75EA5311FE004F98559A27,1531164815112008
B56E67847E1AE8D6411A5ECCA26585CA,1531166431273008
0E05F56141200FF41FCC0C7FA297FF08,1531141290606002
9038CCC5F7D7ABDA6E296D18FFDD1AAA,1531125756943005
59BE43F3FE7AB3F91B016B56508D4C46,1531157021719008
FFFE80A7B9667187D501CE6037876955,1531139453529005
A65FAEAB5577A16B517735A9D9C54958,1531142674388004
84F5D9204EDAE98B3B542AEA93F40BED,1531136109487008
017CF202552235BBA4338E0D82A53F43,1531201194759014
EBFE0623EF1109A89B392B9DF4375951,1531179571911008
CA04708DA02378999ECB402481FF1AE4,1531142479964008
E4196C5E0A92A22F69DE4E3AA288D6EE,1531187745592010
2F5BBABE9DD0271DCD62E501F76DA736,1531171850690008
10522BF919A454B898540F51FFDCB292,1531162084088007
59454BAC415BB1F18517C6FD2C023E49,1531187434663008
8BE7BF90C971453A34C1FF6FF2A0ACAE,1531165675056008
6D4F9673F3DADCB39EE913EFCA2AE282,1531184588390005
359B5B95C8B1DF723D939A5A8AFF0904,1531181010068447
2C84CF723999D48F8F069AFFC184C4DC,1531140141218008
F3917138A3D4B03ADA1C2E77E3B84649,1531159613600008
CE7404D5A8831F2DE46BD0A013A8ED64,1531151473701008
3BBC4DD5C8CA9027CECBEA5C39F80E3A,1531189952134029
1B2A9E461E99FB1D165894AFE613AD73,1531200785561005
9B18A1CBA96D52D05CFA7CB7C9011EDE,1531121830266010
2D9E81829DC070224ABDE3EAA0F34C2E,1531204813306008
9CD32E150A48D09944338963BBE1EA18,1531173934162006
B75FCD833DE643B45B326D2E7AC413E4,1531161285330008
932AAF56DDE9C55359B9CCFA18E7FB95,1531147040182007
E512079B53179DF9A608CF4ADE47DE9D,1531165708219008
B458770ED6E29
Query:
SELECT "user_pseudo_id", COUNT(*) AS "return_events"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180710"
WHERE "event_name" LIKE '%quickplay%' AND "event_timestamp" > ("user_first_touch_timestamp" + 1209600000000)
GROUP BY "user_pseudo_id"
LIMIT 100
Answer:
user_pseudo_id,return_events
5217AB1A454DAED6243E1C9818BE6A20,112
F17EA6A3B57963F44F7B81C5D761F9F2,4
E2B530ADD7430BEA6BC7F3D431C8A6FF,3
F26EC6056E284FDDEA7771F203B6BB8F,4
224C6AE85D60A605AC6164FA86738DF6,5
0373DF7959F6867CDFB1C905D39CE67C,16
092890FA0561E3456ED710E3F88750B3,96
59483477E9365F4C9A834CD88B37BA41,5
49309C5759610DBF6C829C0D4AB23943,12
9F3EAF490630617EF2CB47A8BD2CBBCC,6
9DE7361ACCDEA6541AD5EA55D59B1C78,44
7E40E634997585B0C69B6F67C01C191B,4
706C748E6D1E0768BFEFE6362B5D3F67,21
0AF862AFEB5358EBFDA7AFE3AC908844,27
3EF8FC940E379D53BBD3FEFDAF626BB2,83
2DB65B29C41328FF8AB9AC27B7C05537,160
16AD1C031AF106322F082EE8EA61C295,1
E6FEE8B98E75EA5311FE004F98559A27,37
48AB910A8DE8485D4C34238EA61F782C,42
1CF315BC6864E7A71A81E47925E18A61,1
F815B0069F973BFA743EF90A85224109,3
0E05F56141200FF41FCC0C7FA297FF08,204
81D3DD49AA2304FD1ED8C498747B5FC6,6
F9E81248456FBD71D00697C06259396E,1
26E86A2E3E01E89467AE434BBF204817,3
A29EBFE2A58D7C4D6FDA23C3A53742FF,7
BE36C49B1AB3968D420923AEC4FDD7AE,7
4AB0441290F6077849CBE9C74A828F0A,17
32C3039A18B8BC54D469BD784E3E65F8,15
7842C62D45ECE888132F21C9F4417B21,4
0A7D79D18034304FAF741FB55EA85073,30
757F371D73A59AA7B6FB5CF1E6483B33,3
D5F9D9AF22EF5073E10342973D48FB2C,14
488908B4727978E9813DD50CB3E7F330,3
41CA0FA528C7227EA1E592DCC4733C40,1
89BD2B0E233951461CF06C9B4FDA0D81,6
84AFEFA3875BA1F17232CB41D06B6EF4,5
8065F8E98407106A65D35195984B2258,19
9D0C09CBAF30B0F179FF4F1B61679458,7
FEDC59699D8832A11B88BFCCCAD0951D,5
D7EA8E3645EFFBD6443946179ED704A6,90
A2261EC97FA1796DC8910C0652034AAA,1
CD936C60130D12C06E388F8EDFEA7105,46
475B281839C403CCF826D0D44890BFA5,7
84D135997D8A4D9CB35D4ECA46EF6861,34
A0616D4E494DC3BCCB94B8B6E5B48380,48
6D4F9673F3DADCB39EE913EFCA2AE282,10
C6DE585349744A40725DB0AB17041BA3,68
3D03A380687FE3369E93915D50C572CB,47
C962AE7EF8A83B7013D2610349D7D36E,5
2D9E81829DC070224ABDE3EAA0F34C2E,3
E512079B53179DF9A608CF4ADE47DE9D,11
7548E849537562672CF9C567B9C0EC87,11
472451071AED6FF801BC0FE66706FD27,206
5CC434A43CB09640FC6BE2D7A18183E4,147
A74C05E503F6274BAA9457B2265471F5,10
644C1993FE93C6E2B214E3B7B7D94D8E,11
E5A2CB7A471E740E758BE5E2E0C79BC2,27
874599EBF4EF79D625A0C161F74C0C0E,34
CC81C3C01DE545318860C5BFDC6AD31E,9
21CAD1B7EDE08AF9B92990553670D4BE,3
E9DCE2D958652BD58E846DCE86BDD90A,7
B78DB4E683651327A612372A48B5734C,17
60603343AB8FEECD78B1009C957D193D,12
FB9AD160115DC0E6F045BB654344287B,23
4D084D38156128AAA060303AA91E689D,6
68149A4353C4E6C2AF49CF5F35FBB78C,5
FA30269453141794E79B8F15EE0BA5B9,36
40B501E0460E254E289A776CFC31DCF2,20
AB32482D193E2CE166B59F82EF78D8BB,9
959635567E419A061EECCCA478EDC718,162
A95BA9143018CA81430258E8A725C3E6,6
E5AFF3DE508996512D61B49A63D1D063,7
2F48607C41ECC4015FA296500F0A2C4B,37
1B2FC37816CC4DDAACA97A75E685756F,3
418C1FE4FF01EA36F511E5D9073F11BD,53
037DAC225F0C1E54657770CD201CDDA7,59
2741C47CC50AE98B39CC5B561BFEA504,3
4E236A0193F3627F00BCAD5B8CADA1D5,18
CCE4BDDE62CA393AC9563B8718F5CFB9,3
1235BA39F8C700F0529EC1A33470BF0C,16
BD74B8017BBAE328A55C1B7D1164A5E2,2
20E6318A74DB55D2953059D9D9C47C68,14
59454BAC415BB1F18517C6FD2C023E49,5
DC6051D104A07C8E1FFB5718A68238BB,5
BC52B9AFFA3C0A471D06D90400771809,1
018F03084C88E944163F76A0D0C2FBA1,11
CA04708DA02378999ECB402481FF1AE4,68
E4196C5E0A92A22F69DE4E3AA288D6EE,6
41F6537F5D6EB1798536910D0722A344,1
3875A92B5F5C2BBA1355CED06A986079,47
C87CDC0C4F86B10B7467281D516929B5,12
BBDCBE2491658165B7F20540DE652E3A,163
229254D7C810F98F72C89A8060E194D4,24
3F6EEEB2D589AF8A25897D2851CA23A6,10
D3F06F9B7BD9D7FC8758BF78BF0705E9,1
FDD20A9EF4FE8B5E51F9EC2F98F51991,19
47216088A078D06F9220263FAF964F10,102
0081AD106B7DBC9A4B70CE88CCC8AAB8,27
F3917138A3D4B03ADA1C2E77E3B84649,5
Query:
SELECT DISTINCT "platform"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180711"
WHERE "event_name" LIKE '%quickplay%'
LIMIT 100
Answer:
platform
IOS
ANDROID
End Exploring Related Columns
Task: What is the retention rate for users two weeks after their initial quickplay event within the period from July 2, 2018, to July 16, 2018, calculated separately for each quickplay event type?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Quickplay_Event_Type,Retention_Rate
type1:str,rate1:0<=float<=100
type2:str,rate2:0<=float<=100
...
```

We calculated the retention rate for users two weeks after their initial quickplay event between July 2, 2018, and July 16, 2018, separately for each quickplay event type..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-23 06:47:53 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 06:47:53 - root - INFO - ```sql
WITH event_data AS (
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180703"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180704"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180705"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180706"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180707"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180708"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180710"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180711"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180712"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180713"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180714"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180715"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180717"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180718"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180719"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180720"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180721"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180722"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180723"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180724"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180725"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180726"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180727"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180728"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180729"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180730"
),
initial_events AS (
    SELECT
        "user_pseudo_id",
        SPLIT_PART("event_name", '_quickplay', 1) AS "quickplay_event_type",
        MIN("event_timestamp") AS "initial_event_timestamp"
    FROM event_data
    WHERE "event_name" LIKE '%quickplay%'
      AND "event_date" BETWEEN '20180702' AND '20180716'
    GROUP BY "user_pseudo_id", SPLIT_PART("event_name", '_quickplay', 1)
),
retention_events AS (
    SELECT DISTINCT
        ie."user_pseudo_id",
        ie."quickplay_event_type"
    FROM initial_events ie
    INNER JOIN event_data ed ON ie."user_pseudo_id" = ed."user_pseudo_id"
    WHERE ed."event_name" LIKE '%quickplay%'
      AND SPLIT_PART(ed."event_name", '_quickplay', 1) = ie."quickplay_event_type"
      AND ed."event_timestamp" >= ie."initial_event_timestamp" + (14 * 86400000000)
      AND ed."event_timestamp" < ie."initial_event_timestamp" + (21 * 86400000000)
)
SELECT
    ie."quickplay_event_type" AS "Quickplay_Event_Type",
    ROUND((COUNT(DISTINCT re."user_pseudo_id") * 100.0) / COUNT(DISTINCT ie."user_pseudo_id"), 4) AS "Retention_Rate"
FROM initial_events ie
LEFT JOIN retention_events re
    ON ie."user_pseudo_id" = re."user_pseudo_id"
   AND ie."quickplay_event_type" = re."quickplay_event_type"
GROUP BY ie."quickplay_event_type"
ORDER BY ie."quickplay_event_type";
```
2025-01-23 06:47:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:47:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:47:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:48:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-23 06:48:02 - snowflake.connector.connection - INFO - closed
2025-01-23 06:48:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:48:03 - root - INFO - itercount: 1
2025-01-23 06:48:03 - root - INFO - 0
2025-01-23 06:48:03 - root - INFO - results: 
Quickplay_Event_Type,Retention_Rate
level_complete,35.4063
level_end,32.8457
level_fail,26.8900
level_reset,16.9625
level_retry,25.8123
level_start,30.5540


2025-01-23 06:48:03 - root - INFO - Please check the answer again by reviewing What is the retention rate for users two weeks after their initial quickplay event within the period from July 2, 2018, to July 16, 2018, calculated separately for each quickplay event type?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Quickplay_Event_Type,Retention_Rate
type1:str,rate1:0<=float<=100
type2:str,rate2:0<=float<=100
...
```

We calculated the retention rate for users two weeks after their initial quickplay event between July 2, 2018, and July 16, 2018, separately for each quickplay event type. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Quickplay_Event_Type,Retention_Rate
level_complete,35.4063
level_end,32.8457
level_fail,26.8900
level_reset,16.9625
level_retry,25.8123
level_start,30.5540
Current sql:
WITH event_data AS (
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180703"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180704"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180705"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180706"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180707"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180708"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180710"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180711"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180712"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180713"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180714"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180715"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180717"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180718"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180719"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180720"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180721"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180722"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180723"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180724"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180725"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180726"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180727"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180728"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180729"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180730"
),
initial_events AS (
    SELECT
        "user_pseudo_id",
        SPLIT_PART("event_name", '_quickplay', 1) AS "quickplay_event_type",
        MIN("event_timestamp") AS "initial_event_timestamp"
    FROM event_data
    WHERE "event_name" LIKE '%quickplay%'
      AND "event_date" BETWEEN '20180702' AND '20180716'
    GROUP BY "user_pseudo_id", SPLIT_PART("event_name", '_quickplay', 1)
),
retention_events AS (
    SELECT DISTINCT
        ie."user_pseudo_id",
        ie."quickplay_event_type"
    FROM initial_events ie
    INNER JOIN event_data ed ON ie."user_pseudo_id" = ed."user_pseudo_id"
    WHERE ed."event_name" LIKE '%quickplay%'
      AND SPLIT_PART(ed."event_name", '_quickplay', 1) = ie."quickplay_event_type"
      AND ed."event_timestamp" >= ie."initial_event_timestamp" + (14 * 86400000000)
      AND ed."event_timestamp" < ie."initial_event_timestamp" + (21 * 86400000000)
)
SELECT
    ie."quickplay_event_type" AS "Quickplay_Event_Type",
    ROUND((COUNT(DISTINCT re."user_pseudo_id") * 100.0) / COUNT(DISTINCT ie."user_pseudo_id"), 4) AS "Retention_Rate"
FROM initial_events ie
LEFT JOIN retention_events re
    ON ie."user_pseudo_id" = re."user_pseudo_id"
   AND ie."quickplay_event_type" = re."quickplay_event_type"
GROUP BY ie."quickplay_event_type"
ORDER BY ie."quickplay_event_type";
2025-01-23 06:48:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 06:48:56 - root - INFO - ```sql
WITH event_data AS (
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180703"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180704"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180705"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180706"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180707"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180708"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180710"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180711"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180712"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180713"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180714"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180715"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180717"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180718"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180719"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180720"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180721"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180722"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180723"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180724"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180725"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180726"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180727"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180728"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180729"
    UNION ALL
    SELECT "event_date", "event_name", "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180730"
),
initial_events AS (
    SELECT
        "user_pseudo_id",
        SPLIT_PART("event_name", '_quickplay', 1) AS "quickplay_event_type",
        MIN("event_timestamp") AS "initial_event_timestamp"
    FROM event_data
    WHERE "event_name" LIKE '%quickplay%'
      AND "event_date" BETWEEN '20180702' AND '20180716'
    GROUP BY "user_pseudo_id", SPLIT_PART("event_name", '_quickplay', 1)
),
retention_events AS (
    SELECT DISTINCT
        ie."user_pseudo_id",
        ie."quickplay_event_type"
    FROM initial_events ie
    INNER JOIN event_data ed ON ie."user_pseudo_id" = ed."user_pseudo_id"
    WHERE ed."event_name" LIKE '%quickplay%'
      AND SPLIT_PART(ed."event_name", '_quickplay', 1) = ie."quickplay_event_type"
      AND ed."event_timestamp" >= ie."initial_event_timestamp" + (14 * 86400000000)
      AND ed."event_timestamp" < ie."initial_event_timestamp" + (21 * 86400000000)
)
SELECT
    ie."quickplay_event_type" AS "Quickplay_Event_Type",
    ROUND((COUNT(DISTINCT re."user_pseudo_id") * 100.0) / COUNT(DISTINCT ie."user_pseudo_id"), 4) AS "Retention_Rate"
FROM initial_events ie
LEFT JOIN retention_events re
    ON ie."user_pseudo_id" = re."user_pseudo_id"
   AND ie."quickplay_event_type" = re."quickplay_event_type"
GROUP BY ie."quickplay_event_type"
ORDER BY ie."quickplay_event_type";
```
2025-01-23 06:48:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 06:48:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 06:48:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 06:48:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-23 06:48:57 - snowflake.connector.connection - INFO - closed
2025-01-23 06:48:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 06:48:58 - root - INFO - itercount: 2
2025-01-23 06:48:58 - root - INFO - 0
2025-01-23 06:48:58 - root - INFO - Total iteration counts: 2
