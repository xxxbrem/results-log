2025-01-23 17:12:18 - openai._base_client - INFO - Retrying request to /chat/completions in 0.404342 seconds
2025-01-23 17:13:24 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 17:13:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:13:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:13:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:13:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:13:25 - snowflake.connector.connection - INFO - closed
2025-01-23 17:13:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:13:25 - root - INFO - SQL:
SELECT DISTINCT "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   LIMIT 100;
Results:
user_pseudo_id
654F30C1312F6C1A26DFDA9F076A62D8
65D7715C409E6A38667447CE2B52AFFE
B205B117C82A24AA95E663FFB7D04718
EF9E8CCCCBBB015CAE0C334AB1745417
83D8C7F90DAF2C832F05A9DDD8693135
093642BD46204EB5F950303CE696BC18
0F67E233B19D2898229CD156974A93AE
5217AB1A454DAED6243E1C9818BE6A20
C6EAD483A8AF7EE9B0ADE6D7CE5DD698
58230465C695B0FDDDAE08A481FAEECC
38D4084307B6D1CEA37A48981753428E
0373DF7959F6867CDFB1C905D39CE67C
D34924C19421D7E083FD387D97765F94
C136A7CE1D0A52B8D4E5F144DF114EB7
4BF98D09CA8359FC59ADAF56D00338F8
08D399C66188D9A356AFAD5E2B2BA45E
49309C5759610DBF6C829C0D4AB23943
909A16079F7183140ACF4C71A6CCDF3D
3031EAD1E9D35306A37A0F3DC3B84A0A
3A58859E074B02E8FB1CAEA291636112
706C748E6D1E0768BFEFE6362B5D3F67
F815B0069F973BFA743EF90A85224109
D0F280B12652EB0D74F6BC74AB13606F
3EF8FC940E379D53BBD3FEFDAF626BB2
E6FEE8B98E75EA5311FE004F98559A27
50FEAE9ECFE22E951E8810622A2E8F66
4A47422A455E62E3529DE4F9F3BFAF66
4948BEDE78FC6EBA9899F26BF5C53897
88A41BFED275BB69125BE1F5524F3B42
A064A84CD3CF7058F39333D6212E8615
A87A30159D909E2356F72AAC76F26707
7AE4084BAA29B1987E51BF2964646805
5CDFC86835249BE3DB5E9F6778E344AD
7842C62D45ECE888132F21C9F4417B21
7101B4232F5B26A9C987C54F8717DCDC
29845B6298FB882DF53607D21F0E1DF7
76BB576278338D2E508DE5D705241B47
7207044281C74501C14233463AAD9A71
4BDC831A6940071E2461D0B5293A329E
A74EFE8BDAC26101B308D57A18B746CF
037DAC225F0C1E54657770CD201CDDA7
936906C2CB90CE437DBFC01BBD96BA39
D7EA8E3645EFFBD6443946179ED704A6
53866E32BA0ABFD846772D4B7B9B5921
257A35EA0A92B4B2F8FB4BA3F8B4C3D8
11A8D6037368A4C4508B11ADB4353BC4
C87CDC0C4F86B10B7467281D516929B5
028CAE01A9F16A228177C973451441A1
4CE503AE5B4C4F67A00474CE380CCC39
2304B486B11E4CFFA0BB8AC8F2F5F4B6
CE7404D5A8831F2DE46BD0A013A8ED64
60CFF65B640769B6FD3BC9593EDF7C1D
EBFE0623EF1109A89B392B9DF4375951
664F913ED3B54941B5F0886D94E01623
5D5895B1267014C54ECBE08864420979
92B0B6F48ECE132C7E502F94798FE205
05407E04B9FA64CB63D8FA1D966AD6A2
4D084D38156128AAA060303AA91E689D
E2D6E7FE36B7CDD0789CC8F03CC747E0
2F5B044B41268F6643EB4D0EF15D4E87
E8710E77072D6674A93E46DFEF725587
672B24B51143CC66DCBAA0FA88C38D57
2F8E2DBB938D2E43C2D171AF5F35EEF8
DE4912FBC5F915C027000A8A6FF44F85
48AB910A8DE8485D4C34238EA61F782C
92BF054A90804B6D65F11D7CDFCDDEFC
3DEB0C12C49AD19D7ACE68FA59E7ACD6
B7701369F8598A25DED0499DAD3BE85D
64BA3BB3BD757CE7000D38CB7125E6DA
E50F7AC0680FD87AD6CE6B6700D209A7
7D613AF4DA0F508C7090E96FD73B7E6D
C795AFA7F574C2BB09D3647AD90A9719
FEDC59699D8832A11B88BFCCCAD0951D
59454BAC415BB1F18517C6FD2C023E49
E451D416F972019604F1456533FF3858
AFE7A3E11C66E71FA9EA7B138700EC44
B75F91EB6C7FDA9A329567E763CF9E44
D739D483CCD20D4651E4A75ADEE94064
7480AE90D76538F44A066A153F448198
8EDB9A9856CDB5AFC42546106EE46734
3EDE8E7A50DE76AA2EC12DDD2AE3F9F4
CA04708DA02378999ECB402481FF1AE4
3D03A380687FE3369E93915D50C572CB
EA9A16D9042286D55399A418CC7A28F3
117AD1627465CC9E03AB5D8825D42E07
01562149DD13E75D732F0A9CA2D8CF5C
8320FC247A1967E7C0CDFC1502241310
5E694DE02688C2FDDEA38A6946A4CC3F
60FAC27D8495BF33C2AE5283A7B07005
4DA8863CD8D2C860F6BB73579BC6F5C9
97E7144B7FA861C3C8DB7424D7039832
DD695F4DCB9694F4E026B78E17BD7945
8040FC9C0479C3B9A74ED298DD8F357D
920DB84FCC0F4421650B9E257E33180B
AE920B86560554C0BE3F888EDBA2BBF7
27859DA5E38F4C681DA4FBF0CFB9F306
84D135997D8A4D9CB35D4ECA46EF6861
2F5BBABE9DD0271DCD62E501F76DA736
D3F06F9B7BD9D7FC8758BF78BF0705E9
2B1A8699D5D9CC85A21E5AD20A5F1278

2025-01-23 17:13:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:13:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:13:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:13:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:13:27 - snowflake.connector.connection - INFO - closed
2025-01-23 17:13:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:13:27 - root - INFO - SQL:
SELECT "user_pseudo_id", "user_first_touch_timestamp"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   WHERE "user_first_touch_timestamp" >= 1530489600000000
     AND "user_first_touch_timestamp" < 1531094400000000
   LIMIT 100;
Results:
Too long, hard cut:
user_pseudo_id,user_first_touch_timestamp
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE

2025-01-23 17:13:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:13:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:13:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:13:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 32
2025-01-23 17:13:29 - snowflake.connector.connection - INFO - closed
2025-01-23 17:13:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:13:29 - root - INFO - SQL:
SELECT "event_name", COUNT(*) AS event_count
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   GROUP BY "event_name"
   ORDER BY event_count DESC
   LIMIT 100;
Results:
event_name,EVENT_COUNT
screen_view,20378
user_engagement,11605
level_start_quickplay,4493
level_end_quickplay,3068
post_score,2144
level_complete_quickplay,1896
level_fail_quickplay,1173
select_content,942
level_reset_quickplay,916
session_start,621
level_start,560
level_end,396
level_retry_quickplay,387
level_retry,357
level_up,248
level_complete,229
level_fail,148
spend_virtual_currency,85
level_reset,72
use_extra_steps,55
app_exception,54
firebase_campaign,38
first_open,27
no_more_extra_steps,22
os_update,19
ad_reward,18
error,15
app_remove,13
completed_5_levels,11
app_update,8
app_clear_data,1
challenge_a_friend,1

2025-01-23 17:13:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:13:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:13:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:13:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-23 17:13:31 - snowflake.connector.connection - INFO - closed
2025-01-23 17:13:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:13:31 - root - INFO - SQL:
SELECT DISTINCT "platform"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   LIMIT 100;
Results:
platform
ANDROID
IOS

2025-01-23 17:13:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:13:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:13:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:13:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:13:33 - snowflake.connector.connection - INFO - closed
2025-01-23 17:13:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:13:33 - root - INFO - SQL:
SELECT f.value
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702" t,
        LATERAL FLATTEN(input => t."event_params") f
   LIMIT 100;
Results:
Too long, hard cut:
VALUE
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8126232848982224228
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8126232848982224228
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490845
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FloodItActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490838
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490838
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""FloodItActivity""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""ExtraStepsActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490799
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490799
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""shop_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490798
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""ExtraStepsActivity""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490798
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""shop_menu""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""GameFinishedActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490785
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490785
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_over""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"

2025-01-23 17:13:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:13:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:13:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:13:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-23 17:13:34 - snowflake.connector.connection - INFO - closed
2025-01-23 17:13:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:13:35 - root - INFO - SQL:
SELECT DISTINCT "event_date"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   LIMIT 100;
Results:
event_date
20180702

2025-01-23 17:13:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:13:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:13:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:13:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:13:36 - snowflake.connector.connection - INFO - closed
2025-01-23 17:13:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:13:36 - root - INFO - SQL:
SELECT "user_pseudo_id", COUNT(*) AS event_count
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   GROUP BY "user_pseudo_id"
   ORDER BY event_count DESC
   LIMIT 100;
Results:
user_pseudo_id,EVENT_COUNT
CC88655DF7CDE5E8225BA20B5D6EC59B,2759
C8685B0DFA2C4B4E6E6EA72894C30F6F,2145
39A0592805168E5D5B3C3687A7472628,2043
0B08423CCD5F1503B5A8B306FFED999C,1244
DDF187DB0391034487C7D3B8C681E0B0,1228
FFA9AE78B23263835F8AAED57713EBE9,1066
10B0D468B5E036E16D13DB53A65F2D49,960
12E5626928FE0885DEEF068683E8BD63,819
AD85E945EC909FEF07A21ECB3EFC0693,774
48AB910A8DE8485D4C34238EA61F782C,745
DF0E6C6C5E4F3F34FEC6EE54FD945B05,720
2F74E23BEA1E45E3897274EE4903DCC5,699
4EF964D59282E5A2C8692D30F011256B,685
CABE7E24215A5C36862658A36AE5CE12,674
B63075B53A750A67A12F7F19ED5AA835,646
E99D4AD5E5663BABE4AC08C027C775EF,593
F5DAD8DD17B689CF672D65A0A81CF4AC,529
47216088A078D06F9220263FAF964F10,516
B37EDF42306464D3D96E5A56A03A8CBA,496
92BF054A90804B6D65F11D7CDFCDDEFC,490
53A5A4C271525BAA74298747E100C376,487
472451071AED6FF801BC0FE66706FD27,485
0D17D0247F158FA3E40D21EFF46D1651,478
00D49153E0790E34D76523EEBEF459B2,478
03A9D32C44665A9E15CFCCEDC9F68EDB,459
E53BC2A0AD86417B443AF14EE3082C0F,450
5E09265F12D64B9FA85FF9427A0A7FB0,439
A9C876F6262995184453B40AB7C5233C,422
C6EAD483A8AF7EE9B0ADE6D7CE5DD698,391
F2A1FD8B142EB4C6CAAE415FA1917F50,385
C6DE585349744A40725DB0AB17041BA3,381
1B3AD9683D475EFB398E131DFE65AE61,355
3DEB0C12C49AD19D7ACE68FA59E7ACD6,354
D0F280B12652EB0D74F6BC74AB13606F,347
BE74418BE7B7466F6FE2969CA79FA919,314
0CAAA1B6F161BA4D363EB7A2DEF64A08,312
187F3053F04D9D7EF93DF21DBDB59684,307
79C6CEA7189615EF5319ED1BA55DDE9D,305
D7D49CC32C4A23AD56E8DEAE6878EC7B,303
9FEE80E475ED50AAF174B4F17563C16D,298
08D399C66188D9A356AFAD5E2B2BA45E,287
A37AD550BCBF8C8B1D5616BB5A47770D,286
3875A92B5F5C2BBA1355CED06A986079,261
487DE902636DD8A9844A2D61FE7BD568,258
E080406D26F71C9B8F331779CE8B82BA,253
C639CACA07D03F536F537ED779CF6599,235
4D33ED6DCCD63BBED146B6060B307CAF,232
EBFE0623EF1109A89B392B9DF4375951,232
E2D6E7FE36B7CDD0789CC8F03CC747E0,225
2F5BBABE9DD0271DCD62E501F76DA736,225
D7EA8E3645EFFBD6443946179ED704A6,220
654F30C1312F6C1A26DFDA9F076A62D8,212
EF500E0CF578004836D1D38C8901862B,211
09FCF0FC0E0F04B3DD8DFE96DA57DDF6,209
CFA0F8C5E25A71062E573EF8E6BC9F76,203
74375465CD17299EBC7C75A1B4047EE0,196
38D4084307B6D1CEA37A48981753428E,195
1213ED1E96B0A49B51C0F7683DB2ACCC,193
42E6A7C3536775E3B8C3DB919AE9A452,189
05FB3382D94C7E963B408FD6CC357D33,187
9DE945166BCD4709696C5836317DDE47,186
5217AB1A454DAED6243E1C9818BE6A20,186
0AF862AFEB5358EBFDA7AFE3AC908844,183
418C1FE4FF01EA36F511E5D9073F11BD,179
193D4BFCCCDED344EE4C2A2809BF685F,178
372D9BB5088C4E9000C65B06459B403A,177
5CC434A43CB09640FC6BE2D7A18183E4,176
091770A1325101155A651F90D283DA35,175
FC48EDE912EDD9F8D7ED45F697EE7193,175
78119035B1798D27E62402E7ADB498BC,172
50D8D0C89D69EDAE2F04E43E90DB59C1,168
8320FC247A1967E7C0CDFC1502241310,167
16B0F6645F896C16F83EF56A99868801,166
898B790ACC7834117A9B2C98A8B6F1F5,162
83D8C7F90DAF2C832F05A9DDD8693135,151
3D03A380687FE3369E93915D50C572CB,150
B9BC9A430E79917967EFBEF5B1915199,146
19DEEA6B15B314DB0ED2A4936959D8F9,146
64BA3BB3BD757CE7000D38CB7125E6DA,142
31D7BB4CF721D8676B85F73077F4304E,142
2304B486B11E4CFFA0BB8AC8F2F5F4B6,141
1F0D27B8A7E058446D4A6409E2E73B19,141
FE46EFC1DA3F3159AD9343EC53466F3F,141
2B7787A34C362AA51FF8E4DD031A2F70,140
018F03084C88E944163F76A0D0C2FBA1,138
BBDAFE02F8160B43C105F79EFFD0DF7F,138
FA30269453141794E79B8F15EE0BA5B9,137
D4F4DAEF5BE38E5C67FD72BB1F082EBF,131
B1A46F0467C18F539094677527CB116F,129
EECDCA8076D5842922767F5C08957B17,127
A87A30159D909E2356F72AAC76F26707,124
1D7DE8A95370FDCB698B25F1E424C91D,120
A0616D4E494DC3BCCB94B8B6E5B48380,120
62D571096D5393BFB10F2D55DA2FC28C,117
7AE4084BAA29B1987E51BF2964646805,117
CA04708DA02378999ECB402481FF1AE4,110
C089DEEB2EA27CF072D17A89C956AFF3,110
D4C8E3E0EFC45C3D60AB3F0F305489AF,109
5E694DE02688C2FDDEA38A6946A4CC3F,108
6EDA0BB1611F7E5AB409221AE13ED52E,107

2025-01-23 17:13:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:13:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:13:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:13:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:13:37 - snowflake.connector.connection - INFO - closed
2025-01-23 17:13:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:13:38 - root - INFO - SQL:
SELECT "user_pseudo_id", "event_timestamp"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   WHERE "event_timestamp" >= 1530489600000000
     AND "event_timestamp" < 1531094400000000
   LIMIT 100;
Results:
Too long, hard cut:
user_pseudo_id,event_timestamp
654F30C1312F6C1A26DFDA9F076A62D8,1530590034397045
654F30C1312F6C1A26DFDA9F076A62D8,1530592878437030
654F30C1312F6C1A26DFDA9F076A62D8,1530593467343003
654F30C1312F6C1A26DFDA9F076A62D8,1530589584539000
654F30C1312F6C1A26DFDA9F076A62D8,1530589632251002
654F30C1312F6C1A26DFDA9F076A62D8,1530589621295003
654F30C1312F6C1A26DFDA9F076A62D8,1530589675882001
654F30C1312F6C1A26DFDA9F076A62D8,1530589645899002
654F30C1312F6C1A26DFDA9F076A62D8,1530589700545007
654F30C1312F6C1A26DFDA9F076A62D8,1530589717674010
654F30C1312F6C1A26DFDA9F076A62D8,1530589696738011
654F30C1312F6C1A26DFDA9F076A62D8,1530589706400014
654F30C1312F6C1A26DFDA9F076A62D8,1530589836110019
654F30C1312F6C1A26DFDA9F076A62D8,1530589847132020
654F30C1312F6C1A26DFDA9F076A62D8,1530589838235024
654F30C1312F6C1A26DFDA9F076A62D8,1530589814532029
654F30C1312F6C1A26DFDA9F076A62D8,1530589844144032
654F30C1312F6C1A26DFDA9F076A62D8,1530589814394036
654F30C1312F6C1A26DFDA9F076A62D8,1530589876455037
654F30C1312F6C1A26DFDA9F076A62D8,1530589830110041
654F30C1312F6C1A26DFDA9F076A62D8,1530590080491048
654F30C1312F6C1A26DFDA9F076A62D8,1530590065505049
654F30C1312F6C1A26DFDA9F076A62D8,1530590096070052
654F30C1312F6C1A26DFDA9F076A62D8,1530592287744001
654F30C1312F6C1A26DFDA9F076A62D8,1530592270898005
654F30C1312F6C1A26DFDA9F076A62D8,1530592316934006
654F30C1312F6C1A26DFDA9F076A62D8,1530592322992011
654F30C1312F6C1A26DFDA9F076A62D8,1530592373007012
654F30C1312F6C1A26DFDA9F076A62D8,1530592377282017
654F30C1312F6C1A26DFDA9F076A62D8,1530592353412019
654F30C1312F6C1A26DFDA9F076A62D8,1530592366448020
654F30C1312F6C1A26DFDA9F076A62D8,1530592339807023
654F30C1312F6C1A26DFDA9F076A62D8,1530592933554034
654F30C1312F6C1A26DFDA9F076A62D8,1530592938568035
654F30C1312F6C1A26DFDA9F076A62D8,1530592921111037
654F30C1312F6C1A26DFDA9F076A62D8,1530592998341042
654F30C1312F6C1A26DFDA9F076A62D8,1530592957361043
654F30C1312F6C1A26DFDA9F076A62D8,1530592915792046
654F30C1312F6C1A26DFDA9F076A62D8,1530592907991050
654F30C1312F6C1A26DFDA9F076A62D8,1530592942033051
654F30C1312F6C1A26DFDA9F076A62D8,1530592978137055
654F30C1312F6C1A26DFDA9F076A62D8,1530593045413060
654F30C1312F6C1A26DFDA9F076A62D8,1530593045432061
654F30C1312F6C1A26DFDA9F076A62D8,1530593051856066
654F30C1312F6C1A26DFDA9F076A62D8,1530592972033068
654F30C1312F6C1A26DFDA9F076A62D8,1530593051127069
654F30C1312F6C1A26DFDA9F076A62D8,1530593021215072
654F30C1312F6C1A26DFDA9F076A62D8,1530593118573078
654F30C1312F6C1A26DFDA9F076A62D8,1530593090595079
654F30C1312F6C1A26DFDA9F076A62D8,1530593122106084
654F30C1312F6C1A26DFDA9F076A62D8,1530593109211087
654F30C1312F6C1A26DFDA9F076A62D8,1530593156248088
654F30C1312F6C1A26DFDA9F076A62D8,1530593129881092
654F30C1312F6C1A26DFDA9F076A62D8,1530593139099095
654F30C1312F6C1A26DFDA9F076A62D8,1530593151254103
654F30C1312F6C1A26DFDA9F076A62D8,1530593484478006
654F30C1312F6C1A26DFDA9F076A62D8,1530593456511007
654F30C1312F6C1A26DFDA9F076A62D8,1530593457970010
654F30C1312F6C1A26DFDA9F076A62D8,1530594430889003
654F30C1312F6C1A26DFDA9F076A62D8,1530594497911004
654F30C1312F6C1A26DFDA9F076A62D8,1530594457117009
654F30C1312F6C1A26DFDA9F076A62D8,1530594470195011
654F30C1312F6C1A26DFDA9F076A62D8,1530594524260012
654F30C1312F6C1A26DFDA9F076A62D8,1530594529500017
654F30C1312F6C1A26DFDA9F076A62D8,1530594683769025
654F30C1312F6C1A26DFDA9F076A62D8,1530594679790026
654F30C1312F6C1A26DFDA9F076A62D8,1530594658204030
654F30C1312F6C1A26DFDA9F076A62D8,1530594674511035
654F30C1312F6C1A26DFDA9F076A62D8,1530594687915040
654F30C1312F6C1A26DFDA9F076A62D8,1530594644013043
654F30C1312F6C1A26DFDA9F076A62D8,1530594610050044
654F30C1312F6C1A26DFDA9F076A62D8,1530594639605048
654F30C1312F6C1A26DFDA9F076A62D8,1530594711346056
654F30C1312F6C1A26DFDA9F076A62D8,1530594678359057
654F30C1312F6C1A26DFDA9F076A62D8,1530594723519061
654F30C1312F6C1A26DFDA9F076A62D8,1530594666667065
654F30C1312F6C1A26DFDA9F076A62D8,1530594643714066
654F30C1312F6C1A26DFDA9F076A62D8,1530594659892070
654F30C1312F6C1A26DFDA9F076A62D8,1530594899470080
654F30C1312F6C1A26DFDA9F076A62D8,1530595100189083
654F30C1312F6C1A26DFDA9F076A62D8,1530595084210084
654F30C1312F6C1A26DFDA9F076A62D8,1530595104917088
654F30C1312F6C1A26DFDA9F076A62D8,1530595067950089
654F30C1312F6C1A26DFDA9F076A62D8,1530595167280095
654F30C1312F6C1A26DFDA9F076A62D8,1530595168316096
654F30C1312F6C1A26DFDA9F076A62D8,1530595210727099
654F30C1312F6C1A26DFDA9F076A62D8,1530595166999103
654F30C1312F6C1A26DFDA9F076A62D8,1530595165030104
654F30C1312F6C1A26DFDA9F076A62D8,1530595193168109
654F30C1312F6C1A26DFDA9F076A62D8,1530595261058115
654F30C1312F6C1A26DFDA9F076A62D8,1530595269089116
654F30C1312F6C1A26DFDA9F076A62D8,1530595217832121
654F30C1312F6C1A26DFDA9F076A62D8,1530595199934124
654F30C1312F6C1A26DFDA9F076A62D8,1530595234958125
654F30C1312F6C1A26DFDA9F076A62D8,1530595265081129
654F30C1312F6C1A26DFDA9F076A62D8,1530589687459005
654F30C1312F6C1A26DFDA9F076A62D8,1530589657460006
654F30C1312F6C1A26DFDA9F076A62D8,1530592366202015
654F30C1312F6C1A26DFDA9F076A62D8,1530592294203016
654F30C1312F6C1A26D

2025-01-23 17:13:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:13:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:13:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:13:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:13:39 - snowflake.connector.connection - INFO - closed
2025-01-23 17:13:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:13:40 - root - INFO - SQL:
SELECT f.value
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702" t,
        LATERAL FLATTEN(input => t."user_properties") f
   LIMIT 100;
Results:
Too long, hard cut:
VALUE
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482378805491000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1477369230231000,
    ""string_value"": ""3""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1476908488411000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1530589570174000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1494813899942000,
    ""string_value"": ""4857993083614758445""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1530589572284000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1476917467314000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1530589572283000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1476908354977000,
    ""set_timestamp_micros"": 1476908266977000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482378833491000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1477369258231000,
    ""string_value"": ""3""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1476908516411000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1530592265519000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1494813927942000,
    ""string_value"": ""4857993083614758445""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1530589600284000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1476917495314000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1530589600283000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1476908354977000,
    ""set_timestamp_micros"": 1476908294977000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482378862491000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1477369287231000,
    ""string_value"": ""3""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1476908545411000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1530592294519000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1494813956942000,
    ""string_value"": ""4857993083614758445""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1530589629284000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1476917524314000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1530589629283000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1476908354977000,
    ""set_timestamp_micros"": 1476908323977000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482378809491000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1477369234231000,
    ""string_value"": ""3""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1476908492411000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1530589574174000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1494813903942000,
    ""string_value"": ""4857993083614758445""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1530589576284000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1476917471314000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1530589576283000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1476908354977000,
    ""set_timestamp_micros"": 1476908270977000
  }
}"
"{
  "

2025-01-23 17:13:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:13:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:13:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:13:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-23 17:13:41 - snowflake.connector.connection - INFO - closed
2025-01-23 17:13:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:14:00 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 17:14:00 - root - INFO - ```sql
SELECT DISTINCT
    t."device"['mobile_brand_name']::STRING AS "device_brand",
    t."device"['mobile_model_name']::STRING AS "device_model"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702" t
LIMIT 100;
```
2025-01-23 17:14:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:14:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:14:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:14:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-23 17:14:01 - snowflake.connector.connection - INFO - closed
2025-01-23 17:14:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:14:43 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 17:14:43 - root - INFO - SQL:
SELECT DISTINCT
    t."device"['mobile_brand_name']::STRING AS "device_brand",
    t."device"['mobile_model_name']::STRING AS "device_model"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702" t
LIMIT 100;
Results:
device_brand,device_model
not available in demo dataset,not available in demo dataset

2025-01-23 17:14:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:14:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:14:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:14:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:14:45 - snowflake.connector.connection - INFO - closed
2025-01-23 17:14:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:14:45 - root - INFO - SQL:
SELECT
    f.value:"key"::STRING AS "param_key",
    f.value:"value" AS "param_value"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702" t,
     LATERAL FLATTEN(input => t."event_params") f
LIMIT 100
Results:
Too long, hard cut:
param_key,param_value
value,"{
  ""int_value"": 22
}"
firebase_screen_class,"{
  ""string_value"": ""game_board""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490837
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 22
}"
firebase_screen_class,"{
  ""string_value"": ""game_board""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 8126232848982224228
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 22
}"
firebase_screen_class,"{
  ""string_value"": ""game_board""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 8126232848982224228
}"
board,"{
  ""string_value"": ""S""
}"
firebase_conversion,"{
  ""int_value"": 1
}"
firebase_screen_class,"{
  ""string_value"": ""game_board""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490837
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490845
}"
firebase_screen_class,"{
  ""string_value"": ""FloodItActivity""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490838
}"
firebase_previous_class,"{
  ""string_value"": ""main_menu""
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490838
}"
firebase_screen_class,"{
  ""string_value"": ""game_board""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490837
}"
firebase_previous_class,"{
  ""string_value"": ""FloodItActivity""
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490837
}"
firebase_screen_class,"{
  ""string_value"": ""ExtraStepsActivity""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490799
}"
firebase_previous_class,"{
  ""string_value"": ""game_board""
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490799
}"
firebase_screen_class,"{
  ""string_value"": ""shop_menu""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490798
}"
firebase_previous_class,"{
  ""string_value"": ""ExtraStepsActivity""
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490798
}"
firebase_screen_class,"{
  ""string_value"": ""game_board""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490837
}"
firebase_previous_class,"{
  ""string_value"": ""shop_menu""
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490837
}"
firebase_screen_class,"{
  ""string_value"": ""GameFinishedActivity""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490785
}"
firebase_previous_class,"{
  ""string_value"": ""game_board""
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490785
}"
firebase_screen_class,"{
  ""string_value"": ""game_over""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490784
}"
firebase_previous_class,"{
  ""string_value"": ""GameFinishedActivity""
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490784
}"
firebase_screen_class,"{
  ""string_value"": ""game_board""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490837
}"
firebase_previous_class,"{
  ""string_value"": ""game_over""
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490837
}"
firebase_screen_class,"{
  ""string_value"": ""ExtraStepsActivity""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490728
}"
firebase_previous_class,"{
  ""string_value"": ""game_board""
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490728
}"
firebase_screen_class,"{
  ""string_value"": ""shop_menu""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490727
}"
firebase_previous_class,"{
  ""string_value"": ""ExtraStepsActivity""
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490727
}"
firebase_screen_class,"{
  ""string_value"": ""AdActivity""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490717
}"
firebase_previous_class,"{
  ""string_value"": ""shop_menu""
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490717
}"
firebase_screen_class,"{
  ""string_value"": ""shop_menu""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490727
}"
firebase_previous_class,"{
  ""string_value"": ""AdActivity""
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490727
}"
firebase_screen_class,"{
  ""string_value"": ""game_board""
}"
firebase_event_origin,"{
  ""string_value"": "

2025-01-23 17:14:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:14:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:14:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:14:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:14:46 - snowflake.connector.connection - INFO - closed
2025-01-23 17:14:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:14:47 - root - INFO - SQL:
SELECT
    f.value:"key"::STRING AS "property_key",
    f.value:"value" AS "property_value"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702" t,
     LATERAL FLATTEN(input => t."user_properties") f
LIMIT 100
Results:
Too long, hard cut:
property_key,property_value
ad_frequency,"{
  ""set_timestamp_micros"": 1482378805491000,
  ""string_value"": ""2""
}"
initial_extra_steps,"{
  ""set_timestamp_micros"": 1477369230231000,
  ""string_value"": ""3""
}"
plays_quickplay,"{
  ""set_timestamp_micros"": 1476908488411000,
  ""string_value"": ""true""
}"
num_levels_available,"{
  ""set_timestamp_micros"": 1530589570174000,
  ""string_value"": ""30""
}"
firebase_last_notification,"{
  ""set_timestamp_micros"": 1494813899942000,
  ""string_value"": ""4857993083614758445""
}"
firebase_exp_4,"{
  ""set_timestamp_micros"": 1530589572284000,
  ""string_value"": ""1""
}"
plays_progressive,"{
  ""set_timestamp_micros"": 1476917467314000,
  ""string_value"": ""true""
}"
firebase_exp_1,"{
  ""set_timestamp_micros"": 1530589572283000,
  ""string_value"": ""0""
}"
first_open_time,"{
  ""int_value"": 1476908354977000,
  ""set_timestamp_micros"": 1476908266977000
}"
ad_frequency,"{
  ""set_timestamp_micros"": 1482378833491000,
  ""string_value"": ""2""
}"
initial_extra_steps,"{
  ""set_timestamp_micros"": 1477369258231000,
  ""string_value"": ""3""
}"
plays_quickplay,"{
  ""set_timestamp_micros"": 1476908516411000,
  ""string_value"": ""true""
}"
num_levels_available,"{
  ""set_timestamp_micros"": 1530592265519000,
  ""string_value"": ""30""
}"
firebase_last_notification,"{
  ""set_timestamp_micros"": 1494813927942000,
  ""string_value"": ""4857993083614758445""
}"
firebase_exp_4,"{
  ""set_timestamp_micros"": 1530589600284000,
  ""string_value"": ""1""
}"
plays_progressive,"{
  ""set_timestamp_micros"": 1476917495314000,
  ""string_value"": ""true""
}"
firebase_exp_1,"{
  ""set_timestamp_micros"": 1530589600283000,
  ""string_value"": ""0""
}"
first_open_time,"{
  ""int_value"": 1476908354977000,
  ""set_timestamp_micros"": 1476908294977000
}"
ad_frequency,"{
  ""set_timestamp_micros"": 1482378862491000,
  ""string_value"": ""2""
}"
initial_extra_steps,"{
  ""set_timestamp_micros"": 1477369287231000,
  ""string_value"": ""3""
}"
plays_quickplay,"{
  ""set_timestamp_micros"": 1476908545411000,
  ""string_value"": ""true""
}"
num_levels_available,"{
  ""set_timestamp_micros"": 1530592294519000,
  ""string_value"": ""30""
}"
firebase_last_notification,"{
  ""set_timestamp_micros"": 1494813956942000,
  ""string_value"": ""4857993083614758445""
}"
firebase_exp_4,"{
  ""set_timestamp_micros"": 1530589629284000,
  ""string_value"": ""1""
}"
plays_progressive,"{
  ""set_timestamp_micros"": 1476917524314000,
  ""string_value"": ""true""
}"
firebase_exp_1,"{
  ""set_timestamp_micros"": 1530589629283000,
  ""string_value"": ""0""
}"
first_open_time,"{
  ""int_value"": 1476908354977000,
  ""set_timestamp_micros"": 1476908323977000
}"
ad_frequency,"{
  ""set_timestamp_micros"": 1482378809491000,
  ""string_value"": ""2""
}"
initial_extra_steps,"{
  ""set_timestamp_micros"": 1477369234231000,
  ""string_value"": ""3""
}"
plays_quickplay,"{
  ""set_timestamp_micros"": 1476908492411000,
  ""string_value"": ""true""
}"
num_levels_available,"{
  ""set_timestamp_micros"": 1530589574174000,
  ""string_value"": ""30""
}"
firebase_last_notification,"{
  ""set_timestamp_micros"": 1494813903942000,
  ""string_value"": ""4857993083614758445""
}"
firebase_exp_4,"{
  ""set_timestamp_micros"": 1530589576284000,
  ""string_value"": ""1""
}"
plays_progressive,"{
  ""set_timestamp_micros"": 1476917471314000,
  ""string_value"": ""true""
}"
firebase_exp_1,"{
  ""set_timestamp_micros"": 1530589576283000,
  ""string_value"": ""0""
}"
first_open_time,"{
  ""int_value"": 1476908354977000,
  ""set_timestamp_micros"": 1476908270977000
}"
ad_frequency,"{
  ""set_timestamp_micros"": 1482378863491000,
  ""string_value"": ""2""
}"
initial_extra_steps,"{
  ""set_timestamp_micros"": 1477369288231000,
  ""string_value"": ""3""
}"
plays_quickplay,"{
  ""set_timestamp_micros"": 1476908546411000,
  ""string_value"": ""true""
}"
num_levels_available,"{
  ""set_timestamp_micros"": 1530589628174000,
  ""string_value"": ""30""
}"
firebase_last_notification,"{
  ""set_timestamp_micros"": 1494813957942000,
  ""string_value"": ""4857993083614758445""
}"
firebase_exp_4,"{
  ""set_timestamp_micros"": 1530589630284000,
  ""string_value"": ""1""
}"
plays_progressive,"{
  ""set_timestamp_micros"": 1476917525314000,
  ""string_value"": ""true""
}"
firebase_exp_1,"{
  ""set_timestamp_micros"": 1530589630283000,
  ""string_value"": ""0""
}"
first_open_time,"{
  ""int_value"": 1476908354977000,
  ""set_timestamp_micros"": 1476908324977000
}"
ad_frequency,"{
  ""set_timestamp_micros"": 1482378852491000,
  ""string_value"": ""2""
}"
initial_extra_steps,"{
  ""set_timestamp_micros"": 1477369277231000,
  ""string_value"": ""3""
}"
plays_quickplay,"{
  ""set_timestamp_micros"": 1476908535411000,
  ""string_value"": ""true""
}"
num_levels_available,"{
  ""set_timestamp_micros"": 1530589617174000,
  ""string_value"": ""30""
}"
firebase_last_notification,"{
  ""set_timestamp_micros"": 1494813946942000,
  ""string_value"": ""48579930

2025-01-23 17:14:47 - root - INFO - itercount: 0
2025-01-23 17:14:47 - root - INFO - Database Name: FIREBASE
Schema Name: ANALYTICS_153293282
DDL describes table information.
,0
table_name,EVENTS_20180613
description,
DDL,"create or replace TABLE EVENTS_20180613 (
	""event_date"" VARCHAR(16777216),
	""event_timestamp"" NUMBER(38,0),
	""event_name"" VARCHAR(16777216),
	""event_params"" VARIANT,
	""event_previous_timestamp"" NUMBER(38,0),
	""user_id"" VARCHAR(16777216),
	""user_pseudo_id"" VARCHAR(16777216),
	""user_properties"" VARIANT,
	""user_first_touch_timestamp"" NUMBER(38,0),
	""user_ltv"" VARIANT,
	""device"" VARIANT,
	""geo"" VARIANT,
	""app_info"" VARIANT,
	""traffic_source"" VARIANT,
	""stream_id"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']
External knowledge that might be helpful: 
How to Calculate User Retention in Big Query from Google Demo Game Analytics Data

As a Product / Website Analyst, I was pretty psyched to discover Google’s public Google Analytics 4 (GA4) gaming event dataset called `firebase-public-project.analytics_153293282.events_*`. The table allows experienced developers and learners alike to experiment with raw GA4 data in Big Query for free. Event data is basically a log of user interactions with your product for analysis .For newbies interested in learning more about event data and GA4, visit my prior blog. This article provides SQL queries for a quick table overview and explains how to utilize Google Big Query to calculate user retention.


What is Retention?
User retention rates are key indicators for whether your product team meets user needs. Improving retention is often central to long term growth strategies.

**Retention measure’s how often and for how long users tend to return to your product.**

The metric can be a powerful proxy for product usefulness and user opinion. Its analysis can reveal critical information like how well your site converts new visitors to users and which items and features are associated with users coming back. If user data is available, retention can also help a business understand the profiles of its most active users (power users). Finally, retention is a great guardrail metric for A/B tests. Successful, product oriented companies prioritize a healthy user bases over short term profits.


**Common Retention Calculation Strategies**

Two common strategies to calculate retention are: 

a) N-Day retention

b) Unbounded Retention.


a) For N-Day retention, analysts calculate how many users with certain characteristics return over successive periods. It is called N days because we define the length of each period. For example, with N=7 day retention, if User A becomes part of our cohort of interest on day 0 and returns to the product day 5 and day 15, they are counted as retained for week 1 (1–7 days) and week 3 (15–21 days) but not week 2 (8–14 days).


b) For Unbounded Retention, a user is counted as retained each week so long as their most recent product contact was after the week. For example, if User A becomes part of the cohort on day 0 and last returned to the site on day 21, they will be counted as retained in week 1 (1–7 days), week 2 (8–14 days), and week 3 (15–21 days) but not week 4 (22–28 days).

By calculating these metrics, companies can evaluate how well their products hold users’ interests. It also them closer to identifying the patterns that generate return users.



The table structure information is ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}
Begin Exploring Related Columns
**Columns and their potential usage:**

- **"user_pseudo_id"**: Used to uniquely identify users; helps track individual users across events.
- **"user_first_touch_timestamp"**: Indicates when a user first used the app; used to find users who first used the app during the week starting July 2, 2018.
- **"event_timestamp"**: Timestamp of each event; used to determine user activity for retention analysis.
- **"event_date"**: Date of the event in 'YYYYMMDD' format; useful for grouping events by date.
- **"event_name"**: Name of the event; can filter specific types of events.
- **"event_params"**: VARIANT column containing event parameters; may include additional event details.
- **"user_properties"**: VARIANT column containing user properties; may include extra user information.
- **"platform"**: Platform used by the user; could filter data by platform.
- **"device"**: VARIANT column containing device information; useful for device-based analysis.

**Conditions that may be used:**

- **"user_first_touch_timestamp"** between **1530489600000000** and **1531094400000000** (timestamps for July 2, 2018 to July 9, 2018) to identify new users during that week.
- Filtering **"event_timestamp"** for specific date ranges to analyze user retention in subsequent weeks.

---

**SQL Queries:**

1. **Retrieve distinct user IDs from July 2, 2018:**
   ```sql
   SELECT DISTINCT "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   LIMIT 100;
   ```

2. **Get user IDs and their first touch timestamps during the week starting July 2, 2018:**
   ```sql
   SELECT "user_pseudo_id", "user_first_touch_timestamp"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   WHERE "user_first_touch_timestamp" >= 1530489600000000
     AND "user_first_touch_timestamp" < 1531094400000000
   LIMIT 100;
   ```

3. **Count of events by event name on July 2, 2018:**
   ```sql
   SELECT "event_name", COUNT(*) AS event_count
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   GROUP BY "event_name"
   ORDER BY event_count DESC
   LIMIT 100;
   ```

4. **List distinct platforms used on July 2, 2018:**
   ```sql
   SELECT DISTINCT "platform"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   LIMIT 100;
   ```

5. **Inspect the "event_params" column by flattening it:**
   ```sql
   SELECT f.value
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702" t,
        LATERAL FLATTEN(input => t."event_params") f
   LIMIT 100;
   ```

6. **Retrieve distinct event dates from the table:**
   ```sql
   SELECT DISTINCT "event_date"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   LIMIT 100;
   ```

7. **Count of events per user on July 2, 2018:**
   ```sql
   SELECT "user_pseudo_id", COUNT(*) AS event_count
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   GROUP BY "user_pseudo_id"
   ORDER BY event_count DESC
   LIMIT 100;
   ```

8. **Get users and event timestamps during the week starting July 2, 2018:**
   ```sql
   SELECT "user_pseudo_id", "event_timestamp"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   WHERE "event_timestamp" >= 1530489600000000
     AND "event_timestamp" < 1531094400000000
   LIMIT 100;
   ```

9. **Inspect the "user_properties" column by flattening it:**
   ```sql
   SELECT f.value
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702" t,
        LATERAL FLATTEN(input => t."user_properties") f
   LIMIT 100;
   ```

10. **Retrieve distinct device brands and models used on July 2, 2018:**
    ```sql
    SELECT DISTINCT t."device":brand::STRING AS "device_brand", t."device":model::STRING AS "device_model"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702" t
    LIMIT 100;
    ```Query:
SELECT DISTINCT "user_pseudo_id"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   LIMIT 100;
Answer:
user_pseudo_id
654F30C1312F6C1A26DFDA9F076A62D8
65D7715C409E6A38667447CE2B52AFFE
B205B117C82A24AA95E663FFB7D04718
EF9E8CCCCBBB015CAE0C334AB1745417
83D8C7F90DAF2C832F05A9DDD8693135
093642BD46204EB5F950303CE696BC18
0F67E233B19D2898229CD156974A93AE
5217AB1A454DAED6243E1C9818BE6A20
C6EAD483A8AF7EE9B0ADE6D7CE5DD698
58230465C695B0FDDDAE08A481FAEECC
38D4084307B6D1CEA37A48981753428E
0373DF7959F6867CDFB1C905D39CE67C
D34924C19421D7E083FD387D97765F94
C136A7CE1D0A52B8D4E5F144DF114EB7
4BF98D09CA8359FC59ADAF56D00338F8
08D399C66188D9A356AFAD5E2B2BA45E
49309C5759610DBF6C829C0D4AB23943
909A16079F7183140ACF4C71A6CCDF3D
3031EAD1E9D35306A37A0F3DC3B84A0A
3A58859E074B02E8FB1CAEA291636112
706C748E6D1E0768BFEFE6362B5D3F67
F815B0069F973BFA743EF90A85224109
D0F280B12652EB0D74F6BC74AB13606F
3EF8FC940E379D53BBD3FEFDAF626BB2
E6FEE8B98E75EA5311FE004F98559A27
50FEAE9ECFE22E951E8810622A2E8F66
4A47422A455E62E3529DE4F9F3BFAF66
4948BEDE78FC6EBA9899F26BF5C53897
88A41BFED275BB69125BE1F5524F3B42
A064A84CD3CF7058F39333D6212E8615
A87A30159D909E2356F72AAC76F26707
7AE4084BAA29B1987E51BF2964646805
5CDFC86835249BE3DB5E9F6778E344AD
7842C62D45ECE888132F21C9F4417B21
7101B4232F5B26A9C987C54F8717DCDC
29845B6298FB882DF53607D21F0E1DF7
76BB576278338D2E508DE5D705241B47
7207044281C74501C14233463AAD9A71
4BDC831A6940071E2461D0B5293A329E
A74EFE8BDAC26101B308D57A18B746CF
037DAC225F0C1E54657770CD201CDDA7
936906C2CB90CE437DBFC01BBD96BA39
D7EA8E3645EFFBD6443946179ED704A6
53866E32BA0ABFD846772D4B7B9B5921
257A35EA0A92B4B2F8FB4BA3F8B4C3D8
11A8D6037368A4C4508B11ADB4353BC4
C87CDC0C4F86B10B7467281D516929B5
028CAE01A9F16A228177C973451441A1
4CE503AE5B4C4F67A00474CE380CCC39
2304B486B11E4CFFA0BB8AC8F2F5F4B6
CE7404D5A8831F2DE46BD0A013A8ED64
60CFF65B640769B6FD3BC9593EDF7C1D
EBFE0623EF1109A89B392B9DF4375951
664F913ED3B54941B5F0886D94E01623
5D5895B1267014C54ECBE08864420979
92B0B6F48ECE132C7E502F94798FE205
05407E04B9FA64CB63D8FA1D966AD6A2
4D084D38156128AAA060303AA91E689D
E2D6E7FE36B7CDD0789CC8F03CC747E0
2F5B044B41268F6643EB4D0EF15D4E87
E8710E77072D6674A93E46DFEF725587
672B24B51143CC66DCBAA0FA88C38D57
2F8E2DBB938D2E43C2D171AF5F35EEF8
DE4912FBC5F915C027000A8A6FF44F85
48AB910A8DE8485D4C34238EA61F782C
92BF054A90804B6D65F11D7CDFCDDEFC
3DEB0C12C49AD19D7ACE68FA59E7ACD6
B7701369F8598A25DED0499DAD3BE85D
64BA3BB3BD757CE7000D38CB7125E6DA
E50F7AC0680FD87AD6CE6B6700D209A7
7D613AF4DA0F508C7090E96FD73B7E6D
C795AFA7F574C2BB09D3647AD90A9719
FEDC59699D8832A11B88BFCCCAD0951D
59454BAC415BB1F18517C6FD2C023E49
E451D416F972019604F1456533FF3858
AFE7A3E11C66E71FA9EA7B138700EC44
B75F91EB6C7FDA9A329567E763CF9E44
D739D483CCD20D4651E4A75ADEE94064
7480AE90D76538F44A066A153F448198
8EDB9A9856CDB5AFC42546106EE46734
3EDE8E7A50DE76AA2EC12DDD2AE3F9F4
CA04708DA02378999ECB402481FF1AE4
3D03A380687FE3369E93915D50C572CB
EA9A16D9042286D55399A418CC7A28F3
117AD1627465CC9E03AB5D8825D42E07
01562149DD13E75D732F0A9CA2D8CF5C
8320FC247A1967E7C0CDFC1502241310
5E694DE02688C2FDDEA38A6946A4CC3F
60FAC27D8495BF33C2AE5283A7B07005
4DA8863CD8D2C860F6BB73579BC6F5C9
97E7144B7FA861C3C8DB7424D7039832
DD695F4DCB9694F4E026B78E17BD7945
8040FC9C0479C3B9A74ED298DD8F357D
920DB84FCC0F4421650B9E257E33180B
AE920B86560554C0BE3F888EDBA2BBF7
27859DA5E38F4C681DA4FBF0CFB9F306
84D135997D8A4D9CB35D4ECA46EF6861
2F5BBABE9DD0271DCD62E501F76DA736
D3F06F9B7BD9D7FC8758BF78BF0705E9
2B1A8699D5D9CC85A21E5AD20A5F1278
Query:
SELECT "user_pseudo_id", "user_first_touch_timestamp"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   WHERE "user_first_touch_timestamp" >= 1530489600000000
     AND "user_first_touch_timestamp" < 1531094400000000
   LIMIT 100;
Answer:
Too long, hard cut:
user_pseudo_id,user_first_touch_timestamp
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
E2D6E7FE
Query:
SELECT "event_name", COUNT(*) AS event_count
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   GROUP BY "event_name"
   ORDER BY event_count DESC
   LIMIT 100;
Answer:
event_name,EVENT_COUNT
screen_view,20378
user_engagement,11605
level_start_quickplay,4493
level_end_quickplay,3068
post_score,2144
level_complete_quickplay,1896
level_fail_quickplay,1173
select_content,942
level_reset_quickplay,916
session_start,621
level_start,560
level_end,396
level_retry_quickplay,387
level_retry,357
level_up,248
level_complete,229
level_fail,148
spend_virtual_currency,85
level_reset,72
use_extra_steps,55
app_exception,54
firebase_campaign,38
first_open,27
no_more_extra_steps,22
os_update,19
ad_reward,18
error,15
app_remove,13
completed_5_levels,11
app_update,8
app_clear_data,1
challenge_a_friend,1
Query:
SELECT DISTINCT "platform"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   LIMIT 100;
Answer:
platform
ANDROID
IOS
Query:
SELECT f.value
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702" t,
        LATERAL FLATTEN(input => t."event_params") f
   LIMIT 100;
Answer:
Too long, hard cut:
VALUE
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8126232848982224228
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8126232848982224228
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490845
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FloodItActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490838
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490838
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""FloodItActivity""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""ExtraStepsActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490799
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490799
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""shop_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490798
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""ExtraStepsActivity""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490798
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""shop_menu""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""GameFinishedActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490785
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490785
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_over""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"
Query:
SELECT DISTINCT "event_date"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   LIMIT 100;
Answer:
event_date
20180702
Query:
SELECT "user_pseudo_id", COUNT(*) AS event_count
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   GROUP BY "user_pseudo_id"
   ORDER BY event_count DESC
   LIMIT 100;
Answer:
user_pseudo_id,EVENT_COUNT
CC88655DF7CDE5E8225BA20B5D6EC59B,2759
C8685B0DFA2C4B4E6E6EA72894C30F6F,2145
39A0592805168E5D5B3C3687A7472628,2043
0B08423CCD5F1503B5A8B306FFED999C,1244
DDF187DB0391034487C7D3B8C681E0B0,1228
FFA9AE78B23263835F8AAED57713EBE9,1066
10B0D468B5E036E16D13DB53A65F2D49,960
12E5626928FE0885DEEF068683E8BD63,819
AD85E945EC909FEF07A21ECB3EFC0693,774
48AB910A8DE8485D4C34238EA61F782C,745
DF0E6C6C5E4F3F34FEC6EE54FD945B05,720
2F74E23BEA1E45E3897274EE4903DCC5,699
4EF964D59282E5A2C8692D30F011256B,685
CABE7E24215A5C36862658A36AE5CE12,674
B63075B53A750A67A12F7F19ED5AA835,646
E99D4AD5E5663BABE4AC08C027C775EF,593
F5DAD8DD17B689CF672D65A0A81CF4AC,529
47216088A078D06F9220263FAF964F10,516
B37EDF42306464D3D96E5A56A03A8CBA,496
92BF054A90804B6D65F11D7CDFCDDEFC,490
53A5A4C271525BAA74298747E100C376,487
472451071AED6FF801BC0FE66706FD27,485
0D17D0247F158FA3E40D21EFF46D1651,478
00D49153E0790E34D76523EEBEF459B2,478
03A9D32C44665A9E15CFCCEDC9F68EDB,459
E53BC2A0AD86417B443AF14EE3082C0F,450
5E09265F12D64B9FA85FF9427A0A7FB0,439
A9C876F6262995184453B40AB7C5233C,422
C6EAD483A8AF7EE9B0ADE6D7CE5DD698,391
F2A1FD8B142EB4C6CAAE415FA1917F50,385
C6DE585349744A40725DB0AB17041BA3,381
1B3AD9683D475EFB398E131DFE65AE61,355
3DEB0C12C49AD19D7ACE68FA59E7ACD6,354
D0F280B12652EB0D74F6BC74AB13606F,347
BE74418BE7B7466F6FE2969CA79FA919,314
0CAAA1B6F161BA4D363EB7A2DEF64A08,312
187F3053F04D9D7EF93DF21DBDB59684,307
79C6CEA7189615EF5319ED1BA55DDE9D,305
D7D49CC32C4A23AD56E8DEAE6878EC7B,303
9FEE80E475ED50AAF174B4F17563C16D,298
08D399C66188D9A356AFAD5E2B2BA45E,287
A37AD550BCBF8C8B1D5616BB5A47770D,286
3875A92B5F5C2BBA1355CED06A986079,261
487DE902636DD8A9844A2D61FE7BD568,258
E080406D26F71C9B8F331779CE8B82BA,253
C639CACA07D03F536F537ED779CF6599,235
4D33ED6DCCD63BBED146B6060B307CAF,232
EBFE0623EF1109A89B392B9DF4375951,232
E2D6E7FE36B7CDD0789CC8F03CC747E0,225
2F5BBABE9DD0271DCD62E501F76DA736,225
D7EA8E3645EFFBD6443946179ED704A6,220
654F30C1312F6C1A26DFDA9F076A62D8,212
EF500E0CF578004836D1D38C8901862B,211
09FCF0FC0E0F04B3DD8DFE96DA57DDF6,209
CFA0F8C5E25A71062E573EF8E6BC9F76,203
74375465CD17299EBC7C75A1B4047EE0,196
38D4084307B6D1CEA37A48981753428E,195
1213ED1E96B0A49B51C0F7683DB2ACCC,193
42E6A7C3536775E3B8C3DB919AE9A452,189
05FB3382D94C7E963B408FD6CC357D33,187
9DE945166BCD4709696C5836317DDE47,186
5217AB1A454DAED6243E1C9818BE6A20,186
0AF862AFEB5358EBFDA7AFE3AC908844,183
418C1FE4FF01EA36F511E5D9073F11BD,179
193D4BFCCCDED344EE4C2A2809BF685F,178
372D9BB5088C4E9000C65B06459B403A,177
5CC434A43CB09640FC6BE2D7A18183E4,176
091770A1325101155A651F90D283DA35,175
FC48EDE912EDD9F8D7ED45F697EE7193,175
78119035B1798D27E62402E7ADB498BC,172
50D8D0C89D69EDAE2F04E43E90DB59C1,168
8320FC247A1967E7C0CDFC1502241310,167
16B0F6645F896C16F83EF56A99868801,166
898B790ACC7834117A9B2C98A8B6F1F5,162
83D8C7F90DAF2C832F05A9DDD8693135,151
3D03A380687FE3369E93915D50C572CB,150
B9BC9A430E79917967EFBEF5B1915199,146
19DEEA6B15B314DB0ED2A4936959D8F9,146
64BA3BB3BD757CE7000D38CB7125E6DA,142
31D7BB4CF721D8676B85F73077F4304E,142
2304B486B11E4CFFA0BB8AC8F2F5F4B6,141
1F0D27B8A7E058446D4A6409E2E73B19,141
FE46EFC1DA3F3159AD9343EC53466F3F,141
2B7787A34C362AA51FF8E4DD031A2F70,140
018F03084C88E944163F76A0D0C2FBA1,138
BBDAFE02F8160B43C105F79EFFD0DF7F,138
FA30269453141794E79B8F15EE0BA5B9,137
D4F4DAEF5BE38E5C67FD72BB1F082EBF,131
B1A46F0467C18F539094677527CB116F,129
EECDCA8076D5842922767F5C08957B17,127
A87A30159D909E2356F72AAC76F26707,124
1D7DE8A95370FDCB698B25F1E424C91D,120
A0616D4E494DC3BCCB94B8B6E5B48380,120
62D571096D5393BFB10F2D55DA2FC28C,117
7AE4084BAA29B1987E51BF2964646805,117
CA04708DA02378999ECB402481FF1AE4,110
C089DEEB2EA27CF072D17A89C956AFF3,110
D4C8E3E0EFC45C3D60AB3F0F305489AF,109
5E694DE02688C2FDDEA38A6946A4CC3F,108
6EDA0BB1611F7E5AB409221AE13ED52E,107
Query:
SELECT "user_pseudo_id", "event_timestamp"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
   WHERE "event_timestamp" >= 1530489600000000
     AND "event_timestamp" < 1531094400000000
   LIMIT 100;
Answer:
Too long, hard cut:
user_pseudo_id,event_timestamp
654F30C1312F6C1A26DFDA9F076A62D8,1530590034397045
654F30C1312F6C1A26DFDA9F076A62D8,1530592878437030
654F30C1312F6C1A26DFDA9F076A62D8,1530593467343003
654F30C1312F6C1A26DFDA9F076A62D8,1530589584539000
654F30C1312F6C1A26DFDA9F076A62D8,1530589632251002
654F30C1312F6C1A26DFDA9F076A62D8,1530589621295003
654F30C1312F6C1A26DFDA9F076A62D8,1530589675882001
654F30C1312F6C1A26DFDA9F076A62D8,1530589645899002
654F30C1312F6C1A26DFDA9F076A62D8,1530589700545007
654F30C1312F6C1A26DFDA9F076A62D8,1530589717674010
654F30C1312F6C1A26DFDA9F076A62D8,1530589696738011
654F30C1312F6C1A26DFDA9F076A62D8,1530589706400014
654F30C1312F6C1A26DFDA9F076A62D8,1530589836110019
654F30C1312F6C1A26DFDA9F076A62D8,1530589847132020
654F30C1312F6C1A26DFDA9F076A62D8,1530589838235024
654F30C1312F6C1A26DFDA9F076A62D8,1530589814532029
654F30C1312F6C1A26DFDA9F076A62D8,1530589844144032
654F30C1312F6C1A26DFDA9F076A62D8,1530589814394036
654F30C1312F6C1A26DFDA9F076A62D8,1530589876455037
654F30C1312F6C1A26DFDA9F076A62D8,1530589830110041
654F30C1312F6C1A26DFDA9F076A62D8,1530590080491048
654F30C1312F6C1A26DFDA9F076A62D8,1530590065505049
654F30C1312F6C1A26DFDA9F076A62D8,1530590096070052
654F30C1312F6C1A26DFDA9F076A62D8,1530592287744001
654F30C1312F6C1A26DFDA9F076A62D8,1530592270898005
654F30C1312F6C1A26DFDA9F076A62D8,1530592316934006
654F30C1312F6C1A26DFDA9F076A62D8,1530592322992011
654F30C1312F6C1A26DFDA9F076A62D8,1530592373007012
654F30C1312F6C1A26DFDA9F076A62D8,1530592377282017
654F30C1312F6C1A26DFDA9F076A62D8,1530592353412019
654F30C1312F6C1A26DFDA9F076A62D8,1530592366448020
654F30C1312F6C1A26DFDA9F076A62D8,1530592339807023
654F30C1312F6C1A26DFDA9F076A62D8,1530592933554034
654F30C1312F6C1A26DFDA9F076A62D8,1530592938568035
654F30C1312F6C1A26DFDA9F076A62D8,1530592921111037
654F30C1312F6C1A26DFDA9F076A62D8,1530592998341042
654F30C1312F6C1A26DFDA9F076A62D8,1530592957361043
654F30C1312F6C1A26DFDA9F076A62D8,1530592915792046
654F30C1312F6C1A26DFDA9F076A62D8,1530592907991050
654F30C1312F6C1A26DFDA9F076A62D8,1530592942033051
654F30C1312F6C1A26DFDA9F076A62D8,1530592978137055
654F30C1312F6C1A26DFDA9F076A62D8,1530593045413060
654F30C1312F6C1A26DFDA9F076A62D8,1530593045432061
654F30C1312F6C1A26DFDA9F076A62D8,1530593051856066
654F30C1312F6C1A26DFDA9F076A62D8,1530592972033068
654F30C1312F6C1A26DFDA9F076A62D8,1530593051127069
654F30C1312F6C1A26DFDA9F076A62D8,1530593021215072
654F30C1312F6C1A26DFDA9F076A62D8,1530593118573078
654F30C1312F6C1A26DFDA9F076A62D8,1530593090595079
654F30C1312F6C1A26DFDA9F076A62D8,1530593122106084
654F30C1312F6C1A26DFDA9F076A62D8,1530593109211087
654F30C1312F6C1A26DFDA9F076A62D8,1530593156248088
654F30C1312F6C1A26DFDA9F076A62D8,1530593129881092
654F30C1312F6C1A26DFDA9F076A62D8,1530593139099095
654F30C1312F6C1A26DFDA9F076A62D8,1530593151254103
654F30C1312F6C1A26DFDA9F076A62D8,1530593484478006
654F30C1312F6C1A26DFDA9F076A62D8,1530593456511007
654F30C1312F6C1A26DFDA9F076A62D8,1530593457970010
654F30C1312F6C1A26DFDA9F076A62D8,1530594430889003
654F30C1312F6C1A26DFDA9F076A62D8,1530594497911004
654F30C1312F6C1A26DFDA9F076A62D8,1530594457117009
654F30C1312F6C1A26DFDA9F076A62D8,1530594470195011
654F30C1312F6C1A26DFDA9F076A62D8,1530594524260012
654F30C1312F6C1A26DFDA9F076A62D8,1530594529500017
654F30C1312F6C1A26DFDA9F076A62D8,1530594683769025
654F30C1312F6C1A26DFDA9F076A62D8,1530594679790026
654F30C1312F6C1A26DFDA9F076A62D8,1530594658204030
654F30C1312F6C1A26DFDA9F076A62D8,1530594674511035
654F30C1312F6C1A26DFDA9F076A62D8,1530594687915040
654F30C1312F6C1A26DFDA9F076A62D8,1530594644013043
654F30C1312F6C1A26DFDA9F076A62D8,1530594610050044
654F30C1312F6C1A26DFDA9F076A62D8,1530594639605048
654F30C1312F6C1A26DFDA9F076A62D8,1530594711346056
654F30C1312F6C1A26DFDA9F076A62D8,1530594678359057
654F30C1312F6C1A26DFDA9F076A62D8,1530594723519061
654F30C1312F6C1A26DFDA9F076A62D8,1530594666667065
654F30C1312F6C1A26DFDA9F076A62D8,1530594643714066
654F30C1312F6C1A26DFDA9F076A62D8,1530594659892070
654F30C1312F6C1A26DFDA9F076A62D8,1530594899470080
654F30C1312F6C1A26DFDA9F076A62D8,1530595100189083
654F30C1312F6C1A26DFDA9F076A62D8,1530595084210084
654F30C1312F6C1A26DFDA9F076A62D8,1530595104917088
654F30C1312F6C1A26DFDA9F076A62D8,1530595067950089
654F30C1312F6C1A26DFDA9F076A62D8,1530595167280095
654F30C1312F6C1A26DFDA9F076A62D8,1530595168316096
654F30C1312F6C1A26DFDA9F076A62D8,1530595210727099
654F30C1312F6C1A26DFDA9F076A62D8,1530595166999103
654F30C1312F6C1A26DFDA9F076A62D8,1530595165030104
654F30C1312F6C1A26DFDA9F076A62D8,1530595193168109
654F30C1312F6C1A26DFDA9F076A62D8,1530595261058115
654F30C1312F6C1A26DFDA9F076A62D8,1530595269089116
654F30C1312F6C1A26DFDA9F076A62D8,1530595217832121
654F30C1312F6C1A26DFDA9F076A62D8,1530595199934124
654F30C1312F6C1A26DFDA9F076A62D8,1530595234958125
654F30C1312F6C1A26DFDA9F076A62D8,1530595265081129
654F30C1312F6C1A26DFDA9F076A62D8,1530589687459005
654F30C1312F6C1A26DFDA9F076A62D8,1530589657460006
654F30C1312F6C1A26DFDA9F076A62D8,1530592366202015
654F30C1312F6C1A26DFDA9F076A62D8,1530592294203016
654F30C1312F6C1A26D
Query:
SELECT f.value
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702" t,
        LATERAL FLATTEN(input => t."user_properties") f
   LIMIT 100;
Answer:
Too long, hard cut:
VALUE
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482378805491000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1477369230231000,
    ""string_value"": ""3""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1476908488411000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1530589570174000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1494813899942000,
    ""string_value"": ""4857993083614758445""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1530589572284000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1476917467314000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1530589572283000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1476908354977000,
    ""set_timestamp_micros"": 1476908266977000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482378833491000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1477369258231000,
    ""string_value"": ""3""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1476908516411000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1530592265519000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1494813927942000,
    ""string_value"": ""4857993083614758445""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1530589600284000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1476917495314000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1530589600283000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1476908354977000,
    ""set_timestamp_micros"": 1476908294977000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482378862491000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1477369287231000,
    ""string_value"": ""3""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1476908545411000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1530592294519000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1494813956942000,
    ""string_value"": ""4857993083614758445""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1530589629284000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1476917524314000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1530589629283000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1476908354977000,
    ""set_timestamp_micros"": 1476908323977000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482378809491000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1477369234231000,
    ""string_value"": ""3""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1476908492411000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1530589574174000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1494813903942000,
    ""string_value"": ""4857993083614758445""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1530589576284000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1476917471314000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1530589576283000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1476908354977000,
    ""set_timestamp_micros"": 1476908270977000
  }
}"
"{
  "
Query:
SELECT DISTINCT
    t."device"['mobile_brand_name']::STRING AS "device_brand",
    t."device"['mobile_model_name']::STRING AS "device_model"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702" t
LIMIT 100;
Answer:
device_brand,device_model
not available in demo dataset,not available in demo dataset
Query:
SELECT
    f.value:"key"::STRING AS "param_key",
    f.value:"value" AS "param_value"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702" t,
     LATERAL FLATTEN(input => t."event_params") f
LIMIT 100
Answer:
Too long, hard cut:
param_key,param_value
value,"{
  ""int_value"": 22
}"
firebase_screen_class,"{
  ""string_value"": ""game_board""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490837
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 22
}"
firebase_screen_class,"{
  ""string_value"": ""game_board""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 8126232848982224228
}"
board,"{
  ""string_value"": ""S""
}"
value,"{
  ""int_value"": 22
}"
firebase_screen_class,"{
  ""string_value"": ""game_board""
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
firebase_screen_id,"{
  ""int_value"": 8126232848982224228
}"
board,"{
  ""string_value"": ""S""
}"
firebase_conversion,"{
  ""int_value"": 1
}"
firebase_screen_class,"{
  ""string_value"": ""game_board""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490837
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490845
}"
firebase_screen_class,"{
  ""string_value"": ""FloodItActivity""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490838
}"
firebase_previous_class,"{
  ""string_value"": ""main_menu""
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490838
}"
firebase_screen_class,"{
  ""string_value"": ""game_board""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490837
}"
firebase_previous_class,"{
  ""string_value"": ""FloodItActivity""
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490837
}"
firebase_screen_class,"{
  ""string_value"": ""ExtraStepsActivity""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490799
}"
firebase_previous_class,"{
  ""string_value"": ""game_board""
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490799
}"
firebase_screen_class,"{
  ""string_value"": ""shop_menu""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490798
}"
firebase_previous_class,"{
  ""string_value"": ""ExtraStepsActivity""
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490798
}"
firebase_screen_class,"{
  ""string_value"": ""game_board""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490837
}"
firebase_previous_class,"{
  ""string_value"": ""shop_menu""
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490837
}"
firebase_screen_class,"{
  ""string_value"": ""GameFinishedActivity""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490785
}"
firebase_previous_class,"{
  ""string_value"": ""game_board""
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490785
}"
firebase_screen_class,"{
  ""string_value"": ""game_over""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490784
}"
firebase_previous_class,"{
  ""string_value"": ""GameFinishedActivity""
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490784
}"
firebase_screen_class,"{
  ""string_value"": ""game_board""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490837
}"
firebase_previous_class,"{
  ""string_value"": ""game_over""
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490837
}"
firebase_screen_class,"{
  ""string_value"": ""ExtraStepsActivity""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490728
}"
firebase_previous_class,"{
  ""string_value"": ""game_board""
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490728
}"
firebase_screen_class,"{
  ""string_value"": ""shop_menu""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490727
}"
firebase_previous_class,"{
  ""string_value"": ""ExtraStepsActivity""
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490727
}"
firebase_screen_class,"{
  ""string_value"": ""AdActivity""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490717
}"
firebase_previous_class,"{
  ""string_value"": ""shop_menu""
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490717
}"
firebase_screen_class,"{
  ""string_value"": ""shop_menu""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": -3260873074173490727
}"
firebase_previous_class,"{
  ""string_value"": ""AdActivity""
}"
firebase_previous_id,"{
  ""int_value"": -3260873074173490727
}"
firebase_screen_class,"{
  ""string_value"": ""game_board""
}"
firebase_event_origin,"{
  ""string_value"": "
Query:
SELECT
    f.value:"key"::STRING AS "property_key",
    f.value:"value" AS "property_value"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702" t,
     LATERAL FLATTEN(input => t."user_properties") f
LIMIT 100
Answer:
Too long, hard cut:
property_key,property_value
ad_frequency,"{
  ""set_timestamp_micros"": 1482378805491000,
  ""string_value"": ""2""
}"
initial_extra_steps,"{
  ""set_timestamp_micros"": 1477369230231000,
  ""string_value"": ""3""
}"
plays_quickplay,"{
  ""set_timestamp_micros"": 1476908488411000,
  ""string_value"": ""true""
}"
num_levels_available,"{
  ""set_timestamp_micros"": 1530589570174000,
  ""string_value"": ""30""
}"
firebase_last_notification,"{
  ""set_timestamp_micros"": 1494813899942000,
  ""string_value"": ""4857993083614758445""
}"
firebase_exp_4,"{
  ""set_timestamp_micros"": 1530589572284000,
  ""string_value"": ""1""
}"
plays_progressive,"{
  ""set_timestamp_micros"": 1476917467314000,
  ""string_value"": ""true""
}"
firebase_exp_1,"{
  ""set_timestamp_micros"": 1530589572283000,
  ""string_value"": ""0""
}"
first_open_time,"{
  ""int_value"": 1476908354977000,
  ""set_timestamp_micros"": 1476908266977000
}"
ad_frequency,"{
  ""set_timestamp_micros"": 1482378833491000,
  ""string_value"": ""2""
}"
initial_extra_steps,"{
  ""set_timestamp_micros"": 1477369258231000,
  ""string_value"": ""3""
}"
plays_quickplay,"{
  ""set_timestamp_micros"": 1476908516411000,
  ""string_value"": ""true""
}"
num_levels_available,"{
  ""set_timestamp_micros"": 1530592265519000,
  ""string_value"": ""30""
}"
firebase_last_notification,"{
  ""set_timestamp_micros"": 1494813927942000,
  ""string_value"": ""4857993083614758445""
}"
firebase_exp_4,"{
  ""set_timestamp_micros"": 1530589600284000,
  ""string_value"": ""1""
}"
plays_progressive,"{
  ""set_timestamp_micros"": 1476917495314000,
  ""string_value"": ""true""
}"
firebase_exp_1,"{
  ""set_timestamp_micros"": 1530589600283000,
  ""string_value"": ""0""
}"
first_open_time,"{
  ""int_value"": 1476908354977000,
  ""set_timestamp_micros"": 1476908294977000
}"
ad_frequency,"{
  ""set_timestamp_micros"": 1482378862491000,
  ""string_value"": ""2""
}"
initial_extra_steps,"{
  ""set_timestamp_micros"": 1477369287231000,
  ""string_value"": ""3""
}"
plays_quickplay,"{
  ""set_timestamp_micros"": 1476908545411000,
  ""string_value"": ""true""
}"
num_levels_available,"{
  ""set_timestamp_micros"": 1530592294519000,
  ""string_value"": ""30""
}"
firebase_last_notification,"{
  ""set_timestamp_micros"": 1494813956942000,
  ""string_value"": ""4857993083614758445""
}"
firebase_exp_4,"{
  ""set_timestamp_micros"": 1530589629284000,
  ""string_value"": ""1""
}"
plays_progressive,"{
  ""set_timestamp_micros"": 1476917524314000,
  ""string_value"": ""true""
}"
firebase_exp_1,"{
  ""set_timestamp_micros"": 1530589629283000,
  ""string_value"": ""0""
}"
first_open_time,"{
  ""int_value"": 1476908354977000,
  ""set_timestamp_micros"": 1476908323977000
}"
ad_frequency,"{
  ""set_timestamp_micros"": 1482378809491000,
  ""string_value"": ""2""
}"
initial_extra_steps,"{
  ""set_timestamp_micros"": 1477369234231000,
  ""string_value"": ""3""
}"
plays_quickplay,"{
  ""set_timestamp_micros"": 1476908492411000,
  ""string_value"": ""true""
}"
num_levels_available,"{
  ""set_timestamp_micros"": 1530589574174000,
  ""string_value"": ""30""
}"
firebase_last_notification,"{
  ""set_timestamp_micros"": 1494813903942000,
  ""string_value"": ""4857993083614758445""
}"
firebase_exp_4,"{
  ""set_timestamp_micros"": 1530589576284000,
  ""string_value"": ""1""
}"
plays_progressive,"{
  ""set_timestamp_micros"": 1476917471314000,
  ""string_value"": ""true""
}"
firebase_exp_1,"{
  ""set_timestamp_micros"": 1530589576283000,
  ""string_value"": ""0""
}"
first_open_time,"{
  ""int_value"": 1476908354977000,
  ""set_timestamp_micros"": 1476908270977000
}"
ad_frequency,"{
  ""set_timestamp_micros"": 1482378863491000,
  ""string_value"": ""2""
}"
initial_extra_steps,"{
  ""set_timestamp_micros"": 1477369288231000,
  ""string_value"": ""3""
}"
plays_quickplay,"{
  ""set_timestamp_micros"": 1476908546411000,
  ""string_value"": ""true""
}"
num_levels_available,"{
  ""set_timestamp_micros"": 1530589628174000,
  ""string_value"": ""30""
}"
firebase_last_notification,"{
  ""set_timestamp_micros"": 1494813957942000,
  ""string_value"": ""4857993083614758445""
}"
firebase_exp_4,"{
  ""set_timestamp_micros"": 1530589630284000,
  ""string_value"": ""1""
}"
plays_progressive,"{
  ""set_timestamp_micros"": 1476917525314000,
  ""string_value"": ""true""
}"
firebase_exp_1,"{
  ""set_timestamp_micros"": 1530589630283000,
  ""string_value"": ""0""
}"
first_open_time,"{
  ""int_value"": 1476908354977000,
  ""set_timestamp_micros"": 1476908324977000
}"
ad_frequency,"{
  ""set_timestamp_micros"": 1482378852491000,
  ""string_value"": ""2""
}"
initial_extra_steps,"{
  ""set_timestamp_micros"": 1477369277231000,
  ""string_value"": ""3""
}"
plays_quickplay,"{
  ""set_timestamp_micros"": 1476908535411000,
  ""string_value"": ""true""
}"
num_levels_available,"{
  ""set_timestamp_micros"": 1530589617174000,
  ""string_value"": ""30""
}"
firebase_last_notification,"{
  ""set_timestamp_micros"": 1494813946942000,
  ""string_value"": ""48579930
End Exploring Related Columns
Task: Please perform a 7-day retention analysis for users who first used the app during the week starting on July 2, 2018. Provide the total number of these new users and the number of retained users for each week from Week 0 (the initial week) through Week 4.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Week,Total_New_Users,Retained_Users
0,total_new_users:int,retained_users_week0:int
1,,retained_users_week1:int
2,,retained_users_week2:int
3,,retained_users_week3:int
4,,retained_users_week4:int
```

This table provides a 7-day retention analysis for users who first used the app during the week starting on July 2, 2018 (Week 0). "Total_New_Users" represents the total number of new users in the initial week, and "Retained_Users" indicates the number of these users who returned to use the app in each subsequent week from Week 0 through Week 4..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-23 17:19:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 17:19:32 - root - INFO - ```sql
WITH new_users AS (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
        WHERE "user_first_touch_timestamp" >= 1530489600000000 AND "user_first_touch_timestamp" < 1531094400000000
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180703"
        WHERE "user_first_touch_timestamp" >= 1530489600000000 AND "user_first_touch_timestamp" < 1531094400000000
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180704"
        WHERE "user_first_touch_timestamp" >= 1530489600000000 AND "user_first_touch_timestamp" < 1531094400000000
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180705"
        WHERE "user_first_touch_timestamp" >= 1530489600000000 AND "user_first_touch_timestamp" < 1531094400000000
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180706"
        WHERE "user_first_touch_timestamp" >= 1530489600000000 AND "user_first_touch_timestamp" < 1531094400000000
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180707"
        WHERE "user_first_touch_timestamp" >= 1530489600000000 AND "user_first_touch_timestamp" < 1531094400000000
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180708"
        WHERE "user_first_touch_timestamp" >= 1530489600000000 AND "user_first_touch_timestamp" < 1531094400000000
    )
),
events AS (
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180703"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180704"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180705"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180706"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180707"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180708"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180710"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180711"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180712"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180713"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180714"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180715"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180717"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180718"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180719"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180720"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180721"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180722"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180723"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180724"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180725"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180726"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180727"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180728"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180729"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180730"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180731"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180802"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180803"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180804"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180805"
),
user_events AS (
    SELECT
        e."user_pseudo_id",
        FLOOR( ("event_timestamp" - 1530489600000000) / 604800000000 ) AS week_number
    FROM events e
    INNER JOIN new_users nu ON e."user_pseudo_id" = nu."user_pseudo_id"
    WHERE e."event_timestamp" >= 1530489600000000 AND e."event_timestamp" < 1533513600000000
)
SELECT
    week_number AS "Week",
    CASE WHEN week_number = 0 THEN (SELECT COUNT(*) FROM new_users) ELSE NULL END AS "Total_New_Users",
    COUNT(DISTINCT "user_pseudo_id") AS "Retained_Users"
FROM user_events
GROUP BY week_number
ORDER BY week_number;
```
2025-01-23 17:19:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:19:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:19:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:19:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-23 17:19:45 - snowflake.connector.connection - INFO - closed
2025-01-23 17:19:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:19:46 - root - INFO - itercount: 1
2025-01-23 17:19:46 - root - INFO - 0
2025-01-23 17:19:46 - root - INFO - results: 
Week,Total_New_Users,Retained_Users
0,222.0,216
1,,61
2,,37
3,,37
4,,14


2025-01-23 17:19:46 - root - INFO - Please check the answer again by reviewing Please perform a 7-day retention analysis for users who first used the app during the week starting on July 2, 2018. Provide the total number of these new users and the number of retained users for each week from Week 0 (the initial week) through Week 4., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Week,Total_New_Users,Retained_Users
0,total_new_users:int,retained_users_week0:int
1,,retained_users_week1:int
2,,retained_users_week2:int
3,,retained_users_week3:int
4,,retained_users_week4:int
```

This table provides a 7-day retention analysis for users who first used the app during the week starting on July 2, 2018 (Week 0). "Total_New_Users" represents the total number of new users in the initial week, and "Retained_Users" indicates the number of these users who returned to use the app in each subsequent week from Week 0 through Week 4. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Week,Total_New_Users,Retained_Users
0,222.0,216
1,,61
2,,37
3,,37
4,,14
Current sql:
WITH new_users AS (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
        WHERE "user_first_touch_timestamp" >= 1530489600000000 AND "user_first_touch_timestamp" < 1531094400000000
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180703"
        WHERE "user_first_touch_timestamp" >= 1530489600000000 AND "user_first_touch_timestamp" < 1531094400000000
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180704"
        WHERE "user_first_touch_timestamp" >= 1530489600000000 AND "user_first_touch_timestamp" < 1531094400000000
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180705"
        WHERE "user_first_touch_timestamp" >= 1530489600000000 AND "user_first_touch_timestamp" < 1531094400000000
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180706"
        WHERE "user_first_touch_timestamp" >= 1530489600000000 AND "user_first_touch_timestamp" < 1531094400000000
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180707"
        WHERE "user_first_touch_timestamp" >= 1530489600000000 AND "user_first_touch_timestamp" < 1531094400000000
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180708"
        WHERE "user_first_touch_timestamp" >= 1530489600000000 AND "user_first_touch_timestamp" < 1531094400000000
    )
),
events AS (
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180703"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180704"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180705"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180706"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180707"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180708"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180710"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180711"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180712"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180713"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180714"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180715"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180717"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180718"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180719"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180720"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180721"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180722"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180723"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180724"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180725"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180726"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180727"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180728"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180729"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180730"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180731"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180802"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180803"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180804"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180805"
),
user_events AS (
    SELECT
        e."user_pseudo_id",
        FLOOR( ("event_timestamp" - 1530489600000000) / 604800000000 ) AS week_number
    FROM events e
    INNER JOIN new_users nu ON e."user_pseudo_id" = nu."user_pseudo_id"
    WHERE e."event_timestamp" >= 1530489600000000 AND e."event_timestamp" < 1533513600000000
)
SELECT
    week_number AS "Week",
    CASE WHEN week_number = 0 THEN (SELECT COUNT(*) FROM new_users) ELSE NULL END AS "Total_New_Users",
    COUNT(DISTINCT "user_pseudo_id") AS "Retained_Users"
FROM user_events
GROUP BY week_number
ORDER BY week_number;
2025-01-23 17:20:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 17:20:29 - root - INFO - ```sql
WITH new_users AS (
    SELECT DISTINCT "user_pseudo_id"
    FROM (
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
        WHERE "user_first_touch_timestamp" >= 1530489600000000 AND "user_first_touch_timestamp" < 1531094400000000
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180703"
        WHERE "user_first_touch_timestamp" >= 1530489600000000 AND "user_first_touch_timestamp" < 1531094400000000
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180704"
        WHERE "user_first_touch_timestamp" >= 1530489600000000 AND "user_first_touch_timestamp" < 1531094400000000
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180705"
        WHERE "user_first_touch_timestamp" >= 1530489600000000 AND "user_first_touch_timestamp" < 1531094400000000
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180706"
        WHERE "user_first_touch_timestamp" >= 1530489600000000 AND "user_first_touch_timestamp" < 1531094400000000
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180707"
        WHERE "user_first_touch_timestamp" >= 1530489600000000 AND "user_first_touch_timestamp" < 1531094400000000
        UNION ALL
        SELECT "user_pseudo_id", "user_first_touch_timestamp"
        FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180708"
        WHERE "user_first_touch_timestamp" >= 1530489600000000 AND "user_first_touch_timestamp" < 1531094400000000
    )
),
events AS (
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180702"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180703"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180704"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180705"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180706"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180707"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180708"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180710"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180711"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180712"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180713"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180714"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180715"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180717"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180718"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180719"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180720"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180721"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180722"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180723"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180724"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180725"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180726"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180727"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180728"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180729"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180730"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180731"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180802"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180803"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180804"
    UNION ALL
    SELECT "user_pseudo_id", "event_timestamp"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180805"
),
user_events AS (
    SELECT
        e."user_pseudo_id",
        FLOOR( ("event_timestamp" - 1530489600000000) / 604800000000 ) AS week_number
    FROM events e
    INNER JOIN new_users nu ON e."user_pseudo_id" = nu."user_pseudo_id"
    WHERE e."event_timestamp" >= 1530489600000000 AND e."event_timestamp" < 1533513600000000
)
SELECT
    week_number AS "Week",
    CASE WHEN week_number = 0 THEN (SELECT COUNT(*) FROM new_users) ELSE NULL END AS "Total_New_Users",
    COUNT(DISTINCT "user_pseudo_id") AS "Retained_Users"
FROM user_events
GROUP BY week_number
ORDER BY week_number;
```
2025-01-23 17:20:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:20:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:20:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:20:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-23 17:20:31 - snowflake.connector.connection - INFO - closed
2025-01-23 17:20:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:20:31 - root - INFO - itercount: 2
2025-01-23 17:20:31 - root - INFO - 0
2025-01-23 17:20:31 - root - INFO - Total iteration counts: 2
