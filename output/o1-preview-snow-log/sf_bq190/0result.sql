SELECT "gender" AS "Gender", 'Youngest' AS "Age_Type", "age" AS "Age", COUNT(*) AS "Count"
FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE.USERS u
WHERE "created_at" BETWEEN 1546300800000000 AND 1651363200000000
  AND "age" = (
    SELECT MIN("age")
    FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE.USERS
    WHERE "gender" = u."gender"
      AND "created_at" BETWEEN 1546300800000000 AND 1651363200000000
  )
GROUP BY "gender", "age"

UNION ALL

SELECT "gender" AS "Gender", 'Oldest' AS "Age_Type", "age" AS "Age", COUNT(*) AS "Count"
FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE.USERS u
WHERE "created_at" BETWEEN 1546300800000000 AND 1651363200000000
  AND "age" = (
    SELECT MAX("age")
    FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE.USERS
    WHERE "gender" = u."gender"
      AND "created_at" BETWEEN 1546300800000000 AND 1651363200000000
  )
GROUP BY "gender", "age";