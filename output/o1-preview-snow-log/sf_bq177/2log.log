2025-01-27 01:17:16 - openai._base_client - INFO - Retrying request to /chat/completions in 0.430980 seconds
2025-01-27 01:18:58 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:18:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:18:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:18:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:18:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 01:18:59 - snowflake.connector.connection - INFO - closed
2025-01-27 01:18:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:19:00 - root - INFO - SQL:
SELECT DISTINCT "provider_id", "provider_name"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
   LIMIT 100;
Results:
provider_id,provider_name
220024,HOLYOKE MEDICAL CENTER
220015,"COOLEY DICKINSON HOSPITAL INC,THE"
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER
220050,BAYSTATE MARY LANE HOSPITAL
220065,NOBLE HOSPITAL
220066,MERCY MEDICAL CENTER
220077,BAYSTATE MEDICAL CENTER
220046,BERKSHIRE MEDICAL CENTER INC
220051,NORTH ADAMS REGIONAL HOSPITAL
220016,BAYSTATE FRANKLIN MEDICAL CENTER
220098,NASHOBA VALLEY MEDICAL CENTER
220095,HEYWOOD HOSPITAL
220058,CLINTON HOSPITAL ASSOCIATION
220019,HARRINGTON MEMORIAL HOSPITAL
220062,ADCARE HOSPITAL OF WORCESTER INC
220163,UMASS MEMORIAL MEDICAL CENTER INC
220176,ST VINCENT HOSPITAL
220084,EMERSON HOSPITAL
220049,MARLBOROUGH HOSPITAL
220090,MILFORD REGIONAL MEDICAL CENTER
220174,MERRIMACK VALLEY HOSPITAL
220010,LAWRENCE GENERAL HOSPITAL
220080,HOLY FAMILY HOSPITAL
220063,LOWELL GENERAL HOSPITAL
220105,WINCHESTER HOSPITAL
220029,ANNA JAQUES HOSPITAL
220126,NORWOOD HOSPITAL
220071,MASSACHUSETTS GENERAL HOSPITAL
220110,BRIGHAM AND WOMEN'S HOSPITAL
220017,CARNEY HOSPITAL
220119,FAULKNER HOSPITAL
220002,MOUNT AUBURN HOSPITAL
220011,CAMBRIDGE HEALTH ALLIANCE
220070,HALLMARK HEALTH SYSTEM
220111,GOOD SAMARITAN MEDICAL CENTER
220060,JORDAN HOSPITAL INC
220083,BETH ISRAEL DEACONESS HOSPITAL - NEEDHAM
220135,FALMOUTH HOSPITAL
220177,NANTUCKET COTTAGE HOSPITAL
220008,STURDY MEMORIAL HOSPITAL
220108,MILTON HOSPITAL INC
410007,RHODE ISLAND HOSPITAL
410005,ST JOSEPH HEALTH SERVICES OF RI
410004,ROGER WILLIAMS MEDICAL CENTER
300011,ST JOSEPH HOSPITAL
300020,SOUTHERN NH MEDICAL CENTER
300034,CATHOLIC MEDICAL CENTER
300003,MARY HITCHCOCK MEMORIAL HOSPITAL
200020,YORK HOSPITAL
200025,PARKVIEW ADVENTIST MEDICAL CENTER
200033,EASTERN MAINE MEDICAL CENTER
200063,PENOBSCOT BAY MEDICAL CENTER
70029,BRISTOL HOSPITAL
70007,LAWRENCE & MEMORIAL HOSPITAL
70028,ST VINCENT'S MEDICAL CENTER
70016,SAINT MARYS HOSPITAL
300018,WENTWORTH-DOUGLASS HOSPITAL
200018,"AROOSTOOK MEDICAL CENTER,THE"
470012,SOUTHWESTERN VERMONT MEDICAL CENTER
470005,RUTLAND REGIONAL MEDICAL CENTER
220001,"HEALTHALLIANCE HOSPITALS, INC"
220175,METROWEST MEDICAL CENTER
220171,LAHEY CLINIC HOSPITAL
220082,SAINTS  MEDICAL CENTER INC
220035,NORTH SHORE MEDICAL CENTER
220033,BEVERLY HOSPITAL CORPORATION
220116,TUFTS MEDICAL CENTER
220031,BOSTON MEDICAL CENTER CORPORATION
220088,NEW ENGLAND BAPTIST HOSPITAL
220036,ST ELIZABETH'S MEDICAL CENTER
220067,QUINCY MEDICAL CENTER
220086,BETH ISRAEL DEACONESS MEDICAL CENTER
220052,SIGNATURE HEALTHCARE BROCKTON HOSPITAL
220012,CAPE COD HOSPITAL
220074,"SOUTHCOAST HOSPITAL GROUP, INC"
220073,MORTON HOSPITAL
220100,SOUTH SHORE HOSPITAL
220101,NEWTON-WELLESLEY HOSPITAL
220020,SAINT ANNE'S HOSPITAL
410006,NEWPORT HOSPITAL
410001,MEMORIAL HOSPITAL OF RHODE ISLAND
410009,KENT COUNTY MEMORIAL HOSPITAL
410013,WESTERLY HOSPITAL
410010,WOMEN AND INFANTS HOSPITAL OF RHODE ISLAND
410012,MIRIAM HOSPITAL
300017,PARKLAND MEDICAL CENTER
300012,ELLIOT HOSPITAL
300001,CONCORD HOSPITAL
300014,FRISBIE MEMORIAL HOSPITAL
200021,MID COAST HOSPITAL
200040,HENRIETTA D GOODALL HOSPITAL
200009,MAINE MEDICAL CENTER
200039,MAINE GENERAL MEDICAL CENTER
200001,ST JOSEPH HOSPITAL
200002,MILES MEMORIAL HOSPITAL (LINCOLN COUNTY HEALTHCARE
470003,FLETCHER ALLEN HOSPITAL OF VERMONT
470001,CENTRAL VERMONT MEDICAL CENTER
70035,"HOSPITAL OF CENTRAL CONNECTICUT, THE"
70004,SHARON HOSPITAL
70008,JOHNSON MEMORIAL HOSPITAL

2025-01-27 01:19:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:19:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:19:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:19:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 01:19:01 - snowflake.connector.connection - INFO - closed
2025-01-27 01:19:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:19:01 - root - INFO - SQL:
SELECT "provider_id", "provider_name",
          SUM("total_discharges" * "average_total_payments") AS "total_inpatient_revenue_2011"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
   GROUP BY "provider_id", "provider_name"
   ORDER BY "total_inpatient_revenue_2011" DESC
   LIMIT 100;
Results:
provider_id,provider_name,total_inpatient_revenue_2011
330101,NEW YORK-PRESBYTERIAN HOSPITAL,287006757.0
100007,FLORIDA HOSPITAL,236106766.0
330059,MONTEFIORE MEDICAL CENTER,208603789.0
330024,MOUNT SINAI HOSPITAL,188955531.0
50625,CEDARS-SINAI MEDICAL CENTER,159543492.0
80001,"CHRISTIANA CARE HEALTH SERVICES, INC.",158686352.0
230130,WILLIAM BEAUMONT HOSPITAL,158201049.0
330106,NORTH SHORE UNIVERSITY HOSPITAL,152498639.0
450388,METHODIST HOSPITAL,151670130.0
330194,MAIMONIDES MEDICAL CENTER,149749450.0
440049,METHODIST HEALTHCARE MEMPHIS HOSPITALS,148678630.0
330169,BETH ISRAEL MEDICAL CENTER,146609305.0
220071,MASSACHUSETTS GENERAL HOSPITAL,132983841.0
340040,PITT COUNTY MEMORIAL HOSPITAL,130107306.0
70022,YALE-NEW HAVEN HOSPITAL,128263319.0
150056,INDIANA UNIVERSITY HEALTH,125790667.0
220074,"SOUTHCOAST HOSPITAL GROUP, INC",124538409.0
220163,UMASS MEMORIAL MEDICAL CENTER INC,120490110.0
450184,MEMORIAL HERMANN HOSPITAL SYSTEM,119153867.0
210009,"JOHNS HOPKINS HOSPITAL, THE",118949853.0
180088,"NORTON HOSPITALS, INC",115682499.0
390164,UPMC PRESBYTERIAN SHADYSIDE,114697586.0
260032,BARNES JEWISH HOSPITAL,112153697.0
230038,SPECTRUM HEALTH - BUTTERWORTH CAMPUS,112107466.0
340002,MEMORIAL MISSION HOSPITAL AND ASHEVILLE SURGERY CE,110925492.0
70025,HARTFORD HOSPITAL,109215356.0
520138,AURORA ST LUKES MEDICAL CENTER,108371892.0
340141,NEW HANOVER REGIONAL MEDICAL CENTER,107806806.0
140208,ADVOCATE CHRIST HOSPITAL & MEDICAL CENTER,107397883.0
330214,NYU HOSPITALS CENTER,106850886.0
230046,UNIVERSITY OF MICHIGAN HEALTH SYSTEM,106663879.0
450058,BAPTIST MEDICAL CENTER,104489926.0
90011,WASHINGTON HOSPITAL CENTER,104375731.0
220086,BETH ISRAEL DEACONESS MEDICAL CENTER,103950459.0
340047,NORTH CAROLINA BAPTIST HOSPITAL,102816499.0
360180,CLEVELAND CLINIC,102573197.0
140281,NORTHWESTERN MEMORIAL HOSPITAL,102168939.0
310001,HACKENSACK UNIVERSITY MEDICAL CENTER,102146464.0
240010,MAYO CLINIC - SAINT MARYS HOSPITAL,102067487.0
10039,HUNTSVILLE HOSPITAL,101014268.0
340069,"WAKEMED, RALEIGH CAMPUS",100912550.0
140010,EVANSTON HOSPITAL,100417946.0
330055,NEW YORK HOSPITAL MEDICAL CENTER OF QUEENS,100256873.0
100006,ORLANDO HEALTH,100213330.0
220110,BRIGHAM AND WOMEN'S HOSPITAL,99580878.0
340030,DUKE UNIVERSITY HOSPITAL,97223488.0
450358,"METHODIST HOSPITAL,THE",96178331.0
390133,LEHIGH VALLEY HOSPITAL,96166260.0
230019,PROVIDENCE HOSPITAL AND MEDICAL CENTERS,95744868.0
340113,CAROLINAS MEDICAL CENTER/BEHAV HEALTH,94546115.0
450021,BAYLOR UNIVERSITY MEDICAL CENTER,94214537.0
230020,OAKWOOD HOSPITAL AND MEDICAL CENTER,94185983.0
310015,MORRISTOWN MEMORIAL HOSPITAL,93107613.0
340091,"MOSES H CONE MEMORIAL HOSPITAL, THE",92686902.0
230165,ST JOHN HOSPITAL AND MEDICAL CENTER,92391213.0
310019,ST JOSEPH'S REGIONAL MEDICAL CENTER,91903500.0
180040,JEWISH HOSPITAL & ST MARY'S HEALTHCARE,91613033.0
70002,ST FRANCIS HOSPITAL & MEDICAL CENTER,91576178.0
390174,THOMAS JEFFERSON UNIVERSITY HOSPITAL,90131241.0
230053,HENRY FORD HOSPITAL,89979364.0
330195,LONG ISLAND JEWISH MEDICAL CENTER,89489617.0
340028,CAPE FEAR VALLEY MEDICAL CENTER,89419708.0
220077,BAYSTATE MEDICAL CENTER,88668772.0
50441,STANFORD HOSPITAL,88351642.0
310041,COMMUNITY MEDICAL CENTER,88323288.0
490024,CARILION ROANOKE MEMORIAL CENTER,88234725.0
210002,UNIVERSITY OF MARYLAND MEDICAL CENTER,87353890.0
510022,CHARLESTON AREA MEDICAL CENTER,87233290.0
330046,ST LUKE'S ROOSEVELT HOSPITAL,86231090.0
240057,ABBOTT NORTHWESTERN HOSPITAL,86172157.0
210019,PENINSULA REGIONAL MEDICAL CENTER,85636306.0
140223,ADVOCATE LUTHERAN GENERAL HOSPITAL,85592480.0
330167,WINTHROP-UNIVERSITY HOSPITAL,85459223.0
490063,INOVA FAIRFAX HOSPITAL,85355497.0
360006,RIVERSIDE METHODIST HOSPITAL,85232973.0
440048,BAPTIST MEMORIAL HOSPITAL,84984866.0
360085,OHIO STATE UNIVERSITY HOSPITALS,84517846.0
310012,VALLEY HOSPITAL,84272889.0
330005,KALEIDA HEALTH,84247952.0
450054,SCOTT & WHITE MEMORIAL HOSPITAL,84240781.0
100018,NAPLES COMMUNITY HOSPITAL,83759988.0
440002,JACKSON-MADISON COUNTY GENERAL HOSPITAL,83069175.0
330393,UNIVERSITY HOSPITAL ( STONY BROOK ),82946072.0
50093,SAINT AGNES MEDICAL CENTER,82560428.0
310038,ROBERT WOOD JOHNSON UNIVERSITY HOSPITAL,82271453.0
170122,VIA CHRISTI HOSPITALS WICHITA INC,81903944.0
100113,SHANDS HOSPITAL AT THE UNIVERSITY OF FLORIDA,80965569.0
330182,"ST FRANCIS HOSPITAL, ROSLYN",80230119.0
200009,MAINE MEDICAL CENTER,80145811.0
330236,NEW YORK METHODIST HOSPITAL,79762500.0
310022,VIRTUA WEST JERSEY HOSPITALS BERLIN,79126449.0
230195,ST JOHN MACOMB-OAKLAND HOSPITAL-MACOMB CENTER,79117019.0
210015,FRANKLIN SQUARE HOSPITAL CENTER,79071899.0
230156,ST JOSEPH MERCY HOSPITAL,78638709.0
70001,HOSPITAL OF ST RAPHAEL,78566571.0
310086,KENNEDY UNIVERSITY HOSPITAL - STRATFORD DIV,78479038.0
100040,ST VINCENT'S MEDICAL CENTER,78294990.0
100022,JACKSON MEMORIAL HOSPITAL,77993809.0
210023,ANNE ARUNDEL MEDICAL CENTER,77971454.0
110107,MEDICAL CENTER OF CENTRAL GEORGIA,77729238.0

2025-01-27 01:19:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:19:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:19:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:19:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 01:19:03 - snowflake.connector.connection - INFO - closed
2025-01-27 01:19:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:19:03 - root - INFO - SQL:
SELECT "provider_id", "provider_name",
          SUM("total_discharges" * "average_total_payments") AS "total_inpatient_revenue_2012"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
   GROUP BY "provider_id", "provider_name"
   ORDER BY "total_inpatient_revenue_2012" DESC
   LIMIT 100;
Results:
provider_id,provider_name,total_inpatient_revenue_2012
330101,NEW YORK-PRESBYTERIAN HOSPITAL,285114945.0
100007,FLORIDA HOSPITAL,234210737.0
330059,MONTEFIORE MEDICAL CENTER,192931148.0
330024,MOUNT SINAI HOSPITAL,179984221.0
50625,CEDARS-SINAI MEDICAL CENTER,171459554.0
80001,"CHRISTIANA CARE HEALTH SERVICES, INC.",162558615.0
230130,BEAUMONT HEALTH SYSTEM,161286044.0
440049,METHODIST HEALTHCARE MEMPHIS HOSPITALS,157578858.0
450388,METHODIST HOSPITAL,151690857.0
220071,MASSACHUSETTS GENERAL HOSPITAL,146085816.0
330169,BETH ISRAEL MEDICAL CENTER,144363177.0
340040,VIDANT MEDICAL CENTER,141118643.0
330106,NORTH SHORE UNIVERSITY HOSPITAL,136461896.0
330194,MAIMONIDES MEDICAL CENTER,131920569.0
70022,YALE-NEW HAVEN HOSPITAL,131206144.0
150056,INDIANA UNIVERSITY HEALTH,130064375.0
220074,"SOUTHCOAST HOSPITAL GROUP, INC",123622708.0
180088,"NORTON HOSPITALS, INC",122549213.0
450184,MEMORIAL HERMANN HOSPITAL SYSTEM,121836837.0
90011,WASHINGTON HOSPITAL CENTER,121316912.0
260032,BARNES JEWISH HOSPITAL,119130269.0
210009,"JOHNS HOPKINS HOSPITAL, THE",117688373.0
220163,UMASS MEMORIAL MEDICAL CENTER INC,116391785.0
520138,AURORA ST LUKES MEDICAL CENTER,113506499.0
220077,BAYSTATE MEDICAL CENTER,112867812.0
390164,UPMC PRESBYTERIAN SHADYSIDE,112866695.0
340141,NEW HANOVER REGIONAL MEDICAL CENTER,112258584.0
340002,MEMORIAL MISSION HOSPITAL AND ASHEVILLE SURGERY CE,111843592.0
70025,HARTFORD HOSPITAL,111640786.0
230038,SPECTRUM HEALTH - BUTTERWORTH CAMPUS,108714543.0
360180,CLEVELAND CLINIC,107873796.0
140208,ADVOCATE CHRIST HOSPITAL & MEDICAL CENTER,107005222.0
450058,BAPTIST MEDICAL CENTER,104955929.0
330214,NYU HOSPITALS CENTER,104586079.0
10039,HUNTSVILLE HOSPITAL,103136104.0
140010,EVANSTON HOSPITAL,102586818.0
220110,BRIGHAM AND WOMEN'S HOSPITAL,101351960.0
240010,MAYO CLINIC-ST MARY'S HOSPITAL,100816777.0
390174,THOMAS JEFFERSON UNIVERSITY HOSPITAL,100078872.0
310001,HACKENSACK UNIVERSITY MEDICAL CENTER,98741428.0
230053,HENRY FORD HOSPITAL,98688921.0
330055,NEW YORK HOSPITAL MEDICAL CENTER OF QUEENS,98356754.0
340113,CAROLINAS MEDICAL CENTER/BEHAV HEALTH,97565317.0
310015,MORRISTOWN MEMORIAL HOSPITAL,97369298.0
340047,NORTH CAROLINA BAPTIST HOSPITAL,96134223.0
450358,"METHODIST HOSPITAL,THE",95812427.0
230046,UNIVERSITY OF MICHIGAN HEALTH SYSTEM,95423401.0
510022,CHARLESTON AREA MEDICAL CENTER,94552667.0
310019,ST JOSEPH'S REGIONAL MEDICAL CENTER,93999281.0
220086,BETH ISRAEL DEACONESS MEDICAL CENTER,93822799.0
390133,LEHIGH VALLEY HOSPITAL,93785848.0
140281,NORTHWESTERN MEMORIAL HOSPITAL,93423450.0
490024,CARILION ROANOKE MEMORIAL CENTER,93265892.0
340069,"WAKEMED, RALEIGH CAMPUS",92874553.0
340030,DUKE UNIVERSITY HOSPITAL,92602498.0
230019,PROVIDENCE HOSPITAL AND MEDICAL CENTERS,91909320.0
450021,BAYLOR UNIVERSITY MEDICAL CENTER,91761937.0
340028,CAPE FEAR VALLEY MEDICAL CENTER,91446690.0
330195,LONG ISLAND JEWISH MEDICAL CENTER,90946109.0
50441,STANFORD HOSPITAL,90721261.0
230020,OAKWOOD HOSPITAL AND MEDICAL CENTER,90692850.0
180040,JEWISH HOSPITAL & ST MARY'S HEALTHCARE,90612850.0
100006,ORLANDO HEALTH,90299971.0
450054,SCOTT & WHITE MEMORIAL HOSPITAL,90053030.0
70002,ST FRANCIS HOSPITAL & MEDICAL CENTER,89450734.0
340091,"MOSES H CONE MEMORIAL HOSPITAL, THE",89167456.0
330393,UNIVERSITY HOSPITAL ( STONY BROOK ),88908511.0
240057,ABBOTT NORTHWESTERN HOSPITAL,88515216.0
100113,SHANDS HOSPITAL AT THE UNIVERSITY OF FLORIDA,88350775.0
230165,ST JOHN HOSPITAL AND MEDICAL CENTER,87915432.0
210002,UNIVERSITY OF MARYLAND MEDICAL CENTER,86779644.0
210023,ANNE ARUNDEL MEDICAL CENTER,86567188.0
440002,JACKSON-MADISON COUNTY GENERAL HOSPITAL,85627337.0
360006,RIVERSIDE METHODIST HOSPITAL,85499107.0
490063,INOVA FAIRFAX HOSPITAL,85389656.0
310041,COMMUNITY MEDICAL CENTER,85337683.0
210015,MEDSTAR FRANKLIN SQUARE MEDICAL CENTER,84807465.0
50599,UNIVERSITY OF CALIFORNIA DAVIS MEDICAL CENTER,84439107.0
140119,RUSH UNIVERSITY MEDICAL CENTER,84004864.0
440048,BAPTIST MEMORIAL HOSPITAL,83928207.0
140223,ADVOCATE LUTHERAN GENERAL HOSPITAL,83601189.0
330046,ST LUKE'S ROOSEVELT HOSPITAL,82819362.0
490009,UNIVERSITY OF VIRGINIA MEDICAL CENTER,82413600.0
330270,HOSPITAL FOR SPECIAL SURGERY,81963908.0
330167,WINTHROP-UNIVERSITY HOSPITAL,81948195.0
310022,VIRTUA WEST JERSEY HOSPITALS BERLIN,81707906.0
170122,VIA CHRISTI HOSPITALS WICHITA INC,81336177.0
310086,KENNEDY UNIVERSITY HOSPITAL - STRATFORD DIV,81103680.0
100018,NAPLES COMMUNITY HOSPITAL,80876164.0
230195,ST JOHN MACOMB-OAKLAND HOSPITAL-MACOMB CENTER,80803832.0
360085,OHIO STATE UNIVERSITY HOSPITALS,80682970.0
210019,PENINSULA REGIONAL MEDICAL CENTER,80660933.0
330236,NEW YORK METHODIST HOSPITAL,80546365.0
330160,STATEN ISLAND UNIVERSITY HOSPITAL,80529254.0
330005,KALEIDA HEALTH,79772122.0
310038,ROBERT WOOD JOHNSON UNIVERSITY HOSPITAL,79664519.0
140148,MEMORIAL MEDICAL CENTER,79603078.0
310064,ATLANTICARE REGIONAL MEDICAL CENTER - CITY DIV,79519069.0
50093,SAINT AGNES MEDICAL CENTER,79446259.0
310012,VALLEY HOSPITAL,79172502.0

2025-01-27 01:19:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:19:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:19:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:19:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 01:19:06 - snowflake.connector.connection - INFO - closed
2025-01-27 01:19:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:19:06 - root - INFO - SQL:
SELECT "provider_id",
          SUM("total_inpatient_revenue") AS "total_inpatient_revenue_2011_2015"
   FROM (
       SELECT "provider_id", ("total_discharges" * "average_total_payments") AS "total_inpatient_revenue"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
       UNION ALL
       SELECT "provider_id", ("total_discharges" * "average_total_payments")
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
       UNION ALL
       SELECT "provider_id", ("total_discharges" * "average_total_payments")
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
       UNION ALL
       SELECT "provider_id", ("total_discharges" * "average_total_payments")
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
       UNION ALL
       SELECT "provider_id", ("total_discharges" * "average_total_payments")
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
   ) t
   GROUP BY "provider_id"
   ORDER BY "total_inpatient_revenue_2011_2015" DESC
   LIMIT 100;
Results:
provider_id,total_inpatient_revenue_2011_2015
330101,2282865349.0
100007,1640460214.0
50625,1278370678.0
70022,1266793190.0
330024,1245238816.0
330059,1206841725.0
240010,1167940231.0
220071,1139343529.0
80001,1112560956.0
210009,1070654820.0
360180,985777033.0
260032,980346302.0
230130,976338094.0
450388,963109880.0
440049,943909035.0
150056,920588674.0
340040,914678048.0
330106,909806897.0
220110,895839452.0
230046,889701146.0
390164,863366325.0
210002,844581282.0
50441,837021992.0
90011,834616305.0
340030,809228562.0
330194,797549243.0
180088,782130671.0
450358,780256555.0
340113,762607839.0
330169,759844600.0
310015,756140078.0
70025,747142668.0
390174,736331602.0
220163,728073433.0
520138,725723430.0
450184,720513309.0
340141,716902724.0
50454,712635158.0
220086,708427427.0
330214,707228540.0
220074,696884989.0
220077,694486952.0
230038,687679261.0
340002,686775705.0
490009,684161697.0
390111,683283967.0
140208,681869740.0
340047,680491265.0
100113,678178467.0
310001,674282093.0
140281,672613807.0
450021,665633358.0
140010,660320098.0
330393,652598220.0
10039,642247328.0
10033,629952126.0
490063,629840792.0
450058,620299095.0
490024,615515105.0
390133,614049849.0
230053,610380857.0
240057,608648992.0
140119,598598096.0
50599,596595350.0
360085,593723365.0
510022,586456219.0
520098,577866823.0
310038,577866216.0
100006,577179265.0
440039,576975205.0
180067,572339284.0
450054,572245570.0
330167,569376855.0
440048,563611190.0
360006,561515525.0
490032,559195927.0
230019,542394649.0
330270,537339956.0
100128,537234265.0
100022,536435352.0
340061,533756180.0
180040,530535822.0
70002,527643273.0
300003,522546728.0
330195,521698542.0
210012,519382812.0
310019,518248442.0
50262,517872734.0
330055,516671197.0
200009,513109257.0
230020,511869375.0
450193,507651343.0
330005,507247596.0
160058,504699264.0
420004,504392891.0
340091,503585762.0
240036,499364870.0
410007,493440297.0
310022,491565550.0
150084,490265432.0

2025-01-27 01:19:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:19:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:19:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:19:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-27 01:19:08 - snowflake.connector.connection - INFO - closed
2025-01-27 01:19:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:19:09 - root - INFO - SQL:
SELECT "provider_id",
          SUM("total_inpatient_revenue") AS "total_inpatient_revenue_2011_2015"
   FROM (
       SELECT "provider_id", ("total_discharges" * "average_total_payments") AS "total_inpatient_revenue"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
       UNION ALL
       SELECT "provider_id", ("total_discharges" * "average_total_payments")
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
       UNION ALL
       SELECT "provider_id", ("total_discharges" * "average_total_payments")
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
       UNION ALL
       SELECT "provider_id", ("total_discharges" * "average_total_payments")
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
       UNION ALL
       SELECT "provider_id", ("total_discharges" * "average_total_payments")
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
   ) t
   GROUP BY "provider_id"
   ORDER BY "total_inpatient_revenue_2011_2015" DESC
   LIMIT 1;
Results:
provider_id,total_inpatient_revenue_2011_2015
330101,2282865349.0

2025-01-27 01:19:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:19:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:19:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:19:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-27 01:19:10 - snowflake.connector.connection - INFO - closed
2025-01-27 01:19:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:20:24 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:20:24 - root - INFO - ```sql
SELECT
    '2011' AS "Year",
    (SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0)) AS "avg_inpatient_revenue_per_case",
    (SELECT 
        SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0)
     FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
     WHERE "provider_id" = '330101') AS "avg_outpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
WHERE "provider_id" = '330101'

UNION ALL

SELECT
    '2012' AS "Year",
    (SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0)) AS "avg_inpatient_revenue_per_case",
    (SELECT 
        SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0)
     FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2012
     WHERE "provider_id" = '330101') AS "avg_outpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
WHERE "provider_id" = '330101'

UNION ALL

SELECT
    '2013' AS "Year",
    (SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0)) AS "avg_inpatient_revenue_per_case",
    (SELECT 
        SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0)
     FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
     WHERE "provider_id" = '330101') AS "avg_outpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
WHERE "provider_id" = '330101'

UNION ALL

SELECT
    '2014' AS "Year",
    (SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0)) AS "avg_inpatient_revenue_per_case",
    (SELECT 
        SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0)
     FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2014
     WHERE "provider_id" = '330101') AS "avg_outpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
WHERE "provider_id" = '330101'

UNION ALL

SELECT
    '2015' AS "Year",
    (SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0)) AS "avg_inpatient_revenue_per_case",
    (SELECT 
        SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0)
     FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2015
     WHERE "provider_id" = '330101') AS "avg_outpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
WHERE "provider_id" = '330101';
```
2025-01-27 01:20:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:20:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:20:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:20:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-27 01:20:26 - snowflake.connector.connection - INFO - closed
2025-01-27 01:20:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:21:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:21:25 - root - INFO - SQL:
SELECT
    '2011' AS "Year",
    (SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0)) AS "avg_inpatient_revenue_per_case",
    (SELECT 
        SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0)
     FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
     WHERE "provider_id" = '330101') AS "avg_outpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
WHERE "provider_id" = '330101'

UNION ALL

SELECT
    '2012' AS "Year",
    (SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0)) AS "avg_inpatient_revenue_per_case",
    (SELECT 
        SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0)
     FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2012
     WHERE "provider_id" = '330101') AS "avg_outpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
WHERE "provider_id" = '330101'

UNION ALL

SELECT
    '2013' AS "Year",
    (SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0)) AS "avg_inpatient_revenue_per_case",
    (SELECT 
        SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0)
     FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
     WHERE "provider_id" = '330101') AS "avg_outpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
WHERE "provider_id" = '330101'

UNION ALL

SELECT
    '2014' AS "Year",
    (SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0)) AS "avg_inpatient_revenue_per_case",
    (SELECT 
        SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0)
     FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2014
     WHERE "provider_id" = '330101') AS "avg_outpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
WHERE "provider_id" = '330101'

UNION ALL

SELECT
    '2015' AS "Year",
    (SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0)) AS "avg_inpatient_revenue_per_case",
    (SELECT 
        SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0)
     FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2015
     WHERE "provider_id" = '330101') AS "avg_outpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
WHERE "provider_id" = '330101';
Results:
Year,avg_inpatient_revenue_per_case,avg_outpatient_revenue_per_case
2011,17049.231139360818,119.62067299
2012,17535.82292883941,119.009406919
2013,18180.65937184662,117.280394466
2014,27803.58699030563,143.493669187
2015,27290.714140469314,147.876775549

2025-01-27 01:21:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:21:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:21:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:21:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-27 01:21:26 - snowflake.connector.connection - INFO - closed
2025-01-27 01:21:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:21:27 - root - INFO - SQL:
SELECT '2011' AS "Year",
       SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0) AS "avg_outpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
WHERE "provider_id" = '330101'
Results:
Year,avg_outpatient_revenue_per_case
2011,119.62067299046934

2025-01-27 01:21:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:21:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:21:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:21:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-27 01:21:28 - snowflake.connector.connection - INFO - closed
2025-01-27 01:21:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:21:29 - root - INFO - SQL:
SELECT '2012' AS "Year",
       SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "avg_inpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
WHERE "provider_id" = '330101'
Results:
Year,avg_inpatient_revenue_per_case
2012,17535.82292883941

2025-01-27 01:21:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:21:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:21:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:21:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-27 01:21:30 - snowflake.connector.connection - INFO - closed
2025-01-27 01:21:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:21:31 - root - INFO - SQL:
SELECT '2012' AS "Year",
       SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0) AS "avg_outpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2012
WHERE "provider_id" = '330101'
Results:
Year,avg_outpatient_revenue_per_case
2012,119.00940691946788

2025-01-27 01:21:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:21:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:21:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:21:32 - snowflake.connector.connection - INFO - closed
2025-01-27 01:21:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:21:57 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:21:57 - root - INFO - The error you're encountering occurs because `'YEAR'` and `'INPATIENT_CHARGES_YEAR'` are placeholders and not actual values or table names in your database. To fix the error, you need to replace `'YEAR'` with the specific year you're querying (e.g., `'2013'`), and replace `'INPATIENT_CHARGES_YEAR'` with the actual table name for that year (e.g., `INPATIENT_CHARGES_2013`).

Here's the corrected SQL query for the year **2013**:

```sql
SELECT '2013' AS "Year",
       SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "avg_inpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
WHERE "provider_id" = '330101';
```

For other years, replace `'2013'` with the desired year and adjust the table name accordingly:

- **For 2011:**

  ```sql
  SELECT '2011' AS "Year",
         SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "avg_inpatient_revenue_per_case"
  FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
  WHERE "provider_id" = '330101';
  ```

- **For 2012:**

  ```sql
  SELECT '2012' AS "Year",
         SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "avg_inpatient_revenue_per_case"
  FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
  WHERE "provider_id" = '330101';
  ```

- **For 2014:**

  ```sql
  SELECT '2014' AS "Year",
         SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "avg_inpatient_revenue_per_case"
  FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
  WHERE "provider_id" = '330101';
  ```

- **For 2015:**

  ```sql
  SELECT '2015' AS "Year",
         SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "avg_inpatient_revenue_per_case"
  FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
  WHERE "provider_id" = '330101';
  ```

Similarly, for outpatient charges, adjust the SQL queries by replacing `'YEAR'` and updating the table name:

**Example for Outpatient Charges in 2013:**

```sql
SELECT '2013' AS "Year",
       SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0) AS "avg_outpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
WHERE "provider_id" = '330101';
```

By replacing the placeholders with actual values, your SQL queries should execute without errors.

**Note:** Ensure that you have access permissions to the specified tables and that the table names are correct in your database.
2025-01-27 01:21:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:21:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:21:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:21:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-27 01:21:59 - snowflake.connector.connection - INFO - closed
2025-01-27 01:21:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:22:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:22:38 - root - INFO - SQL:
SELECT '2013' AS "Year",
       SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "avg_inpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
WHERE "provider_id" = '330101';
Results:
Year,avg_inpatient_revenue_per_case
2013,18180.65937184662

2025-01-27 01:22:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:22:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:22:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:22:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-27 01:22:40 - snowflake.connector.connection - INFO - closed
2025-01-27 01:22:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:22:40 - root - INFO - SQL:
SELECT '2013' AS "Year",
       SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "avg_inpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
WHERE "provider_id" = '330101'
Results:
Year,avg_inpatient_revenue_per_case
2013,18180.65937184662

2025-01-27 01:22:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:22:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:22:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:22:41 - snowflake.connector.connection - INFO - closed
2025-01-27 01:22:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:23:20 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:23:20 - root - INFO - Sure, here are the corrected SQL queries for each of your provided statements:

1. **SQL for calculating average inpatient revenue per case for 2013:**

The original SQL query is correctly formatted and should work if the table exists and you have access. However, ensure that the table name and year are correct.

```sql
SELECT '2013' AS "Year",
       SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "avg_inpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
WHERE "provider_id" = '330101';
```

2. **Corrected SQL for calculating average outpatient revenue per case (replace 'YEAR' placeholder):**

The error occurs because `'YEAR'` and `'OUTPATIENT_CHARGES_YEAR'` are placeholders. Replace them with the actual year and table name. Here's the corrected SQL for the year **2013**:

```sql
SELECT '2013' AS "Year",
       SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0) AS "avg_outpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
WHERE "provider_id" = '330101';
```

3. **SQL for calculating average outpatient revenue per case for 2013:**

This SQL is already correctly formatted:

```sql
SELECT '2013' AS "Year",
       SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0) AS "avg_outpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
WHERE "provider_id" = '330101';
```

---

**Note:** For other years, replace `'2013'` with the desired year and adjust the table names accordingly. For example, for the year **2014**, the SQL query would be:

```sql
SELECT '2014' AS "Year",
       SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0) AS "avg_outpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2014
WHERE "provider_id" = '330101';
```

Make sure that the tables `INPATIENT_CHARGES_2013`, `OUTPATIENT_CHARGES_2013`, etc., exist in the `CMS_DATA.CMS_MEDICARE` schema and that you have the necessary permissions to access them.

Let me know if you need further assistance with these queries!
2025-01-27 01:23:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:23:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:23:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:23:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-27 01:23:21 - snowflake.connector.connection - INFO - closed
2025-01-27 01:23:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:24:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:24:09 - root - INFO - SQL:
SELECT '2013' AS "Year",
       SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "avg_inpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
WHERE "provider_id" = '330101';
Results:
Year,avg_inpatient_revenue_per_case
2013,18180.65937184662

2025-01-27 01:24:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:24:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:24:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:24:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-27 01:24:11 - snowflake.connector.connection - INFO - closed
2025-01-27 01:24:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:24:11 - root - INFO - SQL:
SELECT '2013' AS "Year",
           SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0) AS "avg_outpatient_revenue_per_case"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
    WHERE "provider_id" = '330101'
Results:
Year,avg_outpatient_revenue_per_case
2013,117.28039446570503

2025-01-27 01:24:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:24:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:24:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:24:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-27 01:24:13 - snowflake.connector.connection - INFO - closed
2025-01-27 01:24:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:24:13 - root - INFO - SQL:
SELECT '2014' AS "Year",
           SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0) AS "avg_outpatient_revenue_per_case"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2014
    WHERE "provider_id" = '330101'
Results:
Year,avg_outpatient_revenue_per_case
2014,143.493669187061

2025-01-27 01:24:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:24:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:24:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:24:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-27 01:24:14 - snowflake.connector.connection - INFO - closed
2025-01-27 01:24:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:24:15 - root - INFO - SQL:
SELECT '2013' AS "Year",
           SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0) AS "avg_outpatient_revenue_per_case"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
    WHERE "provider_id" = '330101'
Results:
Year,avg_outpatient_revenue_per_case
2013,117.28039446570503

2025-01-27 01:24:15 - root - INFO - itercount: 0
2025-01-27 01:24:15 - root - INFO - Database Name: CMS_DATA
Schema Name: CMS_CODES
DDL describes table information.
,0
table_name,HCPCS
description,
DDL,"create or replace TABLE HCPCS (
	HCPC VARCHAR(16777216),
	SEQNUM VARCHAR(16777216),
	RECID NUMBER(38,0),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216),
	PRICE1 VARCHAR(16777216),
	PRICE2 VARCHAR(16777216),
	PRICE3 VARCHAR(16777216),
	PRICE4 VARCHAR(16777216),
	MULT_PI VARCHAR(16777216),
	CIM1 VARCHAR(16777216),
	CIM2 VARCHAR(16777216),
	CIM3 VARCHAR(16777216),
	MCM1 FLOAT,
	MCM2 NUMBER(38,0),
	MCM3 VARCHAR(16777216),
	STATUTE VARCHAR(16777216),
	LABCERT1 VARCHAR(16777216),
	LABCERT2 VARCHAR(16777216),
	LABCERT3 VARCHAR(16777216),
	LABCERT4 VARCHAR(16777216),
	LABCERT5 VARCHAR(16777216),
	LABCERT6 VARCHAR(16777216),
	LABCERT7 VARCHAR(16777216),
	LABCERT8 VARCHAR(16777216),
	XREF1 VARCHAR(16777216),
	XREF2 VARCHAR(16777216),
	XREF3 VARCHAR(16777216),
	XREF4 VARCHAR(16777216),
	XREF5 VARCHAR(16777216),
	COV VARCHAR(16777216),
	ASC_GRP VARCHAR(16777216),
	ASC_DT VARCHAR(16777216),
	OPPS VARCHAR(16777216),
	OPPS_PI VARCHAR(16777216),
	OPPS_DT VARCHAR(16777216),
	PROCNOTE VARCHAR(16777216),
	BETOS VARCHAR(16777216),
	TOS1 VARCHAR(16777216),
	TOS2 VARCHAR(16777216),
	TOS3 VARCHAR(16777216),
	TOS4 VARCHAR(16777216),
	TOS5 VARCHAR(16777216),
	ANEST_BU VARCHAR(16777216),
	ADD_DT VARCHAR(16777216),
	ACT_EFF_DT VARCHAR(16777216),
	TERM_DT VARCHAR(16777216),
	ACTION_CD BOOLEAN
);"

,1
table_name,ICD10_PROCEDURES_2019
description,
DDL,"create or replace TABLE ICD10_PROCEDURES_2019 (
	""order_number"" VARCHAR(16777216),
	""pcs_code"" VARCHAR(16777216),
	""is_header_code"" BOOLEAN,
	""short_description"" VARCHAR(16777216),
	""long_description"" VARCHAR(16777216)
);"

,2
table_name,ICD9_DIAGNOSES
description,
DDL,"create or replace TABLE ICD9_DIAGNOSES (
	DIAGNOSIS_CODE VARCHAR(16777216),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216)
);"

,3
table_name,ICD10_DIAGNOSES_2019
description,
DDL,"create or replace TABLE ICD10_DIAGNOSES_2019 (
	""order_number"" VARCHAR(16777216),
	""cm_code"" VARCHAR(16777216),
	""is_header_code"" BOOLEAN,
	""short_description"" VARCHAR(16777216),
	""long_description"" VARCHAR(16777216)
);"

,4
table_name,ICD9_PROCEDURES
description,
DDL,"create or replace TABLE ICD9_PROCEDURES (
	PROCEDURE_CODE VARCHAR(16777216),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_MEDICARE
DDL describes table information.
,0
table_name,HOME_HEALTH_AGENCIES_2013
description,
DDL,"create or replace TABLE HOME_HEALTH_AGENCIES_2013 (
	""provider_id"" VARCHAR(16777216),
	""agency_name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""total_episodes_non_lupa"" NUMBER(38,0),
	""distinct_users_non_lupa"" NUMBER(38,0),
	""total_hha_charge_amount_non_lupa"" NUMBER(38,0),
	""total_hha_medicare_payment_amount_non_lupa"" NUMBER(38,0),
	""total_hha_medicare_standard_payment_amount_non_lupa"" NUMBER(38,0),
	""outlier_payments_as_a_percent_of_medicare_payment_amount_non_lupa"" NUMBER(38,0),
	""total_lupa_episodes"" NUMBER(38,0),
	""total_hha_medicare_payment_amount_for_lupas"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014']
,1
table_name,HOSPICE_PROVIDERS_2014
description,
DDL,"create or replace TABLE HOSPICE_PROVIDERS_2014 (
	""provider_id"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""hrr"" VARCHAR(16777216),
	""hospice_beneficiaries"" NUMBER(38,0),
	""total_days"" NUMBER(38,0),
	""total_medicare_payment_amount"" NUMBER(38,0),
	""total_medicare_standard_payment_amount"" NUMBER(38,0),
	""total_charge_amount"" NUMBER(38,0),
	""percent_routine_home_care_days"" NUMBER(38,0),
	""physician_services"" NUMBER(38,0),
	""home_health_visit_hours_per_day"" FLOAT,
	""skilled_nursing_visit_hours_per_day"" FLOAT,
	""social_service_visit_hours_per_day"" FLOAT,
	""total_live_discharges"" NUMBER(38,0),
	""hospice_beneficiaries_with_seven_or_fewer_hospice_care_days"" NUMBER(38,0),
	""hospice_beneficiaries_with_more_than_sixty_hospice_care_days"" NUMBER(38,0),
	""hospice_beneficiaries_with_more_than_one_hundred_eighty_hospice_care_days"" NUMBER(38,0),
	""home_health_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""skilled_nursing_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""social_service_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""average_age"" FLOAT,
	""male_hospice_beneficiaries"" NUMBER(38,0),
	""female_hospice_beneficiaries"" NUMBER(38,0),
	""white_hospice_beneficiaries"" NUMBER(38,0),
	""black_hospice_beneficiaries"" NUMBER(38,0),
	""asian_hospice_beneficiaries"" NUMBER(38,0),
	""hispanic_hospice_beneficiaries"" NUMBER(38,0),
	""other_unknown_race_hospice_beneficiaries"" NUMBER(38,0),
	""medicare_advantage_hospice_beneficiaries"" NUMBER(38,0),
	""medicaid_eligible_hospice_beneficiaries"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_cancer"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_dementia"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_stroke"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_circulatory_heart_disease"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_respiratory_disease"" NUMBER(38,0),
	""hospice_beneficiaries_with_other_primary_diagnoses"" NUMBER(38,0),
	""site_of_service_home_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_assisted_living_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_long_term_care_or_non_skilled_nursing_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_skilled_nursing_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_inpatient_hospital_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_inpatient_hospice_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_other_facility_hospice_beneficiaries"" NUMBER(38,0)
);"

,2
table_name,HOSPITAL_GENERAL_INFO
description,
DDL,"create or replace TABLE HOSPITAL_GENERAL_INFO (
	""provider_id"" VARCHAR(16777216),
	""hospital_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""phone_number"" VARCHAR(16777216),
	""hospital_type"" VARCHAR(16777216),
	""hospital_ownership"" VARCHAR(16777216),
	""emergency_services"" BOOLEAN,
	""meets_criteria_for_promoting_interoperability_of_ehrs"" BOOLEAN,
	""hospital_overall_rating"" VARCHAR(16777216),
	""hospital_overall_rating_footnote"" VARCHAR(16777216),
	""mortality_group_measure_count"" VARCHAR(16777216),
	""facility_mortaility_measures_count"" VARCHAR(16777216),
	""mortality_measures_better_count"" VARCHAR(16777216),
	""mortality_measures_no_different_count"" VARCHAR(16777216),
	""mortality_measures_worse_count"" VARCHAR(16777216),
	""mortaility_group_footnote"" VARCHAR(16777216),
	""safety_measures_count"" VARCHAR(16777216),
	""facility_care_safety_measures_count"" VARCHAR(16777216),
	""safety_measures_better_count"" VARCHAR(16777216),
	""safety_measures_no_different_count"" VARCHAR(16777216),
	""safety_measures_worse_count"" VARCHAR(16777216),
	""safety_group_footnote"" VARCHAR(16777216),
	""readmission_measures_count"" VARCHAR(16777216),
	""facility_readmission_measures_count"" VARCHAR(16777216),
	""readmission_measures_better_count"" VARCHAR(16777216),
	""readmission_measures_no_different_count"" VARCHAR(16777216),
	""readmission_measures_worse_count"" VARCHAR(16777216),
	""readmission_measures_footnote"" VARCHAR(16777216),
	""patient_experience_measures_count"" VARCHAR(16777216),
	""facility_patient_experience_measures_count"" VARCHAR(16777216),
	""patient_experience_measures_footnote"" VARCHAR(16777216),
	""timely_and_effective_care_measures_count"" VARCHAR(16777216),
	""facility_timely_and_effective_care_measures_count"" VARCHAR(16777216),
	""timely_and_effective_care_measures_footnote"" VARCHAR(16777216)
);"

,3
table_name,INPATIENT_CHARGES_2011
description,
DDL,"create or replace TABLE INPATIENT_CHARGES_2011 (
	""provider_id"" VARCHAR(16777216),
	""provider_name"" VARCHAR(16777216),
	""provider_street_address"" VARCHAR(16777216),
	""provider_city"" VARCHAR(16777216),
	""provider_state"" VARCHAR(16777216),
	""provider_zipcode"" VARCHAR(16777216),
	""drg_definition"" VARCHAR(16777216),
	""hospital_referral_region_description"" VARCHAR(16777216),
	""total_discharges"" NUMBER(38,0),
	""average_covered_charges"" FLOAT,
	""average_total_payments"" FLOAT,
	""average_medicare_payments"" FLOAT
);"

Some other tables have the similar structure: ['INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2015']
,4
table_name,NURSING_FACILITIES_2014
description,
DDL,"create or replace TABLE NURSING_FACILITIES_2014 (
	""provider_id"" VARCHAR(16777216),
	""facility_name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""total_stays"" NUMBER(38,0),
	""distinct_beneficiaries_per_provider"" NUMBER(38,0),
	""average_length_of_stays_days"" FLOAT,
	""total_snf_charge_amount"" NUMBER(38,0),
	""total_snf_medicare_allowed_amount"" NUMBER(38,0),
	""total_snf_medicare_payment_amount"" NUMBER(38,0),
	""total_snf_medicare_standard_payment_amount"" NUMBER(38,0),
	""average_age"" NUMBER(38,0),
	""male_beneficiaries"" NUMBER(38,0),
	""female_beneficiaries"" NUMBER(38,0),
	""nondual_beneficiaries"" NUMBER(38,0),
	""dual_beneficiaries"" NUMBER(38,0),
	""white_beneficiaries"" NUMBER(38,0),
	""black_beneficiaries"" NUMBER(38,0),
	""asian_pacific_islander_beneficiaries"" NUMBER(38,0),
	""hispanic_beneficiaries"" NUMBER(38,0),
	""american_indian_or_alaska_native_beneficiaries"" NUMBER(38,0),
	""other_unknown_beneficiaries"" NUMBER(38,0),
	""average_hcc_score"" FLOAT,
	""percent_of_beneficiaries_with_atrial_fibrillation"" NUMBER(38,0),
	""percent_of_beneficiaries_with_alzheimers"" NUMBER(38,0),
	""percent_of_beneficiaries_with_asthma"" NUMBER(38,0),
	""percent_of_beneficiaries_with_cancer"" NUMBER(38,0),
	""percent_of_beneficiaries_with_chf"" NUMBER(38,0),
	""percent_of_beneficiaries_with_chronic_kidney_disease"" NUMBER(38,0),
	""percent_of_beneficiaries_with_copd"" NUMBER(38,0),
	""percent_of_beneficiaries_with_depression"" NUMBER(38,0),
	""percent_of_beneficiaries_with_diabetes"" NUMBER(38,0),
	""percent_of_beneficiaries_with_hyperlipidemia"" NUMBER(38,0),
	""percent_of_beneficiaries_with_hypertension"" NUMBER(38,0),
	""percent_of_beneficiaries_with_ihd"" NUMBER(38,0),
	""percent_of_beneficiaries_with_osteoporosis"" NUMBER(38,0),
	""percent_of_beneficiaries_with_ra_oa"" NUMBER(38,0),
	""percent_of_beneficiaries_with_schizophrenia"" NUMBER(38,0),
	""percent_of_beneficiaries_with_stroke"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['NURSING_FACILITIES_2014', 'NURSING_FACILITIES_2013']
,5
table_name,OUTPATIENT_CHARGES_2012
description,
DDL,"create or replace TABLE OUTPATIENT_CHARGES_2012 (
	""provider_id"" VARCHAR(16777216),
	""provider_name"" VARCHAR(16777216),
	""provider_street_address"" VARCHAR(16777216),
	""provider_city"" VARCHAR(16777216),
	""provider_state"" VARCHAR(16777216),
	""provider_zipcode"" VARCHAR(16777216),
	""apc"" VARCHAR(16777216),
	""hospital_referral_region"" VARCHAR(16777216),
	""outpatient_services"" NUMBER(38,0),
	""average_estimated_submitted_charges"" FLOAT,
	""average_total_payments"" FLOAT
);"

Some other tables have the similar structure: ['OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2015']
,6
table_name,PART_D_PRESCRIBER_2014
description,
DDL,"create or replace TABLE PART_D_PRESCRIBER_2014 (
	""npi"" VARCHAR(16777216),
	""nppes_provider_last_org_name"" VARCHAR(16777216),
	""nppes_provider_first_name"" VARCHAR(16777216),
	""nppes_provider_city"" VARCHAR(16777216),
	""nppes_provider_state"" VARCHAR(16777216),
	""specialty_description"" VARCHAR(16777216),
	""description_flag"" VARCHAR(16777216),
	""drug_name"" VARCHAR(16777216),
	""generic_name"" VARCHAR(16777216),
	""bene_count"" NUMBER(38,0),
	""total_claim_count"" NUMBER(38,0),
	""total_day_supply"" NUMBER(38,0),
	""total_drug_cost"" FLOAT,
	""bene_count_ge65"" NUMBER(38,0),
	""bene_count_ge65_suppress_flag"" VARCHAR(16777216),
	""total_claim_count_ge65"" NUMBER(38,0),
	""ge65_suppress_flag"" VARCHAR(16777216),
	""total_day_supply_ge65"" NUMBER(38,0),
	""total_drug_cost_ge65"" FLOAT,
	""total_30_day_fill_count"" FLOAT,
	""total_30_day_fill_count_ge65"" FLOAT
);"

,7
table_name,REFERRING_DURABLE_MEDICAL_EQUIP_2013
description,
DDL,"create or replace TABLE REFERRING_DURABLE_MEDICAL_EQUIP_2013 (
	""referring_npi"" VARCHAR(16777216),
	""referring_provider_last_name_organization_name"" VARCHAR(16777216),
	""referring_provider_first_name"" VARCHAR(16777216),
	""referring_provider_middle_initial"" VARCHAR(16777216),
	""referring_provider_credentials"" VARCHAR(16777216),
	""referring_provider_gender"" VARCHAR(16777216),
	""referring_provider_entity_code"" VARCHAR(16777216),
	""referring_provider_street_1"" VARCHAR(16777216),
	""referring_provider_street_2"" VARCHAR(16777216),
	""referring_provider_city"" VARCHAR(16777216),
	""referring_provider_state"" VARCHAR(16777216),
	""referring_provider_zip"" VARCHAR(16777216),
	""referring_provider_country"" VARCHAR(16777216),
	""referring_provider_type"" VARCHAR(16777216),
	""referring_provider_type_flag"" VARCHAR(16777216),
	""number_of_suppliers"" NUMBER(38,0),
	""number_of_supplier_hcpcs"" NUMBER(38,0),
	""number_of_supplier_beneficiaries"" NUMBER(38,0),
	""number_of_supplier_claims"" NUMBER(38,0),
	""number_of_supplier_services"" NUMBER(38,0),
	""supplier_submitted_charges"" FLOAT,
	""supplier_medicare_allowed_amount"" FLOAT,
	""supplier_medicare_payment_amount"" FLOAT,
	""durable_medical_equipment_suppression_indicator"" VARCHAR(16777216),
	""number_of_durable_medical_equipment_suppliers"" NUMBER(38,0),
	""number_of_durable_medical_equipment_hcpcs"" NUMBER(38,0),
	""number_of_durable_medical_equipment_beneficiaries"" NUMBER(38,0),
	""number_of_durable_medical_equipment_claims"" NUMBER(38,0),
	""number_of_durable_medical_equipment_services"" NUMBER(38,0),
	""durable_medical_equipment_submitted_charges"" FLOAT,
	""durable_medical_equipment_medicare_allowed_amount"" FLOAT,
	""durable_medical_equipment_medicare_payment_amount"" FLOAT,
	""prosthetic_and_orthotic_suppression_indicator"" VARCHAR(16777216),
	""number_of_prosthetic_and_orthotic_suppliers"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_hcpcs"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_beneficiaries"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_claims"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_services"" NUMBER(38,0),
	""prosthetic_and_orthotic_submitted_charges"" FLOAT,
	""prosthetic_and_orthotic_medicare_allowed_amount"" FLOAT,
	""prosthetic_and_orthotic_medicare_payment_amount"" FLOAT,
	""drug_and_nutritional_suppression_indicator"" VARCHAR(16777216),
	""number_of_drug_and_nutritional_products_suppliers"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_hcpcs"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_beneficiaries"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_claims"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_services"" NUMBER(38,0),
	""drug_and_nutritional_products_submitted_charges"" FLOAT,
	""drug_and_nutritional_products_medicare_allowed_amount"" FLOAT,
	""drug_and_nutritional_products_medicare_payment_amount"" FLOAT
);"

Some other tables have the similar structure: ['REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014']
,8
table_name,PHYSICIANS_AND_OTHER_SUPPLIER_2015
description,
DDL,"create or replace TABLE PHYSICIANS_AND_OTHER_SUPPLIER_2015 (
	""npi"" VARCHAR(16777216),
	""nppes_provider_last_org_name"" VARCHAR(16777216),
	""nppes_provider_first_name"" VARCHAR(16777216),
	""nppes_provider_mi"" VARCHAR(16777216),
	""nppes_credentials"" VARCHAR(16777216),
	""nppes_provider_gender"" VARCHAR(16777216),
	""nppes_entity_code"" VARCHAR(16777216),
	""nppes_provider_street1"" VARCHAR(16777216),
	""nppes_provider_street2"" VARCHAR(16777216),
	""nppes_provider_city"" VARCHAR(16777216),
	""nppes_provider_zip"" VARCHAR(16777216),
	""nppes_provider_state"" VARCHAR(16777216),
	""nppes_provider_country"" VARCHAR(16777216),
	""provider_type"" VARCHAR(16777216),
	""medicare_participation_indicator"" VARCHAR(16777216),
	""place_of_service"" VARCHAR(16777216),
	""hcpcs_code"" VARCHAR(16777216),
	""hcpcs_description"" VARCHAR(16777216),
	""hcpcs_drug_indicator"" VARCHAR(16777216),
	""line_srvc_cnt"" FLOAT,
	""bene_unique_cnt"" NUMBER(38,0),
	""bene_day_srvc_cnt"" NUMBER(38,0),
	""average_medicare_allowed_amt"" FLOAT,
	""average_submitted_chrg_amt"" FLOAT,
	""average_medicare_payment_amt"" FLOAT,
	""average_medicare_standard_amt"" FLOAT
);"

Some other tables have the similar structure: ['PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014']
Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
DDL describes table information.
,0
table_name,CONDITION_OCCURRENCE
description,
DDL,"create or replace TABLE CONDITION_OCCURRENCE (
	""condition_occurrence_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""condition_concept_id"" NUMBER(38,0),
	""condition_start_date"" DATE,
	""condition_start_datetime"" NUMBER(38,0),
	""condition_end_date"" DATE,
	""condition_end_datetime"" NUMBER(38,0),
	""condition_type_concept_id"" NUMBER(38,0),
	""stop_reason"" VARCHAR(16777216),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""condition_source_value"" VARCHAR(16777216),
	""condition_source_concept_id"" NUMBER(38,0),
	""condition_status_source_value"" VARCHAR(16777216),
	""condition_status_concept_id"" NUMBER(38,0)
);"

,1
table_name,DRUG_ERA
description,
DDL,"create or replace TABLE DRUG_ERA (
	""drug_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""drug_era_start_date"" DATE,
	""drug_era_end_date"" DATE,
	""drug_exposure_count"" NUMBER(38,0),
	""gap_days"" NUMBER(38,0)
);"

,2
table_name,LOCATION
description,
DDL,"create or replace TABLE LOCATION (
	""location_id"" NUMBER(38,0),
	""address_1"" VARCHAR(16777216),
	""address_2"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""location_source_value"" VARCHAR(16777216)
);"

,3
table_name,PERSON
description,
DDL,"create or replace TABLE PERSON (
	""race_concept_id"" NUMBER(38,0),
	""ethnicity_concept_id"" NUMBER(38,0),
	""location_id"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""care_site_id"" NUMBER(38,0),
	""person_source_value"" VARCHAR(16777216),
	""gender_source_value"" VARCHAR(16777216),
	""gender_source_concept_id"" NUMBER(38,0),
	""race_source_value"" VARCHAR(16777216),
	""race_source_concept_id"" NUMBER(38,0),
	""ethnicity_source_value"" VARCHAR(16777216),
	""ethnicity_source_concept_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""gender_concept_id"" NUMBER(38,0),
	""year_of_birth"" NUMBER(38,0),
	""month_of_birth"" NUMBER(38,0),
	""day_of_birth"" NUMBER(38,0),
	""birth_datetime"" NUMBER(38,0)
);"

,4
table_name,CONDITION_ERA
description,
DDL,"create or replace TABLE CONDITION_ERA (
	""condition_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""condition_concept_id"" NUMBER(38,0),
	""condition_era_start_date"" DATE,
	""condition_era_end_date"" DATE,
	""condition_occurrence_count"" NUMBER(38,0)
);"

,5
table_name,DEVICE_EXPOSURE
description,
DDL,"create or replace TABLE DEVICE_EXPOSURE (
	""device_exposure_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""device_concept_id"" NUMBER(38,0),
	""device_exposure_start_date"" DATE,
	""device_exposure_start_datetime"" NUMBER(38,0),
	""device_exposure_end_date"" DATE,
	""device_exposure_end_datetime"" NUMBER(38,0),
	""device_type_concept_id"" NUMBER(38,0),
	""unique_device_id"" VARCHAR(16777216),
	""quantity"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""device_source_value"" VARCHAR(16777216),
	""device_source_concept_id"" NUMBER(38,0)
);"

,6
table_name,DOMAIN
description,
DDL,"create or replace TABLE DOMAIN (
	""domain_id"" VARCHAR(16777216),
	""domain_name"" VARCHAR(16777216),
	""domain_concept_id"" NUMBER(38,0)
);"

,7
table_name,DOSE_ERA
description,
DDL,"create or replace TABLE DOSE_ERA (
	""dose_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""unit_concept_id"" NUMBER(38,0),
	""dose_value"" FLOAT,
	""dose_era_start_date"" DATE,
	""dose_era_end_date"" DATE
);"

,8
table_name,OBSERVATION
description,
DDL,"create or replace TABLE OBSERVATION (
	""observation_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""observation_concept_id"" NUMBER(38,0),
	""observation_date"" DATE,
	""observation_datetime"" NUMBER(38,0),
	""observation_type_concept_id"" NUMBER(38,0),
	""value_as_number"" FLOAT,
	""value_as_string"" VARCHAR(16777216),
	""value_as_concept_id"" NUMBER(38,0),
	""qualifier_concept_id"" NUMBER(38,0),
	""unit_concept_id"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""observation_source_value"" VARCHAR(16777216),
	""observation_source_concept_id"" NUMBER(38,0),
	""unit_source_value"" VARCHAR(16777216),
	""qualifier_source_value"" VARCHAR(16777216)
);"

,9
table_name,COST
description,
DDL,"create or replace TABLE COST (
	""cost_id"" NUMBER(38,0),
	""cost_event_id"" NUMBER(38,0),
	""cost_domain_id"" VARCHAR(16777216),
	""cost_type_concept_id"" NUMBER(38,0),
	""currency_concept_id"" NUMBER(38,0),
	""total_charge"" FLOAT,
	""total_cost"" FLOAT,
	""total_paid"" FLOAT,
	""paid_by_payer"" FLOAT,
	""paid_by_patient"" FLOAT,
	""paid_patient_copay"" FLOAT,
	""paid_patient_coinsurance"" FLOAT,
	""paid_patient_deductible"" FLOAT,
	""paid_by_primary"" FLOAT,
	""paid_ingredient_cost"" FLOAT,
	""paid_dispensing_fee"" FLOAT,
	""payer_plan_period_id"" NUMBER(38,0),
	""amount_allowed"" FLOAT,
	""revenue_code_concept_id"" NUMBER(38,0),
	""revenue_code_source_value"" VARCHAR(16777216),
	""drg_concept_id"" NUMBER(38,0),
	""drg_source_value"" VARCHAR(16777216)
);"

,10
table_name,PROVIDER
description,
DDL,"create or replace TABLE PROVIDER (
	""provider_id"" NUMBER(38,0),
	""provider_name"" VARCHAR(16777216),
	""npi"" VARCHAR(16777216),
	""dea"" VARCHAR(16777216),
	""specialty_concept_id"" NUMBER(38,0),
	""care_site_id"" NUMBER(38,0),
	""year_of_birth"" NUMBER(38,0),
	""gender_concept_id"" NUMBER(38,0),
	""provider_source_value"" VARCHAR(16777216),
	""specialty_source_value"" VARCHAR(16777216),
	""specialty_source_concept_id"" NUMBER(38,0),
	""gender_source_value"" VARCHAR(16777216),
	""gender_source_concept_id"" NUMBER(38,0)
);"

,11
table_name,CARE_SITE
description,
DDL,"create or replace TABLE CARE_SITE (
	""care_site_id"" NUMBER(38,0),
	""care_site_name"" VARCHAR(16777216),
	""place_of_service_concept_id"" NUMBER(38,0),
	""location_id"" NUMBER(38,0),
	""care_site_source_value"" VARCHAR(16777216),
	""place_of_service_source_value"" VARCHAR(16777216)
);"

,12
table_name,CONCEPT_ANCESTOR
description,
DDL,"create or replace TABLE CONCEPT_ANCESTOR (
	""ancestor_concept_id"" NUMBER(38,0),
	""descendant_concept_id"" NUMBER(38,0),
	""min_levels_of_separation"" NUMBER(38,0),
	""max_levels_of_separation"" NUMBER(38,0)
);"

,13
table_name,CONCEPT_RELATIONSHIP
description,
DDL,"create or replace TABLE CONCEPT_RELATIONSHIP (
	""concept_id_1"" NUMBER(38,0),
	""concept_id_2"" NUMBER(38,0),
	""relationship_id"" VARCHAR(16777216),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

,14
table_name,DEATH
description,
DDL,"create or replace TABLE DEATH (
	""person_id"" NUMBER(38,0),
	""death_date"" DATE,
	""death_datetime"" NUMBER(38,0),
	""death_type_concept_id"" NUMBER(38,0),
	""cause_concept_id"" NUMBER(38,0),
	""cause_source_value"" VARCHAR(16777216),
	""cause_source_concept_id"" NUMBER(38,0)
);"

,15
table_name,DRUG_STRENGTH
description,
DDL,"create or replace TABLE DRUG_STRENGTH (
	""drug_concept_id"" NUMBER(38,0),
	""ingredient_concept_id"" NUMBER(38,0),
	""amount_value"" FLOAT,
	""amount_unit_concept_id"" NUMBER(38,0),
	""numerator_value"" FLOAT,
	""numerator_unit_concept_id"" NUMBER(38,0),
	""denominator_value"" FLOAT,
	""denominator_unit_concept_id"" NUMBER(38,0),
	""box_size"" NUMBER(38,0),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

,16
table_name,CONCEPT
description,
DDL,"create or replace TABLE CONCEPT (
	""concept_id"" NUMBER(38,0),
	""concept_name"" VARCHAR(16777216),
	""domain_id"" VARCHAR(16777216),
	""vocabulary_id"" VARCHAR(16777216),
	""concept_class_id"" VARCHAR(16777216),
	""standard_concept"" VARCHAR(16777216),
	""concept_code"" VARCHAR(16777216),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

,17
table_name,CONCEPT_CLASS
description,
DDL,"create or replace TABLE CONCEPT_CLASS (
	""concept_class_id"" VARCHAR(16777216),
	""concept_class_name"" VARCHAR(16777216),
	""concept_class_concept_id"" NUMBER(38,0)
);"

,18
table_name,DRUG_EXPOSURE
description,
DDL,"create or replace TABLE DRUG_EXPOSURE (
	""drug_type_concept_id"" NUMBER(38,0),
	""stop_reason"" VARCHAR(16777216),
	""refills"" NUMBER(38,0),
	""quantity"" FLOAT,
	""days_supply"" NUMBER(38,0),
	""sig"" VARCHAR(16777216),
	""route_concept_id"" NUMBER(38,0),
	""lot_number"" VARCHAR(16777216),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""drug_source_value"" VARCHAR(16777216),
	""drug_source_concept_id"" NUMBER(38,0),
	""route_source_value"" VARCHAR(16777216),
	""dose_unit_source_value"" VARCHAR(16777216),
	""drug_exposure_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""drug_exposure_start_date"" DATE,
	""drug_exposure_start_datetime"" NUMBER(38,0),
	""drug_exposure_end_date"" DATE,
	""drug_exposure_end_datetime"" NUMBER(38,0),
	""verbatim_end_date"" DATE
);"

,19
table_name,OBSERVATION_PERIOD
description,
DDL,"create or replace TABLE OBSERVATION_PERIOD (
	""observation_period_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""observation_period_start_date"" DATE,
	""observation_period_end_date"" DATE,
	""period_type_concept_id"" NUMBER(38,0)
);"

,20
table_name,PAYER_PLAN_PERIOD
description,
DDL,"create or replace TABLE PAYER_PLAN_PERIOD (
	""payer_concept_id"" NUMBER(38,0),
	""payer_source_value"" VARCHAR(16777216),
	""payer_source_concept_id"" NUMBER(38,0),
	""plan_concept_id"" NUMBER(38,0),
	""plan_source_value"" VARCHAR(16777216),
	""plan_source_concept_id"" NUMBER(38,0),
	""sponsor_concept_id"" NUMBER(38,0),
	""sponsor_source_value"" VARCHAR(16777216),
	""sponsor_source_concept_id"" NUMBER(38,0),
	""family_source_value"" VARCHAR(16777216),
	""stop_reason_concept_id"" NUMBER(38,0),
	""stop_reason_source_value"" VARCHAR(16777216),
	""stop_reason_source_concept_id"" NUMBER(38,0),
	""payer_plan_period_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""payer_plan_period_start_date"" DATE,
	""payer_plan_period_end_date"" DATE
);"

,21
table_name,RELATIONSHIP
description,
DDL,"create or replace TABLE RELATIONSHIP (
	""relationship_id"" VARCHAR(16777216),
	""relationship_name"" VARCHAR(16777216),
	""is_hierarchical"" VARCHAR(16777216),
	""defines_ancestry"" VARCHAR(16777216),
	""reverse_relationship_id"" VARCHAR(16777216),
	""relationship_concept_id"" NUMBER(38,0)
);"

,22
table_name,VOCABULARY
description,
DDL,"create or replace TABLE VOCABULARY (
	""vocabulary_id"" VARCHAR(16777216),
	""vocabulary_name"" VARCHAR(16777216),
	""vocabulary_reference"" VARCHAR(16777216),
	""vocabulary_version"" VARCHAR(16777216),
	""vocabulary_concept_id"" NUMBER(38,0)
);"

,23
table_name,PROCEDURE_OCCURRENCE
description,
DDL,"create or replace TABLE PROCEDURE_OCCURRENCE (
	""procedure_type_concept_id"" NUMBER(38,0),
	""modifier_concept_id"" NUMBER(38,0),
	""quantity"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""procedure_source_value"" VARCHAR(16777216),
	""procedure_source_concept_id"" NUMBER(38,0),
	""modifier_source_value"" VARCHAR(16777216),
	""procedure_occurrence_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""procedure_concept_id"" NUMBER(38,0),
	""procedure_dat"" DATE,
	""procedure_datetime"" NUMBER(38,0)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'CMS_DATA': {'CMS_CODES': ['HCPCS', 'ICD10_DIAGNOSES_2019', 'ICD10_PROCEDURES_2019', 'ICD9_DIAGNOSES', 'ICD9_PROCEDURES'], 'CMS_MEDICARE': ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014', 'HOSPICE_PROVIDERS_2014', 'HOSPITAL_GENERAL_INFO', 'INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2015', 'NURSING_FACILITIES_2013', 'NURSING_FACILITIES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2015', 'PART_D_PRESCRIBER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014'], 'CMS_SYNTHETIC_PATIENT_DATA_OMOP': ['CARE_SITE', 'CONCEPT', 'CONCEPT_ANCESTOR', 'CONCEPT_CLASS', 'CONCEPT_RELATIONSHIP', 'CONDITION_ERA', 'CONDITION_OCCURRENCE', 'COST', 'DEATH', 'DEVICE_EXPOSURE', 'DOMAIN', 'DOSE_ERA', 'DRUG_ERA', 'DRUG_EXPOSURE', 'DRUG_STRENGTH', 'LOCATION', 'OBSERVATION', 'OBSERVATION_PERIOD', 'PAYER_PLAN_PERIOD', 'PERSON', 'PROCEDURE_OCCURRENCE', 'PROVIDER', 'RELATIONSHIP', 'VOCABULARY']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

To address the task, we need to identify the provider with the highest total inpatient service cost from 2011-2015 and then calculate its annual inpatient and outpatient revenues averaged by case for each year during that period.

**Tables:**

- **INPATIENT_CHARGES_2011 to INPATIENT_CHARGES_2015** (located in `CMS_DATA.CMS_MEDICARE` schema)
- **OUTPATIENT_CHARGES_2011 to OUTPATIENT_CHARGES_2015** (located in `CMS_DATA.CMS_MEDICARE` schema)

**Relevant Columns and Potential Usage:**

1. **INPATIENT_CHARGES tables:**
   - **"provider_id"**: Identifies the provider (hospital).
   - **"provider_name"**: Name of the provider.
   - **"total_discharges"**: Number of inpatient discharges per DRG (Diagnosis-Related Group).
   - **"average_total_payments"**: Average total payments per discharge.
   - **Potential Usage**: Calculate total inpatient revenue per provider per year by summing `total_discharges * average_total_payments` across all DRGs.

2. **OUTPATIENT_CHARGES tables:**
   - **"provider_id"**: Identifies the provider.
   - **"provider_name"**: Name of the provider.
   - **"outpatient_services"**: Number of outpatient services per APC (Ambulatory Payment Classification).
   - **"average_total_payments"**: Average total payments per outpatient service.
   - **Potential Usage**: Calculate total outpatient revenue per provider per year by summing `outpatient_services * average_total_payments` across all APCs.

**Conditions That May Be Used:**

- Date range: Years from 2011 to 2015.
- Filtering data for the provider with the highest total inpatient service cost.
- Calculating averages by dividing total revenue by the number of cases (discharges or services).

---

**SQL Queries:**

Here are 10 Snowflake SQL queries to explore the relevant data:

1. **Retrieve distinct providers from INPATIENT_CHARGES_2011:**

   ```sql
   SELECT DISTINCT "provider_id", "provider_name"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
   LIMIT 100;
   ```

2. **Calculate total inpatient revenue per provider in 2011:**

   ```sql
   SELECT "provider_id", "provider_name",
          SUM("total_discharges" * "average_total_payments") AS "total_inpatient_revenue_2011"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
   GROUP BY "provider_id", "provider_name"
   ORDER BY "total_inpatient_revenue_2011" DESC
   LIMIT 100;
   ```

3. **Calculate total inpatient revenue per provider in 2012:**

   ```sql
   SELECT "provider_id", "provider_name",
          SUM("total_discharges" * "average_total_payments") AS "total_inpatient_revenue_2012"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
   GROUP BY "provider_id", "provider_name"
   ORDER BY "total_inpatient_revenue_2012" DESC
   LIMIT 100;
   ```

4. **Calculate total inpatient revenue per provider over 2011-2015:**

   ```sql
   SELECT "provider_id",
          SUM("total_inpatient_revenue") AS "total_inpatient_revenue_2011_2015"
   FROM (
       SELECT "provider_id", ("total_discharges" * "average_total_payments") AS "total_inpatient_revenue"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
       UNION ALL
       SELECT "provider_id", ("total_discharges" * "average_total_payments")
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
       UNION ALL
       SELECT "provider_id", ("total_discharges" * "average_total_payments")
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
       UNION ALL
       SELECT "provider_id", ("total_discharges" * "average_total_payments")
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
       UNION ALL
       SELECT "provider_id", ("total_discharges" * "average_total_payments")
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
   ) t
   GROUP BY "provider_id"
   ORDER BY "total_inpatient_revenue_2011_2015" DESC
   LIMIT 100;
   ```

5. **Identify the provider with the highest total inpatient revenue over 2011-2015:**

   ```sql
   SELECT "provider_id",
          SUM("total_inpatient_revenue") AS "total_inpatient_revenue_2011_2015"
   FROM (
       SELECT "provider_id", ("total_discharges" * "average_total_payments") AS "total_inpatient_revenue"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
       UNION ALL
       SELECT "provider_id", ("total_discharges" * "average_total_payments")
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
       UNION ALL
       SELECT "provider_id", ("total_discharges" * "average_total_payments")
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
       UNION ALL
       SELECT "provider_id", ("total_discharges" * "average_total_payments")
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
       UNION ALL
       SELECT "provider_id", ("total_discharges" * "average_total_payments")
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
   ) t
   GROUP BY "provider_id"
   ORDER BY "total_inpatient_revenue_2011_2015" DESC
   LIMIT 1;
   ```

6. **Calculate annual average inpatient revenue per case for the top provider in 2011:**

   Replace `'TOP_PROVIDER_ID'` with the actual provider ID obtained from query 5.

   ```sql
   SELECT '2011' AS "Year",
          SUM("total_discharges" * "average_total_payments") / SUM("total_discharges") AS "avg_inpatient_revenue_per_case"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
   WHERE "provider_id" = 'TOP_PROVIDER_ID';
   ```

7. **Calculate annual average outpatient revenue per case for the top provider in 2011:**

   ```sql
   SELECT '2011' AS "Year",
          SUM("outpatient_services" * "average_total_payments") / SUM("outpatient_services") AS "avg_outpatient_revenue_per_case"
   FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
   WHERE "provider_id" = 'TOP_PROVIDER_ID';
   ```

8. **Calculate annual average inpatient revenue per case for the top provider in 2012:**

   ```sql
   SELECT '2012' AS "Year",
          SUM("total_discharges" * "average_total_payments") / SUM("total_discharges") AS "avg_inpatient_revenue_per_case"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
   WHERE "provider_id" = 'TOP_PROVIDER_ID';
   ```

9. **Calculate annual average outpatient revenue per case for the top provider in 2012:**

   ```sql
   SELECT '2012' AS "Year",
          SUM("outpatient_services" * "average_total_payments") / SUM("outpatient_services") AS "avg_outpatient_revenue_per_case"
   FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2012
   WHERE "provider_id" = 'TOP_PROVIDER_ID';
   ```

10. **Calculate annual average inpatient and outpatient revenue per case for the top provider from 2011 to 2015:**

    For each year, replace `'YEAR'` with the specific year (e.g., '2013').

    **Inpatient Revenue Per Case:**

    ```sql
    SELECT 'YEAR' AS "Year",
           SUM("total_discharges" * "average_total_payments") / SUM("total_discharges") AS "avg_inpatient_revenue_per_case"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_YEAR
    WHERE "provider_id" = 'TOP_PROVIDER_ID';
    ```

    **Outpatient Revenue Per Case:**

    ```sql
    SELECT 'YEAR' AS "Year",
           SUM("outpatient_services" * "average_total_payments") / SUM("outpatient_services") AS "avg_outpatient_revenue_per_case"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_YEAR
    WHERE "provider_id" = 'TOP_PROVIDER_ID';
    ```

    Repeat these queries for each year from 2011 to 2015.

---

These queries will help you understand the relevant data and calculate the required metrics step by step, using only the information provided in the database tables.Query:
SELECT DISTINCT "provider_id", "provider_name"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
   LIMIT 100;
Answer:
provider_id,provider_name
220024,HOLYOKE MEDICAL CENTER
220015,"COOLEY DICKINSON HOSPITAL INC,THE"
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER
220050,BAYSTATE MARY LANE HOSPITAL
220065,NOBLE HOSPITAL
220066,MERCY MEDICAL CENTER
220077,BAYSTATE MEDICAL CENTER
220046,BERKSHIRE MEDICAL CENTER INC
220051,NORTH ADAMS REGIONAL HOSPITAL
220016,BAYSTATE FRANKLIN MEDICAL CENTER
220098,NASHOBA VALLEY MEDICAL CENTER
220095,HEYWOOD HOSPITAL
220058,CLINTON HOSPITAL ASSOCIATION
220019,HARRINGTON MEMORIAL HOSPITAL
220062,ADCARE HOSPITAL OF WORCESTER INC
220163,UMASS MEMORIAL MEDICAL CENTER INC
220176,ST VINCENT HOSPITAL
220084,EMERSON HOSPITAL
220049,MARLBOROUGH HOSPITAL
220090,MILFORD REGIONAL MEDICAL CENTER
220174,MERRIMACK VALLEY HOSPITAL
220010,LAWRENCE GENERAL HOSPITAL
220080,HOLY FAMILY HOSPITAL
220063,LOWELL GENERAL HOSPITAL
220105,WINCHESTER HOSPITAL
220029,ANNA JAQUES HOSPITAL
220126,NORWOOD HOSPITAL
220071,MASSACHUSETTS GENERAL HOSPITAL
220110,BRIGHAM AND WOMEN'S HOSPITAL
220017,CARNEY HOSPITAL
220119,FAULKNER HOSPITAL
220002,MOUNT AUBURN HOSPITAL
220011,CAMBRIDGE HEALTH ALLIANCE
220070,HALLMARK HEALTH SYSTEM
220111,GOOD SAMARITAN MEDICAL CENTER
220060,JORDAN HOSPITAL INC
220083,BETH ISRAEL DEACONESS HOSPITAL - NEEDHAM
220135,FALMOUTH HOSPITAL
220177,NANTUCKET COTTAGE HOSPITAL
220008,STURDY MEMORIAL HOSPITAL
220108,MILTON HOSPITAL INC
410007,RHODE ISLAND HOSPITAL
410005,ST JOSEPH HEALTH SERVICES OF RI
410004,ROGER WILLIAMS MEDICAL CENTER
300011,ST JOSEPH HOSPITAL
300020,SOUTHERN NH MEDICAL CENTER
300034,CATHOLIC MEDICAL CENTER
300003,MARY HITCHCOCK MEMORIAL HOSPITAL
200020,YORK HOSPITAL
200025,PARKVIEW ADVENTIST MEDICAL CENTER
200033,EASTERN MAINE MEDICAL CENTER
200063,PENOBSCOT BAY MEDICAL CENTER
70029,BRISTOL HOSPITAL
70007,LAWRENCE & MEMORIAL HOSPITAL
70028,ST VINCENT'S MEDICAL CENTER
70016,SAINT MARYS HOSPITAL
300018,WENTWORTH-DOUGLASS HOSPITAL
200018,"AROOSTOOK MEDICAL CENTER,THE"
470012,SOUTHWESTERN VERMONT MEDICAL CENTER
470005,RUTLAND REGIONAL MEDICAL CENTER
220001,"HEALTHALLIANCE HOSPITALS, INC"
220175,METROWEST MEDICAL CENTER
220171,LAHEY CLINIC HOSPITAL
220082,SAINTS  MEDICAL CENTER INC
220035,NORTH SHORE MEDICAL CENTER
220033,BEVERLY HOSPITAL CORPORATION
220116,TUFTS MEDICAL CENTER
220031,BOSTON MEDICAL CENTER CORPORATION
220088,NEW ENGLAND BAPTIST HOSPITAL
220036,ST ELIZABETH'S MEDICAL CENTER
220067,QUINCY MEDICAL CENTER
220086,BETH ISRAEL DEACONESS MEDICAL CENTER
220052,SIGNATURE HEALTHCARE BROCKTON HOSPITAL
220012,CAPE COD HOSPITAL
220074,"SOUTHCOAST HOSPITAL GROUP, INC"
220073,MORTON HOSPITAL
220100,SOUTH SHORE HOSPITAL
220101,NEWTON-WELLESLEY HOSPITAL
220020,SAINT ANNE'S HOSPITAL
410006,NEWPORT HOSPITAL
410001,MEMORIAL HOSPITAL OF RHODE ISLAND
410009,KENT COUNTY MEMORIAL HOSPITAL
410013,WESTERLY HOSPITAL
410010,WOMEN AND INFANTS HOSPITAL OF RHODE ISLAND
410012,MIRIAM HOSPITAL
300017,PARKLAND MEDICAL CENTER
300012,ELLIOT HOSPITAL
300001,CONCORD HOSPITAL
300014,FRISBIE MEMORIAL HOSPITAL
200021,MID COAST HOSPITAL
200040,HENRIETTA D GOODALL HOSPITAL
200009,MAINE MEDICAL CENTER
200039,MAINE GENERAL MEDICAL CENTER
200001,ST JOSEPH HOSPITAL
200002,MILES MEMORIAL HOSPITAL (LINCOLN COUNTY HEALTHCARE
470003,FLETCHER ALLEN HOSPITAL OF VERMONT
470001,CENTRAL VERMONT MEDICAL CENTER
70035,"HOSPITAL OF CENTRAL CONNECTICUT, THE"
70004,SHARON HOSPITAL
70008,JOHNSON MEMORIAL HOSPITAL
Query:
SELECT "provider_id", "provider_name",
          SUM("total_discharges" * "average_total_payments") AS "total_inpatient_revenue_2011"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
   GROUP BY "provider_id", "provider_name"
   ORDER BY "total_inpatient_revenue_2011" DESC
   LIMIT 100;
Answer:
provider_id,provider_name,total_inpatient_revenue_2011
330101,NEW YORK-PRESBYTERIAN HOSPITAL,287006757.0
100007,FLORIDA HOSPITAL,236106766.0
330059,MONTEFIORE MEDICAL CENTER,208603789.0
330024,MOUNT SINAI HOSPITAL,188955531.0
50625,CEDARS-SINAI MEDICAL CENTER,159543492.0
80001,"CHRISTIANA CARE HEALTH SERVICES, INC.",158686352.0
230130,WILLIAM BEAUMONT HOSPITAL,158201049.0
330106,NORTH SHORE UNIVERSITY HOSPITAL,152498639.0
450388,METHODIST HOSPITAL,151670130.0
330194,MAIMONIDES MEDICAL CENTER,149749450.0
440049,METHODIST HEALTHCARE MEMPHIS HOSPITALS,148678630.0
330169,BETH ISRAEL MEDICAL CENTER,146609305.0
220071,MASSACHUSETTS GENERAL HOSPITAL,132983841.0
340040,PITT COUNTY MEMORIAL HOSPITAL,130107306.0
70022,YALE-NEW HAVEN HOSPITAL,128263319.0
150056,INDIANA UNIVERSITY HEALTH,125790667.0
220074,"SOUTHCOAST HOSPITAL GROUP, INC",124538409.0
220163,UMASS MEMORIAL MEDICAL CENTER INC,120490110.0
450184,MEMORIAL HERMANN HOSPITAL SYSTEM,119153867.0
210009,"JOHNS HOPKINS HOSPITAL, THE",118949853.0
180088,"NORTON HOSPITALS, INC",115682499.0
390164,UPMC PRESBYTERIAN SHADYSIDE,114697586.0
260032,BARNES JEWISH HOSPITAL,112153697.0
230038,SPECTRUM HEALTH - BUTTERWORTH CAMPUS,112107466.0
340002,MEMORIAL MISSION HOSPITAL AND ASHEVILLE SURGERY CE,110925492.0
70025,HARTFORD HOSPITAL,109215356.0
520138,AURORA ST LUKES MEDICAL CENTER,108371892.0
340141,NEW HANOVER REGIONAL MEDICAL CENTER,107806806.0
140208,ADVOCATE CHRIST HOSPITAL & MEDICAL CENTER,107397883.0
330214,NYU HOSPITALS CENTER,106850886.0
230046,UNIVERSITY OF MICHIGAN HEALTH SYSTEM,106663879.0
450058,BAPTIST MEDICAL CENTER,104489926.0
90011,WASHINGTON HOSPITAL CENTER,104375731.0
220086,BETH ISRAEL DEACONESS MEDICAL CENTER,103950459.0
340047,NORTH CAROLINA BAPTIST HOSPITAL,102816499.0
360180,CLEVELAND CLINIC,102573197.0
140281,NORTHWESTERN MEMORIAL HOSPITAL,102168939.0
310001,HACKENSACK UNIVERSITY MEDICAL CENTER,102146464.0
240010,MAYO CLINIC - SAINT MARYS HOSPITAL,102067487.0
10039,HUNTSVILLE HOSPITAL,101014268.0
340069,"WAKEMED, RALEIGH CAMPUS",100912550.0
140010,EVANSTON HOSPITAL,100417946.0
330055,NEW YORK HOSPITAL MEDICAL CENTER OF QUEENS,100256873.0
100006,ORLANDO HEALTH,100213330.0
220110,BRIGHAM AND WOMEN'S HOSPITAL,99580878.0
340030,DUKE UNIVERSITY HOSPITAL,97223488.0
450358,"METHODIST HOSPITAL,THE",96178331.0
390133,LEHIGH VALLEY HOSPITAL,96166260.0
230019,PROVIDENCE HOSPITAL AND MEDICAL CENTERS,95744868.0
340113,CAROLINAS MEDICAL CENTER/BEHAV HEALTH,94546115.0
450021,BAYLOR UNIVERSITY MEDICAL CENTER,94214537.0
230020,OAKWOOD HOSPITAL AND MEDICAL CENTER,94185983.0
310015,MORRISTOWN MEMORIAL HOSPITAL,93107613.0
340091,"MOSES H CONE MEMORIAL HOSPITAL, THE",92686902.0
230165,ST JOHN HOSPITAL AND MEDICAL CENTER,92391213.0
310019,ST JOSEPH'S REGIONAL MEDICAL CENTER,91903500.0
180040,JEWISH HOSPITAL & ST MARY'S HEALTHCARE,91613033.0
70002,ST FRANCIS HOSPITAL & MEDICAL CENTER,91576178.0
390174,THOMAS JEFFERSON UNIVERSITY HOSPITAL,90131241.0
230053,HENRY FORD HOSPITAL,89979364.0
330195,LONG ISLAND JEWISH MEDICAL CENTER,89489617.0
340028,CAPE FEAR VALLEY MEDICAL CENTER,89419708.0
220077,BAYSTATE MEDICAL CENTER,88668772.0
50441,STANFORD HOSPITAL,88351642.0
310041,COMMUNITY MEDICAL CENTER,88323288.0
490024,CARILION ROANOKE MEMORIAL CENTER,88234725.0
210002,UNIVERSITY OF MARYLAND MEDICAL CENTER,87353890.0
510022,CHARLESTON AREA MEDICAL CENTER,87233290.0
330046,ST LUKE'S ROOSEVELT HOSPITAL,86231090.0
240057,ABBOTT NORTHWESTERN HOSPITAL,86172157.0
210019,PENINSULA REGIONAL MEDICAL CENTER,85636306.0
140223,ADVOCATE LUTHERAN GENERAL HOSPITAL,85592480.0
330167,WINTHROP-UNIVERSITY HOSPITAL,85459223.0
490063,INOVA FAIRFAX HOSPITAL,85355497.0
360006,RIVERSIDE METHODIST HOSPITAL,85232973.0
440048,BAPTIST MEMORIAL HOSPITAL,84984866.0
360085,OHIO STATE UNIVERSITY HOSPITALS,84517846.0
310012,VALLEY HOSPITAL,84272889.0
330005,KALEIDA HEALTH,84247952.0
450054,SCOTT & WHITE MEMORIAL HOSPITAL,84240781.0
100018,NAPLES COMMUNITY HOSPITAL,83759988.0
440002,JACKSON-MADISON COUNTY GENERAL HOSPITAL,83069175.0
330393,UNIVERSITY HOSPITAL ( STONY BROOK ),82946072.0
50093,SAINT AGNES MEDICAL CENTER,82560428.0
310038,ROBERT WOOD JOHNSON UNIVERSITY HOSPITAL,82271453.0
170122,VIA CHRISTI HOSPITALS WICHITA INC,81903944.0
100113,SHANDS HOSPITAL AT THE UNIVERSITY OF FLORIDA,80965569.0
330182,"ST FRANCIS HOSPITAL, ROSLYN",80230119.0
200009,MAINE MEDICAL CENTER,80145811.0
330236,NEW YORK METHODIST HOSPITAL,79762500.0
310022,VIRTUA WEST JERSEY HOSPITALS BERLIN,79126449.0
230195,ST JOHN MACOMB-OAKLAND HOSPITAL-MACOMB CENTER,79117019.0
210015,FRANKLIN SQUARE HOSPITAL CENTER,79071899.0
230156,ST JOSEPH MERCY HOSPITAL,78638709.0
70001,HOSPITAL OF ST RAPHAEL,78566571.0
310086,KENNEDY UNIVERSITY HOSPITAL - STRATFORD DIV,78479038.0
100040,ST VINCENT'S MEDICAL CENTER,78294990.0
100022,JACKSON MEMORIAL HOSPITAL,77993809.0
210023,ANNE ARUNDEL MEDICAL CENTER,77971454.0
110107,MEDICAL CENTER OF CENTRAL GEORGIA,77729238.0
Query:
SELECT "provider_id", "provider_name",
          SUM("total_discharges" * "average_total_payments") AS "total_inpatient_revenue_2012"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
   GROUP BY "provider_id", "provider_name"
   ORDER BY "total_inpatient_revenue_2012" DESC
   LIMIT 100;
Answer:
provider_id,provider_name,total_inpatient_revenue_2012
330101,NEW YORK-PRESBYTERIAN HOSPITAL,285114945.0
100007,FLORIDA HOSPITAL,234210737.0
330059,MONTEFIORE MEDICAL CENTER,192931148.0
330024,MOUNT SINAI HOSPITAL,179984221.0
50625,CEDARS-SINAI MEDICAL CENTER,171459554.0
80001,"CHRISTIANA CARE HEALTH SERVICES, INC.",162558615.0
230130,BEAUMONT HEALTH SYSTEM,161286044.0
440049,METHODIST HEALTHCARE MEMPHIS HOSPITALS,157578858.0
450388,METHODIST HOSPITAL,151690857.0
220071,MASSACHUSETTS GENERAL HOSPITAL,146085816.0
330169,BETH ISRAEL MEDICAL CENTER,144363177.0
340040,VIDANT MEDICAL CENTER,141118643.0
330106,NORTH SHORE UNIVERSITY HOSPITAL,136461896.0
330194,MAIMONIDES MEDICAL CENTER,131920569.0
70022,YALE-NEW HAVEN HOSPITAL,131206144.0
150056,INDIANA UNIVERSITY HEALTH,130064375.0
220074,"SOUTHCOAST HOSPITAL GROUP, INC",123622708.0
180088,"NORTON HOSPITALS, INC",122549213.0
450184,MEMORIAL HERMANN HOSPITAL SYSTEM,121836837.0
90011,WASHINGTON HOSPITAL CENTER,121316912.0
260032,BARNES JEWISH HOSPITAL,119130269.0
210009,"JOHNS HOPKINS HOSPITAL, THE",117688373.0
220163,UMASS MEMORIAL MEDICAL CENTER INC,116391785.0
520138,AURORA ST LUKES MEDICAL CENTER,113506499.0
220077,BAYSTATE MEDICAL CENTER,112867812.0
390164,UPMC PRESBYTERIAN SHADYSIDE,112866695.0
340141,NEW HANOVER REGIONAL MEDICAL CENTER,112258584.0
340002,MEMORIAL MISSION HOSPITAL AND ASHEVILLE SURGERY CE,111843592.0
70025,HARTFORD HOSPITAL,111640786.0
230038,SPECTRUM HEALTH - BUTTERWORTH CAMPUS,108714543.0
360180,CLEVELAND CLINIC,107873796.0
140208,ADVOCATE CHRIST HOSPITAL & MEDICAL CENTER,107005222.0
450058,BAPTIST MEDICAL CENTER,104955929.0
330214,NYU HOSPITALS CENTER,104586079.0
10039,HUNTSVILLE HOSPITAL,103136104.0
140010,EVANSTON HOSPITAL,102586818.0
220110,BRIGHAM AND WOMEN'S HOSPITAL,101351960.0
240010,MAYO CLINIC-ST MARY'S HOSPITAL,100816777.0
390174,THOMAS JEFFERSON UNIVERSITY HOSPITAL,100078872.0
310001,HACKENSACK UNIVERSITY MEDICAL CENTER,98741428.0
230053,HENRY FORD HOSPITAL,98688921.0
330055,NEW YORK HOSPITAL MEDICAL CENTER OF QUEENS,98356754.0
340113,CAROLINAS MEDICAL CENTER/BEHAV HEALTH,97565317.0
310015,MORRISTOWN MEMORIAL HOSPITAL,97369298.0
340047,NORTH CAROLINA BAPTIST HOSPITAL,96134223.0
450358,"METHODIST HOSPITAL,THE",95812427.0
230046,UNIVERSITY OF MICHIGAN HEALTH SYSTEM,95423401.0
510022,CHARLESTON AREA MEDICAL CENTER,94552667.0
310019,ST JOSEPH'S REGIONAL MEDICAL CENTER,93999281.0
220086,BETH ISRAEL DEACONESS MEDICAL CENTER,93822799.0
390133,LEHIGH VALLEY HOSPITAL,93785848.0
140281,NORTHWESTERN MEMORIAL HOSPITAL,93423450.0
490024,CARILION ROANOKE MEMORIAL CENTER,93265892.0
340069,"WAKEMED, RALEIGH CAMPUS",92874553.0
340030,DUKE UNIVERSITY HOSPITAL,92602498.0
230019,PROVIDENCE HOSPITAL AND MEDICAL CENTERS,91909320.0
450021,BAYLOR UNIVERSITY MEDICAL CENTER,91761937.0
340028,CAPE FEAR VALLEY MEDICAL CENTER,91446690.0
330195,LONG ISLAND JEWISH MEDICAL CENTER,90946109.0
50441,STANFORD HOSPITAL,90721261.0
230020,OAKWOOD HOSPITAL AND MEDICAL CENTER,90692850.0
180040,JEWISH HOSPITAL & ST MARY'S HEALTHCARE,90612850.0
100006,ORLANDO HEALTH,90299971.0
450054,SCOTT & WHITE MEMORIAL HOSPITAL,90053030.0
70002,ST FRANCIS HOSPITAL & MEDICAL CENTER,89450734.0
340091,"MOSES H CONE MEMORIAL HOSPITAL, THE",89167456.0
330393,UNIVERSITY HOSPITAL ( STONY BROOK ),88908511.0
240057,ABBOTT NORTHWESTERN HOSPITAL,88515216.0
100113,SHANDS HOSPITAL AT THE UNIVERSITY OF FLORIDA,88350775.0
230165,ST JOHN HOSPITAL AND MEDICAL CENTER,87915432.0
210002,UNIVERSITY OF MARYLAND MEDICAL CENTER,86779644.0
210023,ANNE ARUNDEL MEDICAL CENTER,86567188.0
440002,JACKSON-MADISON COUNTY GENERAL HOSPITAL,85627337.0
360006,RIVERSIDE METHODIST HOSPITAL,85499107.0
490063,INOVA FAIRFAX HOSPITAL,85389656.0
310041,COMMUNITY MEDICAL CENTER,85337683.0
210015,MEDSTAR FRANKLIN SQUARE MEDICAL CENTER,84807465.0
50599,UNIVERSITY OF CALIFORNIA DAVIS MEDICAL CENTER,84439107.0
140119,RUSH UNIVERSITY MEDICAL CENTER,84004864.0
440048,BAPTIST MEMORIAL HOSPITAL,83928207.0
140223,ADVOCATE LUTHERAN GENERAL HOSPITAL,83601189.0
330046,ST LUKE'S ROOSEVELT HOSPITAL,82819362.0
490009,UNIVERSITY OF VIRGINIA MEDICAL CENTER,82413600.0
330270,HOSPITAL FOR SPECIAL SURGERY,81963908.0
330167,WINTHROP-UNIVERSITY HOSPITAL,81948195.0
310022,VIRTUA WEST JERSEY HOSPITALS BERLIN,81707906.0
170122,VIA CHRISTI HOSPITALS WICHITA INC,81336177.0
310086,KENNEDY UNIVERSITY HOSPITAL - STRATFORD DIV,81103680.0
100018,NAPLES COMMUNITY HOSPITAL,80876164.0
230195,ST JOHN MACOMB-OAKLAND HOSPITAL-MACOMB CENTER,80803832.0
360085,OHIO STATE UNIVERSITY HOSPITALS,80682970.0
210019,PENINSULA REGIONAL MEDICAL CENTER,80660933.0
330236,NEW YORK METHODIST HOSPITAL,80546365.0
330160,STATEN ISLAND UNIVERSITY HOSPITAL,80529254.0
330005,KALEIDA HEALTH,79772122.0
310038,ROBERT WOOD JOHNSON UNIVERSITY HOSPITAL,79664519.0
140148,MEMORIAL MEDICAL CENTER,79603078.0
310064,ATLANTICARE REGIONAL MEDICAL CENTER - CITY DIV,79519069.0
50093,SAINT AGNES MEDICAL CENTER,79446259.0
310012,VALLEY HOSPITAL,79172502.0
Query:
SELECT "provider_id",
          SUM("total_inpatient_revenue") AS "total_inpatient_revenue_2011_2015"
   FROM (
       SELECT "provider_id", ("total_discharges" * "average_total_payments") AS "total_inpatient_revenue"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
       UNION ALL
       SELECT "provider_id", ("total_discharges" * "average_total_payments")
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
       UNION ALL
       SELECT "provider_id", ("total_discharges" * "average_total_payments")
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
       UNION ALL
       SELECT "provider_id", ("total_discharges" * "average_total_payments")
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
       UNION ALL
       SELECT "provider_id", ("total_discharges" * "average_total_payments")
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
   ) t
   GROUP BY "provider_id"
   ORDER BY "total_inpatient_revenue_2011_2015" DESC
   LIMIT 100;
Answer:
provider_id,total_inpatient_revenue_2011_2015
330101,2282865349.0
100007,1640460214.0
50625,1278370678.0
70022,1266793190.0
330024,1245238816.0
330059,1206841725.0
240010,1167940231.0
220071,1139343529.0
80001,1112560956.0
210009,1070654820.0
360180,985777033.0
260032,980346302.0
230130,976338094.0
450388,963109880.0
440049,943909035.0
150056,920588674.0
340040,914678048.0
330106,909806897.0
220110,895839452.0
230046,889701146.0
390164,863366325.0
210002,844581282.0
50441,837021992.0
90011,834616305.0
340030,809228562.0
330194,797549243.0
180088,782130671.0
450358,780256555.0
340113,762607839.0
330169,759844600.0
310015,756140078.0
70025,747142668.0
390174,736331602.0
220163,728073433.0
520138,725723430.0
450184,720513309.0
340141,716902724.0
50454,712635158.0
220086,708427427.0
330214,707228540.0
220074,696884989.0
220077,694486952.0
230038,687679261.0
340002,686775705.0
490009,684161697.0
390111,683283967.0
140208,681869740.0
340047,680491265.0
100113,678178467.0
310001,674282093.0
140281,672613807.0
450021,665633358.0
140010,660320098.0
330393,652598220.0
10039,642247328.0
10033,629952126.0
490063,629840792.0
450058,620299095.0
490024,615515105.0
390133,614049849.0
230053,610380857.0
240057,608648992.0
140119,598598096.0
50599,596595350.0
360085,593723365.0
510022,586456219.0
520098,577866823.0
310038,577866216.0
100006,577179265.0
440039,576975205.0
180067,572339284.0
450054,572245570.0
330167,569376855.0
440048,563611190.0
360006,561515525.0
490032,559195927.0
230019,542394649.0
330270,537339956.0
100128,537234265.0
100022,536435352.0
340061,533756180.0
180040,530535822.0
70002,527643273.0
300003,522546728.0
330195,521698542.0
210012,519382812.0
310019,518248442.0
50262,517872734.0
330055,516671197.0
200009,513109257.0
230020,511869375.0
450193,507651343.0
330005,507247596.0
160058,504699264.0
420004,504392891.0
340091,503585762.0
240036,499364870.0
410007,493440297.0
310022,491565550.0
150084,490265432.0
Query:
SELECT "provider_id",
          SUM("total_inpatient_revenue") AS "total_inpatient_revenue_2011_2015"
   FROM (
       SELECT "provider_id", ("total_discharges" * "average_total_payments") AS "total_inpatient_revenue"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
       UNION ALL
       SELECT "provider_id", ("total_discharges" * "average_total_payments")
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
       UNION ALL
       SELECT "provider_id", ("total_discharges" * "average_total_payments")
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
       UNION ALL
       SELECT "provider_id", ("total_discharges" * "average_total_payments")
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
       UNION ALL
       SELECT "provider_id", ("total_discharges" * "average_total_payments")
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
   ) t
   GROUP BY "provider_id"
   ORDER BY "total_inpatient_revenue_2011_2015" DESC
   LIMIT 1;
Answer:
provider_id,total_inpatient_revenue_2011_2015
330101,2282865349.0
Query:
SELECT
    '2011' AS "Year",
    (SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0)) AS "avg_inpatient_revenue_per_case",
    (SELECT 
        SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0)
     FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
     WHERE "provider_id" = '330101') AS "avg_outpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
WHERE "provider_id" = '330101'

UNION ALL

SELECT
    '2012' AS "Year",
    (SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0)) AS "avg_inpatient_revenue_per_case",
    (SELECT 
        SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0)
     FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2012
     WHERE "provider_id" = '330101') AS "avg_outpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
WHERE "provider_id" = '330101'

UNION ALL

SELECT
    '2013' AS "Year",
    (SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0)) AS "avg_inpatient_revenue_per_case",
    (SELECT 
        SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0)
     FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
     WHERE "provider_id" = '330101') AS "avg_outpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
WHERE "provider_id" = '330101'

UNION ALL

SELECT
    '2014' AS "Year",
    (SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0)) AS "avg_inpatient_revenue_per_case",
    (SELECT 
        SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0)
     FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2014
     WHERE "provider_id" = '330101') AS "avg_outpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
WHERE "provider_id" = '330101'

UNION ALL

SELECT
    '2015' AS "Year",
    (SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0)) AS "avg_inpatient_revenue_per_case",
    (SELECT 
        SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0)
     FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2015
     WHERE "provider_id" = '330101') AS "avg_outpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
WHERE "provider_id" = '330101';
Answer:
Year,avg_inpatient_revenue_per_case,avg_outpatient_revenue_per_case
2011,17049.231139360818,119.62067299
2012,17535.82292883941,119.009406919
2013,18180.65937184662,117.280394466
2014,27803.58699030563,143.493669187
2015,27290.714140469314,147.876775549
Query:
SELECT '2011' AS "Year",
       SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0) AS "avg_outpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
WHERE "provider_id" = '330101'
Answer:
Year,avg_outpatient_revenue_per_case
2011,119.62067299046934
Query:
SELECT '2012' AS "Year",
       SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "avg_inpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
WHERE "provider_id" = '330101'
Answer:
Year,avg_inpatient_revenue_per_case
2012,17535.82292883941
Query:
SELECT '2012' AS "Year",
       SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0) AS "avg_outpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2012
WHERE "provider_id" = '330101'
Answer:
Year,avg_outpatient_revenue_per_case
2012,119.00940691946788
Query:
SELECT '2013' AS "Year",
       SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "avg_inpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
WHERE "provider_id" = '330101';
Answer:
Year,avg_inpatient_revenue_per_case
2013,18180.65937184662
Query:
SELECT '2013' AS "Year",
       SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "avg_inpatient_revenue_per_case"
FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
WHERE "provider_id" = '330101'
Answer:
Year,avg_inpatient_revenue_per_case
2013,18180.65937184662
Query:
SELECT '2013' AS "Year",
           SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0) AS "avg_outpatient_revenue_per_case"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
    WHERE "provider_id" = '330101'
Answer:
Year,avg_outpatient_revenue_per_case
2013,117.28039446570503
Query:
SELECT '2014' AS "Year",
           SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0) AS "avg_outpatient_revenue_per_case"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2014
    WHERE "provider_id" = '330101'
Answer:
Year,avg_outpatient_revenue_per_case
2014,143.493669187061
End Exploring Related Columns
Task: For the provider with the highest total inpatient service cost from 2011-2015, tell me its annual inpatient and outpatient revenues averaged by case for each year during that period.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: Sure, here's the information you requested:

```csv
Year,Inpatient_Revenue_Avg_Per_Case,Outpatient_Revenue_Avg_Per_Case
2011,avg_inpatient_revenue_2011:float,avg_outpatient_revenue_2011:float
2012,avg_inpatient_revenue_2012:float,avg_outpatient_revenue_2012:float
2013,avg_inpatient_revenue_2013:float,avg_outpatient_revenue_2013:float
2014,avg_inpatient_revenue_2014:float,avg_outpatient_revenue_2014:float
2015,avg_inpatient_revenue_2015:float,avg_outpatient_revenue_2015:float
```

**Explanation:**

The table displays the annual inpatient and outpatient revenues averaged by case for each year from 2011 to 2015 for the provider with the highest total inpatient service cost during that period. The values represent the average revenue per case, calculated by dividing the total revenue by the total number of cases for both inpatient and outpatient services..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'CMS_DATA': {'CMS_CODES': ['HCPCS', 'ICD10_DIAGNOSES_2019', 'ICD10_PROCEDURES_2019', 'ICD9_DIAGNOSES', 'ICD9_PROCEDURES'], 'CMS_MEDICARE': ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014', 'HOSPICE_PROVIDERS_2014', 'HOSPITAL_GENERAL_INFO', 'INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2015', 'NURSING_FACILITIES_2013', 'NURSING_FACILITIES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2015', 'PART_D_PRESCRIBER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014'], 'CMS_SYNTHETIC_PATIENT_DATA_OMOP': ['CARE_SITE', 'CONCEPT', 'CONCEPT_ANCESTOR', 'CONCEPT_CLASS', 'CONCEPT_RELATIONSHIP', 'CONDITION_ERA', 'CONDITION_OCCURRENCE', 'COST', 'DEATH', 'DEVICE_EXPOSURE', 'DOMAIN', 'DOSE_ERA', 'DRUG_ERA', 'DRUG_EXPOSURE', 'DRUG_STRENGTH', 'LOCATION', 'OBSERVATION', 'OBSERVATION_PERIOD', 'PAYER_PLAN_PERIOD', 'PERSON', 'PROCEDURE_OCCURRENCE', 'PROVIDER', 'RELATIONSHIP', 'VOCABULARY']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-27 01:25:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:25:01 - root - INFO - ```sql
WITH inpatient AS (
    SELECT
        '2011' AS "Year",
        SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "Inpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
    WHERE "provider_id" = '330101'
    UNION ALL
    SELECT
        '2012' AS "Year",
        SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "Inpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
    WHERE "provider_id" = '330101'
    UNION ALL
    SELECT
        '2013' AS "Year",
        SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "Inpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
    WHERE "provider_id" = '330101'
    UNION ALL
    SELECT
        '2014' AS "Year",
        SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "Inpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
    WHERE "provider_id" = '330101'
    UNION ALL
    SELECT
        '2015' AS "Year",
        SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "Inpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
    WHERE "provider_id" = '330101'
),
outpatient AS (
    SELECT
        '2011' AS "Year",
        SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0) AS "Outpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
    WHERE "provider_id" = '330101'
    UNION ALL
    SELECT
        '2012' AS "Year",
        SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0) AS "Outpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2012
    WHERE "provider_id" = '330101'
    UNION ALL
    SELECT
        '2013' AS "Year",
        SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0) AS "Outpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
    WHERE "provider_id" = '330101'
    UNION ALL
    SELECT
        '2014' AS "Year",
        SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0) AS "Outpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2014
    WHERE "provider_id" = '330101'
    UNION ALL
    SELECT
        '2015' AS "Year",
        SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0) AS "Outpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2015
    WHERE "provider_id" = '330101'
)
SELECT
    inpatient."Year",
    inpatient."Inpatient_Revenue_Avg_Per_Case",
    outpatient."Outpatient_Revenue_Avg_Per_Case"
FROM inpatient
JOIN outpatient ON inpatient."Year" = outpatient."Year"
ORDER BY inpatient."Year";
```
2025-01-27 01:25:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:25:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:25:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:25:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-27 01:25:04 - snowflake.connector.connection - INFO - closed
2025-01-27 01:25:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:25:04 - root - INFO - itercount: 1
2025-01-27 01:25:04 - root - INFO - 0
2025-01-27 01:25:04 - root - INFO - results: 
Year,Inpatient_Revenue_Avg_Per_Case,Outpatient_Revenue_Avg_Per_Case
2011,17049.231139360818,119.62067299046934
2012,17535.82292883941,119.00940691946788
2013,18180.65937184662,117.28039446570503
2014,27803.58699030563,143.493669187061
2015,27290.714140469314,147.87677554904303


2025-01-27 01:25:04 - root - INFO - Please check the answer again by reviewing For the provider with the highest total inpatient service cost from 2011-2015, tell me its annual inpatient and outpatient revenues averaged by case for each year during that period., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: Sure, here's the information you requested:

```csv
Year,Inpatient_Revenue_Avg_Per_Case,Outpatient_Revenue_Avg_Per_Case
2011,avg_inpatient_revenue_2011:float,avg_outpatient_revenue_2011:float
2012,avg_inpatient_revenue_2012:float,avg_outpatient_revenue_2012:float
2013,avg_inpatient_revenue_2013:float,avg_outpatient_revenue_2013:float
2014,avg_inpatient_revenue_2014:float,avg_outpatient_revenue_2014:float
2015,avg_inpatient_revenue_2015:float,avg_outpatient_revenue_2015:float
```

**Explanation:**

The table displays the annual inpatient and outpatient revenues averaged by case for each year from 2011 to 2015 for the provider with the highest total inpatient service cost during that period. The values represent the average revenue per case, calculated by dividing the total revenue by the total number of cases for both inpatient and outpatient services. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Year,Inpatient_Revenue_Avg_Per_Case,Outpatient_Revenue_Avg_Per_Case
2011,17049.231139360818,119.62067299046934
2012,17535.82292883941,119.00940691946788
2013,18180.65937184662,117.28039446570503
2014,27803.58699030563,143.493669187061
2015,27290.714140469314,147.87677554904303
Current sql:
WITH inpatient AS (
    SELECT
        '2011' AS "Year",
        SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "Inpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
    WHERE "provider_id" = '330101'
    UNION ALL
    SELECT
        '2012' AS "Year",
        SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "Inpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
    WHERE "provider_id" = '330101'
    UNION ALL
    SELECT
        '2013' AS "Year",
        SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "Inpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
    WHERE "provider_id" = '330101'
    UNION ALL
    SELECT
        '2014' AS "Year",
        SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "Inpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
    WHERE "provider_id" = '330101'
    UNION ALL
    SELECT
        '2015' AS "Year",
        SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0) AS "Inpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
    WHERE "provider_id" = '330101'
),
outpatient AS (
    SELECT
        '2011' AS "Year",
        SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0) AS "Outpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
    WHERE "provider_id" = '330101'
    UNION ALL
    SELECT
        '2012' AS "Year",
        SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0) AS "Outpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2012
    WHERE "provider_id" = '330101'
    UNION ALL
    SELECT
        '2013' AS "Year",
        SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0) AS "Outpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
    WHERE "provider_id" = '330101'
    UNION ALL
    SELECT
        '2014' AS "Year",
        SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0) AS "Outpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2014
    WHERE "provider_id" = '330101'
    UNION ALL
    SELECT
        '2015' AS "Year",
        SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0) AS "Outpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2015
    WHERE "provider_id" = '330101'
)
SELECT
    inpatient."Year",
    inpatient."Inpatient_Revenue_Avg_Per_Case",
    outpatient."Outpatient_Revenue_Avg_Per_Case"
FROM inpatient
JOIN outpatient ON inpatient."Year" = outpatient."Year"
ORDER BY inpatient."Year";
2025-01-27 01:25:47 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:25:47 - root - INFO - ```sql
WITH inpatient AS (
    SELECT
        '2011' AS "Year",
        ROUND(SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0), 4) AS "Inpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
    WHERE "provider_id" = '330101'
    UNION ALL
    SELECT
        '2012' AS "Year",
        ROUND(SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0), 4) AS "Inpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
    WHERE "provider_id" = '330101'
    UNION ALL
    SELECT
        '2013' AS "Year",
        ROUND(SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0), 4) AS "Inpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
    WHERE "provider_id" = '330101'
    UNION ALL
    SELECT
        '2014' AS "Year",
        ROUND(SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0), 4) AS "Inpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
    WHERE "provider_id" = '330101'
    UNION ALL
    SELECT
        '2015' AS "Year",
        ROUND(SUM("total_discharges" * "average_total_payments") / NULLIF(SUM("total_discharges"), 0), 4) AS "Inpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
    WHERE "provider_id" = '330101'
),
outpatient AS (
    SELECT
        '2011' AS "Year",
        ROUND(SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0), 4) AS "Outpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
    WHERE "provider_id" = '330101'
    UNION ALL
    SELECT
        '2012' AS "Year",
        ROUND(SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0), 4) AS "Outpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2012
    WHERE "provider_id" = '330101'
    UNION ALL
    SELECT
        '2013' AS "Year",
        ROUND(SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0), 4) AS "Outpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
    WHERE "provider_id" = '330101'
    UNION ALL
    SELECT
        '2014' AS "Year",
        ROUND(SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0), 4) AS "Outpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2014
    WHERE "provider_id" = '330101'
    UNION ALL
    SELECT
        '2015' AS "Year",
        ROUND(SUM("outpatient_services" * "average_total_payments") / NULLIF(SUM("outpatient_services"), 0), 4) AS "Outpatient_Revenue_Avg_Per_Case"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2015
    WHERE "provider_id" = '330101'
)
SELECT
    inpatient."Year",
    inpatient."Inpatient_Revenue_Avg_Per_Case",
    outpatient."Outpatient_Revenue_Avg_Per_Case"
FROM inpatient
JOIN outpatient ON inpatient."Year" = outpatient."Year"
ORDER BY inpatient."Year";
```
2025-01-27 01:25:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:25:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:25:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:25:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-27 01:25:50 - snowflake.connector.connection - INFO - closed
2025-01-27 01:25:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:25:50 - root - INFO - itercount: 2
2025-01-27 01:25:50 - root - INFO - 0
2025-01-27 01:25:50 - root - INFO - Total iteration counts: 2
