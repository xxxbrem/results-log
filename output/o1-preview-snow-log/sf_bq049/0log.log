2025-01-23 11:11:43 - openai._base_client - INFO - Retrying request to /chat/completions in 0.401647 seconds
2025-01-23 11:12:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 11:12:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:12:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:12:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:12:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 11:12:31 - snowflake.connector.connection - INFO - closed
2025-01-23 11:12:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:12:31 - root - INFO - SQL:
SELECT DISTINCT "county"
   FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
   LIMIT 100;
Results:
county
MONTGOMERY
HANCOCK
CASS
CHICKASAW
LEE
CALHOUN
STORY
PAGE
BREMER
FLOYD
CLINTON
TAYLOR
IDA
MAHASKA
JASPER
CLARKE
CHEROKEE
WASHINGTON
ALLAMAKEE
DUBUQUE
HENRY
HOWARD
SCOTT
LYON
EMMET
BUCHANAN
AUDUBON
UNION
CLAY
GRUNDY
WINNESHIEK
VAN BUREN
WOODBURY
WAPELLO
O'BRIEN
CARROLL
FREMONT
FRANKLIN
DICKINSON
JONES
POCAHONTAS
JEFFERSON
MITCHELL
MADISON
CERRO GORDO
DES MOINES
KOSSUTH
WAYNE
POWESHIEK
BOONE
ADAIR
PALO ALTO
CLAYTON
BUTLER
APPANOOSE
SHELBY
IOWA
TAMA
MARION
MUSCATINE
BLACK HAWK
MONROE
FAYETTE
LINN
DALLAS
LOUISA
WINNEBAGO
RINGGOLD
CRAWFORD
""
LUCAS
DECATUR
BUENA VISTA
MILLS
DELAWARE
SIOUX
WRIGHT
POTTAWATTAMIE
PLYMOUTH
MARSHALL
BENTON
SAC
POLK
HARDIN
DAVIS
CEDAR
JACKSON
HARRISON
WORTH
ADAMS
HAMILTON
MONONA
GUTHRIE
HUMBOLDT
KEOKUK
WARREN
OSCEOLA
GREENE
JOHNSON
WEBSTER

2025-01-23 11:12:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:12:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:12:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:12:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-23 11:12:33 - snowflake.connector.connection - INFO - closed
2025-01-23 11:12:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:13:15 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 11:13:15 - root - INFO - ```sql
SELECT "date", "zip_code", "sale_dollars"
FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
WHERE "county" = 'DUBUQUE' AND "date" BETWEEN '2022-01-01' AND '2022-12-31'
LIMIT 100;
```
2025-01-23 11:13:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:13:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:13:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:13:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 11:13:16 - snowflake.connector.connection - INFO - closed
2025-01-23 11:13:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:14:16 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 11:14:16 - root - INFO - SQL:
SELECT "date", "zip_code", "sale_dollars"
FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
WHERE "county" = 'DUBUQUE' AND "date" BETWEEN '2022-01-01' AND '2022-12-31'
LIMIT 100;
Results:
date,zip_code,sale_dollars
2022-10-28,52002.0,65.25
2022-04-22,52002,85.5
2022-12-26,52002,48.0
2022-02-04,52040.0,40.77
2022-03-04,52002.0,38.25
2022-07-18,52001,37.14
2022-03-21,52001.0,69.78
2022-07-11,52003,87.75
2022-01-07,52001.0,49.59
2022-09-30,52056,38.97
2022-10-28,52033.0,14.93
2022-04-22,52040,12.75
2022-03-29,52001.0,10.5
2022-10-31,52001.0,17.25
2022-12-09,52002.0,103.5
2022-06-20,52003.0,87.63
2022-06-13,52003.0,77.4
2022-08-30,52003,37.14
2022-10-31,52003.0,57.6
2022-01-07,52001.0,18.0
2022-10-31,52001.0,123.75
2022-11-11,52001.0,65.25
2022-12-05,52001.0,56.16
2022-12-30,52040,6.9
2022-08-22,52002.0,6.6
2022-12-27,52001,8.31
2022-12-09,52040.0,4.95
2022-07-29,52001,11.21
2022-04-18,52003,11.21
2022-01-31,52001.0,7.2
2022-04-22,52001,7.2
2022-09-19,52001,38.7
2022-10-31,52002.0,32.16
2022-07-15,52001,31.4
2022-07-22,52001,93.0
2022-04-01,52001.0,108.0
2022-11-11,52040.0,87.0
2022-05-27,52001.0,66.0
2022-11-11,52040.0,66.0
2022-04-01,52001.0,66.0
2022-12-09,52001.0,59.96
2022-03-25,52002.0,21.6
2022-08-22,52003.0,49.52
2022-09-12,52001,60.0
2022-05-16,52001.0,45.0
2022-01-14,52001.0,45.0
2022-01-17,52001.0,30.15
2022-12-19,52002.0,77.4
2022-07-15,52040,77.4
2022-04-15,52001,77.4
2022-12-02,52001.0,76.5
2022-01-24,52001.0,58.5
2022-09-12,52003,64.56
2022-08-19,52001.0,67.8
2022-04-11,52001.0,71.94
2022-02-11,52040.0,38.7
2022-01-17,52001.0,29.88
2022-03-21,52003.0,7.74
2022-01-31,52003.0,7.74
2022-10-24,52001.0,77.4
2022-08-09,52002.0,7.74
2022-08-05,52040.0,18.5
2022-05-16,52001.0,29.86
2022-05-20,52033.0,34.5
2022-10-24,52003.0,77.4
2022-07-18,52003,14.93
2022-05-23,52003.0,7.5
2022-03-14,52003.0,7.5
2022-06-17,52001.0,62.28
2022-08-02,52001.0,58.5
2022-01-28,52002.0,64.02
2022-01-21,52001.0,132.78
2022-06-10,52003.0,84.96
2022-12-12,52002.0,135.0
2022-02-18,52040.0,103.5
2022-11-04,52001.0,103.98
2022-07-15,52001,103.98
2022-12-30,52002,154.8
2022-05-23,52003.0,7.26
2022-08-16,52002.0,13.13
2022-11-21,52003.0,8.1
2022-08-12,52001.0,154.8
2022-01-10,52002.0,34.5
2022-11-28,52001.0,14.1
2022-10-10,52001.0,47.25
2022-05-02,52001.0,146.22
2022-03-14,52001.0,155.22
2022-07-25,52002,56.28
2022-06-27,52001,47.52
2022-06-10,52001.0,134.88
2022-04-11,52001.0,104.96
2022-01-21,52040.0,129.0
2022-07-18,52002,84.0
2022-08-30,52001,23.92
2022-03-29,52003.0,24.39
2022-07-29,52001,59.96
2022-04-15,52001.0,42.0
2022-10-21,52001.0,42.0
2022-09-19,52001,59.92
2022-11-04,52001.0,17.85

2025-01-23 11:14:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:14:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:14:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:14:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-23 11:14:17 - snowflake.connector.connection - INFO - closed
2025-01-23 11:14:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:15:06 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 11:15:06 - root - INFO - ```sql
SELECT "date", "zip_code", "sale_dollars"
FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
WHERE "county" ILIKE '%DUBUQUE%'
LIMIT 100;
```
2025-01-23 11:15:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:15:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:15:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:15:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 11:15:08 - snowflake.connector.connection - INFO - closed
2025-01-23 11:15:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:16:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 11:16:10 - root - INFO - SQL:
SELECT "date", "zip_code", "sale_dollars"
FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
WHERE "county" ILIKE '%DUBUQUE%'
LIMIT 100;
Results:
date,zip_code,sale_dollars
2024-07-15,52002.0,-42.0
2023-03-22,52033,-153.0
2023-10-19,52040.0,-171.0
2023-07-21,52001.0,-256.5
2022-11-04,52040.0,77.4
2021-09-20,52001.0,77.4
2023-12-11,52003.0,77.4
2021-10-01,52056.0,11.03
2024-09-09,52002.0,8.64
2021-03-09,52040.0,12.75
2021-04-02,52040.0,8.1
2020-03-23,52001.0,8.1
2020-11-09,52003.0,9.26
2024-08-19,52001.0,17.25
2021-10-19,52001.0,10.5
2024-06-24,52003.0,10.5
2022-05-16,52003.0,7.5
2023-07-17,52002.0,8.82
2024-07-30,52003.0,8.82
2022-06-24,52056,7.74
2021-04-02,52040.0,6.2
2024-05-14,52001.0,30.0
2019-08-02,52001,11.21
2020-05-22,52001.0,19.2
2023-09-11,52001.0,19.2
2024-08-19,52001.0,19.2
2020-10-02,52002.0,19.2
2021-01-08,52002.0,6.6
2022-06-24,52056.0,6.9
2022-12-05,52002.0,6.9
2023-01-03,52001,8.31
2023-07-10,52001.0,7.2
2023-04-17,52001.0,8.91
2023-07-17,52001.0,38.7
2022-08-30,52001,38.7
2022-11-07,52001.0,38.7
2024-08-30,52002.0,38.7
2023-12-04,52001.0,38.7
2024-03-18,52040.0,77.4
2023-11-30,52002.0,77.4
2023-10-02,52003.0,77.4
2019-04-26,52001,106.29
2018-08-28,52033,58.68
2016-05-24,52002,58.68
2019-11-18,52001.0,56.04
2021-07-20,52002.0,63.45
2021-11-05,52001,38.25
2022-06-07,52001,77.4
2024-01-05,52002.0,77.4
2022-11-21,52001.0,77.4
2022-08-16,52003.0,41.64
2012-01-03,52004,52.26
2017-10-17,52003,53.97
2012-12-24,52002,25.74
2021-04-27,52001.0,38.97
2020-12-14,52001.0,48.0
2021-01-11,52001.0,48.0
2020-11-02,52003.0,38.97
2023-01-23,52003,38.97
2021-04-27,52002.0,65.34
2013-01-08,52001,56.22
2023-04-14,52001.0,60.72
2019-09-30,52001.0,45.0
2022-09-12,52001,38.7
2019-11-18,52003.0,23.45
2022-02-07,52001.0,44.3
2023-06-05,52001.0,7.5
2023-11-06,52003.0,7.5
2019-11-18,52068.0,7.5
2021-10-11,52002.0,7.5
2021-12-06,52001.0,7.5
2023-05-15,52003.0,7.5
2022-12-19,52002.0,7.5
2022-03-07,52002.0,20.25
2022-08-02,52003.0,13.31
2019-10-14,52001.0,13.31
2023-05-19,52002.0,7.26
2023-06-05,52002.0,7.05
2020-12-28,52003.0,6.83
2024-09-23,52001.0,77.4
2023-11-06,52001.0,77.4
2023-10-30,52001.0,77.4
2022-01-31,52001.0,7.74
2023-11-26,52033.0,77.4
2022-08-30,52001,77.4
2023-06-23,52033.0,77.4
2023-08-07,52001.0,77.4
2023-06-05,52001.0,77.4
2024-06-10,52001.0,77.4
2024-02-11,52033.0,77.4
2020-03-16,52040.0,13.59
2021-02-08,52002.0,13.13
2019-09-03,52001.0,17.25
2023-06-12,52001.0,154.8
2021-01-29,52001.0,154.8
2023-10-02,52046.0,154.8
2023-05-30,52001.0,19.36
2024-02-12,52001.0,17.82
2023-03-03,52002.0,29.86
2021-12-28,52003.0,22.06

2025-01-23 11:16:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:16:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:16:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:16:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-01-23 11:16:11 - snowflake.connector.connection - INFO - closed
2025-01-23 11:16:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:16:12 - root - INFO - SQL:
SELECT "zip_code", SUM("sale_dollars") AS "total_sales"
FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
WHERE "county" = 'DUBUQUE'
GROUP BY "zip_code"
ORDER BY "total_sales" DESC
LIMIT 100
Results:
zip_code,total_sales
52001,34647931.52000001
52001.0,30519205.209999997
52002.0,18347621.479999997
52002,14349877.149999999
52003,9703183.089999998
52003.0,7444458.529999997
52040.0,4048076.37
52040,3707512.5900000003
52068.0,1396962.0700000005
52033,1003027.1599999999
52033.0,835104.4700000001
52068,673563.2900000003
52053,621855.8099999999
52053.0,336510.8899999999
52056.0,261201.17000000004
52046.0,253029.06000000003
52046,239659.2499999999
52004,172787.68
52056,65709.25
52045.0,7812.78

2025-01-23 11:16:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:16:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:16:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:16:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 11:16:13 - snowflake.connector.connection - INFO - closed
2025-01-23 11:16:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:16:13 - root - INFO - SQL:
SELECT "date", "zip_code", "category_name", "sale_dollars"
FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
WHERE "category_name" ILIKE '%BOURBON%'
LIMIT 100
Results:
Too long, hard cut:
date,zip_code,category_name,sale_dollars
2016-10-05,52577,STRAIGHT BOURBON WHISKIES,35.73
2014-12-20,51632,STRAIGHT BOURBON WHISKIES,32.73
2014-06-10,50595,STRAIGHT BOURBON WHISKIES,35.73
2018-02-19,50701.0,STRAIGHT BOURBON WHISKIES,35.73
2016-04-07,52772,STRAIGHT BOURBON WHISKIES,35.73
2013-04-15,50702,STRAIGHT BOURBON WHISKIES,35.73
2014-08-05,51334,STRAIGHT BOURBON WHISKIES,35.73
2015-04-07,50266,STRAIGHT BOURBON WHISKIES,35.73
2018-03-29,50701.0,STRAIGHT BOURBON WHISKIES,35.73
2014-05-29,50703,STRAIGHT BOURBON WHISKIES,32.73
2017-02-13,52040,STRAIGHT BOURBON WHISKIES,35.73
2024-01-31,50219.0,STRAIGHT BOURBON WHISKIES,134.94
2013-08-08,52240,STRAIGHT BOURBON WHISKIES,60.0
2013-08-26,52601,STRAIGHT BOURBON WHISKIES,47.25
2013-05-30,52403,STRAIGHT BOURBON WHISKIES,47.25
2015-09-28,52060,STRAIGHT BOURBON WHISKIES,47.25
2016-04-18,52601,STRAIGHT BOURBON WHISKIES,47.25
2014-02-10,52738,STRAIGHT BOURBON WHISKIES,47.25
2013-05-09,52404,STRAIGHT BOURBON WHISKIES,47.25
2018-01-25,50208.0,STRAIGHT BOURBON WHISKIES,47.25
2014-04-09,52040,STRAIGHT BOURBON WHISKIES,47.25
2015-03-30,52761,STRAIGHT BOURBON WHISKIES,47.25
2013-12-10,51632,STRAIGHT BOURBON WHISKIES,47.25
2012-10-18,50112,STRAIGHT BOURBON WHISKIES,44.25
2017-12-13,52405,STRAIGHT BOURBON WHISKIES,47.25
2016-12-07,50138,STRAIGHT BOURBON WHISKIES,47.25
2014-05-14,52040,STRAIGHT BOURBON WHISKIES,47.25
2012-10-01,50702,STRAIGHT BOURBON WHISKIES,44.25
2018-05-22,51450.0,STRAIGHT BOURBON WHISKIES,47.25
2012-06-12,52003,STRAIGHT BOURBON WHISKIES,47.25
2018-02-28,51360.0,STRAIGHT BOURBON WHISKIES,47.25
2015-08-17,52632,STRAIGHT BOURBON WHISKIES,47.25
2015-07-07,50833,STRAIGHT BOURBON WHISKIES,47.25
2015-04-29,50613,STRAIGHT BOURBON WHISKIES,47.25
2016-12-23,50854,STRAIGHT BOURBON WHISKIES,47.25
2014-11-24,52240,STRAIGHT BOURBON WHISKIES,47.25
2017-01-04,50327,STRAIGHT BOURBON WHISKIES,47.25
2016-03-01,52404,STRAIGHT BOURBON WHISKIES,47.25
2012-07-09,50595,STRAIGHT BOURBON WHISKIES,44.25
2016-08-01,50216,STRAIGHT BOURBON WHISKIES,47.25
2013-01-07,52240,STRAIGHT BOURBON WHISKIES,47.25
2022-09-23,52402,STRAIGHT BOURBON WHISKIES,-468.0
2024-04-05,50635.0,STRAIGHT BOURBON WHISKIES,-90.0
2024-04-09,50702.0,STRAIGHT BOURBON WHISKIES,-234.0
2023-03-22,52033,STRAIGHT BOURBON WHISKIES,-153.0
2023-07-05,50315.0,SINGLE BARREL BOURBON WHISKIES,-180.0
2023-11-30,52627.0,STRAIGHT BOURBON WHISKIES,-48.0
2023-02-27,51241.0,STRAIGHT BOURBON WHISKIES,-76.56
2023-09-20,52172.0,STRAIGHT BOURBON WHISKIES,-96.0
2024-07-09,52340.0,STRAIGHT BOURBON WHISKIES,-189.0
2023-11-03,52722.0,STRAIGHT BOURBON WHISKIES,-60.0
2022-12-29,50265,STRAIGHT BOURBON WHISKIES,-37.5
2024-03-04,52632.0,STRAIGHT BOURBON WHISKIES,-193.5
2023-12-06,50266.0,STRAIGHT BOURBON WHISKIES,-336.12
2023-06-28,52349.0,STRAIGHT BOURBON WHISKIES,-16.8
2022-10-14,52353.0,STRAIGHT BOURBON WHISKIES,-6.38
2012-01-10,52356,STRAIGHT BOURBON WHISKIES,47.25
2012-03-07,50023,STRAIGHT BOURBON WHISKIES,47.25
2014-01-14,50854,STRAIGHT BOURBON WHISKIES,47.25
2016-10-10,52402,STRAIGHT BOURBON WHISKIES,47.25
2016-01-13,50588,STRAIGHT BOURBON WHISKIES,47.25
2017-04-13,52806.0,STRAIGHT BOURBON WHISKIES,47.25
2014-07-10,50125,STRAIGHT BOURBON WHISKIES,47.25
2015-06-25,50310,STRAIGHT BOURBON WHISKIES,47.25
2013-06-10,50701,STRAIGHT BOURBON WHISKIES,47.25
2017-01-04,51301,STRAIGHT BOURBON WHISKIES,47.25
2017-07-31,52060.0,STRAIGHT BOURBON WHISKIES,47.25
2013-04-09,51537,STRAIGHT BOURBON WHISKIES,47.25
2023-12-26,52404.0,STRAIGHT BOURBON WHISKIES,56.25
2024-07-29,51025.0,STRAIGHT BOURBON WHISKIES,135.0
2022-08-10,52632.0,STRAIGHT BOURBON WHISKIES,71.55
2022-02-21,52404.0,STRAIGHT BOURBON WHISKIES,101.25
2022-01-28,50003.0,STRAIGHT BOURBON WHISKIES,66.18
2024-03-20,50021.0,STRAIGHT BOURBON WHISKIES,61.62
2024-06-13,50702.0,STRAIGHT BOURBON WHISKIES,61.62
2024-02-12,52401.0,STRAIGHT BOURBON WHISKIES,61.62
2021-12-28,50010.0,STRAIGHT BOURBON WHISKIES,61.62
2019-01-02,50613,STRAIGHT BOURBON WHISKIES,51.75
2022-12-06,50703.0,STRAIGHT BOURBON WHISKIES,71.55
2023-05-03,50021.0,STRAIGHT BOURBON WHISKIES,61.62
2020-12-22,50312.0,STRAIGHT BOURBON WHISKIES,56.25
2022-02-07,50314.0,STRAIGHT BOURBON WHISKIES,45.0
2014-03-17,50023,STRAIGHT BOURBON WHISKIES,103.86
2022-01-25,51445.0,STRAIGHT BOURBON WHISKIES,40.5
2019-06-07,50266,BOTTLED IN BOND BOURBON,90.0
2023-09-07,52402.0,BOTTLED IN BOND BOURBON,314.64
2023-06-12,52401.0,BOTTLED IN BOND BOURBON,292.14
2022-08-30,52722,STRAIGHT BOURBON WHISKIES,77.19
2023-11-28,51241.0,STRAIGHT BOURBON WHISKIES,81.0
2017-01-18,52241,STRAIGHT BOURBON WHISKIES,43.17
2022-12-28,50211,STRAIGHT BOURBON WHISKIES,125.97
2022-01-12,52641.0,STRAIGHT BOURBON WHISKIES,125.97
2020-09-10,50266.0,STRAIGHT BOURBON WHISKIES,134.91
2021-02-12,52601.0,STRAIGHT BOURBON WHISKIES,134.91
2014-09-09,50263,STRAIGHT BOURBON WHISKIES,116.97
2016-12-05,50314,STRAIGHT BOURBON WHISKIES,51.75
2023-02-21,50158.0,BOTTLED IN BOND BOURBON,159.57
2024-07-17,50010.0,STRAIGHT BOURBON WHISKIES,99.0
2015-10-19,52601,STRAIGHT BOURBON WHISKIES,61.44
2012-09-19,50

2025-01-23 11:16:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:16:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:16:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:16:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 12
2025-01-23 11:16:15 - snowflake.connector.connection - INFO - closed
2025-01-23 11:16:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:16:15 - root - INFO - SQL:
SELECT EXTRACT(MONTH FROM "date") AS "month", SUM("sale_dollars") AS "monthly_sales"
FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
WHERE "county" = 'DUBUQUE' AND "category_name" ILIKE '%BOURBON%' AND "date" BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY "month"
ORDER BY "month"
LIMIT 100
Results:
month,monthly_sales
1,71730.77999999998
2,77228.39
3,68318.32999999997
4,94734.44000000002
5,63659.44
6,60381.58
7,88831.91000000002
8,106720.09000000001
9,74031.47
10,97870.08
11,71036.08000000002
12,101420.09

2025-01-23 11:16:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:16:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:16:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:16:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 11:16:17 - snowflake.connector.connection - INFO - closed
2025-01-23 11:16:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:16:17 - root - INFO - SQL:
SELECT "zipcode", SUM("population") AS "population_over_21"
FROM "IOWA_LIQUOR_SALES_PLUS"."CENSUS_BUREAU_USA"."POPULATION_BY_ZIP_2010"
WHERE "minimum_age" >= 21
GROUP BY "zipcode"
LIMIT 100
Results:
zipcode,population_over_21
28645,35338
97361,7480
85745,26789
21402,2516
13501,26203
95991,26995
80906,28155
70719,3071
75231,24958
53040,5867
75009,5762
33981,7789
7821,6541
49866,5875
1462,7438
31808,4820
87740,5981
93730,6943
28110,33590
97487,6277
10970,7668
78112,5085
85131,13882
91942,29672
98661,29838
8805,9092
48111,30551
19530,10371
78840,31654
70341,3140
49302,5188
34224,13330
5488,5636
43964,7318
3036,3273
49057,4518
30457,4553
32064,4686
35654,6147
43326,9676
97089,8669
28327,11183
49008,11933
86045,6777
70812,7267
91914,9765
62294,10029
32097,11229
38261,12467
90804,28147
48423,23506
90713,20039
39532,23375
97331,204
19958,16349
78757,16922
98371,15184
95112,40918
94566,28885
28390,13490
46545,18455
77021,18226
45680,9539
12601,29901
47872,6966
45152,7910
1057,6292
28461,13165
41139,6238
60638,39768
53185,13258
7823,5843
37187,4921
11757,33548
48359,5443
70392,5846
46373,9706
98438,216
32656,10138
33635,11748
86033,4545
78073,5363
28532,15127
33155,34350
79766,3960
48026,10834
71635,8951
48335,17258
78043,25517
38505,270
660,12941
51041,4559
7407,14675
92585,11719
27576,11769
7114,11535
76001,19613
28677,23608
29108,14201
85023,22197

2025-01-23 11:16:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:16:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:16:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:16:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 11:16:18 - snowflake.connector.connection - INFO - closed
2025-01-23 11:16:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:16:19 - root - INFO - SQL:
SELECT DISTINCT "date"
FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
WHERE "date" BETWEEN '2022-01-01' AND '2022-12-31'
ORDER BY "date"
LIMIT 100
Results:
date
2022-01-02
2022-01-03
2022-01-04
2022-01-05
2022-01-06
2022-01-07
2022-01-09
2022-01-10
2022-01-11
2022-01-12
2022-01-13
2022-01-14
2022-01-16
2022-01-17
2022-01-18
2022-01-19
2022-01-20
2022-01-21
2022-01-23
2022-01-24
2022-01-25
2022-01-26
2022-01-27
2022-01-28
2022-01-30
2022-01-31
2022-02-01
2022-02-02
2022-02-03
2022-02-04
2022-02-06
2022-02-07
2022-02-08
2022-02-09
2022-02-10
2022-02-11
2022-02-13
2022-02-14
2022-02-15
2022-02-16
2022-02-17
2022-02-18
2022-02-20
2022-02-21
2022-02-22
2022-02-23
2022-02-24
2022-02-25
2022-02-26
2022-02-27
2022-02-28
2022-03-01
2022-03-02
2022-03-03
2022-03-04
2022-03-06
2022-03-07
2022-03-08
2022-03-09
2022-03-10
2022-03-11
2022-03-13
2022-03-14
2022-03-15
2022-03-16
2022-03-17
2022-03-18
2022-03-20
2022-03-21
2022-03-22
2022-03-23
2022-03-24
2022-03-25
2022-03-27
2022-03-28
2022-03-29
2022-03-30
2022-03-31
2022-04-01
2022-04-03
2022-04-04
2022-04-05
2022-04-06
2022-04-07
2022-04-08
2022-04-10
2022-04-11
2022-04-12
2022-04-13
2022-04-14
2022-04-15
2022-04-17
2022-04-18
2022-04-19
2022-04-20
2022-04-21
2022-04-22
2022-04-23
2022-04-25
2022-04-26

2025-01-23 11:16:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:16:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:16:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:16:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 11:16:20 - snowflake.connector.connection - INFO - closed
2025-01-23 11:16:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:16:21 - root - INFO - SQL:
SELECT "date", "zip_code", "sale_dollars"
FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
WHERE "county" = 'DUBUQUE' AND "category_name" ILIKE '%BOURBON%' AND "date" BETWEEN '2022-01-01' AND '2022-12-31'
LIMIT 100
Results:
date,zip_code,sale_dollars
2022-10-28,52002.0,21.0
2022-05-16,52001.0,126.0
2022-06-07,52002,27.0
2022-05-31,52001.0,6.38
2022-02-14,52001.0,20.54
2022-01-17,52001.0,57.0
2022-07-15,52001,18.75
2022-06-04,52002,97.02
2022-12-02,52001.0,67.5
2022-03-25,52001.0,67.48
2022-02-25,52001.0,33.0
2022-06-07,52001,52.5
2022-08-26,52002,60.78
2022-04-11,52003.0,51.0
2022-01-10,52001.0,67.2
2022-08-19,52001.0,108.0
2022-10-07,52001.0,52.5
2022-02-21,52001.0,105.0
2022-02-18,52033.0,135.0
2022-07-08,52002,10.5
2022-08-16,52001.0,6.38
2022-08-16,52001.0,21.0
2022-06-04,52002,193.5
2022-05-20,52033.0,83.16
2022-05-02,52001.0,30.0
2022-06-10,52001,90.0
2022-04-11,52002.0,25.2
2022-02-18,52001.0,405.0
2022-04-22,52001,37.5
2022-08-05,52001.0,37.5
2022-10-17,52003.0,73.5
2022-07-18,52003,94.5
2022-03-25,52001.0,33.0
2022-09-09,52001,672.24
2022-08-05,52001.0,139.41
2022-05-20,52056.0,75.16
2022-12-27,52001,56.0
2022-06-17,52001.0,33.0
2022-05-13,52002.0,25.2
2022-11-25,52001.0,75.0
2022-07-22,52001,101.25
2022-10-31,52003.0,63.0
2022-02-04,52001.0,82.5
2022-05-27,52001.0,31.5
2022-08-12,52001.0,31.5
2022-04-05,52001.0,126.0
2022-06-27,52002,180.0
2022-08-30,52001,154.44
2022-04-18,52001,154.44
2022-11-25,52040.0,112.5
2022-10-10,52001.0,283.5
2022-02-18,52003.0,180.0
2022-01-28,52040.0,66.0
2022-04-29,52040,66.0
2022-04-25,52003,21.0
2022-01-10,52003.0,82.5
2022-08-26,52033,154.44
2022-09-12,52001,157.5
2022-06-24,52001.0,157.5
2022-04-05,52003.0,202.5
2022-08-30,52003,189.0
2022-10-07,52040.0,246.0
2022-11-21,52002.0,162.0
2022-07-01,52001,283.5
2022-12-30,52056,57.0
2022-03-25,52002.0,288.0
2022-01-10,52068.0,288.0
2022-09-30,52040,198.0
2022-01-31,52068.0,162.9
2022-10-31,52003.0,168.06
2022-04-29,52002,72.0
2022-11-07,52068.0,99.0
2022-02-07,52003.0,98.28
2022-08-30,52001,283.5
2022-08-26,52002,180.0
2022-12-27,52001,87.0
2022-11-25,52001.0,78.0
2022-11-14,52068.0,198.0
2022-12-02,52003.0,198.0
2022-06-17,52001.0,112.5
2022-03-18,52040.0,121.5
2022-02-11,52001.0,202.5
2022-03-18,52040.0,112.5
2022-02-18,52040.0,174.72
2022-01-31,52068.0,189.0
2022-12-02,52001.0,283.5
2022-11-04,52003.0,180.0
2022-01-24,52002.0,198.0
2022-09-16,52002,157.5
2022-02-07,52002.0,10.5
2022-04-25,52001,52.5
2022-03-25,52001.0,225.0
2022-05-09,52001.0,99.0
2022-11-21,52001.0,73.8
2022-04-25,52003,10.5
2022-01-10,52001.0,21.0
2022-04-11,52001.0,104.96
2022-01-21,52040.0,129.0
2022-12-05,52002.0,10.5
2022-06-07,52003,96.72

2025-01-23 11:16:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:16:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:16:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:16:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 11:16:22 - snowflake.connector.connection - INFO - closed
2025-01-23 11:16:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:16:23 - root - INFO - SQL:
SELECT "zipcode", SUM("population") AS "total_population"
FROM "IOWA_LIQUOR_SALES_PLUS"."CENSUS_BUREAU_USA"."POPULATION_BY_ZIP_2010"
GROUP BY "zipcode"
LIMIT 100
Results:
zipcode,total_population
49336,13056
72106,16128
1960,152832
79322,6147
50833,6915
12483,777
40052,1545
29686,3081
8353,1548
12965,1548
44048,7695
59639,3858
7606,6930
8648,96789
1436,10008
89169,69912
4981,6948
38117,78375
80812,825
68517,1614
99201,40026
36343,4737
97914,57615
30808,13845
55374,40728
21856,3105
12071,810
42332,813
16929,6960
37144,10032
65025,2358
8348,825
5744,1599
61817,7749
98359,14661
46550,36933
70072,169032
52159,6990
27927,1626
48892,13146
25906,861
39082,3936
49646,24687
83670,1659
74081,5511
77973,150
46403,37803
72634,14010
55040,37704
71826,3945
79257,3201
25201,165
12438,177
11228,125364
51454,4038
72360,19398
60031,113841
67039,10185
39886,4848
39090,40194
79703,61776
77340,89427
21626,360
64733,3477
13776,1539
97038,45339
78717,67614
40175,39210
12143,15411
54840,13929
36009,7698
3220,22290
74735,4647
46371,10797
44106,80688
83702,66879
1077,28506
55370,2406
51579,7020
79505,888
82637,12408
91206,99195
53934,13188
89502,130698
98321,45456
39736,936
58272,936
78934,20136
37909,45504
67021,195
76374,12486
70080,4668
1029,2367
47648,13119
14846,2376
54135,9288
84081,122196
17223,867
92545,118371
31642,14694

2025-01-23 11:16:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:16:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:16:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:16:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 11:16:24 - snowflake.connector.connection - INFO - closed
2025-01-23 11:16:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:16:25 - root - INFO - SQL:
SELECT "date", "zip_code", "store_name", "category_name", "sale_dollars"
FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
WHERE "county" = 'DUBUQUE' AND "date" BETWEEN '2022-01-01' AND '2022-12-31'
LIMIT 100
Results:
Too long, hard cut:
date,zip_code,store_name,category_name,sale_dollars
2022-10-28,52002.0,HY-VEE #2 / DUBUQUE,IMPORTED CORDIALS & LIQUEURS,65.25
2022-04-22,52002,HY-VEE #2 / DUBUQUE,IMPORTED CORDIALS & LIQUEURS,85.5
2022-12-26,52002,HY-VEE #2 / DUBUQUE,IMPORTED SCHNAPPS,48.0
2022-02-04,52040.0,RANDY'S NEIGHBORHOOD MARKET / DYERSVILLE,TEMPORARY & SPECIALTY PACKAGES,40.77
2022-03-04,52002.0,HY-VEE #2 / DUBUQUE,AMERICAN CORDIALS & LIQUEURS,38.25
2022-07-18,52001,BEECHER LIQUOR / DUBUQUE,AMERICAN FLAVORED VODKA,37.14
2022-03-21,52001.0,SUPER STOP IV - DUBUQUE,TENNESSEE WHISKIES,69.78
2022-10-10,52001.0,NORTH SIDE LIQUOR & TOBACCO / DUBUQUE,MIXTO TEQUILA,47.25
2022-05-02,52001.0,EZ STOP 1 / DUBUQUE,100% AGAVE TEQUILA,146.22
2022-03-14,52001.0,WALGREENS #11942 / DUBUQUE,100% AGAVE TEQUILA,155.22
2022-07-25,52002,HY-VEE FAST AND FRESH - DUBUQUE,MIXTO TEQUILA,56.28
2022-06-27,52001,NORTH SIDE LIQUOR & TOBACCO / DUBUQUE,WHISKEY LIQUEUR,47.52
2022-06-10,52001.0,HY-VEE #3 / DUBUQUE,IRISH WHISKIES,134.88
2022-04-11,52001.0,SUPER STOP IV - DUBUQUE,STRAIGHT BOURBON WHISKIES,104.96
2022-01-21,52040.0,RANDY'S NEIGHBORHOOD MARKET / DYERSVILLE,STRAIGHT BOURBON WHISKIES,129.0
2022-07-18,52002,WALGREENS #06154 / DUBUQUE,IMPORTED DRY GINS,84.0
2022-08-30,52001,EZ STOP 1 / DUBUQUE,AMERICAN DRY GINS,23.92
2022-03-29,52003.0,SID'S BEVERAGE SHOP,AMERICAN SLOE GINS,24.39
2022-07-29,52001,HY-VEE #3 / DUBUQUE,IMPORTED VODKAS,59.96
2022-04-15,52001.0,HY-VEE FOOD STORE / DUBUQUE,AMERICAN VODKAS,42.0
2022-10-21,52001.0,HY-VEE #3 / DUBUQUE,AMERICAN VODKAS,42.0
2022-09-19,52001,EZ STOP 1 / DUBUQUE,AMERICAN VODKAS,59.92
2022-07-15,52001,HY-VEE #3 / DUBUQUE,AMERICAN FLAVORED VODKA,42.0
2022-09-30,52001,HY-VEE #3 / DUBUQUE,WHITE RUM,52.56
2022-01-28,52001.0,FAREWAY STORES #114 / DUBUQUE,AMERICAN BRANDIES,39.0
2022-05-27,52001.0,HY-VEE #3 / DUBUQUE,AMERICAN BRANDIES,28.56
2022-03-14,52001.0,NORTH SIDE LIQUOR & TOBACCO / DUBUQUE,IMPORTED FLAVORED VODKA,98.96
2022-03-25,52002.0,HY-VEE #2 / DUBUQUE,WHISKEY LIQUEUR,64.0
2022-10-10,52002.0,DUBUQUE WINE & SPIRITS,WHISKEY LIQUEUR,387.0
2022-08-05,52001.0,HY-VEE #3 / DUBUQUE,IMPORTED CORDIALS & LIQUEURS,86.12
2022-10-28,52001.0,HY-VEE #3 / DUBUQUE,CREAM LIQUEURS,98.96
2022-05-16,52002.0,DUBUQUE WINE & SPIRITS,IMPORTED SCHNAPPS,51.96
2022-04-29,52001,HY-VEE #3 / DUBUQUE,FLAVORED RUM,54.36
2022-03-25,52001.0,HY-VEE #3 / DUBUQUE,AMERICAN CORDIALS & LIQUEURS,51.0
2022-11-28,52001.0,BEECHER LIQUOR / DUBUQUE,AMERICAN FLAVORED VODKA,41.64
2022-12-05,52003.0,SID'S BEVERAGE SHOP,AMERICAN FLAVORED VODKA,41.64
2022-09-16,52001,HY-VEE FOOD STORE / DUBUQUE,TENNESSEE WHISKIES,95.48
2022-07-18,52003,SID'S BEVERAGE SHOP,WHITE RUM,48.96
2022-04-22,52033,CASEY'S GENERAL STORE #77 / CASCADE,AMERICAN VODKAS,24.3
2022-12-09,52040.0,RANDY'S NEIGHBORHOOD MARKET / DYERSVILLE,SCOTCH WHISKIES,79.5
2022-02-07,52003.0,SID'S BEVERAGE SHOP,AMERICAN FLAVORED VODKA,56.25
2022-07-22,52001,HY-VEE #3 / DUBUQUE,WHITE RUM,65.7
2022-01-17,52001.0,KWIK STOP C-STORES / DUBUQUE,SPICED RUM,75.0
2022-01-28,52002.0,HY-VEE #2 / DUBUQUE,AMERICAN FLAVORED VODKA,61.9
2022-12-27,52003,SID'S BEVERAGE SHOP,100% AGAVE TEQUILA,127.5
2022-05-27,52001.0,HY-VEE #3 / DUBUQUE,AMERICAN DRY GINS,21.0
2022-09-16,52001,HY-VEE #3 / DUBUQUE,WHITE RUM,57.0
2022-04-22,52001,HY-VEE #3 / DUBUQUE,AMERICAN BRANDIES,42.8
2022-12-30,52001,HY-VEE #3 / DUBUQUE,IMPORTED CORDIALS & LIQUEURS,104.52
2022-05-06,52001.0,HY-VEE #3 / DUBUQUE,MIXTO TEQUILA,47.0
2022-05-20,52001.0,HY-VEE FOOD STORE / DUBUQUE,STRAIGHT BOURBON WHISKIES,202.5
2022-05-31,52068.0,FAREWAY STORES #168/ PEOSTA,STRAIGHT BOURBON WHISKIES,168.06
2022-01-28,52040.0,FAREWAY STORES #008 / DYERSVILLE,STRAIGHT BOURBON WHISKIES,162.9
2022-11-25,52040.0,HY-VEE DYERSVILLE DOLLAR FRESH,STRAIGHT BOURBON WHISKIES,180.0
2022-12-16,52001.0,HY-VEE FOOD STORE / DUBUQUE,BLENDED WHISKIES,195.06
2022-12-16,52001.0,HY-VEE FOOD STORE / DUBUQUE,BLENDED WHISKIES,103.5
2022-12-27,52001,HY-VEE #3 / DUBUQUE,IMPORTED FLAVORED VODKA,89.94
2022-10-28,52003.0,TARGET STORE T-0086 / DUBUQUE,IMPORTED VODKAS,112.5
2022-12-07,52001.0,BP FUEL / DUBUQUE,IMPORTED VODKAS,153.0
2022-07-11,52003,SID'S BEVERAGE SHOP,IMPORTED CORDIALS & LIQUEURS,87.75
2022-01-07,52001.0,HY-VEE FOOD STORE / DUBUQUE,IMPORTED CORDIALS & LIQUEURS,49.59
2022-09-30,52056,LUXEMBURG LIQUOR TOBACCO & GAS,IMPORTED SCHNAPPS,38.97
2022-10-03,52001.0,EZ STOP II - DUBUQUE,AMERICAN VODKAS,50.4
2022-06-27,52001,BIG 10 MART,AMERICAN VODKAS,97.56
2022-08-22,52001.0,NORTH SIDE LIQUOR & TOBACCO / DUBUQUE,WHITE RUM,90.0
2022-08-19,52002.0,HY-VEE #2 / DUBUQUE,AGED DARK RUM,193.44
2022-07-18,52001,BEECHER LIQUOR / DUBUQUE,IMPORTED BRANDIES,267.12
2022-05-06,52002.0,HY-VEE #2 / DUBUQUE,IMPORTED BRANDIES,292.32
2022-11-28,52001.0,"LIQUOR, TOBACCO & GROCERY / DUBUQUE",IMPORTED BRANDIES,292.32
2022-10-10,52001.0,NORTH SIDE LIQUOR & TOBACCO / DUBUQUE,IMPORTED BRANDIES,241.92
2022-10-21,52002.0,HY-VEE #2 / DUBUQUE,IMPORTED CORDIALS & LIQUEURS,207.0
2022-11-11,52040.0,FAREWAY STORES #008 / DYERSVILLE,IRISH WHISKIES,1

2025-01-23 11:16:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:16:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:16:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:16:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 11:16:26 - snowflake.connector.connection - INFO - closed
2025-01-23 11:16:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:16:26 - root - INFO - SQL:
SELECT "zip_code", SUM("sale_dollars") AS "total_bourbon_sales"
FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
WHERE "category_name" ILIKE '%BOURBON%' AND "date" BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY "zip_code"
ORDER BY "total_bourbon_sales" DESC
LIMIT 100
Results:
zip_code,total_bourbon_sales
50266.0,1653838.0299999996
52241.0,951686.0499999997
50010.0,870491.85
52807.0,867627.9100000001
50314.0,820947.2099999996
52240.0,794698.9699999997
50021.0,766809.9700000001
50266,671062.1
50320.0,665611.1200000001
52402.0,614687.8199999998
50322.0,596128.2299999999
51501.0,499705.1500000001
50613.0,486655.31000000006
50311.0,459304.0500000001
50265.0,409245.87999999995
52241,408649.76000000007
50010,380132.5600000001
50314,375707.7399999999
50320,356578.76000000007
52722.0,351855.37999999995
52402,344532.21
50401.0,341241.62000000005
52401.0,319284.4600000001
50263.0,317610.70000000007
50702.0,316996.3600000001
52742.0,315592.5300000001
52404.0,310826.04999999993
52240,310388.87999999995
52807,310126.42000000016
50009.0,301421.8200000001
50023.0,298527.23000000016
51503.0,292684.23
50613,291779.19000000006
50021,283256.86
52411.0,275432.56
51106.0,265378.02999999997
50111.0,250535.76
52001.0,245765.34000000003
52302.0,242813.32999999996
52761.0,233057.45
52002.0,231346.63999999996
51501,219911.82999999996
52501.0,206332.84000000005
50158.0,198348.44000000003
50317.0,193551.09000000005
50265,191140.29000000004
50321.0,182888.68
50501.0,182288.83999999994
50322,180216.87999999995
50311,177113.50999999998
50263,174334.59
52601.0,171208.21000000008
52804.0,170753.37000000005
50125.0,168857.43000000008
50315.0,164952.54
52404,159166.61000000002
52405.0,157938.92
52722,155974.22000000003
52001,154214.62999999998
50401,152304.62999999998
52806.0,152019.23999999996
50131.0,151610.75
51503,149632.67999999996
52632.0,144775.59000000003
52411,144433.17000000004
50009,143682.55000000002
52314.0,143509.12999999998
52732.0,142930.06000000003
52302,141416.36
50219.0,141188.66000000003
50111,140437.05000000002
50023,137239.64999999997
52403.0,135590.21999999997
50702,133754.80000000002
52317.0,131905.93
51360.0,131075.01
50701.0,130458.43000000001
51106,129398.58999999998
52401,124517.09
50208.0,124392.12999999996
52742,124236.36999999998
50677.0,121853.49999999999
52577.0,121158.33000000003
52761,119440.02999999997
50036.0,118702.2
52101.0,115899.06
51301.0,114121.52
51401.0,111657.31000000001
50158,109972.9
50312.0,107221.51999999999
51031.0,105915.00000000001
52501,101081.91000000003
50501,100699.85000000002
52003.0,99394.43000000002
52601,96508.95
52556.0,93914.65000000002
50112.0,93096.97
52641.0,92192.60999999999
52353.0,91642.69000000003
52806,91279.04999999999

2025-01-23 11:16:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:16:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:16:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:16:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 11:16:28 - snowflake.connector.connection - INFO - closed
2025-01-23 11:16:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:16:28 - root - INFO - SQL:
SELECT "zip_code", EXTRACT(MONTH FROM "date") AS "month", SUM("sale_dollars") AS "monthly_sales"
FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
WHERE "county" = 'DUBUQUE' AND "category_name" ILIKE '%BOURBON%' AND "date" BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY "zip_code", "month"
ORDER BY "zip_code", "month"
LIMIT 100
Results:
zip_code,month,monthly_sales
52001,1,105.3
52001,2,584.85
52001,4,16556.31
52001,5,679.5
52001,6,9417.109999999999
52001,7,37462.22
52001,8,32023.76999999999
52001,9,34684.64
52001,12,22700.93
52001.0,1,27357.010000000002
52001.0,2,32671.499999999996
52001.0,3,25274.08
52001.0,4,19475.9
52001.0,5,25563.559999999998
52001.0,6,14358.809999999998
52001.0,8,15205.04
52001.0,10,30352.590000000007
52001.0,11,31060.319999999992
52001.0,12,24446.530000000002
52002,4,15535.669999999998
52002,6,11692.86
52002,7,25704.139999999996
52002,8,4658.46
52002,9,19017.51
52002,12,12400.64
52002.0,1,23102.65
52002.0,2,26665.790000000008
52002.0,3,23474.11
52002.0,4,17791.43
52002.0,5,20221.850000000002
52002.0,6,7525.540000000001
52002.0,8,30692.140000000003
52002.0,10,45917.43
52002.0,11,20769.74
52002.0,12,15185.96
52003,4,7461.08
52003,6,3153.61
52003,7,11967.09
52003,8,2252.9900000000002
52003,9,12665.890000000001
52003,12,6256.41
52003.0,1,13113.409999999998
52003.0,2,9806.699999999999
52003.0,3,8612.109999999999
52003.0,4,6072.69
52003.0,5,10125.08
52003.0,6,5634.789999999999
52003.0,8,12497.66
52003.0,10,12735.14
52003.0,11,10800.0
52003.0,12,9996.849999999999
52033,4,210.6
52033,6,375.75
52033,7,1001.28
52033,8,647.22
52033,9,1883.49
52033,12,357.0
52033.0,1,1393.44
52033.0,2,696.3
52033.0,3,1098.51
52033.0,4,607.74
52033.0,5,947.6
52033.0,6,234.0
52033.0,8,683.3700000000001
52033.0,10,895.5
52033.0,11,1138.38
52033.0,12,658.5
52040,4,3782.27
52040,6,2444.04
52040,7,7743.0199999999995
52040,8,803.97
52040,9,3323.0599999999995
52040,12,3007.6499999999996
52040.0,1,2380.98
52040.0,2,5374.410000000001
52040.0,3,4695.299999999999
52040.0,4,2079.05
52040.0,5,4912.08
52040.0,6,3812.5699999999997
52040.0,8,4585.62
52040.0,10,3699.91
52040.0,11,3687.5
52040.0,12,4771.620000000001
52046,4,201.6
52046,7,198.0
52046.0,10,399.6
52053,7,975.72
52053,8,413.21999999999997
52053,9,94.5
52053.0,1,409.17
52053.0,2,258.78
52053.0,3,901.47
52053.0,4,94.5
52053.0,8,183.42000000000002
52053.0,10,328.5
52053.0,11,477.0
52053.0,12,75.0
52056,4,612.6600000000001
52056,6,18.75
52056,7,1885.38

2025-01-23 11:16:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:16:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:16:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:16:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 11:16:29 - snowflake.connector.connection - INFO - closed
2025-01-23 11:16:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:16:30 - root - INFO - SQL:
SELECT "store_number", "store_name", "address", "city", "zip_code", "sale_dollars"
FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
WHERE "county" = 'DUBUQUE'
LIMIT 100
Results:
Too long, hard cut:
store_number,store_name,address,city,zip_code,sale_dollars
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001,106.29
2624,HY-VEE #2 / DUBUQUE,2395 NW ARTERIAL RD,DUBUQUE,52002.0,184.5
2624,HY-VEE #2 / DUBUQUE,2395 NW ARTERIAL RD,DUBUQUE,52002.0,94.47
5660,NORTH SIDE LIQUOR & TOBACCO / DUBUQUE,2013 CENTRAL AVE,DUBUQUE,52001.0,58.5
5660,NORTH SIDE LIQUOR & TOBACCO / DUBUQUE,2013 CENTRAL AVE,DUBUQUE,52001.0,58.5
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001.0,65.25
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001.0,57.39
5042,SUPER STOP III / DUBUQUE,1101 RHOMBERG AVE,DUBUQUE,52001.0,83.28
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001,85.5
2649,HY-VEE #3 / DUBUQUE,400 LOCUST ST,DUBUQUE,52001,50.64
2649,HY-VEE #3 / DUBUQUE,400 LOCUST ST,DUBUQUE,52001,50.64
4167,"IOWA STREET MARKET, INC.",1256 IOWA ST,DUBUQUE,52001,67.5
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001,48.0
3841,HARTIG DRUG COMPANY #2 / LOCUST,157 LOCUST ST,DUBUQUE,52001.0,48.0
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001.0,48.0
5042,SUPER STOP III / DUBUQUE,1101 RHOMBERG AVE,DUBUQUE,52001,48.0
2465,SID'S BEVERAGE SHOP,2727 DODGE ST,DUBUQUE,52003,13.47
2465,SID'S BEVERAGE SHOP,2727 DODGE ST,DUBUQUE,52003.0,108.0
5732,BEECHER CO INC,1691 ASBURY ROAD,DUBUQUE,52001.0,74.22
2624,HY-VEE #2 / DUBUQUE,2395 NW ARTERIAL RD,DUBUQUE,52002,65.25
2624,HY-VEE #2 / DUBUQUE,2395 NW ARTERIAL RD,DUBUQUE,52002,58.56
2465,SID'S BEVERAGE SHOP,2727 DODGE ST,DUBUQUE,52003,58.5
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001,104.88
4167,"IOWA STREET MARKET, INC.",1256 IOWA ST,DUBUQUE,52001,54.24
2624,HY-VEE #2 / DUBUQUE,2395 NW ARTERIAL RD,DUBUQUE,52002.0,65.25
5732,BEECHER CO INC,1691 ASBURY ROAD,DUBUQUE,52001.0,78.66
2649,HY-VEE #3 / DUBUQUE,400 LOCUST ST,DUBUQUE,52001.0,90.0
4334,FAREWAY STORES #114 / DUBUQUE,2050 JOHN F KENNEDY RD,DUBUQUE,52001.0,78.75
2624,HY-VEE #2 / DUBUQUE,2395 NW ARTERIAL RD,DUBUQUE,52002,85.5
4106,HARTIG DRUG COMPANY #3/JFK,2255 JOHN F KENNEDY RD,DUBUQUE,52002.0,74.22
5529,BIG 10 MART,2100 JFK RD,DUBUQUE,52001,56.25
4712,WALGREENS #11942 / DUBUQUE,345 E 20TH ST,DUBUQUE,52001.0,60.75
2465,SID'S BEVERAGE SHOP,2727 DODGE ST,DUBUQUE,52003.0,83.25
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001.0,40.5
4171,"BROTHERS MARKET, INC. / CASCADE",105 SE NIXON ST,CASCADE,52033.0,38.97
2624,HY-VEE #2 / DUBUQUE,2395 NW ARTERIAL RD,DUBUQUE,52002,48.0
3738,HARTIG DRUG COMPANY #4 / DUBUQUE,2225 CENTRAL AVE,DUBUQUE,52001,38.97
3774,EAGLE COUNTRY MARKET / DUBUQUE,1800 ELM ST,DUBUQUE,52001.0,40.02
3774,EAGLE COUNTRY MARKET / DUBUQUE,1800 ELM ST,DUBUQUE,52001,38.97
4106,HARTIG DRUG COMPANY #3/JFK,2255 JOHN F KENNEDY RD,DUBUQUE,52002.0,38.97
4182,FAREWAY STORES #008 / DYERSVILLE,1207  12TH AVE SE,DYERSVILLE,52040.0,38.97
4182,FAREWAY STORES #008 / DYERSVILLE,1207  12TH AVE SE,DYERSVILLE,52040,39.03
4182,FAREWAY STORES #008 / DYERSVILLE,1207  12TH AVE SE,DYERSVILLE,52040,24.45
5597,LIQUOR TOBACCO & GAS,1401 CENTRAL AVE,DUBUQUE,52001.0,56.25
3744,RANDY'S NEIGHBORHOOD MARKET / DYERSVILLE,733 16TH AVE SE,DYERSVILLE,52040.0,40.77
2624,HY-VEE #2 / DUBUQUE,2395 NW ARTERIAL RD,DUBUQUE,52002,28.35
2624,HY-VEE #2 / DUBUQUE,2395 NW ARTERIAL RD,DUBUQUE,52002.0,38.25
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001,27.0
5042,SUPER STOP III / DUBUQUE,1101 RHOMBERG AVE,DUBUQUE,52001.0,31.5
5815,SUPER STOP IV - DUBUQUE,535 HILL STREET SUITE A,DUBUQUE,52001.0,29.25
3774,EAGLE COUNTRY MARKET / DUBUQUE,1800 ELM ST,DUBUQUE,52001,25.62
2465,SID'S BEVERAGE SHOP,2727 DODGE ST,DUBUQUE,52003.0,96.72
4334,FAREWAY STORES #114 / DUBUQUE,2050 JOHN F KENNEDY RD,DUBUQUE,52001.0,168.72
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001,55.5
2465,SID'S BEVERAGE SHOP,2727 DODGE ST,DUBUQUE,52003.0,51.0
5886,BEECHER LIQUOR / DUBUQUE,1691 ASBURY RD,DUBUQUE,52001.0,37.14
5886,BEECHER LIQUOR / DUBUQUE,1691 ASBURY RD,DUBUQUE,52001.0,37.14
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001.0,37.14
5886,BEECHER LIQUOR / DUBUQUE,1691 ASBURY RD,DUBUQUE,52001,37.14
5657,LOUST TOBACCO & LIQUOR / DUBUQUE,408 W LOCUST ST,DUBUQUE,52001,37.14
4167,"IOWA STREET MARKET, INC.",1256 IOWA ST,DUBUQUE,52001,37.14
5359,FAREWAY STORES #168/ PEOSTA,8400 NICC DRIVE,PEOSTA,52068,47.25
2624,HY-VEE #2 / DUBUQUE,2395 NW ARTERIAL RD,DUBUQUE,52002.0,47.25
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001.0,37.14
2649,HY-VEE #3 / DUBUQUE,400 LOCUST ST,DUBUQUE,52001,37.14
5427,BEECHER LIQUOR,1691 ASBURY RD,DUBUQUE,52001,37.14
2649,HY-VEE #3 / DUBUQUE,400 LOCUST ST,DUBUQUE,52001.0,37.14
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001,21.39
4167,"IOWA STREET MARKET, INC.",1256 IOWA ST,DUBUQUE,52001,21.39
2465,SID'S BEVERAGE SHOP,2727 DODGE ST,DUBUQUE,52003.0,56.25
4171,"BROTHERS MARKET, INC. / CASCADE",105 SE NIXON ST,CASCADE,52033.0,45.78
3744,RANDY'S NEIGHBORHOOD MARKET / DYERSVILLE,733 16TH AVE SE,DYERSVILLE,52040,45.0
5042,SUPER STOP III / DUBUQUE,1101 RHOMBERG AVE,DUBUQUE

2025-01-23 11:16:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:16:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:16:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:16:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 11:16:31 - snowflake.connector.connection - INFO - closed
2025-01-23 11:16:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:16:32 - root - INFO - SQL:
SELECT "zipcode", CONCAT("minimum_age", '-', "maximum_age") AS "age_range", SUM("population") AS "population_count"
FROM "IOWA_LIQUOR_SALES_PLUS"."CENSUS_BUREAU_USA"."POPULATION_BY_ZIP_2010"
GROUP BY "zipcode", "minimum_age", "maximum_age"
ORDER BY "zipcode", "minimum_age"
LIMIT 100
Results:
zipcode,age_range,population_count
10001,0-4,624
10001,5-9,458
10001,10-14,488
10001,15-17,286
10001,18-19,1090
10001,20-20,417
10001,21-21,460
10001,22-24,1755
10001,25-29,2741
10001,30-34,2095
10001,35-39,1636
10001,40-44,1464
10001,45-49,1401
10001,50-54,1305
10001,55-59,1208
10001,60-61,439
10001,62-64,608
10001,65-66,357
10001,67-69,437
10001,70-74,573
10001,75-79,468
10001,80-84,363
10001,,429
10001,,42204
10002,0-4,3620
10002,5-9,3663
10002,10-14,3660
10002,15-17,2335
10002,18-19,1763
10002,20-20,1047
10002,21-21,1138
10002,22-24,4164
10002,25-29,7458
10002,30-34,6498
10002,35-39,5711
10002,40-44,5367
10002,45-49,5483
10002,50-54,5565
10002,55-59,5327
10002,60-61,2163
10002,62-64,2599
10002,65-66,1388
10002,67-69,1855
10002,70-74,3223
10002,75-79,2815
10002,80-84,2250
10002,,2318
10002,,162820
10003,0-4,1405
10003,5-9,902
10003,10-14,737
10003,15-17,499
10003,18-19,5483
10003,20-20,2151
10003,21-21,1644
10003,22-24,4174
10003,25-29,8235
10003,30-34,6251
10003,35-39,4309
10003,40-44,3277
10003,45-49,2919
10003,50-54,2834
10003,55-59,2878
10003,60-61,1135
10003,62-64,1572
10003,65-66,824
10003,67-69,1017
10003,70-74,1328
10003,75-79,962
10003,80-84,725
10003,,763
10003,,112048
10004,0-4,202
10004,5-9,101
10004,10-14,54
10004,15-17,37
10004,18-19,22
10004,20-20,23
10004,21-21,27
10004,22-24,268
10004,25-29,567
10004,30-34,508
10004,35-39,368
10004,40-44,281
10004,45-49,169
10004,50-54,144
10004,55-59,122
10004,60-61,40
10004,62-64,56
10004,65-66,22
10004,67-69,28
10004,70-74,25
10004,75-79,12
10004,80-84,8
10004,,5
10004,,6178
10005,0-4,251
10005,5-9,84
10005,10-14,50
10005,15-17,26

2025-01-23 11:16:32 - root - INFO - itercount: 0
2025-01-23 11:16:32 - root - INFO - Database Name: IOWA_LIQUOR_SALES_PLUS
Schema Name: CENSUS_BUREAU_USA
DDL describes table information.
,0
table_name,POPULATION_BY_ZIP_2000
description,
DDL,"create or replace TABLE POPULATION_BY_ZIP_2000 (
	""zipcode"" VARCHAR(16777216),
	""geo_id"" VARCHAR(16777216),
	""minimum_age"" NUMBER(38,0),
	""maximum_age"" NUMBER(38,0),
	""gender"" VARCHAR(16777216),
	""population"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['POPULATION_BY_ZIP_2000', 'POPULATION_BY_ZIP_2010']
Database Name: IOWA_LIQUOR_SALES_PLUS
Schema Name: IOWA_LIQUOR_SALES
DDL describes table information.
,0
table_name,SALES
description,
DDL,"create or replace TABLE SALES (
	""invoice_and_item_number"" VARCHAR(16777216),
	""date"" DATE,
	""store_number"" VARCHAR(16777216),
	""store_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""zip_code"" VARCHAR(16777216),
	""store_location"" BINARY(8388608),
	""county_number"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""category"" VARCHAR(16777216),
	""category_name"" VARCHAR(16777216),
	""vendor_number"" VARCHAR(16777216),
	""vendor_name"" VARCHAR(16777216),
	""item_number"" VARCHAR(16777216),
	""item_description"" VARCHAR(16777216),
	""pack"" NUMBER(38,0),
	""bottle_volume_ml"" NUMBER(38,0),
	""state_bottle_cost"" FLOAT,
	""state_bottle_retail"" FLOAT,
	""bottles_sold"" NUMBER(38,0),
	""sale_dollars"" FLOAT,
	""volume_sold_liters"" FLOAT,
	""volume_sold_gallons"" FLOAT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'IOWA_LIQUOR_SALES_PLUS': {'CENSUS_BUREAU_USA': ['POPULATION_BY_ZIP_2000', 'POPULATION_BY_ZIP_2010'], 'IOWA_LIQUOR_SALES': ['SALES']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **From `IOWA_LIQUOR_SALES_PLUS.IOWA_LIQUOR_SALES.SALES` table:**
  - `"date"`: Used to filter sales data for the year 2022 and to group sales by month.
  - `"zip_code"`: Used to identify zip codes for aggregating sales.
  - `"county"`: Used to filter sales data for Dubuque County.
  - `"category_name"`: Used to filter sales for Bourbon Whiskey.
  - `"sale_dollars"`: Used to calculate total sales amounts.
  - `"bottles_sold"`: May be used for additional sales metrics.
  
- **From `IOWA_LIQUOR_SALES_PLUS.CENSUS_BUREAU_USA.POPULATION_BY_ZIP_2010` table:**
  - `"zipcode"`: Used to join with sales data based on zip codes.
  - `"minimum_age"` and `"maximum_age"`: Used to filter population aged 21 and over.
  - `"population"`: Used to obtain population counts for calculating per capita sales.

**Conditions That May Be Used:**

- `"county" = 'Dubuque'`: To filter sales data for Dubuque County.
- `"category_name" ILIKE '%Bourbon Whiskey%'`: To filter sales for Bourbon Whiskey.
- `"date"` between '2022-01-01' and '2022-12-31': To select sales data for the year 2022.
- `"minimum_age" >= 21`: To select population aged 21 and over.

---

**SQL Queries:**

1. **List of Counties in the Sales Data:**
   ```sql
   SELECT DISTINCT "county"
   FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
   LIMIT 100;
   ```

2. **List of Categories Containing 'Bourbon Whiskey':**
   ```sql
   SELECT DISTINCT "category_name"
   FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "category_name" ILIKE '%Bourbon Whiskey%'
   LIMIT 100;
   ```

3. **Sales Data in Dubuque County for 2022:**
   ```sql
   SELECT "date", "zip_code", "sale_dollars"
   FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "county" = 'Dubuque' AND "date" BETWEEN '2022-01-01' AND '2022-12-31'
   LIMIT 100;
   ```

4. **Total Sales per Zip Code in Dubuque County:**
   ```sql
   SELECT "zip_code", SUM("sale_dollars") AS "total_sales"
   FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "county" = 'Dubuque'
   GROUP BY "zip_code"
   ORDER BY "total_sales" DESC
   LIMIT 100;
   ```

5. **Bourbon Whiskey Sales Entries:**
   ```sql
   SELECT "date", "zip_code", "category_name", "sale_dollars"
   FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "category_name" ILIKE '%Bourbon Whiskey%'
   LIMIT 100;
   ```

6. **Monthly Bourbon Whiskey Sales in Dubuque County for 2022:**
   ```sql
   SELECT EXTRACT(MONTH FROM "date") AS "month", SUM("sale_dollars") AS "monthly_sales"
   FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "county" = 'Dubuque' AND "category_name" ILIKE '%Bourbon Whiskey%' AND "date" BETWEEN '2022-01-01' AND '2022-12-31'
   GROUP BY "month"
   ORDER BY "month"
   LIMIT 100;
   ```

7. **Population Aged 21 and Over by Zip Code:**
   ```sql
   SELECT "zipcode", SUM("population") AS "population_over_21"
   FROM "IOWA_LIQUOR_SALES_PLUS"."CENSUS_BUREAU_USA"."POPULATION_BY_ZIP_2010"
   WHERE "minimum_age" >= 21
   GROUP BY "zipcode"
   LIMIT 100;
   ```

8. **Distinct Dates of Sales in 2022:**
   ```sql
   SELECT DISTINCT "date"
   FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" BETWEEN '2022-01-01' AND '2022-12-31'
   ORDER BY "date"
   LIMIT 100;
   ```

9. **Sales Entries for Bourbon Whiskey in Dubuque County for 2022:**
   ```sql
   SELECT "date", "zip_code", "sale_dollars"
   FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "county" = 'Dubuque' AND "category_name" ILIKE '%Bourbon Whiskey%' AND "date" BETWEEN '2022-01-01' AND '2022-12-31'
   LIMIT 100;
   ```

10. **Total Population by Zip Code:**
    ```sql
    SELECT "zipcode", SUM("population") AS "total_population"
    FROM "IOWA_LIQUOR_SALES_PLUS"."CENSUS_BUREAU_USA"."POPULATION_BY_ZIP_2010"
    GROUP BY "zipcode"
    LIMIT 100;
    ```

11. **Detailed Sales Data in Dubuque County for 2022:**
    ```sql
    SELECT "date", "zip_code", "store_name", "category_name", "sale_dollars"
    FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "county" = 'Dubuque' AND "date" BETWEEN '2022-01-01' AND '2022-12-31'
    LIMIT 100;
    ```

12. **Total Bourbon Whiskey Sales per Zip Code in 2022:**
    ```sql
    SELECT "zip_code", SUM("sale_dollars") AS "total_bourbon_sales"
    FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "category_name" ILIKE '%Bourbon Whiskey%' AND "date" BETWEEN '2022-01-01' AND '2022-12-31'
    GROUP BY "zip_code"
    ORDER BY "total_bourbon_sales" DESC
    LIMIT 100;
    ```

13. **Monthly Sales per Zip Code for Bourbon Whiskey in Dubuque County:**
    ```sql
    SELECT "zip_code", EXTRACT(MONTH FROM "date") AS "month", SUM("sale_dollars") AS "monthly_sales"
    FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "county" = 'Dubuque' AND "category_name" ILIKE '%Bourbon Whiskey%' AND "date" BETWEEN '2022-01-01' AND '2022-12-31'
    GROUP BY "zip_code", "month"
    ORDER BY "zip_code", "month"
    LIMIT 100;
    ```

14. **Sales Data with Store Information in Dubuque County:**
    ```sql
    SELECT "store_number", "store_name", "address", "city", "zip_code", "sale_dollars"
    FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "county" = 'Dubuque'
    LIMIT 100;
    ```

15. **Population Data Grouped by Age Range and Zip Code:**
    ```sql
    SELECT "zipcode", CONCAT("minimum_age", '-', "maximum_age") AS "age_range", SUM("population") AS "population_count"
    FROM "IOWA_LIQUOR_SALES_PLUS"."CENSUS_BUREAU_USA"."POPULATION_BY_ZIP_2010"
    GROUP BY "zipcode", "minimum_age", "maximum_age"
    ORDER BY "zipcode", "minimum_age"
    LIMIT 100;
    ```

These queries progressively explore the relevant data needed to calculate the monthly per capita Bourbon Whiskey sales for the specified zip code in Dubuque County, considering the population aged 21 and over.Query:
SELECT DISTINCT "county"
   FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
   LIMIT 100;
Answer:
county
MONTGOMERY
HANCOCK
CASS
CHICKASAW
LEE
CALHOUN
STORY
PAGE
BREMER
FLOYD
CLINTON
TAYLOR
IDA
MAHASKA
JASPER
CLARKE
CHEROKEE
WASHINGTON
ALLAMAKEE
DUBUQUE
HENRY
HOWARD
SCOTT
LYON
EMMET
BUCHANAN
AUDUBON
UNION
CLAY
GRUNDY
WINNESHIEK
VAN BUREN
WOODBURY
WAPELLO
O'BRIEN
CARROLL
FREMONT
FRANKLIN
DICKINSON
JONES
POCAHONTAS
JEFFERSON
MITCHELL
MADISON
CERRO GORDO
DES MOINES
KOSSUTH
WAYNE
POWESHIEK
BOONE
ADAIR
PALO ALTO
CLAYTON
BUTLER
APPANOOSE
SHELBY
IOWA
TAMA
MARION
MUSCATINE
BLACK HAWK
MONROE
FAYETTE
LINN
DALLAS
LOUISA
WINNEBAGO
RINGGOLD
CRAWFORD
""
LUCAS
DECATUR
BUENA VISTA
MILLS
DELAWARE
SIOUX
WRIGHT
POTTAWATTAMIE
PLYMOUTH
MARSHALL
BENTON
SAC
POLK
HARDIN
DAVIS
CEDAR
JACKSON
HARRISON
WORTH
ADAMS
HAMILTON
MONONA
GUTHRIE
HUMBOLDT
KEOKUK
WARREN
OSCEOLA
GREENE
JOHNSON
WEBSTER
Query:
SELECT "date", "zip_code", "sale_dollars"
FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
WHERE "county" = 'DUBUQUE' AND "date" BETWEEN '2022-01-01' AND '2022-12-31'
LIMIT 100;
Answer:
date,zip_code,sale_dollars
2022-10-28,52002.0,65.25
2022-04-22,52002,85.5
2022-12-26,52002,48.0
2022-02-04,52040.0,40.77
2022-03-04,52002.0,38.25
2022-07-18,52001,37.14
2022-03-21,52001.0,69.78
2022-07-11,52003,87.75
2022-01-07,52001.0,49.59
2022-09-30,52056,38.97
2022-10-28,52033.0,14.93
2022-04-22,52040,12.75
2022-03-29,52001.0,10.5
2022-10-31,52001.0,17.25
2022-12-09,52002.0,103.5
2022-06-20,52003.0,87.63
2022-06-13,52003.0,77.4
2022-08-30,52003,37.14
2022-10-31,52003.0,57.6
2022-01-07,52001.0,18.0
2022-10-31,52001.0,123.75
2022-11-11,52001.0,65.25
2022-12-05,52001.0,56.16
2022-12-30,52040,6.9
2022-08-22,52002.0,6.6
2022-12-27,52001,8.31
2022-12-09,52040.0,4.95
2022-07-29,52001,11.21
2022-04-18,52003,11.21
2022-01-31,52001.0,7.2
2022-04-22,52001,7.2
2022-09-19,52001,38.7
2022-10-31,52002.0,32.16
2022-07-15,52001,31.4
2022-07-22,52001,93.0
2022-04-01,52001.0,108.0
2022-11-11,52040.0,87.0
2022-05-27,52001.0,66.0
2022-11-11,52040.0,66.0
2022-04-01,52001.0,66.0
2022-12-09,52001.0,59.96
2022-03-25,52002.0,21.6
2022-08-22,52003.0,49.52
2022-09-12,52001,60.0
2022-05-16,52001.0,45.0
2022-01-14,52001.0,45.0
2022-01-17,52001.0,30.15
2022-12-19,52002.0,77.4
2022-07-15,52040,77.4
2022-04-15,52001,77.4
2022-12-02,52001.0,76.5
2022-01-24,52001.0,58.5
2022-09-12,52003,64.56
2022-08-19,52001.0,67.8
2022-04-11,52001.0,71.94
2022-02-11,52040.0,38.7
2022-01-17,52001.0,29.88
2022-03-21,52003.0,7.74
2022-01-31,52003.0,7.74
2022-10-24,52001.0,77.4
2022-08-09,52002.0,7.74
2022-08-05,52040.0,18.5
2022-05-16,52001.0,29.86
2022-05-20,52033.0,34.5
2022-10-24,52003.0,77.4
2022-07-18,52003,14.93
2022-05-23,52003.0,7.5
2022-03-14,52003.0,7.5
2022-06-17,52001.0,62.28
2022-08-02,52001.0,58.5
2022-01-28,52002.0,64.02
2022-01-21,52001.0,132.78
2022-06-10,52003.0,84.96
2022-12-12,52002.0,135.0
2022-02-18,52040.0,103.5
2022-11-04,52001.0,103.98
2022-07-15,52001,103.98
2022-12-30,52002,154.8
2022-05-23,52003.0,7.26
2022-08-16,52002.0,13.13
2022-11-21,52003.0,8.1
2022-08-12,52001.0,154.8
2022-01-10,52002.0,34.5
2022-11-28,52001.0,14.1
2022-10-10,52001.0,47.25
2022-05-02,52001.0,146.22
2022-03-14,52001.0,155.22
2022-07-25,52002,56.28
2022-06-27,52001,47.52
2022-06-10,52001.0,134.88
2022-04-11,52001.0,104.96
2022-01-21,52040.0,129.0
2022-07-18,52002,84.0
2022-08-30,52001,23.92
2022-03-29,52003.0,24.39
2022-07-29,52001,59.96
2022-04-15,52001.0,42.0
2022-10-21,52001.0,42.0
2022-09-19,52001,59.92
2022-11-04,52001.0,17.85
Query:
SELECT "date", "zip_code", "sale_dollars"
FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
WHERE "county" ILIKE '%DUBUQUE%'
LIMIT 100;
Answer:
date,zip_code,sale_dollars
2024-07-15,52002.0,-42.0
2023-03-22,52033,-153.0
2023-10-19,52040.0,-171.0
2023-07-21,52001.0,-256.5
2022-11-04,52040.0,77.4
2021-09-20,52001.0,77.4
2023-12-11,52003.0,77.4
2021-10-01,52056.0,11.03
2024-09-09,52002.0,8.64
2021-03-09,52040.0,12.75
2021-04-02,52040.0,8.1
2020-03-23,52001.0,8.1
2020-11-09,52003.0,9.26
2024-08-19,52001.0,17.25
2021-10-19,52001.0,10.5
2024-06-24,52003.0,10.5
2022-05-16,52003.0,7.5
2023-07-17,52002.0,8.82
2024-07-30,52003.0,8.82
2022-06-24,52056,7.74
2021-04-02,52040.0,6.2
2024-05-14,52001.0,30.0
2019-08-02,52001,11.21
2020-05-22,52001.0,19.2
2023-09-11,52001.0,19.2
2024-08-19,52001.0,19.2
2020-10-02,52002.0,19.2
2021-01-08,52002.0,6.6
2022-06-24,52056.0,6.9
2022-12-05,52002.0,6.9
2023-01-03,52001,8.31
2023-07-10,52001.0,7.2
2023-04-17,52001.0,8.91
2023-07-17,52001.0,38.7
2022-08-30,52001,38.7
2022-11-07,52001.0,38.7
2024-08-30,52002.0,38.7
2023-12-04,52001.0,38.7
2024-03-18,52040.0,77.4
2023-11-30,52002.0,77.4
2023-10-02,52003.0,77.4
2019-04-26,52001,106.29
2018-08-28,52033,58.68
2016-05-24,52002,58.68
2019-11-18,52001.0,56.04
2021-07-20,52002.0,63.45
2021-11-05,52001,38.25
2022-06-07,52001,77.4
2024-01-05,52002.0,77.4
2022-11-21,52001.0,77.4
2022-08-16,52003.0,41.64
2012-01-03,52004,52.26
2017-10-17,52003,53.97
2012-12-24,52002,25.74
2021-04-27,52001.0,38.97
2020-12-14,52001.0,48.0
2021-01-11,52001.0,48.0
2020-11-02,52003.0,38.97
2023-01-23,52003,38.97
2021-04-27,52002.0,65.34
2013-01-08,52001,56.22
2023-04-14,52001.0,60.72
2019-09-30,52001.0,45.0
2022-09-12,52001,38.7
2019-11-18,52003.0,23.45
2022-02-07,52001.0,44.3
2023-06-05,52001.0,7.5
2023-11-06,52003.0,7.5
2019-11-18,52068.0,7.5
2021-10-11,52002.0,7.5
2021-12-06,52001.0,7.5
2023-05-15,52003.0,7.5
2022-12-19,52002.0,7.5
2022-03-07,52002.0,20.25
2022-08-02,52003.0,13.31
2019-10-14,52001.0,13.31
2023-05-19,52002.0,7.26
2023-06-05,52002.0,7.05
2020-12-28,52003.0,6.83
2024-09-23,52001.0,77.4
2023-11-06,52001.0,77.4
2023-10-30,52001.0,77.4
2022-01-31,52001.0,7.74
2023-11-26,52033.0,77.4
2022-08-30,52001,77.4
2023-06-23,52033.0,77.4
2023-08-07,52001.0,77.4
2023-06-05,52001.0,77.4
2024-06-10,52001.0,77.4
2024-02-11,52033.0,77.4
2020-03-16,52040.0,13.59
2021-02-08,52002.0,13.13
2019-09-03,52001.0,17.25
2023-06-12,52001.0,154.8
2021-01-29,52001.0,154.8
2023-10-02,52046.0,154.8
2023-05-30,52001.0,19.36
2024-02-12,52001.0,17.82
2023-03-03,52002.0,29.86
2021-12-28,52003.0,22.06
Query:
SELECT "zip_code", SUM("sale_dollars") AS "total_sales"
FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
WHERE "county" = 'DUBUQUE'
GROUP BY "zip_code"
ORDER BY "total_sales" DESC
LIMIT 100
Answer:
zip_code,total_sales
52001,34647931.52000001
52001.0,30519205.209999997
52002.0,18347621.479999997
52002,14349877.149999999
52003,9703183.089999998
52003.0,7444458.529999997
52040.0,4048076.37
52040,3707512.5900000003
52068.0,1396962.0700000005
52033,1003027.1599999999
52033.0,835104.4700000001
52068,673563.2900000003
52053,621855.8099999999
52053.0,336510.8899999999
52056.0,261201.17000000004
52046.0,253029.06000000003
52046,239659.2499999999
52004,172787.68
52056,65709.25
52045.0,7812.78
Query:
SELECT "date", "zip_code", "category_name", "sale_dollars"
FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
WHERE "category_name" ILIKE '%BOURBON%'
LIMIT 100
Answer:
Too long, hard cut:
date,zip_code,category_name,sale_dollars
2016-10-05,52577,STRAIGHT BOURBON WHISKIES,35.73
2014-12-20,51632,STRAIGHT BOURBON WHISKIES,32.73
2014-06-10,50595,STRAIGHT BOURBON WHISKIES,35.73
2018-02-19,50701.0,STRAIGHT BOURBON WHISKIES,35.73
2016-04-07,52772,STRAIGHT BOURBON WHISKIES,35.73
2013-04-15,50702,STRAIGHT BOURBON WHISKIES,35.73
2014-08-05,51334,STRAIGHT BOURBON WHISKIES,35.73
2015-04-07,50266,STRAIGHT BOURBON WHISKIES,35.73
2018-03-29,50701.0,STRAIGHT BOURBON WHISKIES,35.73
2014-05-29,50703,STRAIGHT BOURBON WHISKIES,32.73
2017-02-13,52040,STRAIGHT BOURBON WHISKIES,35.73
2024-01-31,50219.0,STRAIGHT BOURBON WHISKIES,134.94
2013-08-08,52240,STRAIGHT BOURBON WHISKIES,60.0
2013-08-26,52601,STRAIGHT BOURBON WHISKIES,47.25
2013-05-30,52403,STRAIGHT BOURBON WHISKIES,47.25
2015-09-28,52060,STRAIGHT BOURBON WHISKIES,47.25
2016-04-18,52601,STRAIGHT BOURBON WHISKIES,47.25
2014-02-10,52738,STRAIGHT BOURBON WHISKIES,47.25
2013-05-09,52404,STRAIGHT BOURBON WHISKIES,47.25
2018-01-25,50208.0,STRAIGHT BOURBON WHISKIES,47.25
2014-04-09,52040,STRAIGHT BOURBON WHISKIES,47.25
2015-03-30,52761,STRAIGHT BOURBON WHISKIES,47.25
2013-12-10,51632,STRAIGHT BOURBON WHISKIES,47.25
2012-10-18,50112,STRAIGHT BOURBON WHISKIES,44.25
2017-12-13,52405,STRAIGHT BOURBON WHISKIES,47.25
2016-12-07,50138,STRAIGHT BOURBON WHISKIES,47.25
2014-05-14,52040,STRAIGHT BOURBON WHISKIES,47.25
2012-10-01,50702,STRAIGHT BOURBON WHISKIES,44.25
2018-05-22,51450.0,STRAIGHT BOURBON WHISKIES,47.25
2012-06-12,52003,STRAIGHT BOURBON WHISKIES,47.25
2018-02-28,51360.0,STRAIGHT BOURBON WHISKIES,47.25
2015-08-17,52632,STRAIGHT BOURBON WHISKIES,47.25
2015-07-07,50833,STRAIGHT BOURBON WHISKIES,47.25
2015-04-29,50613,STRAIGHT BOURBON WHISKIES,47.25
2016-12-23,50854,STRAIGHT BOURBON WHISKIES,47.25
2014-11-24,52240,STRAIGHT BOURBON WHISKIES,47.25
2017-01-04,50327,STRAIGHT BOURBON WHISKIES,47.25
2016-03-01,52404,STRAIGHT BOURBON WHISKIES,47.25
2012-07-09,50595,STRAIGHT BOURBON WHISKIES,44.25
2016-08-01,50216,STRAIGHT BOURBON WHISKIES,47.25
2013-01-07,52240,STRAIGHT BOURBON WHISKIES,47.25
2022-09-23,52402,STRAIGHT BOURBON WHISKIES,-468.0
2024-04-05,50635.0,STRAIGHT BOURBON WHISKIES,-90.0
2024-04-09,50702.0,STRAIGHT BOURBON WHISKIES,-234.0
2023-03-22,52033,STRAIGHT BOURBON WHISKIES,-153.0
2023-07-05,50315.0,SINGLE BARREL BOURBON WHISKIES,-180.0
2023-11-30,52627.0,STRAIGHT BOURBON WHISKIES,-48.0
2023-02-27,51241.0,STRAIGHT BOURBON WHISKIES,-76.56
2023-09-20,52172.0,STRAIGHT BOURBON WHISKIES,-96.0
2024-07-09,52340.0,STRAIGHT BOURBON WHISKIES,-189.0
2023-11-03,52722.0,STRAIGHT BOURBON WHISKIES,-60.0
2022-12-29,50265,STRAIGHT BOURBON WHISKIES,-37.5
2024-03-04,52632.0,STRAIGHT BOURBON WHISKIES,-193.5
2023-12-06,50266.0,STRAIGHT BOURBON WHISKIES,-336.12
2023-06-28,52349.0,STRAIGHT BOURBON WHISKIES,-16.8
2022-10-14,52353.0,STRAIGHT BOURBON WHISKIES,-6.38
2012-01-10,52356,STRAIGHT BOURBON WHISKIES,47.25
2012-03-07,50023,STRAIGHT BOURBON WHISKIES,47.25
2014-01-14,50854,STRAIGHT BOURBON WHISKIES,47.25
2016-10-10,52402,STRAIGHT BOURBON WHISKIES,47.25
2016-01-13,50588,STRAIGHT BOURBON WHISKIES,47.25
2017-04-13,52806.0,STRAIGHT BOURBON WHISKIES,47.25
2014-07-10,50125,STRAIGHT BOURBON WHISKIES,47.25
2015-06-25,50310,STRAIGHT BOURBON WHISKIES,47.25
2013-06-10,50701,STRAIGHT BOURBON WHISKIES,47.25
2017-01-04,51301,STRAIGHT BOURBON WHISKIES,47.25
2017-07-31,52060.0,STRAIGHT BOURBON WHISKIES,47.25
2013-04-09,51537,STRAIGHT BOURBON WHISKIES,47.25
2023-12-26,52404.0,STRAIGHT BOURBON WHISKIES,56.25
2024-07-29,51025.0,STRAIGHT BOURBON WHISKIES,135.0
2022-08-10,52632.0,STRAIGHT BOURBON WHISKIES,71.55
2022-02-21,52404.0,STRAIGHT BOURBON WHISKIES,101.25
2022-01-28,50003.0,STRAIGHT BOURBON WHISKIES,66.18
2024-03-20,50021.0,STRAIGHT BOURBON WHISKIES,61.62
2024-06-13,50702.0,STRAIGHT BOURBON WHISKIES,61.62
2024-02-12,52401.0,STRAIGHT BOURBON WHISKIES,61.62
2021-12-28,50010.0,STRAIGHT BOURBON WHISKIES,61.62
2019-01-02,50613,STRAIGHT BOURBON WHISKIES,51.75
2022-12-06,50703.0,STRAIGHT BOURBON WHISKIES,71.55
2023-05-03,50021.0,STRAIGHT BOURBON WHISKIES,61.62
2020-12-22,50312.0,STRAIGHT BOURBON WHISKIES,56.25
2022-02-07,50314.0,STRAIGHT BOURBON WHISKIES,45.0
2014-03-17,50023,STRAIGHT BOURBON WHISKIES,103.86
2022-01-25,51445.0,STRAIGHT BOURBON WHISKIES,40.5
2019-06-07,50266,BOTTLED IN BOND BOURBON,90.0
2023-09-07,52402.0,BOTTLED IN BOND BOURBON,314.64
2023-06-12,52401.0,BOTTLED IN BOND BOURBON,292.14
2022-08-30,52722,STRAIGHT BOURBON WHISKIES,77.19
2023-11-28,51241.0,STRAIGHT BOURBON WHISKIES,81.0
2017-01-18,52241,STRAIGHT BOURBON WHISKIES,43.17
2022-12-28,50211,STRAIGHT BOURBON WHISKIES,125.97
2022-01-12,52641.0,STRAIGHT BOURBON WHISKIES,125.97
2020-09-10,50266.0,STRAIGHT BOURBON WHISKIES,134.91
2021-02-12,52601.0,STRAIGHT BOURBON WHISKIES,134.91
2014-09-09,50263,STRAIGHT BOURBON WHISKIES,116.97
2016-12-05,50314,STRAIGHT BOURBON WHISKIES,51.75
2023-02-21,50158.0,BOTTLED IN BOND BOURBON,159.57
2024-07-17,50010.0,STRAIGHT BOURBON WHISKIES,99.0
2015-10-19,52601,STRAIGHT BOURBON WHISKIES,61.44
2012-09-19,50
Query:
SELECT EXTRACT(MONTH FROM "date") AS "month", SUM("sale_dollars") AS "monthly_sales"
FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
WHERE "county" = 'DUBUQUE' AND "category_name" ILIKE '%BOURBON%' AND "date" BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY "month"
ORDER BY "month"
LIMIT 100
Answer:
month,monthly_sales
1,71730.77999999998
2,77228.39
3,68318.32999999997
4,94734.44000000002
5,63659.44
6,60381.58
7,88831.91000000002
8,106720.09000000001
9,74031.47
10,97870.08
11,71036.08000000002
12,101420.09
Query:
SELECT "zipcode", SUM("population") AS "population_over_21"
FROM "IOWA_LIQUOR_SALES_PLUS"."CENSUS_BUREAU_USA"."POPULATION_BY_ZIP_2010"
WHERE "minimum_age" >= 21
GROUP BY "zipcode"
LIMIT 100
Answer:
zipcode,population_over_21
28645,35338
97361,7480
85745,26789
21402,2516
13501,26203
95991,26995
80906,28155
70719,3071
75231,24958
53040,5867
75009,5762
33981,7789
7821,6541
49866,5875
1462,7438
31808,4820
87740,5981
93730,6943
28110,33590
97487,6277
10970,7668
78112,5085
85131,13882
91942,29672
98661,29838
8805,9092
48111,30551
19530,10371
78840,31654
70341,3140
49302,5188
34224,13330
5488,5636
43964,7318
3036,3273
49057,4518
30457,4553
32064,4686
35654,6147
43326,9676
97089,8669
28327,11183
49008,11933
86045,6777
70812,7267
91914,9765
62294,10029
32097,11229
38261,12467
90804,28147
48423,23506
90713,20039
39532,23375
97331,204
19958,16349
78757,16922
98371,15184
95112,40918
94566,28885
28390,13490
46545,18455
77021,18226
45680,9539
12601,29901
47872,6966
45152,7910
1057,6292
28461,13165
41139,6238
60638,39768
53185,13258
7823,5843
37187,4921
11757,33548
48359,5443
70392,5846
46373,9706
98438,216
32656,10138
33635,11748
86033,4545
78073,5363
28532,15127
33155,34350
79766,3960
48026,10834
71635,8951
48335,17258
78043,25517
38505,270
660,12941
51041,4559
7407,14675
92585,11719
27576,11769
7114,11535
76001,19613
28677,23608
29108,14201
85023,22197
Query:
SELECT DISTINCT "date"
FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
WHERE "date" BETWEEN '2022-01-01' AND '2022-12-31'
ORDER BY "date"
LIMIT 100
Answer:
date
2022-01-02
2022-01-03
2022-01-04
2022-01-05
2022-01-06
2022-01-07
2022-01-09
2022-01-10
2022-01-11
2022-01-12
2022-01-13
2022-01-14
2022-01-16
2022-01-17
2022-01-18
2022-01-19
2022-01-20
2022-01-21
2022-01-23
2022-01-24
2022-01-25
2022-01-26
2022-01-27
2022-01-28
2022-01-30
2022-01-31
2022-02-01
2022-02-02
2022-02-03
2022-02-04
2022-02-06
2022-02-07
2022-02-08
2022-02-09
2022-02-10
2022-02-11
2022-02-13
2022-02-14
2022-02-15
2022-02-16
2022-02-17
2022-02-18
2022-02-20
2022-02-21
2022-02-22
2022-02-23
2022-02-24
2022-02-25
2022-02-26
2022-02-27
2022-02-28
2022-03-01
2022-03-02
2022-03-03
2022-03-04
2022-03-06
2022-03-07
2022-03-08
2022-03-09
2022-03-10
2022-03-11
2022-03-13
2022-03-14
2022-03-15
2022-03-16
2022-03-17
2022-03-18
2022-03-20
2022-03-21
2022-03-22
2022-03-23
2022-03-24
2022-03-25
2022-03-27
2022-03-28
2022-03-29
2022-03-30
2022-03-31
2022-04-01
2022-04-03
2022-04-04
2022-04-05
2022-04-06
2022-04-07
2022-04-08
2022-04-10
2022-04-11
2022-04-12
2022-04-13
2022-04-14
2022-04-15
2022-04-17
2022-04-18
2022-04-19
2022-04-20
2022-04-21
2022-04-22
2022-04-23
2022-04-25
2022-04-26
Query:
SELECT "date", "zip_code", "sale_dollars"
FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
WHERE "county" = 'DUBUQUE' AND "category_name" ILIKE '%BOURBON%' AND "date" BETWEEN '2022-01-01' AND '2022-12-31'
LIMIT 100
Answer:
date,zip_code,sale_dollars
2022-10-28,52002.0,21.0
2022-05-16,52001.0,126.0
2022-06-07,52002,27.0
2022-05-31,52001.0,6.38
2022-02-14,52001.0,20.54
2022-01-17,52001.0,57.0
2022-07-15,52001,18.75
2022-06-04,52002,97.02
2022-12-02,52001.0,67.5
2022-03-25,52001.0,67.48
2022-02-25,52001.0,33.0
2022-06-07,52001,52.5
2022-08-26,52002,60.78
2022-04-11,52003.0,51.0
2022-01-10,52001.0,67.2
2022-08-19,52001.0,108.0
2022-10-07,52001.0,52.5
2022-02-21,52001.0,105.0
2022-02-18,52033.0,135.0
2022-07-08,52002,10.5
2022-08-16,52001.0,6.38
2022-08-16,52001.0,21.0
2022-06-04,52002,193.5
2022-05-20,52033.0,83.16
2022-05-02,52001.0,30.0
2022-06-10,52001,90.0
2022-04-11,52002.0,25.2
2022-02-18,52001.0,405.0
2022-04-22,52001,37.5
2022-08-05,52001.0,37.5
2022-10-17,52003.0,73.5
2022-07-18,52003,94.5
2022-03-25,52001.0,33.0
2022-09-09,52001,672.24
2022-08-05,52001.0,139.41
2022-05-20,52056.0,75.16
2022-12-27,52001,56.0
2022-06-17,52001.0,33.0
2022-05-13,52002.0,25.2
2022-11-25,52001.0,75.0
2022-07-22,52001,101.25
2022-10-31,52003.0,63.0
2022-02-04,52001.0,82.5
2022-05-27,52001.0,31.5
2022-08-12,52001.0,31.5
2022-04-05,52001.0,126.0
2022-06-27,52002,180.0
2022-08-30,52001,154.44
2022-04-18,52001,154.44
2022-11-25,52040.0,112.5
2022-10-10,52001.0,283.5
2022-02-18,52003.0,180.0
2022-01-28,52040.0,66.0
2022-04-29,52040,66.0
2022-04-25,52003,21.0
2022-01-10,52003.0,82.5
2022-08-26,52033,154.44
2022-09-12,52001,157.5
2022-06-24,52001.0,157.5
2022-04-05,52003.0,202.5
2022-08-30,52003,189.0
2022-10-07,52040.0,246.0
2022-11-21,52002.0,162.0
2022-07-01,52001,283.5
2022-12-30,52056,57.0
2022-03-25,52002.0,288.0
2022-01-10,52068.0,288.0
2022-09-30,52040,198.0
2022-01-31,52068.0,162.9
2022-10-31,52003.0,168.06
2022-04-29,52002,72.0
2022-11-07,52068.0,99.0
2022-02-07,52003.0,98.28
2022-08-30,52001,283.5
2022-08-26,52002,180.0
2022-12-27,52001,87.0
2022-11-25,52001.0,78.0
2022-11-14,52068.0,198.0
2022-12-02,52003.0,198.0
2022-06-17,52001.0,112.5
2022-03-18,52040.0,121.5
2022-02-11,52001.0,202.5
2022-03-18,52040.0,112.5
2022-02-18,52040.0,174.72
2022-01-31,52068.0,189.0
2022-12-02,52001.0,283.5
2022-11-04,52003.0,180.0
2022-01-24,52002.0,198.0
2022-09-16,52002,157.5
2022-02-07,52002.0,10.5
2022-04-25,52001,52.5
2022-03-25,52001.0,225.0
2022-05-09,52001.0,99.0
2022-11-21,52001.0,73.8
2022-04-25,52003,10.5
2022-01-10,52001.0,21.0
2022-04-11,52001.0,104.96
2022-01-21,52040.0,129.0
2022-12-05,52002.0,10.5
2022-06-07,52003,96.72
Query:
SELECT "zipcode", SUM("population") AS "total_population"
FROM "IOWA_LIQUOR_SALES_PLUS"."CENSUS_BUREAU_USA"."POPULATION_BY_ZIP_2010"
GROUP BY "zipcode"
LIMIT 100
Answer:
zipcode,total_population
49336,13056
72106,16128
1960,152832
79322,6147
50833,6915
12483,777
40052,1545
29686,3081
8353,1548
12965,1548
44048,7695
59639,3858
7606,6930
8648,96789
1436,10008
89169,69912
4981,6948
38117,78375
80812,825
68517,1614
99201,40026
36343,4737
97914,57615
30808,13845
55374,40728
21856,3105
12071,810
42332,813
16929,6960
37144,10032
65025,2358
8348,825
5744,1599
61817,7749
98359,14661
46550,36933
70072,169032
52159,6990
27927,1626
48892,13146
25906,861
39082,3936
49646,24687
83670,1659
74081,5511
77973,150
46403,37803
72634,14010
55040,37704
71826,3945
79257,3201
25201,165
12438,177
11228,125364
51454,4038
72360,19398
60031,113841
67039,10185
39886,4848
39090,40194
79703,61776
77340,89427
21626,360
64733,3477
13776,1539
97038,45339
78717,67614
40175,39210
12143,15411
54840,13929
36009,7698
3220,22290
74735,4647
46371,10797
44106,80688
83702,66879
1077,28506
55370,2406
51579,7020
79505,888
82637,12408
91206,99195
53934,13188
89502,130698
98321,45456
39736,936
58272,936
78934,20136
37909,45504
67021,195
76374,12486
70080,4668
1029,2367
47648,13119
14846,2376
54135,9288
84081,122196
17223,867
92545,118371
31642,14694
Query:
SELECT "date", "zip_code", "store_name", "category_name", "sale_dollars"
FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
WHERE "county" = 'DUBUQUE' AND "date" BETWEEN '2022-01-01' AND '2022-12-31'
LIMIT 100
Answer:
Too long, hard cut:
date,zip_code,store_name,category_name,sale_dollars
2022-10-28,52002.0,HY-VEE #2 / DUBUQUE,IMPORTED CORDIALS & LIQUEURS,65.25
2022-04-22,52002,HY-VEE #2 / DUBUQUE,IMPORTED CORDIALS & LIQUEURS,85.5
2022-12-26,52002,HY-VEE #2 / DUBUQUE,IMPORTED SCHNAPPS,48.0
2022-02-04,52040.0,RANDY'S NEIGHBORHOOD MARKET / DYERSVILLE,TEMPORARY & SPECIALTY PACKAGES,40.77
2022-03-04,52002.0,HY-VEE #2 / DUBUQUE,AMERICAN CORDIALS & LIQUEURS,38.25
2022-07-18,52001,BEECHER LIQUOR / DUBUQUE,AMERICAN FLAVORED VODKA,37.14
2022-03-21,52001.0,SUPER STOP IV - DUBUQUE,TENNESSEE WHISKIES,69.78
2022-10-10,52001.0,NORTH SIDE LIQUOR & TOBACCO / DUBUQUE,MIXTO TEQUILA,47.25
2022-05-02,52001.0,EZ STOP 1 / DUBUQUE,100% AGAVE TEQUILA,146.22
2022-03-14,52001.0,WALGREENS #11942 / DUBUQUE,100% AGAVE TEQUILA,155.22
2022-07-25,52002,HY-VEE FAST AND FRESH - DUBUQUE,MIXTO TEQUILA,56.28
2022-06-27,52001,NORTH SIDE LIQUOR & TOBACCO / DUBUQUE,WHISKEY LIQUEUR,47.52
2022-06-10,52001.0,HY-VEE #3 / DUBUQUE,IRISH WHISKIES,134.88
2022-04-11,52001.0,SUPER STOP IV - DUBUQUE,STRAIGHT BOURBON WHISKIES,104.96
2022-01-21,52040.0,RANDY'S NEIGHBORHOOD MARKET / DYERSVILLE,STRAIGHT BOURBON WHISKIES,129.0
2022-07-18,52002,WALGREENS #06154 / DUBUQUE,IMPORTED DRY GINS,84.0
2022-08-30,52001,EZ STOP 1 / DUBUQUE,AMERICAN DRY GINS,23.92
2022-03-29,52003.0,SID'S BEVERAGE SHOP,AMERICAN SLOE GINS,24.39
2022-07-29,52001,HY-VEE #3 / DUBUQUE,IMPORTED VODKAS,59.96
2022-04-15,52001.0,HY-VEE FOOD STORE / DUBUQUE,AMERICAN VODKAS,42.0
2022-10-21,52001.0,HY-VEE #3 / DUBUQUE,AMERICAN VODKAS,42.0
2022-09-19,52001,EZ STOP 1 / DUBUQUE,AMERICAN VODKAS,59.92
2022-07-15,52001,HY-VEE #3 / DUBUQUE,AMERICAN FLAVORED VODKA,42.0
2022-09-30,52001,HY-VEE #3 / DUBUQUE,WHITE RUM,52.56
2022-01-28,52001.0,FAREWAY STORES #114 / DUBUQUE,AMERICAN BRANDIES,39.0
2022-05-27,52001.0,HY-VEE #3 / DUBUQUE,AMERICAN BRANDIES,28.56
2022-03-14,52001.0,NORTH SIDE LIQUOR & TOBACCO / DUBUQUE,IMPORTED FLAVORED VODKA,98.96
2022-03-25,52002.0,HY-VEE #2 / DUBUQUE,WHISKEY LIQUEUR,64.0
2022-10-10,52002.0,DUBUQUE WINE & SPIRITS,WHISKEY LIQUEUR,387.0
2022-08-05,52001.0,HY-VEE #3 / DUBUQUE,IMPORTED CORDIALS & LIQUEURS,86.12
2022-10-28,52001.0,HY-VEE #3 / DUBUQUE,CREAM LIQUEURS,98.96
2022-05-16,52002.0,DUBUQUE WINE & SPIRITS,IMPORTED SCHNAPPS,51.96
2022-04-29,52001,HY-VEE #3 / DUBUQUE,FLAVORED RUM,54.36
2022-03-25,52001.0,HY-VEE #3 / DUBUQUE,AMERICAN CORDIALS & LIQUEURS,51.0
2022-11-28,52001.0,BEECHER LIQUOR / DUBUQUE,AMERICAN FLAVORED VODKA,41.64
2022-12-05,52003.0,SID'S BEVERAGE SHOP,AMERICAN FLAVORED VODKA,41.64
2022-09-16,52001,HY-VEE FOOD STORE / DUBUQUE,TENNESSEE WHISKIES,95.48
2022-07-18,52003,SID'S BEVERAGE SHOP,WHITE RUM,48.96
2022-04-22,52033,CASEY'S GENERAL STORE #77 / CASCADE,AMERICAN VODKAS,24.3
2022-12-09,52040.0,RANDY'S NEIGHBORHOOD MARKET / DYERSVILLE,SCOTCH WHISKIES,79.5
2022-02-07,52003.0,SID'S BEVERAGE SHOP,AMERICAN FLAVORED VODKA,56.25
2022-07-22,52001,HY-VEE #3 / DUBUQUE,WHITE RUM,65.7
2022-01-17,52001.0,KWIK STOP C-STORES / DUBUQUE,SPICED RUM,75.0
2022-01-28,52002.0,HY-VEE #2 / DUBUQUE,AMERICAN FLAVORED VODKA,61.9
2022-12-27,52003,SID'S BEVERAGE SHOP,100% AGAVE TEQUILA,127.5
2022-05-27,52001.0,HY-VEE #3 / DUBUQUE,AMERICAN DRY GINS,21.0
2022-09-16,52001,HY-VEE #3 / DUBUQUE,WHITE RUM,57.0
2022-04-22,52001,HY-VEE #3 / DUBUQUE,AMERICAN BRANDIES,42.8
2022-12-30,52001,HY-VEE #3 / DUBUQUE,IMPORTED CORDIALS & LIQUEURS,104.52
2022-05-06,52001.0,HY-VEE #3 / DUBUQUE,MIXTO TEQUILA,47.0
2022-05-20,52001.0,HY-VEE FOOD STORE / DUBUQUE,STRAIGHT BOURBON WHISKIES,202.5
2022-05-31,52068.0,FAREWAY STORES #168/ PEOSTA,STRAIGHT BOURBON WHISKIES,168.06
2022-01-28,52040.0,FAREWAY STORES #008 / DYERSVILLE,STRAIGHT BOURBON WHISKIES,162.9
2022-11-25,52040.0,HY-VEE DYERSVILLE DOLLAR FRESH,STRAIGHT BOURBON WHISKIES,180.0
2022-12-16,52001.0,HY-VEE FOOD STORE / DUBUQUE,BLENDED WHISKIES,195.06
2022-12-16,52001.0,HY-VEE FOOD STORE / DUBUQUE,BLENDED WHISKIES,103.5
2022-12-27,52001,HY-VEE #3 / DUBUQUE,IMPORTED FLAVORED VODKA,89.94
2022-10-28,52003.0,TARGET STORE T-0086 / DUBUQUE,IMPORTED VODKAS,112.5
2022-12-07,52001.0,BP FUEL / DUBUQUE,IMPORTED VODKAS,153.0
2022-07-11,52003,SID'S BEVERAGE SHOP,IMPORTED CORDIALS & LIQUEURS,87.75
2022-01-07,52001.0,HY-VEE FOOD STORE / DUBUQUE,IMPORTED CORDIALS & LIQUEURS,49.59
2022-09-30,52056,LUXEMBURG LIQUOR TOBACCO & GAS,IMPORTED SCHNAPPS,38.97
2022-10-03,52001.0,EZ STOP II - DUBUQUE,AMERICAN VODKAS,50.4
2022-06-27,52001,BIG 10 MART,AMERICAN VODKAS,97.56
2022-08-22,52001.0,NORTH SIDE LIQUOR & TOBACCO / DUBUQUE,WHITE RUM,90.0
2022-08-19,52002.0,HY-VEE #2 / DUBUQUE,AGED DARK RUM,193.44
2022-07-18,52001,BEECHER LIQUOR / DUBUQUE,IMPORTED BRANDIES,267.12
2022-05-06,52002.0,HY-VEE #2 / DUBUQUE,IMPORTED BRANDIES,292.32
2022-11-28,52001.0,"LIQUOR, TOBACCO & GROCERY / DUBUQUE",IMPORTED BRANDIES,292.32
2022-10-10,52001.0,NORTH SIDE LIQUOR & TOBACCO / DUBUQUE,IMPORTED BRANDIES,241.92
2022-10-21,52002.0,HY-VEE #2 / DUBUQUE,IMPORTED CORDIALS & LIQUEURS,207.0
2022-11-11,52040.0,FAREWAY STORES #008 / DYERSVILLE,IRISH WHISKIES,1
Query:
SELECT "zip_code", SUM("sale_dollars") AS "total_bourbon_sales"
FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
WHERE "category_name" ILIKE '%BOURBON%' AND "date" BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY "zip_code"
ORDER BY "total_bourbon_sales" DESC
LIMIT 100
Answer:
zip_code,total_bourbon_sales
50266.0,1653838.0299999996
52241.0,951686.0499999997
50010.0,870491.85
52807.0,867627.9100000001
50314.0,820947.2099999996
52240.0,794698.9699999997
50021.0,766809.9700000001
50266,671062.1
50320.0,665611.1200000001
52402.0,614687.8199999998
50322.0,596128.2299999999
51501.0,499705.1500000001
50613.0,486655.31000000006
50311.0,459304.0500000001
50265.0,409245.87999999995
52241,408649.76000000007
50010,380132.5600000001
50314,375707.7399999999
50320,356578.76000000007
52722.0,351855.37999999995
52402,344532.21
50401.0,341241.62000000005
52401.0,319284.4600000001
50263.0,317610.70000000007
50702.0,316996.3600000001
52742.0,315592.5300000001
52404.0,310826.04999999993
52240,310388.87999999995
52807,310126.42000000016
50009.0,301421.8200000001
50023.0,298527.23000000016
51503.0,292684.23
50613,291779.19000000006
50021,283256.86
52411.0,275432.56
51106.0,265378.02999999997
50111.0,250535.76
52001.0,245765.34000000003
52302.0,242813.32999999996
52761.0,233057.45
52002.0,231346.63999999996
51501,219911.82999999996
52501.0,206332.84000000005
50158.0,198348.44000000003
50317.0,193551.09000000005
50265,191140.29000000004
50321.0,182888.68
50501.0,182288.83999999994
50322,180216.87999999995
50311,177113.50999999998
50263,174334.59
52601.0,171208.21000000008
52804.0,170753.37000000005
50125.0,168857.43000000008
50315.0,164952.54
52404,159166.61000000002
52405.0,157938.92
52722,155974.22000000003
52001,154214.62999999998
50401,152304.62999999998
52806.0,152019.23999999996
50131.0,151610.75
51503,149632.67999999996
52632.0,144775.59000000003
52411,144433.17000000004
50009,143682.55000000002
52314.0,143509.12999999998
52732.0,142930.06000000003
52302,141416.36
50219.0,141188.66000000003
50111,140437.05000000002
50023,137239.64999999997
52403.0,135590.21999999997
50702,133754.80000000002
52317.0,131905.93
51360.0,131075.01
50701.0,130458.43000000001
51106,129398.58999999998
52401,124517.09
50208.0,124392.12999999996
52742,124236.36999999998
50677.0,121853.49999999999
52577.0,121158.33000000003
52761,119440.02999999997
50036.0,118702.2
52101.0,115899.06
51301.0,114121.52
51401.0,111657.31000000001
50158,109972.9
50312.0,107221.51999999999
51031.0,105915.00000000001
52501,101081.91000000003
50501,100699.85000000002
52003.0,99394.43000000002
52601,96508.95
52556.0,93914.65000000002
50112.0,93096.97
52641.0,92192.60999999999
52353.0,91642.69000000003
52806,91279.04999999999
Query:
SELECT "zip_code", EXTRACT(MONTH FROM "date") AS "month", SUM("sale_dollars") AS "monthly_sales"
FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
WHERE "county" = 'DUBUQUE' AND "category_name" ILIKE '%BOURBON%' AND "date" BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY "zip_code", "month"
ORDER BY "zip_code", "month"
LIMIT 100
Answer:
zip_code,month,monthly_sales
52001,1,105.3
52001,2,584.85
52001,4,16556.31
52001,5,679.5
52001,6,9417.109999999999
52001,7,37462.22
52001,8,32023.76999999999
52001,9,34684.64
52001,12,22700.93
52001.0,1,27357.010000000002
52001.0,2,32671.499999999996
52001.0,3,25274.08
52001.0,4,19475.9
52001.0,5,25563.559999999998
52001.0,6,14358.809999999998
52001.0,8,15205.04
52001.0,10,30352.590000000007
52001.0,11,31060.319999999992
52001.0,12,24446.530000000002
52002,4,15535.669999999998
52002,6,11692.86
52002,7,25704.139999999996
52002,8,4658.46
52002,9,19017.51
52002,12,12400.64
52002.0,1,23102.65
52002.0,2,26665.790000000008
52002.0,3,23474.11
52002.0,4,17791.43
52002.0,5,20221.850000000002
52002.0,6,7525.540000000001
52002.0,8,30692.140000000003
52002.0,10,45917.43
52002.0,11,20769.74
52002.0,12,15185.96
52003,4,7461.08
52003,6,3153.61
52003,7,11967.09
52003,8,2252.9900000000002
52003,9,12665.890000000001
52003,12,6256.41
52003.0,1,13113.409999999998
52003.0,2,9806.699999999999
52003.0,3,8612.109999999999
52003.0,4,6072.69
52003.0,5,10125.08
52003.0,6,5634.789999999999
52003.0,8,12497.66
52003.0,10,12735.14
52003.0,11,10800.0
52003.0,12,9996.849999999999
52033,4,210.6
52033,6,375.75
52033,7,1001.28
52033,8,647.22
52033,9,1883.49
52033,12,357.0
52033.0,1,1393.44
52033.0,2,696.3
52033.0,3,1098.51
52033.0,4,607.74
52033.0,5,947.6
52033.0,6,234.0
52033.0,8,683.3700000000001
52033.0,10,895.5
52033.0,11,1138.38
52033.0,12,658.5
52040,4,3782.27
52040,6,2444.04
52040,7,7743.0199999999995
52040,8,803.97
52040,9,3323.0599999999995
52040,12,3007.6499999999996
52040.0,1,2380.98
52040.0,2,5374.410000000001
52040.0,3,4695.299999999999
52040.0,4,2079.05
52040.0,5,4912.08
52040.0,6,3812.5699999999997
52040.0,8,4585.62
52040.0,10,3699.91
52040.0,11,3687.5
52040.0,12,4771.620000000001
52046,4,201.6
52046,7,198.0
52046.0,10,399.6
52053,7,975.72
52053,8,413.21999999999997
52053,9,94.5
52053.0,1,409.17
52053.0,2,258.78
52053.0,3,901.47
52053.0,4,94.5
52053.0,8,183.42000000000002
52053.0,10,328.5
52053.0,11,477.0
52053.0,12,75.0
52056,4,612.6600000000001
52056,6,18.75
52056,7,1885.38
Query:
SELECT "store_number", "store_name", "address", "city", "zip_code", "sale_dollars"
FROM "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
WHERE "county" = 'DUBUQUE'
LIMIT 100
Answer:
Too long, hard cut:
store_number,store_name,address,city,zip_code,sale_dollars
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001,106.29
2624,HY-VEE #2 / DUBUQUE,2395 NW ARTERIAL RD,DUBUQUE,52002.0,184.5
2624,HY-VEE #2 / DUBUQUE,2395 NW ARTERIAL RD,DUBUQUE,52002.0,94.47
5660,NORTH SIDE LIQUOR & TOBACCO / DUBUQUE,2013 CENTRAL AVE,DUBUQUE,52001.0,58.5
5660,NORTH SIDE LIQUOR & TOBACCO / DUBUQUE,2013 CENTRAL AVE,DUBUQUE,52001.0,58.5
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001.0,65.25
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001.0,57.39
5042,SUPER STOP III / DUBUQUE,1101 RHOMBERG AVE,DUBUQUE,52001.0,83.28
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001,85.5
2649,HY-VEE #3 / DUBUQUE,400 LOCUST ST,DUBUQUE,52001,50.64
2649,HY-VEE #3 / DUBUQUE,400 LOCUST ST,DUBUQUE,52001,50.64
4167,"IOWA STREET MARKET, INC.",1256 IOWA ST,DUBUQUE,52001,67.5
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001,48.0
3841,HARTIG DRUG COMPANY #2 / LOCUST,157 LOCUST ST,DUBUQUE,52001.0,48.0
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001.0,48.0
5042,SUPER STOP III / DUBUQUE,1101 RHOMBERG AVE,DUBUQUE,52001,48.0
2465,SID'S BEVERAGE SHOP,2727 DODGE ST,DUBUQUE,52003,13.47
2465,SID'S BEVERAGE SHOP,2727 DODGE ST,DUBUQUE,52003.0,108.0
5732,BEECHER CO INC,1691 ASBURY ROAD,DUBUQUE,52001.0,74.22
2624,HY-VEE #2 / DUBUQUE,2395 NW ARTERIAL RD,DUBUQUE,52002,65.25
2624,HY-VEE #2 / DUBUQUE,2395 NW ARTERIAL RD,DUBUQUE,52002,58.56
2465,SID'S BEVERAGE SHOP,2727 DODGE ST,DUBUQUE,52003,58.5
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001,104.88
4167,"IOWA STREET MARKET, INC.",1256 IOWA ST,DUBUQUE,52001,54.24
2624,HY-VEE #2 / DUBUQUE,2395 NW ARTERIAL RD,DUBUQUE,52002.0,65.25
5732,BEECHER CO INC,1691 ASBURY ROAD,DUBUQUE,52001.0,78.66
2649,HY-VEE #3 / DUBUQUE,400 LOCUST ST,DUBUQUE,52001.0,90.0
4334,FAREWAY STORES #114 / DUBUQUE,2050 JOHN F KENNEDY RD,DUBUQUE,52001.0,78.75
2624,HY-VEE #2 / DUBUQUE,2395 NW ARTERIAL RD,DUBUQUE,52002,85.5
4106,HARTIG DRUG COMPANY #3/JFK,2255 JOHN F KENNEDY RD,DUBUQUE,52002.0,74.22
5529,BIG 10 MART,2100 JFK RD,DUBUQUE,52001,56.25
4712,WALGREENS #11942 / DUBUQUE,345 E 20TH ST,DUBUQUE,52001.0,60.75
2465,SID'S BEVERAGE SHOP,2727 DODGE ST,DUBUQUE,52003.0,83.25
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001.0,40.5
4171,"BROTHERS MARKET, INC. / CASCADE",105 SE NIXON ST,CASCADE,52033.0,38.97
2624,HY-VEE #2 / DUBUQUE,2395 NW ARTERIAL RD,DUBUQUE,52002,48.0
3738,HARTIG DRUG COMPANY #4 / DUBUQUE,2225 CENTRAL AVE,DUBUQUE,52001,38.97
3774,EAGLE COUNTRY MARKET / DUBUQUE,1800 ELM ST,DUBUQUE,52001.0,40.02
3774,EAGLE COUNTRY MARKET / DUBUQUE,1800 ELM ST,DUBUQUE,52001,38.97
4106,HARTIG DRUG COMPANY #3/JFK,2255 JOHN F KENNEDY RD,DUBUQUE,52002.0,38.97
4182,FAREWAY STORES #008 / DYERSVILLE,1207  12TH AVE SE,DYERSVILLE,52040.0,38.97
4182,FAREWAY STORES #008 / DYERSVILLE,1207  12TH AVE SE,DYERSVILLE,52040,39.03
4182,FAREWAY STORES #008 / DYERSVILLE,1207  12TH AVE SE,DYERSVILLE,52040,24.45
5597,LIQUOR TOBACCO & GAS,1401 CENTRAL AVE,DUBUQUE,52001.0,56.25
3744,RANDY'S NEIGHBORHOOD MARKET / DYERSVILLE,733 16TH AVE SE,DYERSVILLE,52040.0,40.77
2624,HY-VEE #2 / DUBUQUE,2395 NW ARTERIAL RD,DUBUQUE,52002,28.35
2624,HY-VEE #2 / DUBUQUE,2395 NW ARTERIAL RD,DUBUQUE,52002.0,38.25
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001,27.0
5042,SUPER STOP III / DUBUQUE,1101 RHOMBERG AVE,DUBUQUE,52001.0,31.5
5815,SUPER STOP IV - DUBUQUE,535 HILL STREET SUITE A,DUBUQUE,52001.0,29.25
3774,EAGLE COUNTRY MARKET / DUBUQUE,1800 ELM ST,DUBUQUE,52001,25.62
2465,SID'S BEVERAGE SHOP,2727 DODGE ST,DUBUQUE,52003.0,96.72
4334,FAREWAY STORES #114 / DUBUQUE,2050 JOHN F KENNEDY RD,DUBUQUE,52001.0,168.72
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001,55.5
2465,SID'S BEVERAGE SHOP,2727 DODGE ST,DUBUQUE,52003.0,51.0
5886,BEECHER LIQUOR / DUBUQUE,1691 ASBURY RD,DUBUQUE,52001.0,37.14
5886,BEECHER LIQUOR / DUBUQUE,1691 ASBURY RD,DUBUQUE,52001.0,37.14
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001.0,37.14
5886,BEECHER LIQUOR / DUBUQUE,1691 ASBURY RD,DUBUQUE,52001,37.14
5657,LOUST TOBACCO & LIQUOR / DUBUQUE,408 W LOCUST ST,DUBUQUE,52001,37.14
4167,"IOWA STREET MARKET, INC.",1256 IOWA ST,DUBUQUE,52001,37.14
5359,FAREWAY STORES #168/ PEOSTA,8400 NICC DRIVE,PEOSTA,52068,47.25
2624,HY-VEE #2 / DUBUQUE,2395 NW ARTERIAL RD,DUBUQUE,52002.0,47.25
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001.0,37.14
2649,HY-VEE #3 / DUBUQUE,400 LOCUST ST,DUBUQUE,52001,37.14
5427,BEECHER LIQUOR,1691 ASBURY RD,DUBUQUE,52001,37.14
2649,HY-VEE #3 / DUBUQUE,400 LOCUST ST,DUBUQUE,52001.0,37.14
2524,HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001,21.39
4167,"IOWA STREET MARKET, INC.",1256 IOWA ST,DUBUQUE,52001,21.39
2465,SID'S BEVERAGE SHOP,2727 DODGE ST,DUBUQUE,52003.0,56.25
4171,"BROTHERS MARKET, INC. / CASCADE",105 SE NIXON ST,CASCADE,52033.0,45.78
3744,RANDY'S NEIGHBORHOOD MARKET / DYERSVILLE,733 16TH AVE SE,DYERSVILLE,52040,45.0
5042,SUPER STOP III / DUBUQUE,1101 RHOMBERG AVE,DUBUQUE
Query:
SELECT "zipcode", CONCAT("minimum_age", '-', "maximum_age") AS "age_range", SUM("population") AS "population_count"
FROM "IOWA_LIQUOR_SALES_PLUS"."CENSUS_BUREAU_USA"."POPULATION_BY_ZIP_2010"
GROUP BY "zipcode", "minimum_age", "maximum_age"
ORDER BY "zipcode", "minimum_age"
LIMIT 100
Answer:
zipcode,age_range,population_count
10001,0-4,624
10001,5-9,458
10001,10-14,488
10001,15-17,286
10001,18-19,1090
10001,20-20,417
10001,21-21,460
10001,22-24,1755
10001,25-29,2741
10001,30-34,2095
10001,35-39,1636
10001,40-44,1464
10001,45-49,1401
10001,50-54,1305
10001,55-59,1208
10001,60-61,439
10001,62-64,608
10001,65-66,357
10001,67-69,437
10001,70-74,573
10001,75-79,468
10001,80-84,363
10001,,429
10001,,42204
10002,0-4,3620
10002,5-9,3663
10002,10-14,3660
10002,15-17,2335
10002,18-19,1763
10002,20-20,1047
10002,21-21,1138
10002,22-24,4164
10002,25-29,7458
10002,30-34,6498
10002,35-39,5711
10002,40-44,5367
10002,45-49,5483
10002,50-54,5565
10002,55-59,5327
10002,60-61,2163
10002,62-64,2599
10002,65-66,1388
10002,67-69,1855
10002,70-74,3223
10002,75-79,2815
10002,80-84,2250
10002,,2318
10002,,162820
10003,0-4,1405
10003,5-9,902
10003,10-14,737
10003,15-17,499
10003,18-19,5483
10003,20-20,2151
10003,21-21,1644
10003,22-24,4174
10003,25-29,8235
10003,30-34,6251
10003,35-39,4309
10003,40-44,3277
10003,45-49,2919
10003,50-54,2834
10003,55-59,2878
10003,60-61,1135
10003,62-64,1572
10003,65-66,824
10003,67-69,1017
10003,70-74,1328
10003,75-79,962
10003,80-84,725
10003,,763
10003,,112048
10004,0-4,202
10004,5-9,101
10004,10-14,54
10004,15-17,37
10004,18-19,22
10004,20-20,23
10004,21-21,27
10004,22-24,268
10004,25-29,567
10004,30-34,508
10004,35-39,368
10004,40-44,281
10004,45-49,169
10004,50-54,144
10004,55-59,122
10004,60-61,40
10004,62-64,56
10004,65-66,22
10004,67-69,28
10004,70-74,25
10004,75-79,12
10004,80-84,8
10004,,5
10004,,6178
10005,0-4,251
10005,5-9,84
10005,10-14,50
10005,15-17,26
End Exploring Related Columns
Task: Display the monthly per capita Bourbon Whiskey sales in 2022 for the zip code with the third-highest total sales in Dubuque County, considering only the population aged 21 and over.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Zip_Code,Month,Per_Capita_Sales
zip_code:str,Jan-2022,sales1:float
zip_code:str,Feb-2022,sales2:float
zip_code:str,Mar-2022,sales3:float
zip_code:str,Apr-2022,sales4:float
zip_code:str,May-2022,sales5:float
zip_code:str,Jun-2022,sales6:float
zip_code:str,Jul-2022,sales7:float
zip_code:str,Aug-2022,sales8:float
zip_code:str,Sep-2022,sales9:float
zip_code:str,Oct-2022,sales10:float
zip_code:str,Nov-2022,sales11:float
zip_code:str,Dec-2022,sales12:float
(Attention: answer in 12 rows)
```

This table displays the monthly per capita Bourbon Whiskey sales in 2022 for the zip code with the third-highest total sales in Dubuque County, considering only the population aged 21 and over..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'IOWA_LIQUOR_SALES_PLUS': {'CENSUS_BUREAU_USA': ['POPULATION_BY_ZIP_2000', 'POPULATION_BY_ZIP_2010'], 'IOWA_LIQUOR_SALES': ['SALES']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-23 11:17:24 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 11:17:24 - root - INFO - ```sql
WITH sales_by_month AS (
    SELECT
        EXTRACT(MONTH FROM "date") AS "month",
        SUM("sale_dollars") AS "total_bourbon_sales"
    FROM
        "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
    WHERE
        "county" = 'DUBUQUE'
        AND "category_name" ILIKE '%Bourbon%'
        AND "date" BETWEEN '2022-01-01' AND '2022-12-31'
        AND CAST(CAST("zip_code" AS FLOAT) AS INT) = 52003
    GROUP BY
        EXTRACT(MONTH FROM "date")
),
population_over_21 AS (
    SELECT
        SUM("population") AS "population_over_21"
    FROM
        "IOWA_LIQUOR_SALES_PLUS"."CENSUS_BUREAU_USA"."POPULATION_BY_ZIP_2010"
    WHERE
        "zipcode" = '52003'
        AND "minimum_age" >= 21
)
SELECT
    '52003' AS "Zip_Code",
    TO_CHAR(DATE_FROM_PARTS(2022, "month", 1), 'MON-YYYY') AS "Month",
    ROUND("total_bourbon_sales" / "population_over_21", 4) AS "Per_Capita_Sales"
FROM
    sales_by_month,
    population_over_21
ORDER BY
    "month";
```
2025-01-23 11:17:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:17:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:17:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:17:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 12
2025-01-23 11:17:26 - snowflake.connector.connection - INFO - closed
2025-01-23 11:17:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:17:26 - root - INFO - itercount: 1
2025-01-23 11:17:26 - root - INFO - 0
2025-01-23 11:17:26 - root - INFO - results: 
Zip_Code,Month,Per_Capita_Sales
52003,Jan-2022,1.327
52003,Feb-2022,0.9924
52003,Mar-2022,0.8715
52003,Apr-2022,1.3695
52003,May-2022,1.0246
52003,Jun-2022,0.8893
52003,Jul-2022,1.211
52003,Aug-2022,1.4927
52003,Sep-2022,1.2817
52003,Oct-2022,1.2887
52003,Nov-2022,1.0929
52003,Dec-2022,1.6447


2025-01-23 11:17:26 - root - INFO - Please check the answer again by reviewing Display the monthly per capita Bourbon Whiskey sales in 2022 for the zip code with the third-highest total sales in Dubuque County, considering only the population aged 21 and over., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Zip_Code,Month,Per_Capita_Sales
zip_code:str,Jan-2022,sales1:float
zip_code:str,Feb-2022,sales2:float
zip_code:str,Mar-2022,sales3:float
zip_code:str,Apr-2022,sales4:float
zip_code:str,May-2022,sales5:float
zip_code:str,Jun-2022,sales6:float
zip_code:str,Jul-2022,sales7:float
zip_code:str,Aug-2022,sales8:float
zip_code:str,Sep-2022,sales9:float
zip_code:str,Oct-2022,sales10:float
zip_code:str,Nov-2022,sales11:float
zip_code:str,Dec-2022,sales12:float
(Attention: answer in 12 rows)
```

This table displays the monthly per capita Bourbon Whiskey sales in 2022 for the zip code with the third-highest total sales in Dubuque County, considering only the population aged 21 and over. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Zip_Code,Month,Per_Capita_Sales
52003,Jan-2022,1.327
52003,Feb-2022,0.9924
52003,Mar-2022,0.8715
52003,Apr-2022,1.3695
52003,May-2022,1.0246
52003,Jun-2022,0.8893
52003,Jul-2022,1.211
52003,Aug-2022,1.4927
52003,Sep-2022,1.2817
52003,Oct-2022,1.2887
52003,Nov-2022,1.0929
52003,Dec-2022,1.6447
Current sql:
WITH sales_by_month AS (
    SELECT
        EXTRACT(MONTH FROM "date") AS "month",
        SUM("sale_dollars") AS "total_bourbon_sales"
    FROM
        "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
    WHERE
        "county" = 'DUBUQUE'
        AND "category_name" ILIKE '%Bourbon%'
        AND "date" BETWEEN '2022-01-01' AND '2022-12-31'
        AND CAST(CAST("zip_code" AS FLOAT) AS INT) = 52003
    GROUP BY
        EXTRACT(MONTH FROM "date")
),
population_over_21 AS (
    SELECT
        SUM("population") AS "population_over_21"
    FROM
        "IOWA_LIQUOR_SALES_PLUS"."CENSUS_BUREAU_USA"."POPULATION_BY_ZIP_2010"
    WHERE
        "zipcode" = '52003'
        AND "minimum_age" >= 21
)
SELECT
    '52003' AS "Zip_Code",
    TO_CHAR(DATE_FROM_PARTS(2022, "month", 1), 'MON-YYYY') AS "Month",
    ROUND("total_bourbon_sales" / "population_over_21", 4) AS "Per_Capita_Sales"
FROM
    sales_by_month,
    population_over_21
ORDER BY
    "month";
2025-01-23 11:18:00 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 11:18:00 - root - INFO - ```sql
WITH sales_by_month AS (
    SELECT
        EXTRACT(MONTH FROM "date") AS "month",
        SUM("sale_dollars") AS "total_bourbon_sales"
    FROM
        "IOWA_LIQUOR_SALES_PLUS"."IOWA_LIQUOR_SALES"."SALES"
    WHERE
        "county" = 'DUBUQUE'
        AND "category_name" ILIKE '%Bourbon%'
        AND "date" BETWEEN '2022-01-01' AND '2022-12-31'
        AND CAST(CAST("zip_code" AS FLOAT) AS INT) = 52003
    GROUP BY
        EXTRACT(MONTH FROM "date")
),
population_over_21 AS (
    SELECT
        SUM("population") AS "population_over_21"
    FROM
        "IOWA_LIQUOR_SALES_PLUS"."CENSUS_BUREAU_USA"."POPULATION_BY_ZIP_2010"
    WHERE
        "zipcode" = '52003'
        AND "minimum_age" >= 21
)
SELECT
    '52003' AS "Zip_Code",
    TO_CHAR(DATE_FROM_PARTS(2022, "month", 1), 'MON-YYYY') AS "Month",
    ROUND("total_bourbon_sales" / "population_over_21", 4) AS "Per_Capita_Sales"
FROM
    sales_by_month,
    population_over_21
ORDER BY
    "month";
```
2025-01-23 11:18:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 11:18:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 11:18:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 11:18:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 12
2025-01-23 11:18:02 - snowflake.connector.connection - INFO - closed
2025-01-23 11:18:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 11:18:02 - root - INFO - itercount: 2
2025-01-23 11:18:02 - root - INFO - 0
2025-01-23 11:18:02 - root - INFO - Total iteration counts: 2
