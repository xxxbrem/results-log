SELECT COUNT(DISTINCT last7days."USER_PSEUDO_ID") AS "Number_of_Pseudo_Users"
FROM (
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
) AS last7days
LEFT JOIN (
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
) AS last2days
ON last7days."USER_PSEUDO_ID" = last2days."USER_PSEUDO_ID"
WHERE last2days."USER_PSEUDO_ID" IS NULL;