2025-01-24 08:28:34 - openai._base_client - INFO - Retrying request to /chat/completions in 0.462412 seconds
2025-01-24 08:29:44 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 08:29:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:29:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:29:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:29:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-24 08:29:46 - snowflake.connector.connection - INFO - closed
2025-01-24 08:29:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:29:46 - root - INFO - SQL:
SELECT "usaf", "wban", "name", "lat", "lon"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
   WHERE "name" ILIKE '%JFK%' OR "name" ILIKE '%John F Kennedy%'
   LIMIT 100;
Results:
usaf,wban,name,lat,lon
726419,94929,JOHN F KENNEDY MEMO ARPT,46.549,-90.919
744860,94789,JOHN F KENNEDY INTERNATIONAL,40.639,-73.764

2025-01-24 08:29:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:29:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:29:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:29:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-24 08:29:48 - snowflake.connector.connection - INFO - closed
2025-01-24 08:29:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:30:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 08:30:10 - root - INFO - ```sql
SELECT "year", "mo", "da", "wdsp"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "stn" = '744860' AND "wban" = '94789'
LIMIT 100;
```
2025-01-24 08:30:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:30:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:30:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:30:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:30:12 - snowflake.connector.connection - INFO - closed
2025-01-24 08:30:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:32:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 08:32:02 - root - INFO - SQL:
SELECT "year", "mo", "da", "wdsp"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "stn" = '744860' AND "wban" = '94789'
LIMIT 100;
Results:
year,mo,da,wdsp
2011,06,30,11.6
2011,06,23,5.6
2011,12,21,7.8
2011,11,10,3.8
2011,05,15,8.9
2011,05,24,8.6
2011,09,29,9.5
2011,12,06,8.0
2011,07,29,7.3
2011,01,19,8.2
2011,04,20,6.6
2011,01,12,14.6
2011,01,18,11.1
2011,07,21,10.5
2011,04,01,10.7
2011,03,24,11.6
2011,10,27,7.3
2011,09,26,3.9
2011,01,29,6.7
2011,07,25,7.5
2011,07,31,5.4
2011,10,28,10.4
2011,01,28,4.9
2011,04,16,16.9
2011,08,09,8.0
2011,05,18,13.3
2011,08,20,5.6
2011,08,02,9.0
2011,09,22,5.0
2011,03,23,6.1
2011,04,25,3.8
2011,04,28,19.5
2011,08,14,6.2
2011,10,29,11.4
2011,10,19,9.7
2011,04,23,10.8
2011,01,02,4.6
2011,02,08,12.5
2011,05,20,4.6
2011,12,10,10.9
2011,06,29,8.9
2011,10,30,14.1
2011,10,16,14.7
2011,04,14,8.6
2011,08,22,10.2
2011,07,27,8.3
2011,07,18,11.9
2011,04,11,9.9
2011,05,16,9.3
2011,09,07,10.1
2011,03,06,11.4
2011,02,25,14.9
2011,11,22,6.4
2011,01,07,6.3
2011,02,05,5.8
2011,01,21,11.6
2011,09,08,8.8
2011,02,21,8.9
2011,05,23,9.4
2011,01,26,7.3
2011,06,25,6.4
2011,06,11,8.4
2011,03,07,19.9
2011,04,10,5.3
2011,05,30,7.4
2011,08,07,12.8
2011,08,26,5.6
2011,09,20,7.9
2011,12,26,14.5
2011,02,23,9.6
2011,01,17,7.9
2011,10,01,8.5
2011,01,06,4.4
2011,07,11,8.4
2011,07,12,12.8
2011,04,15,10.4
2011,01,08,5.6
2011,02,12,9.7
2011,02,11,10.8
2011,10,26,5.5
2011,02,16,7.3
2011,12,19,7.9
2011,07,15,8.9
2011,05,12,6.5
2011,07,02,4.8
2011,09,04,9.6
2011,11,08,3.7
2011,12,02,4.8
2011,02,09,15.7
2011,11,01,7.9
2011,01,24,8.7
2011,02,14,13.6
2011,03,29,15.6
2011,03,14,8.8
2011,12,17,9.1
2011,03,08,9.1
2011,03,30,10.1
2011,12,18,10.3
2011,02,18,6.5
2011,10,06,7.5

2025-01-24 08:32:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:32:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:32:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:32:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:32:04 - snowflake.connector.connection - INFO - closed
2025-01-24 08:32:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:32:04 - root - INFO - SQL:
SELECT "year", "mo", "da", "wdsp"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
WHERE "stn" = '744860' AND "wban" = '94789'
LIMIT 100
Results:
year,mo,da,wdsp
2012,10,03,4.4
2012,10,20,8.1
2012,08,29,8.4
2012,07,04,9.2
2012,09,09,6.4
2012,05,14,8.1
2012,07,11,4.3
2012,01,05,11.6
2012,09,21,6.9
2012,04,15,8.4
2012,12,03,6.7
2012,08,30,6.7
2012,07,21,7.1
2012,10,21,10.3
2012,07,09,8.3
2012,04,19,6.6
2012,02,19,8.8
2012,06,16,7.1
2012,10,01,10.8
2012,06,29,8.3
2012,02,14,6.6
2012,03,11,11.2
2012,11,19,9.1
2012,12,27,20.7
2012,10,23,3.6
2012,02,25,21.5
2012,11,18,6.0
2012,08,31,11.3
2012,05,28,6.6
2012,01,16,9.3
2012,11,03,14.7
2012,01,02,16.7
2012,11,11,6.2
2012,04,05,11.6
2012,05,20,8.0
2012,06,10,4.8
2012,09,06,4.5
2012,03,08,14.2
2012,02,01,9.5
2012,07,13,7.5
2012,10,13,7.6
2012,11,15,6.8
2012,06,28,8.8
2012,05,18,6.8
2012,08,04,7.7
2012,03,19,6.5
2012,03,24,8.3
2012,02,12,18.9
2012,06,30,10.1
2012,10,07,6.2
2012,03,21,3.8
2012,03,22,4.7
2012,12,08,4.5
2012,09,04,6.9
2012,03,03,11.9
2012,10,29,27.2
2012,03,18,6.3
2012,05,16,6.1
2012,05,15,11.6
2012,05,04,5.9
2012,03,16,6.8
2012,12,11,9.3
2012,04,22,12.5
2012,03,31,10.6
2012,06,25,8.7
2012,03,02,8.7
2012,06,14,8.8
2012,06,19,7.7
2012,10,24,4.4
2012,09,02,6.5
2012,09,18,18.8
2012,08,11,9.1
2012,10,27,5.4
2012,05,31,6.8
2012,05,17,9.0
2012,06,18,5.6
2012,07,18,9.8
2012,04,25,8.6
2012,03,01,9.9
2012,12,20,8.3
2012,07,31,6.3
2012,10,26,3.0
2012,08,12,9.1
2012,07,16,10.1
2012,01,21,10.3
2012,04,21,8.5
2012,05,09,8.0
2012,05,25,6.4
2012,12,09,7.1
2012,10,09,8.1
2012,01,12,13.8
2012,12,10,7.0
2012,11,13,12.1
2012,05,01,9.6
2012,01,23,7.8
2012,11,27,5.6
2012,08,05,12.6
2012,06,13,8.4
2012,05,26,6.3
2012,12,04,6.5

2025-01-24 08:32:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:32:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:32:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:32:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:32:05 - snowflake.connector.connection - INFO - closed
2025-01-24 08:32:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:32:06 - root - INFO - SQL:
SELECT DISTINCT "wdsp"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "stn" = '744860' AND "wban" = '94789'
LIMIT 100
Results:
wdsp
8.6
6.6
14.6
7.5
5.4
8.3
5.5
6.5
10.6
8.4
7.1
4.6
6.3
5.0
6.1
10.0
9.2
14.9
12.3
5.9
4.5
5.6
8.9
9.5
8.5
10.3
4.7
20.4
25.7
11.5
4.3
13.4
6.0
14.2
5.8
12.2
7.8
10.4
11.9
15.7
7.3
13.2
11.4
15.5
22.9
18.4
18.9
11.6
8.2
11.1
10.9
3.7
11.2
5.2
9.9
11.8
16.1
13.8
9.8
15.9
20.0
13.9
11.7
16.0
15.0
9.6
6.2
15.3
8.7
13.3
5.3
14.5
4.4
8.8
9.0
16.7
12.7
11.0
4.0
4.2
3.2
13.6
9.3
17.2
12.0
5.1
8.1
10.2
12.8
10.7
3.9
16.9
14.7
10.8
14.4
4.9
19.1
12.5
18.2
12.1

2025-01-24 08:32:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:32:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:32:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:32:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:32:07 - snowflake.connector.connection - INFO - closed
2025-01-24 08:32:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:32:07 - root - INFO - SQL:
SELECT "latitude", "longitude", "created_date", "complaint_type"
FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
WHERE "latitude" BETWEEN 40.6 AND 40.7 AND "longitude" BETWEEN -73.8 AND -73.75
LIMIT 100
Results:
Too long, hard cut:
latitude,longitude,created_date,complaint_type
40.6930152096186,-73.75188733881905,1606121920000000,WATER LEAK
40.694786523995695,-73.75104771851888,1606237879000000,APPLIANCE
40.694786523995695,-73.75104771851888,1606237654000000,GENERAL
40.69276824563247,-73.75836837449002,1606370965000000,HEAT/HOT WATER
40.68921589617757,-73.75163824672329,1606489463000000,APPLIANCE
40.68960774377581,-73.7630422607621,1606930251000000,HEAT/HOT WATER
40.68921589617757,-73.75163824672329,1607009715000000,APPLIANCE
40.68960774377581,-73.7630422607621,1607094197000000,HEAT/HOT WATER
40.69787842989729,-73.77013901276935,1607171394000000,HEAT/HOT WATER
40.695372205056216,-73.7632489650081,1607177760000000,Sewer
40.68831532196032,-73.75406111597934,1607504212000000,HEAT/HOT WATER
40.688695575475386,-73.75864636042678,1607502877000000,HEAT/HOT WATER
40.696584201424926,-73.76669587133881,1607599380000000,Street Light Condition
40.69467264028789,-73.76342093943445,1607609340000000,Street Light Condition
40.69341885365348,-73.76236879821914,1607699769000000,HEAT/HOT WATER
40.69970779754164,-73.77081432416178,1607844503000000,ELECTRIC
40.68921589617757,-73.75163824672329,1607890944000000,APPLIANCE
40.69341885365348,-73.76236879821914,1608020414000000,HEAT/HOT WATER
40.69276824563247,-73.75836837449002,1608152054000000,HEAT/HOT WATER
40.69950636283943,-73.7716589230363,1607936893000000,Street Condition
40.68952986767952,-73.75086180869279,1608136294000000,HEAT/HOT WATER
40.69515778529247,-73.76176036442405,1608644328000000,Street Condition
40.68868883599693,-73.76199982878587,1608472607000000,HEAT/HOT WATER
40.6939938188603,-73.75384904422563,1608471775000000,HEAT/HOT WATER
40.68921589617757,-73.75163824672329,1608669743000000,HEAT/HOT WATER
40.68921589617757,-73.75163824672329,1608669563000000,APPLIANCE
40.69341885365348,-73.76236879821914,1608722048000000,HEAT/HOT WATER
40.695372205056216,-73.7632489650081,1608732435000000,Street Condition
40.69142785123558,-73.76054404519441,1608972210000000,HEAT/HOT WATER
40.69341885365348,-73.76236879821914,1609077061000000,HEAT/HOT WATER
40.69229694840429,-73.76006492549331,1609234073000000,PAINT/PLASTER
40.68696384212595,-73.76138579495314,1609325602000000,HEAT/HOT WATER
40.69458543859125,-73.75071670137608,1609949575000000,HEAT/HOT WATER
40.69319240296928,-73.765712457099,1610009767000000,ELECTRIC
40.69142785123558,-73.76054404519441,1610098548000000,HEAT/HOT WATER
40.69142785123558,-73.76054404519441,1610096878000000,HEAT/HOT WATER
40.69051779769303,-73.76112787181323,1610292137000000,HEAT/HOT WATER
40.694786523995695,-73.75104771851888,1610301724000000,HEAT/HOT WATER
40.69284760055425,-73.75180502270138,1610357248000000,HEAT/HOT WATER
40.69515778529247,-73.76176036442405,1610357415000000,Street Condition
40.69009180505458,-73.75434664380816,1620287199000000,General Construction/Plumbing
40.69343797038164,-73.75967857166243,1608385380000000,Sewer
40.699425134551625,-73.76271163935334,1608203580000000,Water Conservation
40.69751219459239,-73.75752533120243,1625597400000000,Water System
40.68725708844597,-73.75985229066444,1615120680000000,Sewer
40.68775559596806,-73.75674229268276,1606166520000000,Sewer
40.68722784688393,-73.75638724623143,1606765200000000,Sewer
40.696843090442535,-73.76849089977634,1607879820000000,Sewer
40.69906684861802,-73.7633332179081,1632598779000000,Litter Basket Request
40.69885021887455,-73.75815158542608,1628594452000000,Illegal Parking
40.692997257290415,-73.76157335568037,1608275820000000,Snow
40.6929175845764,-73.76153757976469,1627038058000000,Street Condition
40.69290938765892,-73.76155563949021,1630438239000000,Abandoned Vehicle
40.69296708735768,-73.76158428182205,1632706413000000,Blocked Driveway
40.68946501625971,-73.76304276798035,1628377119000000,Non-Emergency Police Matter
40.689649800197,-73.76214063494399,1628680706000000,Abandoned Vehicle
40.68963327946388,-73.76211545254594,1629347987000000,Noise - Residential
40.68926454482284,-73.76299299801872,1629367326000000,Illegal Parking
40.689836451314925,-73.76214357502006,1629500996000000,Noise - Residential
40.6893916809624,-73.76208746735215,1630716536000000,Noise - Residential
40.689224250607126,-73.76208806475351,1633038145000000,Blocked Driveway
40.68794941835187,-73.76281017021799,1609927380000000,New Tree Request
40.68807884667455,-73.76036496345633,1625675991000000,Overgrown Tree/Branches
40.68741719096587,-73.76160773131075,1626703218000000,Dead/Dying Tree
40.68796310499221,-73.76279209246151,1626927629000000,Noise - Residential
40.68796310499221,-73.76279209246151,1626926602000000,Noise - Residential
40.68796310499221,-73.76279209246151,1626926944000000,Noise - Residential
40.68807884667455,-73.76036496345633,1627175004000000,Blocked Driveway
40.68789810634672,-73.7618872651936,1627226599000000,Blocked Driveway
40.688157048431975,-73.76367122373321,1627695952000000,Noise - Residential
40.68826974649513,-73.76375015257751,1627773699000000,Noise - Commercial
40.68826017351641,-73.76044724589906,16

2025-01-24 08:32:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:32:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:32:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:32:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:32:09 - snowflake.connector.connection - INFO - closed
2025-01-24 08:32:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:32:09 - root - INFO - SQL:
SELECT "complaint_type", COUNT(*) AS "complaint_count"
FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
WHERE "latitude" BETWEEN 40.6 AND 40.7 AND "longitude" BETWEEN -73.8 AND -73.75
GROUP BY "complaint_type"
ORDER BY "complaint_count" DESC
LIMIT 100
Results:
complaint_type,complaint_count
Noise - Residential,44397
Request Large Bulky Item Collection,31800
Blocked Driveway,30799
Sewer,23918
Illegal Parking,22893
Street Condition,22581
Street Light Condition,19391
Water System,17971
Derelict Vehicles,15602
HEAT/HOT WATER,15275
Sanitation Condition,13112
Dirty Conditions,13087
PLUMBING,12592
Damaged Tree,12349
Missed Collection (All Materials),12214
Building/Use,11743
Derelict Vehicle,10703
HEATING,10142
UNSANITARY CONDITION,9095
Overgrown Tree/Branches,7848
Abandoned Vehicle,7174
General Construction/Plumbing,7051
Rodent,7034
Traffic Signal Condition,6978
GENERAL CONSTRUCTION,6782
ELECTRIC,6545
Taxi Complaint,5904
Sidewalk Condition,5165
Noise - Street/Sidewalk,4900
Root/Sewer/Sidewalk Condition,4736
PAINT/PLASTER,4496
Noise - Vehicle,4458
Non-Emergency Police Matter,4214
NONCONST,3802
PAINT - PLASTER,3697
Consumer Complaint,3374
WATER LEAK,3324
DOOR/WINDOW,3213
Noise,3074
APPLIANCE,2476
GENERAL,2412
Noise - Commercial,2189
Snow,1989
Lost Property,1969
Water Conservation,1969
Missed Collection,1919
New Tree Request,1881
For Hire Vehicle Complaint,1848
FLOORING/STAIRS,1740
Dead/Dying Tree,1641
Vacant Lot,1629
Illegal Fireworks,1586
Maintenance or Facility,1542
Street Sign - Missing,1469
Construction,1468
Dead Tree,1459
Street Sign - Damaged,1451
Animal Abuse,1370
Food Establishment,1221
Other Enforcement,1172
Plumbing,1141
Graffiti,1127
Street Sign - Dangling,1014
SAFETY,976
Electronics Waste Appointment,854
Elevator,845
Curb Condition,819
Illegal Dumping,815
Lead,811
Unsanitary Animal Pvt Property,777
Dirty Condition,731
Taxi Report,724
Air Quality,722
Highway Condition,720
Traffic,712
Electrical,693
Hazardous Materials,671
Indoor Air Quality,617
Standing Water,586
Homeless Person Assistance,518
Noise - Park,493
Boilers,462
Obstruction,461
Miscellaneous Categories,455
Food Poisoning,454
Animal-Abuse,449
Unleashed Dog,440
Litter Basket / Request,434
NonCompliance with Phased Reopening,421
Illegal Tree Damage,402
Homeless Encampment,394
School Maintenance,372
Broken Muni Meter,345
DOF Property - Payment Issue,332
Industrial Waste,331
Indoor Sewage,323
Special Projects Inspection Team (SPIT),286
Emergency Response Team (ERT),280
Drug Activity,278
Water Quality,262

2025-01-24 08:32:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:32:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:32:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:32:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:32:11 - snowflake.connector.connection - INFO - closed
2025-01-24 08:32:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:32:42 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 08:32:42 - root - INFO - ```sql
SELECT DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) AS "complaint_date", COUNT(*) AS "complaint_count"
FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
WHERE "complaint_type" = 'Noise - Street/Sidewalk'
GROUP BY "complaint_date"
ORDER BY "complaint_date"
LIMIT 100;
```
2025-01-24 08:32:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:32:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:32:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:32:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:32:43 - snowflake.connector.connection - INFO - closed
2025-01-24 08:32:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:34:16 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 08:34:16 - root - INFO - SQL:
SELECT DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) AS "complaint_date", COUNT(*) AS "complaint_count"
FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
WHERE "complaint_type" = 'Noise - Street/Sidewalk'
GROUP BY "complaint_date"
ORDER BY "complaint_date"
LIMIT 100;
Results:
complaint_date,complaint_count
2010-01-01,17
2010-01-02,9
2010-01-03,2
2010-01-04,5
2010-01-05,5
2010-01-06,15
2010-01-07,14
2010-01-08,18
2010-01-09,13
2010-01-10,7
2010-01-11,9
2010-01-12,5
2010-01-13,12
2010-01-14,7
2010-01-15,12
2010-01-16,30
2010-01-17,21
2010-01-18,19
2010-01-19,10
2010-01-20,10
2010-01-21,26
2010-01-22,18
2010-01-23,29
2010-01-24,17
2010-01-25,10
2010-01-26,16
2010-01-27,22
2010-01-28,7
2010-01-29,9
2010-01-30,15
2010-01-31,8
2010-02-01,4
2010-02-02,9
2010-02-03,4
2010-02-04,16
2010-02-05,22
2010-02-06,13
2010-02-07,8
2010-02-08,12
2010-02-09,11
2010-02-10,6
2010-02-11,9
2010-02-12,8
2010-02-13,18
2010-02-14,10
2010-02-15,10
2010-02-16,3
2010-02-17,8
2010-02-18,14
2010-02-19,15
2010-02-20,30
2010-02-21,28
2010-02-22,13
2010-02-23,7
2010-02-24,4
2010-02-25,9
2010-02-26,7
2010-02-27,27
2010-02-28,25
2010-03-01,8
2010-03-02,8
2010-03-03,6
2010-03-04,14
2010-03-05,16
2010-03-06,41
2010-03-07,37
2010-03-08,18
2010-03-09,26
2010-03-10,28
2010-03-11,15
2010-03-12,10
2010-03-13,8
2010-03-14,3
2010-03-15,10
2010-03-16,36
2010-03-17,44
2010-03-18,48
2010-03-19,67
2010-03-20,88
2010-03-21,59
2010-03-22,18
2010-03-23,13
2010-03-24,30
2010-03-25,36
2010-03-26,18
2010-03-27,24
2010-03-28,20
2010-03-29,2
2010-03-30,9
2010-03-31,29
2010-04-01,39
2010-04-02,69
2010-04-03,71
2010-04-04,73
2010-04-05,79
2010-04-06,85
2010-04-07,72
2010-04-08,83
2010-04-09,40
2010-04-10,48

2025-01-24 08:34:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:34:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:34:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:34:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:34:17 - snowflake.connector.connection - INFO - closed
2025-01-24 08:34:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:34:18 - root - INFO - SQL:
SELECT "created_date", TO_TIMESTAMP_NTZ("created_date" / 1e6) AS "date_time"
FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
LIMIT 100
Results:
created_date,date_time
1332114586000000,2012-03-18 23:49:46
1331302450000000,2012-03-09 14:14:10
1331307205000000,2012-03-09 15:33:25
1331473691000000,2012-03-11 13:48:11
1331477541000000,2012-03-11 14:52:21
1331547512000000,2012-03-12 10:18:32
1331560909000000,2012-03-12 14:01:49
1331658363000000,2012-03-13 17:06:03
1331631402000000,2012-03-13 09:36:42
1331647426000000,2012-03-13 14:03:46
1331740360000000,2012-03-14 15:52:40
1331722252000000,2012-03-14 10:50:52
1331821102000000,2012-03-15 14:18:22
1331803564000000,2012-03-15 09:26:04
1331802318000000,2012-03-15 09:05:18
1331915005000000,2012-03-16 16:23:25
1331891838000000,2012-03-16 09:57:18
1331908360000000,2012-03-16 14:32:40
1331913276000000,2012-03-16 15:54:36
1331893276000000,2012-03-16 10:21:16
1331894821000000,2012-03-16 10:47:01
1331897425000000,2012-03-16 11:30:25
1331961645000000,2012-03-17 05:20:45
1332852857000000,2012-03-27 12:54:17
1332838332000000,2012-03-27 08:52:12
1332856792000000,2012-03-27 13:59:52
1332947704000000,2012-03-28 15:15:04
1332947847000000,2012-03-28 15:17:27
1332959902000000,2012-03-28 18:38:22
1332152100000000,2012-03-19 10:15:00
1332173019000000,2012-03-19 16:03:39
1332149897000000,2012-03-19 09:38:17
1332153752000000,2012-03-19 10:42:32
1332155204000000,2012-03-19 11:06:44
1332151820000000,2012-03-19 10:10:20
1332175152000000,2012-03-19 16:39:12
1332156872000000,2012-03-19 11:34:32
1332252227000000,2012-03-20 14:03:47
1332255523000000,2012-03-20 14:58:43
1332240238000000,2012-03-20 10:43:58
1332345787000000,2012-03-21 16:03:07
1332335170000000,2012-03-21 13:06:10
1332320769000000,2012-03-21 09:06:09
1332359848000000,2012-03-21 19:57:28
1332429174000000,2012-03-22 15:12:54
1332415716000000,2012-03-22 11:28:36
1332413987000000,2012-03-22 10:59:47
1332412888000000,2012-03-22 10:41:28
1332506893000000,2012-03-23 12:48:13
1332505745000000,2012-03-23 12:29:05
1484746688000000,2017-01-18 13:38:08
1332602918000000,2012-03-24 15:28:38
1332592510000000,2012-03-24 12:35:10
1332761839000000,2012-03-26 11:37:19
1332765971000000,2012-03-26 12:46:11
1332764877000000,2012-03-26 12:27:57
1332773295000000,2012-03-26 14:48:15
1332801025000000,2012-03-26 22:30:25
1332759075000000,2012-03-26 10:51:15
1333110985000000,2012-03-30 12:36:25
1333114171000000,2012-03-30 13:29:31
1333105175000000,2012-03-30 10:59:35
1333372663000000,2012-04-02 13:17:43
1333380392000000,2012-04-02 15:26:32
1333377801000000,2012-04-02 14:43:21
1333365269000000,2012-04-02 11:14:29
1333360918000000,2012-04-02 10:01:58
1333360641000000,2012-04-02 09:57:21
1485007950000000,2017-01-21 14:12:30
1333386325000000,2012-04-02 17:05:25
1333463826000000,2012-04-03 14:37:06
1333460253000000,2012-04-03 13:37:33
1333571537000000,2012-04-04 20:32:17
1333541086000000,2012-04-04 12:04:46
1333635856000000,2012-04-05 14:24:16
1485278629000000,2017-01-24 17:23:49
1485248303000000,2017-01-24 08:58:23
1485420934000000,2017-01-26 08:55:34
1485773712000000,2017-01-30 10:55:12
1485770202000000,2017-01-30 09:56:42
1485776004000000,2017-01-30 11:33:24
1486664997000000,2017-02-09 18:29:57
1486987790000000,2017-02-13 12:09:50
1487427437000000,2017-02-18 14:17:17
1487771680000000,2017-02-22 13:54:40
1265130698000000,2010-02-02 17:11:38
1488368867000000,2017-03-01 11:47:47
1488445480000000,2017-03-02 09:04:40
1489068920000000,2017-03-09 14:15:20
1489569575000000,2017-03-15 09:19:35
1489845502000000,2017-03-18 13:58:22
1490088579000000,2017-03-21 09:29:39
1489572949000000,2017-03-15 10:15:49
1489582276000000,2017-03-15 12:51:16
1490626687000000,2017-03-27 14:58:07
1492171599000000,2017-04-14 12:06:39
1492609221000000,2017-04-19 13:40:21
1492588633000000,2017-04-19 07:57:13
1492702747000000,2017-04-20 15:39:07
1493380825000000,2017-04-28 12:00:25

2025-01-24 08:34:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:34:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:34:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:34:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:34:19 - snowflake.connector.connection - INFO - closed
2025-01-24 08:34:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:34:20 - root - INFO - SQL:
SELECT TO_TIMESTAMP_NTZ("created_date" / 1e6) AS "date_time"
FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
LIMIT 100
Results:
date_time
2012-03-18 23:49:46
2012-03-09 14:14:10
2012-03-09 15:33:25
2012-03-11 13:48:11
2012-03-11 14:52:21
2012-03-12 10:18:32
2012-03-12 14:01:49
2012-03-13 17:06:03
2012-03-13 09:36:42
2012-03-13 14:03:46
2012-03-14 15:52:40
2012-03-14 10:50:52
2012-03-15 14:18:22
2012-03-15 09:26:04
2012-03-15 09:05:18
2012-03-16 16:23:25
2012-03-16 09:57:18
2012-03-16 14:32:40
2012-03-16 15:54:36
2012-03-16 10:21:16
2012-03-16 10:47:01
2012-03-16 11:30:25
2012-03-17 05:20:45
2012-03-27 12:54:17
2012-03-27 08:52:12
2012-03-27 13:59:52
2012-03-28 15:15:04
2012-03-28 15:17:27
2012-03-28 18:38:22
2012-03-19 10:15:00
2012-03-19 16:03:39
2012-03-19 09:38:17
2012-03-19 10:42:32
2012-03-19 11:06:44
2012-03-19 10:10:20
2012-03-19 16:39:12
2012-03-19 11:34:32
2012-03-20 14:03:47
2012-03-20 14:58:43
2012-03-20 10:43:58
2012-03-21 16:03:07
2012-03-21 13:06:10
2012-03-21 09:06:09
2012-03-21 19:57:28
2012-03-22 15:12:54
2012-03-22 11:28:36
2012-03-22 10:59:47
2012-03-22 10:41:28
2012-03-23 12:48:13
2012-03-23 12:29:05
2017-01-18 13:38:08
2012-03-24 15:28:38
2012-03-24 12:35:10
2012-03-26 11:37:19
2012-03-26 12:46:11
2012-03-26 12:27:57
2012-03-26 14:48:15
2012-03-26 22:30:25
2012-03-26 10:51:15
2012-03-30 12:36:25
2012-03-30 13:29:31
2012-03-30 10:59:35
2012-04-02 13:17:43
2012-04-02 15:26:32
2012-04-02 14:43:21
2012-04-02 11:14:29
2012-04-02 10:01:58
2012-04-02 09:57:21
2017-01-21 14:12:30
2012-04-02 17:05:25
2012-04-03 14:37:06
2012-04-03 13:37:33
2012-04-04 20:32:17
2012-04-04 12:04:46
2012-04-05 14:24:16
2017-01-24 17:23:49
2017-01-24 08:58:23
2017-01-26 08:55:34
2017-01-30 10:55:12
2017-01-30 09:56:42
2017-01-30 11:33:24
2017-02-09 18:29:57
2017-02-13 12:09:50
2017-02-18 14:17:17
2017-02-22 13:54:40
2010-02-02 17:11:38
2017-03-01 11:47:47
2017-03-02 09:04:40
2017-03-09 14:15:20
2017-03-15 09:19:35
2017-03-18 13:58:22
2017-03-21 09:29:39
2017-03-15 10:15:49
2017-03-15 12:51:16
2017-03-27 14:58:07
2017-04-14 12:06:39
2017-04-19 13:40:21
2017-04-19 07:57:13
2017-04-20 15:39:07
2017-04-28 12:00:25

2025-01-24 08:34:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:34:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:34:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:34:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:34:21 - snowflake.connector.connection - INFO - closed
2025-01-24 08:34:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:34:21 - root - INFO - SQL:
SELECT DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) AS "complaint_date", COUNT(*) AS "complaint_count"
FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
WHERE "latitude" BETWEEN 40.6 AND 40.7 AND "longitude" BETWEEN -73.8 AND -73.75
GROUP BY "complaint_date"
ORDER BY "complaint_date"
LIMIT 100
Results:
complaint_date,complaint_count
2010-01-01,51
2010-01-02,54
2010-01-03,113
2010-01-04,139
2010-01-05,144
2010-01-06,102
2010-01-07,99
2010-01-08,112
2010-01-09,77
2010-01-10,56
2010-01-11,111
2010-01-12,106
2010-01-13,103
2010-01-14,104
2010-01-15,92
2010-01-16,61
2010-01-17,64
2010-01-18,78
2010-01-19,152
2010-01-20,115
2010-01-21,102
2010-01-22,98
2010-01-23,63
2010-01-24,48
2010-01-25,139
2010-01-26,110
2010-01-27,138
2010-01-28,109
2010-01-29,92
2010-01-30,76
2010-01-31,103
2010-02-01,91
2010-02-02,114
2010-02-03,103
2010-02-04,100
2010-02-05,91
2010-02-06,50
2010-02-07,62
2010-02-08,160
2010-02-09,115
2010-02-10,52
2010-02-11,98
2010-02-12,124
2010-02-13,86
2010-02-14,59
2010-02-15,69
2010-02-16,86
2010-02-17,140
2010-02-18,135
2010-02-19,133
2010-02-20,64
2010-02-21,54
2010-02-22,101
2010-02-23,106
2010-02-24,136
2010-02-25,91
2010-02-26,47
2010-02-27,56
2010-02-28,78
2010-03-01,112
2010-03-02,135
2010-03-03,126
2010-03-04,153
2010-03-05,95
2010-03-06,59
2010-03-07,62
2010-03-08,149
2010-03-09,113
2010-03-10,96
2010-03-11,102
2010-03-12,124
2010-03-13,105
2010-03-14,150
2010-03-15,230
2010-03-16,192
2010-03-17,143
2010-03-18,149
2010-03-19,143
2010-03-20,77
2010-03-21,52
2010-03-22,168
2010-03-23,130
2010-03-24,183
2010-03-25,117
2010-03-26,81
2010-03-27,101
2010-03-28,54
2010-03-29,112
2010-03-30,146
2010-03-31,120
2010-04-01,106
2010-04-02,96
2010-04-03,58
2010-04-04,54
2010-04-05,105
2010-04-06,134
2010-04-07,107
2010-04-08,103
2010-04-09,88
2010-04-10,56

2025-01-24 08:34:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:34:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:34:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:34:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:34:23 - snowflake.connector.connection - INFO - closed
2025-01-24 08:34:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:34:23 - root - INFO - SQL:
SELECT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date", CAST("wdsp" AS FLOAT) AS "wind_speed"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "stn" = '744860' AND "wban" = '94789'
LIMIT 100
Results:
date,wind_speed
2011-06-30,11.6
2011-06-23,5.6
2011-12-21,7.8
2011-11-10,3.8
2011-05-15,8.9
2011-05-24,8.6
2011-09-29,9.5
2011-12-06,8.0
2011-07-29,7.3
2011-01-19,8.2
2011-04-20,6.6
2011-01-12,14.6
2011-01-18,11.1
2011-07-21,10.5
2011-04-01,10.7
2011-03-24,11.6
2011-10-27,7.3
2011-09-26,3.9
2011-01-29,6.7
2011-07-25,7.5
2011-07-31,5.4
2011-10-28,10.4
2011-01-28,4.9
2011-04-16,16.9
2011-08-09,8.0
2011-05-18,13.3
2011-08-20,5.6
2011-08-02,9.0
2011-09-22,5.0
2011-03-23,6.1
2011-04-25,3.8
2011-04-28,19.5
2011-08-14,6.2
2011-09-24,7.6
2011-09-23,5.2
2011-06-14,7.7
2011-08-28,25.7
2011-10-13,9.9
2011-08-27,6.4
2011-05-19,6.6
2011-01-22,10.8
2011-04-05,19.1
2011-04-27,15.9
2011-02-02,8.8
2011-12-07,7.5
2011-10-20,16.7
2011-01-27,14.9
2011-03-16,9.2
2011-10-29,11.4
2011-10-19,9.7
2011-04-23,10.8
2011-01-02,4.6
2011-02-08,12.5
2011-05-20,4.6
2011-05-21,4.3
2011-02-28,12.3
2011-03-10,20.0
2011-08-25,12.8
2011-04-11,9.9
2011-05-16,9.3
2011-09-07,10.1
2011-03-06,11.4
2011-05-17,11.8
2011-09-27,4.2
2011-12-05,3.2
2011-06-01,9.6
2011-04-13,13.6
2011-02-25,14.9
2011-11-22,6.4
2011-01-07,6.3
2011-02-05,5.8
2011-01-21,11.6
2011-05-04,11.5
2011-09-06,13.0
2011-10-14,11.5
2011-02-01,8.4
2011-04-26,10.5
2011-06-17,9.8
2011-05-29,9.1
2011-11-23,13.5
2011-09-08,8.8
2011-02-21,8.9
2011-05-23,9.4
2011-01-26,7.3
2011-06-12,8.2
2011-06-25,6.4
2011-06-11,8.4
2011-03-07,19.9
2011-05-28,9.8
2011-03-11,14.2
2011-03-21,10.3
2011-12-10,10.9
2011-06-29,8.9
2011-10-30,14.1
2011-10-16,14.7
2011-04-14,8.6
2011-08-22,10.2
2011-07-27,8.3
2011-07-18,11.9
2011-04-10,5.3

2025-01-24 08:34:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:34:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:34:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:34:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:34:25 - snowflake.connector.connection - INFO - closed
2025-01-24 08:34:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:34:25 - root - INFO - SQL:
SELECT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date", CAST("wdsp" AS FLOAT) AS "wind_speed"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "stn" = '744860' AND "wban" = '94789'
UNION ALL
SELECT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date", CAST("wdsp" AS FLOAT) AS "wind_speed"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
WHERE "stn" = '744860' AND "wban" = '94789'
LIMIT 100
Results:
date,wind_speed
2011-06-23,5.6
2011-12-21,7.8
2011-11-10,3.8
2011-05-15,8.9
2011-05-24,8.6
2011-09-29,9.5
2011-12-06,8.0
2011-07-29,7.3
2011-01-19,8.2
2011-04-20,6.6
2011-01-12,14.6
2011-01-18,11.1
2011-07-21,10.5
2011-04-01,10.7
2011-03-24,11.6
2011-10-27,7.3
2011-09-26,3.9
2011-01-29,6.7
2011-07-25,7.5
2011-09-24,7.6
2011-09-23,5.2
2011-06-14,7.7
2011-08-28,25.7
2011-10-13,9.9
2011-08-27,6.4
2011-05-19,6.6
2011-07-31,5.4
2011-10-28,10.4
2011-05-17,11.8
2011-09-27,4.2
2011-12-05,3.2
2011-06-01,9.6
2011-04-13,13.6
2011-05-04,11.5
2011-09-06,13.0
2011-10-14,11.5
2011-02-01,8.4
2011-04-26,10.5
2011-06-17,9.8
2011-01-28,4.9
2011-04-16,16.9
2011-08-09,8.0
2011-05-18,13.3
2011-01-22,10.8
2011-04-05,19.1
2011-04-27,15.9
2011-02-02,8.8
2011-12-07,7.5
2011-10-20,16.7
2011-01-27,14.9
2011-03-16,9.2
2011-06-12,8.2
2011-05-21,4.3
2011-02-28,12.3
2011-03-10,20.0
2011-08-25,12.8
2011-03-11,14.2
2011-03-21,10.3
2011-08-20,5.6
2011-08-02,9.0
2011-09-22,5.0
2011-03-23,6.1
2011-04-25,3.8
2011-04-28,19.5
2011-08-14,6.2
2011-05-29,9.1
2011-11-23,13.5
2011-05-28,9.8
2011-10-29,11.4
2011-10-19,9.7
2011-04-23,10.8
2011-01-02,4.6
2011-02-08,12.5
2011-05-20,4.6
2011-04-11,9.9
2011-05-16,9.3
2011-09-07,10.1
2011-03-06,11.4
2011-02-25,14.9
2011-11-22,6.4
2011-01-07,6.3
2011-02-05,5.8
2011-01-21,11.6
2011-09-08,8.8
2011-02-21,8.9
2011-05-23,9.4
2011-01-26,7.3
2011-06-25,6.4
2011-06-11,8.4
2011-03-07,19.9
2011-12-10,10.9
2011-06-29,8.9
2011-10-30,14.1
2011-10-16,14.7
2011-04-14,8.6
2011-08-22,10.2
2011-07-27,8.3
2011-07-18,11.9
2011-07-04,4.6
2011-09-05,12.6

2025-01-24 08:34:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:34:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:34:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:34:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:34:27 - snowflake.connector.connection - INFO - closed
2025-01-24 08:34:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:34:27 - root - INFO - SQL:
SELECT DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) AS "complaint_date", "complaint_type", COUNT(*) AS "complaint_count"
FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
WHERE "latitude" BETWEEN 40.6 AND 40.7 AND "longitude" BETWEEN -73.8 AND -73.75
  AND DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) BETWEEN '2011-01-01' AND '2020-12-31'
GROUP BY "complaint_date", "complaint_type"
ORDER BY "complaint_date", "complaint_type"
LIMIT 100
Results:
complaint_date,complaint_type,complaint_count
2011-01-01,APPLIANCE,1
2011-01-01,Blocked Driveway,15
2011-01-01,Building/Use,1
2011-01-01,Bus Stop Shelter Complaint,1
2011-01-01,Dirty Conditions,1
2011-01-01,ELECTRIC,3
2011-01-01,GENERAL CONSTRUCTION,3
2011-01-01,HEATING,5
2011-01-01,Illegal Parking,2
2011-01-01,NONCONST,2
2011-01-01,Noise - Residential,2
2011-01-01,PLUMBING,2
2011-01-01,Sewer,6
2011-01-01,Snow,27
2011-01-01,Taxi Complaint,3
2011-01-02,Blocked Driveway,6
2011-01-02,Dead Tree,1
2011-01-02,Dirty Conditions,1
2011-01-02,GENERAL CONSTRUCTION,1
2011-01-02,HEATING,5
2011-01-02,Illegal Parking,1
2011-01-02,Lead,1
2011-01-02,Noise - Residential,4
2011-01-02,Noise - Street/Sidewalk,1
2011-01-02,Noise - Vehicle,1
2011-01-02,PLUMBING,3
2011-01-02,Rodent,2
2011-01-02,Sewer,8
2011-01-02,Snow,4
2011-01-02,Street Condition,12
2011-01-02,Taxi Complaint,2
2011-01-02,Water Conservation,1
2011-01-03,Blocked Driveway,4
2011-01-03,Boilers,1
2011-01-03,Building/Use,3
2011-01-03,Derelict Vehicle,2
2011-01-03,Derelict Vehicles,6
2011-01-03,Dirty Conditions,1
2011-01-03,ELECTRIC,3
2011-01-03,For Hire Vehicle Complaint,1
2011-01-03,GENERAL CONSTRUCTION,6
2011-01-03,General Construction/Plumbing,3
2011-01-03,Graffiti,1
2011-01-03,HEATING,19
2011-01-03,Illegal Parking,4
2011-01-03,Lead,2
2011-01-03,Litter Basket / Request,1
2011-01-03,NONCONST,1
2011-01-03,Noise,1
2011-01-03,Noise - Residential,2
2011-01-03,PAINT - PLASTER,5
2011-01-03,PLUMBING,5
2011-01-03,Rodent,1
2011-01-03,Sewer,13
2011-01-03,Snow,4
2011-01-03,Street Condition,4
2011-01-03,Street Light Condition,8
2011-01-03,Street Sign - Damaged,1
2011-01-03,Street Sign - Dangling,1
2011-01-03,Street Sign - Missing,1
2011-01-03,Taxi Complaint,1
2011-01-03,Traffic Signal Condition,1
2011-01-03,Unleashed Dog,1
2011-01-03,Unsanitary Animal Pvt Property,1
2011-01-03,Water Conservation,1
2011-01-03,Water System,3
2011-01-04,Blocked Driveway,7
2011-01-04,Broken Parking Meter,1
2011-01-04,Building/Use,2
2011-01-04,Consumer Complaint,1
2011-01-04,Derelict Vehicles,3
2011-01-04,Dirty Conditions,1
2011-01-04,ELECTRIC,1
2011-01-04,GENERAL CONSTRUCTION,5
2011-01-04,General Construction/Plumbing,1
2011-01-04,HEATING,24
2011-01-04,Illegal Parking,3
2011-01-04,NONCONST,4
2011-01-04,Noise,1
2011-01-04,Noise - Residential,5
2011-01-04,PAINT - PLASTER,2
2011-01-04,PLUMBING,6
2011-01-04,Rodent,2
2011-01-04,School Maintenance,1
2011-01-04,Sewer,10
2011-01-04,Snow,1
2011-01-04,Street Condition,15
2011-01-04,Street Light Condition,2
2011-01-04,Street Sign - Damaged,1
2011-01-04,Taxi Complaint,3
2011-01-04,Traffic Signal Condition,2
2011-01-04,Water System,6
2011-01-05,APPLIANCE,1
2011-01-05,Blocked Driveway,4
2011-01-05,Building/Use,2
2011-01-05,Consumer Complaint,2
2011-01-05,Dead Tree,1
2011-01-05,Derelict Vehicle,4
2011-01-05,Derelict Vehicles,6
2011-01-05,GENERAL CONSTRUCTION,10

2025-01-24 08:34:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:34:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:34:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:34:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:34:29 - snowflake.connector.connection - INFO - closed
2025-01-24 08:34:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:34:29 - root - INFO - SQL:
SELECT "complaint_type", COUNT(*) AS "total_complaints"
FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
WHERE DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) BETWEEN '2011-01-01' AND '2020-12-31'
GROUP BY "complaint_type"
HAVING COUNT(*) > 3000
ORDER BY "total_complaints" DESC
LIMIT 100
Results:
complaint_type,total_complaints
Noise - Residential,2101533
HEAT/HOT WATER,1401369
Illegal Parking,1091061
Blocked Driveway,987818
Street Condition,914212
Street Light Condition,863387
Request Large Bulky Item Collection,723714
HEATING,673651
Noise - Street/Sidewalk,661789
PLUMBING,635068
Water System,628363
UNSANITARY CONDITION,510886
Noise,494778
General Construction/Plumbing,480596
Traffic Signal Condition,412793
PAINT/PLASTER,378476
GENERAL CONSTRUCTION,373703
Noise - Commercial,372356
Dirty Conditions,345239
Sewer,342749
Sanitation Condition,328117
Damaged Tree,324342
Missed Collection (All Materials),286927
ELECTRIC,284997
Noise - Vehicle,284865
Rodent,277281
PAINT - PLASTER,268042
Sidewalk Condition,263059
Building/Use,257183
Literature Request,253226
Derelict Vehicles,232148
DOOR/WINDOW,228613
WATER LEAK,214417
Derelict Vehicle,193327
NONCONST,191231
Consumer Complaint,186328
GENERAL,168522
New Tree Request,159125
Broken Muni Meter,158527
Graffiti,158127
FLOORING/STAIRS,151382
Taxi Complaint,149513
Non-Emergency Police Matter,148541
Overgrown Tree/Branches,147406
Homeless Person Assistance,145426
Maintenance or Facility,124164
Benefit Card Replacement,113957
Elevator,112535
APPLIANCE,110924
DOF Property - Reduction Issue,103308
Root/Sewer/Sidewalk Condition,89471
Food Establishment,87957
SCRIE,77659
Air Quality,74131
Street Sign - Damaged,72345
Snow,69871
For Hire Vehicle Complaint,67172
Electronics Waste Appointment,66018
Other Enforcement,64000
DOF Parking - Payment Issue,58962
Abandoned Vehicle,57979
SAFETY,57202
Lead,56977
DOF Property - Request Copy,53033
DOF Property - Owner Issue,52395
Animal Abuse,52178
Illegal Fireworks,52085
Dead/Dying Tree,52032
NonCompliance with Phased Reopening,51981
Street Sign - Missing,50530
Plumbing,49458
Broken Parking Meter,48735
DOF Property - Payment Issue,48217
Housing - Low Income Senior,47637
Curb Condition,47313
Dead Tree,46929
HPD Literature Request,45111
Indoor Air Quality,43641
Emergency Response Team (ERT),42449
Traffic,42327
Vending,42217
Highway Condition,40730
Noise - Park,40540
Water Conservation,39544
Special Projects Inspection Team (SPIT),39138
Homeless Encampment,36421
Electrical,33728
Construction Safety Enforcement,31234
Food Poisoning,29072
Construction,28311
Hazardous Materials,27510
Litter Basket / Request,27143
Illegal Tree Damage,26687
Electronics Waste,26491
Street Sign - Dangling,26060
Violation of Park Rules,25442
Standing Water,22665
Noise - Helicopter,22340
DOF Property - Update Account,21605
Vacant Lot,21585

2025-01-24 08:34:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:34:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:34:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:34:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:34:30 - snowflake.connector.connection - INFO - closed
2025-01-24 08:34:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:34:31 - root - INFO - SQL:
SELECT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date", CAST("wdsp" AS FLOAT) AS "wind_speed"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "stn" = '744860' AND "wban" = '94789'
UNION ALL
SELECT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date", CAST("wdsp" AS FLOAT) AS "wind_speed"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
WHERE "stn" = '744860' AND "wban" = '94789'
-- Repeat for each year up to 2020
LIMIT 100
Results:
date,wind_speed
2011-06-23,5.6
2011-12-21,7.8
2011-11-10,3.8
2011-05-15,8.9
2011-05-24,8.6
2011-09-29,9.5
2011-12-06,8.0
2011-07-29,7.3
2011-01-19,8.2
2011-04-20,6.6
2011-01-12,14.6
2011-01-18,11.1
2011-07-21,10.5
2011-04-01,10.7
2011-03-24,11.6
2011-10-27,7.3
2011-09-26,3.9
2011-01-29,6.7
2011-07-25,7.5
2011-09-24,7.6
2011-09-23,5.2
2011-06-14,7.7
2011-08-28,25.7
2011-10-13,9.9
2011-08-27,6.4
2011-05-19,6.6
2011-07-31,5.4
2011-10-28,10.4
2011-05-17,11.8
2011-09-27,4.2
2011-12-05,3.2
2011-06-01,9.6
2011-04-13,13.6
2011-05-04,11.5
2011-09-06,13.0
2011-10-14,11.5
2011-02-01,8.4
2011-04-26,10.5
2011-06-17,9.8
2011-01-28,4.9
2011-04-16,16.9
2011-08-09,8.0
2011-05-18,13.3
2011-01-22,10.8
2011-04-05,19.1
2011-04-27,15.9
2011-02-02,8.8
2011-12-07,7.5
2011-10-20,16.7
2011-01-27,14.9
2011-03-16,9.2
2011-06-12,8.2
2011-05-21,4.3
2011-02-28,12.3
2011-03-10,20.0
2011-08-25,12.8
2011-03-11,14.2
2011-03-21,10.3
2011-08-20,5.6
2011-08-02,9.0
2011-09-22,5.0
2011-03-23,6.1
2011-04-25,3.8
2011-04-28,19.5
2011-08-14,6.2
2011-05-29,9.1
2011-11-23,13.5
2011-05-28,9.8
2011-10-29,11.4
2011-10-19,9.7
2011-04-23,10.8
2011-01-02,4.6
2011-02-08,12.5
2011-05-20,4.6
2011-04-11,9.9
2011-05-16,9.3
2011-09-07,10.1
2011-03-06,11.4
2011-02-25,14.9
2011-11-22,6.4
2011-01-07,6.3
2011-02-05,5.8
2011-01-21,11.6
2011-09-08,8.8
2011-02-21,8.9
2011-05-23,9.4
2011-01-26,7.3
2011-06-25,6.4
2011-06-11,8.4
2011-03-07,19.9
2011-12-10,10.9
2011-06-29,8.9
2011-10-30,14.1
2011-10-16,14.7
2011-04-14,8.6
2011-08-22,10.2
2011-07-27,8.3
2011-07-18,11.9
2011-07-04,4.6
2011-09-05,12.6

2025-01-24 08:34:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:34:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:34:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:34:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:34:32 - snowflake.connector.connection - INFO - closed
2025-01-24 08:34:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:34:33 - root - INFO - SQL:
SELECT
  c."complaint_date",
  c."complaint_type",
  c."complaint_count",
  w."wind_speed"
FROM (
  SELECT DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) AS "complaint_date", "complaint_type", COUNT(*) AS "complaint_count"
  FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
  WHERE "latitude" BETWEEN 40.6 AND 40.7 AND "longitude" BETWEEN -73.8 AND -73.75
    AND DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) BETWEEN '2011-01-01' AND '2020-12-31'
  GROUP BY "complaint_date", "complaint_type"
) c
INNER JOIN (
  SELECT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date", AVG(CAST("wdsp" AS FLOAT)) AS "wind_speed"
  FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
  WHERE "stn" = '744860' AND "wban" = '94789'
  GROUP BY "date"
  -- Repeat UNION ALL for each year up to 2020
) w ON c."complaint_date" = w."date"
LIMIT 100
Results:
complaint_date,complaint_type,complaint_count,wind_speed
2011-02-23,NONCONST,9,9.6
2011-02-27,Noise - Vehicle,1,9.2
2011-11-18,Noise - Residential,3,12.8
2011-07-28,Graffiti,1,6.0
2011-11-03,Sidewalk Condition,2,6.8
2011-09-21,Blocked Driveway,2,4.0
2011-11-27,Damaged Tree,2,4.8
2011-10-06,Derelict Vehicles,2,7.5
2011-07-08,NONCONST,5,4.3
2011-03-30,APPLIANCE,1,10.1
2011-01-06,PLUMBING,2,4.4
2011-07-07,Construction,3,7.7
2011-05-20,Taxi Complaint,5,4.6
2011-06-10,Street Condition,5,7.0
2011-04-14,Derelict Vehicles,2,8.6
2011-11-15,Noise,2,8.5
2011-06-08,Sewer,4,8.3
2011-11-13,Sewer,5,10.0
2011-11-30,Sewer,11,15.3
2011-12-14,Sewer,9,5.2
2011-11-29,Building/Use,3,10.4
2011-09-16,Water System,6,11.0
2011-07-15,Water System,3,8.9
2011-09-01,Dirty Conditions,5,4.8
2011-06-02,Other Enforcement,2,15.4
2011-03-30,Missed Collection (All Materials),3,10.1
2011-01-04,Dirty Conditions,1,8.1
2011-01-29,Snow,69,6.7
2011-01-25,Sewer,13,5.3
2011-03-21,Sewer,9,10.3
2011-02-14,Lead,1,13.6
2011-06-01,Street Condition,7,9.6
2011-04-26,Street Condition,3,10.5
2011-07-15,Street Condition,6,8.9
2011-04-23,PLUMBING,7,10.8
2011-07-06,Sewer,15,8.3
2011-08-11,Street Light Condition,8,8.9
2011-09-16,Dirty Conditions,14,11.0
2011-09-27,Missed Collection (All Materials),2,4.2
2011-08-08,Dirty Conditions,6,8.1
2011-12-05,Dirty Conditions,2,3.2
2011-07-02,Noise,1,4.8
2011-06-27,Litter Basket / Request,1,5.9
2011-11-25,Sewer,4,8.9
2011-08-12,Sewer,3,6.0
2011-10-22,General Construction/Plumbing,1,9.6
2011-02-26,Building/Use,5,12.7
2011-11-19,Building/Use,1,11.6
2011-07-27,Vacant Lot,1,8.3
2011-05-01,Sewer,1,7.0
2011-08-24,Sewer,14,9.8
2011-10-05,Sewer,5,13.1
2011-08-18,Air Quality,1,9.8
2011-03-18,Building/Use,1,12.0
2011-06-13,Building/Use,2,7.5
2011-12-22,Sidewalk Condition,1,10.5
2011-09-11,PLUMBING,10,7.1
2011-11-05,PLUMBING,2,8.5
2011-11-19,APPLIANCE,1,11.6
2011-10-12,ELECTRIC,4,9.8
2011-08-31,ELECTRIC,6,4.4
2011-11-03,PLUMBING,4,6.8
2011-09-17,PLUMBING,8,7.0
2011-12-05,GENERAL CONSTRUCTION,8,3.2
2011-08-26,PAINT - PLASTER,3,5.6
2011-11-27,PLUMBING,2,4.8
2011-10-04,PAINT - PLASTER,7,7.5
2011-12-25,GENERAL CONSTRUCTION,6,7.1
2011-12-31,ELECTRIC,1,6.6
2011-11-15,PLUMBING,3,8.5
2011-09-07,PAINT - PLASTER,4,10.1
2011-10-01,GENERAL CONSTRUCTION,5,8.5
2011-06-04,Street Condition,3,8.4
2011-06-20,Blocked Driveway,3,5.4
2011-10-27,Indoor Sewage,1,7.3
2011-11-18,Consumer Complaint,4,12.8
2011-04-09,New Tree Request,2,6.4
2011-11-27,For Hire Vehicle Complaint,1,4.8
2011-01-29,Sewer,6,6.7
2011-04-13,PLUMBING,9,13.6
2011-01-22,Traffic Signal Condition,2,10.8
2011-03-02,Traffic Signal Condition,5,13.4
2011-03-18,Street Light Condition,15,12.0
2011-04-05,Street Light Condition,1,19.1
2011-04-11,GENERAL CONSTRUCTION,2,9.9
2011-02-16,ELECTRIC,5,7.3
2011-03-22,HEATING,6,11.4
2011-03-29,PLUMBING,2,15.6
2011-03-09,ELECTRIC,2,10.7
2011-03-01,NONCONST,7,16.1
2011-01-17,GENERAL CONSTRUCTION,1,7.9
2011-02-06,GENERAL CONSTRUCTION,1,15.4
2011-03-04,Sewer,1,7.7
2011-04-05,Sewer,1,19.1
2011-02-27,General Construction/Plumbing,1,9.2
2011-01-12,ELECTRIC,1,14.6
2011-04-08,PLUMBING,2,5.6
2011-08-03,Illegal Parking,2,7.6
2011-04-02,Blocked Driveway,4,14.8
2011-03-27,Blocked Driveway,1,12.1

2025-01-24 08:34:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:34:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:34:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:34:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:34:34 - snowflake.connector.connection - INFO - closed
2025-01-24 08:34:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:34:34 - root - INFO - SQL:
SELECT CAST("wdsp" AS FLOAT) AS "wind_speed", COUNT(*) AS "frequency"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "stn" = '744860' AND "wban" = '94789'
GROUP BY "wind_speed"
ORDER BY "frequency" DESC
LIMIT 100
Results:
wind_speed,frequency
8.9,10
7.3,9
10.8,6
8.2,6
9.9,6
9.7,6
11.6,6
7.5,6
10.4,6
5.6,6
8.1,6
5.8,6
7.6,5
6.0,5
9.6,5
5.4,5
4.8,5
7.7,5
6.4,5
8.4,5
7.1,5
10.1,5
9.8,5
7.9,5
6.6,5
6.3,4
8.0,4
9.4,4
16.1,4
9.1,4
5.2,4
7.2,4
4.6,4
9.3,4
6.2,4
7.8,4
9.0,4
12.8,4
8.8,4
10.5,4
11.4,4
14.1,3
5.3,3
3.8,3
7.0,3
6.1,3
14.4,3
10.9,3
4.4,3
8.6,3
8.5,3
11.2,3
10.0,3
8.3,3
10.2,3
8.7,3
14.9,3
6.5,3
5.0,3
13.6,3
15.6,2
3.3,2
12.2,2
9.2,2
9.5,2
4.7,2
14.6,2
6.8,2
4.3,2
6.7,2
10.7,2
19.1,2
13.0,2
12.1,2
4.2,2
5.7,2
10.3,2
11.5,2
5.9,2
15.4,2
3.6,2
13.5,2
15.5,2
13.1,2
11.1,2
15.3,2
12.3,2
18.4,1
13.7,1
11.7,1
19.5,1
22.9,1
3.7,1
7.4,1
11.8,1
16.0,1
12.6,1
4.9,1
3.2,1
16.9,1

2025-01-24 08:34:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:34:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:34:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:34:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:34:36 - snowflake.connector.connection - INFO - closed
2025-01-24 08:34:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:34:36 - root - INFO - SQL:
SELECT "created_date", "complaint_type", "borough"
FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
WHERE "borough" = 'QUEENS'
  AND DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) BETWEEN '2011-01-01' AND '2020-12-31'
LIMIT 100
Results:
created_date,complaint_type,borough
1587833460000000,Home Delivered Meal - Missed Delivery,QUEENS
1588525788000000,Home Delivered Meal - Missed Delivery,QUEENS
1589879192000000,Homeless Street Condition,QUEENS
1593896947000000,Illegal Fireworks,QUEENS
1590408156000000,Homeless Street Condition,QUEENS
1566330308000000,Homeless Encampment,QUEENS
1566504756000000,Homeless Encampment,QUEENS
1590342521000000,Homeless Street Condition,QUEENS
1590921253000000,Homeless Street Condition,QUEENS
1591871495000000,Homeless Street Condition,QUEENS
1591718868000000,Homeless Street Condition,QUEENS
1590959142000000,Homeless Street Condition,QUEENS
1592321140000000,Homeless Street Condition,QUEENS
1569324897000000,Homeless Encampment,QUEENS
1569380434000000,Urinating in Public,QUEENS
1592778404000000,Illegal Fireworks,QUEENS
1567931979000000,Homeless Encampment,QUEENS
1592291094000000,Homeless Street Condition,QUEENS
1570595879000000,Urinating in Public,QUEENS
1592693240000000,Illegal Fireworks,QUEENS
1591378231000000,Street Sign - Dangling,QUEENS
1584798830000000,Graffiti,QUEENS
1585599539000000,Graffiti,QUEENS
1587329377000000,Graffiti,QUEENS
1590625024000000,Drinking,QUEENS
1569235655000000,Animal-Abuse,QUEENS
1569322687000000,Animal-Abuse,QUEENS
1569318159000000,Animal-Abuse,QUEENS
1569236162000000,Animal-Abuse,QUEENS
1573148878000000,Blocked Driveway,QUEENS
1573254593000000,Blocked Driveway,QUEENS
1587374303000000,Blocked Driveway,QUEENS
1573420549000000,Blocked Driveway,QUEENS
1574689393000000,Blocked Driveway,QUEENS
1576184514000000,Blocked Driveway,QUEENS
1589140582000000,Blocked Driveway,QUEENS
1589500194000000,Blocked Driveway,QUEENS
1587575326000000,Blocked Driveway,QUEENS
1577288945000000,Blocked Driveway,QUEENS
1577301856000000,Blocked Driveway,QUEENS
1577502464000000,Blocked Driveway,QUEENS
1578097396000000,Blocked Driveway,QUEENS
1578241964000000,Blocked Driveway,QUEENS
1578550821000000,Blocked Driveway,QUEENS
1578983938000000,Blocked Driveway,QUEENS
1563102770000000,Blocked Driveway,QUEENS
1590598334000000,Blocked Driveway,QUEENS
1563726437000000,Blocked Driveway,QUEENS
1563795463000000,Blocked Driveway,QUEENS
1563962663000000,Blocked Driveway,QUEENS
1564882549000000,Blocked Driveway,QUEENS
1564889706000000,Blocked Driveway,QUEENS
1579422448000000,Blocked Driveway,QUEENS
1579436879000000,Blocked Driveway,QUEENS
1566405962000000,Blocked Driveway,QUEENS
1590920934000000,Blocked Driveway,QUEENS
1566866033000000,Blocked Driveway,QUEENS
1566853817000000,Blocked Driveway,QUEENS
1566856723000000,Blocked Driveway,QUEENS
1566800673000000,Blocked Driveway,QUEENS
1566942653000000,Blocked Driveway,QUEENS
1567020058000000,Blocked Driveway,QUEENS
1567207989000000,Blocked Driveway,QUEENS
1567253665000000,Blocked Driveway,QUEENS
1567278870000000,Blocked Driveway,QUEENS
1567398275000000,Blocked Driveway,QUEENS
1567535082000000,Blocked Driveway,QUEENS
1591000743000000,Blocked Driveway,QUEENS
1567731971000000,Blocked Driveway,QUEENS
1567800496000000,Blocked Driveway,QUEENS
1591183205000000,Blocked Driveway,QUEENS
1568586864000000,Blocked Driveway,QUEENS
1568615872000000,Blocked Driveway,QUEENS
1591322269000000,Blocked Driveway,QUEENS
1579694759000000,Blocked Driveway,QUEENS
1567955483000000,Blocked Driveway,QUEENS
1579721083000000,Blocked Driveway,QUEENS
1567988696000000,Blocked Driveway,QUEENS
1592409238000000,Blocked Driveway,QUEENS
1569145231000000,Blocked Driveway,QUEENS
1569241586000000,Blocked Driveway,QUEENS
1569427434000000,Blocked Driveway,QUEENS
1569536568000000,Blocked Driveway,QUEENS
1569669063000000,Blocked Driveway,QUEENS
1569697437000000,Blocked Driveway,QUEENS
1569667906000000,Blocked Driveway,QUEENS
1569732143000000,Blocked Driveway,QUEENS
1596028859000000,Blocked Driveway,QUEENS
1569806226000000,Blocked Driveway,QUEENS
1579801576000000,Blocked Driveway,QUEENS
1569959462000000,Blocked Driveway,QUEENS
1570048888000000,Blocked Driveway,QUEENS
1570062845000000,Blocked Driveway,QUEENS
1570006091000000,Blocked Driveway,QUEENS
1580224832000000,Blocked Driveway,QUEENS
1580193533000000,Blocked Driveway,QUEENS
1570098827000000,Blocked Driveway,QUEENS
1580427789000000,Blocked Driveway,QUEENS
1569031791000000,Blocked Driveway,QUEENS
1569034659000000,Blocked Driveway,QUEENS

2025-01-24 08:34:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:34:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:34:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:34:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:34:38 - snowflake.connector.connection - INFO - closed
2025-01-24 08:34:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:34:38 - root - INFO - SQL:
SELECT DATE_TRUNC('month', TO_TIMESTAMP_NTZ("created_date" / 1e6)) AS "complaint_month", "complaint_type", COUNT(*) AS "complaint_count"
FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
WHERE "latitude" BETWEEN 40.6 AND 40.7 AND "longitude" BETWEEN -73.8 AND -73.75
  AND DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) BETWEEN '2011-01-01' AND '2020-12-31'
GROUP BY "complaint_month", "complaint_type"
ORDER BY "complaint_month", "complaint_type"
LIMIT 100
Results:
complaint_month,complaint_type,complaint_count
2011-01-01,APPLIANCE,17
2011-01-01,Air Quality,1
2011-01-01,Asbestos,1
2011-01-01,Blocked Driveway,166
2011-01-01,Boilers,7
2011-01-01,Broken Parking Meter,2
2011-01-01,Building/Use,75
2011-01-01,Bus Stop Shelter Complaint,17
2011-01-01,CONSTRUCTION,1
2011-01-01,Collection Truck Noise,1
2011-01-01,Consumer Complaint,18
2011-01-01,Damaged Tree,4
2011-01-01,Dead Tree,4
2011-01-01,Derelict Vehicle,42
2011-01-01,Derelict Vehicles,58
2011-01-01,Dirty Conditions,30
2011-01-01,ELECTRIC,57
2011-01-01,Electrical,3
2011-01-01,Emergency Response Team (ERT),1
2011-01-01,Food Establishment,7
2011-01-01,Food Poisoning,4
2011-01-01,For Hire Vehicle Complaint,6
2011-01-01,GENERAL CONSTRUCTION,170
2011-01-01,General Construction/Plumbing,32
2011-01-01,Graffiti,2
2011-01-01,HEATING,449
2011-01-01,Hazardous Materials,2
2011-01-01,Highway Condition,8
2011-01-01,Illegal Parking,63
2011-01-01,Indoor Air Quality,3
2011-01-01,Industrial Waste,1
2011-01-01,Investigations and Discipline (IAD),5
2011-01-01,Lead,16
2011-01-01,Litter Basket / Request,1
2011-01-01,Maintenance or Facility,5
2011-01-01,Miscellaneous Categories,1
2011-01-01,Missed Collection (All Materials),2
2011-01-01,NONCONST,78
2011-01-01,New Tree Request,3
2011-01-01,No Child Left Behind,1
2011-01-01,Noise,10
2011-01-01,Noise - Commercial,4
2011-01-01,Noise - Helicopter,1
2011-01-01,Noise - Residential,77
2011-01-01,Noise - Street/Sidewalk,4
2011-01-01,Noise - Vehicle,3
2011-01-01,Non-Emergency Police Matter,8
2011-01-01,OEM Disabled Vehicle,13
2011-01-01,Other Enforcement,3
2011-01-01,Overgrown Tree/Branches,6
2011-01-01,PAINT - PLASTER,83
2011-01-01,PLUMBING,169
2011-01-01,Plumbing,5
2011-01-01,Public Payphone Complaint,2
2011-01-01,Rodent,33
2011-01-01,Root/Sewer/Sidewalk Condition,8
2011-01-01,Sanitation Condition,19
2011-01-01,School Maintenance,9
2011-01-01,Sewer,264
2011-01-01,Sidewalk Condition,8
2011-01-01,Snow,346
2011-01-01,Street Condition,134
2011-01-01,Street Light Condition,128
2011-01-01,Street Sign - Damaged,4
2011-01-01,Street Sign - Dangling,4
2011-01-01,Street Sign - Missing,9
2011-01-01,Taxi Complaint,44
2011-01-01,Teaching/Learning/Instruction,1
2011-01-01,Traffic,1
2011-01-01,Traffic Signal Condition,75
2011-01-01,Unleashed Dog,4
2011-01-01,Unsanitary Animal Pvt Property,8
2011-01-01,Water Conservation,12
2011-01-01,Water System,95
2011-01-01,Window Guard,6
2011-02-01,APPLIANCE,14
2011-02-01,Air Quality,1
2011-02-01,Asbestos,4
2011-02-01,BEST/Site Safety,4
2011-02-01,Blocked Driveway,123
2011-02-01,Boilers,2
2011-02-01,Broken Muni Meter,1
2011-02-01,Building/Use,71
2011-02-01,Bus Stop Shelter Complaint,7
2011-02-01,Consumer Complaint,23
2011-02-01,Curb Condition,6
2011-02-01,Damaged Tree,36
2011-02-01,Dead Tree,13
2011-02-01,Derelict Vehicle,58
2011-02-01,Derelict Vehicles,61
2011-02-01,Dirty Conditions,80
2011-02-01,Discipline and Suspension,1
2011-02-01,ELECTRIC,56
2011-02-01,Electrical,2
2011-02-01,Food Establishment,5
2011-02-01,Food Poisoning,2
2011-02-01,For Hire Vehicle Complaint,6
2011-02-01,GENERAL,6
2011-02-01,GENERAL CONSTRUCTION,110
2011-02-01,General Construction/Plumbing,24

2025-01-24 08:34:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:34:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:34:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:34:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:34:40 - snowflake.connector.connection - INFO - closed
2025-01-24 08:34:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:34:40 - root - INFO - SQL:
SELECT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date", AVG(CAST("wdsp" AS FLOAT)) AS "avg_wind_speed"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "stn" = '744860' AND "wban" = '94789'
GROUP BY "date"
-- Repeat UNION ALL and aggregation for each year up to 2020
LIMIT 100
Results:
date,avg_wind_speed
2011-09-27,4.2
2011-06-01,9.6
2011-10-14,11.5
2011-09-05,12.6
2011-01-09,17.2
2011-09-18,8.2
2011-03-04,7.7
2011-03-01,16.1
2011-03-20,9.9
2011-10-31,3.3
2011-02-03,15.3
2011-08-02,9.0
2011-03-23,6.1
2011-04-28,19.5
2011-04-23,10.8
2011-09-07,10.1
2011-09-08,8.8
2011-06-11,8.4
2011-09-21,4.0
2011-08-18,9.8
2011-09-01,4.8
2011-04-04,9.0
2011-05-10,11.6
2011-07-22,9.6
2011-04-24,5.3
2011-11-27,4.8
2011-10-10,4.5
2011-11-20,12.2
2011-01-15,9.7
2011-03-10,20.0
2011-05-28,9.8
2011-10-07,5.8
2011-04-29,10.8
2011-11-21,7.1
2011-06-08,8.3
2011-11-11,16.0
2011-01-20,10.4
2011-12-21,7.8
2011-09-29,9.5
2011-01-28,4.9
2011-09-20,7.9
2011-07-11,8.4
2011-10-26,5.5
2011-07-02,4.8
2011-03-29,15.6
2011-02-09,15.7
2011-10-06,7.5
2011-09-12,5.2
2011-05-07,10.1
2011-12-03,8.2
2011-12-01,13.8
2011-06-28,6.2
2011-10-29,11.4
2011-02-25,14.9
2011-11-22,6.4
2011-02-21,8.9
2011-10-12,9.8
2011-12-22,10.5
2011-05-26,6.6
2011-03-12,14.9
2011-06-21,8.9
2011-01-04,8.1
2011-02-10,12.1
2011-10-15,18.9
2011-01-14,8.7
2011-06-18,5.4
2011-04-18,9.3
2011-06-05,8.4
2011-01-23,9.9
2011-03-13,13.0
2011-01-11,7.5
2011-07-17,11.2
2011-04-05,19.1
2011-03-16,9.2
2011-11-07,7.7
2011-11-26,6.8
2011-10-21,15.5
2011-05-03,7.8
2011-08-06,10.9
2011-07-30,10.1
2011-07-21,10.5
2011-04-14,8.6
2011-04-10,5.3
2011-02-23,9.6
2011-04-15,10.4
2011-02-11,10.8
2011-05-06,10.6
2011-11-12,14.4
2011-05-19,6.6
2011-05-17,11.8
2011-02-01,8.4
2011-04-26,10.5
2011-10-04,7.5
2011-01-05,10.4
2011-10-11,6.5
2011-04-12,10.9
2011-02-05,5.8
2011-01-21,11.6
2011-12-23,10.1
2011-04-17,18.4

2025-01-24 08:34:40 - root - INFO - itercount: 0
2025-01-24 08:34:40 - root - INFO - Database Name: NEW_YORK_NOAA
Schema Name: NEW_YORK
DDL describes table information.
,0
table_name,_311_SERVICE_REQUESTS
description,
DDL,"create or replace TABLE _311_SERVICE_REQUESTS (
	""unique_key"" NUMBER(38,0),
	""created_date"" NUMBER(38,0),
	""closed_date"" NUMBER(38,0),
	""agency"" VARCHAR(16777216),
	""agency_name"" VARCHAR(16777216),
	""complaint_type"" VARCHAR(16777216),
	""descriptor"" VARCHAR(16777216),
	""location_type"" VARCHAR(16777216),
	""incident_zip"" VARCHAR(16777216),
	""incident_address"" VARCHAR(16777216),
	""street_name"" VARCHAR(16777216),
	""cross_street_1"" VARCHAR(16777216),
	""cross_street_2"" VARCHAR(16777216),
	""intersection_street_1"" VARCHAR(16777216),
	""intersection_street_2"" VARCHAR(16777216),
	""address_type"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""landmark"" VARCHAR(16777216),
	""facility_type"" VARCHAR(16777216),
	""status"" VARCHAR(16777216),
	""due_date"" NUMBER(38,0),
	""resolution_description"" VARCHAR(16777216),
	""resolution_action_updated_date"" NUMBER(38,0),
	""community_board"" VARCHAR(16777216),
	""borough"" VARCHAR(16777216),
	""x_coordinate"" NUMBER(38,0),
	""y_coordinate"" NUMBER(38,0),
	""park_facility_name"" VARCHAR(16777216),
	""park_borough"" VARCHAR(16777216),
	""bbl"" NUMBER(38,0),
	""open_data_channel_type"" VARCHAR(16777216),
	""vehicle_type"" VARCHAR(16777216),
	""taxi_company_borough"" VARCHAR(16777216),
	""taxi_pickup_location"" VARCHAR(16777216),
	""bridge_highway_name"" VARCHAR(16777216),
	""bridge_highway_direction"" VARCHAR(16777216),
	""road_ramp"" VARCHAR(16777216),
	""bridge_highway_segment"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""location"" VARCHAR(16777216)
);"

,1
table_name,TLC_YELLOW_TRIPS_2012
description,
DDL,"create or replace TABLE TLC_YELLOW_TRIPS_2012 (
	""vendor_id"" VARCHAR(16777216),
	""pickup_datetime"" NUMBER(38,0),
	""dropoff_datetime"" NUMBER(38,0),
	""passenger_count"" NUMBER(38,0),
	""trip_distance"" FLOAT,
	""pickup_longitude"" FLOAT,
	""pickup_latitude"" FLOAT,
	""rate_code"" NUMBER(38,0),
	""store_and_fwd_flag"" VARCHAR(16777216),
	""dropoff_longitude"" FLOAT,
	""dropoff_latitude"" FLOAT,
	""payment_type"" VARCHAR(16777216),
	""fare_amount"" FLOAT,
	""extra"" FLOAT,
	""mta_tax"" FLOAT,
	""tip_amount"" FLOAT,
	""tolls_amount"" FLOAT,
	""imp_surcharge"" FLOAT,
	""total_amount"" FLOAT
);"

Some other tables have the similar structure: ['TLC_YELLOW_TRIPS_2012', 'TLC_YELLOW_TRIPS_2013', 'TLC_YELLOW_TRIPS_2014', 'TLC_YELLOW_TRIPS_2011', 'TLC_YELLOW_TRIPS_2009', 'TLC_YELLOW_TRIPS_2010', 'TLC_YELLOW_TRIPS_2015', 'TLC_YELLOW_TRIPS_2016']
,2
table_name,CITIBIKE_STATIONS
description,
DDL,"create or replace TABLE CITIBIKE_STATIONS (
	""station_id"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""short_name"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""region_id"" NUMBER(38,0),
	""rental_methods"" VARCHAR(16777216),
	""capacity"" NUMBER(38,0),
	""eightd_has_key_dispenser"" BOOLEAN,
	""num_bikes_available"" NUMBER(38,0),
	""num_bikes_disabled"" NUMBER(38,0),
	""num_docks_available"" NUMBER(38,0),
	""num_docks_disabled"" NUMBER(38,0),
	""is_installed"" BOOLEAN,
	""is_renting"" BOOLEAN,
	""is_returning"" BOOLEAN,
	""eightd_has_available_keys"" BOOLEAN,
	""last_reported"" NUMBER(38,0)
);"

,3
table_name,TLC_FHV_TRIPS_2015
description,
DDL,"create or replace TABLE TLC_FHV_TRIPS_2015 (
	""location_id"" NUMBER(38,0),
	""pickup_datetime"" NUMBER(38,0),
	""dispatching_base_num"" VARCHAR(16777216),
	""borough"" VARCHAR(16777216),
	""zone"" VARCHAR(16777216),
	""service_zone"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['TLC_FHV_TRIPS_2015', 'TLC_FHV_TRIPS_2016']
,4
table_name,TREE_CENSUS_2005
description,
DDL,"create or replace TABLE TREE_CENSUS_2005 (
	""objectid"" NUMBER(38,0),
	""cen_year"" NUMBER(38,0),
	""tree_dbh"" NUMBER(38,0),
	""tree_loc"" VARCHAR(16777216),
	""pit_type"" VARCHAR(16777216),
	""soil_lvl"" VARCHAR(16777216),
	""status"" VARCHAR(16777216),
	""spc_latin"" VARCHAR(16777216),
	""spc_common"" VARCHAR(16777216),
	""vert_other"" VARCHAR(16777216),
	""vert_pgrd"" VARCHAR(16777216),
	""vert_tgrd"" VARCHAR(16777216),
	""vert_wall"" VARCHAR(16777216),
	""horz_blck"" VARCHAR(16777216),
	""horz_grate"" VARCHAR(16777216),
	""horz_plant"" VARCHAR(16777216),
	""horz_other"" VARCHAR(16777216),
	""sidw_crack"" VARCHAR(16777216),
	""sidw_raise"" VARCHAR(16777216),
	""wire_htap"" VARCHAR(16777216),
	""wire_prime"" VARCHAR(16777216),
	""wire_2nd"" VARCHAR(16777216),
	""wire_other"" VARCHAR(16777216),
	""inf_canopy"" VARCHAR(16777216),
	""inf_guard"" VARCHAR(16777216),
	""inf_wires"" VARCHAR(16777216),
	""inf_paving"" VARCHAR(16777216),
	""inf_outlet"" VARCHAR(16777216),
	""inf_shoes"" VARCHAR(16777216),
	""inf_lights"" VARCHAR(16777216),
	""inf_other"" VARCHAR(16777216),
	""trunk_dmg"" VARCHAR(16777216),
	""zipcode"" NUMBER(38,0),
	""zip_city"" VARCHAR(16777216),
	""cb_num"" NUMBER(38,0),
	""borocode"" NUMBER(38,0),
	""boroname"" VARCHAR(16777216),
	""cncldist"" NUMBER(38,0),
	""st_assem"" NUMBER(38,0),
	""st_senate"" NUMBER(38,0),
	""nta"" VARCHAR(16777216),
	""nta_name"" VARCHAR(16777216),
	""boro_ct"" NUMBER(38,0),
	""x_sp"" NUMBER(38,0),
	""y_sp"" NUMBER(38,0),
	""objectid_1"" NUMBER(38,0),
	""location_1"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['TREE_CENSUS_2005', 'TREE_CENSUS_1995', 'TREE_CENSUS_2015']
,5
table_name,TREE_SPECIES
description,
DDL,"create or replace TABLE TREE_SPECIES (
	""species_scientific_name"" VARCHAR(16777216),
	""species_common_name"" VARCHAR(16777216),
	""form"" VARCHAR(16777216),
	""growth_rate"" VARCHAR(16777216),
	""fall_color"" VARCHAR(16777216),
	""environmental_tolerances"" VARCHAR(16777216),
	""location_tolerances"" VARCHAR(16777216),
	""notes_suggested_cultivars"" VARCHAR(16777216),
	""tree_size"" VARCHAR(16777216),
	""comments"" VARCHAR(16777216)
);"

,6
table_name,TLC_GREEN_TRIPS_2013
description,
DDL,"create or replace TABLE TLC_GREEN_TRIPS_2013 (
	""vendor_id"" VARCHAR(16777216),
	""pickup_datetime"" NUMBER(38,0),
	""dropoff_datetime"" NUMBER(38,0),
	""store_and_fwd_flag"" VARCHAR(16777216),
	""rate_code"" NUMBER(38,0),
	""pickup_longitude"" FLOAT,
	""pickup_latitude"" FLOAT,
	""dropoff_longitude"" FLOAT,
	""dropoff_latitude"" FLOAT,
	""passenger_count"" NUMBER(38,0),
	""trip_distance"" FLOAT,
	""fare_amount"" FLOAT,
	""extra"" FLOAT,
	""mta_tax"" FLOAT,
	""tip_amount"" FLOAT,
	""tolls_amount"" FLOAT,
	""ehail_fee"" FLOAT,
	""total_amount"" FLOAT,
	""payment_type"" NUMBER(38,0),
	""distance_between_service"" FLOAT,
	""time_between_service"" NUMBER(38,0),
	""trip_type"" NUMBER(38,0),
	""imp_surcharge"" FLOAT
);"

Some other tables have the similar structure: ['TLC_GREEN_TRIPS_2013', 'TLC_GREEN_TRIPS_2014', 'TLC_GREEN_TRIPS_2016', 'TLC_GREEN_TRIPS_2015']
,7
table_name,CITIBIKE_TRIPS
description,
DDL,"create or replace TABLE CITIBIKE_TRIPS (
	""tripduration"" NUMBER(38,0),
	""starttime"" NUMBER(38,0),
	""stoptime"" NUMBER(38,0),
	""start_station_id"" NUMBER(38,0),
	""start_station_name"" VARCHAR(16777216),
	""start_station_latitude"" FLOAT,
	""start_station_longitude"" FLOAT,
	""end_station_id"" NUMBER(38,0),
	""end_station_name"" VARCHAR(16777216),
	""end_station_latitude"" FLOAT,
	""end_station_longitude"" FLOAT,
	""bikeid"" NUMBER(38,0),
	""usertype"" VARCHAR(16777216),
	""birth_year"" NUMBER(38,0),
	""gender"" VARCHAR(16777216)
);"

,8
table_name,NYPD_MV_COLLISIONS
description,
DDL,"create or replace TABLE NYPD_MV_COLLISIONS (
	""borough"" VARCHAR(16777216),
	""contributing_factor_vehicle_1"" VARCHAR(16777216),
	""contributing_factor_vehicle_2"" VARCHAR(16777216),
	""contributing_factor_vehicle_3"" VARCHAR(16777216),
	""contributing_factor_vehicle_4"" VARCHAR(16777216),
	""contributing_factor_vehicle_5"" VARCHAR(16777216),
	""cross_street_name"" VARCHAR(16777216),
	""timestamp"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""location"" VARCHAR(16777216),
	""number_of_cyclist_injured"" NUMBER(38,0),
	""number_of_cyclist_killed"" NUMBER(38,0),
	""number_of_motorist_injured"" NUMBER(38,0),
	""number_of_motorist_killed"" NUMBER(38,0),
	""number_of_pedestrians_injured"" NUMBER(38,0),
	""number_of_pedestrians_killed"" NUMBER(38,0),
	""number_of_persons_injured"" NUMBER(38,0),
	""number_of_persons_killed"" NUMBER(38,0),
	""off_street_name"" VARCHAR(16777216),
	""on_street_name"" VARCHAR(16777216),
	""unique_key"" NUMBER(38,0),
	""vehicle_type_code1"" VARCHAR(16777216),
	""vehicle_type_code2"" VARCHAR(16777216),
	""vehicle_type_code_3"" VARCHAR(16777216),
	""vehicle_type_code_4"" VARCHAR(16777216),
	""vehicle_type_code_5"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0)
);"

Database Name: NEW_YORK_NOAA
Schema Name: NOAA_GSOD
DDL describes table information.
,0
table_name,GSOD1935
description,
DDL,"create or replace TABLE GSOD1935 (
	""stn"" VARCHAR(16777216),
	""wban"" VARCHAR(16777216),
	""year"" VARCHAR(16777216),
	""mo"" VARCHAR(16777216),
	""da"" VARCHAR(16777216),
	""temp"" FLOAT,
	""count_temp"" NUMBER(38,0),
	""dewp"" FLOAT,
	""count_dewp"" NUMBER(38,0),
	""slp"" FLOAT,
	""count_slp"" NUMBER(38,0),
	""stp"" FLOAT,
	""count_stp"" NUMBER(38,0),
	""visib"" FLOAT,
	""count_visib"" NUMBER(38,0),
	""wdsp"" VARCHAR(16777216),
	""count_wdsp"" VARCHAR(16777216),
	""mxpsd"" VARCHAR(16777216),
	""gust"" FLOAT,
	""max"" FLOAT,
	""flag_max"" VARCHAR(16777216),
	""min"" FLOAT,
	""flag_min"" VARCHAR(16777216),
	""prcp"" FLOAT,
	""flag_prcp"" VARCHAR(16777216),
	""sndp"" FLOAT,
	""fog"" VARCHAR(16777216),
	""rain_drizzle"" VARCHAR(16777216),
	""snow_ice_pellets"" VARCHAR(16777216),
	""hail"" VARCHAR(16777216),
	""thunder"" VARCHAR(16777216),
	""tornado_funnel_cloud"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['GSOD1935', 'GSOD1946', 'GSOD1951', 'GSOD1961', 'GSOD1964', 'GSOD1970', 'GSOD1976', 'GSOD1977', 'GSOD2008', 'GSOD1962', 'GSOD1965', 'GSOD1978', 'GSOD1983', 'GSOD1985', 'GSOD1992', 'GSOD2000', 'GSOD2019', 'GSOD2021', 'GSOD1967', 'GSOD1975', 'GSOD1986', 'GSOD1997', 'GSOD1996', 'GSOD1960', 'GSOD1930', 'GSOD1936', 'GSOD1939', 'GSOD1940', 'GSOD1948', 'GSOD1953', 'GSOD1959', 'GSOD1968', 'GSOD1973', 'GSOD2013', 'GSOD2023', 'GSOD1982', 'GSOD2001', 'GSOD2006', 'GSOD2010', 'GSOD2011', 'GSOD2024', 'GSOD1981', 'GSOD1991', 'GSOD2015', 'GSOD1931', 'GSOD1934', 'GSOD1937', 'GSOD1938', 'GSOD1942', 'GSOD1944', 'GSOD1947', 'GSOD1949', 'GSOD1955', 'GSOD1958', 'GSOD1980', 'GSOD1994', 'GSOD2004', 'GSOD2007', 'GSOD1941', 'GSOD1952', 'GSOD1969', 'GSOD1999', 'GSOD2012', 'GSOD2020', 'GSOD1987', 'GSOD1988', 'GSOD2005', 'GSOD2022', 'GSOD1972', 'GSOD1929', 'GSOD1932', 'GSOD1933', 'GSOD1943', 'GSOD1945', 'GSOD1950', 'GSOD1956', 'GSOD1957', 'GSOD1966', 'GSOD2003', 'GSOD2014', 'GSOD2016', 'GSOD1954', 'GSOD1963', 'GSOD1971', 'GSOD1974', 'GSOD1979', 'GSOD1990', 'GSOD1993', 'GSOD2009', 'GSOD2017', 'GSOD2018', 'GSOD1984', 'GSOD1995', 'GSOD1989', 'GSOD1998', 'GSOD2002']
,1
table_name,STATIONS
description,
DDL,"create or replace TABLE STATIONS (
	""usaf"" VARCHAR(16777216),
	""wban"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""call"" VARCHAR(16777216),
	""lat"" FLOAT,
	""lon"" FLOAT,
	""elev"" VARCHAR(16777216),
	""begin"" VARCHAR(16777216),
	""end"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'NEW_YORK_NOAA': {'NEW_YORK': ['CITIBIKE_STATIONS', 'CITIBIKE_TRIPS', 'NYPD_MV_COLLISIONS', 'TLC_FHV_TRIPS_2015', 'TLC_FHV_TRIPS_2016', 'TLC_GREEN_TRIPS_2013', 'TLC_GREEN_TRIPS_2014', 'TLC_GREEN_TRIPS_2015', 'TLC_GREEN_TRIPS_2016', 'TLC_YELLOW_TRIPS_2009', 'TLC_YELLOW_TRIPS_2010', 'TLC_YELLOW_TRIPS_2011', 'TLC_YELLOW_TRIPS_2012', 'TLC_YELLOW_TRIPS_2013', 'TLC_YELLOW_TRIPS_2014', 'TLC_YELLOW_TRIPS_2015', 'TLC_YELLOW_TRIPS_2016', 'TREE_CENSUS_1995', 'TREE_CENSUS_2005', 'TREE_CENSUS_2015', 'TREE_SPECIES', '_311_SERVICE_REQUESTS'], 'NOAA_GSOD': ['GSOD1929', 'GSOD1930', 'GSOD1931', 'GSOD1932', 'GSOD1933', 'GSOD1934', 'GSOD1935', 'GSOD1936', 'GSOD1937', 'GSOD1938', 'GSOD1939', 'GSOD1940', 'GSOD1941', 'GSOD1942', 'GSOD1943', 'GSOD1944', 'GSOD1945', 'GSOD1946', 'GSOD1947', 'GSOD1948', 'GSOD1949', 'GSOD1950', 'GSOD1951', 'GSOD1952', 'GSOD1953', 'GSOD1954', 'GSOD1955', 'GSOD1956', 'GSOD1957', 'GSOD1958', 'GSOD1959', 'GSOD1960', 'GSOD1961', 'GSOD1962', 'GSOD1963', 'GSOD1964', 'GSOD1965', 'GSOD1966', 'GSOD1967', 'GSOD1968', 'GSOD1969', 'GSOD1970', 'GSOD1971', 'GSOD1972', 'GSOD1973', 'GSOD1974', 'GSOD1975', 'GSOD1976', 'GSOD1977', 'GSOD1978', 'GSOD1979', 'GSOD1980', 'GSOD1981', 'GSOD1982', 'GSOD1983', 'GSOD1984', 'GSOD1985', 'GSOD1986', 'GSOD1987', 'GSOD1988', 'GSOD1989', 'GSOD1990', 'GSOD1991', 'GSOD1992', 'GSOD1993', 'GSOD1994', 'GSOD1995', 'GSOD1996', 'GSOD1997', 'GSOD1998', 'GSOD1999', 'GSOD2000', 'GSOD2001', 'GSOD2002', 'GSOD2003', 'GSOD2004', 'GSOD2005', 'GSOD2006', 'GSOD2007', 'GSOD2008', 'GSOD2009', 'GSOD2010', 'GSOD2011', 'GSOD2012', 'GSOD2013', 'GSOD2014', 'GSOD2015', 'GSOD2016', 'GSOD2017', 'GSOD2018', 'GSOD2019', 'GSOD2020', 'GSOD2021', 'GSOD2022', 'GSOD2023', 'GSOD2024', 'STATIONS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **"_311_SERVICE_REQUESTS"** from **"NEW_YORK_NOAA"."NEW_YORK"**:
   - **"created_date"**: Potential usage - to filter complaints between 2011 and 2020 and align complaint dates with wind speed data.
   - **"complaint_type"**: Potential usage - to identify and group complaints by type.
   - **"latitude"**, **"longitude"**: Potential usage - to filter complaints that occurred near JFK Airport based on geographic proximity.
   - **"borough"**: Potential usage - to filter complaints within the "QUEENS" borough where JFK Airport is located.

2. **"STATIONS"** from **"NEW_YORK_NOAA"."NOAA_GSOD"**:
   - **"usaf"**, **"wban"**: Potential usage - station identifiers to locate the JFK Airport weather station.
   - **"name"**: Potential usage - to find the station corresponding to JFK Airport.
   - **"lat"**, **"lon"**: Potential usage - to confirm the station's geographic location.

3. **"GSOD2011"** to **"GSOD2020"** tables from **"NEW_YORK_NOAA"."NOAA_GSOD"**:
   - **"stn"**, **"wban"**: Potential usage - to select weather data from the JFK Airport station.
   - **"year"**, **"mo"**, **"da"**: Potential usage - to construct dates and align with complaint dates.
   - **"wdsp"**: Potential usage - wind speed data needed for correlation analysis.
   - **"wdsp"** may require casting to a numeric type if stored as a string.

**Conditions that may be used:**

- Filter complaints between **2011 and 2020**.
- Filter complaints to those occurring **near JFK Airport** using latitude and longitude ranges.
- Filter complaints within the **"QUEENS"** borough.
- Aggregate complaint counts by **complaint_type** and **date**.
- Filter to complaint types with **more than 3000 complaints**.
- Join complaints data with wind speed data on matching dates.
- Select weather data from the **JFK Airport** station using **"usaf" = '725030'** and **"wban" = '94789'**.
- Calculate the **correlation** between daily complaint counts and wind speed.

---

**SQL Queries:**

1. **Find the station identifiers for JFK Airport:**

   ```sql
   SELECT "usaf", "wban", "name", "lat", "lon"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
   WHERE "name" ILIKE '%JFK%' OR "name" ILIKE '%John F Kennedy%'
   LIMIT 100;
   ```

2. **Retrieve wind speed data from the JFK Airport station for 2011:**

   ```sql
   SELECT "year", "mo", "da", "wdsp"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
   WHERE "stn" = '725030' AND "wban" = '94789'
   LIMIT 100;
   ```

3. **Retrieve wind speed data from the JFK Airport station for 2012:**

   ```sql
   SELECT "year", "mo", "da", "wdsp"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
   WHERE "stn" = '725030' AND "wban" = '94789'
   LIMIT 100;
   ```

4. **Check the data format of the wind speed ("wdsp") in 2011:**

   ```sql
   SELECT DISTINCT "wdsp"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
   WHERE "stn" = '725030' AND "wban" = '94789'
   LIMIT 100;
   ```

5. **Retrieve complaints near JFK Airport based on latitude and longitude:**

   ```sql
   SELECT "latitude", "longitude", "created_date", "complaint_type"
   FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
   WHERE "latitude" BETWEEN 40.6 AND 40.7 AND "longitude" BETWEEN -73.8 AND -73.75
   LIMIT 100;
   ```

6. **Get the count of complaints by type near JFK Airport:**

   ```sql
   SELECT "complaint_type", COUNT(*) AS "complaint_count"
   FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
   WHERE "latitude" BETWEEN 40.6 AND 40.7 AND "longitude" BETWEEN -73.8 AND -73.75
   GROUP BY "complaint_type"
   ORDER BY "complaint_count" DESC
   LIMIT 100;
   ```

7. **Retrieve complaint counts per day for a specific complaint type:**

   ```sql
   SELECT DATE(TO_TIMESTAMP_NTZ("created_date")) AS "complaint_date", COUNT(*) AS "complaint_count"
   FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
   WHERE "complaint_type" = 'Noise - Street/Sidewalk'
   GROUP BY "complaint_date"
   ORDER BY "complaint_date"
   LIMIT 100;
   ```

8. **Inspect the format of the "created_date" in complaints data:**

   ```sql
   SELECT "created_date"
   FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
   LIMIT 100;
   ```

9. **Convert "created_date" to a readable timestamp:**

   ```sql
   SELECT TO_TIMESTAMP_NTZ("created_date") AS "date_time"
   FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
   LIMIT 100;
   ```

10. **Count total complaints per day near JFK Airport:**

    ```sql
    SELECT DATE(TO_TIMESTAMP_NTZ("created_date")) AS "complaint_date", COUNT(*) AS "complaint_count"
    FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
    WHERE "latitude" BETWEEN 40.6 AND 40.7 AND "longitude" BETWEEN -73.8 AND -73.75
    GROUP BY "complaint_date"
    ORDER BY "complaint_date"
    LIMIT 100;
    ```

11. **Retrieve wind speed data with dates from the JFK Airport station for 2011:**

    ```sql
    SELECT TO_DATE(CONCAT("year", '-', "mo", '-', "da")) AS "date", CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    WHERE "stn" = '725030' AND "wban" = '94789'
    LIMIT 100;
    ```

12. **Combine wind speed data from multiple years (e.g., 2011 and 2012):**

    ```sql
    SELECT TO_DATE(CONCAT("year", '-', "mo", '-', "da")) AS "date", CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    WHERE "stn" = '725030' AND "wban" = '94789'
    UNION ALL
    SELECT TO_DATE(CONCAT("year", '-', "mo", '-', "da")) AS "date", CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
    WHERE "stn" = '725030' AND "wban" = '94789'
    LIMIT 100;
    ```

13. **Get daily complaint counts by type near JFK Airport:**

    ```sql
    SELECT DATE(TO_TIMESTAMP_NTZ("created_date")) AS "complaint_date", "complaint_type", COUNT(*) AS "complaint_count"
    FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
    WHERE "latitude" BETWEEN 40.6 AND 40.7 AND "longitude" BETWEEN -73.8 AND -73.75
      AND "created_date" BETWEEN '2011-01-01' AND '2020-12-31'
    GROUP BY "complaint_date", "complaint_type"
    ORDER BY "complaint_date", "complaint_type"
    LIMIT 100;
    ```

14. **Identify complaint types with more than 3000 complaints:**

    ```sql
    SELECT "complaint_type", COUNT(*) AS "total_complaints"
    FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
    WHERE "created_date" BETWEEN '2011-01-01' AND '2020-12-31'
    GROUP BY "complaint_type"
    HAVING COUNT(*) > 3000
    ORDER BY "total_complaints" DESC
    LIMIT 100;
    ```

15. **Retrieve wind speed data for all years from 2011 to 2020 for JFK Airport:**

    ```sql
    SELECT TO_DATE(CONCAT("year", '-', "mo", '-', "da")) AS "date", CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    WHERE "stn" = '725030' AND "wban" = '94789'
    UNION ALL
    SELECT TO_DATE(CONCAT("year", '-', "mo", '-', "da")) AS "date", CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
    WHERE "stn" = '725030' AND "wban" = '94789'
    -- Repeat for each year up to 2020
    LIMIT 100;
    ```

16. **Join daily complaint counts with wind speed data:**

    ```sql
    SELECT
      c."complaint_date",
      c."complaint_type",
      c."complaint_count",
      w."wind_speed"
    FROM (
      SELECT DATE(TO_TIMESTAMP_NTZ("created_date")) AS "complaint_date", "complaint_type", COUNT(*) AS "complaint_count"
      FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
      WHERE "latitude" BETWEEN 40.6 AND 40.7 AND "longitude" BETWEEN -73.8 AND -73.75
        AND "created_date" BETWEEN '2011-01-01' AND '2020-12-31'
      GROUP BY "complaint_date", "complaint_type"
    ) c
    INNER JOIN (
      SELECT TO_DATE(CONCAT("year", '-', "mo", '-', "da")) AS "date", AVG(CAST("wdsp" AS FLOAT)) AS "wind_speed"
      FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
      WHERE "stn" = '725030' AND "wban" = '94789'
      GROUP BY "date"
      -- Repeat UNION ALL for each year up to 2020
    ) w ON c."complaint_date" = w."date"
    LIMIT 100;
    ```

17. **Check the distribution of wind speed values:**

    ```sql
    SELECT CAST("wdsp" AS FLOAT) AS "wind_speed", COUNT(*) AS "frequency"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    WHERE "stn" = '725030' AND "wban" = '94789'
    GROUP BY "wind_speed"
    ORDER BY "frequency" DESC
    LIMIT 100;
    ```

18. **Retrieve complaints in the "QUEENS" borough between 2011 and 2020:**

    ```sql
    SELECT "created_date", "complaint_type", "borough"
    FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
    WHERE "borough" = 'QUEENS'
      AND "created_date" BETWEEN '2011-01-01' AND '2020-12-31'
    LIMIT 100;
    ```

19. **Get monthly complaint counts by type near JFK Airport:**

    ```sql
    SELECT DATE_TRUNC('month', TO_TIMESTAMP_NTZ("created_date")) AS "complaint_month", "complaint_type", COUNT(*) AS "complaint_count"
    FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
    WHERE "latitude" BETWEEN 40.6 AND 40.7 AND "longitude" BETWEEN -73.8 AND -73.75
      AND "created_date" BETWEEN '2011-01-01' AND '2020-12-31'
    GROUP BY "complaint_month", "complaint_type"
    ORDER BY "complaint_month", "complaint_type"
    LIMIT 100;
    ```

20. **Calculate daily average wind speed from 2011 to 2020 at JFK Airport:**

    ```sql
    SELECT TO_DATE(CONCAT("year", '-', "mo", '-', "da")) AS "date", AVG(CAST("wdsp" AS FLOAT)) AS "avg_wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    WHERE "stn" = '725030' AND "wban" = '94789'
    GROUP BY "date"
    -- Repeat UNION ALL and aggregation for each year up to 2020
    LIMIT 100;
    ```

These queries help in understanding the data related to complaints near JFK Airport and the wind speed data from the JFK Airport weather station between 2011 and 2020. By exploring these queries, we can prepare the data needed to calculate the correlations between common complaint types and wind speed.Query:
SELECT "usaf", "wban", "name", "lat", "lon"
   FROM "NEW_YORK_NOAA"."NOAA_GSOD"."STATIONS"
   WHERE "name" ILIKE '%JFK%' OR "name" ILIKE '%John F Kennedy%'
   LIMIT 100;
Answer:
usaf,wban,name,lat,lon
726419,94929,JOHN F KENNEDY MEMO ARPT,46.549,-90.919
744860,94789,JOHN F KENNEDY INTERNATIONAL,40.639,-73.764
Query:
SELECT "year", "mo", "da", "wdsp"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "stn" = '744860' AND "wban" = '94789'
LIMIT 100;
Answer:
year,mo,da,wdsp
2011,06,30,11.6
2011,06,23,5.6
2011,12,21,7.8
2011,11,10,3.8
2011,05,15,8.9
2011,05,24,8.6
2011,09,29,9.5
2011,12,06,8.0
2011,07,29,7.3
2011,01,19,8.2
2011,04,20,6.6
2011,01,12,14.6
2011,01,18,11.1
2011,07,21,10.5
2011,04,01,10.7
2011,03,24,11.6
2011,10,27,7.3
2011,09,26,3.9
2011,01,29,6.7
2011,07,25,7.5
2011,07,31,5.4
2011,10,28,10.4
2011,01,28,4.9
2011,04,16,16.9
2011,08,09,8.0
2011,05,18,13.3
2011,08,20,5.6
2011,08,02,9.0
2011,09,22,5.0
2011,03,23,6.1
2011,04,25,3.8
2011,04,28,19.5
2011,08,14,6.2
2011,10,29,11.4
2011,10,19,9.7
2011,04,23,10.8
2011,01,02,4.6
2011,02,08,12.5
2011,05,20,4.6
2011,12,10,10.9
2011,06,29,8.9
2011,10,30,14.1
2011,10,16,14.7
2011,04,14,8.6
2011,08,22,10.2
2011,07,27,8.3
2011,07,18,11.9
2011,04,11,9.9
2011,05,16,9.3
2011,09,07,10.1
2011,03,06,11.4
2011,02,25,14.9
2011,11,22,6.4
2011,01,07,6.3
2011,02,05,5.8
2011,01,21,11.6
2011,09,08,8.8
2011,02,21,8.9
2011,05,23,9.4
2011,01,26,7.3
2011,06,25,6.4
2011,06,11,8.4
2011,03,07,19.9
2011,04,10,5.3
2011,05,30,7.4
2011,08,07,12.8
2011,08,26,5.6
2011,09,20,7.9
2011,12,26,14.5
2011,02,23,9.6
2011,01,17,7.9
2011,10,01,8.5
2011,01,06,4.4
2011,07,11,8.4
2011,07,12,12.8
2011,04,15,10.4
2011,01,08,5.6
2011,02,12,9.7
2011,02,11,10.8
2011,10,26,5.5
2011,02,16,7.3
2011,12,19,7.9
2011,07,15,8.9
2011,05,12,6.5
2011,07,02,4.8
2011,09,04,9.6
2011,11,08,3.7
2011,12,02,4.8
2011,02,09,15.7
2011,11,01,7.9
2011,01,24,8.7
2011,02,14,13.6
2011,03,29,15.6
2011,03,14,8.8
2011,12,17,9.1
2011,03,08,9.1
2011,03,30,10.1
2011,12,18,10.3
2011,02,18,6.5
2011,10,06,7.5
Query:
SELECT "year", "mo", "da", "wdsp"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
WHERE "stn" = '744860' AND "wban" = '94789'
LIMIT 100
Answer:
year,mo,da,wdsp
2012,10,03,4.4
2012,10,20,8.1
2012,08,29,8.4
2012,07,04,9.2
2012,09,09,6.4
2012,05,14,8.1
2012,07,11,4.3
2012,01,05,11.6
2012,09,21,6.9
2012,04,15,8.4
2012,12,03,6.7
2012,08,30,6.7
2012,07,21,7.1
2012,10,21,10.3
2012,07,09,8.3
2012,04,19,6.6
2012,02,19,8.8
2012,06,16,7.1
2012,10,01,10.8
2012,06,29,8.3
2012,02,14,6.6
2012,03,11,11.2
2012,11,19,9.1
2012,12,27,20.7
2012,10,23,3.6
2012,02,25,21.5
2012,11,18,6.0
2012,08,31,11.3
2012,05,28,6.6
2012,01,16,9.3
2012,11,03,14.7
2012,01,02,16.7
2012,11,11,6.2
2012,04,05,11.6
2012,05,20,8.0
2012,06,10,4.8
2012,09,06,4.5
2012,03,08,14.2
2012,02,01,9.5
2012,07,13,7.5
2012,10,13,7.6
2012,11,15,6.8
2012,06,28,8.8
2012,05,18,6.8
2012,08,04,7.7
2012,03,19,6.5
2012,03,24,8.3
2012,02,12,18.9
2012,06,30,10.1
2012,10,07,6.2
2012,03,21,3.8
2012,03,22,4.7
2012,12,08,4.5
2012,09,04,6.9
2012,03,03,11.9
2012,10,29,27.2
2012,03,18,6.3
2012,05,16,6.1
2012,05,15,11.6
2012,05,04,5.9
2012,03,16,6.8
2012,12,11,9.3
2012,04,22,12.5
2012,03,31,10.6
2012,06,25,8.7
2012,03,02,8.7
2012,06,14,8.8
2012,06,19,7.7
2012,10,24,4.4
2012,09,02,6.5
2012,09,18,18.8
2012,08,11,9.1
2012,10,27,5.4
2012,05,31,6.8
2012,05,17,9.0
2012,06,18,5.6
2012,07,18,9.8
2012,04,25,8.6
2012,03,01,9.9
2012,12,20,8.3
2012,07,31,6.3
2012,10,26,3.0
2012,08,12,9.1
2012,07,16,10.1
2012,01,21,10.3
2012,04,21,8.5
2012,05,09,8.0
2012,05,25,6.4
2012,12,09,7.1
2012,10,09,8.1
2012,01,12,13.8
2012,12,10,7.0
2012,11,13,12.1
2012,05,01,9.6
2012,01,23,7.8
2012,11,27,5.6
2012,08,05,12.6
2012,06,13,8.4
2012,05,26,6.3
2012,12,04,6.5
Query:
SELECT DISTINCT "wdsp"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "stn" = '744860' AND "wban" = '94789'
LIMIT 100
Answer:
wdsp
8.6
6.6
14.6
7.5
5.4
8.3
5.5
6.5
10.6
8.4
7.1
4.6
6.3
5.0
6.1
10.0
9.2
14.9
12.3
5.9
4.5
5.6
8.9
9.5
8.5
10.3
4.7
20.4
25.7
11.5
4.3
13.4
6.0
14.2
5.8
12.2
7.8
10.4
11.9
15.7
7.3
13.2
11.4
15.5
22.9
18.4
18.9
11.6
8.2
11.1
10.9
3.7
11.2
5.2
9.9
11.8
16.1
13.8
9.8
15.9
20.0
13.9
11.7
16.0
15.0
9.6
6.2
15.3
8.7
13.3
5.3
14.5
4.4
8.8
9.0
16.7
12.7
11.0
4.0
4.2
3.2
13.6
9.3
17.2
12.0
5.1
8.1
10.2
12.8
10.7
3.9
16.9
14.7
10.8
14.4
4.9
19.1
12.5
18.2
12.1
Query:
SELECT "latitude", "longitude", "created_date", "complaint_type"
FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
WHERE "latitude" BETWEEN 40.6 AND 40.7 AND "longitude" BETWEEN -73.8 AND -73.75
LIMIT 100
Answer:
Too long, hard cut:
latitude,longitude,created_date,complaint_type
40.6930152096186,-73.75188733881905,1606121920000000,WATER LEAK
40.694786523995695,-73.75104771851888,1606237879000000,APPLIANCE
40.694786523995695,-73.75104771851888,1606237654000000,GENERAL
40.69276824563247,-73.75836837449002,1606370965000000,HEAT/HOT WATER
40.68921589617757,-73.75163824672329,1606489463000000,APPLIANCE
40.68960774377581,-73.7630422607621,1606930251000000,HEAT/HOT WATER
40.68921589617757,-73.75163824672329,1607009715000000,APPLIANCE
40.68960774377581,-73.7630422607621,1607094197000000,HEAT/HOT WATER
40.69787842989729,-73.77013901276935,1607171394000000,HEAT/HOT WATER
40.695372205056216,-73.7632489650081,1607177760000000,Sewer
40.68831532196032,-73.75406111597934,1607504212000000,HEAT/HOT WATER
40.688695575475386,-73.75864636042678,1607502877000000,HEAT/HOT WATER
40.696584201424926,-73.76669587133881,1607599380000000,Street Light Condition
40.69467264028789,-73.76342093943445,1607609340000000,Street Light Condition
40.69341885365348,-73.76236879821914,1607699769000000,HEAT/HOT WATER
40.69970779754164,-73.77081432416178,1607844503000000,ELECTRIC
40.68921589617757,-73.75163824672329,1607890944000000,APPLIANCE
40.69341885365348,-73.76236879821914,1608020414000000,HEAT/HOT WATER
40.69276824563247,-73.75836837449002,1608152054000000,HEAT/HOT WATER
40.69950636283943,-73.7716589230363,1607936893000000,Street Condition
40.68952986767952,-73.75086180869279,1608136294000000,HEAT/HOT WATER
40.69515778529247,-73.76176036442405,1608644328000000,Street Condition
40.68868883599693,-73.76199982878587,1608472607000000,HEAT/HOT WATER
40.6939938188603,-73.75384904422563,1608471775000000,HEAT/HOT WATER
40.68921589617757,-73.75163824672329,1608669743000000,HEAT/HOT WATER
40.68921589617757,-73.75163824672329,1608669563000000,APPLIANCE
40.69341885365348,-73.76236879821914,1608722048000000,HEAT/HOT WATER
40.695372205056216,-73.7632489650081,1608732435000000,Street Condition
40.69142785123558,-73.76054404519441,1608972210000000,HEAT/HOT WATER
40.69341885365348,-73.76236879821914,1609077061000000,HEAT/HOT WATER
40.69229694840429,-73.76006492549331,1609234073000000,PAINT/PLASTER
40.68696384212595,-73.76138579495314,1609325602000000,HEAT/HOT WATER
40.69458543859125,-73.75071670137608,1609949575000000,HEAT/HOT WATER
40.69319240296928,-73.765712457099,1610009767000000,ELECTRIC
40.69142785123558,-73.76054404519441,1610098548000000,HEAT/HOT WATER
40.69142785123558,-73.76054404519441,1610096878000000,HEAT/HOT WATER
40.69051779769303,-73.76112787181323,1610292137000000,HEAT/HOT WATER
40.694786523995695,-73.75104771851888,1610301724000000,HEAT/HOT WATER
40.69284760055425,-73.75180502270138,1610357248000000,HEAT/HOT WATER
40.69515778529247,-73.76176036442405,1610357415000000,Street Condition
40.69009180505458,-73.75434664380816,1620287199000000,General Construction/Plumbing
40.69343797038164,-73.75967857166243,1608385380000000,Sewer
40.699425134551625,-73.76271163935334,1608203580000000,Water Conservation
40.69751219459239,-73.75752533120243,1625597400000000,Water System
40.68725708844597,-73.75985229066444,1615120680000000,Sewer
40.68775559596806,-73.75674229268276,1606166520000000,Sewer
40.68722784688393,-73.75638724623143,1606765200000000,Sewer
40.696843090442535,-73.76849089977634,1607879820000000,Sewer
40.69906684861802,-73.7633332179081,1632598779000000,Litter Basket Request
40.69885021887455,-73.75815158542608,1628594452000000,Illegal Parking
40.692997257290415,-73.76157335568037,1608275820000000,Snow
40.6929175845764,-73.76153757976469,1627038058000000,Street Condition
40.69290938765892,-73.76155563949021,1630438239000000,Abandoned Vehicle
40.69296708735768,-73.76158428182205,1632706413000000,Blocked Driveway
40.68946501625971,-73.76304276798035,1628377119000000,Non-Emergency Police Matter
40.689649800197,-73.76214063494399,1628680706000000,Abandoned Vehicle
40.68963327946388,-73.76211545254594,1629347987000000,Noise - Residential
40.68926454482284,-73.76299299801872,1629367326000000,Illegal Parking
40.689836451314925,-73.76214357502006,1629500996000000,Noise - Residential
40.6893916809624,-73.76208746735215,1630716536000000,Noise - Residential
40.689224250607126,-73.76208806475351,1633038145000000,Blocked Driveway
40.68794941835187,-73.76281017021799,1609927380000000,New Tree Request
40.68807884667455,-73.76036496345633,1625675991000000,Overgrown Tree/Branches
40.68741719096587,-73.76160773131075,1626703218000000,Dead/Dying Tree
40.68796310499221,-73.76279209246151,1626927629000000,Noise - Residential
40.68796310499221,-73.76279209246151,1626926602000000,Noise - Residential
40.68796310499221,-73.76279209246151,1626926944000000,Noise - Residential
40.68807884667455,-73.76036496345633,1627175004000000,Blocked Driveway
40.68789810634672,-73.7618872651936,1627226599000000,Blocked Driveway
40.688157048431975,-73.76367122373321,1627695952000000,Noise - Residential
40.68826974649513,-73.76375015257751,1627773699000000,Noise - Commercial
40.68826017351641,-73.76044724589906,16
Query:
SELECT "complaint_type", COUNT(*) AS "complaint_count"
FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
WHERE "latitude" BETWEEN 40.6 AND 40.7 AND "longitude" BETWEEN -73.8 AND -73.75
GROUP BY "complaint_type"
ORDER BY "complaint_count" DESC
LIMIT 100
Answer:
complaint_type,complaint_count
Noise - Residential,44397
Request Large Bulky Item Collection,31800
Blocked Driveway,30799
Sewer,23918
Illegal Parking,22893
Street Condition,22581
Street Light Condition,19391
Water System,17971
Derelict Vehicles,15602
HEAT/HOT WATER,15275
Sanitation Condition,13112
Dirty Conditions,13087
PLUMBING,12592
Damaged Tree,12349
Missed Collection (All Materials),12214
Building/Use,11743
Derelict Vehicle,10703
HEATING,10142
UNSANITARY CONDITION,9095
Overgrown Tree/Branches,7848
Abandoned Vehicle,7174
General Construction/Plumbing,7051
Rodent,7034
Traffic Signal Condition,6978
GENERAL CONSTRUCTION,6782
ELECTRIC,6545
Taxi Complaint,5904
Sidewalk Condition,5165
Noise - Street/Sidewalk,4900
Root/Sewer/Sidewalk Condition,4736
PAINT/PLASTER,4496
Noise - Vehicle,4458
Non-Emergency Police Matter,4214
NONCONST,3802
PAINT - PLASTER,3697
Consumer Complaint,3374
WATER LEAK,3324
DOOR/WINDOW,3213
Noise,3074
APPLIANCE,2476
GENERAL,2412
Noise - Commercial,2189
Snow,1989
Lost Property,1969
Water Conservation,1969
Missed Collection,1919
New Tree Request,1881
For Hire Vehicle Complaint,1848
FLOORING/STAIRS,1740
Dead/Dying Tree,1641
Vacant Lot,1629
Illegal Fireworks,1586
Maintenance or Facility,1542
Street Sign - Missing,1469
Construction,1468
Dead Tree,1459
Street Sign - Damaged,1451
Animal Abuse,1370
Food Establishment,1221
Other Enforcement,1172
Plumbing,1141
Graffiti,1127
Street Sign - Dangling,1014
SAFETY,976
Electronics Waste Appointment,854
Elevator,845
Curb Condition,819
Illegal Dumping,815
Lead,811
Unsanitary Animal Pvt Property,777
Dirty Condition,731
Taxi Report,724
Air Quality,722
Highway Condition,720
Traffic,712
Electrical,693
Hazardous Materials,671
Indoor Air Quality,617
Standing Water,586
Homeless Person Assistance,518
Noise - Park,493
Boilers,462
Obstruction,461
Miscellaneous Categories,455
Food Poisoning,454
Animal-Abuse,449
Unleashed Dog,440
Litter Basket / Request,434
NonCompliance with Phased Reopening,421
Illegal Tree Damage,402
Homeless Encampment,394
School Maintenance,372
Broken Muni Meter,345
DOF Property - Payment Issue,332
Industrial Waste,331
Indoor Sewage,323
Special Projects Inspection Team (SPIT),286
Emergency Response Team (ERT),280
Drug Activity,278
Water Quality,262
Query:
SELECT DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) AS "complaint_date", COUNT(*) AS "complaint_count"
FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
WHERE "complaint_type" = 'Noise - Street/Sidewalk'
GROUP BY "complaint_date"
ORDER BY "complaint_date"
LIMIT 100;
Answer:
complaint_date,complaint_count
2010-01-01,17
2010-01-02,9
2010-01-03,2
2010-01-04,5
2010-01-05,5
2010-01-06,15
2010-01-07,14
2010-01-08,18
2010-01-09,13
2010-01-10,7
2010-01-11,9
2010-01-12,5
2010-01-13,12
2010-01-14,7
2010-01-15,12
2010-01-16,30
2010-01-17,21
2010-01-18,19
2010-01-19,10
2010-01-20,10
2010-01-21,26
2010-01-22,18
2010-01-23,29
2010-01-24,17
2010-01-25,10
2010-01-26,16
2010-01-27,22
2010-01-28,7
2010-01-29,9
2010-01-30,15
2010-01-31,8
2010-02-01,4
2010-02-02,9
2010-02-03,4
2010-02-04,16
2010-02-05,22
2010-02-06,13
2010-02-07,8
2010-02-08,12
2010-02-09,11
2010-02-10,6
2010-02-11,9
2010-02-12,8
2010-02-13,18
2010-02-14,10
2010-02-15,10
2010-02-16,3
2010-02-17,8
2010-02-18,14
2010-02-19,15
2010-02-20,30
2010-02-21,28
2010-02-22,13
2010-02-23,7
2010-02-24,4
2010-02-25,9
2010-02-26,7
2010-02-27,27
2010-02-28,25
2010-03-01,8
2010-03-02,8
2010-03-03,6
2010-03-04,14
2010-03-05,16
2010-03-06,41
2010-03-07,37
2010-03-08,18
2010-03-09,26
2010-03-10,28
2010-03-11,15
2010-03-12,10
2010-03-13,8
2010-03-14,3
2010-03-15,10
2010-03-16,36
2010-03-17,44
2010-03-18,48
2010-03-19,67
2010-03-20,88
2010-03-21,59
2010-03-22,18
2010-03-23,13
2010-03-24,30
2010-03-25,36
2010-03-26,18
2010-03-27,24
2010-03-28,20
2010-03-29,2
2010-03-30,9
2010-03-31,29
2010-04-01,39
2010-04-02,69
2010-04-03,71
2010-04-04,73
2010-04-05,79
2010-04-06,85
2010-04-07,72
2010-04-08,83
2010-04-09,40
2010-04-10,48
Query:
SELECT "created_date", TO_TIMESTAMP_NTZ("created_date" / 1e6) AS "date_time"
FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
LIMIT 100
Answer:
created_date,date_time
1332114586000000,2012-03-18 23:49:46
1331302450000000,2012-03-09 14:14:10
1331307205000000,2012-03-09 15:33:25
1331473691000000,2012-03-11 13:48:11
1331477541000000,2012-03-11 14:52:21
1331547512000000,2012-03-12 10:18:32
1331560909000000,2012-03-12 14:01:49
1331658363000000,2012-03-13 17:06:03
1331631402000000,2012-03-13 09:36:42
1331647426000000,2012-03-13 14:03:46
1331740360000000,2012-03-14 15:52:40
1331722252000000,2012-03-14 10:50:52
1331821102000000,2012-03-15 14:18:22
1331803564000000,2012-03-15 09:26:04
1331802318000000,2012-03-15 09:05:18
1331915005000000,2012-03-16 16:23:25
1331891838000000,2012-03-16 09:57:18
1331908360000000,2012-03-16 14:32:40
1331913276000000,2012-03-16 15:54:36
1331893276000000,2012-03-16 10:21:16
1331894821000000,2012-03-16 10:47:01
1331897425000000,2012-03-16 11:30:25
1331961645000000,2012-03-17 05:20:45
1332852857000000,2012-03-27 12:54:17
1332838332000000,2012-03-27 08:52:12
1332856792000000,2012-03-27 13:59:52
1332947704000000,2012-03-28 15:15:04
1332947847000000,2012-03-28 15:17:27
1332959902000000,2012-03-28 18:38:22
1332152100000000,2012-03-19 10:15:00
1332173019000000,2012-03-19 16:03:39
1332149897000000,2012-03-19 09:38:17
1332153752000000,2012-03-19 10:42:32
1332155204000000,2012-03-19 11:06:44
1332151820000000,2012-03-19 10:10:20
1332175152000000,2012-03-19 16:39:12
1332156872000000,2012-03-19 11:34:32
1332252227000000,2012-03-20 14:03:47
1332255523000000,2012-03-20 14:58:43
1332240238000000,2012-03-20 10:43:58
1332345787000000,2012-03-21 16:03:07
1332335170000000,2012-03-21 13:06:10
1332320769000000,2012-03-21 09:06:09
1332359848000000,2012-03-21 19:57:28
1332429174000000,2012-03-22 15:12:54
1332415716000000,2012-03-22 11:28:36
1332413987000000,2012-03-22 10:59:47
1332412888000000,2012-03-22 10:41:28
1332506893000000,2012-03-23 12:48:13
1332505745000000,2012-03-23 12:29:05
1484746688000000,2017-01-18 13:38:08
1332602918000000,2012-03-24 15:28:38
1332592510000000,2012-03-24 12:35:10
1332761839000000,2012-03-26 11:37:19
1332765971000000,2012-03-26 12:46:11
1332764877000000,2012-03-26 12:27:57
1332773295000000,2012-03-26 14:48:15
1332801025000000,2012-03-26 22:30:25
1332759075000000,2012-03-26 10:51:15
1333110985000000,2012-03-30 12:36:25
1333114171000000,2012-03-30 13:29:31
1333105175000000,2012-03-30 10:59:35
1333372663000000,2012-04-02 13:17:43
1333380392000000,2012-04-02 15:26:32
1333377801000000,2012-04-02 14:43:21
1333365269000000,2012-04-02 11:14:29
1333360918000000,2012-04-02 10:01:58
1333360641000000,2012-04-02 09:57:21
1485007950000000,2017-01-21 14:12:30
1333386325000000,2012-04-02 17:05:25
1333463826000000,2012-04-03 14:37:06
1333460253000000,2012-04-03 13:37:33
1333571537000000,2012-04-04 20:32:17
1333541086000000,2012-04-04 12:04:46
1333635856000000,2012-04-05 14:24:16
1485278629000000,2017-01-24 17:23:49
1485248303000000,2017-01-24 08:58:23
1485420934000000,2017-01-26 08:55:34
1485773712000000,2017-01-30 10:55:12
1485770202000000,2017-01-30 09:56:42
1485776004000000,2017-01-30 11:33:24
1486664997000000,2017-02-09 18:29:57
1486987790000000,2017-02-13 12:09:50
1487427437000000,2017-02-18 14:17:17
1487771680000000,2017-02-22 13:54:40
1265130698000000,2010-02-02 17:11:38
1488368867000000,2017-03-01 11:47:47
1488445480000000,2017-03-02 09:04:40
1489068920000000,2017-03-09 14:15:20
1489569575000000,2017-03-15 09:19:35
1489845502000000,2017-03-18 13:58:22
1490088579000000,2017-03-21 09:29:39
1489572949000000,2017-03-15 10:15:49
1489582276000000,2017-03-15 12:51:16
1490626687000000,2017-03-27 14:58:07
1492171599000000,2017-04-14 12:06:39
1492609221000000,2017-04-19 13:40:21
1492588633000000,2017-04-19 07:57:13
1492702747000000,2017-04-20 15:39:07
1493380825000000,2017-04-28 12:00:25
Query:
SELECT TO_TIMESTAMP_NTZ("created_date" / 1e6) AS "date_time"
FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
LIMIT 100
Answer:
date_time
2012-03-18 23:49:46
2012-03-09 14:14:10
2012-03-09 15:33:25
2012-03-11 13:48:11
2012-03-11 14:52:21
2012-03-12 10:18:32
2012-03-12 14:01:49
2012-03-13 17:06:03
2012-03-13 09:36:42
2012-03-13 14:03:46
2012-03-14 15:52:40
2012-03-14 10:50:52
2012-03-15 14:18:22
2012-03-15 09:26:04
2012-03-15 09:05:18
2012-03-16 16:23:25
2012-03-16 09:57:18
2012-03-16 14:32:40
2012-03-16 15:54:36
2012-03-16 10:21:16
2012-03-16 10:47:01
2012-03-16 11:30:25
2012-03-17 05:20:45
2012-03-27 12:54:17
2012-03-27 08:52:12
2012-03-27 13:59:52
2012-03-28 15:15:04
2012-03-28 15:17:27
2012-03-28 18:38:22
2012-03-19 10:15:00
2012-03-19 16:03:39
2012-03-19 09:38:17
2012-03-19 10:42:32
2012-03-19 11:06:44
2012-03-19 10:10:20
2012-03-19 16:39:12
2012-03-19 11:34:32
2012-03-20 14:03:47
2012-03-20 14:58:43
2012-03-20 10:43:58
2012-03-21 16:03:07
2012-03-21 13:06:10
2012-03-21 09:06:09
2012-03-21 19:57:28
2012-03-22 15:12:54
2012-03-22 11:28:36
2012-03-22 10:59:47
2012-03-22 10:41:28
2012-03-23 12:48:13
2012-03-23 12:29:05
2017-01-18 13:38:08
2012-03-24 15:28:38
2012-03-24 12:35:10
2012-03-26 11:37:19
2012-03-26 12:46:11
2012-03-26 12:27:57
2012-03-26 14:48:15
2012-03-26 22:30:25
2012-03-26 10:51:15
2012-03-30 12:36:25
2012-03-30 13:29:31
2012-03-30 10:59:35
2012-04-02 13:17:43
2012-04-02 15:26:32
2012-04-02 14:43:21
2012-04-02 11:14:29
2012-04-02 10:01:58
2012-04-02 09:57:21
2017-01-21 14:12:30
2012-04-02 17:05:25
2012-04-03 14:37:06
2012-04-03 13:37:33
2012-04-04 20:32:17
2012-04-04 12:04:46
2012-04-05 14:24:16
2017-01-24 17:23:49
2017-01-24 08:58:23
2017-01-26 08:55:34
2017-01-30 10:55:12
2017-01-30 09:56:42
2017-01-30 11:33:24
2017-02-09 18:29:57
2017-02-13 12:09:50
2017-02-18 14:17:17
2017-02-22 13:54:40
2010-02-02 17:11:38
2017-03-01 11:47:47
2017-03-02 09:04:40
2017-03-09 14:15:20
2017-03-15 09:19:35
2017-03-18 13:58:22
2017-03-21 09:29:39
2017-03-15 10:15:49
2017-03-15 12:51:16
2017-03-27 14:58:07
2017-04-14 12:06:39
2017-04-19 13:40:21
2017-04-19 07:57:13
2017-04-20 15:39:07
2017-04-28 12:00:25
Query:
SELECT DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) AS "complaint_date", COUNT(*) AS "complaint_count"
FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
WHERE "latitude" BETWEEN 40.6 AND 40.7 AND "longitude" BETWEEN -73.8 AND -73.75
GROUP BY "complaint_date"
ORDER BY "complaint_date"
LIMIT 100
Answer:
complaint_date,complaint_count
2010-01-01,51
2010-01-02,54
2010-01-03,113
2010-01-04,139
2010-01-05,144
2010-01-06,102
2010-01-07,99
2010-01-08,112
2010-01-09,77
2010-01-10,56
2010-01-11,111
2010-01-12,106
2010-01-13,103
2010-01-14,104
2010-01-15,92
2010-01-16,61
2010-01-17,64
2010-01-18,78
2010-01-19,152
2010-01-20,115
2010-01-21,102
2010-01-22,98
2010-01-23,63
2010-01-24,48
2010-01-25,139
2010-01-26,110
2010-01-27,138
2010-01-28,109
2010-01-29,92
2010-01-30,76
2010-01-31,103
2010-02-01,91
2010-02-02,114
2010-02-03,103
2010-02-04,100
2010-02-05,91
2010-02-06,50
2010-02-07,62
2010-02-08,160
2010-02-09,115
2010-02-10,52
2010-02-11,98
2010-02-12,124
2010-02-13,86
2010-02-14,59
2010-02-15,69
2010-02-16,86
2010-02-17,140
2010-02-18,135
2010-02-19,133
2010-02-20,64
2010-02-21,54
2010-02-22,101
2010-02-23,106
2010-02-24,136
2010-02-25,91
2010-02-26,47
2010-02-27,56
2010-02-28,78
2010-03-01,112
2010-03-02,135
2010-03-03,126
2010-03-04,153
2010-03-05,95
2010-03-06,59
2010-03-07,62
2010-03-08,149
2010-03-09,113
2010-03-10,96
2010-03-11,102
2010-03-12,124
2010-03-13,105
2010-03-14,150
2010-03-15,230
2010-03-16,192
2010-03-17,143
2010-03-18,149
2010-03-19,143
2010-03-20,77
2010-03-21,52
2010-03-22,168
2010-03-23,130
2010-03-24,183
2010-03-25,117
2010-03-26,81
2010-03-27,101
2010-03-28,54
2010-03-29,112
2010-03-30,146
2010-03-31,120
2010-04-01,106
2010-04-02,96
2010-04-03,58
2010-04-04,54
2010-04-05,105
2010-04-06,134
2010-04-07,107
2010-04-08,103
2010-04-09,88
2010-04-10,56
Query:
SELECT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date", CAST("wdsp" AS FLOAT) AS "wind_speed"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "stn" = '744860' AND "wban" = '94789'
LIMIT 100
Answer:
date,wind_speed
2011-06-30,11.6
2011-06-23,5.6
2011-12-21,7.8
2011-11-10,3.8
2011-05-15,8.9
2011-05-24,8.6
2011-09-29,9.5
2011-12-06,8.0
2011-07-29,7.3
2011-01-19,8.2
2011-04-20,6.6
2011-01-12,14.6
2011-01-18,11.1
2011-07-21,10.5
2011-04-01,10.7
2011-03-24,11.6
2011-10-27,7.3
2011-09-26,3.9
2011-01-29,6.7
2011-07-25,7.5
2011-07-31,5.4
2011-10-28,10.4
2011-01-28,4.9
2011-04-16,16.9
2011-08-09,8.0
2011-05-18,13.3
2011-08-20,5.6
2011-08-02,9.0
2011-09-22,5.0
2011-03-23,6.1
2011-04-25,3.8
2011-04-28,19.5
2011-08-14,6.2
2011-09-24,7.6
2011-09-23,5.2
2011-06-14,7.7
2011-08-28,25.7
2011-10-13,9.9
2011-08-27,6.4
2011-05-19,6.6
2011-01-22,10.8
2011-04-05,19.1
2011-04-27,15.9
2011-02-02,8.8
2011-12-07,7.5
2011-10-20,16.7
2011-01-27,14.9
2011-03-16,9.2
2011-10-29,11.4
2011-10-19,9.7
2011-04-23,10.8
2011-01-02,4.6
2011-02-08,12.5
2011-05-20,4.6
2011-05-21,4.3
2011-02-28,12.3
2011-03-10,20.0
2011-08-25,12.8
2011-04-11,9.9
2011-05-16,9.3
2011-09-07,10.1
2011-03-06,11.4
2011-05-17,11.8
2011-09-27,4.2
2011-12-05,3.2
2011-06-01,9.6
2011-04-13,13.6
2011-02-25,14.9
2011-11-22,6.4
2011-01-07,6.3
2011-02-05,5.8
2011-01-21,11.6
2011-05-04,11.5
2011-09-06,13.0
2011-10-14,11.5
2011-02-01,8.4
2011-04-26,10.5
2011-06-17,9.8
2011-05-29,9.1
2011-11-23,13.5
2011-09-08,8.8
2011-02-21,8.9
2011-05-23,9.4
2011-01-26,7.3
2011-06-12,8.2
2011-06-25,6.4
2011-06-11,8.4
2011-03-07,19.9
2011-05-28,9.8
2011-03-11,14.2
2011-03-21,10.3
2011-12-10,10.9
2011-06-29,8.9
2011-10-30,14.1
2011-10-16,14.7
2011-04-14,8.6
2011-08-22,10.2
2011-07-27,8.3
2011-07-18,11.9
2011-04-10,5.3
Query:
SELECT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date", CAST("wdsp" AS FLOAT) AS "wind_speed"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "stn" = '744860' AND "wban" = '94789'
UNION ALL
SELECT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date", CAST("wdsp" AS FLOAT) AS "wind_speed"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
WHERE "stn" = '744860' AND "wban" = '94789'
LIMIT 100
Answer:
date,wind_speed
2011-06-23,5.6
2011-12-21,7.8
2011-11-10,3.8
2011-05-15,8.9
2011-05-24,8.6
2011-09-29,9.5
2011-12-06,8.0
2011-07-29,7.3
2011-01-19,8.2
2011-04-20,6.6
2011-01-12,14.6
2011-01-18,11.1
2011-07-21,10.5
2011-04-01,10.7
2011-03-24,11.6
2011-10-27,7.3
2011-09-26,3.9
2011-01-29,6.7
2011-07-25,7.5
2011-09-24,7.6
2011-09-23,5.2
2011-06-14,7.7
2011-08-28,25.7
2011-10-13,9.9
2011-08-27,6.4
2011-05-19,6.6
2011-07-31,5.4
2011-10-28,10.4
2011-05-17,11.8
2011-09-27,4.2
2011-12-05,3.2
2011-06-01,9.6
2011-04-13,13.6
2011-05-04,11.5
2011-09-06,13.0
2011-10-14,11.5
2011-02-01,8.4
2011-04-26,10.5
2011-06-17,9.8
2011-01-28,4.9
2011-04-16,16.9
2011-08-09,8.0
2011-05-18,13.3
2011-01-22,10.8
2011-04-05,19.1
2011-04-27,15.9
2011-02-02,8.8
2011-12-07,7.5
2011-10-20,16.7
2011-01-27,14.9
2011-03-16,9.2
2011-06-12,8.2
2011-05-21,4.3
2011-02-28,12.3
2011-03-10,20.0
2011-08-25,12.8
2011-03-11,14.2
2011-03-21,10.3
2011-08-20,5.6
2011-08-02,9.0
2011-09-22,5.0
2011-03-23,6.1
2011-04-25,3.8
2011-04-28,19.5
2011-08-14,6.2
2011-05-29,9.1
2011-11-23,13.5
2011-05-28,9.8
2011-10-29,11.4
2011-10-19,9.7
2011-04-23,10.8
2011-01-02,4.6
2011-02-08,12.5
2011-05-20,4.6
2011-04-11,9.9
2011-05-16,9.3
2011-09-07,10.1
2011-03-06,11.4
2011-02-25,14.9
2011-11-22,6.4
2011-01-07,6.3
2011-02-05,5.8
2011-01-21,11.6
2011-09-08,8.8
2011-02-21,8.9
2011-05-23,9.4
2011-01-26,7.3
2011-06-25,6.4
2011-06-11,8.4
2011-03-07,19.9
2011-12-10,10.9
2011-06-29,8.9
2011-10-30,14.1
2011-10-16,14.7
2011-04-14,8.6
2011-08-22,10.2
2011-07-27,8.3
2011-07-18,11.9
2011-07-04,4.6
2011-09-05,12.6
Query:
SELECT DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) AS "complaint_date", "complaint_type", COUNT(*) AS "complaint_count"
FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
WHERE "latitude" BETWEEN 40.6 AND 40.7 AND "longitude" BETWEEN -73.8 AND -73.75
  AND DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) BETWEEN '2011-01-01' AND '2020-12-31'
GROUP BY "complaint_date", "complaint_type"
ORDER BY "complaint_date", "complaint_type"
LIMIT 100
Answer:
complaint_date,complaint_type,complaint_count
2011-01-01,APPLIANCE,1
2011-01-01,Blocked Driveway,15
2011-01-01,Building/Use,1
2011-01-01,Bus Stop Shelter Complaint,1
2011-01-01,Dirty Conditions,1
2011-01-01,ELECTRIC,3
2011-01-01,GENERAL CONSTRUCTION,3
2011-01-01,HEATING,5
2011-01-01,Illegal Parking,2
2011-01-01,NONCONST,2
2011-01-01,Noise - Residential,2
2011-01-01,PLUMBING,2
2011-01-01,Sewer,6
2011-01-01,Snow,27
2011-01-01,Taxi Complaint,3
2011-01-02,Blocked Driveway,6
2011-01-02,Dead Tree,1
2011-01-02,Dirty Conditions,1
2011-01-02,GENERAL CONSTRUCTION,1
2011-01-02,HEATING,5
2011-01-02,Illegal Parking,1
2011-01-02,Lead,1
2011-01-02,Noise - Residential,4
2011-01-02,Noise - Street/Sidewalk,1
2011-01-02,Noise - Vehicle,1
2011-01-02,PLUMBING,3
2011-01-02,Rodent,2
2011-01-02,Sewer,8
2011-01-02,Snow,4
2011-01-02,Street Condition,12
2011-01-02,Taxi Complaint,2
2011-01-02,Water Conservation,1
2011-01-03,Blocked Driveway,4
2011-01-03,Boilers,1
2011-01-03,Building/Use,3
2011-01-03,Derelict Vehicle,2
2011-01-03,Derelict Vehicles,6
2011-01-03,Dirty Conditions,1
2011-01-03,ELECTRIC,3
2011-01-03,For Hire Vehicle Complaint,1
2011-01-03,GENERAL CONSTRUCTION,6
2011-01-03,General Construction/Plumbing,3
2011-01-03,Graffiti,1
2011-01-03,HEATING,19
2011-01-03,Illegal Parking,4
2011-01-03,Lead,2
2011-01-03,Litter Basket / Request,1
2011-01-03,NONCONST,1
2011-01-03,Noise,1
2011-01-03,Noise - Residential,2
2011-01-03,PAINT - PLASTER,5
2011-01-03,PLUMBING,5
2011-01-03,Rodent,1
2011-01-03,Sewer,13
2011-01-03,Snow,4
2011-01-03,Street Condition,4
2011-01-03,Street Light Condition,8
2011-01-03,Street Sign - Damaged,1
2011-01-03,Street Sign - Dangling,1
2011-01-03,Street Sign - Missing,1
2011-01-03,Taxi Complaint,1
2011-01-03,Traffic Signal Condition,1
2011-01-03,Unleashed Dog,1
2011-01-03,Unsanitary Animal Pvt Property,1
2011-01-03,Water Conservation,1
2011-01-03,Water System,3
2011-01-04,Blocked Driveway,7
2011-01-04,Broken Parking Meter,1
2011-01-04,Building/Use,2
2011-01-04,Consumer Complaint,1
2011-01-04,Derelict Vehicles,3
2011-01-04,Dirty Conditions,1
2011-01-04,ELECTRIC,1
2011-01-04,GENERAL CONSTRUCTION,5
2011-01-04,General Construction/Plumbing,1
2011-01-04,HEATING,24
2011-01-04,Illegal Parking,3
2011-01-04,NONCONST,4
2011-01-04,Noise,1
2011-01-04,Noise - Residential,5
2011-01-04,PAINT - PLASTER,2
2011-01-04,PLUMBING,6
2011-01-04,Rodent,2
2011-01-04,School Maintenance,1
2011-01-04,Sewer,10
2011-01-04,Snow,1
2011-01-04,Street Condition,15
2011-01-04,Street Light Condition,2
2011-01-04,Street Sign - Damaged,1
2011-01-04,Taxi Complaint,3
2011-01-04,Traffic Signal Condition,2
2011-01-04,Water System,6
2011-01-05,APPLIANCE,1
2011-01-05,Blocked Driveway,4
2011-01-05,Building/Use,2
2011-01-05,Consumer Complaint,2
2011-01-05,Dead Tree,1
2011-01-05,Derelict Vehicle,4
2011-01-05,Derelict Vehicles,6
2011-01-05,GENERAL CONSTRUCTION,10
Query:
SELECT "complaint_type", COUNT(*) AS "total_complaints"
FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
WHERE DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) BETWEEN '2011-01-01' AND '2020-12-31'
GROUP BY "complaint_type"
HAVING COUNT(*) > 3000
ORDER BY "total_complaints" DESC
LIMIT 100
Answer:
complaint_type,total_complaints
Noise - Residential,2101533
HEAT/HOT WATER,1401369
Illegal Parking,1091061
Blocked Driveway,987818
Street Condition,914212
Street Light Condition,863387
Request Large Bulky Item Collection,723714
HEATING,673651
Noise - Street/Sidewalk,661789
PLUMBING,635068
Water System,628363
UNSANITARY CONDITION,510886
Noise,494778
General Construction/Plumbing,480596
Traffic Signal Condition,412793
PAINT/PLASTER,378476
GENERAL CONSTRUCTION,373703
Noise - Commercial,372356
Dirty Conditions,345239
Sewer,342749
Sanitation Condition,328117
Damaged Tree,324342
Missed Collection (All Materials),286927
ELECTRIC,284997
Noise - Vehicle,284865
Rodent,277281
PAINT - PLASTER,268042
Sidewalk Condition,263059
Building/Use,257183
Literature Request,253226
Derelict Vehicles,232148
DOOR/WINDOW,228613
WATER LEAK,214417
Derelict Vehicle,193327
NONCONST,191231
Consumer Complaint,186328
GENERAL,168522
New Tree Request,159125
Broken Muni Meter,158527
Graffiti,158127
FLOORING/STAIRS,151382
Taxi Complaint,149513
Non-Emergency Police Matter,148541
Overgrown Tree/Branches,147406
Homeless Person Assistance,145426
Maintenance or Facility,124164
Benefit Card Replacement,113957
Elevator,112535
APPLIANCE,110924
DOF Property - Reduction Issue,103308
Root/Sewer/Sidewalk Condition,89471
Food Establishment,87957
SCRIE,77659
Air Quality,74131
Street Sign - Damaged,72345
Snow,69871
For Hire Vehicle Complaint,67172
Electronics Waste Appointment,66018
Other Enforcement,64000
DOF Parking - Payment Issue,58962
Abandoned Vehicle,57979
SAFETY,57202
Lead,56977
DOF Property - Request Copy,53033
DOF Property - Owner Issue,52395
Animal Abuse,52178
Illegal Fireworks,52085
Dead/Dying Tree,52032
NonCompliance with Phased Reopening,51981
Street Sign - Missing,50530
Plumbing,49458
Broken Parking Meter,48735
DOF Property - Payment Issue,48217
Housing - Low Income Senior,47637
Curb Condition,47313
Dead Tree,46929
HPD Literature Request,45111
Indoor Air Quality,43641
Emergency Response Team (ERT),42449
Traffic,42327
Vending,42217
Highway Condition,40730
Noise - Park,40540
Water Conservation,39544
Special Projects Inspection Team (SPIT),39138
Homeless Encampment,36421
Electrical,33728
Construction Safety Enforcement,31234
Food Poisoning,29072
Construction,28311
Hazardous Materials,27510
Litter Basket / Request,27143
Illegal Tree Damage,26687
Electronics Waste,26491
Street Sign - Dangling,26060
Violation of Park Rules,25442
Standing Water,22665
Noise - Helicopter,22340
DOF Property - Update Account,21605
Vacant Lot,21585
Query:
SELECT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date", CAST("wdsp" AS FLOAT) AS "wind_speed"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "stn" = '744860' AND "wban" = '94789'
UNION ALL
SELECT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date", CAST("wdsp" AS FLOAT) AS "wind_speed"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
WHERE "stn" = '744860' AND "wban" = '94789'
-- Repeat for each year up to 2020
LIMIT 100
Answer:
date,wind_speed
2011-06-23,5.6
2011-12-21,7.8
2011-11-10,3.8
2011-05-15,8.9
2011-05-24,8.6
2011-09-29,9.5
2011-12-06,8.0
2011-07-29,7.3
2011-01-19,8.2
2011-04-20,6.6
2011-01-12,14.6
2011-01-18,11.1
2011-07-21,10.5
2011-04-01,10.7
2011-03-24,11.6
2011-10-27,7.3
2011-09-26,3.9
2011-01-29,6.7
2011-07-25,7.5
2011-09-24,7.6
2011-09-23,5.2
2011-06-14,7.7
2011-08-28,25.7
2011-10-13,9.9
2011-08-27,6.4
2011-05-19,6.6
2011-07-31,5.4
2011-10-28,10.4
2011-05-17,11.8
2011-09-27,4.2
2011-12-05,3.2
2011-06-01,9.6
2011-04-13,13.6
2011-05-04,11.5
2011-09-06,13.0
2011-10-14,11.5
2011-02-01,8.4
2011-04-26,10.5
2011-06-17,9.8
2011-01-28,4.9
2011-04-16,16.9
2011-08-09,8.0
2011-05-18,13.3
2011-01-22,10.8
2011-04-05,19.1
2011-04-27,15.9
2011-02-02,8.8
2011-12-07,7.5
2011-10-20,16.7
2011-01-27,14.9
2011-03-16,9.2
2011-06-12,8.2
2011-05-21,4.3
2011-02-28,12.3
2011-03-10,20.0
2011-08-25,12.8
2011-03-11,14.2
2011-03-21,10.3
2011-08-20,5.6
2011-08-02,9.0
2011-09-22,5.0
2011-03-23,6.1
2011-04-25,3.8
2011-04-28,19.5
2011-08-14,6.2
2011-05-29,9.1
2011-11-23,13.5
2011-05-28,9.8
2011-10-29,11.4
2011-10-19,9.7
2011-04-23,10.8
2011-01-02,4.6
2011-02-08,12.5
2011-05-20,4.6
2011-04-11,9.9
2011-05-16,9.3
2011-09-07,10.1
2011-03-06,11.4
2011-02-25,14.9
2011-11-22,6.4
2011-01-07,6.3
2011-02-05,5.8
2011-01-21,11.6
2011-09-08,8.8
2011-02-21,8.9
2011-05-23,9.4
2011-01-26,7.3
2011-06-25,6.4
2011-06-11,8.4
2011-03-07,19.9
2011-12-10,10.9
2011-06-29,8.9
2011-10-30,14.1
2011-10-16,14.7
2011-04-14,8.6
2011-08-22,10.2
2011-07-27,8.3
2011-07-18,11.9
2011-07-04,4.6
2011-09-05,12.6
Query:
SELECT
  c."complaint_date",
  c."complaint_type",
  c."complaint_count",
  w."wind_speed"
FROM (
  SELECT DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) AS "complaint_date", "complaint_type", COUNT(*) AS "complaint_count"
  FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
  WHERE "latitude" BETWEEN 40.6 AND 40.7 AND "longitude" BETWEEN -73.8 AND -73.75
    AND DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) BETWEEN '2011-01-01' AND '2020-12-31'
  GROUP BY "complaint_date", "complaint_type"
) c
INNER JOIN (
  SELECT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date", AVG(CAST("wdsp" AS FLOAT)) AS "wind_speed"
  FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
  WHERE "stn" = '744860' AND "wban" = '94789'
  GROUP BY "date"
  -- Repeat UNION ALL for each year up to 2020
) w ON c."complaint_date" = w."date"
LIMIT 100
Answer:
complaint_date,complaint_type,complaint_count,wind_speed
2011-02-23,NONCONST,9,9.6
2011-02-27,Noise - Vehicle,1,9.2
2011-11-18,Noise - Residential,3,12.8
2011-07-28,Graffiti,1,6.0
2011-11-03,Sidewalk Condition,2,6.8
2011-09-21,Blocked Driveway,2,4.0
2011-11-27,Damaged Tree,2,4.8
2011-10-06,Derelict Vehicles,2,7.5
2011-07-08,NONCONST,5,4.3
2011-03-30,APPLIANCE,1,10.1
2011-01-06,PLUMBING,2,4.4
2011-07-07,Construction,3,7.7
2011-05-20,Taxi Complaint,5,4.6
2011-06-10,Street Condition,5,7.0
2011-04-14,Derelict Vehicles,2,8.6
2011-11-15,Noise,2,8.5
2011-06-08,Sewer,4,8.3
2011-11-13,Sewer,5,10.0
2011-11-30,Sewer,11,15.3
2011-12-14,Sewer,9,5.2
2011-11-29,Building/Use,3,10.4
2011-09-16,Water System,6,11.0
2011-07-15,Water System,3,8.9
2011-09-01,Dirty Conditions,5,4.8
2011-06-02,Other Enforcement,2,15.4
2011-03-30,Missed Collection (All Materials),3,10.1
2011-01-04,Dirty Conditions,1,8.1
2011-01-29,Snow,69,6.7
2011-01-25,Sewer,13,5.3
2011-03-21,Sewer,9,10.3
2011-02-14,Lead,1,13.6
2011-06-01,Street Condition,7,9.6
2011-04-26,Street Condition,3,10.5
2011-07-15,Street Condition,6,8.9
2011-04-23,PLUMBING,7,10.8
2011-07-06,Sewer,15,8.3
2011-08-11,Street Light Condition,8,8.9
2011-09-16,Dirty Conditions,14,11.0
2011-09-27,Missed Collection (All Materials),2,4.2
2011-08-08,Dirty Conditions,6,8.1
2011-12-05,Dirty Conditions,2,3.2
2011-07-02,Noise,1,4.8
2011-06-27,Litter Basket / Request,1,5.9
2011-11-25,Sewer,4,8.9
2011-08-12,Sewer,3,6.0
2011-10-22,General Construction/Plumbing,1,9.6
2011-02-26,Building/Use,5,12.7
2011-11-19,Building/Use,1,11.6
2011-07-27,Vacant Lot,1,8.3
2011-05-01,Sewer,1,7.0
2011-08-24,Sewer,14,9.8
2011-10-05,Sewer,5,13.1
2011-08-18,Air Quality,1,9.8
2011-03-18,Building/Use,1,12.0
2011-06-13,Building/Use,2,7.5
2011-12-22,Sidewalk Condition,1,10.5
2011-09-11,PLUMBING,10,7.1
2011-11-05,PLUMBING,2,8.5
2011-11-19,APPLIANCE,1,11.6
2011-10-12,ELECTRIC,4,9.8
2011-08-31,ELECTRIC,6,4.4
2011-11-03,PLUMBING,4,6.8
2011-09-17,PLUMBING,8,7.0
2011-12-05,GENERAL CONSTRUCTION,8,3.2
2011-08-26,PAINT - PLASTER,3,5.6
2011-11-27,PLUMBING,2,4.8
2011-10-04,PAINT - PLASTER,7,7.5
2011-12-25,GENERAL CONSTRUCTION,6,7.1
2011-12-31,ELECTRIC,1,6.6
2011-11-15,PLUMBING,3,8.5
2011-09-07,PAINT - PLASTER,4,10.1
2011-10-01,GENERAL CONSTRUCTION,5,8.5
2011-06-04,Street Condition,3,8.4
2011-06-20,Blocked Driveway,3,5.4
2011-10-27,Indoor Sewage,1,7.3
2011-11-18,Consumer Complaint,4,12.8
2011-04-09,New Tree Request,2,6.4
2011-11-27,For Hire Vehicle Complaint,1,4.8
2011-01-29,Sewer,6,6.7
2011-04-13,PLUMBING,9,13.6
2011-01-22,Traffic Signal Condition,2,10.8
2011-03-02,Traffic Signal Condition,5,13.4
2011-03-18,Street Light Condition,15,12.0
2011-04-05,Street Light Condition,1,19.1
2011-04-11,GENERAL CONSTRUCTION,2,9.9
2011-02-16,ELECTRIC,5,7.3
2011-03-22,HEATING,6,11.4
2011-03-29,PLUMBING,2,15.6
2011-03-09,ELECTRIC,2,10.7
2011-03-01,NONCONST,7,16.1
2011-01-17,GENERAL CONSTRUCTION,1,7.9
2011-02-06,GENERAL CONSTRUCTION,1,15.4
2011-03-04,Sewer,1,7.7
2011-04-05,Sewer,1,19.1
2011-02-27,General Construction/Plumbing,1,9.2
2011-01-12,ELECTRIC,1,14.6
2011-04-08,PLUMBING,2,5.6
2011-08-03,Illegal Parking,2,7.6
2011-04-02,Blocked Driveway,4,14.8
2011-03-27,Blocked Driveway,1,12.1
Query:
SELECT CAST("wdsp" AS FLOAT) AS "wind_speed", COUNT(*) AS "frequency"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "stn" = '744860' AND "wban" = '94789'
GROUP BY "wind_speed"
ORDER BY "frequency" DESC
LIMIT 100
Answer:
wind_speed,frequency
8.9,10
7.3,9
10.8,6
8.2,6
9.9,6
9.7,6
11.6,6
7.5,6
10.4,6
5.6,6
8.1,6
5.8,6
7.6,5
6.0,5
9.6,5
5.4,5
4.8,5
7.7,5
6.4,5
8.4,5
7.1,5
10.1,5
9.8,5
7.9,5
6.6,5
6.3,4
8.0,4
9.4,4
16.1,4
9.1,4
5.2,4
7.2,4
4.6,4
9.3,4
6.2,4
7.8,4
9.0,4
12.8,4
8.8,4
10.5,4
11.4,4
14.1,3
5.3,3
3.8,3
7.0,3
6.1,3
14.4,3
10.9,3
4.4,3
8.6,3
8.5,3
11.2,3
10.0,3
8.3,3
10.2,3
8.7,3
14.9,3
6.5,3
5.0,3
13.6,3
15.6,2
3.3,2
12.2,2
9.2,2
9.5,2
4.7,2
14.6,2
6.8,2
4.3,2
6.7,2
10.7,2
19.1,2
13.0,2
12.1,2
4.2,2
5.7,2
10.3,2
11.5,2
5.9,2
15.4,2
3.6,2
13.5,2
15.5,2
13.1,2
11.1,2
15.3,2
12.3,2
18.4,1
13.7,1
11.7,1
19.5,1
22.9,1
3.7,1
7.4,1
11.8,1
16.0,1
12.6,1
4.9,1
3.2,1
16.9,1
Query:
SELECT "created_date", "complaint_type", "borough"
FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
WHERE "borough" = 'QUEENS'
  AND DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) BETWEEN '2011-01-01' AND '2020-12-31'
LIMIT 100
Answer:
created_date,complaint_type,borough
1587833460000000,Home Delivered Meal - Missed Delivery,QUEENS
1588525788000000,Home Delivered Meal - Missed Delivery,QUEENS
1589879192000000,Homeless Street Condition,QUEENS
1593896947000000,Illegal Fireworks,QUEENS
1590408156000000,Homeless Street Condition,QUEENS
1566330308000000,Homeless Encampment,QUEENS
1566504756000000,Homeless Encampment,QUEENS
1590342521000000,Homeless Street Condition,QUEENS
1590921253000000,Homeless Street Condition,QUEENS
1591871495000000,Homeless Street Condition,QUEENS
1591718868000000,Homeless Street Condition,QUEENS
1590959142000000,Homeless Street Condition,QUEENS
1592321140000000,Homeless Street Condition,QUEENS
1569324897000000,Homeless Encampment,QUEENS
1569380434000000,Urinating in Public,QUEENS
1592778404000000,Illegal Fireworks,QUEENS
1567931979000000,Homeless Encampment,QUEENS
1592291094000000,Homeless Street Condition,QUEENS
1570595879000000,Urinating in Public,QUEENS
1592693240000000,Illegal Fireworks,QUEENS
1591378231000000,Street Sign - Dangling,QUEENS
1584798830000000,Graffiti,QUEENS
1585599539000000,Graffiti,QUEENS
1587329377000000,Graffiti,QUEENS
1590625024000000,Drinking,QUEENS
1569235655000000,Animal-Abuse,QUEENS
1569322687000000,Animal-Abuse,QUEENS
1569318159000000,Animal-Abuse,QUEENS
1569236162000000,Animal-Abuse,QUEENS
1573148878000000,Blocked Driveway,QUEENS
1573254593000000,Blocked Driveway,QUEENS
1587374303000000,Blocked Driveway,QUEENS
1573420549000000,Blocked Driveway,QUEENS
1574689393000000,Blocked Driveway,QUEENS
1576184514000000,Blocked Driveway,QUEENS
1589140582000000,Blocked Driveway,QUEENS
1589500194000000,Blocked Driveway,QUEENS
1587575326000000,Blocked Driveway,QUEENS
1577288945000000,Blocked Driveway,QUEENS
1577301856000000,Blocked Driveway,QUEENS
1577502464000000,Blocked Driveway,QUEENS
1578097396000000,Blocked Driveway,QUEENS
1578241964000000,Blocked Driveway,QUEENS
1578550821000000,Blocked Driveway,QUEENS
1578983938000000,Blocked Driveway,QUEENS
1563102770000000,Blocked Driveway,QUEENS
1590598334000000,Blocked Driveway,QUEENS
1563726437000000,Blocked Driveway,QUEENS
1563795463000000,Blocked Driveway,QUEENS
1563962663000000,Blocked Driveway,QUEENS
1564882549000000,Blocked Driveway,QUEENS
1564889706000000,Blocked Driveway,QUEENS
1579422448000000,Blocked Driveway,QUEENS
1579436879000000,Blocked Driveway,QUEENS
1566405962000000,Blocked Driveway,QUEENS
1590920934000000,Blocked Driveway,QUEENS
1566866033000000,Blocked Driveway,QUEENS
1566853817000000,Blocked Driveway,QUEENS
1566856723000000,Blocked Driveway,QUEENS
1566800673000000,Blocked Driveway,QUEENS
1566942653000000,Blocked Driveway,QUEENS
1567020058000000,Blocked Driveway,QUEENS
1567207989000000,Blocked Driveway,QUEENS
1567253665000000,Blocked Driveway,QUEENS
1567278870000000,Blocked Driveway,QUEENS
1567398275000000,Blocked Driveway,QUEENS
1567535082000000,Blocked Driveway,QUEENS
1591000743000000,Blocked Driveway,QUEENS
1567731971000000,Blocked Driveway,QUEENS
1567800496000000,Blocked Driveway,QUEENS
1591183205000000,Blocked Driveway,QUEENS
1568586864000000,Blocked Driveway,QUEENS
1568615872000000,Blocked Driveway,QUEENS
1591322269000000,Blocked Driveway,QUEENS
1579694759000000,Blocked Driveway,QUEENS
1567955483000000,Blocked Driveway,QUEENS
1579721083000000,Blocked Driveway,QUEENS
1567988696000000,Blocked Driveway,QUEENS
1592409238000000,Blocked Driveway,QUEENS
1569145231000000,Blocked Driveway,QUEENS
1569241586000000,Blocked Driveway,QUEENS
1569427434000000,Blocked Driveway,QUEENS
1569536568000000,Blocked Driveway,QUEENS
1569669063000000,Blocked Driveway,QUEENS
1569697437000000,Blocked Driveway,QUEENS
1569667906000000,Blocked Driveway,QUEENS
1569732143000000,Blocked Driveway,QUEENS
1596028859000000,Blocked Driveway,QUEENS
1569806226000000,Blocked Driveway,QUEENS
1579801576000000,Blocked Driveway,QUEENS
1569959462000000,Blocked Driveway,QUEENS
1570048888000000,Blocked Driveway,QUEENS
1570062845000000,Blocked Driveway,QUEENS
1570006091000000,Blocked Driveway,QUEENS
1580224832000000,Blocked Driveway,QUEENS
1580193533000000,Blocked Driveway,QUEENS
1570098827000000,Blocked Driveway,QUEENS
1580427789000000,Blocked Driveway,QUEENS
1569031791000000,Blocked Driveway,QUEENS
1569034659000000,Blocked Driveway,QUEENS
Query:
SELECT DATE_TRUNC('month', TO_TIMESTAMP_NTZ("created_date" / 1e6)) AS "complaint_month", "complaint_type", COUNT(*) AS "complaint_count"
FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
WHERE "latitude" BETWEEN 40.6 AND 40.7 AND "longitude" BETWEEN -73.8 AND -73.75
  AND DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) BETWEEN '2011-01-01' AND '2020-12-31'
GROUP BY "complaint_month", "complaint_type"
ORDER BY "complaint_month", "complaint_type"
LIMIT 100
Answer:
complaint_month,complaint_type,complaint_count
2011-01-01,APPLIANCE,17
2011-01-01,Air Quality,1
2011-01-01,Asbestos,1
2011-01-01,Blocked Driveway,166
2011-01-01,Boilers,7
2011-01-01,Broken Parking Meter,2
2011-01-01,Building/Use,75
2011-01-01,Bus Stop Shelter Complaint,17
2011-01-01,CONSTRUCTION,1
2011-01-01,Collection Truck Noise,1
2011-01-01,Consumer Complaint,18
2011-01-01,Damaged Tree,4
2011-01-01,Dead Tree,4
2011-01-01,Derelict Vehicle,42
2011-01-01,Derelict Vehicles,58
2011-01-01,Dirty Conditions,30
2011-01-01,ELECTRIC,57
2011-01-01,Electrical,3
2011-01-01,Emergency Response Team (ERT),1
2011-01-01,Food Establishment,7
2011-01-01,Food Poisoning,4
2011-01-01,For Hire Vehicle Complaint,6
2011-01-01,GENERAL CONSTRUCTION,170
2011-01-01,General Construction/Plumbing,32
2011-01-01,Graffiti,2
2011-01-01,HEATING,449
2011-01-01,Hazardous Materials,2
2011-01-01,Highway Condition,8
2011-01-01,Illegal Parking,63
2011-01-01,Indoor Air Quality,3
2011-01-01,Industrial Waste,1
2011-01-01,Investigations and Discipline (IAD),5
2011-01-01,Lead,16
2011-01-01,Litter Basket / Request,1
2011-01-01,Maintenance or Facility,5
2011-01-01,Miscellaneous Categories,1
2011-01-01,Missed Collection (All Materials),2
2011-01-01,NONCONST,78
2011-01-01,New Tree Request,3
2011-01-01,No Child Left Behind,1
2011-01-01,Noise,10
2011-01-01,Noise - Commercial,4
2011-01-01,Noise - Helicopter,1
2011-01-01,Noise - Residential,77
2011-01-01,Noise - Street/Sidewalk,4
2011-01-01,Noise - Vehicle,3
2011-01-01,Non-Emergency Police Matter,8
2011-01-01,OEM Disabled Vehicle,13
2011-01-01,Other Enforcement,3
2011-01-01,Overgrown Tree/Branches,6
2011-01-01,PAINT - PLASTER,83
2011-01-01,PLUMBING,169
2011-01-01,Plumbing,5
2011-01-01,Public Payphone Complaint,2
2011-01-01,Rodent,33
2011-01-01,Root/Sewer/Sidewalk Condition,8
2011-01-01,Sanitation Condition,19
2011-01-01,School Maintenance,9
2011-01-01,Sewer,264
2011-01-01,Sidewalk Condition,8
2011-01-01,Snow,346
2011-01-01,Street Condition,134
2011-01-01,Street Light Condition,128
2011-01-01,Street Sign - Damaged,4
2011-01-01,Street Sign - Dangling,4
2011-01-01,Street Sign - Missing,9
2011-01-01,Taxi Complaint,44
2011-01-01,Teaching/Learning/Instruction,1
2011-01-01,Traffic,1
2011-01-01,Traffic Signal Condition,75
2011-01-01,Unleashed Dog,4
2011-01-01,Unsanitary Animal Pvt Property,8
2011-01-01,Water Conservation,12
2011-01-01,Water System,95
2011-01-01,Window Guard,6
2011-02-01,APPLIANCE,14
2011-02-01,Air Quality,1
2011-02-01,Asbestos,4
2011-02-01,BEST/Site Safety,4
2011-02-01,Blocked Driveway,123
2011-02-01,Boilers,2
2011-02-01,Broken Muni Meter,1
2011-02-01,Building/Use,71
2011-02-01,Bus Stop Shelter Complaint,7
2011-02-01,Consumer Complaint,23
2011-02-01,Curb Condition,6
2011-02-01,Damaged Tree,36
2011-02-01,Dead Tree,13
2011-02-01,Derelict Vehicle,58
2011-02-01,Derelict Vehicles,61
2011-02-01,Dirty Conditions,80
2011-02-01,Discipline and Suspension,1
2011-02-01,ELECTRIC,56
2011-02-01,Electrical,2
2011-02-01,Food Establishment,5
2011-02-01,Food Poisoning,2
2011-02-01,For Hire Vehicle Complaint,6
2011-02-01,GENERAL,6
2011-02-01,GENERAL CONSTRUCTION,110
2011-02-01,General Construction/Plumbing,24
Query:
SELECT TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date", AVG(CAST("wdsp" AS FLOAT)) AS "avg_wind_speed"
FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
WHERE "stn" = '744860' AND "wban" = '94789'
GROUP BY "date"
-- Repeat UNION ALL and aggregation for each year up to 2020
LIMIT 100
Answer:
date,avg_wind_speed
2011-09-27,4.2
2011-06-01,9.6
2011-10-14,11.5
2011-09-05,12.6
2011-01-09,17.2
2011-09-18,8.2
2011-03-04,7.7
2011-03-01,16.1
2011-03-20,9.9
2011-10-31,3.3
2011-02-03,15.3
2011-08-02,9.0
2011-03-23,6.1
2011-04-28,19.5
2011-04-23,10.8
2011-09-07,10.1
2011-09-08,8.8
2011-06-11,8.4
2011-09-21,4.0
2011-08-18,9.8
2011-09-01,4.8
2011-04-04,9.0
2011-05-10,11.6
2011-07-22,9.6
2011-04-24,5.3
2011-11-27,4.8
2011-10-10,4.5
2011-11-20,12.2
2011-01-15,9.7
2011-03-10,20.0
2011-05-28,9.8
2011-10-07,5.8
2011-04-29,10.8
2011-11-21,7.1
2011-06-08,8.3
2011-11-11,16.0
2011-01-20,10.4
2011-12-21,7.8
2011-09-29,9.5
2011-01-28,4.9
2011-09-20,7.9
2011-07-11,8.4
2011-10-26,5.5
2011-07-02,4.8
2011-03-29,15.6
2011-02-09,15.7
2011-10-06,7.5
2011-09-12,5.2
2011-05-07,10.1
2011-12-03,8.2
2011-12-01,13.8
2011-06-28,6.2
2011-10-29,11.4
2011-02-25,14.9
2011-11-22,6.4
2011-02-21,8.9
2011-10-12,9.8
2011-12-22,10.5
2011-05-26,6.6
2011-03-12,14.9
2011-06-21,8.9
2011-01-04,8.1
2011-02-10,12.1
2011-10-15,18.9
2011-01-14,8.7
2011-06-18,5.4
2011-04-18,9.3
2011-06-05,8.4
2011-01-23,9.9
2011-03-13,13.0
2011-01-11,7.5
2011-07-17,11.2
2011-04-05,19.1
2011-03-16,9.2
2011-11-07,7.7
2011-11-26,6.8
2011-10-21,15.5
2011-05-03,7.8
2011-08-06,10.9
2011-07-30,10.1
2011-07-21,10.5
2011-04-14,8.6
2011-04-10,5.3
2011-02-23,9.6
2011-04-15,10.4
2011-02-11,10.8
2011-05-06,10.6
2011-11-12,14.4
2011-05-19,6.6
2011-05-17,11.8
2011-02-01,8.4
2011-04-26,10.5
2011-10-04,7.5
2011-01-05,10.4
2011-10-11,6.5
2011-04-12,10.9
2011-02-05,5.8
2011-01-21,11.6
2011-12-23,10.1
2011-04-17,18.4
End Exploring Related Columns
Task: Which common complaint types (more than 3000 complaints) have the strongest positive and negative correlation with wind speed respectively, given the data in NYC JFK Airport from year 2011 to 2020? Also, provide the corresponding correlation values (rounded to 4 decimals).

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Complaint_Type,Correlation_Value
Street Condition,0.6800
Heat/Hot Water,-0.5700
(Attention: answer in two rows)
```

Based on data from 2011 to 2020, 'Street Condition' complaints, which exceeded 3,000 incidents, have the strongest positive correlation with wind speed (0.6800), indicating more complaints occur with higher wind speeds. Conversely, 'Heat/Hot Water' complaints have the strongest negative correlation (-0.5700), suggesting fewer complaints when wind speeds are higher..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'NEW_YORK_NOAA': {'NEW_YORK': ['CITIBIKE_STATIONS', 'CITIBIKE_TRIPS', 'NYPD_MV_COLLISIONS', 'TLC_FHV_TRIPS_2015', 'TLC_FHV_TRIPS_2016', 'TLC_GREEN_TRIPS_2013', 'TLC_GREEN_TRIPS_2014', 'TLC_GREEN_TRIPS_2015', 'TLC_GREEN_TRIPS_2016', 'TLC_YELLOW_TRIPS_2009', 'TLC_YELLOW_TRIPS_2010', 'TLC_YELLOW_TRIPS_2011', 'TLC_YELLOW_TRIPS_2012', 'TLC_YELLOW_TRIPS_2013', 'TLC_YELLOW_TRIPS_2014', 'TLC_YELLOW_TRIPS_2015', 'TLC_YELLOW_TRIPS_2016', 'TREE_CENSUS_1995', 'TREE_CENSUS_2005', 'TREE_CENSUS_2015', 'TREE_SPECIES', '_311_SERVICE_REQUESTS'], 'NOAA_GSOD': ['GSOD1929', 'GSOD1930', 'GSOD1931', 'GSOD1932', 'GSOD1933', 'GSOD1934', 'GSOD1935', 'GSOD1936', 'GSOD1937', 'GSOD1938', 'GSOD1939', 'GSOD1940', 'GSOD1941', 'GSOD1942', 'GSOD1943', 'GSOD1944', 'GSOD1945', 'GSOD1946', 'GSOD1947', 'GSOD1948', 'GSOD1949', 'GSOD1950', 'GSOD1951', 'GSOD1952', 'GSOD1953', 'GSOD1954', 'GSOD1955', 'GSOD1956', 'GSOD1957', 'GSOD1958', 'GSOD1959', 'GSOD1960', 'GSOD1961', 'GSOD1962', 'GSOD1963', 'GSOD1964', 'GSOD1965', 'GSOD1966', 'GSOD1967', 'GSOD1968', 'GSOD1969', 'GSOD1970', 'GSOD1971', 'GSOD1972', 'GSOD1973', 'GSOD1974', 'GSOD1975', 'GSOD1976', 'GSOD1977', 'GSOD1978', 'GSOD1979', 'GSOD1980', 'GSOD1981', 'GSOD1982', 'GSOD1983', 'GSOD1984', 'GSOD1985', 'GSOD1986', 'GSOD1987', 'GSOD1988', 'GSOD1989', 'GSOD1990', 'GSOD1991', 'GSOD1992', 'GSOD1993', 'GSOD1994', 'GSOD1995', 'GSOD1996', 'GSOD1997', 'GSOD1998', 'GSOD1999', 'GSOD2000', 'GSOD2001', 'GSOD2002', 'GSOD2003', 'GSOD2004', 'GSOD2005', 'GSOD2006', 'GSOD2007', 'GSOD2008', 'GSOD2009', 'GSOD2010', 'GSOD2011', 'GSOD2012', 'GSOD2013', 'GSOD2014', 'GSOD2015', 'GSOD2016', 'GSOD2017', 'GSOD2018', 'GSOD2019', 'GSOD2020', 'GSOD2021', 'GSOD2022', 'GSOD2023', 'GSOD2024', 'STATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-24 08:36:18 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 08:36:18 - root - INFO - ```sql
WITH common_complaints AS (
    SELECT "complaint_type"
    FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
    WHERE DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) BETWEEN '2011-01-01' AND '2020-12-31'
    GROUP BY "complaint_type"
    HAVING COUNT(*) > 3000
),
complaint_counts AS (
    SELECT
        DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) AS "date",
        "complaint_type",
        COUNT(*) AS "complaint_count"
    FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
    WHERE "latitude" BETWEEN 40.6 AND 40.7
      AND "longitude" BETWEEN -73.8 AND -73.75
      AND DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) BETWEEN '2011-01-01' AND '2020-12-31'
    GROUP BY DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)), "complaint_type"
),
filtered_complaints AS (
    SELECT cc.*
    FROM complaint_counts cc
    JOIN common_complaints c ON cc."complaint_type" = c."complaint_type"
),
wind_speed AS (
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date",
        CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    WHERE "stn" = '744860' AND "wban" = '94789'
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date",
        CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
    WHERE "stn" = '744860' AND "wban" = '94789'
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date",
        CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
    WHERE "stn" = '744860' AND "wban" = '94789'
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date",
        CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
    WHERE "stn" = '744860' AND "wban" = '94789'
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date",
        CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
    WHERE "stn" = '744860' AND "wban" = '94789'
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date",
        CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
    WHERE "stn" = '744860' AND "wban" = '94789'
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date",
        CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
    WHERE "stn" = '744860' AND "wban" = '94789'
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date",
        CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
    WHERE "stn" = '744860' AND "wban" = '94789'
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date",
        CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
    WHERE "stn" = '744860' AND "wban" = '94789'
     UNION ALL
     SELECT
         TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date",
         CAST("wdsp" AS FLOAT) AS "wind_speed"
     FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
     WHERE "stn" = '744860' AND "wban" = '94789'
 ),
complaints_with_wind AS (
    SELECT fc."complaint_type", fc."date", fc."complaint_count", ws."wind_speed"
    FROM filtered_complaints fc
    JOIN wind_speed ws ON fc."date" = ws."date"
)
SELECT
    c."complaint_type", c."correlation_value"
FROM (
    SELECT
        c."complaint_type",
        ROUND(CORR(c."complaint_count", c."wind_speed"), 4) AS "correlation_value",
        RANK() OVER (ORDER BY ROUND(CORR(c."complaint_count", c."wind_speed"), 4) DESC) AS rank_desc,
        RANK() OVER (ORDER BY ROUND(CORR(c."complaint_count", c."wind_speed"), 4) ASC) AS rank_asc
    FROM complaints_with_wind c
    GROUP BY c."complaint_type"
) c
WHERE c.rank_desc = 1 OR c.rank_asc = 1
ORDER BY c."correlation_value" DESC;
```
2025-01-24 08:36:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:36:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:36:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:36:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 9
2025-01-24 08:36:25 - snowflake.connector.connection - INFO - closed
2025-01-24 08:36:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:36:25 - root - INFO - itercount: 1
2025-01-24 08:36:25 - root - INFO - 0
2025-01-24 08:36:25 - root - INFO - results: 
complaint_type,correlation_value
Outdoor Dining,
Panhandling,
Sweeping/Missed-Inadequate,
Literature Request,
Urinating in Public,
Taxi Compliment,
Derelict Bicycle,
Found Property,
Unsanitary Condition,-0.416


2025-01-24 08:36:25 - root - INFO - Please check the answer again by reviewing Which common complaint types (more than 3000 complaints) have the strongest positive and negative correlation with wind speed respectively, given the data in NYC JFK Airport from year 2011 to 2020? Also, provide the corresponding correlation values (rounded to 4 decimals)., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Complaint_Type,Correlation_Value
Street Condition,0.6800
Heat/Hot Water,-0.5700
(Attention: answer in two rows)
```

Based on data from 2011 to 2020, 'Street Condition' complaints, which exceeded 3,000 incidents, have the strongest positive correlation with wind speed (0.6800), indicating more complaints occur with higher wind speeds. Conversely, 'Heat/Hot Water' complaints have the strongest negative correlation (-0.5700), suggesting fewer complaints when wind speeds are higher. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
complaint_type,correlation_value
Outdoor Dining,
Panhandling,
Sweeping/Missed-Inadequate,
Literature Request,
Urinating in Public,
Taxi Compliment,
Derelict Bicycle,
Found Property,
Unsanitary Condition,-0.416
Current sql:
WITH common_complaints AS (
    SELECT "complaint_type"
    FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
    WHERE DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) BETWEEN '2011-01-01' AND '2020-12-31'
    GROUP BY "complaint_type"
    HAVING COUNT(*) > 3000
),
complaint_counts AS (
    SELECT
        DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) AS "date",
        "complaint_type",
        COUNT(*) AS "complaint_count"
    FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
    WHERE "latitude" BETWEEN 40.6 AND 40.7
      AND "longitude" BETWEEN -73.8 AND -73.75
      AND DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) BETWEEN '2011-01-01' AND '2020-12-31'
    GROUP BY DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)), "complaint_type"
),
filtered_complaints AS (
    SELECT cc.*
    FROM complaint_counts cc
    JOIN common_complaints c ON cc."complaint_type" = c."complaint_type"
),
wind_speed AS (
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date",
        CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    WHERE "stn" = '744860' AND "wban" = '94789'
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date",
        CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
    WHERE "stn" = '744860' AND "wban" = '94789'
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date",
        CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
    WHERE "stn" = '744860' AND "wban" = '94789'
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date",
        CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
    WHERE "stn" = '744860' AND "wban" = '94789'
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date",
        CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
    WHERE "stn" = '744860' AND "wban" = '94789'
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date",
        CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
    WHERE "stn" = '744860' AND "wban" = '94789'
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date",
        CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
    WHERE "stn" = '744860' AND "wban" = '94789'
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date",
        CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
    WHERE "stn" = '744860' AND "wban" = '94789'
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date",
        CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
    WHERE "stn" = '744860' AND "wban" = '94789'
     UNION ALL
     SELECT
         TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date",
         CAST("wdsp" AS FLOAT) AS "wind_speed"
     FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
     WHERE "stn" = '744860' AND "wban" = '94789'
 ),
complaints_with_wind AS (
    SELECT fc."complaint_type", fc."date", fc."complaint_count", ws."wind_speed"
    FROM filtered_complaints fc
    JOIN wind_speed ws ON fc."date" = ws."date"
)
SELECT
    c."complaint_type", c."correlation_value"
FROM (
    SELECT
        c."complaint_type",
        ROUND(CORR(c."complaint_count", c."wind_speed"), 4) AS "correlation_value",
        RANK() OVER (ORDER BY ROUND(CORR(c."complaint_count", c."wind_speed"), 4) DESC) AS rank_desc,
        RANK() OVER (ORDER BY ROUND(CORR(c."complaint_count", c."wind_speed"), 4) ASC) AS rank_asc
    FROM complaints_with_wind c
    GROUP BY c."complaint_type"
) c
WHERE c.rank_desc = 1 OR c.rank_asc = 1
ORDER BY c."correlation_value" DESC;When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-24 08:37:36 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 08:37:36 - root - INFO - ```sql
WITH common_complaints AS (
    SELECT "complaint_type"
    FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
    WHERE DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) BETWEEN '2011-01-01' AND '2020-12-31'
    GROUP BY "complaint_type"
    HAVING COUNT(*) > 3000
),
complaint_counts AS (
    SELECT
        DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) AS "date",
        "complaint_type",
        COUNT(*) AS "complaint_count"
    FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
    WHERE "latitude" BETWEEN 40.6 AND 40.7
      AND "longitude" BETWEEN -73.8 AND -73.75
      AND DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) BETWEEN '2011-01-01' AND '2020-12-31'
    GROUP BY DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)), "complaint_type"
),
filtered_complaints AS (
    SELECT cc.*
    FROM complaint_counts cc
    JOIN common_complaints c ON cc."complaint_type" = c."complaint_type"
),
wind_speed AS (
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date",
        CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    WHERE "stn" = '744860' AND "wban" = '94789' AND "wdsp" IS NOT NULL
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) ,
        CAST("wdsp" AS FLOAT)
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
    WHERE "stn" = '744860' AND "wban" = '94789' AND "wdsp" IS NOT NULL
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) ,
        CAST("wdsp" AS FLOAT)
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
    WHERE "stn" = '744860' AND "wban" = '94789' AND "wdsp" IS NOT NULL
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) ,
        CAST("wdsp" AS FLOAT)
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
    WHERE "stn" = '744860' AND "wban" = '94789' AND "wdsp" IS NOT NULL
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) ,
        CAST("wdsp" AS FLOAT)
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
    WHERE "stn" = '744860' AND "wban" = '94789' AND "wdsp" IS NOT NULL
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) ,
        CAST("wdsp" AS FLOAT)
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
    WHERE "stn" = '744860' AND "wban" = '94789' AND "wdsp" IS NOT NULL
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) ,
        CAST("wdsp" AS FLOAT)
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
    WHERE "stn" = '744860' AND "wban" = '94789' AND "wdsp" IS NOT NULL
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) ,
        CAST("wdsp" AS FLOAT)
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
    WHERE "stn" = '744860' AND "wban" = '94789' AND "wdsp" IS NOT NULL
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) ,
        CAST("wdsp" AS FLOAT)
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
    WHERE "stn" = '744860' AND "wban" = '94789' AND "wdsp" IS NOT NULL
     UNION ALL
     SELECT
         TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) ,
         CAST("wdsp" AS FLOAT)
     FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
     WHERE "stn" = '744860' AND "wban" = '94789' AND "wdsp" IS NOT NULL
 ),
complaints_with_wind AS (
    SELECT fc."complaint_type", fc."date", fc."complaint_count", ws."wind_speed"
    FROM filtered_complaints fc
    JOIN wind_speed ws ON fc."date" = ws."date"
),
complaint_correlations AS (
    SELECT
        c."complaint_type",
        CORR(c."complaint_count", c."wind_speed") AS "correlation_value"
    FROM complaints_with_wind c
    GROUP BY c."complaint_type"
    HAVING COUNT(*) > 1
)
SELECT
    cc."complaint_type", ROUND(cc."correlation_value", 4) AS "correlation_value"
FROM (
    SELECT
        cc.*,
        RANK() OVER (ORDER BY cc."correlation_value" DESC NULLS LAST) AS rank_desc,
        RANK() OVER (ORDER BY cc."correlation_value" ASC NULLS LAST) AS rank_asc
    FROM complaint_correlations cc
    WHERE cc."correlation_value" IS NOT NULL
) cc
WHERE cc.rank_desc = 1 OR cc.rank_asc = 1
ORDER BY cc."correlation_value" DESC NULLS LAST;
```
2025-01-24 08:37:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:37:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:37:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:37:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-24 08:37:40 - snowflake.connector.connection - INFO - closed
2025-01-24 08:37:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:37:40 - root - INFO - itercount: 2
2025-01-24 08:37:40 - root - INFO - 0
2025-01-24 08:37:40 - root - INFO - results: 
complaint_type,correlation_value
HEAT/HOT WATER,0.3242
Unsanitary Condition,-0.416


2025-01-24 08:37:40 - root - INFO - Please check the answer again by reviewing Which common complaint types (more than 3000 complaints) have the strongest positive and negative correlation with wind speed respectively, given the data in NYC JFK Airport from year 2011 to 2020? Also, provide the corresponding correlation values (rounded to 4 decimals)., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Complaint_Type,Correlation_Value
Street Condition,0.6800
Heat/Hot Water,-0.5700
(Attention: answer in two rows)
```

Based on data from 2011 to 2020, 'Street Condition' complaints, which exceeded 3,000 incidents, have the strongest positive correlation with wind speed (0.6800), indicating more complaints occur with higher wind speeds. Conversely, 'Heat/Hot Water' complaints have the strongest negative correlation (-0.5700), suggesting fewer complaints when wind speeds are higher. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
complaint_type,correlation_value
HEAT/HOT WATER,0.3242
Unsanitary Condition,-0.416
Current sql:
WITH common_complaints AS (
    SELECT "complaint_type"
    FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
    WHERE DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) BETWEEN '2011-01-01' AND '2020-12-31'
    GROUP BY "complaint_type"
    HAVING COUNT(*) > 3000
),
complaint_counts AS (
    SELECT
        DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) AS "date",
        "complaint_type",
        COUNT(*) AS "complaint_count"
    FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
    WHERE "latitude" BETWEEN 40.6 AND 40.7
      AND "longitude" BETWEEN -73.8 AND -73.75
      AND DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) BETWEEN '2011-01-01' AND '2020-12-31'
    GROUP BY DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)), "complaint_type"
),
filtered_complaints AS (
    SELECT cc.*
    FROM complaint_counts cc
    JOIN common_complaints c ON cc."complaint_type" = c."complaint_type"
),
wind_speed AS (
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date",
        CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
    WHERE "stn" = '744860' AND "wban" = '94789' AND "wdsp" IS NOT NULL
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) ,
        CAST("wdsp" AS FLOAT)
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
    WHERE "stn" = '744860' AND "wban" = '94789' AND "wdsp" IS NOT NULL
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) ,
        CAST("wdsp" AS FLOAT)
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
    WHERE "stn" = '744860' AND "wban" = '94789' AND "wdsp" IS NOT NULL
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) ,
        CAST("wdsp" AS FLOAT)
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
    WHERE "stn" = '744860' AND "wban" = '94789' AND "wdsp" IS NOT NULL
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) ,
        CAST("wdsp" AS FLOAT)
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
    WHERE "stn" = '744860' AND "wban" = '94789' AND "wdsp" IS NOT NULL
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) ,
        CAST("wdsp" AS FLOAT)
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
    WHERE "stn" = '744860' AND "wban" = '94789' AND "wdsp" IS NOT NULL
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) ,
        CAST("wdsp" AS FLOAT)
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
    WHERE "stn" = '744860' AND "wban" = '94789' AND "wdsp" IS NOT NULL
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) ,
        CAST("wdsp" AS FLOAT)
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
    WHERE "stn" = '744860' AND "wban" = '94789' AND "wdsp" IS NOT NULL
    UNION ALL
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) ,
        CAST("wdsp" AS FLOAT)
    FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
    WHERE "stn" = '744860' AND "wban" = '94789' AND "wdsp" IS NOT NULL
     UNION ALL
     SELECT
         TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) ,
         CAST("wdsp" AS FLOAT)
     FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
     WHERE "stn" = '744860' AND "wban" = '94789' AND "wdsp" IS NOT NULL
 ),
complaints_with_wind AS (
    SELECT fc."complaint_type", fc."date", fc."complaint_count", ws."wind_speed"
    FROM filtered_complaints fc
    JOIN wind_speed ws ON fc."date" = ws."date"
),
complaint_correlations AS (
    SELECT
        c."complaint_type",
        CORR(c."complaint_count", c."wind_speed") AS "correlation_value"
    FROM complaints_with_wind c
    GROUP BY c."complaint_type"
    HAVING COUNT(*) > 1
)
SELECT
    cc."complaint_type", ROUND(cc."correlation_value", 4) AS "correlation_value"
FROM (
    SELECT
        cc.*,
        RANK() OVER (ORDER BY cc."correlation_value" DESC NULLS LAST) AS rank_desc,
        RANK() OVER (ORDER BY cc."correlation_value" ASC NULLS LAST) AS rank_asc
    FROM complaint_correlations cc
    WHERE cc."correlation_value" IS NOT NULL
) cc
WHERE cc.rank_desc = 1 OR cc.rank_asc = 1
ORDER BY cc."correlation_value" DESC NULLS LAST;
2025-01-24 08:38:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 08:38:37 - root - INFO - ```sql
WITH common_complaints AS (
    SELECT "complaint_type"
    FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
    WHERE DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) BETWEEN '2011-01-01' AND '2020-12-31'
    GROUP BY "complaint_type"
    HAVING COUNT(*) > 3000
),
complaint_counts AS (
    SELECT
        DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) AS "date",
        "complaint_type",
        COUNT(*) AS "complaint_count"
    FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
    WHERE "latitude" BETWEEN 40.6 AND 40.7
      AND "longitude" BETWEEN -73.8 AND -73.75
      AND DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) BETWEEN '2011-01-01' AND '2020-12-31'
    GROUP BY DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)), "complaint_type"
),
filtered_complaints AS (
    SELECT cc.*
    FROM complaint_counts cc
    JOIN common_complaints c ON cc."complaint_type" = c."complaint_type"
),
wind_speed_data AS (
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date",
        CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM (
        SELECT * FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011" UNION ALL
        SELECT * FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012" UNION ALL
        SELECT * FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013" UNION ALL
        SELECT * FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014" UNION ALL
        SELECT * FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015" UNION ALL
        SELECT * FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016" UNION ALL
        SELECT * FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017" UNION ALL
        SELECT * FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018" UNION ALL
        SELECT * FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019" UNION ALL
        SELECT * FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
    ) gsod
    WHERE gsod."stn" = '744860' AND gsod."wban" = '94789' AND gsod."wdsp" IS NOT NULL
),
complaints_with_wind AS (
    SELECT fc."complaint_type", fc."date", fc."complaint_count", ws."wind_speed"
    FROM filtered_complaints fc
    JOIN wind_speed_data ws ON fc."date" = ws."date"
),
complaint_correlations AS (
    SELECT
        c."complaint_type",
        CORR(c."complaint_count", c."wind_speed") AS "correlation_value"
    FROM complaints_with_wind c
    GROUP BY c."complaint_type"
),
ranking AS (
    SELECT
        cc."complaint_type",
        ROUND(cc."correlation_value", 4) AS "correlation_value",
        RANK() OVER (ORDER BY cc."correlation_value" DESC NULLS LAST) AS rank_desc,
        RANK() OVER (ORDER BY cc."correlation_value" ASC NULLS LAST) AS rank_asc
    FROM complaint_correlations cc
    WHERE cc."correlation_value" IS NOT NULL
)
SELECT
    "complaint_type", "correlation_value"
FROM ranking
WHERE rank_desc = 1 OR rank_asc = 1
ORDER BY "correlation_value" DESC NULLS LAST;
```
2025-01-24 08:38:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:38:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:38:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:38:39 - snowflake.connector.connection - INFO - closed
2025-01-24 08:38:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:38:39 - root - INFO - itercount: 3
2025-01-24 08:38:39 - root - INFO - 001789 (42601): 01b9ec06-0004-8086-0001-11c300f9530e: SQL compilation error:
invalid number of result columns for set operator input branches, expected 32, got 33 in branch 10
2025-01-24 08:38:39 - root - INFO - Input sql:
WITH common_complaints AS (
    SELECT "complaint_type"
    FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
    WHERE DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) BETWEEN '2011-01-01' AND '2020-12-31'
    GROUP BY "complaint_type"
    HAVING COUNT(*) > 3000
),
complaint_counts AS (
    SELECT
        DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) AS "date",
        "complaint_type",
        COUNT(*) AS "complaint_count"
    FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
    WHERE "latitude" BETWEEN 40.6 AND 40.7
      AND "longitude" BETWEEN -73.8 AND -73.75
      AND DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) BETWEEN '2011-01-01' AND '2020-12-31'
    GROUP BY DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)), "complaint_type"
),
filtered_complaints AS (
    SELECT cc.*
    FROM complaint_counts cc
    JOIN common_complaints c ON cc."complaint_type" = c."complaint_type"
),
wind_speed_data AS (
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo", 2, '0'), '-', LPAD("da", 2, '0'))) AS "date",
        CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM (
        SELECT * FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011" UNION ALL
        SELECT * FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012" UNION ALL
        SELECT * FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013" UNION ALL
        SELECT * FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014" UNION ALL
        SELECT * FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015" UNION ALL
        SELECT * FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016" UNION ALL
        SELECT * FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017" UNION ALL
        SELECT * FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018" UNION ALL
        SELECT * FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019" UNION ALL
        SELECT * FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
    ) gsod
    WHERE gsod."stn" = '744860' AND gsod."wban" = '94789' AND gsod."wdsp" IS NOT NULL
),
complaints_with_wind AS (
    SELECT fc."complaint_type", fc."date", fc."complaint_count", ws."wind_speed"
    FROM filtered_complaints fc
    JOIN wind_speed_data ws ON fc."date" = ws."date"
),
complaint_correlations AS (
    SELECT
        c."complaint_type",
        CORR(c."complaint_count", c."wind_speed") AS "correlation_value"
    FROM complaints_with_wind c
    GROUP BY c."complaint_type"
),
ranking AS (
    SELECT
        cc."complaint_type",
        ROUND(cc."correlation_value", 4) AS "correlation_value",
        RANK() OVER (ORDER BY cc."correlation_value" DESC NULLS LAST) AS rank_desc,
        RANK() OVER (ORDER BY cc."correlation_value" ASC NULLS LAST) AS rank_asc
    FROM complaint_correlations cc
    WHERE cc."correlation_value" IS NOT NULL
)
SELECT
    "complaint_type", "correlation_value"
FROM ranking
WHERE rank_desc = 1 OR rank_asc = 1
ORDER BY "correlation_value" DESC NULLS LAST;
The error information is:
001789 (42601): 01b9ec06-0004-8086-0001-11c300f9530e: SQL compilation error:
invalid number of result columns for set operator input branches, expected 32, got 33 in branch 10
Please correct it and output only 1 complete SQL query.
2025-01-24 08:39:42 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 08:39:42 - root - INFO - ```sql
WITH common_complaints AS (
    SELECT "complaint_type"
    FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
    WHERE DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) BETWEEN '2011-01-01' AND '2020-12-31'
    GROUP BY "complaint_type"
    HAVING COUNT(*) > 3000
),
complaint_counts AS (
    SELECT
        DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) AS "date",
        "complaint_type",
        COUNT(*) AS "complaint_count"
    FROM "NEW_YORK_NOAA"."NEW_YORK"."_311_SERVICE_REQUESTS"
    WHERE "latitude" BETWEEN 40.6 AND 40.7
      AND "longitude" BETWEEN -73.8 AND -73.75
      AND DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)) BETWEEN '2011-01-01' AND '2020-12-31'
    GROUP BY DATE(TO_TIMESTAMP_NTZ("created_date" / 1e6)), "complaint_type"
),
filtered_complaints AS (
    SELECT cc.*
    FROM complaint_counts cc
    JOIN common_complaints c ON cc."complaint_type" = c."complaint_type"
),
wind_speed_data AS (
    SELECT
        TO_DATE(CONCAT("year", '-', LPAD("mo",2,'0'), '-', LPAD("da",2,'0'))) AS "date",
        CAST("wdsp" AS FLOAT) AS "wind_speed"
    FROM (
        SELECT "stn", "wban", "year", "mo", "da", "wdsp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2011"
        UNION ALL
        SELECT "stn", "wban", "year", "mo", "da", "wdsp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2012"
        UNION ALL
        SELECT "stn", "wban", "year", "mo", "da", "wdsp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2013"
        UNION ALL
        SELECT "stn", "wban", "year", "mo", "da", "wdsp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2014"
        UNION ALL
        SELECT "stn", "wban", "year", "mo", "da", "wdsp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2015"
        UNION ALL
        SELECT "stn", "wban", "year", "mo", "da", "wdsp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2016"
        UNION ALL
        SELECT "stn", "wban", "year", "mo", "da", "wdsp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2017"
        UNION ALL
        SELECT "stn", "wban", "year", "mo", "da", "wdsp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2018"
        UNION ALL
        SELECT "stn", "wban", "year", "mo", "da", "wdsp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2019"
        UNION ALL
        SELECT "stn", "wban", "year", "mo", "da", "wdsp" FROM "NEW_YORK_NOAA"."NOAA_GSOD"."GSOD2020"
    ) gsod
    WHERE gsod."stn" = '744860' AND gsod."wban" = '94789' AND gsod."wdsp" IS NOT NULL
),
complaints_with_wind AS (
    SELECT fc."complaint_type", fc."date", fc."complaint_count", ws."wind_speed"
    FROM filtered_complaints fc
    JOIN wind_speed_data ws ON fc."date" = ws."date"
),
complaint_correlations AS (
    SELECT
        c."complaint_type",
        CORR(c."complaint_count", c."wind_speed") AS "correlation_value"
    FROM complaints_with_wind c
    GROUP BY c."complaint_type"
),
ranking AS (
    SELECT
        cc."complaint_type",
        ROUND(cc."correlation_value", 4) AS "correlation_value",
        RANK() OVER (ORDER BY cc."correlation_value" DESC NULLS LAST) AS rank_desc,
        RANK() OVER (ORDER BY cc."correlation_value" ASC NULLS LAST) AS rank_asc
    FROM complaint_correlations cc
    WHERE cc."correlation_value" IS NOT NULL
)
SELECT
    "complaint_type", "correlation_value"
FROM ranking
WHERE rank_desc = 1 OR rank_asc = 1
ORDER BY "correlation_value" DESC NULLS LAST;
```
2025-01-24 08:39:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:39:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:39:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:39:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-24 08:39:46 - snowflake.connector.connection - INFO - closed
2025-01-24 08:39:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:39:46 - root - INFO - itercount: 4
2025-01-24 08:39:46 - root - INFO - 0
2025-01-24 08:39:46 - root - INFO - Total iteration counts: 4
