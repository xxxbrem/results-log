2025-01-21 14:49:18 - openai._base_client - INFO - Retrying request to /chat/completions in 0.376471 seconds
2025-01-21 14:50:18 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 14:50:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:50:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:50:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:50:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:50:20 - snowflake.connector.connection - INFO - closed
2025-01-21 14:50:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:50:20 - root - INFO - SQL:
-- 1. View the first 100 delivered orders
SELECT *
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS"
WHERE "order_status" = 'delivered'
LIMIT 100
Results:
Too long, hard cut:
order_id,customer_id,order_status,order_purchase_timestamp,order_approved_at,order_delivered_carrier_date,order_delivered_customer_date,order_estimated_delivery_date
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,delivered,2017-10-02 10:56:33,2017-10-02 11:07:15,2017-10-04 19:55:00,2017-10-10 21:25:13,2017-10-18 00:00:00
53cdb2fc8bc7dce0b6741e2150273451,b0830fb4747a6c6d20dea0b8c802d7ef,delivered,2018-07-24 20:41:37,2018-07-26 03:24:27,2018-07-26 14:31:00,2018-08-07 15:27:45,2018-08-13 00:00:00
47770eb9100c2d0c44946d9cf07ec65d,41ce2a54c0b03bf3443c3d931a367089,delivered,2018-08-08 08:38:49,2018-08-08 08:55:23,2018-08-08 13:50:00,2018-08-17 18:06:29,2018-09-04 00:00:00
949d5b44dbf5de918fe9c16f97b45f8a,f88197465ea7920adcdbec7375364d82,delivered,2017-11-18 19:28:06,2017-11-18 19:45:59,2017-11-22 13:39:59,2017-12-02 00:28:42,2017-12-15 00:00:00
ad21c59c0840e6cb83a9ceb5573f8159,8ab97904e6daea8866dbdbc4fb7aad2c,delivered,2018-02-13 21:18:39,2018-02-13 22:20:29,2018-02-14 19:46:34,2018-02-16 18:17:02,2018-02-26 00:00:00
a4591c265e18cb1dcee52889e2d8acc3,503740e9ca751ccdda7ba28e9ab8f608,delivered,2017-07-09 21:57:05,2017-07-09 22:10:13,2017-07-11 14:58:04,2017-07-26 10:57:55,2017-08-01 00:00:00
6514b8ad8028c9f2cc2374ded245783f,9bdf08b4b3b52b5526ff42d37d47f222,delivered,2017-05-16 13:10:30,2017-05-16 13:22:11,2017-05-22 10:07:46,2017-05-26 12:55:51,2017-06-07 00:00:00
76c6e866289321a7c93b82b54852dc33,f54a9f0e6b351c431402b8461ea51999,delivered,2017-01-23 18:29:09,2017-01-25 02:50:47,2017-01-26 14:16:31,2017-02-02 14:08:10,2017-03-06 00:00:00
e69bfb5eb88e0ed6a785585b27e16dbf,31ad1d1b63eb9962463f764d4e6e0c9d,delivered,2017-07-29 11:55:02,2017-07-29 12:05:32,2017-08-10 19:45:24,2017-08-16 17:14:30,2017-08-23 00:00:00
e6ce16cb79ec1d90b1da9085a6118aeb,494dded5b201313c64ed7f100595b95c,delivered,2017-05-16 19:41:10,2017-05-16 19:50:18,2017-05-18 11:40:40,2017-05-29 11:18:31,2017-06-07 00:00:00
34513ce0c4fab462a55830c0989c7edb,7711cf624183d843aafe81855097bc37,delivered,2017-07-13 19:58:11,2017-07-13 20:10:08,2017-07-14 18:43:29,2017-07-19 14:04:48,2017-08-08 00:00:00
82566a660a982b15fb86e904c8d32918,d3e3b74c766bc6214e0c830b17ee2341,delivered,2018-06-07 10:06:19,2018-06-09 03:13:12,2018-06-11 13:29:00,2018-06-19 12:05:52,2018-07-18 00:00:00
5ff96c15d0b717ac6ad1f3d77225a350,19402a48fe860416adf93348aba37740,delivered,2018-07-25 17:44:10,2018-07-25 17:55:14,2018-07-26 13:16:00,2018-07-30 15:52:25,2018-08-08 00:00:00
432aaf21d85167c2c86ec9448c4e42cc,3df704f53d3f1d4818840b34ec672a9f,delivered,2018-03-01 14:14:28,2018-03-01 15:10:47,2018-03-02 21:09:20,2018-03-12 23:36:26,2018-03-21 00:00:00
dcb36b511fcac050b97cd5c05de84dc3,3b6828a50ffe546942b7a473d70ac0fc,delivered,2018-06-07 19:03:12,2018-06-12 23:31:02,2018-06-11 14:54:00,2018-06-21 15:34:32,2018-07-04 00:00:00
403b97836b0c04a622354cf531062e5f,738b086814c6fcc74b8cc583f8516ee3,delivered,2018-01-02 19:00:43,2018-01-02 19:09:04,2018-01-03 18:19:09,2018-01-20 01:38:59,2018-02-06 00:00:00
116f0b09343b49556bbad5f35bee0cdf,3187789bec990987628d7a9beb4dd6ac,delivered,2017-12-26 23:41:31,2017-12-26 23:50:22,2017-12-28 18:33:05,2018-01-08 22:36:36,2018-01-29 00:00:00
85ce859fd6dc634de8d2f1e290444043,059f7fc5719c7da6cbafe370971a8d70,delivered,2017-11-21 00:03:41,2017-11-21 00:14:22,2017-11-23 21:32:26,2017-11-27 18:28:00,2017-12-11 00:00:00
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,delivered,2017-10-26 15:54:26,2017-10-26 16:08:14,2017-10-26 21:46:53,2017-11-08 22:22:00,2017-11-23 00:00:00
203096f03d82e0dffbc41ebc2e2bcfb7,d2b091571da224a1b36412c18bc3bbfe,delivered,2017-09-18 14:31:30,2017-09-19 04:04:09,2017-10-06 17:50:03,2017-10-09 22:23:46,2017-09-28 00:00:00
f848643eec1d69395095eb3840d2051e,4fa1cd166fa598be6de80fa84eaade43,delivered,2018-03-15 08:52:40,2018-03-15 09:09:31,2018-03-15 19:52:48,2018-03-19 18:08:32,2018-03-29 00:00:00
2807d0e504d6d4894d41672727bc139f,72ae281627a6102d9b3718528b420f8a,delivered,2018-02-03 20:37:35,2018-02-03 20:50:22,2018-02-05 22:37:28,2018-02-08 16:13:46,2018-02-21 00:00:00
95266dbfb7e20354baba07964dac78d5,a166da34890074091a942054b36e4265,delivered,2018-01-08 07:55:29,2018-01-08 08:07:31,2018-01-24 23:16:37,2018-01-26 17:32:38,2018-02-21 00:00:00
f3e7c359154d965827355f39d6b1fdac,62b423aab58096ca514ba6aa06be2f98,delivered,2018-08-09 11:44:40,2018-08-10 03:24:51,2018-08-10 12:29:00,2018-08-13 18:24:27,2018-08-17 00:00:00
fbf9ac61453ac646ce8ad9783d7d0af6,3a874b4d4c4b6543206ff5d89287f0c3,delivered,2018-02-20 23:46:53,2018-02-22 02:30:46,2018-02-26 22:25:22,2018-03-21 22:03:54,2018-03-12 00:00:00
acce194856392f074dbf9dada14d8d82,7e20bf5ca92da68200643bda76c504c6,delivered,2018-06-04 00:00:13,2018-06-05 00:35:10,2018-06-05 13:24:00,2018-06-16 15:20:55,2018-07-18 00:00:00
dd78f560c270f1909639c11b925620ea,8b212b9525f9e74e85e37ed6df37693e,delivered,2018-03-12 01:50:26,2018-03-12 03:28:34,2018-03-12 21:06:37,2018-03-21 14:41:50,2018-03-28 00:00:00
91b2a010e1e45e6ba3d133fa997597be,cce89a605105b148387c52e286ac8335,delivered,2018-0

2025-01-21 14:50:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:50:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:50:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:50:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-21 14:50:21 - snowflake.connector.connection - INFO - closed
2025-01-21 14:50:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:50:22 - root - INFO - SQL:
-- 2. Count the total number of delivered orders
SELECT COUNT(*) AS "total_delivered_orders"
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS"
WHERE "order_status" = 'delivered'
Results:
total_delivered_orders
96478

2025-01-21 14:50:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:50:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:50:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:50:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:50:23 - snowflake.connector.connection - INFO - closed
2025-01-21 14:50:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:50:24 - root - INFO - SQL:
-- 3. List the top 100 sellers by number of orders in delivered orders
SELECT t."seller_id", COUNT(*) AS "number_of_orders"
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
  ON t."order_id" = o."order_id"
WHERE o."order_status" = 'delivered'
GROUP BY t."seller_id"
ORDER BY "number_of_orders" DESC
LIMIT 100
Results:
seller_id,number_of_orders
6560211a19b47992c3666cc44a7e94c0,1996
4a3ca9315b744ce9f8e9374361493884,1949
1f50f920176fa81dab994f9023523100,1926
cc419e0650a3c5ba77189a1882b7556a,1719
da8622b14eb17ae2831f4ac5b9dab84a,1548
955fee9216a65b617aa5c0531780ce60,1472
1025f0e2d44d7041d6cf58b6550e0bfa,1420
7c67e1448b00f6e969d365cea6b010ab,1355
ea8482cd71df3c1969d7b9473ff13abc,1188
7a67c85e85bb2ce8582c35f2203ad736,1155
4869f7a5dfa277a7dca6462dcf3b52b2,1148
3d871de0142ce09b7081e2b9d1733cb1,1131
8b321bb669392f5163d04c59e235e066,1005
cca3071e3e9bb7d12640c9fbe2301306,817
620c87c171fb2a6dd6e8bb4dec959fc6,778
a1043bafd471dff536d0c462352beb48,752
e9779976487b77c6d4ac45f75ec7afe9,738
f8db351d8c4c4c22c6835c19a46f01b0,714
d2374cbcbb3ca4ab1086534108cc3ab7,620
391fc6631aebcf3004804e51b40bcf1e,605
fa1c13f2614d7b5c4749cbc52fecda94,579
7d13fca15225358621be4086e1eb0964,571
128639473a139ac0f3e5f5ade55873a5,554
1835b56ce799e6a4dc4eddc053f04066,551
d91fb3b7d041e83b64a00a3edfb37e4f,525
1900267e848ceeba8fa32d80c1a5f5a8,523
46dc3b2cc0980fb8ec44634e21d2718e,523
85d9eb9ddc5d00ca9336a2219c97bb13,512
53e4c6e0f4312d4d2107a8c9cddf45cd,512
4e922959ae960d389249c378d1c939f5,446
8581055ce74af1daba164fdbd55a40de,427
9f505651f4a6abe901a56cdc21508025,426
8160255418d5aaa7dbdc9f4c64ebda44,424
218d46b86c1881d022bce9c68a7d4b15,420
2138ccb85b11a4ec1e37afbd1c8eda1f,419
dbc22125167c298ef99da25668e1011f,417
897060da8b9a21f655304d50fd935913,413
16090f2ca825584b5a147ab24aa30c86,406
06a2c3af7b3aee5d69171b0e14f0ee87,402
53243585a1d6dc2643021fd1853d8905,400
4d6d651bd7684af3fffabd5f08d12e5a,389
77530e9772f57a62c906e1c21538ab82,381
de722cd6dad950a92b7d4f82673f8833,377
c826c40d7b19f62a09e2d7c5e7295ee2,365
92eb0f42c21942b6552362b9b114707d,358
7299e27ed73d2ad986de7f7c77d919fa,358
b2ba3715d723d245138f291a6fe42594,350
5dceca129747e92ff8ef7a997dc4f8ca,343
4c2b230173bb36f9b240f2b8ac11786e,343
87142160b41353c4e5fca2360caf6f92,339
fa40cc5b934574b62717c68f3d678b6d,337
c70c1b0d8ca86052f45a432a38b73958,336
7ddcbb64b5bc1ef36ca8c151f6ec77df,334
ef506c96320abeedfb894c34db06f478,332
7142540dd4c91e2237acb7e911c4eba2,328
1da3aeb70d7989d1e6d9b0e887f97c23,324
634964b17796e64304cadf1ad3050fb7,323
70a12e78e608ac31179aea7f8422044b,323
7e93a43ef30c4f03f38b393420bc753a,322
855668e0971d4dfd7bef1b6a4133b41b,311
c3cfdc648177fdbbbb35635a37472c53,307
fe2032dab1a61af8794248c8196565c9,305
88460e8ebdecbfecb5f9601833981930,300
37be5a7c751166fbc5f8ccba4119e043,278
1554a68530182680ad5c8b042c3ab563,267
25c5c91f63607446a97b143d2d535d31,266
562fc2f2c2863ab7e79a9e4388a58a14,265
0ea22c1cfbdc755f86b9b54b39c16043,265
e9bc59e7b60fc3063eb2290deda4cced,260
a3a38f4affed601eb87a97788c949667,260
17e34d8224d27a541263c4c64b11a56b,260
e5a3438891c0bfdb9394643f95273d8e,247
0241d4d5d36f10f80c644447315af0bd,246
dc4a0fc896dc34b0d5bfec8438291c80,242
c3867b4666c7d76867627c2f7fb22e21,241
d1c281d3ae149232351cd8c8cc885f0d,239
37515688008a7a40ac93e3b2e4ab203f,239
7aa4334be125fcdd2ba64b3180029f14,237
001cca7ae9ae17fb1caed9dfb1094831,234
f457c46070d02cadd8a68551231220dd,230
f7ba60f8c3f99e7ee4042fdef03b70c4,229
8d956fec2e4337affcb520f56fd8cbfd,227
41b39e28db005d9731d9d485a83b4c38,223
7040e82f899a04d1b434b795a43b4617,223
4b9750c8ad28220fe6702d4ecb7c898f,221
9b013e03b2ab786505a1d3b5c0756754,220
1c129092bf23f28a5930387c980c0dfc,219
0c8380b62e38e8a1e6adbeba7eb9688c,218
6edacfd9f9074789dad6d62ba7950b9c,216
e26901d5ab434ce92fd9b5c256820a4e,215
7178f9f4dd81dcef02f62acdf8151e01,215
4830e40640734fc1c52cd21127c341d4,212
0b90b6df587eb83608a64ea8b390cf07,209
86ccac0b835037332a596a33b6949ee1,208
ceaec5548eefc6e23e6607c5435102e7,206
cab85505710c7cb9b720bceb52b01cee,204
f262cbc1c910c83959f849465454ddd3,204
54a1852d1b8f10312c55e906355666ee,202
9c0e69c7bf2619675bbadf47b43f655a,200
c003204e1ab016dfa150abc119207b24,200

2025-01-21 14:50:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:50:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:50:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:50:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:50:25 - snowflake.connector.connection - INFO - closed
2025-01-21 14:50:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:50:25 - root - INFO - SQL:
-- 4. Calculate the total sales amount per seller in delivered orders
SELECT t."seller_id", SUM(t."price") AS "total_sales_amount"
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
  ON t."order_id" = o."order_id"
WHERE o."order_status" = 'delivered'
GROUP BY t."seller_id"
ORDER BY "total_sales_amount" DESC
LIMIT 100
Results:
seller_id,total_sales_amount
4869f7a5dfa277a7dca6462dcf3b52b2,226987.93
53243585a1d6dc2643021fd1853d8905,217940.44
4a3ca9315b744ce9f8e9374361493884,196882.12
fa1c13f2614d7b5c4749cbc52fecda94,190917.13999999998
7c67e1448b00f6e969d365cea6b010ab,186570.05
7e93a43ef30c4f03f38b393420bc753a,165981.49
da8622b14eb17ae2831f4ac5b9dab84a,159816.87
7a67c85e85bb2ce8582c35f2203ad736,139658.69
1025f0e2d44d7041d6cf58b6550e0bfa,138208.56
955fee9216a65b617aa5c0531780ce60,131836.71
46dc3b2cc0980fb8ec44634e21d2718e,122811.38
6560211a19b47992c3666cc44a7e94c0,120702.83
620c87c171fb2a6dd6e8bb4dec959fc6,112461.5
7d13fca15225358621be4086e1eb0964,112436.18000000001
5dceca129747e92ff8ef7a997dc4f8ca,111126.73
1f50f920176fa81dab994f9023523100,106655.70999999999
cc419e0650a3c5ba77189a1882b7556a,101090.95999999999
a1043bafd471dff536d0c462352beb48,99309.23
3d871de0142ce09b7081e2b9d1733cb1,93407.4
edb1ef5e36e0c8cd84eb3c9b003e486d,79144.9
ccc4bbb5f32a6ab2b7066a4130f114e3,72926.72
f7ba60f8c3f99e7ee4042fdef03b70c4,68070.0
fe2032dab1a61af8794248c8196565c9,65689.71
8581055ce74af1daba164fdbd55a40de,64011.22
cca3071e3e9bb7d12640c9fbe2301306,63035.16
04308b1ee57b6625f47df1d56f00eedf,58991.8
522620dcb18a6b31cd7bdf73665113a9,56690.49
de722cd6dad950a92b7d4f82673f8833,55126.3
37be5a7c751166fbc5f8ccba4119e043,54735.55
17e34d8224d27a541263c4c64b11a56b,54440.28
7ddcbb64b5bc1ef36ca8c151f6ec77df,54435.66
25c5c91f63607446a97b143d2d535d31,54208.78
218d46b86c1881d022bce9c68a7d4b15,53710.3
ceaec5548eefc6e23e6607c5435102e7,51478.18
f5a590cf36251cf1162ea35bef76fe84,51232.78
e882b2a25a10b9c057cc49695f222c19,51057.54
2bf6a2c1e71bbd29a4ad64e6d3c3629f,50628.9
f8db351d8c4c4c22c6835c19a46f01b0,50082.6
b2ba3715d723d245138f291a6fe42594,49302.18
17f51e7198701186712e53a39c564617,48019.0
8160255418d5aaa7dbdc9f4c64ebda44,46368.39
966cb4760537b1404caedd472cc610a5,45928.26
77530e9772f57a62c906e1c21538ab82,45676.6
4e922959ae960d389249c378d1c939f5,45338.42
850f4f8af5ea87287ac68de36e29107f,45285.37
c826c40d7b19f62a09e2d7c5e7295ee2,44653.04
b33e7c55446eabf8fe1a42d037ac7d6d,44215.17
ba90964cff9b9e0e6f32b23b82465f7b,44212.5
eeb6de78f79159600292e314a77cbd18,43510.84
c3cfdc648177fdbbbb35635a37472c53,43048.18
4d6d651bd7684af3fffabd5f08d12e5a,42999.0
b839e41795b7f3ad94cc2014a52f6796,42829.0
e9779976487b77c6d4ac45f75ec7afe9,42229.69
17a053fcb14bd219540cbde0df490be0,40353.24
d91fb3b7d041e83b64a00a3edfb37e4f,39926.39
834f3294fba9f932f56edc879193f925,39907.5
391fc6631aebcf3004804e51b40bcf1e,39475.3
712e6ed8aa4aa1fa65dab41fed5737e4,39385.0
634964b17796e64304cadf1ad3050fb7,39114.1
2eb70248d66e0e3ef83659f71b244378,38990.72
7142540dd4c91e2237acb7e911c4eba2,37181.94
7178f9f4dd81dcef02f62acdf8151e01,36795.4
ea8482cd71df3c1969d7b9473ff13abc,36696.76
59417c56835dd8e2e72f91f809cd4092,36459.0
c70c1b0d8ca86052f45a432a38b73958,36289.15
06a2c3af7b3aee5d69171b0e14f0ee87,36097.979999999996
c3867b4666c7d76867627c2f7fb22e21,34666.9
7299e27ed73d2ad986de7f7c77d919fa,34107.44
e9bc59e7b60fc3063eb2290deda4cced,33543.69
1835b56ce799e6a4dc4eddc053f04066,33005.32
5c243662ce92d84573bfaff24c3e3700,32862.02
dbc22125167c298ef99da25668e1011f,32829.12
9c0e69c7bf2619675bbadf47b43f655a,32720.4
2528513dd95219a6013d4d05176e391a,32660.2
76d5af76d0271110f9af36c92573f765,31944.6
70eea00b476a314817cefde4aad4f89a,31424.75
0241d4d5d36f10f80c644447315af0bd,31397.7
88460e8ebdecbfecb5f9601833981930,31320.4
7681ef142fd2c19048da7430856b5588,31211.81
87142160b41353c4e5fca2360caf6f92,31095.98
855668e0971d4dfd7bef1b6a4133b41b,30849.22
e59aa562b9f8076dd550fcddf0e73491,30716.3
70a12e78e608ac31179aea7f8422044b,29963.53
53e4c6e0f4312d4d2107a8c9cddf45cd,29587.77
d23019c84ffae2d5ef2270367b8605fc,29205.1
1554a68530182680ad5c8b042c3ab563,28979.64
900ba814c251a692506d7834c1218441,28833.03
0b90b6df587eb83608a64ea8b390cf07,28492.76
59b22a78efb79a4797979612b885db36,27184.5
d1c281d3ae149232351cd8c8cc885f0d,26833.61
b32be1695eb7ec5f10f72d9610a12527,26575.0
12b9676b00f60f3b700e83af21824c0e,26376.0
a3a38f4affed601eb87a97788c949667,26294.62
7e1fb0a3ebfb01ffb3a7dae98bf3238d,26169.53
de23c3b98a88888289c6f5cc1209054a,25933.670000000002
9f505651f4a6abe901a56cdc21508025,25912.84
16090f2ca825584b5a147ab24aa30c86,25579.16
b94cc9f10ddc85e4ba73a6f7974e7101,25346.1
a416b6a846a11724393025641d4edd5e,24930.24
c003204e1ab016dfa150abc119207b24,24904.29

2025-01-21 14:50:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:50:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:50:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:50:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:50:27 - snowflake.connector.connection - INFO - closed
2025-01-21 14:50:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:50:27 - root - INFO - SQL:
-- 5. List distinct customer IDs for each seller in delivered orders
SELECT DISTINCT t."seller_id", o."customer_id"
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
  ON t."order_id" = o."order_id"
WHERE o."order_status" = 'delivered'
LIMIT 100
Results:
Too long, hard cut:
seller_id,customer_id
8602a61d680a10a82cceeeda0d99ea3d,6a899e55865de6549a58d2c6845e5604
530ec6109d11eaaf87999465c6afee01,2a30c97668e81df7c17a8b14447aeeba
fe2032dab1a61af8794248c8196565c9,fff5169e583fd07fac9fec88962f189d
8cbac7e12637ed9cffa18c7875207478,2b01d668726fb0b751c55918c0437b7b
ea8482cd71df3c1969d7b9473ff13abc,6a3b2fc9f270df258605e22bef19fd88
6560211a19b47992c3666cc44a7e94c0,2dfbf74859104caf100df3720a1d833d
ffc470761de7d0232558ba5e786e57b7,f4f17ada91ef010cbde3892ae54e625f
4a3ca9315b744ce9f8e9374361493884,48ed31e735f1c420ed6ca3637b7c744d
4a3ca9315b744ce9f8e9374361493884,698a74f33469466fa4172e829505d1c6
e8b4225284fbb02d16f200513f1f395d,ce0421a97232c2a1194cdb66cd3ebb9d
4869f7a5dfa277a7dca6462dcf3b52b2,1c1bfb2cd4aa789067295941c42120ff
ef506c96320abeedfb894c34db06f478,ab3642244247c0c638253fe68ee4c345
3db66a856d18a9cba7c9241fc5221c50,e3b91047e6ca3f5e8b656750fa3d61b2
c003204e1ab016dfa150abc119207b24,b6fbaad4eb3a0794111683dca8122610
1554a68530182680ad5c8b042c3ab563,f7277fce45fad3165379c15cacf5ddbe
ff063b022a9a0aab91bad2c9088760b7,9ec353f970bdf785f6568724d9ea19aa
fa40cc5b934574b62717c68f3d678b6d,75fd1fb0bb511fc71ac2b2649c02b21b
850f4f8af5ea87287ac68de36e29107f,c4e00400b6f79caa802740faa2829161
de23c3b98a88888289c6f5cc1209054a,727dc68f327d34b77009f5d3da5250d9
f8db351d8c4c4c22c6835c19a46f01b0,3ace63287bc8b41172016c06a5093808
ad273c9eb54ecb4532de4bf75bae9e4e,a2da04a295c890e30103aeb5356163f0
b1a81260566c1bac3114a6d124413f27,a5fd6dd86d703cedc9ab6be3dba12816
7c67e1448b00f6e969d365cea6b010ab,ea477083e770db0655938e79149f8c24
7e93a43ef30c4f03f38b393420bc753a,b4c4af6dbbbbafcfd8d6863fa0fc6e61
e59aa562b9f8076dd550fcddf0e73491,7b63cba66b8e6d002e94d0990c1e2868
a3e9a2c700480d9bb01fba070ba80a0e,efb3830adb68fb8a89c948774388ec28
0887a9f087bcd5d9f6642b52f897fc6c,630b8c2f4134e83812d827e8006caa85
70c27847eca8195c983ed7e798c56743,32b84239e3f3904ac162d832454770c7
f457c46070d02cadd8a68551231220dd,74454d0e51e0eeaaaa9b7b135469c420
38e6dada03429a47197d5d584d793b41,ae55e228ded796581eccc67045516023
729b2d09b2a0bdab221076327f13d050,6031cd91d182925af3d38ae9590e5afa
e38db885400cd35c71dfd162f2c1dbcf,e5c49220ea97eddff8b1fbb594913a43
cc419e0650a3c5ba77189a1882b7556a,6dc7d8b1ac961fe9d43edb6ecadd5f10
bd0389da23d89b726abf911cccc54596,bd8d067426b640b65c68dd3ee6c71d46
218d46b86c1881d022bce9c68a7d4b15,03ed7b1b35f2e55b0f4d0b9e4e07b0c3
0dd184061fb0eaa7ca37932c68ab91c5,cbde8134b8a718381d08167dfc58ec8c
a1043bafd471dff536d0c462352beb48,3747cfcc18da3cff44fd440770d92d97
6560211a19b47992c3666cc44a7e94c0,d7165639dc4a682258711343560a17d3
5b67882648febfb6e1225e6ad7164f6b,26355ea90aab63ebf5e90caa825a943d
cea729054f157f5870bdd321a958d994,5c94f28f54aa13e14aaf67039511f318
4c03b9dd4c11ee2cb35c96c49efc9420,399d1e628c48b7c3b6389098be566cfd
f8db351d8c4c4c22c6835c19a46f01b0,7887f43daaa91055f85b6dd23cccdfcb
2138ccb85b11a4ec1e37afbd1c8eda1f,fd967f807427c24072652b1f62d4fe47
391fc6631aebcf3004804e51b40bcf1e,2b27fae969b7d2bc173e466a742e50c6
9f505651f4a6abe901a56cdc21508025,1c34888248845ed3c9607a2652adad9c
c864036feaab8c1659f65ea4faebe1da,7dd2e283f47deac853cf70f3b63c8d86
1c129092bf23f28a5930387c980c0dfc,98884e672c5ba85f4394f2044e1a3eab
99eaacc9e6046db1c82b163c5f84869f,a12427487c970a4a75dbeb5884f126a8
8e6d7754bc7e0f22c96d255ebda59eba,cca819156e50623e9d3762ebeee308dc
3d871de0142ce09b7081e2b9d1733cb1,6081c7acb40f63731b3c982857c79581
5656537e588803a555b8eb41f07a944b,e0dc8ea464de23db3b4aa5fa6ae07cc3
afa6714acee029b2dfdf357e5579cc03,d63e92aea6fb367972e3cc4f232a1976
7d13fca15225358621be4086e1eb0964,afc13494642f88d253be56a1e353e261
53e4c6e0f4312d4d2107a8c9cddf45cd,f40f31f8bfcc5f74d9d246354b90af09
ca3bd7cd9f149df75950150d010fe4a2,299735fa1daa3e83ee1048309d22f9da
b4f8921fcc4ff77b66bea6dda43dcd51,e8a101d3de305ff620d4febe10137fd0
c9c7905cffc4ef9ff9f113554423e671,892522b67acfcb855f3feba4cff78050
855668e0971d4dfd7bef1b6a4133b41b,f418fa622ecaa0dc1bc8524446faf6fd
bd4889b5e9133b35b66e42a8665cea5c,39851c46815f49fafb7bc26ed6bf513d
48436dade18ac8b2bce089ec2a041202,62b59a64eb786a96516229b7f3612c72
1025f0e2d44d7041d6cf58b6550e0bfa,7f340a499d079212d76e5a57f5d42389
46dc3b2cc0980fb8ec44634e21d2718e,bdbdcd5b18193390b025df518afe94ba
46dc3b2cc0980fb8ec44634e21d2718e,43bb6f9650ab2a7e6ef1c93168c4cfcf
c3cfdc648177fdbbbb35635a37472c53,655418b3cc52d17ccb5b4330a7f03197
7008613ea464bad5cb9b83456e1e6a8f,3c3472f5efc17888458e428b0b9eeef3
7c67e1448b00f6e969d365cea6b010ab,86ade8ebc14f18dd6c3ea75bd0eb7534
955fee9216a65b617aa5c0531780ce60,2430ad4b1b6efb56cf3050b5d3cf5e54
8444e55c1f13cd5c179851e5ca5ebd00,c8c4991d84dbfef1f61c6152486db6d4
218d46b86c1881d022bce9c68a7d4b15,f3476df115c5d26bdb6bfb71b5fb66af
06a2c3af7b3aee5d69171b0e14f0ee87,8c66482ec333eae596c93a9131981a9a
c70c1b0d8ca86052f45a432a38b73958,7ddb7e4242fcc518842aade22f5bee4d
3d871de0142ce09b7081e2b9d1733cb1,e600c255f682a86dfd0c57d3b1d7417b
7a67c85e85bb2ce8582c35f2203ad736,176a76443d14508cc976f1d84a44921d
e9bc59e7b60fc3063eb2290deda4cced,0f2a7baf176f693c27c891360da9ef2c
7d13fca15225358621be4086e1eb0964,1aac2b5adf8aec2c00fe67d06aa8ebc2
688756f717c462a206ad854c5027

2025-01-21 14:50:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:50:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:50:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:50:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:50:29 - snowflake.connector.connection - INFO - closed
2025-01-21 14:50:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:50:29 - root - INFO - SQL:
-- 6. Count the number of distinct customers per seller in delivered orders
SELECT t."seller_id", COUNT(DISTINCT o."customer_id") AS "distinct_customers"
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
  ON t."order_id" = o."order_id"
WHERE o."order_status" = 'delivered'
GROUP BY t."seller_id"
ORDER BY "distinct_customers" DESC
LIMIT 100
Results:
seller_id,distinct_customers
6560211a19b47992c3666cc44a7e94c0,1819
4a3ca9315b744ce9f8e9374361493884,1772
cc419e0650a3c5ba77189a1882b7556a,1651
1f50f920176fa81dab994f9023523100,1399
da8622b14eb17ae2831f4ac5b9dab84a,1311
955fee9216a65b617aa5c0531780ce60,1261
7a67c85e85bb2ce8582c35f2203ad736,1145
ea8482cd71df3c1969d7b9473ff13abc,1132
4869f7a5dfa277a7dca6462dcf3b52b2,1124
3d871de0142ce09b7081e2b9d1733cb1,1064
7c67e1448b00f6e969d365cea6b010ab,973
8b321bb669392f5163d04c59e235e066,930
1025f0e2d44d7041d6cf58b6550e0bfa,910
620c87c171fb2a6dd6e8bb4dec959fc6,722
a1043bafd471dff536d0c462352beb48,702
cca3071e3e9bb7d12640c9fbe2301306,699
f8db351d8c4c4c22c6835c19a46f01b0,659
e9779976487b77c6d4ac45f75ec7afe9,645
fa1c13f2614d7b5c4749cbc52fecda94,578
7d13fca15225358621be4086e1eb0964,558
128639473a139ac0f3e5f5ade55873a5,527
d91fb3b7d041e83b64a00a3edfb37e4f,524
391fc6631aebcf3004804e51b40bcf1e,521
d2374cbcbb3ca4ab1086534108cc3ab7,514
46dc3b2cc0980fb8ec44634e21d2718e,503
85d9eb9ddc5d00ca9336a2219c97bb13,499
53e4c6e0f4312d4d2107a8c9cddf45cd,463
1835b56ce799e6a4dc4eddc053f04066,417
4e922959ae960d389249c378d1c939f5,412
1900267e848ceeba8fa32d80c1a5f5a8,406
16090f2ca825584b5a147ab24aa30c86,398
dbc22125167c298ef99da25668e1011f,394
9f505651f4a6abe901a56cdc21508025,393
06a2c3af7b3aee5d69171b0e14f0ee87,389
2138ccb85b11a4ec1e37afbd1c8eda1f,388
218d46b86c1881d022bce9c68a7d4b15,382
8160255418d5aaa7dbdc9f4c64ebda44,380
8581055ce74af1daba164fdbd55a40de,380
4d6d651bd7684af3fffabd5f08d12e5a,363
53243585a1d6dc2643021fd1853d8905,348
c826c40d7b19f62a09e2d7c5e7295ee2,346
de722cd6dad950a92b7d4f82673f8833,337
7299e27ed73d2ad986de7f7c77d919fa,335
92eb0f42c21942b6552362b9b114707d,334
7ddcbb64b5bc1ef36ca8c151f6ec77df,325
b2ba3715d723d245138f291a6fe42594,324
5dceca129747e92ff8ef7a997dc4f8ca,322
7e93a43ef30c4f03f38b393420bc753a,319
7142540dd4c91e2237acb7e911c4eba2,316
ef506c96320abeedfb894c34db06f478,316
70a12e78e608ac31179aea7f8422044b,312
77530e9772f57a62c906e1c21538ab82,312
87142160b41353c4e5fca2360caf6f92,305
897060da8b9a21f655304d50fd935913,304
fa40cc5b934574b62717c68f3d678b6d,304
855668e0971d4dfd7bef1b6a4133b41b,300
fe2032dab1a61af8794248c8196565c9,293
c3cfdc648177fdbbbb35635a37472c53,278
37be5a7c751166fbc5f8ccba4119e043,269
634964b17796e64304cadf1ad3050fb7,265
1da3aeb70d7989d1e6d9b0e887f97c23,261
c70c1b0d8ca86052f45a432a38b73958,260
4c2b230173bb36f9b240f2b8ac11786e,258
562fc2f2c2863ab7e79a9e4388a58a14,255
a3a38f4affed601eb87a97788c949667,251
17e34d8224d27a541263c4c64b11a56b,247
88460e8ebdecbfecb5f9601833981930,246
1554a68530182680ad5c8b042c3ab563,246
0241d4d5d36f10f80c644447315af0bd,238
0ea22c1cfbdc755f86b9b54b39c16043,234
c3867b4666c7d76867627c2f7fb22e21,228
37515688008a7a40ac93e3b2e4ab203f,227
dc4a0fc896dc34b0d5bfec8438291c80,225
f7ba60f8c3f99e7ee4042fdef03b70c4,218
4b9750c8ad28220fe6702d4ecb7c898f,217
e5a3438891c0bfdb9394643f95273d8e,216
d1c281d3ae149232351cd8c8cc885f0d,214
7aa4334be125fcdd2ba64b3180029f14,214
8d956fec2e4337affcb520f56fd8cbfd,210
e9bc59e7b60fc3063eb2290deda4cced,209
7040e82f899a04d1b434b795a43b4617,208
6edacfd9f9074789dad6d62ba7950b9c,205
4830e40640734fc1c52cd21127c341d4,204
7178f9f4dd81dcef02f62acdf8151e01,202
cab85505710c7cb9b720bceb52b01cee,201
1c129092bf23f28a5930387c980c0dfc,200
ceaec5548eefc6e23e6607c5435102e7,198
54a1852d1b8f10312c55e906355666ee,198
e26901d5ab434ce92fd9b5c256820a4e,197
c003204e1ab016dfa150abc119207b24,195
f457c46070d02cadd8a68551231220dd,195
001cca7ae9ae17fb1caed9dfb1094831,195
f262cbc1c910c83959f849465454ddd3,189
2eb70248d66e0e3ef83659f71b244378,187
41b39e28db005d9731d9d485a83b4c38,187
850f4f8af5ea87287ac68de36e29107f,186
f45122a9ab94eb4f3f8953578bc0c560,184
ccc4bbb5f32a6ab2b7066a4130f114e3,184
0c8380b62e38e8a1e6adbeba7eb9688c,180
86ccac0b835037332a596a33b6949ee1,178

2025-01-21 14:50:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:50:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:50:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:50:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:50:31 - snowflake.connector.connection - INFO - closed
2025-01-21 14:50:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:50:31 - root - INFO - SQL:
-- 7. Find the sellers with most 5-star reviews in delivered orders
SELECT t."seller_id", COUNT(*) AS "five_star_reviews"
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_REVIEWS" r
  ON t."order_id" = r."order_id"
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
  ON t."order_id" = o."order_id"
WHERE r."review_score" = 5 AND o."order_status" = 'delivered'
GROUP BY t."seller_id"
ORDER BY "five_star_reviews" DESC
LIMIT 100
Results:
seller_id,five_star_reviews
1f50f920176fa81dab994f9023523100,1096
cc419e0650a3c5ba77189a1882b7556a,1050
6560211a19b47992c3666cc44a7e94c0,1023
4a3ca9315b744ce9f8e9374361493884,941
da8622b14eb17ae2831f4ac5b9dab84a,893
955fee9216a65b617aa5c0531780ce60,800
1025f0e2d44d7041d6cf58b6550e0bfa,729
7a67c85e85bb2ce8582c35f2203ad736,717
4869f7a5dfa277a7dca6462dcf3b52b2,683
3d871de0142ce09b7081e2b9d1733cb1,632
ea8482cd71df3c1969d7b9473ff13abc,617
8b321bb669392f5163d04c59e235e066,551
620c87c171fb2a6dd6e8bb4dec959fc6,523
a1043bafd471dff536d0c462352beb48,452
e9779976487b77c6d4ac45f75ec7afe9,450
7c67e1448b00f6e969d365cea6b010ab,436
f8db351d8c4c4c22c6835c19a46f01b0,428
cca3071e3e9bb7d12640c9fbe2301306,424
fa1c13f2614d7b5c4749cbc52fecda94,394
46dc3b2cc0980fb8ec44634e21d2718e,332
d91fb3b7d041e83b64a00a3edfb37e4f,330
391fc6631aebcf3004804e51b40bcf1e,320
7d13fca15225358621be4086e1eb0964,319
128639473a139ac0f3e5f5ade55873a5,318
53e4c6e0f4312d4d2107a8c9cddf45cd,295
85d9eb9ddc5d00ca9336a2219c97bb13,288
d2374cbcbb3ca4ab1086534108cc3ab7,287
9f505651f4a6abe901a56cdc21508025,284
8581055ce74af1daba164fdbd55a40de,273
1900267e848ceeba8fa32d80c1a5f5a8,272
dbc22125167c298ef99da25668e1011f,256
218d46b86c1881d022bce9c68a7d4b15,251
7299e27ed73d2ad986de7f7c77d919fa,247
fa40cc5b934574b62717c68f3d678b6d,246
1835b56ce799e6a4dc4eddc053f04066,245
4d6d651bd7684af3fffabd5f08d12e5a,240
4e922959ae960d389249c378d1c939f5,235
c3cfdc648177fdbbbb35635a37472c53,231
c70c1b0d8ca86052f45a432a38b73958,230
77530e9772f57a62c906e1c21538ab82,227
2138ccb85b11a4ec1e37afbd1c8eda1f,223
06a2c3af7b3aee5d69171b0e14f0ee87,218
87142160b41353c4e5fca2360caf6f92,217
16090f2ca825584b5a147ab24aa30c86,216
de722cd6dad950a92b7d4f82673f8833,215
c826c40d7b19f62a09e2d7c5e7295ee2,213
7e93a43ef30c4f03f38b393420bc753a,213
b2ba3715d723d245138f291a6fe42594,211
fe2032dab1a61af8794248c8196565c9,210
53243585a1d6dc2643021fd1853d8905,209
8160255418d5aaa7dbdc9f4c64ebda44,206
5dceca129747e92ff8ef7a997dc4f8ca,199
1da3aeb70d7989d1e6d9b0e887f97c23,191
92eb0f42c21942b6552362b9b114707d,182
7ddcbb64b5bc1ef36ca8c151f6ec77df,178
a3a38f4affed601eb87a97788c949667,178
0ea22c1cfbdc755f86b9b54b39c16043,177
4c2b230173bb36f9b240f2b8ac11786e,176
1554a68530182680ad5c8b042c3ab563,174
37be5a7c751166fbc5f8ccba4119e043,170
ef506c96320abeedfb894c34db06f478,170
7142540dd4c91e2237acb7e911c4eba2,167
634964b17796e64304cadf1ad3050fb7,166
0241d4d5d36f10f80c644447315af0bd,164
897060da8b9a21f655304d50fd935913,163
17e34d8224d27a541263c4c64b11a56b,157
855668e0971d4dfd7bef1b6a4133b41b,157
562fc2f2c2863ab7e79a9e4388a58a14,155
70a12e78e608ac31179aea7f8422044b,154
6edacfd9f9074789dad6d62ba7950b9c,153
e9bc59e7b60fc3063eb2290deda4cced,150
41b39e28db005d9731d9d485a83b4c38,147
4b9750c8ad28220fe6702d4ecb7c898f,143
c3867b4666c7d76867627c2f7fb22e21,141
7aa4334be125fcdd2ba64b3180029f14,138
e5a3438891c0bfdb9394643f95273d8e,137
f7ba60f8c3f99e7ee4042fdef03b70c4,137
54a1852d1b8f10312c55e906355666ee,134
c003204e1ab016dfa150abc119207b24,132
1c129092bf23f28a5930387c980c0dfc,132
8d956fec2e4337affcb520f56fd8cbfd,130
0b90b6df587eb83608a64ea8b390cf07,128
9b013e03b2ab786505a1d3b5c0756754,127
4830e40640734fc1c52cd21127c341d4,126
37515688008a7a40ac93e3b2e4ab203f,125
ccc4bbb5f32a6ab2b7066a4130f114e3,124
edb1ef5e36e0c8cd84eb3c9b003e486d,123
d1c281d3ae149232351cd8c8cc885f0d,123
a416b6a846a11724393025641d4edd5e,122
cab85505710c7cb9b720bceb52b01cee,122
f262cbc1c910c83959f849465454ddd3,122
001cca7ae9ae17fb1caed9dfb1094831,121
ceaec5548eefc6e23e6607c5435102e7,120
0c8380b62e38e8a1e6adbeba7eb9688c,120
25c5c91f63607446a97b143d2d535d31,119
7178f9f4dd81dcef02f62acdf8151e01,119
dc4a0fc896dc34b0d5bfec8438291c80,118
88460e8ebdecbfecb5f9601833981930,118
98dac6635aee4995d501a3972e047414,118
f457c46070d02cadd8a68551231220dd,117

2025-01-21 14:50:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:50:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:50:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:50:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:50:33 - snowflake.connector.connection - INFO - closed
2025-01-21 14:50:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:50:33 - root - INFO - SQL:
-- 8. View the first 100 reviews with their scores and order IDs
SELECT *
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_REVIEWS"
LIMIT 100
Results:
Too long, hard cut:
review_id,order_id,review_score,review_comment_title,review_comment_message,review_creation_date,review_answer_timestamp
7bc2406110b926393aa56f80a40eba40,73fc7af87114b39712e6da79b0a377eb,4,,,2018-01-18 00:00:00,2018-01-18 21:46:59
80e641a11e56f04c1ad469d5645fdfde,a548910a1c6147796b98fdf73dbeba33,5,,,2018-03-10 00:00:00,2018-03-11 03:05:13
228ce5500dc1d8e020d8d1322874b6f0,f9e4b658b201a9f2ecdecbb34bed034b,5,,,2018-02-17 00:00:00,2018-02-18 14:36:24
e64fb393e7b32834bb789ff8bb30750e,658677c97b385a9be170737859d3511b,5,,Recebi bem antes do prazo estipulado.,2017-04-21 00:00:00,2017-04-21 22:02:06
f7c4243c7fe1938f181bec41a392bdeb,8e6bfb81e283fa7e4f11123a3fb894f1,5,,Parabéns lojas lannister adorei comprar pela Internet seguro e prático Parabéns a todos feliz Páscoa,2018-03-01 00:00:00,2018-03-02 10:26:53
15197aa66ff4d0650b5434f1b46cda19,b18dcdf73be66366873cd26c5724d1dc,1,,,2018-04-13 00:00:00,2018-04-16 00:39:37
07f9bee5d1b850860defd761afa7ff16,e48aa0d2dcec3a2e87348811bcfdf22b,5,,,2017-07-16 00:00:00,2017-07-18 19:30:34
7c6400515c67679fbee952a7525281ef,c31a859e34e3adac22f376954e19b39d,5,,,2018-08-14 00:00:00,2018-08-14 21:36:06
a3f6f7f6f433de0aefbb97da197c554c,9c214ac970e84273583ab523dfafd09b,5,,,2017-05-17 00:00:00,2017-05-18 12:05:37
8670d52e15e00043ae7de4c01cc2fe06,b9bf720beb4ab3728760088589c62129,4,recomendo,aparelho eficiente. no site a marca do aparelho esta impresso como 3desinfector e ao chegar esta com outro nome...atualizar com a marca correta uma vez que é o mesmo aparelho,2018-05-22 00:00:00,2018-05-23 16:45:47
c9cfd2d5ab5911836ababae136c3a10c,cdf9aa68e72324eeb25c7de974696ee2,5,,,2017-12-23 00:00:00,2017-12-26 14:36:03
96052551d87e5f62e6c9f6974ec392e9,3d374c9e46530bb5ed4a7648915306a6,5,,,2017-12-19 00:00:00,2017-12-20 10:25:22
4b49719c8a200003f700d3d986ea1a19,9d6f15f95d01e79bd1349cc208361f09,4,,"Mas um pouco ,travando...pelo valor ta Boa.
",2018-02-16 00:00:00,2018-02-20 10:52:22
23f75a37effc35d9a915b4e1ad483793,2eaf8e099d871cd5c22b83b5ea8f6e0e,4,,,2018-03-28 00:00:00,2018-03-30 15:10:55
9a0abbb668bafb95a6d2b05db43284c4,d7bd0e4afdf94846eb73642b4e3e75c3,3,,,2017-04-30 00:00:00,2017-05-03 00:02:22
3948b09f7c818e2d86c9a546758b2335,e51478e7e277a83743b6f9991dbfa3fb,5,Super recomendo,"Vendedor confiável, produto ok e entrega antes do prazo.",2018-05-23 00:00:00,2018-05-24 03:00:01
9314d6f9799f5bfba510cc7bcd468c01,0dacf04c5ad59fd5a0cc1faa07c34e39,2,,"GOSTARIA DE SABER O QUE HOUVE, SEMPRE RECEBI E ESSA COMPRA AGORA ME DECPCIONOU",2018-01-18 00:00:00,2018-01-20 21:25:45
8e15a274d95600fa14f8be64e37a0e67,ff1581e08b3011021e7c7de592ddc81e,5,,,2018-03-24 00:00:00,2018-03-26 15:58:32
fdbdb2629a7cde0f66657acc92084e7f,70a752414a13d09cc1f2b437b914b28e,3,,,2017-09-29 00:00:00,2017-10-02 01:12:49
373cbeecea8286a2b66c97b1b157ec46,583174fbe37d3d5f0d6661be3aad1786,1,Não chegou meu produto ,Péssimo,2018-08-15 00:00:00,2018-08-15 04:10:37
a2ff510ca4e059c3fefc7a7866571f6f,a9953b2f0b1665ac7586cc5a6ac8f58c,4,,,2017-10-06 00:00:00,2017-10-08 22:36:05
80c70bc263881ba6525f6cee1d94ac87,ae168dfba236919411fe08f336fefa44,5,,,2018-03-17 00:00:00,2018-04-04 19:41:11
d21bbc789670eab777d27372ab9094cc,4fc44d78867142c627497b60a7e0228a,5,Ótimo,Loja nota 10,2018-07-10 00:00:00,2018-07-11 14:10:25
7bcb3c758c67f23638262c731493e848,7c9956750739a47dba7a6928ba2f0245,5,,,2017-09-09 00:00:00,2017-10-17 02:25:47
0e0190b9db53b689b285d3f3916f8441,79832b7cb59ac6f887088ffd686e1d5e,5,,obrigado pela atençao amim dispensada,2017-12-01 00:00:00,2017-12-09 22:58:58
66e4430c5bc6b7e3773886bf1c14d912,84cec4f65c7a4f2f54c294a30224a594,5,,,2017-06-23 00:00:00,2017-06-27 00:52:02
bf566b3910c328733baf7fca7d2be041,a59a15e4b6085c752d338431dc68d464,4,,,2017-11-01 00:00:00,2017-11-01 20:25:30
fe3db7c069d694bab50cc43463f91608,2ca73e2ff9e3a186ad1e1ffb9b1d9c10,5,,"A compra foi realizada facilmente.
A entrega foi efetuada muito antes do prazo dado.
O produto já começou a ser usado e até o presente,
sem problemas.",2018-03-23 00:00:00,2018-04-01 00:27:51
e07eee7ad7666276bd8b27fbd83fd1ff,68b3cbc68e4cd1fe19bec35f1d3bb7ee,5,,relógio muito bonito e barato.,2018-03-29 00:00:00,2018-04-02 14:19:31
2c5e27fc178bde7ac173c9c62c31b070,0ce9a24111d850192a933fcaab6fbad3,1,,Não gostei ! Comprei gato por lebre,2017-12-13 00:00:00,2017-12-16 07:14:07
540e7bbb2d06cfb7f85f3a88ba7ac97f,cf73e2cb1f4a9480ed70c154da3d954a,5,,,2018-01-18 00:00:00,2018-01-18 19:12:30
6a18a4001ae7fd911b3b9fb13686d105,8ba3f3a9292fbc22a8b7dff752bbcd37,5,,,2017-07-19 00:00:00,2017-07-20 10:38:48
58044bca115705a48fe0e00a21390c54,68e55ca79d04a79f20d4bfc0146f4b66,1,,"Sempre compro pela Internet e a entrega ocorre antes do prazo combinado, que acredito ser o prazo máximo. No stark o prazo máximo já se esgotou e ainda não recebi o produto.",2018-04-08 00:00:00,2018-04-09 12:22:39
19a52a2297e5289ab4187d238d335982,677c865b89aa97e7dbeb4bfbb50bbcfd,5,,,2018-08-25 00:00:00,2018-08-26 22:02:59
c92cdd7dd544a01aa35137f901669cdf,37e7875cdce5a9e5b3a692971f370151,4,Muito bom.,"Recebi exatamente o que esperava. As demais encomendas de ou

2025-01-21 14:50:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:50:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:50:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:50:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:50:34 - snowflake.connector.connection - INFO - closed
2025-01-21 14:50:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:50:35 - root - INFO - SQL:
-- 9. Calculate the total profit per seller assuming profit is equal to price in delivered orders
SELECT t."seller_id", SUM(t."price") AS "total_profit"
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
  ON t."order_id" = o."order_id"
WHERE o."order_status" = 'delivered'
GROUP BY t."seller_id"
ORDER BY "total_profit" DESC
LIMIT 100
Results:
seller_id,total_profit
4869f7a5dfa277a7dca6462dcf3b52b2,226987.93
53243585a1d6dc2643021fd1853d8905,217940.44
4a3ca9315b744ce9f8e9374361493884,196882.12
fa1c13f2614d7b5c4749cbc52fecda94,190917.13999999998
7c67e1448b00f6e969d365cea6b010ab,186570.05
7e93a43ef30c4f03f38b393420bc753a,165981.49
da8622b14eb17ae2831f4ac5b9dab84a,159816.87
7a67c85e85bb2ce8582c35f2203ad736,139658.69
1025f0e2d44d7041d6cf58b6550e0bfa,138208.56
955fee9216a65b617aa5c0531780ce60,131836.71
46dc3b2cc0980fb8ec44634e21d2718e,122811.38
6560211a19b47992c3666cc44a7e94c0,120702.83
620c87c171fb2a6dd6e8bb4dec959fc6,112461.5
7d13fca15225358621be4086e1eb0964,112436.18000000001
5dceca129747e92ff8ef7a997dc4f8ca,111126.73
1f50f920176fa81dab994f9023523100,106655.70999999999
cc419e0650a3c5ba77189a1882b7556a,101090.95999999999
a1043bafd471dff536d0c462352beb48,99309.23
3d871de0142ce09b7081e2b9d1733cb1,93407.4
edb1ef5e36e0c8cd84eb3c9b003e486d,79144.9
ccc4bbb5f32a6ab2b7066a4130f114e3,72926.72
f7ba60f8c3f99e7ee4042fdef03b70c4,68070.0
fe2032dab1a61af8794248c8196565c9,65689.71
8581055ce74af1daba164fdbd55a40de,64011.22
cca3071e3e9bb7d12640c9fbe2301306,63035.16
04308b1ee57b6625f47df1d56f00eedf,58991.8
522620dcb18a6b31cd7bdf73665113a9,56690.49
de722cd6dad950a92b7d4f82673f8833,55126.3
37be5a7c751166fbc5f8ccba4119e043,54735.55
17e34d8224d27a541263c4c64b11a56b,54440.28
7ddcbb64b5bc1ef36ca8c151f6ec77df,54435.66
25c5c91f63607446a97b143d2d535d31,54208.78
218d46b86c1881d022bce9c68a7d4b15,53710.3
ceaec5548eefc6e23e6607c5435102e7,51478.18
f5a590cf36251cf1162ea35bef76fe84,51232.78
e882b2a25a10b9c057cc49695f222c19,51057.54
2bf6a2c1e71bbd29a4ad64e6d3c3629f,50628.9
f8db351d8c4c4c22c6835c19a46f01b0,50082.6
b2ba3715d723d245138f291a6fe42594,49302.18
17f51e7198701186712e53a39c564617,48019.0
8160255418d5aaa7dbdc9f4c64ebda44,46368.39
966cb4760537b1404caedd472cc610a5,45928.26
77530e9772f57a62c906e1c21538ab82,45676.6
4e922959ae960d389249c378d1c939f5,45338.42
850f4f8af5ea87287ac68de36e29107f,45285.37
c826c40d7b19f62a09e2d7c5e7295ee2,44653.04
b33e7c55446eabf8fe1a42d037ac7d6d,44215.17
ba90964cff9b9e0e6f32b23b82465f7b,44212.5
eeb6de78f79159600292e314a77cbd18,43510.84
c3cfdc648177fdbbbb35635a37472c53,43048.18
4d6d651bd7684af3fffabd5f08d12e5a,42999.0
b839e41795b7f3ad94cc2014a52f6796,42829.0
e9779976487b77c6d4ac45f75ec7afe9,42229.69
17a053fcb14bd219540cbde0df490be0,40353.24
d91fb3b7d041e83b64a00a3edfb37e4f,39926.39
834f3294fba9f932f56edc879193f925,39907.5
391fc6631aebcf3004804e51b40bcf1e,39475.3
712e6ed8aa4aa1fa65dab41fed5737e4,39385.0
634964b17796e64304cadf1ad3050fb7,39114.1
2eb70248d66e0e3ef83659f71b244378,38990.72
7142540dd4c91e2237acb7e911c4eba2,37181.94
7178f9f4dd81dcef02f62acdf8151e01,36795.4
ea8482cd71df3c1969d7b9473ff13abc,36696.76
59417c56835dd8e2e72f91f809cd4092,36459.0
c70c1b0d8ca86052f45a432a38b73958,36289.15
06a2c3af7b3aee5d69171b0e14f0ee87,36097.979999999996
c3867b4666c7d76867627c2f7fb22e21,34666.9
7299e27ed73d2ad986de7f7c77d919fa,34107.44
e9bc59e7b60fc3063eb2290deda4cced,33543.69
1835b56ce799e6a4dc4eddc053f04066,33005.32
5c243662ce92d84573bfaff24c3e3700,32862.02
dbc22125167c298ef99da25668e1011f,32829.12
9c0e69c7bf2619675bbadf47b43f655a,32720.4
2528513dd95219a6013d4d05176e391a,32660.2
76d5af76d0271110f9af36c92573f765,31944.6
70eea00b476a314817cefde4aad4f89a,31424.75
0241d4d5d36f10f80c644447315af0bd,31397.7
88460e8ebdecbfecb5f9601833981930,31320.4
7681ef142fd2c19048da7430856b5588,31211.81
87142160b41353c4e5fca2360caf6f92,31095.98
855668e0971d4dfd7bef1b6a4133b41b,30849.22
e59aa562b9f8076dd550fcddf0e73491,30716.3
70a12e78e608ac31179aea7f8422044b,29963.53
53e4c6e0f4312d4d2107a8c9cddf45cd,29587.77
d23019c84ffae2d5ef2270367b8605fc,29205.1
1554a68530182680ad5c8b042c3ab563,28979.64
900ba814c251a692506d7834c1218441,28833.03
0b90b6df587eb83608a64ea8b390cf07,28492.76
59b22a78efb79a4797979612b885db36,27184.5
d1c281d3ae149232351cd8c8cc885f0d,26833.61
b32be1695eb7ec5f10f72d9610a12527,26575.0
12b9676b00f60f3b700e83af21824c0e,26376.0
a3a38f4affed601eb87a97788c949667,26294.62
7e1fb0a3ebfb01ffb3a7dae98bf3238d,26169.53
de23c3b98a88888289c6f5cc1209054a,25933.670000000002
9f505651f4a6abe901a56cdc21508025,25912.84
16090f2ca825584b5a147ab24aa30c86,25579.16
b94cc9f10ddc85e4ba73a6f7974e7101,25346.1
a416b6a846a11724393025641d4edd5e,24930.24
c003204e1ab016dfa150abc119207b24,24904.29

2025-01-21 14:50:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:50:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:50:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:50:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:50:36 - snowflake.connector.connection - INFO - closed
2025-01-21 14:50:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:50:37 - root - INFO - SQL:
-- 10. Get average review score per seller in delivered orders
SELECT t."seller_id", AVG(r."review_score") AS "average_review_score"
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_REVIEWS" r
  ON t."order_id" = r."order_id"
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
  ON t."order_id" = o."order_id"
WHERE o."order_status" = 'delivered'
GROUP BY t."seller_id"
ORDER BY "average_review_score" DESC
LIMIT 100
Results:
seller_id,average_review_score
ff4ea69c2a729e83e63c7579e4ef8170,5.000000
8fff28c4263ddec387f28d237fb42773,5.000000
90b57083da5d803237da74daec6dcb2b,5.000000
0cab2da43793a6f3c5ed8514c5f54627,5.000000
4fe2f67634d00c021aa01f96b6f2d68e,5.000000
3e46a38ee171c503c3b4a3f23fe3bf0c,5.000000
64cc804291f90c81f02bfc2bb58ff55a,5.000000
26b482dccfa29bd2e40703ba45523702,5.000000
3bfba5a77604f6dfae7e6dd7aaf65821,5.000000
9b76ad3d04236f76bc71c59470305e13,5.000000
5721089ba9214e80074f27d5a03fc0eb,5.000000
0ad80de75c811326389cfb1daba7d45e,5.000000
fc908879b9ca1bd65419e54e50432d38,5.000000
a3b0df0065e264a91b7bbf5f844af5cd,5.000000
feb793c88d836c3a75efa4b5a3465d70,5.000000
4ddeb3e828550cddc8d45c8bc36ab2d1,5.000000
83c8aafbefb034674a70de0eac5b8954,5.000000
a64e44665225d19dfc0277eeeaaccc57,5.000000
dcb7367a92f5ffb89f1e2152ed260285,5.000000
bba8d0c234a52b87b3957037a215d1a4,5.000000
c8c1bea22194a4eefa2dc9a9fa89f536,5.000000
70126eecc6aa1274392a1743866e9678,5.000000
2075d8cd4dd63ff12df0749a5866bb06,5.000000
528ce32f560edd11add4169f6a5b65be,5.000000
0c7f30ae9b147eca07affbef92832a6a,5.000000
19e0f40a907ec568c34bfac15de4f4a1,5.000000
09bad886111255c5b5030314fc7f1a4a,5.000000
8c9348f33ae3dada25c99c99ade2af78,5.000000
bfd938b22bc99bce1ae60dc602889f52,5.000000
edd066cd02126d7800f9b66e980e9931,5.000000
bbf4a892cac7b82422baa711dffb8997,5.000000
0570350b23eda5444f8d1d9544932058,5.000000
10264f60a8f0a4d2f30810f5c661c673,5.000000
eaaa46e98c9e61f6764dd1d7a2ab8b3e,5.000000
5db42a6cd9bf1bf0d3aab9582767f168,5.000000
48efc9d94a9834137efd9ea76b065a38,5.000000
8b87cd0d43d49b9bdf40f56229364d59,5.000000
ec933281fb017b5020d06df29c3f77e8,5.000000
7994081388d55b9cf976c050653dd359,5.000000
c8665a4dd081a2c436b1cd921079d0d9,5.000000
8fd3b4468f6425810648177996c14cbd,5.000000
42fb44130ac3134cde8e35cf8ec7df25,5.000000
2d20f1cd18725c91147da0791d498022,5.000000
7f5e4d5efad7e44b91115dd1decb65f3,5.000000
f307937c1bb287c3efc2a514b94b0d1d,5.000000
75fdd0a732287f9497b179f6bd445d32,5.000000
58c851d1a3c7cd3da329eb59453fed44,5.000000
7cb946b1ad19faebe28c3e86c2794ec3,5.000000
d63f306de130e0391d38a792541723b8,5.000000
c353f8fc0ce8344999f17d578eb69a5e,5.000000
2bd05d410a8fd26dc4184a15f4f2f588,5.000000
d598f929fc44e1e38678e7f47250ec04,5.000000
d2572f31e9023e9850ef986a636ff9bf,5.000000
48b6c3f4c6a93171da04b75313f2130f,5.000000
6179a28a13a726c29b3bf54c070dccab,5.000000
392f7f2c797e4dc077e4311bde2ab8ce,5.000000
11d4c477d09821164bca4f70a2eae031,5.000000
800214c63934acd05d47e84214db8ba8,5.000000
50bf89f1349bc0409a268c3a49678009,5.000000
228e4c1a0be164f613d41c24345f9d2c,5.000000
b00af24704019bd2e1b335e70ad11f7c,5.000000
2addf05f476d0637864454e93ba673d5,5.000000
d3e7d37c0df9aef383f3f2a15b0dddfb,5.000000
f235413f677777a0738ff215d0184901,5.000000
850857dfac77488c307e2b1cbd84ab5a,5.000000
98dddbc4601dd4443ca174359b237166,5.000000
5e106d93b717c2682b9383da480364a1,5.000000
b2eecf5ea250510da76590ca79d60e5d,5.000000
c3f5668699a1b04c0fa61ecea1e2bff6,5.000000
e73bf2cea7fe4b0b4d287a7568ed1099,5.000000
2039c5e51785b5dde7cf93ccb3b7be2c,5.000000
5f5a58930c3c35f3b5af264f34fb8c85,5.000000
761681a821d8275bc79f552116d06869,5.000000
9dd459b29a14bf89d47183cf2cd0e4c7,5.000000
0b46f784306be7200ca1700aa55d819f,5.000000
71dc18fd8cbf5fd77f45dd8b427abb34,5.000000
94ca168e8bcb407ab85c5da308863027,5.000000
4f0d637c1197fd65405ebd755ac9f86b,5.000000
b9c0ffa92f3ff9a5a3d45ef7213c0842,5.000000
f8d5c7085db9a4ad2b8c1ffbeb2798c8,5.000000
78813699ffac347fe27dba345a5f1551,5.000000
05730013efda596306417c3b09302475,5.000000
9b1f656ca3060f8af17a50d8a024b533,5.000000
e3b4998c7a498169dc7bce44e6bb6277,5.000000
83c465a786b06574376909b35ef6752a,5.000000
89757206b887aed36f3e18d858460fea,5.000000
2f3d8b4c9e2ee165075331fea3f3095a,5.000000
1c83418358f249c9d6affa52d579db0e,5.000000
3c88ed2e76a2247933a15daa7161eb1c,5.000000
0a198e95d32b1be2da9424c962a6ebfa,5.000000
1d0646a72178a6fb37ee8082140e06ec,5.000000
668bf321538e5072858eaef6087ce027,5.000000
87b4428a334b8f676fd9a7f3bf544fb5,5.000000
e9c2dc0dd4ac38448289be644ac94f42,5.000000
44717f64ec2a457979cf83c429077666,5.000000
160851d3ece7aa1a510f8d1a4bb8a8af,5.000000
fa5fdc4e4bb6bd1009ad0e4ac4096562,5.000000
e1bed63d68ac36fe1f3061befe196af5,5.000000
cf1313c6e2c01c2f4b014f97db4bcd2b,5.000000
adbe70ab2c97442046d393988c8d1d27,5.000000

2025-01-21 14:50:37 - root - INFO - itercount: 0
2025-01-21 14:50:37 - root - INFO - Database Name: BRAZILIAN_E_COMMERCE
Schema Name: BRAZILIAN_E_COMMERCE
DDL describes table information.
,0
table_name,OLIST_ORDERS
description,
DDL,"create or replace TABLE OLIST_ORDERS (
	""order_id"" VARCHAR(16777216),
	""customer_id"" VARCHAR(16777216),
	""order_status"" VARCHAR(16777216),
	""order_purchase_timestamp"" VARCHAR(16777216),
	""order_approved_at"" VARCHAR(16777216),
	""order_delivered_carrier_date"" VARCHAR(16777216),
	""order_delivered_customer_date"" VARCHAR(16777216),
	""order_estimated_delivery_date"" VARCHAR(16777216)
);"

,1
table_name,OLIST_ORDER_PAYMENTS
description,
DDL,"create or replace TABLE OLIST_ORDER_PAYMENTS (
	""order_id"" VARCHAR(16777216),
	""payment_sequential"" NUMBER(38,0),
	""payment_type"" VARCHAR(16777216),
	""payment_installments"" NUMBER(38,0),
	""payment_value"" FLOAT
);"

,2
table_name,OLIST_PRODUCTS_DATASET
description,
DDL,"create or replace TABLE OLIST_PRODUCTS_DATASET (
	""index"" NUMBER(38,0),
	""product_id"" VARCHAR(16777216),
	""product_category_name"" VARCHAR(16777216),
	""product_name_lenght"" FLOAT,
	""product_description_lenght"" FLOAT,
	""product_photos_qty"" FLOAT,
	""product_weight_g"" FLOAT,
	""product_length_cm"" FLOAT,
	""product_height_cm"" FLOAT,
	""product_width_cm"" FLOAT
);"

,3
table_name,OLIST_ORDER_ITEMS
description,
DDL,"create or replace TABLE OLIST_ORDER_ITEMS (
	""order_id"" VARCHAR(16777216),
	""order_item_id"" NUMBER(38,0),
	""product_id"" VARCHAR(16777216),
	""seller_id"" VARCHAR(16777216),
	""shipping_limit_date"" VARCHAR(16777216),
	""price"" FLOAT,
	""freight_value"" FLOAT
);"

,4
table_name,OLIST_GEOLOCATION
description,
DDL,"create or replace TABLE OLIST_GEOLOCATION (
	""geolocation_zip_code_prefix"" NUMBER(38,0),
	""geolocation_lat"" FLOAT,
	""geolocation_lng"" FLOAT,
	""geolocation_city"" VARCHAR(16777216),
	""geolocation_state"" VARCHAR(16777216)
);"

,5
table_name,OLIST_SELLERS
description,
DDL,"create or replace TABLE OLIST_SELLERS (
	""seller_id"" VARCHAR(16777216),
	""seller_zip_code_prefix"" NUMBER(38,0),
	""seller_city"" VARCHAR(16777216),
	""seller_state"" VARCHAR(16777216)
);"

,6
table_name,OLIST_ORDER_REVIEWS
description,
DDL,"create or replace TABLE OLIST_ORDER_REVIEWS (
	""review_id"" VARCHAR(16777216),
	""order_id"" VARCHAR(16777216),
	""review_score"" NUMBER(38,0),
	""review_comment_title"" VARCHAR(16777216),
	""review_comment_message"" VARCHAR(16777216),
	""review_creation_date"" VARCHAR(16777216),
	""review_answer_timestamp"" VARCHAR(16777216)
);"

,7
table_name,OLIST_CUSTOMERS
description,
DDL,"create or replace TABLE OLIST_CUSTOMERS (
	""customer_id"" VARCHAR(16777216),
	""customer_unique_id"" VARCHAR(16777216),
	""customer_zip_code_prefix"" NUMBER(38,0),
	""customer_city"" VARCHAR(16777216),
	""customer_state"" VARCHAR(16777216)
);"

,8
table_name,OLIST_PRODUCTS
description,
DDL,"create or replace TABLE OLIST_PRODUCTS (
	""product_id"" VARCHAR(16777216),
	""product_category_name"" VARCHAR(16777216),
	""product_name_lenght"" FLOAT,
	""product_description_lenght"" FLOAT,
	""product_photos_qty"" FLOAT,
	""product_weight_g"" FLOAT,
	""product_length_cm"" FLOAT,
	""product_height_cm"" FLOAT,
	""product_width_cm"" FLOAT
);"

,9
table_name,PRODUCT_CATEGORY_NAME_TRANSLATION
description,
DDL,"create or replace TABLE PRODUCT_CATEGORY_NAME_TRANSLATION (
	""product_category_name"" VARCHAR(16777216),
	""product_category_name_english"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'BRAZILIAN_E_COMMERCE': {'BRAZILIAN_E_COMMERCE': ['OLIST_CUSTOMERS', 'OLIST_GEOLOCATION', 'OLIST_ORDERS', 'OLIST_ORDER_ITEMS', 'OLIST_ORDER_PAYMENTS', 'OLIST_ORDER_REVIEWS', 'OLIST_PRODUCTS', 'OLIST_PRODUCTS_DATASET', 'OLIST_SELLERS', 'PRODUCT_CATEGORY_NAME_TRANSLATION']}}
Begin Exploring Related Columns
Sure! Let's start by identifying the relevant tables and columns for each part of the task:

**Task**: Find the sellers with the highest number of distinct customers, highest profit, highest number of distinct orders, and most 5-star ratings, in **delivered orders**, along with their corresponding values.

### Relevant Tables and Columns:

1. **OLIST_ORDERS**
   - **"order_id"**: Identifier for each order.
   - **"customer_id"**: Identifier for the customer who placed the order.
   - **"order_status"**: Status of the order (e.g., 'delivered').
   - **Potential Usage**: Filter orders to include only those that are delivered and link orders to customers.

2. **OLIST_ORDER_ITEMS**
   - **"order_id"**: Links items to orders.
   - **"seller_id"**: Identifier for the seller of each item.
   - **"price"**: Price of each item sold.
   - **Potential Usage**: Calculate profits, link sellers to orders, and count orders per seller.

3. **OLIST_CUSTOMERS**
   - **"customer_id"**: Unique identifier for each customer.
   - **Potential Usage**: Identify distinct customers per seller.

4. **OLIST_ORDER_REVIEWS**
   - **"order_id"**: Links reviews to orders.
   - **"review_score"**: Score given by the customer (e.g., 5 for a 5-star rating).
   - **Potential Usage**: Count the number of 5-star ratings per seller.

5. **OLIST_SELLERS**
   - **"seller_id"**: Unique identifier for each seller.
   - **Potential Usage**: Reference seller details if needed.

### Conditions that May Be Used:

- **Filter for Delivered Orders**: `"order_status" = 'delivered'` from **OLIST_ORDERS**.
- **Join Conditions**:
  - **Orders to Order Items**: `t."order_id" = o."order_id"`.
  - **Order Items to Reviews**: `t."order_id" = r."order_id"`.

---

Now, here are **10 SQL queries** to explore and understand the values in these columns. Each query is different and helps in analyzing the data needed for the task.

```sql
-- 1. View the first 100 delivered orders
SELECT *
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS"
WHERE "order_status" = 'delivered'
LIMIT 100;

-- 2. Count the total number of delivered orders
SELECT COUNT(*) AS "total_delivered_orders"
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS"
WHERE "order_status" = 'delivered';

-- 3. List the top 100 sellers by number of orders in delivered orders
SELECT t."seller_id", COUNT(*) AS "number_of_orders"
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
  ON t."order_id" = o."order_id"
WHERE o."order_status" = 'delivered'
GROUP BY t."seller_id"
ORDER BY "number_of_orders" DESC
LIMIT 100;

-- 4. Calculate the total sales amount per seller in delivered orders
SELECT t."seller_id", SUM(t."price") AS "total_sales_amount"
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
  ON t."order_id" = o."order_id"
WHERE o."order_status" = 'delivered'
GROUP BY t."seller_id"
ORDER BY "total_sales_amount" DESC
LIMIT 100;

-- 5. List distinct customer IDs for each seller in delivered orders
SELECT DISTINCT t."seller_id", o."customer_id"
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
  ON t."order_id" = o."order_id"
WHERE o."order_status" = 'delivered'
LIMIT 100;

-- 6. Count the number of distinct customers per seller in delivered orders
SELECT t."seller_id", COUNT(DISTINCT o."customer_id") AS "distinct_customers"
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
  ON t."order_id" = o."order_id"
WHERE o."order_status" = 'delivered'
GROUP BY t."seller_id"
ORDER BY "distinct_customers" DESC
LIMIT 100;

-- 7. Find the sellers with most 5-star reviews in delivered orders
SELECT t."seller_id", COUNT(*) AS "five_star_reviews"
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_REVIEWS" r
  ON t."order_id" = r."order_id"
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
  ON t."order_id" = o."order_id"
WHERE r."review_score" = 5 AND o."order_status" = 'delivered'
GROUP BY t."seller_id"
ORDER BY "five_star_reviews" DESC
LIMIT 100;

-- 8. View the first 100 reviews with their scores and order IDs
SELECT *
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_REVIEWS"
LIMIT 100;

-- 9. Calculate the total profit per seller assuming profit is equal to price in delivered orders
SELECT t."seller_id", SUM(t."price") AS "total_profit"
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
  ON t."order_id" = o."order_id"
WHERE o."order_status" = 'delivered'
GROUP BY t."seller_id"
ORDER BY "total_profit" DESC
LIMIT 100;

-- 10. Get average review score per seller in delivered orders
SELECT t."seller_id", AVG(r."review_score") AS "average_review_score"
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_REVIEWS" r
  ON t."order_id" = r."order_id"
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
  ON t."order_id" = o."order_id"
WHERE o."order_status" = 'delivered'
GROUP BY t."seller_id"
ORDER BY "average_review_score" DESC
LIMIT 100;
```

**Notes on the Queries:**

- **Query 1**: Retrieves basic information on delivered orders to understand the dataset.
- **Query 2**: Counts the total number of delivered orders for context.
- **Query 3**: Identifies sellers with the most orders in delivered orders.
- **Query 4**: Calculates total sales amount per seller, which can be a proxy for profit if cost data is unavailable.
- **Query 5**: Lists distinct customer IDs associated with each seller.
- **Query 6**: Counts the number of distinct customers per seller.
- **Query 7**: Counts the number of 5-star reviews per seller.
- **Query 8**: Provides an overview of the reviews dataset.
- **Query 9**: Calculates total profit per seller, assuming profit equals the price (since cost data is not provided).
- **Query 10**: Calculates the average review score per seller.

These queries help in exploring the data and understanding how to extract the required metrics for each part of the task. By analyzing the results of these queries, you can identify the sellers who meet the criteria specified in the task.

---

**Please Note**: The actual data and results are required to identify the specific sellers and their corresponding values. The queries above are designed to help you retrieve and analyze the necessary information from the database.Query:
-- 1. View the first 100 delivered orders
SELECT *
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS"
WHERE "order_status" = 'delivered'
LIMIT 100
Answer:
Too long, hard cut:
order_id,customer_id,order_status,order_purchase_timestamp,order_approved_at,order_delivered_carrier_date,order_delivered_customer_date,order_estimated_delivery_date
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,delivered,2017-10-02 10:56:33,2017-10-02 11:07:15,2017-10-04 19:55:00,2017-10-10 21:25:13,2017-10-18 00:00:00
53cdb2fc8bc7dce0b6741e2150273451,b0830fb4747a6c6d20dea0b8c802d7ef,delivered,2018-07-24 20:41:37,2018-07-26 03:24:27,2018-07-26 14:31:00,2018-08-07 15:27:45,2018-08-13 00:00:00
47770eb9100c2d0c44946d9cf07ec65d,41ce2a54c0b03bf3443c3d931a367089,delivered,2018-08-08 08:38:49,2018-08-08 08:55:23,2018-08-08 13:50:00,2018-08-17 18:06:29,2018-09-04 00:00:00
949d5b44dbf5de918fe9c16f97b45f8a,f88197465ea7920adcdbec7375364d82,delivered,2017-11-18 19:28:06,2017-11-18 19:45:59,2017-11-22 13:39:59,2017-12-02 00:28:42,2017-12-15 00:00:00
ad21c59c0840e6cb83a9ceb5573f8159,8ab97904e6daea8866dbdbc4fb7aad2c,delivered,2018-02-13 21:18:39,2018-02-13 22:20:29,2018-02-14 19:46:34,2018-02-16 18:17:02,2018-02-26 00:00:00
a4591c265e18cb1dcee52889e2d8acc3,503740e9ca751ccdda7ba28e9ab8f608,delivered,2017-07-09 21:57:05,2017-07-09 22:10:13,2017-07-11 14:58:04,2017-07-26 10:57:55,2017-08-01 00:00:00
6514b8ad8028c9f2cc2374ded245783f,9bdf08b4b3b52b5526ff42d37d47f222,delivered,2017-05-16 13:10:30,2017-05-16 13:22:11,2017-05-22 10:07:46,2017-05-26 12:55:51,2017-06-07 00:00:00
76c6e866289321a7c93b82b54852dc33,f54a9f0e6b351c431402b8461ea51999,delivered,2017-01-23 18:29:09,2017-01-25 02:50:47,2017-01-26 14:16:31,2017-02-02 14:08:10,2017-03-06 00:00:00
e69bfb5eb88e0ed6a785585b27e16dbf,31ad1d1b63eb9962463f764d4e6e0c9d,delivered,2017-07-29 11:55:02,2017-07-29 12:05:32,2017-08-10 19:45:24,2017-08-16 17:14:30,2017-08-23 00:00:00
e6ce16cb79ec1d90b1da9085a6118aeb,494dded5b201313c64ed7f100595b95c,delivered,2017-05-16 19:41:10,2017-05-16 19:50:18,2017-05-18 11:40:40,2017-05-29 11:18:31,2017-06-07 00:00:00
34513ce0c4fab462a55830c0989c7edb,7711cf624183d843aafe81855097bc37,delivered,2017-07-13 19:58:11,2017-07-13 20:10:08,2017-07-14 18:43:29,2017-07-19 14:04:48,2017-08-08 00:00:00
82566a660a982b15fb86e904c8d32918,d3e3b74c766bc6214e0c830b17ee2341,delivered,2018-06-07 10:06:19,2018-06-09 03:13:12,2018-06-11 13:29:00,2018-06-19 12:05:52,2018-07-18 00:00:00
5ff96c15d0b717ac6ad1f3d77225a350,19402a48fe860416adf93348aba37740,delivered,2018-07-25 17:44:10,2018-07-25 17:55:14,2018-07-26 13:16:00,2018-07-30 15:52:25,2018-08-08 00:00:00
432aaf21d85167c2c86ec9448c4e42cc,3df704f53d3f1d4818840b34ec672a9f,delivered,2018-03-01 14:14:28,2018-03-01 15:10:47,2018-03-02 21:09:20,2018-03-12 23:36:26,2018-03-21 00:00:00
dcb36b511fcac050b97cd5c05de84dc3,3b6828a50ffe546942b7a473d70ac0fc,delivered,2018-06-07 19:03:12,2018-06-12 23:31:02,2018-06-11 14:54:00,2018-06-21 15:34:32,2018-07-04 00:00:00
403b97836b0c04a622354cf531062e5f,738b086814c6fcc74b8cc583f8516ee3,delivered,2018-01-02 19:00:43,2018-01-02 19:09:04,2018-01-03 18:19:09,2018-01-20 01:38:59,2018-02-06 00:00:00
116f0b09343b49556bbad5f35bee0cdf,3187789bec990987628d7a9beb4dd6ac,delivered,2017-12-26 23:41:31,2017-12-26 23:50:22,2017-12-28 18:33:05,2018-01-08 22:36:36,2018-01-29 00:00:00
85ce859fd6dc634de8d2f1e290444043,059f7fc5719c7da6cbafe370971a8d70,delivered,2017-11-21 00:03:41,2017-11-21 00:14:22,2017-11-23 21:32:26,2017-11-27 18:28:00,2017-12-11 00:00:00
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,delivered,2017-10-26 15:54:26,2017-10-26 16:08:14,2017-10-26 21:46:53,2017-11-08 22:22:00,2017-11-23 00:00:00
203096f03d82e0dffbc41ebc2e2bcfb7,d2b091571da224a1b36412c18bc3bbfe,delivered,2017-09-18 14:31:30,2017-09-19 04:04:09,2017-10-06 17:50:03,2017-10-09 22:23:46,2017-09-28 00:00:00
f848643eec1d69395095eb3840d2051e,4fa1cd166fa598be6de80fa84eaade43,delivered,2018-03-15 08:52:40,2018-03-15 09:09:31,2018-03-15 19:52:48,2018-03-19 18:08:32,2018-03-29 00:00:00
2807d0e504d6d4894d41672727bc139f,72ae281627a6102d9b3718528b420f8a,delivered,2018-02-03 20:37:35,2018-02-03 20:50:22,2018-02-05 22:37:28,2018-02-08 16:13:46,2018-02-21 00:00:00
95266dbfb7e20354baba07964dac78d5,a166da34890074091a942054b36e4265,delivered,2018-01-08 07:55:29,2018-01-08 08:07:31,2018-01-24 23:16:37,2018-01-26 17:32:38,2018-02-21 00:00:00
f3e7c359154d965827355f39d6b1fdac,62b423aab58096ca514ba6aa06be2f98,delivered,2018-08-09 11:44:40,2018-08-10 03:24:51,2018-08-10 12:29:00,2018-08-13 18:24:27,2018-08-17 00:00:00
fbf9ac61453ac646ce8ad9783d7d0af6,3a874b4d4c4b6543206ff5d89287f0c3,delivered,2018-02-20 23:46:53,2018-02-22 02:30:46,2018-02-26 22:25:22,2018-03-21 22:03:54,2018-03-12 00:00:00
acce194856392f074dbf9dada14d8d82,7e20bf5ca92da68200643bda76c504c6,delivered,2018-06-04 00:00:13,2018-06-05 00:35:10,2018-06-05 13:24:00,2018-06-16 15:20:55,2018-07-18 00:00:00
dd78f560c270f1909639c11b925620ea,8b212b9525f9e74e85e37ed6df37693e,delivered,2018-03-12 01:50:26,2018-03-12 03:28:34,2018-03-12 21:06:37,2018-03-21 14:41:50,2018-03-28 00:00:00
91b2a010e1e45e6ba3d133fa997597be,cce89a605105b148387c52e286ac8335,delivered,2018-0
Query:
-- 2. Count the total number of delivered orders
SELECT COUNT(*) AS "total_delivered_orders"
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS"
WHERE "order_status" = 'delivered'
Answer:
total_delivered_orders
96478
Query:
-- 3. List the top 100 sellers by number of orders in delivered orders
SELECT t."seller_id", COUNT(*) AS "number_of_orders"
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
  ON t."order_id" = o."order_id"
WHERE o."order_status" = 'delivered'
GROUP BY t."seller_id"
ORDER BY "number_of_orders" DESC
LIMIT 100
Answer:
seller_id,number_of_orders
6560211a19b47992c3666cc44a7e94c0,1996
4a3ca9315b744ce9f8e9374361493884,1949
1f50f920176fa81dab994f9023523100,1926
cc419e0650a3c5ba77189a1882b7556a,1719
da8622b14eb17ae2831f4ac5b9dab84a,1548
955fee9216a65b617aa5c0531780ce60,1472
1025f0e2d44d7041d6cf58b6550e0bfa,1420
7c67e1448b00f6e969d365cea6b010ab,1355
ea8482cd71df3c1969d7b9473ff13abc,1188
7a67c85e85bb2ce8582c35f2203ad736,1155
4869f7a5dfa277a7dca6462dcf3b52b2,1148
3d871de0142ce09b7081e2b9d1733cb1,1131
8b321bb669392f5163d04c59e235e066,1005
cca3071e3e9bb7d12640c9fbe2301306,817
620c87c171fb2a6dd6e8bb4dec959fc6,778
a1043bafd471dff536d0c462352beb48,752
e9779976487b77c6d4ac45f75ec7afe9,738
f8db351d8c4c4c22c6835c19a46f01b0,714
d2374cbcbb3ca4ab1086534108cc3ab7,620
391fc6631aebcf3004804e51b40bcf1e,605
fa1c13f2614d7b5c4749cbc52fecda94,579
7d13fca15225358621be4086e1eb0964,571
128639473a139ac0f3e5f5ade55873a5,554
1835b56ce799e6a4dc4eddc053f04066,551
d91fb3b7d041e83b64a00a3edfb37e4f,525
1900267e848ceeba8fa32d80c1a5f5a8,523
46dc3b2cc0980fb8ec44634e21d2718e,523
85d9eb9ddc5d00ca9336a2219c97bb13,512
53e4c6e0f4312d4d2107a8c9cddf45cd,512
4e922959ae960d389249c378d1c939f5,446
8581055ce74af1daba164fdbd55a40de,427
9f505651f4a6abe901a56cdc21508025,426
8160255418d5aaa7dbdc9f4c64ebda44,424
218d46b86c1881d022bce9c68a7d4b15,420
2138ccb85b11a4ec1e37afbd1c8eda1f,419
dbc22125167c298ef99da25668e1011f,417
897060da8b9a21f655304d50fd935913,413
16090f2ca825584b5a147ab24aa30c86,406
06a2c3af7b3aee5d69171b0e14f0ee87,402
53243585a1d6dc2643021fd1853d8905,400
4d6d651bd7684af3fffabd5f08d12e5a,389
77530e9772f57a62c906e1c21538ab82,381
de722cd6dad950a92b7d4f82673f8833,377
c826c40d7b19f62a09e2d7c5e7295ee2,365
92eb0f42c21942b6552362b9b114707d,358
7299e27ed73d2ad986de7f7c77d919fa,358
b2ba3715d723d245138f291a6fe42594,350
5dceca129747e92ff8ef7a997dc4f8ca,343
4c2b230173bb36f9b240f2b8ac11786e,343
87142160b41353c4e5fca2360caf6f92,339
fa40cc5b934574b62717c68f3d678b6d,337
c70c1b0d8ca86052f45a432a38b73958,336
7ddcbb64b5bc1ef36ca8c151f6ec77df,334
ef506c96320abeedfb894c34db06f478,332
7142540dd4c91e2237acb7e911c4eba2,328
1da3aeb70d7989d1e6d9b0e887f97c23,324
634964b17796e64304cadf1ad3050fb7,323
70a12e78e608ac31179aea7f8422044b,323
7e93a43ef30c4f03f38b393420bc753a,322
855668e0971d4dfd7bef1b6a4133b41b,311
c3cfdc648177fdbbbb35635a37472c53,307
fe2032dab1a61af8794248c8196565c9,305
88460e8ebdecbfecb5f9601833981930,300
37be5a7c751166fbc5f8ccba4119e043,278
1554a68530182680ad5c8b042c3ab563,267
25c5c91f63607446a97b143d2d535d31,266
562fc2f2c2863ab7e79a9e4388a58a14,265
0ea22c1cfbdc755f86b9b54b39c16043,265
e9bc59e7b60fc3063eb2290deda4cced,260
a3a38f4affed601eb87a97788c949667,260
17e34d8224d27a541263c4c64b11a56b,260
e5a3438891c0bfdb9394643f95273d8e,247
0241d4d5d36f10f80c644447315af0bd,246
dc4a0fc896dc34b0d5bfec8438291c80,242
c3867b4666c7d76867627c2f7fb22e21,241
d1c281d3ae149232351cd8c8cc885f0d,239
37515688008a7a40ac93e3b2e4ab203f,239
7aa4334be125fcdd2ba64b3180029f14,237
001cca7ae9ae17fb1caed9dfb1094831,234
f457c46070d02cadd8a68551231220dd,230
f7ba60f8c3f99e7ee4042fdef03b70c4,229
8d956fec2e4337affcb520f56fd8cbfd,227
41b39e28db005d9731d9d485a83b4c38,223
7040e82f899a04d1b434b795a43b4617,223
4b9750c8ad28220fe6702d4ecb7c898f,221
9b013e03b2ab786505a1d3b5c0756754,220
1c129092bf23f28a5930387c980c0dfc,219
0c8380b62e38e8a1e6adbeba7eb9688c,218
6edacfd9f9074789dad6d62ba7950b9c,216
e26901d5ab434ce92fd9b5c256820a4e,215
7178f9f4dd81dcef02f62acdf8151e01,215
4830e40640734fc1c52cd21127c341d4,212
0b90b6df587eb83608a64ea8b390cf07,209
86ccac0b835037332a596a33b6949ee1,208
ceaec5548eefc6e23e6607c5435102e7,206
cab85505710c7cb9b720bceb52b01cee,204
f262cbc1c910c83959f849465454ddd3,204
54a1852d1b8f10312c55e906355666ee,202
9c0e69c7bf2619675bbadf47b43f655a,200
c003204e1ab016dfa150abc119207b24,200
Query:
-- 4. Calculate the total sales amount per seller in delivered orders
SELECT t."seller_id", SUM(t."price") AS "total_sales_amount"
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
  ON t."order_id" = o."order_id"
WHERE o."order_status" = 'delivered'
GROUP BY t."seller_id"
ORDER BY "total_sales_amount" DESC
LIMIT 100
Answer:
seller_id,total_sales_amount
4869f7a5dfa277a7dca6462dcf3b52b2,226987.93
53243585a1d6dc2643021fd1853d8905,217940.44
4a3ca9315b744ce9f8e9374361493884,196882.12
fa1c13f2614d7b5c4749cbc52fecda94,190917.13999999998
7c67e1448b00f6e969d365cea6b010ab,186570.05
7e93a43ef30c4f03f38b393420bc753a,165981.49
da8622b14eb17ae2831f4ac5b9dab84a,159816.87
7a67c85e85bb2ce8582c35f2203ad736,139658.69
1025f0e2d44d7041d6cf58b6550e0bfa,138208.56
955fee9216a65b617aa5c0531780ce60,131836.71
46dc3b2cc0980fb8ec44634e21d2718e,122811.38
6560211a19b47992c3666cc44a7e94c0,120702.83
620c87c171fb2a6dd6e8bb4dec959fc6,112461.5
7d13fca15225358621be4086e1eb0964,112436.18000000001
5dceca129747e92ff8ef7a997dc4f8ca,111126.73
1f50f920176fa81dab994f9023523100,106655.70999999999
cc419e0650a3c5ba77189a1882b7556a,101090.95999999999
a1043bafd471dff536d0c462352beb48,99309.23
3d871de0142ce09b7081e2b9d1733cb1,93407.4
edb1ef5e36e0c8cd84eb3c9b003e486d,79144.9
ccc4bbb5f32a6ab2b7066a4130f114e3,72926.72
f7ba60f8c3f99e7ee4042fdef03b70c4,68070.0
fe2032dab1a61af8794248c8196565c9,65689.71
8581055ce74af1daba164fdbd55a40de,64011.22
cca3071e3e9bb7d12640c9fbe2301306,63035.16
04308b1ee57b6625f47df1d56f00eedf,58991.8
522620dcb18a6b31cd7bdf73665113a9,56690.49
de722cd6dad950a92b7d4f82673f8833,55126.3
37be5a7c751166fbc5f8ccba4119e043,54735.55
17e34d8224d27a541263c4c64b11a56b,54440.28
7ddcbb64b5bc1ef36ca8c151f6ec77df,54435.66
25c5c91f63607446a97b143d2d535d31,54208.78
218d46b86c1881d022bce9c68a7d4b15,53710.3
ceaec5548eefc6e23e6607c5435102e7,51478.18
f5a590cf36251cf1162ea35bef76fe84,51232.78
e882b2a25a10b9c057cc49695f222c19,51057.54
2bf6a2c1e71bbd29a4ad64e6d3c3629f,50628.9
f8db351d8c4c4c22c6835c19a46f01b0,50082.6
b2ba3715d723d245138f291a6fe42594,49302.18
17f51e7198701186712e53a39c564617,48019.0
8160255418d5aaa7dbdc9f4c64ebda44,46368.39
966cb4760537b1404caedd472cc610a5,45928.26
77530e9772f57a62c906e1c21538ab82,45676.6
4e922959ae960d389249c378d1c939f5,45338.42
850f4f8af5ea87287ac68de36e29107f,45285.37
c826c40d7b19f62a09e2d7c5e7295ee2,44653.04
b33e7c55446eabf8fe1a42d037ac7d6d,44215.17
ba90964cff9b9e0e6f32b23b82465f7b,44212.5
eeb6de78f79159600292e314a77cbd18,43510.84
c3cfdc648177fdbbbb35635a37472c53,43048.18
4d6d651bd7684af3fffabd5f08d12e5a,42999.0
b839e41795b7f3ad94cc2014a52f6796,42829.0
e9779976487b77c6d4ac45f75ec7afe9,42229.69
17a053fcb14bd219540cbde0df490be0,40353.24
d91fb3b7d041e83b64a00a3edfb37e4f,39926.39
834f3294fba9f932f56edc879193f925,39907.5
391fc6631aebcf3004804e51b40bcf1e,39475.3
712e6ed8aa4aa1fa65dab41fed5737e4,39385.0
634964b17796e64304cadf1ad3050fb7,39114.1
2eb70248d66e0e3ef83659f71b244378,38990.72
7142540dd4c91e2237acb7e911c4eba2,37181.94
7178f9f4dd81dcef02f62acdf8151e01,36795.4
ea8482cd71df3c1969d7b9473ff13abc,36696.76
59417c56835dd8e2e72f91f809cd4092,36459.0
c70c1b0d8ca86052f45a432a38b73958,36289.15
06a2c3af7b3aee5d69171b0e14f0ee87,36097.979999999996
c3867b4666c7d76867627c2f7fb22e21,34666.9
7299e27ed73d2ad986de7f7c77d919fa,34107.44
e9bc59e7b60fc3063eb2290deda4cced,33543.69
1835b56ce799e6a4dc4eddc053f04066,33005.32
5c243662ce92d84573bfaff24c3e3700,32862.02
dbc22125167c298ef99da25668e1011f,32829.12
9c0e69c7bf2619675bbadf47b43f655a,32720.4
2528513dd95219a6013d4d05176e391a,32660.2
76d5af76d0271110f9af36c92573f765,31944.6
70eea00b476a314817cefde4aad4f89a,31424.75
0241d4d5d36f10f80c644447315af0bd,31397.7
88460e8ebdecbfecb5f9601833981930,31320.4
7681ef142fd2c19048da7430856b5588,31211.81
87142160b41353c4e5fca2360caf6f92,31095.98
855668e0971d4dfd7bef1b6a4133b41b,30849.22
e59aa562b9f8076dd550fcddf0e73491,30716.3
70a12e78e608ac31179aea7f8422044b,29963.53
53e4c6e0f4312d4d2107a8c9cddf45cd,29587.77
d23019c84ffae2d5ef2270367b8605fc,29205.1
1554a68530182680ad5c8b042c3ab563,28979.64
900ba814c251a692506d7834c1218441,28833.03
0b90b6df587eb83608a64ea8b390cf07,28492.76
59b22a78efb79a4797979612b885db36,27184.5
d1c281d3ae149232351cd8c8cc885f0d,26833.61
b32be1695eb7ec5f10f72d9610a12527,26575.0
12b9676b00f60f3b700e83af21824c0e,26376.0
a3a38f4affed601eb87a97788c949667,26294.62
7e1fb0a3ebfb01ffb3a7dae98bf3238d,26169.53
de23c3b98a88888289c6f5cc1209054a,25933.670000000002
9f505651f4a6abe901a56cdc21508025,25912.84
16090f2ca825584b5a147ab24aa30c86,25579.16
b94cc9f10ddc85e4ba73a6f7974e7101,25346.1
a416b6a846a11724393025641d4edd5e,24930.24
c003204e1ab016dfa150abc119207b24,24904.29
Query:
-- 5. List distinct customer IDs for each seller in delivered orders
SELECT DISTINCT t."seller_id", o."customer_id"
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
  ON t."order_id" = o."order_id"
WHERE o."order_status" = 'delivered'
LIMIT 100
Answer:
Too long, hard cut:
seller_id,customer_id
8602a61d680a10a82cceeeda0d99ea3d,6a899e55865de6549a58d2c6845e5604
530ec6109d11eaaf87999465c6afee01,2a30c97668e81df7c17a8b14447aeeba
fe2032dab1a61af8794248c8196565c9,fff5169e583fd07fac9fec88962f189d
8cbac7e12637ed9cffa18c7875207478,2b01d668726fb0b751c55918c0437b7b
ea8482cd71df3c1969d7b9473ff13abc,6a3b2fc9f270df258605e22bef19fd88
6560211a19b47992c3666cc44a7e94c0,2dfbf74859104caf100df3720a1d833d
ffc470761de7d0232558ba5e786e57b7,f4f17ada91ef010cbde3892ae54e625f
4a3ca9315b744ce9f8e9374361493884,48ed31e735f1c420ed6ca3637b7c744d
4a3ca9315b744ce9f8e9374361493884,698a74f33469466fa4172e829505d1c6
e8b4225284fbb02d16f200513f1f395d,ce0421a97232c2a1194cdb66cd3ebb9d
4869f7a5dfa277a7dca6462dcf3b52b2,1c1bfb2cd4aa789067295941c42120ff
ef506c96320abeedfb894c34db06f478,ab3642244247c0c638253fe68ee4c345
3db66a856d18a9cba7c9241fc5221c50,e3b91047e6ca3f5e8b656750fa3d61b2
c003204e1ab016dfa150abc119207b24,b6fbaad4eb3a0794111683dca8122610
1554a68530182680ad5c8b042c3ab563,f7277fce45fad3165379c15cacf5ddbe
ff063b022a9a0aab91bad2c9088760b7,9ec353f970bdf785f6568724d9ea19aa
fa40cc5b934574b62717c68f3d678b6d,75fd1fb0bb511fc71ac2b2649c02b21b
850f4f8af5ea87287ac68de36e29107f,c4e00400b6f79caa802740faa2829161
de23c3b98a88888289c6f5cc1209054a,727dc68f327d34b77009f5d3da5250d9
f8db351d8c4c4c22c6835c19a46f01b0,3ace63287bc8b41172016c06a5093808
ad273c9eb54ecb4532de4bf75bae9e4e,a2da04a295c890e30103aeb5356163f0
b1a81260566c1bac3114a6d124413f27,a5fd6dd86d703cedc9ab6be3dba12816
7c67e1448b00f6e969d365cea6b010ab,ea477083e770db0655938e79149f8c24
7e93a43ef30c4f03f38b393420bc753a,b4c4af6dbbbbafcfd8d6863fa0fc6e61
e59aa562b9f8076dd550fcddf0e73491,7b63cba66b8e6d002e94d0990c1e2868
a3e9a2c700480d9bb01fba070ba80a0e,efb3830adb68fb8a89c948774388ec28
0887a9f087bcd5d9f6642b52f897fc6c,630b8c2f4134e83812d827e8006caa85
70c27847eca8195c983ed7e798c56743,32b84239e3f3904ac162d832454770c7
f457c46070d02cadd8a68551231220dd,74454d0e51e0eeaaaa9b7b135469c420
38e6dada03429a47197d5d584d793b41,ae55e228ded796581eccc67045516023
729b2d09b2a0bdab221076327f13d050,6031cd91d182925af3d38ae9590e5afa
e38db885400cd35c71dfd162f2c1dbcf,e5c49220ea97eddff8b1fbb594913a43
cc419e0650a3c5ba77189a1882b7556a,6dc7d8b1ac961fe9d43edb6ecadd5f10
bd0389da23d89b726abf911cccc54596,bd8d067426b640b65c68dd3ee6c71d46
218d46b86c1881d022bce9c68a7d4b15,03ed7b1b35f2e55b0f4d0b9e4e07b0c3
0dd184061fb0eaa7ca37932c68ab91c5,cbde8134b8a718381d08167dfc58ec8c
a1043bafd471dff536d0c462352beb48,3747cfcc18da3cff44fd440770d92d97
6560211a19b47992c3666cc44a7e94c0,d7165639dc4a682258711343560a17d3
5b67882648febfb6e1225e6ad7164f6b,26355ea90aab63ebf5e90caa825a943d
cea729054f157f5870bdd321a958d994,5c94f28f54aa13e14aaf67039511f318
4c03b9dd4c11ee2cb35c96c49efc9420,399d1e628c48b7c3b6389098be566cfd
f8db351d8c4c4c22c6835c19a46f01b0,7887f43daaa91055f85b6dd23cccdfcb
2138ccb85b11a4ec1e37afbd1c8eda1f,fd967f807427c24072652b1f62d4fe47
391fc6631aebcf3004804e51b40bcf1e,2b27fae969b7d2bc173e466a742e50c6
9f505651f4a6abe901a56cdc21508025,1c34888248845ed3c9607a2652adad9c
c864036feaab8c1659f65ea4faebe1da,7dd2e283f47deac853cf70f3b63c8d86
1c129092bf23f28a5930387c980c0dfc,98884e672c5ba85f4394f2044e1a3eab
99eaacc9e6046db1c82b163c5f84869f,a12427487c970a4a75dbeb5884f126a8
8e6d7754bc7e0f22c96d255ebda59eba,cca819156e50623e9d3762ebeee308dc
3d871de0142ce09b7081e2b9d1733cb1,6081c7acb40f63731b3c982857c79581
5656537e588803a555b8eb41f07a944b,e0dc8ea464de23db3b4aa5fa6ae07cc3
afa6714acee029b2dfdf357e5579cc03,d63e92aea6fb367972e3cc4f232a1976
7d13fca15225358621be4086e1eb0964,afc13494642f88d253be56a1e353e261
53e4c6e0f4312d4d2107a8c9cddf45cd,f40f31f8bfcc5f74d9d246354b90af09
ca3bd7cd9f149df75950150d010fe4a2,299735fa1daa3e83ee1048309d22f9da
b4f8921fcc4ff77b66bea6dda43dcd51,e8a101d3de305ff620d4febe10137fd0
c9c7905cffc4ef9ff9f113554423e671,892522b67acfcb855f3feba4cff78050
855668e0971d4dfd7bef1b6a4133b41b,f418fa622ecaa0dc1bc8524446faf6fd
bd4889b5e9133b35b66e42a8665cea5c,39851c46815f49fafb7bc26ed6bf513d
48436dade18ac8b2bce089ec2a041202,62b59a64eb786a96516229b7f3612c72
1025f0e2d44d7041d6cf58b6550e0bfa,7f340a499d079212d76e5a57f5d42389
46dc3b2cc0980fb8ec44634e21d2718e,bdbdcd5b18193390b025df518afe94ba
46dc3b2cc0980fb8ec44634e21d2718e,43bb6f9650ab2a7e6ef1c93168c4cfcf
c3cfdc648177fdbbbb35635a37472c53,655418b3cc52d17ccb5b4330a7f03197
7008613ea464bad5cb9b83456e1e6a8f,3c3472f5efc17888458e428b0b9eeef3
7c67e1448b00f6e969d365cea6b010ab,86ade8ebc14f18dd6c3ea75bd0eb7534
955fee9216a65b617aa5c0531780ce60,2430ad4b1b6efb56cf3050b5d3cf5e54
8444e55c1f13cd5c179851e5ca5ebd00,c8c4991d84dbfef1f61c6152486db6d4
218d46b86c1881d022bce9c68a7d4b15,f3476df115c5d26bdb6bfb71b5fb66af
06a2c3af7b3aee5d69171b0e14f0ee87,8c66482ec333eae596c93a9131981a9a
c70c1b0d8ca86052f45a432a38b73958,7ddb7e4242fcc518842aade22f5bee4d
3d871de0142ce09b7081e2b9d1733cb1,e600c255f682a86dfd0c57d3b1d7417b
7a67c85e85bb2ce8582c35f2203ad736,176a76443d14508cc976f1d84a44921d
e9bc59e7b60fc3063eb2290deda4cced,0f2a7baf176f693c27c891360da9ef2c
7d13fca15225358621be4086e1eb0964,1aac2b5adf8aec2c00fe67d06aa8ebc2
688756f717c462a206ad854c5027
Query:
-- 6. Count the number of distinct customers per seller in delivered orders
SELECT t."seller_id", COUNT(DISTINCT o."customer_id") AS "distinct_customers"
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
  ON t."order_id" = o."order_id"
WHERE o."order_status" = 'delivered'
GROUP BY t."seller_id"
ORDER BY "distinct_customers" DESC
LIMIT 100
Answer:
seller_id,distinct_customers
6560211a19b47992c3666cc44a7e94c0,1819
4a3ca9315b744ce9f8e9374361493884,1772
cc419e0650a3c5ba77189a1882b7556a,1651
1f50f920176fa81dab994f9023523100,1399
da8622b14eb17ae2831f4ac5b9dab84a,1311
955fee9216a65b617aa5c0531780ce60,1261
7a67c85e85bb2ce8582c35f2203ad736,1145
ea8482cd71df3c1969d7b9473ff13abc,1132
4869f7a5dfa277a7dca6462dcf3b52b2,1124
3d871de0142ce09b7081e2b9d1733cb1,1064
7c67e1448b00f6e969d365cea6b010ab,973
8b321bb669392f5163d04c59e235e066,930
1025f0e2d44d7041d6cf58b6550e0bfa,910
620c87c171fb2a6dd6e8bb4dec959fc6,722
a1043bafd471dff536d0c462352beb48,702
cca3071e3e9bb7d12640c9fbe2301306,699
f8db351d8c4c4c22c6835c19a46f01b0,659
e9779976487b77c6d4ac45f75ec7afe9,645
fa1c13f2614d7b5c4749cbc52fecda94,578
7d13fca15225358621be4086e1eb0964,558
128639473a139ac0f3e5f5ade55873a5,527
d91fb3b7d041e83b64a00a3edfb37e4f,524
391fc6631aebcf3004804e51b40bcf1e,521
d2374cbcbb3ca4ab1086534108cc3ab7,514
46dc3b2cc0980fb8ec44634e21d2718e,503
85d9eb9ddc5d00ca9336a2219c97bb13,499
53e4c6e0f4312d4d2107a8c9cddf45cd,463
1835b56ce799e6a4dc4eddc053f04066,417
4e922959ae960d389249c378d1c939f5,412
1900267e848ceeba8fa32d80c1a5f5a8,406
16090f2ca825584b5a147ab24aa30c86,398
dbc22125167c298ef99da25668e1011f,394
9f505651f4a6abe901a56cdc21508025,393
06a2c3af7b3aee5d69171b0e14f0ee87,389
2138ccb85b11a4ec1e37afbd1c8eda1f,388
218d46b86c1881d022bce9c68a7d4b15,382
8160255418d5aaa7dbdc9f4c64ebda44,380
8581055ce74af1daba164fdbd55a40de,380
4d6d651bd7684af3fffabd5f08d12e5a,363
53243585a1d6dc2643021fd1853d8905,348
c826c40d7b19f62a09e2d7c5e7295ee2,346
de722cd6dad950a92b7d4f82673f8833,337
7299e27ed73d2ad986de7f7c77d919fa,335
92eb0f42c21942b6552362b9b114707d,334
7ddcbb64b5bc1ef36ca8c151f6ec77df,325
b2ba3715d723d245138f291a6fe42594,324
5dceca129747e92ff8ef7a997dc4f8ca,322
7e93a43ef30c4f03f38b393420bc753a,319
7142540dd4c91e2237acb7e911c4eba2,316
ef506c96320abeedfb894c34db06f478,316
70a12e78e608ac31179aea7f8422044b,312
77530e9772f57a62c906e1c21538ab82,312
87142160b41353c4e5fca2360caf6f92,305
897060da8b9a21f655304d50fd935913,304
fa40cc5b934574b62717c68f3d678b6d,304
855668e0971d4dfd7bef1b6a4133b41b,300
fe2032dab1a61af8794248c8196565c9,293
c3cfdc648177fdbbbb35635a37472c53,278
37be5a7c751166fbc5f8ccba4119e043,269
634964b17796e64304cadf1ad3050fb7,265
1da3aeb70d7989d1e6d9b0e887f97c23,261
c70c1b0d8ca86052f45a432a38b73958,260
4c2b230173bb36f9b240f2b8ac11786e,258
562fc2f2c2863ab7e79a9e4388a58a14,255
a3a38f4affed601eb87a97788c949667,251
17e34d8224d27a541263c4c64b11a56b,247
88460e8ebdecbfecb5f9601833981930,246
1554a68530182680ad5c8b042c3ab563,246
0241d4d5d36f10f80c644447315af0bd,238
0ea22c1cfbdc755f86b9b54b39c16043,234
c3867b4666c7d76867627c2f7fb22e21,228
37515688008a7a40ac93e3b2e4ab203f,227
dc4a0fc896dc34b0d5bfec8438291c80,225
f7ba60f8c3f99e7ee4042fdef03b70c4,218
4b9750c8ad28220fe6702d4ecb7c898f,217
e5a3438891c0bfdb9394643f95273d8e,216
d1c281d3ae149232351cd8c8cc885f0d,214
7aa4334be125fcdd2ba64b3180029f14,214
8d956fec2e4337affcb520f56fd8cbfd,210
e9bc59e7b60fc3063eb2290deda4cced,209
7040e82f899a04d1b434b795a43b4617,208
6edacfd9f9074789dad6d62ba7950b9c,205
4830e40640734fc1c52cd21127c341d4,204
7178f9f4dd81dcef02f62acdf8151e01,202
cab85505710c7cb9b720bceb52b01cee,201
1c129092bf23f28a5930387c980c0dfc,200
ceaec5548eefc6e23e6607c5435102e7,198
54a1852d1b8f10312c55e906355666ee,198
e26901d5ab434ce92fd9b5c256820a4e,197
c003204e1ab016dfa150abc119207b24,195
f457c46070d02cadd8a68551231220dd,195
001cca7ae9ae17fb1caed9dfb1094831,195
f262cbc1c910c83959f849465454ddd3,189
2eb70248d66e0e3ef83659f71b244378,187
41b39e28db005d9731d9d485a83b4c38,187
850f4f8af5ea87287ac68de36e29107f,186
f45122a9ab94eb4f3f8953578bc0c560,184
ccc4bbb5f32a6ab2b7066a4130f114e3,184
0c8380b62e38e8a1e6adbeba7eb9688c,180
86ccac0b835037332a596a33b6949ee1,178
Query:
-- 7. Find the sellers with most 5-star reviews in delivered orders
SELECT t."seller_id", COUNT(*) AS "five_star_reviews"
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_REVIEWS" r
  ON t."order_id" = r."order_id"
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
  ON t."order_id" = o."order_id"
WHERE r."review_score" = 5 AND o."order_status" = 'delivered'
GROUP BY t."seller_id"
ORDER BY "five_star_reviews" DESC
LIMIT 100
Answer:
seller_id,five_star_reviews
1f50f920176fa81dab994f9023523100,1096
cc419e0650a3c5ba77189a1882b7556a,1050
6560211a19b47992c3666cc44a7e94c0,1023
4a3ca9315b744ce9f8e9374361493884,941
da8622b14eb17ae2831f4ac5b9dab84a,893
955fee9216a65b617aa5c0531780ce60,800
1025f0e2d44d7041d6cf58b6550e0bfa,729
7a67c85e85bb2ce8582c35f2203ad736,717
4869f7a5dfa277a7dca6462dcf3b52b2,683
3d871de0142ce09b7081e2b9d1733cb1,632
ea8482cd71df3c1969d7b9473ff13abc,617
8b321bb669392f5163d04c59e235e066,551
620c87c171fb2a6dd6e8bb4dec959fc6,523
a1043bafd471dff536d0c462352beb48,452
e9779976487b77c6d4ac45f75ec7afe9,450
7c67e1448b00f6e969d365cea6b010ab,436
f8db351d8c4c4c22c6835c19a46f01b0,428
cca3071e3e9bb7d12640c9fbe2301306,424
fa1c13f2614d7b5c4749cbc52fecda94,394
46dc3b2cc0980fb8ec44634e21d2718e,332
d91fb3b7d041e83b64a00a3edfb37e4f,330
391fc6631aebcf3004804e51b40bcf1e,320
7d13fca15225358621be4086e1eb0964,319
128639473a139ac0f3e5f5ade55873a5,318
53e4c6e0f4312d4d2107a8c9cddf45cd,295
85d9eb9ddc5d00ca9336a2219c97bb13,288
d2374cbcbb3ca4ab1086534108cc3ab7,287
9f505651f4a6abe901a56cdc21508025,284
8581055ce74af1daba164fdbd55a40de,273
1900267e848ceeba8fa32d80c1a5f5a8,272
dbc22125167c298ef99da25668e1011f,256
218d46b86c1881d022bce9c68a7d4b15,251
7299e27ed73d2ad986de7f7c77d919fa,247
fa40cc5b934574b62717c68f3d678b6d,246
1835b56ce799e6a4dc4eddc053f04066,245
4d6d651bd7684af3fffabd5f08d12e5a,240
4e922959ae960d389249c378d1c939f5,235
c3cfdc648177fdbbbb35635a37472c53,231
c70c1b0d8ca86052f45a432a38b73958,230
77530e9772f57a62c906e1c21538ab82,227
2138ccb85b11a4ec1e37afbd1c8eda1f,223
06a2c3af7b3aee5d69171b0e14f0ee87,218
87142160b41353c4e5fca2360caf6f92,217
16090f2ca825584b5a147ab24aa30c86,216
de722cd6dad950a92b7d4f82673f8833,215
c826c40d7b19f62a09e2d7c5e7295ee2,213
7e93a43ef30c4f03f38b393420bc753a,213
b2ba3715d723d245138f291a6fe42594,211
fe2032dab1a61af8794248c8196565c9,210
53243585a1d6dc2643021fd1853d8905,209
8160255418d5aaa7dbdc9f4c64ebda44,206
5dceca129747e92ff8ef7a997dc4f8ca,199
1da3aeb70d7989d1e6d9b0e887f97c23,191
92eb0f42c21942b6552362b9b114707d,182
7ddcbb64b5bc1ef36ca8c151f6ec77df,178
a3a38f4affed601eb87a97788c949667,178
0ea22c1cfbdc755f86b9b54b39c16043,177
4c2b230173bb36f9b240f2b8ac11786e,176
1554a68530182680ad5c8b042c3ab563,174
37be5a7c751166fbc5f8ccba4119e043,170
ef506c96320abeedfb894c34db06f478,170
7142540dd4c91e2237acb7e911c4eba2,167
634964b17796e64304cadf1ad3050fb7,166
0241d4d5d36f10f80c644447315af0bd,164
897060da8b9a21f655304d50fd935913,163
17e34d8224d27a541263c4c64b11a56b,157
855668e0971d4dfd7bef1b6a4133b41b,157
562fc2f2c2863ab7e79a9e4388a58a14,155
70a12e78e608ac31179aea7f8422044b,154
6edacfd9f9074789dad6d62ba7950b9c,153
e9bc59e7b60fc3063eb2290deda4cced,150
41b39e28db005d9731d9d485a83b4c38,147
4b9750c8ad28220fe6702d4ecb7c898f,143
c3867b4666c7d76867627c2f7fb22e21,141
7aa4334be125fcdd2ba64b3180029f14,138
e5a3438891c0bfdb9394643f95273d8e,137
f7ba60f8c3f99e7ee4042fdef03b70c4,137
54a1852d1b8f10312c55e906355666ee,134
c003204e1ab016dfa150abc119207b24,132
1c129092bf23f28a5930387c980c0dfc,132
8d956fec2e4337affcb520f56fd8cbfd,130
0b90b6df587eb83608a64ea8b390cf07,128
9b013e03b2ab786505a1d3b5c0756754,127
4830e40640734fc1c52cd21127c341d4,126
37515688008a7a40ac93e3b2e4ab203f,125
ccc4bbb5f32a6ab2b7066a4130f114e3,124
edb1ef5e36e0c8cd84eb3c9b003e486d,123
d1c281d3ae149232351cd8c8cc885f0d,123
a416b6a846a11724393025641d4edd5e,122
cab85505710c7cb9b720bceb52b01cee,122
f262cbc1c910c83959f849465454ddd3,122
001cca7ae9ae17fb1caed9dfb1094831,121
ceaec5548eefc6e23e6607c5435102e7,120
0c8380b62e38e8a1e6adbeba7eb9688c,120
25c5c91f63607446a97b143d2d535d31,119
7178f9f4dd81dcef02f62acdf8151e01,119
dc4a0fc896dc34b0d5bfec8438291c80,118
88460e8ebdecbfecb5f9601833981930,118
98dac6635aee4995d501a3972e047414,118
f457c46070d02cadd8a68551231220dd,117
Query:
-- 8. View the first 100 reviews with their scores and order IDs
SELECT *
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_REVIEWS"
LIMIT 100
Answer:
Too long, hard cut:
review_id,order_id,review_score,review_comment_title,review_comment_message,review_creation_date,review_answer_timestamp
7bc2406110b926393aa56f80a40eba40,73fc7af87114b39712e6da79b0a377eb,4,,,2018-01-18 00:00:00,2018-01-18 21:46:59
80e641a11e56f04c1ad469d5645fdfde,a548910a1c6147796b98fdf73dbeba33,5,,,2018-03-10 00:00:00,2018-03-11 03:05:13
228ce5500dc1d8e020d8d1322874b6f0,f9e4b658b201a9f2ecdecbb34bed034b,5,,,2018-02-17 00:00:00,2018-02-18 14:36:24
e64fb393e7b32834bb789ff8bb30750e,658677c97b385a9be170737859d3511b,5,,Recebi bem antes do prazo estipulado.,2017-04-21 00:00:00,2017-04-21 22:02:06
f7c4243c7fe1938f181bec41a392bdeb,8e6bfb81e283fa7e4f11123a3fb894f1,5,,Parabéns lojas lannister adorei comprar pela Internet seguro e prático Parabéns a todos feliz Páscoa,2018-03-01 00:00:00,2018-03-02 10:26:53
15197aa66ff4d0650b5434f1b46cda19,b18dcdf73be66366873cd26c5724d1dc,1,,,2018-04-13 00:00:00,2018-04-16 00:39:37
07f9bee5d1b850860defd761afa7ff16,e48aa0d2dcec3a2e87348811bcfdf22b,5,,,2017-07-16 00:00:00,2017-07-18 19:30:34
7c6400515c67679fbee952a7525281ef,c31a859e34e3adac22f376954e19b39d,5,,,2018-08-14 00:00:00,2018-08-14 21:36:06
a3f6f7f6f433de0aefbb97da197c554c,9c214ac970e84273583ab523dfafd09b,5,,,2017-05-17 00:00:00,2017-05-18 12:05:37
8670d52e15e00043ae7de4c01cc2fe06,b9bf720beb4ab3728760088589c62129,4,recomendo,aparelho eficiente. no site a marca do aparelho esta impresso como 3desinfector e ao chegar esta com outro nome...atualizar com a marca correta uma vez que é o mesmo aparelho,2018-05-22 00:00:00,2018-05-23 16:45:47
c9cfd2d5ab5911836ababae136c3a10c,cdf9aa68e72324eeb25c7de974696ee2,5,,,2017-12-23 00:00:00,2017-12-26 14:36:03
96052551d87e5f62e6c9f6974ec392e9,3d374c9e46530bb5ed4a7648915306a6,5,,,2017-12-19 00:00:00,2017-12-20 10:25:22
4b49719c8a200003f700d3d986ea1a19,9d6f15f95d01e79bd1349cc208361f09,4,,"Mas um pouco ,travando...pelo valor ta Boa.
",2018-02-16 00:00:00,2018-02-20 10:52:22
23f75a37effc35d9a915b4e1ad483793,2eaf8e099d871cd5c22b83b5ea8f6e0e,4,,,2018-03-28 00:00:00,2018-03-30 15:10:55
9a0abbb668bafb95a6d2b05db43284c4,d7bd0e4afdf94846eb73642b4e3e75c3,3,,,2017-04-30 00:00:00,2017-05-03 00:02:22
3948b09f7c818e2d86c9a546758b2335,e51478e7e277a83743b6f9991dbfa3fb,5,Super recomendo,"Vendedor confiável, produto ok e entrega antes do prazo.",2018-05-23 00:00:00,2018-05-24 03:00:01
9314d6f9799f5bfba510cc7bcd468c01,0dacf04c5ad59fd5a0cc1faa07c34e39,2,,"GOSTARIA DE SABER O QUE HOUVE, SEMPRE RECEBI E ESSA COMPRA AGORA ME DECPCIONOU",2018-01-18 00:00:00,2018-01-20 21:25:45
8e15a274d95600fa14f8be64e37a0e67,ff1581e08b3011021e7c7de592ddc81e,5,,,2018-03-24 00:00:00,2018-03-26 15:58:32
fdbdb2629a7cde0f66657acc92084e7f,70a752414a13d09cc1f2b437b914b28e,3,,,2017-09-29 00:00:00,2017-10-02 01:12:49
373cbeecea8286a2b66c97b1b157ec46,583174fbe37d3d5f0d6661be3aad1786,1,Não chegou meu produto ,Péssimo,2018-08-15 00:00:00,2018-08-15 04:10:37
a2ff510ca4e059c3fefc7a7866571f6f,a9953b2f0b1665ac7586cc5a6ac8f58c,4,,,2017-10-06 00:00:00,2017-10-08 22:36:05
80c70bc263881ba6525f6cee1d94ac87,ae168dfba236919411fe08f336fefa44,5,,,2018-03-17 00:00:00,2018-04-04 19:41:11
d21bbc789670eab777d27372ab9094cc,4fc44d78867142c627497b60a7e0228a,5,Ótimo,Loja nota 10,2018-07-10 00:00:00,2018-07-11 14:10:25
7bcb3c758c67f23638262c731493e848,7c9956750739a47dba7a6928ba2f0245,5,,,2017-09-09 00:00:00,2017-10-17 02:25:47
0e0190b9db53b689b285d3f3916f8441,79832b7cb59ac6f887088ffd686e1d5e,5,,obrigado pela atençao amim dispensada,2017-12-01 00:00:00,2017-12-09 22:58:58
66e4430c5bc6b7e3773886bf1c14d912,84cec4f65c7a4f2f54c294a30224a594,5,,,2017-06-23 00:00:00,2017-06-27 00:52:02
bf566b3910c328733baf7fca7d2be041,a59a15e4b6085c752d338431dc68d464,4,,,2017-11-01 00:00:00,2017-11-01 20:25:30
fe3db7c069d694bab50cc43463f91608,2ca73e2ff9e3a186ad1e1ffb9b1d9c10,5,,"A compra foi realizada facilmente.
A entrega foi efetuada muito antes do prazo dado.
O produto já começou a ser usado e até o presente,
sem problemas.",2018-03-23 00:00:00,2018-04-01 00:27:51
e07eee7ad7666276bd8b27fbd83fd1ff,68b3cbc68e4cd1fe19bec35f1d3bb7ee,5,,relógio muito bonito e barato.,2018-03-29 00:00:00,2018-04-02 14:19:31
2c5e27fc178bde7ac173c9c62c31b070,0ce9a24111d850192a933fcaab6fbad3,1,,Não gostei ! Comprei gato por lebre,2017-12-13 00:00:00,2017-12-16 07:14:07
540e7bbb2d06cfb7f85f3a88ba7ac97f,cf73e2cb1f4a9480ed70c154da3d954a,5,,,2018-01-18 00:00:00,2018-01-18 19:12:30
6a18a4001ae7fd911b3b9fb13686d105,8ba3f3a9292fbc22a8b7dff752bbcd37,5,,,2017-07-19 00:00:00,2017-07-20 10:38:48
58044bca115705a48fe0e00a21390c54,68e55ca79d04a79f20d4bfc0146f4b66,1,,"Sempre compro pela Internet e a entrega ocorre antes do prazo combinado, que acredito ser o prazo máximo. No stark o prazo máximo já se esgotou e ainda não recebi o produto.",2018-04-08 00:00:00,2018-04-09 12:22:39
19a52a2297e5289ab4187d238d335982,677c865b89aa97e7dbeb4bfbb50bbcfd,5,,,2018-08-25 00:00:00,2018-08-26 22:02:59
c92cdd7dd544a01aa35137f901669cdf,37e7875cdce5a9e5b3a692971f370151,4,Muito bom.,"Recebi exatamente o que esperava. As demais encomendas de ou
Query:
-- 9. Calculate the total profit per seller assuming profit is equal to price in delivered orders
SELECT t."seller_id", SUM(t."price") AS "total_profit"
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
  ON t."order_id" = o."order_id"
WHERE o."order_status" = 'delivered'
GROUP BY t."seller_id"
ORDER BY "total_profit" DESC
LIMIT 100
Answer:
seller_id,total_profit
4869f7a5dfa277a7dca6462dcf3b52b2,226987.93
53243585a1d6dc2643021fd1853d8905,217940.44
4a3ca9315b744ce9f8e9374361493884,196882.12
fa1c13f2614d7b5c4749cbc52fecda94,190917.13999999998
7c67e1448b00f6e969d365cea6b010ab,186570.05
7e93a43ef30c4f03f38b393420bc753a,165981.49
da8622b14eb17ae2831f4ac5b9dab84a,159816.87
7a67c85e85bb2ce8582c35f2203ad736,139658.69
1025f0e2d44d7041d6cf58b6550e0bfa,138208.56
955fee9216a65b617aa5c0531780ce60,131836.71
46dc3b2cc0980fb8ec44634e21d2718e,122811.38
6560211a19b47992c3666cc44a7e94c0,120702.83
620c87c171fb2a6dd6e8bb4dec959fc6,112461.5
7d13fca15225358621be4086e1eb0964,112436.18000000001
5dceca129747e92ff8ef7a997dc4f8ca,111126.73
1f50f920176fa81dab994f9023523100,106655.70999999999
cc419e0650a3c5ba77189a1882b7556a,101090.95999999999
a1043bafd471dff536d0c462352beb48,99309.23
3d871de0142ce09b7081e2b9d1733cb1,93407.4
edb1ef5e36e0c8cd84eb3c9b003e486d,79144.9
ccc4bbb5f32a6ab2b7066a4130f114e3,72926.72
f7ba60f8c3f99e7ee4042fdef03b70c4,68070.0
fe2032dab1a61af8794248c8196565c9,65689.71
8581055ce74af1daba164fdbd55a40de,64011.22
cca3071e3e9bb7d12640c9fbe2301306,63035.16
04308b1ee57b6625f47df1d56f00eedf,58991.8
522620dcb18a6b31cd7bdf73665113a9,56690.49
de722cd6dad950a92b7d4f82673f8833,55126.3
37be5a7c751166fbc5f8ccba4119e043,54735.55
17e34d8224d27a541263c4c64b11a56b,54440.28
7ddcbb64b5bc1ef36ca8c151f6ec77df,54435.66
25c5c91f63607446a97b143d2d535d31,54208.78
218d46b86c1881d022bce9c68a7d4b15,53710.3
ceaec5548eefc6e23e6607c5435102e7,51478.18
f5a590cf36251cf1162ea35bef76fe84,51232.78
e882b2a25a10b9c057cc49695f222c19,51057.54
2bf6a2c1e71bbd29a4ad64e6d3c3629f,50628.9
f8db351d8c4c4c22c6835c19a46f01b0,50082.6
b2ba3715d723d245138f291a6fe42594,49302.18
17f51e7198701186712e53a39c564617,48019.0
8160255418d5aaa7dbdc9f4c64ebda44,46368.39
966cb4760537b1404caedd472cc610a5,45928.26
77530e9772f57a62c906e1c21538ab82,45676.6
4e922959ae960d389249c378d1c939f5,45338.42
850f4f8af5ea87287ac68de36e29107f,45285.37
c826c40d7b19f62a09e2d7c5e7295ee2,44653.04
b33e7c55446eabf8fe1a42d037ac7d6d,44215.17
ba90964cff9b9e0e6f32b23b82465f7b,44212.5
eeb6de78f79159600292e314a77cbd18,43510.84
c3cfdc648177fdbbbb35635a37472c53,43048.18
4d6d651bd7684af3fffabd5f08d12e5a,42999.0
b839e41795b7f3ad94cc2014a52f6796,42829.0
e9779976487b77c6d4ac45f75ec7afe9,42229.69
17a053fcb14bd219540cbde0df490be0,40353.24
d91fb3b7d041e83b64a00a3edfb37e4f,39926.39
834f3294fba9f932f56edc879193f925,39907.5
391fc6631aebcf3004804e51b40bcf1e,39475.3
712e6ed8aa4aa1fa65dab41fed5737e4,39385.0
634964b17796e64304cadf1ad3050fb7,39114.1
2eb70248d66e0e3ef83659f71b244378,38990.72
7142540dd4c91e2237acb7e911c4eba2,37181.94
7178f9f4dd81dcef02f62acdf8151e01,36795.4
ea8482cd71df3c1969d7b9473ff13abc,36696.76
59417c56835dd8e2e72f91f809cd4092,36459.0
c70c1b0d8ca86052f45a432a38b73958,36289.15
06a2c3af7b3aee5d69171b0e14f0ee87,36097.979999999996
c3867b4666c7d76867627c2f7fb22e21,34666.9
7299e27ed73d2ad986de7f7c77d919fa,34107.44
e9bc59e7b60fc3063eb2290deda4cced,33543.69
1835b56ce799e6a4dc4eddc053f04066,33005.32
5c243662ce92d84573bfaff24c3e3700,32862.02
dbc22125167c298ef99da25668e1011f,32829.12
9c0e69c7bf2619675bbadf47b43f655a,32720.4
2528513dd95219a6013d4d05176e391a,32660.2
76d5af76d0271110f9af36c92573f765,31944.6
70eea00b476a314817cefde4aad4f89a,31424.75
0241d4d5d36f10f80c644447315af0bd,31397.7
88460e8ebdecbfecb5f9601833981930,31320.4
7681ef142fd2c19048da7430856b5588,31211.81
87142160b41353c4e5fca2360caf6f92,31095.98
855668e0971d4dfd7bef1b6a4133b41b,30849.22
e59aa562b9f8076dd550fcddf0e73491,30716.3
70a12e78e608ac31179aea7f8422044b,29963.53
53e4c6e0f4312d4d2107a8c9cddf45cd,29587.77
d23019c84ffae2d5ef2270367b8605fc,29205.1
1554a68530182680ad5c8b042c3ab563,28979.64
900ba814c251a692506d7834c1218441,28833.03
0b90b6df587eb83608a64ea8b390cf07,28492.76
59b22a78efb79a4797979612b885db36,27184.5
d1c281d3ae149232351cd8c8cc885f0d,26833.61
b32be1695eb7ec5f10f72d9610a12527,26575.0
12b9676b00f60f3b700e83af21824c0e,26376.0
a3a38f4affed601eb87a97788c949667,26294.62
7e1fb0a3ebfb01ffb3a7dae98bf3238d,26169.53
de23c3b98a88888289c6f5cc1209054a,25933.670000000002
9f505651f4a6abe901a56cdc21508025,25912.84
16090f2ca825584b5a147ab24aa30c86,25579.16
b94cc9f10ddc85e4ba73a6f7974e7101,25346.1
a416b6a846a11724393025641d4edd5e,24930.24
c003204e1ab016dfa150abc119207b24,24904.29
Query:
-- 10. Get average review score per seller in delivered orders
SELECT t."seller_id", AVG(r."review_score") AS "average_review_score"
FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_REVIEWS" r
  ON t."order_id" = r."order_id"
JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
  ON t."order_id" = o."order_id"
WHERE o."order_status" = 'delivered'
GROUP BY t."seller_id"
ORDER BY "average_review_score" DESC
LIMIT 100
Answer:
seller_id,average_review_score
ff4ea69c2a729e83e63c7579e4ef8170,5.000000
8fff28c4263ddec387f28d237fb42773,5.000000
90b57083da5d803237da74daec6dcb2b,5.000000
0cab2da43793a6f3c5ed8514c5f54627,5.000000
4fe2f67634d00c021aa01f96b6f2d68e,5.000000
3e46a38ee171c503c3b4a3f23fe3bf0c,5.000000
64cc804291f90c81f02bfc2bb58ff55a,5.000000
26b482dccfa29bd2e40703ba45523702,5.000000
3bfba5a77604f6dfae7e6dd7aaf65821,5.000000
9b76ad3d04236f76bc71c59470305e13,5.000000
5721089ba9214e80074f27d5a03fc0eb,5.000000
0ad80de75c811326389cfb1daba7d45e,5.000000
fc908879b9ca1bd65419e54e50432d38,5.000000
a3b0df0065e264a91b7bbf5f844af5cd,5.000000
feb793c88d836c3a75efa4b5a3465d70,5.000000
4ddeb3e828550cddc8d45c8bc36ab2d1,5.000000
83c8aafbefb034674a70de0eac5b8954,5.000000
a64e44665225d19dfc0277eeeaaccc57,5.000000
dcb7367a92f5ffb89f1e2152ed260285,5.000000
bba8d0c234a52b87b3957037a215d1a4,5.000000
c8c1bea22194a4eefa2dc9a9fa89f536,5.000000
70126eecc6aa1274392a1743866e9678,5.000000
2075d8cd4dd63ff12df0749a5866bb06,5.000000
528ce32f560edd11add4169f6a5b65be,5.000000
0c7f30ae9b147eca07affbef92832a6a,5.000000
19e0f40a907ec568c34bfac15de4f4a1,5.000000
09bad886111255c5b5030314fc7f1a4a,5.000000
8c9348f33ae3dada25c99c99ade2af78,5.000000
bfd938b22bc99bce1ae60dc602889f52,5.000000
edd066cd02126d7800f9b66e980e9931,5.000000
bbf4a892cac7b82422baa711dffb8997,5.000000
0570350b23eda5444f8d1d9544932058,5.000000
10264f60a8f0a4d2f30810f5c661c673,5.000000
eaaa46e98c9e61f6764dd1d7a2ab8b3e,5.000000
5db42a6cd9bf1bf0d3aab9582767f168,5.000000
48efc9d94a9834137efd9ea76b065a38,5.000000
8b87cd0d43d49b9bdf40f56229364d59,5.000000
ec933281fb017b5020d06df29c3f77e8,5.000000
7994081388d55b9cf976c050653dd359,5.000000
c8665a4dd081a2c436b1cd921079d0d9,5.000000
8fd3b4468f6425810648177996c14cbd,5.000000
42fb44130ac3134cde8e35cf8ec7df25,5.000000
2d20f1cd18725c91147da0791d498022,5.000000
7f5e4d5efad7e44b91115dd1decb65f3,5.000000
f307937c1bb287c3efc2a514b94b0d1d,5.000000
75fdd0a732287f9497b179f6bd445d32,5.000000
58c851d1a3c7cd3da329eb59453fed44,5.000000
7cb946b1ad19faebe28c3e86c2794ec3,5.000000
d63f306de130e0391d38a792541723b8,5.000000
c353f8fc0ce8344999f17d578eb69a5e,5.000000
2bd05d410a8fd26dc4184a15f4f2f588,5.000000
d598f929fc44e1e38678e7f47250ec04,5.000000
d2572f31e9023e9850ef986a636ff9bf,5.000000
48b6c3f4c6a93171da04b75313f2130f,5.000000
6179a28a13a726c29b3bf54c070dccab,5.000000
392f7f2c797e4dc077e4311bde2ab8ce,5.000000
11d4c477d09821164bca4f70a2eae031,5.000000
800214c63934acd05d47e84214db8ba8,5.000000
50bf89f1349bc0409a268c3a49678009,5.000000
228e4c1a0be164f613d41c24345f9d2c,5.000000
b00af24704019bd2e1b335e70ad11f7c,5.000000
2addf05f476d0637864454e93ba673d5,5.000000
d3e7d37c0df9aef383f3f2a15b0dddfb,5.000000
f235413f677777a0738ff215d0184901,5.000000
850857dfac77488c307e2b1cbd84ab5a,5.000000
98dddbc4601dd4443ca174359b237166,5.000000
5e106d93b717c2682b9383da480364a1,5.000000
b2eecf5ea250510da76590ca79d60e5d,5.000000
c3f5668699a1b04c0fa61ecea1e2bff6,5.000000
e73bf2cea7fe4b0b4d287a7568ed1099,5.000000
2039c5e51785b5dde7cf93ccb3b7be2c,5.000000
5f5a58930c3c35f3b5af264f34fb8c85,5.000000
761681a821d8275bc79f552116d06869,5.000000
9dd459b29a14bf89d47183cf2cd0e4c7,5.000000
0b46f784306be7200ca1700aa55d819f,5.000000
71dc18fd8cbf5fd77f45dd8b427abb34,5.000000
94ca168e8bcb407ab85c5da308863027,5.000000
4f0d637c1197fd65405ebd755ac9f86b,5.000000
b9c0ffa92f3ff9a5a3d45ef7213c0842,5.000000
f8d5c7085db9a4ad2b8c1ffbeb2798c8,5.000000
78813699ffac347fe27dba345a5f1551,5.000000
05730013efda596306417c3b09302475,5.000000
9b1f656ca3060f8af17a50d8a024b533,5.000000
e3b4998c7a498169dc7bce44e6bb6277,5.000000
83c465a786b06574376909b35ef6752a,5.000000
89757206b887aed36f3e18d858460fea,5.000000
2f3d8b4c9e2ee165075331fea3f3095a,5.000000
1c83418358f249c9d6affa52d579db0e,5.000000
3c88ed2e76a2247933a15daa7161eb1c,5.000000
0a198e95d32b1be2da9424c962a6ebfa,5.000000
1d0646a72178a6fb37ee8082140e06ec,5.000000
668bf321538e5072858eaef6087ce027,5.000000
87b4428a334b8f676fd9a7f3bf544fb5,5.000000
e9c2dc0dd4ac38448289be644ac94f42,5.000000
44717f64ec2a457979cf83c429077666,5.000000
160851d3ece7aa1a510f8d1a4bb8a8af,5.000000
fa5fdc4e4bb6bd1009ad0e4ac4096562,5.000000
e1bed63d68ac36fe1f3061befe196af5,5.000000
cf1313c6e2c01c2f4b014f97db4bcd2b,5.000000
adbe70ab2c97442046d393988c8d1d27,5.000000
End Exploring Related Columns
Task: Could you help me find the sellers respectively with the highest number of distinct customers, highest profit, highest number of distinct orders, and most 5-star ratings, in delivered orders, along with their corresponding values? 

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: Sure, here's the information you requested:

```csv
Metric,Seller_ID,Value
Highest_number_of_distinct_customers,seller_id1:str,value1:int
Highest_profit,seller_id2:str,value2:float
Highest_number_of_distinct_orders,seller_id3:str,value3:int
Most_5-star_ratings,seller_id4:str,value4:int
(Attention: answer in this order)
```

In this table, each row represents the seller who has achieved the highest value for the specified metric in **delivered orders**, along with their seller ID and the corresponding value..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'BRAZILIAN_E_COMMERCE': {'BRAZILIAN_E_COMMERCE': ['OLIST_CUSTOMERS', 'OLIST_GEOLOCATION', 'OLIST_ORDERS', 'OLIST_ORDER_ITEMS', 'OLIST_ORDER_PAYMENTS', 'OLIST_ORDER_REVIEWS', 'OLIST_PRODUCTS', 'OLIST_PRODUCTS_DATASET', 'OLIST_SELLERS', 'PRODUCT_CATEGORY_NAME_TRANSLATION']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-21 14:51:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 14:51:37 - root - INFO - Sure, here's the SQL query that retrieves the information you requested:

```sql
SELECT 'Highest_number_of_distinct_customers' AS "Metric", t1."seller_id" AS "Seller_ID", t1."distinct_customers" AS "Value"
FROM (
    SELECT t."seller_id", COUNT(DISTINCT o."customer_id") AS "distinct_customers"
    FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
    JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
        ON t."order_id" = o."order_id"
    WHERE o."order_status" = 'delivered'
    GROUP BY t."seller_id"
    ORDER BY "distinct_customers" DESC
    LIMIT 1
) t1

UNION ALL

SELECT 'Highest_profit' AS "Metric", t2."seller_id" AS "Seller_ID", t2."total_profit" AS "Value"
FROM (
    SELECT t."seller_id", SUM(t."price") AS "total_profit"
    FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
    JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
        ON t."order_id" = o."order_id"
    WHERE o."order_status" = 'delivered'
    GROUP BY t."seller_id"
    ORDER BY "total_profit" DESC
    LIMIT 1
) t2

UNION ALL

SELECT 'Highest_number_of_distinct_orders' AS "Metric", t3."seller_id" AS "Seller_ID", t3."number_of_orders" AS "Value"
FROM (
    SELECT t."seller_id", COUNT(DISTINCT t."order_id") AS "number_of_orders"
    FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
    JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
        ON t."order_id" = o."order_id"
    WHERE o."order_status" = 'delivered'
    GROUP BY t."seller_id"
    ORDER BY "number_of_orders" DESC
    LIMIT 1
) t3

UNION ALL

SELECT 'Most_5-star_ratings' AS "Metric", t4."seller_id" AS "Seller_ID", t4."five_star_reviews" AS "Value"
FROM (
    SELECT t."seller_id", COUNT(*) AS "five_star_reviews"
    FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
    JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_REVIEWS" r
        ON t."order_id" = r."order_id"
    JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
        ON t."order_id" = o."order_id"
    WHERE o."order_status" = 'delivered' AND r."review_score" = 5
    GROUP BY t."seller_id"
    ORDER BY "five_star_reviews" DESC
    LIMIT 1
) t4;
```
2025-01-21 14:51:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:51:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:51:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:51:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 4
2025-01-21 14:51:39 - snowflake.connector.connection - INFO - closed
2025-01-21 14:51:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:51:39 - root - INFO - itercount: 1
2025-01-21 14:51:39 - root - INFO - 0
2025-01-21 14:51:39 - root - INFO - results: 
Metric,Seller_ID,Value
Highest_number_of_distinct_customers,6560211a19b47992c3666cc44a7e94c0,1819.0
Highest_profit,4869f7a5dfa277a7dca6462dcf3b52b2,226987.93
Highest_number_of_distinct_orders,6560211a19b47992c3666cc44a7e94c0,1819.0
Most_5-star_ratings,1f50f920176fa81dab994f9023523100,1096.0


2025-01-21 14:51:39 - root - INFO - Please check the answer again by reviewing Could you help me find the sellers respectively with the highest number of distinct customers, highest profit, highest number of distinct orders, and most 5-star ratings, in delivered orders, along with their corresponding values? , reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: Sure, here's the information you requested:

```csv
Metric,Seller_ID,Value
Highest_number_of_distinct_customers,seller_id1:str,value1:int
Highest_profit,seller_id2:str,value2:float
Highest_number_of_distinct_orders,seller_id3:str,value3:int
Most_5-star_ratings,seller_id4:str,value4:int
(Attention: answer in this order)
```

In this table, each row represents the seller who has achieved the highest value for the specified metric in **delivered orders**, along with their seller ID and the corresponding value. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Metric,Seller_ID,Value
Highest_number_of_distinct_customers,6560211a19b47992c3666cc44a7e94c0,1819.0
Highest_profit,4869f7a5dfa277a7dca6462dcf3b52b2,226987.93
Highest_number_of_distinct_orders,6560211a19b47992c3666cc44a7e94c0,1819.0
Most_5-star_ratings,1f50f920176fa81dab994f9023523100,1096.0
Current sql:
SELECT 'Highest_number_of_distinct_customers' AS "Metric", t1."seller_id" AS "Seller_ID", t1."distinct_customers" AS "Value"
FROM (
    SELECT t."seller_id", COUNT(DISTINCT o."customer_id") AS "distinct_customers"
    FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
    JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
        ON t."order_id" = o."order_id"
    WHERE o."order_status" = 'delivered'
    GROUP BY t."seller_id"
    ORDER BY "distinct_customers" DESC
    LIMIT 1
) t1

UNION ALL

SELECT 'Highest_profit' AS "Metric", t2."seller_id" AS "Seller_ID", t2."total_profit" AS "Value"
FROM (
    SELECT t."seller_id", SUM(t."price") AS "total_profit"
    FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
    JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
        ON t."order_id" = o."order_id"
    WHERE o."order_status" = 'delivered'
    GROUP BY t."seller_id"
    ORDER BY "total_profit" DESC
    LIMIT 1
) t2

UNION ALL

SELECT 'Highest_number_of_distinct_orders' AS "Metric", t3."seller_id" AS "Seller_ID", t3."number_of_orders" AS "Value"
FROM (
    SELECT t."seller_id", COUNT(DISTINCT t."order_id") AS "number_of_orders"
    FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
    JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
        ON t."order_id" = o."order_id"
    WHERE o."order_status" = 'delivered'
    GROUP BY t."seller_id"
    ORDER BY "number_of_orders" DESC
    LIMIT 1
) t3

UNION ALL

SELECT 'Most_5-star_ratings' AS "Metric", t4."seller_id" AS "Seller_ID", t4."five_star_reviews" AS "Value"
FROM (
    SELECT t."seller_id", COUNT(*) AS "five_star_reviews"
    FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
    JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_REVIEWS" r
        ON t."order_id" = r."order_id"
    JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
        ON t."order_id" = o."order_id"
    WHERE o."order_status" = 'delivered' AND r."review_score" = 5
    GROUP BY t."seller_id"
    ORDER BY "five_star_reviews" DESC
    LIMIT 1
) t4;When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-21 14:52:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 14:52:25 - root - INFO - Sure, here's the final SQL query with the requested adjustments:

```sql
SELECT 'Highest_number_of_distinct_customers' AS "Metric", t1."seller_id" AS "Seller_ID", t1."distinct_customers" AS "Value"
FROM (
    SELECT t."seller_id", COUNT(DISTINCT o."customer_id") AS "distinct_customers"
    FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
    JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
        ON t."order_id" = o."order_id"
    WHERE o."order_status" = 'delivered'
    GROUP BY t."seller_id"
    ORDER BY "distinct_customers" DESC NULLS LAST
    LIMIT 1
) t1

UNION ALL

SELECT 'Highest_profit' AS "Metric", t2."seller_id" AS "Seller_ID", ROUND(t2."total_profit", 4) AS "Value"
FROM (
    SELECT t."seller_id", SUM(t."price") AS "total_profit"
    FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
    JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
        ON t."order_id" = o."order_id"
    WHERE o."order_status" = 'delivered'
    GROUP BY t."seller_id"
    ORDER BY "total_profit" DESC NULLS LAST
    LIMIT 1
) t2

UNION ALL

SELECT 'Highest_number_of_distinct_orders' AS "Metric", t3."seller_id" AS "Seller_ID", t3."number_of_orders" AS "Value"
FROM (
    SELECT t."seller_id", COUNT(DISTINCT t."order_id") AS "number_of_orders"
    FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
    JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
        ON t."order_id" = o."order_id"
    WHERE o."order_status" = 'delivered'
    GROUP BY t."seller_id"
    ORDER BY "number_of_orders" DESC NULLS LAST
    LIMIT 1
) t3

UNION ALL

SELECT 'Most_5-star_ratings' AS "Metric", t4."seller_id" AS "Seller_ID", t4."five_star_reviews" AS "Value"
FROM (
    SELECT t."seller_id", COUNT(*) AS "five_star_reviews"
    FROM "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_ITEMS" t
    JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDER_REVIEWS" r
        ON t."order_id" = r."order_id"
    JOIN "BRAZILIAN_E_COMMERCE"."BRAZILIAN_E_COMMERCE"."OLIST_ORDERS" o
        ON t."order_id" = o."order_id"
    WHERE o."order_status" = 'delivered' AND r."review_score" = 5
    GROUP BY t."seller_id"
    ORDER BY "five_star_reviews" DESC NULLS LAST
    LIMIT 1
) t4;
```
2025-01-21 14:52:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:52:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:52:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:52:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 4
2025-01-21 14:52:27 - snowflake.connector.connection - INFO - closed
2025-01-21 14:52:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:52:27 - root - INFO - itercount: 2
2025-01-21 14:52:27 - root - INFO - 0
2025-01-21 14:52:27 - root - INFO - Total iteration counts: 2
