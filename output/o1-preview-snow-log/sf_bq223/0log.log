2025-01-25 10:25:23 - openai._base_client - INFO - Retrying request to /chat/completions in 0.478482 seconds
2025-01-25 10:26:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:26:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:26:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:26:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:26:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 10:26:16 - snowflake.connector.connection - INFO - closed
2025-01-25 10:26:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:27:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:27:01 - root - INFO - ```sql
SELECT
    COALESCE(citing_assignees.value:"organization"::STRING, 'Unknown') AS "Assignee",
    cpc_titles."titleFull" AS "CPC_Subclass_Title",
    COUNT(*) AS "Citation_Count"
FROM
    PATENTS.PATENTS.PUBLICATIONS citing_patents
    JOIN LATERAL FLATTEN(input => citing_patents."citation") citations ON TRUE
    JOIN PATENTS.PATENTS.PUBLICATIONS denso_patents
        ON denso_patents."publication_number" = citations.value:"publication_number"::STRING
    JOIN LATERAL FLATTEN(input => denso_patents."assignee_harmonized") denso_assignees ON TRUE
    JOIN LATERAL FLATTEN(input => citing_patents."assignee_harmonized") citing_assignees ON TRUE
    JOIN LATERAL FLATTEN(input => citing_patents."cpc") cpc_codes ON TRUE
    JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_titles
        ON cpc_titles."symbol" = SUBSTR(cpc_codes.value:"code"::STRING, 1, 4)
WHERE
    denso_assignees.value:"organization"::STRING ILIKE '%DENSO CORP%'
    AND (citing_assignees.value:"organization"::STRING IS NULL OR citing_assignees.value:"organization"::STRING NOT ILIKE '%DENSO CORP%')
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC;
```
2025-01-25 10:27:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:27:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:27:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:27:03 - snowflake.connector.connection - INFO - closed
2025-01-25 10:27:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:27:24 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:27:24 - root - INFO - ```sql
SELECT DISTINCT f.value:"organization"::STRING AS "Assignee_Organization"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f
WHERE f.value:"organization" IS NOT NULL
LIMIT 100;
```
2025-01-25 10:27:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:27:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:27:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:27:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-25 10:27:26 - snowflake.connector.connection - INFO - closed
2025-01-25 10:27:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:28:24 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:28:24 - root - INFO - ```sql
SELECT
    COALESCE(citing_assignees.value::STRING, 'Unknown') AS "Assignee",
    cpc_titles."titleFull" AS "CPC_Subclass_Title",
    COUNT(*) AS "Citation_Count"
FROM
    PATENTS.PATENTS.PUBLICATIONS citing_patents
    CROSS JOIN LATERAL FLATTEN(input => citing_patents."assignee_harmonized") citing_assignees
    CROSS JOIN LATERAL FLATTEN(input => citing_patents."cpc") cpc_codes
    JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_titles
        ON cpc_titles."symbol" = SUBSTR(cpc_codes.value:"code"::STRING, 1, 4)
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC
LIMIT 100;
```
2025-01-25 10:28:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:28:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:28:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:31:46 - snowflake.connector.connection - INFO - closed
2025-01-25 10:31:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:31:46 - root - INFO - SQL:
SELECT
    COALESCE(citing_assignees.value::STRING, 'Unknown') AS "Assignee",
    cpc_titles."titleFull" AS "CPC_Subclass_Title",
    COUNT(*) AS "Citation_Count"
FROM
    PATENTS.PATENTS.PUBLICATIONS citing_patents
    CROSS JOIN LATERAL FLATTEN(input => citing_patents."assignee_harmonized") citing_assignees
    CROSS JOIN LATERAL FLATTEN(input => citing_patents."cpc") cpc_codes
    JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_titles
        ON cpc_titles."symbol" = SUBSTR(cpc_codes.value:"code"::STRING, 1, 4)
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC
LIMIT 100;
Results:
000630 (57014): None: Statement reached its statement or warehouse timeout of 200 second(s) and was canceled.
2025-01-25 10:31:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:31:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:31:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:31:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:31:48 - snowflake.connector.connection - INFO - closed
2025-01-25 10:31:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:31:49 - root - INFO - SQL:
SELECT t."publication_number", c.value:"publication_number"::STRING AS "Cited_Publication_Number"
   FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."citation") c
   LIMIT 100;
Results:
publication_number,Cited_Publication_Number
IT-MI20100845-A1,US-1654188-A
IT-MI20100845-A1,US-2506292-A
IT-MI20100845-A1,DE-4307918-A1
IT-MI20100845-A1,DE-19810417-A1
IT-MI20100845-A1,WO-2008068591-A2
IT-VI20090183-A1,CH-326215-A
IT-VI20090183-A1,US-5134380-A
IT-VI20090183-A1,US-5216409-A
IT-VI20090183-A1,US-5736637-A
IT-VI20090183-A1,EP-1411348-A1
IT-TO20100206-A1,DE-1580149-A1
IT-TO20100206-A1,DE-10252996-A1
IT-TO20100206-A1,FR-2865440-A1
IT-TO20100206-A1,DE-102004046678-A1
IT-TO20100206-A1,FR-2895705-A1
IT-PZ20150004-A1,
IT-PZ20150004-A1,
IT-PZ20150004-A1,
IT-PZ20150004-A1,
IT-PZ20150004-A1,
IT-UA20161603-A1,AU-551882-B2
IT-UA20161603-A1,EP-1881576-A1
IT-UA20161603-A1,GB-2465609-A
IT-UA20161603-A1,US-2013029541-A1
IT-UA20161603-A1,DE-102013101120-A1
IT-UA20161603-A1,US-2015200530-A1
IT-BO20080517-A1,DE-3030931-A1
IT-BO20080517-A1,US-5467567-A
IT-BO20080517-A1,US-5572847-A
IT-BO20080517-A1,EP-0744497-A1
IT-BO20080517-A1,DE-19732904-A1
IT-BO20080517-A1,EP-1072726-A1
IT-BO20080731-A1,FR-2781409-A1
IT-BO20080731-A1,US-2002158357-A1
IT-UB20160960-A1,US-6481795-B1
IT-UB20160960-A1,US-2009230743-A1
IT-UB20160960-A1,EP-2653196-A2
IT-UB20160960-A1,WO-2014085732-A1
IT-TO20090280-A1,DE-1238299-B
IT-TO20090280-A1,US-3358522-A
IT-TO20090280-A1,US-5083984-A
IT-TO20090280-A1,US-5277667-A
IT-TO20090280-A1,GB-2348262-A
IT-UB20160584-A1,US-668479-A
IT-UB20160584-A1,US-968952-A
IT-UB20160584-A1,US-1043743-A
IT-UB20160584-A1,US-1305661-A
IT-MI20101275-A1,DE-1034672-B
IT-MI20101275-A1,US-3630639-A
IT-MI20101275-A1,EP-0039977-A1
IT-MI20101275-A1,US-2005092392-A1
IT-MI20101275-A1,DE-10362075-A1
IT-MI20101275-A1,WO-2010028852-A2
IT-VA20090003-A1,EP-0737566-A1
IT-VA20090003-A1,WO-0043272-A1
IT-VA20090003-A1,WO-2004087527-A1
IT-VA20090003-A1,EP-1619137-A1
IT-VA20090003-A1,WO-2008086388-A1
IT-VA20090003-A1,DE-202008009634-U1
IT-RM20080370-A1,US-3406618-A
IT-RM20080370-A1,US-4131406-A
IT-RM20080370-A1,US-4231677-A
IT-RM20080370-A1,US-5033906-A
IT-RM20080370-A1,WO-0066857-A1
IT-RM20080370-A1,US-6595768-B1
IT-TV20130044-A1,US-5144899-A
IT-TV20130044-A1,JP-H05272046-A
IT-TV20130044-A1,WO-2004058415-A1
IT-TV20130044-A1,US-2004221780-A1
IT-TV20130044-A1,US-2005178309-A1
IT-TV20130044-A1,US-6957614-B1
IT-TV20130044-A1,US-2011297062-A1
IT-MI20091791-A1,WO-9822370-A1
IT-MI20091791-A1,US-6182823-B1
IT-MI20091791-A1,JP-2002059987-A
IT-MI20091791-A1,WO-0221531-A1
IT-MI20091791-A1,JP-2002345740-A
IT-MI20091791-A1,DE-20216034-U1
IT-MI20091791-A1,JP-2004352365-A
IT-MI20091791-A1,DE-10323914-A1
IT-MI20091791-A1,JP-2007112473-A
IT-MI20091791-A1,US-2008135430-A1
IT-UB20160009-A1,US-4168924-A
IT-UB20160009-A1,US-4288956-A
IT-UB20160009-A1,EP-0059466-A1
IT-UB20160009-A1,DE-3102120-A1
IT-UB20160009-A1,DE-3445187-A1
IT-UB20160009-A1,WO-9316247-A1
AT-514400-A1,DE-10149649-A1
AT-514400-A1,WO-2011024177-A1
CH-712732-A1,EP-0507299-A2
CH-712732-A1,US-5640508-A
CH-712732-A1,US-2004199817-A1
CH-712732-A1,US-2010287421-A1
CH-712732-A1,
FR-2894722-A1,GB-1247790-A
FR-2894722-A1,EP-0059939-A1
FR-2894722-A1,DE-3413740-A1
FR-2894722-A1,EP-0802580-A1
FR-2894722-A1,WO-03005491-A1

2025-01-25 10:31:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:31:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:31:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:31:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:31:50 - snowflake.connector.connection - INFO - closed
2025-01-25 10:31:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:31:51 - root - INFO - SQL:
SELECT t."publication_number", c.value:"code"::STRING AS "CPC_Code"
   FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") c
   LIMIT 100;
Results:
publication_number,CPC_Code
US-2007068873-A1,G01N2030/202
US-2007068873-A1,Y10T137/86815
US-2007068873-A1,G01N2030/202
US-2007068873-A1,G01N30/6047
US-2007068873-A1,F16K11/074
US-2007068873-A1,G01N30/20
US-2007068873-A1,F16K11/074
US-2007068873-A1,B01D15/1821
US-2007068873-A1,G01N30/20
US-2007068873-A1,B01D15/1821
US-2007068873-A1,G01N30/6047
US-2007068873-A1,G01N2030/201
US-2007068873-A1,G01N2030/201
US-2007068873-A1,Y10T137/86815
US-2007068873-A1,G01N30/461
US-2007068873-A1,G01N30/461
US-2007071679-A1,A61K31/00
US-2007071679-A1,A61K31/00
US-2006103920-A1,G02B7/16
US-2006103920-A1,G02B7/16
US-2006103920-A1,G02B21/248
US-2006103920-A1,Y10T74/19749
US-2006103920-A1,Y10T74/19749
US-2006103920-A1,G02B21/248
US-2006038587-A1,G06F13/4077
US-2006038587-A1,H04L5/16
US-2006038587-A1,G06F13/4077
US-2006038587-A1,H04L5/16
US-2006120188-A1,G11B7/004
US-2006120188-A1,G11B7/00375
US-2006120188-A1,G11B20/10
US-2006120188-A1,G11B19/04
US-2006120188-A1,G11B7/00375
US-2006120188-A1,G11B19/04
US-2006118739-A1,G06V20/66
US-2006118739-A1,G06V10/143
US-2006118739-A1,G06V20/66
US-2006118739-A1,G06V10/143
US-2006118739-A1,G06V20/80
US-2006118739-A1,G06V20/80
US-2006118739-A1,C03C3/095
US-2006118739-A1,C03C3/091
US-2006118739-A1,C09D11/03
US-2006118739-A1,C03C12/00
US-2006118739-A1,C03C3/091
US-2006118739-A1,C03C12/00
US-2006118739-A1,C03C3/095
US-2006118739-A1,C09D11/03
US-2006115954-A1,H01L28/91
US-2006115954-A1,H01L28/91
US-2006115954-A1,H10B12/033
US-2006115954-A1,H10B12/00
US-2006115954-A1,H10B12/033
US-2006115954-A1,H10B12/318
US-2006115954-A1,H10B12/318
US-2006092043-A1,G07C5/008
US-2006092043-A1,G08G1/0116
US-2006092043-A1,G07C5/0891
US-2006092043-A1,G08G1/0116
US-2006092043-A1,G07C5/008
US-2006092043-A1,G08G1/205
US-2006092043-A1,G08G1/205
US-2006092043-A1,G07C5/0891
US-2006240659-A1,H01L21/76877
US-2006240659-A1,H01L21/76877
US-2006240659-A1,H01L21/28
US-2006103888-A1,H04N19/42
US-2006103888-A1,H04N19/44
US-2006103888-A1,H04N21/40
US-2006103888-A1,H04N19/42
US-2006103888-A1,H04N19/42
US-2006103888-A1,H04N19/44
US-2007103691-A1,G01C19/721
US-2007103691-A1,G01C19/721
US-2007233220-A1,A61F2/89
US-2007233220-A1,A61F2/954
US-2007233220-A1,A61F2002/075
US-2007233220-A1,A61F2002/075
US-2007233220-A1,A61F2230/0078
US-2007233220-A1,A61F2002/067
US-2007233220-A1,A61F2230/0078
US-2007233220-A1,A61F2002/061
US-2007233220-A1,A61F2/954
US-2007233220-A1,A61F2002/067
US-2007233220-A1,A61F2230/0054
US-2007233220-A1,A61F2/07
US-2007233220-A1,A61F2230/0054
US-2007233220-A1,A61F2/07
US-2007233220-A1,A61F2002/061
US-2007233220-A1,A61F2/89
US-2007241792-A1,H03K19/00384
US-2007241792-A1,H03K19/094
US-2007241792-A1,H03K19/00384
US-2007241792-A1,H03K19/20
US-2007241792-A1,H03K19/20
US-2007241792-A1,H03K19/094
US-2006150701-A1,B21B37/16
US-2006150701-A1,B21B1/18
US-2006150701-A1,B21B37/50
US-2006150701-A1,B21B37/52

2025-01-25 10:31:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:31:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:31:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:31:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:31:52 - snowflake.connector.connection - INFO - closed
2025-01-25 10:31:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:33:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:33:13 - root - INFO - ```sql
SELECT
    COALESCE(citing_assignees.value:"organization"::STRING, 'Unknown') AS "Assignee",
    cpc_titles."titleFull" AS "CPC_Subclass_Title",
    COUNT(*) AS "Citation_Count"
FROM
    (
        SELECT DISTINCT citing_patents."publication_number"
        FROM PATENTS.PATENTS.PUBLICATIONS citing_patents
        CROSS JOIN LATERAL FLATTEN(input => citing_patents."citation") citations
        INNER JOIN (
            SELECT DISTINCT denso_patents."publication_number" AS "Denso_Publication_Number"
            FROM PATENTS.PATENTS.PUBLICATIONS denso_patents
            CROSS JOIN LATERAL FLATTEN(input => denso_patents."assignee") denso_assignees
            WHERE denso_assignees.value:"organization"::STRING ILIKE '%DENSO CORP%'
        ) Denso_Patents
            ON citations.value:"publication_number"::STRING = Denso_Patents."Denso_Publication_Number"
        WHERE citing_patents."publication_number" IS NOT NULL
    ) citing_patent_numbers
    INNER JOIN PATENTS.PATENTS.PUBLICATIONS citing_patents
        ON citing_patents."publication_number" = citing_patent_numbers."publication_number"
    CROSS JOIN LATERAL FLATTEN(input => citing_patents."assignee") citing_assignees
    CROSS JOIN LATERAL FLATTEN(input => citing_patents."cpc") cpc_codes
    INNER JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_titles
        ON cpc_titles."symbol" = SUBSTR(cpc_codes.value:"code"::STRING, 1, 4)
WHERE
    (citing_assignees.value:"organization"::STRING IS NULL OR citing_assignees.value:"organization"::STRING NOT ILIKE '%DENSO CORP%')
    AND cpc_titles."titleFull" IS NOT NULL
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC
LIMIT 100;
```

**Explanation:**

- **Assignee Data Correction:** I replaced `"assignee_harmonized"` with `"assignee"` since the `"assignee_harmonized"` field may contain empty values, while `"assignee"` is more likely to have the necessary data.

- **Optimization:**

  - **Subqueries:** Used subqueries to first identify the patents assigned to **DENSO CORP** and the citing patents. This reduces the amount of data processed in the joins.

  - **Filtering Conditions:** Ensured that all necessary fields are not null, especially `"publication_number"` and `"titleFull"` from the CPC definitions.

- **Simplification:**

  - **Removed Unnecessary Joins:** Simplified the query structure to prevent timeouts by minimizing the number of joins and the amount of data processed.

- **Ensuring Non-empty Columns:** Added conditions to check for non-null values in critical columns to avoid empty results.

This query retrieves assignees (excluding **DENSO CORP**), the titles of the primary CPC subclasses associated with the citations of **DENSO CORP** patents, and counts the citations grouped by assignee and CPC subclass title.
2025-01-25 10:33:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:33:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:33:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:33:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-25 10:33:15 - snowflake.connector.connection - INFO - closed
2025-01-25 10:33:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:34:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:34:40 - root - INFO - ```sql
WITH Denso_Pubs AS (
    SELECT DISTINCT "pub_cleaned" AS "Denso_Publication_Number"
    FROM PATENTS.PATENTS.DISCLOSURES_13
    WHERE "patent_owner_harmonized" ILIKE '%DENSO%'
        AND "pub_cleaned" IS NOT NULL
)

SELECT
    COALESCE(citing_assignees.value:"organization"::STRING, 'Unknown') AS "Assignee",
    cpc_titles."titleFull" AS "CPC_Subclass_Title",
    COUNT(*) AS "Citation_Count"
FROM
    PATENTS.PATENTS.PUBLICATIONS citing_patent
    LEFT JOIN LATERAL FLATTEN(input => citing_patent."citation") citations ON TRUE
    LEFT JOIN LATERAL FLATTEN(input => citing_patent."cpc") cpc_codes ON TRUE
    LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_titles
        ON cpc_titles."symbol" = SUBSTR(cpc_codes.value:"code"::STRING, 1, 4)
    LEFT JOIN LATERAL FLATTEN(input => citing_patent."assignee_harmonized") citing_assignees ON TRUE
WHERE
    citations.value:"publication_number"::STRING IN (SELECT "Denso_Publication_Number" FROM Denso_Pubs)
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC
LIMIT 100;
```
2025-01-25 10:34:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:34:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:34:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:34:42 - snowflake.connector.connection - INFO - closed
2025-01-25 10:34:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:36:11 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:36:11 - root - INFO - ```sql
SELECT
    COALESCE(cp."assignee"[0]:"organization"::STRING, 'Unknown') AS "Assignee",
    cpc_def."titleFull" AS "CPC_Subclass_Title",
    COUNT(*) AS "Citation_Count"
FROM
    PATENTS.PATENTS.PUBLICATIONS cp
    CROSS JOIN LATERAL FLATTEN(input => cp."cpc") cpc_code
    JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_def
        ON cpc_def."symbol" = SUBSTR(cpc_code.value:"code"::STRING, 1, 4)
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC
LIMIT 100;
```
2025-01-25 10:36:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:36:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:36:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:39:32 - snowflake.connector.connection - INFO - closed
2025-01-25 10:39:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:39:33 - root - INFO - SQL:
SELECT
    COALESCE(cp."assignee"[0]:"organization"::STRING, 'Unknown') AS "Assignee",
    cpc_def."titleFull" AS "CPC_Subclass_Title",
    COUNT(*) AS "Citation_Count"
FROM
    PATENTS.PATENTS.PUBLICATIONS cp
    CROSS JOIN LATERAL FLATTEN(input => cp."cpc") cpc_code
    JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_def
        ON cpc_def."symbol" = SUBSTR(cpc_code.value:"code"::STRING, 1, 4)
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC
LIMIT 100;
Results:
000630 (57014): None: Statement reached its statement or warehouse timeout of 200 second(s) and was canceled.
2025-01-25 10:39:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:39:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:39:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:39:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:39:34 - snowflake.connector.connection - INFO - closed
2025-01-25 10:39:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:39:34 - root - INFO - SQL:
SELECT t."symbol" AS "CPC_Code", t."titleFull" AS "CPC_Title"
   FROM PATENTS.PATENTS.CPC_DEFINITION t
   LIMIT 100;
Results:
Too long, hard cut:
CPC_Code,CPC_Title
B,PERFORMING OPERATIONS; TRANSPORTING
H,ELECTRICITY
Y,GENERAL TAGGING OF NEW TECHNOLOGICAL DEVELOPMENTS; GENERAL TAGGING OF CROSS-SECTIONAL TECHNOLOGIES SPANNING OVER SEVERAL SECTIONS OF THE IPC; TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS
D,TEXTILES; PAPER
F,MECHANICAL ENGINEERING; LIGHTING; HEATING; WEAPONS; BLASTING
E,FIXED CONSTRUCTIONS
C,CHEMISTRY; METALLURGY
G,PHYSICS
A,HUMAN NECESSITIES
A45,HAND OR TRAVELLING ARTICLES
A24,TOBACCO; CIGARS; CIGARETTES; SIMULATED SMOKING DEVICES; SMOKERS' REQUISITES
A61,MEDICAL OR VETERINARY SCIENCE; HYGIENE
A63,SPORTS; GAMES; AMUSEMENTS
A22,BUTCHERING; MEAT TREATMENT; PROCESSING POULTRY OR FISH
A42,HEADWEAR
A99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
A43,FOOTWEAR
A01,AGRICULTURE; FORESTRY; ANIMAL HUSBANDRY; HUNTING; TRAPPING; FISHING
A62,LIFE-SAVING; FIRE-FIGHTING
A23,"FOODS OR FOODSTUFFS; TREATMENT THEREOF, NOT COVERED BY OTHER CLASSES"
A47,FURNITURE; DOMESTIC ARTICLES OR APPLIANCES; COFFEE MILLS; SPICE MILLS; SUCTION CLEANERS IN GENERAL
A46,BRUSHWARE
A44,HABERDASHERY; JEWELLERY
A21,BAKING; EDIBLE DOUGHS
A41,WEARING APPAREL
B27,WORKING OR PRESERVING WOOD OR SIMILAR MATERIAL; NAILING OR STAPLING MACHINES IN GENERAL
B68,SADDLERY; UPHOLSTERY
B04,CENTRIFUGAL APPARATUS OR MACHINES FOR CARRYING-OUT PHYSICAL OR CHEMICAL PROCESSES
B23,MACHINE TOOLS; METAL-WORKING NOT OTHERWISE PROVIDED FOR
B30,PRESSES
B21,MECHANICAL METAL-WORKING WITHOUT ESSENTIALLY REMOVING MATERIAL; PUNCHING METAL
B25,HAND TOOLS; PORTABLE POWER-DRIVEN TOOLS; MANIPULATORS
B99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
B29,WORKING OF PLASTICS; WORKING OF SUBSTANCES IN A PLASTIC STATE IN GENERAL
B31,"MAKING ARTICLES OF PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER; WORKING PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER"
B26,HAND CUTTING TOOLS; CUTTING; SEVERING
B66,HOISTING; LIFTING; HAULING
B02,"CRUSHING, PULVERISING, OR DISINTEGRATING; PREPARATORY TREATMENT OF GRAIN FOR MILLING"
B65,CONVEYING; PACKING; STORING; HANDLING THIN OR FILAMENTARY MATERIAL
B61,RAILWAYS
B24,GRINDING; POLISHING
B06,GENERATING OR TRANSMITTING MECHANICAL VIBRATIONS IN GENERAL
B43,WRITING OR DRAWING IMPLEMENTS; BUREAU ACCESSORIES
B62,LAND VEHICLES FOR TRAVELLING OTHERWISE THAN ON RAILS
B64,AIRCRAFT; AVIATION; COSMONAUTICS
B22,CASTING; POWDER METALLURGY
B28,"WORKING CEMENT, CLAY, OR STONE"
B09,DISPOSAL OF SOLID WASTE; RECLAMATION OF CONTAMINATED SOIL
B01,PHYSICAL OR CHEMICAL PROCESSES OR APPARATUS IN GENERAL
B63,SHIPS OR OTHER WATERBORNE VESSELS; RELATED EQUIPMENT
B60,VEHICLES IN GENERAL
B44,DECORATIVE ARTS
B07,SEPARATING SOLIDS FROM SOLIDS; SORTING
B08,CLEANING
B82,NANOTECHNOLOGY
B42,BOOKBINDING; ALBUMS; FILES; SPECIAL PRINTED MATTER
B32,LAYERED PRODUCTS
B81,MICROSTRUCTURAL TECHNOLOGY
B05,"SPRAYING OR ATOMISING IN GENERAL; APPLYING FLUENT MATERIALS TO SURFACES, IN GENERAL"
B41,PRINTING; LINING MACHINES; TYPEWRITERS; STAMPS
B03,SEPARATION OF SOLID MATERIALS USING LIQUIDS OR USING PNEUMATIC TABLES OR JIGS; MAGNETIC OR ELECTROSTATIC SEPARATION OF SOLID MATERIALS FROM SOLID MATERIALS OR FLUIDS; SEPARATION BY HIGH-VOLTAGE ELECTRIC FIELDS
B67,"OPENING, CLOSING OR CLEANING BOTTLES, JARS OR SIMILAR CONTAINERS; LIQUID HANDLING"
B33,ADDITIVE MANUFACTURING TECHNOLOGY
C22,METALLURGY; FERROUS OR NON-FERROUS ALLOYS; TREATMENT OF ALLOYS OR NON-FERROUS METALS
C23,"COATING METALLIC MATERIAL; COATING MATERIAL WITH METALLIC MATERIAL; CHEMICAL SURFACE TREATMENT; DIFFUSION TREATMENT OF METALLIC MATERIAL; COATING BY VACUUM EVAPORATION, BY SPUTTERING, BY ION IMPLANTATION OR BY CHEMICAL VAPOUR DEPOSITION, IN GENERAL; INHIBITING CORROSION OF METALLIC MATERIAL OR INCRUSTATION IN GENERAL"
C06,EXPLOSIVES; MATCHES
C02,"TREATMENT OF WATER, WASTE WATER, SEWAGE, OR SLUDGE"
C07,ORGANIC CHEMISTRY
C25,ELECTROLYTIC OR ELECTROPHORETIC PROCESSES; APPARATUS THEREFOR
C30,CRYSTAL GROWTH
C12,BIOCHEMISTRY; BEER; SPIRITS; WINE; VINEGAR; MICROBIOLOGY; ENZYMOLOGY; MUTATION OR GENETIC ENGINEERING
C99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
C05,FERTILISERS; MANUFACTURE THEREOF
C40,COMBINATORIAL TECHNOLOGY
C11,"ANIMAL OR VEGETABLE OILS, FATS, FATTY SUBSTANCES OR WAXES; FATTY ACIDS THEREFROM; DETERGENTS; CANDLES"
C08,ORGANIC MACROMOLECULAR COMPOUNDS; THEIR PREPARATION OR CHEMICAL WORKING-UP; COMPOSITIONS BASED THEREON
C10,"PETROLEUM, GAS OR COKE INDUSTRIES; TECHNICAL GASES CONTAINING CARBON MONOXIDE; FUELS; LUBRICANTS; PEAT"
C21,METALLURGY OF IRON
C04,CEMENTS; CONCRETE; ARTIFICIAL STONE; CERAMICS; REFRACTORIES
C09,DYES; PAINTS; POLISHES; NATURAL RESINS; ADHESIVES; COMPOSITIONS NOT OTHERWISE PROVIDED FOR; APPLICATIONS OF MATERIALS NOT OTHERWISE PROVIDED FOR
C03,GLASS; MINERAL OR SLAG WOOL
C13,SUGAR INDUSTRY
C14,SKINS; HIDES; PELTS; LEATHER
C01,INORGANIC CHEMISTRY
D02,YARNS; MECHANICAL FINISHING OF YARNS OR ROPES; WARPING OR BEAMING
D21,PAPER-MAKING; PRODUCTION OF CELLULOSE
D04,BRAIDING; LACE-MAKING; KNITTING; TRIMMINGS; NON-WOVEN

2025-01-25 10:39:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:39:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:39:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:39:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-25 10:39:37 - snowflake.connector.connection - INFO - closed
2025-01-25 10:39:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:40:26 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:40:26 - root - INFO - ```sql
SELECT
    COALESCE(f.value:"organization"::STRING, 'Unknown') AS "Assignee",
    cpc_def."titleFull" AS "CPC_Subclass_Title",
    COUNT(*) AS "Citation_Count"
FROM
    PATENTS.PATENTS.PUBLICATIONS cp
    CROSS JOIN LATERAL FLATTEN(input => cp."assignee") f
    CROSS JOIN LATERAL FLATTEN(input => cp."cpc") c
    LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_def
        ON cpc_def."symbol" = SUBSTR(c.value:"code"::STRING, 1, 4)
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC
LIMIT 100;
```
2025-01-25 10:40:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:40:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:40:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:40:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:40:27 - snowflake.connector.connection - INFO - closed
2025-01-25 10:40:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:41:04 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:41:04 - root - INFO - SQL:
SELECT
    COALESCE(f.value:"organization"::STRING, 'Unknown') AS "Assignee",
    cpc_def."titleFull" AS "CPC_Subclass_Title",
    COUNT(*) AS "Citation_Count"
FROM
    PATENTS.PATENTS.PUBLICATIONS cp
    CROSS JOIN LATERAL FLATTEN(input => cp."assignee") f
    CROSS JOIN LATERAL FLATTEN(input => cp."cpc") c
    LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_def
        ON cpc_def."symbol" = SUBSTR(c.value:"code"::STRING, 1, 4)
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC
LIMIT 100;
Results:
Too long, hard cut:
Assignee,CPC_Subclass_Title,Citation_Count
Unknown,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",173564
Unknown,SEMICONDUCTOR DEVICES NOT COVERED BY CLASS H10,165505
Unknown,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,110498
Unknown,ELECTRIC DIGITAL DATA PROCESSING,105720
Unknown,DIAGNOSIS; SURGERY; IDENTIFICATION,99837
Unknown,"TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION",89993
Unknown,"PICTORIAL COMMUNICATION, e.g. TELEVISION",83183
Unknown,HETEROCYCLIC COMPOUNDS,78957
Unknown,TECHNICAL SUBJECTS COVERED BY FORMER US CLASSIFICATION,65218
Unknown,"PROCESSES OR MEANS, e.g. BATTERIES, FOR THE DIRECT CONVERSION OF CHEMICAL ENERGY INTO ELECTRICAL ENERGY",59059
Unknown,WIRELESS COMMUNICATION NETWORKS,57782
Unknown,PEPTIDES,53744
Unknown,INVESTIGATING OR ANALYSING MATERIALS BY DETERMINING THEIR CHEMICAL OR PHYSICAL PROPERTIES,53382
Unknown,"LAYERED PRODUCTS, i.e. PRODUCTS BUILT-UP OF STRATA OF FLAT OR NON-FLAT, e.g. CELLULAR OR HONEYCOMB, FORM",49720
Unknown,"DEVICES FOR INTRODUCING MEDIA INTO, OR ONTO, THE BODY; DEVICES FOR TRANSDUCING BODY MEDIA OR FOR TAKING MEDIA FROM THE BODY; DEVICES FOR PRODUCING OR ENDING SLEEP OR STUPOR",49510
Unknown,"SHAPING OR JOINING OF PLASTICS; SHAPING OF MATERIAL IN A PLASTIC STATE, NOT OTHERWISE PROVIDED FOR; AFTER-TREATMENT OF THE SHAPED PRODUCTS, e.g. REPAIRING",47416
Unknown,"MICROORGANISMS OR ENZYMES; COMPOSITIONS THEREOF; PROPAGATING, PRESERVING, OR MAINTAINING MICROORGANISMS; MUTATION OR GENETIC ENGINEERING; CULTURE MEDIA",47265
Unknown,"CHEMICAL OR PHYSICAL PROCESSES, e.g. CATALYSIS OR COLLOID CHEMISTRY; THEIR RELEVANT APPARATUS",41879
Unknown,SEPARATION,38621
Unknown,"FILTERS IMPLANTABLE INTO BLOOD VESSELS; PROSTHESES; DEVICES PROVIDING PATENCY TO, OR PREVENTING COLLAPSING OF, TUBULAR STRUCTURES OF THE BODY, e.g. STENTS; ORTHOPAEDIC, NURSING OR CONTRACEPTIVE DEVICES; FOMENTATION; TREATMENT OR PROTECTION OF EYES OR EARS; BANDAGES, DRESSINGS OR ABSORBENT PADS; FIRST-AID KITS",36512
Unknown,ACYCLIC OR CARBOCYCLIC COMPOUNDS,35571
Unknown,"INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES; SYSTEMS OR METHODS SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES, NOT OTHERWISE PROVIDED FOR",34216
Unknown,"OPTICAL ELEMENTS, SYSTEMS OR APPARATUS",32373
Unknown,"LIME, MAGNESIA; SLAG; CEMENTS; COMPOSITIONS THEREOF, e.g. MORTARS, CONCRETE OR LIKE BUILDING MATERIALS; ARTIFICIAL STONE; CERAMICS; REFRACTORIES; TREATMENT OF NATURAL STONE",28280
Unknown,"IMAGE DATA PROCESSING OR GENERATION, IN GENERAL",27507
Unknown,"REDUCTION OF GREENHOUSE GAS [GHG] EMISSIONS, RELATED TO ENERGY GENERATION, TRANSMISSION OR DISTRIBUTION",25629
Unknown,MACROMOLECULAR COMPOUNDS OBTAINED OTHERWISE THAN BY REACTIONS ONLY INVOLVING UNSATURATED CARBON-TO-CARBON BONDS,24187
Unknown,COMPOSITIONS OF MACROMOLECULAR COMPOUNDS,22629
Unknown,INFORMATION STORAGE BASED ON RELATIVE MOVEMENT BETWEEN RECORD CARRIER AND TRANSDUCER,22426
Unknown,ARRANGEMENTS OR CIRCUITS FOR CONTROL OF INDICATING DEVICES USING STATIC MEANS TO PRESENT VARIABLE INFORMATION,21916
Unknown,PRINTED CIRCUITS; CASINGS OR CONSTRUCTIONAL DETAILS OF ELECTRIC APPARATUS; MANUFACTURE OF ASSEMBLAGES OF ELECTRICAL COMPONENTS,21776
Unknown,"CONTAINERS FOR STORAGE OR TRANSPORT OF ARTICLES OR MATERIALS, e.g. BAGS, BARRELS, BOTTLES, BOXES, CANS, CARTONS, CRATES, DRUMS, JARS, TANKS, HOPPERS, FORWARDING CONTAINERS; ACCESSORIES, CLOSURES, OR FITTINGS THEREFOR; PACKAGING ELEMENTS; PACKAGES",21523
Unknown,TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS,20917
Unknown,ORGANIC ELECTRIC SOLID-STATE DEVICES,19340
Unknown,"METHODS OR APPARATUS FOR STERILISING MATERIALS OR OBJECTS IN GENERAL; DISINFECTION, STERILISATION OR DEODORISATION OF AIR; CHEMICAL ASPECTS OF BANDAGES, DRESSINGS, ABSORBENT PADS OR SURGICAL ARTICLES; MATERIALS FOR BANDAGES, DRESSINGS, ABSORBENT PADS OR SURGICAL ARTICLES",18993
Unknown,"COATING METALLIC MATERIAL; COATING MATERIAL WITH METALLIC MATERIAL; SURFACE TREATMENT OF METALLIC MATERIAL BY DIFFUSION INTO THE SURFACE, BY CHEMICAL CONVERSION OR SUBSTITUTION; COATING BY VACUUM EVAPORATION, BY SPUTTERING, BY ION IMPLANTATION OR BY CHEMICAL VAPOUR DEPOSITION, IN GENERAL",18407
Unknown,CONJOINT CONTROL OF VEHICLE SUB-UNITS OF DIFFERENT TYPE OR DIFFERENT FUNCTION; CONTROL SYSTEMS SPECIALLY ADAPTED FOR HYBRID VEHICLES; ROAD VEHICLE DRIVE CONTROL SYSTEMS FOR PURPOSES NOT RELATED TO THE CONTROL OF A PARTICULAR SUB-UNIT,17923
Unknown,LUBRICATING COMPOSITIONS; USE OF CHEMICAL SUBSTANCES EITHER ALONE OR AS LUBRICATING INGREDIENTS IN A LUBRICATING COMPOSITION,17884
Unknown,"TREATMENT OF WATER, WASTE WATER, SEWAGE, OR SLUDGE",17654
Unknown,TRANSMISSION,17435
Unknown,OPTICAL DEVICES OR ARRANGEMENTS FOR THE CONTROL OF LIGHT BY MODIFICATION OF THE OPTICAL PROPERTIES OF THE MEDIA OF THE ELEMENTS INVOLVED THEREIN; NON-LINEAR

2025-01-25 10:41:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:41:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:41:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:41:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:41:05 - snowflake.connector.connection - INFO - closed
2025-01-25 10:41:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:41:06 - root - INFO - SQL:
SELECT
    t."publication_number" AS "Citing_Publication_Number",
    c.value:"publication_number"::STRING AS "Cited_Publication_Number"
FROM
    PATENTS.PATENTS.PUBLICATIONS t
    CROSS JOIN LATERAL FLATTEN(input => t."citation") c
LIMIT 100
Results:
Citing_Publication_Number,Cited_Publication_Number
IT-MI20100845-A1,US-1654188-A
IT-MI20100845-A1,US-2506292-A
IT-MI20100845-A1,DE-4307918-A1
IT-MI20100845-A1,DE-19810417-A1
IT-MI20100845-A1,WO-2008068591-A2
IT-VI20090183-A1,CH-326215-A
IT-VI20090183-A1,US-5134380-A
IT-VI20090183-A1,US-5216409-A
IT-VI20090183-A1,US-5736637-A
IT-VI20090183-A1,EP-1411348-A1
IT-TO20100206-A1,DE-1580149-A1
IT-TO20100206-A1,DE-10252996-A1
IT-TO20100206-A1,FR-2865440-A1
IT-TO20100206-A1,DE-102004046678-A1
IT-TO20100206-A1,FR-2895705-A1
IT-PZ20150004-A1,
IT-PZ20150004-A1,
IT-PZ20150004-A1,
IT-PZ20150004-A1,
IT-PZ20150004-A1,
IT-UA20161603-A1,AU-551882-B2
IT-UA20161603-A1,EP-1881576-A1
IT-UA20161603-A1,GB-2465609-A
IT-UA20161603-A1,US-2013029541-A1
IT-UA20161603-A1,DE-102013101120-A1
IT-UA20161603-A1,US-2015200530-A1
IT-BO20080517-A1,DE-3030931-A1
IT-BO20080517-A1,US-5467567-A
IT-BO20080517-A1,US-5572847-A
IT-BO20080517-A1,EP-0744497-A1
IT-BO20080517-A1,DE-19732904-A1
IT-BO20080517-A1,EP-1072726-A1
IT-BO20080731-A1,FR-2781409-A1
IT-BO20080731-A1,US-2002158357-A1
IT-UB20160960-A1,US-6481795-B1
IT-UB20160960-A1,US-2009230743-A1
IT-UB20160960-A1,EP-2653196-A2
IT-UB20160960-A1,WO-2014085732-A1
IT-TO20090280-A1,DE-1238299-B
IT-TO20090280-A1,US-3358522-A
IT-TO20090280-A1,US-5083984-A
IT-TO20090280-A1,US-5277667-A
IT-TO20090280-A1,GB-2348262-A
IT-UB20160584-A1,US-668479-A
IT-UB20160584-A1,US-968952-A
IT-UB20160584-A1,US-1043743-A
IT-UB20160584-A1,US-1305661-A
IT-MI20101275-A1,DE-1034672-B
IT-MI20101275-A1,US-3630639-A
IT-MI20101275-A1,EP-0039977-A1
IT-MI20101275-A1,US-2005092392-A1
IT-MI20101275-A1,DE-10362075-A1
IT-MI20101275-A1,WO-2010028852-A2
IT-VA20090003-A1,EP-0737566-A1
IT-VA20090003-A1,WO-0043272-A1
IT-VA20090003-A1,WO-2004087527-A1
IT-VA20090003-A1,EP-1619137-A1
IT-VA20090003-A1,WO-2008086388-A1
IT-VA20090003-A1,DE-202008009634-U1
IT-RM20080370-A1,US-3406618-A
IT-RM20080370-A1,US-4131406-A
IT-RM20080370-A1,US-4231677-A
IT-RM20080370-A1,US-5033906-A
IT-RM20080370-A1,WO-0066857-A1
IT-RM20080370-A1,US-6595768-B1
IT-TV20130044-A1,US-5144899-A
IT-TV20130044-A1,JP-H05272046-A
IT-TV20130044-A1,WO-2004058415-A1
IT-TV20130044-A1,US-2004221780-A1
IT-TV20130044-A1,US-2005178309-A1
IT-TV20130044-A1,US-6957614-B1
IT-TV20130044-A1,US-2011297062-A1
IT-MI20091791-A1,WO-9822370-A1
IT-MI20091791-A1,US-6182823-B1
IT-MI20091791-A1,JP-2002059987-A
IT-MI20091791-A1,WO-0221531-A1
IT-MI20091791-A1,JP-2002345740-A
IT-MI20091791-A1,DE-20216034-U1
IT-MI20091791-A1,JP-2004352365-A
IT-MI20091791-A1,DE-10323914-A1
IT-MI20091791-A1,JP-2007112473-A
IT-MI20091791-A1,US-2008135430-A1
IT-UB20160009-A1,US-4168924-A
IT-UB20160009-A1,US-4288956-A
IT-UB20160009-A1,EP-0059466-A1
IT-UB20160009-A1,DE-3102120-A1
IT-UB20160009-A1,DE-3445187-A1
IT-UB20160009-A1,WO-9316247-A1
AT-514400-A1,DE-10149649-A1
AT-514400-A1,WO-2011024177-A1
CH-712732-A1,EP-0507299-A2
CH-712732-A1,US-5640508-A
CH-712732-A1,US-2004199817-A1
CH-712732-A1,US-2010287421-A1
CH-712732-A1,
FR-2894722-A1,GB-1247790-A
FR-2894722-A1,EP-0059939-A1
FR-2894722-A1,DE-3413740-A1
FR-2894722-A1,EP-0802580-A1
FR-2894722-A1,WO-03005491-A1

2025-01-25 10:41:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:41:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:41:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:42:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:42:38 - snowflake.connector.connection - INFO - closed
2025-01-25 10:42:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:42:38 - root - INFO - SQL:
SELECT DISTINCT
    c.value:"code"::STRING AS "CPC_Code",
    d."titleFull" AS "CPC_Title"
FROM
    PATENTS.PATENTS.PUBLICATIONS t
    CROSS JOIN LATERAL FLATTEN(input => t."cpc") c
    JOIN PATENTS.PATENTS.CPC_DEFINITION d ON c.value:"code"::STRING = d."symbol"
LIMIT 100
Results:
Too long, hard cut:
CPC_Code,CPC_Title
F16H37/08,"Combinations of mechanical gearings, not provided for in groups F16H1/00 - F16H35/00 comprising essentially only toothed or friction gearings with a plurality of driving or driven shafts; with arrangements for dividing torque between two or more intermediate shafts with differential gearing"
G06F18/253,Fusion techniques of extracted features
G02F1/133627,Projection-direct viewing
A61K39/4631,Chimeric Antigen Receptors [CAR]
H05B2203/026,Heaters specially adapted for floor heating
A61K31/606,Salicylic acid; Derivatives thereof having amino groups
A23V2250/1882,Polyunsaturated fatty acids
A61F2/4603,"Special tools or methods for implanting or extracting artificial joints, accessories, bone grafts or substitutes, or particular adaptations therefor for insertion or extraction of endoprosthetic joints or of accessories thereof"
Y02P70/50,Manufacturing or production processes characterised by the final manufactured product
G03H1/0256,Laminate comprising a hologram layer having specific functional layer
C08G63/91,Polymers modified by chemical after-treatment
H04B10/0799,Monitoring line transmitter or line receiver equipment
B41J2/3353,Protective layers
Y10T428/31667,"Next to addition polymer from unsaturated monomers, or aldehyde or ketone condensation product"
F01N2260/06,"Exhaust treating devices having provisions not otherwise provided for for improving exhaust evacuation or circulation, or reducing back-pressure"
C08K5/14,Peroxides
H01G4/1209,Ceramic dielectrics characterised by the ceramic dielectric material
E04G21/3204,Safety or protective measures for persons during the construction of buildings against falling down
H01L28/20,Resistors
B26D5/34,"Arrangements for operating and controlling machines or devices for cutting, cutting-out, stamping-out, punching, perforating, or severing by means other than cutting with interrelated action between the cutting member and work feed having the cutting member controlled by scanning a record carrier scanning being effected by a photosensitive device"
C07K2319/04,Fusion polypeptide containing a localisation/targetting motif containing an ER retention signal such as a C-terminal HDEL motif
F04B2201/121,Load on the sucker rod
A47B13/003,Connecting table tops to underframes
B32B2250/02,2 layers
B32B2250/05,5 or more layers
F02M25/0836,"Arrangement of valves controlling the admission of fuel vapour to an engine, e.g. valve being disposed between fuel tank or absorption canister and intake manifold"
G11B7/0033,"Recording, reproducing or erasing systems characterised by the shape or form of the carrier with cards or other card-like flat carriers, e.g. flat sheets of optical film"
G10L15/32,"Multiple recognisers used in sequence or in parallel; Score combination systems therefor, e.g. voting systems"
A01K67/027,New or modified breeds of vertebrates
G01B11/0608,Height gauges
H01L23/3128,"Encapsulations, e.g. encapsulating layers, coatings, e.g. for protection characterised by the arrangement or shape the device being completely enclosed a substrate forming part of the encapsulation the substrate having spherical bumps for external connection"
B29C41/14,Dipping a core
B29C2793/009,Shaping techniques involving a cutting or machining operation after shaping
E04C1/395,"Building elements of block or other shape for the construction of parts of buildings characterised by special adaptations, e.g. serving for locating conduits, for forming soffits, cornices, or shelves, for fixing wall-plates or door-frames, for claustra for claustra, fences, planting walls, e.g. sound-absorbing"
A44C17/02,"Settings for holding gems or the like, e.g. for ornaments or decorations"
C12N5/0621,"Eye cells, e.g. cornea, iris pigmented cells"
B29B17/0412,"Disintegrating plastics, e.g. by milling to large particles, e.g. beads, granules, flakes, slices"
A23L2/56,Flavouring or bittering agents
C22C38/14,"Ferrous alloys, e.g. steel alloys containing titanium or zirconium"
A61K39/001182,Carcinoembryonic antigen [CEA]
A61K9/0095,"Drinks; Beverages; Syrups; Compositions for reconstitution thereof, e.g. powders or tablets to be dispersed in a glass of water; Veterinary drenches"
A47J37/0754,Roasting devices for outdoor use; Barbecues with blowers providing forced air circulation
C12N2830/50,"Vector systems having a special element relevant for transcription regulating RNA stability, not being an intron, e.g. poly A signal"
B67D2210/00007,Filters for gas
A61K48/005,"Medicinal preparations containing genetic material which is inserted into cells of the living body to treat genetic diseases; Gene therapy characterised by an aspect of the 'active' part of the composition delivered, i.e. the nucleic acid delivered"
G06N3/04,"Architecture, e.g. interconnection topology"
H01L2224/08145,"Disposition the bonding area connecting directly to another bonding area, i.e. connectorless bonding, e.g. bumpless bonding the bonding area connecting between different semiconductor or solid-state bodies, 

2025-01-25 10:42:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:42:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:42:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:42:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:42:40 - snowflake.connector.connection - INFO - closed
2025-01-25 10:42:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:43:15 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:43:15 - root - INFO - ```sql
WITH Denso_Patents AS (
    SELECT DISTINCT t."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    CROSS JOIN LATERAL FLATTEN(input => t."assignee") f
    WHERE f.value:"organization"::STRING ILIKE '%DENSO CORP%'
),
Citations_To_Denso AS (
    SELECT DISTINCT
        citing."publication_number" AS "Citing_Publication_Number",
        COALESCE(f_assignee.value:"organization"::STRING, 'Unknown') AS "Assignee",
        SUBSTR(c_cpc.value:"code"::STRING, 1, 4) AS "CPC_Main_Code"
    FROM PATENTS.PATENTS.PUBLICATIONS citing
    CROSS JOIN LATERAL FLATTEN(input => citing."citation") c_citation
    LEFT JOIN LATERAL FLATTEN(input => citing."cpc") c_cpc ON TRUE
    LEFT JOIN LATERAL FLATTEN(input => citing."assignee") f_assignee ON TRUE
    WHERE c_citation.value:"publication_number"::STRING IN (SELECT "publication_number" FROM Denso_Patents)
        AND (f_assignee.value:"organization"::STRING IS NULL OR f_assignee.value:"organization"::STRING NOT ILIKE '%DENSO CORP%')
    LIMIT 100000
),
CPC_Titles AS (
    SELECT DISTINCT "symbol", "titleFull"
    FROM PATENTS.PATENTS.CPC_DEFINITION
)
SELECT
    "Assignee",
    COALESCE(CPC_Titles."titleFull", 'Unknown') AS "CPC_Subclass_Title",
    COUNT(*) AS "Citation_Count"
FROM Citations_To_Denso
LEFT JOIN CPC_Titles
    ON CPC_Titles."symbol" = Citations_To_Denso."CPC_Main_Code"
WHERE CPC_Titles."titleFull" IS NOT NULL
GROUP BY "Assignee", "CPC_Subclass_Title"
ORDER BY "Citation_Count" DESC
LIMIT 100;
```
2025-01-25 10:43:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:43:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:43:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:43:17 - snowflake.connector.connection - INFO - closed
2025-01-25 10:43:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:43:54 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:43:54 - root - INFO - ```sql
SELECT
    COALESCE(f.value:"organization"::STRING, 'Unknown') AS "Assignee_Organization",
    c.value:"code"::STRING AS "CPC_Code"
FROM
    PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee") f,
    LATERAL FLATTEN(input => t."cpc") c
WHERE
    f.value:"organization" IS NOT NULL
LIMIT 100;
```
2025-01-25 10:43:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:43:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:43:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:43:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-25 10:43:55 - snowflake.connector.connection - INFO - closed
2025-01-25 10:43:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:45:20 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:45:20 - root - INFO - ```sql
SELECT
    cp."publication_number" AS "Citing_Publication_Number",
    cpc_def."titleFull" AS "CPC_Subclass_Title",
    COUNT(*) AS "Citation_Count"
FROM
    PATENTS.PATENTS.PUBLICATIONS cp
    CROSS JOIN LATERAL FLATTEN(input => cp."citation") c
    CROSS JOIN LATERAL FLATTEN(input => cp."cpc") cpc_code
    LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_def
        ON cpc_def."symbol" = SUBSTR(cpc_code.value:"code"::STRING, 1, 4)
WHERE
    c.value:"publication_number"::STRING IN (
        SELECT DISTINCT "pub_cleaned"
        FROM PATENTS.PATENTS.DISCLOSURES_13
        WHERE "patent_owner_harmonized" ILIKE '%DENSO%'
    )
GROUP BY
    cp."publication_number",
    cpc_def."titleFull"
ORDER BY
    "Citation_Count" DESC
LIMIT 100;
```
2025-01-25 10:45:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:45:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:45:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:45:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:45:22 - snowflake.connector.connection - INFO - closed
2025-01-25 10:45:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:45:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:45:40 - root - INFO - SQL:
SELECT
    cp."publication_number" AS "Citing_Publication_Number",
    cpc_def."titleFull" AS "CPC_Subclass_Title",
    COUNT(*) AS "Citation_Count"
FROM
    PATENTS.PATENTS.PUBLICATIONS cp
    CROSS JOIN LATERAL FLATTEN(input => cp."citation") c
    CROSS JOIN LATERAL FLATTEN(input => cp."cpc") cpc_code
    LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_def
        ON cpc_def."symbol" = SUBSTR(cpc_code.value:"code"::STRING, 1, 4)
WHERE
    c.value:"publication_number"::STRING IN (
        SELECT DISTINCT "pub_cleaned"
        FROM PATENTS.PATENTS.DISCLOSURES_13
        WHERE "patent_owner_harmonized" ILIKE '%DENSO%'
    )
GROUP BY
    cp."publication_number",
    cpc_def."titleFull"
ORDER BY
    "Citation_Count" DESC
LIMIT 100;
Results:
Too long, hard cut:
Citing_Publication_Number,CPC_Subclass_Title,Citation_Count
US-10337029-B2,"MICROORGANISMS OR ENZYMES; COMPOSITIONS THEREOF; PROPAGATING, PRESERVING, OR MAINTAINING MICROORGANISMS; MUTATION OR GENETIC ENGINEERING; CULTURE MEDIA",141323
US-9226006-B2,"PICTORIAL COMMUNICATION, e.g. TELEVISION",45496
US-11500897-B2,ELECTRIC DIGITAL DATA PROCESSING,41148
US-11452433-B2,DIAGNOSIS; SURGERY; IDENTIFICATION,39216
US-12045451-B2,ELECTRIC DIGITAL DATA PROCESSING,34716
US-11056344-B2,"COATING METALLIC MATERIAL; COATING MATERIAL WITH METALLIC MATERIAL; SURFACE TREATMENT OF METALLIC MATERIAL BY DIFFUSION INTO THE SURFACE, BY CHEMICAL CONVERSION OR SUBSTITUTION; COATING BY VACUUM EVAPORATION, BY SPUTTERING, BY ION IMPLANTATION OR BY CHEMICAL VAPOUR DEPOSITION, IN GENERAL",27420
US-10195046-B2,"FILTERS IMPLANTABLE INTO BLOOD VESSELS; PROSTHESES; DEVICES PROVIDING PATENCY TO, OR PREVENTING COLLAPSING OF, TUBULAR STRUCTURES OF THE BODY, e.g. STENTS; ORTHOPAEDIC, NURSING OR CONTRACEPTIVE DEVICES; FOMENTATION; TREATMENT OR PROTECTION OF EYES OR EARS; BANDAGES, DRESSINGS OR ABSORBENT PADS; FIRST-AID KITS",27384
US-11950835-B2,DIAGNOSIS; SURGERY; IDENTIFICATION,25567
US-11092593-B2,INVESTIGATING OR ANALYSING MATERIALS BY DETERMINING THEIR CHEMICAL OR PHYSICAL PROPERTIES,25043
US-11056344-B2,SEMICONDUCTOR DEVICES NOT COVERED BY CLASS H10,22850
US-11902122-B2,"TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION",22797
US-10214770-B2,"MEASURING OR TESTING PROCESSES INVOLVING ENZYMES, NUCLEIC ACIDS OR MICROORGANISMS; COMPOSITIONS OR TEST PAPERS THEREFOR; PROCESSES OF PREPARING SUCH COMPOSITIONS; CONDITION-RESPONSIVE CONTROL IN MICROBIOLOGICAL OR ENZYMOLOGICAL PROCESSES",19950
US-10756049-B2,SEMICONDUCTOR DEVICES NOT COVERED BY CLASS H10,19728
US-10781451-B2,"MICROORGANISMS OR ENZYMES; COMPOSITIONS THEREOF; PROPAGATING, PRESERVING, OR MAINTAINING MICROORGANISMS; MUTATION OR GENETIC ENGINEERING; CULTURE MEDIA",19536
US-11092593-B2,CHEMICAL OR PHYSICAL LABORATORY APPARATUS FOR GENERAL USE,17435
WO-2017152085-A1,PEPTIDES,17068
US-10576130-B2,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",17006
US-11744935-B2,"DEVICES FOR INTRODUCING MEDIA INTO, OR ONTO, THE BODY; DEVICES FOR TRANSDUCING BODY MEDIA OR FOR TAKING MEDIA FROM THE BODY; DEVICES FOR PRODUCING OR ENDING SLEEP OR STUPOR",16500
US-9079949-B1,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,16330
US-10337029-B2,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,15530
US-11092593-B2,"CHEMICAL OR PHYSICAL PROCESSES, e.g. CATALYSIS OR COLLOID CHEMISTRY; THEIR RELEVANT APPARATUS",15216
US-10771024-B2,SEMICONDUCTOR DEVICES NOT COVERED BY CLASS H10,13815
US-9340798-B2,"MICROORGANISMS OR ENZYMES; COMPOSITIONS THEREOF; PROPAGATING, PRESERVING, OR MAINTAINING MICROORGANISMS; MUTATION OR GENETIC ENGINEERING; CULTURE MEDIA",13644
US-10822404-B2,PEPTIDES,13631
US-11021727-B2,ENZYMES,13203
US-11446260-B2,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",13120
US-11902122-B2,ELECTRIC DIGITAL DATA PROCESSING,12546
US-9169235-B2,HETEROCYCLIC COMPOUNDS,12402
US-7956175-B2,"MEASURING OR TESTING PROCESSES INVOLVING ENZYMES, NUCLEIC ACIDS OR MICROORGANISMS; COMPOSITIONS OR TEST PAPERS THEREFOR; PROCESSES OF PREPARING SUCH COMPOSITIONS; CONDITION-RESPONSIVE CONTROL IN MICROBIOLOGICAL OR ENZYMOLOGICAL PROCESSES",12328
US-11443120-B2,ELECTRIC DIGITAL DATA PROCESSING,11844
US-10004808-B2,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",11835
US-11021727-B2,"MICROORGANISMS OR ENZYMES; COMPOSITIONS THEREOF; PROPAGATING, PRESERVING, OR MAINTAINING MICROORGANISMS; MUTATION OR GENETIC ENGINEERING; CULTURE MEDIA",11736
US-10248966-B2,"PICTORIAL COMMUNICATION, e.g. TELEVISION",11718
US-9079949-B1,PEPTIDES,11360
US-10525029-B2,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",11350
US-10751536-B1,ELECTROTHERAPY; MAGNETOTHERAPY; RADIATION THERAPY; ULTRASOUND THERAPY,11186
US-11580567-B2,"INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES; SYSTEMS OR METHODS SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES, NOT OTHERWISE PROVIDED FOR",11175
US-8753296-B2,"PHYSICAL THERAPY APPARATUS, e.g. DEVICES FOR LOCATING OR STIMULATING REFLEX POINTS IN THE BODY; ARTIFICIAL RESPIRATION; MASSAGE; BATHING DEVICES FOR SPECIAL THERAPEUTIC OR HYGIENIC PURPOSES OR SPECIFIC PARTS OF THE BODY",11151
US-10337029-B2,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",10871
US-9365493-B2,HETEROCYCLIC COMPOUNDS,10672
US-8465914-B2,"MICROORGANISMS OR ENZYMES; COMPOSITIONS THEREOF; PROPAGATING, PRESERVING, OR MAINTAINING MICROORGANISMS; MUTATION OR GENETIC ENGINEERING; CULTURE MEDIA",10630
US-9575648-B2,ELECTRIC DIGITAL DATA PROCESSING,10422
US-8475794-B2,PEPTIDES,9780
US-8465914-B2,"MEASURING OR TESTING PROCESSES INVOLVING ENZYMES, NUCLEIC ACIDS OR MICROORGANISMS; COMPOSITIONS OR TEST PAPERS THEREFOR

2025-01-25 10:45:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:45:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:45:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:45:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:45:42 - snowflake.connector.connection - INFO - closed
2025-01-25 10:45:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:45:42 - root - INFO - SQL:
SELECT
    t."publication_number",
    SUBSTR(c.value:"code"::STRING, 1, 4) AS "CPC_Main_Category"
FROM
    PATENTS.PATENTS.PUBLICATIONS t
    CROSS JOIN LATERAL FLATTEN(input => t."cpc") c
WHERE
    c.value:"code" IS NOT NULL
LIMIT 100
Results:
publication_number,CPC_Main_Category
US-2018235635-A1,A61B
US-2018235635-A1,A61B
US-2018235635-A1,A61B
US-2018235635-A1,A61B
US-2018235635-A1,A61B
US-2018235635-A1,A61B
US-2018235635-A1,A61B
US-2018235635-A1,A61B
US-2018235635-A1,A61B
US-2018201131-A1,B60K
US-2018201131-A1,B60W
US-2018201131-A1,B60K
US-2018201131-A1,B60W
US-2018201131-A1,B60K
US-2018201131-A1,B60K
US-2018201131-A1,B60W
US-2018201131-A1,B60K
US-2018201131-A1,B60W
US-2018201131-A1,B60W
US-2018201131-A1,B60K
US-2018201131-A1,B60W
US-2018201131-A1,B60K
US-2017235415-A1,G06F
US-2017235415-A1,G06F
US-2017235415-A1,G06F
US-2017235415-A1,G06F
US-2017235415-A1,G06F
US-2017235415-A1,G06F
US-2017235415-A1,G06F
US-2017235415-A1,G06F
US-2017244772-A1,H04L
US-2017244772-A1,H04N
US-2017244772-A1,H04L
US-2017244772-A1,H04N
US-2017244772-A1,H04N
US-2017244772-A1,H04L
US-2017244772-A1,H04L
US-2017244772-A1,H04L
US-2017244772-A1,H04L
US-2017244772-A1,H04L
US-2017244772-A1,H04L
US-2017244772-A1,H04L
US-2017244772-A1,H04L
US-2017244772-A1,H04N
US-2017244772-A1,H04N
US-2017244772-A1,H04L
US-2017244772-A1,H04L
US-2017244772-A1,H04L
US-2017244772-A1,H04L
US-2017244772-A1,H04N
US-2017244772-A1,H04L
US-2017244772-A1,H04L
US-2017251351-A1,H04M
US-2017251351-A1,H04L
US-2017251351-A1,H04M
US-2017251351-A1,H04L
US-2017251351-A1,H04M
US-2017251351-A1,H04W
US-2017251351-A1,H04M
US-2017251351-A1,H04W
US-2017251351-A1,H04M
US-2017251351-A1,H04M
US-2017251351-A1,H04M
US-2017251351-A1,H04M
US-2017251351-A1,H04L
US-2017251351-A1,H04W
US-2017251351-A1,H04M
US-2017251351-A1,H04L
US-2017251351-A1,H04W
US-2017251351-A1,H04W
US-2017251351-A1,H04M
US-2018332422-A1,A63F
US-2018332422-A1,A63F
US-2018332422-A1,A63F
US-2018332422-A1,H04S
US-2018332422-A1,H04S
US-2018332422-A1,G11B
US-2018332422-A1,G06F
US-2018332422-A1,H04S
US-2018332422-A1,H04N
US-2018332422-A1,G11B
US-2018332422-A1,A63F
US-2018332422-A1,A63F
US-2018332422-A1,A63F
US-2018332422-A1,H04N
US-2018332422-A1,G11B
US-2018332422-A1,A63F
US-2018332422-A1,A63F
US-2018332422-A1,A63F
US-2018332422-A1,G06T
US-2018332422-A1,A63F
US-2018332422-A1,A63F
US-2018332422-A1,H04S
US-2018332422-A1,G11B
US-2018332422-A1,G11B
US-2018332422-A1,H04N
US-2018332422-A1,G06T
US-2018332422-A1,H04N
US-2018332422-A1,H04S
US-2018332422-A1,G06F

2025-01-25 10:45:42 - root - INFO - itercount: 0
2025-01-25 10:45:42 - root - INFO - Database Name: PATENTS
Schema Name: PATENTS
DDL describes table information.
,0
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,1
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""spif_publication_number"" VARCHAR(16777216),
	""spif_application_number"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""claims_localized_html"" VARIANT,
	""description_localized"" VARIANT,
	""description_localized_html"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""locarno"" VARIANT,
	""citation"" VARIANT,
	""parent"" VARIANT,
	""child"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,2
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

External knowledge that might be helpful: 
### IPC Codes: Handling Main IPC Code Selection

When dealing with the `ipc` field in the `patents-public-data.patents.publications` dataset, it is important to understand the structure of this field, especially the subfield `first`. This subfield is a boolean that indicates whether a given IPC code is the main code for the publication number in question. This is crucial because each patent publication can be associated with multiple IPC codes, signifying the various aspects of the technology covered by the patent.

However, not every publication in the dataset has a designated main IPC code. This lack of a clearly identified main IPC code complicates the process of determining the most relevant IPC code for each publication, as selecting a single IPC code from multiple possibilities without clear prioritization can lead to inconsistent or skewed analyses.

This approach ensures a more consistent and representative selection of IPC codes across the dataset, facilitating more accurate and meaningful analysis of patent trends and classifications. By focusing on the most frequently occurring 4-digit IPC code, the view helps overcome the limitations posed by the absence of a designated main IPC code, thereby enhancing the reliability of patent-related studies and insights derived from this data.

Here is an example

```
SELECT 
    t1.publication_number, 
    SUBSTR(ipc_u.code, 0, 4) as ipc4, 
    COUNT(
    SUBSTR(ipc_u.code, 0, 4)
    ) as ipc4_count 
FROM 
    `patents-public-data.patents.publications` t1, 
    UNNEST(ipc) AS ipc_u 
GROUP BY 
    t1.publication_number, 
    ipc4

```



# Text Embeddings (Similarity)

Patent documents are rich with textual data. In fact, most of the information contained in a patent document is text. This includes the `abstract_localized`, `description_localized`, and `claims_localized`. Textual data can be a powerful tool to analyze and compare patent scope and content across patents. However, before being able to use textual data, it needs to be vectorized or transformed into text embeddings that can be used by machine learning models. Therefore, creating text embeddings from the textual data of patents is necessary to compare patent contents. Technically speaking, running an NLP algorithm that creates embeddings for all U.S. patents is computationally difficult.

Nevertheless, Google runs their own machine learning algorithm which transforms patent text metadata into text embeddings which they report in `patents-public-data.google_patents_research.publications` table. The textual embeddings of one patent, without any knowledge on the algorithm being used to create them, are meaningless on their own. However, the embeddings are powerful when it comes to comparing textual content of two or more patents. Embeddings can be used to calculate a similarity score between any two patents. This similarity score is calculated by applying the dot product of the embeddings vector of the patents, as shown below:

The similarity \( \text{Similarty}_{i,k} \) between two patents \( i \) and \( k \) is calculated as the dot product of their embedding vectors:

\[
\text{Similarty}_{i,k} = \mathbf{v}_i \cdot \mathbf{v}_k
\]

where

\[
\mathbf{v}_i = [v_{i1}, v_{i2}, v_{i3}, \ldots, v_{iN}]
\]
and
\[
\mathbf{v}_k = [v_{k1}, v_{k2}, v_{k3}, \ldots, v_{kN}]
\]

are the embedding vectors for patents \( i \) and \( k \) respectively. The higher the dot product, the more similar the patents.





# Originality (Trajtenberg)

One of the most important measures of a patent is "basicness". The aspects of basicness are tough to measure. Nevertheless, some literature finds that important aspects of these measures are embodied in the relationship between the invention and the technological predcessors and successors it is connected to through, for example, patent citations. We can thus use patent citations to construct measures that identify basicness and appropriability. Trajtenberg et al. 1997 provide a number of these measures. They distinguish between:

1. Forward-looking measures: measures that are derived from the relationship between an invention and subsequent technologies that build upon it. These measures are thus constructed from the forward citations. One example of a forward-looking basicness measure they provide is Generality, which is calculated as:

\[
\text{GENERALITY}_i = 1 - \sum_{k=1}^{N_i} \left( \frac{\text{NCITING}_{G_k}}{\text{NCITING}_i} \right)
\]


2. Backward-looking measures: measures that are derived from the relationship between a given patent and the body of knowledge that preceded it. These measure are thus constructed from the backward citations. One example of a backward-looking basicness measure they provide is Orginality, which is calculated as:

\[
\text{ORIGINALITY}_i = 1 - \sum_{k=1}^{N_i} \left( \frac{\text{NCITED}_{i,k}}{\text{NCITED}_i} \right)
\]

With **NCITING** and **NCITED** defined as the number of patents citing the focal patent and the number of patents cited by the focal patent, respectively. Index `i` corresponds to the focal patent considered, and `k` is the index of patent classes. For example, **NCITED_2,3** refers to the number of patents in patent class 3 and cited by our focal patent 2.


The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **Table:** `PATENTS.PATENTS.PUBLICATIONS`

   - **"publication_number"**: Used to identify individual patent publications.
   - **"assignee_harmonized"**: Contains assignee information; used to find patents assigned to specific organizations.
     - **Nested field "organization"**: The name of the assignee organization.
   - **"citation"**: Contains citations made by the patent; used to find cited patents.
     - **Nested field "publication_number"**: The publication numbers of the cited patents.
   - **"cpc"**: Contains CPC classification codes assigned to the patent.
     - **Nested field "code"**: The full CPC code.

2. **Table:** `PATENTS.PATENTS.CPC_DEFINITION`

   - **"symbol"**: The CPC code; used to join with CPC codes from the publications.
   - **"titleFull"**: The full title of the CPC subclass; provides descriptive information about the CPC code.

**Conditions That May Be Used:**

- Filtering patents assigned to **DENSO CORP** by checking if **"assignee_harmonized"."organization"** contains 'DENSO CORP' using `ILIKE '%DENSO CORP%'`.
- Excluding **DENSO CORP** from results by ensuring **"assignee_harmonized"."organization"** does not contain 'DENSO CORP' using `NOT ILIKE '%DENSO CORP%'`.
- Extracting individual entries from VARIANT columns like **"assignee_harmonized"**, **"citation"**, and **"cpc"** using `LATERAL FLATTEN`.
- Focusing on main categories of CPC codes by processing the **"cpc"** field and possibly truncating codes to represent main categories.

---

**SQL Queries:**

1. **Query 1: Retrieve distinct assignee organizations from the publications.**

   ```sql
   SELECT DISTINCT f.value:"organization"::STRING AS "Assignee_Organization"
   FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."assignee_harmonized") f
   LIMIT 100;
   ```

2. **Query 2: List publication numbers along with their cited publication numbers.**

   ```sql
   SELECT t."publication_number", c.value:"publication_number"::STRING AS "Cited_Publication_Number"
   FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."citation") c
   LIMIT 100;
   ```

3. **Query 3: Show publication numbers and their associated CPC codes.**

   ```sql
   SELECT t."publication_number", c.value:"code"::STRING AS "CPC_Code"
   FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") c
   LIMIT 100;
   ```

4. **Query 4: Extract publication numbers and assignee organizations.**

   ```sql
   SELECT t."publication_number", f.value:"organization"::STRING AS "Assignee_Organization"
   FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."assignee_harmonized") f
   LIMIT 100;
   ```

5. **Query 5: Obtain CPC codes and their full titles from the CPC definition table.**

   ```sql
   SELECT t."symbol" AS "CPC_Code", t."titleFull" AS "CPC_Title"
   FROM PATENTS.PATENTS.CPC_DEFINITION t
   LIMIT 100;
   ```

6. **Query 6: Find patents assigned to DENSO CORP.**

   ```sql
   SELECT t."publication_number", f.value:"organization"::STRING AS "Assignee_Organization"
   FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."assignee_harmonized") f
   WHERE f.value:"organization"::STRING ILIKE '%DENSO CORP%'
   LIMIT 100;
   ```

7. **Query 7: Display citing publication numbers and their cited publication numbers.**

   ```sql
   SELECT t."publication_number" AS "Citing_Publication_Number", c.value:"publication_number"::STRING AS "Cited_Publication_Number"
   FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."citation") c
   LIMIT 100;
   ```

8. **Query 8: List CPC codes from publications and their corresponding titles from CPC definitions.**

   ```sql
   SELECT DISTINCT c.value:"code"::STRING AS "CPC_Code", d."titleFull" AS "CPC_Title"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   JOIN LATERAL FLATTEN(input => t."cpc") c ON TRUE
   JOIN PATENTS.PATENTS.CPC_DEFINITION d ON c.value:"code"::STRING = d."symbol"
   LIMIT 100;
   ```

9. **Query 9: Retrieve assignee organizations and the CPC codes of their patents.**

   ```sql
   SELECT f.value:"organization"::STRING AS "Assignee_Organization", c.value:"code"::STRING AS "CPC_Code"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f ON TRUE
   JOIN LATERAL FLATTEN(input => t."cpc") c ON TRUE
   LIMIT 100;
   ```

10. **Query 10: Extract publication numbers and the main categories of their CPC codes (first four characters).**

    ```sql
    SELECT t."publication_number", SUBSTR(c.value:"code"::STRING, 1, 4) AS "CPC_Main_Category"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") c
    LIMIT 100;
    ```

---

These queries help in understanding the structure and contents of the relevant columns and tables, facilitating the formulation of a solution to the task by exploring the necessary data without directly providing the final answer.Query:
SELECT
    COALESCE(citing_assignees.value::STRING, 'Unknown') AS "Assignee",
    cpc_titles."titleFull" AS "CPC_Subclass_Title",
    COUNT(*) AS "Citation_Count"
FROM
    PATENTS.PATENTS.PUBLICATIONS citing_patents
    CROSS JOIN LATERAL FLATTEN(input => citing_patents."assignee_harmonized") citing_assignees
    CROSS JOIN LATERAL FLATTEN(input => citing_patents."cpc") cpc_codes
    JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_titles
        ON cpc_titles."symbol" = SUBSTR(cpc_codes.value:"code"::STRING, 1, 4)
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC
LIMIT 100;
Answer:
000630 (57014): None: Statement reached its statement or warehouse timeout of 200 second(s) and was canceled.Query:
SELECT t."publication_number", c.value:"publication_number"::STRING AS "Cited_Publication_Number"
   FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."citation") c
   LIMIT 100;
Answer:
publication_number,Cited_Publication_Number
IT-MI20100845-A1,US-1654188-A
IT-MI20100845-A1,US-2506292-A
IT-MI20100845-A1,DE-4307918-A1
IT-MI20100845-A1,DE-19810417-A1
IT-MI20100845-A1,WO-2008068591-A2
IT-VI20090183-A1,CH-326215-A
IT-VI20090183-A1,US-5134380-A
IT-VI20090183-A1,US-5216409-A
IT-VI20090183-A1,US-5736637-A
IT-VI20090183-A1,EP-1411348-A1
IT-TO20100206-A1,DE-1580149-A1
IT-TO20100206-A1,DE-10252996-A1
IT-TO20100206-A1,FR-2865440-A1
IT-TO20100206-A1,DE-102004046678-A1
IT-TO20100206-A1,FR-2895705-A1
IT-PZ20150004-A1,
IT-PZ20150004-A1,
IT-PZ20150004-A1,
IT-PZ20150004-A1,
IT-PZ20150004-A1,
IT-UA20161603-A1,AU-551882-B2
IT-UA20161603-A1,EP-1881576-A1
IT-UA20161603-A1,GB-2465609-A
IT-UA20161603-A1,US-2013029541-A1
IT-UA20161603-A1,DE-102013101120-A1
IT-UA20161603-A1,US-2015200530-A1
IT-BO20080517-A1,DE-3030931-A1
IT-BO20080517-A1,US-5467567-A
IT-BO20080517-A1,US-5572847-A
IT-BO20080517-A1,EP-0744497-A1
IT-BO20080517-A1,DE-19732904-A1
IT-BO20080517-A1,EP-1072726-A1
IT-BO20080731-A1,FR-2781409-A1
IT-BO20080731-A1,US-2002158357-A1
IT-UB20160960-A1,US-6481795-B1
IT-UB20160960-A1,US-2009230743-A1
IT-UB20160960-A1,EP-2653196-A2
IT-UB20160960-A1,WO-2014085732-A1
IT-TO20090280-A1,DE-1238299-B
IT-TO20090280-A1,US-3358522-A
IT-TO20090280-A1,US-5083984-A
IT-TO20090280-A1,US-5277667-A
IT-TO20090280-A1,GB-2348262-A
IT-UB20160584-A1,US-668479-A
IT-UB20160584-A1,US-968952-A
IT-UB20160584-A1,US-1043743-A
IT-UB20160584-A1,US-1305661-A
IT-MI20101275-A1,DE-1034672-B
IT-MI20101275-A1,US-3630639-A
IT-MI20101275-A1,EP-0039977-A1
IT-MI20101275-A1,US-2005092392-A1
IT-MI20101275-A1,DE-10362075-A1
IT-MI20101275-A1,WO-2010028852-A2
IT-VA20090003-A1,EP-0737566-A1
IT-VA20090003-A1,WO-0043272-A1
IT-VA20090003-A1,WO-2004087527-A1
IT-VA20090003-A1,EP-1619137-A1
IT-VA20090003-A1,WO-2008086388-A1
IT-VA20090003-A1,DE-202008009634-U1
IT-RM20080370-A1,US-3406618-A
IT-RM20080370-A1,US-4131406-A
IT-RM20080370-A1,US-4231677-A
IT-RM20080370-A1,US-5033906-A
IT-RM20080370-A1,WO-0066857-A1
IT-RM20080370-A1,US-6595768-B1
IT-TV20130044-A1,US-5144899-A
IT-TV20130044-A1,JP-H05272046-A
IT-TV20130044-A1,WO-2004058415-A1
IT-TV20130044-A1,US-2004221780-A1
IT-TV20130044-A1,US-2005178309-A1
IT-TV20130044-A1,US-6957614-B1
IT-TV20130044-A1,US-2011297062-A1
IT-MI20091791-A1,WO-9822370-A1
IT-MI20091791-A1,US-6182823-B1
IT-MI20091791-A1,JP-2002059987-A
IT-MI20091791-A1,WO-0221531-A1
IT-MI20091791-A1,JP-2002345740-A
IT-MI20091791-A1,DE-20216034-U1
IT-MI20091791-A1,JP-2004352365-A
IT-MI20091791-A1,DE-10323914-A1
IT-MI20091791-A1,JP-2007112473-A
IT-MI20091791-A1,US-2008135430-A1
IT-UB20160009-A1,US-4168924-A
IT-UB20160009-A1,US-4288956-A
IT-UB20160009-A1,EP-0059466-A1
IT-UB20160009-A1,DE-3102120-A1
IT-UB20160009-A1,DE-3445187-A1
IT-UB20160009-A1,WO-9316247-A1
AT-514400-A1,DE-10149649-A1
AT-514400-A1,WO-2011024177-A1
CH-712732-A1,EP-0507299-A2
CH-712732-A1,US-5640508-A
CH-712732-A1,US-2004199817-A1
CH-712732-A1,US-2010287421-A1
CH-712732-A1,
FR-2894722-A1,GB-1247790-A
FR-2894722-A1,EP-0059939-A1
FR-2894722-A1,DE-3413740-A1
FR-2894722-A1,EP-0802580-A1
FR-2894722-A1,WO-03005491-A1
Query:
SELECT t."publication_number", c.value:"code"::STRING AS "CPC_Code"
   FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") c
   LIMIT 100;
Answer:
publication_number,CPC_Code
US-2007068873-A1,G01N2030/202
US-2007068873-A1,Y10T137/86815
US-2007068873-A1,G01N2030/202
US-2007068873-A1,G01N30/6047
US-2007068873-A1,F16K11/074
US-2007068873-A1,G01N30/20
US-2007068873-A1,F16K11/074
US-2007068873-A1,B01D15/1821
US-2007068873-A1,G01N30/20
US-2007068873-A1,B01D15/1821
US-2007068873-A1,G01N30/6047
US-2007068873-A1,G01N2030/201
US-2007068873-A1,G01N2030/201
US-2007068873-A1,Y10T137/86815
US-2007068873-A1,G01N30/461
US-2007068873-A1,G01N30/461
US-2007071679-A1,A61K31/00
US-2007071679-A1,A61K31/00
US-2006103920-A1,G02B7/16
US-2006103920-A1,G02B7/16
US-2006103920-A1,G02B21/248
US-2006103920-A1,Y10T74/19749
US-2006103920-A1,Y10T74/19749
US-2006103920-A1,G02B21/248
US-2006038587-A1,G06F13/4077
US-2006038587-A1,H04L5/16
US-2006038587-A1,G06F13/4077
US-2006038587-A1,H04L5/16
US-2006120188-A1,G11B7/004
US-2006120188-A1,G11B7/00375
US-2006120188-A1,G11B20/10
US-2006120188-A1,G11B19/04
US-2006120188-A1,G11B7/00375
US-2006120188-A1,G11B19/04
US-2006118739-A1,G06V20/66
US-2006118739-A1,G06V10/143
US-2006118739-A1,G06V20/66
US-2006118739-A1,G06V10/143
US-2006118739-A1,G06V20/80
US-2006118739-A1,G06V20/80
US-2006118739-A1,C03C3/095
US-2006118739-A1,C03C3/091
US-2006118739-A1,C09D11/03
US-2006118739-A1,C03C12/00
US-2006118739-A1,C03C3/091
US-2006118739-A1,C03C12/00
US-2006118739-A1,C03C3/095
US-2006118739-A1,C09D11/03
US-2006115954-A1,H01L28/91
US-2006115954-A1,H01L28/91
US-2006115954-A1,H10B12/033
US-2006115954-A1,H10B12/00
US-2006115954-A1,H10B12/033
US-2006115954-A1,H10B12/318
US-2006115954-A1,H10B12/318
US-2006092043-A1,G07C5/008
US-2006092043-A1,G08G1/0116
US-2006092043-A1,G07C5/0891
US-2006092043-A1,G08G1/0116
US-2006092043-A1,G07C5/008
US-2006092043-A1,G08G1/205
US-2006092043-A1,G08G1/205
US-2006092043-A1,G07C5/0891
US-2006240659-A1,H01L21/76877
US-2006240659-A1,H01L21/76877
US-2006240659-A1,H01L21/28
US-2006103888-A1,H04N19/42
US-2006103888-A1,H04N19/44
US-2006103888-A1,H04N21/40
US-2006103888-A1,H04N19/42
US-2006103888-A1,H04N19/42
US-2006103888-A1,H04N19/44
US-2007103691-A1,G01C19/721
US-2007103691-A1,G01C19/721
US-2007233220-A1,A61F2/89
US-2007233220-A1,A61F2/954
US-2007233220-A1,A61F2002/075
US-2007233220-A1,A61F2002/075
US-2007233220-A1,A61F2230/0078
US-2007233220-A1,A61F2002/067
US-2007233220-A1,A61F2230/0078
US-2007233220-A1,A61F2002/061
US-2007233220-A1,A61F2/954
US-2007233220-A1,A61F2002/067
US-2007233220-A1,A61F2230/0054
US-2007233220-A1,A61F2/07
US-2007233220-A1,A61F2230/0054
US-2007233220-A1,A61F2/07
US-2007233220-A1,A61F2002/061
US-2007233220-A1,A61F2/89
US-2007241792-A1,H03K19/00384
US-2007241792-A1,H03K19/094
US-2007241792-A1,H03K19/00384
US-2007241792-A1,H03K19/20
US-2007241792-A1,H03K19/20
US-2007241792-A1,H03K19/094
US-2006150701-A1,B21B37/16
US-2006150701-A1,B21B1/18
US-2006150701-A1,B21B37/50
US-2006150701-A1,B21B37/52
Query:
SELECT
    COALESCE(cp."assignee"[0]:"organization"::STRING, 'Unknown') AS "Assignee",
    cpc_def."titleFull" AS "CPC_Subclass_Title",
    COUNT(*) AS "Citation_Count"
FROM
    PATENTS.PATENTS.PUBLICATIONS cp
    CROSS JOIN LATERAL FLATTEN(input => cp."cpc") cpc_code
    JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_def
        ON cpc_def."symbol" = SUBSTR(cpc_code.value:"code"::STRING, 1, 4)
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC
LIMIT 100;
Answer:
000630 (57014): None: Statement reached its statement or warehouse timeout of 200 second(s) and was canceled.Query:
SELECT t."symbol" AS "CPC_Code", t."titleFull" AS "CPC_Title"
   FROM PATENTS.PATENTS.CPC_DEFINITION t
   LIMIT 100;
Answer:
Too long, hard cut:
CPC_Code,CPC_Title
B,PERFORMING OPERATIONS; TRANSPORTING
H,ELECTRICITY
Y,GENERAL TAGGING OF NEW TECHNOLOGICAL DEVELOPMENTS; GENERAL TAGGING OF CROSS-SECTIONAL TECHNOLOGIES SPANNING OVER SEVERAL SECTIONS OF THE IPC; TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS
D,TEXTILES; PAPER
F,MECHANICAL ENGINEERING; LIGHTING; HEATING; WEAPONS; BLASTING
E,FIXED CONSTRUCTIONS
C,CHEMISTRY; METALLURGY
G,PHYSICS
A,HUMAN NECESSITIES
A45,HAND OR TRAVELLING ARTICLES
A24,TOBACCO; CIGARS; CIGARETTES; SIMULATED SMOKING DEVICES; SMOKERS' REQUISITES
A61,MEDICAL OR VETERINARY SCIENCE; HYGIENE
A63,SPORTS; GAMES; AMUSEMENTS
A22,BUTCHERING; MEAT TREATMENT; PROCESSING POULTRY OR FISH
A42,HEADWEAR
A99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
A43,FOOTWEAR
A01,AGRICULTURE; FORESTRY; ANIMAL HUSBANDRY; HUNTING; TRAPPING; FISHING
A62,LIFE-SAVING; FIRE-FIGHTING
A23,"FOODS OR FOODSTUFFS; TREATMENT THEREOF, NOT COVERED BY OTHER CLASSES"
A47,FURNITURE; DOMESTIC ARTICLES OR APPLIANCES; COFFEE MILLS; SPICE MILLS; SUCTION CLEANERS IN GENERAL
A46,BRUSHWARE
A44,HABERDASHERY; JEWELLERY
A21,BAKING; EDIBLE DOUGHS
A41,WEARING APPAREL
B27,WORKING OR PRESERVING WOOD OR SIMILAR MATERIAL; NAILING OR STAPLING MACHINES IN GENERAL
B68,SADDLERY; UPHOLSTERY
B04,CENTRIFUGAL APPARATUS OR MACHINES FOR CARRYING-OUT PHYSICAL OR CHEMICAL PROCESSES
B23,MACHINE TOOLS; METAL-WORKING NOT OTHERWISE PROVIDED FOR
B30,PRESSES
B21,MECHANICAL METAL-WORKING WITHOUT ESSENTIALLY REMOVING MATERIAL; PUNCHING METAL
B25,HAND TOOLS; PORTABLE POWER-DRIVEN TOOLS; MANIPULATORS
B99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
B29,WORKING OF PLASTICS; WORKING OF SUBSTANCES IN A PLASTIC STATE IN GENERAL
B31,"MAKING ARTICLES OF PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER; WORKING PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER"
B26,HAND CUTTING TOOLS; CUTTING; SEVERING
B66,HOISTING; LIFTING; HAULING
B02,"CRUSHING, PULVERISING, OR DISINTEGRATING; PREPARATORY TREATMENT OF GRAIN FOR MILLING"
B65,CONVEYING; PACKING; STORING; HANDLING THIN OR FILAMENTARY MATERIAL
B61,RAILWAYS
B24,GRINDING; POLISHING
B06,GENERATING OR TRANSMITTING MECHANICAL VIBRATIONS IN GENERAL
B43,WRITING OR DRAWING IMPLEMENTS; BUREAU ACCESSORIES
B62,LAND VEHICLES FOR TRAVELLING OTHERWISE THAN ON RAILS
B64,AIRCRAFT; AVIATION; COSMONAUTICS
B22,CASTING; POWDER METALLURGY
B28,"WORKING CEMENT, CLAY, OR STONE"
B09,DISPOSAL OF SOLID WASTE; RECLAMATION OF CONTAMINATED SOIL
B01,PHYSICAL OR CHEMICAL PROCESSES OR APPARATUS IN GENERAL
B63,SHIPS OR OTHER WATERBORNE VESSELS; RELATED EQUIPMENT
B60,VEHICLES IN GENERAL
B44,DECORATIVE ARTS
B07,SEPARATING SOLIDS FROM SOLIDS; SORTING
B08,CLEANING
B82,NANOTECHNOLOGY
B42,BOOKBINDING; ALBUMS; FILES; SPECIAL PRINTED MATTER
B32,LAYERED PRODUCTS
B81,MICROSTRUCTURAL TECHNOLOGY
B05,"SPRAYING OR ATOMISING IN GENERAL; APPLYING FLUENT MATERIALS TO SURFACES, IN GENERAL"
B41,PRINTING; LINING MACHINES; TYPEWRITERS; STAMPS
B03,SEPARATION OF SOLID MATERIALS USING LIQUIDS OR USING PNEUMATIC TABLES OR JIGS; MAGNETIC OR ELECTROSTATIC SEPARATION OF SOLID MATERIALS FROM SOLID MATERIALS OR FLUIDS; SEPARATION BY HIGH-VOLTAGE ELECTRIC FIELDS
B67,"OPENING, CLOSING OR CLEANING BOTTLES, JARS OR SIMILAR CONTAINERS; LIQUID HANDLING"
B33,ADDITIVE MANUFACTURING TECHNOLOGY
C22,METALLURGY; FERROUS OR NON-FERROUS ALLOYS; TREATMENT OF ALLOYS OR NON-FERROUS METALS
C23,"COATING METALLIC MATERIAL; COATING MATERIAL WITH METALLIC MATERIAL; CHEMICAL SURFACE TREATMENT; DIFFUSION TREATMENT OF METALLIC MATERIAL; COATING BY VACUUM EVAPORATION, BY SPUTTERING, BY ION IMPLANTATION OR BY CHEMICAL VAPOUR DEPOSITION, IN GENERAL; INHIBITING CORROSION OF METALLIC MATERIAL OR INCRUSTATION IN GENERAL"
C06,EXPLOSIVES; MATCHES
C02,"TREATMENT OF WATER, WASTE WATER, SEWAGE, OR SLUDGE"
C07,ORGANIC CHEMISTRY
C25,ELECTROLYTIC OR ELECTROPHORETIC PROCESSES; APPARATUS THEREFOR
C30,CRYSTAL GROWTH
C12,BIOCHEMISTRY; BEER; SPIRITS; WINE; VINEGAR; MICROBIOLOGY; ENZYMOLOGY; MUTATION OR GENETIC ENGINEERING
C99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
C05,FERTILISERS; MANUFACTURE THEREOF
C40,COMBINATORIAL TECHNOLOGY
C11,"ANIMAL OR VEGETABLE OILS, FATS, FATTY SUBSTANCES OR WAXES; FATTY ACIDS THEREFROM; DETERGENTS; CANDLES"
C08,ORGANIC MACROMOLECULAR COMPOUNDS; THEIR PREPARATION OR CHEMICAL WORKING-UP; COMPOSITIONS BASED THEREON
C10,"PETROLEUM, GAS OR COKE INDUSTRIES; TECHNICAL GASES CONTAINING CARBON MONOXIDE; FUELS; LUBRICANTS; PEAT"
C21,METALLURGY OF IRON
C04,CEMENTS; CONCRETE; ARTIFICIAL STONE; CERAMICS; REFRACTORIES
C09,DYES; PAINTS; POLISHES; NATURAL RESINS; ADHESIVES; COMPOSITIONS NOT OTHERWISE PROVIDED FOR; APPLICATIONS OF MATERIALS NOT OTHERWISE PROVIDED FOR
C03,GLASS; MINERAL OR SLAG WOOL
C13,SUGAR INDUSTRY
C14,SKINS; HIDES; PELTS; LEATHER
C01,INORGANIC CHEMISTRY
D02,YARNS; MECHANICAL FINISHING OF YARNS OR ROPES; WARPING OR BEAMING
D21,PAPER-MAKING; PRODUCTION OF CELLULOSE
D04,BRAIDING; LACE-MAKING; KNITTING; TRIMMINGS; NON-WOVEN
Query:
SELECT
    COALESCE(f.value:"organization"::STRING, 'Unknown') AS "Assignee",
    cpc_def."titleFull" AS "CPC_Subclass_Title",
    COUNT(*) AS "Citation_Count"
FROM
    PATENTS.PATENTS.PUBLICATIONS cp
    CROSS JOIN LATERAL FLATTEN(input => cp."assignee") f
    CROSS JOIN LATERAL FLATTEN(input => cp."cpc") c
    LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_def
        ON cpc_def."symbol" = SUBSTR(c.value:"code"::STRING, 1, 4)
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC
LIMIT 100;
Answer:
Too long, hard cut:
Assignee,CPC_Subclass_Title,Citation_Count
Unknown,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",173564
Unknown,SEMICONDUCTOR DEVICES NOT COVERED BY CLASS H10,165505
Unknown,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,110498
Unknown,ELECTRIC DIGITAL DATA PROCESSING,105720
Unknown,DIAGNOSIS; SURGERY; IDENTIFICATION,99837
Unknown,"TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION",89993
Unknown,"PICTORIAL COMMUNICATION, e.g. TELEVISION",83183
Unknown,HETEROCYCLIC COMPOUNDS,78957
Unknown,TECHNICAL SUBJECTS COVERED BY FORMER US CLASSIFICATION,65218
Unknown,"PROCESSES OR MEANS, e.g. BATTERIES, FOR THE DIRECT CONVERSION OF CHEMICAL ENERGY INTO ELECTRICAL ENERGY",59059
Unknown,WIRELESS COMMUNICATION NETWORKS,57782
Unknown,PEPTIDES,53744
Unknown,INVESTIGATING OR ANALYSING MATERIALS BY DETERMINING THEIR CHEMICAL OR PHYSICAL PROPERTIES,53382
Unknown,"LAYERED PRODUCTS, i.e. PRODUCTS BUILT-UP OF STRATA OF FLAT OR NON-FLAT, e.g. CELLULAR OR HONEYCOMB, FORM",49720
Unknown,"DEVICES FOR INTRODUCING MEDIA INTO, OR ONTO, THE BODY; DEVICES FOR TRANSDUCING BODY MEDIA OR FOR TAKING MEDIA FROM THE BODY; DEVICES FOR PRODUCING OR ENDING SLEEP OR STUPOR",49510
Unknown,"SHAPING OR JOINING OF PLASTICS; SHAPING OF MATERIAL IN A PLASTIC STATE, NOT OTHERWISE PROVIDED FOR; AFTER-TREATMENT OF THE SHAPED PRODUCTS, e.g. REPAIRING",47416
Unknown,"MICROORGANISMS OR ENZYMES; COMPOSITIONS THEREOF; PROPAGATING, PRESERVING, OR MAINTAINING MICROORGANISMS; MUTATION OR GENETIC ENGINEERING; CULTURE MEDIA",47265
Unknown,"CHEMICAL OR PHYSICAL PROCESSES, e.g. CATALYSIS OR COLLOID CHEMISTRY; THEIR RELEVANT APPARATUS",41879
Unknown,SEPARATION,38621
Unknown,"FILTERS IMPLANTABLE INTO BLOOD VESSELS; PROSTHESES; DEVICES PROVIDING PATENCY TO, OR PREVENTING COLLAPSING OF, TUBULAR STRUCTURES OF THE BODY, e.g. STENTS; ORTHOPAEDIC, NURSING OR CONTRACEPTIVE DEVICES; FOMENTATION; TREATMENT OR PROTECTION OF EYES OR EARS; BANDAGES, DRESSINGS OR ABSORBENT PADS; FIRST-AID KITS",36512
Unknown,ACYCLIC OR CARBOCYCLIC COMPOUNDS,35571
Unknown,"INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES; SYSTEMS OR METHODS SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES, NOT OTHERWISE PROVIDED FOR",34216
Unknown,"OPTICAL ELEMENTS, SYSTEMS OR APPARATUS",32373
Unknown,"LIME, MAGNESIA; SLAG; CEMENTS; COMPOSITIONS THEREOF, e.g. MORTARS, CONCRETE OR LIKE BUILDING MATERIALS; ARTIFICIAL STONE; CERAMICS; REFRACTORIES; TREATMENT OF NATURAL STONE",28280
Unknown,"IMAGE DATA PROCESSING OR GENERATION, IN GENERAL",27507
Unknown,"REDUCTION OF GREENHOUSE GAS [GHG] EMISSIONS, RELATED TO ENERGY GENERATION, TRANSMISSION OR DISTRIBUTION",25629
Unknown,MACROMOLECULAR COMPOUNDS OBTAINED OTHERWISE THAN BY REACTIONS ONLY INVOLVING UNSATURATED CARBON-TO-CARBON BONDS,24187
Unknown,COMPOSITIONS OF MACROMOLECULAR COMPOUNDS,22629
Unknown,INFORMATION STORAGE BASED ON RELATIVE MOVEMENT BETWEEN RECORD CARRIER AND TRANSDUCER,22426
Unknown,ARRANGEMENTS OR CIRCUITS FOR CONTROL OF INDICATING DEVICES USING STATIC MEANS TO PRESENT VARIABLE INFORMATION,21916
Unknown,PRINTED CIRCUITS; CASINGS OR CONSTRUCTIONAL DETAILS OF ELECTRIC APPARATUS; MANUFACTURE OF ASSEMBLAGES OF ELECTRICAL COMPONENTS,21776
Unknown,"CONTAINERS FOR STORAGE OR TRANSPORT OF ARTICLES OR MATERIALS, e.g. BAGS, BARRELS, BOTTLES, BOXES, CANS, CARTONS, CRATES, DRUMS, JARS, TANKS, HOPPERS, FORWARDING CONTAINERS; ACCESSORIES, CLOSURES, OR FITTINGS THEREFOR; PACKAGING ELEMENTS; PACKAGES",21523
Unknown,TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS,20917
Unknown,ORGANIC ELECTRIC SOLID-STATE DEVICES,19340
Unknown,"METHODS OR APPARATUS FOR STERILISING MATERIALS OR OBJECTS IN GENERAL; DISINFECTION, STERILISATION OR DEODORISATION OF AIR; CHEMICAL ASPECTS OF BANDAGES, DRESSINGS, ABSORBENT PADS OR SURGICAL ARTICLES; MATERIALS FOR BANDAGES, DRESSINGS, ABSORBENT PADS OR SURGICAL ARTICLES",18993
Unknown,"COATING METALLIC MATERIAL; COATING MATERIAL WITH METALLIC MATERIAL; SURFACE TREATMENT OF METALLIC MATERIAL BY DIFFUSION INTO THE SURFACE, BY CHEMICAL CONVERSION OR SUBSTITUTION; COATING BY VACUUM EVAPORATION, BY SPUTTERING, BY ION IMPLANTATION OR BY CHEMICAL VAPOUR DEPOSITION, IN GENERAL",18407
Unknown,CONJOINT CONTROL OF VEHICLE SUB-UNITS OF DIFFERENT TYPE OR DIFFERENT FUNCTION; CONTROL SYSTEMS SPECIALLY ADAPTED FOR HYBRID VEHICLES; ROAD VEHICLE DRIVE CONTROL SYSTEMS FOR PURPOSES NOT RELATED TO THE CONTROL OF A PARTICULAR SUB-UNIT,17923
Unknown,LUBRICATING COMPOSITIONS; USE OF CHEMICAL SUBSTANCES EITHER ALONE OR AS LUBRICATING INGREDIENTS IN A LUBRICATING COMPOSITION,17884
Unknown,"TREATMENT OF WATER, WASTE WATER, SEWAGE, OR SLUDGE",17654
Unknown,TRANSMISSION,17435
Unknown,OPTICAL DEVICES OR ARRANGEMENTS FOR THE CONTROL OF LIGHT BY MODIFICATION OF THE OPTICAL PROPERTIES OF THE MEDIA OF THE ELEMENTS INVOLVED THEREIN; NON-LINEAR
Query:
SELECT
    t."publication_number" AS "Citing_Publication_Number",
    c.value:"publication_number"::STRING AS "Cited_Publication_Number"
FROM
    PATENTS.PATENTS.PUBLICATIONS t
    CROSS JOIN LATERAL FLATTEN(input => t."citation") c
LIMIT 100
Answer:
Citing_Publication_Number,Cited_Publication_Number
IT-MI20100845-A1,US-1654188-A
IT-MI20100845-A1,US-2506292-A
IT-MI20100845-A1,DE-4307918-A1
IT-MI20100845-A1,DE-19810417-A1
IT-MI20100845-A1,WO-2008068591-A2
IT-VI20090183-A1,CH-326215-A
IT-VI20090183-A1,US-5134380-A
IT-VI20090183-A1,US-5216409-A
IT-VI20090183-A1,US-5736637-A
IT-VI20090183-A1,EP-1411348-A1
IT-TO20100206-A1,DE-1580149-A1
IT-TO20100206-A1,DE-10252996-A1
IT-TO20100206-A1,FR-2865440-A1
IT-TO20100206-A1,DE-102004046678-A1
IT-TO20100206-A1,FR-2895705-A1
IT-PZ20150004-A1,
IT-PZ20150004-A1,
IT-PZ20150004-A1,
IT-PZ20150004-A1,
IT-PZ20150004-A1,
IT-UA20161603-A1,AU-551882-B2
IT-UA20161603-A1,EP-1881576-A1
IT-UA20161603-A1,GB-2465609-A
IT-UA20161603-A1,US-2013029541-A1
IT-UA20161603-A1,DE-102013101120-A1
IT-UA20161603-A1,US-2015200530-A1
IT-BO20080517-A1,DE-3030931-A1
IT-BO20080517-A1,US-5467567-A
IT-BO20080517-A1,US-5572847-A
IT-BO20080517-A1,EP-0744497-A1
IT-BO20080517-A1,DE-19732904-A1
IT-BO20080517-A1,EP-1072726-A1
IT-BO20080731-A1,FR-2781409-A1
IT-BO20080731-A1,US-2002158357-A1
IT-UB20160960-A1,US-6481795-B1
IT-UB20160960-A1,US-2009230743-A1
IT-UB20160960-A1,EP-2653196-A2
IT-UB20160960-A1,WO-2014085732-A1
IT-TO20090280-A1,DE-1238299-B
IT-TO20090280-A1,US-3358522-A
IT-TO20090280-A1,US-5083984-A
IT-TO20090280-A1,US-5277667-A
IT-TO20090280-A1,GB-2348262-A
IT-UB20160584-A1,US-668479-A
IT-UB20160584-A1,US-968952-A
IT-UB20160584-A1,US-1043743-A
IT-UB20160584-A1,US-1305661-A
IT-MI20101275-A1,DE-1034672-B
IT-MI20101275-A1,US-3630639-A
IT-MI20101275-A1,EP-0039977-A1
IT-MI20101275-A1,US-2005092392-A1
IT-MI20101275-A1,DE-10362075-A1
IT-MI20101275-A1,WO-2010028852-A2
IT-VA20090003-A1,EP-0737566-A1
IT-VA20090003-A1,WO-0043272-A1
IT-VA20090003-A1,WO-2004087527-A1
IT-VA20090003-A1,EP-1619137-A1
IT-VA20090003-A1,WO-2008086388-A1
IT-VA20090003-A1,DE-202008009634-U1
IT-RM20080370-A1,US-3406618-A
IT-RM20080370-A1,US-4131406-A
IT-RM20080370-A1,US-4231677-A
IT-RM20080370-A1,US-5033906-A
IT-RM20080370-A1,WO-0066857-A1
IT-RM20080370-A1,US-6595768-B1
IT-TV20130044-A1,US-5144899-A
IT-TV20130044-A1,JP-H05272046-A
IT-TV20130044-A1,WO-2004058415-A1
IT-TV20130044-A1,US-2004221780-A1
IT-TV20130044-A1,US-2005178309-A1
IT-TV20130044-A1,US-6957614-B1
IT-TV20130044-A1,US-2011297062-A1
IT-MI20091791-A1,WO-9822370-A1
IT-MI20091791-A1,US-6182823-B1
IT-MI20091791-A1,JP-2002059987-A
IT-MI20091791-A1,WO-0221531-A1
IT-MI20091791-A1,JP-2002345740-A
IT-MI20091791-A1,DE-20216034-U1
IT-MI20091791-A1,JP-2004352365-A
IT-MI20091791-A1,DE-10323914-A1
IT-MI20091791-A1,JP-2007112473-A
IT-MI20091791-A1,US-2008135430-A1
IT-UB20160009-A1,US-4168924-A
IT-UB20160009-A1,US-4288956-A
IT-UB20160009-A1,EP-0059466-A1
IT-UB20160009-A1,DE-3102120-A1
IT-UB20160009-A1,DE-3445187-A1
IT-UB20160009-A1,WO-9316247-A1
AT-514400-A1,DE-10149649-A1
AT-514400-A1,WO-2011024177-A1
CH-712732-A1,EP-0507299-A2
CH-712732-A1,US-5640508-A
CH-712732-A1,US-2004199817-A1
CH-712732-A1,US-2010287421-A1
CH-712732-A1,
FR-2894722-A1,GB-1247790-A
FR-2894722-A1,EP-0059939-A1
FR-2894722-A1,DE-3413740-A1
FR-2894722-A1,EP-0802580-A1
FR-2894722-A1,WO-03005491-A1
Query:
SELECT DISTINCT
    c.value:"code"::STRING AS "CPC_Code",
    d."titleFull" AS "CPC_Title"
FROM
    PATENTS.PATENTS.PUBLICATIONS t
    CROSS JOIN LATERAL FLATTEN(input => t."cpc") c
    JOIN PATENTS.PATENTS.CPC_DEFINITION d ON c.value:"code"::STRING = d."symbol"
LIMIT 100
Answer:
Too long, hard cut:
CPC_Code,CPC_Title
F16H37/08,"Combinations of mechanical gearings, not provided for in groups F16H1/00 - F16H35/00 comprising essentially only toothed or friction gearings with a plurality of driving or driven shafts; with arrangements for dividing torque between two or more intermediate shafts with differential gearing"
G06F18/253,Fusion techniques of extracted features
G02F1/133627,Projection-direct viewing
A61K39/4631,Chimeric Antigen Receptors [CAR]
H05B2203/026,Heaters specially adapted for floor heating
A61K31/606,Salicylic acid; Derivatives thereof having amino groups
A23V2250/1882,Polyunsaturated fatty acids
A61F2/4603,"Special tools or methods for implanting or extracting artificial joints, accessories, bone grafts or substitutes, or particular adaptations therefor for insertion or extraction of endoprosthetic joints or of accessories thereof"
Y02P70/50,Manufacturing or production processes characterised by the final manufactured product
G03H1/0256,Laminate comprising a hologram layer having specific functional layer
C08G63/91,Polymers modified by chemical after-treatment
H04B10/0799,Monitoring line transmitter or line receiver equipment
B41J2/3353,Protective layers
Y10T428/31667,"Next to addition polymer from unsaturated monomers, or aldehyde or ketone condensation product"
F01N2260/06,"Exhaust treating devices having provisions not otherwise provided for for improving exhaust evacuation or circulation, or reducing back-pressure"
C08K5/14,Peroxides
H01G4/1209,Ceramic dielectrics characterised by the ceramic dielectric material
E04G21/3204,Safety or protective measures for persons during the construction of buildings against falling down
H01L28/20,Resistors
B26D5/34,"Arrangements for operating and controlling machines or devices for cutting, cutting-out, stamping-out, punching, perforating, or severing by means other than cutting with interrelated action between the cutting member and work feed having the cutting member controlled by scanning a record carrier scanning being effected by a photosensitive device"
C07K2319/04,Fusion polypeptide containing a localisation/targetting motif containing an ER retention signal such as a C-terminal HDEL motif
F04B2201/121,Load on the sucker rod
A47B13/003,Connecting table tops to underframes
B32B2250/02,2 layers
B32B2250/05,5 or more layers
F02M25/0836,"Arrangement of valves controlling the admission of fuel vapour to an engine, e.g. valve being disposed between fuel tank or absorption canister and intake manifold"
G11B7/0033,"Recording, reproducing or erasing systems characterised by the shape or form of the carrier with cards or other card-like flat carriers, e.g. flat sheets of optical film"
G10L15/32,"Multiple recognisers used in sequence or in parallel; Score combination systems therefor, e.g. voting systems"
A01K67/027,New or modified breeds of vertebrates
G01B11/0608,Height gauges
H01L23/3128,"Encapsulations, e.g. encapsulating layers, coatings, e.g. for protection characterised by the arrangement or shape the device being completely enclosed a substrate forming part of the encapsulation the substrate having spherical bumps for external connection"
B29C41/14,Dipping a core
B29C2793/009,Shaping techniques involving a cutting or machining operation after shaping
E04C1/395,"Building elements of block or other shape for the construction of parts of buildings characterised by special adaptations, e.g. serving for locating conduits, for forming soffits, cornices, or shelves, for fixing wall-plates or door-frames, for claustra for claustra, fences, planting walls, e.g. sound-absorbing"
A44C17/02,"Settings for holding gems or the like, e.g. for ornaments or decorations"
C12N5/0621,"Eye cells, e.g. cornea, iris pigmented cells"
B29B17/0412,"Disintegrating plastics, e.g. by milling to large particles, e.g. beads, granules, flakes, slices"
A23L2/56,Flavouring or bittering agents
C22C38/14,"Ferrous alloys, e.g. steel alloys containing titanium or zirconium"
A61K39/001182,Carcinoembryonic antigen [CEA]
A61K9/0095,"Drinks; Beverages; Syrups; Compositions for reconstitution thereof, e.g. powders or tablets to be dispersed in a glass of water; Veterinary drenches"
A47J37/0754,Roasting devices for outdoor use; Barbecues with blowers providing forced air circulation
C12N2830/50,"Vector systems having a special element relevant for transcription regulating RNA stability, not being an intron, e.g. poly A signal"
B67D2210/00007,Filters for gas
A61K48/005,"Medicinal preparations containing genetic material which is inserted into cells of the living body to treat genetic diseases; Gene therapy characterised by an aspect of the 'active' part of the composition delivered, i.e. the nucleic acid delivered"
G06N3/04,"Architecture, e.g. interconnection topology"
H01L2224/08145,"Disposition the bonding area connecting directly to another bonding area, i.e. connectorless bonding, e.g. bumpless bonding the bonding area connecting between different semiconductor or solid-state bodies, 
Query:
SELECT
    cp."publication_number" AS "Citing_Publication_Number",
    cpc_def."titleFull" AS "CPC_Subclass_Title",
    COUNT(*) AS "Citation_Count"
FROM
    PATENTS.PATENTS.PUBLICATIONS cp
    CROSS JOIN LATERAL FLATTEN(input => cp."citation") c
    CROSS JOIN LATERAL FLATTEN(input => cp."cpc") cpc_code
    LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_def
        ON cpc_def."symbol" = SUBSTR(cpc_code.value:"code"::STRING, 1, 4)
WHERE
    c.value:"publication_number"::STRING IN (
        SELECT DISTINCT "pub_cleaned"
        FROM PATENTS.PATENTS.DISCLOSURES_13
        WHERE "patent_owner_harmonized" ILIKE '%DENSO%'
    )
GROUP BY
    cp."publication_number",
    cpc_def."titleFull"
ORDER BY
    "Citation_Count" DESC
LIMIT 100;
Answer:
Too long, hard cut:
Citing_Publication_Number,CPC_Subclass_Title,Citation_Count
US-10337029-B2,"MICROORGANISMS OR ENZYMES; COMPOSITIONS THEREOF; PROPAGATING, PRESERVING, OR MAINTAINING MICROORGANISMS; MUTATION OR GENETIC ENGINEERING; CULTURE MEDIA",141323
US-9226006-B2,"PICTORIAL COMMUNICATION, e.g. TELEVISION",45496
US-11500897-B2,ELECTRIC DIGITAL DATA PROCESSING,41148
US-11452433-B2,DIAGNOSIS; SURGERY; IDENTIFICATION,39216
US-12045451-B2,ELECTRIC DIGITAL DATA PROCESSING,34716
US-11056344-B2,"COATING METALLIC MATERIAL; COATING MATERIAL WITH METALLIC MATERIAL; SURFACE TREATMENT OF METALLIC MATERIAL BY DIFFUSION INTO THE SURFACE, BY CHEMICAL CONVERSION OR SUBSTITUTION; COATING BY VACUUM EVAPORATION, BY SPUTTERING, BY ION IMPLANTATION OR BY CHEMICAL VAPOUR DEPOSITION, IN GENERAL",27420
US-10195046-B2,"FILTERS IMPLANTABLE INTO BLOOD VESSELS; PROSTHESES; DEVICES PROVIDING PATENCY TO, OR PREVENTING COLLAPSING OF, TUBULAR STRUCTURES OF THE BODY, e.g. STENTS; ORTHOPAEDIC, NURSING OR CONTRACEPTIVE DEVICES; FOMENTATION; TREATMENT OR PROTECTION OF EYES OR EARS; BANDAGES, DRESSINGS OR ABSORBENT PADS; FIRST-AID KITS",27384
US-11950835-B2,DIAGNOSIS; SURGERY; IDENTIFICATION,25567
US-11092593-B2,INVESTIGATING OR ANALYSING MATERIALS BY DETERMINING THEIR CHEMICAL OR PHYSICAL PROPERTIES,25043
US-11056344-B2,SEMICONDUCTOR DEVICES NOT COVERED BY CLASS H10,22850
US-11902122-B2,"TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION",22797
US-10214770-B2,"MEASURING OR TESTING PROCESSES INVOLVING ENZYMES, NUCLEIC ACIDS OR MICROORGANISMS; COMPOSITIONS OR TEST PAPERS THEREFOR; PROCESSES OF PREPARING SUCH COMPOSITIONS; CONDITION-RESPONSIVE CONTROL IN MICROBIOLOGICAL OR ENZYMOLOGICAL PROCESSES",19950
US-10756049-B2,SEMICONDUCTOR DEVICES NOT COVERED BY CLASS H10,19728
US-10781451-B2,"MICROORGANISMS OR ENZYMES; COMPOSITIONS THEREOF; PROPAGATING, PRESERVING, OR MAINTAINING MICROORGANISMS; MUTATION OR GENETIC ENGINEERING; CULTURE MEDIA",19536
US-11092593-B2,CHEMICAL OR PHYSICAL LABORATORY APPARATUS FOR GENERAL USE,17435
WO-2017152085-A1,PEPTIDES,17068
US-10576130-B2,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",17006
US-11744935-B2,"DEVICES FOR INTRODUCING MEDIA INTO, OR ONTO, THE BODY; DEVICES FOR TRANSDUCING BODY MEDIA OR FOR TAKING MEDIA FROM THE BODY; DEVICES FOR PRODUCING OR ENDING SLEEP OR STUPOR",16500
US-9079949-B1,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,16330
US-10337029-B2,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,15530
US-11092593-B2,"CHEMICAL OR PHYSICAL PROCESSES, e.g. CATALYSIS OR COLLOID CHEMISTRY; THEIR RELEVANT APPARATUS",15216
US-10771024-B2,SEMICONDUCTOR DEVICES NOT COVERED BY CLASS H10,13815
US-9340798-B2,"MICROORGANISMS OR ENZYMES; COMPOSITIONS THEREOF; PROPAGATING, PRESERVING, OR MAINTAINING MICROORGANISMS; MUTATION OR GENETIC ENGINEERING; CULTURE MEDIA",13644
US-10822404-B2,PEPTIDES,13631
US-11021727-B2,ENZYMES,13203
US-11446260-B2,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",13120
US-11902122-B2,ELECTRIC DIGITAL DATA PROCESSING,12546
US-9169235-B2,HETEROCYCLIC COMPOUNDS,12402
US-7956175-B2,"MEASURING OR TESTING PROCESSES INVOLVING ENZYMES, NUCLEIC ACIDS OR MICROORGANISMS; COMPOSITIONS OR TEST PAPERS THEREFOR; PROCESSES OF PREPARING SUCH COMPOSITIONS; CONDITION-RESPONSIVE CONTROL IN MICROBIOLOGICAL OR ENZYMOLOGICAL PROCESSES",12328
US-11443120-B2,ELECTRIC DIGITAL DATA PROCESSING,11844
US-10004808-B2,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",11835
US-11021727-B2,"MICROORGANISMS OR ENZYMES; COMPOSITIONS THEREOF; PROPAGATING, PRESERVING, OR MAINTAINING MICROORGANISMS; MUTATION OR GENETIC ENGINEERING; CULTURE MEDIA",11736
US-10248966-B2,"PICTORIAL COMMUNICATION, e.g. TELEVISION",11718
US-9079949-B1,PEPTIDES,11360
US-10525029-B2,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",11350
US-10751536-B1,ELECTROTHERAPY; MAGNETOTHERAPY; RADIATION THERAPY; ULTRASOUND THERAPY,11186
US-11580567-B2,"INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES; SYSTEMS OR METHODS SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES, NOT OTHERWISE PROVIDED FOR",11175
US-8753296-B2,"PHYSICAL THERAPY APPARATUS, e.g. DEVICES FOR LOCATING OR STIMULATING REFLEX POINTS IN THE BODY; ARTIFICIAL RESPIRATION; MASSAGE; BATHING DEVICES FOR SPECIAL THERAPEUTIC OR HYGIENIC PURPOSES OR SPECIFIC PARTS OF THE BODY",11151
US-10337029-B2,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",10871
US-9365493-B2,HETEROCYCLIC COMPOUNDS,10672
US-8465914-B2,"MICROORGANISMS OR ENZYMES; COMPOSITIONS THEREOF; PROPAGATING, PRESERVING, OR MAINTAINING MICROORGANISMS; MUTATION OR GENETIC ENGINEERING; CULTURE MEDIA",10630
US-9575648-B2,ELECTRIC DIGITAL DATA PROCESSING,10422
US-8475794-B2,PEPTIDES,9780
US-8465914-B2,"MEASURING OR TESTING PROCESSES INVOLVING ENZYMES, NUCLEIC ACIDS OR MICROORGANISMS; COMPOSITIONS OR TEST PAPERS THEREFOR
Query:
SELECT
    t."publication_number",
    SUBSTR(c.value:"code"::STRING, 1, 4) AS "CPC_Main_Category"
FROM
    PATENTS.PATENTS.PUBLICATIONS t
    CROSS JOIN LATERAL FLATTEN(input => t."cpc") c
WHERE
    c.value:"code" IS NOT NULL
LIMIT 100
Answer:
publication_number,CPC_Main_Category
US-2018235635-A1,A61B
US-2018235635-A1,A61B
US-2018235635-A1,A61B
US-2018235635-A1,A61B
US-2018235635-A1,A61B
US-2018235635-A1,A61B
US-2018235635-A1,A61B
US-2018235635-A1,A61B
US-2018235635-A1,A61B
US-2018201131-A1,B60K
US-2018201131-A1,B60W
US-2018201131-A1,B60K
US-2018201131-A1,B60W
US-2018201131-A1,B60K
US-2018201131-A1,B60K
US-2018201131-A1,B60W
US-2018201131-A1,B60K
US-2018201131-A1,B60W
US-2018201131-A1,B60W
US-2018201131-A1,B60K
US-2018201131-A1,B60W
US-2018201131-A1,B60K
US-2017235415-A1,G06F
US-2017235415-A1,G06F
US-2017235415-A1,G06F
US-2017235415-A1,G06F
US-2017235415-A1,G06F
US-2017235415-A1,G06F
US-2017235415-A1,G06F
US-2017235415-A1,G06F
US-2017244772-A1,H04L
US-2017244772-A1,H04N
US-2017244772-A1,H04L
US-2017244772-A1,H04N
US-2017244772-A1,H04N
US-2017244772-A1,H04L
US-2017244772-A1,H04L
US-2017244772-A1,H04L
US-2017244772-A1,H04L
US-2017244772-A1,H04L
US-2017244772-A1,H04L
US-2017244772-A1,H04L
US-2017244772-A1,H04L
US-2017244772-A1,H04N
US-2017244772-A1,H04N
US-2017244772-A1,H04L
US-2017244772-A1,H04L
US-2017244772-A1,H04L
US-2017244772-A1,H04L
US-2017244772-A1,H04N
US-2017244772-A1,H04L
US-2017244772-A1,H04L
US-2017251351-A1,H04M
US-2017251351-A1,H04L
US-2017251351-A1,H04M
US-2017251351-A1,H04L
US-2017251351-A1,H04M
US-2017251351-A1,H04W
US-2017251351-A1,H04M
US-2017251351-A1,H04W
US-2017251351-A1,H04M
US-2017251351-A1,H04M
US-2017251351-A1,H04M
US-2017251351-A1,H04M
US-2017251351-A1,H04L
US-2017251351-A1,H04W
US-2017251351-A1,H04M
US-2017251351-A1,H04L
US-2017251351-A1,H04W
US-2017251351-A1,H04W
US-2017251351-A1,H04M
US-2018332422-A1,A63F
US-2018332422-A1,A63F
US-2018332422-A1,A63F
US-2018332422-A1,H04S
US-2018332422-A1,H04S
US-2018332422-A1,G11B
US-2018332422-A1,G06F
US-2018332422-A1,H04S
US-2018332422-A1,H04N
US-2018332422-A1,G11B
US-2018332422-A1,A63F
US-2018332422-A1,A63F
US-2018332422-A1,A63F
US-2018332422-A1,H04N
US-2018332422-A1,G11B
US-2018332422-A1,A63F
US-2018332422-A1,A63F
US-2018332422-A1,A63F
US-2018332422-A1,G06T
US-2018332422-A1,A63F
US-2018332422-A1,A63F
US-2018332422-A1,H04S
US-2018332422-A1,G11B
US-2018332422-A1,G11B
US-2018332422-A1,H04N
US-2018332422-A1,G06T
US-2018332422-A1,H04N
US-2018332422-A1,H04S
US-2018332422-A1,G06F
End Exploring Related Columns
Task: Which assignees, excluding DENSO CORP itself, have cited patents assigned to DENSO CORP, and what are the titles of the primary CPC subclasses associated with these citations? Provide the name of each citing assignee, the full title of the CPC subclass, and the count of citations grouped by the assignee and the CPC subclass title. Please focus specifically on the main categories of the CPC codes,

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Assignee,CPC_Subclass_Title,Citation_Count
assignee1:str,cpc_subclass_title1:str,count1:int
assignee2:str,cpc_subclass_title2:str,count2:int
...
```

**Explanation:**

To address this task, we first identify all patents assigned to **DENSO CORP** from the `PUBLICATIONS` table by filtering the `assignee_harmonized` field. Next, we find all patents that cite these DENSO CORP patents by examining the `citation` field in the same table, excluding any citations originating from DENSO CORP itself. For each citing patent, we retrieve the assignee's name and the primary CPC subclass code from the `cpc` field. We then join this CPC code with the `CPC_DEFINITION` table to obtain the full title of the CPC subclass. Finally, we group the results by the assignee and the CPC subclass title, counting the number of citations in each group. The focus on the main categories of the CPC codes ensures that we consider the primary technological areas relevant to the cited patents..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-25 10:46:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:46:14 - root - INFO - ```sql
WITH DENSO_Patents AS (
    SELECT DISTINCT t1."publication_number" as denso_pub_number
    FROM PATENTS.PATENTS.PUBLICATIONS t1
    , LATERAL FLATTEN(input => t1."assignee_harmonized") f1
    WHERE f1.value:"organization"::STRING ILIKE '%DENSO CORP%'
),
Citing_Patents AS (
    SELECT DISTINCT t2."publication_number", t2."assignee_harmonized", t2."cpc"
    FROM PATENTS.PATENTS.PUBLICATIONS t2
    , LATERAL FLATTEN(input => t2."citation") c
    JOIN DENSO_Patents dp ON c.value:"publication_number"::STRING = dp.denso_pub_number
)
SELECT
    COALESCE(f2.value:"organization"::STRING, 'Unknown') AS "Assignee",
    COALESCE(d."titleFull", 'Unknown') AS "CPC_Subclass_Title",
    COUNT(DISTINCT cp."publication_number") AS "Citation_Count"
FROM Citing_Patents cp
    , LATERAL FLATTEN(input => cp."assignee_harmonized") f2
    , LATERAL FLATTEN(input => cp."cpc") cpc_u
    LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION d
        ON d."symbol" = SUBSTR(cpc_u.value:"code"::STRING, 1, 4)
WHERE
    f2.value:"organization"::STRING NOT ILIKE '%DENSO CORP%'
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC NULLS LAST
LIMIT 100;
```
2025-01-25 10:46:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:46:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:46:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:46:15 - snowflake.connector.connection - INFO - closed
2025-01-25 10:46:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:46:15 - root - INFO - itercount: 1
2025-01-25 10:46:15 - root - INFO - 001072 (42601): 01b9f226-0004-8038-0001-11c300fa3b82: SQL compilation error:
Lateral View cannot be on the left side of join
2025-01-25 10:46:15 - root - INFO - Input sql:
WITH DENSO_Patents AS (
    SELECT DISTINCT t1."publication_number" as denso_pub_number
    FROM PATENTS.PATENTS.PUBLICATIONS t1
    , LATERAL FLATTEN(input => t1."assignee_harmonized") f1
    WHERE f1.value:"organization"::STRING ILIKE '%DENSO CORP%'
),
Citing_Patents AS (
    SELECT DISTINCT t2."publication_number", t2."assignee_harmonized", t2."cpc"
    FROM PATENTS.PATENTS.PUBLICATIONS t2
    , LATERAL FLATTEN(input => t2."citation") c
    JOIN DENSO_Patents dp ON c.value:"publication_number"::STRING = dp.denso_pub_number
)
SELECT
    COALESCE(f2.value:"organization"::STRING, 'Unknown') AS "Assignee",
    COALESCE(d."titleFull", 'Unknown') AS "CPC_Subclass_Title",
    COUNT(DISTINCT cp."publication_number") AS "Citation_Count"
FROM Citing_Patents cp
    , LATERAL FLATTEN(input => cp."assignee_harmonized") f2
    , LATERAL FLATTEN(input => cp."cpc") cpc_u
    LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION d
        ON d."symbol" = SUBSTR(cpc_u.value:"code"::STRING, 1, 4)
WHERE
    f2.value:"organization"::STRING NOT ILIKE '%DENSO CORP%'
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC NULLS LAST
LIMIT 100;
The error information is:
001072 (42601): 01b9f226-0004-8038-0001-11c300fa3b82: SQL compilation error:
Lateral View cannot be on the left side of join
Please correct it and output only 1 complete SQL query.
2025-01-25 10:46:58 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:46:58 - root - INFO - ```sql
WITH DENSO_Patents AS (
    SELECT DISTINCT t1."publication_number" AS denso_pub_number
    FROM PATENTS.PATENTS.PUBLICATIONS t1,
         LATERAL FLATTEN(input => t1."assignee_harmonized") f1
    WHERE f1.value:"organization"::STRING ILIKE '%DENSO CORP%'
),
Citations AS (
    SELECT t2."publication_number" AS citing_pub_number,
           c.value:"publication_number"::STRING AS cited_pub_number
    FROM PATENTS.PATENTS.PUBLICATIONS t2,
         LATERAL FLATTEN(input => t2."citation") c
),
Citing_Patents AS (
    SELECT DISTINCT c."citing_pub_number", t3."assignee_harmonized", t3."cpc"
    FROM Citations c
    JOIN DENSO_Patents dp ON c."cited_pub_number" = dp.denso_pub_number
    JOIN PATENTS.PATENTS.PUBLICATIONS t3 ON c."citing_pub_number" = t3."publication_number"
)
SELECT
    COALESCE(f2.value:"organization"::STRING, 'Unknown') AS "Assignee",
    COALESCE(d."titleFull", 'Unknown') AS "CPC_Subclass_Title",
    COUNT(DISTINCT cp."citing_pub_number") AS "Citation_Count"
FROM Citing_Patents cp
    , LATERAL FLATTEN(input => cp."assignee_harmonized") f2
    , LATERAL FLATTEN(input => cp."cpc") cpc_u
    LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION d
        ON d."symbol" = SUBSTR(cpc_u.value:"code"::STRING, 1, 4)
WHERE
    f2.value:"organization"::STRING NOT ILIKE '%DENSO CORP%'
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC NULLS LAST
LIMIT 100;
```
2025-01-25 10:46:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:46:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:46:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:46:59 - snowflake.connector.connection - INFO - closed
2025-01-25 10:46:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:47:00 - root - INFO - itercount: 2
2025-01-25 10:47:00 - root - INFO - 001072 (42601): 01b9f226-0004-7d15-0001-11c300fa2f2e: SQL compilation error:
Lateral View cannot be on the left side of join
2025-01-25 10:47:00 - root - INFO - Input sql:
WITH DENSO_Patents AS (
    SELECT DISTINCT t1."publication_number" AS denso_pub_number
    FROM PATENTS.PATENTS.PUBLICATIONS t1,
         LATERAL FLATTEN(input => t1."assignee_harmonized") f1
    WHERE f1.value:"organization"::STRING ILIKE '%DENSO CORP%'
),
Citations AS (
    SELECT t2."publication_number" AS citing_pub_number,
           c.value:"publication_number"::STRING AS cited_pub_number
    FROM PATENTS.PATENTS.PUBLICATIONS t2,
         LATERAL FLATTEN(input => t2."citation") c
),
Citing_Patents AS (
    SELECT DISTINCT c."citing_pub_number", t3."assignee_harmonized", t3."cpc"
    FROM Citations c
    JOIN DENSO_Patents dp ON c."cited_pub_number" = dp.denso_pub_number
    JOIN PATENTS.PATENTS.PUBLICATIONS t3 ON c."citing_pub_number" = t3."publication_number"
)
SELECT
    COALESCE(f2.value:"organization"::STRING, 'Unknown') AS "Assignee",
    COALESCE(d."titleFull", 'Unknown') AS "CPC_Subclass_Title",
    COUNT(DISTINCT cp."citing_pub_number") AS "Citation_Count"
FROM Citing_Patents cp
    , LATERAL FLATTEN(input => cp."assignee_harmonized") f2
    , LATERAL FLATTEN(input => cp."cpc") cpc_u
    LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION d
        ON d."symbol" = SUBSTR(cpc_u.value:"code"::STRING, 1, 4)
WHERE
    f2.value:"organization"::STRING NOT ILIKE '%DENSO CORP%'
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC NULLS LAST
LIMIT 100;
The error information is:
001072 (42601): 01b9f226-0004-7d15-0001-11c300fa2f2e: SQL compilation error:
Lateral View cannot be on the left side of join
Please correct it and output only 1 complete SQL query.
2025-01-25 10:47:34 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:47:34 - root - INFO - ```sql
WITH DENSO_Patents AS (
    SELECT DISTINCT t1."publication_number" AS denso_pub_number
    FROM PATENTS.PATENTS.PUBLICATIONS t1,
         LATERAL FLATTEN(input => t1."assignee_harmonized") f1
    WHERE f1.value:"organization"::STRING ILIKE '%DENSO CORP%'
)
SELECT
    COALESCE(f2.value:"organization"::STRING, 'Unknown') AS "Assignee",
    COALESCE(d."titleFull", 'Unknown') AS "CPC_Subclass_Title",
    COUNT(DISTINCT t2."publication_number") AS "Citation_Count"
FROM PATENTS.PATENTS.PUBLICATIONS t2
     , LATERAL FLATTEN(input => t2."assignee_harmonized") f2
     , LATERAL FLATTEN(input => t2."cpc") cpc_u
     , LATERAL FLATTEN(input => t2."citation") c
LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION d
    ON d."symbol" = SUBSTR(cpc_u.value:"code"::STRING, 1, 4)
WHERE
    f2.value:"organization"::STRING NOT ILIKE '%DENSO CORP%'
    AND c.value:"publication_number"::STRING IN (SELECT denso_pub_number FROM DENSO_Patents)
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC NULLS LAST
LIMIT 100;
```
2025-01-25 10:47:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:47:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:47:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:47:36 - snowflake.connector.connection - INFO - closed
2025-01-25 10:47:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:47:36 - root - INFO - itercount: 3
2025-01-25 10:47:36 - root - INFO - 001072 (42601): 01b9f227-0004-8038-0001-11c300fa3b86: SQL compilation error:
Lateral View cannot be on the left side of join
2025-01-25 10:47:36 - root - INFO - Input sql:
WITH DENSO_Patents AS (
    SELECT DISTINCT t1."publication_number" AS denso_pub_number
    FROM PATENTS.PATENTS.PUBLICATIONS t1,
         LATERAL FLATTEN(input => t1."assignee_harmonized") f1
    WHERE f1.value:"organization"::STRING ILIKE '%DENSO CORP%'
)
SELECT
    COALESCE(f2.value:"organization"::STRING, 'Unknown') AS "Assignee",
    COALESCE(d."titleFull", 'Unknown') AS "CPC_Subclass_Title",
    COUNT(DISTINCT t2."publication_number") AS "Citation_Count"
FROM PATENTS.PATENTS.PUBLICATIONS t2
     , LATERAL FLATTEN(input => t2."assignee_harmonized") f2
     , LATERAL FLATTEN(input => t2."cpc") cpc_u
     , LATERAL FLATTEN(input => t2."citation") c
LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION d
    ON d."symbol" = SUBSTR(cpc_u.value:"code"::STRING, 1, 4)
WHERE
    f2.value:"organization"::STRING NOT ILIKE '%DENSO CORP%'
    AND c.value:"publication_number"::STRING IN (SELECT denso_pub_number FROM DENSO_Patents)
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC NULLS LAST
LIMIT 100;
The error information is:
001072 (42601): 01b9f227-0004-8038-0001-11c300fa3b86: SQL compilation error:
Lateral View cannot be on the left side of join
Please correct it and output only 1 complete SQL query.
2025-01-25 10:48:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:48:22 - root - INFO - ```sql
WITH DENSO_Patents AS (
    SELECT DISTINCT t1."publication_number" AS denso_pub_number
    FROM PATENTS.PATENTS.PUBLICATIONS t1,
         LATERAL FLATTEN(input => t1."assignee_harmonized") f1
    WHERE f1.value:"organization"::STRING ILIKE '%DENSO CORP%'
),
Citations AS (
    SELECT t2."publication_number" AS citing_pub_number,
           c.value:"publication_number"::STRING AS cited_pub_number
    FROM PATENTS.PATENTS.PUBLICATIONS t2,
         LATERAL FLATTEN(input => t2."citation") c
),
Citing_DENSO_Patents AS (
    SELECT DISTINCT c."citing_pub_number"
    FROM Citations c
    JOIN DENSO_Patents dp ON c."cited_pub_number" = dp.denso_pub_number
),
Citing_Patent_Details AS (
    SELECT t3."publication_number" AS citing_pub_number,
           f2.value:"organization"::STRING AS "Assignee",
           cpc_u.value:"code"::STRING AS cpc_code
    FROM PATENTS.PATENTS.PUBLICATIONS t3
    JOIN Citing_DENSO_Patents cp ON t3."publication_number" = cp."citing_pub_number"
         LATERAL FLATTEN(input => t3."assignee_harmonized") f2
         LATERAL FLATTEN(input => t3."cpc") cpc_u
    WHERE f2.value:"organization"::STRING NOT ILIKE '%DENSO CORP%'
)
SELECT
    COALESCE(cpd."Assignee", 'Unknown') AS "Assignee",
    COALESCE(d."titleFull", 'Unknown') AS "CPC_Subclass_Title",
    COUNT(DISTINCT cpd."citing_pub_number") AS "Citation_Count"
FROM Citing_Patent_Details cpd
LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION d
    ON d."symbol" = SUBSTR(cpd.cpc_code, 1, 4)
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC NULLS LAST
LIMIT 100;
```
2025-01-25 10:48:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:48:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:48:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:48:24 - snowflake.connector.connection - INFO - closed
2025-01-25 10:48:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:48:24 - root - INFO - itercount: 4
2025-01-25 10:48:24 - root - INFO - 001003 (42000): 01b9f228-0004-8038-0001-11c300fa3b8a: SQL compilation error:
syntax error line 24 at position 9 unexpected 'LATERAL'.
syntax error line 24 at position 25 unexpected 'input'.
syntax error line 24 at position 60 unexpected 'f2'.
2025-01-25 10:48:24 - root - INFO - Input sql:
WITH DENSO_Patents AS (
    SELECT DISTINCT t1."publication_number" AS denso_pub_number
    FROM PATENTS.PATENTS.PUBLICATIONS t1,
         LATERAL FLATTEN(input => t1."assignee_harmonized") f1
    WHERE f1.value:"organization"::STRING ILIKE '%DENSO CORP%'
),
Citations AS (
    SELECT t2."publication_number" AS citing_pub_number,
           c.value:"publication_number"::STRING AS cited_pub_number
    FROM PATENTS.PATENTS.PUBLICATIONS t2,
         LATERAL FLATTEN(input => t2."citation") c
),
Citing_DENSO_Patents AS (
    SELECT DISTINCT c."citing_pub_number"
    FROM Citations c
    JOIN DENSO_Patents dp ON c."cited_pub_number" = dp.denso_pub_number
),
Citing_Patent_Details AS (
    SELECT t3."publication_number" AS citing_pub_number,
           f2.value:"organization"::STRING AS "Assignee",
           cpc_u.value:"code"::STRING AS cpc_code
    FROM PATENTS.PATENTS.PUBLICATIONS t3
    JOIN Citing_DENSO_Patents cp ON t3."publication_number" = cp."citing_pub_number"
         LATERAL FLATTEN(input => t3."assignee_harmonized") f2
         LATERAL FLATTEN(input => t3."cpc") cpc_u
    WHERE f2.value:"organization"::STRING NOT ILIKE '%DENSO CORP%'
)
SELECT
    COALESCE(cpd."Assignee", 'Unknown') AS "Assignee",
    COALESCE(d."titleFull", 'Unknown') AS "CPC_Subclass_Title",
    COUNT(DISTINCT cpd."citing_pub_number") AS "Citation_Count"
FROM Citing_Patent_Details cpd
LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION d
    ON d."symbol" = SUBSTR(cpd.cpc_code, 1, 4)
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC NULLS LAST
LIMIT 100;
The error information is:
001003 (42000): 01b9f228-0004-8038-0001-11c300fa3b8a: SQL compilation error:
syntax error line 24 at position 9 unexpected 'LATERAL'.
syntax error line 24 at position 25 unexpected 'input'.
syntax error line 24 at position 60 unexpected 'f2'.
Please correct it and output only 1 complete SQL query.
2025-01-25 10:49:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:49:10 - root - INFO - ```sql
WITH DENSO_Patents AS (
    SELECT DISTINCT t1."publication_number" AS denso_pub_number
    FROM PATENTS.PATENTS.PUBLICATIONS t1,
         LATERAL FLATTEN(input => t1."assignee_harmonized") f1
    WHERE f1.value:"organization"::STRING ILIKE '%DENSO CORP%'
),
Citations AS (
    SELECT t2."publication_number" AS citing_pub_number,
           c.value:"publication_number"::STRING AS cited_pub_number
    FROM PATENTS.PATENTS.PUBLICATIONS t2,
         LATERAL FLATTEN(input => t2."citation") c
),
Citing_DENSO_Patents AS (
    SELECT DISTINCT c."citing_pub_number"
    FROM Citations c
    JOIN DENSO_Patents dp ON c."cited_pub_number" = dp.denso_pub_number
),
Citing_Patent_Details AS (
    SELECT t3."publication_number" AS citing_pub_number,
           f2.value:"organization"::STRING AS "Assignee",
           cpc_u.value:"code"::STRING AS cpc_code
    FROM PATENTS.PATENTS.PUBLICATIONS t3,
         LATERAL FLATTEN(input => t3."assignee_harmonized") f2,
         LATERAL FLATTEN(input => t3."cpc") cpc_u
    WHERE f2.value:"organization"::STRING NOT ILIKE '%DENSO CORP%'
)
SELECT
    COALESCE(cpd."Assignee", 'Unknown') AS "Assignee",
    COALESCE(d."titleFull", 'Unknown') AS "CPC_Subclass_Title",
    COUNT(DISTINCT cpd."citing_pub_number") AS "Citation_Count"
FROM Citing_Patent_Details cpd
JOIN Citing_DENSO_Patents cp ON cpd.citing_pub_number = cp."citing_pub_number"
LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION d
    ON d."symbol" = SUBSTR(cpd.cpc_code, 1, 4)
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC NULLS LAST
LIMIT 100;
```
2025-01-25 10:49:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:49:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:49:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:49:12 - snowflake.connector.connection - INFO - closed
2025-01-25 10:49:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:49:12 - root - INFO - itercount: 5
2025-01-25 10:49:12 - root - INFO - 000904 (42000): 01b9f229-0004-7d15-0001-11c300fa2f32: SQL compilation error: error line 14 at position 20
invalid identifier 'C."citing_pub_number"'
2025-01-25 10:49:12 - root - INFO - Input sql:
WITH DENSO_Patents AS (
    SELECT DISTINCT t1."publication_number" AS denso_pub_number
    FROM PATENTS.PATENTS.PUBLICATIONS t1,
         LATERAL FLATTEN(input => t1."assignee_harmonized") f1
    WHERE f1.value:"organization"::STRING ILIKE '%DENSO CORP%'
),
Citations AS (
    SELECT t2."publication_number" AS citing_pub_number,
           c.value:"publication_number"::STRING AS cited_pub_number
    FROM PATENTS.PATENTS.PUBLICATIONS t2,
         LATERAL FLATTEN(input => t2."citation") c
),
Citing_DENSO_Patents AS (
    SELECT DISTINCT c."citing_pub_number"
    FROM Citations c
    JOIN DENSO_Patents dp ON c."cited_pub_number" = dp.denso_pub_number
),
Citing_Patent_Details AS (
    SELECT t3."publication_number" AS citing_pub_number,
           f2.value:"organization"::STRING AS "Assignee",
           cpc_u.value:"code"::STRING AS cpc_code
    FROM PATENTS.PATENTS.PUBLICATIONS t3,
         LATERAL FLATTEN(input => t3."assignee_harmonized") f2,
         LATERAL FLATTEN(input => t3."cpc") cpc_u
    WHERE f2.value:"organization"::STRING NOT ILIKE '%DENSO CORP%'
)
SELECT
    COALESCE(cpd."Assignee", 'Unknown') AS "Assignee",
    COALESCE(d."titleFull", 'Unknown') AS "CPC_Subclass_Title",
    COUNT(DISTINCT cpd."citing_pub_number") AS "Citation_Count"
FROM Citing_Patent_Details cpd
JOIN Citing_DENSO_Patents cp ON cpd.citing_pub_number = cp."citing_pub_number"
LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION d
    ON d."symbol" = SUBSTR(cpd.cpc_code, 1, 4)
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC NULLS LAST
LIMIT 100;
The error information is:
000904 (42000): 01b9f229-0004-7d15-0001-11c300fa2f32: SQL compilation error: error line 14 at position 20
invalid identifier 'C."citing_pub_number"'
Please correct it and output only 1 complete SQL query.
2025-01-25 10:50:06 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:50:06 - root - INFO - ```sql
WITH DENSO_Patents AS (
    SELECT DISTINCT t1."publication_number" AS denso_pub_number
    FROM PATENTS.PATENTS.PUBLICATIONS t1,
         LATERAL FLATTEN(input => t1."assignee_harmonized") f1
    WHERE f1.value:"organization"::STRING ILIKE '%DENSO CORP%'
),
Citations AS (
    SELECT t2."publication_number" AS citing_pub_number,
           cf.value:"publication_number"::STRING AS cited_pub_number
    FROM PATENTS.PATENTS.PUBLICATIONS t2,
         LATERAL FLATTEN(input => t2."citation") cf
),
Citing_DENSO_Patents AS (
    SELECT DISTINCT c."citing_pub_number"
    FROM Citations c
    JOIN DENSO_Patents dp ON c."cited_pub_number" = dp.denso_pub_number
),
Citing_Patent_Details AS (
    SELECT t3."publication_number" AS citing_pub_number,
           f2.value:"organization"::STRING AS "Assignee",
           cpc_u.value:"code"::STRING AS cpc_code
    FROM PATENTS.PATENTS.PUBLICATIONS t3
    JOIN Citing_DENSO_Patents cp ON t3."publication_number" = cp."citing_pub_number",
         LATERAL FLATTEN(input => t3."assignee_harmonized") f2,
         LATERAL FLATTEN(input => t3."cpc") cpc_u
    WHERE f2.value:"organization"::STRING NOT ILIKE '%DENSO CORP%'
)
SELECT
    COALESCE(cpd."Assignee", 'Unknown') AS "Assignee",
    COALESCE(d."titleFull", 'Unknown') AS "CPC_Subclass_Title",
    COUNT(DISTINCT cpd."citing_pub_number") AS "Citation_Count"
FROM Citing_Patent_Details cpd
LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION d
    ON d."symbol" = SUBSTR(cpd.cpc_code, 1, 4)
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC NULLS LAST
LIMIT 100;
```
2025-01-25 10:50:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:50:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:50:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:50:07 - snowflake.connector.connection - INFO - closed
2025-01-25 10:50:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:50:08 - root - INFO - itercount: 6
2025-01-25 10:50:08 - root - INFO - 000904 (42000): 01b9f22a-0004-7d15-0001-11c300fa2f36: SQL compilation error: error line 14 at position 20
invalid identifier 'C."citing_pub_number"'
2025-01-25 10:50:08 - root - INFO - Input sql:
WITH DENSO_Patents AS (
    SELECT DISTINCT t1."publication_number" AS denso_pub_number
    FROM PATENTS.PATENTS.PUBLICATIONS t1,
         LATERAL FLATTEN(input => t1."assignee_harmonized") f1
    WHERE f1.value:"organization"::STRING ILIKE '%DENSO CORP%'
),
Citations AS (
    SELECT t2."publication_number" AS citing_pub_number,
           cf.value:"publication_number"::STRING AS cited_pub_number
    FROM PATENTS.PATENTS.PUBLICATIONS t2,
         LATERAL FLATTEN(input => t2."citation") cf
),
Citing_DENSO_Patents AS (
    SELECT DISTINCT c."citing_pub_number"
    FROM Citations c
    JOIN DENSO_Patents dp ON c."cited_pub_number" = dp.denso_pub_number
),
Citing_Patent_Details AS (
    SELECT t3."publication_number" AS citing_pub_number,
           f2.value:"organization"::STRING AS "Assignee",
           cpc_u.value:"code"::STRING AS cpc_code
    FROM PATENTS.PATENTS.PUBLICATIONS t3
    JOIN Citing_DENSO_Patents cp ON t3."publication_number" = cp."citing_pub_number",
         LATERAL FLATTEN(input => t3."assignee_harmonized") f2,
         LATERAL FLATTEN(input => t3."cpc") cpc_u
    WHERE f2.value:"organization"::STRING NOT ILIKE '%DENSO CORP%'
)
SELECT
    COALESCE(cpd."Assignee", 'Unknown') AS "Assignee",
    COALESCE(d."titleFull", 'Unknown') AS "CPC_Subclass_Title",
    COUNT(DISTINCT cpd."citing_pub_number") AS "Citation_Count"
FROM Citing_Patent_Details cpd
LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION d
    ON d."symbol" = SUBSTR(cpd.cpc_code, 1, 4)
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC NULLS LAST
LIMIT 100;
The error information is:
000904 (42000): 01b9f22a-0004-7d15-0001-11c300fa2f36: SQL compilation error: error line 14 at position 20
invalid identifier 'C."citing_pub_number"'
Please correct it and output only 1 complete SQL query.
2025-01-25 10:51:31 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:51:31 - root - INFO - ```sql
WITH DENSO_Patents AS (
    SELECT DISTINCT t1."publication_number" AS "denso_pub_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t1
        , LATERAL FLATTEN(input => t1."assignee_harmonized") f1
    WHERE f1.value:"organization"::STRING ILIKE '%DENSO CORP%'
),
Citations AS (
    SELECT t2."publication_number" AS "citing_pub_number",
           cf.value:"publication_number"::STRING AS "cited_pub_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t2
        , LATERAL FLATTEN(input => t2."citation") cf
),
Citing_DENSO_Patents AS (
    SELECT DISTINCT c."citing_pub_number"
    FROM Citations c
    JOIN DENSO_Patents dp ON c."cited_pub_number" = dp."denso_pub_number"
),
Citing_Patent_Details AS (
    SELECT t3."publication_number" AS "citing_pub_number",
           f2.value:"organization"::STRING AS "Assignee",
           cpc_u.value:"code"::STRING AS "cpc_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t3
    JOIN Citing_DENSO_Patents cp ON t3."publication_number" = cp."citing_pub_number"
    CROSS JOIN LATERAL FLATTEN(input => t3."assignee_harmonized") f2
    CROSS JOIN LATERAL FLATTEN(input => t3."cpc") cpc_u
    WHERE f2.value:"organization"::STRING NOT ILIKE '%DENSO CORP%'
)
SELECT
    COALESCE(cpd."Assignee", 'Unknown') AS "Assignee",
    COALESCE(d."titleFull", 'Unknown') AS "CPC_Subclass_Title",
    COUNT(DISTINCT cpd."citing_pub_number") AS "Citation_Count"
FROM Citing_Patent_Details cpd
LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION d
    ON d."symbol" = SUBSTR(cpd."cpc_code", 1, 4)
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC NULLS LAST
LIMIT 100;
```
2025-01-25 10:51:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:51:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:51:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:51:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-25 10:51:33 - snowflake.connector.connection - INFO - closed
2025-01-25 10:51:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:51:34 - root - INFO - itercount: 7
2025-01-25 10:51:34 - root - INFO - No data found for the specified query.

2025-01-25 10:51:34 - root - INFO - Input sql:
WITH DENSO_Patents AS (
    SELECT DISTINCT t1."publication_number" AS "denso_pub_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t1
        , LATERAL FLATTEN(input => t1."assignee_harmonized") f1
    WHERE f1.value:"organization"::STRING ILIKE '%DENSO CORP%'
),
Citations AS (
    SELECT t2."publication_number" AS "citing_pub_number",
           cf.value:"publication_number"::STRING AS "cited_pub_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t2
        , LATERAL FLATTEN(input => t2."citation") cf
),
Citing_DENSO_Patents AS (
    SELECT DISTINCT c."citing_pub_number"
    FROM Citations c
    JOIN DENSO_Patents dp ON c."cited_pub_number" = dp."denso_pub_number"
),
Citing_Patent_Details AS (
    SELECT t3."publication_number" AS "citing_pub_number",
           f2.value:"organization"::STRING AS "Assignee",
           cpc_u.value:"code"::STRING AS "cpc_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t3
    JOIN Citing_DENSO_Patents cp ON t3."publication_number" = cp."citing_pub_number"
    CROSS JOIN LATERAL FLATTEN(input => t3."assignee_harmonized") f2
    CROSS JOIN LATERAL FLATTEN(input => t3."cpc") cpc_u
    WHERE f2.value:"organization"::STRING NOT ILIKE '%DENSO CORP%'
)
SELECT
    COALESCE(cpd."Assignee", 'Unknown') AS "Assignee",
    COALESCE(d."titleFull", 'Unknown') AS "CPC_Subclass_Title",
    COUNT(DISTINCT cpd."citing_pub_number") AS "Citation_Count"
FROM Citing_Patent_Details cpd
LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION d
    ON d."symbol" = SUBSTR(cpd."cpc_code", 1, 4)
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC NULLS LAST
LIMIT 100;
The error information is:
 No data found for the specified query.

2025-01-25 10:52:36 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:52:36 - root - INFO - ```sql
WITH DENSO_Patents AS (
    SELECT DISTINCT t1."publication_number" AS "denso_pub_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t1,
         LATERAL FLATTEN(input => t1."assignee_harmonized") f1
    WHERE f1.value:"organization"::STRING ILIKE '%DENSO%'
),
Citations AS (
    SELECT t2."publication_number" AS "citing_pub_number",
           cf.value:"publication_number"::STRING AS "cited_pub_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t2,
         LATERAL FLATTEN(input => t2."citation") cf
),
Citing_DENSO_Patents AS (
    SELECT DISTINCT c."citing_pub_number"
    FROM Citations c
    JOIN DENSO_Patents dp ON c."cited_pub_number" = dp."denso_pub_number"
),
Citing_Patent_Details AS (
    SELECT t3."publication_number" AS "citing_pub_number",
           f2.value:"organization"::STRING AS "Assignee",
           cpc_u.value:"code"::STRING AS "cpc_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t3
    JOIN Citing_DENSO_Patents cp ON t3."publication_number" = cp."citing_pub_number"
         CROSS JOIN LATERAL FLATTEN(input => t3."assignee_harmonized") f2
         LEFT JOIN LATERAL FLATTEN(input => t3."cpc") cpc_u ON TRUE
    WHERE (f2.value:"organization"::STRING IS NULL OR f2.value:"organization"::STRING NOT ILIKE '%DENSO%')
)
SELECT
    COALESCE(cpd."Assignee", 'Unknown') AS "Assignee",
    COALESCE(d."titleFull", 'Unknown') AS "CPC_Subclass_Title",
    COUNT(DISTINCT cpd."citing_pub_number") AS "Citation_Count"
FROM Citing_Patent_Details cpd
LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION d
    ON d."symbol" = SUBSTR(cpd."cpc_code", 1, 4)
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC NULLS LAST
LIMIT 100;
```

**Explanation:**

- **Adjusted Assignee Matching:** In the `DENSO_Patents` CTE, I modified the `ILIKE` condition to `%DENSO%` instead of `%DENSO CORP%` to capture all variations of DENSO in the assignee organization names.

- **Handled NULLs in Assignee:** In the `Citing_Patent_Details` CTE, I adjusted the `WHERE` clause to include patents where the assignee organization is `NULL` or does not contain 'DENSO'. This prevents excluding records with `NULL` assignees.

- **Corrected JOIN Syntax:** In the `Citing_Patent_Details` CTE, I used `CROSS JOIN LATERAL FLATTEN` for both `assignee_harmonized` and `cpc` fields to ensure proper lateral flattening.

- **Included LEFT JOIN on CPC Codes:** Changed the `LATERAL FLATTEN` on `cpc_u` to a `LEFT JOIN LATERAL FLATTEN` to include patents that may not have CPC codes.

- **Final Selection and Aggregation:** The final `SELECT` statement remains largely the same, aggregating the count of distinct citing publication numbers by assignee and CPC subclass title.

This query should now retrieve the desired data, listing assignees (excluding DENSO CORP), the titles of the primary CPC subclasses associated with the citations, and the count of citations grouped by the assignee and CPC subclass title.
2025-01-25 10:52:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:52:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:52:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:52:38 - snowflake.connector.connection - INFO - closed
2025-01-25 10:52:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:52:38 - root - INFO - itercount: 8
2025-01-25 10:52:38 - root - INFO - 000002 (0A000): 01b9f22c-0004-8038-0001-11c300fa3b92: Unsupported feature 'lateral table function called with OUTER JOIN syntax or a join predicate (ON clause)'.
2025-01-25 10:52:38 - root - INFO - Input sql:
WITH DENSO_Patents AS (
    SELECT DISTINCT t1."publication_number" AS "denso_pub_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t1,
         LATERAL FLATTEN(input => t1."assignee_harmonized") f1
    WHERE f1.value:"organization"::STRING ILIKE '%DENSO%'
),
Citations AS (
    SELECT t2."publication_number" AS "citing_pub_number",
           cf.value:"publication_number"::STRING AS "cited_pub_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t2,
         LATERAL FLATTEN(input => t2."citation") cf
),
Citing_DENSO_Patents AS (
    SELECT DISTINCT c."citing_pub_number"
    FROM Citations c
    JOIN DENSO_Patents dp ON c."cited_pub_number" = dp."denso_pub_number"
),
Citing_Patent_Details AS (
    SELECT t3."publication_number" AS "citing_pub_number",
           f2.value:"organization"::STRING AS "Assignee",
           cpc_u.value:"code"::STRING AS "cpc_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t3
    JOIN Citing_DENSO_Patents cp ON t3."publication_number" = cp."citing_pub_number"
         CROSS JOIN LATERAL FLATTEN(input => t3."assignee_harmonized") f2
         LEFT JOIN LATERAL FLATTEN(input => t3."cpc") cpc_u ON TRUE
    WHERE (f2.value:"organization"::STRING IS NULL OR f2.value:"organization"::STRING NOT ILIKE '%DENSO%')
)
SELECT
    COALESCE(cpd."Assignee", 'Unknown') AS "Assignee",
    COALESCE(d."titleFull", 'Unknown') AS "CPC_Subclass_Title",
    COUNT(DISTINCT cpd."citing_pub_number") AS "Citation_Count"
FROM Citing_Patent_Details cpd
LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION d
    ON d."symbol" = SUBSTR(cpd."cpc_code", 1, 4)
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC NULLS LAST
LIMIT 100;
The error information is:
000002 (0A000): 01b9f22c-0004-8038-0001-11c300fa3b92: Unsupported feature 'lateral table function called with OUTER JOIN syntax or a join predicate (ON clause)'.
Please correct it and output only 1 complete SQL query.
2025-01-25 10:54:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:54:08 - root - INFO - ```sql
WITH DENSO_Patents AS (
    SELECT DISTINCT t1."publication_number" AS "denso_pub_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t1,
         LATERAL FLATTEN(input => t1."assignee_harmonized") f1
    WHERE f1.value:"organization"::STRING ILIKE '%DENSO%'
),
Citing_Pubs AS (
    SELECT DISTINCT t2."publication_number" AS "citing_pub_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t2,
         LATERAL FLATTEN(input => t2."citation") c
    WHERE c.value:"publication_number"::STRING IN (SELECT "denso_pub_number" FROM DENSO_Patents)
)
SELECT
    COALESCE(f2.value:"organization"::STRING, 'Unknown') AS "Assignee",
    COALESCE(d."titleFull", 'Unknown') AS "CPC_Subclass_Title",
    COUNT(DISTINCT t3."publication_number") AS "Citation_Count"
FROM PATENTS.PATENTS.PUBLICATIONS t3
    INNER JOIN Citing_Pubs cp ON t3."publication_number" = cp."citing_pub_number"
    CROSS JOIN LATERAL FLATTEN(input => t3."assignee_harmonized") f2
    CROSS JOIN LATERAL FLATTEN(input => t3."cpc") cpc_u
    JOIN PATENTS.PATENTS.CPC_DEFINITION d ON d."symbol" = SUBSTR(cpc_u.value:"code"::STRING, 1, 4)
WHERE f2.value:"organization"::STRING NOT ILIKE '%DENSO%'
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC NULLS LAST
LIMIT 100;
```
2025-01-25 10:54:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:54:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:54:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:54:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-25 10:54:10 - snowflake.connector.connection - INFO - closed
2025-01-25 10:54:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:54:10 - root - INFO - itercount: 9
2025-01-25 10:54:10 - root - INFO - No data found for the specified query.

2025-01-25 10:54:10 - root - INFO - Input sql:
WITH DENSO_Patents AS (
    SELECT DISTINCT t1."publication_number" AS "denso_pub_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t1,
         LATERAL FLATTEN(input => t1."assignee_harmonized") f1
    WHERE f1.value:"organization"::STRING ILIKE '%DENSO%'
),
Citing_Pubs AS (
    SELECT DISTINCT t2."publication_number" AS "citing_pub_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t2,
         LATERAL FLATTEN(input => t2."citation") c
    WHERE c.value:"publication_number"::STRING IN (SELECT "denso_pub_number" FROM DENSO_Patents)
)
SELECT
    COALESCE(f2.value:"organization"::STRING, 'Unknown') AS "Assignee",
    COALESCE(d."titleFull", 'Unknown') AS "CPC_Subclass_Title",
    COUNT(DISTINCT t3."publication_number") AS "Citation_Count"
FROM PATENTS.PATENTS.PUBLICATIONS t3
    INNER JOIN Citing_Pubs cp ON t3."publication_number" = cp."citing_pub_number"
    CROSS JOIN LATERAL FLATTEN(input => t3."assignee_harmonized") f2
    CROSS JOIN LATERAL FLATTEN(input => t3."cpc") cpc_u
    JOIN PATENTS.PATENTS.CPC_DEFINITION d ON d."symbol" = SUBSTR(cpc_u.value:"code"::STRING, 1, 4)
WHERE f2.value:"organization"::STRING NOT ILIKE '%DENSO%'
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC NULLS LAST
LIMIT 100;
The error information is:
 No data found for the specified query.

2025-01-25 10:55:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:55:08 - root - INFO - ```sql
WITH DENSO_Patents AS (
    SELECT DISTINCT t1."publication_number" AS "denso_pub_number",
           t1."family_id" AS "denso_family_id"
    FROM PATENTS.PATENTS.PUBLICATIONS t1
    CROSS JOIN LATERAL FLATTEN(input => t1."assignee_harmonized") f1
    WHERE f1.value:"organization"::STRING ILIKE '%DENSO%'
),
Citing_Patents AS (
    SELECT DISTINCT t2."publication_number" AS "citing_pub_number",
           t2."assignee_harmonized",
           t2."cpc"
    FROM PATENTS.PATENTS.PUBLICATIONS t2
    CROSS JOIN LATERAL FLATTEN(input => t2."citation") c
    JOIN PATENTS.PATENTS.PUBLICATIONS t3 ON c.value:"publication_number"::STRING = t3."publication_number"
    WHERE t3."family_id" IN (SELECT "denso_family_id" FROM DENSO_Patents)
)
SELECT
    COALESCE(f2.value:"organization"::STRING, 'Unknown') AS "Assignee",
    COALESCE(d."titleFull", 'Unknown') AS "CPC_Subclass_Title",
    COUNT(DISTINCT cp."citing_pub_number") AS "Citation_Count"
FROM Citing_Patents cp
CROSS JOIN LATERAL FLATTEN(input => cp."assignee_harmonized") f2
LEFT JOIN LATERAL FLATTEN(input => cp."cpc") cpc_u ON TRUE
LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION d ON d."symbol" = SUBSTR(cpc_u.value:"code"::STRING, 1, 4)
WHERE f2.value:"organization"::STRING NOT ILIKE '%DENSO%'
GROUP BY
    "Assignee",
    "CPC_Subclass_Title"
ORDER BY
    "Citation_Count" DESC NULLS LAST
LIMIT 100;
```
2025-01-25 10:55:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:55:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:55:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:55:10 - snowflake.connector.connection - INFO - closed
2025-01-25 10:55:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:55:10 - root - INFO - Total iteration counts: 10
