2025-01-27 01:37:21 - openai._base_client - INFO - Retrying request to /chat/completions in 0.388179 seconds
2025-01-27 01:38:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:38:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:38:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:38:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:38:30 - snowflake.connector.connection - INFO - closed
2025-01-27 01:38:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:38:55 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:38:55 - root - INFO - **Error Explanation:**

The error you're encountering:

```
100097 (22007): Can't parse '0' as date with format 'YYYYMMDD'
```

occurs because the `"publication_date"` column contains values that cannot be parsed into a date using the format `'YYYYMMDD'`. Specifically, there are entries where `"publication_date"` might be `'0'`, `NULL`, or contains invalid data that doesn't match the expected 8-digit date format.

**Solution:**

To resolve this issue, we need to handle these invalid date values. Here are two approaches:

1. **Filter Out Invalid Dates:**

   Modify your query to exclude rows where `"publication_date"` is invalid. You can add a `WHERE` clause to filter out entries that are `NULL`, equal to `'0'`, or don't match the expected date pattern.

   ```sql
   SELECT DISTINCT TO_VARCHAR(TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "Year"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "publication_date" IS NOT NULL
     AND "publication_date" <> '0'
     AND LENGTH("publication_date"::VARCHAR) = 8
     AND REGEXP_LIKE("publication_date"::VARCHAR, '^\d{8}$')
   LIMIT 100;
   ```

   **Explanation:**

   - `IS NOT NULL`: Excludes `NULL` values.
   - `<> '0'`: Excludes entries where the date is `'0'`.
   - `LENGTH(...) = 8`: Ensures the date string is exactly 8 characters long.
   - `REGEXP_LIKE(..., '^\d{8}$')`: Validates that the date string consists of exactly 8 digits (0-9).

2. **Use `TRY_TO_DATE` Function:**

   Alternatively, you can use the `TRY_TO_DATE` function, which attempts to convert a string to a date. If it fails, it returns `NULL` instead of raising an error.

   ```sql
   SELECT DISTINCT TO_VARCHAR(TRY_TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "Year"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE TRY_TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
   LIMIT 100;
   ```

   **Explanation:**

   - `TRY_TO_DATE(...)`: Attempts to parse the date; if unsuccessful, returns `NULL`.
   - `WHERE TRY_TO_DATE(...) IS NOT NULL`: Filters out rows where the date parsing failed.

**Recommendation:**

I recommend using the second approach with `TRY_TO_DATE` because it's more concise and effectively handles any invalid date formats without needing multiple conditions.

**Example Using `TRY_TO_DATE`:**

```sql
SELECT DISTINCT TO_VARCHAR(TRY_TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "Year"
FROM PATENTS.PATENTS.PUBLICATIONS
WHERE TRY_TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
LIMIT 100;
```

**Next Steps:**

Now that we've addressed the error, you can proceed to run the query to retrieve the distinct publication years. This will help you in further analysis, such as grouping patent filings by year.

**Additional Considerations:**

- When working with date fields, always ensure that the data conforms to the expected format.
- It's good practice to handle exceptions and edge cases, such as invalid or missing data, to prevent errors during query execution.

**Understanding the Data:**

Given that `"publication_date"` may contain invalid values, it might be helpful to investigate these entries to understand why they're invalid. You can run a query to identify them:

```sql
SELECT "publication_number", "publication_date"
FROM PATENTS.PATENTS.PUBLICATIONS
WHERE TRY_TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD') IS NULL
LIMIT 100;
```

This will list publications with invalid dates, allowing you to assess data quality and consider data cleansing if necessary.
2025-01-27 01:38:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:38:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:38:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:38:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-27 01:38:56 - snowflake.connector.connection - INFO - closed
2025-01-27 01:38:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:39:49 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:39:49 - root - INFO - ```sql
SELECT "symbol" AS "CPC_Symbol", "titleFull" AS "Full_Title"
FROM PATENTS.PATENTS.CPC_DEFINITION
WHERE "level" = 5
LIMIT 100;
```
2025-01-27 01:39:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:39:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:39:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:39:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 01:39:50 - snowflake.connector.connection - INFO - closed
2025-01-27 01:39:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:41:11 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:41:11 - root - INFO - SQL:
SELECT "symbol" AS "CPC_Symbol", "titleFull" AS "Full_Title"
FROM PATENTS.PATENTS.CPC_DEFINITION
WHERE "level" = 5
LIMIT 100;
Results:
Too long, hard cut:
CPC_Symbol,Full_Title
A01H,NEW PLANTS OR NON-TRANSGENIC PROCESSES FOR OBTAINING THEM; PLANT REPRODUCTION BY TISSUE CULTURE TECHNIQUES
A01F,PROCESSING OF HARVESTED PRODUCE; HAY OR STRAW PRESSES; DEVICES FOR STORING AGRICULTURAL OR HORTICULTURAL PRODUCE
A01C,PLANTING; SOWING; FERTILISING
A01G,"HORTICULTURE; CULTIVATION OF VEGETABLES, FLOWERS, RICE, FRUIT, VINES, HOPS OR SEAWEED; FORESTRY; WATERING"
A01N,"PRESERVATION OF BODIES OF HUMANS OR ANIMALS OR PLANTS OR PARTS THEREOF; BIOCIDES, e.g. AS DISINFECTANTS, AS PESTICIDES OR AS HERBICIDES; PEST REPELLANTS OR ATTRACTANTS; PLANT GROWTH REGULATORS"
A01P,"BIOCIDAL, PEST REPELLANT, PEST ATTRACTANT OR PLANT GROWTH REGULATORY ACTIVITY OF CHEMICAL COMPOUNDS OR PREPARATIONS"
A01D,HARVESTING; MOWING
A01L,SHOEING OF ANIMALS
A01K,"ANIMAL HUSBANDRY; AVICULTURE; APICULTURE; PISCICULTURE; FISHING; REARING OR BREEDING ANIMALS, NOT OTHERWISE PROVIDED FOR; NEW BREEDS OF ANIMALS"
A01M,"CATCHING, TRAPPING OR SCARING OF ANIMALS; APPARATUS FOR THE DESTRUCTION OF NOXIOUS ANIMALS OR NOXIOUS PLANTS"
A01J,MANUFACTURE OF DAIRY PRODUCTS
A01B,"SOIL WORKING IN AGRICULTURE OR FORESTRY; PARTS, DETAILS, OR ACCESSORIES OF AGRICULTURAL MACHINES OR IMPLEMENTS, IN GENERAL"
A21D,"TREATMENT, e.g. PRESERVATION, OF FLOUR OR DOUGH, e.g. BY ADDITION OF MATERIALS; BAKING; BAKERY PRODUCTS; PRESERVATION THEREOF"
A21C,MACHINES OR EQUIPMENT FOR MAKING OR PROCESSING DOUGHS; HANDLING BAKED ARTICLES MADE FROM DOUGH
A21B,BAKERS' OVENS; MACHINES OR EQUIPMENT FOR BAKING
A22B,SLAUGHTERING
A22C,"PROCESSING MEAT, POULTRY, OR FISH"
A23P,"SHAPING OR WORKING OF FOODSTUFFS, NOT FULLY COVERED BY A SINGLE OTHER SUBCLASS"
A23C,"DAIRY PRODUCTS, e.g. MILK, BUTTER OR CHEESE; MILK OR CHEESE SUBSTITUTES; MAKING THEREOF"
A23J,PROTEIN COMPOSITIONS FOR FOODSTUFFS; WORKING-UP PROTEINS FOR FOODSTUFFS; PHOSPHATIDE COMPOSITIONS FOR FOODSTUFFS
A23K,FODDER
A23L,"FOODS, FOODSTUFFS, OR NON-ALCOHOLIC BEVERAGES, NOT COVERED BY SUBCLASSES A21D OR A23B-A23J; THEIR PREPARATION OR TREATMENT, e.g. COOKING, MODIFICATION OF NUTRITIVE QUALITIES, PHYSICAL TREATMENT; PRESERVATION OF FOODS OR FOODSTUFFS, IN GENERAL"
A23N,"MACHINES OR APPARATUS FOR TREATING HARVESTED FRUIT, VEGETABLES OR FLOWER BULBS IN BULK, NOT OTHERWISE PROVIDED FOR; PEELING VEGETABLES OR FRUIT IN BULK; APPARATUS FOR PREPARING ANIMAL FEEDING- STUFFS"
A23V,"INDEXING SCHEME RELATING TO FOODS, FOODSTUFFS OR NON-ALCOHOLIC BEVERAGES AND LACTIC OR PROPIONIC ACID BACTERIA USED IN FOODSTUFFS OR FOOD PREPARATION"
A23F,"COFFEE; TEA; THEIR SUBSTITUTES; MANUFACTURE, PREPARATION, OR INFUSION THEREOF"
A23G,"COCOA; COCOA PRODUCTS, e.g. CHOCOLATE; SUBSTITUTES FOR COCOA OR COCOA PRODUCTS; CONFECTIONERY; CHEWING GUM; ICE-CREAM; PREPARATION THEREOF"
A23B,"PRESERVING, e.g. BY CANNING, MEAT, FISH, EGGS, FRUIT, VEGETABLES, EDIBLE SEEDS; CHEMICAL RIPENING OF FRUIT OR VEGETABLES; THE PRESERVED, RIPENED, OR CANNED PRODUCTS"
A23D,"EDIBLE OILS OR FATS, e.g. MARGARINES, SHORTENINGS, COOKING OILS"
A24C,MACHINES FOR MAKING CIGARS OR CIGARETTES
A24D,CIGARS; CIGARETTES; TOBACCO SMOKE FILTERS; MOUTHPIECES FOR CIGARS OR CIGARETTES; MANUFACTURE OF TOBACCO SMOKE FILTERS OR MOUTHPIECES
A24F,SMOKERS' REQUISITES; MATCH BOXES; SIMULATED SMOKING DEVICES
A24B,MANUFACTURE OR PREPARATION OF TOBACCO FOR SMOKING OR CHEWING; TOBACCO; SNUFF
A41F,GARMENT FASTENINGS; SUSPENDERS
A41G,ARTIFICIAL FLOWERS; WIGS; MASKS; FEATHERS
A41B,SHIRTS; UNDERWEAR; BABY LINEN; HANDKERCHIEFS
A41D,OUTERWEAR; PROTECTIVE GARMENTS; ACCESSORIES
A41C,CORSETS; BRASSIERES
A41H,"APPLIANCES OR METHODS FOR MAKING CLOTHES, e.g. FOR DRESS-MAKING OR FOR TAILORING, NOT OTHERWISE PROVIDED FOR"
A42B,HATS; HEAD COVERINGS
A42C,"MANUFACTURING OR TRIMMING HEAD COVERINGS, e.g. HATS"
A43B,CHARACTERISTIC FEATURES OF FOOTWEAR; PARTS OF FOOTWEAR
A43C,FASTENINGS OR ATTACHMENTS OF FOOTWEAR; LACES IN GENERAL
A43D,"MACHINES, TOOLS, EQUIPMENT OR METHODS FOR MANUFACTURING OR REPAIRING FOOTWEAR"
A44D,"INDEXING SCHEME RELATING TO BUTTONS, PINS, BUCKLES OR SLIDE FASTENERS, AND TO JEWELLERY, BRACELETS OR OTHER PERSONAL ADORNMENTS"
A44B,"BUTTONS, PINS, BUCKLES, SLIDE FASTENERS, OR THE LIKE"
A44C,"PERSONAL ADORNMENTS, e.g. JEWELLERY; COINS"
A45F,TRAVELLING OR CAMP EQUIPMENT: SACKS OR PACKS CARRIED ON THE BODY
A45C,PURSES; LUGGAGE; HAND CARRIED BAGS
A45D,"HAIRDRESSING OR SHAVING EQUIPMENT; EQUIPMENT FOR COSMETICS OR COSMETIC TREATMENTS, e.g. FOR MANICURING OR PEDICURING"
A45B,WALKING STICKS; UMBRELLAS; LADIES' OR LIKE FANS
A46D,MANUFACTURE OF BRUSHES
A46B,BRUSHES
A47L,DOMESTIC WASHING OR CLEANING; SUCTION CLEANERS IN GENERAL
A47F,"SPECIAL FURNITURE, FITTINGS, OR ACCESSORIES FOR SHOPS, STOREHOUSES, BARS, RESTAURANTS OR THE LIKE; PAYING COUNTERS"
A47D,FURNITURE SPECIALLY ADAPTED FOR CHILDREN
A47G,HOUSEHOLD OR TABLE EQUIPMENT
A47K,SANITARY EQUIPMENT NOT OTHERWISE PROVIDED FOR; TOILET ACCESSORIES
A47H,FURNISHINGS FOR WINDOWS OR DOORS
A47B,TABLES; DESKS; OFFICE FURNITURE; CABINETS; DRAWERS; GENERAL DETAILS OF FURNITURE
A47C,CHAIRS; SOFAS; BEDS
A47J,KITCHEN EQUIPMENT; COFFEE MILLS; SPICE MILLS;

2025-01-27 01:41:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:41:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:41:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:41:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-27 01:41:13 - snowflake.connector.connection - INFO - closed
2025-01-27 01:41:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:41:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:41:39 - root - INFO - ```sql
SELECT c.value:"symbol"::STRING AS "CPC_Symbol", d."titleFull" AS "Full_Title"
FROM PATENTS.PATENTS.CPC_DEFINITION d
JOIN (
    SELECT DISTINCT c.value:"symbol"::STRING AS "CPC_Symbol"
    FROM PATENTS.PATENTS.PUBLICATIONS p,
    LATERAL FLATTEN(input => p."cpc") c
    WHERE c.value:"symbol"::STRING IS NOT NULL
) AS cpc_symbols ON d."symbol" = cpc_symbols."CPC_Symbol"
LIMIT 100;
```
2025-01-27 01:41:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:41:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:41:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:41:40 - snowflake.connector.connection - INFO - closed
2025-01-27 01:41:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:41:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:41:56 - root - INFO - ```sql
SELECT t."publication_number", c."VALUE":"symbol"::STRING AS "CPC_Symbol"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."cpc") c
WHERE c."VALUE":"symbol"::STRING IS NOT NULL
LIMIT 100;
```
2025-01-27 01:41:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:41:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:41:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:41:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-27 01:41:59 - snowflake.connector.connection - INFO - closed
2025-01-27 01:41:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:42:34 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:42:34 - root - INFO - ```sql
SELECT "symbol" AS "CPC_Symbol", "titleFull" AS "Full_Title"
FROM PATENTS.PATENTS.CPC_DEFINITION
LIMIT 100;
```
2025-01-27 01:42:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:42:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:42:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:42:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 01:42:36 - snowflake.connector.connection - INFO - closed
2025-01-27 01:42:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:43:46 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:43:46 - root - INFO - SQL:
SELECT "symbol" AS "CPC_Symbol", "titleFull" AS "Full_Title"
FROM PATENTS.PATENTS.CPC_DEFINITION
LIMIT 100;
Results:
Too long, hard cut:
CPC_Symbol,Full_Title
B,PERFORMING OPERATIONS; TRANSPORTING
H,ELECTRICITY
Y,GENERAL TAGGING OF NEW TECHNOLOGICAL DEVELOPMENTS; GENERAL TAGGING OF CROSS-SECTIONAL TECHNOLOGIES SPANNING OVER SEVERAL SECTIONS OF THE IPC; TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS
D,TEXTILES; PAPER
F,MECHANICAL ENGINEERING; LIGHTING; HEATING; WEAPONS; BLASTING
E,FIXED CONSTRUCTIONS
C,CHEMISTRY; METALLURGY
G,PHYSICS
A,HUMAN NECESSITIES
A45,HAND OR TRAVELLING ARTICLES
A24,TOBACCO; CIGARS; CIGARETTES; SIMULATED SMOKING DEVICES; SMOKERS' REQUISITES
A61,MEDICAL OR VETERINARY SCIENCE; HYGIENE
A63,SPORTS; GAMES; AMUSEMENTS
A22,BUTCHERING; MEAT TREATMENT; PROCESSING POULTRY OR FISH
A42,HEADWEAR
A99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
A43,FOOTWEAR
A01,AGRICULTURE; FORESTRY; ANIMAL HUSBANDRY; HUNTING; TRAPPING; FISHING
A62,LIFE-SAVING; FIRE-FIGHTING
A23,"FOODS OR FOODSTUFFS; TREATMENT THEREOF, NOT COVERED BY OTHER CLASSES"
A47,FURNITURE; DOMESTIC ARTICLES OR APPLIANCES; COFFEE MILLS; SPICE MILLS; SUCTION CLEANERS IN GENERAL
A46,BRUSHWARE
A44,HABERDASHERY; JEWELLERY
A21,BAKING; EDIBLE DOUGHS
A41,WEARING APPAREL
B27,WORKING OR PRESERVING WOOD OR SIMILAR MATERIAL; NAILING OR STAPLING MACHINES IN GENERAL
B68,SADDLERY; UPHOLSTERY
B04,CENTRIFUGAL APPARATUS OR MACHINES FOR CARRYING-OUT PHYSICAL OR CHEMICAL PROCESSES
B23,MACHINE TOOLS; METAL-WORKING NOT OTHERWISE PROVIDED FOR
B30,PRESSES
B21,MECHANICAL METAL-WORKING WITHOUT ESSENTIALLY REMOVING MATERIAL; PUNCHING METAL
B25,HAND TOOLS; PORTABLE POWER-DRIVEN TOOLS; MANIPULATORS
B99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
B29,WORKING OF PLASTICS; WORKING OF SUBSTANCES IN A PLASTIC STATE IN GENERAL
B31,"MAKING ARTICLES OF PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER; WORKING PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER"
B26,HAND CUTTING TOOLS; CUTTING; SEVERING
B66,HOISTING; LIFTING; HAULING
B02,"CRUSHING, PULVERISING, OR DISINTEGRATING; PREPARATORY TREATMENT OF GRAIN FOR MILLING"
B65,CONVEYING; PACKING; STORING; HANDLING THIN OR FILAMENTARY MATERIAL
B61,RAILWAYS
B24,GRINDING; POLISHING
B06,GENERATING OR TRANSMITTING MECHANICAL VIBRATIONS IN GENERAL
B43,WRITING OR DRAWING IMPLEMENTS; BUREAU ACCESSORIES
B62,LAND VEHICLES FOR TRAVELLING OTHERWISE THAN ON RAILS
B64,AIRCRAFT; AVIATION; COSMONAUTICS
B22,CASTING; POWDER METALLURGY
B28,"WORKING CEMENT, CLAY, OR STONE"
B09,DISPOSAL OF SOLID WASTE; RECLAMATION OF CONTAMINATED SOIL
B01,PHYSICAL OR CHEMICAL PROCESSES OR APPARATUS IN GENERAL
B63,SHIPS OR OTHER WATERBORNE VESSELS; RELATED EQUIPMENT
B60,VEHICLES IN GENERAL
B44,DECORATIVE ARTS
B07,SEPARATING SOLIDS FROM SOLIDS; SORTING
B08,CLEANING
B82,NANOTECHNOLOGY
B42,BOOKBINDING; ALBUMS; FILES; SPECIAL PRINTED MATTER
B32,LAYERED PRODUCTS
B81,MICROSTRUCTURAL TECHNOLOGY
B05,"SPRAYING OR ATOMISING IN GENERAL; APPLYING FLUENT MATERIALS TO SURFACES, IN GENERAL"
B41,PRINTING; LINING MACHINES; TYPEWRITERS; STAMPS
B03,SEPARATION OF SOLID MATERIALS USING LIQUIDS OR USING PNEUMATIC TABLES OR JIGS; MAGNETIC OR ELECTROSTATIC SEPARATION OF SOLID MATERIALS FROM SOLID MATERIALS OR FLUIDS; SEPARATION BY HIGH-VOLTAGE ELECTRIC FIELDS
B67,"OPENING, CLOSING OR CLEANING BOTTLES, JARS OR SIMILAR CONTAINERS; LIQUID HANDLING"
B33,ADDITIVE MANUFACTURING TECHNOLOGY
C22,METALLURGY; FERROUS OR NON-FERROUS ALLOYS; TREATMENT OF ALLOYS OR NON-FERROUS METALS
C23,"COATING METALLIC MATERIAL; COATING MATERIAL WITH METALLIC MATERIAL; CHEMICAL SURFACE TREATMENT; DIFFUSION TREATMENT OF METALLIC MATERIAL; COATING BY VACUUM EVAPORATION, BY SPUTTERING, BY ION IMPLANTATION OR BY CHEMICAL VAPOUR DEPOSITION, IN GENERAL; INHIBITING CORROSION OF METALLIC MATERIAL OR INCRUSTATION IN GENERAL"
C06,EXPLOSIVES; MATCHES
C02,"TREATMENT OF WATER, WASTE WATER, SEWAGE, OR SLUDGE"
C07,ORGANIC CHEMISTRY
C25,ELECTROLYTIC OR ELECTROPHORETIC PROCESSES; APPARATUS THEREFOR
C30,CRYSTAL GROWTH
C12,BIOCHEMISTRY; BEER; SPIRITS; WINE; VINEGAR; MICROBIOLOGY; ENZYMOLOGY; MUTATION OR GENETIC ENGINEERING
C99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
C05,FERTILISERS; MANUFACTURE THEREOF
C40,COMBINATORIAL TECHNOLOGY
C11,"ANIMAL OR VEGETABLE OILS, FATS, FATTY SUBSTANCES OR WAXES; FATTY ACIDS THEREFROM; DETERGENTS; CANDLES"
C08,ORGANIC MACROMOLECULAR COMPOUNDS; THEIR PREPARATION OR CHEMICAL WORKING-UP; COMPOSITIONS BASED THEREON
C10,"PETROLEUM, GAS OR COKE INDUSTRIES; TECHNICAL GASES CONTAINING CARBON MONOXIDE; FUELS; LUBRICANTS; PEAT"
C21,METALLURGY OF IRON
C04,CEMENTS; CONCRETE; ARTIFICIAL STONE; CERAMICS; REFRACTORIES
C09,DYES; PAINTS; POLISHES; NATURAL RESINS; ADHESIVES; COMPOSITIONS NOT OTHERWISE PROVIDED FOR; APPLICATIONS OF MATERIALS NOT OTHERWISE PROVIDED FOR
C03,GLASS; MINERAL OR SLAG WOOL
C13,SUGAR INDUSTRY
C14,SKINS; HIDES; PELTS; LEATHER
C01,INORGANIC CHEMISTRY
D02,YARNS; MECHANICAL FINISHING OF YARNS OR ROPES; WARPING OR BEAMING
D21,PAPER-MAKING; PRODUCTION OF CELLULOSE
D04,BRAIDING; LACE-MAKING; KNITTING; TRIMMINGS; NON-WO

2025-01-27 01:43:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:43:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:43:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:43:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-27 01:43:47 - snowflake.connector.connection - INFO - closed
2025-01-27 01:43:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:44:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:44:32 - root - INFO - ```sql
SELECT *
FROM PATENTS.PATENTS.CPC_DEFINITION
LIMIT 100;
```
2025-01-27 01:44:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:44:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:44:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:44:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 01:44:34 - snowflake.connector.connection - INFO - closed
2025-01-27 01:44:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:46:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:46:13 - root - INFO - SQL:
SELECT *
FROM PATENTS.PATENTS.CPC_DEFINITION
LIMIT 100;
Results:
Too long, hard cut:
applicationReferences,breakdownCode,childGroups,children,dateRevised,definition,glossary,informativeReferences,ipcConcordant,level,limitingReferences,notAllocatable,parents,precedenceLimitingReferences,residualReferences,rules,scopeLimitingReferences,status,symbol,synonyms,titleFull,titlePart
[],False,"[
  {
    ""description"": ""SEPARATING; MIXING"",
    ""symbols"": [
      ""B01"",
      ""B02"",
      ""B03"",
      ""B04"",
      ""B05"",
      ""B06"",
      ""B07"",
      ""B08"",
      ""B09""
    ]
  },
  {
    ""description"": ""SHAPING"",
    ""symbols"": [
      ""B21"",
      ""B22"",
      ""B23"",
      ""B24"",
      ""B25"",
      ""B26"",
      ""B27"",
      ""B28"",
      ""B29"",
      ""B30"",
      ""B31"",
      ""B32"",
      ""B33""
    ]
  },
  {
    ""description"": ""PRINTING"",
    ""symbols"": [
      ""B41"",
      ""B42"",
      ""B43"",
      ""B44""
    ]
  },
  {
    ""description"": ""TRANSPORTING"",
    ""symbols"": [
      ""B60"",
      ""B61"",
      ""B62"",
      ""B63"",
      ""B64"",
      ""B65"",
      ""B66"",
      ""B67"",
      ""B68""
    ]
  },
  {
    ""description"": ""MICROSTRUCTURAL TECHNOLOGY; NANOTECHNOLOGY"",
    ""symbols"": [
      ""B81"",
      ""B82""
    ]
  },
  {
    ""description"": """",
    ""symbols"": [
      ""B99""
    ]
  }
]","[
  ""B01"",
  ""B02"",
  ""B03"",
  ""B04"",
  ""B05"",
  ""B06"",
  ""B07"",
  ""B08"",
  ""B09"",
  ""B21"",
  ""B22"",
  ""B23"",
  ""B24"",
  ""B25"",
  ""B26"",
  ""B27"",
  ""B28"",
  ""B29"",
  ""B30"",
  ""B31"",
  ""B32"",
  ""B33"",
  ""B41"",
  ""B42"",
  ""B43"",
  ""B44"",
  ""B60"",
  ""B61"",
  ""B62"",
  ""B63"",
  ""B64"",
  ""B65"",
  ""B66"",
  ""B67"",
  ""B68"",
  ""B81"",
  ""B82"",
  ""B99""
]",20160501.0,[],[],[],,2.0,[],True,[],[],[],[],[],published,B,[],PERFORMING OPERATIONS; TRANSPORTING,"[
  ""PERFORMING OPERATIONS"",
  ""TRANSPORTING""
]"
[],False,"[
  {
    ""description"": """",
    ""symbols"": [
      ""H01"",
      ""H02"",
      ""H03"",
      ""H04"",
      ""H05"",
      ""H10"",
      ""H99""
    ]
  }
]","[
  ""H01"",
  ""H02"",
  ""H03"",
  ""H04"",
  ""H05"",
  ""H10"",
  ""H99""
]",20200101.0,[],[],[],,2.0,[],True,[],[],[],[],[],published,H,[],ELECTRICITY,"[
  ""ELECTRICITY""
]"
[],False,"[
  {
    ""description"": """",
    ""symbols"": [
      ""Y02"",
      ""Y04"",
      ""Y10""
    ]
  }
]","[
  ""Y02"",
  ""Y04"",
  ""Y10""
]",20130101.0,[],[],[],,2.0,[],True,[],[],[],[],[],published,Y,[],GENERAL TAGGING OF NEW TECHNOLOGICAL DEVELOPMENTS; GENERAL TAGGING OF CROSS-SECTIONAL TECHNOLOGIES SPANNING OVER SEVERAL SECTIONS OF THE IPC; TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS,"[
  ""GENERAL TAGGING OF NEW TECHNOLOGICAL DEVELOPMENTS"",
  ""GENERAL TAGGING OF CROSS-SECTIONAL TECHNOLOGIES SPANNING OVER SEVERAL SECTIONS OF THE IPC"",
  ""TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS""
]"
[],False,"[
  {
    ""description"": ""TEXTILES OR FLEXIBLE MATERIALS NOT OTHERWISE PROVIDED FOR"",
    ""symbols"": [
      ""D01"",
      ""D02"",
      ""D03"",
      ""D04"",
      ""D05"",
      ""D06"",
      ""D07"",
      ""D10""
    ]
  },
  {
    ""description"": ""PAPER"",
    ""symbols"": [
      ""D21""
    ]
  },
  {
    ""description"": """",
    ""symbols"": [
      ""D99""
    ]
  }
]","[
  ""D01"",
  ""D02"",
  ""D03"",
  ""D04"",
  ""D05"",
  ""D06"",
  ""D07"",
  ""D10"",
  ""D21"",
  ""D99""
]",20130101.0,[],[],[],,2.0,[],True,[],[],[],[],[],published,D,[],TEXTILES; PAPER,"[
  ""TEXTILES"",
  ""PAPER""
]"
[],False,"[
  {
    ""description"": ""ENGINES OR PUMPS"",
    ""symbols"": [
      ""F01"",
      ""F02"",
      ""F03"",
      ""F04"",
      ""F05""
    ]
  },
  {
    ""description"": ""ENGINEERING IN GENERAL"",
    ""symbols"": [
      ""F15"",
      ""F16"",
      ""F17""
    ]
  },
  {
    ""description"": ""LIGHTING; HEATING"",
    ""symbols"": [
      ""F21"",
      ""F22"",
      ""F23"",
      ""F24"",
      ""F25"",
      ""F26"",
      ""F27"",
      ""F28""
    ]
  },
  {
    ""description"": ""WEAPONS; BLASTING"",
    ""symbols"": [
      ""F41"",
      ""F42""
    ]
  },
  {
    ""description"": """",
    ""symbols"": [
      ""F99""
    ]
  }
]","[
  ""F01"",
  ""F02"",
  ""F03"",
  ""F04"",
  ""F05"",
  ""F15"",
  ""F16"",
  ""F17"",
  ""F21"",
  ""F22"",
  ""F23"",
  ""F24"",
  ""F25"",
  ""F26"",
  ""F27"",
  ""F28"",
  ""F41"",
  ""F42"",
  ""F99""
]",20190201.0,[],[],[],,2.0,[],True,[],[],[],[],[],published,F,[],MECHANICAL ENGINEERING; LIGHTING; HEATING; WEAPONS; BLASTING,"[
  ""MECHANICAL ENGINEERING"",
  ""LIGHTING"",
  ""HEATING"",
  ""WEAPONS"",
  ""BLASTING""
]"
[],False,"[
  {
    ""description"": ""BUILDING"",
    ""symbols"": [
      ""E01"",
      ""E02"",
      ""E03"",
      ""E04"",
      ""E05"",
      ""E06""
    ]
  },
  {
    ""description"": ""EARTH DRILLING; MINING"",
    ""symbols"": [
      ""E21""
    ]
  },
  {
    ""descri

2025-01-27 01:46:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:46:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:46:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:46:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 01:46:14 - snowflake.connector.connection - INFO - closed
2025-01-27 01:46:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:46:15 - root - INFO - SQL:
SELECT TO_VARCHAR(TRY_TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "Year",
       COUNT(DISTINCT "publication_number") AS "Publication_Count"
FROM PATENTS.PATENTS.PUBLICATIONS
GROUP BY "Year"
ORDER BY "Year"
LIMIT 100
Results:
Year,Publication_Count
1837,2
1839,2
1841,4
1842,5
1843,2
1844,3
1845,1
1846,2
1847,3
1848,2
1849,1
1850,2
1851,1
1852,1
1853,4
1854,3
1855,4
1856,6
1857,3
1858,16
1859,15
1860,13
1861,12
1862,7
1863,12
1864,11
1865,12
1866,26
1867,18
1868,17
1869,25
1870,35
1871,34
1872,28
1873,27
1874,30
1875,26
1876,33
1877,33
1878,54
1879,72
1880,57
1881,76
1882,112
1883,101
1884,99
1885,103
1886,100
1887,96
1888,102
1889,112
1890,111
1891,100
1892,125
1893,93
1894,100
1895,97
1896,84
1897,102
1898,81
1899,84
1900,162
1901,86
1902,94
1903,133
1904,135
1905,112
1906,149
1907,203
1908,192
1909,169
1910,133
1911,137
1912,189
1913,279
1914,351
1915,220
1916,163
1917,147
1918,142
1919,160
1920,183
1921,189
1922,235
1923,231
1924,216
1925,252
1926,235
1927,244
1928,243
1929,259
1930,335
1931,319
1932,335
1933,259
1934,265
1935,296
1936,351
1937,322
1938,334

2025-01-27 01:46:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:46:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:46:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:49:36 - snowflake.connector.connection - INFO - closed
2025-01-27 01:49:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:50:06 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:50:06 - root - INFO - ```sql
SELECT DISTINCT c."VALUE":"symbol"::STRING AS "CPC_Symbol", d."titleFull" AS "Full_Title"
FROM (
    SELECT *
    FROM PATENTS.PATENTS.PUBLICATIONS
    LIMIT 1000
) p,
LATERAL FLATTEN(input => p."cpc") c
JOIN PATENTS.PATENTS.CPC_DEFINITION d
  ON c."VALUE":"symbol"::STRING = d."symbol"
LIMIT 100;
```
2025-01-27 01:50:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:50:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:50:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:50:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-27 01:50:08 - snowflake.connector.connection - INFO - closed
2025-01-27 01:50:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:51:00 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:51:00 - root - INFO - ```sql
SELECT "symbol" AS "CPC_Symbol", "titleFull" AS "Full_Title"
FROM PATENTS.PATENTS.CPC_DEFINITION
LIMIT 100;
```
2025-01-27 01:51:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:51:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:51:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:51:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 01:51:02 - snowflake.connector.connection - INFO - closed
2025-01-27 01:51:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:52:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:52:02 - root - INFO - SQL:
SELECT "symbol" AS "CPC_Symbol", "titleFull" AS "Full_Title"
FROM PATENTS.PATENTS.CPC_DEFINITION
LIMIT 100;
Results:
Too long, hard cut:
CPC_Symbol,Full_Title
B,PERFORMING OPERATIONS; TRANSPORTING
H,ELECTRICITY
Y,GENERAL TAGGING OF NEW TECHNOLOGICAL DEVELOPMENTS; GENERAL TAGGING OF CROSS-SECTIONAL TECHNOLOGIES SPANNING OVER SEVERAL SECTIONS OF THE IPC; TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS
D,TEXTILES; PAPER
F,MECHANICAL ENGINEERING; LIGHTING; HEATING; WEAPONS; BLASTING
E,FIXED CONSTRUCTIONS
C,CHEMISTRY; METALLURGY
G,PHYSICS
A,HUMAN NECESSITIES
A45,HAND OR TRAVELLING ARTICLES
A24,TOBACCO; CIGARS; CIGARETTES; SIMULATED SMOKING DEVICES; SMOKERS' REQUISITES
A61,MEDICAL OR VETERINARY SCIENCE; HYGIENE
A63,SPORTS; GAMES; AMUSEMENTS
A22,BUTCHERING; MEAT TREATMENT; PROCESSING POULTRY OR FISH
A42,HEADWEAR
A99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
A43,FOOTWEAR
A01,AGRICULTURE; FORESTRY; ANIMAL HUSBANDRY; HUNTING; TRAPPING; FISHING
A62,LIFE-SAVING; FIRE-FIGHTING
A23,"FOODS OR FOODSTUFFS; TREATMENT THEREOF, NOT COVERED BY OTHER CLASSES"
A47,FURNITURE; DOMESTIC ARTICLES OR APPLIANCES; COFFEE MILLS; SPICE MILLS; SUCTION CLEANERS IN GENERAL
A46,BRUSHWARE
A44,HABERDASHERY; JEWELLERY
A21,BAKING; EDIBLE DOUGHS
A41,WEARING APPAREL
B27,WORKING OR PRESERVING WOOD OR SIMILAR MATERIAL; NAILING OR STAPLING MACHINES IN GENERAL
B68,SADDLERY; UPHOLSTERY
B04,CENTRIFUGAL APPARATUS OR MACHINES FOR CARRYING-OUT PHYSICAL OR CHEMICAL PROCESSES
B23,MACHINE TOOLS; METAL-WORKING NOT OTHERWISE PROVIDED FOR
B30,PRESSES
B21,MECHANICAL METAL-WORKING WITHOUT ESSENTIALLY REMOVING MATERIAL; PUNCHING METAL
B25,HAND TOOLS; PORTABLE POWER-DRIVEN TOOLS; MANIPULATORS
B99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
B29,WORKING OF PLASTICS; WORKING OF SUBSTANCES IN A PLASTIC STATE IN GENERAL
B31,"MAKING ARTICLES OF PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER; WORKING PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER"
B26,HAND CUTTING TOOLS; CUTTING; SEVERING
B66,HOISTING; LIFTING; HAULING
B02,"CRUSHING, PULVERISING, OR DISINTEGRATING; PREPARATORY TREATMENT OF GRAIN FOR MILLING"
B65,CONVEYING; PACKING; STORING; HANDLING THIN OR FILAMENTARY MATERIAL
B61,RAILWAYS
B24,GRINDING; POLISHING
B06,GENERATING OR TRANSMITTING MECHANICAL VIBRATIONS IN GENERAL
B43,WRITING OR DRAWING IMPLEMENTS; BUREAU ACCESSORIES
B62,LAND VEHICLES FOR TRAVELLING OTHERWISE THAN ON RAILS
B64,AIRCRAFT; AVIATION; COSMONAUTICS
B22,CASTING; POWDER METALLURGY
B28,"WORKING CEMENT, CLAY, OR STONE"
B09,DISPOSAL OF SOLID WASTE; RECLAMATION OF CONTAMINATED SOIL
B01,PHYSICAL OR CHEMICAL PROCESSES OR APPARATUS IN GENERAL
B63,SHIPS OR OTHER WATERBORNE VESSELS; RELATED EQUIPMENT
B60,VEHICLES IN GENERAL
B44,DECORATIVE ARTS
B07,SEPARATING SOLIDS FROM SOLIDS; SORTING
B08,CLEANING
B82,NANOTECHNOLOGY
B42,BOOKBINDING; ALBUMS; FILES; SPECIAL PRINTED MATTER
B32,LAYERED PRODUCTS
B81,MICROSTRUCTURAL TECHNOLOGY
B05,"SPRAYING OR ATOMISING IN GENERAL; APPLYING FLUENT MATERIALS TO SURFACES, IN GENERAL"
B41,PRINTING; LINING MACHINES; TYPEWRITERS; STAMPS
B03,SEPARATION OF SOLID MATERIALS USING LIQUIDS OR USING PNEUMATIC TABLES OR JIGS; MAGNETIC OR ELECTROSTATIC SEPARATION OF SOLID MATERIALS FROM SOLID MATERIALS OR FLUIDS; SEPARATION BY HIGH-VOLTAGE ELECTRIC FIELDS
B67,"OPENING, CLOSING OR CLEANING BOTTLES, JARS OR SIMILAR CONTAINERS; LIQUID HANDLING"
B33,ADDITIVE MANUFACTURING TECHNOLOGY
C22,METALLURGY; FERROUS OR NON-FERROUS ALLOYS; TREATMENT OF ALLOYS OR NON-FERROUS METALS
C23,"COATING METALLIC MATERIAL; COATING MATERIAL WITH METALLIC MATERIAL; CHEMICAL SURFACE TREATMENT; DIFFUSION TREATMENT OF METALLIC MATERIAL; COATING BY VACUUM EVAPORATION, BY SPUTTERING, BY ION IMPLANTATION OR BY CHEMICAL VAPOUR DEPOSITION, IN GENERAL; INHIBITING CORROSION OF METALLIC MATERIAL OR INCRUSTATION IN GENERAL"
C06,EXPLOSIVES; MATCHES
C02,"TREATMENT OF WATER, WASTE WATER, SEWAGE, OR SLUDGE"
C07,ORGANIC CHEMISTRY
C25,ELECTROLYTIC OR ELECTROPHORETIC PROCESSES; APPARATUS THEREFOR
C30,CRYSTAL GROWTH
C12,BIOCHEMISTRY; BEER; SPIRITS; WINE; VINEGAR; MICROBIOLOGY; ENZYMOLOGY; MUTATION OR GENETIC ENGINEERING
C99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
C05,FERTILISERS; MANUFACTURE THEREOF
C40,COMBINATORIAL TECHNOLOGY
C11,"ANIMAL OR VEGETABLE OILS, FATS, FATTY SUBSTANCES OR WAXES; FATTY ACIDS THEREFROM; DETERGENTS; CANDLES"
C08,ORGANIC MACROMOLECULAR COMPOUNDS; THEIR PREPARATION OR CHEMICAL WORKING-UP; COMPOSITIONS BASED THEREON
C10,"PETROLEUM, GAS OR COKE INDUSTRIES; TECHNICAL GASES CONTAINING CARBON MONOXIDE; FUELS; LUBRICANTS; PEAT"
C21,METALLURGY OF IRON
C04,CEMENTS; CONCRETE; ARTIFICIAL STONE; CERAMICS; REFRACTORIES
C09,DYES; PAINTS; POLISHES; NATURAL RESINS; ADHESIVES; COMPOSITIONS NOT OTHERWISE PROVIDED FOR; APPLICATIONS OF MATERIALS NOT OTHERWISE PROVIDED FOR
C03,GLASS; MINERAL OR SLAG WOOL
C13,SUGAR INDUSTRY
C14,SKINS; HIDES; PELTS; LEATHER
C01,INORGANIC CHEMISTRY
D02,YARNS; MECHANICAL FINISHING OF YARNS OR ROPES; WARPING OR BEAMING
D21,PAPER-MAKING; PRODUCTION OF CELLULOSE
D04,BRAIDING; LACE-MAKING; KNITTING; TRIMMINGS; NON-WO

2025-01-27 01:52:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:52:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:52:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:52:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 01:52:03 - snowflake.connector.connection - INFO - closed
2025-01-27 01:52:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:52:04 - root - INFO - SQL:
SELECT "symbol" AS "CPC_Symbol", "titleFull" AS "Full_Title", "level"
FROM PATENTS.PATENTS.CPC_DEFINITION
LIMIT 100
Results:
Too long, hard cut:
CPC_Symbol,Full_Title,level
B,PERFORMING OPERATIONS; TRANSPORTING,2.0
H,ELECTRICITY,2.0
Y,GENERAL TAGGING OF NEW TECHNOLOGICAL DEVELOPMENTS; GENERAL TAGGING OF CROSS-SECTIONAL TECHNOLOGIES SPANNING OVER SEVERAL SECTIONS OF THE IPC; TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS,2.0
D,TEXTILES; PAPER,2.0
F,MECHANICAL ENGINEERING; LIGHTING; HEATING; WEAPONS; BLASTING,2.0
E,FIXED CONSTRUCTIONS,2.0
C,CHEMISTRY; METALLURGY,2.0
G,PHYSICS,2.0
A,HUMAN NECESSITIES,2.0
A45,HAND OR TRAVELLING ARTICLES,4.0
A24,TOBACCO; CIGARS; CIGARETTES; SIMULATED SMOKING DEVICES; SMOKERS' REQUISITES,4.0
A61,MEDICAL OR VETERINARY SCIENCE; HYGIENE,4.0
A63,SPORTS; GAMES; AMUSEMENTS,4.0
A22,BUTCHERING; MEAT TREATMENT; PROCESSING POULTRY OR FISH,4.0
A42,HEADWEAR,4.0
A99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION,4.0
A43,FOOTWEAR,4.0
A01,AGRICULTURE; FORESTRY; ANIMAL HUSBANDRY; HUNTING; TRAPPING; FISHING,4.0
A62,LIFE-SAVING; FIRE-FIGHTING,4.0
A23,"FOODS OR FOODSTUFFS; TREATMENT THEREOF, NOT COVERED BY OTHER CLASSES",4.0
A47,FURNITURE; DOMESTIC ARTICLES OR APPLIANCES; COFFEE MILLS; SPICE MILLS; SUCTION CLEANERS IN GENERAL,4.0
A46,BRUSHWARE,4.0
A44,HABERDASHERY; JEWELLERY,4.0
A21,BAKING; EDIBLE DOUGHS,4.0
A41,WEARING APPAREL,4.0
B27,WORKING OR PRESERVING WOOD OR SIMILAR MATERIAL; NAILING OR STAPLING MACHINES IN GENERAL,4.0
B68,SADDLERY; UPHOLSTERY,4.0
B04,CENTRIFUGAL APPARATUS OR MACHINES FOR CARRYING-OUT PHYSICAL OR CHEMICAL PROCESSES,4.0
B23,MACHINE TOOLS; METAL-WORKING NOT OTHERWISE PROVIDED FOR,4.0
B30,PRESSES,4.0
B21,MECHANICAL METAL-WORKING WITHOUT ESSENTIALLY REMOVING MATERIAL; PUNCHING METAL,4.0
B25,HAND TOOLS; PORTABLE POWER-DRIVEN TOOLS; MANIPULATORS,4.0
B99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION,4.0
B29,WORKING OF PLASTICS; WORKING OF SUBSTANCES IN A PLASTIC STATE IN GENERAL,4.0
B31,"MAKING ARTICLES OF PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER; WORKING PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER",4.0
B26,HAND CUTTING TOOLS; CUTTING; SEVERING,4.0
B66,HOISTING; LIFTING; HAULING,4.0
B02,"CRUSHING, PULVERISING, OR DISINTEGRATING; PREPARATORY TREATMENT OF GRAIN FOR MILLING",4.0
B65,CONVEYING; PACKING; STORING; HANDLING THIN OR FILAMENTARY MATERIAL,4.0
B61,RAILWAYS,4.0
B24,GRINDING; POLISHING,4.0
B06,GENERATING OR TRANSMITTING MECHANICAL VIBRATIONS IN GENERAL,4.0
B43,WRITING OR DRAWING IMPLEMENTS; BUREAU ACCESSORIES,4.0
B62,LAND VEHICLES FOR TRAVELLING OTHERWISE THAN ON RAILS,4.0
B64,AIRCRAFT; AVIATION; COSMONAUTICS,4.0
B22,CASTING; POWDER METALLURGY,4.0
B28,"WORKING CEMENT, CLAY, OR STONE",4.0
B09,DISPOSAL OF SOLID WASTE; RECLAMATION OF CONTAMINATED SOIL,4.0
B01,PHYSICAL OR CHEMICAL PROCESSES OR APPARATUS IN GENERAL,4.0
B63,SHIPS OR OTHER WATERBORNE VESSELS; RELATED EQUIPMENT,4.0
B60,VEHICLES IN GENERAL,4.0
B44,DECORATIVE ARTS,4.0
B07,SEPARATING SOLIDS FROM SOLIDS; SORTING,4.0
B08,CLEANING,4.0
B82,NANOTECHNOLOGY,4.0
B42,BOOKBINDING; ALBUMS; FILES; SPECIAL PRINTED MATTER,4.0
B32,LAYERED PRODUCTS,4.0
B81,MICROSTRUCTURAL TECHNOLOGY,4.0
B05,"SPRAYING OR ATOMISING IN GENERAL; APPLYING FLUENT MATERIALS TO SURFACES, IN GENERAL",4.0
B41,PRINTING; LINING MACHINES; TYPEWRITERS; STAMPS,4.0
B03,SEPARATION OF SOLID MATERIALS USING LIQUIDS OR USING PNEUMATIC TABLES OR JIGS; MAGNETIC OR ELECTROSTATIC SEPARATION OF SOLID MATERIALS FROM SOLID MATERIALS OR FLUIDS; SEPARATION BY HIGH-VOLTAGE ELECTRIC FIELDS,4.0
B67,"OPENING, CLOSING OR CLEANING BOTTLES, JARS OR SIMILAR CONTAINERS; LIQUID HANDLING",4.0
B33,ADDITIVE MANUFACTURING TECHNOLOGY,4.0
C22,METALLURGY; FERROUS OR NON-FERROUS ALLOYS; TREATMENT OF ALLOYS OR NON-FERROUS METALS,4.0
C23,"COATING METALLIC MATERIAL; COATING MATERIAL WITH METALLIC MATERIAL; CHEMICAL SURFACE TREATMENT; DIFFUSION TREATMENT OF METALLIC MATERIAL; COATING BY VACUUM EVAPORATION, BY SPUTTERING, BY ION IMPLANTATION OR BY CHEMICAL VAPOUR DEPOSITION, IN GENERAL; INHIBITING CORROSION OF METALLIC MATERIAL OR INCRUSTATION IN GENERAL",4.0
C06,EXPLOSIVES; MATCHES,4.0
C02,"TREATMENT OF WATER, WASTE WATER, SEWAGE, OR SLUDGE",4.0
C07,ORGANIC CHEMISTRY,4.0
C25,ELECTROLYTIC OR ELECTROPHORETIC PROCESSES; APPARATUS THEREFOR,4.0
C30,CRYSTAL GROWTH,4.0
C12,BIOCHEMISTRY; BEER; SPIRITS; WINE; VINEGAR; MICROBIOLOGY; ENZYMOLOGY; MUTATION OR GENETIC ENGINEERING,4.0
C99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION,4.0
C05,FERTILISERS; MANUFACTURE THEREOF,4.0
C40,COMBINATORIAL TECHNOLOGY,4.0
C11,"ANIMAL OR VEGETABLE OILS, FATS, FATTY SUBSTANCES OR WAXES; FATTY ACIDS THEREFROM; DETERGENTS; CANDLES",4.0
C08,ORGANIC MACROMOLECULAR COMPOUNDS; THEIR PREPARATION OR CHEMICAL WORKING-UP; COMPOSITIONS BASED THEREON,4.0
C10,"PETROLEUM, GAS OR COKE INDUSTRIES; TECHNICAL GASES CONTAINING CARBON MONOXIDE; FUELS; LUBRICANTS; PEAT",4.0
C21,METALLURGY OF IRON,4.0
C04,CEMENTS; CONCRETE; ARTIFICIAL STONE; CERAMICS; REFRACTORIES,4.0
C09,DYES; PAINTS; POLISHES; NATURAL RESINS; ADHESIVES; COMPOSITIONS NOT OTHERWISE PROVIDED FOR; APPLI

2025-01-27 01:52:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:52:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:52:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:52:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-27 01:52:05 - snowflake.connector.connection - INFO - closed
2025-01-27 01:52:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:52:41 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:52:41 - root - INFO - ```sql
SELECT c.value['symbol']::STRING AS "CPC_Symbol",
       COUNT(DISTINCT p."publication_number") AS "Publication_Count"
FROM PATENTS.PATENTS.PUBLICATIONS p,
LATERAL FLATTEN(input => p."cpc") c
WHERE c.value['symbol']::STRING IS NOT NULL AND c.value['symbol' ]::STRING <> ''
GROUP BY c.value['symbol']::STRING
ORDER BY "Publication_Count" DESC
LIMIT 100;
```
2025-01-27 01:52:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:52:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:52:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:52:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-27 01:52:42 - snowflake.connector.connection - INFO - closed
2025-01-27 01:52:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:53:23 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:53:23 - root - INFO - ```sql
SELECT c.value::STRING AS "IPC_Symbol",
       COUNT(DISTINCT p."publication_number") AS "Publication_Count"
FROM PATENTS.PATENTS.PUBLICATIONS p,
     LATERAL FLATTEN(input => p."ipc") c
GROUP BY c.value::STRING
ORDER BY "Publication_Count" DESC
LIMIT 100;
```
2025-01-27 01:53:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:53:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:53:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:53:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 01:53:25 - snowflake.connector.connection - INFO - closed
2025-01-27 01:53:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:55:07 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:55:07 - root - INFO - SQL:
SELECT c.value::STRING AS "IPC_Symbol",
       COUNT(DISTINCT p."publication_number") AS "Publication_Count"
FROM PATENTS.PATENTS.PUBLICATIONS p,
     LATERAL FLATTEN(input => p."ipc") c
GROUP BY c.value::STRING
ORDER BY "Publication_Count" DESC
LIMIT 100;
Results:
Too long, hard cut:
IPC_Symbol,Publication_Count
"{""code"":""A61P35/00"",""first"":false,""inventive"":true,""tree"":[]}",2604
"{""code"":""A61P43/00"",""first"":false,""inventive"":true,""tree"":[]}",1812
"{""code"":""F21Y115/10"",""first"":false,""inventive"":false,""tree"":[]}",1443
"{""code"":""A61P29/00"",""first"":false,""inventive"":true,""tree"":[]}",1423
"{""code"":""A63F7/02"",""first"":true,""inventive"":true,""tree"":[]}",1222
"{""code"":""H04L29/06"",""first"":false,""inventive"":true,""tree"":[]}",1148
"{""code"":""H04L29/08"",""first"":false,""inventive"":true,""tree"":[]}",1112
"{""code"":""H05K7/20"",""first"":false,""inventive"":true,""tree"":[]}",1083
"{""code"":""G06F17/30"",""first"":true,""inventive"":true,""tree"":[]}",1031
"{""code"":""C07C67/00"",""first"":false,""inventive"":true,""tree"":[]}",972
"{""code"":""A61P31/04"",""first"":false,""inventive"":true,""tree"":[]}",966
"{""code"":""G06F17/30"",""first"":false,""inventive"":true,""tree"":[]}",944
"{""code"":""A61P25/00"",""first"":false,""inventive"":true,""tree"":[]}",944
"{""code"":""F26B21/00"",""first"":false,""inventive"":true,""tree"":[]}",939
"{""code"":""A61K9/00"",""first"":false,""inventive"":true,""tree"":[]}",857
"{""code"":""A61Q19/00"",""first"":false,""inventive"":true,""tree"":[]}",854
"{""code"":""B08B13/00"",""first"":false,""inventive"":true,""tree"":[]}",845
"{""code"":""F21V33/00"",""first"":false,""inventive"":true,""tree"":[]}",842
"{""code"":""A61P9/10"",""first"":false,""inventive"":true,""tree"":[]}",804
"{""code"":""G06Q50/00"",""first"":false,""inventive"":true,""tree"":[]}",798
"{""code"":""H02J7/00"",""first"":false,""inventive"":true,""tree"":[]}",795
"{""code"":""C12N5/10"",""first"":false,""inventive"":true,""tree"":[]}",794
"{""code"":""A61B5/00"",""first"":false,""inventive"":true,""tree"":[]}",782
"{""code"":""H02J7/00"",""first"":true,""inventive"":true,""tree"":[]}",782
"{""code"":""G06N3/08"",""first"":false,""inventive"":true,""tree"":[]}",781
"{""code"":""A61P9/00"",""first"":false,""inventive"":true,""tree"":[]}",775
"{""code"":""C12Q1/68"",""first"":false,""inventive"":true,""tree"":[]}",773
"{""code"":""H04L29/06"",""first"":true,""inventive"":true,""tree"":[]}",769
"{""code"":""H04N5/225"",""first"":false,""inventive"":true,""tree"":[]}",717
"{""code"":""A61P3/10"",""first"":false,""inventive"":true,""tree"":[]}",716
"{""code"":""A61K39/395"",""first"":false,""inventive"":true,""tree"":[]}",715
"{""code"":""A61P25/28"",""first"":false,""inventive"":true,""tree"":[]}",713
"{""code"":""C07B61/00"",""first"":false,""inventive"":true,""tree"":[]}",713
"{""code"":""A61P17/00"",""first"":false,""inventive"":true,""tree"":[]}",712
"{""code"":""H04N7/18"",""first"":false,""inventive"":true,""tree"":[]}",710
"{""code"":""G06T1/00"",""first"":false,""inventive"":true,""tree"":[]}",706
"{""code"":""B24B41/06"",""first"":false,""inventive"":true,""tree"":[]}",694
"{""code"":""C12N15/09"",""first"":true,""inventive"":true,""tree"":[]}",685
"{""code"":""H05K7/20"",""first"":true,""inventive"":true,""tree"":[]}",677
"{""code"":""B32B33/00"",""first"":false,""inventive"":true,""tree"":[]}",676
"{""code"":""H01L21/027"",""first"":false,""inventive"":true,""tree"":[]}",673
"{""code"":""G03G15/00"",""first"":false,""inventive"":true,""tree"":[]}",671
"{""code"":""F21V23/00"",""first"":false,""inventive"":true,""tree"":[]}",668
"{""code"":""B07B1/46"",""first"":false,""inventive"":true,""tree"":[]}",652
"{""code"":""G06K9/62"",""first"":false,""inventive"":true,""tree"":[]}",651
"{""code"":""G06K9/00"",""first"":false,""inventive"":true,""tree"":[]}",633
"{""code"":""C12N15/09"",""first"":false,""inventive"":true,""tree"":[]}",633
"{""code"":""C12N1/21"",""first"":false,""inventive"":true,""tree"":[]}",632
"{""code"":""F21V19/00"",""first"":false,""inventive"":true,""tree"":[]}",627
"{""code"":""A61K38/00"",""first"":false,""inventive"":true,""tree"":[]}",618
"{""code"":""G06K9/00"",""first"":true,""inventive"":true,""tree"":[]}",615
"{""code"":""F26B25/00"",""first"":false,""inventive"":true,""tree"":[]}",611
"{""code"":""A61P11/00"",""first"":false,""inventive"":true,""tree"":[]}",611
"{""code"":""G06T7/00"",""first"":false,""inventive"":true,""tree"":[]}",610
"{""code"":""H01L21/336"",""first"":false,""inventive"":true,""tree"":[]}",606
"{""code"":""H05K5/02"",""first"":false,""inventive"":true,""tree"":[]}",603
"{""code"":""C08K3/22"",""first"":false,""inventive"":true,""tree"":[]}",602
"{""code"":""G06N3/04"",""first"":false,""inventive"":true,""tree"":[]}",601
"{""code"":""G02F1/1335"",""first"":false,""inventive"":true,""tree"":[]}",598
"{""code"":""G06F13/00"",""first"":false,""inventive"":true,""tree"":[]}",582
"{""code"":""H01L29/78"",""first"":false,""inventive"":true,""tree"":[]}",580
"{""code"":""H05K5/02"",""first"":true,""inventive"":true,""tree"":[]}",575
"{""code"":""G06Q30/06"",""first"":false,""inventive"":true,""tree"":[]}",574
"{""code"":""A61K45/00"",""first"":false,""inventive"":true,""tree"":[]}",5

2025-01-27 01:55:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:55:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:55:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:55:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 01:55:09 - snowflake.connector.connection - INFO - closed
2025-01-27 01:55:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:55:09 - root - INFO - SQL:
SELECT "symbol" AS "CPC_Symbol", "titleFull" AS "Full_Title", "level"
FROM PATENTS.PATENTS.CPC_DEFINITION
WHERE "symbol" IS NOT NULL AND "symbol" <> ''
LIMIT 100
Results:
Too long, hard cut:
CPC_Symbol,Full_Title,level
B,PERFORMING OPERATIONS; TRANSPORTING,2.0
H,ELECTRICITY,2.0
Y,GENERAL TAGGING OF NEW TECHNOLOGICAL DEVELOPMENTS; GENERAL TAGGING OF CROSS-SECTIONAL TECHNOLOGIES SPANNING OVER SEVERAL SECTIONS OF THE IPC; TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS,2.0
D,TEXTILES; PAPER,2.0
F,MECHANICAL ENGINEERING; LIGHTING; HEATING; WEAPONS; BLASTING,2.0
E,FIXED CONSTRUCTIONS,2.0
C,CHEMISTRY; METALLURGY,2.0
G,PHYSICS,2.0
A,HUMAN NECESSITIES,2.0
A45,HAND OR TRAVELLING ARTICLES,4.0
A24,TOBACCO; CIGARS; CIGARETTES; SIMULATED SMOKING DEVICES; SMOKERS' REQUISITES,4.0
A61,MEDICAL OR VETERINARY SCIENCE; HYGIENE,4.0
A63,SPORTS; GAMES; AMUSEMENTS,4.0
A22,BUTCHERING; MEAT TREATMENT; PROCESSING POULTRY OR FISH,4.0
A42,HEADWEAR,4.0
A99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION,4.0
A43,FOOTWEAR,4.0
A01,AGRICULTURE; FORESTRY; ANIMAL HUSBANDRY; HUNTING; TRAPPING; FISHING,4.0
A62,LIFE-SAVING; FIRE-FIGHTING,4.0
A23,"FOODS OR FOODSTUFFS; TREATMENT THEREOF, NOT COVERED BY OTHER CLASSES",4.0
A47,FURNITURE; DOMESTIC ARTICLES OR APPLIANCES; COFFEE MILLS; SPICE MILLS; SUCTION CLEANERS IN GENERAL,4.0
A46,BRUSHWARE,4.0
A44,HABERDASHERY; JEWELLERY,4.0
A21,BAKING; EDIBLE DOUGHS,4.0
A41,WEARING APPAREL,4.0
B27,WORKING OR PRESERVING WOOD OR SIMILAR MATERIAL; NAILING OR STAPLING MACHINES IN GENERAL,4.0
B68,SADDLERY; UPHOLSTERY,4.0
B04,CENTRIFUGAL APPARATUS OR MACHINES FOR CARRYING-OUT PHYSICAL OR CHEMICAL PROCESSES,4.0
B23,MACHINE TOOLS; METAL-WORKING NOT OTHERWISE PROVIDED FOR,4.0
B30,PRESSES,4.0
B21,MECHANICAL METAL-WORKING WITHOUT ESSENTIALLY REMOVING MATERIAL; PUNCHING METAL,4.0
B25,HAND TOOLS; PORTABLE POWER-DRIVEN TOOLS; MANIPULATORS,4.0
B99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION,4.0
B29,WORKING OF PLASTICS; WORKING OF SUBSTANCES IN A PLASTIC STATE IN GENERAL,4.0
B31,"MAKING ARTICLES OF PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER; WORKING PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER",4.0
B26,HAND CUTTING TOOLS; CUTTING; SEVERING,4.0
B66,HOISTING; LIFTING; HAULING,4.0
B02,"CRUSHING, PULVERISING, OR DISINTEGRATING; PREPARATORY TREATMENT OF GRAIN FOR MILLING",4.0
B65,CONVEYING; PACKING; STORING; HANDLING THIN OR FILAMENTARY MATERIAL,4.0
B61,RAILWAYS,4.0
B24,GRINDING; POLISHING,4.0
B06,GENERATING OR TRANSMITTING MECHANICAL VIBRATIONS IN GENERAL,4.0
B43,WRITING OR DRAWING IMPLEMENTS; BUREAU ACCESSORIES,4.0
B62,LAND VEHICLES FOR TRAVELLING OTHERWISE THAN ON RAILS,4.0
B64,AIRCRAFT; AVIATION; COSMONAUTICS,4.0
B22,CASTING; POWDER METALLURGY,4.0
B28,"WORKING CEMENT, CLAY, OR STONE",4.0
B09,DISPOSAL OF SOLID WASTE; RECLAMATION OF CONTAMINATED SOIL,4.0
B01,PHYSICAL OR CHEMICAL PROCESSES OR APPARATUS IN GENERAL,4.0
B63,SHIPS OR OTHER WATERBORNE VESSELS; RELATED EQUIPMENT,4.0
B60,VEHICLES IN GENERAL,4.0
B44,DECORATIVE ARTS,4.0
B07,SEPARATING SOLIDS FROM SOLIDS; SORTING,4.0
B08,CLEANING,4.0
B82,NANOTECHNOLOGY,4.0
B42,BOOKBINDING; ALBUMS; FILES; SPECIAL PRINTED MATTER,4.0
B32,LAYERED PRODUCTS,4.0
B81,MICROSTRUCTURAL TECHNOLOGY,4.0
B05,"SPRAYING OR ATOMISING IN GENERAL; APPLYING FLUENT MATERIALS TO SURFACES, IN GENERAL",4.0
B41,PRINTING; LINING MACHINES; TYPEWRITERS; STAMPS,4.0
B03,SEPARATION OF SOLID MATERIALS USING LIQUIDS OR USING PNEUMATIC TABLES OR JIGS; MAGNETIC OR ELECTROSTATIC SEPARATION OF SOLID MATERIALS FROM SOLID MATERIALS OR FLUIDS; SEPARATION BY HIGH-VOLTAGE ELECTRIC FIELDS,4.0
B67,"OPENING, CLOSING OR CLEANING BOTTLES, JARS OR SIMILAR CONTAINERS; LIQUID HANDLING",4.0
B33,ADDITIVE MANUFACTURING TECHNOLOGY,4.0
C22,METALLURGY; FERROUS OR NON-FERROUS ALLOYS; TREATMENT OF ALLOYS OR NON-FERROUS METALS,4.0
C23,"COATING METALLIC MATERIAL; COATING MATERIAL WITH METALLIC MATERIAL; CHEMICAL SURFACE TREATMENT; DIFFUSION TREATMENT OF METALLIC MATERIAL; COATING BY VACUUM EVAPORATION, BY SPUTTERING, BY ION IMPLANTATION OR BY CHEMICAL VAPOUR DEPOSITION, IN GENERAL; INHIBITING CORROSION OF METALLIC MATERIAL OR INCRUSTATION IN GENERAL",4.0
C06,EXPLOSIVES; MATCHES,4.0
C02,"TREATMENT OF WATER, WASTE WATER, SEWAGE, OR SLUDGE",4.0
C07,ORGANIC CHEMISTRY,4.0
C25,ELECTROLYTIC OR ELECTROPHORETIC PROCESSES; APPARATUS THEREFOR,4.0
C30,CRYSTAL GROWTH,4.0
C12,BIOCHEMISTRY; BEER; SPIRITS; WINE; VINEGAR; MICROBIOLOGY; ENZYMOLOGY; MUTATION OR GENETIC ENGINEERING,4.0
C99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION,4.0
C05,FERTILISERS; MANUFACTURE THEREOF,4.0
C40,COMBINATORIAL TECHNOLOGY,4.0
C11,"ANIMAL OR VEGETABLE OILS, FATS, FATTY SUBSTANCES OR WAXES; FATTY ACIDS THEREFROM; DETERGENTS; CANDLES",4.0
C08,ORGANIC MACROMOLECULAR COMPOUNDS; THEIR PREPARATION OR CHEMICAL WORKING-UP; COMPOSITIONS BASED THEREON,4.0
C10,"PETROLEUM, GAS OR COKE INDUSTRIES; TECHNICAL GASES CONTAINING CARBON MONOXIDE; FUELS; LUBRICANTS; PEAT",4.0
C21,METALLURGY OF IRON,4.0
C04,CEMENTS; CONCRETE; ARTIFICIAL STONE; CERAMICS; REFRACTORIES,4.0
C09,DYES; PAINTS; POLISHES; NATURAL RESINS; ADHESIVES; COMPOSITIONS NOT OTHERWISE PROVIDED FOR; APPLI

2025-01-27 01:55:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:55:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:55:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:55:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-27 01:55:10 - snowflake.connector.connection - INFO - closed
2025-01-27 01:55:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:55:42 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:55:42 - root - INFO - ```sql
SELECT p."publication_number", c.value::STRING AS "IPC_Symbol"
FROM PATENTS.PATENTS.PUBLICATIONS p,
     LATERAL FLATTEN(input => p."ipc") c
LIMIT 100;
```
2025-01-27 01:55:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:55:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:55:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:55:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 01:55:43 - snowflake.connector.connection - INFO - closed
2025-01-27 01:55:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:57:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:57:14 - root - INFO - SQL:
SELECT p."publication_number", c.value::STRING AS "IPC_Symbol"
FROM PATENTS.PATENTS.PUBLICATIONS p,
     LATERAL FLATTEN(input => p."ipc") c
LIMIT 100;
Results:
Too long, hard cut:
publication_number,IPC_Symbol
US-2015177816-A1,"{""code"":""G06F1/32"",""first"":true,""inventive"":true,""tree"":[]}"
US-2015177816-A1,"{""code"":""G06F13/364"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015177816-A1,"{""code"":""G06F1/26"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015180461-A1,"{""code"":""H03K17/687"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015180461-A1,"{""code"":""H03K17/08"",""first"":true,""inventive"":true,""tree"":[]}"
US-2015271362-A1,"{""code"":""H04N1/387"",""first"":true,""inventive"":true,""tree"":[]}"
US-2015271362-A1,"{""code"":""G06K15/02"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015314861-A1,"{""code"":""B64C25/26"",""first"":true,""inventive"":true,""tree"":[]}"
US-2015340518-A1,"{""code"":""C30B29/06"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015340518-A1,"{""code"":""C03C3/04"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015340518-A1,"{""code"":""H01L31/0224"",""first"":true,""inventive"":true,""tree"":[]}"
US-2015340518-A1,"{""code"":""H01L31/028"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015340518-A1,"{""code"":""H01L31/06"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015340518-A1,"{""code"":""C09D11/10"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015340518-A1,"{""code"":""C09D11/102"",""first"":false,""inventive"":true,""tree"":[]}"
US-2016275535-A1,"{""code"":""G06Q30/02"",""first"":true,""inventive"":true,""tree"":[]}"
US-2016285437-A1,"{""code"":""H03K3/037"",""first"":true,""inventive"":true,""tree"":[]}"
US-2016285437-A1,"{""code"":""G06F1/10"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""B41J2/045"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""C04B35/00"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""B41J2/14"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""B41J2/135"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""B41J2/055"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""B05C5/00"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""H10N30/853"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""H10N30/85"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""H10N30/50"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""H10N30/20"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""H10N30/093"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""H10N30/084"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""H10N30/01"",""first"":false,""inventive"":true,""tree"":[]}"
US-2016280116-A1,"{""code"":""B60P1/44"",""first"":true,""inventive"":true,""tree"":[]}"
US-2015205759-A1,"{""code"":""G06F17/11"",""first"":true,""inventive"":true,""tree"":[]}"
US-2016120347-A1,"{""code"":""B63B35/73"",""first"":false,""inventive"":true,""tree"":[]}"
US-2016120347-A1,"{""code"":""A47G23/02"",""first"":true,""inventive"":true,""tree"":[]}"
US-2015289441-A1,"{""code"":""A01C7/04"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015289441-A1,"{""code"":""A01C7/08"",""first"":true,""inventive"":true,""tree"":[]}"
US-2016335166-A1,"{""code"":""G06F11/20"",""first"":true,""inventive"":true,""tree"":[]}"
US-2016335166-A1,"{""code"":""G06F3/06"",""first"":false,""inventive"":true,""tree"":[]}"
US-2016345465-A1,"{""code"":""H05K7/20"",""first"":true,""inventive"":true,""tree"":[]}"
US-2016345465-A1,"{""code"":""B23P15/26"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015275041-A1,"{""code"":""B29C67/00"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015275041-A1,"{""code"":""C08J3/28"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015275041-A1,"{""code"":""C09D175/16"",""first"":true,""inventive"":true,""tree"":[]}"
US-2016364384-A1,"{""code"":""G06F40/00"",""first"":false,""inventive"":true,""tree"":[]}"
US-2016364384-A1,"{""code"":""G06F17/28"",""first"":true,""inventive"":true,""tree"":[]}"
US-2016364384-A1,"{""code"":""G06F17/27"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015287715-A1,"{""code"":""H01L23/64"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015287715-A1,"{""code"":""H01L29/78"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015287715-A1,"{""code"":""H01L23/50"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015287715-A1,"{""code"":""H01L27/06"",""first"":true,""inventive"":true,""tree"":[]}"
US-2015287715-A1,"{""code"":""H01L27/092"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015287715-A1,"{""code"":""H10N97/00"",""first"":false,""inventive"":true,""tree"":[]}"
US-2016380415-A1,"{""code"":""H02G1/04"",""first"":true,""inventive"":true,""tree"":[]}"
US-2016380415-A1,"{""code"":""B25B25/00"",""first"":false,""inventive"":tru

2025-01-27 01:57:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:57:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:57:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:57:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 01:57:15 - snowflake.connector.connection - INFO - closed
2025-01-27 01:57:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:57:15 - root - INFO - SQL:
SELECT c.value::STRING AS "IPC_Symbol",
       COUNT(p."publication_number") AS "Publication_Count"
FROM (
    SELECT *
    FROM PATENTS.PATENTS.PUBLICATIONS
    LIMIT 100
) p,
LATERAL FLATTEN(input => p."ipc") c
WHERE c.value::STRING IS NOT NULL AND c.value::STRING <> ''
GROUP BY c.value::STRING
ORDER BY "Publication_Count" DESC
LIMIT 100
Results:
Too long, hard cut:
IPC_Symbol,Publication_Count
"{""code"":""C07C67/00"",""first"":false,""inventive"":true,""tree"":[]}",3
"{""code"":""C07C239/00"",""first"":false,""inventive"":true,""tree"":[]}",2
"{""code"":""F16B12/20"",""first"":false,""inventive"":true,""tree"":[]}",2
"{""code"":""C07C231/00"",""first"":false,""inventive"":true,""tree"":[]}",2
"{""code"":""C07D521/00"",""first"":false,""inventive"":true,""tree"":[]}",2
"{""code"":""C09K15/30"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""E02D5/38"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""G21C5/10"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""E02D5/54"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""A01N47/36"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""G21C1/02"",""first"":true,""inventive"":true,""tree"":[]}",1
"{""code"":""A01N43/54"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C07C233/75"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C07D235/12"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C07D519/02"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""E02D5/80"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B21D25/00"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C07D213/56"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C07D213/32"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""E21B27/02"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C07C235/56"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B63B59/04"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""G11B15/62"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""G01N27/22"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C07D239/47"",""first"":true,""inventive"":true,""tree"":[]}",1
"{""code"":""C10M133/48"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C10C1/00"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B22D11/00"",""first"":true,""inventive"":true,""tree"":[]}",1
"{""code"":""A61K31/275"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B01D37/02"",""first"":false,""inventive"":false,""tree"":[]}",1
"{""code"":""E04D13/16"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C07J63/00"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C08K5/46"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C08K5/3447"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C07D213/22"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""E06B3/30"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""G05F3/24"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""H01L27/092"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""G04G19/06"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B65D17/00"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B41J2/18"",""first"":true,""inventive"":true,""tree"":[]}",1
"{""code"":""C11D/"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""A61K31/55"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""H03C3/06"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C07C237/40"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B29C49/30"",""first"":true,""inventive"":true,""tree"":[]}",1
"{""code"":""E21B17/01"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C07D499/12"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B63B35/44"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B01D25/26"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""E04B1/90"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""H01M50/529"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""H04B1/16"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""A61K31/585"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B22D11/08"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C11D1/66"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B65D17/34"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C07D471/22"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B65D85/34"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""F02M53/04"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B65D43/02"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B21D39/03"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B63H9/06"",""first"":true,""inventive"":true,""tree"":[]}",1
"{""code"":""F24S10/70"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""A61K31/58"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""E02D7/28"",""first"":f

2025-01-27 01:57:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:57:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:57:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:57:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 16
2025-01-27 01:57:17 - snowflake.connector.connection - INFO - closed
2025-01-27 01:57:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:57:17 - root - INFO - SQL:
SELECT "level", COUNT(*) AS "Count"
FROM PATENTS.PATENTS.CPC_DEFINITION
GROUP BY "level"
ORDER BY "level"
LIMIT 100
Results:
level,Count
2.0,9
4.0,137
5.0,677
7.0,9816
8.0,48384
9.0,70250
10.0,62585
11.0,35084
12.0,17632
13.0,8015
14.0,3649
15.0,1521
16.0,1223
17.0,720
18.0,485
19.0,621

2025-01-27 01:57:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:57:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:57:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:57:18 - snowflake.connector.connection - INFO - closed
2025-01-27 01:57:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:58:19 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:58:19 - root - INFO - ```sql
SELECT c.VALUE:"symbol"::STRING AS "CPC_Symbol",
       COUNT(p."publication_number") AS "Publication_Count"
FROM (
   SELECT *
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100
) p,
LATERAL FLATTEN(input => p."cpc") c
WHERE c.VALUE:"symbol" IS NOT NULL AND c.VALUE:"symbol"::STRING <> ''
GROUP BY c.VALUE:"symbol"::STRING
ORDER BY "Publication_Count" DESC
LIMIT 100;
```

---

```sql
SELECT "level", COUNT(*) AS "Count"
FROM PATENTS.PATENTS.CPC_DEFINITION
WHERE "level" IS NOT NULL
GROUP BY "level"
ORDER BY "level"
LIMIT 100;
```

---

```sql
SELECT c.VALUE:"symbol"::STRING AS "CPC_Symbol",
       COUNT(p."publication_number") AS "Publication_Count"
FROM (
   SELECT *
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100
) p,
LATERAL FLATTEN(input => p."cpc") c
JOIN PATENTS.PATENTS.CPC_DEFINITION d
  ON c.VALUE:"symbol"::STRING = d."symbol"
WHERE c.VALUE:"symbol" IS NOT NULL AND c.VALUE:"symbol"::STRING <> ''
GROUP BY c.VALUE:"symbol"::STRING
ORDER BY "Publication_Count" DESC
LIMIT 10;
```

---

```sql
SELECT "symbol" AS "CPC_Symbol", "parents"::STRING AS "Parent_Groups"
FROM PATENTS.PATENTS.CPC_DEFINITION
WHERE "symbol" IS NOT NULL AND "parents" IS NOT NULL
LIMIT 100;
```

---

```sql
SELECT DISTINCT c.VALUE:"symbol"::STRING AS "CPC_Symbol"
FROM (
   SELECT *
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100
) p,
LATERAL FLATTEN(input => p."cpc") c
LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION d
  ON c.VALUE:"symbol"::STRING = d."symbol"
WHERE c.VALUE:"symbol" IS NOT NULL AND c.VALUE:"symbol"::STRING <> '' AND d."symbol" IS NULL
LIMIT 100;
```

---

```sql
SELECT MIN(TRY_TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD')) AS "Earliest_Publication_Date",
       MAX(TRY_TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD')) AS "Latest_Publication_Date"
FROM PATENTS.PATENTS.PUBLICATIONS
WHERE TRY_TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL;
```

---

```sql
SELECT TO_VARCHAR(TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "Year",
       COUNT(p."publication_number") AS "Total_Publications"
FROM (
   SELECT *
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100
) p
WHERE TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
GROUP BY "Year"
ORDER BY "Year"
LIMIT 100;
```

---

```sql
SELECT p."publication_number", t.VALUE:"text"::STRING AS "Title",
       c.VALUE:"symbol"::STRING AS "CPC_Symbol"
FROM (
   SELECT *
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100
) p,
LATERAL FLATTEN(input => p."title_localized") t,
LATERAL FLATTEN(input => p."cpc") c
WHERE t.VALUE:"text" IS NOT NULL AND c.VALUE:"symbol" IS NOT NULL
LIMIT 100;
```

---

```sql
SELECT p."publication_number", COUNT(c.VALUE:"symbol") AS "CPC_Count"
FROM (
   SELECT *
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100
) p,
LATERAL FLATTEN(input => p."cpc") c
WHERE c.VALUE:"symbol" IS NOT NULL
GROUP BY p."publication_number"
ORDER BY "CPC_Count" DESC
LIMIT 100;
```

---

```sql
SELECT "symbol" AS "CPC_Symbol", "childGroups"::STRING AS "Child_Groups"
FROM PATENTS.PATENTS.CPC_DEFINITION
WHERE "symbol" IS NOT NULL AND "childGroups" IS NOT NULL
LIMIT 100;
```

---

```sql
SELECT c.VALUE:"symbol"::STRING AS "CPC_Symbol",
       TO_VARCHAR(TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "Year",
       COUNT(p."publication_number") AS "Publication_Count"
FROM (
   SELECT *
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100
) p,
LATERAL FLATTEN(input => p."cpc") c
WHERE c.VALUE:"symbol" IS NOT NULL AND c.VALUE:"symbol"::STRING <> ''
  AND TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
GROUP BY c.VALUE:"symbol"::STRING, "Year"
ORDER BY "CPC_Symbol", "Year"
LIMIT 100;
```
2025-01-27 01:58:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:58:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:58:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:58:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-27 01:58:20 - snowflake.connector.connection - INFO - closed
2025-01-27 01:58:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 01:59:18 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:59:18 - root - INFO - ```sql
SELECT c.VALUE::STRING AS "CPC_Symbol",
       COUNT(*) AS "Publication_Count"
FROM PATENTS.PATENTS.PUBLICATIONS p,
     LATERAL FLATTEN(input => p."cpc") c
GROUP BY c.VALUE::STRING
ORDER BY "Publication_Count" DESC
LIMIT 100;
```
2025-01-27 01:59:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 01:59:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 01:59:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 01:59:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 01:59:19 - snowflake.connector.connection - INFO - closed
2025-01-27 01:59:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 02:00:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 02:00:10 - root - INFO - SQL:
SELECT c.VALUE::STRING AS "CPC_Symbol",
       COUNT(*) AS "Publication_Count"
FROM PATENTS.PATENTS.PUBLICATIONS p,
     LATERAL FLATTEN(input => p."cpc") c
GROUP BY c.VALUE::STRING
ORDER BY "Publication_Count" DESC
LIMIT 100;
Results:
Too long, hard cut:
CPC_Symbol,Publication_Count
"{""code"":""Y02E60/10"",""first"":false,""inventive"":false,""tree"":[]}",5576
"{""code"":""A61P35/00"",""first"":false,""inventive"":true,""tree"":[]}",5308
"{""code"":""A61P43/00"",""first"":false,""inventive"":true,""tree"":[]}",3789
"{""code"":""A61K45/06"",""first"":false,""inventive"":true,""tree"":[]}",2696
"{""code"":""Y02P70/50"",""first"":false,""inventive"":false,""tree"":[]}",2621
"{""code"":""A61P29/00"",""first"":false,""inventive"":true,""tree"":[]}",2536
"{""code"":""A61K38/00"",""first"":false,""inventive"":false,""tree"":[]}",2221
"{""code"":""A61P25/00"",""first"":false,""inventive"":true,""tree"":[]}",2112
"{""code"":""A61K2039/505"",""first"":false,""inventive"":false,""tree"":[]}",1915
"{""code"":""Y02T10/12"",""first"":false,""inventive"":false,""tree"":[]}",1834
"{""code"":""Y02E10/50"",""first"":false,""inventive"":false,""tree"":[]}",1825
"{""code"":""A23V2002/00"",""first"":false,""inventive"":false,""tree"":[]}",1817
"{""code"":""Y02T10/70"",""first"":false,""inventive"":false,""tree"":[]}",1777
"{""code"":""H01L2924/0002"",""first"":false,""inventive"":false,""tree"":[]}",1714
"{""code"":""Y02E60/50"",""first"":false,""inventive"":false,""tree"":[]}",1668
"{""code"":""A61P25/28"",""first"":false,""inventive"":true,""tree"":[]}",1662
"{""code"":""Y02A50/30"",""first"":false,""inventive"":false,""tree"":[]}",1659
"{""code"":""Y02D30/70"",""first"":false,""inventive"":false,""tree"":[]}",1618
"{""code"":""A61P9/00"",""first"":false,""inventive"":true,""tree"":[]}",1587
"{""code"":""A61P9/10"",""first"":false,""inventive"":true,""tree"":[]}",1481
"{""code"":""A61P31/04"",""first"":false,""inventive"":true,""tree"":[]}",1459
"{""code"":""A61P3/10"",""first"":false,""inventive"":true,""tree"":[]}",1445
"{""code"":""H01L2224/48091"",""first"":false,""inventive"":false,""tree"":[]}",1339
"{""code"":""A61P11/00"",""first"":false,""inventive"":true,""tree"":[]}",1294
"{""code"":""A61P17/00"",""first"":false,""inventive"":true,""tree"":[]}",1281
"{""code"":""H01M10/0525"",""first"":false,""inventive"":true,""tree"":[]}",1205
"{""code"":""G06N3/08"",""first"":false,""inventive"":true,""tree"":[]}",1186
"{""code"":""A61P19/02"",""first"":false,""inventive"":true,""tree"":[]}",1170
"{""code"":""C07K2317/92"",""first"":false,""inventive"":false,""tree"":[]}",1147
"{""code"":""Y02D10/00"",""first"":false,""inventive"":false,""tree"":[]}",1128
"{""code"":""F21Y2115/10"",""first"":false,""inventive"":false,""tree"":[]}",1115
"{""code"":""Y02P10/20"",""first"":false,""inventive"":false,""tree"":[]}",1096
"{""code"":""C07K2317/76"",""first"":false,""inventive"":false,""tree"":[]}",1094
"{""code"":""Y02P70/10"",""first"":false,""inventive"":false,""tree"":[]}",1088
"{""code"":""A61Q19/00"",""first"":false,""inventive"":true,""tree"":[]}",1074
"{""code"":""H04N19/176"",""first"":false,""inventive"":true,""tree"":[]}",1064
"{""code"":""C07K2317/24"",""first"":false,""inventive"":false,""tree"":[]}",1061
"{""code"":""A61K9/0019"",""first"":false,""inventive"":true,""tree"":[]}",1043
"{""code"":""Y02T10/7072"",""first"":false,""inventive"":false,""tree"":[]}",1037
"{""code"":""G06N20/00"",""first"":false,""inventive"":true,""tree"":[]}",1035
"{""code"":""C07D401/14"",""first"":false,""inventive"":true,""tree"":[]}",1029
"{""code"":""A61P35/02"",""first"":false,""inventive"":true,""tree"":[]}",1023
"{""code"":""A61P1/04"",""first"":false,""inventive"":true,""tree"":[]}",1012
"{""code"":""A61P31/12"",""first"":false,""inventive"":true,""tree"":[]}",1006
"{""code"":""Y02T10/40"",""first"":false,""inventive"":false,""tree"":[]}",1000
"{""code"":""A61P27/02"",""first"":false,""inventive"":true,""tree"":[]}",990
"{""code"":""C07D401/12"",""first"":false,""inventive"":true,""tree"":[]}",985
"{""code"":""A61P37/00"",""first"":false,""inventive"":true,""tree"":[]}",973
"{""code"":""Y02E10/72"",""first"":false,""inventive"":false,""tree"":[]}",972
"{""code"":""Y02E30/30"",""first"":false,""inventive"":false,""tree"":[]}",953
"{""code"":""A61P1/00"",""first"":false,""inventive"":true,""tree"":[]}",945
"{""code"":""C07D471/04"",""first"":false,""inventive"":true,""tree"":[]}",944
"{""code"":""A61P31/00"",""first"":false,""inventive"":true,""tree"":[]}",887
"{""code"":""A61P37/06"",""first"":false,""inventive"":true,""tree"":[]}",885
"{""code"":""A61P37/02"",""first"":false,""inventive"":true,""tree"":[]}",877
"{""code"":""A61P13/12"",""first"":false,""inventive"":true,""tree"":[]}",876
"{""code"":""A61P1/16"",""first"":false,""inventive"":true,""tree"":[]}",872
"{""code"":""C07K2319/00"",""first"":false,""inventive"":false,""tree"":[]}",857
"{""code"":""G06N3/045"",""first"":false,""inventive"":true,""tree"":[]}",857
"{""code"":""H01M2220/20"",""first"":false,""inventive"":false,""tree"":[]}",848
"{""code"":""B32B7/12"",""first"":false,""inventive"":true,""tree"":[]}",835
"{""code"":""C07D487/04"",""first"":false,""inventive"":true,""tree"":[]}",828
"{""code"":""B32B27/08"",""first"":f

2025-01-27 02:00:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 02:00:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 02:00:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 02:00:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 02:00:12 - snowflake.connector.connection - INFO - closed
2025-01-27 02:00:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 02:00:12 - root - INFO - SQL:
SELECT "symbol" AS "CPC_Symbol", CAST("parents" AS STRING) AS "Parent_Groups"
FROM PATENTS.PATENTS.CPC_DEFINITION
LIMIT 100
Results:
CPC_Symbol,Parent_Groups
B,[]
H,[]
Y,[]
D,[]
F,[]
E,[]
C,[]
G,[]
A,[]
A45,"[""A""]"
A24,"[""A""]"
A61,"[""A""]"
A63,"[""A""]"
A22,"[""A""]"
A42,"[""A""]"
A99,"[""A""]"
A43,"[""A""]"
A01,"[""A""]"
A62,"[""A""]"
A23,"[""A""]"
A47,"[""A""]"
A46,"[""A""]"
A44,"[""A""]"
A21,"[""A""]"
A41,"[""A""]"
B27,"[""B""]"
B68,"[""B""]"
B04,"[""B""]"
B23,"[""B""]"
B30,"[""B""]"
B21,"[""B""]"
B25,"[""B""]"
B99,"[""B""]"
B29,"[""B""]"
B31,"[""B""]"
B26,"[""B""]"
B66,"[""B""]"
B02,"[""B""]"
B65,"[""B""]"
B61,"[""B""]"
B24,"[""B""]"
B06,"[""B""]"
B43,"[""B""]"
B62,"[""B""]"
B64,"[""B""]"
B22,"[""B""]"
B28,"[""B""]"
B09,"[""B""]"
B01,"[""B""]"
B63,"[""B""]"
B60,"[""B""]"
B44,"[""B""]"
B07,"[""B""]"
B08,"[""B""]"
B82,"[""B""]"
B42,"[""B""]"
B32,"[""B""]"
B81,"[""B""]"
B05,"[""B""]"
B41,"[""B""]"
B03,"[""B""]"
B67,"[""B""]"
B33,"[""B""]"
C22,"[""C""]"
C23,"[""C""]"
C06,"[""C""]"
C02,"[""C""]"
C07,"[""C""]"
C25,"[""C""]"
C30,"[""C""]"
C12,"[""C""]"
C99,"[""C""]"
C05,"[""C""]"
C40,"[""C""]"
C11,"[""C""]"
C08,"[""C""]"
C10,"[""C""]"
C21,"[""C""]"
C04,"[""C""]"
C09,"[""C""]"
C03,"[""C""]"
C13,"[""C""]"
C14,"[""C""]"
C01,"[""C""]"
D02,"[""D""]"
D21,"[""D""]"
D04,"[""D""]"
D07,"[""D""]"
D01,"[""D""]"
D10,"[""D""]"
D99,"[""D""]"
D06,"[""D""]"
D03,"[""D""]"
D05,"[""D""]"
E05,"[""E""]"
E21,"[""E""]"
E04,"[""E""]"
E99,"[""E""]"
E06,"[""E""]"
E02,"[""E""]"

2025-01-27 02:00:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 02:00:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 02:00:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 02:00:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 02:00:14 - snowflake.connector.connection - INFO - closed
2025-01-27 02:00:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 02:00:14 - root - INFO - SQL:
SELECT DISTINCT c.VALUE::STRING AS "IPC_Symbol"
FROM (
    SELECT *
    FROM PATENTS.PATENTS.PUBLICATIONS
    LIMIT 100
) p,
LATERAL FLATTEN(input => p."ipc") c
LIMIT 100
Results:
Too long, hard cut:
IPC_Symbol
"{""code"":""G01N21/01"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C10C1/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H02M5/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A01N43/54"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A01N47/36"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07D239/47"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A01K61/00"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A01K63/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""E21B27/02"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07D471/16"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C03C4/12"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C08K5/47"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C10M133/44"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C10M133/48"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C08K5/35"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C11B5/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C10L1/14"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C10M135/36"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C09K15/30"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C08K5/3447"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""E02D5/80"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""E02D7/28"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""E02D7/26"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07D213/56"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07D213/22"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C12H1/14"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G11B15/22"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G11B15/62"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B21D25/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B29C41/14"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H04H20/88"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""H03D3/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G05F3/24"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01L27/088"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G04G19/06"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B65D51/22"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B65D41/32"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""D01H4/32"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B21D39/03"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B41J2/18"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""F24S10/70"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07J63/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07C67/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07C231/12"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G03F7/032"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""C07D213/51"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G11B23/093"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C08G59/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B21D37/14"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B65D17/34"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B41J2/175"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C06B21/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07D233/61"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""C07C231/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07C317/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07D499/04"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""F25D25/02"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""F24S90/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""F25J3/02"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07C233/64"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07J19/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B64C1/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A47J27/16"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B23D23/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07D521/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G21C1/02"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""C07D471/22"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G01N27/22"",""first"":fa

2025-01-27 02:00:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 02:00:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 02:00:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 02:00:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-27 02:00:16 - snowflake.connector.connection - INFO - closed
2025-01-27 02:00:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 02:00:16 - root - INFO - SQL:
SELECT MIN(TRY_TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD')) AS "Earliest_Publication_Date",
       MAX(TRY_TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD')) AS "Latest_Publication_Date"
FROM PATENTS.PATENTS.PUBLICATIONS
WHERE TRY_TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
Results:
Earliest_Publication_Date,Latest_Publication_Date
1837-07-31,2024-09-05

2025-01-27 02:00:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 02:00:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 02:00:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 02:00:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 02:00:17 - snowflake.connector.connection - INFO - closed
2025-01-27 02:00:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 02:00:18 - root - INFO - SQL:
SELECT TO_VARCHAR(TRY_TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "Year",
       COUNT("publication_number") AS "Total_Publications"
FROM PATENTS.PATENTS.PUBLICATIONS
WHERE TRY_TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
GROUP BY "Year"
ORDER BY "Year"
LIMIT 100
Results:
Year,Total_Publications
1837,2
1839,2
1841,4
1842,5
1843,2
1844,3
1845,1
1846,2
1847,3
1848,2
1849,1
1850,2
1851,1
1852,1
1853,4
1854,3
1855,4
1856,6
1857,3
1858,16
1859,15
1860,13
1861,12
1862,7
1863,12
1864,11
1865,12
1866,26
1867,18
1868,17
1869,25
1870,35
1871,34
1872,28
1873,27
1874,30
1875,26
1876,33
1877,33
1878,54
1879,72
1880,57
1881,76
1882,112
1883,101
1884,99
1885,103
1886,100
1887,96
1888,102
1889,112
1890,111
1891,100
1892,125
1893,93
1894,100
1895,97
1896,84
1897,102
1898,81
1899,84
1900,162
1901,86
1902,94
1903,133
1904,135
1905,112
1906,149
1907,203
1908,192
1909,169
1910,133
1911,137
1912,189
1913,279
1914,351
1915,220
1916,163
1917,147
1918,142
1919,160
1920,183
1921,189
1922,235
1923,231
1924,216
1925,252
1926,235
1927,244
1928,243
1929,259
1930,335
1931,319
1932,335
1933,259
1934,265
1935,296
1936,351
1937,322
1938,334

2025-01-27 02:00:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 02:00:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 02:00:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 02:00:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 02:00:19 - snowflake.connector.connection - INFO - closed
2025-01-27 02:00:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 02:00:20 - root - INFO - SQL:
SELECT p."publication_number", t.VALUE['text']::STRING AS "Title",
       c.VALUE::STRING AS "IPC_Symbol"
FROM (
    SELECT *
    FROM PATENTS.PATENTS.PUBLICATIONS
    LIMIT 100
) p,
LATERAL FLATTEN(input => p."title_localized") t,
LATERAL FLATTEN(input => p."ipc") c
WHERE t.VALUE['text'] IS NOT NULL AND c.VALUE IS NOT NULL
LIMIT 100
Results:
Too long, hard cut:
publication_number,Title,IPC_Symbol
CR-5634-A,Procedimiento para el analisis de aflatoxinas por cromatografia directa,"{""code"":""G01N21/01"",""first"":false,""inventive"":true,""tree"":[]}"
FI-429-A,Förbättringar af tjärbränningsugnar med rörledning för trädestillation,"{""code"":""C10C1/00"",""first"":false,""inventive"":true,""tree"":[]}"
HK-6083-A,A new or improved alternating current control device,"{""code"":""H02M5/00"",""first"":false,""inventive"":true,""tree"":[]}"
HU-T52763-A,Herbicide and growth-controlling compositions containing sulfonyl-urea derivatives as active components and process for producing the active components,"{""code"":""A01N43/54"",""first"":false,""inventive"":true,""tree"":[]}"
HU-T52763-A,Herbicide and growth-controlling compositions containing sulfonyl-urea derivatives as active components and process for producing the active components,"{""code"":""A01N47/36"",""first"":false,""inventive"":true,""tree"":[]}"
HU-T52763-A,Herbicide and growth-controlling compositions containing sulfonyl-urea derivatives as active components and process for producing the active components,"{""code"":""C07D239/47"",""first"":true,""inventive"":true,""tree"":[]}"
HU-T52763-A,Herbicide and growth-controlling compositions containing sulfonyl-urea derivatives as active components and process for producing the active components,"{""code"":""C07D521/00"",""first"":false,""inventive"":true,""tree"":[]}"
JP-H03206829-A,Artificial algal fish bank for fishery,"{""code"":""A01K61/00"",""first"":true,""inventive"":true,""tree"":[]}"
JP-H03206829-A,Artificial algal fish bank for fishery,"{""code"":""A01K63/00"",""first"":false,""inventive"":true,""tree"":[]}"
JP-H03206829-A,人工漁業藻礁,"{""code"":""A01K61/00"",""first"":true,""inventive"":true,""tree"":[]}"
JP-H03206829-A,人工漁業藻礁,"{""code"":""A01K63/00"",""first"":false,""inventive"":true,""tree"":[]}"
JP-S62159089-A,Core support mechanism for tank type fast breeder reactor,"{""code"":""G21C5/10"",""first"":false,""inventive"":true,""tree"":[]}"
JP-S62159089-A,Core support mechanism for tank type fast breeder reactor,"{""code"":""G21C1/02"",""first"":true,""inventive"":true,""tree"":[]}"
JP-S62159089-A,タンク型高速増殖炉用炉心支持機構,"{""code"":""G21C5/10"",""first"":false,""inventive"":true,""tree"":[]}"
JP-S62159089-A,タンク型高速増殖炉用炉心支持機構,"{""code"":""G21C1/02"",""first"":true,""inventive"":true,""tree"":[]}"
US-2528225-A,Well clay dumper,"{""code"":""E21B27/02"",""first"":false,""inventive"":true,""tree"":[]}"
AT-A41580-A,Verfahren zum vollkontinuierlichen strang- giessen schmelzfluessiger metalle,"{""code"":""B22D11/08"",""first"":false,""inventive"":true,""tree"":[]}"
AT-A47682-A,"Verfahren zur herstellung von neuen 2, 4, 8-triazaphenalenium-salzen sowie von deren geometrischen und optischen isomeren","{""code"":""C07D471/22"",""first"":false,""inventive"":true,""tree"":[]}"
AT-A47682-A,"Verfahren zur herstellung von neuen 2, 4, 8-triazaphenalenium-salzen sowie von deren geometrischen und optischen isomeren","{""code"":""C07D471/16"",""first"":false,""inventive"":true,""tree"":[]}"
AT-A63682-A,"Verfahren zur bestimmung des strukturellen aufbaus von medien, die sich aus strukturelementen zusammensetzen","{""code"":""G01N27/22"",""first"":false,""inventive"":true,""tree"":[]}"
CA-920790-A,Photoluminescent glass and method of making the same,"{""code"":""C03C4/12"",""first"":false,""inventive"":true,""tree"":[]}"
CA-950907-A,"Azole compounds, processes for their manufacture and their use","{""code"":""C08K5/47"",""first"":false,""inventive"":true,""tree"":[]}"
CA-950907-A,"Azole compounds, processes for their manufacture and their use","{""code"":""C10M133/44"",""first"":false,""inventive"":true,""tree"":[]}"
CA-950907-A,"Azole compounds, processes for their manufacture and their use","{""code"":""C07D263/56"",""first"":false,""inventive"":true,""tree"":[]}"
CA-950907-A,"Azole compounds, processes for their manufacture and their use","{""code"":""C07D277/64"",""first"":false,""inventive"":true,""tree"":[]}"
CA-950907-A,"Azole compounds, processes for their manufacture and their use","{""code"":""C08K5/46"",""first"":false,""inventive"":true,""tree"":[]}"
CA-950907-A,"Azole compounds, processes for their manufacture and their use","{""code"":""C10M133/48"",""first"":false,""inventive"":true,""tree"":[]}"
CA-950907-A,"Azole compounds, processes for their manufacture and their use","{""code"":""C08K5/35"",""first"":false,""inventive"":true,""tree"":[]}"
CA-950907-A,"Azole compounds, processes for their manufacture and their use","{""code"":""C11B5/00"",""first"":false,""inventive"":true,""tree"":[]}"
CA-950907-A,"Azole compounds, processes for their manufacture and their use","{""code"":""C10L1/14"",""first"":false,""inventive"":true,""tree"":[]}"
CA-950907-A,"Azole compounds, processes for their manufacture and their use","{""code"":""C10M135/36"",""first"":false,""inventive"":true,""tree"":[]}"
CA-950907-A,"Azole compounds, processes for their manufacture and their use","{""code"

2025-01-27 02:00:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 02:00:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 02:00:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 02:00:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 87
2025-01-27 02:00:21 - snowflake.connector.connection - INFO - closed
2025-01-27 02:00:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 02:00:21 - root - INFO - SQL:
SELECT p."publication_number", COUNT(c.VALUE) AS "IPC_Count"
FROM (
    SELECT *
    FROM PATENTS.PATENTS.PUBLICATIONS
    LIMIT 100
) p,
LATERAL FLATTEN(input => p."ipc") c
GROUP BY p."publication_number"
ORDER BY "IPC_Count" DESC
LIMIT 100
Results:
publication_number,IPC_Count
PH-23905-A,27
BE-868080-A,19
BE-823416-A,15
CA-950907-A,13
PH-17928-A,11
BE-804534-A,8
YU-94082-A,8
BE-833811-A,8
HK-52284-A,7
BE-869056-A,7
CH-540255-A,6
AT-A134275-A,6
BE-873394-A,6
HK-55992-A,5
AT-A404675-A,5
US-4234270-A,5
BE-866723-A,5
CA-920830-A,5
BE-877768-A,4
HU-T52763-A,4
TR-26506-A,4
HK-39487-A,4
FR-1474468-A,4
BE-837857-A,3
AT-A179178-A,3
BE-885287-A,3
BE-853553-A,3
BE-857395-A,3
BE-509322-A,3
AT-A205780-A,3
AT-A876472-A,3
HK-60178-A,3
PH-15213-A,3
BE-806687-A,3
BE-848755-A,3
OA-08399-A,3
JP-H06198910-A,3
JP-S62159089-A,2
AT-A47682-A,2
AT-A735378-A,2
AT-A482077-A,2
BE-861199-A,2
BE-868938-A,2
AT-A272073-A,2
YU-53588-A,2
OA-07542-A,2
JP-H03206829-A,2
MA-42286-A,2
GB-307790-A,2
AT-A906278-A,2
FR-1478988-A,2
HK-82486-A,2
HU-T58725-A,2
BE-813367-A,2
AT-A269985-A,1
BE-840231-A,1
JP-S62157892-A,1
AT-A519575-A,1
AT-A312885-A,1
FR-1485992-A,1
GB-873984-A,1
US-2528225-A,1
AT-A196182-A,1
PH-11723-A,1
FI-429-A,1
AT-A160683-A,1
CA-920790-A,1
BE-837312-A,1
FR-1444995-A,1
AT-A710279-A,1
AT-A41580-A,1
HK-6083-A,1
FR-1508237-A,1
AT-A245590-A,1
BE-871421-A,1
AT-A63682-A,1
BE-852837-A,1
GB-893001-A,1
BE-825816-A,1
AT-A250686-A,1
CR-5634-A,1
GB-534192-A,1
AT-A168281-A,1
FR-1487706-A,1
FR-1334211-A,1
YU-24971-A,1
AT-A202882-A,1

2025-01-27 02:00:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 02:00:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 02:00:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 02:00:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 02:00:23 - snowflake.connector.connection - INFO - closed
2025-01-27 02:00:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 02:00:23 - root - INFO - SQL:
SELECT "symbol" AS "CPC_Symbol", CAST("childGroups" AS STRING) AS "Child_Groups"
FROM PATENTS.PATENTS.CPC_DEFINITION
LIMIT 100
Results:
CPC_Symbol,Child_Groups
B,"[{""description"":""SEPARATING; MIXING"",""symbols"":[""B01"",""B02"",""B03"",""B04"",""B05"",""B06"",""B07"",""B08"",""B09""]},{""description"":""SHAPING"",""symbols"":[""B21"",""B22"",""B23"",""B24"",""B25"",""B26"",""B27"",""B28"",""B29"",""B30"",""B31"",""B32"",""B33""]},{""description"":""PRINTING"",""symbols"":[""B41"",""B42"",""B43"",""B44""]},{""description"":""TRANSPORTING"",""symbols"":[""B60"",""B61"",""B62"",""B63"",""B64"",""B65"",""B66"",""B67"",""B68""]},{""description"":""MICROSTRUCTURAL TECHNOLOGY; NANOTECHNOLOGY"",""symbols"":[""B81"",""B82""]},{""description"":"""",""symbols"":[""B99""]}]"
H,"[{""description"":"""",""symbols"":[""H01"",""H02"",""H03"",""H04"",""H05"",""H10"",""H99""]}]"
Y,"[{""description"":"""",""symbols"":[""Y02"",""Y04"",""Y10""]}]"
D,"[{""description"":""TEXTILES OR FLEXIBLE MATERIALS NOT OTHERWISE PROVIDED FOR"",""symbols"":[""D01"",""D02"",""D03"",""D04"",""D05"",""D06"",""D07"",""D10""]},{""description"":""PAPER"",""symbols"":[""D21""]},{""description"":"""",""symbols"":[""D99""]}]"
F,"[{""description"":""ENGINES OR PUMPS"",""symbols"":[""F01"",""F02"",""F03"",""F04"",""F05""]},{""description"":""ENGINEERING IN GENERAL"",""symbols"":[""F15"",""F16"",""F17""]},{""description"":""LIGHTING; HEATING"",""symbols"":[""F21"",""F22"",""F23"",""F24"",""F25"",""F26"",""F27"",""F28""]},{""description"":""WEAPONS; BLASTING"",""symbols"":[""F41"",""F42""]},{""description"":"""",""symbols"":[""F99""]}]"
E,"[{""description"":""BUILDING"",""symbols"":[""E01"",""E02"",""E03"",""E04"",""E05"",""E06""]},{""description"":""EARTH DRILLING; MINING"",""symbols"":[""E21""]},{""description"":"""",""symbols"":[""E99""]}]"
C,"[{""description"":""CHEMISTRY"",""symbols"":[""C01"",""C02"",""C03"",""C04"",""C05"",""C06"",""C07"",""C08"",""C09"",""C10"",""C11"",""C12"",""C13"",""C14""]},{""description"":""METALLURGY"",""symbols"":[""C21"",""C22"",""C23"",""C25"",""C30""]},{""description"":""COMBINATORIAL TECHNOLOGY"",""symbols"":[""C40""]},{""description"":"""",""symbols"":[""C99""]}]"
G,"[{""description"":""INSTRUMENTS"",""symbols"":[""G01"",""G02"",""G03"",""G04"",""G05"",""G06"",""G07"",""G08"",""G09"",""G10"",""G11"",""G12""]},{""description"":"""",""symbols"":[""G16""]},{""description"":""NUCLEONICS"",""symbols"":[""G21""]},{""description"":"""",""symbols"":[""G99""]}]"
A,"[{""description"":""AGRICULTURE"",""symbols"":[""A01""]},{""description"":""FOODSTUFFS; TOBACCO"",""symbols"":[""A21"",""A22"",""A23"",""A24""]},{""description"":""PERSONAL OR DOMESTIC ARTICLES"",""symbols"":[""A41"",""A42"",""A43"",""A44"",""A45"",""A46"",""A47""]},{""description"":""HEALTH; AMUSEMENT"",""symbols"":[""A61"",""A62"",""A63""]},{""description"":"""",""symbols"":[""A99""]}]"
A45,[]
A24,[]
A61,[]
A63,[]
A22,[]
A42,[]
A99,[]
A43,[]
A01,[]
A62,[]
A23,[]
A47,[]
A46,[]
A44,[]
A21,[]
A41,[]
B27,[]
B68,[]
B04,[]
B23,[]
B30,[]
B21,[]
B25,[]
B99,[]
B29,[]
B31,[]
B26,[]
B66,[]
B02,[]
B65,[]
B61,[]
B24,[]
B06,[]
B43,[]
B62,[]
B64,[]
B22,[]
B28,[]
B09,[]
B01,[]
B63,[]
B60,[]
B44,[]
B07,[]
B08,[]
B82,[]
B42,[]
B32,[]
B81,[]
B05,[]
B41,[]
B03,[]
B67,[]
B33,[]
C22,[]
C23,[]
C06,[]
C02,[]
C07,[]
C25,[]
C30,[]
C12,[]
C99,[]
C05,[]
C40,[]
C11,[]
C08,[]
C10,[]
C21,[]
C04,[]
C09,[]
C03,[]
C13,[]
C14,[]
C01,[]
D02,[]
D21,[]
D04,[]
D07,[]
D01,[]
D10,[]
D99,[]
D06,[]
D03,[]
D05,[]
E05,[]
E21,[]
E04,[]
E99,[]
E06,[]
E02,[]

2025-01-27 02:00:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 02:00:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 02:00:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 02:00:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 02:00:24 - snowflake.connector.connection - INFO - closed
2025-01-27 02:00:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 02:00:25 - root - INFO - SQL:
SELECT c.VALUE::STRING AS "IPC_Symbol",
       TO_VARCHAR(TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "Year",
       COUNT(p."publication_number") AS "Publication_Count"
FROM (
    SELECT *
    FROM PATENTS.PATENTS.PUBLICATIONS
    LIMIT 100
) p,
LATERAL FLATTEN(input => p."ipc") c
WHERE c.VALUE::STRING IS NOT NULL AND c.VALUE::STRING <> ''
  AND TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
GROUP BY c.VALUE::STRING, "Year"
ORDER BY "IPC_Symbol", "Year"
LIMIT 100
Results:
Too long, hard cut:
IPC_Symbol,Year,Publication_Count
"{""code"":""A01G9/02"",""first"":false,""inventive"":true,""tree"":[]}",1979,1
"{""code"":""A01K61/00"",""first"":true,""inventive"":true,""tree"":[]}",1991,1
"{""code"":""A01K63/00"",""first"":false,""inventive"":true,""tree"":[]}",1991,1
"{""code"":""A01N43/54"",""first"":false,""inventive"":true,""tree"":[]}",1990,1
"{""code"":""A01N43/90"",""first"":true,""inventive"":true,""tree"":[]}",1992,1
"{""code"":""A01N47/36"",""first"":false,""inventive"":true,""tree"":[]}",1990,1
"{""code"":""A23L3/00"",""first"":false,""inventive"":true,""tree"":[]}",1976,1
"{""code"":""A23L3/10"",""first"":false,""inventive"":true,""tree"":[]}",1976,1
"{""code"":""A43B23/08"",""first"":false,""inventive"":true,""tree"":[]}",1979,1
"{""code"":""A43B5/00"",""first"":false,""inventive"":true,""tree"":[]}",1979,1
"{""code"":""A47B31/02"",""first"":false,""inventive"":true,""tree"":[]}",1976,1
"{""code"":""A47B73/00"",""first"":false,""inventive"":true,""tree"":[]}",1979,1
"{""code"":""A47B87/02"",""first"":false,""inventive"":true,""tree"":[]}",1979,1
"{""code"":""A47B88/00"",""first"":false,""inventive"":true,""tree"":[]}",1988,1
"{""code"":""A47J27/16"",""first"":false,""inventive"":true,""tree"":[]}",1976,1
"{""code"":""A47J39/00"",""first"":false,""inventive"":true,""tree"":[]}",1976,1
"{""code"":""A47J39/02"",""first"":false,""inventive"":true,""tree"":[]}",1976,1
"{""code"":""A61K31/165"",""first"":false,""inventive"":true,""tree"":[]}",1989,1
"{""code"":""A61K31/275"",""first"":false,""inventive"":true,""tree"":[]}",1989,1
"{""code"":""A61K31/357"",""first"":false,""inventive"":true,""tree"":[]}",1985,1
"{""code"":""A61K31/36"",""first"":false,""inventive"":true,""tree"":[]}",1985,1
"{""code"":""A61K31/40"",""first"":false,""inventive"":true,""tree"":[]}",1985,1
"{""code"":""A61K31/415"",""first"":false,""inventive"":true,""tree"":[]}",1989,1
"{""code"":""A61K31/43"",""first"":false,""inventive"":true,""tree"":[]}",1982,1
"{""code"":""A61K31/443"",""first"":false,""inventive"":true,""tree"":[]}",1985,1
"{""code"":""A61K31/445"",""first"":false,""inventive"":true,""tree"":[]}",1985,1
"{""code"":""A61K31/495"",""first"":false,""inventive"":true,""tree"":[]}",1985,1
"{""code"":""A61K31/535"",""first"":false,""inventive"":true,""tree"":[]}",1985,1
"{""code"":""A61K31/55"",""first"":false,""inventive"":true,""tree"":[]}",1985,1
"{""code"":""A61K31/58"",""first"":false,""inventive"":true,""tree"":[]}",1985,1
"{""code"":""A61K31/585"",""first"":false,""inventive"":true,""tree"":[]}",1989,1
"{""code"":""A61P25/04"",""first"":false,""inventive"":true,""tree"":[]}",1985,1
"{""code"":""A61P25/08"",""first"":false,""inventive"":true,""tree"":[]}",1989,1
"{""code"":""A61P31/04"",""first"":false,""inventive"":true,""tree"":[]}",1982,1
"{""code"":""A63B29/02"",""first"":false,""inventive"":true,""tree"":[]}",1992,1
"{""code"":""A63B47/00"",""first"":false,""inventive"":true,""tree"":[]}",1988,1
"{""code"":""A63G21/18"",""first"":false,""inventive"":true,""tree"":[]}",1986,1
"{""code"":""B01D25/12"",""first"":false,""inventive"":true,""tree"":[]}",1981,1
"{""code"":""B01D25/26"",""first"":false,""inventive"":true,""tree"":[]}",1981,1
"{""code"":""B01D37/02"",""first"":false,""inventive"":false,""tree"":[]}",1981,1
"{""code"":""B01J23/00"",""first"":false,""inventive"":true,""tree"":[]}",1978,1
"{""code"":""B06B1/04"",""first"":false,""inventive"":true,""tree"":[]}",1978,1
"{""code"":""B21D25/00"",""first"":false,""inventive"":true,""tree"":[]}",1962,1
"{""code"":""B21D37/14"",""first"":false,""inventive"":true,""tree"":[]}",1961,1
"{""code"":""B21D39/03"",""first"":false,""inventive"":true,""tree"":[]}",1986,1
"{""code"":""B21J1/06"",""first"":false,""inventive"":true,""tree"":[]}",1980,1
"{""code"":""B21J13/08"",""first"":false,""inventive"":true,""tree"":[]}",1980,1
"{""code"":""B21J15/00"",""first"":false,""inventive"":true,""tree"":[]}",1986,1
"{""code"":""B22D11/00"",""first"":true,""inventive"":true,""tree"":[]}",1976,1
"{""code"":""B22D11/08"",""first"":false,""inventive"":true,""tree"":[]}",1981,1
"{""code"":""B22D11/16"",""first"":false,""inventive"":true,""tree"":[]}",1976,1
"{""code"":""B22D11/22"",""first"":false,""inventive"":true,""tree"":[]}",1976,1
"{""code"":""B22D41/08"",""first"":true,""inventive"":true,""tree"":[]}",1976,1
"{""code"":""B22D41/38"",""first"":false,""inventive"":true,""tree"":[]}",1976,1
"{""code"":""B23D15/02"",""first"":true,""inventive"":true,""tree"":[]}",1977,1
"{""code"":""B23D23/00"",""first"":false,""inventive"":true,""tree"":[]}",1977,1
"{""code"":""B23D35/00"",""first"":false,""inventive"":true,""tree"":[]}",1977,1
"{""code"":""B23Q3/10"",""first"":false,""inventive"":true,""tree"":[]}",1975,1
"{""code"":""B27D1/08"",""first"":false,""inventive"":true,""tree"":[]}",1977,1
"{""code"":""B29C41/14"",""first"":false,""inventive"":true,""tree"":[]}",1930,1
"{""code"":""B29C49/30"",""first"":true,""inventive"":true,""tree"":[]}",1995,1
"{""code"":""B29C49/38"",""fi

2025-01-27 02:00:25 - root - INFO - itercount: 0
2025-01-27 02:00:25 - root - INFO - Database Name: PATENTS
Schema Name: PATENTS
DDL describes table information.
,0
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,1
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""spif_publication_number"" VARCHAR(16777216),
	""spif_application_number"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""claims_localized_html"" VARIANT,
	""description_localized"" VARIANT,
	""description_localized_html"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""locarno"" VARIANT,
	""citation"" VARIANT,
	""parent"" VARIANT,
	""child"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,2
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **Table:** `PATENTS.PATENTS.PUBLICATIONS`
   - **"publication_date"**: Used to extract the publication year of each patent for annual counts.
   - **"cpc"**: Contains CPC classification codes for each publication in a VARIANT (JSON-like) format; we can extract CPC symbols from it.
   - **"publication_number"**: Unique identifier for each publication; used to count distinct patent filings.

2. **Table:** `PATENTS.PATENTS.CPC_DEFINITION`
   - **"symbol"**: CPC symbol; can be used to join with CPC symbols extracted from the `PUBLICATIONS` table.
   - **"titleFull"**: Provides the full title of each CPC group.
   - **"level"**: Indicates the classification level of the CPC group; used to filter for level 5 CPC groups.

**Potential Conditions:**

- Extract the year from "publication_date" to group filings by year.
- Flatten the "cpc" column to extract individual CPC symbols associated with each publication.
- Filter CPC groups to include only those at level 5 using the "level" column.
- Join the `PUBLICATIONS` and `CPC_DEFINITION` tables on the CPC symbol to get titles and levels.
- Calculate the exponential moving average (EMA) of patent filings over the years for each CPC group.

**SQL Queries:**

1. **Select distinct publication years from the `PUBLICATIONS` table:**
   ```sql
   SELECT DISTINCT TO_VARCHAR(TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "Year"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100;
   ```

2. **Extract CPC symbols from the "cpc" column in `PUBLICATIONS`:**
   ```sql
   SELECT t."publication_number", c.value:"symbol"::STRING AS "CPC_Symbol"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c
   LIMIT 100;
   ```

3. **Select distinct CPC symbols associated with publications:**
   ```sql
   SELECT DISTINCT c.value:"symbol"::STRING AS "CPC_Symbol"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c
   LIMIT 100;
   ```

4. **Get the number of publications per year:**
   ```sql
   SELECT TO_VARCHAR(TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "Year",
          COUNT(DISTINCT "publication_number") AS "Publication_Count"
   FROM PATENTS.PATENTS.PUBLICATIONS
   GROUP BY "Year"
   ORDER BY "Year"
   LIMIT 100;
   ```

5. **Join `PUBLICATIONS` and `CPC_DEFINITION` to get CPC symbols with their full titles:**
   ```sql
   SELECT DISTINCT c.value:"symbol"::STRING AS "CPC_Symbol", d."titleFull" AS "Full_Title"
   FROM PATENTS.PATENTS.PUBLICATIONS p,
   LATERAL FLATTEN(input => p."cpc") c
   JOIN PATENTS.PATENTS.CPC_DEFINITION d
     ON c.value:"symbol"::STRING = d."symbol"
   LIMIT 100;
   ```

6. **Retrieve CPC symbols at level 5 from `CPC_DEFINITION`:**
   ```sql
   SELECT "symbol" AS "CPC_Symbol", "titleFull" AS "Full_Title", "level"
   FROM PATENTS.PATENTS.CPC_DEFINITION
   WHERE "level" = 5
   LIMIT 100;
   ```

7. **Count publications per CPC symbol for a specific year (e.g., 2020):**
   ```sql
   SELECT c.value:"symbol"::STRING AS "CPC_Symbol",
          COUNT(DISTINCT p."publication_number") AS "Publication_Count"
   FROM PATENTS.PATENTS.PUBLICATIONS p,
   LATERAL FLATTEN(input => p."cpc") c
   WHERE TO_VARCHAR(TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') = '2020'
   GROUP BY c.value:"symbol"::STRING
   ORDER BY "Publication_Count" DESC
   LIMIT 100;
   ```

8. **List the full titles of CPC symbols along with their levels:**
   ```sql
   SELECT "symbol" AS "CPC_Symbol", "titleFull" AS "Full_Title", "level"
   FROM PATENTS.PATENTS.CPC_DEFINITION
   ORDER BY "level"
   LIMIT 100;
   ```

9. **Fetch publication numbers, dates, and associated CPC symbols:**
   ```sql
   SELECT p."publication_number", p."publication_date", c.value:"symbol"::STRING AS "CPC_Symbol"
   FROM PATENTS.PATENTS.PUBLICATIONS p,
   LATERAL FLATTEN(input => p."cpc") c
   LIMIT 100;
   ```

10. **Count the number of filings per CPC symbol per year:**
    ```sql
    SELECT c.value:"symbol"::STRING AS "CPC_Symbol",
           TO_VARCHAR(TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "Year",
           COUNT(DISTINCT p."publication_number") AS "Publication_Count"
    FROM PATENTS.PATENTS.PUBLICATIONS p,
    LATERAL FLATTEN(input => p."cpc") c
    GROUP BY c.value:"symbol"::STRING, "Year"
    ORDER BY "CPC_Symbol", "Year"
    LIMIT 100;
    ```

11. **Identify the distribution of CPC levels in `CPC_DEFINITION`:**
    ```sql
    SELECT "level", COUNT(*) AS "Count"
    FROM PATENTS.PATENTS.CPC_DEFINITION
    GROUP BY "level"
    ORDER BY "level"
    LIMIT 100;
    ```

12. **Find the top 10 CPC symbols at level 5 with the highest publication counts:**
    ```sql
    SELECT c.value:"symbol"::STRING AS "CPC_Symbol",
           COUNT(DISTINCT p."publication_number") AS "Publication_Count"
    FROM PATENTS.PATENTS.PUBLICATIONS p,
    LATERAL FLATTEN(input => p."cpc") c
    JOIN PATENTS.PATENTS.CPC_DEFINITION d
      ON c.value:"symbol"::STRING = d."symbol"
    WHERE d."level" = 5
    GROUP BY c.value:"symbol"::STRING
    ORDER BY "Publication_Count" DESC
    LIMIT 10;
    ```

13. **Extract CPC symbols and their parent groups from `CPC_DEFINITION`:**
    ```sql
    SELECT "symbol" AS "CPC_Symbol", "parents"::STRING AS "Parent_Groups"
    FROM PATENTS.PATENTS.CPC_DEFINITION
    LIMIT 100;
    ```

14. **Check for CPC symbols in `PUBLICATIONS` that are not defined in `CPC_DEFINITION`:**
    ```sql
    SELECT DISTINCT c.value:"symbol"::STRING AS "CPC_Symbol"
    FROM PATENTS.PATENTS.PUBLICATIONS p,
    LATERAL FLATTEN(input => p."cpc") c
    LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION d
      ON c.value:"symbol"::STRING = d."symbol"
    WHERE d."symbol" IS NULL
    LIMIT 100;
    ```

15. **Get the earliest and latest publication dates from `PUBLICATIONS`:**
    ```sql
    SELECT MIN("publication_date") AS "Earliest_Publication_Date",
           MAX("publication_date") AS "Latest_Publication_Date"
    FROM PATENTS.PATENTS.PUBLICATIONS;
    ```

16. **List the number of publications per year overall:**
    ```sql
    SELECT TO_VARCHAR(TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "Year",
           COUNT(DISTINCT p."publication_number") AS "Total_Publications"
    FROM PATENTS.PATENTS.PUBLICATIONS p
    GROUP BY "Year"
    ORDER BY "Year"
    LIMIT 100;
    ```

17. **Retrieve the titles of publications along with their CPC symbols:**
    ```sql
    SELECT p."publication_number", t.value:"text"::STRING AS "Title",
           c.value:"symbol"::STRING AS "CPC_Symbol"
    FROM PATENTS.PATENTS.PUBLICATIONS p,
    LATERAL FLATTEN(input => p."title_localized") t,
    LATERAL FLATTEN(input => p."cpc") c
    LIMIT 100;
    ```

18. **Count the number of CPC symbols associated with each publication:**
    ```sql
    SELECT p."publication_number", COUNT(c.value:"symbol") AS "CPC_Count"
    FROM PATENTS.PATENTS.PUBLICATIONS p,
    LATERAL FLATTEN(input => p."cpc") c
    GROUP BY p."publication_number"
    ORDER BY "CPC_Count" DESC
    LIMIT 100;
    ```

19. **List CPC symbols along with their child groups from `CPC_DEFINITION`:**
    ```sql
    SELECT "symbol" AS "CPC_Symbol", "childGroups"::STRING AS "Child_Groups"
    FROM PATENTS.PATENTS.CPC_DEFINITION
    LIMIT 100;
    ```

20. **Identify CPC symbols with the most significant change in publication counts year over year:**
    ```sql
    SELECT c.value:"symbol"::STRING AS "CPC_Symbol",
           TO_VARCHAR(TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "Year",
           COUNT(DISTINCT p."publication_number") AS "Publication_Count"
    FROM PATENTS.PATENTS.PUBLICATIONS p,
    LATERAL FLATTEN(input => p."cpc") c
    GROUP BY c.value:"symbol"::STRING, "Year"
    HAVING COUNT(DISTINCT p."publication_number") > 100 -- Example threshold
    ORDER BY "CPC_Symbol", "Year"
    LIMIT 100;
    ```

These queries explore the relevant data needed to address the task:

- **Queries 1, 4, 15, and 16** help understand the distribution of publication dates and counts over the years.
- **Queries 2, 3, 5, 9, 17, and 18** extract CPC symbols associated with publications and explore their relationships.
- **Queries 6, 8, 11, 12, 13, and 19** examine the structure and hierarchy of CPC symbols in the `CPC_DEFINITION` table.
- **Queries 7, 10, 14, and 20** combine data from both tables to analyze publication counts per CPC symbol and filter based on specific conditions like year or level.

This approach helps in understanding the data structure and relationships, which is crucial for computing the exponential moving average of patent filings for CPC technology areas at level 5.Query:
SELECT "symbol" AS "CPC_Symbol", "titleFull" AS "Full_Title"
FROM PATENTS.PATENTS.CPC_DEFINITION
WHERE "level" = 5
LIMIT 100;
Answer:
Too long, hard cut:
CPC_Symbol,Full_Title
A01H,NEW PLANTS OR NON-TRANSGENIC PROCESSES FOR OBTAINING THEM; PLANT REPRODUCTION BY TISSUE CULTURE TECHNIQUES
A01F,PROCESSING OF HARVESTED PRODUCE; HAY OR STRAW PRESSES; DEVICES FOR STORING AGRICULTURAL OR HORTICULTURAL PRODUCE
A01C,PLANTING; SOWING; FERTILISING
A01G,"HORTICULTURE; CULTIVATION OF VEGETABLES, FLOWERS, RICE, FRUIT, VINES, HOPS OR SEAWEED; FORESTRY; WATERING"
A01N,"PRESERVATION OF BODIES OF HUMANS OR ANIMALS OR PLANTS OR PARTS THEREOF; BIOCIDES, e.g. AS DISINFECTANTS, AS PESTICIDES OR AS HERBICIDES; PEST REPELLANTS OR ATTRACTANTS; PLANT GROWTH REGULATORS"
A01P,"BIOCIDAL, PEST REPELLANT, PEST ATTRACTANT OR PLANT GROWTH REGULATORY ACTIVITY OF CHEMICAL COMPOUNDS OR PREPARATIONS"
A01D,HARVESTING; MOWING
A01L,SHOEING OF ANIMALS
A01K,"ANIMAL HUSBANDRY; AVICULTURE; APICULTURE; PISCICULTURE; FISHING; REARING OR BREEDING ANIMALS, NOT OTHERWISE PROVIDED FOR; NEW BREEDS OF ANIMALS"
A01M,"CATCHING, TRAPPING OR SCARING OF ANIMALS; APPARATUS FOR THE DESTRUCTION OF NOXIOUS ANIMALS OR NOXIOUS PLANTS"
A01J,MANUFACTURE OF DAIRY PRODUCTS
A01B,"SOIL WORKING IN AGRICULTURE OR FORESTRY; PARTS, DETAILS, OR ACCESSORIES OF AGRICULTURAL MACHINES OR IMPLEMENTS, IN GENERAL"
A21D,"TREATMENT, e.g. PRESERVATION, OF FLOUR OR DOUGH, e.g. BY ADDITION OF MATERIALS; BAKING; BAKERY PRODUCTS; PRESERVATION THEREOF"
A21C,MACHINES OR EQUIPMENT FOR MAKING OR PROCESSING DOUGHS; HANDLING BAKED ARTICLES MADE FROM DOUGH
A21B,BAKERS' OVENS; MACHINES OR EQUIPMENT FOR BAKING
A22B,SLAUGHTERING
A22C,"PROCESSING MEAT, POULTRY, OR FISH"
A23P,"SHAPING OR WORKING OF FOODSTUFFS, NOT FULLY COVERED BY A SINGLE OTHER SUBCLASS"
A23C,"DAIRY PRODUCTS, e.g. MILK, BUTTER OR CHEESE; MILK OR CHEESE SUBSTITUTES; MAKING THEREOF"
A23J,PROTEIN COMPOSITIONS FOR FOODSTUFFS; WORKING-UP PROTEINS FOR FOODSTUFFS; PHOSPHATIDE COMPOSITIONS FOR FOODSTUFFS
A23K,FODDER
A23L,"FOODS, FOODSTUFFS, OR NON-ALCOHOLIC BEVERAGES, NOT COVERED BY SUBCLASSES A21D OR A23B-A23J; THEIR PREPARATION OR TREATMENT, e.g. COOKING, MODIFICATION OF NUTRITIVE QUALITIES, PHYSICAL TREATMENT; PRESERVATION OF FOODS OR FOODSTUFFS, IN GENERAL"
A23N,"MACHINES OR APPARATUS FOR TREATING HARVESTED FRUIT, VEGETABLES OR FLOWER BULBS IN BULK, NOT OTHERWISE PROVIDED FOR; PEELING VEGETABLES OR FRUIT IN BULK; APPARATUS FOR PREPARING ANIMAL FEEDING- STUFFS"
A23V,"INDEXING SCHEME RELATING TO FOODS, FOODSTUFFS OR NON-ALCOHOLIC BEVERAGES AND LACTIC OR PROPIONIC ACID BACTERIA USED IN FOODSTUFFS OR FOOD PREPARATION"
A23F,"COFFEE; TEA; THEIR SUBSTITUTES; MANUFACTURE, PREPARATION, OR INFUSION THEREOF"
A23G,"COCOA; COCOA PRODUCTS, e.g. CHOCOLATE; SUBSTITUTES FOR COCOA OR COCOA PRODUCTS; CONFECTIONERY; CHEWING GUM; ICE-CREAM; PREPARATION THEREOF"
A23B,"PRESERVING, e.g. BY CANNING, MEAT, FISH, EGGS, FRUIT, VEGETABLES, EDIBLE SEEDS; CHEMICAL RIPENING OF FRUIT OR VEGETABLES; THE PRESERVED, RIPENED, OR CANNED PRODUCTS"
A23D,"EDIBLE OILS OR FATS, e.g. MARGARINES, SHORTENINGS, COOKING OILS"
A24C,MACHINES FOR MAKING CIGARS OR CIGARETTES
A24D,CIGARS; CIGARETTES; TOBACCO SMOKE FILTERS; MOUTHPIECES FOR CIGARS OR CIGARETTES; MANUFACTURE OF TOBACCO SMOKE FILTERS OR MOUTHPIECES
A24F,SMOKERS' REQUISITES; MATCH BOXES; SIMULATED SMOKING DEVICES
A24B,MANUFACTURE OR PREPARATION OF TOBACCO FOR SMOKING OR CHEWING; TOBACCO; SNUFF
A41F,GARMENT FASTENINGS; SUSPENDERS
A41G,ARTIFICIAL FLOWERS; WIGS; MASKS; FEATHERS
A41B,SHIRTS; UNDERWEAR; BABY LINEN; HANDKERCHIEFS
A41D,OUTERWEAR; PROTECTIVE GARMENTS; ACCESSORIES
A41C,CORSETS; BRASSIERES
A41H,"APPLIANCES OR METHODS FOR MAKING CLOTHES, e.g. FOR DRESS-MAKING OR FOR TAILORING, NOT OTHERWISE PROVIDED FOR"
A42B,HATS; HEAD COVERINGS
A42C,"MANUFACTURING OR TRIMMING HEAD COVERINGS, e.g. HATS"
A43B,CHARACTERISTIC FEATURES OF FOOTWEAR; PARTS OF FOOTWEAR
A43C,FASTENINGS OR ATTACHMENTS OF FOOTWEAR; LACES IN GENERAL
A43D,"MACHINES, TOOLS, EQUIPMENT OR METHODS FOR MANUFACTURING OR REPAIRING FOOTWEAR"
A44D,"INDEXING SCHEME RELATING TO BUTTONS, PINS, BUCKLES OR SLIDE FASTENERS, AND TO JEWELLERY, BRACELETS OR OTHER PERSONAL ADORNMENTS"
A44B,"BUTTONS, PINS, BUCKLES, SLIDE FASTENERS, OR THE LIKE"
A44C,"PERSONAL ADORNMENTS, e.g. JEWELLERY; COINS"
A45F,TRAVELLING OR CAMP EQUIPMENT: SACKS OR PACKS CARRIED ON THE BODY
A45C,PURSES; LUGGAGE; HAND CARRIED BAGS
A45D,"HAIRDRESSING OR SHAVING EQUIPMENT; EQUIPMENT FOR COSMETICS OR COSMETIC TREATMENTS, e.g. FOR MANICURING OR PEDICURING"
A45B,WALKING STICKS; UMBRELLAS; LADIES' OR LIKE FANS
A46D,MANUFACTURE OF BRUSHES
A46B,BRUSHES
A47L,DOMESTIC WASHING OR CLEANING; SUCTION CLEANERS IN GENERAL
A47F,"SPECIAL FURNITURE, FITTINGS, OR ACCESSORIES FOR SHOPS, STOREHOUSES, BARS, RESTAURANTS OR THE LIKE; PAYING COUNTERS"
A47D,FURNITURE SPECIALLY ADAPTED FOR CHILDREN
A47G,HOUSEHOLD OR TABLE EQUIPMENT
A47K,SANITARY EQUIPMENT NOT OTHERWISE PROVIDED FOR; TOILET ACCESSORIES
A47H,FURNISHINGS FOR WINDOWS OR DOORS
A47B,TABLES; DESKS; OFFICE FURNITURE; CABINETS; DRAWERS; GENERAL DETAILS OF FURNITURE
A47C,CHAIRS; SOFAS; BEDS
A47J,KITCHEN EQUIPMENT; COFFEE MILLS; SPICE MILLS;
Query:
SELECT "symbol" AS "CPC_Symbol", "titleFull" AS "Full_Title"
FROM PATENTS.PATENTS.CPC_DEFINITION
LIMIT 100;
Answer:
Too long, hard cut:
CPC_Symbol,Full_Title
B,PERFORMING OPERATIONS; TRANSPORTING
H,ELECTRICITY
Y,GENERAL TAGGING OF NEW TECHNOLOGICAL DEVELOPMENTS; GENERAL TAGGING OF CROSS-SECTIONAL TECHNOLOGIES SPANNING OVER SEVERAL SECTIONS OF THE IPC; TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS
D,TEXTILES; PAPER
F,MECHANICAL ENGINEERING; LIGHTING; HEATING; WEAPONS; BLASTING
E,FIXED CONSTRUCTIONS
C,CHEMISTRY; METALLURGY
G,PHYSICS
A,HUMAN NECESSITIES
A45,HAND OR TRAVELLING ARTICLES
A24,TOBACCO; CIGARS; CIGARETTES; SIMULATED SMOKING DEVICES; SMOKERS' REQUISITES
A61,MEDICAL OR VETERINARY SCIENCE; HYGIENE
A63,SPORTS; GAMES; AMUSEMENTS
A22,BUTCHERING; MEAT TREATMENT; PROCESSING POULTRY OR FISH
A42,HEADWEAR
A99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
A43,FOOTWEAR
A01,AGRICULTURE; FORESTRY; ANIMAL HUSBANDRY; HUNTING; TRAPPING; FISHING
A62,LIFE-SAVING; FIRE-FIGHTING
A23,"FOODS OR FOODSTUFFS; TREATMENT THEREOF, NOT COVERED BY OTHER CLASSES"
A47,FURNITURE; DOMESTIC ARTICLES OR APPLIANCES; COFFEE MILLS; SPICE MILLS; SUCTION CLEANERS IN GENERAL
A46,BRUSHWARE
A44,HABERDASHERY; JEWELLERY
A21,BAKING; EDIBLE DOUGHS
A41,WEARING APPAREL
B27,WORKING OR PRESERVING WOOD OR SIMILAR MATERIAL; NAILING OR STAPLING MACHINES IN GENERAL
B68,SADDLERY; UPHOLSTERY
B04,CENTRIFUGAL APPARATUS OR MACHINES FOR CARRYING-OUT PHYSICAL OR CHEMICAL PROCESSES
B23,MACHINE TOOLS; METAL-WORKING NOT OTHERWISE PROVIDED FOR
B30,PRESSES
B21,MECHANICAL METAL-WORKING WITHOUT ESSENTIALLY REMOVING MATERIAL; PUNCHING METAL
B25,HAND TOOLS; PORTABLE POWER-DRIVEN TOOLS; MANIPULATORS
B99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
B29,WORKING OF PLASTICS; WORKING OF SUBSTANCES IN A PLASTIC STATE IN GENERAL
B31,"MAKING ARTICLES OF PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER; WORKING PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER"
B26,HAND CUTTING TOOLS; CUTTING; SEVERING
B66,HOISTING; LIFTING; HAULING
B02,"CRUSHING, PULVERISING, OR DISINTEGRATING; PREPARATORY TREATMENT OF GRAIN FOR MILLING"
B65,CONVEYING; PACKING; STORING; HANDLING THIN OR FILAMENTARY MATERIAL
B61,RAILWAYS
B24,GRINDING; POLISHING
B06,GENERATING OR TRANSMITTING MECHANICAL VIBRATIONS IN GENERAL
B43,WRITING OR DRAWING IMPLEMENTS; BUREAU ACCESSORIES
B62,LAND VEHICLES FOR TRAVELLING OTHERWISE THAN ON RAILS
B64,AIRCRAFT; AVIATION; COSMONAUTICS
B22,CASTING; POWDER METALLURGY
B28,"WORKING CEMENT, CLAY, OR STONE"
B09,DISPOSAL OF SOLID WASTE; RECLAMATION OF CONTAMINATED SOIL
B01,PHYSICAL OR CHEMICAL PROCESSES OR APPARATUS IN GENERAL
B63,SHIPS OR OTHER WATERBORNE VESSELS; RELATED EQUIPMENT
B60,VEHICLES IN GENERAL
B44,DECORATIVE ARTS
B07,SEPARATING SOLIDS FROM SOLIDS; SORTING
B08,CLEANING
B82,NANOTECHNOLOGY
B42,BOOKBINDING; ALBUMS; FILES; SPECIAL PRINTED MATTER
B32,LAYERED PRODUCTS
B81,MICROSTRUCTURAL TECHNOLOGY
B05,"SPRAYING OR ATOMISING IN GENERAL; APPLYING FLUENT MATERIALS TO SURFACES, IN GENERAL"
B41,PRINTING; LINING MACHINES; TYPEWRITERS; STAMPS
B03,SEPARATION OF SOLID MATERIALS USING LIQUIDS OR USING PNEUMATIC TABLES OR JIGS; MAGNETIC OR ELECTROSTATIC SEPARATION OF SOLID MATERIALS FROM SOLID MATERIALS OR FLUIDS; SEPARATION BY HIGH-VOLTAGE ELECTRIC FIELDS
B67,"OPENING, CLOSING OR CLEANING BOTTLES, JARS OR SIMILAR CONTAINERS; LIQUID HANDLING"
B33,ADDITIVE MANUFACTURING TECHNOLOGY
C22,METALLURGY; FERROUS OR NON-FERROUS ALLOYS; TREATMENT OF ALLOYS OR NON-FERROUS METALS
C23,"COATING METALLIC MATERIAL; COATING MATERIAL WITH METALLIC MATERIAL; CHEMICAL SURFACE TREATMENT; DIFFUSION TREATMENT OF METALLIC MATERIAL; COATING BY VACUUM EVAPORATION, BY SPUTTERING, BY ION IMPLANTATION OR BY CHEMICAL VAPOUR DEPOSITION, IN GENERAL; INHIBITING CORROSION OF METALLIC MATERIAL OR INCRUSTATION IN GENERAL"
C06,EXPLOSIVES; MATCHES
C02,"TREATMENT OF WATER, WASTE WATER, SEWAGE, OR SLUDGE"
C07,ORGANIC CHEMISTRY
C25,ELECTROLYTIC OR ELECTROPHORETIC PROCESSES; APPARATUS THEREFOR
C30,CRYSTAL GROWTH
C12,BIOCHEMISTRY; BEER; SPIRITS; WINE; VINEGAR; MICROBIOLOGY; ENZYMOLOGY; MUTATION OR GENETIC ENGINEERING
C99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
C05,FERTILISERS; MANUFACTURE THEREOF
C40,COMBINATORIAL TECHNOLOGY
C11,"ANIMAL OR VEGETABLE OILS, FATS, FATTY SUBSTANCES OR WAXES; FATTY ACIDS THEREFROM; DETERGENTS; CANDLES"
C08,ORGANIC MACROMOLECULAR COMPOUNDS; THEIR PREPARATION OR CHEMICAL WORKING-UP; COMPOSITIONS BASED THEREON
C10,"PETROLEUM, GAS OR COKE INDUSTRIES; TECHNICAL GASES CONTAINING CARBON MONOXIDE; FUELS; LUBRICANTS; PEAT"
C21,METALLURGY OF IRON
C04,CEMENTS; CONCRETE; ARTIFICIAL STONE; CERAMICS; REFRACTORIES
C09,DYES; PAINTS; POLISHES; NATURAL RESINS; ADHESIVES; COMPOSITIONS NOT OTHERWISE PROVIDED FOR; APPLICATIONS OF MATERIALS NOT OTHERWISE PROVIDED FOR
C03,GLASS; MINERAL OR SLAG WOOL
C13,SUGAR INDUSTRY
C14,SKINS; HIDES; PELTS; LEATHER
C01,INORGANIC CHEMISTRY
D02,YARNS; MECHANICAL FINISHING OF YARNS OR ROPES; WARPING OR BEAMING
D21,PAPER-MAKING; PRODUCTION OF CELLULOSE
D04,BRAIDING; LACE-MAKING; KNITTING; TRIMMINGS; NON-WO
Query:
SELECT *
FROM PATENTS.PATENTS.CPC_DEFINITION
LIMIT 100;
Answer:
Too long, hard cut:
applicationReferences,breakdownCode,childGroups,children,dateRevised,definition,glossary,informativeReferences,ipcConcordant,level,limitingReferences,notAllocatable,parents,precedenceLimitingReferences,residualReferences,rules,scopeLimitingReferences,status,symbol,synonyms,titleFull,titlePart
[],False,"[
  {
    ""description"": ""SEPARATING; MIXING"",
    ""symbols"": [
      ""B01"",
      ""B02"",
      ""B03"",
      ""B04"",
      ""B05"",
      ""B06"",
      ""B07"",
      ""B08"",
      ""B09""
    ]
  },
  {
    ""description"": ""SHAPING"",
    ""symbols"": [
      ""B21"",
      ""B22"",
      ""B23"",
      ""B24"",
      ""B25"",
      ""B26"",
      ""B27"",
      ""B28"",
      ""B29"",
      ""B30"",
      ""B31"",
      ""B32"",
      ""B33""
    ]
  },
  {
    ""description"": ""PRINTING"",
    ""symbols"": [
      ""B41"",
      ""B42"",
      ""B43"",
      ""B44""
    ]
  },
  {
    ""description"": ""TRANSPORTING"",
    ""symbols"": [
      ""B60"",
      ""B61"",
      ""B62"",
      ""B63"",
      ""B64"",
      ""B65"",
      ""B66"",
      ""B67"",
      ""B68""
    ]
  },
  {
    ""description"": ""MICROSTRUCTURAL TECHNOLOGY; NANOTECHNOLOGY"",
    ""symbols"": [
      ""B81"",
      ""B82""
    ]
  },
  {
    ""description"": """",
    ""symbols"": [
      ""B99""
    ]
  }
]","[
  ""B01"",
  ""B02"",
  ""B03"",
  ""B04"",
  ""B05"",
  ""B06"",
  ""B07"",
  ""B08"",
  ""B09"",
  ""B21"",
  ""B22"",
  ""B23"",
  ""B24"",
  ""B25"",
  ""B26"",
  ""B27"",
  ""B28"",
  ""B29"",
  ""B30"",
  ""B31"",
  ""B32"",
  ""B33"",
  ""B41"",
  ""B42"",
  ""B43"",
  ""B44"",
  ""B60"",
  ""B61"",
  ""B62"",
  ""B63"",
  ""B64"",
  ""B65"",
  ""B66"",
  ""B67"",
  ""B68"",
  ""B81"",
  ""B82"",
  ""B99""
]",20160501.0,[],[],[],,2.0,[],True,[],[],[],[],[],published,B,[],PERFORMING OPERATIONS; TRANSPORTING,"[
  ""PERFORMING OPERATIONS"",
  ""TRANSPORTING""
]"
[],False,"[
  {
    ""description"": """",
    ""symbols"": [
      ""H01"",
      ""H02"",
      ""H03"",
      ""H04"",
      ""H05"",
      ""H10"",
      ""H99""
    ]
  }
]","[
  ""H01"",
  ""H02"",
  ""H03"",
  ""H04"",
  ""H05"",
  ""H10"",
  ""H99""
]",20200101.0,[],[],[],,2.0,[],True,[],[],[],[],[],published,H,[],ELECTRICITY,"[
  ""ELECTRICITY""
]"
[],False,"[
  {
    ""description"": """",
    ""symbols"": [
      ""Y02"",
      ""Y04"",
      ""Y10""
    ]
  }
]","[
  ""Y02"",
  ""Y04"",
  ""Y10""
]",20130101.0,[],[],[],,2.0,[],True,[],[],[],[],[],published,Y,[],GENERAL TAGGING OF NEW TECHNOLOGICAL DEVELOPMENTS; GENERAL TAGGING OF CROSS-SECTIONAL TECHNOLOGIES SPANNING OVER SEVERAL SECTIONS OF THE IPC; TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS,"[
  ""GENERAL TAGGING OF NEW TECHNOLOGICAL DEVELOPMENTS"",
  ""GENERAL TAGGING OF CROSS-SECTIONAL TECHNOLOGIES SPANNING OVER SEVERAL SECTIONS OF THE IPC"",
  ""TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS""
]"
[],False,"[
  {
    ""description"": ""TEXTILES OR FLEXIBLE MATERIALS NOT OTHERWISE PROVIDED FOR"",
    ""symbols"": [
      ""D01"",
      ""D02"",
      ""D03"",
      ""D04"",
      ""D05"",
      ""D06"",
      ""D07"",
      ""D10""
    ]
  },
  {
    ""description"": ""PAPER"",
    ""symbols"": [
      ""D21""
    ]
  },
  {
    ""description"": """",
    ""symbols"": [
      ""D99""
    ]
  }
]","[
  ""D01"",
  ""D02"",
  ""D03"",
  ""D04"",
  ""D05"",
  ""D06"",
  ""D07"",
  ""D10"",
  ""D21"",
  ""D99""
]",20130101.0,[],[],[],,2.0,[],True,[],[],[],[],[],published,D,[],TEXTILES; PAPER,"[
  ""TEXTILES"",
  ""PAPER""
]"
[],False,"[
  {
    ""description"": ""ENGINES OR PUMPS"",
    ""symbols"": [
      ""F01"",
      ""F02"",
      ""F03"",
      ""F04"",
      ""F05""
    ]
  },
  {
    ""description"": ""ENGINEERING IN GENERAL"",
    ""symbols"": [
      ""F15"",
      ""F16"",
      ""F17""
    ]
  },
  {
    ""description"": ""LIGHTING; HEATING"",
    ""symbols"": [
      ""F21"",
      ""F22"",
      ""F23"",
      ""F24"",
      ""F25"",
      ""F26"",
      ""F27"",
      ""F28""
    ]
  },
  {
    ""description"": ""WEAPONS; BLASTING"",
    ""symbols"": [
      ""F41"",
      ""F42""
    ]
  },
  {
    ""description"": """",
    ""symbols"": [
      ""F99""
    ]
  }
]","[
  ""F01"",
  ""F02"",
  ""F03"",
  ""F04"",
  ""F05"",
  ""F15"",
  ""F16"",
  ""F17"",
  ""F21"",
  ""F22"",
  ""F23"",
  ""F24"",
  ""F25"",
  ""F26"",
  ""F27"",
  ""F28"",
  ""F41"",
  ""F42"",
  ""F99""
]",20190201.0,[],[],[],,2.0,[],True,[],[],[],[],[],published,F,[],MECHANICAL ENGINEERING; LIGHTING; HEATING; WEAPONS; BLASTING,"[
  ""MECHANICAL ENGINEERING"",
  ""LIGHTING"",
  ""HEATING"",
  ""WEAPONS"",
  ""BLASTING""
]"
[],False,"[
  {
    ""description"": ""BUILDING"",
    ""symbols"": [
      ""E01"",
      ""E02"",
      ""E03"",
      ""E04"",
      ""E05"",
      ""E06""
    ]
  },
  {
    ""description"": ""EARTH DRILLING; MINING"",
    ""symbols"": [
      ""E21""
    ]
  },
  {
    ""descri
Query:
SELECT TO_VARCHAR(TRY_TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "Year",
       COUNT(DISTINCT "publication_number") AS "Publication_Count"
FROM PATENTS.PATENTS.PUBLICATIONS
GROUP BY "Year"
ORDER BY "Year"
LIMIT 100
Answer:
Year,Publication_Count
1837,2
1839,2
1841,4
1842,5
1843,2
1844,3
1845,1
1846,2
1847,3
1848,2
1849,1
1850,2
1851,1
1852,1
1853,4
1854,3
1855,4
1856,6
1857,3
1858,16
1859,15
1860,13
1861,12
1862,7
1863,12
1864,11
1865,12
1866,26
1867,18
1868,17
1869,25
1870,35
1871,34
1872,28
1873,27
1874,30
1875,26
1876,33
1877,33
1878,54
1879,72
1880,57
1881,76
1882,112
1883,101
1884,99
1885,103
1886,100
1887,96
1888,102
1889,112
1890,111
1891,100
1892,125
1893,93
1894,100
1895,97
1896,84
1897,102
1898,81
1899,84
1900,162
1901,86
1902,94
1903,133
1904,135
1905,112
1906,149
1907,203
1908,192
1909,169
1910,133
1911,137
1912,189
1913,279
1914,351
1915,220
1916,163
1917,147
1918,142
1919,160
1920,183
1921,189
1922,235
1923,231
1924,216
1925,252
1926,235
1927,244
1928,243
1929,259
1930,335
1931,319
1932,335
1933,259
1934,265
1935,296
1936,351
1937,322
1938,334
Query:
SELECT "symbol" AS "CPC_Symbol", "titleFull" AS "Full_Title", "level"
FROM PATENTS.PATENTS.CPC_DEFINITION
LIMIT 100
Answer:
Too long, hard cut:
CPC_Symbol,Full_Title,level
B,PERFORMING OPERATIONS; TRANSPORTING,2.0
H,ELECTRICITY,2.0
Y,GENERAL TAGGING OF NEW TECHNOLOGICAL DEVELOPMENTS; GENERAL TAGGING OF CROSS-SECTIONAL TECHNOLOGIES SPANNING OVER SEVERAL SECTIONS OF THE IPC; TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS,2.0
D,TEXTILES; PAPER,2.0
F,MECHANICAL ENGINEERING; LIGHTING; HEATING; WEAPONS; BLASTING,2.0
E,FIXED CONSTRUCTIONS,2.0
C,CHEMISTRY; METALLURGY,2.0
G,PHYSICS,2.0
A,HUMAN NECESSITIES,2.0
A45,HAND OR TRAVELLING ARTICLES,4.0
A24,TOBACCO; CIGARS; CIGARETTES; SIMULATED SMOKING DEVICES; SMOKERS' REQUISITES,4.0
A61,MEDICAL OR VETERINARY SCIENCE; HYGIENE,4.0
A63,SPORTS; GAMES; AMUSEMENTS,4.0
A22,BUTCHERING; MEAT TREATMENT; PROCESSING POULTRY OR FISH,4.0
A42,HEADWEAR,4.0
A99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION,4.0
A43,FOOTWEAR,4.0
A01,AGRICULTURE; FORESTRY; ANIMAL HUSBANDRY; HUNTING; TRAPPING; FISHING,4.0
A62,LIFE-SAVING; FIRE-FIGHTING,4.0
A23,"FOODS OR FOODSTUFFS; TREATMENT THEREOF, NOT COVERED BY OTHER CLASSES",4.0
A47,FURNITURE; DOMESTIC ARTICLES OR APPLIANCES; COFFEE MILLS; SPICE MILLS; SUCTION CLEANERS IN GENERAL,4.0
A46,BRUSHWARE,4.0
A44,HABERDASHERY; JEWELLERY,4.0
A21,BAKING; EDIBLE DOUGHS,4.0
A41,WEARING APPAREL,4.0
B27,WORKING OR PRESERVING WOOD OR SIMILAR MATERIAL; NAILING OR STAPLING MACHINES IN GENERAL,4.0
B68,SADDLERY; UPHOLSTERY,4.0
B04,CENTRIFUGAL APPARATUS OR MACHINES FOR CARRYING-OUT PHYSICAL OR CHEMICAL PROCESSES,4.0
B23,MACHINE TOOLS; METAL-WORKING NOT OTHERWISE PROVIDED FOR,4.0
B30,PRESSES,4.0
B21,MECHANICAL METAL-WORKING WITHOUT ESSENTIALLY REMOVING MATERIAL; PUNCHING METAL,4.0
B25,HAND TOOLS; PORTABLE POWER-DRIVEN TOOLS; MANIPULATORS,4.0
B99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION,4.0
B29,WORKING OF PLASTICS; WORKING OF SUBSTANCES IN A PLASTIC STATE IN GENERAL,4.0
B31,"MAKING ARTICLES OF PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER; WORKING PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER",4.0
B26,HAND CUTTING TOOLS; CUTTING; SEVERING,4.0
B66,HOISTING; LIFTING; HAULING,4.0
B02,"CRUSHING, PULVERISING, OR DISINTEGRATING; PREPARATORY TREATMENT OF GRAIN FOR MILLING",4.0
B65,CONVEYING; PACKING; STORING; HANDLING THIN OR FILAMENTARY MATERIAL,4.0
B61,RAILWAYS,4.0
B24,GRINDING; POLISHING,4.0
B06,GENERATING OR TRANSMITTING MECHANICAL VIBRATIONS IN GENERAL,4.0
B43,WRITING OR DRAWING IMPLEMENTS; BUREAU ACCESSORIES,4.0
B62,LAND VEHICLES FOR TRAVELLING OTHERWISE THAN ON RAILS,4.0
B64,AIRCRAFT; AVIATION; COSMONAUTICS,4.0
B22,CASTING; POWDER METALLURGY,4.0
B28,"WORKING CEMENT, CLAY, OR STONE",4.0
B09,DISPOSAL OF SOLID WASTE; RECLAMATION OF CONTAMINATED SOIL,4.0
B01,PHYSICAL OR CHEMICAL PROCESSES OR APPARATUS IN GENERAL,4.0
B63,SHIPS OR OTHER WATERBORNE VESSELS; RELATED EQUIPMENT,4.0
B60,VEHICLES IN GENERAL,4.0
B44,DECORATIVE ARTS,4.0
B07,SEPARATING SOLIDS FROM SOLIDS; SORTING,4.0
B08,CLEANING,4.0
B82,NANOTECHNOLOGY,4.0
B42,BOOKBINDING; ALBUMS; FILES; SPECIAL PRINTED MATTER,4.0
B32,LAYERED PRODUCTS,4.0
B81,MICROSTRUCTURAL TECHNOLOGY,4.0
B05,"SPRAYING OR ATOMISING IN GENERAL; APPLYING FLUENT MATERIALS TO SURFACES, IN GENERAL",4.0
B41,PRINTING; LINING MACHINES; TYPEWRITERS; STAMPS,4.0
B03,SEPARATION OF SOLID MATERIALS USING LIQUIDS OR USING PNEUMATIC TABLES OR JIGS; MAGNETIC OR ELECTROSTATIC SEPARATION OF SOLID MATERIALS FROM SOLID MATERIALS OR FLUIDS; SEPARATION BY HIGH-VOLTAGE ELECTRIC FIELDS,4.0
B67,"OPENING, CLOSING OR CLEANING BOTTLES, JARS OR SIMILAR CONTAINERS; LIQUID HANDLING",4.0
B33,ADDITIVE MANUFACTURING TECHNOLOGY,4.0
C22,METALLURGY; FERROUS OR NON-FERROUS ALLOYS; TREATMENT OF ALLOYS OR NON-FERROUS METALS,4.0
C23,"COATING METALLIC MATERIAL; COATING MATERIAL WITH METALLIC MATERIAL; CHEMICAL SURFACE TREATMENT; DIFFUSION TREATMENT OF METALLIC MATERIAL; COATING BY VACUUM EVAPORATION, BY SPUTTERING, BY ION IMPLANTATION OR BY CHEMICAL VAPOUR DEPOSITION, IN GENERAL; INHIBITING CORROSION OF METALLIC MATERIAL OR INCRUSTATION IN GENERAL",4.0
C06,EXPLOSIVES; MATCHES,4.0
C02,"TREATMENT OF WATER, WASTE WATER, SEWAGE, OR SLUDGE",4.0
C07,ORGANIC CHEMISTRY,4.0
C25,ELECTROLYTIC OR ELECTROPHORETIC PROCESSES; APPARATUS THEREFOR,4.0
C30,CRYSTAL GROWTH,4.0
C12,BIOCHEMISTRY; BEER; SPIRITS; WINE; VINEGAR; MICROBIOLOGY; ENZYMOLOGY; MUTATION OR GENETIC ENGINEERING,4.0
C99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION,4.0
C05,FERTILISERS; MANUFACTURE THEREOF,4.0
C40,COMBINATORIAL TECHNOLOGY,4.0
C11,"ANIMAL OR VEGETABLE OILS, FATS, FATTY SUBSTANCES OR WAXES; FATTY ACIDS THEREFROM; DETERGENTS; CANDLES",4.0
C08,ORGANIC MACROMOLECULAR COMPOUNDS; THEIR PREPARATION OR CHEMICAL WORKING-UP; COMPOSITIONS BASED THEREON,4.0
C10,"PETROLEUM, GAS OR COKE INDUSTRIES; TECHNICAL GASES CONTAINING CARBON MONOXIDE; FUELS; LUBRICANTS; PEAT",4.0
C21,METALLURGY OF IRON,4.0
C04,CEMENTS; CONCRETE; ARTIFICIAL STONE; CERAMICS; REFRACTORIES,4.0
C09,DYES; PAINTS; POLISHES; NATURAL RESINS; ADHESIVES; COMPOSITIONS NOT OTHERWISE PROVIDED FOR; APPLI
Query:
SELECT c.value::STRING AS "IPC_Symbol",
       COUNT(DISTINCT p."publication_number") AS "Publication_Count"
FROM PATENTS.PATENTS.PUBLICATIONS p,
     LATERAL FLATTEN(input => p."ipc") c
GROUP BY c.value::STRING
ORDER BY "Publication_Count" DESC
LIMIT 100;
Answer:
Too long, hard cut:
IPC_Symbol,Publication_Count
"{""code"":""A61P35/00"",""first"":false,""inventive"":true,""tree"":[]}",2604
"{""code"":""A61P43/00"",""first"":false,""inventive"":true,""tree"":[]}",1812
"{""code"":""F21Y115/10"",""first"":false,""inventive"":false,""tree"":[]}",1443
"{""code"":""A61P29/00"",""first"":false,""inventive"":true,""tree"":[]}",1423
"{""code"":""A63F7/02"",""first"":true,""inventive"":true,""tree"":[]}",1222
"{""code"":""H04L29/06"",""first"":false,""inventive"":true,""tree"":[]}",1148
"{""code"":""H04L29/08"",""first"":false,""inventive"":true,""tree"":[]}",1112
"{""code"":""H05K7/20"",""first"":false,""inventive"":true,""tree"":[]}",1083
"{""code"":""G06F17/30"",""first"":true,""inventive"":true,""tree"":[]}",1031
"{""code"":""C07C67/00"",""first"":false,""inventive"":true,""tree"":[]}",972
"{""code"":""A61P31/04"",""first"":false,""inventive"":true,""tree"":[]}",966
"{""code"":""G06F17/30"",""first"":false,""inventive"":true,""tree"":[]}",944
"{""code"":""A61P25/00"",""first"":false,""inventive"":true,""tree"":[]}",944
"{""code"":""F26B21/00"",""first"":false,""inventive"":true,""tree"":[]}",939
"{""code"":""A61K9/00"",""first"":false,""inventive"":true,""tree"":[]}",857
"{""code"":""A61Q19/00"",""first"":false,""inventive"":true,""tree"":[]}",854
"{""code"":""B08B13/00"",""first"":false,""inventive"":true,""tree"":[]}",845
"{""code"":""F21V33/00"",""first"":false,""inventive"":true,""tree"":[]}",842
"{""code"":""A61P9/10"",""first"":false,""inventive"":true,""tree"":[]}",804
"{""code"":""G06Q50/00"",""first"":false,""inventive"":true,""tree"":[]}",798
"{""code"":""H02J7/00"",""first"":false,""inventive"":true,""tree"":[]}",795
"{""code"":""C12N5/10"",""first"":false,""inventive"":true,""tree"":[]}",794
"{""code"":""A61B5/00"",""first"":false,""inventive"":true,""tree"":[]}",782
"{""code"":""H02J7/00"",""first"":true,""inventive"":true,""tree"":[]}",782
"{""code"":""G06N3/08"",""first"":false,""inventive"":true,""tree"":[]}",781
"{""code"":""A61P9/00"",""first"":false,""inventive"":true,""tree"":[]}",775
"{""code"":""C12Q1/68"",""first"":false,""inventive"":true,""tree"":[]}",773
"{""code"":""H04L29/06"",""first"":true,""inventive"":true,""tree"":[]}",769
"{""code"":""H04N5/225"",""first"":false,""inventive"":true,""tree"":[]}",717
"{""code"":""A61P3/10"",""first"":false,""inventive"":true,""tree"":[]}",716
"{""code"":""A61K39/395"",""first"":false,""inventive"":true,""tree"":[]}",715
"{""code"":""A61P25/28"",""first"":false,""inventive"":true,""tree"":[]}",713
"{""code"":""C07B61/00"",""first"":false,""inventive"":true,""tree"":[]}",713
"{""code"":""A61P17/00"",""first"":false,""inventive"":true,""tree"":[]}",712
"{""code"":""H04N7/18"",""first"":false,""inventive"":true,""tree"":[]}",710
"{""code"":""G06T1/00"",""first"":false,""inventive"":true,""tree"":[]}",706
"{""code"":""B24B41/06"",""first"":false,""inventive"":true,""tree"":[]}",694
"{""code"":""C12N15/09"",""first"":true,""inventive"":true,""tree"":[]}",685
"{""code"":""H05K7/20"",""first"":true,""inventive"":true,""tree"":[]}",677
"{""code"":""B32B33/00"",""first"":false,""inventive"":true,""tree"":[]}",676
"{""code"":""H01L21/027"",""first"":false,""inventive"":true,""tree"":[]}",673
"{""code"":""G03G15/00"",""first"":false,""inventive"":true,""tree"":[]}",671
"{""code"":""F21V23/00"",""first"":false,""inventive"":true,""tree"":[]}",668
"{""code"":""B07B1/46"",""first"":false,""inventive"":true,""tree"":[]}",652
"{""code"":""G06K9/62"",""first"":false,""inventive"":true,""tree"":[]}",651
"{""code"":""G06K9/00"",""first"":false,""inventive"":true,""tree"":[]}",633
"{""code"":""C12N15/09"",""first"":false,""inventive"":true,""tree"":[]}",633
"{""code"":""C12N1/21"",""first"":false,""inventive"":true,""tree"":[]}",632
"{""code"":""F21V19/00"",""first"":false,""inventive"":true,""tree"":[]}",627
"{""code"":""A61K38/00"",""first"":false,""inventive"":true,""tree"":[]}",618
"{""code"":""G06K9/00"",""first"":true,""inventive"":true,""tree"":[]}",615
"{""code"":""F26B25/00"",""first"":false,""inventive"":true,""tree"":[]}",611
"{""code"":""A61P11/00"",""first"":false,""inventive"":true,""tree"":[]}",611
"{""code"":""G06T7/00"",""first"":false,""inventive"":true,""tree"":[]}",610
"{""code"":""H01L21/336"",""first"":false,""inventive"":true,""tree"":[]}",606
"{""code"":""H05K5/02"",""first"":false,""inventive"":true,""tree"":[]}",603
"{""code"":""C08K3/22"",""first"":false,""inventive"":true,""tree"":[]}",602
"{""code"":""G06N3/04"",""first"":false,""inventive"":true,""tree"":[]}",601
"{""code"":""G02F1/1335"",""first"":false,""inventive"":true,""tree"":[]}",598
"{""code"":""G06F13/00"",""first"":false,""inventive"":true,""tree"":[]}",582
"{""code"":""H01L29/78"",""first"":false,""inventive"":true,""tree"":[]}",580
"{""code"":""H05K5/02"",""first"":true,""inventive"":true,""tree"":[]}",575
"{""code"":""G06Q30/06"",""first"":false,""inventive"":true,""tree"":[]}",574
"{""code"":""A61K45/00"",""first"":false,""inventive"":true,""tree"":[]}",5
Query:
SELECT "symbol" AS "CPC_Symbol", "titleFull" AS "Full_Title", "level"
FROM PATENTS.PATENTS.CPC_DEFINITION
WHERE "symbol" IS NOT NULL AND "symbol" <> ''
LIMIT 100
Answer:
Too long, hard cut:
CPC_Symbol,Full_Title,level
B,PERFORMING OPERATIONS; TRANSPORTING,2.0
H,ELECTRICITY,2.0
Y,GENERAL TAGGING OF NEW TECHNOLOGICAL DEVELOPMENTS; GENERAL TAGGING OF CROSS-SECTIONAL TECHNOLOGIES SPANNING OVER SEVERAL SECTIONS OF THE IPC; TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS,2.0
D,TEXTILES; PAPER,2.0
F,MECHANICAL ENGINEERING; LIGHTING; HEATING; WEAPONS; BLASTING,2.0
E,FIXED CONSTRUCTIONS,2.0
C,CHEMISTRY; METALLURGY,2.0
G,PHYSICS,2.0
A,HUMAN NECESSITIES,2.0
A45,HAND OR TRAVELLING ARTICLES,4.0
A24,TOBACCO; CIGARS; CIGARETTES; SIMULATED SMOKING DEVICES; SMOKERS' REQUISITES,4.0
A61,MEDICAL OR VETERINARY SCIENCE; HYGIENE,4.0
A63,SPORTS; GAMES; AMUSEMENTS,4.0
A22,BUTCHERING; MEAT TREATMENT; PROCESSING POULTRY OR FISH,4.0
A42,HEADWEAR,4.0
A99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION,4.0
A43,FOOTWEAR,4.0
A01,AGRICULTURE; FORESTRY; ANIMAL HUSBANDRY; HUNTING; TRAPPING; FISHING,4.0
A62,LIFE-SAVING; FIRE-FIGHTING,4.0
A23,"FOODS OR FOODSTUFFS; TREATMENT THEREOF, NOT COVERED BY OTHER CLASSES",4.0
A47,FURNITURE; DOMESTIC ARTICLES OR APPLIANCES; COFFEE MILLS; SPICE MILLS; SUCTION CLEANERS IN GENERAL,4.0
A46,BRUSHWARE,4.0
A44,HABERDASHERY; JEWELLERY,4.0
A21,BAKING; EDIBLE DOUGHS,4.0
A41,WEARING APPAREL,4.0
B27,WORKING OR PRESERVING WOOD OR SIMILAR MATERIAL; NAILING OR STAPLING MACHINES IN GENERAL,4.0
B68,SADDLERY; UPHOLSTERY,4.0
B04,CENTRIFUGAL APPARATUS OR MACHINES FOR CARRYING-OUT PHYSICAL OR CHEMICAL PROCESSES,4.0
B23,MACHINE TOOLS; METAL-WORKING NOT OTHERWISE PROVIDED FOR,4.0
B30,PRESSES,4.0
B21,MECHANICAL METAL-WORKING WITHOUT ESSENTIALLY REMOVING MATERIAL; PUNCHING METAL,4.0
B25,HAND TOOLS; PORTABLE POWER-DRIVEN TOOLS; MANIPULATORS,4.0
B99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION,4.0
B29,WORKING OF PLASTICS; WORKING OF SUBSTANCES IN A PLASTIC STATE IN GENERAL,4.0
B31,"MAKING ARTICLES OF PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER; WORKING PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER",4.0
B26,HAND CUTTING TOOLS; CUTTING; SEVERING,4.0
B66,HOISTING; LIFTING; HAULING,4.0
B02,"CRUSHING, PULVERISING, OR DISINTEGRATING; PREPARATORY TREATMENT OF GRAIN FOR MILLING",4.0
B65,CONVEYING; PACKING; STORING; HANDLING THIN OR FILAMENTARY MATERIAL,4.0
B61,RAILWAYS,4.0
B24,GRINDING; POLISHING,4.0
B06,GENERATING OR TRANSMITTING MECHANICAL VIBRATIONS IN GENERAL,4.0
B43,WRITING OR DRAWING IMPLEMENTS; BUREAU ACCESSORIES,4.0
B62,LAND VEHICLES FOR TRAVELLING OTHERWISE THAN ON RAILS,4.0
B64,AIRCRAFT; AVIATION; COSMONAUTICS,4.0
B22,CASTING; POWDER METALLURGY,4.0
B28,"WORKING CEMENT, CLAY, OR STONE",4.0
B09,DISPOSAL OF SOLID WASTE; RECLAMATION OF CONTAMINATED SOIL,4.0
B01,PHYSICAL OR CHEMICAL PROCESSES OR APPARATUS IN GENERAL,4.0
B63,SHIPS OR OTHER WATERBORNE VESSELS; RELATED EQUIPMENT,4.0
B60,VEHICLES IN GENERAL,4.0
B44,DECORATIVE ARTS,4.0
B07,SEPARATING SOLIDS FROM SOLIDS; SORTING,4.0
B08,CLEANING,4.0
B82,NANOTECHNOLOGY,4.0
B42,BOOKBINDING; ALBUMS; FILES; SPECIAL PRINTED MATTER,4.0
B32,LAYERED PRODUCTS,4.0
B81,MICROSTRUCTURAL TECHNOLOGY,4.0
B05,"SPRAYING OR ATOMISING IN GENERAL; APPLYING FLUENT MATERIALS TO SURFACES, IN GENERAL",4.0
B41,PRINTING; LINING MACHINES; TYPEWRITERS; STAMPS,4.0
B03,SEPARATION OF SOLID MATERIALS USING LIQUIDS OR USING PNEUMATIC TABLES OR JIGS; MAGNETIC OR ELECTROSTATIC SEPARATION OF SOLID MATERIALS FROM SOLID MATERIALS OR FLUIDS; SEPARATION BY HIGH-VOLTAGE ELECTRIC FIELDS,4.0
B67,"OPENING, CLOSING OR CLEANING BOTTLES, JARS OR SIMILAR CONTAINERS; LIQUID HANDLING",4.0
B33,ADDITIVE MANUFACTURING TECHNOLOGY,4.0
C22,METALLURGY; FERROUS OR NON-FERROUS ALLOYS; TREATMENT OF ALLOYS OR NON-FERROUS METALS,4.0
C23,"COATING METALLIC MATERIAL; COATING MATERIAL WITH METALLIC MATERIAL; CHEMICAL SURFACE TREATMENT; DIFFUSION TREATMENT OF METALLIC MATERIAL; COATING BY VACUUM EVAPORATION, BY SPUTTERING, BY ION IMPLANTATION OR BY CHEMICAL VAPOUR DEPOSITION, IN GENERAL; INHIBITING CORROSION OF METALLIC MATERIAL OR INCRUSTATION IN GENERAL",4.0
C06,EXPLOSIVES; MATCHES,4.0
C02,"TREATMENT OF WATER, WASTE WATER, SEWAGE, OR SLUDGE",4.0
C07,ORGANIC CHEMISTRY,4.0
C25,ELECTROLYTIC OR ELECTROPHORETIC PROCESSES; APPARATUS THEREFOR,4.0
C30,CRYSTAL GROWTH,4.0
C12,BIOCHEMISTRY; BEER; SPIRITS; WINE; VINEGAR; MICROBIOLOGY; ENZYMOLOGY; MUTATION OR GENETIC ENGINEERING,4.0
C99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION,4.0
C05,FERTILISERS; MANUFACTURE THEREOF,4.0
C40,COMBINATORIAL TECHNOLOGY,4.0
C11,"ANIMAL OR VEGETABLE OILS, FATS, FATTY SUBSTANCES OR WAXES; FATTY ACIDS THEREFROM; DETERGENTS; CANDLES",4.0
C08,ORGANIC MACROMOLECULAR COMPOUNDS; THEIR PREPARATION OR CHEMICAL WORKING-UP; COMPOSITIONS BASED THEREON,4.0
C10,"PETROLEUM, GAS OR COKE INDUSTRIES; TECHNICAL GASES CONTAINING CARBON MONOXIDE; FUELS; LUBRICANTS; PEAT",4.0
C21,METALLURGY OF IRON,4.0
C04,CEMENTS; CONCRETE; ARTIFICIAL STONE; CERAMICS; REFRACTORIES,4.0
C09,DYES; PAINTS; POLISHES; NATURAL RESINS; ADHESIVES; COMPOSITIONS NOT OTHERWISE PROVIDED FOR; APPLI
Query:
SELECT p."publication_number", c.value::STRING AS "IPC_Symbol"
FROM PATENTS.PATENTS.PUBLICATIONS p,
     LATERAL FLATTEN(input => p."ipc") c
LIMIT 100;
Answer:
Too long, hard cut:
publication_number,IPC_Symbol
US-2015177816-A1,"{""code"":""G06F1/32"",""first"":true,""inventive"":true,""tree"":[]}"
US-2015177816-A1,"{""code"":""G06F13/364"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015177816-A1,"{""code"":""G06F1/26"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015180461-A1,"{""code"":""H03K17/687"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015180461-A1,"{""code"":""H03K17/08"",""first"":true,""inventive"":true,""tree"":[]}"
US-2015271362-A1,"{""code"":""H04N1/387"",""first"":true,""inventive"":true,""tree"":[]}"
US-2015271362-A1,"{""code"":""G06K15/02"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015314861-A1,"{""code"":""B64C25/26"",""first"":true,""inventive"":true,""tree"":[]}"
US-2015340518-A1,"{""code"":""C30B29/06"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015340518-A1,"{""code"":""C03C3/04"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015340518-A1,"{""code"":""H01L31/0224"",""first"":true,""inventive"":true,""tree"":[]}"
US-2015340518-A1,"{""code"":""H01L31/028"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015340518-A1,"{""code"":""H01L31/06"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015340518-A1,"{""code"":""C09D11/10"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015340518-A1,"{""code"":""C09D11/102"",""first"":false,""inventive"":true,""tree"":[]}"
US-2016275535-A1,"{""code"":""G06Q30/02"",""first"":true,""inventive"":true,""tree"":[]}"
US-2016285437-A1,"{""code"":""H03K3/037"",""first"":true,""inventive"":true,""tree"":[]}"
US-2016285437-A1,"{""code"":""G06F1/10"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""B41J2/045"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""C04B35/00"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""B41J2/14"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""B41J2/135"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""B41J2/055"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""B05C5/00"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""H10N30/853"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""H10N30/85"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""H10N30/50"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""H10N30/20"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""H10N30/093"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""H10N30/084"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015200352-A1,"{""code"":""H10N30/01"",""first"":false,""inventive"":true,""tree"":[]}"
US-2016280116-A1,"{""code"":""B60P1/44"",""first"":true,""inventive"":true,""tree"":[]}"
US-2015205759-A1,"{""code"":""G06F17/11"",""first"":true,""inventive"":true,""tree"":[]}"
US-2016120347-A1,"{""code"":""B63B35/73"",""first"":false,""inventive"":true,""tree"":[]}"
US-2016120347-A1,"{""code"":""A47G23/02"",""first"":true,""inventive"":true,""tree"":[]}"
US-2015289441-A1,"{""code"":""A01C7/04"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015289441-A1,"{""code"":""A01C7/08"",""first"":true,""inventive"":true,""tree"":[]}"
US-2016335166-A1,"{""code"":""G06F11/20"",""first"":true,""inventive"":true,""tree"":[]}"
US-2016335166-A1,"{""code"":""G06F3/06"",""first"":false,""inventive"":true,""tree"":[]}"
US-2016345465-A1,"{""code"":""H05K7/20"",""first"":true,""inventive"":true,""tree"":[]}"
US-2016345465-A1,"{""code"":""B23P15/26"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015275041-A1,"{""code"":""B29C67/00"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015275041-A1,"{""code"":""C08J3/28"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015275041-A1,"{""code"":""C09D175/16"",""first"":true,""inventive"":true,""tree"":[]}"
US-2016364384-A1,"{""code"":""G06F40/00"",""first"":false,""inventive"":true,""tree"":[]}"
US-2016364384-A1,"{""code"":""G06F17/28"",""first"":true,""inventive"":true,""tree"":[]}"
US-2016364384-A1,"{""code"":""G06F17/27"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015287715-A1,"{""code"":""H01L23/64"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015287715-A1,"{""code"":""H01L29/78"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015287715-A1,"{""code"":""H01L23/50"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015287715-A1,"{""code"":""H01L27/06"",""first"":true,""inventive"":true,""tree"":[]}"
US-2015287715-A1,"{""code"":""H01L27/092"",""first"":false,""inventive"":true,""tree"":[]}"
US-2015287715-A1,"{""code"":""H10N97/00"",""first"":false,""inventive"":true,""tree"":[]}"
US-2016380415-A1,"{""code"":""H02G1/04"",""first"":true,""inventive"":true,""tree"":[]}"
US-2016380415-A1,"{""code"":""B25B25/00"",""first"":false,""inventive"":tru
Query:
SELECT c.value::STRING AS "IPC_Symbol",
       COUNT(p."publication_number") AS "Publication_Count"
FROM (
    SELECT *
    FROM PATENTS.PATENTS.PUBLICATIONS
    LIMIT 100
) p,
LATERAL FLATTEN(input => p."ipc") c
WHERE c.value::STRING IS NOT NULL AND c.value::STRING <> ''
GROUP BY c.value::STRING
ORDER BY "Publication_Count" DESC
LIMIT 100
Answer:
Too long, hard cut:
IPC_Symbol,Publication_Count
"{""code"":""C07C67/00"",""first"":false,""inventive"":true,""tree"":[]}",3
"{""code"":""C07C239/00"",""first"":false,""inventive"":true,""tree"":[]}",2
"{""code"":""F16B12/20"",""first"":false,""inventive"":true,""tree"":[]}",2
"{""code"":""C07C231/00"",""first"":false,""inventive"":true,""tree"":[]}",2
"{""code"":""C07D521/00"",""first"":false,""inventive"":true,""tree"":[]}",2
"{""code"":""C09K15/30"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""E02D5/38"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""G21C5/10"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""E02D5/54"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""A01N47/36"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""G21C1/02"",""first"":true,""inventive"":true,""tree"":[]}",1
"{""code"":""A01N43/54"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C07C233/75"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C07D235/12"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C07D519/02"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""E02D5/80"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B21D25/00"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C07D213/56"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C07D213/32"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""E21B27/02"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C07C235/56"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B63B59/04"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""G11B15/62"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""G01N27/22"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C07D239/47"",""first"":true,""inventive"":true,""tree"":[]}",1
"{""code"":""C10M133/48"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C10C1/00"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B22D11/00"",""first"":true,""inventive"":true,""tree"":[]}",1
"{""code"":""A61K31/275"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B01D37/02"",""first"":false,""inventive"":false,""tree"":[]}",1
"{""code"":""E04D13/16"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C07J63/00"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C08K5/46"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C08K5/3447"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C07D213/22"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""E06B3/30"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""G05F3/24"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""H01L27/092"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""G04G19/06"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B65D17/00"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B41J2/18"",""first"":true,""inventive"":true,""tree"":[]}",1
"{""code"":""C11D/"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""A61K31/55"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""H03C3/06"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C07C237/40"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B29C49/30"",""first"":true,""inventive"":true,""tree"":[]}",1
"{""code"":""E21B17/01"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C07D499/12"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B63B35/44"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B01D25/26"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""E04B1/90"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""H01M50/529"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""H04B1/16"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""A61K31/585"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B22D11/08"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C11D1/66"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B65D17/34"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""C07D471/22"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B65D85/34"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""F02M53/04"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B65D43/02"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B21D39/03"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""B63H9/06"",""first"":true,""inventive"":true,""tree"":[]}",1
"{""code"":""F24S10/70"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""A61K31/58"",""first"":false,""inventive"":true,""tree"":[]}",1
"{""code"":""E02D7/28"",""first"":f
Query:
SELECT "level", COUNT(*) AS "Count"
FROM PATENTS.PATENTS.CPC_DEFINITION
GROUP BY "level"
ORDER BY "level"
LIMIT 100
Answer:
level,Count
2.0,9
4.0,137
5.0,677
7.0,9816
8.0,48384
9.0,70250
10.0,62585
11.0,35084
12.0,17632
13.0,8015
14.0,3649
15.0,1521
16.0,1223
17.0,720
18.0,485
19.0,621
Query:
SELECT c.VALUE::STRING AS "CPC_Symbol",
       COUNT(*) AS "Publication_Count"
FROM PATENTS.PATENTS.PUBLICATIONS p,
     LATERAL FLATTEN(input => p."cpc") c
GROUP BY c.VALUE::STRING
ORDER BY "Publication_Count" DESC
LIMIT 100;
Answer:
Too long, hard cut:
CPC_Symbol,Publication_Count
"{""code"":""Y02E60/10"",""first"":false,""inventive"":false,""tree"":[]}",5576
"{""code"":""A61P35/00"",""first"":false,""inventive"":true,""tree"":[]}",5308
"{""code"":""A61P43/00"",""first"":false,""inventive"":true,""tree"":[]}",3789
"{""code"":""A61K45/06"",""first"":false,""inventive"":true,""tree"":[]}",2696
"{""code"":""Y02P70/50"",""first"":false,""inventive"":false,""tree"":[]}",2621
"{""code"":""A61P29/00"",""first"":false,""inventive"":true,""tree"":[]}",2536
"{""code"":""A61K38/00"",""first"":false,""inventive"":false,""tree"":[]}",2221
"{""code"":""A61P25/00"",""first"":false,""inventive"":true,""tree"":[]}",2112
"{""code"":""A61K2039/505"",""first"":false,""inventive"":false,""tree"":[]}",1915
"{""code"":""Y02T10/12"",""first"":false,""inventive"":false,""tree"":[]}",1834
"{""code"":""Y02E10/50"",""first"":false,""inventive"":false,""tree"":[]}",1825
"{""code"":""A23V2002/00"",""first"":false,""inventive"":false,""tree"":[]}",1817
"{""code"":""Y02T10/70"",""first"":false,""inventive"":false,""tree"":[]}",1777
"{""code"":""H01L2924/0002"",""first"":false,""inventive"":false,""tree"":[]}",1714
"{""code"":""Y02E60/50"",""first"":false,""inventive"":false,""tree"":[]}",1668
"{""code"":""A61P25/28"",""first"":false,""inventive"":true,""tree"":[]}",1662
"{""code"":""Y02A50/30"",""first"":false,""inventive"":false,""tree"":[]}",1659
"{""code"":""Y02D30/70"",""first"":false,""inventive"":false,""tree"":[]}",1618
"{""code"":""A61P9/00"",""first"":false,""inventive"":true,""tree"":[]}",1587
"{""code"":""A61P9/10"",""first"":false,""inventive"":true,""tree"":[]}",1481
"{""code"":""A61P31/04"",""first"":false,""inventive"":true,""tree"":[]}",1459
"{""code"":""A61P3/10"",""first"":false,""inventive"":true,""tree"":[]}",1445
"{""code"":""H01L2224/48091"",""first"":false,""inventive"":false,""tree"":[]}",1339
"{""code"":""A61P11/00"",""first"":false,""inventive"":true,""tree"":[]}",1294
"{""code"":""A61P17/00"",""first"":false,""inventive"":true,""tree"":[]}",1281
"{""code"":""H01M10/0525"",""first"":false,""inventive"":true,""tree"":[]}",1205
"{""code"":""G06N3/08"",""first"":false,""inventive"":true,""tree"":[]}",1186
"{""code"":""A61P19/02"",""first"":false,""inventive"":true,""tree"":[]}",1170
"{""code"":""C07K2317/92"",""first"":false,""inventive"":false,""tree"":[]}",1147
"{""code"":""Y02D10/00"",""first"":false,""inventive"":false,""tree"":[]}",1128
"{""code"":""F21Y2115/10"",""first"":false,""inventive"":false,""tree"":[]}",1115
"{""code"":""Y02P10/20"",""first"":false,""inventive"":false,""tree"":[]}",1096
"{""code"":""C07K2317/76"",""first"":false,""inventive"":false,""tree"":[]}",1094
"{""code"":""Y02P70/10"",""first"":false,""inventive"":false,""tree"":[]}",1088
"{""code"":""A61Q19/00"",""first"":false,""inventive"":true,""tree"":[]}",1074
"{""code"":""H04N19/176"",""first"":false,""inventive"":true,""tree"":[]}",1064
"{""code"":""C07K2317/24"",""first"":false,""inventive"":false,""tree"":[]}",1061
"{""code"":""A61K9/0019"",""first"":false,""inventive"":true,""tree"":[]}",1043
"{""code"":""Y02T10/7072"",""first"":false,""inventive"":false,""tree"":[]}",1037
"{""code"":""G06N20/00"",""first"":false,""inventive"":true,""tree"":[]}",1035
"{""code"":""C07D401/14"",""first"":false,""inventive"":true,""tree"":[]}",1029
"{""code"":""A61P35/02"",""first"":false,""inventive"":true,""tree"":[]}",1023
"{""code"":""A61P1/04"",""first"":false,""inventive"":true,""tree"":[]}",1012
"{""code"":""A61P31/12"",""first"":false,""inventive"":true,""tree"":[]}",1006
"{""code"":""Y02T10/40"",""first"":false,""inventive"":false,""tree"":[]}",1000
"{""code"":""A61P27/02"",""first"":false,""inventive"":true,""tree"":[]}",990
"{""code"":""C07D401/12"",""first"":false,""inventive"":true,""tree"":[]}",985
"{""code"":""A61P37/00"",""first"":false,""inventive"":true,""tree"":[]}",973
"{""code"":""Y02E10/72"",""first"":false,""inventive"":false,""tree"":[]}",972
"{""code"":""Y02E30/30"",""first"":false,""inventive"":false,""tree"":[]}",953
"{""code"":""A61P1/00"",""first"":false,""inventive"":true,""tree"":[]}",945
"{""code"":""C07D471/04"",""first"":false,""inventive"":true,""tree"":[]}",944
"{""code"":""A61P31/00"",""first"":false,""inventive"":true,""tree"":[]}",887
"{""code"":""A61P37/06"",""first"":false,""inventive"":true,""tree"":[]}",885
"{""code"":""A61P37/02"",""first"":false,""inventive"":true,""tree"":[]}",877
"{""code"":""A61P13/12"",""first"":false,""inventive"":true,""tree"":[]}",876
"{""code"":""A61P1/16"",""first"":false,""inventive"":true,""tree"":[]}",872
"{""code"":""C07K2319/00"",""first"":false,""inventive"":false,""tree"":[]}",857
"{""code"":""G06N3/045"",""first"":false,""inventive"":true,""tree"":[]}",857
"{""code"":""H01M2220/20"",""first"":false,""inventive"":false,""tree"":[]}",848
"{""code"":""B32B7/12"",""first"":false,""inventive"":true,""tree"":[]}",835
"{""code"":""C07D487/04"",""first"":false,""inventive"":true,""tree"":[]}",828
"{""code"":""B32B27/08"",""first"":f
Query:
SELECT "symbol" AS "CPC_Symbol", CAST("parents" AS STRING) AS "Parent_Groups"
FROM PATENTS.PATENTS.CPC_DEFINITION
LIMIT 100
Answer:
CPC_Symbol,Parent_Groups
B,[]
H,[]
Y,[]
D,[]
F,[]
E,[]
C,[]
G,[]
A,[]
A45,"[""A""]"
A24,"[""A""]"
A61,"[""A""]"
A63,"[""A""]"
A22,"[""A""]"
A42,"[""A""]"
A99,"[""A""]"
A43,"[""A""]"
A01,"[""A""]"
A62,"[""A""]"
A23,"[""A""]"
A47,"[""A""]"
A46,"[""A""]"
A44,"[""A""]"
A21,"[""A""]"
A41,"[""A""]"
B27,"[""B""]"
B68,"[""B""]"
B04,"[""B""]"
B23,"[""B""]"
B30,"[""B""]"
B21,"[""B""]"
B25,"[""B""]"
B99,"[""B""]"
B29,"[""B""]"
B31,"[""B""]"
B26,"[""B""]"
B66,"[""B""]"
B02,"[""B""]"
B65,"[""B""]"
B61,"[""B""]"
B24,"[""B""]"
B06,"[""B""]"
B43,"[""B""]"
B62,"[""B""]"
B64,"[""B""]"
B22,"[""B""]"
B28,"[""B""]"
B09,"[""B""]"
B01,"[""B""]"
B63,"[""B""]"
B60,"[""B""]"
B44,"[""B""]"
B07,"[""B""]"
B08,"[""B""]"
B82,"[""B""]"
B42,"[""B""]"
B32,"[""B""]"
B81,"[""B""]"
B05,"[""B""]"
B41,"[""B""]"
B03,"[""B""]"
B67,"[""B""]"
B33,"[""B""]"
C22,"[""C""]"
C23,"[""C""]"
C06,"[""C""]"
C02,"[""C""]"
C07,"[""C""]"
C25,"[""C""]"
C30,"[""C""]"
C12,"[""C""]"
C99,"[""C""]"
C05,"[""C""]"
C40,"[""C""]"
C11,"[""C""]"
C08,"[""C""]"
C10,"[""C""]"
C21,"[""C""]"
C04,"[""C""]"
C09,"[""C""]"
C03,"[""C""]"
C13,"[""C""]"
C14,"[""C""]"
C01,"[""C""]"
D02,"[""D""]"
D21,"[""D""]"
D04,"[""D""]"
D07,"[""D""]"
D01,"[""D""]"
D10,"[""D""]"
D99,"[""D""]"
D06,"[""D""]"
D03,"[""D""]"
D05,"[""D""]"
E05,"[""E""]"
E21,"[""E""]"
E04,"[""E""]"
E99,"[""E""]"
E06,"[""E""]"
E02,"[""E""]"
Query:
SELECT DISTINCT c.VALUE::STRING AS "IPC_Symbol"
FROM (
    SELECT *
    FROM PATENTS.PATENTS.PUBLICATIONS
    LIMIT 100
) p,
LATERAL FLATTEN(input => p."ipc") c
LIMIT 100
Answer:
Too long, hard cut:
IPC_Symbol
"{""code"":""G01N21/01"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C10C1/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H02M5/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A01N43/54"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A01N47/36"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07D239/47"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A01K61/00"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A01K63/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""E21B27/02"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07D471/16"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C03C4/12"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C08K5/47"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C10M133/44"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C10M133/48"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C08K5/35"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C11B5/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C10L1/14"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C10M135/36"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C09K15/30"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C08K5/3447"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""E02D5/80"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""E02D7/28"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""E02D7/26"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07D213/56"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07D213/22"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C12H1/14"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G11B15/22"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G11B15/62"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B21D25/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B29C41/14"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H04H20/88"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""H03D3/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G05F3/24"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01L27/088"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G04G19/06"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B65D51/22"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B65D41/32"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""D01H4/32"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B21D39/03"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B41J2/18"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""F24S10/70"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07J63/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07C67/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07C231/12"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G03F7/032"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""C07D213/51"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G11B23/093"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C08G59/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B21D37/14"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B65D17/34"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B41J2/175"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C06B21/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07D233/61"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""C07C231/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07C317/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07D499/04"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""F25D25/02"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""F24S90/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""F25J3/02"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07C233/64"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07J19/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B64C1/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A47J27/16"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B23D23/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""C07D521/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G21C1/02"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""C07D471/22"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G01N27/22"",""first"":fa
Query:
SELECT MIN(TRY_TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD')) AS "Earliest_Publication_Date",
       MAX(TRY_TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD')) AS "Latest_Publication_Date"
FROM PATENTS.PATENTS.PUBLICATIONS
WHERE TRY_TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
Answer:
Earliest_Publication_Date,Latest_Publication_Date
1837-07-31,2024-09-05
Query:
SELECT TO_VARCHAR(TRY_TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "Year",
       COUNT("publication_number") AS "Total_Publications"
FROM PATENTS.PATENTS.PUBLICATIONS
WHERE TRY_TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
GROUP BY "Year"
ORDER BY "Year"
LIMIT 100
Answer:
Year,Total_Publications
1837,2
1839,2
1841,4
1842,5
1843,2
1844,3
1845,1
1846,2
1847,3
1848,2
1849,1
1850,2
1851,1
1852,1
1853,4
1854,3
1855,4
1856,6
1857,3
1858,16
1859,15
1860,13
1861,12
1862,7
1863,12
1864,11
1865,12
1866,26
1867,18
1868,17
1869,25
1870,35
1871,34
1872,28
1873,27
1874,30
1875,26
1876,33
1877,33
1878,54
1879,72
1880,57
1881,76
1882,112
1883,101
1884,99
1885,103
1886,100
1887,96
1888,102
1889,112
1890,111
1891,100
1892,125
1893,93
1894,100
1895,97
1896,84
1897,102
1898,81
1899,84
1900,162
1901,86
1902,94
1903,133
1904,135
1905,112
1906,149
1907,203
1908,192
1909,169
1910,133
1911,137
1912,189
1913,279
1914,351
1915,220
1916,163
1917,147
1918,142
1919,160
1920,183
1921,189
1922,235
1923,231
1924,216
1925,252
1926,235
1927,244
1928,243
1929,259
1930,335
1931,319
1932,335
1933,259
1934,265
1935,296
1936,351
1937,322
1938,334
Query:
SELECT p."publication_number", t.VALUE['text']::STRING AS "Title",
       c.VALUE::STRING AS "IPC_Symbol"
FROM (
    SELECT *
    FROM PATENTS.PATENTS.PUBLICATIONS
    LIMIT 100
) p,
LATERAL FLATTEN(input => p."title_localized") t,
LATERAL FLATTEN(input => p."ipc") c
WHERE t.VALUE['text'] IS NOT NULL AND c.VALUE IS NOT NULL
LIMIT 100
Answer:
Too long, hard cut:
publication_number,Title,IPC_Symbol
CR-5634-A,Procedimiento para el analisis de aflatoxinas por cromatografia directa,"{""code"":""G01N21/01"",""first"":false,""inventive"":true,""tree"":[]}"
FI-429-A,Förbättringar af tjärbränningsugnar med rörledning för trädestillation,"{""code"":""C10C1/00"",""first"":false,""inventive"":true,""tree"":[]}"
HK-6083-A,A new or improved alternating current control device,"{""code"":""H02M5/00"",""first"":false,""inventive"":true,""tree"":[]}"
HU-T52763-A,Herbicide and growth-controlling compositions containing sulfonyl-urea derivatives as active components and process for producing the active components,"{""code"":""A01N43/54"",""first"":false,""inventive"":true,""tree"":[]}"
HU-T52763-A,Herbicide and growth-controlling compositions containing sulfonyl-urea derivatives as active components and process for producing the active components,"{""code"":""A01N47/36"",""first"":false,""inventive"":true,""tree"":[]}"
HU-T52763-A,Herbicide and growth-controlling compositions containing sulfonyl-urea derivatives as active components and process for producing the active components,"{""code"":""C07D239/47"",""first"":true,""inventive"":true,""tree"":[]}"
HU-T52763-A,Herbicide and growth-controlling compositions containing sulfonyl-urea derivatives as active components and process for producing the active components,"{""code"":""C07D521/00"",""first"":false,""inventive"":true,""tree"":[]}"
JP-H03206829-A,Artificial algal fish bank for fishery,"{""code"":""A01K61/00"",""first"":true,""inventive"":true,""tree"":[]}"
JP-H03206829-A,Artificial algal fish bank for fishery,"{""code"":""A01K63/00"",""first"":false,""inventive"":true,""tree"":[]}"
JP-H03206829-A,人工漁業藻礁,"{""code"":""A01K61/00"",""first"":true,""inventive"":true,""tree"":[]}"
JP-H03206829-A,人工漁業藻礁,"{""code"":""A01K63/00"",""first"":false,""inventive"":true,""tree"":[]}"
JP-S62159089-A,Core support mechanism for tank type fast breeder reactor,"{""code"":""G21C5/10"",""first"":false,""inventive"":true,""tree"":[]}"
JP-S62159089-A,Core support mechanism for tank type fast breeder reactor,"{""code"":""G21C1/02"",""first"":true,""inventive"":true,""tree"":[]}"
JP-S62159089-A,タンク型高速増殖炉用炉心支持機構,"{""code"":""G21C5/10"",""first"":false,""inventive"":true,""tree"":[]}"
JP-S62159089-A,タンク型高速増殖炉用炉心支持機構,"{""code"":""G21C1/02"",""first"":true,""inventive"":true,""tree"":[]}"
US-2528225-A,Well clay dumper,"{""code"":""E21B27/02"",""first"":false,""inventive"":true,""tree"":[]}"
AT-A41580-A,Verfahren zum vollkontinuierlichen strang- giessen schmelzfluessiger metalle,"{""code"":""B22D11/08"",""first"":false,""inventive"":true,""tree"":[]}"
AT-A47682-A,"Verfahren zur herstellung von neuen 2, 4, 8-triazaphenalenium-salzen sowie von deren geometrischen und optischen isomeren","{""code"":""C07D471/22"",""first"":false,""inventive"":true,""tree"":[]}"
AT-A47682-A,"Verfahren zur herstellung von neuen 2, 4, 8-triazaphenalenium-salzen sowie von deren geometrischen und optischen isomeren","{""code"":""C07D471/16"",""first"":false,""inventive"":true,""tree"":[]}"
AT-A63682-A,"Verfahren zur bestimmung des strukturellen aufbaus von medien, die sich aus strukturelementen zusammensetzen","{""code"":""G01N27/22"",""first"":false,""inventive"":true,""tree"":[]}"
CA-920790-A,Photoluminescent glass and method of making the same,"{""code"":""C03C4/12"",""first"":false,""inventive"":true,""tree"":[]}"
CA-950907-A,"Azole compounds, processes for their manufacture and their use","{""code"":""C08K5/47"",""first"":false,""inventive"":true,""tree"":[]}"
CA-950907-A,"Azole compounds, processes for their manufacture and their use","{""code"":""C10M133/44"",""first"":false,""inventive"":true,""tree"":[]}"
CA-950907-A,"Azole compounds, processes for their manufacture and their use","{""code"":""C07D263/56"",""first"":false,""inventive"":true,""tree"":[]}"
CA-950907-A,"Azole compounds, processes for their manufacture and their use","{""code"":""C07D277/64"",""first"":false,""inventive"":true,""tree"":[]}"
CA-950907-A,"Azole compounds, processes for their manufacture and their use","{""code"":""C08K5/46"",""first"":false,""inventive"":true,""tree"":[]}"
CA-950907-A,"Azole compounds, processes for their manufacture and their use","{""code"":""C10M133/48"",""first"":false,""inventive"":true,""tree"":[]}"
CA-950907-A,"Azole compounds, processes for their manufacture and their use","{""code"":""C08K5/35"",""first"":false,""inventive"":true,""tree"":[]}"
CA-950907-A,"Azole compounds, processes for their manufacture and their use","{""code"":""C11B5/00"",""first"":false,""inventive"":true,""tree"":[]}"
CA-950907-A,"Azole compounds, processes for their manufacture and their use","{""code"":""C10L1/14"",""first"":false,""inventive"":true,""tree"":[]}"
CA-950907-A,"Azole compounds, processes for their manufacture and their use","{""code"":""C10M135/36"",""first"":false,""inventive"":true,""tree"":[]}"
CA-950907-A,"Azole compounds, processes for their manufacture and their use","{""code"
Query:
SELECT p."publication_number", COUNT(c.VALUE) AS "IPC_Count"
FROM (
    SELECT *
    FROM PATENTS.PATENTS.PUBLICATIONS
    LIMIT 100
) p,
LATERAL FLATTEN(input => p."ipc") c
GROUP BY p."publication_number"
ORDER BY "IPC_Count" DESC
LIMIT 100
Answer:
publication_number,IPC_Count
PH-23905-A,27
BE-868080-A,19
BE-823416-A,15
CA-950907-A,13
PH-17928-A,11
BE-804534-A,8
YU-94082-A,8
BE-833811-A,8
HK-52284-A,7
BE-869056-A,7
CH-540255-A,6
AT-A134275-A,6
BE-873394-A,6
HK-55992-A,5
AT-A404675-A,5
US-4234270-A,5
BE-866723-A,5
CA-920830-A,5
BE-877768-A,4
HU-T52763-A,4
TR-26506-A,4
HK-39487-A,4
FR-1474468-A,4
BE-837857-A,3
AT-A179178-A,3
BE-885287-A,3
BE-853553-A,3
BE-857395-A,3
BE-509322-A,3
AT-A205780-A,3
AT-A876472-A,3
HK-60178-A,3
PH-15213-A,3
BE-806687-A,3
BE-848755-A,3
OA-08399-A,3
JP-H06198910-A,3
JP-S62159089-A,2
AT-A47682-A,2
AT-A735378-A,2
AT-A482077-A,2
BE-861199-A,2
BE-868938-A,2
AT-A272073-A,2
YU-53588-A,2
OA-07542-A,2
JP-H03206829-A,2
MA-42286-A,2
GB-307790-A,2
AT-A906278-A,2
FR-1478988-A,2
HK-82486-A,2
HU-T58725-A,2
BE-813367-A,2
AT-A269985-A,1
BE-840231-A,1
JP-S62157892-A,1
AT-A519575-A,1
AT-A312885-A,1
FR-1485992-A,1
GB-873984-A,1
US-2528225-A,1
AT-A196182-A,1
PH-11723-A,1
FI-429-A,1
AT-A160683-A,1
CA-920790-A,1
BE-837312-A,1
FR-1444995-A,1
AT-A710279-A,1
AT-A41580-A,1
HK-6083-A,1
FR-1508237-A,1
AT-A245590-A,1
BE-871421-A,1
AT-A63682-A,1
BE-852837-A,1
GB-893001-A,1
BE-825816-A,1
AT-A250686-A,1
CR-5634-A,1
GB-534192-A,1
AT-A168281-A,1
FR-1487706-A,1
FR-1334211-A,1
YU-24971-A,1
AT-A202882-A,1
Query:
SELECT "symbol" AS "CPC_Symbol", CAST("childGroups" AS STRING) AS "Child_Groups"
FROM PATENTS.PATENTS.CPC_DEFINITION
LIMIT 100
Answer:
CPC_Symbol,Child_Groups
B,"[{""description"":""SEPARATING; MIXING"",""symbols"":[""B01"",""B02"",""B03"",""B04"",""B05"",""B06"",""B07"",""B08"",""B09""]},{""description"":""SHAPING"",""symbols"":[""B21"",""B22"",""B23"",""B24"",""B25"",""B26"",""B27"",""B28"",""B29"",""B30"",""B31"",""B32"",""B33""]},{""description"":""PRINTING"",""symbols"":[""B41"",""B42"",""B43"",""B44""]},{""description"":""TRANSPORTING"",""symbols"":[""B60"",""B61"",""B62"",""B63"",""B64"",""B65"",""B66"",""B67"",""B68""]},{""description"":""MICROSTRUCTURAL TECHNOLOGY; NANOTECHNOLOGY"",""symbols"":[""B81"",""B82""]},{""description"":"""",""symbols"":[""B99""]}]"
H,"[{""description"":"""",""symbols"":[""H01"",""H02"",""H03"",""H04"",""H05"",""H10"",""H99""]}]"
Y,"[{""description"":"""",""symbols"":[""Y02"",""Y04"",""Y10""]}]"
D,"[{""description"":""TEXTILES OR FLEXIBLE MATERIALS NOT OTHERWISE PROVIDED FOR"",""symbols"":[""D01"",""D02"",""D03"",""D04"",""D05"",""D06"",""D07"",""D10""]},{""description"":""PAPER"",""symbols"":[""D21""]},{""description"":"""",""symbols"":[""D99""]}]"
F,"[{""description"":""ENGINES OR PUMPS"",""symbols"":[""F01"",""F02"",""F03"",""F04"",""F05""]},{""description"":""ENGINEERING IN GENERAL"",""symbols"":[""F15"",""F16"",""F17""]},{""description"":""LIGHTING; HEATING"",""symbols"":[""F21"",""F22"",""F23"",""F24"",""F25"",""F26"",""F27"",""F28""]},{""description"":""WEAPONS; BLASTING"",""symbols"":[""F41"",""F42""]},{""description"":"""",""symbols"":[""F99""]}]"
E,"[{""description"":""BUILDING"",""symbols"":[""E01"",""E02"",""E03"",""E04"",""E05"",""E06""]},{""description"":""EARTH DRILLING; MINING"",""symbols"":[""E21""]},{""description"":"""",""symbols"":[""E99""]}]"
C,"[{""description"":""CHEMISTRY"",""symbols"":[""C01"",""C02"",""C03"",""C04"",""C05"",""C06"",""C07"",""C08"",""C09"",""C10"",""C11"",""C12"",""C13"",""C14""]},{""description"":""METALLURGY"",""symbols"":[""C21"",""C22"",""C23"",""C25"",""C30""]},{""description"":""COMBINATORIAL TECHNOLOGY"",""symbols"":[""C40""]},{""description"":"""",""symbols"":[""C99""]}]"
G,"[{""description"":""INSTRUMENTS"",""symbols"":[""G01"",""G02"",""G03"",""G04"",""G05"",""G06"",""G07"",""G08"",""G09"",""G10"",""G11"",""G12""]},{""description"":"""",""symbols"":[""G16""]},{""description"":""NUCLEONICS"",""symbols"":[""G21""]},{""description"":"""",""symbols"":[""G99""]}]"
A,"[{""description"":""AGRICULTURE"",""symbols"":[""A01""]},{""description"":""FOODSTUFFS; TOBACCO"",""symbols"":[""A21"",""A22"",""A23"",""A24""]},{""description"":""PERSONAL OR DOMESTIC ARTICLES"",""symbols"":[""A41"",""A42"",""A43"",""A44"",""A45"",""A46"",""A47""]},{""description"":""HEALTH; AMUSEMENT"",""symbols"":[""A61"",""A62"",""A63""]},{""description"":"""",""symbols"":[""A99""]}]"
A45,[]
A24,[]
A61,[]
A63,[]
A22,[]
A42,[]
A99,[]
A43,[]
A01,[]
A62,[]
A23,[]
A47,[]
A46,[]
A44,[]
A21,[]
A41,[]
B27,[]
B68,[]
B04,[]
B23,[]
B30,[]
B21,[]
B25,[]
B99,[]
B29,[]
B31,[]
B26,[]
B66,[]
B02,[]
B65,[]
B61,[]
B24,[]
B06,[]
B43,[]
B62,[]
B64,[]
B22,[]
B28,[]
B09,[]
B01,[]
B63,[]
B60,[]
B44,[]
B07,[]
B08,[]
B82,[]
B42,[]
B32,[]
B81,[]
B05,[]
B41,[]
B03,[]
B67,[]
B33,[]
C22,[]
C23,[]
C06,[]
C02,[]
C07,[]
C25,[]
C30,[]
C12,[]
C99,[]
C05,[]
C40,[]
C11,[]
C08,[]
C10,[]
C21,[]
C04,[]
C09,[]
C03,[]
C13,[]
C14,[]
C01,[]
D02,[]
D21,[]
D04,[]
D07,[]
D01,[]
D10,[]
D99,[]
D06,[]
D03,[]
D05,[]
E05,[]
E21,[]
E04,[]
E99,[]
E06,[]
E02,[]
Query:
SELECT c.VALUE::STRING AS "IPC_Symbol",
       TO_VARCHAR(TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "Year",
       COUNT(p."publication_number") AS "Publication_Count"
FROM (
    SELECT *
    FROM PATENTS.PATENTS.PUBLICATIONS
    LIMIT 100
) p,
LATERAL FLATTEN(input => p."ipc") c
WHERE c.VALUE::STRING IS NOT NULL AND c.VALUE::STRING <> ''
  AND TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
GROUP BY c.VALUE::STRING, "Year"
ORDER BY "IPC_Symbol", "Year"
LIMIT 100
Answer:
Too long, hard cut:
IPC_Symbol,Year,Publication_Count
"{""code"":""A01G9/02"",""first"":false,""inventive"":true,""tree"":[]}",1979,1
"{""code"":""A01K61/00"",""first"":true,""inventive"":true,""tree"":[]}",1991,1
"{""code"":""A01K63/00"",""first"":false,""inventive"":true,""tree"":[]}",1991,1
"{""code"":""A01N43/54"",""first"":false,""inventive"":true,""tree"":[]}",1990,1
"{""code"":""A01N43/90"",""first"":true,""inventive"":true,""tree"":[]}",1992,1
"{""code"":""A01N47/36"",""first"":false,""inventive"":true,""tree"":[]}",1990,1
"{""code"":""A23L3/00"",""first"":false,""inventive"":true,""tree"":[]}",1976,1
"{""code"":""A23L3/10"",""first"":false,""inventive"":true,""tree"":[]}",1976,1
"{""code"":""A43B23/08"",""first"":false,""inventive"":true,""tree"":[]}",1979,1
"{""code"":""A43B5/00"",""first"":false,""inventive"":true,""tree"":[]}",1979,1
"{""code"":""A47B31/02"",""first"":false,""inventive"":true,""tree"":[]}",1976,1
"{""code"":""A47B73/00"",""first"":false,""inventive"":true,""tree"":[]}",1979,1
"{""code"":""A47B87/02"",""first"":false,""inventive"":true,""tree"":[]}",1979,1
"{""code"":""A47B88/00"",""first"":false,""inventive"":true,""tree"":[]}",1988,1
"{""code"":""A47J27/16"",""first"":false,""inventive"":true,""tree"":[]}",1976,1
"{""code"":""A47J39/00"",""first"":false,""inventive"":true,""tree"":[]}",1976,1
"{""code"":""A47J39/02"",""first"":false,""inventive"":true,""tree"":[]}",1976,1
"{""code"":""A61K31/165"",""first"":false,""inventive"":true,""tree"":[]}",1989,1
"{""code"":""A61K31/275"",""first"":false,""inventive"":true,""tree"":[]}",1989,1
"{""code"":""A61K31/357"",""first"":false,""inventive"":true,""tree"":[]}",1985,1
"{""code"":""A61K31/36"",""first"":false,""inventive"":true,""tree"":[]}",1985,1
"{""code"":""A61K31/40"",""first"":false,""inventive"":true,""tree"":[]}",1985,1
"{""code"":""A61K31/415"",""first"":false,""inventive"":true,""tree"":[]}",1989,1
"{""code"":""A61K31/43"",""first"":false,""inventive"":true,""tree"":[]}",1982,1
"{""code"":""A61K31/443"",""first"":false,""inventive"":true,""tree"":[]}",1985,1
"{""code"":""A61K31/445"",""first"":false,""inventive"":true,""tree"":[]}",1985,1
"{""code"":""A61K31/495"",""first"":false,""inventive"":true,""tree"":[]}",1985,1
"{""code"":""A61K31/535"",""first"":false,""inventive"":true,""tree"":[]}",1985,1
"{""code"":""A61K31/55"",""first"":false,""inventive"":true,""tree"":[]}",1985,1
"{""code"":""A61K31/58"",""first"":false,""inventive"":true,""tree"":[]}",1985,1
"{""code"":""A61K31/585"",""first"":false,""inventive"":true,""tree"":[]}",1989,1
"{""code"":""A61P25/04"",""first"":false,""inventive"":true,""tree"":[]}",1985,1
"{""code"":""A61P25/08"",""first"":false,""inventive"":true,""tree"":[]}",1989,1
"{""code"":""A61P31/04"",""first"":false,""inventive"":true,""tree"":[]}",1982,1
"{""code"":""A63B29/02"",""first"":false,""inventive"":true,""tree"":[]}",1992,1
"{""code"":""A63B47/00"",""first"":false,""inventive"":true,""tree"":[]}",1988,1
"{""code"":""A63G21/18"",""first"":false,""inventive"":true,""tree"":[]}",1986,1
"{""code"":""B01D25/12"",""first"":false,""inventive"":true,""tree"":[]}",1981,1
"{""code"":""B01D25/26"",""first"":false,""inventive"":true,""tree"":[]}",1981,1
"{""code"":""B01D37/02"",""first"":false,""inventive"":false,""tree"":[]}",1981,1
"{""code"":""B01J23/00"",""first"":false,""inventive"":true,""tree"":[]}",1978,1
"{""code"":""B06B1/04"",""first"":false,""inventive"":true,""tree"":[]}",1978,1
"{""code"":""B21D25/00"",""first"":false,""inventive"":true,""tree"":[]}",1962,1
"{""code"":""B21D37/14"",""first"":false,""inventive"":true,""tree"":[]}",1961,1
"{""code"":""B21D39/03"",""first"":false,""inventive"":true,""tree"":[]}",1986,1
"{""code"":""B21J1/06"",""first"":false,""inventive"":true,""tree"":[]}",1980,1
"{""code"":""B21J13/08"",""first"":false,""inventive"":true,""tree"":[]}",1980,1
"{""code"":""B21J15/00"",""first"":false,""inventive"":true,""tree"":[]}",1986,1
"{""code"":""B22D11/00"",""first"":true,""inventive"":true,""tree"":[]}",1976,1
"{""code"":""B22D11/08"",""first"":false,""inventive"":true,""tree"":[]}",1981,1
"{""code"":""B22D11/16"",""first"":false,""inventive"":true,""tree"":[]}",1976,1
"{""code"":""B22D11/22"",""first"":false,""inventive"":true,""tree"":[]}",1976,1
"{""code"":""B22D41/08"",""first"":true,""inventive"":true,""tree"":[]}",1976,1
"{""code"":""B22D41/38"",""first"":false,""inventive"":true,""tree"":[]}",1976,1
"{""code"":""B23D15/02"",""first"":true,""inventive"":true,""tree"":[]}",1977,1
"{""code"":""B23D23/00"",""first"":false,""inventive"":true,""tree"":[]}",1977,1
"{""code"":""B23D35/00"",""first"":false,""inventive"":true,""tree"":[]}",1977,1
"{""code"":""B23Q3/10"",""first"":false,""inventive"":true,""tree"":[]}",1975,1
"{""code"":""B27D1/08"",""first"":false,""inventive"":true,""tree"":[]}",1977,1
"{""code"":""B29C41/14"",""first"":false,""inventive"":true,""tree"":[]}",1930,1
"{""code"":""B29C49/30"",""first"":true,""inventive"":true,""tree"":[]}",1995,1
"{""code"":""B29C49/38"",""fi
End Exploring Related Columns
Task: Identify the CPC technology areas with the highest exponential moving average of patent filings each year (smoothing factor 0.2), and provide the full title and the best year for each CPC group at level 5.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
CPC_Symbol,Full_Title,Best_Year
symbol1:str,titleFull1:str,year1:int
symbol2:str,titleFull2:str,year2:int
...
```

The table above lists the CPC technology areas at level 5 with the highest exponential moving average (EMA) of patent filings each year, using a smoothing factor of 0.2. For each CPC group, we've provided the symbol, the full title, and the best year—that is, the year with the highest number of patent filings in that group..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-27 02:01:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 02:01:40 - root - INFO - ```sql
WITH level5_cpc AS (
    SELECT
        "symbol" AS "cpc_symbol",
        "titleFull" AS "full_title"
    FROM
        PATENTS.PATENTS.CPC_DEFINITION
    WHERE
        "level" = 5
),
publication_cpc AS (
    SELECT
        p."publication_number",
        c.value:"code"::STRING AS "cpc_symbol",
        TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD') AS "publication_date",
        EXTRACT(year FROM TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD')) AS "year"
    FROM
        PATENTS.PATENTS.PUBLICATIONS p,
        LATERAL FLATTEN(input => p."cpc") c
    WHERE
        c.value:"code"::STRING IS NOT NULL
),
cpc_publications AS (
    SELECT
        pc."cpc_symbol",
        pc."year",
        pc."publication_number",
        l5."full_title"
    FROM
        publication_cpc pc
    INNER JOIN
        level5_cpc l5
    ON
        pc."cpc_symbol" = l5."cpc_symbol"
    WHERE
        pc."year" IS NOT NULL
),
annual_counts AS (
    SELECT
        cp."cpc_symbol",
        cp."full_title",
        cp."year",
        COUNT(DISTINCT cp."publication_number") AS "num_publications"
    FROM
        cpc_publications cp
    GROUP BY
        cp."cpc_symbol",
        cp."full_title",
        cp."year"
),
ordered_counts AS (
    SELECT
        ac.*,
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."year") AS "rn"
    FROM
        annual_counts ac
    ORDER BY
        ac."cpc_symbol",
        ac."year"
),
ema_calc AS (
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        CAST(oc."num_publications" AS FLOAT) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    WHERE
        oc."rn" = 1
    UNION ALL
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        0.2 * oc."num_publications" + 0.8 * ec."ema" AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    INNER JOIN
        ema_calc ec
    ON
        oc."cpc_symbol" = ec."cpc_symbol" AND oc."rn" = ec."rn" + 1
),
latest_ema AS (
    SELECT
        ec."cpc_symbol",
        ec."full_title",
        ec."year",
        ec."ema",
        ROW_NUMBER() OVER (PARTITION BY ec."cpc_symbol" ORDER BY ec."year" DESC) AS "rn"
    FROM
        ema_calc ec
),
ema_per_cpc AS (
    SELECT
        le."cpc_symbol",
        le."full_title",
        le."ema"
    FROM
        latest_ema le
    WHERE
        le."rn" = 1
),
best_years AS (
    SELECT
        ac."cpc_symbol",
        ac."full_title",
        ac."year" AS "best_year",
        ac."num_publications",
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."num_publications" DESC) AS "rn"
    FROM
        annual_counts ac
),
best_year_per_cpc AS (
    SELECT
        by."cpc_symbol",
        by."full_title",
        by."best_year"
    FROM
        best_years by
    WHERE
        by."rn" = 1
)
SELECT
    epc."cpc_symbol" AS "CPC_Symbol",
    epc."full_title" AS "Full_Title",
    byp."best_year" AS "Best_Year"
FROM
    ema_per_cpc epc
JOIN
    best_year_per_cpc byp
ON
    epc."cpc_symbol" = byp."cpc_symbol"
ORDER BY
    epc."ema" DESC NULLS LAST
LIMIT 100;
```
2025-01-27 02:01:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 02:01:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 02:01:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 02:01:41 - snowflake.connector.connection - INFO - closed
2025-01-27 02:01:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 02:01:42 - root - INFO - itercount: 1
2025-01-27 02:01:42 - root - INFO - 001003 (42000): 01b9fb59-0004-8343-0001-11c300fbcc06: SQL compilation error:
syntax error line 119 at position 8 unexpected 'by'.
syntax error line 120 at position 8 unexpected 'by'.
syntax error line 121 at position 8 unexpected 'by'.
2025-01-27 02:01:42 - root - INFO - Input sql:
WITH level5_cpc AS (
    SELECT
        "symbol" AS "cpc_symbol",
        "titleFull" AS "full_title"
    FROM
        PATENTS.PATENTS.CPC_DEFINITION
    WHERE
        "level" = 5
),
publication_cpc AS (
    SELECT
        p."publication_number",
        c.value:"code"::STRING AS "cpc_symbol",
        TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD') AS "publication_date",
        EXTRACT(year FROM TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD')) AS "year"
    FROM
        PATENTS.PATENTS.PUBLICATIONS p,
        LATERAL FLATTEN(input => p."cpc") c
    WHERE
        c.value:"code"::STRING IS NOT NULL
),
cpc_publications AS (
    SELECT
        pc."cpc_symbol",
        pc."year",
        pc."publication_number",
        l5."full_title"
    FROM
        publication_cpc pc
    INNER JOIN
        level5_cpc l5
    ON
        pc."cpc_symbol" = l5."cpc_symbol"
    WHERE
        pc."year" IS NOT NULL
),
annual_counts AS (
    SELECT
        cp."cpc_symbol",
        cp."full_title",
        cp."year",
        COUNT(DISTINCT cp."publication_number") AS "num_publications"
    FROM
        cpc_publications cp
    GROUP BY
        cp."cpc_symbol",
        cp."full_title",
        cp."year"
),
ordered_counts AS (
    SELECT
        ac.*,
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."year") AS "rn"
    FROM
        annual_counts ac
    ORDER BY
        ac."cpc_symbol",
        ac."year"
),
ema_calc AS (
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        CAST(oc."num_publications" AS FLOAT) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    WHERE
        oc."rn" = 1
    UNION ALL
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        0.2 * oc."num_publications" + 0.8 * ec."ema" AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    INNER JOIN
        ema_calc ec
    ON
        oc."cpc_symbol" = ec."cpc_symbol" AND oc."rn" = ec."rn" + 1
),
latest_ema AS (
    SELECT
        ec."cpc_symbol",
        ec."full_title",
        ec."year",
        ec."ema",
        ROW_NUMBER() OVER (PARTITION BY ec."cpc_symbol" ORDER BY ec."year" DESC) AS "rn"
    FROM
        ema_calc ec
),
ema_per_cpc AS (
    SELECT
        le."cpc_symbol",
        le."full_title",
        le."ema"
    FROM
        latest_ema le
    WHERE
        le."rn" = 1
),
best_years AS (
    SELECT
        ac."cpc_symbol",
        ac."full_title",
        ac."year" AS "best_year",
        ac."num_publications",
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."num_publications" DESC) AS "rn"
    FROM
        annual_counts ac
),
best_year_per_cpc AS (
    SELECT
        by."cpc_symbol",
        by."full_title",
        by."best_year"
    FROM
        best_years by
    WHERE
        by."rn" = 1
)
SELECT
    epc."cpc_symbol" AS "CPC_Symbol",
    epc."full_title" AS "Full_Title",
    byp."best_year" AS "Best_Year"
FROM
    ema_per_cpc epc
JOIN
    best_year_per_cpc byp
ON
    epc."cpc_symbol" = byp."cpc_symbol"
ORDER BY
    epc."ema" DESC NULLS LAST
LIMIT 100;
The error information is:
001003 (42000): 01b9fb59-0004-8343-0001-11c300fbcc06: SQL compilation error:
syntax error line 119 at position 8 unexpected 'by'.
syntax error line 120 at position 8 unexpected 'by'.
syntax error line 121 at position 8 unexpected 'by'.
Please correct it and output only 1 complete SQL query.
2025-01-27 02:02:28 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 02:02:28 - root - INFO - ```sql
WITH level5_cpc AS (
    SELECT
        "symbol" AS "cpc_symbol",
        "titleFull" AS "full_title"
    FROM
        PATENTS.PATENTS.CPC_DEFINITION
    WHERE
        "level" = 5
),
publication_cpc AS (
    SELECT
        p."publication_number",
        c.value:"code"::STRING AS "cpc_symbol",
        TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD') AS "publication_date",
        EXTRACT(year FROM TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD')) AS "year"
    FROM
        PATENTS.PATENTS.PUBLICATIONS p,
        LATERAL FLATTEN(input => p."cpc") c
    WHERE
        c.value:"code"::STRING IS NOT NULL
),
cpc_publications AS (
    SELECT
        pc."cpc_symbol",
        pc."year",
        pc."publication_number",
        l5."full_title"
    FROM
        publication_cpc pc
    INNER JOIN
        level5_cpc l5
    ON
        pc."cpc_symbol" = l5."cpc_symbol"
    WHERE
        pc."year" IS NOT NULL
),
annual_counts AS (
    SELECT
        cp."cpc_symbol",
        cp."full_title",
        cp."year",
        COUNT(DISTINCT cp."publication_number") AS "num_publications"
    FROM
        cpc_publications cp
    GROUP BY
        cp."cpc_symbol",
        cp."full_title",
        cp."year"
),
ordered_counts AS (
    SELECT
        ac.*,
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."year") AS "rn"
    FROM
        annual_counts ac
    ORDER BY
        ac."cpc_symbol",
        ac."year"
),
ema_calc AS (
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        CAST(oc."num_publications" AS FLOAT) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    WHERE
        oc."rn" = 1
    UNION ALL
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        0.2 * oc."num_publications" + 0.8 * ec."ema" AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    INNER JOIN
        ema_calc ec
    ON
        oc."cpc_symbol" = ec."cpc_symbol" AND oc."rn" = ec."rn" + 1
),
latest_ema AS (
    SELECT
        ec."cpc_symbol",
        ec."full_title",
        ec."year",
        ec."ema",
        ROW_NUMBER() OVER (PARTITION BY ec."cpc_symbol" ORDER BY ec."year" DESC) AS "rn"
    FROM
        ema_calc ec
),
ema_per_cpc AS (
    SELECT
        le."cpc_symbol",
        le."full_title",
        le."ema"
    FROM
        latest_ema le
    WHERE
        le."rn" = 1
),
best_years AS (
    SELECT
        ac."cpc_symbol",
        ac."full_title",
        ac."year" AS "best_year",
        ac."num_publications",
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."num_publications" DESC) AS "rn"
    FROM
        annual_counts ac
),
best_year_per_cpc AS (
    SELECT
        byc."cpc_symbol",
        byc."full_title",
        byc."best_year"
    FROM
        best_years byc
    WHERE
        byc."rn" = 1
)
SELECT
    epc."cpc_symbol" AS "CPC_Symbol",
    epc."full_title" AS "Full_Title",
    byp."best_year" AS "Best_Year"
FROM
    ema_per_cpc epc
JOIN
    best_year_per_cpc byp
ON
    epc."cpc_symbol" = byp."cpc_symbol"
ORDER BY
    epc."ema" DESC NULLS LAST
LIMIT 100;
```
2025-01-27 02:02:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 02:02:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 02:02:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 02:02:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-27 02:02:30 - snowflake.connector.connection - INFO - closed
2025-01-27 02:02:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 02:02:30 - root - INFO - itercount: 2
2025-01-27 02:02:30 - root - INFO - No data found for the specified query.

2025-01-27 02:02:30 - root - INFO - Input sql:
WITH level5_cpc AS (
    SELECT
        "symbol" AS "cpc_symbol",
        "titleFull" AS "full_title"
    FROM
        PATENTS.PATENTS.CPC_DEFINITION
    WHERE
        "level" = 5
),
publication_cpc AS (
    SELECT
        p."publication_number",
        c.value:"code"::STRING AS "cpc_symbol",
        TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD') AS "publication_date",
        EXTRACT(year FROM TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD')) AS "year"
    FROM
        PATENTS.PATENTS.PUBLICATIONS p,
        LATERAL FLATTEN(input => p."cpc") c
    WHERE
        c.value:"code"::STRING IS NOT NULL
),
cpc_publications AS (
    SELECT
        pc."cpc_symbol",
        pc."year",
        pc."publication_number",
        l5."full_title"
    FROM
        publication_cpc pc
    INNER JOIN
        level5_cpc l5
    ON
        pc."cpc_symbol" = l5."cpc_symbol"
    WHERE
        pc."year" IS NOT NULL
),
annual_counts AS (
    SELECT
        cp."cpc_symbol",
        cp."full_title",
        cp."year",
        COUNT(DISTINCT cp."publication_number") AS "num_publications"
    FROM
        cpc_publications cp
    GROUP BY
        cp."cpc_symbol",
        cp."full_title",
        cp."year"
),
ordered_counts AS (
    SELECT
        ac.*,
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."year") AS "rn"
    FROM
        annual_counts ac
    ORDER BY
        ac."cpc_symbol",
        ac."year"
),
ema_calc AS (
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        CAST(oc."num_publications" AS FLOAT) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    WHERE
        oc."rn" = 1
    UNION ALL
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        0.2 * oc."num_publications" + 0.8 * ec."ema" AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    INNER JOIN
        ema_calc ec
    ON
        oc."cpc_symbol" = ec."cpc_symbol" AND oc."rn" = ec."rn" + 1
),
latest_ema AS (
    SELECT
        ec."cpc_symbol",
        ec."full_title",
        ec."year",
        ec."ema",
        ROW_NUMBER() OVER (PARTITION BY ec."cpc_symbol" ORDER BY ec."year" DESC) AS "rn"
    FROM
        ema_calc ec
),
ema_per_cpc AS (
    SELECT
        le."cpc_symbol",
        le."full_title",
        le."ema"
    FROM
        latest_ema le
    WHERE
        le."rn" = 1
),
best_years AS (
    SELECT
        ac."cpc_symbol",
        ac."full_title",
        ac."year" AS "best_year",
        ac."num_publications",
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."num_publications" DESC) AS "rn"
    FROM
        annual_counts ac
),
best_year_per_cpc AS (
    SELECT
        byc."cpc_symbol",
        byc."full_title",
        byc."best_year"
    FROM
        best_years byc
    WHERE
        byc."rn" = 1
)
SELECT
    epc."cpc_symbol" AS "CPC_Symbol",
    epc."full_title" AS "Full_Title",
    byp."best_year" AS "Best_Year"
FROM
    ema_per_cpc epc
JOIN
    best_year_per_cpc byp
ON
    epc."cpc_symbol" = byp."cpc_symbol"
ORDER BY
    epc."ema" DESC NULLS LAST
LIMIT 100;
The error information is:
 No data found for the specified query.

2025-01-27 02:04:16 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 02:04:16 - root - INFO - ```sql
WITH level5_cpc AS (
    SELECT
        "symbol" AS "cpc_symbol",
        "titleFull" AS "full_title"
    FROM
        PATENTS.PATENTS.CPC_DEFINITION
    WHERE
        "level" = 5
),
publication_cpc AS (
    SELECT
        p."publication_number",
        c.value:"code"::STRING AS "cpc_symbol_full",
        TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD') AS "publication_date",
        EXTRACT(year FROM TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD')) AS "year"
    FROM
        PATENTS.PATENTS.PUBLICATIONS p,
        LATERAL FLATTEN(input => p."cpc") c
    WHERE
        c.value:"code"::STRING IS NOT NULL
        AND p."publication_date" IS NOT NULL
),
cpc_publications AS (
    SELECT
        REGEXP_SUBSTR(pc."cpc_symbol_full", '^[A-Z]\\d{2}[A-Z]+') AS "cpc_symbol",
        pc."year",
        pc."publication_number"
    FROM
        publication_cpc pc
    WHERE
        pc."year" IS NOT NULL
        AND REGEXP_SUBSTR(pc."cpc_symbol_full", '^[A-Z]\\d{2}[A-Z]+') IS NOT NULL
),
cpc_publications_with_title AS (
    SELECT
        cp."cpc_symbol",
        cp."year",
        cp."publication_number",
        l5."full_title"
    FROM
        cpc_publications cp
    INNER JOIN
        level5_cpc l5
    ON
        cp."cpc_symbol" = l5."cpc_symbol"
),
annual_counts AS (
    SELECT
        cp."cpc_symbol",
        cp."full_title",
        cp."year",
        COUNT(DISTINCT cp."publication_number") AS "num_publications"
    FROM
        cpc_publications_with_title cp
    GROUP BY
        cp."cpc_symbol",
        cp."full_title",
        cp."year"
),
ordered_counts AS (
    SELECT
        ac.*,
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."year") AS "rn"
    FROM
        annual_counts ac
    ORDER BY
        ac."cpc_symbol",
        ac."year"
),
ema_calc AS (
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        CAST(oc."num_publications" AS FLOAT) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    WHERE
        oc."rn" = 1
    UNION ALL
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        0.2 * oc."num_publications" + 0.8 * ec."ema" AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    INNER JOIN
        ema_calc ec
    ON
        oc."cpc_symbol" = ec."cpc_symbol" AND oc."rn" = ec."rn" + 1
),
latest_ema AS (
    SELECT
        ec."cpc_symbol",
        ec."full_title",
        ec."year",
        ec."ema",
        ROW_NUMBER() OVER (PARTITION BY ec."cpc_symbol" ORDER BY ec."year" DESC) AS "rn"
    FROM
        ema_calc ec
),
ema_per_cpc AS (
    SELECT
        le."cpc_symbol",
        le."full_title",
        le."ema"
    FROM
        latest_ema le
    WHERE
        le."rn" = 1
),
best_years AS (
    SELECT
        ac."cpc_symbol",
        ac."full_title",
        ac."year" AS "best_year",
        ac."num_publications",
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."num_publications" DESC) AS "rn"
    FROM
        annual_counts ac
),
best_year_per_cpc AS (
    SELECT
        byc."cpc_symbol",
        byc."full_title",
        byc."best_year"
    FROM
        best_years byc
    WHERE
        byc."rn" = 1
)
SELECT
    epc."cpc_symbol" AS "CPC_Symbol",
    epc."full_title" AS "Full_Title",
    byp."best_year" AS "Best_Year"
FROM
    ema_per_cpc epc
JOIN
    best_year_per_cpc byp
ON
    epc."cpc_symbol" = byp."cpc_symbol"
ORDER BY
    epc."ema" DESC NULLS LAST
LIMIT 100;
```
2025-01-27 02:04:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 02:04:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 02:04:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 02:04:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 02:04:18 - snowflake.connector.connection - INFO - closed
2025-01-27 02:04:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 02:04:18 - root - INFO - itercount: 3
2025-01-27 02:04:18 - root - INFO - 0
2025-01-27 02:04:18 - root - INFO - results: 
CPC_Symbol,Full_Title,Best_Year
G06F,ELECTRIC DIGITAL DATA PROCESSING,2021
Y02E,"REDUCTION OF GREENHOUSE GAS [GHG] EMISSIONS, RELATED TO ENERGY GENERATION, TRANSMISSION OR DISTRIBUTION",2023
Y02P,CLIMATE CHANGE MITIGATION TECHNOLOGIES IN THE PRODUCTION OR PROCESSING OF GOODS,2023
A61K,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",2021
H04L,"TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION",2021
H01L,SEMICONDUCTOR DEVICES NOT COVERED BY CLASS H10,2021
A61P,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2021
H04W,WIRELESS COMMUNICATION NETWORKS,2021
Y02A,TECHNOLOGIES FOR ADAPTATION TO CLIMATE CHANGE,2023
G06Q,"INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES; SYSTEMS OR METHODS SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES, NOT OTHERWISE PROVIDED FOR",2022
G01N,INVESTIGATING OR ANALYSING MATERIALS BY DETERMINING THEIR CHEMICAL OR PHYSICAL PROPERTIES,2021
H04N,"PICTORIAL COMMUNICATION, e.g. TELEVISION",2021
A61B,DIAGNOSIS; SURGERY; IDENTIFICATION,2021
G06T,"IMAGE DATA PROCESSING OR GENERATION, IN GENERAL",2021
Y02T,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,2023
G06N,COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS,2022
C12N,"MICROORGANISMS OR ENZYMES; COMPOSITIONS THEREOF; PROPAGATING, PRESERVING, OR MAINTAINING MICROORGANISMS; MUTATION OR GENETIC ENGINEERING; CULTURE MEDIA",2021
H01M,"PROCESSES OR MEANS, e.g. BATTERIES, FOR THE DIRECT CONVERSION OF CHEMICAL ENERGY INTO ELECTRICAL ENERGY",2022
G02B,"OPTICAL ELEMENTS, SYSTEMS OR APPARATUS",2021
G06V,IMAGE OR VIDEO RECOGNITION OR UNDERSTANDING,2021
Y02W,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO WASTEWATER TREATMENT OR WASTE MANAGEMENT,2023
C07K,PEPTIDES,2021
Y02B,"CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO BUILDINGS, e.g. HOUSING, HOUSE APPLIANCES OR RELATED END-USER APPLICATIONS",2023
C07D,HETEROCYCLIC COMPOUNDS,2018
B01D,SEPARATION,2018
C08L,COMPOSITIONS OF MACROMOLECULAR COMPOUNDS,2018
H04B,TRANSMISSION,2021
Y02D,"CLIMATE CHANGE MITIGATION TECHNOLOGIES IN INFORMATION AND COMMUNICATION TECHNOLOGIES [ICT], I.E. INFORMATION AND COMMUNICATION TECHNOLOGIES AIMING AT THE REDUCTION OF THEIR OWN ENERGY USE",2023
B29C,"SHAPING OR JOINING OF PLASTICS; SHAPING OF MATERIAL IN A PLASTIC STATE, NOT OTHERWISE PROVIDED FOR; AFTER-TREATMENT OF THE SHAPED PRODUCTS, e.g. REPAIRING",2018
H02J,CIRCUIT ARRANGEMENTS OR SYSTEMS FOR SUPPLYING OR DISTRIBUTING ELECTRIC POWER; SYSTEMS FOR STORING ELECTRIC ENERGY,2022
A61M,"DEVICES FOR INTRODUCING MEDIA INTO, OR ONTO, THE BODY; DEVICES FOR TRANSDUCING BODY MEDIA OR FOR TAKING MEDIA FROM THE BODY; DEVICES FOR PRODUCING OR ENDING SLEEP OR STUPOR",2021
C08K,Use of inorganic or non-macromolecular organic substances as compounding ingredients,2018
H05K,PRINTED CIRCUITS; CASINGS OR CONSTRUCTIONAL DETAILS OF ELECTRIC APPARATUS; MANUFACTURE OF ASSEMBLAGES OF ELECTRICAL COMPONENTS,2022
G01R,MEASURING ELECTRIC VARIABLES; MEASURING MAGNETIC VARIABLES,2022
G01S,RADIO DIRECTION-FINDING; RADIO NAVIGATION; DETERMINING DISTANCE OR VELOCITY BY USE OF RADIO WAVES; LOCATING OR PRESENCE-DETECTING BY USE OF THE REFLECTION OR RERADIATION OF RADIO WAVES; ANALOGOUS ARRANGEMENTS USING OTHER WAVES,2021
B01J,"CHEMICAL OR PHYSICAL PROCESSES, e.g. CATALYSIS OR COLLOID CHEMISTRY; THEIR RELEVANT APPARATUS",2018
G05B,CONTROL OR REGULATING SYSTEMS IN GENERAL; FUNCTIONAL ELEMENTS OF SUCH SYSTEMS; MONITORING OR TESTING ARRANGEMENTS FOR SUCH SYSTEMS OR ELEMENTS,2021
B32B,"LAYERED PRODUCTS, i.e. PRODUCTS BUILT-UP OF STRATA OF FLAT OR NON-FLAT, e.g. CELLULAR OR HONEYCOMB, FORM",2018
A61F,"FILTERS IMPLANTABLE INTO BLOOD VESSELS; PROSTHESES; DEVICES PROVIDING PATENCY TO, OR PREVENTING COLLAPSING OF, TUBULAR STRUCTURES OF THE BODY, e.g. STENTS; ORTHOPAEDIC, NURSING OR CONTRACEPTIVE DEVICES; FOMENTATION; TREATMENT OR PROTECTION OF EYES OR EARS; BANDAGES, DRESSINGS OR ABSORBENT PADS; FIRST-AID KITS",2020
C08G,MACROMOLECULAR COMPOUNDS OBTAINED OTHERWISE THAN BY REACTIONS ONLY INVOLVING UNSATURATED CARBON-TO-CARBON BONDS,2018
C07C,ACYCLIC OR CARBOCYCLIC COMPOUNDS,2018
C09D,"COATING COMPOSITIONS, e.g. PAINTS, VARNISHES OR LACQUERS; FILLING PASTES; CHEMICAL PAINT OR INK REMOVERS; INKS; CORRECTING FLUIDS; WOODSTAINS; PASTES OR SOLIDS FOR COLOURING OR PRINTING; USE OF MATERIALS THEREFOR",2017
H10K,ORGANIC ELECTRIC SOLID-STATE DEVICES,2021
B60R,"VEHICLES, VEHICLE FITTINGS, OR VEHICLE PARTS, NOT OTHERWISE PROVIDED FOR",2021
Y10T,TECHNICAL SUBJECTS COVERED BY FORMER US CLASSIFICATION,2014
A23L,"FOODS, FOODSTUFFS, OR NON-ALCOHOLIC BEVERAGES, NOT COVERED BY SUBCLASSES A21D OR A23B-A23J; THEIR PREPARATION OR TREATMENT, e.g. COOKING, MODIFICATION OF NUTRITIVE QUALITIES, PHYSICAL TREATMENT; PRESERVATION OF FOODS OR FOODSTUFFS, IN GENERAL",2018
C02F,"TREATMENT OF WATER, WASTE WATER, SEWAGE, OR SLUDGE",2018
B65D,"CONTAINERS FOR STORAGE OR TRANSPORT OF ARTICLES OR MATERIALS, e.g. BAGS, BARRELS, BOTTLES, BOXES, CANS, CARTONS, CRATES, DRUMS, JARS, TANKS, HOPPERS, FORWARDING CONTAINERS; ACCESSORIES, CLOSURES, OR FITTINGS THEREFOR; PACKAGING ELEMENTS; PACKAGES",2018
G06K,GRAPHICAL DATA READING; PRESENTATION OF DATA; RECORD CARRIERS; HANDLING RECORD CARRIERS,2021
C08J,"WORKING-UP; GENERAL PROCESSES OF COMPOUNDING; AFTER-TREATMENT NOT COVERED BY SUBCLASSES C08B, C08C, C08F, C08G or C08H",2018
G16H,"HEALTHCARE INFORMATICS, i.e. INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR THE HANDLING OR PROCESSING OF MEDICAL OR HEALTHCARE DATA",2021
G02F,OPTICAL DEVICES OR ARRANGEMENTS FOR THE CONTROL OF LIGHT BY MODIFICATION OF THE OPTICAL PROPERTIES OF THE MEDIA OF THE ELEMENTS INVOLVED THEREIN; NON-LINEAR OPTICS; FREQUENCY-CHANGING OF LIGHT; OPTICAL LOGIC ELEMENTS; OPTICAL ANALOGUE/DIGITAL CONVERTERS,2021
C12Q,"MEASURING OR TESTING PROCESSES INVOLVING ENZYMES, NUCLEIC ACIDS OR MICROORGANISMS; COMPOSITIONS OR TEST PAPERS THEREFOR; PROCESSES OF PREPARING SUCH COMPOSITIONS; CONDITION-RESPONSIVE CONTROL IN MICROBIOLOGICAL OR ENZYMOLOGICAL PROCESSES",2021
C09K,"MATERIALS FOR MISCELLANEOUS APPLICATIONS, NOT PROVIDED FOR ELSEWHERE",2018
C23C,"COATING METALLIC MATERIAL; COATING MATERIAL WITH METALLIC MATERIAL; SURFACE TREATMENT OF METALLIC MATERIAL BY DIFFUSION INTO THE SURFACE, BY CHEMICAL CONVERSION OR SUBSTITUTION; COATING BY VACUUM EVAPORATION, BY SPUTTERING, BY ION IMPLANTATION OR BY CHEMICAL VAPOUR DEPOSITION, IN GENERAL",2018
G09G,ARRANGEMENTS OR CIRCUITS FOR CONTROL OF INDICATING DEVICES USING STATIC MEANS TO PRESENT VARIABLE INFORMATION,2021
B23K,"SOLDERING OR UNSOLDERING; WELDING; CLADDING OR PLATING BY SOLDERING OR WELDING; CUTTING BY APPLYING HEAT LOCALLY, e.g. FLAME CUTTING; WORKING BY LASER BEAM",2018
B60W,CONJOINT CONTROL OF VEHICLE SUB-UNITS OF DIFFERENT TYPE OR DIFFERENT FUNCTION; CONTROL SYSTEMS SPECIALLY ADAPTED FOR HYBRID VEHICLES; ROAD VEHICLE DRIVE CONTROL SYSTEMS FOR PURPOSES NOT RELATED TO THE CONTROL OF A PARTICULAR SUB-UNIT,2022
B65G,"TRANSPORT OR STORAGE DEVICES, e.g. CONVEYORS FOR LOADING OR TIPPING, SHOP CONVEYOR SYSTEMS OR PNEUMATIC TUBE CONVEYORS",2022
E21B,"EARTH OR ROCK DRILLING; OBTAINING OIL, GAS, WATER, SOLUBLE OR MELTABLE MATERIALS OR A SLURRY OF MINERALS FROM WELLS",2021
H02K,DYNAMO-ELECTRIC MACHINES,2020
H05B,"ELECTRIC HEATING; ELECTRIC LIGHT SOURCES NOT OTHERWISE PROVIDED FOR; CIRCUIT ARRANGEMENTS FOR ELECTRIC LIGHT SOURCES, IN GENERAL",2018
A61L,"METHODS OR APPARATUS FOR STERILISING MATERIALS OR OBJECTS IN GENERAL; DISINFECTION, STERILISATION OR DEODORISATION OF AIR; CHEMICAL ASPECTS OF BANDAGES, DRESSINGS, ABSORBENT PADS OR SURGICAL ARTICLES; MATERIALS FOR BANDAGES, DRESSINGS, ABSORBENT PADS OR SURGICAL ARTICLES",2022
B60L,PROPULSION OF ELECTRICALLY-PROPELLED VEHICLES; SUPPLYING ELECTRIC POWER FOR AUXILIARY EQUIPMENT OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRODYNAMIC BRAKE SYSTEMS FOR VEHICLES IN GENERAL; MAGNETIC SUSPENSION OR LEVITATION FOR VEHICLES; MONITORING OPERATING VARIABLES OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRIC SAFETY DEVICES FOR ELECTRICALLY-PROPELLED VEHICLES,2021
G05D,SYSTEMS FOR CONTROLLING OR REGULATING NON-ELECTRIC VARIABLES,2021
H04M,TELEPHONIC COMMUNICATION,2021
B60K,"ARRANGEMENT OR MOUNTING OF PROPULSION UNITS OR OF TRANSMISSIONS IN VEHICLES; ARRANGEMENT OR MOUNTING OF PLURAL DIVERSE PRIME-MOVERS IN VEHICLES; AUXILIARY DRIVES FOR VEHICLES; INSTRUMENTATION OR DASHBOARDS FOR VEHICLES; ARRANGEMENTS IN CONNECTION WITH COOLING, AIR INTAKE, GAS EXHAUST OR FUEL SUPPLY OF PROPULSION UNITS IN VEHICLES",2018
C08F,MACROMOLECULAR COMPOUNDS OBTAINED BY REACTIONS ONLY INVOLVING CARBON-TO-CARBON UNSATURATED BONDS,2018
H01R,ELECTRICALLY-CONDUCTIVE CONNECTIONS; STRUCTURAL ASSOCIATIONS OF A PLURALITY OF MUTUALLY-INSULATED ELECTRICAL CONNECTING ELEMENTS; COUPLING DEVICES; CURRENT COLLECTORS,2018
B62D,MOTOR VEHICLES; TRAILERS,2021
C04B,"LIME, MAGNESIA; SLAG; CEMENTS; COMPOSITIONS THEREOF, e.g. MORTARS, CONCRETE OR LIKE BUILDING MATERIALS; ARTIFICIAL STONE; CERAMICS; REFRACTORIES; TREATMENT OF NATURAL STONE",2018
G01C,"MEASURING DISTANCES, LEVELS OR BEARINGS; SURVEYING; NAVIGATION; GYROSCOPIC INSTRUMENTS; PHOTOGRAMMETRY OR VIDEOGRAMMETRY",2021
C01B,NON-METALLIC ELEMENTS; COMPOUNDS THEREOF; METALLOIDS OR COMPOUNDS THEREOF NOT COVERED BY SUBCLASS C01C,2022
A23V,"INDEXING SCHEME RELATING TO FOODS, FOODSTUFFS OR NON-ALCOHOLIC BEVERAGES AND LACTIC OR PROPIONIC ACID BACTERIA USED IN FOODSTUFFS OR FOOD PREPARATION",2017
A61Q,SPECIFIC USE OF COSMETICS OR SIMILAR TOILETRY PREPARATIONS,2018
H02M,"APPARATUS FOR CONVERSION BETWEEN AC AND AC, BETWEEN AC AND DC, OR BETWEEN DC AND DC, AND FOR USE WITH MAINS OR SIMILAR POWER SUPPLY SYSTEMS; CONVERSION OF DC OR AC INPUT POWER INTO SURGE OUTPUT POWER; CONTROL OR REGULATION THEREOF",2021
B25J,MANIPULATORS; CHAMBERS PROVIDED WITH MANIPULATION DEVICES,2021
C22C,ALLOYS,2017
G01B,"MEASURING LENGTH, THICKNESS OR SIMILAR LINEAR DIMENSIONS; MEASURING ANGLES; MEASURING AREAS; MEASURING IRREGULARITIES OF SURFACES OR CONTOURS",2022
F24F,AIR-CONDITIONING; AIR-HUMIDIFICATION; VENTILATION; USE OF AIR CURRENTS FOR SCREENING,2022
G10L,SPEECH ANALYSIS TECHNIQUES OR SPEECH SYNTHESIS; SPEECH RECOGNITION; SPEECH OR VOICE PROCESSING TECHNIQUES; SPEECH OR AUDIO CODING OR DECODING,2020
G08G,TRAFFIC CONTROL SYSTEMS,2021
B08B,CLEANING IN GENERAL; PREVENTION OF FOULING IN GENERAL,2022
G08B,SIGNALLING OR CALLING SYSTEMS; ORDER TELEGRAPHS; ALARM SYSTEMS,2022
A01N,"PRESERVATION OF BODIES OF HUMANS OR ANIMALS OR PLANTS OR PARTS THEREOF; BIOCIDES, e.g. AS DISINFECTANTS, AS PESTICIDES OR AS HERBICIDES; PEST REPELLANTS OR ATTRACTANTS; PLANT GROWTH REGULATORS",2018
F16H,GEARING,2017
G11C,STATIC STORES,2021
A01G,"HORTICULTURE; CULTIVATION OF VEGETABLES, FLOWERS, RICE, FRUIT, VINES, HOPS OR SEAWEED; FORESTRY; WATERING",2017
G01M,"TESTING STATIC OR DYNAMIC BALANCE OF MACHINES OR STRUCTURES; TESTING OF STRUCTURES OR APPARATUS, NOT OTHERWISE PROVIDED FOR",2018
H01F,MAGNETS; INDUCTANCES; TRANSFORMERS; SELECTION OF MATERIALS FOR THEIR MAGNETIC PROPERTIES,2018
F21V,"FUNCTIONAL FEATURES OR DETAILS OF LIGHTING DEVICES OR SYSTEMS THEREOF; STRUCTURAL COMBINATIONS OF LIGHTING DEVICES WITH OTHER ARTICLES, NOT OTHERWISE PROVIDED FOR",2018
H04R,"LOUDSPEAKERS, MICROPHONES, GRAMOPHONE PICK-UPS OR LIKE ACOUSTIC ELECTROMECHANICAL TRANSDUCERS; DEAF-AID SETS; PUBLIC ADDRESS SYSTEMS",2022
A61N,ELECTROTHERAPY; MAGNETOTHERAPY; RADIATION THERAPY; ULTRASOUND THERAPY,2021
A01K,"ANIMAL HUSBANDRY; AVICULTURE; APICULTURE; PISCICULTURE; FISHING; REARING OR BREEDING ANIMALS, NOT OTHERWISE PROVIDED FOR; NEW BREEDS OF ANIMALS",2018
B29L,"INDEXING SCHEME ASSOCIATED WITH SUBCLASS B29C, RELATING TO PARTICULAR ARTICLES",2018
F16L,"PIPES; JOINTS OR FITTINGS FOR PIPES; SUPPORTS FOR PIPES, CABLES OR PROTECTIVE TUBING; MEANS FOR THERMAL INSULATION IN GENERAL",2018
H01Q,"ANTENNAS, i.e. RADIO AERIALS",2021
C09J,ADHESIVES; NON-MECHANICAL ASPECTS OF ADHESIVE PROCESSES IN GENERAL; ADHESIVE PROCESSES NOT PROVIDED FOR ELSEWHERE; USE OF MATERIALS AS ADHESIVES,2021
H01J,ELECTRIC DISCHARGE TUBES OR DISCHARGE LAMPS,2021
B33Y,"ADDITIVE MANUFACTURING, i.e. MANUFACTURING OF THREE-DIMENSIONAL [3-D] OBJECTS BY ADDITIVE DEPOSITION, ADDITIVE AGGLOMERATION OR ADDITIVE LAYERING, e.g. BY 3-D PRINTING, STEREOLITHOGRAPHY OR SELECTIVE LASER SINTERING",2022


2025-01-27 02:04:18 - root - INFO - Please check the answer again by reviewing Identify the CPC technology areas with the highest exponential moving average of patent filings each year (smoothing factor 0.2), and provide the full title and the best year for each CPC group at level 5., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
CPC_Symbol,Full_Title,Best_Year
symbol1:str,titleFull1:str,year1:int
symbol2:str,titleFull2:str,year2:int
...
```

The table above lists the CPC technology areas at level 5 with the highest exponential moving average (EMA) of patent filings each year, using a smoothing factor of 0.2. For each CPC group, we've provided the symbol, the full title, and the best year—that is, the year with the highest number of patent filings in that group. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Too long, hard cut:
CPC_Symbol,Full_Title,Best_Year
G06F,ELECTRIC DIGITAL DATA PROCESSING,2021
Y02E,"REDUCTION OF GREENHOUSE GAS [GHG] EMISSIONS, RELATED TO ENERGY GENERATION, TRANSMISSION OR DISTRIBUTION",2023
Y02P,CLIMATE CHANGE MITIGATION TECHNOLOGIES IN THE PRODUCTION OR PROCESSING OF GOODS,2023
A61K,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",2021
H04L,"TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION",2021
H01L,SEMICONDUCTOR DEVICES NOT COVERED BY CLASS H10,2021
A61P,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2021
H04W,WIRELESS COMMUNICATION NETWORKS,2021
Y02A,TECHNOLOGIES FOR ADAPTATION TO CLIMATE CHANGE,2023
G06Q,"INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES; SYSTEMS OR METHODS SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES, NOT OTHERWISE PROVIDED FOR",2022
G01N,INVESTIGATING OR ANALYSING MATERIALS BY DETERMINING THEIR CHEMICAL OR PHYSICAL PROPERTIES,2021
H04N,"PICTORIAL COMMUNICATION, e.g. TELEVISION",2021
A61B,DIAGNOSIS; SURGERY; IDENTIFICATION,2021
G06T,"IMAGE DATA PROCESSING OR GENERATION, IN GENERAL",2021
Y02T,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,2023
G06N,COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS,2022
C12N,"MICROORGANISMS OR ENZYMES; COMPOSITIONS THEREOF; PROPAGATING, PRESERVING, OR MAINTAINING MICROORGANISMS; MUTATION OR GENETIC ENGINEERING; CULTURE MEDIA",2021
H01M,"PROCESSES OR MEANS, e.g. BATTERIES, FOR THE DIRECT CONVERSION OF CHEMICAL ENERGY INTO ELECTRICAL ENERGY",2022
G02B,"OPTICAL ELEMENTS, SYSTEMS OR APPARATUS",2021
G06V,IMAGE OR VIDEO RECOGNITION OR UNDERSTANDING,2021
Y02W,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO WASTEWATER TREATMENT OR WASTE MANAGEMENT,2023
C07K,PEPTIDES,2021
Y02B,"CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO BUILDINGS, e.g. HOUSING, HOUSE APPLIANCES OR RELATED END-USER APPLICATIONS",2023
C07D,HETEROCYCLIC COMPOUNDS,2018
B01D,SEPARATION,2018
C08L,COMPOSITIONS OF MACROMOLECULAR COMPOUNDS,2018
H04B,TRANSMISSION,2021
Y02D,"CLIMATE CHANGE MITIGATION TECHNOLOGIES IN INFORMATION AND COMMUNICATION TECHNOLOGIES [ICT], I.E. INFORMATION AND COMMUNICATION TECHNOLOGIES AIMING AT THE REDUCTION OF THEIR OWN ENERGY USE",2023
B29C,"SHAPING OR JOINING OF PLASTICS; SHAPING OF MATERIAL IN A PLASTIC STATE, NOT OTHERWISE PROVIDED FOR; AFTER-TREATMENT OF THE SHAPED PRODUCTS, e.g. REPAIRING",2018
H02J,CIRCUIT ARRANGEMENTS OR SYSTEMS FOR SUPPLYING OR DISTRIBUTING ELECTRIC POWER; SYSTEMS FOR STORING ELECTRIC ENERGY,2022
A61M,"DEVICES FOR INTRODUCING MEDIA INTO, OR ONTO, THE BODY; DEVICES FOR TRANSDUCING BODY MEDIA OR FOR TAKING MEDIA FROM THE BODY; DEVICES FOR PRODUCING OR ENDING SLEEP OR STUPOR",2021
C08K,Use of inorganic or non-macromolecular organic substances as compounding ingredients,2018
H05K,PRINTED CIRCUITS; CASINGS OR CONSTRUCTIONAL DETAILS OF ELECTRIC APPARATUS; MANUFACTURE OF ASSEMBLAGES OF ELECTRICAL COMPONENTS,2022
G01R,MEASURING ELECTRIC VARIABLES; MEASURING MAGNETIC VARIABLES,2022
G01S,RADIO DIRECTION-FINDING; RADIO NAVIGATION; DETERMINING DISTANCE OR VELOCITY BY USE OF RADIO WAVES; LOCATING OR PRESENCE-DETECTING BY USE OF THE REFLECTION OR RERADIATION OF RADIO WAVES; ANALOGOUS ARRANGEMENTS USING OTHER WAVES,2021
B01J,"CHEMICAL OR PHYSICAL PROCESSES, e.g. CATALYSIS OR COLLOID CHEMISTRY; THEIR RELEVANT APPARATUS",2018
G05B,CONTROL OR REGULATING SYSTEMS IN GENERAL; FUNCTIONAL ELEMENTS OF SUCH SYSTEMS; MONITORING OR TESTING ARRANGEMENTS FOR SUCH SYSTEMS OR ELEMENTS,2021
B32B,"LAYERED PRODUCTS, i.e. PRODUCTS BUILT-UP OF STRATA OF FLAT OR NON-FLAT, e.g. CELLULAR OR HONEYCOMB, FORM",2018
A61F,"FILTERS IMPLANTABLE INTO BLOOD VESSELS; PROSTHESES; DEVICES PROVIDING PATENCY TO, OR PREVENTING COLLAPSING OF, TUBULAR STRUCTURES OF THE BODY, e.g. STENTS; ORTHOPAEDIC, NURSING OR CONTRACEPTIVE DEVICES; FOMENTATION; TREATMENT OR PROTECTION OF EYES OR EARS; BANDAGES, DRESSINGS OR ABSORBENT PADS; FIRST-AID KITS",2020
C08G,MACROMOLECULAR COMPOUNDS OBTAINED OTHERWISE THAN BY REACTIONS ONLY INVOLVING UNSATURATED CARBON-TO-CARBON BONDS,2018
C07C,ACYCLIC OR CARBOCYCLIC COMPOUNDS,2018
C09D,"COATING COMPOSITIONS, e.g. PAINTS, VARNISHES OR LACQUERS; FILLING PASTES; CHEMICAL PAINT OR INK REMOVERS; INKS; CORRECTING FLUIDS; WOODSTAINS; PASTES OR SOLIDS FOR COLOURING OR PRINTING; USE OF MATERIALS THEREFOR",2017
H10K,ORGANIC ELECTRIC SOLID-STATE DEVICES,2021
B60R,"VEHICLES, VEHICLE FITTINGS, OR VEHICLE PARTS, NOT OTHERWISE PROVIDED FOR",2021
Y10T,TECHNICAL SUBJECTS COVERED BY FORMER US CLASSIFICATION,2014
A23L,"FOODS, FOODSTUFFS, OR NON-ALCOHOLIC BEVERAGES, NOT COVERED BY SUBCLASSES A21D OR A23B-A23J; THEIR PREPARATION OR TREATMENT, e.g. COOKING, MODIFICATION OF NUTRITIVE QUALITIES, PHYSICAL TREATMENT; PRESERVATION OF FOODS OR FOODSTUFFS, IN GENERAL",2018
C02F,"TREATMENT OF WATER, WASTE WATER, SEWAGE, OR SLUDGE",2018
B65D,"CONTAINERS FOR STORAGE OR TRANSPORT OF ARTICLES OR MATERIALS, e.g. BAGS, BARRELS, BOTTLES, BOXES, CANS, CARTONS, CRATES, DRUMS, JARS, TANKS, HOPPERS, FORWARDING CONTAINERS; ACCESSORIES, CLOSURES, OR FITTINGS THEREFOR; PACKAGING ELEMENTS; PACKAGES",2018
G06K,GRAPHICAL DATA READING; PRESENTATION OF DATA; RECORD CARRIERS; HANDLING RECORD CARRIERS,2021
C08J,"WORKING-UP; GENERAL PROCESSES OF COMPOUNDING; AFTER-TREATMENT NOT COVERED BY SUBCLASSES C08B, C08C, C08F, C08G or C08H",2018
G16H,"HEALTHCARE INFORMATICS, i.e. INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR THE HANDLING OR PROCESSING OF MEDICAL OR HEALTHCARE DATA",2021
G02F,OPTICAL DEVICES OR ARRANGEMENTS FOR THE CONTROL OF LIGHT BY MODIFICATION OF THE OPTICAL PROPERTIES OF THE MEDIA OF THE ELEMENTS INVOLVED THEREIN; NON-LINEAR OPTICS; FREQUENCY-CHANGING OF LIGHT; OPTICAL LOGIC ELEMENTS; OPTICAL ANALOGUE/DIGITAL CONVERTERS,2021
C12Q,"MEASURING OR TESTING PROCESSES INVOLVING ENZYMES, NUCLEIC ACIDS OR MICROORGANISMS; COMPOSITIONS OR TEST PAPERS THEREFOR; PROCESSES OF PREPARING SUCH COMPOSITIONS; CONDITION-RESPONSIVE CONTROL IN MICROBIOLOGICAL OR ENZYMOLOGICAL PROCESSES",2021
C09K,"MATERIALS FOR MISCELLANEOUS APPLICATIONS, NOT PROVIDED FOR ELSEWHERE",2018
C23C,"COATING METALLIC MATERIAL; COATING MATERIAL WITH METALLIC MATERIAL; SURFACE TREATMENT OF METALLIC MATERIAL BY DIFFUSION INTO THE SURFACE, BY CHEMICAL CONVERSION OR SUBSTITUTION; COATING BY VACUUM EVAPORATION, BY SPUTTERING, BY ION IMPLANTATION OR BY CHEMICAL VAPOUR DEPOSITION, IN GENERAL",2018
G09G,ARRANGEMENTS OR CIRCUITS FOR CONTROL OF INDICATING DEVICES USING STATIC MEANS TO PRESENT VARIABLE INFORMATION,2021
B23K,"SOLDERING OR UNSOLDERING; WELDING; CLADDING OR PLATING BY SOLDERING OR WELDING; CUTTING BY APPLYING HEAT LOCALLY, e.g. FLAME CUTTING; WORKING BY LASER BEAM",2018
B60W,CONJOINT CONTROL OF VEHICLE SUB-UNITS OF DIFFERENT TYPE OR DIFFERENT FUNCTION; CONTROL SYSTEMS SPECIALLY ADAPTED FOR HYBRID VEHICLES; ROAD VEHICLE DRIVE CONTROL SYSTEMS FOR PURPOSES NOT RELATED TO THE CONTROL OF A PARTICULAR SUB-UNIT,2022
B65G,"TRANSPORT OR STORAGE DEVICES, e.g. CONVEYORS FOR LOADING OR TIPPING, SHOP CONVEYOR SYSTEMS OR PNEUMATIC TUBE CONVEYORS",2022
E21B,"EARTH OR ROCK DRILLING; OBTAINING OIL, GAS, WATER, SOLUBLE OR MELTABLE MATERIALS OR A SLURRY OF MINERALS FROM WELLS",2021
H02K,DYNAMO-ELECTRIC MACHINES,2020
H05B,"ELECTRIC HEATING; ELECTRIC LIGHT SOURCES NOT OTHERWISE PROVIDED FOR; CIRCUIT ARRANGEMENTS FOR ELECTRIC LIGHT SOURCES, IN GENERAL",2018
A61L,"METHODS OR APPARATUS FOR STERILISING MATERIALS OR OBJECTS IN GENERAL; DISINFECTION, STERILISATION OR DEODORISATION OF AIR; CHEMICAL ASPECTS OF BANDAGES, DRESSINGS, ABSORBENT PADS OR SURGICAL ARTICLES; MATERIALS FOR BANDAGES, DRESSINGS, ABSORBENT PADS OR SURGICAL ARTICLES",2022
B60L,PROPULSION OF ELECTRICALLY-PROPELLED VEHICLES; SUPPLYING ELECTRIC POWER FOR AUXILIARY EQUIPMENT OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRODYNAMIC BRAKE SYSTEMS FOR VEHICLES IN GENERAL; MAGNETIC SUSPENSION OR LEVITATION FOR VEHICLES; MONITORING OPERATING VARIABLES OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRIC SAFETY DEVICES FOR ELECTRICALLY-PROPELLED VEHICLES,2021
G05D,SYSTEMS FOR CONTROLLING OR REGULATING NON-ELECTRIC VARIABLES,2021
H04M,TELEPHONIC COMMUNICATION,2021
B60K,"ARRANGEMENT OR MOUNTING OF PROPULSION UNITS OR OF TRANSMISSIONS IN VEHICLES; ARRANGEMENT OR MOUNTING OF PLURAL DIVERSE PRIME-MOVERS IN VEHICLES; AUXILIARY DRIVES FOR VEHICLES; INSTRUMENTATION OR DASHBOARDS FOR VEHICLES; ARRANGEMENTS IN CONNECTION WITH COOLING, AIR INTAKE, GAS EXHAUST OR FUEL SUPPLY OF PROPULSION UNITS IN VEHICLES",2018
C08F,MACROMOLECULAR COMPOUNDS OBTAINED BY REACTIONS ONLY INVOLVING CARBON-TO-CARBON UNSATURATED BONDS,2018
H01R,ELECTRICALLY-CONDUCTIVE CONNECTIONS; STRUCTURAL ASSOCIATIONS OF A PLURALITY OF MUTUALLY-INSULATED ELECTRICAL CONNECTING ELEMENTS; COUPLING DEVICES; CURRENT COLLECTORS,2018
B62D,MOTOR VEHICLES; TRAILERS,2021
C04B,"LIME, MAGNESIA; SLAG; CEMENTS; COMPOSITIONS THEREOF, e.g. MORTARS, CONCRETE OR LIKE BUILDING MATERIALS; ARTIFICIAL STONE; CERAMICS; REFRACTORIES; TREATMENT OF NATURAL STONE",2018
G01C,"MEASURING DISTANCES, LEVELS OR BEARINGS; SURVEYING; NAVIGATION; GYROSCOPIC INSTRUMENTS; PHOTOGRAMMETRY OR VIDEOGRAMMETRY",2021
C01B,NON-METALLIC ELEMENTS; COMPOUNDS THEREOF; METALLOIDS OR COMPOUNDS THEREOF NOT COVERED BY SUBCLASS C01C,2022
A23V,"INDEXING SCHEME RELATING TO FOODS, FOODSTUFFS OR NON-ALCOHOLIC BEVERAGES AND LACTIC OR PROPIONIC ACID BACTERIA USED IN FOODSTUFFS OR FOOD PREPARATION",2017
A61Q,SPECIFIC USE OF COSMETICS OR SIMILAR TOILETRY PREPARATIONS,2018
H02M,"APPARATUS FOR CONVERSION BETWEEN AC AND AC, BETWEEN AC AND DC, OR BETWEEN DC AND DC, AND FOR USE WITH MAINS OR SIMILAR POWER SUPPLY SYSTEMS; CONVERSION OF DC OR AC INPUT POWER INTO SURGE OUTPUT POWER; CONTROL OR REGULATION THEREOF",2021
B25J,MANIPULATORS; CHAMBERS PROVIDED WITH MANIPULATION DEVICES,2021
C22C,ALLOYS,2017
G01B,"MEASURING LENGTH, THICKNESS OR SIMILAR LINEAR DIMENSIONS; MEASURING ANGLES; MEASURING AREAS; MEASURI
Current sql:
WITH level5_cpc AS (
    SELECT
        "symbol" AS "cpc_symbol",
        "titleFull" AS "full_title"
    FROM
        PATENTS.PATENTS.CPC_DEFINITION
    WHERE
        "level" = 5
),
publication_cpc AS (
    SELECT
        p."publication_number",
        c.value:"code"::STRING AS "cpc_symbol_full",
        TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD') AS "publication_date",
        EXTRACT(year FROM TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD')) AS "year"
    FROM
        PATENTS.PATENTS.PUBLICATIONS p,
        LATERAL FLATTEN(input => p."cpc") c
    WHERE
        c.value:"code"::STRING IS NOT NULL
        AND p."publication_date" IS NOT NULL
),
cpc_publications AS (
    SELECT
        REGEXP_SUBSTR(pc."cpc_symbol_full", '^[A-Z]\\d{2}[A-Z]+') AS "cpc_symbol",
        pc."year",
        pc."publication_number"
    FROM
        publication_cpc pc
    WHERE
        pc."year" IS NOT NULL
        AND REGEXP_SUBSTR(pc."cpc_symbol_full", '^[A-Z]\\d{2}[A-Z]+') IS NOT NULL
),
cpc_publications_with_title AS (
    SELECT
        cp."cpc_symbol",
        cp."year",
        cp."publication_number",
        l5."full_title"
    FROM
        cpc_publications cp
    INNER JOIN
        level5_cpc l5
    ON
        cp."cpc_symbol" = l5."cpc_symbol"
),
annual_counts AS (
    SELECT
        cp."cpc_symbol",
        cp."full_title",
        cp."year",
        COUNT(DISTINCT cp."publication_number") AS "num_publications"
    FROM
        cpc_publications_with_title cp
    GROUP BY
        cp."cpc_symbol",
        cp."full_title",
        cp."year"
),
ordered_counts AS (
    SELECT
        ac.*,
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."year") AS "rn"
    FROM
        annual_counts ac
    ORDER BY
        ac."cpc_symbol",
        ac."year"
),
ema_calc AS (
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        CAST(oc."num_publications" AS FLOAT) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    WHERE
        oc."rn" = 1
    UNION ALL
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        0.2 * oc."num_publications" + 0.8 * ec."ema" AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    INNER JOIN
        ema_calc ec
    ON
        oc."cpc_symbol" = ec."cpc_symbol" AND oc."rn" = ec."rn" + 1
),
latest_ema AS (
    SELECT
        ec."cpc_symbol",
        ec."full_title",
        ec."year",
        ec."ema",
        ROW_NUMBER() OVER (PARTITION BY ec."cpc_symbol" ORDER BY ec."year" DESC) AS "rn"
    FROM
        ema_calc ec
),
ema_per_cpc AS (
    SELECT
        le."cpc_symbol",
        le."full_title",
        le."ema"
    FROM
        latest_ema le
    WHERE
        le."rn" = 1
),
best_years AS (
    SELECT
        ac."cpc_symbol",
        ac."full_title",
        ac."year" AS "best_year",
        ac."num_publications",
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."num_publications" DESC) AS "rn"
    FROM
        annual_counts ac
),
best_year_per_cpc AS (
    SELECT
        byc."cpc_symbol",
        byc."full_title",
        byc."best_year"
    FROM
        best_years byc
    WHERE
        byc."rn" = 1
)
SELECT
    epc."cpc_symbol" AS "CPC_Symbol",
    epc."full_title" AS "Full_Title",
    byp."best_year" AS "Best_Year"
FROM
    ema_per_cpc epc
JOIN
    best_year_per_cpc byp
ON
    epc."cpc_symbol" = byp."cpc_symbol"
ORDER BY
    epc."ema" DESC NULLS LAST
LIMIT 100;
2025-01-27 02:05:41 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 02:05:41 - root - INFO - ```sql
WITH level5_cpc AS (
    SELECT
        "symbol" AS "cpc_symbol",
        "titleFull" AS "full_title"
    FROM
        PATENTS.PATENTS.CPC_DEFINITION
    WHERE
        "level" = 5
),
publication_cpc AS (
    SELECT
        p."publication_number",
        c.value:"code"::STRING AS "cpc_symbol_full",
        TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD') AS "publication_date",
        EXTRACT(year FROM TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD')) AS "year"
    FROM
        PATENTS.PATENTS.PUBLICATIONS p,
        LATERAL FLATTEN(input => p."cpc") c
    WHERE
        c.value:"code"::STRING IS NOT NULL
        AND p."publication_date" IS NOT NULL
),
cpc_publications AS (
    SELECT
        REGEXP_SUBSTR(pc."cpc_symbol_full", '^[A-Z]\d{2}[A-Z]+') AS "cpc_symbol",
        pc."year",
        pc."publication_number"
    FROM
        publication_cpc pc
    WHERE
        pc."year" IS NOT NULL
        AND REGEXP_SUBSTR(pc."cpc_symbol_full", '^[A-Z]\d{2}[A-Z]+') IS NOT NULL
),
cpc_publications_with_title AS (
    SELECT
        cp."cpc_symbol",
        cp."year",
        cp."publication_number",
        l5."full_title"
    FROM
        cpc_publications cp
    INNER JOIN
        level5_cpc l5
        ON
            cp."cpc_symbol" = l5."cpc_symbol"
),
annual_counts AS (
    SELECT
        cp."cpc_symbol",
        cp."full_title",
        cp."year",
        COUNT(DISTINCT cp."publication_number") AS "num_publications"
    FROM
        cpc_publications_with_title cp
    GROUP BY
        cp."cpc_symbol",
        cp."full_title",
        cp."year"
),
ordered_counts AS (
    SELECT
        ac.*,
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."year") AS "rn"
    FROM
        annual_counts ac
    ORDER BY
        ac."cpc_symbol",
        ac."year"
),
ema_calc AS (
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        CAST(oc."num_publications" AS FLOAT) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    WHERE
        oc."rn" = 1
    UNION ALL
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        ROUND(0.2 * oc."num_publications" + 0.8 * ec."ema", 4) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    INNER JOIN
        ema_calc ec
        ON
            oc."cpc_symbol" = ec."cpc_symbol" AND oc."rn" = ec."rn" + 1
),
latest_ema AS (
    SELECT
        ec."cpc_symbol",
        ec."full_title",
        ec."year",
        ec."ema",
        ROW_NUMBER() OVER (PARTITION BY ec."cpc_symbol" ORDER BY ec."year" DESC) AS "rn"
    FROM
        ema_calc ec
),
ema_per_cpc AS (
    SELECT
        le."cpc_symbol",
        le."full_title",
        le."ema"
    FROM
        latest_ema le
    WHERE
        le."rn" = 1
),
best_years AS (
    SELECT
        ac."cpc_symbol",
        ac."full_title",
        ac."year" AS "best_year",
        ac."num_publications",
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."num_publications" DESC) AS "rn"
    FROM
        annual_counts ac
),
best_year_per_cpc AS (
    SELECT
        byc."cpc_symbol",
        byc."full_title",
        byc."best_year"
    FROM
        best_years byc
    WHERE
        byc."rn" = 1
)
SELECT
    epc."cpc_symbol" AS "CPC_Symbol",
    epc."full_title" AS "Full_Title",
    byp."best_year" AS "Best_Year"
FROM
    ema_per_cpc epc
JOIN
    best_year_per_cpc byp
ON
    epc."cpc_symbol" = byp."cpc_symbol"
ORDER BY
    epc."ema" DESC NULLS LAST
LIMIT 100;
```
2025-01-27 02:05:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 02:05:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 02:05:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 02:05:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-27 02:05:43 - snowflake.connector.connection - INFO - closed
2025-01-27 02:05:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 02:05:43 - root - INFO - itercount: 4
2025-01-27 02:05:43 - root - INFO - No data found for the specified query.

2025-01-27 02:05:43 - root - INFO - Input sql:
WITH level5_cpc AS (
    SELECT
        "symbol" AS "cpc_symbol",
        "titleFull" AS "full_title"
    FROM
        PATENTS.PATENTS.CPC_DEFINITION
    WHERE
        "level" = 5
),
publication_cpc AS (
    SELECT
        p."publication_number",
        c.value:"code"::STRING AS "cpc_symbol_full",
        TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD') AS "publication_date",
        EXTRACT(year FROM TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD')) AS "year"
    FROM
        PATENTS.PATENTS.PUBLICATIONS p,
        LATERAL FLATTEN(input => p."cpc") c
    WHERE
        c.value:"code"::STRING IS NOT NULL
        AND p."publication_date" IS NOT NULL
),
cpc_publications AS (
    SELECT
        REGEXP_SUBSTR(pc."cpc_symbol_full", '^[A-Z]\d{2}[A-Z]+') AS "cpc_symbol",
        pc."year",
        pc."publication_number"
    FROM
        publication_cpc pc
    WHERE
        pc."year" IS NOT NULL
        AND REGEXP_SUBSTR(pc."cpc_symbol_full", '^[A-Z]\d{2}[A-Z]+') IS NOT NULL
),
cpc_publications_with_title AS (
    SELECT
        cp."cpc_symbol",
        cp."year",
        cp."publication_number",
        l5."full_title"
    FROM
        cpc_publications cp
    INNER JOIN
        level5_cpc l5
        ON
            cp."cpc_symbol" = l5."cpc_symbol"
),
annual_counts AS (
    SELECT
        cp."cpc_symbol",
        cp."full_title",
        cp."year",
        COUNT(DISTINCT cp."publication_number") AS "num_publications"
    FROM
        cpc_publications_with_title cp
    GROUP BY
        cp."cpc_symbol",
        cp."full_title",
        cp."year"
),
ordered_counts AS (
    SELECT
        ac.*,
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."year") AS "rn"
    FROM
        annual_counts ac
    ORDER BY
        ac."cpc_symbol",
        ac."year"
),
ema_calc AS (
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        CAST(oc."num_publications" AS FLOAT) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    WHERE
        oc."rn" = 1
    UNION ALL
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        ROUND(0.2 * oc."num_publications" + 0.8 * ec."ema", 4) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    INNER JOIN
        ema_calc ec
        ON
            oc."cpc_symbol" = ec."cpc_symbol" AND oc."rn" = ec."rn" + 1
),
latest_ema AS (
    SELECT
        ec."cpc_symbol",
        ec."full_title",
        ec."year",
        ec."ema",
        ROW_NUMBER() OVER (PARTITION BY ec."cpc_symbol" ORDER BY ec."year" DESC) AS "rn"
    FROM
        ema_calc ec
),
ema_per_cpc AS (
    SELECT
        le."cpc_symbol",
        le."full_title",
        le."ema"
    FROM
        latest_ema le
    WHERE
        le."rn" = 1
),
best_years AS (
    SELECT
        ac."cpc_symbol",
        ac."full_title",
        ac."year" AS "best_year",
        ac."num_publications",
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."num_publications" DESC) AS "rn"
    FROM
        annual_counts ac
),
best_year_per_cpc AS (
    SELECT
        byc."cpc_symbol",
        byc."full_title",
        byc."best_year"
    FROM
        best_years byc
    WHERE
        byc."rn" = 1
)
SELECT
    epc."cpc_symbol" AS "CPC_Symbol",
    epc."full_title" AS "Full_Title",
    byp."best_year" AS "Best_Year"
FROM
    ema_per_cpc epc
JOIN
    best_year_per_cpc byp
ON
    epc."cpc_symbol" = byp."cpc_symbol"
ORDER BY
    epc."ema" DESC NULLS LAST
LIMIT 100;
The error information is:
 No data found for the specified query.

2025-01-27 02:07:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 02:07:14 - root - INFO - ```sql
WITH publication_cpc AS (
    SELECT
        p."publication_number",
        c.value:"code"::STRING AS "cpc_symbol_full",
        TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD') AS "publication_date",
        EXTRACT(year FROM TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD')) AS "year"
    FROM
        PATENTS.PATENTS.PUBLICATIONS p,
        LATERAL FLATTEN(input => p."cpc") c
    WHERE
        c.value:"code"::STRING IS NOT NULL
        AND p."publication_date" IS NOT NULL
),
cpc_publications_with_title AS (
    SELECT
        pc."cpc_symbol_full" AS "cpc_symbol",
        pc."year",
        pc."publication_number",
        cpc_def."titleFull" AS "full_title"
    FROM
        publication_cpc pc
    INNER JOIN
        PATENTS.PATENTS.CPC_DEFINITION cpc_def
    ON
        pc."cpc_symbol_full" = cpc_def."symbol"
    WHERE
        cpc_def."level" = 5
        AND pc."year" IS NOT NULL
),
annual_counts AS (
    SELECT
        cp."cpc_symbol",
        cp."full_title",
        cp."year",
        COUNT(DISTINCT cp."publication_number") AS "num_publications"
    FROM
        cpc_publications_with_title cp
    GROUP BY
        cp."cpc_symbol",
        cp."full_title",
        cp."year"
),
ordered_counts AS (
    SELECT
        ac.*,
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."year") AS "rn"
    FROM
        annual_counts ac
),
ema_calc AS (
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        CAST(oc."num_publications" AS FLOAT) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
        WHERE oc."rn" = 1
    UNION ALL
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        ROUND(0.2 * oc."num_publications" + 0.8 * ec."ema", 4) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    INNER JOIN
        ema_calc ec
        ON
            oc."cpc_symbol" = ec."cpc_symbol" AND oc."rn" = ec."rn" + 1
),
latest_ema AS (
    SELECT
        ec."cpc_symbol",
        ec."full_title",
        ec."ema",
        ROW_NUMBER() OVER (PARTITION BY ec."cpc_symbol" ORDER BY ec."year" DESC) AS "rn"
    FROM
        ema_calc ec
),
ema_per_cpc AS (
    SELECT
        le."cpc_symbol",
        le."full_title",
        le."ema"
    FROM
        latest_ema le
        WHERE
            le."rn" = 1
),
best_years AS (
    SELECT
        ac."cpc_symbol",
        ac."full_title",
        ac."year" AS "best_year",
        ac."num_publications",
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."num_publications" DESC) AS "rn"
    FROM
        annual_counts ac
),
best_year_per_cpc AS (
    SELECT
        byc."cpc_symbol",
        byc."full_title",
        byc."best_year"
    FROM
        best_years byc
        WHERE
            byc."rn" = 1
)
SELECT
    epc."cpc_symbol" AS "CPC_Symbol",
    epc."full_title" AS "Full_Title",
    byp."best_year" AS "Best_Year"
FROM
    ema_per_cpc epc
JOIN
    best_year_per_cpc byp
ON
    epc."cpc_symbol" = byp."cpc_symbol"
ORDER BY
    epc."ema" DESC NULLS LAST
LIMIT 100;
```
2025-01-27 02:07:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 02:07:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 02:07:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 02:07:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-27 02:07:16 - snowflake.connector.connection - INFO - closed
2025-01-27 02:07:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 02:07:17 - root - INFO - itercount: 5
2025-01-27 02:07:17 - root - INFO - No data found for the specified query.

2025-01-27 02:07:17 - root - INFO - Input sql:
WITH publication_cpc AS (
    SELECT
        p."publication_number",
        c.value:"code"::STRING AS "cpc_symbol_full",
        TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD') AS "publication_date",
        EXTRACT(year FROM TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD')) AS "year"
    FROM
        PATENTS.PATENTS.PUBLICATIONS p,
        LATERAL FLATTEN(input => p."cpc") c
    WHERE
        c.value:"code"::STRING IS NOT NULL
        AND p."publication_date" IS NOT NULL
),
cpc_publications_with_title AS (
    SELECT
        pc."cpc_symbol_full" AS "cpc_symbol",
        pc."year",
        pc."publication_number",
        cpc_def."titleFull" AS "full_title"
    FROM
        publication_cpc pc
    INNER JOIN
        PATENTS.PATENTS.CPC_DEFINITION cpc_def
    ON
        pc."cpc_symbol_full" = cpc_def."symbol"
    WHERE
        cpc_def."level" = 5
        AND pc."year" IS NOT NULL
),
annual_counts AS (
    SELECT
        cp."cpc_symbol",
        cp."full_title",
        cp."year",
        COUNT(DISTINCT cp."publication_number") AS "num_publications"
    FROM
        cpc_publications_with_title cp
    GROUP BY
        cp."cpc_symbol",
        cp."full_title",
        cp."year"
),
ordered_counts AS (
    SELECT
        ac.*,
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."year") AS "rn"
    FROM
        annual_counts ac
),
ema_calc AS (
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        CAST(oc."num_publications" AS FLOAT) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
        WHERE oc."rn" = 1
    UNION ALL
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        ROUND(0.2 * oc."num_publications" + 0.8 * ec."ema", 4) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    INNER JOIN
        ema_calc ec
        ON
            oc."cpc_symbol" = ec."cpc_symbol" AND oc."rn" = ec."rn" + 1
),
latest_ema AS (
    SELECT
        ec."cpc_symbol",
        ec."full_title",
        ec."ema",
        ROW_NUMBER() OVER (PARTITION BY ec."cpc_symbol" ORDER BY ec."year" DESC) AS "rn"
    FROM
        ema_calc ec
),
ema_per_cpc AS (
    SELECT
        le."cpc_symbol",
        le."full_title",
        le."ema"
    FROM
        latest_ema le
        WHERE
            le."rn" = 1
),
best_years AS (
    SELECT
        ac."cpc_symbol",
        ac."full_title",
        ac."year" AS "best_year",
        ac."num_publications",
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."num_publications" DESC) AS "rn"
    FROM
        annual_counts ac
),
best_year_per_cpc AS (
    SELECT
        byc."cpc_symbol",
        byc."full_title",
        byc."best_year"
    FROM
        best_years byc
        WHERE
            byc."rn" = 1
)
SELECT
    epc."cpc_symbol" AS "CPC_Symbol",
    epc."full_title" AS "Full_Title",
    byp."best_year" AS "Best_Year"
FROM
    ema_per_cpc epc
JOIN
    best_year_per_cpc byp
ON
    epc."cpc_symbol" = byp."cpc_symbol"
ORDER BY
    epc."ema" DESC NULLS LAST
LIMIT 100;
The error information is:
 No data found for the specified query.

2025-01-27 02:08:46 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 02:08:46 - root - INFO - ```sql
WITH level5_cpc AS (
    SELECT
        TRIM("symbol") AS "cpc_symbol",
        "titleFull" AS "full_title"
    FROM
        PATENTS.PATENTS.CPC_DEFINITION
    WHERE
        "level" = 5
),
publication_cpc AS (
    SELECT
        p."publication_number",
        c.value:"code"::STRING AS "cpc_symbol_full",
        EXTRACT(year FROM TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD')) AS "year"
    FROM
        PATENTS.PATENTS.PUBLICATIONS p,
        LATERAL FLATTEN(input => p."cpc") c
    WHERE
        c.value:"code"::STRING IS NOT NULL
        AND p."publication_date" IS NOT NULL
),
cpc_publications AS (
    SELECT
        TRIM(SUBSTRING(pc."cpc_symbol_full", 1, 4)) AS "cpc_symbol",
        pc."year",
        pc."publication_number"
    FROM
        publication_cpc pc
    WHERE
        pc."year" IS NOT NULL
        AND TRIM(SUBSTRING(pc."cpc_symbol_full", 1, 4)) IS NOT NULL
),
cpc_publications_with_title AS (
    SELECT
        cp."cpc_symbol",
        cp."year",
        cp."publication_number",
        l5."full_title"
    FROM
        cpc_publications cp
    INNER JOIN
        level5_cpc l5
    ON
        cp."cpc_symbol" = l5."cpc_symbol"
),
annual_counts AS (
    SELECT
        cp."cpc_symbol",
        cp."full_title",
        cp."year",
        COUNT(DISTINCT cp."publication_number") AS "num_publications"
    FROM
        cpc_publications_with_title cp
    GROUP BY
        cp."cpc_symbol",
        cp."full_title",
        cp."year"
),
ordered_counts AS (
    SELECT
        ac.*,
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."year") AS "rn"
    FROM
        annual_counts ac
),
ema_calc AS (
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        CAST(oc."num_publications" AS FLOAT) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    WHERE
        oc."rn" = 1
    UNION ALL
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        ROUND(0.2 * oc."num_publications" + 0.8 * ec."ema", 4) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    INNER JOIN
        ema_calc ec
        ON
            oc."cpc_symbol" = ec."cpc_symbol" AND oc."rn" = ec."rn" + 1
),
latest_ema AS (
    SELECT
        ec."cpc_symbol",
        ec."full_title",
        ec."year",
        ec."ema",
        ROW_NUMBER() OVER (PARTITION BY ec."cpc_symbol" ORDER BY ec."year" DESC) AS "rn"
    FROM
        ema_calc ec
),
ema_per_cpc AS (
    SELECT
        le."cpc_symbol",
        le."full_title",
        le."ema"
    FROM
        latest_ema le
    WHERE
        le."rn" = 1
),
best_years AS (
    SELECT
        ac."cpc_symbol",
        ac."full_title",
        ac."year" AS "best_year",
        ac."num_publications",
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."num_publications" DESC) AS "rn"
    FROM
        annual_counts ac
),
best_year_per_cpc AS (
    SELECT
        byc."cpc_symbol",
        byc."full_title",
        byc."best_year"
    FROM
        best_years byc
    WHERE
        byc."rn" = 1
)
SELECT
    epc."cpc_symbol" AS "CPC_Symbol",
    epc."full_title" AS "Full_Title",
    byp."best_year" AS "Best_Year"
FROM
    ema_per_cpc epc
JOIN
    best_year_per_cpc byp
ON
    epc."cpc_symbol" = byp."cpc_symbol"
ORDER BY
    epc."ema" DESC NULLS LAST
LIMIT 100;
```
2025-01-27 02:08:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 02:08:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 02:08:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 02:08:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 02:08:48 - snowflake.connector.connection - INFO - closed
2025-01-27 02:08:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 02:08:49 - root - INFO - itercount: 6
2025-01-27 02:08:49 - root - INFO - 0
2025-01-27 02:08:49 - root - INFO - results: 
CPC_Symbol,Full_Title,Best_Year
G06F,ELECTRIC DIGITAL DATA PROCESSING,2021
Y02E,"REDUCTION OF GREENHOUSE GAS [GHG] EMISSIONS, RELATED TO ENERGY GENERATION, TRANSMISSION OR DISTRIBUTION",2023
Y02P,CLIMATE CHANGE MITIGATION TECHNOLOGIES IN THE PRODUCTION OR PROCESSING OF GOODS,2023
A61K,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",2021
H04L,"TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION",2021
H01L,SEMICONDUCTOR DEVICES NOT COVERED BY CLASS H10,2021
A61P,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2021
H04W,WIRELESS COMMUNICATION NETWORKS,2021
Y02A,TECHNOLOGIES FOR ADAPTATION TO CLIMATE CHANGE,2023
G06Q,"INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES; SYSTEMS OR METHODS SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES, NOT OTHERWISE PROVIDED FOR",2022
G01N,INVESTIGATING OR ANALYSING MATERIALS BY DETERMINING THEIR CHEMICAL OR PHYSICAL PROPERTIES,2021
H04N,"PICTORIAL COMMUNICATION, e.g. TELEVISION",2021
A61B,DIAGNOSIS; SURGERY; IDENTIFICATION,2021
G06T,"IMAGE DATA PROCESSING OR GENERATION, IN GENERAL",2021
Y02T,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,2023
G06N,COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS,2022
C12N,"MICROORGANISMS OR ENZYMES; COMPOSITIONS THEREOF; PROPAGATING, PRESERVING, OR MAINTAINING MICROORGANISMS; MUTATION OR GENETIC ENGINEERING; CULTURE MEDIA",2021
H01M,"PROCESSES OR MEANS, e.g. BATTERIES, FOR THE DIRECT CONVERSION OF CHEMICAL ENERGY INTO ELECTRICAL ENERGY",2022
G02B,"OPTICAL ELEMENTS, SYSTEMS OR APPARATUS",2021
G06V,IMAGE OR VIDEO RECOGNITION OR UNDERSTANDING,2021
Y02W,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO WASTEWATER TREATMENT OR WASTE MANAGEMENT,2023
C07K,PEPTIDES,2021
Y02B,"CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO BUILDINGS, e.g. HOUSING, HOUSE APPLIANCES OR RELATED END-USER APPLICATIONS",2023
C07D,HETEROCYCLIC COMPOUNDS,2018
B01D,SEPARATION,2018
C08L,COMPOSITIONS OF MACROMOLECULAR COMPOUNDS,2018
H04B,TRANSMISSION,2021
Y02D,"CLIMATE CHANGE MITIGATION TECHNOLOGIES IN INFORMATION AND COMMUNICATION TECHNOLOGIES [ICT], I.E. INFORMATION AND COMMUNICATION TECHNOLOGIES AIMING AT THE REDUCTION OF THEIR OWN ENERGY USE",2023
B29C,"SHAPING OR JOINING OF PLASTICS; SHAPING OF MATERIAL IN A PLASTIC STATE, NOT OTHERWISE PROVIDED FOR; AFTER-TREATMENT OF THE SHAPED PRODUCTS, e.g. REPAIRING",2018
H02J,CIRCUIT ARRANGEMENTS OR SYSTEMS FOR SUPPLYING OR DISTRIBUTING ELECTRIC POWER; SYSTEMS FOR STORING ELECTRIC ENERGY,2022
A61M,"DEVICES FOR INTRODUCING MEDIA INTO, OR ONTO, THE BODY; DEVICES FOR TRANSDUCING BODY MEDIA OR FOR TAKING MEDIA FROM THE BODY; DEVICES FOR PRODUCING OR ENDING SLEEP OR STUPOR",2021
C08K,Use of inorganic or non-macromolecular organic substances as compounding ingredients,2018
H05K,PRINTED CIRCUITS; CASINGS OR CONSTRUCTIONAL DETAILS OF ELECTRIC APPARATUS; MANUFACTURE OF ASSEMBLAGES OF ELECTRICAL COMPONENTS,2022
G01R,MEASURING ELECTRIC VARIABLES; MEASURING MAGNETIC VARIABLES,2022
G01S,RADIO DIRECTION-FINDING; RADIO NAVIGATION; DETERMINING DISTANCE OR VELOCITY BY USE OF RADIO WAVES; LOCATING OR PRESENCE-DETECTING BY USE OF THE REFLECTION OR RERADIATION OF RADIO WAVES; ANALOGOUS ARRANGEMENTS USING OTHER WAVES,2021
B01J,"CHEMICAL OR PHYSICAL PROCESSES, e.g. CATALYSIS OR COLLOID CHEMISTRY; THEIR RELEVANT APPARATUS",2018
G05B,CONTROL OR REGULATING SYSTEMS IN GENERAL; FUNCTIONAL ELEMENTS OF SUCH SYSTEMS; MONITORING OR TESTING ARRANGEMENTS FOR SUCH SYSTEMS OR ELEMENTS,2021
B32B,"LAYERED PRODUCTS, i.e. PRODUCTS BUILT-UP OF STRATA OF FLAT OR NON-FLAT, e.g. CELLULAR OR HONEYCOMB, FORM",2018
A61F,"FILTERS IMPLANTABLE INTO BLOOD VESSELS; PROSTHESES; DEVICES PROVIDING PATENCY TO, OR PREVENTING COLLAPSING OF, TUBULAR STRUCTURES OF THE BODY, e.g. STENTS; ORTHOPAEDIC, NURSING OR CONTRACEPTIVE DEVICES; FOMENTATION; TREATMENT OR PROTECTION OF EYES OR EARS; BANDAGES, DRESSINGS OR ABSORBENT PADS; FIRST-AID KITS",2020
C08G,MACROMOLECULAR COMPOUNDS OBTAINED OTHERWISE THAN BY REACTIONS ONLY INVOLVING UNSATURATED CARBON-TO-CARBON BONDS,2018
C07C,ACYCLIC OR CARBOCYCLIC COMPOUNDS,2018
C09D,"COATING COMPOSITIONS, e.g. PAINTS, VARNISHES OR LACQUERS; FILLING PASTES; CHEMICAL PAINT OR INK REMOVERS; INKS; CORRECTING FLUIDS; WOODSTAINS; PASTES OR SOLIDS FOR COLOURING OR PRINTING; USE OF MATERIALS THEREFOR",2017
H10K,ORGANIC ELECTRIC SOLID-STATE DEVICES,2021
B60R,"VEHICLES, VEHICLE FITTINGS, OR VEHICLE PARTS, NOT OTHERWISE PROVIDED FOR",2021
Y10T,TECHNICAL SUBJECTS COVERED BY FORMER US CLASSIFICATION,2014
A23L,"FOODS, FOODSTUFFS, OR NON-ALCOHOLIC BEVERAGES, NOT COVERED BY SUBCLASSES A21D OR A23B-A23J; THEIR PREPARATION OR TREATMENT, e.g. COOKING, MODIFICATION OF NUTRITIVE QUALITIES, PHYSICAL TREATMENT; PRESERVATION OF FOODS OR FOODSTUFFS, IN GENERAL",2018
C02F,"TREATMENT OF WATER, WASTE WATER, SEWAGE, OR SLUDGE",2018
B65D,"CONTAINERS FOR STORAGE OR TRANSPORT OF ARTICLES OR MATERIALS, e.g. BAGS, BARRELS, BOTTLES, BOXES, CANS, CARTONS, CRATES, DRUMS, JARS, TANKS, HOPPERS, FORWARDING CONTAINERS; ACCESSORIES, CLOSURES, OR FITTINGS THEREFOR; PACKAGING ELEMENTS; PACKAGES",2018
G06K,GRAPHICAL DATA READING; PRESENTATION OF DATA; RECORD CARRIERS; HANDLING RECORD CARRIERS,2021
C08J,"WORKING-UP; GENERAL PROCESSES OF COMPOUNDING; AFTER-TREATMENT NOT COVERED BY SUBCLASSES C08B, C08C, C08F, C08G or C08H",2018
G16H,"HEALTHCARE INFORMATICS, i.e. INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR THE HANDLING OR PROCESSING OF MEDICAL OR HEALTHCARE DATA",2021
G02F,OPTICAL DEVICES OR ARRANGEMENTS FOR THE CONTROL OF LIGHT BY MODIFICATION OF THE OPTICAL PROPERTIES OF THE MEDIA OF THE ELEMENTS INVOLVED THEREIN; NON-LINEAR OPTICS; FREQUENCY-CHANGING OF LIGHT; OPTICAL LOGIC ELEMENTS; OPTICAL ANALOGUE/DIGITAL CONVERTERS,2021
C12Q,"MEASURING OR TESTING PROCESSES INVOLVING ENZYMES, NUCLEIC ACIDS OR MICROORGANISMS; COMPOSITIONS OR TEST PAPERS THEREFOR; PROCESSES OF PREPARING SUCH COMPOSITIONS; CONDITION-RESPONSIVE CONTROL IN MICROBIOLOGICAL OR ENZYMOLOGICAL PROCESSES",2021
C09K,"MATERIALS FOR MISCELLANEOUS APPLICATIONS, NOT PROVIDED FOR ELSEWHERE",2018
C23C,"COATING METALLIC MATERIAL; COATING MATERIAL WITH METALLIC MATERIAL; SURFACE TREATMENT OF METALLIC MATERIAL BY DIFFUSION INTO THE SURFACE, BY CHEMICAL CONVERSION OR SUBSTITUTION; COATING BY VACUUM EVAPORATION, BY SPUTTERING, BY ION IMPLANTATION OR BY CHEMICAL VAPOUR DEPOSITION, IN GENERAL",2018
G09G,ARRANGEMENTS OR CIRCUITS FOR CONTROL OF INDICATING DEVICES USING STATIC MEANS TO PRESENT VARIABLE INFORMATION,2021
B23K,"SOLDERING OR UNSOLDERING; WELDING; CLADDING OR PLATING BY SOLDERING OR WELDING; CUTTING BY APPLYING HEAT LOCALLY, e.g. FLAME CUTTING; WORKING BY LASER BEAM",2018
B60W,CONJOINT CONTROL OF VEHICLE SUB-UNITS OF DIFFERENT TYPE OR DIFFERENT FUNCTION; CONTROL SYSTEMS SPECIALLY ADAPTED FOR HYBRID VEHICLES; ROAD VEHICLE DRIVE CONTROL SYSTEMS FOR PURPOSES NOT RELATED TO THE CONTROL OF A PARTICULAR SUB-UNIT,2022
B65G,"TRANSPORT OR STORAGE DEVICES, e.g. CONVEYORS FOR LOADING OR TIPPING, SHOP CONVEYOR SYSTEMS OR PNEUMATIC TUBE CONVEYORS",2022
E21B,"EARTH OR ROCK DRILLING; OBTAINING OIL, GAS, WATER, SOLUBLE OR MELTABLE MATERIALS OR A SLURRY OF MINERALS FROM WELLS",2021
H02K,DYNAMO-ELECTRIC MACHINES,2020
H05B,"ELECTRIC HEATING; ELECTRIC LIGHT SOURCES NOT OTHERWISE PROVIDED FOR; CIRCUIT ARRANGEMENTS FOR ELECTRIC LIGHT SOURCES, IN GENERAL",2018
A61L,"METHODS OR APPARATUS FOR STERILISING MATERIALS OR OBJECTS IN GENERAL; DISINFECTION, STERILISATION OR DEODORISATION OF AIR; CHEMICAL ASPECTS OF BANDAGES, DRESSINGS, ABSORBENT PADS OR SURGICAL ARTICLES; MATERIALS FOR BANDAGES, DRESSINGS, ABSORBENT PADS OR SURGICAL ARTICLES",2022
B60L,PROPULSION OF ELECTRICALLY-PROPELLED VEHICLES; SUPPLYING ELECTRIC POWER FOR AUXILIARY EQUIPMENT OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRODYNAMIC BRAKE SYSTEMS FOR VEHICLES IN GENERAL; MAGNETIC SUSPENSION OR LEVITATION FOR VEHICLES; MONITORING OPERATING VARIABLES OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRIC SAFETY DEVICES FOR ELECTRICALLY-PROPELLED VEHICLES,2021
G05D,SYSTEMS FOR CONTROLLING OR REGULATING NON-ELECTRIC VARIABLES,2020
H04M,TELEPHONIC COMMUNICATION,2021
B60K,"ARRANGEMENT OR MOUNTING OF PROPULSION UNITS OR OF TRANSMISSIONS IN VEHICLES; ARRANGEMENT OR MOUNTING OF PLURAL DIVERSE PRIME-MOVERS IN VEHICLES; AUXILIARY DRIVES FOR VEHICLES; INSTRUMENTATION OR DASHBOARDS FOR VEHICLES; ARRANGEMENTS IN CONNECTION WITH COOLING, AIR INTAKE, GAS EXHAUST OR FUEL SUPPLY OF PROPULSION UNITS IN VEHICLES",2018
C08F,MACROMOLECULAR COMPOUNDS OBTAINED BY REACTIONS ONLY INVOLVING CARBON-TO-CARBON UNSATURATED BONDS,2018
H01R,ELECTRICALLY-CONDUCTIVE CONNECTIONS; STRUCTURAL ASSOCIATIONS OF A PLURALITY OF MUTUALLY-INSULATED ELECTRICAL CONNECTING ELEMENTS; COUPLING DEVICES; CURRENT COLLECTORS,2018
B62D,MOTOR VEHICLES; TRAILERS,2021
C04B,"LIME, MAGNESIA; SLAG; CEMENTS; COMPOSITIONS THEREOF, e.g. MORTARS, CONCRETE OR LIKE BUILDING MATERIALS; ARTIFICIAL STONE; CERAMICS; REFRACTORIES; TREATMENT OF NATURAL STONE",2018
G01C,"MEASURING DISTANCES, LEVELS OR BEARINGS; SURVEYING; NAVIGATION; GYROSCOPIC INSTRUMENTS; PHOTOGRAMMETRY OR VIDEOGRAMMETRY",2021
C01B,NON-METALLIC ELEMENTS; COMPOUNDS THEREOF; METALLOIDS OR COMPOUNDS THEREOF NOT COVERED BY SUBCLASS C01C,2022
A23V,"INDEXING SCHEME RELATING TO FOODS, FOODSTUFFS OR NON-ALCOHOLIC BEVERAGES AND LACTIC OR PROPIONIC ACID BACTERIA USED IN FOODSTUFFS OR FOOD PREPARATION",2017
A61Q,SPECIFIC USE OF COSMETICS OR SIMILAR TOILETRY PREPARATIONS,2018
H02M,"APPARATUS FOR CONVERSION BETWEEN AC AND AC, BETWEEN AC AND DC, OR BETWEEN DC AND DC, AND FOR USE WITH MAINS OR SIMILAR POWER SUPPLY SYSTEMS; CONVERSION OF DC OR AC INPUT POWER INTO SURGE OUTPUT POWER; CONTROL OR REGULATION THEREOF",2021
B25J,MANIPULATORS; CHAMBERS PROVIDED WITH MANIPULATION DEVICES,2021
C22C,ALLOYS,2017
G01B,"MEASURING LENGTH, THICKNESS OR SIMILAR LINEAR DIMENSIONS; MEASURING ANGLES; MEASURING AREAS; MEASURING IRREGULARITIES OF SURFACES OR CONTOURS",2022
F24F,AIR-CONDITIONING; AIR-HUMIDIFICATION; VENTILATION; USE OF AIR CURRENTS FOR SCREENING,2022
G10L,SPEECH ANALYSIS TECHNIQUES OR SPEECH SYNTHESIS; SPEECH RECOGNITION; SPEECH OR VOICE PROCESSING TECHNIQUES; SPEECH OR AUDIO CODING OR DECODING,2020
G08G,TRAFFIC CONTROL SYSTEMS,2021
B08B,CLEANING IN GENERAL; PREVENTION OF FOULING IN GENERAL,2022
G08B,SIGNALLING OR CALLING SYSTEMS; ORDER TELEGRAPHS; ALARM SYSTEMS,2022
A01N,"PRESERVATION OF BODIES OF HUMANS OR ANIMALS OR PLANTS OR PARTS THEREOF; BIOCIDES, e.g. AS DISINFECTANTS, AS PESTICIDES OR AS HERBICIDES; PEST REPELLANTS OR ATTRACTANTS; PLANT GROWTH REGULATORS",2018
F16H,GEARING,2017
G11C,STATIC STORES,2021
A01G,"HORTICULTURE; CULTIVATION OF VEGETABLES, FLOWERS, RICE, FRUIT, VINES, HOPS OR SEAWEED; FORESTRY; WATERING",2017
G01M,"TESTING STATIC OR DYNAMIC BALANCE OF MACHINES OR STRUCTURES; TESTING OF STRUCTURES OR APPARATUS, NOT OTHERWISE PROVIDED FOR",2018
H01F,MAGNETS; INDUCTANCES; TRANSFORMERS; SELECTION OF MATERIALS FOR THEIR MAGNETIC PROPERTIES,2018
F21V,"FUNCTIONAL FEATURES OR DETAILS OF LIGHTING DEVICES OR SYSTEMS THEREOF; STRUCTURAL COMBINATIONS OF LIGHTING DEVICES WITH OTHER ARTICLES, NOT OTHERWISE PROVIDED FOR",2018
H04R,"LOUDSPEAKERS, MICROPHONES, GRAMOPHONE PICK-UPS OR LIKE ACOUSTIC ELECTROMECHANICAL TRANSDUCERS; DEAF-AID SETS; PUBLIC ADDRESS SYSTEMS",2022
A61N,ELECTROTHERAPY; MAGNETOTHERAPY; RADIATION THERAPY; ULTRASOUND THERAPY,2021
A01K,"ANIMAL HUSBANDRY; AVICULTURE; APICULTURE; PISCICULTURE; FISHING; REARING OR BREEDING ANIMALS, NOT OTHERWISE PROVIDED FOR; NEW BREEDS OF ANIMALS",2018
B29L,"INDEXING SCHEME ASSOCIATED WITH SUBCLASS B29C, RELATING TO PARTICULAR ARTICLES",2018
F16L,"PIPES; JOINTS OR FITTINGS FOR PIPES; SUPPORTS FOR PIPES, CABLES OR PROTECTIVE TUBING; MEANS FOR THERMAL INSULATION IN GENERAL",2018
H01Q,"ANTENNAS, i.e. RADIO AERIALS",2021
C09J,ADHESIVES; NON-MECHANICAL ASPECTS OF ADHESIVE PROCESSES IN GENERAL; ADHESIVE PROCESSES NOT PROVIDED FOR ELSEWHERE; USE OF MATERIALS AS ADHESIVES,2021
H01J,ELECTRIC DISCHARGE TUBES OR DISCHARGE LAMPS,2021
B33Y,"ADDITIVE MANUFACTURING, i.e. MANUFACTURING OF THREE-DIMENSIONAL [3-D] OBJECTS BY ADDITIVE DEPOSITION, ADDITIVE AGGLOMERATION OR ADDITIVE LAYERING, e.g. BY 3-D PRINTING, STEREOLITHOGRAPHY OR SELECTIVE LASER SINTERING",2022


2025-01-27 02:08:49 - root - INFO - Please check the answer again by reviewing Identify the CPC technology areas with the highest exponential moving average of patent filings each year (smoothing factor 0.2), and provide the full title and the best year for each CPC group at level 5., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
CPC_Symbol,Full_Title,Best_Year
symbol1:str,titleFull1:str,year1:int
symbol2:str,titleFull2:str,year2:int
...
```

The table above lists the CPC technology areas at level 5 with the highest exponential moving average (EMA) of patent filings each year, using a smoothing factor of 0.2. For each CPC group, we've provided the symbol, the full title, and the best year—that is, the year with the highest number of patent filings in that group. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Too long, hard cut:
CPC_Symbol,Full_Title,Best_Year
G06F,ELECTRIC DIGITAL DATA PROCESSING,2021
Y02E,"REDUCTION OF GREENHOUSE GAS [GHG] EMISSIONS, RELATED TO ENERGY GENERATION, TRANSMISSION OR DISTRIBUTION",2023
Y02P,CLIMATE CHANGE MITIGATION TECHNOLOGIES IN THE PRODUCTION OR PROCESSING OF GOODS,2023
A61K,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",2021
H04L,"TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION",2021
H01L,SEMICONDUCTOR DEVICES NOT COVERED BY CLASS H10,2021
A61P,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2021
H04W,WIRELESS COMMUNICATION NETWORKS,2021
Y02A,TECHNOLOGIES FOR ADAPTATION TO CLIMATE CHANGE,2023
G06Q,"INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES; SYSTEMS OR METHODS SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES, NOT OTHERWISE PROVIDED FOR",2022
G01N,INVESTIGATING OR ANALYSING MATERIALS BY DETERMINING THEIR CHEMICAL OR PHYSICAL PROPERTIES,2021
H04N,"PICTORIAL COMMUNICATION, e.g. TELEVISION",2021
A61B,DIAGNOSIS; SURGERY; IDENTIFICATION,2021
G06T,"IMAGE DATA PROCESSING OR GENERATION, IN GENERAL",2021
Y02T,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,2023
G06N,COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS,2022
C12N,"MICROORGANISMS OR ENZYMES; COMPOSITIONS THEREOF; PROPAGATING, PRESERVING, OR MAINTAINING MICROORGANISMS; MUTATION OR GENETIC ENGINEERING; CULTURE MEDIA",2021
H01M,"PROCESSES OR MEANS, e.g. BATTERIES, FOR THE DIRECT CONVERSION OF CHEMICAL ENERGY INTO ELECTRICAL ENERGY",2022
G02B,"OPTICAL ELEMENTS, SYSTEMS OR APPARATUS",2021
G06V,IMAGE OR VIDEO RECOGNITION OR UNDERSTANDING,2021
Y02W,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO WASTEWATER TREATMENT OR WASTE MANAGEMENT,2023
C07K,PEPTIDES,2021
Y02B,"CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO BUILDINGS, e.g. HOUSING, HOUSE APPLIANCES OR RELATED END-USER APPLICATIONS",2023
C07D,HETEROCYCLIC COMPOUNDS,2018
B01D,SEPARATION,2018
C08L,COMPOSITIONS OF MACROMOLECULAR COMPOUNDS,2018
H04B,TRANSMISSION,2021
Y02D,"CLIMATE CHANGE MITIGATION TECHNOLOGIES IN INFORMATION AND COMMUNICATION TECHNOLOGIES [ICT], I.E. INFORMATION AND COMMUNICATION TECHNOLOGIES AIMING AT THE REDUCTION OF THEIR OWN ENERGY USE",2023
B29C,"SHAPING OR JOINING OF PLASTICS; SHAPING OF MATERIAL IN A PLASTIC STATE, NOT OTHERWISE PROVIDED FOR; AFTER-TREATMENT OF THE SHAPED PRODUCTS, e.g. REPAIRING",2018
H02J,CIRCUIT ARRANGEMENTS OR SYSTEMS FOR SUPPLYING OR DISTRIBUTING ELECTRIC POWER; SYSTEMS FOR STORING ELECTRIC ENERGY,2022
A61M,"DEVICES FOR INTRODUCING MEDIA INTO, OR ONTO, THE BODY; DEVICES FOR TRANSDUCING BODY MEDIA OR FOR TAKING MEDIA FROM THE BODY; DEVICES FOR PRODUCING OR ENDING SLEEP OR STUPOR",2021
C08K,Use of inorganic or non-macromolecular organic substances as compounding ingredients,2018
H05K,PRINTED CIRCUITS; CASINGS OR CONSTRUCTIONAL DETAILS OF ELECTRIC APPARATUS; MANUFACTURE OF ASSEMBLAGES OF ELECTRICAL COMPONENTS,2022
G01R,MEASURING ELECTRIC VARIABLES; MEASURING MAGNETIC VARIABLES,2022
G01S,RADIO DIRECTION-FINDING; RADIO NAVIGATION; DETERMINING DISTANCE OR VELOCITY BY USE OF RADIO WAVES; LOCATING OR PRESENCE-DETECTING BY USE OF THE REFLECTION OR RERADIATION OF RADIO WAVES; ANALOGOUS ARRANGEMENTS USING OTHER WAVES,2021
B01J,"CHEMICAL OR PHYSICAL PROCESSES, e.g. CATALYSIS OR COLLOID CHEMISTRY; THEIR RELEVANT APPARATUS",2018
G05B,CONTROL OR REGULATING SYSTEMS IN GENERAL; FUNCTIONAL ELEMENTS OF SUCH SYSTEMS; MONITORING OR TESTING ARRANGEMENTS FOR SUCH SYSTEMS OR ELEMENTS,2021
B32B,"LAYERED PRODUCTS, i.e. PRODUCTS BUILT-UP OF STRATA OF FLAT OR NON-FLAT, e.g. CELLULAR OR HONEYCOMB, FORM",2018
A61F,"FILTERS IMPLANTABLE INTO BLOOD VESSELS; PROSTHESES; DEVICES PROVIDING PATENCY TO, OR PREVENTING COLLAPSING OF, TUBULAR STRUCTURES OF THE BODY, e.g. STENTS; ORTHOPAEDIC, NURSING OR CONTRACEPTIVE DEVICES; FOMENTATION; TREATMENT OR PROTECTION OF EYES OR EARS; BANDAGES, DRESSINGS OR ABSORBENT PADS; FIRST-AID KITS",2020
C08G,MACROMOLECULAR COMPOUNDS OBTAINED OTHERWISE THAN BY REACTIONS ONLY INVOLVING UNSATURATED CARBON-TO-CARBON BONDS,2018
C07C,ACYCLIC OR CARBOCYCLIC COMPOUNDS,2018
C09D,"COATING COMPOSITIONS, e.g. PAINTS, VARNISHES OR LACQUERS; FILLING PASTES; CHEMICAL PAINT OR INK REMOVERS; INKS; CORRECTING FLUIDS; WOODSTAINS; PASTES OR SOLIDS FOR COLOURING OR PRINTING; USE OF MATERIALS THEREFOR",2017
H10K,ORGANIC ELECTRIC SOLID-STATE DEVICES,2021
B60R,"VEHICLES, VEHICLE FITTINGS, OR VEHICLE PARTS, NOT OTHERWISE PROVIDED FOR",2021
Y10T,TECHNICAL SUBJECTS COVERED BY FORMER US CLASSIFICATION,2014
A23L,"FOODS, FOODSTUFFS, OR NON-ALCOHOLIC BEVERAGES, NOT COVERED BY SUBCLASSES A21D OR A23B-A23J; THEIR PREPARATION OR TREATMENT, e.g. COOKING, MODIFICATION OF NUTRITIVE QUALITIES, PHYSICAL TREATMENT; PRESERVATION OF FOODS OR FOODSTUFFS, IN GENERAL",2018
C02F,"TREATMENT OF WATER, WASTE WATER, SEWAGE, OR SLUDGE",2018
B65D,"CONTAINERS FOR STORAGE OR TRANSPORT OF ARTICLES OR MATERIALS, e.g. BAGS, BARRELS, BOTTLES, BOXES, CANS, CARTONS, CRATES, DRUMS, JARS, TANKS, HOPPERS, FORWARDING CONTAINERS; ACCESSORIES, CLOSURES, OR FITTINGS THEREFOR; PACKAGING ELEMENTS; PACKAGES",2018
G06K,GRAPHICAL DATA READING; PRESENTATION OF DATA; RECORD CARRIERS; HANDLING RECORD CARRIERS,2021
C08J,"WORKING-UP; GENERAL PROCESSES OF COMPOUNDING; AFTER-TREATMENT NOT COVERED BY SUBCLASSES C08B, C08C, C08F, C08G or C08H",2018
G16H,"HEALTHCARE INFORMATICS, i.e. INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR THE HANDLING OR PROCESSING OF MEDICAL OR HEALTHCARE DATA",2021
G02F,OPTICAL DEVICES OR ARRANGEMENTS FOR THE CONTROL OF LIGHT BY MODIFICATION OF THE OPTICAL PROPERTIES OF THE MEDIA OF THE ELEMENTS INVOLVED THEREIN; NON-LINEAR OPTICS; FREQUENCY-CHANGING OF LIGHT; OPTICAL LOGIC ELEMENTS; OPTICAL ANALOGUE/DIGITAL CONVERTERS,2021
C12Q,"MEASURING OR TESTING PROCESSES INVOLVING ENZYMES, NUCLEIC ACIDS OR MICROORGANISMS; COMPOSITIONS OR TEST PAPERS THEREFOR; PROCESSES OF PREPARING SUCH COMPOSITIONS; CONDITION-RESPONSIVE CONTROL IN MICROBIOLOGICAL OR ENZYMOLOGICAL PROCESSES",2021
C09K,"MATERIALS FOR MISCELLANEOUS APPLICATIONS, NOT PROVIDED FOR ELSEWHERE",2018
C23C,"COATING METALLIC MATERIAL; COATING MATERIAL WITH METALLIC MATERIAL; SURFACE TREATMENT OF METALLIC MATERIAL BY DIFFUSION INTO THE SURFACE, BY CHEMICAL CONVERSION OR SUBSTITUTION; COATING BY VACUUM EVAPORATION, BY SPUTTERING, BY ION IMPLANTATION OR BY CHEMICAL VAPOUR DEPOSITION, IN GENERAL",2018
G09G,ARRANGEMENTS OR CIRCUITS FOR CONTROL OF INDICATING DEVICES USING STATIC MEANS TO PRESENT VARIABLE INFORMATION,2021
B23K,"SOLDERING OR UNSOLDERING; WELDING; CLADDING OR PLATING BY SOLDERING OR WELDING; CUTTING BY APPLYING HEAT LOCALLY, e.g. FLAME CUTTING; WORKING BY LASER BEAM",2018
B60W,CONJOINT CONTROL OF VEHICLE SUB-UNITS OF DIFFERENT TYPE OR DIFFERENT FUNCTION; CONTROL SYSTEMS SPECIALLY ADAPTED FOR HYBRID VEHICLES; ROAD VEHICLE DRIVE CONTROL SYSTEMS FOR PURPOSES NOT RELATED TO THE CONTROL OF A PARTICULAR SUB-UNIT,2022
B65G,"TRANSPORT OR STORAGE DEVICES, e.g. CONVEYORS FOR LOADING OR TIPPING, SHOP CONVEYOR SYSTEMS OR PNEUMATIC TUBE CONVEYORS",2022
E21B,"EARTH OR ROCK DRILLING; OBTAINING OIL, GAS, WATER, SOLUBLE OR MELTABLE MATERIALS OR A SLURRY OF MINERALS FROM WELLS",2021
H02K,DYNAMO-ELECTRIC MACHINES,2020
H05B,"ELECTRIC HEATING; ELECTRIC LIGHT SOURCES NOT OTHERWISE PROVIDED FOR; CIRCUIT ARRANGEMENTS FOR ELECTRIC LIGHT SOURCES, IN GENERAL",2018
A61L,"METHODS OR APPARATUS FOR STERILISING MATERIALS OR OBJECTS IN GENERAL; DISINFECTION, STERILISATION OR DEODORISATION OF AIR; CHEMICAL ASPECTS OF BANDAGES, DRESSINGS, ABSORBENT PADS OR SURGICAL ARTICLES; MATERIALS FOR BANDAGES, DRESSINGS, ABSORBENT PADS OR SURGICAL ARTICLES",2022
B60L,PROPULSION OF ELECTRICALLY-PROPELLED VEHICLES; SUPPLYING ELECTRIC POWER FOR AUXILIARY EQUIPMENT OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRODYNAMIC BRAKE SYSTEMS FOR VEHICLES IN GENERAL; MAGNETIC SUSPENSION OR LEVITATION FOR VEHICLES; MONITORING OPERATING VARIABLES OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRIC SAFETY DEVICES FOR ELECTRICALLY-PROPELLED VEHICLES,2021
G05D,SYSTEMS FOR CONTROLLING OR REGULATING NON-ELECTRIC VARIABLES,2020
H04M,TELEPHONIC COMMUNICATION,2021
B60K,"ARRANGEMENT OR MOUNTING OF PROPULSION UNITS OR OF TRANSMISSIONS IN VEHICLES; ARRANGEMENT OR MOUNTING OF PLURAL DIVERSE PRIME-MOVERS IN VEHICLES; AUXILIARY DRIVES FOR VEHICLES; INSTRUMENTATION OR DASHBOARDS FOR VEHICLES; ARRANGEMENTS IN CONNECTION WITH COOLING, AIR INTAKE, GAS EXHAUST OR FUEL SUPPLY OF PROPULSION UNITS IN VEHICLES",2018
C08F,MACROMOLECULAR COMPOUNDS OBTAINED BY REACTIONS ONLY INVOLVING CARBON-TO-CARBON UNSATURATED BONDS,2018
H01R,ELECTRICALLY-CONDUCTIVE CONNECTIONS; STRUCTURAL ASSOCIATIONS OF A PLURALITY OF MUTUALLY-INSULATED ELECTRICAL CONNECTING ELEMENTS; COUPLING DEVICES; CURRENT COLLECTORS,2018
B62D,MOTOR VEHICLES; TRAILERS,2021
C04B,"LIME, MAGNESIA; SLAG; CEMENTS; COMPOSITIONS THEREOF, e.g. MORTARS, CONCRETE OR LIKE BUILDING MATERIALS; ARTIFICIAL STONE; CERAMICS; REFRACTORIES; TREATMENT OF NATURAL STONE",2018
G01C,"MEASURING DISTANCES, LEVELS OR BEARINGS; SURVEYING; NAVIGATION; GYROSCOPIC INSTRUMENTS; PHOTOGRAMMETRY OR VIDEOGRAMMETRY",2021
C01B,NON-METALLIC ELEMENTS; COMPOUNDS THEREOF; METALLOIDS OR COMPOUNDS THEREOF NOT COVERED BY SUBCLASS C01C,2022
A23V,"INDEXING SCHEME RELATING TO FOODS, FOODSTUFFS OR NON-ALCOHOLIC BEVERAGES AND LACTIC OR PROPIONIC ACID BACTERIA USED IN FOODSTUFFS OR FOOD PREPARATION",2017
A61Q,SPECIFIC USE OF COSMETICS OR SIMILAR TOILETRY PREPARATIONS,2018
H02M,"APPARATUS FOR CONVERSION BETWEEN AC AND AC, BETWEEN AC AND DC, OR BETWEEN DC AND DC, AND FOR USE WITH MAINS OR SIMILAR POWER SUPPLY SYSTEMS; CONVERSION OF DC OR AC INPUT POWER INTO SURGE OUTPUT POWER; CONTROL OR REGULATION THEREOF",2021
B25J,MANIPULATORS; CHAMBERS PROVIDED WITH MANIPULATION DEVICES,2021
C22C,ALLOYS,2017
G01B,"MEASURING LENGTH, THICKNESS OR SIMILAR LINEAR DIMENSIONS; MEASURING ANGLES; MEASURING AREAS; MEASURI
Current sql:
WITH level5_cpc AS (
    SELECT
        TRIM("symbol") AS "cpc_symbol",
        "titleFull" AS "full_title"
    FROM
        PATENTS.PATENTS.CPC_DEFINITION
    WHERE
        "level" = 5
),
publication_cpc AS (
    SELECT
        p."publication_number",
        c.value:"code"::STRING AS "cpc_symbol_full",
        EXTRACT(year FROM TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD')) AS "year"
    FROM
        PATENTS.PATENTS.PUBLICATIONS p,
        LATERAL FLATTEN(input => p."cpc") c
    WHERE
        c.value:"code"::STRING IS NOT NULL
        AND p."publication_date" IS NOT NULL
),
cpc_publications AS (
    SELECT
        TRIM(SUBSTRING(pc."cpc_symbol_full", 1, 4)) AS "cpc_symbol",
        pc."year",
        pc."publication_number"
    FROM
        publication_cpc pc
    WHERE
        pc."year" IS NOT NULL
        AND TRIM(SUBSTRING(pc."cpc_symbol_full", 1, 4)) IS NOT NULL
),
cpc_publications_with_title AS (
    SELECT
        cp."cpc_symbol",
        cp."year",
        cp."publication_number",
        l5."full_title"
    FROM
        cpc_publications cp
    INNER JOIN
        level5_cpc l5
    ON
        cp."cpc_symbol" = l5."cpc_symbol"
),
annual_counts AS (
    SELECT
        cp."cpc_symbol",
        cp."full_title",
        cp."year",
        COUNT(DISTINCT cp."publication_number") AS "num_publications"
    FROM
        cpc_publications_with_title cp
    GROUP BY
        cp."cpc_symbol",
        cp."full_title",
        cp."year"
),
ordered_counts AS (
    SELECT
        ac.*,
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."year") AS "rn"
    FROM
        annual_counts ac
),
ema_calc AS (
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        CAST(oc."num_publications" AS FLOAT) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    WHERE
        oc."rn" = 1
    UNION ALL
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        ROUND(0.2 * oc."num_publications" + 0.8 * ec."ema", 4) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    INNER JOIN
        ema_calc ec
        ON
            oc."cpc_symbol" = ec."cpc_symbol" AND oc."rn" = ec."rn" + 1
),
latest_ema AS (
    SELECT
        ec."cpc_symbol",
        ec."full_title",
        ec."year",
        ec."ema",
        ROW_NUMBER() OVER (PARTITION BY ec."cpc_symbol" ORDER BY ec."year" DESC) AS "rn"
    FROM
        ema_calc ec
),
ema_per_cpc AS (
    SELECT
        le."cpc_symbol",
        le."full_title",
        le."ema"
    FROM
        latest_ema le
    WHERE
        le."rn" = 1
),
best_years AS (
    SELECT
        ac."cpc_symbol",
        ac."full_title",
        ac."year" AS "best_year",
        ac."num_publications",
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."num_publications" DESC) AS "rn"
    FROM
        annual_counts ac
),
best_year_per_cpc AS (
    SELECT
        byc."cpc_symbol",
        byc."full_title",
        byc."best_year"
    FROM
        best_years byc
    WHERE
        byc."rn" = 1
)
SELECT
    epc."cpc_symbol" AS "CPC_Symbol",
    epc."full_title" AS "Full_Title",
    byp."best_year" AS "Best_Year"
FROM
    ema_per_cpc epc
JOIN
    best_year_per_cpc byp
ON
    epc."cpc_symbol" = byp."cpc_symbol"
ORDER BY
    epc."ema" DESC NULLS LAST
LIMIT 100;
2025-01-27 02:10:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 02:10:38 - root - INFO - ```sql
WITH level5_cpc AS (
    SELECT
        TRIM("symbol") AS "cpc_symbol",
        "titleFull" AS "full_title"
    FROM
        PATENTS.PATENTS.CPC_DEFINITION
    WHERE
        "level" = 5
),
publication_cpc AS (
    SELECT
        p."publication_number",
        c.value:"code"::STRING AS "cpc_code",
        EXTRACT(year FROM TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD')) AS "year"
    FROM
        PATENTS.PATENTS.PUBLICATIONS p,
        LATERAL FLATTEN(input => p."cpc") c
    WHERE
        c.value:"code"::STRING IS NOT NULL
        AND p."publication_date" IS NOT NULL
),
cpc_publications AS (
    SELECT
        cp."cpc_code",
        cp."year",
        cp."publication_number",
        l5."full_title"
    FROM
        publication_cpc cp
    INNER JOIN
        level5_cpc l5
    ON
        TRIM(SUBSTRING(cp."cpc_code", 1, 4)) = l5."cpc_symbol"
),
annual_counts AS (
    SELECT
        cp."cpc_code",
        cp."full_title",
        cp."year",
        COUNT(DISTINCT cp."publication_number") AS "num_publications"
    FROM
        cpc_publications cp
    GROUP BY
        cp."cpc_code",
        cp."full_title",
        cp."year"
),
ordered_counts AS (
    SELECT
        ac.*,
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_code" ORDER BY ac."year") AS "rn"
    FROM
        annual_counts ac
),
ema_calc AS (
    SELECT
        oc."cpc_code",
        oc."full_title",
        oc."year",
        oc."num_publications",
        CAST(oc."num_publications" AS FLOAT) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    WHERE
        oc."rn" = 1
    UNION ALL
    SELECT
        oc."cpc_code",
        oc."full_title",
        oc."year",
        oc."num_publications",
        ROUND(0.2 * oc."num_publications" + 0.8 * ec."ema", 4) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    INNER JOIN
        ema_calc ec
        ON
            oc."cpc_code" = ec."cpc_code" AND oc."rn" = ec."rn" + 1
),
latest_ema AS (
    SELECT
        ec."cpc_code",
        ec."full_title",
        ec."year",
        ec."ema",
        ROW_NUMBER() OVER (PARTITION BY ec."cpc_code" ORDER BY ec."year" DESC) AS "rn"
    FROM
        ema_calc ec
),
ema_per_cpc AS (
    SELECT
        le."cpc_code",
        le."full_title",
        le."ema"
    FROM
        latest_ema le
    WHERE
        le."rn" = 1
),
best_years AS (
    SELECT
        ac."cpc_code",
        ac."full_title",
        ac."year" AS "best_year",
        ac."num_publications",
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_code" ORDER BY ac."num_publications" DESC) AS "rn"
    FROM
        annual_counts ac
),
best_year_per_cpc AS (
    SELECT
        byc."cpc_code",
        byc."full_title",
        byc."best_year"
    FROM
        best_years byc
    WHERE
        byc."rn" = 1
)
SELECT
    epc."cpc_code" AS "CPC_Symbol",
    epc."full_title" AS "Full_Title",
    byp."best_year" AS "Best_Year"
FROM
    ema_per_cpc epc
JOIN
    best_year_per_cpc byp
ON
    epc."cpc_code" = byp."cpc_code"
ORDER BY
    epc."ema" DESC NULLS LAST
LIMIT 100;
```
2025-01-27 02:10:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 02:10:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 02:10:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 02:10:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 02:10:41 - snowflake.connector.connection - INFO - closed
2025-01-27 02:10:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 02:10:42 - root - INFO - itercount: 7
2025-01-27 02:10:42 - root - INFO - 0
2025-01-27 02:10:42 - root - INFO - results: 
CPC_Symbol,Full_Title,Best_Year
Y02E60/10,"REDUCTION OF GREENHOUSE GAS [GHG] EMISSIONS, RELATED TO ENERGY GENERATION, TRANSMISSION OR DISTRIBUTION",2023
A61P35/00,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2021
Y02P70/10,CLIMATE CHANGE MITIGATION TECHNOLOGIES IN THE PRODUCTION OR PROCESSING OF GOODS,2023
Y02P70/50,CLIMATE CHANGE MITIGATION TECHNOLOGIES IN THE PRODUCTION OR PROCESSING OF GOODS,2022
G06N3/08,COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS,2022
Y02E10/50,"REDUCTION OF GREENHOUSE GAS [GHG] EMISSIONS, RELATED TO ENERGY GENERATION, TRANSMISSION OR DISTRIBUTION",2023
Y02T10/70,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,2021
A61K45/06,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",2021
Y02A50/30,TECHNOLOGIES FOR ADAPTATION TO CLIMATE CHANGE,2023
Y02D30/70,"CLIMATE CHANGE MITIGATION TECHNOLOGIES IN INFORMATION AND COMMUNICATION TECHNOLOGIES [ICT], I.E. INFORMATION AND COMMUNICATION TECHNOLOGIES AIMING AT THE REDUCTION OF THEIR OWN ENERGY USE",2023
G06N3/045,COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS,2021
G06N20/00,COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS,2021
Y02D10/00,"CLIMATE CHANGE MITIGATION TECHNOLOGIES IN INFORMATION AND COMMUNICATION TECHNOLOGIES [ICT], I.E. INFORMATION AND COMMUNICATION TECHNOLOGIES AIMING AT THE REDUCTION OF THEIR OWN ENERGY USE",2023
A61P43/00,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2009
A23V2002/00,"INDEXING SCHEME RELATING TO FOODS, FOODSTUFFS OR NON-ALCOHOLIC BEVERAGES AND LACTIC OR PROPIONIC ACID BACTERIA USED IN FOODSTUFFS OR FOOD PREPARATION",2018
A61P29/00,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2009
H01M10/0525,"PROCESSES OR MEANS, e.g. BATTERIES, FOR THE DIRECT CONVERSION OF CHEMICAL ENERGY INTO ELECTRICAL ENERGY",2021
Y02T10/7072,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,2021
A61P25/00,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2009
A61K2039/505,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",2022
Y02P90/02,CLIMATE CHANGE MITIGATION TECHNOLOGIES IN THE PRODUCTION OR PROCESSING OF GOODS,2023
H04W72/23,WIRELESS COMMUNICATION NETWORKS,2021
Y02E60/50,"REDUCTION OF GREENHOUSE GAS [GHG] EMISSIONS, RELATED TO ENERGY GENERATION, TRANSMISSION OR DISTRIBUTION",2022
Y02P10/20,CLIMATE CHANGE MITIGATION TECHNOLOGIES IN THE PRODUCTION OR PROCESSING OF GOODS,2023
A61P25/28,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2009
G06T2207/20081,"IMAGE DATA PROCESSING OR GENERATION, IN GENERAL",2022
Y02P10/25,CLIMATE CHANGE MITIGATION TECHNOLOGIES IN THE PRODUCTION OR PROCESSING OF GOODS,2023
G06V10/82,IMAGE OR VIDEO RECOGNITION OR UNDERSTANDING,2023
H01M10/052,"PROCESSES OR MEANS, e.g. BATTERIES, FOR THE DIRECT CONVERSION OF CHEMICAL ENERGY INTO ELECTRICAL ENERGY",2021
Y02T10/40,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,2023
G06T2207/20084,"IMAGE DATA PROCESSING OR GENERATION, IN GENERAL",2023
A61P3/10,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2008
G06F30/20,ELECTRIC DIGITAL DATA PROCESSING,2022
H04L67/12,"TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION",2020
A61P31/04,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2022
Y02W30/62,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO WASTEWATER TREATMENT OR WASTE MANAGEMENT,2023
Y02E10/72,"REDUCTION OF GREENHOUSE GAS [GHG] EMISSIONS, RELATED TO ENERGY GENERATION, TRANSMISSION OR DISTRIBUTION",2023
A61K2300/00,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",2021
H04L5/0053,"TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION",2020
H04W4/80,WIRELESS COMMUNICATION NETWORKS,2021
H01M2220/20,"PROCESSES OR MEANS, e.g. BATTERIES, FOR THE DIRECT CONVERSION OF CHEMICAL ENERGY INTO ELECTRICAL ENERGY",2023
A61K38/00,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",2021
A61P11/00,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2007
G06F18/214,ELECTRIC DIGITAL DATA PROCESSING,2022
H04L5/0048,"TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION",2020
A61P9/00,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2009
A61P17/00,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2021
F21Y2115/10,"INDEXING SCHEME ASSOCIATED WITH SUBCLASSES F21K, F21L, F21S and F21V, RELATING TO THE FORM OR THE KIND OF THE LIGHT SOURCES OR OF THE COLOUR OF THE LIGHT EMITTED",2018
A61P35/02,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2021
Y02A50/20,TECHNOLOGIES FOR ADAPTATION TO CLIMATE CHANGE,2022
B33Y10/00,"ADDITIVE MANUFACTURING, i.e. MANUFACTURING OF THREE-DIMENSIONAL [3-D] OBJECTS BY ADDITIVE DEPOSITION, ADDITIVE AGGLOMERATION OR ADDITIVE LAYERING, e.g. BY 3-D PRINTING, STEREOLITHOGRAPHY OR SELECTIVE LASER SINTERING",2020
C07K2317/92,PEPTIDES,2022
C07K2317/76,PEPTIDES,2021
Y02T90/12,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,2021
Y02T10/12,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,2020
B32B7/12,"LAYERED PRODUCTS, i.e. PRODUCTS BUILT-UP OF STRATA OF FLAT OR NON-FLAT, e.g. CELLULAR OR HONEYCOMB, FORM",2019
H04W72/0446,WIRELESS COMMUNICATION NETWORKS,2022
A61K9/0019,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",2021
Y02P90/30,CLIMATE CHANGE MITIGATION TECHNOLOGIES IN THE PRODUCTION OR PROCESSING OF GOODS,2023
G16H50/20,"HEALTHCARE INFORMATICS, i.e. INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR THE HANDLING OR PROCESSING OF MEDICAL OR HEALTHCARE DATA",2022
H04N19/176,"PICTORIAL COMMUNICATION, e.g. TELEVISION",2020
C07K2317/24,PEPTIDES,2022
G06N3/084,COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS,2023
G06Q50/06,"INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES; SYSTEMS OR METHODS SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES, NOT OTHERWISE PROVIDED FOR",2022
C07D471/04,HETEROCYCLIC COMPOUNDS,2023
Y02T90/14,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,2021
B32B27/08,"LAYERED PRODUCTS, i.e. PRODUCTS BUILT-UP OF STRATA OF FLAT OR NON-FLAT, e.g. CELLULAR OR HONEYCOMB, FORM",2018
A61P19/02,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2009
A61P9/10,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2008
G06F3/0482,ELECTRIC DIGITAL DATA PROCESSING,2021
G06Q10/04,"INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES; SYSTEMS OR METHODS SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES, NOT OTHERWISE PROVIDED FOR",2022
Y02B20/40,"CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO BUILDINGS, e.g. HOUSING, HOUSE APPLIANCES OR RELATED END-USER APPLICATIONS",2023
H04W72/0453,WIRELESS COMMUNICATION NETWORKS,2021
G06T7/11,"IMAGE DATA PROCESSING OR GENERATION, IN GENERAL",2021
Y02B30/70,"CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO BUILDINGS, e.g. HOUSING, HOUSE APPLIANCES OR RELATED END-USER APPLICATIONS",2023
C07K2317/565,PEPTIDES,2021
G06Q50/10,"INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES; SYSTEMS OR METHODS SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES, NOT OTHERWISE PROVIDED FOR",2023
G06T7/0012,"IMAGE DATA PROCESSING OR GENERATION, IN GENERAL",2021
H04W24/10,WIRELESS COMMUNICATION NETWORKS,2021
Y02W10/10,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO WASTEWATER TREATMENT OR WASTE MANAGEMENT,2022
A61P1/16,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2011
A61P37/02,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2016
Y02A40/25,TECHNOLOGIES FOR ADAPTATION TO CLIMATE CHANGE,2021
G06V10/764,IMAGE OR VIDEO RECOGNITION OR UNDERSTANDING,2023
G06F3/011,ELECTRIC DIGITAL DATA PROCESSING,2021
A61Q19/00,SPECIFIC USE OF COSMETICS OR SIMILAR TOILETRY PREPARATIONS,2021
C07D487/04,HETEROCYCLIC COMPOUNDS,2021
A61P37/00,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2016
B82Y40/00,SPECIFIC USES OR APPLICATIONS OF NANOSTRUCTURES; MEASUREMENT OR ANALYSIS OF NANOSTRUCTURES; MANUFACTURE OR TREATMENT OF NANOSTRUCTURES,2021
A61P31/12,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2010
A61P27/02,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2016
A61P1/00,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2021
C08J5/18,"WORKING-UP; GENERAL PROCESSES OF COMPOUNDING; AFTER-TREATMENT NOT COVERED BY SUBCLASSES C08B, C08C, C08F, C08G or C08H",2022
Y02A40/81,TECHNOLOGIES FOR ADAPTATION TO CLIMATE CHANGE,2022
H04N19/70,"PICTORIAL COMMUNICATION, e.g. TELEVISION",2023
B82Y30/00,SPECIFIC USES OR APPLICATIONS OF NANOSTRUCTURES; MEASUREMENT OR ANALYSIS OF NANOSTRUCTURES; MANUFACTURE OR TREATMENT OF NANOSTRUCTURES,2021
Y02E10/549,"REDUCTION OF GREENHOUSE GAS [GHG] EMISSIONS, RELATED TO ENERGY GENERATION, TRANSMISSION OR DISTRIBUTION",2020
C22C38/02,ALLOYS,2022
A61P31/00,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2009
G06T7/70,"IMAGE DATA PROCESSING OR GENERATION, IN GENERAL",2021


2025-01-27 02:10:42 - root - INFO - Please check the answer again by reviewing Identify the CPC technology areas with the highest exponential moving average of patent filings each year (smoothing factor 0.2), and provide the full title and the best year for each CPC group at level 5., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
CPC_Symbol,Full_Title,Best_Year
symbol1:str,titleFull1:str,year1:int
symbol2:str,titleFull2:str,year2:int
...
```

The table above lists the CPC technology areas at level 5 with the highest exponential moving average (EMA) of patent filings each year, using a smoothing factor of 0.2. For each CPC group, we've provided the symbol, the full title, and the best year—that is, the year with the highest number of patent filings in that group. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
CPC_Symbol,Full_Title,Best_Year
Y02E60/10,"REDUCTION OF GREENHOUSE GAS [GHG] EMISSIONS, RELATED TO ENERGY GENERATION, TRANSMISSION OR DISTRIBUTION",2023
A61P35/00,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2021
Y02P70/10,CLIMATE CHANGE MITIGATION TECHNOLOGIES IN THE PRODUCTION OR PROCESSING OF GOODS,2023
Y02P70/50,CLIMATE CHANGE MITIGATION TECHNOLOGIES IN THE PRODUCTION OR PROCESSING OF GOODS,2022
G06N3/08,COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS,2022
Y02E10/50,"REDUCTION OF GREENHOUSE GAS [GHG] EMISSIONS, RELATED TO ENERGY GENERATION, TRANSMISSION OR DISTRIBUTION",2023
Y02T10/70,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,2021
A61K45/06,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",2021
Y02A50/30,TECHNOLOGIES FOR ADAPTATION TO CLIMATE CHANGE,2023
Y02D30/70,"CLIMATE CHANGE MITIGATION TECHNOLOGIES IN INFORMATION AND COMMUNICATION TECHNOLOGIES [ICT], I.E. INFORMATION AND COMMUNICATION TECHNOLOGIES AIMING AT THE REDUCTION OF THEIR OWN ENERGY USE",2023
G06N3/045,COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS,2021
G06N20/00,COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS,2021
Y02D10/00,"CLIMATE CHANGE MITIGATION TECHNOLOGIES IN INFORMATION AND COMMUNICATION TECHNOLOGIES [ICT], I.E. INFORMATION AND COMMUNICATION TECHNOLOGIES AIMING AT THE REDUCTION OF THEIR OWN ENERGY USE",2023
A61P43/00,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2009
A23V2002/00,"INDEXING SCHEME RELATING TO FOODS, FOODSTUFFS OR NON-ALCOHOLIC BEVERAGES AND LACTIC OR PROPIONIC ACID BACTERIA USED IN FOODSTUFFS OR FOOD PREPARATION",2018
A61P29/00,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2009
H01M10/0525,"PROCESSES OR MEANS, e.g. BATTERIES, FOR THE DIRECT CONVERSION OF CHEMICAL ENERGY INTO ELECTRICAL ENERGY",2021
Y02T10/7072,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,2021
A61P25/00,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2009
A61K2039/505,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",2022
Y02P90/02,CLIMATE CHANGE MITIGATION TECHNOLOGIES IN THE PRODUCTION OR PROCESSING OF GOODS,2023
H04W72/23,WIRELESS COMMUNICATION NETWORKS,2021
Y02E60/50,"REDUCTION OF GREENHOUSE GAS [GHG] EMISSIONS, RELATED TO ENERGY GENERATION, TRANSMISSION OR DISTRIBUTION",2022
Y02P10/20,CLIMATE CHANGE MITIGATION TECHNOLOGIES IN THE PRODUCTION OR PROCESSING OF GOODS,2023
A61P25/28,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2009
G06T2207/20081,"IMAGE DATA PROCESSING OR GENERATION, IN GENERAL",2022
Y02P10/25,CLIMATE CHANGE MITIGATION TECHNOLOGIES IN THE PRODUCTION OR PROCESSING OF GOODS,2023
G06V10/82,IMAGE OR VIDEO RECOGNITION OR UNDERSTANDING,2023
H01M10/052,"PROCESSES OR MEANS, e.g. BATTERIES, FOR THE DIRECT CONVERSION OF CHEMICAL ENERGY INTO ELECTRICAL ENERGY",2021
Y02T10/40,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,2023
G06T2207/20084,"IMAGE DATA PROCESSING OR GENERATION, IN GENERAL",2023
A61P3/10,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2008
G06F30/20,ELECTRIC DIGITAL DATA PROCESSING,2022
H04L67/12,"TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION",2020
A61P31/04,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2022
Y02W30/62,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO WASTEWATER TREATMENT OR WASTE MANAGEMENT,2023
Y02E10/72,"REDUCTION OF GREENHOUSE GAS [GHG] EMISSIONS, RELATED TO ENERGY GENERATION, TRANSMISSION OR DISTRIBUTION",2023
A61K2300/00,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",2021
H04L5/0053,"TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION",2020
H04W4/80,WIRELESS COMMUNICATION NETWORKS,2021
H01M2220/20,"PROCESSES OR MEANS, e.g. BATTERIES, FOR THE DIRECT CONVERSION OF CHEMICAL ENERGY INTO ELECTRICAL ENERGY",2023
A61K38/00,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",2021
A61P11/00,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2007
G06F18/214,ELECTRIC DIGITAL DATA PROCESSING,2022
H04L5/0048,"TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION",2020
A61P9/00,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2009
A61P17/00,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2021
F21Y2115/10,"INDEXING SCHEME ASSOCIATED WITH SUBCLASSES F21K, F21L, F21S and F21V, RELATING TO THE FORM OR THE KIND OF THE LIGHT SOURCES OR OF THE COLOUR OF THE LIGHT EMITTED",2018
A61P35/02,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2021
Y02A50/20,TECHNOLOGIES FOR ADAPTATION TO CLIMATE CHANGE,2022
B33Y10/00,"ADDITIVE MANUFACTURING, i.e. MANUFACTURING OF THREE-DIMENSIONAL [3-D] OBJECTS BY ADDITIVE DEPOSITION, ADDITIVE AGGLOMERATION OR ADDITIVE LAYERING, e.g. BY 3-D PRINTING, STEREOLITHOGRAPHY OR SELECTIVE LASER SINTERING",2020
C07K2317/92,PEPTIDES,2022
C07K2317/76,PEPTIDES,2021
Y02T90/12,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,2021
Y02T10/12,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,2020
B32B7/12,"LAYERED PRODUCTS, i.e. PRODUCTS BUILT-UP OF STRATA OF FLAT OR NON-FLAT, e.g. CELLULAR OR HONEYCOMB, FORM",2019
H04W72/0446,WIRELESS COMMUNICATION NETWORKS,2022
A61K9/0019,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",2021
Y02P90/30,CLIMATE CHANGE MITIGATION TECHNOLOGIES IN THE PRODUCTION OR PROCESSING OF GOODS,2023
G16H50/20,"HEALTHCARE INFORMATICS, i.e. INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR THE HANDLING OR PROCESSING OF MEDICAL OR HEALTHCARE DATA",2022
H04N19/176,"PICTORIAL COMMUNICATION, e.g. TELEVISION",2020
C07K2317/24,PEPTIDES,2022
G06N3/084,COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS,2023
G06Q50/06,"INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES; SYSTEMS OR METHODS SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES, NOT OTHERWISE PROVIDED FOR",2022
C07D471/04,HETEROCYCLIC COMPOUNDS,2023
Y02T90/14,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,2021
B32B27/08,"LAYERED PRODUCTS, i.e. PRODUCTS BUILT-UP OF STRATA OF FLAT OR NON-FLAT, e.g. CELLULAR OR HONEYCOMB, FORM",2018
A61P19/02,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2009
A61P9/10,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2008
G06F3/0482,ELECTRIC DIGITAL DATA PROCESSING,2021
G06Q10/04,"INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES; SYSTEMS OR METHODS SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES, NOT OTHERWISE PROVIDED FOR",2022
Y02B20/40,"CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO BUILDINGS, e.g. HOUSING, HOUSE APPLIANCES OR RELATED END-USER APPLICATIONS",2023
H04W72/0453,WIRELESS COMMUNICATION NETWORKS,2021
G06T7/11,"IMAGE DATA PROCESSING OR GENERATION, IN GENERAL",2021
Y02B30/70,"CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO BUILDINGS, e.g. HOUSING, HOUSE APPLIANCES OR RELATED END-USER APPLICATIONS",2023
C07K2317/565,PEPTIDES,2021
G06Q50/10,"INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES; SYSTEMS OR METHODS SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES, NOT OTHERWISE PROVIDED FOR",2023
G06T7/0012,"IMAGE DATA PROCESSING OR GENERATION, IN GENERAL",2021
H04W24/10,WIRELESS COMMUNICATION NETWORKS,2021
Y02W10/10,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO WASTEWATER TREATMENT OR WASTE MANAGEMENT,2022
A61P1/16,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2011
A61P37/02,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2016
Y02A40/25,TECHNOLOGIES FOR ADAPTATION TO CLIMATE CHANGE,2021
G06V10/764,IMAGE OR VIDEO RECOGNITION OR UNDERSTANDING,2023
G06F3/011,ELECTRIC DIGITAL DATA PROCESSING,2021
A61Q19/00,SPECIFIC USE OF COSMETICS OR SIMILAR TOILETRY PREPARATIONS,2021
C07D487/04,HETEROCYCLIC COMPOUNDS,2021
A61P37/00,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2016
B82Y40/00,SPECIFIC USES OR APPLICATIONS OF NANOSTRUCTURES; MEASUREMENT OR ANALYSIS OF NANOSTRUCTURES; MANUFACTURE OR TREATMENT OF NANOSTRUCTURES,2021
A61P31/12,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2010
A61P27/02,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2016
A61P1/00,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2021
C08J5/18,"WORKING-UP; GENERAL PROCESSES OF COMPOUNDING; AFTER-TREATMENT NOT COVERED BY SUBCLASSES C08B, C08C, C08F, C08G or C08H",2022
Y02A40/81,TECHNOLOGIES FOR ADAPTATION TO CLIMATE CHANGE,2022
H04N19/70,"PICTORIAL COMMUNICATION, e.g. TELEVISION",2023
B82Y30/00,SPECIFIC USES OR APPLICATIONS OF NANOSTRUCTURES; MEASUREMENT OR ANALYSIS OF NANOSTRUCTURES; MANUFACTURE OR TREATMENT OF NANOSTRUCTURES,2021
Y02E10/549,"REDUCTION OF GREENHOUSE GAS [GHG] EMISSIONS, RELATED TO ENERGY GENERATION, TRANSMISSION OR DISTRIBUTION",2020
C22C38/02,ALLOYS,2022
A61P31/00,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2009
G06T7/70,"IMAGE DATA PROCESSING OR GENERATION, IN GENERAL",2021
Current sql:
WITH level5_cpc AS (
    SELECT
        TRIM("symbol") AS "cpc_symbol",
        "titleFull" AS "full_title"
    FROM
        PATENTS.PATENTS.CPC_DEFINITION
    WHERE
        "level" = 5
),
publication_cpc AS (
    SELECT
        p."publication_number",
        c.value:"code"::STRING AS "cpc_code",
        EXTRACT(year FROM TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD')) AS "year"
    FROM
        PATENTS.PATENTS.PUBLICATIONS p,
        LATERAL FLATTEN(input => p."cpc") c
    WHERE
        c.value:"code"::STRING IS NOT NULL
        AND p."publication_date" IS NOT NULL
),
cpc_publications AS (
    SELECT
        cp."cpc_code",
        cp."year",
        cp."publication_number",
        l5."full_title"
    FROM
        publication_cpc cp
    INNER JOIN
        level5_cpc l5
    ON
        TRIM(SUBSTRING(cp."cpc_code", 1, 4)) = l5."cpc_symbol"
),
annual_counts AS (
    SELECT
        cp."cpc_code",
        cp."full_title",
        cp."year",
        COUNT(DISTINCT cp."publication_number") AS "num_publications"
    FROM
        cpc_publications cp
    GROUP BY
        cp."cpc_code",
        cp."full_title",
        cp."year"
),
ordered_counts AS (
    SELECT
        ac.*,
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_code" ORDER BY ac."year") AS "rn"
    FROM
        annual_counts ac
),
ema_calc AS (
    SELECT
        oc."cpc_code",
        oc."full_title",
        oc."year",
        oc."num_publications",
        CAST(oc."num_publications" AS FLOAT) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    WHERE
        oc."rn" = 1
    UNION ALL
    SELECT
        oc."cpc_code",
        oc."full_title",
        oc."year",
        oc."num_publications",
        ROUND(0.2 * oc."num_publications" + 0.8 * ec."ema", 4) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    INNER JOIN
        ema_calc ec
        ON
            oc."cpc_code" = ec."cpc_code" AND oc."rn" = ec."rn" + 1
),
latest_ema AS (
    SELECT
        ec."cpc_code",
        ec."full_title",
        ec."year",
        ec."ema",
        ROW_NUMBER() OVER (PARTITION BY ec."cpc_code" ORDER BY ec."year" DESC) AS "rn"
    FROM
        ema_calc ec
),
ema_per_cpc AS (
    SELECT
        le."cpc_code",
        le."full_title",
        le."ema"
    FROM
        latest_ema le
    WHERE
        le."rn" = 1
),
best_years AS (
    SELECT
        ac."cpc_code",
        ac."full_title",
        ac."year" AS "best_year",
        ac."num_publications",
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_code" ORDER BY ac."num_publications" DESC) AS "rn"
    FROM
        annual_counts ac
),
best_year_per_cpc AS (
    SELECT
        byc."cpc_code",
        byc."full_title",
        byc."best_year"
    FROM
        best_years byc
    WHERE
        byc."rn" = 1
)
SELECT
    epc."cpc_code" AS "CPC_Symbol",
    epc."full_title" AS "Full_Title",
    byp."best_year" AS "Best_Year"
FROM
    ema_per_cpc epc
JOIN
    best_year_per_cpc byp
ON
    epc."cpc_code" = byp."cpc_code"
ORDER BY
    epc."ema" DESC NULLS LAST
LIMIT 100;
2025-01-27 02:11:58 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 02:11:58 - root - INFO - ```sql
WITH level5_cpc AS (
    SELECT
        TRIM(UPPER("symbol")) AS "cpc_symbol",
        "titleFull" AS "full_title"
    FROM
        PATENTS.PATENTS.CPC_DEFINITION
    WHERE
        "level" = 5
),
publication_cpc AS (
    SELECT
        p."publication_number",
        TRIM(UPPER(c.value:"code"::STRING)) AS "cpc_code",
        EXTRACT(year FROM TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD')) AS "year"
    FROM
        PATENTS.PATENTS.PUBLICATIONS p,
        LATERAL FLATTEN(input => p."cpc") c
    WHERE
        c.value:"code"::STRING IS NOT NULL
        AND p."publication_date" IS NOT NULL
),
cpc_publications AS (
    SELECT
        pc."cpc_code",
        pc."year",
        pc."publication_number",
        l5."full_title"
    FROM
        publication_cpc pc
    INNER JOIN
        level5_cpc l5
    ON
        pc."cpc_code" = l5."cpc_symbol"
),
annual_counts AS (
    SELECT
        cp."cpc_code",
        cp."full_title",
        cp."year",
        COUNT(DISTINCT cp."publication_number") AS "num_publications"
    FROM
        cpc_publications cp
    GROUP BY
        cp."cpc_code",
        cp."full_title",
        cp."year"
),
ordered_counts AS (
    SELECT
        ac.*,
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_code" ORDER BY ac."year") AS "rn"
    FROM
        annual_counts ac
),
ema_calc AS (
    SELECT
        oc."cpc_code",
        oc."full_title",
        oc."year",
        oc."num_publications",
        CAST(oc."num_publications" AS FLOAT) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    WHERE
        oc."rn" = 1
    UNION ALL
    SELECT
        oc."cpc_code",
        oc."full_title",
        oc."year",
        oc."num_publications",
        ROUND(0.2 * oc."num_publications" + 0.8 * ec."ema", 4) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    INNER JOIN
        ema_calc ec
        ON
            oc."cpc_code" = ec."cpc_code" AND oc."rn" = ec."rn" + 1
),
latest_ema AS (
    SELECT
        ec."cpc_code",
        ec."full_title",
        ec."year",
        ec."ema",
        ROW_NUMBER() OVER (PARTITION BY ec."cpc_code" ORDER BY ec."year" DESC) AS "rn"
    FROM
        ema_calc ec
),
ema_per_cpc AS (
    SELECT
        le."cpc_code",
        le."full_title",
        le."ema"
    FROM
        latest_ema le
    WHERE
        le."rn" = 1
),
best_years AS (
    SELECT
        ac."cpc_code",
        ac."full_title",
        ac."year" AS "best_year",
        ac."num_publications",
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_code" ORDER BY ac."num_publications" DESC) AS "rn"
    FROM
        annual_counts ac
),
best_year_per_cpc AS (
    SELECT
        byc."cpc_code",
        byc."full_title",
        byc."best_year"
    FROM
        best_years byc
    WHERE
        byc."rn" = 1
)
SELECT
    epc."cpc_code" AS "CPC_Symbol",
    epc."full_title" AS "Full_Title",
    byp."best_year" AS "Best_Year"
FROM
    ema_per_cpc epc
JOIN
    best_year_per_cpc byp
ON
    epc."cpc_code" = byp."cpc_code"
ORDER BY
    epc."ema" DESC NULLS LAST
LIMIT 100;
```
2025-01-27 02:11:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 02:11:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 02:11:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 02:12:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-27 02:12:00 - snowflake.connector.connection - INFO - closed
2025-01-27 02:12:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 02:12:01 - root - INFO - itercount: 8
2025-01-27 02:12:01 - root - INFO - No data found for the specified query.

2025-01-27 02:12:01 - root - INFO - Input sql:
WITH level5_cpc AS (
    SELECT
        TRIM(UPPER("symbol")) AS "cpc_symbol",
        "titleFull" AS "full_title"
    FROM
        PATENTS.PATENTS.CPC_DEFINITION
    WHERE
        "level" = 5
),
publication_cpc AS (
    SELECT
        p."publication_number",
        TRIM(UPPER(c.value:"code"::STRING)) AS "cpc_code",
        EXTRACT(year FROM TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD')) AS "year"
    FROM
        PATENTS.PATENTS.PUBLICATIONS p,
        LATERAL FLATTEN(input => p."cpc") c
    WHERE
        c.value:"code"::STRING IS NOT NULL
        AND p."publication_date" IS NOT NULL
),
cpc_publications AS (
    SELECT
        pc."cpc_code",
        pc."year",
        pc."publication_number",
        l5."full_title"
    FROM
        publication_cpc pc
    INNER JOIN
        level5_cpc l5
    ON
        pc."cpc_code" = l5."cpc_symbol"
),
annual_counts AS (
    SELECT
        cp."cpc_code",
        cp."full_title",
        cp."year",
        COUNT(DISTINCT cp."publication_number") AS "num_publications"
    FROM
        cpc_publications cp
    GROUP BY
        cp."cpc_code",
        cp."full_title",
        cp."year"
),
ordered_counts AS (
    SELECT
        ac.*,
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_code" ORDER BY ac."year") AS "rn"
    FROM
        annual_counts ac
),
ema_calc AS (
    SELECT
        oc."cpc_code",
        oc."full_title",
        oc."year",
        oc."num_publications",
        CAST(oc."num_publications" AS FLOAT) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    WHERE
        oc."rn" = 1
    UNION ALL
    SELECT
        oc."cpc_code",
        oc."full_title",
        oc."year",
        oc."num_publications",
        ROUND(0.2 * oc."num_publications" + 0.8 * ec."ema", 4) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    INNER JOIN
        ema_calc ec
        ON
            oc."cpc_code" = ec."cpc_code" AND oc."rn" = ec."rn" + 1
),
latest_ema AS (
    SELECT
        ec."cpc_code",
        ec."full_title",
        ec."year",
        ec."ema",
        ROW_NUMBER() OVER (PARTITION BY ec."cpc_code" ORDER BY ec."year" DESC) AS "rn"
    FROM
        ema_calc ec
),
ema_per_cpc AS (
    SELECT
        le."cpc_code",
        le."full_title",
        le."ema"
    FROM
        latest_ema le
    WHERE
        le."rn" = 1
),
best_years AS (
    SELECT
        ac."cpc_code",
        ac."full_title",
        ac."year" AS "best_year",
        ac."num_publications",
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_code" ORDER BY ac."num_publications" DESC) AS "rn"
    FROM
        annual_counts ac
),
best_year_per_cpc AS (
    SELECT
        byc."cpc_code",
        byc."full_title",
        byc."best_year"
    FROM
        best_years byc
    WHERE
        byc."rn" = 1
)
SELECT
    epc."cpc_code" AS "CPC_Symbol",
    epc."full_title" AS "Full_Title",
    byp."best_year" AS "Best_Year"
FROM
    ema_per_cpc epc
JOIN
    best_year_per_cpc byp
ON
    epc."cpc_code" = byp."cpc_code"
ORDER BY
    epc."ema" DESC NULLS LAST
LIMIT 100;
The error information is:
 No data found for the specified query.

2025-01-27 02:12:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 02:12:56 - root - INFO - ```sql
WITH level5_cpc AS (
    SELECT
        TRIM("symbol") AS "cpc_symbol",
        "titleFull" AS "full_title",
        LENGTH(TRIM("symbol")) AS "symbol_length"
    FROM
        PATENTS.PATENTS.CPC_DEFINITION
    WHERE
        "level" = 5
),
publication_cpc AS (
    SELECT
        p."publication_number",
        TRIM(c.value:"code"::STRING) AS "cpc_code",
        EXTRACT(year FROM TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD')) AS "year"
    FROM
        PATENTS.PATENTS.PUBLICATIONS p,
        LATERAL FLATTEN(input => p."cpc") c
    WHERE
        c.value:"code"::STRING IS NOT NULL
        AND p."publication_date" IS NOT NULL
),
cpc_publications AS (
    SELECT
        l5."cpc_symbol",
        pc."year",
        pc."publication_number",
        l5."full_title"
    FROM
        publication_cpc pc
    INNER JOIN
        level5_cpc l5
    ON
        LEFT(pc."cpc_code", LENGTH(l5."cpc_symbol")) = l5."cpc_symbol"
    WHERE
        pc."year" IS NOT NULL
),
annual_counts AS (
    SELECT
        cp."cpc_symbol",
        cp."full_title",
        cp."year",
        COUNT(DISTINCT cp."publication_number") AS "num_publications"
    FROM
        cpc_publications cp
    GROUP BY
        cp."cpc_symbol",
        cp."full_title",
        cp."year"
),
ordered_counts AS (
    SELECT
        ac.*,
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."year") AS "rn"
    FROM
        annual_counts ac
),
ema_calc AS (
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        CAST(oc."num_publications" AS FLOAT) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    WHERE
        oc."rn" = 1
    UNION ALL
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        ROUND(0.2 * oc."num_publications" + 0.8 * ec."ema", 4) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    INNER JOIN
        ema_calc ec
    ON
        oc."cpc_symbol" = ec."cpc_symbol" AND oc."rn" = ec."rn" + 1
),
latest_ema AS (
    SELECT
        ec."cpc_symbol",
        ec."full_title",
        ec."year",
        ec."ema",
        ROW_NUMBER() OVER (PARTITION BY ec."cpc_symbol" ORDER BY ec."year" DESC) AS "rn"
    FROM
        ema_calc ec
),
ema_per_cpc AS (
    SELECT
        le."cpc_symbol",
        le."full_title",
        le."ema"
    FROM
        latest_ema le
    WHERE
        le."rn" = 1
),
best_years AS (
    SELECT
        ac."cpc_symbol",
        ac."full_title",
        ac."year" AS "best_year",
        ac."num_publications",
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."num_publications" DESC) AS "rn"
    FROM
        annual_counts ac
),
best_year_per_cpc AS (
    SELECT
        byc."cpc_symbol",
        byc."full_title",
        byc."best_year"
    FROM
        best_years byc
    WHERE
        byc."rn" = 1
)
SELECT
    epc."cpc_symbol" AS "CPC_Symbol",
    epc."full_title" AS "Full_Title",
    byp."best_year" AS "Best_Year"
FROM
    ema_per_cpc epc
JOIN
    best_year_per_cpc byp
ON
    epc."cpc_symbol" = byp."cpc_symbol"
ORDER BY
    epc."ema" DESC NULLS LAST
LIMIT 100;
```
2025-01-27 02:12:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 02:12:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 02:12:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 02:12:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 02:12:59 - snowflake.connector.connection - INFO - closed
2025-01-27 02:13:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 02:13:00 - root - INFO - itercount: 9
2025-01-27 02:13:00 - root - INFO - 0
2025-01-27 02:13:00 - root - INFO - results: 
CPC_Symbol,Full_Title,Best_Year
G06F,ELECTRIC DIGITAL DATA PROCESSING,2021
Y02E,"REDUCTION OF GREENHOUSE GAS [GHG] EMISSIONS, RELATED TO ENERGY GENERATION, TRANSMISSION OR DISTRIBUTION",2023
Y02P,CLIMATE CHANGE MITIGATION TECHNOLOGIES IN THE PRODUCTION OR PROCESSING OF GOODS,2023
A61K,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",2021
H04L,"TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION",2021
H01L,SEMICONDUCTOR DEVICES NOT COVERED BY CLASS H10,2021
A61P,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2021
H04W,WIRELESS COMMUNICATION NETWORKS,2021
Y02A,TECHNOLOGIES FOR ADAPTATION TO CLIMATE CHANGE,2023
G06Q,"INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES; SYSTEMS OR METHODS SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES, NOT OTHERWISE PROVIDED FOR",2022
G01N,INVESTIGATING OR ANALYSING MATERIALS BY DETERMINING THEIR CHEMICAL OR PHYSICAL PROPERTIES,2021
H04N,"PICTORIAL COMMUNICATION, e.g. TELEVISION",2021
A61B,DIAGNOSIS; SURGERY; IDENTIFICATION,2021
G06T,"IMAGE DATA PROCESSING OR GENERATION, IN GENERAL",2021
Y02T,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,2023
G06N,COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS,2022
C12N,"MICROORGANISMS OR ENZYMES; COMPOSITIONS THEREOF; PROPAGATING, PRESERVING, OR MAINTAINING MICROORGANISMS; MUTATION OR GENETIC ENGINEERING; CULTURE MEDIA",2021
H01M,"PROCESSES OR MEANS, e.g. BATTERIES, FOR THE DIRECT CONVERSION OF CHEMICAL ENERGY INTO ELECTRICAL ENERGY",2022
G02B,"OPTICAL ELEMENTS, SYSTEMS OR APPARATUS",2021
G06V,IMAGE OR VIDEO RECOGNITION OR UNDERSTANDING,2021
Y02W,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO WASTEWATER TREATMENT OR WASTE MANAGEMENT,2023
C07K,PEPTIDES,2021
Y02B,"CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO BUILDINGS, e.g. HOUSING, HOUSE APPLIANCES OR RELATED END-USER APPLICATIONS",2023
C07D,HETEROCYCLIC COMPOUNDS,2018
B01D,SEPARATION,2018
C08L,COMPOSITIONS OF MACROMOLECULAR COMPOUNDS,2018
H04B,TRANSMISSION,2021
Y02D,"CLIMATE CHANGE MITIGATION TECHNOLOGIES IN INFORMATION AND COMMUNICATION TECHNOLOGIES [ICT], I.E. INFORMATION AND COMMUNICATION TECHNOLOGIES AIMING AT THE REDUCTION OF THEIR OWN ENERGY USE",2023
B29C,"SHAPING OR JOINING OF PLASTICS; SHAPING OF MATERIAL IN A PLASTIC STATE, NOT OTHERWISE PROVIDED FOR; AFTER-TREATMENT OF THE SHAPED PRODUCTS, e.g. REPAIRING",2018
H02J,CIRCUIT ARRANGEMENTS OR SYSTEMS FOR SUPPLYING OR DISTRIBUTING ELECTRIC POWER; SYSTEMS FOR STORING ELECTRIC ENERGY,2022
A61M,"DEVICES FOR INTRODUCING MEDIA INTO, OR ONTO, THE BODY; DEVICES FOR TRANSDUCING BODY MEDIA OR FOR TAKING MEDIA FROM THE BODY; DEVICES FOR PRODUCING OR ENDING SLEEP OR STUPOR",2021
C08K,Use of inorganic or non-macromolecular organic substances as compounding ingredients,2018
H05K,PRINTED CIRCUITS; CASINGS OR CONSTRUCTIONAL DETAILS OF ELECTRIC APPARATUS; MANUFACTURE OF ASSEMBLAGES OF ELECTRICAL COMPONENTS,2022
G01R,MEASURING ELECTRIC VARIABLES; MEASURING MAGNETIC VARIABLES,2022
G01S,RADIO DIRECTION-FINDING; RADIO NAVIGATION; DETERMINING DISTANCE OR VELOCITY BY USE OF RADIO WAVES; LOCATING OR PRESENCE-DETECTING BY USE OF THE REFLECTION OR RERADIATION OF RADIO WAVES; ANALOGOUS ARRANGEMENTS USING OTHER WAVES,2021
B01J,"CHEMICAL OR PHYSICAL PROCESSES, e.g. CATALYSIS OR COLLOID CHEMISTRY; THEIR RELEVANT APPARATUS",2018
G05B,CONTROL OR REGULATING SYSTEMS IN GENERAL; FUNCTIONAL ELEMENTS OF SUCH SYSTEMS; MONITORING OR TESTING ARRANGEMENTS FOR SUCH SYSTEMS OR ELEMENTS,2021
B32B,"LAYERED PRODUCTS, i.e. PRODUCTS BUILT-UP OF STRATA OF FLAT OR NON-FLAT, e.g. CELLULAR OR HONEYCOMB, FORM",2018
A61F,"FILTERS IMPLANTABLE INTO BLOOD VESSELS; PROSTHESES; DEVICES PROVIDING PATENCY TO, OR PREVENTING COLLAPSING OF, TUBULAR STRUCTURES OF THE BODY, e.g. STENTS; ORTHOPAEDIC, NURSING OR CONTRACEPTIVE DEVICES; FOMENTATION; TREATMENT OR PROTECTION OF EYES OR EARS; BANDAGES, DRESSINGS OR ABSORBENT PADS; FIRST-AID KITS",2020
C08G,MACROMOLECULAR COMPOUNDS OBTAINED OTHERWISE THAN BY REACTIONS ONLY INVOLVING UNSATURATED CARBON-TO-CARBON BONDS,2018
C07C,ACYCLIC OR CARBOCYCLIC COMPOUNDS,2018
C09D,"COATING COMPOSITIONS, e.g. PAINTS, VARNISHES OR LACQUERS; FILLING PASTES; CHEMICAL PAINT OR INK REMOVERS; INKS; CORRECTING FLUIDS; WOODSTAINS; PASTES OR SOLIDS FOR COLOURING OR PRINTING; USE OF MATERIALS THEREFOR",2017
H10K,ORGANIC ELECTRIC SOLID-STATE DEVICES,2021
B60R,"VEHICLES, VEHICLE FITTINGS, OR VEHICLE PARTS, NOT OTHERWISE PROVIDED FOR",2021
Y10T,TECHNICAL SUBJECTS COVERED BY FORMER US CLASSIFICATION,2014
A23L,"FOODS, FOODSTUFFS, OR NON-ALCOHOLIC BEVERAGES, NOT COVERED BY SUBCLASSES A21D OR A23B-A23J; THEIR PREPARATION OR TREATMENT, e.g. COOKING, MODIFICATION OF NUTRITIVE QUALITIES, PHYSICAL TREATMENT; PRESERVATION OF FOODS OR FOODSTUFFS, IN GENERAL",2018
C02F,"TREATMENT OF WATER, WASTE WATER, SEWAGE, OR SLUDGE",2018
B65D,"CONTAINERS FOR STORAGE OR TRANSPORT OF ARTICLES OR MATERIALS, e.g. BAGS, BARRELS, BOTTLES, BOXES, CANS, CARTONS, CRATES, DRUMS, JARS, TANKS, HOPPERS, FORWARDING CONTAINERS; ACCESSORIES, CLOSURES, OR FITTINGS THEREFOR; PACKAGING ELEMENTS; PACKAGES",2018
G06K,GRAPHICAL DATA READING; PRESENTATION OF DATA; RECORD CARRIERS; HANDLING RECORD CARRIERS,2021
C08J,"WORKING-UP; GENERAL PROCESSES OF COMPOUNDING; AFTER-TREATMENT NOT COVERED BY SUBCLASSES C08B, C08C, C08F, C08G or C08H",2018
G16H,"HEALTHCARE INFORMATICS, i.e. INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR THE HANDLING OR PROCESSING OF MEDICAL OR HEALTHCARE DATA",2021
G02F,OPTICAL DEVICES OR ARRANGEMENTS FOR THE CONTROL OF LIGHT BY MODIFICATION OF THE OPTICAL PROPERTIES OF THE MEDIA OF THE ELEMENTS INVOLVED THEREIN; NON-LINEAR OPTICS; FREQUENCY-CHANGING OF LIGHT; OPTICAL LOGIC ELEMENTS; OPTICAL ANALOGUE/DIGITAL CONVERTERS,2021
C12Q,"MEASURING OR TESTING PROCESSES INVOLVING ENZYMES, NUCLEIC ACIDS OR MICROORGANISMS; COMPOSITIONS OR TEST PAPERS THEREFOR; PROCESSES OF PREPARING SUCH COMPOSITIONS; CONDITION-RESPONSIVE CONTROL IN MICROBIOLOGICAL OR ENZYMOLOGICAL PROCESSES",2021
C09K,"MATERIALS FOR MISCELLANEOUS APPLICATIONS, NOT PROVIDED FOR ELSEWHERE",2018
C23C,"COATING METALLIC MATERIAL; COATING MATERIAL WITH METALLIC MATERIAL; SURFACE TREATMENT OF METALLIC MATERIAL BY DIFFUSION INTO THE SURFACE, BY CHEMICAL CONVERSION OR SUBSTITUTION; COATING BY VACUUM EVAPORATION, BY SPUTTERING, BY ION IMPLANTATION OR BY CHEMICAL VAPOUR DEPOSITION, IN GENERAL",2018
G09G,ARRANGEMENTS OR CIRCUITS FOR CONTROL OF INDICATING DEVICES USING STATIC MEANS TO PRESENT VARIABLE INFORMATION,2021
B23K,"SOLDERING OR UNSOLDERING; WELDING; CLADDING OR PLATING BY SOLDERING OR WELDING; CUTTING BY APPLYING HEAT LOCALLY, e.g. FLAME CUTTING; WORKING BY LASER BEAM",2018
B60W,CONJOINT CONTROL OF VEHICLE SUB-UNITS OF DIFFERENT TYPE OR DIFFERENT FUNCTION; CONTROL SYSTEMS SPECIALLY ADAPTED FOR HYBRID VEHICLES; ROAD VEHICLE DRIVE CONTROL SYSTEMS FOR PURPOSES NOT RELATED TO THE CONTROL OF A PARTICULAR SUB-UNIT,2022
B65G,"TRANSPORT OR STORAGE DEVICES, e.g. CONVEYORS FOR LOADING OR TIPPING, SHOP CONVEYOR SYSTEMS OR PNEUMATIC TUBE CONVEYORS",2022
E21B,"EARTH OR ROCK DRILLING; OBTAINING OIL, GAS, WATER, SOLUBLE OR MELTABLE MATERIALS OR A SLURRY OF MINERALS FROM WELLS",2021
H02K,DYNAMO-ELECTRIC MACHINES,2020
H05B,"ELECTRIC HEATING; ELECTRIC LIGHT SOURCES NOT OTHERWISE PROVIDED FOR; CIRCUIT ARRANGEMENTS FOR ELECTRIC LIGHT SOURCES, IN GENERAL",2018
A61L,"METHODS OR APPARATUS FOR STERILISING MATERIALS OR OBJECTS IN GENERAL; DISINFECTION, STERILISATION OR DEODORISATION OF AIR; CHEMICAL ASPECTS OF BANDAGES, DRESSINGS, ABSORBENT PADS OR SURGICAL ARTICLES; MATERIALS FOR BANDAGES, DRESSINGS, ABSORBENT PADS OR SURGICAL ARTICLES",2022
B60L,PROPULSION OF ELECTRICALLY-PROPELLED VEHICLES; SUPPLYING ELECTRIC POWER FOR AUXILIARY EQUIPMENT OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRODYNAMIC BRAKE SYSTEMS FOR VEHICLES IN GENERAL; MAGNETIC SUSPENSION OR LEVITATION FOR VEHICLES; MONITORING OPERATING VARIABLES OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRIC SAFETY DEVICES FOR ELECTRICALLY-PROPELLED VEHICLES,2021
G05D,SYSTEMS FOR CONTROLLING OR REGULATING NON-ELECTRIC VARIABLES,2020
H04M,TELEPHONIC COMMUNICATION,2021
B60K,"ARRANGEMENT OR MOUNTING OF PROPULSION UNITS OR OF TRANSMISSIONS IN VEHICLES; ARRANGEMENT OR MOUNTING OF PLURAL DIVERSE PRIME-MOVERS IN VEHICLES; AUXILIARY DRIVES FOR VEHICLES; INSTRUMENTATION OR DASHBOARDS FOR VEHICLES; ARRANGEMENTS IN CONNECTION WITH COOLING, AIR INTAKE, GAS EXHAUST OR FUEL SUPPLY OF PROPULSION UNITS IN VEHICLES",2018
C08F,MACROMOLECULAR COMPOUNDS OBTAINED BY REACTIONS ONLY INVOLVING CARBON-TO-CARBON UNSATURATED BONDS,2018
H01R,ELECTRICALLY-CONDUCTIVE CONNECTIONS; STRUCTURAL ASSOCIATIONS OF A PLURALITY OF MUTUALLY-INSULATED ELECTRICAL CONNECTING ELEMENTS; COUPLING DEVICES; CURRENT COLLECTORS,2018
B62D,MOTOR VEHICLES; TRAILERS,2021
C04B,"LIME, MAGNESIA; SLAG; CEMENTS; COMPOSITIONS THEREOF, e.g. MORTARS, CONCRETE OR LIKE BUILDING MATERIALS; ARTIFICIAL STONE; CERAMICS; REFRACTORIES; TREATMENT OF NATURAL STONE",2018
G01C,"MEASURING DISTANCES, LEVELS OR BEARINGS; SURVEYING; NAVIGATION; GYROSCOPIC INSTRUMENTS; PHOTOGRAMMETRY OR VIDEOGRAMMETRY",2021
C01B,NON-METALLIC ELEMENTS; COMPOUNDS THEREOF; METALLOIDS OR COMPOUNDS THEREOF NOT COVERED BY SUBCLASS C01C,2022
A23V,"INDEXING SCHEME RELATING TO FOODS, FOODSTUFFS OR NON-ALCOHOLIC BEVERAGES AND LACTIC OR PROPIONIC ACID BACTERIA USED IN FOODSTUFFS OR FOOD PREPARATION",2017
A61Q,SPECIFIC USE OF COSMETICS OR SIMILAR TOILETRY PREPARATIONS,2018
H02M,"APPARATUS FOR CONVERSION BETWEEN AC AND AC, BETWEEN AC AND DC, OR BETWEEN DC AND DC, AND FOR USE WITH MAINS OR SIMILAR POWER SUPPLY SYSTEMS; CONVERSION OF DC OR AC INPUT POWER INTO SURGE OUTPUT POWER; CONTROL OR REGULATION THEREOF",2021
B25J,MANIPULATORS; CHAMBERS PROVIDED WITH MANIPULATION DEVICES,2021
C22C,ALLOYS,2017
G01B,"MEASURING LENGTH, THICKNESS OR SIMILAR LINEAR DIMENSIONS; MEASURING ANGLES; MEASURING AREAS; MEASURING IRREGULARITIES OF SURFACES OR CONTOURS",2022
F24F,AIR-CONDITIONING; AIR-HUMIDIFICATION; VENTILATION; USE OF AIR CURRENTS FOR SCREENING,2022
G10L,SPEECH ANALYSIS TECHNIQUES OR SPEECH SYNTHESIS; SPEECH RECOGNITION; SPEECH OR VOICE PROCESSING TECHNIQUES; SPEECH OR AUDIO CODING OR DECODING,2022
G08G,TRAFFIC CONTROL SYSTEMS,2021
B08B,CLEANING IN GENERAL; PREVENTION OF FOULING IN GENERAL,2022
G08B,SIGNALLING OR CALLING SYSTEMS; ORDER TELEGRAPHS; ALARM SYSTEMS,2022
A01N,"PRESERVATION OF BODIES OF HUMANS OR ANIMALS OR PLANTS OR PARTS THEREOF; BIOCIDES, e.g. AS DISINFECTANTS, AS PESTICIDES OR AS HERBICIDES; PEST REPELLANTS OR ATTRACTANTS; PLANT GROWTH REGULATORS",2018
F16H,GEARING,2017
G11C,STATIC STORES,2021
A01G,"HORTICULTURE; CULTIVATION OF VEGETABLES, FLOWERS, RICE, FRUIT, VINES, HOPS OR SEAWEED; FORESTRY; WATERING",2017
G01M,"TESTING STATIC OR DYNAMIC BALANCE OF MACHINES OR STRUCTURES; TESTING OF STRUCTURES OR APPARATUS, NOT OTHERWISE PROVIDED FOR",2018
H01F,MAGNETS; INDUCTANCES; TRANSFORMERS; SELECTION OF MATERIALS FOR THEIR MAGNETIC PROPERTIES,2018
F21V,"FUNCTIONAL FEATURES OR DETAILS OF LIGHTING DEVICES OR SYSTEMS THEREOF; STRUCTURAL COMBINATIONS OF LIGHTING DEVICES WITH OTHER ARTICLES, NOT OTHERWISE PROVIDED FOR",2018
H04R,"LOUDSPEAKERS, MICROPHONES, GRAMOPHONE PICK-UPS OR LIKE ACOUSTIC ELECTROMECHANICAL TRANSDUCERS; DEAF-AID SETS; PUBLIC ADDRESS SYSTEMS",2022
A61N,ELECTROTHERAPY; MAGNETOTHERAPY; RADIATION THERAPY; ULTRASOUND THERAPY,2021
A01K,"ANIMAL HUSBANDRY; AVICULTURE; APICULTURE; PISCICULTURE; FISHING; REARING OR BREEDING ANIMALS, NOT OTHERWISE PROVIDED FOR; NEW BREEDS OF ANIMALS",2018
B29L,"INDEXING SCHEME ASSOCIATED WITH SUBCLASS B29C, RELATING TO PARTICULAR ARTICLES",2018
F16L,"PIPES; JOINTS OR FITTINGS FOR PIPES; SUPPORTS FOR PIPES, CABLES OR PROTECTIVE TUBING; MEANS FOR THERMAL INSULATION IN GENERAL",2018
H01Q,"ANTENNAS, i.e. RADIO AERIALS",2021
C09J,ADHESIVES; NON-MECHANICAL ASPECTS OF ADHESIVE PROCESSES IN GENERAL; ADHESIVE PROCESSES NOT PROVIDED FOR ELSEWHERE; USE OF MATERIALS AS ADHESIVES,2021
H01J,ELECTRIC DISCHARGE TUBES OR DISCHARGE LAMPS,2021
B33Y,"ADDITIVE MANUFACTURING, i.e. MANUFACTURING OF THREE-DIMENSIONAL [3-D] OBJECTS BY ADDITIVE DEPOSITION, ADDITIVE AGGLOMERATION OR ADDITIVE LAYERING, e.g. BY 3-D PRINTING, STEREOLITHOGRAPHY OR SELECTIVE LASER SINTERING",2022


2025-01-27 02:13:00 - root - INFO - Please check the answer again by reviewing Identify the CPC technology areas with the highest exponential moving average of patent filings each year (smoothing factor 0.2), and provide the full title and the best year for each CPC group at level 5., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
CPC_Symbol,Full_Title,Best_Year
symbol1:str,titleFull1:str,year1:int
symbol2:str,titleFull2:str,year2:int
...
```

The table above lists the CPC technology areas at level 5 with the highest exponential moving average (EMA) of patent filings each year, using a smoothing factor of 0.2. For each CPC group, we've provided the symbol, the full title, and the best year—that is, the year with the highest number of patent filings in that group. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Too long, hard cut:
CPC_Symbol,Full_Title,Best_Year
G06F,ELECTRIC DIGITAL DATA PROCESSING,2021
Y02E,"REDUCTION OF GREENHOUSE GAS [GHG] EMISSIONS, RELATED TO ENERGY GENERATION, TRANSMISSION OR DISTRIBUTION",2023
Y02P,CLIMATE CHANGE MITIGATION TECHNOLOGIES IN THE PRODUCTION OR PROCESSING OF GOODS,2023
A61K,"PREPARATIONS FOR MEDICAL, DENTAL OR TOILETRY PURPOSES",2021
H04L,"TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION",2021
H01L,SEMICONDUCTOR DEVICES NOT COVERED BY CLASS H10,2021
A61P,SPECIFIC THERAPEUTIC ACTIVITY OF CHEMICAL COMPOUNDS OR MEDICINAL PREPARATIONS,2021
H04W,WIRELESS COMMUNICATION NETWORKS,2021
Y02A,TECHNOLOGIES FOR ADAPTATION TO CLIMATE CHANGE,2023
G06Q,"INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES; SYSTEMS OR METHODS SPECIALLY ADAPTED FOR ADMINISTRATIVE, COMMERCIAL, FINANCIAL, MANAGERIAL OR SUPERVISORY PURPOSES, NOT OTHERWISE PROVIDED FOR",2022
G01N,INVESTIGATING OR ANALYSING MATERIALS BY DETERMINING THEIR CHEMICAL OR PHYSICAL PROPERTIES,2021
H04N,"PICTORIAL COMMUNICATION, e.g. TELEVISION",2021
A61B,DIAGNOSIS; SURGERY; IDENTIFICATION,2021
G06T,"IMAGE DATA PROCESSING OR GENERATION, IN GENERAL",2021
Y02T,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,2023
G06N,COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS,2022
C12N,"MICROORGANISMS OR ENZYMES; COMPOSITIONS THEREOF; PROPAGATING, PRESERVING, OR MAINTAINING MICROORGANISMS; MUTATION OR GENETIC ENGINEERING; CULTURE MEDIA",2021
H01M,"PROCESSES OR MEANS, e.g. BATTERIES, FOR THE DIRECT CONVERSION OF CHEMICAL ENERGY INTO ELECTRICAL ENERGY",2022
G02B,"OPTICAL ELEMENTS, SYSTEMS OR APPARATUS",2021
G06V,IMAGE OR VIDEO RECOGNITION OR UNDERSTANDING,2021
Y02W,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO WASTEWATER TREATMENT OR WASTE MANAGEMENT,2023
C07K,PEPTIDES,2021
Y02B,"CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO BUILDINGS, e.g. HOUSING, HOUSE APPLIANCES OR RELATED END-USER APPLICATIONS",2023
C07D,HETEROCYCLIC COMPOUNDS,2018
B01D,SEPARATION,2018
C08L,COMPOSITIONS OF MACROMOLECULAR COMPOUNDS,2018
H04B,TRANSMISSION,2021
Y02D,"CLIMATE CHANGE MITIGATION TECHNOLOGIES IN INFORMATION AND COMMUNICATION TECHNOLOGIES [ICT], I.E. INFORMATION AND COMMUNICATION TECHNOLOGIES AIMING AT THE REDUCTION OF THEIR OWN ENERGY USE",2023
B29C,"SHAPING OR JOINING OF PLASTICS; SHAPING OF MATERIAL IN A PLASTIC STATE, NOT OTHERWISE PROVIDED FOR; AFTER-TREATMENT OF THE SHAPED PRODUCTS, e.g. REPAIRING",2018
H02J,CIRCUIT ARRANGEMENTS OR SYSTEMS FOR SUPPLYING OR DISTRIBUTING ELECTRIC POWER; SYSTEMS FOR STORING ELECTRIC ENERGY,2022
A61M,"DEVICES FOR INTRODUCING MEDIA INTO, OR ONTO, THE BODY; DEVICES FOR TRANSDUCING BODY MEDIA OR FOR TAKING MEDIA FROM THE BODY; DEVICES FOR PRODUCING OR ENDING SLEEP OR STUPOR",2021
C08K,Use of inorganic or non-macromolecular organic substances as compounding ingredients,2018
H05K,PRINTED CIRCUITS; CASINGS OR CONSTRUCTIONAL DETAILS OF ELECTRIC APPARATUS; MANUFACTURE OF ASSEMBLAGES OF ELECTRICAL COMPONENTS,2022
G01R,MEASURING ELECTRIC VARIABLES; MEASURING MAGNETIC VARIABLES,2022
G01S,RADIO DIRECTION-FINDING; RADIO NAVIGATION; DETERMINING DISTANCE OR VELOCITY BY USE OF RADIO WAVES; LOCATING OR PRESENCE-DETECTING BY USE OF THE REFLECTION OR RERADIATION OF RADIO WAVES; ANALOGOUS ARRANGEMENTS USING OTHER WAVES,2021
B01J,"CHEMICAL OR PHYSICAL PROCESSES, e.g. CATALYSIS OR COLLOID CHEMISTRY; THEIR RELEVANT APPARATUS",2018
G05B,CONTROL OR REGULATING SYSTEMS IN GENERAL; FUNCTIONAL ELEMENTS OF SUCH SYSTEMS; MONITORING OR TESTING ARRANGEMENTS FOR SUCH SYSTEMS OR ELEMENTS,2021
B32B,"LAYERED PRODUCTS, i.e. PRODUCTS BUILT-UP OF STRATA OF FLAT OR NON-FLAT, e.g. CELLULAR OR HONEYCOMB, FORM",2018
A61F,"FILTERS IMPLANTABLE INTO BLOOD VESSELS; PROSTHESES; DEVICES PROVIDING PATENCY TO, OR PREVENTING COLLAPSING OF, TUBULAR STRUCTURES OF THE BODY, e.g. STENTS; ORTHOPAEDIC, NURSING OR CONTRACEPTIVE DEVICES; FOMENTATION; TREATMENT OR PROTECTION OF EYES OR EARS; BANDAGES, DRESSINGS OR ABSORBENT PADS; FIRST-AID KITS",2020
C08G,MACROMOLECULAR COMPOUNDS OBTAINED OTHERWISE THAN BY REACTIONS ONLY INVOLVING UNSATURATED CARBON-TO-CARBON BONDS,2018
C07C,ACYCLIC OR CARBOCYCLIC COMPOUNDS,2018
C09D,"COATING COMPOSITIONS, e.g. PAINTS, VARNISHES OR LACQUERS; FILLING PASTES; CHEMICAL PAINT OR INK REMOVERS; INKS; CORRECTING FLUIDS; WOODSTAINS; PASTES OR SOLIDS FOR COLOURING OR PRINTING; USE OF MATERIALS THEREFOR",2017
H10K,ORGANIC ELECTRIC SOLID-STATE DEVICES,2021
B60R,"VEHICLES, VEHICLE FITTINGS, OR VEHICLE PARTS, NOT OTHERWISE PROVIDED FOR",2021
Y10T,TECHNICAL SUBJECTS COVERED BY FORMER US CLASSIFICATION,2014
A23L,"FOODS, FOODSTUFFS, OR NON-ALCOHOLIC BEVERAGES, NOT COVERED BY SUBCLASSES A21D OR A23B-A23J; THEIR PREPARATION OR TREATMENT, e.g. COOKING, MODIFICATION OF NUTRITIVE QUALITIES, PHYSICAL TREATMENT; PRESERVATION OF FOODS OR FOODSTUFFS, IN GENERAL",2018
C02F,"TREATMENT OF WATER, WASTE WATER, SEWAGE, OR SLUDGE",2018
B65D,"CONTAINERS FOR STORAGE OR TRANSPORT OF ARTICLES OR MATERIALS, e.g. BAGS, BARRELS, BOTTLES, BOXES, CANS, CARTONS, CRATES, DRUMS, JARS, TANKS, HOPPERS, FORWARDING CONTAINERS; ACCESSORIES, CLOSURES, OR FITTINGS THEREFOR; PACKAGING ELEMENTS; PACKAGES",2018
G06K,GRAPHICAL DATA READING; PRESENTATION OF DATA; RECORD CARRIERS; HANDLING RECORD CARRIERS,2021
C08J,"WORKING-UP; GENERAL PROCESSES OF COMPOUNDING; AFTER-TREATMENT NOT COVERED BY SUBCLASSES C08B, C08C, C08F, C08G or C08H",2018
G16H,"HEALTHCARE INFORMATICS, i.e. INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR THE HANDLING OR PROCESSING OF MEDICAL OR HEALTHCARE DATA",2021
G02F,OPTICAL DEVICES OR ARRANGEMENTS FOR THE CONTROL OF LIGHT BY MODIFICATION OF THE OPTICAL PROPERTIES OF THE MEDIA OF THE ELEMENTS INVOLVED THEREIN; NON-LINEAR OPTICS; FREQUENCY-CHANGING OF LIGHT; OPTICAL LOGIC ELEMENTS; OPTICAL ANALOGUE/DIGITAL CONVERTERS,2021
C12Q,"MEASURING OR TESTING PROCESSES INVOLVING ENZYMES, NUCLEIC ACIDS OR MICROORGANISMS; COMPOSITIONS OR TEST PAPERS THEREFOR; PROCESSES OF PREPARING SUCH COMPOSITIONS; CONDITION-RESPONSIVE CONTROL IN MICROBIOLOGICAL OR ENZYMOLOGICAL PROCESSES",2021
C09K,"MATERIALS FOR MISCELLANEOUS APPLICATIONS, NOT PROVIDED FOR ELSEWHERE",2018
C23C,"COATING METALLIC MATERIAL; COATING MATERIAL WITH METALLIC MATERIAL; SURFACE TREATMENT OF METALLIC MATERIAL BY DIFFUSION INTO THE SURFACE, BY CHEMICAL CONVERSION OR SUBSTITUTION; COATING BY VACUUM EVAPORATION, BY SPUTTERING, BY ION IMPLANTATION OR BY CHEMICAL VAPOUR DEPOSITION, IN GENERAL",2018
G09G,ARRANGEMENTS OR CIRCUITS FOR CONTROL OF INDICATING DEVICES USING STATIC MEANS TO PRESENT VARIABLE INFORMATION,2021
B23K,"SOLDERING OR UNSOLDERING; WELDING; CLADDING OR PLATING BY SOLDERING OR WELDING; CUTTING BY APPLYING HEAT LOCALLY, e.g. FLAME CUTTING; WORKING BY LASER BEAM",2018
B60W,CONJOINT CONTROL OF VEHICLE SUB-UNITS OF DIFFERENT TYPE OR DIFFERENT FUNCTION; CONTROL SYSTEMS SPECIALLY ADAPTED FOR HYBRID VEHICLES; ROAD VEHICLE DRIVE CONTROL SYSTEMS FOR PURPOSES NOT RELATED TO THE CONTROL OF A PARTICULAR SUB-UNIT,2022
B65G,"TRANSPORT OR STORAGE DEVICES, e.g. CONVEYORS FOR LOADING OR TIPPING, SHOP CONVEYOR SYSTEMS OR PNEUMATIC TUBE CONVEYORS",2022
E21B,"EARTH OR ROCK DRILLING; OBTAINING OIL, GAS, WATER, SOLUBLE OR MELTABLE MATERIALS OR A SLURRY OF MINERALS FROM WELLS",2021
H02K,DYNAMO-ELECTRIC MACHINES,2020
H05B,"ELECTRIC HEATING; ELECTRIC LIGHT SOURCES NOT OTHERWISE PROVIDED FOR; CIRCUIT ARRANGEMENTS FOR ELECTRIC LIGHT SOURCES, IN GENERAL",2018
A61L,"METHODS OR APPARATUS FOR STERILISING MATERIALS OR OBJECTS IN GENERAL; DISINFECTION, STERILISATION OR DEODORISATION OF AIR; CHEMICAL ASPECTS OF BANDAGES, DRESSINGS, ABSORBENT PADS OR SURGICAL ARTICLES; MATERIALS FOR BANDAGES, DRESSINGS, ABSORBENT PADS OR SURGICAL ARTICLES",2022
B60L,PROPULSION OF ELECTRICALLY-PROPELLED VEHICLES; SUPPLYING ELECTRIC POWER FOR AUXILIARY EQUIPMENT OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRODYNAMIC BRAKE SYSTEMS FOR VEHICLES IN GENERAL; MAGNETIC SUSPENSION OR LEVITATION FOR VEHICLES; MONITORING OPERATING VARIABLES OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRIC SAFETY DEVICES FOR ELECTRICALLY-PROPELLED VEHICLES,2021
G05D,SYSTEMS FOR CONTROLLING OR REGULATING NON-ELECTRIC VARIABLES,2020
H04M,TELEPHONIC COMMUNICATION,2021
B60K,"ARRANGEMENT OR MOUNTING OF PROPULSION UNITS OR OF TRANSMISSIONS IN VEHICLES; ARRANGEMENT OR MOUNTING OF PLURAL DIVERSE PRIME-MOVERS IN VEHICLES; AUXILIARY DRIVES FOR VEHICLES; INSTRUMENTATION OR DASHBOARDS FOR VEHICLES; ARRANGEMENTS IN CONNECTION WITH COOLING, AIR INTAKE, GAS EXHAUST OR FUEL SUPPLY OF PROPULSION UNITS IN VEHICLES",2018
C08F,MACROMOLECULAR COMPOUNDS OBTAINED BY REACTIONS ONLY INVOLVING CARBON-TO-CARBON UNSATURATED BONDS,2018
H01R,ELECTRICALLY-CONDUCTIVE CONNECTIONS; STRUCTURAL ASSOCIATIONS OF A PLURALITY OF MUTUALLY-INSULATED ELECTRICAL CONNECTING ELEMENTS; COUPLING DEVICES; CURRENT COLLECTORS,2018
B62D,MOTOR VEHICLES; TRAILERS,2021
C04B,"LIME, MAGNESIA; SLAG; CEMENTS; COMPOSITIONS THEREOF, e.g. MORTARS, CONCRETE OR LIKE BUILDING MATERIALS; ARTIFICIAL STONE; CERAMICS; REFRACTORIES; TREATMENT OF NATURAL STONE",2018
G01C,"MEASURING DISTANCES, LEVELS OR BEARINGS; SURVEYING; NAVIGATION; GYROSCOPIC INSTRUMENTS; PHOTOGRAMMETRY OR VIDEOGRAMMETRY",2021
C01B,NON-METALLIC ELEMENTS; COMPOUNDS THEREOF; METALLOIDS OR COMPOUNDS THEREOF NOT COVERED BY SUBCLASS C01C,2022
A23V,"INDEXING SCHEME RELATING TO FOODS, FOODSTUFFS OR NON-ALCOHOLIC BEVERAGES AND LACTIC OR PROPIONIC ACID BACTERIA USED IN FOODSTUFFS OR FOOD PREPARATION",2017
A61Q,SPECIFIC USE OF COSMETICS OR SIMILAR TOILETRY PREPARATIONS,2018
H02M,"APPARATUS FOR CONVERSION BETWEEN AC AND AC, BETWEEN AC AND DC, OR BETWEEN DC AND DC, AND FOR USE WITH MAINS OR SIMILAR POWER SUPPLY SYSTEMS; CONVERSION OF DC OR AC INPUT POWER INTO SURGE OUTPUT POWER; CONTROL OR REGULATION THEREOF",2021
B25J,MANIPULATORS; CHAMBERS PROVIDED WITH MANIPULATION DEVICES,2021
C22C,ALLOYS,2017
G01B,"MEASURING LENGTH, THICKNESS OR SIMILAR LINEAR DIMENSIONS; MEASURING ANGLES; MEASURING AREAS; MEASURI
Current sql:
WITH level5_cpc AS (
    SELECT
        TRIM("symbol") AS "cpc_symbol",
        "titleFull" AS "full_title",
        LENGTH(TRIM("symbol")) AS "symbol_length"
    FROM
        PATENTS.PATENTS.CPC_DEFINITION
    WHERE
        "level" = 5
),
publication_cpc AS (
    SELECT
        p."publication_number",
        TRIM(c.value:"code"::STRING) AS "cpc_code",
        EXTRACT(year FROM TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD')) AS "year"
    FROM
        PATENTS.PATENTS.PUBLICATIONS p,
        LATERAL FLATTEN(input => p."cpc") c
    WHERE
        c.value:"code"::STRING IS NOT NULL
        AND p."publication_date" IS NOT NULL
),
cpc_publications AS (
    SELECT
        l5."cpc_symbol",
        pc."year",
        pc."publication_number",
        l5."full_title"
    FROM
        publication_cpc pc
    INNER JOIN
        level5_cpc l5
    ON
        LEFT(pc."cpc_code", LENGTH(l5."cpc_symbol")) = l5."cpc_symbol"
    WHERE
        pc."year" IS NOT NULL
),
annual_counts AS (
    SELECT
        cp."cpc_symbol",
        cp."full_title",
        cp."year",
        COUNT(DISTINCT cp."publication_number") AS "num_publications"
    FROM
        cpc_publications cp
    GROUP BY
        cp."cpc_symbol",
        cp."full_title",
        cp."year"
),
ordered_counts AS (
    SELECT
        ac.*,
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."year") AS "rn"
    FROM
        annual_counts ac
),
ema_calc AS (
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        CAST(oc."num_publications" AS FLOAT) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    WHERE
        oc."rn" = 1
    UNION ALL
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        ROUND(0.2 * oc."num_publications" + 0.8 * ec."ema", 4) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    INNER JOIN
        ema_calc ec
    ON
        oc."cpc_symbol" = ec."cpc_symbol" AND oc."rn" = ec."rn" + 1
),
latest_ema AS (
    SELECT
        ec."cpc_symbol",
        ec."full_title",
        ec."year",
        ec."ema",
        ROW_NUMBER() OVER (PARTITION BY ec."cpc_symbol" ORDER BY ec."year" DESC) AS "rn"
    FROM
        ema_calc ec
),
ema_per_cpc AS (
    SELECT
        le."cpc_symbol",
        le."full_title",
        le."ema"
    FROM
        latest_ema le
    WHERE
        le."rn" = 1
),
best_years AS (
    SELECT
        ac."cpc_symbol",
        ac."full_title",
        ac."year" AS "best_year",
        ac."num_publications",
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."num_publications" DESC) AS "rn"
    FROM
        annual_counts ac
),
best_year_per_cpc AS (
    SELECT
        byc."cpc_symbol",
        byc."full_title",
        byc."best_year"
    FROM
        best_years byc
    WHERE
        byc."rn" = 1
)
SELECT
    epc."cpc_symbol" AS "CPC_Symbol",
    epc."full_title" AS "Full_Title",
    byp."best_year" AS "Best_Year"
FROM
    ema_per_cpc epc
JOIN
    best_year_per_cpc byp
ON
    epc."cpc_symbol" = byp."cpc_symbol"
ORDER BY
    epc."ema" DESC NULLS LAST
LIMIT 100;
2025-01-27 02:13:50 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 02:13:50 - root - INFO - ```sql
WITH level5_cpc AS (
    SELECT
        TRIM("symbol") AS "cpc_symbol",
        "titleFull" AS "full_title"
    FROM
        PATENTS.PATENTS.CPC_DEFINITION
    WHERE
        "level" = 5
),
publication_cpc AS (
    SELECT
        p."publication_number",
        c.value:"code"::STRING AS "cpc_code",
        EXTRACT(year FROM TRY_TO_DATE(p."publication_date"::VARCHAR, 'YYYYMMDD')) AS "year"
    FROM
        PATENTS.PATENTS.PUBLICATIONS p,
        LATERAL FLATTEN(input => p."cpc") c
    WHERE
        c.value:"code"::STRING IS NOT NULL
        AND p."publication_date" IS NOT NULL
),
cpc_publications AS (
    SELECT
        pc."cpc_code" AS "cpc_symbol",
        pc."year",
        pc."publication_number",
        l5."full_title"
    FROM
        publication_cpc pc
    INNER JOIN
        level5_cpc l5
    ON
        pc."cpc_code" = l5."cpc_symbol"
    WHERE
        pc."year" IS NOT NULL
),
annual_counts AS (
    SELECT
        cp."cpc_symbol",
        cp."full_title",
        cp."year",
        COUNT(DISTINCT cp."publication_number") AS "num_publications"
    FROM
        cpc_publications cp
    GROUP BY
        cp."cpc_symbol",
        cp."full_title",
        cp."year"
),
ordered_counts AS (
    SELECT
        ac.*,
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."year") AS "rn"
    FROM
        annual_counts ac
),
ema_calc AS (
    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        CAST(oc."num_publications" AS FLOAT) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    WHERE
        oc."rn" = 1

    UNION ALL

    SELECT
        oc."cpc_symbol",
        oc."full_title",
        oc."year",
        oc."num_publications",
        ROUND(0.2 * oc."num_publications" + 0.8 * ec."ema", 4) AS "ema",
        oc."rn"
    FROM
        ordered_counts oc
    INNER JOIN
        ema_calc ec
    ON
        oc."cpc_symbol" = ec."cpc_symbol" AND oc."rn" = ec."rn" + 1
),
latest_ema AS (
    SELECT
        ec."cpc_symbol",
        ec."full_title",
        ec."year",
        ec."ema",
        ROW_NUMBER() OVER (PARTITION BY ec."cpc_symbol" ORDER BY ec."year" DESC) AS "rn"
    FROM
        ema_calc ec
),
ema_per_cpc AS (
    SELECT
        le."cpc_symbol",
        le."full_title",
        le."ema"
    FROM
        latest_ema le
    WHERE
        le."rn" = 1
),
best_years AS (
    SELECT
        ac."cpc_symbol",
        ac."full_title",
        ac."year" AS "best_year",
        ac."num_publications",
        ROW_NUMBER() OVER (PARTITION BY ac."cpc_symbol" ORDER BY ac."num_publications" DESC) AS "rn"
    FROM
        annual_counts ac
),
best_year_per_cpc AS (
    SELECT
        byc."cpc_symbol",
        byc."full_title",
        byc."best_year"
    FROM
        best_years byc
    WHERE
        byc."rn" = 1
)
SELECT
    epc."cpc_symbol" AS "CPC_Symbol",
    epc."full_title" AS "Full_Title",
    byp."best_year" AS "Best_Year"
FROM
    ema_per_cpc epc
JOIN
    best_year_per_cpc byp
ON
    epc."cpc_symbol" = byp."cpc_symbol"
ORDER BY
    epc."ema" DESC NULLS LAST
LIMIT 100;
```
2025-01-27 02:13:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 02:13:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 02:13:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 02:13:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-27 02:13:52 - snowflake.connector.connection - INFO - closed
2025-01-27 02:13:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 02:13:52 - root - INFO - Total iteration counts: 10
