2025-01-26 17:32:44 - openai._base_client - INFO - Retrying request to /chat/completions in 0.393676 seconds
2025-01-26 17:33:58 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 17:33:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:33:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:33:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:33:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:33:59 - snowflake.connector.connection - INFO - closed
2025-01-26 17:33:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:33:59 - root - INFO - SQL:
SELECT
       "index_number",
       "port_name",
       "region_number",
       "port_latitude",
       "port_longitude"
   FROM
       NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX
   WHERE
       "region_number" = '6585'
   LIMIT 100;
Results:
index_number,port_name,region_number,port_latitude,port_longitude
8570,MAYPORT,6585,30.4,-81.433333
8180,CAPE CHARLES,6585,37.266667,-76.016667
8245,PINEY POINT,6585,38.133333,-76.533333
8318,WARWICK,6585,37.45,-77.416667
8270,FREDERICKSBURG,6585,38.3,-77.45
8030,NEW CASTLE,6585,39.65,-75.566667
8040,DEEPWATER POINT,6585,39.7,-75.516667
8115,PAULSBORO,6585,39.85,-75.25
8150,BRISTOL,6585,40.1,-74.85
7990,LEONARDO,6585,40.433333,-74.066667
7900,GRASSELLI,6585,40.616667,-74.2
7780,JERSEY CITY,6585,40.716667,-74.033333
7730,RENSSELAER,6585,42.65,-73.75
7510,NORWICH,6585,41.516667,-72.083333
7450,MONTAUK HARBOR,6585,41.066667,-71.933333
7470,STONINGTON,6585,41.333333,-71.9
7440,DAVISVILLE DEPOT,6585,41.616667,-71.4
7430,QUONSET POINT,6585,41.583333,-71.4
7315,HYANNIS PORT,6585,41.633333,-70.3
7270,SCITUATE,6585,42.2,-70.716667
7200,ROCKPORT,6585,42.666667,-70.616667
7190,NEWBURYPORT,6585,42.816667,-70.866667
7140,SOUTH HARPSWELL,6585,43.733333,-70.016667
7020,PEMAQUID BEACH,6585,43.866667,-69.533333
7100,GARDINER,6585,44.233333,-69.766667
6970,MONHEGAN,6585,43.766667,-69.316667
6830,MATINICUS,6585,43.866667,-68.883333
6820,CRIEHAVEN,6585,43.833333,-68.883333
6870,SANDYPOINT,6585,44.516667,-68.816667
6800,BUCKS HARBOR,6585,44.333333,-68.733333
6750,MINTURN,6585,44.15,-68.45
6740,FRENCHBORO,6585,44.116667,-68.366667
6810,STONINGTON,6585,44.15,-68.666667
6690,SORRENTO,6585,44.466667,-68.183333
6670,COREA,6585,44.4,-67.966667
6660,MILBRIDGE,6585,44.533333,-67.883333
6650,WYMAN,6585,44.516667,-67.866667
8350,PLYMOUTH,6585,35.866667,-76.75
8340,EDENTON,6585,36.05,-76.616667
8330,HERTFORD,6585,36.183333,-76.466667
8370,COLUMBIA,6585,35.916667,-76.25
8580,JACKSONVILLE,6585,30.316667,-81.65
8530,SAVANNAH,6585,32.083333,-81.083333
8500,CHARLESTON,6585,32.783333,-79.916667
8300,NEWPORT NEWS,6585,36.966667,-76.433333
8290,PORTSMOUTH,6585,36.816667,-76.3
8280,NORFOLK,6585,36.85,-76.3
8190,SALISBURY,6585,38.366667,-75.6
8210,BALTIMORE,6585,39.266667,-76.583333
8050,WILMINGTON,6585,39.733333,-75.55
8025,SALEM NJ,6585,39.666667,-75.483333
8080,CHESTER,6585,39.85,-75.35
8110,PHILADELPHIA,6585,39.95,-75.133333
8130,CAMDEN,6585,39.95,-75.133333
7940,SEWAREN,6585,40.55,-74.25
7960,PERTH AMBOY,6585,40.5,-74.266667
7790,BAYONNE,6585,40.683333,-74.1
7860,MARINERS HARBOR SI,6585,40.633333,-74.166667
7630,BROOKLYN,6585,40.666667,-74.016667
7640,NEW YORK CITY,6585,40.7,-74.016667
7760,WEEHAWKEN,6585,40.766667,-74.016667
7690,CATSKILL,6585,42.216667,-73.85
7500,NEW LONDON,6585,41.35,-72.083333
7250,BOSTON,6585,42.35,-71.05
7150,PORTLAND,6585,43.666667,-70.25
7080,BATH,6585,43.916667,-69.816667
6720,SOUTHWEST HARBOR,6585,44.283333,-68.316667
8640,MIAMI,6585,25.783333,-80.183333
8630,PORT EVERGLADES,6585,26.1,-80.116667
8410,NEW BERN,6585,35.1,-77.05
8170,OCEAN CITY,6585,38.333333,-75.083333
7950,MAURER,6585,40.533333,-74.25
7850,PORT RICHMOND SI,6585,40.65,-74.133333
7830,STAPLETON SI,6585,40.633333,-74.066667
7840,TOMPKINSVILLE SI,6585,40.633333,-74.066667
7820,ELIZABETHPORT,6585,40.65,-74.183333
7770,HOBOKEN,6585,40.75,-74.016667
7810,NEWARK,6585,40.7,-74.15
7750,EDGEWATER,6585,40.816667,-73.983333
7660,NEWBURGH,6585,41.5,-74.0
7680,KINGSTON,6585,41.933333,-73.966667
7625,CITY ISLAND,6585,40.85,-73.783333
7610,GREENWICH,6585,41.016667,-73.616667
7600,STAMFORD,6585,41.033333,-73.55
7550,NEW HAVEN,6585,41.233333,-72.916667
7380,NEWPORT,6585,41.5,-71.333333
7260,QUINCY,6585,42.25,-70.966667
7040,BOOTHBAY HARBOR,6585,43.866667,-69.583333
7070,ROBINHOOD,6585,43.85,-69.733333
6990,THOMASTON,6585,44.066667,-69.183333
6770,BASS HARBOR,6585,44.233333,-68.35
8610,PALM BEACH,6585,26.766667,-80.05
8600,FORT PIERCE,6585,27.466667,-80.316667
8590,ST AUGUSTINE,6585,29.9,-81.316667
8560,FERNANDINA BEACH,6585,30.683333,-81.466667
8550,BRUNSWICK,6585,31.15,-81.5
8540,DARIEN,6585,31.366667,-81.433333
8520,BEAUFORT,6585,32.433333,-80.666667
8510,PORT ROYAL,6585,32.366667,-80.683333
8490,GEORGETOWN,6585,33.366667,-79.283333

2025-01-26 17:33:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:33:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:33:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:34:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7
2025-01-26 17:34:01 - snowflake.connector.connection - INFO - closed
2025-01-26 17:34:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:34:01 - root - INFO - SQL:
SELECT DISTINCT
       "basin"
   FROM
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES
   LIMIT 100;
Results:
basin
SI
NI
SA
NA
SP
EP
WP

2025-01-26 17:34:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:34:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:34:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:34:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:34:03 - snowflake.connector.connection - INFO - closed
2025-01-26 17:34:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:34:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 17:34:40 - root - INFO - ```sql
SELECT
    p."port_name"
FROM
    NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX p
JOIN
    NOAA_PORTS.NOAA_HURRICANES.HURRICANES h
ON
    ST_Distance(
        ST_Point(p."port_longitude", p."port_latitude"),
        ST_Point(h."longitude", h."latitude")
    ) <= 50000  -- Within 50 kilometers
WHERE
    p."region_number" = '6585'
    AND h."basin" = 'NA'
    AND h."wmo_wind" >= 35
    AND h."name" != 'NOT_NAMED' AND h."name" IS NOT NULL
GROUP BY
    p."port_name"
ORDER BY
    COUNT(*) DESC
LIMIT 1;
```
2025-01-26 17:34:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:34:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:34:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:34:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-26 17:34:42 - snowflake.connector.connection - INFO - closed
2025-01-26 17:34:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:36:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 17:36:08 - root - INFO - SQL:
SELECT
    p."port_name"
FROM
    NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX p
JOIN
    NOAA_PORTS.NOAA_HURRICANES.HURRICANES h
ON
    ST_Distance(
        ST_Point(p."port_longitude", p."port_latitude"),
        ST_Point(h."longitude", h."latitude")
    ) <= 50000  -- Within 50 kilometers
WHERE
    p."region_number" = '6585'
    AND h."basin" = 'NA'
    AND h."wmo_wind" >= 35
    AND h."name" != 'NOT_NAMED' AND h."name" IS NOT NULL
GROUP BY
    p."port_name"
ORDER BY
    COUNT(*) DESC
LIMIT 1;
Results:
port_name
BEAUFORT

2025-01-26 17:36:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:36:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:36:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:36:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:36:09 - snowflake.connector.connection - INFO - closed
2025-01-26 17:36:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:36:09 - root - INFO - SQL:
-- Corrected Query 1
SELECT
       "name",
       COUNT(*) AS "occurrence_count"
   FROM
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES
   WHERE
       "basin" = 'NA' AND
       "name" IS NOT NULL AND "name" != 'NOT_NAMED'
   GROUP BY
       "name"
   ORDER BY
       "occurrence_count" DESC
   LIMIT 100
Results:
name,occurrence_count
ARLENE,662
FLORENCE,642
FRANCES,613
BONNIE,570
HELENE,556
DANIELLE,542
BERTHA,534
EMILY,516
EARL,513
DENNIS,497
GERT,467
CLAUDETTE,461
CINDY,458
JOSEPHINE,455
ALBERTO,454
EDOUARD,448
FELIX,406
LILI,398
CHRIS,387
GABRIELLE,383
DANNY,381
HARVEY,380
DOLLY,380
GORDON,372
OPHELIA,372
IRENE,371
ANA,369
ERIN,358
BETSY,355
KARL,352
BERYL,350
LESLIE,345
BEULAH,341
IVAN,339
ARTHUR,333
CHANTAL,333
JOSE,331
ISAAC,330
ISIDORE,328
LISA,328
LEE,324
EDITH,320
CHARLEY,314
MARIA,314
BARRY,311
GUSTAV,309
BRET,309
JEANNE,308
HUMBERTO,308
FRANKLIN,307
PHILIPPE,304
ABLE,300
CLEO,297
CHARLIE,296
CAROL,296
DEBBY,296
ELLA,296
HENRI,296
KATIA,293
ERNESTO,289
DEAN,287
GASTON,285
GLORIA,283
GLADYS,280
ANNA,277
DEBBIE,276
ALEX,275
NICOLE,275
DOG,273
JERRY,267
GINGER,262
KATE,261
GRACE,260
HERMINE,258
FLOYD,254
KAREN,254
NADINE,251
ALMA,251
FLORA,248
FRAN,247
CARRIE,246
KYLE,246
FRED,243
ERIKA,239
INGA,238
BECKY,236
IDA,235
BRENDA,235
DORIAN,234
HORTENSE,233
ALLISON,232
OTTO,232
FAY,231
HANNA,230
GRETA,228
ALICE,225
BAKER,224
CRISTOBAL,224
FIONA,223
LAURA,223

2025-01-26 17:36:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:36:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:36:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:36:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:36:11 - snowflake.connector.connection - INFO - closed
2025-01-26 17:36:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:36:11 - root - INFO - SQL:
-- Corrected Query 2
SELECT
       "port_name",
       "port_latitude",
       "port_longitude"
   FROM
       NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX
   WHERE
       "region_number" = '6585' AND
       "port_name" IS NOT NULL
   LIMIT 100
Results:
port_name,port_latitude,port_longitude
MAYPORT,30.4,-81.433333
CAPE CHARLES,37.266667,-76.016667
PINEY POINT,38.133333,-76.533333
WARWICK,37.45,-77.416667
FREDERICKSBURG,38.3,-77.45
NEW CASTLE,39.65,-75.566667
DEEPWATER POINT,39.7,-75.516667
PAULSBORO,39.85,-75.25
BRISTOL,40.1,-74.85
LEONARDO,40.433333,-74.066667
GRASSELLI,40.616667,-74.2
JERSEY CITY,40.716667,-74.033333
RENSSELAER,42.65,-73.75
NORWICH,41.516667,-72.083333
MONTAUK HARBOR,41.066667,-71.933333
STONINGTON,41.333333,-71.9
DAVISVILLE DEPOT,41.616667,-71.4
QUONSET POINT,41.583333,-71.4
HYANNIS PORT,41.633333,-70.3
SCITUATE,42.2,-70.716667
ROCKPORT,42.666667,-70.616667
NEWBURYPORT,42.816667,-70.866667
SOUTH HARPSWELL,43.733333,-70.016667
PEMAQUID BEACH,43.866667,-69.533333
GARDINER,44.233333,-69.766667
MONHEGAN,43.766667,-69.316667
MATINICUS,43.866667,-68.883333
CRIEHAVEN,43.833333,-68.883333
SANDYPOINT,44.516667,-68.816667
BUCKS HARBOR,44.333333,-68.733333
MINTURN,44.15,-68.45
FRENCHBORO,44.116667,-68.366667
STONINGTON,44.15,-68.666667
SORRENTO,44.466667,-68.183333
COREA,44.4,-67.966667
MILBRIDGE,44.533333,-67.883333
WYMAN,44.516667,-67.866667
PLYMOUTH,35.866667,-76.75
EDENTON,36.05,-76.616667
HERTFORD,36.183333,-76.466667
COLUMBIA,35.916667,-76.25
JACKSONVILLE,30.316667,-81.65
SAVANNAH,32.083333,-81.083333
CHARLESTON,32.783333,-79.916667
NEWPORT NEWS,36.966667,-76.433333
PORTSMOUTH,36.816667,-76.3
NORFOLK,36.85,-76.3
SALISBURY,38.366667,-75.6
BALTIMORE,39.266667,-76.583333
WILMINGTON,39.733333,-75.55
SALEM NJ,39.666667,-75.483333
CHESTER,39.85,-75.35
PHILADELPHIA,39.95,-75.133333
CAMDEN,39.95,-75.133333
SEWAREN,40.55,-74.25
PERTH AMBOY,40.5,-74.266667
BAYONNE,40.683333,-74.1
MARINERS HARBOR SI,40.633333,-74.166667
BROOKLYN,40.666667,-74.016667
NEW YORK CITY,40.7,-74.016667
WEEHAWKEN,40.766667,-74.016667
CATSKILL,42.216667,-73.85
NEW LONDON,41.35,-72.083333
BOSTON,42.35,-71.05
PORTLAND,43.666667,-70.25
BATH,43.916667,-69.816667
SOUTHWEST HARBOR,44.283333,-68.316667
MIAMI,25.783333,-80.183333
PORT EVERGLADES,26.1,-80.116667
NEW BERN,35.1,-77.05
OCEAN CITY,38.333333,-75.083333
MAURER,40.533333,-74.25
PORT RICHMOND SI,40.65,-74.133333
STAPLETON SI,40.633333,-74.066667
TOMPKINSVILLE SI,40.633333,-74.066667
ELIZABETHPORT,40.65,-74.183333
HOBOKEN,40.75,-74.016667
NEWARK,40.7,-74.15
EDGEWATER,40.816667,-73.983333
NEWBURGH,41.5,-74.0
KINGSTON,41.933333,-73.966667
CITY ISLAND,40.85,-73.783333
GREENWICH,41.016667,-73.616667
STAMFORD,41.033333,-73.55
NEW HAVEN,41.233333,-72.916667
NEWPORT,41.5,-71.333333
QUINCY,42.25,-70.966667
BOOTHBAY HARBOR,43.866667,-69.583333
ROBINHOOD,43.85,-69.733333
THOMASTON,44.066667,-69.183333
BASS HARBOR,44.233333,-68.35
PALM BEACH,26.766667,-80.05
FORT PIERCE,27.466667,-80.316667
ST AUGUSTINE,29.9,-81.316667
FERNANDINA BEACH,30.683333,-81.466667
BRUNSWICK,31.15,-81.5
DARIEN,31.366667,-81.433333
BEAUFORT,32.433333,-80.666667
PORT ROYAL,32.366667,-80.683333
GEORGETOWN,33.366667,-79.283333

2025-01-26 17:36:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:36:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:36:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:36:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:36:13 - snowflake.connector.connection - INFO - closed
2025-01-26 17:36:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:36:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 17:36:29 - root - INFO - ```sql
SELECT
    "sid",
    "name",
    "latitude",
    "longitude",
    "wmo_wind",
    "basin"
FROM
    NOAA_PORTS.NOAA_HURRICANES.HURRICANES
WHERE
    "basin" = 'NA'
    AND "name" IS NOT NULL AND "name" != 'NOT_NAMED'
    AND "latitude" IS NOT NULL
    AND "longitude" IS NOT NULL
    AND "wmo_wind" IS NOT NULL
LIMIT 100;
```
2025-01-26 17:36:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:36:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:36:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:36:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:36:30 - snowflake.connector.connection - INFO - closed
2025-01-26 17:36:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:37:31 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 17:37:31 - root - INFO - SQL:
SELECT
    "sid",
    "name",
    "latitude",
    "longitude",
    "wmo_wind",
    "basin"
FROM
    NOAA_PORTS.NOAA_HURRICANES.HURRICANES
WHERE
    "basin" = 'NA'
    AND "name" IS NOT NULL AND "name" != 'NOT_NAMED'
    AND "latitude" IS NOT NULL
    AND "longitude" IS NOT NULL
    AND "wmo_wind" IS NOT NULL
LIMIT 100;
Results:
sid,name,latitude,longitude,wmo_wind,basin
1950274N26272,HOW,26.2,-91.1,40,NA
1950274N26272,HOW,24.0,-97.2,35,NA
1950281N23270,ITEM,21.8,-92.7,50,NA
1950281N23270,ITEM,19.1,-95.7,90,NA
1951224N12316,CHARLIE,12.2,-46.2,30,NA
1951224N12316,CHARLIE,15.6,-64.6,65,NA
1951246N13340,FOX,50.0,-29.8,75,NA
1951246N13340,FOX,57.5,-21.2,55,NA
1951272N20274,HOW,64.0,-19.5,65,NA
1952231N15341,ABLE,14.6,-19.0,25,NA
1952231N15341,ABLE,21.7,-63.8,55,NA
1952231N15341,ABLE,25.9,-71.9,50,NA
1952244N15306,BAKER,45.4,-52.3,85,NA
1952268N20291,CHARLIE,40.3,-55.5,75,NA
1952269N13311,DOG,16.6,-54.0,60,NA
1952269N13311,DOG,21.9,-59.4,30,NA
1953146N14278,ALICE,14.4,-85.0,25,NA
1953240N14340,CAROL,14.0,-41.8,50,NA
1953240N14340,CAROL,43.4,-66.8,75,NA
1953251N18295,DOLLY,20.2,-69.0,45,NA
1953251N18295,DOLLY,43.2,-31.9,40,NA
1953267N15282,FLORENCE,31.2,-84.7,40,NA
1954248N20295,EDNA,29.6,-76.3,110,NA
1954278N12302,HAZEL,15.3,-75.6,105,NA
1954278N12302,HAZEL,27.0,-75.7,110,NA
1955215N15320,CONNIE,42.9,-81.3,40,NA
1955219N16319,DIANE,30.0,-73.4,75,NA
1955234N11318,EDITH,13.5,-46.5,25,NA
1955234N11318,EDITH,14.9,-49.9,30,NA
1955234N11318,EDITH,15.8,-52.1,45,NA
1955234N11318,EDITH,37.6,-55.6,35,NA
1955247N20267,GLADYS,22.6,-96.5,50,NA
1955265N13307,JANET,18.4909,-88.2103,150,NA
1955288N13281,KATIE,29.5,-65.4,45,NA
1956222N13313,BETSY,25.7,-76.0,105,NA
1956222N13313,BETSY,41.7,-62.1,60,NA
1956222N13313,BETSY,42.0,-32.0,25,NA
1956251N25285,CARLA,41.8,-53.0,60,NA
1956254N20269,DORA,21.7,-95.5,45,NA
1956265N18274,FLOSSY,31.9,-83.2,35,NA
1956265N18274,FLOSSY,37.0,-56.0,35,NA
1956265N18274,FLOSSY,40.0,-56.2,45,NA
1957245N13339,CARRIE,13.4,-25.0,30,NA
1957245N13339,CARRIE,19.9,-51.4,70,NA
1958221N17340,BECKY,20.4,-60.4,40,NA
1958221N17340,BECKY,24.0,-69.8,40,NA
1958223N12340,CLEO,15.9,-49.0,110,NA
1958257N17293,GERDA,28.4,-97.5,30,NA
1958264N17308,HELENE,21.1,-62.4,25,NA
1958264N17308,HELENE,30.2,-76.2,95,NA
1958267N18309,ILSA,20.9,-61.3,70,NA
1959148N23274,ARLENE,31.5,-90.9,25,NA
1959264N20292,GRACIE,43.0,-68.0,25,NA
1959271N27310,HANNAH,30.5,-68.1,100,NA
1959271N27310,HANNAH,34.1,-68.0,100,NA
1960210N28275,BRENDA,27.6,-85.3,35,NA
1960210N28275,BRENDA,46.0,-69.3,35,NA
1960210N28275,BRENDA,56.2,-62.0,20,NA
1960261N21296,FLORENCE,27.3,-80.3,50,NA
1961245N13318,BETSY,23.2,-50.6,85,NA
1961245N13318,BETSY,36.6,-58.7,75,NA
1961245N13318,BETSY,56.5,-21.0,70,NA
1961245N13318,BETSY,61.0,-24.5,60,NA
1961247N13283,CARLA,24.1,-90.3,105,NA
1961290N20282,GERDA,42.4,-64.5,60,NA
1961299N11281,HATTIE,10.5,-79.0,25,NA
1961306N23301,JENNY,22.5,-59.0,30,NA
1962272N15311,DAISY,16.8,-60.1,35,NA
1962272N15311,DAISY,25.2,-69.3,70,NA
1962272N15311,DAISY,42.7,-66.9,80,NA
1963213N11321,ARLENE,20.7,-63.2,25,NA
1963213N11321,ARLENE,22.8,-66.2,25,NA
1963232N11313,BEULAH,16.5,-54.6,45,NA
1963232N11313,BEULAH,24.8,-60.0,90,NA
1963232N11313,BEULAH,41.6,-51.0,70,NA
1963262N14322,DEBRA,28.0,-47.7,50,NA
1963267N11309,EDITH,17.7,-67.9,65,NA
1963272N09314,FLORA,38.1,-56.0,90,NA
1963272N09314,FLORA,53.0,-43.0,70,NA
1963272N09314,FLORA,64.0,-32.0,45,NA
1963291N26288,GINNY,32.8,-73.5,60,NA
1963291N26288,GINNY,28.8,-78.2,65,NA
1964234N13316,CLEO,36.3,-76.4,35,NA
1964242N14343,DORA,14.3,-51.3,60,NA
1964248N18324,ETHEL,18.4,-38.4,35,NA
1964248N18324,ETHEL,41.5,-26.5,35,NA
1964249N15342,FLORENCE,29.5,-27.7,40,NA
1964257N15316,GLADYS,23.7,-62.0,75,NA
1964257N15316,GLADYS,47.5,-54.9,60,NA
1964283N15277,ISBELL,19.4,-85.5,30,NA
1965239N11310,BETSY,18.2,-63.0,35,NA
1965239N11310,BETSY,28.9,-75.3,95,NA
1965259N13340,CAROL,13.5,-34.6,40,NA
1965259N13340,CAROL,28.8,-41.4,80,NA
1965259N13340,CAROL,33.0,-41.0,60,NA
1965259N13340,CAROL,32.8,-41.8,60,NA
1965259N13340,CAROL,39.5,-17.8,55,NA
1966156N16275,ALMA,17.3,-84.6,35,NA
1966204N10325,ELLA,11.5,-40.7,25,NA
1950224N17305,ABLE,25.2,-66.8,70,NA

2025-01-26 17:37:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:37:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:37:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:37:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 27
2025-01-26 17:37:33 - snowflake.connector.connection - INFO - closed
2025-01-26 17:37:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:37:33 - root - INFO - SQL:
-- Corrected Query 4
SELECT
       "port_name",
       "port_latitude",
       "port_longitude"
FROM
       NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX
WHERE
       "port_latitude" BETWEEN 20 AND 30 AND
       "port_longitude" BETWEEN -90 AND -80 AND
       "port_name" IS NOT NULL AND
       "port_latitude" IS NOT NULL AND
       "port_longitude" IS NOT NULL
LIMIT 100
Results:
port_name,port_latitude,port_longitude
SAN MIGUEL DE COZUMEL,20.5,-86.966667
TAMPA,27.916667,-82.45
BAHAI DE LA HABANA,23.133333,-82.366667
MIAMI,25.783333,-80.183333
PORT EVERGLADES,26.1,-80.116667
PROGRESO,21.283333,-89.666667
GRAND ISLE,29.233333,-90.0
PORT SULPHUR,29.483333,-89.683333
APALACHICOLA,29.716667,-84.983333
ST PETERSBURG,27.766667,-82.616667
PORT MANATEE,27.633333,-82.566667
BOCA GRANDE,26.7,-82.333333
KEY WEST,24.55,-81.816667
PALM BEACH,26.766667,-80.05
FORT PIERCE,27.466667,-80.316667
ST AUGUSTINE,29.9,-81.316667
ISABELA DE SAGUA,22.95,-80.0
CARDENAS,23.05,-81.2
MATANZAS,23.05,-81.55
CIENFUEGOS,22.15,-80.45
CARRABELLE,29.85,-84.666667
TARPON SPRINGS,28.15,-82.766667
PORT ST JOE,29.816667,-85.316667
CANAVERAL HARBOR,28.7,-80.616667
MARIEL,22.983333,-82.75
CABANAS,23.0,-82.966667
NUEVA GERONA,21.916667,-82.8

2025-01-26 17:37:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:37:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:37:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:37:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:37:34 - snowflake.connector.connection - INFO - closed
2025-01-26 17:37:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:37:35 - root - INFO - SQL:
-- Corrected Query 5
SELECT
       "sid",
       "name",
       "latitude",
       "longitude",
       "wmo_wind"
FROM
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES
WHERE
       "basin" = 'NA' AND
       "name" IS NOT NULL AND "name" != 'NOT_NAMED' AND
       "latitude" IS NOT NULL AND
       "longitude" IS NOT NULL AND
       "wmo_wind" IS NOT NULL
LIMIT 100
Results:
sid,name,latitude,longitude,wmo_wind
1950274N26272,HOW,26.2,-91.1,40
1950274N26272,HOW,24.0,-97.2,35
1950281N23270,ITEM,21.8,-92.7,50
1950281N23270,ITEM,19.1,-95.7,90
1951224N12316,CHARLIE,12.2,-46.2,30
1951224N12316,CHARLIE,15.6,-64.6,65
1951246N13340,FOX,50.0,-29.8,75
1951246N13340,FOX,57.5,-21.2,55
1951272N20274,HOW,64.0,-19.5,65
1952231N15341,ABLE,14.6,-19.0,25
1952231N15341,ABLE,21.7,-63.8,55
1952231N15341,ABLE,25.9,-71.9,50
1952244N15306,BAKER,45.4,-52.3,85
1952268N20291,CHARLIE,40.3,-55.5,75
1952269N13311,DOG,16.6,-54.0,60
1952269N13311,DOG,21.9,-59.4,30
1953146N14278,ALICE,14.4,-85.0,25
1953240N14340,CAROL,14.0,-41.8,50
1953240N14340,CAROL,43.4,-66.8,75
1953251N18295,DOLLY,20.2,-69.0,45
1953251N18295,DOLLY,43.2,-31.9,40
1953267N15282,FLORENCE,31.2,-84.7,40
1954248N20295,EDNA,29.6,-76.3,110
1954278N12302,HAZEL,15.3,-75.6,105
1954278N12302,HAZEL,27.0,-75.7,110
1955215N15320,CONNIE,42.9,-81.3,40
1955219N16319,DIANE,30.0,-73.4,75
1955234N11318,EDITH,13.5,-46.5,25
1955234N11318,EDITH,14.9,-49.9,30
1955234N11318,EDITH,15.8,-52.1,45
1955234N11318,EDITH,37.6,-55.6,35
1955247N20267,GLADYS,22.6,-96.5,50
1955265N13307,JANET,18.4909,-88.2103,150
1955288N13281,KATIE,29.5,-65.4,45
1956222N13313,BETSY,25.7,-76.0,105
1956222N13313,BETSY,41.7,-62.1,60
1956222N13313,BETSY,42.0,-32.0,25
1956251N25285,CARLA,41.8,-53.0,60
1956254N20269,DORA,21.7,-95.5,45
1956265N18274,FLOSSY,31.9,-83.2,35
1956265N18274,FLOSSY,37.0,-56.0,35
1956265N18274,FLOSSY,40.0,-56.2,45
1957245N13339,CARRIE,13.4,-25.0,30
1957245N13339,CARRIE,19.9,-51.4,70
1958221N17340,BECKY,20.4,-60.4,40
1958221N17340,BECKY,24.0,-69.8,40
1958223N12340,CLEO,15.9,-49.0,110
1958257N17293,GERDA,28.4,-97.5,30
1958264N17308,HELENE,21.1,-62.4,25
1958264N17308,HELENE,30.2,-76.2,95
1958267N18309,ILSA,20.9,-61.3,70
1959148N23274,ARLENE,31.5,-90.9,25
1959264N20292,GRACIE,43.0,-68.0,25
1959271N27310,HANNAH,30.5,-68.1,100
1959271N27310,HANNAH,34.1,-68.0,100
1960210N28275,BRENDA,27.6,-85.3,35
1960210N28275,BRENDA,46.0,-69.3,35
1960210N28275,BRENDA,56.2,-62.0,20
1960261N21296,FLORENCE,27.3,-80.3,50
1961245N13318,BETSY,23.2,-50.6,85
1961245N13318,BETSY,36.6,-58.7,75
1961245N13318,BETSY,56.5,-21.0,70
1961245N13318,BETSY,61.0,-24.5,60
1961247N13283,CARLA,24.1,-90.3,105
1961290N20282,GERDA,42.4,-64.5,60
1961299N11281,HATTIE,10.5,-79.0,25
1961306N23301,JENNY,22.5,-59.0,30
1962272N15311,DAISY,16.8,-60.1,35
1962272N15311,DAISY,25.2,-69.3,70
1962272N15311,DAISY,42.7,-66.9,80
1963213N11321,ARLENE,20.7,-63.2,25
1963213N11321,ARLENE,22.8,-66.2,25
1963232N11313,BEULAH,16.5,-54.6,45
1963232N11313,BEULAH,24.8,-60.0,90
1963232N11313,BEULAH,41.6,-51.0,70
1963262N14322,DEBRA,28.0,-47.7,50
1963267N11309,EDITH,17.7,-67.9,65
1963272N09314,FLORA,38.1,-56.0,90
1963272N09314,FLORA,53.0,-43.0,70
1963272N09314,FLORA,64.0,-32.0,45
1963291N26288,GINNY,32.8,-73.5,60
1963291N26288,GINNY,28.8,-78.2,65
1964234N13316,CLEO,36.3,-76.4,35
1964242N14343,DORA,14.3,-51.3,60
1964248N18324,ETHEL,18.4,-38.4,35
1964248N18324,ETHEL,41.5,-26.5,35
1964249N15342,FLORENCE,29.5,-27.7,40
1964257N15316,GLADYS,23.7,-62.0,75
1964257N15316,GLADYS,47.5,-54.9,60
1964283N15277,ISBELL,19.4,-85.5,30
1965239N11310,BETSY,18.2,-63.0,35
1965239N11310,BETSY,28.9,-75.3,95
1965259N13340,CAROL,13.5,-34.6,40
1965259N13340,CAROL,28.8,-41.4,80
1965259N13340,CAROL,33.0,-41.0,60
1965259N13340,CAROL,32.8,-41.8,60
1965259N13340,CAROL,39.5,-17.8,55
1966156N16275,ALMA,17.3,-84.6,35
1966204N10325,ELLA,11.5,-40.7,25
1966204N10325,ELLA,22.5,-65.2,35

2025-01-26 17:37:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:37:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:37:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:37:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:37:36 - snowflake.connector.connection - INFO - closed
2025-01-26 17:37:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:37:37 - root - INFO - SQL:
-- Corrected Query 6
SELECT
       p."port_name",
       COUNT(*) AS "hurricane_proximity_count"
FROM
       NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX p
INNER JOIN
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES h
ON
       ST_Distance(
           ST_Point(p."port_longitude", p."port_latitude"),
           ST_Point(h."longitude", h."latitude")
       ) <= 50000  -- Within 50 kilometers
WHERE
       p."region_number" = '6585' AND
       h."basin" = 'NA' AND
       h."wmo_wind" >= 35 AND
       h."name" IS NOT NULL AND h."name" != 'NOT_NAMED' AND
       p."port_latitude" IS NOT NULL AND
       p."port_longitude" IS NOT NULL AND
       h."latitude" IS NOT NULL AND
       h."longitude" IS NOT NULL
GROUP BY
       p."port_name"
ORDER BY
       "hurricane_proximity_count" DESC
LIMIT 100
Results:
port_name,hurricane_proximity_count
BEAUFORT,41
MOREHEAD CITY,29
SOUTHPORT,24
WILMINGTON,22
WRIGHTSVILLE,21
FORT PIERCE,18
SWANSBORO,17
GEORGETOWN,16
PORT ROYAL,15
CHARLESTON,15
COLUMBIA,14
BAYBORO,14
NEW BERN,12
JACKSONVILLE,12
CANAVERAL HARBOR,12
MAYPORT,12
ELIZABETH CITY,12
STONINGTON,12
MONTAUK HARBOR,11
PLYMOUTH,11
EDGARTOWN,9
NOANK,9
BELHAVEN,9
FERNANDINA BEACH,9
MIAMI,9
ST AUGUSTINE,9
SAVANNAH,9
BRUNSWICK,9
BRISTOL,9
MYSTIC,8
NANTUCKET,8
DARIEN,8
VINEYARD HAVEN,8
HYANNIS,8
PORT EVERGLADES,8
HERTFORD,8
PORTSMOUTH,8
WASHINGTON,8
HYANNIS PORT,8
DAVISVILLE DEPOT,7
YORKTOWN,7
QUONSET POINT,7
NEW LONDON,7
OCEAN CITY,7
PATCHOGUE,7
WOODS HOLE,7
MAURER,6
GREENPORT,6
NEWPORT,6
CHROME,6
BARNEGAT,6
PORT READING,6
LEONARDO,6
SAYREVILLE,6
SALISBURY,6
ROCKPORT,6
CARTERET,6
FALMOUTH,6
SEWAREN,6
SOUTH AMBOY,6
FRIENDSHIP,6
PERTH AMBOY,6
PORT SOCONY,6
TIVERTON,6
NORFOLK,6
NEWPORT NEWS,5
STAPLETON SI,5
CITY ISLAND,5
TOMPKINSVILLE SI,5
BAYWAY,5
PROVINCETOWN,5
GRASSELLI,5
MACHIAS,5
JERSEY CITY,5
VINALHAVEN,5
EDENTON,5
NEW HARBOR,5
MARINERS HARBOR SI,5
NEW BEDFORD,5
PEMAQUID BEACH,5
PALM BEACH,5
NORWICH,5
PORT JEFFERSON,5
THOMASTON,5
PORT CLYDE,5
BROOKLYN,5
NEW YORK CITY,5
JONESPORT,5
MONHEGAN,5
NORTH HAVEN,5
GULFPORT SI,5
FALL RIVER,5
MATINICUS,5
WEST POINT,4
QUINCY,4
SCITUATE,4
SOUTH BRISTOL,4
EDGEWATER,4
GLOUCESTER,4
HOBOKEN,4

2025-01-26 17:37:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:37:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:37:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:37:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:37:38 - snowflake.connector.connection - INFO - closed
2025-01-26 17:37:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:37:38 - root - INFO - SQL:
-- Corrected Query 7
SELECT
       "name",
       MAX("wmo_wind") AS "max_wind_speed"
FROM
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES
WHERE
       "basin" = 'NA' AND
       "name" IS NOT NULL AND "name" != 'NOT_NAMED' AND
       "wmo_wind" IS NOT NULL
GROUP BY
       "name"
ORDER BY
       "max_wind_speed" DESC
LIMIT 100
Results:
name,max_wind_speed
ALLEN,165
GILBERT,160
DORIAN,160
WILMA,160
IRMA,155
RITA,155
MITCH,155
FELIX,150
CAMILLE,150
ANITA,150
DEAN,150
DAVID,150
MARIA,150
ANDREW,150
JANET,150
KATRINA,150
MATTHEW,145
IVAN,145
HATTIE,145
ISABEL,145
INEZ,140
BEULAH,140
CAROL,140
LORENZO,140
ESTHER,140
EMILY,140
MICHAEL,140
HUGO,140
EDITH,140
IAN,140
JOSE,135
SAM,135
JOAQUIN,135
FLOYD,135
IGOR,135
GEORGES,135
LENNY,135
IOTA,135
GUSTAV,135
HELENE,130
IDA,130
LUIS,130
OPAL,130
CLEO,130
CARMEN,130
DENNIS,130
LAURA,130
CHARLEY,130
FLORA,130
ETA,130
FLORENCE,130
EASY,130
GERT,130
BRET,125
EDOUARD,125
CARLA,125
GLORIA,125
GABRIELLE,125
PALOMA,125
GONZALO,125
JOAN:MIRIAM,125
IRIS,125
DONNA,125
FRANCES,125
DOG,125
KARL,125
FOX,125
FABIAN,125
EARL,125
IKE,125
LILI,125
FIONA,120
BETSY,120
CELIA,120
MICHELLE,120
KEITH,120
HILDA,120
NICOLE,120
OPHELIA,120
TEDDY,120
IONE,120
CARRIE,120
CONNIE,120
KATIA,120
HORTENSE,120
DELTA,120
CINDY,120
JULIA,120
ELLA,120
GLADYS,120
ISAAC,120
CLAUDETTE,115
DANIELLE,115
BILL,115
DEBBY,115
DIANA,115
DORA,115
FREDERIC,115
KING,115
HAZEL,115

2025-01-26 17:37:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:37:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:37:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:37:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:37:40 - snowflake.connector.connection - INFO - closed
2025-01-26 17:37:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:37:40 - root - INFO - SQL:
-- Corrected Query 8
SELECT DISTINCT
       p."port_name",
       h."name" AS "hurricane_name",
       h."iso_time"
FROM
       NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX p
INNER JOIN
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES h
ON
       ST_Distance(
           ST_Point(p."port_longitude", p."port_latitude"),
           ST_Point(h."longitude", h."latitude")
       ) <= 50000  -- Within 50 kilometers
WHERE
       p."region_number" = '6585' AND
       h."basin" = 'NA' AND
       h."wmo_wind" >= 35 AND
       h."name" IS NOT NULL AND h."name" != 'NOT_NAMED' AND
       p."port_latitude" IS NOT NULL AND
       p."port_longitude" IS NOT NULL AND
       h."latitude" IS NOT NULL AND
       h."longitude" IS NOT NULL
LIMIT 100
Results:
port_name,hurricane_name,iso_time
PORT EVERGLADES,CLEO,-168696000000000
BRUNSWICK,CLEO,-168552000000000
DARIEN,CLEO,-168552000000000
EDENTON,FLOYD,937483200000000
GRASSELLI,BRENDA,-297324000000000
MARINERS HARBOR SI,BRENDA,-297324000000000
STAPLETON SI,BRENDA,-297324000000000
PORT SOCONY,BRENDA,-297324000000000
GULFPORT SI,BRENDA,-297324000000000
MOREHEAD CITY,IRENE,1314446400000000
COLUMBIA,ALLISON,802483200000000
HAVRE DE GRACE,SANDY,1351576800000000
YONKERS,DORIA,52228800000000
PORT CHESTER,DORIA,52228800000000
WEEHAWKEN,BRENDA,-297324000000000
BAYWAY,BRENDA,-297324000000000
CAMDEN,IDA,1630540800000000
GLOUCESTER,IDA,1630540800000000
WILMINGTON,DIANA,463903200000000
BEAUFORT,BERYL,1338400800000000
GEORGETOWN,DORA,-167227200000000
CITY ISLAND,DORIA,52228800000000
STAMFORD,DORIA,52228800000000
BEAUFORT,GLADYS,-37821600000000
NEW BERN,GINGER,55123200000000
MOREHEAD CITY,GINGER,55123200000000
WRIGHTSVILLE,ERNESTO,1157082000000000
PATCHOGUE,DONNA,-293518800000000
MILBRIDGE,GERDA,-9759600000000
NORFOLK,DORIA,52185600000000
SALISBURY,FLOYD,937504800000000
WASHINGTON,ALBERTO,1150308000000000
BELHAVEN,DORIA,-72295200000000
PORT ROYAL,COLIN,1656720000000000
BARNEGAT,IRENE,1314524100000000
GEORGETOWN,IAN,1664560800000000
WASHINGTON,FLOSSY,-418478400000000
SOUTHPORT,BERTHA,837194400000000
CHARLESTON,KYLE,1034355600000000
GEORGETOWN,KYLE,1034355600000000
CITY ISLAND,FLOYD,937526400000000
BAYONNE,IRENE,1314532800000000
BROOKLYN,IRENE,1314532800000000
CANAVERAL HARBOR,MATTHEW,1475841600000000
PORT ROYAL,COLIN,1656718200000000
WILMINGTON,BONNIE,904190400000000
GEORGETOWN,MATTHEW,1475949600000000
STAPLETON SI,FLOYD,937526400000000
GREENWICH,FLOYD,937526400000000
FORT PIERCE,BOB,491011200000000
PERTH AMBOY,IRENE,1314532800000000
FERNANDINA BEACH,TAMMY,1128556800000000
PORT READING,IRENE,1314532800000000
MYSTIC,HENRI,1629645600000000
NEW BERN,DORIA,52164000000000
HYANNIS PORT,EDNA,-482992200000000
MIAMI,CLEO,-168710400000000
PORT RICHMOND SI,DIANE,-453492000000000
ELIZABETHPORT,DIANE,-453492000000000
MARBLEHEAD,DONNA,-293500800000000
GLOUCESTER,DONNA,-293500800000000
ATLANTIC CITY,SANDY,1351555200000000
BARNEGAT,SANDY,1351555200000000
HOBOKEN,DIANE,-453492000000000
TRENTON,DIANE,-453492000000000
SOUTH AMBOY,DIANE,-453492000000000
ST AUGUSTINE,GLADYS,-37886400000000
NORFOLK,CINDY,-330674400000000
CUNDY HARBOR,ESTHER,-260798400000000
CRIEHAVEN,HEIDI,53719200000000
NORTH HAVEN,HEIDI,53719200000000
BRUNSWICK,CLEO,-168544800000000
COLUMBIA,DIANA,464032800000000
MONTAUK HARBOR,ELSA,1625842800000000
NORWICH,DONNA,-293515200000000
MONTAUK HARBOR,DONNA,-293515200000000
NEW LONDON,DONNA,-293515200000000
JACKSONVILLE,ABBY,-49514400000000
YORKTOWN,NESTOR,1571594400000000
WRIGHTSVILLE,HELENE,-355384800000000
FRENCHBORO,FLOYD,937591200000000
ROCKLAND,FLOYD,937591200000000
BELFAST,FLOYD,937591200000000
CASTINE,FLOYD,937591200000000
DAVISVILLE DEPOT,HENRI,1629648900000000
SAVANNAH,FLORENCE,-513151200000000
SOUTHPORT,BARRY,1180893600000000
FERNANDINA BEACH,TAMMY,1128553200000000
GEORGETOWN,COLIN,1656763200000000
PORT EVERGLADES,KING,-606074400000000
JACKSONVILLE,CLEO,-168588000000000
SWANSBORO,HERMINE,1472882400000000
MIAMI,KATRINA,1125014400000000
NEW BERN,HERMINE,1472882400000000
PORT ROYAL,HERMINE,1472839200000000
MATINICUS,FLOYD,937591200000000
FORT PIERCE,ERIN,807344100000000
BRUNSWICK,BRENDA,-297432000000000
WILMINGTON,ALLISON,802461600000000
GREENPORT,BARRY,1180980000000000

2025-01-26 17:37:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:37:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:37:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:37:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:37:42 - snowflake.connector.connection - INFO - closed
2025-01-26 17:37:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:37:42 - root - INFO - SQL:
-- Corrected Query 9
SELECT
       p."port_name",
       COUNT(DISTINCT h."sid") AS "hurricanes_affecting_port"
FROM
       NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX p
INNER JOIN
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES h
ON
       ST_Distance(
           ST_Point(p."port_longitude", p."port_latitude"),
           ST_Point(h."longitude", h."latitude")
       ) <= 50000  -- Within 50 kilometers
WHERE
       p."region_number" = '6585' AND
       h."basin" = 'NA' AND
       h."wmo_wind" >= 35 AND
       h."name" IS NOT NULL AND h."name" != 'NOT_NAMED' AND
       p."port_latitude" IS NOT NULL AND
       p."port_longitude" IS NOT NULL AND
       h."latitude" IS NOT NULL AND
       h."longitude" IS NOT NULL
GROUP BY
       p."port_name"
ORDER BY
       "hurricanes_affecting_port" DESC
LIMIT 100
Results:
port_name,hurricanes_affecting_port
BEAUFORT,30
MOREHEAD CITY,22
SOUTHPORT,16
WILMINGTON,14
SWANSBORO,14
FORT PIERCE,13
WRIGHTSVILLE,13
PORT ROYAL,13
COLUMBIA,13
GEORGETOWN,12
ELIZABETH CITY,12
NEW BERN,11
BAYBORO,11
CHARLESTON,11
PLYMOUTH,10
CANAVERAL HARBOR,9
SAVANNAH,9
BELHAVEN,8
PORTSMOUTH,8
JACKSONVILLE,8
HERTFORD,8
STONINGTON,7
BRUNSWICK,7
PATCHOGUE,7
DARIEN,7
BRISTOL,7
FERNANDINA BEACH,7
MAYPORT,7
MONTAUK HARBOR,7
WASHINGTON,7
ST AUGUSTINE,7
OCEAN CITY,7
ROCKPORT,6
SALISBURY,6
YORKTOWN,6
NORFOLK,6
MIAMI,5
PORT SOCONY,5
VINALHAVEN,5
NEWPORT NEWS,5
NEW BEDFORD,5
SAYREVILLE,5
PORT EVERGLADES,5
VINEYARD HAVEN,5
MYSTIC,5
GREENPORT,5
NOANK,5
SOUTH AMBOY,5
BARNEGAT,5
TIVERTON,5
EDENTON,5
PORT READING,5
SEWAREN,5
FALL RIVER,5
EDGARTOWN,5
MACHIAS,5
CITY ISLAND,5
JONESPORT,5
QUONSET POINT,5
LEONARDO,5
PALM BEACH,5
CHROME,5
NEW LONDON,5
MAURER,5
DAVISVILLE DEPOT,5
CARTERET,5
PERTH AMBOY,5
NORTH HAVEN,5
HYANNIS PORT,5
PORT JEFFERSON,5
NANTUCKET,5
MATINICUS,5
HYANNIS,5
THOMASTON,4
LUBEC,4
BAYWAY,4
EASTPORT,4
FRENCHBORO,4
STAPLETON SI,4
GRASSELLI,4
EDGEWATER,4
GULFPORT SI,4
TRENTON,4
PORT CLYDE,4
NEWPORT,4
FALMOUTH,4
BROOKLIN,4
SWANS ISLAND,4
MINTURN,4
WOODS HOLE,4
WEST POINT,4
PROVINCETOWN,4
JERSEY CITY,4
SCITUATE,4
QUINCY,4
MARINERS HARBOR SI,4
TOMPKINSVILLE SI,4
HOBOKEN,4
NEW YORK CITY,4
GLOUCESTER,4

2025-01-26 17:37:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:37:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:37:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:37:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:37:44 - snowflake.connector.connection - INFO - closed
2025-01-26 17:37:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:37:44 - root - INFO - SQL:
-- Corrected Query 10
SELECT
       "sid",
       "name",
       "latitude",
       "longitude",
       "wmo_wind",
       "nature"
FROM
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES
WHERE
       "nature" = 'TS' AND
       "basin" = 'NA' AND
       "name" IS NOT NULL AND "name" != 'NOT_NAMED' AND
       "latitude" IS NOT NULL AND
       "longitude" IS NOT NULL AND
       "wmo_wind" IS NOT NULL
LIMIT 100
Results:
sid,name,latitude,longitude,wmo_wind,nature
1950274N26272,HOW,26.2,-91.1,40,TS
1950274N26272,HOW,24.0,-97.2,35,TS
1950281N23270,ITEM,21.8,-92.7,50,TS
1950281N23270,ITEM,19.1,-95.7,90,TS
1951224N12316,CHARLIE,12.2,-46.2,30,TS
1951224N12316,CHARLIE,15.6,-64.6,65,TS
1952231N15341,ABLE,14.6,-19.0,25,TS
1952231N15341,ABLE,21.7,-63.8,55,TS
1952231N15341,ABLE,25.9,-71.9,50,TS
1952269N13311,DOG,16.6,-54.0,60,TS
1952269N13311,DOG,21.9,-59.4,30,TS
1953146N14278,ALICE,14.4,-85.0,25,TS
1953240N14340,CAROL,14.0,-41.8,50,TS
1953240N14340,CAROL,43.4,-66.8,75,TS
1953251N18295,DOLLY,20.2,-69.0,45,TS
1954248N20295,EDNA,29.6,-76.3,110,TS
1954278N12302,HAZEL,15.3,-75.6,105,TS
1954278N12302,HAZEL,27.0,-75.7,110,TS
1955215N15320,CONNIE,42.9,-81.3,40,TS
1955219N16319,DIANE,30.0,-73.4,75,TS
1955234N11318,EDITH,13.5,-46.5,25,TS
1955234N11318,EDITH,14.9,-49.9,30,TS
1955234N11318,EDITH,15.8,-52.1,45,TS
1955247N20267,GLADYS,22.6,-96.5,50,TS
1955265N13307,JANET,18.4909,-88.2103,150,TS
1955288N13281,KATIE,29.5,-65.4,45,TS
1956222N13313,BETSY,25.7,-76.0,105,TS
1956222N13313,BETSY,41.7,-62.1,60,TS
1956254N20269,DORA,21.7,-95.5,45,TS
1957245N13339,CARRIE,13.4,-25.0,30,TS
1957245N13339,CARRIE,19.9,-51.4,70,TS
1958221N17340,BECKY,20.4,-60.4,40,TS
1958221N17340,BECKY,24.0,-69.8,40,TS
1958223N12340,CLEO,15.9,-49.0,110,TS
1958257N17293,GERDA,28.4,-97.5,30,TS
1958264N17308,HELENE,21.1,-62.4,25,TS
1958264N17308,HELENE,30.2,-76.2,95,TS
1958267N18309,ILSA,20.9,-61.3,70,TS
1959148N23274,ARLENE,31.5,-90.9,25,TS
1959271N27310,HANNAH,30.5,-68.1,100,TS
1959271N27310,HANNAH,34.1,-68.0,100,TS
1960210N28275,BRENDA,27.6,-85.3,35,TS
1960261N21296,FLORENCE,27.3,-80.3,50,TS
1961245N13318,BETSY,23.2,-50.6,85,TS
1961245N13318,BETSY,36.6,-58.7,75,TS
1961247N13283,CARLA,24.1,-90.3,105,TS
1961299N11281,HATTIE,10.5,-79.0,25,TS
1961306N23301,JENNY,22.5,-59.0,30,TS
1962272N15311,DAISY,16.8,-60.1,35,TS
1962272N15311,DAISY,25.2,-69.3,70,TS
1963213N11321,ARLENE,20.7,-63.2,25,TS
1963232N11313,BEULAH,16.5,-54.6,45,TS
1963232N11313,BEULAH,24.8,-60.0,90,TS
1963232N11313,BEULAH,41.6,-51.0,70,TS
1963262N14322,DEBRA,28.0,-47.7,50,TS
1963267N11309,EDITH,17.7,-67.9,65,TS
1963272N09314,FLORA,38.1,-56.0,90,TS
1963291N26288,GINNY,32.8,-73.5,60,TS
1963291N26288,GINNY,28.8,-78.2,65,TS
1964234N13316,CLEO,36.3,-76.4,35,TS
1964242N14343,DORA,14.3,-51.3,60,TS
1964248N18324,ETHEL,18.4,-38.4,35,TS
1964249N15342,FLORENCE,29.5,-27.7,40,TS
1964257N15316,GLADYS,23.7,-62.0,75,TS
1964283N15277,ISBELL,19.4,-85.5,30,TS
1965239N11310,BETSY,18.2,-63.0,35,TS
1965239N11310,BETSY,28.9,-75.3,95,TS
1965259N13340,CAROL,13.5,-34.6,40,TS
1965259N13340,CAROL,28.8,-41.4,80,TS
1965259N13340,CAROL,33.0,-41.0,60,TS
1965259N13340,CAROL,32.8,-41.8,60,TS
1966156N16275,ALMA,17.3,-84.6,35,TS
1966204N10325,ELLA,11.5,-40.7,25,TS
1966204N10325,ELLA,22.5,-65.2,35,TS
1966233N13340,FAITH,29.4,-73.5,85,TS
1966245N14312,GRETA,14.3,-49.6,25,TS
1966265N10325,INEZ,11.7,-39.4,25,TS
1966265N10325,INEZ,24.6,-81.4,85,TS
1966265N10325,INEZ,22.4,-98.5,60,TS
1966277N14338,KENDRA,15.3,-21.1,30,TS
1967241N16324,ARLENE,19.3,-41.6,40,TS
1967248N15341,CHLOE,15.4,-20.3,30,TS
1967248N15341,CHLOE,44.9,-28.0,80,TS
1967249N13303,BEULAH,16.7,-66.8,125,TS
1967249N13303,BEULAH,25.8,-99.9,30,TS
1967270N13313,EDITH,14.5,-56.0,45,TS
1967279N17342,GINGER,17.5,-18.1,40,TS
1968153N17275,ABBY,28.2,-80.5,55,TS
1968223N26280,DOLLY,29.5,-80.4,35,TS
1968223N26280,DOLLY,34.4,-73.5,55,TS
1968288N14280,GLADYS,27.8,-83.7,80,TS
1969206N09333,ANNA,28.5,-73.0,30,TS
1969237N29281,EVE,30.7,-73.7,45,TS
1969264N16313,INGA,20.0,-62.2,25,TS
1969281N20292,KARA,31.6,-76.0,55,TS
1970200N19277,BECKY,37.5,-86.7,20,TS
1970255N25283,FELICE,25.3,-78.3,25,TS
1970255N25283,FELICE,24.4,-82.0,30,TS
1970255N25283,FELICE,27.2,-88.4,50,TS
1971186N34285,ARLENE,33.5,-75.5,25,TS

2025-01-26 17:37:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:37:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:37:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:37:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 17:37:46 - snowflake.connector.connection - INFO - closed
2025-01-26 17:37:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:37:46 - root - INFO - SQL:
-- Corrected Query 11
SELECT
       p."port_name",
       h."name" AS "hurricane_name",
       h."iso_time"
FROM
       NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX p
INNER JOIN
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES h
ON
       ABS(p."port_latitude" - h."latitude") <= 0.5 AND
       ABS(p."port_longitude" - h."longitude") <= 0.5
WHERE
       p."region_number" = '6585' AND
       h."basin" = 'NA' AND
       h."wmo_wind" >= 35 AND
       h."name" IS NOT NULL AND h."name" != 'NOT_NAMED' AND
       p."port_latitude" IS NOT NULL AND
       p."port_longitude" IS NOT NULL AND
       h."latitude" IS NOT NULL AND
       h."longitude" IS NOT NULL
LIMIT 100
Results:
port_name,hurricane_name,iso_time
GRASSELLI,DIANE,-453492000000000
SEWAREN,DIANE,-453492000000000
BROOKLYN,DIANE,-453492000000000
TOMPKINSVILLE SI,DIANE,-453492000000000
PORT SOCONY,DIANE,-453492000000000
BAYWAY,DIANE,-453492000000000
JERSEY CITY,DIANE,-453492000000000
PERTH AMBOY,DIANE,-453492000000000
NEW YORK CITY,DIANE,-453492000000000
MAURER,DIANE,-453492000000000
ELIZABETHPORT,DIANE,-453492000000000
TRENTON,DIANE,-453492000000000
CHROME,DIANE,-453492000000000
GULFPORT SI,DIANE,-453492000000000
BRISTOL,DIANE,-453492000000000
BAYONNE,DIANE,-453492000000000
WEEHAWKEN,DIANE,-453492000000000
PORT RICHMOND SI,DIANE,-453492000000000
HOBOKEN,DIANE,-453492000000000
BURLINGTON,DIANE,-453492000000000
SAYREVILLE,DIANE,-453492000000000
CARTERET,DIANE,-453492000000000
LEONARDO,DIANE,-453492000000000
MARINERS HARBOR SI,DIANE,-453492000000000
STAPLETON SI,DIANE,-453492000000000
NEWARK,DIANE,-453492000000000
PORT READING,DIANE,-453492000000000
SOUTH AMBOY,DIANE,-453492000000000
SAVANNAH,GRACIE,-323676000000000
PORT ROYAL,GRACIE,-323676000000000
BEAUFORT,GRACIE,-323676000000000
SALEM,DONNA,-293500800000000
BOSTON,DONNA,-293500800000000
MARBLEHEAD,DONNA,-293500800000000
LYNN,DONNA,-293500800000000
NEWBURYPORT,DONNA,-293500800000000
BEVERLY,DONNA,-293500800000000
PORTSMOUTH,DONNA,-293500800000000
PORT EVERGLADES,ISBELL,-164505600000000
MAYPORT,GLADYS,-37886400000000
ST AUGUSTINE,GLADYS,-37886400000000
FORT PIERCE,FLORENCE,-292528800000000
EDENTON,CLEO,-168285600000000
HERTFORD,CLEO,-168285600000000
COLUMBIA,CLEO,-168285600000000
PLYMOUTH,CLEO,-168285600000000
ELIZABETH CITY,CLEO,-168285600000000
CANAVERAL HARBOR,ABBY,-49636800000000
DAVISVILLE DEPOT,BERTHA,837302400000000
PROVIDENCE,BERTHA,837302400000000
COLUMBIA,BONNIE,904262400000000
ELIZABETH CITY,BONNIE,904262400000000
GEORGETOWN,IAN,1664560800000000
BAYBORO,FLOSSY,-418478400000000
WASHINGTON,FLOSSY,-418478400000000
NEW BERN,FLOSSY,-418478400000000
PATCHOGUE,HENRI,496432800000000
WRIGHTSVILLE,DIANA,463906800000000
WILMINGTON,DIANA,463906800000000
SOUTHPORT,DIANA,463906800000000
SAVANNAH,CHRIS,588783600000000
PORT ROYAL,CHRIS,588783600000000
BEAUFORT,CHRIS,588783600000000
SOUTHPORT,BERTHA,837194400000000
ST AUGUSTINE,EDOUARD,1031186700000000
BRUNSWICK,BARRY,1180828800000000
DARIEN,BARRY,1180828800000000
ATLANTIC CITY,SANDY,1351555200000000
BARNEGAT,SANDY,1351555200000000
NORFOLK,CINDY,-330674400000000
NEWPORT NEWS,CINDY,-330674400000000
CAPE CHARLES,CINDY,-330674400000000
PORTSMOUTH,CINDY,-330674400000000
YORKTOWN,CINDY,-330674400000000
COREA,CINDY,-330588000000000
WINTER HARBOR,CINDY,-330588000000000
MACHIAS,CINDY,-330588000000000
MILBRIDGE,CINDY,-330588000000000
WRIGHTSVILLE,BONNIE,904190400000000
WILMINGTON,BONNIE,904190400000000
SOUTHPORT,BONNIE,904190400000000
PALM BEACH,CLEO,-168696000000000
PORT EVERGLADES,CLEO,-168696000000000
FERNANDINA BEACH,ISABEL,497815200000000
MAYPORT,ISABEL,497815200000000
ST AUGUSTINE,ISABEL,497815200000000
FORT PIERCE,ERIN,807344100000000
SOUTHPORT,FRAN,841968000000000
PALM BEACH,IRENE,940053600000000
FORT PIERCE,IRENE,940053600000000
WRIGHTSVILLE,CHARLEY,1092506400000000
WILMINGTON,CHARLEY,1092506400000000
BRUNSWICK,BRENDA,-297432000000000
DARIEN,BRENDA,-297432000000000
CANAVERAL HARBOR,ALMA,-231876000000000
WRIGHTSVILLE,ALLISON,802461600000000
WILMINGTON,ALLISON,802461600000000
FORT PIERCE,FRANCES,1094385600000000
BAR HARBOR,CINDY,-330588000000000
WYMAN,CINDY,-330588000000000

2025-01-26 17:37:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:37:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:37:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:37:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 73
2025-01-26 17:37:48 - snowflake.connector.connection - INFO - closed
2025-01-26 17:37:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:37:48 - root - INFO - SQL:
-- Corrected Query 12
SELECT
       "season" AS "year",
       COUNT(DISTINCT "sid") AS "hurricane_count"
FROM
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES
WHERE
       "basin" = 'NA' AND
       "wmo_wind" >= 35 AND
       "name" IS NOT NULL AND "name" != 'NOT_NAMED' AND
       "season" IS NOT NULL
GROUP BY
       "season"
ORDER BY
       "year"
LIMIT 100
Results:
year,hurricane_count
1950,13
1951,10
1952,6
1953,8
1954,9
1955,10
1956,7
1957,6
1958,10
1959,10
1960,6
1961,10
1962,5
1963,8
1964,9
1965,5
1966,12
1967,8
1968,7
1969,13
1970,7
1971,12
1972,7
1973,8
1974,7
1975,8
1976,8
1977,6
1978,11
1979,8
1980,11
1981,11
1982,5
1983,4
1984,12
1985,11
1986,6
1987,6
1988,11
1989,11
1990,14
1991,7
1992,6
1993,8
1994,7
1995,19
1996,13
1997,7
1998,14
1999,12
2000,14
2001,15
2002,12
2003,16
2004,15
2005,27
2006,9
2007,15
2008,16
2009,9
2010,19
2011,18
2012,19
2013,13
2014,8
2015,11
2016,15
2017,17
2018,15
2019,18
2020,30
2021,21
2022,14

2025-01-26 17:37:48 - root - INFO - itercount: 0
2025-01-26 17:37:48 - root - INFO - Database Name: NOAA_PORTS
Schema Name: GEO_INTERNATIONAL_PORTS
DDL describes table information.
,0
table_name,WORLD_PORT_INDEX
description,
DDL,"create or replace TABLE WORLD_PORT_INDEX (
	""index_number"" VARCHAR(16777216),
	""region_number"" VARCHAR(16777216),
	""port_name"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""port_latitude"" FLOAT,
	""port_longitude"" FLOAT,
	""publication_number"" VARCHAR(16777216),
	""chart_number"" VARCHAR(16777216),
	""harbor_size"" VARCHAR(16777216),
	""harbor_type"" VARCHAR(16777216),
	""shelter_afforded"" VARCHAR(16777216),
	""entry_tide"" BOOLEAN,
	""entry_swell"" BOOLEAN,
	""entry_ice"" BOOLEAN,
	""entry_other"" BOOLEAN,
	""overhead_limit"" BOOLEAN,
	""channel_depth"" VARCHAR(16777216),
	""anchorage_depth"" VARCHAR(16777216),
	""cargo_pier_depth"" VARCHAR(16777216),
	""cargo_oil_depth"" VARCHAR(16777216),
	""tide_range"" NUMBER(38,0),
	""max_vessel_size"" VARCHAR(16777216),
	""good_holding_ground"" BOOLEAN,
	""turning_area"" BOOLEAN,
	""port_of_entry"" BOOLEAN,
	""us_representative"" BOOLEAN,
	""eta_message_required"" BOOLEAN,
	""pilot_required"" BOOLEAN,
	""pilot_available"" BOOLEAN,
	""pilot_local_assist"" BOOLEAN,
	""pilot_advised"" BOOLEAN,
	""tug_salvage"" BOOLEAN,
	""tug_assist"" BOOLEAN,
	""quarantine_procedures_required"" BOOLEAN,
	""quarantine_sscc_cert_required"" BOOLEAN,
	""quarantine_other"" BOOLEAN,
	""comms_phone"" BOOLEAN,
	""comms_fax"" BOOLEAN,
	""comms_radio"" BOOLEAN,
	""comms_vhf"" BOOLEAN,
	""comms_air"" BOOLEAN,
	""comms_rail"" BOOLEAN,
	""cargo_wharf"" BOOLEAN,
	""cargo_anchor"" BOOLEAN,
	""cargo_med_moor"" BOOLEAN,
	""cargo_beach_moor"" BOOLEAN,
	""cargo_ice_moor"" BOOLEAN,
	""med_facility"" BOOLEAN,
	""garbage_dispose"" BOOLEAN,
	""degauss"" BOOLEAN,
	""dirty_ballast"" BOOLEAN,
	""crane_fixed"" BOOLEAN,
	""crane_mobile"" BOOLEAN,
	""crane_float"" BOOLEAN,
	""lift_100_tons"" BOOLEAN,
	""lift_50_100_tons"" BOOLEAN,
	""lift_25_49_tons"" BOOLEAN,
	""lift_0_24_tons"" BOOLEAN,
	""services_longshore"" BOOLEAN,
	""services_electrical"" BOOLEAN,
	""services_steam"" BOOLEAN,
	""services_nav_equip"" BOOLEAN,
	""services_electrical_repair"" BOOLEAN,
	""provisions"" BOOLEAN,
	""water"" BOOLEAN,
	""fuel_oil"" BOOLEAN,
	""diesel"" BOOLEAN,
	""deck_supplies"" BOOLEAN,
	""eng_supplies"" BOOLEAN,
	""repair_types"" VARCHAR(16777216),
	""dry_dock_types"" VARCHAR(16777216),
	""railway_types"" VARCHAR(16777216),
	""port_geom"" BINARY(8388608)
);"

Database Name: NOAA_PORTS
Schema Name: GEO_US_BOUNDARIES
DDL describes table information.
,0
table_name,ADJACENT_STATES
description,
DDL,"create or replace TABLE ADJACENT_STATES (
	""state"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""state_fips_code"" VARCHAR(16777216),
	""neighbors_state"" VARIANT,
	""neighbors_fips_code"" VARIANT
);"

,1
table_name,URBAN_AREAS
description,
DDL,"create or replace TABLE URBAN_AREAS (
	""geo_id"" VARCHAR(16777216),
	""urban_area_code"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""lsad_name"" VARCHAR(16777216),
	""area_lsad_code"" VARCHAR(16777216),
	""mtfcc_feature_class_code"" VARCHAR(16777216),
	""type"" VARCHAR(16777216),
	""functional_status"" VARCHAR(16777216),
	""area_land_meters"" FLOAT,
	""area_water_meters"" FLOAT,
	""internal_point_lon"" FLOAT,
	""internal_point_lat"" FLOAT,
	""internal_point_geom"" BINARY(8388608),
	""urban_area_geom"" BINARY(8388608)
);"

,2
table_name,NWS_FORECAST_REGIONS
description,
DDL,"create or replace TABLE NWS_FORECAST_REGIONS (
	""state"" VARCHAR(16777216),
	""cwa"" VARCHAR(16777216),
	""time_zone"" VARCHAR(16777216),
	""fe_area"" VARCHAR(16777216),
	""zone"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""state_zone"" VARCHAR(16777216),
	""lon"" FLOAT,
	""lat"" FLOAT,
	""shortname"" VARCHAR(16777216),
	""shape_geometry"" BINARY(8388608)
);"

,3
table_name,CBSA
description,
DDL,"create or replace TABLE CBSA (
	""geo_id"" VARCHAR(16777216),
	""csa_geo_id"" VARCHAR(16777216),
	""cbsa_fips_code"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""lsad_name"" VARCHAR(16777216),
	""lsad_code"" VARCHAR(16777216),
	""msa_indicator"" VARCHAR(16777216),
	""mtfcc_feature_class_code"" VARCHAR(16777216),
	""area_land_meters"" FLOAT,
	""area_water_meters"" FLOAT,
	""internal_point_latitude"" FLOAT,
	""internal_point_longitude"" FLOAT,
	""internal_point_geom"" BINARY(8388608),
	""cbsa_geom"" BINARY(8388608)
);"

,4
table_name,NATIONAL_OUTLINE
description,
DDL,"create or replace TABLE NATIONAL_OUTLINE (
	""us_outline_geom"" BINARY(8388608),
	""aff_geo_id"" VARCHAR(16777216),
	""geo_id"" VARCHAR(16777216),
	""name"" VARCHAR(16777216)
);"

,5
table_name,RAILWAYS
description,
DDL,"create or replace TABLE RAILWAYS (
	""geo_id"" NUMBER(38,0),
	""full_name"" VARCHAR(16777216),
	""mtfcc_feature_class_code"" VARCHAR(16777216),
	""railway_geom"" VARCHAR(16777216)
);"

,6
table_name,STATES
description,
DDL,"create or replace TABLE STATES (
	""geo_id"" VARCHAR(16777216),
	""region_code"" VARCHAR(16777216),
	""division_code"" VARCHAR(16777216),
	""state_fips_code"" VARCHAR(16777216),
	""state_gnis_code"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""lsad_code"" VARCHAR(16777216),
	""mtfcc_feature_class_code"" VARCHAR(16777216),
	""functional_status"" VARCHAR(16777216),
	""area_land_meters"" NUMBER(38,0),
	""area_water_meters"" NUMBER(38,0),
	""int_point_lat"" FLOAT,
	""int_point_lon"" FLOAT,
	""int_point_geom"" BINARY(8388608),
	""state_geom"" BINARY(8388608)
);"

,7
table_name,METROPOLITAN_DIVISIONS
description,
DDL,"create or replace TABLE METROPOLITAN_DIVISIONS (
	""geo_id"" VARCHAR(16777216),
	""csa_code"" VARCHAR(16777216),
	""cbsa_code"" VARCHAR(16777216),
	""metdiv_code"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""lsad_name"" VARCHAR(16777216),
	""lsad_code"" VARCHAR(16777216),
	""mtfcc_feature_class_code"" VARCHAR(16777216),
	""area_land_meters"" FLOAT,
	""area_water_meters"" FLOAT,
	""internal_point_latitude"" FLOAT,
	""internal_point_longitude"" FLOAT,
	""internal_point_geom"" BINARY(8388608),
	""metdiv_geom"" BINARY(8388608)
);"

,8
table_name,CNECTA
description,
DDL,"create or replace TABLE CNECTA (
	""geo_id"" VARCHAR(16777216),
	""cnecta_fips_code"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""name_lsad"" VARCHAR(16777216),
	""lsad"" VARCHAR(16777216),
	""mtfcc_feature_class_code"" VARCHAR(16777216),
	""area_land_meters"" NUMBER(38,0),
	""area_water_meters"" NUMBER(38,0),
	""int_point_lat"" FLOAT,
	""int_point_lon"" FLOAT,
	""cnecta_geom"" BINARY(8388608)
);"

,9
table_name,COASTLINE
description,
DDL,"create or replace TABLE COASTLINE (
	""name"" VARCHAR(16777216),
	""coastline_geom"" BINARY(8388608)
);"

,10
table_name,CONGRESS_DISTRICT_115
description,
DDL,"create or replace TABLE CONGRESS_DISTRICT_115 (
	""geo_id"" VARCHAR(16777216),
	""state_fips_code"" VARCHAR(16777216),
	""district_fips_code"" VARCHAR(16777216),
	""lsad_name"" VARCHAR(16777216),
	""lsad_code"" VARCHAR(16777216),
	""congress_session"" VARCHAR(16777216),
	""mtfcc_feature_class_code"" VARCHAR(16777216),
	""functional_status"" BOOLEAN,
	""area_land_meters"" NUMBER(38,0),
	""area_water_meters"" NUMBER(38,0),
	""int_point_lat"" FLOAT,
	""int_point_lon"" FLOAT,
	""int_point_geom"" BINARY(8388608),
	""district_geom"" BINARY(8388608)
);"

Some other tables have the similar structure: ['CONGRESS_DISTRICT_115', 'CONGRESS_DISTRICT_116']
,11
table_name,CSA
description,
DDL,"create or replace TABLE CSA (
	""geo_id"" VARCHAR(16777216),
	""csa_code"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""lsad_name"" VARCHAR(16777216),
	""msa_lsad_code"" VARCHAR(16777216),
	""mtfcc_feature_class_code"" VARCHAR(16777216),
	""area_land_meters"" FLOAT,
	""area_water_meters"" FLOAT,
	""internal_point_lon"" FLOAT,
	""internal_point_lat"" FLOAT,
	""internal_point_geom"" BINARY(8388608),
	""csa_geom"" BINARY(8388608)
);"

,12
table_name,ADJACENT_COUNTIES
description,
DDL,"create or replace TABLE ADJACENT_COUNTIES (
	""county"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""county_fips_code"" VARCHAR(16777216),
	""neighbors"" VARIANT,
	""neighbors_state"" VARIANT,
	""neighbors_fips_code"" VARIANT
);"

,13
table_name,COUNTIES
description,
DDL,"create or replace TABLE COUNTIES (
	""geo_id"" VARCHAR(16777216),
	""state_fips_code"" VARCHAR(16777216),
	""county_fips_code"" VARCHAR(16777216),
	""county_gnis_code"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""lsad_name"" VARCHAR(16777216),
	""lsad_code"" VARCHAR(16777216),
	""fips_class_code"" VARCHAR(16777216),
	""mtfcc_feature_class_code"" VARCHAR(16777216),
	""csa_fips_code"" VARCHAR(16777216),
	""cbsa_fips_code"" VARCHAR(16777216),
	""met_div_fips_code"" VARCHAR(16777216),
	""functional_status"" VARCHAR(16777216),
	""area_land_meters"" NUMBER(38,0),
	""area_water_meters"" NUMBER(38,0),
	""int_point_lat"" FLOAT,
	""int_point_lon"" FLOAT,
	""int_point_geom"" BINARY(8388608),
	""county_geom"" BINARY(8388608)
);"

,14
table_name,ZIP_CODES
description,
DDL,"create or replace TABLE ZIP_CODES (
	""zip_code"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""state_fips_code"" VARCHAR(16777216),
	""state_code"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""fips_class_code"" VARCHAR(16777216),
	""mtfcc_feature_class_code"" VARCHAR(16777216),
	""functional_status"" VARCHAR(16777216),
	""area_land_meters"" FLOAT,
	""area_water_meters"" FLOAT,
	""internal_point_lat"" FLOAT,
	""internal_point_lon"" FLOAT,
	""internal_point_geom"" BINARY(8388608),
	""zip_code_geom"" BINARY(8388608)
);"

Database Name: NOAA_PORTS
Schema Name: NOAA_HURRICANES
DDL describes table information.
,0
table_name,HURRICANES
description,
DDL,"create or replace TABLE HURRICANES (
	""sid"" VARCHAR(16777216),
	""season"" VARCHAR(16777216),
	""number"" NUMBER(38,0),
	""basin"" VARCHAR(16777216),
	""subbasin"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""iso_time"" NUMBER(38,0),
	""nature"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""wmo_wind"" NUMBER(38,0),
	""wmo_pressure"" NUMBER(38,0),
	""wmo_agency"" VARCHAR(16777216),
	""track_type"" VARCHAR(16777216),
	""dist2land"" NUMBER(38,0),
	""landfall"" NUMBER(38,0),
	""iflag"" VARCHAR(16777216),
	""usa_agency"" VARCHAR(16777216),
	""usa_latitude"" FLOAT,
	""usa_longitude"" FLOAT,
	""usa_record"" VARCHAR(16777216),
	""usa_status"" VARCHAR(16777216),
	""usa_wind"" NUMBER(38,0),
	""usa_pressure"" NUMBER(38,0),
	""usa_sshs"" NUMBER(38,0),
	""usa_r34_ne"" NUMBER(38,0),
	""usa_r34_se"" NUMBER(38,0),
	""usa_r34_sw"" NUMBER(38,0),
	""usa_r34_nw"" NUMBER(38,0),
	""usa_r50_ne"" NUMBER(38,0),
	""usa_r50_se"" NUMBER(38,0),
	""usa_r50_sw"" NUMBER(38,0),
	""usa_r50_nw"" NUMBER(38,0),
	""usa_r64_ne"" NUMBER(38,0),
	""usa_r64_se"" NUMBER(38,0),
	""usa_r64_sw"" NUMBER(38,0),
	""usa_r64_nw"" NUMBER(38,0),
	""usa_poci"" NUMBER(38,0),
	""usa_roci"" NUMBER(38,0),
	""usa_rmw"" NUMBER(38,0),
	""usa_eye"" VARCHAR(16777216),
	""tokyo_latitude"" FLOAT,
	""tokyo_longitude"" FLOAT,
	""tokyo_grade"" NUMBER(38,0),
	""tokyo_wind"" NUMBER(38,0),
	""tokyo_pressure"" NUMBER(38,0),
	""tokyo_r50_dir"" NUMBER(38,0),
	""tokyo_r50_longitude"" NUMBER(38,0),
	""tokyo_r50_short"" NUMBER(38,0),
	""tokyo_r30_dir"" NUMBER(38,0),
	""tokyo_r30_long"" NUMBER(38,0),
	""tokyo_r30_short"" NUMBER(38,0),
	""tokyo_land"" NUMBER(38,0),
	""cma_latitude"" FLOAT,
	""cma_longitude"" FLOAT,
	""cma_cat"" NUMBER(38,0),
	""cma_wind"" NUMBER(38,0),
	""cma_pressure"" NUMBER(38,0),
	""hko_latitude"" VARCHAR(16777216),
	""hko_longitude"" FLOAT,
	""hko_cat"" VARCHAR(16777216),
	""hko_wind"" NUMBER(38,0),
	""hko_pressure"" NUMBER(38,0),
	""newdelhi_latitude"" FLOAT,
	""newdelhi_longitude"" FLOAT,
	""newdelhi_grade"" VARCHAR(16777216),
	""newdelhi_wind"" NUMBER(38,0),
	""newdelhi_pressure"" NUMBER(38,0),
	""newdelhi_ci"" FLOAT,
	""newdelhi_dp"" NUMBER(38,0),
	""newdelhi_poci"" NUMBER(38,0),
	""reunion_latitude"" FLOAT,
	""reunion_longitude"" FLOAT,
	""reunion_type"" NUMBER(38,0),
	""reunion_wind"" NUMBER(38,0),
	""reunion_pressure"" NUMBER(38,0),
	""reunion_tnum"" FLOAT,
	""reunion_ci"" FLOAT,
	""reunion_rmw"" NUMBER(38,0),
	""reunion_r34_ne"" NUMBER(38,0),
	""reunion_r34_se"" NUMBER(38,0),
	""reunion_r34_sw"" NUMBER(38,0),
	""reunion_r34_nw"" NUMBER(38,0),
	""reunion_r50_ne"" NUMBER(38,0),
	""reunion_r50_se"" NUMBER(38,0),
	""reunion_r50_sw"" NUMBER(38,0),
	""reunion_r50_nw"" NUMBER(38,0),
	""reunion_r64_ne"" NUMBER(38,0),
	""reunion_r64_se"" NUMBER(38,0),
	""reunion_r64_sw"" NUMBER(38,0),
	""reunion_r64_nw"" NUMBER(38,0),
	""bom_latitude"" FLOAT,
	""bom_longitude"" FLOAT,
	""bom_type"" NUMBER(38,0),
	""bom_wind"" NUMBER(38,0),
	""bom_pressure"" NUMBER(38,0),
	""bom_tnum"" FLOAT,
	""bom_ci"" FLOAT,
	""bom_rmw"" NUMBER(38,0),
	""bom_r34_ne"" NUMBER(38,0),
	""bom_r34_se"" NUMBER(38,0),
	""bom_r34_sw"" NUMBER(38,0),
	""bom_r34_nw"" NUMBER(38,0),
	""bom_r50_ne"" NUMBER(38,0),
	""bom_r50_se"" NUMBER(38,0),
	""bom_r50_sw"" NUMBER(38,0),
	""bom_r50_nw"" NUMBER(38,0),
	""bom_r64_ne"" NUMBER(38,0),
	""bom_r64_se"" NUMBER(38,0),
	""bom_r64_sw"" NUMBER(38,0),
	""bom_r64_nw"" NUMBER(38,0),
	""bom_roci"" NUMBER(38,0),
	""bom_poci"" NUMBER(38,0),
	""bom_eye"" NUMBER(38,0),
	""bom_pos_method"" NUMBER(38,0),
	""bom_pressure_method"" NUMBER(38,0),
	""wellington_latitude"" FLOAT,
	""wellington_longitude"" FLOAT,
	""wellington_wind"" NUMBER(38,0),
	""wellington_pressure"" NUMBER(38,0),
	""nadi_latitude"" FLOAT,
	""nadi_longitude"" FLOAT,
	""nadi_cat"" NUMBER(38,0),
	""nadi_wind"" NUMBER(38,0),
	""nadi_pressure"" NUMBER(38,0),
	""ds824_latitude"" FLOAT,
	""ds824_longitude"" FLOAT,
	""ds824_stage"" VARCHAR(16777216),
	""ds824_wind"" NUMBER(38,0),
	""ds824_pressure"" NUMBER(38,0),
	""td9636_latitude"" FLOAT,
	""td9636_longitude"" FLOAT,
	""td9636_stage"" NUMBER(38,0),
	""td9636_wind"" NUMBER(38,0),
	""td9636_pressure"" NUMBER(38,0),
	""td9635_latitude"" FLOAT,
	""td9635_longitude"" FLOAT,
	""td9635_wind"" FLOAT,
	""td9635_pressure"" NUMBER(38,0),
	""td9635_roci"" NUMBER(38,0),
	""neumann_latitude"" FLOAT,
	""neumann_longitude"" FLOAT,
	""neumann_class"" VARCHAR(16777216),
	""neumann_wind"" NUMBER(38,0),
	""neumann_pressure"" NUMBER(38,0),
	""mlc_latitude"" FLOAT,
	""mlc_longitude"" FLOAT,
	""mlc_class"" VARCHAR(16777216),
	""mlc_wind"" NUMBER(38,0),
	""mlc_pressure"" NUMBER(38,0),
	""usa_atcf_id"" VARCHAR(16777216),
	""source_url"" VARCHAR(16777216),
	""etl_timestamp"" NUMBER(38,0)
);"

External knowledge that might be helpful: 
# BigQuery UDF Definitions

## `nautical_miles_conversion`

### Description
Converts nautical miles to statute miles by multiplying the input nautical miles by a fixed conversion factor. This function is commonly used in geographic analysis to convert marine-based distances into land-based measurements, which are more widely used in logistics and mapping.

### SQL Definition
```sql
CREATE FUNCTION `bigquery-public-data`.persistent_udfs.nautical_miles_conversion(input_nautical_miles FLOAT64)
AS (
  input_nautical_miles * 1.15078
);
```

### Example Usage
Convert the shipping distance between ports from nautical miles to statute miles for use in a logistics dashboard:
```sql
SELECT 
  port_name,
  `bigquery-public-data.persistent_udfs.nautical_miles_conversion`(distance_nautical_miles) AS distance_statute_miles
FROM 
  shipping_routes;
```

## `azimuth_to_geog_point`

### Description
Calculates a geographic point based on input latitude and longitude, an azimuth, and a distance. This function is particularly useful for spatial analyses that require generating new locations based on directional and distance parameters from a given point.

### Mathematical Operation
Employs trigonometric calculations to determine new geographic coordinates, accounting for Earth's curvature. The function adjusts direction (azimuth) and distance from degrees and nautical miles to radians and kilometers respectively.

### SQL Definition
```sql
CREATE FUNCTION `bigquery-public-data`.persistent_udfs.azimuth_to_geog_point(input_lat FLOAT64, input_lon FLOAT64, azimuth FLOAT64, distance FLOAT64)
AS (
  ST_GeogPoint(
    57.2958*(input_lon*(3.14159/180)+(atan2(
      sin(azimuth * (3.14159/180)) * sin(distance * 1.61/6378.1) * cos(input_lat* (3.14159/180)),
      cos(distance * 1.61/6378.1) - sin(input_lat * (3.14159/180)) * sin(57.2958*(asin(
        sin(input_lat * (3.14159/180)) * cos(distance * 1.61/6378.1) + cos(input_lat * (3.14159/180)) * sin(distance * 1.61/6378.1) * cos(azimuth*(3.14159/180)))
      )))
    )),
    57.2958*(asin(
      sin(input_lat * (3.14159/180)) * cos(distance * 1.61/6378.1) + cos(input_lat * (3.14159/180)) * sin(distance * 1.61/6378.1) * cos(azimuth*(3.14159/180))
    ))
  )
);
```

### Example Usage
Generate waypoints for a scenic route that requires specific directional travel from a starting location for a hiking app:
```sql
SELECT 
  trail_start_name,
  ARRAY_AGG(
    ST_AsText(
      `bigquery-public-data.persistent_udfs.azimuth_to_geog_point`(start_lat, start_lon, step_azimuth, step_distance)
    )
  ) AS waypoints
FROM 
  hiking_trails
CROSS JOIN 
  UNNEST(trail_steps) AS t
GROUP BY 
  trail_start_name;
```

The table structure information is ({database name: {schema name: {table name}}}): 
{'NOAA_PORTS': {'GEO_INTERNATIONAL_PORTS': ['WORLD_PORT_INDEX'], 'GEO_US_BOUNDARIES': ['ADJACENT_COUNTIES', 'ADJACENT_STATES', 'CBSA', 'CNECTA', 'COASTLINE', 'CONGRESS_DISTRICT_115', 'CONGRESS_DISTRICT_116', 'COUNTIES', 'CSA', 'METROPOLITAN_DIVISIONS', 'NATIONAL_OUTLINE', 'NWS_FORECAST_REGIONS', 'RAILWAYS', 'STATES', 'URBAN_AREAS', 'ZIP_CODES'], 'NOAA_HURRICANES': ['HURRICANES']}}
Begin Exploring Related Columns
**Considered Tables and Columns:**

1. **Table:** `WORLD_PORT_INDEX` (`NOAA_PORTS.GEO_INTERNATIONAL_PORTS`)

   - `"index_number"`: Potential usage - Unique identifier for each port.
   - `"region_number"`: Potential usage - To filter ports in region code `'6585'`.
   - `"port_name"`: Potential usage - To obtain the name of the port.
   - `"port_latitude"`, `"port_longitude"`: Potential usage - Geographical coordinates for spatial analysis.
   - `"port_geom"`: Potential usage - Geometry of the port for spatial queries.

2. **Table:** `HURRICANES` (`NOAA_PORTS.NOAA_HURRICANES`)

   - `"latitude"`, `"longitude"`: Potential usage - Geographical positions of hurricanes.
   - `"wmo_wind"`: Potential usage - To filter hurricanes with wind speeds of at least 35 knots.
   - `"basin"`: Potential usage - To filter hurricanes in the North Atlantic basin.
   - `"name"`: Potential usage - Name of the tropical storm.
   - `"sid"`: Potential usage - Unique storm identifier.
   - `"nature"`: Potential usage - Nature of the storm (e.g., tropical storm, hurricane).
   - `"iso_time"`: Potential usage - Timestamp of hurricane observations.

3. **Conditions That May Be Used:**

   - Ports located in region code `'6585'`.
   - Hurricanes in the North Atlantic basin (`"basin" = 'NA'`).
   - Hurricanes with wind speeds of at least 35 knots (`"wmo_wind" >= 35`).
   - Spatial intersection between ports and hurricane paths.
   - Ports intersecting with interstate roads (Note: Interstate roads data is not available in the provided tables).

---

**SQL Queries:**

1. **List all ports in region code `'6585'`:**

   ```sql
   SELECT
       "index_number",
       "port_name",
       "region_number",
       "port_latitude",
       "port_longitude"
   FROM
       NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX
   WHERE
       "region_number" = '6585'
   LIMIT 100;
   ```

2. **Retrieve distinct basin codes from the `HURRICANES` table:**

   ```sql
   SELECT DISTINCT
       "basin"
   FROM
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES
   LIMIT 100;
   ```

3. **List hurricanes in the North Atlantic basin with wind speeds of at least 35 knots:**

   ```sql
   SELECT
       "sid",
       "name",
       "latitude",
       "longitude",
       "wmo_wind",
       "basin"
   FROM
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES
   WHERE
       "basin" = 'NA' AND
       "wmo_wind" >= 35
   LIMIT 100;
   ```

4. **Find the number of hurricane occurrences per storm name in the North Atlantic basin:**

   ```sql
   SELECT
       "name",
       COUNT(*) AS "occurrence_count"
   FROM
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES
   WHERE
       "basin" = 'NA'
   GROUP BY
       "name"
   ORDER BY
       "occurrence_count" DESC
   LIMIT 100;
   ```

5. **Retrieve ports and their geographical coordinates in region `'6585'`:**

   ```sql
   SELECT
       "port_name",
       "port_latitude",
       "port_longitude"
   FROM
       NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX
   WHERE
       "region_number" = '6585'
   LIMIT 100;
   ```

6. **List all hurricane records with wind speeds of at least 35 knots:**

   ```sql
   SELECT
       "sid",
       "name",
       "latitude",
       "longitude",
       "wmo_wind",
       "basin"
   FROM
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES
   WHERE
       "wmo_wind" >= 35
   LIMIT 100;
   ```

7. **Identify ports that are within a specific latitude and longitude range (e.g., a specific region):**

   ```sql
   SELECT
       "port_name",
       "port_latitude",
       "port_longitude"
   FROM
       NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX
   WHERE
       "port_latitude" BETWEEN 20 AND 30 AND
       "port_longitude" BETWEEN -90 AND -80
   LIMIT 100;
   ```

8. **Find hurricane paths in the North Atlantic basin for named tropical storms:**

   ```sql
   SELECT
       "sid",
       "name",
       "latitude",
       "longitude",
       "wmo_wind"
   FROM
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES
   WHERE
       "basin" = 'NA' AND
       "name" IS NOT NULL
   LIMIT 100;
   ```

9. **Count the number of times each port has been near a hurricane with wind speeds of at least 35 knots:**

   ```sql
   SELECT
       p."port_name",
       COUNT(*) AS "hurricane_proximity_count"
   FROM
       NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX p
   INNER JOIN
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES h
   ON
       ST_Distance(
           ST_Point(p."port_longitude", p."port_latitude"),
           ST_Point(h."longitude", h."latitude")
       ) <= 50000  -- Within 50 kilometers
   WHERE
       p."region_number" = '6585' AND
       h."basin" = 'NA' AND
       h."wmo_wind" >= 35
   GROUP BY
       p."port_name"
   ORDER BY
       "hurricane_proximity_count" DESC
   LIMIT 100;
   ```

10. **Get hurricane names and their maximum wind speeds in the North Atlantic basin:**

    ```sql
    SELECT
        "name",
        MAX("wmo_wind") AS "max_wind_speed"
    FROM
        NOAA_PORTS.NOAA_HURRICANES.HURRICANES
    WHERE
        "basin" = 'NA'
    GROUP BY
        "name"
    ORDER BY
        "max_wind_speed" DESC
    LIMIT 100;
    ```

11. **List ports along with the hurricanes that have passed within 50 km:**

    ```sql
    SELECT DISTINCT
        p."port_name",
        h."name" AS "hurricane_name",
        h."iso_time"
    FROM
        NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX p
    INNER JOIN
        NOAA_PORTS.NOAA_HURRICANES.HURRICANES h
    ON
       ST_Distance(
           ST_Point(p."port_longitude", p."port_latitude"),
           ST_Point(h."longitude", h."latitude")
       ) <= 50000  -- Within 50 kilometers
    WHERE
        p."region_number" = '6585' AND
        h."basin" = 'NA' AND
        h."wmo_wind" >= 35
    LIMIT 100;
    ```

12. **Find the frequency of hurricanes affecting each port in region `'6585'`:**

    ```sql
    SELECT
        p."port_name",
        COUNT(DISTINCT h."sid") AS "hurricanes_affecting_port"
    FROM
        NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX p
    INNER JOIN
        NOAA_PORTS.NOAA_HURRICANES.HURRICANES h
    ON
       ST_Distance(
           ST_Point(p."port_longitude", p."port_latitude"),
           ST_Point(h."longitude", h."latitude")
       ) <= 50000  -- Within 50 kilometers
    WHERE
        p."region_number" = '6585' AND
        h."basin" = 'NA' AND
        h."wmo_wind" >= 35
    GROUP BY
        p."port_name"
    ORDER BY
        "hurricanes_affecting_port" DESC
    LIMIT 100;
    ```

13. **Retrieve hurricane records where the storm nature is a named tropical storm ('TS'):**

    ```sql
    SELECT
        "sid",
        "name",
        "latitude",
        "longitude",
        "wmo_wind",
        "nature"
    FROM
        NOAA_PORTS.NOAA_HURRICANES.HURRICANES
    WHERE
        "nature" = 'TS' AND
        "basin" = 'NA'
    LIMIT 100;
    ```

14. **List ports that potentially intersect with hurricane paths (approximated by proximity):**

    ```sql
    SELECT
        p."port_name",
        h."name" AS "hurricane_name",
        h."iso_time"
    FROM
        NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX p
    INNER JOIN
        NOAA_PORTS.NOAA_HURRICANES.HURRICANES h
    ON
        ABS(p."port_latitude" - h."latitude") <= 0.5 AND
        ABS(p."port_longitude" - h."longitude") <= 0.5
    WHERE
        p."region_number" = '6585' AND
        h."basin" = 'NA' AND
        h."wmo_wind" >= 35
    LIMIT 100;
    ```

15. **Count the number of hurricanes per year in the North Atlantic basin:**

    ```sql
    SELECT
        EXTRACT(YEAR FROM TO_TIMESTAMP_NTZ("iso_time")) AS "year",
        COUNT(DISTINCT "sid") AS "hurricane_count"
    FROM
        NOAA_PORTS.NOAA_HURRICANES.HURRICANES
    WHERE
        "basin" = 'NA' AND
        "wmo_wind" >= 35
    GROUP BY
        "year"
    ORDER BY
        "year"
    LIMIT 100;
    ```

**Note:** Since data on interstate roads is not available in the provided tables (`RAILWAYS` table contains railway data, not roads), the condition regarding ports intersecting with interstate roads cannot be directly addressed with the given datasets.

These queries explore the relevant columns and tables to understand the data necessary to address the task.Query:
SELECT
       "index_number",
       "port_name",
       "region_number",
       "port_latitude",
       "port_longitude"
   FROM
       NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX
   WHERE
       "region_number" = '6585'
   LIMIT 100;
Answer:
index_number,port_name,region_number,port_latitude,port_longitude
8570,MAYPORT,6585,30.4,-81.433333
8180,CAPE CHARLES,6585,37.266667,-76.016667
8245,PINEY POINT,6585,38.133333,-76.533333
8318,WARWICK,6585,37.45,-77.416667
8270,FREDERICKSBURG,6585,38.3,-77.45
8030,NEW CASTLE,6585,39.65,-75.566667
8040,DEEPWATER POINT,6585,39.7,-75.516667
8115,PAULSBORO,6585,39.85,-75.25
8150,BRISTOL,6585,40.1,-74.85
7990,LEONARDO,6585,40.433333,-74.066667
7900,GRASSELLI,6585,40.616667,-74.2
7780,JERSEY CITY,6585,40.716667,-74.033333
7730,RENSSELAER,6585,42.65,-73.75
7510,NORWICH,6585,41.516667,-72.083333
7450,MONTAUK HARBOR,6585,41.066667,-71.933333
7470,STONINGTON,6585,41.333333,-71.9
7440,DAVISVILLE DEPOT,6585,41.616667,-71.4
7430,QUONSET POINT,6585,41.583333,-71.4
7315,HYANNIS PORT,6585,41.633333,-70.3
7270,SCITUATE,6585,42.2,-70.716667
7200,ROCKPORT,6585,42.666667,-70.616667
7190,NEWBURYPORT,6585,42.816667,-70.866667
7140,SOUTH HARPSWELL,6585,43.733333,-70.016667
7020,PEMAQUID BEACH,6585,43.866667,-69.533333
7100,GARDINER,6585,44.233333,-69.766667
6970,MONHEGAN,6585,43.766667,-69.316667
6830,MATINICUS,6585,43.866667,-68.883333
6820,CRIEHAVEN,6585,43.833333,-68.883333
6870,SANDYPOINT,6585,44.516667,-68.816667
6800,BUCKS HARBOR,6585,44.333333,-68.733333
6750,MINTURN,6585,44.15,-68.45
6740,FRENCHBORO,6585,44.116667,-68.366667
6810,STONINGTON,6585,44.15,-68.666667
6690,SORRENTO,6585,44.466667,-68.183333
6670,COREA,6585,44.4,-67.966667
6660,MILBRIDGE,6585,44.533333,-67.883333
6650,WYMAN,6585,44.516667,-67.866667
8350,PLYMOUTH,6585,35.866667,-76.75
8340,EDENTON,6585,36.05,-76.616667
8330,HERTFORD,6585,36.183333,-76.466667
8370,COLUMBIA,6585,35.916667,-76.25
8580,JACKSONVILLE,6585,30.316667,-81.65
8530,SAVANNAH,6585,32.083333,-81.083333
8500,CHARLESTON,6585,32.783333,-79.916667
8300,NEWPORT NEWS,6585,36.966667,-76.433333
8290,PORTSMOUTH,6585,36.816667,-76.3
8280,NORFOLK,6585,36.85,-76.3
8190,SALISBURY,6585,38.366667,-75.6
8210,BALTIMORE,6585,39.266667,-76.583333
8050,WILMINGTON,6585,39.733333,-75.55
8025,SALEM NJ,6585,39.666667,-75.483333
8080,CHESTER,6585,39.85,-75.35
8110,PHILADELPHIA,6585,39.95,-75.133333
8130,CAMDEN,6585,39.95,-75.133333
7940,SEWAREN,6585,40.55,-74.25
7960,PERTH AMBOY,6585,40.5,-74.266667
7790,BAYONNE,6585,40.683333,-74.1
7860,MARINERS HARBOR SI,6585,40.633333,-74.166667
7630,BROOKLYN,6585,40.666667,-74.016667
7640,NEW YORK CITY,6585,40.7,-74.016667
7760,WEEHAWKEN,6585,40.766667,-74.016667
7690,CATSKILL,6585,42.216667,-73.85
7500,NEW LONDON,6585,41.35,-72.083333
7250,BOSTON,6585,42.35,-71.05
7150,PORTLAND,6585,43.666667,-70.25
7080,BATH,6585,43.916667,-69.816667
6720,SOUTHWEST HARBOR,6585,44.283333,-68.316667
8640,MIAMI,6585,25.783333,-80.183333
8630,PORT EVERGLADES,6585,26.1,-80.116667
8410,NEW BERN,6585,35.1,-77.05
8170,OCEAN CITY,6585,38.333333,-75.083333
7950,MAURER,6585,40.533333,-74.25
7850,PORT RICHMOND SI,6585,40.65,-74.133333
7830,STAPLETON SI,6585,40.633333,-74.066667
7840,TOMPKINSVILLE SI,6585,40.633333,-74.066667
7820,ELIZABETHPORT,6585,40.65,-74.183333
7770,HOBOKEN,6585,40.75,-74.016667
7810,NEWARK,6585,40.7,-74.15
7750,EDGEWATER,6585,40.816667,-73.983333
7660,NEWBURGH,6585,41.5,-74.0
7680,KINGSTON,6585,41.933333,-73.966667
7625,CITY ISLAND,6585,40.85,-73.783333
7610,GREENWICH,6585,41.016667,-73.616667
7600,STAMFORD,6585,41.033333,-73.55
7550,NEW HAVEN,6585,41.233333,-72.916667
7380,NEWPORT,6585,41.5,-71.333333
7260,QUINCY,6585,42.25,-70.966667
7040,BOOTHBAY HARBOR,6585,43.866667,-69.583333
7070,ROBINHOOD,6585,43.85,-69.733333
6990,THOMASTON,6585,44.066667,-69.183333
6770,BASS HARBOR,6585,44.233333,-68.35
8610,PALM BEACH,6585,26.766667,-80.05
8600,FORT PIERCE,6585,27.466667,-80.316667
8590,ST AUGUSTINE,6585,29.9,-81.316667
8560,FERNANDINA BEACH,6585,30.683333,-81.466667
8550,BRUNSWICK,6585,31.15,-81.5
8540,DARIEN,6585,31.366667,-81.433333
8520,BEAUFORT,6585,32.433333,-80.666667
8510,PORT ROYAL,6585,32.366667,-80.683333
8490,GEORGETOWN,6585,33.366667,-79.283333
Query:
SELECT DISTINCT
       "basin"
   FROM
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES
   LIMIT 100;
Answer:
basin
SI
NI
SA
NA
SP
EP
WP
Query:
SELECT
    p."port_name"
FROM
    NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX p
JOIN
    NOAA_PORTS.NOAA_HURRICANES.HURRICANES h
ON
    ST_Distance(
        ST_Point(p."port_longitude", p."port_latitude"),
        ST_Point(h."longitude", h."latitude")
    ) <= 50000  -- Within 50 kilometers
WHERE
    p."region_number" = '6585'
    AND h."basin" = 'NA'
    AND h."wmo_wind" >= 35
    AND h."name" != 'NOT_NAMED' AND h."name" IS NOT NULL
GROUP BY
    p."port_name"
ORDER BY
    COUNT(*) DESC
LIMIT 1;
Answer:
port_name
BEAUFORT
Query:
-- Corrected Query 1
SELECT
       "name",
       COUNT(*) AS "occurrence_count"
   FROM
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES
   WHERE
       "basin" = 'NA' AND
       "name" IS NOT NULL AND "name" != 'NOT_NAMED'
   GROUP BY
       "name"
   ORDER BY
       "occurrence_count" DESC
   LIMIT 100
Answer:
name,occurrence_count
ARLENE,662
FLORENCE,642
FRANCES,613
BONNIE,570
HELENE,556
DANIELLE,542
BERTHA,534
EMILY,516
EARL,513
DENNIS,497
GERT,467
CLAUDETTE,461
CINDY,458
JOSEPHINE,455
ALBERTO,454
EDOUARD,448
FELIX,406
LILI,398
CHRIS,387
GABRIELLE,383
DANNY,381
HARVEY,380
DOLLY,380
GORDON,372
OPHELIA,372
IRENE,371
ANA,369
ERIN,358
BETSY,355
KARL,352
BERYL,350
LESLIE,345
BEULAH,341
IVAN,339
ARTHUR,333
CHANTAL,333
JOSE,331
ISAAC,330
ISIDORE,328
LISA,328
LEE,324
EDITH,320
CHARLEY,314
MARIA,314
BARRY,311
GUSTAV,309
BRET,309
JEANNE,308
HUMBERTO,308
FRANKLIN,307
PHILIPPE,304
ABLE,300
CLEO,297
CHARLIE,296
CAROL,296
DEBBY,296
ELLA,296
HENRI,296
KATIA,293
ERNESTO,289
DEAN,287
GASTON,285
GLORIA,283
GLADYS,280
ANNA,277
DEBBIE,276
ALEX,275
NICOLE,275
DOG,273
JERRY,267
GINGER,262
KATE,261
GRACE,260
HERMINE,258
FLOYD,254
KAREN,254
NADINE,251
ALMA,251
FLORA,248
FRAN,247
CARRIE,246
KYLE,246
FRED,243
ERIKA,239
INGA,238
BECKY,236
IDA,235
BRENDA,235
DORIAN,234
HORTENSE,233
ALLISON,232
OTTO,232
FAY,231
HANNA,230
GRETA,228
ALICE,225
BAKER,224
CRISTOBAL,224
FIONA,223
LAURA,223
Query:
-- Corrected Query 2
SELECT
       "port_name",
       "port_latitude",
       "port_longitude"
   FROM
       NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX
   WHERE
       "region_number" = '6585' AND
       "port_name" IS NOT NULL
   LIMIT 100
Answer:
port_name,port_latitude,port_longitude
MAYPORT,30.4,-81.433333
CAPE CHARLES,37.266667,-76.016667
PINEY POINT,38.133333,-76.533333
WARWICK,37.45,-77.416667
FREDERICKSBURG,38.3,-77.45
NEW CASTLE,39.65,-75.566667
DEEPWATER POINT,39.7,-75.516667
PAULSBORO,39.85,-75.25
BRISTOL,40.1,-74.85
LEONARDO,40.433333,-74.066667
GRASSELLI,40.616667,-74.2
JERSEY CITY,40.716667,-74.033333
RENSSELAER,42.65,-73.75
NORWICH,41.516667,-72.083333
MONTAUK HARBOR,41.066667,-71.933333
STONINGTON,41.333333,-71.9
DAVISVILLE DEPOT,41.616667,-71.4
QUONSET POINT,41.583333,-71.4
HYANNIS PORT,41.633333,-70.3
SCITUATE,42.2,-70.716667
ROCKPORT,42.666667,-70.616667
NEWBURYPORT,42.816667,-70.866667
SOUTH HARPSWELL,43.733333,-70.016667
PEMAQUID BEACH,43.866667,-69.533333
GARDINER,44.233333,-69.766667
MONHEGAN,43.766667,-69.316667
MATINICUS,43.866667,-68.883333
CRIEHAVEN,43.833333,-68.883333
SANDYPOINT,44.516667,-68.816667
BUCKS HARBOR,44.333333,-68.733333
MINTURN,44.15,-68.45
FRENCHBORO,44.116667,-68.366667
STONINGTON,44.15,-68.666667
SORRENTO,44.466667,-68.183333
COREA,44.4,-67.966667
MILBRIDGE,44.533333,-67.883333
WYMAN,44.516667,-67.866667
PLYMOUTH,35.866667,-76.75
EDENTON,36.05,-76.616667
HERTFORD,36.183333,-76.466667
COLUMBIA,35.916667,-76.25
JACKSONVILLE,30.316667,-81.65
SAVANNAH,32.083333,-81.083333
CHARLESTON,32.783333,-79.916667
NEWPORT NEWS,36.966667,-76.433333
PORTSMOUTH,36.816667,-76.3
NORFOLK,36.85,-76.3
SALISBURY,38.366667,-75.6
BALTIMORE,39.266667,-76.583333
WILMINGTON,39.733333,-75.55
SALEM NJ,39.666667,-75.483333
CHESTER,39.85,-75.35
PHILADELPHIA,39.95,-75.133333
CAMDEN,39.95,-75.133333
SEWAREN,40.55,-74.25
PERTH AMBOY,40.5,-74.266667
BAYONNE,40.683333,-74.1
MARINERS HARBOR SI,40.633333,-74.166667
BROOKLYN,40.666667,-74.016667
NEW YORK CITY,40.7,-74.016667
WEEHAWKEN,40.766667,-74.016667
CATSKILL,42.216667,-73.85
NEW LONDON,41.35,-72.083333
BOSTON,42.35,-71.05
PORTLAND,43.666667,-70.25
BATH,43.916667,-69.816667
SOUTHWEST HARBOR,44.283333,-68.316667
MIAMI,25.783333,-80.183333
PORT EVERGLADES,26.1,-80.116667
NEW BERN,35.1,-77.05
OCEAN CITY,38.333333,-75.083333
MAURER,40.533333,-74.25
PORT RICHMOND SI,40.65,-74.133333
STAPLETON SI,40.633333,-74.066667
TOMPKINSVILLE SI,40.633333,-74.066667
ELIZABETHPORT,40.65,-74.183333
HOBOKEN,40.75,-74.016667
NEWARK,40.7,-74.15
EDGEWATER,40.816667,-73.983333
NEWBURGH,41.5,-74.0
KINGSTON,41.933333,-73.966667
CITY ISLAND,40.85,-73.783333
GREENWICH,41.016667,-73.616667
STAMFORD,41.033333,-73.55
NEW HAVEN,41.233333,-72.916667
NEWPORT,41.5,-71.333333
QUINCY,42.25,-70.966667
BOOTHBAY HARBOR,43.866667,-69.583333
ROBINHOOD,43.85,-69.733333
THOMASTON,44.066667,-69.183333
BASS HARBOR,44.233333,-68.35
PALM BEACH,26.766667,-80.05
FORT PIERCE,27.466667,-80.316667
ST AUGUSTINE,29.9,-81.316667
FERNANDINA BEACH,30.683333,-81.466667
BRUNSWICK,31.15,-81.5
DARIEN,31.366667,-81.433333
BEAUFORT,32.433333,-80.666667
PORT ROYAL,32.366667,-80.683333
GEORGETOWN,33.366667,-79.283333
Query:
SELECT
    "sid",
    "name",
    "latitude",
    "longitude",
    "wmo_wind",
    "basin"
FROM
    NOAA_PORTS.NOAA_HURRICANES.HURRICANES
WHERE
    "basin" = 'NA'
    AND "name" IS NOT NULL AND "name" != 'NOT_NAMED'
    AND "latitude" IS NOT NULL
    AND "longitude" IS NOT NULL
    AND "wmo_wind" IS NOT NULL
LIMIT 100;
Answer:
sid,name,latitude,longitude,wmo_wind,basin
1950274N26272,HOW,26.2,-91.1,40,NA
1950274N26272,HOW,24.0,-97.2,35,NA
1950281N23270,ITEM,21.8,-92.7,50,NA
1950281N23270,ITEM,19.1,-95.7,90,NA
1951224N12316,CHARLIE,12.2,-46.2,30,NA
1951224N12316,CHARLIE,15.6,-64.6,65,NA
1951246N13340,FOX,50.0,-29.8,75,NA
1951246N13340,FOX,57.5,-21.2,55,NA
1951272N20274,HOW,64.0,-19.5,65,NA
1952231N15341,ABLE,14.6,-19.0,25,NA
1952231N15341,ABLE,21.7,-63.8,55,NA
1952231N15341,ABLE,25.9,-71.9,50,NA
1952244N15306,BAKER,45.4,-52.3,85,NA
1952268N20291,CHARLIE,40.3,-55.5,75,NA
1952269N13311,DOG,16.6,-54.0,60,NA
1952269N13311,DOG,21.9,-59.4,30,NA
1953146N14278,ALICE,14.4,-85.0,25,NA
1953240N14340,CAROL,14.0,-41.8,50,NA
1953240N14340,CAROL,43.4,-66.8,75,NA
1953251N18295,DOLLY,20.2,-69.0,45,NA
1953251N18295,DOLLY,43.2,-31.9,40,NA
1953267N15282,FLORENCE,31.2,-84.7,40,NA
1954248N20295,EDNA,29.6,-76.3,110,NA
1954278N12302,HAZEL,15.3,-75.6,105,NA
1954278N12302,HAZEL,27.0,-75.7,110,NA
1955215N15320,CONNIE,42.9,-81.3,40,NA
1955219N16319,DIANE,30.0,-73.4,75,NA
1955234N11318,EDITH,13.5,-46.5,25,NA
1955234N11318,EDITH,14.9,-49.9,30,NA
1955234N11318,EDITH,15.8,-52.1,45,NA
1955234N11318,EDITH,37.6,-55.6,35,NA
1955247N20267,GLADYS,22.6,-96.5,50,NA
1955265N13307,JANET,18.4909,-88.2103,150,NA
1955288N13281,KATIE,29.5,-65.4,45,NA
1956222N13313,BETSY,25.7,-76.0,105,NA
1956222N13313,BETSY,41.7,-62.1,60,NA
1956222N13313,BETSY,42.0,-32.0,25,NA
1956251N25285,CARLA,41.8,-53.0,60,NA
1956254N20269,DORA,21.7,-95.5,45,NA
1956265N18274,FLOSSY,31.9,-83.2,35,NA
1956265N18274,FLOSSY,37.0,-56.0,35,NA
1956265N18274,FLOSSY,40.0,-56.2,45,NA
1957245N13339,CARRIE,13.4,-25.0,30,NA
1957245N13339,CARRIE,19.9,-51.4,70,NA
1958221N17340,BECKY,20.4,-60.4,40,NA
1958221N17340,BECKY,24.0,-69.8,40,NA
1958223N12340,CLEO,15.9,-49.0,110,NA
1958257N17293,GERDA,28.4,-97.5,30,NA
1958264N17308,HELENE,21.1,-62.4,25,NA
1958264N17308,HELENE,30.2,-76.2,95,NA
1958267N18309,ILSA,20.9,-61.3,70,NA
1959148N23274,ARLENE,31.5,-90.9,25,NA
1959264N20292,GRACIE,43.0,-68.0,25,NA
1959271N27310,HANNAH,30.5,-68.1,100,NA
1959271N27310,HANNAH,34.1,-68.0,100,NA
1960210N28275,BRENDA,27.6,-85.3,35,NA
1960210N28275,BRENDA,46.0,-69.3,35,NA
1960210N28275,BRENDA,56.2,-62.0,20,NA
1960261N21296,FLORENCE,27.3,-80.3,50,NA
1961245N13318,BETSY,23.2,-50.6,85,NA
1961245N13318,BETSY,36.6,-58.7,75,NA
1961245N13318,BETSY,56.5,-21.0,70,NA
1961245N13318,BETSY,61.0,-24.5,60,NA
1961247N13283,CARLA,24.1,-90.3,105,NA
1961290N20282,GERDA,42.4,-64.5,60,NA
1961299N11281,HATTIE,10.5,-79.0,25,NA
1961306N23301,JENNY,22.5,-59.0,30,NA
1962272N15311,DAISY,16.8,-60.1,35,NA
1962272N15311,DAISY,25.2,-69.3,70,NA
1962272N15311,DAISY,42.7,-66.9,80,NA
1963213N11321,ARLENE,20.7,-63.2,25,NA
1963213N11321,ARLENE,22.8,-66.2,25,NA
1963232N11313,BEULAH,16.5,-54.6,45,NA
1963232N11313,BEULAH,24.8,-60.0,90,NA
1963232N11313,BEULAH,41.6,-51.0,70,NA
1963262N14322,DEBRA,28.0,-47.7,50,NA
1963267N11309,EDITH,17.7,-67.9,65,NA
1963272N09314,FLORA,38.1,-56.0,90,NA
1963272N09314,FLORA,53.0,-43.0,70,NA
1963272N09314,FLORA,64.0,-32.0,45,NA
1963291N26288,GINNY,32.8,-73.5,60,NA
1963291N26288,GINNY,28.8,-78.2,65,NA
1964234N13316,CLEO,36.3,-76.4,35,NA
1964242N14343,DORA,14.3,-51.3,60,NA
1964248N18324,ETHEL,18.4,-38.4,35,NA
1964248N18324,ETHEL,41.5,-26.5,35,NA
1964249N15342,FLORENCE,29.5,-27.7,40,NA
1964257N15316,GLADYS,23.7,-62.0,75,NA
1964257N15316,GLADYS,47.5,-54.9,60,NA
1964283N15277,ISBELL,19.4,-85.5,30,NA
1965239N11310,BETSY,18.2,-63.0,35,NA
1965239N11310,BETSY,28.9,-75.3,95,NA
1965259N13340,CAROL,13.5,-34.6,40,NA
1965259N13340,CAROL,28.8,-41.4,80,NA
1965259N13340,CAROL,33.0,-41.0,60,NA
1965259N13340,CAROL,32.8,-41.8,60,NA
1965259N13340,CAROL,39.5,-17.8,55,NA
1966156N16275,ALMA,17.3,-84.6,35,NA
1966204N10325,ELLA,11.5,-40.7,25,NA
1950224N17305,ABLE,25.2,-66.8,70,NA
Query:
-- Corrected Query 4
SELECT
       "port_name",
       "port_latitude",
       "port_longitude"
FROM
       NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX
WHERE
       "port_latitude" BETWEEN 20 AND 30 AND
       "port_longitude" BETWEEN -90 AND -80 AND
       "port_name" IS NOT NULL AND
       "port_latitude" IS NOT NULL AND
       "port_longitude" IS NOT NULL
LIMIT 100
Answer:
port_name,port_latitude,port_longitude
SAN MIGUEL DE COZUMEL,20.5,-86.966667
TAMPA,27.916667,-82.45
BAHAI DE LA HABANA,23.133333,-82.366667
MIAMI,25.783333,-80.183333
PORT EVERGLADES,26.1,-80.116667
PROGRESO,21.283333,-89.666667
GRAND ISLE,29.233333,-90.0
PORT SULPHUR,29.483333,-89.683333
APALACHICOLA,29.716667,-84.983333
ST PETERSBURG,27.766667,-82.616667
PORT MANATEE,27.633333,-82.566667
BOCA GRANDE,26.7,-82.333333
KEY WEST,24.55,-81.816667
PALM BEACH,26.766667,-80.05
FORT PIERCE,27.466667,-80.316667
ST AUGUSTINE,29.9,-81.316667
ISABELA DE SAGUA,22.95,-80.0
CARDENAS,23.05,-81.2
MATANZAS,23.05,-81.55
CIENFUEGOS,22.15,-80.45
CARRABELLE,29.85,-84.666667
TARPON SPRINGS,28.15,-82.766667
PORT ST JOE,29.816667,-85.316667
CANAVERAL HARBOR,28.7,-80.616667
MARIEL,22.983333,-82.75
CABANAS,23.0,-82.966667
NUEVA GERONA,21.916667,-82.8
Query:
-- Corrected Query 5
SELECT
       "sid",
       "name",
       "latitude",
       "longitude",
       "wmo_wind"
FROM
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES
WHERE
       "basin" = 'NA' AND
       "name" IS NOT NULL AND "name" != 'NOT_NAMED' AND
       "latitude" IS NOT NULL AND
       "longitude" IS NOT NULL AND
       "wmo_wind" IS NOT NULL
LIMIT 100
Answer:
sid,name,latitude,longitude,wmo_wind
1950274N26272,HOW,26.2,-91.1,40
1950274N26272,HOW,24.0,-97.2,35
1950281N23270,ITEM,21.8,-92.7,50
1950281N23270,ITEM,19.1,-95.7,90
1951224N12316,CHARLIE,12.2,-46.2,30
1951224N12316,CHARLIE,15.6,-64.6,65
1951246N13340,FOX,50.0,-29.8,75
1951246N13340,FOX,57.5,-21.2,55
1951272N20274,HOW,64.0,-19.5,65
1952231N15341,ABLE,14.6,-19.0,25
1952231N15341,ABLE,21.7,-63.8,55
1952231N15341,ABLE,25.9,-71.9,50
1952244N15306,BAKER,45.4,-52.3,85
1952268N20291,CHARLIE,40.3,-55.5,75
1952269N13311,DOG,16.6,-54.0,60
1952269N13311,DOG,21.9,-59.4,30
1953146N14278,ALICE,14.4,-85.0,25
1953240N14340,CAROL,14.0,-41.8,50
1953240N14340,CAROL,43.4,-66.8,75
1953251N18295,DOLLY,20.2,-69.0,45
1953251N18295,DOLLY,43.2,-31.9,40
1953267N15282,FLORENCE,31.2,-84.7,40
1954248N20295,EDNA,29.6,-76.3,110
1954278N12302,HAZEL,15.3,-75.6,105
1954278N12302,HAZEL,27.0,-75.7,110
1955215N15320,CONNIE,42.9,-81.3,40
1955219N16319,DIANE,30.0,-73.4,75
1955234N11318,EDITH,13.5,-46.5,25
1955234N11318,EDITH,14.9,-49.9,30
1955234N11318,EDITH,15.8,-52.1,45
1955234N11318,EDITH,37.6,-55.6,35
1955247N20267,GLADYS,22.6,-96.5,50
1955265N13307,JANET,18.4909,-88.2103,150
1955288N13281,KATIE,29.5,-65.4,45
1956222N13313,BETSY,25.7,-76.0,105
1956222N13313,BETSY,41.7,-62.1,60
1956222N13313,BETSY,42.0,-32.0,25
1956251N25285,CARLA,41.8,-53.0,60
1956254N20269,DORA,21.7,-95.5,45
1956265N18274,FLOSSY,31.9,-83.2,35
1956265N18274,FLOSSY,37.0,-56.0,35
1956265N18274,FLOSSY,40.0,-56.2,45
1957245N13339,CARRIE,13.4,-25.0,30
1957245N13339,CARRIE,19.9,-51.4,70
1958221N17340,BECKY,20.4,-60.4,40
1958221N17340,BECKY,24.0,-69.8,40
1958223N12340,CLEO,15.9,-49.0,110
1958257N17293,GERDA,28.4,-97.5,30
1958264N17308,HELENE,21.1,-62.4,25
1958264N17308,HELENE,30.2,-76.2,95
1958267N18309,ILSA,20.9,-61.3,70
1959148N23274,ARLENE,31.5,-90.9,25
1959264N20292,GRACIE,43.0,-68.0,25
1959271N27310,HANNAH,30.5,-68.1,100
1959271N27310,HANNAH,34.1,-68.0,100
1960210N28275,BRENDA,27.6,-85.3,35
1960210N28275,BRENDA,46.0,-69.3,35
1960210N28275,BRENDA,56.2,-62.0,20
1960261N21296,FLORENCE,27.3,-80.3,50
1961245N13318,BETSY,23.2,-50.6,85
1961245N13318,BETSY,36.6,-58.7,75
1961245N13318,BETSY,56.5,-21.0,70
1961245N13318,BETSY,61.0,-24.5,60
1961247N13283,CARLA,24.1,-90.3,105
1961290N20282,GERDA,42.4,-64.5,60
1961299N11281,HATTIE,10.5,-79.0,25
1961306N23301,JENNY,22.5,-59.0,30
1962272N15311,DAISY,16.8,-60.1,35
1962272N15311,DAISY,25.2,-69.3,70
1962272N15311,DAISY,42.7,-66.9,80
1963213N11321,ARLENE,20.7,-63.2,25
1963213N11321,ARLENE,22.8,-66.2,25
1963232N11313,BEULAH,16.5,-54.6,45
1963232N11313,BEULAH,24.8,-60.0,90
1963232N11313,BEULAH,41.6,-51.0,70
1963262N14322,DEBRA,28.0,-47.7,50
1963267N11309,EDITH,17.7,-67.9,65
1963272N09314,FLORA,38.1,-56.0,90
1963272N09314,FLORA,53.0,-43.0,70
1963272N09314,FLORA,64.0,-32.0,45
1963291N26288,GINNY,32.8,-73.5,60
1963291N26288,GINNY,28.8,-78.2,65
1964234N13316,CLEO,36.3,-76.4,35
1964242N14343,DORA,14.3,-51.3,60
1964248N18324,ETHEL,18.4,-38.4,35
1964248N18324,ETHEL,41.5,-26.5,35
1964249N15342,FLORENCE,29.5,-27.7,40
1964257N15316,GLADYS,23.7,-62.0,75
1964257N15316,GLADYS,47.5,-54.9,60
1964283N15277,ISBELL,19.4,-85.5,30
1965239N11310,BETSY,18.2,-63.0,35
1965239N11310,BETSY,28.9,-75.3,95
1965259N13340,CAROL,13.5,-34.6,40
1965259N13340,CAROL,28.8,-41.4,80
1965259N13340,CAROL,33.0,-41.0,60
1965259N13340,CAROL,32.8,-41.8,60
1965259N13340,CAROL,39.5,-17.8,55
1966156N16275,ALMA,17.3,-84.6,35
1966204N10325,ELLA,11.5,-40.7,25
1966204N10325,ELLA,22.5,-65.2,35
Query:
-- Corrected Query 6
SELECT
       p."port_name",
       COUNT(*) AS "hurricane_proximity_count"
FROM
       NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX p
INNER JOIN
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES h
ON
       ST_Distance(
           ST_Point(p."port_longitude", p."port_latitude"),
           ST_Point(h."longitude", h."latitude")
       ) <= 50000  -- Within 50 kilometers
WHERE
       p."region_number" = '6585' AND
       h."basin" = 'NA' AND
       h."wmo_wind" >= 35 AND
       h."name" IS NOT NULL AND h."name" != 'NOT_NAMED' AND
       p."port_latitude" IS NOT NULL AND
       p."port_longitude" IS NOT NULL AND
       h."latitude" IS NOT NULL AND
       h."longitude" IS NOT NULL
GROUP BY
       p."port_name"
ORDER BY
       "hurricane_proximity_count" DESC
LIMIT 100
Answer:
port_name,hurricane_proximity_count
BEAUFORT,41
MOREHEAD CITY,29
SOUTHPORT,24
WILMINGTON,22
WRIGHTSVILLE,21
FORT PIERCE,18
SWANSBORO,17
GEORGETOWN,16
PORT ROYAL,15
CHARLESTON,15
COLUMBIA,14
BAYBORO,14
NEW BERN,12
JACKSONVILLE,12
CANAVERAL HARBOR,12
MAYPORT,12
ELIZABETH CITY,12
STONINGTON,12
MONTAUK HARBOR,11
PLYMOUTH,11
EDGARTOWN,9
NOANK,9
BELHAVEN,9
FERNANDINA BEACH,9
MIAMI,9
ST AUGUSTINE,9
SAVANNAH,9
BRUNSWICK,9
BRISTOL,9
MYSTIC,8
NANTUCKET,8
DARIEN,8
VINEYARD HAVEN,8
HYANNIS,8
PORT EVERGLADES,8
HERTFORD,8
PORTSMOUTH,8
WASHINGTON,8
HYANNIS PORT,8
DAVISVILLE DEPOT,7
YORKTOWN,7
QUONSET POINT,7
NEW LONDON,7
OCEAN CITY,7
PATCHOGUE,7
WOODS HOLE,7
MAURER,6
GREENPORT,6
NEWPORT,6
CHROME,6
BARNEGAT,6
PORT READING,6
LEONARDO,6
SAYREVILLE,6
SALISBURY,6
ROCKPORT,6
CARTERET,6
FALMOUTH,6
SEWAREN,6
SOUTH AMBOY,6
FRIENDSHIP,6
PERTH AMBOY,6
PORT SOCONY,6
TIVERTON,6
NORFOLK,6
NEWPORT NEWS,5
STAPLETON SI,5
CITY ISLAND,5
TOMPKINSVILLE SI,5
BAYWAY,5
PROVINCETOWN,5
GRASSELLI,5
MACHIAS,5
JERSEY CITY,5
VINALHAVEN,5
EDENTON,5
NEW HARBOR,5
MARINERS HARBOR SI,5
NEW BEDFORD,5
PEMAQUID BEACH,5
PALM BEACH,5
NORWICH,5
PORT JEFFERSON,5
THOMASTON,5
PORT CLYDE,5
BROOKLYN,5
NEW YORK CITY,5
JONESPORT,5
MONHEGAN,5
NORTH HAVEN,5
GULFPORT SI,5
FALL RIVER,5
MATINICUS,5
WEST POINT,4
QUINCY,4
SCITUATE,4
SOUTH BRISTOL,4
EDGEWATER,4
GLOUCESTER,4
HOBOKEN,4
Query:
-- Corrected Query 7
SELECT
       "name",
       MAX("wmo_wind") AS "max_wind_speed"
FROM
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES
WHERE
       "basin" = 'NA' AND
       "name" IS NOT NULL AND "name" != 'NOT_NAMED' AND
       "wmo_wind" IS NOT NULL
GROUP BY
       "name"
ORDER BY
       "max_wind_speed" DESC
LIMIT 100
Answer:
name,max_wind_speed
ALLEN,165
GILBERT,160
DORIAN,160
WILMA,160
IRMA,155
RITA,155
MITCH,155
FELIX,150
CAMILLE,150
ANITA,150
DEAN,150
DAVID,150
MARIA,150
ANDREW,150
JANET,150
KATRINA,150
MATTHEW,145
IVAN,145
HATTIE,145
ISABEL,145
INEZ,140
BEULAH,140
CAROL,140
LORENZO,140
ESTHER,140
EMILY,140
MICHAEL,140
HUGO,140
EDITH,140
IAN,140
JOSE,135
SAM,135
JOAQUIN,135
FLOYD,135
IGOR,135
GEORGES,135
LENNY,135
IOTA,135
GUSTAV,135
HELENE,130
IDA,130
LUIS,130
OPAL,130
CLEO,130
CARMEN,130
DENNIS,130
LAURA,130
CHARLEY,130
FLORA,130
ETA,130
FLORENCE,130
EASY,130
GERT,130
BRET,125
EDOUARD,125
CARLA,125
GLORIA,125
GABRIELLE,125
PALOMA,125
GONZALO,125
JOAN:MIRIAM,125
IRIS,125
DONNA,125
FRANCES,125
DOG,125
KARL,125
FOX,125
FABIAN,125
EARL,125
IKE,125
LILI,125
FIONA,120
BETSY,120
CELIA,120
MICHELLE,120
KEITH,120
HILDA,120
NICOLE,120
OPHELIA,120
TEDDY,120
IONE,120
CARRIE,120
CONNIE,120
KATIA,120
HORTENSE,120
DELTA,120
CINDY,120
JULIA,120
ELLA,120
GLADYS,120
ISAAC,120
CLAUDETTE,115
DANIELLE,115
BILL,115
DEBBY,115
DIANA,115
DORA,115
FREDERIC,115
KING,115
HAZEL,115
Query:
-- Corrected Query 8
SELECT DISTINCT
       p."port_name",
       h."name" AS "hurricane_name",
       h."iso_time"
FROM
       NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX p
INNER JOIN
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES h
ON
       ST_Distance(
           ST_Point(p."port_longitude", p."port_latitude"),
           ST_Point(h."longitude", h."latitude")
       ) <= 50000  -- Within 50 kilometers
WHERE
       p."region_number" = '6585' AND
       h."basin" = 'NA' AND
       h."wmo_wind" >= 35 AND
       h."name" IS NOT NULL AND h."name" != 'NOT_NAMED' AND
       p."port_latitude" IS NOT NULL AND
       p."port_longitude" IS NOT NULL AND
       h."latitude" IS NOT NULL AND
       h."longitude" IS NOT NULL
LIMIT 100
Answer:
port_name,hurricane_name,iso_time
PORT EVERGLADES,CLEO,-168696000000000
BRUNSWICK,CLEO,-168552000000000
DARIEN,CLEO,-168552000000000
EDENTON,FLOYD,937483200000000
GRASSELLI,BRENDA,-297324000000000
MARINERS HARBOR SI,BRENDA,-297324000000000
STAPLETON SI,BRENDA,-297324000000000
PORT SOCONY,BRENDA,-297324000000000
GULFPORT SI,BRENDA,-297324000000000
MOREHEAD CITY,IRENE,1314446400000000
COLUMBIA,ALLISON,802483200000000
HAVRE DE GRACE,SANDY,1351576800000000
YONKERS,DORIA,52228800000000
PORT CHESTER,DORIA,52228800000000
WEEHAWKEN,BRENDA,-297324000000000
BAYWAY,BRENDA,-297324000000000
CAMDEN,IDA,1630540800000000
GLOUCESTER,IDA,1630540800000000
WILMINGTON,DIANA,463903200000000
BEAUFORT,BERYL,1338400800000000
GEORGETOWN,DORA,-167227200000000
CITY ISLAND,DORIA,52228800000000
STAMFORD,DORIA,52228800000000
BEAUFORT,GLADYS,-37821600000000
NEW BERN,GINGER,55123200000000
MOREHEAD CITY,GINGER,55123200000000
WRIGHTSVILLE,ERNESTO,1157082000000000
PATCHOGUE,DONNA,-293518800000000
MILBRIDGE,GERDA,-9759600000000
NORFOLK,DORIA,52185600000000
SALISBURY,FLOYD,937504800000000
WASHINGTON,ALBERTO,1150308000000000
BELHAVEN,DORIA,-72295200000000
PORT ROYAL,COLIN,1656720000000000
BARNEGAT,IRENE,1314524100000000
GEORGETOWN,IAN,1664560800000000
WASHINGTON,FLOSSY,-418478400000000
SOUTHPORT,BERTHA,837194400000000
CHARLESTON,KYLE,1034355600000000
GEORGETOWN,KYLE,1034355600000000
CITY ISLAND,FLOYD,937526400000000
BAYONNE,IRENE,1314532800000000
BROOKLYN,IRENE,1314532800000000
CANAVERAL HARBOR,MATTHEW,1475841600000000
PORT ROYAL,COLIN,1656718200000000
WILMINGTON,BONNIE,904190400000000
GEORGETOWN,MATTHEW,1475949600000000
STAPLETON SI,FLOYD,937526400000000
GREENWICH,FLOYD,937526400000000
FORT PIERCE,BOB,491011200000000
PERTH AMBOY,IRENE,1314532800000000
FERNANDINA BEACH,TAMMY,1128556800000000
PORT READING,IRENE,1314532800000000
MYSTIC,HENRI,1629645600000000
NEW BERN,DORIA,52164000000000
HYANNIS PORT,EDNA,-482992200000000
MIAMI,CLEO,-168710400000000
PORT RICHMOND SI,DIANE,-453492000000000
ELIZABETHPORT,DIANE,-453492000000000
MARBLEHEAD,DONNA,-293500800000000
GLOUCESTER,DONNA,-293500800000000
ATLANTIC CITY,SANDY,1351555200000000
BARNEGAT,SANDY,1351555200000000
HOBOKEN,DIANE,-453492000000000
TRENTON,DIANE,-453492000000000
SOUTH AMBOY,DIANE,-453492000000000
ST AUGUSTINE,GLADYS,-37886400000000
NORFOLK,CINDY,-330674400000000
CUNDY HARBOR,ESTHER,-260798400000000
CRIEHAVEN,HEIDI,53719200000000
NORTH HAVEN,HEIDI,53719200000000
BRUNSWICK,CLEO,-168544800000000
COLUMBIA,DIANA,464032800000000
MONTAUK HARBOR,ELSA,1625842800000000
NORWICH,DONNA,-293515200000000
MONTAUK HARBOR,DONNA,-293515200000000
NEW LONDON,DONNA,-293515200000000
JACKSONVILLE,ABBY,-49514400000000
YORKTOWN,NESTOR,1571594400000000
WRIGHTSVILLE,HELENE,-355384800000000
FRENCHBORO,FLOYD,937591200000000
ROCKLAND,FLOYD,937591200000000
BELFAST,FLOYD,937591200000000
CASTINE,FLOYD,937591200000000
DAVISVILLE DEPOT,HENRI,1629648900000000
SAVANNAH,FLORENCE,-513151200000000
SOUTHPORT,BARRY,1180893600000000
FERNANDINA BEACH,TAMMY,1128553200000000
GEORGETOWN,COLIN,1656763200000000
PORT EVERGLADES,KING,-606074400000000
JACKSONVILLE,CLEO,-168588000000000
SWANSBORO,HERMINE,1472882400000000
MIAMI,KATRINA,1125014400000000
NEW BERN,HERMINE,1472882400000000
PORT ROYAL,HERMINE,1472839200000000
MATINICUS,FLOYD,937591200000000
FORT PIERCE,ERIN,807344100000000
BRUNSWICK,BRENDA,-297432000000000
WILMINGTON,ALLISON,802461600000000
GREENPORT,BARRY,1180980000000000
Query:
-- Corrected Query 9
SELECT
       p."port_name",
       COUNT(DISTINCT h."sid") AS "hurricanes_affecting_port"
FROM
       NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX p
INNER JOIN
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES h
ON
       ST_Distance(
           ST_Point(p."port_longitude", p."port_latitude"),
           ST_Point(h."longitude", h."latitude")
       ) <= 50000  -- Within 50 kilometers
WHERE
       p."region_number" = '6585' AND
       h."basin" = 'NA' AND
       h."wmo_wind" >= 35 AND
       h."name" IS NOT NULL AND h."name" != 'NOT_NAMED' AND
       p."port_latitude" IS NOT NULL AND
       p."port_longitude" IS NOT NULL AND
       h."latitude" IS NOT NULL AND
       h."longitude" IS NOT NULL
GROUP BY
       p."port_name"
ORDER BY
       "hurricanes_affecting_port" DESC
LIMIT 100
Answer:
port_name,hurricanes_affecting_port
BEAUFORT,30
MOREHEAD CITY,22
SOUTHPORT,16
WILMINGTON,14
SWANSBORO,14
FORT PIERCE,13
WRIGHTSVILLE,13
PORT ROYAL,13
COLUMBIA,13
GEORGETOWN,12
ELIZABETH CITY,12
NEW BERN,11
BAYBORO,11
CHARLESTON,11
PLYMOUTH,10
CANAVERAL HARBOR,9
SAVANNAH,9
BELHAVEN,8
PORTSMOUTH,8
JACKSONVILLE,8
HERTFORD,8
STONINGTON,7
BRUNSWICK,7
PATCHOGUE,7
DARIEN,7
BRISTOL,7
FERNANDINA BEACH,7
MAYPORT,7
MONTAUK HARBOR,7
WASHINGTON,7
ST AUGUSTINE,7
OCEAN CITY,7
ROCKPORT,6
SALISBURY,6
YORKTOWN,6
NORFOLK,6
MIAMI,5
PORT SOCONY,5
VINALHAVEN,5
NEWPORT NEWS,5
NEW BEDFORD,5
SAYREVILLE,5
PORT EVERGLADES,5
VINEYARD HAVEN,5
MYSTIC,5
GREENPORT,5
NOANK,5
SOUTH AMBOY,5
BARNEGAT,5
TIVERTON,5
EDENTON,5
PORT READING,5
SEWAREN,5
FALL RIVER,5
EDGARTOWN,5
MACHIAS,5
CITY ISLAND,5
JONESPORT,5
QUONSET POINT,5
LEONARDO,5
PALM BEACH,5
CHROME,5
NEW LONDON,5
MAURER,5
DAVISVILLE DEPOT,5
CARTERET,5
PERTH AMBOY,5
NORTH HAVEN,5
HYANNIS PORT,5
PORT JEFFERSON,5
NANTUCKET,5
MATINICUS,5
HYANNIS,5
THOMASTON,4
LUBEC,4
BAYWAY,4
EASTPORT,4
FRENCHBORO,4
STAPLETON SI,4
GRASSELLI,4
EDGEWATER,4
GULFPORT SI,4
TRENTON,4
PORT CLYDE,4
NEWPORT,4
FALMOUTH,4
BROOKLIN,4
SWANS ISLAND,4
MINTURN,4
WOODS HOLE,4
WEST POINT,4
PROVINCETOWN,4
JERSEY CITY,4
SCITUATE,4
QUINCY,4
MARINERS HARBOR SI,4
TOMPKINSVILLE SI,4
HOBOKEN,4
NEW YORK CITY,4
GLOUCESTER,4
Query:
-- Corrected Query 10
SELECT
       "sid",
       "name",
       "latitude",
       "longitude",
       "wmo_wind",
       "nature"
FROM
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES
WHERE
       "nature" = 'TS' AND
       "basin" = 'NA' AND
       "name" IS NOT NULL AND "name" != 'NOT_NAMED' AND
       "latitude" IS NOT NULL AND
       "longitude" IS NOT NULL AND
       "wmo_wind" IS NOT NULL
LIMIT 100
Answer:
sid,name,latitude,longitude,wmo_wind,nature
1950274N26272,HOW,26.2,-91.1,40,TS
1950274N26272,HOW,24.0,-97.2,35,TS
1950281N23270,ITEM,21.8,-92.7,50,TS
1950281N23270,ITEM,19.1,-95.7,90,TS
1951224N12316,CHARLIE,12.2,-46.2,30,TS
1951224N12316,CHARLIE,15.6,-64.6,65,TS
1952231N15341,ABLE,14.6,-19.0,25,TS
1952231N15341,ABLE,21.7,-63.8,55,TS
1952231N15341,ABLE,25.9,-71.9,50,TS
1952269N13311,DOG,16.6,-54.0,60,TS
1952269N13311,DOG,21.9,-59.4,30,TS
1953146N14278,ALICE,14.4,-85.0,25,TS
1953240N14340,CAROL,14.0,-41.8,50,TS
1953240N14340,CAROL,43.4,-66.8,75,TS
1953251N18295,DOLLY,20.2,-69.0,45,TS
1954248N20295,EDNA,29.6,-76.3,110,TS
1954278N12302,HAZEL,15.3,-75.6,105,TS
1954278N12302,HAZEL,27.0,-75.7,110,TS
1955215N15320,CONNIE,42.9,-81.3,40,TS
1955219N16319,DIANE,30.0,-73.4,75,TS
1955234N11318,EDITH,13.5,-46.5,25,TS
1955234N11318,EDITH,14.9,-49.9,30,TS
1955234N11318,EDITH,15.8,-52.1,45,TS
1955247N20267,GLADYS,22.6,-96.5,50,TS
1955265N13307,JANET,18.4909,-88.2103,150,TS
1955288N13281,KATIE,29.5,-65.4,45,TS
1956222N13313,BETSY,25.7,-76.0,105,TS
1956222N13313,BETSY,41.7,-62.1,60,TS
1956254N20269,DORA,21.7,-95.5,45,TS
1957245N13339,CARRIE,13.4,-25.0,30,TS
1957245N13339,CARRIE,19.9,-51.4,70,TS
1958221N17340,BECKY,20.4,-60.4,40,TS
1958221N17340,BECKY,24.0,-69.8,40,TS
1958223N12340,CLEO,15.9,-49.0,110,TS
1958257N17293,GERDA,28.4,-97.5,30,TS
1958264N17308,HELENE,21.1,-62.4,25,TS
1958264N17308,HELENE,30.2,-76.2,95,TS
1958267N18309,ILSA,20.9,-61.3,70,TS
1959148N23274,ARLENE,31.5,-90.9,25,TS
1959271N27310,HANNAH,30.5,-68.1,100,TS
1959271N27310,HANNAH,34.1,-68.0,100,TS
1960210N28275,BRENDA,27.6,-85.3,35,TS
1960261N21296,FLORENCE,27.3,-80.3,50,TS
1961245N13318,BETSY,23.2,-50.6,85,TS
1961245N13318,BETSY,36.6,-58.7,75,TS
1961247N13283,CARLA,24.1,-90.3,105,TS
1961299N11281,HATTIE,10.5,-79.0,25,TS
1961306N23301,JENNY,22.5,-59.0,30,TS
1962272N15311,DAISY,16.8,-60.1,35,TS
1962272N15311,DAISY,25.2,-69.3,70,TS
1963213N11321,ARLENE,20.7,-63.2,25,TS
1963232N11313,BEULAH,16.5,-54.6,45,TS
1963232N11313,BEULAH,24.8,-60.0,90,TS
1963232N11313,BEULAH,41.6,-51.0,70,TS
1963262N14322,DEBRA,28.0,-47.7,50,TS
1963267N11309,EDITH,17.7,-67.9,65,TS
1963272N09314,FLORA,38.1,-56.0,90,TS
1963291N26288,GINNY,32.8,-73.5,60,TS
1963291N26288,GINNY,28.8,-78.2,65,TS
1964234N13316,CLEO,36.3,-76.4,35,TS
1964242N14343,DORA,14.3,-51.3,60,TS
1964248N18324,ETHEL,18.4,-38.4,35,TS
1964249N15342,FLORENCE,29.5,-27.7,40,TS
1964257N15316,GLADYS,23.7,-62.0,75,TS
1964283N15277,ISBELL,19.4,-85.5,30,TS
1965239N11310,BETSY,18.2,-63.0,35,TS
1965239N11310,BETSY,28.9,-75.3,95,TS
1965259N13340,CAROL,13.5,-34.6,40,TS
1965259N13340,CAROL,28.8,-41.4,80,TS
1965259N13340,CAROL,33.0,-41.0,60,TS
1965259N13340,CAROL,32.8,-41.8,60,TS
1966156N16275,ALMA,17.3,-84.6,35,TS
1966204N10325,ELLA,11.5,-40.7,25,TS
1966204N10325,ELLA,22.5,-65.2,35,TS
1966233N13340,FAITH,29.4,-73.5,85,TS
1966245N14312,GRETA,14.3,-49.6,25,TS
1966265N10325,INEZ,11.7,-39.4,25,TS
1966265N10325,INEZ,24.6,-81.4,85,TS
1966265N10325,INEZ,22.4,-98.5,60,TS
1966277N14338,KENDRA,15.3,-21.1,30,TS
1967241N16324,ARLENE,19.3,-41.6,40,TS
1967248N15341,CHLOE,15.4,-20.3,30,TS
1967248N15341,CHLOE,44.9,-28.0,80,TS
1967249N13303,BEULAH,16.7,-66.8,125,TS
1967249N13303,BEULAH,25.8,-99.9,30,TS
1967270N13313,EDITH,14.5,-56.0,45,TS
1967279N17342,GINGER,17.5,-18.1,40,TS
1968153N17275,ABBY,28.2,-80.5,55,TS
1968223N26280,DOLLY,29.5,-80.4,35,TS
1968223N26280,DOLLY,34.4,-73.5,55,TS
1968288N14280,GLADYS,27.8,-83.7,80,TS
1969206N09333,ANNA,28.5,-73.0,30,TS
1969237N29281,EVE,30.7,-73.7,45,TS
1969264N16313,INGA,20.0,-62.2,25,TS
1969281N20292,KARA,31.6,-76.0,55,TS
1970200N19277,BECKY,37.5,-86.7,20,TS
1970255N25283,FELICE,25.3,-78.3,25,TS
1970255N25283,FELICE,24.4,-82.0,30,TS
1970255N25283,FELICE,27.2,-88.4,50,TS
1971186N34285,ARLENE,33.5,-75.5,25,TS
Query:
-- Corrected Query 11
SELECT
       p."port_name",
       h."name" AS "hurricane_name",
       h."iso_time"
FROM
       NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX p
INNER JOIN
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES h
ON
       ABS(p."port_latitude" - h."latitude") <= 0.5 AND
       ABS(p."port_longitude" - h."longitude") <= 0.5
WHERE
       p."region_number" = '6585' AND
       h."basin" = 'NA' AND
       h."wmo_wind" >= 35 AND
       h."name" IS NOT NULL AND h."name" != 'NOT_NAMED' AND
       p."port_latitude" IS NOT NULL AND
       p."port_longitude" IS NOT NULL AND
       h."latitude" IS NOT NULL AND
       h."longitude" IS NOT NULL
LIMIT 100
Answer:
port_name,hurricane_name,iso_time
GRASSELLI,DIANE,-453492000000000
SEWAREN,DIANE,-453492000000000
BROOKLYN,DIANE,-453492000000000
TOMPKINSVILLE SI,DIANE,-453492000000000
PORT SOCONY,DIANE,-453492000000000
BAYWAY,DIANE,-453492000000000
JERSEY CITY,DIANE,-453492000000000
PERTH AMBOY,DIANE,-453492000000000
NEW YORK CITY,DIANE,-453492000000000
MAURER,DIANE,-453492000000000
ELIZABETHPORT,DIANE,-453492000000000
TRENTON,DIANE,-453492000000000
CHROME,DIANE,-453492000000000
GULFPORT SI,DIANE,-453492000000000
BRISTOL,DIANE,-453492000000000
BAYONNE,DIANE,-453492000000000
WEEHAWKEN,DIANE,-453492000000000
PORT RICHMOND SI,DIANE,-453492000000000
HOBOKEN,DIANE,-453492000000000
BURLINGTON,DIANE,-453492000000000
SAYREVILLE,DIANE,-453492000000000
CARTERET,DIANE,-453492000000000
LEONARDO,DIANE,-453492000000000
MARINERS HARBOR SI,DIANE,-453492000000000
STAPLETON SI,DIANE,-453492000000000
NEWARK,DIANE,-453492000000000
PORT READING,DIANE,-453492000000000
SOUTH AMBOY,DIANE,-453492000000000
SAVANNAH,GRACIE,-323676000000000
PORT ROYAL,GRACIE,-323676000000000
BEAUFORT,GRACIE,-323676000000000
SALEM,DONNA,-293500800000000
BOSTON,DONNA,-293500800000000
MARBLEHEAD,DONNA,-293500800000000
LYNN,DONNA,-293500800000000
NEWBURYPORT,DONNA,-293500800000000
BEVERLY,DONNA,-293500800000000
PORTSMOUTH,DONNA,-293500800000000
PORT EVERGLADES,ISBELL,-164505600000000
MAYPORT,GLADYS,-37886400000000
ST AUGUSTINE,GLADYS,-37886400000000
FORT PIERCE,FLORENCE,-292528800000000
EDENTON,CLEO,-168285600000000
HERTFORD,CLEO,-168285600000000
COLUMBIA,CLEO,-168285600000000
PLYMOUTH,CLEO,-168285600000000
ELIZABETH CITY,CLEO,-168285600000000
CANAVERAL HARBOR,ABBY,-49636800000000
DAVISVILLE DEPOT,BERTHA,837302400000000
PROVIDENCE,BERTHA,837302400000000
COLUMBIA,BONNIE,904262400000000
ELIZABETH CITY,BONNIE,904262400000000
GEORGETOWN,IAN,1664560800000000
BAYBORO,FLOSSY,-418478400000000
WASHINGTON,FLOSSY,-418478400000000
NEW BERN,FLOSSY,-418478400000000
PATCHOGUE,HENRI,496432800000000
WRIGHTSVILLE,DIANA,463906800000000
WILMINGTON,DIANA,463906800000000
SOUTHPORT,DIANA,463906800000000
SAVANNAH,CHRIS,588783600000000
PORT ROYAL,CHRIS,588783600000000
BEAUFORT,CHRIS,588783600000000
SOUTHPORT,BERTHA,837194400000000
ST AUGUSTINE,EDOUARD,1031186700000000
BRUNSWICK,BARRY,1180828800000000
DARIEN,BARRY,1180828800000000
ATLANTIC CITY,SANDY,1351555200000000
BARNEGAT,SANDY,1351555200000000
NORFOLK,CINDY,-330674400000000
NEWPORT NEWS,CINDY,-330674400000000
CAPE CHARLES,CINDY,-330674400000000
PORTSMOUTH,CINDY,-330674400000000
YORKTOWN,CINDY,-330674400000000
COREA,CINDY,-330588000000000
WINTER HARBOR,CINDY,-330588000000000
MACHIAS,CINDY,-330588000000000
MILBRIDGE,CINDY,-330588000000000
WRIGHTSVILLE,BONNIE,904190400000000
WILMINGTON,BONNIE,904190400000000
SOUTHPORT,BONNIE,904190400000000
PALM BEACH,CLEO,-168696000000000
PORT EVERGLADES,CLEO,-168696000000000
FERNANDINA BEACH,ISABEL,497815200000000
MAYPORT,ISABEL,497815200000000
ST AUGUSTINE,ISABEL,497815200000000
FORT PIERCE,ERIN,807344100000000
SOUTHPORT,FRAN,841968000000000
PALM BEACH,IRENE,940053600000000
FORT PIERCE,IRENE,940053600000000
WRIGHTSVILLE,CHARLEY,1092506400000000
WILMINGTON,CHARLEY,1092506400000000
BRUNSWICK,BRENDA,-297432000000000
DARIEN,BRENDA,-297432000000000
CANAVERAL HARBOR,ALMA,-231876000000000
WRIGHTSVILLE,ALLISON,802461600000000
WILMINGTON,ALLISON,802461600000000
FORT PIERCE,FRANCES,1094385600000000
BAR HARBOR,CINDY,-330588000000000
WYMAN,CINDY,-330588000000000
Query:
-- Corrected Query 12
SELECT
       "season" AS "year",
       COUNT(DISTINCT "sid") AS "hurricane_count"
FROM
       NOAA_PORTS.NOAA_HURRICANES.HURRICANES
WHERE
       "basin" = 'NA' AND
       "wmo_wind" >= 35 AND
       "name" IS NOT NULL AND "name" != 'NOT_NAMED' AND
       "season" IS NOT NULL
GROUP BY
       "season"
ORDER BY
       "year"
LIMIT 100
Answer:
year,hurricane_count
1950,13
1951,10
1952,6
1953,8
1954,9
1955,10
1956,7
1957,6
1958,10
1959,10
1960,6
1961,10
1962,5
1963,8
1964,9
1965,5
1966,12
1967,8
1968,7
1969,13
1970,7
1971,12
1972,7
1973,8
1974,7
1975,8
1976,8
1977,6
1978,11
1979,8
1980,11
1981,11
1982,5
1983,4
1984,12
1985,11
1986,6
1987,6
1988,11
1989,11
1990,14
1991,7
1992,6
1993,8
1994,7
1995,19
1996,13
1997,7
1998,14
1999,12
2000,14
2001,15
2002,12
2003,16
2004,15
2005,27
2006,9
2007,15
2008,16
2009,9
2010,19
2011,18
2012,19
2013,13
2014,8
2015,11
2016,15
2017,17
2018,15
2019,18
2020,30
2021,21
2022,14
End Exploring Related Columns
Task: Can you provide the name of the port that is most frequently within the geographical area of named tropical storms in the region of the code 6585 with winds of at least 35 knots in the North Atlantic basin, which is also located within a specific region and intersects with interstate roads?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: The port that meets the specified conditions is:

```csv
Port_Name
name:str
(Attention: answer in one row)
```

**Explanation:**

We identified the port within region code 6585 that most frequently falls within the geographical area of named tropical storms in the North Atlantic basin with winds of at least 35 knots, and that also intersects with interstate roads..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'NOAA_PORTS': {'GEO_INTERNATIONAL_PORTS': ['WORLD_PORT_INDEX'], 'GEO_US_BOUNDARIES': ['ADJACENT_COUNTIES', 'ADJACENT_STATES', 'CBSA', 'CNECTA', 'COASTLINE', 'CONGRESS_DISTRICT_115', 'CONGRESS_DISTRICT_116', 'COUNTIES', 'CSA', 'METROPOLITAN_DIVISIONS', 'NATIONAL_OUTLINE', 'NWS_FORECAST_REGIONS', 'RAILWAYS', 'STATES', 'URBAN_AREAS', 'ZIP_CODES'], 'NOAA_HURRICANES': ['HURRICANES']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-26 17:38:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 17:38:30 - root - INFO - ```sql
SELECT
    p."port_name"
FROM
    NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX p
JOIN
    NOAA_PORTS.NOAA_HURRICANES.HURRICANES h
ON
    ST_DISTANCE(
        ST_MAKEPOINT(p."port_longitude", p."port_latitude"),
        ST_MAKEPOINT(h."longitude", h."latitude")
    ) <= 50000
WHERE
    p."region_number" = '6585'
    AND h."basin" = 'NA'
    AND h."wmo_wind" >= 35
    AND h."name" IS NOT NULL
    AND h."name" != 'NOT_NAMED'
    AND p."port_latitude" IS NOT NULL
    AND p."port_longitude" IS NOT NULL
    AND h."latitude" IS NOT NULL
    AND h."longitude" IS NOT NULL
GROUP BY
    p."port_name"
ORDER BY
    COUNT(*) DESC NULLS LAST
LIMIT 1;
```
2025-01-26 17:38:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:38:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:38:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:38:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-26 17:38:31 - snowflake.connector.connection - INFO - closed
2025-01-26 17:38:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:38:32 - root - INFO - itercount: 1
2025-01-26 17:38:32 - root - INFO - 0
2025-01-26 17:38:32 - root - INFO - results: 
port_name
BEAUFORT


2025-01-26 17:38:32 - root - INFO - Please check the answer again by reviewing Can you provide the name of the port that is most frequently within the geographical area of named tropical storms in the region of the code 6585 with winds of at least 35 knots in the North Atlantic basin, which is also located within a specific region and intersects with interstate roads?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: The port that meets the specified conditions is:

```csv
Port_Name
name:str
(Attention: answer in one row)
```

**Explanation:**

We identified the port within region code 6585 that most frequently falls within the geographical area of named tropical storms in the North Atlantic basin with winds of at least 35 knots, and that also intersects with interstate roads. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
port_name
BEAUFORT
Current sql:
SELECT
    p."port_name"
FROM
    NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX p
JOIN
    NOAA_PORTS.NOAA_HURRICANES.HURRICANES h
ON
    ST_DISTANCE(
        ST_MAKEPOINT(p."port_longitude", p."port_latitude"),
        ST_MAKEPOINT(h."longitude", h."latitude")
    ) <= 50000
WHERE
    p."region_number" = '6585'
    AND h."basin" = 'NA'
    AND h."wmo_wind" >= 35
    AND h."name" IS NOT NULL
    AND h."name" != 'NOT_NAMED'
    AND p."port_latitude" IS NOT NULL
    AND p."port_longitude" IS NOT NULL
    AND h."latitude" IS NOT NULL
    AND h."longitude" IS NOT NULL
GROUP BY
    p."port_name"
ORDER BY
    COUNT(*) DESC NULLS LAST
LIMIT 1;
2025-01-26 17:39:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 17:39:14 - root - INFO - The port that meets the specified conditions is:

```csv
Port_Name
BEAUFORT
```

```sql
SELECT
    p."port_name"
FROM
    NOAA_PORTS.GEO_INTERNATIONAL_PORTS.WORLD_PORT_INDEX p
JOIN
    NOAA_PORTS.NOAA_HURRICANES.HURRICANES h
ON
    ST_DISTANCE(
        ST_MAKEPOINT(p."port_longitude", p."port_latitude"),
        ST_MAKEPOINT(h."longitude", h."latitude")
    ) <= 50000
WHERE
    p."region_number" = '6585'
    AND h."basin" = 'NA'
    AND h."wmo_wind" >= 35
    AND h."name" IS NOT NULL
    AND h."name" != 'NOT_NAMED'
    AND p."port_latitude" IS NOT NULL
    AND p."port_longitude" IS NOT NULL
    AND h."latitude" IS NOT NULL
    AND h."longitude" IS NOT NULL
GROUP BY
    p."port_name"
ORDER BY
    COUNT(*) DESC NULLS LAST
LIMIT 1;
```
2025-01-26 17:39:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 17:39:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 17:39:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 17:39:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-26 17:39:15 - snowflake.connector.connection - INFO - closed
2025-01-26 17:39:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 17:39:16 - root - INFO - itercount: 2
2025-01-26 17:39:16 - root - INFO - 0
2025-01-26 17:39:16 - root - INFO - Total iteration counts: 2
