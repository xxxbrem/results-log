2025-01-19 07:56:28 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 07:57:31 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 07:57:33 - root - INFO - SQL:
SELECT DISTINCT series_code, indicator_name
   FROM `bigquery-public-data.world_bank_wdi.series_summary`
   WHERE LOWER(indicator_name) LIKE '%gdp (constant 2015 us$)%'
   LIMIT 1000;
Results:
series_code,indicator_name
NY.GDP.MKTP.KD,GDP (constant 2015 US$)

2025-01-19 07:57:34 - root - INFO - SQL:
SELECT country_code, country_name, indicator_code, year, value
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE indicator_code = 'NY.GDP.MKTP.KD'
   LIMIT 1000;
Results:
Too long, hard cut:
country_code,country_name,indicator_code,year,value
MMR,Myanmar,NY.GDP.MKTP.KD,1968,3766485577.12378
NAM,Namibia,NY.GDP.MKTP.KD,1998,5242128224.00169
NPL,Nepal,NY.GDP.MKTP.KD,1962,3447314854.82201
NPL,Nepal,NY.GDP.MKTP.KD,2006,16439932516.5831
BRN,Brunei Darussalam,NY.GDP.MKTP.KD,2009,12665627056.3659
BGR,Bulgaria,NY.GDP.MKTP.KD,1985,35814094910.805
BGR,Bulgaria,NY.GDP.MKTP.KD,1987,39580615170.2135
BDI,Burundi,NY.GDP.MKTP.KD,1982,1712247647.29676
LAC,Latin America & Caribbean (excluding high income),NY.GDP.MKTP.KD,1997,2846009420300.99
LMY,Low & middle income,NY.GDP.MKTP.KD,2007,17586878384858.0
LMC,Lower middle income,NY.GDP.MKTP.KD,1965,771275616651.188
LMC,Lower middle income,NY.GDP.MKTP.KD,1990,2122313482158.37
LMC,Lower middle income,NY.GDP.MKTP.KD,2002,3194038992245.53
MEA,Middle East & North Africa,NY.GDP.MKTP.KD,2020,3243739545284.98
MNA,Middle East & North Africa (excluding high income),NY.GDP.MKTP.KD,1980,419562499542.787
DMA,Dominica,NY.GDP.MKTP.KD,1978,234352173.555526
LVA,Latvia,NY.GDP.MKTP.KD,2007,29002363545.9676
LSO,Lesotho,NY.GDP.MKTP.KD,2004,1612096000.49548
WSM,Samoa,NY.GDP.MKTP.KD,1982,409723388.389005
OMN,Oman,NY.GDP.MKTP.KD,1983,18925617927.7435
CAF,Central African Republic,NY.GDP.MKTP.KD,1965,1013697584.80447
COM,Comoros,NY.GDP.MKTP.KD,1997,563886119.709676
WLD,World,NY.GDP.MKTP.KD,2000,48146683077384.4
DZA,Algeria,NY.GDP.MKTP.KD,1961,20733849882.3774
DZA,Algeria,NY.GDP.MKTP.KD,2006,126495413069.533
TMN,Middle East & North Africa (IDA & IBRD countries),NY.GDP.MKTP.KD,2004,992580883046.924
NAC,North America,NY.GDP.MKTP.KD,1992,10929544482336.9
PSS,Pacific island small states,NY.GDP.MKTP.KD,2005,7231294470.42854
PST,Post-demographic dividend,NY.GDP.MKTP.KD,1963,9889377686297.1
FIN,Finland,NY.GDP.MKTP.KD,1960,50589519083.7226
FIN,Finland,NY.GDP.MKTP.KD,1987,140069588805.624
FIN,Finland,NY.GDP.MKTP.KD,2002,204568476382.962
FRA,France,NY.GDP.MKTP.KD,1976,1148593347439.08
FRA,France,NY.GDP.MKTP.KD,1990,1660423065362.52
GAB,Gabon,NY.GDP.MKTP.KD,2019,15460241608.8257
EMU,Euro area,NY.GDP.MKTP.KD,1997,9036375850461.54
EMU,Euro area,NY.GDP.MKTP.KD,2009,10965349872015.8
HIC,High income,NY.GDP.MKTP.KD,1978,19407887392109.1
HIC,High income,NY.GDP.MKTP.KD,1985,23196833368009.8
MDG,Madagascar,NY.GDP.MKTP.KD,2018,12629254614.1071
MLT,Malta,NY.GDP.MKTP.KD,1985,2646361034.06191
MHL,Marshall Islands,NY.GDP.MKTP.KD,2007,175092500.0
MRT,Mauritania,NY.GDP.MKTP.KD,1963,1051184411.5989
MRT,Mauritania,NY.GDP.MKTP.KD,1985,2488366451.23844
SGP,Singapore,NY.GDP.MKTP.KD,1962,6911841722.43236
SXM,Sint Maarten (Dutch part),NY.GDP.MKTP.KD,2018,1108000824.03352
ESP,Spain,NY.GDP.MKTP.KD,2010,1196670854394.8
PRI,Puerto Rico,NY.GDP.MKTP.KD,1986,58362843987.8155
COG,"Congo, Rep.",NY.GDP.MKTP.KD,1964,1423661535.42456
CUB,Cuba,NY.GDP.MKTP.KD,2015,87133000000.0
CUW,Curacao,NY.GDP.MKTP.KD,2011,3209266564.04194
CZE,Czech Republic,NY.GDP.MKTP.KD,1990,120142052583.973
GUY,Guyana,NY.GDP.MKTP.KD,1969,2110018751.87545
GUY,Guyana,NY.GDP.MKTP.KD,1971,2268286484.8283
HUN,Hungary,NY.GDP.MKTP.KD,2009,111923227694.593
ISL,Iceland,NY.GDP.MKTP.KD,2014,16773046835.507
ISL,Iceland,NY.GDP.MKTP.KD,2016,18621440660.0019
SAS,South Asia,NY.GDP.MKTP.KD,1976,328162729613.475
SSF,Sub-Saharan Africa,NY.GDP.MKTP.KD,1989,647798062253.99
SSA,Sub-Saharan Africa (excluding high income),NY.GDP.MKTP.KD,1970,399355844595.27
UMC,Upper middle income,NY.GDP.MKTP.KD,1960,1315490536908.03
UMC,Upper middle income,NY.GDP.MKTP.KD,1963,1409668204817.16
AUS,Australia,NY.GDP.MKTP.KD,1971,349823081605.576
AUT,Austria,NY.GDP.MKTP.KD,1967,114458318906.485
AUT,Austria,NY.GDP.MKTP.KD,2016,389413586441.667
AZE,Azerbaijan,NY.GDP.MKTP.KD,2001,13097901809.4266
AZE,Azerbaijan,NY.GDP.MKTP.KD,2017,51531923130.9779
BGD,Bangladesh,NY.GDP.MKTP.KD,1998,75731164300.4426
BLR,Belarus,NY.GDP.MKTP.KD,1991,29099127258.7491
SUR,Suriname,NY.GDP.MKTP.KD,1998,2901533087.48207
CHE,Switzerland,NY.GDP.MKTP.KD,2009,621539124455.347
SYR,Syrian Arab Republic,NY.GDP.MKTP.KD,1990,11619961705.0846
IBT,IDA & IBRD total,NY.GDP.MKTP.KD,2017,30551204405315.5
IDB,IDA blend,NY.GDP.MKTP.KD,1960,112826602868.049
LCN,Latin America & Caribbean,NY.GDP.MKTP.KD,1965,922462437781.724
GMB,"Gambia, The",NY.GDP.MKTP.KD,2011,1240786424.0015
GEO,Georgia,NY.GDP.MKTP.KD,1979,16928230216.586
GEO,Georgia,NY.GDP.MKTP.KD,1987,20399949704.5182
GEO,Georgia,NY.GDP.MKTP.KD,2009,11050871061.5608
GEO,Georgia,NY.GDP.MKTP.KD,2010,11741493896.7964
GEO,Georgia,NY.GDP.MKTP.KD,2016,15388577975.5872
GRL,Greenland,NY.GDP.MKTP.KD,1985,1326357012.1974
GRL,Greenland,NY.GDP.MKTP.KD,1996,1496590669.3289
TZA,Tanzania,NY.GDP.MKTP.KD,2012,39158481311.5869
MDA,Moldova,NY.GDP.MKTP.KD,2016,8086710150.73289
MDA,Moldova,NY.GDP.MKTP.KD,2017,8466041015.96707
BLZ,Belize,NY.GDP.MKTP.KD,1992,737285247.043466
BEN,Benin,NY.GDP.MKTP.KD,1976,2380844444.63745
BWA,Botswana,NY.GDP.MKTP.KD,1962,203905557.028968
IRN,"Iran, Islamic Rep.",NY.GDP.MKTP.KD,1984,178472196717.133
ISR,Israel,NY.GDP.MKTP.KD,1999,166031729085.374
JAM,Jamaica,NY.GDP.MKTP.KD,1976,9113027630.3123

2025-01-19 07:57:36 - root - INFO - SQL:
SELECT DISTINCT region
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   LIMIT 1000;
Results:
region
""
Europe & Central Asia
North America
Latin America & Caribbean
East Asia & Pacific
Sub-Saharan Africa
Middle East & North Africa
South Asia

2025-01-19 07:57:38 - root - INFO - SQL:
SELECT country_code, short_name AS country_name, region
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   LIMIT 1000;
Results:
Too long, hard cut:
country_code,country_name,region
AFE,Africa Eastern and Southern,
AFW,Africa Western and Central,
ARB,Arab World,
CEB,Central Europe and the Baltics,
CSS,Caribbean small states,
EAP,East Asia & Pacific (excluding high income),
EAR,Early-demographic dividend,
EAS,East Asia & Pacific,
ECA,Europe & Central Asia (excluding high income),
ECS,Europe & Central Asia,
EUU,European Union,
FCS,Fragile and conflict affected situations,
HIC,High income,
HPC,Heavily indebted poor countries (HIPC),
IBD,IBRD only,
IBT,IDA & IBRD total,
IDA,IDA total,
IDB,IDA blend,
IDX,IDA only,
LAC,Latin America & Caribbean (excluding high income),
LCN,Latin America & Caribbean,
LDC,Least developed countries: UN classification,
LIC,Low income,
LMC,Lower middle income,
LMY,Low & middle income,
LTE,Late-demographic dividend,
MEA,Middle East & North Africa,
MIC,Middle income,
MNA,Middle East & North Africa (excluding high income),
NAC,North America,
OED,OECD members,
OSS,Other small states,
PRE,Pre-demographic dividend,
PSS,Pacific island small states,
PST,Post-demographic dividend,
SAS,South Asia,
SSA,Sub-Saharan Africa (excluding high income),
SSF,Sub-Saharan Africa,
SST,Small states,
TEA,East Asia & Pacific (IDA & IBRD),
TEC,Europe & Central Asia (IDA & IBRD),
TLA,Latin America & Caribbean (IDA & IBRD),
TMN,Middle East & North Africa (IDA & IBRD),
TSA,South Asia (IDA & IBRD),
TSS,Sub-Saharan Africa (IDA & IBRD),
UMC,Upper middle income,
WLD,World,
AND,Andorra,Europe & Central Asia
BMU,Bermuda,North America
CHI,Channel Islands,Europe & Central Asia
CUW,Curaçao,Latin America & Caribbean
CYM,Cayman Islands,Latin America & Caribbean
FRO,Faroe Islands,Europe & Central Asia
GIB,Gibraltar,Europe & Central Asia
GRL,Greenland,Europe & Central Asia
GUM,Guam,East Asia & Pacific
IMN,Isle of Man,Europe & Central Asia
LIE,Liechtenstein,Europe & Central Asia
MAF,St. Martin (French part),Latin America & Caribbean
MCO,Monaco,Europe & Central Asia
MNP,Northern Mariana Islands,East Asia & Pacific
NCL,New Caledonia,East Asia & Pacific
NRU,Nauru,East Asia & Pacific
NZL,New Zealand,East Asia & Pacific
PRI,Puerto Rico,Latin America & Caribbean
PYF,French Polynesia,East Asia & Pacific
SXM,Sint Maarten (Dutch part),Latin America & Caribbean
TCA,Turks and Caicos Islands,Latin America & Caribbean
VGB,British Virgin Islands,Latin America & Caribbean
VIR,Virgin Islands,Latin America & Caribbean
ERI,Eritrea,Sub-Saharan Africa
PRK,Dem. People's Rep. Korea,East Asia & Pacific
SOM,Somalia,Sub-Saharan Africa
SSD,South Sudan,Sub-Saharan Africa
ASM,American Samoa,East Asia & Pacific
CUB,Cuba,Latin America & Caribbean
TKM,Turkmenistan,Europe & Central Asia
VEN,Venezuela,Latin America & Caribbean
ABW,Aruba,Latin America & Caribbean
ARE,United Arab Emirates,Middle East & North Africa
ATG,Antigua and Barbuda,Latin America & Caribbean
BHR,Bahrain,Middle East & North Africa
BHS,The Bahamas,Latin America & Caribbean
BRB,Barbados,Latin America & Caribbean
BRN,Brunei,East Asia & Pacific
KNA,St. Kitts and Nevis,Latin America & Caribbean
KWT,Kuwait,Middle East & North Africa
MAC,"Macao SAR, China",East Asia & Pacific
OMN,Oman,Middle East & North Africa
PAN,Panama,Latin America & Caribbean
QAT,Qatar,Middle East & North Africa
SMR,San Marino,Europe & Central Asia
TTO,Trinidad and Tobago,Latin America & Caribbean
AFG,Afghanistan,South Asia
BDI,Burundi,Sub-Saharan Africa
BFA,Burkina Faso,Sub-Saharan Africa
CAF,Central African Republic,Sub-Saharan Africa
COD,Dem. Rep. Congo,Sub-Saharan Africa
ETH,Ethiopia,Sub-Saharan Africa
GIN,Guinea,Sub-Saharan Africa
GMB,The Gambia,Sub-Saharan Africa
GNB,Guinea-Bissau,Sub-Saharan Africa
LBR,Liberia,Sub-Saharan Africa
MDG,Madagascar,Sub-Saharan Africa
MLI,Mali,Sub-Saharan Africa
MOZ,Mozambique,Sub-Saharan Africa
MWI,Malawi,Sub-Saharan Africa
NER,Niger,Sub-Saharan Africa
RWA,Rwanda,Sub-Saharan Africa
SDN,Sudan,Sub-Saharan Africa
SLE,Sierra Leone,Sub-Saharan Africa
SYR,Syrian Arab Republic,Middle East & North Africa
TCD,Chad,Sub-Saharan Africa
TGO,Togo,Sub-Saharan Africa
UGA,Uganda,Sub-Saharan Africa
YEM,Yemen,Middle East & North Africa
ZMB,Zambia,Sub-Saharan Africa
AGO,Angola,Sub-Saharan Africa
BEN,Benin,Sub-Saharan Africa
BGD,Bangladesh,South Asia
BOL,Bolivia,Latin America & Caribbean
BTN,Bhutan,South Asia
CIV,Côte d'Ivoire,Sub-Saharan Africa
CMR,Cameroon,Sub-Saharan Africa
COG,Congo,Sub-Saharan Africa
COM,Comoros,Sub-Saharan Africa
CPV,Cabo Verde,Sub-Saharan Africa
DJI,Djibouti,Middle East & North Africa
DZA,Algeria,Middle East & North Africa
FSM,Micronesia,East Asia & Pacific
GHA,Ghana,Sub-Saharan Africa
HND,Honduras,Latin America & Caribbean
HTI,Haiti,Latin America & Caribbean
IRN,Iran,Middle East & North Africa
KEN,Kenya,Sub-Saharan Africa
KHM,Cambodia,East Asia & Pacific
KIR,Kiribati,East Asia & Pacific
LAO,Lao PDR,East Asia & Pacific
LBN,Lebanon,Middle East & North Africa
LSO,Lesotho,Sub-Saharan Africa
MMR,Myanmar,East Asia & Pacific
MRT,Mauritania,Sub-Saharan Africa
NGA,Nigeria,Sub-Saharan Africa
NIC,Nicaragua,Latin America & Caribbean
NPL,Nepal,S

2025-01-19 07:57:40 - root - INFO - SQL:
SELECT country_code, country_name, year, value
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE indicator_code = 'NY.GDP.MKTP.KD' AND year = 2019
   LIMIT 1000;
Results:
Too long, hard cut:
country_code,country_name,year,value
EUU,European Union,2019,14765116523492.0
BRN,Brunei Darussalam,2019,13278836553.322
ZMB,Zambia,2019,24089861649.0155
HTI,Haiti,2019,15474153940.1499
TJK,Tajikistan,2019,10943735892.3235
BEN,Benin,2019,14179807326.7156
MAC,"Macao SAR, China",2019,51073940150.1338
TMN,Middle East & North Africa (IDA & IBRD countries),2019,1522371834048.04
VCT,St. Vincent and the Grenadines,2019,798469518.407039
TZA,Tanzania,2019,60318543760.5445
GRL,Greenland,2019,2710570656.36234
LSO,Lesotho,2019,2329753748.89367
EAP,East Asia & Pacific (excluding high income),2019,17016933263759.9
MDV,Maldives,2019,5414217823.03808
CYP,Cyprus,2019,24880804888.1512
CAN,Canada,2019,1696163077026.08
PLW,Palau,2019,265597626.615969
MHL,Marshall Islands,2019,212388500.0
JAM,Jamaica,2019,14934128282.7371
NRU,Nauru,2019,89620006.418409
NOR,Norway,2019,406468037614.963
CUB,Cuba,2019,91019611431.1927
JPN,Japan,2019,4591290538384.75
AFG,Afghanistan,2019,21118462796.7609
BFA,Burkina Faso,2019,15001629028.4851
GNQ,Equatorial Guinea,2019,9998462337.55955
BGR,Bulgaria,2019,57443866470.1882
EAS,East Asia & Pacific,2019,26302619575881.9
MLI,Mali,2019,16028741076.2588
LBN,Lebanon,2019,46777216084.3953
SOM,Somalia,2019,6900727625.84454
ATG,Antigua and Barbuda,2019,1630215842.3024
HKG,"Hong Kong SAR, China",2019,331749697713.935
TCD,Chad,2019,10526057266.1328
ARM,Armenia,2019,12867495686.1153
HIC,High income,2019,52180038375130.5
BIH,Bosnia and Herzegovina,2019,18413845946.1771
TLA,Latin America & the Caribbean (IDA & IBRD countries),2019,5369907031287.5
SLB,Solomon Islands,2019,1533613348.9277
ISL,Iceland,2019,20847341424.8856
SGP,Singapore,2019,348909586848.996
SST,Small states,2019,486912648101.75
GUM,Guam,2019,5966796360.32757
SRB,Serbia,2019,45615675379.6018
MNP,Northern Mariana Islands,2019,1037951515.15152
WLD,World,2019,84612027798062.6
PSS,Pacific island small states,2019,10138908192.4612
FCS,Fragile and conflict affected situations,2019,1720631743301.35
BGD,Bangladesh,2019,261518503633.701
GMB,"Gambia, The",2019,1676447055.8329
TUV,Tuvalu,2019,42824596.8653884
UZB,Uzbekistan,2019,106161435002.412
MRT,Mauritania,2019,7336133809.76738
DNK,Denmark,2019,334638192450.446
CYM,Cayman Islands,2019,5425515180.60722
BEL,Belgium,2019,494644115983.888
COD,"Congo, Dem. Rep.",2019,44487657807.0092
PRI,Puerto Rico,2019,96423791493.1329
NZL,New Zealand,2019,200742824665.702
HUN,Hungary,2019,146968695014.007
LBY,Libya,2019,40473930298.8275
AFW,Africa Western and Central,2019,827963431037.275
CEB,Central Europe and the Baltics,2019,1519932999983.23
RUS,Russian Federation,2019,1459189098326.43
SVK,Slovak Republic,2019,99048285215.7697
KGZ,Kyrgyz Republic,2019,7920624102.90056
MIC,Middle income,2019,31663365601529.3
CHE,Switzerland,2019,758167874591.909
LCN,Latin America & Caribbean,2019,5596468714863.74
VNM,Vietnam,2019,251208952743.671
KIR,Kiribati,2019,195759870.68938
MKD,North Macedonia,2019,11185489898.549
ASM,American Samoa,2019,628818320.610687
GUY,Guyana,2019,5071041645.23612
IBT,IDA & IBRD total,2019,33299134680470.5
MUS,Mauritius,2019,13471938135.6172
CHN,China,2019,14296238286985.1
COM,Comoros,2019,1092787840.36505
ECS,Europe & Central Asia,2019,22365520285914.6
CIV,Cote d'Ivoire,2019,59861589342.7008
FSM,"Micronesia, Fed. Sts.",2019,332458532.270118
STP,Sao Tome and Principe,2019,359752972.346268
IRQ,Iraq,2019,202613535336.009
PST,Post-demographic dividend,2019,48381584694878.9
KNA,St. Kitts and Nevis,2019,1136818536.07058
BMU,Bermuda,2019,6851270046.39601
BWA,Botswana,2019,16188225469.2536
PSE,West Bank and Gaza,2019,15829000000.0
CUW,Curacao,2019,2898092042.62992
DMA,Dominica,2019,568298267.854584
LBR,Liberia,2019,3211334057.92828
LCA,St. Lucia,2019,1995116519.64915
FRA,France,2019,2615760319962.67
SLE,Sierra Leone,2019,5076711739.04284
PNG,Papua New Guinea,2019,24719859152.6631
SSA,Sub-Saharan Africa (excluding high income),2019,1833089644759.92
TLS,Timor-Leste,2019,1896767581.03646
DZA,Algeria,2019,177180346401.967
EMU,Euro area,2019,12615961472339.9
IRL,Ireland,2019,370632118369.555
IMN,Isle of Man,2019,8129451489.68678
MEA,Middle East & North Africa,2019,3378463990503.43
RWA,Rwanda,2019,11182411389.0747
IBD,IBRD only,2019,30947573002709.4
CPV,Cabo Verde,2019,1915123782.86887
SYC,Seychelles,2019,1553599342.64266
LMY,Low & middle income,2019,32139450441501.1
SWZ,Eswatini,2019,4401077165.65255
BHR,Bahrain,2019,34985241938.6953
ZWE,Zimbabwe,2019,20720841373.1335
NPL,Nepal,2019,30605291409.0891
ARE,United Arab Emirates,2019,395103837869.753
NER,Niger,2019,12212118177.9725
LMC,Lower middle income,2019,7796543762641.46
AND,Andorra,2019,3008955096.59511
AUS,Australia,2019,1491025040336.15
GRD,Grenada,2019,1134931073.15504
BOL,Bolivia,2019,38193230057.6737
BRA,Brazil,2019,1823105452462.95
CHL,Chile,2019,262807032486.856
ECU,Ecuador,2019,101702140245.144
EGY,"Egypt, Arab Rep.",2019,398037429245.42
GTM,Guatemala,2019,70634110391.9779
HND,Honduras,2019,24191028957.12
JOR,Jordan,2019,41755867661.2459
KEN,Kenya,2019,84125098675.

2025-01-19 07:57:41 - root - INFO - SQL:
SELECT i.country_code, i.country_name, i.year, i.value, c.region
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS i
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS c
   ON i.country_code = c.country_code
   WHERE i.indicator_code = 'NY.GDP.MKTP.KD' AND i.year = 2019
   LIMIT 1000;
Results:
Too long, hard cut:
country_code,country_name,year,value,region
GAB,Gabon,2019,15460241608.8257,Sub-Saharan Africa
NAM,Namibia,2019,11240759011.0283,Sub-Saharan Africa
AGO,Angola,2019,110072586683.261,Sub-Saharan Africa
SDN,Sudan,2019,51312429477.3951,Sub-Saharan Africa
MNA,Middle East & North Africa (excluding high income),2019,1538200834048.04,
AFE,Africa Eastern and Southern,2019,1006679813065.29,
TON,Tonga,2019,486181549.588749,East Asia & Pacific
TKM,Turkmenistan,2019,45710025776.6731,Europe & Central Asia
EAR,Early-demographic dividend,2019,11703037495097.2,
QAT,Qatar,2019,167371229308.42,Middle East & North Africa
TEC,Europe & Central Asia (IDA & IBRD countries),2019,4095463099662.97,
AUT,Austria,2019,414257026093.423,Europe & Central Asia
NGA,Nigeria,2019,502942019447.736,Sub-Saharan Africa
DEU,Germany,2019,3598891541091.34,Europe & Central Asia
MOZ,Mozambique,2019,18183590595.087,Sub-Saharan Africa
LAO,Lao PDR,2019,18491845636.2733,East Asia & Pacific
MLT,Malta,2019,13856372628.2222,Middle East & North Africa
WSM,Samoa,2019,887495263.360233,East Asia & Pacific
HPC,Heavily indebted poor countries (HIPC),2019,788661392496.297,
MDG,Madagascar,2019,13186360351.4331,Sub-Saharan Africa
SVN,Slovenia,2019,50249892617.4104,Europe & Central Asia
KAZ,Kazakhstan,2019,211106972039.014,Europe & Central Asia
PRT,Portugal,2019,222272974069.03,Europe & Central Asia
GBR,United Kingdom,2019,3191493407624.4,Europe & Central Asia
NAC,North America,2019,21677548659072.5,
ARB,Arab World,2019,2681441590769.14,
OMN,Oman,2019,83053174485.8283,Middle East & North Africa
TSS,Sub-Saharan Africa (IDA & IBRD countries),2019,1834643244102.56,
LAC,Latin America & Caribbean (excluding high income),2019,4853709324043.9,
ETH,Ethiopia,2019,89640020508.4013,Sub-Saharan Africa
CZE,Czech Republic,2019,215594735504.853,Europe & Central Asia
TCA,Turks and Caicos Islands,2019,1095902844.26329,Latin America & Caribbean
GIN,Guinea,2019,12078653011.9638,Sub-Saharan Africa
BLZ,Belize,2019,1835056955.71673,Latin America & Caribbean
KWT,Kuwait,2019,114249382864.585,Middle East & North Africa
MMR,Myanmar,2019,83686992015.6706,East Asia & Pacific
LVA,Latvia,2019,30716038078.95,Europe & Central Asia
AZE,Azerbaijan,2019,53612524527.3911,Europe & Central Asia
URY,Uruguay,2019,55513344382.0673,Latin America & Caribbean
LUX,Luxembourg,2019,67286460381.3888,Europe & Central Asia
CSS,Caribbean small states,2019,74283427277.9706,
GRC,Greece,2019,203669187367.386,Europe & Central Asia
KHM,Cambodia,2019,23760061873.2798,East Asia & Pacific
TEA,East Asia & Pacific (IDA & IBRD countries),2019,16995303639412.5,
FIN,Finland,2019,254637296103.695,Europe & Central Asia
LIC,Low income,2019,476617321590.818,
DJI,Djibouti,2019,3191833262.48686,Middle East & North Africa
LTU,Lithuania,2019,48155059559.2863,Europe & Central Asia
HRV,Croatia,2019,57190160216.5408,Europe & Central Asia
SAS,South Asia,2019,3431466032627.32,
TSA,South Asia (IDA & IBRD),2019,3431466032627.32,
GNB,Guinea-Bissau,2019,1248729327.89726,Sub-Saharan Africa
ALB,Albania,2019,12970913827.5704,Europe & Central Asia
MCO,Monaco,2019,7080667991.59357,Europe & Central Asia
COG,"Congo, Rep.",2019,9643515879.79193,Sub-Saharan Africa
GEO,Georgia,2019,17757903230.0709,Europe & Central Asia
MNG,Mongolia,2019,14174566299.8985,East Asia & Pacific
MNE,Montenegro,2019,4777636043.80572,Europe & Central Asia
EST,Estonia,2019,27068147756.8566,Europe & Central Asia
ECA,Europe & Central Asia (excluding high income),2019,3468157804813.19,
TTO,Trinidad and Tobago,2019,22587789317.2434,Latin America & Caribbean
ISR,Israel,2019,353062816517.302,Middle East & North Africa
USA,United States,2019,19974534312000.0,North America
MWI,Malawi,2019,7477443338.32784,Sub-Saharan Africa
IDX,IDA only,2019,1229224147182.17,
CAF,Central African Republic,2019,1984982171.73544,Sub-Saharan Africa
IDB,IDA blend,2019,1121954012747.96,
BHS,"Bahamas, The",2019,12516819004.1803,Latin America & Caribbean
TGO,Togo,2019,5098275352.1552,Sub-Saharan Africa
BDI,Burundi,2019,3209182941.33059,Sub-Saharan Africa
SYR,Syrian Arab Republic,2019,16265870694.9063,Middle East & North Africa
FJI,Fiji,2019,5223164712.00555,East Asia & Pacific
BRB,Barbados,2019,4822013073.75235,Latin America & Caribbean
NIC,Nicaragua,2019,12991624156.9782,Latin America & Caribbean
GHA,Ghana,2019,62465709576.1815,Sub-Saharan Africa
UKR,Ukraine,2019,101944109453.562,Europe & Central Asia
SMR,San Marino,2019,1514041111.68851,Europe & Central Asia
PRE,Pre-demographic dividend,2019,1450630111014.12,
POL,Poland,2019,570115134633.24,Europe & Central Asia
SUR,Suriname,2019,5252729241.66594,Latin America & Caribbean
ITA,Italy,2019,1915994931005.09,Europe & Central Asia
IDA,IDA total,2019,2351178159930.13,
VIR,Virgin Islands (U.S.),2019,3835985859.12487,Latin America & Caribbean
SSF,Sub-Saharan Africa,2019,1834643244102.56,
OED,OECD members,2019,51615069476329.7,
ROU,Romania,2019,217382984916.126,Europe & Central Asia
IRN,"Iran, Islamic Rep.",2019,396745289342.132,Middle East & North Africa
UGA,Uganda,2019,3

2025-01-19 07:57:43 - root - INFO - SQL:
SELECT region, COUNT(DISTINCT country_code) AS country_count
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   WHERE region IS NOT NULL AND region != ''
   GROUP BY region
   LIMIT 1000;
Results:
region,country_count
Europe & Central Asia,58
North America,3
Latin America & Caribbean,42
East Asia & Pacific,37
Sub-Saharan Africa,48
Middle East & North Africa,21
South Asia,8

2025-01-19 07:57:45 - root - INFO - SQL:
SELECT i.country_name, i.value AS gdp_2019
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS i
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS c
   ON i.country_code = c.country_code
   WHERE i.indicator_code = 'NY.GDP.MKTP.KD' AND i.year = 2019
     AND c.region = 'Europe & Central Asia'
   LIMIT 1000;
Results:
country_name,gdp_2019
Turkmenistan,45710025776.6731
Austria,414257026093.423
Germany,3598891541091.34
Slovenia,50249892617.4104
Kazakhstan,211106972039.014
Portugal,222272974069.03
United Kingdom,3191493407624.4
Czech Republic,215594735504.853
Latvia,30716038078.95
Azerbaijan,53612524527.3911
Luxembourg,67286460381.3888
Greece,203669187367.386
Finland,254637296103.695
Lithuania,48155059559.2863
Croatia,57190160216.5408
Albania,12970913827.5704
Monaco,7080667991.59357
Georgia,17757903230.0709
Montenegro,4777636043.80572
Estonia,27068147756.8566
Ukraine,101944109453.562
San Marino,1514041111.68851
Poland,570115134633.24
Italy,1915994931005.09
Romania,217382984916.126
Belarus,59013474192.6442
Moldova,9155458065.71175
Spain,1324028319783.9
Kosovo,7547420630.10043
Netherlands,839912581383.842
Turkey,997437115405.82
Tajikistan,10943735892.3235
Greenland,2710570656.36234
Cyprus,24880804888.1512
Norway,406468037614.963
Bulgaria,57443866470.1882
Armenia,12867495686.1153
Bosnia and Herzegovina,18413845946.1771
Iceland,20847341424.8856
Serbia,45615675379.6018
Uzbekistan,106161435002.412
Denmark,334638192450.446
Belgium,494644115983.888
Hungary,146968695014.007
Russian Federation,1459189098326.43
Slovak Republic,99048285215.7697
Kyrgyz Republic,7920624102.90056
Switzerland,758167874591.909
North Macedonia,11185489898.549
France,2615760319962.67
Ireland,370632118369.555
Isle of Man,8129451489.68678
Andorra,3008955096.59511
Sweden,549821281946.735

2025-01-19 07:57:47 - root - INFO - SQL:
SELECT c.region, APPROX_QUANTILES(i.value, 2)[OFFSET(1)] AS median_gdp
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS i
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS c
   ON i.country_code = c.country_code
   WHERE i.indicator_code = 'NY.GDP.MKTP.KD' AND i.year = 2019
   GROUP BY c.region
   LIMIT 1000;
Results:
region,median_gdp
Sub-Saharan Africa,12212118177.9725
,3431466032627.32
East Asia & Pacific,14174566299.8985
Europe & Central Asia,59013474192.6442
Middle East & North Africa,83053174485.8283
Latin America & Caribbean,22587789317.2434
North America,1696163077026.08
South Asia,30605291409.0891

2025-01-19 07:57:48 - root - INFO - SQL:
SELECT DISTINCT year
    FROM `bigquery-public-data.world_bank_wdi.indicators_data`
    WHERE indicator_code = 'NY.GDP.MKTP.KD'
    ORDER BY year DESC
    LIMIT 1000;
Results:
year
2020
2019
2018
2017
2016
2015
2014
2013
2012
2011
2010
2009
2008
2007
2006
2005
2004
2003
2002
2001
2000
1999
1998
1997
1996
1995
1994
1993
1992
1991
1990
1989
1988
1987
1986
1985
1984
1983
1982
1981
1980
1979
1978
1977
1976
1975
1974
1973
1972
1971
1970
1969
1968
1967
1966
1965
1964
1963
1962
1961
1960

2025-01-19 07:58:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 07:58:08 - root - INFO - ```sql
SELECT series_code, indicator_name, long_definition
FROM `bigquery-public-data.world_bank_wdi.series_summary`
WHERE series_code = 'NY.GDP.MKTP.KD'
LIMIT 1000;
```
2025-01-19 07:59:20 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 07:59:20 - root - INFO - SQL:
SELECT series_code, indicator_name, long_definition
FROM `bigquery-public-data.world_bank_wdi.series_summary`
WHERE series_code = 'NY.GDP.MKTP.KD'
LIMIT 1000;
Results:
series_code,indicator_name,long_definition
NY.GDP.MKTP.KD,GDP (constant 2015 US$),"GDP at purchaser's prices is the sum of gross value added by all resident producers in the economy plus any product taxes and minus any subsidies not included in the value of the products. It is calculated without making deductions for depreciation of fabricated assets or for depletion and degradation of natural resources. Data are in constant 2015 prices, expressed in U.S. dollars. Dollar figures for GDP are converted from domestic currencies using 2015 official exchange rates. For a few countries where the official exchange rate does not reflect the rate effectively applied to actual foreign exchange transactions, an alternative conversion factor is used."

2025-01-19 07:59:22 - root - INFO - SQL:
SELECT i.country_code, c.short_name AS country_name, i.indicator_code, i.year, i.value
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS i
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS c
ON i.country_code = c.country_code
WHERE i.indicator_code = 'NY.GDP.MKTP.KD'
LIMIT 1000
Results:
Too long, hard cut:
country_code,country_name,indicator_code,year,value
MMR,Myanmar,NY.GDP.MKTP.KD,1968,3766485577.12378
NAM,Namibia,NY.GDP.MKTP.KD,1998,5242128224.00169
NPL,Nepal,NY.GDP.MKTP.KD,1962,3447314854.82201
NPL,Nepal,NY.GDP.MKTP.KD,2006,16439932516.5831
BRN,Brunei,NY.GDP.MKTP.KD,2009,12665627056.3659
BGR,Bulgaria,NY.GDP.MKTP.KD,1985,35814094910.805
BGR,Bulgaria,NY.GDP.MKTP.KD,1987,39580615170.2135
BDI,Burundi,NY.GDP.MKTP.KD,1982,1712247647.29676
LAC,Latin America & Caribbean (excluding high income),NY.GDP.MKTP.KD,1997,2846009420300.99
LMY,Low & middle income,NY.GDP.MKTP.KD,2007,17586878384858.0
LMC,Lower middle income,NY.GDP.MKTP.KD,1965,771275616651.188
LMC,Lower middle income,NY.GDP.MKTP.KD,1990,2122313482158.37
LMC,Lower middle income,NY.GDP.MKTP.KD,2002,3194038992245.53
MEA,Middle East & North Africa,NY.GDP.MKTP.KD,2020,3243739545284.98
MNA,Middle East & North Africa (excluding high income),NY.GDP.MKTP.KD,1980,419562499542.787
DMA,Dominica,NY.GDP.MKTP.KD,1978,234352173.555526
LVA,Latvia,NY.GDP.MKTP.KD,2007,29002363545.9676
LSO,Lesotho,NY.GDP.MKTP.KD,2004,1612096000.49548
WSM,Samoa,NY.GDP.MKTP.KD,1982,409723388.389005
OMN,Oman,NY.GDP.MKTP.KD,1983,18925617927.7435
CAF,Central African Republic,NY.GDP.MKTP.KD,1965,1013697584.80447
COM,Comoros,NY.GDP.MKTP.KD,1997,563886119.709676
WLD,World,NY.GDP.MKTP.KD,2000,48146683077384.4
DZA,Algeria,NY.GDP.MKTP.KD,1961,20733849882.3774
DZA,Algeria,NY.GDP.MKTP.KD,2006,126495413069.533
TMN,Middle East & North Africa (IDA & IBRD),NY.GDP.MKTP.KD,2004,992580883046.924
NAC,North America,NY.GDP.MKTP.KD,1992,10929544482336.9
PSS,Pacific island small states,NY.GDP.MKTP.KD,2005,7231294470.42854
PST,Post-demographic dividend,NY.GDP.MKTP.KD,1963,9889377686297.1
FIN,Finland,NY.GDP.MKTP.KD,1960,50589519083.7226
FIN,Finland,NY.GDP.MKTP.KD,1987,140069588805.624
FIN,Finland,NY.GDP.MKTP.KD,2002,204568476382.962
FRA,France,NY.GDP.MKTP.KD,1976,1148593347439.08
FRA,France,NY.GDP.MKTP.KD,1990,1660423065362.52
GAB,Gabon,NY.GDP.MKTP.KD,2019,15460241608.8257
EMU,Euro area,NY.GDP.MKTP.KD,1997,9036375850461.54
EMU,Euro area,NY.GDP.MKTP.KD,2009,10965349872015.8
HIC,High income,NY.GDP.MKTP.KD,1978,19407887392109.1
HIC,High income,NY.GDP.MKTP.KD,1985,23196833368009.8
MDG,Madagascar,NY.GDP.MKTP.KD,2018,12629254614.1071
MLT,Malta,NY.GDP.MKTP.KD,1985,2646361034.06191
MHL,Marshall Islands,NY.GDP.MKTP.KD,2007,175092500.0
MRT,Mauritania,NY.GDP.MKTP.KD,1963,1051184411.5989
MRT,Mauritania,NY.GDP.MKTP.KD,1985,2488366451.23844
SGP,Singapore,NY.GDP.MKTP.KD,1962,6911841722.43236
SXM,Sint Maarten (Dutch part),NY.GDP.MKTP.KD,2018,1108000824.03352
ESP,Spain,NY.GDP.MKTP.KD,2010,1196670854394.8
PRI,Puerto Rico,NY.GDP.MKTP.KD,1986,58362843987.8155
COG,Congo,NY.GDP.MKTP.KD,1964,1423661535.42456
CUB,Cuba,NY.GDP.MKTP.KD,2015,87133000000.0
CUW,Curaçao,NY.GDP.MKTP.KD,2011,3209266564.04194
CZE,Czech Republic,NY.GDP.MKTP.KD,1990,120142052583.973
GUY,Guyana,NY.GDP.MKTP.KD,1969,2110018751.87545
GUY,Guyana,NY.GDP.MKTP.KD,1971,2268286484.8283
HUN,Hungary,NY.GDP.MKTP.KD,2009,111923227694.593
ISL,Iceland,NY.GDP.MKTP.KD,2014,16773046835.507
ISL,Iceland,NY.GDP.MKTP.KD,2016,18621440660.0019
SAS,South Asia,NY.GDP.MKTP.KD,1976,328162729613.475
SSF,Sub-Saharan Africa,NY.GDP.MKTP.KD,1989,647798062253.99
SSA,Sub-Saharan Africa (excluding high income),NY.GDP.MKTP.KD,1970,399355844595.27
UMC,Upper middle income,NY.GDP.MKTP.KD,1960,1315490536908.03
UMC,Upper middle income,NY.GDP.MKTP.KD,1963,1409668204817.16
AUS,Australia,NY.GDP.MKTP.KD,1971,349823081605.576
AUT,Austria,NY.GDP.MKTP.KD,1967,114458318906.485
AUT,Austria,NY.GDP.MKTP.KD,2016,389413586441.667
AZE,Azerbaijan,NY.GDP.MKTP.KD,2001,13097901809.4266
AZE,Azerbaijan,NY.GDP.MKTP.KD,2017,51531923130.9779
BGD,Bangladesh,NY.GDP.MKTP.KD,1998,75731164300.4426
BLR,Belarus,NY.GDP.MKTP.KD,1991,29099127258.7491
SUR,Suriname,NY.GDP.MKTP.KD,1998,2901533087.48207
CHE,Switzerland,NY.GDP.MKTP.KD,2009,621539124455.347
SYR,Syrian Arab Republic,NY.GDP.MKTP.KD,1990,11619961705.0846
IBT,IDA & IBRD total,NY.GDP.MKTP.KD,2017,30551204405315.5
IDB,IDA blend,NY.GDP.MKTP.KD,1960,112826602868.049
LCN,Latin America & Caribbean,NY.GDP.MKTP.KD,1965,922462437781.724
GMB,The Gambia,NY.GDP.MKTP.KD,2011,1240786424.0015
GEO,Georgia,NY.GDP.MKTP.KD,1979,16928230216.586
GEO,Georgia,NY.GDP.MKTP.KD,1987,20399949704.5182
GEO,Georgia,NY.GDP.MKTP.KD,2009,11050871061.5608
GEO,Georgia,NY.GDP.MKTP.KD,2010,11741493896.7964
GEO,Georgia,NY.GDP.MKTP.KD,2016,15388577975.5872
GRL,Greenland,NY.GDP.MKTP.KD,1985,1326357012.1974
GRL,Greenland,NY.GDP.MKTP.KD,1996,1496590669.3289
TZA,Tanzania,NY.GDP.MKTP.KD,2012,39158481311.5869
MDA,Moldova,NY.GDP.MKTP.KD,2016,8086710150.73289
MDA,Moldova,NY.GDP.MKTP.KD,2017,8466041015.96707
BLZ,Belize,NY.GDP.MKTP.KD,1992,737285247.043466
BEN,Benin,NY.GDP.MKTP.KD,1976,2380844444.63745
BWA,Botswana,NY.GDP.MKTP.KD,1962,203905557.028968
IRN,Iran,NY.GDP.MKTP.KD,1984,178472196717.133
ISR,Israel,NY.GDP.MKTP.KD,1999,166031729085.374
JAM,Jamaica,NY.GDP.MKTP.KD,1976,9113027630.31234
ARE,United Arab Emirates,NY.GDP.MKTP.KD,1988,9

2025-01-19 07:59:24 - root - INFO - SQL:
SELECT i.country_code, c.short_name AS country_name, i.year, i.value
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS i
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS c
ON i.country_code = c.country_code
WHERE i.indicator_code = 'NY.GDP.MKTP.KD' AND i.year = 2019
LIMIT 1000
Results:
Too long, hard cut:
country_code,country_name,year,value
EUU,European Union,2019,14765116523492.0
BRN,Brunei,2019,13278836553.322
ZMB,Zambia,2019,24089861649.0155
HTI,Haiti,2019,15474153940.1499
TJK,Tajikistan,2019,10943735892.3235
BEN,Benin,2019,14179807326.7156
MAC,"Macao SAR, China",2019,51073940150.1338
TMN,Middle East & North Africa (IDA & IBRD),2019,1522371834048.04
VCT,St. Vincent and the Grenadines,2019,798469518.407039
TZA,Tanzania,2019,60318543760.5445
GRL,Greenland,2019,2710570656.36234
LSO,Lesotho,2019,2329753748.89367
EAP,East Asia & Pacific (excluding high income),2019,17016933263759.9
MDV,Maldives,2019,5414217823.03808
CYP,Cyprus,2019,24880804888.1512
CAN,Canada,2019,1696163077026.08
PLW,Palau,2019,265597626.615969
MHL,Marshall Islands,2019,212388500.0
JAM,Jamaica,2019,14934128282.7371
NRU,Nauru,2019,89620006.418409
NOR,Norway,2019,406468037614.963
CUB,Cuba,2019,91019611431.1927
JPN,Japan,2019,4591290538384.75
AFG,Afghanistan,2019,21118462796.7609
BFA,Burkina Faso,2019,15001629028.4851
GNQ,Equatorial Guinea,2019,9998462337.55955
BGR,Bulgaria,2019,57443866470.1882
EAS,East Asia & Pacific,2019,26302619575881.9
MLI,Mali,2019,16028741076.2588
LBN,Lebanon,2019,46777216084.3953
SOM,Somalia,2019,6900727625.84454
ATG,Antigua and Barbuda,2019,1630215842.3024
HKG,"Hong Kong SAR, China",2019,331749697713.935
TCD,Chad,2019,10526057266.1328
ARM,Armenia,2019,12867495686.1153
HIC,High income,2019,52180038375130.5
BIH,Bosnia and Herzegovina,2019,18413845946.1771
TLA,Latin America & Caribbean (IDA & IBRD),2019,5369907031287.5
SLB,Solomon Islands,2019,1533613348.9277
ISL,Iceland,2019,20847341424.8856
SGP,Singapore,2019,348909586848.996
SST,Small states,2019,486912648101.75
GUM,Guam,2019,5966796360.32757
SRB,Serbia,2019,45615675379.6018
MNP,Northern Mariana Islands,2019,1037951515.15152
WLD,World,2019,84612027798062.6
PSS,Pacific island small states,2019,10138908192.4612
FCS,Fragile and conflict affected situations,2019,1720631743301.35
BGD,Bangladesh,2019,261518503633.701
GMB,The Gambia,2019,1676447055.8329
TUV,Tuvalu,2019,42824596.8653884
UZB,Uzbekistan,2019,106161435002.412
MRT,Mauritania,2019,7336133809.76738
DNK,Denmark,2019,334638192450.446
CYM,Cayman Islands,2019,5425515180.60722
BEL,Belgium,2019,494644115983.888
COD,Dem. Rep. Congo,2019,44487657807.0092
PRI,Puerto Rico,2019,96423791493.1329
NZL,New Zealand,2019,200742824665.702
HUN,Hungary,2019,146968695014.007
LBY,Libya,2019,40473930298.8275
AFW,Africa Western and Central,2019,827963431037.275
CEB,Central Europe and the Baltics,2019,1519932999983.23
RUS,Russia,2019,1459189098326.43
SVK,Slovak Republic,2019,99048285215.7697
KGZ,Kyrgyz Republic,2019,7920624102.90056
MIC,Middle income,2019,31663365601529.3
CHE,Switzerland,2019,758167874591.909
LCN,Latin America & Caribbean,2019,5596468714863.74
VNM,Vietnam,2019,251208952743.671
KIR,Kiribati,2019,195759870.68938
MKD,North Macedonia,2019,11185489898.549
ASM,American Samoa,2019,628818320.610687
GUY,Guyana,2019,5071041645.23612
IBT,IDA & IBRD total,2019,33299134680470.5
MUS,Mauritius,2019,13471938135.6172
CHN,China,2019,14296238286985.1
COM,Comoros,2019,1092787840.36505
ECS,Europe & Central Asia,2019,22365520285914.6
CIV,Côte d'Ivoire,2019,59861589342.7008
FSM,Micronesia,2019,332458532.270118
STP,São Tomé and Principe,2019,359752972.346268
IRQ,Iraq,2019,202613535336.009
PST,Post-demographic dividend,2019,48381584694878.9
KNA,St. Kitts and Nevis,2019,1136818536.07058
BMU,Bermuda,2019,6851270046.39601
BWA,Botswana,2019,16188225469.2536
PSE,West Bank and Gaza,2019,15829000000.0
CUW,Curaçao,2019,2898092042.62992
DMA,Dominica,2019,568298267.854584
LBR,Liberia,2019,3211334057.92828
LCA,St. Lucia,2019,1995116519.64915
FRA,France,2019,2615760319962.67
SLE,Sierra Leone,2019,5076711739.04284
PNG,Papua New Guinea,2019,24719859152.6631
SSA,Sub-Saharan Africa (excluding high income),2019,1833089644759.92
TLS,Timor-Leste,2019,1896767581.03646
DZA,Algeria,2019,177180346401.967
EMU,Euro area,2019,12615961472339.9
IRL,Ireland,2019,370632118369.555
IMN,Isle of Man,2019,8129451489.68678
MEA,Middle East & North Africa,2019,3378463990503.43
RWA,Rwanda,2019,11182411389.0747
IBD,IBRD only,2019,30947573002709.4
CPV,Cabo Verde,2019,1915123782.86887
SYC,Seychelles,2019,1553599342.64266
LMY,Low & middle income,2019,32139450441501.1
SWZ,Eswatini,2019,4401077165.65255
BHR,Bahrain,2019,34985241938.6953
ZWE,Zimbabwe,2019,20720841373.1335
NPL,Nepal,2019,30605291409.0891
ARE,United Arab Emirates,2019,395103837869.753
NER,Niger,2019,12212118177.9725
LMC,Lower middle income,2019,7796543762641.46
AND,Andorra,2019,3008955096.59511
AUS,Australia,2019,1491025040336.15
GRD,Grenada,2019,1134931073.15504
BOL,Bolivia,2019,38193230057.6737
BRA,Brazil,2019,1823105452462.95
CHL,Chile,2019,262807032486.856
ECU,Ecuador,2019,101702140245.144
EGY,Egypt,2019,398037429245.42
GTM,Guatemala,2019,70634110391.9779
HND,Honduras,2019,24191028957.12
JOR,Jordan,2019,41755867661.2459
KEN,Kenya,2019,84125098675.5269
KOR,Korea,2019,1637850078348.95
LKA,Sri Lanka,2019,92119992734.643
MAR,Mor

2025-01-19 07:59:26 - root - INFO - SQL:
SELECT c.short_name AS country_name, i.year, i.value AS gdp_value
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS i
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS c
ON i.country_code = c.country_code
WHERE i.indicator_code = 'NY.GDP.MKTP.KD' AND i.year BETWEEN 2015 AND 2019
LIMIT 1000
Results:
Too long, hard cut:
country_name,year,gdp_value
Gabon,2019,15460241608.8257
Madagascar,2018,12629254614.1071
Sint Maarten (Dutch part),2018,1108000824.03352
Cuba,2015,87133000000.0
Iceland,2016,18621440660.0019
Austria,2016,389413586441.667
Azerbaijan,2017,51531923130.9779
IDA & IBRD total,2017,30551204405315.5
Georgia,2016,15388577975.5872
Moldova,2016,8086710150.73289
Moldova,2017,8466041015.96707
United States,2017,18983157920000.0
West Bank and Gaza,2016,15211000000.0
Namibia,2019,11240759011.0283
Low income,2016,427446175467.343
Andorra,2016,2893365390.02848
Angola,2019,110072586683.261
Aruba,2015,2962905027.93296
Middle income,2017,29042563515612.0
France,2017,2521399210474.97
St. Vincent and the Grenadines,2017,777437601.296596
Sudan,2019,51312429477.3951
Late-demographic dividend,2017,20315731121406.6
Georgia,2015,14953950557.4406
Ireland,2018,353262191749.526
Kenya,2018,80133540731.9138
Myanmar,2018,78394970758.0075
Middle East & North Africa (excluding high income),2019,1538200834048.04
Liberia,2015,3227075700.0
Africa Eastern and Southern,2019,1006679813065.29
Rwanda,2017,9408703403.70819
Northern Mariana Islands,2015,910000000.0
Palau,2016,280223900.0
Andorra,2015,2789870187.50693
Finland,2018,251566290193.7
The Gambia,2018,1579264906.00789
Middle East & North Africa,2015,3095509625416.13
Other small states,2016,380987136090.051
European Union,2015,13547247755711.5
Malta,2017,12482577842.4421
IDA & IBRD total,2018,32024673679121.9
Tonga,2019,486181549.588749
Mongolia,2015,11619892396.0767
Turkmenistan,2019,45710025776.6731
Kenya,2016,73074948912.6476
Lithuania,2018,46048888511.4844
Early-demographic dividend,2019,11703037495097.2
Serbia,2017,41840962435.9212
Eswatini,2015,4063245671.29285
Marshall Islands,2015,183814300.0
Qatar,2019,167371229308.42
Czech Republic,2015,188033050459.881
Late-demographic dividend,2018,21411581269969.1
Tanzania,2017,54067877695.7031
United Kingdom,2016,3023494748188.97
Kazakhstan,2016,186416704902.17
Europe & Central Asia (IDA & IBRD),2019,4095463099662.97
Somalia,2018,6384748042.2603
Guinea,2018,11433119038.1247
Guyana,2016,4442813034.63534
Hungary,2017,133416713057.02
Austria,2019,414257026093.423
Switzerland,2016,716509848990.836
Ireland,2017,324004099585.745
Turkmenistan,2016,38019296559.4106
Uganda,2018,37204541627.5275
Latin America & Caribbean (IDA & IBRD),2018,5327267303713.92
Equatorial Guinea,2018,10634279180.0445
Kyrgyz Republic,2016,6967734531.18414
Rwanda,2016,9048893196.08725
Nigeria,2019,502942019447.736
Singapore,2015,308004146057.608
Bahrain,2015,31050638297.8723
Bangladesh,2015,195078678697.23
IDA total,2015,2016489528845.36
Germany,2019,3598891541091.34
Monaco,2015,6261622101.40908
Mozambique,2019,18183590595.087
United Kingdom,2018,3139010897079.7
Zimbabwe,2015,19963120600.0
Zimbabwe,2017,21061283685.9496
Luxembourg,2015,60047430684.2639
Africa Western and Central,2016,761700338996.091
Caribbean small states,2017,72471555398.1925
East Asia & Pacific (excluding high income),2016,14154938722611.4
Chad,2017,9958586245.45557
China,2018,13493418449040.5
Comoros,2017,1036193131.26528
Post-demographic dividend,2016,45430131344849.4
Upper middle income,2018,22922203217852.0
The Bahamas,2015,11890600000.0
Bangladesh,2017,224176245316.101
Tajikistan,2016,8842184615.904
Kuwait,2015,114567298105.683
New Caledonia,2015,8738203041.54819
Djibouti,2015,2430274292.2896
Lao PDR,2019,18491845636.2733
Libya,2015,27842131479.8726
East Asia & Pacific,2017,24133820672087.7
Euro area,2015,11669741216577.3
Malta,2019,13856372628.2222
Sint Maarten (Dutch part),2015,1253072625.69832
Slovenia,2015,43090173394.6913
Romania,2017,199708413252.137
Grenada,2016,1034292546.66362
Isle of Man,2017,7933191749.42704
Vietnam,2018,234736473566.404
Early-demographic dividend,2015,10082377974481.9
East Asia & Pacific (IDA & IBRD),2015,13264224627407.0
Seychelles,2016,1440344964.02941
North Macedonia,2018,10764550800.8128
Sint Maarten (Dutch part),2017,1186296385.47486
Puerto Rico,2016,102069864411.212
Croatia,2016,51935173677.1936
Small states,2015,452206885980.765
Sub-Saharan Africa,2018,1788553116078.23
Switzerland,2015,702149580770.901
Italy,2017,1890662182181.27
United Arab Emirates,2015,358135057862.492
Kosovo,2018,7204705015.86419
Namibia,2018,11341482622.8834
Djibouti,2016,2591951944.03089
Samoa,2019,887495263.360233
Andorra,2017,2903378514.30766
Heavily indebted poor countries (HIPC),2019,788661392496.297
High income,2018,51275691253852.4
Madagascar,2019,13186360351.4331
Slovenia,2019,50249892617.4104
Guam,2017,5861264058.23476
Kazakhstan,2019,211106972039.014
Kenya,2015,70120413328.7838
Niger,2018,11527239152.5743
Lower middle income,2016,6842018337137.11
Portugal,2019,222272974069.03
Guyana,2018,4813398364.26896
Hungary,2018,140567177109.717
Sudan,2015,51726758676.7677
Burkina Faso,2018,14194244080.5891
Northern Mariana Islands,2017,1448278787.87879
Chad,2016,10265387468.6306
Fiji,2016,4797065664.45005
"Macao SAR, China",2018,52389965631.9723
Spain,2017,1267962775991.18
Croatia,2018,55265833941.43

2025-01-19 07:59:26 - root - INFO - itercount: 0
2025-01-19 07:59:26 - root - INFO - Database Name: bigquery-public-data
Schema Name: world_bank_global_population
DDL describes table information.
,0
table_name,population_by_country
ddl,"CREATE TABLE `bigquery-public-data.world_bank_global_population.population_by_country`
(
  country STRING,
  country_code STRING,
  year_1960 INT64,
  year_1961 INT64,
  year_1962 INT64,
  year_1963 INT64,
  year_1964 INT64,
  year_1965 INT64,
  year_1966 INT64,
  year_1967 INT64,
  year_1968 INT64,
  year_1969 INT64,
  year_1970 INT64,
  year_1971 INT64,
  year_1972 INT64,
  year_1973 INT64,
  year_1974 INT64,
  year_1975 INT64,
  year_1976 INT64,
  year_1977 INT64,
  year_1978 INT64,
  year_1979 INT64,
  year_1980 INT64,
  year_1981 INT64,
  year_1982 INT64,
  year_1983 INT64,
  year_1984 INT64,
  year_1985 INT64,
  year_1986 INT64,
  year_1987 INT64,
  year_1988 INT64,
  year_1989 INT64,
  year_1990 INT64,
  year_1991 INT64,
  year_1992 INT64,
  year_1993 INT64,
  year_1994 INT64,
  year_1995 INT64,
  year_1996 INT64,
  year_1997 INT64,
  year_1998 INT64,
  year_1999 INT64,
  year_2000 INT64,
  year_2001 INT64,
  year_2002 INT64,
  year_2003 INT64,
  year_2004 INT64,
  year_2005 INT64,
  year_2006 INT64,
  year_2007 INT64,
  year_2008 INT64,
  year_2009 INT64,
  year_2010 INT64,
  year_2011 INT64,
  year_2012 INT64,
  year_2013 INT64,
  year_2014 INT64,
  year_2015 INT64,
  year_2016 INT64,
  year_2017 INT64,
  year_2018 INT64,
  year_2019 INT64
)
PARTITION BY DATE(_PARTITIONTIME);"

Database Name: bigquery-public-data
Schema Name: world_bank_health_population
DDL describes table information.
,0
table_name,series_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.series_summary`
(
  series_code STRING,
  topic STRING,
  indicator_name STRING,
  short_definition STRING,
  long_definition STRING,
  unit_of_measure STRING,
  periodicity STRING,
  base_period INT64,
  other_notes STRING,
  aggregation_method STRING,
  limitations_and_exceptions STRING,
  notes_from_original_source STRING,
  general_comments STRING,
  source STRING,
  statistical_concept_and_methodology STRING,
  development_relevance STRING,
  related_source_links STRING,
  other_web_links STRING,
  related_indicators STRING,
  license_type STRING
)
OPTIONS(
  description=""Series Summary table""
);"

,1
table_name,country_series_definitions
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.country_series_definitions`
(
  country_code STRING,
  series_code STRING,
  description STRING
)
OPTIONS(
  description=""Country Series Definition table""
);"

,2
table_name,series_times
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.series_times`
(
  series_code STRING,
  year INT64,
  description STRING
)
OPTIONS(
  description=""Series Times table""
);"

,3
table_name,country_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.country_summary`
(
  country_code STRING,
  short_name STRING,
  table_name STRING,
  long_name STRING,
  two_alpha_code STRING,
  currency_unit STRING,
  special_notes STRING,
  region STRING,
  income_group STRING,
  wb_2_code STRING,
  national_accounts_base_year STRING,
  national_accounts_reference_year STRING,
  sna_price_valuation STRING,
  lending_category STRING,
  other_groups STRING,
  system_of_national_accounts STRING,
  alternative_conversion_factor STRING,
  ppp_survey_year STRING,
  balance_of_payments_manual_in_use STRING,
  external_debt_reporting_status STRING,
  system_of_trade STRING,
  government_accounting_concept STRING,
  imf_data_dissemination_standard STRING,
  latest_population_census STRING,
  latest_household_survey STRING,
  source_of_most_recent_income_and_expenditure_data STRING,
  vital_registration_complete STRING,
  latest_agricultural_census STRING,
  latest_industrial_data INT64,
  latest_trade_data INT64
)
OPTIONS(
  description=""Country Summary table""
);"

,4
table_name,health_nutrition_population
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.health_nutrition_population`
(
  country_name STRING OPTIONS(description=""""),
  country_code STRING OPTIONS(description=""""),
  indicator_name STRING OPTIONS(description=""""),
  indicator_code STRING OPTIONS(description=""""),
  value FLOAT64 OPTIONS(description=""""),
  year INT64 OPTIONS(description="""")
);"

Database Name: bigquery-public-data
Schema Name: world_bank_intl_debt
DDL describes table information.
,0
table_name,series_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.series_summary`
(
  series_code STRING,
  topic STRING,
  indicator_name STRING,
  short_definition STRING,
  long_definition STRING,
  unit_of_measure STRING,
  periodicity STRING,
  base_period STRING,
  other_notes STRING,
  aggregation_method STRING,
  limitations_and_exceptions STRING,
  notes_from_original_source STRING,
  general_comments STRING,
  source STRING,
  statistical_concept_and_methodology STRING,
  development_relevance STRING,
  related_source_links STRING,
  other_web_links STRING,
  related_indicators STRING,
  license_type STRING
)
OPTIONS(
  description=""Series Summary table""
);"

,1
table_name,country_series_definitions
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.country_series_definitions`
(
  country_code STRING,
  series_code STRING,
  description STRING
)
OPTIONS(
  description=""Country Series Definition table""
);"

,2
table_name,series_times
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.series_times`
(
  series_code STRING,
  year INT64,
  description STRING
)
OPTIONS(
  description=""Series Times table""
);"

,3
table_name,country_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.country_summary`
(
  country_code STRING,
  short_name STRING,
  table_name STRING,
  long_name STRING,
  two_alpha_code STRING,
  currency_unit STRING,
  special_notes STRING,
  region STRING,
  income_group STRING,
  wb_2_code STRING,
  national_accounts_base_year STRING,
  national_accounts_reference_year STRING,
  sna_price_valuation STRING,
  lending_category STRING,
  other_groups STRING,
  system_of_national_accounts STRING,
  alternative_conversion_factor STRING,
  ppp_survey_year STRING,
  balance_of_payments_manual_in_use STRING,
  external_debt_reporting_status STRING,
  system_of_trade STRING,
  government_accounting_concept STRING,
  imf_data_dissemination_standard STRING,
  latest_population_census STRING,
  latest_household_survey STRING,
  source_of_most_recent_Income_and_expenditure_data STRING,
  vital_registration_complete STRING,
  latest_agricultural_census STRING,
  latest_industrial_data INT64,
  latest_trade_data INT64,
  latest_water_withdrawal_data STRING
)
OPTIONS(
  description=""Country Summary table""
);"

,4
table_name,international_debt
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.international_debt`
(
  country_name STRING OPTIONS(description=""""),
  country_code STRING OPTIONS(description=""""),
  indicator_name STRING OPTIONS(description=""""),
  indicator_code STRING OPTIONS(description=""""),
  value FLOAT64 OPTIONS(description=""""),
  year INT64 OPTIONS(description="""")
);"

Database Name: bigquery-public-data
Schema Name: world_bank_intl_education
DDL describes table information.
,0
table_name,series_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_education.series_summary`
(
  series_code STRING,
  topic STRING,
  indicator_name STRING,
  short_definition STRING,
  long_definition STRING,
  unit_of_measure STRING,
  periodicity STRING,
  base_period STRING,
  other_notes STRING,
  aggregation_method STRING,
  limitations_and_exceptions STRING,
  notes_from_original_source STRING,
  general_comments STRING,
  source STRING,
  statistical_concept_and_methodology STRING,
  development_relevance STRING,
  related_source_links STRING,
  other_web_links STRING,
  related_indicators STRING,
  license_type STRING
)
OPTIONS(
  description=""Series Summary table""
);"

,1
table_name,country_series_definitions
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_education.country_series_definitions`
(
  country_code STRING,
  series_code STRING,
  description STRING
)
OPTIONS(
  description=""Country Series Definition table""
);"

,2
table_name,international_education
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_education.international_education`
(
  country_name STRING OPTIONS(description=""""),
  country_code STRING OPTIONS(description=""""),
  indicator_name STRING OPTIONS(description=""""),
  indicator_code STRING OPTIONS(description=""""),
  value FLOAT64 OPTIONS(description=""""),
  year INT64 OPTIONS(description="""")
);"

,3
table_name,country_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_education.country_summary`
(
  country_code STRING,
  short_name STRING,
  table_name STRING,
  long_name STRING,
  two_alpha_code STRING,
  currency_unit STRING,
  special_notes STRING,
  region STRING,
  income_group STRING,
  wb_two_code STRING,
  national_accounts_base_year STRING,
  national_accounts_reference_year STRING,
  sna_price_valuation STRING,
  lending_category STRING,
  other_groups STRING,
  system_of_national_accounts STRING,
  alternative_conversion_factor STRING,
  ppp_survey_year STRING,
  balance_of_payments_manual_in_use STRING,
  external_debt_reporting_status STRING,
  system_of_trade STRING,
  government_accounting_concept STRING,
  imf_data_dissemination_standard STRING,
  latest_population_census STRING,
  latest_household_survey STRING,
  source_of_most_recent_income_and_expenditure_data STRING,
  vital_registration_complete STRING,
  latest_agricultural_census STRING,
  latest_industrial_data INT64,
  latest_trade_data INT64,
  latest_water_withdrawal_data STRING
)
OPTIONS(
  description=""Country Summary table""
);"

Database Name: bigquery-public-data
Schema Name: world_bank_wdi
DDL describes table information.
,0
table_name,series_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.series_summary`
(
  series_code STRING OPTIONS(description=""A number or a sequence of related statistical units arranged or occurring in temporal spatial or other order or succession. WDI carries mostly time series.""),
  topic STRING OPTIONS(description=""The matter dealt with in the context discourse or subject related to the series.""),
  indicator_name STRING OPTIONS(description=""Given name of a series.""),
  short_definition STRING OPTIONS(description=""Short statement of the exact meaning of a series.""),
  long_definition STRING OPTIONS(description=""Extended statement of the exact meaning of a series.""),
  unit_of_measure STRING OPTIONS(description=""A quantity used as a standard of measurement. Example: Units of time are second minute hour day week month year and decade.""),
  periodicity STRING OPTIONS(description=""Applies to series recurring at regular intervals. Most of the time this term denotes that interval of recurrence.""),
  base_period STRING OPTIONS(description=""Base period is the period of time for which data is used as the base of an index number or other ratio have been collected. This period is frequently one of a year but it may be as short as one day or as long as the average of a group of years.""),
  other_notes STRING OPTIONS(description=""A brief record of facts topics or thoughts written down and used to contextualize the series definition values and other characteristics.""),
  aggregation_method STRING OPTIONS(description=""Aggregation methods are types of calculations used to group attribute values into a metric for each dimension value. For example for each region one may retrieve the total value of country entries (the sum of the series value for countries belonging to the region).""),
  limitations_and_exceptions STRING OPTIONS(description=""A limiting rule or circumstance that applies to usage of the series such as the scope of the survey collecting the data or missing years and countries.  It should also note when data are imputed or estimated""),
  notes_from_original_source STRING OPTIONS(description=""A brief record of facts topics or thoughts written down and used to contextualize the series definition values and other characteristics.""),
  general_comments STRING OPTIONS(description=""Other notes regarding the series which do not appear in Development relevance or Limitations or exceptions""),
  source STRING OPTIONS(description=""A place person or organization from which the series comes or can be obtained.""),
  statistical_concept_and_methodology STRING OPTIONS(description=""The abstract idea general statistical notions or a system of methods used to generate the series.""),
  development_relevance STRING OPTIONS(description=""The relevance of a series refers to how the indicator’s data may be used to monitor particular aspects of development goals and programs for example the Sustainable Development Goals. The indicator may conclusively measure progress towards a particular objective or may act as a proxy or interpretation of a development aim.""),
  related_source_links STRING OPTIONS(description=""Internet address of related source page tool or knowledge base.""),
  other_web_links STRING OPTIONS(description=""Internet addresses of related pages tools or knowledge bases.""),
  related_indicators STRING OPTIONS(description=""In general indicator that are of interest and related to the specific series.""),
  license_type STRING OPTIONS(description=""Explains the rights conferred and restrictions imposed by the owner to the users of a series"")
);"

,1
table_name,country_series_definitions
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.country_series_definitions`
(
  country_code STRING OPTIONS(description=""""),
  series_code STRING OPTIONS(description=""""),
  description STRING OPTIONS(description="""")
);"

,2
table_name,footnotes
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.footnotes`
(
  country_code STRING OPTIONS(description=""""),
  series_code STRING OPTIONS(description=""""),
  year STRING OPTIONS(description=""""),
  description STRING OPTIONS(description="""")
);"

,3
table_name,series_time
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.series_time`
(
  series_code STRING OPTIONS(description=""""),
  year INT64 OPTIONS(description=""""),
  description STRING OPTIONS(description="""")
);"

,4
table_name,indicators_data
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.indicators_data`
(
  country_name STRING OPTIONS(description=""""),
  country_code STRING OPTIONS(description=""""),
  indicator_name STRING OPTIONS(description=""""),
  indicator_code STRING OPTIONS(description=""""),
  value FLOAT64 OPTIONS(description=""""),
  year INT64 OPTIONS(description="""")
);"

,5
table_name,country_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.country_summary`
(
  country_code STRING OPTIONS(description=""A short alphabetic or numeric geographical code representing a specific country or area. In April 2016 WDI has adopted the three digit ISO code to identify countries in its databases.""),
  short_name STRING OPTIONS(description=""Country name the country's official name as approved by the relevant body (Italy is used as an example): conventional short form (Italy).""),
  table_name STRING OPTIONS(description=""Country name the country's name as approved by the relevant body (Italy is used as an example): conventional short form (Republic of Italy).""),
  long_name STRING OPTIONS(description=""Country name the country's name as approved by the relevant body (Italy is used as an example): conventional long form (Republic of Italy).""),
  two_alpha_code STRING OPTIONS(description=""ISO-2 digit alpha code value of the country. Re: www.iso.org""),
  currency_unit STRING OPTIONS(description=""Currency unit (such as the dollar euro peso rupee) issued as a coin or banknote a standard unit of value and a unit of account.""),
  special_notes STRING OPTIONS(description=""Country special notes for data and metadata users.""),
  region STRING OPTIONS(description=""World Bank region to which a country belongs.""),
  income_group STRING OPTIONS(description=""World Bank income group to which a country belongs after the country classification is completed every year.""),
  wb_2_code STRING OPTIONS(description=""World Bank 2 digit code value of the country.""),
  national_accounts_base_year STRING OPTIONS(description=""Base year is the base or pricing period used for constant price calculations in the country’s national accounts. Price indexes derived from national accounts aggregates such as the implicit deflator for gross domestic product (GDP) express the price level relative to base year prices.""),
  national_accounts_reference_year STRING OPTIONS(description=""Reference year is the year in which the local currency constant price series of a country is valued. The reference year is usually the same as the base year used to report the constant price series. However when the constant price data are chain linked the base year is changed annually so the data are rescaled to a specific reference year to provide a consistent time series. When the country has not rescaled following a change in base year World Bank staff rescale the data to maintain a longer historical series. To allow for cross-country comparison and data aggregation constant price data reported in World Development Indicators are rescaled to a common reference year (2010) and currency (U.S. dollars).""),
  sna_price_valuation STRING OPTIONS(description=""SNA price valuation shows whether value added in the national accounts is reported at basic prices (B) or producer prices (P). Producer prices include taxes paid by producers and thus tend to overstate the actual value added in production. However value added can be higher at basic prices than at producer prices in countries with high agricultural subsidies.""),
  lending_category STRING OPTIONS(description=""World Bank lending category to which a country belongs after the operational guidelines are completed every year.""),
  other_groups STRING OPTIONS(description=""Other types of grouping approved by the WDI team.""),
  system_of_national_accounts STRING OPTIONS(description=""System of National Accounts identifies whether a country uses the 1968 1993 or 2008 System of National Accounts (SNA). The 2008 SNA is an update of the 1993 SNA and retains its basic theoretical framework.""),
  alternative_conversion_factor STRING OPTIONS(description=""Alternative conversion factor identifies the countries and years for which a World Bank–estimated conversion factor has been used in place of the official exchange rate (line rf in the International Monetary Fund’s [IMF] International Financial Statistics). See later in Sources and methods for further discussion of alternative conversion factors.""),
  ppp_survey_year STRING OPTIONS(description=""Purchasing power parity (PPP) survey year is the latest available survey year for the International Comparison Program’s estimates of PPPs.""),
  balance_of_payments_manual_in_use STRING OPTIONS(description=""Balance of Payments Manual in use refers to the classification system used to compile and report data on balance of payments. 6 refers to the 6th edition of the IMF’s Balance of Payments Manual (2009).""),
  external_debt_reporting_status STRING OPTIONS(description=""External debt shows debt reporting status for 2016 data. A indicates that data are as reported P that data are based on reported or collected information but include an element of staff estimation and E that data are World Bank staff estimates.""),
  system_of_trade STRING OPTIONS(description=""System of trade refers to the United Nations general trade system (G) or special trade system (S). Under the general trade system goods entering directly for domestic consumption and goods entered into customs storage are recorded as imports at arrival. Under the special trade system goods are recorded as imports when declared for domestic consumption whether at time of entry or on withdrawal from customs storage.""),
  government_accounting_concept STRING OPTIONS(description=""Government finance accounting concept is the accounting basis for reporting central government financial data. For most countries government finance data have been consolidated (C) into one set of accounts capturing all central government fiscal activities. Budgetary central government accounts (B) exclude some central government units.""),
  imf_data_dissemination_standard STRING OPTIONS(description=""IMF data dissemination standard shows the countries that subscribe to the IMF’s Special Data Dissemination Standard (S) or Enhanced General Data Dissemination System (e-GDDS). S refers to countries that subscribe to the SDDS and have posted data on the Dissemination Standards Bulletin Board at http://dsbb.imf.org. S+ countries must observe additional coverage periodicity and timeliness requirements. e-G refers to countries that subscribe to the e-GDDS.""),
  latest_population_census STRING OPTIONS(description=""Latest population census shows the most recent year in which a census was conducted and in which at least preliminary results have been released. The preliminary results from the very recent censuses could be reflected in timely revisions if basic data are available such as population by age and sex as well as the detailed definition of counting coverage and completeness.""),
  latest_household_survey STRING OPTIONS(description=""Latest demographic education or health household survey indicates the household surveys used to compile the demographic education and health data. Detailed information on each survey is provided through the following links:  AIDS Indicator Survey Demographic and Health Survey Health Issues Survey and Malaria Indicator Survey - www.dhsprogram.com; Living Standards Measurement Study -  www.worldbank.org/lsms; Multiple Indicator Cluster Survey - http://mics.unicef.org; Reproductive Health Survey -  www.cdc.gov/reproductivehealth; World Health Survey is available at - www.who.int/healthinfo/survey/en.""),
  source_of_most_recent_income_and_expenditure_data STRING OPTIONS(description=""Source of most recent income and expenditure data shows household surveys that collect income and expenditure data. Names and detailed information on household surveys can be found on the website of the International Household Survey Network (www.surveynetwork.org). Core Welfare Indicator Questionnaire Surveys (CWIQ) developed by the World Bank measure changes in key social indicators for different population groups—specifically indicators of access utilization and satisfaction with core social and economic services. Expenditure survey/budget surveys (ES/BS) collect detailed information on household consumption as well as on general demographic social and economic characteristics. Integrated household surveys (IHS) collect detailed information on a wide variety of topics including health education economic activities housing and utilities.""),
  vital_registration_complete STRING OPTIONS(description=""Vital registration complete identifies countries that report at least 90 percent complete registries of vital (birth and death) statistics to the United Nations Statistics Division and are reported in its Population and Vital Statistics Reports. Countries with complete vital statistics registries may have more accurate and more timely demographic indicators than other countries.""),
  latest_agricultural_census STRING OPTIONS(description=""Latest agricultural census shows the most recent year in which an agricultural census was conducted or planned to be conducted as reported to the Food and Agriculture Organization.""),
  latest_industrial_data STRING OPTIONS(description=""Latest industrial data show the most recent year for which manufacturing value added data at the three-digit level of the International Standard Industrial Classification (revision 2 or 3) are available in the United Nations Industrial Development Organization database.""),
  latest_trade_data STRING OPTIONS(description=""Latest trade data show the most recent year for which structure of merchandise trade data from the United Nations Statistics Division’s Commodity Trade (Comtrade) database are available."")
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'world_bank_global_population': ['population_by_country'], 'world_bank_health_population': ['country_series_definitions', 'country_summary', 'health_nutrition_population', 'series_summary', 'series_times'], 'world_bank_intl_debt': ['country_series_definitions', 'country_summary', 'international_debt', 'series_summary', 'series_times'], 'world_bank_intl_education': ['country_series_definitions', 'country_summary', 'international_education', 'series_summary'], 'world_bank_wdi': ['country_series_definitions', 'country_summary', 'footnotes', 'indicators_data', 'series_summary', 'series_time']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table:** `bigquery-public-data.world_bank_wdi.indicators_data`
  - `indicator_code`: to identify GDP (constant 2015 US$) indicators.
  - `indicator_name`: to understand the description of indicators.
  - `country_code`: to link GDP data to countries.
  - `country_name`: for country names.
  - `year`: to select data from specific years.
  - `value`: GDP values.

- **Table:** `bigquery-public-data.world_bank_wdi.series_summary`
  - `series_code`: corresponds to `indicator_code` in `indicators_data`.
  - `indicator_name`: detailed name of the indicators.

- **Table:** `bigquery-public-data.world_bank_wdi.country_summary`
  - `country_code`: to join with `indicators_data`.
  - `region`: to group countries by region.

**Conditions that may be used:**

- Filter `indicator_code` to select GDP (constant 2015 US$) data.
- Filter `year` for the most recent data or a specific year.
- Use `country_code` to join `indicators_data` with `country_summary`.
- Group data by `region` to calculate median GDP values.

**SQL Queries:**

1. **Find indicator codes for GDP (constant 2015 US$):**
   ```sql
   SELECT DISTINCT series_code, indicator_name
   FROM `bigquery-public-data.world_bank_wdi.series_summary`
   WHERE LOWER(indicator_name) LIKE '%gdp (constant 2015 us$)%'
   LIMIT 1000;
   ```

2. **View sample GDP data from `indicators_data`:**
   ```sql
   SELECT country_code, country_name, indicator_code, year, value
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE indicator_code = 'NY.GDP.MKTP.KD'
   LIMIT 1000;
   ```

3. **Get distinct regions from `country_summary`:**
   ```sql
   SELECT DISTINCT region
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   LIMIT 1000;
   ```

4. **List countries and their regions:**
   ```sql
   SELECT country_code, short_name AS country_name, region
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   LIMIT 1000;
   ```

5. **Get GDP data for the year 2019:**
   ```sql
   SELECT country_code, country_name, year, value
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE indicator_code = 'NY.GDP.MKTP.KD' AND year = 2019
   LIMIT 1000;
   ```

6. **Join GDP data with country regions:**
   ```sql
   SELECT i.country_code, i.country_name, i.year, i.value, c.region
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS i
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS c
   ON i.country_code = c.country_code
   WHERE i.indicator_code = 'NY.GDP.MKTP.KD' AND i.year = 2019
   LIMIT 1000;
   ```

7. **Calculate the number of countries per region:**
   ```sql
   SELECT region, COUNT(DISTINCT country_code) AS country_count
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   WHERE region IS NOT NULL AND region != ''
   GROUP BY region
   LIMIT 1000;
   ```

8. **List GDP values for countries in a specific region (e.g., Europe & Central Asia):**
   ```sql
   SELECT i.country_name, i.value AS gdp_2019
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS i
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS c
   ON i.country_code = c.country_code
   WHERE i.indicator_code = 'NY.GDP.MKTP.KD' AND i.year = 2019
     AND c.region = 'Europe & Central Asia'
   LIMIT 1000;
   ```

9. **Get median GDP values per region (note: BigQuery requires use of APPROX_QUANTILES for medians):**
   ```sql
   SELECT c.region, APPROX_QUANTILES(i.value, 2)[OFFSET(1)] AS median_gdp
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS i
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS c
   ON i.country_code = c.country_code
   WHERE i.indicator_code = 'NY.GDP.MKTP.KD' AND i.year = 2019
   GROUP BY c.region
   LIMIT 1000;
   ```

10. **List all available years for GDP data:**
    ```sql
    SELECT DISTINCT year
    FROM `bigquery-public-data.world_bank_wdi.indicators_data`
    WHERE indicator_code = 'NY.GDP.MKTP.KD'
    ORDER BY year DESC
    LIMIT 1000;
    ```

11. **View indicator descriptions for GDP indicators:**
    ```sql
    SELECT series_code, short_definition
    FROM `bigquery-public-data.world_bank_wdi.series_summary`
    WHERE series_code = 'NY.GDP.MKTP.KD'
    LIMIT 1000;
    ```

12. **Get GDP data for all countries over multiple years:**
    ```sql
    SELECT country_name, year, value AS gdp_value
    FROM `bigquery-public-data.world_bank_wdi.indicators_data`
    WHERE indicator_code = 'NY.GDP.MKTP.KD' AND year BETWEEN 2015 AND 2019
    LIMIT 1000;
    ```

These queries will help in understanding the data structures, values, and relationships between tables, which are essential for determining which region has the highest median GDP (constant 2015 US$) value.Query:
SELECT DISTINCT series_code, indicator_name
   FROM `bigquery-public-data.world_bank_wdi.series_summary`
   WHERE LOWER(indicator_name) LIKE '%gdp (constant 2015 us$)%'
   LIMIT 1000;
Answer:
series_code,indicator_name
NY.GDP.MKTP.KD,GDP (constant 2015 US$)
Query:
SELECT country_code, country_name, indicator_code, year, value
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE indicator_code = 'NY.GDP.MKTP.KD'
   LIMIT 1000;
Answer:
Too long, hard cut:
country_code,country_name,indicator_code,year,value
MMR,Myanmar,NY.GDP.MKTP.KD,1968,3766485577.12378
NAM,Namibia,NY.GDP.MKTP.KD,1998,5242128224.00169
NPL,Nepal,NY.GDP.MKTP.KD,1962,3447314854.82201
NPL,Nepal,NY.GDP.MKTP.KD,2006,16439932516.5831
BRN,Brunei Darussalam,NY.GDP.MKTP.KD,2009,12665627056.3659
BGR,Bulgaria,NY.GDP.MKTP.KD,1985,35814094910.805
BGR,Bulgaria,NY.GDP.MKTP.KD,1987,39580615170.2135
BDI,Burundi,NY.GDP.MKTP.KD,1982,1712247647.29676
LAC,Latin America & Caribbean (excluding high income),NY.GDP.MKTP.KD,1997,2846009420300.99
LMY,Low & middle income,NY.GDP.MKTP.KD,2007,17586878384858.0
LMC,Lower middle income,NY.GDP.MKTP.KD,1965,771275616651.188
LMC,Lower middle income,NY.GDP.MKTP.KD,1990,2122313482158.37
LMC,Lower middle income,NY.GDP.MKTP.KD,2002,3194038992245.53
MEA,Middle East & North Africa,NY.GDP.MKTP.KD,2020,3243739545284.98
MNA,Middle East & North Africa (excluding high income),NY.GDP.MKTP.KD,1980,419562499542.787
DMA,Dominica,NY.GDP.MKTP.KD,1978,234352173.555526
LVA,Latvia,NY.GDP.MKTP.KD,2007,29002363545.9676
LSO,Lesotho,NY.GDP.MKTP.KD,2004,1612096000.49548
WSM,Samoa,NY.GDP.MKTP.KD,1982,409723388.389005
OMN,Oman,NY.GDP.MKTP.KD,1983,18925617927.7435
CAF,Central African Republic,NY.GDP.MKTP.KD,1965,1013697584.80447
COM,Comoros,NY.GDP.MKTP.KD,1997,563886119.709676
WLD,World,NY.GDP.MKTP.KD,2000,48146683077384.4
DZA,Algeria,NY.GDP.MKTP.KD,1961,20733849882.3774
DZA,Algeria,NY.GDP.MKTP.KD,2006,126495413069.533
TMN,Middle East & North Africa (IDA & IBRD countries),NY.GDP.MKTP.KD,2004,992580883046.924
NAC,North America,NY.GDP.MKTP.KD,1992,10929544482336.9
PSS,Pacific island small states,NY.GDP.MKTP.KD,2005,7231294470.42854
PST,Post-demographic dividend,NY.GDP.MKTP.KD,1963,9889377686297.1
FIN,Finland,NY.GDP.MKTP.KD,1960,50589519083.7226
FIN,Finland,NY.GDP.MKTP.KD,1987,140069588805.624
FIN,Finland,NY.GDP.MKTP.KD,2002,204568476382.962
FRA,France,NY.GDP.MKTP.KD,1976,1148593347439.08
FRA,France,NY.GDP.MKTP.KD,1990,1660423065362.52
GAB,Gabon,NY.GDP.MKTP.KD,2019,15460241608.8257
EMU,Euro area,NY.GDP.MKTP.KD,1997,9036375850461.54
EMU,Euro area,NY.GDP.MKTP.KD,2009,10965349872015.8
HIC,High income,NY.GDP.MKTP.KD,1978,19407887392109.1
HIC,High income,NY.GDP.MKTP.KD,1985,23196833368009.8
MDG,Madagascar,NY.GDP.MKTP.KD,2018,12629254614.1071
MLT,Malta,NY.GDP.MKTP.KD,1985,2646361034.06191
MHL,Marshall Islands,NY.GDP.MKTP.KD,2007,175092500.0
MRT,Mauritania,NY.GDP.MKTP.KD,1963,1051184411.5989
MRT,Mauritania,NY.GDP.MKTP.KD,1985,2488366451.23844
SGP,Singapore,NY.GDP.MKTP.KD,1962,6911841722.43236
SXM,Sint Maarten (Dutch part),NY.GDP.MKTP.KD,2018,1108000824.03352
ESP,Spain,NY.GDP.MKTP.KD,2010,1196670854394.8
PRI,Puerto Rico,NY.GDP.MKTP.KD,1986,58362843987.8155
COG,"Congo, Rep.",NY.GDP.MKTP.KD,1964,1423661535.42456
CUB,Cuba,NY.GDP.MKTP.KD,2015,87133000000.0
CUW,Curacao,NY.GDP.MKTP.KD,2011,3209266564.04194
CZE,Czech Republic,NY.GDP.MKTP.KD,1990,120142052583.973
GUY,Guyana,NY.GDP.MKTP.KD,1969,2110018751.87545
GUY,Guyana,NY.GDP.MKTP.KD,1971,2268286484.8283
HUN,Hungary,NY.GDP.MKTP.KD,2009,111923227694.593
ISL,Iceland,NY.GDP.MKTP.KD,2014,16773046835.507
ISL,Iceland,NY.GDP.MKTP.KD,2016,18621440660.0019
SAS,South Asia,NY.GDP.MKTP.KD,1976,328162729613.475
SSF,Sub-Saharan Africa,NY.GDP.MKTP.KD,1989,647798062253.99
SSA,Sub-Saharan Africa (excluding high income),NY.GDP.MKTP.KD,1970,399355844595.27
UMC,Upper middle income,NY.GDP.MKTP.KD,1960,1315490536908.03
UMC,Upper middle income,NY.GDP.MKTP.KD,1963,1409668204817.16
AUS,Australia,NY.GDP.MKTP.KD,1971,349823081605.576
AUT,Austria,NY.GDP.MKTP.KD,1967,114458318906.485
AUT,Austria,NY.GDP.MKTP.KD,2016,389413586441.667
AZE,Azerbaijan,NY.GDP.MKTP.KD,2001,13097901809.4266
AZE,Azerbaijan,NY.GDP.MKTP.KD,2017,51531923130.9779
BGD,Bangladesh,NY.GDP.MKTP.KD,1998,75731164300.4426
BLR,Belarus,NY.GDP.MKTP.KD,1991,29099127258.7491
SUR,Suriname,NY.GDP.MKTP.KD,1998,2901533087.48207
CHE,Switzerland,NY.GDP.MKTP.KD,2009,621539124455.347
SYR,Syrian Arab Republic,NY.GDP.MKTP.KD,1990,11619961705.0846
IBT,IDA & IBRD total,NY.GDP.MKTP.KD,2017,30551204405315.5
IDB,IDA blend,NY.GDP.MKTP.KD,1960,112826602868.049
LCN,Latin America & Caribbean,NY.GDP.MKTP.KD,1965,922462437781.724
GMB,"Gambia, The",NY.GDP.MKTP.KD,2011,1240786424.0015
GEO,Georgia,NY.GDP.MKTP.KD,1979,16928230216.586
GEO,Georgia,NY.GDP.MKTP.KD,1987,20399949704.5182
GEO,Georgia,NY.GDP.MKTP.KD,2009,11050871061.5608
GEO,Georgia,NY.GDP.MKTP.KD,2010,11741493896.7964
GEO,Georgia,NY.GDP.MKTP.KD,2016,15388577975.5872
GRL,Greenland,NY.GDP.MKTP.KD,1985,1326357012.1974
GRL,Greenland,NY.GDP.MKTP.KD,1996,1496590669.3289
TZA,Tanzania,NY.GDP.MKTP.KD,2012,39158481311.5869
MDA,Moldova,NY.GDP.MKTP.KD,2016,8086710150.73289
MDA,Moldova,NY.GDP.MKTP.KD,2017,8466041015.96707
BLZ,Belize,NY.GDP.MKTP.KD,1992,737285247.043466
BEN,Benin,NY.GDP.MKTP.KD,1976,2380844444.63745
BWA,Botswana,NY.GDP.MKTP.KD,1962,203905557.028968
IRN,"Iran, Islamic Rep.",NY.GDP.MKTP.KD,1984,178472196717.133
ISR,Israel,NY.GDP.MKTP.KD,1999,166031729085.374
JAM,Jamaica,NY.GDP.MKTP.KD,1976,9113027630.3123
Query:
SELECT DISTINCT region
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   LIMIT 1000;
Answer:
region
""
Europe & Central Asia
North America
Latin America & Caribbean
East Asia & Pacific
Sub-Saharan Africa
Middle East & North Africa
South Asia
Query:
SELECT country_code, short_name AS country_name, region
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   LIMIT 1000;
Answer:
Too long, hard cut:
country_code,country_name,region
AFE,Africa Eastern and Southern,
AFW,Africa Western and Central,
ARB,Arab World,
CEB,Central Europe and the Baltics,
CSS,Caribbean small states,
EAP,East Asia & Pacific (excluding high income),
EAR,Early-demographic dividend,
EAS,East Asia & Pacific,
ECA,Europe & Central Asia (excluding high income),
ECS,Europe & Central Asia,
EUU,European Union,
FCS,Fragile and conflict affected situations,
HIC,High income,
HPC,Heavily indebted poor countries (HIPC),
IBD,IBRD only,
IBT,IDA & IBRD total,
IDA,IDA total,
IDB,IDA blend,
IDX,IDA only,
LAC,Latin America & Caribbean (excluding high income),
LCN,Latin America & Caribbean,
LDC,Least developed countries: UN classification,
LIC,Low income,
LMC,Lower middle income,
LMY,Low & middle income,
LTE,Late-demographic dividend,
MEA,Middle East & North Africa,
MIC,Middle income,
MNA,Middle East & North Africa (excluding high income),
NAC,North America,
OED,OECD members,
OSS,Other small states,
PRE,Pre-demographic dividend,
PSS,Pacific island small states,
PST,Post-demographic dividend,
SAS,South Asia,
SSA,Sub-Saharan Africa (excluding high income),
SSF,Sub-Saharan Africa,
SST,Small states,
TEA,East Asia & Pacific (IDA & IBRD),
TEC,Europe & Central Asia (IDA & IBRD),
TLA,Latin America & Caribbean (IDA & IBRD),
TMN,Middle East & North Africa (IDA & IBRD),
TSA,South Asia (IDA & IBRD),
TSS,Sub-Saharan Africa (IDA & IBRD),
UMC,Upper middle income,
WLD,World,
AND,Andorra,Europe & Central Asia
BMU,Bermuda,North America
CHI,Channel Islands,Europe & Central Asia
CUW,Curaçao,Latin America & Caribbean
CYM,Cayman Islands,Latin America & Caribbean
FRO,Faroe Islands,Europe & Central Asia
GIB,Gibraltar,Europe & Central Asia
GRL,Greenland,Europe & Central Asia
GUM,Guam,East Asia & Pacific
IMN,Isle of Man,Europe & Central Asia
LIE,Liechtenstein,Europe & Central Asia
MAF,St. Martin (French part),Latin America & Caribbean
MCO,Monaco,Europe & Central Asia
MNP,Northern Mariana Islands,East Asia & Pacific
NCL,New Caledonia,East Asia & Pacific
NRU,Nauru,East Asia & Pacific
NZL,New Zealand,East Asia & Pacific
PRI,Puerto Rico,Latin America & Caribbean
PYF,French Polynesia,East Asia & Pacific
SXM,Sint Maarten (Dutch part),Latin America & Caribbean
TCA,Turks and Caicos Islands,Latin America & Caribbean
VGB,British Virgin Islands,Latin America & Caribbean
VIR,Virgin Islands,Latin America & Caribbean
ERI,Eritrea,Sub-Saharan Africa
PRK,Dem. People's Rep. Korea,East Asia & Pacific
SOM,Somalia,Sub-Saharan Africa
SSD,South Sudan,Sub-Saharan Africa
ASM,American Samoa,East Asia & Pacific
CUB,Cuba,Latin America & Caribbean
TKM,Turkmenistan,Europe & Central Asia
VEN,Venezuela,Latin America & Caribbean
ABW,Aruba,Latin America & Caribbean
ARE,United Arab Emirates,Middle East & North Africa
ATG,Antigua and Barbuda,Latin America & Caribbean
BHR,Bahrain,Middle East & North Africa
BHS,The Bahamas,Latin America & Caribbean
BRB,Barbados,Latin America & Caribbean
BRN,Brunei,East Asia & Pacific
KNA,St. Kitts and Nevis,Latin America & Caribbean
KWT,Kuwait,Middle East & North Africa
MAC,"Macao SAR, China",East Asia & Pacific
OMN,Oman,Middle East & North Africa
PAN,Panama,Latin America & Caribbean
QAT,Qatar,Middle East & North Africa
SMR,San Marino,Europe & Central Asia
TTO,Trinidad and Tobago,Latin America & Caribbean
AFG,Afghanistan,South Asia
BDI,Burundi,Sub-Saharan Africa
BFA,Burkina Faso,Sub-Saharan Africa
CAF,Central African Republic,Sub-Saharan Africa
COD,Dem. Rep. Congo,Sub-Saharan Africa
ETH,Ethiopia,Sub-Saharan Africa
GIN,Guinea,Sub-Saharan Africa
GMB,The Gambia,Sub-Saharan Africa
GNB,Guinea-Bissau,Sub-Saharan Africa
LBR,Liberia,Sub-Saharan Africa
MDG,Madagascar,Sub-Saharan Africa
MLI,Mali,Sub-Saharan Africa
MOZ,Mozambique,Sub-Saharan Africa
MWI,Malawi,Sub-Saharan Africa
NER,Niger,Sub-Saharan Africa
RWA,Rwanda,Sub-Saharan Africa
SDN,Sudan,Sub-Saharan Africa
SLE,Sierra Leone,Sub-Saharan Africa
SYR,Syrian Arab Republic,Middle East & North Africa
TCD,Chad,Sub-Saharan Africa
TGO,Togo,Sub-Saharan Africa
UGA,Uganda,Sub-Saharan Africa
YEM,Yemen,Middle East & North Africa
ZMB,Zambia,Sub-Saharan Africa
AGO,Angola,Sub-Saharan Africa
BEN,Benin,Sub-Saharan Africa
BGD,Bangladesh,South Asia
BOL,Bolivia,Latin America & Caribbean
BTN,Bhutan,South Asia
CIV,Côte d'Ivoire,Sub-Saharan Africa
CMR,Cameroon,Sub-Saharan Africa
COG,Congo,Sub-Saharan Africa
COM,Comoros,Sub-Saharan Africa
CPV,Cabo Verde,Sub-Saharan Africa
DJI,Djibouti,Middle East & North Africa
DZA,Algeria,Middle East & North Africa
FSM,Micronesia,East Asia & Pacific
GHA,Ghana,Sub-Saharan Africa
HND,Honduras,Latin America & Caribbean
HTI,Haiti,Latin America & Caribbean
IRN,Iran,Middle East & North Africa
KEN,Kenya,Sub-Saharan Africa
KHM,Cambodia,East Asia & Pacific
KIR,Kiribati,East Asia & Pacific
LAO,Lao PDR,East Asia & Pacific
LBN,Lebanon,Middle East & North Africa
LSO,Lesotho,Sub-Saharan Africa
MMR,Myanmar,East Asia & Pacific
MRT,Mauritania,Sub-Saharan Africa
NGA,Nigeria,Sub-Saharan Africa
NIC,Nicaragua,Latin America & Caribbean
NPL,Nepal,S
Query:
SELECT country_code, country_name, year, value
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE indicator_code = 'NY.GDP.MKTP.KD' AND year = 2019
   LIMIT 1000;
Answer:
Too long, hard cut:
country_code,country_name,year,value
EUU,European Union,2019,14765116523492.0
BRN,Brunei Darussalam,2019,13278836553.322
ZMB,Zambia,2019,24089861649.0155
HTI,Haiti,2019,15474153940.1499
TJK,Tajikistan,2019,10943735892.3235
BEN,Benin,2019,14179807326.7156
MAC,"Macao SAR, China",2019,51073940150.1338
TMN,Middle East & North Africa (IDA & IBRD countries),2019,1522371834048.04
VCT,St. Vincent and the Grenadines,2019,798469518.407039
TZA,Tanzania,2019,60318543760.5445
GRL,Greenland,2019,2710570656.36234
LSO,Lesotho,2019,2329753748.89367
EAP,East Asia & Pacific (excluding high income),2019,17016933263759.9
MDV,Maldives,2019,5414217823.03808
CYP,Cyprus,2019,24880804888.1512
CAN,Canada,2019,1696163077026.08
PLW,Palau,2019,265597626.615969
MHL,Marshall Islands,2019,212388500.0
JAM,Jamaica,2019,14934128282.7371
NRU,Nauru,2019,89620006.418409
NOR,Norway,2019,406468037614.963
CUB,Cuba,2019,91019611431.1927
JPN,Japan,2019,4591290538384.75
AFG,Afghanistan,2019,21118462796.7609
BFA,Burkina Faso,2019,15001629028.4851
GNQ,Equatorial Guinea,2019,9998462337.55955
BGR,Bulgaria,2019,57443866470.1882
EAS,East Asia & Pacific,2019,26302619575881.9
MLI,Mali,2019,16028741076.2588
LBN,Lebanon,2019,46777216084.3953
SOM,Somalia,2019,6900727625.84454
ATG,Antigua and Barbuda,2019,1630215842.3024
HKG,"Hong Kong SAR, China",2019,331749697713.935
TCD,Chad,2019,10526057266.1328
ARM,Armenia,2019,12867495686.1153
HIC,High income,2019,52180038375130.5
BIH,Bosnia and Herzegovina,2019,18413845946.1771
TLA,Latin America & the Caribbean (IDA & IBRD countries),2019,5369907031287.5
SLB,Solomon Islands,2019,1533613348.9277
ISL,Iceland,2019,20847341424.8856
SGP,Singapore,2019,348909586848.996
SST,Small states,2019,486912648101.75
GUM,Guam,2019,5966796360.32757
SRB,Serbia,2019,45615675379.6018
MNP,Northern Mariana Islands,2019,1037951515.15152
WLD,World,2019,84612027798062.6
PSS,Pacific island small states,2019,10138908192.4612
FCS,Fragile and conflict affected situations,2019,1720631743301.35
BGD,Bangladesh,2019,261518503633.701
GMB,"Gambia, The",2019,1676447055.8329
TUV,Tuvalu,2019,42824596.8653884
UZB,Uzbekistan,2019,106161435002.412
MRT,Mauritania,2019,7336133809.76738
DNK,Denmark,2019,334638192450.446
CYM,Cayman Islands,2019,5425515180.60722
BEL,Belgium,2019,494644115983.888
COD,"Congo, Dem. Rep.",2019,44487657807.0092
PRI,Puerto Rico,2019,96423791493.1329
NZL,New Zealand,2019,200742824665.702
HUN,Hungary,2019,146968695014.007
LBY,Libya,2019,40473930298.8275
AFW,Africa Western and Central,2019,827963431037.275
CEB,Central Europe and the Baltics,2019,1519932999983.23
RUS,Russian Federation,2019,1459189098326.43
SVK,Slovak Republic,2019,99048285215.7697
KGZ,Kyrgyz Republic,2019,7920624102.90056
MIC,Middle income,2019,31663365601529.3
CHE,Switzerland,2019,758167874591.909
LCN,Latin America & Caribbean,2019,5596468714863.74
VNM,Vietnam,2019,251208952743.671
KIR,Kiribati,2019,195759870.68938
MKD,North Macedonia,2019,11185489898.549
ASM,American Samoa,2019,628818320.610687
GUY,Guyana,2019,5071041645.23612
IBT,IDA & IBRD total,2019,33299134680470.5
MUS,Mauritius,2019,13471938135.6172
CHN,China,2019,14296238286985.1
COM,Comoros,2019,1092787840.36505
ECS,Europe & Central Asia,2019,22365520285914.6
CIV,Cote d'Ivoire,2019,59861589342.7008
FSM,"Micronesia, Fed. Sts.",2019,332458532.270118
STP,Sao Tome and Principe,2019,359752972.346268
IRQ,Iraq,2019,202613535336.009
PST,Post-demographic dividend,2019,48381584694878.9
KNA,St. Kitts and Nevis,2019,1136818536.07058
BMU,Bermuda,2019,6851270046.39601
BWA,Botswana,2019,16188225469.2536
PSE,West Bank and Gaza,2019,15829000000.0
CUW,Curacao,2019,2898092042.62992
DMA,Dominica,2019,568298267.854584
LBR,Liberia,2019,3211334057.92828
LCA,St. Lucia,2019,1995116519.64915
FRA,France,2019,2615760319962.67
SLE,Sierra Leone,2019,5076711739.04284
PNG,Papua New Guinea,2019,24719859152.6631
SSA,Sub-Saharan Africa (excluding high income),2019,1833089644759.92
TLS,Timor-Leste,2019,1896767581.03646
DZA,Algeria,2019,177180346401.967
EMU,Euro area,2019,12615961472339.9
IRL,Ireland,2019,370632118369.555
IMN,Isle of Man,2019,8129451489.68678
MEA,Middle East & North Africa,2019,3378463990503.43
RWA,Rwanda,2019,11182411389.0747
IBD,IBRD only,2019,30947573002709.4
CPV,Cabo Verde,2019,1915123782.86887
SYC,Seychelles,2019,1553599342.64266
LMY,Low & middle income,2019,32139450441501.1
SWZ,Eswatini,2019,4401077165.65255
BHR,Bahrain,2019,34985241938.6953
ZWE,Zimbabwe,2019,20720841373.1335
NPL,Nepal,2019,30605291409.0891
ARE,United Arab Emirates,2019,395103837869.753
NER,Niger,2019,12212118177.9725
LMC,Lower middle income,2019,7796543762641.46
AND,Andorra,2019,3008955096.59511
AUS,Australia,2019,1491025040336.15
GRD,Grenada,2019,1134931073.15504
BOL,Bolivia,2019,38193230057.6737
BRA,Brazil,2019,1823105452462.95
CHL,Chile,2019,262807032486.856
ECU,Ecuador,2019,101702140245.144
EGY,"Egypt, Arab Rep.",2019,398037429245.42
GTM,Guatemala,2019,70634110391.9779
HND,Honduras,2019,24191028957.12
JOR,Jordan,2019,41755867661.2459
KEN,Kenya,2019,84125098675.
Query:
SELECT i.country_code, i.country_name, i.year, i.value, c.region
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS i
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS c
   ON i.country_code = c.country_code
   WHERE i.indicator_code = 'NY.GDP.MKTP.KD' AND i.year = 2019
   LIMIT 1000;
Answer:
Too long, hard cut:
country_code,country_name,year,value,region
GAB,Gabon,2019,15460241608.8257,Sub-Saharan Africa
NAM,Namibia,2019,11240759011.0283,Sub-Saharan Africa
AGO,Angola,2019,110072586683.261,Sub-Saharan Africa
SDN,Sudan,2019,51312429477.3951,Sub-Saharan Africa
MNA,Middle East & North Africa (excluding high income),2019,1538200834048.04,
AFE,Africa Eastern and Southern,2019,1006679813065.29,
TON,Tonga,2019,486181549.588749,East Asia & Pacific
TKM,Turkmenistan,2019,45710025776.6731,Europe & Central Asia
EAR,Early-demographic dividend,2019,11703037495097.2,
QAT,Qatar,2019,167371229308.42,Middle East & North Africa
TEC,Europe & Central Asia (IDA & IBRD countries),2019,4095463099662.97,
AUT,Austria,2019,414257026093.423,Europe & Central Asia
NGA,Nigeria,2019,502942019447.736,Sub-Saharan Africa
DEU,Germany,2019,3598891541091.34,Europe & Central Asia
MOZ,Mozambique,2019,18183590595.087,Sub-Saharan Africa
LAO,Lao PDR,2019,18491845636.2733,East Asia & Pacific
MLT,Malta,2019,13856372628.2222,Middle East & North Africa
WSM,Samoa,2019,887495263.360233,East Asia & Pacific
HPC,Heavily indebted poor countries (HIPC),2019,788661392496.297,
MDG,Madagascar,2019,13186360351.4331,Sub-Saharan Africa
SVN,Slovenia,2019,50249892617.4104,Europe & Central Asia
KAZ,Kazakhstan,2019,211106972039.014,Europe & Central Asia
PRT,Portugal,2019,222272974069.03,Europe & Central Asia
GBR,United Kingdom,2019,3191493407624.4,Europe & Central Asia
NAC,North America,2019,21677548659072.5,
ARB,Arab World,2019,2681441590769.14,
OMN,Oman,2019,83053174485.8283,Middle East & North Africa
TSS,Sub-Saharan Africa (IDA & IBRD countries),2019,1834643244102.56,
LAC,Latin America & Caribbean (excluding high income),2019,4853709324043.9,
ETH,Ethiopia,2019,89640020508.4013,Sub-Saharan Africa
CZE,Czech Republic,2019,215594735504.853,Europe & Central Asia
TCA,Turks and Caicos Islands,2019,1095902844.26329,Latin America & Caribbean
GIN,Guinea,2019,12078653011.9638,Sub-Saharan Africa
BLZ,Belize,2019,1835056955.71673,Latin America & Caribbean
KWT,Kuwait,2019,114249382864.585,Middle East & North Africa
MMR,Myanmar,2019,83686992015.6706,East Asia & Pacific
LVA,Latvia,2019,30716038078.95,Europe & Central Asia
AZE,Azerbaijan,2019,53612524527.3911,Europe & Central Asia
URY,Uruguay,2019,55513344382.0673,Latin America & Caribbean
LUX,Luxembourg,2019,67286460381.3888,Europe & Central Asia
CSS,Caribbean small states,2019,74283427277.9706,
GRC,Greece,2019,203669187367.386,Europe & Central Asia
KHM,Cambodia,2019,23760061873.2798,East Asia & Pacific
TEA,East Asia & Pacific (IDA & IBRD countries),2019,16995303639412.5,
FIN,Finland,2019,254637296103.695,Europe & Central Asia
LIC,Low income,2019,476617321590.818,
DJI,Djibouti,2019,3191833262.48686,Middle East & North Africa
LTU,Lithuania,2019,48155059559.2863,Europe & Central Asia
HRV,Croatia,2019,57190160216.5408,Europe & Central Asia
SAS,South Asia,2019,3431466032627.32,
TSA,South Asia (IDA & IBRD),2019,3431466032627.32,
GNB,Guinea-Bissau,2019,1248729327.89726,Sub-Saharan Africa
ALB,Albania,2019,12970913827.5704,Europe & Central Asia
MCO,Monaco,2019,7080667991.59357,Europe & Central Asia
COG,"Congo, Rep.",2019,9643515879.79193,Sub-Saharan Africa
GEO,Georgia,2019,17757903230.0709,Europe & Central Asia
MNG,Mongolia,2019,14174566299.8985,East Asia & Pacific
MNE,Montenegro,2019,4777636043.80572,Europe & Central Asia
EST,Estonia,2019,27068147756.8566,Europe & Central Asia
ECA,Europe & Central Asia (excluding high income),2019,3468157804813.19,
TTO,Trinidad and Tobago,2019,22587789317.2434,Latin America & Caribbean
ISR,Israel,2019,353062816517.302,Middle East & North Africa
USA,United States,2019,19974534312000.0,North America
MWI,Malawi,2019,7477443338.32784,Sub-Saharan Africa
IDX,IDA only,2019,1229224147182.17,
CAF,Central African Republic,2019,1984982171.73544,Sub-Saharan Africa
IDB,IDA blend,2019,1121954012747.96,
BHS,"Bahamas, The",2019,12516819004.1803,Latin America & Caribbean
TGO,Togo,2019,5098275352.1552,Sub-Saharan Africa
BDI,Burundi,2019,3209182941.33059,Sub-Saharan Africa
SYR,Syrian Arab Republic,2019,16265870694.9063,Middle East & North Africa
FJI,Fiji,2019,5223164712.00555,East Asia & Pacific
BRB,Barbados,2019,4822013073.75235,Latin America & Caribbean
NIC,Nicaragua,2019,12991624156.9782,Latin America & Caribbean
GHA,Ghana,2019,62465709576.1815,Sub-Saharan Africa
UKR,Ukraine,2019,101944109453.562,Europe & Central Asia
SMR,San Marino,2019,1514041111.68851,Europe & Central Asia
PRE,Pre-demographic dividend,2019,1450630111014.12,
POL,Poland,2019,570115134633.24,Europe & Central Asia
SUR,Suriname,2019,5252729241.66594,Latin America & Caribbean
ITA,Italy,2019,1915994931005.09,Europe & Central Asia
IDA,IDA total,2019,2351178159930.13,
VIR,Virgin Islands (U.S.),2019,3835985859.12487,Latin America & Caribbean
SSF,Sub-Saharan Africa,2019,1834643244102.56,
OED,OECD members,2019,51615069476329.7,
ROU,Romania,2019,217382984916.126,Europe & Central Asia
IRN,"Iran, Islamic Rep.",2019,396745289342.132,Middle East & North Africa
UGA,Uganda,2019,3
Query:
SELECT region, COUNT(DISTINCT country_code) AS country_count
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   WHERE region IS NOT NULL AND region != ''
   GROUP BY region
   LIMIT 1000;
Answer:
region,country_count
Europe & Central Asia,58
North America,3
Latin America & Caribbean,42
East Asia & Pacific,37
Sub-Saharan Africa,48
Middle East & North Africa,21
South Asia,8
Query:
SELECT i.country_name, i.value AS gdp_2019
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS i
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS c
   ON i.country_code = c.country_code
   WHERE i.indicator_code = 'NY.GDP.MKTP.KD' AND i.year = 2019
     AND c.region = 'Europe & Central Asia'
   LIMIT 1000;
Answer:
country_name,gdp_2019
Turkmenistan,45710025776.6731
Austria,414257026093.423
Germany,3598891541091.34
Slovenia,50249892617.4104
Kazakhstan,211106972039.014
Portugal,222272974069.03
United Kingdom,3191493407624.4
Czech Republic,215594735504.853
Latvia,30716038078.95
Azerbaijan,53612524527.3911
Luxembourg,67286460381.3888
Greece,203669187367.386
Finland,254637296103.695
Lithuania,48155059559.2863
Croatia,57190160216.5408
Albania,12970913827.5704
Monaco,7080667991.59357
Georgia,17757903230.0709
Montenegro,4777636043.80572
Estonia,27068147756.8566
Ukraine,101944109453.562
San Marino,1514041111.68851
Poland,570115134633.24
Italy,1915994931005.09
Romania,217382984916.126
Belarus,59013474192.6442
Moldova,9155458065.71175
Spain,1324028319783.9
Kosovo,7547420630.10043
Netherlands,839912581383.842
Turkey,997437115405.82
Tajikistan,10943735892.3235
Greenland,2710570656.36234
Cyprus,24880804888.1512
Norway,406468037614.963
Bulgaria,57443866470.1882
Armenia,12867495686.1153
Bosnia and Herzegovina,18413845946.1771
Iceland,20847341424.8856
Serbia,45615675379.6018
Uzbekistan,106161435002.412
Denmark,334638192450.446
Belgium,494644115983.888
Hungary,146968695014.007
Russian Federation,1459189098326.43
Slovak Republic,99048285215.7697
Kyrgyz Republic,7920624102.90056
Switzerland,758167874591.909
North Macedonia,11185489898.549
France,2615760319962.67
Ireland,370632118369.555
Isle of Man,8129451489.68678
Andorra,3008955096.59511
Sweden,549821281946.735
Query:
SELECT c.region, APPROX_QUANTILES(i.value, 2)[OFFSET(1)] AS median_gdp
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS i
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS c
   ON i.country_code = c.country_code
   WHERE i.indicator_code = 'NY.GDP.MKTP.KD' AND i.year = 2019
   GROUP BY c.region
   LIMIT 1000;
Answer:
region,median_gdp
Sub-Saharan Africa,12212118177.9725
,3431466032627.32
East Asia & Pacific,14174566299.8985
Europe & Central Asia,59013474192.6442
Middle East & North Africa,83053174485.8283
Latin America & Caribbean,22587789317.2434
North America,1696163077026.08
South Asia,30605291409.0891
Query:
SELECT DISTINCT year
    FROM `bigquery-public-data.world_bank_wdi.indicators_data`
    WHERE indicator_code = 'NY.GDP.MKTP.KD'
    ORDER BY year DESC
    LIMIT 1000;
Answer:
year
2020
2019
2018
2017
2016
2015
2014
2013
2012
2011
2010
2009
2008
2007
2006
2005
2004
2003
2002
2001
2000
1999
1998
1997
1996
1995
1994
1993
1992
1991
1990
1989
1988
1987
1986
1985
1984
1983
1982
1981
1980
1979
1978
1977
1976
1975
1974
1973
1972
1971
1970
1969
1968
1967
1966
1965
1964
1963
1962
1961
1960
Query:
SELECT series_code, indicator_name, long_definition
FROM `bigquery-public-data.world_bank_wdi.series_summary`
WHERE series_code = 'NY.GDP.MKTP.KD'
LIMIT 1000;
Answer:
series_code,indicator_name,long_definition
NY.GDP.MKTP.KD,GDP (constant 2015 US$),"GDP at purchaser's prices is the sum of gross value added by all resident producers in the economy plus any product taxes and minus any subsidies not included in the value of the products. It is calculated without making deductions for depreciation of fabricated assets or for depletion and degradation of natural resources. Data are in constant 2015 prices, expressed in U.S. dollars. Dollar figures for GDP are converted from domestic currencies using 2015 official exchange rates. For a few countries where the official exchange rate does not reflect the rate effectively applied to actual foreign exchange transactions, an alternative conversion factor is used."
Query:
SELECT i.country_code, c.short_name AS country_name, i.indicator_code, i.year, i.value
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS i
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS c
ON i.country_code = c.country_code
WHERE i.indicator_code = 'NY.GDP.MKTP.KD'
LIMIT 1000
Answer:
Too long, hard cut:
country_code,country_name,indicator_code,year,value
MMR,Myanmar,NY.GDP.MKTP.KD,1968,3766485577.12378
NAM,Namibia,NY.GDP.MKTP.KD,1998,5242128224.00169
NPL,Nepal,NY.GDP.MKTP.KD,1962,3447314854.82201
NPL,Nepal,NY.GDP.MKTP.KD,2006,16439932516.5831
BRN,Brunei,NY.GDP.MKTP.KD,2009,12665627056.3659
BGR,Bulgaria,NY.GDP.MKTP.KD,1985,35814094910.805
BGR,Bulgaria,NY.GDP.MKTP.KD,1987,39580615170.2135
BDI,Burundi,NY.GDP.MKTP.KD,1982,1712247647.29676
LAC,Latin America & Caribbean (excluding high income),NY.GDP.MKTP.KD,1997,2846009420300.99
LMY,Low & middle income,NY.GDP.MKTP.KD,2007,17586878384858.0
LMC,Lower middle income,NY.GDP.MKTP.KD,1965,771275616651.188
LMC,Lower middle income,NY.GDP.MKTP.KD,1990,2122313482158.37
LMC,Lower middle income,NY.GDP.MKTP.KD,2002,3194038992245.53
MEA,Middle East & North Africa,NY.GDP.MKTP.KD,2020,3243739545284.98
MNA,Middle East & North Africa (excluding high income),NY.GDP.MKTP.KD,1980,419562499542.787
DMA,Dominica,NY.GDP.MKTP.KD,1978,234352173.555526
LVA,Latvia,NY.GDP.MKTP.KD,2007,29002363545.9676
LSO,Lesotho,NY.GDP.MKTP.KD,2004,1612096000.49548
WSM,Samoa,NY.GDP.MKTP.KD,1982,409723388.389005
OMN,Oman,NY.GDP.MKTP.KD,1983,18925617927.7435
CAF,Central African Republic,NY.GDP.MKTP.KD,1965,1013697584.80447
COM,Comoros,NY.GDP.MKTP.KD,1997,563886119.709676
WLD,World,NY.GDP.MKTP.KD,2000,48146683077384.4
DZA,Algeria,NY.GDP.MKTP.KD,1961,20733849882.3774
DZA,Algeria,NY.GDP.MKTP.KD,2006,126495413069.533
TMN,Middle East & North Africa (IDA & IBRD),NY.GDP.MKTP.KD,2004,992580883046.924
NAC,North America,NY.GDP.MKTP.KD,1992,10929544482336.9
PSS,Pacific island small states,NY.GDP.MKTP.KD,2005,7231294470.42854
PST,Post-demographic dividend,NY.GDP.MKTP.KD,1963,9889377686297.1
FIN,Finland,NY.GDP.MKTP.KD,1960,50589519083.7226
FIN,Finland,NY.GDP.MKTP.KD,1987,140069588805.624
FIN,Finland,NY.GDP.MKTP.KD,2002,204568476382.962
FRA,France,NY.GDP.MKTP.KD,1976,1148593347439.08
FRA,France,NY.GDP.MKTP.KD,1990,1660423065362.52
GAB,Gabon,NY.GDP.MKTP.KD,2019,15460241608.8257
EMU,Euro area,NY.GDP.MKTP.KD,1997,9036375850461.54
EMU,Euro area,NY.GDP.MKTP.KD,2009,10965349872015.8
HIC,High income,NY.GDP.MKTP.KD,1978,19407887392109.1
HIC,High income,NY.GDP.MKTP.KD,1985,23196833368009.8
MDG,Madagascar,NY.GDP.MKTP.KD,2018,12629254614.1071
MLT,Malta,NY.GDP.MKTP.KD,1985,2646361034.06191
MHL,Marshall Islands,NY.GDP.MKTP.KD,2007,175092500.0
MRT,Mauritania,NY.GDP.MKTP.KD,1963,1051184411.5989
MRT,Mauritania,NY.GDP.MKTP.KD,1985,2488366451.23844
SGP,Singapore,NY.GDP.MKTP.KD,1962,6911841722.43236
SXM,Sint Maarten (Dutch part),NY.GDP.MKTP.KD,2018,1108000824.03352
ESP,Spain,NY.GDP.MKTP.KD,2010,1196670854394.8
PRI,Puerto Rico,NY.GDP.MKTP.KD,1986,58362843987.8155
COG,Congo,NY.GDP.MKTP.KD,1964,1423661535.42456
CUB,Cuba,NY.GDP.MKTP.KD,2015,87133000000.0
CUW,Curaçao,NY.GDP.MKTP.KD,2011,3209266564.04194
CZE,Czech Republic,NY.GDP.MKTP.KD,1990,120142052583.973
GUY,Guyana,NY.GDP.MKTP.KD,1969,2110018751.87545
GUY,Guyana,NY.GDP.MKTP.KD,1971,2268286484.8283
HUN,Hungary,NY.GDP.MKTP.KD,2009,111923227694.593
ISL,Iceland,NY.GDP.MKTP.KD,2014,16773046835.507
ISL,Iceland,NY.GDP.MKTP.KD,2016,18621440660.0019
SAS,South Asia,NY.GDP.MKTP.KD,1976,328162729613.475
SSF,Sub-Saharan Africa,NY.GDP.MKTP.KD,1989,647798062253.99
SSA,Sub-Saharan Africa (excluding high income),NY.GDP.MKTP.KD,1970,399355844595.27
UMC,Upper middle income,NY.GDP.MKTP.KD,1960,1315490536908.03
UMC,Upper middle income,NY.GDP.MKTP.KD,1963,1409668204817.16
AUS,Australia,NY.GDP.MKTP.KD,1971,349823081605.576
AUT,Austria,NY.GDP.MKTP.KD,1967,114458318906.485
AUT,Austria,NY.GDP.MKTP.KD,2016,389413586441.667
AZE,Azerbaijan,NY.GDP.MKTP.KD,2001,13097901809.4266
AZE,Azerbaijan,NY.GDP.MKTP.KD,2017,51531923130.9779
BGD,Bangladesh,NY.GDP.MKTP.KD,1998,75731164300.4426
BLR,Belarus,NY.GDP.MKTP.KD,1991,29099127258.7491
SUR,Suriname,NY.GDP.MKTP.KD,1998,2901533087.48207
CHE,Switzerland,NY.GDP.MKTP.KD,2009,621539124455.347
SYR,Syrian Arab Republic,NY.GDP.MKTP.KD,1990,11619961705.0846
IBT,IDA & IBRD total,NY.GDP.MKTP.KD,2017,30551204405315.5
IDB,IDA blend,NY.GDP.MKTP.KD,1960,112826602868.049
LCN,Latin America & Caribbean,NY.GDP.MKTP.KD,1965,922462437781.724
GMB,The Gambia,NY.GDP.MKTP.KD,2011,1240786424.0015
GEO,Georgia,NY.GDP.MKTP.KD,1979,16928230216.586
GEO,Georgia,NY.GDP.MKTP.KD,1987,20399949704.5182
GEO,Georgia,NY.GDP.MKTP.KD,2009,11050871061.5608
GEO,Georgia,NY.GDP.MKTP.KD,2010,11741493896.7964
GEO,Georgia,NY.GDP.MKTP.KD,2016,15388577975.5872
GRL,Greenland,NY.GDP.MKTP.KD,1985,1326357012.1974
GRL,Greenland,NY.GDP.MKTP.KD,1996,1496590669.3289
TZA,Tanzania,NY.GDP.MKTP.KD,2012,39158481311.5869
MDA,Moldova,NY.GDP.MKTP.KD,2016,8086710150.73289
MDA,Moldova,NY.GDP.MKTP.KD,2017,8466041015.96707
BLZ,Belize,NY.GDP.MKTP.KD,1992,737285247.043466
BEN,Benin,NY.GDP.MKTP.KD,1976,2380844444.63745
BWA,Botswana,NY.GDP.MKTP.KD,1962,203905557.028968
IRN,Iran,NY.GDP.MKTP.KD,1984,178472196717.133
ISR,Israel,NY.GDP.MKTP.KD,1999,166031729085.374
JAM,Jamaica,NY.GDP.MKTP.KD,1976,9113027630.31234
ARE,United Arab Emirates,NY.GDP.MKTP.KD,1988,9
Query:
SELECT i.country_code, c.short_name AS country_name, i.year, i.value
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS i
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS c
ON i.country_code = c.country_code
WHERE i.indicator_code = 'NY.GDP.MKTP.KD' AND i.year = 2019
LIMIT 1000
Answer:
Too long, hard cut:
country_code,country_name,year,value
EUU,European Union,2019,14765116523492.0
BRN,Brunei,2019,13278836553.322
ZMB,Zambia,2019,24089861649.0155
HTI,Haiti,2019,15474153940.1499
TJK,Tajikistan,2019,10943735892.3235
BEN,Benin,2019,14179807326.7156
MAC,"Macao SAR, China",2019,51073940150.1338
TMN,Middle East & North Africa (IDA & IBRD),2019,1522371834048.04
VCT,St. Vincent and the Grenadines,2019,798469518.407039
TZA,Tanzania,2019,60318543760.5445
GRL,Greenland,2019,2710570656.36234
LSO,Lesotho,2019,2329753748.89367
EAP,East Asia & Pacific (excluding high income),2019,17016933263759.9
MDV,Maldives,2019,5414217823.03808
CYP,Cyprus,2019,24880804888.1512
CAN,Canada,2019,1696163077026.08
PLW,Palau,2019,265597626.615969
MHL,Marshall Islands,2019,212388500.0
JAM,Jamaica,2019,14934128282.7371
NRU,Nauru,2019,89620006.418409
NOR,Norway,2019,406468037614.963
CUB,Cuba,2019,91019611431.1927
JPN,Japan,2019,4591290538384.75
AFG,Afghanistan,2019,21118462796.7609
BFA,Burkina Faso,2019,15001629028.4851
GNQ,Equatorial Guinea,2019,9998462337.55955
BGR,Bulgaria,2019,57443866470.1882
EAS,East Asia & Pacific,2019,26302619575881.9
MLI,Mali,2019,16028741076.2588
LBN,Lebanon,2019,46777216084.3953
SOM,Somalia,2019,6900727625.84454
ATG,Antigua and Barbuda,2019,1630215842.3024
HKG,"Hong Kong SAR, China",2019,331749697713.935
TCD,Chad,2019,10526057266.1328
ARM,Armenia,2019,12867495686.1153
HIC,High income,2019,52180038375130.5
BIH,Bosnia and Herzegovina,2019,18413845946.1771
TLA,Latin America & Caribbean (IDA & IBRD),2019,5369907031287.5
SLB,Solomon Islands,2019,1533613348.9277
ISL,Iceland,2019,20847341424.8856
SGP,Singapore,2019,348909586848.996
SST,Small states,2019,486912648101.75
GUM,Guam,2019,5966796360.32757
SRB,Serbia,2019,45615675379.6018
MNP,Northern Mariana Islands,2019,1037951515.15152
WLD,World,2019,84612027798062.6
PSS,Pacific island small states,2019,10138908192.4612
FCS,Fragile and conflict affected situations,2019,1720631743301.35
BGD,Bangladesh,2019,261518503633.701
GMB,The Gambia,2019,1676447055.8329
TUV,Tuvalu,2019,42824596.8653884
UZB,Uzbekistan,2019,106161435002.412
MRT,Mauritania,2019,7336133809.76738
DNK,Denmark,2019,334638192450.446
CYM,Cayman Islands,2019,5425515180.60722
BEL,Belgium,2019,494644115983.888
COD,Dem. Rep. Congo,2019,44487657807.0092
PRI,Puerto Rico,2019,96423791493.1329
NZL,New Zealand,2019,200742824665.702
HUN,Hungary,2019,146968695014.007
LBY,Libya,2019,40473930298.8275
AFW,Africa Western and Central,2019,827963431037.275
CEB,Central Europe and the Baltics,2019,1519932999983.23
RUS,Russia,2019,1459189098326.43
SVK,Slovak Republic,2019,99048285215.7697
KGZ,Kyrgyz Republic,2019,7920624102.90056
MIC,Middle income,2019,31663365601529.3
CHE,Switzerland,2019,758167874591.909
LCN,Latin America & Caribbean,2019,5596468714863.74
VNM,Vietnam,2019,251208952743.671
KIR,Kiribati,2019,195759870.68938
MKD,North Macedonia,2019,11185489898.549
ASM,American Samoa,2019,628818320.610687
GUY,Guyana,2019,5071041645.23612
IBT,IDA & IBRD total,2019,33299134680470.5
MUS,Mauritius,2019,13471938135.6172
CHN,China,2019,14296238286985.1
COM,Comoros,2019,1092787840.36505
ECS,Europe & Central Asia,2019,22365520285914.6
CIV,Côte d'Ivoire,2019,59861589342.7008
FSM,Micronesia,2019,332458532.270118
STP,São Tomé and Principe,2019,359752972.346268
IRQ,Iraq,2019,202613535336.009
PST,Post-demographic dividend,2019,48381584694878.9
KNA,St. Kitts and Nevis,2019,1136818536.07058
BMU,Bermuda,2019,6851270046.39601
BWA,Botswana,2019,16188225469.2536
PSE,West Bank and Gaza,2019,15829000000.0
CUW,Curaçao,2019,2898092042.62992
DMA,Dominica,2019,568298267.854584
LBR,Liberia,2019,3211334057.92828
LCA,St. Lucia,2019,1995116519.64915
FRA,France,2019,2615760319962.67
SLE,Sierra Leone,2019,5076711739.04284
PNG,Papua New Guinea,2019,24719859152.6631
SSA,Sub-Saharan Africa (excluding high income),2019,1833089644759.92
TLS,Timor-Leste,2019,1896767581.03646
DZA,Algeria,2019,177180346401.967
EMU,Euro area,2019,12615961472339.9
IRL,Ireland,2019,370632118369.555
IMN,Isle of Man,2019,8129451489.68678
MEA,Middle East & North Africa,2019,3378463990503.43
RWA,Rwanda,2019,11182411389.0747
IBD,IBRD only,2019,30947573002709.4
CPV,Cabo Verde,2019,1915123782.86887
SYC,Seychelles,2019,1553599342.64266
LMY,Low & middle income,2019,32139450441501.1
SWZ,Eswatini,2019,4401077165.65255
BHR,Bahrain,2019,34985241938.6953
ZWE,Zimbabwe,2019,20720841373.1335
NPL,Nepal,2019,30605291409.0891
ARE,United Arab Emirates,2019,395103837869.753
NER,Niger,2019,12212118177.9725
LMC,Lower middle income,2019,7796543762641.46
AND,Andorra,2019,3008955096.59511
AUS,Australia,2019,1491025040336.15
GRD,Grenada,2019,1134931073.15504
BOL,Bolivia,2019,38193230057.6737
BRA,Brazil,2019,1823105452462.95
CHL,Chile,2019,262807032486.856
ECU,Ecuador,2019,101702140245.144
EGY,Egypt,2019,398037429245.42
GTM,Guatemala,2019,70634110391.9779
HND,Honduras,2019,24191028957.12
JOR,Jordan,2019,41755867661.2459
KEN,Kenya,2019,84125098675.5269
KOR,Korea,2019,1637850078348.95
LKA,Sri Lanka,2019,92119992734.643
MAR,Mor
Query:
SELECT c.short_name AS country_name, i.year, i.value AS gdp_value
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS i
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS c
ON i.country_code = c.country_code
WHERE i.indicator_code = 'NY.GDP.MKTP.KD' AND i.year BETWEEN 2015 AND 2019
LIMIT 1000
Answer:
Too long, hard cut:
country_name,year,gdp_value
Gabon,2019,15460241608.8257
Madagascar,2018,12629254614.1071
Sint Maarten (Dutch part),2018,1108000824.03352
Cuba,2015,87133000000.0
Iceland,2016,18621440660.0019
Austria,2016,389413586441.667
Azerbaijan,2017,51531923130.9779
IDA & IBRD total,2017,30551204405315.5
Georgia,2016,15388577975.5872
Moldova,2016,8086710150.73289
Moldova,2017,8466041015.96707
United States,2017,18983157920000.0
West Bank and Gaza,2016,15211000000.0
Namibia,2019,11240759011.0283
Low income,2016,427446175467.343
Andorra,2016,2893365390.02848
Angola,2019,110072586683.261
Aruba,2015,2962905027.93296
Middle income,2017,29042563515612.0
France,2017,2521399210474.97
St. Vincent and the Grenadines,2017,777437601.296596
Sudan,2019,51312429477.3951
Late-demographic dividend,2017,20315731121406.6
Georgia,2015,14953950557.4406
Ireland,2018,353262191749.526
Kenya,2018,80133540731.9138
Myanmar,2018,78394970758.0075
Middle East & North Africa (excluding high income),2019,1538200834048.04
Liberia,2015,3227075700.0
Africa Eastern and Southern,2019,1006679813065.29
Rwanda,2017,9408703403.70819
Northern Mariana Islands,2015,910000000.0
Palau,2016,280223900.0
Andorra,2015,2789870187.50693
Finland,2018,251566290193.7
The Gambia,2018,1579264906.00789
Middle East & North Africa,2015,3095509625416.13
Other small states,2016,380987136090.051
European Union,2015,13547247755711.5
Malta,2017,12482577842.4421
IDA & IBRD total,2018,32024673679121.9
Tonga,2019,486181549.588749
Mongolia,2015,11619892396.0767
Turkmenistan,2019,45710025776.6731
Kenya,2016,73074948912.6476
Lithuania,2018,46048888511.4844
Early-demographic dividend,2019,11703037495097.2
Serbia,2017,41840962435.9212
Eswatini,2015,4063245671.29285
Marshall Islands,2015,183814300.0
Qatar,2019,167371229308.42
Czech Republic,2015,188033050459.881
Late-demographic dividend,2018,21411581269969.1
Tanzania,2017,54067877695.7031
United Kingdom,2016,3023494748188.97
Kazakhstan,2016,186416704902.17
Europe & Central Asia (IDA & IBRD),2019,4095463099662.97
Somalia,2018,6384748042.2603
Guinea,2018,11433119038.1247
Guyana,2016,4442813034.63534
Hungary,2017,133416713057.02
Austria,2019,414257026093.423
Switzerland,2016,716509848990.836
Ireland,2017,324004099585.745
Turkmenistan,2016,38019296559.4106
Uganda,2018,37204541627.5275
Latin America & Caribbean (IDA & IBRD),2018,5327267303713.92
Equatorial Guinea,2018,10634279180.0445
Kyrgyz Republic,2016,6967734531.18414
Rwanda,2016,9048893196.08725
Nigeria,2019,502942019447.736
Singapore,2015,308004146057.608
Bahrain,2015,31050638297.8723
Bangladesh,2015,195078678697.23
IDA total,2015,2016489528845.36
Germany,2019,3598891541091.34
Monaco,2015,6261622101.40908
Mozambique,2019,18183590595.087
United Kingdom,2018,3139010897079.7
Zimbabwe,2015,19963120600.0
Zimbabwe,2017,21061283685.9496
Luxembourg,2015,60047430684.2639
Africa Western and Central,2016,761700338996.091
Caribbean small states,2017,72471555398.1925
East Asia & Pacific (excluding high income),2016,14154938722611.4
Chad,2017,9958586245.45557
China,2018,13493418449040.5
Comoros,2017,1036193131.26528
Post-demographic dividend,2016,45430131344849.4
Upper middle income,2018,22922203217852.0
The Bahamas,2015,11890600000.0
Bangladesh,2017,224176245316.101
Tajikistan,2016,8842184615.904
Kuwait,2015,114567298105.683
New Caledonia,2015,8738203041.54819
Djibouti,2015,2430274292.2896
Lao PDR,2019,18491845636.2733
Libya,2015,27842131479.8726
East Asia & Pacific,2017,24133820672087.7
Euro area,2015,11669741216577.3
Malta,2019,13856372628.2222
Sint Maarten (Dutch part),2015,1253072625.69832
Slovenia,2015,43090173394.6913
Romania,2017,199708413252.137
Grenada,2016,1034292546.66362
Isle of Man,2017,7933191749.42704
Vietnam,2018,234736473566.404
Early-demographic dividend,2015,10082377974481.9
East Asia & Pacific (IDA & IBRD),2015,13264224627407.0
Seychelles,2016,1440344964.02941
North Macedonia,2018,10764550800.8128
Sint Maarten (Dutch part),2017,1186296385.47486
Puerto Rico,2016,102069864411.212
Croatia,2016,51935173677.1936
Small states,2015,452206885980.765
Sub-Saharan Africa,2018,1788553116078.23
Switzerland,2015,702149580770.901
Italy,2017,1890662182181.27
United Arab Emirates,2015,358135057862.492
Kosovo,2018,7204705015.86419
Namibia,2018,11341482622.8834
Djibouti,2016,2591951944.03089
Samoa,2019,887495263.360233
Andorra,2017,2903378514.30766
Heavily indebted poor countries (HIPC),2019,788661392496.297
High income,2018,51275691253852.4
Madagascar,2019,13186360351.4331
Slovenia,2019,50249892617.4104
Guam,2017,5861264058.23476
Kazakhstan,2019,211106972039.014
Kenya,2015,70120413328.7838
Niger,2018,11527239152.5743
Lower middle income,2016,6842018337137.11
Portugal,2019,222272974069.03
Guyana,2018,4813398364.26896
Hungary,2018,140567177109.717
Sudan,2015,51726758676.7677
Burkina Faso,2018,14194244080.5891
Northern Mariana Islands,2017,1448278787.87879
Chad,2016,10265387468.6306
Fiji,2016,4797065664.45005
"Macao SAR, China",2018,52389965631.9723
Spain,2017,1267962775991.18
Croatia,2018,55265833941.43
End Exploring Related Columns
Task: Which region has the highest median GDP (constant 2015 US$) value?

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: Based on available data, the region with the highest median GDP (constant 2015 US$) value is North America.

```csv
Region,Median_GDP
North America,value:float
(Attention: answer in one row)
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: 

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-19 08:00:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 08:00:08 - root - INFO - Based on available data, the region with the highest median GDP (constant 2015 US$) value is North America.

```csv
Region,Median_GDP
North America,1696163077026.08
```

```sql
SELECT
  c.region AS Region,
  APPROX_QUANTILES(i.value, 2)[OFFSET(1)] AS Median_GDP
FROM
  `bigquery-public-data.world_bank_wdi.indicators_data` AS i
JOIN
  `bigquery-public-data.world_bank_wdi.country_summary` AS c
ON
  i.country_code = c.country_code
WHERE
  i.indicator_code = 'NY.GDP.MKTP.KD'
  AND i.year = 2019
GROUP BY
  c.region
ORDER BY
  Median_GDP DESC
LIMIT 1;
```
2025-01-19 08:00:10 - root - INFO - itercount: 1
2025-01-19 08:00:10 - root - INFO - 0
2025-01-19 08:00:10 - root - INFO - results: 
Region,Median_GDP
,3431466032627.32


2025-01-19 08:00:10 - root - INFO - Please check the answer again by reviewing Which region has the highest median GDP (constant 2015 US$) value?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: Based on available data, the region with the highest median GDP (constant 2015 US$) value is North America.

```csv
Region,Median_GDP
North America,value:float
(Attention: answer in one row)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Region,Median_GDP
,3431466032627.32
Current sql:
SELECT
  c.region AS Region,
  APPROX_QUANTILES(i.value, 2)[OFFSET(1)] AS Median_GDP
FROM
  `bigquery-public-data.world_bank_wdi.indicators_data` AS i
JOIN
  `bigquery-public-data.world_bank_wdi.country_summary` AS c
ON
  i.country_code = c.country_code
WHERE
  i.indicator_code = 'NY.GDP.MKTP.KD'
  AND i.year = 2019
GROUP BY
  c.region
ORDER BY
  Median_GDP DESC
LIMIT 1;Empty results in Column ['Region']. Please correct them.

2025-01-19 08:00:59 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 08:00:59 - root - INFO - Based on available data, the region with the highest median GDP (constant 2015 US$) value is **North America**.

```csv
Region,Median_GDP
North America,1696163077026.0800
```

```sql
SELECT
  c.region AS Region,
  ROUND(APPROX_QUANTILES(i.value, 2)[OFFSET(1)], 4) AS Median_GDP
FROM
  `bigquery-public-data.world_bank_wdi.indicators_data` AS i
JOIN
  `bigquery-public-data.world_bank_wdi.country_summary` AS c
ON
  i.country_code = c.country_code
WHERE
  i.indicator_code = 'NY.GDP.MKTP.KD'
  AND i.year = 2019
  AND c.region IS NOT NULL
  AND c.region != ''
GROUP BY
  c.region
ORDER BY
  Median_GDP DESC
LIMIT 1;
```

This SQL query calculates the median GDP (constant 2015 US$) for each region in the year 2019 while excluding entries where the `region` is null or empty. It then selects the region with the highest median GDP value, ensuring that the `Region` column has valid data.

**Explanation:**

- **Data Filtering:**
  - We're focusing on the indicator code `'NY.GDP.MKTP.KD'`, which represents GDP (constant 2015 US$).
  - The data is filtered for the year `2019`.
  - We exclude any entries where `c.region` is `NULL` or an empty string to avoid including aggregate groups like "World" or data without a specified region.

- **Calculating Median:**
  - We use `APPROX_QUANTILES(i.value, 2)[OFFSET(1)]` to compute the median GDP value for each region.
  - The `ROUND` function is used to keep all decimals to four decimal places, as per your instruction.

- **Grouping and Ordering:**
  - The results are grouped by `c.region` to calculate the median per region.
  - We order the results in descending order of `Median_GDP` to find the region with the highest median GDP.

- **Final Selection:**
  - `LIMIT 1` ensures that only the region with the highest median GDP is returned.

This query should now provide the correct region and median GDP value, matching the required answer format and addressing the issue of empty `Region` values.
2025-01-19 08:01:01 - root - INFO - itercount: 2
2025-01-19 08:01:01 - root - INFO - 0
2025-01-19 08:01:01 - root - INFO - results: 
Region,Median_GDP
North America,1696163077026.08


2025-01-19 08:01:01 - root - INFO - Please check the answer again by reviewing Which region has the highest median GDP (constant 2015 US$) value?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: Based on available data, the region with the highest median GDP (constant 2015 US$) value is North America.

```csv
Region,Median_GDP
North America,value:float
(Attention: answer in one row)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Region,Median_GDP
North America,1696163077026.08
Current sql:
SELECT
  c.region AS Region,
  ROUND(APPROX_QUANTILES(i.value, 2)[OFFSET(1)], 4) AS Median_GDP
FROM
  `bigquery-public-data.world_bank_wdi.indicators_data` AS i
JOIN
  `bigquery-public-data.world_bank_wdi.country_summary` AS c
ON
  i.country_code = c.country_code
WHERE
  i.indicator_code = 'NY.GDP.MKTP.KD'
  AND i.year = 2019
  AND c.region IS NOT NULL
  AND c.region != ''
GROUP BY
  c.region
ORDER BY
  Median_GDP DESC
LIMIT 1;
2025-01-19 08:02:07 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 08:02:07 - root - INFO - Based on available data, the region with the highest median GDP (constant 2015 US$) value is **North America**.

```csv
Region,Median_GDP
North America,1696163077026.0800
```

```sql
SELECT
  c.region AS Region,
  ROUND(APPROX_QUANTILES(i.value, 2)[OFFSET(1)], 4) AS Median_GDP
FROM
  `bigquery-public-data.world_bank_wdi.indicators_data` AS i
JOIN
  `bigquery-public-data.world_bank_wdi.country_summary` AS c
ON
  i.country_code = c.country_code
WHERE
  i.indicator_code = 'NY.GDP.MKTP.KD'
  AND i.year = 2019
  AND c.region IS NOT NULL
  AND c.region != ''
  AND LENGTH(c.country_code) = 3
  -- Exclude aggregate entities like 'WLD' (World) by ensuring country codes have 3 letters
GROUP BY
  c.region
ORDER BY
  Median_GDP DESC
LIMIT 1;
```

**Explanation:**

- **Data Filtering:**
  - **Indicator Code:** We focus on `'NY.GDP.MKTP.KD'`, which represents GDP (constant 2015 US$).
  - **Year:** We select data for the year `2019`.
  - **Valid Regions:** We exclude entries where `c.region` is `NULL` or an empty string to ensure we're only considering valid regions.
  - **Country Codes:** We ensure that `c.country_code` has a length of 3 characters (`LENGTH(c.country_code) = 3`) to exclude aggregate entities like 'WLD' (World) or region groups which have codes of different lengths.
  
- **Calculating Median:**
  - We use `APPROX_QUANTILES(i.value, 2)[OFFSET(1)]` to compute the median GDP value for each region.
  - The `ROUND` function is applied to keep all decimals to four decimal places, as per your instruction.

- **Grouping and Ordering:**
  - Results are grouped by `c.region` to calculate the median per region.
  - We order the regions in descending order of `Median_GDP` to identify the region with the highest median GDP.

- **Limiting Results:**
  - The query returns only the top result (`LIMIT 1`), which is the region with the highest median GDP.

**Note:**

- The blank `region` from the previous results included aggregate entities and region groupings that are not actual countries. Including these would skew the median GDP calculation.
- By filtering out aggregate entities and focusing on actual countries within valid regions, we accurately determine that **North America** has the highest median GDP value based on the median of its constituent countries' GDPs.

**Consistency with Data:**

- **North America** consists primarily of high-income countries like the United States and Canada, which have substantial GDP figures.
- The median GDP value for North America reflects the high economic output of its countries.

**Final Answer:**

Based on the specified conditions and data, **North America** is the region with the highest median GDP (constant 2015 US$) value.
2025-01-19 08:02:09 - root - INFO - itercount: 3
2025-01-19 08:02:09 - root - INFO - 0
2025-01-19 08:02:09 - root - INFO - Total iteration counts: 3
