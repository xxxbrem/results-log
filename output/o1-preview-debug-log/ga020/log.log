2025-01-19 09:52:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 09:53:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 09:53:07 - root - INFO - SQL:
-- 1. List distinct event names between August 1 and August 15, 2018
SELECT DISTINCT event_name
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
LIMIT 1000;
Results:
event_name
level_fail
level_end
level_start_quickplay
post_score
level_up
level_complete
completed_5_levels
level_start
level_retry
session_start
screen_view
select_content
user_engagement
level_complete_quickplay
level_end_quickplay
level_reset_quickplay
level_fail_quickplay
level_retry_quickplay
challenge_a_friend
use_extra_steps
spend_virtual_currency
app_exception
level_reset
app_remove
os_update
ad_reward
no_more_extra_steps
firebase_campaign
app_update
error
first_open
in_app_purchase
app_clear_data
dynamic_link_app_open

2025-01-19 09:53:10 - root - INFO - SQL:
-- 2. Get user IDs who first engaged between August 1 and August 15, 2018
SELECT DISTINCT user_pseudo_id
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
  AND user_first_touch_timestamp BETWEEN UNIX_MICROS(TIMESTAMP('2018-08-01'))
                                     AND UNIX_MICROS(TIMESTAMP('2018-08-15'))
LIMIT 1000;
Results:
Too long, hard cut:
user_pseudo_id
4EBC9E555CE3316055264858BF18DB51
8EC25BFD4E8CB157030F3692FCAFA8FB
B05B44F98AC43EA887A1B78C3552A927
383F4B98EC31DD2A915427D36A30354E
E1A3C786B2E4D56629EE808A3A174995
52B07E869C01CE684AD503F8F9445125
0CFD16A46A05B5BD29D3A37284B94CBB
C5DE6E85159CC31B2CE9213117956343
08FD622562B214D7B7AC45DC707106ED
8680E9C6F3ABE3B95FCF44EA5D7DB200
B2912116E7B957900D6B69D4E50F0F9A
4542CFA974FAA3C923527BDDA50397B0
89C1D9AF4193728E41F48DC623DEE51F
1B959D672ABAE4A3BFB9D720D415E064
FA596A777C81AFE81313CACC0AC7D6C7
DD17202A1AA5C3250E15ECF69A6FC073
AB48D576008899542044F575FF8DF525
EC51C9E063BA20CC1A6F954E9C963EAE
6D717745A9FF51CA21D39208C1668378
C5D3E8CBDDB09A397F8E6A626106FBC5
42421044D6B3F0190A37145A20403036
0280C8F16D33C9D040B9BDA8B74CAD3A
B22F17D065D62FA2F622CF1B196F92E0
DF2FC56E807EAF16E852AEAB67E0127A
90315F3CE85BB427F960EF2F78972EA6
F916D30FAD36F1282F98AEA3D580BEBE
5B9149282B2EB48FE5AFE1240FC0440E
43D27F6D77E6A3B68872B6786AD0DAB4
DA814428F7E26F091284C8793DE748BD
9AB15754D4B3B28488B088CAFD9DD5DF
154287464C4F84AF86699BC92AA1DAB5
497308A94C26945E008226F51C49C706
8F69F63C94FC7045651B1B164AE7B379
3B1EC879875F9C6B1AAE0A09BE08FA7F
093E3E8BB59252BCD92BA5B7EAE55BBD
E0F1DC58BE9661A3DFD9C3228B179C29
EC895C732092BA9A3CE9F507ED888726
1BA8A3FE9D6AD54C6C77BC8A350BF2DA
2CFE23AC4E3C6529D39BDADA1EF99C52
FC0E10ED9037CA6C75458E20AB85F350
13524092E785CA3DBE2A03A2B5B2EFA5
AB714CB216CB456740B54DD82E11FDB9
7393E3E8A1D61F2A850CD562E6438814
FF5829CCC9DCE80240E620D7D66C709B
2FDD16446C63750D95AAAC6F6B41CB37
B72C3DD50B9F81DBCED2EE06E08796CE
786AAA96746C4084190340D4B8C4710E
7117AD079649D3A342A663E89F3C0355
F454E0D882BF2C7E1E0DF7F96DF78F3B
3CD1DEB660E64A41BA76E124B1C0103F
CD92711913D195448B5032F52C3318D2
C373A2EBDDEB4C3CC895F917254032D4
2C6B6390B8227E00E7CEA32D8E108025
EC7F54960F789EB130267F9A3F247BB1
D2BA6FF865D64BDC12D28BEB9F778997
34587F7996F20BE4CC7DDEB96753D110
55572693175EAD05BD53E8AD7513F379
53C62BFF7D715334B8C3C4904EC34880
3CCC49DD05DF89B1B103E2C22366AA0C
F0AC8F43620EAD7BD3EA00493675AA87
81E2E892D1C23CE76B072FA71310829F
88E99CE30B65345ED0B118869B6AD035
9225A1F12C539431CD0217908688C4E2
C80D68A48ECFFAD588A6784F36BA41F5
AB31249C4D16F5D39299BC1A9D423EE5
F4EA0F2888792BD62555AD46ED534839
8E85F9B503273C041EE56963F6F68C78
5D3AC32A3431337AB937BDAF886D1782
09FF3AA4F3FE00E7FC084395C4615EA6
27D0B01EBF8B78EA0B61171428EFD542
2C7A0851C697F03694BF4364695CA6C0
EA60D1DFDD9E06777E874E280C6417CC
E11BE37FB066E143A0B4C29D2842223A
2357128F5A877DECB2C8FCFA8101884B
28778DE05FE8E9B32044B749FCDDB70D
1D8F8EBFE5F3C95F99A36F627715DF8A
86B2C983E54A5676FAB52B0DCE44A33D
17636078D57884AD7EA5406C60E2BD10
C9A22B291E9B2D3D98262C8D41D703A2
BA68AFBA94C53DA2DE67AA683078AD2A
7FBA8F50097D2948AEA898B7AFA3B72A
D5F162E063EF1129BFE585FD4C4DCB17
DC8912881CD30A0D8D5E2EB666D22901
DA4BCFC16C1735AFFAD960E8B9064525
DDBA0BF4F81311FF87A30D2DDE2171E6
362C4170BE71B71630D1C7790927BD4C
162DCBBB07A1E42728E66853A66556B5
EE3A7EF48E6CA9311D17208B94AFE6D0
B6583219D50D4B342A797369873FE31C
346CD6014841FFAB8A094411970DDD9E
E0189D91AD0A138AA65CB66338B82161
942E123C7E8C0B62935889D03D77BE8E
2183FBF69049963AF568954027E6520D
51C46BC53A765564EDFC48E1EDA7EAED
09352F4FD57960A1DDA0E0619A60D7EE
F811FA3ECC2BA9F049E5A216FAFA301B
EC36E6167D2E25E6E4661EAEB5E5EEAB
1398FAD131CAB04B4B52169E68620CD2
C647FB7C5C6F9EA2F18A78E1AB30B272
222DA52480ED3CD33C632A351A40E8AD
00802DA458DB2440535C1C3796892482
15CD7FD75B0E6F422912F0CBC8123AD1
CCADFC0ECC097AA5DA4FD3917D517022
3C8C2110DC4556D3E28568CA68172047
D5E0BD50D8A6244443E08E2E71B3739D
EE2010FFDAF663BCC722160AB9954A1E
61F5B317AB1EF10E3C7E68C930A1018C
43B9E5915CF39E53BAF74E0B6C201BE1
BB322D2CA948F548EA3A05A2BD93B1A3
ACC9710DAD24A644E2F9360C67EB9110
57EC50FBC6C7277B8EDCCE44C1352BD4
5D53102B0F6AAA96D3FC1C0633890970
A976A39B8E08829A5BC5CD3827C942A2
E920D72AFB16365797955E46913E2599
FFDDF354D9B9E851D2A62ABAEA17DA3E
4E6F4A73B5D05B33DC73B11547E39004
6EE3CB7D6C073894B49F1AF081758A2E
1CE19ED5366D09B6A3E9CCD4AA475B85
469473B2E1C330A74286BA52BA3CACF5
7CBF44EFDDB9E6401F31786BEE071196
B96742012753A7FC58537387657DED5A
3A1B5A55C33A7EF1A37C909A753606B8
38D65030548914B5E167CE85B035CA8F
1AE6C4E5DFF6715503FC7C79A7C0C363
0DF6A14F536F6514A6F18BC12A532A82
F27F046DF960AB50CE65B9F4364C981E
2B6D0DB9D76C581ACB986BBE2408220C
60406ADD3EE12783E9DF7A35EE8570BE
D0D476CA1660A598CBF9E0B6946E031D
567422321BBB432EC2CC014A510E61BD
708EC500ED27377CB738C8005AE4E34E
3C24334270603160F1C27BAAC3B9B714
4479F0349D25059D2499C147B5100D12
257774E79E4827F63414C62DD5C64DE9
4A8D4276A1EBBD17E6CB7EE30FE71CC2
1433C10AF6B6779D48481D84BC8222A4
30C9F1FCEBB2E40593350BBB662344E7
811898C76CEDFA57991289FAC0C1A004
4444B14309355CB56DC2D6AE75FCCA31
84F55D39B331B4D51467A32FECD5F0A5
8F09C3B476E71697EAE0CE7B4EA61606
CE24B98FDB40DFD8FA769844135C2852
39C210B833FE2D53C723E354AB1FAC4D
E973B7846D23B8B642E90184729BE686
B7D2B63ABE215157570ABD2E2E6EC9BE
C13B525407D557296763616356BBCAB5
0061B4B16D4EABF6E23141FBAEEFE7B2
8BC72D1925A8866050D5A6FB01148518
E806F12D29E9F873BE6EAA01CD1E1B4F
93CE02A528E41C078FDB04857CCDA48C
A4A0A491EB22A58225818379E768BE3B
D2

2025-01-19 09:53:16 - root - INFO - SQL:
-- 3. Retrieve event names related to quickplay events
SELECT DISTINCT event_name
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE LOWER(event_name) LIKE '%quickplay%'
LIMIT 1000;
Results:
event_name
level_retry_quickplay
level_fail_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_reset_quickplay

2025-01-19 09:53:22 - root - INFO - SQL:
-- 4. List event parameters for quickplay events
SELECT event_params
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE LOWER(event_name) LIKE '%quickplay%'
LIMIT 1000;
Results:
Too long, hard cut:
event_params
"[{'key': 'value', 'value': {'string_value': None, 'int_value': 22, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_class', 'value': {'string_value': 'game_board', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'app+gtm', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': -8429148202203700265, 'float_value': None, 'double_value': None}}, {'key': 'board', 'value': {'string_value': 'S', 'int_value': None, 'float_value': None, 'double_value': None}}]"
"[{'key': 'firebase_screen_class', 'value': {'string_value': 'game_board', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'app+gtm', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': -8429148202203700265, 'float_value': None, 'double_value': None}}, {'key': 'board', 'value': {'string_value': 'S', 'int_value': None, 'float_value': None, 'double_value': None}}]"
"[{'key': 'firebase_screen_class', 'value': {'string_value': 'game_board', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'app+gtm', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': -8429148202203700265, 'float_value': None, 'double_value': None}}, {'key': 'board', 'value': {'string_value': 'S', 'int_value': None, 'float_value': None, 'double_value': None}}]"
"[{'key': 'firebase_screen_class', 'value': {'string_value': 'game_board', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'app+gtm', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': -8429148202203700265, 'float_value': None, 'double_value': None}}, {'key': 'board', 'value': {'string_value': 'S', 'int_value': None, 'float_value': None, 'double_value': None}}]"
"[{'key': 'firebase_screen_class', 'value': {'string_value': 'game_board', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'app+gtm', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': -8429148202203700265, 'float_value': None, 'double_value': None}}, {'key': 'board', 'value': {'string_value': 'S', 'int_value': None, 'float_value': None, 'double_value': None}}]"
"[{'key': 'firebase_screen_class', 'value': {'string_value': 'game_board', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'app+gtm', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': -8429148202203700265, 'float_value': None, 'double_value': None}}, {'key': 'board', 'value': {'string_value': 'S', 'int_value': None, 'float_value': None, 'double_value': None}}]"
"[{'key': 'firebase_screen_class', 'value': {'string_value': 'game_over', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'app+gtm', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': -8429148202203700217, 'float_value': None, 'double_value': None}}, {'key': 'board', 'value': {'string_value': 'S', 'int_value': None, 'float_value': None, 'double_value': None}}]"
"[{'key': 'firebase_screen_class', 'value': {'string_value': 'game_board', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'app+gtm', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': -8429148202203700265, 'float_value': None, 'double_value': None}}, {'key': 'board', 'value': {'string_value': 'S', 'int_value': None, 'float_value': None, 'double_value': None}}]"
"[{'key': 'firebase_screen_class', 'value': {'string_value': 'game_board', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'app+gtm', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': -8429148202203700265, 'float_value': None, 'double_value': None}}, {'key': 'board', 'value': {'string_value': 'S', 'int_value': None, 'float_value': None, 'double_value': None}}]"
"[{'key': 'firebase_screen_class', 'value': {'string_value': 'game_board', 'int_value': None, 'float_value': None, 'double_va

2025-01-19 09:53:28 - root - INFO - SQL:
-- 5. Extract 'event_type' from event parameters in quickplay events
SELECT
  t.event_name,
  (SELECT value.string_value FROM UNNEST(t.event_params) WHERE key = 'event_type') AS event_type
FROM `firebase-public-project.analytics_153293282.events_*` AS t
WHERE LOWER(event_name) LIKE '%quickplay%'
LIMIT 1000;
Results:
Too long, hard cut:
event_name,event_type
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_start_quickplay,
level_end_quickplay,
level_retry_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_end_quickplay,
level_start_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_start_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_fail_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_fail_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_retry_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_retry_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_retry_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_qu

2025-01-19 09:54:06 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 09:54:06 - root - INFO - ```sql
WITH initial_engagement AS (
  SELECT DISTINCT user_pseudo_id, event_name
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
    AND LOWER(event_name) LIKE '%quickplay%'
),

user_first_engagement_date AS (
  SELECT user_pseudo_id,
         MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_engagement_date
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
    AND LOWER(event_name) LIKE '%quickplay%'
  GROUP BY user_pseudo_id
),

second_week_engagement AS (
  SELECT DISTINCT t.user_pseudo_id, t.event_name
  FROM `firebase-public-project.analytics_153293282.events_*` AS t
  JOIN user_first_engagement_date AS u
    ON t.user_pseudo_id = u.user_pseudo_id
  WHERE PARSE_DATE('%Y%m%d', t.event_date) BETWEEN DATE_ADD(u.first_engagement_date, INTERVAL 7 DAY) AND DATE_ADD(u.first_engagement_date, INTERVAL 14 DAY)
    AND LOWER(t.event_name) LIKE '%quickplay%'
),

retention AS (
  SELECT
    initial.event_name AS event_type,
    COUNT(DISTINCT initial.user_pseudo_id) AS initial_users,
    COUNT(DISTINCT second.user_pseudo_id) AS retained_users
  FROM initial_engagement AS initial
  LEFT JOIN second_week_engagement AS second
    ON initial.user_pseudo_id = second.user_pseudo_id
    AND initial.event_name = second.event_name
  GROUP BY initial.event_name
)

SELECT event_type,
       (CAST(retained_users AS FLOAT64) / initial_users) * 100 AS second_week_retention_rate
FROM retention
ORDER BY second_week_retention_rate ASC
LIMIT 1;
```
2025-01-19 09:55:12 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 09:55:12 - root - INFO - SQL:
WITH initial_engagement AS (
  SELECT DISTINCT user_pseudo_id, event_name
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
    AND LOWER(event_name) LIKE '%quickplay%'
),

user_first_engagement_date AS (
  SELECT user_pseudo_id,
         MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_engagement_date
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
    AND LOWER(event_name) LIKE '%quickplay%'
  GROUP BY user_pseudo_id
),

second_week_engagement AS (
  SELECT DISTINCT t.user_pseudo_id, t.event_name
  FROM `firebase-public-project.analytics_153293282.events_*` AS t
  JOIN user_first_engagement_date AS u
    ON t.user_pseudo_id = u.user_pseudo_id
  WHERE PARSE_DATE('%Y%m%d', t.event_date) BETWEEN DATE_ADD(u.first_engagement_date, INTERVAL 7 DAY) AND DATE_ADD(u.first_engagement_date, INTERVAL 14 DAY)
    AND LOWER(t.event_name) LIKE '%quickplay%'
),

retention AS (
  SELECT
    initial.event_name AS event_type,
    COUNT(DISTINCT initial.user_pseudo_id) AS initial_users,
    COUNT(DISTINCT second.user_pseudo_id) AS retained_users
  FROM initial_engagement AS initial
  LEFT JOIN second_week_engagement AS second
    ON initial.user_pseudo_id = second.user_pseudo_id
    AND initial.event_name = second.event_name
  GROUP BY initial.event_name
)

SELECT event_type,
       (CAST(retained_users AS FLOAT64) / initial_users) * 100 AS second_week_retention_rate
FROM retention
ORDER BY second_week_retention_rate ASC
LIMIT 1;
Results:
event_type,second_week_retention_rate
level_reset_quickplay,24.02135231316726

2025-01-19 09:55:18 - root - INFO - SQL:
-- 7. Retrieve user engagement in the second week after initial engagement
WITH user_first_engagement_date AS (
  SELECT user_pseudo_id,
         MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_engagement_date
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
  GROUP BY user_pseudo_id
)
SELECT
  t.user_pseudo_id,
  t.event_date,
  t.event_name
FROM `firebase-public-project.analytics_153293282.events_*` AS t
JOIN user_first_engagement_date AS u
  ON t.user_pseudo_id = u.user_pseudo_id
WHERE PARSE_DATE('%Y%m%d', t.event_date) BETWEEN DATE_ADD(u.first_engagement_date, INTERVAL 7 DAY)
                                            AND DATE_ADD(u.first_engagement_date, INTERVAL 14 DAY)
LIMIT 1000
Results:
Too long, hard cut:
user_pseudo_id,event_date,event_name
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,level_start
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,session_start
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,screen_view
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,screen_view
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,screen_view
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,screen_view
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,screen_view
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,screen_view
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,screen_view
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,screen_view
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,select_content
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,select_content
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,user_engagement
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,user_engagement
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,user_engagement
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,user_engagement
BB322D2CA948F548EA3A05A2BD93B1A3,20180813,level_start_quickplay
BB322D2CA948F548EA3A05A2BD93B1A3,20180813,session_start
BB322D2CA948F548EA3A05A2BD93B1A3,20180813,screen_view
BB322D2CA948F548EA3A05A2BD93B1A3,20180813,screen_view
BB322D2CA948F548EA3A05A2BD93B1A3,20180813,screen_view
BB322D2CA948F548EA3A05A2BD93B1A3,20180813,screen_view
BB322D2CA948F548EA3A05A2BD93B1A3,20180813,select_content
BB322D2CA948F548EA3A05A2BD93B1A3,20180813,user_engagement
D5544C064404DC6067412B1272F848D6,20180813,level_fail
D5544C064404DC6067412B1272F848D6,20180813,level_end
D5544C064404DC6067412B1272F848D6,20180813,post_score
D5544C064404DC6067412B1272F848D6,20180813,level_up
D5544C064404DC6067412B1272F848D6,20180813,completed_5_levels
D5544C064404DC6067412B1272F848D6,20180813,level_complete
D5544C064404DC6067412B1272F848D6,20180813,level_start
D5544C064404DC6067412B1272F848D6,20180813,level_end
D5544C064404DC6067412B1272F848D6,20180813,level_retry
D5544C064404DC6067412B1272F848D6,20180813,level_start
D5544C064404DC6067412B1272F848D6,20180813,level_retry
D5544C064404DC6067412B1272F848D6,20180813,level_start
D5544C064404DC6067412B1272F848D6,20180813,level_reset
D5544C064404DC6067412B1272F848D6,20180813,level_start
D5544C064404DC6067412B1272F848D6,20180813,session_start
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,select_content
D5544C064404DC6067412B1272F848D6,20180813,select_content
D5544C064404DC6067412B1272F848D6,20180813,user_engagement
D5544C064404DC6067412B1272F848D6,20180813,user_engagement
D5544C064404DC6067412B1272F848D6,20180813,user_engagement
D5544C064404DC6067412B1272F848D6,20180813,user_engagement
D5544C064404DC6067412B1272F848D6,20180813,user_engagement
D5544C064404DC6067412B1272F848D6,20180813,user_engagement
D5544C064404DC6067412B1272F848D6,20180813,user_engagement
D5544C064404DC6067412B1272F848D6,20180813,user_engagement
D5544C064404DC6067412B1272F848D6,20180813,user_engagement
D5544C064404DC6067412B1272F848D6,20180813,user_engagement
023A2DB99CC3F70A4B71869C36952D74,20180813,screen_view
023A2DB99CC3F70A4B71869C36952D74,20180813,screen_view
023A2DB99CC3F70A4B71869C36952D74,20180813,user_engagement
023A2DB99CC3F70A4B71869C36952D74,20180813,user_engagement
023A2DB99CC3F70A4B71869C36952D74,20180813,user_engagement
023A2DB99CC3F70A4B71869C36952D74,20180813,user_engagement
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_fail
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_fail
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_end
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_fail
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_fail
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_end
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_fail
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_end
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_complete_quickplay
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_complete_quickplay
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_complete_quickplay
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_complete_quickplay
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_complete_quickplay
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_complete_quickplay
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_complete_quickplay
57EC50FBC6C7277B8EDCCE4

2025-01-19 09:55:24 - root - INFO - SQL:
-- 8. Find the platforms used by users engaging in quickplay events
SELECT DISTINCT platform
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE LOWER(event_name) LIKE '%quickplay%'
  AND platform IS NOT NULL
LIMIT 1000
Results:
platform
ANDROID
IOS

2025-01-19 09:55:26 - root - INFO - SQL:
-- 9. Count events per day for quickplay events during initial engagement period
SELECT
  event_date,
  COUNT(*) AS event_count
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE LOWER(event_name) LIKE '%quickplay%'
  AND _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
  AND event_date IS NOT NULL
GROUP BY event_date
ORDER BY event_date
LIMIT 1000
Results:
event_date,event_count
20180801,11985
20180802,13117
20180803,11013
20180804,11271
20180805,11764
20180806,11234
20180807,11121
20180808,11045
20180809,10574
20180810,11234
20180811,11376
20180812,10796
20180813,10949
20180814,12652
20180815,13366

2025-01-19 09:55:32 - root - INFO - SQL:
-- 10. List device categories used in quickplay events
SELECT DISTINCT device.category
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE LOWER(event_name) LIKE '%quickplay%'
  AND device.category IS NOT NULL
LIMIT 1000
Results:
category
mobile
tablet

2025-01-19 09:55:38 - root - INFO - SQL:
-- 11. Get user retention by counting users who returned in the second week
WITH user_first_engagement_date AS (
  SELECT user_pseudo_id,
         MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_engagement_date
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
  GROUP BY user_pseudo_id
),
second_week_returning_users AS (
  SELECT DISTINCT t.user_pseudo_id
  FROM `firebase-public-project.analytics_153293282.events_*` AS t
  JOIN user_first_engagement_date AS u
    ON t.user_pseudo_id = u.user_pseudo_id
  WHERE PARSE_DATE('%Y%m%d', t.event_date) BETWEEN DATE_ADD(u.first_engagement_date, INTERVAL 7 DAY)
                                              AND DATE_ADD(u.first_engagement_date, INTERVAL 14 DAY)
)
SELECT user_pseudo_id
FROM second_week_returning_users
LIMIT 1000
Results:
Too long, hard cut:
user_pseudo_id
17636078D57884AD7EA5406C60E2BD10
E080406D26F71C9B8F331779CE8B82BA
95999C77751600817821BD41542C91D9
9DE945166BCD4709696C5836317DDE47
D7EA8E3645EFFBD6443946179ED704A6
8F69F63C94FC7045651B1B164AE7B379
229254D7C810F98F72C89A8060E194D4
29D576429D004584017D0A0FE1601455
66EE0DB049AA1A3B92B41375C1263B05
C80CEE0983AB5B21D3F4B46089FDD9EB
A74C05E503F6274BAA9457B2265471F5
372D9BB5088C4E9000C65B06459B403A
D7CF81985E633F6AFA5FDA55D9EF68C2
5E8B4AEF7E3373AA78408DB08E72E3B8
21A83962241B826AB42841AF81329007
12E5626928FE0885DEEF068683E8BD63
7010E53372648835E07BC5A1B8D4D753
82B5DB000108639FF0D38F39D7AC46FD
56B9CBB6CB58106DCCF3CAD660232CB2
A421EBCE8AA69A980AAFC4F141BDEFFB
2F48607C41ECC4015FA296500F0A2C4B
9A12E7E2B3CF644B8304DF8E1A9CE2D8
7EE035CA8E6132A8877C39656896BA41
E6B6CAE2D200FC3EACF21DDE75402DCD
77F125B832C748232EDA6AF8C7D08ED1
74456352647C13028F89D1EEFFB905F4
01C784BDB7AF4DC8DAD6DCD21AF56E25
7F0AB922E141FE5ABB0D03537DFEC330
8B404ABBCDCF859DB2E5ABE00B482621
A976A39B8E08829A5BC5CD3827C942A2
86C0A7CE29E087F5ED9538D2C2B77EBD
79C6CEA7189615EF5319ED1BA55DDE9D
43A68D45096E21AB07F2C15CE21CD5A7
F5CA9C70FB5ACA0C36279A6FB407A7B7
75C00378B3BA26B12559020A83A74355
22DF34962481295121082D8C105EB436
2684EA4DDB1F988E3C979AB15CFF601F
150372F747C719DC8DCC28EC8CBCD93E
334FF61953047FD7AA1D5A661C7E6B81
47F7713B7F3C4F3149A9200360757C6B
CD5A6BBEC21D4DDC4C51AE7922115498
84D4A14B2F6F8A8AF3DF58E6C67A79D5
46BE6557334E701C5036F6762A32E18E
D64DDC2439F7219840E0EEA2AC42CAB4
40E86F2B5D4C7837A3D2BBC1AF18461F
B7D2B63ABE215157570ABD2E2E6EC9BE
00D49153E0790E34D76523EEBEF459B2
241293471505B5DFB907A2AFC5D26BC1
6E03EB3DFD35C31E04ECA7158A756664
E989ADC3B80B10A564559A60763BA8D1
35DDC37EB72373793E703516725BB2FE
CE3148CA8DACC6B0D0C5D234186008BE
ED2314D19E295AB82F96282D3CE4410F
A140217526C281E3031EDD046A1443EE
018CAABB1F4DBDD23D432D211F095B5E
ADDE80C89BB3F6190538E50E541BACD5
D4D701A6BBC568043784A581AD7B936A
C72575F22BA940EDEFBB26EC6A2C3FDE
D8A6BDFA89F65FC9B5159A3031C33004
44386D9242DC9705DAFE219EC2C114F5
1C4A33BABEC27149E2A91113AA79C4D0
648F91A3D0D868FC410FC4614FF11811
9373B5D36107012F6F9137090C523FA1
AD8EC45CB90A8CEFC376341115A6E1E7
D5544C064404DC6067412B1272F848D6
C66BF8A9ACA5CD56597E18B0729181C4
511CBE83E5EE7FDCB123C78CCFAF9EA7
B56E67847E1AE8D6411A5ECCA26585CA
D1CC3A8740095F70116D613EC471A21D
825B7D7600CF41F2EE31628EB361639D
B7B44C7C4701B0E0527E88F3A2529C33
55BFF903A55C62757C592CB25D7F1056
40BA3CE848E99626DACC46BCCEE3E568
A14C5D644176F881FE4BC72B7AF0B988
3D20DEB25C111328B0DEF485060236E6
74253012A39B1F4DE53D4BFF1AB2B5DD
3EF8FC940E379D53BBD3FEFDAF626BB2
CE264AB9D445FF50DA23D24496D50865
2F5BBABE9DD0271DCD62E501F76DA736
E707EF96D408A4FEED0DD25AD19CD9EF
0E05F56141200FF41FCC0C7FA297FF08
2741C47CC50AE98B39CC5B561BFEA504
7D05DF6F0141D016FD20F7B8E71FAB0A
5B888A06EFF60B86B10367EEC3B44E85
F59BEAB1339F76DE62083BE31C73AF1B
47216088A078D06F9220263FAF964F10
EB1A430BACB37E6EA72592BF838E64A6
7AA6572327B5C45D273CCD8868760033
0D17D0247F158FA3E40D21EFF46D1651
FC48EDE912EDD9F8D7ED45F697EE7193
058520E12010190322386C3E356AEE8F
FEC0B30EED7870C4D46230D73032E5CA
EF500E0CF578004836D1D38C8901862B
90D99AC8BC1551757037513287A3B8B4
D47DCBB00B2B462C916A5A07DCFAB039
95BC3B2233ECAE0717CC70A45315365B
B3A9A38A561B3648D280614B8E2D8E07
44A600997B9B6499325D518A19B51FEC
1AE6C4E5DFF6715503FC7C79A7C0C363
343B740C7B3BD9C2CFA46BF097A8856E
EBC3581ADA874D494FBE2C7CCF53BF99
71D9049FE1BB6FB30F0111D464315A10
41A07F6F6C3756427B09AEF18204CA37
C5B527B0AA7603C4EF8C0ECBBCB5372E
F187F3F6C0DFB1FA23483A67AA31A16D
91D637F0D9FB259AD52773B1B20151BE
B10AE521352392E4981BA07E0D86081C
2F72E1976C24D8DFEA138BBCFD304BAC
67D3D76504CC5C4CBFC78EE4FC397C8B
1F54AC7A413B33C6023DA0AF8F489684
938611E83B897B6F877992BF30D3E1FE
5EFCFE3BCD1E9274A83E516E9CDEF2AE
E325B175B66E106477EB7E729C99F8E1
DD2269BCB7F8532CD51CB6854667AF51
359A34F575B808FEFE58BC5B40816F09
8E2CA56C1FD81A095DECAEDE6F2ED626
C0AA6F95B35D0D803F47B299269E716D
019FCC6C080A33E9B697CAA476C4156E
C0ACF48C8E0C4C71C16AB8C3F7D21A2E
1C65943AF5217570A2E4D9B58B6E6FC4
0B9739BFB4122E1863C894E34F812D56
0B08423CCD5F1503B5A8B306FFED999C
1931CC11834A8EC4E576DCA0DE5DFD13
7CA838857E3B7B8C9FC6A34E975FBF22
5888DE5128724573A7E79802BA2D4BC1
F7164A70962E5AED09AD0CEB0A3C7C82
C4E724D4880087C4E1D33F1BCD64A60A
39C210B833FE2D53C723E354AB1FAC4D
1851B906579B2899837742EA924C7280
BB322D2CA948F548EA3A05A2BD93B1A3
1B2FC37816CC4DDAACA97A75E685756F
F720D2FE0350DA0E19A729BE9A4B73FB
2345BDA28F644B3B18B6AE10FBDA000C
D4C8E3E0EFC45C3D60AB3F0F305489AF
6478069CD8A395DE1A022DD9BFD58752
4411385D52B71A3242BDEFDF60609E55
5B4FD8662DAD71406319200659FDF420
693EB525C74694F2E6990CA738F5E5D5
82D556A8003F97B39A2D2E8E5520F9B6
68C5F7CFAEAB93924B7B55D7129C0286
EEA00C45CDC47167CBA1E443296B5B64
4A8D4276A1EBBD17E6CB7EE30FE71CC2
00B6295EC351DBFE0E31015296871E35
C1648883A80997B611743D528CBFF926
91381A6BC5F5E06D1B8DEFD96761751C
1FEB41A72F244D352EA79982CC259EA0
7C632AB83C2A58075244891518D3D415
E063775534D380684BCA33B63B11B213
934A101CA7B97944D05E0FC2ED3E203D
C4411A9EA6C9822AD521C60A4ED25F25
AB32482D193E2CE166B59F82EF78D8BB
83

2025-01-19 09:55:43 - root - INFO - SQL:
-- 12. Extract country information of users participating in quickplay events
SELECT DISTINCT geo.country
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE LOWER(event_name) LIKE '%quickplay%'
  AND geo.country IS NOT NULL
LIMIT 1000
Results:
country
Japan
Pakistan
Belgium
Mauritius
France
China
Zimbabwe
Bangladesh
Dominican Republic
Portugal
St. Lucia
Bahamas
Iran
Uganda
Namibia
Guernsey
Vietnam
Denmark
Costa Rica
Hungary
Honduras
""
Bolivia
Armenia
Bosnia & Herzegovina
Taiwan
Algeria
United Arab Emirates
Switzerland
Martinique
Finland
Tanzania
Luxembourg
Bermuda
El Salvador
Cape Verde
South Africa
Ukraine
Argentina
Israel
Chile
Jordan
Iceland
Italy
Peru
Guadeloupe
Nigeria
Tunisia
Northern Mariana Islands
Venezuela
Latvia
Kuwait
Serbia
Cayman Islands
Afghanistan
Germany
Malaysia
Netherlands
South Korea
Philippines
Lithuania
Turkey
Cyprus
Sri Lanka
Ireland
Puerto Rico
Jamaica
Uzbekistan
Lebanon
United Kingdom
Hong Kong
Indonesia
Poland
Bulgaria
Côte d’Ivoire
Faroe Islands
Ghana
Cameroon
Turkmenistan
Estonia
Montenegro
India
Brazil
Belarus
Panama
Greece
Kenya
Gibraltar
Botswana
Ethiopia
Guatemala
Syria
Sudan
Ecuador
Bahrain
Egypt
Morocco
Russia
Guam
Norway
Trinidad & Tobago
Belize
United States
Canada
Mexico
Mongolia
Caribbean Netherlands
Oman
Chad
Zambia
Australia
Spain
Slovenia
New Zealand
Romania
Slovakia
Aruba
Colombia
Cambodia
Macau
Papua New Guinea
Laos
Brunei
Czechia
Nepal
Austria
Saudi Arabia
Thailand
Sweden
Singapore
Kazakhstan
U.S. Virgin Islands
Iraq
Macedonia (FYROM)
Myanmar (Burma)
Qatar
Croatia
French Polynesia
Uruguay
French Guiana
Malta

2025-01-19 09:55:49 - root - INFO - SQL:
-- 13. Count number of quickplay events per board type
SELECT
  (SELECT value.string_value FROM UNNEST(event_params) WHERE key = 'board') AS board_type,
  COUNT(*) AS event_count
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE LOWER(event_name) LIKE '%quickplay%'
GROUP BY board_type
LIMIT 1000
Results:
board_type,event_count
S,1131752
L,121215
M,100532

2025-01-19 09:55:55 - root - INFO - SQL:
-- 14. List user properties for users engaged in quickplay events
SELECT
  user_pseudo_id,
  prop.key,
  prop.value.string_value AS string_value,
  prop.value.int_value AS int_value,
  prop.value.float_value AS float_value,
  prop.value.double_value AS double_value
FROM `firebase-public-project.analytics_153293282.events_*`,
UNNEST(user_properties) AS prop
WHERE LOWER(event_name) LIKE '%quickplay%'
LIMIT 1000
Results:
Too long, hard cut:
user_pseudo_id,key,string_value,int_value,float_value,double_value
630BD3C34C2E3BE5504A3B06CAE40320,ad_frequency,4,,,
630BD3C34C2E3BE5504A3B06CAE40320,initial_extra_steps,10,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_quickplay,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,num_levels_available,30,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_4,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_progressive,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_1,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,first_open_time,,1517883202364000.0,,
630BD3C34C2E3BE5504A3B06CAE40320,ad_frequency,4,,,
630BD3C34C2E3BE5504A3B06CAE40320,initial_extra_steps,10,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_quickplay,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,num_levels_available,30,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_4,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_progressive,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_1,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,first_open_time,,1517883202364000.0,,
630BD3C34C2E3BE5504A3B06CAE40320,ad_frequency,4,,,
630BD3C34C2E3BE5504A3B06CAE40320,initial_extra_steps,10,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_quickplay,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,num_levels_available,30,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_4,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_progressive,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_1,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,first_open_time,,1517883202364000.0,,
630BD3C34C2E3BE5504A3B06CAE40320,ad_frequency,4,,,
630BD3C34C2E3BE5504A3B06CAE40320,initial_extra_steps,10,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_quickplay,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,num_levels_available,30,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_4,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_progressive,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_1,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,first_open_time,,1517883202364000.0,,
630BD3C34C2E3BE5504A3B06CAE40320,ad_frequency,4,,,
630BD3C34C2E3BE5504A3B06CAE40320,initial_extra_steps,10,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_quickplay,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,num_levels_available,30,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_4,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_progressive,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_1,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,first_open_time,,1517883202364000.0,,
630BD3C34C2E3BE5504A3B06CAE40320,ad_frequency,4,,,
630BD3C34C2E3BE5504A3B06CAE40320,initial_extra_steps,10,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_quickplay,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,num_levels_available,30,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_4,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_progressive,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_1,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,first_open_time,,1517883202364000.0,,
630BD3C34C2E3BE5504A3B06CAE40320,ad_frequency,4,,,
630BD3C34C2E3BE5504A3B06CAE40320,initial_extra_steps,10,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_quickplay,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,num_levels_available,30,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_4,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_progressive,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_1,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,first_open_time,,1517883202364000.0,,
630BD3C34C2E3BE5504A3B06CAE40320,ad_frequency,4,,,
630BD3C34C2E3BE5504A3B06CAE40320,initial_extra_steps,10,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_quickplay,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,num_levels_available,30,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_4,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_progressive,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_1,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,first_open_time,,1517883202364000.0,,
630BD3C34C2E3BE5504A3B06CAE40320,ad_frequency,4,,,
630BD3C34C2E3BE5504A3B06CAE40320,initial_extra_steps,10,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_quickplay,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,num_levels_available,30,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_4,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_progressive,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_1,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,first_open_time,,1517883202364000.0,,
630BD3C34C2E3BE5504A3B06CAE40320,ad_frequency,4,,,
630BD3C34C2E3BE5504A3B06CAE40320,initial_extra_steps,10,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_quickplay,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,num_levels_available,30,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_4,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_progressive,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_1,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,first_open_time,,1517883202364000.0,,
630BD3C34C2E3BE5504A3B06CAE40320,ad_frequency,4,,,
630BD3C34C2E3BE5504A3B06CAE40320,initial_extra_steps,10,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_quickplay,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,num_levels_available,30,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_4,0,,,
630BD3C34C2E3BE5504A3B0

2025-01-19 09:56:44 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 09:56:44 - root - INFO - ```sql
SELECT
  t.user_pseudo_id,
  prop.key,
  prop.value.string_value AS string_value,
  prop.value.int_value AS int_value,
  prop.value.float_value AS float_value,
  prop.value.double_value AS double_value
FROM `firebase-public-project.analytics_153293282.events_*` AS t
CROSS JOIN UNNEST(t.user_properties) AS prop
LIMIT 1000;
```
2025-01-19 09:57:28 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 09:57:28 - root - INFO - SQL:
SELECT
  t.user_pseudo_id,
  prop.key,
  prop.value.string_value AS string_value,
  prop.value.int_value AS int_value,
  prop.value.float_value AS float_value,
  prop.value.double_value AS double_value
FROM `firebase-public-project.analytics_153293282.events_*` AS t
CROSS JOIN UNNEST(t.user_properties) AS prop
LIMIT 1000;
Results:
Too long, hard cut:
user_pseudo_id,key,string_value,int_value,float_value,double_value
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609

2025-01-19 09:57:33 - root - INFO - SQL:
-- Corrected Query #5: Extract 'board' from event parameters in quickplay events
SELECT
  t.event_name,
  (SELECT value.string_value FROM UNNEST(t.event_params) WHERE key = 'board') AS board
FROM `firebase-public-project.analytics_153293282.events_*` AS t
WHERE LOWER(event_name) LIKE '%quickplay%'
LIMIT 1000
Results:
Too long, hard cut:
event_name,board
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_retry_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_fail_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_fail_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_retry_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_retry_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_retry_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_

2025-01-19 09:57:36 - root - INFO - SQL:
-- Corrected Query #6: Count number of users per board type in quickplay events
SELECT
  (SELECT value.string_value FROM UNNEST(t.event_params) WHERE key = 'board') AS board_type,
  COUNT(DISTINCT user_pseudo_id) AS user_count
FROM `firebase-public-project.analytics_153293282.events_*` AS t
WHERE LOWER(event_name) LIKE '%quickplay%'
  AND _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
GROUP BY board_type
LIMIT 1000
Results:
board_type,user_count
S,1782
M,167
L,157

2025-01-19 09:57:41 - root - INFO - SQL:
-- Corrected Query #13: Count number of quickplay events per board type
SELECT
  (SELECT value.string_value FROM UNNEST(event_params) WHERE key = 'board') AS board_type,
  COUNT(*) AS event_count
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE LOWER(event_name) LIKE '%quickplay%'
GROUP BY board_type
LIMIT 1000
Results:
board_type,event_count
L,121215
M,100532
S,1131752

2025-01-19 09:57:47 - root - INFO - SQL:
-- Corrected Query #14: List user properties for users engaged in quickplay events
SELECT
  t.user_pseudo_id,
  prop.key,
  prop.value.string_value AS string_value,
  prop.value.int_value AS int_value,
  prop.value.float_value AS float_value,
  prop.value.double_value AS double_value
FROM `firebase-public-project.analytics_153293282.events_*` AS t
CROSS JOIN UNNEST(t.user_properties) AS prop
WHERE LOWER(t.event_name) LIKE '%quickplay%'
LIMIT 1000
Results:
Too long, hard cut:
user_pseudo_id,key,string_value,int_value,float_value,double_value
295D9E24D8DE65A010313E667131EF19,plays_quickplay,true,,,
295D9E24D8DE65A010313E667131EF19,num_levels_available,30,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_4,1,,,
295D9E24D8DE65A010313E667131EF19,plays_progressive,true,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_1,0,,,
295D9E24D8DE65A010313E667131EF19,first_open_time,,1531061434675000.0,,
295D9E24D8DE65A010313E667131EF19,ad_frequency,4,,,
295D9E24D8DE65A010313E667131EF19,initial_extra_steps,10,,,
295D9E24D8DE65A010313E667131EF19,plays_quickplay,true,,,
295D9E24D8DE65A010313E667131EF19,num_levels_available,30,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_4,1,,,
295D9E24D8DE65A010313E667131EF19,plays_progressive,true,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_1,0,,,
295D9E24D8DE65A010313E667131EF19,first_open_time,,1531061434675000.0,,
295D9E24D8DE65A010313E667131EF19,ad_frequency,4,,,
295D9E24D8DE65A010313E667131EF19,initial_extra_steps,10,,,
295D9E24D8DE65A010313E667131EF19,plays_quickplay,true,,,
295D9E24D8DE65A010313E667131EF19,num_levels_available,30,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_4,1,,,
295D9E24D8DE65A010313E667131EF19,plays_progressive,true,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_1,0,,,
295D9E24D8DE65A010313E667131EF19,first_open_time,,1531061434675000.0,,
295D9E24D8DE65A010313E667131EF19,ad_frequency,4,,,
295D9E24D8DE65A010313E667131EF19,initial_extra_steps,10,,,
295D9E24D8DE65A010313E667131EF19,plays_quickplay,true,,,
295D9E24D8DE65A010313E667131EF19,num_levels_available,30,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_4,1,,,
295D9E24D8DE65A010313E667131EF19,plays_progressive,true,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_1,0,,,
295D9E24D8DE65A010313E667131EF19,first_open_time,,1531061434675000.0,,
295D9E24D8DE65A010313E667131EF19,ad_frequency,4,,,
295D9E24D8DE65A010313E667131EF19,initial_extra_steps,10,,,
295D9E24D8DE65A010313E667131EF19,plays_quickplay,true,,,
295D9E24D8DE65A010313E667131EF19,num_levels_available,30,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_4,1,,,
295D9E24D8DE65A010313E667131EF19,plays_progressive,true,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_1,0,,,
295D9E24D8DE65A010313E667131EF19,first_open_time,,1531061434675000.0,,
295D9E24D8DE65A010313E667131EF19,ad_frequency,4,,,
295D9E24D8DE65A010313E667131EF19,initial_extra_steps,10,,,
295D9E24D8DE65A010313E667131EF19,plays_quickplay,true,,,
295D9E24D8DE65A010313E667131EF19,num_levels_available,30,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_4,1,,,
295D9E24D8DE65A010313E667131EF19,plays_progressive,true,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_1,0,,,
295D9E24D8DE65A010313E667131EF19,first_open_time,,1531061434675000.0,,
295D9E24D8DE65A010313E667131EF19,ad_frequency,4,,,
295D9E24D8DE65A010313E667131EF19,initial_extra_steps,10,,,
295D9E24D8DE65A010313E667131EF19,plays_quickplay,true,,,
295D9E24D8DE65A010313E667131EF19,num_levels_available,30,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_4,1,,,
295D9E24D8DE65A010313E667131EF19,plays_progressive,true,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_1,0,,,
295D9E24D8DE65A010313E667131EF19,first_open_time,,1531061434675000.0,,
295D9E24D8DE65A010313E667131EF19,ad_frequency,4,,,
295D9E24D8DE65A010313E667131EF19,initial_extra_steps,10,,,
295D9E24D8DE65A010313E667131EF19,plays_quickplay,true,,,
295D9E24D8DE65A010313E667131EF19,num_levels_available,30,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_4,1,,,
295D9E24D8DE65A010313E667131EF19,plays_progressive,true,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_1,0,,,
295D9E24D8DE65A010313E667131EF19,first_open_time,,1531061434675000.0,,
295D9E24D8DE65A010313E667131EF19,ad_frequency,4,,,
295D9E24D8DE65A010313E667131EF19,initial_extra_steps,10,,,
295D9E24D8DE65A010313E667131EF19,plays_quickplay,true,,,
295D9E24D8DE65A010313E667131EF19,num_levels_available,30,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_4,1,,,
295D9E24D8DE65A010313E667131EF19,plays_progressive,true,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_1,0,,,
295D9E24D8DE65A010313E667131EF19,first_open_time,,1531061434675000.0,,
295D9E24D8DE65A010313E667131EF19,ad_frequency,4,,,
295D9E24D8DE65A010313E667131EF19,initial_extra_steps,10,,,
295D9E24D8DE65A010313E667131EF19,plays_quickplay,true,,,
295D9E24D8DE65A010313E667131EF19,num_levels_available,30,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_4,1,,,
295D9E24D8DE65A010313E667131EF19,plays_progressive,true,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_1,0,,,
295D9E24D8DE65A010313E667131EF19,first_open_time,,1531061434675000.0,,
295D9E24D8DE65A010313E667131EF19,ad_frequency,4,,,
295D9E24D8DE65A010313E667131EF19,initial_extra_steps,10,,,
295D9E24D8DE65A010313E667131EF19,plays_quickplay,true,,,
295D9E24D8DE65A010313E667131EF19,num_levels_available,30,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_4,1,,,
295D9E24D8DE65A010313E667131EF19,plays_progressive,true,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_1,0,,,
295D9E24D8DE65A010313

2025-01-19 09:58:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 09:58:08 - root - INFO - ```sql
SELECT
  t.user_pseudo_id,
  prop.key,
  prop.value.string_value AS string_value,
  prop.value.int_value AS int_value,
  prop.value.float_value AS float_value,
  prop.value.double_value AS double_value
FROM `firebase-public-project.analytics_153293282.events_*` AS t
CROSS JOIN UNNEST(t.user_properties) AS prop
WHERE t.user_pseudo_id IN (
    SELECT DISTINCT user_pseudo_id
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE LOWER(event_name) LIKE '%quickplay%'
)
LIMIT 1000;
```
2025-01-19 09:59:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 09:59:02 - root - INFO - SQL:
SELECT
  t.user_pseudo_id,
  prop.key,
  prop.value.string_value AS string_value,
  prop.value.int_value AS int_value,
  prop.value.float_value AS float_value,
  prop.value.double_value AS double_value
FROM `firebase-public-project.analytics_153293282.events_*` AS t
CROSS JOIN UNNEST(t.user_properties) AS prop
WHERE t.user_pseudo_id IN (
    SELECT DISTINCT user_pseudo_id
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE LOWER(event_name) LIKE '%quickplay%'
)
LIMIT 1000;
Results:
Too long, hard cut:
user_pseudo_id,key,string_value,int_value,float_value,double_value
7705D52DD2286DC2E6DB831A2E129E94,ad_frequency,16,,,
7705D52DD2286DC2E6DB831A2E129E94,initial_extra_steps,20,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_quickplay,true,,,
7705D52DD2286DC2E6DB831A2E129E94,num_levels_available,30,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_4,2,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_progressive,true,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_1,3,,,
7705D52DD2286DC2E6DB831A2E129E94,first_open_time,,1536544162346000.0,,
7705D52DD2286DC2E6DB831A2E129E94,ad_frequency,16,,,
7705D52DD2286DC2E6DB831A2E129E94,initial_extra_steps,20,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_quickplay,true,,,
7705D52DD2286DC2E6DB831A2E129E94,num_levels_available,30,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_4,2,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_progressive,true,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_1,3,,,
7705D52DD2286DC2E6DB831A2E129E94,first_open_time,,1536544162346000.0,,
7705D52DD2286DC2E6DB831A2E129E94,ad_frequency,16,,,
7705D52DD2286DC2E6DB831A2E129E94,initial_extra_steps,20,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_quickplay,true,,,
7705D52DD2286DC2E6DB831A2E129E94,num_levels_available,30,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_4,2,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_progressive,true,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_1,3,,,
7705D52DD2286DC2E6DB831A2E129E94,first_open_time,,1536544162346000.0,,
7705D52DD2286DC2E6DB831A2E129E94,ad_frequency,16,,,
7705D52DD2286DC2E6DB831A2E129E94,initial_extra_steps,20,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_quickplay,true,,,
7705D52DD2286DC2E6DB831A2E129E94,num_levels_available,30,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_4,2,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_progressive,true,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_1,3,,,
7705D52DD2286DC2E6DB831A2E129E94,first_open_time,,1536544162346000.0,,
7705D52DD2286DC2E6DB831A2E129E94,ad_frequency,16,,,
7705D52DD2286DC2E6DB831A2E129E94,initial_extra_steps,20,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_quickplay,true,,,
7705D52DD2286DC2E6DB831A2E129E94,num_levels_available,30,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_4,2,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_progressive,true,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_1,3,,,
7705D52DD2286DC2E6DB831A2E129E94,first_open_time,,1536544162346000.0,,
7705D52DD2286DC2E6DB831A2E129E94,ad_frequency,16,,,
7705D52DD2286DC2E6DB831A2E129E94,initial_extra_steps,20,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_quickplay,true,,,
7705D52DD2286DC2E6DB831A2E129E94,num_levels_available,30,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_4,2,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_progressive,true,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_1,3,,,
7705D52DD2286DC2E6DB831A2E129E94,first_open_time,,1536544162346000.0,,
7705D52DD2286DC2E6DB831A2E129E94,ad_frequency,16,,,
7705D52DD2286DC2E6DB831A2E129E94,initial_extra_steps,20,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_quickplay,true,,,
7705D52DD2286DC2E6DB831A2E129E94,num_levels_available,30,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_4,2,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_progressive,true,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_1,3,,,
7705D52DD2286DC2E6DB831A2E129E94,first_open_time,,1536544162346000.0,,
7705D52DD2286DC2E6DB831A2E129E94,ad_frequency,16,,,
7705D52DD2286DC2E6DB831A2E129E94,initial_extra_steps,20,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_quickplay,true,,,
7705D52DD2286DC2E6DB831A2E129E94,num_levels_available,30,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_4,2,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_progressive,true,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_1,3,,,
7705D52DD2286DC2E6DB831A2E129E94,first_open_time,,1536544162346000.0,,
7705D52DD2286DC2E6DB831A2E129E94,ad_frequency,16,,,
7705D52DD2286DC2E6DB831A2E129E94,initial_extra_steps,20,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_quickplay,true,,,
7705D52DD2286DC2E6DB831A2E129E94,num_levels_available,30,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_4,2,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_progressive,true,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_1,3,,,
7705D52DD2286DC2E6DB831A2E129E94,first_open_time,,1536544162346000.0,,
7705D52DD2286DC2E6DB831A2E129E94,ad_frequency,16,,,
7705D52DD2286DC2E6DB831A2E129E94,initial_extra_steps,20,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_quickplay,true,,,
7705D52DD2286DC2E6DB831A2E129E94,num_levels_available,30,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_4,2,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_progressive,true,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_1,3,,,
7705D52DD2286DC2E6DB831A2E129E94,first_open_time,,1536544162346000.0,,
7705D52DD2286DC2E6DB831A2E129E94,ad_frequency,16,,,
7705D52DD2286DC2E6DB831A2E129E94,initial_extra_steps,20,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_quickplay,true,,,
7705D52DD2286DC2E6DB831A2E129E94,num_levels_available,30,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_4,2,,,
7705D52DD228

2025-01-19 09:59:31 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 09:59:31 - root - INFO - ```sql
SELECT
  t.user_pseudo_id,
  prop.key,
  prop.value.string_value AS string_value,
  prop.value.int_value AS int_value,
  prop.value.float_value AS float_value,
  prop.value.double_value AS double_value
FROM `firebase-public-project.analytics_153293282.events_*` AS t
CROSS JOIN UNNEST(t.user_properties) AS prop
WHERE LOWER(t.event_name) LIKE '%quickplay%'
LIMIT 1000;
```
2025-01-19 10:00:20 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 10:00:20 - root - INFO - SQL:
SELECT
  t.user_pseudo_id,
  prop.key,
  prop.value.string_value AS string_value,
  prop.value.int_value AS int_value,
  prop.value.float_value AS float_value,
  prop.value.double_value AS double_value
FROM `firebase-public-project.analytics_153293282.events_*` AS t
CROSS JOIN UNNEST(t.user_properties) AS prop
WHERE LOWER(t.event_name) LIKE '%quickplay%'
LIMIT 1000;
Results:
Too long, hard cut:
user_pseudo_id,key,string_value,int_value,float_value,double_value
1879629E259EAE7CC648E2F33CD77776,plays_quickplay,true,,,
1879629E259EAE7CC648E2F33CD77776,num_levels_available,30,,,
1879629E259EAE7CC648E2F33CD77776,firebase_last_notification,4103780380169369052,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_4,0,,,
1879629E259EAE7CC648E2F33CD77776,plays_progressive,true,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_1,0,,,
1879629E259EAE7CC648E2F33CD77776,first_open_time,,1483570824513000.0,,
1879629E259EAE7CC648E2F33CD77776,ad_frequency,3,,,
1879629E259EAE7CC648E2F33CD77776,initial_extra_steps,10,,,
1879629E259EAE7CC648E2F33CD77776,plays_quickplay,true,,,
1879629E259EAE7CC648E2F33CD77776,num_levels_available,30,,,
1879629E259EAE7CC648E2F33CD77776,firebase_last_notification,4103780380169369052,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_4,0,,,
1879629E259EAE7CC648E2F33CD77776,plays_progressive,true,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_1,0,,,
1879629E259EAE7CC648E2F33CD77776,first_open_time,,1483570824513000.0,,
1879629E259EAE7CC648E2F33CD77776,ad_frequency,3,,,
1879629E259EAE7CC648E2F33CD77776,initial_extra_steps,10,,,
1879629E259EAE7CC648E2F33CD77776,plays_quickplay,true,,,
1879629E259EAE7CC648E2F33CD77776,num_levels_available,30,,,
1879629E259EAE7CC648E2F33CD77776,firebase_last_notification,4103780380169369052,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_4,0,,,
1879629E259EAE7CC648E2F33CD77776,plays_progressive,true,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_1,0,,,
1879629E259EAE7CC648E2F33CD77776,first_open_time,,1483570824513000.0,,
1879629E259EAE7CC648E2F33CD77776,ad_frequency,3,,,
1879629E259EAE7CC648E2F33CD77776,initial_extra_steps,10,,,
1879629E259EAE7CC648E2F33CD77776,plays_quickplay,true,,,
1879629E259EAE7CC648E2F33CD77776,num_levels_available,30,,,
1879629E259EAE7CC648E2F33CD77776,firebase_last_notification,4103780380169369052,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_4,0,,,
1879629E259EAE7CC648E2F33CD77776,plays_progressive,true,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_1,0,,,
1879629E259EAE7CC648E2F33CD77776,first_open_time,,1483570824513000.0,,
1879629E259EAE7CC648E2F33CD77776,ad_frequency,3,,,
1879629E259EAE7CC648E2F33CD77776,initial_extra_steps,10,,,
1879629E259EAE7CC648E2F33CD77776,plays_quickplay,true,,,
1879629E259EAE7CC648E2F33CD77776,num_levels_available,30,,,
1879629E259EAE7CC648E2F33CD77776,firebase_last_notification,4103780380169369052,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_4,0,,,
1879629E259EAE7CC648E2F33CD77776,plays_progressive,true,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_1,0,,,
1879629E259EAE7CC648E2F33CD77776,first_open_time,,1483570824513000.0,,
1879629E259EAE7CC648E2F33CD77776,ad_frequency,3,,,
1879629E259EAE7CC648E2F33CD77776,initial_extra_steps,10,,,
1879629E259EAE7CC648E2F33CD77776,plays_quickplay,true,,,
1879629E259EAE7CC648E2F33CD77776,num_levels_available,30,,,
1879629E259EAE7CC648E2F33CD77776,firebase_last_notification,4103780380169369052,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_4,0,,,
1879629E259EAE7CC648E2F33CD77776,plays_progressive,true,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_1,0,,,
1879629E259EAE7CC648E2F33CD77776,first_open_time,,1483570824513000.0,,
1879629E259EAE7CC648E2F33CD77776,ad_frequency,3,,,
1879629E259EAE7CC648E2F33CD77776,initial_extra_steps,10,,,
1879629E259EAE7CC648E2F33CD77776,plays_quickplay,true,,,
1879629E259EAE7CC648E2F33CD77776,num_levels_available,30,,,
1879629E259EAE7CC648E2F33CD77776,firebase_last_notification,4103780380169369052,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_4,0,,,
1879629E259EAE7CC648E2F33CD77776,plays_progressive,true,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_1,0,,,
1879629E259EAE7CC648E2F33CD77776,first_open_time,,1483570824513000.0,,
1879629E259EAE7CC648E2F33CD77776,ad_frequency,3,,,
1879629E259EAE7CC648E2F33CD77776,initial_extra_steps,10,,,
1879629E259EAE7CC648E2F33CD77776,plays_quickplay,true,,,
1879629E259EAE7CC648E2F33CD77776,num_levels_available,30,,,
1879629E259EAE7CC648E2F33CD77776,firebase_last_notification,4103780380169369052,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_4,0,,,
1879629E259EAE7CC648E2F33CD77776,plays_progressive,true,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_1,0,,,
1879629E259EAE7CC648E2F33CD77776,first_open_time,,1483570824513000.0,,
1879629E259EAE7CC648E2F33CD77776,ad_frequency,3,,,
1879629E259EAE7CC648E2F33CD77776,initial_extra_steps,10,,,
1879629E259EAE7CC648E2F33CD77776,plays_quickplay,true,,,
1879629E259EAE7CC648E2F33CD77776,num_levels_available,30,,,
1879629E259EAE7CC648E2F33CD77776,firebase_last_notification,4103780380169369052,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_4,0,,,
1879629E259EAE7CC648E2F33CD77776,plays_progressive,true,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_1,0,,,
1879629E259EAE7CC648E2F33CD77776,first_open_time,,1483570824513000.0,,
1879629E259EAE7CC648E2F33CD77776,ad_frequency,3,,,
1879629E259EAE7CC648E2F33CD77776,initial_extra_steps,10,,,
1879629E259EAE7CC64

2025-01-19 10:00:28 - root - INFO - SQL:
-- Simplified Query #7: Retrieve user engagement after initial engagement
WITH user_first_engagement_date AS (
  SELECT user_pseudo_id,
         MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_engagement_date
  FROM `firebase-public-project.analytics_153293282.events_*`
  GROUP BY user_pseudo_id
)
SELECT
  t.user_pseudo_id,
  t.event_date,
  t.event_name
FROM `firebase-public-project.analytics_153293282.events_*` AS t
JOIN user_first_engagement_date AS u
  ON t.user_pseudo_id = u.user_pseudo_id
WHERE PARSE_DATE('%Y%m%d', t.event_date) > u.first_engagement_date
  AND LOWER(t.event_name) LIKE '%quickplay%'
LIMIT 1000
Results:
Too long, hard cut:
user_pseudo_id,event_date,event_name
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_fail_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_fail_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_fail_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_fail_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_retry_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_fail_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_retry_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_retry_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_q

2025-01-19 10:00:36 - root - INFO - SQL:
-- Simplified Query #11: Get user retention for quickplay events by counting users who returned after initial engagement
WITH initial_users AS (
  SELECT DISTINCT user_pseudo_id,
         MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_engagement_date
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE LOWER(event_name) LIKE '%quickplay%'
  GROUP BY user_pseudo_id
),
retained_users AS (
  SELECT DISTINCT t.user_pseudo_id
  FROM `firebase-public-project.analytics_153293282.events_*` AS t
  JOIN initial_users AS u
    ON t.user_pseudo_id = u.user_pseudo_id
  WHERE PARSE_DATE('%Y%m%d', t.event_date) > u.first_engagement_date
    AND LOWER(t.event_name) LIKE '%quickplay%'
)
SELECT user_pseudo_id
FROM retained_users
LIMIT 1000
Results:
Too long, hard cut:
user_pseudo_id
654F30C1312F6C1A26DFDA9F076A62D8
3EF8FC940E379D53BBD3FEFDAF626BB2
7D613AF4DA0F508C7090E96FD73B7E6D
D7EA8E3645EFFBD6443946179ED704A6
FFA9AE78B23263835F8AAED57713EBE9
D4A11F0C6E87988E9DA1475EAF38137A
03A9D32C44665A9E15CFCCEDC9F68EDB
91D637F0D9FB259AD52773B1B20151BE
0AF862AFEB5358EBFDA7AFE3AC908844
C639CACA07D03F536F537ED779CF6599
9DE945166BCD4709696C5836317DDE47
D842320AECB686B41C2F8E8876794D34
D4F4DAEF5BE38E5C67FD72BB1F082EBF
372D9BB5088C4E9000C65B06459B403A
FEC0B30EED7870C4D46230D73032E5CA
091770A1325101155A651F90D283DA35
5E9BF00B469B284E028094EA15A9F1FE
5A7EB17BF7D867AADECA2FDAF0941E88
8EFA45B60DF34986EDC7C7CC0CD7CD69
964526CBEE730E91EB0A51E3E4B4BDB9
59F6BEF625E630452B2BA0F38D7414B2
7288C0D2279483F63ECB1B01E7FDDC4A
359A34F575B808FEFE58BC5B40816F09
14DE6B1CDA3BFD44679C7E9382644AC7
B087A865A90AD52D1864A36482983BD2
E66C3B8A38C424C7CBE0B5388EE5F77E
A0F1D068A8E7FA561AC7B4174DD5E2A5
08E6794EAC892997E8C3BB2323173641
158D85747B252579015AE58305CBC8C1
625CF86657E00A4629BCE49F5B31A144
EF0FBB41BE6F40A5CC1D68D8E1CD3591
D4C8E3E0EFC45C3D60AB3F0F305489AF
7E74A2BB6BBF4746DEE15F957B315401
11A8D6037368A4C4508B11ADB4353BC4
13AC12EF4C6A0EAF72795F720752AD98
8B404ABBCDCF859DB2E5ABE00B482621
186EF14CC97E86390BAE614FDAF4119D
C09F04828B07E4DFEF39DA5C4A976A90
CC62213661BE43BF92836F37DF9B3ADD
DAA3F353F320A717A0C418A8205292B2
A2B7DF97E146FC5AB4C8F89A94D85B4A
548C38A983EB2EB88DC1DEEA9DE6DED9
77BD91427F3805FD6A30F445FB0DC50B
90D99AC8BC1551757037513287A3B8B4
81D3DD49AA2304FD1ED8C498747B5FC6
A37AD550BCBF8C8B1D5616BB5A47770D
8ED10D7485D74E405548A3B99912C839
9EBBDF6D1D91535F99C0BAD3C0EBDC73
2E576595B5FF8D66CA224AFADAE588B4
65D1701E5BA0070CCF15F0CB0E1CF750
A8FF30877FB5CE1DDF75322B4B74EE30
AAA09F62893A41F0D9B2247AB87FA48C
57A64EB2ABD60937979A683D71025060
D961BD6AADAC53884DA8732A964CDFFD
86F19DAB73E484FB7DD2F805DDD7957D
2CD0A58C01E50CB6D66FCF06ECAA4C1B
50C60BB1599A79A9FA68C92B9E9589F2
FCC86DFF79753F8DA423B52600EE42F1
0E3E6936E3AC681876BC1DD6ABE7E937
FD7D7BEFC4F893B3066BA49035321901
1611A8EAF92912A6AE4289CE15EB7411
99F4AE4D59124072246056B3810A7324
13C303BADAA654EAF82FF64A8764C27E
06D8AAEACE405BEB27DC4AE30FAAAFF1
D4233AF1ECC193375484C63AAD97CE3E
FC031A3E74D422EBB63250A664AC6F8B
85580828B10E0DBDD5D00D394989DFC0
FE1AE0BECFED265B61163FCAF4EFF6ED
904877128B8889DDD71A38BDBCD21724
1E9F6BA9BD8C45633C26F42995A77775
5D61E6AC342F01CDCAF3A20B02426C70
31759C0600B02839C5A90DBB2CE97984
8A36D1D846123090C677E3E184B30614
D4DDA67EF184AFBC5E2D52FBDEDD7837
5C0B5019D09A484ECA0AF6E636D4205E
E7CCB643C1D0028BF305EDD85397255E
378431079481767D3F2CAD6612826DAE
3FD83714C2BC47927FA375E1FA7E2C7F
FE3331C93B8A54B8C9145532FFAD704A
F405ABC6E049921FB3587A2BE71559C9
51C511BDA46B8307F21527B455A1A59F
46758A92B62273B1A72F73D3B58945CA
83C1BFAF72CC9FF92E34D5A940101815
0373DF7959F6867CDFB1C905D39CE67C
9F3EAF490630617EF2CB47A8BD2CBBCC
7C304CB855AFB5F5C742E936F34972AB
F91F493916395FE4E16DE98B24388985
66EE0DB049AA1A3B92B41375C1263B05
B2ED849BBB2D152DF245B09A41687D4F
7E38A396789F21724DDEFB0400305685
9D956C83A0AD889DDFCA96A7589A40AD
475B281839C403CCF826D0D44890BFA5
E24714CE7A02078BBB80C632B68F88F7
76D08FC682BB0E757CB3895297B82844
885852C000C31A983D41BBFB86D71AED
7D7B319DFFF03520EF50236B2C3FB008
FD995DD8499A3D9D8102571A6C8A1C22
938611E83B897B6F877992BF30D3E1FE
295D9E24D8DE65A010313E667131EF19
9AB38AB2AE2B6B15B572DE3AEFB04363
278F45BFDAAC6EA9CED0999482E5C93E
B224957B5C7A071A449284DDAEA2B581
D1CC3A8740095F70116D613EC471A21D
0E05204A44E4CA8857B83A2FED471037
4EF964D59282E5A2C8692D30F011256B
E2C73393E938B51088B200E971667B8A
4930D1E24B57750792540C82C54D64E6
FF67B1C2BDF236F255703B1F4CD41EB4
4B3CC3382387935EC4D2AB4F6EFC56FA
0B427C5E490A982FADF586F82E797ACB
8D69D45B590556225AA4325D785CA806
0CF5644CEE7E80B439341E3C74DA73AB
3682C2527BEE6BA0255321BB25DF44BB
A09FB36DC9236D7C16606A65AB9F8799
7A1AFF03DBD16FE6E25C5CDFEDE614CF
45BDDEC4DF8773F88DC51D1AFD145521
CDC9A224610417F5F1E97C8B96168950
814700C58B117F7ABFFB1145B9C29D29
A82658237C6118780A6009C01F05DDEB
F89FB7FA61F2B6CAA3679E739CAB2477
6A24D64A89D95F922CF43FD19EB2189F
D43866E69920AFDC3D1B3E6F239E4812
ED7B241CAB6A7131CF4630C4C56BEA55
FCE87FAB4008BB95845192C9DE2B4BB6
38D65030548914B5E167CE85B035CA8F
402F30A77B5F6C1395F822860A3512FF
B76BF68579286F93FF10121993697E25
6D16DFC946ED02BDEF46FEDBB0523DA6
5BB5D536C1524FB07C79A210CAD95D01
038ECB9DA7C88F11088134C7FFB99DBD
75E2898326344BC87AE25D3C88809CEF
1A79E9DCC8204A01E73B5684FE089D40
5B8588123F79266FB7D635E31A734608
805BDC95D94B57B88F9128E6B6708692
347E136FEC789C49DA42A7F8CA5EFE51
9ADF895776EA36952298EE796C67B510
74AA252973ED84AA7C2471A3A4E5FDB6
0B32FD716C1F4BD0DA3A8DCA896F18BB
32542EF20DCB04AB03C08B87DD9B4D45
890D9DD57FD110C8E699A40B27512083
22C7EB46372F9F81C6FB9757A3875E04
75574B7DB9C97F001537DA36DDAE0C80
241293471505B5DFB907A2AFC5D26BC1
6B79073DC6A4D08D7718ABD38722ED70
1D763A3E95386CEEF80C5174E6216F8C
C302332F1B2DC5162E47913A708C479B
A68C4D0A3F32C3F7621CA7675E9F39A6
C2F9C29AE66D5B80EBB2490AB11273B8
F3779F2B0544630A7544BA7694CF3938
6C40A2B1B7C2336EDCE4B9F346682A72
B810EC88D69D961A2FA7ECC0F323D9EE
27

2025-01-19 10:00:36 - root - INFO - itercount: 0
2025-01-19 10:00:36 - root - INFO - Database Name: firebase-public-project
Schema Name: analytics_153293282
DDL describes table information.
,0
table_name,events_20180801
ddl,"CREATE TABLE `firebase-public-project.analytics_153293282.events_20180801`
(
  event_date STRING,
  event_timestamp INT64,
  event_name STRING,
  event_params ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64>>>,
  event_previous_timestamp INT64,
  event_value_in_usd FLOAT64,
  event_bundle_sequence_id INT64,
  event_server_timestamp_offset INT64,
  user_id STRING,
  user_pseudo_id STRING,
  user_properties ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64, set_timestamp_micros INT64>>>,
  user_first_touch_timestamp INT64,
  user_ltv STRUCT<revenue FLOAT64, currency STRING>,
  device STRUCT<category STRING, mobile_brand_name STRING, mobile_model_name STRING, mobile_marketing_name STRING, mobile_os_hardware_model STRING, operating_system STRING, operating_system_version STRING, vendor_id STRING, advertising_id STRING, language STRING, is_limited_ad_tracking STRING, time_zone_offset_seconds INT64>,
  geo STRUCT<continent STRING, country STRING, region STRING, city STRING>,
  app_info STRUCT<id STRING, version STRING, install_store STRING, firebase_app_id STRING, install_source STRING>,
  traffic_source STRUCT<name STRING, medium STRING, source STRING>,
  stream_id STRING,
  platform STRING
);"

Some other tables have the similar structure: ['events_20180801', 'events_20180621', 'events_20180616', 'events_20180912', 'events_20180814', 'events_20180716', 'events_20181003', 'events_20180620', 'events_20180624', 'events_20180918', 'events_20180612', 'events_20180911', 'events_20180724', 'events_20180807', 'events_20180710', 'events_20180808', 'events_20180702', 'events_20180719', 'events_20180914', 'events_20180913', 'events_20180915', 'events_20180728', 'events_20180817', 'events_20180628', 'events_20180906', 'events_20180704', 'events_20180711', 'events_20180720', 'events_20180706', 'events_20180926', 'events_20180924', 'events_20180731', 'events_20180804', 'events_20180920', 'events_20180715', 'events_20180709', 'events_20180928', 'events_20180904', 'events_20180903', 'events_20180818', 'events_20180820', 'events_20180707', 'events_20180930', 'events_20180821', 'events_20180812', 'events_20180830', 'events_20180908', 'events_20180708', 'events_20180910', 'events_20180922', 'events_20180713', 'events_20180618', 'events_20180811', 'events_20181001', 'events_20180626', 'events_20180828', 'events_20180717', 'events_20180806', 'events_20180721', 'events_20180725', 'events_20180824', 'events_20180923', 'events_20180627', 'events_20180726', 'events_20180729', 'events_20180929', 'events_20180925', 'events_20180722', 'events_20180630', 'events_20180730', 'events_20180831', 'events_20180701', 'events_20180619', 'events_20180810', 'events_20180822', 'events_20180921', 'events_20180819', 'events_20180927', 'events_20180905', 'events_20180816', 'events_20180622', 'events_20180802', 'events_20180826', 'events_20180714', 'events_20180901', 'events_20180916', 'events_20180809', 'events_20181002', 'events_20180703', 'events_20180617', 'events_20180902', 'events_20180625', 'events_20180827', 'events_20180805', 'events_20180825', 'events_20180919', 'events_20180917', 'events_20180705', 'events_20180613', 'events_20180907', 'events_20180909', 'events_20180727', 'events_20180813', 'events_20180614', 'events_20180623', 'events_20180829', 'events_20180615', 'events_20180712', 'events_20180718', 'events_20180815', 'events_20180629', 'events_20180803', 'events_20180823', 'events_20180723']
External knowledge that might be helpful: 
How to Calculate User Retention in Big Query from Google Demo Game Analytics Data

As a Product / Website Analyst, I was pretty psyched to discover Google’s public Google Analytics 4 (GA4) gaming event dataset called `firebase-public-project.analytics_153293282.events_*`. The table allows experienced developers and learners alike to experiment with raw GA4 data in Big Query for free. Event data is basically a log of user interactions with your product for analysis .For newbies interested in learning more about event data and GA4, visit my prior blog. This article provides SQL queries for a quick table overview and explains how to utilize Google Big Query to calculate user retention.


What is Retention?
User retention rates are key indicators for whether your product team meets user needs. Improving retention is often central to long term growth strategies.

**Retention measure’s how often and for how long users tend to return to your product.**

The metric can be a powerful proxy for product usefulness and user opinion. Its analysis can reveal critical information like how well your site converts new visitors to users and which items and features are associated with users coming back. If user data is available, retention can also help a business understand the profiles of its most active users (power users). Finally, retention is a great guardrail metric for A/B tests. Successful, product oriented companies prioritize a healthy user bases over short term profits.


**Common Retention Calculation Strategies**

Two common strategies to calculate retention are: 

a) N-Day retention

b) Unbounded Retention.


a) For N-Day retention, analysts calculate how many users with certain characteristics return over successive periods. It is called N days because we define the length of each period. For example, with N=7 day retention, if User A becomes part of our cohort of interest on day 0 and returns to the product day 5 and day 15, they are counted as retained for week 1 (1–7 days) and week 3 (15–21 days) but not week 2 (8–14 days).


b) For Unbounded Retention, a user is counted as retained each week so long as their most recent product contact was after the week. For example, if User A becomes part of the cohort on day 0 and last returned to the site on day 21, they will be counted as retained in week 1 (1–7 days), week 2 (8–14 days), and week 3 (15–21 days) but not week 4 (22–28 days).

By calculating these metrics, companies can evaluate how well their products hold users’ interests. It also them closer to identifying the patterns that generate return users.



The table structure information is ({database name: {schema name: {table name}}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180612', 'events_20180613', 'events_20180614', 'events_20180615', 'events_20180616', 'events_20180617', 'events_20180618', 'events_20180619', 'events_20180620', 'events_20180621', 'events_20180622', 'events_20180623', 'events_20180624', 'events_20180625', 'events_20180626', 'events_20180627', 'events_20180628', 'events_20180629', 'events_20180630', 'events_20180701', 'events_20180702', 'events_20180703', 'events_20180704', 'events_20180705', 'events_20180706', 'events_20180707', 'events_20180708', 'events_20180709', 'events_20180710', 'events_20180711', 'events_20180712', 'events_20180713', 'events_20180714', 'events_20180715', 'events_20180716', 'events_20180717', 'events_20180718', 'events_20180719', 'events_20180720', 'events_20180721', 'events_20180722', 'events_20180723', 'events_20180724', 'events_20180725', 'events_20180726', 'events_20180727', 'events_20180728', 'events_20180729', 'events_20180730', 'events_20180731', 'events_20180801', 'events_20180802', 'events_20180803', 'events_20180804', 'events_20180805', 'events_20180806', 'events_20180807', 'events_20180808', 'events_20180809', 'events_20180810', 'events_20180811', 'events_20180812', 'events_20180813', 'events_20180814', 'events_20180815', 'events_20180816', 'events_20180817', 'events_20180818', 'events_20180819', 'events_20180820', 'events_20180821', 'events_20180822', 'events_20180823', 'events_20180824', 'events_20180825', 'events_20180826', 'events_20180827', 'events_20180828', 'events_20180829', 'events_20180830', 'events_20180831', 'events_20180901', 'events_20180902', 'events_20180903', 'events_20180904', 'events_20180905', 'events_20180906', 'events_20180907', 'events_20180908', 'events_20180909', 'events_20180910', 'events_20180911', 'events_20180912', 'events_20180913', 'events_20180914', 'events_20180915', 'events_20180916', 'events_20180917', 'events_20180918', 'events_20180919', 'events_20180920', 'events_20180921', 'events_20180922', 'events_20180923', 'events_20180924', 'events_20180925', 'events_20180926', 'events_20180927', 'events_20180928', 'events_20180929', 'events_20180930', 'events_20181001', 'events_20181002', 'events_20181003']}}
Begin Exploring Related Columns
**Relevant Columns and Their Potential Usage:**

- `event_date`: Used to filter events that occurred between August 1 and August 15, 2018.
- `event_name`: To identify different event types, especially quickplay events.
- `user_pseudo_id`: Unique identifier for users, used to track user activity and retention.
- `user_first_touch_timestamp`: To determine when a user first engaged with the app.
- `event_params`: Contains additional details about events, such as event type.
- `event_timestamp`: Timestamp of the event, can be used to calculate retention periods.
- `event_value_in_usd`: May indicate the value associated with an event, possibly useful for segmentation.
- `platform`: To explore if retention varies by platform.
- `device.category`: Device type, which might affect user retention.

**Possible Conditions:**

- Filter `event_date` between '20180801' and '20180815' to select the initial engagement period.
- Use `event_name` to filter for quickplay events.
- Utilize `user_first_touch_timestamp` to verify the first engagement date.
- Extract specific keys from `event_params` to identify event subtypes.
- Use `LOWER(event_name)` with `LIKE '%quickplay%'` for case-insensitive matching of event names.

---

**Sample SQL Queries to Explore the Data:**

```sql
-- 1. List distinct event names between August 1 and August 15, 2018
SELECT DISTINCT event_name
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
LIMIT 1000;
```

```sql
-- 2. Get user IDs who first engaged between August 1 and August 15, 2018
SELECT DISTINCT user_pseudo_id
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
  AND user_first_touch_timestamp BETWEEN UNIX_MICROS(TIMESTAMP('2018-08-01'))
                                     AND UNIX_MICROS(TIMESTAMP('2018-08-15'))
LIMIT 1000;
```

```sql
-- 3. Retrieve event names related to quickplay events
SELECT DISTINCT event_name
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE LOWER(event_name) LIKE '%quickplay%'
LIMIT 1000;
```

```sql
-- 4. List event parameters for quickplay events
SELECT event_params
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE LOWER(event_name) LIKE '%quickplay%'
LIMIT 1000;
```

```sql
-- 5. Extract 'event_type' from event parameters in quickplay events
SELECT
  t.event_name,
  (SELECT value.string_value FROM UNNEST(t.event_params) WHERE key = 'event_type') AS event_type
FROM `firebase-public-project.analytics_153293282.events_*` AS t
WHERE LOWER(event_name) LIKE '%quickplay%'
LIMIT 1000;
```

```sql
-- 6. Count number of users per event_type in quickplay events
SELECT
  (SELECT value.string_value FROM UNNEST(t.event_params) WHERE key = 'event_type') AS event_type,
  COUNT(DISTINCT user_pseudo_id) AS user_count
FROM `firebase-public-project.analytics_153293282.events_*` AS t
WHERE LOWER(event_name) LIKE '%quickplay%'
  AND _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
GROUP BY event_type
LIMIT 1000;
```

```sql
-- 7. Retrieve user engagement in the second week after initial engagement
SELECT
  user_pseudo_id,
  event_date,
  event_name
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE user_pseudo_id IN (
    SELECT DISTINCT user_pseudo_id
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
      AND user_first_touch_timestamp BETWEEN UNIX_MICROS(TIMESTAMP('2018-08-01'))
                                         AND UNIX_MICROS(TIMESTAMP('2018-08-15'))
)
  AND PARSE_DATE('%Y%m%d', event_date) BETWEEN DATE_ADD(DATE(PARSE_DATE('%Y%m%d', (SELECT MIN(event_date) FROM `firebase-public-project.analytics_153293282.events_*`))), INTERVAL 7 DAY) 
    AND DATE_ADD(DATE(PARSE_DATE('%Y%m%d', (SELECT MIN(event_date) FROM `firebase-public-project.analytics_153293282.events_*`))), INTERVAL 14 DAY)
LIMIT 1000;
```

```sql
-- 8. Find the platforms used by users engaging in quickplay events
SELECT DISTINCT platform
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE LOWER(event_name) LIKE '%quickplay%'
LIMIT 1000;
```

```sql
-- 9. Count events per day for quickplay events during initial engagement period
SELECT
  event_date,
  COUNT(*) AS event_count
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE LOWER(event_name) LIKE '%quickplay%'
  AND _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
GROUP BY event_date
ORDER BY event_date
LIMIT 1000;
```

```sql
-- 10. List device categories used in quickplay events
SELECT DISTINCT device.category
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE LOWER(event_name) LIKE '%quickplay%'
LIMIT 1000;
```

```sql
-- 11. Get user retention by counting users who returned in the second week
SELECT DISTINCT user_pseudo_id
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE user_pseudo_id IN (
    SELECT DISTINCT user_pseudo_id
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
      AND user_first_touch_timestamp BETWEEN UNIX_MICROS(TIMESTAMP('2018-08-01'))
                                         AND UNIX_MICROS(TIMESTAMP('2018-08-15'))
)
  AND _TABLE_SUFFIX BETWEEN '20180808' AND '20180822'
LIMIT 1000;
```

```sql
-- 12. Extract country information of users participating in quickplay events
SELECT DISTINCT geo.country
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE LOWER(event_name) LIKE '%quickplay%'
LIMIT 1000;
```

```sql
-- 13. Count number of quickplay events per event_type
SELECT
  (SELECT value.string_value FROM UNNEST(event_params) WHERE key = 'event_type') AS event_type,
  COUNT(*) AS event_count
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE LOWER(event_name) LIKE '%quickplay%'
GROUP BY event_type
LIMIT 1000;
```

```sql
-- 14. List user properties for users engaged in quickplay events
SELECT
  user_pseudo_id,
  user_properties
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE LOWER(event_name) LIKE '%quickplay%'
LIMIT 1000;
```

```sql
-- 15. Retrieve the event_value_in_usd for quickplay events
SELECT event_value_in_usd
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE LOWER(event_name) LIKE '%quickplay%'
LIMIT 1000;
```

These queries provide insights into the data related to the task. They explore event names, event types, user engagement periods, platforms, devices, and geographical information, which are all relevant for calculating user retention rates for different quickplay event types.Query:
-- 1. List distinct event names between August 1 and August 15, 2018
SELECT DISTINCT event_name
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
LIMIT 1000;
Answer:
event_name
level_fail
level_end
level_start_quickplay
post_score
level_up
level_complete
completed_5_levels
level_start
level_retry
session_start
screen_view
select_content
user_engagement
level_complete_quickplay
level_end_quickplay
level_reset_quickplay
level_fail_quickplay
level_retry_quickplay
challenge_a_friend
use_extra_steps
spend_virtual_currency
app_exception
level_reset
app_remove
os_update
ad_reward
no_more_extra_steps
firebase_campaign
app_update
error
first_open
in_app_purchase
app_clear_data
dynamic_link_app_open
Query:
-- 2. Get user IDs who first engaged between August 1 and August 15, 2018
SELECT DISTINCT user_pseudo_id
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
  AND user_first_touch_timestamp BETWEEN UNIX_MICROS(TIMESTAMP('2018-08-01'))
                                     AND UNIX_MICROS(TIMESTAMP('2018-08-15'))
LIMIT 1000;
Answer:
Too long, hard cut:
user_pseudo_id
4EBC9E555CE3316055264858BF18DB51
8EC25BFD4E8CB157030F3692FCAFA8FB
B05B44F98AC43EA887A1B78C3552A927
383F4B98EC31DD2A915427D36A30354E
E1A3C786B2E4D56629EE808A3A174995
52B07E869C01CE684AD503F8F9445125
0CFD16A46A05B5BD29D3A37284B94CBB
C5DE6E85159CC31B2CE9213117956343
08FD622562B214D7B7AC45DC707106ED
8680E9C6F3ABE3B95FCF44EA5D7DB200
B2912116E7B957900D6B69D4E50F0F9A
4542CFA974FAA3C923527BDDA50397B0
89C1D9AF4193728E41F48DC623DEE51F
1B959D672ABAE4A3BFB9D720D415E064
FA596A777C81AFE81313CACC0AC7D6C7
DD17202A1AA5C3250E15ECF69A6FC073
AB48D576008899542044F575FF8DF525
EC51C9E063BA20CC1A6F954E9C963EAE
6D717745A9FF51CA21D39208C1668378
C5D3E8CBDDB09A397F8E6A626106FBC5
42421044D6B3F0190A37145A20403036
0280C8F16D33C9D040B9BDA8B74CAD3A
B22F17D065D62FA2F622CF1B196F92E0
DF2FC56E807EAF16E852AEAB67E0127A
90315F3CE85BB427F960EF2F78972EA6
F916D30FAD36F1282F98AEA3D580BEBE
5B9149282B2EB48FE5AFE1240FC0440E
43D27F6D77E6A3B68872B6786AD0DAB4
DA814428F7E26F091284C8793DE748BD
9AB15754D4B3B28488B088CAFD9DD5DF
154287464C4F84AF86699BC92AA1DAB5
497308A94C26945E008226F51C49C706
8F69F63C94FC7045651B1B164AE7B379
3B1EC879875F9C6B1AAE0A09BE08FA7F
093E3E8BB59252BCD92BA5B7EAE55BBD
E0F1DC58BE9661A3DFD9C3228B179C29
EC895C732092BA9A3CE9F507ED888726
1BA8A3FE9D6AD54C6C77BC8A350BF2DA
2CFE23AC4E3C6529D39BDADA1EF99C52
FC0E10ED9037CA6C75458E20AB85F350
13524092E785CA3DBE2A03A2B5B2EFA5
AB714CB216CB456740B54DD82E11FDB9
7393E3E8A1D61F2A850CD562E6438814
FF5829CCC9DCE80240E620D7D66C709B
2FDD16446C63750D95AAAC6F6B41CB37
B72C3DD50B9F81DBCED2EE06E08796CE
786AAA96746C4084190340D4B8C4710E
7117AD079649D3A342A663E89F3C0355
F454E0D882BF2C7E1E0DF7F96DF78F3B
3CD1DEB660E64A41BA76E124B1C0103F
CD92711913D195448B5032F52C3318D2
C373A2EBDDEB4C3CC895F917254032D4
2C6B6390B8227E00E7CEA32D8E108025
EC7F54960F789EB130267F9A3F247BB1
D2BA6FF865D64BDC12D28BEB9F778997
34587F7996F20BE4CC7DDEB96753D110
55572693175EAD05BD53E8AD7513F379
53C62BFF7D715334B8C3C4904EC34880
3CCC49DD05DF89B1B103E2C22366AA0C
F0AC8F43620EAD7BD3EA00493675AA87
81E2E892D1C23CE76B072FA71310829F
88E99CE30B65345ED0B118869B6AD035
9225A1F12C539431CD0217908688C4E2
C80D68A48ECFFAD588A6784F36BA41F5
AB31249C4D16F5D39299BC1A9D423EE5
F4EA0F2888792BD62555AD46ED534839
8E85F9B503273C041EE56963F6F68C78
5D3AC32A3431337AB937BDAF886D1782
09FF3AA4F3FE00E7FC084395C4615EA6
27D0B01EBF8B78EA0B61171428EFD542
2C7A0851C697F03694BF4364695CA6C0
EA60D1DFDD9E06777E874E280C6417CC
E11BE37FB066E143A0B4C29D2842223A
2357128F5A877DECB2C8FCFA8101884B
28778DE05FE8E9B32044B749FCDDB70D
1D8F8EBFE5F3C95F99A36F627715DF8A
86B2C983E54A5676FAB52B0DCE44A33D
17636078D57884AD7EA5406C60E2BD10
C9A22B291E9B2D3D98262C8D41D703A2
BA68AFBA94C53DA2DE67AA683078AD2A
7FBA8F50097D2948AEA898B7AFA3B72A
D5F162E063EF1129BFE585FD4C4DCB17
DC8912881CD30A0D8D5E2EB666D22901
DA4BCFC16C1735AFFAD960E8B9064525
DDBA0BF4F81311FF87A30D2DDE2171E6
362C4170BE71B71630D1C7790927BD4C
162DCBBB07A1E42728E66853A66556B5
EE3A7EF48E6CA9311D17208B94AFE6D0
B6583219D50D4B342A797369873FE31C
346CD6014841FFAB8A094411970DDD9E
E0189D91AD0A138AA65CB66338B82161
942E123C7E8C0B62935889D03D77BE8E
2183FBF69049963AF568954027E6520D
51C46BC53A765564EDFC48E1EDA7EAED
09352F4FD57960A1DDA0E0619A60D7EE
F811FA3ECC2BA9F049E5A216FAFA301B
EC36E6167D2E25E6E4661EAEB5E5EEAB
1398FAD131CAB04B4B52169E68620CD2
C647FB7C5C6F9EA2F18A78E1AB30B272
222DA52480ED3CD33C632A351A40E8AD
00802DA458DB2440535C1C3796892482
15CD7FD75B0E6F422912F0CBC8123AD1
CCADFC0ECC097AA5DA4FD3917D517022
3C8C2110DC4556D3E28568CA68172047
D5E0BD50D8A6244443E08E2E71B3739D
EE2010FFDAF663BCC722160AB9954A1E
61F5B317AB1EF10E3C7E68C930A1018C
43B9E5915CF39E53BAF74E0B6C201BE1
BB322D2CA948F548EA3A05A2BD93B1A3
ACC9710DAD24A644E2F9360C67EB9110
57EC50FBC6C7277B8EDCCE44C1352BD4
5D53102B0F6AAA96D3FC1C0633890970
A976A39B8E08829A5BC5CD3827C942A2
E920D72AFB16365797955E46913E2599
FFDDF354D9B9E851D2A62ABAEA17DA3E
4E6F4A73B5D05B33DC73B11547E39004
6EE3CB7D6C073894B49F1AF081758A2E
1CE19ED5366D09B6A3E9CCD4AA475B85
469473B2E1C330A74286BA52BA3CACF5
7CBF44EFDDB9E6401F31786BEE071196
B96742012753A7FC58537387657DED5A
3A1B5A55C33A7EF1A37C909A753606B8
38D65030548914B5E167CE85B035CA8F
1AE6C4E5DFF6715503FC7C79A7C0C363
0DF6A14F536F6514A6F18BC12A532A82
F27F046DF960AB50CE65B9F4364C981E
2B6D0DB9D76C581ACB986BBE2408220C
60406ADD3EE12783E9DF7A35EE8570BE
D0D476CA1660A598CBF9E0B6946E031D
567422321BBB432EC2CC014A510E61BD
708EC500ED27377CB738C8005AE4E34E
3C24334270603160F1C27BAAC3B9B714
4479F0349D25059D2499C147B5100D12
257774E79E4827F63414C62DD5C64DE9
4A8D4276A1EBBD17E6CB7EE30FE71CC2
1433C10AF6B6779D48481D84BC8222A4
30C9F1FCEBB2E40593350BBB662344E7
811898C76CEDFA57991289FAC0C1A004
4444B14309355CB56DC2D6AE75FCCA31
84F55D39B331B4D51467A32FECD5F0A5
8F09C3B476E71697EAE0CE7B4EA61606
CE24B98FDB40DFD8FA769844135C2852
39C210B833FE2D53C723E354AB1FAC4D
E973B7846D23B8B642E90184729BE686
B7D2B63ABE215157570ABD2E2E6EC9BE
C13B525407D557296763616356BBCAB5
0061B4B16D4EABF6E23141FBAEEFE7B2
8BC72D1925A8866050D5A6FB01148518
E806F12D29E9F873BE6EAA01CD1E1B4F
93CE02A528E41C078FDB04857CCDA48C
A4A0A491EB22A58225818379E768BE3B
D2
Query:
-- 3. Retrieve event names related to quickplay events
SELECT DISTINCT event_name
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE LOWER(event_name) LIKE '%quickplay%'
LIMIT 1000;
Answer:
event_name
level_retry_quickplay
level_fail_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_reset_quickplay
Query:
-- 4. List event parameters for quickplay events
SELECT event_params
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE LOWER(event_name) LIKE '%quickplay%'
LIMIT 1000;
Answer:
Too long, hard cut:
event_params
"[{'key': 'value', 'value': {'string_value': None, 'int_value': 22, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_class', 'value': {'string_value': 'game_board', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'app+gtm', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': -8429148202203700265, 'float_value': None, 'double_value': None}}, {'key': 'board', 'value': {'string_value': 'S', 'int_value': None, 'float_value': None, 'double_value': None}}]"
"[{'key': 'firebase_screen_class', 'value': {'string_value': 'game_board', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'app+gtm', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': -8429148202203700265, 'float_value': None, 'double_value': None}}, {'key': 'board', 'value': {'string_value': 'S', 'int_value': None, 'float_value': None, 'double_value': None}}]"
"[{'key': 'firebase_screen_class', 'value': {'string_value': 'game_board', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'app+gtm', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': -8429148202203700265, 'float_value': None, 'double_value': None}}, {'key': 'board', 'value': {'string_value': 'S', 'int_value': None, 'float_value': None, 'double_value': None}}]"
"[{'key': 'firebase_screen_class', 'value': {'string_value': 'game_board', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'app+gtm', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': -8429148202203700265, 'float_value': None, 'double_value': None}}, {'key': 'board', 'value': {'string_value': 'S', 'int_value': None, 'float_value': None, 'double_value': None}}]"
"[{'key': 'firebase_screen_class', 'value': {'string_value': 'game_board', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'app+gtm', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': -8429148202203700265, 'float_value': None, 'double_value': None}}, {'key': 'board', 'value': {'string_value': 'S', 'int_value': None, 'float_value': None, 'double_value': None}}]"
"[{'key': 'firebase_screen_class', 'value': {'string_value': 'game_board', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'app+gtm', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': -8429148202203700265, 'float_value': None, 'double_value': None}}, {'key': 'board', 'value': {'string_value': 'S', 'int_value': None, 'float_value': None, 'double_value': None}}]"
"[{'key': 'firebase_screen_class', 'value': {'string_value': 'game_over', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'app+gtm', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': -8429148202203700217, 'float_value': None, 'double_value': None}}, {'key': 'board', 'value': {'string_value': 'S', 'int_value': None, 'float_value': None, 'double_value': None}}]"
"[{'key': 'firebase_screen_class', 'value': {'string_value': 'game_board', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'app+gtm', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': -8429148202203700265, 'float_value': None, 'double_value': None}}, {'key': 'board', 'value': {'string_value': 'S', 'int_value': None, 'float_value': None, 'double_value': None}}]"
"[{'key': 'firebase_screen_class', 'value': {'string_value': 'game_board', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'app+gtm', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': -8429148202203700265, 'float_value': None, 'double_value': None}}, {'key': 'board', 'value': {'string_value': 'S', 'int_value': None, 'float_value': None, 'double_value': None}}]"
"[{'key': 'firebase_screen_class', 'value': {'string_value': 'game_board', 'int_value': None, 'float_value': None, 'double_va
Query:
-- 5. Extract 'event_type' from event parameters in quickplay events
SELECT
  t.event_name,
  (SELECT value.string_value FROM UNNEST(t.event_params) WHERE key = 'event_type') AS event_type
FROM `firebase-public-project.analytics_153293282.events_*` AS t
WHERE LOWER(event_name) LIKE '%quickplay%'
LIMIT 1000;
Answer:
Too long, hard cut:
event_name,event_type
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_start_quickplay,
level_end_quickplay,
level_retry_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_end_quickplay,
level_start_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_start_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_start_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_fail_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_fail_quickplay,
level_fail_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_complete_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_retry_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_retry_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_retry_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_start_quickplay,
level_end_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_quickplay,
level_start_quickplay,
level_fail_quickplay,
level_end_qu
Query:
WITH initial_engagement AS (
  SELECT DISTINCT user_pseudo_id, event_name
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
    AND LOWER(event_name) LIKE '%quickplay%'
),

user_first_engagement_date AS (
  SELECT user_pseudo_id,
         MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_engagement_date
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
    AND LOWER(event_name) LIKE '%quickplay%'
  GROUP BY user_pseudo_id
),

second_week_engagement AS (
  SELECT DISTINCT t.user_pseudo_id, t.event_name
  FROM `firebase-public-project.analytics_153293282.events_*` AS t
  JOIN user_first_engagement_date AS u
    ON t.user_pseudo_id = u.user_pseudo_id
  WHERE PARSE_DATE('%Y%m%d', t.event_date) BETWEEN DATE_ADD(u.first_engagement_date, INTERVAL 7 DAY) AND DATE_ADD(u.first_engagement_date, INTERVAL 14 DAY)
    AND LOWER(t.event_name) LIKE '%quickplay%'
),

retention AS (
  SELECT
    initial.event_name AS event_type,
    COUNT(DISTINCT initial.user_pseudo_id) AS initial_users,
    COUNT(DISTINCT second.user_pseudo_id) AS retained_users
  FROM initial_engagement AS initial
  LEFT JOIN second_week_engagement AS second
    ON initial.user_pseudo_id = second.user_pseudo_id
    AND initial.event_name = second.event_name
  GROUP BY initial.event_name
)

SELECT event_type,
       (CAST(retained_users AS FLOAT64) / initial_users) * 100 AS second_week_retention_rate
FROM retention
ORDER BY second_week_retention_rate ASC
LIMIT 1;
Answer:
event_type,second_week_retention_rate
level_reset_quickplay,24.02135231316726
Query:
-- 7. Retrieve user engagement in the second week after initial engagement
WITH user_first_engagement_date AS (
  SELECT user_pseudo_id,
         MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_engagement_date
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
  GROUP BY user_pseudo_id
)
SELECT
  t.user_pseudo_id,
  t.event_date,
  t.event_name
FROM `firebase-public-project.analytics_153293282.events_*` AS t
JOIN user_first_engagement_date AS u
  ON t.user_pseudo_id = u.user_pseudo_id
WHERE PARSE_DATE('%Y%m%d', t.event_date) BETWEEN DATE_ADD(u.first_engagement_date, INTERVAL 7 DAY)
                                            AND DATE_ADD(u.first_engagement_date, INTERVAL 14 DAY)
LIMIT 1000
Answer:
Too long, hard cut:
user_pseudo_id,event_date,event_name
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,level_start
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,session_start
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,screen_view
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,screen_view
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,screen_view
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,screen_view
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,screen_view
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,screen_view
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,screen_view
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,screen_view
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,select_content
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,select_content
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,user_engagement
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,user_engagement
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,user_engagement
DA426D16B0EAB27DE1AC9D6E3418F400,20180813,user_engagement
BB322D2CA948F548EA3A05A2BD93B1A3,20180813,level_start_quickplay
BB322D2CA948F548EA3A05A2BD93B1A3,20180813,session_start
BB322D2CA948F548EA3A05A2BD93B1A3,20180813,screen_view
BB322D2CA948F548EA3A05A2BD93B1A3,20180813,screen_view
BB322D2CA948F548EA3A05A2BD93B1A3,20180813,screen_view
BB322D2CA948F548EA3A05A2BD93B1A3,20180813,screen_view
BB322D2CA948F548EA3A05A2BD93B1A3,20180813,select_content
BB322D2CA948F548EA3A05A2BD93B1A3,20180813,user_engagement
D5544C064404DC6067412B1272F848D6,20180813,level_fail
D5544C064404DC6067412B1272F848D6,20180813,level_end
D5544C064404DC6067412B1272F848D6,20180813,post_score
D5544C064404DC6067412B1272F848D6,20180813,level_up
D5544C064404DC6067412B1272F848D6,20180813,completed_5_levels
D5544C064404DC6067412B1272F848D6,20180813,level_complete
D5544C064404DC6067412B1272F848D6,20180813,level_start
D5544C064404DC6067412B1272F848D6,20180813,level_end
D5544C064404DC6067412B1272F848D6,20180813,level_retry
D5544C064404DC6067412B1272F848D6,20180813,level_start
D5544C064404DC6067412B1272F848D6,20180813,level_retry
D5544C064404DC6067412B1272F848D6,20180813,level_start
D5544C064404DC6067412B1272F848D6,20180813,level_reset
D5544C064404DC6067412B1272F848D6,20180813,level_start
D5544C064404DC6067412B1272F848D6,20180813,session_start
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,screen_view
D5544C064404DC6067412B1272F848D6,20180813,select_content
D5544C064404DC6067412B1272F848D6,20180813,select_content
D5544C064404DC6067412B1272F848D6,20180813,user_engagement
D5544C064404DC6067412B1272F848D6,20180813,user_engagement
D5544C064404DC6067412B1272F848D6,20180813,user_engagement
D5544C064404DC6067412B1272F848D6,20180813,user_engagement
D5544C064404DC6067412B1272F848D6,20180813,user_engagement
D5544C064404DC6067412B1272F848D6,20180813,user_engagement
D5544C064404DC6067412B1272F848D6,20180813,user_engagement
D5544C064404DC6067412B1272F848D6,20180813,user_engagement
D5544C064404DC6067412B1272F848D6,20180813,user_engagement
D5544C064404DC6067412B1272F848D6,20180813,user_engagement
023A2DB99CC3F70A4B71869C36952D74,20180813,screen_view
023A2DB99CC3F70A4B71869C36952D74,20180813,screen_view
023A2DB99CC3F70A4B71869C36952D74,20180813,user_engagement
023A2DB99CC3F70A4B71869C36952D74,20180813,user_engagement
023A2DB99CC3F70A4B71869C36952D74,20180813,user_engagement
023A2DB99CC3F70A4B71869C36952D74,20180813,user_engagement
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_fail
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_fail
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_end
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_fail
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_fail
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_end
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_fail
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_end
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_complete_quickplay
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_complete_quickplay
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_complete_quickplay
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_complete_quickplay
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_complete_quickplay
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_complete_quickplay
57EC50FBC6C7277B8EDCCE44C1352BD4,20180813,level_complete_quickplay
57EC50FBC6C7277B8EDCCE4
Query:
-- 8. Find the platforms used by users engaging in quickplay events
SELECT DISTINCT platform
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE LOWER(event_name) LIKE '%quickplay%'
  AND platform IS NOT NULL
LIMIT 1000
Answer:
platform
ANDROID
IOS
Query:
-- 9. Count events per day for quickplay events during initial engagement period
SELECT
  event_date,
  COUNT(*) AS event_count
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE LOWER(event_name) LIKE '%quickplay%'
  AND _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
  AND event_date IS NOT NULL
GROUP BY event_date
ORDER BY event_date
LIMIT 1000
Answer:
event_date,event_count
20180801,11985
20180802,13117
20180803,11013
20180804,11271
20180805,11764
20180806,11234
20180807,11121
20180808,11045
20180809,10574
20180810,11234
20180811,11376
20180812,10796
20180813,10949
20180814,12652
20180815,13366
Query:
-- 10. List device categories used in quickplay events
SELECT DISTINCT device.category
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE LOWER(event_name) LIKE '%quickplay%'
  AND device.category IS NOT NULL
LIMIT 1000
Answer:
category
mobile
tablet
Query:
-- 11. Get user retention by counting users who returned in the second week
WITH user_first_engagement_date AS (
  SELECT user_pseudo_id,
         MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_engagement_date
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
  GROUP BY user_pseudo_id
),
second_week_returning_users AS (
  SELECT DISTINCT t.user_pseudo_id
  FROM `firebase-public-project.analytics_153293282.events_*` AS t
  JOIN user_first_engagement_date AS u
    ON t.user_pseudo_id = u.user_pseudo_id
  WHERE PARSE_DATE('%Y%m%d', t.event_date) BETWEEN DATE_ADD(u.first_engagement_date, INTERVAL 7 DAY)
                                              AND DATE_ADD(u.first_engagement_date, INTERVAL 14 DAY)
)
SELECT user_pseudo_id
FROM second_week_returning_users
LIMIT 1000
Answer:
Too long, hard cut:
user_pseudo_id
17636078D57884AD7EA5406C60E2BD10
E080406D26F71C9B8F331779CE8B82BA
95999C77751600817821BD41542C91D9
9DE945166BCD4709696C5836317DDE47
D7EA8E3645EFFBD6443946179ED704A6
8F69F63C94FC7045651B1B164AE7B379
229254D7C810F98F72C89A8060E194D4
29D576429D004584017D0A0FE1601455
66EE0DB049AA1A3B92B41375C1263B05
C80CEE0983AB5B21D3F4B46089FDD9EB
A74C05E503F6274BAA9457B2265471F5
372D9BB5088C4E9000C65B06459B403A
D7CF81985E633F6AFA5FDA55D9EF68C2
5E8B4AEF7E3373AA78408DB08E72E3B8
21A83962241B826AB42841AF81329007
12E5626928FE0885DEEF068683E8BD63
7010E53372648835E07BC5A1B8D4D753
82B5DB000108639FF0D38F39D7AC46FD
56B9CBB6CB58106DCCF3CAD660232CB2
A421EBCE8AA69A980AAFC4F141BDEFFB
2F48607C41ECC4015FA296500F0A2C4B
9A12E7E2B3CF644B8304DF8E1A9CE2D8
7EE035CA8E6132A8877C39656896BA41
E6B6CAE2D200FC3EACF21DDE75402DCD
77F125B832C748232EDA6AF8C7D08ED1
74456352647C13028F89D1EEFFB905F4
01C784BDB7AF4DC8DAD6DCD21AF56E25
7F0AB922E141FE5ABB0D03537DFEC330
8B404ABBCDCF859DB2E5ABE00B482621
A976A39B8E08829A5BC5CD3827C942A2
86C0A7CE29E087F5ED9538D2C2B77EBD
79C6CEA7189615EF5319ED1BA55DDE9D
43A68D45096E21AB07F2C15CE21CD5A7
F5CA9C70FB5ACA0C36279A6FB407A7B7
75C00378B3BA26B12559020A83A74355
22DF34962481295121082D8C105EB436
2684EA4DDB1F988E3C979AB15CFF601F
150372F747C719DC8DCC28EC8CBCD93E
334FF61953047FD7AA1D5A661C7E6B81
47F7713B7F3C4F3149A9200360757C6B
CD5A6BBEC21D4DDC4C51AE7922115498
84D4A14B2F6F8A8AF3DF58E6C67A79D5
46BE6557334E701C5036F6762A32E18E
D64DDC2439F7219840E0EEA2AC42CAB4
40E86F2B5D4C7837A3D2BBC1AF18461F
B7D2B63ABE215157570ABD2E2E6EC9BE
00D49153E0790E34D76523EEBEF459B2
241293471505B5DFB907A2AFC5D26BC1
6E03EB3DFD35C31E04ECA7158A756664
E989ADC3B80B10A564559A60763BA8D1
35DDC37EB72373793E703516725BB2FE
CE3148CA8DACC6B0D0C5D234186008BE
ED2314D19E295AB82F96282D3CE4410F
A140217526C281E3031EDD046A1443EE
018CAABB1F4DBDD23D432D211F095B5E
ADDE80C89BB3F6190538E50E541BACD5
D4D701A6BBC568043784A581AD7B936A
C72575F22BA940EDEFBB26EC6A2C3FDE
D8A6BDFA89F65FC9B5159A3031C33004
44386D9242DC9705DAFE219EC2C114F5
1C4A33BABEC27149E2A91113AA79C4D0
648F91A3D0D868FC410FC4614FF11811
9373B5D36107012F6F9137090C523FA1
AD8EC45CB90A8CEFC376341115A6E1E7
D5544C064404DC6067412B1272F848D6
C66BF8A9ACA5CD56597E18B0729181C4
511CBE83E5EE7FDCB123C78CCFAF9EA7
B56E67847E1AE8D6411A5ECCA26585CA
D1CC3A8740095F70116D613EC471A21D
825B7D7600CF41F2EE31628EB361639D
B7B44C7C4701B0E0527E88F3A2529C33
55BFF903A55C62757C592CB25D7F1056
40BA3CE848E99626DACC46BCCEE3E568
A14C5D644176F881FE4BC72B7AF0B988
3D20DEB25C111328B0DEF485060236E6
74253012A39B1F4DE53D4BFF1AB2B5DD
3EF8FC940E379D53BBD3FEFDAF626BB2
CE264AB9D445FF50DA23D24496D50865
2F5BBABE9DD0271DCD62E501F76DA736
E707EF96D408A4FEED0DD25AD19CD9EF
0E05F56141200FF41FCC0C7FA297FF08
2741C47CC50AE98B39CC5B561BFEA504
7D05DF6F0141D016FD20F7B8E71FAB0A
5B888A06EFF60B86B10367EEC3B44E85
F59BEAB1339F76DE62083BE31C73AF1B
47216088A078D06F9220263FAF964F10
EB1A430BACB37E6EA72592BF838E64A6
7AA6572327B5C45D273CCD8868760033
0D17D0247F158FA3E40D21EFF46D1651
FC48EDE912EDD9F8D7ED45F697EE7193
058520E12010190322386C3E356AEE8F
FEC0B30EED7870C4D46230D73032E5CA
EF500E0CF578004836D1D38C8901862B
90D99AC8BC1551757037513287A3B8B4
D47DCBB00B2B462C916A5A07DCFAB039
95BC3B2233ECAE0717CC70A45315365B
B3A9A38A561B3648D280614B8E2D8E07
44A600997B9B6499325D518A19B51FEC
1AE6C4E5DFF6715503FC7C79A7C0C363
343B740C7B3BD9C2CFA46BF097A8856E
EBC3581ADA874D494FBE2C7CCF53BF99
71D9049FE1BB6FB30F0111D464315A10
41A07F6F6C3756427B09AEF18204CA37
C5B527B0AA7603C4EF8C0ECBBCB5372E
F187F3F6C0DFB1FA23483A67AA31A16D
91D637F0D9FB259AD52773B1B20151BE
B10AE521352392E4981BA07E0D86081C
2F72E1976C24D8DFEA138BBCFD304BAC
67D3D76504CC5C4CBFC78EE4FC397C8B
1F54AC7A413B33C6023DA0AF8F489684
938611E83B897B6F877992BF30D3E1FE
5EFCFE3BCD1E9274A83E516E9CDEF2AE
E325B175B66E106477EB7E729C99F8E1
DD2269BCB7F8532CD51CB6854667AF51
359A34F575B808FEFE58BC5B40816F09
8E2CA56C1FD81A095DECAEDE6F2ED626
C0AA6F95B35D0D803F47B299269E716D
019FCC6C080A33E9B697CAA476C4156E
C0ACF48C8E0C4C71C16AB8C3F7D21A2E
1C65943AF5217570A2E4D9B58B6E6FC4
0B9739BFB4122E1863C894E34F812D56
0B08423CCD5F1503B5A8B306FFED999C
1931CC11834A8EC4E576DCA0DE5DFD13
7CA838857E3B7B8C9FC6A34E975FBF22
5888DE5128724573A7E79802BA2D4BC1
F7164A70962E5AED09AD0CEB0A3C7C82
C4E724D4880087C4E1D33F1BCD64A60A
39C210B833FE2D53C723E354AB1FAC4D
1851B906579B2899837742EA924C7280
BB322D2CA948F548EA3A05A2BD93B1A3
1B2FC37816CC4DDAACA97A75E685756F
F720D2FE0350DA0E19A729BE9A4B73FB
2345BDA28F644B3B18B6AE10FBDA000C
D4C8E3E0EFC45C3D60AB3F0F305489AF
6478069CD8A395DE1A022DD9BFD58752
4411385D52B71A3242BDEFDF60609E55
5B4FD8662DAD71406319200659FDF420
693EB525C74694F2E6990CA738F5E5D5
82D556A8003F97B39A2D2E8E5520F9B6
68C5F7CFAEAB93924B7B55D7129C0286
EEA00C45CDC47167CBA1E443296B5B64
4A8D4276A1EBBD17E6CB7EE30FE71CC2
00B6295EC351DBFE0E31015296871E35
C1648883A80997B611743D528CBFF926
91381A6BC5F5E06D1B8DEFD96761751C
1FEB41A72F244D352EA79982CC259EA0
7C632AB83C2A58075244891518D3D415
E063775534D380684BCA33B63B11B213
934A101CA7B97944D05E0FC2ED3E203D
C4411A9EA6C9822AD521C60A4ED25F25
AB32482D193E2CE166B59F82EF78D8BB
83
Query:
-- 12. Extract country information of users participating in quickplay events
SELECT DISTINCT geo.country
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE LOWER(event_name) LIKE '%quickplay%'
  AND geo.country IS NOT NULL
LIMIT 1000
Answer:
country
Japan
Pakistan
Belgium
Mauritius
France
China
Zimbabwe
Bangladesh
Dominican Republic
Portugal
St. Lucia
Bahamas
Iran
Uganda
Namibia
Guernsey
Vietnam
Denmark
Costa Rica
Hungary
Honduras
""
Bolivia
Armenia
Bosnia & Herzegovina
Taiwan
Algeria
United Arab Emirates
Switzerland
Martinique
Finland
Tanzania
Luxembourg
Bermuda
El Salvador
Cape Verde
South Africa
Ukraine
Argentina
Israel
Chile
Jordan
Iceland
Italy
Peru
Guadeloupe
Nigeria
Tunisia
Northern Mariana Islands
Venezuela
Latvia
Kuwait
Serbia
Cayman Islands
Afghanistan
Germany
Malaysia
Netherlands
South Korea
Philippines
Lithuania
Turkey
Cyprus
Sri Lanka
Ireland
Puerto Rico
Jamaica
Uzbekistan
Lebanon
United Kingdom
Hong Kong
Indonesia
Poland
Bulgaria
Côte d’Ivoire
Faroe Islands
Ghana
Cameroon
Turkmenistan
Estonia
Montenegro
India
Brazil
Belarus
Panama
Greece
Kenya
Gibraltar
Botswana
Ethiopia
Guatemala
Syria
Sudan
Ecuador
Bahrain
Egypt
Morocco
Russia
Guam
Norway
Trinidad & Tobago
Belize
United States
Canada
Mexico
Mongolia
Caribbean Netherlands
Oman
Chad
Zambia
Australia
Spain
Slovenia
New Zealand
Romania
Slovakia
Aruba
Colombia
Cambodia
Macau
Papua New Guinea
Laos
Brunei
Czechia
Nepal
Austria
Saudi Arabia
Thailand
Sweden
Singapore
Kazakhstan
U.S. Virgin Islands
Iraq
Macedonia (FYROM)
Myanmar (Burma)
Qatar
Croatia
French Polynesia
Uruguay
French Guiana
Malta
Query:
-- 13. Count number of quickplay events per board type
SELECT
  (SELECT value.string_value FROM UNNEST(event_params) WHERE key = 'board') AS board_type,
  COUNT(*) AS event_count
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE LOWER(event_name) LIKE '%quickplay%'
GROUP BY board_type
LIMIT 1000
Answer:
board_type,event_count
S,1131752
L,121215
M,100532
Query:
-- 14. List user properties for users engaged in quickplay events
SELECT
  user_pseudo_id,
  prop.key,
  prop.value.string_value AS string_value,
  prop.value.int_value AS int_value,
  prop.value.float_value AS float_value,
  prop.value.double_value AS double_value
FROM `firebase-public-project.analytics_153293282.events_*`,
UNNEST(user_properties) AS prop
WHERE LOWER(event_name) LIKE '%quickplay%'
LIMIT 1000
Answer:
Too long, hard cut:
user_pseudo_id,key,string_value,int_value,float_value,double_value
630BD3C34C2E3BE5504A3B06CAE40320,ad_frequency,4,,,
630BD3C34C2E3BE5504A3B06CAE40320,initial_extra_steps,10,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_quickplay,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,num_levels_available,30,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_4,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_progressive,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_1,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,first_open_time,,1517883202364000.0,,
630BD3C34C2E3BE5504A3B06CAE40320,ad_frequency,4,,,
630BD3C34C2E3BE5504A3B06CAE40320,initial_extra_steps,10,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_quickplay,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,num_levels_available,30,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_4,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_progressive,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_1,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,first_open_time,,1517883202364000.0,,
630BD3C34C2E3BE5504A3B06CAE40320,ad_frequency,4,,,
630BD3C34C2E3BE5504A3B06CAE40320,initial_extra_steps,10,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_quickplay,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,num_levels_available,30,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_4,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_progressive,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_1,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,first_open_time,,1517883202364000.0,,
630BD3C34C2E3BE5504A3B06CAE40320,ad_frequency,4,,,
630BD3C34C2E3BE5504A3B06CAE40320,initial_extra_steps,10,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_quickplay,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,num_levels_available,30,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_4,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_progressive,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_1,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,first_open_time,,1517883202364000.0,,
630BD3C34C2E3BE5504A3B06CAE40320,ad_frequency,4,,,
630BD3C34C2E3BE5504A3B06CAE40320,initial_extra_steps,10,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_quickplay,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,num_levels_available,30,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_4,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_progressive,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_1,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,first_open_time,,1517883202364000.0,,
630BD3C34C2E3BE5504A3B06CAE40320,ad_frequency,4,,,
630BD3C34C2E3BE5504A3B06CAE40320,initial_extra_steps,10,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_quickplay,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,num_levels_available,30,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_4,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_progressive,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_1,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,first_open_time,,1517883202364000.0,,
630BD3C34C2E3BE5504A3B06CAE40320,ad_frequency,4,,,
630BD3C34C2E3BE5504A3B06CAE40320,initial_extra_steps,10,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_quickplay,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,num_levels_available,30,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_4,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_progressive,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_1,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,first_open_time,,1517883202364000.0,,
630BD3C34C2E3BE5504A3B06CAE40320,ad_frequency,4,,,
630BD3C34C2E3BE5504A3B06CAE40320,initial_extra_steps,10,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_quickplay,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,num_levels_available,30,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_4,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_progressive,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_1,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,first_open_time,,1517883202364000.0,,
630BD3C34C2E3BE5504A3B06CAE40320,ad_frequency,4,,,
630BD3C34C2E3BE5504A3B06CAE40320,initial_extra_steps,10,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_quickplay,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,num_levels_available,30,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_4,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_progressive,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_1,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,first_open_time,,1517883202364000.0,,
630BD3C34C2E3BE5504A3B06CAE40320,ad_frequency,4,,,
630BD3C34C2E3BE5504A3B06CAE40320,initial_extra_steps,10,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_quickplay,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,num_levels_available,30,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_4,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_progressive,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_1,0,,,
630BD3C34C2E3BE5504A3B06CAE40320,first_open_time,,1517883202364000.0,,
630BD3C34C2E3BE5504A3B06CAE40320,ad_frequency,4,,,
630BD3C34C2E3BE5504A3B06CAE40320,initial_extra_steps,10,,,
630BD3C34C2E3BE5504A3B06CAE40320,plays_quickplay,true,,,
630BD3C34C2E3BE5504A3B06CAE40320,num_levels_available,30,,,
630BD3C34C2E3BE5504A3B06CAE40320,firebase_exp_4,0,,,
630BD3C34C2E3BE5504A3B0
Query:
SELECT
  t.user_pseudo_id,
  prop.key,
  prop.value.string_value AS string_value,
  prop.value.int_value AS int_value,
  prop.value.float_value AS float_value,
  prop.value.double_value AS double_value
FROM `firebase-public-project.analytics_153293282.events_*` AS t
CROSS JOIN UNNEST(t.user_properties) AS prop
LIMIT 1000;
Answer:
Too long, hard cut:
user_pseudo_id,key,string_value,int_value,float_value,double_value
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609963675000.0,,
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,2,,,
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,true,,,
B458770ED6E295374FEEB3A68902CC28,ad_frequency,2,,,
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,20,,,
B458770ED6E295374FEEB3A68902CC28,first_open_time,,1464609
Query:
-- Corrected Query #5: Extract 'board' from event parameters in quickplay events
SELECT
  t.event_name,
  (SELECT value.string_value FROM UNNEST(t.event_params) WHERE key = 'board') AS board
FROM `firebase-public-project.analytics_153293282.events_*` AS t
WHERE LOWER(event_name) LIKE '%quickplay%'
LIMIT 1000
Answer:
Too long, hard cut:
event_name,board
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_retry_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_fail_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_fail_quickplay,S
level_fail_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_complete_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_retry_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_retry_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_retry_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_end_quickplay,S
level_start_quickplay,S
level_fail_quickplay,S
level_
Query:
-- Corrected Query #6: Count number of users per board type in quickplay events
SELECT
  (SELECT value.string_value FROM UNNEST(t.event_params) WHERE key = 'board') AS board_type,
  COUNT(DISTINCT user_pseudo_id) AS user_count
FROM `firebase-public-project.analytics_153293282.events_*` AS t
WHERE LOWER(event_name) LIKE '%quickplay%'
  AND _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
GROUP BY board_type
LIMIT 1000
Answer:
board_type,user_count
S,1782
M,167
L,157
Query:
-- Corrected Query #13: Count number of quickplay events per board type
SELECT
  (SELECT value.string_value FROM UNNEST(event_params) WHERE key = 'board') AS board_type,
  COUNT(*) AS event_count
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE LOWER(event_name) LIKE '%quickplay%'
GROUP BY board_type
LIMIT 1000
Answer:
board_type,event_count
L,121215
M,100532
S,1131752
Query:
-- Corrected Query #14: List user properties for users engaged in quickplay events
SELECT
  t.user_pseudo_id,
  prop.key,
  prop.value.string_value AS string_value,
  prop.value.int_value AS int_value,
  prop.value.float_value AS float_value,
  prop.value.double_value AS double_value
FROM `firebase-public-project.analytics_153293282.events_*` AS t
CROSS JOIN UNNEST(t.user_properties) AS prop
WHERE LOWER(t.event_name) LIKE '%quickplay%'
LIMIT 1000
Answer:
Too long, hard cut:
user_pseudo_id,key,string_value,int_value,float_value,double_value
295D9E24D8DE65A010313E667131EF19,plays_quickplay,true,,,
295D9E24D8DE65A010313E667131EF19,num_levels_available,30,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_4,1,,,
295D9E24D8DE65A010313E667131EF19,plays_progressive,true,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_1,0,,,
295D9E24D8DE65A010313E667131EF19,first_open_time,,1531061434675000.0,,
295D9E24D8DE65A010313E667131EF19,ad_frequency,4,,,
295D9E24D8DE65A010313E667131EF19,initial_extra_steps,10,,,
295D9E24D8DE65A010313E667131EF19,plays_quickplay,true,,,
295D9E24D8DE65A010313E667131EF19,num_levels_available,30,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_4,1,,,
295D9E24D8DE65A010313E667131EF19,plays_progressive,true,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_1,0,,,
295D9E24D8DE65A010313E667131EF19,first_open_time,,1531061434675000.0,,
295D9E24D8DE65A010313E667131EF19,ad_frequency,4,,,
295D9E24D8DE65A010313E667131EF19,initial_extra_steps,10,,,
295D9E24D8DE65A010313E667131EF19,plays_quickplay,true,,,
295D9E24D8DE65A010313E667131EF19,num_levels_available,30,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_4,1,,,
295D9E24D8DE65A010313E667131EF19,plays_progressive,true,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_1,0,,,
295D9E24D8DE65A010313E667131EF19,first_open_time,,1531061434675000.0,,
295D9E24D8DE65A010313E667131EF19,ad_frequency,4,,,
295D9E24D8DE65A010313E667131EF19,initial_extra_steps,10,,,
295D9E24D8DE65A010313E667131EF19,plays_quickplay,true,,,
295D9E24D8DE65A010313E667131EF19,num_levels_available,30,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_4,1,,,
295D9E24D8DE65A010313E667131EF19,plays_progressive,true,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_1,0,,,
295D9E24D8DE65A010313E667131EF19,first_open_time,,1531061434675000.0,,
295D9E24D8DE65A010313E667131EF19,ad_frequency,4,,,
295D9E24D8DE65A010313E667131EF19,initial_extra_steps,10,,,
295D9E24D8DE65A010313E667131EF19,plays_quickplay,true,,,
295D9E24D8DE65A010313E667131EF19,num_levels_available,30,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_4,1,,,
295D9E24D8DE65A010313E667131EF19,plays_progressive,true,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_1,0,,,
295D9E24D8DE65A010313E667131EF19,first_open_time,,1531061434675000.0,,
295D9E24D8DE65A010313E667131EF19,ad_frequency,4,,,
295D9E24D8DE65A010313E667131EF19,initial_extra_steps,10,,,
295D9E24D8DE65A010313E667131EF19,plays_quickplay,true,,,
295D9E24D8DE65A010313E667131EF19,num_levels_available,30,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_4,1,,,
295D9E24D8DE65A010313E667131EF19,plays_progressive,true,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_1,0,,,
295D9E24D8DE65A010313E667131EF19,first_open_time,,1531061434675000.0,,
295D9E24D8DE65A010313E667131EF19,ad_frequency,4,,,
295D9E24D8DE65A010313E667131EF19,initial_extra_steps,10,,,
295D9E24D8DE65A010313E667131EF19,plays_quickplay,true,,,
295D9E24D8DE65A010313E667131EF19,num_levels_available,30,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_4,1,,,
295D9E24D8DE65A010313E667131EF19,plays_progressive,true,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_1,0,,,
295D9E24D8DE65A010313E667131EF19,first_open_time,,1531061434675000.0,,
295D9E24D8DE65A010313E667131EF19,ad_frequency,4,,,
295D9E24D8DE65A010313E667131EF19,initial_extra_steps,10,,,
295D9E24D8DE65A010313E667131EF19,plays_quickplay,true,,,
295D9E24D8DE65A010313E667131EF19,num_levels_available,30,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_4,1,,,
295D9E24D8DE65A010313E667131EF19,plays_progressive,true,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_1,0,,,
295D9E24D8DE65A010313E667131EF19,first_open_time,,1531061434675000.0,,
295D9E24D8DE65A010313E667131EF19,ad_frequency,4,,,
295D9E24D8DE65A010313E667131EF19,initial_extra_steps,10,,,
295D9E24D8DE65A010313E667131EF19,plays_quickplay,true,,,
295D9E24D8DE65A010313E667131EF19,num_levels_available,30,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_4,1,,,
295D9E24D8DE65A010313E667131EF19,plays_progressive,true,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_1,0,,,
295D9E24D8DE65A010313E667131EF19,first_open_time,,1531061434675000.0,,
295D9E24D8DE65A010313E667131EF19,ad_frequency,4,,,
295D9E24D8DE65A010313E667131EF19,initial_extra_steps,10,,,
295D9E24D8DE65A010313E667131EF19,plays_quickplay,true,,,
295D9E24D8DE65A010313E667131EF19,num_levels_available,30,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_4,1,,,
295D9E24D8DE65A010313E667131EF19,plays_progressive,true,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_1,0,,,
295D9E24D8DE65A010313E667131EF19,first_open_time,,1531061434675000.0,,
295D9E24D8DE65A010313E667131EF19,ad_frequency,4,,,
295D9E24D8DE65A010313E667131EF19,initial_extra_steps,10,,,
295D9E24D8DE65A010313E667131EF19,plays_quickplay,true,,,
295D9E24D8DE65A010313E667131EF19,num_levels_available,30,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_4,1,,,
295D9E24D8DE65A010313E667131EF19,plays_progressive,true,,,
295D9E24D8DE65A010313E667131EF19,firebase_exp_1,0,,,
295D9E24D8DE65A010313
Query:
SELECT
  t.user_pseudo_id,
  prop.key,
  prop.value.string_value AS string_value,
  prop.value.int_value AS int_value,
  prop.value.float_value AS float_value,
  prop.value.double_value AS double_value
FROM `firebase-public-project.analytics_153293282.events_*` AS t
CROSS JOIN UNNEST(t.user_properties) AS prop
WHERE t.user_pseudo_id IN (
    SELECT DISTINCT user_pseudo_id
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE LOWER(event_name) LIKE '%quickplay%'
)
LIMIT 1000;
Answer:
Too long, hard cut:
user_pseudo_id,key,string_value,int_value,float_value,double_value
7705D52DD2286DC2E6DB831A2E129E94,ad_frequency,16,,,
7705D52DD2286DC2E6DB831A2E129E94,initial_extra_steps,20,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_quickplay,true,,,
7705D52DD2286DC2E6DB831A2E129E94,num_levels_available,30,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_4,2,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_progressive,true,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_1,3,,,
7705D52DD2286DC2E6DB831A2E129E94,first_open_time,,1536544162346000.0,,
7705D52DD2286DC2E6DB831A2E129E94,ad_frequency,16,,,
7705D52DD2286DC2E6DB831A2E129E94,initial_extra_steps,20,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_quickplay,true,,,
7705D52DD2286DC2E6DB831A2E129E94,num_levels_available,30,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_4,2,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_progressive,true,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_1,3,,,
7705D52DD2286DC2E6DB831A2E129E94,first_open_time,,1536544162346000.0,,
7705D52DD2286DC2E6DB831A2E129E94,ad_frequency,16,,,
7705D52DD2286DC2E6DB831A2E129E94,initial_extra_steps,20,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_quickplay,true,,,
7705D52DD2286DC2E6DB831A2E129E94,num_levels_available,30,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_4,2,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_progressive,true,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_1,3,,,
7705D52DD2286DC2E6DB831A2E129E94,first_open_time,,1536544162346000.0,,
7705D52DD2286DC2E6DB831A2E129E94,ad_frequency,16,,,
7705D52DD2286DC2E6DB831A2E129E94,initial_extra_steps,20,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_quickplay,true,,,
7705D52DD2286DC2E6DB831A2E129E94,num_levels_available,30,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_4,2,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_progressive,true,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_1,3,,,
7705D52DD2286DC2E6DB831A2E129E94,first_open_time,,1536544162346000.0,,
7705D52DD2286DC2E6DB831A2E129E94,ad_frequency,16,,,
7705D52DD2286DC2E6DB831A2E129E94,initial_extra_steps,20,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_quickplay,true,,,
7705D52DD2286DC2E6DB831A2E129E94,num_levels_available,30,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_4,2,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_progressive,true,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_1,3,,,
7705D52DD2286DC2E6DB831A2E129E94,first_open_time,,1536544162346000.0,,
7705D52DD2286DC2E6DB831A2E129E94,ad_frequency,16,,,
7705D52DD2286DC2E6DB831A2E129E94,initial_extra_steps,20,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_quickplay,true,,,
7705D52DD2286DC2E6DB831A2E129E94,num_levels_available,30,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_4,2,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_progressive,true,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_1,3,,,
7705D52DD2286DC2E6DB831A2E129E94,first_open_time,,1536544162346000.0,,
7705D52DD2286DC2E6DB831A2E129E94,ad_frequency,16,,,
7705D52DD2286DC2E6DB831A2E129E94,initial_extra_steps,20,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_quickplay,true,,,
7705D52DD2286DC2E6DB831A2E129E94,num_levels_available,30,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_4,2,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_progressive,true,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_1,3,,,
7705D52DD2286DC2E6DB831A2E129E94,first_open_time,,1536544162346000.0,,
7705D52DD2286DC2E6DB831A2E129E94,ad_frequency,16,,,
7705D52DD2286DC2E6DB831A2E129E94,initial_extra_steps,20,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_quickplay,true,,,
7705D52DD2286DC2E6DB831A2E129E94,num_levels_available,30,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_4,2,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_progressive,true,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_1,3,,,
7705D52DD2286DC2E6DB831A2E129E94,first_open_time,,1536544162346000.0,,
7705D52DD2286DC2E6DB831A2E129E94,ad_frequency,16,,,
7705D52DD2286DC2E6DB831A2E129E94,initial_extra_steps,20,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_quickplay,true,,,
7705D52DD2286DC2E6DB831A2E129E94,num_levels_available,30,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_4,2,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_progressive,true,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_1,3,,,
7705D52DD2286DC2E6DB831A2E129E94,first_open_time,,1536544162346000.0,,
7705D52DD2286DC2E6DB831A2E129E94,ad_frequency,16,,,
7705D52DD2286DC2E6DB831A2E129E94,initial_extra_steps,20,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_quickplay,true,,,
7705D52DD2286DC2E6DB831A2E129E94,num_levels_available,30,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_4,2,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_progressive,true,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_1,3,,,
7705D52DD2286DC2E6DB831A2E129E94,first_open_time,,1536544162346000.0,,
7705D52DD2286DC2E6DB831A2E129E94,ad_frequency,16,,,
7705D52DD2286DC2E6DB831A2E129E94,initial_extra_steps,20,,,
7705D52DD2286DC2E6DB831A2E129E94,plays_quickplay,true,,,
7705D52DD2286DC2E6DB831A2E129E94,num_levels_available,30,,,
7705D52DD2286DC2E6DB831A2E129E94,firebase_exp_4,2,,,
7705D52DD228
Query:
SELECT
  t.user_pseudo_id,
  prop.key,
  prop.value.string_value AS string_value,
  prop.value.int_value AS int_value,
  prop.value.float_value AS float_value,
  prop.value.double_value AS double_value
FROM `firebase-public-project.analytics_153293282.events_*` AS t
CROSS JOIN UNNEST(t.user_properties) AS prop
WHERE LOWER(t.event_name) LIKE '%quickplay%'
LIMIT 1000;
Answer:
Too long, hard cut:
user_pseudo_id,key,string_value,int_value,float_value,double_value
1879629E259EAE7CC648E2F33CD77776,plays_quickplay,true,,,
1879629E259EAE7CC648E2F33CD77776,num_levels_available,30,,,
1879629E259EAE7CC648E2F33CD77776,firebase_last_notification,4103780380169369052,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_4,0,,,
1879629E259EAE7CC648E2F33CD77776,plays_progressive,true,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_1,0,,,
1879629E259EAE7CC648E2F33CD77776,first_open_time,,1483570824513000.0,,
1879629E259EAE7CC648E2F33CD77776,ad_frequency,3,,,
1879629E259EAE7CC648E2F33CD77776,initial_extra_steps,10,,,
1879629E259EAE7CC648E2F33CD77776,plays_quickplay,true,,,
1879629E259EAE7CC648E2F33CD77776,num_levels_available,30,,,
1879629E259EAE7CC648E2F33CD77776,firebase_last_notification,4103780380169369052,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_4,0,,,
1879629E259EAE7CC648E2F33CD77776,plays_progressive,true,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_1,0,,,
1879629E259EAE7CC648E2F33CD77776,first_open_time,,1483570824513000.0,,
1879629E259EAE7CC648E2F33CD77776,ad_frequency,3,,,
1879629E259EAE7CC648E2F33CD77776,initial_extra_steps,10,,,
1879629E259EAE7CC648E2F33CD77776,plays_quickplay,true,,,
1879629E259EAE7CC648E2F33CD77776,num_levels_available,30,,,
1879629E259EAE7CC648E2F33CD77776,firebase_last_notification,4103780380169369052,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_4,0,,,
1879629E259EAE7CC648E2F33CD77776,plays_progressive,true,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_1,0,,,
1879629E259EAE7CC648E2F33CD77776,first_open_time,,1483570824513000.0,,
1879629E259EAE7CC648E2F33CD77776,ad_frequency,3,,,
1879629E259EAE7CC648E2F33CD77776,initial_extra_steps,10,,,
1879629E259EAE7CC648E2F33CD77776,plays_quickplay,true,,,
1879629E259EAE7CC648E2F33CD77776,num_levels_available,30,,,
1879629E259EAE7CC648E2F33CD77776,firebase_last_notification,4103780380169369052,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_4,0,,,
1879629E259EAE7CC648E2F33CD77776,plays_progressive,true,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_1,0,,,
1879629E259EAE7CC648E2F33CD77776,first_open_time,,1483570824513000.0,,
1879629E259EAE7CC648E2F33CD77776,ad_frequency,3,,,
1879629E259EAE7CC648E2F33CD77776,initial_extra_steps,10,,,
1879629E259EAE7CC648E2F33CD77776,plays_quickplay,true,,,
1879629E259EAE7CC648E2F33CD77776,num_levels_available,30,,,
1879629E259EAE7CC648E2F33CD77776,firebase_last_notification,4103780380169369052,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_4,0,,,
1879629E259EAE7CC648E2F33CD77776,plays_progressive,true,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_1,0,,,
1879629E259EAE7CC648E2F33CD77776,first_open_time,,1483570824513000.0,,
1879629E259EAE7CC648E2F33CD77776,ad_frequency,3,,,
1879629E259EAE7CC648E2F33CD77776,initial_extra_steps,10,,,
1879629E259EAE7CC648E2F33CD77776,plays_quickplay,true,,,
1879629E259EAE7CC648E2F33CD77776,num_levels_available,30,,,
1879629E259EAE7CC648E2F33CD77776,firebase_last_notification,4103780380169369052,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_4,0,,,
1879629E259EAE7CC648E2F33CD77776,plays_progressive,true,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_1,0,,,
1879629E259EAE7CC648E2F33CD77776,first_open_time,,1483570824513000.0,,
1879629E259EAE7CC648E2F33CD77776,ad_frequency,3,,,
1879629E259EAE7CC648E2F33CD77776,initial_extra_steps,10,,,
1879629E259EAE7CC648E2F33CD77776,plays_quickplay,true,,,
1879629E259EAE7CC648E2F33CD77776,num_levels_available,30,,,
1879629E259EAE7CC648E2F33CD77776,firebase_last_notification,4103780380169369052,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_4,0,,,
1879629E259EAE7CC648E2F33CD77776,plays_progressive,true,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_1,0,,,
1879629E259EAE7CC648E2F33CD77776,first_open_time,,1483570824513000.0,,
1879629E259EAE7CC648E2F33CD77776,ad_frequency,3,,,
1879629E259EAE7CC648E2F33CD77776,initial_extra_steps,10,,,
1879629E259EAE7CC648E2F33CD77776,plays_quickplay,true,,,
1879629E259EAE7CC648E2F33CD77776,num_levels_available,30,,,
1879629E259EAE7CC648E2F33CD77776,firebase_last_notification,4103780380169369052,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_4,0,,,
1879629E259EAE7CC648E2F33CD77776,plays_progressive,true,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_1,0,,,
1879629E259EAE7CC648E2F33CD77776,first_open_time,,1483570824513000.0,,
1879629E259EAE7CC648E2F33CD77776,ad_frequency,3,,,
1879629E259EAE7CC648E2F33CD77776,initial_extra_steps,10,,,
1879629E259EAE7CC648E2F33CD77776,plays_quickplay,true,,,
1879629E259EAE7CC648E2F33CD77776,num_levels_available,30,,,
1879629E259EAE7CC648E2F33CD77776,firebase_last_notification,4103780380169369052,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_4,0,,,
1879629E259EAE7CC648E2F33CD77776,plays_progressive,true,,,
1879629E259EAE7CC648E2F33CD77776,firebase_exp_1,0,,,
1879629E259EAE7CC648E2F33CD77776,first_open_time,,1483570824513000.0,,
1879629E259EAE7CC648E2F33CD77776,ad_frequency,3,,,
1879629E259EAE7CC648E2F33CD77776,initial_extra_steps,10,,,
1879629E259EAE7CC64
Query:
-- Simplified Query #7: Retrieve user engagement after initial engagement
WITH user_first_engagement_date AS (
  SELECT user_pseudo_id,
         MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_engagement_date
  FROM `firebase-public-project.analytics_153293282.events_*`
  GROUP BY user_pseudo_id
)
SELECT
  t.user_pseudo_id,
  t.event_date,
  t.event_name
FROM `firebase-public-project.analytics_153293282.events_*` AS t
JOIN user_first_engagement_date AS u
  ON t.user_pseudo_id = u.user_pseudo_id
WHERE PARSE_DATE('%Y%m%d', t.event_date) > u.first_engagement_date
  AND LOWER(t.event_name) LIKE '%quickplay%'
LIMIT 1000
Answer:
Too long, hard cut:
user_pseudo_id,event_date,event_name
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_complete_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_fail_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_fail_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_fail_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_fail_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_retry_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_fail_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_retry_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_retry_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_end_quickplay
B8FE9AD137A133A89389656F7989B36C,20180909,level_start_q
Query:
-- Simplified Query #11: Get user retention for quickplay events by counting users who returned after initial engagement
WITH initial_users AS (
  SELECT DISTINCT user_pseudo_id,
         MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_engagement_date
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE LOWER(event_name) LIKE '%quickplay%'
  GROUP BY user_pseudo_id
),
retained_users AS (
  SELECT DISTINCT t.user_pseudo_id
  FROM `firebase-public-project.analytics_153293282.events_*` AS t
  JOIN initial_users AS u
    ON t.user_pseudo_id = u.user_pseudo_id
  WHERE PARSE_DATE('%Y%m%d', t.event_date) > u.first_engagement_date
    AND LOWER(t.event_name) LIKE '%quickplay%'
)
SELECT user_pseudo_id
FROM retained_users
LIMIT 1000
Answer:
Too long, hard cut:
user_pseudo_id
654F30C1312F6C1A26DFDA9F076A62D8
3EF8FC940E379D53BBD3FEFDAF626BB2
7D613AF4DA0F508C7090E96FD73B7E6D
D7EA8E3645EFFBD6443946179ED704A6
FFA9AE78B23263835F8AAED57713EBE9
D4A11F0C6E87988E9DA1475EAF38137A
03A9D32C44665A9E15CFCCEDC9F68EDB
91D637F0D9FB259AD52773B1B20151BE
0AF862AFEB5358EBFDA7AFE3AC908844
C639CACA07D03F536F537ED779CF6599
9DE945166BCD4709696C5836317DDE47
D842320AECB686B41C2F8E8876794D34
D4F4DAEF5BE38E5C67FD72BB1F082EBF
372D9BB5088C4E9000C65B06459B403A
FEC0B30EED7870C4D46230D73032E5CA
091770A1325101155A651F90D283DA35
5E9BF00B469B284E028094EA15A9F1FE
5A7EB17BF7D867AADECA2FDAF0941E88
8EFA45B60DF34986EDC7C7CC0CD7CD69
964526CBEE730E91EB0A51E3E4B4BDB9
59F6BEF625E630452B2BA0F38D7414B2
7288C0D2279483F63ECB1B01E7FDDC4A
359A34F575B808FEFE58BC5B40816F09
14DE6B1CDA3BFD44679C7E9382644AC7
B087A865A90AD52D1864A36482983BD2
E66C3B8A38C424C7CBE0B5388EE5F77E
A0F1D068A8E7FA561AC7B4174DD5E2A5
08E6794EAC892997E8C3BB2323173641
158D85747B252579015AE58305CBC8C1
625CF86657E00A4629BCE49F5B31A144
EF0FBB41BE6F40A5CC1D68D8E1CD3591
D4C8E3E0EFC45C3D60AB3F0F305489AF
7E74A2BB6BBF4746DEE15F957B315401
11A8D6037368A4C4508B11ADB4353BC4
13AC12EF4C6A0EAF72795F720752AD98
8B404ABBCDCF859DB2E5ABE00B482621
186EF14CC97E86390BAE614FDAF4119D
C09F04828B07E4DFEF39DA5C4A976A90
CC62213661BE43BF92836F37DF9B3ADD
DAA3F353F320A717A0C418A8205292B2
A2B7DF97E146FC5AB4C8F89A94D85B4A
548C38A983EB2EB88DC1DEEA9DE6DED9
77BD91427F3805FD6A30F445FB0DC50B
90D99AC8BC1551757037513287A3B8B4
81D3DD49AA2304FD1ED8C498747B5FC6
A37AD550BCBF8C8B1D5616BB5A47770D
8ED10D7485D74E405548A3B99912C839
9EBBDF6D1D91535F99C0BAD3C0EBDC73
2E576595B5FF8D66CA224AFADAE588B4
65D1701E5BA0070CCF15F0CB0E1CF750
A8FF30877FB5CE1DDF75322B4B74EE30
AAA09F62893A41F0D9B2247AB87FA48C
57A64EB2ABD60937979A683D71025060
D961BD6AADAC53884DA8732A964CDFFD
86F19DAB73E484FB7DD2F805DDD7957D
2CD0A58C01E50CB6D66FCF06ECAA4C1B
50C60BB1599A79A9FA68C92B9E9589F2
FCC86DFF79753F8DA423B52600EE42F1
0E3E6936E3AC681876BC1DD6ABE7E937
FD7D7BEFC4F893B3066BA49035321901
1611A8EAF92912A6AE4289CE15EB7411
99F4AE4D59124072246056B3810A7324
13C303BADAA654EAF82FF64A8764C27E
06D8AAEACE405BEB27DC4AE30FAAAFF1
D4233AF1ECC193375484C63AAD97CE3E
FC031A3E74D422EBB63250A664AC6F8B
85580828B10E0DBDD5D00D394989DFC0
FE1AE0BECFED265B61163FCAF4EFF6ED
904877128B8889DDD71A38BDBCD21724
1E9F6BA9BD8C45633C26F42995A77775
5D61E6AC342F01CDCAF3A20B02426C70
31759C0600B02839C5A90DBB2CE97984
8A36D1D846123090C677E3E184B30614
D4DDA67EF184AFBC5E2D52FBDEDD7837
5C0B5019D09A484ECA0AF6E636D4205E
E7CCB643C1D0028BF305EDD85397255E
378431079481767D3F2CAD6612826DAE
3FD83714C2BC47927FA375E1FA7E2C7F
FE3331C93B8A54B8C9145532FFAD704A
F405ABC6E049921FB3587A2BE71559C9
51C511BDA46B8307F21527B455A1A59F
46758A92B62273B1A72F73D3B58945CA
83C1BFAF72CC9FF92E34D5A940101815
0373DF7959F6867CDFB1C905D39CE67C
9F3EAF490630617EF2CB47A8BD2CBBCC
7C304CB855AFB5F5C742E936F34972AB
F91F493916395FE4E16DE98B24388985
66EE0DB049AA1A3B92B41375C1263B05
B2ED849BBB2D152DF245B09A41687D4F
7E38A396789F21724DDEFB0400305685
9D956C83A0AD889DDFCA96A7589A40AD
475B281839C403CCF826D0D44890BFA5
E24714CE7A02078BBB80C632B68F88F7
76D08FC682BB0E757CB3895297B82844
885852C000C31A983D41BBFB86D71AED
7D7B319DFFF03520EF50236B2C3FB008
FD995DD8499A3D9D8102571A6C8A1C22
938611E83B897B6F877992BF30D3E1FE
295D9E24D8DE65A010313E667131EF19
9AB38AB2AE2B6B15B572DE3AEFB04363
278F45BFDAAC6EA9CED0999482E5C93E
B224957B5C7A071A449284DDAEA2B581
D1CC3A8740095F70116D613EC471A21D
0E05204A44E4CA8857B83A2FED471037
4EF964D59282E5A2C8692D30F011256B
E2C73393E938B51088B200E971667B8A
4930D1E24B57750792540C82C54D64E6
FF67B1C2BDF236F255703B1F4CD41EB4
4B3CC3382387935EC4D2AB4F6EFC56FA
0B427C5E490A982FADF586F82E797ACB
8D69D45B590556225AA4325D785CA806
0CF5644CEE7E80B439341E3C74DA73AB
3682C2527BEE6BA0255321BB25DF44BB
A09FB36DC9236D7C16606A65AB9F8799
7A1AFF03DBD16FE6E25C5CDFEDE614CF
45BDDEC4DF8773F88DC51D1AFD145521
CDC9A224610417F5F1E97C8B96168950
814700C58B117F7ABFFB1145B9C29D29
A82658237C6118780A6009C01F05DDEB
F89FB7FA61F2B6CAA3679E739CAB2477
6A24D64A89D95F922CF43FD19EB2189F
D43866E69920AFDC3D1B3E6F239E4812
ED7B241CAB6A7131CF4630C4C56BEA55
FCE87FAB4008BB95845192C9DE2B4BB6
38D65030548914B5E167CE85B035CA8F
402F30A77B5F6C1395F822860A3512FF
B76BF68579286F93FF10121993697E25
6D16DFC946ED02BDEF46FEDBB0523DA6
5BB5D536C1524FB07C79A210CAD95D01
038ECB9DA7C88F11088134C7FFB99DBD
75E2898326344BC87AE25D3C88809CEF
1A79E9DCC8204A01E73B5684FE089D40
5B8588123F79266FB7D635E31A734608
805BDC95D94B57B88F9128E6B6708692
347E136FEC789C49DA42A7F8CA5EFE51
9ADF895776EA36952298EE796C67B510
74AA252973ED84AA7C2471A3A4E5FDB6
0B32FD716C1F4BD0DA3A8DCA896F18BB
32542EF20DCB04AB03C08B87DD9B4D45
890D9DD57FD110C8E699A40B27512083
22C7EB46372F9F81C6FB9757A3875E04
75574B7DB9C97F001537DA36DDAE0C80
241293471505B5DFB907A2AFC5D26BC1
6B79073DC6A4D08D7718ABD38722ED70
1D763A3E95386CEEF80C5174E6216F8C
C302332F1B2DC5162E47913A708C479B
A68C4D0A3F32C3F7621CA7675E9F39A6
C2F9C29AE66D5B80EBB2490AB11273B8
F3779F2B0544630A7544BA7694CF3938
6C40A2B1B7C2336EDCE4B9F346682A72
B810EC88D69D961A2FA7ECC0F323D9EE
27
End Exploring Related Columns
Task: Which quickplay event type had the lowest user retention rate during the second week after their initial engagement, for users who first engaged between August 1 and August 15, 2018?

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
Event_type,Second_week_retention_rate
event_type_name:str,retention_rate:float in [0,100]
(Attention: answer in one row)
```

The quickplay event type with the lowest user retention rate during the second week after their initial engagement, for users who first engaged between August 1 and August 15, 2018, is listed above. The retention rate is a percentage value between 0 and 100..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: 

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-19 10:01:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 10:01:09 - root - INFO - ```sql
WITH initial_engagement AS (
  SELECT
    user_pseudo_id,
    LOWER(event_name) AS event_type,
    MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_engagement_date
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
    AND LOWER(event_name) LIKE '%quickplay%'
  GROUP BY user_pseudo_id, event_type
),
second_week_engagement AS (
  SELECT DISTINCT
    t.user_pseudo_id,
    LOWER(t.event_name) AS event_type
  FROM `firebase-public-project.analytics_153293282.events_*` AS t
  JOIN initial_engagement AS i
    ON t.user_pseudo_id = i.user_pseudo_id
    AND LOWER(t.event_name) = i.event_type
  WHERE PARSE_DATE('%Y%m%d', t.event_date) BETWEEN DATE_ADD(i.first_engagement_date, INTERVAL 7 DAY) AND DATE_ADD(i.first_engagement_date, INTERVAL 14 DAY)
    AND LOWER(t.event_name) LIKE '%quickplay%'
),
retention AS (
  SELECT
    i.event_type,
    COUNT(DISTINCT i.user_pseudo_id) AS initial_users,
    COUNT(DISTINCT s.user_pseudo_id) AS retained_users
  FROM initial_engagement AS i
  LEFT JOIN second_week_engagement AS s
    ON i.user_pseudo_id = s.user_pseudo_id
    AND i.event_type = s.event_type
  GROUP BY i.event_type
)
SELECT event_type,
       ROUND((CAST(retained_users AS FLOAT64) / initial_users) * 100, 4) AS second_week_retention_rate
FROM retention
ORDER BY second_week_retention_rate ASC
LIMIT 1
```
2025-01-19 10:01:17 - root - INFO - itercount: 1
2025-01-19 10:01:17 - root - INFO - 0
2025-01-19 10:01:17 - root - INFO - results: 
event_type,second_week_retention_rate
level_reset_quickplay,20.8185


2025-01-19 10:01:17 - root - INFO - Please check the answer again by reviewing Which quickplay event type had the lowest user retention rate during the second week after their initial engagement, for users who first engaged between August 1 and August 15, 2018?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Event_type,Second_week_retention_rate
event_type_name:str,retention_rate:float in [0,100]
(Attention: answer in one row)
```

The quickplay event type with the lowest user retention rate during the second week after their initial engagement, for users who first engaged between August 1 and August 15, 2018, is listed above. The retention rate is a percentage value between 0 and 100. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
event_type,second_week_retention_rate
level_reset_quickplay,20.8185
Current sql:
WITH initial_engagement AS (
  SELECT
    user_pseudo_id,
    LOWER(event_name) AS event_type,
    MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_engagement_date
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
    AND LOWER(event_name) LIKE '%quickplay%'
  GROUP BY user_pseudo_id, event_type
),
second_week_engagement AS (
  SELECT DISTINCT
    t.user_pseudo_id,
    LOWER(t.event_name) AS event_type
  FROM `firebase-public-project.analytics_153293282.events_*` AS t
  JOIN initial_engagement AS i
    ON t.user_pseudo_id = i.user_pseudo_id
    AND LOWER(t.event_name) = i.event_type
  WHERE PARSE_DATE('%Y%m%d', t.event_date) BETWEEN DATE_ADD(i.first_engagement_date, INTERVAL 7 DAY) AND DATE_ADD(i.first_engagement_date, INTERVAL 14 DAY)
    AND LOWER(t.event_name) LIKE '%quickplay%'
),
retention AS (
  SELECT
    i.event_type,
    COUNT(DISTINCT i.user_pseudo_id) AS initial_users,
    COUNT(DISTINCT s.user_pseudo_id) AS retained_users
  FROM initial_engagement AS i
  LEFT JOIN second_week_engagement AS s
    ON i.user_pseudo_id = s.user_pseudo_id
    AND i.event_type = s.event_type
  GROUP BY i.event_type
)
SELECT event_type,
       ROUND((CAST(retained_users AS FLOAT64) / initial_users) * 100, 4) AS second_week_retention_rate
FROM retention
ORDER BY second_week_retention_rate ASC
LIMIT 1
2025-01-19 10:01:51 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 10:01:51 - root - INFO - ```sql
WITH initial_engagement AS (
  SELECT
    user_pseudo_id,
    LOWER(event_name) AS event_type,
    MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_engagement_date
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE _TABLE_SUFFIX BETWEEN '20180801' AND '20180815'
    AND LOWER(event_name) LIKE '%quickplay%'
  GROUP BY user_pseudo_id, event_type
),
second_week_engagement AS (
  SELECT DISTINCT
    t.user_pseudo_id,
    LOWER(t.event_name) AS event_type
  FROM `firebase-public-project.analytics_153293282.events_*` AS t
  JOIN initial_engagement AS i
    ON t.user_pseudo_id = i.user_pseudo_id
    AND LOWER(t.event_name) = i.event_type
  WHERE PARSE_DATE('%Y%m%d', t.event_date) BETWEEN DATE_ADD(i.first_engagement_date, INTERVAL 7 DAY) AND DATE_ADD(i.first_engagement_date, INTERVAL 14 DAY)
    AND LOWER(t.event_name) LIKE '%quickplay%'
),
retention AS (
  SELECT
    i.event_type,
    COUNT(DISTINCT i.user_pseudo_id) AS initial_users,
    COUNT(DISTINCT s.user_pseudo_id) AS retained_users
  FROM initial_engagement AS i
  LEFT JOIN second_week_engagement AS s
    ON i.user_pseudo_id = s.user_pseudo_id
    AND i.event_type = s.event_type
  GROUP BY i.event_type
)
SELECT event_type AS Event_type,
       ROUND((CAST(retained_users AS FLOAT64) / initial_users) * 100, 4) AS Second_week_retention_rate
FROM retention
ORDER BY Second_week_retention_rate ASC
LIMIT 1
```

```csv
Event_type,Second_week_retention_rate
level_reset_quickplay,20.8185
```
2025-01-19 10:01:58 - root - INFO - itercount: 2
2025-01-19 10:01:58 - root - INFO - 0
2025-01-19 10:01:58 - root - INFO - Total iteration counts: 2
