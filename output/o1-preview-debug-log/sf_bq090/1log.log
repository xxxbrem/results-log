2025-01-20 18:25:35 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:25:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:25:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:25:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:25:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 18:25:37 - snowflake.connector.connection - INFO - closed
2025-01-20 18:25:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:25:37 - root - INFO - SQL:
SELECT t."Sides"
   FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t
   LIMIT 100;
Results:
Too long, hard cut:
Sides
"[
  {
    ""OrderID"": ""d8eefa63-6f10-4566-8f15-81460448f2ac"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""7fa78bef-912c-41cb-b381-4c03b5a7c508"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""5a4c4d8b-b9b8-4307-a0c3-8c753ed93520"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""a204ef77-1071-48ee-a5f5-21579311cd91"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""b7a40778-7293-407b-8636-91a7ffe9817a"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""c67a3f6a-7253-4ec8-91be-a4a3f07aa27b"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""83e09901-1182-4ad0-b423-0f92bf78a7a2"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""8161e8ff-9aa3-4e27-9322-363a4a063a27"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""2e2c0922-e696-44f6-899e-9112f6129088"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""8afcaa49-daca-470f-9479-6bfd2c648ccf"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""4e25aae7-5b30-408a-a23e-ea3afb86c445"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""048dab46-3718-4dd2-b12e-709ce317c069"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""0e00e452-329b-44df-90a5-902b7e737608"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""ae17c30f-0689-4013-8485-05f5eb5f7721"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""3a9010bf-80a3-46aa-ae04-afd4b1f39e1a"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""5880746a-b864-46b5-8204-060bbe7104a4"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""68bf4c18-8084-435b-8786-2ae9b104339e"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""0fe87fac-d58a-4bb9-8552-c1e58d91bb82"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""94641ac8-057f-4f66-ba2f-81edc252bbcf"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""dd4279ad-7a00-4c6f-b26f-0f98aff69aed"",
    ""P

2025-01-20 18:25:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:25:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:25:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:25:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 18:25:39 - snowflake.connector.connection - INFO - closed
2025-01-20 18:25:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:25:39 - root - INFO - SQL:
SELECT f.value
   FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
   LATERAL FLATTEN(input => t."Sides") f
   LIMIT 100;
Results:
Too long, hard cut:
VALUE
"{
  ""OrderID"": ""d8eefa63-6f10-4566-8f15-81460448f2ac"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""7fa78bef-912c-41cb-b381-4c03b5a7c508"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""5a4c4d8b-b9b8-4307-a0c3-8c753ed93520"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""a204ef77-1071-48ee-a5f5-21579311cd91"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""b7a40778-7293-407b-8636-91a7ffe9817a"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""c67a3f6a-7253-4ec8-91be-a4a3f07aa27b"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""83e09901-1182-4ad0-b423-0f92bf78a7a2"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""8161e8ff-9aa3-4e27-9322-363a4a063a27"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""2e2c0922-e696-44f6-899e-9112f6129088"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""8afcaa49-daca-470f-9479-6bfd2c648ccf"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""4e25aae7-5b30-408a-a23e-ea3afb86c445"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""048dab46-3718-4dd2-b12e-709ce317c069"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""0e00e452-329b-44df-90a5-902b7e737608"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""ae17c30f-0689-4013-8485-05f5eb5f7721"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""3a9010bf-80a3-46aa-ae04-afd4b1f39e1a"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""5880746a-b864-46b5-8204-060bbe7104a4"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""68bf4c18-8084-435b-8786-2ae9b104339e"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""0fe87fac-d58a-4bb9-8552-c1e58d91bb82"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""94641ac8-057f-4f66-ba2f-81edc252bbcf"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""dd4279ad-7a00-4c6f-b26f-0f98aff69aed"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""1f0ab9f6-7171-4b0c-a2bd-b61787f165b1"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""416c6876-0548-4ea1-b8a6-6b19faca54fc"",
  ""PartyIDs"": [
    {
      ""PartyID""

2025-01-20 18:25:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:25:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:25:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:25:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 18:25:41 - snowflake.connector.connection - INFO - closed
2025-01-20 18:25:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:26:19 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:26:19 - root - INFO - ```sql
SELECT
  AVG(t."LastPx" - t."StrikePrice") AS "AvgIntrinsicValue"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
LATERAL FLATTEN(input => t."Sides") f
WHERE f.value:"Side"::STRING = 'LONG';
```
2025-01-20 18:26:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:26:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:26:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:26:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 18:26:20 - snowflake.connector.connection - INFO - closed
2025-01-20 18:26:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:27:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:27:30 - root - INFO - SQL:
SELECT
  AVG(t."LastPx" - t."StrikePrice") AS "AvgIntrinsicValue"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
LATERAL FLATTEN(input => t."Sides") f
WHERE f.value:"Side"::STRING = 'LONG';
Results:
AvgIntrinsicValue
-0.0034340648059031117

2025-01-20 18:27:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:27:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:27:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:27:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 9
2025-01-20 18:27:31 - snowflake.connector.connection - INFO - closed
2025-01-20 18:27:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:27:32 - root - INFO - SQL:
SELECT DISTINCT p.value:"PartyID"::STRING AS "PartyID"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
LIMIT 100
Results:
PartyID
LUCKYBTC
PREDICTES
LUCKYES
MOMOBTC
MOMONQ
PREDICTBTC
PREDICTNQ
MOMOES
LUCKYNQ

2025-01-20 18:27:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:27:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:27:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:27:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-20 18:27:33 - snowflake.connector.connection - INFO - closed
2025-01-20 18:27:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:27:34 - root - INFO - SQL:
SELECT DISTINCT f.value:"Side"::STRING AS "Side"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f
LIMIT 100
Results:
Side
SHORT
LONG

2025-01-20 18:27:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:27:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:27:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:27:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 18:27:35 - snowflake.connector.connection - INFO - closed
2025-01-20 18:27:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:27:36 - root - INFO - SQL:
SELECT
  t."StrikePrice",
  t."LastPx",
  f.value:"Side"::STRING AS "Side",
  p.value:"PartyID"::STRING AS "PartyID"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
LIMIT 100
Results:
StrikePrice,LastPx,Side,PartyID
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.125,11502.75,SHORT,PREDICTNQ
11532.75,11525.0,SHORT,PREDICTNQ
11529.375,11531.375,SHORT,PREDICTNQ
11527.875,11528.625,SHORT,PREDICTNQ
11528.75,11528.25,SHORT,PREDICTNQ
11532.75,11529.0,SHORT,PREDICTNQ
11573.5,11570.375,SHORT,PREDICTNQ
11569.125,11565.875,SHORT,PREDICTNQ
11582.75,11580.5,SHORT,PREDICTNQ
11579.875,11580.75,SHORT,PREDICTNQ
11579.0,11571.375,SHORT,PREDICTNQ
11559.625,11564.625,SHORT,PREDICTNQ
11555.75,11558.125,SHORT,PREDICTNQ
11554.875,11552.75,SHORT,PREDICTNQ
11553.625,11551.625,SHORT,PREDICTNQ
11564.625,11554.0,SHORT,PREDICTNQ
11558.25,11554.375,SHORT,PREDICTNQ
11550.75,11552.75,SHORT,PREDICTNQ
11548.125,11544.625,SHORT,PREDICTNQ
11537.125,11536.5,SHORT,PREDICTNQ
11536.875,11536.25,SHORT,PREDICTNQ
11536.75,11537.375,SHORT,PREDICTNQ
11541.0,11543.375,SHORT,PREDICTNQ
11539.375,11540.75,SHORT,PREDICTNQ
11538.875,11536.5,SHORT,PREDICTNQ
11526.875,11526.75,SHORT,PREDICTNQ
11526.75,11530.125,SHORT,PREDICTNQ
11533.625,11541.0,SHORT,PREDICTNQ
11527.375,11528.125,SHORT,PREDICTNQ
11535.0,11528.875,SHORT,PREDICTNQ
11537.5,11541.75,SHORT,PREDICTNQ
11533.625,11535.5,SHORT,PREDICTNQ
11535.875,11533.125,SHORT,PREDICTNQ
11533.5,11533.375,SHORT,PREDICTNQ
11543.25,11537.625,SHORT,PREDICTNQ
11559.875,11563.0,SHORT,PREDICTNQ
11563.625,11564.0,SHORT,PREDICTNQ
11556.375,11555.125,SHORT,PREDICTNQ
11553.375,11558.875,SHORT,PREDICTNQ
11525.625,11528.875,SHORT,PREDICTNQ
11525.875,11528.875,SHORT,PREDICTNQ
11479.625,11495.25,SHORT,PREDICTNQ
11487.5,11490.0,SHORT,PREDICTNQ
11486.375,11491.625,SHORT,PREDICTNQ
11488.375,11484.125,SHORT,PREDICTNQ
11483.25,11486.75,SHORT,PREDICTNQ
11482.75,11486.375,SHORT,PREDICTNQ
11490.375,11490.5,SHORT,PREDICTNQ
11479.125,11485.875,SHORT,PREDICTNQ
11495.875,11496.0,SHORT,PREDICTNQ
11489.75,11495.25,SHORT,PREDICTNQ
11491.625,11490.0,SHORT,PREDICTNQ
11491.375,11490.625,SHORT,PREDICTNQ
11494.125,11490.875,SHORT,PREDICTNQ
11498.625,11500.125,SHORT,PREDICTNQ
11499.25,11499.125,SHORT,PREDICTNQ
11498.125,11501.0,SHORT,PREDICTNQ
11493.75,11494.625,SHORT,PREDICTNQ
11506.75,11500.875,SHORT,PREDICTNQ
11502.0,11505.75,SHORT,PREDICTNQ
11494.875,11493.5,SHORT,PREDICTNQ
11499.75,11500.75,SHORT,PREDICTNQ
11508.5,11500.625,SHORT,PREDICTNQ
11504.125,11504.625,SHORT,PREDICTNQ
11517.25,11512.25,SHORT,PREDICTNQ
11524.5,11527.625,SHORT,PREDICTNQ
11518.5,11518.75,SHORT,PREDICTNQ
11546.125,11545.625,SHORT,PREDICTNQ
11558.125,11562.875,SHORT,PREDICTNQ
11553.5,11549.875,SHORT,PREDICTNQ
11549.75,11550.75,SHORT,PREDICTNQ
11551.0,11550.375,SHORT,PREDICTNQ
11551.125,11546.625,SHORT,PREDICTNQ
11548.75,11550.25,SHORT,PREDICTNQ
11557.875,11557.25,SHORT,PREDICTNQ
11557.0,11559.5,SHORT,PREDICTNQ
11555.625,11555.375,SHORT,PREDICTNQ
11550.25,11550.625,SHORT,PREDICTNQ

2025-01-20 18:27:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:27:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:27:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:27:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 18:27:37 - snowflake.connector.connection - INFO - closed
2025-01-20 18:27:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:27:37 - root - INFO - SQL:
SELECT
  t."LastPx" - t."StrikePrice" AS "IntrinsicValue",
  f.value:"Side"::STRING AS "Side",
  p.value:"PartyID"::STRING AS "PartyID"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
LIMIT 100
Results:
IntrinsicValue,Side,PartyID
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.625,SHORT,PREDICTNQ
-7.75,SHORT,PREDICTNQ
2.0,SHORT,PREDICTNQ
0.75,SHORT,PREDICTNQ
-0.5,SHORT,PREDICTNQ
-3.75,SHORT,PREDICTNQ
-3.125,SHORT,PREDICTNQ
-3.25,SHORT,PREDICTNQ
-2.25,SHORT,PREDICTNQ
0.875,SHORT,PREDICTNQ
-7.625,SHORT,PREDICTNQ
5.0,SHORT,PREDICTNQ
2.375,SHORT,PREDICTNQ
-2.125,SHORT,PREDICTNQ
-2.0,SHORT,PREDICTNQ
-10.625,SHORT,PREDICTNQ
-3.875,SHORT,PREDICTNQ
2.0,SHORT,PREDICTNQ
-3.5,SHORT,PREDICTNQ
-0.625,SHORT,PREDICTNQ
-0.625,SHORT,PREDICTNQ
0.625,SHORT,PREDICTNQ
2.375,SHORT,PREDICTNQ
1.375,SHORT,PREDICTNQ
-2.375,SHORT,PREDICTNQ
-0.125,SHORT,PREDICTNQ
3.375,SHORT,PREDICTNQ
7.375,SHORT,PREDICTNQ
0.75,SHORT,PREDICTNQ
-6.125,SHORT,PREDICTNQ
4.25,SHORT,PREDICTNQ
1.875,SHORT,PREDICTNQ
-2.75,SHORT,PREDICTNQ
-0.125,SHORT,PREDICTNQ
-5.625,SHORT,PREDICTNQ
3.125,SHORT,PREDICTNQ
0.375,SHORT,PREDICTNQ
-1.25,SHORT,PREDICTNQ
5.5,SHORT,PREDICTNQ
3.25,SHORT,PREDICTNQ
3.0,SHORT,PREDICTNQ
15.625,SHORT,PREDICTNQ
2.5,SHORT,PREDICTNQ
5.25,SHORT,PREDICTNQ
-4.25,SHORT,PREDICTNQ
3.5,SHORT,PREDICTNQ
3.625,SHORT,PREDICTNQ
0.125,SHORT,PREDICTNQ
6.75,SHORT,PREDICTNQ
0.125,SHORT,PREDICTNQ
5.5,SHORT,PREDICTNQ
-1.625,SHORT,PREDICTNQ
-0.75,SHORT,PREDICTNQ
-3.25,SHORT,PREDICTNQ
1.5,SHORT,PREDICTNQ
-0.125,SHORT,PREDICTNQ
2.875,SHORT,PREDICTNQ
0.875,SHORT,PREDICTNQ
-5.875,SHORT,PREDICTNQ
3.75,SHORT,PREDICTNQ
-1.375,SHORT,PREDICTNQ
1.0,SHORT,PREDICTNQ
-7.875,SHORT,PREDICTNQ
0.5,SHORT,PREDICTNQ
-5.0,SHORT,PREDICTNQ
3.125,SHORT,PREDICTNQ
0.25,SHORT,PREDICTNQ
-0.5,SHORT,PREDICTNQ
4.75,SHORT,PREDICTNQ
-3.625,SHORT,PREDICTNQ
1.0,SHORT,PREDICTNQ
-0.625,SHORT,PREDICTNQ
-4.5,SHORT,PREDICTNQ
1.5,SHORT,PREDICTNQ
-0.625,SHORT,PREDICTNQ
2.5,SHORT,PREDICTNQ
-0.25,SHORT,PREDICTNQ
0.375,SHORT,PREDICTNQ

2025-01-20 18:27:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:27:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:27:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:27:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 18:27:39 - snowflake.connector.connection - INFO - closed
2025-01-20 18:27:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:27:39 - root - INFO - SQL:
SELECT
  t."LastPx" - t."StrikePrice" AS "IntrinsicValue",
  f.value:"Side"::STRING AS "Side",
  p.value:"PartyID"::STRING AS "PartyID"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
WHERE f.value:"Side"::STRING = 'LONG'
LIMIT 100
Results:
IntrinsicValue,Side,PartyID
-1.0,LONG,MOMOES
0.25,LONG,MOMOES
-1.5,LONG,MOMOES
-0.75,LONG,MOMOES
0.5,LONG,MOMOES
0.0,LONG,MOMOES
2.25,LONG,MOMOES
0.25,LONG,MOMOES
-0.25,LONG,MOMOES
-0.5,LONG,MOMOES
0.5,LONG,MOMOES
0.5,LONG,MOMOES
0.0,LONG,MOMOES
1.0,LONG,MOMOES
-1.5,LONG,MOMOES
0.5,LONG,MOMOES
1.0,LONG,MOMOES
-1.0,LONG,MOMOES
0.0,LONG,MOMOES
0.0,LONG,MOMOES
0.0,LONG,MOMOES
0.375,LONG,MOMOES
-0.25,LONG,MOMOES
-0.5,LONG,MOMOES
-0.75,LONG,MOMOES
0.0,LONG,MOMOES
-0.75,LONG,MOMOES
-0.375,LONG,MOMOES
0.5,LONG,MOMOES
-0.75,LONG,MOMOES
0.5,LONG,MOMOES
0.0,LONG,MOMOES
0.25,LONG,MOMOES
0.875,LONG,MOMOES
0.5,LONG,MOMOES
0.75,LONG,MOMOES
-0.125,LONG,MOMOES
-1.25,LONG,MOMOES
0.0,LONG,MOMOES
0.0,LONG,MOMOES
0.0,LONG,MOMOES
-0.75,LONG,MOMOES
0.75,LONG,MOMOES
1.25,LONG,MOMOES
-1.25,LONG,MOMOES
0.0,LONG,MOMOES
2.5,LONG,MOMOES
-0.5,LONG,MOMOES
-1.375,LONG,MOMOES
0.25,LONG,MOMOES
-0.25,LONG,MOMOES
-0.25,LONG,MOMOES
0.25,LONG,MOMOES
-0.75,LONG,MOMOES
0.0,LONG,MOMOES
0.25,LONG,MOMOES
0.75,LONG,MOMOES
0.0,LONG,MOMOES
0.0,LONG,MOMOES
0.25,LONG,MOMOES
1.25,LONG,MOMOES
-0.125,LONG,MOMOES
-1.0,LONG,MOMOES
-0.125,LONG,MOMOES
0.0,LONG,MOMOES
0.0,LONG,MOMOES
0.5,LONG,MOMOES
-0.125,LONG,MOMOES
-1.5,LONG,MOMOES
0.375,LONG,MOMOES
0.75,LONG,MOMOES
-2.375,LONG,MOMOES
-0.25,LONG,MOMOES
1.0,LONG,MOMOES
-1.5,LONG,MOMOES
0.125,LONG,MOMOES
1.75,LONG,MOMOES
0.0,LONG,MOMOES
0.25,LONG,MOMOES
0.875,LONG,MOMOES
-1.5,LONG,MOMOES
0.25,LONG,MOMOES
2.0,LONG,MOMOES
-2.0,LONG,MOMOES
-0.375,LONG,MOMOES
-1.75,LONG,MOMOES
-1.0,LONG,MOMOES
0.75,LONG,MOMOES
1.0,LONG,MOMOES
1.5,LONG,MOMOES
-1.5,LONG,MOMOES
-0.5,LONG,MOMOES
-0.25,LONG,MOMOES
0.25,LONG,MOMOES
-0.5,LONG,MOMOES
0.25,LONG,MOMOES
0.5,LONG,MOMOES
0.0,LONG,MOMOES
1.0,LONG,MOMOES
-1.25,LONG,MOMOES

2025-01-20 18:27:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:27:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:27:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:27:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 9
2025-01-20 18:27:41 - snowflake.connector.connection - INFO - closed
2025-01-20 18:27:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:27:41 - root - INFO - SQL:
SELECT
  p.value:"PartyID"::STRING AS "PartyID",
  AVG(t."LastPx" - t."StrikePrice") AS "AvgIntrinsicValue"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
WHERE f.value:"Side"::STRING = 'LONG'
GROUP BY p.value:"PartyID"::STRING
LIMIT 100
Results:
PartyID,AvgIntrinsicValue
LUCKYBTC,0.016179263197873148
PREDICTES,-0.0018594337724254291
LUCKYES,-0.006717415681876995
MOMOBTC,0.09964695498676081
MOMONQ,0.004894004137160459
PREDICTBTC,-0.0187683284457478
MOMOES,-0.005202354927083043
LUCKYNQ,-0.021882035708675848
PREDICTNQ,-0.40202702702702703

2025-01-20 18:27:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:27:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:27:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:27:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 9
2025-01-20 18:27:43 - snowflake.connector.connection - INFO - closed
2025-01-20 18:27:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:27:43 - root - INFO - SQL:
SELECT
  p.value:"PartyID"::STRING AS "PartyID",
  COUNT(*) AS "TradeCount"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
WHERE f.value:"Side"::STRING = 'LONG'
GROUP BY p.value:"PartyID"::STRING
LIMIT 100
Results:
PartyID,TradeCount
LUCKYBTC,65825
PREDICTES,193809
LUCKYES,69558
MOMOBTC,28325
MOMONQ,66229
PREDICTBTC,187550
MOMOES,72274
LUCKYNQ,95495
PREDICTNQ,185

2025-01-20 18:27:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:27:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:27:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:27:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 18:27:45 - snowflake.connector.connection - INFO - closed
2025-01-20 18:27:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:28:11 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:28:11 - root - INFO - ```sql
SELECT
  AVG(CASE WHEN p.value:"PartyID"::STRING LIKE 'LUCKY%' THEN t."LastPx" - t."StrikePrice" END) -
  AVG(CASE WHEN p.value:"PartyID"::STRING LIKE 'MOMO%' THEN t."LastPx" - t."StrikePrice" END) AS "Higher"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
WHERE f.value:"Side"::STRING = 'LONG';
```
2025-01-20 18:28:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:28:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:28:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:28:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 18:28:13 - snowflake.connector.connection - INFO - closed
2025-01-20 18:28:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:29:12 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:29:12 - root - INFO - SQL:
SELECT
  AVG(CASE WHEN p.value:"PartyID"::STRING LIKE 'LUCKY%' THEN t."LastPx" - t."StrikePrice" END) -
  AVG(CASE WHEN p.value:"PartyID"::STRING LIKE 'MOMO%' THEN t."LastPx" - t."StrikePrice" END) AS "Higher"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
WHERE f.value:"Side"::STRING = 'LONG';
Results:
Higher
-0.023069449773148013

2025-01-20 18:29:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:29:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:29:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:29:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 18:29:14 - snowflake.connector.connection - INFO - closed
2025-01-20 18:29:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:29:14 - root - INFO - SQL:
SELECT
  t."TradeDate",
  t."Symbol",
  t."Quantity",
  t."LastPx",
  t."StrikePrice",
  t."LastPx" - t."StrikePrice" AS "IntrinsicValue"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
WHERE f.value:"Side"::STRING = 'LONG'
  AND p.value:"PartyID"::STRING LIKE 'MOMO%'
LIMIT 100
Results:
TradeDate,Symbol,Quantity,LastPx,StrikePrice,IntrinsicValue
2020-05-18,ESM0,1,2952.375,2953.375,-1.0
2020-05-18,ESM0,1,2952.875,2952.625,0.25
2020-05-18,ESM0,1,2952.125,2953.625,-1.5
2020-05-18,ESM0,1,2953.125,2953.875,-0.75
2020-05-18,ESM0,1,2954.125,2953.625,0.5
2020-05-18,ESM0,1,2956.125,2956.125,0.0
2020-05-18,ESM0,1,2954.375,2952.125,2.25
2020-05-18,ESM0,1,2954.875,2954.625,0.25
2020-05-18,ESM0,1,2954.625,2954.875,-0.25
2020-05-18,ESM0,1,2954.875,2955.375,-0.5
2020-05-18,ESM0,1,2955.625,2955.125,0.5
2020-05-18,ESM0,1,2956.625,2956.125,0.5
2020-05-18,ESM0,1,2954.875,2954.875,0.0
2020-05-18,ESM0,1,2952.125,2951.125,1.0
2020-05-18,ESM0,1,2954.125,2955.625,-1.5
2020-05-18,ESM0,1,2959.375,2958.875,0.5
2020-05-18,ESM0,1,2960.875,2959.875,1.0
2020-05-18,ESM0,1,2948.125,2949.125,-1.0
2020-05-18,ESM0,1,2948.875,2948.875,0.0
2020-05-18,ESM0,1,2948.5,2948.5,0.0
2020-05-18,ESM0,1,2946.625,2946.625,0.0
2020-05-18,ESM0,1,2944.25,2943.875,0.375
2020-05-18,ESM0,1,2945.75,2946.0,-0.25
2020-05-18,ESM0,1,2947.625,2948.125,-0.5
2020-05-18,ESM0,1,2948.125,2948.875,-0.75
2020-05-18,ESM0,1,2948.875,2948.875,0.0
2020-05-18,ESM0,1,2949.625,2950.375,-0.75
2020-05-18,ESM0,1,2951.0,2951.375,-0.375
2020-05-18,ESM0,1,2949.625,2949.125,0.5
2020-05-18,ESM0,1,2949.125,2949.875,-0.75
2020-05-18,ESM0,1,2951.375,2950.875,0.5
2020-05-18,ESM0,1,2951.125,2951.125,0.0
2020-05-18,ESM0,1,2952.375,2952.125,0.25
2020-05-18,ESM0,1,2951.75,2950.875,0.875
2020-05-18,ESM0,1,2951.375,2950.875,0.5
2020-05-18,ESM0,1,2951.875,2951.125,0.75
2020-05-18,ESM0,1,2948.0,2948.125,-0.125
2020-05-18,ESM0,1,2948.875,2950.125,-1.25
2020-05-18,ESM0,1,2949.625,2949.625,0.0
2020-05-18,ESM0,1,2948.375,2948.375,0.0
2020-05-18,ESM0,1,2950.875,2950.875,0.0
2020-05-18,ESM0,1,2950.875,2951.625,-0.75
2020-05-19,ESM0,1,2951.875,2951.125,0.75
2020-05-19,ESM0,1,2949.875,2948.625,1.25
2020-05-19,ESM0,1,2948.875,2950.125,-1.25
2020-05-19,ESM0,1,2948.875,2948.875,0.0
2020-05-19,ESM0,1,2944.375,2941.875,2.5
2020-05-19,ESM0,1,2944.125,2944.625,-0.5
2020-05-19,ESM0,1,2943.875,2945.25,-1.375
2020-05-19,ESM0,1,2945.125,2944.875,0.25
2020-05-19,ESM0,1,2941.125,2941.375,-0.25
2020-05-19,ESM0,1,2939.875,2940.125,-0.25
2020-05-19,ESM0,1,2941.375,2941.125,0.25
2020-05-19,ESM0,1,2941.375,2942.125,-0.75
2020-05-19,ESM0,1,2942.375,2942.375,0.0
2020-05-19,ESM0,1,2942.625,2942.375,0.25
2020-05-19,ESM0,1,2941.125,2940.375,0.75
2020-05-19,ESM0,1,2937.125,2937.125,0.0
2020-05-19,ESM0,1,2936.125,2936.125,0.0
2020-05-19,ESM0,1,2937.625,2937.375,0.25
2020-05-19,ESM0,1,2937.375,2936.125,1.25
2020-05-19,ESM0,1,2938.875,2939.0,-0.125
2020-05-19,ESM0,1,2944.875,2945.875,-1.0
2020-05-19,ESM0,1,2946.125,2946.25,-0.125
2020-05-19,ESM0,1,2946.125,2946.125,0.0
2020-05-19,ESM0,1,2947.375,2947.375,0.0
2020-05-19,ESM0,1,2948.875,2948.375,0.5
2020-05-19,ESM0,1,2948.0,2948.125,-0.125
2020-05-19,ESM0,1,2950.875,2952.375,-1.5
2020-05-19,ESM0,1,2961.25,2960.875,0.375
2020-05-19,ESM0,1,2960.625,2959.875,0.75
2020-05-19,ESM0,1,2963.375,2965.75,-2.375
2020-05-19,ESM0,1,2968.875,2969.125,-0.25
2020-05-19,ESM0,1,2969.125,2968.125,1.0
2020-05-19,ESM0,1,2973.375,2974.875,-1.5
2020-05-19,ESM0,1,2955.375,2955.25,0.125
2020-05-19,ESM0,1,2957.625,2955.875,1.75
2020-05-19,ESM0,1,2955.375,2955.375,0.0
2020-05-19,ESM0,1,2943.625,2943.375,0.25
2020-05-19,ESM0,1,2943.5,2942.625,0.875
2020-05-19,ESM0,1,2938.875,2940.375,-1.5
2020-05-19,ESM0,1,2939.625,2939.375,0.25
2020-05-19,ESM0,1,2939.625,2937.625,2.0
2020-05-19,ESM0,1,2935.875,2937.875,-2.0
2020-05-19,ESM0,1,2938.25,2938.625,-0.375
2020-05-19,ESM0,1,2940.375,2942.125,-1.75
2020-05-19,ESM0,1,2931.875,2932.875,-1.0
2020-05-19,ESM0,1,2932.875,2932.125,0.75
2020-05-19,ESM0,1,2939.125,2938.125,1.0
2020-05-19,ESM0,1,2937.875,2936.375,1.5
2020-05-19,ESM0,1,2944.125,2945.625,-1.5
2020-05-19,ESM0,1,2946.125,2946.625,-0.5
2020-05-19,ESM0,1,2945.625,2945.875,-0.25
2020-05-19,ESM0,1,2945.625,2945.375,0.25
2020-05-19,ESM0,1,2945.375,2945.875,-0.5
2020-05-19,ESM0,1,2938.125,2937.875,0.25
2020-05-19,ESM0,1,2939.375,2938.875,0.5
2020-05-19,ESM0,1,2941.875,2941.875,0.0
2020-05-19,ESM0,1,2943.375,2942.375,1.0
2020-05-19,ESM0,1,2940.375,2941.625,-1.25

2025-01-20 18:29:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:29:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:29:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:29:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-20 18:29:16 - snowflake.connector.connection - INFO - closed
2025-01-20 18:29:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:29:16 - root - INFO - SQL:
SELECT
  CASE
    WHEN p.value:"PartyID"::STRING LIKE 'LUCKY%' THEN 'feeling-lucky'
    WHEN p.value:"PartyID"::STRING LIKE 'MOMO%' THEN 'momentum'
    WHEN p.value:"PartyID"::STRING LIKE 'PREDICT%' THEN 'predictive'
    ELSE 'other'
  END AS "Strategy",
  AVG(t."LastPx" - t."StrikePrice") AS "AvgIntrinsicValue",
  COUNT(*) AS "NumberOfTrades"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
WHERE f.value:"Side"::STRING = 'LONG'
GROUP BY "Strategy"
LIMIT 100
Results:
Strategy,AvgIntrinsicValue,NumberOfTrades
momentum,0.016607703742776994,166828
feeling-lucky,-0.006461746030371018,230878
predictive,-0.010365121715975091,381544

2025-01-20 18:29:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:29:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:29:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:29:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-20 18:29:18 - snowflake.connector.connection - INFO - closed
2025-01-20 18:29:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:29:18 - root - INFO - SQL:
SELECT
  t."Symbol",
  COUNT(*) AS "TradeCount"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
WHERE f.value:"Side"::STRING = 'LONG'
  AND p.value:"PartyID"::STRING LIKE 'LUCKY%'
GROUP BY t."Symbol"
ORDER BY "TradeCount" DESC
LIMIT 5
Results:
Symbol,TradeCount
NQU0,42517
NQZ0,36056
ESZ0,30939
ESU0,28847
NQM0,16922

2025-01-20 18:29:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:29:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:29:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:29:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 18:29:20 - snowflake.connector.connection - INFO - closed
2025-01-20 18:29:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:29:20 - root - INFO - SQL:
SELECT
  t."TradeDate",
  t."Symbol",
  t."Quantity",
  t."LastPx",
  t."StrikePrice",
  t."LastPx" - t."StrikePrice" AS "IntrinsicValue",
  p.value:"PartyID"::STRING AS "PartyID"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
WHERE f.value:"Side"::STRING = 'LONG'
LIMIT 100
Results:
TradeDate,Symbol,Quantity,LastPx,StrikePrice,IntrinsicValue,PartyID
2020-05-18,ESM0,1,2952.375,2953.375,-1.0,MOMOES
2020-05-18,ESM0,1,2952.875,2952.625,0.25,MOMOES
2020-05-18,ESM0,1,2952.125,2953.625,-1.5,MOMOES
2020-05-18,ESM0,1,2953.125,2953.875,-0.75,MOMOES
2020-05-18,ESM0,1,2954.125,2953.625,0.5,MOMOES
2020-05-18,ESM0,1,2956.125,2956.125,0.0,MOMOES
2020-05-18,ESM0,1,2954.375,2952.125,2.25,MOMOES
2020-05-18,ESM0,1,2954.875,2954.625,0.25,MOMOES
2020-05-18,ESM0,1,2954.625,2954.875,-0.25,MOMOES
2020-05-18,ESM0,1,2954.875,2955.375,-0.5,MOMOES
2020-05-18,ESM0,1,2955.625,2955.125,0.5,MOMOES
2020-05-18,ESM0,1,2956.625,2956.125,0.5,MOMOES
2020-05-18,ESM0,1,2954.875,2954.875,0.0,MOMOES
2020-05-18,ESM0,1,2952.125,2951.125,1.0,MOMOES
2020-05-18,ESM0,1,2954.125,2955.625,-1.5,MOMOES
2020-05-18,ESM0,1,2959.375,2958.875,0.5,MOMOES
2020-05-18,ESM0,1,2960.875,2959.875,1.0,MOMOES
2020-05-18,ESM0,1,2948.125,2949.125,-1.0,MOMOES
2020-05-18,ESM0,1,2948.875,2948.875,0.0,MOMOES
2020-05-18,ESM0,1,2948.5,2948.5,0.0,MOMOES
2020-05-18,ESM0,1,2946.625,2946.625,0.0,MOMOES
2020-05-18,ESM0,1,2944.25,2943.875,0.375,MOMOES
2020-05-18,ESM0,1,2945.75,2946.0,-0.25,MOMOES
2020-05-18,ESM0,1,2947.625,2948.125,-0.5,MOMOES
2020-05-18,ESM0,1,2948.125,2948.875,-0.75,MOMOES
2020-05-18,ESM0,1,2948.875,2948.875,0.0,MOMOES
2020-05-18,ESM0,1,2949.625,2950.375,-0.75,MOMOES
2020-05-18,ESM0,1,2951.0,2951.375,-0.375,MOMOES
2020-05-18,ESM0,1,2949.625,2949.125,0.5,MOMOES
2020-05-18,ESM0,1,2949.125,2949.875,-0.75,MOMOES
2020-05-18,ESM0,1,2951.375,2950.875,0.5,MOMOES
2020-05-18,ESM0,1,2951.125,2951.125,0.0,MOMOES
2020-05-18,ESM0,1,2952.375,2952.125,0.25,MOMOES
2020-05-18,ESM0,1,2951.75,2950.875,0.875,MOMOES
2020-05-18,ESM0,1,2951.375,2950.875,0.5,MOMOES
2020-05-18,ESM0,1,2951.875,2951.125,0.75,MOMOES
2020-05-18,ESM0,1,2948.0,2948.125,-0.125,MOMOES
2020-05-18,ESM0,1,2948.875,2950.125,-1.25,MOMOES
2020-05-18,ESM0,1,2949.625,2949.625,0.0,MOMOES
2020-05-18,ESM0,1,2948.375,2948.375,0.0,MOMOES
2020-05-18,ESM0,1,2950.875,2950.875,0.0,MOMOES
2020-05-18,ESM0,1,2950.875,2951.625,-0.75,MOMOES
2020-05-19,ESM0,1,2951.875,2951.125,0.75,MOMOES
2020-05-19,ESM0,1,2949.875,2948.625,1.25,MOMOES
2020-05-19,ESM0,1,2948.875,2950.125,-1.25,MOMOES
2020-05-19,ESM0,1,2948.875,2948.875,0.0,MOMOES
2020-05-19,ESM0,1,2944.375,2941.875,2.5,MOMOES
2020-05-19,ESM0,1,2944.125,2944.625,-0.5,MOMOES
2020-05-19,ESM0,1,2943.875,2945.25,-1.375,MOMOES
2020-05-19,ESM0,1,2945.125,2944.875,0.25,MOMOES
2020-05-19,ESM0,1,2941.125,2941.375,-0.25,MOMOES
2020-05-19,ESM0,1,2939.875,2940.125,-0.25,MOMOES
2020-05-19,ESM0,1,2941.375,2941.125,0.25,MOMOES
2020-05-19,ESM0,1,2941.375,2942.125,-0.75,MOMOES
2020-05-19,ESM0,1,2942.375,2942.375,0.0,MOMOES
2020-05-19,ESM0,1,2942.625,2942.375,0.25,MOMOES
2020-05-19,ESM0,1,2941.125,2940.375,0.75,MOMOES
2020-05-19,ESM0,1,2937.125,2937.125,0.0,MOMOES
2020-05-19,ESM0,1,2936.125,2936.125,0.0,MOMOES
2020-05-19,ESM0,1,2937.625,2937.375,0.25,MOMOES
2020-05-19,ESM0,1,2937.375,2936.125,1.25,MOMOES
2020-05-19,ESM0,1,2938.875,2939.0,-0.125,MOMOES
2020-05-19,ESM0,1,2944.875,2945.875,-1.0,MOMOES
2020-05-19,ESM0,1,2946.125,2946.25,-0.125,MOMOES
2020-05-19,ESM0,1,2946.125,2946.125,0.0,MOMOES
2020-05-19,ESM0,1,2947.375,2947.375,0.0,MOMOES
2020-05-19,ESM0,1,2948.875,2948.375,0.5,MOMOES
2020-05-19,ESM0,1,2948.0,2948.125,-0.125,MOMOES
2020-05-19,ESM0,1,2950.875,2952.375,-1.5,MOMOES
2020-05-19,ESM0,1,2961.25,2960.875,0.375,MOMOES
2020-05-19,ESM0,1,2960.625,2959.875,0.75,MOMOES
2020-05-19,ESM0,1,2963.375,2965.75,-2.375,MOMOES
2020-05-19,ESM0,1,2968.875,2969.125,-0.25,MOMOES
2020-05-19,ESM0,1,2969.125,2968.125,1.0,MOMOES
2020-05-19,ESM0,1,2973.375,2974.875,-1.5,MOMOES
2020-05-19,ESM0,1,2955.375,2955.25,0.125,MOMOES
2020-05-19,ESM0,1,2957.625,2955.875,1.75,MOMOES
2020-05-19,ESM0,1,2955.375,2955.375,0.0,MOMOES
2020-05-19,ESM0,1,2943.625,2943.375,0.25,MOMOES
2020-05-19,ESM0,1,2943.5,2942.625,0.875,MOMOES
2020-05-19,ESM0,1,2938.875,2940.375,-1.5,MOMOES
2020-05-19,ESM0,1,2939.625,2939.375,0.25,MOMOES
2020-05-19,ESM0,1,2939.625,2937.625,2.0,MOMOES
2020-05-19,ESM0,1,2935.875,2937.875,-2.0,MOMOES
2020-05-19,ESM0,1,2938.25,2938.625,-0.375,MOMOES
2020-05-19,ESM0,1,2940.375,2942.125,-1.75,MOMOES
2020-05-19,ESM0,1,2931.875,2932.875,-1.0,MOMOES
2020-05-19,ESM0,1,2932.875,2932.125,0.75,MOMOES
2020-05-19,ESM0,1,2939.125,2938.125,1.0,MOMOES
2020-05-19,ESM0,1,2937.875,2936.375,1.5,MOMOES
2020-05-19,ESM0,1,2944.125,2945.625,-1.5,MOMOES
2020-05-19,ESM0,1,2946.125,2946.625,-0.5,MOMOES
2020-05-19,ESM0,1,2945.625,2945.875,-0.25,MOMOES
2020-05-19,ESM0,1,2945.625,2945.375,0.25,MOMOES
2020-05-19,ESM0,1,2945.375,2945.875,-0.5,MOMOES
2020-05-19,ESM0,1,2938.125,2937.875,0.25,MOMOES
2020-05-19,ESM0,1,2939.375,2938.875,0.5,MOMOES
2020-05-19,ESM0,1,2941.875,2941.875,0.0,MOMOES
2020-05-19,ESM0,1,2943.375,2942.375,1.0,MOMOES
2020-05-19,ESM0,1,2940.375,2941.625,-1.25,MOMOES

2025-01-20 18:29:20 - root - INFO - itercount: 0
2025-01-20 18:29:20 - root - INFO - Database Name: CYMBAL_INVESTMENTS
Schema Name: CYMBAL_INVESTMENTS
DDL describes table information.
,0
table_name,TRADE_CAPTURE_REPORT
description,
DDL,"create or replace TABLE TRADE_CAPTURE_REPORT (
	""SendingTime"" NUMBER(38,0),
	""TargetCompID"" VARCHAR(16777216),
	""SenderCompID"" VARCHAR(16777216),
	""Symbol"" VARCHAR(16777216),
	""Quantity"" NUMBER(38,0),
	""OrderID"" VARCHAR(16777216),
	""TransactTime"" NUMBER(38,0),
	""StrikePrice"" FLOAT,
	""LastPx"" FLOAT,
	""MaturityDate"" NUMBER(38,0),
	""TradeReportID"" VARCHAR(16777216),
	""TradeDate"" DATE,
	""CFICode"" VARCHAR(16777216),
	""Sides"" VARIANT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'CYMBAL_INVESTMENTS': {'CYMBAL_INVESTMENTS': ['TRADE_CAPTURE_REPORT']}}
Begin Exploring Related Columns
**Columns and their potential usage:**

- `"StrikePrice"`: May be used to calculate the intrinsic value of options traded.
- `"LastPx"`: Represents the last execution price; can be used along with `"StrikePrice"` to compute intrinsic value.
- `"Sides"`: VARIANT column that likely contains nested data including `"Side"` (e.g., "Long", "Short") and `"Strategy"` (e.g., "feeling-lucky", "momentum").
- `"Quantity"`: The number of units traded; may be relevant for weighting averages.
- `"TradeDate"`: Date of the trade; could be used for time-based filtering.

**Conditions that may be used:**

- Trades where the `"Strategy"` is "feeling-lucky".
- Trades where the `"Strategy"` is "momentum".
- Trades where the `"Side"` is "Long" (long-side trades).
- Calculating the intrinsic value as the difference between `"LastPx"` and `"StrikePrice"`.

---

**SQL Queries:**

1. **View the `Sides` column to understand its structure:**
   ```sql
   SELECT t."Sides"
   FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t
   LIMIT 100;
   ```

2. **Flatten the `Sides` column to inspect individual elements:**
   ```sql
   SELECT f.value
   FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
   LATERAL FLATTEN(input => t."Sides") f
   LIMIT 100;
   ```

3. **Extract `Side` and `Strategy` from the `Sides` column:**
   ```sql
   SELECT
     f.value:"Side"::STRING AS "Side",
     f.value:"Strategy"::STRING AS "Strategy"
   FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
   LATERAL FLATTEN(input => t."Sides") f
   LIMIT 100;
   ```

4. **List distinct strategies used in trades:**
   ```sql
   SELECT DISTINCT f.value:"Strategy"::STRING AS "Strategy"
   FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
   LATERAL FLATTEN(input => t."Sides") f
   LIMIT 100;
   ```

5. **List distinct sides (e.g., Long, Short) in trades:**
   ```sql
   SELECT DISTINCT f.value:"Side"::STRING AS "Side"
   FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
   LATERAL FLATTEN(input => t."Sides") f
   LIMIT 100;
   ```

6. **Retrieve `StrikePrice`, `LastPx`, `Side`, and `Strategy` for each trade:**
   ```sql
   SELECT
     t."StrikePrice",
     t."LastPx",
     f.value:"Side"::STRING AS "Side",
     f.value:"Strategy"::STRING AS "Strategy"
   FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
   LATERAL FLATTEN(input => t."Sides") f
   LIMIT 100;
   ```

7. **Calculate the intrinsic value for each trade:**
   ```sql
   SELECT
     t."LastPx" - t."StrikePrice" AS "IntrinsicValue",
     f.value:"Side"::STRING AS "Side",
     f.value:"Strategy"::STRING AS "Strategy"
   FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
   LATERAL FLATTEN(input => t."Sides") f
   LIMIT 100;
   ```

8. **Filter trades where the side is 'Long':**
   ```sql
   SELECT
     t."LastPx" - t."StrikePrice" AS "IntrinsicValue",
     f.value:"Side"::STRING AS "Side",
     f.value:"Strategy"::STRING AS "Strategy"
   FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
   LATERAL FLATTEN(input => t."Sides") f
   WHERE f.value:"Side"::STRING ILIKE '%Long%'
   LIMIT 100;
   ```

9. **Compute average intrinsic value per strategy for long-side trades:**
   ```sql
   SELECT
     f.value:"Strategy"::STRING AS "Strategy",
     AVG(t."LastPx" - t."StrikePrice") AS "AvgIntrinsicValue"
   FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
   LATERAL FLATTEN(input => t."Sides") f
   WHERE f.value:"Side"::STRING ILIKE '%Long%'
   GROUP BY f.value:"Strategy"::STRING
   LIMIT 100;
   ```

10. **Count the number of trades per strategy under long-side trades:**
    ```sql
    SELECT
      f.value:"Strategy"::STRING AS "Strategy",
      COUNT(*) AS "TradeCount"
    FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
    LATERAL FLATTEN(input => t."Sides") f
    WHERE f.value:"Side"::STRING ILIKE '%Long%'
    GROUP BY f.value:"Strategy"::STRING
    LIMIT 100;
    ```

11. **List all trades with 'feeling-lucky' strategy on the long side:**
    ```sql
    SELECT
      t."TradeDate",
      t."Symbol",
      t."Quantity",
      t."LastPx",
      t."StrikePrice",
      t."LastPx" - t."StrikePrice" AS "IntrinsicValue"
    FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
    LATERAL FLATTEN(input => t."Sides") f
    WHERE f.value:"Side"::STRING ILIKE '%Long%'
      AND f.value:"Strategy"::STRING = 'feeling-lucky'
    LIMIT 100;
    ```

12. **List all trades with 'momentum' strategy on the long side:**
    ```sql
    SELECT
      t."TradeDate",
      t."Symbol",
      t."Quantity",
      t."LastPx",
      t."StrikePrice",
      t."LastPx" - t."StrikePrice" AS "IntrinsicValue"
    FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
    LATERAL FLATTEN(input => t."Sides") f
    WHERE f.value:"Side"::STRING ILIKE '%Long%'
      AND f.value:"Strategy"::STRING = 'momentum'
    LIMIT 100;
    ```

13. **Compare average intrinsic values between strategies on the long side:**
    ```sql
    SELECT
      f.value:"Strategy"::STRING AS "Strategy",
      AVG(t."LastPx" - t."StrikePrice") AS "AvgIntrinsicValue",
      COUNT(*) AS "NumberOfTrades"
    FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
    LATERAL FLATTEN(input => t."Sides") f
    WHERE f.value:"Side"::STRING ILIKE '%Long%'
    GROUP BY f.value:"Strategy"::STRING
    LIMIT 100;
    ```

14. **Find the top 5 symbols traded under the 'feeling-lucky' strategy on the long side:**
    ```sql
    SELECT
      t."Symbol",
      COUNT(*) AS "TradeCount"
    FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
    LATERAL FLATTEN(input => t."Sides") f
    WHERE f.value:"Side"::STRING ILIKE '%Long%'
      AND f.value:"Strategy"::STRING = 'feeling-lucky'
    GROUP BY t."Symbol"
    ORDER BY "TradeCount" DESC
    LIMIT 5;
    ```

15. **Identify trades where intrinsic value is negative (potential losses) on the long side:**
    ```sql
    SELECT
      t."TradeDate",
      t."Symbol",
      t."Quantity",
      t."LastPx",
      t."StrikePrice",
      t."LastPx" - t."StrikePrice" AS "IntrinsicValue",
      f.value:"Strategy"::STRING AS "Strategy"
    FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
    LATERAL FLATTEN(input => t."Sides") f
    WHERE f.value:"Side"::STRING ILIKE '%Long%'
      AND (t."LastPx" - t."StrikePrice") < 0
    LIMIT 100;
    ```

*Note:* These queries are designed to explore the relevant data and understand how to compute the required metrics for the task. They handle the `VARIANT` type column `"Sides"` by using `LATERAL FLATTEN` to access nested fields such as `"Side"` and `"Strategy"`. All column names are enclosed in double quotations as per the instructions.Query:
SELECT t."Sides"
   FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t
   LIMIT 100;
Answer:
Too long, hard cut:
Sides
"[
  {
    ""OrderID"": ""d8eefa63-6f10-4566-8f15-81460448f2ac"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""7fa78bef-912c-41cb-b381-4c03b5a7c508"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""5a4c4d8b-b9b8-4307-a0c3-8c753ed93520"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""a204ef77-1071-48ee-a5f5-21579311cd91"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""b7a40778-7293-407b-8636-91a7ffe9817a"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""c67a3f6a-7253-4ec8-91be-a4a3f07aa27b"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""83e09901-1182-4ad0-b423-0f92bf78a7a2"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""8161e8ff-9aa3-4e27-9322-363a4a063a27"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""2e2c0922-e696-44f6-899e-9112f6129088"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""8afcaa49-daca-470f-9479-6bfd2c648ccf"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""4e25aae7-5b30-408a-a23e-ea3afb86c445"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""048dab46-3718-4dd2-b12e-709ce317c069"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""0e00e452-329b-44df-90a5-902b7e737608"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""ae17c30f-0689-4013-8485-05f5eb5f7721"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""3a9010bf-80a3-46aa-ae04-afd4b1f39e1a"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""5880746a-b864-46b5-8204-060bbe7104a4"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""68bf4c18-8084-435b-8786-2ae9b104339e"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""0fe87fac-d58a-4bb9-8552-c1e58d91bb82"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""94641ac8-057f-4f66-ba2f-81edc252bbcf"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""dd4279ad-7a00-4c6f-b26f-0f98aff69aed"",
    ""P
Query:
SELECT f.value
   FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
   LATERAL FLATTEN(input => t."Sides") f
   LIMIT 100;
Answer:
Too long, hard cut:
VALUE
"{
  ""OrderID"": ""d8eefa63-6f10-4566-8f15-81460448f2ac"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""7fa78bef-912c-41cb-b381-4c03b5a7c508"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""5a4c4d8b-b9b8-4307-a0c3-8c753ed93520"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""a204ef77-1071-48ee-a5f5-21579311cd91"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""b7a40778-7293-407b-8636-91a7ffe9817a"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""c67a3f6a-7253-4ec8-91be-a4a3f07aa27b"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""83e09901-1182-4ad0-b423-0f92bf78a7a2"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""8161e8ff-9aa3-4e27-9322-363a4a063a27"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""2e2c0922-e696-44f6-899e-9112f6129088"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""8afcaa49-daca-470f-9479-6bfd2c648ccf"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""4e25aae7-5b30-408a-a23e-ea3afb86c445"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""048dab46-3718-4dd2-b12e-709ce317c069"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""0e00e452-329b-44df-90a5-902b7e737608"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""ae17c30f-0689-4013-8485-05f5eb5f7721"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""3a9010bf-80a3-46aa-ae04-afd4b1f39e1a"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""5880746a-b864-46b5-8204-060bbe7104a4"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""68bf4c18-8084-435b-8786-2ae9b104339e"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""0fe87fac-d58a-4bb9-8552-c1e58d91bb82"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""94641ac8-057f-4f66-ba2f-81edc252bbcf"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""dd4279ad-7a00-4c6f-b26f-0f98aff69aed"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""1f0ab9f6-7171-4b0c-a2bd-b61787f165b1"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
"{
  ""OrderID"": ""416c6876-0548-4ea1-b8a6-6b19faca54fc"",
  ""PartyIDs"": [
    {
      ""PartyID""
Query:
SELECT
  AVG(t."LastPx" - t."StrikePrice") AS "AvgIntrinsicValue"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
LATERAL FLATTEN(input => t."Sides") f
WHERE f.value:"Side"::STRING = 'LONG';
Answer:
AvgIntrinsicValue
-0.0034340648059031117
Query:
SELECT DISTINCT p.value:"PartyID"::STRING AS "PartyID"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
LIMIT 100
Answer:
PartyID
LUCKYBTC
PREDICTES
LUCKYES
MOMOBTC
MOMONQ
PREDICTBTC
PREDICTNQ
MOMOES
LUCKYNQ
Query:
SELECT DISTINCT f.value:"Side"::STRING AS "Side"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f
LIMIT 100
Answer:
Side
SHORT
LONG
Query:
SELECT
  t."StrikePrice",
  t."LastPx",
  f.value:"Side"::STRING AS "Side",
  p.value:"PartyID"::STRING AS "PartyID"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
LIMIT 100
Answer:
StrikePrice,LastPx,Side,PartyID
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.0,11502.0,SHORT,PREDICTNQ
11502.125,11502.75,SHORT,PREDICTNQ
11532.75,11525.0,SHORT,PREDICTNQ
11529.375,11531.375,SHORT,PREDICTNQ
11527.875,11528.625,SHORT,PREDICTNQ
11528.75,11528.25,SHORT,PREDICTNQ
11532.75,11529.0,SHORT,PREDICTNQ
11573.5,11570.375,SHORT,PREDICTNQ
11569.125,11565.875,SHORT,PREDICTNQ
11582.75,11580.5,SHORT,PREDICTNQ
11579.875,11580.75,SHORT,PREDICTNQ
11579.0,11571.375,SHORT,PREDICTNQ
11559.625,11564.625,SHORT,PREDICTNQ
11555.75,11558.125,SHORT,PREDICTNQ
11554.875,11552.75,SHORT,PREDICTNQ
11553.625,11551.625,SHORT,PREDICTNQ
11564.625,11554.0,SHORT,PREDICTNQ
11558.25,11554.375,SHORT,PREDICTNQ
11550.75,11552.75,SHORT,PREDICTNQ
11548.125,11544.625,SHORT,PREDICTNQ
11537.125,11536.5,SHORT,PREDICTNQ
11536.875,11536.25,SHORT,PREDICTNQ
11536.75,11537.375,SHORT,PREDICTNQ
11541.0,11543.375,SHORT,PREDICTNQ
11539.375,11540.75,SHORT,PREDICTNQ
11538.875,11536.5,SHORT,PREDICTNQ
11526.875,11526.75,SHORT,PREDICTNQ
11526.75,11530.125,SHORT,PREDICTNQ
11533.625,11541.0,SHORT,PREDICTNQ
11527.375,11528.125,SHORT,PREDICTNQ
11535.0,11528.875,SHORT,PREDICTNQ
11537.5,11541.75,SHORT,PREDICTNQ
11533.625,11535.5,SHORT,PREDICTNQ
11535.875,11533.125,SHORT,PREDICTNQ
11533.5,11533.375,SHORT,PREDICTNQ
11543.25,11537.625,SHORT,PREDICTNQ
11559.875,11563.0,SHORT,PREDICTNQ
11563.625,11564.0,SHORT,PREDICTNQ
11556.375,11555.125,SHORT,PREDICTNQ
11553.375,11558.875,SHORT,PREDICTNQ
11525.625,11528.875,SHORT,PREDICTNQ
11525.875,11528.875,SHORT,PREDICTNQ
11479.625,11495.25,SHORT,PREDICTNQ
11487.5,11490.0,SHORT,PREDICTNQ
11486.375,11491.625,SHORT,PREDICTNQ
11488.375,11484.125,SHORT,PREDICTNQ
11483.25,11486.75,SHORT,PREDICTNQ
11482.75,11486.375,SHORT,PREDICTNQ
11490.375,11490.5,SHORT,PREDICTNQ
11479.125,11485.875,SHORT,PREDICTNQ
11495.875,11496.0,SHORT,PREDICTNQ
11489.75,11495.25,SHORT,PREDICTNQ
11491.625,11490.0,SHORT,PREDICTNQ
11491.375,11490.625,SHORT,PREDICTNQ
11494.125,11490.875,SHORT,PREDICTNQ
11498.625,11500.125,SHORT,PREDICTNQ
11499.25,11499.125,SHORT,PREDICTNQ
11498.125,11501.0,SHORT,PREDICTNQ
11493.75,11494.625,SHORT,PREDICTNQ
11506.75,11500.875,SHORT,PREDICTNQ
11502.0,11505.75,SHORT,PREDICTNQ
11494.875,11493.5,SHORT,PREDICTNQ
11499.75,11500.75,SHORT,PREDICTNQ
11508.5,11500.625,SHORT,PREDICTNQ
11504.125,11504.625,SHORT,PREDICTNQ
11517.25,11512.25,SHORT,PREDICTNQ
11524.5,11527.625,SHORT,PREDICTNQ
11518.5,11518.75,SHORT,PREDICTNQ
11546.125,11545.625,SHORT,PREDICTNQ
11558.125,11562.875,SHORT,PREDICTNQ
11553.5,11549.875,SHORT,PREDICTNQ
11549.75,11550.75,SHORT,PREDICTNQ
11551.0,11550.375,SHORT,PREDICTNQ
11551.125,11546.625,SHORT,PREDICTNQ
11548.75,11550.25,SHORT,PREDICTNQ
11557.875,11557.25,SHORT,PREDICTNQ
11557.0,11559.5,SHORT,PREDICTNQ
11555.625,11555.375,SHORT,PREDICTNQ
11550.25,11550.625,SHORT,PREDICTNQ
Query:
SELECT
  t."LastPx" - t."StrikePrice" AS "IntrinsicValue",
  f.value:"Side"::STRING AS "Side",
  p.value:"PartyID"::STRING AS "PartyID"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
LIMIT 100
Answer:
IntrinsicValue,Side,PartyID
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.0,SHORT,PREDICTNQ
0.625,SHORT,PREDICTNQ
-7.75,SHORT,PREDICTNQ
2.0,SHORT,PREDICTNQ
0.75,SHORT,PREDICTNQ
-0.5,SHORT,PREDICTNQ
-3.75,SHORT,PREDICTNQ
-3.125,SHORT,PREDICTNQ
-3.25,SHORT,PREDICTNQ
-2.25,SHORT,PREDICTNQ
0.875,SHORT,PREDICTNQ
-7.625,SHORT,PREDICTNQ
5.0,SHORT,PREDICTNQ
2.375,SHORT,PREDICTNQ
-2.125,SHORT,PREDICTNQ
-2.0,SHORT,PREDICTNQ
-10.625,SHORT,PREDICTNQ
-3.875,SHORT,PREDICTNQ
2.0,SHORT,PREDICTNQ
-3.5,SHORT,PREDICTNQ
-0.625,SHORT,PREDICTNQ
-0.625,SHORT,PREDICTNQ
0.625,SHORT,PREDICTNQ
2.375,SHORT,PREDICTNQ
1.375,SHORT,PREDICTNQ
-2.375,SHORT,PREDICTNQ
-0.125,SHORT,PREDICTNQ
3.375,SHORT,PREDICTNQ
7.375,SHORT,PREDICTNQ
0.75,SHORT,PREDICTNQ
-6.125,SHORT,PREDICTNQ
4.25,SHORT,PREDICTNQ
1.875,SHORT,PREDICTNQ
-2.75,SHORT,PREDICTNQ
-0.125,SHORT,PREDICTNQ
-5.625,SHORT,PREDICTNQ
3.125,SHORT,PREDICTNQ
0.375,SHORT,PREDICTNQ
-1.25,SHORT,PREDICTNQ
5.5,SHORT,PREDICTNQ
3.25,SHORT,PREDICTNQ
3.0,SHORT,PREDICTNQ
15.625,SHORT,PREDICTNQ
2.5,SHORT,PREDICTNQ
5.25,SHORT,PREDICTNQ
-4.25,SHORT,PREDICTNQ
3.5,SHORT,PREDICTNQ
3.625,SHORT,PREDICTNQ
0.125,SHORT,PREDICTNQ
6.75,SHORT,PREDICTNQ
0.125,SHORT,PREDICTNQ
5.5,SHORT,PREDICTNQ
-1.625,SHORT,PREDICTNQ
-0.75,SHORT,PREDICTNQ
-3.25,SHORT,PREDICTNQ
1.5,SHORT,PREDICTNQ
-0.125,SHORT,PREDICTNQ
2.875,SHORT,PREDICTNQ
0.875,SHORT,PREDICTNQ
-5.875,SHORT,PREDICTNQ
3.75,SHORT,PREDICTNQ
-1.375,SHORT,PREDICTNQ
1.0,SHORT,PREDICTNQ
-7.875,SHORT,PREDICTNQ
0.5,SHORT,PREDICTNQ
-5.0,SHORT,PREDICTNQ
3.125,SHORT,PREDICTNQ
0.25,SHORT,PREDICTNQ
-0.5,SHORT,PREDICTNQ
4.75,SHORT,PREDICTNQ
-3.625,SHORT,PREDICTNQ
1.0,SHORT,PREDICTNQ
-0.625,SHORT,PREDICTNQ
-4.5,SHORT,PREDICTNQ
1.5,SHORT,PREDICTNQ
-0.625,SHORT,PREDICTNQ
2.5,SHORT,PREDICTNQ
-0.25,SHORT,PREDICTNQ
0.375,SHORT,PREDICTNQ
Query:
SELECT
  t."LastPx" - t."StrikePrice" AS "IntrinsicValue",
  f.value:"Side"::STRING AS "Side",
  p.value:"PartyID"::STRING AS "PartyID"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
WHERE f.value:"Side"::STRING = 'LONG'
LIMIT 100
Answer:
IntrinsicValue,Side,PartyID
-1.0,LONG,MOMOES
0.25,LONG,MOMOES
-1.5,LONG,MOMOES
-0.75,LONG,MOMOES
0.5,LONG,MOMOES
0.0,LONG,MOMOES
2.25,LONG,MOMOES
0.25,LONG,MOMOES
-0.25,LONG,MOMOES
-0.5,LONG,MOMOES
0.5,LONG,MOMOES
0.5,LONG,MOMOES
0.0,LONG,MOMOES
1.0,LONG,MOMOES
-1.5,LONG,MOMOES
0.5,LONG,MOMOES
1.0,LONG,MOMOES
-1.0,LONG,MOMOES
0.0,LONG,MOMOES
0.0,LONG,MOMOES
0.0,LONG,MOMOES
0.375,LONG,MOMOES
-0.25,LONG,MOMOES
-0.5,LONG,MOMOES
-0.75,LONG,MOMOES
0.0,LONG,MOMOES
-0.75,LONG,MOMOES
-0.375,LONG,MOMOES
0.5,LONG,MOMOES
-0.75,LONG,MOMOES
0.5,LONG,MOMOES
0.0,LONG,MOMOES
0.25,LONG,MOMOES
0.875,LONG,MOMOES
0.5,LONG,MOMOES
0.75,LONG,MOMOES
-0.125,LONG,MOMOES
-1.25,LONG,MOMOES
0.0,LONG,MOMOES
0.0,LONG,MOMOES
0.0,LONG,MOMOES
-0.75,LONG,MOMOES
0.75,LONG,MOMOES
1.25,LONG,MOMOES
-1.25,LONG,MOMOES
0.0,LONG,MOMOES
2.5,LONG,MOMOES
-0.5,LONG,MOMOES
-1.375,LONG,MOMOES
0.25,LONG,MOMOES
-0.25,LONG,MOMOES
-0.25,LONG,MOMOES
0.25,LONG,MOMOES
-0.75,LONG,MOMOES
0.0,LONG,MOMOES
0.25,LONG,MOMOES
0.75,LONG,MOMOES
0.0,LONG,MOMOES
0.0,LONG,MOMOES
0.25,LONG,MOMOES
1.25,LONG,MOMOES
-0.125,LONG,MOMOES
-1.0,LONG,MOMOES
-0.125,LONG,MOMOES
0.0,LONG,MOMOES
0.0,LONG,MOMOES
0.5,LONG,MOMOES
-0.125,LONG,MOMOES
-1.5,LONG,MOMOES
0.375,LONG,MOMOES
0.75,LONG,MOMOES
-2.375,LONG,MOMOES
-0.25,LONG,MOMOES
1.0,LONG,MOMOES
-1.5,LONG,MOMOES
0.125,LONG,MOMOES
1.75,LONG,MOMOES
0.0,LONG,MOMOES
0.25,LONG,MOMOES
0.875,LONG,MOMOES
-1.5,LONG,MOMOES
0.25,LONG,MOMOES
2.0,LONG,MOMOES
-2.0,LONG,MOMOES
-0.375,LONG,MOMOES
-1.75,LONG,MOMOES
-1.0,LONG,MOMOES
0.75,LONG,MOMOES
1.0,LONG,MOMOES
1.5,LONG,MOMOES
-1.5,LONG,MOMOES
-0.5,LONG,MOMOES
-0.25,LONG,MOMOES
0.25,LONG,MOMOES
-0.5,LONG,MOMOES
0.25,LONG,MOMOES
0.5,LONG,MOMOES
0.0,LONG,MOMOES
1.0,LONG,MOMOES
-1.25,LONG,MOMOES
Query:
SELECT
  p.value:"PartyID"::STRING AS "PartyID",
  AVG(t."LastPx" - t."StrikePrice") AS "AvgIntrinsicValue"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
WHERE f.value:"Side"::STRING = 'LONG'
GROUP BY p.value:"PartyID"::STRING
LIMIT 100
Answer:
PartyID,AvgIntrinsicValue
LUCKYBTC,0.016179263197873148
PREDICTES,-0.0018594337724254291
LUCKYES,-0.006717415681876995
MOMOBTC,0.09964695498676081
MOMONQ,0.004894004137160459
PREDICTBTC,-0.0187683284457478
MOMOES,-0.005202354927083043
LUCKYNQ,-0.021882035708675848
PREDICTNQ,-0.40202702702702703
Query:
SELECT
  p.value:"PartyID"::STRING AS "PartyID",
  COUNT(*) AS "TradeCount"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
WHERE f.value:"Side"::STRING = 'LONG'
GROUP BY p.value:"PartyID"::STRING
LIMIT 100
Answer:
PartyID,TradeCount
LUCKYBTC,65825
PREDICTES,193809
LUCKYES,69558
MOMOBTC,28325
MOMONQ,66229
PREDICTBTC,187550
MOMOES,72274
LUCKYNQ,95495
PREDICTNQ,185
Query:
SELECT
  AVG(CASE WHEN p.value:"PartyID"::STRING LIKE 'LUCKY%' THEN t."LastPx" - t."StrikePrice" END) -
  AVG(CASE WHEN p.value:"PartyID"::STRING LIKE 'MOMO%' THEN t."LastPx" - t."StrikePrice" END) AS "Higher"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
WHERE f.value:"Side"::STRING = 'LONG';
Answer:
Higher
-0.023069449773148013
Query:
SELECT
  t."TradeDate",
  t."Symbol",
  t."Quantity",
  t."LastPx",
  t."StrikePrice",
  t."LastPx" - t."StrikePrice" AS "IntrinsicValue"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
WHERE f.value:"Side"::STRING = 'LONG'
  AND p.value:"PartyID"::STRING LIKE 'MOMO%'
LIMIT 100
Answer:
TradeDate,Symbol,Quantity,LastPx,StrikePrice,IntrinsicValue
2020-05-18,ESM0,1,2952.375,2953.375,-1.0
2020-05-18,ESM0,1,2952.875,2952.625,0.25
2020-05-18,ESM0,1,2952.125,2953.625,-1.5
2020-05-18,ESM0,1,2953.125,2953.875,-0.75
2020-05-18,ESM0,1,2954.125,2953.625,0.5
2020-05-18,ESM0,1,2956.125,2956.125,0.0
2020-05-18,ESM0,1,2954.375,2952.125,2.25
2020-05-18,ESM0,1,2954.875,2954.625,0.25
2020-05-18,ESM0,1,2954.625,2954.875,-0.25
2020-05-18,ESM0,1,2954.875,2955.375,-0.5
2020-05-18,ESM0,1,2955.625,2955.125,0.5
2020-05-18,ESM0,1,2956.625,2956.125,0.5
2020-05-18,ESM0,1,2954.875,2954.875,0.0
2020-05-18,ESM0,1,2952.125,2951.125,1.0
2020-05-18,ESM0,1,2954.125,2955.625,-1.5
2020-05-18,ESM0,1,2959.375,2958.875,0.5
2020-05-18,ESM0,1,2960.875,2959.875,1.0
2020-05-18,ESM0,1,2948.125,2949.125,-1.0
2020-05-18,ESM0,1,2948.875,2948.875,0.0
2020-05-18,ESM0,1,2948.5,2948.5,0.0
2020-05-18,ESM0,1,2946.625,2946.625,0.0
2020-05-18,ESM0,1,2944.25,2943.875,0.375
2020-05-18,ESM0,1,2945.75,2946.0,-0.25
2020-05-18,ESM0,1,2947.625,2948.125,-0.5
2020-05-18,ESM0,1,2948.125,2948.875,-0.75
2020-05-18,ESM0,1,2948.875,2948.875,0.0
2020-05-18,ESM0,1,2949.625,2950.375,-0.75
2020-05-18,ESM0,1,2951.0,2951.375,-0.375
2020-05-18,ESM0,1,2949.625,2949.125,0.5
2020-05-18,ESM0,1,2949.125,2949.875,-0.75
2020-05-18,ESM0,1,2951.375,2950.875,0.5
2020-05-18,ESM0,1,2951.125,2951.125,0.0
2020-05-18,ESM0,1,2952.375,2952.125,0.25
2020-05-18,ESM0,1,2951.75,2950.875,0.875
2020-05-18,ESM0,1,2951.375,2950.875,0.5
2020-05-18,ESM0,1,2951.875,2951.125,0.75
2020-05-18,ESM0,1,2948.0,2948.125,-0.125
2020-05-18,ESM0,1,2948.875,2950.125,-1.25
2020-05-18,ESM0,1,2949.625,2949.625,0.0
2020-05-18,ESM0,1,2948.375,2948.375,0.0
2020-05-18,ESM0,1,2950.875,2950.875,0.0
2020-05-18,ESM0,1,2950.875,2951.625,-0.75
2020-05-19,ESM0,1,2951.875,2951.125,0.75
2020-05-19,ESM0,1,2949.875,2948.625,1.25
2020-05-19,ESM0,1,2948.875,2950.125,-1.25
2020-05-19,ESM0,1,2948.875,2948.875,0.0
2020-05-19,ESM0,1,2944.375,2941.875,2.5
2020-05-19,ESM0,1,2944.125,2944.625,-0.5
2020-05-19,ESM0,1,2943.875,2945.25,-1.375
2020-05-19,ESM0,1,2945.125,2944.875,0.25
2020-05-19,ESM0,1,2941.125,2941.375,-0.25
2020-05-19,ESM0,1,2939.875,2940.125,-0.25
2020-05-19,ESM0,1,2941.375,2941.125,0.25
2020-05-19,ESM0,1,2941.375,2942.125,-0.75
2020-05-19,ESM0,1,2942.375,2942.375,0.0
2020-05-19,ESM0,1,2942.625,2942.375,0.25
2020-05-19,ESM0,1,2941.125,2940.375,0.75
2020-05-19,ESM0,1,2937.125,2937.125,0.0
2020-05-19,ESM0,1,2936.125,2936.125,0.0
2020-05-19,ESM0,1,2937.625,2937.375,0.25
2020-05-19,ESM0,1,2937.375,2936.125,1.25
2020-05-19,ESM0,1,2938.875,2939.0,-0.125
2020-05-19,ESM0,1,2944.875,2945.875,-1.0
2020-05-19,ESM0,1,2946.125,2946.25,-0.125
2020-05-19,ESM0,1,2946.125,2946.125,0.0
2020-05-19,ESM0,1,2947.375,2947.375,0.0
2020-05-19,ESM0,1,2948.875,2948.375,0.5
2020-05-19,ESM0,1,2948.0,2948.125,-0.125
2020-05-19,ESM0,1,2950.875,2952.375,-1.5
2020-05-19,ESM0,1,2961.25,2960.875,0.375
2020-05-19,ESM0,1,2960.625,2959.875,0.75
2020-05-19,ESM0,1,2963.375,2965.75,-2.375
2020-05-19,ESM0,1,2968.875,2969.125,-0.25
2020-05-19,ESM0,1,2969.125,2968.125,1.0
2020-05-19,ESM0,1,2973.375,2974.875,-1.5
2020-05-19,ESM0,1,2955.375,2955.25,0.125
2020-05-19,ESM0,1,2957.625,2955.875,1.75
2020-05-19,ESM0,1,2955.375,2955.375,0.0
2020-05-19,ESM0,1,2943.625,2943.375,0.25
2020-05-19,ESM0,1,2943.5,2942.625,0.875
2020-05-19,ESM0,1,2938.875,2940.375,-1.5
2020-05-19,ESM0,1,2939.625,2939.375,0.25
2020-05-19,ESM0,1,2939.625,2937.625,2.0
2020-05-19,ESM0,1,2935.875,2937.875,-2.0
2020-05-19,ESM0,1,2938.25,2938.625,-0.375
2020-05-19,ESM0,1,2940.375,2942.125,-1.75
2020-05-19,ESM0,1,2931.875,2932.875,-1.0
2020-05-19,ESM0,1,2932.875,2932.125,0.75
2020-05-19,ESM0,1,2939.125,2938.125,1.0
2020-05-19,ESM0,1,2937.875,2936.375,1.5
2020-05-19,ESM0,1,2944.125,2945.625,-1.5
2020-05-19,ESM0,1,2946.125,2946.625,-0.5
2020-05-19,ESM0,1,2945.625,2945.875,-0.25
2020-05-19,ESM0,1,2945.625,2945.375,0.25
2020-05-19,ESM0,1,2945.375,2945.875,-0.5
2020-05-19,ESM0,1,2938.125,2937.875,0.25
2020-05-19,ESM0,1,2939.375,2938.875,0.5
2020-05-19,ESM0,1,2941.875,2941.875,0.0
2020-05-19,ESM0,1,2943.375,2942.375,1.0
2020-05-19,ESM0,1,2940.375,2941.625,-1.25
Query:
SELECT
  CASE
    WHEN p.value:"PartyID"::STRING LIKE 'LUCKY%' THEN 'feeling-lucky'
    WHEN p.value:"PartyID"::STRING LIKE 'MOMO%' THEN 'momentum'
    WHEN p.value:"PartyID"::STRING LIKE 'PREDICT%' THEN 'predictive'
    ELSE 'other'
  END AS "Strategy",
  AVG(t."LastPx" - t."StrikePrice") AS "AvgIntrinsicValue",
  COUNT(*) AS "NumberOfTrades"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
WHERE f.value:"Side"::STRING = 'LONG'
GROUP BY "Strategy"
LIMIT 100
Answer:
Strategy,AvgIntrinsicValue,NumberOfTrades
momentum,0.016607703742776994,166828
feeling-lucky,-0.006461746030371018,230878
predictive,-0.010365121715975091,381544
Query:
SELECT
  t."Symbol",
  COUNT(*) AS "TradeCount"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
WHERE f.value:"Side"::STRING = 'LONG'
  AND p.value:"PartyID"::STRING LIKE 'LUCKY%'
GROUP BY t."Symbol"
ORDER BY "TradeCount" DESC
LIMIT 5
Answer:
Symbol,TradeCount
NQU0,42517
NQZ0,36056
ESZ0,30939
ESU0,28847
NQM0,16922
Query:
SELECT
  t."TradeDate",
  t."Symbol",
  t."Quantity",
  t."LastPx",
  t."StrikePrice",
  t."LastPx" - t."StrikePrice" AS "IntrinsicValue",
  p.value:"PartyID"::STRING AS "PartyID"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
WHERE f.value:"Side"::STRING = 'LONG'
LIMIT 100
Answer:
TradeDate,Symbol,Quantity,LastPx,StrikePrice,IntrinsicValue,PartyID
2020-05-18,ESM0,1,2952.375,2953.375,-1.0,MOMOES
2020-05-18,ESM0,1,2952.875,2952.625,0.25,MOMOES
2020-05-18,ESM0,1,2952.125,2953.625,-1.5,MOMOES
2020-05-18,ESM0,1,2953.125,2953.875,-0.75,MOMOES
2020-05-18,ESM0,1,2954.125,2953.625,0.5,MOMOES
2020-05-18,ESM0,1,2956.125,2956.125,0.0,MOMOES
2020-05-18,ESM0,1,2954.375,2952.125,2.25,MOMOES
2020-05-18,ESM0,1,2954.875,2954.625,0.25,MOMOES
2020-05-18,ESM0,1,2954.625,2954.875,-0.25,MOMOES
2020-05-18,ESM0,1,2954.875,2955.375,-0.5,MOMOES
2020-05-18,ESM0,1,2955.625,2955.125,0.5,MOMOES
2020-05-18,ESM0,1,2956.625,2956.125,0.5,MOMOES
2020-05-18,ESM0,1,2954.875,2954.875,0.0,MOMOES
2020-05-18,ESM0,1,2952.125,2951.125,1.0,MOMOES
2020-05-18,ESM0,1,2954.125,2955.625,-1.5,MOMOES
2020-05-18,ESM0,1,2959.375,2958.875,0.5,MOMOES
2020-05-18,ESM0,1,2960.875,2959.875,1.0,MOMOES
2020-05-18,ESM0,1,2948.125,2949.125,-1.0,MOMOES
2020-05-18,ESM0,1,2948.875,2948.875,0.0,MOMOES
2020-05-18,ESM0,1,2948.5,2948.5,0.0,MOMOES
2020-05-18,ESM0,1,2946.625,2946.625,0.0,MOMOES
2020-05-18,ESM0,1,2944.25,2943.875,0.375,MOMOES
2020-05-18,ESM0,1,2945.75,2946.0,-0.25,MOMOES
2020-05-18,ESM0,1,2947.625,2948.125,-0.5,MOMOES
2020-05-18,ESM0,1,2948.125,2948.875,-0.75,MOMOES
2020-05-18,ESM0,1,2948.875,2948.875,0.0,MOMOES
2020-05-18,ESM0,1,2949.625,2950.375,-0.75,MOMOES
2020-05-18,ESM0,1,2951.0,2951.375,-0.375,MOMOES
2020-05-18,ESM0,1,2949.625,2949.125,0.5,MOMOES
2020-05-18,ESM0,1,2949.125,2949.875,-0.75,MOMOES
2020-05-18,ESM0,1,2951.375,2950.875,0.5,MOMOES
2020-05-18,ESM0,1,2951.125,2951.125,0.0,MOMOES
2020-05-18,ESM0,1,2952.375,2952.125,0.25,MOMOES
2020-05-18,ESM0,1,2951.75,2950.875,0.875,MOMOES
2020-05-18,ESM0,1,2951.375,2950.875,0.5,MOMOES
2020-05-18,ESM0,1,2951.875,2951.125,0.75,MOMOES
2020-05-18,ESM0,1,2948.0,2948.125,-0.125,MOMOES
2020-05-18,ESM0,1,2948.875,2950.125,-1.25,MOMOES
2020-05-18,ESM0,1,2949.625,2949.625,0.0,MOMOES
2020-05-18,ESM0,1,2948.375,2948.375,0.0,MOMOES
2020-05-18,ESM0,1,2950.875,2950.875,0.0,MOMOES
2020-05-18,ESM0,1,2950.875,2951.625,-0.75,MOMOES
2020-05-19,ESM0,1,2951.875,2951.125,0.75,MOMOES
2020-05-19,ESM0,1,2949.875,2948.625,1.25,MOMOES
2020-05-19,ESM0,1,2948.875,2950.125,-1.25,MOMOES
2020-05-19,ESM0,1,2948.875,2948.875,0.0,MOMOES
2020-05-19,ESM0,1,2944.375,2941.875,2.5,MOMOES
2020-05-19,ESM0,1,2944.125,2944.625,-0.5,MOMOES
2020-05-19,ESM0,1,2943.875,2945.25,-1.375,MOMOES
2020-05-19,ESM0,1,2945.125,2944.875,0.25,MOMOES
2020-05-19,ESM0,1,2941.125,2941.375,-0.25,MOMOES
2020-05-19,ESM0,1,2939.875,2940.125,-0.25,MOMOES
2020-05-19,ESM0,1,2941.375,2941.125,0.25,MOMOES
2020-05-19,ESM0,1,2941.375,2942.125,-0.75,MOMOES
2020-05-19,ESM0,1,2942.375,2942.375,0.0,MOMOES
2020-05-19,ESM0,1,2942.625,2942.375,0.25,MOMOES
2020-05-19,ESM0,1,2941.125,2940.375,0.75,MOMOES
2020-05-19,ESM0,1,2937.125,2937.125,0.0,MOMOES
2020-05-19,ESM0,1,2936.125,2936.125,0.0,MOMOES
2020-05-19,ESM0,1,2937.625,2937.375,0.25,MOMOES
2020-05-19,ESM0,1,2937.375,2936.125,1.25,MOMOES
2020-05-19,ESM0,1,2938.875,2939.0,-0.125,MOMOES
2020-05-19,ESM0,1,2944.875,2945.875,-1.0,MOMOES
2020-05-19,ESM0,1,2946.125,2946.25,-0.125,MOMOES
2020-05-19,ESM0,1,2946.125,2946.125,0.0,MOMOES
2020-05-19,ESM0,1,2947.375,2947.375,0.0,MOMOES
2020-05-19,ESM0,1,2948.875,2948.375,0.5,MOMOES
2020-05-19,ESM0,1,2948.0,2948.125,-0.125,MOMOES
2020-05-19,ESM0,1,2950.875,2952.375,-1.5,MOMOES
2020-05-19,ESM0,1,2961.25,2960.875,0.375,MOMOES
2020-05-19,ESM0,1,2960.625,2959.875,0.75,MOMOES
2020-05-19,ESM0,1,2963.375,2965.75,-2.375,MOMOES
2020-05-19,ESM0,1,2968.875,2969.125,-0.25,MOMOES
2020-05-19,ESM0,1,2969.125,2968.125,1.0,MOMOES
2020-05-19,ESM0,1,2973.375,2974.875,-1.5,MOMOES
2020-05-19,ESM0,1,2955.375,2955.25,0.125,MOMOES
2020-05-19,ESM0,1,2957.625,2955.875,1.75,MOMOES
2020-05-19,ESM0,1,2955.375,2955.375,0.0,MOMOES
2020-05-19,ESM0,1,2943.625,2943.375,0.25,MOMOES
2020-05-19,ESM0,1,2943.5,2942.625,0.875,MOMOES
2020-05-19,ESM0,1,2938.875,2940.375,-1.5,MOMOES
2020-05-19,ESM0,1,2939.625,2939.375,0.25,MOMOES
2020-05-19,ESM0,1,2939.625,2937.625,2.0,MOMOES
2020-05-19,ESM0,1,2935.875,2937.875,-2.0,MOMOES
2020-05-19,ESM0,1,2938.25,2938.625,-0.375,MOMOES
2020-05-19,ESM0,1,2940.375,2942.125,-1.75,MOMOES
2020-05-19,ESM0,1,2931.875,2932.875,-1.0,MOMOES
2020-05-19,ESM0,1,2932.875,2932.125,0.75,MOMOES
2020-05-19,ESM0,1,2939.125,2938.125,1.0,MOMOES
2020-05-19,ESM0,1,2937.875,2936.375,1.5,MOMOES
2020-05-19,ESM0,1,2944.125,2945.625,-1.5,MOMOES
2020-05-19,ESM0,1,2946.125,2946.625,-0.5,MOMOES
2020-05-19,ESM0,1,2945.625,2945.875,-0.25,MOMOES
2020-05-19,ESM0,1,2945.625,2945.375,0.25,MOMOES
2020-05-19,ESM0,1,2945.375,2945.875,-0.5,MOMOES
2020-05-19,ESM0,1,2938.125,2937.875,0.25,MOMOES
2020-05-19,ESM0,1,2939.375,2938.875,0.5,MOMOES
2020-05-19,ESM0,1,2941.875,2941.875,0.0,MOMOES
2020-05-19,ESM0,1,2943.375,2942.375,1.0,MOMOES
2020-05-19,ESM0,1,2940.375,2941.625,-1.25,MOMOES
End Exploring Related Columns
Task: How much higher the average intrinsic value is for trades using the feeling-lucky strategy compared to those using the momentum strategy under long-side trades?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To determine how much higher the average intrinsic value is for trades using the feeling-lucky strategy compared to those using the momentum strategy under long-side trades, we calculate the average intrinsic values for both strategies under long-side trades and find the difference.

```csv
higher
value:float > 0
```

*Note*: The value represents the positive difference in average intrinsic value between the feeling-lucky and momentum strategies under long-side trades..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'CYMBAL_INVESTMENTS': {'CYMBAL_INVESTMENTS': ['TRADE_CAPTURE_REPORT']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
You need to follow the format's positive signs.

2025-01-20 18:30:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:30:09 - root - INFO - To determine how much higher the average intrinsic value is for trades using the feeling-lucky strategy compared to those using the momentum strategy under long-side trades, we calculate the average intrinsic values for both strategies under long-side trades and find the positive difference.

```sql
SELECT
  ABS(
    AVG(CASE WHEN p.value:"PartyID"::STRING LIKE 'LUCKY%'
             THEN t."LastPx" - t."StrikePrice"
        END) -
    AVG(CASE WHEN p.value:"PartyID"::STRING LIKE 'MOMO%'
             THEN t."LastPx" - t."StrikePrice"
        END)
  ) AS "higher"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
WHERE f.value:"Side"::STRING = 'LONG';
```
2025-01-20 18:30:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:30:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:30:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:30:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 18:30:11 - snowflake.connector.connection - INFO - closed
2025-01-20 18:30:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:30:11 - root - INFO - itercount: 1
2025-01-20 18:30:11 - root - INFO - 0
2025-01-20 18:30:11 - root - INFO - results: 
higher
0.023069449773148013


2025-01-20 18:30:11 - root - INFO - Please check the answer again by reviewing How much higher the average intrinsic value is for trades using the feeling-lucky strategy compared to those using the momentum strategy under long-side trades?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To determine how much higher the average intrinsic value is for trades using the feeling-lucky strategy compared to those using the momentum strategy under long-side trades, we calculate the average intrinsic values for both strategies under long-side trades and find the difference.

```csv
higher
value:float > 0
```

*Note*: The value represents the positive difference in average intrinsic value between the feeling-lucky and momentum strategies under long-side trades. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
higher
0.023069449773148013
Current sql:
SELECT
  ABS(
    AVG(CASE WHEN p.value:"PartyID"::STRING LIKE 'LUCKY%'
             THEN t."LastPx" - t."StrikePrice"
        END) -
    AVG(CASE WHEN p.value:"PartyID"::STRING LIKE 'MOMO%'
             THEN t."LastPx" - t."StrikePrice"
        END)
  ) AS "higher"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
WHERE f.value:"Side"::STRING = 'LONG';You need to follow the format's positive signs.

2025-01-20 18:30:53 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:30:53 - root - INFO - To determine how much higher the average intrinsic value is for trades using the feeling-lucky strategy compared to those using the momentum strategy under long-side trades, we calculate the average intrinsic values for both strategies under long-side trades and find the positive difference.

```csv
higher
0.0231
```

```sql
SELECT
  ROUND(
    ABS(
      AVG(CASE WHEN p.value:"PartyID"::STRING LIKE 'LUCKY%'
               THEN t."LastPx" - t."StrikePrice"
          END) -
      AVG(CASE WHEN p.value:"PartyID"::STRING LIKE 'MOMO%'
               THEN t."LastPx" - t."StrikePrice"
          END)
    ), 4) AS "higher"
FROM "CYMBAL_INVESTMENTS"."CYMBAL_INVESTMENTS"."TRADE_CAPTURE_REPORT" t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") p
WHERE f.value:"Side"::STRING = 'LONG';
```
2025-01-20 18:30:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:30:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:30:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:30:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 18:30:55 - snowflake.connector.connection - INFO - closed
2025-01-20 18:30:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:30:56 - root - INFO - itercount: 2
2025-01-20 18:30:56 - root - INFO - 0
2025-01-20 18:30:56 - root - INFO - Total iteration counts: 2
