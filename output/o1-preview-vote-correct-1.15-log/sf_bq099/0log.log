2025-01-16 03:09:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 03:10:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 03:10:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:10:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:10:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:10:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 03:10:07 - snowflake.connector.connection - INFO - closed
2025-01-16 03:10:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:10:07 - root - INFO - SQL:
SELECT DISTINCT f.value::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   LIMIT 1000;
Results:
Too long, hard cut:
cpc_code
"{""code"":""G02B7/16"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""H04N23/66"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""Y02A50/30"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61P31/18"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K31/506"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H04B1/1036"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G11B2005/0002"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""H01H9/161"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G01D3/022"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G11B7/0945"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B29C65/524"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""B29C66/721"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01L23/48"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""B41J2/04581"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G11C7/12"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""G01B11/2522"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61M25/01"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61P31/16"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H03K19/17764"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""D04H1/407"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""F05D2260/30"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""C08K5/52"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G06N10/40"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""H02K3/18"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01Q9/045"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A23C21/02"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""B41J25/3088"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""C07D311/12"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A01G5/06"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B60R21/20"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B29C53/063"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B65D63/08"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61L2/18"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""G09F23/105"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G06N20/00"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61K35/32"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""F02B37/14"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B01D2257/702"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""H01M2010/4278"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G08G1/161"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A47C7/282"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H04N17/04"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G05B19/4185"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B60L2240/80"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B8/06"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01L24/83"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""H01L2224/05184"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A44C5/145"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G02B27/144"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""D06M13/368"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G07C9/00309"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01H51/2254"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""F16B33/008"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K39/4613"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G09F2013/222"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G03B2205/0015"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""C22C38/48"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H04B1/04"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61J7/0076"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G02B6/4467"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G06F3/0619"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""H04N23/672"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""H04N23/951"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""E04B2/763"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H04M2250/02"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G06F2212/281"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G02F1/13394"",""first"":true,""inve

2025-01-16 03:10:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:10:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:10:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:10:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 03:10:08 - snowflake.connector.connection - INFO - closed
2025-01-16 03:10:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:10:09 - root - INFO - SQL:
SELECT DISTINCT t."filing_date"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   WHERE t."filing_date" IS NOT NULL
   LIMIT 1000;
Results:
Too long, hard cut:
filing_date
20191106
20200203
20200522
19961122
20010716
19940307
19660908
20090709
19870302
19720621
19791227
19850726
20180430
20180829
19851014
19830303
20180827
19700605
19531130
19700720
19541229
19250406
19120425
19721106
19660112
19050605
19280730
19660103
19840106
19720801
19890110
19340616
19471029
19680102
19700916
19940620
19871127
19911205
19911015
19981130
20010426
20011001
20010724
20030527
20051207
20060403
20070105
20070620
20080303
20080902
20090909
20100909
20110401
20131008
20001006
20020329
20030926
20090619
20231214
20070608
19130811
20230608
19981016
20050314
20051226
20060914
20111220
20160801
20150327
20041104
20080815
20090206
20090506
20120918
20121102
20070611
20101117
19920617
19850729
19710821
19900917
20030822
20070404
20091016
20100621
20110127
20180313
20200611
19970206
20210207
20220122
20210516
20220914
20221122
20230530
20230719
19800923
20030827
19740220
20111129
20040901
20230824
19920909
19990511
20121002
19840704
20110513
20030730
20070905
20160709
20220201
20130819
20160323
20221128
20010402
19650930
19790306
19051023
19920117
19971014
19900123
19770325
19800418
19860314
19810413
19820817
20151231
19790330
19930726
20150520
20020807
20091106
20160502
19990812
20151127
20050124
19770421
19710719
19690321
19640720
19240221
19750110
19950606
19840111
19080227
19450709
19200624
19251211
19900118
19860122
19770216
19780404
19810515
19221125
19930331
19370405
19940225
20080818
19740725
20080426
19980611
19690103
19890401
20190610
20170125
20160411
19770914
19750922
19820911
19880802
19840822
19910726
19980729
20100225
20100922
20121220
19841005
20090213
19870514
19920106
20080116
19721003
19741213
19890812
19910722
19871204
19960507
20110201
20221023
20240311
19700504
19891127
19890817
19980423
20220306
19810116
20010417
20020927
20220204
19080707
20110214
20100907
19510202
19500627
19591124
19570321
19640203
19391103
19321010
19540907
20070102
19050322
19790329
19600603
19840117
19710203
19571230
19660329
19631011
19910226
20020330
20180706
20140810
19840210
20001216
19860707
20000311
19680918
19771014
19741111
19791217
19630730
19570622
19760112
19700523
20210627
19660723
20030107
19810206
19850903
20150515
19890227
19450414
19360518
19180827
19530623
19030801
18970621
19611220
19720107
19330505
19160821
19640113
19590629
19911008
19861114
19871208
19901002
19850517
19890801
19910926
20050911
20070726
20090824
20140708
20170923
19370507
19140608
19200520
19670419
19880423
20120507
19841211
20001007
19900804
20200525
20150419
19900820
19430412
19190821
19570704
19780324
19810918
20200125
19620712
19790714
19160408
19211015
19301004
19470604
19550419
19661220
19170811
19160517
19610825
19790115
19490620
19290305
19680108
19540329
19190121
19661207
19830329
19890616
19120302
19131010
19520703
19580117
19070323
19370421
19651108
19410524
19110526
19571119
19121009
19320831
19820809
19490715
19250921
19590820
19760405
19851022
19940805
19751106
19340914
19471212
19390223
19411006
19590224
19380831
19710907
19020912
19230310
19250112
19621212
19580507
19571206
19720119
19640320
19470408
19881101
19880425
19930827
19691219
19820505
19640709
19870214
19910829
19880919
20180617
19930109
19830625
19870608
19480911
19131021
19500925
19580520
19110209
19401108
19630312
19410227
19701110
19160724
19580107
19760325
20060729
20151106
20140626
20150921
20180529
20190716
20200225
20210322
19970521
20161230
19900419
19791126
19920827
19841109
19881004
19941129
20200430
20030430
20031217
20060523
20061110
20100924
19830902
19871016
20011022
20010507
20211215
20211217
20220414
20230131
20230829
20230919
20231016
20231031
20240108
20020708
19930525
20051122
20001222
19840523
19901204
19941014
19890511
20130222
19770610
20030415
19840215
20091102
20040122
20001009
20110708
19330902
19280807
19380725
19411222
19221010
19091102
19740930
19620620
19300916
20051115
19690618
18921230
19720606
19691216
19371029
19391013
19611130
19820126
19671003
20000906
19641221
19710419
19361205
19840911
20190228
20200605
20140606
20000202
19830131
20050701
19690723
20110530
19990618
19930924
19920408
19910920
19800908
20180227
20220714
19750703
20230929
20031110
20131031
19670318
19750705
20190207
20130118
20160617
20100309
20050711
20160324
20220404
20161012
20201120
20030621
19960719
19400111
20131205
19661025
20000216
20210901
20170427
20180817
20170921
19781009
19881109
19921021
20091218
19930629
20101224
20110407
20151002
20020709
20040405
19751014
19741126
19850912
19870929
20031212
20010615
20070907
20210120
19960423
19781028
19801022
20021119
20010828
19850429
19750331
20110218
20110927
20070504
20160602
20060925
19820701
19741211
19760316
19860403
19650326
19630225
20020125
19910508
19580128
19321125
19530814
19810306
19800208
19730213
19910225
19850228
19960717
19100411
19101028
19120902
19710401
19820325
19660927
19960710
19291212
19320311
19750822
19660105
19910218
19760513
19880309
19660624
19900316
19800522
19990318
19840420
20240510
19850702
20110309
20170822
20140731
20190227
20061013
20050819
19

2025-01-16 03:10:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:10:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:10:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:10:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 150
2025-01-16 03:10:10 - snowflake.connector.connection - INFO - closed
2025-01-16 03:10:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:10:11 - root - INFO - SQL:
SELECT DISTINCT SUBSTRING(t."filing_date"::STRING, 1, 4) AS "filing_year"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   WHERE t."filing_date" IS NOT NULL
   LIMIT 1000;
Results:
filing_year
2015
2016
2018
1983
1978
1898
1949
1887
2012
2000
1907
1905
1885
1904
1846
1942
1908
1881
1936
1948
2013
1951
1992
1910
2010
2024
1926
1924
2014
1963
1952
1920
1928
1940
1995
1912
1930
1922
1889
1994
1986
1993
1985
1890
2021
1968
2017
1935
2003
1956
2009
1998
1950
1933
1927
1981
1999
1980
1979
1892
1997
1880
1996
0
1953
1938
1964
1947
1906
1900
1969
1909
1929
2005
1945
1972
1960
1911
1895
2006
1903
1937
1923
1886
2019
2023
1899
1931
1988
1976
1955
1901
2008
1946
1915
1967
1939
1944
1867
1991
1921
1914
2020
2002
1934
1916
1925
1917
1970
1941
1971
1943
1896
1860
2011
2004
1989
1966
1877
2001
1882
1957
1894
1932
1962
1897
1918
1987
1974
2007
1961
1913
1975
1959
1919
1902
1893
1965
1982
1891
2022
1984
1990
1958
1853
1977
1888
1973
1954
1883

2025-01-16 03:10:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:10:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:10:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:10:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 93
2025-01-16 03:10:13 - snowflake.connector.connection - INFO - closed
2025-01-16 03:10:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:10:13 - root - INFO - SQL:
SELECT DISTINCT t."country_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 1000;
Results:
country_code
DO
BA
RS
WO
CR
PL
EP
ZA
MY
CS
LV
HR
AU
CU
RO
KR
PT
NZ
CL
NO
HU
JP
DZ
NL
LT
UA
MW
IT
OA
CY
CZ
HN
SV
CH
TR
BG
AT
YU
ZM
MD
ZW
MA
GB
SG
EG
PA
CO
SI
AR
KE
FI
DK
CA
SK
IS
NI
US
PH
DE
DD
MX
EE
GE
HK
TN
GT
BR
ID
LU
GR
RU
JO
IN
EC
SA
MN
SU
FR
PE
KZ
IL
TW
MT
BE
SE
AP
SM
ME
EA
ES
IE
CN
MC

2025-01-16 03:10:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:10:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:10:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:10:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-16 03:10:15 - snowflake.connector.connection - INFO - closed
2025-01-16 03:10:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:11:06 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 03:11:06 - root - INFO - ```sql
SELECT DISTINCT t."publication_number"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") f
WHERE f.value:"code"::STRING LIKE 'A01B3%'
LIMIT 1000;
```

This query retrieves the publication numbers of patents associated with the CPC classification code starting with 'A01B3'. The condition has been simplified to correctly extract the `"code"` field from the JSON structure within the `"cpc"` column. By using `f.value:"code"::STRING LIKE 'A01B3%'`, we ensure that we are matching the CPC codes correctly.
2025-01-16 03:11:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:11:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:11:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:11:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 119
2025-01-16 03:11:07 - snowflake.connector.connection - INFO - closed
2025-01-16 03:11:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:11:08 - root - INFO - SQL:
SELECT DISTINCT t."publication_number"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") f
WHERE f.value:"code"::STRING LIKE 'A01B3%'
LIMIT 1000;
Results:
publication_number
BE-826346-A
PL-440426-A1
EP-3474651-C0
DE-102017102683-A1
CN-114916261-A
CN-108575125-A
KR-102484290-B1
US-159642-A
FR-508965-A
CA-2977468-A1
US-1545136-A
AT-A720679-A
CN-104040083-B
KR-101169320-B1
US-10375891-B2
US-5267618-A
KR-200473688-Y1
CN-107072143-A
FR-2943502-A1
US-5407014-A
US-1860534-A
KR-20070101567-A
GB-792883-A
JP-6998053-B2
JP-S6342702-Y2
BE-872468-A
US-2784656-A
AU-2016269849-A1
BE-727862-A
US-1412308-A
KR-101378314-B1
US-3054462-A
GB-436304-A
AU-7115874-A
CN-108289407-A
CA-3089518-A1
CN-106973572-B
DE-463858-C
CN-113796181-A
US-130700-A
CN-107646212-A
KR-20020000597-A
BE-1007083-A5
US-1636048-A
US-376176-A
US-395573-A
US-231385-A
KR-102593393-B1
US-5845717-A
US-2597821-A
DE-102010019819-B4
CN-105325075-A
KR-200194260-Y1
GB-2089182-B
CN-115362764-A
KR-101593221-B1
KR-100626846-B1
ZA-808003-B
KR-200487998-Y1
FR-960102-A
CN-109392332-A
CN-116671357-A
CN-114651538-A
US-469659-A
KR-20010029583-A
GB-2039201-B
NO-153631-B
DE-829523-C
IL-268624-A
CN-100366901-C
KR-20130063834-A
DE-1963184-U
DE-140654-C
CN-113761309-A
US-2024164239-A1
US-1471180-A
CA-2945250-A1
US-3963079-A
IT-8519066-A1
CN-109005687-A
KR-200149462-Y1
US-694931-A
DE-8707829-U1
FR-2287837-B1
NL-183071-C
US-3129772-A
US-1081539-A
US-2545590-A
US-501724-A
IT-1064821-B
US-290366-A
HU-E050035-T2
KR-200386017-Y1
RU-191537-U1
US-2039702-A
JP-6910281-B2
US-5669452-A
GB-2090713-B
US-2888084-A
CA-2543900-A1
US-2019324472-A1
US-2031188-A
KR-900006618-B1
US-1093294-A
IT-1166526-B
NL-7909063-A
GB-2598141-A
AU-2002301383-B2
US-828171-A
GB-696973-A
NO-910950-L
EP-3586579-A1
CA-997451-A
KR-20020067218-A
US-2843032-A
KR-100191418-B1
US-220177-A
US-530054-A
CN-107094377-A

2025-01-16 03:11:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:11:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:11:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:11:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 03:11:09 - snowflake.connector.connection - INFO - closed
2025-01-16 03:11:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:11:10 - root - INFO - SQL:
SELECT DISTINCT f.value:"name"::STRING AS "assignee_harmonized_name"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") f
   WHERE f.value:"name" IS NOT NULL
   LIMIT 1000;
Results:
Too long, hard cut:
assignee_harmonized_name
MATHIAS STREIFF A G
TERRY WILLIAM BLAKE
BRAMMER TRANSMISSIONS
ESSELTE PENDAFLEX CORP
ROBINSON FREEMAN C
ANDRE STRAHM
EXXON RESEARCH ENGINEERING CO
MAGNETI MARELLI SPA
KIMBERLY CLARK CO
PEUGEOT
WAKER WILLIAM FRANK
JENSEN ANDREW
TOLBERT C BUSHONG
SCHLUMBERGER PROSPECTION
NIHON PARKERIZING
V H P J BRANCART & ZN NV
ZEISS CARL SOC
NIPPON PETROCHEMICALS CO LTD
HEWLETT PACKARD DEVELOPMENT CO LP
BANGRATZ PABLO
AZURITY PHARMACEUTICALS INC
HELSINN HEALTHCARE SA
PEREZ BENOIT
LOTUSGRILL GMBH
BEHJAT ABDOLREZA
FIBICS INCORPORATED
MERCHANT DAMON C
MARIJNISSEN KEES
YAMAGAMI HIDEHISA
PYO CHEOL SIG
NICHIA CORP
BRUKER BIOSPIN AG
WELSH WALTER THOMAS
STEEB CURT ANDREW
SOKOLOFSKY PHILLIP M
PRESCIENT MEDICAL INC
NAISBY ANDREW
NOVADAQ TECHNOLOGIES INC
METAL IND RES & DEV CT
GIANELO ANGELO
WONDERLAND NURSERY GOODS
GO DADDY GROUP INC
PIONEER TOHOKU CORP
NIEH SHIN-YU
TAIWAN SEMICONDUCTOR MFG
WULFF CHRISTIAN
FRANCHET JEAN-MICHEL PATRICK MAURICE
AJINOMOTO KK
BETTS STEPHEN N
THORNEYCROFT JAMES BAIRD
NISSEI ELECTRIC
JOHNSON M D A
ADIDAS SPORTSCHUHE
ANKARCRONA FREDRIK
BIOTEKNIKA INTERNATIONAL
O M KENKYUSHO KK
HUGERSHOFF REINHARD
ASEA AB
SKODA ENTREPRISE NATIONALE ETS
HOOVER LTD
CHARLES DEGOUD
UNIV GLASGOW
HOWARD THOMAS THORNTON
HOHNEN OIL
GLORY KOGYO KK
ARKRAY INC
SHADECRAFT INC
SONOS INC
CHR HANSEN AS
HESTAN COMMERCIAL CORP
ROCKWOOL INT
NOVALEAD PHARMA INC
MIYAGAWA TAKUMI
KIOXIA CORP
ST MICROELECTRONICS CROLLES 2 SAS
TECHNION RES & DEV FOUNDATION
VIAVI SOLUTIONS INC
KOYO MUSEN CORP
UNITYPE COMPANY
CHO DAE GUN
TSA CO LTD
LEE SAE RYONG
ISORG
ACCELERON PHARMA INC
WAYS1 INC
JIN LI
INST COMPUTING TECH CN ACADEMY
NIPPON KOGAKU KK
FUZHOU SIMAIT DIGITAL TECHNOLO
CHINA PETROCHEMICAL DEV CORP
MINGLIANG LI
YONGCHANG ZHANG
ELECTRIC AVENUE SOFTWARE INC
MOORE CALEB MICHAEL
UNIV TECHNOLOGICZNO-HUMANISTYCZNY IM KAZIMIERZA PUÅASKIEGO W RADOMIU
MAGE GEHRING GMBH VOELKERMARKT
VNII GELIEEVOJ TECH
MURILLO HERNANDO
TRT LUCENT TECHNOLOGIES SA
ANTERIS TECH CORPORATION
ST MICROELECTRONICS ROUSSET
UNIV ALBERT LUDWIGS FREIBURG
NEXION SPA
PETROLEO BRASILEIRO SA PETROBRAS
HEFEI MIDEA REFRIGERATOR CO
SHENZHEN ROYOLE TECHNOLOGIES CO LTD
WANGSU SCIENCE & TECH CO LTD
SERVIER LAB
ENDOGENX INC
ACTIVEVIDEO NETWORKS INC
AGCO DO BRASIL SOLUCOES AGRICOLAS LTDA
FWP IP APS
PANASONIC ECO SYS GUANGDONG CO
XU YINGQI
ZHANG HUANHUAN
INAGAKI NOBUAKI
INFOSEIZE SYSTEMS CO LTD
NIKE INC
SMART HUB PTE LTD
TAMURA SHUICHI
TRIANGLE TYRE CO LTD
ELITE FUELS LLC
UNIV MASSACHUSETTS
SUBARU CORP
NEC LAB AMERICA INC
TAMINCO N V
FLEXOPACK S A PLASTICS IND
JOHNSON & JOHNSON SURGICAL VISION INC
ETAT FINLANDAIS
ZIMMER GUENTHER
ATOMA INT INC
BREE JOAN MARY
COURTAULDS FILMS HOLDINGS
MONTALTI MIRKO
PROCOMAS S R L
IND NATUZZI
ARDITI
KUMSUNG MEDICAL INSTR CO LTD
I P A IND PLASTICA ADRIA DI CHENDI BRUNO &
TRUMPF PHOTONICS INC
TONGHUA DEJI GINSENG PHARMACEUTICAL CO LTD
NO 923 HOSPITAL JOINT LOGISTICS SUPPORT FORCE OF THE CHINESE PEOPLES LIBERATION ARMY
JIANGSU EASTMAN HEAVY MACHINERY CO LTD
HUAIBEI ZHUOCHUANG TECH SERVICE CO LTD
U PROTEC SHENZHEN TECH CO LTD
SHENZHEN RADIUM BRIGHT SCIENCE AND TECH CO LTD
DONGGUAN YUYI AUTOMATION EQUIPMENT LTD COMPANY
TAICANG LIANGSHENG RUBBER CO LTD
GUANGODNG YIKANGSHENG ENVIRONMENTAL PROTECTION TECH CO LTD
LIANYUNGANG JINCHEN IND CO LTD
SHANDONG HUANNENG DESIGN INST CO LTD
MAIHAI SUZHOU ENVIRONMENTAL PROTECTION TECH CO LTD
ZHAO JUNFENG
XINFENG COANDA ELECTRONIC CO LTD
SHENZHEN CHUANGYITONG TECH CO LTD
SIHONGXIN MACHINE CASTING CO LTD
HANGZHOU BOSS ELECTRIC APPLIANCE CO LTD
HEILONGJIANG HELIANG AGRICULTURE CO LTD
LI HUI
BAODING RAKANG SAUSAGE CASING PROC LIMITED COMPANY
HUNAN SANY MEDIUM LIFTING MACHINERY CO LTD
CHANZHOU ZHENYOU ELECTRICAL APPLIANCE LTD COMPANY
JIANGSU HONGBANMA NEW MATERIAL TECH CO LTD
BATTELLE ENERGY ALLIANCE LLC
SOLID INC
TG3D STUDIO
VELCRO IP HOLDINGS LLC
MATSUMOTO AYAKA
LIXIL SUZUKI SHUTTER CORP
EMPRESSA NAC DE MINERIA ENAMI
XIAMEN CHANGELIGHT CO LTD
LODZKA FAB MASZYN JEDWABNI
ALLEN GROUP
SANNER FRIEDR GMBH CO KG
SINGAPORE CHARTERED IND
BEHR GMBH & CO KG
SPATTI GIOVANNI
BOMBAY TEXTILE RES ASS BTRA
SUZUKI MASAMI
WOONGJIN CHEMICAL CO LTD
RIJK ZWAAN ZAADTEELT EN ZAADHANDEL BV
AGRUPADA INVEST OFF
PROEKTNO IZYSKATELSKIJ NII GID
VB AUTOBATTERIE GMBH
DATA POWER DEV LTD
GOTTUMUKKALA VENKATA SIVA RAMA KRISHNAM RAJU
VERDILE MONICA BEATRIZ
CONCORD GMBH
HEXEL GERHARD
GHSP INC
IRCCS AZIENDA OSPEDALIERA UNIVERSITARIA SAN MARTINO IST ISTITUTO NAZ PER LA RICERCA SUL CANCRO
LAMB SRL
INFECTIOUS DISEASE RES INST
SPRINT BIOSCIENCE AB
KHMAENC CO
SCINTOMICS GMBH
ZIMMER INC
BEXSON BIOMEDICAL INC
HEFEI CAS LANRUI TECH CO LTD
BUESCH BERND
IVANOVA TATYANA P
WILLIAM D ALTON
GUILD LEIGH S
THEODORE DAVID T
BOLOIT IRON WORKS
THOMAS HYDRAULIC SPEED COUTROL
CARSON WILLIAM
HENRY DREYFUS
BARTH W
REED TOOL CO
YORK FOOD MACHINERY CO
MAUD CHARLES EDWARD
HORTON JAMES ALEXANDER
MCKAY JOHN A
VMW RANSHOFEN BERNDORF AG
GARVIE HERBERT THOMPSON
BEMIS BROS BAG COMPANY
HAAKER WILLIAM
DONGGUAN POLYMERS NEW MATERIAL TECH CO LTD
NINGGUO RUIPU SEALS CO LTD
XIAMEN BRANCH ZHONGSHA

2025-01-16 03:11:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:11:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:11:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:11:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 119
2025-01-16 03:11:11 - snowflake.connector.connection - INFO - closed
2025-01-16 03:11:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:11:12 - root - INFO - SQL:
SELECT DISTINCT t."publication_number"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A01B3%'
   LIMIT 1000;
Results:
publication_number
KR-200473688-Y1
CN-107072143-A
DE-829523-C
BE-826346-A
PL-440426-A1
KR-101593221-B1
CA-2543900-A1
US-2888084-A
AU-7115874-A
CN-108289407-A
CA-3089518-A1
CN-106973572-B
KR-200149462-Y1
US-694931-A
KR-102484290-B1
US-159642-A
BE-727862-A
US-1545136-A
AT-A720679-A
KR-100626846-B1
ZA-808003-B
KR-20020000597-A
BE-1007083-A5
US-2784656-A
AU-2016269849-A1
US-1412308-A
KR-101378314-B1
DE-463858-C
US-130700-A
CN-107646212-A
CN-113796181-A
FR-508965-A
CA-2977468-A1
AU-2002301383-B2
CN-114651538-A
KR-20010029583-A
US-469659-A
US-5669452-A
GB-2090713-B
KR-200194260-Y1
CA-2945250-A1
US-5407014-A
FR-2943502-A1
GB-2598141-A
NL-7909063-A
CN-109392332-A
CN-116671357-A
HU-E050035-T2
US-290366-A
US-1471180-A
GB-2039201-B
US-3963079-A
IT-8519066-A1
CN-109005687-A
IL-268624-A
CN-100366901-C
US-3129772-A
US-1081539-A
US-2545590-A
US-1636048-A
US-395573-A
US-376176-A
US-231385-A
US-828171-A
GB-696973-A
NO-910950-L
EP-3586579-A1
KR-20020067218-A
CA-997451-A
US-2843032-A
KR-100191418-B1
US-3054462-A
GB-2089182-B
CN-115362764-A
CN-114916261-A
CN-108575125-A
US-1860534-A
GB-792883-A
KR-20070101567-A
JP-6998053-B2
JP-S6342702-Y2
BE-872468-A
DE-1963184-U
DE-140654-C
CN-113761309-A
CN-104040083-B
KR-101169320-B1
US-10375891-B2
US-5267618-A
NO-153631-B
DE-8707829-U1
FR-2287837-B1
NL-183071-C
KR-20130063834-A
US-501724-A
IT-1064821-B
US-2024164239-A1
US-2039702-A
KR-200386017-Y1
RU-191537-U1
US-220177-A
GB-436304-A
KR-900006618-B1
US-2031188-A
US-2019324472-A1
US-1093294-A
IT-1166526-B
KR-200487998-Y1
FR-960102-A
EP-3474651-C0
DE-102017102683-A1
KR-102593393-B1
US-5845717-A
US-2597821-A
CN-105325075-A
DE-102010019819-B4
JP-6910281-B2
US-530054-A
CN-107094377-A

2025-01-16 03:11:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:11:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:11:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:11:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-16 03:11:14 - snowflake.connector.connection - INFO - closed
2025-01-16 03:11:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:11:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 03:11:37 - root - INFO - ```sql
SELECT DISTINCT t."publication_number"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") f
WHERE f.value:"code"::STRING LIKE 'A01B%'
LIMIT 1000;
```
2025-01-16 03:11:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:11:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:11:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:11:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 524
2025-01-16 03:11:38 - snowflake.connector.connection - INFO - closed
2025-01-16 03:11:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:11:39 - root - INFO - SQL:
SELECT DISTINCT t."publication_number"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") f
WHERE f.value:"code"::STRING LIKE 'A01B%'
LIMIT 1000;
Results:
Too long, hard cut:
publication_number
AU-7115874-A
HU-E035729-T2
CN-108289407-A
DE-36067-C
CN-106973572-B
CN-109479674-B
US-11006567-B2
CN-116616310-A
US-2022000025-A1
CN-113926843-A
US-1082418-A
CN-109196980-A
CA-3089518-A1
CN-108575125-A
US-1538757-A
CN-109565988-A
CH-628492-A5
CN-114916261-A
US-1860534-A
US-5381647-A
DE-102021124382-A1
JP-S6342702-Y2
BE-872468-A
KR-20070101567-A
US-324336-A
GB-792883-A
SE-138635-C1
JP-6998053-B2
US-2692544-A
EP-1052142-B1
JP-2021107200-A
CA-2289148-A1
WO-2022138070-A1
AU-2013336489-B2
CN-104040083-B
KR-20030082844-A
US-11122727-B2
RU-2748995-C1
CN-108713364-A
US-213489-A
KR-101378314-B1
US-1412308-A
US-906051-A
FR-1166846-A
CH-477151-A
AU-752424-B2
DE-1220745-B
CN-107926187-A
FR-76496-E
CN-1130978-A
DE-149474-C
EP-0182091-B1
US-483311-A
US-194108-A
CA-3115757-A1
AT-400376-B
CA-1212551-A
WO-2018172461-A1
KR-20040087849-A
CN-115250849-A
US-2021267119-A1
NO-153631-B
NL-104890-C
KR-101593221-B1
AU-6604598-A
CA-2619532-A1
CN-108934199-A
IE-42273-L
EP-1013159-A3
GB-955047-A
GB-2174586-A
WO-2021156301-A1
JP-2879109-B2
KR-101193641-B1
CA-2999865-A1
KR-20110056601-A
AU-2015261725-B2
KR-20160100455-A
NL-183071-C
ES-2439952-T3
US-2019369-A
CA-2509971-C
DE-8707829-U1
NL-169215-C
JP-WO2023127437-A1
FR-2287837-B1
CN-115152388-A
US-2296916-A
CA-2187954-A1
RU-205217-U1
BE-1007083-A5
KR-20020000597-A
CN-106961846-A
RU-2654632-C2
US-2784656-A
DE-102019211496-A1
DK-115221-B
AU-2016269849-A1
CN-114393023-A
CN-106508151-B
US-2017071123-A1
CN-105794484-A
JP-2022538873-A
US-2024164239-A1
CA-3135313-A1
EP-3987897-A1
CN-108007337-A
DE-602004005909-D1
AU-1586376-A
KR-101649538-B1
US-469659-A
CA-983309-A
KR-20010029583-A
MY-199404-A
ZA-833618-B
US-2017172080-A1
CN-107249320-B
US-308455-A
CN-108307721-A
GB-139227-A
EP-0509307-B1
US-3439748-A
CN-106385847-A
KR-200194260-Y1
RU-2605068-C1
US-363757-A
DE-10330382-B4
US-2309266-A
US-11197412-B2
KR-200473688-Y1
BR-112018016785-A2
DE-102019201915-A1
US-10743458-B2
US-365162-A
AU-2013251266-B2
CN-110622200-A
CN-107072143-A
KR-900006618-B1
WO-2023106920-A1
US-2019324472-A1
US-2031188-A
BR-102020017619-A2
US-1093294-A
US-478158-A
IT-1166526-B
US-552165-A
US-3129772-A
US-2545590-A
CA-2224233-C
DE-102004042897-A1
AU-8105682-A
US-1081539-A
CN-107455024-A
US-501724-A
CN-109644596-A
GB-9721775-D0
US-2269981-A
US-1047644-A
IT-1064821-B
KR-102484290-B1
AR-012600-A1
IT-AR20130016-A1
CA-2628292-C
US-502697-A
US-159642-A
CA-2199335-C
US-1272260-A
RU-186558-U1
KR-20090049368-A
KR-101965094-B1
US-2039702-A
KR-200386017-Y1
RU-191537-U1
AT-A73281-A
US-2020390021-A1
US-2023082447-A1
US-237772-A
CN-109673186-A
KR-200272944-Y1
GB-788016-A
FR-1341948-A
US-5267618-A
US-856916-A
AU-2018273793-A1
CH-389304-A
GB-436304-A
GB-676967-A
CA-2927387-A1
CN-109005697-B
US-292639-A
US-128588-A
FR-2159121-A5
US-1009439-A
EP-0266345-A1
DE-102019209613-A1
DE-84374-C
CA-2752207-A1
BE-826346-A
TR-17678-A
PL-440426-A1
DE-855174-C
US-2019146513-A1
US-379454-A
NZ-576650-A
CN-113796181-A
US-2019293506-A1
NO-20131747-A1
WO-2019027779-A1
CN-107646212-A
US-130700-A
DE-174033-C
DE-19921957-A1
DE-463858-C
US-2705444-A
JP-S62503005-A
DE-102020117911-A1
AU-469006-B2
EP-2806724-B1
CN-106717208-B
KR-20160100456-A
CN-108739019-A
HU-217598-B
EP-3474651-C0
GB-1002382-A
ZA-785458-B
DE-102017102683-A1
SE-353998-B
NL-299535-A
US-2020265368-A1
JP-S5491405-A
AT-265728-B
BE-727862-A
US-397964-A
CN-112544146-B
US-2010018726-A1
CN-111602481-A
BR-0003393-B1
FR-323547-A
FR-2430171-A1
US-2020272317-A1
US-2008006417-A1
DE-339896-C
US-10509872-B2
CN-103988620-A
KR-102188821-B1
NL-16051-C
HU-184217-B
US-2022067121-A1
CN-107873154-A
US-2306127-A
DE-19627139-A1
CA-3123131-A1
CN-114097326-A
US-2598959-A
US-2008196373-A1
CA-2945250-A1
US-530054-A
DE-8504302-U1
US-5065475-A
US-2422729-A
US-4046203-A
WO-2020089306-A1
US-5721679-A
CN-107094377-A
CN-108142464-A
KR-102033446-B1
US-89634-A
US-10448567-B2
US-8504252-B2
KR-100626846-B1
CN-108848735-A
AU-4162878-A
CN-115226430-A
BE-438953-A
CA-2093053-C
CA-3126968-A1
ZA-808003-B
NL-1018526-C2
CN-107087450-A
US-231306-A
FR-960102-A
KR-200487998-Y1
CN-107810675-A
AU-2002301383-B2
US-11175254-B2
US-2473800-A
EP-4342275-A1
US-3817333-A
AT-6595-U1
PL-3598883-T3
US-284062-A
IT-MI991367-A0
CN-111512896-A
US-2019246546-A1
US-5467830-A
CN-108770406-A
KR-102593393-B1
CN-109168379-A
US-5845717-A
CN-105474114-A
KR-20080056437-A
US-742202-A
CN-108668530-B
DE-266684-C
US-695218-A
US-1471180-A
US-2018209516-A1
US-3120281-A
AU-4190785-A
CN-104893740-A
DE-102012211931-B4
AU-500113-B2
US-2857724-A
WO-2024059300-A1
DE-463197-C
US-8807236-B2
US-220177-A
FR-2687535-A1
US-3963079-A
NO-954475-D0
AU-7308996-A
CN-109005687-A
DE-102013111426-A1
US-1041227-A
CN-112292948-B
IT-8519066-A1
CN-104942542-B
CA-3054065-C
CN-106718602-A
KR-200149462-Y1
CA-3086121-A1
CN-115069749-B
US-2023121291-A1
CN-107197630-A
US-8991274-B2
US-694931-A
NL-1020593-C2
US-527362-A
BR-202019001969-U2
CN-109328501-A
US-343554-A
IT-1173024-B
EP-2020169-B1
CN-108307750-A
CN-109287155-A
CN-106034445-A
CN-109105113-A
US-2021289723-A1
FR-508965-A
GR-3022378-T3
KR

2025-01-16 03:11:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:11:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:11:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:11:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 58
2025-01-16 03:11:40 - snowflake.connector.connection - INFO - closed
2025-01-16 03:11:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:11:41 - root - INFO - SQL:
SELECT DISTINCT SUBSTRING(t."filing_date"::STRING, 1, 4) AS "filing_year"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A01B3%' AND t."filing_date" IS NOT NULL
   LIMIT 1000;
Results:
filing_year
1948
1983
1978
2001
1987
1955
1976
1901
2005
1950
2009
2013
1951
2002
1934
2020
1925
1926
2010
1920
2021
1912
1960
2006
1904
1975
0
1996
2004
2011
1954
1973
2018
2016
2015
2012
2000
1974
1913
1997
1982
2022
1935
2017
1967
1918
1991
1979
1981
1980
1931
2019
2023
1993
1985
1947
1969
1956

2025-01-16 03:11:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:11:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:11:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:11:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-01-16 03:11:42 - snowflake.connector.connection - INFO - closed
2025-01-16 03:11:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:11:43 - root - INFO - SQL:
SELECT DISTINCT t."country_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::STRING LIKE '%A01B3%'
    LIMIT 1000;
Results:
country_code
HU
JP
AU
BE
CA
IT
NL
AT
IL
RU
US
DE
GB
PL
KR
EP
ZA
NO
CN
FR

2025-01-16 03:11:43 - root - INFO - itercount: 0
2025-01-16 03:11:43 - root - INFO - Database Name: PATENTS
Schema Name: PATENTS
DDL describes table information.
,0
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,1
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""spif_publication_number"" VARCHAR(16777216),
	""spif_application_number"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""claims_localized_html"" VARIANT,
	""description_localized"" VARIANT,
	""description_localized_html"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""locarno"" VARIANT,
	""citation"" VARIANT,
	""parent"" VARIANT,
	""child"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,2
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
**Relevant Table:**

- **Table Name:** `PUBLICATIONS`  
  **Database:** `PATENTS`  
  **Schema:** `PATENTS`

**Relevant Columns and Potential Usage:**

- **"cpc"**: Contains CPC classification codes; used to filter patents belonging to class 'A01B3'.
- **"assignee"**: Contains assignee information; extract assignee names to identify and count applications per assignee.
- **"assignee_harmonized"**: Contains standardized assignee names; useful for aggregating data across different name variations.
- **"filing_date"**: Filing date of the patent application; extract the year to determine the year with the most applications.
- **"country_code"**: Country code of the application; used to identify the country with the most applications.
- **"publication_number"**: Unique identifier for each patent publication; used for reference if needed.

**Conditions That May Be Used:**

- Filtering records where the CPC classification includes 'A01B3'.
- Extracting the year from the "filing_date" column.
- Flattening VARIANT columns ("cpc", "assignee", "assignee_harmonized") to access nested data.
- Handling NULL or missing values appropriately.

---

Below are 10 simple, short, non-nested SQL queries to understand values in related columns:

1. **Retrieve distinct CPC codes to understand their format:**

   ```sql
   SELECT DISTINCT f.value::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   LIMIT 1000;
   ```

2. **List distinct filing dates to examine date formats:**

   ```sql
   SELECT DISTINCT t."filing_date"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   WHERE t."filing_date" IS NOT NULL
   LIMIT 1000;
   ```

3. **Extract filing years from filing dates:**

   ```sql
   SELECT DISTINCT SUBSTRING(t."filing_date"::STRING, 1, 4) AS "filing_year"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   WHERE t."filing_date" IS NOT NULL
   LIMIT 1000;
   ```

4. **Retrieve distinct country codes:**

   ```sql
   SELECT DISTINCT t."country_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 1000;
   ```

5. **Extract assignee names from the "assignee" column:**

   ```sql
   SELECT DISTINCT f.value:"name"::STRING AS "assignee_name"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee") f
   WHERE f.value:"name" IS NOT NULL
   LIMIT 1000;
   ```

6. **Extract standardized assignee names from "assignee_harmonized":**

   ```sql
   SELECT DISTINCT f.value:"name"::STRING AS "assignee_harmonized_name"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") f
   WHERE f.value:"name" IS NOT NULL
   LIMIT 1000;
   ```

7. **Find publication numbers associated with CPC code 'A01B3':**

   ```sql
   SELECT DISTINCT t."publication_number"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A01B3%'
   LIMIT 1000;
   ```

8. **List assignee names for patents classified under 'A01B3':**

   ```sql
   SELECT DISTINCT f_assignee.value:"name"::STRING AS "assignee_name"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f_cpc,
   LATERAL FLATTEN(input => t."assignee") f_assignee
   WHERE f_cpc.value::STRING LIKE '%A01B3%' AND f_assignee.value:"name" IS NOT NULL
   LIMIT 1000;
   ```

9. **Retrieve filing years for patents classified under 'A01B3':**

   ```sql
   SELECT DISTINCT SUBSTRING(t."filing_date"::STRING, 1, 4) AS "filing_year"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A01B3%' AND t."filing_date" IS NOT NULL
   LIMIT 1000;
   ```

10. **List country codes for patents classified under 'A01B3':**

    ```sql
    SELECT DISTINCT t."country_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::STRING LIKE '%A01B3%'
    LIMIT 1000;
    ```

---

**Notes:**

- **Handling VARIANT Columns:** The columns "cpc", "assignee", and "assignee_harmonized" are of VARIANT data type, which may contain JSON arrays or objects. The `LATERAL FLATTEN` function is used to iterate over these structures.
- **Extracting Nested Values:** To access specific keys within the VARIANT columns, the syntax `f.value:"key_name"::STRING` is used.
- **Filtering Conditions:** The `LIKE '%A01B3%'` condition is used to find records where the CPC code includes 'A01B3'. Adjustments may be needed based on the exact structure of the CPC codes.
- **Date Handling:** The filing date is assumed to be in a format from which the year can be extracted using `SUBSTRING`. If the date format differs, date functions may be required.
- **Limiting Results:** Each query includes `LIMIT 1000` to restrict the number of rows returned for examination.

By running these queries, one can gain an understanding of how the relevant data is structured and how to access the necessary information for further analysis.Query:
SELECT DISTINCT f.value::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   LIMIT 1000;
Answer:
Too long, hard cut:
cpc_code
"{""code"":""G02B7/16"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""H04N23/66"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""Y02A50/30"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61P31/18"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K31/506"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H04B1/1036"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G11B2005/0002"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""H01H9/161"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G01D3/022"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G11B7/0945"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B29C65/524"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""B29C66/721"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01L23/48"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""B41J2/04581"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G11C7/12"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""G01B11/2522"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61M25/01"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61P31/16"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H03K19/17764"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""D04H1/407"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""F05D2260/30"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""C08K5/52"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G06N10/40"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""H02K3/18"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01Q9/045"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A23C21/02"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""B41J25/3088"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""C07D311/12"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A01G5/06"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B60R21/20"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B29C53/063"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B65D63/08"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61L2/18"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""G09F23/105"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G06N20/00"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61K35/32"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""F02B37/14"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B01D2257/702"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""H01M2010/4278"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G08G1/161"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A47C7/282"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H04N17/04"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G05B19/4185"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B60L2240/80"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B8/06"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01L24/83"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""H01L2224/05184"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A44C5/145"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G02B27/144"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""D06M13/368"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G07C9/00309"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01H51/2254"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""F16B33/008"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K39/4613"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G09F2013/222"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G03B2205/0015"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""C22C38/48"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H04B1/04"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61J7/0076"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G02B6/4467"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G06F3/0619"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""H04N23/672"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""H04N23/951"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""E04B2/763"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H04M2250/02"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G06F2212/281"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G02F1/13394"",""first"":true,""inve
Query:
SELECT DISTINCT t."filing_date"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   WHERE t."filing_date" IS NOT NULL
   LIMIT 1000;
Answer:
Too long, hard cut:
filing_date
20191106
20200203
20200522
19961122
20010716
19940307
19660908
20090709
19870302
19720621
19791227
19850726
20180430
20180829
19851014
19830303
20180827
19700605
19531130
19700720
19541229
19250406
19120425
19721106
19660112
19050605
19280730
19660103
19840106
19720801
19890110
19340616
19471029
19680102
19700916
19940620
19871127
19911205
19911015
19981130
20010426
20011001
20010724
20030527
20051207
20060403
20070105
20070620
20080303
20080902
20090909
20100909
20110401
20131008
20001006
20020329
20030926
20090619
20231214
20070608
19130811
20230608
19981016
20050314
20051226
20060914
20111220
20160801
20150327
20041104
20080815
20090206
20090506
20120918
20121102
20070611
20101117
19920617
19850729
19710821
19900917
20030822
20070404
20091016
20100621
20110127
20180313
20200611
19970206
20210207
20220122
20210516
20220914
20221122
20230530
20230719
19800923
20030827
19740220
20111129
20040901
20230824
19920909
19990511
20121002
19840704
20110513
20030730
20070905
20160709
20220201
20130819
20160323
20221128
20010402
19650930
19790306
19051023
19920117
19971014
19900123
19770325
19800418
19860314
19810413
19820817
20151231
19790330
19930726
20150520
20020807
20091106
20160502
19990812
20151127
20050124
19770421
19710719
19690321
19640720
19240221
19750110
19950606
19840111
19080227
19450709
19200624
19251211
19900118
19860122
19770216
19780404
19810515
19221125
19930331
19370405
19940225
20080818
19740725
20080426
19980611
19690103
19890401
20190610
20170125
20160411
19770914
19750922
19820911
19880802
19840822
19910726
19980729
20100225
20100922
20121220
19841005
20090213
19870514
19920106
20080116
19721003
19741213
19890812
19910722
19871204
19960507
20110201
20221023
20240311
19700504
19891127
19890817
19980423
20220306
19810116
20010417
20020927
20220204
19080707
20110214
20100907
19510202
19500627
19591124
19570321
19640203
19391103
19321010
19540907
20070102
19050322
19790329
19600603
19840117
19710203
19571230
19660329
19631011
19910226
20020330
20180706
20140810
19840210
20001216
19860707
20000311
19680918
19771014
19741111
19791217
19630730
19570622
19760112
19700523
20210627
19660723
20030107
19810206
19850903
20150515
19890227
19450414
19360518
19180827
19530623
19030801
18970621
19611220
19720107
19330505
19160821
19640113
19590629
19911008
19861114
19871208
19901002
19850517
19890801
19910926
20050911
20070726
20090824
20140708
20170923
19370507
19140608
19200520
19670419
19880423
20120507
19841211
20001007
19900804
20200525
20150419
19900820
19430412
19190821
19570704
19780324
19810918
20200125
19620712
19790714
19160408
19211015
19301004
19470604
19550419
19661220
19170811
19160517
19610825
19790115
19490620
19290305
19680108
19540329
19190121
19661207
19830329
19890616
19120302
19131010
19520703
19580117
19070323
19370421
19651108
19410524
19110526
19571119
19121009
19320831
19820809
19490715
19250921
19590820
19760405
19851022
19940805
19751106
19340914
19471212
19390223
19411006
19590224
19380831
19710907
19020912
19230310
19250112
19621212
19580507
19571206
19720119
19640320
19470408
19881101
19880425
19930827
19691219
19820505
19640709
19870214
19910829
19880919
20180617
19930109
19830625
19870608
19480911
19131021
19500925
19580520
19110209
19401108
19630312
19410227
19701110
19160724
19580107
19760325
20060729
20151106
20140626
20150921
20180529
20190716
20200225
20210322
19970521
20161230
19900419
19791126
19920827
19841109
19881004
19941129
20200430
20030430
20031217
20060523
20061110
20100924
19830902
19871016
20011022
20010507
20211215
20211217
20220414
20230131
20230829
20230919
20231016
20231031
20240108
20020708
19930525
20051122
20001222
19840523
19901204
19941014
19890511
20130222
19770610
20030415
19840215
20091102
20040122
20001009
20110708
19330902
19280807
19380725
19411222
19221010
19091102
19740930
19620620
19300916
20051115
19690618
18921230
19720606
19691216
19371029
19391013
19611130
19820126
19671003
20000906
19641221
19710419
19361205
19840911
20190228
20200605
20140606
20000202
19830131
20050701
19690723
20110530
19990618
19930924
19920408
19910920
19800908
20180227
20220714
19750703
20230929
20031110
20131031
19670318
19750705
20190207
20130118
20160617
20100309
20050711
20160324
20220404
20161012
20201120
20030621
19960719
19400111
20131205
19661025
20000216
20210901
20170427
20180817
20170921
19781009
19881109
19921021
20091218
19930629
20101224
20110407
20151002
20020709
20040405
19751014
19741126
19850912
19870929
20031212
20010615
20070907
20210120
19960423
19781028
19801022
20021119
20010828
19850429
19750331
20110218
20110927
20070504
20160602
20060925
19820701
19741211
19760316
19860403
19650326
19630225
20020125
19910508
19580128
19321125
19530814
19810306
19800208
19730213
19910225
19850228
19960717
19100411
19101028
19120902
19710401
19820325
19660927
19960710
19291212
19320311
19750822
19660105
19910218
19760513
19880309
19660624
19900316
19800522
19990318
19840420
20240510
19850702
20110309
20170822
20140731
20190227
20061013
20050819
19
Query:
SELECT DISTINCT SUBSTRING(t."filing_date"::STRING, 1, 4) AS "filing_year"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   WHERE t."filing_date" IS NOT NULL
   LIMIT 1000;
Answer:
filing_year
2015
2016
2018
1983
1978
1898
1949
1887
2012
2000
1907
1905
1885
1904
1846
1942
1908
1881
1936
1948
2013
1951
1992
1910
2010
2024
1926
1924
2014
1963
1952
1920
1928
1940
1995
1912
1930
1922
1889
1994
1986
1993
1985
1890
2021
1968
2017
1935
2003
1956
2009
1998
1950
1933
1927
1981
1999
1980
1979
1892
1997
1880
1996
0
1953
1938
1964
1947
1906
1900
1969
1909
1929
2005
1945
1972
1960
1911
1895
2006
1903
1937
1923
1886
2019
2023
1899
1931
1988
1976
1955
1901
2008
1946
1915
1967
1939
1944
1867
1991
1921
1914
2020
2002
1934
1916
1925
1917
1970
1941
1971
1943
1896
1860
2011
2004
1989
1966
1877
2001
1882
1957
1894
1932
1962
1897
1918
1987
1974
2007
1961
1913
1975
1959
1919
1902
1893
1965
1982
1891
2022
1984
1990
1958
1853
1977
1888
1973
1954
1883
Query:
SELECT DISTINCT t."country_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 1000;
Answer:
country_code
DO
BA
RS
WO
CR
PL
EP
ZA
MY
CS
LV
HR
AU
CU
RO
KR
PT
NZ
CL
NO
HU
JP
DZ
NL
LT
UA
MW
IT
OA
CY
CZ
HN
SV
CH
TR
BG
AT
YU
ZM
MD
ZW
MA
GB
SG
EG
PA
CO
SI
AR
KE
FI
DK
CA
SK
IS
NI
US
PH
DE
DD
MX
EE
GE
HK
TN
GT
BR
ID
LU
GR
RU
JO
IN
EC
SA
MN
SU
FR
PE
KZ
IL
TW
MT
BE
SE
AP
SM
ME
EA
ES
IE
CN
MC
Query:
SELECT DISTINCT t."publication_number"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") f
WHERE f.value:"code"::STRING LIKE 'A01B3%'
LIMIT 1000;
Answer:
publication_number
BE-826346-A
PL-440426-A1
EP-3474651-C0
DE-102017102683-A1
CN-114916261-A
CN-108575125-A
KR-102484290-B1
US-159642-A
FR-508965-A
CA-2977468-A1
US-1545136-A
AT-A720679-A
CN-104040083-B
KR-101169320-B1
US-10375891-B2
US-5267618-A
KR-200473688-Y1
CN-107072143-A
FR-2943502-A1
US-5407014-A
US-1860534-A
KR-20070101567-A
GB-792883-A
JP-6998053-B2
JP-S6342702-Y2
BE-872468-A
US-2784656-A
AU-2016269849-A1
BE-727862-A
US-1412308-A
KR-101378314-B1
US-3054462-A
GB-436304-A
AU-7115874-A
CN-108289407-A
CA-3089518-A1
CN-106973572-B
DE-463858-C
CN-113796181-A
US-130700-A
CN-107646212-A
KR-20020000597-A
BE-1007083-A5
US-1636048-A
US-376176-A
US-395573-A
US-231385-A
KR-102593393-B1
US-5845717-A
US-2597821-A
DE-102010019819-B4
CN-105325075-A
KR-200194260-Y1
GB-2089182-B
CN-115362764-A
KR-101593221-B1
KR-100626846-B1
ZA-808003-B
KR-200487998-Y1
FR-960102-A
CN-109392332-A
CN-116671357-A
CN-114651538-A
US-469659-A
KR-20010029583-A
GB-2039201-B
NO-153631-B
DE-829523-C
IL-268624-A
CN-100366901-C
KR-20130063834-A
DE-1963184-U
DE-140654-C
CN-113761309-A
US-2024164239-A1
US-1471180-A
CA-2945250-A1
US-3963079-A
IT-8519066-A1
CN-109005687-A
KR-200149462-Y1
US-694931-A
DE-8707829-U1
FR-2287837-B1
NL-183071-C
US-3129772-A
US-1081539-A
US-2545590-A
US-501724-A
IT-1064821-B
US-290366-A
HU-E050035-T2
KR-200386017-Y1
RU-191537-U1
US-2039702-A
JP-6910281-B2
US-5669452-A
GB-2090713-B
US-2888084-A
CA-2543900-A1
US-2019324472-A1
US-2031188-A
KR-900006618-B1
US-1093294-A
IT-1166526-B
NL-7909063-A
GB-2598141-A
AU-2002301383-B2
US-828171-A
GB-696973-A
NO-910950-L
EP-3586579-A1
CA-997451-A
KR-20020067218-A
US-2843032-A
KR-100191418-B1
US-220177-A
US-530054-A
CN-107094377-A
Query:
SELECT DISTINCT f.value:"name"::STRING AS "assignee_harmonized_name"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") f
   WHERE f.value:"name" IS NOT NULL
   LIMIT 1000;
Answer:
Too long, hard cut:
assignee_harmonized_name
MATHIAS STREIFF A G
TERRY WILLIAM BLAKE
BRAMMER TRANSMISSIONS
ESSELTE PENDAFLEX CORP
ROBINSON FREEMAN C
ANDRE STRAHM
EXXON RESEARCH ENGINEERING CO
MAGNETI MARELLI SPA
KIMBERLY CLARK CO
PEUGEOT
WAKER WILLIAM FRANK
JENSEN ANDREW
TOLBERT C BUSHONG
SCHLUMBERGER PROSPECTION
NIHON PARKERIZING
V H P J BRANCART & ZN NV
ZEISS CARL SOC
NIPPON PETROCHEMICALS CO LTD
HEWLETT PACKARD DEVELOPMENT CO LP
BANGRATZ PABLO
AZURITY PHARMACEUTICALS INC
HELSINN HEALTHCARE SA
PEREZ BENOIT
LOTUSGRILL GMBH
BEHJAT ABDOLREZA
FIBICS INCORPORATED
MERCHANT DAMON C
MARIJNISSEN KEES
YAMAGAMI HIDEHISA
PYO CHEOL SIG
NICHIA CORP
BRUKER BIOSPIN AG
WELSH WALTER THOMAS
STEEB CURT ANDREW
SOKOLOFSKY PHILLIP M
PRESCIENT MEDICAL INC
NAISBY ANDREW
NOVADAQ TECHNOLOGIES INC
METAL IND RES & DEV CT
GIANELO ANGELO
WONDERLAND NURSERY GOODS
GO DADDY GROUP INC
PIONEER TOHOKU CORP
NIEH SHIN-YU
TAIWAN SEMICONDUCTOR MFG
WULFF CHRISTIAN
FRANCHET JEAN-MICHEL PATRICK MAURICE
AJINOMOTO KK
BETTS STEPHEN N
THORNEYCROFT JAMES BAIRD
NISSEI ELECTRIC
JOHNSON M D A
ADIDAS SPORTSCHUHE
ANKARCRONA FREDRIK
BIOTEKNIKA INTERNATIONAL
O M KENKYUSHO KK
HUGERSHOFF REINHARD
ASEA AB
SKODA ENTREPRISE NATIONALE ETS
HOOVER LTD
CHARLES DEGOUD
UNIV GLASGOW
HOWARD THOMAS THORNTON
HOHNEN OIL
GLORY KOGYO KK
ARKRAY INC
SHADECRAFT INC
SONOS INC
CHR HANSEN AS
HESTAN COMMERCIAL CORP
ROCKWOOL INT
NOVALEAD PHARMA INC
MIYAGAWA TAKUMI
KIOXIA CORP
ST MICROELECTRONICS CROLLES 2 SAS
TECHNION RES & DEV FOUNDATION
VIAVI SOLUTIONS INC
KOYO MUSEN CORP
UNITYPE COMPANY
CHO DAE GUN
TSA CO LTD
LEE SAE RYONG
ISORG
ACCELERON PHARMA INC
WAYS1 INC
JIN LI
INST COMPUTING TECH CN ACADEMY
NIPPON KOGAKU KK
FUZHOU SIMAIT DIGITAL TECHNOLO
CHINA PETROCHEMICAL DEV CORP
MINGLIANG LI
YONGCHANG ZHANG
ELECTRIC AVENUE SOFTWARE INC
MOORE CALEB MICHAEL
UNIV TECHNOLOGICZNO-HUMANISTYCZNY IM KAZIMIERZA PUÅASKIEGO W RADOMIU
MAGE GEHRING GMBH VOELKERMARKT
VNII GELIEEVOJ TECH
MURILLO HERNANDO
TRT LUCENT TECHNOLOGIES SA
ANTERIS TECH CORPORATION
ST MICROELECTRONICS ROUSSET
UNIV ALBERT LUDWIGS FREIBURG
NEXION SPA
PETROLEO BRASILEIRO SA PETROBRAS
HEFEI MIDEA REFRIGERATOR CO
SHENZHEN ROYOLE TECHNOLOGIES CO LTD
WANGSU SCIENCE & TECH CO LTD
SERVIER LAB
ENDOGENX INC
ACTIVEVIDEO NETWORKS INC
AGCO DO BRASIL SOLUCOES AGRICOLAS LTDA
FWP IP APS
PANASONIC ECO SYS GUANGDONG CO
XU YINGQI
ZHANG HUANHUAN
INAGAKI NOBUAKI
INFOSEIZE SYSTEMS CO LTD
NIKE INC
SMART HUB PTE LTD
TAMURA SHUICHI
TRIANGLE TYRE CO LTD
ELITE FUELS LLC
UNIV MASSACHUSETTS
SUBARU CORP
NEC LAB AMERICA INC
TAMINCO N V
FLEXOPACK S A PLASTICS IND
JOHNSON & JOHNSON SURGICAL VISION INC
ETAT FINLANDAIS
ZIMMER GUENTHER
ATOMA INT INC
BREE JOAN MARY
COURTAULDS FILMS HOLDINGS
MONTALTI MIRKO
PROCOMAS S R L
IND NATUZZI
ARDITI
KUMSUNG MEDICAL INSTR CO LTD
I P A IND PLASTICA ADRIA DI CHENDI BRUNO &
TRUMPF PHOTONICS INC
TONGHUA DEJI GINSENG PHARMACEUTICAL CO LTD
NO 923 HOSPITAL JOINT LOGISTICS SUPPORT FORCE OF THE CHINESE PEOPLES LIBERATION ARMY
JIANGSU EASTMAN HEAVY MACHINERY CO LTD
HUAIBEI ZHUOCHUANG TECH SERVICE CO LTD
U PROTEC SHENZHEN TECH CO LTD
SHENZHEN RADIUM BRIGHT SCIENCE AND TECH CO LTD
DONGGUAN YUYI AUTOMATION EQUIPMENT LTD COMPANY
TAICANG LIANGSHENG RUBBER CO LTD
GUANGODNG YIKANGSHENG ENVIRONMENTAL PROTECTION TECH CO LTD
LIANYUNGANG JINCHEN IND CO LTD
SHANDONG HUANNENG DESIGN INST CO LTD
MAIHAI SUZHOU ENVIRONMENTAL PROTECTION TECH CO LTD
ZHAO JUNFENG
XINFENG COANDA ELECTRONIC CO LTD
SHENZHEN CHUANGYITONG TECH CO LTD
SIHONGXIN MACHINE CASTING CO LTD
HANGZHOU BOSS ELECTRIC APPLIANCE CO LTD
HEILONGJIANG HELIANG AGRICULTURE CO LTD
LI HUI
BAODING RAKANG SAUSAGE CASING PROC LIMITED COMPANY
HUNAN SANY MEDIUM LIFTING MACHINERY CO LTD
CHANZHOU ZHENYOU ELECTRICAL APPLIANCE LTD COMPANY
JIANGSU HONGBANMA NEW MATERIAL TECH CO LTD
BATTELLE ENERGY ALLIANCE LLC
SOLID INC
TG3D STUDIO
VELCRO IP HOLDINGS LLC
MATSUMOTO AYAKA
LIXIL SUZUKI SHUTTER CORP
EMPRESSA NAC DE MINERIA ENAMI
XIAMEN CHANGELIGHT CO LTD
LODZKA FAB MASZYN JEDWABNI
ALLEN GROUP
SANNER FRIEDR GMBH CO KG
SINGAPORE CHARTERED IND
BEHR GMBH & CO KG
SPATTI GIOVANNI
BOMBAY TEXTILE RES ASS BTRA
SUZUKI MASAMI
WOONGJIN CHEMICAL CO LTD
RIJK ZWAAN ZAADTEELT EN ZAADHANDEL BV
AGRUPADA INVEST OFF
PROEKTNO IZYSKATELSKIJ NII GID
VB AUTOBATTERIE GMBH
DATA POWER DEV LTD
GOTTUMUKKALA VENKATA SIVA RAMA KRISHNAM RAJU
VERDILE MONICA BEATRIZ
CONCORD GMBH
HEXEL GERHARD
GHSP INC
IRCCS AZIENDA OSPEDALIERA UNIVERSITARIA SAN MARTINO IST ISTITUTO NAZ PER LA RICERCA SUL CANCRO
LAMB SRL
INFECTIOUS DISEASE RES INST
SPRINT BIOSCIENCE AB
KHMAENC CO
SCINTOMICS GMBH
ZIMMER INC
BEXSON BIOMEDICAL INC
HEFEI CAS LANRUI TECH CO LTD
BUESCH BERND
IVANOVA TATYANA P
WILLIAM D ALTON
GUILD LEIGH S
THEODORE DAVID T
BOLOIT IRON WORKS
THOMAS HYDRAULIC SPEED COUTROL
CARSON WILLIAM
HENRY DREYFUS
BARTH W
REED TOOL CO
YORK FOOD MACHINERY CO
MAUD CHARLES EDWARD
HORTON JAMES ALEXANDER
MCKAY JOHN A
VMW RANSHOFEN BERNDORF AG
GARVIE HERBERT THOMPSON
BEMIS BROS BAG COMPANY
HAAKER WILLIAM
DONGGUAN POLYMERS NEW MATERIAL TECH CO LTD
NINGGUO RUIPU SEALS CO LTD
XIAMEN BRANCH ZHONGSHA
Query:
SELECT DISTINCT t."publication_number"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A01B3%'
   LIMIT 1000;
Answer:
publication_number
KR-200473688-Y1
CN-107072143-A
DE-829523-C
BE-826346-A
PL-440426-A1
KR-101593221-B1
CA-2543900-A1
US-2888084-A
AU-7115874-A
CN-108289407-A
CA-3089518-A1
CN-106973572-B
KR-200149462-Y1
US-694931-A
KR-102484290-B1
US-159642-A
BE-727862-A
US-1545136-A
AT-A720679-A
KR-100626846-B1
ZA-808003-B
KR-20020000597-A
BE-1007083-A5
US-2784656-A
AU-2016269849-A1
US-1412308-A
KR-101378314-B1
DE-463858-C
US-130700-A
CN-107646212-A
CN-113796181-A
FR-508965-A
CA-2977468-A1
AU-2002301383-B2
CN-114651538-A
KR-20010029583-A
US-469659-A
US-5669452-A
GB-2090713-B
KR-200194260-Y1
CA-2945250-A1
US-5407014-A
FR-2943502-A1
GB-2598141-A
NL-7909063-A
CN-109392332-A
CN-116671357-A
HU-E050035-T2
US-290366-A
US-1471180-A
GB-2039201-B
US-3963079-A
IT-8519066-A1
CN-109005687-A
IL-268624-A
CN-100366901-C
US-3129772-A
US-1081539-A
US-2545590-A
US-1636048-A
US-395573-A
US-376176-A
US-231385-A
US-828171-A
GB-696973-A
NO-910950-L
EP-3586579-A1
KR-20020067218-A
CA-997451-A
US-2843032-A
KR-100191418-B1
US-3054462-A
GB-2089182-B
CN-115362764-A
CN-114916261-A
CN-108575125-A
US-1860534-A
GB-792883-A
KR-20070101567-A
JP-6998053-B2
JP-S6342702-Y2
BE-872468-A
DE-1963184-U
DE-140654-C
CN-113761309-A
CN-104040083-B
KR-101169320-B1
US-10375891-B2
US-5267618-A
NO-153631-B
DE-8707829-U1
FR-2287837-B1
NL-183071-C
KR-20130063834-A
US-501724-A
IT-1064821-B
US-2024164239-A1
US-2039702-A
KR-200386017-Y1
RU-191537-U1
US-220177-A
GB-436304-A
KR-900006618-B1
US-2031188-A
US-2019324472-A1
US-1093294-A
IT-1166526-B
KR-200487998-Y1
FR-960102-A
EP-3474651-C0
DE-102017102683-A1
KR-102593393-B1
US-5845717-A
US-2597821-A
CN-105325075-A
DE-102010019819-B4
JP-6910281-B2
US-530054-A
CN-107094377-A
Query:
SELECT DISTINCT t."publication_number"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") f
WHERE f.value:"code"::STRING LIKE 'A01B%'
LIMIT 1000;
Answer:
Too long, hard cut:
publication_number
AU-7115874-A
HU-E035729-T2
CN-108289407-A
DE-36067-C
CN-106973572-B
CN-109479674-B
US-11006567-B2
CN-116616310-A
US-2022000025-A1
CN-113926843-A
US-1082418-A
CN-109196980-A
CA-3089518-A1
CN-108575125-A
US-1538757-A
CN-109565988-A
CH-628492-A5
CN-114916261-A
US-1860534-A
US-5381647-A
DE-102021124382-A1
JP-S6342702-Y2
BE-872468-A
KR-20070101567-A
US-324336-A
GB-792883-A
SE-138635-C1
JP-6998053-B2
US-2692544-A
EP-1052142-B1
JP-2021107200-A
CA-2289148-A1
WO-2022138070-A1
AU-2013336489-B2
CN-104040083-B
KR-20030082844-A
US-11122727-B2
RU-2748995-C1
CN-108713364-A
US-213489-A
KR-101378314-B1
US-1412308-A
US-906051-A
FR-1166846-A
CH-477151-A
AU-752424-B2
DE-1220745-B
CN-107926187-A
FR-76496-E
CN-1130978-A
DE-149474-C
EP-0182091-B1
US-483311-A
US-194108-A
CA-3115757-A1
AT-400376-B
CA-1212551-A
WO-2018172461-A1
KR-20040087849-A
CN-115250849-A
US-2021267119-A1
NO-153631-B
NL-104890-C
KR-101593221-B1
AU-6604598-A
CA-2619532-A1
CN-108934199-A
IE-42273-L
EP-1013159-A3
GB-955047-A
GB-2174586-A
WO-2021156301-A1
JP-2879109-B2
KR-101193641-B1
CA-2999865-A1
KR-20110056601-A
AU-2015261725-B2
KR-20160100455-A
NL-183071-C
ES-2439952-T3
US-2019369-A
CA-2509971-C
DE-8707829-U1
NL-169215-C
JP-WO2023127437-A1
FR-2287837-B1
CN-115152388-A
US-2296916-A
CA-2187954-A1
RU-205217-U1
BE-1007083-A5
KR-20020000597-A
CN-106961846-A
RU-2654632-C2
US-2784656-A
DE-102019211496-A1
DK-115221-B
AU-2016269849-A1
CN-114393023-A
CN-106508151-B
US-2017071123-A1
CN-105794484-A
JP-2022538873-A
US-2024164239-A1
CA-3135313-A1
EP-3987897-A1
CN-108007337-A
DE-602004005909-D1
AU-1586376-A
KR-101649538-B1
US-469659-A
CA-983309-A
KR-20010029583-A
MY-199404-A
ZA-833618-B
US-2017172080-A1
CN-107249320-B
US-308455-A
CN-108307721-A
GB-139227-A
EP-0509307-B1
US-3439748-A
CN-106385847-A
KR-200194260-Y1
RU-2605068-C1
US-363757-A
DE-10330382-B4
US-2309266-A
US-11197412-B2
KR-200473688-Y1
BR-112018016785-A2
DE-102019201915-A1
US-10743458-B2
US-365162-A
AU-2013251266-B2
CN-110622200-A
CN-107072143-A
KR-900006618-B1
WO-2023106920-A1
US-2019324472-A1
US-2031188-A
BR-102020017619-A2
US-1093294-A
US-478158-A
IT-1166526-B
US-552165-A
US-3129772-A
US-2545590-A
CA-2224233-C
DE-102004042897-A1
AU-8105682-A
US-1081539-A
CN-107455024-A
US-501724-A
CN-109644596-A
GB-9721775-D0
US-2269981-A
US-1047644-A
IT-1064821-B
KR-102484290-B1
AR-012600-A1
IT-AR20130016-A1
CA-2628292-C
US-502697-A
US-159642-A
CA-2199335-C
US-1272260-A
RU-186558-U1
KR-20090049368-A
KR-101965094-B1
US-2039702-A
KR-200386017-Y1
RU-191537-U1
AT-A73281-A
US-2020390021-A1
US-2023082447-A1
US-237772-A
CN-109673186-A
KR-200272944-Y1
GB-788016-A
FR-1341948-A
US-5267618-A
US-856916-A
AU-2018273793-A1
CH-389304-A
GB-436304-A
GB-676967-A
CA-2927387-A1
CN-109005697-B
US-292639-A
US-128588-A
FR-2159121-A5
US-1009439-A
EP-0266345-A1
DE-102019209613-A1
DE-84374-C
CA-2752207-A1
BE-826346-A
TR-17678-A
PL-440426-A1
DE-855174-C
US-2019146513-A1
US-379454-A
NZ-576650-A
CN-113796181-A
US-2019293506-A1
NO-20131747-A1
WO-2019027779-A1
CN-107646212-A
US-130700-A
DE-174033-C
DE-19921957-A1
DE-463858-C
US-2705444-A
JP-S62503005-A
DE-102020117911-A1
AU-469006-B2
EP-2806724-B1
CN-106717208-B
KR-20160100456-A
CN-108739019-A
HU-217598-B
EP-3474651-C0
GB-1002382-A
ZA-785458-B
DE-102017102683-A1
SE-353998-B
NL-299535-A
US-2020265368-A1
JP-S5491405-A
AT-265728-B
BE-727862-A
US-397964-A
CN-112544146-B
US-2010018726-A1
CN-111602481-A
BR-0003393-B1
FR-323547-A
FR-2430171-A1
US-2020272317-A1
US-2008006417-A1
DE-339896-C
US-10509872-B2
CN-103988620-A
KR-102188821-B1
NL-16051-C
HU-184217-B
US-2022067121-A1
CN-107873154-A
US-2306127-A
DE-19627139-A1
CA-3123131-A1
CN-114097326-A
US-2598959-A
US-2008196373-A1
CA-2945250-A1
US-530054-A
DE-8504302-U1
US-5065475-A
US-2422729-A
US-4046203-A
WO-2020089306-A1
US-5721679-A
CN-107094377-A
CN-108142464-A
KR-102033446-B1
US-89634-A
US-10448567-B2
US-8504252-B2
KR-100626846-B1
CN-108848735-A
AU-4162878-A
CN-115226430-A
BE-438953-A
CA-2093053-C
CA-3126968-A1
ZA-808003-B
NL-1018526-C2
CN-107087450-A
US-231306-A
FR-960102-A
KR-200487998-Y1
CN-107810675-A
AU-2002301383-B2
US-11175254-B2
US-2473800-A
EP-4342275-A1
US-3817333-A
AT-6595-U1
PL-3598883-T3
US-284062-A
IT-MI991367-A0
CN-111512896-A
US-2019246546-A1
US-5467830-A
CN-108770406-A
KR-102593393-B1
CN-109168379-A
US-5845717-A
CN-105474114-A
KR-20080056437-A
US-742202-A
CN-108668530-B
DE-266684-C
US-695218-A
US-1471180-A
US-2018209516-A1
US-3120281-A
AU-4190785-A
CN-104893740-A
DE-102012211931-B4
AU-500113-B2
US-2857724-A
WO-2024059300-A1
DE-463197-C
US-8807236-B2
US-220177-A
FR-2687535-A1
US-3963079-A
NO-954475-D0
AU-7308996-A
CN-109005687-A
DE-102013111426-A1
US-1041227-A
CN-112292948-B
IT-8519066-A1
CN-104942542-B
CA-3054065-C
CN-106718602-A
KR-200149462-Y1
CA-3086121-A1
CN-115069749-B
US-2023121291-A1
CN-107197630-A
US-8991274-B2
US-694931-A
NL-1020593-C2
US-527362-A
BR-202019001969-U2
CN-109328501-A
US-343554-A
IT-1173024-B
EP-2020169-B1
CN-108307750-A
CN-109287155-A
CN-106034445-A
CN-109105113-A
US-2021289723-A1
FR-508965-A
GR-3022378-T3
KR
Query:
SELECT DISTINCT SUBSTRING(t."filing_date"::STRING, 1, 4) AS "filing_year"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A01B3%' AND t."filing_date" IS NOT NULL
   LIMIT 1000;
Answer:
filing_year
1948
1983
1978
2001
1987
1955
1976
1901
2005
1950
2009
2013
1951
2002
1934
2020
1925
1926
2010
1920
2021
1912
1960
2006
1904
1975
0
1996
2004
2011
1954
1973
2018
2016
2015
2012
2000
1974
1913
1997
1982
2022
1935
2017
1967
1918
1991
1979
1981
1980
1931
2019
2023
1993
1985
1947
1969
1956
Query:
SELECT DISTINCT t."country_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::STRING LIKE '%A01B3%'
    LIMIT 1000;
Answer:
country_code
HU
JP
AU
BE
CA
IT
NL
AT
IL
RU
US
DE
GB
PL
KR
EP
ZA
NO
CN
FR
End Exploring Related Columns
Task: For patent class A01B3, I want to analyze the information of the top 3 assignees based on the total number of applications. Please provide the following five pieces of information: the name of this assignee,  total number of applications, the year with the most applications, the number of applications in that year, and the country code with the most applications during that year.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: SELECT S."Column_Name" FROM {Database Name}.{Schema Name}.{Table_name} (ensure all column names are enclosed in double quotations)
Follow the answer format like: Below is the requested information in CSV format:

```csv
assignee_name,total_applications,year_with_most_applications,applications_in_that_year,country_code_with_most_applications_during_that_year
assignee_name:str,total_applications:int,year:int,applications_in_that_year:int,country_code:str
assignee_name:str,total_applications:int,year:int,applications_in_that_year:int,country_code:str
assignee_name:str,total_applications:int,year:int,applications_in_that_year:int,country_code:str
```

This table represents the top 3 assignees for patent class A01B3, along with the requested information. Since specific data is not provided, placeholder values with data types are used to indicate the nature of each field..
Here are some useful tips for answering:
When calculating distances between two geometries, use `ST_MakePoint(x, y)` to make a point and `ST_Distance(geometry1 GEOMETRY, geometry2 GEOMETRY)` to compute. No need to convert from meters to miles unless requested. Don't use Haversine like 2 * 6371000 * ASIN(...), use ST_DISTANCE for more precise results.
Please refrain from adding any conditions that are not explicitly specified in the task.
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'
Be careful one country may have different names in different columns in a database.
When handling TO_TIMESTAMP_NTZ conversions, use query like: SELECT CASE WHEN "date" >= 1e15 THEN TO_TIMESTAMP_NTZ("date" / 1000000) WHEN "date" >= 1e12 THEN TO_TIMESTAMP_NTZ("date" / 1000) ELSE TO_TIMESTAMP_NTZ("date") END AS parsed_timestamp FROM my_table;
Be careful of information in nested JSON columns. e.g.1. When it comes to active users, it refers to has engagement_time_msec parameter rather than directly counting users. So the right query is: SELECT DISTINCT USER_PSEUDO_ID FROM all_user_activity, LATERAL FLATTEN(input => event_params) AS flattened_params WHERE flattened_params.value:key = 'engagement_time_msec'
e.g. When it comes to top-selling product, you should pay attention to hits2.value:"eCommerceAction":"action_type"::INTEGER = 6 where 6 means sold product.
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When counting for rows of a column, ensure they are distinct: SELECT COUNT(DISTINCT col_name) FROM table;
Keep all decimals to four decimal places.

2025-01-16 03:12:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 03:12:32 - root - INFO - ```sql
WITH cte AS (
    SELECT 
        t."publication_number",
        t."filing_date",
        SUBSTRING(t."filing_date"::STRING, 1, 4) AS "filing_year",
        t."country_code",
        f_cpc.value:"code"::STRING AS "cpc_code",
        f_assignee.value:"name"::STRING AS "assignee_name"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."cpc") f_cpc,
         LATERAL FLATTEN(input => t."assignee") f_assignee
    WHERE f_cpc.value:"code"::STRING LIKE 'A01B3%'
),

top_assignees AS (
    SELECT 
        "assignee_name", 
        COUNT(DISTINCT "publication_number") AS total_applications
    FROM cte
    GROUP BY "assignee_name"
    ORDER BY total_applications DESC NULLS LAST
    LIMIT 3
),

assignee_year_counts AS (
    SELECT 
        "assignee_name",
        filing_year,
        COUNT(DISTINCT "publication_number") AS applications_in_that_year
    FROM cte
    WHERE "assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
    GROUP BY "assignee_name", filing_year
),

assignee_top_year AS (
    SELECT
        "assignee_name",
        filing_year AS year_with_most_applications,
        applications_in_that_year,
        ROW_NUMBER() OVER (PARTITION BY "assignee_name" ORDER BY applications_in_that_year DESC NULLS LAST) AS rn
    FROM assignee_year_counts
    WHERE filing_year IS NOT NULL
),

assignee_year_country_code AS (
    SELECT 
        c."assignee_name",
        c.filing_year,
        c."country_code",
        COUNT(DISTINCT c."publication_number") AS applications_in_country
    FROM cte c
    WHERE c."assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
    GROUP BY c."assignee_name", c.filing_year, c."country_code"
),

assignee_top_country AS (
    SELECT
        "assignee_name",
        filing_year,
        "country_code" AS country_code_with_most_applications_during_that_year,
        applications_in_country,
        ROW_NUMBER() OVER (PARTITION BY "assignee_name", filing_year ORDER BY applications_in_country DESC NULLS LAST) AS rn
    FROM assignee_year_country_code
    WHERE filing_year IS NOT NULL
),

final_result AS (
    SELECT
        ta."assignee_name",
        ta.total_applications,
        aty.year_with_most_applications,
        aty.applications_in_that_year,
        atc.country_code_with_most_applications_during_that_year
    FROM top_assignees ta
    JOIN assignee_top_year aty ON ta."assignee_name" = aty."assignee_name" AND aty.rn = 1
    JOIN assignee_top_country atc ON atc."assignee_name" = ta."assignee_name" AND atc.filing_year = aty.year_with_most_applications AND atc.rn =1
)

SELECT
    "assignee_name",
    total_applications,
    year_with_most_applications,
    applications_in_that_year,
    country_code_with_most_applications_during_that_year
FROM final_result;
```
2025-01-16 03:12:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:12:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:12:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:12:33 - snowflake.connector.connection - INFO - closed
2025-01-16 03:12:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:12:33 - root - INFO - itercount: 1
2025-01-16 03:12:33 - root - INFO - 000904 (42000): 01b9bdc0-0004-7b0f-0001-11c300c9d472: SQL compilation error: error line 28 at position 8
invalid identifier 'FILING_YEAR'
2025-01-16 03:12:33 - root - INFO - Input sql:
WITH cte AS (
    SELECT 
        t."publication_number",
        t."filing_date",
        SUBSTRING(t."filing_date"::STRING, 1, 4) AS "filing_year",
        t."country_code",
        f_cpc.value:"code"::STRING AS "cpc_code",
        f_assignee.value:"name"::STRING AS "assignee_name"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."cpc") f_cpc,
         LATERAL FLATTEN(input => t."assignee") f_assignee
    WHERE f_cpc.value:"code"::STRING LIKE 'A01B3%'
),

top_assignees AS (
    SELECT 
        "assignee_name", 
        COUNT(DISTINCT "publication_number") AS total_applications
    FROM cte
    GROUP BY "assignee_name"
    ORDER BY total_applications DESC NULLS LAST
    LIMIT 3
),

assignee_year_counts AS (
    SELECT 
        "assignee_name",
        filing_year,
        COUNT(DISTINCT "publication_number") AS applications_in_that_year
    FROM cte
    WHERE "assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
    GROUP BY "assignee_name", filing_year
),

assignee_top_year AS (
    SELECT
        "assignee_name",
        filing_year AS year_with_most_applications,
        applications_in_that_year,
        ROW_NUMBER() OVER (PARTITION BY "assignee_name" ORDER BY applications_in_that_year DESC NULLS LAST) AS rn
    FROM assignee_year_counts
    WHERE filing_year IS NOT NULL
),

assignee_year_country_code AS (
    SELECT 
        c."assignee_name",
        c.filing_year,
        c."country_code",
        COUNT(DISTINCT c."publication_number") AS applications_in_country
    FROM cte c
    WHERE c."assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
    GROUP BY c."assignee_name", c.filing_year, c."country_code"
),

assignee_top_country AS (
    SELECT
        "assignee_name",
        filing_year,
        "country_code" AS country_code_with_most_applications_during_that_year,
        applications_in_country,
        ROW_NUMBER() OVER (PARTITION BY "assignee_name", filing_year ORDER BY applications_in_country DESC NULLS LAST) AS rn
    FROM assignee_year_country_code
    WHERE filing_year IS NOT NULL
),

final_result AS (
    SELECT
        ta."assignee_name",
        ta.total_applications,
        aty.year_with_most_applications,
        aty.applications_in_that_year,
        atc.country_code_with_most_applications_during_that_year
    FROM top_assignees ta
    JOIN assignee_top_year aty ON ta."assignee_name" = aty."assignee_name" AND aty.rn = 1
    JOIN assignee_top_country atc ON atc."assignee_name" = ta."assignee_name" AND atc.filing_year = aty.year_with_most_applications AND atc.rn =1
)

SELECT
    "assignee_name",
    total_applications,
    year_with_most_applications,
    applications_in_that_year,
    country_code_with_most_applications_during_that_year
FROM final_result;
The error information is:
000904 (42000): 01b9bdc0-0004-7b0f-0001-11c300c9d472: SQL compilation error: error line 28 at position 8
invalid identifier 'FILING_YEAR'
Please correct it and output only 1 complete SQL query.When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'

2025-01-16 03:13:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 03:13:13 - root - INFO - ```sql
WITH cte AS (
    SELECT 
        t."publication_number",
        t."filing_date",
        SUBSTRING(t."filing_date"::STRING, 1, 4) AS "filing_year",
        t."country_code",
        f_cpc.value:"code"::STRING AS "cpc_code",
        f_assignee.value:"name"::STRING AS "assignee_name"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."cpc") f_cpc,
         LATERAL FLATTEN(input => t."assignee") f_assignee
    WHERE f_cpc.value:"code"::STRING LIKE 'A01B3%'
),

top_assignees AS (
    SELECT 
        "assignee_name", 
        COUNT(DISTINCT "publication_number") AS total_applications
    FROM cte
    GROUP BY "assignee_name"
    ORDER BY total_applications DESC NULLS LAST
    LIMIT 3
),

assignee_year_counts AS (
    SELECT 
        "assignee_name",
        "filing_year",
        COUNT(DISTINCT "publication_number") AS applications_in_that_year
    FROM cte
    WHERE "assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
    GROUP BY "assignee_name", "filing_year"
),

assignee_top_year AS (
    SELECT
        "assignee_name",
        "filing_year" AS year_with_most_applications,
        applications_in_that_year,
        ROW_NUMBER() OVER (PARTITION BY "assignee_name" ORDER BY applications_in_that_year DESC NULLS LAST) AS rn
    FROM assignee_year_counts
    WHERE "filing_year" IS NOT NULL
),

assignee_year_country_code AS (
    SELECT 
        c."assignee_name",
        c."filing_year",
        c."country_code",
        COUNT(DISTINCT c."publication_number") AS applications_in_country
    FROM cte c
    WHERE c."assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
    GROUP BY c."assignee_name", c."filing_year", c."country_code"
),

assignee_top_country AS (
    SELECT
        "assignee_name",
        "filing_year",
        "country_code" AS country_code_with_most_applications_during_that_year,
        applications_in_country,
        ROW_NUMBER() OVER (PARTITION BY "assignee_name", "filing_year" ORDER BY applications_in_country DESC NULLS LAST) AS rn
    FROM assignee_year_country_code
    WHERE "filing_year" IS NOT NULL
),

final_result AS (
    SELECT
        ta."assignee_name",
        ta.total_applications,
        aty.year_with_most_applications,
        aty.applications_in_that_year,
        atc.country_code_with_most_applications_during_that_year
    FROM top_assignees ta
    JOIN assignee_top_year aty ON ta."assignee_name" = aty."assignee_name" AND aty.rn = 1
    JOIN assignee_top_country atc ON atc."assignee_name" = ta."assignee_name" AND atc."filing_year" = aty.year_with_most_applications AND atc.rn =1
)

SELECT
    "assignee_name",
    total_applications,
    year_with_most_applications,
    applications_in_that_year,
    country_code_with_most_applications_during_that_year
FROM final_result;
```
2025-01-16 03:13:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:13:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:13:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:13:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-16 03:13:15 - snowflake.connector.connection - INFO - closed
2025-01-16 03:13:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:13:15 - root - INFO - itercount: 2
2025-01-16 03:13:15 - root - INFO - No data found for the specified query.

2025-01-16 03:13:15 - root - INFO - Input sql:
WITH cte AS (
    SELECT 
        t."publication_number",
        t."filing_date",
        SUBSTRING(t."filing_date"::STRING, 1, 4) AS "filing_year",
        t."country_code",
        f_cpc.value:"code"::STRING AS "cpc_code",
        f_assignee.value:"name"::STRING AS "assignee_name"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."cpc") f_cpc,
         LATERAL FLATTEN(input => t."assignee") f_assignee
    WHERE f_cpc.value:"code"::STRING LIKE 'A01B3%'
),

top_assignees AS (
    SELECT 
        "assignee_name", 
        COUNT(DISTINCT "publication_number") AS total_applications
    FROM cte
    GROUP BY "assignee_name"
    ORDER BY total_applications DESC NULLS LAST
    LIMIT 3
),

assignee_year_counts AS (
    SELECT 
        "assignee_name",
        "filing_year",
        COUNT(DISTINCT "publication_number") AS applications_in_that_year
    FROM cte
    WHERE "assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
    GROUP BY "assignee_name", "filing_year"
),

assignee_top_year AS (
    SELECT
        "assignee_name",
        "filing_year" AS year_with_most_applications,
        applications_in_that_year,
        ROW_NUMBER() OVER (PARTITION BY "assignee_name" ORDER BY applications_in_that_year DESC NULLS LAST) AS rn
    FROM assignee_year_counts
    WHERE "filing_year" IS NOT NULL
),

assignee_year_country_code AS (
    SELECT 
        c."assignee_name",
        c."filing_year",
        c."country_code",
        COUNT(DISTINCT c."publication_number") AS applications_in_country
    FROM cte c
    WHERE c."assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
    GROUP BY c."assignee_name", c."filing_year", c."country_code"
),

assignee_top_country AS (
    SELECT
        "assignee_name",
        "filing_year",
        "country_code" AS country_code_with_most_applications_during_that_year,
        applications_in_country,
        ROW_NUMBER() OVER (PARTITION BY "assignee_name", "filing_year" ORDER BY applications_in_country DESC NULLS LAST) AS rn
    FROM assignee_year_country_code
    WHERE "filing_year" IS NOT NULL
),

final_result AS (
    SELECT
        ta."assignee_name",
        ta.total_applications,
        aty.year_with_most_applications,
        aty.applications_in_that_year,
        atc.country_code_with_most_applications_during_that_year
    FROM top_assignees ta
    JOIN assignee_top_year aty ON ta."assignee_name" = aty."assignee_name" AND aty.rn = 1
    JOIN assignee_top_country atc ON atc."assignee_name" = ta."assignee_name" AND atc."filing_year" = aty.year_with_most_applications AND atc.rn =1
)

SELECT
    "assignee_name",
    total_applications,
    year_with_most_applications,
    applications_in_that_year,
    country_code_with_most_applications_during_that_year
FROM final_result;
The error information is:
 No data found for the specified query.
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'

2025-01-16 03:14:03 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 03:14:03 - root - INFO - ```sql
WITH cte AS (
    SELECT 
        t."publication_number",
        t."filing_date",
        CAST(SUBSTRING(t."filing_date"::STRING, 1, 4) AS INT) AS "filing_year",
        t."country_code",
        f_cpc.value:"code"::STRING AS "cpc_code",
        f_assignee.value:"name"::STRING AS "assignee_name"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."cpc") f_cpc,
         LATERAL FLATTEN(input => t."assignee") f_assignee
    WHERE f_cpc.value:"code"::STRING LIKE 'A01B3%'
          AND f_assignee.value:"name" IS NOT NULL
          AND t."filing_date" IS NOT NULL
          AND TRY_TO_NUMBER(SUBSTRING(t."filing_date"::STRING, 1, 4)) IS NOT NULL
          AND CAST(SUBSTRING(t."filing_date"::STRING, 1, 4) AS INT) BETWEEN 1800 AND 2100
),

top_assignees AS (
    SELECT 
        "assignee_name", 
        COUNT(DISTINCT "publication_number") AS total_applications
    FROM cte
    GROUP BY "assignee_name"
    ORDER BY total_applications DESC NULLS LAST
    LIMIT 3
),

assignee_year_counts AS (
    SELECT 
        "assignee_name",
        "filing_year",
        COUNT(DISTINCT "publication_number") AS applications_in_that_year
    FROM cte
    WHERE "assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
    GROUP BY "assignee_name", "filing_year"
),

assignee_top_year AS (
    SELECT
        "assignee_name",
        "filing_year" AS year_with_most_applications,
        applications_in_that_year,
        ROW_NUMBER() OVER (PARTITION BY "assignee_name" ORDER BY applications_in_that_year DESC NULLS LAST) AS rn
    FROM assignee_year_counts
),

assignee_year_country_code AS (
    SELECT 
        c."assignee_name",
        c."filing_year",
        c."country_code",
        COUNT(DISTINCT c."publication_number") AS applications_in_country
    FROM cte c
    WHERE c."assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
    GROUP BY c."assignee_name", c."filing_year", c."country_code"
),

assignee_top_country AS (
    SELECT
        "assignee_name",
        "filing_year",
        "country_code" AS country_code_with_most_applications_during_that_year,
        applications_in_country,
        ROW_NUMBER() OVER (PARTITION BY "assignee_name", "filing_year" ORDER BY applications_in_country DESC NULLS LAST) AS rn
    FROM assignee_year_country_code
),

final_result AS (
    SELECT
        ta."assignee_name",
        ta.total_applications,
        aty.year_with_most_applications,
        aty.applications_in_that_year,
        atc.country_code_with_most_applications_during_that_year
    FROM top_assignees ta
    JOIN assignee_top_year aty ON ta."assignee_name" = aty."assignee_name" AND aty.rn = 1
    JOIN assignee_top_country atc ON atc."assignee_name" = ta."assignee_name" AND atc."filing_year" = aty.year_with_most_applications AND atc.rn =1
)

SELECT
    "assignee_name",
    total_applications,
    year_with_most_applications,
    applications_in_that_year,
    country_code_with_most_applications_during_that_year
FROM final_result;
```
2025-01-16 03:14:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:14:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:14:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:14:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-16 03:14:05 - snowflake.connector.connection - INFO - closed
2025-01-16 03:14:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:14:06 - root - INFO - itercount: 3
2025-01-16 03:14:06 - root - INFO - No data found for the specified query.

2025-01-16 03:14:06 - root - INFO - Input sql:
WITH cte AS (
    SELECT 
        t."publication_number",
        t."filing_date",
        CAST(SUBSTRING(t."filing_date"::STRING, 1, 4) AS INT) AS "filing_year",
        t."country_code",
        f_cpc.value:"code"::STRING AS "cpc_code",
        f_assignee.value:"name"::STRING AS "assignee_name"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."cpc") f_cpc,
         LATERAL FLATTEN(input => t."assignee") f_assignee
    WHERE f_cpc.value:"code"::STRING LIKE 'A01B3%'
          AND f_assignee.value:"name" IS NOT NULL
          AND t."filing_date" IS NOT NULL
          AND TRY_TO_NUMBER(SUBSTRING(t."filing_date"::STRING, 1, 4)) IS NOT NULL
          AND CAST(SUBSTRING(t."filing_date"::STRING, 1, 4) AS INT) BETWEEN 1800 AND 2100
),

top_assignees AS (
    SELECT 
        "assignee_name", 
        COUNT(DISTINCT "publication_number") AS total_applications
    FROM cte
    GROUP BY "assignee_name"
    ORDER BY total_applications DESC NULLS LAST
    LIMIT 3
),

assignee_year_counts AS (
    SELECT 
        "assignee_name",
        "filing_year",
        COUNT(DISTINCT "publication_number") AS applications_in_that_year
    FROM cte
    WHERE "assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
    GROUP BY "assignee_name", "filing_year"
),

assignee_top_year AS (
    SELECT
        "assignee_name",
        "filing_year" AS year_with_most_applications,
        applications_in_that_year,
        ROW_NUMBER() OVER (PARTITION BY "assignee_name" ORDER BY applications_in_that_year DESC NULLS LAST) AS rn
    FROM assignee_year_counts
),

assignee_year_country_code AS (
    SELECT 
        c."assignee_name",
        c."filing_year",
        c."country_code",
        COUNT(DISTINCT c."publication_number") AS applications_in_country
    FROM cte c
    WHERE c."assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
    GROUP BY c."assignee_name", c."filing_year", c."country_code"
),

assignee_top_country AS (
    SELECT
        "assignee_name",
        "filing_year",
        "country_code" AS country_code_with_most_applications_during_that_year,
        applications_in_country,
        ROW_NUMBER() OVER (PARTITION BY "assignee_name", "filing_year" ORDER BY applications_in_country DESC NULLS LAST) AS rn
    FROM assignee_year_country_code
),

final_result AS (
    SELECT
        ta."assignee_name",
        ta.total_applications,
        aty.year_with_most_applications,
        aty.applications_in_that_year,
        atc.country_code_with_most_applications_during_that_year
    FROM top_assignees ta
    JOIN assignee_top_year aty ON ta."assignee_name" = aty."assignee_name" AND aty.rn = 1
    JOIN assignee_top_country atc ON atc."assignee_name" = ta."assignee_name" AND atc."filing_year" = aty.year_with_most_applications AND atc.rn =1
)

SELECT
    "assignee_name",
    total_applications,
    year_with_most_applications,
    applications_in_that_year,
    country_code_with_most_applications_during_that_year
FROM final_result;
The error information is:
 No data found for the specified query.
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'

2025-01-16 03:15:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 03:15:02 - root - INFO - ```sql
WITH cte AS (
    SELECT 
        t."publication_number",
        t."filing_date",
        CAST(SUBSTRING(t."filing_date"::STRING, 1, 4) AS INT) AS "filing_year",
        t."country_code",
        f_cpc.value:"code"::STRING AS "cpc_code",
        f_assignee.value:"name"::STRING AS "assignee_name"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."cpc") f_cpc,
         LATERAL FLATTEN(input => t."assignee") f_assignee
    WHERE 
        (f_cpc.value:"code"::STRING LIKE 'A01B3/%' OR f_cpc.value:"code"::STRING = 'A01B3')
        AND f_assignee.value:"name" IS NOT NULL
        AND t."filing_date" IS NOT NULL
        AND TRY_TO_NUMBER(SUBSTRING(t."filing_date"::STRING, 1, 4)) BETWEEN 1800 AND 2100
),
top_assignees AS (
    SELECT 
        "assignee_name", 
        COUNT(DISTINCT "publication_number") AS total_applications
    FROM cte
    GROUP BY "assignee_name"
    ORDER BY total_applications DESC NULLS LAST
    LIMIT 3
),
assignee_year_counts AS (
    SELECT 
        "assignee_name",
        "filing_year",
        COUNT(DISTINCT "publication_number") AS applications_in_that_year
    FROM cte
    WHERE "assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
    GROUP BY "assignee_name", "filing_year"
),
assignee_top_year AS (
    SELECT
        "assignee_name",
        "filing_year" AS year_with_most_applications,
        applications_in_that_year,
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name" 
            ORDER BY applications_in_that_year DESC NULLS LAST
        ) AS rn
    FROM assignee_year_counts
    WHERE "filing_year" IS NOT NULL
),
assignee_year_country_code AS (
    SELECT 
        c."assignee_name",
        c."filing_year",
        c."country_code",
        COUNT(DISTINCT c."publication_number") AS applications_in_country
    FROM cte c
    WHERE c."assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
    GROUP BY c."assignee_name", c."filing_year", c."country_code"
),
assignee_top_country AS (
    SELECT
        "assignee_name",
        "filing_year",
        "country_code" AS country_code_with_most_applications_during_that_year,
        applications_in_country,
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name", "filing_year" 
            ORDER BY applications_in_country DESC NULLS LAST
        ) AS rn
    FROM assignee_year_country_code
    WHERE "filing_year" IS NOT NULL
),
final_result AS (
    SELECT
        ta."assignee_name",
        ta.total_applications,
        aty.year_with_most_applications,
        aty.applications_in_that_year,
        atc.country_code_with_most_applications_during_that_year
    FROM top_assignees ta
    JOIN assignee_top_year aty 
        ON ta."assignee_name" = aty."assignee_name" AND aty.rn = 1
    JOIN assignee_top_country atc 
        ON atc."assignee_name" = ta."assignee_name" 
        AND atc."filing_year" = aty.year_with_most_applications 
        AND atc.rn = 1
)
SELECT
    "assignee_name",
    total_applications,
    year_with_most_applications,
    applications_in_that_year,
    country_code_with_most_applications_during_that_year
FROM final_result;
```
2025-01-16 03:15:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:15:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:15:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:15:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-16 03:15:04 - snowflake.connector.connection - INFO - closed
2025-01-16 03:15:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:15:04 - root - INFO - itercount: 4
2025-01-16 03:15:04 - root - INFO - No data found for the specified query.

2025-01-16 03:15:04 - root - INFO - Input sql:
WITH cte AS (
    SELECT 
        t."publication_number",
        t."filing_date",
        CAST(SUBSTRING(t."filing_date"::STRING, 1, 4) AS INT) AS "filing_year",
        t."country_code",
        f_cpc.value:"code"::STRING AS "cpc_code",
        f_assignee.value:"name"::STRING AS "assignee_name"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."cpc") f_cpc,
         LATERAL FLATTEN(input => t."assignee") f_assignee
    WHERE 
        (f_cpc.value:"code"::STRING LIKE 'A01B3/%' OR f_cpc.value:"code"::STRING = 'A01B3')
        AND f_assignee.value:"name" IS NOT NULL
        AND t."filing_date" IS NOT NULL
        AND TRY_TO_NUMBER(SUBSTRING(t."filing_date"::STRING, 1, 4)) BETWEEN 1800 AND 2100
),
top_assignees AS (
    SELECT 
        "assignee_name", 
        COUNT(DISTINCT "publication_number") AS total_applications
    FROM cte
    GROUP BY "assignee_name"
    ORDER BY total_applications DESC NULLS LAST
    LIMIT 3
),
assignee_year_counts AS (
    SELECT 
        "assignee_name",
        "filing_year",
        COUNT(DISTINCT "publication_number") AS applications_in_that_year
    FROM cte
    WHERE "assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
    GROUP BY "assignee_name", "filing_year"
),
assignee_top_year AS (
    SELECT
        "assignee_name",
        "filing_year" AS year_with_most_applications,
        applications_in_that_year,
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name" 
            ORDER BY applications_in_that_year DESC NULLS LAST
        ) AS rn
    FROM assignee_year_counts
    WHERE "filing_year" IS NOT NULL
),
assignee_year_country_code AS (
    SELECT 
        c."assignee_name",
        c."filing_year",
        c."country_code",
        COUNT(DISTINCT c."publication_number") AS applications_in_country
    FROM cte c
    WHERE c."assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
    GROUP BY c."assignee_name", c."filing_year", c."country_code"
),
assignee_top_country AS (
    SELECT
        "assignee_name",
        "filing_year",
        "country_code" AS country_code_with_most_applications_during_that_year,
        applications_in_country,
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name", "filing_year" 
            ORDER BY applications_in_country DESC NULLS LAST
        ) AS rn
    FROM assignee_year_country_code
    WHERE "filing_year" IS NOT NULL
),
final_result AS (
    SELECT
        ta."assignee_name",
        ta.total_applications,
        aty.year_with_most_applications,
        aty.applications_in_that_year,
        atc.country_code_with_most_applications_during_that_year
    FROM top_assignees ta
    JOIN assignee_top_year aty 
        ON ta."assignee_name" = aty."assignee_name" AND aty.rn = 1
    JOIN assignee_top_country atc 
        ON atc."assignee_name" = ta."assignee_name" 
        AND atc."filing_year" = aty.year_with_most_applications 
        AND atc.rn = 1
)
SELECT
    "assignee_name",
    total_applications,
    year_with_most_applications,
    applications_in_that_year,
    country_code_with_most_applications_during_that_year
FROM final_result;
The error information is:
 No data found for the specified query.
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'

2025-01-16 03:15:55 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 03:15:55 - root - INFO - ```sql
WITH cte AS (
    SELECT 
        t."publication_number",
        t."filing_date",
        CAST(SUBSTRING(t."filing_date"::STRING, 1, 4) AS INT) AS "filing_year",
        t."country_code",
        f_cpc.value:"code"::STRING AS "cpc_code",
        f_assignee.value:"name"::STRING AS "assignee_name"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."cpc") f_cpc,
         LATERAL FLATTEN(input => t."assignee") f_assignee
    WHERE 
        f_cpc.value:"code"::STRING LIKE 'A01B3%'
        AND f_assignee.value:"name" IS NOT NULL
        AND t."filing_date" IS NOT NULL
        AND TRY_TO_NUMBER(SUBSTRING(t."filing_date"::STRING, 1, 4)) IS NOT NULL
),
top_assignees AS (
    SELECT 
        "assignee_name", 
        COUNT(DISTINCT "publication_number") AS total_applications
    FROM cte
    GROUP BY "assignee_name"
    ORDER BY total_applications DESC NULLS LAST
    LIMIT 3
),
assignee_year_counts AS (
    SELECT 
        "assignee_name",
        "filing_year",
        COUNT(DISTINCT "publication_number") AS applications_in_that_year
    FROM cte
    WHERE "assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
    GROUP BY "assignee_name", "filing_year"
),
assignee_top_year AS (
    SELECT
        "assignee_name",
        "filing_year" AS year_with_most_applications,
        applications_in_that_year,
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name" 
            ORDER BY applications_in_that_year DESC NULLS LAST
        ) AS rn
    FROM assignee_year_counts
    WHERE "filing_year" IS NOT NULL
),
assignee_year_country_code AS (
    SELECT 
        c."assignee_name",
        c."filing_year",
        c."country_code",
        COUNT(DISTINCT c."publication_number") AS applications_in_country
    FROM cte c
    WHERE c."assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
    GROUP BY c."assignee_name", c."filing_year", c."country_code"
),
assignee_top_country AS (
    SELECT
        "assignee_name",
        "filing_year",
        "country_code" AS country_code_with_most_applications_during_that_year,
        applications_in_country,
        ROW_NUMBER() OVER (
            PARTITION BY "assignee_name", "filing_year" 
            ORDER BY applications_in_country DESC NULLS LAST
        ) AS rn
    FROM assignee_year_country_code
    WHERE "filing_year" IS NOT NULL
),
final_result AS (
    SELECT
        ta."assignee_name",
        ta.total_applications,
        aty.year_with_most_applications,
        aty.applications_in_that_year,
        atc.country_code_with_most_applications_during_that_year
    FROM top_assignees ta
    JOIN assignee_top_year aty 
        ON ta."assignee_name" = aty."assignee_name" AND aty.rn = 1
    JOIN assignee_top_country atc 
        ON atc."assignee_name" = ta."assignee_name" 
        AND atc."filing_year" = aty.year_with_most_applications 
        AND atc.rn = 1
)
SELECT
    "assignee_name",
    total_applications,
    year_with_most_applications,
    applications_in_that_year,
    country_code_with_most_applications_during_that_year
FROM final_result;
```
2025-01-16 03:15:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:15:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:15:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:15:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-16 03:15:57 - snowflake.connector.connection - INFO - closed
2025-01-16 03:15:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:15:57 - root - INFO - No data found for the specified query, remove file.

2025-01-16 03:15:57 - root - INFO - Total iteration counts: 5
