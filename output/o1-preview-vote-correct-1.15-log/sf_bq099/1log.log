2025-01-16 03:09:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 03:10:06 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 03:10:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:10:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:10:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:10:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 338
2025-01-16 03:10:09 - snowflake.connector.connection - INFO - closed
2025-01-16 03:10:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:10:09 - root - INFO - SQL:
-- Query 1: Get sample values from the "cpc" column
SELECT t."cpc"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 1000;
Results:
Too long, hard cut:
cpc
[]
[]
[]
"[
  {
    ""code"": ""H02M5/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""A01N47/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D521/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""Y02A40/81"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""Y02E30/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""Y10T83/465"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""B26F1/42"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""B22D11/086"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""C07D471/16"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D471/22"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""G01N33/48728"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""C11B5/0064"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/35"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C11B5/0035"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M135/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C09K15/30"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D263/56"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/44"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D235/12"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/3447"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/48"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/46"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D277/64"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/47"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/224"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/102"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/106"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/104"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/10"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/221"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/226"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/225"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/22"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10L1/14"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""E02D5/808"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/385"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/26"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/28"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/54"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
[]
[]
"[
  {
    ""code"": ""C07D213/32"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/51"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/51"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/22"",
    ""first"": true,
    ""inventive"": true,
    ""t

2025-01-16 03:10:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:10:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:10:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:10:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 03:10:11 - snowflake.connector.connection - INFO - closed
2025-01-16 03:10:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:10:12 - root - INFO - SQL:
-- Query 2: Flatten and view individual CPC entries
SELECT f.value
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
LIMIT 1000;
Results:
Too long, hard cut:
VALUE
"{
  ""code"": ""G01N2030/202"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""Y10T137/86815"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""G01N2030/202"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""G01N30/6047"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""F16K11/074"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G01N30/20"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""F16K11/074"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""B01D15/1821"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""G01N30/20"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""B01D15/1821"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""G01N30/6047"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""G01N2030/201"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""G01N2030/201"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""Y10T137/86815"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""G01N30/461"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""G01N30/461"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""A61K31/00"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""A61K31/00"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G02B7/16"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G02B7/16"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G02B21/248"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""Y10T74/19749"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""Y10T74/19749"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""G02B21/248"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06F13/4077"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H04L5/16"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06F13/4077"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H04L5/16"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G11B7/004"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G11B7/00375"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G11B20/10"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G11B19/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G11B7/00375"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G11B19/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06V20/66"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06V10/143"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06V20/66"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06V10/143"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06V20/80"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06V20/80"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C03C3/095"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C03C3/091"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C09D11/03"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C03C12/00"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C03C3/091"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C03C12/00"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C03C3/095"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C09D11/03"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L28/91"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L28/91"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H10B12/033"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H10B12/00"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H10B12/033"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H10B12/318"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H10B12/318"",
  

2025-01-16 03:10:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:10:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:10:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:10:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 03:10:13 - snowflake.connector.connection - INFO - closed
2025-01-16 03:10:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:10:13 - root - INFO - SQL:
-- Query 3: Extract distinct CPC codes
SELECT DISTINCT f.value:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
LIMIT 1000;
Results:
Too long, hard cut:
cpc_code
H05K2203/1327
H04B1/0057
G06T19/006
H01L21/50
B32B27/308
B32B27/32
C09D7/65
C01B9/04
H01L21/76849
A61G13/02
G06K9/00369
G06F40/279
H04B7/086
B32B37/12
G01N15/14
H04W72/542
A61K31/282
G01D11/245
G01D21/00
F16F9/19
H04W64/00
H01L45/08
H02J7/04
H01L21/823437
F41C23/04
F02D2250/36
C04B2111/40
F02B67/00
H01L24/19
C07F15/0093
G01N15/1459
G02B27/0172
F02M26/00
F24D2220/042
A61K2300/00
Y02P70/10
C23C18/24
Y02T70/10
C07K5/06034
F21V5/008
C07F15/025
A61K39/0017
A61B17/3468
A63C10/24
F16L3/1236
B29C70/003
H04M19/08
F22G7/14
C08F299/065
C09K5/063
B82Y40/00
H01L21/3065
H04N2201/3278
C09D11/17
H04L67/10
H04L41/22
H01M8/04671
B29C48/913
H05K7/20545
H04M3/42314
G01N33/74
C08G65/30
A01K2207/15
C08L77/06
C07F7/126
F24H9/02
G06Q50/02
H04N21/4147
H01M4/62
E05B17/0058
A61K31/439
A23K20/24
B60W2710/083
A47C1/032
B62D1/185
E02F9/2217
C22C21/08
B32B2307/746
G02B1/18
G06T2207/10088
A61L2/10
A61N5/0616
G06F2201/88
G06K9/2063
E04F13/06
H04N19/159
G06T9/004
G06F2009/4557
H04N19/114
A61M25/1027
C09D5/00
F05D2260/98
F02C7/266
G07C5/008
G09G2330/023
A61K31/065
A43B1/0009
A47J31/18
D04H1/587
A61B2017/07257
A61K2800/5426
B23K2103/02
B23K35/3053
G10L15/08
G06F19/3475
B01D61/10
H01L24/09
H03K3/84
G01K7/42
A61B17/0401
G06F9/3808
E21B43/084
C30B25/10
F04B1/12
H01L27/3272
F02B2053/005
C09J2489/00
A43B13/125
A23L19/00
G02B27/0093
B66D1/14
G06F1/1626
H01S3/076
H04L45/02
G03G15/5041
A61K31/195
G06Q30/0278
A61L27/50
H01M4/381
B21B45/004
A61H2201/0157
G11C29/52
A63F2300/63
G06Q30/0267
B01D53/268
G06T2207/20021
C30B25/18
E04H15/06
G16H20/40
G06F2203/04105
A23K40/30
B29C55/04
G01S2205/01
G06F16/43
B01J35/56
H02J50/20
H01L33/145
C12N15/1065
C12N2310/20
B01D53/263
F02N2200/022
H04B5/0087
B33Y50/00
D07B2201/2043
A61L29/14
A46B7/044
H02P7/29
E05B45/12
H04B17/382
A23L27/20
Y10T29/49885
A47C1/12
G02B2027/0165
A61B17/12109
F41H5/0471
C04B38/0022
B01D1/221
E06B9/171
H04N9/888
C07D231/14
B60G17/0152
B60G2202/42
A47C4/286
E01C19/176
F02M59/48
H01J2237/221
H02J7/0063
H01M16/00
C09J7/00
A61F5/56
C04B2201/10
B01D39/2017
B32B27/28
A61M1/3427
B63C11/18
G01N2223/6116
B41K1/58
B63B2704/00
B60Y2200/92
A63F2300/8047
G06T2207/20092
E01C15/00
C08F2/001
H10K59/129
H01L27/0292
A46B13/02
F16K15/18
C04B33/34
H04Q1/144
F04C2/344
D21D5/24
G06F17/30876
A61B2017/00353
B23K26/127
H03M13/2792
C04B35/6261
B63B13/02
A41C1/00
B01D2253/108
B23K2101/42
B60W10/10
H04J11/0093
B60L58/30
F23R3/286
G06V20/58
B32B2457/20
H04L69/04
G06F2203/04112
G02B5/3033
D02J1/08
G06F17/30138
G07F11/10
B03B4/005
G01J3/108
Y10T83/8716
F24F3/153
F23Q2/32
B44C5/0407
C08K3/24
B65D47/2037
H04L9/00
E06B9/15
E21B47/01
B29C2949/08
B67B7/44
F16H61/30
B29D22/00
B65H21/00
B23B27/22
B64C3/54
C07C323/44
F25D23/065
F01D5/025
F01N13/001
H01H67/06
B29C73/02
G06F16/2471
H02G15/013
A61K49/0036
B60L2240/545
H01L23/3675
C03B37/0124
C12N2500/02
A61M2037/0023
A61M2037/0046
B25J19/021
H04N19/85
G06F3/0655
C22C38/10
A63B69/0059
H04L12/1822
G01V2210/244
Y10T409/307672
B23K35/286
G01J3/04
B23K35/325
A61B2017/2904
A61B2090/037
A61K49/0065
H04B1/71632
G06F9/44505
B65G47/71
H01L29/7889
B60L3/0069
A61M2025/0226
C09J7/02
A61N1/36135
A61N1/37217
C10N2040/42
H01L33/486
B67D3/0029
A61B1/31
H01L33/10
Y10T137/8593
A61H2230/10
F16C2300/34
Y10T29/49032
B81B2201/042
C09J163/00
B60S1/3887
A63F13/56
G02F1/133317
B01J2219/0801
H03K17/693
A61K47/59
C04B35/63428
B27G19/04
C12Q2525/307
C07C213/06
A61C3/025
A61K51/1251
C08G64/22
A47B47/005
A61K36/233
G01J5/10
A61K36/232
B67D1/0009
B67D1/0412
B60P1/34
B65G1/0478
H04W36/0064
G06N3/067
A61F2/2466
A61L2/238
G06F18/217
H02H3/343
B01D2258/014
H03K5/135
H04L41/0816
H04L43/0811
F02D41/1462
H01L2924/20753
Y10T428/24702
F42C19/00
G11C2013/0092
A61B8/485
H02K1/187
F05D2240/303
F16H37/12
B23D45/048
Y10S901/36
H02M1/0054
H01S5/028
B29C2045/1741
H05K13/08
H03F3/20
G06F3/06
C08G59/621
H04N23/611
H02K3/345
F16H2025/2481
H01L43/10
H01L2224/05157
A61B5/4504
G02B6/06
H01L2224/03462
A61H2201/1436
C23F13/005
H05K3/426
F24C15/2035
Y02P30/00
H04W36/0016
A61M1/1524
H04K3/224
C01B3/42
G03G15/04054
A61M60/40
A61B2017/2906
H03K19/17764
F16L1/10
G06Q10/047
H04L12/2856
A61B2017/0464
G11B20/1879
G06F21/31
C08F251/02
A43B17/026
Y10T29/49989
B01D2256/10
B25B27/06
C09K9/02
G06T2207/10012
G08B13/1427
A61N1/378
G06T2207/30024
B65H2403/73
E05B77/38
B60W2556/65
G01S19/37
G02F1/133621
G06V40/197
H04N1/00708
G06N3/0418
G05D1/24
H01L21/187
H01L27/11514
H02K33/02
B65D25/108
Y10T83/155
A61K39/001103
H04L2012/5614
H05K2201/09736
A61B5/0836
F02M63/0078
B22D11/0406
A61K31/4172
H01L2224/82101
B65D5/241
B65D5/2019
H01L24/40
B65H2801/31
C21B2400/08
F04C18/16
C12Y302/01091
A61B8/5253
G01N21/8806
H10N70/884
C07F15/0046
C12Q1/04
F16F7/123
B01D2257/404
H04N9/3114
H04M1/0216
B60L2240/507
G02B5/3008
C08G75/045
A61M25/003
C08G63/00
C09J9/00
H01J37/32669
C04B2111/00767
F15B2211/265
G02B17/0812
G06F2200/1633
H01M50/533
G06F17/241
A63B45/00
F16C2316/10
H01M8/0606
A61F2002/91591
B65D2575/329
A61F2013/00246
B01D46/69
B32B2307/584
G16B20/10
H04N19/96
H01H13/81
C09D5/1668
F25C5/182
A61H2201/123
B24D3/002
C07F7/0838
C07D211/66
H04B1/18
A63B21/0407
H04W36/

2025-01-16 03:10:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:10:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:10:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:10:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 03:10:15 - snowflake.connector.connection - INFO - closed
2025-01-16 03:10:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:10:15 - root - INFO - SQL:
-- Query 4: Get sample values from the "assignee_harmonized" column
SELECT t."assignee_harmonized"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 1000;
Results:
Too long, hard cut:
assignee_harmonized
"[
  {
    ""country_code"": ""CR"",
    ""name"": ""UNIV COSTA RICA""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BAYER AG""
  }
]"
[]
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""CRABTREE ELECTRICAL IND LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""BASF AG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""MORITA SANGYO KK""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""TOSHIBA CORP""
  }
]"
[]
"[
  {
    ""country_code"": """",
    ""name"": ""ADOLPH BEREN""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""VOEST ALPINE AG""
  }
]"
"[
  {
    ""country_code"": ""HU"",
    ""name"": ""CHINOIN GYOGYSZER ES VEGYESZET""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""PFUETZNER HELMUT DIPL ING DR T""
  },
  {
    ""country_code"": ""AT"",
    ""name"": ""KRAUSE ERWIN DIPL ING""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BROCKWAY GLASS CO INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""CIBA GEIGY""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""MUELLER G""
  }
]"
"[
  {
    ""country_code"": ""CA"",
    ""name"": ""SHARMAN JAMES""
  }
]"
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""LE BLON CHARLES""
  },
  {
    ""country_code"": ""FR"",
    ""name"": ""A OBLASSER A GODDYN ET CIE SOC""
  }
]"
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""ICI LTD""
  }
]"
"[
  {
    ""country_code"": ""IT"",
    ""name"": ""FARINA & FIGLI A""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""KNOBEL & HEER""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""ROESCH ARTHUR""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""ENGEL HUGO""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BOECKLEIN JOSEF""
  }
]"
[]
[]
"[
  {
    ""country_code"": """",
    ""name"": ""M & T CHEMICALS INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""LOEWE OPTA AG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""BAYER AG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""MITSUBISHI HEAVY IND LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""GLOBE UNION INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ISAP SPA""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""JOSHUA BIGWOOD AND SON LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ERWIN SCHWARZ""
  }
]"
[]
"[
  {
    ""country_code"": """",
    ""name"": ""BOSCH GMBH ROBERT""
  }
]"
"[
  {
    ""country_code"": ""NL"",
    ""name"": ""PHILIPS NV""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""SUWA SEIKOSHA KK""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""NIPPON STEEL CORP""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""HOLLINGSWORTH GMBH""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""ECKOLD VORRICHTUNG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""DOWELANCO""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""IGARASHI KAZUYOSHI""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HITACHI LTD""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""CHIYODA CORP""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ROUSSEL UCLAF""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""PETROL ENGINERING S A""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""IRECO CHEMICALS""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""COLGATE PALMOLIVE CO""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""FERRER INT""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""LILLY CO ELI""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""MAUSER WERKE GMBH""
  }
]"
[]
"[
  {
    ""country_code"": """",
    ""name"": ""HOEYER ELLEFSEN AS""
  }
]"
[]
[]
"[
  {
    ""country_code"": ""IT"",
    ""name"": ""SOMET SOC MEC TESSILE""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""MIODRAG SPASOJEVIC""
  }
]"
"[
  {
    ""country_code"": ""YU"",
    ""name"": ""TEHNOLOSKI FAK N SAD""
  }
]"
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""BEECHAM GROUP LTD""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""HOECHST AG""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""BLUM GMBH JULIUS""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""SCHWAMM HORST""
  },
  {
    ""country_code"": ""AT"",
    ""name"": ""PEZZEI FRIEDBERT""
  },
  {
    ""country_code"": ""AT"",
    ""name"": ""KREMS CHEMIE GMBH""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""ELTREVA AG""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""GANNER ERWIN""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""GRASS ALFRED METALLWAREN""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""INKOMAG FA""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""PROHASKA HEINZ""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""SIEMENS AG OESTERREICH""
 

2025-01-16 03:10:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:10:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:10:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:10:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 03:10:17 - snowflake.connector.connection - INFO - closed
2025-01-16 03:10:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:10:17 - root - INFO - SQL:
-- Query 5: Flatten and view individual assignee entries
SELECT h.value
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."assignee_harmonized") h
LIMIT 1000;
Results:
Too long, hard cut:
VALUE
"{
  ""country_code"": ""US"",
  ""name"": ""STEVEN SCHON""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""SHACHIHATA INC""
}"
"{
  ""country_code"": ""IE"",
  ""name"": ""ONKIMMUNE LTD""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""ADVANCED COMPUTER AND COMMUNICATIONS L L C""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""UNITED TECHNOLOGIES CORP""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""SCHILLER GROUNDS CARE INC""
}"
"{
  ""country_code"": ""BE"",
  ""name"": ""JANSSEN PHARMACEUTICA NV""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""HAGGAN WILLIE""
}"
"{
  ""country_code"": ""CN"",
  ""name"": ""LENOVO BEIJING LTD""
}"
"{
  ""country_code"": ""KR"",
  ""name"": ""JAHWA ELECTRONICS CO LTD""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""TOSHIBA KK""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""SERVUTAS VITALI""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""XEROX CORP""
}"
"{
  ""country_code"": ""GB"",
  ""name"": ""ADVANCED RISC MACH LTD""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""UNIV MICHIGAN REGENTS""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""IBM""
}"
"{
  ""country_code"": ""TW"",
  ""name"": ""SUPERC TOUCH CORP""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""PETRUKHIN KONSTANTIN""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""CIOFFI CHRISTOPHER""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""JOHNSON GRAHAM""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""DOBRI NICOLETA""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""FREEMAN EMILY""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""CHEN PING""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""CONLON MICHAEL""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""ZHU LEI""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""UNIV COLUMBIA""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""TOSHIBA TEC KK""
}"
"{
  ""country_code"": ""KR"",
  ""name"": ""SK HYNIX INC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""COMMVAULT SYSTEMS INC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""BARD INC C R""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""BARD INC C R""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""OLYMPUS CORP""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""SONY CORP""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""BRIDGESTONE CORP""
}"
"{
  ""country_code"": ""GB"",
  ""name"": ""CP CASES LTD""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""SUMITOMO RUBBER IND""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""TORAY INDUSTRIES""
}"
"{
  ""country_code"": ""MT"",
  ""name"": ""CAREBAY EUROPE LTD""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""NTN TOYO BEARING CO LTD""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""HARMAN INT IND""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""NIPPON STEEL & SUMITOMO METAL CORP""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""TUNGALOY CORP""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""KEWPIE CORP""
}"
"{
  ""country_code"": ""DE"",
  ""name"": ""NEC EUROPE LTD""
}"
"{
  ""country_code"": ""TW"",
  ""name"": ""HOU HAO HSUN""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""UNIV CHICAGO""
}"
"{
  ""country_code"": ""IR"",
  ""name"": ""KARIMZADEH RAMIN""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""NXP USA INC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""FRACTAL ANTENNA SYSTEMS INC""
}"
"{
  ""country_code"": ""GB"",
  ""name"": ""ADVANCED RISC MACH LTD""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""INCYTE CORP""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""RED HAT INC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""SEAGATE TECHNOLOGY LLC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""GUARDIAN INDUSTRIES""
}"
"{
  ""country_code"": ""KR"",
  ""name"": ""DAEGU GYEONGBUK INST SCIENCE & TECH""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""SERVANT'S HEART OUTFITTERS L L C""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""PACIFIC BIOSCIENCES CALIFORNIA INC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""MICROSOFT TECHNOLOGY LICENSING LLC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""FITBIT INC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""APPLE INC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""PROFESSIONAL DISPOSABLES INT INC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""TRW AUTOMOTIVE US LLC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""MICROSOFT TECHNOLOGY LICENSING LLC""
}"
"{
  ""country_code"": ""CA"",
  ""name"": ""SPORT MASKA INC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""SENSITY SYSTEMS INC""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""SEIKO EPSON CORP""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""FACEBOOK INC""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""OLYMPUS CORP""
}"
"{
  ""country_code"": ""GB"",
  ""name"": ""CRODA INT PLC""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""FUJIFILM CORP""
}"
"{
  ""country_code"": ""IE"",
  ""name"": ""ACCENTURE GLOBAL SOLUTIONS LTD""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""LEBLAND DENNIS""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""ELWHA LLC""
}"
"{


2025-01-16 03:10:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:10:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:10:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:10:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 03:10:19 - snowflake.connector.connection - INFO - closed
2025-01-16 03:10:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:10:19 - root - INFO - SQL:
-- Query 6: Extract distinct assignee names
SELECT DISTINCT h.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."assignee_harmonized") h
LIMIT 1000;
Results:
Too long, hard cut:
assignee_name
EKMAN MATTHEW
TEIJIN LTD
MURATA MANUFACTURING CO
BOE TECHNOLOGY GROUP CO LTD
KONINKLIJKE PHILIPS NV
LEPIDEXT
ADAMA MAKHTESHIM LTD
BLACK SESAME INTERNATIONAL HOLDING LTD
PGS GEOPHYSICAL AS
IZI MEDICAL PRODUCTS LLC
AVERY DENNISON CORP
PIONEER HI BRED INT
UNIV SHANDONG SCIENCE & TECH
ACER INC
OMNICELL INC
M TECHNIQUE CO LTD
BAKER HUGHES INC
UNIV EAST CHINA SCIENCE & TECH
The Full Life Company
LG FUEL CELL SYSTEMS INC
MERCK SHARP & DOHME LLC
VNI TEPLOVOZNYJ I
PECHINEY EMBALLAGE FLEXIBLE EU
VUKOBRATOVIC DEJAN
CESKU VYSOKU UCENI TECHNICKU V PRAZE FAKULTA STAVEBNI
KLEMENT GOTTWALD WERKE VEB
TLV CO LTD
LEIBFRIED GMBH K
RINDCHEN MARKUS
MEDIPOST CO LTD
OLEJNIK VINCENT
MUELLER CHRISTOPH
VALEO EQUIP ELECTR MOTEUR
COOK INC
ROPUR AG
AKTSIONERNOE OBSHTESTVO TVЭL
CELGENE CORP
MA CHAO
MALLARD DEAN
PANASONIC CORP
CONOPCO INC DBA UNILEVER
SOFT LINES INT LTD
HOSOYA YOICHI
UMEHARA HIDEAKI
DENKA COMPANY LTD
REPUBLIC OF KOREA RURAL DEV ADMINISTRATION
MALL GMBH
WERMA HOLDING GMBH CO KG
DEED S R L
SHELL OIL CO
INFINEON TECHNOLOGIES AUSTRIA AG
YARA MARINE TECH AS
METAL PROCESS COMPANY
CARPENTER FRED A
PHILLIPS PETROLEUM CO
OHIO BRASS CO
WOOD NEWSPAPER MACH CORP
JACK CATHRILL
DOW CHEMICAL CO
CREUSOT LOIRE
NIPPON LIGHT METAL RES LABOR
TUTTLE AND KIFT
M & T CHEMICALS INC
B S C IND CORP
FROST HARRISON CLEMENT
NORTON JOHN HENRY
FORTIN & SAUNIER ETS
MASSEY FERGUSON INC
GUSTAVO DUFOUR
MARK ANDRE
SVILUPPO SILICALCITE S P A
CYRIL HERBERT HAMPSON
EDWARD HENRY GEORGE KINGDOM
MITSUBISHI ELECTRIC HOME APPL
BEROL SUISSE SA
HUBER AUGUST
NEOPHARM CO LTD
COAL INDUSTRY PATENTS LTD
XIOTECH CORP
TAKEUCHI TOMONARI
FARRELL GREG ROBERT
YAMAZAKI MANABU
YODA KENTARO
FINO FEDERICA
SINGH SATNAM
FARGO RICHARD N
GOBERNA SELMA CONSUELO
OKAMOTO HIROSHIGE
KIM JOUNG CHUL
HAMAD WADOOD Y
LINDSEY SCOTT E
MICROMASS LTD
MACRONIX INT CO LTD
VERIZON PATENT & LICENSING INC
RACEPOINT ENERGY LLC
UNIV LOUISVILLE RES FOUND INC
PLOMSKE MICHELLE K
FUJI PHOTO FILM CO LTD
WANG HONGMEI
PEDROZO HUGO A
BREEN THOMAS J
VOGEL MARK S
SUZUKI TAKASHI
MUELLER BERND
PARK CHAN-WOO
BAETGE E E
DAS SAUMITRA
FUJI KIKO KK
PHILLIPS 66 CO
TOSHIBA MEDICAL SYS CORP
US SECRETARY THE DEPT OF HEALTH AND HUMAN SERVICES
STRAUSS LEVI & CO
UNION SWITCH & SIGNAL CO
ORVILLE INGRAM
OLIPASS CORP
GATHMANN EMIL
PHARMACOPEIA DRUG DISCOVERY
EGA ELECTRIC LTD
PLEXOWOOD
SHIPLEY CO
TRIMYER HERVY LINWOOD
CANADIAN IND
RAMBO WILLIAM H
CHILEAN NITRATE SALES CORP
UNIVEYOR AS
RAU SWF AUTOZUBEHOER
PRECUP EMILE
AUTOMOTIVE PROD CO LTD
MIN HUNG KI
JUNKER & RUH AG
ARMCO STEEL CORP
VDO SCHINDLING
UDDEHOLMS AB
MARIUS LATOUR
NIPPON TEIKOKI SEISAKUSHO KK
FLOOD MICHAEL T
MORIARTY KEVIN P
KHODAREV NIKOLAI
LIU KAI
AIDUN MEHRDAD
JALUNA SA
HYPERROLL ISRAEL LTD
FAN JAMES W
MENZEL KARL
SHAH CHIRAG
TOMLINSON JAY S
GREE ELECTRIC APPLIANCES WUHAN CO LTD
WOLF GMBH RICHARD
R P SCHERER TECHNOLOGIES LLC
UNITED NEUROSCIENCE
JAPAN AVIATION ELECTRONICS IND LTD
SOLARFLARE COMMUNICATIONS INC
IDEMIA FRANCE
EFFICIENCY MATRIX PTY LTD
VON KRIES KARL
PETROLEO BRASILEIRO S A – PETROBRAS
KRUPP KOPPERS GMBH
CHINA TOBACCO HUNAN IND CO LTD
AUTOMOTIVE CELLS COMPANY SE
SHENZHEN LUTE JIACHENG SUPPLY CHAIN MAN CO LTD
UNIV HOKKAIDO NAT UNIV CORP
ADENWALA FATEMA S
ELLI MARIA S
UHL SPORTARTIKEL KARL
ZHAO YONGJUN
DALVAND IZADYAR
DNATRIX INC
FORSCHUNGSVERBUND BERLIN EV
PICCOLO MEDICAL INC
PURE STORAGE INC
Petek Marian
BORDBUSTERS B V I O
KEIPER GMBH & CO KG
EMMERLE MAX
WEBER GERALD
INNOVATE PREFABRICATE INC
ASTRAZANECA AB
KA SHEK LEE
KDB INTELLECTUAL PTY LTD
LAMMERS THOMAS
ISHIKAWAJIMA HARIMA HEAVY IND
BRISTISH AMERICAN TOBACCO INVESTMENTS LTD
SCANIA CV ABP
PALL EUROPE LTD
MAERKL HANS JUERGEN
DAUSINGER & GIESEN GMBH
ESG SUPPLIES LTD
KATRICK TECH LIMITED
BCS BUSINESS CONSULTING SERVICES PTE LTD
HOKURIKU ELECT IND
THE DOE RUN RESOURCES CORP
SANSA CORP BARBADOS INC
SMIT MARTINE
DE HAARD JOHANNES JOSEPH WILHE
PAROS S R L
SCHOLS DOMINIQUE
CARNIVAL CORP
HEFEI BOE DISPLAY TECH CO LTD
MAG ISOVER KK
ACTUALEYES INC
HERE GLOBAL BV
JNTG CO LTD
INNOLITH TECH AG
KOREA INST GEOSCIENCE & MINERAL RESOURCES
SIJBESMA HYLKE
GEGUSSA NOVARA TECHNOLOGY SPA
PFEIFER SEIL HEBETECH
SCHERING AGROCHEMICALS LTD
HANGZHOU CHUAN EN ENVIRONMENTAL TECH CO LTD
NISSENKEN QUALITY EVALUATION CT
JANSEN ALEX
OMEGA SA
ELEKTA INC
FOUNDATION SOONGSIL UNIV INDUSTRY COOPERATION
GEUS HANS GEORG
Ageronix SA
POPEYES LOGISTICS LTD
LIUZHOU OVM MACHINERY CO LTD
TADEPALLI PRABHAKAR
BERNARDINI SRL
QINGDAO HAIER SMART TECH R & D CO LTD
Collar & Ruff
SCHIPS HELMUT
ALCARAZ MARUENDA ALEJO
MILICAN PHILIPPE
SMITHKLINE BECKMAN CORP US
ANDREW BOID FRENCH
NITZ CORP
KENNEDY RHEUMATOLOGY INST
TRW AUTOMOTIVE US LLC
CIMPRESS SCHWEIZ GMBH
IWATANI CORP
Parasol Medical LLC
FLOWAY INC
TREBLE INNOVATIONS LLC
NEC PLATFORMS LTD
MORIKAWA AKIRA
HOSHINO SHO
SONG WEN-WEI
KARLSSON CHRISTER
KREIPL ANDREAS
MATSUDA KOHEI
CHINA TOBACCO HENAN IND CO LTD
CHANGSHA BRIMINS INTELLIGENT SCIENCE AND TECH LIMITED COMPANY
JIANGSU XINYU RESIDENTIAL INDUSTRY TECH CO LTD
JIANGSU WANSHUN NEW ENERGY TECH CO LTD
ZHEJIANG EAST CHINA ENGINEERING CONSTRUCTI

2025-01-16 03:10:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:10:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:10:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:10:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 150
2025-01-16 03:10:21 - snowflake.connector.connection - INFO - closed
2025-01-16 03:10:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:10:21 - root - INFO - SQL:
-- Query 7: Extract filing years from the "filing_date" column
SELECT DISTINCT SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE t."filing_date" IS NOT NULL
LIMIT 1000;
Results:
filing_year
1948
1927
1983
1978
1904
1930
1994
1991
1914
1921
1889
1975
1902
1959
1919
1893
1881
1998
2009
1950
1933
1970
1941
2014
1963
1952
1920
1922
1923
1886
1997
1880
1996
0
1953
1938
1918
1962
1897
1987
2007
1974
1961
1913
1942
1908
1846
1976
1988
1901
1955
1928
1940
2017
1935
1966
1877
1936
1972
1911
1895
1960
2012
2000
1905
1907
1885
1979
1980
1981
1999
1892
2010
2024
1924
1926
1986
1985
1993
1890
2021
1968
1969
1909
1929
1949
1887
2005
1945
2001
1957
1932
1882
1894
2011
2004
1989
1995
1912
1984
2022
1990
1958
1853
2003
1956
2018
2015
2016
2006
1903
1937
1910
2019
2023
1899
1931
1971
1896
1943
1860
2008
1946
1915
1967
1939
1944
1867
2013
1992
1951
2002
2020
1925
1934
1916
1917
1898
1982
1965
1891
1947
1906
1964
1900
1977
1888
1973
1954
1883

2025-01-16 03:10:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:10:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:10:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:10:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 93
2025-01-16 03:10:22 - snowflake.connector.connection - INFO - closed
2025-01-16 03:10:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:10:23 - root - INFO - SQL:
-- Query 8: List of distinct country codes
SELECT DISTINCT t."country_code"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 1000;
Results:
country_code
DO
BA
RS
WO
CR
PL
EP
ZA
MY
CS
LV
HR
AU
CU
RO
KR
PT
NZ
CL
NO
HU
JP
DZ
NL
LT
UA
MW
IT
OA
CY
CZ
HN
SV
CH
TR
BG
AT
YU
ZM
MD
ZW
MA
GB
SG
EG
PA
CO
SI
AR
KE
FI
DK
CA
SK
IS
NI
US
PH
DE
DD
MX
EE
GE
HK
TN
GT
BR
ID
LU
GR
RU
JO
IN
EC
SA
MN
SU
FR
PE
KZ
IL
TW
MT
BE
SE
AP
SM
ME
EA
ES
IE
CN
MC

2025-01-16 03:10:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:10:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:10:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:10:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 213
2025-01-16 03:10:24 - snowflake.connector.connection - INFO - closed
2025-01-16 03:10:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:10:24 - root - INFO - SQL:
-- Query 9: Find publications classified under CPC code 'A01B3%'
SELECT t."publication_number", f.value:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") f
WHERE f.value:"code"::STRING LIKE 'A01B3%'
LIMIT 1000;
Results:
Too long, hard cut:
publication_number,cpc_code
US-2888084-A,A01B33/06
US-1545136-A,A01B39/26
US-1545136-A,A01B39/26
KR-200386017-Y1,A01B3/28
RU-191537-U1,A01B35/20
US-290366-A,A01B35/22
US-3963079-A,A01B35/18
US-3963079-A,A01B39/14
US-3963079-A,A01B39/14
US-3963079-A,A01B35/18
US-2031188-A,A01B33/06
US-2031188-A,A01B33/06
US-2019324472-A1,A01B39/18
HU-E050035-T2,A01B35/24
KR-200473688-Y1,A01B35/16
KR-102593393-B1,A01B33/082
KR-102593393-B1,A01B33/082
KR-102484290-B1,A01B33/14
KR-102484290-B1,A01B35/28
KR-102484290-B1,A01B33/14
KR-102484290-B1,A01B35/28
KR-900006618-B1,A01B33/14
US-828171-A,A01B3/26
US-3129772-A,A01B39/085
US-3129772-A,A01B39/085
US-530054-A,A01B39/14
US-1471180-A,A01B3/50
US-1471180-A,A01B3/50
US-2843032-A,A01B39/14
US-2843032-A,A01B39/14
US-1860534-A,A01B3/50
US-1860534-A,A01B3/50
US-501724-A,A01B3/464
US-2784656-A,A01B35/14
US-2784656-A,A01B35/14
US-2039702-A,A01B39/19
US-2039702-A,A01B39/19
AU-7115874-A,A01B35/26
GB-436304-A,A01B35/16
GB-436304-A,A01B33/021
US-5669452-A,A01B35/04
US-5669452-A,A01B35/04
CA-2543900-A1,A01B33/103
CA-2543900-A1,A01B33/103
AU-2002301383-B2,A01B35/225
AU-2002301383-B2,A01B35/225
EP-3474651-C0,A01B33/06
EP-3474651-C0,A01B35/16
US-1093294-A,A01B3/10
KR-20070101567-A,A01B33/146
KR-20070101567-A,A01B33/06
DE-1963184-U,A01B33/08
DE-1963184-U,A01B33/10
DE-1963184-U,A01B33/00
KR-101169320-B1,A01B35/10
KR-101593221-B1,A01B3/36
CN-108289407-A,A01B33/16
CN-108289407-A,A01B33/16
CN-108289407-A,A01B35/32
FR-2943502-A1,A01B39/163
US-159642-A,A01B35/08
US-395573-A,A01B35/26
GB-696973-A,A01B35/06
IL-268624-A,A01B3/24
IL-268624-A,A01B3/24
US-2597821-A,A01B39/00
US-2597821-A,A01B39/00
US-2597821-A,A01B35/26
US-2597821-A,A01B35/26
US-1081539-A,A01B35/06
US-376176-A,A01B3/26
GB-792883-A,A01B3/36
US-5407014-A,A01B31/00
US-5407014-A,A01B31/00
KR-100626846-B1,A01B3/50
BE-727862-A,A01B33/021
US-1636048-A,A01B35/24
US-1636048-A,A01B35/24
KR-200149462-Y1,A01B35/28
KR-20010029583-A,A01B33/00
CN-105325075-A,A01B33/103
CN-105325075-A,A01B33/024
CN-109005687-A,A01B33/065
CN-109005687-A,A01B33/082
CN-109005687-A,A01B33/08
GB-2598141-A,A01B39/06
GB-2598141-A,A01B39/18
GB-2598141-A,A01B39/18
CN-107646212-A,A01B35/22
CN-107646212-A,A01B35/04
IT-1166526-B,A01B33/146
IT-1166526-B,A01B33/106
IT-1166526-B,A01B33/065
IT-1166526-B,A01B33/065
IT-1166526-B,A01B33/106
IT-1166526-B,A01B33/146
DE-102017102683-A1,A01B35/18
KR-101378314-B1,A01B33/082
US-231385-A,A01B33/065
CN-116671357-A,A01B39/085
CN-116671357-A,A01B39/22
CN-116671357-A,A01B39/20
GB-2039201-B,A01B33/106
KR-100191418-B1,A01B35/28
KR-100191418-B1,A01B35/18
US-130700-A,A01B35/08
FR-960102-A,A01B33/087
FR-960102-A,A01B33/082
US-5267618-A,A01B3/46
US-5267618-A,A01B3/46
US-220177-A,A01B35/18
US-3054462-A,A01B35/12
US-3054462-A,A01B35/12
FR-508965-A,A01B3/30
FR-508965-A,A01B3/18
KR-20130063834-A,A01B39/18
DE-140654-C,A01B3/12
US-10375891-B2,A01B39/18
US-10375891-B2,A01B39/18
US-10375891-B2,A01B39/18
CN-114916261-A,A01B35/20
CN-114916261-A,A01B35/26
NO-910950-L,A01B35/26
CA-3089518-A1,A01B39/18
BE-826346-A,A01B33/106
BE-826346-A,A01B33/106
GB-2090713-B,A01B35/12
GB-2090713-B,A01B39/10
GB-2090713-B,A01B35/12
GB-2090713-B,A01B39/10
DE-829523-C,A01B3/32
CN-100366901-C,A01B33/021
KR-20020067218-A,A01B39/18
CN-115362764-A,A01B35/16
CN-115362764-A,A01B35/28
NO-153631-B,A01B35/00
CN-104040083-B,A01B33/14
DE-8707829-U1,A01B33/142
KR-200487998-Y1,A01B39/18
AT-A720679-A,A01B33/106
NL-7909063-A,A01B33/103
US-469659-A,A01B35/08
CN-108575125-A,A01B33/12
CN-108575125-A,A01B33/10
CN-113796181-A,A01B33/08
CN-113796181-A,A01B33/10
CN-106973572-B,A01B39/18
NL-183071-C,A01B33/065
NL-183071-C,A01B33/065
JP-S6342702-Y2,A01B33/028
JP-6910281-B2,A01B33/028
JP-6910281-B2,A01B33/024
US-2545590-A,A01B33/025
US-2545590-A,A01B33/025
CA-997451-A,A01B3/74
AU-2016269849-A1,A01B39/18
AU-2016269849-A1,A01B39/18
DE-102010019819-B4,A01B3/464
BE-872468-A,A01B33/065
BE-872468-A,A01B33/16
BE-872468-A,A01B33/12
US-5845717-A,A01B37/00
US-5845717-A,A01B37/00
PL-440426-A1,A01B33/00
PL-440426-A1,A01B33/021
PL-440426-A1,A01B33/02
PL-440426-A1,A01B33/04
BE-1007083-A5,A01B39/16
BE-1007083-A5,A01B39/26
JP-6998053-B2,A01B39/18
JP-6998053-B2,A01B39/18
US-694931-A,A01B3/08
CN-109392332-A,A01B35/20
CN-109392332-A,A01B35/26
DE-463858-C,A01B35/04
CA-2945250-A1,A01B33/106
CA-2945250-A1,A01B33/106
EP-3586579-A1,A01B33/087
EP-3586579-A1,A01B37/00
US-2024164239-A1,A01B35/08
US-2024164239-A1,A01B35/08
US-2024164239-A1,A01B35/08
FR-2287837-B1,A01B33/024
FR-2287837-B1,A01B33/08
FR-2287837-B1,A01B33/021
FR-2287837-B1,A01B33/08
FR-2287837-B1,A01B33/021
FR-2287837-B1,A01B33/024
CN-107072143-A,A01B35/225
CN-107072143-A,A01B35/225
CN-107072143-A,A01B35/225
CN-107094377-A,A01B33/08
CN-107094377-A,A01B33/144
ZA-808003-B,A01B39/22
ZA-808003-B,A01B35/225
ZA-808003-B,A01B39/22
ZA-808003-B,A01B35/225
GB-2089182-B,A01B33/065
IT-1064821-B,A01B33/065
IT-1064821-B,A01B33/065
CA-2977468-A1,A01B33/024
KR-200194260-Y1,A01B35/10
KR-20020000597-A,A01B35/22
CN-114651538-A,A01B39/22
CN-114651538-A,A01B39/18
CN-114651538-A,A01B39/085
IT-8519066-

2025-01-16 03:10:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:10:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:10:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:10:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 87
2025-01-16 03:10:26 - snowflake.connector.connection - INFO - closed
2025-01-16 03:10:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:10:27 - root - INFO - SQL:
-- Query 10: Get assignee names for patents in CPC code 'A01B3%'
SELECT DISTINCT h.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") f,
     LATERAL FLATTEN(input => t."assignee_harmonized") h
WHERE f.value:"code"::STRING LIKE 'A01B3%'
LIMIT 1000;
Results:
assignee_name
TRECKER FRANCIS J
KUHN SA
GEORGE A KELLY PLOW COMPANY
GUERBET FRANCOIS
MARTIN DOMINIC R
GLASIER HAROLD H
INT HARVESTER GREAT BRITAIN
BULLS CO LTD
HUBEI SHUANGYU MACHINERY TECH CO LTD
TWOSE OF TIVERTON LTD
WILLIAM HENRY HONY FROST
WALLNER KLAUS
ELEOS ROBOTICS INC
SJOEHOLMS MEKANISKA AB
HUBER FRANZ FERDINAND
UNIV HEILONGJIANG SCI & TECH
SAMSUNG SDI CO LTD
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY
GERBER HUBERT
WANG XUEDONG
NIEMEYER SOEHNE STAHL PFLUG
ARWAC LTD
QUINSTAR CORP
DAEHO FARMING MACHINERY CO LTD
SHEPPARD RICHARD H
RICHARD CO
PREC PLANTING LLC
ZHANG LIJIN
SIGFRID ANDERSON ANDERS
MARTIN CHARLES H
NEW ZEALAND INVENTIONS DEV
LG ELECTRONICS INC
HARRELL DANNY H
CAMPBELL CLARENCE L
CHOATE STOREY NORMAN
ARTHUR BROOKS SPURR
LEINFELDER DIPL-LANDW HERMANN
KORSMEYER ERNEST H
LIM HEON HO
HOLGER LETH
CHONGQING TIANJI IND CO LTD
JIM ALEX SMITH
BOTVID SETTERGREN ANDERS GOSTA
LEMKEN GMBH & CO KG
AUGUST SETTERGREN OTTO GORAN
GERBER MAURICE
FISHER VAN E
KUBOTA KK
SALGE HENRY F
KIM JONG JIN
SAPHIR MASCHB GMBH
Liu Yueshang
CHONGQING YUBAO AGRICULTURE EXPL CO LTD
MCKAY RALPH LTD
WALTER ROWAN JAMES
UNIV CHUNG ANG IND
DEERE & CO
CHO SUNG GU
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC
CHRISTEN ARNE JENSEN
AMAZONEN WERKE DREYER H
UNIV JIANGSU
SOUTHERN PLOW COMPANY
KIM BYUNG SUB
AMAZONEN-WERKE H DREYER GMBH & CO KG
TEXAS INDUSTRIES INC
EDWARDS JOHN W
EDMOND HEE
RUDOLPH HASSON PAUL
CNH IND AMERICA LLC
LEIJENAAR SYTZE
LELY NV C VAN DER
KIM JAE KEUN
DAIYO TANGO CO LTD
SAMSUNG KWANGJU ELECTRONICS CO
WILLIAM DREFKE
PATENT CONCERN NV
UNIV TONGJI
OTULAK PRZEMYSLAW PRO CNC
CHRISTOPHER H R WOODWARD
CARLUCCI JAMES J
EMPR IMPORT EXPORT Y DISTRIB P
ALLEN SAMUEL L
AGSOILWORKS TECH COMPANY LLC
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD
UNIV SYDNEY
BETEK GMBH & CO KG

2025-01-16 03:10:27 - root - INFO - itercount: 0
2025-01-16 03:10:27 - root - INFO - Database Name: PATENTS
Schema Name: PATENTS
DDL describes table information.
,0
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,1
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""spif_publication_number"" VARCHAR(16777216),
	""spif_application_number"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""claims_localized_html"" VARIANT,
	""description_localized"" VARIANT,
	""description_localized_html"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""locarno"" VARIANT,
	""citation"" VARIANT,
	""parent"" VARIANT,
	""child"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,2
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table:** `PATENTS.PATENTS.PUBLICATIONS`
  - **"cpc"**: Used to filter patents classified under A01B3.
  - **"assignee_harmonized"**: Contains assignee names; used to extract assignee information.
  - **"filing_date"**: Used to determine the year of application filings.
  - **"publication_date"**: May be used if filing dates are not available.
  - **"country_code"**: Used to identify the country code for applications.

**Conditions That May Be Used:**

- Filtering the "cpc" column to include only codes starting with 'A01B3'.
- Extracting years from the "filing_date" column.
- Flattening VARIANT columns like "cpc" and "assignee_harmonized" to access nested data.
- Using `LIKE` clauses with wildcards (`%`) for pattern matching on strings.

---

Here are 10 SQL queries to explore the relevant data:

```sql
-- Query 1: Get sample values from the "cpc" column
SELECT t."cpc"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 1000;
```

```sql
-- Query 2: Flatten and view individual CPC entries
SELECT f.value
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
LIMIT 1000;
```

```sql
-- Query 3: Extract distinct CPC codes
SELECT DISTINCT f.value:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
LIMIT 1000;
```

```sql
-- Query 4: Get sample values from the "assignee_harmonized" column
SELECT t."assignee_harmonized"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 1000;
```

```sql
-- Query 5: Flatten and view individual assignee entries
SELECT h.value
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."assignee_harmonized") h
LIMIT 1000;
```

```sql
-- Query 6: Extract distinct assignee names
SELECT DISTINCT h.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."assignee_harmonized") h
LIMIT 1000;
```

```sql
-- Query 7: Extract filing years from the "filing_date" column
SELECT DISTINCT SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE t."filing_date" IS NOT NULL
LIMIT 1000;
```

```sql
-- Query 8: List of distinct country codes
SELECT DISTINCT t."country_code"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 1000;
```

```sql
-- Query 9: Find publications classified under CPC code 'A01B3%'
SELECT t."publication_number", f.value:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") f
WHERE f.value:"code"::STRING LIKE 'A01B3%'
LIMIT 1000;
```

```sql
-- Query 10: Get assignee names for patents in CPC code 'A01B3%'
SELECT DISTINCT h.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") f,
     LATERAL FLATTEN(input => t."assignee_harmonized") h
WHERE f.value:"code"::STRING LIKE 'A01B3%'
LIMIT 1000;
```

---

These queries are designed to help understand the structure and content of the relevant columns in the `PUBLICATIONS` table. They use simple `SELECT` statements with `LATERAL FLATTEN` to access nested data within VARIANT columns and `LIMIT 1000` to restrict the output for manageability.Query:
-- Query 1: Get sample values from the "cpc" column
SELECT t."cpc"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 1000;
Answer:
Too long, hard cut:
cpc
[]
[]
[]
"[
  {
    ""code"": ""H02M5/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""A01N47/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D521/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""Y02A40/81"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""Y02E30/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""Y10T83/465"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""B26F1/42"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""B22D11/086"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""C07D471/16"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D471/22"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""G01N33/48728"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""C11B5/0064"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/35"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C11B5/0035"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M135/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C09K15/30"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D263/56"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/44"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D235/12"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/3447"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/48"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/46"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D277/64"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/47"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/224"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/102"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/106"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/104"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/10"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/221"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/226"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/225"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/22"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10L1/14"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""E02D5/808"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/385"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/26"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/28"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/54"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
[]
[]
"[
  {
    ""code"": ""C07D213/32"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/51"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/51"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/22"",
    ""first"": true,
    ""inventive"": true,
    ""t
Query:
-- Query 2: Flatten and view individual CPC entries
SELECT f.value
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
LIMIT 1000;
Answer:
Too long, hard cut:
VALUE
"{
  ""code"": ""G01N2030/202"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""Y10T137/86815"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""G01N2030/202"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""G01N30/6047"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""F16K11/074"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G01N30/20"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""F16K11/074"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""B01D15/1821"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""G01N30/20"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""B01D15/1821"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""G01N30/6047"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""G01N2030/201"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""G01N2030/201"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""Y10T137/86815"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""G01N30/461"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""G01N30/461"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""A61K31/00"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""A61K31/00"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G02B7/16"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G02B7/16"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G02B21/248"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""Y10T74/19749"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""Y10T74/19749"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""G02B21/248"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06F13/4077"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H04L5/16"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06F13/4077"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H04L5/16"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G11B7/004"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G11B7/00375"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G11B20/10"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G11B19/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G11B7/00375"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G11B19/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06V20/66"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06V10/143"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06V20/66"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06V10/143"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06V20/80"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06V20/80"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C03C3/095"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C03C3/091"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C09D11/03"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C03C12/00"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C03C3/091"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C03C12/00"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C03C3/095"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C09D11/03"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L28/91"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L28/91"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H10B12/033"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H10B12/00"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H10B12/033"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H10B12/318"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H10B12/318"",
  
Query:
-- Query 3: Extract distinct CPC codes
SELECT DISTINCT f.value:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
LIMIT 1000;
Answer:
Too long, hard cut:
cpc_code
H05K2203/1327
H04B1/0057
G06T19/006
H01L21/50
B32B27/308
B32B27/32
C09D7/65
C01B9/04
H01L21/76849
A61G13/02
G06K9/00369
G06F40/279
H04B7/086
B32B37/12
G01N15/14
H04W72/542
A61K31/282
G01D11/245
G01D21/00
F16F9/19
H04W64/00
H01L45/08
H02J7/04
H01L21/823437
F41C23/04
F02D2250/36
C04B2111/40
F02B67/00
H01L24/19
C07F15/0093
G01N15/1459
G02B27/0172
F02M26/00
F24D2220/042
A61K2300/00
Y02P70/10
C23C18/24
Y02T70/10
C07K5/06034
F21V5/008
C07F15/025
A61K39/0017
A61B17/3468
A63C10/24
F16L3/1236
B29C70/003
H04M19/08
F22G7/14
C08F299/065
C09K5/063
B82Y40/00
H01L21/3065
H04N2201/3278
C09D11/17
H04L67/10
H04L41/22
H01M8/04671
B29C48/913
H05K7/20545
H04M3/42314
G01N33/74
C08G65/30
A01K2207/15
C08L77/06
C07F7/126
F24H9/02
G06Q50/02
H04N21/4147
H01M4/62
E05B17/0058
A61K31/439
A23K20/24
B60W2710/083
A47C1/032
B62D1/185
E02F9/2217
C22C21/08
B32B2307/746
G02B1/18
G06T2207/10088
A61L2/10
A61N5/0616
G06F2201/88
G06K9/2063
E04F13/06
H04N19/159
G06T9/004
G06F2009/4557
H04N19/114
A61M25/1027
C09D5/00
F05D2260/98
F02C7/266
G07C5/008
G09G2330/023
A61K31/065
A43B1/0009
A47J31/18
D04H1/587
A61B2017/07257
A61K2800/5426
B23K2103/02
B23K35/3053
G10L15/08
G06F19/3475
B01D61/10
H01L24/09
H03K3/84
G01K7/42
A61B17/0401
G06F9/3808
E21B43/084
C30B25/10
F04B1/12
H01L27/3272
F02B2053/005
C09J2489/00
A43B13/125
A23L19/00
G02B27/0093
B66D1/14
G06F1/1626
H01S3/076
H04L45/02
G03G15/5041
A61K31/195
G06Q30/0278
A61L27/50
H01M4/381
B21B45/004
A61H2201/0157
G11C29/52
A63F2300/63
G06Q30/0267
B01D53/268
G06T2207/20021
C30B25/18
E04H15/06
G16H20/40
G06F2203/04105
A23K40/30
B29C55/04
G01S2205/01
G06F16/43
B01J35/56
H02J50/20
H01L33/145
C12N15/1065
C12N2310/20
B01D53/263
F02N2200/022
H04B5/0087
B33Y50/00
D07B2201/2043
A61L29/14
A46B7/044
H02P7/29
E05B45/12
H04B17/382
A23L27/20
Y10T29/49885
A47C1/12
G02B2027/0165
A61B17/12109
F41H5/0471
C04B38/0022
B01D1/221
E06B9/171
H04N9/888
C07D231/14
B60G17/0152
B60G2202/42
A47C4/286
E01C19/176
F02M59/48
H01J2237/221
H02J7/0063
H01M16/00
C09J7/00
A61F5/56
C04B2201/10
B01D39/2017
B32B27/28
A61M1/3427
B63C11/18
G01N2223/6116
B41K1/58
B63B2704/00
B60Y2200/92
A63F2300/8047
G06T2207/20092
E01C15/00
C08F2/001
H10K59/129
H01L27/0292
A46B13/02
F16K15/18
C04B33/34
H04Q1/144
F04C2/344
D21D5/24
G06F17/30876
A61B2017/00353
B23K26/127
H03M13/2792
C04B35/6261
B63B13/02
A41C1/00
B01D2253/108
B23K2101/42
B60W10/10
H04J11/0093
B60L58/30
F23R3/286
G06V20/58
B32B2457/20
H04L69/04
G06F2203/04112
G02B5/3033
D02J1/08
G06F17/30138
G07F11/10
B03B4/005
G01J3/108
Y10T83/8716
F24F3/153
F23Q2/32
B44C5/0407
C08K3/24
B65D47/2037
H04L9/00
E06B9/15
E21B47/01
B29C2949/08
B67B7/44
F16H61/30
B29D22/00
B65H21/00
B23B27/22
B64C3/54
C07C323/44
F25D23/065
F01D5/025
F01N13/001
H01H67/06
B29C73/02
G06F16/2471
H02G15/013
A61K49/0036
B60L2240/545
H01L23/3675
C03B37/0124
C12N2500/02
A61M2037/0023
A61M2037/0046
B25J19/021
H04N19/85
G06F3/0655
C22C38/10
A63B69/0059
H04L12/1822
G01V2210/244
Y10T409/307672
B23K35/286
G01J3/04
B23K35/325
A61B2017/2904
A61B2090/037
A61K49/0065
H04B1/71632
G06F9/44505
B65G47/71
H01L29/7889
B60L3/0069
A61M2025/0226
C09J7/02
A61N1/36135
A61N1/37217
C10N2040/42
H01L33/486
B67D3/0029
A61B1/31
H01L33/10
Y10T137/8593
A61H2230/10
F16C2300/34
Y10T29/49032
B81B2201/042
C09J163/00
B60S1/3887
A63F13/56
G02F1/133317
B01J2219/0801
H03K17/693
A61K47/59
C04B35/63428
B27G19/04
C12Q2525/307
C07C213/06
A61C3/025
A61K51/1251
C08G64/22
A47B47/005
A61K36/233
G01J5/10
A61K36/232
B67D1/0009
B67D1/0412
B60P1/34
B65G1/0478
H04W36/0064
G06N3/067
A61F2/2466
A61L2/238
G06F18/217
H02H3/343
B01D2258/014
H03K5/135
H04L41/0816
H04L43/0811
F02D41/1462
H01L2924/20753
Y10T428/24702
F42C19/00
G11C2013/0092
A61B8/485
H02K1/187
F05D2240/303
F16H37/12
B23D45/048
Y10S901/36
H02M1/0054
H01S5/028
B29C2045/1741
H05K13/08
H03F3/20
G06F3/06
C08G59/621
H04N23/611
H02K3/345
F16H2025/2481
H01L43/10
H01L2224/05157
A61B5/4504
G02B6/06
H01L2224/03462
A61H2201/1436
C23F13/005
H05K3/426
F24C15/2035
Y02P30/00
H04W36/0016
A61M1/1524
H04K3/224
C01B3/42
G03G15/04054
A61M60/40
A61B2017/2906
H03K19/17764
F16L1/10
G06Q10/047
H04L12/2856
A61B2017/0464
G11B20/1879
G06F21/31
C08F251/02
A43B17/026
Y10T29/49989
B01D2256/10
B25B27/06
C09K9/02
G06T2207/10012
G08B13/1427
A61N1/378
G06T2207/30024
B65H2403/73
E05B77/38
B60W2556/65
G01S19/37
G02F1/133621
G06V40/197
H04N1/00708
G06N3/0418
G05D1/24
H01L21/187
H01L27/11514
H02K33/02
B65D25/108
Y10T83/155
A61K39/001103
H04L2012/5614
H05K2201/09736
A61B5/0836
F02M63/0078
B22D11/0406
A61K31/4172
H01L2224/82101
B65D5/241
B65D5/2019
H01L24/40
B65H2801/31
C21B2400/08
F04C18/16
C12Y302/01091
A61B8/5253
G01N21/8806
H10N70/884
C07F15/0046
C12Q1/04
F16F7/123
B01D2257/404
H04N9/3114
H04M1/0216
B60L2240/507
G02B5/3008
C08G75/045
A61M25/003
C08G63/00
C09J9/00
H01J37/32669
C04B2111/00767
F15B2211/265
G02B17/0812
G06F2200/1633
H01M50/533
G06F17/241
A63B45/00
F16C2316/10
H01M8/0606
A61F2002/91591
B65D2575/329
A61F2013/00246
B01D46/69
B32B2307/584
G16B20/10
H04N19/96
H01H13/81
C09D5/1668
F25C5/182
A61H2201/123
B24D3/002
C07F7/0838
C07D211/66
H04B1/18
A63B21/0407
H04W36/
Query:
-- Query 4: Get sample values from the "assignee_harmonized" column
SELECT t."assignee_harmonized"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 1000;
Answer:
Too long, hard cut:
assignee_harmonized
"[
  {
    ""country_code"": ""CR"",
    ""name"": ""UNIV COSTA RICA""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BAYER AG""
  }
]"
[]
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""CRABTREE ELECTRICAL IND LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""BASF AG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""MORITA SANGYO KK""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""TOSHIBA CORP""
  }
]"
[]
"[
  {
    ""country_code"": """",
    ""name"": ""ADOLPH BEREN""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""VOEST ALPINE AG""
  }
]"
"[
  {
    ""country_code"": ""HU"",
    ""name"": ""CHINOIN GYOGYSZER ES VEGYESZET""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""PFUETZNER HELMUT DIPL ING DR T""
  },
  {
    ""country_code"": ""AT"",
    ""name"": ""KRAUSE ERWIN DIPL ING""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BROCKWAY GLASS CO INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""CIBA GEIGY""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""MUELLER G""
  }
]"
"[
  {
    ""country_code"": ""CA"",
    ""name"": ""SHARMAN JAMES""
  }
]"
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""LE BLON CHARLES""
  },
  {
    ""country_code"": ""FR"",
    ""name"": ""A OBLASSER A GODDYN ET CIE SOC""
  }
]"
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""ICI LTD""
  }
]"
"[
  {
    ""country_code"": ""IT"",
    ""name"": ""FARINA & FIGLI A""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""KNOBEL & HEER""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""ROESCH ARTHUR""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""ENGEL HUGO""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BOECKLEIN JOSEF""
  }
]"
[]
[]
"[
  {
    ""country_code"": """",
    ""name"": ""M & T CHEMICALS INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""LOEWE OPTA AG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""BAYER AG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""MITSUBISHI HEAVY IND LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""GLOBE UNION INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ISAP SPA""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""JOSHUA BIGWOOD AND SON LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ERWIN SCHWARZ""
  }
]"
[]
"[
  {
    ""country_code"": """",
    ""name"": ""BOSCH GMBH ROBERT""
  }
]"
"[
  {
    ""country_code"": ""NL"",
    ""name"": ""PHILIPS NV""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""SUWA SEIKOSHA KK""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""NIPPON STEEL CORP""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""HOLLINGSWORTH GMBH""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""ECKOLD VORRICHTUNG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""DOWELANCO""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""IGARASHI KAZUYOSHI""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HITACHI LTD""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""CHIYODA CORP""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ROUSSEL UCLAF""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""PETROL ENGINERING S A""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""IRECO CHEMICALS""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""COLGATE PALMOLIVE CO""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""FERRER INT""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""LILLY CO ELI""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""MAUSER WERKE GMBH""
  }
]"
[]
"[
  {
    ""country_code"": """",
    ""name"": ""HOEYER ELLEFSEN AS""
  }
]"
[]
[]
"[
  {
    ""country_code"": ""IT"",
    ""name"": ""SOMET SOC MEC TESSILE""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""MIODRAG SPASOJEVIC""
  }
]"
"[
  {
    ""country_code"": ""YU"",
    ""name"": ""TEHNOLOSKI FAK N SAD""
  }
]"
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""BEECHAM GROUP LTD""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""HOECHST AG""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""BLUM GMBH JULIUS""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""SCHWAMM HORST""
  },
  {
    ""country_code"": ""AT"",
    ""name"": ""PEZZEI FRIEDBERT""
  },
  {
    ""country_code"": ""AT"",
    ""name"": ""KREMS CHEMIE GMBH""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""ELTREVA AG""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""GANNER ERWIN""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""GRASS ALFRED METALLWAREN""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""INKOMAG FA""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""PROHASKA HEINZ""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""SIEMENS AG OESTERREICH""
 
Query:
-- Query 5: Flatten and view individual assignee entries
SELECT h.value
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."assignee_harmonized") h
LIMIT 1000;
Answer:
Too long, hard cut:
VALUE
"{
  ""country_code"": ""US"",
  ""name"": ""STEVEN SCHON""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""SHACHIHATA INC""
}"
"{
  ""country_code"": ""IE"",
  ""name"": ""ONKIMMUNE LTD""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""ADVANCED COMPUTER AND COMMUNICATIONS L L C""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""UNITED TECHNOLOGIES CORP""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""SCHILLER GROUNDS CARE INC""
}"
"{
  ""country_code"": ""BE"",
  ""name"": ""JANSSEN PHARMACEUTICA NV""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""HAGGAN WILLIE""
}"
"{
  ""country_code"": ""CN"",
  ""name"": ""LENOVO BEIJING LTD""
}"
"{
  ""country_code"": ""KR"",
  ""name"": ""JAHWA ELECTRONICS CO LTD""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""TOSHIBA KK""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""SERVUTAS VITALI""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""XEROX CORP""
}"
"{
  ""country_code"": ""GB"",
  ""name"": ""ADVANCED RISC MACH LTD""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""UNIV MICHIGAN REGENTS""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""IBM""
}"
"{
  ""country_code"": ""TW"",
  ""name"": ""SUPERC TOUCH CORP""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""PETRUKHIN KONSTANTIN""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""CIOFFI CHRISTOPHER""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""JOHNSON GRAHAM""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""DOBRI NICOLETA""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""FREEMAN EMILY""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""CHEN PING""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""CONLON MICHAEL""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""ZHU LEI""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""UNIV COLUMBIA""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""TOSHIBA TEC KK""
}"
"{
  ""country_code"": ""KR"",
  ""name"": ""SK HYNIX INC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""COMMVAULT SYSTEMS INC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""BARD INC C R""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""BARD INC C R""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""OLYMPUS CORP""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""SONY CORP""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""BRIDGESTONE CORP""
}"
"{
  ""country_code"": ""GB"",
  ""name"": ""CP CASES LTD""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""SUMITOMO RUBBER IND""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""TORAY INDUSTRIES""
}"
"{
  ""country_code"": ""MT"",
  ""name"": ""CAREBAY EUROPE LTD""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""NTN TOYO BEARING CO LTD""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""HARMAN INT IND""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""NIPPON STEEL & SUMITOMO METAL CORP""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""TUNGALOY CORP""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""KEWPIE CORP""
}"
"{
  ""country_code"": ""DE"",
  ""name"": ""NEC EUROPE LTD""
}"
"{
  ""country_code"": ""TW"",
  ""name"": ""HOU HAO HSUN""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""UNIV CHICAGO""
}"
"{
  ""country_code"": ""IR"",
  ""name"": ""KARIMZADEH RAMIN""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""NXP USA INC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""FRACTAL ANTENNA SYSTEMS INC""
}"
"{
  ""country_code"": ""GB"",
  ""name"": ""ADVANCED RISC MACH LTD""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""INCYTE CORP""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""RED HAT INC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""SEAGATE TECHNOLOGY LLC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""GUARDIAN INDUSTRIES""
}"
"{
  ""country_code"": ""KR"",
  ""name"": ""DAEGU GYEONGBUK INST SCIENCE & TECH""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""SERVANT'S HEART OUTFITTERS L L C""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""PACIFIC BIOSCIENCES CALIFORNIA INC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""MICROSOFT TECHNOLOGY LICENSING LLC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""FITBIT INC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""APPLE INC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""PROFESSIONAL DISPOSABLES INT INC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""TRW AUTOMOTIVE US LLC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""MICROSOFT TECHNOLOGY LICENSING LLC""
}"
"{
  ""country_code"": ""CA"",
  ""name"": ""SPORT MASKA INC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""SENSITY SYSTEMS INC""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""SEIKO EPSON CORP""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""FACEBOOK INC""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""OLYMPUS CORP""
}"
"{
  ""country_code"": ""GB"",
  ""name"": ""CRODA INT PLC""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""FUJIFILM CORP""
}"
"{
  ""country_code"": ""IE"",
  ""name"": ""ACCENTURE GLOBAL SOLUTIONS LTD""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""LEBLAND DENNIS""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""ELWHA LLC""
}"
"{

Query:
-- Query 6: Extract distinct assignee names
SELECT DISTINCT h.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."assignee_harmonized") h
LIMIT 1000;
Answer:
Too long, hard cut:
assignee_name
EKMAN MATTHEW
TEIJIN LTD
MURATA MANUFACTURING CO
BOE TECHNOLOGY GROUP CO LTD
KONINKLIJKE PHILIPS NV
LEPIDEXT
ADAMA MAKHTESHIM LTD
BLACK SESAME INTERNATIONAL HOLDING LTD
PGS GEOPHYSICAL AS
IZI MEDICAL PRODUCTS LLC
AVERY DENNISON CORP
PIONEER HI BRED INT
UNIV SHANDONG SCIENCE & TECH
ACER INC
OMNICELL INC
M TECHNIQUE CO LTD
BAKER HUGHES INC
UNIV EAST CHINA SCIENCE & TECH
The Full Life Company
LG FUEL CELL SYSTEMS INC
MERCK SHARP & DOHME LLC
VNI TEPLOVOZNYJ I
PECHINEY EMBALLAGE FLEXIBLE EU
VUKOBRATOVIC DEJAN
CESKU VYSOKU UCENI TECHNICKU V PRAZE FAKULTA STAVEBNI
KLEMENT GOTTWALD WERKE VEB
TLV CO LTD
LEIBFRIED GMBH K
RINDCHEN MARKUS
MEDIPOST CO LTD
OLEJNIK VINCENT
MUELLER CHRISTOPH
VALEO EQUIP ELECTR MOTEUR
COOK INC
ROPUR AG
AKTSIONERNOE OBSHTESTVO TVЭL
CELGENE CORP
MA CHAO
MALLARD DEAN
PANASONIC CORP
CONOPCO INC DBA UNILEVER
SOFT LINES INT LTD
HOSOYA YOICHI
UMEHARA HIDEAKI
DENKA COMPANY LTD
REPUBLIC OF KOREA RURAL DEV ADMINISTRATION
MALL GMBH
WERMA HOLDING GMBH CO KG
DEED S R L
SHELL OIL CO
INFINEON TECHNOLOGIES AUSTRIA AG
YARA MARINE TECH AS
METAL PROCESS COMPANY
CARPENTER FRED A
PHILLIPS PETROLEUM CO
OHIO BRASS CO
WOOD NEWSPAPER MACH CORP
JACK CATHRILL
DOW CHEMICAL CO
CREUSOT LOIRE
NIPPON LIGHT METAL RES LABOR
TUTTLE AND KIFT
M & T CHEMICALS INC
B S C IND CORP
FROST HARRISON CLEMENT
NORTON JOHN HENRY
FORTIN & SAUNIER ETS
MASSEY FERGUSON INC
GUSTAVO DUFOUR
MARK ANDRE
SVILUPPO SILICALCITE S P A
CYRIL HERBERT HAMPSON
EDWARD HENRY GEORGE KINGDOM
MITSUBISHI ELECTRIC HOME APPL
BEROL SUISSE SA
HUBER AUGUST
NEOPHARM CO LTD
COAL INDUSTRY PATENTS LTD
XIOTECH CORP
TAKEUCHI TOMONARI
FARRELL GREG ROBERT
YAMAZAKI MANABU
YODA KENTARO
FINO FEDERICA
SINGH SATNAM
FARGO RICHARD N
GOBERNA SELMA CONSUELO
OKAMOTO HIROSHIGE
KIM JOUNG CHUL
HAMAD WADOOD Y
LINDSEY SCOTT E
MICROMASS LTD
MACRONIX INT CO LTD
VERIZON PATENT & LICENSING INC
RACEPOINT ENERGY LLC
UNIV LOUISVILLE RES FOUND INC
PLOMSKE MICHELLE K
FUJI PHOTO FILM CO LTD
WANG HONGMEI
PEDROZO HUGO A
BREEN THOMAS J
VOGEL MARK S
SUZUKI TAKASHI
MUELLER BERND
PARK CHAN-WOO
BAETGE E E
DAS SAUMITRA
FUJI KIKO KK
PHILLIPS 66 CO
TOSHIBA MEDICAL SYS CORP
US SECRETARY THE DEPT OF HEALTH AND HUMAN SERVICES
STRAUSS LEVI & CO
UNION SWITCH & SIGNAL CO
ORVILLE INGRAM
OLIPASS CORP
GATHMANN EMIL
PHARMACOPEIA DRUG DISCOVERY
EGA ELECTRIC LTD
PLEXOWOOD
SHIPLEY CO
TRIMYER HERVY LINWOOD
CANADIAN IND
RAMBO WILLIAM H
CHILEAN NITRATE SALES CORP
UNIVEYOR AS
RAU SWF AUTOZUBEHOER
PRECUP EMILE
AUTOMOTIVE PROD CO LTD
MIN HUNG KI
JUNKER & RUH AG
ARMCO STEEL CORP
VDO SCHINDLING
UDDEHOLMS AB
MARIUS LATOUR
NIPPON TEIKOKI SEISAKUSHO KK
FLOOD MICHAEL T
MORIARTY KEVIN P
KHODAREV NIKOLAI
LIU KAI
AIDUN MEHRDAD
JALUNA SA
HYPERROLL ISRAEL LTD
FAN JAMES W
MENZEL KARL
SHAH CHIRAG
TOMLINSON JAY S
GREE ELECTRIC APPLIANCES WUHAN CO LTD
WOLF GMBH RICHARD
R P SCHERER TECHNOLOGIES LLC
UNITED NEUROSCIENCE
JAPAN AVIATION ELECTRONICS IND LTD
SOLARFLARE COMMUNICATIONS INC
IDEMIA FRANCE
EFFICIENCY MATRIX PTY LTD
VON KRIES KARL
PETROLEO BRASILEIRO S A – PETROBRAS
KRUPP KOPPERS GMBH
CHINA TOBACCO HUNAN IND CO LTD
AUTOMOTIVE CELLS COMPANY SE
SHENZHEN LUTE JIACHENG SUPPLY CHAIN MAN CO LTD
UNIV HOKKAIDO NAT UNIV CORP
ADENWALA FATEMA S
ELLI MARIA S
UHL SPORTARTIKEL KARL
ZHAO YONGJUN
DALVAND IZADYAR
DNATRIX INC
FORSCHUNGSVERBUND BERLIN EV
PICCOLO MEDICAL INC
PURE STORAGE INC
Petek Marian
BORDBUSTERS B V I O
KEIPER GMBH & CO KG
EMMERLE MAX
WEBER GERALD
INNOVATE PREFABRICATE INC
ASTRAZANECA AB
KA SHEK LEE
KDB INTELLECTUAL PTY LTD
LAMMERS THOMAS
ISHIKAWAJIMA HARIMA HEAVY IND
BRISTISH AMERICAN TOBACCO INVESTMENTS LTD
SCANIA CV ABP
PALL EUROPE LTD
MAERKL HANS JUERGEN
DAUSINGER & GIESEN GMBH
ESG SUPPLIES LTD
KATRICK TECH LIMITED
BCS BUSINESS CONSULTING SERVICES PTE LTD
HOKURIKU ELECT IND
THE DOE RUN RESOURCES CORP
SANSA CORP BARBADOS INC
SMIT MARTINE
DE HAARD JOHANNES JOSEPH WILHE
PAROS S R L
SCHOLS DOMINIQUE
CARNIVAL CORP
HEFEI BOE DISPLAY TECH CO LTD
MAG ISOVER KK
ACTUALEYES INC
HERE GLOBAL BV
JNTG CO LTD
INNOLITH TECH AG
KOREA INST GEOSCIENCE & MINERAL RESOURCES
SIJBESMA HYLKE
GEGUSSA NOVARA TECHNOLOGY SPA
PFEIFER SEIL HEBETECH
SCHERING AGROCHEMICALS LTD
HANGZHOU CHUAN EN ENVIRONMENTAL TECH CO LTD
NISSENKEN QUALITY EVALUATION CT
JANSEN ALEX
OMEGA SA
ELEKTA INC
FOUNDATION SOONGSIL UNIV INDUSTRY COOPERATION
GEUS HANS GEORG
Ageronix SA
POPEYES LOGISTICS LTD
LIUZHOU OVM MACHINERY CO LTD
TADEPALLI PRABHAKAR
BERNARDINI SRL
QINGDAO HAIER SMART TECH R & D CO LTD
Collar & Ruff
SCHIPS HELMUT
ALCARAZ MARUENDA ALEJO
MILICAN PHILIPPE
SMITHKLINE BECKMAN CORP US
ANDREW BOID FRENCH
NITZ CORP
KENNEDY RHEUMATOLOGY INST
TRW AUTOMOTIVE US LLC
CIMPRESS SCHWEIZ GMBH
IWATANI CORP
Parasol Medical LLC
FLOWAY INC
TREBLE INNOVATIONS LLC
NEC PLATFORMS LTD
MORIKAWA AKIRA
HOSHINO SHO
SONG WEN-WEI
KARLSSON CHRISTER
KREIPL ANDREAS
MATSUDA KOHEI
CHINA TOBACCO HENAN IND CO LTD
CHANGSHA BRIMINS INTELLIGENT SCIENCE AND TECH LIMITED COMPANY
JIANGSU XINYU RESIDENTIAL INDUSTRY TECH CO LTD
JIANGSU WANSHUN NEW ENERGY TECH CO LTD
ZHEJIANG EAST CHINA ENGINEERING CONSTRUCTI
Query:
-- Query 7: Extract filing years from the "filing_date" column
SELECT DISTINCT SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE t."filing_date" IS NOT NULL
LIMIT 1000;
Answer:
filing_year
1948
1927
1983
1978
1904
1930
1994
1991
1914
1921
1889
1975
1902
1959
1919
1893
1881
1998
2009
1950
1933
1970
1941
2014
1963
1952
1920
1922
1923
1886
1997
1880
1996
0
1953
1938
1918
1962
1897
1987
2007
1974
1961
1913
1942
1908
1846
1976
1988
1901
1955
1928
1940
2017
1935
1966
1877
1936
1972
1911
1895
1960
2012
2000
1905
1907
1885
1979
1980
1981
1999
1892
2010
2024
1924
1926
1986
1985
1993
1890
2021
1968
1969
1909
1929
1949
1887
2005
1945
2001
1957
1932
1882
1894
2011
2004
1989
1995
1912
1984
2022
1990
1958
1853
2003
1956
2018
2015
2016
2006
1903
1937
1910
2019
2023
1899
1931
1971
1896
1943
1860
2008
1946
1915
1967
1939
1944
1867
2013
1992
1951
2002
2020
1925
1934
1916
1917
1898
1982
1965
1891
1947
1906
1964
1900
1977
1888
1973
1954
1883
Query:
-- Query 8: List of distinct country codes
SELECT DISTINCT t."country_code"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 1000;
Answer:
country_code
DO
BA
RS
WO
CR
PL
EP
ZA
MY
CS
LV
HR
AU
CU
RO
KR
PT
NZ
CL
NO
HU
JP
DZ
NL
LT
UA
MW
IT
OA
CY
CZ
HN
SV
CH
TR
BG
AT
YU
ZM
MD
ZW
MA
GB
SG
EG
PA
CO
SI
AR
KE
FI
DK
CA
SK
IS
NI
US
PH
DE
DD
MX
EE
GE
HK
TN
GT
BR
ID
LU
GR
RU
JO
IN
EC
SA
MN
SU
FR
PE
KZ
IL
TW
MT
BE
SE
AP
SM
ME
EA
ES
IE
CN
MC
Query:
-- Query 9: Find publications classified under CPC code 'A01B3%'
SELECT t."publication_number", f.value:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") f
WHERE f.value:"code"::STRING LIKE 'A01B3%'
LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,cpc_code
US-2888084-A,A01B33/06
US-1545136-A,A01B39/26
US-1545136-A,A01B39/26
KR-200386017-Y1,A01B3/28
RU-191537-U1,A01B35/20
US-290366-A,A01B35/22
US-3963079-A,A01B35/18
US-3963079-A,A01B39/14
US-3963079-A,A01B39/14
US-3963079-A,A01B35/18
US-2031188-A,A01B33/06
US-2031188-A,A01B33/06
US-2019324472-A1,A01B39/18
HU-E050035-T2,A01B35/24
KR-200473688-Y1,A01B35/16
KR-102593393-B1,A01B33/082
KR-102593393-B1,A01B33/082
KR-102484290-B1,A01B33/14
KR-102484290-B1,A01B35/28
KR-102484290-B1,A01B33/14
KR-102484290-B1,A01B35/28
KR-900006618-B1,A01B33/14
US-828171-A,A01B3/26
US-3129772-A,A01B39/085
US-3129772-A,A01B39/085
US-530054-A,A01B39/14
US-1471180-A,A01B3/50
US-1471180-A,A01B3/50
US-2843032-A,A01B39/14
US-2843032-A,A01B39/14
US-1860534-A,A01B3/50
US-1860534-A,A01B3/50
US-501724-A,A01B3/464
US-2784656-A,A01B35/14
US-2784656-A,A01B35/14
US-2039702-A,A01B39/19
US-2039702-A,A01B39/19
AU-7115874-A,A01B35/26
GB-436304-A,A01B35/16
GB-436304-A,A01B33/021
US-5669452-A,A01B35/04
US-5669452-A,A01B35/04
CA-2543900-A1,A01B33/103
CA-2543900-A1,A01B33/103
AU-2002301383-B2,A01B35/225
AU-2002301383-B2,A01B35/225
EP-3474651-C0,A01B33/06
EP-3474651-C0,A01B35/16
US-1093294-A,A01B3/10
KR-20070101567-A,A01B33/146
KR-20070101567-A,A01B33/06
DE-1963184-U,A01B33/08
DE-1963184-U,A01B33/10
DE-1963184-U,A01B33/00
KR-101169320-B1,A01B35/10
KR-101593221-B1,A01B3/36
CN-108289407-A,A01B33/16
CN-108289407-A,A01B33/16
CN-108289407-A,A01B35/32
FR-2943502-A1,A01B39/163
US-159642-A,A01B35/08
US-395573-A,A01B35/26
GB-696973-A,A01B35/06
IL-268624-A,A01B3/24
IL-268624-A,A01B3/24
US-2597821-A,A01B39/00
US-2597821-A,A01B39/00
US-2597821-A,A01B35/26
US-2597821-A,A01B35/26
US-1081539-A,A01B35/06
US-376176-A,A01B3/26
GB-792883-A,A01B3/36
US-5407014-A,A01B31/00
US-5407014-A,A01B31/00
KR-100626846-B1,A01B3/50
BE-727862-A,A01B33/021
US-1636048-A,A01B35/24
US-1636048-A,A01B35/24
KR-200149462-Y1,A01B35/28
KR-20010029583-A,A01B33/00
CN-105325075-A,A01B33/103
CN-105325075-A,A01B33/024
CN-109005687-A,A01B33/065
CN-109005687-A,A01B33/082
CN-109005687-A,A01B33/08
GB-2598141-A,A01B39/06
GB-2598141-A,A01B39/18
GB-2598141-A,A01B39/18
CN-107646212-A,A01B35/22
CN-107646212-A,A01B35/04
IT-1166526-B,A01B33/146
IT-1166526-B,A01B33/106
IT-1166526-B,A01B33/065
IT-1166526-B,A01B33/065
IT-1166526-B,A01B33/106
IT-1166526-B,A01B33/146
DE-102017102683-A1,A01B35/18
KR-101378314-B1,A01B33/082
US-231385-A,A01B33/065
CN-116671357-A,A01B39/085
CN-116671357-A,A01B39/22
CN-116671357-A,A01B39/20
GB-2039201-B,A01B33/106
KR-100191418-B1,A01B35/28
KR-100191418-B1,A01B35/18
US-130700-A,A01B35/08
FR-960102-A,A01B33/087
FR-960102-A,A01B33/082
US-5267618-A,A01B3/46
US-5267618-A,A01B3/46
US-220177-A,A01B35/18
US-3054462-A,A01B35/12
US-3054462-A,A01B35/12
FR-508965-A,A01B3/30
FR-508965-A,A01B3/18
KR-20130063834-A,A01B39/18
DE-140654-C,A01B3/12
US-10375891-B2,A01B39/18
US-10375891-B2,A01B39/18
US-10375891-B2,A01B39/18
CN-114916261-A,A01B35/20
CN-114916261-A,A01B35/26
NO-910950-L,A01B35/26
CA-3089518-A1,A01B39/18
BE-826346-A,A01B33/106
BE-826346-A,A01B33/106
GB-2090713-B,A01B35/12
GB-2090713-B,A01B39/10
GB-2090713-B,A01B35/12
GB-2090713-B,A01B39/10
DE-829523-C,A01B3/32
CN-100366901-C,A01B33/021
KR-20020067218-A,A01B39/18
CN-115362764-A,A01B35/16
CN-115362764-A,A01B35/28
NO-153631-B,A01B35/00
CN-104040083-B,A01B33/14
DE-8707829-U1,A01B33/142
KR-200487998-Y1,A01B39/18
AT-A720679-A,A01B33/106
NL-7909063-A,A01B33/103
US-469659-A,A01B35/08
CN-108575125-A,A01B33/12
CN-108575125-A,A01B33/10
CN-113796181-A,A01B33/08
CN-113796181-A,A01B33/10
CN-106973572-B,A01B39/18
NL-183071-C,A01B33/065
NL-183071-C,A01B33/065
JP-S6342702-Y2,A01B33/028
JP-6910281-B2,A01B33/028
JP-6910281-B2,A01B33/024
US-2545590-A,A01B33/025
US-2545590-A,A01B33/025
CA-997451-A,A01B3/74
AU-2016269849-A1,A01B39/18
AU-2016269849-A1,A01B39/18
DE-102010019819-B4,A01B3/464
BE-872468-A,A01B33/065
BE-872468-A,A01B33/16
BE-872468-A,A01B33/12
US-5845717-A,A01B37/00
US-5845717-A,A01B37/00
PL-440426-A1,A01B33/00
PL-440426-A1,A01B33/021
PL-440426-A1,A01B33/02
PL-440426-A1,A01B33/04
BE-1007083-A5,A01B39/16
BE-1007083-A5,A01B39/26
JP-6998053-B2,A01B39/18
JP-6998053-B2,A01B39/18
US-694931-A,A01B3/08
CN-109392332-A,A01B35/20
CN-109392332-A,A01B35/26
DE-463858-C,A01B35/04
CA-2945250-A1,A01B33/106
CA-2945250-A1,A01B33/106
EP-3586579-A1,A01B33/087
EP-3586579-A1,A01B37/00
US-2024164239-A1,A01B35/08
US-2024164239-A1,A01B35/08
US-2024164239-A1,A01B35/08
FR-2287837-B1,A01B33/024
FR-2287837-B1,A01B33/08
FR-2287837-B1,A01B33/021
FR-2287837-B1,A01B33/08
FR-2287837-B1,A01B33/021
FR-2287837-B1,A01B33/024
CN-107072143-A,A01B35/225
CN-107072143-A,A01B35/225
CN-107072143-A,A01B35/225
CN-107094377-A,A01B33/08
CN-107094377-A,A01B33/144
ZA-808003-B,A01B39/22
ZA-808003-B,A01B35/225
ZA-808003-B,A01B39/22
ZA-808003-B,A01B35/225
GB-2089182-B,A01B33/065
IT-1064821-B,A01B33/065
IT-1064821-B,A01B33/065
CA-2977468-A1,A01B33/024
KR-200194260-Y1,A01B35/10
KR-20020000597-A,A01B35/22
CN-114651538-A,A01B39/22
CN-114651538-A,A01B39/18
CN-114651538-A,A01B39/085
IT-8519066-
Query:
-- Query 10: Get assignee names for patents in CPC code 'A01B3%'
SELECT DISTINCT h.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") f,
     LATERAL FLATTEN(input => t."assignee_harmonized") h
WHERE f.value:"code"::STRING LIKE 'A01B3%'
LIMIT 1000;
Answer:
assignee_name
TRECKER FRANCIS J
KUHN SA
GEORGE A KELLY PLOW COMPANY
GUERBET FRANCOIS
MARTIN DOMINIC R
GLASIER HAROLD H
INT HARVESTER GREAT BRITAIN
BULLS CO LTD
HUBEI SHUANGYU MACHINERY TECH CO LTD
TWOSE OF TIVERTON LTD
WILLIAM HENRY HONY FROST
WALLNER KLAUS
ELEOS ROBOTICS INC
SJOEHOLMS MEKANISKA AB
HUBER FRANZ FERDINAND
UNIV HEILONGJIANG SCI & TECH
SAMSUNG SDI CO LTD
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY
GERBER HUBERT
WANG XUEDONG
NIEMEYER SOEHNE STAHL PFLUG
ARWAC LTD
QUINSTAR CORP
DAEHO FARMING MACHINERY CO LTD
SHEPPARD RICHARD H
RICHARD CO
PREC PLANTING LLC
ZHANG LIJIN
SIGFRID ANDERSON ANDERS
MARTIN CHARLES H
NEW ZEALAND INVENTIONS DEV
LG ELECTRONICS INC
HARRELL DANNY H
CAMPBELL CLARENCE L
CHOATE STOREY NORMAN
ARTHUR BROOKS SPURR
LEINFELDER DIPL-LANDW HERMANN
KORSMEYER ERNEST H
LIM HEON HO
HOLGER LETH
CHONGQING TIANJI IND CO LTD
JIM ALEX SMITH
BOTVID SETTERGREN ANDERS GOSTA
LEMKEN GMBH & CO KG
AUGUST SETTERGREN OTTO GORAN
GERBER MAURICE
FISHER VAN E
KUBOTA KK
SALGE HENRY F
KIM JONG JIN
SAPHIR MASCHB GMBH
Liu Yueshang
CHONGQING YUBAO AGRICULTURE EXPL CO LTD
MCKAY RALPH LTD
WALTER ROWAN JAMES
UNIV CHUNG ANG IND
DEERE & CO
CHO SUNG GU
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC
CHRISTEN ARNE JENSEN
AMAZONEN WERKE DREYER H
UNIV JIANGSU
SOUTHERN PLOW COMPANY
KIM BYUNG SUB
AMAZONEN-WERKE H DREYER GMBH & CO KG
TEXAS INDUSTRIES INC
EDWARDS JOHN W
EDMOND HEE
RUDOLPH HASSON PAUL
CNH IND AMERICA LLC
LEIJENAAR SYTZE
LELY NV C VAN DER
KIM JAE KEUN
DAIYO TANGO CO LTD
SAMSUNG KWANGJU ELECTRONICS CO
WILLIAM DREFKE
PATENT CONCERN NV
UNIV TONGJI
OTULAK PRZEMYSLAW PRO CNC
CHRISTOPHER H R WOODWARD
CARLUCCI JAMES J
EMPR IMPORT EXPORT Y DISTRIB P
ALLEN SAMUEL L
AGSOILWORKS TECH COMPANY LLC
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD
UNIV SYDNEY
BETEK GMBH & CO KG
End Exploring Related Columns
Task: For patent class A01B3, I want to analyze the information of the top 3 assignees based on the total number of applications. Please provide the following five pieces of information: the name of this assignee,  total number of applications, the year with the most applications, the number of applications in that year, and the country code with the most applications during that year.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: SELECT S."Column_Name" FROM {Database Name}.{Schema Name}.{Table_name} (ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
assignee_name,total_applications,year_with_most_applications,applications_in_that_year,top_country_code
Assignee_A,num:int > 0,year:int,applications:int > 0,country_code:str
Assignee_B,num:int > 0,year:int,applications:int > 0,country_code:str
Assignee_C,num:int > 0,year:int,applications:int > 0,country_code:str
```

The table above lists the top three assignees in patent class A01B3 based on the total number of applications. For each assignee, it provides:

- **assignee_name**: The name of the assignee (e.g., Assignee_A).
- **total_applications**: The total number of applications filed by the assignee in class A01B3 (a positive integer).
- **year_with_most_applications**: The specific year when the assignee filed the most applications (a four-digit year).
- **applications_in_that_year**: The number of applications filed by the assignee in that peak year (a positive integer).
- **top_country_code**: The country code where the most applications were filed during that year (a two-letter country code)..
Here are some useful tips for answering:
When calculating distances between two geometries, use `ST_MakePoint(x, y)` to make a point and `ST_Distance(geometry1 GEOMETRY, geometry2 GEOMETRY)` to compute. No need to convert from meters to miles unless requested. Don't use Haversine like 2 * 6371000 * ASIN(...), use ST_DISTANCE for more precise results.
Please refrain from adding any conditions that are not explicitly specified in the task.
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'
Be careful one country may have different names in different columns in a database.
When handling TO_TIMESTAMP_NTZ conversions, use query like: SELECT CASE WHEN "date" >= 1e15 THEN TO_TIMESTAMP_NTZ("date" / 1000000) WHEN "date" >= 1e12 THEN TO_TIMESTAMP_NTZ("date" / 1000) ELSE TO_TIMESTAMP_NTZ("date") END AS parsed_timestamp FROM my_table;
Be careful of information in nested JSON columns. e.g.1. When it comes to active users, it refers to has engagement_time_msec parameter rather than directly counting users. So the right query is: SELECT DISTINCT USER_PSEUDO_ID FROM all_user_activity, LATERAL FLATTEN(input => event_params) AS flattened_params WHERE flattened_params.value:key = 'engagement_time_msec'
e.g. When it comes to top-selling product, you should pay attention to hits2.value:"eCommerceAction":"action_type"::INTEGER = 6 where 6 means sold product.
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When counting for rows of a column, ensure they are distinct: SELECT COUNT(DISTINCT col_name) FROM table;
Keep all decimals to four decimal places.
You need to follow the format's positive and negative signs.

2025-01-16 03:11:31 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 03:11:31 - root - INFO - ```sql
WITH cpc_filtered AS (
    SELECT
        t."publication_number",
        t."filing_date",
        t."country_code",
        t."assignee_harmonized"
    FROM
        PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") f
    WHERE
        f.value:"code"::STRING LIKE 'A01B3%'
),
assignees AS (
    SELECT
        c."publication_number",
        c."filing_date",
        c."country_code",
        h.value:"name"::STRING AS "assignee_name"
    FROM
        cpc_filtered c,
        LATERAL FLATTEN(input => c."assignee_harmonized") h
),
assignee_counts AS (
    SELECT
        "assignee_name",
        COUNT(DISTINCT "publication_number") AS total_applications
    FROM
        assignees
    GROUP BY
        "assignee_name"
),
top_assignees AS (
    SELECT
        "assignee_name",
        total_applications
    FROM
        assignee_counts
    ORDER BY
        total_applications DESC
    LIMIT 3
),
assignee_year_counts AS (
    SELECT
        a."assignee_name",
        TO_NUMBER(SUBSTRING(TO_VARCHAR(a."filing_date"), 1, 4)) AS "filing_year",
        COUNT(DISTINCT a."publication_number") AS applications_in_year
    FROM
        assignees a
    WHERE
        a."assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
        AND a."filing_date" IS NOT NULL
        AND a."filing_date" > 0
        AND TO_NUMBER(SUBSTRING(TO_VARCHAR(a."filing_date"), 1, 4)) BETWEEN 1800 AND 2100
    GROUP BY
        a."assignee_name",
        TO_NUMBER(SUBSTRING(TO_VARCHAR(a."filing_date"), 1, 4))
),
assignee_max_year AS (
    SELECT
        ayc."assignee_name",
        ayc."filing_year",
        ayc.applications_in_year,
        ROW_NUMBER() OVER (PARTITION BY ayc."assignee_name" ORDER BY ayc.applications_in_year DESC, ayc."filing_year" DESC) AS rn
    FROM
        assignee_year_counts ayc
),
assignee_year_country_counts AS (
    SELECT
        a."assignee_name",
        TO_NUMBER(SUBSTRING(TO_VARCHAR(a."filing_date"), 1, 4)) AS "filing_year",
        a."country_code",
        COUNT(DISTINCT a."publication_number") AS applications_in_year_country
    FROM
        assignees a
    WHERE
        a."assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
        AND a."filing_date" IS NOT NULL AND a."filing_date" > 0
        AND TO_NUMBER(SUBSTRING(TO_VARCHAR(a."filing_date"), 1, 4)) BETWEEN 1800 AND 2100
        AND a."country_code" IS NOT NULL AND a."country_code" != ''
    GROUP BY
        a."assignee_name",
        TO_NUMBER(SUBSTRING(TO_VARCHAR(a."filing_date"), 1, 4)),
        a."country_code"
),
assignee_top_country AS (
    SELECT
        aycc."assignee_name",
        aycc."filing_year",
        aycc."country_code" AS top_country_code,
        aycc.applications_in_year_country,
        ROW_NUMBER() OVER (PARTITION BY aycc."assignee_name", aycc."filing_year" ORDER BY aycc.applications_in_year_country DESC) AS rn
    FROM
        assignee_year_country_counts aycc
),
assignee_final AS (
    SELECT
        am."assignee_name",
        am."filing_year",
        am.applications_in_year,
        atc.top_country_code
    FROM
        assignee_max_year am
    JOIN
        assignee_top_country atc ON am."assignee_name" = atc."assignee_name" AND am."filing_year" = atc."filing_year" AND atc.rn = 1
    WHERE
        am.rn = 1
),
final_result AS (
    SELECT
        ta."assignee_name",
        ta.total_applications,
        af."filing_year" AS year_with_most_applications,
        af.applications_in_year,
        af.top_country_code
    FROM
        top_assignees ta
    JOIN
        assignee_final af ON ta."assignee_name" = af."assignee_name"
    ORDER BY
        ta.total_applications DESC
)
SELECT
    assignee_name,
    total_applications,
    year_with_most_applications,
    applications_in_year,
    top_country_code
FROM
    final_result;
```
2025-01-16 03:11:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:11:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:11:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:11:32 - snowflake.connector.connection - INFO - closed
2025-01-16 03:11:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:11:33 - root - INFO - itercount: 1
2025-01-16 03:11:33 - root - INFO - 000904 (42000): 01b9bdbf-0004-7b0e-0001-11c300c9e1ae: SQL compilation error: error line 123 at position 4
invalid identifier 'ASSIGNEE_NAME'
2025-01-16 03:11:33 - root - INFO - Input sql:
WITH cpc_filtered AS (
    SELECT
        t."publication_number",
        t."filing_date",
        t."country_code",
        t."assignee_harmonized"
    FROM
        PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") f
    WHERE
        f.value:"code"::STRING LIKE 'A01B3%'
),
assignees AS (
    SELECT
        c."publication_number",
        c."filing_date",
        c."country_code",
        h.value:"name"::STRING AS "assignee_name"
    FROM
        cpc_filtered c,
        LATERAL FLATTEN(input => c."assignee_harmonized") h
),
assignee_counts AS (
    SELECT
        "assignee_name",
        COUNT(DISTINCT "publication_number") AS total_applications
    FROM
        assignees
    GROUP BY
        "assignee_name"
),
top_assignees AS (
    SELECT
        "assignee_name",
        total_applications
    FROM
        assignee_counts
    ORDER BY
        total_applications DESC
    LIMIT 3
),
assignee_year_counts AS (
    SELECT
        a."assignee_name",
        TO_NUMBER(SUBSTRING(TO_VARCHAR(a."filing_date"), 1, 4)) AS "filing_year",
        COUNT(DISTINCT a."publication_number") AS applications_in_year
    FROM
        assignees a
    WHERE
        a."assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
        AND a."filing_date" IS NOT NULL
        AND a."filing_date" > 0
        AND TO_NUMBER(SUBSTRING(TO_VARCHAR(a."filing_date"), 1, 4)) BETWEEN 1800 AND 2100
    GROUP BY
        a."assignee_name",
        TO_NUMBER(SUBSTRING(TO_VARCHAR(a."filing_date"), 1, 4))
),
assignee_max_year AS (
    SELECT
        ayc."assignee_name",
        ayc."filing_year",
        ayc.applications_in_year,
        ROW_NUMBER() OVER (PARTITION BY ayc."assignee_name" ORDER BY ayc.applications_in_year DESC, ayc."filing_year" DESC) AS rn
    FROM
        assignee_year_counts ayc
),
assignee_year_country_counts AS (
    SELECT
        a."assignee_name",
        TO_NUMBER(SUBSTRING(TO_VARCHAR(a."filing_date"), 1, 4)) AS "filing_year",
        a."country_code",
        COUNT(DISTINCT a."publication_number") AS applications_in_year_country
    FROM
        assignees a
    WHERE
        a."assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
        AND a."filing_date" IS NOT NULL AND a."filing_date" > 0
        AND TO_NUMBER(SUBSTRING(TO_VARCHAR(a."filing_date"), 1, 4)) BETWEEN 1800 AND 2100
        AND a."country_code" IS NOT NULL AND a."country_code" != ''
    GROUP BY
        a."assignee_name",
        TO_NUMBER(SUBSTRING(TO_VARCHAR(a."filing_date"), 1, 4)),
        a."country_code"
),
assignee_top_country AS (
    SELECT
        aycc."assignee_name",
        aycc."filing_year",
        aycc."country_code" AS top_country_code,
        aycc.applications_in_year_country,
        ROW_NUMBER() OVER (PARTITION BY aycc."assignee_name", aycc."filing_year" ORDER BY aycc.applications_in_year_country DESC) AS rn
    FROM
        assignee_year_country_counts aycc
),
assignee_final AS (
    SELECT
        am."assignee_name",
        am."filing_year",
        am.applications_in_year,
        atc.top_country_code
    FROM
        assignee_max_year am
    JOIN
        assignee_top_country atc ON am."assignee_name" = atc."assignee_name" AND am."filing_year" = atc."filing_year" AND atc.rn = 1
    WHERE
        am.rn = 1
),
final_result AS (
    SELECT
        ta."assignee_name",
        ta.total_applications,
        af."filing_year" AS year_with_most_applications,
        af.applications_in_year,
        af.top_country_code
    FROM
        top_assignees ta
    JOIN
        assignee_final af ON ta."assignee_name" = af."assignee_name"
    ORDER BY
        ta.total_applications DESC
)
SELECT
    assignee_name,
    total_applications,
    year_with_most_applications,
    applications_in_year,
    top_country_code
FROM
    final_result;
The error information is:
000904 (42000): 01b9bdbf-0004-7b0e-0001-11c300c9e1ae: SQL compilation error: error line 123 at position 4
invalid identifier 'ASSIGNEE_NAME'
Please correct it and output only 1 complete SQL query.When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'

2025-01-16 03:12:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 03:12:40 - root - INFO - ```sql
WITH cpc_filtered AS (
    SELECT
        t.publication_number,
        t.filing_date,
        t.country_code,
        t.assignee_harmonized
    FROM
        PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t.cpc) f
    WHERE
        f.value:"code"::STRING LIKE 'A01B3%'
),
assignees AS (
    SELECT
        c.publication_number,
        c.filing_date,
        c.country_code,
        h.value:"name"::STRING AS assignee_name
    FROM
        cpc_filtered c,
        LATERAL FLATTEN(input => c.assignee_harmonized) h
),
assignee_counts AS (
    SELECT
        assignee_name,
        COUNT(DISTINCT publication_number) AS total_applications
    FROM
        assignees
    GROUP BY
        assignee_name
),
top_assignees AS (
    SELECT
        assignee_name,
        total_applications
    FROM
        assignee_counts
    ORDER BY
        total_applications DESC NULLS LAST
    LIMIT 3
),
assignee_year_counts AS (
    SELECT
        a.assignee_name,
        TO_NUMBER(SUBSTRING(TO_VARCHAR(a.filing_date), 1, 4)) AS filing_year,
        COUNT(DISTINCT a.publication_number) AS applications_in_year
    FROM
        assignees a
    WHERE
        a.assignee_name IN (SELECT assignee_name FROM top_assignees)
        AND a.filing_date IS NOT NULL
        AND a.filing_date > 0
        AND TO_NUMBER(SUBSTRING(TO_VARCHAR(a.filing_date), 1, 4)) BETWEEN 1800 AND 2100
    GROUP BY
        a.assignee_name,
        TO_NUMBER(SUBSTRING(TO_VARCHAR(a.filing_date), 1, 4))
),
assignee_max_year AS (
    SELECT
        ayc.assignee_name,
        ayc.filing_year,
        ayc.applications_in_year,
        ROW_NUMBER() OVER (PARTITION BY ayc.assignee_name ORDER BY ayc.applications_in_year DESC, ayc.filing_year DESC) AS rn
    FROM
        assignee_year_counts ayc
    WHERE
        ayc.filing_year IS NOT NULL
),
assignee_year_country_counts AS (
    SELECT
        a.assignee_name,
        TO_NUMBER(SUBSTRING(TO_VARCHAR(a.filing_date), 1, 4)) AS filing_year,
        a.country_code,
        COUNT(DISTINCT a.publication_number) AS applications_in_year_country
    FROM
        assignees a
    WHERE
        a.assignee_name IN (SELECT assignee_name FROM top_assignees)
        AND a.filing_date IS NOT NULL AND a.filing_date > 0
        AND TO_NUMBER(SUBSTRING(TO_VARCHAR(a.filing_date), 1, 4)) BETWEEN 1800 AND 2100
        AND a.country_code IS NOT NULL AND a.country_code != ''
    GROUP BY
        a.assignee_name,
        TO_NUMBER(SUBSTRING(TO_VARCHAR(a.filing_date), 1, 4)),
        a.country_code
),
assignee_top_country AS (
    SELECT
        aycc.assignee_name,
        aycc.filing_year,
        aycc.country_code AS top_country_code,
        aycc.applications_in_year_country,
        ROW_NUMBER() OVER (PARTITION BY aycc.assignee_name, aycc.filing_year ORDER BY aycc.applications_in_year_country DESC) AS rn
    FROM
        assignee_year_country_counts aycc
    WHERE
        aycc.filing_year IS NOT NULL
),
assignee_final AS (
    SELECT
        am.assignee_name,
        am.filing_year,
        am.applications_in_year,
        atc.top_country_code
    FROM
        assignee_max_year am
    JOIN
        assignee_top_country atc ON am.assignee_name = atc.assignee_name AND am.filing_year = atc.filing_year AND atc.rn = 1
    WHERE
        am.rn = 1
),
final_result AS (
    SELECT
        ta.assignee_name AS assignee_name,
        ta.total_applications AS total_applications,
        af.filing_year AS year_with_most_applications,
        af.applications_in_year AS applications_in_year,
        af.top_country_code AS top_country_code
    FROM
        top_assignees ta
    JOIN
        assignee_final af ON ta.assignee_name = af.assignee_name
    ORDER BY
        ta.total_applications DESC NULLS LAST
)
SELECT
    assignee_name,
    total_applications,
    year_with_most_applications,
    applications_in_year,
    top_country_code
FROM
    final_result;
```
2025-01-16 03:12:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:12:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:12:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:12:42 - snowflake.connector.connection - INFO - closed
2025-01-16 03:12:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:12:42 - root - INFO - itercount: 2
2025-01-16 03:12:42 - root - INFO - 000904 (42000): 01b9bdc0-0004-7b0e-0001-11c300c9e1da: SQL compilation error: error line 3 at position 8
invalid identifier 'T.PUBLICATION_NUMBER'
2025-01-16 03:12:42 - root - INFO - Input sql:
WITH cpc_filtered AS (
    SELECT
        t.publication_number,
        t.filing_date,
        t.country_code,
        t.assignee_harmonized
    FROM
        PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t.cpc) f
    WHERE
        f.value:"code"::STRING LIKE 'A01B3%'
),
assignees AS (
    SELECT
        c.publication_number,
        c.filing_date,
        c.country_code,
        h.value:"name"::STRING AS assignee_name
    FROM
        cpc_filtered c,
        LATERAL FLATTEN(input => c.assignee_harmonized) h
),
assignee_counts AS (
    SELECT
        assignee_name,
        COUNT(DISTINCT publication_number) AS total_applications
    FROM
        assignees
    GROUP BY
        assignee_name
),
top_assignees AS (
    SELECT
        assignee_name,
        total_applications
    FROM
        assignee_counts
    ORDER BY
        total_applications DESC NULLS LAST
    LIMIT 3
),
assignee_year_counts AS (
    SELECT
        a.assignee_name,
        TO_NUMBER(SUBSTRING(TO_VARCHAR(a.filing_date), 1, 4)) AS filing_year,
        COUNT(DISTINCT a.publication_number) AS applications_in_year
    FROM
        assignees a
    WHERE
        a.assignee_name IN (SELECT assignee_name FROM top_assignees)
        AND a.filing_date IS NOT NULL
        AND a.filing_date > 0
        AND TO_NUMBER(SUBSTRING(TO_VARCHAR(a.filing_date), 1, 4)) BETWEEN 1800 AND 2100
    GROUP BY
        a.assignee_name,
        TO_NUMBER(SUBSTRING(TO_VARCHAR(a.filing_date), 1, 4))
),
assignee_max_year AS (
    SELECT
        ayc.assignee_name,
        ayc.filing_year,
        ayc.applications_in_year,
        ROW_NUMBER() OVER (PARTITION BY ayc.assignee_name ORDER BY ayc.applications_in_year DESC, ayc.filing_year DESC) AS rn
    FROM
        assignee_year_counts ayc
    WHERE
        ayc.filing_year IS NOT NULL
),
assignee_year_country_counts AS (
    SELECT
        a.assignee_name,
        TO_NUMBER(SUBSTRING(TO_VARCHAR(a.filing_date), 1, 4)) AS filing_year,
        a.country_code,
        COUNT(DISTINCT a.publication_number) AS applications_in_year_country
    FROM
        assignees a
    WHERE
        a.assignee_name IN (SELECT assignee_name FROM top_assignees)
        AND a.filing_date IS NOT NULL AND a.filing_date > 0
        AND TO_NUMBER(SUBSTRING(TO_VARCHAR(a.filing_date), 1, 4)) BETWEEN 1800 AND 2100
        AND a.country_code IS NOT NULL AND a.country_code != ''
    GROUP BY
        a.assignee_name,
        TO_NUMBER(SUBSTRING(TO_VARCHAR(a.filing_date), 1, 4)),
        a.country_code
),
assignee_top_country AS (
    SELECT
        aycc.assignee_name,
        aycc.filing_year,
        aycc.country_code AS top_country_code,
        aycc.applications_in_year_country,
        ROW_NUMBER() OVER (PARTITION BY aycc.assignee_name, aycc.filing_year ORDER BY aycc.applications_in_year_country DESC) AS rn
    FROM
        assignee_year_country_counts aycc
    WHERE
        aycc.filing_year IS NOT NULL
),
assignee_final AS (
    SELECT
        am.assignee_name,
        am.filing_year,
        am.applications_in_year,
        atc.top_country_code
    FROM
        assignee_max_year am
    JOIN
        assignee_top_country atc ON am.assignee_name = atc.assignee_name AND am.filing_year = atc.filing_year AND atc.rn = 1
    WHERE
        am.rn = 1
),
final_result AS (
    SELECT
        ta.assignee_name AS assignee_name,
        ta.total_applications AS total_applications,
        af.filing_year AS year_with_most_applications,
        af.applications_in_year AS applications_in_year,
        af.top_country_code AS top_country_code
    FROM
        top_assignees ta
    JOIN
        assignee_final af ON ta.assignee_name = af.assignee_name
    ORDER BY
        ta.total_applications DESC NULLS LAST
)
SELECT
    assignee_name,
    total_applications,
    year_with_most_applications,
    applications_in_year,
    top_country_code
FROM
    final_result;
The error information is:
000904 (42000): 01b9bdc0-0004-7b0e-0001-11c300c9e1da: SQL compilation error: error line 3 at position 8
invalid identifier 'T.PUBLICATION_NUMBER'
Please correct it and output only 1 complete SQL query.When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'

2025-01-16 03:13:35 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 03:13:35 - root - INFO - ```sql
WITH cpc_filtered AS (
    SELECT
        t."publication_number",
        t."filing_date",
        t."country_code",
        t."assignee_harmonized"
    FROM
        "PATENTS"."PATENTS"."PUBLICATIONS" t,
        LATERAL FLATTEN(input => t."cpc") f
    WHERE
        f.value:"code"::STRING LIKE 'A01B3%'
),
assignees AS (
    SELECT
        c."publication_number",
        c."filing_date",
        c."country_code",
        h.value:"name"::STRING AS "assignee_name"
    FROM
        cpc_filtered c,
        LATERAL FLATTEN(input => c."assignee_harmonized") h
),
assignee_counts AS (
    SELECT
        "assignee_name",
        COUNT(DISTINCT "publication_number") AS "total_applications"
    FROM
        assignees
    GROUP BY
        "assignee_name"
),
top_assignees AS (
    SELECT
        "assignee_name",
        "total_applications"
    FROM
        assignee_counts
    ORDER BY
        "total_applications" DESC NULLS LAST
    LIMIT 3
),
assignee_year_counts AS (
    SELECT
        a."assignee_name",
        TO_NUMBER(SUBSTRING(TO_VARCHAR(a."filing_date"), 1, 4)) AS "filing_year",
        COUNT(DISTINCT a."publication_number") AS "applications_in_year"
    FROM
        assignees a
    WHERE
        a."assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
        AND a."filing_date" IS NOT NULL
        AND a."filing_date" > 0
        AND TO_NUMBER(SUBSTRING(TO_VARCHAR(a."filing_date"), 1, 4)) BETWEEN 1800 AND 2100
    GROUP BY
        a."assignee_name",
        TO_NUMBER(SUBSTRING(TO_VARCHAR(a."filing_date"), 1, 4))
),
assignee_max_year AS (
    SELECT
        ayc."assignee_name",
        ayc."filing_year",
        ayc."applications_in_year",
        ROW_NUMBER() OVER (PARTITION BY ayc."assignee_name" ORDER BY ayc."applications_in_year" DESC, ayc."filing_year" DESC) AS rn
    FROM
        assignee_year_counts ayc
    WHERE
        ayc."filing_year" IS NOT NULL
),
assignee_year_country_counts AS (
    SELECT
        a."assignee_name",
        TO_NUMBER(SUBSTRING(TO_VARCHAR(a."filing_date"), 1, 4)) AS "filing_year",
        a."country_code",
        COUNT(DISTINCT a."publication_number") AS "applications_in_year_country"
    FROM
        assignees a
    WHERE
        a."assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
        AND a."filing_date" IS NOT NULL AND a."filing_date" > 0
        AND TO_NUMBER(SUBSTRING(TO_VARCHAR(a."filing_date"), 1, 4)) BETWEEN 1800 AND 2100
        AND a."country_code" IS NOT NULL AND a."country_code" != ''
    GROUP BY
        a."assignee_name",
        TO_NUMBER(SUBSTRING(TO_VARCHAR(a."filing_date"), 1, 4)),
        a."country_code"
),
assignee_top_country AS (
    SELECT
        aycc."assignee_name",
        aycc."filing_year",
        aycc."country_code" AS "top_country_code",
        aycc."applications_in_year_country",
        ROW_NUMBER() OVER (PARTITION BY aycc."assignee_name", aycc."filing_year" ORDER BY aycc."applications_in_year_country" DESC) AS rn
    FROM
        assignee_year_country_counts aycc
    WHERE
        aycc."filing_year" IS NOT NULL
),
assignee_final AS (
    SELECT
        am."assignee_name",
        am."filing_year",
        am."applications_in_year",
        atc."top_country_code"
    FROM
        assignee_max_year am
    JOIN
        assignee_top_country atc ON am."assignee_name" = atc."assignee_name" AND am."filing_year" = atc."filing_year" AND atc.rn = 1
    WHERE
        am.rn = 1
),
final_result AS (
    SELECT
        ta."assignee_name",
        ta."total_applications",
        af."filing_year" AS "year_with_most_applications",
        af."applications_in_year",
        af."top_country_code"
    FROM
        top_assignees ta
    JOIN
        assignee_final af ON ta."assignee_name" = af."assignee_name"
    ORDER BY
        ta."total_applications" DESC NULLS LAST
)
SELECT
    "assignee_name",
    "total_applications",
    "year_with_most_applications",
    "applications_in_year",
    "top_country_code"
FROM
    final_result;
```
2025-01-16 03:13:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:13:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:13:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:13:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-16 03:13:37 - snowflake.connector.connection - INFO - closed
2025-01-16 03:13:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:13:38 - root - INFO - itercount: 3
2025-01-16 03:13:38 - root - INFO - 0
2025-01-16 03:13:38 - root - INFO - results: 
assignee_name,total_applications,year_with_most_applications,applications_in_year,top_country_code
LELY NV C VAN DER,5,1985,1,IT
DEERE & CO,4,2019,1,EP
AMAZONEN WERKE DREYER H,2,1979,2,AT


2025-01-16 03:13:38 - root - INFO - Please check the answer again by reviewing For patent class A01B3, I want to analyze the information of the top 3 assignees based on the total number of applications. Please provide the following five pieces of information: the name of this assignee,  total number of applications, the year with the most applications, the number of applications in that year, and the country code with the most applications during that year., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
assignee_name,total_applications,year_with_most_applications,applications_in_that_year,top_country_code
Assignee_A,num:int > 0,year:int,applications:int > 0,country_code:str
Assignee_B,num:int > 0,year:int,applications:int > 0,country_code:str
Assignee_C,num:int > 0,year:int,applications:int > 0,country_code:str
```

The table above lists the top three assignees in patent class A01B3 based on the total number of applications. For each assignee, it provides:

- **assignee_name**: The name of the assignee (e.g., Assignee_A).
- **total_applications**: The total number of applications filed by the assignee in class A01B3 (a positive integer).
- **year_with_most_applications**: The specific year when the assignee filed the most applications (a four-digit year).
- **applications_in_that_year**: The number of applications filed by the assignee in that peak year (a positive integer).
- **top_country_code**: The country code where the most applications were filed during that year (a two-letter country code). The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
assignee_name,total_applications,year_with_most_applications,applications_in_year,top_country_code
LELY NV C VAN DER,5,1985,1,IT
DEERE & CO,4,2019,1,EP
AMAZONEN WERKE DREYER H,2,1979,2,AT
Current sql:
WITH cpc_filtered AS (
    SELECT
        t."publication_number",
        t."filing_date",
        t."country_code",
        t."assignee_harmonized"
    FROM
        "PATENTS"."PATENTS"."PUBLICATIONS" t,
        LATERAL FLATTEN(input => t."cpc") f
    WHERE
        f.value:"code"::STRING LIKE 'A01B3%'
),
assignees AS (
    SELECT
        c."publication_number",
        c."filing_date",
        c."country_code",
        h.value:"name"::STRING AS "assignee_name"
    FROM
        cpc_filtered c,
        LATERAL FLATTEN(input => c."assignee_harmonized") h
),
assignee_counts AS (
    SELECT
        "assignee_name",
        COUNT(DISTINCT "publication_number") AS "total_applications"
    FROM
        assignees
    GROUP BY
        "assignee_name"
),
top_assignees AS (
    SELECT
        "assignee_name",
        "total_applications"
    FROM
        assignee_counts
    ORDER BY
        "total_applications" DESC NULLS LAST
    LIMIT 3
),
assignee_year_counts AS (
    SELECT
        a."assignee_name",
        TO_NUMBER(SUBSTRING(TO_VARCHAR(a."filing_date"), 1, 4)) AS "filing_year",
        COUNT(DISTINCT a."publication_number") AS "applications_in_year"
    FROM
        assignees a
    WHERE
        a."assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
        AND a."filing_date" IS NOT NULL
        AND a."filing_date" > 0
        AND TO_NUMBER(SUBSTRING(TO_VARCHAR(a."filing_date"), 1, 4)) BETWEEN 1800 AND 2100
    GROUP BY
        a."assignee_name",
        TO_NUMBER(SUBSTRING(TO_VARCHAR(a."filing_date"), 1, 4))
),
assignee_max_year AS (
    SELECT
        ayc."assignee_name",
        ayc."filing_year",
        ayc."applications_in_year",
        ROW_NUMBER() OVER (PARTITION BY ayc."assignee_name" ORDER BY ayc."applications_in_year" DESC, ayc."filing_year" DESC) AS rn
    FROM
        assignee_year_counts ayc
    WHERE
        ayc."filing_year" IS NOT NULL
),
assignee_year_country_counts AS (
    SELECT
        a."assignee_name",
        TO_NUMBER(SUBSTRING(TO_VARCHAR(a."filing_date"), 1, 4)) AS "filing_year",
        a."country_code",
        COUNT(DISTINCT a."publication_number") AS "applications_in_year_country"
    FROM
        assignees a
    WHERE
        a."assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
        AND a."filing_date" IS NOT NULL AND a."filing_date" > 0
        AND TO_NUMBER(SUBSTRING(TO_VARCHAR(a."filing_date"), 1, 4)) BETWEEN 1800 AND 2100
        AND a."country_code" IS NOT NULL AND a."country_code" != ''
    GROUP BY
        a."assignee_name",
        TO_NUMBER(SUBSTRING(TO_VARCHAR(a."filing_date"), 1, 4)),
        a."country_code"
),
assignee_top_country AS (
    SELECT
        aycc."assignee_name",
        aycc."filing_year",
        aycc."country_code" AS "top_country_code",
        aycc."applications_in_year_country",
        ROW_NUMBER() OVER (PARTITION BY aycc."assignee_name", aycc."filing_year" ORDER BY aycc."applications_in_year_country" DESC) AS rn
    FROM
        assignee_year_country_counts aycc
    WHERE
        aycc."filing_year" IS NOT NULL
),
assignee_final AS (
    SELECT
        am."assignee_name",
        am."filing_year",
        am."applications_in_year",
        atc."top_country_code"
    FROM
        assignee_max_year am
    JOIN
        assignee_top_country atc ON am."assignee_name" = atc."assignee_name" AND am."filing_year" = atc."filing_year" AND atc.rn = 1
    WHERE
        am.rn = 1
),
final_result AS (
    SELECT
        ta."assignee_name",
        ta."total_applications",
        af."filing_year" AS "year_with_most_applications",
        af."applications_in_year",
        af."top_country_code"
    FROM
        top_assignees ta
    JOIN
        assignee_final af ON ta."assignee_name" = af."assignee_name"
    ORDER BY
        ta."total_applications" DESC NULLS LAST
)
SELECT
    "assignee_name",
    "total_applications",
    "year_with_most_applications",
    "applications_in_year",
    "top_country_code"
FROM
    final_result;When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'

2025-01-16 03:14:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 03:14:38 - root - INFO - ```sql
WITH cpc_filtered AS (
    SELECT
        t."publication_number",
        t."filing_date",
        t."country_code",
        t."assignee_harmonized"
    FROM
        "PATENTS"."PATENTS"."PUBLICATIONS" t,
        LATERAL FLATTEN(input => t."cpc") f
    WHERE
        f.value:"code"::STRING LIKE 'A01B3%'
),
assignees AS (
    SELECT
        c."publication_number",
        c."filing_date",
        c."country_code",
        h.value:"name"::STRING AS "assignee_name"
    FROM
        cpc_filtered c,
        LATERAL FLATTEN(input => c."assignee_harmonized") h
),
top_assignees AS (
    SELECT
        "assignee_name",
        COUNT(DISTINCT "publication_number") AS "total_applications"
    FROM
        assignees
    GROUP BY
        "assignee_name"
    ORDER BY
        "total_applications" DESC NULLS LAST
    LIMIT 3
),
assignee_year_counts AS (
    SELECT
        a."assignee_name",
        EXTRACT(year FROM CASE
            WHEN a."filing_date" >= 1e15 THEN TO_TIMESTAMP_NTZ(a."filing_date" / 1000000)
            WHEN a."filing_date" >= 1e12 THEN TO_TIMESTAMP_NTZ(a."filing_date" / 1000)
            ELSE TO_TIMESTAMP_NTZ(a."filing_date")
        END) AS "filing_year",
        COUNT(DISTINCT a."publication_number") AS "applications_in_that_year"
    FROM
        assignees a
    WHERE
        a."assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
        AND a."filing_date" IS NOT NULL
        AND a."filing_date" > 0
    GROUP BY
        a."assignee_name",
        EXTRACT(year FROM CASE
            WHEN a."filing_date" >= 1e15 THEN TO_TIMESTAMP_NTZ(a."filing_date" / 1000000)
            WHEN a."filing_date" >= 1e12 THEN TO_TIMESTAMP_NTZ(a."filing_date" / 1000)
            ELSE TO_TIMESTAMP_NTZ(a."filing_date")
        END)
),
assignee_max_year AS (
    SELECT
        ayc."assignee_name",
        ayc."filing_year",
        ayc."applications_in_that_year",
        ROW_NUMBER() OVER (PARTITION BY ayc."assignee_name" ORDER BY ayc."applications_in_that_year" DESC, ayc."filing_year" DESC) AS rn
    FROM
        assignee_year_counts ayc
),
assignee_year_country_counts AS (
    SELECT
        a."assignee_name",
        EXTRACT(year FROM CASE
            WHEN a."filing_date" >= 1e15 THEN TO_TIMESTAMP_NTZ(a."filing_date" / 1000000)
            WHEN a."filing_date" >= 1e12 THEN TO_TIMESTAMP_NTZ(a."filing_date" / 1000)
            ELSE TO_TIMESTAMP_NTZ(a."filing_date")
        END) AS "filing_year",
        a."country_code",
        COUNT(DISTINCT a."publication_number") AS "applications_in_year_country"
    FROM
        assignees a
    WHERE
        a."assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
        AND a."filing_date" IS NOT NULL
        AND a."filing_date" > 0
        AND a."country_code" IS NOT NULL
        AND a."country_code" != ''
    GROUP BY
        a."assignee_name",
        EXTRACT(year FROM CASE
            WHEN a."filing_date" >= 1e15 THEN TO_TIMESTAMP_NTZ(a."filing_date" / 1000000)
            WHEN a."filing_date" >= 1e12 THEN TO_TIMESTAMP_NTZ(a."filing_date" / 1000)
            ELSE TO_TIMESTAMP_NTZ(a."filing_date")
        END),
        a."country_code"
),
assignee_top_country AS (
    SELECT
        aycc."assignee_name",
        aycc."filing_year",
        aycc."country_code" AS "top_country_code",
        aycc."applications_in_year_country",
        ROW_NUMBER() OVER (PARTITION BY aycc."assignee_name", aycc."filing_year" ORDER BY aycc."applications_in_year_country" DESC) AS rn
    FROM
        assignee_year_country_counts aycc
),
assignee_final AS (
    SELECT
        am."assignee_name",
        am."filing_year",
        am."applications_in_that_year",
        atc."top_country_code"
    FROM
        assignee_max_year am
    JOIN
        assignee_top_country atc ON am."assignee_name" = atc."assignee_name" AND am."filing_year" = atc."filing_year" AND atc.rn = 1
    WHERE
        am.rn = 1
),
final_result AS (
    SELECT
        ta."assignee_name",
        ta."total_applications",
        af."filing_year" AS "year_with_most_applications",
        af."applications_in_that_year",
        af."top_country_code"
    FROM
        top_assignees ta
    JOIN
        assignee_final af ON ta."assignee_name" = af."assignee_name"
    ORDER BY
        ta."total_applications" DESC NULLS LAST
)
SELECT
    "assignee_name",
    "total_applications",
    "year_with_most_applications",
    "applications_in_that_year",
    "top_country_code"
FROM
    final_result;
```
2025-01-16 03:14:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:14:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:14:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:14:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-16 03:14:40 - snowflake.connector.connection - INFO - closed
2025-01-16 03:14:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:14:40 - root - INFO - itercount: 4
2025-01-16 03:14:40 - root - INFO - 0
2025-01-16 03:14:40 - root - INFO - results: 
assignee_name,total_applications,year_with_most_applications,applications_in_that_year,top_country_code
LELY NV C VAN DER,5,1970,5,IT
DEERE & CO,4,1970,4,NL
AMAZONEN WERKE DREYER H,2,1970,2,AT


2025-01-16 03:14:40 - root - INFO - Please check the answer again by reviewing For patent class A01B3, I want to analyze the information of the top 3 assignees based on the total number of applications. Please provide the following five pieces of information: the name of this assignee,  total number of applications, the year with the most applications, the number of applications in that year, and the country code with the most applications during that year., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
assignee_name,total_applications,year_with_most_applications,applications_in_that_year,top_country_code
Assignee_A,num:int > 0,year:int,applications:int > 0,country_code:str
Assignee_B,num:int > 0,year:int,applications:int > 0,country_code:str
Assignee_C,num:int > 0,year:int,applications:int > 0,country_code:str
```

The table above lists the top three assignees in patent class A01B3 based on the total number of applications. For each assignee, it provides:

- **assignee_name**: The name of the assignee (e.g., Assignee_A).
- **total_applications**: The total number of applications filed by the assignee in class A01B3 (a positive integer).
- **year_with_most_applications**: The specific year when the assignee filed the most applications (a four-digit year).
- **applications_in_that_year**: The number of applications filed by the assignee in that peak year (a positive integer).
- **top_country_code**: The country code where the most applications were filed during that year (a two-letter country code). The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
assignee_name,total_applications,year_with_most_applications,applications_in_that_year,top_country_code
LELY NV C VAN DER,5,1970,5,IT
DEERE & CO,4,1970,4,NL
AMAZONEN WERKE DREYER H,2,1970,2,AT
Current sql:
WITH cpc_filtered AS (
    SELECT
        t."publication_number",
        t."filing_date",
        t."country_code",
        t."assignee_harmonized"
    FROM
        "PATENTS"."PATENTS"."PUBLICATIONS" t,
        LATERAL FLATTEN(input => t."cpc") f
    WHERE
        f.value:"code"::STRING LIKE 'A01B3%'
),
assignees AS (
    SELECT
        c."publication_number",
        c."filing_date",
        c."country_code",
        h.value:"name"::STRING AS "assignee_name"
    FROM
        cpc_filtered c,
        LATERAL FLATTEN(input => c."assignee_harmonized") h
),
top_assignees AS (
    SELECT
        "assignee_name",
        COUNT(DISTINCT "publication_number") AS "total_applications"
    FROM
        assignees
    GROUP BY
        "assignee_name"
    ORDER BY
        "total_applications" DESC NULLS LAST
    LIMIT 3
),
assignee_year_counts AS (
    SELECT
        a."assignee_name",
        EXTRACT(year FROM CASE
            WHEN a."filing_date" >= 1e15 THEN TO_TIMESTAMP_NTZ(a."filing_date" / 1000000)
            WHEN a."filing_date" >= 1e12 THEN TO_TIMESTAMP_NTZ(a."filing_date" / 1000)
            ELSE TO_TIMESTAMP_NTZ(a."filing_date")
        END) AS "filing_year",
        COUNT(DISTINCT a."publication_number") AS "applications_in_that_year"
    FROM
        assignees a
    WHERE
        a."assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
        AND a."filing_date" IS NOT NULL
        AND a."filing_date" > 0
    GROUP BY
        a."assignee_name",
        EXTRACT(year FROM CASE
            WHEN a."filing_date" >= 1e15 THEN TO_TIMESTAMP_NTZ(a."filing_date" / 1000000)
            WHEN a."filing_date" >= 1e12 THEN TO_TIMESTAMP_NTZ(a."filing_date" / 1000)
            ELSE TO_TIMESTAMP_NTZ(a."filing_date")
        END)
),
assignee_max_year AS (
    SELECT
        ayc."assignee_name",
        ayc."filing_year",
        ayc."applications_in_that_year",
        ROW_NUMBER() OVER (PARTITION BY ayc."assignee_name" ORDER BY ayc."applications_in_that_year" DESC, ayc."filing_year" DESC) AS rn
    FROM
        assignee_year_counts ayc
),
assignee_year_country_counts AS (
    SELECT
        a."assignee_name",
        EXTRACT(year FROM CASE
            WHEN a."filing_date" >= 1e15 THEN TO_TIMESTAMP_NTZ(a."filing_date" / 1000000)
            WHEN a."filing_date" >= 1e12 THEN TO_TIMESTAMP_NTZ(a."filing_date" / 1000)
            ELSE TO_TIMESTAMP_NTZ(a."filing_date")
        END) AS "filing_year",
        a."country_code",
        COUNT(DISTINCT a."publication_number") AS "applications_in_year_country"
    FROM
        assignees a
    WHERE
        a."assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
        AND a."filing_date" IS NOT NULL
        AND a."filing_date" > 0
        AND a."country_code" IS NOT NULL
        AND a."country_code" != ''
    GROUP BY
        a."assignee_name",
        EXTRACT(year FROM CASE
            WHEN a."filing_date" >= 1e15 THEN TO_TIMESTAMP_NTZ(a."filing_date" / 1000000)
            WHEN a."filing_date" >= 1e12 THEN TO_TIMESTAMP_NTZ(a."filing_date" / 1000)
            ELSE TO_TIMESTAMP_NTZ(a."filing_date")
        END),
        a."country_code"
),
assignee_top_country AS (
    SELECT
        aycc."assignee_name",
        aycc."filing_year",
        aycc."country_code" AS "top_country_code",
        aycc."applications_in_year_country",
        ROW_NUMBER() OVER (PARTITION BY aycc."assignee_name", aycc."filing_year" ORDER BY aycc."applications_in_year_country" DESC) AS rn
    FROM
        assignee_year_country_counts aycc
),
assignee_final AS (
    SELECT
        am."assignee_name",
        am."filing_year",
        am."applications_in_that_year",
        atc."top_country_code"
    FROM
        assignee_max_year am
    JOIN
        assignee_top_country atc ON am."assignee_name" = atc."assignee_name" AND am."filing_year" = atc."filing_year" AND atc.rn = 1
    WHERE
        am.rn = 1
),
final_result AS (
    SELECT
        ta."assignee_name",
        ta."total_applications",
        af."filing_year" AS "year_with_most_applications",
        af."applications_in_that_year",
        af."top_country_code"
    FROM
        top_assignees ta
    JOIN
        assignee_final af ON ta."assignee_name" = af."assignee_name"
    ORDER BY
        ta."total_applications" DESC NULLS LAST
)
SELECT
    "assignee_name",
    "total_applications",
    "year_with_most_applications",
    "applications_in_that_year",
    "top_country_code"
FROM
    final_result;When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'

2025-01-16 03:15:36 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 03:15:36 - root - INFO - ```sql
WITH cpc_filtered AS (
    SELECT
        t."publication_number",
        t."filing_date",
        t."country_code",
        t."assignee_harmonized"
    FROM
        "PATENTS"."PATENTS"."PUBLICATIONS" t,
        LATERAL FLATTEN(input => t."cpc") f
    WHERE
        LEFT(f.value:"code"::STRING, 5) = 'A01B3'
),
assignees AS (
    SELECT
        c."publication_number",
        c."filing_date",
        c."country_code",
        h.value:"name"::STRING AS "assignee_name"
    FROM
        cpc_filtered c,
        LATERAL FLATTEN(input => c."assignee_harmonized") h
),
top_assignees AS (
    SELECT
        "assignee_name",
        COUNT(DISTINCT "publication_number") AS "total_applications"
    FROM
        assignees
    GROUP BY
        "assignee_name"
    ORDER BY
        "total_applications" DESC NULLS LAST
    LIMIT 3
),
assignee_year_counts AS (
    SELECT
        a."assignee_name",
        EXTRACT(year FROM CASE
            WHEN a."filing_date" >= 1e15 THEN TO_TIMESTAMP_NTZ(a."filing_date" / 1000000)
            WHEN a."filing_date" >= 1e12 THEN TO_TIMESTAMP_NTZ(a."filing_date" / 1000)
            ELSE TO_TIMESTAMP_NTZ(a."filing_date")
        END) AS "filing_year",
        COUNT(DISTINCT a."publication_number") AS "applications_in_that_year"
    FROM
        assignees a
    WHERE
        a."assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
        AND a."filing_date" IS NOT NULL
        AND a."filing_date" > 0
    GROUP BY
        a."assignee_name",
        EXTRACT(year FROM CASE
            WHEN a."filing_date" >= 1e15 THEN TO_TIMESTAMP_NTZ(a."filing_date" / 1000000)
            WHEN a."filing_date" >= 1e12 THEN TO_TIMESTAMP_NTZ(a."filing_date" / 1000)
            ELSE TO_TIMESTAMP_NTZ(a."filing_date")
        END)
),
assignee_max_year AS (
    SELECT
        ayc."assignee_name",
        ayc."filing_year",
        ayc."applications_in_that_year",
        ROW_NUMBER() OVER (PARTITION BY ayc."assignee_name" ORDER BY ayc."applications_in_that_year" DESC, ayc."filing_year" DESC NULLS LAST) AS rn
    FROM
        assignee_year_counts ayc
),
assignee_year_country_counts AS (
    SELECT
        a."assignee_name",
        EXTRACT(year FROM CASE
            WHEN a."filing_date" >= 1e15 THEN TO_TIMESTAMP_NTZ(a."filing_date" / 1000000)
            WHEN a."filing_date" >= 1e12 THEN TO_TIMESTAMP_NTZ(a."filing_date" / 1000)
            ELSE TO_TIMESTAMP_NTZ(a."filing_date")
        END) AS "filing_year",
        a."country_code",
        COUNT(DISTINCT a."publication_number") AS "applications_in_year_country"
    FROM
        assignees a
    WHERE
        a."assignee_name" IN (SELECT "assignee_name" FROM top_assignees)
        AND a."filing_date" IS NOT NULL
        AND a."filing_date" > 0
        AND a."country_code" IS NOT NULL
        AND a."country_code" != ''
    GROUP BY
        a."assignee_name",
        EXTRACT(year FROM CASE
            WHEN a."filing_date" >= 1e15 THEN TO_TIMESTAMP_NTZ(a."filing_date" / 1000000)
            WHEN a."filing_date" >= 1e12 THEN TO_TIMESTAMP_NTZ(a."filing_date" / 1000)
            ELSE TO_TIMESTAMP_NTZ(a."filing_date")
        END),
        a."country_code"
),
assignee_top_country AS (
    SELECT
        aycc."assignee_name",
        aycc."filing_year",
        aycc."country_code" AS "top_country_code",
        aycc."applications_in_year_country",
        ROW_NUMBER() OVER (PARTITION BY aycc."assignee_name", aycc."filing_year" ORDER BY aycc."applications_in_year_country" DESC NULLS LAST) AS rn
    FROM
        assignee_year_country_counts aycc
),
assignee_final AS (
    SELECT
        am."assignee_name",
        am."filing_year",
        am."applications_in_that_year",
        atc."top_country_code"
    FROM
        assignee_max_year am
    JOIN
        assignee_top_country atc ON am."assignee_name" = atc."assignee_name" AND am."filing_year" = atc."filing_year" AND atc.rn = 1
    WHERE
        am.rn = 1
),
final_result AS (
    SELECT
        ta."assignee_name",
        ta."total_applications",
        af."filing_year" AS "year_with_most_applications",
        af."applications_in_that_year",
        af."top_country_code"
    FROM
        top_assignees ta
    JOIN
        assignee_final af ON ta."assignee_name" = af."assignee_name"
    ORDER BY
        ta."total_applications" DESC NULLS LAST
)
SELECT
    "assignee_name",
    "total_applications",
    "year_with_most_applications",
    "applications_in_that_year",
    "top_country_code"
FROM
    final_result;
```
2025-01-16 03:15:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 03:15:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 03:15:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 03:15:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-16 03:15:39 - snowflake.connector.connection - INFO - closed
2025-01-16 03:15:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 03:15:39 - root - INFO - itercount: 5
2025-01-16 03:15:39 - root - INFO - 0
2025-01-16 03:15:39 - root - INFO - Total iteration counts: 5
