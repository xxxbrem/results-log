2025-01-16 07:11:15 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 07:12:06 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 07:12:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 07:12:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 07:12:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 07:12:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 07:12:07 - snowflake.connector.connection - INFO - closed
2025-01-16 07:12:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 07:12:08 - root - INFO - SQL:
SELECT DISTINCT c.value::VARIANT:"code"::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c
   LIMIT 1000;
Results:
Too long, hard cut:
cpc_code
F21Y2115/10
H01L2224/05686
G05D2201/0213
Y02B20/40
H01L2224/05624
H01M50/42
A63J5/02
B60L2200/12
G01R19/155
H04W16/14
G02B6/3826
H01L51/0097
H01B7/0009
B01D2255/50
C04B2235/3275
C01P2004/64
B01J20/261
G06F3/0484
F05D2260/213
G06Q30/0185
H02J3/01
A61N1/37288
H01S3/1643
G06F11/3457
B01L3/502761
F05D2220/32
G06Q20/0855
H01S3/17
Y10T29/49826
G06F17/17
A45C13/1046
A61B6/504
B41M5/0047
G10L2021/0135
F16H2045/0284
G06T5/002
G06F9/505
Y02W10/10
F28F9/026
H04M1/0264
C07D471/04
G06F11/1451
E04B1/2403
G09G2230/00
H04W72/23
G06F16/9024
B25F5/02
G06Q20/3278
H04M2250/52
A41D1/22
A61J1/18
G06F9/30003
G06F17/3002
H04B17/15
B29C64/255
B25J9/126
A63F13/424
F16C1/16
H01L23/34
G06Q30/02
G06F2201/885
B64D13/08
F16N21/02
C08L1/08
H04N19/127
G06F16/3329
B60K17/02
H01L27/3246
G01S17/325
G02B21/04
C08G2261/3221
C25D7/123
H02H9/02
G09F2013/05
A61K2800/30
H04L63/145
G09G5/02
H02J3/38
A23C11/103
B29C33/12
A61K31/202
G11C16/349
B60K2360/122
B60K2360/741
C12N15/62
G06V20/597
A61M1/16
D04H13/006
C07C319/14
G01F1/68
C07D213/38
E02D5/56
Y02P20/10
Y10S424/10
B01D67/00
A21D2/364
H01R13/2421
C10B57/04
A61B5/7275
C22C38/002
A47J36/321
F16L11/12
Y02B30/00
B60T11/236
H01H50/54
G06K7/10009
F16B13/063
H01Q1/244
F21V17/002
A61L2202/25
H04L47/803
A01B79/005
G06T7/50
B01J35/615
C04B2235/3203
F05D2240/121
C12Q2600/154
H01M8/04388
A61B6/5205
G06F16/26
H04L9/0863
G06V10/7715
G01N2223/424
F03D1/0683
H04L2209/046
H04L65/70
C12N2310/3341
Y10T156/1326
F16H21/44
D01F11/14
A01C17/00
A01N43/90
C11D3/18
G01S7/2922
B29L2009/001
C12Q2533/101
B26F1/16
F25D17/045
C02F1/40
B61L3/125
Y10T74/1832
B42B5/08
B32B17/10981
B01J2531/847
B01J27/0576
C10M2219/046
C02F1/30
C09B67/0033
H05K3/185
G06Q20/38215
B32B2262/14
H02P29/40
G07C9/28
A61K8/39
B60K7/0015
F04B9/117
D01G15/64
A61K31/737
Y10T428/2958
Y10T24/3991
C07D277/66
H04L2001/0098
C10G27/04
A61H2230/42
A61F13/53717
B01D17/0217
A61F2007/0098
C09K21/12
A61M1/36224
C10B45/00
F21V29/87
A01K2227/101
F23K5/08
C12Y108/01009
E04H15/50
A01K67/027
D21C5/005
C02F2305/023
A61B2017/22035
A47L9/2889
F04D29/325
F16B43/00
F25J1/004
C30B23/02
F25J3/0223
C23C16/45561
A61K9/2873
G04C11/00
B22D15/02
C07D311/16
B29C33/36
Y10S428/92
C09D5/18
H04L1/0066
A01K80/00
C04B41/5022
C10M2215/06
D06M13/123
G10L21/038
H01G4/30
B29K2995/0067
E01H2001/0881
Y02B30/70
B05C11/025
Y10T403/32877
C04B41/81
A61L15/26
H01S3/0675
B01J2229/18
A61K2039/5256
E05B13/002
C07K16/2827
A01M29/32
G06F12/1054
D04H1/66
Y10T407/235
B23K2103/04
A61K8/415
G01P15/123
E04H9/10
B21B45/0251
C10M2209/1085
A47J31/4403
G10H3/146
C08L2207/02
B01J19/088
F01N13/08
A61B5/6851
B29C2045/2813
H10B12/395
C07F9/572
G06K7/0008
B26F1/38
C12Y302/01021
F04D29/668
A61J3/07
A61B2017/00274
G06F1/3287
G01R35/005
F05D2270/09
H01S2301/18
F41H11/16
H04N23/663
G05B2219/50218
B01J8/00
A61B2017/320741
H01L24/96
B65D77/06
B41C2210/22
H02P6/15
A61B5/157
B01L2300/044
A47F3/0482
A61B6/481
G06T7/543
A61B5/4818
A61K31/05
G01N33/526
G06F3/1267
E05F15/70
B01J2231/4283
C04B24/2647
H01L2924/1423
A61K31/714
H01J47/02
G07F17/32
C12N9/88
G06Q20/3255
A63F13/55
H01L21/0274
G02B6/4249
C12Q1/686
H04N1/00716
E04H12/24
H04N1/00732
A61B2017/00336
C08G18/1825
B62D3/08
A61M2202/0208
B62D25/182
C07D307/84
C08G77/445
G03F7/70816
A45C11/04
Y10S707/99953
G06F11/2079
B01D46/2484
H01M4/043
G02B13/06
A61C2203/00
G09F21/0485
G01N2333/285
H01H85/32
F17C2203/0619
G09F21/04
E02D31/06
B29C2791/001
A63B53/007
H04N7/181
A61B17/72
A61N1/36053
G10K2210/1081
B05C11/06
A61F2240/001
A61N1/36014
A61B5/1128
H04N21/25
G06F16/212
C01D15/00
D04H1/5414
B60L50/61
A61C15/04
F16H48/24
H01L27/2463
A47F5/135
H02J7/1423
B01D15/22
H04N21/43079
H01L21/68771
G06V10/945
A61B5/6807
A61B17/8897
H01L29/0642
H04L1/004
A63B21/0442
A61M15/0021
A21B3/13
A61B8/4494
A61B8/445
C10N2210/02
F01D5/26
A01K5/0233
F02C5/00
C09J105/06
A63B2220/52
G05D1/0257
D04H1/645
G01N2035/00425
G05B2219/36077
C07F9/11
C09K3/149
B60R21/16
H01S3/10
G10L21/02
H01L23/5387
F21V33/0068
A01K5/0291
G11B7/263
A23L21/25
A44C5/105
G01N27/623
D06F2105/48
F25B15/00
F04D1/06
B29D11/00317
A01N63/28
C01B17/901
B41P2700/10
B65D2571/0066
G01K17/14
C10G47/00
H02J13/00
Y10T137/87016
F02M2700/4311
A61P9/14
B01D11/0276
H01L21/2255
C08F8/46
E04C2003/0452
A43B3/02
B60T13/58
B21J7/46
A47B2210/0059
H05K2201/0355
G11B7/00736
B66C13/48
F24C7/08
H04N21/6582
H01L21/28587
B60G11/15
C09K19/10
G01F23/36
B65H2301/512125
H04N21/4349
H04L12/413
A63B37/0092
F16L1/19
G02B7/181
H04B7/10
C07C67/39
H04W12/71
A61B5/6889
B01D2253/202
F16L1/203
G01S5/0036
H04N21/4408
C08F291/00
G06F16/3344
H04W88/184
B01J20/14
C12M21/16
C07K5/06026
C23C28/3215
H04L1/1874
C09D175/06
B29D99/005
F03D7/047
B62D13/06
H04L2209/12
G01N21/958
C07K16/468
C04B37/026
B65H45/18
E03B3/04
H10B41/49
C08J2300/14
B01L2200/142
A61L27/48
A61N1/3925
B01J2208/00221
A01K15/026
H04N9/643
C01B3/382
A61K2035/124
A61F13/0253
B41J2202/11
F02M35/024
C08J2201/026
B60H1/004
B60H1/00899
H04M2203/553
G03G15/0822
A61K31/606
H01S5/18305
H01L2224/0231
F25J1/0057
F16L2201/40
B01J31/1616
B60N2/24
F16L55/124
G01B11/25
H02H7/0844
A43C19/00
H10B12/02
G08G1/096725
H01R4/00
F03C1/0671

2025-01-16 07:12:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 07:12:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 07:12:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 07:12:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 07:12:09 - snowflake.connector.connection - INFO - closed
2025-01-16 07:12:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 07:12:10 - root - INFO - SQL:
SELECT DISTINCT a.value::VARIANT:"name"::STRING AS "assignee_name"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a
   LIMIT 1000;
Results:
Too long, hard cut:
assignee_name
PREC BIOSCIENCES INC
STANLEY WORKS LTD
CAMURUS AB
WWT SPOLKA Z OGRANICZONA ODPOWIEDZIALNOSCIA
EISEN EIKO
WISTRON NEWEB CORP
UST INC
UNIV ANGERS
CHUNG CHI Y
ZHU MIN
SUMNER MICHAEL
BERNARD MARC R
HRA PHARMA LAB
GANZHOU HEMAY PHARMACEUTICAL CO
SURROZEN OPERATING INC
KIMBERLY CLARK CO
VIGIL NEUROSCIENCE INC
ROCKWOOL INT
AERTEL MANFRED
KOEHLER UTA
DANFOSS AS
GORE W L & ASS CO LTD
KIM DEOK JUNG
ITELCO S P A
BONGIOLO PAOLO
FARNWORTH WARREN M
CHIANG CHING-LIANG
LEE GUEE-SANG
BREMER CHRIS
SHIM YEON-AH
SUMITOMO METAL MINING CO
TAIWAN SEMICONDUCTOR MFG
HEWLETT PACKARD DEVELOPMENT CO LP
FWP IP APS
XU YINGQI
PANASONIC ECO SYS GUANGDONG CO
ZHANG HUANHUAN
INFOSEIZE SYSTEMS CO LTD
NIKE INC
INAGAKI NOBUAKI
TAMURA SHUICHI
ELITE FUELS LLC
SERVIER LAB
SMART HUB PTE LTD
TRIANGLE TYRE CO LTD
HOBOT TECH INC
VASSEUR JEAN-PHILIPPE
OILUND LESTER D
FINE HOWARD A
TUTTLE G TYSON
KOESTER DAVID A
CHRISTL WERNER
OPOLSKI STEVEN W
JIANG MING
UNIV MASSACHUSETTS
ADVANCED BIONICS LLC
KOFLER KEVIN J
HOOVER LTD
MASSI OSVALDO MAXIMILIANO
ACE BEDS CO LTD
FEDELI GIANCARLO
XIAOYING ZHAO
RONGHUA SUN
ETA SRL
MAGNETI MARELLI SPA
ODED MIRETZKY
LORENZ BIOTECH SPA
GE HEALTHCARE AS
BIONOVO INC
FOMUKONG MUNDI
COVIDIEN AG
MO AVTOMOBILNYJ ZAVOD IM I A L
LE MASH
HAMMONDS CARL L
GTX INC
OMNISYSTEM CO LTD
AGCO DO BRASIL SOLUCOES AGRICOLAS LTDA
KOREA INST OCEAN SCI & TECH
MATHUR BHAVNA
VARTIAINEN PANU
KAN GEORGE L
SUN HAO
KOO YEON KWAN
MICROELECTRONICS TECH INC
ATOTECH DEUTSCHLAND GMBH
MARTIN DOMINIC R
BRUKER BIOSPIN AG
SOROCO PRIVATE LTD
Turner Tackle LLC
WAGNER JOACHIM
TOOLTECH LLC
PIONEER TOHOKU CORP
SUBARU CORP
SONOS INC
NEC LAB AMERICA INC
KIOXIA CORP
TAMINCO N V
FLEXOPACK S A PLASTICS IND
JOHNSON & JOHNSON SURGICAL VISION INC
ETAT FINLANDAIS
ZIMMER GUENTHER
ATOMA INT INC
EXXON RESEARCH ENGINEERING CO
BREE JOAN MARY
TRUMPF PHOTONICS INC
COURTAULDS FILMS HOLDINGS
MONTALTI MIRKO
PROCOMAS S R L
CHR HANSEN AS
IND NATUZZI
I P A IND PLASTICA ADRIA DI CHENDI BRUNO &
ARDITI
KUMSUNG MEDICAL INSTR CO LTD
HOWELL THOMAS A
SHIM JAE J
MEGURO TAKESHI
ARNEY SHANE R
UBE MAT IND LTD
POORNACHANDRAN RAJESH
OOI TETSUYA
SCHUMACHER DONALD J
DECKARD CARL
TAPIA MARIO G
PEREGO ANDREA
KAWANA TAKAHIRO
KLAESSIG OSKAR PAUL
FIRM OF OTTO URBAN
GREAT WESTERN ELECTRO CHEMICAL CO
TRAYWAY MFG CO
FAVRE & CIE
HESTAN COMMERCIAL CORP
SHADECRAFT INC
NOVALEAD PHARMA INC
ARKRAY INC
MIYAGAWA TAKUMI
ST MICROELECTRONICS CROLLES 2 SAS
TECHNION RES & DEV FOUNDATION
VIAVI SOLUTIONS INC
KOYO MUSEN CORP
WANGSU SCIENCE & TECH CO LTD
GRABANGO CO
NICHIA CORP
HYUNDAI TRANSYS INC
BEHR GMBH & CO KG
UCHREZHDENIE ROSSIJSKOJ AKADEMII NAUK INST UPRAVLENIJA IM V A TRAPEZNIKOVA RAN
GO URAL SKIJ NI I P
BLAST LOUDSPEAKERS LTD
US ENERGY
ORTNER HEINRICH
PETROLINE WIRELINE SERVICES
MINEBA CO LTD
SIN SIST DE IMPLANTE NACIONAL LTDA
GOLDEN LADY SPA
ALMASSY STANISLAV
SWAMINATHAN GANESH
HORSCH LEEB APPLICATION SYSTEMS GMBH
RES & IND COOPERATION GROUP
KANG JI YEON
JUNG GI YUL
HAESHIN
KANTO ISHI PHARMA CO LTD
KONO NAOYUKI
SWEEN TY
DEVROE ERIC
AJINOMOTO KK
BETTS STEPHEN N
O M KENKYUSHO KK
NISSEI ELECTRIC
JOHNSON M D A
BIOTEKNIKA INTERNATIONAL
THORNEYCROFT JAMES BAIRD
ADIDAS SPORTSCHUHE
ANKARCRONA FREDRIK
HUGERSHOFF REINHARD
ASEA AB
SKODA ENTREPRISE NATIONALE ETS
CHARLES DEGOUD
UNIV GLASGOW
HOWARD THOMAS THORNTON
HOHNEN OIL
NIPPON PETROCHEMICALS CO LTD
GLORY KOGYO KK
TECHCYTE INC
KING SLIDE TECHNOLOGY CO LTD
TERAO NORIYUKI
UNIV TIANJIN TECHNOLOGY
AJAYAN PULICKEL M
HOWA MACHINERY LTD
RYU JINSOOK
COROT AUGUSTE
HOWARD JEROME W
AMERICAN SHEET & TIN PLATE
WARREN FASTENER CORP
OSTROVSKIY ALEKSANDR IONOVICH
AKKARAJU PREM
VERHOVNIK GLENN PAUL JOHANNES
HAO CHENXI
SCPTIME
EXTRAHOP NETWORKS INC
NIHON KOHDEN CORP
WAGNER RANDALL M
LINK CHARLES M II
INST NOGUCHI
JAWOROWSKI MARK R
MEW ROBERT J
MEDGEL CORP
NO 923 HOSPITAL JOINT LOGISTICS SUPPORT FORCE OF THE CHINESE PEOPLES LIBERATION ARMY
TONGHUA DEJI GINSENG PHARMACEUTICAL CO LTD
U PROTEC SHENZHEN TECH CO LTD
SHENZHEN RADIUM BRIGHT SCIENCE AND TECH CO LTD
JIANGSU EASTMAN HEAVY MACHINERY CO LTD
DONGGUAN YUYI AUTOMATION EQUIPMENT LTD COMPANY
TAICANG LIANGSHENG RUBBER CO LTD
GUANGODNG YIKANGSHENG ENVIRONMENTAL PROTECTION TECH CO LTD
SHENZHEN CHUANGYITONG TECH CO LTD
MAIHAI SUZHOU ENVIRONMENTAL PROTECTION TECH CO LTD
XINFENG COANDA ELECTRONIC CO LTD
LIANYUNGANG JINCHEN IND CO LTD
SIHONGXIN MACHINE CASTING CO LTD
SHANDONG HUANNENG DESIGN INST CO LTD
ZHAO JUNFENG
HEILONGJIANG HELIANG AGRICULTURE CO LTD
HANGZHOU BOSS ELECTRIC APPLIANCE CO LTD
LI HUI
BAODING RAKANG SAUSAGE CASING PROC LIMITED COMPANY
HUNAN SANY MEDIUM LIFTING MACHINERY CO LTD
CHANZHOU ZHENYOU ELECTRICAL APPLIANCE LTD COMPANY
JIANGSU HONGBANMA NEW MATERIAL TECH CO LTD
HUAIBEI ZHUOCHUANG TECH SERVICE CO LTD
WAKAMONO joint stock company
P P H POLMAR” DIONIZY SZCZERBA
WIRTGEN GMBH
SHANGHAI KOHLER ELECTRONICS
DAMAKA INC
USTAV MAKROMOLEKULARNI CHEMIE
CULLEN ALEXANDER LAMB
KODIAK NETWORKS INC
SIC MARKING GROUP
JANSSEN PHARMACEUTICALS INC
DUAL MECHANICS CO LTD
OH MIN YOUNG
CHARLES O SANDER
GLASS MURRAY L
STIFT ROBERT J
CHICAGO BY PR

2025-01-16 07:12:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 07:12:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 07:12:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 07:12:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 07:12:11 - snowflake.connector.connection - INFO - closed
2025-01-16 07:12:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 07:12:11 - root - INFO - SQL:
SELECT DISTINCT t."filing_date"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   WHERE t."filing_date" IS NOT NULL
   LIMIT 1000;
Results:
Too long, hard cut:
filing_date
20191106
20200203
20200522
19961122
20010716
19940307
19660908
20090709
19870302
19720621
19791227
19850726
20180430
20180829
19851014
19830303
20180827
19700605
19531130
19700720
19541229
19250406
19120425
19721106
19660112
19050605
19280730
19660103
19840106
19720801
19890110
19340616
19471029
19680102
19700916
19940620
19871127
19911205
19911015
19981130
20010426
20011001
20010724
20030527
20051207
20060403
20070105
20070620
20080303
20080902
20090909
20100909
20110401
20131008
20001006
20020329
20030926
20090619
20231214
20070608
19130811
20230608
19981016
20050314
20051226
20060914
20111220
20160801
20150327
20041104
20080815
20090206
20090506
20120918
20121102
20070611
20101117
19920617
19850729
19710821
19900917
20030822
20070404
20091016
20100621
20110127
20180313
20200611
19970206
20210207
20220122
20210516
20220914
20221122
20230530
20230719
19800923
20030827
19740220
20111129
20040901
20230824
19920909
19990511
20121002
19840704
20110513
20030730
20070905
20160709
20220201
20130819
20160323
20221128
20010402
19650930
19790306
19051023
19920117
19971014
19900123
19770325
19800418
19860314
19810413
19820817
20151231
19790330
19930726
20150520
20020807
20091106
20160502
19990812
20151127
20050124
19770421
19710719
19690321
19640720
19240221
19750110
19950606
19840111
19080227
19450709
19200624
19251211
19900118
19860122
19770216
19780404
19810515
19221125
19930331
19370405
19940225
20080818
19740725
20080426
19980611
19690103
19890401
20190610
20170125
20160411
19770914
19750922
19820911
19880802
19840822
19910726
19980729
20100225
20100922
20121220
19841005
20090213
19870514
19920106
20080116
19721003
19741213
19890812
19910722
19871204
19960507
20110201
20221023
20240311
19700504
19891127
19890817
19980423
20220306
19810116
20010417
20020927
20220204
19080707
20110214
20100907
19510202
19500627
19591124
19570321
19640203
19391103
19321010
19540907
20070102
19050322
19790329
19600603
19840117
19710203
19571230
19660329
19631011
19910226
20020330
20180706
20140810
19840210
20001216
19860707
20000311
19680918
19771014
19741111
19791217
19630730
19570622
19760112
19700523
20210627
19660723
20030107
19810206
19850903
20150515
19890227
19450414
19360518
19180827
19530623
19030801
18970621
19611220
19720107
19330505
19160821
19640113
19590629
19911008
19861114
19871208
19901002
19850517
19890801
19910926
20050911
20070726
20090824
20140708
20170923
19370507
19140608
19200520
19670419
19880423
20120507
19841211
20001007
19900804
20200525
20150419
19900820
19430412
19190821
19570704
19780324
19810918
20200125
19620712
19790714
19160408
19211015
19301004
19470604
19550419
19661220
19170811
19160517
19610825
19790115
19490620
19290305
19680108
19540329
19190121
19661207
19830329
19890616
19120302
19131010
19520703
19580117
19070323
19370421
19651108
19410524
19110526
19571119
19121009
19320831
19820809
19490715
19250921
19590820
19760405
19851022
19940805
19751106
19340914
19471212
19390223
19411006
19590224
19380831
19710907
19020912
19230310
19250112
19621212
19580507
19571206
19720119
19640320
19470408
19881101
19880425
19930827
19691219
19820505
19640709
19870214
19910829
19880919
20180617
19930109
19830625
19870608
19480911
19131021
19500925
19580520
19110209
19401108
19630312
19410227
19701110
19160724
19580107
19760325
20060729
20151106
20140626
20150921
20180529
20190716
20200225
20210322
19970521
20161230
19900419
19791126
19920827
19841109
19881004
19941129
20200430
20030430
20031217
20060523
20061110
20100924
19830902
19871016
20011022
20010507
20211215
20211217
20220414
20230131
20230829
20230919
20231016
20231031
20240108
20020708
19930525
20051122
20001222
19840523
19901204
19941014
19890511
20130222
19770610
20030415
19840215
20091102
20040122
20001009
20110708
19330902
19280807
19380725
19411222
19221010
19091102
19740930
19620620
19300916
20051115
19690618
18921230
19720606
19691216
19371029
19391013
19611130
19820126
19671003
20000906
19641221
19710419
19361205
19840911
20190228
20200605
20140606
20000202
19830131
20050701
19690723
20110530
19990618
19930924
19920408
19910920
19800908
20180227
20220714
19750703
20230929
20031110
20131031
19670318
19750705
20190207
20130118
20160617
20100309
20050711
20160324
20220404
20161012
20201120
20030621
19960719
19400111
20131205
19661025
20000216
20210901
20170427
20180817
20170921
19781009
19881109
19921021
20091218
19930629
20101224
20110407
20151002
20020709
20040405
19751014
19741126
19850912
19870929
20031212
20010615
20070907
20210120
19960423
19781028
19801022
20021119
20010828
19850429
19750331
20110218
20110927
20070504
20160602
20060925
19820701
19741211
19760316
19860403
19650326
19630225
20020125
19910508
19580128
19321125
19530814
19810306
19800208
19730213
19910225
19850228
19960717
19100411
19101028
19120902
19710401
19820325
19660927
19960710
19291212
19320311
19750822
19660105
19910218
19760513
19880309
19660624
19900316
19800522
19990318
19840420
20240510
19850702
20110309
20170822
20140731
20190227
20061013
20050819
19

2025-01-16 07:12:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 07:12:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 07:12:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 07:12:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 149
2025-01-16 07:12:13 - snowflake.connector.connection - INFO - closed
2025-01-16 07:12:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 07:12:13 - root - INFO - SQL:
SELECT DISTINCT TO_CHAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   WHERE TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
   LIMIT 1000;
Results:
filing_year
1948
2006
1903
1937
1898
1922
1923
1886
1942
1908
1846
1881
2015
2016
2018
1983
1978
2007
1974
1961
1913
2024
1924
2010
1926
1988
1976
1901
1955
1998
2009
1933
1950
1927
1904
2019
2023
1899
1931
2017
1935
1996
1938
1953
2021
1968
1949
1887
2005
1945
2003
1956
1940
1928
1967
1939
1972
1960
1911
1895
1987
1910
1994
1985
1993
1986
1890
2004
1989
2011
1915
1946
1995
1912
1930
2000
2012
1885
1905
1907
2020
2002
1934
1925
1917
1916
1997
1880
1963
2014
1952
1920
2022
1984
1990
1958
1853
1966
1877
1973
1954
1883
1962
1918
1897
1991
1921
1914
1981
1999
1980
1979
1892
1970
1941
1971
1943
1896
1860
1964
1900
1906
1947
1929
1969
1909
1957
2001
1894
1932
1882
1867
1944
1992
2013
1951
1889
1975
1959
1919
1893
1902
1965
1982
1891
2008
1977
1888
1936

2025-01-16 07:12:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 07:12:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 07:12:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 07:12:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 93
2025-01-16 07:12:14 - snowflake.connector.connection - INFO - closed
2025-01-16 07:12:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 07:12:15 - root - INFO - SQL:
SELECT DISTINCT t."country_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 1000;
Results:
country_code
DO
BA
RS
WO
CR
PL
EP
ZA
MY
CS
LV
HR
AU
CU
RO
KR
PT
NZ
CL
NO
HU
JP
DZ
NL
LT
UA
MW
IT
OA
CY
CZ
HN
SV
CH
TR
BG
AT
YU
ZM
MD
ZW
MA
GB
SG
EG
PA
CO
SI
AR
KE
FI
DK
CA
SK
IS
NI
US
PH
DE
DD
MX
EE
GE
HK
TN
GT
BR
ID
LU
GR
RU
JO
IN
EC
SA
MN
SU
FR
PE
KZ
IL
TW
MT
BE
SE
AP
SM
ME
EA
ES
IE
CN
MC

2025-01-16 07:12:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 07:12:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 07:12:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 07:12:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 213
2025-01-16 07:12:16 - snowflake.connector.connection - INFO - closed
2025-01-16 07:12:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 07:12:17 - root - INFO - SQL:
SELECT t."application_number", c.value::VARIANT:"code"::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c
   WHERE c.value::VARIANT:"code"::STRING LIKE 'A01B3%'
   LIMIT 1000;
Results:
Too long, hard cut:
application_number,cpc_code
DE-102010019819-A,A01B3/464
US-1913771943-A,A01B3/10
KR-20060032729-A,A01B33/146
KR-20060032729-A,A01B33/06
DE-L0044155-U,A01B33/08
DE-L0044155-U,A01B33/10
DE-L0044155-U,A01B33/00
US-202217990129-A,A01B35/08
US-202217990129-A,A01B35/08
US-202217990129-A,A01B35/08
FR-7531218-A,A01B33/024
FR-7531218-A,A01B33/08
FR-7531218-A,A01B33/021
FR-7531218-A,A01B33/08
FR-7531218-A,A01B33/021
FR-7531218-A,A01B33/024
CA-2543900-A,A01B33/103
CA-2543900-A,A01B33/103
GB-585551-A,A01B35/06
IL-26862419-A,A01B3/24
IL-26862419-A,A01B3/24
US-72598847-A,A01B39/00
US-72598847-A,A01B39/00
US-72598847-A,A01B35/26
US-72598847-A,A01B35/26
KR-19960029894-A,A01B35/28
KR-19960029894-A,A01B35/18
FR-0901549-A,A01B39/163
KR-19970019112-U,A01B35/28
KR-20120005914-A,A01B35/10
KR-20150076822-A,A01B3/36
US-1904197554-A,A01B3/26
US-6966360-A,A01B39/085
US-6966360-A,A01B39/085
US-530054D-A,A01B39/14
US-25445318-A,A01B3/50
US-25445318-A,A01B3/50
CN-201680067381-A,A01B33/16
CN-201680067381-A,A01B33/16
CN-201680067381-A,A01B35/32
US-1912673206-A,A01B35/06
US-376176D-A,A01B3/26
GB-616956-A,A01B3/36
US-3784693-A,A01B31/00
US-3784693-A,A01B31/00
US-159642D-A,A01B35/08
US-395573D-A,A01B35/26
KR-20040020796-A,A01B3/50
JP-2104782-U,A01B33/028
JP-2017239983-A,A01B33/028
JP-2017239983-A,A01B33/024
KR-20010007666-A,A01B39/18
CN-202210606325-A,A01B35/16
CN-202210606325-A,A01B35/28
NO-822521-A,A01B35/00
CN-201280056680-A,A01B33/14
KR-20000009753-U,A01B35/10
US-130700D-A,A01B35/08
FR-960102D-A,A01B33/087
FR-960102D-A,A01B33/082
US-77445391-A,A01B3/46
US-77445391-A,A01B3/46
US-231385D-A,A01B33/065
BE-727862D-A,A01B33/021
US-9826126-A,A01B35/24
US-9826126-A,A01B35/24
AT-720679-A,A01B33/106
NL-7909063-A,A01B33/103
US-469659D-A,A01B35/08
BE-154048-A,A01B33/106
BE-154048-A,A01B33/106
EP-17737210-A,A01B33/06
EP-17737210-A,A01B35/16
KR-20180002946-U,A01B39/18
US-201916456505-A,A01B39/18
US-1901066531-A,A01B3/08
CN-201811558564-A,A01B35/20
CN-201811558564-A,A01B35/26
DE-L0066972-D,A01B35/04
CA-2945250-A,A01B33/106
CA-2945250-A,A01B33/106
EP-19182149-A,A01B33/087
EP-19182149-A,A01B37/00
KR-870011914-A,A01B33/14
US-41054454-A,A01B33/06
US-1209525-A,A01B39/26
US-1209525-A,A01B39/26
CN-202210625064-A,A01B35/20
CN-202210625064-A,A01B35/26
NO-910950-A,A01B35/26
CA-3089518-A,A01B39/18
DE-8707829-U,A01B33/142
GB-8100746-A,A01B35/12
GB-8100746-A,A01B39/10
GB-8100746-A,A01B35/12
GB-8100746-A,A01B39/10
DE-W0001964-A,A01B3/32
CN-200410049370-A,A01B33/021
DE-102017102683-A,A01B35/18
KR-20120091374-A,A01B33/082
KR-20000011273-A,A01B33/00
CN-201510892651-A,A01B33/103
CN-201510892651-A,A01B33/024
CN-201810784089-A,A01B33/065
CN-201810784089-A,A01B33/082
CN-201810784089-A,A01B33/08
JP-2018177517-A,A01B39/18
JP-2018177517-A,A01B39/18
HU-E16197432-A,A01B35/24
KR-20130001424-U,A01B35/16
CN-201810758930-A,A01B33/12
CN-201810758930-A,A01B33/10
CN-202111095366-A,A01B33/08
CN-202111095366-A,A01B33/10
CN-201710053605-A,A01B39/18
NL-7514005-A,A01B33/065
NL-7514005-A,A01B33/065
CN-201580056876-A,A01B35/225
CN-201580056876-A,A01B35/225
CN-201580056876-A,A01B35/225
CN-201710322359-A,A01B33/08
CN-201710322359-A,A01B33/144
CN-202110938555-A,A01B39/16
CN-202110938555-A,A01B39/26
CN-202110938555-A,A01B39/20
KR-20050007441-U,A01B3/28
RU-2019118172-U,A01B35/20
US-50994255-A,A01B39/14
US-50994255-A,A01B39/14
US-52103631-A,A01B3/50
US-52103631-A,A01B3/50
US-501724D-A,A01B3/464
US-20046750-A,A01B35/14
US-20046750-A,A01B35/14
US-5637735-A,A01B39/19
US-5637735-A,A01B39/19
AU-7115874-A,A01B35/26
GB-1095134-A,A01B35/16
GB-1095134-A,A01B33/021
US-68923896-A,A01B35/04
US-68923896-A,A01B35/04
KR-20110130418-A,A01B39/18
DE-140654D-A,A01B3/12
AU-2002301383-A,A01B35/225
AU-2002301383-A,A01B35/225
GB-202013028-A,A01B39/06
GB-202013028-A,A01B39/18
GB-202013028-A,A01B39/18
CN-201710636376-A,A01B35/22
CN-201710636376-A,A01B35/04
IT-2128483-A,A01B33/146
IT-2128483-A,A01B33/106
IT-2128483-A,A01B33/065
IT-2128483-A,A01B33/065
IT-2128483-A,A01B33/106
IT-2128483-A,A01B33/146
US-964648-A,A01B33/025
US-964648-A,A01B33/025
CA-163445-A,A01B3/74
PL-44042622-A,A01B33/00
PL-44042622-A,A01B33/021
PL-44042622-A,A01B33/02
PL-44042622-A,A01B33/04
BE-9300543-A,A01B39/16
BE-9300543-A,A01B39/26
US-290366D-A,A01B35/22
US-51933174-A,A01B35/18
US-51933174-A,A01B39/14
US-51933174-A,A01B39/14
US-51933174-A,A01B35/18
US-71336434-A,A01B33/06
US-71336434-A,A01B33/06
CN-202310902847-A,A01B39/085
CN-202310902847-A,A01B39/22
CN-202310902847-A,A01B39/20
GB-7939943-A,A01B33/106
KR-20000035371-A,A01B35/22
CN-202210179147-A,A01B39/22
CN-202210179147-A,A01B39/18
CN-202210179147-A,A01B39/085
IT-1906685-A,A01B33/065
IT-1906685-A,A01B33/106
US-220177D-A,A01B35/18
US-5528360-A,A01B35/12
US-5528360-A,A01B35/12
FR-508965D-A,A01B3/30
FR-508965D-A,A01B3/18
US-38733520-A,A01B3/54
US-38733520-A,A01B3/54
BE-192096-A,A01B33/065
BE-192096-A,A01B33/16
BE-192096-A,A01B33/12
US-77255596-A,A01B37/00
US-77255596-A,A01B37/00
KR-20180111810-A,A01B33/082
KR-20180111810-A,A01B33/082
KR-20200156448-A,A01B33/14
KR-20200156448-A,A01B35/28
KR-2020015644

2025-01-16 07:12:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 07:12:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 07:12:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 07:12:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 87
2025-01-16 07:12:18 - snowflake.connector.connection - INFO - closed
2025-01-16 07:12:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 07:12:18 - root - INFO - SQL:
SELECT DISTINCT a.value::VARIANT:"name"::STRING AS "assignee_name"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a,
   LATERAL FLATTEN(input => t."cpc") c
   WHERE c.value::VARIANT:"code"::STRING LIKE 'A01B3%'
   LIMIT 1000;
Results:
assignee_name
LEMKEN GMBH & CO KG
BOTVID SETTERGREN ANDERS GOSTA
JIM ALEX SMITH
KUHN SA
TRECKER FRANCIS J
PREC PLANTING LLC
GEORGE A KELLY PLOW COMPANY
GUERBET FRANCOIS
ARWAC LTD
NIEMEYER SOEHNE STAHL PFLUG
DAEHO FARMING MACHINERY CO LTD
QUINSTAR CORP
LG ELECTRONICS INC
NEW ZEALAND INVENTIONS DEV
GERBER HUBERT
WANG XUEDONG
GERBER MAURICE
GLASIER HAROLD H
SHEPPARD RICHARD H
RICHARD CO
ARTHUR BROOKS SPURR
LEINFELDER DIPL-LANDW HERMANN
KORSMEYER ERNEST H
CAMPBELL CLARENCE L
CHOATE STOREY NORMAN
AMAZONEN WERKE DREYER H
UNIV JIANGSU
SJOEHOLMS MEKANISKA AB
ELEOS ROBOTICS INC
WALLNER KLAUS
WILLIAM HENRY HONY FROST
ZHANG LIJIN
SIGFRID ANDERSON ANDERS
EDWARDS JOHN W
EDMOND HEE
UNIV HEILONGJIANG SCI & TECH
HUBER FRANZ FERDINAND
LIM HEON HO
HOLGER LETH
CHONGQING TIANJI IND CO LTD
MARTIN DOMINIC R
AUGUST SETTERGREN OTTO GORAN
MARTIN CHARLES H
FISHER VAN E
KUBOTA KK
CHRISTOPHER H R WOODWARD
Liu Yueshang
SAPHIR MASCHB GMBH
CNH IND AMERICA LLC
LEIJENAAR SYTZE
WALTER ROWAN JAMES
UNIV CHUNG ANG IND
KIM JAE KEUN
CHO SUNG GU
CHRISTEN ARNE JENSEN
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC
WILLIAM DREFKE
KIM BYUNG SUB
TEXAS INDUSTRIES INC
SOUTHERN PLOW COMPANY
AMAZONEN-WERKE H DREYER GMBH & CO KG
HARRELL DANNY H
RUDOLPH HASSON PAUL
MCKAY RALPH LTD
CHONGQING YUBAO AGRICULTURE EXPL CO LTD
LELY NV C VAN DER
DEERE & CO
DAIYO TANGO CO LTD
SAMSUNG KWANGJU ELECTRONICS CO
BULLS CO LTD
INT HARVESTER GREAT BRITAIN
HUBEI SHUANGYU MACHINERY TECH CO LTD
TWOSE OF TIVERTON LTD
PATENT CONCERN NV
UNIV TONGJI
OTULAK PRZEMYSLAW PRO CNC
SALGE HENRY F
KIM JONG JIN
EMPR IMPORT EXPORT Y DISTRIB P
CARLUCCI JAMES J
AGSOILWORKS TECH COMPANY LLC
ALLEN SAMUEL L
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD
UNIV SYDNEY
BETEK GMBH & CO KG
SAMSUNG SDI CO LTD
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY

2025-01-16 07:12:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 07:12:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 07:12:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 07:12:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 57
2025-01-16 07:12:20 - snowflake.connector.connection - INFO - closed
2025-01-16 07:12:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 07:12:20 - root - INFO - SQL:
SELECT DISTINCT TO_CHAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c
   WHERE TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
     AND c.value::VARIANT:"code"::STRING LIKE 'A01B3%'
   LIMIT 1000;
Results:
filing_year
2009
1950
1987
2012
2000
1996
1960
2006
1913
1974
1926
2010
1976
1901
1955
1948
1978
1983
1925
2020
2002
1934
1975
1993
1985
2016
2018
2015
1991
1904
2019
1931
2023
1920
2021
2001
1918
2004
2011
2017
1935
2005
1951
2013
1979
1980
1981
1997
1982
1912
2022
1947
1969
1954
1973
1967
1956

2025-01-16 07:12:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 07:12:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 07:12:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 07:12:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-01-16 07:12:21 - snowflake.connector.connection - INFO - closed
2025-01-16 07:12:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 07:12:22 - root - INFO - SQL:
SELECT DISTINCT t."country_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c
   WHERE c.value::VARIANT:"code"::STRING LIKE 'A01B3%'
   LIMIT 1000;
Results:
country_code
HU
JP
AU
BE
NL
CA
US
DE
AT
KR
IL
RU
PL
IT
GB
ZA
EP
NO
FR
CN

2025-01-16 07:12:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 07:12:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 07:12:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 07:12:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 07:12:23 - snowflake.connector.connection - INFO - closed
2025-01-16 07:12:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 07:12:24 - root - INFO - SQL:
SELECT DISTINCT a.value::VARIANT:"name"::STRING AS "assignee_name",
                    a.value::VARIANT:"country_code"::STRING AS "assignee_country_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a
    LIMIT 1000;
Results:
Too long, hard cut:
assignee_name,assignee_country_code
ST MICROELECTRONICS ROUSSET,FR
NICHIA CORP,JP
GEN ELECTRIC,US
XILINX INC,US
WAVE POWER TECH INC,TW
AMO DEV LLC,US
HEFEI CAS LANRUI TECH CO LTD,CN
PANASONIC IP MAN CO LTD,JP
HILO INNOVATIONS LLC,US
SHENZHEN MINDRAY BIOMEDICAL ELECTRONICS CO LTD,CN
DISCOVERY COMMNUNICATIONS INC,US
INTEL CORP,
EMERSON VULCAN HOLDING LLC,US
LANDIS TIMOTHY J,
WAVETEC VISION SYSTEMS INC,
GELMAN GEOFFREY M,
JEON BAEK-KYUN,
SEO JOO-HONG,
RENESAS TECH CORP,JP
TRAN PETER P,
ENFORA INC,US
MEDTRONIC INC,US
DUAN XIN GAO,
IND TECH RES INST,TW
GEPPERT THEODORE R,
SAKAMOTO TAKUJI,
KONAMI CORP,JP
O'LEARY SHAWN,
WEST CORP,US
GENZYME CORP,US
LOPEZ-ULIBARRI RUAL,
LINDEN H B,
MASTERS DAVID B,
SMITH JONATHAN F,
COHEN TAL,
HAMANN LAWRENCE G,
HAND CHRISTOPHER W,
BREEDEN JAMES T,
TETRA LAVAL HOLDINGS & FINANCE,CH
MEGICA CORP,TW
KIRAZCI ULAS,
WU MICHAEL C L,
DOERR TIMOTHY E,
LUNDQUIST PAUL B,
GEITER DENIS,
HAMILTON MATTHEW CARL,
BAY INSULATION CONTRACTING INC,US
3D HOLDING COMPANY LLC,US
VELOXIS PHARMACEUTICALS INC,US
ST MICROELECTRONICS INT NV,NL
ADIR,
HITACHI METALS LTD,JP
COATEX SAS,FR
UNIV PARIS,FR
KINZEL OLAF,
WARD JOHN L,
COMMSCOPE TECHNOLOGIES LLC,US
THOMAS CREATIVE GROUP PRODUCTIONS LLC,US
UNIV OXFORD INNOVATION LTD,GB
CUREAPP INC,JP
W K KELLOGG FOUNDATION,
FRIEDRICH BECKE,
NASH WALTER C,US
SUPER MOLD CORP,
NAUGLE JOHN J,
EASTMAN KODAK CO,
BUSER ARNOLD,CH
WILSON FRASER,
SYMONS WILSON E,US
DRACONE DEVELOPMENTS LTD,
SANKYO SEIKI SEISAKUSHO KK,
BOLSEY JACQUES,US
EVG ENTWICKLUNG VERWERT GES,
JOHNSON REGINALD TAVERNOR,
BELDEN MFG CO,
MARQUETTE TOOL & MFG CO,
SCHNEIDER & CIE,FR
STANLEY MCCLATCHIE,
COPEMAN LAB CO,
SDRUZENI PODNIKU TEXTILNIHO ST,
STREIMER MORRIS,GB
EGLI RUDOLF,IT
HARRY LEONARD JONES,
RITCHEY EUGENE,
SCOVILLE MFG COMPANY,
ILLINOIS TOOL WORKS,
BEIJING YOUAN HOSPITAL CAPITAL MEDICAL UNIV,
JIANGSU GAOCHUANG ELECTROMECHANICAL MFG CO LTD,
ZHANG SHULI,
NANTONG MODENG CLOTHING CO LTD,
JIAMUSI POWER SUPPLY COMPANY OF STATE GRID HEILONGJIANG ELECTRIC POWER COMPANY LTD,
HUANENG QINMEI RUIJIN POWER GENERATION CO LTD,
SICHUAN SIMON YIHUA ELECTRICAL CO LTD,
SONG RUYING,
NETINOVO TECH SHENZHEN LTD,
SHENZHEN YUANKEYU TECH CO LTD,
BAOJI TIANKANG ELECTRICAL EQUIPMENT CO LTD,
KAZUXIN IRON ALLOY LTD COMPANY,
SUZHOU SHUIXING ENVIRONMENTAL PROT INDUSTRIAL SYSTEM CO LTD,
INFOVISION OPTOELECT KUNSHAN,
TIANZHOU CHANGZHOU AUTOMATION STOCK LTD COMPANY,
JINAN KEDA ADHESIVE COLOR PRINTING CO LTD,
CHEN XI,
WUHAN QINGZHIWEI MEDICAL EQUIPMENT LTD COMPANY,
BYD CO LTD,
TIANJIN JINGWEI SCIENCE AND TECH CO LTD,
GUIZHOU YUNTENG ENVIRONMENTAL PROT ENGINEERING LIMITED COMPANY,
QINGDAO OUMUYE MACHINERY CO LTD,
BALANCED WATER MOTOR STOCK LTD COMPANY,
YIXING YIXIANG SI TECH CO LTD,
TANGSHAN HUIFENG STEEL CO LTD,
YONGKANG SHENGYI ENERGY TECH CO LTD,
XINJIANG ELECTRIC POWER ENGINEERING SUPERVISION LTD RESPONSIBILITY COMPANY,
ZKW GROUP GMBH,AT
WHITE DRIVE PRODUCTS INC,US
TIMPSON LTD,
CAMBRIDGE ENTPR LTD,
DAIMLER CHRYSLER AG,
WATTS ELIZABETH K,
LASER MAGNETIC STORAGE INT,US
ANNO KOJI,JP
HELBLING CHRISTIAN FA,DE
INTRA INTERNAT AB,SE
PERINI FABIO SPA,IT
PANIZZOLO IVAN,IT
EIKEN CHEMICAL,JP
MERCK & CO INC,US
ISCAR LTD,
JUNG HO WOON,KR
UNIV NAT MINING,UA
INFOSEEK CORP,
PILKINGTON AEROSPACE LTD,
SIERRA SEMICONDUCTOR BV,NL
TODO PRODUKTIONS & FOERSAELJNI,SE
SINGAPORE HEALTH SERV PTE LTD,SG
GUNNER ESKESEN,DK
I P A S R L,IT
HERCULES SA,
TOYO BOSEKI,JP
FERRER INT,ES
FRIEDRICH MIESCHER INSTITUTE FOR BIOMEDICAL RES,CH
GENTURE ELECTRONICS CO LTD,CN
INST NAT RECH INF AUTOMAT,FR
HAIER SMART HOME CO LTD,CN
VIVO MOBILE COMMUNICATION CO LTD,CN
COVESTRO DEUTSCHLAND AG,DE
AL KO KOBER SE,DE
SINGLE BUOY MOORINGS,CH
SUAREZ SUAREZ LUIS HERNANDO,CO
SCOLOPPIO RAFFAELE,IT
IMAMURA NAOYA,JP
EZGO CO LTD,KR
MCDEVITT TODD CHARLES,US
DUTHIE ROBERT SCOTT,US
MCINTYRE WILLIAM C,US
CVILUX CORP,TW
MAX PLANCK INST FUER EISENFORSCHUNG GMBH,DE
ARSANUKAEV MUKHAMED MAGOMEDOVICH,RU
CLAAS Sebstfahrende Erntemaschinen GmbH,DE
CHINA ACADEMY TELECOMMUNICATIONS TECHNOLOGY,CN
CATERPILLAR TRIMBLE CONTROL TECH LLC,US
LUMILEDS LLC,US
CVC TECH INC,TW
LUMMUS TECHNOLOGY INC,US
SOMA MANI,US
MEN SHIKH OLEG FEDOROVICH,RU
INT MOBILE MACHINES,US
DEUTSCHE TELEKOM AG,
FLYGT AB ITT,SE
KAYSERSBERG PACKAGING SA,FR
NOTO SERGIO,
NIOBEC INC,CA
LCI ITALY SRL,
CHAO DAVID,
TAMURA JUN,
HOFFMAN WILLIAM H,
KNIGHTON MARK S,
KRISHNAMOORTHI RAGHURAMAN,
NAT INST OF ADV IND SCI AND TE,JP
AMERICAN FLUORESCENT CORP,US
HORNBACH DAVID W,
ADOBE SYSTEMS INC,US
MEDLINE IND INC,US
BLAU AUTOMOBILTECHNIK GMBH,AT
OESTREICHER PURATOR,AT
WADDINGTON HARRY H,GB
FRIEDMAN YIZHAK,
EIDENBERG KASPAR,
USINES ROYERES SA DES,
NISSHIN SPINNING,
AGUSTA AERONAUT COSTR,
SIG SCHWEIZ INDUSTRIEGES,
NYITRAI FERENC,
PAIZS JOZSEF,
BRAND OTTO GMBH,DE
ELBIT LTD,IL
COGNIS DEUTSCHLAND GMBH,DE
VAEAENAENEN RAIMO,FI
PARMA OY,FI
HAN CHOL,KR
GOLDSCHMIDT AG TH,
SCHAEFER WERKE KG,
MASCHF AUGSBURG NUERNBERG AG,DE
GARIN GERT,SE
BUDDENBOHM NILS,DE
DRONGE MARK,US
AKADEMIA IM JANA DLUGOSZA W CZESTOCHOWIE,PL
TRATECNICA S A,ES
Gea mechanical equipment italia spa,IT
ARUPA 

2025-01-16 07:12:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 07:12:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 07:12:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 07:12:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 07:12:25 - snowflake.connector.connection - INFO - closed
2025-01-16 07:12:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 07:12:26 - root - INFO - SQL:
SELECT a.value::VARIANT:"name"::STRING AS "assignee_name",
           COUNT(DISTINCT t."application_number") AS "application_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a
    GROUP BY a.value::VARIANT:"name"::STRING
    ORDER BY "application_count" DESC
    LIMIT 1000;
Results:
Too long, hard cut:
assignee_name,application_count
SAMSUNG ELECTRONICS CO LTD,2238
CANON KK,2114
HITACHI LTD,2011
MATSUSHITA ELECTRIC IND CO LTD,1948
MITSUBISHI ELECTRIC CORP,1732
SONY CORP,1477
FUJITSU LTD,1363
TOSHIBA CORP,1296
NEC CORP,1280
IBM,1239
LG ELECTRONICS INC,1053
HUAWEI TECH CO LTD,1027
SIEMENS AG,987
SEIKO EPSON CORP,963
GEN ELECTRIC,947
SHARP KK,913
STATE GRID CORP CHINA,839
TOYOTA MOTOR CORP,839
BOSCH GMBH ROBERT,837
HONDA MOTOR CO LTD,836
QUALCOMM INC,812
RICOH KK,735
DENSO CORP,628
SANYO ELECTRIC CO,616
HYUNDAI MOTOR CO LTD,577
NIPPON TELEGRAPH & TELEPHONE,568
TOSHIBA KK,545
BAYER AG,528
FUJI PHOTO FILM CO LTD,522
NISSAN MOTOR,515
TOYOTA MOTOR CO LTD,507
MITSUBISHI HEAVY IND LTD,488
ZTE CORP,479
INTEL CORP,475
ERICSSON TELEFON AB L M,462
BOE TECHNOLOGY GROUP CO LTD,435
FUJI XEROX CO LTD,427
DU PONT,423
MATSUSHITA ELECTRIC WORKS LTD,403
NIPPON STEEL CORP,401
SUMITOMO ELECTRIC INDUSTRIES,399
PROCTER & GAMBLE,394
BASF AG,366
HOECHST AG,364
GREE ELECTRIC APPLIANCES INC ZHUHAI,364
PANASONIC CORP,357
SUMITOMO CHEMICAL CO,354
TOKYO SHIBAURA ELECTRIC CO,353
FUJIFILM CORP,349
BROTHER IND LTD,325
HOFFMANN LA ROCHE,319
FORD GLOBAL TECH LLC,319
LG CHEMICAL LTD,318
KYOCERA CORP,316
UNIV ZHEJIANG,314
MURATA MANUFACTURING CO,305
PHILIPS NV,304
APPLE INC,299
TORAY INDUSTRIES,298
KONINKL PHILIPS ELECTRONICS NV,298
HON HAI PREC IND CO LTD,296
DAINIPPON PRINTING CO LTD,294
SAMSUNG DISPLAY CO LTD,289
MICROSOFT CORP,285
MIDEA GROUP CO LTD,278
FUJI ELECTRIC CO LTD,270
NIPPON ELECTRIC CO,270
TAIWAN SEMICONDUCTOR MFG CO LTD,269
UNIV TSINGHUA,264
KOBE STEEL LTD,262
MICROSOFT TECHNOLOGY LICENSING LLC,256
3M INNOVATIVE PROPERTIES CO,253
SEKISUI CHEMICAL CO LTD,249
OKI ELECTRIC IND CO LTD,241
RICOH CO LTD,240
EASTMAN KODAK CO,238
XEROX CORP,236
OMRON TATEISI ELECTRONICS CO,236
KAO CORP,234
NIKON CORP,231
WESTINGHOUSE ELECTRIC CORP,231
TOKYO ELECTRON LTD,230
TOPPAN PRINTING CO LTD,229
CASIO COMPUTER CO LTD,229
MOTOROLA INC,228
BASF SE,225
KONISHIROKU PHOTO IND,225
APPLIED MATERIALS INC,224
BRIDGESTONE CORP,222
NITTO DENKO CORP,221
MICRON TECHNOLOGY INC,220
YAZAKI CORP,219
BOEING CO,217
HYNIX SEMICONDUCTOR INC,214
RCA CORP,213
HEWLETT PACKARD DEVELOPMENT CO,213
DAIKIN IND LTD,211
TDK CORP,209
SAMSUNG SDI CO LTD,208
LG DISPLAY CO LTD,208
GEN MOTORS CORP,206
OLYMPUS OPTICAL CO,206
PANASONIC IP MAN CO LTD,205
CIBA GEIGY AG,204
MAZDA MOTOR,203
SHELL INT RESEARCH,201
TEXAS INSTRUMENTS INC,200
UNIV CALIFORNIA,199
LILLY CO ELI,199
PETROCHINA CO LTD,199
TENCENT TECH SHENZHEN CO LTD,197
NTT DOCOMO INC,195
UNIV SOUTH CHINA TECH,192
GUANGDONG OPPO MOBILE TELECOMMUNICATIONS CORP LTD,191
OLYMPUS CORP,190
UNIV TIANJIN,190
SAMSUNG ELECTRO MECH,190
KIA MOTORS CORP,187
COLGATE PALMOLIVE CO,186
SUMITOMO WIRING SYSTEMS,186
KUBOTA KK,183
SEMICONDUCTOR ENERGY LAB,182
FURUKAWA ELECTRIC CO LTD,181
SANKYO CO,180
CHINA PETROLEUM & CHEM CORP,180
DOW CHEMICAL CO,178
OREAL,177
PFIZER,175
KAWASAKI STEEL CO,173
POSCO,172
ICI LTD,171
KOREA ELECTRONICS TELECOMM,170
UNIV JILIN,169
HAIER SMART HOME CO LTD,167
TOSHIBA TEC KK,165
SHIMADZU CORP,165
NIPPON KOKAN KK,165
SUMITOMO METAL IND,165
BAYERISCHE MOTOREN WERKE AG,165
NOVARTIS AG,165
SHINETSU CHEMICAL CO,165
MINNESOTA MINING & MFG,164
COMMISSARIAT ENERGIE ATOMIQUE,163
ASAHI CHEMICAL IND,162
ALPS ELECTRIC CO LTD,161
HONEYWELL INT INC,160
MERCK PATENT GMBH,159
AISIN SEIKI,159
GOOGLE LLC,159
UNIV SOUTHEAST,158
UNIV SHANGHAI JIAOTONG,158
HITACHI CHEMICAL CO LTD,157
LG INNOTEK CO LTD,155
ISHIKAWAJIMA HARIMA HEAVY IND,155
NANJING UNIVERSITY OF TECHNOLOGY,153
CENTRE NAT RECH SCIENT,152
ZAHNRADFABRIK FRIEDRICHSHAFEN,151
ASAHI GLASS CO LTD,150
ISEKI AGRICULT MACH,150
VOLKSWAGEN AG,150
GM GLOBAL TECH OPERATIONS INC,148
ILLINOIS TOOL WORKS,147
AMERICAN CYANAMID CO,147
MERCK & CO INC,146
ALIBABA GROUP HOLDING LTD,145
NTN TOYO BEARING CO LTD,142
IND TECH RES INST,142
NOKIA CORP,142
INFINEON TECHNOLOGIES AG,142
KONINKLIJKE PHILIPS NV,142
MITSUBISHI MATERIALS CORP,141
DEERE & CO,141
KIMBERLY CLARK CO,141
MITSUBISHI CHEM CORP,138
HALLIBURTON ENERGY SERVICES INC,138
YAMAHA MOTOR CO LTD,137
UNIV SHANDONG,136
BYD CO LTD,136
NSK LTD,136
WESTERN ELECTRIC CO,136
MURATA MACHINERY LTD,136
BEIJING XIAOMI MOBILE SOFTWARE CO LTD,134
HONGFUJIN PREC IND SHENZHEN,134
KAWASAKI HEAVY IND LTD,133
UNILEVER NV,132
AUDI AG,131
SCHAEFFLER TECHNOLOGIES AG,131
UNIV JIANGNAN,130
KOMATSU MFG CO LTD,130
UNIV NANJING FORESTRY,128
FUJIKURA LTD,128
AU OPTRONICS CORP,127
CHINA PETROLEUM & CHEMICAL,127
TOYO BOSEKI,127
FRAUNHOFER GES FORSCHUNG,126
HITACHI METALS LTD,126
TEIJIN LTD,126
ROHM & HAAS,125
NGK INSULATORS LTD,124
UNION CARBIDE CORP,124
YOKOHAMA RUBBER CO LTD,123
VICTOR COMPANY OF JAPAN,122
UNIV DALIAN TECH,122
JFE STEEL CORP,120
UNIV HUAZHONG SCIENCE TECH,119
UNIV CENTRAL SOUTH,119
UNITED TECHNOLOGIES CORP,118
TOTO LTD,118
YAMAHA CORP,118
SANYO PRODUCT CO LTD,117
UNIV KUNMING SCIENCE & TECHNOLOGY,117
PANASONIC IP MAN CORP,116
DOW GLOBAL TECHNOLOGIES LLC,116
UNIV BEIHANG,114
ROHM CO LTD,114
GUANGDONG POWER GRID CO,114
MITSUBISHI RAYON CO,114
SHOWA DENKO KK,1

2025-01-16 07:12:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 07:12:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 07:12:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 07:12:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 07:12:27 - snowflake.connector.connection - INFO - closed
2025-01-16 07:12:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 07:12:28 - root - INFO - SQL:
SELECT t."application_number",
           TO_CHAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    WHERE TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    LIMIT 1000;
Results:
Too long, hard cut:
application_number,filing_year
EP-21720111-A,2021
EP-21761564-A,2021
EP-21826037-A,2021
EP-21847990-A,2021
EP-21954095-A,2021
EP-22172338-A,2017
EP-22182986-A,2022
EP-22185887-A,2022
EP-22206254-A,2022
EP-22305030-A,2022
EP-22711521-A,2022
EP-22714327-A,2022
EP-22762898-A,2022
EP-22787080-A,2022
EP-22787590-A,2022
EP-22813151-A,2022
EP-22825233-A,2022
EP-22883336-A,2022
EP-23187669-A,2015
EP-23194117-A,2023
EP-23825354-A,2023
EP-79104562-A,1979
EP-81110668-A,1981
EP-81400503-A,1981
EP-82900480-A,1981
EP-83100816-A,1983
EP-83402348-A,1983
EP-84890094-A,1984
EP-85201625-A,1985
EP-85900311-A,1984
EP-85901551-A,1985
EP-86109427-A,1986
EP-86890309-A,1986
EP-87106729-A,1987
EP-87109344-A,1987
EP-87110364-A,1987
EP-88403074-A,1988
EP-88907553-A,1988
EP-89102570-A,1989
EP-89402513-A,1989
EP-91116467-A,1991
EP-91122337-A,1992
EP-91903101-A,1991
EP-92114911-A,1992
EP-92910829-A,1992
EP-93918698-A,1993
EP-94400056-A,1994
EP-94904951-A,1994
EP-94908543-A,1994
EP-94921804-A,1994
EP-95109827-A,1995
EP-95109931-A,1995
EP-95924269-A,1995
EP-96103022-A,1996
EP-96110211-A,1996
EP-96402559-A,1996
EP-97114840-A,1997
EP-97117997-A,1997
EP-97302341-A,1997
EP-97944752-A,1997
EP-97946710-A,1997
EP-98918086-A,1998
EP-98938911-A,1998
EP-98949518-A,1998
EP-99903807-A,1999
EP-99928719-A,1999
EP-99965543-A,1999
FI-20225229-A,2022
HK-02100538-A,2002
HK-03104403-A,2003
HK-04104019-A,2004
HK-05100346-A,2005
HK-06102498-A,2006
HK-06111962-A,2006
HK-07114356-A,2007
HK-11105637-A,2011
HK-14101589-A,2014
HK-15102298-A,2015
HK-15103771-A,2015
HK-15105067-A,2015
HK-16103067-A,2016
HK-16112544-A,2016
HK-18103604-A,2018
HK-18113641-A,2018
HK-19100246-A,2012
HK-98115200-A,1998
HK-99106102-A,1998
IE-20060594-A,1991
IE-20170204-A,2017
IT-BO940118-A,1994
IT-BS910001-A,1991
IT-BS910096-A,1991
IT-MC920020-A,1992
IT-MI912421-A,1991
IT-MI941789-A,1994
IT-MI960149-A,1996
IT-MI982396-A,1998
IT-MI992424-A,1999
IT-OR970002-A,1997
IT-PD930195-A,1993
IT-PI930016-A,1993
IT-RM920122-A,1992
IT-RM930191-A,1993
IT-RM970396-A,1997
IT-TO960328-A,1996
IT-TO960613-A,1996
IT-TO980767-A,1998
IT-TO980910-A,1998
IT-TV940008-A,1994
IT-UD930040-A,1993
IT-UD940193-A,1994
NO-20150427-A,2015
NO-20191175-A,2019
PE-16731990-A,1990
PL-22590880-A,1980
PL-22817480-A,1980
PL-23227781-A,1981
PL-25258185-A,1985
PL-25785486-A,1986
PL-26258986-A,1986
PL-26492787-A,1987
PL-26895187-A,1987
PL-30640194-A,1994
PL-30945695-A,1995
PL-31404796-A,1996
PL-32881997-A,1997
PL-33790498-A,1998
PL-36291701-A,2001
PL-36509004-A,2004
PL-37102402-A,2002
PL-38005906-A,2006
PL-39831812-A,2012
PL-39835909-A,2009
PL-40016712-A,2012
PL-42696518-A,2018
PL-42954419-A,2019
PL-43769721-A,2021
PL-44113622-A,2022
US-10019405-A,2005
US-10062605-A,2005
US-10258602-A,2002
US-10304305-A,2005
US-10757208-A,2008
US-11011105-A,2005
US-11066508-A,2008
US-11386505-A,2005
US-11469002-A,2002
US-11553505-A,2005
US-11658302-A,2002
US-11964905-A,2005
US-12292908-A,2008
US-12694405-A,2005
US-12736305-A,2005
US-12816005-A,2005
US-13294705-A,2005
US-13350605-A,2005
US-13593808-A,2008
US-14084702-A,2002
US-14255905-A,2005
US-14289402-A,2002
US-14322405-A,2005
US-14445605-A,2005
US-14624702-A,2002
US-14704308-A,2008
US-14947708-A,2008
US-14991602-A,2000
US-15056702-A,2002
US-15255805-A,2005
US-15676708-A,2008
US-15774308-A,2008
US-15924607-A,2007
US-15929202-A,2002
US-15965105-A,2005
US-16091202-A,2002
US-16638002-A,2002
US-16658705-A,2005
US-16815205-A,2005
US-16894008-A,2008
US-17063802-A,2002
US-17423108-A,2008
US-17587105-A,2005
US-17608808-A,2008
US-17678705-A,2005
US-17777708-A,2008
US-18196208-A,2008
US-18265005-A,2005
US-18297708-A,2008
US-18378602-A,2002
US-19543005-A,2005
US-20242202-A,2002
US-20504105-A,2005
US-20742605-A,2005
US-21069402-A,2002
US-21151402-A,2002
US-21380508-A,2008
US-21381608-A,2008
US-22027005-A,2005
US-22095908-A,2008
US-22106808-A,2008
US-22365605-A,2005
US-22566505-A,2005
US-22628007-A,2007
US-22713505-A,2005
US-22749505-A,2005
US-22771708-A,2008
US-22773102-A,2002
US-22786202-A,2002
US-22799005-A,2005
US-22832508-A,2008
US-23003408-A,2008
US-23012202-A,2002
US-23021105-A,2005
US-23127308-A,2008
US-23459605-A,2005
US-23985002-A,2001
US-24059702-A,2002
US-24309808-A,2008
US-24366205-A,2005
US-24452402-A,2002
US-24548808-A,2008
US-24872308-A,2008
US-25069008-A,2008
US-25117605-A,2005
US-25120402-A,2002
US-25230105-A,2005
US-25343005-A,2005
US-25373608-A,2008
US-25555608-A,2008
US-25592408-A,2008
US-25748902-A,2002
US-25761905-A,2005
US-26388705-A,2005
US-26397905-A,2005
US-26438502-A,2002
US-26620505-A,2005
US-26851605-A,2005
US-27275702-A,2002
US-27335208-A,2008
US-27526303-A,2001
US-27742206-A,2006
US-27794902-A,2002
US-28143205-A,2005
US-28465505-A,2005
US-28481608-A,2008
US-28569105-A,2005
US-28829705-A,2005
US-28844605-A,2005
US-29253508-A,2008
US-29275402-A,2002
US-29696607-A,2007
US-29756005-A,2005
US-29966207-A,2007
US-30275702-A,2002
US-30603005-A,2005
US-30663802-A,2002
US-30683706-A,2006
US-201715402499-A,2017
US-201715404486-A,2017
US-201715405163-A,2017
US-201715406347-A,2017
US-2017154109

2025-01-16 07:12:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 07:12:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 07:12:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 07:12:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 143
2025-01-16 07:12:29 - snowflake.connector.connection - INFO - closed
2025-01-16 07:12:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 07:12:30 - root - INFO - SQL:
SELECT DISTINCT a.value::VARIANT:"country_code"::STRING AS "assignee_country_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a
    LIMIT 1000;
Results:
assignee_country_code
KP
OM
NG
TJ
FI
DK
BS
AD
SL
LA
LI
IQ
RS
JE
KH
PE
VC
SZ
SI
AR
PK
LT
US
DE
BB
PH
DD
ZA
CM
PA
EG
TC
JP
HU
AN
AG
TT
TM
HR
ET
GG
UA
MA
EE
MX
GE
SC
NO
MO
KZ
GR
AE
PF
RU
AM
PL
CR
TH
KW
LK
CZ
SV
HN
CH
AI
VE
VN
PR
NC
GH
KG
CA
SK
IS
AZ
UY
BD
GA
KR
RO
SM
CK
ME
SA
MY
CS
LV
CO
SY
BZ
LB
LU
NL
UZ
MD
ST
IR
QA
JO
BM
GB
SG
HK
VG
GT
TN
BR
BY
ID
WS
NA
""
YU
ZM
AU
CU
ZW
IN
EC
IE
ES
MU
CN
MC
TR
BG
AT
TW
IL
MT
BE
SE
KY
IT
CY
BN
GI
IM
NZ
CL
PT
FR
SU

2025-01-16 07:12:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 07:12:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 07:12:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 07:12:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 213
2025-01-16 07:12:31 - snowflake.connector.connection - INFO - closed
2025-01-16 07:12:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 07:12:31 - root - INFO - SQL:
SELECT t."publication_number", c.value::VARIANT:"code"::STRING AS "cpc_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") c
    WHERE c.value::VARIANT:"code"::STRING LIKE 'A01B3%'
    LIMIT 1000;
Results:
Too long, hard cut:
publication_number,cpc_code
GB-696973-A,A01B35/06
IL-268624-A,A01B3/24
IL-268624-A,A01B3/24
US-2597821-A,A01B39/00
US-2597821-A,A01B39/00
US-2597821-A,A01B35/26
US-2597821-A,A01B35/26
FR-2943502-A1,A01B39/163
US-1093294-A,A01B3/10
KR-20070101567-A,A01B33/146
KR-20070101567-A,A01B33/06
DE-1963184-U,A01B33/08
DE-1963184-U,A01B33/10
DE-1963184-U,A01B33/00
KR-200149462-Y1,A01B35/28
KR-101169320-B1,A01B35/10
KR-101593221-B1,A01B3/36
US-2024164239-A1,A01B35/08
US-2024164239-A1,A01B35/08
US-2024164239-A1,A01B35/08
FR-2287837-B1,A01B33/024
FR-2287837-B1,A01B33/08
FR-2287837-B1,A01B33/021
FR-2287837-B1,A01B33/08
FR-2287837-B1,A01B33/021
FR-2287837-B1,A01B33/024
DE-102010019819-B4,A01B3/464
US-828171-A,A01B3/26
US-3129772-A,A01B39/085
US-3129772-A,A01B39/085
US-530054-A,A01B39/14
US-1471180-A,A01B3/50
US-1471180-A,A01B3/50
KR-100191418-B1,A01B35/28
KR-100191418-B1,A01B35/18
CA-2543900-A1,A01B33/103
CA-2543900-A1,A01B33/103
US-1412308-A,A01B3/54
US-1412308-A,A01B3/54
KR-102593393-B1,A01B33/082
KR-102593393-B1,A01B33/082
KR-102484290-B1,A01B33/14
KR-102484290-B1,A01B35/28
KR-102484290-B1,A01B33/14
KR-102484290-B1,A01B35/28
AU-2016269849-A1,A01B39/18
AU-2016269849-A1,A01B39/18
BE-872468-A,A01B33/065
BE-872468-A,A01B33/16
BE-872468-A,A01B33/12
US-5845717-A,A01B37/00
US-5845717-A,A01B37/00
ZA-808003-B,A01B39/22
ZA-808003-B,A01B35/225
ZA-808003-B,A01B39/22
ZA-808003-B,A01B35/225
GB-2089182-B,A01B33/065
IT-1064821-B,A01B33/065
IT-1064821-B,A01B33/065
CA-2977468-A1,A01B33/024
BE-727862-A,A01B33/021
US-1636048-A,A01B35/24
US-1636048-A,A01B35/24
KR-200194260-Y1,A01B35/10
US-10375891-B2,A01B39/18
US-10375891-B2,A01B39/18
US-10375891-B2,A01B39/18
US-130700-A,A01B35/08
FR-960102-A,A01B33/087
FR-960102-A,A01B33/082
US-5267618-A,A01B3/46
US-5267618-A,A01B3/46
US-231385-A,A01B33/065
KR-20020067218-A,A01B39/18
CN-115362764-A,A01B35/16
CN-115362764-A,A01B35/28
NO-153631-B,A01B35/00
CN-104040083-B,A01B33/14
US-220177-A,A01B35/18
US-3054462-A,A01B35/12
US-3054462-A,A01B35/12
FR-508965-A,A01B3/30
FR-508965-A,A01B3/18
US-290366-A,A01B35/22
US-3963079-A,A01B35/18
US-3963079-A,A01B39/14
US-3963079-A,A01B39/14
US-3963079-A,A01B35/18
US-2031188-A,A01B33/06
US-2031188-A,A01B33/06
CN-116671357-A,A01B39/085
CN-116671357-A,A01B39/22
CN-116671357-A,A01B39/20
GB-2039201-B,A01B33/106
KR-20020000597-A,A01B35/22
CN-114651538-A,A01B39/22
CN-114651538-A,A01B39/18
CN-114651538-A,A01B39/085
IT-8519066-A1,A01B33/065
IT-8519066-A1,A01B33/106
PL-440426-A1,A01B33/00
PL-440426-A1,A01B33/021
PL-440426-A1,A01B33/02
PL-440426-A1,A01B33/04
BE-1007083-A5,A01B39/16
BE-1007083-A5,A01B39/26
KR-100626846-B1,A01B3/50
JP-S6342702-Y2,A01B33/028
JP-6910281-B2,A01B33/028
JP-6910281-B2,A01B33/024
US-159642-A,A01B35/08
US-395573-A,A01B35/26
CN-108289407-A,A01B33/16
CN-108289407-A,A01B33/16
CN-108289407-A,A01B35/32
US-1081539-A,A01B35/06
US-376176-A,A01B3/26
GB-792883-A,A01B3/36
US-5407014-A,A01B31/00
US-5407014-A,A01B31/00
CN-114916261-A,A01B35/20
CN-114916261-A,A01B35/26
NO-910950-L,A01B35/26
CA-3089518-A1,A01B39/18
US-694931-A,A01B3/08
CN-109392332-A,A01B35/20
CN-109392332-A,A01B35/26
DE-463858-C,A01B35/04
CA-2945250-A1,A01B33/106
CA-2945250-A1,A01B33/106
EP-3586579-A1,A01B33/087
EP-3586579-A1,A01B37/00
US-2888084-A,A01B33/06
US-1545136-A,A01B39/26
US-1545136-A,A01B39/26
US-2019324472-A1,A01B39/18
DE-8707829-U1,A01B33/142
KR-200487998-Y1,A01B39/18
BE-826346-A,A01B33/106
BE-826346-A,A01B33/106
AT-A720679-A,A01B33/106
NL-7909063-A,A01B33/103
US-469659-A,A01B35/08
KR-900006618-B1,A01B33/14
EP-3474651-C0,A01B33/06
EP-3474651-C0,A01B35/16
US-2843032-A,A01B39/14
US-2843032-A,A01B39/14
US-1860534-A,A01B3/50
US-1860534-A,A01B3/50
US-501724-A,A01B3/464
US-2784656-A,A01B35/14
US-2784656-A,A01B35/14
US-2039702-A,A01B39/19
US-2039702-A,A01B39/19
AU-7115874-A,A01B35/26
GB-436304-A,A01B35/16
GB-436304-A,A01B33/021
US-5669452-A,A01B35/04
US-5669452-A,A01B35/04
AU-2002301383-B2,A01B35/225
AU-2002301383-B2,A01B35/225
CN-113761309-A,A01B39/16
CN-113761309-A,A01B39/26
CN-113761309-A,A01B39/20
CN-107072143-A,A01B35/225
CN-107072143-A,A01B35/225
CN-107072143-A,A01B35/225
CN-107094377-A,A01B33/08
CN-107094377-A,A01B33/144
KR-20130063834-A,A01B39/18
DE-140654-C,A01B3/12
US-2545590-A,A01B33/025
US-2545590-A,A01B33/025
CA-997451-A,A01B3/74
KR-200386017-Y1,A01B3/28
RU-191537-U1,A01B35/20
GB-2598141-A,A01B39/06
GB-2598141-A,A01B39/18
GB-2598141-A,A01B39/18
CN-107646212-A,A01B35/22
CN-107646212-A,A01B35/04
IT-1166526-B,A01B33/146
IT-1166526-B,A01B33/106
IT-1166526-B,A01B33/065
IT-1166526-B,A01B33/065
IT-1166526-B,A01B33/106
IT-1166526-B,A01B33/146
GB-2090713-B,A01B35/12
GB-2090713-B,A01B39/10
GB-2090713-B,A01B35/12
GB-2090713-B,A01B39/10
DE-829523-C,A01B3/32
CN-100366901-C,A01B33/021
JP-6998053-B2,A01B39/18
JP-6998053-B2,A01B39/18
HU-E050035-T2,A01B35/24
KR-200473688-Y1,A01B35/16
CN-108575125-A,A01B33/12
CN-108575125-A,A01B33/10
CN-113796181-A,A01B33/08
CN-113796181-A,A01B33/10
CN-106973572-B,A01B39/18
NL-183071-C,A01B33/065
NL-183071-C,A01B33/065
DE-102017102683-A1,A01B35/18
KR-101378314-B1,A01B33/08

2025-01-16 07:12:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 07:12:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 07:12:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 07:12:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-16 07:12:33 - snowflake.connector.connection - INFO - closed
2025-01-16 07:12:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 07:12:54 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 07:12:54 - root - INFO - ```sql
SELECT DISTINCT
    SUBSTRING(c.value::VARIANT:"code"::STRING, 1, 1) AS "cpc_section",
    SUBSTRING(c.value::VARIANT:"code"::STRING, 2, 2) AS "cpc_class",
    SUBSTRING(c.value::VARIANT:"code"::STRING, 4, 1) AS "cpc_subclass"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."cpc") c
LIMIT 1000;
```
2025-01-16 07:12:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 07:12:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 07:12:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 07:12:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 675
2025-01-16 07:12:55 - snowflake.connector.connection - INFO - closed
2025-01-16 07:12:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 07:12:56 - root - INFO - SQL:
SELECT DISTINCT
    SUBSTRING(c.value::VARIANT:"code"::STRING, 1, 1) AS "cpc_section",
    SUBSTRING(c.value::VARIANT:"code"::STRING, 2, 2) AS "cpc_class",
    SUBSTRING(c.value::VARIANT:"code"::STRING, 4, 1) AS "cpc_subclass"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."cpc") c
LIMIT 1000;
Results:
cpc_section,cpc_class,cpc_subclass
F,02,D
G,01,V
C,08,K
E,03,D
B,30,B
B,21,K
B,61,D
B,27,N
C,02,F
D,04,D
H,01,F
A,47,G
B,21,B
C,12,R
B,62,H
G,01,D
C,12,G
F,23,B
B,42,C
B,21,L
B,31,D
E,05,Y
A,45,F
F,16,M
E,02,B
D,21,F
A,22,C
B,68,B
G,21,H
E,02,C
H,04,W
E,21,B
C,23,C
B,23,Q
E,05,B
F,23,G
C,12,M
D,06,M
E,05,F
F,23,Q
C,13,K
D,02,H
F,23,M
C,10,F
G,21,J
G,01,R
D,04,B
B,63,H
F,15,B
F,24,D
H,04,B
G,10,L
B,60,H
C,10,M
B,43,M
D,06,P
B,27,L
F,42,D
B,64,B
B,23,K
B,65,D
A,61,G
A,24,B
C,22,B
A,41,B
H,03,J
C,09,G
H,03,C
F,41,A
F,03,G
A,47,K
B,25,D
C,06,F
F,02,K
A,42,C
B,41,B
F,41,J
B,41,G
H,02,G
A,61,Q
B,29,K
G,10,H
B,81,C
A,22,B
B,64,G
H,05,F
C,05,F
B,41,D
A,61,K
B,03,B
C,01,P
B,60,Y
B,43,L
C,09,H
B,33,Y
G,21,B
C,13,B
G,10,G
B,60,W
D,03,D
F,01,L
B,28,B
F,41,F
A,41,D
G,03,D
Y,10,T
G,01,N
A,63,C
B,63,C
F,04,D
B,25,C
H,03,M
D,01,F
G,05,D
C,12,F
A,24,F
C,06,B
A,47,J
G,01,M
B,22,F
B,22,D
G,01,H
F,03,D
E,04,F
A,21,B
B,09,C
B,04,C
H,03,B
C,07,G
Y,02,T
C,11,B
B,62,B
D,07,B
C,05,D
H,03,D
E,03,C
A,63,D
G,12,B
C,06,C
B,60,V
H,01,L
H,03,G
F,23,J
H,04,J
H,10,N
C,10,J
B,05,C
B,41,N
B,68,F
F,21,L
F,21,Y
F,21,V
D,06,L
G,01,F
A,01,K
B,07,C
D,05,B
B,62,L
B,24,D
B,67,B
G,08,B
B,21,C
C,05,G
F,16,P
A,23,Y
E,04,G
A,62,B
A,46,B
B,41,P
B,07,B
B,66,B
F,01,P
C,08,B
F,02,G
E,03,F
C,30,B
F,41,C
B,27,K
B,26,F
G,06,F
A,45,B
C,09,C
B,22,C
B,23,C
F,22,D
A,01,L
G,10,B
H,04,T
A,61,F
B,24,B
B,60,B
A,47,F
D,06,H
B,61,B
A,41,G
A,62,D
G,10,F
C,12,Q
G,01,C
D,04,H
E,05,C
B,31,B
H,02,P
D,21,B
B,01,F
A,61,C
C,05,B
B,27,F
A,01,H
C,12,P
H,02,K
C,12,N
B,60,K
F,16,L
A,23,K
G,04,B
C,11,C
F,01,B
B,05,B
A,01,P
B,28,C
G,16,C
C,09,D
A,23,N
G,05,F
A,61,L
F,16,K
A,43,B
B,29,L
D,06,B
B,27,D
B,31,F
C,06,D
A,61,M
A,61,P
B,67,D
F,04,C
G,04,G
F,16,F
A,42,B
G,07,D
F,23,N
A,01,J
F,16,H
A,01,B
G,01,J
G,21,D
F,02,N
E,01,F
C,05,C
B,05,D
G,05,G
C,22,C
G,06,M
Y,02,B
Y,02,P
D,10,B
B,65,C
C,21,C
B,60,T
C,25,B
D,01,D
B,25,H
C,01,F
A,46,D
F,24,B
D,03,C
C,12,H
G,03,F
Y,02,A
B,26,D
F,21,S
B,42,B
B,61,C
G,10,C
C,11,D
F,26,B
E,02,D
C,08,L
E,06,B
E,06,C
B,21,J
B,60,D
G,04,R
G,21,Y
C,12,L
Y,02,E
H,05,K
A,47,H
C,09,F
B,23,P
B,44,C
G,08,C
B,60,Q
B,44,B
F,16,N
D,05,C
C,12,J
B,25,F
F,25,J
F,28,B
C,23,D
B,01,D
C,25,D
G,05,B
B,64,C
E,05,D
G,16,Z
G,02,C
A,23,P
F,23,L
B,65,G
F,28,G
B,66,F
F,04,F
H,03,H
B,09,B
A,47,D
G,21,F
B,43,K
Z,03,R
B,60,L
H,02,H
B,65,B
G,06,Q
F,25,B
G,09,B
D,21,D
F,02,F
D,21,J
A,44,D
A,47,C
A,21,D
F,24,H
B,60,M
F,15,C
G,16,Y
A,63,J
C,10,H
A,61,B
B,41,J
B,60,N
H,01,R
H,04,Q
G,03,G
D,02,G
F,04,B
F,21,W
B,42,D
A,43,D
B,28,D
B,27,M
F,24,S
F,17,B
B,25,J
C,23,F
G,02,B
G,01,P
H,02,N
C,25,C
B,82,Y
C,07,F
A,41,F
F,24,V
G,11,C
H,03,K
A,01,N
F,41,H
G,16,B
B,27,G
B,62,K
H,05,H
B,27,B
F,01,C
F,22,G
B,41,C
C,07,C
B,64,D
B,62,M
A,23,C
B,29,B
B,66,C
D,21,C
F,27,D
D,01,B
G,01,W
C,10,C
G,04,D
A,63,K
H,01,S
H,01,C
G,21,C
A,45,C
B,03,C
G,07,B
A,24,D
E,01,C
B,65,F
H,01,B
F,24,T
H,01,T
A,41,H
B,61,G
A,44,C
B,23,F
D,05,D
E,04,B
F,42,B
F,16,D
F,28,D
D,01,H
B,60,G
C,23,G
B,21,F
H,01,Q
E,02,F
F,05,D
F,23,K
F,16,C
D,06,G
A,23,F
G,06,J
G,06,V
G,07,F
G,03,H
A,23,L
G,06,N
F,16,B
C,07,B
C,04,B
B,04,B
G,06,C
F,16,S
H,10,B
B,08,B
C,07,H
B,01,J
G,07,C
A,23,J
D,06,Q
F,21,K
A,23,D
G,06,G
B,21,D
B,41,M
Y,02,D
C,03,C
H,02,J
B,60,P
H,01,H
A,21,C
H,02,S
C,01,C
C,10,K
C,40,B
F,03,C
G,06,E
B,27,C
F,16,J
C,21,D
G,01,B
C,10,G
B,26,B
A,63,G
B,63,J
D,06,C
C,01,D
D,02,J
F,27,M
F,23,R
E,01,B
B,44,F
A,63,B
B,60,R
F,41,B
F,17,D
G,21,G
H,03,F
B,31,C
F,27,B
F,01,M
A,47,B
B,32,B
B,62,D
H,04,M
A,61,N
C,03,B
F,02,B
C,09,B
B,02,C
B,61,L
A,41,C
G,04,F
D,01,G
F,21,H
B,62,C
G,06,D
G,03,B
H,04,R
B,63,B
F,02,P
F,41,G
C,07,J
B,64,F
G,07,G
B,66,D
B,03,D
A,61,H
G,11,B
A,62,C
F,01,D
F,01,N
B,68,C
H,01,P
H,02,B
E,04,C
C,25,F
G,01,K
F,16,T
B,60,F
G,09,C
B,61,J
Y,10,S
C,10,L
C,08,C
C,21,B
A,01,D
B,81,B
D,03,J
B,23,H
H,05,G
A,45,D
B,82,B
C,09,K
F,23,D
E,04,H
G,01,G
D,04,C
B,44,D
A,16,B
F,25,C
H,04,H
A,44,B
C,08,F
Y,02,W
A,01,G
F,23,H
H,04,K
E,21,C
B,25,G
D,04,G
G,09,D
H,04,L
G,09,G
C,08,J
H,10,K
H,05,B
C,01,G
F,05,B
A,23,G
G,10,D
F,16,G
G,02,F
C,07,K
G,10,K
A,23,V
F,24,F
B,06,B
A,01,M
B,23,D
D,06,N
C,14,C
A,43,C
B,02,B
B,27,J
B,21,H
G,09,F
F,28,F
F,03,B
B,24,C
F,17,C
B,27,H
B,42,F
F,05,C
H,01,K
G,04,C
B,67,C
A,01,F
B,41,L
B,41,K
B,01,B
B,41,F
G,06,T
D,21,H
A,23,B
B,29,D
E,04,D
F,23,C
F,28,C
A,63,F
G,16,H
B,65,H
G,01,S
F,02,M
B,25,B
B,60,S
C,22,F
E,21,F
A,61,D
F,42,C
H,05,C
Y,02,C
C,09,J
F,02,C
A,24,C
H,04,S
G,01,Q
B,68,G
E,05,G
B,01,L
F,01,K
B,61,H
G,01,L
A,01,C
D,06,F
C,10,B
C,12,C
H,02,M
D,01,C
B,21,G
C,01,B
C,10,N
B,64,U
G,01,T
C,14,B
F,24,J
B,23,G
G,03,C
H,01,M
F,24,C
E,01,D
B,61,K
C,08,H
F,25,D
H,04,N
B,29,C
C,08,G
H,01,J
C,07,D
Y,04,S
H,03,L
A,63,H
D,06,J
B,60,J
B,62,J
A,47,L
B,23,B
F,22,B
G,21,K
D,21,G
B,42,P
C,12,B
G,06,K
G,08,G
B,60,C
H,01,G
A,61,J
B,63,G
F,15,D
E,21,D
E,03,B
B,61,F
C,12,Y
E,01,H
F,03,H

2025-01-16 07:12:56 - root - INFO - itercount: 0
2025-01-16 07:12:56 - root - INFO - Database Name: PATENTS
Schema Name: PATENTS
DDL describes table information.
,0
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,1
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""spif_publication_number"" VARCHAR(16777216),
	""spif_application_number"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""claims_localized_html"" VARIANT,
	""description_localized"" VARIANT,
	""description_localized_html"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""locarno"" VARIANT,
	""citation"" VARIANT,
	""parent"" VARIANT,
	""child"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,2
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
**Columns and Potential Usage:**

- **Table:** `PUBLICATIONS`
  - **"cpc"**: Used to identify patents in class `A01B3` by matching CPC codes.
  - **"assignee_harmonized"**: Contains assignee information; used to extract assignee names.
  - **"application_number"**: Used to count the total number of applications per assignee.
  - **"filing_date"**: Used to determine the year of each application.
  - **"country_code"**: Used to identify the country with the most applications.

**Conditions that May Be Used:**

- Filter records where the CPC code matches `A01B3%`.
- Extract the year from the `filing_date` column.
- Group data by assignee and year to find the year with the most applications.
- Count the number of applications per assignee.
- Identify the country code with the most applications in the peak year.

---

**SQL Queries to Explore the Data:**

1. **Retrieve distinct CPC codes to understand their format:**
   ```sql
   SELECT DISTINCT c.value::VARIANT:"code"::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c
   LIMIT 1000;
   ```

2. **Get a list of unique assignee names:**
   ```sql
   SELECT DISTINCT a.value::VARIANT:"name"::STRING AS "assignee_name"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a
   LIMIT 1000;
   ```

3. **View sample filing dates to understand the date format:**
   ```sql
   SELECT DISTINCT t."filing_date"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   WHERE t."filing_date" IS NOT NULL
   LIMIT 1000;
   ```

4. **Extract years from the filing dates:**
   ```sql
   SELECT DISTINCT TO_CHAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   WHERE TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
   LIMIT 1000;
   ```

5. **List all country codes present in the data:**
   ```sql
   SELECT DISTINCT t."country_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 1000;
   ```

6. **Find applications associated with CPC code starting with 'A01B3':**
   ```sql
   SELECT t."application_number", c.value::VARIANT:"code"::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c
   WHERE c.value::VARIANT:"code"::STRING LIKE 'A01B3%'
   LIMIT 1000;
   ```

7. **Retrieve assignee names for applications in class 'A01B3':**
   ```sql
   SELECT DISTINCT a.value::VARIANT:"name"::STRING AS "assignee_name"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a,
   LATERAL FLATTEN(input => t."cpc") c
   WHERE c.value::VARIANT:"code"::STRING LIKE 'A01B3%'
   LIMIT 1000;
   ```

8. **Get filing years for applications in class 'A01B3':**
   ```sql
   SELECT DISTINCT TO_CHAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c
   WHERE TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
     AND c.value::VARIANT:"code"::STRING LIKE 'A01B3%'
   LIMIT 1000;
   ```

9. **List country codes for applications in class 'A01B3':**
   ```sql
   SELECT DISTINCT t."country_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c
   WHERE c.value::VARIANT:"code"::STRING LIKE 'A01B3%'
   LIMIT 1000;
   ```

10. **Retrieve assignee names along with country codes:**
    ```sql
    SELECT DISTINCT a.value::VARIANT:"name"::STRING AS "assignee_name",
                    a.value::VARIANT:"country_code"::STRING AS "assignee_country_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a
    LIMIT 1000;
    ```

11. **Count the number of applications per assignee (sample data):**
    ```sql
    SELECT a.value::VARIANT:"name"::STRING AS "assignee_name",
           COUNT(DISTINCT t."application_number") AS "application_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a
    GROUP BY a.value::VARIANT:"name"::STRING
    ORDER BY "application_count" DESC
    LIMIT 1000;
    ```

12. **Extract application numbers and their corresponding filing years:**
    ```sql
    SELECT t."application_number",
           TO_CHAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    WHERE TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    LIMIT 1000;
    ```

13. **Retrieve country codes associated with assignees:**
    ```sql
    SELECT DISTINCT a.value::VARIANT:"country_code"::STRING AS "assignee_country_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a
    LIMIT 1000;
    ```

14. **Get publication numbers for applications in class 'A01B3':**
    ```sql
    SELECT t."publication_number", c.value::VARIANT:"code"::STRING AS "cpc_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") c
    WHERE c.value::VARIANT:"code"::STRING LIKE 'A01B3%'
    LIMIT 1000;
    ```

15. **Identify the different kinds of CPC codes assigned to applications:**
    ```sql
    SELECT DISTINCT c.value::VARIANT:"section"::STRING AS "cpc_section",
                    c.value::VARIANT:"class"::STRING AS "cpc_class",
                    c.value::VARIANT:"subclass"::STRING AS "cpc_subclass"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") c
    LIMIT 1000;
    ```

These queries help in understanding the structure and content of the relevant columns, which is essential for formulating a comprehensive SQL query to address the original task.Query:
SELECT DISTINCT c.value::VARIANT:"code"::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c
   LIMIT 1000;
Answer:
Too long, hard cut:
cpc_code
F21Y2115/10
H01L2224/05686
G05D2201/0213
Y02B20/40
H01L2224/05624
H01M50/42
A63J5/02
B60L2200/12
G01R19/155
H04W16/14
G02B6/3826
H01L51/0097
H01B7/0009
B01D2255/50
C04B2235/3275
C01P2004/64
B01J20/261
G06F3/0484
F05D2260/213
G06Q30/0185
H02J3/01
A61N1/37288
H01S3/1643
G06F11/3457
B01L3/502761
F05D2220/32
G06Q20/0855
H01S3/17
Y10T29/49826
G06F17/17
A45C13/1046
A61B6/504
B41M5/0047
G10L2021/0135
F16H2045/0284
G06T5/002
G06F9/505
Y02W10/10
F28F9/026
H04M1/0264
C07D471/04
G06F11/1451
E04B1/2403
G09G2230/00
H04W72/23
G06F16/9024
B25F5/02
G06Q20/3278
H04M2250/52
A41D1/22
A61J1/18
G06F9/30003
G06F17/3002
H04B17/15
B29C64/255
B25J9/126
A63F13/424
F16C1/16
H01L23/34
G06Q30/02
G06F2201/885
B64D13/08
F16N21/02
C08L1/08
H04N19/127
G06F16/3329
B60K17/02
H01L27/3246
G01S17/325
G02B21/04
C08G2261/3221
C25D7/123
H02H9/02
G09F2013/05
A61K2800/30
H04L63/145
G09G5/02
H02J3/38
A23C11/103
B29C33/12
A61K31/202
G11C16/349
B60K2360/122
B60K2360/741
C12N15/62
G06V20/597
A61M1/16
D04H13/006
C07C319/14
G01F1/68
C07D213/38
E02D5/56
Y02P20/10
Y10S424/10
B01D67/00
A21D2/364
H01R13/2421
C10B57/04
A61B5/7275
C22C38/002
A47J36/321
F16L11/12
Y02B30/00
B60T11/236
H01H50/54
G06K7/10009
F16B13/063
H01Q1/244
F21V17/002
A61L2202/25
H04L47/803
A01B79/005
G06T7/50
B01J35/615
C04B2235/3203
F05D2240/121
C12Q2600/154
H01M8/04388
A61B6/5205
G06F16/26
H04L9/0863
G06V10/7715
G01N2223/424
F03D1/0683
H04L2209/046
H04L65/70
C12N2310/3341
Y10T156/1326
F16H21/44
D01F11/14
A01C17/00
A01N43/90
C11D3/18
G01S7/2922
B29L2009/001
C12Q2533/101
B26F1/16
F25D17/045
C02F1/40
B61L3/125
Y10T74/1832
B42B5/08
B32B17/10981
B01J2531/847
B01J27/0576
C10M2219/046
C02F1/30
C09B67/0033
H05K3/185
G06Q20/38215
B32B2262/14
H02P29/40
G07C9/28
A61K8/39
B60K7/0015
F04B9/117
D01G15/64
A61K31/737
Y10T428/2958
Y10T24/3991
C07D277/66
H04L2001/0098
C10G27/04
A61H2230/42
A61F13/53717
B01D17/0217
A61F2007/0098
C09K21/12
A61M1/36224
C10B45/00
F21V29/87
A01K2227/101
F23K5/08
C12Y108/01009
E04H15/50
A01K67/027
D21C5/005
C02F2305/023
A61B2017/22035
A47L9/2889
F04D29/325
F16B43/00
F25J1/004
C30B23/02
F25J3/0223
C23C16/45561
A61K9/2873
G04C11/00
B22D15/02
C07D311/16
B29C33/36
Y10S428/92
C09D5/18
H04L1/0066
A01K80/00
C04B41/5022
C10M2215/06
D06M13/123
G10L21/038
H01G4/30
B29K2995/0067
E01H2001/0881
Y02B30/70
B05C11/025
Y10T403/32877
C04B41/81
A61L15/26
H01S3/0675
B01J2229/18
A61K2039/5256
E05B13/002
C07K16/2827
A01M29/32
G06F12/1054
D04H1/66
Y10T407/235
B23K2103/04
A61K8/415
G01P15/123
E04H9/10
B21B45/0251
C10M2209/1085
A47J31/4403
G10H3/146
C08L2207/02
B01J19/088
F01N13/08
A61B5/6851
B29C2045/2813
H10B12/395
C07F9/572
G06K7/0008
B26F1/38
C12Y302/01021
F04D29/668
A61J3/07
A61B2017/00274
G06F1/3287
G01R35/005
F05D2270/09
H01S2301/18
F41H11/16
H04N23/663
G05B2219/50218
B01J8/00
A61B2017/320741
H01L24/96
B65D77/06
B41C2210/22
H02P6/15
A61B5/157
B01L2300/044
A47F3/0482
A61B6/481
G06T7/543
A61B5/4818
A61K31/05
G01N33/526
G06F3/1267
E05F15/70
B01J2231/4283
C04B24/2647
H01L2924/1423
A61K31/714
H01J47/02
G07F17/32
C12N9/88
G06Q20/3255
A63F13/55
H01L21/0274
G02B6/4249
C12Q1/686
H04N1/00716
E04H12/24
H04N1/00732
A61B2017/00336
C08G18/1825
B62D3/08
A61M2202/0208
B62D25/182
C07D307/84
C08G77/445
G03F7/70816
A45C11/04
Y10S707/99953
G06F11/2079
B01D46/2484
H01M4/043
G02B13/06
A61C2203/00
G09F21/0485
G01N2333/285
H01H85/32
F17C2203/0619
G09F21/04
E02D31/06
B29C2791/001
A63B53/007
H04N7/181
A61B17/72
A61N1/36053
G10K2210/1081
B05C11/06
A61F2240/001
A61N1/36014
A61B5/1128
H04N21/25
G06F16/212
C01D15/00
D04H1/5414
B60L50/61
A61C15/04
F16H48/24
H01L27/2463
A47F5/135
H02J7/1423
B01D15/22
H04N21/43079
H01L21/68771
G06V10/945
A61B5/6807
A61B17/8897
H01L29/0642
H04L1/004
A63B21/0442
A61M15/0021
A21B3/13
A61B8/4494
A61B8/445
C10N2210/02
F01D5/26
A01K5/0233
F02C5/00
C09J105/06
A63B2220/52
G05D1/0257
D04H1/645
G01N2035/00425
G05B2219/36077
C07F9/11
C09K3/149
B60R21/16
H01S3/10
G10L21/02
H01L23/5387
F21V33/0068
A01K5/0291
G11B7/263
A23L21/25
A44C5/105
G01N27/623
D06F2105/48
F25B15/00
F04D1/06
B29D11/00317
A01N63/28
C01B17/901
B41P2700/10
B65D2571/0066
G01K17/14
C10G47/00
H02J13/00
Y10T137/87016
F02M2700/4311
A61P9/14
B01D11/0276
H01L21/2255
C08F8/46
E04C2003/0452
A43B3/02
B60T13/58
B21J7/46
A47B2210/0059
H05K2201/0355
G11B7/00736
B66C13/48
F24C7/08
H04N21/6582
H01L21/28587
B60G11/15
C09K19/10
G01F23/36
B65H2301/512125
H04N21/4349
H04L12/413
A63B37/0092
F16L1/19
G02B7/181
H04B7/10
C07C67/39
H04W12/71
A61B5/6889
B01D2253/202
F16L1/203
G01S5/0036
H04N21/4408
C08F291/00
G06F16/3344
H04W88/184
B01J20/14
C12M21/16
C07K5/06026
C23C28/3215
H04L1/1874
C09D175/06
B29D99/005
F03D7/047
B62D13/06
H04L2209/12
G01N21/958
C07K16/468
C04B37/026
B65H45/18
E03B3/04
H10B41/49
C08J2300/14
B01L2200/142
A61L27/48
A61N1/3925
B01J2208/00221
A01K15/026
H04N9/643
C01B3/382
A61K2035/124
A61F13/0253
B41J2202/11
F02M35/024
C08J2201/026
B60H1/004
B60H1/00899
H04M2203/553
G03G15/0822
A61K31/606
H01S5/18305
H01L2224/0231
F25J1/0057
F16L2201/40
B01J31/1616
B60N2/24
F16L55/124
G01B11/25
H02H7/0844
A43C19/00
H10B12/02
G08G1/096725
H01R4/00
F03C1/0671
Query:
SELECT DISTINCT a.value::VARIANT:"name"::STRING AS "assignee_name"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a
   LIMIT 1000;
Answer:
Too long, hard cut:
assignee_name
PREC BIOSCIENCES INC
STANLEY WORKS LTD
CAMURUS AB
WWT SPOLKA Z OGRANICZONA ODPOWIEDZIALNOSCIA
EISEN EIKO
WISTRON NEWEB CORP
UST INC
UNIV ANGERS
CHUNG CHI Y
ZHU MIN
SUMNER MICHAEL
BERNARD MARC R
HRA PHARMA LAB
GANZHOU HEMAY PHARMACEUTICAL CO
SURROZEN OPERATING INC
KIMBERLY CLARK CO
VIGIL NEUROSCIENCE INC
ROCKWOOL INT
AERTEL MANFRED
KOEHLER UTA
DANFOSS AS
GORE W L & ASS CO LTD
KIM DEOK JUNG
ITELCO S P A
BONGIOLO PAOLO
FARNWORTH WARREN M
CHIANG CHING-LIANG
LEE GUEE-SANG
BREMER CHRIS
SHIM YEON-AH
SUMITOMO METAL MINING CO
TAIWAN SEMICONDUCTOR MFG
HEWLETT PACKARD DEVELOPMENT CO LP
FWP IP APS
XU YINGQI
PANASONIC ECO SYS GUANGDONG CO
ZHANG HUANHUAN
INFOSEIZE SYSTEMS CO LTD
NIKE INC
INAGAKI NOBUAKI
TAMURA SHUICHI
ELITE FUELS LLC
SERVIER LAB
SMART HUB PTE LTD
TRIANGLE TYRE CO LTD
HOBOT TECH INC
VASSEUR JEAN-PHILIPPE
OILUND LESTER D
FINE HOWARD A
TUTTLE G TYSON
KOESTER DAVID A
CHRISTL WERNER
OPOLSKI STEVEN W
JIANG MING
UNIV MASSACHUSETTS
ADVANCED BIONICS LLC
KOFLER KEVIN J
HOOVER LTD
MASSI OSVALDO MAXIMILIANO
ACE BEDS CO LTD
FEDELI GIANCARLO
XIAOYING ZHAO
RONGHUA SUN
ETA SRL
MAGNETI MARELLI SPA
ODED MIRETZKY
LORENZ BIOTECH SPA
GE HEALTHCARE AS
BIONOVO INC
FOMUKONG MUNDI
COVIDIEN AG
MO AVTOMOBILNYJ ZAVOD IM I A L
LE MASH
HAMMONDS CARL L
GTX INC
OMNISYSTEM CO LTD
AGCO DO BRASIL SOLUCOES AGRICOLAS LTDA
KOREA INST OCEAN SCI & TECH
MATHUR BHAVNA
VARTIAINEN PANU
KAN GEORGE L
SUN HAO
KOO YEON KWAN
MICROELECTRONICS TECH INC
ATOTECH DEUTSCHLAND GMBH
MARTIN DOMINIC R
BRUKER BIOSPIN AG
SOROCO PRIVATE LTD
Turner Tackle LLC
WAGNER JOACHIM
TOOLTECH LLC
PIONEER TOHOKU CORP
SUBARU CORP
SONOS INC
NEC LAB AMERICA INC
KIOXIA CORP
TAMINCO N V
FLEXOPACK S A PLASTICS IND
JOHNSON & JOHNSON SURGICAL VISION INC
ETAT FINLANDAIS
ZIMMER GUENTHER
ATOMA INT INC
EXXON RESEARCH ENGINEERING CO
BREE JOAN MARY
TRUMPF PHOTONICS INC
COURTAULDS FILMS HOLDINGS
MONTALTI MIRKO
PROCOMAS S R L
CHR HANSEN AS
IND NATUZZI
I P A IND PLASTICA ADRIA DI CHENDI BRUNO &
ARDITI
KUMSUNG MEDICAL INSTR CO LTD
HOWELL THOMAS A
SHIM JAE J
MEGURO TAKESHI
ARNEY SHANE R
UBE MAT IND LTD
POORNACHANDRAN RAJESH
OOI TETSUYA
SCHUMACHER DONALD J
DECKARD CARL
TAPIA MARIO G
PEREGO ANDREA
KAWANA TAKAHIRO
KLAESSIG OSKAR PAUL
FIRM OF OTTO URBAN
GREAT WESTERN ELECTRO CHEMICAL CO
TRAYWAY MFG CO
FAVRE & CIE
HESTAN COMMERCIAL CORP
SHADECRAFT INC
NOVALEAD PHARMA INC
ARKRAY INC
MIYAGAWA TAKUMI
ST MICROELECTRONICS CROLLES 2 SAS
TECHNION RES & DEV FOUNDATION
VIAVI SOLUTIONS INC
KOYO MUSEN CORP
WANGSU SCIENCE & TECH CO LTD
GRABANGO CO
NICHIA CORP
HYUNDAI TRANSYS INC
BEHR GMBH & CO KG
UCHREZHDENIE ROSSIJSKOJ AKADEMII NAUK INST UPRAVLENIJA IM V A TRAPEZNIKOVA RAN
GO URAL SKIJ NI I P
BLAST LOUDSPEAKERS LTD
US ENERGY
ORTNER HEINRICH
PETROLINE WIRELINE SERVICES
MINEBA CO LTD
SIN SIST DE IMPLANTE NACIONAL LTDA
GOLDEN LADY SPA
ALMASSY STANISLAV
SWAMINATHAN GANESH
HORSCH LEEB APPLICATION SYSTEMS GMBH
RES & IND COOPERATION GROUP
KANG JI YEON
JUNG GI YUL
HAESHIN
KANTO ISHI PHARMA CO LTD
KONO NAOYUKI
SWEEN TY
DEVROE ERIC
AJINOMOTO KK
BETTS STEPHEN N
O M KENKYUSHO KK
NISSEI ELECTRIC
JOHNSON M D A
BIOTEKNIKA INTERNATIONAL
THORNEYCROFT JAMES BAIRD
ADIDAS SPORTSCHUHE
ANKARCRONA FREDRIK
HUGERSHOFF REINHARD
ASEA AB
SKODA ENTREPRISE NATIONALE ETS
CHARLES DEGOUD
UNIV GLASGOW
HOWARD THOMAS THORNTON
HOHNEN OIL
NIPPON PETROCHEMICALS CO LTD
GLORY KOGYO KK
TECHCYTE INC
KING SLIDE TECHNOLOGY CO LTD
TERAO NORIYUKI
UNIV TIANJIN TECHNOLOGY
AJAYAN PULICKEL M
HOWA MACHINERY LTD
RYU JINSOOK
COROT AUGUSTE
HOWARD JEROME W
AMERICAN SHEET & TIN PLATE
WARREN FASTENER CORP
OSTROVSKIY ALEKSANDR IONOVICH
AKKARAJU PREM
VERHOVNIK GLENN PAUL JOHANNES
HAO CHENXI
SCPTIME
EXTRAHOP NETWORKS INC
NIHON KOHDEN CORP
WAGNER RANDALL M
LINK CHARLES M II
INST NOGUCHI
JAWOROWSKI MARK R
MEW ROBERT J
MEDGEL CORP
NO 923 HOSPITAL JOINT LOGISTICS SUPPORT FORCE OF THE CHINESE PEOPLES LIBERATION ARMY
TONGHUA DEJI GINSENG PHARMACEUTICAL CO LTD
U PROTEC SHENZHEN TECH CO LTD
SHENZHEN RADIUM BRIGHT SCIENCE AND TECH CO LTD
JIANGSU EASTMAN HEAVY MACHINERY CO LTD
DONGGUAN YUYI AUTOMATION EQUIPMENT LTD COMPANY
TAICANG LIANGSHENG RUBBER CO LTD
GUANGODNG YIKANGSHENG ENVIRONMENTAL PROTECTION TECH CO LTD
SHENZHEN CHUANGYITONG TECH CO LTD
MAIHAI SUZHOU ENVIRONMENTAL PROTECTION TECH CO LTD
XINFENG COANDA ELECTRONIC CO LTD
LIANYUNGANG JINCHEN IND CO LTD
SIHONGXIN MACHINE CASTING CO LTD
SHANDONG HUANNENG DESIGN INST CO LTD
ZHAO JUNFENG
HEILONGJIANG HELIANG AGRICULTURE CO LTD
HANGZHOU BOSS ELECTRIC APPLIANCE CO LTD
LI HUI
BAODING RAKANG SAUSAGE CASING PROC LIMITED COMPANY
HUNAN SANY MEDIUM LIFTING MACHINERY CO LTD
CHANZHOU ZHENYOU ELECTRICAL APPLIANCE LTD COMPANY
JIANGSU HONGBANMA NEW MATERIAL TECH CO LTD
HUAIBEI ZHUOCHUANG TECH SERVICE CO LTD
WAKAMONO joint stock company
P P H POLMAR” DIONIZY SZCZERBA
WIRTGEN GMBH
SHANGHAI KOHLER ELECTRONICS
DAMAKA INC
USTAV MAKROMOLEKULARNI CHEMIE
CULLEN ALEXANDER LAMB
KODIAK NETWORKS INC
SIC MARKING GROUP
JANSSEN PHARMACEUTICALS INC
DUAL MECHANICS CO LTD
OH MIN YOUNG
CHARLES O SANDER
GLASS MURRAY L
STIFT ROBERT J
CHICAGO BY PR
Query:
SELECT DISTINCT t."filing_date"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   WHERE t."filing_date" IS NOT NULL
   LIMIT 1000;
Answer:
Too long, hard cut:
filing_date
20191106
20200203
20200522
19961122
20010716
19940307
19660908
20090709
19870302
19720621
19791227
19850726
20180430
20180829
19851014
19830303
20180827
19700605
19531130
19700720
19541229
19250406
19120425
19721106
19660112
19050605
19280730
19660103
19840106
19720801
19890110
19340616
19471029
19680102
19700916
19940620
19871127
19911205
19911015
19981130
20010426
20011001
20010724
20030527
20051207
20060403
20070105
20070620
20080303
20080902
20090909
20100909
20110401
20131008
20001006
20020329
20030926
20090619
20231214
20070608
19130811
20230608
19981016
20050314
20051226
20060914
20111220
20160801
20150327
20041104
20080815
20090206
20090506
20120918
20121102
20070611
20101117
19920617
19850729
19710821
19900917
20030822
20070404
20091016
20100621
20110127
20180313
20200611
19970206
20210207
20220122
20210516
20220914
20221122
20230530
20230719
19800923
20030827
19740220
20111129
20040901
20230824
19920909
19990511
20121002
19840704
20110513
20030730
20070905
20160709
20220201
20130819
20160323
20221128
20010402
19650930
19790306
19051023
19920117
19971014
19900123
19770325
19800418
19860314
19810413
19820817
20151231
19790330
19930726
20150520
20020807
20091106
20160502
19990812
20151127
20050124
19770421
19710719
19690321
19640720
19240221
19750110
19950606
19840111
19080227
19450709
19200624
19251211
19900118
19860122
19770216
19780404
19810515
19221125
19930331
19370405
19940225
20080818
19740725
20080426
19980611
19690103
19890401
20190610
20170125
20160411
19770914
19750922
19820911
19880802
19840822
19910726
19980729
20100225
20100922
20121220
19841005
20090213
19870514
19920106
20080116
19721003
19741213
19890812
19910722
19871204
19960507
20110201
20221023
20240311
19700504
19891127
19890817
19980423
20220306
19810116
20010417
20020927
20220204
19080707
20110214
20100907
19510202
19500627
19591124
19570321
19640203
19391103
19321010
19540907
20070102
19050322
19790329
19600603
19840117
19710203
19571230
19660329
19631011
19910226
20020330
20180706
20140810
19840210
20001216
19860707
20000311
19680918
19771014
19741111
19791217
19630730
19570622
19760112
19700523
20210627
19660723
20030107
19810206
19850903
20150515
19890227
19450414
19360518
19180827
19530623
19030801
18970621
19611220
19720107
19330505
19160821
19640113
19590629
19911008
19861114
19871208
19901002
19850517
19890801
19910926
20050911
20070726
20090824
20140708
20170923
19370507
19140608
19200520
19670419
19880423
20120507
19841211
20001007
19900804
20200525
20150419
19900820
19430412
19190821
19570704
19780324
19810918
20200125
19620712
19790714
19160408
19211015
19301004
19470604
19550419
19661220
19170811
19160517
19610825
19790115
19490620
19290305
19680108
19540329
19190121
19661207
19830329
19890616
19120302
19131010
19520703
19580117
19070323
19370421
19651108
19410524
19110526
19571119
19121009
19320831
19820809
19490715
19250921
19590820
19760405
19851022
19940805
19751106
19340914
19471212
19390223
19411006
19590224
19380831
19710907
19020912
19230310
19250112
19621212
19580507
19571206
19720119
19640320
19470408
19881101
19880425
19930827
19691219
19820505
19640709
19870214
19910829
19880919
20180617
19930109
19830625
19870608
19480911
19131021
19500925
19580520
19110209
19401108
19630312
19410227
19701110
19160724
19580107
19760325
20060729
20151106
20140626
20150921
20180529
20190716
20200225
20210322
19970521
20161230
19900419
19791126
19920827
19841109
19881004
19941129
20200430
20030430
20031217
20060523
20061110
20100924
19830902
19871016
20011022
20010507
20211215
20211217
20220414
20230131
20230829
20230919
20231016
20231031
20240108
20020708
19930525
20051122
20001222
19840523
19901204
19941014
19890511
20130222
19770610
20030415
19840215
20091102
20040122
20001009
20110708
19330902
19280807
19380725
19411222
19221010
19091102
19740930
19620620
19300916
20051115
19690618
18921230
19720606
19691216
19371029
19391013
19611130
19820126
19671003
20000906
19641221
19710419
19361205
19840911
20190228
20200605
20140606
20000202
19830131
20050701
19690723
20110530
19990618
19930924
19920408
19910920
19800908
20180227
20220714
19750703
20230929
20031110
20131031
19670318
19750705
20190207
20130118
20160617
20100309
20050711
20160324
20220404
20161012
20201120
20030621
19960719
19400111
20131205
19661025
20000216
20210901
20170427
20180817
20170921
19781009
19881109
19921021
20091218
19930629
20101224
20110407
20151002
20020709
20040405
19751014
19741126
19850912
19870929
20031212
20010615
20070907
20210120
19960423
19781028
19801022
20021119
20010828
19850429
19750331
20110218
20110927
20070504
20160602
20060925
19820701
19741211
19760316
19860403
19650326
19630225
20020125
19910508
19580128
19321125
19530814
19810306
19800208
19730213
19910225
19850228
19960717
19100411
19101028
19120902
19710401
19820325
19660927
19960710
19291212
19320311
19750822
19660105
19910218
19760513
19880309
19660624
19900316
19800522
19990318
19840420
20240510
19850702
20110309
20170822
20140731
20190227
20061013
20050819
19
Query:
SELECT DISTINCT TO_CHAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   WHERE TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
   LIMIT 1000;
Answer:
filing_year
1948
2006
1903
1937
1898
1922
1923
1886
1942
1908
1846
1881
2015
2016
2018
1983
1978
2007
1974
1961
1913
2024
1924
2010
1926
1988
1976
1901
1955
1998
2009
1933
1950
1927
1904
2019
2023
1899
1931
2017
1935
1996
1938
1953
2021
1968
1949
1887
2005
1945
2003
1956
1940
1928
1967
1939
1972
1960
1911
1895
1987
1910
1994
1985
1993
1986
1890
2004
1989
2011
1915
1946
1995
1912
1930
2000
2012
1885
1905
1907
2020
2002
1934
1925
1917
1916
1997
1880
1963
2014
1952
1920
2022
1984
1990
1958
1853
1966
1877
1973
1954
1883
1962
1918
1897
1991
1921
1914
1981
1999
1980
1979
1892
1970
1941
1971
1943
1896
1860
1964
1900
1906
1947
1929
1969
1909
1957
2001
1894
1932
1882
1867
1944
1992
2013
1951
1889
1975
1959
1919
1893
1902
1965
1982
1891
2008
1977
1888
1936
Query:
SELECT DISTINCT t."country_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 1000;
Answer:
country_code
DO
BA
RS
WO
CR
PL
EP
ZA
MY
CS
LV
HR
AU
CU
RO
KR
PT
NZ
CL
NO
HU
JP
DZ
NL
LT
UA
MW
IT
OA
CY
CZ
HN
SV
CH
TR
BG
AT
YU
ZM
MD
ZW
MA
GB
SG
EG
PA
CO
SI
AR
KE
FI
DK
CA
SK
IS
NI
US
PH
DE
DD
MX
EE
GE
HK
TN
GT
BR
ID
LU
GR
RU
JO
IN
EC
SA
MN
SU
FR
PE
KZ
IL
TW
MT
BE
SE
AP
SM
ME
EA
ES
IE
CN
MC
Query:
SELECT t."application_number", c.value::VARIANT:"code"::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c
   WHERE c.value::VARIANT:"code"::STRING LIKE 'A01B3%'
   LIMIT 1000;
Answer:
Too long, hard cut:
application_number,cpc_code
DE-102010019819-A,A01B3/464
US-1913771943-A,A01B3/10
KR-20060032729-A,A01B33/146
KR-20060032729-A,A01B33/06
DE-L0044155-U,A01B33/08
DE-L0044155-U,A01B33/10
DE-L0044155-U,A01B33/00
US-202217990129-A,A01B35/08
US-202217990129-A,A01B35/08
US-202217990129-A,A01B35/08
FR-7531218-A,A01B33/024
FR-7531218-A,A01B33/08
FR-7531218-A,A01B33/021
FR-7531218-A,A01B33/08
FR-7531218-A,A01B33/021
FR-7531218-A,A01B33/024
CA-2543900-A,A01B33/103
CA-2543900-A,A01B33/103
GB-585551-A,A01B35/06
IL-26862419-A,A01B3/24
IL-26862419-A,A01B3/24
US-72598847-A,A01B39/00
US-72598847-A,A01B39/00
US-72598847-A,A01B35/26
US-72598847-A,A01B35/26
KR-19960029894-A,A01B35/28
KR-19960029894-A,A01B35/18
FR-0901549-A,A01B39/163
KR-19970019112-U,A01B35/28
KR-20120005914-A,A01B35/10
KR-20150076822-A,A01B3/36
US-1904197554-A,A01B3/26
US-6966360-A,A01B39/085
US-6966360-A,A01B39/085
US-530054D-A,A01B39/14
US-25445318-A,A01B3/50
US-25445318-A,A01B3/50
CN-201680067381-A,A01B33/16
CN-201680067381-A,A01B33/16
CN-201680067381-A,A01B35/32
US-1912673206-A,A01B35/06
US-376176D-A,A01B3/26
GB-616956-A,A01B3/36
US-3784693-A,A01B31/00
US-3784693-A,A01B31/00
US-159642D-A,A01B35/08
US-395573D-A,A01B35/26
KR-20040020796-A,A01B3/50
JP-2104782-U,A01B33/028
JP-2017239983-A,A01B33/028
JP-2017239983-A,A01B33/024
KR-20010007666-A,A01B39/18
CN-202210606325-A,A01B35/16
CN-202210606325-A,A01B35/28
NO-822521-A,A01B35/00
CN-201280056680-A,A01B33/14
KR-20000009753-U,A01B35/10
US-130700D-A,A01B35/08
FR-960102D-A,A01B33/087
FR-960102D-A,A01B33/082
US-77445391-A,A01B3/46
US-77445391-A,A01B3/46
US-231385D-A,A01B33/065
BE-727862D-A,A01B33/021
US-9826126-A,A01B35/24
US-9826126-A,A01B35/24
AT-720679-A,A01B33/106
NL-7909063-A,A01B33/103
US-469659D-A,A01B35/08
BE-154048-A,A01B33/106
BE-154048-A,A01B33/106
EP-17737210-A,A01B33/06
EP-17737210-A,A01B35/16
KR-20180002946-U,A01B39/18
US-201916456505-A,A01B39/18
US-1901066531-A,A01B3/08
CN-201811558564-A,A01B35/20
CN-201811558564-A,A01B35/26
DE-L0066972-D,A01B35/04
CA-2945250-A,A01B33/106
CA-2945250-A,A01B33/106
EP-19182149-A,A01B33/087
EP-19182149-A,A01B37/00
KR-870011914-A,A01B33/14
US-41054454-A,A01B33/06
US-1209525-A,A01B39/26
US-1209525-A,A01B39/26
CN-202210625064-A,A01B35/20
CN-202210625064-A,A01B35/26
NO-910950-A,A01B35/26
CA-3089518-A,A01B39/18
DE-8707829-U,A01B33/142
GB-8100746-A,A01B35/12
GB-8100746-A,A01B39/10
GB-8100746-A,A01B35/12
GB-8100746-A,A01B39/10
DE-W0001964-A,A01B3/32
CN-200410049370-A,A01B33/021
DE-102017102683-A,A01B35/18
KR-20120091374-A,A01B33/082
KR-20000011273-A,A01B33/00
CN-201510892651-A,A01B33/103
CN-201510892651-A,A01B33/024
CN-201810784089-A,A01B33/065
CN-201810784089-A,A01B33/082
CN-201810784089-A,A01B33/08
JP-2018177517-A,A01B39/18
JP-2018177517-A,A01B39/18
HU-E16197432-A,A01B35/24
KR-20130001424-U,A01B35/16
CN-201810758930-A,A01B33/12
CN-201810758930-A,A01B33/10
CN-202111095366-A,A01B33/08
CN-202111095366-A,A01B33/10
CN-201710053605-A,A01B39/18
NL-7514005-A,A01B33/065
NL-7514005-A,A01B33/065
CN-201580056876-A,A01B35/225
CN-201580056876-A,A01B35/225
CN-201580056876-A,A01B35/225
CN-201710322359-A,A01B33/08
CN-201710322359-A,A01B33/144
CN-202110938555-A,A01B39/16
CN-202110938555-A,A01B39/26
CN-202110938555-A,A01B39/20
KR-20050007441-U,A01B3/28
RU-2019118172-U,A01B35/20
US-50994255-A,A01B39/14
US-50994255-A,A01B39/14
US-52103631-A,A01B3/50
US-52103631-A,A01B3/50
US-501724D-A,A01B3/464
US-20046750-A,A01B35/14
US-20046750-A,A01B35/14
US-5637735-A,A01B39/19
US-5637735-A,A01B39/19
AU-7115874-A,A01B35/26
GB-1095134-A,A01B35/16
GB-1095134-A,A01B33/021
US-68923896-A,A01B35/04
US-68923896-A,A01B35/04
KR-20110130418-A,A01B39/18
DE-140654D-A,A01B3/12
AU-2002301383-A,A01B35/225
AU-2002301383-A,A01B35/225
GB-202013028-A,A01B39/06
GB-202013028-A,A01B39/18
GB-202013028-A,A01B39/18
CN-201710636376-A,A01B35/22
CN-201710636376-A,A01B35/04
IT-2128483-A,A01B33/146
IT-2128483-A,A01B33/106
IT-2128483-A,A01B33/065
IT-2128483-A,A01B33/065
IT-2128483-A,A01B33/106
IT-2128483-A,A01B33/146
US-964648-A,A01B33/025
US-964648-A,A01B33/025
CA-163445-A,A01B3/74
PL-44042622-A,A01B33/00
PL-44042622-A,A01B33/021
PL-44042622-A,A01B33/02
PL-44042622-A,A01B33/04
BE-9300543-A,A01B39/16
BE-9300543-A,A01B39/26
US-290366D-A,A01B35/22
US-51933174-A,A01B35/18
US-51933174-A,A01B39/14
US-51933174-A,A01B39/14
US-51933174-A,A01B35/18
US-71336434-A,A01B33/06
US-71336434-A,A01B33/06
CN-202310902847-A,A01B39/085
CN-202310902847-A,A01B39/22
CN-202310902847-A,A01B39/20
GB-7939943-A,A01B33/106
KR-20000035371-A,A01B35/22
CN-202210179147-A,A01B39/22
CN-202210179147-A,A01B39/18
CN-202210179147-A,A01B39/085
IT-1906685-A,A01B33/065
IT-1906685-A,A01B33/106
US-220177D-A,A01B35/18
US-5528360-A,A01B35/12
US-5528360-A,A01B35/12
FR-508965D-A,A01B3/30
FR-508965D-A,A01B3/18
US-38733520-A,A01B3/54
US-38733520-A,A01B3/54
BE-192096-A,A01B33/065
BE-192096-A,A01B33/16
BE-192096-A,A01B33/12
US-77255596-A,A01B37/00
US-77255596-A,A01B37/00
KR-20180111810-A,A01B33/082
KR-20180111810-A,A01B33/082
KR-20200156448-A,A01B33/14
KR-20200156448-A,A01B35/28
KR-2020015644
Query:
SELECT DISTINCT a.value::VARIANT:"name"::STRING AS "assignee_name"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a,
   LATERAL FLATTEN(input => t."cpc") c
   WHERE c.value::VARIANT:"code"::STRING LIKE 'A01B3%'
   LIMIT 1000;
Answer:
assignee_name
LEMKEN GMBH & CO KG
BOTVID SETTERGREN ANDERS GOSTA
JIM ALEX SMITH
KUHN SA
TRECKER FRANCIS J
PREC PLANTING LLC
GEORGE A KELLY PLOW COMPANY
GUERBET FRANCOIS
ARWAC LTD
NIEMEYER SOEHNE STAHL PFLUG
DAEHO FARMING MACHINERY CO LTD
QUINSTAR CORP
LG ELECTRONICS INC
NEW ZEALAND INVENTIONS DEV
GERBER HUBERT
WANG XUEDONG
GERBER MAURICE
GLASIER HAROLD H
SHEPPARD RICHARD H
RICHARD CO
ARTHUR BROOKS SPURR
LEINFELDER DIPL-LANDW HERMANN
KORSMEYER ERNEST H
CAMPBELL CLARENCE L
CHOATE STOREY NORMAN
AMAZONEN WERKE DREYER H
UNIV JIANGSU
SJOEHOLMS MEKANISKA AB
ELEOS ROBOTICS INC
WALLNER KLAUS
WILLIAM HENRY HONY FROST
ZHANG LIJIN
SIGFRID ANDERSON ANDERS
EDWARDS JOHN W
EDMOND HEE
UNIV HEILONGJIANG SCI & TECH
HUBER FRANZ FERDINAND
LIM HEON HO
HOLGER LETH
CHONGQING TIANJI IND CO LTD
MARTIN DOMINIC R
AUGUST SETTERGREN OTTO GORAN
MARTIN CHARLES H
FISHER VAN E
KUBOTA KK
CHRISTOPHER H R WOODWARD
Liu Yueshang
SAPHIR MASCHB GMBH
CNH IND AMERICA LLC
LEIJENAAR SYTZE
WALTER ROWAN JAMES
UNIV CHUNG ANG IND
KIM JAE KEUN
CHO SUNG GU
CHRISTEN ARNE JENSEN
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC
WILLIAM DREFKE
KIM BYUNG SUB
TEXAS INDUSTRIES INC
SOUTHERN PLOW COMPANY
AMAZONEN-WERKE H DREYER GMBH & CO KG
HARRELL DANNY H
RUDOLPH HASSON PAUL
MCKAY RALPH LTD
CHONGQING YUBAO AGRICULTURE EXPL CO LTD
LELY NV C VAN DER
DEERE & CO
DAIYO TANGO CO LTD
SAMSUNG KWANGJU ELECTRONICS CO
BULLS CO LTD
INT HARVESTER GREAT BRITAIN
HUBEI SHUANGYU MACHINERY TECH CO LTD
TWOSE OF TIVERTON LTD
PATENT CONCERN NV
UNIV TONGJI
OTULAK PRZEMYSLAW PRO CNC
SALGE HENRY F
KIM JONG JIN
EMPR IMPORT EXPORT Y DISTRIB P
CARLUCCI JAMES J
AGSOILWORKS TECH COMPANY LLC
ALLEN SAMUEL L
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD
UNIV SYDNEY
BETEK GMBH & CO KG
SAMSUNG SDI CO LTD
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY
Query:
SELECT DISTINCT TO_CHAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c
   WHERE TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
     AND c.value::VARIANT:"code"::STRING LIKE 'A01B3%'
   LIMIT 1000;
Answer:
filing_year
2009
1950
1987
2012
2000
1996
1960
2006
1913
1974
1926
2010
1976
1901
1955
1948
1978
1983
1925
2020
2002
1934
1975
1993
1985
2016
2018
2015
1991
1904
2019
1931
2023
1920
2021
2001
1918
2004
2011
2017
1935
2005
1951
2013
1979
1980
1981
1997
1982
1912
2022
1947
1969
1954
1973
1967
1956
Query:
SELECT DISTINCT t."country_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c
   WHERE c.value::VARIANT:"code"::STRING LIKE 'A01B3%'
   LIMIT 1000;
Answer:
country_code
HU
JP
AU
BE
NL
CA
US
DE
AT
KR
IL
RU
PL
IT
GB
ZA
EP
NO
FR
CN
Query:
SELECT DISTINCT a.value::VARIANT:"name"::STRING AS "assignee_name",
                    a.value::VARIANT:"country_code"::STRING AS "assignee_country_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a
    LIMIT 1000;
Answer:
Too long, hard cut:
assignee_name,assignee_country_code
ST MICROELECTRONICS ROUSSET,FR
NICHIA CORP,JP
GEN ELECTRIC,US
XILINX INC,US
WAVE POWER TECH INC,TW
AMO DEV LLC,US
HEFEI CAS LANRUI TECH CO LTD,CN
PANASONIC IP MAN CO LTD,JP
HILO INNOVATIONS LLC,US
SHENZHEN MINDRAY BIOMEDICAL ELECTRONICS CO LTD,CN
DISCOVERY COMMNUNICATIONS INC,US
INTEL CORP,
EMERSON VULCAN HOLDING LLC,US
LANDIS TIMOTHY J,
WAVETEC VISION SYSTEMS INC,
GELMAN GEOFFREY M,
JEON BAEK-KYUN,
SEO JOO-HONG,
RENESAS TECH CORP,JP
TRAN PETER P,
ENFORA INC,US
MEDTRONIC INC,US
DUAN XIN GAO,
IND TECH RES INST,TW
GEPPERT THEODORE R,
SAKAMOTO TAKUJI,
KONAMI CORP,JP
O'LEARY SHAWN,
WEST CORP,US
GENZYME CORP,US
LOPEZ-ULIBARRI RUAL,
LINDEN H B,
MASTERS DAVID B,
SMITH JONATHAN F,
COHEN TAL,
HAMANN LAWRENCE G,
HAND CHRISTOPHER W,
BREEDEN JAMES T,
TETRA LAVAL HOLDINGS & FINANCE,CH
MEGICA CORP,TW
KIRAZCI ULAS,
WU MICHAEL C L,
DOERR TIMOTHY E,
LUNDQUIST PAUL B,
GEITER DENIS,
HAMILTON MATTHEW CARL,
BAY INSULATION CONTRACTING INC,US
3D HOLDING COMPANY LLC,US
VELOXIS PHARMACEUTICALS INC,US
ST MICROELECTRONICS INT NV,NL
ADIR,
HITACHI METALS LTD,JP
COATEX SAS,FR
UNIV PARIS,FR
KINZEL OLAF,
WARD JOHN L,
COMMSCOPE TECHNOLOGIES LLC,US
THOMAS CREATIVE GROUP PRODUCTIONS LLC,US
UNIV OXFORD INNOVATION LTD,GB
CUREAPP INC,JP
W K KELLOGG FOUNDATION,
FRIEDRICH BECKE,
NASH WALTER C,US
SUPER MOLD CORP,
NAUGLE JOHN J,
EASTMAN KODAK CO,
BUSER ARNOLD,CH
WILSON FRASER,
SYMONS WILSON E,US
DRACONE DEVELOPMENTS LTD,
SANKYO SEIKI SEISAKUSHO KK,
BOLSEY JACQUES,US
EVG ENTWICKLUNG VERWERT GES,
JOHNSON REGINALD TAVERNOR,
BELDEN MFG CO,
MARQUETTE TOOL & MFG CO,
SCHNEIDER & CIE,FR
STANLEY MCCLATCHIE,
COPEMAN LAB CO,
SDRUZENI PODNIKU TEXTILNIHO ST,
STREIMER MORRIS,GB
EGLI RUDOLF,IT
HARRY LEONARD JONES,
RITCHEY EUGENE,
SCOVILLE MFG COMPANY,
ILLINOIS TOOL WORKS,
BEIJING YOUAN HOSPITAL CAPITAL MEDICAL UNIV,
JIANGSU GAOCHUANG ELECTROMECHANICAL MFG CO LTD,
ZHANG SHULI,
NANTONG MODENG CLOTHING CO LTD,
JIAMUSI POWER SUPPLY COMPANY OF STATE GRID HEILONGJIANG ELECTRIC POWER COMPANY LTD,
HUANENG QINMEI RUIJIN POWER GENERATION CO LTD,
SICHUAN SIMON YIHUA ELECTRICAL CO LTD,
SONG RUYING,
NETINOVO TECH SHENZHEN LTD,
SHENZHEN YUANKEYU TECH CO LTD,
BAOJI TIANKANG ELECTRICAL EQUIPMENT CO LTD,
KAZUXIN IRON ALLOY LTD COMPANY,
SUZHOU SHUIXING ENVIRONMENTAL PROT INDUSTRIAL SYSTEM CO LTD,
INFOVISION OPTOELECT KUNSHAN,
TIANZHOU CHANGZHOU AUTOMATION STOCK LTD COMPANY,
JINAN KEDA ADHESIVE COLOR PRINTING CO LTD,
CHEN XI,
WUHAN QINGZHIWEI MEDICAL EQUIPMENT LTD COMPANY,
BYD CO LTD,
TIANJIN JINGWEI SCIENCE AND TECH CO LTD,
GUIZHOU YUNTENG ENVIRONMENTAL PROT ENGINEERING LIMITED COMPANY,
QINGDAO OUMUYE MACHINERY CO LTD,
BALANCED WATER MOTOR STOCK LTD COMPANY,
YIXING YIXIANG SI TECH CO LTD,
TANGSHAN HUIFENG STEEL CO LTD,
YONGKANG SHENGYI ENERGY TECH CO LTD,
XINJIANG ELECTRIC POWER ENGINEERING SUPERVISION LTD RESPONSIBILITY COMPANY,
ZKW GROUP GMBH,AT
WHITE DRIVE PRODUCTS INC,US
TIMPSON LTD,
CAMBRIDGE ENTPR LTD,
DAIMLER CHRYSLER AG,
WATTS ELIZABETH K,
LASER MAGNETIC STORAGE INT,US
ANNO KOJI,JP
HELBLING CHRISTIAN FA,DE
INTRA INTERNAT AB,SE
PERINI FABIO SPA,IT
PANIZZOLO IVAN,IT
EIKEN CHEMICAL,JP
MERCK & CO INC,US
ISCAR LTD,
JUNG HO WOON,KR
UNIV NAT MINING,UA
INFOSEEK CORP,
PILKINGTON AEROSPACE LTD,
SIERRA SEMICONDUCTOR BV,NL
TODO PRODUKTIONS & FOERSAELJNI,SE
SINGAPORE HEALTH SERV PTE LTD,SG
GUNNER ESKESEN,DK
I P A S R L,IT
HERCULES SA,
TOYO BOSEKI,JP
FERRER INT,ES
FRIEDRICH MIESCHER INSTITUTE FOR BIOMEDICAL RES,CH
GENTURE ELECTRONICS CO LTD,CN
INST NAT RECH INF AUTOMAT,FR
HAIER SMART HOME CO LTD,CN
VIVO MOBILE COMMUNICATION CO LTD,CN
COVESTRO DEUTSCHLAND AG,DE
AL KO KOBER SE,DE
SINGLE BUOY MOORINGS,CH
SUAREZ SUAREZ LUIS HERNANDO,CO
SCOLOPPIO RAFFAELE,IT
IMAMURA NAOYA,JP
EZGO CO LTD,KR
MCDEVITT TODD CHARLES,US
DUTHIE ROBERT SCOTT,US
MCINTYRE WILLIAM C,US
CVILUX CORP,TW
MAX PLANCK INST FUER EISENFORSCHUNG GMBH,DE
ARSANUKAEV MUKHAMED MAGOMEDOVICH,RU
CLAAS Sebstfahrende Erntemaschinen GmbH,DE
CHINA ACADEMY TELECOMMUNICATIONS TECHNOLOGY,CN
CATERPILLAR TRIMBLE CONTROL TECH LLC,US
LUMILEDS LLC,US
CVC TECH INC,TW
LUMMUS TECHNOLOGY INC,US
SOMA MANI,US
MEN SHIKH OLEG FEDOROVICH,RU
INT MOBILE MACHINES,US
DEUTSCHE TELEKOM AG,
FLYGT AB ITT,SE
KAYSERSBERG PACKAGING SA,FR
NOTO SERGIO,
NIOBEC INC,CA
LCI ITALY SRL,
CHAO DAVID,
TAMURA JUN,
HOFFMAN WILLIAM H,
KNIGHTON MARK S,
KRISHNAMOORTHI RAGHURAMAN,
NAT INST OF ADV IND SCI AND TE,JP
AMERICAN FLUORESCENT CORP,US
HORNBACH DAVID W,
ADOBE SYSTEMS INC,US
MEDLINE IND INC,US
BLAU AUTOMOBILTECHNIK GMBH,AT
OESTREICHER PURATOR,AT
WADDINGTON HARRY H,GB
FRIEDMAN YIZHAK,
EIDENBERG KASPAR,
USINES ROYERES SA DES,
NISSHIN SPINNING,
AGUSTA AERONAUT COSTR,
SIG SCHWEIZ INDUSTRIEGES,
NYITRAI FERENC,
PAIZS JOZSEF,
BRAND OTTO GMBH,DE
ELBIT LTD,IL
COGNIS DEUTSCHLAND GMBH,DE
VAEAENAENEN RAIMO,FI
PARMA OY,FI
HAN CHOL,KR
GOLDSCHMIDT AG TH,
SCHAEFER WERKE KG,
MASCHF AUGSBURG NUERNBERG AG,DE
GARIN GERT,SE
BUDDENBOHM NILS,DE
DRONGE MARK,US
AKADEMIA IM JANA DLUGOSZA W CZESTOCHOWIE,PL
TRATECNICA S A,ES
Gea mechanical equipment italia spa,IT
ARUPA 
Query:
SELECT a.value::VARIANT:"name"::STRING AS "assignee_name",
           COUNT(DISTINCT t."application_number") AS "application_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a
    GROUP BY a.value::VARIANT:"name"::STRING
    ORDER BY "application_count" DESC
    LIMIT 1000;
Answer:
Too long, hard cut:
assignee_name,application_count
SAMSUNG ELECTRONICS CO LTD,2238
CANON KK,2114
HITACHI LTD,2011
MATSUSHITA ELECTRIC IND CO LTD,1948
MITSUBISHI ELECTRIC CORP,1732
SONY CORP,1477
FUJITSU LTD,1363
TOSHIBA CORP,1296
NEC CORP,1280
IBM,1239
LG ELECTRONICS INC,1053
HUAWEI TECH CO LTD,1027
SIEMENS AG,987
SEIKO EPSON CORP,963
GEN ELECTRIC,947
SHARP KK,913
STATE GRID CORP CHINA,839
TOYOTA MOTOR CORP,839
BOSCH GMBH ROBERT,837
HONDA MOTOR CO LTD,836
QUALCOMM INC,812
RICOH KK,735
DENSO CORP,628
SANYO ELECTRIC CO,616
HYUNDAI MOTOR CO LTD,577
NIPPON TELEGRAPH & TELEPHONE,568
TOSHIBA KK,545
BAYER AG,528
FUJI PHOTO FILM CO LTD,522
NISSAN MOTOR,515
TOYOTA MOTOR CO LTD,507
MITSUBISHI HEAVY IND LTD,488
ZTE CORP,479
INTEL CORP,475
ERICSSON TELEFON AB L M,462
BOE TECHNOLOGY GROUP CO LTD,435
FUJI XEROX CO LTD,427
DU PONT,423
MATSUSHITA ELECTRIC WORKS LTD,403
NIPPON STEEL CORP,401
SUMITOMO ELECTRIC INDUSTRIES,399
PROCTER & GAMBLE,394
BASF AG,366
HOECHST AG,364
GREE ELECTRIC APPLIANCES INC ZHUHAI,364
PANASONIC CORP,357
SUMITOMO CHEMICAL CO,354
TOKYO SHIBAURA ELECTRIC CO,353
FUJIFILM CORP,349
BROTHER IND LTD,325
HOFFMANN LA ROCHE,319
FORD GLOBAL TECH LLC,319
LG CHEMICAL LTD,318
KYOCERA CORP,316
UNIV ZHEJIANG,314
MURATA MANUFACTURING CO,305
PHILIPS NV,304
APPLE INC,299
TORAY INDUSTRIES,298
KONINKL PHILIPS ELECTRONICS NV,298
HON HAI PREC IND CO LTD,296
DAINIPPON PRINTING CO LTD,294
SAMSUNG DISPLAY CO LTD,289
MICROSOFT CORP,285
MIDEA GROUP CO LTD,278
FUJI ELECTRIC CO LTD,270
NIPPON ELECTRIC CO,270
TAIWAN SEMICONDUCTOR MFG CO LTD,269
UNIV TSINGHUA,264
KOBE STEEL LTD,262
MICROSOFT TECHNOLOGY LICENSING LLC,256
3M INNOVATIVE PROPERTIES CO,253
SEKISUI CHEMICAL CO LTD,249
OKI ELECTRIC IND CO LTD,241
RICOH CO LTD,240
EASTMAN KODAK CO,238
XEROX CORP,236
OMRON TATEISI ELECTRONICS CO,236
KAO CORP,234
NIKON CORP,231
WESTINGHOUSE ELECTRIC CORP,231
TOKYO ELECTRON LTD,230
TOPPAN PRINTING CO LTD,229
CASIO COMPUTER CO LTD,229
MOTOROLA INC,228
BASF SE,225
KONISHIROKU PHOTO IND,225
APPLIED MATERIALS INC,224
BRIDGESTONE CORP,222
NITTO DENKO CORP,221
MICRON TECHNOLOGY INC,220
YAZAKI CORP,219
BOEING CO,217
HYNIX SEMICONDUCTOR INC,214
RCA CORP,213
HEWLETT PACKARD DEVELOPMENT CO,213
DAIKIN IND LTD,211
TDK CORP,209
SAMSUNG SDI CO LTD,208
LG DISPLAY CO LTD,208
GEN MOTORS CORP,206
OLYMPUS OPTICAL CO,206
PANASONIC IP MAN CO LTD,205
CIBA GEIGY AG,204
MAZDA MOTOR,203
SHELL INT RESEARCH,201
TEXAS INSTRUMENTS INC,200
UNIV CALIFORNIA,199
LILLY CO ELI,199
PETROCHINA CO LTD,199
TENCENT TECH SHENZHEN CO LTD,197
NTT DOCOMO INC,195
UNIV SOUTH CHINA TECH,192
GUANGDONG OPPO MOBILE TELECOMMUNICATIONS CORP LTD,191
OLYMPUS CORP,190
UNIV TIANJIN,190
SAMSUNG ELECTRO MECH,190
KIA MOTORS CORP,187
COLGATE PALMOLIVE CO,186
SUMITOMO WIRING SYSTEMS,186
KUBOTA KK,183
SEMICONDUCTOR ENERGY LAB,182
FURUKAWA ELECTRIC CO LTD,181
SANKYO CO,180
CHINA PETROLEUM & CHEM CORP,180
DOW CHEMICAL CO,178
OREAL,177
PFIZER,175
KAWASAKI STEEL CO,173
POSCO,172
ICI LTD,171
KOREA ELECTRONICS TELECOMM,170
UNIV JILIN,169
HAIER SMART HOME CO LTD,167
TOSHIBA TEC KK,165
SHIMADZU CORP,165
NIPPON KOKAN KK,165
SUMITOMO METAL IND,165
BAYERISCHE MOTOREN WERKE AG,165
NOVARTIS AG,165
SHINETSU CHEMICAL CO,165
MINNESOTA MINING & MFG,164
COMMISSARIAT ENERGIE ATOMIQUE,163
ASAHI CHEMICAL IND,162
ALPS ELECTRIC CO LTD,161
HONEYWELL INT INC,160
MERCK PATENT GMBH,159
AISIN SEIKI,159
GOOGLE LLC,159
UNIV SOUTHEAST,158
UNIV SHANGHAI JIAOTONG,158
HITACHI CHEMICAL CO LTD,157
LG INNOTEK CO LTD,155
ISHIKAWAJIMA HARIMA HEAVY IND,155
NANJING UNIVERSITY OF TECHNOLOGY,153
CENTRE NAT RECH SCIENT,152
ZAHNRADFABRIK FRIEDRICHSHAFEN,151
ASAHI GLASS CO LTD,150
ISEKI AGRICULT MACH,150
VOLKSWAGEN AG,150
GM GLOBAL TECH OPERATIONS INC,148
ILLINOIS TOOL WORKS,147
AMERICAN CYANAMID CO,147
MERCK & CO INC,146
ALIBABA GROUP HOLDING LTD,145
NTN TOYO BEARING CO LTD,142
IND TECH RES INST,142
NOKIA CORP,142
INFINEON TECHNOLOGIES AG,142
KONINKLIJKE PHILIPS NV,142
MITSUBISHI MATERIALS CORP,141
DEERE & CO,141
KIMBERLY CLARK CO,141
MITSUBISHI CHEM CORP,138
HALLIBURTON ENERGY SERVICES INC,138
YAMAHA MOTOR CO LTD,137
UNIV SHANDONG,136
BYD CO LTD,136
NSK LTD,136
WESTERN ELECTRIC CO,136
MURATA MACHINERY LTD,136
BEIJING XIAOMI MOBILE SOFTWARE CO LTD,134
HONGFUJIN PREC IND SHENZHEN,134
KAWASAKI HEAVY IND LTD,133
UNILEVER NV,132
AUDI AG,131
SCHAEFFLER TECHNOLOGIES AG,131
UNIV JIANGNAN,130
KOMATSU MFG CO LTD,130
UNIV NANJING FORESTRY,128
FUJIKURA LTD,128
AU OPTRONICS CORP,127
CHINA PETROLEUM & CHEMICAL,127
TOYO BOSEKI,127
FRAUNHOFER GES FORSCHUNG,126
HITACHI METALS LTD,126
TEIJIN LTD,126
ROHM & HAAS,125
NGK INSULATORS LTD,124
UNION CARBIDE CORP,124
YOKOHAMA RUBBER CO LTD,123
VICTOR COMPANY OF JAPAN,122
UNIV DALIAN TECH,122
JFE STEEL CORP,120
UNIV HUAZHONG SCIENCE TECH,119
UNIV CENTRAL SOUTH,119
UNITED TECHNOLOGIES CORP,118
TOTO LTD,118
YAMAHA CORP,118
SANYO PRODUCT CO LTD,117
UNIV KUNMING SCIENCE & TECHNOLOGY,117
PANASONIC IP MAN CORP,116
DOW GLOBAL TECHNOLOGIES LLC,116
UNIV BEIHANG,114
ROHM CO LTD,114
GUANGDONG POWER GRID CO,114
MITSUBISHI RAYON CO,114
SHOWA DENKO KK,1
Query:
SELECT t."application_number",
           TO_CHAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    WHERE TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    LIMIT 1000;
Answer:
Too long, hard cut:
application_number,filing_year
EP-21720111-A,2021
EP-21761564-A,2021
EP-21826037-A,2021
EP-21847990-A,2021
EP-21954095-A,2021
EP-22172338-A,2017
EP-22182986-A,2022
EP-22185887-A,2022
EP-22206254-A,2022
EP-22305030-A,2022
EP-22711521-A,2022
EP-22714327-A,2022
EP-22762898-A,2022
EP-22787080-A,2022
EP-22787590-A,2022
EP-22813151-A,2022
EP-22825233-A,2022
EP-22883336-A,2022
EP-23187669-A,2015
EP-23194117-A,2023
EP-23825354-A,2023
EP-79104562-A,1979
EP-81110668-A,1981
EP-81400503-A,1981
EP-82900480-A,1981
EP-83100816-A,1983
EP-83402348-A,1983
EP-84890094-A,1984
EP-85201625-A,1985
EP-85900311-A,1984
EP-85901551-A,1985
EP-86109427-A,1986
EP-86890309-A,1986
EP-87106729-A,1987
EP-87109344-A,1987
EP-87110364-A,1987
EP-88403074-A,1988
EP-88907553-A,1988
EP-89102570-A,1989
EP-89402513-A,1989
EP-91116467-A,1991
EP-91122337-A,1992
EP-91903101-A,1991
EP-92114911-A,1992
EP-92910829-A,1992
EP-93918698-A,1993
EP-94400056-A,1994
EP-94904951-A,1994
EP-94908543-A,1994
EP-94921804-A,1994
EP-95109827-A,1995
EP-95109931-A,1995
EP-95924269-A,1995
EP-96103022-A,1996
EP-96110211-A,1996
EP-96402559-A,1996
EP-97114840-A,1997
EP-97117997-A,1997
EP-97302341-A,1997
EP-97944752-A,1997
EP-97946710-A,1997
EP-98918086-A,1998
EP-98938911-A,1998
EP-98949518-A,1998
EP-99903807-A,1999
EP-99928719-A,1999
EP-99965543-A,1999
FI-20225229-A,2022
HK-02100538-A,2002
HK-03104403-A,2003
HK-04104019-A,2004
HK-05100346-A,2005
HK-06102498-A,2006
HK-06111962-A,2006
HK-07114356-A,2007
HK-11105637-A,2011
HK-14101589-A,2014
HK-15102298-A,2015
HK-15103771-A,2015
HK-15105067-A,2015
HK-16103067-A,2016
HK-16112544-A,2016
HK-18103604-A,2018
HK-18113641-A,2018
HK-19100246-A,2012
HK-98115200-A,1998
HK-99106102-A,1998
IE-20060594-A,1991
IE-20170204-A,2017
IT-BO940118-A,1994
IT-BS910001-A,1991
IT-BS910096-A,1991
IT-MC920020-A,1992
IT-MI912421-A,1991
IT-MI941789-A,1994
IT-MI960149-A,1996
IT-MI982396-A,1998
IT-MI992424-A,1999
IT-OR970002-A,1997
IT-PD930195-A,1993
IT-PI930016-A,1993
IT-RM920122-A,1992
IT-RM930191-A,1993
IT-RM970396-A,1997
IT-TO960328-A,1996
IT-TO960613-A,1996
IT-TO980767-A,1998
IT-TO980910-A,1998
IT-TV940008-A,1994
IT-UD930040-A,1993
IT-UD940193-A,1994
NO-20150427-A,2015
NO-20191175-A,2019
PE-16731990-A,1990
PL-22590880-A,1980
PL-22817480-A,1980
PL-23227781-A,1981
PL-25258185-A,1985
PL-25785486-A,1986
PL-26258986-A,1986
PL-26492787-A,1987
PL-26895187-A,1987
PL-30640194-A,1994
PL-30945695-A,1995
PL-31404796-A,1996
PL-32881997-A,1997
PL-33790498-A,1998
PL-36291701-A,2001
PL-36509004-A,2004
PL-37102402-A,2002
PL-38005906-A,2006
PL-39831812-A,2012
PL-39835909-A,2009
PL-40016712-A,2012
PL-42696518-A,2018
PL-42954419-A,2019
PL-43769721-A,2021
PL-44113622-A,2022
US-10019405-A,2005
US-10062605-A,2005
US-10258602-A,2002
US-10304305-A,2005
US-10757208-A,2008
US-11011105-A,2005
US-11066508-A,2008
US-11386505-A,2005
US-11469002-A,2002
US-11553505-A,2005
US-11658302-A,2002
US-11964905-A,2005
US-12292908-A,2008
US-12694405-A,2005
US-12736305-A,2005
US-12816005-A,2005
US-13294705-A,2005
US-13350605-A,2005
US-13593808-A,2008
US-14084702-A,2002
US-14255905-A,2005
US-14289402-A,2002
US-14322405-A,2005
US-14445605-A,2005
US-14624702-A,2002
US-14704308-A,2008
US-14947708-A,2008
US-14991602-A,2000
US-15056702-A,2002
US-15255805-A,2005
US-15676708-A,2008
US-15774308-A,2008
US-15924607-A,2007
US-15929202-A,2002
US-15965105-A,2005
US-16091202-A,2002
US-16638002-A,2002
US-16658705-A,2005
US-16815205-A,2005
US-16894008-A,2008
US-17063802-A,2002
US-17423108-A,2008
US-17587105-A,2005
US-17608808-A,2008
US-17678705-A,2005
US-17777708-A,2008
US-18196208-A,2008
US-18265005-A,2005
US-18297708-A,2008
US-18378602-A,2002
US-19543005-A,2005
US-20242202-A,2002
US-20504105-A,2005
US-20742605-A,2005
US-21069402-A,2002
US-21151402-A,2002
US-21380508-A,2008
US-21381608-A,2008
US-22027005-A,2005
US-22095908-A,2008
US-22106808-A,2008
US-22365605-A,2005
US-22566505-A,2005
US-22628007-A,2007
US-22713505-A,2005
US-22749505-A,2005
US-22771708-A,2008
US-22773102-A,2002
US-22786202-A,2002
US-22799005-A,2005
US-22832508-A,2008
US-23003408-A,2008
US-23012202-A,2002
US-23021105-A,2005
US-23127308-A,2008
US-23459605-A,2005
US-23985002-A,2001
US-24059702-A,2002
US-24309808-A,2008
US-24366205-A,2005
US-24452402-A,2002
US-24548808-A,2008
US-24872308-A,2008
US-25069008-A,2008
US-25117605-A,2005
US-25120402-A,2002
US-25230105-A,2005
US-25343005-A,2005
US-25373608-A,2008
US-25555608-A,2008
US-25592408-A,2008
US-25748902-A,2002
US-25761905-A,2005
US-26388705-A,2005
US-26397905-A,2005
US-26438502-A,2002
US-26620505-A,2005
US-26851605-A,2005
US-27275702-A,2002
US-27335208-A,2008
US-27526303-A,2001
US-27742206-A,2006
US-27794902-A,2002
US-28143205-A,2005
US-28465505-A,2005
US-28481608-A,2008
US-28569105-A,2005
US-28829705-A,2005
US-28844605-A,2005
US-29253508-A,2008
US-29275402-A,2002
US-29696607-A,2007
US-29756005-A,2005
US-29966207-A,2007
US-30275702-A,2002
US-30603005-A,2005
US-30663802-A,2002
US-30683706-A,2006
US-201715402499-A,2017
US-201715404486-A,2017
US-201715405163-A,2017
US-201715406347-A,2017
US-2017154109
Query:
SELECT DISTINCT a.value::VARIANT:"country_code"::STRING AS "assignee_country_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a
    LIMIT 1000;
Answer:
assignee_country_code
KP
OM
NG
TJ
FI
DK
BS
AD
SL
LA
LI
IQ
RS
JE
KH
PE
VC
SZ
SI
AR
PK
LT
US
DE
BB
PH
DD
ZA
CM
PA
EG
TC
JP
HU
AN
AG
TT
TM
HR
ET
GG
UA
MA
EE
MX
GE
SC
NO
MO
KZ
GR
AE
PF
RU
AM
PL
CR
TH
KW
LK
CZ
SV
HN
CH
AI
VE
VN
PR
NC
GH
KG
CA
SK
IS
AZ
UY
BD
GA
KR
RO
SM
CK
ME
SA
MY
CS
LV
CO
SY
BZ
LB
LU
NL
UZ
MD
ST
IR
QA
JO
BM
GB
SG
HK
VG
GT
TN
BR
BY
ID
WS
NA
""
YU
ZM
AU
CU
ZW
IN
EC
IE
ES
MU
CN
MC
TR
BG
AT
TW
IL
MT
BE
SE
KY
IT
CY
BN
GI
IM
NZ
CL
PT
FR
SU
Query:
SELECT t."publication_number", c.value::VARIANT:"code"::STRING AS "cpc_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") c
    WHERE c.value::VARIANT:"code"::STRING LIKE 'A01B3%'
    LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,cpc_code
GB-696973-A,A01B35/06
IL-268624-A,A01B3/24
IL-268624-A,A01B3/24
US-2597821-A,A01B39/00
US-2597821-A,A01B39/00
US-2597821-A,A01B35/26
US-2597821-A,A01B35/26
FR-2943502-A1,A01B39/163
US-1093294-A,A01B3/10
KR-20070101567-A,A01B33/146
KR-20070101567-A,A01B33/06
DE-1963184-U,A01B33/08
DE-1963184-U,A01B33/10
DE-1963184-U,A01B33/00
KR-200149462-Y1,A01B35/28
KR-101169320-B1,A01B35/10
KR-101593221-B1,A01B3/36
US-2024164239-A1,A01B35/08
US-2024164239-A1,A01B35/08
US-2024164239-A1,A01B35/08
FR-2287837-B1,A01B33/024
FR-2287837-B1,A01B33/08
FR-2287837-B1,A01B33/021
FR-2287837-B1,A01B33/08
FR-2287837-B1,A01B33/021
FR-2287837-B1,A01B33/024
DE-102010019819-B4,A01B3/464
US-828171-A,A01B3/26
US-3129772-A,A01B39/085
US-3129772-A,A01B39/085
US-530054-A,A01B39/14
US-1471180-A,A01B3/50
US-1471180-A,A01B3/50
KR-100191418-B1,A01B35/28
KR-100191418-B1,A01B35/18
CA-2543900-A1,A01B33/103
CA-2543900-A1,A01B33/103
US-1412308-A,A01B3/54
US-1412308-A,A01B3/54
KR-102593393-B1,A01B33/082
KR-102593393-B1,A01B33/082
KR-102484290-B1,A01B33/14
KR-102484290-B1,A01B35/28
KR-102484290-B1,A01B33/14
KR-102484290-B1,A01B35/28
AU-2016269849-A1,A01B39/18
AU-2016269849-A1,A01B39/18
BE-872468-A,A01B33/065
BE-872468-A,A01B33/16
BE-872468-A,A01B33/12
US-5845717-A,A01B37/00
US-5845717-A,A01B37/00
ZA-808003-B,A01B39/22
ZA-808003-B,A01B35/225
ZA-808003-B,A01B39/22
ZA-808003-B,A01B35/225
GB-2089182-B,A01B33/065
IT-1064821-B,A01B33/065
IT-1064821-B,A01B33/065
CA-2977468-A1,A01B33/024
BE-727862-A,A01B33/021
US-1636048-A,A01B35/24
US-1636048-A,A01B35/24
KR-200194260-Y1,A01B35/10
US-10375891-B2,A01B39/18
US-10375891-B2,A01B39/18
US-10375891-B2,A01B39/18
US-130700-A,A01B35/08
FR-960102-A,A01B33/087
FR-960102-A,A01B33/082
US-5267618-A,A01B3/46
US-5267618-A,A01B3/46
US-231385-A,A01B33/065
KR-20020067218-A,A01B39/18
CN-115362764-A,A01B35/16
CN-115362764-A,A01B35/28
NO-153631-B,A01B35/00
CN-104040083-B,A01B33/14
US-220177-A,A01B35/18
US-3054462-A,A01B35/12
US-3054462-A,A01B35/12
FR-508965-A,A01B3/30
FR-508965-A,A01B3/18
US-290366-A,A01B35/22
US-3963079-A,A01B35/18
US-3963079-A,A01B39/14
US-3963079-A,A01B39/14
US-3963079-A,A01B35/18
US-2031188-A,A01B33/06
US-2031188-A,A01B33/06
CN-116671357-A,A01B39/085
CN-116671357-A,A01B39/22
CN-116671357-A,A01B39/20
GB-2039201-B,A01B33/106
KR-20020000597-A,A01B35/22
CN-114651538-A,A01B39/22
CN-114651538-A,A01B39/18
CN-114651538-A,A01B39/085
IT-8519066-A1,A01B33/065
IT-8519066-A1,A01B33/106
PL-440426-A1,A01B33/00
PL-440426-A1,A01B33/021
PL-440426-A1,A01B33/02
PL-440426-A1,A01B33/04
BE-1007083-A5,A01B39/16
BE-1007083-A5,A01B39/26
KR-100626846-B1,A01B3/50
JP-S6342702-Y2,A01B33/028
JP-6910281-B2,A01B33/028
JP-6910281-B2,A01B33/024
US-159642-A,A01B35/08
US-395573-A,A01B35/26
CN-108289407-A,A01B33/16
CN-108289407-A,A01B33/16
CN-108289407-A,A01B35/32
US-1081539-A,A01B35/06
US-376176-A,A01B3/26
GB-792883-A,A01B3/36
US-5407014-A,A01B31/00
US-5407014-A,A01B31/00
CN-114916261-A,A01B35/20
CN-114916261-A,A01B35/26
NO-910950-L,A01B35/26
CA-3089518-A1,A01B39/18
US-694931-A,A01B3/08
CN-109392332-A,A01B35/20
CN-109392332-A,A01B35/26
DE-463858-C,A01B35/04
CA-2945250-A1,A01B33/106
CA-2945250-A1,A01B33/106
EP-3586579-A1,A01B33/087
EP-3586579-A1,A01B37/00
US-2888084-A,A01B33/06
US-1545136-A,A01B39/26
US-1545136-A,A01B39/26
US-2019324472-A1,A01B39/18
DE-8707829-U1,A01B33/142
KR-200487998-Y1,A01B39/18
BE-826346-A,A01B33/106
BE-826346-A,A01B33/106
AT-A720679-A,A01B33/106
NL-7909063-A,A01B33/103
US-469659-A,A01B35/08
KR-900006618-B1,A01B33/14
EP-3474651-C0,A01B33/06
EP-3474651-C0,A01B35/16
US-2843032-A,A01B39/14
US-2843032-A,A01B39/14
US-1860534-A,A01B3/50
US-1860534-A,A01B3/50
US-501724-A,A01B3/464
US-2784656-A,A01B35/14
US-2784656-A,A01B35/14
US-2039702-A,A01B39/19
US-2039702-A,A01B39/19
AU-7115874-A,A01B35/26
GB-436304-A,A01B35/16
GB-436304-A,A01B33/021
US-5669452-A,A01B35/04
US-5669452-A,A01B35/04
AU-2002301383-B2,A01B35/225
AU-2002301383-B2,A01B35/225
CN-113761309-A,A01B39/16
CN-113761309-A,A01B39/26
CN-113761309-A,A01B39/20
CN-107072143-A,A01B35/225
CN-107072143-A,A01B35/225
CN-107072143-A,A01B35/225
CN-107094377-A,A01B33/08
CN-107094377-A,A01B33/144
KR-20130063834-A,A01B39/18
DE-140654-C,A01B3/12
US-2545590-A,A01B33/025
US-2545590-A,A01B33/025
CA-997451-A,A01B3/74
KR-200386017-Y1,A01B3/28
RU-191537-U1,A01B35/20
GB-2598141-A,A01B39/06
GB-2598141-A,A01B39/18
GB-2598141-A,A01B39/18
CN-107646212-A,A01B35/22
CN-107646212-A,A01B35/04
IT-1166526-B,A01B33/146
IT-1166526-B,A01B33/106
IT-1166526-B,A01B33/065
IT-1166526-B,A01B33/065
IT-1166526-B,A01B33/106
IT-1166526-B,A01B33/146
GB-2090713-B,A01B35/12
GB-2090713-B,A01B39/10
GB-2090713-B,A01B35/12
GB-2090713-B,A01B39/10
DE-829523-C,A01B3/32
CN-100366901-C,A01B33/021
JP-6998053-B2,A01B39/18
JP-6998053-B2,A01B39/18
HU-E050035-T2,A01B35/24
KR-200473688-Y1,A01B35/16
CN-108575125-A,A01B33/12
CN-108575125-A,A01B33/10
CN-113796181-A,A01B33/08
CN-113796181-A,A01B33/10
CN-106973572-B,A01B39/18
NL-183071-C,A01B33/065
NL-183071-C,A01B33/065
DE-102017102683-A1,A01B35/18
KR-101378314-B1,A01B33/08
Query:
SELECT DISTINCT
    SUBSTRING(c.value::VARIANT:"code"::STRING, 1, 1) AS "cpc_section",
    SUBSTRING(c.value::VARIANT:"code"::STRING, 2, 2) AS "cpc_class",
    SUBSTRING(c.value::VARIANT:"code"::STRING, 4, 1) AS "cpc_subclass"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."cpc") c
LIMIT 1000;
Answer:
cpc_section,cpc_class,cpc_subclass
F,02,D
G,01,V
C,08,K
E,03,D
B,30,B
B,21,K
B,61,D
B,27,N
C,02,F
D,04,D
H,01,F
A,47,G
B,21,B
C,12,R
B,62,H
G,01,D
C,12,G
F,23,B
B,42,C
B,21,L
B,31,D
E,05,Y
A,45,F
F,16,M
E,02,B
D,21,F
A,22,C
B,68,B
G,21,H
E,02,C
H,04,W
E,21,B
C,23,C
B,23,Q
E,05,B
F,23,G
C,12,M
D,06,M
E,05,F
F,23,Q
C,13,K
D,02,H
F,23,M
C,10,F
G,21,J
G,01,R
D,04,B
B,63,H
F,15,B
F,24,D
H,04,B
G,10,L
B,60,H
C,10,M
B,43,M
D,06,P
B,27,L
F,42,D
B,64,B
B,23,K
B,65,D
A,61,G
A,24,B
C,22,B
A,41,B
H,03,J
C,09,G
H,03,C
F,41,A
F,03,G
A,47,K
B,25,D
C,06,F
F,02,K
A,42,C
B,41,B
F,41,J
B,41,G
H,02,G
A,61,Q
B,29,K
G,10,H
B,81,C
A,22,B
B,64,G
H,05,F
C,05,F
B,41,D
A,61,K
B,03,B
C,01,P
B,60,Y
B,43,L
C,09,H
B,33,Y
G,21,B
C,13,B
G,10,G
B,60,W
D,03,D
F,01,L
B,28,B
F,41,F
A,41,D
G,03,D
Y,10,T
G,01,N
A,63,C
B,63,C
F,04,D
B,25,C
H,03,M
D,01,F
G,05,D
C,12,F
A,24,F
C,06,B
A,47,J
G,01,M
B,22,F
B,22,D
G,01,H
F,03,D
E,04,F
A,21,B
B,09,C
B,04,C
H,03,B
C,07,G
Y,02,T
C,11,B
B,62,B
D,07,B
C,05,D
H,03,D
E,03,C
A,63,D
G,12,B
C,06,C
B,60,V
H,01,L
H,03,G
F,23,J
H,04,J
H,10,N
C,10,J
B,05,C
B,41,N
B,68,F
F,21,L
F,21,Y
F,21,V
D,06,L
G,01,F
A,01,K
B,07,C
D,05,B
B,62,L
B,24,D
B,67,B
G,08,B
B,21,C
C,05,G
F,16,P
A,23,Y
E,04,G
A,62,B
A,46,B
B,41,P
B,07,B
B,66,B
F,01,P
C,08,B
F,02,G
E,03,F
C,30,B
F,41,C
B,27,K
B,26,F
G,06,F
A,45,B
C,09,C
B,22,C
B,23,C
F,22,D
A,01,L
G,10,B
H,04,T
A,61,F
B,24,B
B,60,B
A,47,F
D,06,H
B,61,B
A,41,G
A,62,D
G,10,F
C,12,Q
G,01,C
D,04,H
E,05,C
B,31,B
H,02,P
D,21,B
B,01,F
A,61,C
C,05,B
B,27,F
A,01,H
C,12,P
H,02,K
C,12,N
B,60,K
F,16,L
A,23,K
G,04,B
C,11,C
F,01,B
B,05,B
A,01,P
B,28,C
G,16,C
C,09,D
A,23,N
G,05,F
A,61,L
F,16,K
A,43,B
B,29,L
D,06,B
B,27,D
B,31,F
C,06,D
A,61,M
A,61,P
B,67,D
F,04,C
G,04,G
F,16,F
A,42,B
G,07,D
F,23,N
A,01,J
F,16,H
A,01,B
G,01,J
G,21,D
F,02,N
E,01,F
C,05,C
B,05,D
G,05,G
C,22,C
G,06,M
Y,02,B
Y,02,P
D,10,B
B,65,C
C,21,C
B,60,T
C,25,B
D,01,D
B,25,H
C,01,F
A,46,D
F,24,B
D,03,C
C,12,H
G,03,F
Y,02,A
B,26,D
F,21,S
B,42,B
B,61,C
G,10,C
C,11,D
F,26,B
E,02,D
C,08,L
E,06,B
E,06,C
B,21,J
B,60,D
G,04,R
G,21,Y
C,12,L
Y,02,E
H,05,K
A,47,H
C,09,F
B,23,P
B,44,C
G,08,C
B,60,Q
B,44,B
F,16,N
D,05,C
C,12,J
B,25,F
F,25,J
F,28,B
C,23,D
B,01,D
C,25,D
G,05,B
B,64,C
E,05,D
G,16,Z
G,02,C
A,23,P
F,23,L
B,65,G
F,28,G
B,66,F
F,04,F
H,03,H
B,09,B
A,47,D
G,21,F
B,43,K
Z,03,R
B,60,L
H,02,H
B,65,B
G,06,Q
F,25,B
G,09,B
D,21,D
F,02,F
D,21,J
A,44,D
A,47,C
A,21,D
F,24,H
B,60,M
F,15,C
G,16,Y
A,63,J
C,10,H
A,61,B
B,41,J
B,60,N
H,01,R
H,04,Q
G,03,G
D,02,G
F,04,B
F,21,W
B,42,D
A,43,D
B,28,D
B,27,M
F,24,S
F,17,B
B,25,J
C,23,F
G,02,B
G,01,P
H,02,N
C,25,C
B,82,Y
C,07,F
A,41,F
F,24,V
G,11,C
H,03,K
A,01,N
F,41,H
G,16,B
B,27,G
B,62,K
H,05,H
B,27,B
F,01,C
F,22,G
B,41,C
C,07,C
B,64,D
B,62,M
A,23,C
B,29,B
B,66,C
D,21,C
F,27,D
D,01,B
G,01,W
C,10,C
G,04,D
A,63,K
H,01,S
H,01,C
G,21,C
A,45,C
B,03,C
G,07,B
A,24,D
E,01,C
B,65,F
H,01,B
F,24,T
H,01,T
A,41,H
B,61,G
A,44,C
B,23,F
D,05,D
E,04,B
F,42,B
F,16,D
F,28,D
D,01,H
B,60,G
C,23,G
B,21,F
H,01,Q
E,02,F
F,05,D
F,23,K
F,16,C
D,06,G
A,23,F
G,06,J
G,06,V
G,07,F
G,03,H
A,23,L
G,06,N
F,16,B
C,07,B
C,04,B
B,04,B
G,06,C
F,16,S
H,10,B
B,08,B
C,07,H
B,01,J
G,07,C
A,23,J
D,06,Q
F,21,K
A,23,D
G,06,G
B,21,D
B,41,M
Y,02,D
C,03,C
H,02,J
B,60,P
H,01,H
A,21,C
H,02,S
C,01,C
C,10,K
C,40,B
F,03,C
G,06,E
B,27,C
F,16,J
C,21,D
G,01,B
C,10,G
B,26,B
A,63,G
B,63,J
D,06,C
C,01,D
D,02,J
F,27,M
F,23,R
E,01,B
B,44,F
A,63,B
B,60,R
F,41,B
F,17,D
G,21,G
H,03,F
B,31,C
F,27,B
F,01,M
A,47,B
B,32,B
B,62,D
H,04,M
A,61,N
C,03,B
F,02,B
C,09,B
B,02,C
B,61,L
A,41,C
G,04,F
D,01,G
F,21,H
B,62,C
G,06,D
G,03,B
H,04,R
B,63,B
F,02,P
F,41,G
C,07,J
B,64,F
G,07,G
B,66,D
B,03,D
A,61,H
G,11,B
A,62,C
F,01,D
F,01,N
B,68,C
H,01,P
H,02,B
E,04,C
C,25,F
G,01,K
F,16,T
B,60,F
G,09,C
B,61,J
Y,10,S
C,10,L
C,08,C
C,21,B
A,01,D
B,81,B
D,03,J
B,23,H
H,05,G
A,45,D
B,82,B
C,09,K
F,23,D
E,04,H
G,01,G
D,04,C
B,44,D
A,16,B
F,25,C
H,04,H
A,44,B
C,08,F
Y,02,W
A,01,G
F,23,H
H,04,K
E,21,C
B,25,G
D,04,G
G,09,D
H,04,L
G,09,G
C,08,J
H,10,K
H,05,B
C,01,G
F,05,B
A,23,G
G,10,D
F,16,G
G,02,F
C,07,K
G,10,K
A,23,V
F,24,F
B,06,B
A,01,M
B,23,D
D,06,N
C,14,C
A,43,C
B,02,B
B,27,J
B,21,H
G,09,F
F,28,F
F,03,B
B,24,C
F,17,C
B,27,H
B,42,F
F,05,C
H,01,K
G,04,C
B,67,C
A,01,F
B,41,L
B,41,K
B,01,B
B,41,F
G,06,T
D,21,H
A,23,B
B,29,D
E,04,D
F,23,C
F,28,C
A,63,F
G,16,H
B,65,H
G,01,S
F,02,M
B,25,B
B,60,S
C,22,F
E,21,F
A,61,D
F,42,C
H,05,C
Y,02,C
C,09,J
F,02,C
A,24,C
H,04,S
G,01,Q
B,68,G
E,05,G
B,01,L
F,01,K
B,61,H
G,01,L
A,01,C
D,06,F
C,10,B
C,12,C
H,02,M
D,01,C
B,21,G
C,01,B
C,10,N
B,64,U
G,01,T
C,14,B
F,24,J
B,23,G
G,03,C
H,01,M
F,24,C
E,01,D
B,61,K
C,08,H
F,25,D
H,04,N
B,29,C
C,08,G
H,01,J
C,07,D
Y,04,S
H,03,L
A,63,H
D,06,J
B,60,J
B,62,J
A,47,L
B,23,B
F,22,B
G,21,K
D,21,G
B,42,P
C,12,B
G,06,K
G,08,G
B,60,C
H,01,G
A,61,J
B,63,G
F,15,D
E,21,D
E,03,B
B,61,F
C,12,Y
E,01,H
F,03,H
End Exploring Related Columns
Task: For patent class A01B3, I want to analyze the information of the top 3 assignees based on the total number of applications. Please provide the following five pieces of information: the name of this assignee,  total number of applications, the year with the most applications, the number of applications in that year, and the country code with the most applications during that year.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: SELECT S."Column_Name" FROM {Database Name}.{Schema Name}.{Table_name} (ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
assignee_name,total_number_of_applications,year_with_most_applications,number_of_applications_in_that_year,country_code_with_most_applications_in_that_year
Assignee A,num:int > 0,year:int,num:int > 0,country_code:str
Assignee B,num:int > 0,year:int,num:int > 0,country_code:str
Assignee C,num:int > 0,year:int,num:int > 0,country_code:str
```

The table above presents the top 3 assignees in patent class A01B3 based on the total number of applications. For each assignee, it shows their name (`assignee_name`), the total number of applications they have submitted (`total_number_of_applications`), the year in which they submitted the most applications (`year_with_most_applications`), the number of applications they submitted in that year (`number_of_applications_in_that_year`), and the country code where they submitted the most applications during that peak year (`country_code_with_most_applications_in_that_year`). All numerical values are integers greater than zero, and the country code is represented as a string..
Here are some useful tips for answering:
When calculating distances between two geometries, use `ST_MakePoint(x, y)` to make a point and `ST_Distance(geometry1 GEOMETRY, geometry2 GEOMETRY)` to compute. No need to convert from meters to miles unless requested. Don't use Haversine like 2 * 6371000 * ASIN(...), use ST_DISTANCE for more precise results.
Please refrain from adding any conditions that are not explicitly specified in the task.
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'
Be careful one country may have different names in different columns in a database.
When handling TO_TIMESTAMP_NTZ conversions, use query like: SELECT CASE WHEN "date" >= 1e15 THEN TO_TIMESTAMP_NTZ("date" / 1000000) WHEN "date" >= 1e12 THEN TO_TIMESTAMP_NTZ("date" / 1000) ELSE TO_TIMESTAMP_NTZ("date") END AS parsed_timestamp FROM my_table;
Be careful of information in nested JSON columns. e.g.1. When it comes to active users, it refers to has engagement_time_msec parameter rather than directly counting users. So the right query is: SELECT DISTINCT USER_PSEUDO_ID FROM all_user_activity, LATERAL FLATTEN(input => event_params) AS flattened_params WHERE flattened_params.value:key = 'engagement_time_msec'
e.g. When it comes to top-selling product, you should pay attention to hits2.value:"eCommerceAction":"action_type"::INTEGER = 6 where 6 means sold product.
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When counting for rows of a column, ensure they are distinct: SELECT COUNT(DISTINCT col_name) FROM table;
Keep all decimals to four decimal places.
You need to follow the format's positive and negative signs.

2025-01-16 07:13:51 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 07:13:51 - root - INFO - ```sql
WITH base_data AS (
    SELECT
        a.value::VARIANT:"name"::STRING AS assignee_name,
        TO_CHAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS filing_year,
        t."application_number",
        t."country_code"
    FROM
        PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE
        c.value::VARIANT:"code"::STRING LIKE 'A01B3%'
        AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
        AND a.value::VARIANT:"name"::STRING IS NOT NULL
),
total_apps_per_assignee AS (
    SELECT
        assignee_name,
        COUNT(DISTINCT application_number) AS total_number_of_applications
    FROM
        base_data
    GROUP BY
        assignee_name
),
top_3_assignees AS (
    SELECT
        assignee_name,
        total_number_of_applications
    FROM (
        SELECT
            assignee_name,
            total_number_of_applications,
            ROW_NUMBER() OVER (ORDER BY total_number_of_applications DESC) AS rn
        FROM
            total_apps_per_assignee
    )
    WHERE
        rn <= 3
),
apps_per_assignee_year AS (
    SELECT
        assignee_name,
        filing_year,
        COUNT(DISTINCT application_number) AS number_of_applications_in_that_year
    FROM
        base_data
    WHERE
        assignee_name IN (SELECT assignee_name FROM top_3_assignees)
    GROUP BY
        assignee_name, filing_year
),
top_year_per_assignee AS (
    SELECT
        assignee_name,
        filing_year AS year_with_most_applications,
        number_of_applications_in_that_year
    FROM (
        SELECT
            assignee_name,
            filing_year,
            number_of_applications_in_that_year,
            ROW_NUMBER() OVER (PARTITION BY assignee_name ORDER BY number_of_applications_in_that_year DESC, filing_year) AS rn
        FROM
            apps_per_assignee_year
    )
    WHERE
        rn = 1
),
data_for_top_years AS (
    SELECT
        bd.assignee_name,
        bd.filing_year,
        bd.country_code,
        bd.application_number
    FROM
        base_data bd
        INNER JOIN top_year_per_assignee ty
            ON bd.assignee_name = ty.assignee_name
            AND bd.filing_year = ty.year_with_most_applications
),
apps_per_country_code AS (
    SELECT
        assignee_name,
        country_code,
        COUNT(DISTINCT application_number) AS applications_in_country
    FROM
        data_for_top_years
    GROUP BY
        assignee_name, country_code
),
top_country_per_assignee AS (
    SELECT
        assignee_name,
        country_code AS country_code_with_most_applications_in_that_year
    FROM (
        SELECT
            assignee_name,
            country_code,
            ROW_NUMBER() OVER (PARTITION BY assignee_name ORDER BY applications_in_country DESC) AS rn
        FROM
            apps_per_country_code
    )
    WHERE
        rn = 1
)
SELECT
    t3a.assignee_name,
    t3a.total_number_of_applications,
    typa.year_with_most_applications,
    typa.number_of_applications_in_that_year,
    tcpa.country_code_with_most_applications_in_that_year
FROM
    top_3_assignees t3a
    INNER JOIN top_year_per_assignee typa ON t3a.assignee_name = typa.assignee_name
    INNER JOIN top_country_per_assignee tcpa ON t3a.assignee_name = tcpa.assignee_name
ORDER BY
    t3a.total_number_of_applications DESC;
```
2025-01-16 07:13:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 07:13:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 07:13:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 07:13:53 - snowflake.connector.connection - INFO - closed
2025-01-16 07:13:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 07:13:53 - root - INFO - itercount: 1
2025-01-16 07:13:53 - root - INFO - 000904 (42000): 01b9beb1-0004-7b0f-0001-11c300ca076e: SQL compilation error: error line 19 at position 23
invalid identifier 'APPLICATION_NUMBER'
2025-01-16 07:13:53 - root - INFO - Input sql:
WITH base_data AS (
    SELECT
        a.value::VARIANT:"name"::STRING AS assignee_name,
        TO_CHAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS filing_year,
        t."application_number",
        t."country_code"
    FROM
        PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE
        c.value::VARIANT:"code"::STRING LIKE 'A01B3%'
        AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
        AND a.value::VARIANT:"name"::STRING IS NOT NULL
),
total_apps_per_assignee AS (
    SELECT
        assignee_name,
        COUNT(DISTINCT application_number) AS total_number_of_applications
    FROM
        base_data
    GROUP BY
        assignee_name
),
top_3_assignees AS (
    SELECT
        assignee_name,
        total_number_of_applications
    FROM (
        SELECT
            assignee_name,
            total_number_of_applications,
            ROW_NUMBER() OVER (ORDER BY total_number_of_applications DESC) AS rn
        FROM
            total_apps_per_assignee
    )
    WHERE
        rn <= 3
),
apps_per_assignee_year AS (
    SELECT
        assignee_name,
        filing_year,
        COUNT(DISTINCT application_number) AS number_of_applications_in_that_year
    FROM
        base_data
    WHERE
        assignee_name IN (SELECT assignee_name FROM top_3_assignees)
    GROUP BY
        assignee_name, filing_year
),
top_year_per_assignee AS (
    SELECT
        assignee_name,
        filing_year AS year_with_most_applications,
        number_of_applications_in_that_year
    FROM (
        SELECT
            assignee_name,
            filing_year,
            number_of_applications_in_that_year,
            ROW_NUMBER() OVER (PARTITION BY assignee_name ORDER BY number_of_applications_in_that_year DESC, filing_year) AS rn
        FROM
            apps_per_assignee_year
    )
    WHERE
        rn = 1
),
data_for_top_years AS (
    SELECT
        bd.assignee_name,
        bd.filing_year,
        bd.country_code,
        bd.application_number
    FROM
        base_data bd
        INNER JOIN top_year_per_assignee ty
            ON bd.assignee_name = ty.assignee_name
            AND bd.filing_year = ty.year_with_most_applications
),
apps_per_country_code AS (
    SELECT
        assignee_name,
        country_code,
        COUNT(DISTINCT application_number) AS applications_in_country
    FROM
        data_for_top_years
    GROUP BY
        assignee_name, country_code
),
top_country_per_assignee AS (
    SELECT
        assignee_name,
        country_code AS country_code_with_most_applications_in_that_year
    FROM (
        SELECT
            assignee_name,
            country_code,
            ROW_NUMBER() OVER (PARTITION BY assignee_name ORDER BY applications_in_country DESC) AS rn
        FROM
            apps_per_country_code
    )
    WHERE
        rn = 1
)
SELECT
    t3a.assignee_name,
    t3a.total_number_of_applications,
    typa.year_with_most_applications,
    typa.number_of_applications_in_that_year,
    tcpa.country_code_with_most_applications_in_that_year
FROM
    top_3_assignees t3a
    INNER JOIN top_year_per_assignee typa ON t3a.assignee_name = typa.assignee_name
    INNER JOIN top_country_per_assignee tcpa ON t3a.assignee_name = tcpa.assignee_name
ORDER BY
    t3a.total_number_of_applications DESC;
The error information is:
000904 (42000): 01b9beb1-0004-7b0f-0001-11c300ca076e: SQL compilation error: error line 19 at position 23
invalid identifier 'APPLICATION_NUMBER'
Please correct it and output only 1 complete SQL query.When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'

2025-01-16 07:14:34 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 07:14:34 - root - INFO - ```sql
WITH base_data AS (
    SELECT
        a.value::VARIANT:"name"::STRING AS "assignee_name",
        TO_CHAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year",
        t."application_number" AS "application_number",
        t."country_code" AS "country_code"
    FROM
        PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE
        c.value::VARIANT:"code"::STRING LIKE 'A01B3%'
        AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
        AND a.value::VARIANT:"name"::STRING IS NOT NULL
),
total_apps_per_assignee AS (
    SELECT
        "assignee_name",
        COUNT(DISTINCT "application_number") AS "total_number_of_applications"
    FROM
        base_data
    GROUP BY
        "assignee_name"
),
top_3_assignees AS (
    SELECT
        "assignee_name",
        "total_number_of_applications"
    FROM (
        SELECT
            "assignee_name",
            "total_number_of_applications",
            ROW_NUMBER() OVER (ORDER BY "total_number_of_applications" DESC NULLS LAST) AS rn
        FROM
            total_apps_per_assignee
    )
    WHERE
        rn <= 3
),
apps_per_assignee_year AS (
    SELECT
        "assignee_name",
        "filing_year",
        COUNT(DISTINCT "application_number") AS "number_of_applications_in_that_year"
    FROM
        base_data
    WHERE
        "assignee_name" IN (SELECT "assignee_name" FROM top_3_assignees)
    GROUP BY
        "assignee_name", "filing_year"
),
top_year_per_assignee AS (
    SELECT
        "assignee_name",
        "filing_year" AS "year_with_most_applications",
        "number_of_applications_in_that_year"
    FROM (
        SELECT
            "assignee_name",
            "filing_year",
            "number_of_applications_in_that_year",
            ROW_NUMBER() OVER (PARTITION BY "assignee_name" ORDER BY "number_of_applications_in_that_year" DESC NULLS LAST, "filing_year") AS rn
        FROM
            apps_per_assignee_year
    )
    WHERE
        rn = 1
),
data_for_top_years AS (
    SELECT
        bd."assignee_name",
        bd."filing_year",
        bd."country_code",
        bd."application_number"
    FROM
        base_data bd
        INNER JOIN top_year_per_assignee ty
            ON bd."assignee_name" = ty."assignee_name"
            AND bd."filing_year" = ty."year_with_most_applications"
),
apps_per_country_code AS (
    SELECT
        "assignee_name",
        "country_code",
        COUNT(DISTINCT "application_number") AS "applications_in_country"
    FROM
        data_for_top_years
    GROUP BY
        "assignee_name", "country_code"
),
top_country_per_assignee AS (
    SELECT
        "assignee_name",
        "country_code" AS "country_code_with_most_applications_in_that_year"
    FROM (
        SELECT
            "assignee_name",
            "country_code",
            ROW_NUMBER() OVER (PARTITION BY "assignee_name" ORDER BY "applications_in_country" DESC NULLS LAST) AS rn
        FROM
            apps_per_country_code
    )
    WHERE
        rn = 1
)
SELECT
    t3a."assignee_name",
    t3a."total_number_of_applications",
    typa."year_with_most_applications",
    typa."number_of_applications_in_that_year",
    tcpa."country_code_with_most_applications_in_that_year"
FROM
    top_3_assignees t3a
    INNER JOIN top_year_per_assignee typa ON t3a."assignee_name" = typa."assignee_name"
    INNER JOIN top_country_per_assignee tcpa ON t3a."assignee_name" = tcpa."assignee_name"
ORDER BY
    t3a."total_number_of_applications" DESC NULLS LAST;
```
2025-01-16 07:14:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 07:14:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 07:14:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 07:14:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-16 07:14:36 - snowflake.connector.connection - INFO - closed
2025-01-16 07:14:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 07:14:36 - root - INFO - itercount: 2
2025-01-16 07:14:36 - root - INFO - 0
2025-01-16 07:14:36 - root - INFO - results: 
assignee_name,total_number_of_applications,year_with_most_applications,number_of_applications_in_that_year,country_code_with_most_applications_in_that_year
LELY NV C VAN DER,5,1975,1,NL
DEERE & CO,4,1979,1,NL
AMAZONEN WERKE DREYER H,2,1979,2,GB


2025-01-16 07:14:36 - root - INFO - Please check the answer again by reviewing For patent class A01B3, I want to analyze the information of the top 3 assignees based on the total number of applications. Please provide the following five pieces of information: the name of this assignee,  total number of applications, the year with the most applications, the number of applications in that year, and the country code with the most applications during that year., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
assignee_name,total_number_of_applications,year_with_most_applications,number_of_applications_in_that_year,country_code_with_most_applications_in_that_year
Assignee A,num:int > 0,year:int,num:int > 0,country_code:str
Assignee B,num:int > 0,year:int,num:int > 0,country_code:str
Assignee C,num:int > 0,year:int,num:int > 0,country_code:str
```

The table above presents the top 3 assignees in patent class A01B3 based on the total number of applications. For each assignee, it shows their name (`assignee_name`), the total number of applications they have submitted (`total_number_of_applications`), the year in which they submitted the most applications (`year_with_most_applications`), the number of applications they submitted in that year (`number_of_applications_in_that_year`), and the country code where they submitted the most applications during that peak year (`country_code_with_most_applications_in_that_year`). All numerical values are integers greater than zero, and the country code is represented as a string. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
assignee_name,total_number_of_applications,year_with_most_applications,number_of_applications_in_that_year,country_code_with_most_applications_in_that_year
LELY NV C VAN DER,5,1975,1,NL
DEERE & CO,4,1979,1,NL
AMAZONEN WERKE DREYER H,2,1979,2,GB
Current sql:
WITH base_data AS (
    SELECT
        a.value::VARIANT:"name"::STRING AS "assignee_name",
        TO_CHAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year",
        t."application_number" AS "application_number",
        t."country_code" AS "country_code"
    FROM
        PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE
        c.value::VARIANT:"code"::STRING LIKE 'A01B3%'
        AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
        AND a.value::VARIANT:"name"::STRING IS NOT NULL
),
total_apps_per_assignee AS (
    SELECT
        "assignee_name",
        COUNT(DISTINCT "application_number") AS "total_number_of_applications"
    FROM
        base_data
    GROUP BY
        "assignee_name"
),
top_3_assignees AS (
    SELECT
        "assignee_name",
        "total_number_of_applications"
    FROM (
        SELECT
            "assignee_name",
            "total_number_of_applications",
            ROW_NUMBER() OVER (ORDER BY "total_number_of_applications" DESC NULLS LAST) AS rn
        FROM
            total_apps_per_assignee
    )
    WHERE
        rn <= 3
),
apps_per_assignee_year AS (
    SELECT
        "assignee_name",
        "filing_year",
        COUNT(DISTINCT "application_number") AS "number_of_applications_in_that_year"
    FROM
        base_data
    WHERE
        "assignee_name" IN (SELECT "assignee_name" FROM top_3_assignees)
    GROUP BY
        "assignee_name", "filing_year"
),
top_year_per_assignee AS (
    SELECT
        "assignee_name",
        "filing_year" AS "year_with_most_applications",
        "number_of_applications_in_that_year"
    FROM (
        SELECT
            "assignee_name",
            "filing_year",
            "number_of_applications_in_that_year",
            ROW_NUMBER() OVER (PARTITION BY "assignee_name" ORDER BY "number_of_applications_in_that_year" DESC NULLS LAST, "filing_year") AS rn
        FROM
            apps_per_assignee_year
    )
    WHERE
        rn = 1
),
data_for_top_years AS (
    SELECT
        bd."assignee_name",
        bd."filing_year",
        bd."country_code",
        bd."application_number"
    FROM
        base_data bd
        INNER JOIN top_year_per_assignee ty
            ON bd."assignee_name" = ty."assignee_name"
            AND bd."filing_year" = ty."year_with_most_applications"
),
apps_per_country_code AS (
    SELECT
        "assignee_name",
        "country_code",
        COUNT(DISTINCT "application_number") AS "applications_in_country"
    FROM
        data_for_top_years
    GROUP BY
        "assignee_name", "country_code"
),
top_country_per_assignee AS (
    SELECT
        "assignee_name",
        "country_code" AS "country_code_with_most_applications_in_that_year"
    FROM (
        SELECT
            "assignee_name",
            "country_code",
            ROW_NUMBER() OVER (PARTITION BY "assignee_name" ORDER BY "applications_in_country" DESC NULLS LAST) AS rn
        FROM
            apps_per_country_code
    )
    WHERE
        rn = 1
)
SELECT
    t3a."assignee_name",
    t3a."total_number_of_applications",
    typa."year_with_most_applications",
    typa."number_of_applications_in_that_year",
    tcpa."country_code_with_most_applications_in_that_year"
FROM
    top_3_assignees t3a
    INNER JOIN top_year_per_assignee typa ON t3a."assignee_name" = typa."assignee_name"
    INNER JOIN top_country_per_assignee tcpa ON t3a."assignee_name" = tcpa."assignee_name"
ORDER BY
    t3a."total_number_of_applications" DESC NULLS LAST;When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'

2025-01-16 07:15:50 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 07:15:50 - root - INFO - ```sql
WITH base_data AS (
    SELECT
        a.value::VARIANT:"name"::STRING AS "assignee_name",
        TO_CHAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year",
        t."application_number" AS "application_number",
        t."country_code" AS "country_code"
    FROM
        PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE
        SUBSTRING(c.value::VARIANT:"code"::STRING, 1, 5) = 'A01B3'
        AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
        AND a.value::VARIANT:"name"::STRING IS NOT NULL
),
total_apps_per_assignee AS (
    SELECT
        "assignee_name",
        COUNT(DISTINCT "application_number") AS "total_number_of_applications"
    FROM
        base_data
    GROUP BY
        "assignee_name"
),
top_3_assignees AS (
    SELECT
        "assignee_name",
        "total_number_of_applications"
    FROM (
        SELECT
            "assignee_name",
            "total_number_of_applications",
            ROW_NUMBER() OVER (ORDER BY "total_number_of_applications" DESC NULLS LAST) AS rn
        FROM
            total_apps_per_assignee
    )
    WHERE
        rn <= 3
),
apps_per_assignee_year AS (
    SELECT
        "assignee_name",
        "filing_year",
        COUNT(DISTINCT "application_number") AS "number_of_applications_in_that_year"
    FROM
        base_data
    WHERE
        "assignee_name" IN (SELECT "assignee_name" FROM top_3_assignees)
    GROUP BY
        "assignee_name", "filing_year"
),
top_year_per_assignee AS (
    SELECT
        "assignee_name",
        "filing_year" AS "year_with_most_applications",
        "number_of_applications_in_that_year"
    FROM (
        SELECT
            "assignee_name",
            "filing_year",
            "number_of_applications_in_that_year",
            ROW_NUMBER() OVER (PARTITION BY "assignee_name" ORDER BY "number_of_applications_in_that_year" DESC NULLS LAST, "filing_year") AS rn
        FROM
            apps_per_assignee_year
    )
    WHERE
        rn = 1
),
data_for_top_years AS (
    SELECT
        bd."assignee_name",
        bd."filing_year",
        bd."country_code",
        bd."application_number"
    FROM
        base_data bd
        INNER JOIN top_year_per_assignee ty
            ON bd."assignee_name" = ty."assignee_name"
            AND bd."filing_year" = ty."year_with_most_applications"
),
apps_per_country_code AS (
    SELECT
        "assignee_name",
        "country_code",
        COUNT(DISTINCT "application_number") AS "applications_in_country"
    FROM
        data_for_top_years
    GROUP BY
        "assignee_name", "country_code"
),
top_country_per_assignee AS (
    SELECT
        "assignee_name",
        "country_code" AS "country_code_with_most_applications_in_that_year"
    FROM (
        SELECT
            "assignee_name",
            "country_code",
            ROW_NUMBER() OVER (PARTITION BY "assignee_name" ORDER BY "applications_in_country" DESC NULLS LAST) AS rn
        FROM
            apps_per_country_code
    )
    WHERE
        rn = 1
)
SELECT
    t3a."assignee_name",
    t3a."total_number_of_applications",
    typa."year_with_most_applications",
    typa."number_of_applications_in_that_year",
    tcpa."country_code_with_most_applications_in_that_year"
FROM
    top_3_assignees t3a
    INNER JOIN top_year_per_assignee typa ON t3a."assignee_name" = typa."assignee_name"
    INNER JOIN top_country_per_assignee tcpa ON t3a."assignee_name" = tcpa."assignee_name"
ORDER BY
    t3a."total_number_of_applications" DESC NULLS LAST;
```
2025-01-16 07:15:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 07:15:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 07:15:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 07:15:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-16 07:15:51 - snowflake.connector.connection - INFO - closed
2025-01-16 07:15:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 07:15:52 - root - INFO - itercount: 3
2025-01-16 07:15:52 - root - INFO - 0
2025-01-16 07:15:52 - root - INFO - Total iteration counts: 3
