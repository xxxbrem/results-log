2025-01-16 02:49:52 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 02:50:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 02:50:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 02:50:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 02:50:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 02:50:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 02:50:42 - snowflake.connector.connection - INFO - closed
2025-01-16 02:50:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 02:50:42 - root - INFO - SQL:
SELECT DISTINCT "assignee_harmonized"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 1000;
Results:
Too long, hard cut:
assignee_harmonized
"[
  {
    ""country_code"": """",
    ""name"": ""CHONGQING VOCATIONAL INST ENG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""KUNSHAN ZHUOLIDA PREC METAL PARTS CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""INNER MONGOLIA TONGFANG TECH CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""JIANHU COUNTY XINYUAN ROPE CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""DONGQIANG LIANZHOU COPPER FOIL CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""QINGYUAN ELECTRIC POWER PLANNING AND DESIGN INST CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""SICHUAN ACAD OF MEDICAL SCIENCES SICHUAN PROVINCIAL PEOPLES HOSPITAL""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""JINGJIANG SHENGBLUE POLICE EQUIPMENT MFG CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""LI WENGUANG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""TIAN JINGWEN""
  },
  {
    ""country_code"": """",
    ""name"": ""ZHOU HONGTAO""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""SUZHOU KAIEN YOUHE ENV ENGINEERING CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""SHIWAN KUNLUO YUQING AUTOMOBILE PART LTD COMPANY""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""BEIJING ZERO BIAS TECH CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""JIANGSU WEIZHIZE MARINE BIOLOGICAL TECH CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HEBEI BOYUAN INTELLIGENT AUTOMATION EQUIPMENT CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ZHEJIANG TOPSUN IND GROUP CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""DONGGUAN LONGXIN BIOLOGICAL ENVIRONMENTAL PROTECTION TECH CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""MIANYANG ANFU KONJAK DEV CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""QINGDAO HAIER INTELLIGENT TECHNOLOGY RES & DEV CO LTD""
  },
  {
    ""country_code"": """",
    ""name"": ""HAIER SMART HOME CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""UNIV ZHENGZHOU IND TECH""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""WENZOU WEILI AUX CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""SHENZHEN HENGLITAI TECH CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""SONG YONG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ZHEJIANG HOSPITAL""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""WESTERN DATA TECH COMPANY""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""Lianyungang normal college""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HEFEI LONGTANG MOTOR VEHICLE INSPECTION CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HUNAN TIANLONG INTELLIGENT ELECTROMECHANICAL EQUIPMENT LTD COMPANY""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""SHARED COMPANY OF HIGHLY INT ENGINEERING DECORATION DESIGN GROUP IN BEIJING""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""GENERAL HOSPITAL OF WESTERN THEATER COMMAND OF PLA""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ANHUI 123 ENVIRONMENTAL PROTECTION TECH CO LTD""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""H2GR0 LLC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ROLLING RODENTS LLC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MICRON TECHNOLOGY INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""FORTINET INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ILLINOIS TOOL WORKS""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""PRINCE SPORTS INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""CIBA GEIGY AG""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""KRUPP KOPPERS GMBH""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BIO RAD LABORATORIES""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BACHMANN ALINA""
  }
]"
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""GUANGDONG OPPO MOBILE TELECOMMUNICATIONS CORP LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ANGENIEUX PIERRE""
  }
]"
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""SUZHOU KEDA TECHNOLOGY CO LTD""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BOELLHOFF VERBINDUNGSTECHNIK GMBH""
  }
]"
"[
  {
    ""country_code"": ""DK"",
    ""name"": ""KIRBEK HOLDING APS""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""SYNGENTA CROP PROTECTION AG""
  }
]"
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""TRANSCEIVING SYSTEM TECHNOLOGY""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GAF CORP""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""LEO PHARMA AS""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""RIETER AG MASCHF""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""KEEN PERSONAL MEDIA""
  }
]"
"[
  {
    "

2025-01-16 02:50:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 02:50:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 02:50:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 02:50:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 313
2025-01-16 02:50:45 - snowflake.connector.connection - INFO - closed
2025-01-16 02:50:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 02:50:45 - root - INFO - SQL:
SELECT "publication_number", "cpc"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 1000;
Results:
Too long, hard cut:
publication_number,cpc
CR-5634-A,[]
CR-5990-A,[]
FI-429-A,[]
HK-6083-A,"[
  {
    ""code"": ""H02M5/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
HU-T52763-A,"[
  {
    ""code"": ""A01N47/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D521/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
JP-H03206829-A,"[
  {
    ""code"": ""Y02A40/81"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
JP-S62159089-A,"[
  {
    ""code"": ""Y02E30/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
US-416-A,"[
  {
    ""code"": ""Y10T83/465"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""B26F1/42"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
US-2528225-A,"[
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A41580-A,"[
  {
    ""code"": ""B22D11/086"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A47682-A,"[
  {
    ""code"": ""C07D471/16"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D471/22"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A63682-A,"[
  {
    ""code"": ""G01N33/48728"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-920790-A,"[
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-950907-A,"[
  {
    ""code"": ""C11B5/0064"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/35"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C11B5/0035"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M135/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C09K15/30"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D263/56"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/44"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D235/12"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/3447"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/48"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/46"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D277/64"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/47"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/224"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/102"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/106"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/104"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/10"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/221"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/226"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/225"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/22"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10L1/14"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-920830-A,"[
  {
    ""code"": ""E02D5/808"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/385"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/26"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/28"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/54"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-9086-A,[]
CH-3256-A,[]
CH-540255-A,"[
  {
    ""code"": ""C07D213/32"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/51"",
    ""first"": false,
    ""inven

2025-01-16 02:50:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 02:50:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 02:50:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 02:50:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 02:50:47 - snowflake.connector.connection - INFO - closed
2025-01-16 02:50:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 02:50:47 - root - INFO - SQL:
SELECT DISTINCT "filing_date"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "filing_date" IS NOT NULL
   LIMIT 1000;
Results:
Too long, hard cut:
filing_date
20220705
20050113
19861126
20180910
20050912
20020517
20090126
20030313
20050620
20140602
20100521
20230125
20140430
20220712
20030902
20170330
20211013
20221223
20180925
20210217
20070215
20150225
20090310
20181023
19810812
20200207
20200506
19840521
19830824
19860723
19840821
19930723
19920924
20000926
20041022
20050311
19791023
19480416
19911022
20140226
20180820
19720302
19731015
19960926
20031231
20031021
20200622
19830927
20090731
20000905
19871005
19890327
20110415
20160920
20160811
20170509
20210723
19920706
20171122
19960610
19920821
20110121
20000830
20001117
19800912
19900528
19940929
20010227
20011102
20150413
20000328
20000420
20031202
20041014
20140828
19851104
19961220
20120725
20161003
20080208
20090615
20120912
20100325
20170707
20230724
20010614
20210730
20211110
20220429
20220522
20220730
20230710
20230728
20010829
19990716
19890313
20041106
19840105
20010129
19790913
19990609
19891018
19920904
19701124
20020712
20061229
20111121
20130125
19961218
19861014
20061124
20000513
20021210
20001113
19940103
20030901
19770902
19700415
19860125
19830224
19891026
19811114
19770221
19760525
19640424
19860213
19930527
19920304
20120516
20240227
19730911
19731203
19940319
19851128
20011122
19941108
20131111
20180318
19931103
20020911
20061002
19690214
19990316
20000807
19990526
19701225
19911108
19750724
19890320
19920228
20091006
20211106
20230112
19970715
19980127
19721219
19721226
19820326
19830216
20020724
20161205
20141223
20070219
19870414
19960522
19890725
19870415
20020425
19731019
19990604
19821001
19831007
20000621
19960111
19920813
19840308
19901123
19730710
19780620
19710928
20000512
20240428
19780120
19870309
19740306
19710727
20000121
20101222
20190101
19670522
19991017
19980212
19990813
19860320
19990112
19900116
19840126
19670105
19680419
19640812
19810616
20050219
19760115
19710728
19980722
19700219
19941031
19980307
19561123
19401112
19541222
19490224
19530420
19371122
19640414
19540722
19661201
19500626
19380812
19670705
19570111
19610218
19750113
19381107
19720131
19910819
19880318
19681015
19720228
19681227
19701006
19750801
19741122
19930409
19400420
19610531
19590506
19500330
19541101
19530519
19591204
19510417
19470207
19520621
19390301
19660810
19591029
19270923
19410325
19610209
19390220
19631230
19510801
19520303
19170629
19400410
19670524
19570725
19341006
19370503
19511123
19390407
19730823
19381018
19611025
19140227
19580409
19370915
19630520
19231201
19490512
19710311
19510601
19150105
19340406
19490108
19680322
19010427
19240428
19340411
19620126
20230325
19751205
19640916
19150813
19871023
19700717
19100203
19590925
19250126
19061226
19290311
19680903
19730430
19291118
19100827
19451205
19600725
19871114
19610406
19421219
19070521
19311012
19380126
19290215
19040223
19080723
19670126
19370128
19751105
19740613
19750707
18980429
19640724
19490430
19200616
19020705
19810808
19860717
20140510
20240219
19730602
19580408
19450601
19840724
19821003
19100616
20080711
20060621
20070727
20090420
20140402
20150618
20151112
20120308
20141002
20140630
20170629
20181130
20200309
19801015
19970617
19940908
20211102
20180522
20191004
20220310
19860519
19950429
19930119
20120301
19840128
20050726
20060104
20030606
20090729
20090810
20040227
20040723
20110803
20191203
20200824
20200706
20160830
20211213
20201117
20201211
20230323
20230210
20230518
20230615
20220205
19871217
20060608
19930202
20060516
20151123
20220118
20160311
20190621
20170609
20140327
20190416
20100205
20100913
20191013
20200206
20200806
20190215
20220330
19920225
19680627
20060828
19740323
19730404
20130228
20021024
19920131
19780419
19800604
19661217
20041216
20101203
20170209
20170801
20040113
20060907
20151130
20200507
19620123
20000623
20140113
20120403
19820810
19920610
19950801
19980924
19940831
20011212
20020705
20141009
19771230
20070104
19850212
20210527
20240412
19901015
19970916
19740215
19941219
19950712
20171204
20210407
20100707
20111027
20160201
19960329
19830418
19830602
19760804
19761217
19801219
20121012
20091217
20100408
20220728
20000912
20020226
19630720
19761018
19930426
20230301
19810228
19860905
19941118
19831221
19791107
19641211
19820630
19880928
19771115
19870404
19850814
19941115
20120305
20110819
20021101
19911129
20221220
19991230
20031129
19880119
19880204
19910318
19730901
20080130
20001109
20130712
20041102
20040110
19790627
19880825
19870406
19940601
20020620
20100612
19770927
19741125
19820706
19820924
19960711
19410514
19610721
19900912
19790730
19850122
19870119
19810204
20060916
20150409
20000327
19880602
20080401
19780914
20020110
19880913
19921130
20160528
19720311
19721129
20110421
19630301
20231024
19930920
19881102
19980414
19691128
19390626
19540428
19541216
19540927
19591118
19260508
19191022
19060124
19440303
19680119
19630311
19410312
19570130
19520528
19240909
19530403
19550324
19711011
19830207
19770426
19641031
19990911
19870126
20220108
20231008
20230704
19630409
19750417
19880222
19800327
19780927
19720406
20100410
20210724
19811027
19771206
19820302
20

2025-01-16 02:50:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 02:50:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 02:50:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 02:50:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 02:50:49 - snowflake.connector.connection - INFO - closed
2025-01-16 02:50:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 02:50:50 - root - INFO - SQL:
SELECT DISTINCT f.value::string AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::string LIKE '%A61%'
   LIMIT 1000;
Results:
Too long, hard cut:
cpc_code
"{""code"":""A61P9/10"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B2018/00273"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K8/8152"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61P25/18"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/154"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B2017/00544"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61M2005/3132"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K8/411"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K36/69"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61P5/18"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K2039/70"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61F2220/0075"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B17/025"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/1486"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K51/1093"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61K39/0011"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/6858"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61K8/4926"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61Q1/04"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K31/365"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61C7/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K31/357"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B2017/00805"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61M16/106"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K9/1617"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61L27/3813"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61N2/002"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K47/06"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B17/02"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B2090/306"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61M16/0825"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61L31/10"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61N1/3943"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61F2002/701"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K47/38"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61N1/36062"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61C8/0057"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61K49/0043"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61P21/06"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M1/3655"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M1/362"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/208"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M25/0082"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K8/8182"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M15/00"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B2018/2035"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B5/721"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B17/12"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K49/0021"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M5/31501"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61Q19/002"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K9/28"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61K9/2077"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K47/68"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K31/138"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/0088"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61C17/26"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B2562/0223"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B2560/063"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B5/0002"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/316"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61F2/26"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61B17/00234"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B8/4427"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61B17/3474"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61M2037/003"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A6

2025-01-16 02:50:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 02:50:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 02:50:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 02:50:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 02:50:51 - snowflake.connector.connection - INFO - closed
2025-01-16 02:50:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 02:50:52 - root - INFO - SQL:
SELECT t."publication_number", f.value::string AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::string LIKE '%A61%'
   LIMIT 1000;
Results:
Too long, hard cut:
publication_number,cpc_code
WO-2017120317-A1,"{""code"":""A61M1/3496"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61P39/06"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61P3/02"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61P27/02"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61K9/127"",""first"":true,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61K8/14"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61K31/047"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61K31/047"",""first"":true,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61K8/345"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61K31/047"",""first"":true,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61Q19/00"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61K9/127"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61K9/127"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K8/8152"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K2800/81"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61Q3/02"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K2800/95"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K8/8152"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61Q3/02"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K2800/95"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K2800/81"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K8/55"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K8/37"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K8/28"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61P35/00"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K2039/505"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6881"",""first"":true,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/60"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6849"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6881"",""first"":true,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/60"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61P35/00"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6851"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6881"",""first"":true,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6881"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6851"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6849"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/60"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K2039/505"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61P35/00"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6801"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/60"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61B5/14532"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M5/1723"",""first"":true,""inventive"":true,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M2205/583"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M2205/581"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M5/14244"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M2205/583"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M2205/50"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M5/14244"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M2005/14208"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M5/1723"",""first"":true,""inventive"":true,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M2205/50"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M2205/581"",""first"":false,""inventive"":false,""tree"

2025-01-16 02:50:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 02:50:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 02:50:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 02:50:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 02:50:54 - snowflake.connector.connection - INFO - closed
2025-01-16 02:50:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 02:50:54 - root - INFO - SQL:
SELECT DISTINCT t."assignee_harmonized"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::string LIKE '%A61%'
   LIMIT 1000;
Results:
Too long, hard cut:
assignee_harmonized
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""FRAUNHOFER GES FORSCHUNG""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""GLATT INGTECH GMBH""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""GLATT SYSTEMTECHNIK GMBH""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HOERAUF CHRISTIAN""
  },
  {
    ""country_code"": """",
    ""name"": ""LIST HANS""
  },
  {
    ""country_code"": """",
    ""name"": ""ZIMMER VOLKER""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SAGE THERAPEUTICS INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""JOHNSON & SON INC S C""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""KCI LICENSING INC""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""KCI LICENSINC INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""BIOGEN INC""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""EISAI R&D MAN CO LTD""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""HARVARD COLLEGE""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""SHIRE BIOCHEM INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""TONY R BROWN""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""TCHELINGERIAN JEAN-LEON""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PROTEIN DESIGN LABS INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""REDDY N B BAKTHA""
  },
  {
    ""country_code"": """",
    ""name"": ""REDDY VILAMBI NRK""
  },
  {
    ""country_code"": """",
    ""name"": ""TORGALKAR ANIL""
  },
  {
    ""country_code"": """",
    ""name"": ""MURUGAN N R""
  },
  {
    ""country_code"": """",
    ""name"": ""KUMAR SENTHIL""
  }
]"
"[
  {
    ""country_code"": ""MY"",
    ""name"": ""SAW KHAY YONG""
  },
  {
    ""country_code"": ""MY"",
    ""name"": ""NG REZA CHING SOONG""
  },
  {
    ""country_code"": ""MY"",
    ""name"": ""JEE CAROLINE SIEW YOKE""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SAPIENCE THERAPEUTICS INC""
  }
]"
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""PRODUITS DENTAIRES PIERRE ROLLAND""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""HARTENSTEIN JUSTIN""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""RICOUARD ALVIN B""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""ORGANO TROY""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""HUTCHINSON FRED CANCER RES""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SpecGx LLC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MOMENTA PHARMACEUTICALS INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""NIPPON PETROCHEMICALS CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""RIT RECH IND THERAPEUT""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""BRISTOL MYERS SQUIBB CO""
  }
]"
"[
  {
    ""country_code"": ""BR"",
    ""name"": ""FUND EDUCACIONAL SEVERINO SOMBRA""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""NOVARTIS AG""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ANSON MEDICAL LTD""
  }
]"
"[
  {
    ""country_code"": ""BE"",
    ""name"": ""GLAXOSMITHKLINE BIOLOGICALS SA""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ORTHO MCNEIL PHARM INC""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""ECP ENTW MBH""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""COOK INC""
  },
  {
    ""country_code"": ""AU"",
    ""name"": ""COOK WILLIAM A AUSTRALIA""
  }
]"
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""ENSOL BIOSCIENCES INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""K2M INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV EMORY""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV NORTH CAROLINA STATE""
  }
]"
"[
  {
    ""country_code"": ""KY"",
    ""name"": ""I MAB""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""INDENA SPA""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""WEIGAND HANFRIED DR MED""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""BELLMANN BERNHARD""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""MULLER GERBES HENNING DIPL ING""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""SACK WOLFHARD""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""TEIMERT ING PAUL H""
  }
]"
"[
  {
    ""country_code"": ""BE"",
    ""name"": ""UNIV ANTWERPEN""
  },
  {
    ""country_code"": ""BE"",
    ""name"": ""UNIV ZIEKENHUIS ANTWERPEN""
  },
  {
    ""country_code"": """",
    ""name"": ""VANAUDENAERDE JONAS""
  },
  {
    ""country_code"": """",
    ""name"": ""SMITS EVELIEN""
  },
  {
    ""country_code"": """",
    ""name"": ""PEETERS MARC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""WELLSTAT VACCINES LLC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""MAGGIONI & C SPA""
  }
]"
"[
  {
    ""country_code"": ""DK"",
    ""name"": ""FORWARD PHARMA AS""
  }
]"
"[
  {
    ""country_code"": ""MT"",

2025-01-16 02:50:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 02:50:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 02:50:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 02:50:56 - snowflake.connector.connection - INFO - closed
2025-01-16 02:50:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 02:51:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 02:51:21 - root - INFO - The error you're encountering occurs because some entries in the `"filing_date"` column contain invalid date values that cannot be parsed using the `TO_DATE` function with the format `'YYYYMMDD'`. Specifically, the value `'0'` cannot be interpreted as a valid date in this format.

To resolve this issue, you can use the `TRY_TO_DATE` function instead of `TO_DATE`. The `TRY_TO_DATE` function attempts to parse the date and returns `NULL` if it fails, allowing you to filter out invalid dates.

Here's how you can modify your query:

```sql
SELECT DISTINCT TO_VARCHAR(TRY_TO_DATE(t."filing_date"::string, 'YYYYMMDD'), 'YYYY') AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE TRY_TO_DATE(t."filing_date"::string, 'YYYYMMDD') IS NOT NULL
LIMIT 1000;
```

**Explanation:**

- **`TRY_TO_DATE` Function:** This function attempts to convert a string to a date using the specified format. If the conversion fails (e.g., for invalid date strings like `'0'`), it returns `NULL` instead of throwing an error.
  
- **Filtering Out `NULL` Values:** By adding `WHERE TRY_TO_DATE(t."filing_date"::string, 'YYYYMMDD') IS NOT NULL`, you exclude all records where the filing date could not be parsed (i.e., invalid dates).

**Alternative Solution:**

If you prefer to exclude specific known invalid values, you can adjust the `WHERE` clause accordingly:

```sql
SELECT DISTINCT TO_VARCHAR(TO_DATE(t."filing_date", 'YYYYMMDD'), 'YYYY') AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE t."filing_date" IS NOT NULL
  AND t."filing_date" != '0'
  AND LENGTH(t."filing_date") = 8
LIMIT 1000;
```

In this query:

- **`t."filing_date" != '0'`:** Excludes records where the filing date is `'0'`.
  
- **`LENGTH(t."filing_date") = 8`:** Ensures that only dates with the correct length (8 characters for `'YYYYMMDD'`) are processed.

**Next Steps:**

After adjusting your query, you should be able to retrieve the distinct filing years without encountering the parsing error. This will help you proceed with your analysis to determine the year in which the assignee with the most applications in the patent category `'A61'` filed the most applications.

---

**Note:** Always ensure that date strings conform to the expected format before parsing to prevent errors and ensure data accuracy.
2025-01-16 02:51:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 02:51:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 02:51:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 02:51:22 - snowflake.connector.connection - INFO - closed
2025-01-16 02:51:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 02:51:52 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 02:51:52 - root - INFO - The error you're encountering occurs because the `"filing_date"` column is of type `NUMBER`, and the `TO_DATE` function expects a `STRING` as its first argument. In your query, you're using `t."filing_date"::string`, but the `::string` cast syntax isn't valid in Snowflake SQL. Instead, you should use the `TO_VARCHAR` function to convert the numeric date to a string before parsing it with `TO_DATE`.

**Corrected Query:**

```sql
SELECT DISTINCT TO_VARCHAR(TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE t."filing_date" IS NOT NULL
LIMIT 1000;
```

**Explanation:**

- **`TO_VARCHAR(t."filing_date")`:** Converts the numeric `"filing_date"` to a string so that it can be correctly parsed by the `TO_DATE` function.
  
- **`TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')`:** Parses the string representation of the filing date into a date using the specified format `'YYYYMMDD'`.
  
- **`TO_VARCHAR(..., 'YYYY')`:** Extracts the year from the date and converts it back to a string for display.

**Handling Invalid Dates:**

If there are any invalid dates in the data that cannot be parsed (e.g., incorrect lengths, zero values), it's safer to use the `TRY_TO_DATE` function, which returns `NULL` for invalid dates without raising an error. You can then filter out the `NULL` values.

**Revised Query with `TRY_TO_DATE`:**

```sql
SELECT DISTINCT TO_VARCHAR(TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') IS NOT NULL
LIMIT 1000;
```

**Explanation:**

- **`TRY_TO_DATE(...)`:** Attempts to parse the date and returns `NULL` if it fails. This prevents errors caused by invalid date formats.
  
- **`WHERE TRY_TO_DATE(...) IS NOT NULL`:** Filters out any records where the date could not be parsed.

**Next Steps:**

With the corrected query, you should now be able to retrieve the distinct filing years without encountering the error. This will help you proceed with analyzing which year the assignee with the most applications in the patent category `'A61'` filed the most applications.

**Continuing the Analysis:**

After obtaining the filing years, you can proceed to:

1. Identify the assignee with the most applications in category `'A61'`.
   
2. Count the number of applications filed by this assignee in each year.
   
3. Determine the year with the highest number of filings for this assignee.

**Example Query to Find the Top Assignee and Filing Year:**

```sql
-- Step 1: Find the assignee with the most applications in 'A61'
WITH TopAssignee AS (
  SELECT t."assignee_harmonized", COUNT(*) AS "total_applications"
  FROM PATENTS.PATENTS.PUBLICATIONS t,
       LATERAL FLATTEN(input => t."cpc") f
  WHERE f.value::string LIKE '%A61%'
  GROUP BY t."assignee_harmonized"
  ORDER BY "total_applications" DESC
  LIMIT 1
)

-- Step 2: Find the year in which this assignee filed the most applications in 'A61'
SELECT TO_VARCHAR(TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
       COUNT(*) AS "applications_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") f,
     TopAssignee ta
WHERE t."assignee_harmonized" = ta."assignee_harmonized"
  AND f.value::string LIKE '%A61%'
  AND TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') IS NOT NULL
GROUP BY "filing_year"
ORDER BY "applications_count" DESC
LIMIT 1;
```

**Note:** Remember to adjust the CTE and queries according to your actual data and requirements. Since you might not have the exact assignee names from the previous steps, ensure that the queries are tailored to your dataset.

---

Feel free to run the corrected queries and continue your analysis. If you encounter any further issues or need assistance interpreting the results, let me know!
2025-01-16 02:51:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 02:51:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 02:51:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 02:51:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-16 02:51:54 - snowflake.connector.connection - INFO - closed
2025-01-16 02:51:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 02:51:54 - root - INFO - SQL:
-- Step 1: Find the assignee with the most applications in 'A61'
WITH TopAssignee AS (
  SELECT t."assignee_harmonized", COUNT(*) AS "total_applications"
  FROM PATENTS.PATENTS.PUBLICATIONS t,
       LATERAL FLATTEN(input => t."cpc") f
  WHERE f.value::string LIKE '%A61%'
  GROUP BY t."assignee_harmonized"
  ORDER BY "total_applications" DESC
  LIMIT 1
)

-- Step 2: Find the year in which this assignee filed the most applications in 'A61'
SELECT TO_VARCHAR(TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
       COUNT(*) AS "applications_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") f,
     TopAssignee ta
WHERE t."assignee_harmonized" = ta."assignee_harmonized"
  AND f.value::string LIKE '%A61%'
  AND TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') IS NOT NULL
GROUP BY "filing_year"
ORDER BY "applications_count" DESC
LIMIT 1;
Results:
filing_year,applications_count
2016,3648

2025-01-16 02:51:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 02:51:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 02:51:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 02:51:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 02:51:56 - snowflake.connector.connection - INFO - closed
2025-01-16 02:51:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 02:51:56 - root - INFO - SQL:
SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::string LIKE '%A61%'
   GROUP BY t."assignee_harmonized"
   ORDER BY "application_count" DESC
   LIMIT 1000;
Results:
Too long, hard cut:
assignee_harmonized,application_count
[],56002
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PROCTER & GAMBLE""
  }
]",2302
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""NOVARTIS AG""
  }
]",1629
"[
  {
    ""country_code"": ""US"",
    ""name"": ""COVIDIEN LP""
  }
]",1304
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PFIZER""
  }
]",1279
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""OREAL""
  }
]",1212
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""HOFFMANN LA ROCHE""
  }
]",989
"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV CALIFORNIA""
  }
]",906
"[
  {
    ""country_code"": ""US"",
    ""name"": ""LILLY CO ELI""
  }
]",851
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BECTON DICKINSON CO""
  }
]",847
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BOEHRINGER INGELHEIM INT""
  }
]",829
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""MERCK PATENT GMBH""
  }
]",788
"[
  {
    ""country_code"": ""NL"",
    ""name"": ""KONINKLIJKE PHILIPS NV""
  }
]",784
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASTRAZENECA AB""
  }
]",773
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BRISTOL MYERS SQUIBB CO""
  }
]",746
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ETHICON LLC""
  }
]",700
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BOSTON SCIENT SCIMED INC""
  }
]",695
"[
  {
    ""country_code"": ""US"",
    ""name"": ""COLGATE PALMOLIVE CO""
  }
]",678
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ETHICON ENDO SURGERY INC""
  }
]",647
"[
  {
    ""country_code"": """",
    ""name"": ""PROCTER & GAMBLE""
  }
]",632
"[
  {
    ""country_code"": ""US"",
    ""name"": ""KIMBERLY CLARK CO""
  }
]",627
"[
  {
    ""country_code"": ""BE"",
    ""name"": ""JANSSEN PHARMACEUTICA NV""
  }
]",611
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GENENTECH INC""
  }
]",572
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""IMMATICS BIOTECHNOLOGIES GMBH""
  }
]",569
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""CILAG GMBH INT""
  }
]",568
"[
  {
    ""country_code"": ""US"",
    ""name"": ""AMGEN INC""
  }
]",564
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MEDTRONIC INC""
  }
]",563
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""OLYMPUS CORP""
  }
]",552
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""SANOFI AVENTIS DEUTSCHLAND""
  }
]",548
"[
  {
    ""country_code"": ""US"",
    ""name"": ""VERTEX PHARMA""
  }
]",542
"[
  {
    ""country_code"": ""NZ"",
    ""name"": ""FISHER & PAYKEL HEALTHCARE LTD""
  }
]",535
"[
  {
    ""country_code"": ""US"",
    ""name"": ""EDWARDS LIFESCIENCES CORP""
  }
]",526
"[
  {
    ""country_code"": """",
    ""name"": ""OREAL""
  }
]",525
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",491
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ABBVIE INC""
  }
]",462
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ALLERGAN INC""
  }
]",447
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SMITH & NEPHEW INC""
  }
]",438
"[
  {
    ""country_code"": """",
    ""name"": ""HOFFMANN LA ROCHE""
  }
]",437
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""SMITH & NEPHEW""
  }
]",419
"[
  {
    ""country_code"": ""IL"",
    ""name"": ""BIOSENSE WEBSTER ISRAEL LTD""
  }
]",417
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""TERUMO CORP""
  }
]",406
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GEN ELECTRIC""
  }
]",391
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ETHICON INC""
  }
]",389
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""MEDOS INT SARL""
  }
]",388
"[
  {
    ""country_code"": ""US"",
    ""name"": ""INCYTE CORP""
  }
]",386
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""ALCON INC""
  }
]",383
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SMITHKLINE BEECHAM CORP""
  }
]",379
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""SANOFI SA""
  }
]",363
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""SANOFI AVENTIS""
  }
]",348
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""FUJIFILM CORP""
  }
]",346
"[
  {
    ""country_code"": ""US"",
    ""name"": ""KCI LICENSING INC""
  }
]",344
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""GRUENENTHAL GMBH""
  }
]",342
"[
  {
    ""country_code"": ""US"",
    ""name"": ""DEPUY SYNTHES PRODUCTS INC""
  }
]",342
"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV LELAND STANFORD JUNIOR""
  }
]",339
"[
  {
    ""country_code"": """",
    ""name"": ""COLGATE PALMOLIVE CO""
  }
]",334
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PFIZER PROD INC""
  }
]",330
"[
  {
    ""country_code"": ""US"",
    ""name"": ""REGENERON PHARMA""
  }
]",324
"[
  {
    ""country_code"": ""PR"",
    ""name"": ""ETHICON LLC""
  }
]",322
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GILEAD SCIENCES INC""
  }
]",317
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GLOBUS MEDICAL INC""
  }
]",316
"[
  {
    ""country_code"": "

2025-01-16 02:51:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 02:51:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 02:51:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 02:51:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-16 02:51:57 - snowflake.connector.connection - INFO - closed
2025-01-16 02:51:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 02:52:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 02:52:40 - root - INFO - ```sql
-- Adjusted SQL Query:

-- Find the year in which the assignee with the most applications in 'A61' filed the most applications

SELECT TOP 1
    TO_VARCHAR(TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
    f_assignee.value::variant:"name"::string AS "assignee_name",
    COUNT(*) AS "applications_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") f_cpc,
     LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee
WHERE f_cpc.value::string LIKE '%A61%'
  AND TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') IS NOT NULL
GROUP BY "filing_year", "assignee_name"
ORDER BY "applications_count" DESC
LIMIT 1;
```
2025-01-16 02:52:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 02:52:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 02:52:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 02:52:41 - snowflake.connector.connection - INFO - closed
2025-01-16 02:52:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 02:53:23 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 02:53:23 - root - INFO - ```sql
SELECT TO_VARCHAR(TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
       COUNT(*) AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") f_cpc,
     LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee
WHERE f_assignee.value:"name"::string = 'SPECIFIC_ASSIGNEE'
  AND f_cpc.value::string LIKE '%A61%'
  AND TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') IS NOT NULL
GROUP BY "filing_year"
ORDER BY "filing_year" DESC;
```
2025-01-16 02:53:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 02:53:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 02:53:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 02:53:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-16 02:53:25 - snowflake.connector.connection - INFO - closed
2025-01-16 02:53:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 02:54:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 02:54:25 - root - INFO - ```sql
SELECT
  TO_VARCHAR(TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
  COUNT(*) AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee,
     LATERAL FLATTEN(input => t."cpc") f_cpc
WHERE f_assignee.value:"name"::string = 'PROCTER & GAMBLE'
  AND f_cpc.value:"code"::string LIKE 'A61%'
  AND TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') IS NOT NULL
GROUP BY "filing_year"
ORDER BY "application_count" DESC
LIMIT 1;
```
2025-01-16 02:54:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 02:54:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 02:54:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 02:54:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-16 02:54:27 - snowflake.connector.connection - INFO - closed
2025-01-16 02:54:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 02:54:27 - root - INFO - SQL:
SELECT
  TO_VARCHAR(TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
  COUNT(*) AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee,
     LATERAL FLATTEN(input => t."cpc") f_cpc
WHERE f_assignee.value:"name"::string = 'PROCTER & GAMBLE'
  AND f_cpc.value:"code"::string LIKE 'A61%'
  AND TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') IS NOT NULL
GROUP BY "filing_year"
ORDER BY "application_count" DESC
LIMIT 1;
Results:
filing_year,application_count
1997,271

2025-01-16 02:54:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 02:54:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 02:54:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 02:54:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-16 02:54:28 - snowflake.connector.connection - INFO - closed
2025-01-16 02:54:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 02:54:29 - root - INFO - SQL:
SELECT t."assignee_harmonized", COUNT(*) AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::string LIKE '%A61%'
    GROUP BY t."assignee_harmonized"
    ORDER BY "total_applications" DESC
    LIMIT 1;
Results:
assignee_harmonized,total_applications
[],56002

2025-01-16 02:54:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 02:54:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 02:54:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 02:54:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-16 02:54:30 - snowflake.connector.connection - INFO - closed
2025-01-16 02:54:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 02:55:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 02:55:17 - root - INFO - ```sql
SELECT
  TO_VARCHAR(TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
  f_assignee.value:"name"::string AS "assignee_name",
  COUNT(*) AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee,
     LATERAL FLATTEN(input => t."cpc") f_cpc
WHERE f_cpc.value:"code"::string LIKE 'A61%'
GROUP BY "filing_year", "assignee_name"
ORDER BY "application_count" DESC
LIMIT 1;
```
2025-01-16 02:55:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 02:55:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 02:55:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 02:55:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-16 02:55:18 - snowflake.connector.connection - INFO - closed
2025-01-16 02:55:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 02:55:19 - root - INFO - SQL:
SELECT
  TO_VARCHAR(TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
  f_assignee.value:"name"::string AS "assignee_name",
  COUNT(*) AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee,
     LATERAL FLATTEN(input => t."cpc") f_cpc
WHERE f_cpc.value:"code"::string LIKE 'A61%'
GROUP BY "filing_year", "assignee_name"
ORDER BY "application_count" DESC
LIMIT 1;
Results:
filing_year,assignee_name,application_count
2017,ETHICON LLC,414

2025-01-16 02:55:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 02:55:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 02:55:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 02:55:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 02:55:20 - snowflake.connector.connection - INFO - closed
2025-01-16 02:55:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 02:55:21 - root - INFO - SQL:
SELECT t."publication_number", t."filing_date"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::string LIKE '%A61%'
    LIMIT 1000;
Results:
Too long, hard cut:
publication_number,filing_date
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017247327-A1,20170313
US-2017247327-A1,20170313
US-2017247327-A1,20170313
US-2018282042-A1,20170331
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017275886-A1,20150811
US-2017275886-A1,20150811
US-2017275886-A1,20150811
US-2017275886-A1,20150811
US-2017275886-A1,20150811
US-2017275886-A1,20150811
US-2017275886-A1,20150811
US-2017275886-A1,20150811
US-2017275886-A1,20150811
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2017342060-A1,20170524
US-2017342060-A1,20170524
US-2017342060-A1,20170524
US-2017342060-A1,20170524
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-

2025-01-16 02:55:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 02:55:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 02:55:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 02:55:22 - snowflake.connector.connection - INFO - closed
2025-01-16 02:55:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 02:56:03 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 02:56:03 - root - INFO - ```sql
SELECT TO_VARCHAR(TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
       COUNT(*) AS "applications_in_A61"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") f
WHERE f.value:"code"::string LIKE 'A61%'
  AND TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') IS NOT NULL
GROUP BY "filing_year"
ORDER BY "applications_in_A61" DESC
LIMIT 1;
```
2025-01-16 02:56:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 02:56:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 02:56:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 02:56:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-16 02:56:05 - snowflake.connector.connection - INFO - closed
2025-01-16 02:56:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 02:56:05 - root - INFO - SQL:
SELECT TO_VARCHAR(TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
       COUNT(*) AS "applications_in_A61"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") f
WHERE f.value:"code"::string LIKE 'A61%'
  AND TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') IS NOT NULL
GROUP BY "filing_year"
ORDER BY "applications_in_A61" DESC
LIMIT 1;
Results:
filing_year,applications_in_A61
2017,26227

2025-01-16 02:56:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 02:56:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 02:56:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 02:56:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-16 02:56:07 - snowflake.connector.connection - INFO - closed
2025-01-16 02:56:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 02:56:42 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 02:56:42 - root - INFO - ```sql
SELECT 
  TO_VARCHAR(TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
  COUNT(*) AS "applications_in_A61"
FROM 
  PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."cpc") f
WHERE 
  f.value::string LIKE '%A61%'
  AND TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') IS NOT NULL
GROUP BY 
  "filing_year"
ORDER BY 
  "applications_in_A61" DESC
LIMIT 1;
```
2025-01-16 02:56:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 02:56:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 02:56:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 02:56:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-16 02:56:43 - snowflake.connector.connection - INFO - closed
2025-01-16 02:56:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 02:56:44 - root - INFO - SQL:
SELECT 
  TO_VARCHAR(TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
  COUNT(*) AS "applications_in_A61"
FROM 
  PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."cpc") f
WHERE 
  f.value::string LIKE '%A61%'
  AND TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') IS NOT NULL
GROUP BY 
  "filing_year"
ORDER BY 
  "applications_in_A61" DESC
LIMIT 1;
Results:
filing_year,applications_in_A61
2017,26227

2025-01-16 02:56:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 02:56:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 02:56:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 02:56:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-16 02:56:45 - snowflake.connector.connection - INFO - closed
2025-01-16 02:56:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 02:57:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 02:57:17 - root - INFO - ```sql
SELECT 
  TO_VARCHAR(TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
  COUNT(*) AS "applications_in_A61"
FROM 
  PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."cpc") f
WHERE 
  f.value:"code"::string LIKE '%A61%'
  AND TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') IS NOT NULL
GROUP BY 
  "filing_year"
ORDER BY 
  "applications_in_A61" DESC
LIMIT 1;
```
2025-01-16 02:57:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 02:57:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 02:57:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 02:57:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-16 02:57:19 - snowflake.connector.connection - INFO - closed
2025-01-16 02:57:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 02:57:19 - root - INFO - SQL:
SELECT 
  TO_VARCHAR(TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
  COUNT(*) AS "applications_in_A61"
FROM 
  PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."cpc") f
WHERE 
  f.value:"code"::string LIKE '%A61%'
  AND TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') IS NOT NULL
GROUP BY 
  "filing_year"
ORDER BY 
  "applications_in_A61" DESC
LIMIT 1;
Results:
filing_year,applications_in_A61
2017,26227

2025-01-16 02:57:19 - root - INFO - itercount: 0
2025-01-16 02:57:19 - root - INFO - Database Name: PATENTS
Schema Name: PATENTS
DDL describes table information.
,0
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,1
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""spif_publication_number"" VARCHAR(16777216),
	""spif_application_number"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""claims_localized_html"" VARIANT,
	""description_localized"" VARIANT,
	""description_localized_html"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""locarno"" VARIANT,
	""citation"" VARIANT,
	""parent"" VARIANT,
	""child"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,2
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table**: `PATENTS.PATENTS.PUBLICATIONS`

  - **"assignee_harmonized"**: Potential usage - To identify assignee names in a standardized format.
  
  - **"cpc"**: Potential usage - To find patents classified under category 'A61' in the Cooperative Patent Classification system.
  
  - **"filing_date"**: Potential usage - To extract the filing dates of applications and determine the filing year.
  
- **Conditions**:

  - Filter records where the "cpc" classification includes 'A61'.
  
  - Group data by "assignee_harmonized" and filing year to count applications per assignee per year.

---

**SQL Queries:**

1. **Get a list of distinct assignees (harmonized):**

   ```sql
   SELECT DISTINCT "assignee_harmonized"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 1000;
   ```

2. **Preview the "cpc" column for sample records:**

   ```sql
   SELECT "publication_number", "cpc"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 1000;
   ```

3. **Retrieve distinct filing dates:**

   ```sql
   SELECT DISTINCT "filing_date"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "filing_date" IS NOT NULL
   LIMIT 1000;
   ```

4. **Extract "cpc" codes containing 'A61':**

   ```sql
   SELECT DISTINCT f.value::string AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::string LIKE '%A61%'
   LIMIT 1000;
   ```

5. **List publications with "cpc" codes in 'A61':**

   ```sql
   SELECT t."publication_number", f.value::string AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::string LIKE '%A61%'
   LIMIT 1000;
   ```

6. **Find assignees with patents classified under 'A61':**

   ```sql
   SELECT DISTINCT t."assignee_harmonized"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::string LIKE '%A61%'
   LIMIT 1000;
   ```

7. **Extract filing years from filing dates:**

   ```sql
   SELECT DISTINCT TO_VARCHAR(TO_DATE(t."filing_date"::string, 'YYYYMMDD'), 'YYYY') AS "filing_year"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   WHERE t."filing_date" IS NOT NULL
   LIMIT 1000;
   ```

8. **Count applications per assignee in category 'A61':**

   ```sql
   SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::string LIKE '%A61%'
   GROUP BY t."assignee_harmonized"
   ORDER BY "application_count" DESC
   LIMIT 1000;
   ```

9. **Get the filing years and application counts for a specific assignee in 'A61':**

   ```sql
   SELECT TO_VARCHAR(TO_DATE(t."filing_date"::string, 'YYYYMMDD'), 'YYYY') AS "filing_year", COUNT(*) AS "application_count"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE t."assignee_harmonized" = 'SPECIFIC_ASSIGNEE' AND f.value::string LIKE '%A61%'
   GROUP BY "filing_year"
   ORDER BY "filing_year" DESC
   LIMIT 1000;
   ```

10. **Identify the assignee with the most applications in 'A61':**

    ```sql
    SELECT t."assignee_harmonized", COUNT(*) AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::string LIKE '%A61%'
    GROUP BY t."assignee_harmonized"
    ORDER BY "total_applications" DESC
    LIMIT 1;
    ```

11. **List all filing years and counts for the top assignee in 'A61':**

    ```sql
    SELECT TO_VARCHAR(TO_DATE(t."filing_date"::string, 'YYYYMMDD'), 'YYYY') AS "filing_year", COUNT(*) AS "application_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") f
    WHERE t."assignee_harmonized" = 'TOP_ASSIGNEE' AND f.value::string LIKE '%A61%'
    GROUP BY "filing_year"
    ORDER BY "filing_year" DESC
    LIMIT 1000;
    ```

12. **Retrieve publication numbers and filing dates for patents in 'A61':**

    ```sql
    SELECT t."publication_number", t."filing_date"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::string LIKE '%A61%'
    LIMIT 1000;
    ```

13. **Get a count of applications per year in 'A61' category:**

    ```sql
    SELECT TO_VARCHAR(TO_DATE(t."filing_date"::string, 'YYYYMMDD'), 'YYYY') AS "filing_year", COUNT(*) AS "applications_in_A61"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::string LIKE '%A61%'
    GROUP BY "filing_year"
    ORDER BY "filing_year" DESC
    LIMIT 1000;
    ```

14. **Find distinct "cpc" codes for a given assignee:**

    ```sql
    SELECT DISTINCT f.value::string AS "cpc_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") f
    WHERE t."assignee_harmonized" = 'SPECIFIC_ASSIGNEE'
    LIMIT 1000;
    ```

15. **List inventors associated with the top assignee in 'A61':**

    ```sql
    SELECT DISTINCT t."inventor_harmonized"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") f
    WHERE t."assignee_harmonized" = 'TOP_ASSIGNEE' AND f.value::string LIKE '%A61%'
    LIMIT 1000;
    ```

---

These queries help in understanding the data and exploring the values in the relevant columns to address the task.Query:
SELECT DISTINCT "assignee_harmonized"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 1000;
Answer:
Too long, hard cut:
assignee_harmonized
"[
  {
    ""country_code"": """",
    ""name"": ""CHONGQING VOCATIONAL INST ENG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""KUNSHAN ZHUOLIDA PREC METAL PARTS CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""INNER MONGOLIA TONGFANG TECH CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""JIANHU COUNTY XINYUAN ROPE CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""DONGQIANG LIANZHOU COPPER FOIL CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""QINGYUAN ELECTRIC POWER PLANNING AND DESIGN INST CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""SICHUAN ACAD OF MEDICAL SCIENCES SICHUAN PROVINCIAL PEOPLES HOSPITAL""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""JINGJIANG SHENGBLUE POLICE EQUIPMENT MFG CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""LI WENGUANG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""TIAN JINGWEN""
  },
  {
    ""country_code"": """",
    ""name"": ""ZHOU HONGTAO""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""SUZHOU KAIEN YOUHE ENV ENGINEERING CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""SHIWAN KUNLUO YUQING AUTOMOBILE PART LTD COMPANY""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""BEIJING ZERO BIAS TECH CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""JIANGSU WEIZHIZE MARINE BIOLOGICAL TECH CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HEBEI BOYUAN INTELLIGENT AUTOMATION EQUIPMENT CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ZHEJIANG TOPSUN IND GROUP CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""DONGGUAN LONGXIN BIOLOGICAL ENVIRONMENTAL PROTECTION TECH CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""MIANYANG ANFU KONJAK DEV CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""QINGDAO HAIER INTELLIGENT TECHNOLOGY RES & DEV CO LTD""
  },
  {
    ""country_code"": """",
    ""name"": ""HAIER SMART HOME CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""UNIV ZHENGZHOU IND TECH""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""WENZOU WEILI AUX CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""SHENZHEN HENGLITAI TECH CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""SONG YONG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ZHEJIANG HOSPITAL""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""WESTERN DATA TECH COMPANY""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""Lianyungang normal college""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HEFEI LONGTANG MOTOR VEHICLE INSPECTION CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HUNAN TIANLONG INTELLIGENT ELECTROMECHANICAL EQUIPMENT LTD COMPANY""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""SHARED COMPANY OF HIGHLY INT ENGINEERING DECORATION DESIGN GROUP IN BEIJING""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""GENERAL HOSPITAL OF WESTERN THEATER COMMAND OF PLA""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ANHUI 123 ENVIRONMENTAL PROTECTION TECH CO LTD""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""H2GR0 LLC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ROLLING RODENTS LLC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MICRON TECHNOLOGY INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""FORTINET INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ILLINOIS TOOL WORKS""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""PRINCE SPORTS INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""CIBA GEIGY AG""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""KRUPP KOPPERS GMBH""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BIO RAD LABORATORIES""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BACHMANN ALINA""
  }
]"
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""GUANGDONG OPPO MOBILE TELECOMMUNICATIONS CORP LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ANGENIEUX PIERRE""
  }
]"
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""SUZHOU KEDA TECHNOLOGY CO LTD""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BOELLHOFF VERBINDUNGSTECHNIK GMBH""
  }
]"
"[
  {
    ""country_code"": ""DK"",
    ""name"": ""KIRBEK HOLDING APS""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""SYNGENTA CROP PROTECTION AG""
  }
]"
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""TRANSCEIVING SYSTEM TECHNOLOGY""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GAF CORP""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""LEO PHARMA AS""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""RIETER AG MASCHF""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""KEEN PERSONAL MEDIA""
  }
]"
"[
  {
    "
Query:
SELECT "publication_number", "cpc"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,cpc
CR-5634-A,[]
CR-5990-A,[]
FI-429-A,[]
HK-6083-A,"[
  {
    ""code"": ""H02M5/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
HU-T52763-A,"[
  {
    ""code"": ""A01N47/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D521/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
JP-H03206829-A,"[
  {
    ""code"": ""Y02A40/81"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
JP-S62159089-A,"[
  {
    ""code"": ""Y02E30/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
US-416-A,"[
  {
    ""code"": ""Y10T83/465"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""B26F1/42"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
US-2528225-A,"[
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A41580-A,"[
  {
    ""code"": ""B22D11/086"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A47682-A,"[
  {
    ""code"": ""C07D471/16"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D471/22"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A63682-A,"[
  {
    ""code"": ""G01N33/48728"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-920790-A,"[
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-950907-A,"[
  {
    ""code"": ""C11B5/0064"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/35"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C11B5/0035"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M135/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C09K15/30"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D263/56"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/44"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D235/12"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/3447"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/48"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/46"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D277/64"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/47"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/224"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/102"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/106"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/104"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/10"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/221"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/226"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/225"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/22"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10L1/14"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-920830-A,"[
  {
    ""code"": ""E02D5/808"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/385"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/26"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/28"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/54"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-9086-A,[]
CH-3256-A,[]
CH-540255-A,"[
  {
    ""code"": ""C07D213/32"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/51"",
    ""first"": false,
    ""inven
Query:
SELECT DISTINCT "filing_date"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "filing_date" IS NOT NULL
   LIMIT 1000;
Answer:
Too long, hard cut:
filing_date
20220705
20050113
19861126
20180910
20050912
20020517
20090126
20030313
20050620
20140602
20100521
20230125
20140430
20220712
20030902
20170330
20211013
20221223
20180925
20210217
20070215
20150225
20090310
20181023
19810812
20200207
20200506
19840521
19830824
19860723
19840821
19930723
19920924
20000926
20041022
20050311
19791023
19480416
19911022
20140226
20180820
19720302
19731015
19960926
20031231
20031021
20200622
19830927
20090731
20000905
19871005
19890327
20110415
20160920
20160811
20170509
20210723
19920706
20171122
19960610
19920821
20110121
20000830
20001117
19800912
19900528
19940929
20010227
20011102
20150413
20000328
20000420
20031202
20041014
20140828
19851104
19961220
20120725
20161003
20080208
20090615
20120912
20100325
20170707
20230724
20010614
20210730
20211110
20220429
20220522
20220730
20230710
20230728
20010829
19990716
19890313
20041106
19840105
20010129
19790913
19990609
19891018
19920904
19701124
20020712
20061229
20111121
20130125
19961218
19861014
20061124
20000513
20021210
20001113
19940103
20030901
19770902
19700415
19860125
19830224
19891026
19811114
19770221
19760525
19640424
19860213
19930527
19920304
20120516
20240227
19730911
19731203
19940319
19851128
20011122
19941108
20131111
20180318
19931103
20020911
20061002
19690214
19990316
20000807
19990526
19701225
19911108
19750724
19890320
19920228
20091006
20211106
20230112
19970715
19980127
19721219
19721226
19820326
19830216
20020724
20161205
20141223
20070219
19870414
19960522
19890725
19870415
20020425
19731019
19990604
19821001
19831007
20000621
19960111
19920813
19840308
19901123
19730710
19780620
19710928
20000512
20240428
19780120
19870309
19740306
19710727
20000121
20101222
20190101
19670522
19991017
19980212
19990813
19860320
19990112
19900116
19840126
19670105
19680419
19640812
19810616
20050219
19760115
19710728
19980722
19700219
19941031
19980307
19561123
19401112
19541222
19490224
19530420
19371122
19640414
19540722
19661201
19500626
19380812
19670705
19570111
19610218
19750113
19381107
19720131
19910819
19880318
19681015
19720228
19681227
19701006
19750801
19741122
19930409
19400420
19610531
19590506
19500330
19541101
19530519
19591204
19510417
19470207
19520621
19390301
19660810
19591029
19270923
19410325
19610209
19390220
19631230
19510801
19520303
19170629
19400410
19670524
19570725
19341006
19370503
19511123
19390407
19730823
19381018
19611025
19140227
19580409
19370915
19630520
19231201
19490512
19710311
19510601
19150105
19340406
19490108
19680322
19010427
19240428
19340411
19620126
20230325
19751205
19640916
19150813
19871023
19700717
19100203
19590925
19250126
19061226
19290311
19680903
19730430
19291118
19100827
19451205
19600725
19871114
19610406
19421219
19070521
19311012
19380126
19290215
19040223
19080723
19670126
19370128
19751105
19740613
19750707
18980429
19640724
19490430
19200616
19020705
19810808
19860717
20140510
20240219
19730602
19580408
19450601
19840724
19821003
19100616
20080711
20060621
20070727
20090420
20140402
20150618
20151112
20120308
20141002
20140630
20170629
20181130
20200309
19801015
19970617
19940908
20211102
20180522
20191004
20220310
19860519
19950429
19930119
20120301
19840128
20050726
20060104
20030606
20090729
20090810
20040227
20040723
20110803
20191203
20200824
20200706
20160830
20211213
20201117
20201211
20230323
20230210
20230518
20230615
20220205
19871217
20060608
19930202
20060516
20151123
20220118
20160311
20190621
20170609
20140327
20190416
20100205
20100913
20191013
20200206
20200806
20190215
20220330
19920225
19680627
20060828
19740323
19730404
20130228
20021024
19920131
19780419
19800604
19661217
20041216
20101203
20170209
20170801
20040113
20060907
20151130
20200507
19620123
20000623
20140113
20120403
19820810
19920610
19950801
19980924
19940831
20011212
20020705
20141009
19771230
20070104
19850212
20210527
20240412
19901015
19970916
19740215
19941219
19950712
20171204
20210407
20100707
20111027
20160201
19960329
19830418
19830602
19760804
19761217
19801219
20121012
20091217
20100408
20220728
20000912
20020226
19630720
19761018
19930426
20230301
19810228
19860905
19941118
19831221
19791107
19641211
19820630
19880928
19771115
19870404
19850814
19941115
20120305
20110819
20021101
19911129
20221220
19991230
20031129
19880119
19880204
19910318
19730901
20080130
20001109
20130712
20041102
20040110
19790627
19880825
19870406
19940601
20020620
20100612
19770927
19741125
19820706
19820924
19960711
19410514
19610721
19900912
19790730
19850122
19870119
19810204
20060916
20150409
20000327
19880602
20080401
19780914
20020110
19880913
19921130
20160528
19720311
19721129
20110421
19630301
20231024
19930920
19881102
19980414
19691128
19390626
19540428
19541216
19540927
19591118
19260508
19191022
19060124
19440303
19680119
19630311
19410312
19570130
19520528
19240909
19530403
19550324
19711011
19830207
19770426
19641031
19990911
19870126
20220108
20231008
20230704
19630409
19750417
19880222
19800327
19780927
19720406
20100410
20210724
19811027
19771206
19820302
20
Query:
SELECT DISTINCT f.value::string AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::string LIKE '%A61%'
   LIMIT 1000;
Answer:
Too long, hard cut:
cpc_code
"{""code"":""A61P9/10"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B2018/00273"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K8/8152"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61P25/18"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/154"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B2017/00544"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61M2005/3132"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K8/411"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K36/69"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61P5/18"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K2039/70"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61F2220/0075"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B17/025"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/1486"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K51/1093"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61K39/0011"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/6858"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61K8/4926"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61Q1/04"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K31/365"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61C7/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K31/357"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B2017/00805"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61M16/106"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K9/1617"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61L27/3813"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61N2/002"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K47/06"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B17/02"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B2090/306"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61M16/0825"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61L31/10"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61N1/3943"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61F2002/701"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K47/38"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61N1/36062"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61C8/0057"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61K49/0043"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61P21/06"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M1/3655"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M1/362"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/208"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M25/0082"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K8/8182"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M15/00"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B2018/2035"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B5/721"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B17/12"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K49/0021"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M5/31501"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61Q19/002"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K9/28"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61K9/2077"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K47/68"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K31/138"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/0088"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61C17/26"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B2562/0223"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B2560/063"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B5/0002"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/316"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61F2/26"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61B17/00234"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B8/4427"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61B17/3474"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61M2037/003"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A6
Query:
SELECT t."publication_number", f.value::string AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::string LIKE '%A61%'
   LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,cpc_code
WO-2017120317-A1,"{""code"":""A61M1/3496"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61P39/06"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61P3/02"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61P27/02"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61K9/127"",""first"":true,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61K8/14"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61K31/047"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61K31/047"",""first"":true,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61K8/345"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61K31/047"",""first"":true,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61Q19/00"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61K9/127"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61K9/127"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K8/8152"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K2800/81"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61Q3/02"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K2800/95"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K8/8152"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61Q3/02"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K2800/95"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K2800/81"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K8/55"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K8/37"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K8/28"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61P35/00"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K2039/505"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6881"",""first"":true,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/60"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6849"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6881"",""first"":true,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/60"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61P35/00"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6851"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6881"",""first"":true,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6881"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6851"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6849"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/60"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K2039/505"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61P35/00"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6801"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/60"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61B5/14532"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M5/1723"",""first"":true,""inventive"":true,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M2205/583"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M2205/581"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M5/14244"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M2205/583"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M2205/50"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M5/14244"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M2005/14208"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M5/1723"",""first"":true,""inventive"":true,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M2205/50"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M2205/581"",""first"":false,""inventive"":false,""tree"
Query:
SELECT DISTINCT t."assignee_harmonized"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::string LIKE '%A61%'
   LIMIT 1000;
Answer:
Too long, hard cut:
assignee_harmonized
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""FRAUNHOFER GES FORSCHUNG""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""GLATT INGTECH GMBH""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""GLATT SYSTEMTECHNIK GMBH""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HOERAUF CHRISTIAN""
  },
  {
    ""country_code"": """",
    ""name"": ""LIST HANS""
  },
  {
    ""country_code"": """",
    ""name"": ""ZIMMER VOLKER""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SAGE THERAPEUTICS INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""JOHNSON & SON INC S C""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""KCI LICENSING INC""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""KCI LICENSINC INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""BIOGEN INC""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""EISAI R&D MAN CO LTD""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""HARVARD COLLEGE""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""SHIRE BIOCHEM INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""TONY R BROWN""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""TCHELINGERIAN JEAN-LEON""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PROTEIN DESIGN LABS INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""REDDY N B BAKTHA""
  },
  {
    ""country_code"": """",
    ""name"": ""REDDY VILAMBI NRK""
  },
  {
    ""country_code"": """",
    ""name"": ""TORGALKAR ANIL""
  },
  {
    ""country_code"": """",
    ""name"": ""MURUGAN N R""
  },
  {
    ""country_code"": """",
    ""name"": ""KUMAR SENTHIL""
  }
]"
"[
  {
    ""country_code"": ""MY"",
    ""name"": ""SAW KHAY YONG""
  },
  {
    ""country_code"": ""MY"",
    ""name"": ""NG REZA CHING SOONG""
  },
  {
    ""country_code"": ""MY"",
    ""name"": ""JEE CAROLINE SIEW YOKE""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SAPIENCE THERAPEUTICS INC""
  }
]"
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""PRODUITS DENTAIRES PIERRE ROLLAND""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""HARTENSTEIN JUSTIN""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""RICOUARD ALVIN B""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""ORGANO TROY""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""HUTCHINSON FRED CANCER RES""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SpecGx LLC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MOMENTA PHARMACEUTICALS INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""NIPPON PETROCHEMICALS CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""RIT RECH IND THERAPEUT""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""BRISTOL MYERS SQUIBB CO""
  }
]"
"[
  {
    ""country_code"": ""BR"",
    ""name"": ""FUND EDUCACIONAL SEVERINO SOMBRA""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""NOVARTIS AG""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ANSON MEDICAL LTD""
  }
]"
"[
  {
    ""country_code"": ""BE"",
    ""name"": ""GLAXOSMITHKLINE BIOLOGICALS SA""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ORTHO MCNEIL PHARM INC""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""ECP ENTW MBH""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""COOK INC""
  },
  {
    ""country_code"": ""AU"",
    ""name"": ""COOK WILLIAM A AUSTRALIA""
  }
]"
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""ENSOL BIOSCIENCES INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""K2M INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV EMORY""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV NORTH CAROLINA STATE""
  }
]"
"[
  {
    ""country_code"": ""KY"",
    ""name"": ""I MAB""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""INDENA SPA""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""WEIGAND HANFRIED DR MED""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""BELLMANN BERNHARD""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""MULLER GERBES HENNING DIPL ING""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""SACK WOLFHARD""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""TEIMERT ING PAUL H""
  }
]"
"[
  {
    ""country_code"": ""BE"",
    ""name"": ""UNIV ANTWERPEN""
  },
  {
    ""country_code"": ""BE"",
    ""name"": ""UNIV ZIEKENHUIS ANTWERPEN""
  },
  {
    ""country_code"": """",
    ""name"": ""VANAUDENAERDE JONAS""
  },
  {
    ""country_code"": """",
    ""name"": ""SMITS EVELIEN""
  },
  {
    ""country_code"": """",
    ""name"": ""PEETERS MARC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""WELLSTAT VACCINES LLC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""MAGGIONI & C SPA""
  }
]"
"[
  {
    ""country_code"": ""DK"",
    ""name"": ""FORWARD PHARMA AS""
  }
]"
"[
  {
    ""country_code"": ""MT"",
Query:
-- Step 1: Find the assignee with the most applications in 'A61'
WITH TopAssignee AS (
  SELECT t."assignee_harmonized", COUNT(*) AS "total_applications"
  FROM PATENTS.PATENTS.PUBLICATIONS t,
       LATERAL FLATTEN(input => t."cpc") f
  WHERE f.value::string LIKE '%A61%'
  GROUP BY t."assignee_harmonized"
  ORDER BY "total_applications" DESC
  LIMIT 1
)

-- Step 2: Find the year in which this assignee filed the most applications in 'A61'
SELECT TO_VARCHAR(TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
       COUNT(*) AS "applications_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") f,
     TopAssignee ta
WHERE t."assignee_harmonized" = ta."assignee_harmonized"
  AND f.value::string LIKE '%A61%'
  AND TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') IS NOT NULL
GROUP BY "filing_year"
ORDER BY "applications_count" DESC
LIMIT 1;
Answer:
filing_year,applications_count
2016,3648
Query:
SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::string LIKE '%A61%'
   GROUP BY t."assignee_harmonized"
   ORDER BY "application_count" DESC
   LIMIT 1000;
Answer:
Too long, hard cut:
assignee_harmonized,application_count
[],56002
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PROCTER & GAMBLE""
  }
]",2302
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""NOVARTIS AG""
  }
]",1629
"[
  {
    ""country_code"": ""US"",
    ""name"": ""COVIDIEN LP""
  }
]",1304
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PFIZER""
  }
]",1279
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""OREAL""
  }
]",1212
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""HOFFMANN LA ROCHE""
  }
]",989
"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV CALIFORNIA""
  }
]",906
"[
  {
    ""country_code"": ""US"",
    ""name"": ""LILLY CO ELI""
  }
]",851
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BECTON DICKINSON CO""
  }
]",847
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BOEHRINGER INGELHEIM INT""
  }
]",829
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""MERCK PATENT GMBH""
  }
]",788
"[
  {
    ""country_code"": ""NL"",
    ""name"": ""KONINKLIJKE PHILIPS NV""
  }
]",784
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASTRAZENECA AB""
  }
]",773
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BRISTOL MYERS SQUIBB CO""
  }
]",746
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ETHICON LLC""
  }
]",700
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BOSTON SCIENT SCIMED INC""
  }
]",695
"[
  {
    ""country_code"": ""US"",
    ""name"": ""COLGATE PALMOLIVE CO""
  }
]",678
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ETHICON ENDO SURGERY INC""
  }
]",647
"[
  {
    ""country_code"": """",
    ""name"": ""PROCTER & GAMBLE""
  }
]",632
"[
  {
    ""country_code"": ""US"",
    ""name"": ""KIMBERLY CLARK CO""
  }
]",627
"[
  {
    ""country_code"": ""BE"",
    ""name"": ""JANSSEN PHARMACEUTICA NV""
  }
]",611
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GENENTECH INC""
  }
]",572
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""IMMATICS BIOTECHNOLOGIES GMBH""
  }
]",569
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""CILAG GMBH INT""
  }
]",568
"[
  {
    ""country_code"": ""US"",
    ""name"": ""AMGEN INC""
  }
]",564
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MEDTRONIC INC""
  }
]",563
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""OLYMPUS CORP""
  }
]",552
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""SANOFI AVENTIS DEUTSCHLAND""
  }
]",548
"[
  {
    ""country_code"": ""US"",
    ""name"": ""VERTEX PHARMA""
  }
]",542
"[
  {
    ""country_code"": ""NZ"",
    ""name"": ""FISHER & PAYKEL HEALTHCARE LTD""
  }
]",535
"[
  {
    ""country_code"": ""US"",
    ""name"": ""EDWARDS LIFESCIENCES CORP""
  }
]",526
"[
  {
    ""country_code"": """",
    ""name"": ""OREAL""
  }
]",525
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",491
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ABBVIE INC""
  }
]",462
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ALLERGAN INC""
  }
]",447
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SMITH & NEPHEW INC""
  }
]",438
"[
  {
    ""country_code"": """",
    ""name"": ""HOFFMANN LA ROCHE""
  }
]",437
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""SMITH & NEPHEW""
  }
]",419
"[
  {
    ""country_code"": ""IL"",
    ""name"": ""BIOSENSE WEBSTER ISRAEL LTD""
  }
]",417
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""TERUMO CORP""
  }
]",406
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GEN ELECTRIC""
  }
]",391
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ETHICON INC""
  }
]",389
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""MEDOS INT SARL""
  }
]",388
"[
  {
    ""country_code"": ""US"",
    ""name"": ""INCYTE CORP""
  }
]",386
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""ALCON INC""
  }
]",383
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SMITHKLINE BEECHAM CORP""
  }
]",379
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""SANOFI SA""
  }
]",363
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""SANOFI AVENTIS""
  }
]",348
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""FUJIFILM CORP""
  }
]",346
"[
  {
    ""country_code"": ""US"",
    ""name"": ""KCI LICENSING INC""
  }
]",344
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""GRUENENTHAL GMBH""
  }
]",342
"[
  {
    ""country_code"": ""US"",
    ""name"": ""DEPUY SYNTHES PRODUCTS INC""
  }
]",342
"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV LELAND STANFORD JUNIOR""
  }
]",339
"[
  {
    ""country_code"": """",
    ""name"": ""COLGATE PALMOLIVE CO""
  }
]",334
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PFIZER PROD INC""
  }
]",330
"[
  {
    ""country_code"": ""US"",
    ""name"": ""REGENERON PHARMA""
  }
]",324
"[
  {
    ""country_code"": ""PR"",
    ""name"": ""ETHICON LLC""
  }
]",322
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GILEAD SCIENCES INC""
  }
]",317
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GLOBUS MEDICAL INC""
  }
]",316
"[
  {
    ""country_code"": "
Query:
SELECT
  TO_VARCHAR(TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
  COUNT(*) AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee,
     LATERAL FLATTEN(input => t."cpc") f_cpc
WHERE f_assignee.value:"name"::string = 'PROCTER & GAMBLE'
  AND f_cpc.value:"code"::string LIKE 'A61%'
  AND TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') IS NOT NULL
GROUP BY "filing_year"
ORDER BY "application_count" DESC
LIMIT 1;
Answer:
filing_year,application_count
1997,271
Query:
SELECT t."assignee_harmonized", COUNT(*) AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::string LIKE '%A61%'
    GROUP BY t."assignee_harmonized"
    ORDER BY "total_applications" DESC
    LIMIT 1;
Answer:
assignee_harmonized,total_applications
[],56002
Query:
SELECT
  TO_VARCHAR(TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
  f_assignee.value:"name"::string AS "assignee_name",
  COUNT(*) AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee,
     LATERAL FLATTEN(input => t."cpc") f_cpc
WHERE f_cpc.value:"code"::string LIKE 'A61%'
GROUP BY "filing_year", "assignee_name"
ORDER BY "application_count" DESC
LIMIT 1;
Answer:
filing_year,assignee_name,application_count
2017,ETHICON LLC,414
Query:
SELECT t."publication_number", t."filing_date"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::string LIKE '%A61%'
    LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,filing_date
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017247327-A1,20170313
US-2017247327-A1,20170313
US-2017247327-A1,20170313
US-2018282042-A1,20170331
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017275886-A1,20150811
US-2017275886-A1,20150811
US-2017275886-A1,20150811
US-2017275886-A1,20150811
US-2017275886-A1,20150811
US-2017275886-A1,20150811
US-2017275886-A1,20150811
US-2017275886-A1,20150811
US-2017275886-A1,20150811
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2017342060-A1,20170524
US-2017342060-A1,20170524
US-2017342060-A1,20170524
US-2017342060-A1,20170524
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-
Query:
SELECT TO_VARCHAR(TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
       COUNT(*) AS "applications_in_A61"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") f
WHERE f.value:"code"::string LIKE 'A61%'
  AND TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') IS NOT NULL
GROUP BY "filing_year"
ORDER BY "applications_in_A61" DESC
LIMIT 1;
Answer:
filing_year,applications_in_A61
2017,26227
Query:
SELECT 
  TO_VARCHAR(TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
  COUNT(*) AS "applications_in_A61"
FROM 
  PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."cpc") f
WHERE 
  f.value::string LIKE '%A61%'
  AND TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') IS NOT NULL
GROUP BY 
  "filing_year"
ORDER BY 
  "applications_in_A61" DESC
LIMIT 1;
Answer:
filing_year,applications_in_A61
2017,26227
Query:
SELECT 
  TO_VARCHAR(TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
  COUNT(*) AS "applications_in_A61"
FROM 
  PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."cpc") f
WHERE 
  f.value:"code"::string LIKE '%A61%'
  AND TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') IS NOT NULL
GROUP BY 
  "filing_year"
ORDER BY 
  "applications_in_A61" DESC
LIMIT 1;
Answer:
filing_year,applications_in_A61
2017,26227
End Exploring Related Columns
Task: In which year did the assignee with the most applications in the patent category 'A61' file the most?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: SELECT S."Column_Name" FROM {Database Name}.{Schema Name}.{Table_name} (ensure all column names are enclosed in double quotations)
Follow the answer format like: To determine the year in which the assignee with the most applications in the patent category 'A61' filed the highest number of applications, we first identify the assignee with the maximum applications in 'A61'. Then, we find the year when this assignee had the most filings.

```csv
year
year:int
```.
Here are some useful tips for answering:
When calculating distances between two geometries, use `ST_MakePoint(x, y)` to make a point and `ST_Distance(geometry1 GEOMETRY, geometry2 GEOMETRY)` to compute. No need to convert from meters to miles unless requested. Don't use Haversine like 2 * 6371000 * ASIN(...), use ST_DISTANCE for more precise results.
Please refrain from adding any conditions that are not explicitly specified in the task.
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'
Be careful one country may have different names in different columns in a database.
When handling TO_TIMESTAMP_NTZ conversions, use query like: SELECT CASE WHEN "date" >= 1e15 THEN TO_TIMESTAMP_NTZ("date" / 1000000) WHEN "date" >= 1e12 THEN TO_TIMESTAMP_NTZ("date" / 1000) ELSE TO_TIMESTAMP_NTZ("date") END AS parsed_timestamp FROM my_table;
Be careful of information in nested JSON columns. e.g.1. When it comes to active users, it refers to has engagement_time_msec parameter rather than directly counting users. So the right query is: SELECT DISTINCT USER_PSEUDO_ID FROM all_user_activity, LATERAL FLATTEN(input => event_params) AS flattened_params WHERE flattened_params.value:key = 'engagement_time_msec'
e.g. When it comes to top-selling product, you should pay attention to hits2.value:"eCommerceAction":"action_type"::INTEGER = 6 where 6 means sold product.
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When counting for rows of a column, ensure they are distinct: SELECT COUNT(DISTINCT col_name) FROM table;
Keep all decimals to four decimal places.

2025-01-16 02:58:00 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 400 model_error"
2025-01-16 02:58:00 - root - INFO - Database Name: PATENTS
Schema Name: PATENTS
DDL describes table information.
,0
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,1
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""spif_publication_number"" VARCHAR(16777216),
	""spif_application_number"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""claims_localized_html"" VARIANT,
	""description_localized"" VARIANT,
	""description_localized_html"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""locarno"" VARIANT,
	""citation"" VARIANT,
	""parent"" VARIANT,
	""child"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,2
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table**: `PATENTS.PATENTS.PUBLICATIONS`

  - **"assignee_harmonized"**: Potential usage - To identify assignee names in a standardized format.
  
  - **"cpc"**: Potential usage - To find patents classified under category 'A61' in the Cooperative Patent Classification system.
  
  - **"filing_date"**: Potential usage - To extract the filing dates of applications and determine the filing year.
  
- **Conditions**:

  - Filter records where the "cpc" classification includes 'A61'.
  
  - Group data by "assignee_harmonized" and filing year to count applications per assignee per year.

---

**SQL Queries:**

1. **Get a list of distinct assignees (harmonized):**

   ```sql
   SELECT DISTINCT "assignee_harmonized"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 1000;
   ```

2. **Preview the "cpc" column for sample records:**

   ```sql
   SELECT "publication_number", "cpc"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 1000;
   ```

3. **Retrieve distinct filing dates:**

   ```sql
   SELECT DISTINCT "filing_date"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "filing_date" IS NOT NULL
   LIMIT 1000;
   ```

4. **Extract "cpc" codes containing 'A61':**

   ```sql
   SELECT DISTINCT f.value::string AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::string LIKE '%A61%'
   LIMIT 1000;
   ```

5. **List publications with "cpc" codes in 'A61':**

   ```sql
   SELECT t."publication_number", f.value::string AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::string LIKE '%A61%'
   LIMIT 1000;
   ```

6. **Find assignees with patents classified under 'A61':**

   ```sql
   SELECT DISTINCT t."assignee_harmonized"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::string LIKE '%A61%'
   LIMIT 1000;
   ```

7. **Extract filing years from filing dates:**

   ```sql
   SELECT DISTINCT TO_VARCHAR(TO_DATE(t."filing_date"::string, 'YYYYMMDD'), 'YYYY') AS "filing_year"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   WHERE t."filing_date" IS NOT NULL
   LIMIT 1000;
   ```

8. **Count applications per assignee in category 'A61':**

   ```sql
   SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::string LIKE '%A61%'
   GROUP BY t."assignee_harmonized"
   ORDER BY "application_count" DESC
   LIMIT 1000;
   ```

9. **Get the filing years and application counts for a specific assignee in 'A61':**

   ```sql
   SELECT TO_VARCHAR(TO_DATE(t."filing_date"::string, 'YYYYMMDD'), 'YYYY') AS "filing_year", COUNT(*) AS "application_count"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE t."assignee_harmonized" = 'SPECIFIC_ASSIGNEE' AND f.value::string LIKE '%A61%'
   GROUP BY "filing_year"
   ORDER BY "filing_year" DESC
   LIMIT 1000;
   ```

10. **Identify the assignee with the most applications in 'A61':**

    ```sql
    SELECT t."assignee_harmonized", COUNT(*) AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::string LIKE '%A61%'
    GROUP BY t."assignee_harmonized"
    ORDER BY "total_applications" DESC
    LIMIT 1;
    ```

11. **List all filing years and counts for the top assignee in 'A61':**

    ```sql
    SELECT TO_VARCHAR(TO_DATE(t."filing_date"::string, 'YYYYMMDD'), 'YYYY') AS "filing_year", COUNT(*) AS "application_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") f
    WHERE t."assignee_harmonized" = 'TOP_ASSIGNEE' AND f.value::string LIKE '%A61%'
    GROUP BY "filing_year"
    ORDER BY "filing_year" DESC
    LIMIT 1000;
    ```

12. **Retrieve publication numbers and filing dates for patents in 'A61':**

    ```sql
    SELECT t."publication_number", t."filing_date"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::string LIKE '%A61%'
    LIMIT 1000;
    ```

13. **Get a count of applications per year in 'A61' category:**

    ```sql
    SELECT TO_VARCHAR(TO_DATE(t."filing_date"::string, 'YYYYMMDD'), 'YYYY') AS "filing_year", COUNT(*) AS "applications_in_A61"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::string LIKE '%A61%'
    GROUP BY "filing_year"
    ORDER BY "filing_year" DESC
    LIMIT 1000;
    ```

14. **Find distinct "cpc" codes for a given assignee:**

    ```sql
    SELECT DISTINCT f.value::string AS "cpc_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") f
    WHERE t."assignee_harmonized" = 'SPECIFIC_ASSIGNEE'
    LIMIT 1000;
    ```

15. **List inventors associated with the top assignee in 'A61':**

    ```sql
    SELECT DISTINCT t."inventor_harmonized"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") f
    WHERE t."assignee_harmonized" = 'TOP_ASSIGNEE' AND f.value::string LIKE '%A61%'
    LIMIT 1000;
    ```

---

These queries help in understanding the data and exploring the values in the relevant columns to address the task.Query:
SELECT DISTINCT "assignee_harmonized"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 1000;
Answer:
Too long, hard cut:
assignee_harmonized
"[
  {
    ""country_code"": """",
    ""name"": ""CHONGQING VOCATIONAL INST ENG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""KUNSHAN ZHUOLIDA PREC METAL PARTS CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""INNER MONGOLIA TONGFANG TECH CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""JIANHU COUNTY XINYUAN ROPE CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""DONGQIANG LIANZHOU COPPER FOIL CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""QINGYUAN ELECTRIC POWER PLANNING AND DESIGN INST CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""SICHUAN ACAD OF MEDICAL SCIENCES SICHUAN PROVINCIAL PEOPLES HOSPITAL""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""JINGJIANG SHENGBLUE POLICE EQUIPMENT MFG CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""LI WENGUANG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""TIAN JINGWEN""
  },
  {
    ""country_code"": """",
    ""name"": ""ZHOU HONGTAO""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""SUZHOU KAIEN YOUHE ENV ENGINEERING CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""SHIWAN KUNLUO YUQING AUTOMOBILE PART LTD COMPANY""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""BEIJING ZERO BIAS TECH CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""JIANGSU WEIZHIZE MARINE BIOLOGICAL TECH CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HEBEI BOYUAN INTELLIGENT AUTOMATION EQUIPMENT CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ZHEJIANG TOPSUN IND GROUP CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""DONGGUAN LONGXIN BIOLOGICAL ENVIRONMENTAL PROTECTION TECH CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""MIANYANG ANFU KONJAK DEV CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""QINGDAO HAIER INTELLIGENT TECHNOLOGY RES & DEV CO LTD""
  },
  {
    ""country_code"": """",
    ""name"": ""HAIER SMART HOME CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""UNIV ZHENGZHOU IND TECH""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""WENZOU WEILI AUX CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""SHENZHEN HENGLITAI TECH CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""SONG YONG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ZHEJIANG HOSPITAL""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""WESTERN DATA TECH COMPANY""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""Lianyungang normal college""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HEFEI LONGTANG MOTOR VEHICLE INSPECTION CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HUNAN TIANLONG INTELLIGENT ELECTROMECHANICAL EQUIPMENT LTD COMPANY""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""SHARED COMPANY OF HIGHLY INT ENGINEERING DECORATION DESIGN GROUP IN BEIJING""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""GENERAL HOSPITAL OF WESTERN THEATER COMMAND OF PLA""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ANHUI 123 ENVIRONMENTAL PROTECTION TECH CO LTD""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""H2GR0 LLC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ROLLING RODENTS LLC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MICRON TECHNOLOGY INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""FORTINET INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ILLINOIS TOOL WORKS""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""PRINCE SPORTS INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""CIBA GEIGY AG""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""KRUPP KOPPERS GMBH""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BIO RAD LABORATORIES""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BACHMANN ALINA""
  }
]"
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""GUANGDONG OPPO MOBILE TELECOMMUNICATIONS CORP LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ANGENIEUX PIERRE""
  }
]"
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""SUZHOU KEDA TECHNOLOGY CO LTD""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BOELLHOFF VERBINDUNGSTECHNIK GMBH""
  }
]"
"[
  {
    ""country_code"": ""DK"",
    ""name"": ""KIRBEK HOLDING APS""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""SYNGENTA CROP PROTECTION AG""
  }
]"
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""TRANSCEIVING SYSTEM TECHNOLOGY""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GAF CORP""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""LEO PHARMA AS""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""RIETER AG MASCHF""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""KEEN PERSONAL MEDIA""
  }
]"
"[
  {
    "
Query:
SELECT "publication_number", "cpc"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,cpc
CR-5634-A,[]
CR-5990-A,[]
FI-429-A,[]
HK-6083-A,"[
  {
    ""code"": ""H02M5/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
HU-T52763-A,"[
  {
    ""code"": ""A01N47/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D521/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
JP-H03206829-A,"[
  {
    ""code"": ""Y02A40/81"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
JP-S62159089-A,"[
  {
    ""code"": ""Y02E30/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
US-416-A,"[
  {
    ""code"": ""Y10T83/465"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""B26F1/42"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
US-2528225-A,"[
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A41580-A,"[
  {
    ""code"": ""B22D11/086"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A47682-A,"[
  {
    ""code"": ""C07D471/16"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D471/22"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A63682-A,"[
  {
    ""code"": ""G01N33/48728"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-920790-A,"[
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-950907-A,"[
  {
    ""code"": ""C11B5/0064"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/35"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C11B5/0035"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M135/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C09K15/30"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D263/56"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/44"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D235/12"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/3447"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/48"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/46"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D277/64"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/47"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/224"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/102"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/106"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/104"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/10"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/221"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/226"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/225"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/22"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10L1/14"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-920830-A,"[
  {
    ""code"": ""E02D5/808"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/385"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/26"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/28"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/54"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-9086-A,[]
CH-3256-A,[]
CH-540255-A,"[
  {
    ""code"": ""C07D213/32"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/51"",
    ""first"": false,
    ""inven
Query:
SELECT DISTINCT "filing_date"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "filing_date" IS NOT NULL
   LIMIT 1000;
Answer:
Too long, hard cut:
filing_date
20220705
20050113
19861126
20180910
20050912
20020517
20090126
20030313
20050620
20140602
20100521
20230125
20140430
20220712
20030902
20170330
20211013
20221223
20180925
20210217
20070215
20150225
20090310
20181023
19810812
20200207
20200506
19840521
19830824
19860723
19840821
19930723
19920924
20000926
20041022
20050311
19791023
19480416
19911022
20140226
20180820
19720302
19731015
19960926
20031231
20031021
20200622
19830927
20090731
20000905
19871005
19890327
20110415
20160920
20160811
20170509
20210723
19920706
20171122
19960610
19920821
20110121
20000830
20001117
19800912
19900528
19940929
20010227
20011102
20150413
20000328
20000420
20031202
20041014
20140828
19851104
19961220
20120725
20161003
20080208
20090615
20120912
20100325
20170707
20230724
20010614
20210730
20211110
20220429
20220522
20220730
20230710
20230728
20010829
19990716
19890313
20041106
19840105
20010129
19790913
19990609
19891018
19920904
19701124
20020712
20061229
20111121
20130125
19961218
19861014
20061124
20000513
20021210
20001113
19940103
20030901
19770902
19700415
19860125
19830224
19891026
19811114
19770221
19760525
19640424
19860213
19930527
19920304
20120516
20240227
19730911
19731203
19940319
19851128
20011122
19941108
20131111
20180318
19931103
20020911
20061002
19690214
19990316
20000807
19990526
19701225
19911108
19750724
19890320
19920228
20091006
20211106
20230112
19970715
19980127
19721219
19721226
19820326
19830216
20020724
20161205
20141223
20070219
19870414
19960522
19890725
19870415
20020425
19731019
19990604
19821001
19831007
20000621
19960111
19920813
19840308
19901123
19730710
19780620
19710928
20000512
20240428
19780120
19870309
19740306
19710727
20000121
20101222
20190101
19670522
19991017
19980212
19990813
19860320
19990112
19900116
19840126
19670105
19680419
19640812
19810616
20050219
19760115
19710728
19980722
19700219
19941031
19980307
19561123
19401112
19541222
19490224
19530420
19371122
19640414
19540722
19661201
19500626
19380812
19670705
19570111
19610218
19750113
19381107
19720131
19910819
19880318
19681015
19720228
19681227
19701006
19750801
19741122
19930409
19400420
19610531
19590506
19500330
19541101
19530519
19591204
19510417
19470207
19520621
19390301
19660810
19591029
19270923
19410325
19610209
19390220
19631230
19510801
19520303
19170629
19400410
19670524
19570725
19341006
19370503
19511123
19390407
19730823
19381018
19611025
19140227
19580409
19370915
19630520
19231201
19490512
19710311
19510601
19150105
19340406
19490108
19680322
19010427
19240428
19340411
19620126
20230325
19751205
19640916
19150813
19871023
19700717
19100203
19590925
19250126
19061226
19290311
19680903
19730430
19291118
19100827
19451205
19600725
19871114
19610406
19421219
19070521
19311012
19380126
19290215
19040223
19080723
19670126
19370128
19751105
19740613
19750707
18980429
19640724
19490430
19200616
19020705
19810808
19860717
20140510
20240219
19730602
19580408
19450601
19840724
19821003
19100616
20080711
20060621
20070727
20090420
20140402
20150618
20151112
20120308
20141002
20140630
20170629
20181130
20200309
19801015
19970617
19940908
20211102
20180522
20191004
20220310
19860519
19950429
19930119
20120301
19840128
20050726
20060104
20030606
20090729
20090810
20040227
20040723
20110803
20191203
20200824
20200706
20160830
20211213
20201117
20201211
20230323
20230210
20230518
20230615
20220205
19871217
20060608
19930202
20060516
20151123
20220118
20160311
20190621
20170609
20140327
20190416
20100205
20100913
20191013
20200206
20200806
20190215
20220330
19920225
19680627
20060828
19740323
19730404
20130228
20021024
19920131
19780419
19800604
19661217
20041216
20101203
20170209
20170801
20040113
20060907
20151130
20200507
19620123
20000623
20140113
20120403
19820810
19920610
19950801
19980924
19940831
20011212
20020705
20141009
19771230
20070104
19850212
20210527
20240412
19901015
19970916
19740215
19941219
19950712
20171204
20210407
20100707
20111027
20160201
19960329
19830418
19830602
19760804
19761217
19801219
20121012
20091217
20100408
20220728
20000912
20020226
19630720
19761018
19930426
20230301
19810228
19860905
19941118
19831221
19791107
19641211
19820630
19880928
19771115
19870404
19850814
19941115
20120305
20110819
20021101
19911129
20221220
19991230
20031129
19880119
19880204
19910318
19730901
20080130
20001109
20130712
20041102
20040110
19790627
19880825
19870406
19940601
20020620
20100612
19770927
19741125
19820706
19820924
19960711
19410514
19610721
19900912
19790730
19850122
19870119
19810204
20060916
20150409
20000327
19880602
20080401
19780914
20020110
19880913
19921130
20160528
19720311
19721129
20110421
19630301
20231024
19930920
19881102
19980414
19691128
19390626
19540428
19541216
19540927
19591118
19260508
19191022
19060124
19440303
19680119
19630311
19410312
19570130
19520528
19240909
19530403
19550324
19711011
19830207
19770426
19641031
19990911
19870126
20220108
20231008
20230704
19630409
19750417
19880222
19800327
19780927
19720406
20100410
20210724
19811027
19771206
19820302
20
Query:
SELECT DISTINCT f.value::string AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::string LIKE '%A61%'
   LIMIT 1000;
Answer:
Too long, hard cut:
cpc_code
"{""code"":""A61P9/10"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B2018/00273"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K8/8152"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61P25/18"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/154"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B2017/00544"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61M2005/3132"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K8/411"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K36/69"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61P5/18"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K2039/70"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61F2220/0075"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B17/025"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/1486"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K51/1093"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61K39/0011"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/6858"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61K8/4926"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61Q1/04"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K31/365"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61C7/00"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K31/357"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B2017/00805"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61M16/106"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K9/1617"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61L27/3813"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61N2/002"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K47/06"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B17/02"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B2090/306"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61M16/0825"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61L31/10"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61N1/3943"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61F2002/701"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K47/38"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61N1/36062"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61C8/0057"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61K49/0043"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61P21/06"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M1/3655"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M1/362"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/208"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M25/0082"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K8/8182"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M15/00"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B2018/2035"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B5/721"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B17/12"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K49/0021"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M5/31501"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61Q19/002"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K9/28"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61K9/2077"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K47/68"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K31/138"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/0088"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61C17/26"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B2562/0223"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B2560/063"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B5/0002"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/316"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61F2/26"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61B17/00234"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B8/4427"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61B17/3474"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61M2037/003"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A6
Query:
SELECT t."publication_number", f.value::string AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::string LIKE '%A61%'
   LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,cpc_code
WO-2017120317-A1,"{""code"":""A61M1/3496"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61P39/06"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61P3/02"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61P27/02"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61K9/127"",""first"":true,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61K8/14"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61K31/047"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61K31/047"",""first"":true,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61K8/345"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61K31/047"",""first"":true,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61Q19/00"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61K9/127"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2017142834-A1,"{""code"":""A61K9/127"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K8/8152"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K2800/81"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61Q3/02"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K2800/95"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K8/8152"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61Q3/02"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K2800/95"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K2800/81"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K8/55"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K8/37"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018169530-A1,"{""code"":""A61K8/28"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61P35/00"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K2039/505"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6881"",""first"":true,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/60"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6849"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6881"",""first"":true,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/60"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61P35/00"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6851"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6881"",""first"":true,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6881"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6851"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6849"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/60"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K2039/505"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61P35/00"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/6801"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018075308-A1,"{""code"":""A61K47/60"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61B5/14532"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M5/1723"",""first"":true,""inventive"":true,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M2205/583"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M2205/581"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M5/14244"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M2205/583"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M2205/50"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M5/14244"",""first"":false,""inventive"":true,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M2005/14208"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M5/1723"",""first"":true,""inventive"":true,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M2205/50"",""first"":false,""inventive"":false,""tree"":[]}"
WO-2018085600-A1,"{""code"":""A61M2205/581"",""first"":false,""inventive"":false,""tree"
Query:
SELECT DISTINCT t."assignee_harmonized"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::string LIKE '%A61%'
   LIMIT 1000;
Answer:
Too long, hard cut:
assignee_harmonized
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""FRAUNHOFER GES FORSCHUNG""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""GLATT INGTECH GMBH""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""GLATT SYSTEMTECHNIK GMBH""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HOERAUF CHRISTIAN""
  },
  {
    ""country_code"": """",
    ""name"": ""LIST HANS""
  },
  {
    ""country_code"": """",
    ""name"": ""ZIMMER VOLKER""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SAGE THERAPEUTICS INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""JOHNSON & SON INC S C""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""KCI LICENSING INC""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""KCI LICENSINC INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""BIOGEN INC""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""EISAI R&D MAN CO LTD""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""HARVARD COLLEGE""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""SHIRE BIOCHEM INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""TONY R BROWN""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""TCHELINGERIAN JEAN-LEON""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PROTEIN DESIGN LABS INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""REDDY N B BAKTHA""
  },
  {
    ""country_code"": """",
    ""name"": ""REDDY VILAMBI NRK""
  },
  {
    ""country_code"": """",
    ""name"": ""TORGALKAR ANIL""
  },
  {
    ""country_code"": """",
    ""name"": ""MURUGAN N R""
  },
  {
    ""country_code"": """",
    ""name"": ""KUMAR SENTHIL""
  }
]"
"[
  {
    ""country_code"": ""MY"",
    ""name"": ""SAW KHAY YONG""
  },
  {
    ""country_code"": ""MY"",
    ""name"": ""NG REZA CHING SOONG""
  },
  {
    ""country_code"": ""MY"",
    ""name"": ""JEE CAROLINE SIEW YOKE""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SAPIENCE THERAPEUTICS INC""
  }
]"
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""PRODUITS DENTAIRES PIERRE ROLLAND""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""HARTENSTEIN JUSTIN""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""RICOUARD ALVIN B""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""ORGANO TROY""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""HUTCHINSON FRED CANCER RES""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SpecGx LLC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MOMENTA PHARMACEUTICALS INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""NIPPON PETROCHEMICALS CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""RIT RECH IND THERAPEUT""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""BRISTOL MYERS SQUIBB CO""
  }
]"
"[
  {
    ""country_code"": ""BR"",
    ""name"": ""FUND EDUCACIONAL SEVERINO SOMBRA""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""NOVARTIS AG""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ANSON MEDICAL LTD""
  }
]"
"[
  {
    ""country_code"": ""BE"",
    ""name"": ""GLAXOSMITHKLINE BIOLOGICALS SA""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ORTHO MCNEIL PHARM INC""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""ECP ENTW MBH""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""COOK INC""
  },
  {
    ""country_code"": ""AU"",
    ""name"": ""COOK WILLIAM A AUSTRALIA""
  }
]"
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""ENSOL BIOSCIENCES INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""K2M INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV EMORY""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV NORTH CAROLINA STATE""
  }
]"
"[
  {
    ""country_code"": ""KY"",
    ""name"": ""I MAB""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""INDENA SPA""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""WEIGAND HANFRIED DR MED""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""BELLMANN BERNHARD""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""MULLER GERBES HENNING DIPL ING""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""SACK WOLFHARD""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""TEIMERT ING PAUL H""
  }
]"
"[
  {
    ""country_code"": ""BE"",
    ""name"": ""UNIV ANTWERPEN""
  },
  {
    ""country_code"": ""BE"",
    ""name"": ""UNIV ZIEKENHUIS ANTWERPEN""
  },
  {
    ""country_code"": """",
    ""name"": ""VANAUDENAERDE JONAS""
  },
  {
    ""country_code"": """",
    ""name"": ""SMITS EVELIEN""
  },
  {
    ""country_code"": """",
    ""name"": ""PEETERS MARC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""WELLSTAT VACCINES LLC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""MAGGIONI & C SPA""
  }
]"
"[
  {
    ""country_code"": ""DK"",
    ""name"": ""FORWARD PHARMA AS""
  }
]"
"[
  {
    ""country_code"": ""MT"",
Query:
-- Step 1: Find the assignee with the most applications in 'A61'
WITH TopAssignee AS (
  SELECT t."assignee_harmonized", COUNT(*) AS "total_applications"
  FROM PATENTS.PATENTS.PUBLICATIONS t,
       LATERAL FLATTEN(input => t."cpc") f
  WHERE f.value::string LIKE '%A61%'
  GROUP BY t."assignee_harmonized"
  ORDER BY "total_applications" DESC
  LIMIT 1
)

-- Step 2: Find the year in which this assignee filed the most applications in 'A61'
SELECT TO_VARCHAR(TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
       COUNT(*) AS "applications_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") f,
     TopAssignee ta
WHERE t."assignee_harmonized" = ta."assignee_harmonized"
  AND f.value::string LIKE '%A61%'
  AND TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') IS NOT NULL
GROUP BY "filing_year"
ORDER BY "applications_count" DESC
LIMIT 1;
Answer:
filing_year,applications_count
2016,3648
Query:
SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::string LIKE '%A61%'
   GROUP BY t."assignee_harmonized"
   ORDER BY "application_count" DESC
   LIMIT 1000;
Answer:
Too long, hard cut:
assignee_harmonized,application_count
[],56002
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PROCTER & GAMBLE""
  }
]",2302
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""NOVARTIS AG""
  }
]",1629
"[
  {
    ""country_code"": ""US"",
    ""name"": ""COVIDIEN LP""
  }
]",1304
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PFIZER""
  }
]",1279
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""OREAL""
  }
]",1212
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""HOFFMANN LA ROCHE""
  }
]",989
"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV CALIFORNIA""
  }
]",906
"[
  {
    ""country_code"": ""US"",
    ""name"": ""LILLY CO ELI""
  }
]",851
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BECTON DICKINSON CO""
  }
]",847
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BOEHRINGER INGELHEIM INT""
  }
]",829
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""MERCK PATENT GMBH""
  }
]",788
"[
  {
    ""country_code"": ""NL"",
    ""name"": ""KONINKLIJKE PHILIPS NV""
  }
]",784
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASTRAZENECA AB""
  }
]",773
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BRISTOL MYERS SQUIBB CO""
  }
]",746
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ETHICON LLC""
  }
]",700
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BOSTON SCIENT SCIMED INC""
  }
]",695
"[
  {
    ""country_code"": ""US"",
    ""name"": ""COLGATE PALMOLIVE CO""
  }
]",678
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ETHICON ENDO SURGERY INC""
  }
]",647
"[
  {
    ""country_code"": """",
    ""name"": ""PROCTER & GAMBLE""
  }
]",632
"[
  {
    ""country_code"": ""US"",
    ""name"": ""KIMBERLY CLARK CO""
  }
]",627
"[
  {
    ""country_code"": ""BE"",
    ""name"": ""JANSSEN PHARMACEUTICA NV""
  }
]",611
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GENENTECH INC""
  }
]",572
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""IMMATICS BIOTECHNOLOGIES GMBH""
  }
]",569
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""CILAG GMBH INT""
  }
]",568
"[
  {
    ""country_code"": ""US"",
    ""name"": ""AMGEN INC""
  }
]",564
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MEDTRONIC INC""
  }
]",563
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""OLYMPUS CORP""
  }
]",552
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""SANOFI AVENTIS DEUTSCHLAND""
  }
]",548
"[
  {
    ""country_code"": ""US"",
    ""name"": ""VERTEX PHARMA""
  }
]",542
"[
  {
    ""country_code"": ""NZ"",
    ""name"": ""FISHER & PAYKEL HEALTHCARE LTD""
  }
]",535
"[
  {
    ""country_code"": ""US"",
    ""name"": ""EDWARDS LIFESCIENCES CORP""
  }
]",526
"[
  {
    ""country_code"": """",
    ""name"": ""OREAL""
  }
]",525
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",491
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ABBVIE INC""
  }
]",462
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ALLERGAN INC""
  }
]",447
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SMITH & NEPHEW INC""
  }
]",438
"[
  {
    ""country_code"": """",
    ""name"": ""HOFFMANN LA ROCHE""
  }
]",437
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""SMITH & NEPHEW""
  }
]",419
"[
  {
    ""country_code"": ""IL"",
    ""name"": ""BIOSENSE WEBSTER ISRAEL LTD""
  }
]",417
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""TERUMO CORP""
  }
]",406
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GEN ELECTRIC""
  }
]",391
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ETHICON INC""
  }
]",389
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""MEDOS INT SARL""
  }
]",388
"[
  {
    ""country_code"": ""US"",
    ""name"": ""INCYTE CORP""
  }
]",386
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""ALCON INC""
  }
]",383
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SMITHKLINE BEECHAM CORP""
  }
]",379
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""SANOFI SA""
  }
]",363
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""SANOFI AVENTIS""
  }
]",348
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""FUJIFILM CORP""
  }
]",346
"[
  {
    ""country_code"": ""US"",
    ""name"": ""KCI LICENSING INC""
  }
]",344
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""GRUENENTHAL GMBH""
  }
]",342
"[
  {
    ""country_code"": ""US"",
    ""name"": ""DEPUY SYNTHES PRODUCTS INC""
  }
]",342
"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV LELAND STANFORD JUNIOR""
  }
]",339
"[
  {
    ""country_code"": """",
    ""name"": ""COLGATE PALMOLIVE CO""
  }
]",334
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PFIZER PROD INC""
  }
]",330
"[
  {
    ""country_code"": ""US"",
    ""name"": ""REGENERON PHARMA""
  }
]",324
"[
  {
    ""country_code"": ""PR"",
    ""name"": ""ETHICON LLC""
  }
]",322
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GILEAD SCIENCES INC""
  }
]",317
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GLOBUS MEDICAL INC""
  }
]",316
"[
  {
    ""country_code"": "
Query:
SELECT
  TO_VARCHAR(TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
  COUNT(*) AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee,
     LATERAL FLATTEN(input => t."cpc") f_cpc
WHERE f_assignee.value:"name"::string = 'PROCTER & GAMBLE'
  AND f_cpc.value:"code"::string LIKE 'A61%'
  AND TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') IS NOT NULL
GROUP BY "filing_year"
ORDER BY "application_count" DESC
LIMIT 1;
Answer:
filing_year,application_count
1997,271
Query:
SELECT t."assignee_harmonized", COUNT(*) AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::string LIKE '%A61%'
    GROUP BY t."assignee_harmonized"
    ORDER BY "total_applications" DESC
    LIMIT 1;
Answer:
assignee_harmonized,total_applications
[],56002
Query:
SELECT
  TO_VARCHAR(TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
  f_assignee.value:"name"::string AS "assignee_name",
  COUNT(*) AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee,
     LATERAL FLATTEN(input => t."cpc") f_cpc
WHERE f_cpc.value:"code"::string LIKE 'A61%'
GROUP BY "filing_year", "assignee_name"
ORDER BY "application_count" DESC
LIMIT 1;
Answer:
filing_year,assignee_name,application_count
2017,ETHICON LLC,414
Query:
SELECT t."publication_number", t."filing_date"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::string LIKE '%A61%'
    LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,filing_date
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017157230-A1,20170112
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017128414-A1,20170124
US-2017247327-A1,20170313
US-2017247327-A1,20170313
US-2017247327-A1,20170313
US-2018282042-A1,20170331
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017208224-A1,20170405
US-2017275886-A1,20150811
US-2017275886-A1,20150811
US-2017275886-A1,20150811
US-2017275886-A1,20150811
US-2017275886-A1,20150811
US-2017275886-A1,20150811
US-2017275886-A1,20150811
US-2017275886-A1,20150811
US-2017275886-A1,20150811
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2017304548-A1,20150928
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2018086852-A1,20160330
US-2017342060-A1,20170524
US-2017342060-A1,20170524
US-2017342060-A1,20170524
US-2017342060-A1,20170524
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018055345-A1,20170829
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-2018028529-A1,20171006
US-
Query:
SELECT TO_VARCHAR(TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
       COUNT(*) AS "applications_in_A61"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") f
WHERE f.value:"code"::string LIKE 'A61%'
  AND TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') IS NOT NULL
GROUP BY "filing_year"
ORDER BY "applications_in_A61" DESC
LIMIT 1;
Answer:
filing_year,applications_in_A61
2017,26227
Query:
SELECT 
  TO_VARCHAR(TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
  COUNT(*) AS "applications_in_A61"
FROM 
  PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."cpc") f
WHERE 
  f.value::string LIKE '%A61%'
  AND TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') IS NOT NULL
GROUP BY 
  "filing_year"
ORDER BY 
  "applications_in_A61" DESC
LIMIT 1;
Answer:
filing_year,applications_in_A61
2017,26227
Query:
SELECT 
  TO_VARCHAR(TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD'), 'YYYY') AS "filing_year",
  COUNT(*) AS "applications_in_A61"
FROM 
  PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."cpc") f
WHERE 
  f.value:"code"::string LIKE '%A61%'
  AND TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') IS NOT NULL
GROUP BY 
  "filing_year"
ORDER BY 
  "applications_in_A61" DESC
LIMIT 1;
Answer:
filing_year,applications_in_A61
2017,26227
End Exploring Related Columns
Task: In which year did the assignee with the most applications in the patent category 'A61' file the most?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: SELECT S."Column_Name" FROM {Database Name}.{Schema Name}.{Table_name} (ensure all column names are enclosed in double quotations)
Follow the answer format like: To determine the year in which the assignee with the most applications in the patent category 'A61' filed the highest number of applications, we first identify the assignee with the maximum applications in 'A61'. Then, we find the year when this assignee had the most filings.

```csv
year
year:int
```.
Here are some useful tips for answering:
When calculating distances between two geometries, use `ST_MakePoint(x, y)` to make a point and `ST_Distance(geometry1 GEOMETRY, geometry2 GEOMETRY)` to compute. No need to convert from meters to miles unless requested. Don't use Haversine like 2 * 6371000 * ASIN(...), use ST_DISTANCE for more precise results.
Please refrain from adding any conditions that are not explicitly specified in the task.
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'
Be careful one country may have different names in different columns in a database.
When handling TO_TIMESTAMP_NTZ conversions, use query like: SELECT CASE WHEN "date" >= 1e15 THEN TO_TIMESTAMP_NTZ("date" / 1000000) WHEN "date" >= 1e12 THEN TO_TIMESTAMP_NTZ("date" / 1000) ELSE TO_TIMESTAMP_NTZ("date") END AS parsed_timestamp FROM my_table;
Be careful of information in nested JSON columns. e.g.1. When it comes to active users, it refers to has engagement_time_msec parameter rather than directly counting users. So the right query is: SELECT DISTINCT USER_PSEUDO_ID FROM all_user_activity, LATERAL FLATTEN(input => event_params) AS flattened_params WHERE flattened_params.value:key = 'engagement_time_msec'
e.g. When it comes to top-selling product, you should pay attention to hits2.value:"eCommerceAction":"action_type"::INTEGER = 6 where 6 means sold product.
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When counting for rows of a column, ensure they are distinct: SELECT COUNT(DISTINCT col_name) FROM table;
Keep all decimals to four decimal places.

2025-01-16 02:58:00 - root - INFO - Exceeded
2025-01-16 02:58:00 - root - INFO - Total iteration counts: 0
