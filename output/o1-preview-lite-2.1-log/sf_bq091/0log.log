2025-01-20 18:39:18 - openai._base_client - INFO - Retrying request to /chat/completions in 0.382091 seconds
2025-01-20 18:41:15 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:41:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:41:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:41:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:41:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 18:41:17 - snowflake.connector.connection - INFO - closed
2025-01-20 18:41:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:41:17 - root - INFO - SQL:
SELECT DISTINCT f.value:"name"::STRING AS "assignee_name"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") f
   LIMIT 100;
Results:
assignee_name
UNIV CHINA MINING
SAKKAB NABIL Y
KRAYN KEN
ZHAO HUI
FELIX RACHLIN
ACTIVE COOL LTD
X TREME INTERNATIONAL S P A
MERLONI ELETTRODOMESTICI SPA
MAZZI DINO
CHART ENERGY & CHEMICALS INC
LYREN PHILIP SCOTT
BIGBEN INTERACTIVE SA
MARTINEZ NANCY
UNITED KINGDOM GOVERNMENT
GLOBALFOUNDRIES INC
IMAJE SA
SELLEKTIS
GLOBERIDE INC
SEIGLA MEDICAL INC
SEDI INC
MACROGENICS INC
EMERSON ELECTRIC CO
BOERNER PORAWAN
GUANGXI ZHENGDONG CHEMICAL EQUIPMENT CO LTD
FIELHOSEN INSTR JIANGSU CO LTD
HUANGHUA WARMAND ENERGY SAVING TECH CO LTD
JIAOZUO SHENGGUANG MOVIE AND VIDEO EQUIPMENT CO LTD
CAIS LTD
SKRYABIN YURIJ A
WORDEN WILLIAM T
ZHANG XIJING
DANA FARBER CANCER INST INC
HOLOHAN ERIC
excelENT LLC
WIGGERICH BURKHARD
SHILPA MEDICARE LTD
BITMAIN TECH INC
DUTHIE ROBERT SCOTT
LANG ADRIAN
STEINBERG INGO
LENNOX IND INC
FRITZEL TORSTEN
STEINER HANS-JUERGEN
LEE JIN
SIKKA NAMIT
ENGUITA EDUARDO ABANSES
BAUER SCOTT E
L EUROPA GARY A
SUZHOU IXEROL INDUSTRIAL TECH CO LTD
GUANGXI NANSHENG ALUMINUM IND CO LTD
BAODING XINSITE BUILDING MAT CO LTD
GUANGDONG SOUTH OCEAN CABLE CO LTD
NIO AUTOMOBILE TECHNOLOGY ANHUI CO LTD
SHANDONG RUIAN BIOTECHNOLOGY CO LTD
GANSU SHENGSHI LANYU BUILDING MAT CO LTD
UPL LTD
LIPOCKY JURAJ
NET HOPPER SYSTEMS INC
TYCO ELECTRONICS LOGISTICS AG
UNIV KING SAUD
STATE OF CALIFORNIA DEPT OF TR
GROVER MICHAEL E
GRAUPNER GERHART
SAWHNEY AMARPREET S
PADOAN CORRADO
CALIFORNIA BIOTECHNOLOGY INC
YEDA RES & DEV
JACOB RIFKIN
REMY VAN DER ZYPEN & CO
HAMMOND CLOCK COMPANY
CHALMERS ROBERT B
AVISUN CORP
RENE TRUBERT
BRIMSON JAMES H
AKRON POLYMER SOLUTIONS INC
VAX-IMMUNE LLC
UNIV INDUSTRY COOPERATION GROUP KYUNG HEE UNIV
EXXONMOBIL RES & ENG CO
PETRICH MIKE
BELL TEXTRON INC
FORSVARETS FORSKNINGS
TECHNOLOGY MAN INC
LEE YEO SEOB
THE INSIGHT
ASIA VITAL COMPONENTS CO LTD
SAMSUNG SDS CO LTD
KANITKAR SWAROM
BROWN MALCOLM L
INTERWOVEN MILLS INC
TIMKEN ROLLER BEARING CO
COEN COMPANY
PHILLIPS HENRY
MIDDLEBROOK WILLIAM ROBERT
ITO YO
KANZAKI KOKYUKOKI MFG CO LTD
BERGER KARL HEINZ
GEMPLUS CARD INT
GOEPFERICH ACHIM PROF DR
STEELCASE SA
NIPPON CHEMIPHAR CO

2025-01-20 18:41:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:41:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:41:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:41:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 18:41:19 - snowflake.connector.connection - INFO - closed
2025-01-20 18:41:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:41:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:41:56 - root - INFO - ```sql
SELECT DISTINCT
   f.value:"section_id"::STRING AS "section",
   f.value:"class_id"::STRING AS "class",
   f.value:"subclass_id"::STRING AS "subclass"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."cpc") f
LIMIT 100;
```
2025-01-20 18:41:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:41:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:41:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:41:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 18:41:57 - snowflake.connector.connection - INFO - closed
2025-01-20 18:41:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:43:34 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:43:34 - root - INFO - SQL:
SELECT DISTINCT
   f.value:"section_id"::STRING AS "section",
   f.value:"class_id"::STRING AS "class",
   f.value:"subclass_id"::STRING AS "subclass"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."cpc") f
LIMIT 100;
Results:
section,class,subclass
,,

2025-01-20 18:43:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:43:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:43:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:43:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 18:43:36 - snowflake.connector.connection - INFO - closed
2025-01-20 18:43:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:43:36 - root - INFO - SQL:
SELECT DISTINCT
   t."filing_date",
   SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 100
Results:
filing_date,filing_year
20130531,2013
20120706,2012
20120221,2012
20140820,2014
20120717,2012
20050414,2005
20040515,2004
19910215,1991
20140408,2014
20150513,2015
20160502,2016
20150507,2015
20170327,2017
20170630,2017
20140804,2014
20200615,2020
20210921,2021
20180625,2018
20201228,2020
20180627,2018
19991222,1999
19910909,1991
20120305,2012
20020723,2002
20200309,2020
20190319,2019
20200605,2020
19920508,1992
19820716,1982
19740831,1974
19630128,1963
19540216,1954
19330522,1933
19260227,1926
20120904,2012
20110619,2011
20180508,2018
20170728,2017
20210223,2021
20140613,2014
19961119,1996
20170831,2017
20191101,2019
20160602,2016
20171106,2017
20160927,2016
20160518,2016
20170322,2017
20150806,2015
19700918,1970
20000330,2000
20000218,2000
20201013,2020
20131101,2013
20150115,2015
19710520,1971
19731024,1973
19730215,1973
19800610,1980
19830712,1983
18971009,1897
20100513,2010
20120215,2012
20121210,2012
20150825,2015
20211210,2021
20060420,2006
20070516,2007
20070202,2007
20170905,2017
20220513,2022
20220718,2022
20220711,2022
20220909,2022
20221118,2022
20230721,2023
20230913,2023
20020605,2002
19790209,1979
19690513,1969
19760528,1976
19010812,1901
19040608,1904
20141017,2014
20141107,2014
20161229,2016
20150213,2015
20200414,2020
20141117,2014
20190103,2019
19920610,1992
20181218,2018
20190527,2019
20230531,2023
19871113,1987
19951207,1995
19931227,1993
19311106,1931
19501222,1950
19580728,1958

2025-01-20 18:43:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:43:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:43:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:43:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 18:43:38 - snowflake.connector.connection - INFO - closed
2025-01-20 18:43:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:44:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:44:17 - root - INFO - ```sql
SELECT
   a.value:"name"::STRING AS "assignee_name",
   SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
   COUNT(DISTINCT t."application_number") AS "applications_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."assignee_harmonized") a,
LATERAL FLATTEN(input => t."cpc") c
WHERE
   c.value:"symbol"::STRING LIKE 'A61%'
GROUP BY
   a.value:"name"::STRING,
   "filing_year"
ORDER BY "applications_count" DESC
LIMIT 1;
```
2025-01-20 18:44:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:44:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:44:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:44:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 18:44:18 - snowflake.connector.connection - INFO - closed
2025-01-20 18:44:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:45:26 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:45:26 - root - INFO - ```sql
SELECT
   a.value:"name"::STRING AS "assignee_name",
   SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
   COUNT(DISTINCT t."application_number") AS "applications_count"
FROM
   PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a
GROUP BY
   a.value:"name"::STRING,
   "filing_year"
ORDER BY
   "applications_count" DESC
LIMIT 1;
```
2025-01-20 18:45:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:45:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:45:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:45:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 18:45:28 - snowflake.connector.connection - INFO - closed
2025-01-20 18:45:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:46:20 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:46:20 - root - INFO - SQL:
SELECT
   a.value:"name"::STRING AS "assignee_name",
   SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
   COUNT(DISTINCT t."application_number") AS "applications_count"
FROM
   PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a
GROUP BY
   a.value:"name"::STRING,
   "filing_year"
ORDER BY
   "applications_count" DESC
LIMIT 1;
Results:
assignee_name,filing_year,applications_count
SAMSUNG ELECTRONICS CO LTD,2006,157

2025-01-20 18:46:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:46:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:46:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:46:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 18:46:22 - snowflake.connector.connection - INFO - closed
2025-01-20 18:46:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:47:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:47:21 - root - INFO - ```sql
SELECT
    t."assignee_harmonized"[0]:"name"::STRING AS "assignee_name",
    SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
    COUNT(DISTINCT t."application_number") AS "applications_count"
FROM
    PATENTS.PATENTS.PUBLICATIONS t
WHERE
    t."cpc"[0]:"symbol"::STRING LIKE 'A61%'
GROUP BY
    t."assignee_harmonized"[0]:"name"::STRING,
    "filing_year"
ORDER BY
    "applications_count" DESC
LIMIT 1;
```
2025-01-20 18:47:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:47:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:47:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:47:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 18:47:23 - snowflake.connector.connection - INFO - closed
2025-01-20 18:47:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:48:00 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:48:00 - root - INFO - ```sql
SELECT
    t."assignee_harmonized"[0]:"name"::STRING AS "assignee_name",
    SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
    COUNT(DISTINCT t."application_number") AS "applications_count"
FROM
    PATENTS.PATENTS.PUBLICATIONS t
GROUP BY
    t."assignee_harmonized"[0]:"name"::STRING,
    "filing_year"
ORDER BY
    "applications_count" DESC
LIMIT 1;
```
2025-01-20 18:48:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:48:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:48:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:48:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 18:48:02 - snowflake.connector.connection - INFO - closed
2025-01-20 18:48:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:49:28 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:49:28 - root - INFO - SQL:
SELECT
    t."assignee_harmonized"[0]:"name"::STRING AS "assignee_name",
    SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
    COUNT(DISTINCT t."application_number") AS "applications_count"
FROM
    PATENTS.PATENTS.PUBLICATIONS t
GROUP BY
    t."assignee_harmonized"[0]:"name"::STRING,
    "filing_year"
ORDER BY
    "applications_count" DESC
LIMIT 1;
Results:
assignee_name,filing_year,applications_count
,0,5450

2025-01-20 18:49:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:49:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:49:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:49:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 18:49:29 - snowflake.connector.connection - INFO - closed
2025-01-20 18:49:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:50:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:50:09 - root - INFO - ```sql
SELECT
    a.value:"name"::STRING AS "assignee_name",
    SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
    COUNT(*) AS "applications_count"
FROM
    PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a
GROUP BY
    a.value:"name"::STRING,
    SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4)
ORDER BY
    "applications_count" DESC
LIMIT 1;
```
2025-01-20 18:50:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:50:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:50:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:50:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 18:50:11 - snowflake.connector.connection - INFO - closed
2025-01-20 18:50:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:50:53 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:50:53 - root - INFO - SQL:
SELECT
    a.value:"name"::STRING AS "assignee_name",
    SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
    COUNT(*) AS "applications_count"
FROM
    PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a
GROUP BY
    a.value:"name"::STRING,
    SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4)
ORDER BY
    "applications_count" DESC
LIMIT 1;
Results:
assignee_name,filing_year,applications_count
SAMSUNG ELECTRONICS CO LTD,2006,157

2025-01-20 18:50:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:50:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:50:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:50:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 18:50:55 - snowflake.connector.connection - INFO - closed
2025-01-20 18:50:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:51:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:51:29 - root - INFO - ```sql
SELECT
    a.value:"name"::STRING AS "assignee_name",
    SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
    COUNT(*) AS "applications_count"
FROM
    PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a,
    LATERAL FLATTEN(input => t."ipc") i
WHERE
    i.value::STRING LIKE 'A61%'
GROUP BY
    a.value:"name"::STRING,
    "filing_year"
ORDER BY
    "applications_count" DESC
LIMIT 1;
```
2025-01-20 18:51:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:51:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:51:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:51:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 18:51:31 - snowflake.connector.connection - INFO - closed
2025-01-20 18:51:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:52:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:52:22 - root - INFO - ```sql
SELECT
    a.value:"name"::STRING AS "assignee_name",
    SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
    COUNT(*) AS "applications_count"
FROM
    PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a,
    LATERAL FLATTEN(input => t."ipc") i
WHERE
    i.value::STRING LIKE '%A61%'
GROUP BY
    a.value:"name"::STRING,
    "filing_year"
ORDER BY
    "applications_count" DESC
LIMIT 1;
```
2025-01-20 18:52:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:52:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:52:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:52:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 18:52:23 - snowflake.connector.connection - INFO - closed
2025-01-20 18:52:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:53:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:53:13 - root - INFO - SQL:
SELECT
    a.value:"name"::STRING AS "assignee_name",
    SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
    COUNT(*) AS "applications_count"
FROM
    PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a,
    LATERAL FLATTEN(input => t."ipc") i
WHERE
    i.value::STRING LIKE '%A61%'
GROUP BY
    a.value:"name"::STRING,
    "filing_year"
ORDER BY
    "applications_count" DESC
LIMIT 1;
Results:
assignee_name,filing_year,applications_count
HOFFMANN LA ROCHE,2001,150

2025-01-20 18:53:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:53:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:53:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:53:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 18:53:14 - snowflake.connector.connection - INFO - closed
2025-01-20 18:53:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:53:15 - root - INFO - SQL:
SELECT
   a.value:"name"::STRING AS "assignee_name",
   COUNT(DISTINCT t."application_number") AS "applications_count"
FROM
   PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a,
   LATERAL FLATTEN(input => t."cpc") c
WHERE
   c.value:"code"::STRING LIKE 'A61%'
GROUP BY a.value:"name"::STRING
ORDER BY "applications_count" DESC
LIMIT 1
Results:
assignee_name,applications_count
PROCTER & GAMBLE,197

2025-01-20 18:53:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:53:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:53:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:53:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 18:53:17 - snowflake.connector.connection - INFO - closed
2025-01-20 18:53:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:53:17 - root - INFO - SQL:
SELECT
   SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
   COUNT(DISTINCT t."application_number") AS "applications_count"
FROM
   PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c
WHERE
   c.value:"code"::STRING LIKE 'A61%'
GROUP BY "filing_year"
ORDER BY "applications_count" DESC
LIMIT 100
Results:
filing_year,applications_count
2018,1767
2017,1717
2016,1596
2021,1479
2020,1376
2019,1363
2015,1068
2022,1038
2014,1012
2006,863
2009,851
2007,831
2013,822
2008,810
2010,809
2005,781
2011,770
2012,760
2003,760
2004,756
2002,639
2001,633
2023,556
2000,511
1999,505
1998,444
1997,413
1996,363
1995,327
1994,303
1993,296
1992,281
1990,249
1991,244
1989,217
1988,212
1986,179
1987,169
1985,156
1983,144
1981,133
1982,122
1984,117
1978,112
1980,104
1977,102
1979,95
1976,94
1974,89
0,85
1973,83
1975,82
2024,80
1972,64
1970,47
1969,42
1971,37
1966,34
1968,32
1965,24
1963,22
1964,22
1961,20
1967,19
1962,17
1958,15
1955,11
1960,11
1957,11
1953,10
1936,10
1959,10
1950,9
1935,9
1948,8
1956,7
1952,7
1945,7
1954,7
1941,7
1931,6
1951,6
1946,6
1928,6
1940,6
1949,6
1913,5
1914,5
1943,5
1937,4
1939,4
1929,4
1944,4
1921,4
1934,4
1927,3
1911,3
1915,3
1923,3
1932,3

2025-01-20 18:53:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:53:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:53:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:53:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 18:53:18 - snowflake.connector.connection - INFO - closed
2025-01-20 18:53:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:53:19 - root - INFO - SQL:
SELECT
   a.value:"name"::STRING AS "assignee_name",
   COUNT(DISTINCT t."application_number") AS "applications_count"
FROM
   PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a,
   LATERAL FLATTEN(input => t."cpc") c
WHERE
   c.value:"code"::STRING LIKE 'A61%'
GROUP BY a.value:"name"::STRING
ORDER BY "applications_count" DESC
LIMIT 1
Results:
assignee_name,applications_count
PROCTER & GAMBLE,197

2025-01-20 18:53:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:53:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:53:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:53:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 18:53:20 - snowflake.connector.connection - INFO - closed
2025-01-20 18:53:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:54:27 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:54:27 - root - INFO - ```sql
SELECT
    a.value:"name"::STRING AS "assignee_name",
    COUNT(*) AS "applications_count"
FROM
    PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a
GROUP BY
    a.value:"name"::STRING
ORDER BY
    "applications_count" DESC
LIMIT 1;
```
2025-01-20 18:54:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:54:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:54:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:54:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 18:54:28 - snowflake.connector.connection - INFO - closed
2025-01-20 18:54:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:55:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:55:29 - root - INFO - SQL:
SELECT
    a.value:"name"::STRING AS "assignee_name",
    COUNT(*) AS "applications_count"
FROM
    PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a
GROUP BY
    a.value:"name"::STRING
ORDER BY
    "applications_count" DESC
LIMIT 1;
Results:
assignee_name,applications_count
SAMSUNG ELECTRONICS CO LTD,2242

2025-01-20 18:55:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:55:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:55:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:55:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 18:55:30 - snowflake.connector.connection - INFO - closed
2025-01-20 18:55:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:55:31 - root - INFO - SQL:
SELECT
   SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
   COUNT(DISTINCT t."application_number") AS "applications_count"
FROM
   PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a,
   LATERAL FLATTEN(input => t."cpc") c
WHERE
   a.value:"name"::STRING = 'PROCTER & GAMBLE' AND
   c.value:"code"::STRING LIKE 'A61%'
GROUP BY "filing_year"
ORDER BY "applications_count" DESC
LIMIT 1
Results:
filing_year,applications_count
1997,15

2025-01-20 18:55:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:55:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:55:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:55:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 18:55:32 - snowflake.connector.connection - INFO - closed
2025-01-20 18:55:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:55:33 - root - INFO - SQL:
SELECT
   t."application_number",
   t."publication_number"
FROM
   PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a,
   LATERAL FLATTEN(input => t."cpc") c
WHERE
   a.value:"name"::STRING = 'PROCTER & GAMBLE' AND
   c.value:"code"::STRING LIKE 'A61%'
LIMIT 100
Results:
application_number,publication_number
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
AU-2824495-A,AU-704286-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
FI-903881-A,FI-903881-A0
FI-903881-A,FI-903881-A0
FI-903881-A,FI-903881-A0
FI-903881-A,FI-903881-A0
FI-903881-A,FI-903881-A0
FI-903881-A,FI-903881-A0
FI-903881-A,FI-903881-A0
FI-903881-A,FI-903881-A0
FI-903881-A,FI-903881-A0
FI-903881-A,FI-903881-A0
FI-903881-A,FI-903881-A0
FI-903881-A,FI-903881-A0
FI-903881-A,FI-903881-A0
US-2016057470-W,WO-2017070077-A1
US-2016057470-W,WO-2017070077-A1
US-2016057470-W,WO-2017070077-A1
US-2016057470-W,WO-2017070077-A1
US-2016057470-W,WO-2017070077-A1
US-2016057470-W,WO-2017070077-A1
US-2016057470-W,WO-2017070077-A1
US-2016057470-W,WO-2017070077-A1
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2

2025-01-20 18:55:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:55:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:55:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:55:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-20 18:55:34 - snowflake.connector.connection - INFO - closed
2025-01-20 18:55:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:55:35 - root - INFO - SQL:
SELECT
   a.value:"name"::STRING AS "assignee_name",
   COUNT(DISTINCT t."application_number") AS "applications_count"
FROM
   PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a,
   LATERAL FLATTEN(input => t."cpc") c
WHERE
   c.value:"code"::STRING LIKE 'A61%'
GROUP BY a.value:"name"::STRING
ORDER BY "applications_count" DESC
LIMIT 5
Results:
assignee_name,applications_count
PROCTER & GAMBLE,197
HOFFMANN LA ROCHE,189
OREAL,150
NOVARTIS AG,147
LILLY CO ELI,139

2025-01-20 18:55:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:55:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:55:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:55:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 18:55:36 - snowflake.connector.connection - INFO - closed
2025-01-20 18:55:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:55:36 - root - INFO - SQL:
SELECT
   a.value:"name"::STRING AS "assignee_name",
   SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
   COUNT(DISTINCT t."application_number") AS "applications_count"
FROM
   PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a,
   LATERAL FLATTEN(input => t."cpc") c
WHERE
   c.value:"code"::STRING LIKE 'A61%'
GROUP BY
   a.value:"name"::STRING,
   "filing_year"
ORDER BY "applications_count" DESC
LIMIT 100
Results:
assignee_name,filing_year,applications_count
KONINKLIJKE PHILIPS NV,2018,15
PROCTER & GAMBLE,1997,15
NOVARTIS AG,2006,13
UNIV CALIFORNIA,2020,12
NOVARTIS AG,2011,11
FUJIFILM CORP,2019,11
COVIDIEN LP,2020,11
OLYMPUS CORP,2016,11
PROCTER & GAMBLE,2000,11
UNIV CALIFORNIA,2019,10
COVIDIEN LP,2016,10
NOVARTIS AG,2014,10
PROCTER & GAMBLE,1998,10
PROCTER & GAMBLE,1999,10
PFIZER,2015,9
KONINKLIJKE PHILIPS NV,2016,9
NOVARTIS AG,2007,9
HOFFMANN LA ROCHE,2003,9
ETHICON LLC,2019,9
GENENTECH INC,2002,9
HOFFMANN LA ROCHE,2006,9
HOFFMANN LA ROCHE,2008,9
NOVARTIS AG,2008,9
OREAL,1995,9
KONINKL PHILIPS ELECTRONICS NV,2010,9
HOFFMANN LA ROCHE,2001,8
HOFFMANN LA ROCHE,2004,8
COVIDIEN LP,2017,8
PROCTER & GAMBLE,1996,8
OLYMPUS MEDICAL SYSTEMS CORP,2008,8
PROCTER & GAMBLE,2016,8
HOFFMANN LA ROCHE,2002,8
OLYMPUS CORP,2017,8
SMITHKLINE BEECHAM CORP,1998,8
BAYER AG,2001,8
ASTRAZENECA AB,2001,8
BOEHRINGER INGELHEIM INT,2009,8
KONINKLIJKE PHILIPS NV,2019,8
LILLY CO ELI,1998,8
COVIDIEN LP,2019,8
SIEMENS HEALTHCARE GMBH,2019,8
SANOFI AVENTIS,2007,8
PFIZER PROD INC,2001,7
FUJIFILM CORP,2020,7
LILLY CO ELI,1994,7
BRISTOL MYERS SQUIBB CO,2002,7
PROCTER & GAMBLE,2006,7
ASTRAZENECA AB,2005,7
PROCTER & GAMBLE,2017,7
NOVARTIS AG,2020,7
UNIV CALIFORNIA,2018,7
KONINKLIJKE PHILIPS NV,2021,7
PFIZER,1993,7
PFIZER,1990,7
KONINKL PHILIPS ELECTRONICS NV,2008,7
NOVARTIS AG,2005,7
US HEALTH,2018,7
BAYER AG,1993,7
TYCO HEALTHCARE,2010,7
ETHICON ENDO SURGERY INC,2014,7
HOFFMANN LA ROCHE,2019,7
GENENTECH INC,2018,7
PROCTER & GAMBLE,2008,7
PROCTER & GAMBLE,2007,7
PROCTER & GAMBLE,2012,7
HOFFMANN LA ROCHE,2009,7
ASTRAZENECA AB,2007,7
WYETH CORP,2006,7
KONINKLIJKE PHILIPS NV,2020,7
NOVARTIS AG,2015,7
KIMBERLY CLARK CO,1999,7
OREAL,2005,7
HOECHST AG,1992,7
PHILIP MORRIS PRODUCTS SA,2016,6
MERCK & CO INC,2003,6
PFIZER PROD INC,2002,6
UNIV LELAND STANFORD JUNIOR,2019,6
HOFFMANN LA ROCHE,2020,6
OLYMPUS CORP,2018,6
HOFFMANN LA ROCHE,2018,6
ETHICON ENDO SURGERY LLC,2016,6
NOVARTIS AG,2003,6
GLAXOSMITHKLINE IP DEV LTD,2015,6
CANON KK,2017,6
COVIDIEN LP,2018,6
JANSSEN PHARMACEUTICA NV,1998,6
GENENTECH INC,2008,6
HOFFMANN LA ROCHE,1985,6
MERCK PATENT GMBH,2004,6
OREAL,2019,6
BOEHRINGER INGELHEIM PHARMA,2002,6
TYCO HEALTHCARE,2009,6
OREAL,2015,6
PROCTER & GAMBLE,1995,6
OREAL,2006,6
PFIZER PROD INC,1999,6
SMITHKLINE BEECHAM PLC,1998,6
LILLY CO ELI,1996,6
MERCK PATENT GMBH,2003,6
OREAL,1999,6

2025-01-20 18:55:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:55:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:55:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:55:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 18:55:38 - snowflake.connector.connection - INFO - closed
2025-01-20 18:55:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:55:38 - root - INFO - SQL:
SELECT DISTINCT
   c.value:"code"::STRING AS "symbol"
FROM
   PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c
WHERE
   c.value:"code"::STRING LIKE 'A61%'
LIMIT 100
Results:
symbol
A61N1/0529
A61K49/103
A61P35/02
A61P37/08
A61K47/68031
A61K31/4188
A61K31/497
A61M2205/584
A61K38/52
A61K9/127
A61M2039/242
A61B5/02416
A61B17/122
A61F2013/00561
A61B90/00
A61B2018/0066
A61M2205/04
A61B2018/0088
A61H2201/5023
A61K8/8147
A61K49/0039
A61M2025/1013
A61K2039/5158
A61M16/14
A61F2/46
A61K49/225
A61B5/243
A61L2300/64
A61K2035/115
A61P27/04
A61K39/001189
A61L2420/04
A61L2300/61
A61K9/5031
A61F2002/30838
A61B2050/0065
A61F9/0084
A61K6/871
A61B2017/00805
A61B17/1615
A61B2017/22028
A61L27/3852
A61M2025/0024
A61H2201/5015
A61M1/80
A61B17/7011
A61B5/044
A61M2230/06
A61B17/8057
A61B2017/0488
A61F2/0045
A61L12/126
A61J1/10
A61K51/0402
A61K8/0245
A61C9/00
A61F2002/30079
A61B5/296
A61K2800/51
A61K2800/94
A61M16/0633
A61M11/042
A61M2016/0024
A61H2201/50
A61M60/861
A61K8/975
A61K48/0016
A61G5/027
A61K31/191
A61K38/1816
A61F2/958
A61F5/0079
A61K38/166
A61B5/14551
A61F2/4455
A61L2420/02
A61B17/0625
A61F11/08
A61K31/56
A61B2090/3929
A61B8/543
A61B5/1076
A61L2/0088
A61F2/0095
A61P15/04
A61K47/18
A61F2002/4029
A61K39/4644
A61K39/0008
A61H15/0078
A61K35/747
A61P39/06
A61N1/36046
A61B5/349
A61M2025/1015
A61K36/53
A61K47/50
A61B5/4082
A61B1/00186
A61F2013/49069

2025-01-20 18:55:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:55:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:55:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:55:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 18:55:40 - snowflake.connector.connection - INFO - closed
2025-01-20 18:55:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:55:40 - root - INFO - SQL:
SELECT
   t."filing_date",
   t."application_number"
FROM
   PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a,
   LATERAL FLATTEN(input => t."cpc") c
WHERE
   a.value:"name"::STRING = 'PROCTER & GAMBLE' AND
   c.value:"code"::STRING LIKE 'A61%'
ORDER BY t."filing_date" DESC
LIMIT 100
Results:
filing_date,application_number
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230310,US-202318181675-A

2025-01-20 18:55:40 - root - INFO - itercount: 0
2025-01-20 18:55:40 - root - INFO - Database Name: PATENTS
Schema Name: PATENTS
DDL describes table information.
,0
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,1
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""spif_publication_number"" VARCHAR(16777216),
	""spif_application_number"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""claims_localized_html"" VARIANT,
	""description_localized"" VARIANT,
	""description_localized_html"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""locarno"" VARIANT,
	""citation"" VARIANT,
	""parent"" VARIANT,
	""child"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,2
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table:** `PATENTS.PATENTS.PUBLICATIONS`

  - `"assignee_harmonized"`: Used to obtain standardized names of assignees.
  - `"cpc"`: Used to extract CPC classification codes to filter for patent category 'A61'.
  - `"filing_date"`: Used to extract the year when the application was filed.
  - `"application_number"`: Used as an identifier for applications.
  - `"publication_number"`: Used as an identifier for publications.

**Conditions that may be used:**

- Filter `"cpc"` codes where `"section"` is 'A' and `"class"` is '61' to identify applications in patent category 'A61'.
- Extract the year from `"filing_date"` to group applications by year.
- Aggregate the number of applications per assignee.
- Identify the assignee with the most applications in 'A61'.
- Determine in which year this assignee filed the most applications.

---

**SQL Queries:**

1. **Retrieve distinct assignee names from `"assignee_harmonized"`:**

   ```sql
   SELECT DISTINCT f.value:"name"::STRING AS "assignee_name"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") f
   LIMIT 100;
   ```

2. **Extract CPC classification codes from `"cpc"`:**

   ```sql
   SELECT DISTINCT
       f.value:"section"::STRING AS "section",
       f.value:"class"::STRING AS "class",
       f.value:"subclass"::STRING AS "subclass"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   LIMIT 100;
   ```

3. **Get filing dates and extract the filing year:**

   ```sql
   SELECT DISTINCT
       t."filing_date",
       SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 100;
   ```

4. **List applications in patent category 'A61':**

   ```sql
   SELECT DISTINCT t."application_number"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE
       f.value:"section"::STRING = 'A' AND
       f.value:"class"::STRING = '61'
   LIMIT 100;
   ```

5. **Get assignee names and their applications in 'A61':**

   ```sql
   SELECT DISTINCT
       a.value:"name"::STRING AS "assignee_name",
       t."application_number"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a,
   LATERAL FLATTEN(input => t."cpc") c
   WHERE
       c.value:"section"::STRING = 'A' AND
       c.value:"class"::STRING = '61'
   LIMIT 100;
   ```

6. **Count the number of applications per assignee in 'A61':**

   ```sql
   SELECT
       a.value:"name"::STRING AS "assignee_name",
       COUNT(DISTINCT t."application_number") AS "applications_count"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a,
   LATERAL FLATTEN(input => t."cpc") c
   WHERE
       c.value:"section"::STRING = 'A' AND
       c.value:"class"::STRING = '61'
   GROUP BY a.value:"name"::STRING
   ORDER BY "applications_count" DESC
   LIMIT 100;
   ```

7. **Extract the filing year and count applications per year in 'A61':**

   ```sql
   SELECT
       SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
       COUNT(DISTINCT t."application_number") AS "applications_count"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c
   WHERE
       c.value:"section"::STRING = 'A' AND
       c.value:"class"::STRING = '61'
   GROUP BY "filing_year"
   ORDER BY "filing_year"
   LIMIT 100;
   ```

8. **Identify the assignee with the most applications in 'A61':**

   ```sql
   SELECT
       a.value:"name"::STRING AS "assignee_name",
       COUNT(DISTINCT t."application_number") AS "applications_count"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a,
   LATERAL FLATTEN(input => t."cpc") c
   WHERE
       c.value:"section"::STRING = 'A' AND
       c.value:"class"::STRING = '61'
   GROUP BY a.value:"name"::STRING
   ORDER BY "applications_count" DESC
   LIMIT 1;
   ```

9. **Count applications per year for the top assignee in 'A61':**

   *Assuming the top assignee identified is 'Top_Assignee_Name'.*

   ```sql
   SELECT
       SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
       COUNT(DISTINCT t."application_number") AS "applications_count"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a,
   LATERAL FLATTEN(input => t."cpc") c
   WHERE
       a.value:"name"::STRING = 'Top_Assignee_Name' AND
       c.value:"section"::STRING = 'A' AND
       c.value:"class"::STRING = '61'
   GROUP BY "filing_year"
   ORDER BY "applications_count" DESC
   LIMIT 100;
   ```

10. **Find the year in which the top assignee filed the most applications in 'A61':**

    *Assuming the top assignee identified is 'Top_Assignee_Name'.*

    ```sql
    SELECT
        SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
        COUNT(DISTINCT t."application_number") AS "applications_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a,
    LATERAL FLATTEN(input => t."cpc") c
    WHERE
        a.value:"name"::STRING = 'Top_Assignee_Name' AND
        c.value:"section"::STRING = 'A' AND
        c.value:"class"::STRING = '61'
    GROUP BY "filing_year"
    ORDER BY "applications_count" DESC
    LIMIT 1;
    ```

11. **List applications filed by the top assignee in the year they filed the most:**

    *Assuming the top assignee is 'Top_Assignee_Name' and the year is 'YYYY'.*

    ```sql
    SELECT
        t."application_number",
        t."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a,
    LATERAL FLATTEN(input => t."cpc") c
    WHERE
        a.value:"name"::STRING = 'Top_Assignee_Name' AND
        SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) = 'YYYY' AND
        c.value:"section"::STRING = 'A' AND
        c.value:"class"::STRING = '61'
    LIMIT 100;
    ```

12. **Retrieve the top 5 assignees with the most applications in 'A61':**

    ```sql
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        COUNT(DISTINCT t."application_number") AS "applications_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a,
    LATERAL FLATTEN(input => t."cpc") c
    WHERE
        c.value:"section"::STRING = 'A' AND
        c.value:"class"::STRING = '61'
    GROUP BY a.value:"name"::STRING
    ORDER BY "applications_count" DESC
    LIMIT 5;
    ```

13. **Count applications per year for each assignee in 'A61':**

    ```sql
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
        COUNT(DISTINCT t."application_number") AS "applications_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a,
    LATERAL FLATTEN(input => t."cpc") c
    WHERE
        c.value:"section"::STRING = 'A' AND
        c.value:"class"::STRING = '61'
    GROUP BY
        a.value:"name"::STRING,
        "filing_year"
    ORDER BY "applications_count" DESC
    LIMIT 100;
    ```

14. **Extract detailed CPC codes in 'A61':**

    ```sql
    SELECT DISTINCT
        f.value:"section"::STRING AS "section",
        f.value:"class"::STRING AS "class",
        f.value:"subclass"::STRING AS "subclass",
        f.value:"main_group"::STRING AS "main_group",
        f.value:"subgroup"::STRING AS "subgroup"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") f
    WHERE
        f.value:"section"::STRING = 'A' AND
        f.value:"class"::STRING = '61'
    LIMIT 100;
    ```

15. **List filing dates and applications for the top assignee in 'A61':**

    *Assuming the top assignee is 'Top_Assignee_Name'.*

    ```sql
    SELECT
        t."filing_date",
        t."application_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a,
    LATERAL FLATTEN(input => t."cpc") c
    WHERE
        a.value:"name"::STRING = 'Top_Assignee_Name' AND
        c.value:"section"::STRING = 'A' AND
        c.value:"class"::STRING = '61'
    ORDER BY t."filing_date" DESC
    LIMIT 100;
    ```

---

These queries help explore the relevant data needed to determine in which year the assignee with the most applications in the patent category 'A61' filed the most applications.Query:
SELECT DISTINCT f.value:"name"::STRING AS "assignee_name"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") f
   LIMIT 100;
Answer:
assignee_name
UNIV CHINA MINING
SAKKAB NABIL Y
KRAYN KEN
ZHAO HUI
FELIX RACHLIN
ACTIVE COOL LTD
X TREME INTERNATIONAL S P A
MERLONI ELETTRODOMESTICI SPA
MAZZI DINO
CHART ENERGY & CHEMICALS INC
LYREN PHILIP SCOTT
BIGBEN INTERACTIVE SA
MARTINEZ NANCY
UNITED KINGDOM GOVERNMENT
GLOBALFOUNDRIES INC
IMAJE SA
SELLEKTIS
GLOBERIDE INC
SEIGLA MEDICAL INC
SEDI INC
MACROGENICS INC
EMERSON ELECTRIC CO
BOERNER PORAWAN
GUANGXI ZHENGDONG CHEMICAL EQUIPMENT CO LTD
FIELHOSEN INSTR JIANGSU CO LTD
HUANGHUA WARMAND ENERGY SAVING TECH CO LTD
JIAOZUO SHENGGUANG MOVIE AND VIDEO EQUIPMENT CO LTD
CAIS LTD
SKRYABIN YURIJ A
WORDEN WILLIAM T
ZHANG XIJING
DANA FARBER CANCER INST INC
HOLOHAN ERIC
excelENT LLC
WIGGERICH BURKHARD
SHILPA MEDICARE LTD
BITMAIN TECH INC
DUTHIE ROBERT SCOTT
LANG ADRIAN
STEINBERG INGO
LENNOX IND INC
FRITZEL TORSTEN
STEINER HANS-JUERGEN
LEE JIN
SIKKA NAMIT
ENGUITA EDUARDO ABANSES
BAUER SCOTT E
L EUROPA GARY A
SUZHOU IXEROL INDUSTRIAL TECH CO LTD
GUANGXI NANSHENG ALUMINUM IND CO LTD
BAODING XINSITE BUILDING MAT CO LTD
GUANGDONG SOUTH OCEAN CABLE CO LTD
NIO AUTOMOBILE TECHNOLOGY ANHUI CO LTD
SHANDONG RUIAN BIOTECHNOLOGY CO LTD
GANSU SHENGSHI LANYU BUILDING MAT CO LTD
UPL LTD
LIPOCKY JURAJ
NET HOPPER SYSTEMS INC
TYCO ELECTRONICS LOGISTICS AG
UNIV KING SAUD
STATE OF CALIFORNIA DEPT OF TR
GROVER MICHAEL E
GRAUPNER GERHART
SAWHNEY AMARPREET S
PADOAN CORRADO
CALIFORNIA BIOTECHNOLOGY INC
YEDA RES & DEV
JACOB RIFKIN
REMY VAN DER ZYPEN & CO
HAMMOND CLOCK COMPANY
CHALMERS ROBERT B
AVISUN CORP
RENE TRUBERT
BRIMSON JAMES H
AKRON POLYMER SOLUTIONS INC
VAX-IMMUNE LLC
UNIV INDUSTRY COOPERATION GROUP KYUNG HEE UNIV
EXXONMOBIL RES & ENG CO
PETRICH MIKE
BELL TEXTRON INC
FORSVARETS FORSKNINGS
TECHNOLOGY MAN INC
LEE YEO SEOB
THE INSIGHT
ASIA VITAL COMPONENTS CO LTD
SAMSUNG SDS CO LTD
KANITKAR SWAROM
BROWN MALCOLM L
INTERWOVEN MILLS INC
TIMKEN ROLLER BEARING CO
COEN COMPANY
PHILLIPS HENRY
MIDDLEBROOK WILLIAM ROBERT
ITO YO
KANZAKI KOKYUKOKI MFG CO LTD
BERGER KARL HEINZ
GEMPLUS CARD INT
GOEPFERICH ACHIM PROF DR
STEELCASE SA
NIPPON CHEMIPHAR CO
Query:
SELECT DISTINCT
   f.value:"section_id"::STRING AS "section",
   f.value:"class_id"::STRING AS "class",
   f.value:"subclass_id"::STRING AS "subclass"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."cpc") f
LIMIT 100;
Answer:
section,class,subclass
,,
Query:
SELECT DISTINCT
   t."filing_date",
   SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 100
Answer:
filing_date,filing_year
20130531,2013
20120706,2012
20120221,2012
20140820,2014
20120717,2012
20050414,2005
20040515,2004
19910215,1991
20140408,2014
20150513,2015
20160502,2016
20150507,2015
20170327,2017
20170630,2017
20140804,2014
20200615,2020
20210921,2021
20180625,2018
20201228,2020
20180627,2018
19991222,1999
19910909,1991
20120305,2012
20020723,2002
20200309,2020
20190319,2019
20200605,2020
19920508,1992
19820716,1982
19740831,1974
19630128,1963
19540216,1954
19330522,1933
19260227,1926
20120904,2012
20110619,2011
20180508,2018
20170728,2017
20210223,2021
20140613,2014
19961119,1996
20170831,2017
20191101,2019
20160602,2016
20171106,2017
20160927,2016
20160518,2016
20170322,2017
20150806,2015
19700918,1970
20000330,2000
20000218,2000
20201013,2020
20131101,2013
20150115,2015
19710520,1971
19731024,1973
19730215,1973
19800610,1980
19830712,1983
18971009,1897
20100513,2010
20120215,2012
20121210,2012
20150825,2015
20211210,2021
20060420,2006
20070516,2007
20070202,2007
20170905,2017
20220513,2022
20220718,2022
20220711,2022
20220909,2022
20221118,2022
20230721,2023
20230913,2023
20020605,2002
19790209,1979
19690513,1969
19760528,1976
19010812,1901
19040608,1904
20141017,2014
20141107,2014
20161229,2016
20150213,2015
20200414,2020
20141117,2014
20190103,2019
19920610,1992
20181218,2018
20190527,2019
20230531,2023
19871113,1987
19951207,1995
19931227,1993
19311106,1931
19501222,1950
19580728,1958
Query:
SELECT
   a.value:"name"::STRING AS "assignee_name",
   SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
   COUNT(DISTINCT t."application_number") AS "applications_count"
FROM
   PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a
GROUP BY
   a.value:"name"::STRING,
   "filing_year"
ORDER BY
   "applications_count" DESC
LIMIT 1;
Answer:
assignee_name,filing_year,applications_count
SAMSUNG ELECTRONICS CO LTD,2006,157
Query:
SELECT
    t."assignee_harmonized"[0]:"name"::STRING AS "assignee_name",
    SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
    COUNT(DISTINCT t."application_number") AS "applications_count"
FROM
    PATENTS.PATENTS.PUBLICATIONS t
GROUP BY
    t."assignee_harmonized"[0]:"name"::STRING,
    "filing_year"
ORDER BY
    "applications_count" DESC
LIMIT 1;
Answer:
assignee_name,filing_year,applications_count
,0,5450
Query:
SELECT
    a.value:"name"::STRING AS "assignee_name",
    SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
    COUNT(*) AS "applications_count"
FROM
    PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a
GROUP BY
    a.value:"name"::STRING,
    SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4)
ORDER BY
    "applications_count" DESC
LIMIT 1;
Answer:
assignee_name,filing_year,applications_count
SAMSUNG ELECTRONICS CO LTD,2006,157
Query:
SELECT
    a.value:"name"::STRING AS "assignee_name",
    SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
    COUNT(*) AS "applications_count"
FROM
    PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a,
    LATERAL FLATTEN(input => t."ipc") i
WHERE
    i.value::STRING LIKE '%A61%'
GROUP BY
    a.value:"name"::STRING,
    "filing_year"
ORDER BY
    "applications_count" DESC
LIMIT 1;
Answer:
assignee_name,filing_year,applications_count
HOFFMANN LA ROCHE,2001,150
Query:
SELECT
   a.value:"name"::STRING AS "assignee_name",
   COUNT(DISTINCT t."application_number") AS "applications_count"
FROM
   PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a,
   LATERAL FLATTEN(input => t."cpc") c
WHERE
   c.value:"code"::STRING LIKE 'A61%'
GROUP BY a.value:"name"::STRING
ORDER BY "applications_count" DESC
LIMIT 1
Answer:
assignee_name,applications_count
PROCTER & GAMBLE,197
Query:
SELECT
   SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
   COUNT(DISTINCT t."application_number") AS "applications_count"
FROM
   PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c
WHERE
   c.value:"code"::STRING LIKE 'A61%'
GROUP BY "filing_year"
ORDER BY "applications_count" DESC
LIMIT 100
Answer:
filing_year,applications_count
2018,1767
2017,1717
2016,1596
2021,1479
2020,1376
2019,1363
2015,1068
2022,1038
2014,1012
2006,863
2009,851
2007,831
2013,822
2008,810
2010,809
2005,781
2011,770
2012,760
2003,760
2004,756
2002,639
2001,633
2023,556
2000,511
1999,505
1998,444
1997,413
1996,363
1995,327
1994,303
1993,296
1992,281
1990,249
1991,244
1989,217
1988,212
1986,179
1987,169
1985,156
1983,144
1981,133
1982,122
1984,117
1978,112
1980,104
1977,102
1979,95
1976,94
1974,89
0,85
1973,83
1975,82
2024,80
1972,64
1970,47
1969,42
1971,37
1966,34
1968,32
1965,24
1963,22
1964,22
1961,20
1967,19
1962,17
1958,15
1955,11
1960,11
1957,11
1953,10
1936,10
1959,10
1950,9
1935,9
1948,8
1956,7
1952,7
1945,7
1954,7
1941,7
1931,6
1951,6
1946,6
1928,6
1940,6
1949,6
1913,5
1914,5
1943,5
1937,4
1939,4
1929,4
1944,4
1921,4
1934,4
1927,3
1911,3
1915,3
1923,3
1932,3
Query:
SELECT
    a.value:"name"::STRING AS "assignee_name",
    COUNT(*) AS "applications_count"
FROM
    PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a
GROUP BY
    a.value:"name"::STRING
ORDER BY
    "applications_count" DESC
LIMIT 1;
Answer:
assignee_name,applications_count
SAMSUNG ELECTRONICS CO LTD,2242
Query:
SELECT
   SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
   COUNT(DISTINCT t."application_number") AS "applications_count"
FROM
   PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a,
   LATERAL FLATTEN(input => t."cpc") c
WHERE
   a.value:"name"::STRING = 'PROCTER & GAMBLE' AND
   c.value:"code"::STRING LIKE 'A61%'
GROUP BY "filing_year"
ORDER BY "applications_count" DESC
LIMIT 1
Answer:
filing_year,applications_count
1997,15
Query:
SELECT
   t."application_number",
   t."publication_number"
FROM
   PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a,
   LATERAL FLATTEN(input => t."cpc") c
WHERE
   a.value:"name"::STRING = 'PROCTER & GAMBLE' AND
   c.value:"code"::STRING LIKE 'A61%'
LIMIT 100
Answer:
application_number,publication_number
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
ES-12727570-T,ES-2585338-T3
AU-2824495-A,AU-704286-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
US-202016907711-A,US-11896689-B2
FI-903881-A,FI-903881-A0
FI-903881-A,FI-903881-A0
FI-903881-A,FI-903881-A0
FI-903881-A,FI-903881-A0
FI-903881-A,FI-903881-A0
FI-903881-A,FI-903881-A0
FI-903881-A,FI-903881-A0
FI-903881-A,FI-903881-A0
FI-903881-A,FI-903881-A0
FI-903881-A,FI-903881-A0
FI-903881-A,FI-903881-A0
FI-903881-A,FI-903881-A0
FI-903881-A,FI-903881-A0
US-2016057470-W,WO-2017070077-A1
US-2016057470-W,WO-2017070077-A1
US-2016057470-W,WO-2017070077-A1
US-2016057470-W,WO-2017070077-A1
US-2016057470-W,WO-2017070077-A1
US-2016057470-W,WO-2017070077-A1
US-2016057470-W,WO-2017070077-A1
US-2016057470-W,WO-2017070077-A1
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
US-201916255974-A,US-11039989-B2
Query:
SELECT
   a.value:"name"::STRING AS "assignee_name",
   COUNT(DISTINCT t."application_number") AS "applications_count"
FROM
   PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a,
   LATERAL FLATTEN(input => t."cpc") c
WHERE
   c.value:"code"::STRING LIKE 'A61%'
GROUP BY a.value:"name"::STRING
ORDER BY "applications_count" DESC
LIMIT 5
Answer:
assignee_name,applications_count
PROCTER & GAMBLE,197
HOFFMANN LA ROCHE,189
OREAL,150
NOVARTIS AG,147
LILLY CO ELI,139
Query:
SELECT
   a.value:"name"::STRING AS "assignee_name",
   SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
   COUNT(DISTINCT t."application_number") AS "applications_count"
FROM
   PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a,
   LATERAL FLATTEN(input => t."cpc") c
WHERE
   c.value:"code"::STRING LIKE 'A61%'
GROUP BY
   a.value:"name"::STRING,
   "filing_year"
ORDER BY "applications_count" DESC
LIMIT 100
Answer:
assignee_name,filing_year,applications_count
KONINKLIJKE PHILIPS NV,2018,15
PROCTER & GAMBLE,1997,15
NOVARTIS AG,2006,13
UNIV CALIFORNIA,2020,12
NOVARTIS AG,2011,11
FUJIFILM CORP,2019,11
COVIDIEN LP,2020,11
OLYMPUS CORP,2016,11
PROCTER & GAMBLE,2000,11
UNIV CALIFORNIA,2019,10
COVIDIEN LP,2016,10
NOVARTIS AG,2014,10
PROCTER & GAMBLE,1998,10
PROCTER & GAMBLE,1999,10
PFIZER,2015,9
KONINKLIJKE PHILIPS NV,2016,9
NOVARTIS AG,2007,9
HOFFMANN LA ROCHE,2003,9
ETHICON LLC,2019,9
GENENTECH INC,2002,9
HOFFMANN LA ROCHE,2006,9
HOFFMANN LA ROCHE,2008,9
NOVARTIS AG,2008,9
OREAL,1995,9
KONINKL PHILIPS ELECTRONICS NV,2010,9
HOFFMANN LA ROCHE,2001,8
HOFFMANN LA ROCHE,2004,8
COVIDIEN LP,2017,8
PROCTER & GAMBLE,1996,8
OLYMPUS MEDICAL SYSTEMS CORP,2008,8
PROCTER & GAMBLE,2016,8
HOFFMANN LA ROCHE,2002,8
OLYMPUS CORP,2017,8
SMITHKLINE BEECHAM CORP,1998,8
BAYER AG,2001,8
ASTRAZENECA AB,2001,8
BOEHRINGER INGELHEIM INT,2009,8
KONINKLIJKE PHILIPS NV,2019,8
LILLY CO ELI,1998,8
COVIDIEN LP,2019,8
SIEMENS HEALTHCARE GMBH,2019,8
SANOFI AVENTIS,2007,8
PFIZER PROD INC,2001,7
FUJIFILM CORP,2020,7
LILLY CO ELI,1994,7
BRISTOL MYERS SQUIBB CO,2002,7
PROCTER & GAMBLE,2006,7
ASTRAZENECA AB,2005,7
PROCTER & GAMBLE,2017,7
NOVARTIS AG,2020,7
UNIV CALIFORNIA,2018,7
KONINKLIJKE PHILIPS NV,2021,7
PFIZER,1993,7
PFIZER,1990,7
KONINKL PHILIPS ELECTRONICS NV,2008,7
NOVARTIS AG,2005,7
US HEALTH,2018,7
BAYER AG,1993,7
TYCO HEALTHCARE,2010,7
ETHICON ENDO SURGERY INC,2014,7
HOFFMANN LA ROCHE,2019,7
GENENTECH INC,2018,7
PROCTER & GAMBLE,2008,7
PROCTER & GAMBLE,2007,7
PROCTER & GAMBLE,2012,7
HOFFMANN LA ROCHE,2009,7
ASTRAZENECA AB,2007,7
WYETH CORP,2006,7
KONINKLIJKE PHILIPS NV,2020,7
NOVARTIS AG,2015,7
KIMBERLY CLARK CO,1999,7
OREAL,2005,7
HOECHST AG,1992,7
PHILIP MORRIS PRODUCTS SA,2016,6
MERCK & CO INC,2003,6
PFIZER PROD INC,2002,6
UNIV LELAND STANFORD JUNIOR,2019,6
HOFFMANN LA ROCHE,2020,6
OLYMPUS CORP,2018,6
HOFFMANN LA ROCHE,2018,6
ETHICON ENDO SURGERY LLC,2016,6
NOVARTIS AG,2003,6
GLAXOSMITHKLINE IP DEV LTD,2015,6
CANON KK,2017,6
COVIDIEN LP,2018,6
JANSSEN PHARMACEUTICA NV,1998,6
GENENTECH INC,2008,6
HOFFMANN LA ROCHE,1985,6
MERCK PATENT GMBH,2004,6
OREAL,2019,6
BOEHRINGER INGELHEIM PHARMA,2002,6
TYCO HEALTHCARE,2009,6
OREAL,2015,6
PROCTER & GAMBLE,1995,6
OREAL,2006,6
PFIZER PROD INC,1999,6
SMITHKLINE BEECHAM PLC,1998,6
LILLY CO ELI,1996,6
MERCK PATENT GMBH,2003,6
OREAL,1999,6
Query:
SELECT DISTINCT
   c.value:"code"::STRING AS "symbol"
FROM
   PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c
WHERE
   c.value:"code"::STRING LIKE 'A61%'
LIMIT 100
Answer:
symbol
A61N1/0529
A61K49/103
A61P35/02
A61P37/08
A61K47/68031
A61K31/4188
A61K31/497
A61M2205/584
A61K38/52
A61K9/127
A61M2039/242
A61B5/02416
A61B17/122
A61F2013/00561
A61B90/00
A61B2018/0066
A61M2205/04
A61B2018/0088
A61H2201/5023
A61K8/8147
A61K49/0039
A61M2025/1013
A61K2039/5158
A61M16/14
A61F2/46
A61K49/225
A61B5/243
A61L2300/64
A61K2035/115
A61P27/04
A61K39/001189
A61L2420/04
A61L2300/61
A61K9/5031
A61F2002/30838
A61B2050/0065
A61F9/0084
A61K6/871
A61B2017/00805
A61B17/1615
A61B2017/22028
A61L27/3852
A61M2025/0024
A61H2201/5015
A61M1/80
A61B17/7011
A61B5/044
A61M2230/06
A61B17/8057
A61B2017/0488
A61F2/0045
A61L12/126
A61J1/10
A61K51/0402
A61K8/0245
A61C9/00
A61F2002/30079
A61B5/296
A61K2800/51
A61K2800/94
A61M16/0633
A61M11/042
A61M2016/0024
A61H2201/50
A61M60/861
A61K8/975
A61K48/0016
A61G5/027
A61K31/191
A61K38/1816
A61F2/958
A61F5/0079
A61K38/166
A61B5/14551
A61F2/4455
A61L2420/02
A61B17/0625
A61F11/08
A61K31/56
A61B2090/3929
A61B8/543
A61B5/1076
A61L2/0088
A61F2/0095
A61P15/04
A61K47/18
A61F2002/4029
A61K39/4644
A61K39/0008
A61H15/0078
A61K35/747
A61P39/06
A61N1/36046
A61B5/349
A61M2025/1015
A61K36/53
A61K47/50
A61B5/4082
A61B1/00186
A61F2013/49069
Query:
SELECT
   t."filing_date",
   t."application_number"
FROM
   PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."assignee_harmonized") a,
   LATERAL FLATTEN(input => t."cpc") c
WHERE
   a.value:"name"::STRING = 'PROCTER & GAMBLE' AND
   c.value:"code"::STRING LIKE 'A61%'
ORDER BY t."filing_date" DESC
LIMIT 100
Answer:
filing_date,application_number
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20240417,US-202418637740-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20231103,AU-2023258428-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230606,US-202318329848-A
20230310,US-202318181675-A
End Exploring Related Columns
Task: In which year did the assignee with the most applications in the patent category 'A61' file the most?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Year
year:int
(Attention: answer in one row)
```

The year in which the assignee with the most applications in the patent category 'A61' filed the highest number of applications..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to active users, it refers to has engagement_time_msec parameter rather than directly counting users.

2025-01-20 18:56:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:56:17 - root - INFO - ```sql
WITH "top_assignee" AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        COUNT(DISTINCT t."application_number") AS "applications_count"
    FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
         LATERAL FLATTEN(input => t."assignee_harmonized") a,
         LATERAL FLATTEN(input => t."cpc") c
    WHERE
        c.value:"code"::STRING LIKE 'A61%'
        AND a.value:"name" IS NOT NULL
    GROUP BY
        a.value:"name"::STRING
    ORDER BY
        "applications_count" DESC NULLS LAST
    LIMIT 1
)
SELECT
    SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4)::INT AS "Year"
FROM
    "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a,
    LATERAL FLATTEN(input => t."cpc") c,
    "top_assignee" ta
WHERE
    a.value:"name"::STRING = ta."assignee_name"
    AND c.value:"code"::STRING LIKE 'A61%'
    AND t."filing_date" IS NOT NULL
GROUP BY
    "Year"
ORDER BY
    COUNT(DISTINCT t."application_number") DESC NULLS LAST
LIMIT 1;
```

```csv
Year
year:int
1997
```
2025-01-20 18:56:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:56:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:56:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:56:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 18:56:18 - snowflake.connector.connection - INFO - closed
2025-01-20 18:56:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:56:19 - root - INFO - itercount: 1
2025-01-20 18:56:19 - root - INFO - 0
2025-01-20 18:56:19 - root - INFO - results: 
Year
1997


2025-01-20 18:56:19 - root - INFO - Please check the answer again by reviewing In which year did the assignee with the most applications in the patent category 'A61' file the most?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Year
year:int
(Attention: answer in one row)
```

The year in which the assignee with the most applications in the patent category 'A61' filed the highest number of applications. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Year
1997
Current sql:
WITH "top_assignee" AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        COUNT(DISTINCT t."application_number") AS "applications_count"
    FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
         LATERAL FLATTEN(input => t."assignee_harmonized") a,
         LATERAL FLATTEN(input => t."cpc") c
    WHERE
        c.value:"code"::STRING LIKE 'A61%'
        AND a.value:"name" IS NOT NULL
    GROUP BY
        a.value:"name"::STRING
    ORDER BY
        "applications_count" DESC NULLS LAST
    LIMIT 1
)
SELECT
    SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4)::INT AS "Year"
FROM
    "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a,
    LATERAL FLATTEN(input => t."cpc") c,
    "top_assignee" ta
WHERE
    a.value:"name"::STRING = ta."assignee_name"
    AND c.value:"code"::STRING LIKE 'A61%'
    AND t."filing_date" IS NOT NULL
GROUP BY
    "Year"
ORDER BY
    COUNT(DISTINCT t."application_number") DESC NULLS LAST
LIMIT 1;
2025-01-20 18:57:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:57:30 - root - INFO - ```sql
WITH "top_assignee" AS (
    SELECT
        a.value:"name"::STRING AS "assignee_name",
        COUNT(DISTINCT t."application_number") AS "applications_count"
    FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
         LATERAL FLATTEN(input => t."assignee_harmonized") a,
         LATERAL FLATTEN(input => t."cpc") c
    WHERE
        c.value:"code"::STRING LIKE 'A61%'
        AND a.value:"name" IS NOT NULL
    GROUP BY
        a.value:"name"::STRING
    ORDER BY
        "applications_count" DESC NULLS LAST
    LIMIT 1
)
SELECT
    SUBSTRING(TO_VARCHAR(t."filing_date"), 1, 4)::INT AS "Year"
FROM
    "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(input => t."assignee_harmonized") a,
    LATERAL FLATTEN(input => t."cpc") c,
    "top_assignee" ta
WHERE
    a.value:"name"::STRING = ta."assignee_name"
    AND c.value:"code"::STRING LIKE 'A61%'
    AND t."filing_date" IS NOT NULL
GROUP BY
    "Year"
ORDER BY
    COUNT(DISTINCT t."application_number") DESC NULLS LAST
LIMIT 1;
```

```csv
Year
year:int
1997
```
2025-01-20 18:57:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:57:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:57:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:57:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 18:57:32 - snowflake.connector.connection - INFO - closed
2025-01-20 18:57:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:57:32 - root - INFO - itercount: 2
2025-01-20 18:57:32 - root - INFO - 0
2025-01-20 18:57:32 - root - INFO - Total iteration counts: 2
