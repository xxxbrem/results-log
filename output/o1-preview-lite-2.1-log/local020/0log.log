2025-01-25 10:19:20 - openai._base_client - INFO - Retrying request to /chat/completions in 0.441068 seconds
2025-01-25 10:21:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:21:10 - root - INFO - SQL:
SELECT DISTINCT b."bowler", p."player_name"
   FROM "ball_by_ball" AS b
   JOIN "player" AS p ON b."bowler" = p."player_id"
   LIMIT 100;
Results:
bowler,player_name
106,AB Dinda
14,P Kumar
15,Z Khan
84,I Sharma
13,AA Noffke
82,AB Agarkar
1,SC Ganguly
9,JH Kallis
16,SB Joshi
63,LR Shukla
10,CL White
66,B Lee
22,JDP Oram
77,S Sreesanth
120,MS Gony
25,JR Hopes
29,IK Pathan
121,M Muralitharan
435,P Amarnath
119,Joginder Sharma
24,K Goel
67,PP Chawla
68,WA Mota
118,GD McGrath
126,MM Patel
436,B Geeves
32,SR Watson
90,MF Maharoof
39,SK Trivedi
89,R Bhatia
38,SK Warne
31,YK Pathan
175,DL Vettori
37,D Salunkhe
73,A Nehra
49,SM Pollock
80,DS Kulkarni
81,R Vinay Kumar
12,B Akhil
44,ST Jayasuriya
50,Harbhajan Singh
48,AM Nayar
60,WPUJC Vaas
61,RP Singh
58,SB Styris
83,M Kartik
59,SB Bangar
5,Mohammad Hafeez
56,A Symonds
4,DJ Hussey
131,PP Ojha
75,Pankaj Singh
117,Mohammad Asif
70,Shahid Afridi
91,VY Mahesh
71,DJ Bravo
150,VS Yeligati
72,MA Khote
99,D Kalyankrishna
78,VRV Singh
102,Sohail Tanvir
124,A Kumble
98,DNT Zoysa
148,SD Chitnis
86,Shoaib Malik
27,Yuvraj Singh
94,DW Steyn
109,JA Morkel
149,CRD Fernando
8,V Kohli
41,V Sehwag
54,Y Venugopal Rao
437,Gagandeep Singh
105,Umar Gul
122,M Ntini
116,PJ Sangwan
143,DP Vijaykumar
112,DB Ravi Teja
111,LPC Silva
45,DJ Thornely
115,RR Raje
21,SK Raina
108,S Vidyut
151,L Balaji
127,CK Kapugedera
147,DR Smith
137,AD Mascarenhas
136,A Mishra
144,Shoaib Akhtar
140,Iqbal Abdulla
153,RR Powar
142,PM Sarvesh Kumar
145,Abdur Razzak
135,TM Dilshan
57,RG Sharma
438,A Nel
174,BAW Mendis
194,SL Malinga
156,T Thushara
155,A Flintoff

2025-01-25 10:21:10 - root - INFO - SQL:
SELECT DISTINCT e."extra_type"
   FROM "extra_runs" AS e
   LIMIT 100;
Results:
extra_type
legbyes
wides
byes
noballs
penalty

2025-01-25 10:21:10 - root - INFO - SQL:
SELECT e."extra_type", COUNT(*) AS "count"
   FROM "extra_runs" AS e
   GROUP BY e."extra_type"
   LIMIT 100;
Results:
extra_type,count
byes,373
legbyes,2317
noballs,567
penalty,1
wides,4091

2025-01-25 10:21:10 - root - INFO - SQL:
SELECT DISTINCT w."kind_out"
   FROM "wicket_taken" AS w
   LIMIT 100;
Results:
kind_out
caught
bowled
run out
lbw
retired hurt
stumped
caught and bowled
hit wicket
obstructing the field

2025-01-25 10:21:10 - root - INFO - SQL:
SELECT w."kind_out", COUNT(*) AS "count"
   FROM "wicket_taken" AS w
   GROUP BY w."kind_out"
   LIMIT 100;
Results:
kind_out,count
bowled,1234
caught,3894
caught and bowled,184
hit wicket,8
lbw,393
obstructing the field,1
retired hurt,8
run out,677
stumped,219

2025-01-25 10:21:10 - root - INFO - SQL:
SELECT w."match_id", w."over_id", w."ball_id", w."player_out", w."kind_out", b."bowler"
   FROM "wicket_taken" AS w
   JOIN "ball_by_ball" AS b
     ON w."match_id" = b."match_id" 
    AND w."over_id" = b."over_id" 
    AND w."ball_id" = b."ball_id"
    AND w."innings_no" = b."innings_no"
   LIMIT 100;
Results:
match_id,over_id,ball_id,player_out,kind_out,bowler
419167,10,3,154,caught,124
419167,10,3,46,caught,221
419167,12,4,8,caught,221
419167,14,4,96,caught,221
419167,18,4,208,caught,94
419168,2,7,18,caught,188
419168,5,5,21,caught,56
419168,6,1,53,caught,248
419168,6,5,178,caught,248
419168,8,2,57,caught,109
419168,14,2,20,caught,256
419168,15,5,109,caught,131
419168,16,2,56,caught,201
419168,18,4,188,caught,248
419168,20,2,131,caught,21
419168,20,4,125,caught,188
419169,1,4,53,caught,124
419169,4,2,57,caught,14
419169,7,1,56,caught,94
419169,17,3,54,caught,298
419169,19,3,131,caught,124
419170,2,4,42,caught,248
419170,8,2,185,caught,149
419170,9,4,18,caught,221
419170,12,2,23,caught,149
419170,15,2,133,caught,186
419170,15,5,79,caught,186
419170,17,6,154,caught,121
419170,18,1,20,caught,15
419170,19,6,221,caught,109
501203,1,6,185,caught,140
501203,11,3,21,caught,31
501203,16,2,9,caught,201
501203,18,2,20,caught,9
501203,20,2,63,caught,377
501204,5,5,42,caught,196
501204,6,3,26,caught,39
501204,6,5,252,caught,94
501204,11,1,257,caught,38
501204,13,6,154,caught,38
501204,18,3,258,caught,39
501204,20,1,112,caught,196
501204,20,3,94,caught,196
501205,2,2,135,caught,77
501205,9,6,55,caught,135
501205,10,6,260,caught,35
501205,12,3,2,caught,8
501205,18,4,79,caught,259
501205,19,4,259,caught,223
501206,7,6,254,caught,50
501206,15,2,183,caught,286
501206,18,4,106,caught,194
501207,1,1,74,caught,14
501207,1,4,53,caught,274
501207,2,3,100,caught,273
501207,3,4,167,caught,274
501207,4,3,88,caught,273
501207,8,5,171,caught,48
501207,9,3,48,caught,157
501207,9,3,157,caught,210
501207,18,1,67,caught,273
501207,20,1,14,caught,267
501208,9,6,26,caught,89
501208,13,2,154,caught,140
501208,13,3,9,caught,154
501208,14,6,93,caught,89
501208,17,4,258,caught,140
501208,18,1,112,caught,346
501208,20,6,31,caught,94
501209,1,3,41,caught,238
501209,5,5,254,caught,238
501209,8,1,262,caught,38
501209,8,3,183,caught,38
501209,8,3,6,caught,177
501209,11,5,266,caught,29
501209,18,4,187,caught,196
501209,19,7,54,caught,39
501210,5,4,8,caught,221
501211,1,2,21,caught,14
501211,6,5,53,caught,109
501211,14,6,264,caught,278
501212,1,1,2,caught,274
501212,3,5,64,caught,267
501212,5,5,17,caught,267
501212,8,4,74,caught,35
501212,10,5,171,caught,104
501212,12,2,27,caught,104
501212,16,2,104,caught,235
501212,17,1,35,caught,157
501213,2,6,135,caught,84
501213,3,5,42,caught,15
501213,5,6,260,caught,120
501213,7,4,110,caught,120
501213,9,6,65,caught,269
501213,12,1,79,caught,136
501213,15,4,26,caught,268
501213,17,5,203,caught,94
501213,17,6,268,caught,94
501213,20,1,269,caught,258
501213,20,2,154,caught,15

2025-01-25 10:21:10 - root - INFO - SQL:
SELECT b."match_id", b."over_id", b."ball_id", b."bowler",
          s."runs_scored",
          e."extra_runs",
          e."extra_type",
          (s."runs_scored" + CASE WHEN e."extra_type" IN ('wides', 'no ball') THEN e."extra_runs" ELSE 0 END) AS "runs_conceded_on_ball"
   FROM "ball_by_ball" AS b
   LEFT JOIN "batsman_scored" AS s
     ON b."match_id" = s."match_id" 
    AND b."over_id" = s."over_id" 
    AND b."ball_id" = s."ball_id"
    AND b."innings_no" = s."innings_no"
   LEFT JOIN "extra_runs" AS e
     ON b."match_id" = e."match_id" 
    AND b."over_id" = e."over_id" 
    AND b."ball_id" = e."ball_id"
    AND b."innings_no" = e."innings_no"
   LIMIT 100;
Results:
match_id,over_id,ball_id,bowler,runs_scored,extra_runs,extra_type,runs_conceded_on_ball
335987,1,1,106,1.0,,,1.0
335987,1,2,14,0.0,,,0.0
335987,1,2,106,,1.0,wides,
335987,1,3,14,,1.0,wides,
335987,1,3,106,0.0,,,0.0
335987,1,4,14,0.0,,,0.0
335987,1,4,106,1.0,,,1.0
335987,1,5,14,0.0,,,0.0
335987,1,5,106,1.0,,,1.0
335987,1,6,14,0.0,,,0.0
335987,1,6,106,0.0,,,0.0
335987,1,7,14,0.0,1.0,legbyes,0.0
335987,1,7,106,0.0,,,0.0
335987,2,1,15,0.0,,,0.0
335987,2,1,84,0.0,,,0.0
335987,2,2,15,4.0,,,4.0
335987,2,2,84,0.0,,,0.0
335987,2,3,15,4.0,,,4.0
335987,2,3,84,0.0,4.0,legbyes,0.0
335987,2,4,15,6.0,,,6.0
335987,2,4,84,1.0,,,1.0
335987,2,5,15,4.0,,,4.0
335987,2,5,84,0.0,,,0.0
335987,2,6,15,0.0,,,0.0
335987,2,6,84,0.0,,,0.0
335987,3,1,14,0.0,,,0.0
335987,3,1,106,0.0,,,0.0
335987,3,2,14,0.0,,,0.0
335987,3,2,106,0.0,,,0.0
335987,3,3,14,0.0,1.0,legbyes,0.0
335987,3,3,106,1.0,,,1.0
335987,3,4,14,4.0,,,4.0
335987,3,4,106,0.0,,,0.0
335987,3,5,14,1.0,,,1.0
335987,3,5,106,,1.0,wides,
335987,3,6,14,0.0,,,0.0
335987,3,6,106,0.0,,,0.0
335987,3,7,106,1.0,,,1.0
335987,4,1,13,,5.0,wides,
335987,4,1,84,2.0,,,2.0
335987,4,2,13,6.0,,,6.0
335987,4,2,84,1.0,,,1.0
335987,4,3,13,0.0,1.0,legbyes,0.0
335987,4,3,84,0.0,,,0.0
335987,4,4,13,4.0,,,4.0
335987,4,4,84,0.0,1.0,legbyes,0.0
335987,4,5,13,0.0,,,0.0
335987,4,5,84,0.0,,,0.0
335987,4,6,13,1.0,,,1.0
335987,4,6,84,0.0,,,0.0
335987,4,7,13,6.0,,,6.0
335987,5,1,14,4.0,,,4.0
335987,5,1,82,1.0,,,1.0
335987,5,2,14,1.0,,,1.0
335987,5,2,82,1.0,,,1.0
335987,5,3,14,4.0,,,4.0
335987,5,3,82,0.0,,,0.0
335987,5,4,14,0.0,,,0.0
335987,5,4,82,6.0,,,6.0
335987,5,5,14,1.0,,,1.0
335987,5,5,82,0.0,,,0.0
335987,5,6,14,0.0,,,0.0
335987,5,6,82,0.0,,,0.0
335987,6,1,15,1.0,,,1.0
335987,6,1,106,0.0,,,0.0
335987,6,2,15,0.0,,,0.0
335987,6,2,106,0.0,,,0.0
335987,6,3,15,0.0,,,0.0
335987,6,3,106,0.0,,,0.0
335987,6,4,15,0.0,,,0.0
335987,6,4,106,1.0,,,1.0
335987,6,5,15,0.0,,,0.0
335987,6,5,106,1.0,,,1.0
335987,6,6,15,0.0,,,0.0
335987,6,6,106,0.0,,,0.0
335987,7,1,13,1.0,,,1.0
335987,7,1,82,0.0,,,0.0
335987,7,2,13,1.0,,,1.0
335987,7,2,82,0.0,,,0.0
335987,7,3,13,1.0,,,1.0
335987,7,3,82,1.0,,,1.0
335987,7,4,13,2.0,,,2.0
335987,7,4,82,,1.0,wides,
335987,7,5,13,1.0,,,1.0
335987,7,5,82,,1.0,wides,
335987,7,6,13,1.0,,,1.0
335987,7,6,82,0.0,,,0.0
335987,7,7,82,0.0,,,0.0
335987,7,8,82,4.0,,,4.0
335987,8,1,15,0.0,,,0.0
335987,8,1,1,1.0,,,1.0
335987,8,2,15,1.0,,,1.0
335987,8,2,1,0.0,1.0,legbyes,0.0
335987,8,3,15,1.0,,,1.0
335987,8,3,1,1.0,,,1.0
335987,8,4,15,1.0,,,1.0
335987,8,4,1,2.0,,,2.0
335987,8,5,15,1.0,,,1.0
335987,8,5,1,0.0,,,0.0
335987,8,6,15,1.0,,,1.0

2025-01-25 10:21:10 - root - INFO - SQL:
SELECT b."bowler", SUM(s."runs_scored" + CASE WHEN e."extra_type" IN ('wides', 'no ball') THEN e."extra_runs" ELSE 0 END) AS "total_runs_conceded"
   FROM "ball_by_ball" AS b
   LEFT JOIN "batsman_scored" AS s
     ON b."match_id" = s."match_id" 
    AND b."over_id" = s."over_id" 
    AND b."ball_id" = s."ball_id"
    AND b."innings_no" = s."innings_no"
   LEFT JOIN "extra_runs" AS e
     ON b."match_id" = e."match_id" 
    AND b."over_id" = e."over_id" 
    AND b."ball_id" = e."ball_id"
    AND b."innings_no" = e."innings_no"
   GROUP BY b."bowler"
   LIMIT 100;
Results:
bowler,total_runs_conceded
1,336
4,468
5,61
8,354
9,2232
10,83
12,235
13,35
14,2996
15,2394
16,82
21,976
22,344
24,92
25,539
27,997
29,2482
31,1295
32,2033
35,2116
37,70
38,1385
39,1862
41,233
42,66
44,375
45,38
48,311
49,297
50,3047
52,23
53,0
54,329
56,656
57,425
58,270
59,212
60,345
61,2197
63,429
66,1048
67,2973
68,94
70,220
71,2686
72,51
73,2206
75,454
77,1115
78,531
80,1590
81,2743
82,1106
83,1332
84,1895
85,5
86,77
87,71
89,1913
90,494
91,483
93,20
94,2174
98,96
99,85
102,246
104,294
105,166
106,1848
108,21
109,2251
111,21
112,28
115,200
116,923
117,289
118,352
119,402
120,1209
121,1604
122,238
124,1027
126,1583
127,49
131,2276
133,57
135,353
136,2837
137,325
140,1019
142,41
143,193
144,50
145,23
147,643
148,54
149,279
150,53
151,1940
153,480

2025-01-25 10:21:10 - root - INFO - SQL:
SELECT b."bowler", COUNT(*) AS "wickets_taken"
   FROM "wicket_taken" AS w
   JOIN "ball_by_ball" AS b
     ON w."match_id" = b."match_id" 
    AND w."over_id" = b."over_id" 
    AND w."ball_id" = b."ball_id"
    AND w."innings_no" = b."innings_no"
   WHERE w."kind_out" IN ('bowled', 'caught', 'lbw', 'stumped', 'hit wicket')
   GROUP BY b."bowler"
   LIMIT 100;
Results:
bowler,wickets_taken
1,10
4,8
5,2
8,4
9,64
10,1
12,6
13,1
14,83
15,91
16,1
21,21
22,8
25,13
27,32
29,76
31,38
32,79
35,74
37,1
38,50
39,63
41,6
42,4
44,13
45,2
48,9
49,11
50,109
53,1
54,6
56,19
57,14
58,8
59,4
60,18
61,88
63,14
66,23
67,115
68,4
70,9
71,114
72,2
73,95
75,11
77,40
78,12
80,69
81,94
82,28
83,29
84,53
85,1
86,1
87,1
89,67
90,27
91,21
94,89
98,1
99,2
102,22
104,17
105,12
106,68
108,1
109,81
112,1
115,6
116,30
117,7
118,12
119,12
120,35
121,58
122,7
124,44
126,69
131,89
135,5
136,120
137,17
140,36
142,1
143,4
144,5
147,24
148,2
149,16
151,73
153,12
154,21
155,1
156,8
157,8
158,7
159,1
160,6
161,8

2025-01-25 10:21:10 - root - INFO - SQL:
SELECT t1."bowler", t1."total_runs_conceded", t2."wickets_taken"
    FROM
      (SELECT b."bowler", SUM(s."runs_scored" + CASE WHEN e."extra_type" IN ('wides', 'no ball') THEN e."extra_runs" ELSE 0 END) AS "total_runs_conceded"
       FROM "ball_by_ball" AS b
       LEFT JOIN "batsman_scored" AS s
         ON b."match_id" = s."match_id" 
        AND b."over_id" = s."over_id" 
        AND b."ball_id" = s."ball_id"
        AND b."innings_no" = s."innings_no"
       LEFT JOIN "extra_runs" AS e
         ON b."match_id" = e."match_id" 
        AND b."over_id" = e."over_id" 
        AND b."ball_id" = e."ball_id"
        AND b."innings_no" = e."innings_no"
       GROUP BY b."bowler") AS t1
    JOIN
      (SELECT b."bowler", COUNT(*) AS "wickets_taken"
       FROM "wicket_taken" AS w
       JOIN "ball_by_ball" AS b
         ON w."match_id" = b."match_id" 
        AND w."over_id" = b."over_id" 
        AND w."ball_id" = b."ball_id"
        AND w."innings_no" = b."innings_no"
       WHERE w."kind_out" IN ('bowled', 'caught', 'lbw', 'stumped', 'hit wicket')
       GROUP BY b."bowler") AS t2
      ON t1."bowler" = t2."bowler"
    LIMIT 100;
Results:
bowler,total_runs_conceded,wickets_taken
1,336,10
4,468,8
5,61,2
8,354,4
9,2232,64
10,83,1
12,235,6
13,35,1
14,2996,83
15,2394,91
16,82,1
21,976,21
22,344,8
25,539,13
27,997,32
29,2482,76
31,1295,38
32,2033,79
35,2116,74
37,70,1
38,1385,50
39,1862,63
41,233,6
42,66,4
44,375,13
45,38,2
48,311,9
49,297,11
50,3047,109
53,0,1
54,329,6
56,656,19
57,425,14
58,270,8
59,212,4
60,345,18
61,2197,88
63,429,14
66,1048,23
67,2973,115
68,94,4
70,220,9
71,2686,114
72,51,2
73,2206,95
75,454,11
77,1115,40
78,531,12
80,1590,69
81,2743,94
82,1106,28
83,1332,29
84,1895,53
85,5,1
86,77,1
87,71,1
89,1913,67
90,494,27
91,483,21
94,2174,89
98,96,1
99,85,2
102,246,22
104,294,17
105,166,12
106,1848,68
108,21,1
109,2251,81
112,28,1
115,200,6
116,923,30
117,289,7
118,352,12
119,402,12
120,1209,35
121,1604,58
122,238,7
124,1027,44
126,1583,69
131,2276,89
135,353,5
136,2837,120
137,325,17
140,1019,36
142,41,1
143,193,4
144,50,5
147,643,24
148,54,2
149,279,16
151,1940,73
153,480,12
154,772,21
155,105,1
156,152,8
157,299,8
158,209,7
159,40,1
160,199,6
161,276,8

2025-01-25 10:21:10 - root - INFO - SQL:
SELECT p."player_name", t1."total_runs_conceded", t2."wickets_taken",
           (CAST(t1."total_runs_conceded" AS FLOAT) / t2."wickets_taken") AS "bowling_average"
    FROM
      (SELECT b."bowler", SUM(s."runs_scored" + CASE WHEN e."extra_type" IN ('wides', 'no ball') THEN e."extra_runs" ELSE 0 END) AS "total_runs_conceded"
       FROM "ball_by_ball" AS b
       LEFT JOIN "batsman_scored" AS s
         ON b."match_id" = s."match_id" 
        AND b."over_id" = s."over_id" 
        AND b."ball_id" = s."ball_id"
        AND b."innings_no" = s."innings_no"
       LEFT JOIN "extra_runs" AS e
         ON b."match_id" = e."match_id" 
        AND b."over_id" = e."over_id" 
        AND b."ball_id" = e."ball_id"
        AND b."innings_no" = e."innings_no"
       GROUP BY b."bowler") AS t1
    JOIN
      (SELECT b."bowler", COUNT(*) AS "wickets_taken"
       FROM "wicket_taken" AS w
       JOIN "ball_by_ball" AS b
         ON w."match_id" = b."match_id" 
        AND w."over_id" = b."over_id" 
        AND w."ball_id" = b."ball_id"
        AND w."innings_no" = b."innings_no"
       WHERE w."kind_out" IN ('bowled', 'caught', 'lbw', 'stumped', 'hit wicket')
       GROUP BY b."bowler") AS t2
      ON t1."bowler" = t2."bowler"
    JOIN "player" AS p
      ON t1."bowler" = p."player_id"
    WHERE t2."wickets_taken" > 0
    ORDER BY "bowling_average" ASC
    LIMIT 100;
Results:
player_name,total_runs_conceded,wickets_taken,bowling_average
AC Gilchrist,0,1,0.0
Sachin Baby,8,2,4.0
AM Rahane,5,1,5.0
LA Carseldine,5,1,5.0
A Zampa,110,12,9.166666666666666
Shoaib Akhtar,50,5,10.0
DAJ Bracewell,32,3,10.666666666666666
Sohail Tanvir,246,22,11.181818181818182
CK Langeveldt,178,13,13.692307692307692
D du Preez,55,4,13.75
Umar Gul,166,12,13.833333333333334
S Dhawan,66,4,16.5
JM Kemp,51,3,17.0
BJ Hodge,294,17,17.294117647058822
CRD Fernando,279,16,17.4375
SL Malinga,2423,138,17.557971014492754
MA Starc,622,34,18.294117647058822
MF Maharoof,494,27,18.296296296296298
BCJ Cutting,110,6,18.333333333333332
Gurkeerat Singh,93,5,18.6
R Rampaul,263,14,18.785714285714285
Kuldeep Yadav,94,5,18.8
DJ Thornely,38,2,19.0
T Thushara,152,8,19.0
DE Bollinger,667,35,19.057142857142857
AD Mascarenhas,325,17,19.11764705882353
WPUJC Vaas,345,18,19.166666666666668
YA Abdulla,294,15,19.6
SP Narine,1573,79,19.911392405063292
S Aravind,739,37,19.972972972972972
SM Harwood,61,3,20.333333333333332
Imran Tahir,598,29,20.620689655172413
MR Marsh,395,19,20.789473684210527
S Vidyut,21,1,21.0
AP Dole,105,5,21.0
JW Hastings,63,3,21.0
BW Hilfenhaus,470,22,21.363636363636363
R Ninan,65,3,21.666666666666668
Sandeep Sharma,1131,52,21.75
A Singh,614,28,21.928571428571427
YS Chahal,1185,53,22.358490566037737
MJ McClenaghan,787,35,22.485714285714284
A Ashish Reddy,385,17,22.647058823529413
NM Coulter-Nile,476,21,22.666666666666668
MM Patel,1583,69,22.942028985507246
VY Mahesh,483,21,23.0
SMSM Senanayake,207,9,23.0
DS Kulkarni,1590,69,23.043478260869566
KK Cooper,739,32,23.09375
A Nehra,2206,95,23.221052631578946
RJ Harris,1001,43,23.27906976744186
RJ Peterson,70,3,23.333333333333332
A Kumble,1027,44,23.34090909090909
B Kumar,1894,81,23.382716049382715
D Wiese,351,15,23.4
WA Mota,94,4,23.5
DJ Bravo,2686,114,23.56140350877193
A Mishra,2837,120,23.641666666666666
CH Morris,948,40,23.7
MM Sharma,1639,69,23.753623188405797
MP Stoinis,191,8,23.875
L Ablish,72,3,24.0
CJ Jordan,241,10,24.1
Anand Rajan,193,8,24.125
Mustafizur Rahman,411,17,24.176470588235293
JEC Franklin,218,9,24.22222222222222
AB McDonald,243,10,24.3
GB Hogg,559,23,24.304347826086957
DW Steyn,2174,89,24.426966292134832
Shahid Afridi,220,9,24.444444444444443
R Ashwin,2388,97,24.61855670103093
MG Johnson,1261,51,24.725490196078432
Azhar Mahmood,695,28,24.821428571428573
BE Hendricks,224,9,24.88888888888889
Shakib Al Hasan,1023,41,24.951219512195124
RP Singh,2197,88,24.96590909090909
PD Collingwood,100,4,25.0
WD Parnell,652,26,25.076923076923077
KW Richardson,404,16,25.25
DJ Muthuswami,101,4,25.25
JE Taylor,152,6,25.333333333333332
MA Khote,51,2,25.5
S Gopal,153,6,25.5
PP Ojha,2276,89,25.573033707865168
RE van der Merwe,486,19,25.57894736842105
RV Gomez,128,5,25.6
SR Watson,2033,79,25.734177215189874
PP Chawla,2973,115,25.85217391304348
CR Brathwaite,181,7,25.857142857142858
TA Boult,259,10,25.9
P Awana,1013,39,25.974358974358974
Karanveer Singh,312,12,26.0
M Morkel,1954,75,26.053333333333335
SB Wagh,131,5,26.2
Z Khan,2394,91,26.307692307692307
SM Boland,53,2,26.5
L Balaji,1940,73,26.575342465753426
DR Smith,643,24,26.791666666666668
SW Tait,590,22,26.818181818181817
SM Pollock,297,11,27.0

2025-01-25 10:21:49 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:21:49 - root - INFO - ```sql
SELECT p."player_name", (CAST(t1."total_runs_conceded" AS FLOAT) / t2."wickets_taken") AS "bowling_average"
FROM
  (SELECT b."bowler", 
          SUM(COALESCE(s."runs_scored", 0) + 
              CASE WHEN e."extra_type" IN ('wides', 'noballs') THEN COALESCE(e."extra_runs", 0) ELSE 0 END) AS "total_runs_conceded"
   FROM "ball_by_ball" AS b
   LEFT JOIN "batsman_scored" AS s
     ON b."match_id" = s."match_id" 
    AND b."over_id" = s."over_id" 
    AND b."ball_id" = s."ball_id"
    AND b."innings_no" = s."innings_no"
   LEFT JOIN "extra_runs" AS e
     ON b."match_id" = e."match_id" 
    AND b."over_id" = e."over_id" 
    AND b."ball_id" = e."ball_id"
    AND b."innings_no" = e."innings_no"
   GROUP BY b."bowler") AS t1
JOIN
  (SELECT b."bowler", COUNT(*) AS "wickets_taken"
   FROM "wicket_taken" AS w
   JOIN "ball_by_ball" AS b
     ON w."match_id" = b."match_id" 
    AND w."over_id" = b."over_id" 
    AND w."ball_id" = b."ball_id"
    AND w."innings_no" = b."innings_no"
   WHERE w."kind_out" IN ('bowled', 'caught', 'lbw', 'stumped', 'hit wicket', 'caught and bowled')
   GROUP BY b."bowler") AS t2
  ON t1."bowler" = t2."bowler"
JOIN "player" AS p
  ON t1."bowler" = p."player_id"
WHERE t2."wickets_taken" > 0 AND t1."total_runs_conceded" > 0
ORDER BY "bowling_average" ASC
LIMIT 1;
```
2025-01-25 10:23:58 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:23:58 - root - INFO - SQL:
SELECT p."player_name", (CAST(t1."total_runs_conceded" AS FLOAT) / t2."wickets_taken") AS "bowling_average"
FROM
  (SELECT b."bowler", 
          SUM(COALESCE(s."runs_scored", 0) + 
              CASE WHEN e."extra_type" IN ('wides', 'noballs') THEN COALESCE(e."extra_runs", 0) ELSE 0 END) AS "total_runs_conceded"
   FROM "ball_by_ball" AS b
   LEFT JOIN "batsman_scored" AS s
     ON b."match_id" = s."match_id" 
    AND b."over_id" = s."over_id" 
    AND b."ball_id" = s."ball_id"
    AND b."innings_no" = s."innings_no"
   LEFT JOIN "extra_runs" AS e
     ON b."match_id" = e."match_id" 
    AND b."over_id" = e."over_id" 
    AND b."ball_id" = e."ball_id"
    AND b."innings_no" = e."innings_no"
   GROUP BY b."bowler") AS t1
JOIN
  (SELECT b."bowler", COUNT(*) AS "wickets_taken"
   FROM "wicket_taken" AS w
   JOIN "ball_by_ball" AS b
     ON w."match_id" = b."match_id" 
    AND w."over_id" = b."over_id" 
    AND w."ball_id" = b."ball_id"
    AND w."innings_no" = b."innings_no"
   WHERE w."kind_out" IN ('bowled', 'caught', 'lbw', 'stumped', 'hit wicket', 'caught and bowled')
   GROUP BY b."bowler") AS t2
  ON t1."bowler" = t2."bowler"
JOIN "player" AS p
  ON t1."bowler" = p."player_id"
WHERE t2."wickets_taken" > 0 AND t1."total_runs_conceded" > 0
ORDER BY "bowling_average" ASC
LIMIT 1;
Results:
player_name,bowling_average
Sachin Baby,4.0

2025-01-25 10:23:58 - root - INFO - SQL:
-- Corrected Query 7: Calculate runs conceded per delivery by each bowler
SELECT b."match_id", b."over_id", b."ball_id", b."bowler",
       COALESCE(s."runs_scored", 0) AS "runs_scored",
       e."extra_runs",
       e."extra_type",
       (COALESCE(s."runs_scored", 0) + CASE WHEN e."extra_type" IN ('wides', 'noballs') THEN COALESCE(e."extra_runs", 0) ELSE 0 END) AS "runs_conceded_on_ball"
FROM "ball_by_ball" AS b
LEFT JOIN "batsman_scored" AS s
  ON b."match_id" = s."match_id" 
 AND b."over_id" = s."over_id" 
 AND b."ball_id" = s."ball_id"
 AND b."innings_no" = s."innings_no"
LEFT JOIN "extra_runs" AS e
  ON b."match_id" = e."match_id" 
 AND b."over_id" = e."over_id" 
 AND b."ball_id" = e."ball_id"
 AND b."innings_no" = e."innings_no"
LIMIT 100
Results:
match_id,over_id,ball_id,bowler,runs_scored,extra_runs,extra_type,runs_conceded_on_ball
335987,1,1,106,1,,,1
335987,1,2,14,0,,,0
335987,1,2,106,0,1.0,wides,1
335987,1,3,14,0,1.0,wides,1
335987,1,3,106,0,,,0
335987,1,4,14,0,,,0
335987,1,4,106,1,,,1
335987,1,5,14,0,,,0
335987,1,5,106,1,,,1
335987,1,6,14,0,,,0
335987,1,6,106,0,,,0
335987,1,7,14,0,1.0,legbyes,0
335987,1,7,106,0,,,0
335987,2,1,15,0,,,0
335987,2,1,84,0,,,0
335987,2,2,15,4,,,4
335987,2,2,84,0,,,0
335987,2,3,15,4,,,4
335987,2,3,84,0,4.0,legbyes,0
335987,2,4,15,6,,,6
335987,2,4,84,1,,,1
335987,2,5,15,4,,,4
335987,2,5,84,0,,,0
335987,2,6,15,0,,,0
335987,2,6,84,0,,,0
335987,3,1,14,0,,,0
335987,3,1,106,0,,,0
335987,3,2,14,0,,,0
335987,3,2,106,0,,,0
335987,3,3,14,0,1.0,legbyes,0
335987,3,3,106,1,,,1
335987,3,4,14,4,,,4
335987,3,4,106,0,,,0
335987,3,5,14,1,,,1
335987,3,5,106,0,1.0,wides,1
335987,3,6,14,0,,,0
335987,3,6,106,0,,,0
335987,3,7,106,1,,,1
335987,4,1,13,0,5.0,wides,5
335987,4,1,84,2,,,2
335987,4,2,13,6,,,6
335987,4,2,84,1,,,1
335987,4,3,13,0,1.0,legbyes,0
335987,4,3,84,0,,,0
335987,4,4,13,4,,,4
335987,4,4,84,0,1.0,legbyes,0
335987,4,5,13,0,,,0
335987,4,5,84,0,,,0
335987,4,6,13,1,,,1
335987,4,6,84,0,,,0
335987,4,7,13,6,,,6
335987,5,1,14,4,,,4
335987,5,1,82,1,,,1
335987,5,2,14,1,,,1
335987,5,2,82,1,,,1
335987,5,3,14,4,,,4
335987,5,3,82,0,,,0
335987,5,4,14,0,,,0
335987,5,4,82,6,,,6
335987,5,5,14,1,,,1
335987,5,5,82,0,,,0
335987,5,6,14,0,,,0
335987,5,6,82,0,,,0
335987,6,1,15,1,,,1
335987,6,1,106,0,,,0
335987,6,2,15,0,,,0
335987,6,2,106,0,,,0
335987,6,3,15,0,,,0
335987,6,3,106,0,,,0
335987,6,4,15,0,,,0
335987,6,4,106,1,,,1
335987,6,5,15,0,,,0
335987,6,5,106,1,,,1
335987,6,6,15,0,,,0
335987,6,6,106,0,,,0
335987,7,1,13,1,,,1
335987,7,1,82,0,,,0
335987,7,2,13,1,,,1
335987,7,2,82,0,,,0
335987,7,3,13,1,,,1
335987,7,3,82,1,,,1
335987,7,4,13,2,,,2
335987,7,4,82,0,1.0,wides,1
335987,7,5,13,1,,,1
335987,7,5,82,0,1.0,wides,1
335987,7,6,13,1,,,1
335987,7,6,82,0,,,0
335987,7,7,82,0,,,0
335987,7,8,82,4,,,4
335987,8,1,15,0,,,0
335987,8,1,1,1,,,1
335987,8,2,15,1,,,1
335987,8,2,1,0,1.0,legbyes,0
335987,8,3,15,1,,,1
335987,8,3,1,1,,,1
335987,8,4,15,1,,,1
335987,8,4,1,2,,,2
335987,8,5,15,1,,,1
335987,8,5,1,0,,,0
335987,8,6,15,1,,,1

2025-01-25 10:23:58 - root - INFO - SQL:
-- Corrected Query 8: Compute total runs conceded by each bowler
SELECT b."bowler", SUM(COALESCE(s."runs_scored", 0) + CASE WHEN e."extra_type" IN ('wides', 'noballs') THEN COALESCE(e."extra_runs", 0) ELSE 0 END) AS "total_runs_conceded"
FROM "ball_by_ball" AS b
LEFT JOIN "batsman_scored" AS s
  ON b."match_id" = s."match_id" 
 AND b."over_id" = s."over_id" 
 AND b."ball_id" = s."ball_id"
 AND b."innings_no" = s."innings_no"
LEFT JOIN "extra_runs" AS e
  ON b."match_id" = e."match_id" 
 AND b."over_id" = e."over_id" 
 AND b."ball_id" = e."ball_id"
 AND b."innings_no" = e."innings_no"
GROUP BY b."bowler"
LIMIT 100
Results:
bowler,total_runs_conceded
1,340
4,474
5,68
8,368
9,2289
10,86
12,242
13,40
14,3100
15,2469
16,82
21,997
22,349
24,93
25,548
27,1006
29,2554
31,1325
32,2120
35,2150
37,78
38,1422
39,1904
41,235
42,66
44,390
45,40
48,322
49,301
50,3119
52,24
53,0
54,337
56,674
57,440
58,276
59,219
60,355
61,2284
63,447
66,1095
67,3028
68,97
70,225
71,2755
72,51
73,2267
75,468
77,1194
78,542
80,1668
81,2788
82,1137
83,1361
84,1987
85,5
86,85
87,73
89,1936
90,520
91,499
93,20
94,2269
98,99
99,87
102,266
104,303
105,184
106,1915
108,22
109,2336
111,21
112,28
115,209
116,970
117,296
118,357
119,419
120,1235
121,1662
122,242
124,1058
126,1605
127,49
131,2332
133,58
135,356
136,2897
137,327
140,1037
142,42
143,199
144,54
145,29
147,662
148,60
149,298
150,59
151,1999
153,505

2025-01-25 10:23:58 - root - INFO - SQL:
-- Corrected Query 9: Calculate the number of wickets taken by each bowler
SELECT b."bowler", COUNT(*) AS "wickets_taken"
FROM "wicket_taken" AS w
JOIN "ball_by_ball" AS b
  ON w."match_id" = b."match_id" 
 AND w."over_id" = b."over_id" 
 AND w."ball_id" = b."ball_id"
 AND w."innings_no" = b."innings_no"
WHERE w."kind_out" IN ('bowled', 'caught', 'lbw', 'stumped', 'hit wicket', 'caught and bowled')
GROUP BY b."bowler"
LIMIT 100
Results:
bowler,wickets_taken
1,10
4,8
5,2
8,4
9,65
10,1
12,6
13,1
14,84
15,92
16,1
21,24
22,9
25,14
27,34
29,79
31,40
32,81
35,77
37,1
38,55
39,65
41,6
42,4
44,13
45,3
48,9
49,11
50,119
53,1
54,6
56,20
57,15
58,8
59,4
60,18
61,90
63,15
66,25
67,119
68,4
70,9
71,122
72,2
73,97
75,11
77,40
78,12
80,72
81,97
82,29
83,31
84,53
85,1
86,2
87,1
89,68
90,27
91,21
94,91
98,2
99,2
102,22
104,17
105,12
106,68
108,1
109,83
112,1
115,6
116,30
117,8
118,12
119,12
120,37
121,59
122,7
124,45
126,72
131,89
135,5
136,123
137,18
140,38
142,1
143,4
144,5
147,24
148,2
149,17
151,75
153,12
154,23
155,2
156,8
157,8
158,7
159,1
160,6
161,11

2025-01-25 10:23:58 - root - INFO - SQL:
-- Corrected Query 10: List bowlers along with their total runs conceded and wickets taken
SELECT t1."bowler", t1."total_runs_conceded", t2."wickets_taken"
FROM
  (SELECT b."bowler", SUM(COALESCE(s."runs_scored", 0) + CASE WHEN e."extra_type" IN ('wides', 'noballs') THEN COALESCE(e."extra_runs", 0) ELSE 0 END) AS "total_runs_conceded"
   FROM "ball_by_ball" AS b
   LEFT JOIN "batsman_scored" AS s
     ON b."match_id" = s."match_id" 
    AND b."over_id" = s."over_id" 
    AND b."ball_id" = s."ball_id"
    AND b."innings_no" = s."innings_no"
   LEFT JOIN "extra_runs" AS e
     ON b."match_id" = e."match_id" 
    AND b."over_id" = e."over_id" 
    AND b."ball_id" = e."ball_id"
    AND b."innings_no" = e."innings_no"
   GROUP BY b."bowler") AS t1
JOIN
  (SELECT b."bowler", COUNT(*) AS "wickets_taken"
   FROM "wicket_taken" AS w
   JOIN "ball_by_ball" AS b
     ON w."match_id" = b."match_id" 
    AND w."over_id" = b."over_id" 
    AND w."ball_id" = b."ball_id"
    AND w."innings_no" = b."innings_no"
   WHERE w."kind_out" IN ('bowled', 'caught', 'lbw', 'stumped', 'hit wicket', 'caught and bowled')
   GROUP BY b."bowler") AS t2
  ON t1."bowler" = t2."bowler"
LIMIT 100
Results:
bowler,total_runs_conceded,wickets_taken
1,340,10
4,474,8
5,68,2
8,368,4
9,2289,65
10,86,1
12,242,6
13,40,1
14,3100,84
15,2469,92
16,82,1
21,997,24
22,349,9
25,548,14
27,1006,34
29,2554,79
31,1325,40
32,2120,81
35,2150,77
37,78,1
38,1422,55
39,1904,65
41,235,6
42,66,4
44,390,13
45,40,3
48,322,9
49,301,11
50,3119,119
53,0,1
54,337,6
56,674,20
57,440,15
58,276,8
59,219,4
60,355,18
61,2284,90
63,447,15
66,1095,25
67,3028,119
68,97,4
70,225,9
71,2755,122
72,51,2
73,2267,97
75,468,11
77,1194,40
78,542,12
80,1668,72
81,2788,97
82,1137,29
83,1361,31
84,1987,53
85,5,1
86,85,2
87,73,1
89,1936,68
90,520,27
91,499,21
94,2269,91
98,99,2
99,87,2
102,266,22
104,303,17
105,184,12
106,1915,68
108,22,1
109,2336,83
112,28,1
115,209,6
116,970,30
117,296,8
118,357,12
119,419,12
120,1235,37
121,1662,59
122,242,7
124,1058,45
126,1605,72
131,2332,89
135,356,5
136,2897,123
137,327,18
140,1037,38
142,42,1
143,199,4
144,54,5
147,662,24
148,60,2
149,298,17
151,1999,75
153,505,12
154,798,23
155,105,2
156,161,8
157,303,8
158,215,7
159,40,1
160,206,6
161,292,11

2025-01-25 10:23:58 - root - INFO - SQL:
-- Corrected Query 11: Compute the bowling average for each bowler
SELECT p."player_name", t1."total_runs_conceded", t2."wickets_taken",
       (CAST(t1."total_runs_conceded" AS FLOAT) / t2."wickets_taken") AS "bowling_average"
FROM
  (SELECT b."bowler", SUM(COALESCE(s."runs_scored", 0) + CASE WHEN e."extra_type" IN ('wides', 'noballs') THEN COALESCE(e."extra_runs", 0) ELSE 0 END) AS "total_runs_conceded"
   FROM "ball_by_ball" AS b
   LEFT JOIN "batsman_scored" AS s
     ON b."match_id" = s."match_id" 
    AND b."over_id" = s."over_id" 
    AND b."ball_id" = s."ball_id"
    AND b."innings_no" = s."innings_no"
   LEFT JOIN "extra_runs" AS e
     ON b."match_id" = e."match_id" 
    AND b."over_id" = e."over_id" 
    AND b."ball_id" = e."ball_id"
    AND b."innings_no" = e."innings_no"
   GROUP BY b."bowler") AS t1
JOIN
  (SELECT b."bowler", COUNT(*) AS "wickets_taken"
   FROM "wicket_taken" AS w
   JOIN "ball_by_ball" AS b
     ON w."match_id" = b."match_id" 
    AND w."over_id" = b."over_id" 
    AND w."ball_id" = b."ball_id"
    AND w."innings_no" = b."innings_no"
   WHERE w."kind_out" IN ('bowled', 'caught', 'lbw', 'stumped', 'hit wicket', 'caught and bowled')
   GROUP BY b."bowler") AS t2
  ON t1."bowler" = t2."bowler"
JOIN "player" AS p
  ON t1."bowler" = p."player_id"
WHERE t2."wickets_taken" > 0 AND t1."total_runs_conceded" > 0
ORDER BY "bowling_average" ASC
LIMIT 100
Results:
player_name,total_runs_conceded,wickets_taken,bowling_average
Sachin Baby,8,2,4.0
AM Rahane,5,1,5.0
LA Carseldine,6,1,6.0
A Zampa,115,12,9.583333333333334
DAJ Bracewell,32,3,10.666666666666666
Shoaib Akhtar,54,5,10.8
Sohail Tanvir,266,22,12.090909090909092
DJ Thornely,40,3,13.333333333333334
D du Preez,56,4,14.0
CK Langeveldt,187,13,14.384615384615385
Umar Gul,184,12,15.333333333333334
S Dhawan,66,4,16.5
Kuldeep Yadav,100,6,16.666666666666668
CRD Fernando,298,17,17.529411764705884
JM Kemp,53,3,17.666666666666668
SL Malinga,2546,143,17.804195804195803
BJ Hodge,303,17,17.823529411764707
AD Mascarenhas,327,18,18.166666666666668
BCJ Cutting,111,6,18.5
SP Narine,1591,85,18.71764705882353
DE Bollinger,693,37,18.72972972972973
S Aravind,764,40,19.1
MF Maharoof,520,27,19.25925925925926
R Rampaul,270,14,19.285714285714285
MA Starc,658,34,19.352941176470587
Gurkeerat Singh,97,5,19.4
WPUJC Vaas,355,18,19.72222222222222
T Thushara,161,8,20.125
PD Collingwood,101,5,20.2
YA Abdulla,307,15,20.466666666666665
MR Marsh,403,19,21.210526315789473
Imran Tahir,623,29,21.482758620689655
R Ninan,65,3,21.666666666666668
BW Hilfenhaus,479,22,21.772727272727273
S Vidyut,22,1,22.0
A Chandila,242,11,22.0
S Gopal,154,7,22.0
JW Hastings,66,3,22.0
A Singh,620,28,22.142857142857142
MM Patel,1605,72,22.291666666666668
Sandeep Sharma,1164,52,22.384615384615383
AP Dole,112,5,22.4
YS Chahal,1210,54,22.40740740740741
DJ Bravo,2755,122,22.581967213114755
D Wiese,363,16,22.6875
A Ashish Reddy,389,17,22.88235294117647
KK Cooper,757,33,22.939393939393938
B Kumar,1964,85,23.105882352941176
DS Kulkarni,1668,72,23.166666666666668
SMSM Senanayake,209,9,23.22222222222222
RJ Harris,1047,45,23.266666666666666
RJ Peterson,70,3,23.333333333333332
A Nehra,2267,97,23.371134020618555
NM Coulter-Nile,491,21,23.38095238095238
CJ Jordan,258,11,23.454545454545453
MJ McClenaghan,822,35,23.485714285714284
A Kumble,1058,45,23.511111111111113
A Mishra,2897,123,23.552845528455286
RE van der Merwe,498,21,23.714285714285715
VY Mahesh,499,21,23.761904761904763
MM Sharma,1666,70,23.8
KMDN Kulasekara,120,5,24.0
Azhar Mahmood,700,29,24.137931034482758
WA Mota,97,4,24.25
MP Stoinis,194,8,24.25
SM Harwood,73,3,24.333333333333332
AB McDonald,244,10,24.4
JEC Franklin,220,9,24.444444444444443
KW Richardson,416,17,24.470588235294116
CH Morris,986,40,24.65
R Ashwin,2467,100,24.67
Mustafizur Rahman,421,17,24.764705882352942
GB Hogg,570,23,24.782608695652176
SE Bond,224,9,24.88888888888889
P Parameswaran,224,9,24.88888888888889
Shakib Al Hasan,1047,42,24.928571428571427
DW Steyn,2269,91,24.934065934065934
Shahid Afridi,225,9,25.0
L Ablish,75,3,25.0
Anand Rajan,201,8,25.125
DJ Muthuswami,101,4,25.25
RP Singh,2284,90,25.377777777777776
PP Chawla,3028,119,25.445378151260503
MA Khote,51,2,25.5
MG Johnson,1312,51,25.725490196078432
RV Gomez,129,5,25.8
SK Warne,1422,55,25.854545454545455
BE Hendricks,235,9,26.11111111111111
JE Taylor,157,6,26.166666666666668
SR Watson,2120,81,26.17283950617284
PP Ojha,2332,89,26.202247191011235
Harbhajan Singh,3119,119,26.210084033613445
P Awana,1028,39,26.358974358974358
RS Bopara,292,11,26.545454545454547
L Balaji,1999,75,26.653333333333332
Karanveer Singh,321,12,26.75
Z Khan,2469,92,26.83695652173913
M Morkel,2017,75,26.893333333333334
WD Parnell,701,26,26.96153846153846
GR Napier,27,1,27.0

2025-01-25 10:23:58 - root - INFO - SQL:
-- Corrected Query 12: Identify the bowler with the lowest bowling average
SELECT p."player_name", (CAST(t1."total_runs_conceded" AS FLOAT) / t2."wickets_taken") AS "bowling_average"
FROM
  (SELECT b."bowler", SUM(COALESCE(s."runs_scored", 0) + CASE WHEN e."extra_type" IN ('wides', 'noballs') THEN COALESCE(e."extra_runs", 0) ELSE 0 END) AS "total_runs_conceded"
   FROM "ball_by_ball" AS b
   LEFT JOIN "batsman_scored" AS s
     ON b."match_id" = s."match_id" 
    AND b."over_id" = s."over_id" 
    AND b."ball_id" = s."ball_id"
    AND b."innings_no" = s."innings_no"
   LEFT JOIN "extra_runs" AS e
     ON b."match_id" = e."match_id" 
    AND b."over_id" = e."over_id" 
    AND b."ball_id" = e."ball_id"
    AND b."innings_no" = e."innings_no"
   GROUP BY b."bowler") AS t1
JOIN
  (SELECT b."bowler", COUNT(*) AS "wickets_taken"
   FROM "wicket_taken" AS w
   JOIN "ball_by_ball" AS b
     ON w."match_id" = b."match_id" 
    AND w."over_id" = b."over_id" 
    AND w."ball_id" = b."ball_id"
    AND w."innings_no" = b."innings_no"
   WHERE w."kind_out" IN ('bowled', 'caught', 'lbw', 'stumped', 'hit wicket', 'caught and bowled')
   GROUP BY b."bowler") AS t2
  ON t1."bowler" = t2."bowler"
JOIN "player" AS p
  ON t1."bowler" = p."player_id"
WHERE t2."wickets_taken" > 0 AND t1."total_runs_conceded" > 0
ORDER BY "bowling_average" ASC
LIMIT 1
Results:
player_name,bowling_average
Sachin Baby,4.0

2025-01-25 10:23:58 - root - INFO - itercount: 0
2025-01-25 10:23:58 - root - INFO - Table: playerDDL:
CREATE TABLE player(
        player_id INTEGER PRIMARY KEY,
        player_name TEXT,
        dob DATE,
        batting_hand TEXT,
        bowling_skill TEXT,
        country_name TEXT
    )
Table: teamDDL:
CREATE TABLE team(
        team_id INTEGER PRIMARY KEY,
        name TEXT
    )
Table: matchDDL:
CREATE TABLE match(
        match_id INTEGER PRIMARY KEY,
        team_1 INTEGER,
        team_2 INTEGER,
        match_date DATE,
        season_id INTEGER,
        venue TEXT,
        toss_winner INTEGER,
        toss_decision TEXT,
        win_type TEXT,
        win_margin INTEGER,
        outcome_type TEXT,
        match_winner INTEGER,
        man_of_the_match INTEGER
    )
Table: player_matchDDL:
CREATE TABLE player_match(
        match_id INTEGER NOT NULL,
        player_id INTEGER NOT NULL,
        role TEXT,
        team_id INTEGER,
        PRIMARY KEY(match_id, player_id)
    )
Table: ball_by_ballDDL:
CREATE TABLE ball_by_ball(
        match_id INTEGER NOT NULL,
        over_id INTEGER NOT NULL,
        ball_id INTEGER NOT NULL,
        innings_no INTEGER NOT NULL,
        team_batting INTEGER,
        team_bowling INTEGER,
        striker_batting_position INTEGER,
        striker INTEGER,
        non_striker INTEGER,
        bowler INTEGER,
        PRIMARY KEY(match_id, over_id, ball_id, innings_no)
    )
Table: batsman_scoredDDL:
CREATE TABLE batsman_scored(
        match_id INTEGER NOT NULL,
        over_id INTEGER NOT NULL,
        ball_id INTEGER NOT NULL,
        runs_scored INTEGER,
        innings_no INTEGER NOT NULL,
        PRIMARY KEY(match_id, over_id, ball_id, innings_no)
    )
Table: wicket_takenDDL:
CREATE TABLE wicket_taken(
        match_id INTEGER NOT NULL,
        over_id INTEGER NOT NULL,
        ball_id INTEGER NOT NULL,
        player_out INTEGER,
        kind_out TEXT,
        innings_no INTEGER NOT NULL,
        PRIMARY KEY(match_id, over_id, ball_id, innings_no)
    )
Table: extra_runsDDL:
CREATE TABLE extra_runs(
        match_id INTEGER NOT NULL,
        over_id INTEGER NOT NULL,
        ball_id INTEGER NOT NULL,
        extra_type TEXT,
        extra_runs INTEGER,
        innings_no INTEGER NOT NULL,
        PRIMARY KEY(match_id, over_id, ball_id, innings_no)
    )
External knowledge that might be helpful: 
None
The table structure information is (table names): 
['player', 'team', 'match', 'player_match', 'ball_by_ball', 'batsman_scored', 'wicket_taken', 'extra_runs']
Begin Exploring Related Columns
To determine which bowler has the lowest bowling average per wicket taken, we need to calculate the bowling average for each bowler by dividing the total runs conceded by the number of wickets they have taken. 

### **Relevant Tables and Columns**

1. **`ball_by_ball` table:**
   - `bowler`: Identifies the bowler for each delivery.
   - `match_id`, `over_id`, `ball_id`, `innings_no`: Uniquely identify each delivery.

2. **`batsman_scored` table:**
   - `runs_scored`: Runs scored off the bat on each delivery.
   - `match_id`, `over_id`, `ball_id`, `innings_no`: To join with `ball_by_ball`.

3. **`extra_runs` table:**
   - `extra_runs`: Runs conceded as extras on each delivery.
   - `extra_type`: Type of extra run (e.g., 'wides', 'no ball', 'byes', 'leg byes').
   - `match_id`, `over_id`, `ball_id`, `innings_no`: To join with `ball_by_ball`.

4. **`wicket_taken` table:**
   - `kind_out`: Mode of dismissal (e.g., 'bowled', 'caught').
   - `match_id`, `over_id`, `ball_id`, `innings_no`: To join with `ball_by_ball`.

5. **`player` table:**
   - `player_id`, `player_name`: To get the bowler's name.

### **Conditions to be Used**

- **For Runs Conceded:**
  - Include `runs_scored` from `batsman_scored`.
  - Include `extra_runs` from `extra_runs` where `extra_type` is 'wides' or 'no ball' (these extras are attributed to the bowler).
  - Exclude extras like 'byes' and 'leg byes' (not attributed to the bowler).

- **For Wickets Taken:**
  - Include dismissals where `kind_out` is one of: 'bowled', 'caught', 'lbw', 'stumped', 'hit wicket' (credited to the bowler).
  - Exclude dismissals like 'run out', 'retired hurt', etc.

### **SQL Queries to Explore the Data**

Below are 12 SQL queries ranging from simple to complex to understand the relevant data. Each query is limited to 100 rows.

1. **List all unique bowlers and their IDs:**

   ```sql
   SELECT DISTINCT b."bowler", p."player_name"
   FROM "ball_by_ball" AS b
   JOIN "player" AS p ON b."bowler" = p."player_id"
   LIMIT 100;
   ```

2. **Retrieve distinct types of extra runs:**

   ```sql
   SELECT DISTINCT e."extra_type"
   FROM "extra_runs" AS e
   LIMIT 100;
   ```

3. **Count occurrences of each extra type:**

   ```sql
   SELECT e."extra_type", COUNT(*) AS "count"
   FROM "extra_runs" AS e
   GROUP BY e."extra_type"
   LIMIT 100;
   ```

4. **List all types of dismissals (kind_out):**

   ```sql
   SELECT DISTINCT w."kind_out"
   FROM "wicket_taken" AS w
   LIMIT 100;
   ```

5. **Count occurrences of each dismissal type:**

   ```sql
   SELECT w."kind_out", COUNT(*) AS "count"
   FROM "wicket_taken" AS w
   GROUP BY w."kind_out"
   LIMIT 100;
   ```

6. **Retrieve bowler information for each wicket taken:**

   ```sql
   SELECT w."match_id", w."over_id", w."ball_id", w."player_out", w."kind_out", b."bowler"
   FROM "wicket_taken" AS w
   JOIN "ball_by_ball" AS b
     ON w."match_id" = b."match_id" 
    AND w."over_id" = b."over_id" 
    AND w."ball_id" = b."ball_id"
    AND w."innings_no" = b."innings_no"
   LIMIT 100;
   ```

7. **Calculate runs conceded per delivery by each bowler:**

   ```sql
   SELECT b."match_id", b."over_id", b."ball_id", b."bowler",
          s."runs_scored",
          e."extra_runs",
          e."extra_type",
          (s."runs_scored" + CASE WHEN e."extra_type" IN ('wides', 'no ball') THEN e."extra_runs" ELSE 0 END) AS "runs_conceded_on_ball"
   FROM "ball_by_ball" AS b
   LEFT JOIN "batsman_scored" AS s
     ON b."match_id" = s."match_id" 
    AND b."over_id" = s."over_id" 
    AND b."ball_id" = s."ball_id"
    AND b."innings_no" = s."innings_no"
   LEFT JOIN "extra_runs" AS e
     ON b."match_id" = e."match_id" 
    AND b."over_id" = e."over_id" 
    AND b."ball_id" = e."ball_id"
    AND b."innings_no" = e."innings_no"
   LIMIT 100;
   ```

8. **Compute total runs conceded by each bowler:**

   ```sql
   SELECT b."bowler", SUM(s."runs_scored" + CASE WHEN e."extra_type" IN ('wides', 'no ball') THEN e."extra_runs" ELSE 0 END) AS "total_runs_conceded"
   FROM "ball_by_ball" AS b
   LEFT JOIN "batsman_scored" AS s
     ON b."match_id" = s."match_id" 
    AND b."over_id" = s."over_id" 
    AND b."ball_id" = s."ball_id"
    AND b."innings_no" = s."innings_no"
   LEFT JOIN "extra_runs" AS e
     ON b."match_id" = e."match_id" 
    AND b."over_id" = e."over_id" 
    AND b."ball_id" = e."ball_id"
    AND b."innings_no" = e."innings_no"
   GROUP BY b."bowler"
   LIMIT 100;
   ```

9. **Calculate the number of wickets taken by each bowler:**

   ```sql
   SELECT b."bowler", COUNT(*) AS "wickets_taken"
   FROM "wicket_taken" AS w
   JOIN "ball_by_ball" AS b
     ON w."match_id" = b."match_id" 
    AND w."over_id" = b."over_id" 
    AND w."ball_id" = b."ball_id"
    AND w."innings_no" = b."innings_no"
   WHERE w."kind_out" IN ('bowled', 'caught', 'lbw', 'stumped', 'hit wicket')
   GROUP BY b."bowler"
   LIMIT 100;
   ```

10. **List bowlers along with their total runs conceded and wickets taken:**

    ```sql
    SELECT t1."bowler", t1."total_runs_conceded", t2."wickets_taken"
    FROM
      (SELECT b."bowler", SUM(s."runs_scored" + CASE WHEN e."extra_type" IN ('wides', 'no ball') THEN e."extra_runs" ELSE 0 END) AS "total_runs_conceded"
       FROM "ball_by_ball" AS b
       LEFT JOIN "batsman_scored" AS s
         ON b."match_id" = s."match_id" 
        AND b."over_id" = s."over_id" 
        AND b."ball_id" = s."ball_id"
        AND b."innings_no" = s."innings_no"
       LEFT JOIN "extra_runs" AS e
         ON b."match_id" = e."match_id" 
        AND b."over_id" = e."over_id" 
        AND b."ball_id" = e."ball_id"
        AND b."innings_no" = e."innings_no"
       GROUP BY b."bowler") AS t1
    JOIN
      (SELECT b."bowler", COUNT(*) AS "wickets_taken"
       FROM "wicket_taken" AS w
       JOIN "ball_by_ball" AS b
         ON w."match_id" = b."match_id" 
        AND w."over_id" = b."over_id" 
        AND w."ball_id" = b."ball_id"
        AND w."innings_no" = b."innings_no"
       WHERE w."kind_out" IN ('bowled', 'caught', 'lbw', 'stumped', 'hit wicket')
       GROUP BY b."bowler") AS t2
      ON t1."bowler" = t2."bowler"
    LIMIT 100;
    ```

11. **Compute the bowling average for each bowler:**

    ```sql
    SELECT p."player_name", t1."total_runs_conceded", t2."wickets_taken",
           (CAST(t1."total_runs_conceded" AS FLOAT) / t2."wickets_taken") AS "bowling_average"
    FROM
      (SELECT b."bowler", SUM(s."runs_scored" + CASE WHEN e."extra_type" IN ('wides', 'no ball') THEN e."extra_runs" ELSE 0 END) AS "total_runs_conceded"
       FROM "ball_by_ball" AS b
       LEFT JOIN "batsman_scored" AS s
         ON b."match_id" = s."match_id" 
        AND b."over_id" = s."over_id" 
        AND b."ball_id" = s."ball_id"
        AND b."innings_no" = s."innings_no"
       LEFT JOIN "extra_runs" AS e
         ON b."match_id" = e."match_id" 
        AND b."over_id" = e."over_id" 
        AND b."ball_id" = e."ball_id"
        AND b."innings_no" = e."innings_no"
       GROUP BY b."bowler") AS t1
    JOIN
      (SELECT b."bowler", COUNT(*) AS "wickets_taken"
       FROM "wicket_taken" AS w
       JOIN "ball_by_ball" AS b
         ON w."match_id" = b."match_id" 
        AND w."over_id" = b."over_id" 
        AND w."ball_id" = b."ball_id"
        AND w."innings_no" = b."innings_no"
       WHERE w."kind_out" IN ('bowled', 'caught', 'lbw', 'stumped', 'hit wicket')
       GROUP BY b."bowler") AS t2
      ON t1."bowler" = t2."bowler"
    JOIN "player" AS p
      ON t1."bowler" = p."player_id"
    WHERE t2."wickets_taken" > 0
    ORDER BY "bowling_average" ASC
    LIMIT 100;
    ```

12. **Identify the bowler with the lowest bowling average:**

    ```sql
    SELECT p."player_name", (CAST(t1."total_runs_conceded" AS FLOAT) / t2."wickets_taken") AS "bowling_average"
    FROM
      (SELECT b."bowler", SUM(s."runs_scored" + CASE WHEN e."extra_type" IN ('wides', 'no ball') THEN e."extra_runs" ELSE 0 END) AS "total_runs_conceded"
       FROM "ball_by_ball" AS b
       LEFT JOIN "batsman_scored" AS s
         ON b."match_id" = s."match_id" 
        AND b."over_id" = s."over_id" 
        AND b."ball_id" = s."ball_id"
        AND b."innings_no" = s."innings_no"
       LEFT JOIN "extra_runs" AS e
         ON b."match_id" = e."match_id" 
        AND b."over_id" = e."over_id" 
        AND b."ball_id" = e."ball_id"
        AND b."innings_no" = e."innings_no"
       GROUP BY b."bowler") AS t1
    JOIN
      (SELECT b."bowler", COUNT(*) AS "wickets_taken"
       FROM "wicket_taken" AS w
       JOIN "ball_by_ball" AS b
         ON w."match_id" = b."match_id" 
        AND w."over_id" = b."over_id" 
        AND w."ball_id" = b."ball_id"
        AND w."innings_no" = b."innings_no"
       WHERE w."kind_out" IN ('bowled', 'caught', 'lbw', 'stumped', 'hit wicket')
       GROUP BY b."bowler") AS t2
      ON t1."bowler" = t2."bowler"
    JOIN "player" AS p
      ON t1."bowler" = p."player_id"
    WHERE t2."wickets_taken" > 0
    ORDER BY "bowling_average" ASC
    LIMIT 1;
    ```

    *(This query retrieves the bowler with the lowest bowling average.)*

These queries progressively explore the data required to compute the bowling averages and identify the bowler with the lowest average per wicket taken.Query:
SELECT DISTINCT b."bowler", p."player_name"
   FROM "ball_by_ball" AS b
   JOIN "player" AS p ON b."bowler" = p."player_id"
   LIMIT 100;
Answer:
bowler,player_name
106,AB Dinda
14,P Kumar
15,Z Khan
84,I Sharma
13,AA Noffke
82,AB Agarkar
1,SC Ganguly
9,JH Kallis
16,SB Joshi
63,LR Shukla
10,CL White
66,B Lee
22,JDP Oram
77,S Sreesanth
120,MS Gony
25,JR Hopes
29,IK Pathan
121,M Muralitharan
435,P Amarnath
119,Joginder Sharma
24,K Goel
67,PP Chawla
68,WA Mota
118,GD McGrath
126,MM Patel
436,B Geeves
32,SR Watson
90,MF Maharoof
39,SK Trivedi
89,R Bhatia
38,SK Warne
31,YK Pathan
175,DL Vettori
37,D Salunkhe
73,A Nehra
49,SM Pollock
80,DS Kulkarni
81,R Vinay Kumar
12,B Akhil
44,ST Jayasuriya
50,Harbhajan Singh
48,AM Nayar
60,WPUJC Vaas
61,RP Singh
58,SB Styris
83,M Kartik
59,SB Bangar
5,Mohammad Hafeez
56,A Symonds
4,DJ Hussey
131,PP Ojha
75,Pankaj Singh
117,Mohammad Asif
70,Shahid Afridi
91,VY Mahesh
71,DJ Bravo
150,VS Yeligati
72,MA Khote
99,D Kalyankrishna
78,VRV Singh
102,Sohail Tanvir
124,A Kumble
98,DNT Zoysa
148,SD Chitnis
86,Shoaib Malik
27,Yuvraj Singh
94,DW Steyn
109,JA Morkel
149,CRD Fernando
8,V Kohli
41,V Sehwag
54,Y Venugopal Rao
437,Gagandeep Singh
105,Umar Gul
122,M Ntini
116,PJ Sangwan
143,DP Vijaykumar
112,DB Ravi Teja
111,LPC Silva
45,DJ Thornely
115,RR Raje
21,SK Raina
108,S Vidyut
151,L Balaji
127,CK Kapugedera
147,DR Smith
137,AD Mascarenhas
136,A Mishra
144,Shoaib Akhtar
140,Iqbal Abdulla
153,RR Powar
142,PM Sarvesh Kumar
145,Abdur Razzak
135,TM Dilshan
57,RG Sharma
438,A Nel
174,BAW Mendis
194,SL Malinga
156,T Thushara
155,A Flintoff
Query:
SELECT DISTINCT e."extra_type"
   FROM "extra_runs" AS e
   LIMIT 100;
Answer:
extra_type
legbyes
wides
byes
noballs
penalty
Query:
SELECT e."extra_type", COUNT(*) AS "count"
   FROM "extra_runs" AS e
   GROUP BY e."extra_type"
   LIMIT 100;
Answer:
extra_type,count
byes,373
legbyes,2317
noballs,567
penalty,1
wides,4091
Query:
SELECT DISTINCT w."kind_out"
   FROM "wicket_taken" AS w
   LIMIT 100;
Answer:
kind_out
caught
bowled
run out
lbw
retired hurt
stumped
caught and bowled
hit wicket
obstructing the field
Query:
SELECT w."kind_out", COUNT(*) AS "count"
   FROM "wicket_taken" AS w
   GROUP BY w."kind_out"
   LIMIT 100;
Answer:
kind_out,count
bowled,1234
caught,3894
caught and bowled,184
hit wicket,8
lbw,393
obstructing the field,1
retired hurt,8
run out,677
stumped,219
Query:
SELECT w."match_id", w."over_id", w."ball_id", w."player_out", w."kind_out", b."bowler"
   FROM "wicket_taken" AS w
   JOIN "ball_by_ball" AS b
     ON w."match_id" = b."match_id" 
    AND w."over_id" = b."over_id" 
    AND w."ball_id" = b."ball_id"
    AND w."innings_no" = b."innings_no"
   LIMIT 100;
Answer:
match_id,over_id,ball_id,player_out,kind_out,bowler
419167,10,3,154,caught,124
419167,10,3,46,caught,221
419167,12,4,8,caught,221
419167,14,4,96,caught,221
419167,18,4,208,caught,94
419168,2,7,18,caught,188
419168,5,5,21,caught,56
419168,6,1,53,caught,248
419168,6,5,178,caught,248
419168,8,2,57,caught,109
419168,14,2,20,caught,256
419168,15,5,109,caught,131
419168,16,2,56,caught,201
419168,18,4,188,caught,248
419168,20,2,131,caught,21
419168,20,4,125,caught,188
419169,1,4,53,caught,124
419169,4,2,57,caught,14
419169,7,1,56,caught,94
419169,17,3,54,caught,298
419169,19,3,131,caught,124
419170,2,4,42,caught,248
419170,8,2,185,caught,149
419170,9,4,18,caught,221
419170,12,2,23,caught,149
419170,15,2,133,caught,186
419170,15,5,79,caught,186
419170,17,6,154,caught,121
419170,18,1,20,caught,15
419170,19,6,221,caught,109
501203,1,6,185,caught,140
501203,11,3,21,caught,31
501203,16,2,9,caught,201
501203,18,2,20,caught,9
501203,20,2,63,caught,377
501204,5,5,42,caught,196
501204,6,3,26,caught,39
501204,6,5,252,caught,94
501204,11,1,257,caught,38
501204,13,6,154,caught,38
501204,18,3,258,caught,39
501204,20,1,112,caught,196
501204,20,3,94,caught,196
501205,2,2,135,caught,77
501205,9,6,55,caught,135
501205,10,6,260,caught,35
501205,12,3,2,caught,8
501205,18,4,79,caught,259
501205,19,4,259,caught,223
501206,7,6,254,caught,50
501206,15,2,183,caught,286
501206,18,4,106,caught,194
501207,1,1,74,caught,14
501207,1,4,53,caught,274
501207,2,3,100,caught,273
501207,3,4,167,caught,274
501207,4,3,88,caught,273
501207,8,5,171,caught,48
501207,9,3,48,caught,157
501207,9,3,157,caught,210
501207,18,1,67,caught,273
501207,20,1,14,caught,267
501208,9,6,26,caught,89
501208,13,2,154,caught,140
501208,13,3,9,caught,154
501208,14,6,93,caught,89
501208,17,4,258,caught,140
501208,18,1,112,caught,346
501208,20,6,31,caught,94
501209,1,3,41,caught,238
501209,5,5,254,caught,238
501209,8,1,262,caught,38
501209,8,3,183,caught,38
501209,8,3,6,caught,177
501209,11,5,266,caught,29
501209,18,4,187,caught,196
501209,19,7,54,caught,39
501210,5,4,8,caught,221
501211,1,2,21,caught,14
501211,6,5,53,caught,109
501211,14,6,264,caught,278
501212,1,1,2,caught,274
501212,3,5,64,caught,267
501212,5,5,17,caught,267
501212,8,4,74,caught,35
501212,10,5,171,caught,104
501212,12,2,27,caught,104
501212,16,2,104,caught,235
501212,17,1,35,caught,157
501213,2,6,135,caught,84
501213,3,5,42,caught,15
501213,5,6,260,caught,120
501213,7,4,110,caught,120
501213,9,6,65,caught,269
501213,12,1,79,caught,136
501213,15,4,26,caught,268
501213,17,5,203,caught,94
501213,17,6,268,caught,94
501213,20,1,269,caught,258
501213,20,2,154,caught,15
Query:
SELECT b."match_id", b."over_id", b."ball_id", b."bowler",
          s."runs_scored",
          e."extra_runs",
          e."extra_type",
          (s."runs_scored" + CASE WHEN e."extra_type" IN ('wides', 'no ball') THEN e."extra_runs" ELSE 0 END) AS "runs_conceded_on_ball"
   FROM "ball_by_ball" AS b
   LEFT JOIN "batsman_scored" AS s
     ON b."match_id" = s."match_id" 
    AND b."over_id" = s."over_id" 
    AND b."ball_id" = s."ball_id"
    AND b."innings_no" = s."innings_no"
   LEFT JOIN "extra_runs" AS e
     ON b."match_id" = e."match_id" 
    AND b."over_id" = e."over_id" 
    AND b."ball_id" = e."ball_id"
    AND b."innings_no" = e."innings_no"
   LIMIT 100;
Answer:
match_id,over_id,ball_id,bowler,runs_scored,extra_runs,extra_type,runs_conceded_on_ball
335987,1,1,106,1.0,,,1.0
335987,1,2,14,0.0,,,0.0
335987,1,2,106,,1.0,wides,
335987,1,3,14,,1.0,wides,
335987,1,3,106,0.0,,,0.0
335987,1,4,14,0.0,,,0.0
335987,1,4,106,1.0,,,1.0
335987,1,5,14,0.0,,,0.0
335987,1,5,106,1.0,,,1.0
335987,1,6,14,0.0,,,0.0
335987,1,6,106,0.0,,,0.0
335987,1,7,14,0.0,1.0,legbyes,0.0
335987,1,7,106,0.0,,,0.0
335987,2,1,15,0.0,,,0.0
335987,2,1,84,0.0,,,0.0
335987,2,2,15,4.0,,,4.0
335987,2,2,84,0.0,,,0.0
335987,2,3,15,4.0,,,4.0
335987,2,3,84,0.0,4.0,legbyes,0.0
335987,2,4,15,6.0,,,6.0
335987,2,4,84,1.0,,,1.0
335987,2,5,15,4.0,,,4.0
335987,2,5,84,0.0,,,0.0
335987,2,6,15,0.0,,,0.0
335987,2,6,84,0.0,,,0.0
335987,3,1,14,0.0,,,0.0
335987,3,1,106,0.0,,,0.0
335987,3,2,14,0.0,,,0.0
335987,3,2,106,0.0,,,0.0
335987,3,3,14,0.0,1.0,legbyes,0.0
335987,3,3,106,1.0,,,1.0
335987,3,4,14,4.0,,,4.0
335987,3,4,106,0.0,,,0.0
335987,3,5,14,1.0,,,1.0
335987,3,5,106,,1.0,wides,
335987,3,6,14,0.0,,,0.0
335987,3,6,106,0.0,,,0.0
335987,3,7,106,1.0,,,1.0
335987,4,1,13,,5.0,wides,
335987,4,1,84,2.0,,,2.0
335987,4,2,13,6.0,,,6.0
335987,4,2,84,1.0,,,1.0
335987,4,3,13,0.0,1.0,legbyes,0.0
335987,4,3,84,0.0,,,0.0
335987,4,4,13,4.0,,,4.0
335987,4,4,84,0.0,1.0,legbyes,0.0
335987,4,5,13,0.0,,,0.0
335987,4,5,84,0.0,,,0.0
335987,4,6,13,1.0,,,1.0
335987,4,6,84,0.0,,,0.0
335987,4,7,13,6.0,,,6.0
335987,5,1,14,4.0,,,4.0
335987,5,1,82,1.0,,,1.0
335987,5,2,14,1.0,,,1.0
335987,5,2,82,1.0,,,1.0
335987,5,3,14,4.0,,,4.0
335987,5,3,82,0.0,,,0.0
335987,5,4,14,0.0,,,0.0
335987,5,4,82,6.0,,,6.0
335987,5,5,14,1.0,,,1.0
335987,5,5,82,0.0,,,0.0
335987,5,6,14,0.0,,,0.0
335987,5,6,82,0.0,,,0.0
335987,6,1,15,1.0,,,1.0
335987,6,1,106,0.0,,,0.0
335987,6,2,15,0.0,,,0.0
335987,6,2,106,0.0,,,0.0
335987,6,3,15,0.0,,,0.0
335987,6,3,106,0.0,,,0.0
335987,6,4,15,0.0,,,0.0
335987,6,4,106,1.0,,,1.0
335987,6,5,15,0.0,,,0.0
335987,6,5,106,1.0,,,1.0
335987,6,6,15,0.0,,,0.0
335987,6,6,106,0.0,,,0.0
335987,7,1,13,1.0,,,1.0
335987,7,1,82,0.0,,,0.0
335987,7,2,13,1.0,,,1.0
335987,7,2,82,0.0,,,0.0
335987,7,3,13,1.0,,,1.0
335987,7,3,82,1.0,,,1.0
335987,7,4,13,2.0,,,2.0
335987,7,4,82,,1.0,wides,
335987,7,5,13,1.0,,,1.0
335987,7,5,82,,1.0,wides,
335987,7,6,13,1.0,,,1.0
335987,7,6,82,0.0,,,0.0
335987,7,7,82,0.0,,,0.0
335987,7,8,82,4.0,,,4.0
335987,8,1,15,0.0,,,0.0
335987,8,1,1,1.0,,,1.0
335987,8,2,15,1.0,,,1.0
335987,8,2,1,0.0,1.0,legbyes,0.0
335987,8,3,15,1.0,,,1.0
335987,8,3,1,1.0,,,1.0
335987,8,4,15,1.0,,,1.0
335987,8,4,1,2.0,,,2.0
335987,8,5,15,1.0,,,1.0
335987,8,5,1,0.0,,,0.0
335987,8,6,15,1.0,,,1.0
Query:
SELECT b."bowler", SUM(s."runs_scored" + CASE WHEN e."extra_type" IN ('wides', 'no ball') THEN e."extra_runs" ELSE 0 END) AS "total_runs_conceded"
   FROM "ball_by_ball" AS b
   LEFT JOIN "batsman_scored" AS s
     ON b."match_id" = s."match_id" 
    AND b."over_id" = s."over_id" 
    AND b."ball_id" = s."ball_id"
    AND b."innings_no" = s."innings_no"
   LEFT JOIN "extra_runs" AS e
     ON b."match_id" = e."match_id" 
    AND b."over_id" = e."over_id" 
    AND b."ball_id" = e."ball_id"
    AND b."innings_no" = e."innings_no"
   GROUP BY b."bowler"
   LIMIT 100;
Answer:
bowler,total_runs_conceded
1,336
4,468
5,61
8,354
9,2232
10,83
12,235
13,35
14,2996
15,2394
16,82
21,976
22,344
24,92
25,539
27,997
29,2482
31,1295
32,2033
35,2116
37,70
38,1385
39,1862
41,233
42,66
44,375
45,38
48,311
49,297
50,3047
52,23
53,0
54,329
56,656
57,425
58,270
59,212
60,345
61,2197
63,429
66,1048
67,2973
68,94
70,220
71,2686
72,51
73,2206
75,454
77,1115
78,531
80,1590
81,2743
82,1106
83,1332
84,1895
85,5
86,77
87,71
89,1913
90,494
91,483
93,20
94,2174
98,96
99,85
102,246
104,294
105,166
106,1848
108,21
109,2251
111,21
112,28
115,200
116,923
117,289
118,352
119,402
120,1209
121,1604
122,238
124,1027
126,1583
127,49
131,2276
133,57
135,353
136,2837
137,325
140,1019
142,41
143,193
144,50
145,23
147,643
148,54
149,279
150,53
151,1940
153,480
Query:
SELECT b."bowler", COUNT(*) AS "wickets_taken"
   FROM "wicket_taken" AS w
   JOIN "ball_by_ball" AS b
     ON w."match_id" = b."match_id" 
    AND w."over_id" = b."over_id" 
    AND w."ball_id" = b."ball_id"
    AND w."innings_no" = b."innings_no"
   WHERE w."kind_out" IN ('bowled', 'caught', 'lbw', 'stumped', 'hit wicket')
   GROUP BY b."bowler"
   LIMIT 100;
Answer:
bowler,wickets_taken
1,10
4,8
5,2
8,4
9,64
10,1
12,6
13,1
14,83
15,91
16,1
21,21
22,8
25,13
27,32
29,76
31,38
32,79
35,74
37,1
38,50
39,63
41,6
42,4
44,13
45,2
48,9
49,11
50,109
53,1
54,6
56,19
57,14
58,8
59,4
60,18
61,88
63,14
66,23
67,115
68,4
70,9
71,114
72,2
73,95
75,11
77,40
78,12
80,69
81,94
82,28
83,29
84,53
85,1
86,1
87,1
89,67
90,27
91,21
94,89
98,1
99,2
102,22
104,17
105,12
106,68
108,1
109,81
112,1
115,6
116,30
117,7
118,12
119,12
120,35
121,58
122,7
124,44
126,69
131,89
135,5
136,120
137,17
140,36
142,1
143,4
144,5
147,24
148,2
149,16
151,73
153,12
154,21
155,1
156,8
157,8
158,7
159,1
160,6
161,8
Query:
SELECT t1."bowler", t1."total_runs_conceded", t2."wickets_taken"
    FROM
      (SELECT b."bowler", SUM(s."runs_scored" + CASE WHEN e."extra_type" IN ('wides', 'no ball') THEN e."extra_runs" ELSE 0 END) AS "total_runs_conceded"
       FROM "ball_by_ball" AS b
       LEFT JOIN "batsman_scored" AS s
         ON b."match_id" = s."match_id" 
        AND b."over_id" = s."over_id" 
        AND b."ball_id" = s."ball_id"
        AND b."innings_no" = s."innings_no"
       LEFT JOIN "extra_runs" AS e
         ON b."match_id" = e."match_id" 
        AND b."over_id" = e."over_id" 
        AND b."ball_id" = e."ball_id"
        AND b."innings_no" = e."innings_no"
       GROUP BY b."bowler") AS t1
    JOIN
      (SELECT b."bowler", COUNT(*) AS "wickets_taken"
       FROM "wicket_taken" AS w
       JOIN "ball_by_ball" AS b
         ON w."match_id" = b."match_id" 
        AND w."over_id" = b."over_id" 
        AND w."ball_id" = b."ball_id"
        AND w."innings_no" = b."innings_no"
       WHERE w."kind_out" IN ('bowled', 'caught', 'lbw', 'stumped', 'hit wicket')
       GROUP BY b."bowler") AS t2
      ON t1."bowler" = t2."bowler"
    LIMIT 100;
Answer:
bowler,total_runs_conceded,wickets_taken
1,336,10
4,468,8
5,61,2
8,354,4
9,2232,64
10,83,1
12,235,6
13,35,1
14,2996,83
15,2394,91
16,82,1
21,976,21
22,344,8
25,539,13
27,997,32
29,2482,76
31,1295,38
32,2033,79
35,2116,74
37,70,1
38,1385,50
39,1862,63
41,233,6
42,66,4
44,375,13
45,38,2
48,311,9
49,297,11
50,3047,109
53,0,1
54,329,6
56,656,19
57,425,14
58,270,8
59,212,4
60,345,18
61,2197,88
63,429,14
66,1048,23
67,2973,115
68,94,4
70,220,9
71,2686,114
72,51,2
73,2206,95
75,454,11
77,1115,40
78,531,12
80,1590,69
81,2743,94
82,1106,28
83,1332,29
84,1895,53
85,5,1
86,77,1
87,71,1
89,1913,67
90,494,27
91,483,21
94,2174,89
98,96,1
99,85,2
102,246,22
104,294,17
105,166,12
106,1848,68
108,21,1
109,2251,81
112,28,1
115,200,6
116,923,30
117,289,7
118,352,12
119,402,12
120,1209,35
121,1604,58
122,238,7
124,1027,44
126,1583,69
131,2276,89
135,353,5
136,2837,120
137,325,17
140,1019,36
142,41,1
143,193,4
144,50,5
147,643,24
148,54,2
149,279,16
151,1940,73
153,480,12
154,772,21
155,105,1
156,152,8
157,299,8
158,209,7
159,40,1
160,199,6
161,276,8
Query:
SELECT p."player_name", t1."total_runs_conceded", t2."wickets_taken",
           (CAST(t1."total_runs_conceded" AS FLOAT) / t2."wickets_taken") AS "bowling_average"
    FROM
      (SELECT b."bowler", SUM(s."runs_scored" + CASE WHEN e."extra_type" IN ('wides', 'no ball') THEN e."extra_runs" ELSE 0 END) AS "total_runs_conceded"
       FROM "ball_by_ball" AS b
       LEFT JOIN "batsman_scored" AS s
         ON b."match_id" = s."match_id" 
        AND b."over_id" = s."over_id" 
        AND b."ball_id" = s."ball_id"
        AND b."innings_no" = s."innings_no"
       LEFT JOIN "extra_runs" AS e
         ON b."match_id" = e."match_id" 
        AND b."over_id" = e."over_id" 
        AND b."ball_id" = e."ball_id"
        AND b."innings_no" = e."innings_no"
       GROUP BY b."bowler") AS t1
    JOIN
      (SELECT b."bowler", COUNT(*) AS "wickets_taken"
       FROM "wicket_taken" AS w
       JOIN "ball_by_ball" AS b
         ON w."match_id" = b."match_id" 
        AND w."over_id" = b."over_id" 
        AND w."ball_id" = b."ball_id"
        AND w."innings_no" = b."innings_no"
       WHERE w."kind_out" IN ('bowled', 'caught', 'lbw', 'stumped', 'hit wicket')
       GROUP BY b."bowler") AS t2
      ON t1."bowler" = t2."bowler"
    JOIN "player" AS p
      ON t1."bowler" = p."player_id"
    WHERE t2."wickets_taken" > 0
    ORDER BY "bowling_average" ASC
    LIMIT 100;
Answer:
player_name,total_runs_conceded,wickets_taken,bowling_average
AC Gilchrist,0,1,0.0
Sachin Baby,8,2,4.0
AM Rahane,5,1,5.0
LA Carseldine,5,1,5.0
A Zampa,110,12,9.166666666666666
Shoaib Akhtar,50,5,10.0
DAJ Bracewell,32,3,10.666666666666666
Sohail Tanvir,246,22,11.181818181818182
CK Langeveldt,178,13,13.692307692307692
D du Preez,55,4,13.75
Umar Gul,166,12,13.833333333333334
S Dhawan,66,4,16.5
JM Kemp,51,3,17.0
BJ Hodge,294,17,17.294117647058822
CRD Fernando,279,16,17.4375
SL Malinga,2423,138,17.557971014492754
MA Starc,622,34,18.294117647058822
MF Maharoof,494,27,18.296296296296298
BCJ Cutting,110,6,18.333333333333332
Gurkeerat Singh,93,5,18.6
R Rampaul,263,14,18.785714285714285
Kuldeep Yadav,94,5,18.8
DJ Thornely,38,2,19.0
T Thushara,152,8,19.0
DE Bollinger,667,35,19.057142857142857
AD Mascarenhas,325,17,19.11764705882353
WPUJC Vaas,345,18,19.166666666666668
YA Abdulla,294,15,19.6
SP Narine,1573,79,19.911392405063292
S Aravind,739,37,19.972972972972972
SM Harwood,61,3,20.333333333333332
Imran Tahir,598,29,20.620689655172413
MR Marsh,395,19,20.789473684210527
S Vidyut,21,1,21.0
AP Dole,105,5,21.0
JW Hastings,63,3,21.0
BW Hilfenhaus,470,22,21.363636363636363
R Ninan,65,3,21.666666666666668
Sandeep Sharma,1131,52,21.75
A Singh,614,28,21.928571428571427
YS Chahal,1185,53,22.358490566037737
MJ McClenaghan,787,35,22.485714285714284
A Ashish Reddy,385,17,22.647058823529413
NM Coulter-Nile,476,21,22.666666666666668
MM Patel,1583,69,22.942028985507246
VY Mahesh,483,21,23.0
SMSM Senanayake,207,9,23.0
DS Kulkarni,1590,69,23.043478260869566
KK Cooper,739,32,23.09375
A Nehra,2206,95,23.221052631578946
RJ Harris,1001,43,23.27906976744186
RJ Peterson,70,3,23.333333333333332
A Kumble,1027,44,23.34090909090909
B Kumar,1894,81,23.382716049382715
D Wiese,351,15,23.4
WA Mota,94,4,23.5
DJ Bravo,2686,114,23.56140350877193
A Mishra,2837,120,23.641666666666666
CH Morris,948,40,23.7
MM Sharma,1639,69,23.753623188405797
MP Stoinis,191,8,23.875
L Ablish,72,3,24.0
CJ Jordan,241,10,24.1
Anand Rajan,193,8,24.125
Mustafizur Rahman,411,17,24.176470588235293
JEC Franklin,218,9,24.22222222222222
AB McDonald,243,10,24.3
GB Hogg,559,23,24.304347826086957
DW Steyn,2174,89,24.426966292134832
Shahid Afridi,220,9,24.444444444444443
R Ashwin,2388,97,24.61855670103093
MG Johnson,1261,51,24.725490196078432
Azhar Mahmood,695,28,24.821428571428573
BE Hendricks,224,9,24.88888888888889
Shakib Al Hasan,1023,41,24.951219512195124
RP Singh,2197,88,24.96590909090909
PD Collingwood,100,4,25.0
WD Parnell,652,26,25.076923076923077
KW Richardson,404,16,25.25
DJ Muthuswami,101,4,25.25
JE Taylor,152,6,25.333333333333332
MA Khote,51,2,25.5
S Gopal,153,6,25.5
PP Ojha,2276,89,25.573033707865168
RE van der Merwe,486,19,25.57894736842105
RV Gomez,128,5,25.6
SR Watson,2033,79,25.734177215189874
PP Chawla,2973,115,25.85217391304348
CR Brathwaite,181,7,25.857142857142858
TA Boult,259,10,25.9
P Awana,1013,39,25.974358974358974
Karanveer Singh,312,12,26.0
M Morkel,1954,75,26.053333333333335
SB Wagh,131,5,26.2
Z Khan,2394,91,26.307692307692307
SM Boland,53,2,26.5
L Balaji,1940,73,26.575342465753426
DR Smith,643,24,26.791666666666668
SW Tait,590,22,26.818181818181817
SM Pollock,297,11,27.0
Query:
SELECT p."player_name", (CAST(t1."total_runs_conceded" AS FLOAT) / t2."wickets_taken") AS "bowling_average"
FROM
  (SELECT b."bowler", 
          SUM(COALESCE(s."runs_scored", 0) + 
              CASE WHEN e."extra_type" IN ('wides', 'noballs') THEN COALESCE(e."extra_runs", 0) ELSE 0 END) AS "total_runs_conceded"
   FROM "ball_by_ball" AS b
   LEFT JOIN "batsman_scored" AS s
     ON b."match_id" = s."match_id" 
    AND b."over_id" = s."over_id" 
    AND b."ball_id" = s."ball_id"
    AND b."innings_no" = s."innings_no"
   LEFT JOIN "extra_runs" AS e
     ON b."match_id" = e."match_id" 
    AND b."over_id" = e."over_id" 
    AND b."ball_id" = e."ball_id"
    AND b."innings_no" = e."innings_no"
   GROUP BY b."bowler") AS t1
JOIN
  (SELECT b."bowler", COUNT(*) AS "wickets_taken"
   FROM "wicket_taken" AS w
   JOIN "ball_by_ball" AS b
     ON w."match_id" = b."match_id" 
    AND w."over_id" = b."over_id" 
    AND w."ball_id" = b."ball_id"
    AND w."innings_no" = b."innings_no"
   WHERE w."kind_out" IN ('bowled', 'caught', 'lbw', 'stumped', 'hit wicket', 'caught and bowled')
   GROUP BY b."bowler") AS t2
  ON t1."bowler" = t2."bowler"
JOIN "player" AS p
  ON t1."bowler" = p."player_id"
WHERE t2."wickets_taken" > 0 AND t1."total_runs_conceded" > 0
ORDER BY "bowling_average" ASC
LIMIT 1;
Answer:
player_name,bowling_average
Sachin Baby,4.0
Query:
-- Corrected Query 7: Calculate runs conceded per delivery by each bowler
SELECT b."match_id", b."over_id", b."ball_id", b."bowler",
       COALESCE(s."runs_scored", 0) AS "runs_scored",
       e."extra_runs",
       e."extra_type",
       (COALESCE(s."runs_scored", 0) + CASE WHEN e."extra_type" IN ('wides', 'noballs') THEN COALESCE(e."extra_runs", 0) ELSE 0 END) AS "runs_conceded_on_ball"
FROM "ball_by_ball" AS b
LEFT JOIN "batsman_scored" AS s
  ON b."match_id" = s."match_id" 
 AND b."over_id" = s."over_id" 
 AND b."ball_id" = s."ball_id"
 AND b."innings_no" = s."innings_no"
LEFT JOIN "extra_runs" AS e
  ON b."match_id" = e."match_id" 
 AND b."over_id" = e."over_id" 
 AND b."ball_id" = e."ball_id"
 AND b."innings_no" = e."innings_no"
LIMIT 100
Answer:
match_id,over_id,ball_id,bowler,runs_scored,extra_runs,extra_type,runs_conceded_on_ball
335987,1,1,106,1,,,1
335987,1,2,14,0,,,0
335987,1,2,106,0,1.0,wides,1
335987,1,3,14,0,1.0,wides,1
335987,1,3,106,0,,,0
335987,1,4,14,0,,,0
335987,1,4,106,1,,,1
335987,1,5,14,0,,,0
335987,1,5,106,1,,,1
335987,1,6,14,0,,,0
335987,1,6,106,0,,,0
335987,1,7,14,0,1.0,legbyes,0
335987,1,7,106,0,,,0
335987,2,1,15,0,,,0
335987,2,1,84,0,,,0
335987,2,2,15,4,,,4
335987,2,2,84,0,,,0
335987,2,3,15,4,,,4
335987,2,3,84,0,4.0,legbyes,0
335987,2,4,15,6,,,6
335987,2,4,84,1,,,1
335987,2,5,15,4,,,4
335987,2,5,84,0,,,0
335987,2,6,15,0,,,0
335987,2,6,84,0,,,0
335987,3,1,14,0,,,0
335987,3,1,106,0,,,0
335987,3,2,14,0,,,0
335987,3,2,106,0,,,0
335987,3,3,14,0,1.0,legbyes,0
335987,3,3,106,1,,,1
335987,3,4,14,4,,,4
335987,3,4,106,0,,,0
335987,3,5,14,1,,,1
335987,3,5,106,0,1.0,wides,1
335987,3,6,14,0,,,0
335987,3,6,106,0,,,0
335987,3,7,106,1,,,1
335987,4,1,13,0,5.0,wides,5
335987,4,1,84,2,,,2
335987,4,2,13,6,,,6
335987,4,2,84,1,,,1
335987,4,3,13,0,1.0,legbyes,0
335987,4,3,84,0,,,0
335987,4,4,13,4,,,4
335987,4,4,84,0,1.0,legbyes,0
335987,4,5,13,0,,,0
335987,4,5,84,0,,,0
335987,4,6,13,1,,,1
335987,4,6,84,0,,,0
335987,4,7,13,6,,,6
335987,5,1,14,4,,,4
335987,5,1,82,1,,,1
335987,5,2,14,1,,,1
335987,5,2,82,1,,,1
335987,5,3,14,4,,,4
335987,5,3,82,0,,,0
335987,5,4,14,0,,,0
335987,5,4,82,6,,,6
335987,5,5,14,1,,,1
335987,5,5,82,0,,,0
335987,5,6,14,0,,,0
335987,5,6,82,0,,,0
335987,6,1,15,1,,,1
335987,6,1,106,0,,,0
335987,6,2,15,0,,,0
335987,6,2,106,0,,,0
335987,6,3,15,0,,,0
335987,6,3,106,0,,,0
335987,6,4,15,0,,,0
335987,6,4,106,1,,,1
335987,6,5,15,0,,,0
335987,6,5,106,1,,,1
335987,6,6,15,0,,,0
335987,6,6,106,0,,,0
335987,7,1,13,1,,,1
335987,7,1,82,0,,,0
335987,7,2,13,1,,,1
335987,7,2,82,0,,,0
335987,7,3,13,1,,,1
335987,7,3,82,1,,,1
335987,7,4,13,2,,,2
335987,7,4,82,0,1.0,wides,1
335987,7,5,13,1,,,1
335987,7,5,82,0,1.0,wides,1
335987,7,6,13,1,,,1
335987,7,6,82,0,,,0
335987,7,7,82,0,,,0
335987,7,8,82,4,,,4
335987,8,1,15,0,,,0
335987,8,1,1,1,,,1
335987,8,2,15,1,,,1
335987,8,2,1,0,1.0,legbyes,0
335987,8,3,15,1,,,1
335987,8,3,1,1,,,1
335987,8,4,15,1,,,1
335987,8,4,1,2,,,2
335987,8,5,15,1,,,1
335987,8,5,1,0,,,0
335987,8,6,15,1,,,1
Query:
-- Corrected Query 8: Compute total runs conceded by each bowler
SELECT b."bowler", SUM(COALESCE(s."runs_scored", 0) + CASE WHEN e."extra_type" IN ('wides', 'noballs') THEN COALESCE(e."extra_runs", 0) ELSE 0 END) AS "total_runs_conceded"
FROM "ball_by_ball" AS b
LEFT JOIN "batsman_scored" AS s
  ON b."match_id" = s."match_id" 
 AND b."over_id" = s."over_id" 
 AND b."ball_id" = s."ball_id"
 AND b."innings_no" = s."innings_no"
LEFT JOIN "extra_runs" AS e
  ON b."match_id" = e."match_id" 
 AND b."over_id" = e."over_id" 
 AND b."ball_id" = e."ball_id"
 AND b."innings_no" = e."innings_no"
GROUP BY b."bowler"
LIMIT 100
Answer:
bowler,total_runs_conceded
1,340
4,474
5,68
8,368
9,2289
10,86
12,242
13,40
14,3100
15,2469
16,82
21,997
22,349
24,93
25,548
27,1006
29,2554
31,1325
32,2120
35,2150
37,78
38,1422
39,1904
41,235
42,66
44,390
45,40
48,322
49,301
50,3119
52,24
53,0
54,337
56,674
57,440
58,276
59,219
60,355
61,2284
63,447
66,1095
67,3028
68,97
70,225
71,2755
72,51
73,2267
75,468
77,1194
78,542
80,1668
81,2788
82,1137
83,1361
84,1987
85,5
86,85
87,73
89,1936
90,520
91,499
93,20
94,2269
98,99
99,87
102,266
104,303
105,184
106,1915
108,22
109,2336
111,21
112,28
115,209
116,970
117,296
118,357
119,419
120,1235
121,1662
122,242
124,1058
126,1605
127,49
131,2332
133,58
135,356
136,2897
137,327
140,1037
142,42
143,199
144,54
145,29
147,662
148,60
149,298
150,59
151,1999
153,505
Query:
-- Corrected Query 9: Calculate the number of wickets taken by each bowler
SELECT b."bowler", COUNT(*) AS "wickets_taken"
FROM "wicket_taken" AS w
JOIN "ball_by_ball" AS b
  ON w."match_id" = b."match_id" 
 AND w."over_id" = b."over_id" 
 AND w."ball_id" = b."ball_id"
 AND w."innings_no" = b."innings_no"
WHERE w."kind_out" IN ('bowled', 'caught', 'lbw', 'stumped', 'hit wicket', 'caught and bowled')
GROUP BY b."bowler"
LIMIT 100
Answer:
bowler,wickets_taken
1,10
4,8
5,2
8,4
9,65
10,1
12,6
13,1
14,84
15,92
16,1
21,24
22,9
25,14
27,34
29,79
31,40
32,81
35,77
37,1
38,55
39,65
41,6
42,4
44,13
45,3
48,9
49,11
50,119
53,1
54,6
56,20
57,15
58,8
59,4
60,18
61,90
63,15
66,25
67,119
68,4
70,9
71,122
72,2
73,97
75,11
77,40
78,12
80,72
81,97
82,29
83,31
84,53
85,1
86,2
87,1
89,68
90,27
91,21
94,91
98,2
99,2
102,22
104,17
105,12
106,68
108,1
109,83
112,1
115,6
116,30
117,8
118,12
119,12
120,37
121,59
122,7
124,45
126,72
131,89
135,5
136,123
137,18
140,38
142,1
143,4
144,5
147,24
148,2
149,17
151,75
153,12
154,23
155,2
156,8
157,8
158,7
159,1
160,6
161,11
Query:
-- Corrected Query 10: List bowlers along with their total runs conceded and wickets taken
SELECT t1."bowler", t1."total_runs_conceded", t2."wickets_taken"
FROM
  (SELECT b."bowler", SUM(COALESCE(s."runs_scored", 0) + CASE WHEN e."extra_type" IN ('wides', 'noballs') THEN COALESCE(e."extra_runs", 0) ELSE 0 END) AS "total_runs_conceded"
   FROM "ball_by_ball" AS b
   LEFT JOIN "batsman_scored" AS s
     ON b."match_id" = s."match_id" 
    AND b."over_id" = s."over_id" 
    AND b."ball_id" = s."ball_id"
    AND b."innings_no" = s."innings_no"
   LEFT JOIN "extra_runs" AS e
     ON b."match_id" = e."match_id" 
    AND b."over_id" = e."over_id" 
    AND b."ball_id" = e."ball_id"
    AND b."innings_no" = e."innings_no"
   GROUP BY b."bowler") AS t1
JOIN
  (SELECT b."bowler", COUNT(*) AS "wickets_taken"
   FROM "wicket_taken" AS w
   JOIN "ball_by_ball" AS b
     ON w."match_id" = b."match_id" 
    AND w."over_id" = b."over_id" 
    AND w."ball_id" = b."ball_id"
    AND w."innings_no" = b."innings_no"
   WHERE w."kind_out" IN ('bowled', 'caught', 'lbw', 'stumped', 'hit wicket', 'caught and bowled')
   GROUP BY b."bowler") AS t2
  ON t1."bowler" = t2."bowler"
LIMIT 100
Answer:
bowler,total_runs_conceded,wickets_taken
1,340,10
4,474,8
5,68,2
8,368,4
9,2289,65
10,86,1
12,242,6
13,40,1
14,3100,84
15,2469,92
16,82,1
21,997,24
22,349,9
25,548,14
27,1006,34
29,2554,79
31,1325,40
32,2120,81
35,2150,77
37,78,1
38,1422,55
39,1904,65
41,235,6
42,66,4
44,390,13
45,40,3
48,322,9
49,301,11
50,3119,119
53,0,1
54,337,6
56,674,20
57,440,15
58,276,8
59,219,4
60,355,18
61,2284,90
63,447,15
66,1095,25
67,3028,119
68,97,4
70,225,9
71,2755,122
72,51,2
73,2267,97
75,468,11
77,1194,40
78,542,12
80,1668,72
81,2788,97
82,1137,29
83,1361,31
84,1987,53
85,5,1
86,85,2
87,73,1
89,1936,68
90,520,27
91,499,21
94,2269,91
98,99,2
99,87,2
102,266,22
104,303,17
105,184,12
106,1915,68
108,22,1
109,2336,83
112,28,1
115,209,6
116,970,30
117,296,8
118,357,12
119,419,12
120,1235,37
121,1662,59
122,242,7
124,1058,45
126,1605,72
131,2332,89
135,356,5
136,2897,123
137,327,18
140,1037,38
142,42,1
143,199,4
144,54,5
147,662,24
148,60,2
149,298,17
151,1999,75
153,505,12
154,798,23
155,105,2
156,161,8
157,303,8
158,215,7
159,40,1
160,206,6
161,292,11
Query:
-- Corrected Query 11: Compute the bowling average for each bowler
SELECT p."player_name", t1."total_runs_conceded", t2."wickets_taken",
       (CAST(t1."total_runs_conceded" AS FLOAT) / t2."wickets_taken") AS "bowling_average"
FROM
  (SELECT b."bowler", SUM(COALESCE(s."runs_scored", 0) + CASE WHEN e."extra_type" IN ('wides', 'noballs') THEN COALESCE(e."extra_runs", 0) ELSE 0 END) AS "total_runs_conceded"
   FROM "ball_by_ball" AS b
   LEFT JOIN "batsman_scored" AS s
     ON b."match_id" = s."match_id" 
    AND b."over_id" = s."over_id" 
    AND b."ball_id" = s."ball_id"
    AND b."innings_no" = s."innings_no"
   LEFT JOIN "extra_runs" AS e
     ON b."match_id" = e."match_id" 
    AND b."over_id" = e."over_id" 
    AND b."ball_id" = e."ball_id"
    AND b."innings_no" = e."innings_no"
   GROUP BY b."bowler") AS t1
JOIN
  (SELECT b."bowler", COUNT(*) AS "wickets_taken"
   FROM "wicket_taken" AS w
   JOIN "ball_by_ball" AS b
     ON w."match_id" = b."match_id" 
    AND w."over_id" = b."over_id" 
    AND w."ball_id" = b."ball_id"
    AND w."innings_no" = b."innings_no"
   WHERE w."kind_out" IN ('bowled', 'caught', 'lbw', 'stumped', 'hit wicket', 'caught and bowled')
   GROUP BY b."bowler") AS t2
  ON t1."bowler" = t2."bowler"
JOIN "player" AS p
  ON t1."bowler" = p."player_id"
WHERE t2."wickets_taken" > 0 AND t1."total_runs_conceded" > 0
ORDER BY "bowling_average" ASC
LIMIT 100
Answer:
player_name,total_runs_conceded,wickets_taken,bowling_average
Sachin Baby,8,2,4.0
AM Rahane,5,1,5.0
LA Carseldine,6,1,6.0
A Zampa,115,12,9.583333333333334
DAJ Bracewell,32,3,10.666666666666666
Shoaib Akhtar,54,5,10.8
Sohail Tanvir,266,22,12.090909090909092
DJ Thornely,40,3,13.333333333333334
D du Preez,56,4,14.0
CK Langeveldt,187,13,14.384615384615385
Umar Gul,184,12,15.333333333333334
S Dhawan,66,4,16.5
Kuldeep Yadav,100,6,16.666666666666668
CRD Fernando,298,17,17.529411764705884
JM Kemp,53,3,17.666666666666668
SL Malinga,2546,143,17.804195804195803
BJ Hodge,303,17,17.823529411764707
AD Mascarenhas,327,18,18.166666666666668
BCJ Cutting,111,6,18.5
SP Narine,1591,85,18.71764705882353
DE Bollinger,693,37,18.72972972972973
S Aravind,764,40,19.1
MF Maharoof,520,27,19.25925925925926
R Rampaul,270,14,19.285714285714285
MA Starc,658,34,19.352941176470587
Gurkeerat Singh,97,5,19.4
WPUJC Vaas,355,18,19.72222222222222
T Thushara,161,8,20.125
PD Collingwood,101,5,20.2
YA Abdulla,307,15,20.466666666666665
MR Marsh,403,19,21.210526315789473
Imran Tahir,623,29,21.482758620689655
R Ninan,65,3,21.666666666666668
BW Hilfenhaus,479,22,21.772727272727273
S Vidyut,22,1,22.0
A Chandila,242,11,22.0
S Gopal,154,7,22.0
JW Hastings,66,3,22.0
A Singh,620,28,22.142857142857142
MM Patel,1605,72,22.291666666666668
Sandeep Sharma,1164,52,22.384615384615383
AP Dole,112,5,22.4
YS Chahal,1210,54,22.40740740740741
DJ Bravo,2755,122,22.581967213114755
D Wiese,363,16,22.6875
A Ashish Reddy,389,17,22.88235294117647
KK Cooper,757,33,22.939393939393938
B Kumar,1964,85,23.105882352941176
DS Kulkarni,1668,72,23.166666666666668
SMSM Senanayake,209,9,23.22222222222222
RJ Harris,1047,45,23.266666666666666
RJ Peterson,70,3,23.333333333333332
A Nehra,2267,97,23.371134020618555
NM Coulter-Nile,491,21,23.38095238095238
CJ Jordan,258,11,23.454545454545453
MJ McClenaghan,822,35,23.485714285714284
A Kumble,1058,45,23.511111111111113
A Mishra,2897,123,23.552845528455286
RE van der Merwe,498,21,23.714285714285715
VY Mahesh,499,21,23.761904761904763
MM Sharma,1666,70,23.8
KMDN Kulasekara,120,5,24.0
Azhar Mahmood,700,29,24.137931034482758
WA Mota,97,4,24.25
MP Stoinis,194,8,24.25
SM Harwood,73,3,24.333333333333332
AB McDonald,244,10,24.4
JEC Franklin,220,9,24.444444444444443
KW Richardson,416,17,24.470588235294116
CH Morris,986,40,24.65
R Ashwin,2467,100,24.67
Mustafizur Rahman,421,17,24.764705882352942
GB Hogg,570,23,24.782608695652176
SE Bond,224,9,24.88888888888889
P Parameswaran,224,9,24.88888888888889
Shakib Al Hasan,1047,42,24.928571428571427
DW Steyn,2269,91,24.934065934065934
Shahid Afridi,225,9,25.0
L Ablish,75,3,25.0
Anand Rajan,201,8,25.125
DJ Muthuswami,101,4,25.25
RP Singh,2284,90,25.377777777777776
PP Chawla,3028,119,25.445378151260503
MA Khote,51,2,25.5
MG Johnson,1312,51,25.725490196078432
RV Gomez,129,5,25.8
SK Warne,1422,55,25.854545454545455
BE Hendricks,235,9,26.11111111111111
JE Taylor,157,6,26.166666666666668
SR Watson,2120,81,26.17283950617284
PP Ojha,2332,89,26.202247191011235
Harbhajan Singh,3119,119,26.210084033613445
P Awana,1028,39,26.358974358974358
RS Bopara,292,11,26.545454545454547
L Balaji,1999,75,26.653333333333332
Karanveer Singh,321,12,26.75
Z Khan,2469,92,26.83695652173913
M Morkel,2017,75,26.893333333333334
WD Parnell,701,26,26.96153846153846
GR Napier,27,1,27.0
Query:
-- Corrected Query 12: Identify the bowler with the lowest bowling average
SELECT p."player_name", (CAST(t1."total_runs_conceded" AS FLOAT) / t2."wickets_taken") AS "bowling_average"
FROM
  (SELECT b."bowler", SUM(COALESCE(s."runs_scored", 0) + CASE WHEN e."extra_type" IN ('wides', 'noballs') THEN COALESCE(e."extra_runs", 0) ELSE 0 END) AS "total_runs_conceded"
   FROM "ball_by_ball" AS b
   LEFT JOIN "batsman_scored" AS s
     ON b."match_id" = s."match_id" 
    AND b."over_id" = s."over_id" 
    AND b."ball_id" = s."ball_id"
    AND b."innings_no" = s."innings_no"
   LEFT JOIN "extra_runs" AS e
     ON b."match_id" = e."match_id" 
    AND b."over_id" = e."over_id" 
    AND b."ball_id" = e."ball_id"
    AND b."innings_no" = e."innings_no"
   GROUP BY b."bowler") AS t1
JOIN
  (SELECT b."bowler", COUNT(*) AS "wickets_taken"
   FROM "wicket_taken" AS w
   JOIN "ball_by_ball" AS b
     ON w."match_id" = b."match_id" 
    AND w."over_id" = b."over_id" 
    AND w."ball_id" = b."ball_id"
    AND w."innings_no" = b."innings_no"
   WHERE w."kind_out" IN ('bowled', 'caught', 'lbw', 'stumped', 'hit wicket', 'caught and bowled')
   GROUP BY b."bowler") AS t2
  ON t1."bowler" = t2."bowler"
JOIN "player" AS p
  ON t1."bowler" = p."player_id"
WHERE t2."wickets_taken" > 0 AND t1."total_runs_conceded" > 0
ORDER BY "bowling_average" ASC
LIMIT 1
Answer:
player_name,bowling_average
Sachin Baby,4.0
End Exploring Related Columns
Task: Which bowler has the lowest bowling average per wicket taken?

Please answer only one complete SQL in sqlite dialect in ```sql``` format.
Usage example: ```sql
SELECT DISTINCT "column_name" FROM "table_name" WHERE ... ``` (Replace "table_name" with the actual table name. Enclose table and column names with double quotations if they contain special characters or match reserved keywords.)
Follow the answer format like: To determine which bowler has the lowest bowling average per wicket taken, we calculate the bowling average for each bowler by dividing the total runs conceded by the number of wickets they have taken. The bowler with the lowest average is:

```csv
Bowler_name,Bowling_average
name:str,average:float
(Attention: answer in one row)
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: 

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-25 10:25:00 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:25:00 - root - INFO - To determine which bowler has the lowest bowling average per wicket taken, we calculate the bowling average for each bowler by dividing the total runs conceded by the number of wickets they have taken. The bowler with the lowest average is:

```csv
Bowler_name,Bowling_average
Sachin Baby,4.0
```
2025-01-25 10:25:00 - root - INFO - []
2025-01-25 10:25:00 - root - INFO - To determine which bowler has the lowest bowling average per wicket taken, we calculate the bowling average for each bowler by dividing the total runs conceded by the number of wickets they have taken. The bowler with the lowest average is:

```csv
Bowler_name,Bowling_average
Sachin Baby,4.0
```
2025-01-25 10:25:00 - root - INFO - Total iteration counts: 0
