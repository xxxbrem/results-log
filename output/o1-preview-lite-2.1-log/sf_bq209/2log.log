2025-01-26 21:22:21 - openai._base_client - INFO - Retrying request to /chat/completions in 0.429878 seconds
2025-01-26 21:23:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 21:23:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 21:23:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 21:23:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 21:23:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 21:23:07 - snowflake.connector.connection - INFO - closed
2025-01-26 21:23:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 21:23:07 - root - INFO - SQL:
SELECT "grant_date"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100;
Results:
grant_date
0
0
0
0
0
0
0
18370928
19501031
0
0
0
19730213
19740709
19730213
18780805
0
0
0
0
0
0
0
19630802
19660708
19670324
19670428
19670623
19670707
19680105
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
18460702
19801118
18490410
18520511
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0

2025-01-26 21:23:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 21:23:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 21:23:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 21:23:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 14
2025-01-26 21:23:09 - snowflake.connector.connection - INFO - closed
2025-01-26 21:23:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 21:23:09 - root - INFO - SQL:
SELECT DISTINCT "application_kind"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100;
Results:
application_kind
P
U
A
D
B
C
""
F
T
L
K
Q
W
V

2025-01-26 21:23:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 21:23:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 21:23:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 21:23:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 21:23:11 - snowflake.connector.connection - INFO - closed
2025-01-26 21:23:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 21:23:11 - root - INFO - SQL:
SELECT "publication_number", "grant_date"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "grant_date" BETWEEN 20100101 AND 20101231
   LIMIT 100;
Results:
publication_number,grant_date
JP-4480101-B2,20100616
JP-4568932-B2,20101027
JP-4446292-B2,20100407
JP-4405591-B2,20100127
AU-2004237783-B2,20101104
AU-2005212393-B2,20101223
AU-2009201956-B2,20101125
EP-1039551-B2,20100915
JP-4567145-B2,20101020
JP-4471456-B2,20100602
JP-4567151-B2,20101020
JP-4489282-B2,20100623
JP-4479097-B2,20100609
JP-4421129-B2,20100224
JP-4527904-B2,20100818
JP-4497777-B2,20100707
JP-4497796-B2,20100707
JP-4593065-B2,20101208
JP-4554156-B2,20100929
JP-4438307-B2,20100324
JP-4447256-B2,20100407
JP-4423893-B2,20100303
JP-4538621-B2,20100908
JP-4449402-B2,20100414
JP-4476602-B2,20100609
JP-4518375-B2,20100804
JP-4410555-B2,20100203
JP-4546089-B2,20100915
JP-4599854-B2,20101215
JP-4416579-B2,20100217
JP-4537780-B2,20100908
JP-4485873-B2,20100623
JP-4443444-B2,20100331
JP-4581847-B2,20101117
JP-4581858-B2,20101117
JP-4399415-B2,20100113
JP-4598679-B2,20101215
JP-4523569-B2,20100811
JP-4417936-B2,20100217
JP-4430063-B2,20100310
JP-4467567-B2,20100526
JP-4589368-B2,20101201
JP-4523029-B2,20100811
JP-4577917-B2,20101110
JP-4595144-B2,20101208
JP-4422266-B2,20100224
JP-4442732-B2,20100331
AU-2004228847-B2,20100617
AU-2005200786-B2,20100701
AU-2005295837-B2,20100624
AU-2006201819-B2,20100826
JP-4598228-B2,20101215
JP-4536215-B2,20100901
JP-4570744-B2,20101027
JP-4454835-B2,20100421
JP-4468603-B2,20100526
JP-4571757-B2,20101027
US-7682090-B2,20100323
US-7791628-B2,20100907
US-7853004-B2,20101214
US-7692025-B2,20100406
US-7785371-B2,20100831
US-7733428-B2,20100608
US-7828163-B2,20101109
US-7838479-B2,20101123
US-7730660-B2,20100608
US-7759242-B2,20100720
US-7679546-B2,20100316
US-7824128-B2,20101102
US-7781607-B2,20100824
AU-2004222134-B2,20100204
AU-2006206692-B2,20101216
AU-2006213803-B2,20101021
JP-4587239-B2,20101124
JP-4560692-B2,20101013
JP-4565708-B2,20101020
JP-4488612-B2,20100623
JP-4562273-B2,20101013
JP-4557410-B2,20101006
JP-4447163-B2,20100407
JP-4491156-B2,20100630
JP-4573080-B2,20101104
JP-4467827-B2,20100526
JP-4451025-B2,20100414
JP-4593852-B2,20101208
JP-4409804-B2,20100203
JP-4588289-B2,20101124
JP-4509517-B2,20100721
JP-4396237-B2,20100113
CN-201394229-Y,20100203
CN-201435300-Y,20100331
CN-201398358-Y,20100210
CN-201377166-Y,20100106
CN-201382358-Y,20100113
BE-1018064-A3,20100406
US-7822896-B1,20101026
AT-507045-B1,20100415
EP-1498169-B1,20100616
EP-1653098-B1,20100623
EP-1779841-B1,20100127

2025-01-26 21:23:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 21:23:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 21:23:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 21:23:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 21:23:12 - snowflake.connector.connection - INFO - closed
2025-01-26 21:23:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 21:23:13 - root - INFO - SQL:
SELECT "publication_number", "citation"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100;
Results:
publication_number,citation
CR-5634-A,[]
CR-5990-A,[]
FI-429-A,[]
HK-6083-A,[]
HU-T52763-A,[]
JP-H03206829-A,[]
JP-S62159089-A,[]
US-416-A,[]
US-2528225-A,"[
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-1632271-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-1959660-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2013863-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2144669-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2154308-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2155785-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2190901-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2207418-A"",
    ""type"": """"
  }
]"
AT-A41580-A,[]
AT-A47682-A,[]
AT-A63682-A,[]
CA-920790-A,[]
CA-950907-A,[]
CA-920830-A,[]
CA-9086-A,[]
CH-3256-A,[]
CH-540255-A,[]
CH-433637-A,[]
CH-8494-A,[]
CH-9587-A,[]
CH-9968-A,[]
DD-8297-A,[]
FR-1334211-A,[]
FR-1444995-A,[]
FR-1474468-A,[]
FR-1478988-A,[]
FR-1485992-A,[]
FR-1487706-A,[]
FR-1508237-A,[]
GB-893001-A,[]
GB-873984-A,[]
GB-307790-A,[]
GB-534192-A,[]
HK-39487-A,[]
HK-52284-A,[]
HK-55992-A,[]
HK-60178-A,[]
HK-82486-A,[]
HU-T58725-A,[]
JP-S62157892-A,[]
JP-H06198910-A,[]
MA-42286-A,[]
OA-07542-A,[]
OA-08399-A,[]
PH-11723-A,[]
PH-15213-A,[]
PH-17928-A,[]
PH-23905-A,[]
TR-26506-A,[]
US-4613-A,[]
US-4234270-A,"[
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2187871-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2414011-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-3708987-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-3720066-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-3793842-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": ""Engineering News Record, May 10, 1973, p. 39."",
    ""publication_number"": """",
    ""type"": """"
  }
]"
US-6310-A,[]
US-8947-A,[]
YU-24971-A,[]
YU-51397-A,[]
YU-53588-A,[]
YU-94082-A,[]
AT-A134275-A,[]
AT-A160683-A,[]
AT-A168281-A,[]
AT-A179178-A,[]
AT-A196182-A,[]
AT-A202882-A,[]
AT-A205780-A,[]
AT-A245590-A,[]
AT-A250686-A,[]
AT-A269985-A,[]
AT-A272073-A,[]
AT-A312885-A,[]
AT-A404675-A,[]
AT-A482077-A,[]
AT-A519575-A,[]
AT-A710279-A,[]
AT-A735378-A,[]
AT-A876472-A,[]
AT-A906278-A,[]
BE-804534-A,[]
BE-806687-A,[]
BE-813367-A,[]
BE-823416-A,[]
BE-825816-A,[]
BE-833811-A,[]
BE-837312-A,[]
BE-837857-A,[]
BE-840231-A,[]
BE-848755-A,[]
BE-852837-A,[]
BE-853553-A,[]
BE-857395-A,[]
BE-861199-A,[]
BE-866723-A,[]
BE-868080-A,[]
BE-868938-A,[]
BE-869056-A,[]
BE-871421-A,[]
BE-873394-A,[]
BE-877768-A,[]
BE-885287-A,[]
BE-509322-A,[]

2025-01-26 21:23:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 21:23:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 21:23:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 21:23:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 21:23:14 - snowflake.connector.connection - INFO - closed
2025-01-26 21:23:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 21:23:15 - root - INFO - SQL:
SELECT t."publication_number", c.value
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."citation") c
   LIMIT 100;
Results:
Too long, hard cut:
publication_number,VALUE
US-2017299239-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2007217147-A1"",
  ""type"": """"
}"
US-2017299239-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2011030420-A1"",
  ""type"": """"
}"
US-2017299239-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2011056667-A1"",
  ""type"": """"
}"
US-2017157230-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": ""Druiker et al. (Clinical Cancer Res. 2009; 15(6): 2048-2057)."",
  ""publication_number"": """",
  ""type"": """"
}"
US-2017157230-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": ""Lundqvist et al. (Journal of Cancer. 2011; 2: 383-385)."",
  ""publication_number"": """",
  ""type"": """"
}"
US-2017157230-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": ""Pegram et al. (J Immunol. 2008; 181: 3449-3455)"",
  ""publication_number"": """",
  ""type"": """"
}"
US-2017157230-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": ""Suck et al. (Experimental Hematology. 2005; 33: 1160-1171)."",
  ""publication_number"": """",
  ""type"": """"
}"
US-2017157230-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": ""Van Der Sloot et al. (PNAS. June 6, 2006; 103(23): 8634-8639 )"",
  ""publication_number"": """",
  ""type"": """"
}"
US-2017294111-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-4860352-A"",
  ""type"": """"
}"
US-2017294111-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6208859-B1"",
  ""type"": """"
}"
US-2017294111-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2002080038-A1"",
  ""type"": """"
}"
US-2017294111-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-8180366-B2"",
  ""type"": """"
}"
US-2018209343-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-5392614-A"",
  ""type"": ""X""
}"
US-2018209343-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2016237909-A1"",
  ""type"": ""Y""
}"
US-2017128414-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6414126-B1"",
  ""type"": """"
}"
US-2017128414-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-7157584-B2"",
  ""type"": """"
}"
US-2017128414-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-7943582-B2"",
  ""type"": """"
}"
US-2017220072-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6088220-A"",
  ""type"": """"
}"
US-2017220072-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6256017-B1"",
  ""type"": """"
}"
US-2017220072-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6587675-B1"",
  ""type"": """"
}"
US-2017220072-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2004052044-A1"",
  ""type"": """"
}"
US-2017220072-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2005248501-A1"",
  ""type"": """"
}"
US-2017220072-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2007279315-A1"",
  ""type"": """"
}"
US-2017220072-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2007285341-A1"",
  ""type"": """"
}"
US-2017220072-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2010041439-A1"",
  ""type"": """"
}"
US-2017220072-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",


2025-01-26 21:23:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 21:23:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 21:23:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 21:23:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 21:23:16 - snowflake.connector.connection - INFO - closed
2025-01-26 21:23:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 21:24:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 21:24:17 - root - INFO - ```sql
SELECT COUNT(*) AS "number_of_patents_with_exactly_one_forward_citation"
FROM (
    SELECT P."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS P
    INNER JOIN (
        SELECT c.value::VARIANT:"publication_number"::STRING AS "cited_publication_number",
               Q."filing_date" AS "citing_filing_date"
        FROM PATENTS.PATENTS.PUBLICATIONS Q,
             LATERAL FLATTEN(input => Q."citation") c
        WHERE c.value::VARIANT:"publication_number"::STRING IS NOT NULL
    ) citations ON citations."cited_publication_number" = P."publication_number"
                 AND citations."citing_filing_date" BETWEEN P."filing_date" AND P."filing_date" + 100000
    WHERE P."application_kind" = 'U'
      AND P."grant_date" BETWEEN 20100101 AND 20101231
      AND P."publication_number" IS NOT NULL
    GROUP BY P."publication_number"
    HAVING COUNT(*) = 1
) AS sub;
```
2025-01-26 21:24:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 21:24:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 21:24:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 21:24:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-26 21:24:19 - snowflake.connector.connection - INFO - closed
2025-01-26 21:24:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 21:25:31 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 21:25:31 - root - INFO - SQL:
SELECT COUNT(*) AS "number_of_patents_with_exactly_one_forward_citation"
FROM (
    SELECT P."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS P
    INNER JOIN (
        SELECT c.value::VARIANT:"publication_number"::STRING AS "cited_publication_number",
               Q."filing_date" AS "citing_filing_date"
        FROM PATENTS.PATENTS.PUBLICATIONS Q,
             LATERAL FLATTEN(input => Q."citation") c
        WHERE c.value::VARIANT:"publication_number"::STRING IS NOT NULL
    ) citations ON citations."cited_publication_number" = P."publication_number"
                 AND citations."citing_filing_date" BETWEEN P."filing_date" AND P."filing_date" + 100000
    WHERE P."application_kind" = 'U'
      AND P."grant_date" BETWEEN 20100101 AND 20101231
      AND P."publication_number" IS NOT NULL
    GROUP BY P."publication_number"
    HAVING COUNT(*) = 1
) AS sub;
Results:
number_of_patents_with_exactly_one_forward_citation
3

2025-01-26 21:25:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 21:25:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 21:25:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 21:25:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 21:25:33 - snowflake.connector.connection - INFO - closed
2025-01-26 21:25:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 21:25:33 - root - INFO - SQL:
SELECT "publication_number", "application_kind"
FROM PATENTS.PATENTS.PUBLICATIONS
WHERE "application_kind" = 'U'
  AND "application_kind" IS NOT NULL
LIMIT 100
Results:
publication_number,application_kind
AT-14015-U1,U
AT-17758-U1,U
AT-3414-U1,U
BG-2762-U1,U
CZ-3324-U1,U
CZ-3590-U1,U
DE-7610473-U1,U
DE-7623014-U1,U
DE-7701221-U1,U
DE-7708224-U1,U
DE-7714109-U1,U
DE-7803404-U1,U
DE-7819085-U1,U
DE-7825573-U1,U
DE-8214548-U1,U
DE-8309575-U1,U
DE-8800286-U1,U
DE-8808432-U1,U
DE-9003814-U1,U
DE-9313725-U1,U
FI-2484-U1,U
IT-9019406-U1,U
AT-9626-U1,U
DE-20003142-U1,U
DE-20022100-U1,U
DE-20118925-U1,U
DE-20201802-U1,U
DE-20202447-U1,U
DE-20210311-U1,U
DE-20212546-U1,U
DE-20312019-U1,U
DE-29610503-U1,U
DE-29611494-U1,U
DE-29804131-U1,U
DE-29804626-U1,U
DE-29910008-U1,U
DE-29918263-U1,U
DE-29923280-U1,U
DE-7916438-U1,U
IT-BS950102-U1,U
IT-FR920006-U1,U
IT-GE960005-U1,U
IT-MI920973-U1,U
IT-MI970023-U1,U
IT-MI970099-U1,U
IT-PD970033-U1,U
IT-RA960002-U1,U
IT-RE920050-U1,U
IT-RM950199-U1,U
IT-TO930020-U1,U
IT-TO970234-U1,U
IT-VI920058-U1,U
PL-103721-U1,U
PL-110883-U1,U
PL-117144-U1,U
PL-120669-U1,U
PL-128123-U1,U
RU-971-U1,U
RU-9254-U1,U
SK-50442011-U1,U
CZ-20135-U1,U
CZ-25404-U1,U
CZ-26538-U1,U
CZ-28507-U1,U
FI-8735-U1,U
RO-201800035-U1,U
CL-2020002670-U1,U
IT-BI20110002-U1,U
IT-MI20050413-U1,U
IT-MI20090203-U1,U
IT-RM20070091-U1,U
IT-SI20080001-U1,U
IT-TO20010097-U1,U
IT-VI20090055-U1,U
RU-34634-U1,U
RU-33284-U1,U
RU-33199-U1,U
RU-47481-U1,U
RU-43315-U1,U
RU-54022-U1,U
RU-55320-U1,U
RU-55294-U1,U
RU-69382-U1,U
RU-71785-U1,U
RU-74813-U1,U
RU-98083-U1,U
RU-112330-U1,U
RU-112088-U1,U
RU-117319-U1,U
RU-116307-U1,U
RU-125875-U1,U
RU-120046-U1,U
RU-129095-U1,U
RU-137646-U1,U
RU-136245-U1,U
RU-141316-U1,U
RU-151296-U1,U
RU-172423-U1,U
RU-180239-U1,U
RU-182070-U1,U

2025-01-26 21:25:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 21:25:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 21:25:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 21:25:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 21:25:35 - snowflake.connector.connection - INFO - closed
2025-01-26 21:25:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 21:25:35 - root - INFO - SQL:
SELECT "publication_number", "grant_date", "application_kind"
FROM PATENTS.PATENTS.PUBLICATIONS
WHERE "application_kind" = 'U'
  AND "grant_date" BETWEEN 20100101 AND 20101231
  AND "grant_date" > 0
LIMIT 100
Results:
publication_number,grant_date,application_kind
RU-91410-U1,20100210,U
RU-97824-U1,20100920,U
RU-99866-U1,20101127,U
RU-94293-U1,20100520,U
KR-200447955-Y1,20100304,U
JP-3161125-U,20100722,U
CN-201500484-U,20100609,U
CN-201540331-U,20100804,U
CN-201520547-U,20100707,U
CN-201576017-U,20100908,U
CN-201541464-U,20100811,U
CN-201507160-U,20100616,U
CN-201583518-U,20100915,U
CN-201532830-U,20100721,U
CN-201583110-U,20100915,U
CN-201568417-U,20100901,U
CN-201582349-U,20100915,U
CN-201569872-U,20100901,U
CN-201570369-U,20100901,U
CN-201625102-U,20101110,U
CN-201603339-U,20101013,U
CN-201591632-U,20100929,U
CN-201601659-U,20101006,U
CN-201657739-U,20101201,U
CN-201676525-U,20101222,U
CN-201689426-U,20101229,U
CN-201679675-U,20101222,U
JP-3159530-U,20100527,U
JP-3161932-U,20100812,U
CN-201444260-U,20100428,U
CN-201459928-U,20100512,U
CN-201605059-U,20101013,U
CN-201645646-U,20101124,U
CN-201531707-U,20100721,U
CN-201619415-U,20101103,U
CN-201590547-U,20100922,U
CN-201634248-U,20101117,U
CN-201599671-U,20101006,U
CN-201596311-U,20101006,U
CN-201601174-U,20101006,U
CN-201679201-U,20101222,U
KR-200449119-Y1,20100617,U
KR-200451230-Y1,20101203,U
JP-3163653-U,20101028,U
JP-3160661-U,20100701,U
CN-201456813-U,20100512,U
CN-201564867-U,20100901,U
CN-201466299-U,20100512,U
CN-201568960-U,20100901,U
CN-201484350-U,20100526,U
CN-201496249-U,20100602,U
CN-201550744-U,20100818,U
CN-201515328-U,20100623,U
CN-201494139-U,20100602,U
CN-201605452-U,20101013,U
CN-201572629-U,20100908,U
CN-201512345-U,20100623,U
CN-201587113-U,20100922,U
CN-201675150-U,20101222,U
CN-201683180-U,20101229,U
CN-201687676-U,20101229,U
JP-3158389-U,20100402,U
JP-3161524-U,20100805,U
JP-3157709-U,20100225,U
JP-3159671-U,20100527,U
CN-201461192-U,20100512,U
CN-201495498-U,20100602,U
CN-201452320-U,20100512,U
CN-201583756-U,20100915,U
CN-201543558-U,20100811,U
CN-201520874-U,20100707,U
CN-201577040-U,20100908,U
CN-201561731-U,20100825,U
CN-201566869-U,20100901,U
CN-201641387-U,20101124,U
CN-201655612-U,20101124,U
CN-201444432-U,20100428,U
CN-201458605-U,20100512,U
CN-201484254-U,20100526,U
CN-201512674-U,20100623,U
CN-201522158-U,20100707,U
CN-201544485-U,20100811,U
CN-201559337-U,20100825,U
CN-201613895-U,20101027,U
CN-201559506-U,20100825,U
CN-201594598-U,20100929,U
CN-201617929-U,20101103,U
CN-201446385-U,20100505,U
CN-201458016-U,20100512,U
CN-201461485-U,20100512,U
CN-201451461-U,20100512,U
CN-201541537-U,20100811,U
CN-201489480-U,20100526,U
CN-201580694-U,20100915,U
CN-201495034-U,20100602,U
CN-201527714-U,20100714,U
CN-201601259-U,20101006,U
CN-201608546-U,20101013,U
CN-201681859-U,20101222,U
CN-201506598-U,20100616,U

2025-01-26 21:25:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 21:25:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 21:25:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 21:25:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 21:25:36 - snowflake.connector.connection - INFO - closed
2025-01-26 21:25:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 21:25:37 - root - INFO - SQL:
SELECT "publication_number", COALESCE(ARRAY_SIZE("citation"), 0) AS "citation_count"
FROM PATENTS.PATENTS.PUBLICATIONS
LIMIT 100
Results:
publication_number,citation_count
CR-5634-A,0
CR-5990-A,0
FI-429-A,0
HK-6083-A,0
HU-T52763-A,0
JP-H03206829-A,0
JP-S62159089-A,0
US-416-A,0
US-2528225-A,8
AT-A41580-A,0
AT-A47682-A,0
AT-A63682-A,0
CA-920790-A,0
CA-950907-A,0
CA-920830-A,0
CA-9086-A,0
CH-3256-A,0
CH-540255-A,0
CH-433637-A,0
CH-8494-A,0
CH-9587-A,0
CH-9968-A,0
DD-8297-A,0
FR-1334211-A,0
FR-1444995-A,0
FR-1474468-A,0
FR-1478988-A,0
FR-1485992-A,0
FR-1487706-A,0
FR-1508237-A,0
GB-893001-A,0
GB-873984-A,0
GB-307790-A,0
GB-534192-A,0
HK-39487-A,0
HK-52284-A,0
HK-55992-A,0
HK-60178-A,0
HK-82486-A,0
HU-T58725-A,0
JP-S62157892-A,0
JP-H06198910-A,0
MA-42286-A,0
OA-07542-A,0
OA-08399-A,0
PH-11723-A,0
PH-15213-A,0
PH-17928-A,0
PH-23905-A,0
TR-26506-A,0
US-4613-A,0
US-4234270-A,6
US-6310-A,0
US-8947-A,0
YU-24971-A,0
YU-51397-A,0
YU-53588-A,0
YU-94082-A,0
AT-A134275-A,0
AT-A160683-A,0
AT-A168281-A,0
AT-A179178-A,0
AT-A196182-A,0
AT-A202882-A,0
AT-A205780-A,0
AT-A245590-A,0
AT-A250686-A,0
AT-A269985-A,0
AT-A272073-A,0
AT-A312885-A,0
AT-A404675-A,0
AT-A482077-A,0
AT-A519575-A,0
AT-A710279-A,0
AT-A735378-A,0
AT-A876472-A,0
AT-A906278-A,0
BE-804534-A,0
BE-806687-A,0
BE-813367-A,0
BE-823416-A,0
BE-825816-A,0
BE-833811-A,0
BE-837312-A,0
BE-837857-A,0
BE-840231-A,0
BE-848755-A,0
BE-852837-A,0
BE-853553-A,0
BE-857395-A,0
BE-861199-A,0
BE-866723-A,0
BE-868080-A,0
BE-868938-A,0
BE-869056-A,0
BE-871421-A,0
BE-873394-A,0
BE-877768-A,0
BE-885287-A,0
BE-509322-A,0

2025-01-26 21:25:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 21:25:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 21:25:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 21:25:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 21:25:38 - snowflake.connector.connection - INFO - closed
2025-01-26 21:25:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 21:25:39 - root - INFO - SQL:
SELECT "publication_number", COALESCE(ARRAY_SIZE("citation"), 0) AS "citation_count"
FROM PATENTS.PATENTS.PUBLICATIONS
WHERE COALESCE(ARRAY_SIZE("citation"), 0) = 1
LIMIT 100
Results:
publication_number,citation_count
US-2007071679-A1,1
US-2007296459-A1,1
US-2008092517-A1,1
US-2009261491-A1,1
US-2008121320-A1,1
US-2008238901-A1,1
US-2009220940-A1,1
US-2009185057-A1,1
FR-3050553-A1,1
FR-2237032-A1,1
FR-2222344-A1,1
FR-2308141-A1,1
FR-2316953-A1,1
FR-2282363-A1,1
FR-2375233-A1,1
FR-2490992-A1,1
SU-1025666-A1,1
SU-1011741-A1,1
SU-1095089-A1,1
SU-1019576-A1,1
SU-1008409-A1,1
SU-1085957-A1,1
SU-1033273-A1,1
SU-1037212-A1,1
SU-1117665-A1,1
SU-1125687-A1,1
SU-1087521-A1,1
SU-1091348-A1,1
SU-1143560-A1,1
SU-1153034-A1,1
SU-1155552-A1,1
SU-1171331-A1,1
SU-1233014-A1,1
SU-1243088-A1,1
SU-1260626-A1,1
SU-1318693-A1,1
SU-1253760-A1,1
SU-1354348-A1,1
SU-1377808-A1,1
SU-1282045-A1,1
SU-1335294-A1,1
SU-1386605-A1,1
SU-1388488-A1,1
SU-1481233-A1,1
SU-1421574-A1,1
SU-1491808-A1,1
SU-1507419-A1,1
SU-1623917-A1,1
SU-1545113-A1,1
SU-1557032-A1,1
SU-1670106-A1,1
SU-1563715-A1,1
SU-1608731-A1,1
SU-1628200-A1,1
SU-1694688-A1,1
SU-1687367-A1,1
SU-1673441-A1,1
SU-1677064-A1,1
SU-1753325-A1,1
SU-1706418-A1,1
SU-1731569-A1,1
SU-1763982-A1,1
SU-1762060-A1,1
SU-1761311-A1,1
SU-1758444-A1,1
US-2002038431-A1,1
US-2003132543-A1,1
US-2002135418-A1,1
US-2004203125-A1,1
US-2003087363-A1,1
US-2003109068-A1,1
US-2004093079-A1,1
US-2004157903-A1,1
US-2008161378-A1,1
US-2004086910-A1,1
US-2004078851-A1,1
US-2005034101-A1,1
US-2005036349-A1,1
US-2006083036-A1,1
US-2006154310-A1,1
US-2005205492-A1,1
US-2010120852-A1,1
US-2010261772-A1,1
US-2015187919-A1,1
US-2015329446-A1,1
US-2015365842-A1,1
US-2015210603-A1,1
US-2016059066-A1,1
US-2016105785-A1,1
US-2016013939-A1,1
US-2018136358-A1,1
US-2016293991-A1,1
US-2016288503-A1,1
US-2017152290-A1,1
US-2016285046-A1,1
US-2017033153-A1,1
US-2017029793-A1,1
US-2017094790-A1,1
US-2017329126-A1,1
US-2015205759-A1,1

2025-01-26 21:25:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 21:25:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 21:25:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 21:25:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-26 21:25:40 - snowflake.connector.connection - INFO - closed
2025-01-26 21:25:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 21:25:41 - root - INFO - SQL:
SELECT "publication_number", "grant_date", "application_kind", COALESCE(ARRAY_SIZE("citation"), 0) AS "citation_count"
FROM PATENTS.PATENTS.PUBLICATIONS
WHERE "application_kind" = 'U'
  AND "grant_date" BETWEEN 20100101 AND 20101231
  AND "grant_date" > 0
  AND COALESCE(ARRAY_SIZE("citation"), 0) = 1
LIMIT 100
Results:
publication_number,grant_date,application_kind,citation_count
KR-200450262-Y1,20100915,U,1
KR-200448620-Y1,20100503,U,1
KR-200447349-Y1,20100120,U,1

2025-01-26 21:25:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 21:25:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 21:25:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 21:25:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-26 21:25:42 - snowflake.connector.connection - INFO - closed
2025-01-26 21:25:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 21:26:27 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 21:26:27 - root - INFO - ```sql
SELECT COUNT(*) AS "number_of_us_utility_patents_with_one_forward_citation_in_10_years"
FROM (
    SELECT P."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS P
    INNER JOIN (
        SELECT c.value:"publication_number"::STRING AS "cited_publication_number",
               TO_DATE(Q."filing_date"::VARCHAR, 'YYYYMMDD') AS "citing_filing_date"
        FROM PATENTS.PATENTS.PUBLICATIONS Q,
             LATERAL FLATTEN(input => Q."citation") c
        WHERE c.value:"publication_number"::STRING IS NOT NULL
    ) citations ON citations."cited_publication_number" = P."publication_number"
                 AND citations."citing_filing_date" BETWEEN TO_DATE(P."filing_date"::VARCHAR, 'YYYYMMDD')
                                                      AND DATEADD(year, 10, TO_DATE(P."filing_date"::VARCHAR, 'YYYYMMDD'))
    WHERE P."country_code" = 'US'
      AND TO_DATE(P."grant_date"::VARCHAR, 'YYYYMMDD') BETWEEN '2010-01-01' AND '2010-12-31'
      AND P."kind_code" LIKE 'B%'
    GROUP BY P."publication_number"
    HAVING COUNT(citations."cited_publication_number") = 1
) AS sub;
```

This query calculates the number of U.S. utility patents granted in 2010 (`"country_code" = 'US'`, `"kind_code"` starting with `'B'`) that have exactly one forward citation within ten years following their application date. It achieves this by:

- Converting the date fields `"grant_date"` and `"filing_date"` to proper date formats using `TO_DATE`.
- Using `DATEADD` to add ten years to the filing date.
- Joining the citations where the citing patent's filing date falls within the ten-year window after the cited patent's filing date.
- Grouping by the patent's publication number and filtering for those with exactly one forward citation (`HAVING COUNT(...) = 1`).

This should provide meaningful results without being overly restrictive.
2025-01-26 21:26:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 21:26:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 21:26:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 21:26:28 - snowflake.connector.connection - INFO - closed
2025-01-26 21:26:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 21:27:04 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 21:27:04 - root - INFO - ```sql
SELECT COUNT(*) AS "number_of_patents_with_exactly_one_forward_citation_in_10_years"
FROM (
    SELECT P."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS P
    INNER JOIN (
        SELECT c.value:"publication_number"::STRING AS "cited_publication_number",
               TO_DATE(NULLIF(Q."filing_date", 0)::VARCHAR, 'YYYYMMDD') AS "citing_filing_date"
        FROM PATENTS.PATENTS.PUBLICATIONS Q,
             LATERAL FLATTEN(input => Q."citation") c
        WHERE c.value:"publication_number"::STRING IS NOT NULL
          AND Q."filing_date" > 0
    ) citations ON citations."cited_publication_number" = P."publication_number"
                 AND citations."citing_filing_date" BETWEEN TO_DATE(NULLIF(P."filing_date", 0)::VARCHAR, 'YYYYMMDD')
                                                  AND DATEADD(year, 10, TO_DATE(NULLIF(P."filing_date", 0)::VARCHAR, 'YYYYMMDD'))
    WHERE P."application_kind" = 'U'
      AND TO_DATE(NULLIF(P."grant_date", 0)::VARCHAR, 'YYYYMMDD') BETWEEN '2010-01-01' AND '2010-12-31'
      AND P."filing_date" > 0
    GROUP BY P."publication_number"
    HAVING COUNT(*) = 1
) AS sub;
```
2025-01-26 21:27:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 21:27:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 21:27:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 21:27:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-26 21:27:06 - snowflake.connector.connection - INFO - closed
2025-01-26 21:27:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 21:27:48 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 21:27:48 - root - INFO - SQL:
SELECT COUNT(*) AS "number_of_patents_with_exactly_one_forward_citation_in_10_years"
FROM (
    SELECT P."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS P
    INNER JOIN (
        SELECT c.value:"publication_number"::STRING AS "cited_publication_number",
               TO_DATE(NULLIF(Q."filing_date", 0)::VARCHAR, 'YYYYMMDD') AS "citing_filing_date"
        FROM PATENTS.PATENTS.PUBLICATIONS Q,
             LATERAL FLATTEN(input => Q."citation") c
        WHERE c.value:"publication_number"::STRING IS NOT NULL
          AND Q."filing_date" > 0
    ) citations ON citations."cited_publication_number" = P."publication_number"
                 AND citations."citing_filing_date" BETWEEN TO_DATE(NULLIF(P."filing_date", 0)::VARCHAR, 'YYYYMMDD')
                                                  AND DATEADD(year, 10, TO_DATE(NULLIF(P."filing_date", 0)::VARCHAR, 'YYYYMMDD'))
    WHERE P."application_kind" = 'U'
      AND TO_DATE(NULLIF(P."grant_date", 0)::VARCHAR, 'YYYYMMDD') BETWEEN '2010-01-01' AND '2010-12-31'
      AND P."filing_date" > 0
    GROUP BY P."publication_number"
    HAVING COUNT(*) = 1
) AS sub;
Results:
number_of_patents_with_exactly_one_forward_citation_in_10_years
3

2025-01-26 21:27:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 21:27:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 21:27:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 21:27:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 21:27:49 - snowflake.connector.connection - INFO - closed
2025-01-26 21:27:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 21:27:50 - root - INFO - SQL:
SELECT P."publication_number", COUNT(*) AS "forward_citation_count"
FROM PATENTS.PATENTS.PUBLICATIONS P
INNER JOIN (
    SELECT c.value:"publication_number"::STRING AS "cited_publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS Q,
    LATERAL FLATTEN(input => Q."citation") c
    WHERE c.value:"publication_number"::STRING IS NOT NULL
) citations ON citations."cited_publication_number" = P."publication_number"
WHERE P."publication_number" IS NOT NULL
GROUP BY P."publication_number"
LIMIT 100
Results:
publication_number,forward_citation_count
WO-2019099661-A1,1
US-2017079328-A1,1
JP-H0671322-A,2
JP-2001117595-A,1
CN-102062887-A,1
US-5581451-A,1
CN-102006658-A,1
CN-104451760-A,1
CN-103720370-A,2
JP-2009233945-A,1
US-2103897-A,1
US-3484311-A,1
CN-204983122-U,1
US-1062579-A,1
JP-S556326-A,1
JP-H066091-Y2,1
CN-104006366-A,1
CN-209506612-U,1
US-2008165617-A1,1
US-2016341582-A1,1
CN-107709441-A,1
US-8910847-B2,2
US-10569071-B2,3
JP-H0956892-A,1
CN-107592029-A,1
CN-207651444-U,1
GB-520327-A,1
WO-2018096179-A1,1
US-6656282-B2,1
US-5278627-A,2
DE-19548154-B4,1
US-2016326915-A1,1
US-2016200437-A1,1
JP-S543545-A,1
CN-103763513-A,1
CN-111092202-A,1
CN-102010225-A,1
CN-108646256-A,1
CN-101497546-A,1
CN-102731187-A,1
CN-102722906-A,1
JP-H0577023-A,1
US-4820402-A,1
US-1087540-A,1
US-1797744-A,1
JP-2010058556-A,1
US-2002039904-A1,2
US-2005185880-A1,1
US-2009116403-A1,1
US-7763069-B2,1
US-2330652-A,1
CN-2685300-Y,1
CN-102633568-A,1
US-2227938-A,1
US-4146649-A,1
US-3680330-A,1
JP-2005255419-A,1
US-2006221068-A1,1
CN-102128880-A,1
KR-20050079496-A,1
US-4504221-A,1
CN-112264723-A,1
JP-2001311644-A,1
US-9246311-B1,1
JP-S61173597-A,1
EP-0604777-A1,1
US-2005246353-A1,1
US-5523667-A,1
US-2007162413-A1,1
US-3287526-A,1
JP-H0473862-A,1
CN-210608031-U,1
US-6061349-A,3
JP-H01306319-A,1
CN-106238986-A,1
CN-102427633-A,1
US-4349255-A,1
JP-2013248763-A,2
US-2010245375-A1,1
JP-H04207833-A,1
US-2007157285-A1,1
US-2007284440-A1,2
KR-20170062343-A,1
US-2008064226-A1,1
CN-203988035-U,1
CN-103814851-B,1
CN-106878181-A,1
US-313046-A,1
US-2332540-A,1
US-3998462-A,2
DE-3012998-A1,1
EP-2322385-A1,1
US-2017093231-A1,1
KR-20110029317-A,1
US-2017309530-A1,1
JP-4216266-B2,1
US-2017182414-A1,1
US-2007211449-A1,1
CN-108114699-A,1
US-5947495-A,1

2025-01-26 21:27:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 21:27:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 21:27:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 21:27:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-26 21:27:51 - snowflake.connector.connection - INFO - closed
2025-01-26 21:27:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 21:27:51 - root - INFO - SQL:
SELECT P."publication_number", COUNT(*) AS "forward_citation_count"
FROM PATENTS.PATENTS.PUBLICATIONS P
INNER JOIN (
    SELECT c.value:"publication_number"::STRING AS "cited_publication_number",
           TO_DATE(NULLIF(Q."filing_date", 0)::VARCHAR, 'YYYYMMDD') AS "citing_filing_date"
    FROM PATENTS.PATENTS.PUBLICATIONS Q,
    LATERAL FLATTEN(input => Q."citation") c
    WHERE c.value:"publication_number"::STRING IS NOT NULL
      AND Q."filing_date" > 0
) citations ON citations."cited_publication_number" = P."publication_number"
     AND citations."citing_filing_date" BETWEEN TO_DATE(NULLIF(P."filing_date", 0)::VARCHAR, 'YYYYMMDD')
                                            AND DATEADD(year, 10, TO_DATE(NULLIF(P."filing_date", 0)::VARCHAR, 'YYYYMMDD'))
WHERE P."application_kind" = 'U'
  AND TO_DATE(NULLIF(P."grant_date", 0)::VARCHAR, 'YYYYMMDD') BETWEEN '2010-01-01' AND '2010-12-31'
  AND P."filing_date" > 0
GROUP BY P."publication_number"
HAVING COUNT(*) = 1
LIMIT 100
Results:
publication_number,forward_citation_count
CN-201427255-Y,1
CN-201620562-U,1
CN-201400470-Y,1

2025-01-26 21:27:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 21:27:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 21:27:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 21:27:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 80
2025-01-26 21:27:53 - snowflake.connector.connection - INFO - closed
2025-01-26 21:27:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 21:27:53 - root - INFO - SQL:
SELECT DISTINCT "kind_code"
FROM PATENTS.PATENTS.PUBLICATIONS
WHERE "kind_code" IS NOT NULL
LIMIT 100
Results:
kind_code
S2
B1
S
D2
U8
I1
T9
U9
A1
F1
P9
V0
A5
C1
Y8
H1
R1
F2
A4
U0
C9
L
Z
T
T3
U4
A0
B9
U5
R
Z2
A
T2
Y2
D
P
B7
T8
A3
B
Y1
A8
I2
P1
C4
T4
B3
D1
T5
G2
A6
C
U2
U
B4
C2
Q
C5
H3
C3
A7
A2
Y
B8
C0
S1
U3
M
B5
B2
B6
A9
E2
U1
V
E
G
D0
T1
Y4

2025-01-26 21:27:53 - root - INFO - itercount: 0
2025-01-26 21:27:53 - root - INFO - Database Name: PATENTS
Schema Name: PATENTS
DDL describes table information.
,0
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,1
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""spif_publication_number"" VARCHAR(16777216),
	""spif_application_number"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""claims_localized_html"" VARIANT,
	""description_localized"" VARIANT,
	""description_localized_html"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""locarno"" VARIANT,
	""citation"" VARIANT,
	""parent"" VARIANT,
	""child"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,2
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
To solve the task, we need to identify utility patents granted in 2010 that have exactly one forward citation within the ten years following their application date. 

**Relevant Table:**

- **`PATENTS.PATENTS.PUBLICATIONS`**

**Relevant Columns and Potential Usage:**

- `"publication_number"`: Identifies each patent publication; used to track and count patents.
- `"grant_date"`: Date when the patent was granted; used to filter patents granted in 2010.
- `"application_kind"`: Type of the patent application; used to identify utility patents.
- `"filing_date"`: The application date of the patent; used to calculate the ten-year window for citations.
- `"citation"`: Contains citation details; used to count the number of forward citations.
  
**Conditions that may be used:**

- Patents where `"grant_date"` is between `20100101` and `20101231` to filter for the year 2010.
- Patents where `"application_kind"` indicates a utility patent (we may need to explore its values).
- Counting forward citations that occurred within ten years after the `"filing_date"`.
- Patents with exactly one such citation.

Below are SQL queries to explore and understand the data:

---

1. **View a sample of grant dates to understand their format:**

   ```sql
   SELECT "grant_date"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100;
   ```

2. **Check distinct values of "application_kind" to identify utility patents:**

   ```sql
   SELECT DISTINCT "application_kind"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100;
   ```

3. **Retrieve patents granted in the year 2010:**

   ```sql
   SELECT "publication_number", "grant_date"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "grant_date" BETWEEN 20100101 AND 20101231
   LIMIT 100;
   ```

4. **Explore the "citation" column structure:**

   ```sql
   SELECT "publication_number", "citation"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100;
   ```

5. **Flatten the "citation" VARIANT to inspect individual citations:**

   ```sql
   SELECT t."publication_number", c.value
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."citation") c
   LIMIT 100;
   ```

6. **Extract details from "citation" objects, such as citation dates:**

   ```sql
   SELECT t."publication_number",
          c.value::VARIANT:"date"::NUMBER AS "citation_date"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."citation") c
   LIMIT 100;
   ```

7. **Identify utility patents using "application_kind":**

   ```sql
   SELECT "publication_number", "application_kind"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "application_kind" = 'U'
   LIMIT 100;
   ```

8. **Combine filters for utility patents granted in 2010:**

   ```sql
   SELECT "publication_number", "grant_date", "application_kind"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "application_kind" = 'U'
     AND "grant_date" BETWEEN 20100101 AND 20101231
   LIMIT 100;
   ```

9. **Count the number of citations for each patent:**

   ```sql
   SELECT "publication_number", ARRAY_SIZE("citation") AS "citation_count"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100;
   ```

10. **Find patents with exactly one citation:**

    ```sql
    SELECT "publication_number", ARRAY_SIZE("citation") AS "citation_count"
    FROM PATENTS.PATENTS.PUBLICATIONS
    WHERE ARRAY_SIZE("citation") = 1
    LIMIT 100;
    ```

11. **Retrieve utility patents granted in 2010 with exactly one citation:**

    ```sql
    SELECT "publication_number", "grant_date", "application_kind", ARRAY_SIZE("citation") AS "citation_count"
    FROM PATENTS.PATENTS.PUBLICATIONS
    WHERE "application_kind" = 'U'
      AND "grant_date" BETWEEN 20100101 AND 20101231
      AND ARRAY_SIZE("citation") = 1
    LIMIT 100;
    ```

12. **Find citations that occurred within ten years after the filing date:**

    ```sql
    SELECT t."publication_number", t."filing_date", c.value::VARIANT:"date"::NUMBER AS "citation_date"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."citation") c
    WHERE c.value::VARIANT:"date"::NUMBER BETWEEN t."filing_date" AND t."filing_date" + 100000
    LIMIT 100;
    ```

13. **Count the number of forward citations within ten years after the application date:**

    ```sql
    SELECT t."publication_number", COUNT(*) AS "forward_citation_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."citation") c
    WHERE c.value::VARIANT:"date"::NUMBER BETWEEN t."filing_date" AND t."filing_date" + 100000
    GROUP BY t."publication_number"
    LIMIT 100;
    ```

14. **Select utility patents granted in 2010 with exactly one forward citation within ten years after application date:**

    ```sql
    SELECT t."publication_number", COUNT(*) AS "forward_citation_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."citation") c
    WHERE t."application_kind" = 'U'
      AND t."grant_date" BETWEEN 20100101 AND 20101231
      AND c.value::VARIANT:"date"::NUMBER BETWEEN t."filing_date" AND t."filing_date" + 100000
    GROUP BY t."publication_number"
    HAVING COUNT(*) = 1
    LIMIT 100;
    ```

15. **Inspect "kind_code" to see if it helps identify utility patents:**

    ```sql
    SELECT DISTINCT "kind_code"
    FROM PATENTS.PATENTS.PUBLICATIONS
    LIMIT 100;
    ```

Each of these queries helps us understand the structure and content of the data, including how dates are formatted, how utility patents are identified, and how citations are stored and counted. By exploring these elements, we can build a comprehensive approach to compute the number of utility patents granted in 2010 that have exactly one forward citation within ten years after their application date.Query:
SELECT "grant_date"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100;
Answer:
grant_date
0
0
0
0
0
0
0
18370928
19501031
0
0
0
19730213
19740709
19730213
18780805
0
0
0
0
0
0
0
19630802
19660708
19670324
19670428
19670623
19670707
19680105
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
18460702
19801118
18490410
18520511
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
Query:
SELECT DISTINCT "application_kind"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100;
Answer:
application_kind
P
U
A
D
B
C
""
F
T
L
K
Q
W
V
Query:
SELECT "publication_number", "grant_date"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "grant_date" BETWEEN 20100101 AND 20101231
   LIMIT 100;
Answer:
publication_number,grant_date
JP-4480101-B2,20100616
JP-4568932-B2,20101027
JP-4446292-B2,20100407
JP-4405591-B2,20100127
AU-2004237783-B2,20101104
AU-2005212393-B2,20101223
AU-2009201956-B2,20101125
EP-1039551-B2,20100915
JP-4567145-B2,20101020
JP-4471456-B2,20100602
JP-4567151-B2,20101020
JP-4489282-B2,20100623
JP-4479097-B2,20100609
JP-4421129-B2,20100224
JP-4527904-B2,20100818
JP-4497777-B2,20100707
JP-4497796-B2,20100707
JP-4593065-B2,20101208
JP-4554156-B2,20100929
JP-4438307-B2,20100324
JP-4447256-B2,20100407
JP-4423893-B2,20100303
JP-4538621-B2,20100908
JP-4449402-B2,20100414
JP-4476602-B2,20100609
JP-4518375-B2,20100804
JP-4410555-B2,20100203
JP-4546089-B2,20100915
JP-4599854-B2,20101215
JP-4416579-B2,20100217
JP-4537780-B2,20100908
JP-4485873-B2,20100623
JP-4443444-B2,20100331
JP-4581847-B2,20101117
JP-4581858-B2,20101117
JP-4399415-B2,20100113
JP-4598679-B2,20101215
JP-4523569-B2,20100811
JP-4417936-B2,20100217
JP-4430063-B2,20100310
JP-4467567-B2,20100526
JP-4589368-B2,20101201
JP-4523029-B2,20100811
JP-4577917-B2,20101110
JP-4595144-B2,20101208
JP-4422266-B2,20100224
JP-4442732-B2,20100331
AU-2004228847-B2,20100617
AU-2005200786-B2,20100701
AU-2005295837-B2,20100624
AU-2006201819-B2,20100826
JP-4598228-B2,20101215
JP-4536215-B2,20100901
JP-4570744-B2,20101027
JP-4454835-B2,20100421
JP-4468603-B2,20100526
JP-4571757-B2,20101027
US-7682090-B2,20100323
US-7791628-B2,20100907
US-7853004-B2,20101214
US-7692025-B2,20100406
US-7785371-B2,20100831
US-7733428-B2,20100608
US-7828163-B2,20101109
US-7838479-B2,20101123
US-7730660-B2,20100608
US-7759242-B2,20100720
US-7679546-B2,20100316
US-7824128-B2,20101102
US-7781607-B2,20100824
AU-2004222134-B2,20100204
AU-2006206692-B2,20101216
AU-2006213803-B2,20101021
JP-4587239-B2,20101124
JP-4560692-B2,20101013
JP-4565708-B2,20101020
JP-4488612-B2,20100623
JP-4562273-B2,20101013
JP-4557410-B2,20101006
JP-4447163-B2,20100407
JP-4491156-B2,20100630
JP-4573080-B2,20101104
JP-4467827-B2,20100526
JP-4451025-B2,20100414
JP-4593852-B2,20101208
JP-4409804-B2,20100203
JP-4588289-B2,20101124
JP-4509517-B2,20100721
JP-4396237-B2,20100113
CN-201394229-Y,20100203
CN-201435300-Y,20100331
CN-201398358-Y,20100210
CN-201377166-Y,20100106
CN-201382358-Y,20100113
BE-1018064-A3,20100406
US-7822896-B1,20101026
AT-507045-B1,20100415
EP-1498169-B1,20100616
EP-1653098-B1,20100623
EP-1779841-B1,20100127
Query:
SELECT "publication_number", "citation"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100;
Answer:
publication_number,citation
CR-5634-A,[]
CR-5990-A,[]
FI-429-A,[]
HK-6083-A,[]
HU-T52763-A,[]
JP-H03206829-A,[]
JP-S62159089-A,[]
US-416-A,[]
US-2528225-A,"[
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-1632271-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-1959660-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2013863-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2144669-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2154308-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2155785-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2190901-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2207418-A"",
    ""type"": """"
  }
]"
AT-A41580-A,[]
AT-A47682-A,[]
AT-A63682-A,[]
CA-920790-A,[]
CA-950907-A,[]
CA-920830-A,[]
CA-9086-A,[]
CH-3256-A,[]
CH-540255-A,[]
CH-433637-A,[]
CH-8494-A,[]
CH-9587-A,[]
CH-9968-A,[]
DD-8297-A,[]
FR-1334211-A,[]
FR-1444995-A,[]
FR-1474468-A,[]
FR-1478988-A,[]
FR-1485992-A,[]
FR-1487706-A,[]
FR-1508237-A,[]
GB-893001-A,[]
GB-873984-A,[]
GB-307790-A,[]
GB-534192-A,[]
HK-39487-A,[]
HK-52284-A,[]
HK-55992-A,[]
HK-60178-A,[]
HK-82486-A,[]
HU-T58725-A,[]
JP-S62157892-A,[]
JP-H06198910-A,[]
MA-42286-A,[]
OA-07542-A,[]
OA-08399-A,[]
PH-11723-A,[]
PH-15213-A,[]
PH-17928-A,[]
PH-23905-A,[]
TR-26506-A,[]
US-4613-A,[]
US-4234270-A,"[
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2187871-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2414011-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-3708987-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-3720066-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-3793842-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": ""Engineering News Record, May 10, 1973, p. 39."",
    ""publication_number"": """",
    ""type"": """"
  }
]"
US-6310-A,[]
US-8947-A,[]
YU-24971-A,[]
YU-51397-A,[]
YU-53588-A,[]
YU-94082-A,[]
AT-A134275-A,[]
AT-A160683-A,[]
AT-A168281-A,[]
AT-A179178-A,[]
AT-A196182-A,[]
AT-A202882-A,[]
AT-A205780-A,[]
AT-A245590-A,[]
AT-A250686-A,[]
AT-A269985-A,[]
AT-A272073-A,[]
AT-A312885-A,[]
AT-A404675-A,[]
AT-A482077-A,[]
AT-A519575-A,[]
AT-A710279-A,[]
AT-A735378-A,[]
AT-A876472-A,[]
AT-A906278-A,[]
BE-804534-A,[]
BE-806687-A,[]
BE-813367-A,[]
BE-823416-A,[]
BE-825816-A,[]
BE-833811-A,[]
BE-837312-A,[]
BE-837857-A,[]
BE-840231-A,[]
BE-848755-A,[]
BE-852837-A,[]
BE-853553-A,[]
BE-857395-A,[]
BE-861199-A,[]
BE-866723-A,[]
BE-868080-A,[]
BE-868938-A,[]
BE-869056-A,[]
BE-871421-A,[]
BE-873394-A,[]
BE-877768-A,[]
BE-885287-A,[]
BE-509322-A,[]
Query:
SELECT t."publication_number", c.value
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."citation") c
   LIMIT 100;
Answer:
Too long, hard cut:
publication_number,VALUE
US-2017299239-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2007217147-A1"",
  ""type"": """"
}"
US-2017299239-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2011030420-A1"",
  ""type"": """"
}"
US-2017299239-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2011056667-A1"",
  ""type"": """"
}"
US-2017157230-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": ""Druiker et al. (Clinical Cancer Res. 2009; 15(6): 2048-2057)."",
  ""publication_number"": """",
  ""type"": """"
}"
US-2017157230-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": ""Lundqvist et al. (Journal of Cancer. 2011; 2: 383-385)."",
  ""publication_number"": """",
  ""type"": """"
}"
US-2017157230-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": ""Pegram et al. (J Immunol. 2008; 181: 3449-3455)"",
  ""publication_number"": """",
  ""type"": """"
}"
US-2017157230-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": ""Suck et al. (Experimental Hematology. 2005; 33: 1160-1171)."",
  ""publication_number"": """",
  ""type"": """"
}"
US-2017157230-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": ""Van Der Sloot et al. (PNAS. June 6, 2006; 103(23): 8634-8639 )"",
  ""publication_number"": """",
  ""type"": """"
}"
US-2017294111-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-4860352-A"",
  ""type"": """"
}"
US-2017294111-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6208859-B1"",
  ""type"": """"
}"
US-2017294111-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2002080038-A1"",
  ""type"": """"
}"
US-2017294111-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-8180366-B2"",
  ""type"": """"
}"
US-2018209343-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-5392614-A"",
  ""type"": ""X""
}"
US-2018209343-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2016237909-A1"",
  ""type"": ""Y""
}"
US-2017128414-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6414126-B1"",
  ""type"": """"
}"
US-2017128414-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-7157584-B2"",
  ""type"": """"
}"
US-2017128414-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-7943582-B2"",
  ""type"": """"
}"
US-2017220072-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6088220-A"",
  ""type"": """"
}"
US-2017220072-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6256017-B1"",
  ""type"": """"
}"
US-2017220072-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-6587675-B1"",
  ""type"": """"
}"
US-2017220072-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2004052044-A1"",
  ""type"": """"
}"
US-2017220072-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2005248501-A1"",
  ""type"": """"
}"
US-2017220072-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2007279315-A1"",
  ""type"": """"
}"
US-2017220072-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2007285341-A1"",
  ""type"": """"
}"
US-2017220072-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2010041439-A1"",
  ""type"": """"
}"
US-2017220072-A1,"{
  ""application_number"": """",
  ""category"": ""PRS"",

Query:
SELECT COUNT(*) AS "number_of_patents_with_exactly_one_forward_citation"
FROM (
    SELECT P."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS P
    INNER JOIN (
        SELECT c.value::VARIANT:"publication_number"::STRING AS "cited_publication_number",
               Q."filing_date" AS "citing_filing_date"
        FROM PATENTS.PATENTS.PUBLICATIONS Q,
             LATERAL FLATTEN(input => Q."citation") c
        WHERE c.value::VARIANT:"publication_number"::STRING IS NOT NULL
    ) citations ON citations."cited_publication_number" = P."publication_number"
                 AND citations."citing_filing_date" BETWEEN P."filing_date" AND P."filing_date" + 100000
    WHERE P."application_kind" = 'U'
      AND P."grant_date" BETWEEN 20100101 AND 20101231
      AND P."publication_number" IS NOT NULL
    GROUP BY P."publication_number"
    HAVING COUNT(*) = 1
) AS sub;
Answer:
number_of_patents_with_exactly_one_forward_citation
3
Query:
SELECT "publication_number", "application_kind"
FROM PATENTS.PATENTS.PUBLICATIONS
WHERE "application_kind" = 'U'
  AND "application_kind" IS NOT NULL
LIMIT 100
Answer:
publication_number,application_kind
AT-14015-U1,U
AT-17758-U1,U
AT-3414-U1,U
BG-2762-U1,U
CZ-3324-U1,U
CZ-3590-U1,U
DE-7610473-U1,U
DE-7623014-U1,U
DE-7701221-U1,U
DE-7708224-U1,U
DE-7714109-U1,U
DE-7803404-U1,U
DE-7819085-U1,U
DE-7825573-U1,U
DE-8214548-U1,U
DE-8309575-U1,U
DE-8800286-U1,U
DE-8808432-U1,U
DE-9003814-U1,U
DE-9313725-U1,U
FI-2484-U1,U
IT-9019406-U1,U
AT-9626-U1,U
DE-20003142-U1,U
DE-20022100-U1,U
DE-20118925-U1,U
DE-20201802-U1,U
DE-20202447-U1,U
DE-20210311-U1,U
DE-20212546-U1,U
DE-20312019-U1,U
DE-29610503-U1,U
DE-29611494-U1,U
DE-29804131-U1,U
DE-29804626-U1,U
DE-29910008-U1,U
DE-29918263-U1,U
DE-29923280-U1,U
DE-7916438-U1,U
IT-BS950102-U1,U
IT-FR920006-U1,U
IT-GE960005-U1,U
IT-MI920973-U1,U
IT-MI970023-U1,U
IT-MI970099-U1,U
IT-PD970033-U1,U
IT-RA960002-U1,U
IT-RE920050-U1,U
IT-RM950199-U1,U
IT-TO930020-U1,U
IT-TO970234-U1,U
IT-VI920058-U1,U
PL-103721-U1,U
PL-110883-U1,U
PL-117144-U1,U
PL-120669-U1,U
PL-128123-U1,U
RU-971-U1,U
RU-9254-U1,U
SK-50442011-U1,U
CZ-20135-U1,U
CZ-25404-U1,U
CZ-26538-U1,U
CZ-28507-U1,U
FI-8735-U1,U
RO-201800035-U1,U
CL-2020002670-U1,U
IT-BI20110002-U1,U
IT-MI20050413-U1,U
IT-MI20090203-U1,U
IT-RM20070091-U1,U
IT-SI20080001-U1,U
IT-TO20010097-U1,U
IT-VI20090055-U1,U
RU-34634-U1,U
RU-33284-U1,U
RU-33199-U1,U
RU-47481-U1,U
RU-43315-U1,U
RU-54022-U1,U
RU-55320-U1,U
RU-55294-U1,U
RU-69382-U1,U
RU-71785-U1,U
RU-74813-U1,U
RU-98083-U1,U
RU-112330-U1,U
RU-112088-U1,U
RU-117319-U1,U
RU-116307-U1,U
RU-125875-U1,U
RU-120046-U1,U
RU-129095-U1,U
RU-137646-U1,U
RU-136245-U1,U
RU-141316-U1,U
RU-151296-U1,U
RU-172423-U1,U
RU-180239-U1,U
RU-182070-U1,U
Query:
SELECT "publication_number", "grant_date", "application_kind"
FROM PATENTS.PATENTS.PUBLICATIONS
WHERE "application_kind" = 'U'
  AND "grant_date" BETWEEN 20100101 AND 20101231
  AND "grant_date" > 0
LIMIT 100
Answer:
publication_number,grant_date,application_kind
RU-91410-U1,20100210,U
RU-97824-U1,20100920,U
RU-99866-U1,20101127,U
RU-94293-U1,20100520,U
KR-200447955-Y1,20100304,U
JP-3161125-U,20100722,U
CN-201500484-U,20100609,U
CN-201540331-U,20100804,U
CN-201520547-U,20100707,U
CN-201576017-U,20100908,U
CN-201541464-U,20100811,U
CN-201507160-U,20100616,U
CN-201583518-U,20100915,U
CN-201532830-U,20100721,U
CN-201583110-U,20100915,U
CN-201568417-U,20100901,U
CN-201582349-U,20100915,U
CN-201569872-U,20100901,U
CN-201570369-U,20100901,U
CN-201625102-U,20101110,U
CN-201603339-U,20101013,U
CN-201591632-U,20100929,U
CN-201601659-U,20101006,U
CN-201657739-U,20101201,U
CN-201676525-U,20101222,U
CN-201689426-U,20101229,U
CN-201679675-U,20101222,U
JP-3159530-U,20100527,U
JP-3161932-U,20100812,U
CN-201444260-U,20100428,U
CN-201459928-U,20100512,U
CN-201605059-U,20101013,U
CN-201645646-U,20101124,U
CN-201531707-U,20100721,U
CN-201619415-U,20101103,U
CN-201590547-U,20100922,U
CN-201634248-U,20101117,U
CN-201599671-U,20101006,U
CN-201596311-U,20101006,U
CN-201601174-U,20101006,U
CN-201679201-U,20101222,U
KR-200449119-Y1,20100617,U
KR-200451230-Y1,20101203,U
JP-3163653-U,20101028,U
JP-3160661-U,20100701,U
CN-201456813-U,20100512,U
CN-201564867-U,20100901,U
CN-201466299-U,20100512,U
CN-201568960-U,20100901,U
CN-201484350-U,20100526,U
CN-201496249-U,20100602,U
CN-201550744-U,20100818,U
CN-201515328-U,20100623,U
CN-201494139-U,20100602,U
CN-201605452-U,20101013,U
CN-201572629-U,20100908,U
CN-201512345-U,20100623,U
CN-201587113-U,20100922,U
CN-201675150-U,20101222,U
CN-201683180-U,20101229,U
CN-201687676-U,20101229,U
JP-3158389-U,20100402,U
JP-3161524-U,20100805,U
JP-3157709-U,20100225,U
JP-3159671-U,20100527,U
CN-201461192-U,20100512,U
CN-201495498-U,20100602,U
CN-201452320-U,20100512,U
CN-201583756-U,20100915,U
CN-201543558-U,20100811,U
CN-201520874-U,20100707,U
CN-201577040-U,20100908,U
CN-201561731-U,20100825,U
CN-201566869-U,20100901,U
CN-201641387-U,20101124,U
CN-201655612-U,20101124,U
CN-201444432-U,20100428,U
CN-201458605-U,20100512,U
CN-201484254-U,20100526,U
CN-201512674-U,20100623,U
CN-201522158-U,20100707,U
CN-201544485-U,20100811,U
CN-201559337-U,20100825,U
CN-201613895-U,20101027,U
CN-201559506-U,20100825,U
CN-201594598-U,20100929,U
CN-201617929-U,20101103,U
CN-201446385-U,20100505,U
CN-201458016-U,20100512,U
CN-201461485-U,20100512,U
CN-201451461-U,20100512,U
CN-201541537-U,20100811,U
CN-201489480-U,20100526,U
CN-201580694-U,20100915,U
CN-201495034-U,20100602,U
CN-201527714-U,20100714,U
CN-201601259-U,20101006,U
CN-201608546-U,20101013,U
CN-201681859-U,20101222,U
CN-201506598-U,20100616,U
Query:
SELECT "publication_number", COALESCE(ARRAY_SIZE("citation"), 0) AS "citation_count"
FROM PATENTS.PATENTS.PUBLICATIONS
LIMIT 100
Answer:
publication_number,citation_count
CR-5634-A,0
CR-5990-A,0
FI-429-A,0
HK-6083-A,0
HU-T52763-A,0
JP-H03206829-A,0
JP-S62159089-A,0
US-416-A,0
US-2528225-A,8
AT-A41580-A,0
AT-A47682-A,0
AT-A63682-A,0
CA-920790-A,0
CA-950907-A,0
CA-920830-A,0
CA-9086-A,0
CH-3256-A,0
CH-540255-A,0
CH-433637-A,0
CH-8494-A,0
CH-9587-A,0
CH-9968-A,0
DD-8297-A,0
FR-1334211-A,0
FR-1444995-A,0
FR-1474468-A,0
FR-1478988-A,0
FR-1485992-A,0
FR-1487706-A,0
FR-1508237-A,0
GB-893001-A,0
GB-873984-A,0
GB-307790-A,0
GB-534192-A,0
HK-39487-A,0
HK-52284-A,0
HK-55992-A,0
HK-60178-A,0
HK-82486-A,0
HU-T58725-A,0
JP-S62157892-A,0
JP-H06198910-A,0
MA-42286-A,0
OA-07542-A,0
OA-08399-A,0
PH-11723-A,0
PH-15213-A,0
PH-17928-A,0
PH-23905-A,0
TR-26506-A,0
US-4613-A,0
US-4234270-A,6
US-6310-A,0
US-8947-A,0
YU-24971-A,0
YU-51397-A,0
YU-53588-A,0
YU-94082-A,0
AT-A134275-A,0
AT-A160683-A,0
AT-A168281-A,0
AT-A179178-A,0
AT-A196182-A,0
AT-A202882-A,0
AT-A205780-A,0
AT-A245590-A,0
AT-A250686-A,0
AT-A269985-A,0
AT-A272073-A,0
AT-A312885-A,0
AT-A404675-A,0
AT-A482077-A,0
AT-A519575-A,0
AT-A710279-A,0
AT-A735378-A,0
AT-A876472-A,0
AT-A906278-A,0
BE-804534-A,0
BE-806687-A,0
BE-813367-A,0
BE-823416-A,0
BE-825816-A,0
BE-833811-A,0
BE-837312-A,0
BE-837857-A,0
BE-840231-A,0
BE-848755-A,0
BE-852837-A,0
BE-853553-A,0
BE-857395-A,0
BE-861199-A,0
BE-866723-A,0
BE-868080-A,0
BE-868938-A,0
BE-869056-A,0
BE-871421-A,0
BE-873394-A,0
BE-877768-A,0
BE-885287-A,0
BE-509322-A,0
Query:
SELECT "publication_number", COALESCE(ARRAY_SIZE("citation"), 0) AS "citation_count"
FROM PATENTS.PATENTS.PUBLICATIONS
WHERE COALESCE(ARRAY_SIZE("citation"), 0) = 1
LIMIT 100
Answer:
publication_number,citation_count
US-2007071679-A1,1
US-2007296459-A1,1
US-2008092517-A1,1
US-2009261491-A1,1
US-2008121320-A1,1
US-2008238901-A1,1
US-2009220940-A1,1
US-2009185057-A1,1
FR-3050553-A1,1
FR-2237032-A1,1
FR-2222344-A1,1
FR-2308141-A1,1
FR-2316953-A1,1
FR-2282363-A1,1
FR-2375233-A1,1
FR-2490992-A1,1
SU-1025666-A1,1
SU-1011741-A1,1
SU-1095089-A1,1
SU-1019576-A1,1
SU-1008409-A1,1
SU-1085957-A1,1
SU-1033273-A1,1
SU-1037212-A1,1
SU-1117665-A1,1
SU-1125687-A1,1
SU-1087521-A1,1
SU-1091348-A1,1
SU-1143560-A1,1
SU-1153034-A1,1
SU-1155552-A1,1
SU-1171331-A1,1
SU-1233014-A1,1
SU-1243088-A1,1
SU-1260626-A1,1
SU-1318693-A1,1
SU-1253760-A1,1
SU-1354348-A1,1
SU-1377808-A1,1
SU-1282045-A1,1
SU-1335294-A1,1
SU-1386605-A1,1
SU-1388488-A1,1
SU-1481233-A1,1
SU-1421574-A1,1
SU-1491808-A1,1
SU-1507419-A1,1
SU-1623917-A1,1
SU-1545113-A1,1
SU-1557032-A1,1
SU-1670106-A1,1
SU-1563715-A1,1
SU-1608731-A1,1
SU-1628200-A1,1
SU-1694688-A1,1
SU-1687367-A1,1
SU-1673441-A1,1
SU-1677064-A1,1
SU-1753325-A1,1
SU-1706418-A1,1
SU-1731569-A1,1
SU-1763982-A1,1
SU-1762060-A1,1
SU-1761311-A1,1
SU-1758444-A1,1
US-2002038431-A1,1
US-2003132543-A1,1
US-2002135418-A1,1
US-2004203125-A1,1
US-2003087363-A1,1
US-2003109068-A1,1
US-2004093079-A1,1
US-2004157903-A1,1
US-2008161378-A1,1
US-2004086910-A1,1
US-2004078851-A1,1
US-2005034101-A1,1
US-2005036349-A1,1
US-2006083036-A1,1
US-2006154310-A1,1
US-2005205492-A1,1
US-2010120852-A1,1
US-2010261772-A1,1
US-2015187919-A1,1
US-2015329446-A1,1
US-2015365842-A1,1
US-2015210603-A1,1
US-2016059066-A1,1
US-2016105785-A1,1
US-2016013939-A1,1
US-2018136358-A1,1
US-2016293991-A1,1
US-2016288503-A1,1
US-2017152290-A1,1
US-2016285046-A1,1
US-2017033153-A1,1
US-2017029793-A1,1
US-2017094790-A1,1
US-2017329126-A1,1
US-2015205759-A1,1
Query:
SELECT "publication_number", "grant_date", "application_kind", COALESCE(ARRAY_SIZE("citation"), 0) AS "citation_count"
FROM PATENTS.PATENTS.PUBLICATIONS
WHERE "application_kind" = 'U'
  AND "grant_date" BETWEEN 20100101 AND 20101231
  AND "grant_date" > 0
  AND COALESCE(ARRAY_SIZE("citation"), 0) = 1
LIMIT 100
Answer:
publication_number,grant_date,application_kind,citation_count
KR-200450262-Y1,20100915,U,1
KR-200448620-Y1,20100503,U,1
KR-200447349-Y1,20100120,U,1
Query:
SELECT COUNT(*) AS "number_of_patents_with_exactly_one_forward_citation_in_10_years"
FROM (
    SELECT P."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS P
    INNER JOIN (
        SELECT c.value:"publication_number"::STRING AS "cited_publication_number",
               TO_DATE(NULLIF(Q."filing_date", 0)::VARCHAR, 'YYYYMMDD') AS "citing_filing_date"
        FROM PATENTS.PATENTS.PUBLICATIONS Q,
             LATERAL FLATTEN(input => Q."citation") c
        WHERE c.value:"publication_number"::STRING IS NOT NULL
          AND Q."filing_date" > 0
    ) citations ON citations."cited_publication_number" = P."publication_number"
                 AND citations."citing_filing_date" BETWEEN TO_DATE(NULLIF(P."filing_date", 0)::VARCHAR, 'YYYYMMDD')
                                                  AND DATEADD(year, 10, TO_DATE(NULLIF(P."filing_date", 0)::VARCHAR, 'YYYYMMDD'))
    WHERE P."application_kind" = 'U'
      AND TO_DATE(NULLIF(P."grant_date", 0)::VARCHAR, 'YYYYMMDD') BETWEEN '2010-01-01' AND '2010-12-31'
      AND P."filing_date" > 0
    GROUP BY P."publication_number"
    HAVING COUNT(*) = 1
) AS sub;
Answer:
number_of_patents_with_exactly_one_forward_citation_in_10_years
3
Query:
SELECT P."publication_number", COUNT(*) AS "forward_citation_count"
FROM PATENTS.PATENTS.PUBLICATIONS P
INNER JOIN (
    SELECT c.value:"publication_number"::STRING AS "cited_publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS Q,
    LATERAL FLATTEN(input => Q."citation") c
    WHERE c.value:"publication_number"::STRING IS NOT NULL
) citations ON citations."cited_publication_number" = P."publication_number"
WHERE P."publication_number" IS NOT NULL
GROUP BY P."publication_number"
LIMIT 100
Answer:
publication_number,forward_citation_count
WO-2019099661-A1,1
US-2017079328-A1,1
JP-H0671322-A,2
JP-2001117595-A,1
CN-102062887-A,1
US-5581451-A,1
CN-102006658-A,1
CN-104451760-A,1
CN-103720370-A,2
JP-2009233945-A,1
US-2103897-A,1
US-3484311-A,1
CN-204983122-U,1
US-1062579-A,1
JP-S556326-A,1
JP-H066091-Y2,1
CN-104006366-A,1
CN-209506612-U,1
US-2008165617-A1,1
US-2016341582-A1,1
CN-107709441-A,1
US-8910847-B2,2
US-10569071-B2,3
JP-H0956892-A,1
CN-107592029-A,1
CN-207651444-U,1
GB-520327-A,1
WO-2018096179-A1,1
US-6656282-B2,1
US-5278627-A,2
DE-19548154-B4,1
US-2016326915-A1,1
US-2016200437-A1,1
JP-S543545-A,1
CN-103763513-A,1
CN-111092202-A,1
CN-102010225-A,1
CN-108646256-A,1
CN-101497546-A,1
CN-102731187-A,1
CN-102722906-A,1
JP-H0577023-A,1
US-4820402-A,1
US-1087540-A,1
US-1797744-A,1
JP-2010058556-A,1
US-2002039904-A1,2
US-2005185880-A1,1
US-2009116403-A1,1
US-7763069-B2,1
US-2330652-A,1
CN-2685300-Y,1
CN-102633568-A,1
US-2227938-A,1
US-4146649-A,1
US-3680330-A,1
JP-2005255419-A,1
US-2006221068-A1,1
CN-102128880-A,1
KR-20050079496-A,1
US-4504221-A,1
CN-112264723-A,1
JP-2001311644-A,1
US-9246311-B1,1
JP-S61173597-A,1
EP-0604777-A1,1
US-2005246353-A1,1
US-5523667-A,1
US-2007162413-A1,1
US-3287526-A,1
JP-H0473862-A,1
CN-210608031-U,1
US-6061349-A,3
JP-H01306319-A,1
CN-106238986-A,1
CN-102427633-A,1
US-4349255-A,1
JP-2013248763-A,2
US-2010245375-A1,1
JP-H04207833-A,1
US-2007157285-A1,1
US-2007284440-A1,2
KR-20170062343-A,1
US-2008064226-A1,1
CN-203988035-U,1
CN-103814851-B,1
CN-106878181-A,1
US-313046-A,1
US-2332540-A,1
US-3998462-A,2
DE-3012998-A1,1
EP-2322385-A1,1
US-2017093231-A1,1
KR-20110029317-A,1
US-2017309530-A1,1
JP-4216266-B2,1
US-2017182414-A1,1
US-2007211449-A1,1
CN-108114699-A,1
US-5947495-A,1
Query:
SELECT P."publication_number", COUNT(*) AS "forward_citation_count"
FROM PATENTS.PATENTS.PUBLICATIONS P
INNER JOIN (
    SELECT c.value:"publication_number"::STRING AS "cited_publication_number",
           TO_DATE(NULLIF(Q."filing_date", 0)::VARCHAR, 'YYYYMMDD') AS "citing_filing_date"
    FROM PATENTS.PATENTS.PUBLICATIONS Q,
    LATERAL FLATTEN(input => Q."citation") c
    WHERE c.value:"publication_number"::STRING IS NOT NULL
      AND Q."filing_date" > 0
) citations ON citations."cited_publication_number" = P."publication_number"
     AND citations."citing_filing_date" BETWEEN TO_DATE(NULLIF(P."filing_date", 0)::VARCHAR, 'YYYYMMDD')
                                            AND DATEADD(year, 10, TO_DATE(NULLIF(P."filing_date", 0)::VARCHAR, 'YYYYMMDD'))
WHERE P."application_kind" = 'U'
  AND TO_DATE(NULLIF(P."grant_date", 0)::VARCHAR, 'YYYYMMDD') BETWEEN '2010-01-01' AND '2010-12-31'
  AND P."filing_date" > 0
GROUP BY P."publication_number"
HAVING COUNT(*) = 1
LIMIT 100
Answer:
publication_number,forward_citation_count
CN-201427255-Y,1
CN-201620562-U,1
CN-201400470-Y,1
Query:
SELECT DISTINCT "kind_code"
FROM PATENTS.PATENTS.PUBLICATIONS
WHERE "kind_code" IS NOT NULL
LIMIT 100
Answer:
kind_code
S2
B1
S
D2
U8
I1
T9
U9
A1
F1
P9
V0
A5
C1
Y8
H1
R1
F2
A4
U0
C9
L
Z
T
T3
U4
A0
B9
U5
R
Z2
A
T2
Y2
D
P
B7
T8
A3
B
Y1
A8
I2
P1
C4
T4
B3
D1
T5
G2
A6
C
U2
U
B4
C2
Q
C5
H3
C3
A7
A2
Y
B8
C0
S1
U3
M
B5
B2
B6
A9
E2
U1
V
E
G
D0
T1
Y4
End Exploring Related Columns
Task: Can you find how many utility patents granted in 2010 have exactly one forward citation within the ten years following their application date?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To determine the number of utility patents granted in 2010 that have exactly one forward citation within the ten years following their application date, we analyze the patent data available in the `PUBLICATIONS` table. We focus on utility patents granted in 2010 and count the number of forward citations each received within the specified time frame.

```csv
number_of_patents_with_exactly_one_forward_citation
num:int
(Attention: answer in one row)
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-26 21:28:23 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 21:28:23 - root - INFO - ```sql
SELECT COUNT(*) AS "number_of_patents_with_exactly_one_forward_citation"
FROM (
    SELECT P."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS P
    INNER JOIN (
        SELECT c.value:"publication_number"::STRING AS "cited_publication_number",
               TO_DATE(NULLIF(Q."filing_date", 0)::VARCHAR, 'YYYYMMDD') AS "citing_filing_date"
        FROM PATENTS.PATENTS.PUBLICATIONS Q,
             LATERAL FLATTEN(input => Q."citation") c
        WHERE c.value:"publication_number"::STRING IS NOT NULL
          AND Q."filing_date" > 0
    ) citations ON citations."cited_publication_number" = P."publication_number"
                 AND citations."citing_filing_date" BETWEEN TO_DATE(NULLIF(P."filing_date", 0)::VARCHAR, 'YYYYMMDD')
                                                   AND DATEADD(year, 10, TO_DATE(NULLIF(P."filing_date", 0)::VARCHAR, 'YYYYMMDD'))
    WHERE P."application_kind" = 'U'
      AND TO_DATE(NULLIF(P."grant_date", 0)::VARCHAR, 'YYYYMMDD') BETWEEN '2010-01-01' AND '2010-12-31'
      AND P."filing_date" > 0
    GROUP BY P."publication_number"
    HAVING COUNT(*) = 1
) AS sub;
```
2025-01-26 21:28:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 21:28:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 21:28:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 21:28:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-26 21:28:25 - snowflake.connector.connection - INFO - closed
2025-01-26 21:28:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 21:28:25 - root - INFO - itercount: 1
2025-01-26 21:28:25 - root - INFO - 0
2025-01-26 21:28:25 - root - INFO - results: 
number_of_patents_with_exactly_one_forward_citation
3


2025-01-26 21:28:25 - root - INFO - Please check the answer again by reviewing Can you find how many utility patents granted in 2010 have exactly one forward citation within the ten years following their application date?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To determine the number of utility patents granted in 2010 that have exactly one forward citation within the ten years following their application date, we analyze the patent data available in the `PUBLICATIONS` table. We focus on utility patents granted in 2010 and count the number of forward citations each received within the specified time frame.

```csv
number_of_patents_with_exactly_one_forward_citation
num:int
(Attention: answer in one row)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
number_of_patents_with_exactly_one_forward_citation
3
Current sql:
SELECT COUNT(*) AS "number_of_patents_with_exactly_one_forward_citation"
FROM (
    SELECT P."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS P
    INNER JOIN (
        SELECT c.value:"publication_number"::STRING AS "cited_publication_number",
               TO_DATE(NULLIF(Q."filing_date", 0)::VARCHAR, 'YYYYMMDD') AS "citing_filing_date"
        FROM PATENTS.PATENTS.PUBLICATIONS Q,
             LATERAL FLATTEN(input => Q."citation") c
        WHERE c.value:"publication_number"::STRING IS NOT NULL
          AND Q."filing_date" > 0
    ) citations ON citations."cited_publication_number" = P."publication_number"
                 AND citations."citing_filing_date" BETWEEN TO_DATE(NULLIF(P."filing_date", 0)::VARCHAR, 'YYYYMMDD')
                                                   AND DATEADD(year, 10, TO_DATE(NULLIF(P."filing_date", 0)::VARCHAR, 'YYYYMMDD'))
    WHERE P."application_kind" = 'U'
      AND TO_DATE(NULLIF(P."grant_date", 0)::VARCHAR, 'YYYYMMDD') BETWEEN '2010-01-01' AND '2010-12-31'
      AND P."filing_date" > 0
    GROUP BY P."publication_number"
    HAVING COUNT(*) = 1
) AS sub;
2025-01-26 21:28:55 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 21:28:55 - root - INFO - To determine the number of utility patents granted in 2010 that have exactly one forward citation within the ten years following their application date, we analyze the patent data available in the `PUBLICATIONS` table. We focus on utility patents (`"application_kind" = 'U'`) granted in 2010 and count the number of forward citations each received within the specified time frame.

```csv
number_of_patents_with_exactly_one_forward_citation
3
```

```sql
SELECT COUNT(*) AS "number_of_patents_with_exactly_one_forward_citation"
FROM (
    SELECT P."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS P
    INNER JOIN (
        SELECT c.value:"publication_number"::STRING AS "cited_publication_number",
               TO_DATE(NULLIF(Q."filing_date", 0)::VARCHAR, 'YYYYMMDD') AS "citing_filing_date"
        FROM PATENTS.PATENTS.PUBLICATIONS Q,
             LATERAL FLATTEN(input => Q."citation") c
        WHERE c.value:"publication_number"::STRING IS NOT NULL
          AND Q."filing_date" > 0
    ) citations ON citations."cited_publication_number" = P."publication_number"
                 AND citations."citing_filing_date" BETWEEN TO_DATE(NULLIF(P."filing_date", 0)::VARCHAR, 'YYYYMMDD')
                                                   AND DATEADD(year, 10, TO_DATE(NULLIF(P."filing_date", 0)::VARCHAR, 'YYYYMMDD'))
    WHERE P."application_kind" = 'U'
      AND TO_DATE(NULLIF(P."grant_date", 0)::VARCHAR, 'YYYYMMDD') BETWEEN '2010-01-01' AND '2010-12-31'
      AND P."filing_date" > 0
    GROUP BY P."publication_number"
    HAVING COUNT(*) = 1
) AS sub;
```
2025-01-26 21:28:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 21:28:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 21:28:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 21:28:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-26 21:28:57 - snowflake.connector.connection - INFO - closed
2025-01-26 21:28:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 21:28:57 - root - INFO - itercount: 2
2025-01-26 21:28:57 - root - INFO - 0
2025-01-26 21:28:57 - root - INFO - Total iteration counts: 2
