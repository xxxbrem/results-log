2025-01-24 23:33:07 - openai._base_client - INFO - Retrying request to /chat/completions in 0.426663 seconds
2025-01-24 23:33:52 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 23:33:52 - root - INFO - SQL:
SELECT DISTINCT "order_status"
   FROM "orders"
   LIMIT 100;
Results:
order_status
delivered
invoiced
shipped
processing
unavailable
canceled
created
approved

2025-01-24 23:33:52 - root - INFO - SQL:
SELECT "order_id", "customer_id", "order_purchase_timestamp"
   FROM "orders"
   WHERE "order_status" = 'delivered'
   LIMIT 100;
Results:
Too long, hard cut:
order_id,customer_id,order_purchase_timestamp
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,2017-10-02 10:56:33
53cdb2fc8bc7dce0b6741e2150273451,b0830fb4747a6c6d20dea0b8c802d7ef,2018-07-24 20:41:37
47770eb9100c2d0c44946d9cf07ec65d,41ce2a54c0b03bf3443c3d931a367089,2018-08-08 08:38:49
949d5b44dbf5de918fe9c16f97b45f8a,f88197465ea7920adcdbec7375364d82,2017-11-18 19:28:06
ad21c59c0840e6cb83a9ceb5573f8159,8ab97904e6daea8866dbdbc4fb7aad2c,2018-02-13 21:18:39
a4591c265e18cb1dcee52889e2d8acc3,503740e9ca751ccdda7ba28e9ab8f608,2017-07-09 21:57:05
6514b8ad8028c9f2cc2374ded245783f,9bdf08b4b3b52b5526ff42d37d47f222,2017-05-16 13:10:30
76c6e866289321a7c93b82b54852dc33,f54a9f0e6b351c431402b8461ea51999,2017-01-23 18:29:09
e69bfb5eb88e0ed6a785585b27e16dbf,31ad1d1b63eb9962463f764d4e6e0c9d,2017-07-29 11:55:02
e6ce16cb79ec1d90b1da9085a6118aeb,494dded5b201313c64ed7f100595b95c,2017-05-16 19:41:10
34513ce0c4fab462a55830c0989c7edb,7711cf624183d843aafe81855097bc37,2017-07-13 19:58:11
82566a660a982b15fb86e904c8d32918,d3e3b74c766bc6214e0c830b17ee2341,2018-06-07 10:06:19
5ff96c15d0b717ac6ad1f3d77225a350,19402a48fe860416adf93348aba37740,2018-07-25 17:44:10
432aaf21d85167c2c86ec9448c4e42cc,3df704f53d3f1d4818840b34ec672a9f,2018-03-01 14:14:28
dcb36b511fcac050b97cd5c05de84dc3,3b6828a50ffe546942b7a473d70ac0fc,2018-06-07 19:03:12
403b97836b0c04a622354cf531062e5f,738b086814c6fcc74b8cc583f8516ee3,2018-01-02 19:00:43
116f0b09343b49556bbad5f35bee0cdf,3187789bec990987628d7a9beb4dd6ac,2017-12-26 23:41:31
85ce859fd6dc634de8d2f1e290444043,059f7fc5719c7da6cbafe370971a8d70,2017-11-21 00:03:41
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,2017-10-26 15:54:26
203096f03d82e0dffbc41ebc2e2bcfb7,d2b091571da224a1b36412c18bc3bbfe,2017-09-18 14:31:30
f848643eec1d69395095eb3840d2051e,4fa1cd166fa598be6de80fa84eaade43,2018-03-15 08:52:40
2807d0e504d6d4894d41672727bc139f,72ae281627a6102d9b3718528b420f8a,2018-02-03 20:37:35
95266dbfb7e20354baba07964dac78d5,a166da34890074091a942054b36e4265,2018-01-08 07:55:29
f3e7c359154d965827355f39d6b1fdac,62b423aab58096ca514ba6aa06be2f98,2018-08-09 11:44:40
fbf9ac61453ac646ce8ad9783d7d0af6,3a874b4d4c4b6543206ff5d89287f0c3,2018-02-20 23:46:53
acce194856392f074dbf9dada14d8d82,7e20bf5ca92da68200643bda76c504c6,2018-06-04 00:00:13
dd78f560c270f1909639c11b925620ea,8b212b9525f9e74e85e37ed6df37693e,2018-03-12 01:50:26
91b2a010e1e45e6ba3d133fa997597be,cce89a605105b148387c52e286ac8335,2018-05-02 11:45:38
ecab90c9933c58908d3d6add7c6f5ae3,761df82feda9778854c6dafdaeb567e4,2018-02-25 13:50:30
f70a0aff17df5a6cdd9a7196128bd354,456dc10730fbdba34615447ea195d643,2017-08-10 11:58:33
1790eea0b567cf50911c057cf20f90f9,52142aa69d8d0e1247ab0cada0f76023,2018-04-16 21:15:39
989225ba6d0ebd5873335f7e01de2ae7,816f8653d5361cbf94e58c33f2502a5c,2017-12-12 13:56:04
d887b52c6516beb39e8cd44a5f8b60f7,d9ef95f98d8da3b492bb8c0447910498,2018-02-03 12:38:58
b276e4f8c0fb86bd82fce576f21713e0,cf8ffeddf027932e51e4eae73b384059,2018-07-29 23:34:51
8563039e855156e48fccee4d611a3196,5f16605299d698660e0606f7eae2d2f9,2018-02-17 15:59:46
60550084e6b4c0cb89a87df1f3e5ebd9,f5458ddc3545711efa883dd7ae7c4497,2018-02-21 18:15:12
5acce57f8d9dfd55fa48e212a641a69d,295ae9b35379e077273387ff64354b6f,2017-07-31 21:37:10
434d158e96bdd6972ad6e6d73ddcfd22,2a1dfb647f32f4390e7b857c67458536,2018-06-01 12:23:13
7206b86ea789983f7a273ea7fa0bc2a8,3391c4bc11a817e7973e498b0b023158,2018-03-26 17:12:18
1e7aff52cdbb2451ace09d0f848c3699,ddaff536587109b89777e0353215e150,2017-05-19 18:53:40
6ea2f835b4556291ffdc53fa0b3b95e8,c7340080e394356141681bd4c9b8fe31,2017-11-24 21:27:48
948097deef559c742e7ce321e5e58919,8644be24d48806bc3a88fd59fb47ceb1,2017-08-04 17:10:39
d22e9fa5731b9e30e8b27afcdc2f8563,756fb9391752dad934e0fe3733378e57,2018-08-04 23:25:30
6ebaec694d7025e2ad4a05dba887c032,4f28355e5c17a4a42d3ce2439a1d4501,2017-05-18 13:55:47
d17dc4a904426827ca80f2ccb3a6be56,569cf68214806a39acc0f39344aea67f,2017-05-14 20:28:25
25f4376934e13d3508486352e11a5db0,12fd2740039676063a874b9567dfa651,2018-05-17 16:59:11
5820a1100976432c7968a52da59e9364,2b56e94c2f66f2d97cfa63356f69cee8,2018-07-29 11:24:17
2ce1ad82022c1ba30c2079502ac725aa,7f2178c5d771e17f507d3c1637339298,2017-08-09 20:19:05
138849fd84dff2fb4ca70a0a34c4aa1c,9b18f3fc296990b97854e351334a32f6,2018-02-01 14:02:19
47aa4816b27ba60ec948cd019cc1afc1,148348ff65384b4249b762579532e248,2018-06-26 13:42:52
9faeb9b2746b9d7526aef5acb08e2aa0,79183cd650e2bb0d475b0067d45946ac,2018-07-26 14:39:59
641fb0752bf5b5940c376b3a8bb9dc52,f5afca14dfa9dc64251cf2b45c54c363,2017-12-15 00:06:10
e425680f760cbc130be3e53a9773c584,f178c1827f67a8467b0385b7378d951a,2017-08-31 08:15:24
40c5e18f7d112b59b3e5113a59a905b3,67407057a7d5ee17d1cd09523f484d13,2018-06-11 10:25:52
734e7d1bbaeb2ff82521ca0fe6fb6f79,2932d241d1f31e6df6c701d52370ae02,2018-06-11 08:18:19
66e4624ae69e7dc89bd50222b59f581f,684fa6da5134b9e4dab731e00011712d,2018-03-09 14:50:15
a685d016c8a26f71a0bb67821070e398,911e4c37f5cafe1604fe6767034bf1ae,2017-03-13 18:14:36
2edfd6d1f0b4cd0db4bf37b1b224d855,241e78de29b3090cfa1

2025-01-24 23:33:52 - root - INFO - SQL:
SELECT DISTINCT "customer_id"
   FROM "orders"
   LIMIT 100;
Results:
customer_id
9ef432eb6251297304e76186b10a928d
b0830fb4747a6c6d20dea0b8c802d7ef
41ce2a54c0b03bf3443c3d931a367089
f88197465ea7920adcdbec7375364d82
8ab97904e6daea8866dbdbc4fb7aad2c
503740e9ca751ccdda7ba28e9ab8f608
ed0271e0b7da060a393796590e7b737a
9bdf08b4b3b52b5526ff42d37d47f222
f54a9f0e6b351c431402b8461ea51999
31ad1d1b63eb9962463f764d4e6e0c9d
494dded5b201313c64ed7f100595b95c
7711cf624183d843aafe81855097bc37
d3e3b74c766bc6214e0c830b17ee2341
19402a48fe860416adf93348aba37740
3df704f53d3f1d4818840b34ec672a9f
3b6828a50ffe546942b7a473d70ac0fc
738b086814c6fcc74b8cc583f8516ee3
3187789bec990987628d7a9beb4dd6ac
059f7fc5719c7da6cbafe370971a8d70
7f8c8b9c2ae27bf3300f670c3d478be8
d2b091571da224a1b36412c18bc3bbfe
4fa1cd166fa598be6de80fa84eaade43
72ae281627a6102d9b3718528b420f8a
a166da34890074091a942054b36e4265
62b423aab58096ca514ba6aa06be2f98
3a874b4d4c4b6543206ff5d89287f0c3
7e20bf5ca92da68200643bda76c504c6
8b212b9525f9e74e85e37ed6df37693e
cce89a605105b148387c52e286ac8335
761df82feda9778854c6dafdaeb567e4
456dc10730fbdba34615447ea195d643
52142aa69d8d0e1247ab0cada0f76023
816f8653d5361cbf94e58c33f2502a5c
d9ef95f98d8da3b492bb8c0447910498
cf8ffeddf027932e51e4eae73b384059
5f16605299d698660e0606f7eae2d2f9
f5458ddc3545711efa883dd7ae7c4497
295ae9b35379e077273387ff64354b6f
2a1dfb647f32f4390e7b857c67458536
3391c4bc11a817e7973e498b0b023158
ddaff536587109b89777e0353215e150
c7340080e394356141681bd4c9b8fe31
8644be24d48806bc3a88fd59fb47ceb1
756fb9391752dad934e0fe3733378e57
caded193e8e47b8362864762a83db3c5
4f28355e5c17a4a42d3ce2439a1d4501
569cf68214806a39acc0f39344aea67f
12fd2740039676063a874b9567dfa651
2b56e94c2f66f2d97cfa63356f69cee8
7f2178c5d771e17f507d3c1637339298
9b18f3fc296990b97854e351334a32f6
148348ff65384b4249b762579532e248
79183cd650e2bb0d475b0067d45946ac
f5afca14dfa9dc64251cf2b45c54c363
f178c1827f67a8467b0385b7378d951a
67407057a7d5ee17d1cd09523f484d13
2932d241d1f31e6df6c701d52370ae02
684fa6da5134b9e4dab731e00011712d
911e4c37f5cafe1604fe6767034bf1ae
241e78de29b3090cfa1b5d73a8130c72
4632eb5a8f175f6fe020520ae0c678f3
dd5095632e3953fc0947b8ab5176b0be
9916715c2ab6ee1710c9c32f0a534ad2
c77ee2d8ba1614a4d489a44166894938
81e08b08e5ed4472008030d70327c71f
5dda11942d4f77bee3a46d71e442aec4
74805bc388861fa350ed2fade8444e0b
4afc1dcca5fe8926fc97d60a4497f8ab
be8c14c16a4d47194ccdfe10f1fc5b1a
a9d37ddc8ba4d9f6dbac7d8ec378cc95
bb2f5e670f7155dc622c57e4b31d0a69
55e6b290205c84ddd23ddf5eb134efd4
f5618502bee8eafdee72fb6955e2ebdf
a90391a47de936d56c66a5366cba1462
388025bec8128ff20ec1a316ed4dcf02
afb19a4b667cb708caab312757ec3d3f
636e15840ab051faa13d3f781b6e4233
05e996469a2bf9559c7122b87e156724
5bb39c890c91b1d26801aa19a9336eac
f26a435864aebedff7f7c84f82ee229f
29cb486c739f9774c8eb542e07b56cd2
bf141bf67fbe428d558bcf0e018eab60
b673f0597cb0c4d12778f731045f361a
6772a0a230a2667d16c3620f000e1348
9f6618c17568ac301465fe7ad056c674
fee181bf648906d1c57f84f216976286
df9b032b2ad0fd6bf37dfb48e5f83845
93ada7a24817edda9f4ab998fa823d16
64fb950e760ec8b0db79154a1fa9c1bf
48558a50a7ba1aab61891936d2ca7681
3a897024068ed42a183de61d5727d866
8628fac2267e8c8804525da99c10ed0e
332df68ccac2f2f7d9e11299188f8bce
e28dd4261bed9c7ba89ecaf411b88f7c
82f0b75bb50fcb30711e5277e36b3983
3135962ee745ef39b85576df7ddbaa99
1833a0540067becaf59368fe4cd4303a
68451b39b1314302c08c65a29f1140fc
0bf19317b1830a69e55b40710576aa7a
c622b892a190735ef81c0087973fa16d

2025-01-24 23:33:53 - root - INFO - SQL:
SELECT "order_id", SUM("price") AS "total_order_price"
   FROM "order_items"
   GROUP BY "order_id"
   LIMIT 100;
Results:
order_id,total_order_price
00010242fe8c5a6d1ba2dd792cb16214,58.9
00018f77f2f0320c557190d7a144bdd3,239.9
000229ec398224ef6ca0657da4fc703e,199.0
00024acbcdf0a6daa1e931b038114c75,12.99
00042b26cf59d7ce69dfabb4e55b4fd9,199.9
00048cc3ae777c65dbb7d2a0634bc1ea,21.9
00054e8431b9d7675808bcb819fb4a32,19.9
000576fe39319847cbb9d288c5617fa6,810.0
0005a1a1728c9d785b8e2b08b904576c,145.95
0005f50442cb953dcd1d21e1fb923495,53.99
00061f2a7bc09da83e415a52dc8a4af1,59.99
00063b381e2406b52ad429470734ebd5,45.0
0006ec9db01a64e59a68b2c340bf65a7,74.0
0008288aa423d2a3f00fcb17cd7d8719,99.8
0009792311464db532ff765bf7b182ae,99.9
0009c9a17f916a706d71784483a5d643,639.0
000aed2e25dbad2f9ddb70584c5a2ded,144.0
000c3e6612759851cc3cbb4b83257986,99.0
000e562887b1f2006d75e0be9558292e,25.0
000e63d38ae8c00bbcb5a30573b99628,47.9
000e906b789b55f64edcb1f84030f90d,21.99
000f25f4d72195062c040b12dce9a18a,119.99
001021efaa8636c29475e7734483457d,49.0
0010b2e5201cc5f1ae7e9c6cc8f5bd00,48.9
00119ff934e539cf26f92b9ef0cdfed8,219.9
0011d82c4b53e22e84023405fb467e57,289.0
00125cb692d04887809806618a2a145f,109.9
00130c0eee84a3d909e75bc08c5c3ca1,27.9
0013503b13da1eac686219390b7d641b,119.9
00137e170939bba5a3134e2386413108,397.0
001427c0ec99cf8af737bd88e92fd444,59.9
00143d0f86d6fbd9f9b38ab440ac16f5,63.989999999999995
0014ae671de39511f7575066200733b7,16.5
0015ebb40fb17286bea51d4607c4733c,21.9
00169e31ef4b29deaae414f9a5e95929,39.0
0016dfedd97fc2950e388d2971d718c7,49.75
0017afd5076e074a48f1f1a4c7bac9c5,809.1
001862358bf858722e1e2ae000cfed8b,99.99
0019c29108428acffd089c36103c9440,59.9
001ab0a7578dd66cd4b0a71f5b6e1e41,74.67
001ac194d4a326a6fa99b581e9a3d963,54.0
001b76dd48a5b1eee3e87778daa40df8,81.99
001c85b5f68d2be0cb0797afc9e8ce9a,99.0
001d8f0e34a38c37f7dba2a37d4eba8b,37.98
001daeb0eddc45b999bad0801ad9d273,38.33
001dbc16dc51075e987543d23a0507c7,69.9
001e7ba991be1b19605ca0316e7130f9,195.0
001e7cf2ad6bef3ade12ebc56ceaf0f3,35.9
0020262c8a370bd5a174ea6a2a267321,79.5
0020a222f55eb79a372d0efee3cca688,29.99
002175704e8b209f61b9ad5cfd92b60e,109.9
00229e4e43f7a7e0b9dd819ad43268d3,74.9
0025081dcf9330f9a5052ae82c6ce396,14.95
00254baeb6c932b0a8aeead91fbd02b5,149.9
00259a44fcad3fc0474329e925d14fc3,19.99
0025c5d1a8ca53a240ec2634bb4492ea,390.0
002611a77fe03d076285fd4ca95db77c,135.0
002691433f09002ac9ca0c4e8dbb8ead,104.0
0026a368634b6e6f34f33b1499773a30,149.0
00275bce676303c3bfd7292aefdfa223,279.9
00276d5c3491fbf55305e26891040df9,44.9
002834535f7a609a5c68266f173fa59e,37.99
0028de0ca693a1bb26448916a81105cc,29.99
002955b0acc63d04f6724a31967e82bd,120.0
0029c5db35ef291ce99d1262012e7daa,492.75
0029f17cf0e7640c5cb6825af681303f,94.9
002af7fa9eb99d1456bceb6a13d6fc0b,88.34
002b430ff89b3a24c31a1170acbbedea,199.99
002b4e6fa42cd4a22cc86abc18fe9c05,99.9
002c9def9c9b951b1bec6d50753c9891,156.0
002d040018d12a3853c059f7f23ab5b1,155.0
002f16b7bc4530031b7d90f791b12d8a,249.9
002f19a65a2ddd70a090297872e6d64e,53.98
002f98c0f7efd42638ed6100ca699b42,53.89
0030d783f979fbc5981e75613b057344,60.6
0030ff924c38549807645976adeef2c0,225.0
00310b0c75bb13015ec4d82d341865a4,39.9
00324b3eda39ba5ecce3945823e3594c,76.0
0032d07457ae9c806c79368d7d9ce96b,159.0
003324c70b19a16798817b2b3640e721,205.8
00335b686d693c7d72deeb12f8e89227,63.9
00335f75ea6a4455b524a8dd177067f5,168.8
00337fe25a3780b3424d9ad7c5a4b35e,119.8
003423b755b562962a6225a8de40d12e,232.75
00345f338696283410b7977d2e3efc89,48.9
0035246a40f520710769010f752e7507,87.0
0035c0b07126fe9c24a325216fb96064,131.9
0035e6b7ade84b3f5b86bd49814793df,19.9
0036757472ece3dde52fd4bfd929c90e,136.99
0036887767dea4bd43b1a88cd0d9477a,399.99
00378c6c981f234634c0b9d6128df6dd,41.0
003822434f91204da0a51fe4cf2aba18,138.0
0039500db36d50d7d0bfaf23723550f3,169.9
003a7f59d7e08a9c61d9e2881fe6459c,119.0
003a94f778ef8cfd50247c8c1b582257,39.9
003cc6161d7a2593f2525cce0c330d32,85.0
003d0634280ff3d1d3a54459349a6899,220.0
003d804eef0e1b856881cd18e0cc0d4c,277.0
003d9fc84ad902adf2265248b5ffe1a4,66.99
003edccf16bc5ec447f592913b3df2b4,14.0

2025-01-24 23:33:53 - root - INFO - SQL:
SELECT "customer_id", COUNT(DISTINCT "order_id") AS "order_count"
   FROM "orders"
   WHERE "order_status" = 'delivered'
   GROUP BY "customer_id"
   LIMIT 100;
Results:
customer_id,order_count
00012a2ce6f8dcda20d059ce98491703,1
000161a058600d5901f007fab4c27140,1
0001fd6190edaaf884bcaf3d49edf079,1
0002414f95344307404f0ace7a26f1d5,1
000379cdec625522490c315e70c7a9fb,1
0004164d20a9e969af783496f3408652,1
000419c5494106c306a97b5635748086,1
00046a560d407e99b969756e0b10f282,1
00050bf6e01e69d5c0fd612f1bcfb69c,1
000598caf2ef4117407665ac33275130,1
0005aefbb696d34b3424dccd0a0e9fd0,1
00062b33cb9f6fe976afdcff967ea74d,1
00066ccbe787a588c52bd5ff404590e3,1
00072d033fe2e59061ae5c3aff1a2be5,1
0009a69b72033b2d0ec8c69fc70ef768,1
000bf8121c3412d3057d32371c5d3395,1
000e943451fc2788ca6ac98a682f2f49,1
000f17e290c26b28549908a04cfe36c1,1
000fd45d6fedae68fc6676036610f879,1
0010068a73b7c56da5758c3f9e5c7375,1
001028b78fd413e19704b3867c369d3a,1
00104a47c29da701ce41ee52077587d9,1
001051abfcfdbed9f87b4266213a5df1,1
00114026c1b7b52ab1773f317ef4880b,1
001226b2341ef620415ce7bbafcfac28,1
0012a5c13793cf51e253f096a7e740dd,1
0013280441d86a4f7a8006efdaf1b0fe,1
0013cd8e350a7cc76873441e431dd5ee,1
001450ebb4a77efb3d68be5f7887cb1e,1
00146ad30454993879adaa91c518f68c,1
00155f0530cc7b2bf73cc3f81cb01c52,1
0015bc9fd2d5395446143e8b215d7c75,1
0015f7887e2fde13ddaa7b8e385af919,1
0017a0b4c1f1bdb9c395fa0ac517109c,1
0018c09f333634ca9c80d9ff46e43e9c,1
0018f7fde63ca77254dbc47f4ea358b2,1
0019c9aaad15b043c48f0a1180f22ce8,1
001a57041f56400917a187dd74e6cbc1,1
001b4e9b73aa98a6276b241bfd496822,1
001c7f05398c45b42eee0d5a77783bca,1
001df1ee5c36767aa607001ab1a13a06,1
001f150aebb5d897f2059b0460c38449,1
001f35d9f262c558fd065346fbf5801d,1
001f6f1a5e902ad14e1f709a7215de11,1
00205ad9ba1ef4340cef86583294cf82,1
002236c4f333bc8df6a5939749eb7869,1
002408f390f729598bbac1ef9421c6ae,1
002450e9ea44cb90b8a07ba0b197e149,1
002554bdf9eb99618d8189c3a89fdd52,1
0026955706fd4e2fa997f3f4c18d485a,1
002834b4d901534f48d9e9a72047b288,1
0028ff36263a86bf679df7c863a0a0ba,1
002905287304e28c0218389269b4759b,1
002937abdae13680e17dccd3868b4825,1
0029cdf064769cabdf3186b54d068c99,1
002a10e899b62a460b0116e0b68697ad,1
002b24cb2cd0c3e575040dbd278885e3,1
002c625393dfa194828b462a6ef8cb0b,1
002ce108ccf0356ef5c8b1dce3c0ae29,1
002d358e2462f87678443706cbf2eb21,1
002d597546b2cf44428232c9f237f873,1
002ebb669a34b9e79c88efc755e95322,1
002ef7e55600d44ead53f7c1644e5222,1
002f067b028a3643ad3a0969c7a0f3dc,1
002f90a6eb386bc43bc9ba200db31a89,1
002fb8fc5ce64f8422fa2fe79986c783,1
002ff70a5285669011090c077ef929af,1
00302a0b99783c3d1d1e81c616e321e8,1
0030aded3a67b29946a128ee8468388e,1
0030fbb95fbe7e61f798a80edb01a8e9,1
00314f95a054231742e3c5396b333b88,1
003177b3eeca50af17750f53802c9a09,1
0031abfb953b66e998f67b09e7b11375,1
0031c1062edf836ef7a7a7ea758b137b,1
00330644cccc5db0276fa836976306fe,1
00331de1659c7f4fb660c8810e6de3f5,1
0033823ee55671ac5317d423291333c2,1
0034f7933de3ead6bd9ba49afe95f119,1
003536ce5e18f1d12b9bf76932f8a6b1,1
0035b30e58c620fa2bd30275ddd4f7ef,1
0036875772a8eeb391b8cd7226283fdd,1
00380c010de38d578d02117f6d0b88e7,1
0039b3e41ac6615814a0b44a8992bff5,1
003a75d228dc67cb2918e40c2aacc4bf,1
003b595c764773e20e0949b6fba7b1dc,1
003bc8d06ebed9d146eb9f100d0a89ae,1
003bdf7fd8312f9d14a4b979f3747334,1
003c7cadba4f182b9f22d7d5ea7a5003,1
003cbe6a43560a8b6fd2c07531257c2d,1
003e45472805afa1ee701d83284fa22b,1
003eab528664e1bd677218ef4be086ac,1
003ec17a1389fa302f3a0423dddd8650,1
003f7d92ac63c512bb6584219806f8df,1
0040a8417928d0d5abd5169cd7877181,1
0040b00970e2139e8c43b647c0da5305,1
00411811e3b661e746a6e1ce1f0878ab,1
0041d7b768cb115092fa0f5d55638d06,1
00426311a53f3c052943c88b692a3be2,1
0042d04ee8231b36dcb29aac213f5db4,1
0043b0afd67fb3af74360d2893b9a530,1

2025-01-24 23:33:53 - root - INFO - SQL:
SELECT o."customer_id", SUM(oi."price") AS "total_spent"
   FROM "orders" o
   JOIN "order_items" oi ON o."order_id" = oi."order_id"
   WHERE o."order_status" = 'delivered'
   GROUP BY o."customer_id"
   LIMIT 100;
Results:
customer_id,total_spent
00012a2ce6f8dcda20d059ce98491703,89.8
000161a058600d5901f007fab4c27140,54.9
0001fd6190edaaf884bcaf3d49edf079,179.99
0002414f95344307404f0ace7a26f1d5,149.9
000379cdec625522490c315e70c7a9fb,93.0
0004164d20a9e969af783496f3408652,59.99
000419c5494106c306a97b5635748086,34.3
00046a560d407e99b969756e0b10f282,120.9
00050bf6e01e69d5c0fd612f1bcfb69c,69.99
000598caf2ef4117407665ac33275130,1107.0
0005aefbb696d34b3424dccd0a0e9fd0,134.9
00062b33cb9f6fe976afdcff967ea74d,47.99
00066ccbe787a588c52bd5ff404590e3,199.6
00072d033fe2e59061ae5c3aff1a2be5,89.9
0009a69b72033b2d0ec8c69fc70ef768,159.9
000bf8121c3412d3057d32371c5d3395,30.0
000e943451fc2788ca6ac98a682f2f49,89.9
000f17e290c26b28549908a04cfe36c1,122.9
000fd45d6fedae68fc6676036610f879,53.99
0010068a73b7c56da5758c3f9e5c7375,29.99
001028b78fd413e19704b3867c369d3a,29.9
00104a47c29da701ce41ee52077587d9,83.99
001051abfcfdbed9f87b4266213a5df1,49.97
00114026c1b7b52ab1773f317ef4880b,49.9
001226b2341ef620415ce7bbafcfac28,29.9
0012a5c13793cf51e253f096a7e740dd,349.9
0013280441d86a4f7a8006efdaf1b0fe,149.9
0013cd8e350a7cc76873441e431dd5ee,79.9
001450ebb4a77efb3d68be5f7887cb1e,37.64
00146ad30454993879adaa91c518f68c,199.9
00155f0530cc7b2bf73cc3f81cb01c52,28.9
0015bc9fd2d5395446143e8b215d7c75,122.99
0015f7887e2fde13ddaa7b8e385af919,167.99
0017a0b4c1f1bdb9c395fa0ac517109c,34.9
0018c09f333634ca9c80d9ff46e43e9c,42.99
0018f7fde63ca77254dbc47f4ea358b2,37.9
0019c9aaad15b043c48f0a1180f22ce8,99.99
001a57041f56400917a187dd74e6cbc1,45.0
001b4e9b73aa98a6276b241bfd496822,75.0
001c7f05398c45b42eee0d5a77783bca,13.65
001df1ee5c36767aa607001ab1a13a06,29.99
001f150aebb5d897f2059b0460c38449,110.32
001f35d9f262c558fd065346fbf5801d,28.9
001f6f1a5e902ad14e1f709a7215de11,23.9
00205ad9ba1ef4340cef86583294cf82,899.9
002236c4f333bc8df6a5939749eb7869,59.9
002408f390f729598bbac1ef9421c6ae,195.9
002450e9ea44cb90b8a07ba0b197e149,24.9
002554bdf9eb99618d8189c3a89fdd52,229.0
0026955706fd4e2fa997f3f4c18d485a,99.9
002834b4d901534f48d9e9a72047b288,198.0
0028ff36263a86bf679df7c863a0a0ba,52.0
002905287304e28c0218389269b4759b,13.47
002937abdae13680e17dccd3868b4825,9.4
0029cdf064769cabdf3186b54d068c99,459.99
002a10e899b62a460b0116e0b68697ad,78.9
002b24cb2cd0c3e575040dbd278885e3,24.99
002c625393dfa194828b462a6ef8cb0b,311.25
002ce108ccf0356ef5c8b1dce3c0ae29,176.6
002d358e2462f87678443706cbf2eb21,29.5
002d597546b2cf44428232c9f237f873,99.0
002ebb669a34b9e79c88efc755e95322,110.0
002ef7e55600d44ead53f7c1644e5222,174.99
002f067b028a3643ad3a0969c7a0f3dc,79.9
002f90a6eb386bc43bc9ba200db31a89,119.80000000000001
002fb8fc5ce64f8422fa2fe79986c783,59.9
002ff70a5285669011090c077ef929af,62.9
00302a0b99783c3d1d1e81c616e321e8,129.0
0030aded3a67b29946a128ee8468388e,45.9
0030fbb95fbe7e61f798a80edb01a8e9,15.0
00314f95a054231742e3c5396b333b88,50.0
003177b3eeca50af17750f53802c9a09,110.32
0031abfb953b66e998f67b09e7b11375,637.9
0031c1062edf836ef7a7a7ea758b137b,69.9
00330644cccc5db0276fa836976306fe,37.5
00331de1659c7f4fb660c8810e6de3f5,207.0
0033823ee55671ac5317d423291333c2,61.8
0034f7933de3ead6bd9ba49afe95f119,65.9
003536ce5e18f1d12b9bf76932f8a6b1,43.99
0035b30e58c620fa2bd30275ddd4f7ef,59.9
0036875772a8eeb391b8cd7226283fdd,50.0
00380c010de38d578d02117f6d0b88e7,49.0
0039b3e41ac6615814a0b44a8992bff5,19.49
003a75d228dc67cb2918e40c2aacc4bf,59.8
003b595c764773e20e0949b6fba7b1dc,12.67
003bc8d06ebed9d146eb9f100d0a89ae,569.0
003bdf7fd8312f9d14a4b979f3747334,35.9
003c7cadba4f182b9f22d7d5ea7a5003,109.9
003cbe6a43560a8b6fd2c07531257c2d,13.65
003e45472805afa1ee701d83284fa22b,16.5
003eab528664e1bd677218ef4be086ac,62.9
003ec17a1389fa302f3a0423dddd8650,9.99
003f7d92ac63c512bb6584219806f8df,72.9
0040a8417928d0d5abd5169cd7877181,199.99
0040b00970e2139e8c43b647c0da5305,30.97
00411811e3b661e746a6e1ce1f0878ab,349.0
0041d7b768cb115092fa0f5d55638d06,63.0
00426311a53f3c052943c88b692a3be2,177.0
0042d04ee8231b36dcb29aac213f5db4,18.95
0043b0afd67fb3af74360d2893b9a530,99.99

2025-01-24 23:33:53 - root - INFO - SQL:
SELECT "customer_id", MAX("order_purchase_timestamp") AS "last_purchase_date"
   FROM "orders"
   WHERE "order_status" = 'delivered'
   GROUP BY "customer_id"
   LIMIT 100;
Results:
Too long, hard cut:
customer_id,last_purchase_date
00012a2ce6f8dcda20d059ce98491703,2017-11-14 16:08:26
000161a058600d5901f007fab4c27140,2017-07-16 09:40:32
0001fd6190edaaf884bcaf3d49edf079,2017-02-28 11:06:43
0002414f95344307404f0ace7a26f1d5,2017-08-16 13:09:20
000379cdec625522490c315e70c7a9fb,2018-04-02 13:42:17
0004164d20a9e969af783496f3408652,2017-04-12 08:35:12
000419c5494106c306a97b5635748086,2018-03-02 17:47:40
00046a560d407e99b969756e0b10f282,2017-12-18 11:08:30
00050bf6e01e69d5c0fd612f1bcfb69c,2017-09-17 16:04:44
000598caf2ef4117407665ac33275130,2018-08-11 12:14:35
0005aefbb696d34b3424dccd0a0e9fd0,2018-06-20 09:46:53
00062b33cb9f6fe976afdcff967ea74d,2017-03-15 23:44:09
00066ccbe787a588c52bd5ff404590e3,2018-02-06 16:10:09
00072d033fe2e59061ae5c3aff1a2be5,2017-09-01 09:24:39
0009a69b72033b2d0ec8c69fc70ef768,2017-04-28 13:36:30
000bf8121c3412d3057d32371c5d3395,2017-10-11 07:44:31
000e943451fc2788ca6ac98a682f2f49,2017-04-20 19:37:14
000f17e290c26b28549908a04cfe36c1,2017-11-10 16:37:05
000fd45d6fedae68fc6676036610f879,2018-04-15 15:55:01
0010068a73b7c56da5758c3f9e5c7375,2017-04-11 18:19:55
001028b78fd413e19704b3867c369d3a,2018-04-12 12:51:28
00104a47c29da701ce41ee52077587d9,2018-01-14 20:28:56
001051abfcfdbed9f87b4266213a5df1,2018-05-30 09:19:31
00114026c1b7b52ab1773f317ef4880b,2017-06-01 19:44:44
001226b2341ef620415ce7bbafcfac28,2017-09-29 01:15:08
0012a5c13793cf51e253f096a7e740dd,2018-03-05 14:54:23
0013280441d86a4f7a8006efdaf1b0fe,2018-01-08 02:35:36
0013cd8e350a7cc76873441e431dd5ee,2018-05-07 23:25:09
001450ebb4a77efb3d68be5f7887cb1e,2018-02-26 08:35:13
00146ad30454993879adaa91c518f68c,2018-01-08 20:40:57
00155f0530cc7b2bf73cc3f81cb01c52,2017-05-14 23:55:13
0015bc9fd2d5395446143e8b215d7c75,2018-06-11 19:48:34
0015f7887e2fde13ddaa7b8e385af919,2017-07-31 11:05:46
0017a0b4c1f1bdb9c395fa0ac517109c,2018-03-03 18:44:01
0018c09f333634ca9c80d9ff46e43e9c,2018-07-01 18:07:57
0018f7fde63ca77254dbc47f4ea358b2,2017-09-26 14:01:47
0019c9aaad15b043c48f0a1180f22ce8,2018-03-06 00:26:58
001a57041f56400917a187dd74e6cbc1,2018-01-17 21:22:51
001b4e9b73aa98a6276b241bfd496822,2018-04-07 02:12:51
001c7f05398c45b42eee0d5a77783bca,2018-04-12 13:41:07
001df1ee5c36767aa607001ab1a13a06,2018-08-05 23:14:45
001f150aebb5d897f2059b0460c38449,2018-05-09 12:06:04
001f35d9f262c558fd065346fbf5801d,2018-01-25 17:33:55
001f6f1a5e902ad14e1f709a7215de11,2017-02-07 20:32:13
00205ad9ba1ef4340cef86583294cf82,2018-05-12 17:51:47
002236c4f333bc8df6a5939749eb7869,2018-01-22 20:16:33
002408f390f729598bbac1ef9421c6ae,2018-01-10 17:01:34
002450e9ea44cb90b8a07ba0b197e149,2017-08-16 09:07:13
002554bdf9eb99618d8189c3a89fdd52,2018-08-13 17:59:25
0026955706fd4e2fa997f3f4c18d485a,2018-08-20 11:23:45
002834b4d901534f48d9e9a72047b288,2017-10-08 17:38:00
0028ff36263a86bf679df7c863a0a0ba,2018-04-12 17:16:49
002905287304e28c0218389269b4759b,2018-07-22 17:13:46
002937abdae13680e17dccd3868b4825,2017-11-24 20:26:39
0029cdf064769cabdf3186b54d068c99,2018-02-04 12:22:30
002a10e899b62a460b0116e0b68697ad,2018-05-05 18:33:24
002b24cb2cd0c3e575040dbd278885e3,2018-05-21 23:17:32
002c625393dfa194828b462a6ef8cb0b,2017-11-19 13:22:44
002ce108ccf0356ef5c8b1dce3c0ae29,2018-06-06 17:22:52
002d358e2462f87678443706cbf2eb21,2018-01-31 17:53:18
002d597546b2cf44428232c9f237f873,2018-07-22 09:29:19
002ebb669a34b9e79c88efc755e95322,2018-08-11 12:41:01
002ef7e55600d44ead53f7c1644e5222,2018-06-19 21:08:43
002f067b028a3643ad3a0969c7a0f3dc,2017-10-19 09:31:12
002f90a6eb386bc43bc9ba200db31a89,2017-06-15 23:59:20
002fb8fc5ce64f8422fa2fe79986c783,2017-11-26 23:15:12
002ff70a5285669011090c077ef929af,2018-08-05 13:19:28
00302a0b99783c3d1d1e81c616e321e8,2018-03-26 18:50:44
0030aded3a67b29946a128ee8468388e,2017-11-23 21:18:14
0030fbb95fbe7e61f798a80edb01a8e9,2017-11-09 23:28:29
00314f95a054231742e3c5396b333b88,2018-01-08 19:29:38
003177b3eeca50af17750f53802c9a09,2018-07-08 15:48:40
0031abfb953b66e998f67b09e7b11375,2018-01-23 13:57:55
0031c1062edf836ef7a7a7ea758b137b,2017-03-01 20:00:23
00330644cccc5db0276fa836976306fe,2017-10-30 17:48:07
00331de1659c7f4fb660c8810e6de3f5,2017-12-18 14:54:52
0033823ee55671ac5317d423291333c2,2017-05-29 19:02:27
0034f7933de3ead6bd9ba49afe95f119,2018-04-06 09:25:10
003536ce5e18f1d12b9bf76932f8a6b1,2017-10-16 19:17:54
0035b30e58c620fa2bd30275ddd4f7ef,2018-04-08 18:56:27
0036875772a8eeb391b8cd7226283fdd,2018-01-21 22:49:14
00380c010de38d578d02117f6d0b88e7,2018-02-28 11:10:46
0039b3e41ac6615814a0b44a8992bff5,2018-01-11 01:24:43
003a75d228dc67cb2918e40c2aacc4bf,2017-10-19 12:07:22
003b595c764773e20e0949b6fba7b1dc,2018-04-14 08:18:05
003bc8d06ebed9d146eb9f100d0a89ae,2018-03-07 15:08:14
003bdf7fd8312f9d14a4b979f3747334,2017-11-28 15:39:53
003c7cadba4f182b9f22d7d5ea7a5003,2018-04-19 11:58:57
003cbe6a43560a8b6fd2c07531257c2d,2018-02-01 14:05:22
003e45472805afa1ee701d83284fa22b,2017-06-11 20:50:58
003eab528664e1bd677218ef4be086ac,2017-04-03 19:20:39
003ec17a1389fa302f3a0423dddd8650,2018-01-14 17:25:31
003f7d92ac63c512bb6584219806f8df,2018-02-14 12:45:19
0040a8417928d0d5abd5169cd7877181,2018-06

2025-01-24 23:33:53 - root - INFO - SQL:
SELECT DISTINCT oi."product_id"
   FROM "order_items" oi
   JOIN "orders" o ON oi."order_id" = o."order_id"
   WHERE o."order_status" = 'delivered'
   LIMIT 100;
Results:
product_id
87285b34884572647811a353c7ac498a
595fac2a385ac33a80bd5114aec74eb8
aa4383b373c6aca5d8797843e5594415
d0b61bfb1de832b15ba9d266ca96e5b0
65266b2da20d04dbe00c5c2d3bb7859e
060cb19345d90064d1015407193c233d
4520766ec412348b8d4caa5e8a18c464
ac1789e492dcd698c5c10b97a671243a
9a78fb9862b10749a117f7fc3c31f051
08574b074924071f4e201e151b152b4e
f7e0fa615b386bc9a8b9eb52bc1fff76
72a97c271b2e429974398f46b93ae530
10adb53d8faa890ca7c2f0cbcb68d777
72d3bf1d3a790f8874096fcf860e3eff
009c09f439988bc06a93d6b8186dce73
638bbb2a5e4f360b71f332ddfebfd672
a47295965bd091207681b541b26e40a5
cce679660c66e6fbd5c8091dfd29e9cd
c35498fbb4358837ae16850f50c3fd22
5ac9d9e379c606e36a8094a6046f75dc
2b4609f8948be18874494203496bc318
6893767814d1ac82a81bcd365e1cc918
bb7181410b4e02f93f3697f765db53c7
e99d69efe684efaa643f99805f7c81bc
7b717060aa783eb7f23a747a3a733dd7
9451e630d725c4bb7a5a206b48b99486
d70f38e7f79c630f8ea00c993897042c
00baba5b58e274d0332a0c8a0a66f877
ba74c6b75d2ad7503175809688d5a03c
c0db539123a403f670c50237d970b215
cafd558df4c3c9d1c338ba6930ea9a62
2d8f2be4f08788ee3bf5356af2b2ee6c
6b64362e89896be7589621df54be089e
39a9942865c056ed2006a5e8c11d9537
c6c1f263e076bd9c1f1640250a5d0c29
bff2010b28e8fbcff5a9db9d3fea5ac4
9b37a918bcf2c8e1064e867cf1df4637
0cd9f302c8a5b076ffa5c3567c6705fd
c7df652246ed7b3300aaf46960c141e4
9a469eaf45dfbc43d39ba1977a3c07af
8c591ab0ca519558779df02023177f44
be021417a6acb56b9b50d3fd2714baa8
cd935d283d47f1050c505e1c39c48b67
f410090aec61f7c73748ca894286edcd
e251ebd2858be1aa7d9b2087a6992580
ba4bfbf74dbe7ab37e263b9326da0523
aca2eb7d00ea1a7b8ebd4e68314663af
1deda1acffb44ed38494667d7e49a9f3
f35927953ed82e19d06ad3aac2f06353
304fad8dc4d2012dc4062839972f2d96
1501b0033c68a37fa9560033a440e529
f48eb5c2fde13ca63664f0bb05f55346
60184212dae4e6b0da32bf54271a8c4a
9ecadb84c81da840dbf3564378b586e9
278b3c6462e86b4556b99989513ddf73
b37b72d5a56f887725c2862184b8cab8
ebd7c847c1e1cb69ec374ae0ebee1f4c
30469bb5ea377eae7121981e2f0778e4
15a9e834e89eab39d973492882c658d6
4ce99ff9dcb7821acd8e599d5d4a6531
12087840651e83b48206b82c213b76fd
89321f94e35fc6d7903d36f74e351d40
d1c427060a0f73f6b889a5c7c61f2ac4
db56f6d2b04c89eae4daba188842fd7b
d457916b4fdc60154ed93b5dd3e6fd69
3014e35fd70fce29095ced5cdc89f4ce
a659cb33082b851fb87a33af8f0fff29
7564c1759c04fc0a38f2aa84f7a370ee
163e6400e6dadd0fe04775c5e9331fda
e932008cf0ea7c93a077dd8d7e5f49eb
3dd6c9d499e7c311a29e08afe1fd8fc6
5e2ba75ad255ff60b1c76c5bf526ae9b
a5a0e71a81ae65aa335e71c06261e260
75d6b6963340c6063f7f4cfcccfe6a30
7f457254a89d62960399e075711b3deb
69d980b4120a76616d7b237d731d6156
c3ba4e8d3cb30049213b682e751e9d00
154e7e31ebfa092203795c972e5804a6
ad1128daf194f4b6ac4256e16233497c
f497ba62f1d6b4f6a3a3266fa8623ad3
b3be1f83cef05668c25e134852d44545
f7d7b5c58704fb359a74580622800051
90b58782fdd04cb829667fcc41fb65f5
c827fb43ad0fb8708f34c2911fdc164b
22f5b63060a1185e5ec7721efd622321
9d2ff462feaaf88912539b8647e17ab4
cf944645d4ff2a3eed3ae17f641ea861
64d0feb1bcf9c7fe7b5dad3271c10910
79da264732f717f10ebf5d102aa6c32a
7c1bd920dbdf22470b68bde975dd3ccf
5526b1ae9ab2688cf600783cece249df
7a10781637204d8d10485c71a6108a2e
20a8603c265d777e25da064113d556f5
a01d1cbb398e386a4a8f8364401a7584
43ee88561093499d9e571d4db5f20b79
f8a8f05a35976a91aed5cccc3992c357
c1234c80dafde7ef3311b3eabd5069ed
cac9e5692471a0700418aa3400b9b2b1
97f1396a5a1f7c07ba51784efdec44b8
f9a7825fa51f487b8a48f67e9efced8c

2025-01-24 23:33:54 - root - INFO - SQL:
SELECT o."customer_id", AVG(oi."price") AS "average_order_value"
   FROM "orders" o
   JOIN "order_items" oi ON o."order_id" = oi."order_id"
   WHERE o."order_status" = 'delivered'
   GROUP BY o."customer_id"
   LIMIT 100;
Results:
customer_id,average_order_value
00012a2ce6f8dcda20d059ce98491703,89.8
000161a058600d5901f007fab4c27140,54.9
0001fd6190edaaf884bcaf3d49edf079,179.99
0002414f95344307404f0ace7a26f1d5,149.9
000379cdec625522490c315e70c7a9fb,93.0
0004164d20a9e969af783496f3408652,59.99
000419c5494106c306a97b5635748086,34.3
00046a560d407e99b969756e0b10f282,120.9
00050bf6e01e69d5c0fd612f1bcfb69c,69.99
000598caf2ef4117407665ac33275130,1107.0
0005aefbb696d34b3424dccd0a0e9fd0,134.9
00062b33cb9f6fe976afdcff967ea74d,47.99
00066ccbe787a588c52bd5ff404590e3,49.9
00072d033fe2e59061ae5c3aff1a2be5,89.9
0009a69b72033b2d0ec8c69fc70ef768,159.9
000bf8121c3412d3057d32371c5d3395,15.0
000e943451fc2788ca6ac98a682f2f49,89.9
000f17e290c26b28549908a04cfe36c1,122.9
000fd45d6fedae68fc6676036610f879,53.99
0010068a73b7c56da5758c3f9e5c7375,29.99
001028b78fd413e19704b3867c369d3a,29.9
00104a47c29da701ce41ee52077587d9,83.99
001051abfcfdbed9f87b4266213a5df1,49.97
00114026c1b7b52ab1773f317ef4880b,49.9
001226b2341ef620415ce7bbafcfac28,29.9
0012a5c13793cf51e253f096a7e740dd,349.9
0013280441d86a4f7a8006efdaf1b0fe,149.9
0013cd8e350a7cc76873441e431dd5ee,79.9
001450ebb4a77efb3d68be5f7887cb1e,18.82
00146ad30454993879adaa91c518f68c,199.9
00155f0530cc7b2bf73cc3f81cb01c52,28.9
0015bc9fd2d5395446143e8b215d7c75,122.99
0015f7887e2fde13ddaa7b8e385af919,167.99
0017a0b4c1f1bdb9c395fa0ac517109c,34.9
0018c09f333634ca9c80d9ff46e43e9c,42.99
0018f7fde63ca77254dbc47f4ea358b2,37.9
0019c9aaad15b043c48f0a1180f22ce8,99.99
001a57041f56400917a187dd74e6cbc1,45.0
001b4e9b73aa98a6276b241bfd496822,75.0
001c7f05398c45b42eee0d5a77783bca,13.65
001df1ee5c36767aa607001ab1a13a06,29.99
001f150aebb5d897f2059b0460c38449,110.32
001f35d9f262c558fd065346fbf5801d,28.9
001f6f1a5e902ad14e1f709a7215de11,23.9
00205ad9ba1ef4340cef86583294cf82,899.9
002236c4f333bc8df6a5939749eb7869,59.9
002408f390f729598bbac1ef9421c6ae,195.9
002450e9ea44cb90b8a07ba0b197e149,24.9
002554bdf9eb99618d8189c3a89fdd52,229.0
0026955706fd4e2fa997f3f4c18d485a,99.9
002834b4d901534f48d9e9a72047b288,198.0
0028ff36263a86bf679df7c863a0a0ba,52.0
002905287304e28c0218389269b4759b,13.47
002937abdae13680e17dccd3868b4825,9.4
0029cdf064769cabdf3186b54d068c99,459.99
002a10e899b62a460b0116e0b68697ad,78.9
002b24cb2cd0c3e575040dbd278885e3,24.99
002c625393dfa194828b462a6ef8cb0b,311.25
002ce108ccf0356ef5c8b1dce3c0ae29,176.6
002d358e2462f87678443706cbf2eb21,29.5
002d597546b2cf44428232c9f237f873,99.0
002ebb669a34b9e79c88efc755e95322,110.0
002ef7e55600d44ead53f7c1644e5222,174.99
002f067b028a3643ad3a0969c7a0f3dc,79.9
002f90a6eb386bc43bc9ba200db31a89,59.900000000000006
002fb8fc5ce64f8422fa2fe79986c783,59.9
002ff70a5285669011090c077ef929af,62.9
00302a0b99783c3d1d1e81c616e321e8,129.0
0030aded3a67b29946a128ee8468388e,45.9
0030fbb95fbe7e61f798a80edb01a8e9,15.0
00314f95a054231742e3c5396b333b88,50.0
003177b3eeca50af17750f53802c9a09,110.32
0031abfb953b66e998f67b09e7b11375,318.95
0031c1062edf836ef7a7a7ea758b137b,69.9
00330644cccc5db0276fa836976306fe,37.5
00331de1659c7f4fb660c8810e6de3f5,69.0
0033823ee55671ac5317d423291333c2,61.8
0034f7933de3ead6bd9ba49afe95f119,65.9
003536ce5e18f1d12b9bf76932f8a6b1,43.99
0035b30e58c620fa2bd30275ddd4f7ef,59.9
0036875772a8eeb391b8cd7226283fdd,50.0
00380c010de38d578d02117f6d0b88e7,49.0
0039b3e41ac6615814a0b44a8992bff5,19.49
003a75d228dc67cb2918e40c2aacc4bf,29.9
003b595c764773e20e0949b6fba7b1dc,12.67
003bc8d06ebed9d146eb9f100d0a89ae,569.0
003bdf7fd8312f9d14a4b979f3747334,35.9
003c7cadba4f182b9f22d7d5ea7a5003,109.9
003cbe6a43560a8b6fd2c07531257c2d,13.65
003e45472805afa1ee701d83284fa22b,16.5
003eab528664e1bd677218ef4be086ac,62.9
003ec17a1389fa302f3a0423dddd8650,9.99
003f7d92ac63c512bb6584219806f8df,72.9
0040a8417928d0d5abd5169cd7877181,199.99
0040b00970e2139e8c43b647c0da5305,30.97
00411811e3b661e746a6e1ce1f0878ab,349.0
0041d7b768cb115092fa0f5d55638d06,63.0
00426311a53f3c052943c88b692a3be2,29.5
0042d04ee8231b36dcb29aac213f5db4,18.95
0043b0afd67fb3af74360d2893b9a530,99.99

2025-01-24 23:33:54 - root - INFO - SQL:
SELECT o."customer_id",
           COUNT(DISTINCT o."order_id") AS "frequency",
           MAX(o."order_purchase_timestamp") AS "recency",
           SUM(oi."price") AS "monetary_value"
    FROM "orders" o
    JOIN "order_items" oi ON o."order_id" = oi."order_id"
    WHERE o."order_status" = 'delivered'
    GROUP BY o."customer_id"
    LIMIT 100;
Results:
Too long, hard cut:
customer_id,frequency,recency,monetary_value
00012a2ce6f8dcda20d059ce98491703,1,2017-11-14 16:08:26,89.8
000161a058600d5901f007fab4c27140,1,2017-07-16 09:40:32,54.9
0001fd6190edaaf884bcaf3d49edf079,1,2017-02-28 11:06:43,179.99
0002414f95344307404f0ace7a26f1d5,1,2017-08-16 13:09:20,149.9
000379cdec625522490c315e70c7a9fb,1,2018-04-02 13:42:17,93.0
0004164d20a9e969af783496f3408652,1,2017-04-12 08:35:12,59.99
000419c5494106c306a97b5635748086,1,2018-03-02 17:47:40,34.3
00046a560d407e99b969756e0b10f282,1,2017-12-18 11:08:30,120.9
00050bf6e01e69d5c0fd612f1bcfb69c,1,2017-09-17 16:04:44,69.99
000598caf2ef4117407665ac33275130,1,2018-08-11 12:14:35,1107.0
0005aefbb696d34b3424dccd0a0e9fd0,1,2018-06-20 09:46:53,134.9
00062b33cb9f6fe976afdcff967ea74d,1,2017-03-15 23:44:09,47.99
00066ccbe787a588c52bd5ff404590e3,1,2018-02-06 16:10:09,199.6
00072d033fe2e59061ae5c3aff1a2be5,1,2017-09-01 09:24:39,89.9
0009a69b72033b2d0ec8c69fc70ef768,1,2017-04-28 13:36:30,159.9
000bf8121c3412d3057d32371c5d3395,1,2017-10-11 07:44:31,30.0
000e943451fc2788ca6ac98a682f2f49,1,2017-04-20 19:37:14,89.9
000f17e290c26b28549908a04cfe36c1,1,2017-11-10 16:37:05,122.9
000fd45d6fedae68fc6676036610f879,1,2018-04-15 15:55:01,53.99
0010068a73b7c56da5758c3f9e5c7375,1,2017-04-11 18:19:55,29.99
001028b78fd413e19704b3867c369d3a,1,2018-04-12 12:51:28,29.9
00104a47c29da701ce41ee52077587d9,1,2018-01-14 20:28:56,83.99
001051abfcfdbed9f87b4266213a5df1,1,2018-05-30 09:19:31,49.97
00114026c1b7b52ab1773f317ef4880b,1,2017-06-01 19:44:44,49.9
001226b2341ef620415ce7bbafcfac28,1,2017-09-29 01:15:08,29.9
0012a5c13793cf51e253f096a7e740dd,1,2018-03-05 14:54:23,349.9
0013280441d86a4f7a8006efdaf1b0fe,1,2018-01-08 02:35:36,149.9
0013cd8e350a7cc76873441e431dd5ee,1,2018-05-07 23:25:09,79.9
001450ebb4a77efb3d68be5f7887cb1e,1,2018-02-26 08:35:13,37.64
00146ad30454993879adaa91c518f68c,1,2018-01-08 20:40:57,199.9
00155f0530cc7b2bf73cc3f81cb01c52,1,2017-05-14 23:55:13,28.9
0015bc9fd2d5395446143e8b215d7c75,1,2018-06-11 19:48:34,122.99
0015f7887e2fde13ddaa7b8e385af919,1,2017-07-31 11:05:46,167.99
0017a0b4c1f1bdb9c395fa0ac517109c,1,2018-03-03 18:44:01,34.9
0018c09f333634ca9c80d9ff46e43e9c,1,2018-07-01 18:07:57,42.99
0018f7fde63ca77254dbc47f4ea358b2,1,2017-09-26 14:01:47,37.9
0019c9aaad15b043c48f0a1180f22ce8,1,2018-03-06 00:26:58,99.99
001a57041f56400917a187dd74e6cbc1,1,2018-01-17 21:22:51,45.0
001b4e9b73aa98a6276b241bfd496822,1,2018-04-07 02:12:51,75.0
001c7f05398c45b42eee0d5a77783bca,1,2018-04-12 13:41:07,13.65
001df1ee5c36767aa607001ab1a13a06,1,2018-08-05 23:14:45,29.99
001f150aebb5d897f2059b0460c38449,1,2018-05-09 12:06:04,110.32
001f35d9f262c558fd065346fbf5801d,1,2018-01-25 17:33:55,28.9
001f6f1a5e902ad14e1f709a7215de11,1,2017-02-07 20:32:13,23.9
00205ad9ba1ef4340cef86583294cf82,1,2018-05-12 17:51:47,899.9
002236c4f333bc8df6a5939749eb7869,1,2018-01-22 20:16:33,59.9
002408f390f729598bbac1ef9421c6ae,1,2018-01-10 17:01:34,195.9
002450e9ea44cb90b8a07ba0b197e149,1,2017-08-16 09:07:13,24.9
002554bdf9eb99618d8189c3a89fdd52,1,2018-08-13 17:59:25,229.0
0026955706fd4e2fa997f3f4c18d485a,1,2018-08-20 11:23:45,99.9
002834b4d901534f48d9e9a72047b288,1,2017-10-08 17:38:00,198.0
0028ff36263a86bf679df7c863a0a0ba,1,2018-04-12 17:16:49,52.0
002905287304e28c0218389269b4759b,1,2018-07-22 17:13:46,13.47
002937abdae13680e17dccd3868b4825,1,2017-11-24 20:26:39,9.4
0029cdf064769cabdf3186b54d068c99,1,2018-02-04 12:22:30,459.99
002a10e899b62a460b0116e0b68697ad,1,2018-05-05 18:33:24,78.9
002b24cb2cd0c3e575040dbd278885e3,1,2018-05-21 23:17:32,24.99
002c625393dfa194828b462a6ef8cb0b,1,2017-11-19 13:22:44,311.25
002ce108ccf0356ef5c8b1dce3c0ae29,1,2018-06-06 17:22:52,176.6
002d358e2462f87678443706cbf2eb21,1,2018-01-31 17:53:18,29.5
002d597546b2cf44428232c9f237f873,1,2018-07-22 09:29:19,99.0
002ebb669a34b9e79c88efc755e95322,1,2018-08-11 12:41:01,110.0
002ef7e55600d44ead53f7c1644e5222,1,2018-06-19 21:08:43,174.99
002f067b028a3643ad3a0969c7a0f3dc,1,2017-10-19 09:31:12,79.9
002f90a6eb386bc43bc9ba200db31a89,1,2017-06-15 23:59:20,119.80000000000001
002fb8fc5ce64f8422fa2fe79986c783,1,2017-11-26 23:15:12,59.9
002ff70a5285669011090c077ef929af,1,2018-08-05 13:19:28,62.9
00302a0b99783c3d1d1e81c616e321e8,1,2018-03-26 18:50:44,129.0
0030aded3a67b29946a128ee8468388e,1,2017-11-23 21:18:14,45.9
0030fbb95fbe7e61f798a80edb01a8e9,1,2017-11-09 23:28:29,15.0
00314f95a054231742e3c5396b333b88,1,2018-01-08 19:29:38,50.0
003177b3eeca50af17750f53802c9a09,1,2018-07-08 15:48:40,110.32
0031abfb953b66e998f67b09e7b11375,1,2018-01-23 13:57:55,637.9
0031c1062edf836ef7a7a7ea758b137b,1,2017-03-01 20:00:23,69.9
00330644cccc5db0276fa836976306fe,1,2017-10-30 17:48:07,37.5
00331de1659c7f4fb660c8810e6de3f5,1,2017-12-18 14:54:52,207.0
0033823ee55671ac5317d423291333c2,1,2017-05-29 19:02:27,61.8
0034f7933de3ead6bd9ba49afe95f119,1,2018-04-06 09:25:10,65.9
003536ce5e18f1d12b9bf76932f8a6b1,1,2017-10-16 19:17:54,43.99
0035b30e58c620fa2bd30275ddd4f7ef,1,2018-04-08 18:56:27,59.9
0036875772a8eeb391b8cd7226283fdd,1,2018-01-21 22:49:14,50.0
00380c010de38d578d02117f6d0b88e

2025-01-24 23:33:55 - root - INFO - SQL:
SELECT o."customer_id", SUM(oi."price") AS "total_spent"
    FROM "orders" o
    JOIN "order_items" oi ON o."order_id" = oi."order_id"
    WHERE o."order_status" = 'delivered'
    GROUP BY o."customer_id"
    ORDER BY "total_spent" DESC
    LIMIT 100;
Results:
customer_id,total_spent
1617b1357756262bfa56ab541c47bc16,13440.0
ec5b2ba62e574342386871631fafd3fc,7160.0
c6e2731c5b391845f6800c97401a43a9,6735.0
f48d464a0baaea338cb25f816991ab1f,6729.0
3fd6777bbce08a352fddd04e4a7cc8f6,6499.0
05455dfa7cd02f13d132aa7a6a9729c6,5934.6
df55c14d1476a9a3467f131269c2477f,4799.0
24bbf5fd2f2e1b359ee7de94defc4a15,4690.0
3d979689f636322c62418b6346b1c6d2,4590.0
cc803a2c412833101651d3f90ca7de24,4400.0
1afc82cd60e303ef09b4ef9837c9505c,4399.87
35a413c7ca3c69756cb75867d6311c0d,4099.99
e9b0d0eb3015ef1c9ce6cf5b9dcbee9f,4059.0
c6695e3b1e48680db36b487419fb0398,3999.9
926b6a6fb8b6081e00b335edaf578d35,3999.0
3be2c536886b2ea4668eced3a80dd0bb,3980.0
31e83c01fce824d0ff786fcd48dad009,3930.0
eb7a157e8da9c488cd4ddc48711f1097,3899.0
19b32919fa1198aefc0773ee2e46e693,3700.0
66657bf1753d82d0a76f2c4719ab8b85,3699.99
addc91fdf9c2b3045497b57fc710e820,3690.0
7d03bf20fa96e80468bbf678eebbcb3f,3597.0
39d6658037b1b5a07d0a24d423f0bd19,3549.0
e7c905bf4bb13543e8df947af4f3d9e9,3399.99
0b16ce67087d02bf833c807e82b1992b,3300.0
a7ea318cbe9df2ec79ab37cd7ca2135d,3198.0
46bb3c0b1a65c8399d0363cefbcc4f37,3124.0
26dcb450c4b5b390e79e6d5d0f2c6535,3109.99
7e7d2271d6f55b03b0bd4615c5f2de6e,3105.0
a95f4bbcf95262b073e4afa481b59ff8,3099.9
71901689c5f3e5adc27b1dd16b33f0b8,3099.75
803cd9b04f9cd252c6a83a2ecdbc22c3,3099.0
3c7c62e8d38fb18a33a45db8021f2d69,3089.0
10a86619816f9d2afce3f45b04aabc71,2999.99
0a209a88c2e3dc2981c79ad85c558059,2999.99
c03dfaf5db49d8583edbb5627f92058d,2999.9
fd78e5e3abdc375368456fe738694c00,2999.89
d7c94e22bfd332eb29b0f5badc3ce103,2999.89
8dd4c93bfbebe2a77657d46ef959a7ac,2999.89
4312e816d88fa8bdb6246878f61cdad5,2999.89
3a4e4932f3e6976dd966f1d3c044d49e,2999.89
101c8d91278c4de9001566d27033f673,2999.0
c26acf0451e0f8ec1f5218731b9a51cf,2990.0
9d4ba8752b5b737f45da0544b669552a,2951.0
6152fbfc8a92ee25fd821740bd33b089,2920.0
f7622098214b4634b7fe7eee269b5426,2919.4
a5c69c3bf293d341b6a56a4b7307c529,2899.0
a244afc7a1ec53f1aad296d1cd6e91ba,2899.0
f41666558f4e35056a445c27c2ac3d8b,2874.0
1ff773612ab8934db89fd5afa8afe506,2849.8999999999996
9f9717a71bd8f6e5600b4faad20c20fb,2799.65
1be0dd2f660a5a04ee20d608075f1b83,2799.0
97dd9c6923b3237b650f1f4f3f2145ad,2749.65
fced842c7dad61e8ce47b49229659718,2749.0
8e2c57611e09e143ec4ab76e38033bef,2740.0
5f87c05477db2d22c63b718299c9c03e,2700.0
08dc68ad9ab343289844fa36f6963b8f,2700.0
a8f345f82667eb421151dc7626147636,2699.0
55fd5d10a5036383fe19af015d2e5a80,2699.0
3f083b9f62e687be8d84684c7d54c8db,2690.0
19365ad6a18ccf1baf6eb71c30651096,2690.0
e5df9583ddbe3f4f3857d9b667dfa609,2689.0
2e0339ff984d6f41f11dfdbc7c93dcda,2680.0
8401401a8752eb431189e021b8009e37,2649.99
695476b5848d64ba0875324c88390206,2649.99
b1c28f9b72d07054b64d09e487b5021c,2649.0
b177ef267a4377b77e0620d1a7f08dce,2649.0
0c5292f5e3690805390efddf53935915,2600.0
e9859fbdff7d26c36c228cf60796e844,2589.0
349509b216bd5ec11c5fae929fd13595,2589.0
1fb8ff22dad231d26fc7ecde2e2dc27a,2550.0
53e644c7c57416bdaf0409e656ee8b0a,2547.0
7e95832184f874c220b8ebffa750837d,2520.0
1ca6f90a61cf75c002a0d690261a0e4c,2499.99
35698a7b9ae42369b9f45a53000f85f3,2498.0
9537f2addba8448428a3fd1a1add0656,2470.5
279ca766397588e704abddd56d2dc131,2470.5
9c5d7103954595e173781530b10d02e4,2433.6
68f692d1f39843a16d9319a7306b6b10,2428.0
cdecc5d1f7fc375b1138e8b5f496fd69,2400.0
b76816b61d8043a98db57875437da6b5,2400.0
cb3724d7cb7db46b65cfd1e7c16c0df5,2399.8
30ab7e538292e6130a456c371778d595,2399.0
233d97d412c7f4bb8d857ec922c0317f,2399.0
177ba55869da8001fcca079af0b85832,2399.0
b9da524b08224eaff1bf76ef4d4299ac,2370.0
548692bdcbd6e3683ff306ac9d8418d6,2350.0
f2c743697f9b2ff2902df23a16582d80,2338.08
f08306b95370e8d5f0d97b71229284b6,2338.08
3696afd6fae4a1f36fcbc3db8f3d6640,2338.08
f767e7437c3aa2c044523c0a6712380b,2300.0
e683dddabd8f5c3ad3708a3364e932f8,2300.0
6f18119032437dd6fa1c7df272d2d9e6,2299.99
9125dbd39c45287dfab9207f3cb15075,2299.95
9cf0a858f5f153406bc333860eb23e22,2299.0
df358a91acde222cf3330baac5cecfe7,2288.0
b18d47c9116d2a106291aea1abfd3f04,2258.0
6b66c3c14df21f07ea7f57fc8af6517f,2258.0
174156b68563868e1ed48408117d6df4,2249.0
d1447849bd806efd6282988355588728,2221.0

2025-01-24 23:33:55 - root - INFO - SQL:
SELECT AVG("order_count") AS "average_orders_per_customer"
    FROM (
      SELECT "customer_id", COUNT(DISTINCT "order_id") AS "order_count"
      FROM "orders"
      WHERE "order_status" = 'delivered'
      GROUP BY "customer_id"
    )
    LIMIT 100;
Results:
average_orders_per_customer
1.0

2025-01-24 23:34:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 23:34:37 - root - INFO - ```sql
SELECT AVG("order_count") AS "average_orders_per_customer"
FROM (
  SELECT "customer_id", COUNT(DISTINCT "order_id") AS "order_count"
  FROM "orders"
  WHERE "order_status" = 'delivered'
  GROUP BY "customer_id"
);
```
2025-01-24 23:35:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 23:35:08 - root - INFO - SQL:
SELECT AVG("order_count") AS "average_orders_per_customer"
FROM (
  SELECT "customer_id", COUNT(DISTINCT "order_id") AS "order_count"
  FROM "orders"
  WHERE "order_status" = 'delivered'
  GROUP BY "customer_id"
);
Results:
average_orders_per_customer
1.0

2025-01-24 23:35:08 - root - INFO - SQL:
SELECT "customer_id",
       MIN("order_purchase_timestamp") AS "first_purchase",
       MAX("order_purchase_timestamp") AS "last_purchase"
FROM "orders"
WHERE "order_status" = 'delivered'
GROUP BY "customer_id"
Results:
Too long, hard cut:
customer_id,first_purchase,last_purchase
00012a2ce6f8dcda20d059ce98491703,2017-11-14 16:08:26,2017-11-14 16:08:26
000161a058600d5901f007fab4c27140,2017-07-16 09:40:32,2017-07-16 09:40:32
0001fd6190edaaf884bcaf3d49edf079,2017-02-28 11:06:43,2017-02-28 11:06:43
0002414f95344307404f0ace7a26f1d5,2017-08-16 13:09:20,2017-08-16 13:09:20
000379cdec625522490c315e70c7a9fb,2018-04-02 13:42:17,2018-04-02 13:42:17
0004164d20a9e969af783496f3408652,2017-04-12 08:35:12,2017-04-12 08:35:12
000419c5494106c306a97b5635748086,2018-03-02 17:47:40,2018-03-02 17:47:40
00046a560d407e99b969756e0b10f282,2017-12-18 11:08:30,2017-12-18 11:08:30
00050bf6e01e69d5c0fd612f1bcfb69c,2017-09-17 16:04:44,2017-09-17 16:04:44
000598caf2ef4117407665ac33275130,2018-08-11 12:14:35,2018-08-11 12:14:35
0005aefbb696d34b3424dccd0a0e9fd0,2018-06-20 09:46:53,2018-06-20 09:46:53
00062b33cb9f6fe976afdcff967ea74d,2017-03-15 23:44:09,2017-03-15 23:44:09
00066ccbe787a588c52bd5ff404590e3,2018-02-06 16:10:09,2018-02-06 16:10:09
00072d033fe2e59061ae5c3aff1a2be5,2017-09-01 09:24:39,2017-09-01 09:24:39
0009a69b72033b2d0ec8c69fc70ef768,2017-04-28 13:36:30,2017-04-28 13:36:30
000bf8121c3412d3057d32371c5d3395,2017-10-11 07:44:31,2017-10-11 07:44:31
000e943451fc2788ca6ac98a682f2f49,2017-04-20 19:37:14,2017-04-20 19:37:14
000f17e290c26b28549908a04cfe36c1,2017-11-10 16:37:05,2017-11-10 16:37:05
000fd45d6fedae68fc6676036610f879,2018-04-15 15:55:01,2018-04-15 15:55:01
0010068a73b7c56da5758c3f9e5c7375,2017-04-11 18:19:55,2017-04-11 18:19:55
001028b78fd413e19704b3867c369d3a,2018-04-12 12:51:28,2018-04-12 12:51:28
00104a47c29da701ce41ee52077587d9,2018-01-14 20:28:56,2018-01-14 20:28:56
001051abfcfdbed9f87b4266213a5df1,2018-05-30 09:19:31,2018-05-30 09:19:31
00114026c1b7b52ab1773f317ef4880b,2017-06-01 19:44:44,2017-06-01 19:44:44
001226b2341ef620415ce7bbafcfac28,2017-09-29 01:15:08,2017-09-29 01:15:08
0012a5c13793cf51e253f096a7e740dd,2018-03-05 14:54:23,2018-03-05 14:54:23
0013280441d86a4f7a8006efdaf1b0fe,2018-01-08 02:35:36,2018-01-08 02:35:36
0013cd8e350a7cc76873441e431dd5ee,2018-05-07 23:25:09,2018-05-07 23:25:09
001450ebb4a77efb3d68be5f7887cb1e,2018-02-26 08:35:13,2018-02-26 08:35:13
00146ad30454993879adaa91c518f68c,2018-01-08 20:40:57,2018-01-08 20:40:57
00155f0530cc7b2bf73cc3f81cb01c52,2017-05-14 23:55:13,2017-05-14 23:55:13
0015bc9fd2d5395446143e8b215d7c75,2018-06-11 19:48:34,2018-06-11 19:48:34
0015f7887e2fde13ddaa7b8e385af919,2017-07-31 11:05:46,2017-07-31 11:05:46
0017a0b4c1f1bdb9c395fa0ac517109c,2018-03-03 18:44:01,2018-03-03 18:44:01
0018c09f333634ca9c80d9ff46e43e9c,2018-07-01 18:07:57,2018-07-01 18:07:57
0018f7fde63ca77254dbc47f4ea358b2,2017-09-26 14:01:47,2017-09-26 14:01:47
0019c9aaad15b043c48f0a1180f22ce8,2018-03-06 00:26:58,2018-03-06 00:26:58
001a57041f56400917a187dd74e6cbc1,2018-01-17 21:22:51,2018-01-17 21:22:51
001b4e9b73aa98a6276b241bfd496822,2018-04-07 02:12:51,2018-04-07 02:12:51
001c7f05398c45b42eee0d5a77783bca,2018-04-12 13:41:07,2018-04-12 13:41:07
001df1ee5c36767aa607001ab1a13a06,2018-08-05 23:14:45,2018-08-05 23:14:45
001f150aebb5d897f2059b0460c38449,2018-05-09 12:06:04,2018-05-09 12:06:04
001f35d9f262c558fd065346fbf5801d,2018-01-25 17:33:55,2018-01-25 17:33:55
001f6f1a5e902ad14e1f709a7215de11,2017-02-07 20:32:13,2017-02-07 20:32:13
00205ad9ba1ef4340cef86583294cf82,2018-05-12 17:51:47,2018-05-12 17:51:47
002236c4f333bc8df6a5939749eb7869,2018-01-22 20:16:33,2018-01-22 20:16:33
002408f390f729598bbac1ef9421c6ae,2018-01-10 17:01:34,2018-01-10 17:01:34
002450e9ea44cb90b8a07ba0b197e149,2017-08-16 09:07:13,2017-08-16 09:07:13
002554bdf9eb99618d8189c3a89fdd52,2018-08-13 17:59:25,2018-08-13 17:59:25
0026955706fd4e2fa997f3f4c18d485a,2018-08-20 11:23:45,2018-08-20 11:23:45
002834b4d901534f48d9e9a72047b288,2017-10-08 17:38:00,2017-10-08 17:38:00
0028ff36263a86bf679df7c863a0a0ba,2018-04-12 17:16:49,2018-04-12 17:16:49
002905287304e28c0218389269b4759b,2018-07-22 17:13:46,2018-07-22 17:13:46
002937abdae13680e17dccd3868b4825,2017-11-24 20:26:39,2017-11-24 20:26:39
0029cdf064769cabdf3186b54d068c99,2018-02-04 12:22:30,2018-02-04 12:22:30
002a10e899b62a460b0116e0b68697ad,2018-05-05 18:33:24,2018-05-05 18:33:24
002b24cb2cd0c3e575040dbd278885e3,2018-05-21 23:17:32,2018-05-21 23:17:32
002c625393dfa194828b462a6ef8cb0b,2017-11-19 13:22:44,2017-11-19 13:22:44
002ce108ccf0356ef5c8b1dce3c0ae29,2018-06-06 17:22:52,2018-06-06 17:22:52
002d358e2462f87678443706cbf2eb21,2018-01-31 17:53:18,2018-01-31 17:53:18
002d597546b2cf44428232c9f237f873,2018-07-22 09:29:19,2018-07-22 09:29:19
002ebb669a34b9e79c88efc755e95322,2018-08-11 12:41:01,2018-08-11 12:41:01
002ef7e55600d44ead53f7c1644e5222,2018-06-19 21:08:43,2018-06-19 21:08:43
002f067b028a3643ad3a0969c7a0f3dc,2017-10-19 09:31:12,2017-10-19 09:31:12
002f90a6eb386bc43bc9ba200db31a89,2017-06-15 23:59:20,2017-06-15 23:59:20
002fb8fc5ce64f8422fa2fe79986c783,2017-11-26 23:15:12,2017-11-26 23:15:12
002ff70a5285669011090c077ef929af,2018-08-05 13:19:28,2018-08-05 13:19:28
00302a0b99783c3d1d1e81c616e321e8,2018-03-26 18:50:44,2018-03-26 18:5

2025-01-24 23:35:09 - root - INFO - SQL:
SELECT o."customer_id", AVG(oi."price") AS "average_sales_per_order"
FROM "orders" o
JOIN "order_items" oi ON o."order_id" = oi."order_id"
WHERE o."order_status" = 'delivered'
GROUP BY o."customer_id"
Results:
Too long, hard cut:
customer_id,average_sales_per_order
00012a2ce6f8dcda20d059ce98491703,89.8
000161a058600d5901f007fab4c27140,54.9
0001fd6190edaaf884bcaf3d49edf079,179.99
0002414f95344307404f0ace7a26f1d5,149.9
000379cdec625522490c315e70c7a9fb,93.0
0004164d20a9e969af783496f3408652,59.99
000419c5494106c306a97b5635748086,34.3
00046a560d407e99b969756e0b10f282,120.9
00050bf6e01e69d5c0fd612f1bcfb69c,69.99
000598caf2ef4117407665ac33275130,1107.0
0005aefbb696d34b3424dccd0a0e9fd0,134.9
00062b33cb9f6fe976afdcff967ea74d,47.99
00066ccbe787a588c52bd5ff404590e3,49.9
00072d033fe2e59061ae5c3aff1a2be5,89.9
0009a69b72033b2d0ec8c69fc70ef768,159.9
000bf8121c3412d3057d32371c5d3395,15.0
000e943451fc2788ca6ac98a682f2f49,89.9
000f17e290c26b28549908a04cfe36c1,122.9
000fd45d6fedae68fc6676036610f879,53.99
0010068a73b7c56da5758c3f9e5c7375,29.99
001028b78fd413e19704b3867c369d3a,29.9
00104a47c29da701ce41ee52077587d9,83.99
001051abfcfdbed9f87b4266213a5df1,49.97
00114026c1b7b52ab1773f317ef4880b,49.9
001226b2341ef620415ce7bbafcfac28,29.9
0012a5c13793cf51e253f096a7e740dd,349.9
0013280441d86a4f7a8006efdaf1b0fe,149.9
0013cd8e350a7cc76873441e431dd5ee,79.9
001450ebb4a77efb3d68be5f7887cb1e,18.82
00146ad30454993879adaa91c518f68c,199.9
00155f0530cc7b2bf73cc3f81cb01c52,28.9
0015bc9fd2d5395446143e8b215d7c75,122.99
0015f7887e2fde13ddaa7b8e385af919,167.99
0017a0b4c1f1bdb9c395fa0ac517109c,34.9
0018c09f333634ca9c80d9ff46e43e9c,42.99
0018f7fde63ca77254dbc47f4ea358b2,37.9
0019c9aaad15b043c48f0a1180f22ce8,99.99
001a57041f56400917a187dd74e6cbc1,45.0
001b4e9b73aa98a6276b241bfd496822,75.0
001c7f05398c45b42eee0d5a77783bca,13.65
001df1ee5c36767aa607001ab1a13a06,29.99
001f150aebb5d897f2059b0460c38449,110.32
001f35d9f262c558fd065346fbf5801d,28.9
001f6f1a5e902ad14e1f709a7215de11,23.9
00205ad9ba1ef4340cef86583294cf82,899.9
002236c4f333bc8df6a5939749eb7869,59.9
002408f390f729598bbac1ef9421c6ae,195.9
002450e9ea44cb90b8a07ba0b197e149,24.9
002554bdf9eb99618d8189c3a89fdd52,229.0
0026955706fd4e2fa997f3f4c18d485a,99.9
002834b4d901534f48d9e9a72047b288,198.0
0028ff36263a86bf679df7c863a0a0ba,52.0
002905287304e28c0218389269b4759b,13.47
002937abdae13680e17dccd3868b4825,9.4
0029cdf064769cabdf3186b54d068c99,459.99
002a10e899b62a460b0116e0b68697ad,78.9
002b24cb2cd0c3e575040dbd278885e3,24.99
002c625393dfa194828b462a6ef8cb0b,311.25
002ce108ccf0356ef5c8b1dce3c0ae29,176.6
002d358e2462f87678443706cbf2eb21,29.5
002d597546b2cf44428232c9f237f873,99.0
002ebb669a34b9e79c88efc755e95322,110.0
002ef7e55600d44ead53f7c1644e5222,174.99
002f067b028a3643ad3a0969c7a0f3dc,79.9
002f90a6eb386bc43bc9ba200db31a89,59.900000000000006
002fb8fc5ce64f8422fa2fe79986c783,59.9
002ff70a5285669011090c077ef929af,62.9
00302a0b99783c3d1d1e81c616e321e8,129.0
0030aded3a67b29946a128ee8468388e,45.9
0030fbb95fbe7e61f798a80edb01a8e9,15.0
00314f95a054231742e3c5396b333b88,50.0
003177b3eeca50af17750f53802c9a09,110.32
0031abfb953b66e998f67b09e7b11375,318.95
0031c1062edf836ef7a7a7ea758b137b,69.9
00330644cccc5db0276fa836976306fe,37.5
00331de1659c7f4fb660c8810e6de3f5,69.0
0033823ee55671ac5317d423291333c2,61.8
0034f7933de3ead6bd9ba49afe95f119,65.9
003536ce5e18f1d12b9bf76932f8a6b1,43.99
0035b30e58c620fa2bd30275ddd4f7ef,59.9
0036875772a8eeb391b8cd7226283fdd,50.0
00380c010de38d578d02117f6d0b88e7,49.0
0039b3e41ac6615814a0b44a8992bff5,19.49
003a75d228dc67cb2918e40c2aacc4bf,29.9
003b595c764773e20e0949b6fba7b1dc,12.67
003bc8d06ebed9d146eb9f100d0a89ae,569.0
003bdf7fd8312f9d14a4b979f3747334,35.9
003c7cadba4f182b9f22d7d5ea7a5003,109.9
003cbe6a43560a8b6fd2c07531257c2d,13.65
003e45472805afa1ee701d83284fa22b,16.5
003eab528664e1bd677218ef4be086ac,62.9
003ec17a1389fa302f3a0423dddd8650,9.99
003f7d92ac63c512bb6584219806f8df,72.9
0040a8417928d0d5abd5169cd7877181,199.99
0040b00970e2139e8c43b647c0da5305,30.97
00411811e3b661e746a6e1ce1f0878ab,349.0
0041d7b768cb115092fa0f5d55638d06,63.0
00426311a53f3c052943c88b692a3be2,29.5
0042d04ee8231b36dcb29aac213f5db4,18.95
0043b0afd67fb3af74360d2893b9a530,99.99
004440537b68545ca3c341d7279bc4c0,39.99
00447b6bd39c4a0f6366b05948f9e2e3,279.9
00459c4eb23e40414ca067d06fa303d4,64.99
0045ac1c0957bc92e109f71e4941fa49,139.2
00474d2582fd72663036795b7ab8cfc1,39.9
004937d0f9d6ce15c2830c00c2f482e5,59.0
00498d14e21c58ed2feb5d5feb4cd706,89.0
0049e8442c2a3e4a8d1ff5a9549abd53,1200.0
004a2b3e8b026284407c620f4f01f686,138.0
004d41e9bf012c669db1a257888d85a2,280.0
004df18653e9438571e9d294776a5c5c,42.0
004ee20df425002ed78553e1f50caa3e,19.9
004f39eb181d53fa796fe82ce7a0cbd5,89.99
00502500a53243e07961383bf1a6fa82,55.9
005092c23e81812fbbe11fc6cf7e5316,29.9
0050b4dd994efa94b2cd3210e4cecf32,132.7
0050ee32fbb93383fb0d9e3d8ee89a07,99.0
0051337a96842850e1ec728dd158f4b3,219.99
005196c65bab2861e397cc85bc7664bf,1089.0
00520034b873d2cdfe098fd0a634d03d,149.9
0054556ea954a76ad6f9c4ba79d34a98,34.99
005460bea0518c7354f01adf10012184,59.9
0054f2f885ca69abcf4935c9506d7851,42.99
005596395ca3acd0433fe7d6f95a028e,15.9
0055e9b290953716739bd94a256a4144,42.5
0056a2580b5c68cfa6b43c6ef6adbc03,47.7
00573ea7a2ac9dff51ac3d177cd6eaea,29.9
0057f8b7c332d630b992d6a8ca79748c,109.9
0058153a

2025-01-24 23:35:09 - root - INFO - itercount: 0
2025-01-24 23:35:09 - root - INFO - Table: product_category_name_translationDDL:
CREATE TABLE "product_category_name_translation" (
"product_category_name" TEXT,
  "product_category_name_english" TEXT
)
Table: sellersDDL:
CREATE TABLE "sellers" (
"seller_id" TEXT,
  "seller_zip_code_prefix" INTEGER,
  "seller_city" TEXT,
  "seller_state" TEXT
)
Table: customersDDL:
CREATE TABLE "customers" (
"customer_id" TEXT,
  "customer_unique_id" TEXT,
  "customer_zip_code_prefix" INTEGER,
  "customer_city" TEXT,
  "customer_state" TEXT
)
Table: geolocationDDL:
CREATE TABLE "geolocation" (
"geolocation_zip_code_prefix" INTEGER,
  "geolocation_lat" REAL,
  "geolocation_lng" REAL,
  "geolocation_city" TEXT,
  "geolocation_state" TEXT
)
Table: order_itemsDDL:
CREATE TABLE "order_items" (
"order_id" TEXT,
  "order_item_id" INTEGER,
  "product_id" TEXT,
  "seller_id" TEXT,
  "shipping_limit_date" TEXT,
  "price" REAL,
  "freight_value" REAL
)
Table: order_paymentsDDL:
CREATE TABLE "order_payments" (
"order_id" TEXT,
  "payment_sequential" INTEGER,
  "payment_type" TEXT,
  "payment_installments" INTEGER,
  "payment_value" REAL
)
Table: order_reviewsDDL:
CREATE TABLE "order_reviews" (
"review_id" TEXT,
  "order_id" TEXT,
  "review_score" INTEGER,
  "review_comment_title" TEXT,
  "review_comment_message" TEXT,
  "review_creation_date" TEXT,
  "review_answer_timestamp" TEXT
)
Table: ordersDDL:
CREATE TABLE "orders" (
"order_id" TEXT,
  "customer_id" TEXT,
  "order_status" TEXT,
  "order_purchase_timestamp" TEXT,
  "order_approved_at" TEXT,
  "order_delivered_carrier_date" TEXT,
  "order_delivered_customer_date" TEXT,
  "order_estimated_delivery_date" TEXT
)
Table: productsDDL:
CREATE TABLE "products" (
"product_id" TEXT,
  "product_category_name" TEXT,
  "product_name_lenght" REAL,
  "product_description_lenght" REAL,
  "product_photos_qty" REAL,
  "product_weight_g" REAL,
  "product_length_cm" REAL,
  "product_height_cm" REAL,
  "product_width_cm" REAL
)
Table: leads_qualifiedDDL:
CREATE TABLE "leads_qualified" (
"mql_id" TEXT,
  "first_contact_date" TEXT,
  "landing_page_id" TEXT,
  "origin" TEXT
)
Table: leads_closedDDL:
CREATE TABLE "leads_closed" (
"mql_id" TEXT,
  "seller_id" TEXT,
  "sdr_id" TEXT,
  "sr_id" TEXT,
  "won_date" TEXT,
  "business_segment" TEXT,
  "lead_type" TEXT,
  "lead_behaviour_profile" TEXT,
  "has_company" INTEGER,
  "has_gtin" INTEGER,
  "average_stock" TEXT,
  "business_type" TEXT,
  "declared_product_catalog_size" REAL,
  "declared_monthly_revenue" REAL
)
External knowledge that might be helpful: 
None
The table structure information is (table names): 
['product_category_name_translation', 'sellers', 'customers', 'geolocation', 'order_items', 'order_payments', 'order_reviews', 'orders', 'products', 'leads_qualified', 'leads_closed']
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **"orders"**
  - `"order_id"`: Used to join with "order_items" and associate orders.
  - `"customer_id"`: To identify and group data by customer.
  - `"order_status"`: To filter orders that have been delivered (`"order_status" = 'delivered'`).
  - `"order_purchase_timestamp"`: For calculating Recency in RFM analysis.
  
- **"order_items"**
  - `"order_id"`: Used to join with "orders".
  - `"price"`: To calculate the monetary value of each order (Monetary in RFM).
  - `"order_item_id"`: To count the number of items per order if needed.
  
- **"customers"**
  - `"customer_id"`: To identify customers and link them with orders.

**Conditions that may be used:**

- Filter orders to include only those with `"order_status" = 'delivered'`.
- Use `"order_purchase_timestamp"` to calculate Recency.
- Group data by `"customer_id"` to calculate Frequency and Monetary values.

---

**SQLite SQL Queries:**

1. **Retrieve distinct order statuses to understand the different statuses available:**

   ```sql
   SELECT DISTINCT "order_status"
   FROM "orders"
   LIMIT 100;
   ```

2. **List the first 100 delivered orders with their purchase timestamps:**

   ```sql
   SELECT "order_id", "customer_id", "order_purchase_timestamp"
   FROM "orders"
   WHERE "order_status" = 'delivered'
   LIMIT 100;
   ```

3. **Get distinct customer IDs who have placed orders:**

   ```sql
   SELECT DISTINCT "customer_id"
   FROM "orders"
   LIMIT 100;
   ```

4. **Display the total price for each order:**

   ```sql
   SELECT "order_id", SUM("price") AS "total_order_price"
   FROM "order_items"
   GROUP BY "order_id"
   LIMIT 100;
   ```

5. **Find the number of orders each customer has placed (Frequency):**

   ```sql
   SELECT "customer_id", COUNT(DISTINCT "order_id") AS "order_count"
   FROM "orders"
   WHERE "order_status" = 'delivered'
   GROUP BY "customer_id"
   LIMIT 100;
   ```

6. **Calculate the total amount spent by each customer (Monetary):**

   ```sql
   SELECT o."customer_id", SUM(oi."price") AS "total_spent"
   FROM "orders" o
   JOIN "order_items" oi ON o."order_id" = oi."order_id"
   WHERE o."order_status" = 'delivered'
   GROUP BY o."customer_id"
   LIMIT 100;
   ```

7. **Determine the most recent purchase date for each customer (Recency):**

   ```sql
   SELECT "customer_id", MAX("order_purchase_timestamp") AS "last_purchase_date"
   FROM "orders"
   WHERE "order_status" = 'delivered'
   GROUP BY "customer_id"
   LIMIT 100;
   ```

8. **List distinct products purchased in delivered orders:**

   ```sql
   SELECT DISTINCT oi."product_id"
   FROM "order_items" oi
   JOIN "orders" o ON oi."order_id" = o."order_id"
   WHERE o."order_status" = 'delivered'
   LIMIT 100;
   ```

9. **Calculate the average order value for each customer:**

   ```sql
   SELECT o."customer_id", AVG(oi."price") AS "average_order_value"
   FROM "orders" o
   JOIN "order_items" oi ON o."order_id" = oi."order_id"
   WHERE o."order_status" = 'delivered'
   GROUP BY o."customer_id"
   LIMIT 100;
   ```

10. **Get the frequency, recency, and monetary values for each customer:**

    ```sql
    SELECT o."customer_id",
           COUNT(DISTINCT o."order_id") AS "frequency",
           MAX(o."order_purchase_timestamp") AS "recency",
           SUM(oi."price") AS "monetary_value"
    FROM "orders" o
    JOIN "order_items" oi ON o."order_id" = oi."order_id"
    WHERE o."order_status" = 'delivered'
    GROUP BY o."customer_id"
    LIMIT 100;
    ```

11. **List the top 100 customers by total amount spent:**

    ```sql
    SELECT o."customer_id", SUM(oi."price") AS "total_spent"
    FROM "orders" o
    JOIN "order_items" oi ON o."order_id" = oi."order_id"
    WHERE o."order_status" = 'delivered'
    GROUP BY o."customer_id"
    ORDER BY "total_spent" DESC
    LIMIT 100;
    ```

12. **Find the average number of orders per customer:**

    ```sql
    SELECT AVG("order_count") AS "average_orders_per_customer"
    FROM (
      SELECT "customer_id", COUNT(DISTINCT "order_id") AS "order_count"
      FROM "orders"
      WHERE "order_status" = 'delivered'
      GROUP BY "customer_id"
    )
    LIMIT 100;
    ```

13. **Identify customers with more than one delivered order:**

    ```sql
    SELECT "customer_id", COUNT(DISTINCT "order_id") AS "order_count"
    FROM "orders"
    WHERE "order_status" = 'delivered'
    GROUP BY "customer_id"
    HAVING "order_count" > 1
    LIMIT 100;
    ```

14. **Retrieve the time between the first and last purchase for each customer:**

    ```sql
    SELECT "customer_id",
           MIN("order_purchase_timestamp") AS "first_purchase",
           MAX("order_purchase_timestamp") AS "last_purchase"
    FROM "orders"
    WHERE "order_status" = 'delivered'
    GROUP BY "customer_id"
    LIMIT 100;
    ```

15. **Compute the average sales per order for each customer:**

    ```sql
    SELECT o."customer_id", AVG(oi."price") AS "average_sales_per_order"
    FROM "orders" o
    JOIN "order_items" oi ON o."order_id" = oi."order_id"
    WHERE o."order_status" = 'delivered'
    GROUP BY o."customer_id"
    LIMIT 100;
    ```

These queries explore various aspects of the data, such as order status, purchase amounts, customer purchasing behavior, and key metrics needed for RFM segmentation. By examining the outputs of these queries, we can gain insights into how to segment customers based on their Recency, Frequency, and Monetary values and calculate the average sales per order within these segments.Query:
SELECT DISTINCT "order_status"
   FROM "orders"
   LIMIT 100;
Answer:
order_status
delivered
invoiced
shipped
processing
unavailable
canceled
created
approved
Query:
SELECT "order_id", "customer_id", "order_purchase_timestamp"
   FROM "orders"
   WHERE "order_status" = 'delivered'
   LIMIT 100;
Answer:
Too long, hard cut:
order_id,customer_id,order_purchase_timestamp
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,2017-10-02 10:56:33
53cdb2fc8bc7dce0b6741e2150273451,b0830fb4747a6c6d20dea0b8c802d7ef,2018-07-24 20:41:37
47770eb9100c2d0c44946d9cf07ec65d,41ce2a54c0b03bf3443c3d931a367089,2018-08-08 08:38:49
949d5b44dbf5de918fe9c16f97b45f8a,f88197465ea7920adcdbec7375364d82,2017-11-18 19:28:06
ad21c59c0840e6cb83a9ceb5573f8159,8ab97904e6daea8866dbdbc4fb7aad2c,2018-02-13 21:18:39
a4591c265e18cb1dcee52889e2d8acc3,503740e9ca751ccdda7ba28e9ab8f608,2017-07-09 21:57:05
6514b8ad8028c9f2cc2374ded245783f,9bdf08b4b3b52b5526ff42d37d47f222,2017-05-16 13:10:30
76c6e866289321a7c93b82b54852dc33,f54a9f0e6b351c431402b8461ea51999,2017-01-23 18:29:09
e69bfb5eb88e0ed6a785585b27e16dbf,31ad1d1b63eb9962463f764d4e6e0c9d,2017-07-29 11:55:02
e6ce16cb79ec1d90b1da9085a6118aeb,494dded5b201313c64ed7f100595b95c,2017-05-16 19:41:10
34513ce0c4fab462a55830c0989c7edb,7711cf624183d843aafe81855097bc37,2017-07-13 19:58:11
82566a660a982b15fb86e904c8d32918,d3e3b74c766bc6214e0c830b17ee2341,2018-06-07 10:06:19
5ff96c15d0b717ac6ad1f3d77225a350,19402a48fe860416adf93348aba37740,2018-07-25 17:44:10
432aaf21d85167c2c86ec9448c4e42cc,3df704f53d3f1d4818840b34ec672a9f,2018-03-01 14:14:28
dcb36b511fcac050b97cd5c05de84dc3,3b6828a50ffe546942b7a473d70ac0fc,2018-06-07 19:03:12
403b97836b0c04a622354cf531062e5f,738b086814c6fcc74b8cc583f8516ee3,2018-01-02 19:00:43
116f0b09343b49556bbad5f35bee0cdf,3187789bec990987628d7a9beb4dd6ac,2017-12-26 23:41:31
85ce859fd6dc634de8d2f1e290444043,059f7fc5719c7da6cbafe370971a8d70,2017-11-21 00:03:41
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,2017-10-26 15:54:26
203096f03d82e0dffbc41ebc2e2bcfb7,d2b091571da224a1b36412c18bc3bbfe,2017-09-18 14:31:30
f848643eec1d69395095eb3840d2051e,4fa1cd166fa598be6de80fa84eaade43,2018-03-15 08:52:40
2807d0e504d6d4894d41672727bc139f,72ae281627a6102d9b3718528b420f8a,2018-02-03 20:37:35
95266dbfb7e20354baba07964dac78d5,a166da34890074091a942054b36e4265,2018-01-08 07:55:29
f3e7c359154d965827355f39d6b1fdac,62b423aab58096ca514ba6aa06be2f98,2018-08-09 11:44:40
fbf9ac61453ac646ce8ad9783d7d0af6,3a874b4d4c4b6543206ff5d89287f0c3,2018-02-20 23:46:53
acce194856392f074dbf9dada14d8d82,7e20bf5ca92da68200643bda76c504c6,2018-06-04 00:00:13
dd78f560c270f1909639c11b925620ea,8b212b9525f9e74e85e37ed6df37693e,2018-03-12 01:50:26
91b2a010e1e45e6ba3d133fa997597be,cce89a605105b148387c52e286ac8335,2018-05-02 11:45:38
ecab90c9933c58908d3d6add7c6f5ae3,761df82feda9778854c6dafdaeb567e4,2018-02-25 13:50:30
f70a0aff17df5a6cdd9a7196128bd354,456dc10730fbdba34615447ea195d643,2017-08-10 11:58:33
1790eea0b567cf50911c057cf20f90f9,52142aa69d8d0e1247ab0cada0f76023,2018-04-16 21:15:39
989225ba6d0ebd5873335f7e01de2ae7,816f8653d5361cbf94e58c33f2502a5c,2017-12-12 13:56:04
d887b52c6516beb39e8cd44a5f8b60f7,d9ef95f98d8da3b492bb8c0447910498,2018-02-03 12:38:58
b276e4f8c0fb86bd82fce576f21713e0,cf8ffeddf027932e51e4eae73b384059,2018-07-29 23:34:51
8563039e855156e48fccee4d611a3196,5f16605299d698660e0606f7eae2d2f9,2018-02-17 15:59:46
60550084e6b4c0cb89a87df1f3e5ebd9,f5458ddc3545711efa883dd7ae7c4497,2018-02-21 18:15:12
5acce57f8d9dfd55fa48e212a641a69d,295ae9b35379e077273387ff64354b6f,2017-07-31 21:37:10
434d158e96bdd6972ad6e6d73ddcfd22,2a1dfb647f32f4390e7b857c67458536,2018-06-01 12:23:13
7206b86ea789983f7a273ea7fa0bc2a8,3391c4bc11a817e7973e498b0b023158,2018-03-26 17:12:18
1e7aff52cdbb2451ace09d0f848c3699,ddaff536587109b89777e0353215e150,2017-05-19 18:53:40
6ea2f835b4556291ffdc53fa0b3b95e8,c7340080e394356141681bd4c9b8fe31,2017-11-24 21:27:48
948097deef559c742e7ce321e5e58919,8644be24d48806bc3a88fd59fb47ceb1,2017-08-04 17:10:39
d22e9fa5731b9e30e8b27afcdc2f8563,756fb9391752dad934e0fe3733378e57,2018-08-04 23:25:30
6ebaec694d7025e2ad4a05dba887c032,4f28355e5c17a4a42d3ce2439a1d4501,2017-05-18 13:55:47
d17dc4a904426827ca80f2ccb3a6be56,569cf68214806a39acc0f39344aea67f,2017-05-14 20:28:25
25f4376934e13d3508486352e11a5db0,12fd2740039676063a874b9567dfa651,2018-05-17 16:59:11
5820a1100976432c7968a52da59e9364,2b56e94c2f66f2d97cfa63356f69cee8,2018-07-29 11:24:17
2ce1ad82022c1ba30c2079502ac725aa,7f2178c5d771e17f507d3c1637339298,2017-08-09 20:19:05
138849fd84dff2fb4ca70a0a34c4aa1c,9b18f3fc296990b97854e351334a32f6,2018-02-01 14:02:19
47aa4816b27ba60ec948cd019cc1afc1,148348ff65384b4249b762579532e248,2018-06-26 13:42:52
9faeb9b2746b9d7526aef5acb08e2aa0,79183cd650e2bb0d475b0067d45946ac,2018-07-26 14:39:59
641fb0752bf5b5940c376b3a8bb9dc52,f5afca14dfa9dc64251cf2b45c54c363,2017-12-15 00:06:10
e425680f760cbc130be3e53a9773c584,f178c1827f67a8467b0385b7378d951a,2017-08-31 08:15:24
40c5e18f7d112b59b3e5113a59a905b3,67407057a7d5ee17d1cd09523f484d13,2018-06-11 10:25:52
734e7d1bbaeb2ff82521ca0fe6fb6f79,2932d241d1f31e6df6c701d52370ae02,2018-06-11 08:18:19
66e4624ae69e7dc89bd50222b59f581f,684fa6da5134b9e4dab731e00011712d,2018-03-09 14:50:15
a685d016c8a26f71a0bb67821070e398,911e4c37f5cafe1604fe6767034bf1ae,2017-03-13 18:14:36
2edfd6d1f0b4cd0db4bf37b1b224d855,241e78de29b3090cfa1
Query:
SELECT DISTINCT "customer_id"
   FROM "orders"
   LIMIT 100;
Answer:
customer_id
9ef432eb6251297304e76186b10a928d
b0830fb4747a6c6d20dea0b8c802d7ef
41ce2a54c0b03bf3443c3d931a367089
f88197465ea7920adcdbec7375364d82
8ab97904e6daea8866dbdbc4fb7aad2c
503740e9ca751ccdda7ba28e9ab8f608
ed0271e0b7da060a393796590e7b737a
9bdf08b4b3b52b5526ff42d37d47f222
f54a9f0e6b351c431402b8461ea51999
31ad1d1b63eb9962463f764d4e6e0c9d
494dded5b201313c64ed7f100595b95c
7711cf624183d843aafe81855097bc37
d3e3b74c766bc6214e0c830b17ee2341
19402a48fe860416adf93348aba37740
3df704f53d3f1d4818840b34ec672a9f
3b6828a50ffe546942b7a473d70ac0fc
738b086814c6fcc74b8cc583f8516ee3
3187789bec990987628d7a9beb4dd6ac
059f7fc5719c7da6cbafe370971a8d70
7f8c8b9c2ae27bf3300f670c3d478be8
d2b091571da224a1b36412c18bc3bbfe
4fa1cd166fa598be6de80fa84eaade43
72ae281627a6102d9b3718528b420f8a
a166da34890074091a942054b36e4265
62b423aab58096ca514ba6aa06be2f98
3a874b4d4c4b6543206ff5d89287f0c3
7e20bf5ca92da68200643bda76c504c6
8b212b9525f9e74e85e37ed6df37693e
cce89a605105b148387c52e286ac8335
761df82feda9778854c6dafdaeb567e4
456dc10730fbdba34615447ea195d643
52142aa69d8d0e1247ab0cada0f76023
816f8653d5361cbf94e58c33f2502a5c
d9ef95f98d8da3b492bb8c0447910498
cf8ffeddf027932e51e4eae73b384059
5f16605299d698660e0606f7eae2d2f9
f5458ddc3545711efa883dd7ae7c4497
295ae9b35379e077273387ff64354b6f
2a1dfb647f32f4390e7b857c67458536
3391c4bc11a817e7973e498b0b023158
ddaff536587109b89777e0353215e150
c7340080e394356141681bd4c9b8fe31
8644be24d48806bc3a88fd59fb47ceb1
756fb9391752dad934e0fe3733378e57
caded193e8e47b8362864762a83db3c5
4f28355e5c17a4a42d3ce2439a1d4501
569cf68214806a39acc0f39344aea67f
12fd2740039676063a874b9567dfa651
2b56e94c2f66f2d97cfa63356f69cee8
7f2178c5d771e17f507d3c1637339298
9b18f3fc296990b97854e351334a32f6
148348ff65384b4249b762579532e248
79183cd650e2bb0d475b0067d45946ac
f5afca14dfa9dc64251cf2b45c54c363
f178c1827f67a8467b0385b7378d951a
67407057a7d5ee17d1cd09523f484d13
2932d241d1f31e6df6c701d52370ae02
684fa6da5134b9e4dab731e00011712d
911e4c37f5cafe1604fe6767034bf1ae
241e78de29b3090cfa1b5d73a8130c72
4632eb5a8f175f6fe020520ae0c678f3
dd5095632e3953fc0947b8ab5176b0be
9916715c2ab6ee1710c9c32f0a534ad2
c77ee2d8ba1614a4d489a44166894938
81e08b08e5ed4472008030d70327c71f
5dda11942d4f77bee3a46d71e442aec4
74805bc388861fa350ed2fade8444e0b
4afc1dcca5fe8926fc97d60a4497f8ab
be8c14c16a4d47194ccdfe10f1fc5b1a
a9d37ddc8ba4d9f6dbac7d8ec378cc95
bb2f5e670f7155dc622c57e4b31d0a69
55e6b290205c84ddd23ddf5eb134efd4
f5618502bee8eafdee72fb6955e2ebdf
a90391a47de936d56c66a5366cba1462
388025bec8128ff20ec1a316ed4dcf02
afb19a4b667cb708caab312757ec3d3f
636e15840ab051faa13d3f781b6e4233
05e996469a2bf9559c7122b87e156724
5bb39c890c91b1d26801aa19a9336eac
f26a435864aebedff7f7c84f82ee229f
29cb486c739f9774c8eb542e07b56cd2
bf141bf67fbe428d558bcf0e018eab60
b673f0597cb0c4d12778f731045f361a
6772a0a230a2667d16c3620f000e1348
9f6618c17568ac301465fe7ad056c674
fee181bf648906d1c57f84f216976286
df9b032b2ad0fd6bf37dfb48e5f83845
93ada7a24817edda9f4ab998fa823d16
64fb950e760ec8b0db79154a1fa9c1bf
48558a50a7ba1aab61891936d2ca7681
3a897024068ed42a183de61d5727d866
8628fac2267e8c8804525da99c10ed0e
332df68ccac2f2f7d9e11299188f8bce
e28dd4261bed9c7ba89ecaf411b88f7c
82f0b75bb50fcb30711e5277e36b3983
3135962ee745ef39b85576df7ddbaa99
1833a0540067becaf59368fe4cd4303a
68451b39b1314302c08c65a29f1140fc
0bf19317b1830a69e55b40710576aa7a
c622b892a190735ef81c0087973fa16d
Query:
SELECT "order_id", SUM("price") AS "total_order_price"
   FROM "order_items"
   GROUP BY "order_id"
   LIMIT 100;
Answer:
order_id,total_order_price
00010242fe8c5a6d1ba2dd792cb16214,58.9
00018f77f2f0320c557190d7a144bdd3,239.9
000229ec398224ef6ca0657da4fc703e,199.0
00024acbcdf0a6daa1e931b038114c75,12.99
00042b26cf59d7ce69dfabb4e55b4fd9,199.9
00048cc3ae777c65dbb7d2a0634bc1ea,21.9
00054e8431b9d7675808bcb819fb4a32,19.9
000576fe39319847cbb9d288c5617fa6,810.0
0005a1a1728c9d785b8e2b08b904576c,145.95
0005f50442cb953dcd1d21e1fb923495,53.99
00061f2a7bc09da83e415a52dc8a4af1,59.99
00063b381e2406b52ad429470734ebd5,45.0
0006ec9db01a64e59a68b2c340bf65a7,74.0
0008288aa423d2a3f00fcb17cd7d8719,99.8
0009792311464db532ff765bf7b182ae,99.9
0009c9a17f916a706d71784483a5d643,639.0
000aed2e25dbad2f9ddb70584c5a2ded,144.0
000c3e6612759851cc3cbb4b83257986,99.0
000e562887b1f2006d75e0be9558292e,25.0
000e63d38ae8c00bbcb5a30573b99628,47.9
000e906b789b55f64edcb1f84030f90d,21.99
000f25f4d72195062c040b12dce9a18a,119.99
001021efaa8636c29475e7734483457d,49.0
0010b2e5201cc5f1ae7e9c6cc8f5bd00,48.9
00119ff934e539cf26f92b9ef0cdfed8,219.9
0011d82c4b53e22e84023405fb467e57,289.0
00125cb692d04887809806618a2a145f,109.9
00130c0eee84a3d909e75bc08c5c3ca1,27.9
0013503b13da1eac686219390b7d641b,119.9
00137e170939bba5a3134e2386413108,397.0
001427c0ec99cf8af737bd88e92fd444,59.9
00143d0f86d6fbd9f9b38ab440ac16f5,63.989999999999995
0014ae671de39511f7575066200733b7,16.5
0015ebb40fb17286bea51d4607c4733c,21.9
00169e31ef4b29deaae414f9a5e95929,39.0
0016dfedd97fc2950e388d2971d718c7,49.75
0017afd5076e074a48f1f1a4c7bac9c5,809.1
001862358bf858722e1e2ae000cfed8b,99.99
0019c29108428acffd089c36103c9440,59.9
001ab0a7578dd66cd4b0a71f5b6e1e41,74.67
001ac194d4a326a6fa99b581e9a3d963,54.0
001b76dd48a5b1eee3e87778daa40df8,81.99
001c85b5f68d2be0cb0797afc9e8ce9a,99.0
001d8f0e34a38c37f7dba2a37d4eba8b,37.98
001daeb0eddc45b999bad0801ad9d273,38.33
001dbc16dc51075e987543d23a0507c7,69.9
001e7ba991be1b19605ca0316e7130f9,195.0
001e7cf2ad6bef3ade12ebc56ceaf0f3,35.9
0020262c8a370bd5a174ea6a2a267321,79.5
0020a222f55eb79a372d0efee3cca688,29.99
002175704e8b209f61b9ad5cfd92b60e,109.9
00229e4e43f7a7e0b9dd819ad43268d3,74.9
0025081dcf9330f9a5052ae82c6ce396,14.95
00254baeb6c932b0a8aeead91fbd02b5,149.9
00259a44fcad3fc0474329e925d14fc3,19.99
0025c5d1a8ca53a240ec2634bb4492ea,390.0
002611a77fe03d076285fd4ca95db77c,135.0
002691433f09002ac9ca0c4e8dbb8ead,104.0
0026a368634b6e6f34f33b1499773a30,149.0
00275bce676303c3bfd7292aefdfa223,279.9
00276d5c3491fbf55305e26891040df9,44.9
002834535f7a609a5c68266f173fa59e,37.99
0028de0ca693a1bb26448916a81105cc,29.99
002955b0acc63d04f6724a31967e82bd,120.0
0029c5db35ef291ce99d1262012e7daa,492.75
0029f17cf0e7640c5cb6825af681303f,94.9
002af7fa9eb99d1456bceb6a13d6fc0b,88.34
002b430ff89b3a24c31a1170acbbedea,199.99
002b4e6fa42cd4a22cc86abc18fe9c05,99.9
002c9def9c9b951b1bec6d50753c9891,156.0
002d040018d12a3853c059f7f23ab5b1,155.0
002f16b7bc4530031b7d90f791b12d8a,249.9
002f19a65a2ddd70a090297872e6d64e,53.98
002f98c0f7efd42638ed6100ca699b42,53.89
0030d783f979fbc5981e75613b057344,60.6
0030ff924c38549807645976adeef2c0,225.0
00310b0c75bb13015ec4d82d341865a4,39.9
00324b3eda39ba5ecce3945823e3594c,76.0
0032d07457ae9c806c79368d7d9ce96b,159.0
003324c70b19a16798817b2b3640e721,205.8
00335b686d693c7d72deeb12f8e89227,63.9
00335f75ea6a4455b524a8dd177067f5,168.8
00337fe25a3780b3424d9ad7c5a4b35e,119.8
003423b755b562962a6225a8de40d12e,232.75
00345f338696283410b7977d2e3efc89,48.9
0035246a40f520710769010f752e7507,87.0
0035c0b07126fe9c24a325216fb96064,131.9
0035e6b7ade84b3f5b86bd49814793df,19.9
0036757472ece3dde52fd4bfd929c90e,136.99
0036887767dea4bd43b1a88cd0d9477a,399.99
00378c6c981f234634c0b9d6128df6dd,41.0
003822434f91204da0a51fe4cf2aba18,138.0
0039500db36d50d7d0bfaf23723550f3,169.9
003a7f59d7e08a9c61d9e2881fe6459c,119.0
003a94f778ef8cfd50247c8c1b582257,39.9
003cc6161d7a2593f2525cce0c330d32,85.0
003d0634280ff3d1d3a54459349a6899,220.0
003d804eef0e1b856881cd18e0cc0d4c,277.0
003d9fc84ad902adf2265248b5ffe1a4,66.99
003edccf16bc5ec447f592913b3df2b4,14.0
Query:
SELECT "customer_id", COUNT(DISTINCT "order_id") AS "order_count"
   FROM "orders"
   WHERE "order_status" = 'delivered'
   GROUP BY "customer_id"
   LIMIT 100;
Answer:
customer_id,order_count
00012a2ce6f8dcda20d059ce98491703,1
000161a058600d5901f007fab4c27140,1
0001fd6190edaaf884bcaf3d49edf079,1
0002414f95344307404f0ace7a26f1d5,1
000379cdec625522490c315e70c7a9fb,1
0004164d20a9e969af783496f3408652,1
000419c5494106c306a97b5635748086,1
00046a560d407e99b969756e0b10f282,1
00050bf6e01e69d5c0fd612f1bcfb69c,1
000598caf2ef4117407665ac33275130,1
0005aefbb696d34b3424dccd0a0e9fd0,1
00062b33cb9f6fe976afdcff967ea74d,1
00066ccbe787a588c52bd5ff404590e3,1
00072d033fe2e59061ae5c3aff1a2be5,1
0009a69b72033b2d0ec8c69fc70ef768,1
000bf8121c3412d3057d32371c5d3395,1
000e943451fc2788ca6ac98a682f2f49,1
000f17e290c26b28549908a04cfe36c1,1
000fd45d6fedae68fc6676036610f879,1
0010068a73b7c56da5758c3f9e5c7375,1
001028b78fd413e19704b3867c369d3a,1
00104a47c29da701ce41ee52077587d9,1
001051abfcfdbed9f87b4266213a5df1,1
00114026c1b7b52ab1773f317ef4880b,1
001226b2341ef620415ce7bbafcfac28,1
0012a5c13793cf51e253f096a7e740dd,1
0013280441d86a4f7a8006efdaf1b0fe,1
0013cd8e350a7cc76873441e431dd5ee,1
001450ebb4a77efb3d68be5f7887cb1e,1
00146ad30454993879adaa91c518f68c,1
00155f0530cc7b2bf73cc3f81cb01c52,1
0015bc9fd2d5395446143e8b215d7c75,1
0015f7887e2fde13ddaa7b8e385af919,1
0017a0b4c1f1bdb9c395fa0ac517109c,1
0018c09f333634ca9c80d9ff46e43e9c,1
0018f7fde63ca77254dbc47f4ea358b2,1
0019c9aaad15b043c48f0a1180f22ce8,1
001a57041f56400917a187dd74e6cbc1,1
001b4e9b73aa98a6276b241bfd496822,1
001c7f05398c45b42eee0d5a77783bca,1
001df1ee5c36767aa607001ab1a13a06,1
001f150aebb5d897f2059b0460c38449,1
001f35d9f262c558fd065346fbf5801d,1
001f6f1a5e902ad14e1f709a7215de11,1
00205ad9ba1ef4340cef86583294cf82,1
002236c4f333bc8df6a5939749eb7869,1
002408f390f729598bbac1ef9421c6ae,1
002450e9ea44cb90b8a07ba0b197e149,1
002554bdf9eb99618d8189c3a89fdd52,1
0026955706fd4e2fa997f3f4c18d485a,1
002834b4d901534f48d9e9a72047b288,1
0028ff36263a86bf679df7c863a0a0ba,1
002905287304e28c0218389269b4759b,1
002937abdae13680e17dccd3868b4825,1
0029cdf064769cabdf3186b54d068c99,1
002a10e899b62a460b0116e0b68697ad,1
002b24cb2cd0c3e575040dbd278885e3,1
002c625393dfa194828b462a6ef8cb0b,1
002ce108ccf0356ef5c8b1dce3c0ae29,1
002d358e2462f87678443706cbf2eb21,1
002d597546b2cf44428232c9f237f873,1
002ebb669a34b9e79c88efc755e95322,1
002ef7e55600d44ead53f7c1644e5222,1
002f067b028a3643ad3a0969c7a0f3dc,1
002f90a6eb386bc43bc9ba200db31a89,1
002fb8fc5ce64f8422fa2fe79986c783,1
002ff70a5285669011090c077ef929af,1
00302a0b99783c3d1d1e81c616e321e8,1
0030aded3a67b29946a128ee8468388e,1
0030fbb95fbe7e61f798a80edb01a8e9,1
00314f95a054231742e3c5396b333b88,1
003177b3eeca50af17750f53802c9a09,1
0031abfb953b66e998f67b09e7b11375,1
0031c1062edf836ef7a7a7ea758b137b,1
00330644cccc5db0276fa836976306fe,1
00331de1659c7f4fb660c8810e6de3f5,1
0033823ee55671ac5317d423291333c2,1
0034f7933de3ead6bd9ba49afe95f119,1
003536ce5e18f1d12b9bf76932f8a6b1,1
0035b30e58c620fa2bd30275ddd4f7ef,1
0036875772a8eeb391b8cd7226283fdd,1
00380c010de38d578d02117f6d0b88e7,1
0039b3e41ac6615814a0b44a8992bff5,1
003a75d228dc67cb2918e40c2aacc4bf,1
003b595c764773e20e0949b6fba7b1dc,1
003bc8d06ebed9d146eb9f100d0a89ae,1
003bdf7fd8312f9d14a4b979f3747334,1
003c7cadba4f182b9f22d7d5ea7a5003,1
003cbe6a43560a8b6fd2c07531257c2d,1
003e45472805afa1ee701d83284fa22b,1
003eab528664e1bd677218ef4be086ac,1
003ec17a1389fa302f3a0423dddd8650,1
003f7d92ac63c512bb6584219806f8df,1
0040a8417928d0d5abd5169cd7877181,1
0040b00970e2139e8c43b647c0da5305,1
00411811e3b661e746a6e1ce1f0878ab,1
0041d7b768cb115092fa0f5d55638d06,1
00426311a53f3c052943c88b692a3be2,1
0042d04ee8231b36dcb29aac213f5db4,1
0043b0afd67fb3af74360d2893b9a530,1
Query:
SELECT o."customer_id", SUM(oi."price") AS "total_spent"
   FROM "orders" o
   JOIN "order_items" oi ON o."order_id" = oi."order_id"
   WHERE o."order_status" = 'delivered'
   GROUP BY o."customer_id"
   LIMIT 100;
Answer:
customer_id,total_spent
00012a2ce6f8dcda20d059ce98491703,89.8
000161a058600d5901f007fab4c27140,54.9
0001fd6190edaaf884bcaf3d49edf079,179.99
0002414f95344307404f0ace7a26f1d5,149.9
000379cdec625522490c315e70c7a9fb,93.0
0004164d20a9e969af783496f3408652,59.99
000419c5494106c306a97b5635748086,34.3
00046a560d407e99b969756e0b10f282,120.9
00050bf6e01e69d5c0fd612f1bcfb69c,69.99
000598caf2ef4117407665ac33275130,1107.0
0005aefbb696d34b3424dccd0a0e9fd0,134.9
00062b33cb9f6fe976afdcff967ea74d,47.99
00066ccbe787a588c52bd5ff404590e3,199.6
00072d033fe2e59061ae5c3aff1a2be5,89.9
0009a69b72033b2d0ec8c69fc70ef768,159.9
000bf8121c3412d3057d32371c5d3395,30.0
000e943451fc2788ca6ac98a682f2f49,89.9
000f17e290c26b28549908a04cfe36c1,122.9
000fd45d6fedae68fc6676036610f879,53.99
0010068a73b7c56da5758c3f9e5c7375,29.99
001028b78fd413e19704b3867c369d3a,29.9
00104a47c29da701ce41ee52077587d9,83.99
001051abfcfdbed9f87b4266213a5df1,49.97
00114026c1b7b52ab1773f317ef4880b,49.9
001226b2341ef620415ce7bbafcfac28,29.9
0012a5c13793cf51e253f096a7e740dd,349.9
0013280441d86a4f7a8006efdaf1b0fe,149.9
0013cd8e350a7cc76873441e431dd5ee,79.9
001450ebb4a77efb3d68be5f7887cb1e,37.64
00146ad30454993879adaa91c518f68c,199.9
00155f0530cc7b2bf73cc3f81cb01c52,28.9
0015bc9fd2d5395446143e8b215d7c75,122.99
0015f7887e2fde13ddaa7b8e385af919,167.99
0017a0b4c1f1bdb9c395fa0ac517109c,34.9
0018c09f333634ca9c80d9ff46e43e9c,42.99
0018f7fde63ca77254dbc47f4ea358b2,37.9
0019c9aaad15b043c48f0a1180f22ce8,99.99
001a57041f56400917a187dd74e6cbc1,45.0
001b4e9b73aa98a6276b241bfd496822,75.0
001c7f05398c45b42eee0d5a77783bca,13.65
001df1ee5c36767aa607001ab1a13a06,29.99
001f150aebb5d897f2059b0460c38449,110.32
001f35d9f262c558fd065346fbf5801d,28.9
001f6f1a5e902ad14e1f709a7215de11,23.9
00205ad9ba1ef4340cef86583294cf82,899.9
002236c4f333bc8df6a5939749eb7869,59.9
002408f390f729598bbac1ef9421c6ae,195.9
002450e9ea44cb90b8a07ba0b197e149,24.9
002554bdf9eb99618d8189c3a89fdd52,229.0
0026955706fd4e2fa997f3f4c18d485a,99.9
002834b4d901534f48d9e9a72047b288,198.0
0028ff36263a86bf679df7c863a0a0ba,52.0
002905287304e28c0218389269b4759b,13.47
002937abdae13680e17dccd3868b4825,9.4
0029cdf064769cabdf3186b54d068c99,459.99
002a10e899b62a460b0116e0b68697ad,78.9
002b24cb2cd0c3e575040dbd278885e3,24.99
002c625393dfa194828b462a6ef8cb0b,311.25
002ce108ccf0356ef5c8b1dce3c0ae29,176.6
002d358e2462f87678443706cbf2eb21,29.5
002d597546b2cf44428232c9f237f873,99.0
002ebb669a34b9e79c88efc755e95322,110.0
002ef7e55600d44ead53f7c1644e5222,174.99
002f067b028a3643ad3a0969c7a0f3dc,79.9
002f90a6eb386bc43bc9ba200db31a89,119.80000000000001
002fb8fc5ce64f8422fa2fe79986c783,59.9
002ff70a5285669011090c077ef929af,62.9
00302a0b99783c3d1d1e81c616e321e8,129.0
0030aded3a67b29946a128ee8468388e,45.9
0030fbb95fbe7e61f798a80edb01a8e9,15.0
00314f95a054231742e3c5396b333b88,50.0
003177b3eeca50af17750f53802c9a09,110.32
0031abfb953b66e998f67b09e7b11375,637.9
0031c1062edf836ef7a7a7ea758b137b,69.9
00330644cccc5db0276fa836976306fe,37.5
00331de1659c7f4fb660c8810e6de3f5,207.0
0033823ee55671ac5317d423291333c2,61.8
0034f7933de3ead6bd9ba49afe95f119,65.9
003536ce5e18f1d12b9bf76932f8a6b1,43.99
0035b30e58c620fa2bd30275ddd4f7ef,59.9
0036875772a8eeb391b8cd7226283fdd,50.0
00380c010de38d578d02117f6d0b88e7,49.0
0039b3e41ac6615814a0b44a8992bff5,19.49
003a75d228dc67cb2918e40c2aacc4bf,59.8
003b595c764773e20e0949b6fba7b1dc,12.67
003bc8d06ebed9d146eb9f100d0a89ae,569.0
003bdf7fd8312f9d14a4b979f3747334,35.9
003c7cadba4f182b9f22d7d5ea7a5003,109.9
003cbe6a43560a8b6fd2c07531257c2d,13.65
003e45472805afa1ee701d83284fa22b,16.5
003eab528664e1bd677218ef4be086ac,62.9
003ec17a1389fa302f3a0423dddd8650,9.99
003f7d92ac63c512bb6584219806f8df,72.9
0040a8417928d0d5abd5169cd7877181,199.99
0040b00970e2139e8c43b647c0da5305,30.97
00411811e3b661e746a6e1ce1f0878ab,349.0
0041d7b768cb115092fa0f5d55638d06,63.0
00426311a53f3c052943c88b692a3be2,177.0
0042d04ee8231b36dcb29aac213f5db4,18.95
0043b0afd67fb3af74360d2893b9a530,99.99
Query:
SELECT "customer_id", MAX("order_purchase_timestamp") AS "last_purchase_date"
   FROM "orders"
   WHERE "order_status" = 'delivered'
   GROUP BY "customer_id"
   LIMIT 100;
Answer:
Too long, hard cut:
customer_id,last_purchase_date
00012a2ce6f8dcda20d059ce98491703,2017-11-14 16:08:26
000161a058600d5901f007fab4c27140,2017-07-16 09:40:32
0001fd6190edaaf884bcaf3d49edf079,2017-02-28 11:06:43
0002414f95344307404f0ace7a26f1d5,2017-08-16 13:09:20
000379cdec625522490c315e70c7a9fb,2018-04-02 13:42:17
0004164d20a9e969af783496f3408652,2017-04-12 08:35:12
000419c5494106c306a97b5635748086,2018-03-02 17:47:40
00046a560d407e99b969756e0b10f282,2017-12-18 11:08:30
00050bf6e01e69d5c0fd612f1bcfb69c,2017-09-17 16:04:44
000598caf2ef4117407665ac33275130,2018-08-11 12:14:35
0005aefbb696d34b3424dccd0a0e9fd0,2018-06-20 09:46:53
00062b33cb9f6fe976afdcff967ea74d,2017-03-15 23:44:09
00066ccbe787a588c52bd5ff404590e3,2018-02-06 16:10:09
00072d033fe2e59061ae5c3aff1a2be5,2017-09-01 09:24:39
0009a69b72033b2d0ec8c69fc70ef768,2017-04-28 13:36:30
000bf8121c3412d3057d32371c5d3395,2017-10-11 07:44:31
000e943451fc2788ca6ac98a682f2f49,2017-04-20 19:37:14
000f17e290c26b28549908a04cfe36c1,2017-11-10 16:37:05
000fd45d6fedae68fc6676036610f879,2018-04-15 15:55:01
0010068a73b7c56da5758c3f9e5c7375,2017-04-11 18:19:55
001028b78fd413e19704b3867c369d3a,2018-04-12 12:51:28
00104a47c29da701ce41ee52077587d9,2018-01-14 20:28:56
001051abfcfdbed9f87b4266213a5df1,2018-05-30 09:19:31
00114026c1b7b52ab1773f317ef4880b,2017-06-01 19:44:44
001226b2341ef620415ce7bbafcfac28,2017-09-29 01:15:08
0012a5c13793cf51e253f096a7e740dd,2018-03-05 14:54:23
0013280441d86a4f7a8006efdaf1b0fe,2018-01-08 02:35:36
0013cd8e350a7cc76873441e431dd5ee,2018-05-07 23:25:09
001450ebb4a77efb3d68be5f7887cb1e,2018-02-26 08:35:13
00146ad30454993879adaa91c518f68c,2018-01-08 20:40:57
00155f0530cc7b2bf73cc3f81cb01c52,2017-05-14 23:55:13
0015bc9fd2d5395446143e8b215d7c75,2018-06-11 19:48:34
0015f7887e2fde13ddaa7b8e385af919,2017-07-31 11:05:46
0017a0b4c1f1bdb9c395fa0ac517109c,2018-03-03 18:44:01
0018c09f333634ca9c80d9ff46e43e9c,2018-07-01 18:07:57
0018f7fde63ca77254dbc47f4ea358b2,2017-09-26 14:01:47
0019c9aaad15b043c48f0a1180f22ce8,2018-03-06 00:26:58
001a57041f56400917a187dd74e6cbc1,2018-01-17 21:22:51
001b4e9b73aa98a6276b241bfd496822,2018-04-07 02:12:51
001c7f05398c45b42eee0d5a77783bca,2018-04-12 13:41:07
001df1ee5c36767aa607001ab1a13a06,2018-08-05 23:14:45
001f150aebb5d897f2059b0460c38449,2018-05-09 12:06:04
001f35d9f262c558fd065346fbf5801d,2018-01-25 17:33:55
001f6f1a5e902ad14e1f709a7215de11,2017-02-07 20:32:13
00205ad9ba1ef4340cef86583294cf82,2018-05-12 17:51:47
002236c4f333bc8df6a5939749eb7869,2018-01-22 20:16:33
002408f390f729598bbac1ef9421c6ae,2018-01-10 17:01:34
002450e9ea44cb90b8a07ba0b197e149,2017-08-16 09:07:13
002554bdf9eb99618d8189c3a89fdd52,2018-08-13 17:59:25
0026955706fd4e2fa997f3f4c18d485a,2018-08-20 11:23:45
002834b4d901534f48d9e9a72047b288,2017-10-08 17:38:00
0028ff36263a86bf679df7c863a0a0ba,2018-04-12 17:16:49
002905287304e28c0218389269b4759b,2018-07-22 17:13:46
002937abdae13680e17dccd3868b4825,2017-11-24 20:26:39
0029cdf064769cabdf3186b54d068c99,2018-02-04 12:22:30
002a10e899b62a460b0116e0b68697ad,2018-05-05 18:33:24
002b24cb2cd0c3e575040dbd278885e3,2018-05-21 23:17:32
002c625393dfa194828b462a6ef8cb0b,2017-11-19 13:22:44
002ce108ccf0356ef5c8b1dce3c0ae29,2018-06-06 17:22:52
002d358e2462f87678443706cbf2eb21,2018-01-31 17:53:18
002d597546b2cf44428232c9f237f873,2018-07-22 09:29:19
002ebb669a34b9e79c88efc755e95322,2018-08-11 12:41:01
002ef7e55600d44ead53f7c1644e5222,2018-06-19 21:08:43
002f067b028a3643ad3a0969c7a0f3dc,2017-10-19 09:31:12
002f90a6eb386bc43bc9ba200db31a89,2017-06-15 23:59:20
002fb8fc5ce64f8422fa2fe79986c783,2017-11-26 23:15:12
002ff70a5285669011090c077ef929af,2018-08-05 13:19:28
00302a0b99783c3d1d1e81c616e321e8,2018-03-26 18:50:44
0030aded3a67b29946a128ee8468388e,2017-11-23 21:18:14
0030fbb95fbe7e61f798a80edb01a8e9,2017-11-09 23:28:29
00314f95a054231742e3c5396b333b88,2018-01-08 19:29:38
003177b3eeca50af17750f53802c9a09,2018-07-08 15:48:40
0031abfb953b66e998f67b09e7b11375,2018-01-23 13:57:55
0031c1062edf836ef7a7a7ea758b137b,2017-03-01 20:00:23
00330644cccc5db0276fa836976306fe,2017-10-30 17:48:07
00331de1659c7f4fb660c8810e6de3f5,2017-12-18 14:54:52
0033823ee55671ac5317d423291333c2,2017-05-29 19:02:27
0034f7933de3ead6bd9ba49afe95f119,2018-04-06 09:25:10
003536ce5e18f1d12b9bf76932f8a6b1,2017-10-16 19:17:54
0035b30e58c620fa2bd30275ddd4f7ef,2018-04-08 18:56:27
0036875772a8eeb391b8cd7226283fdd,2018-01-21 22:49:14
00380c010de38d578d02117f6d0b88e7,2018-02-28 11:10:46
0039b3e41ac6615814a0b44a8992bff5,2018-01-11 01:24:43
003a75d228dc67cb2918e40c2aacc4bf,2017-10-19 12:07:22
003b595c764773e20e0949b6fba7b1dc,2018-04-14 08:18:05
003bc8d06ebed9d146eb9f100d0a89ae,2018-03-07 15:08:14
003bdf7fd8312f9d14a4b979f3747334,2017-11-28 15:39:53
003c7cadba4f182b9f22d7d5ea7a5003,2018-04-19 11:58:57
003cbe6a43560a8b6fd2c07531257c2d,2018-02-01 14:05:22
003e45472805afa1ee701d83284fa22b,2017-06-11 20:50:58
003eab528664e1bd677218ef4be086ac,2017-04-03 19:20:39
003ec17a1389fa302f3a0423dddd8650,2018-01-14 17:25:31
003f7d92ac63c512bb6584219806f8df,2018-02-14 12:45:19
0040a8417928d0d5abd5169cd7877181,2018-06
Query:
SELECT DISTINCT oi."product_id"
   FROM "order_items" oi
   JOIN "orders" o ON oi."order_id" = o."order_id"
   WHERE o."order_status" = 'delivered'
   LIMIT 100;
Answer:
product_id
87285b34884572647811a353c7ac498a
595fac2a385ac33a80bd5114aec74eb8
aa4383b373c6aca5d8797843e5594415
d0b61bfb1de832b15ba9d266ca96e5b0
65266b2da20d04dbe00c5c2d3bb7859e
060cb19345d90064d1015407193c233d
4520766ec412348b8d4caa5e8a18c464
ac1789e492dcd698c5c10b97a671243a
9a78fb9862b10749a117f7fc3c31f051
08574b074924071f4e201e151b152b4e
f7e0fa615b386bc9a8b9eb52bc1fff76
72a97c271b2e429974398f46b93ae530
10adb53d8faa890ca7c2f0cbcb68d777
72d3bf1d3a790f8874096fcf860e3eff
009c09f439988bc06a93d6b8186dce73
638bbb2a5e4f360b71f332ddfebfd672
a47295965bd091207681b541b26e40a5
cce679660c66e6fbd5c8091dfd29e9cd
c35498fbb4358837ae16850f50c3fd22
5ac9d9e379c606e36a8094a6046f75dc
2b4609f8948be18874494203496bc318
6893767814d1ac82a81bcd365e1cc918
bb7181410b4e02f93f3697f765db53c7
e99d69efe684efaa643f99805f7c81bc
7b717060aa783eb7f23a747a3a733dd7
9451e630d725c4bb7a5a206b48b99486
d70f38e7f79c630f8ea00c993897042c
00baba5b58e274d0332a0c8a0a66f877
ba74c6b75d2ad7503175809688d5a03c
c0db539123a403f670c50237d970b215
cafd558df4c3c9d1c338ba6930ea9a62
2d8f2be4f08788ee3bf5356af2b2ee6c
6b64362e89896be7589621df54be089e
39a9942865c056ed2006a5e8c11d9537
c6c1f263e076bd9c1f1640250a5d0c29
bff2010b28e8fbcff5a9db9d3fea5ac4
9b37a918bcf2c8e1064e867cf1df4637
0cd9f302c8a5b076ffa5c3567c6705fd
c7df652246ed7b3300aaf46960c141e4
9a469eaf45dfbc43d39ba1977a3c07af
8c591ab0ca519558779df02023177f44
be021417a6acb56b9b50d3fd2714baa8
cd935d283d47f1050c505e1c39c48b67
f410090aec61f7c73748ca894286edcd
e251ebd2858be1aa7d9b2087a6992580
ba4bfbf74dbe7ab37e263b9326da0523
aca2eb7d00ea1a7b8ebd4e68314663af
1deda1acffb44ed38494667d7e49a9f3
f35927953ed82e19d06ad3aac2f06353
304fad8dc4d2012dc4062839972f2d96
1501b0033c68a37fa9560033a440e529
f48eb5c2fde13ca63664f0bb05f55346
60184212dae4e6b0da32bf54271a8c4a
9ecadb84c81da840dbf3564378b586e9
278b3c6462e86b4556b99989513ddf73
b37b72d5a56f887725c2862184b8cab8
ebd7c847c1e1cb69ec374ae0ebee1f4c
30469bb5ea377eae7121981e2f0778e4
15a9e834e89eab39d973492882c658d6
4ce99ff9dcb7821acd8e599d5d4a6531
12087840651e83b48206b82c213b76fd
89321f94e35fc6d7903d36f74e351d40
d1c427060a0f73f6b889a5c7c61f2ac4
db56f6d2b04c89eae4daba188842fd7b
d457916b4fdc60154ed93b5dd3e6fd69
3014e35fd70fce29095ced5cdc89f4ce
a659cb33082b851fb87a33af8f0fff29
7564c1759c04fc0a38f2aa84f7a370ee
163e6400e6dadd0fe04775c5e9331fda
e932008cf0ea7c93a077dd8d7e5f49eb
3dd6c9d499e7c311a29e08afe1fd8fc6
5e2ba75ad255ff60b1c76c5bf526ae9b
a5a0e71a81ae65aa335e71c06261e260
75d6b6963340c6063f7f4cfcccfe6a30
7f457254a89d62960399e075711b3deb
69d980b4120a76616d7b237d731d6156
c3ba4e8d3cb30049213b682e751e9d00
154e7e31ebfa092203795c972e5804a6
ad1128daf194f4b6ac4256e16233497c
f497ba62f1d6b4f6a3a3266fa8623ad3
b3be1f83cef05668c25e134852d44545
f7d7b5c58704fb359a74580622800051
90b58782fdd04cb829667fcc41fb65f5
c827fb43ad0fb8708f34c2911fdc164b
22f5b63060a1185e5ec7721efd622321
9d2ff462feaaf88912539b8647e17ab4
cf944645d4ff2a3eed3ae17f641ea861
64d0feb1bcf9c7fe7b5dad3271c10910
79da264732f717f10ebf5d102aa6c32a
7c1bd920dbdf22470b68bde975dd3ccf
5526b1ae9ab2688cf600783cece249df
7a10781637204d8d10485c71a6108a2e
20a8603c265d777e25da064113d556f5
a01d1cbb398e386a4a8f8364401a7584
43ee88561093499d9e571d4db5f20b79
f8a8f05a35976a91aed5cccc3992c357
c1234c80dafde7ef3311b3eabd5069ed
cac9e5692471a0700418aa3400b9b2b1
97f1396a5a1f7c07ba51784efdec44b8
f9a7825fa51f487b8a48f67e9efced8c
Query:
SELECT o."customer_id", AVG(oi."price") AS "average_order_value"
   FROM "orders" o
   JOIN "order_items" oi ON o."order_id" = oi."order_id"
   WHERE o."order_status" = 'delivered'
   GROUP BY o."customer_id"
   LIMIT 100;
Answer:
customer_id,average_order_value
00012a2ce6f8dcda20d059ce98491703,89.8
000161a058600d5901f007fab4c27140,54.9
0001fd6190edaaf884bcaf3d49edf079,179.99
0002414f95344307404f0ace7a26f1d5,149.9
000379cdec625522490c315e70c7a9fb,93.0
0004164d20a9e969af783496f3408652,59.99
000419c5494106c306a97b5635748086,34.3
00046a560d407e99b969756e0b10f282,120.9
00050bf6e01e69d5c0fd612f1bcfb69c,69.99
000598caf2ef4117407665ac33275130,1107.0
0005aefbb696d34b3424dccd0a0e9fd0,134.9
00062b33cb9f6fe976afdcff967ea74d,47.99
00066ccbe787a588c52bd5ff404590e3,49.9
00072d033fe2e59061ae5c3aff1a2be5,89.9
0009a69b72033b2d0ec8c69fc70ef768,159.9
000bf8121c3412d3057d32371c5d3395,15.0
000e943451fc2788ca6ac98a682f2f49,89.9
000f17e290c26b28549908a04cfe36c1,122.9
000fd45d6fedae68fc6676036610f879,53.99
0010068a73b7c56da5758c3f9e5c7375,29.99
001028b78fd413e19704b3867c369d3a,29.9
00104a47c29da701ce41ee52077587d9,83.99
001051abfcfdbed9f87b4266213a5df1,49.97
00114026c1b7b52ab1773f317ef4880b,49.9
001226b2341ef620415ce7bbafcfac28,29.9
0012a5c13793cf51e253f096a7e740dd,349.9
0013280441d86a4f7a8006efdaf1b0fe,149.9
0013cd8e350a7cc76873441e431dd5ee,79.9
001450ebb4a77efb3d68be5f7887cb1e,18.82
00146ad30454993879adaa91c518f68c,199.9
00155f0530cc7b2bf73cc3f81cb01c52,28.9
0015bc9fd2d5395446143e8b215d7c75,122.99
0015f7887e2fde13ddaa7b8e385af919,167.99
0017a0b4c1f1bdb9c395fa0ac517109c,34.9
0018c09f333634ca9c80d9ff46e43e9c,42.99
0018f7fde63ca77254dbc47f4ea358b2,37.9
0019c9aaad15b043c48f0a1180f22ce8,99.99
001a57041f56400917a187dd74e6cbc1,45.0
001b4e9b73aa98a6276b241bfd496822,75.0
001c7f05398c45b42eee0d5a77783bca,13.65
001df1ee5c36767aa607001ab1a13a06,29.99
001f150aebb5d897f2059b0460c38449,110.32
001f35d9f262c558fd065346fbf5801d,28.9
001f6f1a5e902ad14e1f709a7215de11,23.9
00205ad9ba1ef4340cef86583294cf82,899.9
002236c4f333bc8df6a5939749eb7869,59.9
002408f390f729598bbac1ef9421c6ae,195.9
002450e9ea44cb90b8a07ba0b197e149,24.9
002554bdf9eb99618d8189c3a89fdd52,229.0
0026955706fd4e2fa997f3f4c18d485a,99.9
002834b4d901534f48d9e9a72047b288,198.0
0028ff36263a86bf679df7c863a0a0ba,52.0
002905287304e28c0218389269b4759b,13.47
002937abdae13680e17dccd3868b4825,9.4
0029cdf064769cabdf3186b54d068c99,459.99
002a10e899b62a460b0116e0b68697ad,78.9
002b24cb2cd0c3e575040dbd278885e3,24.99
002c625393dfa194828b462a6ef8cb0b,311.25
002ce108ccf0356ef5c8b1dce3c0ae29,176.6
002d358e2462f87678443706cbf2eb21,29.5
002d597546b2cf44428232c9f237f873,99.0
002ebb669a34b9e79c88efc755e95322,110.0
002ef7e55600d44ead53f7c1644e5222,174.99
002f067b028a3643ad3a0969c7a0f3dc,79.9
002f90a6eb386bc43bc9ba200db31a89,59.900000000000006
002fb8fc5ce64f8422fa2fe79986c783,59.9
002ff70a5285669011090c077ef929af,62.9
00302a0b99783c3d1d1e81c616e321e8,129.0
0030aded3a67b29946a128ee8468388e,45.9
0030fbb95fbe7e61f798a80edb01a8e9,15.0
00314f95a054231742e3c5396b333b88,50.0
003177b3eeca50af17750f53802c9a09,110.32
0031abfb953b66e998f67b09e7b11375,318.95
0031c1062edf836ef7a7a7ea758b137b,69.9
00330644cccc5db0276fa836976306fe,37.5
00331de1659c7f4fb660c8810e6de3f5,69.0
0033823ee55671ac5317d423291333c2,61.8
0034f7933de3ead6bd9ba49afe95f119,65.9
003536ce5e18f1d12b9bf76932f8a6b1,43.99
0035b30e58c620fa2bd30275ddd4f7ef,59.9
0036875772a8eeb391b8cd7226283fdd,50.0
00380c010de38d578d02117f6d0b88e7,49.0
0039b3e41ac6615814a0b44a8992bff5,19.49
003a75d228dc67cb2918e40c2aacc4bf,29.9
003b595c764773e20e0949b6fba7b1dc,12.67
003bc8d06ebed9d146eb9f100d0a89ae,569.0
003bdf7fd8312f9d14a4b979f3747334,35.9
003c7cadba4f182b9f22d7d5ea7a5003,109.9
003cbe6a43560a8b6fd2c07531257c2d,13.65
003e45472805afa1ee701d83284fa22b,16.5
003eab528664e1bd677218ef4be086ac,62.9
003ec17a1389fa302f3a0423dddd8650,9.99
003f7d92ac63c512bb6584219806f8df,72.9
0040a8417928d0d5abd5169cd7877181,199.99
0040b00970e2139e8c43b647c0da5305,30.97
00411811e3b661e746a6e1ce1f0878ab,349.0
0041d7b768cb115092fa0f5d55638d06,63.0
00426311a53f3c052943c88b692a3be2,29.5
0042d04ee8231b36dcb29aac213f5db4,18.95
0043b0afd67fb3af74360d2893b9a530,99.99
Query:
SELECT o."customer_id",
           COUNT(DISTINCT o."order_id") AS "frequency",
           MAX(o."order_purchase_timestamp") AS "recency",
           SUM(oi."price") AS "monetary_value"
    FROM "orders" o
    JOIN "order_items" oi ON o."order_id" = oi."order_id"
    WHERE o."order_status" = 'delivered'
    GROUP BY o."customer_id"
    LIMIT 100;
Answer:
Too long, hard cut:
customer_id,frequency,recency,monetary_value
00012a2ce6f8dcda20d059ce98491703,1,2017-11-14 16:08:26,89.8
000161a058600d5901f007fab4c27140,1,2017-07-16 09:40:32,54.9
0001fd6190edaaf884bcaf3d49edf079,1,2017-02-28 11:06:43,179.99
0002414f95344307404f0ace7a26f1d5,1,2017-08-16 13:09:20,149.9
000379cdec625522490c315e70c7a9fb,1,2018-04-02 13:42:17,93.0
0004164d20a9e969af783496f3408652,1,2017-04-12 08:35:12,59.99
000419c5494106c306a97b5635748086,1,2018-03-02 17:47:40,34.3
00046a560d407e99b969756e0b10f282,1,2017-12-18 11:08:30,120.9
00050bf6e01e69d5c0fd612f1bcfb69c,1,2017-09-17 16:04:44,69.99
000598caf2ef4117407665ac33275130,1,2018-08-11 12:14:35,1107.0
0005aefbb696d34b3424dccd0a0e9fd0,1,2018-06-20 09:46:53,134.9
00062b33cb9f6fe976afdcff967ea74d,1,2017-03-15 23:44:09,47.99
00066ccbe787a588c52bd5ff404590e3,1,2018-02-06 16:10:09,199.6
00072d033fe2e59061ae5c3aff1a2be5,1,2017-09-01 09:24:39,89.9
0009a69b72033b2d0ec8c69fc70ef768,1,2017-04-28 13:36:30,159.9
000bf8121c3412d3057d32371c5d3395,1,2017-10-11 07:44:31,30.0
000e943451fc2788ca6ac98a682f2f49,1,2017-04-20 19:37:14,89.9
000f17e290c26b28549908a04cfe36c1,1,2017-11-10 16:37:05,122.9
000fd45d6fedae68fc6676036610f879,1,2018-04-15 15:55:01,53.99
0010068a73b7c56da5758c3f9e5c7375,1,2017-04-11 18:19:55,29.99
001028b78fd413e19704b3867c369d3a,1,2018-04-12 12:51:28,29.9
00104a47c29da701ce41ee52077587d9,1,2018-01-14 20:28:56,83.99
001051abfcfdbed9f87b4266213a5df1,1,2018-05-30 09:19:31,49.97
00114026c1b7b52ab1773f317ef4880b,1,2017-06-01 19:44:44,49.9
001226b2341ef620415ce7bbafcfac28,1,2017-09-29 01:15:08,29.9
0012a5c13793cf51e253f096a7e740dd,1,2018-03-05 14:54:23,349.9
0013280441d86a4f7a8006efdaf1b0fe,1,2018-01-08 02:35:36,149.9
0013cd8e350a7cc76873441e431dd5ee,1,2018-05-07 23:25:09,79.9
001450ebb4a77efb3d68be5f7887cb1e,1,2018-02-26 08:35:13,37.64
00146ad30454993879adaa91c518f68c,1,2018-01-08 20:40:57,199.9
00155f0530cc7b2bf73cc3f81cb01c52,1,2017-05-14 23:55:13,28.9
0015bc9fd2d5395446143e8b215d7c75,1,2018-06-11 19:48:34,122.99
0015f7887e2fde13ddaa7b8e385af919,1,2017-07-31 11:05:46,167.99
0017a0b4c1f1bdb9c395fa0ac517109c,1,2018-03-03 18:44:01,34.9
0018c09f333634ca9c80d9ff46e43e9c,1,2018-07-01 18:07:57,42.99
0018f7fde63ca77254dbc47f4ea358b2,1,2017-09-26 14:01:47,37.9
0019c9aaad15b043c48f0a1180f22ce8,1,2018-03-06 00:26:58,99.99
001a57041f56400917a187dd74e6cbc1,1,2018-01-17 21:22:51,45.0
001b4e9b73aa98a6276b241bfd496822,1,2018-04-07 02:12:51,75.0
001c7f05398c45b42eee0d5a77783bca,1,2018-04-12 13:41:07,13.65
001df1ee5c36767aa607001ab1a13a06,1,2018-08-05 23:14:45,29.99
001f150aebb5d897f2059b0460c38449,1,2018-05-09 12:06:04,110.32
001f35d9f262c558fd065346fbf5801d,1,2018-01-25 17:33:55,28.9
001f6f1a5e902ad14e1f709a7215de11,1,2017-02-07 20:32:13,23.9
00205ad9ba1ef4340cef86583294cf82,1,2018-05-12 17:51:47,899.9
002236c4f333bc8df6a5939749eb7869,1,2018-01-22 20:16:33,59.9
002408f390f729598bbac1ef9421c6ae,1,2018-01-10 17:01:34,195.9
002450e9ea44cb90b8a07ba0b197e149,1,2017-08-16 09:07:13,24.9
002554bdf9eb99618d8189c3a89fdd52,1,2018-08-13 17:59:25,229.0
0026955706fd4e2fa997f3f4c18d485a,1,2018-08-20 11:23:45,99.9
002834b4d901534f48d9e9a72047b288,1,2017-10-08 17:38:00,198.0
0028ff36263a86bf679df7c863a0a0ba,1,2018-04-12 17:16:49,52.0
002905287304e28c0218389269b4759b,1,2018-07-22 17:13:46,13.47
002937abdae13680e17dccd3868b4825,1,2017-11-24 20:26:39,9.4
0029cdf064769cabdf3186b54d068c99,1,2018-02-04 12:22:30,459.99
002a10e899b62a460b0116e0b68697ad,1,2018-05-05 18:33:24,78.9
002b24cb2cd0c3e575040dbd278885e3,1,2018-05-21 23:17:32,24.99
002c625393dfa194828b462a6ef8cb0b,1,2017-11-19 13:22:44,311.25
002ce108ccf0356ef5c8b1dce3c0ae29,1,2018-06-06 17:22:52,176.6
002d358e2462f87678443706cbf2eb21,1,2018-01-31 17:53:18,29.5
002d597546b2cf44428232c9f237f873,1,2018-07-22 09:29:19,99.0
002ebb669a34b9e79c88efc755e95322,1,2018-08-11 12:41:01,110.0
002ef7e55600d44ead53f7c1644e5222,1,2018-06-19 21:08:43,174.99
002f067b028a3643ad3a0969c7a0f3dc,1,2017-10-19 09:31:12,79.9
002f90a6eb386bc43bc9ba200db31a89,1,2017-06-15 23:59:20,119.80000000000001
002fb8fc5ce64f8422fa2fe79986c783,1,2017-11-26 23:15:12,59.9
002ff70a5285669011090c077ef929af,1,2018-08-05 13:19:28,62.9
00302a0b99783c3d1d1e81c616e321e8,1,2018-03-26 18:50:44,129.0
0030aded3a67b29946a128ee8468388e,1,2017-11-23 21:18:14,45.9
0030fbb95fbe7e61f798a80edb01a8e9,1,2017-11-09 23:28:29,15.0
00314f95a054231742e3c5396b333b88,1,2018-01-08 19:29:38,50.0
003177b3eeca50af17750f53802c9a09,1,2018-07-08 15:48:40,110.32
0031abfb953b66e998f67b09e7b11375,1,2018-01-23 13:57:55,637.9
0031c1062edf836ef7a7a7ea758b137b,1,2017-03-01 20:00:23,69.9
00330644cccc5db0276fa836976306fe,1,2017-10-30 17:48:07,37.5
00331de1659c7f4fb660c8810e6de3f5,1,2017-12-18 14:54:52,207.0
0033823ee55671ac5317d423291333c2,1,2017-05-29 19:02:27,61.8
0034f7933de3ead6bd9ba49afe95f119,1,2018-04-06 09:25:10,65.9
003536ce5e18f1d12b9bf76932f8a6b1,1,2017-10-16 19:17:54,43.99
0035b30e58c620fa2bd30275ddd4f7ef,1,2018-04-08 18:56:27,59.9
0036875772a8eeb391b8cd7226283fdd,1,2018-01-21 22:49:14,50.0
00380c010de38d578d02117f6d0b88e
Query:
SELECT o."customer_id", SUM(oi."price") AS "total_spent"
    FROM "orders" o
    JOIN "order_items" oi ON o."order_id" = oi."order_id"
    WHERE o."order_status" = 'delivered'
    GROUP BY o."customer_id"
    ORDER BY "total_spent" DESC
    LIMIT 100;
Answer:
customer_id,total_spent
1617b1357756262bfa56ab541c47bc16,13440.0
ec5b2ba62e574342386871631fafd3fc,7160.0
c6e2731c5b391845f6800c97401a43a9,6735.0
f48d464a0baaea338cb25f816991ab1f,6729.0
3fd6777bbce08a352fddd04e4a7cc8f6,6499.0
05455dfa7cd02f13d132aa7a6a9729c6,5934.6
df55c14d1476a9a3467f131269c2477f,4799.0
24bbf5fd2f2e1b359ee7de94defc4a15,4690.0
3d979689f636322c62418b6346b1c6d2,4590.0
cc803a2c412833101651d3f90ca7de24,4400.0
1afc82cd60e303ef09b4ef9837c9505c,4399.87
35a413c7ca3c69756cb75867d6311c0d,4099.99
e9b0d0eb3015ef1c9ce6cf5b9dcbee9f,4059.0
c6695e3b1e48680db36b487419fb0398,3999.9
926b6a6fb8b6081e00b335edaf578d35,3999.0
3be2c536886b2ea4668eced3a80dd0bb,3980.0
31e83c01fce824d0ff786fcd48dad009,3930.0
eb7a157e8da9c488cd4ddc48711f1097,3899.0
19b32919fa1198aefc0773ee2e46e693,3700.0
66657bf1753d82d0a76f2c4719ab8b85,3699.99
addc91fdf9c2b3045497b57fc710e820,3690.0
7d03bf20fa96e80468bbf678eebbcb3f,3597.0
39d6658037b1b5a07d0a24d423f0bd19,3549.0
e7c905bf4bb13543e8df947af4f3d9e9,3399.99
0b16ce67087d02bf833c807e82b1992b,3300.0
a7ea318cbe9df2ec79ab37cd7ca2135d,3198.0
46bb3c0b1a65c8399d0363cefbcc4f37,3124.0
26dcb450c4b5b390e79e6d5d0f2c6535,3109.99
7e7d2271d6f55b03b0bd4615c5f2de6e,3105.0
a95f4bbcf95262b073e4afa481b59ff8,3099.9
71901689c5f3e5adc27b1dd16b33f0b8,3099.75
803cd9b04f9cd252c6a83a2ecdbc22c3,3099.0
3c7c62e8d38fb18a33a45db8021f2d69,3089.0
10a86619816f9d2afce3f45b04aabc71,2999.99
0a209a88c2e3dc2981c79ad85c558059,2999.99
c03dfaf5db49d8583edbb5627f92058d,2999.9
fd78e5e3abdc375368456fe738694c00,2999.89
d7c94e22bfd332eb29b0f5badc3ce103,2999.89
8dd4c93bfbebe2a77657d46ef959a7ac,2999.89
4312e816d88fa8bdb6246878f61cdad5,2999.89
3a4e4932f3e6976dd966f1d3c044d49e,2999.89
101c8d91278c4de9001566d27033f673,2999.0
c26acf0451e0f8ec1f5218731b9a51cf,2990.0
9d4ba8752b5b737f45da0544b669552a,2951.0
6152fbfc8a92ee25fd821740bd33b089,2920.0
f7622098214b4634b7fe7eee269b5426,2919.4
a5c69c3bf293d341b6a56a4b7307c529,2899.0
a244afc7a1ec53f1aad296d1cd6e91ba,2899.0
f41666558f4e35056a445c27c2ac3d8b,2874.0
1ff773612ab8934db89fd5afa8afe506,2849.8999999999996
9f9717a71bd8f6e5600b4faad20c20fb,2799.65
1be0dd2f660a5a04ee20d608075f1b83,2799.0
97dd9c6923b3237b650f1f4f3f2145ad,2749.65
fced842c7dad61e8ce47b49229659718,2749.0
8e2c57611e09e143ec4ab76e38033bef,2740.0
5f87c05477db2d22c63b718299c9c03e,2700.0
08dc68ad9ab343289844fa36f6963b8f,2700.0
a8f345f82667eb421151dc7626147636,2699.0
55fd5d10a5036383fe19af015d2e5a80,2699.0
3f083b9f62e687be8d84684c7d54c8db,2690.0
19365ad6a18ccf1baf6eb71c30651096,2690.0
e5df9583ddbe3f4f3857d9b667dfa609,2689.0
2e0339ff984d6f41f11dfdbc7c93dcda,2680.0
8401401a8752eb431189e021b8009e37,2649.99
695476b5848d64ba0875324c88390206,2649.99
b1c28f9b72d07054b64d09e487b5021c,2649.0
b177ef267a4377b77e0620d1a7f08dce,2649.0
0c5292f5e3690805390efddf53935915,2600.0
e9859fbdff7d26c36c228cf60796e844,2589.0
349509b216bd5ec11c5fae929fd13595,2589.0
1fb8ff22dad231d26fc7ecde2e2dc27a,2550.0
53e644c7c57416bdaf0409e656ee8b0a,2547.0
7e95832184f874c220b8ebffa750837d,2520.0
1ca6f90a61cf75c002a0d690261a0e4c,2499.99
35698a7b9ae42369b9f45a53000f85f3,2498.0
9537f2addba8448428a3fd1a1add0656,2470.5
279ca766397588e704abddd56d2dc131,2470.5
9c5d7103954595e173781530b10d02e4,2433.6
68f692d1f39843a16d9319a7306b6b10,2428.0
cdecc5d1f7fc375b1138e8b5f496fd69,2400.0
b76816b61d8043a98db57875437da6b5,2400.0
cb3724d7cb7db46b65cfd1e7c16c0df5,2399.8
30ab7e538292e6130a456c371778d595,2399.0
233d97d412c7f4bb8d857ec922c0317f,2399.0
177ba55869da8001fcca079af0b85832,2399.0
b9da524b08224eaff1bf76ef4d4299ac,2370.0
548692bdcbd6e3683ff306ac9d8418d6,2350.0
f2c743697f9b2ff2902df23a16582d80,2338.08
f08306b95370e8d5f0d97b71229284b6,2338.08
3696afd6fae4a1f36fcbc3db8f3d6640,2338.08
f767e7437c3aa2c044523c0a6712380b,2300.0
e683dddabd8f5c3ad3708a3364e932f8,2300.0
6f18119032437dd6fa1c7df272d2d9e6,2299.99
9125dbd39c45287dfab9207f3cb15075,2299.95
9cf0a858f5f153406bc333860eb23e22,2299.0
df358a91acde222cf3330baac5cecfe7,2288.0
b18d47c9116d2a106291aea1abfd3f04,2258.0
6b66c3c14df21f07ea7f57fc8af6517f,2258.0
174156b68563868e1ed48408117d6df4,2249.0
d1447849bd806efd6282988355588728,2221.0
Query:
SELECT AVG("order_count") AS "average_orders_per_customer"
    FROM (
      SELECT "customer_id", COUNT(DISTINCT "order_id") AS "order_count"
      FROM "orders"
      WHERE "order_status" = 'delivered'
      GROUP BY "customer_id"
    )
    LIMIT 100;
Answer:
average_orders_per_customer
1.0
Query:
SELECT AVG("order_count") AS "average_orders_per_customer"
FROM (
  SELECT "customer_id", COUNT(DISTINCT "order_id") AS "order_count"
  FROM "orders"
  WHERE "order_status" = 'delivered'
  GROUP BY "customer_id"
);
Answer:
average_orders_per_customer
1.0
Query:
SELECT "customer_id",
       MIN("order_purchase_timestamp") AS "first_purchase",
       MAX("order_purchase_timestamp") AS "last_purchase"
FROM "orders"
WHERE "order_status" = 'delivered'
GROUP BY "customer_id"
Answer:
Too long, hard cut:
customer_id,first_purchase,last_purchase
00012a2ce6f8dcda20d059ce98491703,2017-11-14 16:08:26,2017-11-14 16:08:26
000161a058600d5901f007fab4c27140,2017-07-16 09:40:32,2017-07-16 09:40:32
0001fd6190edaaf884bcaf3d49edf079,2017-02-28 11:06:43,2017-02-28 11:06:43
0002414f95344307404f0ace7a26f1d5,2017-08-16 13:09:20,2017-08-16 13:09:20
000379cdec625522490c315e70c7a9fb,2018-04-02 13:42:17,2018-04-02 13:42:17
0004164d20a9e969af783496f3408652,2017-04-12 08:35:12,2017-04-12 08:35:12
000419c5494106c306a97b5635748086,2018-03-02 17:47:40,2018-03-02 17:47:40
00046a560d407e99b969756e0b10f282,2017-12-18 11:08:30,2017-12-18 11:08:30
00050bf6e01e69d5c0fd612f1bcfb69c,2017-09-17 16:04:44,2017-09-17 16:04:44
000598caf2ef4117407665ac33275130,2018-08-11 12:14:35,2018-08-11 12:14:35
0005aefbb696d34b3424dccd0a0e9fd0,2018-06-20 09:46:53,2018-06-20 09:46:53
00062b33cb9f6fe976afdcff967ea74d,2017-03-15 23:44:09,2017-03-15 23:44:09
00066ccbe787a588c52bd5ff404590e3,2018-02-06 16:10:09,2018-02-06 16:10:09
00072d033fe2e59061ae5c3aff1a2be5,2017-09-01 09:24:39,2017-09-01 09:24:39
0009a69b72033b2d0ec8c69fc70ef768,2017-04-28 13:36:30,2017-04-28 13:36:30
000bf8121c3412d3057d32371c5d3395,2017-10-11 07:44:31,2017-10-11 07:44:31
000e943451fc2788ca6ac98a682f2f49,2017-04-20 19:37:14,2017-04-20 19:37:14
000f17e290c26b28549908a04cfe36c1,2017-11-10 16:37:05,2017-11-10 16:37:05
000fd45d6fedae68fc6676036610f879,2018-04-15 15:55:01,2018-04-15 15:55:01
0010068a73b7c56da5758c3f9e5c7375,2017-04-11 18:19:55,2017-04-11 18:19:55
001028b78fd413e19704b3867c369d3a,2018-04-12 12:51:28,2018-04-12 12:51:28
00104a47c29da701ce41ee52077587d9,2018-01-14 20:28:56,2018-01-14 20:28:56
001051abfcfdbed9f87b4266213a5df1,2018-05-30 09:19:31,2018-05-30 09:19:31
00114026c1b7b52ab1773f317ef4880b,2017-06-01 19:44:44,2017-06-01 19:44:44
001226b2341ef620415ce7bbafcfac28,2017-09-29 01:15:08,2017-09-29 01:15:08
0012a5c13793cf51e253f096a7e740dd,2018-03-05 14:54:23,2018-03-05 14:54:23
0013280441d86a4f7a8006efdaf1b0fe,2018-01-08 02:35:36,2018-01-08 02:35:36
0013cd8e350a7cc76873441e431dd5ee,2018-05-07 23:25:09,2018-05-07 23:25:09
001450ebb4a77efb3d68be5f7887cb1e,2018-02-26 08:35:13,2018-02-26 08:35:13
00146ad30454993879adaa91c518f68c,2018-01-08 20:40:57,2018-01-08 20:40:57
00155f0530cc7b2bf73cc3f81cb01c52,2017-05-14 23:55:13,2017-05-14 23:55:13
0015bc9fd2d5395446143e8b215d7c75,2018-06-11 19:48:34,2018-06-11 19:48:34
0015f7887e2fde13ddaa7b8e385af919,2017-07-31 11:05:46,2017-07-31 11:05:46
0017a0b4c1f1bdb9c395fa0ac517109c,2018-03-03 18:44:01,2018-03-03 18:44:01
0018c09f333634ca9c80d9ff46e43e9c,2018-07-01 18:07:57,2018-07-01 18:07:57
0018f7fde63ca77254dbc47f4ea358b2,2017-09-26 14:01:47,2017-09-26 14:01:47
0019c9aaad15b043c48f0a1180f22ce8,2018-03-06 00:26:58,2018-03-06 00:26:58
001a57041f56400917a187dd74e6cbc1,2018-01-17 21:22:51,2018-01-17 21:22:51
001b4e9b73aa98a6276b241bfd496822,2018-04-07 02:12:51,2018-04-07 02:12:51
001c7f05398c45b42eee0d5a77783bca,2018-04-12 13:41:07,2018-04-12 13:41:07
001df1ee5c36767aa607001ab1a13a06,2018-08-05 23:14:45,2018-08-05 23:14:45
001f150aebb5d897f2059b0460c38449,2018-05-09 12:06:04,2018-05-09 12:06:04
001f35d9f262c558fd065346fbf5801d,2018-01-25 17:33:55,2018-01-25 17:33:55
001f6f1a5e902ad14e1f709a7215de11,2017-02-07 20:32:13,2017-02-07 20:32:13
00205ad9ba1ef4340cef86583294cf82,2018-05-12 17:51:47,2018-05-12 17:51:47
002236c4f333bc8df6a5939749eb7869,2018-01-22 20:16:33,2018-01-22 20:16:33
002408f390f729598bbac1ef9421c6ae,2018-01-10 17:01:34,2018-01-10 17:01:34
002450e9ea44cb90b8a07ba0b197e149,2017-08-16 09:07:13,2017-08-16 09:07:13
002554bdf9eb99618d8189c3a89fdd52,2018-08-13 17:59:25,2018-08-13 17:59:25
0026955706fd4e2fa997f3f4c18d485a,2018-08-20 11:23:45,2018-08-20 11:23:45
002834b4d901534f48d9e9a72047b288,2017-10-08 17:38:00,2017-10-08 17:38:00
0028ff36263a86bf679df7c863a0a0ba,2018-04-12 17:16:49,2018-04-12 17:16:49
002905287304e28c0218389269b4759b,2018-07-22 17:13:46,2018-07-22 17:13:46
002937abdae13680e17dccd3868b4825,2017-11-24 20:26:39,2017-11-24 20:26:39
0029cdf064769cabdf3186b54d068c99,2018-02-04 12:22:30,2018-02-04 12:22:30
002a10e899b62a460b0116e0b68697ad,2018-05-05 18:33:24,2018-05-05 18:33:24
002b24cb2cd0c3e575040dbd278885e3,2018-05-21 23:17:32,2018-05-21 23:17:32
002c625393dfa194828b462a6ef8cb0b,2017-11-19 13:22:44,2017-11-19 13:22:44
002ce108ccf0356ef5c8b1dce3c0ae29,2018-06-06 17:22:52,2018-06-06 17:22:52
002d358e2462f87678443706cbf2eb21,2018-01-31 17:53:18,2018-01-31 17:53:18
002d597546b2cf44428232c9f237f873,2018-07-22 09:29:19,2018-07-22 09:29:19
002ebb669a34b9e79c88efc755e95322,2018-08-11 12:41:01,2018-08-11 12:41:01
002ef7e55600d44ead53f7c1644e5222,2018-06-19 21:08:43,2018-06-19 21:08:43
002f067b028a3643ad3a0969c7a0f3dc,2017-10-19 09:31:12,2017-10-19 09:31:12
002f90a6eb386bc43bc9ba200db31a89,2017-06-15 23:59:20,2017-06-15 23:59:20
002fb8fc5ce64f8422fa2fe79986c783,2017-11-26 23:15:12,2017-11-26 23:15:12
002ff70a5285669011090c077ef929af,2018-08-05 13:19:28,2018-08-05 13:19:28
00302a0b99783c3d1d1e81c616e321e8,2018-03-26 18:50:44,2018-03-26 18:5
Query:
SELECT o."customer_id", AVG(oi."price") AS "average_sales_per_order"
FROM "orders" o
JOIN "order_items" oi ON o."order_id" = oi."order_id"
WHERE o."order_status" = 'delivered'
GROUP BY o."customer_id"
Answer:
Too long, hard cut:
customer_id,average_sales_per_order
00012a2ce6f8dcda20d059ce98491703,89.8
000161a058600d5901f007fab4c27140,54.9
0001fd6190edaaf884bcaf3d49edf079,179.99
0002414f95344307404f0ace7a26f1d5,149.9
000379cdec625522490c315e70c7a9fb,93.0
0004164d20a9e969af783496f3408652,59.99
000419c5494106c306a97b5635748086,34.3
00046a560d407e99b969756e0b10f282,120.9
00050bf6e01e69d5c0fd612f1bcfb69c,69.99
000598caf2ef4117407665ac33275130,1107.0
0005aefbb696d34b3424dccd0a0e9fd0,134.9
00062b33cb9f6fe976afdcff967ea74d,47.99
00066ccbe787a588c52bd5ff404590e3,49.9
00072d033fe2e59061ae5c3aff1a2be5,89.9
0009a69b72033b2d0ec8c69fc70ef768,159.9
000bf8121c3412d3057d32371c5d3395,15.0
000e943451fc2788ca6ac98a682f2f49,89.9
000f17e290c26b28549908a04cfe36c1,122.9
000fd45d6fedae68fc6676036610f879,53.99
0010068a73b7c56da5758c3f9e5c7375,29.99
001028b78fd413e19704b3867c369d3a,29.9
00104a47c29da701ce41ee52077587d9,83.99
001051abfcfdbed9f87b4266213a5df1,49.97
00114026c1b7b52ab1773f317ef4880b,49.9
001226b2341ef620415ce7bbafcfac28,29.9
0012a5c13793cf51e253f096a7e740dd,349.9
0013280441d86a4f7a8006efdaf1b0fe,149.9
0013cd8e350a7cc76873441e431dd5ee,79.9
001450ebb4a77efb3d68be5f7887cb1e,18.82
00146ad30454993879adaa91c518f68c,199.9
00155f0530cc7b2bf73cc3f81cb01c52,28.9
0015bc9fd2d5395446143e8b215d7c75,122.99
0015f7887e2fde13ddaa7b8e385af919,167.99
0017a0b4c1f1bdb9c395fa0ac517109c,34.9
0018c09f333634ca9c80d9ff46e43e9c,42.99
0018f7fde63ca77254dbc47f4ea358b2,37.9
0019c9aaad15b043c48f0a1180f22ce8,99.99
001a57041f56400917a187dd74e6cbc1,45.0
001b4e9b73aa98a6276b241bfd496822,75.0
001c7f05398c45b42eee0d5a77783bca,13.65
001df1ee5c36767aa607001ab1a13a06,29.99
001f150aebb5d897f2059b0460c38449,110.32
001f35d9f262c558fd065346fbf5801d,28.9
001f6f1a5e902ad14e1f709a7215de11,23.9
00205ad9ba1ef4340cef86583294cf82,899.9
002236c4f333bc8df6a5939749eb7869,59.9
002408f390f729598bbac1ef9421c6ae,195.9
002450e9ea44cb90b8a07ba0b197e149,24.9
002554bdf9eb99618d8189c3a89fdd52,229.0
0026955706fd4e2fa997f3f4c18d485a,99.9
002834b4d901534f48d9e9a72047b288,198.0
0028ff36263a86bf679df7c863a0a0ba,52.0
002905287304e28c0218389269b4759b,13.47
002937abdae13680e17dccd3868b4825,9.4
0029cdf064769cabdf3186b54d068c99,459.99
002a10e899b62a460b0116e0b68697ad,78.9
002b24cb2cd0c3e575040dbd278885e3,24.99
002c625393dfa194828b462a6ef8cb0b,311.25
002ce108ccf0356ef5c8b1dce3c0ae29,176.6
002d358e2462f87678443706cbf2eb21,29.5
002d597546b2cf44428232c9f237f873,99.0
002ebb669a34b9e79c88efc755e95322,110.0
002ef7e55600d44ead53f7c1644e5222,174.99
002f067b028a3643ad3a0969c7a0f3dc,79.9
002f90a6eb386bc43bc9ba200db31a89,59.900000000000006
002fb8fc5ce64f8422fa2fe79986c783,59.9
002ff70a5285669011090c077ef929af,62.9
00302a0b99783c3d1d1e81c616e321e8,129.0
0030aded3a67b29946a128ee8468388e,45.9
0030fbb95fbe7e61f798a80edb01a8e9,15.0
00314f95a054231742e3c5396b333b88,50.0
003177b3eeca50af17750f53802c9a09,110.32
0031abfb953b66e998f67b09e7b11375,318.95
0031c1062edf836ef7a7a7ea758b137b,69.9
00330644cccc5db0276fa836976306fe,37.5
00331de1659c7f4fb660c8810e6de3f5,69.0
0033823ee55671ac5317d423291333c2,61.8
0034f7933de3ead6bd9ba49afe95f119,65.9
003536ce5e18f1d12b9bf76932f8a6b1,43.99
0035b30e58c620fa2bd30275ddd4f7ef,59.9
0036875772a8eeb391b8cd7226283fdd,50.0
00380c010de38d578d02117f6d0b88e7,49.0
0039b3e41ac6615814a0b44a8992bff5,19.49
003a75d228dc67cb2918e40c2aacc4bf,29.9
003b595c764773e20e0949b6fba7b1dc,12.67
003bc8d06ebed9d146eb9f100d0a89ae,569.0
003bdf7fd8312f9d14a4b979f3747334,35.9
003c7cadba4f182b9f22d7d5ea7a5003,109.9
003cbe6a43560a8b6fd2c07531257c2d,13.65
003e45472805afa1ee701d83284fa22b,16.5
003eab528664e1bd677218ef4be086ac,62.9
003ec17a1389fa302f3a0423dddd8650,9.99
003f7d92ac63c512bb6584219806f8df,72.9
0040a8417928d0d5abd5169cd7877181,199.99
0040b00970e2139e8c43b647c0da5305,30.97
00411811e3b661e746a6e1ce1f0878ab,349.0
0041d7b768cb115092fa0f5d55638d06,63.0
00426311a53f3c052943c88b692a3be2,29.5
0042d04ee8231b36dcb29aac213f5db4,18.95
0043b0afd67fb3af74360d2893b9a530,99.99
004440537b68545ca3c341d7279bc4c0,39.99
00447b6bd39c4a0f6366b05948f9e2e3,279.9
00459c4eb23e40414ca067d06fa303d4,64.99
0045ac1c0957bc92e109f71e4941fa49,139.2
00474d2582fd72663036795b7ab8cfc1,39.9
004937d0f9d6ce15c2830c00c2f482e5,59.0
00498d14e21c58ed2feb5d5feb4cd706,89.0
0049e8442c2a3e4a8d1ff5a9549abd53,1200.0
004a2b3e8b026284407c620f4f01f686,138.0
004d41e9bf012c669db1a257888d85a2,280.0
004df18653e9438571e9d294776a5c5c,42.0
004ee20df425002ed78553e1f50caa3e,19.9
004f39eb181d53fa796fe82ce7a0cbd5,89.99
00502500a53243e07961383bf1a6fa82,55.9
005092c23e81812fbbe11fc6cf7e5316,29.9
0050b4dd994efa94b2cd3210e4cecf32,132.7
0050ee32fbb93383fb0d9e3d8ee89a07,99.0
0051337a96842850e1ec728dd158f4b3,219.99
005196c65bab2861e397cc85bc7664bf,1089.0
00520034b873d2cdfe098fd0a634d03d,149.9
0054556ea954a76ad6f9c4ba79d34a98,34.99
005460bea0518c7354f01adf10012184,59.9
0054f2f885ca69abcf4935c9506d7851,42.99
005596395ca3acd0433fe7d6f95a028e,15.9
0055e9b290953716739bd94a256a4144,42.5
0056a2580b5c68cfa6b43c6ef6adbc03,47.7
00573ea7a2ac9dff51ac3d177cd6eaea,29.9
0057f8b7c332d630b992d6a8ca79748c,109.9
0058153a
End Exploring Related Columns
Task: According to the RFM definition document, how much is the average sales per order for each customer within distinct RFM segments, considering only 'delivered' orders? Please rank the customers into segments to analyze differences in average sales across these segments

Please answer only one complete SQL in sqlite dialect in ```sql``` format.
Usage example: ```sql
SELECT DISTINCT "column_name" FROM "table_name" WHERE ... ``` (Replace "table_name" with the actual table name. Enclose table and column names with double quotations if they contain special characters or match reserved keywords.)
Follow the answer format like: Based on the RFM (Recency, Frequency, Monetary) segmentation, we calculated the average sales per order for each customer within distinct RFM segments, considering only 'delivered' orders. The results are as follows:

```csv
RFM_Segment,Average_Sales_Per_Order
Segment1:str,value1:float
Segment2:str,value2:float
...
```

This table shows the RFM segment each customer belongs to and their corresponding average sales per order. By analyzing these segments, we can observe differences in purchasing behaviors across customer groups..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: 

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-24 23:36:12 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 23:36:12 - root - INFO - ```sql
WITH max_date AS (
  SELECT MAX("order_purchase_timestamp") AS "max_date"
  FROM "orders"
  WHERE "order_status" = 'delivered'
),
customer_rfm AS (
  SELECT
    o."customer_id",
    -- Calculate Recency
    ROUND(julianday((SELECT "max_date" FROM max_date)) - julianday(MAX(o."order_purchase_timestamp")), 0) AS "Recency",
    -- Calculate Frequency
    COUNT(DISTINCT o."order_id") AS "Frequency",
    -- Calculate Monetary Value
    SUM(oi."price") AS "Monetary"
  FROM "orders" o
  JOIN "order_items" oi ON o."order_id" = oi."order_id"
  WHERE o."order_status" = 'delivered'
  GROUP BY o."customer_id"
),
rfm_scores AS (
  SELECT
    cr."customer_id",
    cr."Recency",
    cr."Frequency",
    cr."Monetary",
    -- Assign Recency Score
    CASE
      WHEN cr."Recency" <= 30 THEN 4
      WHEN cr."Recency" <= 60 THEN 3
      WHEN cr."Recency" <= 90 THEN 2
      ELSE 1
    END AS "R_Score",
    -- Assign Frequency Score
    CASE
      WHEN cr."Frequency" >= 4 THEN 4
      WHEN cr."Frequency" = 3 THEN 3
      WHEN cr."Frequency" = 2 THEN 2
      ELSE 1
    END AS "F_Score",
    -- Assign Monetary Score
    CASE
      WHEN cr."Monetary" >= 1000 THEN 4
      WHEN cr."Monetary" >= 500 THEN 3
      WHEN cr."Monetary" >= 100 THEN 2
      ELSE 1
    END AS "M_Score"
  FROM customer_rfm cr
),
rfm_segments AS (
  SELECT
    rs.*,
    -- Create RFM Segment by combining scores
    CAST(rs."R_Score" AS TEXT) || CAST(rs."F_Score" AS TEXT) || CAST(rs."M_Score" AS TEXT) AS "RFM_Segment",
    -- Calculate Average Sales per Order
    rs."Monetary" / rs."Frequency" AS "Average_Sales_Per_Order"
  FROM rfm_scores rs
)
SELECT
  "RFM_Segment",
  AVG("Average_Sales_Per_Order") AS "Average_Sales_Per_Order"
FROM rfm_segments
GROUP BY "RFM_Segment"
ORDER BY "RFM_Segment";
```
2025-01-24 23:36:12 - root - INFO - itercount: 1
2025-01-24 23:36:12 - root - INFO - 0
2025-01-24 23:36:12 - root - INFO - results: 
RFM_Segment,Average_Sales_Per_Order
111,53.401724213321465
112,191.7179510106498
113,690.6825655698575
114,1592.2938696255196
211,52.76181288254041
212,188.26587133550598
213,702.2392682926829
214,1756.830491803278
311,52.12292901234463
312,187.3654484304935
313,674.6337951807226
314,1745.6557627118648
411,52.609081409475955
412,186.38928433268973
413,676.6303030303028
414,1632.211641791045


2025-01-24 23:36:12 - root - INFO - Please check the answer again by reviewing According to the RFM definition document, how much is the average sales per order for each customer within distinct RFM segments, considering only 'delivered' orders? Please rank the customers into segments to analyze differences in average sales across these segments, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: Based on the RFM (Recency, Frequency, Monetary) segmentation, we calculated the average sales per order for each customer within distinct RFM segments, considering only 'delivered' orders. The results are as follows:

```csv
RFM_Segment,Average_Sales_Per_Order
Segment1:str,value1:float
Segment2:str,value2:float
...
```

This table shows the RFM segment each customer belongs to and their corresponding average sales per order. By analyzing these segments, we can observe differences in purchasing behaviors across customer groups. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
RFM_Segment,Average_Sales_Per_Order
111,53.401724213321465
112,191.7179510106498
113,690.6825655698575
114,1592.2938696255196
211,52.76181288254041
212,188.26587133550598
213,702.2392682926829
214,1756.830491803278
311,52.12292901234463
312,187.3654484304935
313,674.6337951807226
314,1745.6557627118648
411,52.609081409475955
412,186.38928433268973
413,676.6303030303028
414,1632.211641791045
Current sql:
WITH max_date AS (
  SELECT MAX("order_purchase_timestamp") AS "max_date"
  FROM "orders"
  WHERE "order_status" = 'delivered'
),
customer_rfm AS (
  SELECT
    o."customer_id",
    -- Calculate Recency
    ROUND(julianday((SELECT "max_date" FROM max_date)) - julianday(MAX(o."order_purchase_timestamp")), 0) AS "Recency",
    -- Calculate Frequency
    COUNT(DISTINCT o."order_id") AS "Frequency",
    -- Calculate Monetary Value
    SUM(oi."price") AS "Monetary"
  FROM "orders" o
  JOIN "order_items" oi ON o."order_id" = oi."order_id"
  WHERE o."order_status" = 'delivered'
  GROUP BY o."customer_id"
),
rfm_scores AS (
  SELECT
    cr."customer_id",
    cr."Recency",
    cr."Frequency",
    cr."Monetary",
    -- Assign Recency Score
    CASE
      WHEN cr."Recency" <= 30 THEN 4
      WHEN cr."Recency" <= 60 THEN 3
      WHEN cr."Recency" <= 90 THEN 2
      ELSE 1
    END AS "R_Score",
    -- Assign Frequency Score
    CASE
      WHEN cr."Frequency" >= 4 THEN 4
      WHEN cr."Frequency" = 3 THEN 3
      WHEN cr."Frequency" = 2 THEN 2
      ELSE 1
    END AS "F_Score",
    -- Assign Monetary Score
    CASE
      WHEN cr."Monetary" >= 1000 THEN 4
      WHEN cr."Monetary" >= 500 THEN 3
      WHEN cr."Monetary" >= 100 THEN 2
      ELSE 1
    END AS "M_Score"
  FROM customer_rfm cr
),
rfm_segments AS (
  SELECT
    rs.*,
    -- Create RFM Segment by combining scores
    CAST(rs."R_Score" AS TEXT) || CAST(rs."F_Score" AS TEXT) || CAST(rs."M_Score" AS TEXT) AS "RFM_Segment",
    -- Calculate Average Sales per Order
    rs."Monetary" / rs."Frequency" AS "Average_Sales_Per_Order"
  FROM rfm_scores rs
)
SELECT
  "RFM_Segment",
  AVG("Average_Sales_Per_Order") AS "Average_Sales_Per_Order"
FROM rfm_segments
GROUP BY "RFM_Segment"
ORDER BY "RFM_Segment";
2025-01-24 23:37:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 23:37:02 - root - INFO - Based on the RFM (Recency, Frequency, Monetary) segmentation, we calculated the average sales per order for each customer within distinct RFM segments, considering only 'delivered' orders. The results are as follows:

```csv
RFM_Segment,Average_Sales_Per_Order
111,53.4017
112,191.7180
113,690.6826
114,1592.2939
211,52.7618
212,188.2659
213,702.2393
214,1756.8305
311,52.1229
312,187.3654
313,674.6338
314,1745.6558
411,52.6091
412,186.3893
413,676.6303
414,1632.2116
```

This table shows the RFM segment each customer belongs to and their corresponding average sales per order. By analyzing these segments, we can observe differences in purchasing behaviors across customer groups.

```sql
WITH max_date AS (
  SELECT MAX("order_purchase_timestamp") AS "max_date"
  FROM "orders"
  WHERE "order_status" = 'delivered'
),
customer_rfm AS (
  SELECT
    o."customer_id",
    -- Calculate Recency
    ROUND(julianday((SELECT "max_date" FROM max_date)) - julianday(MAX(o."order_purchase_timestamp")), 0) AS "Recency",
    -- Calculate Frequency
    COUNT(DISTINCT o."order_id") AS "Frequency",
    -- Calculate Monetary Value
    SUM(oi."price") AS "Monetary"
  FROM "orders" o
  JOIN "order_items" oi ON o."order_id" = oi."order_id"
  WHERE o."order_status" = 'delivered'
  GROUP BY o."customer_id"
),
rfm_scores AS (
  SELECT
    cr."customer_id",
    cr."Recency",
    cr."Frequency",
    cr."Monetary",
    -- Assign Recency Score
    CASE
      WHEN cr."Recency" <= 30 THEN 4
      WHEN cr."Recency" <= 60 THEN 3
      WHEN cr."Recency" <= 90 THEN 2
      ELSE 1
    END AS "R_Score",
    -- Assign Frequency Score
    CASE
      WHEN cr."Frequency" >= 4 THEN 4
      WHEN cr."Frequency" = 3 THEN 3
      WHEN cr."Frequency" = 2 THEN 2
      ELSE 1
    END AS "F_Score",
    -- Assign Monetary Score
    CASE
      WHEN cr."Monetary" >= 1000 THEN 4
      WHEN cr."Monetary" >= 500 THEN 3
      WHEN cr."Monetary" >= 100 THEN 2
      ELSE 1
    END AS "M_Score"
  FROM customer_rfm cr
),
rfm_segments AS (
  SELECT
    rs.*,
    -- Create RFM Segment by combining scores
    CAST(rs."R_Score" AS TEXT) || CAST(rs."F_Score" AS TEXT) || CAST(rs."M_Score" AS TEXT) AS "RFM_Segment",
    -- Calculate Average Sales per Order
    rs."Monetary" / rs."Frequency" AS "Average_Sales_Per_Order"
  FROM rfm_scores rs
)
SELECT
  "RFM_Segment",
  ROUND(AVG("Average_Sales_Per_Order"), 4) AS "Average_Sales_Per_Order"
FROM rfm_segments
GROUP BY "RFM_Segment"
ORDER BY "RFM_Segment";
```
2025-01-24 23:37:02 - root - INFO - itercount: 2
2025-01-24 23:37:02 - root - INFO - 0
2025-01-24 23:37:02 - root - INFO - Total iteration counts: 2
