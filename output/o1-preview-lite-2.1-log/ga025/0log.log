2025-01-30 00:57:56 - openai._base_client - INFO - Retrying request to /chat/completions in 0.460063 seconds
2025-01-30 00:59:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 00:59:09 - root - INFO - SQL:
SELECT DISTINCT `event_name`
FROM `firebase-public-project.analytics_153293282.events_*`
LIMIT 100
Results:
event_name
level_start
level_end
level_retry_quickplay
app_remove
use_extra_steps
dynamic_link_first_open
app_clear_data
level_complete_quickplay
select_content
session_start
os_update
in_app_purchase
spend_virtual_currency
first_open
level_complete
level_reset
firebase_campaign
challenge_accepted
user_engagement
level_fail_quickplay
completed_5_levels
challenge_a_friend
level_end_quickplay
level_reset_quickplay
app_update
dynamic_link_app_open
notification_foreground
ad_reward
post_score
level_start_quickplay
screen_view
level_up
level_retry
level_fail
app_exception
no_more_extra_steps
error

2025-01-30 00:59:15 - root - INFO - SQL:
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` = 'first_open'
  AND PARSE_DATE('%Y%m%d', `event_date`) BETWEEN DATE('2018-09-01') AND DATE('2018-09-30')
LIMIT 100
Results:
user_pseudo_id
C6928D8A0DAE782911786BF2C5614279
95234D51F359B9A809F5F63BC8AB85D8
B6084E4BDF1F19A277C07ACB37026177
11A3238DEAD2345528E617ACC82D2027
512B15BD20611092FEA7BF165B6F8A08
C1ACA74F84373468E10A08B1BF08455B
59C952AB04D797753C92608F0B32BD42
2927A9F548849C44AF989FAAA4392517
5902F784DB3A5034F7DD36525DC8EA26
04349A66448260F425871B01729CB6CC
DA924796CB7B5F19DA1E8FFA4C2AF328
5356FA0F1B89E60163B19C88905905E5
86E29652B3E743AF9DB8812104B797B6
E6540065D9F237697EA676931680F2B8
4BAD26C68B3F0EC7F290D5160E16AB16
1332D7B006A18428BB95274EE78DE6B1
481CB078689F876EDF2BA0BA2F2E3B5E
5D61E6AC342F01CDCAF3A20B02426C70
A51A3E253AE3F2668DC50CB1AE96D60E
7E6FA5CBE62BECB1CA50F83E4F2BD658
EFB2E29B3188FEE64E62E7B315C26780
C91F8F96E02CB9453FDDBBBE4B68B3A4
9EEF99CE81B3CB2D6AD1C850953E2871
89C5C03C730B8437CFFCCE050274D253
2DC473377FAF752C77B586711AA66A90
CD1D906FB130FF55A227F2DE79F0C15A
EEC7FA9B9E05990005FF736DCCADC24A
46667B8A61C1573787AD6A645BE51C5B
8E9EB6DAEE98975E317428326DF60EC9
AED41960DDA933F8914955C5EF2A852E
CD32700CF86F9099A2FC2DFCEC24AC74
7CD073786A14675FA7B0A29337809B2C
E5543EF6E46BE7F397A7C8E4D949DEB7
B50DFAF00285254A92671B5CB91D972D
BB4DF405F6E90DC7E740CA1DFD9A8728
8890D41BD0584E02AD32F1E1F32D5414
50819623BDF347C3C7DCAF0D9F5C0730
CAB801638B9B8022310A07629D49EBCA
57A64EB2ABD60937979A683D71025060
E895B3E36F911B1ADA1C93A648487F75
14CDD9706D24046F309F81C86687A25C
4C8514033B25A1B49E85B8C0240C6C3F
2A35FB32E49C15CB17729B04D7E80F02
14A9CF9481040494BB3D4D5851457F4A
06651B7BD90A9520B007ECEBF08EE9D6
7DADFD59DDC317F8A6931C1544AA10D9
E6BD402E986856BE45A107744EA310EC
4A265CA54699214E64E300A0587DF907
1611A8EAF92912A6AE4289CE15EB7411
D02E16495F73B6EF3C4846253C6B9721
B1FE899BA05B7808B5535F23BB866E3C
C3BE30F17AF22F7BA9E348840EB9FB6E
A16FE20350BB277037EAFE6DF4DB1CBC
AFF1ED962C29150288A2946235923125
D51469D355F87944B051338289697AE6
2F5BD1921856273F7949A24ABB385A4D
DFD440E5A6ED9EB7BEE70013C9CB82DE
8754F52C637D0A533A33EB702FADECDD
3DFC3A755FB6E6BDE49250DF5D6FF180
3F512C35009AAC06F811B31413462B45
242B37810A135CF0A8CA54D6B21D3250
9F162037940FC15E9F3A3E9DFCA4D2AE
B55214B5A1824143E51A3977B2563A18
702682445AD2EEE821353CE661800AE0
C40F22701672A6B7AFF9F4F6FBC235EA
B3234CECCA15CEE80BDE39DA9D8AE687
09309F331FA528745E330964AF4AAAD8
05BD9AF611C45368C75EC68D84DA6DC8
0C5E8016F4E19EBF634A77113A1ACE00
A25F3BC7C453989DF4127EEAD4F3FDC6
4E246E12AC481377A56103BFDA4AEEEF
2E576595B5FF8D66CA224AFADAE588B4
2647E2B707BE004C03EE487685B75C77
5DD61074AA5F92DE0CE1F00516BFDBF5
8235CEF88E270F8C33F9218633A421FD
8EEA719A624599EE3D9B4473F1C99CBE
1CD1D85F7C39D7814EB1A4C55646D717
224B9D15731E3EA41830FB5E67E336AC
1F907E1A794D08899DF8DEDCA4A0BE53
CDB12CED18D01A0CC6AAF15D0A277DF9
ABB9A6AD029F190506DCF3B87C27E9BC
4EADDFEFFF468661CE4EEE680514BEE2
A442D7F9DA27C9F49919933DC0023738
23DD04F65B2097608958AF503FD06892
7DFC677A7E3FB2E644F40FF5EFF901D3
E76CBA449ABC6D410CD8B174EE1150C7
2223033CF9964E05E4045421FFFC8918
9EAAC1C6222FFE3D209C02C81C20F2A2
376E71CB4C92528ABE7D6FDC9CBCDA09
625CF86657E00A4629BCE49F5B31A144
F69F53A9BE23937F3528CC840C4958D4
C65B4227D3BC9EAC53DA13D73ACD2543
B6F60284DE6FD9D98BE07E37EE989CBE

2025-01-30 00:59:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 00:59:37 - root - INFO - ```sql
SELECT `user_pseudo_id`, `event_timestamp`, `event_date`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` = 'app_remove'
LIMIT 100
```
2025-01-30 01:00:44 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 01:00:44 - root - INFO - SQL:
SELECT `user_pseudo_id`, `event_timestamp`, `event_date`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` = 'app_remove'
LIMIT 100
Results:
user_pseudo_id,event_timestamp,event_date
ABF9D98DA2369F92465B0999E8F3209A,1533027529228000,20180731
86C65934EDF946EBA8153BF74F0D55CE,1533062679305237,20180731
3E1C51353A2BF5684592B09F75E76873,1533103394220000,20180731
EDCD15D75FBFF7F1A0BCFEED11D86306,1533070982517000,20180731
69EE9FDF2F2C5A503484DD212696667B,1533103267937005,20180731
16F21707AB536E83A9CE8EABDB5C4E95,1533094554262000,20180731
766CE63AC5F8D5E3F690DB289B5347B7,1533058211244000,20180731
8032DC7D2C74BDA691A96F2502EE6002,1533075946455000,20180731
AF3B84D80B1A8A0C9CC2587252CC7048,1533031538261001,20180731
D085B6D6AEEA6314350B46AE987CD114,1533030462332030,20180731
FB1F87054CBD0625890297427AAAD990,1533079847913000,20180731
59279CC4C897051599F544C19F5A623D,1533072390967012,20180731
F30AAA5143694682000C553122AD15AB,1533036261267000,20180731
9D0C09CBAF30B0F179FF4F1B61679458,1533094711656000,20180731
1F40258A3B62E43C498D602201A7D9E0,1533058528419000,20180731
B891FB3B934244C19C73ADD9883B509D,1533060333079004,20180731
36EE4F03C639EC236E6BE9880B83ABAA,1533074656282000,20180731
FA1CBA7312F0DDF83E2EE1573E400043,1533070240190026,20180731
2A7EEC4B71E9E97EFD6504A7D57931FF,1533061906550017,20180731
9C480845A4CA91E1B4A794B6AEF425BC,1533060009810002,20180731
CEA92F03E8510B434A70984A6E255308,1533094488481016,20180731
C7225BD7DA8FC35F0418008067118D78,1533082874189000,20180731
172BED0C5894B034944ADE3FD13B9DDE,1533057027485000,20180731
76632219C629CAC04FA90E22A4F2AE64,1533072354421032,20180731
B61FDDD57DA47BA00E14707352203938,1533033508413000,20180731
9298E088B9BA5DFBFE729E55C9F4D132,1533042757457000,20180731
31FE3578985C855CE7FB123A32602FFC,1533083934274000,20180731
7111DE02896BEAD523646A9D80ABD049,1533078736527013,20180731
C08FA7B37167EDDCDDBA175E35FF4DD9,1533070577293000,20180731
1290BCB61140CAF8CE8A5E8FFBEF16B2,1533089406303026,20180731
37A4A5CCEE0FD6189187EDFF41C6F413,1533098636776006,20180731
383B0A28DC5E19F0B9014C8D89F36F1C,1533077859840000,20180731
9F2DD83499296F30A77F98E97B35985B,1533075312191000,20180731
A695441A11F541F6480139BE099C2D1B,1533105019747004,20180731
2FCD876603363FFDE5239ED45BE6B905,1533029372411000,20180731
28BAFBF9921B80B84EF45326F2CF9746,1533050033683000,20180731
31A81B7189F8AA8BADD3FC2D3EAE48D4,1533020883443000,20180731
A66F0780425463039996F43FD8082D75,1533071246354000,20180731
72A16804AD58C57A5CA193F91CD9F995,1529894134109000,20180624
0393E8CD10D9BAF3E2F06D31395151E6,1529864490472004,20180624
1C344B7F5FB0E6B5588212C820C2F896,1529855606881000,20180624
906CE0DA38E7D9DE597CA459CC907950,1529898602602000,20180624
5D0EEF4390FA404202D864AEAB30DF35,1529868380063030,20180624

2025-01-30 01:00:52 - root - INFO - SQL:
SELECT DISTINCT AE.`user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*` AE
WHERE AE.`event_name` = 'app_exception'
  AND DATE(TIMESTAMP_MICROS(AE.`user_first_touch_timestamp`)) BETWEEN DATE('2018-09-01') AND DATE('2018-09-30')
LIMIT 100
Results:
user_pseudo_id
382B7E4C3513E0B32AD100ABCC15B917
3C70D01246600BA32125AF44750B2014
486D0900B48B18D315367260129BFFB6
386EE7D00E029293C53C2ED7319EF520
3F9A72FBDB9E11A90E0AD33265CBB1F3
BD5A3594B390BA8DD9489C06CBD73ADE
0A74C26349ABD323C5CE34AB8DD52164
78A7C7D9BC2138200C3B37E3C7CA8CE8
3249B63899BAEA78F4DF487994C108EE
3983B79EE1ECAC145E3688021745D894
F24BBD36208042C587CEEFBF6951AA2B
E146F217FF7F711C9AB1461342FA8EC8
F488B4536BA104FE39ED63F2D4959B9C
B51FED7F1C67B068DDC84959FE0E14DB
96685CED0793A219EFE8976477D7DA56
2779422065F5685DFCBC3179B5E6E38F
00B6D40595249C8532BCA9846389C411
9F8D4A18FC571082BD1D7AA5597756AD
72AC12CE2E2F425A2546D18F14B0077A
EA62196C3CD3A168761EDF851C44D293
B33F9AF7B23A856F6F23426B1AE94926
3B8B6295198F4D19C6FDCCC61D9A76C2
050231DF01854EFA691E0D5F4DB9ADB2
D9E0B99D114ACD55A2349149F3BC96F7
3E8245CE87EEDBDF995B682A717AE2FC
A622BBB66D14F224D949A6A86B87D4BA
38EC067E0FD1205E85B7922DEA496A50
FE4A220061DD4F9A25167AA519CD0620
44ED38A539DE12288621EA8C2C79C318
1756558602A5C14A5DD2AD4B696D2191
747538074CEC9FE551F488F3E47F9FD9
26F3A02677C6F21DFE2A00C213662D8D
9A46A573C1A4263A449716650F25ABFF
64D4FF2E08079BEEF31850948C79C5BF
9EAAC1C6222FFE3D209C02C81C20F2A2
11A3238DEAD2345528E617ACC82D2027
D31F0611DE6B94A5F001584286883AB7
4549717C06BAFE84FB1FFE5DDBD7EB2E
7B12B56BE42BA15EE493BDC9902B54E4
88D87254AD30B9DAB8DDD4447FA74B11
61A1C5F0C88099572CE914B2EE66C12F
361F3570C32F1CE252B63BA587E7BDDC
BD2F25C4375B34CD44952E51B37F3123
9664FAE9A17FD550BE78549EEA2773AC
879503A3ED5F2DCB6592E99C42E1BDFE
CCC7BB053BBC6824C53FAA4A8C63E3FE
F9EF5F13B83A4CA8C74C7ABD868F23D5
C96F1CB586725A7D165BCF665C131114
CC4F9BBD0104A39837B34D488E0EB689
6551148F681F9DF807FF3624EA5DEFA8
217732C20FF3F5F02EFDCA2BD1CE5220
FD807541F1DE049B5D16ED3EE2DCF160
E5E7576642F88625FEAC6606CE1DD50D
550A5DFB3871B30009BF48DE5EDCF918
1BB448F355B22AFE32A99DF1997D2D61
CF3F621F23B4C697E784B0998A1DB94E
ED0AF1301B6404476B420A990B98ABD7
E700BD83FAFB7509FE2F45F2D7554326
0554FA7236F2A6E3A86F54C72EDE441D
9A10BF8F0166076BD918A5027396A46B
23670FFEF0FFC29FF59EA8E1A82E3A93
9739CF7747700632F707FE234CEA7C00

2025-01-30 01:00:57 - root - INFO - SQL:
SELECT
  UN.`user_pseudo_id`,
  DATE_DIFF(
    TIMESTAMP_MICROS(UN.`event_timestamp`),
    TIMESTAMP_MICROS(UN.`user_first_touch_timestamp`),
    DAY
  ) AS days_to_uninstall
FROM `firebase-public-project.analytics_153293282.events_*` UN
WHERE UN.`event_name` = 'app_remove'
  AND DATE(TIMESTAMP_MICROS(UN.`user_first_touch_timestamp`)) BETWEEN DATE('2018-09-01') AND DATE('2018-09-30')
LIMIT 100
Results:
user_pseudo_id,days_to_uninstall
C7DD86F06FD4AA8A0967E27E20750FCD,6
63D8ACC080B6F91722C1ECD735FF3395,2
4A2A03B50BDA6AC1687703BD39A91E3E,6
3E8245CE87EEDBDF995B682A717AE2FC,0
9EAAC1C6222FFE3D209C02C81C20F2A2,0
10CD441F79B53D8F7E281C38ACBEE2C3,0
0E65A1967A3EE64A4D33E6038D677FAD,0
0E5DAB111CB3C0001C0019712A83CB49,0
F12F4F196933013F64399BF74945999B,0
B1C093A32996E59C0298E81A14398491,2
196CDAC439AE9EB9B70F6868A05FAD3D,5
E5E4C7E5600DD124D56BA0B0FF41B07C,0
70D2F634EB46DA3061AADBA078ADF7E9,0
58CAB99FE371CFE26EEFE32A9BEB9C96,0
3114BB0EE700894607B258BC4706797C,9
2E7493AC5967A8B48B8DEF79EDDFC056,0
AC14AD9D158A2A5449E120A33D5B55BB,0
337A3F347AE32CE90A631DF3028500A5,0
FF2D6D2366E710D0FBF8BF00D2081ADF,0
DFD440E5A6ED9EB7BEE70013C9CB82DE,0
1CDB183DBB7427164204AED3AEE70341,0
07D1A24DC2164260EEA5FB510C491431,0
14FC1A25D55E89AC7ECD600CD3A08C13,0
4EEE67C2E335213F6815144829801E0F,0
6D6EB70E837A5007BE550C44FF276440,0
97D9D96077AD3E8859BF5C54C873E59D,0
CEBA063FD7BF190D727CC948185CCEC8,0
5A66BC427F25EFFDFEDED4A07D8F9F91,0
37EFBD2BA398148336F96B4347392A8D,0
177C0BEFFC69408F88D3377632F1BB60,0
37034A23CAFF85394E2E349C381788A6,0
1E882F0B9818614D6E47620DD31229F1,0
551B893D34A2A59971B8FF185C1CD0C8,0
7AB9D5F7D122A38CA8769C9C93F3A12F,0
D6803CFD38D435F0364EB47684F7CCF6,0
B9D800D33FDCF7AF2157CB66910A0797,0
9E25C5FED0F3F775FBB2A5C76DD0511C,0
DAD134C77F7E09BC552E290534CB90E8,0
66788E34B6E292DE03B1B54E797CADBF,0
A5302213F1605BE400E8AA34992B18A8,0
D963E509346C0E5358ECFE56AF3BB2ED,0
1D5A0DC978A69FF28EC9D153F32EA871,0
2C15FFDEDDA69390B7A8EB5808FB7ED6,0
531E7B35DE9A21A1942F057C98B4E74C,0
C09F65F2853D03DE23CFD90F97429735,0
E0F1ED4167D0C0B2D6DCBA85CB020F52,0
E6E7FC8AC6D32935DA5ADCFFD14CC3A8,0
D8B77A575B5308D161F95ACF515F9772,0
8DEB6CB6C3E85D0032D8557C73ADD49F,0
A6E8B0AC5E066F7670116136442F728F,0
C945C989CF380E22E1B1E4B28E26801A,0
27C0BAADCE9520F17249A8B85F6477DA,0
1756558602A5C14A5DD2AD4B696D2191,13
B91D25D0A49511240F05AA56EFF1D985,22
8165B8A88DB3120D9C73A19779230F2A,2
7119284E9BA39CA0414A27EB2C0229D0,28
5B6161A5B8EAF9E04291EEAFEA188D12,7
A33AA9C2E129CCAE6C571C8C2CF05BB3,17
EF0F0BF78A51EB7065ED9135D5EC68F3,6
92FEE9540884CA75FDACA7154B4DDC41,17
AEA58269AB4082AA8A5A1BEF788C3178,15
61814C6B80D24FFDE5FEB59D61FD5B1C,0
5767C89378ACD5BE8A54CD7E8F495EBC,3
45F69B905EBE7D436F86CB5C0802D4BD,0
FEEAEF16683900608922225433583714,16

2025-01-30 01:01:02 - root - INFO - SQL:
SELECT `user_pseudo_id`, `event_params`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` = 'app_exception'
LIMIT 100
Results:
Too long, hard cut:
user_pseudo_id,event_params
295D9E24D8DE65A010313E667131EF19,"[{'key': 'fatal', 'value': {'string_value': None, 'int_value': 1, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'clx', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'timestamp', 'value': {'string_value': None, 'int_value': 1533289949985, 'float_value': None, 'double_value': None}}]"
295D9E24D8DE65A010313E667131EF19,"[{'key': 'fatal', 'value': {'string_value': None, 'int_value': 1, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'clx', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'timestamp', 'value': {'string_value': None, 'int_value': 1533334714580, 'float_value': None, 'double_value': None}}]"
CB284BFA662EC30C6D96E32278213CD4,"[{'key': 'fatal', 'value': {'string_value': None, 'int_value': 1, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_class', 'value': {'string_value': 'shop_menu', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'clx', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': 3873387604761179844, 'float_value': None, 'double_value': None}}, {'key': 'timestamp', 'value': {'string_value': None, 'int_value': 1533349829497, 'float_value': None, 'double_value': None}}]"
E6FEE8B98E75EA5311FE004F98559A27,"[{'key': 'fatal', 'value': {'string_value': None, 'int_value': 1, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_class', 'value': {'string_value': 'shop_menu', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'clx', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': 7621950203378871586, 'float_value': None, 'double_value': None}}, {'key': 'timestamp', 'value': {'string_value': None, 'int_value': 1533344960818, 'float_value': None, 'double_value': None}}]"
4D38AF508E466CDF5FF6FD9F93892F1E,"[{'key': 'fatal', 'value': {'string_value': None, 'int_value': 1, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_class', 'value': {'string_value': 'shop_menu', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'clx', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': -6229488674312060467, 'float_value': None, 'double_value': None}}, {'key': 'timestamp', 'value': {'string_value': None, 'int_value': 1533332428835, 'float_value': None, 'double_value': None}}]"
4BDC831A6940071E2461D0B5293A329E,"[{'key': 'fatal', 'value': {'string_value': None, 'int_value': 1, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'clx', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'timestamp', 'value': {'string_value': None, 'int_value': 1533343401533, 'float_value': None, 'double_value': None}}]"
C55BB3776BAF55E6BE0B1B35D95EFCFC,"[{'key': 'fatal', 'value': {'string_value': None, 'int_value': 1, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_class', 'value': {'string_value': 'shop_menu', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'clx', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': 6372571612156864580, 'float_value': None, 'double_value': None}}, {'key': 'timestamp', 'value': {'string_value': None, 'int_value': 1533297953773, 'float_value': None, 'double_value': None}}]"
C55BB3776BAF55E6BE0B1B35D95EFCFC,"[{'key': 'fatal', 'value': {'string_value': None, 'int_value': 1, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_class', 'value': {'string_value': 'shop_menu', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'clx', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': -119355106010806591, 'float_value': None, 'double_value': None}}, {'key': 'timestamp', 'value': {'string_value': None, 'int_value': 1533311995405, 'float_value': None, 'double_value': None}}]"
C55BB3776BAF55E6BE0B1B35D95EFCFC,"[{'key': 'fatal', 'value': {'string_value': None, 'int_value': 1, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_class', 'value': {'string_value': 'shop_menu', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'clx', 'int_value': None, 'flo

2025-01-30 01:01:09 - root - INFO - SQL:
SELECT DISTINCT UN.`user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*` UN
WHERE UN.`event_name` = 'app_remove'
  AND DATE(TIMESTAMP_MICROS(UN.`user_first_touch_timestamp`)) BETWEEN DATE('2018-09-01') AND DATE('2018-09-30')
  AND DATE_DIFF(
    TIMESTAMP_MICROS(UN.`event_timestamp`),
    TIMESTAMP_MICROS(UN.`user_first_touch_timestamp`),
    DAY
  ) <= 7
LIMIT 100
Results:
user_pseudo_id
78E9738DC83BE674052BD4621BB2F113
C5558CE95739F785A76DDC61DF770201
8FEAB3AAF7434731E003747C511F06DE
EF6D6B0B8836E4B95ED7D8FCBAF0BF6C
7705D52DD2286DC2E6DB831A2E129E94
6B743763D2790D33F26AFB5618307222
95B822BEFE16968B26474ECD045F731D
AB984DAD6BEE2584D4CCA718CB4A003F
BE042BC1484A69E1731FB487C1AD34B9
C1F519708675990E7A5FC68A65396327
F9231C977F262065AFA5F376C746E0ED
97380FCE77BAB6B251B50DDE4ABD8F8A
408354544760D27F10CCA7CF9B4E43D3
E9FCF9F1FDF7016CF79A30251B2FA52B
122B9693B647802ACC0727BF5A36F75E
64E3BBB507EEFDE76364031EADF502F4
DA00B61D3816AA1394092563865564E3
B79FEE3597E3C4A3B5A38FE33B684341
F37788083CD17FEF93F66A5A8CFA9BCD
41B8B6917AC3C354AC6A10CDC715FDDB
289290E298ED08B95B10DE971359B101
92400633510BB9E545007254608CF161
2C45FDF91F91AE8A3A9E6F119E8BED13
578CB14FCF0AB3CD15250A6991E76B91
4B4901F73C458F5462AED0D68571D88E
0969A1FA5300A40F4CFA6AE5BD539DE4
72D04A6D10CF624A03592099F6312E9B
FBAE40C1C6A2210AA29158BE6256FC5E
E5E4C7E5600DD124D56BA0B0FF41B07C
70D2F634EB46DA3061AADBA078ADF7E9
2C8294A0EF5FF73A6C43819F67D450F4
4C2614370EF19318C141072F3EBFB9EC
361F3570C32F1CE252B63BA587E7BDDC
95B590F12E8E14749D6634ACD4AF518F
A0130C6FFE82A4523C6F6E97EC0A9B02
88CE6B580698B1629E831342E186DD0C
5A66BC427F25EFFDFEDED4A07D8F9F91
1E882F0B9818614D6E47620DD31229F1
27C0BAADCE9520F17249A8B85F6477DA
860EFF376090269DF25684D8769DF55F
B5EE4A89792209060659C9A6719EA8A4
60A36D65D2C9A3DA5C804006972CCAF8
D0B47C51E0A61F1D0F25F05396D8ABA2
63D8ACC080B6F91722C1ECD735FF3395
46B0260D63886FE06AA496B3B0854694
625B68C757B6B3A4EF64BA934546FED6
989D5092D062D1B432BEB9C618B21431
69BB8289D391EEDAAB396DA0C3F8FF1D
289D738E3B01C988983B957444571412
350EE49AD4A5D94271B68547943EA11C
BD76FA48CAC77875E95CCF0E142E4353
C1483F477709CE11455CE0E9E46E597A
D234FFF7508E1D6E24E3CE1A5AE5F0E1
99AEF7972E0B774A904B5F2839FC09B0
9A7C4451BAE83D1EEB969C0DAEB7917B
573258C3C79B7B051448BAC4407F8099
33469F822404E8FFAE1B545FD5427886
C8D74BCA384C771A8D916972C4B214C0
1A5626295FB0D5F841E0B877354619D4
75711C3113A09A2976DAA5A0D8C3E84D
D6803CFD38D435F0364EB47684F7CCF6
531E7B35DE9A21A1942F057C98B4E74C
E6E7FC8AC6D32935DA5ADCFFD14CC3A8
AAE4779C1A0F48E482C71DE95A4FA0E1
EB4432A4BDAAB8F5135FCB36503ADC7D
66AFD4A2B8BC073FC2021F5C42CC7C86
78510CA2B9355AEB78FF0A52A7811B79
CA9136455F325D81B4A1FC232A7CCE43
4242F3099015CEED6E973B209C3C48BE
492F7F04FA27A466D29C9C0FE7D0E843
21FD52300AE0FBAB4C95D6D470E471D2
8F780847855ADB932B0121C7278F375F
C7DD86F06FD4AA8A0967E27E20750FCD
0E65A1967A3EE64A4D33E6038D677FAD
80FC9DC8D2C527192F27DBC2A449FA26
B175B187062693360BCBADC4160F8D88
0150077AE685E3084E5DB84CF61CE383
F3E963D579925992BE2DF84991C979FA
C8C37FE99773C84625B1569515B491F2
CF3F621F23B4C697E784B0998A1DB94E
DFD487F27AEE9B027FFD4E736306279E
AB34C2DC3FDFA61951DFCD3831F38723
433E34F1BFEEF8A34A78D2C73D3AA014
4293BE87C4C4EE3249F6DCA7A27A866C
DCD1CD667669877B4D4E6D6FD7CFE848
5C7FB72A7CD89D7C56DCB2B71C91ECE9
AA137B66E1975E5B854D7A786BDBC380
A7E12AF359CFF4A23F85F9A6E848CF60
07D1A24DC2164260EEA5FB510C491431
2ED35AC1D18D24AD6144985A6BADD694
C552986AF8B757F3F7E518740ECD738A
37B003197370E8FB7DA7A2FA4ED09427
B538D05509793202091BD234EDF9F4BB

2025-01-30 01:01:15 - root - INFO - SQL:
SELECT COUNT(DISTINCT `user_pseudo_id`) AS total_new_users
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` = 'first_open'
  AND PARSE_DATE('%Y%m%d', `event_date`) BETWEEN DATE('2018-09-01') AND DATE('2018-09-30')
Results:
total_new_users
1349

2025-01-30 01:01:22 - root - INFO - SQL:
SELECT `user_pseudo_id`, `event_date`, `event_timestamp`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` = 'app_exception'
LIMIT 100
Results:
user_pseudo_id,event_date,event_timestamp
77F5E9A5630151C9E831156AEAB4DA11,20180723,1532359337313003
AB32482D193E2CE166B59F82EF78D8BB,20180723,1532370888724002
AB32482D193E2CE166B59F82EF78D8BB,20180723,1532371314762017
1B2FC37816CC4DDAACA97A75E685756F,20180723,1532400110362002
2C84CF723999D48F8F069AFFC184C4DC,20180723,1532332885028003
0CAAA1B6F161BA4D363EB7A2DEF64A08,20180723,1532392257730002
0F668D1FE72425834C6A5EE9F4F53BCD,20180723,1532379318341003
B5F3D00E28A57C9522F2DEE3CB903DD1,20180723,1532388429484051
B5F3D00E28A57C9522F2DEE3CB903DD1,20180723,1532388540581003
B5F3D00E28A57C9522F2DEE3CB903DD1,20180723,1532388653693003
91D637F0D9FB259AD52773B1B20151BE,20180723,1532406416663002
39BE7CAB9B8602ABD10A1BFB4E66BBB2,20180723,1532362818219054
E080406D26F71C9B8F331779CE8B82BA,20180723,1532366204103003
959635567E419A061EECCCA478EDC718,20180723,1532329280034002
959635567E419A061EECCCA478EDC718,20180723,1532374791255015
959635567E419A061EECCCA478EDC718,20180723,1532374809230011
959635567E419A061EECCCA478EDC718,20180723,1532374867514010
959635567E419A061EECCCA478EDC718,20180723,1532374875591010
959635567E419A061EECCCA478EDC718,20180723,1532374955011029
959635567E419A061EECCCA478EDC718,20180723,1532375099456010
959635567E419A061EECCCA478EDC718,20180723,1532375233983011
959635567E419A061EECCCA478EDC718,20180723,1532375366706010
959635567E419A061EECCCA478EDC718,20180723,1532375507339014
959635567E419A061EECCCA478EDC718,20180723,1532375571518029
959635567E419A061EECCCA478EDC718,20180723,1532375594257010
959635567E419A061EECCCA478EDC718,20180723,1532375688531010
959635567E419A061EECCCA478EDC718,20180723,1532375698503010
959635567E419A061EECCCA478EDC718,20180723,1532375742214010
959635567E419A061EECCCA478EDC718,20180723,1532375933965032
959635567E419A061EECCCA478EDC718,20180723,1532376012051010
959635567E419A061EECCCA478EDC718,20180723,1532376047017002
959635567E419A061EECCCA478EDC718,20180723,1532376098091028
959635567E419A061EECCCA478EDC718,20180723,1532376167960019
959635567E419A061EECCCA478EDC718,20180723,1532393778042011
959635567E419A061EECCCA478EDC718,20180723,1532393767120011
959635567E419A061EECCCA478EDC718,20180723,1532393845722009
959635567E419A061EECCCA478EDC718,20180723,1532393803925008
959635567E419A061EECCCA478EDC718,20180723,1532393991232039
959635567E419A061EECCCA478EDC718,20180723,1532394061389009
959635567E419A061EECCCA478EDC718,20180723,1532394207650045
959635567E419A061EECCCA478EDC718,20180723,1532394303901008
959635567E419A061EECCCA478EDC718,20180723,1532394327475009
959635567E419A061EECCCA478EDC718,20180723,1532394336622010

2025-01-30 01:01:28 - root - INFO - SQL:
SELECT DISTINCT UN.`user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*` UN
JOIN `firebase-public-project.analytics_153293282.events_*` AE
  ON UN.`user_pseudo_id` = AE.`user_pseudo_id`
WHERE UN.`event_name` = 'app_remove'
  AND AE.`event_name` = 'app_exception'
  AND DATE(TIMESTAMP_MICROS(UN.`user_first_touch_timestamp`)) BETWEEN DATE('2018-09-01') AND DATE('2018-09-30')
  AND DATE_DIFF(
    TIMESTAMP_MICROS(UN.`event_timestamp`),
    TIMESTAMP_MICROS(UN.`user_first_touch_timestamp`),
    DAY
  ) <= 7
LIMIT 100
Results:
user_pseudo_id
361F3570C32F1CE252B63BA587E7BDDC
9EAAC1C6222FFE3D209C02C81C20F2A2
9664FAE9A17FD550BE78549EEA2773AC
CF3F621F23B4C697E784B0998A1DB94E
F24BBD36208042C587CEEFBF6951AA2B
747538074CEC9FE551F488F3E47F9FD9
23670FFEF0FFC29FF59EA8E1A82E3A93
9A10BF8F0166076BD918A5027396A46B
3E8245CE87EEDBDF995B682A717AE2FC
A622BBB66D14F224D949A6A86B87D4BA

2025-01-30 01:01:28 - root - INFO - itercount: 0
2025-01-30 01:01:28 - root - INFO - Database Name: firebase-public-project
Schema Name: analytics_153293282
DDL describes table information.
,0
table_name,events_20180801
ddl,"CREATE TABLE `firebase-public-project.analytics_153293282.events_20180801`
(
  event_date STRING,
  event_timestamp INT64,
  event_name STRING,
  event_params ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64>>>,
  event_previous_timestamp INT64,
  event_value_in_usd FLOAT64,
  event_bundle_sequence_id INT64,
  event_server_timestamp_offset INT64,
  user_id STRING,
  user_pseudo_id STRING,
  user_properties ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64, set_timestamp_micros INT64>>>,
  user_first_touch_timestamp INT64,
  user_ltv STRUCT<revenue FLOAT64, currency STRING>,
  device STRUCT<category STRING, mobile_brand_name STRING, mobile_model_name STRING, mobile_marketing_name STRING, mobile_os_hardware_model STRING, operating_system STRING, operating_system_version STRING, vendor_id STRING, advertising_id STRING, language STRING, is_limited_ad_tracking STRING, time_zone_offset_seconds INT64>,
  geo STRUCT<continent STRING, country STRING, region STRING, city STRING>,
  app_info STRUCT<id STRING, version STRING, install_store STRING, firebase_app_id STRING, install_source STRING>,
  traffic_source STRUCT<name STRING, medium STRING, source STRING>,
  stream_id STRING,
  platform STRING
);"

Some other tables have the similar structure: ['events_20180801', 'events_20180621', 'events_20180616', 'events_20180912', 'events_20180814', 'events_20180716', 'events_20181003', 'events_20180620', 'events_20180624', 'events_20180918', 'events_20180612', 'events_20180911', 'events_20180724', 'events_20180807', 'events_20180710', 'events_20180808', 'events_20180702', 'events_20180719', 'events_20180914', 'events_20180913', 'events_20180915', 'events_20180728', 'events_20180817', 'events_20180628', 'events_20180906', 'events_20180704', 'events_20180711', 'events_20180720', 'events_20180706', 'events_20180926', 'events_20180924', 'events_20180731', 'events_20180804', 'events_20180920', 'events_20180715', 'events_20180709', 'events_20180928', 'events_20180904', 'events_20180903', 'events_20180818', 'events_20180820', 'events_20180707', 'events_20180930', 'events_20180821', 'events_20180812', 'events_20180830', 'events_20180908', 'events_20180708', 'events_20180910', 'events_20180922', 'events_20180713', 'events_20180618', 'events_20180811', 'events_20181001', 'events_20180626', 'events_20180828', 'events_20180717', 'events_20180806', 'events_20180721', 'events_20180725', 'events_20180824', 'events_20180923', 'events_20180627', 'events_20180726', 'events_20180729', 'events_20180929', 'events_20180925', 'events_20180722', 'events_20180630', 'events_20180730', 'events_20180831', 'events_20180701', 'events_20180619', 'events_20180810', 'events_20180822', 'events_20180921', 'events_20180819', 'events_20180927', 'events_20180905', 'events_20180816', 'events_20180622', 'events_20180802', 'events_20180826', 'events_20180714', 'events_20180901', 'events_20180916', 'events_20180809', 'events_20181002', 'events_20180703', 'events_20180617', 'events_20180902', 'events_20180625', 'events_20180827', 'events_20180805', 'events_20180825', 'events_20180919', 'events_20180917', 'events_20180705', 'events_20180613', 'events_20180907', 'events_20180909', 'events_20180727', 'events_20180813', 'events_20180614', 'events_20180623', 'events_20180829', 'events_20180615', 'events_20180712', 'events_20180718', 'events_20180815', 'events_20180629', 'events_20180803', 'events_20180823', 'events_20180723']
External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180612', 'events_20180613', 'events_20180614', 'events_20180615', 'events_20180616', 'events_20180617', 'events_20180618', 'events_20180619', 'events_20180620', 'events_20180621', 'events_20180622', 'events_20180623', 'events_20180624', 'events_20180625', 'events_20180626', 'events_20180627', 'events_20180628', 'events_20180629', 'events_20180630', 'events_20180701', 'events_20180702', 'events_20180703', 'events_20180704', 'events_20180705', 'events_20180706', 'events_20180707', 'events_20180708', 'events_20180709', 'events_20180710', 'events_20180711', 'events_20180712', 'events_20180713', 'events_20180714', 'events_20180715', 'events_20180716', 'events_20180717', 'events_20180718', 'events_20180719', 'events_20180720', 'events_20180721', 'events_20180722', 'events_20180723', 'events_20180724', 'events_20180725', 'events_20180726', 'events_20180727', 'events_20180728', 'events_20180729', 'events_20180730', 'events_20180731', 'events_20180801', 'events_20180802', 'events_20180803', 'events_20180804', 'events_20180805', 'events_20180806', 'events_20180807', 'events_20180808', 'events_20180809', 'events_20180810', 'events_20180811', 'events_20180812', 'events_20180813', 'events_20180814', 'events_20180815', 'events_20180816', 'events_20180817', 'events_20180818', 'events_20180819', 'events_20180820', 'events_20180821', 'events_20180822', 'events_20180823', 'events_20180824', 'events_20180825', 'events_20180826', 'events_20180827', 'events_20180828', 'events_20180829', 'events_20180830', 'events_20180831', 'events_20180901', 'events_20180902', 'events_20180903', 'events_20180904', 'events_20180905', 'events_20180906', 'events_20180907', 'events_20180908', 'events_20180909', 'events_20180910', 'events_20180911', 'events_20180912', 'events_20180913', 'events_20180914', 'events_20180915', 'events_20180916', 'events_20180917', 'events_20180918', 'events_20180919', 'events_20180920', 'events_20180921', 'events_20180922', 'events_20180923', 'events_20180924', 'events_20180925', 'events_20180926', 'events_20180927', 'events_20180928', 'events_20180929', 'events_20180930', 'events_20181001', 'events_20181002', 'events_20181003']}}
Begin Exploring Related Columns
**Relevant Columns and Their Potential Usage:**

1. **`user_first_touch_timestamp`**: Used to identify users who first opened the app in September 2018 by converting the timestamp to a date.

2. **`event_name`**: Used to identify specific events such as `'first_open'`, `'app_exception'` (app crash), and possibly `'app_uninstall'` or `'app_remove'` (uninstall events).

3. **`event_timestamp`**: Used to calculate the time difference between events, such as between the first open and uninstall events.

4. **`user_pseudo_id`**: A unique identifier for users to track their events across different days.

5. **`event_date`**: The date of the event in `STRING` format, useful for filtering events on specific dates.

6. **`event_params`**: Contains additional details about events, which might include information relevant to crashes or uninstalls.

**Conditions That May Be Used:**

- **Users who first opened the app in September 2018**: Filter `user_first_touch_timestamp` to dates between `'2018-09-01'` and `'2018-09-30'`.
  
- **Users who uninstalled within seven days of first open**: Calculate the difference between `event_timestamp` of uninstall events and `user_first_touch_timestamp` to be less than or equal to 7 days.

- **Users who experienced an app crash**: Identify users with `event_name` equal to `'app_exception'`.

- **Events within a specific date range**: Use `PARSE_DATE` on `event_date` to filter events.

---

**BigQuery SQL Queries:**

Below are 10 different SQL queries to explore and understand the relevant data.

---

1. **List distinct event names to identify possible uninstall and crash events:**

```sql
SELECT DISTINCT `event_name`
FROM `firebase-public-project.analytics_153293282.events_*`
LIMIT 100
```

---

2. **Retrieve users who first opened the app in September 2018:**

```sql
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` = 'first_open'
  AND PARSE_DATE('%Y%m%d', `event_date`) BETWEEN DATE('2018-09-01') AND DATE('2018-09-30')
LIMIT 100
```

---

3. **Get event timestamps for 'app_uninstall' events (if such events exist):**

```sql
SELECT `user_pseudo_id`, `event_timestamp`, `event_date`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` = 'app_uninstall'
LIMIT 100
```

---

4. **Find users who experienced an app crash ('app_exception') after first opening the app in September 2018:**

```sql
SELECT DISTINCT AE.`user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*` AE
WHERE AE.`event_name` = 'app_exception'
  AND AE.`user_pseudo_id` IN (
    SELECT DISTINCT FO.`user_pseudo_id`
    FROM `firebase-public-project.analytics_153293282.events_*` FO
    WHERE FO.`event_name` = 'first_open'
      AND PARSE_DATE('%Y%m%d', FO.`event_date`) BETWEEN DATE('2018-09-01') AND DATE('2018-09-30')
  )
LIMIT 100
```

---

5. **Calculate the number of days between the first open and uninstall events for users:**

```sql
SELECT
  UN.`user_pseudo_id`,
  DATE_DIFF(
    TIMESTAMP_MICROS(UN.`event_timestamp`),
    TIMESTAMP_MICROS(FO.`user_first_touch_timestamp`),
    DAY
  ) AS days_to_uninstall
FROM `firebase-public-project.analytics_153293282.events_*` UN
JOIN `firebase-public-project.analytics_153293282.events_*` FO
ON UN.`user_pseudo_id` = FO.`user_pseudo_id`
WHERE UN.`event_name` = 'app_uninstall'
  AND FO.`event_name` = 'first_open'
  AND PARSE_DATE('%Y%m%d', FO.`event_date`) BETWEEN DATE('2018-09-01') AND DATE('2018-09-30')
LIMIT 100
```

---

6. **Extract event parameters from 'app_exception' events to understand crash details:**

```sql
SELECT `user_pseudo_id`, `event_params`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` = 'app_exception'
LIMIT 100
```

---

7. **Identify users who uninstalled within seven days of first use in September 2018:**

```sql
SELECT DISTINCT UN.`user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*` UN
WHERE UN.`event_name` = 'app_uninstall'
  AND UN.`user_pseudo_id` IN (
    SELECT FO.`user_pseudo_id`
    FROM `firebase-public-project.analytics_153293282.events_*` FO
    WHERE FO.`event_name` = 'first_open'
      AND PARSE_DATE('%Y%m%d', FO.`event_date`) BETWEEN DATE('2018-09-01') AND DATE('2018-09-30')
      AND DATE_DIFF(
        TIMESTAMP_MICROS(UN.`event_timestamp`),
        TIMESTAMP_MICROS(FO.`user_first_touch_timestamp`),
        DAY
      ) <= 7
  )
LIMIT 100
```

---

8. **Count the number of users who first opened the app in September 2018:**

```sql
SELECT COUNT(DISTINCT `user_pseudo_id`) AS total_new_users
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` = 'first_open'
  AND PARSE_DATE('%Y%m%d', `event_date`) BETWEEN DATE('2018-09-01') AND DATE('2018-09-30')
LIMIT 100
```

---

9. **Get event dates for 'app_exception' events to see when crashes are occurring:**

```sql
SELECT `user_pseudo_id`, `event_date`, `event_timestamp`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` = 'app_exception'
LIMIT 100
```

---

10. **Find users who both uninstalled within seven days and experienced a crash:**

```sql
SELECT DISTINCT UN.`user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*` UN
WHERE UN.`event_name` = 'app_uninstall'
  AND UN.`user_pseudo_id` IN (
    SELECT AE.`user_pseudo_id`
    FROM `firebase-public-project.analytics_153293282.events_*` AE
    WHERE AE.`event_name` = 'app_exception'
  )
  AND UN.`user_pseudo_id` IN (
    SELECT FO.`user_pseudo_id`
    FROM `firebase-public-project.analytics_153293282.events_*` FO
    WHERE FO.`event_name` = 'first_open'
      AND PARSE_DATE('%Y%m%d', FO.`event_date`) BETWEEN DATE('2018-09-01') AND DATE('2018-09-30')
      AND DATE_DIFF(
        TIMESTAMP_MICROS(UN.`event_timestamp`),
        TIMESTAMP_MICROS(FO.`user_first_touch_timestamp`),
        DAY
      ) <= 7
  )
LIMIT 100
```

---

**Note:** If the uninstall event names (`'app_uninstall'` or `'app_remove'`) do not exist in the data, you may need to infer uninstalls by identifying users who stopped generating events within seven days after the first open event. However, detecting uninstalls accurately without explicit uninstall events can be challenging.

These queries help in understanding the distribution of events and the relationships between first opens, crashes, and uninstalls, which are essential for calculating the required percentage.Query:
SELECT DISTINCT `event_name`
FROM `firebase-public-project.analytics_153293282.events_*`
LIMIT 100
Answer:
event_name
level_start
level_end
level_retry_quickplay
app_remove
use_extra_steps
dynamic_link_first_open
app_clear_data
level_complete_quickplay
select_content
session_start
os_update
in_app_purchase
spend_virtual_currency
first_open
level_complete
level_reset
firebase_campaign
challenge_accepted
user_engagement
level_fail_quickplay
completed_5_levels
challenge_a_friend
level_end_quickplay
level_reset_quickplay
app_update
dynamic_link_app_open
notification_foreground
ad_reward
post_score
level_start_quickplay
screen_view
level_up
level_retry
level_fail
app_exception
no_more_extra_steps
error
Query:
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` = 'first_open'
  AND PARSE_DATE('%Y%m%d', `event_date`) BETWEEN DATE('2018-09-01') AND DATE('2018-09-30')
LIMIT 100
Answer:
user_pseudo_id
C6928D8A0DAE782911786BF2C5614279
95234D51F359B9A809F5F63BC8AB85D8
B6084E4BDF1F19A277C07ACB37026177
11A3238DEAD2345528E617ACC82D2027
512B15BD20611092FEA7BF165B6F8A08
C1ACA74F84373468E10A08B1BF08455B
59C952AB04D797753C92608F0B32BD42
2927A9F548849C44AF989FAAA4392517
5902F784DB3A5034F7DD36525DC8EA26
04349A66448260F425871B01729CB6CC
DA924796CB7B5F19DA1E8FFA4C2AF328
5356FA0F1B89E60163B19C88905905E5
86E29652B3E743AF9DB8812104B797B6
E6540065D9F237697EA676931680F2B8
4BAD26C68B3F0EC7F290D5160E16AB16
1332D7B006A18428BB95274EE78DE6B1
481CB078689F876EDF2BA0BA2F2E3B5E
5D61E6AC342F01CDCAF3A20B02426C70
A51A3E253AE3F2668DC50CB1AE96D60E
7E6FA5CBE62BECB1CA50F83E4F2BD658
EFB2E29B3188FEE64E62E7B315C26780
C91F8F96E02CB9453FDDBBBE4B68B3A4
9EEF99CE81B3CB2D6AD1C850953E2871
89C5C03C730B8437CFFCCE050274D253
2DC473377FAF752C77B586711AA66A90
CD1D906FB130FF55A227F2DE79F0C15A
EEC7FA9B9E05990005FF736DCCADC24A
46667B8A61C1573787AD6A645BE51C5B
8E9EB6DAEE98975E317428326DF60EC9
AED41960DDA933F8914955C5EF2A852E
CD32700CF86F9099A2FC2DFCEC24AC74
7CD073786A14675FA7B0A29337809B2C
E5543EF6E46BE7F397A7C8E4D949DEB7
B50DFAF00285254A92671B5CB91D972D
BB4DF405F6E90DC7E740CA1DFD9A8728
8890D41BD0584E02AD32F1E1F32D5414
50819623BDF347C3C7DCAF0D9F5C0730
CAB801638B9B8022310A07629D49EBCA
57A64EB2ABD60937979A683D71025060
E895B3E36F911B1ADA1C93A648487F75
14CDD9706D24046F309F81C86687A25C
4C8514033B25A1B49E85B8C0240C6C3F
2A35FB32E49C15CB17729B04D7E80F02
14A9CF9481040494BB3D4D5851457F4A
06651B7BD90A9520B007ECEBF08EE9D6
7DADFD59DDC317F8A6931C1544AA10D9
E6BD402E986856BE45A107744EA310EC
4A265CA54699214E64E300A0587DF907
1611A8EAF92912A6AE4289CE15EB7411
D02E16495F73B6EF3C4846253C6B9721
B1FE899BA05B7808B5535F23BB866E3C
C3BE30F17AF22F7BA9E348840EB9FB6E
A16FE20350BB277037EAFE6DF4DB1CBC
AFF1ED962C29150288A2946235923125
D51469D355F87944B051338289697AE6
2F5BD1921856273F7949A24ABB385A4D
DFD440E5A6ED9EB7BEE70013C9CB82DE
8754F52C637D0A533A33EB702FADECDD
3DFC3A755FB6E6BDE49250DF5D6FF180
3F512C35009AAC06F811B31413462B45
242B37810A135CF0A8CA54D6B21D3250
9F162037940FC15E9F3A3E9DFCA4D2AE
B55214B5A1824143E51A3977B2563A18
702682445AD2EEE821353CE661800AE0
C40F22701672A6B7AFF9F4F6FBC235EA
B3234CECCA15CEE80BDE39DA9D8AE687
09309F331FA528745E330964AF4AAAD8
05BD9AF611C45368C75EC68D84DA6DC8
0C5E8016F4E19EBF634A77113A1ACE00
A25F3BC7C453989DF4127EEAD4F3FDC6
4E246E12AC481377A56103BFDA4AEEEF
2E576595B5FF8D66CA224AFADAE588B4
2647E2B707BE004C03EE487685B75C77
5DD61074AA5F92DE0CE1F00516BFDBF5
8235CEF88E270F8C33F9218633A421FD
8EEA719A624599EE3D9B4473F1C99CBE
1CD1D85F7C39D7814EB1A4C55646D717
224B9D15731E3EA41830FB5E67E336AC
1F907E1A794D08899DF8DEDCA4A0BE53
CDB12CED18D01A0CC6AAF15D0A277DF9
ABB9A6AD029F190506DCF3B87C27E9BC
4EADDFEFFF468661CE4EEE680514BEE2
A442D7F9DA27C9F49919933DC0023738
23DD04F65B2097608958AF503FD06892
7DFC677A7E3FB2E644F40FF5EFF901D3
E76CBA449ABC6D410CD8B174EE1150C7
2223033CF9964E05E4045421FFFC8918
9EAAC1C6222FFE3D209C02C81C20F2A2
376E71CB4C92528ABE7D6FDC9CBCDA09
625CF86657E00A4629BCE49F5B31A144
F69F53A9BE23937F3528CC840C4958D4
C65B4227D3BC9EAC53DA13D73ACD2543
B6F60284DE6FD9D98BE07E37EE989CBE
Query:
SELECT `user_pseudo_id`, `event_timestamp`, `event_date`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` = 'app_remove'
LIMIT 100
Answer:
user_pseudo_id,event_timestamp,event_date
ABF9D98DA2369F92465B0999E8F3209A,1533027529228000,20180731
86C65934EDF946EBA8153BF74F0D55CE,1533062679305237,20180731
3E1C51353A2BF5684592B09F75E76873,1533103394220000,20180731
EDCD15D75FBFF7F1A0BCFEED11D86306,1533070982517000,20180731
69EE9FDF2F2C5A503484DD212696667B,1533103267937005,20180731
16F21707AB536E83A9CE8EABDB5C4E95,1533094554262000,20180731
766CE63AC5F8D5E3F690DB289B5347B7,1533058211244000,20180731
8032DC7D2C74BDA691A96F2502EE6002,1533075946455000,20180731
AF3B84D80B1A8A0C9CC2587252CC7048,1533031538261001,20180731
D085B6D6AEEA6314350B46AE987CD114,1533030462332030,20180731
FB1F87054CBD0625890297427AAAD990,1533079847913000,20180731
59279CC4C897051599F544C19F5A623D,1533072390967012,20180731
F30AAA5143694682000C553122AD15AB,1533036261267000,20180731
9D0C09CBAF30B0F179FF4F1B61679458,1533094711656000,20180731
1F40258A3B62E43C498D602201A7D9E0,1533058528419000,20180731
B891FB3B934244C19C73ADD9883B509D,1533060333079004,20180731
36EE4F03C639EC236E6BE9880B83ABAA,1533074656282000,20180731
FA1CBA7312F0DDF83E2EE1573E400043,1533070240190026,20180731
2A7EEC4B71E9E97EFD6504A7D57931FF,1533061906550017,20180731
9C480845A4CA91E1B4A794B6AEF425BC,1533060009810002,20180731
CEA92F03E8510B434A70984A6E255308,1533094488481016,20180731
C7225BD7DA8FC35F0418008067118D78,1533082874189000,20180731
172BED0C5894B034944ADE3FD13B9DDE,1533057027485000,20180731
76632219C629CAC04FA90E22A4F2AE64,1533072354421032,20180731
B61FDDD57DA47BA00E14707352203938,1533033508413000,20180731
9298E088B9BA5DFBFE729E55C9F4D132,1533042757457000,20180731
31FE3578985C855CE7FB123A32602FFC,1533083934274000,20180731
7111DE02896BEAD523646A9D80ABD049,1533078736527013,20180731
C08FA7B37167EDDCDDBA175E35FF4DD9,1533070577293000,20180731
1290BCB61140CAF8CE8A5E8FFBEF16B2,1533089406303026,20180731
37A4A5CCEE0FD6189187EDFF41C6F413,1533098636776006,20180731
383B0A28DC5E19F0B9014C8D89F36F1C,1533077859840000,20180731
9F2DD83499296F30A77F98E97B35985B,1533075312191000,20180731
A695441A11F541F6480139BE099C2D1B,1533105019747004,20180731
2FCD876603363FFDE5239ED45BE6B905,1533029372411000,20180731
28BAFBF9921B80B84EF45326F2CF9746,1533050033683000,20180731
31A81B7189F8AA8BADD3FC2D3EAE48D4,1533020883443000,20180731
A66F0780425463039996F43FD8082D75,1533071246354000,20180731
72A16804AD58C57A5CA193F91CD9F995,1529894134109000,20180624
0393E8CD10D9BAF3E2F06D31395151E6,1529864490472004,20180624
1C344B7F5FB0E6B5588212C820C2F896,1529855606881000,20180624
906CE0DA38E7D9DE597CA459CC907950,1529898602602000,20180624
5D0EEF4390FA404202D864AEAB30DF35,1529868380063030,20180624
Query:
SELECT DISTINCT AE.`user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*` AE
WHERE AE.`event_name` = 'app_exception'
  AND DATE(TIMESTAMP_MICROS(AE.`user_first_touch_timestamp`)) BETWEEN DATE('2018-09-01') AND DATE('2018-09-30')
LIMIT 100
Answer:
user_pseudo_id
382B7E4C3513E0B32AD100ABCC15B917
3C70D01246600BA32125AF44750B2014
486D0900B48B18D315367260129BFFB6
386EE7D00E029293C53C2ED7319EF520
3F9A72FBDB9E11A90E0AD33265CBB1F3
BD5A3594B390BA8DD9489C06CBD73ADE
0A74C26349ABD323C5CE34AB8DD52164
78A7C7D9BC2138200C3B37E3C7CA8CE8
3249B63899BAEA78F4DF487994C108EE
3983B79EE1ECAC145E3688021745D894
F24BBD36208042C587CEEFBF6951AA2B
E146F217FF7F711C9AB1461342FA8EC8
F488B4536BA104FE39ED63F2D4959B9C
B51FED7F1C67B068DDC84959FE0E14DB
96685CED0793A219EFE8976477D7DA56
2779422065F5685DFCBC3179B5E6E38F
00B6D40595249C8532BCA9846389C411
9F8D4A18FC571082BD1D7AA5597756AD
72AC12CE2E2F425A2546D18F14B0077A
EA62196C3CD3A168761EDF851C44D293
B33F9AF7B23A856F6F23426B1AE94926
3B8B6295198F4D19C6FDCCC61D9A76C2
050231DF01854EFA691E0D5F4DB9ADB2
D9E0B99D114ACD55A2349149F3BC96F7
3E8245CE87EEDBDF995B682A717AE2FC
A622BBB66D14F224D949A6A86B87D4BA
38EC067E0FD1205E85B7922DEA496A50
FE4A220061DD4F9A25167AA519CD0620
44ED38A539DE12288621EA8C2C79C318
1756558602A5C14A5DD2AD4B696D2191
747538074CEC9FE551F488F3E47F9FD9
26F3A02677C6F21DFE2A00C213662D8D
9A46A573C1A4263A449716650F25ABFF
64D4FF2E08079BEEF31850948C79C5BF
9EAAC1C6222FFE3D209C02C81C20F2A2
11A3238DEAD2345528E617ACC82D2027
D31F0611DE6B94A5F001584286883AB7
4549717C06BAFE84FB1FFE5DDBD7EB2E
7B12B56BE42BA15EE493BDC9902B54E4
88D87254AD30B9DAB8DDD4447FA74B11
61A1C5F0C88099572CE914B2EE66C12F
361F3570C32F1CE252B63BA587E7BDDC
BD2F25C4375B34CD44952E51B37F3123
9664FAE9A17FD550BE78549EEA2773AC
879503A3ED5F2DCB6592E99C42E1BDFE
CCC7BB053BBC6824C53FAA4A8C63E3FE
F9EF5F13B83A4CA8C74C7ABD868F23D5
C96F1CB586725A7D165BCF665C131114
CC4F9BBD0104A39837B34D488E0EB689
6551148F681F9DF807FF3624EA5DEFA8
217732C20FF3F5F02EFDCA2BD1CE5220
FD807541F1DE049B5D16ED3EE2DCF160
E5E7576642F88625FEAC6606CE1DD50D
550A5DFB3871B30009BF48DE5EDCF918
1BB448F355B22AFE32A99DF1997D2D61
CF3F621F23B4C697E784B0998A1DB94E
ED0AF1301B6404476B420A990B98ABD7
E700BD83FAFB7509FE2F45F2D7554326
0554FA7236F2A6E3A86F54C72EDE441D
9A10BF8F0166076BD918A5027396A46B
23670FFEF0FFC29FF59EA8E1A82E3A93
9739CF7747700632F707FE234CEA7C00
Query:
SELECT
  UN.`user_pseudo_id`,
  DATE_DIFF(
    TIMESTAMP_MICROS(UN.`event_timestamp`),
    TIMESTAMP_MICROS(UN.`user_first_touch_timestamp`),
    DAY
  ) AS days_to_uninstall
FROM `firebase-public-project.analytics_153293282.events_*` UN
WHERE UN.`event_name` = 'app_remove'
  AND DATE(TIMESTAMP_MICROS(UN.`user_first_touch_timestamp`)) BETWEEN DATE('2018-09-01') AND DATE('2018-09-30')
LIMIT 100
Answer:
user_pseudo_id,days_to_uninstall
C7DD86F06FD4AA8A0967E27E20750FCD,6
63D8ACC080B6F91722C1ECD735FF3395,2
4A2A03B50BDA6AC1687703BD39A91E3E,6
3E8245CE87EEDBDF995B682A717AE2FC,0
9EAAC1C6222FFE3D209C02C81C20F2A2,0
10CD441F79B53D8F7E281C38ACBEE2C3,0
0E65A1967A3EE64A4D33E6038D677FAD,0
0E5DAB111CB3C0001C0019712A83CB49,0
F12F4F196933013F64399BF74945999B,0
B1C093A32996E59C0298E81A14398491,2
196CDAC439AE9EB9B70F6868A05FAD3D,5
E5E4C7E5600DD124D56BA0B0FF41B07C,0
70D2F634EB46DA3061AADBA078ADF7E9,0
58CAB99FE371CFE26EEFE32A9BEB9C96,0
3114BB0EE700894607B258BC4706797C,9
2E7493AC5967A8B48B8DEF79EDDFC056,0
AC14AD9D158A2A5449E120A33D5B55BB,0
337A3F347AE32CE90A631DF3028500A5,0
FF2D6D2366E710D0FBF8BF00D2081ADF,0
DFD440E5A6ED9EB7BEE70013C9CB82DE,0
1CDB183DBB7427164204AED3AEE70341,0
07D1A24DC2164260EEA5FB510C491431,0
14FC1A25D55E89AC7ECD600CD3A08C13,0
4EEE67C2E335213F6815144829801E0F,0
6D6EB70E837A5007BE550C44FF276440,0
97D9D96077AD3E8859BF5C54C873E59D,0
CEBA063FD7BF190D727CC948185CCEC8,0
5A66BC427F25EFFDFEDED4A07D8F9F91,0
37EFBD2BA398148336F96B4347392A8D,0
177C0BEFFC69408F88D3377632F1BB60,0
37034A23CAFF85394E2E349C381788A6,0
1E882F0B9818614D6E47620DD31229F1,0
551B893D34A2A59971B8FF185C1CD0C8,0
7AB9D5F7D122A38CA8769C9C93F3A12F,0
D6803CFD38D435F0364EB47684F7CCF6,0
B9D800D33FDCF7AF2157CB66910A0797,0
9E25C5FED0F3F775FBB2A5C76DD0511C,0
DAD134C77F7E09BC552E290534CB90E8,0
66788E34B6E292DE03B1B54E797CADBF,0
A5302213F1605BE400E8AA34992B18A8,0
D963E509346C0E5358ECFE56AF3BB2ED,0
1D5A0DC978A69FF28EC9D153F32EA871,0
2C15FFDEDDA69390B7A8EB5808FB7ED6,0
531E7B35DE9A21A1942F057C98B4E74C,0
C09F65F2853D03DE23CFD90F97429735,0
E0F1ED4167D0C0B2D6DCBA85CB020F52,0
E6E7FC8AC6D32935DA5ADCFFD14CC3A8,0
D8B77A575B5308D161F95ACF515F9772,0
8DEB6CB6C3E85D0032D8557C73ADD49F,0
A6E8B0AC5E066F7670116136442F728F,0
C945C989CF380E22E1B1E4B28E26801A,0
27C0BAADCE9520F17249A8B85F6477DA,0
1756558602A5C14A5DD2AD4B696D2191,13
B91D25D0A49511240F05AA56EFF1D985,22
8165B8A88DB3120D9C73A19779230F2A,2
7119284E9BA39CA0414A27EB2C0229D0,28
5B6161A5B8EAF9E04291EEAFEA188D12,7
A33AA9C2E129CCAE6C571C8C2CF05BB3,17
EF0F0BF78A51EB7065ED9135D5EC68F3,6
92FEE9540884CA75FDACA7154B4DDC41,17
AEA58269AB4082AA8A5A1BEF788C3178,15
61814C6B80D24FFDE5FEB59D61FD5B1C,0
5767C89378ACD5BE8A54CD7E8F495EBC,3
45F69B905EBE7D436F86CB5C0802D4BD,0
FEEAEF16683900608922225433583714,16
Query:
SELECT `user_pseudo_id`, `event_params`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` = 'app_exception'
LIMIT 100
Answer:
Too long, hard cut:
user_pseudo_id,event_params
295D9E24D8DE65A010313E667131EF19,"[{'key': 'fatal', 'value': {'string_value': None, 'int_value': 1, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'clx', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'timestamp', 'value': {'string_value': None, 'int_value': 1533289949985, 'float_value': None, 'double_value': None}}]"
295D9E24D8DE65A010313E667131EF19,"[{'key': 'fatal', 'value': {'string_value': None, 'int_value': 1, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'clx', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'timestamp', 'value': {'string_value': None, 'int_value': 1533334714580, 'float_value': None, 'double_value': None}}]"
CB284BFA662EC30C6D96E32278213CD4,"[{'key': 'fatal', 'value': {'string_value': None, 'int_value': 1, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_class', 'value': {'string_value': 'shop_menu', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'clx', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': 3873387604761179844, 'float_value': None, 'double_value': None}}, {'key': 'timestamp', 'value': {'string_value': None, 'int_value': 1533349829497, 'float_value': None, 'double_value': None}}]"
E6FEE8B98E75EA5311FE004F98559A27,"[{'key': 'fatal', 'value': {'string_value': None, 'int_value': 1, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_class', 'value': {'string_value': 'shop_menu', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'clx', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': 7621950203378871586, 'float_value': None, 'double_value': None}}, {'key': 'timestamp', 'value': {'string_value': None, 'int_value': 1533344960818, 'float_value': None, 'double_value': None}}]"
4D38AF508E466CDF5FF6FD9F93892F1E,"[{'key': 'fatal', 'value': {'string_value': None, 'int_value': 1, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_class', 'value': {'string_value': 'shop_menu', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'clx', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': -6229488674312060467, 'float_value': None, 'double_value': None}}, {'key': 'timestamp', 'value': {'string_value': None, 'int_value': 1533332428835, 'float_value': None, 'double_value': None}}]"
4BDC831A6940071E2461D0B5293A329E,"[{'key': 'fatal', 'value': {'string_value': None, 'int_value': 1, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'clx', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'timestamp', 'value': {'string_value': None, 'int_value': 1533343401533, 'float_value': None, 'double_value': None}}]"
C55BB3776BAF55E6BE0B1B35D95EFCFC,"[{'key': 'fatal', 'value': {'string_value': None, 'int_value': 1, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_class', 'value': {'string_value': 'shop_menu', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'clx', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': 6372571612156864580, 'float_value': None, 'double_value': None}}, {'key': 'timestamp', 'value': {'string_value': None, 'int_value': 1533297953773, 'float_value': None, 'double_value': None}}]"
C55BB3776BAF55E6BE0B1B35D95EFCFC,"[{'key': 'fatal', 'value': {'string_value': None, 'int_value': 1, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_class', 'value': {'string_value': 'shop_menu', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'clx', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_id', 'value': {'string_value': None, 'int_value': -119355106010806591, 'float_value': None, 'double_value': None}}, {'key': 'timestamp', 'value': {'string_value': None, 'int_value': 1533311995405, 'float_value': None, 'double_value': None}}]"
C55BB3776BAF55E6BE0B1B35D95EFCFC,"[{'key': 'fatal', 'value': {'string_value': None, 'int_value': 1, 'float_value': None, 'double_value': None}}, {'key': 'firebase_screen_class', 'value': {'string_value': 'shop_menu', 'int_value': None, 'float_value': None, 'double_value': None}}, {'key': 'firebase_event_origin', 'value': {'string_value': 'clx', 'int_value': None, 'flo
Query:
SELECT DISTINCT UN.`user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*` UN
WHERE UN.`event_name` = 'app_remove'
  AND DATE(TIMESTAMP_MICROS(UN.`user_first_touch_timestamp`)) BETWEEN DATE('2018-09-01') AND DATE('2018-09-30')
  AND DATE_DIFF(
    TIMESTAMP_MICROS(UN.`event_timestamp`),
    TIMESTAMP_MICROS(UN.`user_first_touch_timestamp`),
    DAY
  ) <= 7
LIMIT 100
Answer:
user_pseudo_id
78E9738DC83BE674052BD4621BB2F113
C5558CE95739F785A76DDC61DF770201
8FEAB3AAF7434731E003747C511F06DE
EF6D6B0B8836E4B95ED7D8FCBAF0BF6C
7705D52DD2286DC2E6DB831A2E129E94
6B743763D2790D33F26AFB5618307222
95B822BEFE16968B26474ECD045F731D
AB984DAD6BEE2584D4CCA718CB4A003F
BE042BC1484A69E1731FB487C1AD34B9
C1F519708675990E7A5FC68A65396327
F9231C977F262065AFA5F376C746E0ED
97380FCE77BAB6B251B50DDE4ABD8F8A
408354544760D27F10CCA7CF9B4E43D3
E9FCF9F1FDF7016CF79A30251B2FA52B
122B9693B647802ACC0727BF5A36F75E
64E3BBB507EEFDE76364031EADF502F4
DA00B61D3816AA1394092563865564E3
B79FEE3597E3C4A3B5A38FE33B684341
F37788083CD17FEF93F66A5A8CFA9BCD
41B8B6917AC3C354AC6A10CDC715FDDB
289290E298ED08B95B10DE971359B101
92400633510BB9E545007254608CF161
2C45FDF91F91AE8A3A9E6F119E8BED13
578CB14FCF0AB3CD15250A6991E76B91
4B4901F73C458F5462AED0D68571D88E
0969A1FA5300A40F4CFA6AE5BD539DE4
72D04A6D10CF624A03592099F6312E9B
FBAE40C1C6A2210AA29158BE6256FC5E
E5E4C7E5600DD124D56BA0B0FF41B07C
70D2F634EB46DA3061AADBA078ADF7E9
2C8294A0EF5FF73A6C43819F67D450F4
4C2614370EF19318C141072F3EBFB9EC
361F3570C32F1CE252B63BA587E7BDDC
95B590F12E8E14749D6634ACD4AF518F
A0130C6FFE82A4523C6F6E97EC0A9B02
88CE6B580698B1629E831342E186DD0C
5A66BC427F25EFFDFEDED4A07D8F9F91
1E882F0B9818614D6E47620DD31229F1
27C0BAADCE9520F17249A8B85F6477DA
860EFF376090269DF25684D8769DF55F
B5EE4A89792209060659C9A6719EA8A4
60A36D65D2C9A3DA5C804006972CCAF8
D0B47C51E0A61F1D0F25F05396D8ABA2
63D8ACC080B6F91722C1ECD735FF3395
46B0260D63886FE06AA496B3B0854694
625B68C757B6B3A4EF64BA934546FED6
989D5092D062D1B432BEB9C618B21431
69BB8289D391EEDAAB396DA0C3F8FF1D
289D738E3B01C988983B957444571412
350EE49AD4A5D94271B68547943EA11C
BD76FA48CAC77875E95CCF0E142E4353
C1483F477709CE11455CE0E9E46E597A
D234FFF7508E1D6E24E3CE1A5AE5F0E1
99AEF7972E0B774A904B5F2839FC09B0
9A7C4451BAE83D1EEB969C0DAEB7917B
573258C3C79B7B051448BAC4407F8099
33469F822404E8FFAE1B545FD5427886
C8D74BCA384C771A8D916972C4B214C0
1A5626295FB0D5F841E0B877354619D4
75711C3113A09A2976DAA5A0D8C3E84D
D6803CFD38D435F0364EB47684F7CCF6
531E7B35DE9A21A1942F057C98B4E74C
E6E7FC8AC6D32935DA5ADCFFD14CC3A8
AAE4779C1A0F48E482C71DE95A4FA0E1
EB4432A4BDAAB8F5135FCB36503ADC7D
66AFD4A2B8BC073FC2021F5C42CC7C86
78510CA2B9355AEB78FF0A52A7811B79
CA9136455F325D81B4A1FC232A7CCE43
4242F3099015CEED6E973B209C3C48BE
492F7F04FA27A466D29C9C0FE7D0E843
21FD52300AE0FBAB4C95D6D470E471D2
8F780847855ADB932B0121C7278F375F
C7DD86F06FD4AA8A0967E27E20750FCD
0E65A1967A3EE64A4D33E6038D677FAD
80FC9DC8D2C527192F27DBC2A449FA26
B175B187062693360BCBADC4160F8D88
0150077AE685E3084E5DB84CF61CE383
F3E963D579925992BE2DF84991C979FA
C8C37FE99773C84625B1569515B491F2
CF3F621F23B4C697E784B0998A1DB94E
DFD487F27AEE9B027FFD4E736306279E
AB34C2DC3FDFA61951DFCD3831F38723
433E34F1BFEEF8A34A78D2C73D3AA014
4293BE87C4C4EE3249F6DCA7A27A866C
DCD1CD667669877B4D4E6D6FD7CFE848
5C7FB72A7CD89D7C56DCB2B71C91ECE9
AA137B66E1975E5B854D7A786BDBC380
A7E12AF359CFF4A23F85F9A6E848CF60
07D1A24DC2164260EEA5FB510C491431
2ED35AC1D18D24AD6144985A6BADD694
C552986AF8B757F3F7E518740ECD738A
37B003197370E8FB7DA7A2FA4ED09427
B538D05509793202091BD234EDF9F4BB
Query:
SELECT COUNT(DISTINCT `user_pseudo_id`) AS total_new_users
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` = 'first_open'
  AND PARSE_DATE('%Y%m%d', `event_date`) BETWEEN DATE('2018-09-01') AND DATE('2018-09-30')
Answer:
total_new_users
1349
Query:
SELECT `user_pseudo_id`, `event_date`, `event_timestamp`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` = 'app_exception'
LIMIT 100
Answer:
user_pseudo_id,event_date,event_timestamp
77F5E9A5630151C9E831156AEAB4DA11,20180723,1532359337313003
AB32482D193E2CE166B59F82EF78D8BB,20180723,1532370888724002
AB32482D193E2CE166B59F82EF78D8BB,20180723,1532371314762017
1B2FC37816CC4DDAACA97A75E685756F,20180723,1532400110362002
2C84CF723999D48F8F069AFFC184C4DC,20180723,1532332885028003
0CAAA1B6F161BA4D363EB7A2DEF64A08,20180723,1532392257730002
0F668D1FE72425834C6A5EE9F4F53BCD,20180723,1532379318341003
B5F3D00E28A57C9522F2DEE3CB903DD1,20180723,1532388429484051
B5F3D00E28A57C9522F2DEE3CB903DD1,20180723,1532388540581003
B5F3D00E28A57C9522F2DEE3CB903DD1,20180723,1532388653693003
91D637F0D9FB259AD52773B1B20151BE,20180723,1532406416663002
39BE7CAB9B8602ABD10A1BFB4E66BBB2,20180723,1532362818219054
E080406D26F71C9B8F331779CE8B82BA,20180723,1532366204103003
959635567E419A061EECCCA478EDC718,20180723,1532329280034002
959635567E419A061EECCCA478EDC718,20180723,1532374791255015
959635567E419A061EECCCA478EDC718,20180723,1532374809230011
959635567E419A061EECCCA478EDC718,20180723,1532374867514010
959635567E419A061EECCCA478EDC718,20180723,1532374875591010
959635567E419A061EECCCA478EDC718,20180723,1532374955011029
959635567E419A061EECCCA478EDC718,20180723,1532375099456010
959635567E419A061EECCCA478EDC718,20180723,1532375233983011
959635567E419A061EECCCA478EDC718,20180723,1532375366706010
959635567E419A061EECCCA478EDC718,20180723,1532375507339014
959635567E419A061EECCCA478EDC718,20180723,1532375571518029
959635567E419A061EECCCA478EDC718,20180723,1532375594257010
959635567E419A061EECCCA478EDC718,20180723,1532375688531010
959635567E419A061EECCCA478EDC718,20180723,1532375698503010
959635567E419A061EECCCA478EDC718,20180723,1532375742214010
959635567E419A061EECCCA478EDC718,20180723,1532375933965032
959635567E419A061EECCCA478EDC718,20180723,1532376012051010
959635567E419A061EECCCA478EDC718,20180723,1532376047017002
959635567E419A061EECCCA478EDC718,20180723,1532376098091028
959635567E419A061EECCCA478EDC718,20180723,1532376167960019
959635567E419A061EECCCA478EDC718,20180723,1532393778042011
959635567E419A061EECCCA478EDC718,20180723,1532393767120011
959635567E419A061EECCCA478EDC718,20180723,1532393845722009
959635567E419A061EECCCA478EDC718,20180723,1532393803925008
959635567E419A061EECCCA478EDC718,20180723,1532393991232039
959635567E419A061EECCCA478EDC718,20180723,1532394061389009
959635567E419A061EECCCA478EDC718,20180723,1532394207650045
959635567E419A061EECCCA478EDC718,20180723,1532394303901008
959635567E419A061EECCCA478EDC718,20180723,1532394327475009
959635567E419A061EECCCA478EDC718,20180723,1532394336622010
Query:
SELECT DISTINCT UN.`user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*` UN
JOIN `firebase-public-project.analytics_153293282.events_*` AE
  ON UN.`user_pseudo_id` = AE.`user_pseudo_id`
WHERE UN.`event_name` = 'app_remove'
  AND AE.`event_name` = 'app_exception'
  AND DATE(TIMESTAMP_MICROS(UN.`user_first_touch_timestamp`)) BETWEEN DATE('2018-09-01') AND DATE('2018-09-30')
  AND DATE_DIFF(
    TIMESTAMP_MICROS(UN.`event_timestamp`),
    TIMESTAMP_MICROS(UN.`user_first_touch_timestamp`),
    DAY
  ) <= 7
LIMIT 100
Answer:
user_pseudo_id
361F3570C32F1CE252B63BA587E7BDDC
9EAAC1C6222FFE3D209C02C81C20F2A2
9664FAE9A17FD550BE78549EEA2773AC
CF3F621F23B4C697E784B0998A1DB94E
F24BBD36208042C587CEEFBF6951AA2B
747538074CEC9FE551F488F3E47F9FD9
23670FFEF0FFC29FF59EA8E1A82E3A93
9A10BF8F0166076BD918A5027396A46B
3E8245CE87EEDBDF995B682A717AE2FC
A622BBB66D14F224D949A6A86B87D4BA
End Exploring Related Columns
Task: For all users who first opened the app in September 2018 and then uninstalled within seven days, I want to know what percentage of them experienced an app crash. The calculation should be done by converting the timestamps to dates first, and then calculating the days to uninstall based on the dates. Only users who uninstalled within 7 days and experienced a crash should be considered in the final percentage.

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
Percentage_of_users_who_experienced_crash
value:float in [0,100]
```

This value represents the percentage of users who first opened the app in September 2018, uninstalled within seven days, and experienced an app crash. The calculation involves identifying users with a "first_open" event in September 2018, determining if they uninstalled the app within seven days by comparing event dates, and checking if they had any "app_exception" (crash) events during that period..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180612', 'events_20180613', 'events_20180614', 'events_20180615', 'events_20180616', 'events_20180617', 'events_20180618', 'events_20180619', 'events_20180620', 'events_20180621', 'events_20180622', 'events_20180623', 'events_20180624', 'events_20180625', 'events_20180626', 'events_20180627', 'events_20180628', 'events_20180629', 'events_20180630', 'events_20180701', 'events_20180702', 'events_20180703', 'events_20180704', 'events_20180705', 'events_20180706', 'events_20180707', 'events_20180708', 'events_20180709', 'events_20180710', 'events_20180711', 'events_20180712', 'events_20180713', 'events_20180714', 'events_20180715', 'events_20180716', 'events_20180717', 'events_20180718', 'events_20180719', 'events_20180720', 'events_20180721', 'events_20180722', 'events_20180723', 'events_20180724', 'events_20180725', 'events_20180726', 'events_20180727', 'events_20180728', 'events_20180729', 'events_20180730', 'events_20180731', 'events_20180801', 'events_20180802', 'events_20180803', 'events_20180804', 'events_20180805', 'events_20180806', 'events_20180807', 'events_20180808', 'events_20180809', 'events_20180810', 'events_20180811', 'events_20180812', 'events_20180813', 'events_20180814', 'events_20180815', 'events_20180816', 'events_20180817', 'events_20180818', 'events_20180819', 'events_20180820', 'events_20180821', 'events_20180822', 'events_20180823', 'events_20180824', 'events_20180825', 'events_20180826', 'events_20180827', 'events_20180828', 'events_20180829', 'events_20180830', 'events_20180831', 'events_20180901', 'events_20180902', 'events_20180903', 'events_20180904', 'events_20180905', 'events_20180906', 'events_20180907', 'events_20180908', 'events_20180909', 'events_20180910', 'events_20180911', 'events_20180912', 'events_20180913', 'events_20180914', 'events_20180915', 'events_20180916', 'events_20180917', 'events_20180918', 'events_20180919', 'events_20180920', 'events_20180921', 'events_20180922', 'events_20180923', 'events_20180924', 'events_20180925', 'events_20180926', 'events_20180927', 'events_20180928', 'events_20180929', 'events_20180930', 'events_20181001', 'events_20181002', 'events_20181003']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-30 01:02:11 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 01:02:11 - root - INFO - ```sql
SELECT
  CAST(users_with_crash_count.users_with_crash AS FLOAT64) / total_users.total_users * 100 AS Percentage_of_users_who_experienced_crash
FROM (
  SELECT COUNT(DISTINCT user_pseudo_id) AS total_users
  FROM (
    SELECT
      u.user_pseudo_id
    FROM (
      SELECT
        user_pseudo_id,
        MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_open_date
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE event_name = 'first_open'
        AND PARSE_DATE('%Y%m%d', event_date) BETWEEN DATE('2018-09-01') AND DATE('2018-09-30')
      GROUP BY user_pseudo_id
    ) u
    INNER JOIN (
      SELECT
        user_pseudo_id,
        MIN(PARSE_DATE('%Y%m%d', event_date)) AS uninstall_date
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE event_name = 'app_remove'
      GROUP BY user_pseudo_id
    ) ue ON u.user_pseudo_id = ue.user_pseudo_id
    WHERE DATE_DIFF(ue.uninstall_date, u.first_open_date, DAY) BETWEEN 0 AND 7
  ) users_uninstalled_within_7_days
) total_users,
(
  SELECT COUNT(DISTINCT u.user_pseudo_id) AS users_with_crash
  FROM (
    SELECT
      u.user_pseudo_id,
      u.first_open_date,
      ue.uninstall_date
    FROM (
      SELECT
        user_pseudo_id,
        MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_open_date
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE event_name = 'first_open'
        AND PARSE_DATE('%Y%m%d', event_date) BETWEEN DATE('2018-09-01') AND DATE('2018-09-30')
      GROUP BY user_pseudo_id
    ) u
    INNER JOIN (
      SELECT
        user_pseudo_id,
        MIN(PARSE_DATE('%Y%m%d', event_date)) AS uninstall_date
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE event_name = 'app_remove'
      GROUP BY user_pseudo_id
    ) ue ON u.user_pseudo_id = ue.user_pseudo_id
    WHERE DATE_DIFF(ue.uninstall_date, u.first_open_date, DAY) BETWEEN 0 AND 7
  ) u
  INNER JOIN `firebase-public-project.analytics_153293282.events_*` e
    ON u.user_pseudo_id = e.user_pseudo_id
  WHERE e.event_name = 'app_exception'
) users_with_crash_count
```
2025-01-30 01:02:18 - root - INFO - itercount: 1
2025-01-30 01:02:18 - root - INFO - 0
2025-01-30 01:02:18 - root - INFO - results: 
Percentage_of_users_who_experienced_crash
2.4464831804281344


2025-01-30 01:02:18 - root - INFO - Please check the answer again by reviewing For all users who first opened the app in September 2018 and then uninstalled within seven days, I want to know what percentage of them experienced an app crash. The calculation should be done by converting the timestamps to dates first, and then calculating the days to uninstall based on the dates. Only users who uninstalled within 7 days and experienced a crash should be considered in the final percentage., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Percentage_of_users_who_experienced_crash
value:float in [0,100]
```

This value represents the percentage of users who first opened the app in September 2018, uninstalled within seven days, and experienced an app crash. The calculation involves identifying users with a "first_open" event in September 2018, determining if they uninstalled the app within seven days by comparing event dates, and checking if they had any "app_exception" (crash) events during that period. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Percentage_of_users_who_experienced_crash
2.4464831804281344
Current sql:
SELECT
  CAST(users_with_crash_count.users_with_crash AS FLOAT64) / total_users.total_users * 100 AS Percentage_of_users_who_experienced_crash
FROM (
  SELECT COUNT(DISTINCT user_pseudo_id) AS total_users
  FROM (
    SELECT
      u.user_pseudo_id
    FROM (
      SELECT
        user_pseudo_id,
        MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_open_date
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE event_name = 'first_open'
        AND PARSE_DATE('%Y%m%d', event_date) BETWEEN DATE('2018-09-01') AND DATE('2018-09-30')
      GROUP BY user_pseudo_id
    ) u
    INNER JOIN (
      SELECT
        user_pseudo_id,
        MIN(PARSE_DATE('%Y%m%d', event_date)) AS uninstall_date
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE event_name = 'app_remove'
      GROUP BY user_pseudo_id
    ) ue ON u.user_pseudo_id = ue.user_pseudo_id
    WHERE DATE_DIFF(ue.uninstall_date, u.first_open_date, DAY) BETWEEN 0 AND 7
  ) users_uninstalled_within_7_days
) total_users,
(
  SELECT COUNT(DISTINCT u.user_pseudo_id) AS users_with_crash
  FROM (
    SELECT
      u.user_pseudo_id,
      u.first_open_date,
      ue.uninstall_date
    FROM (
      SELECT
        user_pseudo_id,
        MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_open_date
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE event_name = 'first_open'
        AND PARSE_DATE('%Y%m%d', event_date) BETWEEN DATE('2018-09-01') AND DATE('2018-09-30')
      GROUP BY user_pseudo_id
    ) u
    INNER JOIN (
      SELECT
        user_pseudo_id,
        MIN(PARSE_DATE('%Y%m%d', event_date)) AS uninstall_date
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE event_name = 'app_remove'
      GROUP BY user_pseudo_id
    ) ue ON u.user_pseudo_id = ue.user_pseudo_id
    WHERE DATE_DIFF(ue.uninstall_date, u.first_open_date, DAY) BETWEEN 0 AND 7
  ) u
  INNER JOIN `firebase-public-project.analytics_153293282.events_*` e
    ON u.user_pseudo_id = e.user_pseudo_id
  WHERE e.event_name = 'app_exception'
) users_with_crash_count
2025-01-30 01:03:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 01:03:08 - root - INFO - ```sql
SELECT
  CAST(users_with_crash_count.users_with_crash AS FLOAT64) / total_users.total_users * 100 AS Percentage_of_users_who_experienced_crash
FROM (
  SELECT COUNT(DISTINCT user_pseudo_id) AS total_users
  FROM (
    SELECT
      u.user_pseudo_id
    FROM (
      SELECT
        user_pseudo_id,
        MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_open_date
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE event_name = 'first_open'
        AND PARSE_DATE('%Y%m%d', event_date) BETWEEN DATE('2018-09-01') AND DATE('2018-09-30')
      GROUP BY user_pseudo_id
    ) u
    INNER JOIN (
      SELECT
        user_pseudo_id,
        MIN(PARSE_DATE('%Y%m%d', event_date)) AS uninstall_date
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE event_name = 'app_remove'
      GROUP BY user_pseudo_id
    ) ue ON u.user_pseudo_id = ue.user_pseudo_id
    WHERE DATE_DIFF(ue.uninstall_date, u.first_open_date, DAY) BETWEEN 0 AND 7
  ) users_uninstalled_within_7_days
) total_users,
(
  SELECT COUNT(DISTINCT u.user_pseudo_id) AS users_with_crash
  FROM (
    SELECT
      u.user_pseudo_id,
      u.first_open_date,
      ue.uninstall_date
    FROM (
      SELECT
        user_pseudo_id,
        MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_open_date
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE event_name = 'first_open'
        AND PARSE_DATE('%Y%m%d', event_date) BETWEEN DATE('2018-09-01') AND DATE('2018-09-30')
      GROUP BY user_pseudo_id
    ) u
    INNER JOIN (
      SELECT
        user_pseudo_id,
        MIN(PARSE_DATE('%Y%m%d', event_date)) AS uninstall_date
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE event_name = 'app_remove'
      GROUP BY user_pseudo_id
    ) ue ON u.user_pseudo_id = ue.user_pseudo_id
    WHERE DATE_DIFF(ue.uninstall_date, u.first_open_date, DAY) BETWEEN 0 AND 7
  ) u
  INNER JOIN `firebase-public-project.analytics_153293282.events_*` e
    ON u.user_pseudo_id = e.user_pseudo_id
  WHERE e.event_name = 'app_exception'
    AND PARSE_DATE('%Y%m%d', e.event_date) BETWEEN u.first_open_date AND u.uninstall_date
) users_with_crash_count
```

```csv
Percentage_of_users_who_experienced_crash
2.4465
```
2025-01-30 01:03:14 - root - INFO - itercount: 2
2025-01-30 01:03:14 - root - INFO - 0
2025-01-30 01:03:14 - root - INFO - Total iteration counts: 2
