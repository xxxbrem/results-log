2025-01-26 04:29:32 - openai._base_client - INFO - Retrying request to /chat/completions in 0.424966 seconds
2025-01-26 04:30:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:30:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:30:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:30:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:30:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:30:07 - snowflake.connector.connection - INFO - closed
2025-01-26 04:30:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:30:07 - root - INFO - SQL:
SELECT DISTINCT t."assignee_harmonized"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 100;
Results:
Too long, hard cut:
assignee_harmonized
"[
  {
    ""country_code"": ""US"",
    ""name"": ""FIDELITY INFORMATION SERVICES LLC""
  }
]"
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""PARIS SCIENCES ET LETTRES""
  },
  {
    ""country_code"": ""FR"",
    ""name"": ""COLLEGE FRANCE""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BROAD INST INC""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""BIOGEN MA INC""
  }
]"
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""OREAL""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HURST ROGER""
  },
  {
    ""country_code"": """",
    ""name"": ""KRITZINGER JOHAN A""
  },
  {
    ""country_code"": """",
    ""name"": ""ALLAN PETER""
  },
  {
    ""country_code"": """",
    ""name"": ""ELLISON BRENT""
  },
  {
    ""country_code"": """",
    ""name"": ""KHATER AJAY""
  }
]"
"[
  {
    ""country_code"": ""HU"",
    ""name"": ""SZENTIVANYI PETER""
  }
]"
"[
  {
    ""country_code"": ""IT"",
    ""name"": ""GEFRAN SPA""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""HANNING & KAHL GMBH & CO""
  }
]"
"[
  {
    ""country_code"": ""IT"",
    ""name"": ""BONFIO SDF FLLI""
  }
]"
"[
  {
    ""country_code"": ""IT"",
    ""name"": ""F D S DI DI STEFANO FILIPPO""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""ITT IND GMBH DEUTSCHE""
  }
]"
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""YOON SUNG CHUL""
  },
  {
    ""country_code"": ""KR"",
    ""name"": ""YANG HA NA""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""OZCAN HUSEYIN""
  }
]"
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""NHN PAYCO CORP""
  }
]"
"[
  {
    ""country_code"": ""CA"",
    ""name"": ""UNIV HEALTH NETWORK""
  }
]"
"[
  {
    ""country_code"": ""BR"",
    ""name"": ""NATURA COSMETICOS SA""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""HONEYWELL INT INC""
  }
]"
"[
  {
    ""country_code"": ""CA"",
    ""name"": ""BRANDT IND""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""METRC LLC""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""TOTO LTD""
  }
]"
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""CHANGXIN MEMORY TECH INC""
  }
]"
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""XIAMEN TIANMA MICRO ELECTRONICS CO LTD""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""TAKAMURA KOSHI""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""BITO YASUHIKO""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""PANASONIC CORP""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""HAMANAKA HIDEKI""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""YOKOHAMA RUBBER CO LTD""
  }
]"
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""MCINTOSH ANDREW""
  },
  {
    ""country_code"": ""GB"",
    ""name"": ""BEHESHTI NOVID""
  },
  {
    ""country_code"": ""GB"",
    ""name"": ""UNIV LEEDS""
  }
]"
"[
  {
    ""country_code"": ""ES"",
    ""name"": ""FOMINAYA SA""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PERKINELMER HEALTH SCI INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""WANG QINWEN""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""YUNNAN BRANCH OF HUANENG RENEWABLES CO LTD""
  },
  {
    ""country_code"": """",
    ""name"": ""HUANENG RENEWABLES CORP LTD""
  },
  {
    ""country_code"": """",
    ""name"": ""UNIV HEFEI TECHNOLOGY""
  },
  {
    ""country_code"": """",
    ""name"": ""CHINA HUANENG GROUP CO LTD""
  },
  {
    ""country_code"": """",
    ""name"": ""HUANENG GROUP TECH INNOVATION CENTER CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""SHANDONG DEQI HOME DECORATION MAT CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""WUXI LANGDI MEASUREMENT CONTROL TECH CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HELLA XIAMEN ELECTRONIC DEVICE CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""JINHETONGSHENG TIANJIN ENTERPRISE MAN CONSULTING CENTER LIMITED PARTNERSHIP""
  }
]"
"[
  {
    ""country_code"": ""CA"",
    ""name"": ""PROGRESSIVE OILFIELD SERVICES LTD""
  }
]"
"[
  {
    ""country_code"": ""IL"",
    ""name"": ""LIVNE SARIG""
  },
  {
    ""country_code"": ""IL"",
    ""name"": ""SUKONIK VITALY""
  },
  {
    ""country_code"": ""IL"",
    ""name"": ""OPHIR EINAT""
  },
  {
    ""country_code"": ""BB"",
    ""name"": ""MARVELL WORLD TRADE LTD""
  }
]"
"[
  {
    ""country_code"": ""IL"",
    ""name"": ""YEDA RES & DEV""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GREEN ZACHARY L""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""EVP INT LLC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""NEXT IT CORP""
  }
]"
"[
  {
    ""country_code"": ""SA"",
    ""name"": ""UNIV KING SAUD""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""NEXUS TECH INC""
  }
]"
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""TRIPLE WIN TECH SHENZHEN CO LTD""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""LAVAZZA PROFES

2025-01-26 04:30:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:30:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:30:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:30:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-26 04:30:09 - snowflake.connector.connection - INFO - closed
2025-01-26 04:30:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:30:54 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:30:54 - root - INFO - ```sql
SELECT t."country_code",
       COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value:"section"::STRING = 'A'
  AND c.value:"class"::STRING LIKE '61%'
GROUP BY t."country_code"
ORDER BY "patent_count" DESC
LIMIT 5;
```
2025-01-26 04:30:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:30:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:30:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:30:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-26 04:30:56 - snowflake.connector.connection - INFO - closed
2025-01-26 04:30:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:31:36 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:31:36 - root - INFO - ```sql
SELECT t."country_code",
       COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value:"code"::STRING LIKE 'A61%'
GROUP BY t."country_code"
ORDER BY "patent_count" DESC
LIMIT 5;
```
2025-01-26 04:31:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:31:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:31:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:31:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-26 04:31:37 - snowflake.connector.connection - INFO - closed
2025-01-26 04:31:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:32:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:32:22 - root - INFO - SQL:
SELECT t."country_code",
       COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value:"code"::STRING LIKE 'A61%'
GROUP BY t."country_code"
ORDER BY "patent_count" DESC
LIMIT 5;
Results:
country_code,patent_count
US,6179
CN,4575
JP,3409
KR,2240
AU,2198

2025-01-26 04:32:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:32:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:32:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:32:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:32:23 - snowflake.connector.connection - INFO - closed
2025-01-26 04:32:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:32:24 - root - INFO - SQL:
SELECT t."publication_number",
       t."assignee_harmonized",
       c.value:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value:"code"::STRING LIKE 'A61%'
LIMIT 100
Results:
Too long, hard cut:
publication_number,assignee_harmonized,cpc_code
US-2007010420-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""ECOLAB""
  }
]",A61L9/16
US-2007010420-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""ECOLAB""
  }
]",A61L2/186
US-2007010420-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""ECOLAB""
  }
]",A61L2/183
US-2007010420-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""ECOLAB""
  }
]",A61L9/16
US-2007010420-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""ECOLAB""
  }
]",A61L2/183
US-2007010420-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""ECOLAB""
  }
]",A61L2/186
US-2006047298-A1,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""IMP COLLEGE INNOVATIONS LTD""
  }
]",A61B5/037
US-2006047298-A1,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""IMP COLLEGE INNOVATIONS LTD""
  }
]",A61M29/02
US-2006047298-A1,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""IMP COLLEGE INNOVATIONS LTD""
  }
]",A61B5/037
US-2006047298-A1,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""IMP COLLEGE INNOVATIONS LTD""
  }
]",A61B2562/164
US-2006047298-A1,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""IMP COLLEGE INNOVATIONS LTD""
  }
]",A61B5/227
US-2006047298-A1,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""IMP COLLEGE INNOVATIONS LTD""
  }
]",A61B2562/0247
US-2006047298-A1,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""IMP COLLEGE INNOVATIONS LTD""
  }
]",A61B2562/164
US-2006047298-A1,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""IMP COLLEGE INNOVATIONS LTD""
  }
]",A61M29/02
US-2006047298-A1,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""IMP COLLEGE INNOVATIONS LTD""
  }
]",A61B2562/0247
US-2006047298-A1,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""IMP COLLEGE INNOVATIONS LTD""
  }
]",A61B5/227
US-2006047298-A1,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""IMP COLLEGE INNOVATIONS LTD""
  }
]",A61B2562/046
US-2006047298-A1,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""IMP COLLEGE INNOVATIONS LTD""
  }
]",A61B2562/046
US-2006020170-A1,"[
  {
    ""country_code"": """",
    ""name"": ""MINNESOTA MEDICAL PHYSICS LLC""
  }
]",A61B1/32
US-2006020170-A1,"[
  {
    ""country_code"": """",
    ""name"": ""MINNESOTA MEDICAL PHYSICS LLC""
  }
]",A61N5/1001
US-2006020170-A1,"[
  {
    ""country_code"": """",
    ""name"": ""MINNESOTA MEDICAL PHYSICS LLC""
  }
]",A61B1/32
US-2006020170-A1,"[
  {
    ""country_code"": """",
    ""name"": ""MINNESOTA MEDICAL PHYSICS LLC""
  }
]",A61N5/1001
US-2006015009-A1,"[
  {
    ""country_code"": """",
    ""name"": ""JAFFE ROSS""
  },
  {
    ""country_code"": """",
    ""name"": ""TARTAGLIA JOSEPH M""
  },
  {
    ""country_code"": """",
    ""name"": ""BELSON AMIR""
  }
]",A61B1/0008
US-2006015009-A1,"[
  {
    ""country_code"": """",
    ""name"": ""JAFFE ROSS""
  },
  {
    ""country_code"": """",
    ""name"": ""TARTAGLIA JOSEPH M""
  },
  {
    ""country_code"": """",
    ""name"": ""BELSON AMIR""
  }
]",A61B1/0053
US-2006015009-A1,"[
  {
    ""country_code"": """",
    ""name"": ""JAFFE ROSS""
  },
  {
    ""country_code"": """",
    ""name"": ""TARTAGLIA JOSEPH M""
  },
  {
    ""country_code"": """",
    ""name"": ""BELSON AMIR""
  }
]",A61B1/00154
US-2006015009-A1,"[
  {
    ""country_code"": """",
    ""name"": ""JAFFE ROSS""
  },
  {
    ""country_code"": """",
    ""name"": ""TARTAGLIA JOSEPH M""
  },
  {
    ""country_code"": """",
    ""name"": ""BELSON AMIR""
  }
]",A61B1/0055
US-2006015009-A1,"[
  {
    ""country_code"": """",
    ""name"": ""JAFFE ROSS""
  },
  {
    ""country_code"": """",
    ""name"": ""TARTAGLIA JOSEPH M""
  },
  {
    ""country_code"": """",
    ""name"": ""BELSON AMIR""
  }
]",A61B1/31
US-2006015009-A1,"[
  {
    ""country_code"": """",
    ""name"": ""JAFFE ROSS""
  },
  {
    ""country_code"": """",
    ""name"": ""TARTAGLIA JOSEPH M""
  },
  {
    ""country_code"": """",
    ""name"": ""BELSON AMIR""
  }
]",A61M2025/0063
US-2006015009-A1,"[
  {
    ""country_code"": """",
    ""name"": ""JAFFE ROSS""
  },
  {
    ""country_code"": """",
    ""name"": ""TARTAGLIA JOSEPH M""
  },
  {
    ""country_code"": """",
    ""name"": ""BELSON AMIR""
  }
]",A61M25/0138
US-2006015009-A1,"[
  {
    ""country_code"": """",
    ""name"": ""JAFFE ROSS""
  },
  {
    ""country_code"": """",
    ""name"": ""TARTAGLIA JOSEPH M""
  },
  {
    ""country_code"": """",
    ""name"": ""BELSON AMIR""
  }
]",A61B1/00078
US-2006015009-A1,"[
  {
    ""country_code"": """",
    ""name"": ""JAFFE ROSS""
  },
  {
    ""country_code"": """",
    ""name"": ""TARTAGLIA JOSEPH M""
  },
  {
    ""country_code"": """",
    ""name"": ""BELSON AMIR""
  }
]",A61B2017/00336
US-2006015009-A1,"[
  {
    ""country_code"": """",
    ""name"": ""JAFFE ROSS""
  },
  {
    ""country_code"": """",
    ""name"": ""TARTAGLIA JOSEPH M""
  },
  {
    ""country_code"": """",
    ""name"": ""BELSON AMIR""
  }
]",A61B1/0057
US-2006015009-A1,"[
  {
    ""country_code"": """",
    ""name"": ""JAFFE ROSS

2025-01-26 04:32:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:32:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:32:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:32:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:32:25 - snowflake.connector.connection - INFO - closed
2025-01-26 04:32:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:32:26 - root - INFO - SQL:
SELECT t."assignee_harmonized",
       COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value:"code"::STRING LIKE 'A61%'
GROUP BY t."assignee_harmonized"
ORDER BY "patent_count" DESC
LIMIT 100
Results:
Too long, hard cut:
assignee_harmonized,patent_count
[],5311
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PROCTER & GAMBLE""
  }
]",147
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""HOFFMANN LA ROCHE""
  }
]",115
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""NOVARTIS AG""
  }
]",108
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""OREAL""
  }
]",97
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PFIZER""
  }
]",91
"[
  {
    ""country_code"": ""US"",
    ""name"": ""LILLY CO ELI""
  }
]",91
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BRISTOL MYERS SQUIBB CO""
  }
]",68
"[
  {
    ""country_code"": ""US"",
    ""name"": ""COVIDIEN LP""
  }
]",65
"[
  {
    ""country_code"": ""NL"",
    ""name"": ""KONINKLIJKE PHILIPS NV""
  }
]",60
"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV CALIFORNIA""
  }
]",60
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASTRAZENECA AB""
  }
]",58
"[
  {
    ""country_code"": ""US"",
    ""name"": ""COLGATE PALMOLIVE CO""
  }
]",57
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""MERCK PATENT GMBH""
  }
]",55
"[
  {
    ""country_code"": ""US"",
    ""name"": ""KIMBERLY CLARK CO""
  }
]",53
"[
  {
    ""country_code"": ""BE"",
    ""name"": ""JANSSEN PHARMACEUTICA NV""
  }
]",50
"[
  {
    ""country_code"": """",
    ""name"": ""HOFFMANN LA ROCHE""
  }
]",47
"[
  {
    ""country_code"": """",
    ""name"": ""OREAL""
  }
]",46
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BECTON DICKINSON CO""
  }
]",46
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MEDTRONIC INC""
  }
]",46
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""HOECHST AG""
  }
]",46
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""OLYMPUS CORP""
  }
]",45
"[
  {
    ""country_code"": """",
    ""name"": ""PROCTER & GAMBLE""
  }
]",45
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MERCK & CO INC""
  }
]",44
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BOEHRINGER INGELHEIM INT""
  }
]",43
"[
  {
    ""country_code"": """",
    ""name"": ""LILLY CO ELI""
  }
]",42
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GENENTECH INC""
  }
]",41
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BAYER AG""
  }
]",40
"[
  {
    ""country_code"": ""US"",
    ""name"": ""AMGEN INC""
  }
]",38
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""SCHERING AG""
  }
]",37
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BOSTON SCIENT SCIMED INC""
  }
]",36
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",34
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""SIEMENS AG""
  }
]",34
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""FUJIFILM CORP""
  }
]",33
"[
  {
    ""country_code"": """",
    ""name"": ""BAYER AG""
  }
]",32
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PFIZER PROD INC""
  }
]",32
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""UNI CHARM CORP""
  }
]",31
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ALLERGAN INC""
  }
]",31
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""ALCON INC""
  }
]",31
"[
  {
    ""country_code"": ""US"",
    ""name"": ""3M INNOVATIVE PROPERTIES CO""
  }
]",31
"[
  {
    ""country_code"": ""US"",
    ""name"": ""WARNER LAMBERT CO""
  }
]",30
"[
  {
    ""country_code"": """",
    ""name"": ""HOECHST AG""
  }
]",30
"[
  {
    ""country_code"": """",
    ""name"": ""COLGATE PALMOLIVE CO""
  }
]",30
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""TERUMO CORP""
  }
]",30
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""SANOFI AVENTIS DEUTSCHLAND""
  }
]",30
"[
  {
    ""country_code"": """",
    ""name"": ""MERCK & CO INC""
  }
]",29
"[
  {
    ""country_code"": ""DK"",
    ""name"": ""NOVO NORDISK AS""
  }
]",28
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GEN ELECTRIC""
  }
]",28
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""GLAXO GROUP LTD""
  }
]",28
"[
  {
    ""country_code"": ""US"",
    ""name"": ""WYETH CORP""
  }
]",27
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ETHICON INC""
  }
]",27
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""GRUENENTHAL GMBH""
  }
]",27
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BEIERSDORF AG""
  }
]",26
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ABBOTT LAB""
  }
]",26
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SCHERING CORP""
  }
]",26
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""SANOFI SA""
  }
]",26
"[
  {
    ""country_code"": """",
    ""name"": ""KIMBERLY CLARK CO""
  }
]",25
"[
  {
    ""country_code"": ""US"",
    ""name"": ""EDWARDS LIFESCIENCES CORP""
  }
]",25
"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV LELAND STANFORD JUNIOR""
  }
]",25
"[
  {
    ""country_code"": """",
    ""name"": ""PFIZER""
  }
]",24
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""SANOFI AVENTIS""
  }
]",23
"[
  {
    ""country_code"": ""NL"",
    ""name"": ""UNILEVER NV""
  }
]",23
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SMIT

2025-01-26 04:32:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:32:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:32:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:32:27 - snowflake.connector.connection - INFO - closed
2025-01-26 04:32:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:32:42 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:32:42 - root - INFO - ```sql
SELECT t."publication_number",
       t."assignee_harmonized",
       TO_VARCHAR(TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
LIMIT 100;
```
2025-01-26 04:32:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:32:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:32:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:32:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:32:43 - snowflake.connector.connection - INFO - closed
2025-01-26 04:32:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:33:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:33:10 - root - INFO - SQL:
SELECT t."publication_number",
       t."assignee_harmonized",
       TO_VARCHAR(TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
LIMIT 100;
Results:
Too long, hard cut:
publication_number,assignee_harmonized,filing_year
US-2011047998-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""YAMAHA MOTOR CO LTD""
  }
]",2010
US-2011237510-A1,"[
  {
    ""country_code"": """",
    ""name"": ""BIODEL INC""
  }
]",2010
US-2011263715-A1,"[
  {
    ""country_code"": """",
    ""name"": ""PONGPEERAPAT ADCHARA""
  },
  {
    ""country_code"": """",
    ""name"": ""HIBI TORU""
  }
]",2010
US-2012084123-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""PAJIC NICK""
  }
]",2010
US-2011072347-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""CHESTNUT HILL SOUND INC""
  }
]",2010
US-2011094343-A1,"[
  {
    ""country_code"": """",
    ""name"": ""JI SUNG HOON""
  }
]",2010
US-2011098573-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""BOSTON SCIENT SCIMED INC""
  }
]",2010
US-2012099590-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""PITTS IAN""
  }
]",2010
US-2011044518-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""APERIO TECHNOLOGIES INC""
  }
]",2010
US-2011031504-A1,"[
  {
    ""country_code"": """",
    ""name"": ""QUICK NATHANIEL R""
  },
  {
    ""country_code"": """",
    ""name"": ""KAR ARAVINDA""
  }
]",2010
US-2011116353-A1,"[
  {
    ""country_code"": """",
    ""name"": ""SASA NOBORU""
  }
]",2010
US-2012027725-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""GALVIN JEFFREY A""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""LAI ZHENNAN""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""YANG QIANG""
  }
]",2010
US-2012060534-A1,"[
  {
    ""country_code"": ""CN"",
    ""name"": ""ZHANG MAOYONG""
  },
  {
    ""country_code"": ""CN"",
    ""name"": ""WANG JIANLIANG""
  }
]",2010
US-2011110848-A1,"[
  {
    ""country_code"": ""KR"",
    ""name"": ""KOREA ADVANCED INST SCI & TECH""
  }
]",2011
US-2011187089-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""FUJI KIKO KK""
  }
]",2011
US-2011162814-A1,"[
  {
    ""country_code"": """",
    ""name"": ""VADERS DENNIS HENRY""
  }
]",2011
US-2011268797-A1,"[
  {
    ""country_code"": ""TR"",
    ""name"": ""Sanovel IIac Sanayi Ve Ticaret Anonim Sirketi""
  }
]",2011
US-2011217972-A1,"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ERICSSON TELEFON AB L M""
  }
]",2009
US-2012021537-A1,"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SHIN DONG-SUK""
  },
  {
    ""country_code"": ""KR"",
    ""name"": ""LEE YONG-JOO""
  },
  {
    ""country_code"": ""KR"",
    ""name"": ""KIM DONG-HYUK""
  },
  {
    ""country_code"": ""KR"",
    ""name"": ""KIM MYUNG-SUN""
  },
  {
    ""country_code"": ""KR"",
    ""name"": ""CHUNG HOI-SUNG""
  }
]",2011
US-2012076185-A1,"[
  {
    ""country_code"": ""KR"",
    ""name"": ""PARK DAE-WOO""
  },
  {
    ""country_code"": ""KR"",
    ""name"": ""HONG YU-MI""
  },
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2011
US-2012077388-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""MEI RICHARD Y""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""MACAULEY DANIEL W""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""GERMAN MICHAEL""
  }
]",2011
US-2012063405-A1,"[
  {
    ""country_code"": ""KR"",
    ""name"": ""HAN JIN KYU""
  },
  {
    ""country_code"": ""KR"",
    ""name"": ""CHO JOON YOUNG""
  },
  {
    ""country_code"": ""KR"",
    ""name"": ""LEE JU HO""
  },
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2010
US-2012085101-A1,"[
  {
    ""country_code"": ""FR"",
    ""name"": ""GODEL FRANCK""
  },
  {
    ""country_code"": ""FR"",
    ""name"": ""GUEIT NICOLAS MARIE PIERRE""
  },
  {
    ""country_code"": ""FR"",
    ""name"": ""MAILLE JULIEN MARCEL ROGER""
  },
  {
    ""country_code"": ""FR"",
    ""name"": ""SNECMA""
  }
]",2010
US-2014365961-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""MICROSOFT CORP""
  }
]",2013
US-2015006254-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""LANDVOICE DATA LLC""
  }
]",2013
US-2015134778-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""MITSUBISHI ELECTRIC RES LAB""
  }
]",2013
US-2015134625-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""NETAPP INC""
  }
]",2013
US-2015159491-A1,"[
  {
    ""country_code"": """",
    ""name"": ""ASIA VITAL COMPONENTS CO LTD""
  }
]",2013
US-2015170065-A1,"[
  {
    ""country_code"": ""CA"",
    ""name"": ""VISIER SOLUTIONS INC""
  }
]",2013
US-2015232203-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""HONEYWELL INT INC""
  }
]",2014
US-2015138938-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""TOSHIBA KK""
  }
]",2014
US-2015257426-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""JOHN KEELER & CO INC""
  }
]",2014
US-2014338712-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV NOTRE DAME DU LAC""
  }
]",2014
US-2015347571-A1,"[
  {
    ""country_code"": ""NL"",
    ""name"": ""SYNERSCOPE B V""
  }
]",2014
US-2015357136-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""EATON CORP""
  }
]",2014
U

2025-01-26 04:33:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:33:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:33:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:33:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:33:12 - snowflake.connector.connection - INFO - closed
2025-01-26 04:33:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:33:12 - root - INFO - SQL:
SELECT t."assignee_harmonized",
       TO_VARCHAR(TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year",
       COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value:"code"::STRING LIKE 'A61%'
  AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
GROUP BY t."assignee_harmonized", "filing_year"
ORDER BY t."assignee_harmonized", "patent_count" DESC
LIMIT 100
Results:
assignee_harmonized,filing_year,patent_count
[],2018,303
[],2016,281
[],2017,280
[],2014,216
[],2021,214
[],2015,213
[],2019,208
[],2002,207
[],2013,194
[],2003,188
[],2020,185
[],2004,175
[],2011,164
[],2001,162
[],2022,156
[],2012,155
[],2009,154
[],2005,137
[],2006,136
[],2010,135
[],2008,114
[],2007,113
[],2000,102
[],1999,87
[],1997,82
[],1998,79
[],1996,73
[],1992,55
[],1994,52
[],1995,45
[],1991,43
[],2023,41
[],1990,39
[],1988,39
[],1989,37
[],1993,35
[],1986,25
[],1987,24
[],1981,22
[],1985,20
[],1973,19
[],1982,17
[],1974,16
[],1969,14
[],1980,13
[],1983,13
[],1979,12
[],1975,12
[],1976,12
[],2024,11
[],1966,11
[],1977,10
[],1971,9
[],1972,8
[],1964,7
[],1978,7
[],1970,7
[],1968,7
[],1965,6
[],1984,6
[],1967,5
[],1963,3
[],1928,2
[],1954,1
[],1948,1
[],1952,1
[],1934,1
[],1923,1
[],1941,1
[],1929,1
[],1949,1
[],1962,1
[],1959,1
[],1950,1
[],1936,1
"[
  {
    ""country_code"": """",
    ""name"": ""1ST AFFILIATED HOSPITAL GUANGZHOU UNIV CHINESE MEDICINE""
  }
]",2020,1
"[
  {
    ""country_code"": """",
    ""name"": ""1ST AFFILIATED HOSPITAL OF 3RD MILITARY MEDICAL UNIV PLA""
  }
]",2017,1
"[
  {
    ""country_code"": """",
    ""name"": ""1ST AFFILIATED HOSPITAL SUN YAT SEN UNIV""
  }
]",2021,1
"[
  {
    ""country_code"": """",
    ""name"": ""2ND AF HOSP & YUYING CHILDRENS HOSP OF WENZHOU MEDICAL UNIV""
  }
]",2020,1
"[
  {
    ""country_code"": """",
    ""name"": ""2ND AFFILIATED HOSPITAL NANJING MEDICAL UNIV""
  }
]",2017,1
"[
  {
    ""country_code"": """",
    ""name"": ""3B PHARMACEUTICAL LTD COMPANY""
  }
]",2020,1
"[
  {
    ""country_code"": """",
    ""name"": ""3M ESPE AG""
  }
]",2005,1
"[
  {
    ""country_code"": """",
    ""name"": ""3M INNOVATIVE PROPERTIES CO""
  }
]",2005,2
"[
  {
    ""country_code"": """",
    ""name"": ""3M INNOVATIVE PROPERTIES CO""
  }
]",2016,2
"[
  {
    ""country_code"": """",
    ""name"": ""3M INNOVATIVE PROPERTIES CO""
  }
]",2010,1
"[
  {
    ""country_code"": """",
    ""name"": ""3M INNOVATIVE PROPERTIES CO""
  }
]",2000,1
"[
  {
    ""country_code"": """",
    ""name"": ""3M INNOVATIVE PROPERTIES CO""
  }
]",2003,1
"[
  {
    ""country_code"": """",
    ""name"": ""3M INNOVATIVE PROPERTIES CO""
  }
]",2004,1
"[
  {
    ""country_code"": """",
    ""name"": ""3RD XIANGYA HOSPITAL CENTRAL SOUTH UNIV""
  }
]",2022,1
"[
  {
    ""country_code"": """",
    ""name"": ""3RD XIANGYA HOSPITAL CENTRAL SOUTH UNIV""
  }
]",2018,1
"[
  {
    ""country_code"": """",
    ""name"": ""41ST INST CHINA ELECTRONICS TECH GROUP CORP""
  },
  {
    ""country_code"": """",
    ""name"": ""BENGBU FIRST PEOPLES HOSPITAL""
  }
]",2017,1
"[
  {
    ""country_code"": """",
    ""name"": ""4D PHARMA RES LTD""
  }
]",2018,1
"[
  {
    ""country_code"": """",
    ""name"": ""4D PHARMA RES LTD""
  }
]",2020,1
"[
  {
    ""country_code"": """",
    ""name"": ""700303 ALBERTA LTD""
  }
]",1998,1
"[
  {
    ""country_code"": """",
    ""name"": ""8TH MEDICAL CENTER CHINESE PLA GENERAL HOSPITAL""
  }
]",2018,1
"[
  {
    ""country_code"": """",
    ""name"": ""AANESUTO BAA ON""
  }
]",1975,1
"[
  {
    ""country_code"": """",
    ""name"": ""AB2 BIO SA""
  }
]",2014,1
"[
  {
    ""country_code"": """",
    ""name"": ""ABALSEO PHARMACEUTICALS INC""
  }
]",2020,1
"[
  {
    ""country_code"": """",
    ""name"": ""ABBOTT CARDIOVASCULAR SYSTEMS""
  }
]",2014,1
"[
  {
    ""country_code"": """",
    ""name"": ""ABBOTT CARDIOVASCULAR SYSTEMS INC""
  }
]",2021,1

2025-01-26 04:33:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:33:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:33:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:33:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-26 04:33:13 - snowflake.connector.connection - INFO - closed
2025-01-26 04:33:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:33:54 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:33:54 - root - INFO - ```sql
SELECT t."assignee_harmonized",
       TO_VARCHAR(TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year",
       COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
GROUP BY t."assignee_harmonized", "filing_year"
ORDER BY "patent_count" DESC
LIMIT 100;
```
2025-01-26 04:33:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:33:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:33:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:33:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:33:55 - snowflake.connector.connection - INFO - closed
2025-01-26 04:33:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:34:20 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:34:20 - root - INFO - SQL:
SELECT t."assignee_harmonized",
       TO_VARCHAR(TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year",
       COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
GROUP BY t."assignee_harmonized", "filing_year"
ORDER BY "patent_count" DESC
LIMIT 100;
Results:
assignee_harmonized,filing_year,patent_count
[],2018,4250
[],2017,4031
[],2016,3955
[],2014,3523
[],2015,3474
[],2013,3017
[],2021,2632
[],2019,2517
[],2020,2269
[],2012,2266
[],2022,2193
[],2003,2025
[],2002,1948
[],2023,1903
[],2011,1885
[],1973,1829
[],2004,1774
[],1972,1736
[],2001,1701
[],1987,1649
[],1974,1646
[],1988,1588
[],2010,1578
[],1986,1556
[],1983,1546
[],1982,1512
[],2005,1510
[],2009,1496
[],1985,1479
[],1981,1472
[],1975,1470
[],1984,1441
[],1980,1399
[],1979,1380
[],1990,1378
[],1989,1377
[],1997,1375
[],2006,1367
[],2008,1330
[],1992,1323
[],1971,1304
[],1976,1298
[],1996,1286
[],1978,1276
[],2007,1256
[],1999,1216
[],1977,1204
[],1991,1180
[],2000,1179
[],1998,1167
[],1993,1159
[],1995,1014
[],1994,852
[],1970,683
[],1969,623
[],2024,607
[],1968,457
[],1966,385
[],1967,369
[],1965,324
[],1964,274
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2006,119
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2005,100
"[
  {
    ""country_code"": """",
    ""name"": ""NEC CORP""
  }
]",1988,98
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2021,97
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2020,93
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2007,86
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2022,83
"[
  {
    ""country_code"": """",
    ""name"": ""MATSUSHITA ELECTRIC IND CO LTD""
  }
]",1984,81
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2004,80
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2019,80
"[
  {
    ""country_code"": """",
    ""name"": ""NEC CORP""
  }
]",1986,79
"[
  {
    ""country_code"": ""US"",
    ""name"": ""IBM""
  }
]",2019,77
"[
  {
    ""country_code"": """",
    ""name"": ""MATSUSHITA ELECTRIC IND CO LTD""
  }
]",1999,76
"[
  {
    ""country_code"": """",
    ""name"": ""MATSUSHITA ELECTRIC IND CO LTD""
  }
]",2004,75
"[
  {
    ""country_code"": """",
    ""name"": ""NEC CORP""
  }
]",1989,75
"[
  {
    ""country_code"": """",
    ""name"": ""MATSUSHITA ELECTRIC IND CO LTD""
  }
]",2003,75
"[
  {
    ""country_code"": """",
    ""name"": ""MATSUSHITA ELECTRIC IND CO LTD""
  }
]",2005,74
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""LG ELECTRONICS INC""
  }
]",2019,72
"[
  {
    ""country_code"": ""US"",
    ""name"": ""QUALCOMM INC""
  }
]",2021,69
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2017,68
"[
  {
    ""country_code"": """",
    ""name"": ""MATSUSHITA ELECTRIC IND CO LTD""
  }
]",1990,67
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""HUAWEI TECH CO LTD""
  }
]",2020,67
"[
  {
    ""country_code"": """",
    ""name"": ""MITSUBISHI ELECTRIC CORP""
  }
]",1988,67
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2023,67
"[
  {
    ""country_code"": """",
    ""name"": ""HITACHI LTD""
  }
]",1988,66
"[
  {
    ""country_code"": ""US"",
    ""name"": ""IBM""
  }
]",2018,65
"[
  {
    ""country_code"": """",
    ""name"": ""MATSUSHITA ELECTRIC IND CO LTD""
  }
]",2001,64
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2015,64
"[
  {
    ""country_code"": """",
    ""name"": ""HITACHI LTD""
  }
]",1983,64
"[
  {
    ""country_code"": """",
    ""name"": ""HITACHI LTD""
  }
]",1985,64
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""HUAWEI TECH CO LTD""
  }
]",2021,64
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2018,63
"[
  {
    ""country_code"": """",
    ""name"": ""MATSUSHITA ELECTRIC IND CO LTD""
  }
]",1987,63
"[
  {
    ""country_code"": """",
    ""name"": ""MATSUSHITA ELECTRIC IND CO LTD""
  }
]",1989,63
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""HUAWEI TECH CO LTD""
  }
]",2019,62
"[
  {
    ""country_code"": """",
    ""name"": ""NEC CORP""
  }
]",1987,62
"[
  {
    ""country_code"": """",
    ""name"": ""TOSHIBA CORP""
  }
]",1987,62
"[
  {
    ""country_code"": """",
    ""name"": ""TOSHIBA CORP""
  }
]",1988,61
"[
  {
    ""country_code"": """",
    ""name"": ""MATSUSHITA ELECTRIC IND CO LTD""
  }
]",1983,60

2025-01-26 04:34:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:34:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:34:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:34:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:34:22 - snowflake.connector.connection - INFO - closed
2025-01-26 04:34:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:34:22 - root - INFO - SQL:
SELECT DISTINCT a.value:"name"::STRING AS "assignee"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE a.value:"name"::STRING IS NOT NULL
LIMIT 100
Results:
assignee
BOEING CO
ALCAN TECH & MAN AG
NIPPON LIGHT METAL CO
CHEN CHIEN CHOU
FERRARI GREEN ENERGY S R L
ICI LTD
CELANESE CORP
ERBA FARMITALIA
RETZ FRITZ
KORGUONKAR ANUJA
FLINT STUART R
SAITO AKIHIKO
VAN DER HEIJDEN WILHELM ADRIAA
EVERS SMITH LINDA
YOON IL-SEOP
ANGELANTONI IND SPA
PETERS ABRAM HARMS
BRADLEY MORTON C
TUFTS COLLEGE
HENDRICKSON USA LLC
MOCKABEE WILLIAM H
GOICH JOHN
MINNS WALTER J
PANASONIC IP MAN CORP
KYOCERA DOCUMENT SOLUTIONS INC
DAIHATSU MOTOR CO LTD
CHIRON CORP
JFE STEEL CORP
AQUA KK
UNIV SAGA
HYUNDAI ENGINEERING CO LTD
SEONAMIS CO LTD
PROCTOR & SCHWARTZ INC
WHIRLPOOL CO
MARTINEZ RANDY G
UPHUS REINHARD
CARDIAC PACEMAKERS INC
KIM CHUL-HO
LEMASTER HERB
STEEN JUSTIN T
MIYAKE KUNIAKI
KIA MOTORS CORP
FUJI ELECTRIC CO LTD
PHARMACYCLICS LLC
NISHINAGA EUGENE IWAO
SUN XIAOPING
ALFA LAVAL AB
AREA IMPIANTI S P A
PEL TECHNOLOGIES LLC
MITSUBISHI GAS CHEMICAL CO
BORMASTER RONALD
DIALOG SEMICONDUCTOR INC
SONY GROUP CORP
M T C MACCH TRASFORMAZIONE CARTA S R L
ASML NETHERLANDS BV
AVAYA MAN LP
DARLING THOMAS ROBERT
JOHNSON JAMES G
CHAPA FERNANDO
PERASO TECH INC
THE CATHOLIC UNIV OF KOREA INDUSTRYâ€”ACADEMIC COOPERATION FOUNDATION
KAUTEX TEXTRON GMBH & CO KG
UNIV VIENNA
SHIN DONG-SUK
LANDVOICE DATA LLC
FUTUREWEI TECHNOLOGIES INC
PROBIOSWISS AG
IDEAWARE INC
MAYO FOUNDATION
DOUGLAS MACHINE INC
NINGBO FUYITE HYDRAULIC TECH CO LTD
CHENGDU IDEALSEE TECHNOLOGY CO LTD
SHENZHEN SHENLAN ZHITONG TECH CO LTD
HUIZHOU EVERPOWER TECH CO LTD
NANJING TECHNICAL VOCATIONAL COLLEGE NANJING BRANCH OF JIANGSU UNION TECHNICAL INST
TIN FREE SUBSECTION OF 7TH O 3 RES INSTITUTE OF CHINESE SHIP HEAVY INDUSTRY GROUP COMPANY
ANHUI MINGKUN ALUMINUM IND CO LTD
HY LINK SCIENCE&TECHNOLOGY CO LTD
LU ZHANPING
EGALAX_EMPIA TECH INC
PINHEIRO JOSE NEVES COSTA
DAIFUKU KK
BEYONTECH INC
MINNESOTA MEDICAL PHYSICS LLC
INSPEKTOR AHARON
POOLA KRISHNA LEELA
MANARESI NICOLO
FISCHER AG GEORG
ACCIAI SPECIALI TERNI SPA
PRECIOSA
LISTERNO TRADING LTD
OB EDINENNYJ INST YADERNYKH I
OOO NII PRIRODNYKH GAZOV I GAZ
A LIFE CORP
ECOTECH CO LTD
ZEISS CARL NTS GMBH
DAIMLER AG
MEYER HOLGER
SUKONIK VITALY
CAO DA-HUA

2025-01-26 04:34:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:34:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:34:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:34:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-26 04:34:23 - snowflake.connector.connection - INFO - closed
2025-01-26 04:34:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:34:24 - root - INFO - SQL:
SELECT a.value:"name"::STRING AS "assignee_name",
       COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value:"code"::STRING LIKE 'A61%'
  AND a.value:"name"::STRING IS NOT NULL
GROUP BY a.value:"name"::STRING
ORDER BY "patent_count" DESC
LIMIT 10
Results:
assignee_name,patent_count
PROCTER & GAMBLE,197
HOFFMANN LA ROCHE,189
OREAL,150
NOVARTIS AG,147
LILLY CO ELI,140
PFIZER,125
UNIV CALIFORNIA,98
BRISTOL MYERS SQUIBB CO,90
COLGATE PALMOLIVE CO,89
COVIDIEN LP,84

2025-01-26 04:34:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:34:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:34:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:34:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 85
2025-01-26 04:34:25 - snowflake.connector.connection - INFO - closed
2025-01-26 04:34:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:34:26 - root - INFO - SQL:
SELECT DISTINCT t."country_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value:"code"::STRING LIKE 'A61%'
LIMIT 100
Results:
country_code
DO
UA
HR
DK
FI
KR
RO
GR
LT
PL
CR
CZ
HN
ZA
EP
US
DE
PH
DD
CO
WO
AU
CU
ZW
MA
RS
HU
JP
DZ
CH
PA
EG
MD
CY
IT
OA
MX
EE
GE
HK
GT
TN
NO
TR
BG
BE
SA
MY
CS
LV
PE
SI
AR
TW
IL
JO
IN
EC
SG
GB
CN
AT
YU
ZM
CA
SK
IS
SE
AP
ES
IE
EA
BR
ID
LU
NL
RU
NI
ME
SM
PT
CL
NZ
FR
SU

2025-01-26 04:34:26 - root - INFO - itercount: 0
2025-01-26 04:34:26 - root - INFO - Database Name: PATENTS
Schema Name: PATENTS
DDL describes table information.
,0
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,1
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""spif_publication_number"" VARCHAR(16777216),
	""spif_application_number"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""claims_localized_html"" VARIANT,
	""description_localized"" VARIANT,
	""description_localized_html"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""locarno"" VARIANT,
	""citation"" VARIANT,
	""parent"" VARIANT,
	""child"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,2
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
To address the task, we'll need to identify the relevant tables and columns that can help us find:

1. **The assignee who has been the most active in the patent category 'A61'.**
2. **Their busiest year (the year with the highest number of filings).**
3. **The top five jurisdiction codes where they filed the most patents during that year.**

### Relevant Tables and Columns:

- **Table:** `PATENTS.PATENTS.PUBLICATIONS`

  - **"assignee_harmonized"** (VARIANT):
    - *Usage:* To identify assignees in a standardized format.
  
  - **"cpc"** (VARIANT):
    - *Usage:* Contains Cooperative Patent Classification codes; used to filter patents in category 'A61'.
  
  - **"filing_date"** (NUMBER):
    - *Usage:* Filing date of the patent; can extract the year to determine the busiest year.
  
  - **"country_code"** (VARCHAR):
    - *Usage:* Represents the jurisdiction code where the patent was filed.
  
  - **"publication_number"** and **"application_number"** (VARCHAR):
    - *Usage:* Unique identifiers for patents; useful for counting patents.
  
### Potential Conditions:

- Filter patents where the **"cpc"** code starts with 'A61'.
- Identify the assignee with the highest number of such patents.
- Determine the year with the most filings for that assignee.
- Find the top five jurisdiction codes based on the number of patents filed in that year.

### SQL Queries to Explore the Data:

Below are 10 different SQL queries to help understand the data and extract the necessary information.

---

1. **List distinct assignees in the dataset:**

   ```sql
   SELECT DISTINCT t."assignee_harmonized"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 100;
   ```

2. **Extract CPC codes starting with 'A61' from the "cpc" field:**

   ```sql
   SELECT DISTINCT c.value:"section"::STRING || c.value:"class"::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c
   WHERE c.value:"section"::STRING = 'A' AND c.value:"class"::STRING = '61'
   LIMIT 100;
   ```

3. **List patents with their assignees and CPC codes starting with 'A61':**

   ```sql
   SELECT t."publication_number",
          t."assignee_harmonized",
          c.value:"section"::STRING || c.value:"class"::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c
   WHERE c.value:"section"::STRING = 'A' AND c.value:"class"::STRING = '61'
   LIMIT 100;
   ```

4. **Count the number of patents per assignee in category 'A61':**

   ```sql
   SELECT t."assignee_harmonized",
          COUNT(DISTINCT t."publication_number") AS "patent_count"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c
   WHERE c.value:"section"::STRING = 'A' AND c.value:"class"::STRING = '61'
   GROUP BY t."assignee_harmonized"
   ORDER BY "patent_count" DESC
   LIMIT 100;
   ```

5. **Extract the filing year from "filing_date" and list patents:**

   ```sql
   SELECT t."publication_number",
          t."assignee_harmonized",
          TO_VARCHAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 100;
   ```

6. **Find the busiest year for each assignee in category 'A61':**

   ```sql
   SELECT t."assignee_harmonized",
          TO_VARCHAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year",
          COUNT(DISTINCT t."publication_number") AS "patent_count"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c
   WHERE c.value:"section"::STRING = 'A' AND c.value:"class"::STRING = '61'
   GROUP BY t."assignee_harmonized", "filing_year"
   ORDER BY t."assignee_harmonized", "patent_count" DESC
   LIMIT 100;
   ```

7. **List the top five jurisdiction codes for a specific assignee in a specific year:**

   *(Replace 'Assignee_Name' with the actual assignee and 'Year' with the specific year.)*

   ```sql
   SELECT t."country_code",
          COUNT(DISTINCT t."publication_number") AS "patent_count"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c
   WHERE t."assignee_harmonized"::STRING = 'Assignee_Name'
     AND TO_VARCHAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') = 'Year'
     AND c.value:"section"::STRING = 'A' AND c.value:"class"::STRING = '61'
   GROUP BY t."country_code"
   ORDER BY "patent_count" DESC
   LIMIT 100;
   ```

8. **Extract and list the "assignee_harmonized" field with proper JSON parsing:**

   ```sql
   SELECT DISTINCT t."assignee_harmonized"::STRING AS "assignee"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 100;
   ```

9. **Find the top 10 assignees with the most patents in category 'A61':**

   ```sql
   SELECT t."assignee_harmonized",
          COUNT(DISTINCT t."publication_number") AS "patent_count"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c
   WHERE c.value:"section"::STRING = 'A' AND c.value:"class"::STRING = '61'
   GROUP BY t."assignee_harmonized"
   ORDER BY "patent_count" DESC
   LIMIT 10;
   ```

10. **List all jurisdiction codes where patents were filed in category 'A61':**

    ```sql
    SELECT DISTINCT t."country_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."cpc") c
    WHERE c.value:"section"::STRING = 'A' AND c.value:"class"::STRING = '61'
    LIMIT 100;
    ```

---

These queries progressively explore the data needed to solve the task by:

- Identifying assignees and their patent counts in the specific category.
- Extracting and working with nested JSON fields in the "cpc" and "assignee_harmonized" columns.
- Calculating the busiest year for each assignee.
- Identifying the top jurisdiction codes based on patent filings.

*Note:* Since the columns like "assignee_harmonized" and "cpc" are of VARIANT type (nested JSON), we use `LATERAL FLATTEN` to extract and filter the data. The `TO_DATE` and `TO_VARCHAR` functions are used to parse and format the "filing_date" field to extract the year.Query:
SELECT DISTINCT t."assignee_harmonized"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 100;
Answer:
Too long, hard cut:
assignee_harmonized
"[
  {
    ""country_code"": ""US"",
    ""name"": ""FIDELITY INFORMATION SERVICES LLC""
  }
]"
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""PARIS SCIENCES ET LETTRES""
  },
  {
    ""country_code"": ""FR"",
    ""name"": ""COLLEGE FRANCE""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BROAD INST INC""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""BIOGEN MA INC""
  }
]"
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""OREAL""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HURST ROGER""
  },
  {
    ""country_code"": """",
    ""name"": ""KRITZINGER JOHAN A""
  },
  {
    ""country_code"": """",
    ""name"": ""ALLAN PETER""
  },
  {
    ""country_code"": """",
    ""name"": ""ELLISON BRENT""
  },
  {
    ""country_code"": """",
    ""name"": ""KHATER AJAY""
  }
]"
"[
  {
    ""country_code"": ""HU"",
    ""name"": ""SZENTIVANYI PETER""
  }
]"
"[
  {
    ""country_code"": ""IT"",
    ""name"": ""GEFRAN SPA""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""HANNING & KAHL GMBH & CO""
  }
]"
"[
  {
    ""country_code"": ""IT"",
    ""name"": ""BONFIO SDF FLLI""
  }
]"
"[
  {
    ""country_code"": ""IT"",
    ""name"": ""F D S DI DI STEFANO FILIPPO""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""ITT IND GMBH DEUTSCHE""
  }
]"
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""YOON SUNG CHUL""
  },
  {
    ""country_code"": ""KR"",
    ""name"": ""YANG HA NA""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""OZCAN HUSEYIN""
  }
]"
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""NHN PAYCO CORP""
  }
]"
"[
  {
    ""country_code"": ""CA"",
    ""name"": ""UNIV HEALTH NETWORK""
  }
]"
"[
  {
    ""country_code"": ""BR"",
    ""name"": ""NATURA COSMETICOS SA""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""HONEYWELL INT INC""
  }
]"
"[
  {
    ""country_code"": ""CA"",
    ""name"": ""BRANDT IND""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""METRC LLC""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""TOTO LTD""
  }
]"
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""CHANGXIN MEMORY TECH INC""
  }
]"
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""XIAMEN TIANMA MICRO ELECTRONICS CO LTD""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""TAKAMURA KOSHI""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""BITO YASUHIKO""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""PANASONIC CORP""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""HAMANAKA HIDEKI""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""YOKOHAMA RUBBER CO LTD""
  }
]"
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""MCINTOSH ANDREW""
  },
  {
    ""country_code"": ""GB"",
    ""name"": ""BEHESHTI NOVID""
  },
  {
    ""country_code"": ""GB"",
    ""name"": ""UNIV LEEDS""
  }
]"
"[
  {
    ""country_code"": ""ES"",
    ""name"": ""FOMINAYA SA""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PERKINELMER HEALTH SCI INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""WANG QINWEN""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""YUNNAN BRANCH OF HUANENG RENEWABLES CO LTD""
  },
  {
    ""country_code"": """",
    ""name"": ""HUANENG RENEWABLES CORP LTD""
  },
  {
    ""country_code"": """",
    ""name"": ""UNIV HEFEI TECHNOLOGY""
  },
  {
    ""country_code"": """",
    ""name"": ""CHINA HUANENG GROUP CO LTD""
  },
  {
    ""country_code"": """",
    ""name"": ""HUANENG GROUP TECH INNOVATION CENTER CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""SHANDONG DEQI HOME DECORATION MAT CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""WUXI LANGDI MEASUREMENT CONTROL TECH CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HELLA XIAMEN ELECTRONIC DEVICE CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""JINHETONGSHENG TIANJIN ENTERPRISE MAN CONSULTING CENTER LIMITED PARTNERSHIP""
  }
]"
"[
  {
    ""country_code"": ""CA"",
    ""name"": ""PROGRESSIVE OILFIELD SERVICES LTD""
  }
]"
"[
  {
    ""country_code"": ""IL"",
    ""name"": ""LIVNE SARIG""
  },
  {
    ""country_code"": ""IL"",
    ""name"": ""SUKONIK VITALY""
  },
  {
    ""country_code"": ""IL"",
    ""name"": ""OPHIR EINAT""
  },
  {
    ""country_code"": ""BB"",
    ""name"": ""MARVELL WORLD TRADE LTD""
  }
]"
"[
  {
    ""country_code"": ""IL"",
    ""name"": ""YEDA RES & DEV""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GREEN ZACHARY L""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""EVP INT LLC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""NEXT IT CORP""
  }
]"
"[
  {
    ""country_code"": ""SA"",
    ""name"": ""UNIV KING SAUD""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""NEXUS TECH INC""
  }
]"
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""TRIPLE WIN TECH SHENZHEN CO LTD""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""LAVAZZA PROFES
Query:
SELECT t."country_code",
       COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value:"code"::STRING LIKE 'A61%'
GROUP BY t."country_code"
ORDER BY "patent_count" DESC
LIMIT 5;
Answer:
country_code,patent_count
US,6179
CN,4575
JP,3409
KR,2240
AU,2198
Query:
SELECT t."publication_number",
       t."assignee_harmonized",
       c.value:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value:"code"::STRING LIKE 'A61%'
LIMIT 100
Answer:
Too long, hard cut:
publication_number,assignee_harmonized,cpc_code
US-2007010420-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""ECOLAB""
  }
]",A61L9/16
US-2007010420-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""ECOLAB""
  }
]",A61L2/186
US-2007010420-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""ECOLAB""
  }
]",A61L2/183
US-2007010420-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""ECOLAB""
  }
]",A61L9/16
US-2007010420-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""ECOLAB""
  }
]",A61L2/183
US-2007010420-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""ECOLAB""
  }
]",A61L2/186
US-2006047298-A1,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""IMP COLLEGE INNOVATIONS LTD""
  }
]",A61B5/037
US-2006047298-A1,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""IMP COLLEGE INNOVATIONS LTD""
  }
]",A61M29/02
US-2006047298-A1,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""IMP COLLEGE INNOVATIONS LTD""
  }
]",A61B5/037
US-2006047298-A1,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""IMP COLLEGE INNOVATIONS LTD""
  }
]",A61B2562/164
US-2006047298-A1,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""IMP COLLEGE INNOVATIONS LTD""
  }
]",A61B5/227
US-2006047298-A1,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""IMP COLLEGE INNOVATIONS LTD""
  }
]",A61B2562/0247
US-2006047298-A1,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""IMP COLLEGE INNOVATIONS LTD""
  }
]",A61B2562/164
US-2006047298-A1,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""IMP COLLEGE INNOVATIONS LTD""
  }
]",A61M29/02
US-2006047298-A1,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""IMP COLLEGE INNOVATIONS LTD""
  }
]",A61B2562/0247
US-2006047298-A1,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""IMP COLLEGE INNOVATIONS LTD""
  }
]",A61B5/227
US-2006047298-A1,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""IMP COLLEGE INNOVATIONS LTD""
  }
]",A61B2562/046
US-2006047298-A1,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""IMP COLLEGE INNOVATIONS LTD""
  }
]",A61B2562/046
US-2006020170-A1,"[
  {
    ""country_code"": """",
    ""name"": ""MINNESOTA MEDICAL PHYSICS LLC""
  }
]",A61B1/32
US-2006020170-A1,"[
  {
    ""country_code"": """",
    ""name"": ""MINNESOTA MEDICAL PHYSICS LLC""
  }
]",A61N5/1001
US-2006020170-A1,"[
  {
    ""country_code"": """",
    ""name"": ""MINNESOTA MEDICAL PHYSICS LLC""
  }
]",A61B1/32
US-2006020170-A1,"[
  {
    ""country_code"": """",
    ""name"": ""MINNESOTA MEDICAL PHYSICS LLC""
  }
]",A61N5/1001
US-2006015009-A1,"[
  {
    ""country_code"": """",
    ""name"": ""JAFFE ROSS""
  },
  {
    ""country_code"": """",
    ""name"": ""TARTAGLIA JOSEPH M""
  },
  {
    ""country_code"": """",
    ""name"": ""BELSON AMIR""
  }
]",A61B1/0008
US-2006015009-A1,"[
  {
    ""country_code"": """",
    ""name"": ""JAFFE ROSS""
  },
  {
    ""country_code"": """",
    ""name"": ""TARTAGLIA JOSEPH M""
  },
  {
    ""country_code"": """",
    ""name"": ""BELSON AMIR""
  }
]",A61B1/0053
US-2006015009-A1,"[
  {
    ""country_code"": """",
    ""name"": ""JAFFE ROSS""
  },
  {
    ""country_code"": """",
    ""name"": ""TARTAGLIA JOSEPH M""
  },
  {
    ""country_code"": """",
    ""name"": ""BELSON AMIR""
  }
]",A61B1/00154
US-2006015009-A1,"[
  {
    ""country_code"": """",
    ""name"": ""JAFFE ROSS""
  },
  {
    ""country_code"": """",
    ""name"": ""TARTAGLIA JOSEPH M""
  },
  {
    ""country_code"": """",
    ""name"": ""BELSON AMIR""
  }
]",A61B1/0055
US-2006015009-A1,"[
  {
    ""country_code"": """",
    ""name"": ""JAFFE ROSS""
  },
  {
    ""country_code"": """",
    ""name"": ""TARTAGLIA JOSEPH M""
  },
  {
    ""country_code"": """",
    ""name"": ""BELSON AMIR""
  }
]",A61B1/31
US-2006015009-A1,"[
  {
    ""country_code"": """",
    ""name"": ""JAFFE ROSS""
  },
  {
    ""country_code"": """",
    ""name"": ""TARTAGLIA JOSEPH M""
  },
  {
    ""country_code"": """",
    ""name"": ""BELSON AMIR""
  }
]",A61M2025/0063
US-2006015009-A1,"[
  {
    ""country_code"": """",
    ""name"": ""JAFFE ROSS""
  },
  {
    ""country_code"": """",
    ""name"": ""TARTAGLIA JOSEPH M""
  },
  {
    ""country_code"": """",
    ""name"": ""BELSON AMIR""
  }
]",A61M25/0138
US-2006015009-A1,"[
  {
    ""country_code"": """",
    ""name"": ""JAFFE ROSS""
  },
  {
    ""country_code"": """",
    ""name"": ""TARTAGLIA JOSEPH M""
  },
  {
    ""country_code"": """",
    ""name"": ""BELSON AMIR""
  }
]",A61B1/00078
US-2006015009-A1,"[
  {
    ""country_code"": """",
    ""name"": ""JAFFE ROSS""
  },
  {
    ""country_code"": """",
    ""name"": ""TARTAGLIA JOSEPH M""
  },
  {
    ""country_code"": """",
    ""name"": ""BELSON AMIR""
  }
]",A61B2017/00336
US-2006015009-A1,"[
  {
    ""country_code"": """",
    ""name"": ""JAFFE ROSS""
  },
  {
    ""country_code"": """",
    ""name"": ""TARTAGLIA JOSEPH M""
  },
  {
    ""country_code"": """",
    ""name"": ""BELSON AMIR""
  }
]",A61B1/0057
US-2006015009-A1,"[
  {
    ""country_code"": """",
    ""name"": ""JAFFE ROSS
Query:
SELECT t."assignee_harmonized",
       COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value:"code"::STRING LIKE 'A61%'
GROUP BY t."assignee_harmonized"
ORDER BY "patent_count" DESC
LIMIT 100
Answer:
Too long, hard cut:
assignee_harmonized,patent_count
[],5311
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PROCTER & GAMBLE""
  }
]",147
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""HOFFMANN LA ROCHE""
  }
]",115
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""NOVARTIS AG""
  }
]",108
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""OREAL""
  }
]",97
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PFIZER""
  }
]",91
"[
  {
    ""country_code"": ""US"",
    ""name"": ""LILLY CO ELI""
  }
]",91
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BRISTOL MYERS SQUIBB CO""
  }
]",68
"[
  {
    ""country_code"": ""US"",
    ""name"": ""COVIDIEN LP""
  }
]",65
"[
  {
    ""country_code"": ""NL"",
    ""name"": ""KONINKLIJKE PHILIPS NV""
  }
]",60
"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV CALIFORNIA""
  }
]",60
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASTRAZENECA AB""
  }
]",58
"[
  {
    ""country_code"": ""US"",
    ""name"": ""COLGATE PALMOLIVE CO""
  }
]",57
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""MERCK PATENT GMBH""
  }
]",55
"[
  {
    ""country_code"": ""US"",
    ""name"": ""KIMBERLY CLARK CO""
  }
]",53
"[
  {
    ""country_code"": ""BE"",
    ""name"": ""JANSSEN PHARMACEUTICA NV""
  }
]",50
"[
  {
    ""country_code"": """",
    ""name"": ""HOFFMANN LA ROCHE""
  }
]",47
"[
  {
    ""country_code"": """",
    ""name"": ""OREAL""
  }
]",46
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BECTON DICKINSON CO""
  }
]",46
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MEDTRONIC INC""
  }
]",46
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""HOECHST AG""
  }
]",46
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""OLYMPUS CORP""
  }
]",45
"[
  {
    ""country_code"": """",
    ""name"": ""PROCTER & GAMBLE""
  }
]",45
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MERCK & CO INC""
  }
]",44
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BOEHRINGER INGELHEIM INT""
  }
]",43
"[
  {
    ""country_code"": """",
    ""name"": ""LILLY CO ELI""
  }
]",42
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GENENTECH INC""
  }
]",41
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BAYER AG""
  }
]",40
"[
  {
    ""country_code"": ""US"",
    ""name"": ""AMGEN INC""
  }
]",38
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""SCHERING AG""
  }
]",37
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BOSTON SCIENT SCIMED INC""
  }
]",36
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",34
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""SIEMENS AG""
  }
]",34
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""FUJIFILM CORP""
  }
]",33
"[
  {
    ""country_code"": """",
    ""name"": ""BAYER AG""
  }
]",32
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PFIZER PROD INC""
  }
]",32
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""UNI CHARM CORP""
  }
]",31
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ALLERGAN INC""
  }
]",31
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""ALCON INC""
  }
]",31
"[
  {
    ""country_code"": ""US"",
    ""name"": ""3M INNOVATIVE PROPERTIES CO""
  }
]",31
"[
  {
    ""country_code"": ""US"",
    ""name"": ""WARNER LAMBERT CO""
  }
]",30
"[
  {
    ""country_code"": """",
    ""name"": ""HOECHST AG""
  }
]",30
"[
  {
    ""country_code"": """",
    ""name"": ""COLGATE PALMOLIVE CO""
  }
]",30
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""TERUMO CORP""
  }
]",30
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""SANOFI AVENTIS DEUTSCHLAND""
  }
]",30
"[
  {
    ""country_code"": """",
    ""name"": ""MERCK & CO INC""
  }
]",29
"[
  {
    ""country_code"": ""DK"",
    ""name"": ""NOVO NORDISK AS""
  }
]",28
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GEN ELECTRIC""
  }
]",28
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""GLAXO GROUP LTD""
  }
]",28
"[
  {
    ""country_code"": ""US"",
    ""name"": ""WYETH CORP""
  }
]",27
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ETHICON INC""
  }
]",27
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""GRUENENTHAL GMBH""
  }
]",27
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BEIERSDORF AG""
  }
]",26
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ABBOTT LAB""
  }
]",26
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SCHERING CORP""
  }
]",26
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""SANOFI SA""
  }
]",26
"[
  {
    ""country_code"": """",
    ""name"": ""KIMBERLY CLARK CO""
  }
]",25
"[
  {
    ""country_code"": ""US"",
    ""name"": ""EDWARDS LIFESCIENCES CORP""
  }
]",25
"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV LELAND STANFORD JUNIOR""
  }
]",25
"[
  {
    ""country_code"": """",
    ""name"": ""PFIZER""
  }
]",24
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""SANOFI AVENTIS""
  }
]",23
"[
  {
    ""country_code"": ""NL"",
    ""name"": ""UNILEVER NV""
  }
]",23
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SMIT
Query:
SELECT t."publication_number",
       t."assignee_harmonized",
       TO_VARCHAR(TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
LIMIT 100;
Answer:
Too long, hard cut:
publication_number,assignee_harmonized,filing_year
US-2011047998-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""YAMAHA MOTOR CO LTD""
  }
]",2010
US-2011237510-A1,"[
  {
    ""country_code"": """",
    ""name"": ""BIODEL INC""
  }
]",2010
US-2011263715-A1,"[
  {
    ""country_code"": """",
    ""name"": ""PONGPEERAPAT ADCHARA""
  },
  {
    ""country_code"": """",
    ""name"": ""HIBI TORU""
  }
]",2010
US-2012084123-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""PAJIC NICK""
  }
]",2010
US-2011072347-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""CHESTNUT HILL SOUND INC""
  }
]",2010
US-2011094343-A1,"[
  {
    ""country_code"": """",
    ""name"": ""JI SUNG HOON""
  }
]",2010
US-2011098573-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""BOSTON SCIENT SCIMED INC""
  }
]",2010
US-2012099590-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""PITTS IAN""
  }
]",2010
US-2011044518-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""APERIO TECHNOLOGIES INC""
  }
]",2010
US-2011031504-A1,"[
  {
    ""country_code"": """",
    ""name"": ""QUICK NATHANIEL R""
  },
  {
    ""country_code"": """",
    ""name"": ""KAR ARAVINDA""
  }
]",2010
US-2011116353-A1,"[
  {
    ""country_code"": """",
    ""name"": ""SASA NOBORU""
  }
]",2010
US-2012027725-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""GALVIN JEFFREY A""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""LAI ZHENNAN""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""YANG QIANG""
  }
]",2010
US-2012060534-A1,"[
  {
    ""country_code"": ""CN"",
    ""name"": ""ZHANG MAOYONG""
  },
  {
    ""country_code"": ""CN"",
    ""name"": ""WANG JIANLIANG""
  }
]",2010
US-2011110848-A1,"[
  {
    ""country_code"": ""KR"",
    ""name"": ""KOREA ADVANCED INST SCI & TECH""
  }
]",2011
US-2011187089-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""FUJI KIKO KK""
  }
]",2011
US-2011162814-A1,"[
  {
    ""country_code"": """",
    ""name"": ""VADERS DENNIS HENRY""
  }
]",2011
US-2011268797-A1,"[
  {
    ""country_code"": ""TR"",
    ""name"": ""Sanovel IIac Sanayi Ve Ticaret Anonim Sirketi""
  }
]",2011
US-2011217972-A1,"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ERICSSON TELEFON AB L M""
  }
]",2009
US-2012021537-A1,"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SHIN DONG-SUK""
  },
  {
    ""country_code"": ""KR"",
    ""name"": ""LEE YONG-JOO""
  },
  {
    ""country_code"": ""KR"",
    ""name"": ""KIM DONG-HYUK""
  },
  {
    ""country_code"": ""KR"",
    ""name"": ""KIM MYUNG-SUN""
  },
  {
    ""country_code"": ""KR"",
    ""name"": ""CHUNG HOI-SUNG""
  }
]",2011
US-2012076185-A1,"[
  {
    ""country_code"": ""KR"",
    ""name"": ""PARK DAE-WOO""
  },
  {
    ""country_code"": ""KR"",
    ""name"": ""HONG YU-MI""
  },
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2011
US-2012077388-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""MEI RICHARD Y""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""MACAULEY DANIEL W""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""GERMAN MICHAEL""
  }
]",2011
US-2012063405-A1,"[
  {
    ""country_code"": ""KR"",
    ""name"": ""HAN JIN KYU""
  },
  {
    ""country_code"": ""KR"",
    ""name"": ""CHO JOON YOUNG""
  },
  {
    ""country_code"": ""KR"",
    ""name"": ""LEE JU HO""
  },
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2010
US-2012085101-A1,"[
  {
    ""country_code"": ""FR"",
    ""name"": ""GODEL FRANCK""
  },
  {
    ""country_code"": ""FR"",
    ""name"": ""GUEIT NICOLAS MARIE PIERRE""
  },
  {
    ""country_code"": ""FR"",
    ""name"": ""MAILLE JULIEN MARCEL ROGER""
  },
  {
    ""country_code"": ""FR"",
    ""name"": ""SNECMA""
  }
]",2010
US-2014365961-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""MICROSOFT CORP""
  }
]",2013
US-2015006254-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""LANDVOICE DATA LLC""
  }
]",2013
US-2015134778-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""MITSUBISHI ELECTRIC RES LAB""
  }
]",2013
US-2015134625-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""NETAPP INC""
  }
]",2013
US-2015159491-A1,"[
  {
    ""country_code"": """",
    ""name"": ""ASIA VITAL COMPONENTS CO LTD""
  }
]",2013
US-2015170065-A1,"[
  {
    ""country_code"": ""CA"",
    ""name"": ""VISIER SOLUTIONS INC""
  }
]",2013
US-2015232203-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""HONEYWELL INT INC""
  }
]",2014
US-2015138938-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""TOSHIBA KK""
  }
]",2014
US-2015257426-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""JOHN KEELER & CO INC""
  }
]",2014
US-2014338712-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV NOTRE DAME DU LAC""
  }
]",2014
US-2015347571-A1,"[
  {
    ""country_code"": ""NL"",
    ""name"": ""SYNERSCOPE B V""
  }
]",2014
US-2015357136-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""EATON CORP""
  }
]",2014
U
Query:
SELECT t."assignee_harmonized",
       TO_VARCHAR(TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year",
       COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value:"code"::STRING LIKE 'A61%'
  AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
GROUP BY t."assignee_harmonized", "filing_year"
ORDER BY t."assignee_harmonized", "patent_count" DESC
LIMIT 100
Answer:
assignee_harmonized,filing_year,patent_count
[],2018,303
[],2016,281
[],2017,280
[],2014,216
[],2021,214
[],2015,213
[],2019,208
[],2002,207
[],2013,194
[],2003,188
[],2020,185
[],2004,175
[],2011,164
[],2001,162
[],2022,156
[],2012,155
[],2009,154
[],2005,137
[],2006,136
[],2010,135
[],2008,114
[],2007,113
[],2000,102
[],1999,87
[],1997,82
[],1998,79
[],1996,73
[],1992,55
[],1994,52
[],1995,45
[],1991,43
[],2023,41
[],1990,39
[],1988,39
[],1989,37
[],1993,35
[],1986,25
[],1987,24
[],1981,22
[],1985,20
[],1973,19
[],1982,17
[],1974,16
[],1969,14
[],1980,13
[],1983,13
[],1979,12
[],1975,12
[],1976,12
[],2024,11
[],1966,11
[],1977,10
[],1971,9
[],1972,8
[],1964,7
[],1978,7
[],1970,7
[],1968,7
[],1965,6
[],1984,6
[],1967,5
[],1963,3
[],1928,2
[],1954,1
[],1948,1
[],1952,1
[],1934,1
[],1923,1
[],1941,1
[],1929,1
[],1949,1
[],1962,1
[],1959,1
[],1950,1
[],1936,1
"[
  {
    ""country_code"": """",
    ""name"": ""1ST AFFILIATED HOSPITAL GUANGZHOU UNIV CHINESE MEDICINE""
  }
]",2020,1
"[
  {
    ""country_code"": """",
    ""name"": ""1ST AFFILIATED HOSPITAL OF 3RD MILITARY MEDICAL UNIV PLA""
  }
]",2017,1
"[
  {
    ""country_code"": """",
    ""name"": ""1ST AFFILIATED HOSPITAL SUN YAT SEN UNIV""
  }
]",2021,1
"[
  {
    ""country_code"": """",
    ""name"": ""2ND AF HOSP & YUYING CHILDRENS HOSP OF WENZHOU MEDICAL UNIV""
  }
]",2020,1
"[
  {
    ""country_code"": """",
    ""name"": ""2ND AFFILIATED HOSPITAL NANJING MEDICAL UNIV""
  }
]",2017,1
"[
  {
    ""country_code"": """",
    ""name"": ""3B PHARMACEUTICAL LTD COMPANY""
  }
]",2020,1
"[
  {
    ""country_code"": """",
    ""name"": ""3M ESPE AG""
  }
]",2005,1
"[
  {
    ""country_code"": """",
    ""name"": ""3M INNOVATIVE PROPERTIES CO""
  }
]",2005,2
"[
  {
    ""country_code"": """",
    ""name"": ""3M INNOVATIVE PROPERTIES CO""
  }
]",2016,2
"[
  {
    ""country_code"": """",
    ""name"": ""3M INNOVATIVE PROPERTIES CO""
  }
]",2010,1
"[
  {
    ""country_code"": """",
    ""name"": ""3M INNOVATIVE PROPERTIES CO""
  }
]",2000,1
"[
  {
    ""country_code"": """",
    ""name"": ""3M INNOVATIVE PROPERTIES CO""
  }
]",2003,1
"[
  {
    ""country_code"": """",
    ""name"": ""3M INNOVATIVE PROPERTIES CO""
  }
]",2004,1
"[
  {
    ""country_code"": """",
    ""name"": ""3RD XIANGYA HOSPITAL CENTRAL SOUTH UNIV""
  }
]",2022,1
"[
  {
    ""country_code"": """",
    ""name"": ""3RD XIANGYA HOSPITAL CENTRAL SOUTH UNIV""
  }
]",2018,1
"[
  {
    ""country_code"": """",
    ""name"": ""41ST INST CHINA ELECTRONICS TECH GROUP CORP""
  },
  {
    ""country_code"": """",
    ""name"": ""BENGBU FIRST PEOPLES HOSPITAL""
  }
]",2017,1
"[
  {
    ""country_code"": """",
    ""name"": ""4D PHARMA RES LTD""
  }
]",2018,1
"[
  {
    ""country_code"": """",
    ""name"": ""4D PHARMA RES LTD""
  }
]",2020,1
"[
  {
    ""country_code"": """",
    ""name"": ""700303 ALBERTA LTD""
  }
]",1998,1
"[
  {
    ""country_code"": """",
    ""name"": ""8TH MEDICAL CENTER CHINESE PLA GENERAL HOSPITAL""
  }
]",2018,1
"[
  {
    ""country_code"": """",
    ""name"": ""AANESUTO BAA ON""
  }
]",1975,1
"[
  {
    ""country_code"": """",
    ""name"": ""AB2 BIO SA""
  }
]",2014,1
"[
  {
    ""country_code"": """",
    ""name"": ""ABALSEO PHARMACEUTICALS INC""
  }
]",2020,1
"[
  {
    ""country_code"": """",
    ""name"": ""ABBOTT CARDIOVASCULAR SYSTEMS""
  }
]",2014,1
"[
  {
    ""country_code"": """",
    ""name"": ""ABBOTT CARDIOVASCULAR SYSTEMS INC""
  }
]",2021,1
Query:
SELECT t."assignee_harmonized",
       TO_VARCHAR(TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year",
       COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
GROUP BY t."assignee_harmonized", "filing_year"
ORDER BY "patent_count" DESC
LIMIT 100;
Answer:
assignee_harmonized,filing_year,patent_count
[],2018,4250
[],2017,4031
[],2016,3955
[],2014,3523
[],2015,3474
[],2013,3017
[],2021,2632
[],2019,2517
[],2020,2269
[],2012,2266
[],2022,2193
[],2003,2025
[],2002,1948
[],2023,1903
[],2011,1885
[],1973,1829
[],2004,1774
[],1972,1736
[],2001,1701
[],1987,1649
[],1974,1646
[],1988,1588
[],2010,1578
[],1986,1556
[],1983,1546
[],1982,1512
[],2005,1510
[],2009,1496
[],1985,1479
[],1981,1472
[],1975,1470
[],1984,1441
[],1980,1399
[],1979,1380
[],1990,1378
[],1989,1377
[],1997,1375
[],2006,1367
[],2008,1330
[],1992,1323
[],1971,1304
[],1976,1298
[],1996,1286
[],1978,1276
[],2007,1256
[],1999,1216
[],1977,1204
[],1991,1180
[],2000,1179
[],1998,1167
[],1993,1159
[],1995,1014
[],1994,852
[],1970,683
[],1969,623
[],2024,607
[],1968,457
[],1966,385
[],1967,369
[],1965,324
[],1964,274
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2006,119
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2005,100
"[
  {
    ""country_code"": """",
    ""name"": ""NEC CORP""
  }
]",1988,98
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2021,97
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2020,93
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2007,86
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2022,83
"[
  {
    ""country_code"": """",
    ""name"": ""MATSUSHITA ELECTRIC IND CO LTD""
  }
]",1984,81
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2004,80
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2019,80
"[
  {
    ""country_code"": """",
    ""name"": ""NEC CORP""
  }
]",1986,79
"[
  {
    ""country_code"": ""US"",
    ""name"": ""IBM""
  }
]",2019,77
"[
  {
    ""country_code"": """",
    ""name"": ""MATSUSHITA ELECTRIC IND CO LTD""
  }
]",1999,76
"[
  {
    ""country_code"": """",
    ""name"": ""MATSUSHITA ELECTRIC IND CO LTD""
  }
]",2004,75
"[
  {
    ""country_code"": """",
    ""name"": ""NEC CORP""
  }
]",1989,75
"[
  {
    ""country_code"": """",
    ""name"": ""MATSUSHITA ELECTRIC IND CO LTD""
  }
]",2003,75
"[
  {
    ""country_code"": """",
    ""name"": ""MATSUSHITA ELECTRIC IND CO LTD""
  }
]",2005,74
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""LG ELECTRONICS INC""
  }
]",2019,72
"[
  {
    ""country_code"": ""US"",
    ""name"": ""QUALCOMM INC""
  }
]",2021,69
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2017,68
"[
  {
    ""country_code"": """",
    ""name"": ""MATSUSHITA ELECTRIC IND CO LTD""
  }
]",1990,67
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""HUAWEI TECH CO LTD""
  }
]",2020,67
"[
  {
    ""country_code"": """",
    ""name"": ""MITSUBISHI ELECTRIC CORP""
  }
]",1988,67
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2023,67
"[
  {
    ""country_code"": """",
    ""name"": ""HITACHI LTD""
  }
]",1988,66
"[
  {
    ""country_code"": ""US"",
    ""name"": ""IBM""
  }
]",2018,65
"[
  {
    ""country_code"": """",
    ""name"": ""MATSUSHITA ELECTRIC IND CO LTD""
  }
]",2001,64
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2015,64
"[
  {
    ""country_code"": """",
    ""name"": ""HITACHI LTD""
  }
]",1983,64
"[
  {
    ""country_code"": """",
    ""name"": ""HITACHI LTD""
  }
]",1985,64
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""HUAWEI TECH CO LTD""
  }
]",2021,64
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",2018,63
"[
  {
    ""country_code"": """",
    ""name"": ""MATSUSHITA ELECTRIC IND CO LTD""
  }
]",1987,63
"[
  {
    ""country_code"": """",
    ""name"": ""MATSUSHITA ELECTRIC IND CO LTD""
  }
]",1989,63
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""HUAWEI TECH CO LTD""
  }
]",2019,62
"[
  {
    ""country_code"": """",
    ""name"": ""NEC CORP""
  }
]",1987,62
"[
  {
    ""country_code"": """",
    ""name"": ""TOSHIBA CORP""
  }
]",1987,62
"[
  {
    ""country_code"": """",
    ""name"": ""TOSHIBA CORP""
  }
]",1988,61
"[
  {
    ""country_code"": """",
    ""name"": ""MATSUSHITA ELECTRIC IND CO LTD""
  }
]",1983,60
Query:
SELECT DISTINCT a.value:"name"::STRING AS "assignee"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE a.value:"name"::STRING IS NOT NULL
LIMIT 100
Answer:
assignee
BOEING CO
ALCAN TECH & MAN AG
NIPPON LIGHT METAL CO
CHEN CHIEN CHOU
FERRARI GREEN ENERGY S R L
ICI LTD
CELANESE CORP
ERBA FARMITALIA
RETZ FRITZ
KORGUONKAR ANUJA
FLINT STUART R
SAITO AKIHIKO
VAN DER HEIJDEN WILHELM ADRIAA
EVERS SMITH LINDA
YOON IL-SEOP
ANGELANTONI IND SPA
PETERS ABRAM HARMS
BRADLEY MORTON C
TUFTS COLLEGE
HENDRICKSON USA LLC
MOCKABEE WILLIAM H
GOICH JOHN
MINNS WALTER J
PANASONIC IP MAN CORP
KYOCERA DOCUMENT SOLUTIONS INC
DAIHATSU MOTOR CO LTD
CHIRON CORP
JFE STEEL CORP
AQUA KK
UNIV SAGA
HYUNDAI ENGINEERING CO LTD
SEONAMIS CO LTD
PROCTOR & SCHWARTZ INC
WHIRLPOOL CO
MARTINEZ RANDY G
UPHUS REINHARD
CARDIAC PACEMAKERS INC
KIM CHUL-HO
LEMASTER HERB
STEEN JUSTIN T
MIYAKE KUNIAKI
KIA MOTORS CORP
FUJI ELECTRIC CO LTD
PHARMACYCLICS LLC
NISHINAGA EUGENE IWAO
SUN XIAOPING
ALFA LAVAL AB
AREA IMPIANTI S P A
PEL TECHNOLOGIES LLC
MITSUBISHI GAS CHEMICAL CO
BORMASTER RONALD
DIALOG SEMICONDUCTOR INC
SONY GROUP CORP
M T C MACCH TRASFORMAZIONE CARTA S R L
ASML NETHERLANDS BV
AVAYA MAN LP
DARLING THOMAS ROBERT
JOHNSON JAMES G
CHAPA FERNANDO
PERASO TECH INC
THE CATHOLIC UNIV OF KOREA INDUSTRYâ€”ACADEMIC COOPERATION FOUNDATION
KAUTEX TEXTRON GMBH & CO KG
UNIV VIENNA
SHIN DONG-SUK
LANDVOICE DATA LLC
FUTUREWEI TECHNOLOGIES INC
PROBIOSWISS AG
IDEAWARE INC
MAYO FOUNDATION
DOUGLAS MACHINE INC
NINGBO FUYITE HYDRAULIC TECH CO LTD
CHENGDU IDEALSEE TECHNOLOGY CO LTD
SHENZHEN SHENLAN ZHITONG TECH CO LTD
HUIZHOU EVERPOWER TECH CO LTD
NANJING TECHNICAL VOCATIONAL COLLEGE NANJING BRANCH OF JIANGSU UNION TECHNICAL INST
TIN FREE SUBSECTION OF 7TH O 3 RES INSTITUTE OF CHINESE SHIP HEAVY INDUSTRY GROUP COMPANY
ANHUI MINGKUN ALUMINUM IND CO LTD
HY LINK SCIENCE&TECHNOLOGY CO LTD
LU ZHANPING
EGALAX_EMPIA TECH INC
PINHEIRO JOSE NEVES COSTA
DAIFUKU KK
BEYONTECH INC
MINNESOTA MEDICAL PHYSICS LLC
INSPEKTOR AHARON
POOLA KRISHNA LEELA
MANARESI NICOLO
FISCHER AG GEORG
ACCIAI SPECIALI TERNI SPA
PRECIOSA
LISTERNO TRADING LTD
OB EDINENNYJ INST YADERNYKH I
OOO NII PRIRODNYKH GAZOV I GAZ
A LIFE CORP
ECOTECH CO LTD
ZEISS CARL NTS GMBH
DAIMLER AG
MEYER HOLGER
SUKONIK VITALY
CAO DA-HUA
Query:
SELECT a.value:"name"::STRING AS "assignee_name",
       COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value:"code"::STRING LIKE 'A61%'
  AND a.value:"name"::STRING IS NOT NULL
GROUP BY a.value:"name"::STRING
ORDER BY "patent_count" DESC
LIMIT 10
Answer:
assignee_name,patent_count
PROCTER & GAMBLE,197
HOFFMANN LA ROCHE,189
OREAL,150
NOVARTIS AG,147
LILLY CO ELI,140
PFIZER,125
UNIV CALIFORNIA,98
BRISTOL MYERS SQUIBB CO,90
COLGATE PALMOLIVE CO,89
COVIDIEN LP,84
Query:
SELECT DISTINCT t."country_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value:"code"::STRING LIKE 'A61%'
LIMIT 100
Answer:
country_code
DO
UA
HR
DK
FI
KR
RO
GR
LT
PL
CR
CZ
HN
ZA
EP
US
DE
PH
DD
CO
WO
AU
CU
ZW
MA
RS
HU
JP
DZ
CH
PA
EG
MD
CY
IT
OA
MX
EE
GE
HK
GT
TN
NO
TR
BG
BE
SA
MY
CS
LV
PE
SI
AR
TW
IL
JO
IN
EC
SG
GB
CN
AT
YU
ZM
CA
SK
IS
SE
AP
ES
IE
EA
BR
ID
LU
NL
RU
NI
ME
SM
PT
CL
NZ
FR
SU
End Exploring Related Columns
Task: For the assignee who has been the most active in the patent category 'A61', I'd like to know the five patent jurisdictions code where they filed the most patents during their busiest year, separated by commas.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To determine the five patent jurisdiction codes where the most active assignee in the patent category 'A61' filed the most patents during their busiest year, we first identify the assignee with the highest number of patents classified under 'A61'. Next, we find the year in which this assignee filed the most patents. Finally, we list the top five jurisdiction codes where they filed the most patents in that year.

```csv
Jurisdiction_Codes
code1:str,code2:str,code3:str,code4:str,code5:str
(Attention: answer in one row)
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-26 04:35:16 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:35:16 - root - INFO - ```sql
WITH top_assignee AS (
    SELECT a.value:"name"::STRING AS "assignee_name",
           COUNT(DISTINCT t."publication_number") AS patent_count
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."cpc") c
         , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A61%'
      AND a.value:"name"::STRING IS NOT NULL
    GROUP BY a.value:"name"::STRING
    ORDER BY patent_count DESC NULLS LAST
    LIMIT 1
),
busiest_year AS (
    SELECT TO_VARCHAR(TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS filing_year,
           COUNT(DISTINCT t."publication_number") AS patent_count
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."cpc") c
         , LATERAL FLATTEN(input => t."assignee_harmonized") a
         , top_assignee ta
    WHERE c.value:"code"::STRING LIKE 'A61%'
      AND a.value:"name"::STRING = ta.assignee_name
      AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    GROUP BY filing_year
    ORDER BY patent_count DESC NULLS LAST
    LIMIT 1
),
top_jurisdictions AS (
    SELECT t."country_code",
           COUNT(DISTINCT t."publication_number") AS patent_count
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."cpc") c
         , LATERAL FLATTEN(input => t."assignee_harmonized") a
         , top_assignee ta
         , busiest_year by
    WHERE c.value:"code"::STRING LIKE 'A61%'
      AND a.value:"name"::STRING = ta.assignee_name
      AND TO_VARCHAR(TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') = by.filing_year
    GROUP BY t."country_code"
    ORDER BY patent_count DESC NULLS LAST
    LIMIT 5
)
SELECT LISTAGG(tj."country_code", ',') AS "Jurisdiction_Codes"
FROM top_jurisdictions tj;
```
2025-01-26 04:35:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:35:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:35:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:35:17 - snowflake.connector.connection - INFO - closed
2025-01-26 04:35:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:35:17 - root - INFO - itercount: 1
2025-01-26 04:35:17 - root - INFO - 001003 (42000): 01b9f653-0004-7d15-0001-11c300fa9b46: SQL compilation error:
syntax error line 34 at position 24 unexpected 'by'.
syntax error line 37 at position 82 unexpected 'by'.
2025-01-26 04:35:17 - root - INFO - Input sql:
WITH top_assignee AS (
    SELECT a.value:"name"::STRING AS "assignee_name",
           COUNT(DISTINCT t."publication_number") AS patent_count
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."cpc") c
         , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A61%'
      AND a.value:"name"::STRING IS NOT NULL
    GROUP BY a.value:"name"::STRING
    ORDER BY patent_count DESC NULLS LAST
    LIMIT 1
),
busiest_year AS (
    SELECT TO_VARCHAR(TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS filing_year,
           COUNT(DISTINCT t."publication_number") AS patent_count
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."cpc") c
         , LATERAL FLATTEN(input => t."assignee_harmonized") a
         , top_assignee ta
    WHERE c.value:"code"::STRING LIKE 'A61%'
      AND a.value:"name"::STRING = ta.assignee_name
      AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    GROUP BY filing_year
    ORDER BY patent_count DESC NULLS LAST
    LIMIT 1
),
top_jurisdictions AS (
    SELECT t."country_code",
           COUNT(DISTINCT t."publication_number") AS patent_count
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."cpc") c
         , LATERAL FLATTEN(input => t."assignee_harmonized") a
         , top_assignee ta
         , busiest_year by
    WHERE c.value:"code"::STRING LIKE 'A61%'
      AND a.value:"name"::STRING = ta.assignee_name
      AND TO_VARCHAR(TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') = by.filing_year
    GROUP BY t."country_code"
    ORDER BY patent_count DESC NULLS LAST
    LIMIT 5
)
SELECT LISTAGG(tj."country_code", ',') AS "Jurisdiction_Codes"
FROM top_jurisdictions tj;
The error information is:
001003 (42000): 01b9f653-0004-7d15-0001-11c300fa9b46: SQL compilation error:
syntax error line 34 at position 24 unexpected 'by'.
syntax error line 37 at position 82 unexpected 'by'.
Please correct it and output only 1 complete SQL query.
2025-01-26 04:35:57 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:35:57 - root - INFO - ```sql
WITH top_assignee AS (
    SELECT a.value:"name"::STRING AS "assignee_name",
           COUNT(DISTINCT t."publication_number") AS patent_count
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."cpc") c
         , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A61%'
      AND a.value:"name"::STRING IS NOT NULL
    GROUP BY a.value:"name"::STRING
    ORDER BY patent_count DESC NULLS LAST
    LIMIT 1
),
busiest_year AS (
    SELECT TO_VARCHAR(TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS filing_year,
           COUNT(DISTINCT t."publication_number") AS patent_count
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."cpc") c
         , LATERAL FLATTEN(input => t."assignee_harmonized") a
         , top_assignee ta
    WHERE c.value:"code"::STRING LIKE 'A61%'
      AND a.value:"name"::STRING = ta.assignee_name
      AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    GROUP BY filing_year
    ORDER BY patent_count DESC NULLS LAST
    LIMIT 1
),
top_jurisdictions AS (
    SELECT t."country_code",
           COUNT(DISTINCT t."publication_number") AS patent_count
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."cpc") c
         , LATERAL FLATTEN(input => t."assignee_harmonized") a
         , top_assignee ta
         , busiest_year busiest_y
    WHERE c.value:"code"::STRING LIKE 'A61%'
      AND a.value:"name"::STRING = ta.assignee_name
      AND TO_VARCHAR(TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') = busiest_y.filing_year
    GROUP BY t."country_code"
    ORDER BY patent_count DESC NULLS LAST
    LIMIT 5
)
SELECT LISTAGG(tj."country_code", ',') AS "Jurisdiction_Codes"
FROM top_jurisdictions tj;
```
2025-01-26 04:35:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:35:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:35:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:35:58 - snowflake.connector.connection - INFO - closed
2025-01-26 04:35:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:35:58 - root - INFO - itercount: 2
2025-01-26 04:35:58 - root - INFO - 000904 (42000): 01b9f653-0004-7d15-0001-11c300fa9b4a: SQL compilation error: error line 21 at position 35
invalid identifier 'TA.ASSIGNEE_NAME'
2025-01-26 04:35:58 - root - INFO - Input sql:
WITH top_assignee AS (
    SELECT a.value:"name"::STRING AS "assignee_name",
           COUNT(DISTINCT t."publication_number") AS patent_count
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."cpc") c
         , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A61%'
      AND a.value:"name"::STRING IS NOT NULL
    GROUP BY a.value:"name"::STRING
    ORDER BY patent_count DESC NULLS LAST
    LIMIT 1
),
busiest_year AS (
    SELECT TO_VARCHAR(TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS filing_year,
           COUNT(DISTINCT t."publication_number") AS patent_count
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."cpc") c
         , LATERAL FLATTEN(input => t."assignee_harmonized") a
         , top_assignee ta
    WHERE c.value:"code"::STRING LIKE 'A61%'
      AND a.value:"name"::STRING = ta.assignee_name
      AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    GROUP BY filing_year
    ORDER BY patent_count DESC NULLS LAST
    LIMIT 1
),
top_jurisdictions AS (
    SELECT t."country_code",
           COUNT(DISTINCT t."publication_number") AS patent_count
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."cpc") c
         , LATERAL FLATTEN(input => t."assignee_harmonized") a
         , top_assignee ta
         , busiest_year busiest_y
    WHERE c.value:"code"::STRING LIKE 'A61%'
      AND a.value:"name"::STRING = ta.assignee_name
      AND TO_VARCHAR(TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') = busiest_y.filing_year
    GROUP BY t."country_code"
    ORDER BY patent_count DESC NULLS LAST
    LIMIT 5
)
SELECT LISTAGG(tj."country_code", ',') AS "Jurisdiction_Codes"
FROM top_jurisdictions tj;
The error information is:
000904 (42000): 01b9f653-0004-7d15-0001-11c300fa9b4a: SQL compilation error: error line 21 at position 35
invalid identifier 'TA.ASSIGNEE_NAME'
Please correct it and output only 1 complete SQL query.
2025-01-26 04:36:23 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:36:23 - root - INFO - ```sql
WITH top_assignee AS (
    SELECT a.value:"name"::STRING AS "assignee_name",
           COUNT(DISTINCT t."publication_number") AS patent_count
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."cpc") c
         , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A61%'
      AND a.value:"name"::STRING IS NOT NULL
    GROUP BY a.value:"name"::STRING
    ORDER BY patent_count DESC NULLS LAST
    LIMIT 1
),
busiest_year AS (
    SELECT TO_VARCHAR(TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS filing_year,
           COUNT(DISTINCT t."publication_number") AS patent_count
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."cpc") c
         , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A61%'
      AND a.value:"name"::STRING = (SELECT assignee_name FROM top_assignee)
      AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    GROUP BY filing_year
    ORDER BY patent_count DESC NULLS LAST
    LIMIT 1
),
top_jurisdictions AS (
    SELECT t."country_code",
           COUNT(DISTINCT t."publication_number") AS patent_count
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."cpc") c
         , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A61%'
      AND a.value:"name"::STRING = (SELECT assignee_name FROM top_assignee)
      AND TO_VARCHAR(TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') = (SELECT filing_year FROM busiest_year)
    GROUP BY t."country_code"
    ORDER BY patent_count DESC NULLS LAST
    LIMIT 5
)
SELECT LISTAGG(tj."country_code", ',') AS "Jurisdiction_Codes"
FROM top_jurisdictions tj;
```
2025-01-26 04:36:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:36:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:36:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:36:25 - snowflake.connector.connection - INFO - closed
2025-01-26 04:36:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:36:25 - root - INFO - itercount: 3
2025-01-26 04:36:25 - root - INFO - 000904 (42000): 01b9f654-0004-7d15-0001-11c300fa9b5a: SQL compilation error: error line 20 at position 43
invalid identifier 'ASSIGNEE_NAME'
2025-01-26 04:36:25 - root - INFO - Input sql:
WITH top_assignee AS (
    SELECT a.value:"name"::STRING AS "assignee_name",
           COUNT(DISTINCT t."publication_number") AS patent_count
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."cpc") c
         , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A61%'
      AND a.value:"name"::STRING IS NOT NULL
    GROUP BY a.value:"name"::STRING
    ORDER BY patent_count DESC NULLS LAST
    LIMIT 1
),
busiest_year AS (
    SELECT TO_VARCHAR(TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS filing_year,
           COUNT(DISTINCT t."publication_number") AS patent_count
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."cpc") c
         , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A61%'
      AND a.value:"name"::STRING = (SELECT assignee_name FROM top_assignee)
      AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
    GROUP BY filing_year
    ORDER BY patent_count DESC NULLS LAST
    LIMIT 1
),
top_jurisdictions AS (
    SELECT t."country_code",
           COUNT(DISTINCT t."publication_number") AS patent_count
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."cpc") c
         , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A61%'
      AND a.value:"name"::STRING = (SELECT assignee_name FROM top_assignee)
      AND TO_VARCHAR(TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') = (SELECT filing_year FROM busiest_year)
    GROUP BY t."country_code"
    ORDER BY patent_count DESC NULLS LAST
    LIMIT 5
)
SELECT LISTAGG(tj."country_code", ',') AS "Jurisdiction_Codes"
FROM top_jurisdictions tj;
The error information is:
000904 (42000): 01b9f654-0004-7d15-0001-11c300fa9b5a: SQL compilation error: error line 20 at position 43
invalid identifier 'ASSIGNEE_NAME'
Please correct it and output only 1 complete SQL query.
2025-01-26 04:37:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:37:10 - root - INFO - ```sql
WITH
assignee_patents AS (
    SELECT
        t."publication_number",
        a.value:"name"::STRING AS "assignee_name",
        TO_VARCHAR(TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year",
        t."country_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."cpc") c
         , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A61%'
      AND a.value:"name"::STRING IS NOT NULL
      AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
),
top_assignee AS (
    SELECT assignee_name,
           COUNT(DISTINCT publication_number) AS patent_count
    FROM assignee_patents
    GROUP BY assignee_name
    ORDER BY patent_count DESC NULLS LAST
    LIMIT 1
),
busiest_year AS (
    SELECT filing_year,
           COUNT(DISTINCT publication_number) AS patent_count
    FROM assignee_patents
    WHERE assignee_name = (SELECT assignee_name FROM top_assignee)
    GROUP BY filing_year
    ORDER BY patent_count DESC NULLS LAST
    LIMIT 1
),
top_jurisdictions AS (
    SELECT country_code,
           COUNT(DISTINCT publication_number) AS patent_count
    FROM assignee_patents
    WHERE assignee_name = (SELECT assignee_name FROM top_assignee)
      AND filing_year = (SELECT filing_year FROM busiest_year)
    GROUP BY country_code
    ORDER BY patent_count DESC NULLS LAST
    LIMIT 5
)
SELECT LISTAGG(country_code, ',') AS "Jurisdiction_Codes"
FROM top_jurisdictions;
```
2025-01-26 04:37:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:37:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:37:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:37:12 - snowflake.connector.connection - INFO - closed
2025-01-26 04:37:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:37:13 - root - INFO - itercount: 4
2025-01-26 04:37:13 - root - INFO - 000904 (42000): 01b9f655-0004-7d15-0001-11c300fa9b62: SQL compilation error: error line 16 at position 11
invalid identifier 'ASSIGNEE_NAME'
2025-01-26 04:37:13 - root - INFO - Input sql:
WITH
assignee_patents AS (
    SELECT
        t."publication_number",
        a.value:"name"::STRING AS "assignee_name",
        TO_VARCHAR(TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year",
        t."country_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."cpc") c
         , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A61%'
      AND a.value:"name"::STRING IS NOT NULL
      AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
),
top_assignee AS (
    SELECT assignee_name,
           COUNT(DISTINCT publication_number) AS patent_count
    FROM assignee_patents
    GROUP BY assignee_name
    ORDER BY patent_count DESC NULLS LAST
    LIMIT 1
),
busiest_year AS (
    SELECT filing_year,
           COUNT(DISTINCT publication_number) AS patent_count
    FROM assignee_patents
    WHERE assignee_name = (SELECT assignee_name FROM top_assignee)
    GROUP BY filing_year
    ORDER BY patent_count DESC NULLS LAST
    LIMIT 1
),
top_jurisdictions AS (
    SELECT country_code,
           COUNT(DISTINCT publication_number) AS patent_count
    FROM assignee_patents
    WHERE assignee_name = (SELECT assignee_name FROM top_assignee)
      AND filing_year = (SELECT filing_year FROM busiest_year)
    GROUP BY country_code
    ORDER BY patent_count DESC NULLS LAST
    LIMIT 5
)
SELECT LISTAGG(country_code, ',') AS "Jurisdiction_Codes"
FROM top_jurisdictions;
The error information is:
000904 (42000): 01b9f655-0004-7d15-0001-11c300fa9b62: SQL compilation error: error line 16 at position 11
invalid identifier 'ASSIGNEE_NAME'
Please correct it and output only 1 complete SQL query.
2025-01-26 04:38:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:38:09 - root - INFO - ```sql
WITH
assignee_patents AS (
    SELECT
        t."publication_number",
        a.value:"name"::STRING AS "ASSIGNEE_NAME",
        TO_VARCHAR(TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "FILING_YEAR",
        t."country_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A61%'
      AND a.value:"name"::STRING IS NOT NULL
      AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
),
top_assignee AS (
    SELECT "ASSIGNEE_NAME",
           COUNT(DISTINCT "publication_number") AS "patent_count"
    FROM assignee_patents
    GROUP BY "ASSIGNEE_NAME"
    ORDER BY "patent_count" DESC NULLS LAST
    LIMIT 1
),
busiest_year AS (
    SELECT "FILING_YEAR",
           COUNT(DISTINCT "publication_number") AS "patent_count"
    FROM assignee_patents
    WHERE "ASSIGNEE_NAME" = (SELECT "ASSIGNEE_NAME" FROM top_assignee)
    GROUP BY "FILING_YEAR"
    ORDER BY "patent_count" DESC NULLS LAST
    LIMIT 1
),
top_jurisdictions AS (
    SELECT "country_code",
           COUNT(DISTINCT "publication_number") AS "patent_count"
    FROM assignee_patents
    WHERE "ASSIGNEE_NAME" = (SELECT "ASSIGNEE_NAME" FROM top_assignee)
      AND "FILING_YEAR" = (SELECT "FILING_YEAR" FROM busiest_year)
    GROUP BY "country_code"
    ORDER BY "patent_count" DESC NULLS LAST
    LIMIT 5
)
SELECT LISTAGG("country_code", ',') AS "Jurisdiction_Codes"
FROM top_jurisdictions;
```
2025-01-26 04:38:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:38:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:38:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:38:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-26 04:38:10 - snowflake.connector.connection - INFO - closed
2025-01-26 04:38:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:38:11 - root - INFO - itercount: 5
2025-01-26 04:38:11 - root - INFO - 0
2025-01-26 04:38:11 - root - INFO - results: 
Jurisdiction_Codes
"CA,US,AT,ZA,PE"


2025-01-26 04:38:11 - root - INFO - Please check the answer again by reviewing For the assignee who has been the most active in the patent category 'A61', I'd like to know the five patent jurisdictions code where they filed the most patents during their busiest year, separated by commas., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To determine the five patent jurisdiction codes where the most active assignee in the patent category 'A61' filed the most patents during their busiest year, we first identify the assignee with the highest number of patents classified under 'A61'. Next, we find the year in which this assignee filed the most patents. Finally, we list the top five jurisdiction codes where they filed the most patents in that year.

```csv
Jurisdiction_Codes
code1:str,code2:str,code3:str,code4:str,code5:str
(Attention: answer in one row)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Jurisdiction_Codes
"CA,US,AT,ZA,PE"
Current sql:
WITH
assignee_patents AS (
    SELECT
        t."publication_number",
        a.value:"name"::STRING AS "ASSIGNEE_NAME",
        TO_VARCHAR(TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "FILING_YEAR",
        t."country_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A61%'
      AND a.value:"name"::STRING IS NOT NULL
      AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
),
top_assignee AS (
    SELECT "ASSIGNEE_NAME",
           COUNT(DISTINCT "publication_number") AS "patent_count"
    FROM assignee_patents
    GROUP BY "ASSIGNEE_NAME"
    ORDER BY "patent_count" DESC NULLS LAST
    LIMIT 1
),
busiest_year AS (
    SELECT "FILING_YEAR",
           COUNT(DISTINCT "publication_number") AS "patent_count"
    FROM assignee_patents
    WHERE "ASSIGNEE_NAME" = (SELECT "ASSIGNEE_NAME" FROM top_assignee)
    GROUP BY "FILING_YEAR"
    ORDER BY "patent_count" DESC NULLS LAST
    LIMIT 1
),
top_jurisdictions AS (
    SELECT "country_code",
           COUNT(DISTINCT "publication_number") AS "patent_count"
    FROM assignee_patents
    WHERE "ASSIGNEE_NAME" = (SELECT "ASSIGNEE_NAME" FROM top_assignee)
      AND "FILING_YEAR" = (SELECT "FILING_YEAR" FROM busiest_year)
    GROUP BY "country_code"
    ORDER BY "patent_count" DESC NULLS LAST
    LIMIT 5
)
SELECT LISTAGG("country_code", ',') AS "Jurisdiction_Codes"
FROM top_jurisdictions;
2025-01-26 04:38:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:38:38 - root - INFO - To determine the five patent jurisdiction codes where the most active assignee in the patent category 'A61' filed the most patents during their busiest year, we first identify the assignee with the highest number of patents classified under 'A61'. Next, we find the year in which this assignee filed the most patents. Finally, we list the top five jurisdiction codes where they filed the most patents in that year.

```csv
Jurisdiction_Codes
CA,US,AT,ZA,PE
```

Here is the SQL query that accomplishes this:

```sql
WITH
assignee_patents AS (
    SELECT
        t."publication_number",
        a.value:"name"::STRING AS "ASSIGNEE_NAME",
        TO_VARCHAR(TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "FILING_YEAR",
        t."country_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    , LATERAL FLATTEN(input => t."cpc") c
    , LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE c.value:"code"::STRING LIKE 'A61%'
      AND a.value:"name"::STRING IS NOT NULL
      AND TRY_TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') IS NOT NULL
),
top_assignee AS (
    SELECT "ASSIGNEE_NAME",
           COUNT(DISTINCT "publication_number") AS "patent_count"
    FROM assignee_patents
    GROUP BY "ASSIGNEE_NAME"
    ORDER BY "patent_count" DESC NULLS LAST
    LIMIT 1
),
busiest_year AS (
    SELECT "FILING_YEAR",
           COUNT(DISTINCT "publication_number") AS "patent_count"
    FROM assignee_patents
    WHERE "ASSIGNEE_NAME" = (SELECT "ASSIGNEE_NAME" FROM top_assignee)
    GROUP BY "FILING_YEAR"
    ORDER BY "patent_count" DESC NULLS LAST
    LIMIT 1
),
top_jurisdictions AS (
    SELECT "country_code",
           COUNT(DISTINCT "publication_number") AS "patent_count"
    FROM assignee_patents
    WHERE "ASSIGNEE_NAME" = (SELECT "ASSIGNEE_NAME" FROM top_assignee)
      AND "FILING_YEAR" = (SELECT "FILING_YEAR" FROM busiest_year)
    GROUP BY "country_code"
    ORDER BY "patent_count" DESC NULLS LAST
    LIMIT 5
)
SELECT LISTAGG("country_code", ',') AS "Jurisdiction_Codes"
FROM top_jurisdictions;
```
2025-01-26 04:38:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:38:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:38:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:38:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-26 04:38:39 - snowflake.connector.connection - INFO - closed
2025-01-26 04:38:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:38:39 - root - INFO - itercount: 6
2025-01-26 04:38:39 - root - INFO - 0
2025-01-26 04:38:39 - root - INFO - Total iteration counts: 6
