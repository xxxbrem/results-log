2025-01-26 09:29:20 - openai._base_client - INFO - Retrying request to /chat/completions in 0.417392 seconds
2025-01-26 09:31:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 09:31:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:31:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:31:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:31:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 09:31:15 - snowflake.connector.connection - INFO - closed
2025-01-26 09:31:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:31:16 - root - INFO - SQL:
SELECT "publication_number", "country_code"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "country_code" = 'US'
   LIMIT 100;
Results:
publication_number,country_code
US-2006143594-A1,US
US-2006143284-A1,US
US-2006148139-A1,US
US-2006152123-A1,US
US-2006150698-A1,US
US-2005254871-A1,US
US-2005168584-A1,US
US-2005161997-A1,US
US-2005175186-A1,US
US-2006175765-A1,US
US-2005150005-A1,US
US-2006118954-A1,US
US-2005148066-A1,US
US-2006010011-A1,US
US-2006183586-A1,US
US-2005189252-A1,US
US-2005184759-A1,US
US-2005144256-A1,US
US-2006195821-A1,US
US-2005143653-A1,US
US-2006198380-A1,US
US-2006118870-A1,US
US-2005253263-A1,US
US-2006197375-A1,US
US-2005222693-A1,US
US-2005180450-A1,US
US-2006212456-A1,US
US-2005218642-A1,US
US-2005176269-A1,US
US-2006228959-A1,US
US-2006252404-A1,US
US-2006224211-A1,US
US-2006241817-A1,US
US-2005237771-A1,US
US-2005243216-A1,US
US-2005249541-A1,US
US-2006089219-A1,US
US-2005271201-A1,US
US-2005216965-A1,US
US-2005267909-A1,US
US-2006266770-A1,US
US-2005270599-A1,US
US-2006079895-A1,US
US-2005273202-A1,US
US-2006001866-A1,US
US-2006006761-A1,US
US-2006287882-A1,US
US-2005216567-A1,US
US-2006209512-A1,US
US-2006000939-A1,US
US-2006091163-A1,US
US-2007009364-A1,US
US-2006023254-A1,US
US-2005257319-A1,US
US-2007004239-A1,US
US-2006040365-A1,US
US-2005276065-A1,US
US-2007039052-A1,US
US-2006045302-A1,US
US-2006204424-A1,US
US-2007011371-A1,US
US-2007061140-A1,US
US-2006180497-A1,US
US-2007069906-A1,US
US-2006028190-A1,US
US-2006036325-A1,US
US-2006034112-A1,US
US-2007114474-A1,US
US-2006047060-A1,US
US-2006039234-A1,US
US-2006113251-A1,US
US-2006122815-A1,US
US-2007106350-A1,US
US-2006218841-A1,US
US-2006131931-A1,US
US-2007107149-A1,US
US-2006234529-A1,US
US-2006136397-A1,US
US-2006079849-A1,US
US-2006186294-A1,US
US-2006261821-A1,US
US-2006145963-A1,US
US-2006128522-A1,US
US-2006090877-A1,US
US-2007071085-A1,US
US-2007053149-A1,US
US-2007159350-A1,US
US-2006206019-A1,US
US-2006147574-A1,US
US-2006144602-A1,US
US-2006112201-A1,US
US-2006112495-A1,US
US-2006182055-A1,US
US-2007163684-A1,US
US-2007112592-A1,US
US-2006172276-A1,US
US-2006129939-A1,US
US-2006172084-A1,US
US-2006185810-A1,US
US-2007085071-A1,US

2025-01-26 09:31:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:31:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:31:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:31:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 80
2025-01-26 09:31:17 - snowflake.connector.connection - INFO - closed
2025-01-26 09:31:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:31:17 - root - INFO - SQL:
SELECT DISTINCT "kind_code"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100;
Results:
kind_code
S2
C1
R1
P
B7
F1
P9
H1
Y8
A4
A6
V0
A1
D1
U4
R
Z2
B1
S
D2
U8
I1
T9
U9
T2
Y2
D
L
F2
T3
B5
B2
U
A
V
U1
P1
C4
T1
Y4
A5
U0
T5
G2
B3
T4
A9
B6
E2
A0
B9
U5
C9
A3
A7
C3
A2
Y
T8
E
G
D0
B
Y1
C
U2
B8
C0
M
S1
U3
T
Q
B4
C2
C5
H3
Z
A8
I2

2025-01-26 09:31:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:31:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:31:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:31:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 09:31:19 - snowflake.connector.connection - INFO - closed
2025-01-26 09:31:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:31:19 - root - INFO - SQL:
SELECT "publication_number", "grant_date"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "grant_date" BETWEEN 20220801 AND 20220831
   LIMIT 100;
Results:
publication_number,grant_date
EP-3301435-B1,20220803
KR-102439233-B1,20220831
EP-3385453-B1,20220810
JP-7125184-B1,20220824
AU-2018303017-B2,20220818
AU-2017376451-B2,20220825
US-11419318-B2,20220823
CN-106730973-B,20220805
ES-2920330-T3,20220802
KR-102435135-B1,20220825
US-11410209-B1,20220809
KR-102429420-B1,20220803
KR-102433521-B1,20220818
KR-102428851-B1,20220804
US-11404885-B1,20220802
JP-7115329-B2,20220809
JP-7114086-B2,20220808
JP-7112010-B2,20220803
KR-102436743-B1,20220826
KR-102431129-B1,20220816
CN-217117893-U,20220805
CN-217293012-U,20220826
JP-7121498-B2,20220818
JP-7119614-B2,20220817
JP-7123656-B2,20220823
JP-7114408-B2,20220808
JP-7126659-B2,20220829
JP-7110148-B2,20220801
US-11401923-B2,20220802
US-11430204-B2,20220830
US-11401219-B2,20220802
US-11418754-B1,20220816
EP-3468467-B1,20220810
EP-3588086-B1,20220803
TW-I773687-B,20220811
CN-111041612-B,20220809
CN-113386807-B,20220812
CN-113493214-B,20220823
CN-113170948-B,20220809
CN-113242378-B,20220805
CN-113481542-B,20220805
CN-113506471-B,20220802
CN-114684653-B,20220812
JP-1721752-S,20220805
CN-108780473-B,20220816
CN-109415680-B,20220816
US-11406524-B2,20220809
KR-102438213-B1,20220830
CN-217244979-U,20220823
CN-217277263-U,20220823
CN-217155643-U,20220809
CN-217141006-U,20220809
CN-217203621-U,20220816
CN-217167273-U,20220812
CN-217199091-U,20220816
CN-217174809-U,20220812
CN-217335928-U,20220830
CN-217260486-U,20220823
CN-217109116-U,20220802
CN-217210924-U,20220816
CN-217175184-U,20220812
CN-217326054-U,20220830
CN-217090896-U,20220802
CN-217145454-U,20220809
CN-217332441-U,20220830
CN-217217332-U,20220816
CN-217277327-U,20220823
CN-217128436-U,20220805
CN-217226468-U,20220819
CN-217289961-U,20220826
CN-217099834-U,20220802
CN-217246741-U,20220823
CN-217106801-U,20220802
CN-217133349-U,20220805
CN-217160314-U,20220809
CN-217209478-U,20220816
CN-217209726-U,20220816
CN-217261490-U,20220823
CN-217266278-U,20220823
CN-217189805-U,20220816
CN-217238967-U,20220819
CN-217239112-U,20220819
CN-217229322-U,20220819
CN-217289218-U,20220826
CN-217314326-U,20220830
CN-217323734-U,20220830
CN-217216774-U,20220816
CN-217309544-U,20220830
CN-217093559-U,20220802
CN-217107618-U,20220802
CN-217202880-U,20220816
CN-217135660-U,20220805
CN-217291473-U,20220826
CN-217209199-U,20220816
CN-217186479-U,20220816
CN-217128891-U,20220805
CN-217184237-U,20220816
CN-217155131-U,20220809
CN-217247586-U,20220823
CN-217198947-U,20220816

2025-01-26 09:31:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:31:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:31:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:31:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 09:31:20 - snowflake.connector.connection - INFO - closed
2025-01-26 09:31:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:31:21 - root - INFO - SQL:
SELECT "publication_number", "grant_date", "kind_code"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "country_code" = 'US' AND
         "kind_code" = 'B2' AND
         "grant_date" BETWEEN 20220601 AND 20220930
   LIMIT 100;
Results:
publication_number,grant_date,kind_code
US-11383851-B2,20220712,B2
US-11453255-B2,20220927,B2
US-11373404-B2,20220628,B2
US-11421011-B2,20220823,B2
US-11384463-B2,20220712,B2
US-11413537-B2,20220816,B2
US-11414016-B2,20220816,B2
US-11415428-B2,20220816,B2
US-11451557-B2,20220920,B2
US-11374401-B2,20220628,B2
US-11437978-B2,20220906,B2
US-11447750-B2,20220920,B2
US-11397326-B2,20220726,B2
US-11440275-B2,20220913,B2
US-11445622-B2,20220913,B2
US-11441084-B2,20220913,B2
US-11434270-B2,20220906,B2
US-11363375-B2,20220614,B2
US-11419318-B2,20220823,B2
US-11452433-B2,20220927,B2
US-11420401-B2,20220823,B2
US-11360211-B2,20220614,B2
US-11398338-B2,20220726,B2
US-11453193-B2,20220927,B2
US-11412422-B2,20220809,B2
US-11354655-B2,20220607,B2
US-11387213-B2,20220712,B2
US-11375479-B2,20220628,B2
US-11405208-B2,20220802,B2
US-11420656-B2,20220823,B2
US-11434838-B2,20220906,B2
US-11438650-B2,20220906,B2
US-11378746-B2,20220705,B2
US-11375241-B2,20220628,B2
US-11380566-B2,20220705,B2
US-11448216-B2,20220920,B2
US-11416699-B2,20220816,B2
US-11412231-B2,20220809,B2
US-11457276-B2,20220927,B2
US-11453169-B2,20220927,B2
US-11443406-B2,20220913,B2
US-11389955-B2,20220719,B2
US-11446266-B2,20220920,B2
US-11441406-B2,20220913,B2
US-11368762-B2,20220621,B2
US-11375960-B2,20220705,B2
US-11404307-B2,20220802,B2
US-11433084-B2,20220906,B2
US-11407307-B2,20220809,B2
US-11410365-B2,20220809,B2
US-11386741-B2,20220712,B2
US-11370085-B2,20220628,B2
US-11385163-B2,20220712,B2
US-11391553-B2,20220719,B2
US-11430607-B2,20220830,B2
US-11412974-B2,20220816,B2
US-11439749-B2,20220913,B2
US-11453654-B2,20220927,B2
US-11453420-B2,20220927,B2
US-11423376-B2,20220823,B2
US-11363813-B2,20220621,B2
US-11426634-B2,20220830,B2
US-11365729-B2,20220621,B2
US-11419647-B2,20220823,B2
US-11375912-B2,20220705,B2
US-11451086-B2,20220920,B2
US-11448422-B2,20220920,B2
US-11416109-B2,20220816,B2
US-11454038-B2,20220927,B2
US-11453892-B2,20220927,B2
US-11433868-B2,20220906,B2
US-11396506-B2,20220726,B2
US-11386278-B2,20220712,B2
US-11372388-B2,20220628,B2
US-11374644-B2,20220628,B2
US-11450923-B2,20220920,B2
US-11387209-B2,20220712,B2
US-11445494-B2,20220913,B2
US-11440085-B2,20220913,B2
US-11428067-B2,20220830,B2
US-11449505-B2,20220920,B2
US-11418602-B2,20220816,B2
US-11449524-B2,20220920,B2
US-11439554-B2,20220913,B2
US-11396572-B2,20220726,B2
US-11407017-B2,20220809,B2
US-11360542-B2,20220614,B2
US-11379962-B2,20220705,B2
US-11370724-B2,20220628,B2
US-11416001-B2,20220816,B2
US-11450090-B2,20220920,B2
US-11396732-B2,20220726,B2
US-11374026-B2,20220628,B2
US-11369217-B2,20220628,B2
US-11407829-B2,20220809,B2
US-11399950-B2,20220802,B2
US-11381283-B2,20220705,B2
US-11409410-B2,20220809,B2
US-11456419-B2,20220927,B2
US-11437996-B2,20220906,B2

2025-01-26 09:31:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:31:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:31:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:31:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 09:31:22 - snowflake.connector.connection - INFO - closed
2025-01-26 09:31:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:31:23 - root - INFO - SQL:
SELECT "publication_number", "ipc"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100;
Results:
Too long, hard cut:
publication_number,ipc
CR-5634-A,"[
  {
    ""code"": ""G01N21/01"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CR-5990-A,[]
FI-429-A,"[
  {
    ""code"": ""C10C1/00"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
HK-6083-A,"[
  {
    ""code"": ""H02M5/00"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
HU-T52763-A,"[
  {
    ""code"": ""A01N43/54"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""A01N47/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D239/47"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D521/00"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
JP-H03206829-A,"[
  {
    ""code"": ""A01K61/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""A01K63/00"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
JP-S62159089-A,"[
  {
    ""code"": ""G21C5/10"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""G21C1/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
US-416-A,[]
US-2528225-A,"[
  {
    ""code"": ""E21B27/02"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A41580-A,"[
  {
    ""code"": ""B22D11/08"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A47682-A,"[
  {
    ""code"": ""C07D471/22"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D471/16"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A63682-A,"[
  {
    ""code"": ""G01N27/22"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-920790-A,"[
  {
    ""code"": ""C03C4/12"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-950907-A,"[
  {
    ""code"": ""C08K5/47"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/44"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D263/56"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D277/64"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/46"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/48"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/35"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C11B5/00"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10L1/14"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M135/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C09K15/30"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D235/12"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/3447"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-920830-A,"[
  {
    ""code"": ""E02D5/38"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/80"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/28"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/54"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/26"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-9086-A,[]
CH-3256-A,[]
CH-540255-A,"[
  {
    ""code"": ""C07D213/56"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/22"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/38"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/51"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/32"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/30"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CH-433637-A,[]
CH-8494-A,[]
CH-9587-A,[]
CH-9968-A,[]
DD-8297-A,[]
FR-1334211-A,"[
  {
    ""code"": ""C12H1/14"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
FR-1444995-A,"[
  {
    ""code"": ""C07F7/22"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
FR-1474468-A,"[
  {
    ""code"": ""G11B15/22"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""G11B15/62"",
    ""first"": false,
    ""inventive"": true,
    

2025-01-26 09:31:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:31:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:31:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:31:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 09:31:24 - snowflake.connector.connection - INFO - closed
2025-01-26 09:31:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:31:24 - root - INFO - SQL:
SELECT t."publication_number", ipc_u.value::VARIANT AS "ipc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."ipc") ipc_u
   LIMIT 100;
Results:
Too long, hard cut:
publication_number,ipc_code
WO-2017120317-A1,"{
  ""code"": ""C12M1/00"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017120317-A1,"{
  ""code"": ""G01N15/14"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017120317-A1,"{
  ""code"": ""B01L3/00"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017120317-A1,"{
  ""code"": ""G01N37/00"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017120317-A1,"{
  ""code"": ""G01N15/10"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017120317-A1,"{
  ""code"": ""C12M1/34"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017127291-A1,"{
  ""code"": ""G06F15/18"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017127659-A1,"{
  ""code"": ""E21B7/15"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017127659-A1,"{
  ""code"": ""E21B10/00"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017136263-A1,"{
  ""code"": ""F16H55/02"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017136263-A1,"{
  ""code"": ""F16H55/08"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017136263-A1,"{
  ""code"": ""B23H9/00"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017136263-A1,"{
  ""code"": ""F16H55/06"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017136263-A1,"{
  ""code"": ""B23P15/14"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017136263-A1,"{
  ""code"": ""F16H1/08"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017136263-A1,"{
  ""code"": ""B23F7/00"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017142834-A1,"{
  ""code"": ""A61K31/202"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2018169530-A1,"{
  ""code"": ""C09D133/10"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2018169530-A1,"{
  ""code"": ""C08L71/02"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017205009-A1,"{
  ""code"": ""G06F13/42"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017214099-A1,"{
  ""code"": ""B29C67/24"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017214099-A1,"{
  ""code"": ""B29C37/00"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017214099-A1,"{
  ""code"": ""C09D131/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017214099-A1,"{
  ""code"": ""B29C44/12"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017214099-A1,"{
  ""code"": ""C09J131/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017214099-A1,"{
  ""code"": ""C08J7/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017218485-A1,"{
  ""code"": ""G06Q20/34"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017218485-A1,"{
  ""code"": ""G06Q20/10"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017218485-A1,"{
  ""code"": ""G06Q20/38"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017223041-A1,"{
  ""code"": ""G02B21/36"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017223041-A1,"{
  ""code"": ""G02B21/00"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017223041-A1,"{
  ""code"": ""G02B21/08"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2018017413-A1,"{
  ""code"": ""G02B1/115"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2018017413-A1,"{
  ""code"": ""C23C14/22"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2018017413-A1,"{
  ""code"": ""G02B27/14"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2019040086-A1,"{
  ""code"": ""B29C51/36"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2019040086-A1,"{
  ""code"": ""B29L16/00"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
WO-2019040086-A1,"{
  ""code"": ""B29C70/36"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2019040086-A1,"{
  ""code"": ""B29C51/10"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2019040086-A1,"{
  ""code"": ""B29C53/24"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2018048690-A1,"{
  ""code"": ""C07C209/86"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2018048690-A1,"{
  ""code"": ""B01D3/36"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2018048690-A1,"{
  ""code"": ""B01D3/14"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2018075308-A1,"{
  ""code"": ""A61K47/10"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2018075308-A1,"{
  ""code"": ""A61K47/00"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2018075308-A1,"{
  ""code"": ""A61K47/36"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2018075308-A1,"{
  

2025-01-26 09:31:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:31:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:31:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:31:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 09:31:26 - snowflake.connector.connection - INFO - closed
2025-01-26 09:31:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:31:26 - root - INFO - SQL:
SELECT t."publication_number", ipc_u.value::VARIANT:"code"::STRING AS "ipc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."ipc") ipc_u
   LIMIT 100;
Results:
publication_number,ipc_code
JP-S5945815-B2,F02D1/04
JP-2579616-B2,H03M13/00
JP-2579616-B2,G11B20/18
JP-2873042-B2,H04N1/00
JP-2873042-B2,B65H31/00
JP-2873042-B2,B65H31/20
JP-S5760482-B2,F15B9/17
JP-S5760482-B2,F15B13/14
JP-S5760482-B2,E02F9/24
JP-S5760482-B2,F15B9/16
JP-S5760482-B2,E02F9/22
JP-S5760482-B2,B25J3/00
JP-H0146967-B2,H01H33/04
JP-H0146967-B2,H01H1/64
JP-H0146967-B2,H01H1/38
JP-H0146967-B2,H01H9/30
JP-H0773430-B2,H02N11/00
JP-H0773430-B2,F15B21/06
JP-3104132-B2,G01C21/00
JP-3104132-B2,G08G1/0969
JP-3104132-B2,G01S19/28
JP-4261671-B2,G06F17/30
JP-4261671-B2,H04N5/232
JP-4261671-B2,G06F3/048
JP-4261671-B2,H04N5/765
JP-4261671-B2,H04N5/781
JP-4261671-B2,H04N1/00
JP-S5652142-B2,D03D15/00
JP-S5652142-B2,D02G3/02
JP-S5652142-B2,D02G3/04
JP-S5652142-B2,D01G13/00
JP-3511416-B2,B29C41/28
JP-S57170-B2,B29C48/32
JP-S57170-B2,B29C47/84
JP-S57170-B2,B29C47/88
JP-S57170-B2,B29C47/00
JP-S57170-B2,B29C47/86
JP-S57170-B2,B29D7/01
JP-S57170-B2,B29C61/00
JP-3229917-B2,G02B23/00
JP-2608641-B2,B01J37/02
JP-2608641-B2,B01D53/86
JP-2608641-B2,F01N3/28
JP-2608641-B2,B01J35/04
JP-H0676643-B2,C22C38/00
JP-H0676643-B2,C22C38/58
JP-H0676643-B2,C22C38/50
JP-H0676643-B2,C21D8/02
JP-H0676643-B2,C21D7/02
JP-H0676643-B2,C21D8/06
JP-H0676643-B2,C21D8/08
JP-3006401-B2,H04Q3/58
JP-S5760-B2,A47K7/00
JP-H0553959-B2,F04F5/46
JP-H0553959-B2,F04F5/10
JP-3248160-B2,G06T1/00
JP-3248160-B2,G09B29/00
JP-3248160-B2,G06T11/60
JP-3248160-B2,G01C21/00
JP-3248160-B2,G06F17/50
JP-3248160-B2,G06F17/30
JP-H0151087-B2,H03F3/60
JP-H0151087-B2,H04B1/18
JP-3332459-B2,G06K15/02
JP-3332459-B2,B41M5/00
JP-3332459-B2,B41J2/21
JP-3332459-B2,H04N1/60
JP-3332459-B2,B41J2/525
JP-3332459-B2,B41J2/205
JP-3332459-B2,H04N1/46
JP-3332459-B2,H04N1/40
JP-3025972-B2,A23C9/13
JP-4430152-B2,A01N25/06
JP-4430152-B2,A01P7/04
JP-4430152-B2,A01N25/08
JP-4430152-B2,A01N43/36
JP-4430152-B2,A01N25/30
JP-4430152-B2,A01N59/00
JP-4430152-B2,A01N25/14
JP-4430152-B2,A01N25/00
JP-2695298-B2,H05K9/00
JP-2695298-B2,H05K7/00
JP-H0587220-B2,A23J3/16
JP-H0587220-B2,A23J3/26
JP-H0587220-B2,A23L1/18
JP-S527280-B2,A62B1/20
JP-S6338079-B2,C10J3/08
JP-S6338079-B2,C21B11/00
JP-S6338079-B2,C10J3/00
JP-S6338079-B2,C21B13/00
JP-S6338079-B2,C10J3/57
JP-2858438-B2,B41F31/02
JP-2858438-B2,B41F33/00
JP-H0353045-B2,B21C1/22
JP-H0353045-B2,B21D3/00
JP-3850133-B2,H05H7/14
JP-3158627-B2,B62H1/02
JP-3158627-B2,B62J99/00
JP-H0623891-B2,G03G15/08
JP-S619318-B2,A61P31/04

2025-01-26 09:31:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:31:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:31:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:31:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 09:31:27 - snowflake.connector.connection - INFO - closed
2025-01-26 09:31:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:31:28 - root - INFO - SQL:
SELECT t."publication_number",
          SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."ipc") ipc_u
   LIMIT 100;
Results:
publication_number,ipc4_code
US-2015177816-A1,G06F
US-2015177816-A1,G06F
US-2015177816-A1,G06F
US-2015180461-A1,H03K
US-2015180461-A1,H03K
US-2015271362-A1,H04N
US-2015271362-A1,G06K
US-2015314861-A1,B64C
US-2015340518-A1,C30B
US-2015340518-A1,C03C
US-2015340518-A1,H01L
US-2015340518-A1,H01L
US-2015340518-A1,H01L
US-2015340518-A1,C09D
US-2015340518-A1,C09D
US-2016275535-A1,G06Q
US-2016285437-A1,H03K
US-2016285437-A1,G06F
US-2015200352-A1,B41J
US-2015200352-A1,C04B
US-2015200352-A1,B41J
US-2015200352-A1,B41J
US-2015200352-A1,B41J
US-2015200352-A1,B05C
US-2015200352-A1,H10N
US-2015200352-A1,H10N
US-2015200352-A1,H10N
US-2015200352-A1,H10N
US-2015200352-A1,H10N
US-2015200352-A1,H10N
US-2015200352-A1,H10N
US-2016280116-A1,B60P
US-2015205759-A1,G06F
US-2016120347-A1,B63B
US-2016120347-A1,A47G
US-2015289441-A1,A01C
US-2015289441-A1,A01C
US-2016335166-A1,G06F
US-2016335166-A1,G06F
US-2016345465-A1,H05K
US-2016345465-A1,B23P
US-2015275041-A1,B29C
US-2015275041-A1,C08J
US-2015275041-A1,C09D
US-2016364384-A1,G06F
US-2016364384-A1,G06F
US-2016364384-A1,G06F
US-2015287715-A1,H01L
US-2015287715-A1,H01L
US-2015287715-A1,H01L
US-2015287715-A1,H01L
US-2015287715-A1,H01L
US-2015287715-A1,H10N
US-2016380415-A1,H02G
US-2016380415-A1,B25B
US-2015317187-A1,G06F
US-2016054804-A1,G06F
US-2016046061-A1,B29C
US-2016046061-A1,B65D
US-2016046061-A1,B29C
US-2016046061-A1,B29C
US-2016000087-A1,A01N
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,A61K
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D

2025-01-26 09:31:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:31:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:31:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:31:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 09:31:29 - snowflake.connector.connection - INFO - closed
2025-01-26 09:31:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:31:29 - root - INFO - SQL:
SELECT t."publication_number",
          SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."ipc") ipc_u
   WHERE t."country_code" = 'US' AND
         t."kind_code" = 'B2' AND
         t."grant_date" BETWEEN 20220601 AND 20220930
   LIMIT 100;
Results:
publication_number,ipc4_code
US-11368189-B2,G06F
US-11368189-B2,H04W
US-11368189-B2,H04W
US-11368189-B2,H04L
US-11368189-B2,H04B
US-11408566-B2,F17D
US-11408566-B2,E21B
US-11408566-B2,E21B
US-11408566-B2,E21B
US-11408566-B2,E21B
US-11408566-B2,F17D
US-11408566-B2,F17D
US-11408566-B2,F17D
US-11386539-B2,H01L
US-11386539-B2,G06T
US-11371080-B2,C12Q
US-11371080-B2,C12Q
US-11429930-B2,G16H
US-11429930-B2,G06F
US-11429930-B2,G06Q
US-11429930-B2,G16H
US-11429930-B2,G06F
US-11429930-B2,G16H
US-11429930-B2,G16H
US-11402589-B2,G02B
US-11402589-B2,F16B
US-11402589-B2,F16B
US-11402589-B2,G02B
US-11356221-B2,H04W
US-11356221-B2,H04J
US-11356221-B2,H04L
US-11356221-B2,H04L
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61Q
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11407172-B2,B29C
US-11407172-B2,B33Y
US-11407172-B2,B22F
US-11407172-B2,B33Y
US-11407172-B2,B29C
US-11407172-B2,B33Y
US-11407172-B2,B22F
US-11407172-B2,B29C
US-11407172-B2,B29C
US-11400006-B2,F16B
US-11400006-B2,A61B
US-11400006-B2,A61G
US-11391070-B2,G08B
US-11391070-B2,G07C
US-11391070-B2,E05B
US-11391070-B2,A47F
US-11391070-B2,E05B
US-11391070-B2,A47F
US-11391070-B2,G08B
US-11383851-B2,B64D
US-11383851-B2,B64C
US-11383851-B2,G05G
US-11383851-B2,B64C
US-11383851-B2,B64C
US-11453255-B2,B60C
US-11453255-B2,B60C
US-11453255-B2,B60C
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61M
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11384000-B2,C02F
US-11384000-B2,C02F
US-11384000-B2,G06F
US-11384000-B2,C02F
US-11369714-B2,A61L
US-11369714-B2,A61L
US-11369714-B2,A61L
US-11369714-B2,A61L
US-11369714-B2,A61L
US-11369714-B2,A61L
US-11369714-B2,C12N
US-11369714-B2,A61L
US-11373467-B2,G07C

2025-01-26 09:31:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:31:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:31:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:31:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 09:31:31 - snowflake.connector.connection - INFO - closed
2025-01-26 09:31:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:31:31 - root - INFO - SQL:
SELECT SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
           COUNT(*) AS "code_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    GROUP BY "ipc4_code"
    ORDER BY "code_count" DESC
    LIMIT 100;
Results:
ipc4_code,code_count
A61K,60048
G06F,40065
H01L,38756
A61P,30948
H04N,28623
C07D,26595
G01N,24118
C07C,20874
B01D,20328
H01M,20249
H04L,19101
B65D,17788
B29C,17478
A61B,16859
H04W,16710
B32B,13935
C12N,13902
C08L,13686
G06Q,12044
G02B,11835
B65G,11612
B01J,11549
G11B,11530
H05K,10458
F21V,10399
C02F,9969
H01R,9838
C08K,9750
C08F,9509
B23K,9066
H04B,8956
C07K,8629
A61M,8438
A23L,8302
B65H,8270
F24F,8251
C08G,8226
G01R,8108
C09D,8096
H02K,7975
G06T,7739
B24B,7518
A61F,7336
B41J,7150
B08B,7009
C04B,6981
A01N,6814
F16H,6798
F16K,6755
G02F,6627
H01H,6605
E04B,6485
F16L,6446
B01F,6384
B60R,6364
C23C,6363
G03G,6261
G06K,6253
A61L,6160
H02J,6053
E21B,5995
H04M,5925
H05B,5877
B21D,5850
B65B,5775
C22C,5760
H01B,5650
A01G,5600
B02C,5595
F26B,5448
H01F,5399
B23Q,5338
B62D,5274
A47B,5043
G01S,5040
E06B,5010
H01J,4982
G01B,4935
A47J,4884
G03B,4842
F04D,4694
G09G,4692
C09K,4520
A01K,4448
H01Q,4374
B26D,4308
G11C,4301
B05B,4272
C09J,4265
C11D,4211
G09F,4210
A63F,4171
C08J,4129
A63B,4067
A61Q,4025
H02M,3869
F16M,3859
E02D,3806
F16C,3789
F02D,3776

2025-01-26 09:31:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:31:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:31:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:31:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 37
2025-01-26 09:31:33 - snowflake.connector.connection - INFO - closed
2025-01-26 09:31:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:31:33 - root - INFO - SQL:
SELECT SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
           COUNT(*) AS "code_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US' AND
          t."kind_code" = 'B2' AND
          t."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY "ipc4_code"
    HAVING COUNT(*) >= 10
    ORDER BY "code_count" DESC
    LIMIT 100;
Results:
ipc4_code,code_count
G06F,104
H04N,76
H01L,71
A61B,68
H04L,50
A61K,47
H04W,38
G06T,37
G06V,36
G02B,27
B29C,22
B01J,21
G10L,21
G06N,20
A61M,20
E21B,18
C12N,17
B32B,17
G01S,16
H05B,16
G06Q,16
G02F,16
H04B,15
C10G,14
B25J,13
G16H,13
C08F,13
A61P,13
A61F,13
G06K,12
G05B,12
G01N,11
B65D,11
B23K,10
F04B,10
B65B,10
G01B,10

2025-01-26 09:31:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:31:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:31:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:31:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 09:31:34 - snowflake.connector.connection - INFO - closed
2025-01-26 09:31:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:31:35 - root - INFO - SQL:
SELECT DISTINCT t."publication_number",
           SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US' AND
          t."kind_code" = 'B2' AND
          t."grant_date" BETWEEN 20220601 AND 20220930
    LIMIT 100;
Results:
publication_number,ipc4_code
US-11435660-B2,G03F
US-11392816-B2,A01K
US-11420401-B2,B29C
US-11418602-B2,H04L
US-11423376-B2,G06V
US-11453255-B2,B60C
US-11376319-B2,A61K
US-11435444-B2,G01C
US-11381908-B2,H03F
US-11457276-B2,G06V
US-11384463-B2,A41H
US-11441084-B2,C10G
US-11374644-B2,H04B
US-11370085-B2,B24C
US-11451086-B2,H02J
US-11437597-B2,H10K
US-11422371-B2,G06T
US-11382363-B2,A41C
US-11443120-B2,G06V
US-11443120-B2,G06F
US-11365041-B2,B65D
US-11356221-B2,H04J
US-11375403-B2,H04L
US-11398087-B2,G06T
US-11436630-B2,G06Q
US-11447026-B2,H02P
US-11408566-B2,F17D
US-11434270-B2,A61M
US-11407017-B2,B21F
US-11401219-B2,B01J
US-11436431-B2,G06V
US-11373404-B2,H04N
US-11391553-B2,F42B
US-11365041-B2,F04B
US-11400006-B2,A61G
US-11428135-B2,F01N
US-11368189-B2,H04B
US-11440728-B2,B65D
US-11396572-B2,C08L
US-11434838-B2,F02D
US-11368762-B2,H04N
US-11409969-B2,H04B
US-11453246-B2,B60C
US-11369714-B2,C12N
US-11376718-B2,B25B
US-11424341-B2,H01L
US-11446260-B2,A61K
US-11434426-B2,G02F
US-11353091-B2,F16H
US-11376109-B2,B65B
US-11407574-B2,B65D
US-11416001-B2,G05D
US-11416001-B2,B63H
US-11433868-B2,F16D
US-11428067-B2,C06B
US-11367437-B2,G10L
US-11363375-B2,H04M
US-11370724-B2,B82Y
US-11406524-B2,A61G
US-11384463-B2,B44C
US-11386741-B2,G06T
US-11384000-B2,C02F
US-11376109-B2,A61F
US-11416001-B2,A01B
US-11435444-B2,G01S
US-11394671-B2,G06Q
US-11417842-B2,C08F
US-11436431-B2,G06N
US-11405208-B2,H04L
US-11373466-B2,B60W
US-11448422-B2,F24F
US-11426701-B2,B01F
US-11413710-B2,F16B
US-11422402-B2,B64D
US-11372439-B2,G01D
US-11380566-B2,G05B
US-11354278-B2,H04L
US-11363536-B2,H04W
US-11400486-B2,C11D
US-11455459-B2,G06F
US-11393239-B2,G06V
US-11407829-B2,C07K
US-11407829-B2,A61K
US-11446383-B2,A61K
US-11369979-B2,B08B
US-11389656-B2,A61N
US-11445622-B2,G06F
US-11422371-B2,G02F
US-11438668-B2,H04N
US-11428911-B2,G02B
US-11429930-B2,G06F
US-11442092-B2,H02P
US-11391059-B2,E05B
US-11423539-B2,A61B
US-11434270-B2,C07K
US-11436134-B2,G06F
US-11374186-B2,H01L
US-11384463-B2,G06V
US-11378383-B2,G05D
US-11367437-B2,H04R

2025-01-26 09:31:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:31:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:31:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:31:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 09:31:36 - snowflake.connector.connection - INFO - closed
2025-01-26 09:31:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:31:36 - root - INFO - SQL:
SELECT t."publication_number",
           COUNT(DISTINCT SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4)) AS "num_ipc4_codes"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US' AND
          t."kind_code" = 'B2' AND
          t."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY t."publication_number"
    LIMIT 100;
Results:
publication_number,num_ipc4_codes
US-11407174-B2,2
US-11389834-B2,2
US-11449524-B2,4
US-11380566-B2,4
US-11405983-B2,1
US-11374401-B2,2
US-11429930-B2,3
US-11415428-B2,1
US-11375590-B2,4
US-11447750-B2,3
US-11451086-B2,2
US-11440728-B2,2
US-11456032-B2,1
US-11393967-B2,1
US-11420401-B2,2
US-11394231-B2,1
US-11354655-B2,2
US-11449952-B2,2
US-11414016-B2,2
US-11444995-B2,3
US-11450326-B2,3
US-11441406-B2,2
US-11389656-B2,1
US-11392648-B2,2
US-11450090-B2,10
US-11376346-B2,1
US-11440085-B2,1
US-11446908-B2,1
US-11351045-B2,1
US-11419318-B2,3
US-11374644-B2,2
US-11392816-B2,3
US-11424884-B2,2
US-11379973-B2,4
US-11352465-B2,3
US-11408811-B2,2
US-11428135-B2,1
US-11402589-B2,2
US-11375403-B2,2
US-11386278-B2,3
US-11412923-B2,2
US-11451603-B2,1
US-11404853-B2,2
US-11387621-B2,1
US-11369979-B2,2
US-11357437-B2,1
US-11387209-B2,1
US-11375809-B2,1
US-11416109-B2,2
US-11367437-B2,2
US-11437597-B2,2
US-11454603-B2,1
US-11376319-B2,2
US-11410444-B2,2
US-11448216-B2,1
US-11434270-B2,4
US-11384000-B2,2
US-11369714-B2,2
US-11393351-B2,1
US-11448742-B2,1
US-11400486-B2,3
US-11457276-B2,3
US-11439749-B2,2
US-11446260-B2,2
US-11452433-B2,2
US-11352686-B2,2
US-11433868-B2,2
US-11396732-B2,1
US-11438650-B2,2
US-11393841-B2,2
US-11360211-B2,3
US-11401923-B2,2
US-11398593-B2,4
US-11410365-B2,2
US-11375912-B2,2
US-11371080-B2,1
US-11375241-B2,2
US-11438668-B2,1
US-11455459-B2,3
US-11424563-B2,2
US-11365729-B2,2
US-11400138-B2,2
US-11383851-B2,3
US-11373404-B2,4
US-11374186-B2,3
US-11368189-B2,4
US-11375960-B2,1
US-11385961-B2,1
US-11363222-B2,1
US-11380765-B2,1
US-11396572-B2,3
US-11445622-B2,4
US-11417842-B2,2
US-11436431-B2,2
US-11370724-B2,3
US-11436736-B2,3
US-11431960-B2,3
US-11444559-B2,1
US-11443228-B2,1
US-11387213-B2,1

2025-01-26 09:31:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:31:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:31:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:31:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 09:31:38 - snowflake.connector.connection - INFO - closed
2025-01-26 09:31:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:31:38 - root - INFO - SQL:
SELECT t."publication_number",
           LISTAGG(DISTINCT SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4), ',') AS "ipc4_codes"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US' AND
          t."kind_code" = 'B2' AND
          t."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY t."publication_number"
    LIMIT 100;
Results:
publication_number,ipc4_codes
US-11450326-B2,"G10L,B25J,G06V"
US-11415428-B2,G01C
US-11374401-B2,"H02H,H02M"
US-11405983-B2,H05B
US-11429930-B2,"G06Q,G06F,G16H"
US-11381283-B2,"H04B,H04W"
US-11447026-B2,"H02M,B60L,H02P,H02J"
US-11388673-B2,H04W
US-11441406-B2,"E21B,C09K"
US-11414016-B2,"B60R,B62D"
US-11444995-B2,"H04N,G06F,H04L"
US-11389656-B2,A61N
US-11381650-B2,"G16H,H04L,H04W"
US-11437996-B2,H03K
US-11450090-B2,"H05B,G06F,H04N,G05B,G16H,G06N,G06V,G06T,G06K,F21V"
US-11440085-B2,B22D
US-11376346-B2,A61L
US-11407174-B2,"B33Y,B29C"
US-11351045-B2,A61F
US-11375590-B2,"H05B,F21Y,F21S,G03B"
US-11447750-B2,"C12N,A01N,A61B"
US-11389834-B2,"B07C,G05B"
US-11426701-B2,"B22C,B29B,B29K,B01F,B29C"
US-11397326-B2,G02B
US-11443120-B2,"G10L,G06N,G06V,G06F,H04N,H04L,G06Q"
US-11446908-B2,B32B
US-11453193-B2,"G06F,H10K,G02F,G09F,B32B"
US-11386741-B2,"G07F,G06T"
US-11430204-B2,"G06V,H04N"
US-11453420-B2,"B60R,B61G,F16F"
US-11365729-B2,"F04B,F16K"
US-11449524-B2,"H04L,G06Q,G07B,G06F"
US-11451086-B2,"G05B,H02J"
US-11382705-B2,"B25J,A61B"
US-11440275-B2,"B29L,B29C,B29K"
US-11419318-B2,"A61K,A01K,C12N"
US-11392648-B2,"G10L,G06F"
US-11365041-B2,"F04B,B65D"
US-11380566-B2,"B66C,G05B,G03F,H01L"
US-11455459-B2,"G06Q,G06F,H04L"
US-11406832-B2,"G16H,A61N"
US-11440728-B2,"B65D,B65B"
US-11393967-B2,H01L
US-11384463-B2,"B41M,D06C,A41H,A41D,G06V,B44C,D06Q,D06M,B23K,D06B"
US-11398087-B2,"G06V,G06T"
US-11354261-B2,"G06F,G05B"
US-11412974-B2,"A61B,G16H"
US-11456419-B2,H01L
US-11379962-B2,"H04N,G06T"
US-11435551-B2,"G02B,H04N"
US-11363813-B2,A01N
US-11401428-B2,"B05D,C09D,C08G"
US-11445941-B2,"A61B,G02B,G01B"
US-11422523-B2,G05B
US-11352465-B2,"C08K,C08J,C08L"
US-11424884-B2,"H04W,H04L"
US-11428135-B2,F01N
US-11424563-B2,"H05K,H01R"
US-11398338-B2,H01F
US-11451557-B2,H04L
US-11421473-B2,E06B
US-11456032-B2,G11C
US-11434426-B2,"C09K,G02F"
US-11369217-B2,A47F
US-11374026-B2,H01L
US-11453749-B2,"G01N,C08G,C08L"
US-11391070-B2,"G08B,G07C,A47F,E05B"
US-11416022-B2,"G06F,G01R,G06J,H04L"
US-11453246-B2,B60C
US-11433084-B2,A61K
US-11407017-B2,"B21F,B21D"
US-11392814-B2,"G06K,G06N"
US-11434270-B2,"A61P,A61K,A61M,C07K"
US-11393351-B2,G09B
US-11369714-B2,"C12N,A61L"
US-11384000-B2,"C02F,G06F"
US-11354278-B2,"H04L,G06F,G06Q"
US-11407366-B2,B60R
US-11452433-B2,"A61B,G02B"
US-11439749-B2,"A61M,A61F"
US-11352686-B2,"C22C,C22F"
US-11446260-B2,"A61P,A61K"
US-11457276-B2,"H04N,G06V,H04H"
US-11427279-B2,B62K
US-11395931-B2,A62C
US-11379973-B2,"G06T,G06V,G05B,G06N"
US-11371080-B2,C12Q
US-11375241-B2,"G06T,H04N"
US-11408566-B2,"F17D,E21B"
US-11430084-B2,"G06N,G06F,G06T,G06V"
US-11434152-B2,"A23L,C02F"
US-11390055-B2,B32B
US-11400486-B2,"B05D,C11D,C09D"
US-11448742-B2,G01S
US-11433630-B2,"B29D,B29K,G02B"
US-11407307-B2,"F16H,B60K"
US-11420401-B2,"B29C,B25J"
US-11354655-B2,"G06F,G06Q"
US-11416001-B2,"B66F,B65G,B63G,A01B,G05D,B63H,B62D,G06F,G06T"
US-11432771-B2,A61B

2025-01-26 09:31:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:31:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:31:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:31:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 09:31:39 - snowflake.connector.connection - INFO - closed
2025-01-26 09:31:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:31:40 - root - INFO - SQL:
SELECT t."publication_number",
           ipc_u.value::VARIANT:"code"::STRING AS "ipc_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE ipc_u.value::VARIANT:"first"::BOOLEAN = true
    LIMIT 100;
Results:
publication_number,ipc_code
US-2017299239-A1,F25B39/00
US-2017217147-A1,B41C1/05
US-2017157230-A1,A61K39/00
US-2017294111-A1,G08B27/00
US-2018209343-A1,F02C7/18
US-2018209516-A1,F16H7/12
US-2017128414-A1,A61K31/381
US-2018213907-A1,A45C13/42
US-2017220072-A1,G06F1/16
US-2017139227-A1,G02B27/64
US-2017365664-A1,H01L29/16
US-2018250929-A1,B41F35/00
US-2017178700-A1,G11C7/06
US-2018260785-A1,G06Q10/10
US-2017185204-A1,G06F3/041
US-2017247327-A1,C07D209/52
US-2017197438-A1,B41J2/18
US-2018082949-A1,H01L23/525
US-2017206144-A1,G06F11/14
US-2018282042-A1,B65D75/58
US-2017208224-A1,H04N5/217
US-2017308977-A1,G06Q50/18
US-2017225515-A1,B60C11/12
US-2017280584-A1,H05K7/18
US-2017275886-A1,E04F11/00
US-2017304548-A1,A61M5/315
US-2017343044-A1,F16C33/14
US-2018003796-A1,G01S5/30
US-2018265940-A1,C21D8/06
US-2018085831-A1,B23B27/10
US-2018086852-A1,C08B37/08
US-2018176725-A1,H04W4/021
US-2018324179-A1,H04L29/06
US-2017232440-A1,B01L3/00
US-2017240822-A1,C10G51/02
US-2018336080-A1,G06F11/07
US-2017256849-A1,H01Q1/36
US-2018336142-A1,G06F12/128
US-2017342060-A1,C07D405/14
US-2018157518-A1,G06F9/455
US-2018349040-A1,G06F3/06
US-2017268286-A1,E06B3/673
US-2018150766-A1,G06N20/10
US-2017265534-A1,A41D13/005
US-2017343479-A1,G01N21/77
US-2018330275-A1,G06N20/00
US-2018289116-A1,A44C5/20
US-2018074693-A1,G06F3/0488
US-2017311592-A1,A01N33/12
US-2018031066-A1,F16D66/02
US-2018198453-A1,H03L7/085
US-2019037963-A1,A43B5/16
US-2017336253-A1,G01J1/42
US-2017363425-A1,G01C19/5776
US-2017357384-A1,G06F3/0481
US-2018055345-A1,A61B1/00
US-2018002533-A1,C09D5/14
US-2018007292-A1,H04N5/357
US-2019086218-A1,G01C21/34
US-2019242130-A1,E04C3/07
US-2018048878-A1,H04N13/239
US-2018100511-A1,F04D25/06
US-2018028529-A1,A61K31/485
US-2021210331-A1,H01J49/42
US-2018170890-A1,C07D307/50
US-2018365876-A1,G06T11/60
US-2019286461-A1,G06F9/451
US-2018205882-A1,H04N5/232
US-2018328368-A1,F04D25/08
US-2019164855-A1,H01L21/66
US-2018318275-A1,A61K31/4439
US-2018246672-A1,G06F3/06
US-2018341140-A1,G02F1/1339
US-2018270078-A1,H04L12/28
US-2018284544-A1,G02F1/1337
US-2018289660-A1,A61K31/26
US-2018364504-A1,G02F1/137
US-2018258054-A1,C07D239/42
US-2019130354-A1,G06Q10/08
US-2018130564-A1,G21F3/02
US-2018147645-A1,B23H1/02
US-2018248249-A1,H01Q1/24
US-2018151113-A1,G09G3/325
US-2018159083-A1,H01L51/52
US-2019182702-A1,H04W28/02
US-2018170618-A1,B65D23/14
US-2018178490-A1,B32B7/12
US-2018180342-A1,F25D3/10
US-2018177271-A1,A45C7/00
US-2019213009-A1,G06F9/30
US-2018218639-A1,G09B19/16
US-2018141330-A1,B41J2/045
US-2018226277-A1,H01L21/67
US-2018191901-A1,H04M3/51
US-2018264990-A1,B60Q1/00
US-2019259689-A1,H01L23/495
US-2018179229-A1,C07D519/00
US-2018277353-A1,H01L21/02
US-2019235684-A1,G06F3/041
US-2018193637-A1,A61N1/30

2025-01-26 09:31:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:31:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:31:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:31:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 09:31:41 - snowflake.connector.connection - INFO - closed
2025-01-26 09:31:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:31:42 - root - INFO - SQL:
SELECT t."publication_number",
           SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US' AND
          t."kind_code" = 'B2' AND
          t."grant_date" BETWEEN 20220601 AND 20220930 AND
          SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) IN (
              SELECT SUBSTRING(ipc_u2.value::VARIANT:"code"::STRING, 1, 4)
              FROM PATENTS.PATENTS.PUBLICATIONS t2,
                   LATERAL FLATTEN(input => t2."ipc") ipc_u2
              WHERE t2."country_code" = 'US' AND
                    t2."kind_code" = 'B2' AND
                    t2."grant_date" BETWEEN 20220601 AND 20220930
              GROUP BY SUBSTRING(ipc_u2.value::VARIANT:"code"::STRING, 1, 4)
              HAVING COUNT(*) >= 10
          )
    LIMIT 100;
Results:
publication_number,ipc4_code
US-11406524-B2,A61F
US-11406524-B2,A61F
US-11376109-B2,A61F
US-11439749-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11399950-B2,A61F
US-11399950-B2,A61F
US-11382760-B2,A61F
US-11382760-B2,A61F
US-11382760-B2,A61F
US-11422371-B2,G02F
US-11434426-B2,G02F
US-11396158-B2,G02F
US-11396158-B2,G02F
US-11422402-B2,G02F
US-11422402-B2,G02F
US-11431960-B2,G02F
US-11431960-B2,G02F
US-11431960-B2,G02F
US-11431960-B2,G02F
US-11431960-B2,G02F
US-11431960-B2,G02F
US-11431960-B2,G02F
US-11431960-B2,G02F
US-11431960-B2,G02F
US-11453193-B2,G02F
US-11438395-B2,G06N
US-11443406-B2,G06N
US-11443406-B2,G06N
US-11443228-B2,G06N
US-11436431-B2,G06N
US-11379726-B2,G06N
US-11379726-B2,G06N
US-11379726-B2,G06N
US-11379973-B2,G06N
US-11443120-B2,G06N
US-11443120-B2,G06N
US-11443120-B2,G06N
US-11392814-B2,G06N
US-11392814-B2,G06N
US-11450090-B2,G06N
US-11450090-B2,G06N
US-11450090-B2,G06N
US-11430084-B2,G06N
US-11398593-B2,G06N
US-11416699-B2,G06N
US-11386886-B2,G10L
US-11386886-B2,G10L
US-11443120-B2,G10L
US-11443120-B2,G10L
US-11443120-B2,G10L
US-11443120-B2,G10L
US-11443120-B2,G10L
US-11443120-B2,G10L
US-11392648-B2,G10L
US-11392648-B2,G10L
US-11367437-B2,G10L
US-11367437-B2,G10L
US-11367437-B2,G10L
US-11367437-B2,G10L
US-11450326-B2,G10L
US-11450326-B2,G10L
US-11450326-B2,G10L
US-11450326-B2,G10L
US-11438650-B2,G10L
US-11438650-B2,G10L
US-11438650-B2,G10L
US-11384463-B2,B23K
US-11384463-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11381650-B2,G16H
US-11406832-B2,G16H
US-11412974-B2,G16H
US-11412974-B2,G16H
US-11412974-B2,G16H
US-11412974-B2,G16H
US-11429930-B2,G16H
US-11429930-B2,G16H
US-11429930-B2,G16H
US-11429930-B2,G16H
US-11450090-B2,G16H
US-11416699-B2,G16H
US-11416699-B2,G16H
US-11373404-B2,G06T
US-11373280-B2,G06T
US-11373280-B2,G06T
US-11443406-B2,G06T
US-11443406-B2,G06T
US-11386539-B2,G06T
US-11422371-B2,G06T

2025-01-26 09:31:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:31:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:31:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:31:43 - snowflake.connector.connection - INFO - closed
2025-01-26 09:31:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:32:49 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 09:32:49 - root - INFO - The error you're encountering:

```
SQL compilation error: Lateral View cannot be on the left side of join
```

occurs because in Snowflake, you cannot perform a `JOIN` operation directly on a table that includes a `LATERAL FLATTEN` in the FROM clause. Specifically, the `LATERAL FLATTEN` function cannot be on the left side of a `JOIN`.

To resolve this issue, you can restructure your query by using Common Table Expressions (CTEs) to separate the `LATERAL FLATTEN` operations. This way, you avoid placing the `LATERAL FLATTEN` directly on the left side of a `JOIN`. 

Here's the corrected SQL query:

```sql
WITH code_counts AS (
    SELECT SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS ipc4_code,
           COUNT(*) AS code_count
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US'
      AND t."kind_code" = 'B2'
      AND t."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY ipc4_code
),
ipc_by_pub AS (
    SELECT t."publication_number",
           SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS ipc4_code
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US'
      AND t."kind_code" = 'B2'
      AND t."grant_date" BETWEEN 20220601 AND 20220930
)
SELECT p."publication_number", p."ipc4_code"
FROM (
    SELECT p."publication_number", p."ipc4_code",
           ROW_NUMBER() OVER (
               PARTITION BY p."publication_number"
               ORDER BY cc."code_count" DESC
           ) AS rn
    FROM ipc_by_pub p
    LEFT JOIN code_counts cc
      ON p."ipc4_code" = cc."ipc4_code"
) p
WHERE p.rn = 1
  AND p."ipc4_code" IN (
      SELECT ipc4_code
      FROM code_counts
      WHERE code_count >= 10
  )
LIMIT 100;
```

**Explanation:**

1. **CTE `code_counts`:** This subquery calculates the frequency (`code_count`) of each 4-digit IPC code (`ipc4_code`) among the specified patents.

2. **CTE `ipc_by_pub`:** This subquery extracts the publication numbers and their associated 4-digit IPC codes.

3. **Main Query:**

   - We perform a `LEFT JOIN` between `ipc_by_pub` and `code_counts` to associate each IPC code with its overall frequency.
   
   - We use the `ROW_NUMBER()` window function to rank the IPC codes for each publication based on the overall `code_count`. This helps in selecting the most frequent IPC code for each patent.
   
   - The condition `WHERE p.rn = 1` ensures that we select the IPC code with the highest frequency for each publication.
   
   - We then filter the results to include only those IPC codes that appear 10 or more times overall using the subquery:
     ```sql
     SELECT ipc4_code
     FROM code_counts
     WHERE code_count >= 10
     ```
   
4. **Result:** The final query lists the publication numbers and their most frequent 4-digit IPC codes, where the IPC code appears 10 or more times among all patents in the specified criteria.

**Sample Output Format:**

```csv
publication_number,ipc4_code
US-11374401-B2,H02M
US-11376543-B2,G06F
US-11412345-B2,A61K
...
```

(Attention: answer in the format specified.)

**Note:**

- By using CTEs, we avoid placing the `LATERAL FLATTEN` directly on the left side of a `JOIN`, thus resolving the error.
- Ensure that all column names are enclosed in double quotations as per the database's requirements.
- The `LIMIT 100` clause restricts the output to the first 100 rows.

**Brief Explanation of the Task Fulfillment:**

- **Identifying the Most Frequent IPC4 Code for Each Patent:**
  - The query calculates the overall frequency of each IPC4 code and assigns a rank to each IPC4 code per publication based on this frequency.
  - By selecting the IPC4 code with `rn = 1`, we choose the most frequent IPC4 code for each patent.

- **Filtering IPC4 Codes that Appear 10 or More Times:**
  - The condition `p."ipc4_code" IN (SELECT ipc4_code FROM code_counts WHERE code_count >= 10)` ensures that only IPC4 codes appearing 10 or more times are included in the final result.

---

**Additional Considerations:**

- If multiple IPC4 codes have the same frequency for a publication, the query will select one based on the default order (which may not be deterministic). If you need to handle ties differently, consider adjusting the `ORDER BY` clause within the `ROW_NUMBER()` function.

- Ensure that you have the necessary permissions to execute CTEs and that your environment supports the syntax used.
2025-01-26 09:32:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:32:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:32:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:32:50 - snowflake.connector.connection - INFO - closed
2025-01-26 09:32:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:33:44 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 09:33:44 - root - INFO - The error you're encountering:

```
SQL compilation error: error line 22 at position 35
invalid identifier 'P."ipc4_code"'
```

indicates that there is an issue with the use of aliases in your SQL query. Specifically, the outermost `SELECT` statement is referencing an undefined table alias `t` and not correctly referencing the column aliases from the subquery.

**Issues in Your Query:**

1. **Undefined Alias `t`:** In the outermost `SELECT` statement:

   ```sql
   SELECT t."publication_number", "ipc4_code"
   ```

   The alias `t` is not defined in this scope. The subquery is aliased as `sub`, so you should reference `sub."publication_number"` instead.

2. **Unqualified Column `"ipc4_code"`:** The column `"ipc4_code"` should also be prefixed with the subquery alias to avoid ambiguity.

3. **Missing Alias in `WHERE` Clause:** The `"rank"` column should be referenced with the correct alias in the `WHERE` clause.

**Corrected SQL Query:**

Here's the corrected query with the necessary changes:

```sql
SELECT sub."publication_number", sub."ipc4_code"
FROM (
    SELECT t."publication_number",
           SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
           DENSE_RANK() OVER (PARTITION BY t."publication_number" ORDER BY code_counts."code_count" DESC) AS "rank"
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."ipc") ipc_u
    LEFT JOIN (
        SELECT SUBSTRING(ipc_u2.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
               COUNT(*) AS "code_count"
        FROM PATENTS.PATENTS.PUBLICATIONS t2
             , LATERAL FLATTEN(input => t2."ipc") ipc_u2
        WHERE t2."country_code" = 'US'
          AND t2."kind_code" = 'B2'
          AND t2."grant_date" BETWEEN 20220601 AND 20220930
        GROUP BY "ipc4_code"
    ) code_counts ON SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) = code_counts."ipc4_code"
    WHERE t."country_code" = 'US'
      AND t."kind_code" = 'B2'
      AND t."grant_date" BETWEEN 20220601 AND 20220930
) sub
WHERE sub."rank" = 1
LIMIT 100;
```

**Explanation of Corrections:**

1. **Updated Outermost `SELECT` Clause:**

   - Changed `SELECT t."publication_number", "ipc4_code"` to `SELECT sub."publication_number", sub."ipc4_code"`
   - Since `t` is not defined in the outer scope, we reference the `publication_number` and `ipc4_code` from the subquery aliased as `sub`.

2. **Qualified Column in `WHERE` Clause:**

   - Changed `WHERE "rank" = 1` to `WHERE sub."rank" = 1`
   - We need to reference the `"rank"` column from the subquery `sub`.

3. **Consistent Aliasing:**

   - Ensured all references to columns in the outer query are properly prefixed with the `sub` alias.

**Alternate Solution Using Common Table Expressions (CTEs):**

Alternatively, to make the query clearer and avoid deep nesting, you can use CTEs as before:

```sql
WITH code_counts AS (
    SELECT SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
           COUNT(*) AS "code_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US'
      AND t."kind_code" = 'B2'
      AND t."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY ipc4_code
),
ipc_by_pub AS (
    SELECT t."publication_number",
           SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US'
      AND t."kind_code" = 'B2'
      AND t."grant_date" BETWEEN 20220601 AND 20220930
)
SELECT p."publication_number", p."ipc4_code"
FROM (
    SELECT p."publication_number", p."ipc4_code",
           ROW_NUMBER() OVER (
               PARTITION BY p."publication_number"
               ORDER BY cc."code_count" DESC
           ) AS rn
    FROM ipc_by_pub p
    LEFT JOIN code_counts cc
      ON p."ipc4_code" = cc."ipc4_code"
) sub
WHERE sub.rn = 1
  AND sub."ipc4_code" IN (
      SELECT ipc4_code
      FROM code_counts
      WHERE code_count >= 10
  )
LIMIT 100;
```

**Explanation:**

- The CTEs `code_counts` and `ipc_by_pub` are used to simplify the query.
- In the final `SELECT`, we perform a `ROW_NUMBER()` partitioned by `publication_number` and ordered by `code_count` to find the most frequent IPC4 code for each patent.
- The `WHERE sub.rn = 1` condition ensures we select only the top IPC4 code per publication.
- We filter to include only IPC4 codes that appear 10 or more times using the condition `AND sub."ipc4_code" IN (...)`.

**Sample Output Format:**

```csv
publication_number,ipc4_code
US-11435660-B2,G06F
US-11453255-B2,H04N
US-11373404-B2,H01L
...
```

**Note on Aliases and Identifiers:**

- Always ensure that column references are properly qualified with their table or subquery aliases to avoid ambiguity.
- In the `WHERE` clause and `SELECT` statement, use the correct aliases (`sub` in this case) to reference columns from the subquery.

**Testing the Query:**

- Before running the entire query, it's a good idea to test parts of it to ensure each component works correctly.
- You can run the CTEs separately to verify that they return the expected results.

**Summary:**

- The error was due to an undefined alias and unqualified column references in the outer query.
- By correcting the aliases and ensuring that all columns are properly referenced, the query should execute without errors.
- The corrected query fulfills the task of identifying the most frequent 4-digit IPC code for each U.S. utility patent under the B2 classification granted between June and September 2022, and listing those where the code appears 10 or more times.

**Final Answer in the Specified Format:**

```csv
publication_number,ipc4_code
publication_number1:str,ipc4_code1:str
publication_number2:str,ipc4_code2:str
...
```

We have listed the `publication_number` and the most frequent `ipc4_code` for each U.S. utility patent under the B2 classification granted between June and September 2022, where the IPC4 code appears 10 or more times.
2025-01-26 09:33:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:33:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:33:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:33:45 - snowflake.connector.connection - INFO - closed
2025-01-26 09:33:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:34:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 09:34:33 - root - INFO - The error you're encountering:

```
SQL compilation error: invalid identifier 'T."publication_number"'
```

indicates that the identifier `t."publication_number"` is invalid in the outermost `SELECT` statement. This is because the alias `t` is not defined in the outer scope—it is only defined within the subquery.

**Explanation of the Issue:**

In your query:

```sql
SELECT t."publication_number", "ipc4_code"
FROM (
    -- subquery
) sub
WHERE "rank" = 1
LIMIT 100;
```

- The alias `t` is not available in the outer `SELECT` clause.
- The subquery is aliased as `sub`, so you need to reference columns from the subquery using the `sub` alias.

Likewise, the `"ipc4_code"` column should also be prefixed with `sub` to avoid ambiguity.

Additionally, in the `WHERE` clause, `"rank"` should be referenced as `sub."rank"`.

**Corrected SQL Query:**

Here's the corrected query with appropriate aliasing:

```sql
SELECT sub."publication_number", sub."ipc4_code"
FROM (
    SELECT t."publication_number",
           SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
           DENSE_RANK() OVER (PARTITION BY t."publication_number" ORDER BY code_counts."code_count" DESC) AS "rank"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    LEFT JOIN (
        SELECT SUBSTRING(ipc_u2.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
               COUNT(*) AS "code_count"
        FROM PATENTS.PATENTS.PUBLICATIONS t2,
             LATERAL FLATTEN(input => t2."ipc") ipc_u2
        WHERE t2."country_code" = 'US' AND
              t2."kind_code" = 'B2' AND
              t2."grant_date" BETWEEN 20220601 AND 20220930
        GROUP BY "ipc4_code"
    ) code_counts ON SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) = code_counts."ipc4_code"
    WHERE t."country_code" = 'US' AND
          t."kind_code" = 'B2' AND
          t."grant_date" BETWEEN 20220601 AND 20220930
) sub
WHERE sub."rank" = 1
LIMIT 100;
```

**Explanation of Corrections:**

1. **Aliasing in the Outer SELECT:**

   - Changed `SELECT t."publication_number", "ipc4_code"` to `SELECT sub."publication_number", sub."ipc4_code"`.

   - Since `t` is not defined in the outer scope, we must reference columns from the subquery `sub`.

2. **Aliasing Columns:**

   - Prefixed `"ipc4_code"` with `sub` to become `sub."ipc4_code"`.

3. **Aliasing in the WHERE Clause:**

   - Changed `WHERE "rank" = 1` to `WHERE sub."rank" = 1`.

   - The `"rank"` column is part of the subquery `sub`, so we need to reference it accordingly.

**Alternative Query Using Common Table Expressions (CTEs):**

If you prefer, you can restructure your query using CTEs to improve readability and avoid aliasing issues:

```sql
WITH code_counts AS (
    SELECT SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS ipc4_code,
           COUNT(*) AS code_count
    FROM PATENTS.PATENTS.PUBLICATIONS t2,
         LATERAL FLATTEN(input => t2."ipc") ipc_u2
    WHERE t2."country_code" = 'US' AND
          t2."kind_code" = 'B2' AND
          t2."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY ipc4_code
),
ipc_data AS (
    SELECT t."publication_number",
           SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS ipc4_code
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US' AND
          t."kind_code" = 'B2' AND
          t."grant_date" BETWEEN 20220601 AND 20220930
)
SELECT sub."publication_number", sub."ipc4_code"
FROM (
    SELECT ipc_data."publication_number", ipc_data."ipc4_code",
           DENSE_RANK() OVER (PARTITION BY ipc_data."publication_number" ORDER BY code_counts."code_count" DESC) AS "rank"
    FROM ipc_data
    LEFT JOIN code_counts ON ipc_data."ipc4_code" = code_counts."ipc4_code"
) sub
WHERE sub."rank" = 1
  AND sub."ipc4_code" IN (
      SELECT ipc4_code FROM code_counts WHERE code_count >= 10
  )
LIMIT 100;
```

**Explanation:**

- **CTE `code_counts`:** Calculates the count of each IPC4 code among the specified patents.
- **CTE `ipc_data`:** Extracts publication numbers and their associated IPC4 codes.
- In the main query, we join `ipc_data` with `code_counts`, calculate the rank, and filter to select the most frequent IPC4 code per patent.
- The final `WHERE` clause ensures that only IPC4 codes appearing 10 or more times are included.

**Summary:**

- The error was due to referencing an undefined alias `t` and unqualified column names in the outermost query.
- By updating the column references to use the correct alias `sub`, the query should execute successfully.
- Using CTEs can help simplify complex queries and avoid such aliasing issues.

**Final Answer in the Specified Format:**

```csv
publication_number,ipc4_code
publication_number1:str,ipc4_code1:str
publication_number2:str,ipc4_code2:str
...
```

We have listed the `publication_number` and the most frequent `ipc4_code` for each U.S. utility patent under the B2 classification granted between June and September 2022, where the IPC4 code appears 10 or more times.

**Brief Explanation:**

- **Identifying the Most Frequent IPC4 Code for Each Patent:**
  - The query calculates the overall frequency of each IPC4 code among the specified patents.
  - It then ranks the IPC4 codes for each patent based on this frequency.
  - By selecting the IPC4 code with the highest rank (`rank = 1`), we identify the most frequent IPC4 code for each patent.

- **Filtering IPC4 Codes that Appear 10 or More Times:**
  - The `code_counts` subquery determines which IPC4 codes appear 10 or more times.
  - The final `WHERE` clause filters the results to include only those patents whose most frequent IPC4 code meets this criterion.

---

**Note:**

- Ensure that you have the necessary permissions to run these queries.
- The corrected query should resolve the error and produce the desired results.
2025-01-26 09:34:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:34:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:34:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:34:34 - snowflake.connector.connection - INFO - closed
2025-01-26 09:34:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:34:35 - root - INFO - SQL:
SELECT t."publication_number", "ipc4_code"
FROM (
    -- subquery
) sub
WHERE "rank" = 1
LIMIT 100;
Results:
001003 (42000): 01b9f77e-0004-7d15-0001-11c300fad34e: SQL compilation error:
syntax error line 4 at position 0 unexpected ')'.
2025-01-26 09:34:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:34:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:34:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:34:36 - snowflake.connector.connection - INFO - closed
2025-01-26 09:34:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:35:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 09:35:14 - root - INFO - The error you're encountering:

```
SQL compilation error:
Lateral View cannot be on the left side of join
```

occurs in Snowflake because you cannot perform a `JOIN` directly on a table that includes a `LATERAL FLATTEN` in the `FROM` clause. Specifically, a `LATERAL FLATTEN` function cannot be on the left side of a `JOIN`.

**Solution:**

To resolve this issue, we can restructure your query using Common Table Expressions (CTEs) to separate the `LATERAL FLATTEN` operations. This allows us to avoid placing the `LATERAL FLATTEN` directly on the left side of a `JOIN`.

Here's the corrected SQL query:

```sql
WITH code_counts AS (
    SELECT SUBSTRING(ipc_u2.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
           COUNT(*) AS "code_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t2,
         LATERAL FLATTEN(input => t2."ipc") ipc_u2
    WHERE t2."country_code" = 'US' AND
          t2."kind_code" = 'B2' AND
          t2."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY "ipc4_code"
    HAVING COUNT(*) >= 10
),
flattened_ipc AS (
    SELECT t."publication_number",
           SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US' AND
          t."kind_code" = 'B2' AND
          t."grant_date" BETWEEN 20220601 AND 20220930
),
ranked_ipc AS (
    SELECT fi."publication_number",
           fi."ipc4_code",
           DENSE_RANK() OVER (PARTITION BY fi."publication_number" ORDER BY cc."code_count" DESC) AS "rank"
    FROM flattened_ipc fi
    JOIN code_counts cc ON fi."ipc4_code" = cc."ipc4_code"
)
SELECT rp."publication_number", rp."ipc4_code"
FROM ranked_ipc rp
WHERE rp."rank" = 1
LIMIT 100;
```

**Explanation:**

1. **CTE `code_counts`:** This computes the count of each IPC4 code that appears 10 or more times among U.S. utility patents under the B2 classification granted between June and September 2022.

2. **CTE `flattened_ipc`:** This flattens the `ipc` column to extract each patent's publication number and associated IPC4 codes.

3. **CTE `ranked_ipc`:** This joins the flattened IPC codes with their counts and ranks them per publication based on the overall frequency.

4. **Final Selection:** We select the `publication_number` and the most frequent `ipc4_code` (where `rank = 1`) for each patent.

**Final Answer in the Requested Format:**

```csv
publication_number,ipc4_code
publication_number1:str,ipc4_code1:str
publication_number2:str,ipc4_code2:str
...
```

We have identified the most frequent 4-digit IPC code for each United States utility patent under the B2 classification granted between June and September of 2022. The IPC4 codes listed are those that appear 10 or more times across all such patents.

**Brief Explanation:**

- **Identifying the Most Frequent IPC4 Code for Each Patent:**
  - The `code_counts` CTE calculates the overall frequency of each IPC4 code.
  - The `ranked_ipc` CTE assigns a rank to each IPC4 code for each publication based on this frequency.
  - By selecting rows where `rank = 1`, we obtain the most frequent IPC4 code for each patent.

- **Filtering for IPC4 Codes Appearing 10 or More Times:**
  - The `HAVING COUNT(*) >= 10` clause in `code_counts` ensures we only consider IPC4 codes that appear at least 10 times.

**Additional Notes:**

- **Avoiding the Error:**
  - By using CTEs, we perform the `LATERAL FLATTEN` operations before the `JOIN`, ensuring that `LATERAL FLATTEN` is not on the left side of a `JOIN`.

- **Column Aliasing:**
  - Ensure that all column names are enclosed in double quotes as per your requirements.

- **Handling Ties:**
  - If multiple IPC4 codes have the same highest frequency for a patent, the `DENSE_RANK()` function will assign the same rank. The query will return all IPC4 codes with `rank = 1` for that patent.

---

**Example (Hypothetical Data):**

```csv
publication_number,ipc4_code
US-11435660-B2,G06F
US-11453255-B2,H04N
US-11373404-B2,H01L
...
```

Here, each `publication_number` is associated with its most frequent `ipc4_code`, where the IPC4 code appears 10 or more times among all patents in the specified criteria.

---

**Note:** This corrected query should resolve the error and produce the desired results. If you have any more questions or need further assistance, feel free to ask.
2025-01-26 09:35:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:35:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:35:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:35:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 09:35:15 - snowflake.connector.connection - INFO - closed
2025-01-26 09:35:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:36:15 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 09:36:15 - root - INFO - SQL:
WITH code_counts AS (
    SELECT SUBSTRING(ipc_u2.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
           COUNT(*) AS "code_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t2,
         LATERAL FLATTEN(input => t2."ipc") ipc_u2
    WHERE t2."country_code" = 'US' AND
          t2."kind_code" = 'B2' AND
          t2."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY "ipc4_code"
    HAVING COUNT(*) >= 10
),
flattened_ipc AS (
    SELECT t."publication_number",
           SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US' AND
          t."kind_code" = 'B2' AND
          t."grant_date" BETWEEN 20220601 AND 20220930
),
ranked_ipc AS (
    SELECT fi."publication_number",
           fi."ipc4_code",
           DENSE_RANK() OVER (PARTITION BY fi."publication_number" ORDER BY cc."code_count" DESC) AS "rank"
    FROM flattened_ipc fi
    JOIN code_counts cc ON fi."ipc4_code" = cc."ipc4_code"
)
SELECT rp."publication_number", rp."ipc4_code"
FROM ranked_ipc rp
WHERE rp."rank" = 1
LIMIT 100;
Results:
publication_number,ipc4_code
US-11429930-B2,G06F
US-11429930-B2,G06F
US-11447750-B2,A61B
US-11447750-B2,A61B
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11389834-B2,G05B
US-11444995-B2,G06F
US-11381650-B2,H04L
US-11381650-B2,H04L
US-11381650-B2,H04L
US-11405983-B2,H05B
US-11405983-B2,H05B
US-11392648-B2,G06F
US-11392648-B2,G06F
US-11392648-B2,G06F
US-11441406-B2,E21B
US-11375590-B2,H05B
US-11375590-B2,H05B
US-11407174-B2,B29C
US-11407174-B2,B29C
US-11449524-B2,G06F
US-11449524-B2,G06F
US-11419318-B2,A61K
US-11401923-B2,F04B
US-11410365-B2,G06F
US-11410365-B2,G06F
US-11450326-B2,G06V
US-11368189-B2,G06F
US-11374186-B2,H01L
US-11376319-B2,A61K
US-11376319-B2,A61K
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11390055-B2,B32B
US-11422402-B2,G06F
US-11422402-B2,G06F
US-11422402-B2,G06F
US-11422402-B2,G06F
US-11384177-B2,E21B
US-11384177-B2,E21B
US-11384177-B2,E21B
US-11397326-B2,G02B
US-11382705-B2,A61B
US-11382705-B2,A61B
US-11382705-B2,A61B
US-11382705-B2,A61B
US-11380566-B2,H01L
US-11380566-B2,H01L
US-11384463-B2,G06V
US-11398087-B2,G06T
US-11410148-B2,H04L
US-11373280-B2,G06T
US-11373280-B2,G06T
US-11412974-B2,A61B
US-11412974-B2,A61B
US-11412974-B2,A61B
US-11412974-B2,A61B
US-11354261-B2,G06F
US-11354261-B2,G06F
US-11354261-B2,G06F
US-11441084-B2,B01J
US-11441084-B2,B01J
US-11441084-B2,B01J
US-11441084-B2,B01J
US-11441084-B2,B01J
US-11441084-B2,B01J
US-11441084-B2,B01J
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11408566-B2,E21B
US-11408566-B2,E21B
US-11408566-B2,E21B
US-11408566-B2,E21B
US-11376109-B2,A61F
US-11418715-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F

2025-01-26 09:36:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:36:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:36:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:36:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 09:36:16 - snowflake.connector.connection - INFO - closed
2025-01-26 09:36:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:36:16 - root - INFO - SQL:
WITH ipc_counts AS (
    SELECT SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
           COUNT(*) AS "code_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t2
         , LATERAL FLATTEN(input => t2."ipc") ipc_u
    WHERE t2."country_code" = 'US'
      AND t2."kind_code" = 'B2'
      AND t2."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY "ipc4_code"
    HAVING COUNT(*) >= 10
),
ipc_flat AS (
    SELECT t."publication_number",
           SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US'
      AND t."kind_code" = 'B2'
      AND t."grant_date" BETWEEN 20220601 AND 20220930
)
SELECT ipc_flat."publication_number", ipc_flat."ipc4_code"
FROM ipc_flat
JOIN ipc_counts ON ipc_flat."ipc4_code" = ipc_counts."ipc4_code"
LIMIT 100
Results:
publication_number,ipc4_code
US-11445941-B2,G01B
US-11445941-B2,G01B
US-11378383-B2,G01B
US-11378383-B2,G01B
US-11378383-B2,G01B
US-11421980-B2,G01B
US-11421980-B2,G01B
US-11421980-B2,G01B
US-11353321-B2,G01B
US-11353321-B2,G01B
US-11384463-B2,B23K
US-11384463-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11365041-B2,B65D
US-11365041-B2,B65D
US-11365041-B2,B65D
US-11407574-B2,B65D
US-11440728-B2,B65D
US-11440728-B2,B65D
US-11440728-B2,B65D
US-11440728-B2,B65D
US-11376109-B2,B65D
US-11376109-B2,B65D
US-11376109-B2,B65D
US-11400006-B2,A61B
US-11432771-B2,A61B
US-11432771-B2,A61B
US-11432771-B2,A61B
US-11432771-B2,A61B
US-11432771-B2,A61B
US-11452433-B2,A61B
US-11452433-B2,A61B
US-11452433-B2,A61B
US-11412960-B2,A61B
US-11412960-B2,A61B
US-11412960-B2,A61B
US-11412960-B2,A61B
US-11412974-B2,A61B
US-11412974-B2,A61B
US-11412974-B2,A61B
US-11412974-B2,A61B
US-11419647-B2,A61B
US-11419647-B2,A61B
US-11419647-B2,A61B
US-11419647-B2,A61B
US-11419647-B2,A61B
US-11375912-B2,A61B
US-11382705-B2,A61B
US-11382705-B2,A61B
US-11382705-B2,A61B
US-11382705-B2,A61B
US-11439554-B2,A61B
US-11375960-B2,A61B
US-11375960-B2,A61B
US-11375960-B2,A61B
US-11375960-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11445941-B2,A61B
US-11445941-B2,A61B
US-11445941-B2,A61B
US-11445941-B2,A61B
US-11445941-B2,A61B
US-11445941-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11376070-B2,A61B
US-11376070-B2,A61B
US-11376070-B2,A61B
US-11376070-B2,A61B
US-11447750-B2,A61B
US-11447750-B2,A61B
US-11423539-B2,A61B
US-11412923-B2,A61M

2025-01-26 09:36:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:36:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:36:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:36:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 09:36:18 - snowflake.connector.connection - INFO - closed
2025-01-26 09:36:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:36:18 - root - INFO - SQL:
WITH code_counts AS (
    SELECT SUBSTRING(ipc_u2.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
           COUNT(*) AS "code_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t2
         , LATERAL FLATTEN(input => t2."ipc") ipc_u2
    WHERE t2."country_code" = 'US'
      AND t2."kind_code" = 'B2'
      AND t2."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY "ipc4_code"
),
ipc_data AS (
    SELECT t."publication_number",
           SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US'
      AND t."kind_code" = 'B2'
      AND t."grant_date" BETWEEN 20220601 AND 20220930
)
SELECT sub."publication_number", sub."ipc4_code"
FROM (
    SELECT ipc_data."publication_number", ipc_data."ipc4_code",
           DENSE_RANK() OVER (PARTITION BY ipc_data."publication_number" ORDER BY code_counts."code_count" DESC) AS "rank"
    FROM ipc_data
    LEFT JOIN code_counts ON ipc_data."ipc4_code" = code_counts."ipc4_code"
) sub
WHERE sub."rank" = 1
LIMIT 100
Results:
publication_number,ipc4_code
US-11415428-B2,G01C
US-11415428-B2,G01C
US-11419318-B2,A61K
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11389834-B2,G05B
US-11441406-B2,E21B
US-11437996-B2,H03K
US-11437996-B2,H03K
US-11376346-B2,A61L
US-11376346-B2,A61L
US-11380566-B2,H01L
US-11380566-B2,H01L
US-11449524-B2,G06F
US-11449524-B2,G06F
US-11405983-B2,H05B
US-11405983-B2,H05B
US-11374401-B2,H02M
US-11374401-B2,H02M
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11381650-B2,H04L
US-11381650-B2,H04L
US-11381650-B2,H04L
US-11360211-B2,G06V
US-11375912-B2,A61B
US-11412422-B2,H04L
US-11407174-B2,B29C
US-11407174-B2,B29C
US-11410365-B2,G06F
US-11410365-B2,G06F
US-11401923-B2,F04B
US-11392816-B2,G06K
US-11429930-B2,G06F
US-11429930-B2,G06F
US-11414016-B2,B60R
US-11410444-B2,G06F
US-11410444-B2,G06F
US-11410444-B2,G06F
US-11410444-B2,G06F
US-11440085-B2,B22D
US-11440085-B2,B22D
US-11440085-B2,B22D
US-11440085-B2,B22D
US-11392648-B2,G06F
US-11392648-B2,G06F
US-11392648-B2,G06F
US-11450326-B2,G06V
US-11401219-B2,B01J
US-11401219-B2,B01J
US-11401219-B2,B01J
US-11401219-B2,B01J
US-11401219-B2,B01J
US-11400486-B2,C09D
US-11400486-B2,C09D
US-11400486-B2,C09D
US-11400486-B2,C09D
US-11444995-B2,G06F
US-11373467-B2,G07C
US-11373467-B2,G07C
US-11363375-B2,G01S
US-11389656-B2,A61N
US-11442092-B2,G01R
US-11442092-B2,H02P
US-11407366-B2,B60R
US-11406832-B2,G16H
US-11453193-B2,G06F
US-11397326-B2,G02B
US-11382705-B2,A61B
US-11382705-B2,A61B
US-11382705-B2,A61B
US-11382705-B2,A61B
US-11364500-B2,B01L
US-11363222-B2,H04N
US-11363222-B2,H04N
US-11363222-B2,H04N
US-11453420-B2,B60R
US-11374644-B2,H04W
US-11390722-B2,C08G
US-11453255-B2,B60C
US-11453255-B2,B60C
US-11453255-B2,B60C
US-11422364-B2,G06T
US-11423539-B2,A61B
US-11421980-B2,G01S
US-11421980-B2,G01S
US-11413537-B2,G06F
US-11413537-B2,G06F

2025-01-26 09:36:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:36:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:36:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:36:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 09:36:20 - snowflake.connector.connection - INFO - closed
2025-01-26 09:36:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:36:20 - root - INFO - SQL:
WITH code_counts AS (
    SELECT SUBSTRING(ipc_u2.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
           COUNT(*) AS "code_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t2
         , LATERAL FLATTEN(input => t2."ipc") ipc_u2
    WHERE t2."country_code" = 'US'
      AND t2."kind_code" = 'B2'
      AND t2."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY "ipc4_code"
    HAVING COUNT(*) >= 10
),
ipc_data AS (
    SELECT t."publication_number",
           SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US'
      AND t."kind_code" = 'B2'
      AND t."grant_date" BETWEEN 20220601 AND 20220930
)
SELECT sub."publication_number", sub."ipc4_code"
FROM (
    SELECT ipc_data."publication_number", ipc_data."ipc4_code",
           DENSE_RANK() OVER (PARTITION BY ipc_data."publication_number" ORDER BY code_counts."code_count" DESC) AS "rank"
    FROM ipc_data
    JOIN code_counts ON ipc_data."ipc4_code" = code_counts."ipc4_code"
) sub
WHERE sub."rank" = 1
LIMIT 100
Results:
publication_number,ipc4_code
US-11447750-B2,A61B
US-11447750-B2,A61B
US-11389834-B2,G05B
US-11381650-B2,H04L
US-11381650-B2,H04L
US-11381650-B2,H04L
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11429930-B2,G06F
US-11429930-B2,G06F
US-11375590-B2,H05B
US-11375590-B2,H05B
US-11392648-B2,G06F
US-11392648-B2,G06F
US-11392648-B2,G06F
US-11407174-B2,B29C
US-11407174-B2,B29C
US-11449524-B2,G06F
US-11449524-B2,G06F
US-11444995-B2,G06F
US-11405983-B2,H05B
US-11405983-B2,H05B
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11419318-B2,A61K
US-11422402-B2,G06F
US-11422402-B2,G06F
US-11422402-B2,G06F
US-11422402-B2,G06F
US-11384177-B2,E21B
US-11384177-B2,E21B
US-11384177-B2,E21B
US-11440728-B2,B65D
US-11440728-B2,B65D
US-11440728-B2,B65D
US-11440728-B2,B65D
US-11390055-B2,B32B
US-11376109-B2,A61F
US-11434426-B2,G02F
US-11374026-B2,H01L
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11445494-B2,H04W
US-11445494-B2,H04W
US-11445494-B2,H04W
US-11445494-B2,H04W
US-11443406-B2,G06F
US-11443406-B2,G06F
US-11379726-B2,G06N
US-11379726-B2,G06N
US-11379726-B2,G06N
US-11392814-B2,G06N
US-11392814-B2,G06N
US-11392816-B2,G06K
US-11433630-B2,G02B
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11453749-B2,G01N
US-11422364-B2,G06T
US-11412422-B2,H04L
US-11365041-B2,B65D
US-11365041-B2,B65D
US-11365041-B2,B65D
US-11455459-B2,G06F
US-11455459-B2,G06F
US-11455459-B2,G06F
US-11455459-B2,G06F
US-11455459-B2,G06F
US-11454603-B2,G01N
US-11454603-B2,G01N
US-11454603-B2,G01N
US-11384463-B2,G06V
US-11435551-B2,H04N
US-11401923-B2,F04B
US-11410365-B2,G06F
US-11410365-B2,G06F
US-11436736-B2,G06T
US-11436736-B2,G06T
US-11387213-B2,H01L

2025-01-26 09:36:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:36:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:36:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:36:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 09:36:22 - snowflake.connector.connection - INFO - closed
2025-01-26 09:36:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:36:22 - root - INFO - SQL:
WITH ipc_counts AS (
    SELECT SUBSTRING(ipc_u2.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
           COUNT(*) AS "code_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t2
         , LATERAL FLATTEN(input => t2."ipc") ipc_u2
    WHERE t2."country_code" = 'US'
      AND t2."kind_code" = 'B2'
      AND t2."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY "ipc4_code"
    HAVING COUNT(*) >= 10
)
SELECT t."publication_number",
       SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
FROM PATENTS.PATENTS.PUBLICATIONS t
     , LATERAL FLATTEN(input => t."ipc") ipc_u
WHERE t."country_code" = 'US'
  AND t."kind_code" = 'B2'
  AND t."grant_date" BETWEEN 20220601 AND 20220930
  AND SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) IN (
      SELECT "ipc4_code" FROM ipc_counts
  )
LIMIT 100
Results:
publication_number,ipc4_code
US-11407172-B2,B29C
US-11357437-B2,A61B
US-11382705-B2,A61B
US-11438668-B2,H04N
US-11450090-B2,H04N
US-11410444-B2,G06F
US-11450090-B2,G06F
US-11436134-B2,G06F
US-11433084-B2,A61K
US-11353839-B2,H05B
US-11429930-B2,G06Q
US-11400138-B2,A61P
US-11428067-B2,E21B
US-11441406-B2,E21B
US-11407574-B2,B65D
US-11376109-B2,B65D
US-11370724-B2,B01J
US-11422402-B2,H04N
US-11412960-B2,B65B
US-11456776-B2,G05B
US-11375479-B2,H04W
US-11435551-B2,G02B
US-11428911-B2,G02B
US-11388258-B2,H04L
US-11392648-B2,G06F
US-11368189-B2,G06F
US-11416001-B2,G06F
US-11411015-B2,H01L
US-11449524-B2,G06Q
US-11436630-B2,G06Q
US-11384177-B2,E21B
US-11399950-B2,A61F
US-11367437-B2,G10L
US-11401219-B2,B01J
US-11444995-B2,H04N
US-11445941-B2,A61B
US-11432771-B2,A61B
US-11450090-B2,G05B
US-11354278-B2,H04L
US-11375403-B2,H04L
US-11405208-B2,H04L
US-11384463-B2,B23K
US-11364337-B2,A61M
US-11429930-B2,G16H
US-11400138-B2,A61P
US-11450090-B2,G06T
US-11423539-B2,G06T
US-11368762-B2,H04N
US-11412231-B2,H04N
US-11444995-B2,H04N
US-11375960-B2,A61B
US-11419318-B2,C12N
US-11450698-B2,H01L
US-11385961-B2,G06F
US-11422402-B2,G06F
US-11443406-B2,G06N
US-11394671-B2,H04W
US-11388673-B2,H04W
US-11402589-B2,G02B
US-11388258-B2,G06F
US-11449505-B2,G06F
US-11413537-B2,G06F
US-11456776-B2,H04L
US-11393967-B2,H01L
US-11441084-B2,C10G
US-11365041-B2,B65D
US-11400138-B2,A61P
US-11438650-B2,G10L
US-11412974-B2,A61B
US-11443120-B2,G06N
US-11363222-B2,H04N
US-11444109-B2,H04N
US-11412231-B2,H04N
US-11397326-B2,G02B
US-11410444-B2,G06F
US-11387209-B2,H01L
US-11400138-B2,A61K
US-11376319-B2,A61K
US-11354278-B2,G06Q
US-11439749-B2,A61M
US-11421980-B2,G01B
US-11450326-B2,B25J
US-11436630-B2,H04N
US-11379962-B2,H04N
US-11444995-B2,H04N
US-11408566-B2,E21B
US-11441084-B2,B01J
US-11413710-B2,B23K
US-11407829-B2,A61K
US-11409410-B2,G06F
US-11450645-B2,H01L
US-11398593-B2,H01L
US-11440728-B2,B65B
US-11384177-B2,E21B
US-11364337-B2,A61M
US-11351045-B2,A61F
US-11406524-B2,A61F
US-11368762-B2,H04N
US-11452433-B2,A61B
US-11412923-B2,A61B

2025-01-26 09:36:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:36:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:36:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:36:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 09:36:23 - snowflake.connector.connection - INFO - closed
2025-01-26 09:36:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:36:24 - root - INFO - SQL:
SELECT t."publication_number",
       ipc_u.value::VARIANT:"code"::STRING AS "ipc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t
     , LATERAL FLATTEN(input => t."ipc") ipc_u
WHERE ipc_u.value::VARIANT:"first"::BOOLEAN = true
LIMIT 100
Results:
publication_number,ipc_code
US-2006215095-A1,G02F1/1337
US-2006225070-A1,G06F9/445
US-2006223426-A1,B24B1/00
US-2006250589-A1,G03B27/68
US-2006133105-A1,F21V33/00
US-2006264190-A1,H04Q7/32
US-2006272652-A1,A61B19/00
US-2006280400-A1,G02B6/28
US-2006089742-A1,G06F19/00
US-2006088772-A1,G03C5/00
US-2006006745-A1,H02K9/00
US-2007010420-A1,C11D3/00
US-2006001827-A1,G02C5/00
US-2006019148-A1,H01M4/86
US-2006023399-A1,H01G4/06
US-2006029199-A1,H04M1/64
US-2006047298-A1,A61M29/00
US-2006049749-A1,H01J1/62
US-2007055408-A1,H02J3/00
US-2006057776-A1,H01L21/50
US-2007061156-A1,G06Q99/00
US-2006020170-A1,A61B1/00
US-2006015009-A1,A61B1/00
US-2006069023-A1,A61K38/17
US-2007089984-A1,C23C14/00
US-2006106467-A1,G05B11/01
US-2007095595-A1,B60K28/12
US-2007095595-A1,B60R99/00
US-2006120791-A1,B41J15/00
US-2006068001-A1,A61K9/62
US-2006115184-A1,G06K9/32
US-2006120084-A1,F21V29/00
US-2006148712-A1,A61K38/10
US-2006123024-A1,G06F7/00
US-2006131447-A1,F02M63/00
US-2006136401-A1,G06F17/30
US-2006135276-A1,A63B69/36
US-2007296592-A1,G08B13/14
US-2007142872-A1,A61N1/00
US-2006155443-A1,E05F15/00
US-2006160812-A1,A61K31/50
US-2007044147-A1,G06F15/16
US-2007161284-A1,H01R3/00
US-2006162744-A1,B08B3/02
US-2006206315-A1,G10L21/0308
US-2006119689-A1,G03G15/01
US-2006216699-A1,C12N15/00
US-2006216699-A1,C12Q1/70
US-2007175960-A1,A61B17/04
US-2006183093-A1,G09B13/00
US-2006184118-A1,A61M37/00
US-2007197987-A1,A61F13/15
US-2007001987-A1,G09G3/36
US-2006215540-A1,H04J11/00
US-2006212811-A1,G06F17/00
US-2007215591-A1,F23Q7/00
US-2007221095-A1,C08L95/00
US-2006178603-A1,A61H23/02
US-2007244419-A1,A61F5/00
US-2007261075-A1,H04H60/31
US-2007046568-A1,G09G3/10
US-2007254003-A1,A61K31/4745
US-2007268953-A1,G01K15/00
US-2007275123-A1,A23F3/16
US-2007150297-A1,G06Q99/00
US-2006270996-A1,A61M5/00
US-2006270996-A1,A61M5/142
US-2006265894-A1,G01B5/00
US-2007271228-A1,G06F17/30
US-2006209298-A1,G01N21/00
US-2007278762-A1,B62M1/36
US-2006276577-A1,C08K3/22
US-2006274115-A1,B41J2/135
US-2007012074-A1,D06F39/04
US-2007285147-A1,H03L5/00
US-2006261475-A1,H01L23/48
US-2008038594-A1,H01M8/04
US-2007042238-A1,H01M8/24
US-2008050579-A1,B32B27/18
US-2008005269-A1,G06F15/16
US-2008010292-A1,G06F17/30
US-2006252622-A1,B31C99/00
US-2007130266-A1,G06F15/16
US-2008014421-A1,B32B7/02
US-2007019110-A1,H04N3/27
US-2007028125-A1,G06F1/00
US-2008076740-A1,A61K31/675
US-2009092640-A1,A61K39/00
US-2006276912-A1,G05B15/02
US-2006276912-A1,G05B11/01
US-2008047604-A1,H01L31/00
US-2007060395-A1,F16D3/00
US-2007054509-A1,H01R29/00
US-2007193530-A1,A01K13/00
US-2007027654-A1,G06Q50/10
US-2007027654-A1,G21C17/00
US-2007070009-A1,G09G3/36
US-2008068809-A1,H05K7/20
US-2007079047-A1,G06F13/00
US-2008103882-A1,G06F17/30

2025-01-26 09:36:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:36:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:36:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:36:25 - snowflake.connector.connection - INFO - closed
2025-01-26 09:36:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:37:04 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 09:37:04 - root - INFO - The error you're encountering:

```
SQL compilation error:
Object 'IPC_CODE' does not exist or not authorized.
```

occurs because the alias `ipc_code` in your `SELECT` statement is not recognized as a table or column alias in the scope of your query. Specifically, when you use:

```sql
SELECT t."publication_number", ipc_code.*
```

the alias `ipc_code` is not defined in a way that allows you to reference its columns using `ipc_code.*`.

**Problem Explanation:**

- The `LATERAL (SELECT ...)` subquery you're using does not create an alias named `ipc_code` that can be referenced in the `SELECT` clause.
- Instead, it selects a scalar value (`ipc_code`) but does not expose it as a table from which you can select columns using `ipc_code.*`.

**Solution:**

You can resolve this error by directly selecting the `ipc_code` in your `SELECT` clause without trying to reference it as a table alias. 

Here's the corrected SQL query:

```sql
SELECT t."publication_number", ipc_code
FROM PATENTS.PATENTS.PUBLICATIONS t
     , LATERAL FLATTEN(input => t."ipc") ipc_u
     , LATERAL (SELECT ipc_u.value::VARIANT:"code"::STRING AS ipc_code)
LIMIT 100;
```

However, you might still encounter issues because `ipc_code` is not recognized as a column in the outer query scope. A better approach is to incorporate the `ipc_code` directly in your `SELECT` statement by extracting it from the `ipc_u.value`.

Here's the simplified and corrected query:

```sql
SELECT t."publication_number",
       ipc_u.value::VARIANT:"code"::STRING AS "ipc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t
     , LATERAL FLATTEN(input => t."ipc") ipc_u
LIMIT 100;
```

**Explanation:**

- **LATERAL FLATTEN:** This function expands the `ipc` VARIANT column (which is an array of objects) into multiple rows, one for each element in the array.

- **ipc_u.value:** After flattening, this contains each IPC object.

- **Extracting the 'code' Field:** We access the `"code"` field of each IPC object using `ipc_u.value::VARIANT:"code"::STRING`.

- **SELECT Clause:** We directly select `t."publication_number"` and the extracted `"ipc_code"` without needing an additional `LATERAL` subquery.

**Alternative Query without the Extra LATERAL Subquery:**

```sql
SELECT t."publication_number",
       ipc_u.value::VARIANT:"code"::STRING AS "ipc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."ipc") ipc_u
LIMIT 100;
```

**Sample Output:**

```
publication_number,ipc_code
US-11445941-B2,G01B5/00
US-11445941-B2,G01B7/00
US-11445941-B2,G01B9/00
...
```

**Explanation:**

- The corrected query lists each `publication_number` along with its associated IPC code.

- By simplifying the query, we eliminate the scope confusion caused by the extra `LATERAL` subquery.

**Why the Original Query Didn't Work:**

- The `LATERAL (SELECT ...)` subquery does not create a table or alias named `ipc_code` that can be referenced in the `SELECT` clause using `ipc_code.*`.
  
- In SQL, when you use `LATERAL (SELECT ...)`, the columns selected are available in the immediate scope but are not accessible as a separate table unless you assign an alias.

- Even if you assign an alias, you need to reference the columns correctly.

**Additional Tips:**

- **Direct Extraction:** When dealing with JSON or VARIANT data in Snowflake, you can directly extract fields using the `::VARIANT:"field_name"` syntax.

- **Alias Usage:** If you need to reference multiple fields from a subquery, you can assign an alias to the subquery and reference its fields.

**Example with Alias:**

If you needed to extract multiple fields from the `ipc` objects, you could do the following:

```sql
SELECT t."publication_number",
       ipc_fields."code" AS "ipc_code",
       ipc_fields."first" AS "is_first",
       ipc_fields."inventive" AS "is_inventive"
FROM PATENTS.PATENTS.PUBLICATIONS t
     , LATERAL FLATTEN(input => t."ipc") ipc_u
     , LATERAL (
         SELECT 
             ipc_u.value::VARIANT:"code"::STRING AS "code",
             ipc_u.value::VARIANT:"first"::BOOLEAN AS "first",
             ipc_u.value::VARIANT:"inventive"::BOOLEAN AS "inventive"
       ) ipc_fields
LIMIT 100;
```

**Explanation:**

- **LATERAL Subquery with Alias:** We assign an alias `ipc_fields` to the `LATERAL (SELECT ...)` subquery.

- **Selecting Multiple Fields:** We extract multiple fields from the `ipc_u.value` and select them in the subquery.

- **Referencing Fields:** We reference the extracted fields using the `ipc_fields` alias in the outer `SELECT` clause.

**Sample Output with Multiple Fields:**

```
publication_number,ipc_code,is_first,is_inventive
US-11445941-B2,G01B5/00,true,true
US-11445941-B2,G01B7/00,false,true
US-11445941-B2,G01B9/00,false,false
...
```

**Key Takeaways:**

- **Direct Field Extraction:** When working with VARIANT data, you can directly extract the fields you need without complex subqueries.

- **Avoid Unnecessary Subqueries:** Simplifying your query helps prevent errors related to scope and object references.

- **Understanding Aliases:** Proper use of aliases ensures that the columns and tables you reference are recognized in the query.

**Conclusion:**

Your corrected query should work without errors and return the desired results. If you continue to experience issues or need further assistance with modifying your query, feel free to ask.
2025-01-26 09:37:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:37:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:37:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:37:06 - snowflake.connector.connection - INFO - closed
2025-01-26 09:37:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:37:45 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 09:37:45 - root - INFO - The error you're encountering:

```
SQL compilation error:
Object 'IPC_CODE' does not exist or not authorized.
```

This error occurs because the alias `ipc_code` is not recognized as a table or object from which you can select columns using `ipc_code.*` in your `SELECT` statement. Specifically, when you write:

```sql
SELECT t."publication_number", ipc_code.*
```

the `ipc_code` is not a table or alias that has fields you can reference with `*`. The `LATERAL (SELECT ...)` subquery you're using returns a scalar value (the `ipc_code`), not a table with columns.

**Problem Explanation:**

- The `LATERAL (SELECT ...)` subquery in your query returns a scalar value (a single column), but you are trying to reference it as if it were a table with multiple columns using `ipc_code.*`.
- Additionally, you have not assigned an alias to the `LATERAL (SELECT ...)` subquery that you can reference in the `SELECT` clause.

**Solution:**

To fix this issue, you need to:

1. **Assign an alias to the `LATERAL (SELECT ...)` subquery.**
2. **Reference the scalar value returned by the subquery correctly in your `SELECT` clause.**

Here is the corrected SQL query:

```sql
SELECT t."publication_number", ipc_code."ipc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t
     , LATERAL FLATTEN(input => t."ipc") ipc_u
     , LATERAL (SELECT ipc_u.value::VARIANT:"code"::STRING AS "ipc_code") ipc_code
LIMIT 100;
```

**Explanation:**

- **Alias Assignment:**
  - We assign an alias `ipc_code` to the `LATERAL (SELECT ...)` subquery.
- **Correct Column Reference:**
  - In the `SELECT` clause, we reference the column using `ipc_code."ipc_code"`.
- **No Use of `*`:**
  - Since the subquery returns specific columns, we reference them explicitly instead of using `*`.

Alternatively, you can simplify your query by directly extracting the `ipc_code` in the `SELECT` clause without using an additional `LATERAL` subquery:

```sql
SELECT t."publication_number",
       ipc_u.value::VARIANT:"code"::STRING AS "ipc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t
     , LATERAL FLATTEN(input => t."ipc") ipc_u
LIMIT 100;
```

**Why the Original Query Didn't Work:**

- The `LATERAL (SELECT ...)` subquery does not create an alias or object named `ipc_code` that can be referenced using `ipc_code.*` in your `SELECT` clause.
- The `SELECT` inside the `LATERAL` subquery returns a scalar value (a single column), so you need to reference it appropriately.

**Sample Output:**

Using the corrected query, you should get results similar to:

```
publication_number,ipc_code
US-11368189-B2,G06F1/32
US-11368189-B2,H04W76/10
US-11368189-B2,H04L1/00
US-11368189-B2,H04B7/06
US-11408566-B2,F17D1/00
...
```

**Additional Notes:**

- **Direct Extraction Preferred:** When possible, it's cleaner and more efficient to extract the desired data directly rather than using unnecessary subqueries.
- **Aliasing Subqueries:** If you do use a `LATERAL (SELECT ...)` subquery and need to reference its columns, always assign an alias to it and reference the columns explicitly.
- **Understanding LATERAL Subqueries:**
  - In SQL, a `LATERAL` subquery can reference columns from preceding tables in the `FROM` clause.
  - The subquery should be properly aliased if its outputs need to be referenced in the outer query.

**Final Recommendations:**

1. Use the simplified query without the extra `LATERAL` subquery:

   ```sql
   SELECT t."publication_number",
          ipc_u.value::VARIANT:"code"::STRING AS "ipc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t
        , LATERAL FLATTEN(input => t."ipc") ipc_u
   LIMIT 100;
   ```

2. If you need to extract additional fields from the `ipc` objects, you can use a `LATERAL` subquery with an alias:

   ```sql
   SELECT t."publication_number",
          ipc_code."ipc_code",
          ipc_code."is_first",
          ipc_code."inventive"
   FROM PATENTS.PATENTS.PUBLICATIONS t
        , LATERAL FLATTEN(input => t."ipc") ipc_u
        , LATERAL (
            SELECT 
                ipc_u.value::VARIANT:"code"::STRING AS "ipc_code",
                ipc_u.value::VARIANT:"first"::BOOLEAN AS "is_first",
                ipc_u.value::VARIANT:"inventive"::BOOLEAN AS "inventive"
          ) ipc_code
   LIMIT 100;
   ```

   **Explanation:**

   - We extract multiple fields from the `ipc` VARIANT data.
   - We assign an alias `ipc_code` to the subquery and reference its columns.

**Sample Output with Multiple Fields:**

```
publication_number,ipc_code,is_first,inventive
US-11368189-B2,G06F1/32,false,true
US-11368189-B2,H04W76/10,false,true
US-11368189-B2,H04L1/00,false,true
US-11368189-B2,H04B7/06,false,true
US-11408566-B2,F17D1/00,true,true
...
```

**Conclusion:**

- **Error Cause:** The error was due to referencing a non-existent or improperly aliased object in the `SELECT` clause.
- **Resolution:** By assigning the correct alias and referencing columns appropriately, you can resolve the error.
- **Best Practice:** Simplify queries where possible and ensure that aliases are correctly assigned and used.

If you have any further questions or need additional assistance, please feel free to ask!
2025-01-26 09:37:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:37:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:37:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:37:46 - snowflake.connector.connection - INFO - closed
2025-01-26 09:37:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:38:42 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 09:38:42 - root - INFO - The error you're encountering:

```
SQL compilation error:
Object 'IPC_CODE' does not exist or not authorized.
```

occurs because the alias `ipc_code` is not properly defined for use in your `SELECT` statement. Specifically, in your query:

```sql
SELECT t."publication_number", ipc_code.*
FROM PATENTS.PATENTS.PUBLICATIONS t
     , LATERAL FLATTEN(input => t."ipc") ipc_u
     , LATERAL (SELECT ipc_u.value::VARIANT:"code"::STRING AS "ipc_code")
LIMIT 100;
```

you are attempting to select `ipc_code.*`, but `ipc_code` is not recognized as a table alias in this context.

---

**Solution:**

To fix this error, you need to assign an alias to the `LATERAL (SELECT ...)` subquery and reference it correctly in your `SELECT` clause.

**Corrected SQL Query:**

```sql
SELECT t."publication_number", ipc_code."ipc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t
     , LATERAL FLATTEN(input => t."ipc") ipc_u
     , LATERAL (
         SELECT ipc_u.value::VARIANT:"code"::STRING AS "ipc_code"
     ) ipc_code
LIMIT 100;
```

---

**Explanation:**

- **Assign an Alias:**
  - We assign the alias `ipc_code` to the `LATERAL (SELECT ...)` subquery.
- **Reference the Alias:**
  - In the `SELECT` clause, we reference the `ipc_code` field from the subquery using `ipc_code."ipc_code"`.
- **Avoid Using `ipc_code.*`:**
  - Since the subquery returns specific columns, we reference them explicitly rather than using `ipc_code.*`.

---

**Alternatively, Simplify the Query:**

You can extract the IPC code directly without using an additional `LATERAL` subquery.

**Simplified SQL Query:**

```sql
SELECT t."publication_number",
       ipc_u.value::VARIANT:"code"::STRING AS "ipc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t
     , LATERAL FLATTEN(input => t."ipc") ipc_u
LIMIT 100;
```

**Explanation:**

- **Direct Extraction:**
  - We directly extract the `"code"` field from the `ipc_u.value` VARIANT.

---

**Sample Output:**

Using either of the corrected queries, you should get results similar to:

```csv
publication_number,ipc_code
US-11368189-B2,G06F1/32
US-11368189-B2,H04W76/10
US-11368189-B2,H04L1/00
US-11368189-B2,H04B7/06
US-11408566-B2,F17D1/00
...
```

---

**Additional Information:**

If you want to extract multiple fields from the `ipc` VARIANT, you can use a `LATERAL` subquery with an alias to capture them.

**SQL Query to Extract Multiple Fields:**

```sql
SELECT t."publication_number",
       ipc_fields."code" AS "ipc_code",
       ipc_fields."first" AS "is_first",
       ipc_fields."inventive" AS "is_inventive"
FROM PATENTS.PATENTS.PUBLICATIONS t
     , LATERAL FLATTEN(input => t."ipc") ipc_u
     , LATERAL (
         SELECT
             ipc_u.value::VARIANT:"code"::STRING AS "code",
             ipc_u.value::VARIANT:"first"::BOOLEAN AS "first",
             ipc_u.value::VARIANT:"inventive"::BOOLEAN AS "inventive"
     ) ipc_fields
LIMIT 100;
```

**Explanation:**

- **Alias the Subquery:**
  - We assign the alias `ipc_fields` to the `LATERAL (SELECT ...)` subquery.
- **Extract Multiple Fields:**
  - We extract `"code"`, `"first"`, and `"inventive"` fields from the `ipc_u.value`.
- **Reference the Fields:**
  - In the `SELECT` clause, we reference the extracted fields using `ipc_fields."field_name"`.

**Sample Output with Multiple Fields:**

```csv
publication_number,ipc_code,is_first,is_inventive
US-11368189-B2,G06F1/32,false,true
US-11368189-B2,H04W76/10,false,true
US-11368189-B2,H04L1/00,false,true
US-11368189-B2,H04B7/06,false,true
US-11408566-B2,F17D1/00,true,true
...
```

---

**Key Takeaways:**

- **Proper Alias Usage:**
  - Assign aliases to subqueries when you need to reference their outputs.
- **Direct Field Extraction:**
  - When dealing with JSON or VARIANT data, you can extract fields directly without unnecessary subqueries.
- **Avoid Ambiguity:**
  - Ensure that all references to columns or aliases are correctly defined and unambiguous.

---

**Final Answer in the Specified Format:**

```sql
SELECT t."publication_number", ipc_code."ipc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t
     , LATERAL FLATTEN(input => t."ipc") ipc_u
     , LATERAL (
         SELECT ipc_u.value::VARIANT:"code"::STRING AS "ipc_code"
     ) ipc_code
LIMIT 100;
```

---

We corrected the SQL query by assigning an alias to the `LATERAL` subquery and referencing the `ipc_code` field correctly in the `SELECT` clause. This resolves the error and allows you to retrieve the desired data.

If you have any further questions or need additional assistance, please feel free to ask!
2025-01-26 09:38:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:38:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:38:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:38:44 - snowflake.connector.connection - INFO - closed
2025-01-26 09:38:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:38:44 - root - INFO - SQL:
SELECT t."publication_number", ipc_code.*
FROM PATENTS.PATENTS.PUBLICATIONS t
     , LATERAL FLATTEN(input => t."ipc") ipc_u
     , LATERAL (SELECT ipc_u.value::VARIANT:"code"::STRING AS "ipc_code")
LIMIT 100;
Results:
002001 (02000): 01b9f782-0004-7d15-0001-11c300fad37a: SQL compilation error:
Object 'IPC_CODE' does not exist or not authorized.
2025-01-26 09:38:44 - root - INFO - itercount: 0
2025-01-26 09:38:44 - root - INFO - Database Name: PATENTS
Schema Name: PATENTS
DDL describes table information.
,0
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,1
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""spif_publication_number"" VARCHAR(16777216),
	""spif_application_number"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""claims_localized_html"" VARIANT,
	""description_localized"" VARIANT,
	""description_localized_html"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""locarno"" VARIANT,
	""citation"" VARIANT,
	""parent"" VARIANT,
	""child"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,2
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

External knowledge that might be helpful: 
### IPC Codes: Handling Main IPC Code Selection

When dealing with the `ipc` field in the `patents-public-data.patents.publications` dataset, it is important to understand the structure of this field, especially the subfield `first`. This subfield is a boolean that indicates whether a given IPC code is the main code for the publication number in question. This is crucial because each patent publication can be associated with multiple IPC codes, signifying the various aspects of the technology covered by the patent.

However, not every publication in the dataset has a designated main IPC code. This lack of a clearly identified main IPC code complicates the process of determining the most relevant IPC code for each publication, as selecting a single IPC code from multiple possibilities without clear prioritization can lead to inconsistent or skewed analyses.

This approach ensures a more consistent and representative selection of IPC codes across the dataset, facilitating more accurate and meaningful analysis of patent trends and classifications. By focusing on the most frequently occurring 4-digit IPC code, the view helps overcome the limitations posed by the absence of a designated main IPC code, thereby enhancing the reliability of patent-related studies and insights derived from this data.

Here is an example

```
SELECT 
    t1.publication_number, 
    SUBSTR(ipc_u.code, 0, 4) as ipc4, 
    COUNT(
    SUBSTR(ipc_u.code, 0, 4)
    ) as ipc4_count 
FROM 
    `patents-public-data.patents.publications` t1, 
    UNNEST(ipc) AS ipc_u 
GROUP BY 
    t1.publication_number, 
    ipc4

```



# Text Embeddings (Similarity)

Patent documents are rich with textual data. In fact, most of the information contained in a patent document is text. This includes the `abstract_localized`, `description_localized`, and `claims_localized`. Textual data can be a powerful tool to analyze and compare patent scope and content across patents. However, before being able to use textual data, it needs to be vectorized or transformed into text embeddings that can be used by machine learning models. Therefore, creating text embeddings from the textual data of patents is necessary to compare patent contents. Technically speaking, running an NLP algorithm that creates embeddings for all U.S. patents is computationally difficult.

Nevertheless, Google runs their own machine learning algorithm which transforms patent text metadata into text embeddings which they report in `patents-public-data.google_patents_research.publications` table. The textual embeddings of one patent, without any knowledge on the algorithm being used to create them, are meaningless on their own. However, the embeddings are powerful when it comes to comparing textual content of two or more patents. Embeddings can be used to calculate a similarity score between any two patents. This similarity score is calculated by applying the dot product of the embeddings vector of the patents, as shown below:

The similarity \( \text{Similarty}_{i,k} \) between two patents \( i \) and \( k \) is calculated as the dot product of their embedding vectors:

\[
\text{Similarty}_{i,k} = \mathbf{v}_i \cdot \mathbf{v}_k
\]

where

\[
\mathbf{v}_i = [v_{i1}, v_{i2}, v_{i3}, \ldots, v_{iN}]
\]
and
\[
\mathbf{v}_k = [v_{k1}, v_{k2}, v_{k3}, \ldots, v_{kN}]
\]

are the embedding vectors for patents \( i \) and \( k \) respectively. The higher the dot product, the more similar the patents.





# Originality (Trajtenberg)

One of the most important measures of a patent is "basicness". The aspects of basicness are tough to measure. Nevertheless, some literature finds that important aspects of these measures are embodied in the relationship between the invention and the technological predcessors and successors it is connected to through, for example, patent citations. We can thus use patent citations to construct measures that identify basicness and appropriability. Trajtenberg et al. 1997 provide a number of these measures. They distinguish between:

1. Forward-looking measures: measures that are derived from the relationship between an invention and subsequent technologies that build upon it. These measures are thus constructed from the forward citations. One example of a forward-looking basicness measure they provide is Generality, which is calculated as:

\[
\text{GENERALITY}_i = 1 - \sum_{k=1}^{N_i} \left( \frac{\text{NCITING}_{G_k}}{\text{NCITING}_i} \right)
\]


2. Backward-looking measures: measures that are derived from the relationship between a given patent and the body of knowledge that preceded it. These measure are thus constructed from the backward citations. One example of a backward-looking basicness measure they provide is Orginality, which is calculated as:

\[
\text{ORIGINALITY}_i = 1 - \sum_{k=1}^{N_i} \left( \frac{\text{NCITED}_{i,k}}{\text{NCITED}_i} \right)
\]

With **NCITING** and **NCITED** defined as the number of patents citing the focal patent and the number of patents cited by the focal patent, respectively. Index `i` corresponds to the focal patent considered, and `k` is the index of patent classes. For example, **NCITED_2,3** refers to the number of patents in patent class 3 and cited by our focal patent 2.


The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
**Relevant Columns and Potential Usage:**

- **"publication_number"**: Identifies each patent; used to select and display the publication numbers.

- **"country_code"**: To filter for United States patents ('US').

- **"kind_code"**: To filter for utility patents under the B2 classification ('B2').

- **"grant_date"**: To select patents granted between June (20220601) and September (20220930) of 2022.

- **"ipc"**: Contains the International Patent Classification codes in VARIANT format; used to extract IPC codes.

- **"ipc"."code"**: The actual IPC code within the VARIANT ipc column; used to extract the code string.

- **"ipc"."first"**: Indicates the main IPC code if available; used to identify the primary IPC code.

- **Conditions that may be used**:
  - Filtering patents where "country_code" = 'US'.
  - Filtering patents where "kind_code" = 'B2'.
  - Filtering patents where "grant_date" BETWEEN 20220601 AND 20220930.
  - Extracting the 4-digit IPC code using substring functions.
  - Counting occurrences of IPC codes to identify frequencies.

---

**SQL Queries:**

1. **Select publication numbers and country codes for US patents:**

   ```sql
   SELECT "publication_number", "country_code"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "country_code" = 'US'
   LIMIT 100;
   ```

2. **Select distinct kind codes to identify available classifications:**

   ```sql
   SELECT DISTINCT "kind_code"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100;
   ```

3. **Select publication numbers and grant dates for patents granted in August 2022:**

   ```sql
   SELECT "publication_number", "grant_date"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "grant_date" BETWEEN 20220801 AND 20220831
   LIMIT 100;
   ```

4. **Select publication numbers, grant dates, and kind codes for US 'B2' patents granted between June and September 2022:**

   ```sql
   SELECT "publication_number", "grant_date", "kind_code"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "country_code" = 'US' AND
         "kind_code" = 'B2' AND
         "grant_date" BETWEEN 20220601 AND 20220930
   LIMIT 100;
   ```

5. **Select publication numbers and ipc VARIANT data to explore IPC codes:**

   ```sql
   SELECT "publication_number", "ipc"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100;
   ```

6. **Flatten the ipc column to extract individual IPC codes for each patent:**

   ```sql
   SELECT t."publication_number", ipc_u.value::VARIANT AS "ipc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."ipc") ipc_u
   LIMIT 100;
   ```

7. **Extract the 'code' field from the ipc VARIANT data:**

   ```sql
   SELECT t."publication_number", ipc_u.value::VARIANT:"code"::STRING AS "ipc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."ipc") ipc_u
   LIMIT 100;
   ```

8. **Extract the 4-digit IPC code from each IPC code:**

   ```sql
   SELECT t."publication_number",
          SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."ipc") ipc_u
   LIMIT 100;
   ```

9. **Select ipc4 codes for US 'B2' patents granted between June and September 2022:**

   ```sql
   SELECT t."publication_number",
          SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."ipc") ipc_u
   WHERE t."country_code" = 'US' AND
         t."kind_code" = 'B2' AND
         t."grant_date" BETWEEN 20220601 AND 20220930
   LIMIT 100;
   ```

10. **Count the number of times each ipc4 code appears across all patents:**

    ```sql
    SELECT SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
           COUNT(*) AS "code_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    GROUP BY "ipc4_code"
    ORDER BY "code_count" DESC
    LIMIT 100;
    ```

11. **List ipc4 codes that appear 10 or more times among US 'B2' patents granted between June and September 2022:**

    ```sql
    SELECT SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
           COUNT(*) AS "code_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US' AND
          t."kind_code" = 'B2' AND
          t."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY "ipc4_code"
    HAVING COUNT(*) >= 10
    ORDER BY "code_count" DESC
    LIMIT 100;
    ```

12. **Select distinct publication numbers and their associated ipc4 codes:**

    ```sql
    SELECT DISTINCT t."publication_number",
           SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US' AND
          t."kind_code" = 'B2' AND
          t."grant_date" BETWEEN 20220601 AND 20220930
    LIMIT 100;
    ```

13. **Count the number of ipc4 codes assigned to each patent:**

    ```sql
    SELECT t."publication_number",
           COUNT(DISTINCT SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4)) AS "num_ipc4_codes"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US' AND
          t."kind_code" = 'B2' AND
          t."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY t."publication_number"
    LIMIT 100;
    ```

14. **List all ipc4 codes assigned to each patent:**

    ```sql
    SELECT t."publication_number",
           LISTAGG(DISTINCT SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4), ',') AS "ipc4_codes"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US' AND
          t."kind_code" = 'B2' AND
          t."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY t."publication_number"
    LIMIT 100;
    ```

15. **Select the main IPC code (where "first" is true) for each patent if available:**

    ```sql
    SELECT t."publication_number",
           ipc_u.value::VARIANT:"code"::STRING AS "ipc_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE ipc_u.value::VARIANT:"first"::BOOLEAN = true
    LIMIT 100;
    ```

16. **Select patents and ipc4 codes where the ipc4 code appears 10 or more times:**

    ```sql
    SELECT t."publication_number",
           SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US' AND
          t."kind_code" = 'B2' AND
          t."grant_date" BETWEEN 20220601 AND 20220930 AND
          SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) IN (
              SELECT SUBSTRING(ipc_u2.value::VARIANT:"code"::STRING, 1, 4)
              FROM PATENTS.PATENTS.PUBLICATIONS t2,
                   LATERAL FLATTEN(input => t2."ipc") ipc_u2
              WHERE t2."country_code" = 'US' AND
                    t2."kind_code" = 'B2' AND
                    t2."grant_date" BETWEEN 20220601 AND 20220930
              GROUP BY SUBSTRING(ipc_u2.value::VARIANT:"code"::STRING, 1, 4)
              HAVING COUNT(*) >= 10
          )
    LIMIT 100;
    ```

17. **Identify the most frequent ipc4 code assigned to patents, considering overall frequency:**

    ```sql
    SELECT t."publication_number", "ipc4_code"
    FROM (
        SELECT t."publication_number",
               SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
               DENSE_RANK() OVER (PARTITION BY t."publication_number" ORDER BY code_counts."code_count" DESC) AS "rank"
        FROM PATENTS.PATENTS.PUBLICATIONS t,
             LATERAL FLATTEN(input => t."ipc") ipc_u
        LEFT JOIN (
            SELECT SUBSTRING(ipc_u2.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
                   COUNT(*) AS "code_count"
            FROM PATENTS.PATENTS.PUBLICATIONS t2,
                 LATERAL FLATTEN(input => t2."ipc") ipc_u2
            WHERE t2."country_code" = 'US' AND
                  t2."kind_code" = 'B2' AND
                  t2."grant_date" BETWEEN 20220601 AND 20220930
            GROUP BY "ipc4_code"
        ) code_counts ON SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) = code_counts."ipc4_code"
        WHERE t."country_code" = 'US' AND
              t."kind_code" = 'B2' AND
              t."grant_date" BETWEEN 20220601 AND 20220930
    ) sub
    WHERE "rank" = 1
    LIMIT 100;
    ```

18. **Select patents where their most frequent ipc4 code appears 10 or more times overall:**

    ```sql
    SELECT t."publication_number", sub."ipc4_code"
    FROM (
        SELECT t."publication_number",
               SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
               DENSE_RANK() OVER (PARTITION BY t."publication_number" ORDER BY code_counts."code_count" DESC) AS "rank"
        FROM PATENTS.PATENTS.PUBLICATIONS t,
             LATERAL FLATTEN(input => t."ipc") ipc_u
        LEFT JOIN (
            SELECT SUBSTRING(ipc_u2.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
                   COUNT(*) AS "code_count"
            FROM PATENTS.PATENTS.PUBLICATIONS t2,
                 LATERAL FLATTEN(input => t2."ipc") ipc_u2
            WHERE t2."country_code" = 'US' AND
                  t2."kind_code" = 'B2' AND
                  t2."grant_date" BETWEEN 20220601 AND 20220930
            GROUP BY "ipc4_code"
            HAVING COUNT(*) >= 10
        ) code_counts ON SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) = code_counts."ipc4_code"
        WHERE t."country_code" = 'US' AND
              t."kind_code" = 'B2' AND
              t."grant_date" BETWEEN 20220601 AND 20220930
    ) sub
    WHERE "rank" = 1
    LIMIT 100;
    ```

---

**Note:** The queries use the `LATERAL FLATTEN` function to extract data from the `ipc` VARIANT column. The `SUBSTRING` function is used to extract the first four characters of the IPC code to obtain the 4-digit IPC code (`ipc4_code`). The use of `LIMIT 100` ensures that the queries return at most 100 rows as requested.

These queries help in understanding the structure and contents of the relevant columns and progressively build towards fulfilling the task requirements.Query:
SELECT "publication_number", "country_code"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "country_code" = 'US'
   LIMIT 100;
Answer:
publication_number,country_code
US-2006143594-A1,US
US-2006143284-A1,US
US-2006148139-A1,US
US-2006152123-A1,US
US-2006150698-A1,US
US-2005254871-A1,US
US-2005168584-A1,US
US-2005161997-A1,US
US-2005175186-A1,US
US-2006175765-A1,US
US-2005150005-A1,US
US-2006118954-A1,US
US-2005148066-A1,US
US-2006010011-A1,US
US-2006183586-A1,US
US-2005189252-A1,US
US-2005184759-A1,US
US-2005144256-A1,US
US-2006195821-A1,US
US-2005143653-A1,US
US-2006198380-A1,US
US-2006118870-A1,US
US-2005253263-A1,US
US-2006197375-A1,US
US-2005222693-A1,US
US-2005180450-A1,US
US-2006212456-A1,US
US-2005218642-A1,US
US-2005176269-A1,US
US-2006228959-A1,US
US-2006252404-A1,US
US-2006224211-A1,US
US-2006241817-A1,US
US-2005237771-A1,US
US-2005243216-A1,US
US-2005249541-A1,US
US-2006089219-A1,US
US-2005271201-A1,US
US-2005216965-A1,US
US-2005267909-A1,US
US-2006266770-A1,US
US-2005270599-A1,US
US-2006079895-A1,US
US-2005273202-A1,US
US-2006001866-A1,US
US-2006006761-A1,US
US-2006287882-A1,US
US-2005216567-A1,US
US-2006209512-A1,US
US-2006000939-A1,US
US-2006091163-A1,US
US-2007009364-A1,US
US-2006023254-A1,US
US-2005257319-A1,US
US-2007004239-A1,US
US-2006040365-A1,US
US-2005276065-A1,US
US-2007039052-A1,US
US-2006045302-A1,US
US-2006204424-A1,US
US-2007011371-A1,US
US-2007061140-A1,US
US-2006180497-A1,US
US-2007069906-A1,US
US-2006028190-A1,US
US-2006036325-A1,US
US-2006034112-A1,US
US-2007114474-A1,US
US-2006047060-A1,US
US-2006039234-A1,US
US-2006113251-A1,US
US-2006122815-A1,US
US-2007106350-A1,US
US-2006218841-A1,US
US-2006131931-A1,US
US-2007107149-A1,US
US-2006234529-A1,US
US-2006136397-A1,US
US-2006079849-A1,US
US-2006186294-A1,US
US-2006261821-A1,US
US-2006145963-A1,US
US-2006128522-A1,US
US-2006090877-A1,US
US-2007071085-A1,US
US-2007053149-A1,US
US-2007159350-A1,US
US-2006206019-A1,US
US-2006147574-A1,US
US-2006144602-A1,US
US-2006112201-A1,US
US-2006112495-A1,US
US-2006182055-A1,US
US-2007163684-A1,US
US-2007112592-A1,US
US-2006172276-A1,US
US-2006129939-A1,US
US-2006172084-A1,US
US-2006185810-A1,US
US-2007085071-A1,US
Query:
SELECT DISTINCT "kind_code"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100;
Answer:
kind_code
S2
C1
R1
P
B7
F1
P9
H1
Y8
A4
A6
V0
A1
D1
U4
R
Z2
B1
S
D2
U8
I1
T9
U9
T2
Y2
D
L
F2
T3
B5
B2
U
A
V
U1
P1
C4
T1
Y4
A5
U0
T5
G2
B3
T4
A9
B6
E2
A0
B9
U5
C9
A3
A7
C3
A2
Y
T8
E
G
D0
B
Y1
C
U2
B8
C0
M
S1
U3
T
Q
B4
C2
C5
H3
Z
A8
I2
Query:
SELECT "publication_number", "grant_date"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "grant_date" BETWEEN 20220801 AND 20220831
   LIMIT 100;
Answer:
publication_number,grant_date
EP-3301435-B1,20220803
KR-102439233-B1,20220831
EP-3385453-B1,20220810
JP-7125184-B1,20220824
AU-2018303017-B2,20220818
AU-2017376451-B2,20220825
US-11419318-B2,20220823
CN-106730973-B,20220805
ES-2920330-T3,20220802
KR-102435135-B1,20220825
US-11410209-B1,20220809
KR-102429420-B1,20220803
KR-102433521-B1,20220818
KR-102428851-B1,20220804
US-11404885-B1,20220802
JP-7115329-B2,20220809
JP-7114086-B2,20220808
JP-7112010-B2,20220803
KR-102436743-B1,20220826
KR-102431129-B1,20220816
CN-217117893-U,20220805
CN-217293012-U,20220826
JP-7121498-B2,20220818
JP-7119614-B2,20220817
JP-7123656-B2,20220823
JP-7114408-B2,20220808
JP-7126659-B2,20220829
JP-7110148-B2,20220801
US-11401923-B2,20220802
US-11430204-B2,20220830
US-11401219-B2,20220802
US-11418754-B1,20220816
EP-3468467-B1,20220810
EP-3588086-B1,20220803
TW-I773687-B,20220811
CN-111041612-B,20220809
CN-113386807-B,20220812
CN-113493214-B,20220823
CN-113170948-B,20220809
CN-113242378-B,20220805
CN-113481542-B,20220805
CN-113506471-B,20220802
CN-114684653-B,20220812
JP-1721752-S,20220805
CN-108780473-B,20220816
CN-109415680-B,20220816
US-11406524-B2,20220809
KR-102438213-B1,20220830
CN-217244979-U,20220823
CN-217277263-U,20220823
CN-217155643-U,20220809
CN-217141006-U,20220809
CN-217203621-U,20220816
CN-217167273-U,20220812
CN-217199091-U,20220816
CN-217174809-U,20220812
CN-217335928-U,20220830
CN-217260486-U,20220823
CN-217109116-U,20220802
CN-217210924-U,20220816
CN-217175184-U,20220812
CN-217326054-U,20220830
CN-217090896-U,20220802
CN-217145454-U,20220809
CN-217332441-U,20220830
CN-217217332-U,20220816
CN-217277327-U,20220823
CN-217128436-U,20220805
CN-217226468-U,20220819
CN-217289961-U,20220826
CN-217099834-U,20220802
CN-217246741-U,20220823
CN-217106801-U,20220802
CN-217133349-U,20220805
CN-217160314-U,20220809
CN-217209478-U,20220816
CN-217209726-U,20220816
CN-217261490-U,20220823
CN-217266278-U,20220823
CN-217189805-U,20220816
CN-217238967-U,20220819
CN-217239112-U,20220819
CN-217229322-U,20220819
CN-217289218-U,20220826
CN-217314326-U,20220830
CN-217323734-U,20220830
CN-217216774-U,20220816
CN-217309544-U,20220830
CN-217093559-U,20220802
CN-217107618-U,20220802
CN-217202880-U,20220816
CN-217135660-U,20220805
CN-217291473-U,20220826
CN-217209199-U,20220816
CN-217186479-U,20220816
CN-217128891-U,20220805
CN-217184237-U,20220816
CN-217155131-U,20220809
CN-217247586-U,20220823
CN-217198947-U,20220816
Query:
SELECT "publication_number", "grant_date", "kind_code"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "country_code" = 'US' AND
         "kind_code" = 'B2' AND
         "grant_date" BETWEEN 20220601 AND 20220930
   LIMIT 100;
Answer:
publication_number,grant_date,kind_code
US-11383851-B2,20220712,B2
US-11453255-B2,20220927,B2
US-11373404-B2,20220628,B2
US-11421011-B2,20220823,B2
US-11384463-B2,20220712,B2
US-11413537-B2,20220816,B2
US-11414016-B2,20220816,B2
US-11415428-B2,20220816,B2
US-11451557-B2,20220920,B2
US-11374401-B2,20220628,B2
US-11437978-B2,20220906,B2
US-11447750-B2,20220920,B2
US-11397326-B2,20220726,B2
US-11440275-B2,20220913,B2
US-11445622-B2,20220913,B2
US-11441084-B2,20220913,B2
US-11434270-B2,20220906,B2
US-11363375-B2,20220614,B2
US-11419318-B2,20220823,B2
US-11452433-B2,20220927,B2
US-11420401-B2,20220823,B2
US-11360211-B2,20220614,B2
US-11398338-B2,20220726,B2
US-11453193-B2,20220927,B2
US-11412422-B2,20220809,B2
US-11354655-B2,20220607,B2
US-11387213-B2,20220712,B2
US-11375479-B2,20220628,B2
US-11405208-B2,20220802,B2
US-11420656-B2,20220823,B2
US-11434838-B2,20220906,B2
US-11438650-B2,20220906,B2
US-11378746-B2,20220705,B2
US-11375241-B2,20220628,B2
US-11380566-B2,20220705,B2
US-11448216-B2,20220920,B2
US-11416699-B2,20220816,B2
US-11412231-B2,20220809,B2
US-11457276-B2,20220927,B2
US-11453169-B2,20220927,B2
US-11443406-B2,20220913,B2
US-11389955-B2,20220719,B2
US-11446266-B2,20220920,B2
US-11441406-B2,20220913,B2
US-11368762-B2,20220621,B2
US-11375960-B2,20220705,B2
US-11404307-B2,20220802,B2
US-11433084-B2,20220906,B2
US-11407307-B2,20220809,B2
US-11410365-B2,20220809,B2
US-11386741-B2,20220712,B2
US-11370085-B2,20220628,B2
US-11385163-B2,20220712,B2
US-11391553-B2,20220719,B2
US-11430607-B2,20220830,B2
US-11412974-B2,20220816,B2
US-11439749-B2,20220913,B2
US-11453654-B2,20220927,B2
US-11453420-B2,20220927,B2
US-11423376-B2,20220823,B2
US-11363813-B2,20220621,B2
US-11426634-B2,20220830,B2
US-11365729-B2,20220621,B2
US-11419647-B2,20220823,B2
US-11375912-B2,20220705,B2
US-11451086-B2,20220920,B2
US-11448422-B2,20220920,B2
US-11416109-B2,20220816,B2
US-11454038-B2,20220927,B2
US-11453892-B2,20220927,B2
US-11433868-B2,20220906,B2
US-11396506-B2,20220726,B2
US-11386278-B2,20220712,B2
US-11372388-B2,20220628,B2
US-11374644-B2,20220628,B2
US-11450923-B2,20220920,B2
US-11387209-B2,20220712,B2
US-11445494-B2,20220913,B2
US-11440085-B2,20220913,B2
US-11428067-B2,20220830,B2
US-11449505-B2,20220920,B2
US-11418602-B2,20220816,B2
US-11449524-B2,20220920,B2
US-11439554-B2,20220913,B2
US-11396572-B2,20220726,B2
US-11407017-B2,20220809,B2
US-11360542-B2,20220614,B2
US-11379962-B2,20220705,B2
US-11370724-B2,20220628,B2
US-11416001-B2,20220816,B2
US-11450090-B2,20220920,B2
US-11396732-B2,20220726,B2
US-11374026-B2,20220628,B2
US-11369217-B2,20220628,B2
US-11407829-B2,20220809,B2
US-11399950-B2,20220802,B2
US-11381283-B2,20220705,B2
US-11409410-B2,20220809,B2
US-11456419-B2,20220927,B2
US-11437996-B2,20220906,B2
Query:
SELECT "publication_number", "ipc"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100;
Answer:
Too long, hard cut:
publication_number,ipc
CR-5634-A,"[
  {
    ""code"": ""G01N21/01"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CR-5990-A,[]
FI-429-A,"[
  {
    ""code"": ""C10C1/00"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
HK-6083-A,"[
  {
    ""code"": ""H02M5/00"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
HU-T52763-A,"[
  {
    ""code"": ""A01N43/54"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""A01N47/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D239/47"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D521/00"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
JP-H03206829-A,"[
  {
    ""code"": ""A01K61/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""A01K63/00"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
JP-S62159089-A,"[
  {
    ""code"": ""G21C5/10"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""G21C1/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
US-416-A,[]
US-2528225-A,"[
  {
    ""code"": ""E21B27/02"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A41580-A,"[
  {
    ""code"": ""B22D11/08"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A47682-A,"[
  {
    ""code"": ""C07D471/22"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D471/16"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A63682-A,"[
  {
    ""code"": ""G01N27/22"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-920790-A,"[
  {
    ""code"": ""C03C4/12"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-950907-A,"[
  {
    ""code"": ""C08K5/47"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/44"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D263/56"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D277/64"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/46"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/48"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/35"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C11B5/00"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10L1/14"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M135/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C09K15/30"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D235/12"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/3447"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-920830-A,"[
  {
    ""code"": ""E02D5/38"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/80"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/28"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/54"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/26"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-9086-A,[]
CH-3256-A,[]
CH-540255-A,"[
  {
    ""code"": ""C07D213/56"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/22"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/38"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/51"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/32"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/30"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CH-433637-A,[]
CH-8494-A,[]
CH-9587-A,[]
CH-9968-A,[]
DD-8297-A,[]
FR-1334211-A,"[
  {
    ""code"": ""C12H1/14"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
FR-1444995-A,"[
  {
    ""code"": ""C07F7/22"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
FR-1474468-A,"[
  {
    ""code"": ""G11B15/22"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""G11B15/62"",
    ""first"": false,
    ""inventive"": true,
    
Query:
SELECT t."publication_number", ipc_u.value::VARIANT AS "ipc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."ipc") ipc_u
   LIMIT 100;
Answer:
Too long, hard cut:
publication_number,ipc_code
WO-2017120317-A1,"{
  ""code"": ""C12M1/00"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017120317-A1,"{
  ""code"": ""G01N15/14"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017120317-A1,"{
  ""code"": ""B01L3/00"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017120317-A1,"{
  ""code"": ""G01N37/00"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017120317-A1,"{
  ""code"": ""G01N15/10"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017120317-A1,"{
  ""code"": ""C12M1/34"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017127291-A1,"{
  ""code"": ""G06F15/18"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017127659-A1,"{
  ""code"": ""E21B7/15"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017127659-A1,"{
  ""code"": ""E21B10/00"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017136263-A1,"{
  ""code"": ""F16H55/02"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017136263-A1,"{
  ""code"": ""F16H55/08"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017136263-A1,"{
  ""code"": ""B23H9/00"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017136263-A1,"{
  ""code"": ""F16H55/06"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017136263-A1,"{
  ""code"": ""B23P15/14"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017136263-A1,"{
  ""code"": ""F16H1/08"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017136263-A1,"{
  ""code"": ""B23F7/00"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017142834-A1,"{
  ""code"": ""A61K31/202"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2018169530-A1,"{
  ""code"": ""C09D133/10"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2018169530-A1,"{
  ""code"": ""C08L71/02"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017205009-A1,"{
  ""code"": ""G06F13/42"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017214099-A1,"{
  ""code"": ""B29C67/24"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017214099-A1,"{
  ""code"": ""B29C37/00"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017214099-A1,"{
  ""code"": ""C09D131/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017214099-A1,"{
  ""code"": ""B29C44/12"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017214099-A1,"{
  ""code"": ""C09J131/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017214099-A1,"{
  ""code"": ""C08J7/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017218485-A1,"{
  ""code"": ""G06Q20/34"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017218485-A1,"{
  ""code"": ""G06Q20/10"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017218485-A1,"{
  ""code"": ""G06Q20/38"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017223041-A1,"{
  ""code"": ""G02B21/36"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017223041-A1,"{
  ""code"": ""G02B21/00"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2017223041-A1,"{
  ""code"": ""G02B21/08"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2018017413-A1,"{
  ""code"": ""G02B1/115"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2018017413-A1,"{
  ""code"": ""C23C14/22"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2018017413-A1,"{
  ""code"": ""G02B27/14"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2019040086-A1,"{
  ""code"": ""B29C51/36"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2019040086-A1,"{
  ""code"": ""B29L16/00"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
WO-2019040086-A1,"{
  ""code"": ""B29C70/36"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2019040086-A1,"{
  ""code"": ""B29C51/10"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2019040086-A1,"{
  ""code"": ""B29C53/24"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2018048690-A1,"{
  ""code"": ""C07C209/86"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2018048690-A1,"{
  ""code"": ""B01D3/36"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2018048690-A1,"{
  ""code"": ""B01D3/14"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2018075308-A1,"{
  ""code"": ""A61K47/10"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2018075308-A1,"{
  ""code"": ""A61K47/00"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
WO-2018075308-A1,"{
  ""code"": ""A61K47/36"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
WO-2018075308-A1,"{
  
Query:
SELECT t."publication_number", ipc_u.value::VARIANT:"code"::STRING AS "ipc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."ipc") ipc_u
   LIMIT 100;
Answer:
publication_number,ipc_code
JP-S5945815-B2,F02D1/04
JP-2579616-B2,H03M13/00
JP-2579616-B2,G11B20/18
JP-2873042-B2,H04N1/00
JP-2873042-B2,B65H31/00
JP-2873042-B2,B65H31/20
JP-S5760482-B2,F15B9/17
JP-S5760482-B2,F15B13/14
JP-S5760482-B2,E02F9/24
JP-S5760482-B2,F15B9/16
JP-S5760482-B2,E02F9/22
JP-S5760482-B2,B25J3/00
JP-H0146967-B2,H01H33/04
JP-H0146967-B2,H01H1/64
JP-H0146967-B2,H01H1/38
JP-H0146967-B2,H01H9/30
JP-H0773430-B2,H02N11/00
JP-H0773430-B2,F15B21/06
JP-3104132-B2,G01C21/00
JP-3104132-B2,G08G1/0969
JP-3104132-B2,G01S19/28
JP-4261671-B2,G06F17/30
JP-4261671-B2,H04N5/232
JP-4261671-B2,G06F3/048
JP-4261671-B2,H04N5/765
JP-4261671-B2,H04N5/781
JP-4261671-B2,H04N1/00
JP-S5652142-B2,D03D15/00
JP-S5652142-B2,D02G3/02
JP-S5652142-B2,D02G3/04
JP-S5652142-B2,D01G13/00
JP-3511416-B2,B29C41/28
JP-S57170-B2,B29C48/32
JP-S57170-B2,B29C47/84
JP-S57170-B2,B29C47/88
JP-S57170-B2,B29C47/00
JP-S57170-B2,B29C47/86
JP-S57170-B2,B29D7/01
JP-S57170-B2,B29C61/00
JP-3229917-B2,G02B23/00
JP-2608641-B2,B01J37/02
JP-2608641-B2,B01D53/86
JP-2608641-B2,F01N3/28
JP-2608641-B2,B01J35/04
JP-H0676643-B2,C22C38/00
JP-H0676643-B2,C22C38/58
JP-H0676643-B2,C22C38/50
JP-H0676643-B2,C21D8/02
JP-H0676643-B2,C21D7/02
JP-H0676643-B2,C21D8/06
JP-H0676643-B2,C21D8/08
JP-3006401-B2,H04Q3/58
JP-S5760-B2,A47K7/00
JP-H0553959-B2,F04F5/46
JP-H0553959-B2,F04F5/10
JP-3248160-B2,G06T1/00
JP-3248160-B2,G09B29/00
JP-3248160-B2,G06T11/60
JP-3248160-B2,G01C21/00
JP-3248160-B2,G06F17/50
JP-3248160-B2,G06F17/30
JP-H0151087-B2,H03F3/60
JP-H0151087-B2,H04B1/18
JP-3332459-B2,G06K15/02
JP-3332459-B2,B41M5/00
JP-3332459-B2,B41J2/21
JP-3332459-B2,H04N1/60
JP-3332459-B2,B41J2/525
JP-3332459-B2,B41J2/205
JP-3332459-B2,H04N1/46
JP-3332459-B2,H04N1/40
JP-3025972-B2,A23C9/13
JP-4430152-B2,A01N25/06
JP-4430152-B2,A01P7/04
JP-4430152-B2,A01N25/08
JP-4430152-B2,A01N43/36
JP-4430152-B2,A01N25/30
JP-4430152-B2,A01N59/00
JP-4430152-B2,A01N25/14
JP-4430152-B2,A01N25/00
JP-2695298-B2,H05K9/00
JP-2695298-B2,H05K7/00
JP-H0587220-B2,A23J3/16
JP-H0587220-B2,A23J3/26
JP-H0587220-B2,A23L1/18
JP-S527280-B2,A62B1/20
JP-S6338079-B2,C10J3/08
JP-S6338079-B2,C21B11/00
JP-S6338079-B2,C10J3/00
JP-S6338079-B2,C21B13/00
JP-S6338079-B2,C10J3/57
JP-2858438-B2,B41F31/02
JP-2858438-B2,B41F33/00
JP-H0353045-B2,B21C1/22
JP-H0353045-B2,B21D3/00
JP-3850133-B2,H05H7/14
JP-3158627-B2,B62H1/02
JP-3158627-B2,B62J99/00
JP-H0623891-B2,G03G15/08
JP-S619318-B2,A61P31/04
Query:
SELECT t."publication_number",
          SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."ipc") ipc_u
   LIMIT 100;
Answer:
publication_number,ipc4_code
US-2015177816-A1,G06F
US-2015177816-A1,G06F
US-2015177816-A1,G06F
US-2015180461-A1,H03K
US-2015180461-A1,H03K
US-2015271362-A1,H04N
US-2015271362-A1,G06K
US-2015314861-A1,B64C
US-2015340518-A1,C30B
US-2015340518-A1,C03C
US-2015340518-A1,H01L
US-2015340518-A1,H01L
US-2015340518-A1,H01L
US-2015340518-A1,C09D
US-2015340518-A1,C09D
US-2016275535-A1,G06Q
US-2016285437-A1,H03K
US-2016285437-A1,G06F
US-2015200352-A1,B41J
US-2015200352-A1,C04B
US-2015200352-A1,B41J
US-2015200352-A1,B41J
US-2015200352-A1,B41J
US-2015200352-A1,B05C
US-2015200352-A1,H10N
US-2015200352-A1,H10N
US-2015200352-A1,H10N
US-2015200352-A1,H10N
US-2015200352-A1,H10N
US-2015200352-A1,H10N
US-2015200352-A1,H10N
US-2016280116-A1,B60P
US-2015205759-A1,G06F
US-2016120347-A1,B63B
US-2016120347-A1,A47G
US-2015289441-A1,A01C
US-2015289441-A1,A01C
US-2016335166-A1,G06F
US-2016335166-A1,G06F
US-2016345465-A1,H05K
US-2016345465-A1,B23P
US-2015275041-A1,B29C
US-2015275041-A1,C08J
US-2015275041-A1,C09D
US-2016364384-A1,G06F
US-2016364384-A1,G06F
US-2016364384-A1,G06F
US-2015287715-A1,H01L
US-2015287715-A1,H01L
US-2015287715-A1,H01L
US-2015287715-A1,H01L
US-2015287715-A1,H01L
US-2015287715-A1,H10N
US-2016380415-A1,H02G
US-2016380415-A1,B25B
US-2015317187-A1,G06F
US-2016054804-A1,G06F
US-2016046061-A1,B29C
US-2016046061-A1,B65D
US-2016046061-A1,B29C
US-2016046061-A1,B29C
US-2016000087-A1,A01N
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,A61K
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
US-2015329561-A1,C07D
Query:
SELECT t."publication_number",
          SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."ipc") ipc_u
   WHERE t."country_code" = 'US' AND
         t."kind_code" = 'B2' AND
         t."grant_date" BETWEEN 20220601 AND 20220930
   LIMIT 100;
Answer:
publication_number,ipc4_code
US-11368189-B2,G06F
US-11368189-B2,H04W
US-11368189-B2,H04W
US-11368189-B2,H04L
US-11368189-B2,H04B
US-11408566-B2,F17D
US-11408566-B2,E21B
US-11408566-B2,E21B
US-11408566-B2,E21B
US-11408566-B2,E21B
US-11408566-B2,F17D
US-11408566-B2,F17D
US-11408566-B2,F17D
US-11386539-B2,H01L
US-11386539-B2,G06T
US-11371080-B2,C12Q
US-11371080-B2,C12Q
US-11429930-B2,G16H
US-11429930-B2,G06F
US-11429930-B2,G06Q
US-11429930-B2,G16H
US-11429930-B2,G06F
US-11429930-B2,G16H
US-11429930-B2,G16H
US-11402589-B2,G02B
US-11402589-B2,F16B
US-11402589-B2,F16B
US-11402589-B2,G02B
US-11356221-B2,H04W
US-11356221-B2,H04J
US-11356221-B2,H04L
US-11356221-B2,H04L
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61Q
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11407172-B2,B29C
US-11407172-B2,B33Y
US-11407172-B2,B22F
US-11407172-B2,B33Y
US-11407172-B2,B29C
US-11407172-B2,B33Y
US-11407172-B2,B22F
US-11407172-B2,B29C
US-11407172-B2,B29C
US-11400006-B2,F16B
US-11400006-B2,A61B
US-11400006-B2,A61G
US-11391070-B2,G08B
US-11391070-B2,G07C
US-11391070-B2,E05B
US-11391070-B2,A47F
US-11391070-B2,E05B
US-11391070-B2,A47F
US-11391070-B2,G08B
US-11383851-B2,B64D
US-11383851-B2,B64C
US-11383851-B2,G05G
US-11383851-B2,B64C
US-11383851-B2,B64C
US-11453255-B2,B60C
US-11453255-B2,B60C
US-11453255-B2,B60C
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61M
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11384000-B2,C02F
US-11384000-B2,C02F
US-11384000-B2,G06F
US-11384000-B2,C02F
US-11369714-B2,A61L
US-11369714-B2,A61L
US-11369714-B2,A61L
US-11369714-B2,A61L
US-11369714-B2,A61L
US-11369714-B2,A61L
US-11369714-B2,C12N
US-11369714-B2,A61L
US-11373467-B2,G07C
Query:
SELECT SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
           COUNT(*) AS "code_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    GROUP BY "ipc4_code"
    ORDER BY "code_count" DESC
    LIMIT 100;
Answer:
ipc4_code,code_count
A61K,60048
G06F,40065
H01L,38756
A61P,30948
H04N,28623
C07D,26595
G01N,24118
C07C,20874
B01D,20328
H01M,20249
H04L,19101
B65D,17788
B29C,17478
A61B,16859
H04W,16710
B32B,13935
C12N,13902
C08L,13686
G06Q,12044
G02B,11835
B65G,11612
B01J,11549
G11B,11530
H05K,10458
F21V,10399
C02F,9969
H01R,9838
C08K,9750
C08F,9509
B23K,9066
H04B,8956
C07K,8629
A61M,8438
A23L,8302
B65H,8270
F24F,8251
C08G,8226
G01R,8108
C09D,8096
H02K,7975
G06T,7739
B24B,7518
A61F,7336
B41J,7150
B08B,7009
C04B,6981
A01N,6814
F16H,6798
F16K,6755
G02F,6627
H01H,6605
E04B,6485
F16L,6446
B01F,6384
B60R,6364
C23C,6363
G03G,6261
G06K,6253
A61L,6160
H02J,6053
E21B,5995
H04M,5925
H05B,5877
B21D,5850
B65B,5775
C22C,5760
H01B,5650
A01G,5600
B02C,5595
F26B,5448
H01F,5399
B23Q,5338
B62D,5274
A47B,5043
G01S,5040
E06B,5010
H01J,4982
G01B,4935
A47J,4884
G03B,4842
F04D,4694
G09G,4692
C09K,4520
A01K,4448
H01Q,4374
B26D,4308
G11C,4301
B05B,4272
C09J,4265
C11D,4211
G09F,4210
A63F,4171
C08J,4129
A63B,4067
A61Q,4025
H02M,3869
F16M,3859
E02D,3806
F16C,3789
F02D,3776
Query:
SELECT SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
           COUNT(*) AS "code_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US' AND
          t."kind_code" = 'B2' AND
          t."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY "ipc4_code"
    HAVING COUNT(*) >= 10
    ORDER BY "code_count" DESC
    LIMIT 100;
Answer:
ipc4_code,code_count
G06F,104
H04N,76
H01L,71
A61B,68
H04L,50
A61K,47
H04W,38
G06T,37
G06V,36
G02B,27
B29C,22
B01J,21
G10L,21
G06N,20
A61M,20
E21B,18
C12N,17
B32B,17
G01S,16
H05B,16
G06Q,16
G02F,16
H04B,15
C10G,14
B25J,13
G16H,13
C08F,13
A61P,13
A61F,13
G06K,12
G05B,12
G01N,11
B65D,11
B23K,10
F04B,10
B65B,10
G01B,10
Query:
SELECT DISTINCT t."publication_number",
           SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US' AND
          t."kind_code" = 'B2' AND
          t."grant_date" BETWEEN 20220601 AND 20220930
    LIMIT 100;
Answer:
publication_number,ipc4_code
US-11435660-B2,G03F
US-11392816-B2,A01K
US-11420401-B2,B29C
US-11418602-B2,H04L
US-11423376-B2,G06V
US-11453255-B2,B60C
US-11376319-B2,A61K
US-11435444-B2,G01C
US-11381908-B2,H03F
US-11457276-B2,G06V
US-11384463-B2,A41H
US-11441084-B2,C10G
US-11374644-B2,H04B
US-11370085-B2,B24C
US-11451086-B2,H02J
US-11437597-B2,H10K
US-11422371-B2,G06T
US-11382363-B2,A41C
US-11443120-B2,G06V
US-11443120-B2,G06F
US-11365041-B2,B65D
US-11356221-B2,H04J
US-11375403-B2,H04L
US-11398087-B2,G06T
US-11436630-B2,G06Q
US-11447026-B2,H02P
US-11408566-B2,F17D
US-11434270-B2,A61M
US-11407017-B2,B21F
US-11401219-B2,B01J
US-11436431-B2,G06V
US-11373404-B2,H04N
US-11391553-B2,F42B
US-11365041-B2,F04B
US-11400006-B2,A61G
US-11428135-B2,F01N
US-11368189-B2,H04B
US-11440728-B2,B65D
US-11396572-B2,C08L
US-11434838-B2,F02D
US-11368762-B2,H04N
US-11409969-B2,H04B
US-11453246-B2,B60C
US-11369714-B2,C12N
US-11376718-B2,B25B
US-11424341-B2,H01L
US-11446260-B2,A61K
US-11434426-B2,G02F
US-11353091-B2,F16H
US-11376109-B2,B65B
US-11407574-B2,B65D
US-11416001-B2,G05D
US-11416001-B2,B63H
US-11433868-B2,F16D
US-11428067-B2,C06B
US-11367437-B2,G10L
US-11363375-B2,H04M
US-11370724-B2,B82Y
US-11406524-B2,A61G
US-11384463-B2,B44C
US-11386741-B2,G06T
US-11384000-B2,C02F
US-11376109-B2,A61F
US-11416001-B2,A01B
US-11435444-B2,G01S
US-11394671-B2,G06Q
US-11417842-B2,C08F
US-11436431-B2,G06N
US-11405208-B2,H04L
US-11373466-B2,B60W
US-11448422-B2,F24F
US-11426701-B2,B01F
US-11413710-B2,F16B
US-11422402-B2,B64D
US-11372439-B2,G01D
US-11380566-B2,G05B
US-11354278-B2,H04L
US-11363536-B2,H04W
US-11400486-B2,C11D
US-11455459-B2,G06F
US-11393239-B2,G06V
US-11407829-B2,C07K
US-11407829-B2,A61K
US-11446383-B2,A61K
US-11369979-B2,B08B
US-11389656-B2,A61N
US-11445622-B2,G06F
US-11422371-B2,G02F
US-11438668-B2,H04N
US-11428911-B2,G02B
US-11429930-B2,G06F
US-11442092-B2,H02P
US-11391059-B2,E05B
US-11423539-B2,A61B
US-11434270-B2,C07K
US-11436134-B2,G06F
US-11374186-B2,H01L
US-11384463-B2,G06V
US-11378383-B2,G05D
US-11367437-B2,H04R
Query:
SELECT t."publication_number",
           COUNT(DISTINCT SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4)) AS "num_ipc4_codes"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US' AND
          t."kind_code" = 'B2' AND
          t."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY t."publication_number"
    LIMIT 100;
Answer:
publication_number,num_ipc4_codes
US-11407174-B2,2
US-11389834-B2,2
US-11449524-B2,4
US-11380566-B2,4
US-11405983-B2,1
US-11374401-B2,2
US-11429930-B2,3
US-11415428-B2,1
US-11375590-B2,4
US-11447750-B2,3
US-11451086-B2,2
US-11440728-B2,2
US-11456032-B2,1
US-11393967-B2,1
US-11420401-B2,2
US-11394231-B2,1
US-11354655-B2,2
US-11449952-B2,2
US-11414016-B2,2
US-11444995-B2,3
US-11450326-B2,3
US-11441406-B2,2
US-11389656-B2,1
US-11392648-B2,2
US-11450090-B2,10
US-11376346-B2,1
US-11440085-B2,1
US-11446908-B2,1
US-11351045-B2,1
US-11419318-B2,3
US-11374644-B2,2
US-11392816-B2,3
US-11424884-B2,2
US-11379973-B2,4
US-11352465-B2,3
US-11408811-B2,2
US-11428135-B2,1
US-11402589-B2,2
US-11375403-B2,2
US-11386278-B2,3
US-11412923-B2,2
US-11451603-B2,1
US-11404853-B2,2
US-11387621-B2,1
US-11369979-B2,2
US-11357437-B2,1
US-11387209-B2,1
US-11375809-B2,1
US-11416109-B2,2
US-11367437-B2,2
US-11437597-B2,2
US-11454603-B2,1
US-11376319-B2,2
US-11410444-B2,2
US-11448216-B2,1
US-11434270-B2,4
US-11384000-B2,2
US-11369714-B2,2
US-11393351-B2,1
US-11448742-B2,1
US-11400486-B2,3
US-11457276-B2,3
US-11439749-B2,2
US-11446260-B2,2
US-11452433-B2,2
US-11352686-B2,2
US-11433868-B2,2
US-11396732-B2,1
US-11438650-B2,2
US-11393841-B2,2
US-11360211-B2,3
US-11401923-B2,2
US-11398593-B2,4
US-11410365-B2,2
US-11375912-B2,2
US-11371080-B2,1
US-11375241-B2,2
US-11438668-B2,1
US-11455459-B2,3
US-11424563-B2,2
US-11365729-B2,2
US-11400138-B2,2
US-11383851-B2,3
US-11373404-B2,4
US-11374186-B2,3
US-11368189-B2,4
US-11375960-B2,1
US-11385961-B2,1
US-11363222-B2,1
US-11380765-B2,1
US-11396572-B2,3
US-11445622-B2,4
US-11417842-B2,2
US-11436431-B2,2
US-11370724-B2,3
US-11436736-B2,3
US-11431960-B2,3
US-11444559-B2,1
US-11443228-B2,1
US-11387213-B2,1
Query:
SELECT t."publication_number",
           LISTAGG(DISTINCT SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4), ',') AS "ipc4_codes"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US' AND
          t."kind_code" = 'B2' AND
          t."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY t."publication_number"
    LIMIT 100;
Answer:
publication_number,ipc4_codes
US-11450326-B2,"G10L,B25J,G06V"
US-11415428-B2,G01C
US-11374401-B2,"H02H,H02M"
US-11405983-B2,H05B
US-11429930-B2,"G06Q,G06F,G16H"
US-11381283-B2,"H04B,H04W"
US-11447026-B2,"H02M,B60L,H02P,H02J"
US-11388673-B2,H04W
US-11441406-B2,"E21B,C09K"
US-11414016-B2,"B60R,B62D"
US-11444995-B2,"H04N,G06F,H04L"
US-11389656-B2,A61N
US-11381650-B2,"G16H,H04L,H04W"
US-11437996-B2,H03K
US-11450090-B2,"H05B,G06F,H04N,G05B,G16H,G06N,G06V,G06T,G06K,F21V"
US-11440085-B2,B22D
US-11376346-B2,A61L
US-11407174-B2,"B33Y,B29C"
US-11351045-B2,A61F
US-11375590-B2,"H05B,F21Y,F21S,G03B"
US-11447750-B2,"C12N,A01N,A61B"
US-11389834-B2,"B07C,G05B"
US-11426701-B2,"B22C,B29B,B29K,B01F,B29C"
US-11397326-B2,G02B
US-11443120-B2,"G10L,G06N,G06V,G06F,H04N,H04L,G06Q"
US-11446908-B2,B32B
US-11453193-B2,"G06F,H10K,G02F,G09F,B32B"
US-11386741-B2,"G07F,G06T"
US-11430204-B2,"G06V,H04N"
US-11453420-B2,"B60R,B61G,F16F"
US-11365729-B2,"F04B,F16K"
US-11449524-B2,"H04L,G06Q,G07B,G06F"
US-11451086-B2,"G05B,H02J"
US-11382705-B2,"B25J,A61B"
US-11440275-B2,"B29L,B29C,B29K"
US-11419318-B2,"A61K,A01K,C12N"
US-11392648-B2,"G10L,G06F"
US-11365041-B2,"F04B,B65D"
US-11380566-B2,"B66C,G05B,G03F,H01L"
US-11455459-B2,"G06Q,G06F,H04L"
US-11406832-B2,"G16H,A61N"
US-11440728-B2,"B65D,B65B"
US-11393967-B2,H01L
US-11384463-B2,"B41M,D06C,A41H,A41D,G06V,B44C,D06Q,D06M,B23K,D06B"
US-11398087-B2,"G06V,G06T"
US-11354261-B2,"G06F,G05B"
US-11412974-B2,"A61B,G16H"
US-11456419-B2,H01L
US-11379962-B2,"H04N,G06T"
US-11435551-B2,"G02B,H04N"
US-11363813-B2,A01N
US-11401428-B2,"B05D,C09D,C08G"
US-11445941-B2,"A61B,G02B,G01B"
US-11422523-B2,G05B
US-11352465-B2,"C08K,C08J,C08L"
US-11424884-B2,"H04W,H04L"
US-11428135-B2,F01N
US-11424563-B2,"H05K,H01R"
US-11398338-B2,H01F
US-11451557-B2,H04L
US-11421473-B2,E06B
US-11456032-B2,G11C
US-11434426-B2,"C09K,G02F"
US-11369217-B2,A47F
US-11374026-B2,H01L
US-11453749-B2,"G01N,C08G,C08L"
US-11391070-B2,"G08B,G07C,A47F,E05B"
US-11416022-B2,"G06F,G01R,G06J,H04L"
US-11453246-B2,B60C
US-11433084-B2,A61K
US-11407017-B2,"B21F,B21D"
US-11392814-B2,"G06K,G06N"
US-11434270-B2,"A61P,A61K,A61M,C07K"
US-11393351-B2,G09B
US-11369714-B2,"C12N,A61L"
US-11384000-B2,"C02F,G06F"
US-11354278-B2,"H04L,G06F,G06Q"
US-11407366-B2,B60R
US-11452433-B2,"A61B,G02B"
US-11439749-B2,"A61M,A61F"
US-11352686-B2,"C22C,C22F"
US-11446260-B2,"A61P,A61K"
US-11457276-B2,"H04N,G06V,H04H"
US-11427279-B2,B62K
US-11395931-B2,A62C
US-11379973-B2,"G06T,G06V,G05B,G06N"
US-11371080-B2,C12Q
US-11375241-B2,"G06T,H04N"
US-11408566-B2,"F17D,E21B"
US-11430084-B2,"G06N,G06F,G06T,G06V"
US-11434152-B2,"A23L,C02F"
US-11390055-B2,B32B
US-11400486-B2,"B05D,C11D,C09D"
US-11448742-B2,G01S
US-11433630-B2,"B29D,B29K,G02B"
US-11407307-B2,"F16H,B60K"
US-11420401-B2,"B29C,B25J"
US-11354655-B2,"G06F,G06Q"
US-11416001-B2,"B66F,B65G,B63G,A01B,G05D,B63H,B62D,G06F,G06T"
US-11432771-B2,A61B
Query:
SELECT t."publication_number",
           ipc_u.value::VARIANT:"code"::STRING AS "ipc_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE ipc_u.value::VARIANT:"first"::BOOLEAN = true
    LIMIT 100;
Answer:
publication_number,ipc_code
US-2017299239-A1,F25B39/00
US-2017217147-A1,B41C1/05
US-2017157230-A1,A61K39/00
US-2017294111-A1,G08B27/00
US-2018209343-A1,F02C7/18
US-2018209516-A1,F16H7/12
US-2017128414-A1,A61K31/381
US-2018213907-A1,A45C13/42
US-2017220072-A1,G06F1/16
US-2017139227-A1,G02B27/64
US-2017365664-A1,H01L29/16
US-2018250929-A1,B41F35/00
US-2017178700-A1,G11C7/06
US-2018260785-A1,G06Q10/10
US-2017185204-A1,G06F3/041
US-2017247327-A1,C07D209/52
US-2017197438-A1,B41J2/18
US-2018082949-A1,H01L23/525
US-2017206144-A1,G06F11/14
US-2018282042-A1,B65D75/58
US-2017208224-A1,H04N5/217
US-2017308977-A1,G06Q50/18
US-2017225515-A1,B60C11/12
US-2017280584-A1,H05K7/18
US-2017275886-A1,E04F11/00
US-2017304548-A1,A61M5/315
US-2017343044-A1,F16C33/14
US-2018003796-A1,G01S5/30
US-2018265940-A1,C21D8/06
US-2018085831-A1,B23B27/10
US-2018086852-A1,C08B37/08
US-2018176725-A1,H04W4/021
US-2018324179-A1,H04L29/06
US-2017232440-A1,B01L3/00
US-2017240822-A1,C10G51/02
US-2018336080-A1,G06F11/07
US-2017256849-A1,H01Q1/36
US-2018336142-A1,G06F12/128
US-2017342060-A1,C07D405/14
US-2018157518-A1,G06F9/455
US-2018349040-A1,G06F3/06
US-2017268286-A1,E06B3/673
US-2018150766-A1,G06N20/10
US-2017265534-A1,A41D13/005
US-2017343479-A1,G01N21/77
US-2018330275-A1,G06N20/00
US-2018289116-A1,A44C5/20
US-2018074693-A1,G06F3/0488
US-2017311592-A1,A01N33/12
US-2018031066-A1,F16D66/02
US-2018198453-A1,H03L7/085
US-2019037963-A1,A43B5/16
US-2017336253-A1,G01J1/42
US-2017363425-A1,G01C19/5776
US-2017357384-A1,G06F3/0481
US-2018055345-A1,A61B1/00
US-2018002533-A1,C09D5/14
US-2018007292-A1,H04N5/357
US-2019086218-A1,G01C21/34
US-2019242130-A1,E04C3/07
US-2018048878-A1,H04N13/239
US-2018100511-A1,F04D25/06
US-2018028529-A1,A61K31/485
US-2021210331-A1,H01J49/42
US-2018170890-A1,C07D307/50
US-2018365876-A1,G06T11/60
US-2019286461-A1,G06F9/451
US-2018205882-A1,H04N5/232
US-2018328368-A1,F04D25/08
US-2019164855-A1,H01L21/66
US-2018318275-A1,A61K31/4439
US-2018246672-A1,G06F3/06
US-2018341140-A1,G02F1/1339
US-2018270078-A1,H04L12/28
US-2018284544-A1,G02F1/1337
US-2018289660-A1,A61K31/26
US-2018364504-A1,G02F1/137
US-2018258054-A1,C07D239/42
US-2019130354-A1,G06Q10/08
US-2018130564-A1,G21F3/02
US-2018147645-A1,B23H1/02
US-2018248249-A1,H01Q1/24
US-2018151113-A1,G09G3/325
US-2018159083-A1,H01L51/52
US-2019182702-A1,H04W28/02
US-2018170618-A1,B65D23/14
US-2018178490-A1,B32B7/12
US-2018180342-A1,F25D3/10
US-2018177271-A1,A45C7/00
US-2019213009-A1,G06F9/30
US-2018218639-A1,G09B19/16
US-2018141330-A1,B41J2/045
US-2018226277-A1,H01L21/67
US-2018191901-A1,H04M3/51
US-2018264990-A1,B60Q1/00
US-2019259689-A1,H01L23/495
US-2018179229-A1,C07D519/00
US-2018277353-A1,H01L21/02
US-2019235684-A1,G06F3/041
US-2018193637-A1,A61N1/30
Query:
SELECT t."publication_number",
           SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US' AND
          t."kind_code" = 'B2' AND
          t."grant_date" BETWEEN 20220601 AND 20220930 AND
          SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) IN (
              SELECT SUBSTRING(ipc_u2.value::VARIANT:"code"::STRING, 1, 4)
              FROM PATENTS.PATENTS.PUBLICATIONS t2,
                   LATERAL FLATTEN(input => t2."ipc") ipc_u2
              WHERE t2."country_code" = 'US' AND
                    t2."kind_code" = 'B2' AND
                    t2."grant_date" BETWEEN 20220601 AND 20220930
              GROUP BY SUBSTRING(ipc_u2.value::VARIANT:"code"::STRING, 1, 4)
              HAVING COUNT(*) >= 10
          )
    LIMIT 100;
Answer:
publication_number,ipc4_code
US-11406524-B2,A61F
US-11406524-B2,A61F
US-11376109-B2,A61F
US-11439749-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11399950-B2,A61F
US-11399950-B2,A61F
US-11382760-B2,A61F
US-11382760-B2,A61F
US-11382760-B2,A61F
US-11422371-B2,G02F
US-11434426-B2,G02F
US-11396158-B2,G02F
US-11396158-B2,G02F
US-11422402-B2,G02F
US-11422402-B2,G02F
US-11431960-B2,G02F
US-11431960-B2,G02F
US-11431960-B2,G02F
US-11431960-B2,G02F
US-11431960-B2,G02F
US-11431960-B2,G02F
US-11431960-B2,G02F
US-11431960-B2,G02F
US-11431960-B2,G02F
US-11453193-B2,G02F
US-11438395-B2,G06N
US-11443406-B2,G06N
US-11443406-B2,G06N
US-11443228-B2,G06N
US-11436431-B2,G06N
US-11379726-B2,G06N
US-11379726-B2,G06N
US-11379726-B2,G06N
US-11379973-B2,G06N
US-11443120-B2,G06N
US-11443120-B2,G06N
US-11443120-B2,G06N
US-11392814-B2,G06N
US-11392814-B2,G06N
US-11450090-B2,G06N
US-11450090-B2,G06N
US-11450090-B2,G06N
US-11430084-B2,G06N
US-11398593-B2,G06N
US-11416699-B2,G06N
US-11386886-B2,G10L
US-11386886-B2,G10L
US-11443120-B2,G10L
US-11443120-B2,G10L
US-11443120-B2,G10L
US-11443120-B2,G10L
US-11443120-B2,G10L
US-11443120-B2,G10L
US-11392648-B2,G10L
US-11392648-B2,G10L
US-11367437-B2,G10L
US-11367437-B2,G10L
US-11367437-B2,G10L
US-11367437-B2,G10L
US-11450326-B2,G10L
US-11450326-B2,G10L
US-11450326-B2,G10L
US-11450326-B2,G10L
US-11438650-B2,G10L
US-11438650-B2,G10L
US-11438650-B2,G10L
US-11384463-B2,B23K
US-11384463-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11381650-B2,G16H
US-11406832-B2,G16H
US-11412974-B2,G16H
US-11412974-B2,G16H
US-11412974-B2,G16H
US-11412974-B2,G16H
US-11429930-B2,G16H
US-11429930-B2,G16H
US-11429930-B2,G16H
US-11429930-B2,G16H
US-11450090-B2,G16H
US-11416699-B2,G16H
US-11416699-B2,G16H
US-11373404-B2,G06T
US-11373280-B2,G06T
US-11373280-B2,G06T
US-11443406-B2,G06T
US-11443406-B2,G06T
US-11386539-B2,G06T
US-11422371-B2,G06T
Query:
SELECT t."publication_number", "ipc4_code"
FROM (
    -- subquery
) sub
WHERE "rank" = 1
LIMIT 100;
Answer:
001003 (42000): 01b9f77e-0004-7d15-0001-11c300fad34e: SQL compilation error:
syntax error line 4 at position 0 unexpected ')'.Query:
WITH code_counts AS (
    SELECT SUBSTRING(ipc_u2.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
           COUNT(*) AS "code_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t2,
         LATERAL FLATTEN(input => t2."ipc") ipc_u2
    WHERE t2."country_code" = 'US' AND
          t2."kind_code" = 'B2' AND
          t2."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY "ipc4_code"
    HAVING COUNT(*) >= 10
),
flattened_ipc AS (
    SELECT t."publication_number",
           SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US' AND
          t."kind_code" = 'B2' AND
          t."grant_date" BETWEEN 20220601 AND 20220930
),
ranked_ipc AS (
    SELECT fi."publication_number",
           fi."ipc4_code",
           DENSE_RANK() OVER (PARTITION BY fi."publication_number" ORDER BY cc."code_count" DESC) AS "rank"
    FROM flattened_ipc fi
    JOIN code_counts cc ON fi."ipc4_code" = cc."ipc4_code"
)
SELECT rp."publication_number", rp."ipc4_code"
FROM ranked_ipc rp
WHERE rp."rank" = 1
LIMIT 100;
Answer:
publication_number,ipc4_code
US-11429930-B2,G06F
US-11429930-B2,G06F
US-11447750-B2,A61B
US-11447750-B2,A61B
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11389834-B2,G05B
US-11444995-B2,G06F
US-11381650-B2,H04L
US-11381650-B2,H04L
US-11381650-B2,H04L
US-11405983-B2,H05B
US-11405983-B2,H05B
US-11392648-B2,G06F
US-11392648-B2,G06F
US-11392648-B2,G06F
US-11441406-B2,E21B
US-11375590-B2,H05B
US-11375590-B2,H05B
US-11407174-B2,B29C
US-11407174-B2,B29C
US-11449524-B2,G06F
US-11449524-B2,G06F
US-11419318-B2,A61K
US-11401923-B2,F04B
US-11410365-B2,G06F
US-11410365-B2,G06F
US-11450326-B2,G06V
US-11368189-B2,G06F
US-11374186-B2,H01L
US-11376319-B2,A61K
US-11376319-B2,A61K
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11390055-B2,B32B
US-11422402-B2,G06F
US-11422402-B2,G06F
US-11422402-B2,G06F
US-11422402-B2,G06F
US-11384177-B2,E21B
US-11384177-B2,E21B
US-11384177-B2,E21B
US-11397326-B2,G02B
US-11382705-B2,A61B
US-11382705-B2,A61B
US-11382705-B2,A61B
US-11382705-B2,A61B
US-11380566-B2,H01L
US-11380566-B2,H01L
US-11384463-B2,G06V
US-11398087-B2,G06T
US-11410148-B2,H04L
US-11373280-B2,G06T
US-11373280-B2,G06T
US-11412974-B2,A61B
US-11412974-B2,A61B
US-11412974-B2,A61B
US-11412974-B2,A61B
US-11354261-B2,G06F
US-11354261-B2,G06F
US-11354261-B2,G06F
US-11441084-B2,B01J
US-11441084-B2,B01J
US-11441084-B2,B01J
US-11441084-B2,B01J
US-11441084-B2,B01J
US-11441084-B2,B01J
US-11441084-B2,B01J
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11408566-B2,E21B
US-11408566-B2,E21B
US-11408566-B2,E21B
US-11408566-B2,E21B
US-11376109-B2,A61F
US-11418715-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
Query:
WITH ipc_counts AS (
    SELECT SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
           COUNT(*) AS "code_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t2
         , LATERAL FLATTEN(input => t2."ipc") ipc_u
    WHERE t2."country_code" = 'US'
      AND t2."kind_code" = 'B2'
      AND t2."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY "ipc4_code"
    HAVING COUNT(*) >= 10
),
ipc_flat AS (
    SELECT t."publication_number",
           SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US'
      AND t."kind_code" = 'B2'
      AND t."grant_date" BETWEEN 20220601 AND 20220930
)
SELECT ipc_flat."publication_number", ipc_flat."ipc4_code"
FROM ipc_flat
JOIN ipc_counts ON ipc_flat."ipc4_code" = ipc_counts."ipc4_code"
LIMIT 100
Answer:
publication_number,ipc4_code
US-11445941-B2,G01B
US-11445941-B2,G01B
US-11378383-B2,G01B
US-11378383-B2,G01B
US-11378383-B2,G01B
US-11421980-B2,G01B
US-11421980-B2,G01B
US-11421980-B2,G01B
US-11353321-B2,G01B
US-11353321-B2,G01B
US-11384463-B2,B23K
US-11384463-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11365041-B2,B65D
US-11365041-B2,B65D
US-11365041-B2,B65D
US-11407574-B2,B65D
US-11440728-B2,B65D
US-11440728-B2,B65D
US-11440728-B2,B65D
US-11440728-B2,B65D
US-11376109-B2,B65D
US-11376109-B2,B65D
US-11376109-B2,B65D
US-11400006-B2,A61B
US-11432771-B2,A61B
US-11432771-B2,A61B
US-11432771-B2,A61B
US-11432771-B2,A61B
US-11432771-B2,A61B
US-11452433-B2,A61B
US-11452433-B2,A61B
US-11452433-B2,A61B
US-11412960-B2,A61B
US-11412960-B2,A61B
US-11412960-B2,A61B
US-11412960-B2,A61B
US-11412974-B2,A61B
US-11412974-B2,A61B
US-11412974-B2,A61B
US-11412974-B2,A61B
US-11419647-B2,A61B
US-11419647-B2,A61B
US-11419647-B2,A61B
US-11419647-B2,A61B
US-11419647-B2,A61B
US-11375912-B2,A61B
US-11382705-B2,A61B
US-11382705-B2,A61B
US-11382705-B2,A61B
US-11382705-B2,A61B
US-11439554-B2,A61B
US-11375960-B2,A61B
US-11375960-B2,A61B
US-11375960-B2,A61B
US-11375960-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11445941-B2,A61B
US-11445941-B2,A61B
US-11445941-B2,A61B
US-11445941-B2,A61B
US-11445941-B2,A61B
US-11445941-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11376070-B2,A61B
US-11376070-B2,A61B
US-11376070-B2,A61B
US-11376070-B2,A61B
US-11447750-B2,A61B
US-11447750-B2,A61B
US-11423539-B2,A61B
US-11412923-B2,A61M
Query:
WITH code_counts AS (
    SELECT SUBSTRING(ipc_u2.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
           COUNT(*) AS "code_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t2
         , LATERAL FLATTEN(input => t2."ipc") ipc_u2
    WHERE t2."country_code" = 'US'
      AND t2."kind_code" = 'B2'
      AND t2."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY "ipc4_code"
),
ipc_data AS (
    SELECT t."publication_number",
           SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US'
      AND t."kind_code" = 'B2'
      AND t."grant_date" BETWEEN 20220601 AND 20220930
)
SELECT sub."publication_number", sub."ipc4_code"
FROM (
    SELECT ipc_data."publication_number", ipc_data."ipc4_code",
           DENSE_RANK() OVER (PARTITION BY ipc_data."publication_number" ORDER BY code_counts."code_count" DESC) AS "rank"
    FROM ipc_data
    LEFT JOIN code_counts ON ipc_data."ipc4_code" = code_counts."ipc4_code"
) sub
WHERE sub."rank" = 1
LIMIT 100
Answer:
publication_number,ipc4_code
US-11415428-B2,G01C
US-11415428-B2,G01C
US-11419318-B2,A61K
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11389834-B2,G05B
US-11441406-B2,E21B
US-11437996-B2,H03K
US-11437996-B2,H03K
US-11376346-B2,A61L
US-11376346-B2,A61L
US-11380566-B2,H01L
US-11380566-B2,H01L
US-11449524-B2,G06F
US-11449524-B2,G06F
US-11405983-B2,H05B
US-11405983-B2,H05B
US-11374401-B2,H02M
US-11374401-B2,H02M
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11381650-B2,H04L
US-11381650-B2,H04L
US-11381650-B2,H04L
US-11360211-B2,G06V
US-11375912-B2,A61B
US-11412422-B2,H04L
US-11407174-B2,B29C
US-11407174-B2,B29C
US-11410365-B2,G06F
US-11410365-B2,G06F
US-11401923-B2,F04B
US-11392816-B2,G06K
US-11429930-B2,G06F
US-11429930-B2,G06F
US-11414016-B2,B60R
US-11410444-B2,G06F
US-11410444-B2,G06F
US-11410444-B2,G06F
US-11410444-B2,G06F
US-11440085-B2,B22D
US-11440085-B2,B22D
US-11440085-B2,B22D
US-11440085-B2,B22D
US-11392648-B2,G06F
US-11392648-B2,G06F
US-11392648-B2,G06F
US-11450326-B2,G06V
US-11401219-B2,B01J
US-11401219-B2,B01J
US-11401219-B2,B01J
US-11401219-B2,B01J
US-11401219-B2,B01J
US-11400486-B2,C09D
US-11400486-B2,C09D
US-11400486-B2,C09D
US-11400486-B2,C09D
US-11444995-B2,G06F
US-11373467-B2,G07C
US-11373467-B2,G07C
US-11363375-B2,G01S
US-11389656-B2,A61N
US-11442092-B2,G01R
US-11442092-B2,H02P
US-11407366-B2,B60R
US-11406832-B2,G16H
US-11453193-B2,G06F
US-11397326-B2,G02B
US-11382705-B2,A61B
US-11382705-B2,A61B
US-11382705-B2,A61B
US-11382705-B2,A61B
US-11364500-B2,B01L
US-11363222-B2,H04N
US-11363222-B2,H04N
US-11363222-B2,H04N
US-11453420-B2,B60R
US-11374644-B2,H04W
US-11390722-B2,C08G
US-11453255-B2,B60C
US-11453255-B2,B60C
US-11453255-B2,B60C
US-11422364-B2,G06T
US-11423539-B2,A61B
US-11421980-B2,G01S
US-11421980-B2,G01S
US-11413537-B2,G06F
US-11413537-B2,G06F
Query:
WITH code_counts AS (
    SELECT SUBSTRING(ipc_u2.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
           COUNT(*) AS "code_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t2
         , LATERAL FLATTEN(input => t2."ipc") ipc_u2
    WHERE t2."country_code" = 'US'
      AND t2."kind_code" = 'B2'
      AND t2."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY "ipc4_code"
    HAVING COUNT(*) >= 10
),
ipc_data AS (
    SELECT t."publication_number",
           SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t
         , LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE t."country_code" = 'US'
      AND t."kind_code" = 'B2'
      AND t."grant_date" BETWEEN 20220601 AND 20220930
)
SELECT sub."publication_number", sub."ipc4_code"
FROM (
    SELECT ipc_data."publication_number", ipc_data."ipc4_code",
           DENSE_RANK() OVER (PARTITION BY ipc_data."publication_number" ORDER BY code_counts."code_count" DESC) AS "rank"
    FROM ipc_data
    JOIN code_counts ON ipc_data."ipc4_code" = code_counts."ipc4_code"
) sub
WHERE sub."rank" = 1
LIMIT 100
Answer:
publication_number,ipc4_code
US-11447750-B2,A61B
US-11447750-B2,A61B
US-11389834-B2,G05B
US-11381650-B2,H04L
US-11381650-B2,H04L
US-11381650-B2,H04L
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11429930-B2,G06F
US-11429930-B2,G06F
US-11375590-B2,H05B
US-11375590-B2,H05B
US-11392648-B2,G06F
US-11392648-B2,G06F
US-11392648-B2,G06F
US-11407174-B2,B29C
US-11407174-B2,B29C
US-11449524-B2,G06F
US-11449524-B2,G06F
US-11444995-B2,G06F
US-11405983-B2,H05B
US-11405983-B2,H05B
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11419318-B2,A61K
US-11422402-B2,G06F
US-11422402-B2,G06F
US-11422402-B2,G06F
US-11422402-B2,G06F
US-11384177-B2,E21B
US-11384177-B2,E21B
US-11384177-B2,E21B
US-11440728-B2,B65D
US-11440728-B2,B65D
US-11440728-B2,B65D
US-11440728-B2,B65D
US-11390055-B2,B32B
US-11376109-B2,A61F
US-11434426-B2,G02F
US-11374026-B2,H01L
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11445494-B2,H04W
US-11445494-B2,H04W
US-11445494-B2,H04W
US-11445494-B2,H04W
US-11443406-B2,G06F
US-11443406-B2,G06F
US-11379726-B2,G06N
US-11379726-B2,G06N
US-11379726-B2,G06N
US-11392814-B2,G06N
US-11392814-B2,G06N
US-11392816-B2,G06K
US-11433630-B2,G02B
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11453749-B2,G01N
US-11422364-B2,G06T
US-11412422-B2,H04L
US-11365041-B2,B65D
US-11365041-B2,B65D
US-11365041-B2,B65D
US-11455459-B2,G06F
US-11455459-B2,G06F
US-11455459-B2,G06F
US-11455459-B2,G06F
US-11455459-B2,G06F
US-11454603-B2,G01N
US-11454603-B2,G01N
US-11454603-B2,G01N
US-11384463-B2,G06V
US-11435551-B2,H04N
US-11401923-B2,F04B
US-11410365-B2,G06F
US-11410365-B2,G06F
US-11436736-B2,G06T
US-11436736-B2,G06T
US-11387213-B2,H01L
Query:
WITH ipc_counts AS (
    SELECT SUBSTRING(ipc_u2.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
           COUNT(*) AS "code_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t2
         , LATERAL FLATTEN(input => t2."ipc") ipc_u2
    WHERE t2."country_code" = 'US'
      AND t2."kind_code" = 'B2'
      AND t2."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY "ipc4_code"
    HAVING COUNT(*) >= 10
)
SELECT t."publication_number",
       SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
FROM PATENTS.PATENTS.PUBLICATIONS t
     , LATERAL FLATTEN(input => t."ipc") ipc_u
WHERE t."country_code" = 'US'
  AND t."kind_code" = 'B2'
  AND t."grant_date" BETWEEN 20220601 AND 20220930
  AND SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) IN (
      SELECT "ipc4_code" FROM ipc_counts
  )
LIMIT 100
Answer:
publication_number,ipc4_code
US-11407172-B2,B29C
US-11357437-B2,A61B
US-11382705-B2,A61B
US-11438668-B2,H04N
US-11450090-B2,H04N
US-11410444-B2,G06F
US-11450090-B2,G06F
US-11436134-B2,G06F
US-11433084-B2,A61K
US-11353839-B2,H05B
US-11429930-B2,G06Q
US-11400138-B2,A61P
US-11428067-B2,E21B
US-11441406-B2,E21B
US-11407574-B2,B65D
US-11376109-B2,B65D
US-11370724-B2,B01J
US-11422402-B2,H04N
US-11412960-B2,B65B
US-11456776-B2,G05B
US-11375479-B2,H04W
US-11435551-B2,G02B
US-11428911-B2,G02B
US-11388258-B2,H04L
US-11392648-B2,G06F
US-11368189-B2,G06F
US-11416001-B2,G06F
US-11411015-B2,H01L
US-11449524-B2,G06Q
US-11436630-B2,G06Q
US-11384177-B2,E21B
US-11399950-B2,A61F
US-11367437-B2,G10L
US-11401219-B2,B01J
US-11444995-B2,H04N
US-11445941-B2,A61B
US-11432771-B2,A61B
US-11450090-B2,G05B
US-11354278-B2,H04L
US-11375403-B2,H04L
US-11405208-B2,H04L
US-11384463-B2,B23K
US-11364337-B2,A61M
US-11429930-B2,G16H
US-11400138-B2,A61P
US-11450090-B2,G06T
US-11423539-B2,G06T
US-11368762-B2,H04N
US-11412231-B2,H04N
US-11444995-B2,H04N
US-11375960-B2,A61B
US-11419318-B2,C12N
US-11450698-B2,H01L
US-11385961-B2,G06F
US-11422402-B2,G06F
US-11443406-B2,G06N
US-11394671-B2,H04W
US-11388673-B2,H04W
US-11402589-B2,G02B
US-11388258-B2,G06F
US-11449505-B2,G06F
US-11413537-B2,G06F
US-11456776-B2,H04L
US-11393967-B2,H01L
US-11441084-B2,C10G
US-11365041-B2,B65D
US-11400138-B2,A61P
US-11438650-B2,G10L
US-11412974-B2,A61B
US-11443120-B2,G06N
US-11363222-B2,H04N
US-11444109-B2,H04N
US-11412231-B2,H04N
US-11397326-B2,G02B
US-11410444-B2,G06F
US-11387209-B2,H01L
US-11400138-B2,A61K
US-11376319-B2,A61K
US-11354278-B2,G06Q
US-11439749-B2,A61M
US-11421980-B2,G01B
US-11450326-B2,B25J
US-11436630-B2,H04N
US-11379962-B2,H04N
US-11444995-B2,H04N
US-11408566-B2,E21B
US-11441084-B2,B01J
US-11413710-B2,B23K
US-11407829-B2,A61K
US-11409410-B2,G06F
US-11450645-B2,H01L
US-11398593-B2,H01L
US-11440728-B2,B65B
US-11384177-B2,E21B
US-11364337-B2,A61M
US-11351045-B2,A61F
US-11406524-B2,A61F
US-11368762-B2,H04N
US-11452433-B2,A61B
US-11412923-B2,A61B
Query:
SELECT t."publication_number",
       ipc_u.value::VARIANT:"code"::STRING AS "ipc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t
     , LATERAL FLATTEN(input => t."ipc") ipc_u
WHERE ipc_u.value::VARIANT:"first"::BOOLEAN = true
LIMIT 100
Answer:
publication_number,ipc_code
US-2006215095-A1,G02F1/1337
US-2006225070-A1,G06F9/445
US-2006223426-A1,B24B1/00
US-2006250589-A1,G03B27/68
US-2006133105-A1,F21V33/00
US-2006264190-A1,H04Q7/32
US-2006272652-A1,A61B19/00
US-2006280400-A1,G02B6/28
US-2006089742-A1,G06F19/00
US-2006088772-A1,G03C5/00
US-2006006745-A1,H02K9/00
US-2007010420-A1,C11D3/00
US-2006001827-A1,G02C5/00
US-2006019148-A1,H01M4/86
US-2006023399-A1,H01G4/06
US-2006029199-A1,H04M1/64
US-2006047298-A1,A61M29/00
US-2006049749-A1,H01J1/62
US-2007055408-A1,H02J3/00
US-2006057776-A1,H01L21/50
US-2007061156-A1,G06Q99/00
US-2006020170-A1,A61B1/00
US-2006015009-A1,A61B1/00
US-2006069023-A1,A61K38/17
US-2007089984-A1,C23C14/00
US-2006106467-A1,G05B11/01
US-2007095595-A1,B60K28/12
US-2007095595-A1,B60R99/00
US-2006120791-A1,B41J15/00
US-2006068001-A1,A61K9/62
US-2006115184-A1,G06K9/32
US-2006120084-A1,F21V29/00
US-2006148712-A1,A61K38/10
US-2006123024-A1,G06F7/00
US-2006131447-A1,F02M63/00
US-2006136401-A1,G06F17/30
US-2006135276-A1,A63B69/36
US-2007296592-A1,G08B13/14
US-2007142872-A1,A61N1/00
US-2006155443-A1,E05F15/00
US-2006160812-A1,A61K31/50
US-2007044147-A1,G06F15/16
US-2007161284-A1,H01R3/00
US-2006162744-A1,B08B3/02
US-2006206315-A1,G10L21/0308
US-2006119689-A1,G03G15/01
US-2006216699-A1,C12N15/00
US-2006216699-A1,C12Q1/70
US-2007175960-A1,A61B17/04
US-2006183093-A1,G09B13/00
US-2006184118-A1,A61M37/00
US-2007197987-A1,A61F13/15
US-2007001987-A1,G09G3/36
US-2006215540-A1,H04J11/00
US-2006212811-A1,G06F17/00
US-2007215591-A1,F23Q7/00
US-2007221095-A1,C08L95/00
US-2006178603-A1,A61H23/02
US-2007244419-A1,A61F5/00
US-2007261075-A1,H04H60/31
US-2007046568-A1,G09G3/10
US-2007254003-A1,A61K31/4745
US-2007268953-A1,G01K15/00
US-2007275123-A1,A23F3/16
US-2007150297-A1,G06Q99/00
US-2006270996-A1,A61M5/00
US-2006270996-A1,A61M5/142
US-2006265894-A1,G01B5/00
US-2007271228-A1,G06F17/30
US-2006209298-A1,G01N21/00
US-2007278762-A1,B62M1/36
US-2006276577-A1,C08K3/22
US-2006274115-A1,B41J2/135
US-2007012074-A1,D06F39/04
US-2007285147-A1,H03L5/00
US-2006261475-A1,H01L23/48
US-2008038594-A1,H01M8/04
US-2007042238-A1,H01M8/24
US-2008050579-A1,B32B27/18
US-2008005269-A1,G06F15/16
US-2008010292-A1,G06F17/30
US-2006252622-A1,B31C99/00
US-2007130266-A1,G06F15/16
US-2008014421-A1,B32B7/02
US-2007019110-A1,H04N3/27
US-2007028125-A1,G06F1/00
US-2008076740-A1,A61K31/675
US-2009092640-A1,A61K39/00
US-2006276912-A1,G05B15/02
US-2006276912-A1,G05B11/01
US-2008047604-A1,H01L31/00
US-2007060395-A1,F16D3/00
US-2007054509-A1,H01R29/00
US-2007193530-A1,A01K13/00
US-2007027654-A1,G06Q50/10
US-2007027654-A1,G21C17/00
US-2007070009-A1,G09G3/36
US-2008068809-A1,H05K7/20
US-2007079047-A1,G06F13/00
US-2008103882-A1,G06F17/30
Query:
SELECT t."publication_number", ipc_code.*
FROM PATENTS.PATENTS.PUBLICATIONS t
     , LATERAL FLATTEN(input => t."ipc") ipc_u
     , LATERAL (SELECT ipc_u.value::VARIANT:"code"::STRING AS "ipc_code")
LIMIT 100;
Answer:
002001 (02000): 01b9f782-0004-7d15-0001-11c300fad37a: SQL compilation error:
Object 'IPC_CODE' does not exist or not authorized.End Exploring Related Columns
Task: For United States utility patents under the B2 classification granted between June and September of 2022, identify the most frequent 4-digit IPC code for each patent. Then, list the publication numbers and IPC4 codes of patents where this code appears 10 or more times.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
publication_number,ipc4
publication_number1:str,ipc4_code1:str
publication_number2:str,ipc4_code2:str
...
```

We analyzed United States utility patents under the B2 classification granted between June and September of 2022. For each patent, we identified the most frequent 4-digit IPC code (ipc4). We then listed the publication numbers and ipc4 codes of patents where this ipc4 code appears in 10 or more patents. The table above shows the `publication_number` and the corresponding `ipc4` code for each such patent..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-26 09:39:24 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 09:39:24 - root - INFO - ```sql
WITH code_counts AS (
    SELECT
        SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
        COUNT(*) AS "code_count"
    FROM
        PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE
        t."country_code" = 'US'
        AND t."kind_code" = 'B2'
        AND t."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY
        "ipc4_code"
    HAVING
        COUNT(*) >= 10
),
ipc_codes AS (
    SELECT
        t."publication_number",
        SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
    FROM
        PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE
        t."country_code" = 'US'
        AND t."kind_code" = 'B2'
        AND t."grant_date" BETWEEN 20220601 AND 20220930
),
filtered_ipc_codes AS (
    SELECT
        ipc_codes."publication_number",
        ipc_codes."ipc4_code"
    FROM
        ipc_codes
    INNER JOIN
        code_counts ON ipc_codes."ipc4_code" = code_counts."ipc4_code"
),
ranked_ipc AS (
    SELECT
        fic."publication_number",
        fic."ipc4_code",
        DENSE_RANK() OVER (PARTITION BY fic."publication_number" ORDER BY code_counts."code_count" DESC) AS "rank"
    FROM
        filtered_ipc_codes fic
    INNER JOIN
        code_counts ON fic."ipc4_code" = code_counts."ipc4_code"
)
SELECT
    "publication_number",
    "ipc4_code" AS "ipc4"
FROM
    ranked_ipc
WHERE
    "rank" = 1
```
2025-01-26 09:39:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:39:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:39:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:39:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 611
2025-01-26 09:39:26 - snowflake.connector.connection - INFO - closed
2025-01-26 09:39:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:39:26 - root - INFO - itercount: 1
2025-01-26 09:39:26 - root - INFO - 0
2025-01-26 09:39:26 - root - INFO - results: 
publication_number,ipc4
US-11441406-B2,E21B
US-11444995-B2,G06F
US-11450326-B2,G06V
US-11451086-B2,G05B
US-11447750-B2,A61B
US-11447750-B2,A61B
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11440728-B2,B65D
US-11440728-B2,B65D
US-11440728-B2,B65D
US-11440728-B2,B65D
US-11375590-B2,H05B
US-11375590-B2,H05B
US-11381650-B2,H04L
US-11381650-B2,H04L
US-11381650-B2,H04L
US-11392648-B2,G06F
US-11392648-B2,G06F
US-11392648-B2,G06F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11419318-B2,A61K
US-11405983-B2,H05B
US-11405983-B2,H05B
US-11429930-B2,G06F
US-11429930-B2,G06F
US-11407174-B2,B29C
US-11407174-B2,B29C
US-11449524-B2,G06F
US-11449524-B2,G06F
US-11389834-B2,G05B
US-11380566-B2,H01L
US-11380566-B2,H01L
US-11381283-B2,H04W
US-11381283-B2,H04W
US-11388673-B2,H04W
US-11388673-B2,H04W
US-11388673-B2,H04W
US-11388673-B2,H04W
US-11388673-B2,H04W
US-11388673-B2,H04W
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11373404-B2,G06F
US-11368189-B2,G06F
US-11400138-B2,A61K
US-11400138-B2,A61K
US-11400138-B2,A61K
US-11375960-B2,A61B
US-11375960-B2,A61B
US-11375960-B2,A61B
US-11375960-B2,A61B
US-11374186-B2,H01L
US-11443406-B2,G06F
US-11443406-B2,G06F
US-11379726-B2,G06N
US-11379726-B2,G06N
US-11379726-B2,G06N
US-11390055-B2,B32B
US-11434426-B2,G02F
US-11430084-B2,G06F
US-11453749-B2,G01N
US-11374026-B2,H01L
US-11378383-B2,G06F
US-11378383-B2,G06F
US-11456776-B2,H04L
US-11456776-B2,H04L
US-11456776-B2,H04L
US-11445494-B2,H04W
US-11445494-B2,H04W
US-11445494-B2,H04W
US-11445494-B2,H04W
US-11453654-B2,G02B
US-11397148-B2,G01N
US-11374056-B2,H01L
US-11374056-B2,H01L
US-11374056-B2,H01L
US-11407829-B2,A61K
US-11407829-B2,A61K
US-11407829-B2,A61K
US-11407829-B2,A61K
US-11407829-B2,A61K
US-11382018-B2,H04W
US-11382018-B2,H04W
US-11382018-B2,H04W
US-11382018-B2,H04W
US-11382018-B2,H04W
US-11382760-B2,A61F
US-11382760-B2,A61F
US-11382760-B2,A61F
US-11446266-B2,A61K
US-11446266-B2,A61K
US-11446266-B2,A61K
US-11446266-B2,A61K
US-11446266-B2,A61K
US-11437978-B2,H04B
US-11378746-B2,G06F
US-11416699-B2,G06N
US-11435551-B2,H04N
US-11456419-B2,H01L
US-11456419-B2,H01L
US-11456419-B2,H01L
US-11379962-B2,H04N
US-11418602-B2,G06F
US-11422402-B2,G06F
US-11422402-B2,G06F
US-11422402-B2,G06F
US-11422402-B2,G06F
US-11401219-B2,B01J
US-11401219-B2,B01J
US-11401219-B2,B01J
US-11401219-B2,B01J
US-11401219-B2,B01J
US-11384177-B2,E21B
US-11384177-B2,E21B
US-11384177-B2,E21B
US-11418715-B2,G06F
US-11400006-B2,A61B
US-11407172-B2,B29C
US-11407172-B2,B29C
US-11407172-B2,B29C
US-11407172-B2,B29C
US-11410444-B2,G06F
US-11410444-B2,G06F
US-11410444-B2,G06F
US-11410444-B2,G06F
US-11376319-B2,A61K
US-11376319-B2,A61K
US-11374644-B2,H04W
US-11392816-B2,G06K
US-11376109-B2,A61F
US-11364337-B2,A61M
US-11364337-B2,A61M
US-11364337-B2,A61M
US-11364337-B2,A61M
US-11364337-B2,A61M
US-11364337-B2,A61M
US-11364337-B2,A61M
US-11412422-B2,H04L
US-11450645-B2,H01L
US-11450645-B2,H01L
US-11450645-B2,H01L
US-11450645-B2,H01L
US-11450645-B2,H01L
US-11363375-B2,G01S
US-11385163-B2,G01N
US-11449505-B2,G06F
US-11449505-B2,G06F
US-11389955-B2,G06F
US-11423539-B2,A61B
US-11422364-B2,G06T
US-11376718-B2,F04B
US-11421980-B2,G01S
US-11421980-B2,G01S
US-11413537-B2,G06F
US-11413537-B2,G06F
US-11360211-B2,G06V
US-11410365-B2,G06F
US-11410365-B2,G06F
US-11375912-B2,A61B
US-11398593-B2,H01L
US-11398593-B2,H01L
US-11398593-B2,H01L
US-11401923-B2,F04B
US-11420401-B2,B29C
US-11420401-B2,B29C
US-11354655-B2,G06F
US-11354655-B2,G06F
US-11449952-B2,G06F
US-11393841-B2,H01L
US-11393841-B2,H01L
US-11393841-B2,H01L
US-11438650-B2,H04N
US-11438650-B2,H04N
US-11438650-B2,H04N
US-11438650-B2,H04N
US-11444109-B2,H04N
US-11444109-B2,H04N
US-11444109-B2,H04N
US-11444109-B2,H04N
US-11438395-B2,H04N
US-11438395-B2,H04N
US-11438395-B2,H04N
US-11407574-B2,B65D
US-11455469-B2,G06F
US-11455469-B2,G06F
US-11455469-B2,G06F
US-11412960-B2,A61B
US-11412960-B2,A61B
US-11412960-B2,A61B
US-11412960-B2,A61B
US-11396158-B2,B32B
US-11396158-B2,B32B
US-11372255-B2,G06F
US-11372255-B2,G06F
US-11411015-B2,H01L
US-11411015-B2,H01L
US-11446383-B2,A61K
US-11446383-B2,A61K
US-11446383-B2,A61K
US-11446383-B2,A61K
US-11446383-B2,A61K
US-11434291-B2,A61K
US-11401234-B2,A61K
US-11401234-B2,A61K
US-11401234-B2,A61K
US-11450698-B2,H01L
US-11450698-B2,H01L
US-11450698-B2,H01L
US-11419647-B2,A61B
US-11419647-B2,A61B
US-11419647-B2,A61B
US-11419647-B2,A61B
US-11419647-B2,A61B
US-11386886-B2,G10L
US-11386886-B2,G10L
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11432574-B2,C12N
US-11351355-B2,A61M
US-11351355-B2,A61M
US-11351355-B2,A61M
US-11351355-B2,A61M
US-11351355-B2,A61M
US-11402589-B2,G02B
US-11402589-B2,G02B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11375403-B2,H04L
US-11386278-B2,H04B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11451603-B2,H04L
US-11451603-B2,H04L
US-11446260-B2,A61K
US-11446260-B2,A61K
US-11446260-B2,A61K
US-11446260-B2,A61K
US-11446260-B2,A61K
US-11446260-B2,A61K
US-11452433-B2,A61B
US-11452433-B2,A61B
US-11452433-B2,A61B
US-11439749-B2,A61M
US-11439749-B2,A61M
US-11439749-B2,A61M
US-11439749-B2,A61M
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11416022-B2,G06F
US-11416022-B2,G06F
US-11416001-B2,G06F
US-11416001-B2,G06F
US-11433084-B2,A61K
US-11433084-B2,A61K
US-11433084-B2,A61K
US-11406524-B2,A61F
US-11406524-B2,A61F
US-11436134-B2,G06F
US-11436134-B2,G06F
US-11436134-B2,G06F
US-11356221-B2,H04L
US-11356221-B2,H04L
US-11409969-B2,H04B
US-11375241-B2,H04N
US-11375241-B2,H04N
US-11375241-B2,H04N
US-11375241-B2,H04N
US-11438668-B2,H04N
US-11438668-B2,H04N
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11436431-B2,G06V
US-11436431-B2,G06V
US-11417842-B2,C08F
US-11417842-B2,C08F
US-11445622-B2,G06F
US-11379973-B2,G06T
US-11379973-B2,G06T
US-11424884-B2,H04L
US-11408811-B2,E21B
US-11408811-B2,E21B
US-11416109-B2,G06F
US-11416109-B2,G06F
US-11416109-B2,G06F
US-11454603-B2,G01N
US-11454603-B2,G01N
US-11454603-B2,G01N
US-11367437-B2,G10L
US-11367437-B2,G10L
US-11367437-B2,G10L
US-11367437-B2,G10L
US-11360542-B2,G06F
US-11360542-B2,G06F
US-11422371-B2,H04N
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11386539-B2,H01L
US-11436736-B2,G06T
US-11436736-B2,G06T
US-11387213-B2,H01L
US-11387213-B2,H01L
US-11387213-B2,H01L
US-11387213-B2,H01L
US-11431960-B2,H04N
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11443228-B2,G06N
US-11385961-B2,G06F
US-11385961-B2,G06F
US-11385961-B2,G06F
US-11385961-B2,G06F
US-11363222-B2,H04N
US-11363222-B2,H04N
US-11363222-B2,H04N
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11423376-B2,G06F
US-11399950-B2,A61F
US-11399950-B2,A61F
US-11433630-B2,G02B
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11434270-B2,A61K
US-11434270-B2,A61K
US-11384000-B2,G06F
US-11369714-B2,C12N
US-11448742-B2,G01S
US-11448742-B2,G01S
US-11448742-B2,G01S
US-11448742-B2,G01S
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11410148-B2,H04L
US-11373280-B2,G06T
US-11373280-B2,G06T
US-11404307-B2,H01L
US-11404307-B2,H01L
US-11404307-B2,H01L
US-11404307-B2,H01L
US-11375479-B2,H04W
US-11375479-B2,H04W
US-11375479-B2,H04W
US-11353839-B2,H05B
US-11353839-B2,H05B
US-11353839-B2,H05B
US-11353839-B2,H05B
US-11353839-B2,H05B
US-11353839-B2,H05B
US-11435444-B2,G01S
US-11435444-B2,G01S
US-11435444-B2,G01S
US-11365041-B2,B65D
US-11365041-B2,B65D
US-11365041-B2,B65D
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11397326-B2,G02B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11397228-B2,H04N
US-11372388-B2,G05B
US-11372388-B2,G05B
US-11439554-B2,A61B
US-11374640-B2,H04L
US-11455459-B2,G06F
US-11455459-B2,G06F
US-11455459-B2,G06F
US-11455459-B2,G06F
US-11455459-B2,G06F
US-11365729-B2,F04B
US-11365729-B2,F04B
US-11453193-B2,G06F
US-11430204-B2,H04N
US-11386741-B2,G06T
US-11386741-B2,G06T
US-11354278-B2,G06F
US-11354278-B2,G06F
US-11354278-B2,G06F
US-11408566-B2,E21B
US-11408566-B2,E21B
US-11408566-B2,E21B
US-11408566-B2,E21B
US-11432771-B2,A61B
US-11432771-B2,A61B
US-11432771-B2,A61B
US-11432771-B2,A61B
US-11432771-B2,A61B
US-11376070-B2,A61B
US-11376070-B2,A61B
US-11376070-B2,A61B
US-11376070-B2,A61B
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11442764-B2,G06F
US-11442764-B2,G06F
US-11442764-B2,G06F
US-11442764-B2,G06F
US-11440275-B2,B29C
US-11440275-B2,B29C
US-11440275-B2,B29C
US-11440275-B2,B29C
US-11440275-B2,B29C
US-11392814-B2,G06N
US-11392814-B2,G06N
US-11445941-B2,A61B
US-11445941-B2,A61B
US-11445941-B2,A61B
US-11445941-B2,A61B
US-11445941-B2,A61B
US-11445941-B2,A61B
US-11422523-B2,G05B
US-11421011-B2,A61K
US-11421011-B2,A61K
US-11453892-B2,C12N
US-11453892-B2,C12N
US-11453892-B2,C12N
US-11453892-B2,C12N
US-11453892-B2,C12N
US-11453892-B2,C12N
US-11453892-B2,C12N
US-11363536-B2,H04W
US-11363536-B2,H04W
US-11363536-B2,H04W
US-11363536-B2,H04W
US-11441084-B2,B01J
US-11441084-B2,B01J
US-11441084-B2,B01J
US-11441084-B2,B01J
US-11441084-B2,B01J
US-11441084-B2,B01J
US-11441084-B2,B01J
US-11423146-B2,G06F
US-11423146-B2,G06F
US-11423146-B2,G06F
US-11394671-B2,H04L
US-11394671-B2,H04L
US-11394671-B2,H04L
US-11393239-B2,G06V
US-11368762-B2,H04N
US-11368762-B2,H04N
US-11353321-B2,G01B
US-11353321-B2,G01B
US-11388258-B2,G06F
US-11388258-B2,G06F
US-11382705-B2,A61B
US-11382705-B2,A61B
US-11382705-B2,A61B
US-11382705-B2,A61B
US-11412974-B2,A61B
US-11412974-B2,A61B
US-11412974-B2,A61B
US-11412974-B2,A61B
US-11398087-B2,G06T
US-11384463-B2,G06V
US-11354261-B2,G06F
US-11354261-B2,G06F
US-11354261-B2,G06F
US-11406832-B2,G16H
US-11453169-B2,B29C
US-11428911-B2,G02B
US-11428911-B2,G02B
US-11428911-B2,G02B
US-11428911-B2,G02B
US-11405208-B2,H04L
US-11405208-B2,H04L
US-11405208-B2,H04L
US-11451557-B2,H04L
US-11409410-B2,G06F
US-11409410-B2,G06F
US-11409410-B2,G06F
US-11409410-B2,G06F
US-11409410-B2,G06F
US-11409410-B2,G06F


2025-01-26 09:39:26 - root - INFO - Please check the answer again by reviewing For United States utility patents under the B2 classification granted between June and September of 2022, identify the most frequent 4-digit IPC code for each patent. Then, list the publication numbers and IPC4 codes of patents where this code appears 10 or more times., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
publication_number,ipc4
publication_number1:str,ipc4_code1:str
publication_number2:str,ipc4_code2:str
...
```

We analyzed United States utility patents under the B2 classification granted between June and September of 2022. For each patent, we identified the most frequent 4-digit IPC code (ipc4). We then listed the publication numbers and ipc4 codes of patents where this ipc4 code appears in 10 or more patents. The table above shows the `publication_number` and the corresponding `ipc4` code for each such patent. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Too long, hard cut:
publication_number,ipc4
US-11441406-B2,E21B
US-11444995-B2,G06F
US-11450326-B2,G06V
US-11451086-B2,G05B
US-11447750-B2,A61B
US-11447750-B2,A61B
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11440728-B2,B65D
US-11440728-B2,B65D
US-11440728-B2,B65D
US-11440728-B2,B65D
US-11375590-B2,H05B
US-11375590-B2,H05B
US-11381650-B2,H04L
US-11381650-B2,H04L
US-11381650-B2,H04L
US-11392648-B2,G06F
US-11392648-B2,G06F
US-11392648-B2,G06F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11419318-B2,A61K
US-11405983-B2,H05B
US-11405983-B2,H05B
US-11429930-B2,G06F
US-11429930-B2,G06F
US-11407174-B2,B29C
US-11407174-B2,B29C
US-11449524-B2,G06F
US-11449524-B2,G06F
US-11389834-B2,G05B
US-11380566-B2,H01L
US-11380566-B2,H01L
US-11381283-B2,H04W
US-11381283-B2,H04W
US-11388673-B2,H04W
US-11388673-B2,H04W
US-11388673-B2,H04W
US-11388673-B2,H04W
US-11388673-B2,H04W
US-11388673-B2,H04W
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11373404-B2,G06F
US-11368189-B2,G06F
US-11400138-B2,A61K
US-11400138-B2,A61K
US-11400138-B2,A61K
US-11375960-B2,A61B
US-11375960-B2,A61B
US-11375960-B2,A61B
US-11375960-B2,A61B
US-11374186-B2,H01L
US-11443406-B2,G06F
US-11443406-B2,G06F
US-11379726-B2,G06N
US-11379726-B2,G06N
US-11379726-B2,G06N
US-11390055-B2,B32B
US-11434426-B2,G02F
US-11430084-B2,G06F
US-11453749-B2,G01N
US-11374026-B2,H01L
US-11378383-B2,G06F
US-11378383-B2,G06F
US-11456776-B2,H04L
US-11456776-B2,H04L
US-11456776-B2,H04L
US-11445494-B2,H04W
US-11445494-B2,H04W
US-11445494-B2,H04W
US-11445494-B2,H04W
US-11453654-B2,G02B
US-11397148-B2,G01N
US-11374056-B2,H01L
US-11374056-B2,H01L
US-11374056-B2,H01L
US-11407829-B2,A61K
US-11407829-B2,A61K
US-11407829-B2,A61K
US-11407829-B2,A61K
US-11407829-B2,A61K
US-11382018-B2,H04W
US-11382018-B2,H04W
US-11382018-B2,H04W
US-11382018-B2,H04W
US-11382018-B2,H04W
US-11382760-B2,A61F
US-11382760-B2,A61F
US-11382760-B2,A61F
US-11446266-B2,A61K
US-11446266-B2,A61K
US-11446266-B2,A61K
US-11446266-B2,A61K
US-11446266-B2,A61K
US-11437978-B2,H04B
US-11378746-B2,G06F
US-11416699-B2,G06N
US-11435551-B2,H04N
US-11456419-B2,H01L
US-11456419-B2,H01L
US-11456419-B2,H01L
US-11379962-B2,H04N
US-11418602-B2,G06F
US-11422402-B2,G06F
US-11422402-B2,G06F
US-11422402-B2,G06F
US-11422402-B2,G06F
US-11401219-B2,B01J
US-11401219-B2,B01J
US-11401219-B2,B01J
US-11401219-B2,B01J
US-11401219-B2,B01J
US-11384177-B2,E21B
US-11384177-B2,E21B
US-11384177-B2,E21B
US-11418715-B2,G06F
US-11400006-B2,A61B
US-11407172-B2,B29C
US-11407172-B2,B29C
US-11407172-B2,B29C
US-11407172-B2,B29C
US-11410444-B2,G06F
US-11410444-B2,G06F
US-11410444-B2,G06F
US-11410444-B2,G06F
US-11376319-B2,A61K
US-11376319-B2,A61K
US-11374644-B2,H04W
US-11392816-B2,G06K
US-11376109-B2,A61F
US-11364337-B2,A61M
US-11364337-B2,A61M
US-11364337-B2,A61M
US-11364337-B2,A61M
US-11364337-B2,A61M
US-11364337-B2,A61M
US-11364337-B2,A61M
US-11412422-B2,H04L
US-11450645-B2,H01L
US-11450645-B2,H01L
US-11450645-B2,H01L
US-11450645-B2,H01L
US-11450645-B2,H01L
US-11363375-B2,G01S
US-11385163-B2,G01N
US-11449505-B2,G06F
US-11449505-B2,G06F
US-11389955-B2,G06F
US-11423539-B2,A61B
US-11422364-B2,G06T
US-11376718-B2,F04B
US-11421980-B2,G01S
US-11421980-B2,G01S
US-11413537-B2,G06F
US-11413537-B2,G06F
US-11360211-B2,G06V
US-11410365-B2,G06F
US-11410365-B2,G06F
US-11375912-B2,A61B
US-11398593-B2,H01L
US-11398593-B2,H01L
US-11398593-B2,H01L
US-11401923-B2,F04B
US-11420401-B2,B29C
US-11420401-B2,B29C
US-11354655-B2,G06F
US-11354655-B2,G06F
US-11449952-B2,G06F
US-11393841-B2,H01L
US-11393841-B2,H01L
US-11393841-B2,H01L
US-11438650-B2,H04N
US-11438650-B2,H04N
US-11438650-B2,H04N
US-11438650-B2,H04N
US-11444109-B2,H04N
US-11444109-B2,H04N
US-11444109-B2,H04N
US-11444109-B2,H04N
US-11438395-B2,H04N
US-11438395-B2,H04N
US-11438395-B2,H04N
US-11407574-B2,B65D
US-11455469-B2,G06F
US-11455469-B2,G06F
US-11455469-B2,G06F
US-11412960-B2,A61B
US-11412960-B2,A61B
US-11412960-B2,A61B
US-11412960-B2,A61B
US-11396158-B2,B32B
US-11396158-B2,B32B
US-11372255-B2,G06F
US-11372255-B2,G06F
US-11411015-B2,H01L
US-11411015-B2,H01L
US-11446383-B2,A61K
US-11446383-B2,A61K
US-11446383-B2,A61K
US-11446383-B2,A61K
US-11446383-B2,A61K
US-11434291-B2,A61K
US-11401234-B2,A61K
US-11401234-B2,A61K
US-11401234-B2,A61K
US-11450698-B2,H01L
US-11450698-B2,H01L
US-11450698-B2,H01L
US-11419647-B2,A61B
US-11419647-B2,A61B
US-11419647-B2,A61B
US-11419647-B2,A61B
US-11419647-B2,A61B
US-11386886-B2,G10L
US-11386886-B2,G10L
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11432574-B2,C12N
US-11351355-B2,A61M
US-11351355-B2,A61M
US-11351355-B2,A61M
US-11351355-B2,A61M
US-11351355-B2,A61M
US-11402589-B2,G02B
US-11402589-B2,G02B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11375403-B2,H04L
US-11386278-B2,H04B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11451603-B2,H04L
US-11451603-B2,H04L
US-11446260-B2,A61K
US-11446260-B2,A61K
US-11446260-B2,A61K
US-11446260-B2,A61K
US-11446260-B2,A61K
US-11446260-B2,A61K
US-11452433-B2,A61B
US-11452433-B2,A61B
US-11452433-B2,A61B
US-11439749-B2,A61M
US-11439749-B2,A61M
US-11439749-B2,A61M
US-11439749-B2,A61M
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11416022-B2,G06F
US-11416022-B2,G06F
US-11416001-B2,G06F
US-11416001-B2,G06F
US-11433084-B2,A61K
US-11433084-B2,A61K
US-11433084-B2,A61K
US-11406524-B2,A61F
US-11406524-B2,A61F
US-11436134-B2,G06F
US-11436134-B2,G06F
US-11436134-B2,G06F
US-11356221-B2,H04L
US-11356221-B2,H04L
US-11409969-B2,H04B
US-11375241-B2,H04N
US-11375241-B2,H04N
US-11375241-B2,H04N
US-11375241-B2,H04N
US-11438668-B2,H04N
US-11438668-B2,H04N
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11436431-B2,G06V
US-11436431-B2,G06V
US-11417842-B2,C08F
US-11417842-B2,C08F
US-11445622-B2,G06F
US-11379973-B2,G06T
US-11379973-B2,G06T
US-11424884-B2,H04L
US-11408811-B2,E21B
US-11408811-B2,E21B
US-11416109-B2,G06F
US-11416109-B2,G06F
US-11416109-B2,G06F
US-11454603-B2,G01N
US-11454603-B2,G01N
US-11454603-B2,G01N
US-11367437-B2,G10L
US-11367437-B2,G10L
US-11367437-B2,G10L
US-11367437-B2,G10L
US-11360542-B2,G06F
US-11360542-B2,G06F
US-11422371-B2,H04N
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11386539-B2,H01L
US-11436736-B2,G06T
US-11436736-B2,G06T
US-11387213-B2,H01L
US-11387213-B2,H01L
US-11387213-B2,H01L
US-11387213-B2,H01L
US-11431960-B2,H04N
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11443228-B2,G06N
US-11385961-B2,G06F
US-11385961-B2,G06F
US-11385961-B2,G06F
US-11385961-B2,G06F
US-11363222-B2,H04N
US-11363222-B2,H04N
US-11363222-B2,H04N
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11423376-B2,G06F
US-11399950-B2,A61F
US-11399950-B2,A61F
US-11433630-B2,G02B
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11434270-B2,A61K
US-11434270-B2,A61K
US-11384000-B2,G06F
US-11369714-B2,C12N
US-11448742-B2,G01S
US-11448742-B2,G01S
US-11448742-B2,G01S
US-11448742-B2,G01S
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11410148-B2,H04L
US-11373280-B2,G06T
US-11373280-B2,G06T
US-11404307-B2,H01L
US-11404307-B2,H01L
US-11404307-B2,H01L
US-11404307-B2,H01L
US-11375479-B2,H04W
US-11375479-B2,H04W
US-11375479-B2,H04W
US-11353839-B2,H05B
US-11353839-B2,H05B
US-11353839-B2,H05B
US-11353839-B2,H05B
US-11353839-B2,H05B
US-11353839-B2,H05B
US-11435444-B2,G01S
US-11435444-B2,G01S
US-11435444-B2,G01S
US-11365041-B2,B65D
US-11365041-B2,B65D
US-11365041-B2,B65D
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11397326-B2,G02B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11397228-B2,H04N
US-11372388-B2,G05B
US-11372388-B2,G05B
US-11439554-B2,A61B
US-11374640-B2,H04L
US-11455459-B2,G06F
US-11455459-B2,G06F
US-11455459-B2,G06F
US-11455459-B2,G
Current sql:
WITH code_counts AS (
    SELECT
        SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
        COUNT(*) AS "code_count"
    FROM
        PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE
        t."country_code" = 'US'
        AND t."kind_code" = 'B2'
        AND t."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY
        "ipc4_code"
    HAVING
        COUNT(*) >= 10
),
ipc_codes AS (
    SELECT
        t."publication_number",
        SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
    FROM
        PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE
        t."country_code" = 'US'
        AND t."kind_code" = 'B2'
        AND t."grant_date" BETWEEN 20220601 AND 20220930
),
filtered_ipc_codes AS (
    SELECT
        ipc_codes."publication_number",
        ipc_codes."ipc4_code"
    FROM
        ipc_codes
    INNER JOIN
        code_counts ON ipc_codes."ipc4_code" = code_counts."ipc4_code"
),
ranked_ipc AS (
    SELECT
        fic."publication_number",
        fic."ipc4_code",
        DENSE_RANK() OVER (PARTITION BY fic."publication_number" ORDER BY code_counts."code_count" DESC) AS "rank"
    FROM
        filtered_ipc_codes fic
    INNER JOIN
        code_counts ON fic."ipc4_code" = code_counts."ipc4_code"
)
SELECT
    "publication_number",
    "ipc4_code" AS "ipc4"
FROM
    ranked_ipc
WHERE
    "rank" = 1When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-26 09:40:19 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 09:40:19 - root - INFO - ```sql
WITH code_counts AS (
    SELECT
        SUBSTRING(ipc_u2.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
        COUNT(*) AS "code_count"
    FROM
        PATENTS.PATENTS.PUBLICATIONS t2,
        LATERAL FLATTEN(input => t2."ipc") ipc_u2
    WHERE
        t2."country_code" = 'US'
        AND t2."kind_code" = 'B2'
        AND t2."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY
        "ipc4_code"
    HAVING
        COUNT(*) >= 10
),
ipc_codes AS (
    SELECT
        t."publication_number",
        SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
    FROM
        PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE
        t."country_code" = 'US'
        AND t."kind_code" = 'B2'
        AND t."grant_date" BETWEEN 20220601 AND 20220930
),
ranked_ipc AS (
    SELECT
        ic."publication_number",
        ic."ipc4_code",
        DENSE_RANK() OVER (
            PARTITION BY ic."publication_number"
            ORDER BY cc."code_count" DESC NULLS LAST
        ) AS "rank"
    FROM
        ipc_codes ic
    INNER JOIN
        code_counts cc ON ic."ipc4_code" = cc."ipc4_code"
)
SELECT
    "publication_number",
    "ipc4_code" AS "ipc4"
FROM
    ranked_ipc
WHERE
    "rank" = 1
```
2025-01-26 09:40:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:40:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:40:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:40:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 611
2025-01-26 09:40:20 - snowflake.connector.connection - INFO - closed
2025-01-26 09:40:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:40:21 - root - INFO - itercount: 2
2025-01-26 09:40:21 - root - INFO - 0
2025-01-26 09:40:21 - root - INFO - results: 
publication_number,ipc4
US-11444995-B2,G06F
US-11441406-B2,E21B
US-11450326-B2,G06V
US-11447750-B2,A61B
US-11447750-B2,A61B
US-11375590-B2,H05B
US-11375590-B2,H05B
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11440728-B2,B65D
US-11440728-B2,B65D
US-11440728-B2,B65D
US-11440728-B2,B65D
US-11451086-B2,G05B
US-11381650-B2,H04L
US-11381650-B2,H04L
US-11381650-B2,H04L
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11392648-B2,G06F
US-11392648-B2,G06F
US-11392648-B2,G06F
US-11419318-B2,A61K
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11429930-B2,G06F
US-11429930-B2,G06F
US-11405983-B2,H05B
US-11405983-B2,H05B
US-11389834-B2,G05B
US-11407174-B2,B29C
US-11407174-B2,B29C
US-11449524-B2,G06F
US-11449524-B2,G06F
US-11380566-B2,H01L
US-11380566-B2,H01L
US-11388673-B2,H04W
US-11388673-B2,H04W
US-11388673-B2,H04W
US-11388673-B2,H04W
US-11388673-B2,H04W
US-11388673-B2,H04W
US-11381283-B2,H04W
US-11381283-B2,H04W
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11368189-B2,G06F
US-11374186-B2,H01L
US-11373404-B2,G06F
US-11400138-B2,A61K
US-11400138-B2,A61K
US-11400138-B2,A61K
US-11375960-B2,A61B
US-11375960-B2,A61B
US-11375960-B2,A61B
US-11375960-B2,A61B
US-11390055-B2,B32B
US-11443406-B2,G06F
US-11443406-B2,G06F
US-11379726-B2,G06N
US-11379726-B2,G06N
US-11379726-B2,G06N
US-11434426-B2,G02F
US-11374026-B2,H01L
US-11453749-B2,G01N
US-11430084-B2,G06F
US-11445494-B2,H04W
US-11445494-B2,H04W
US-11445494-B2,H04W
US-11445494-B2,H04W
US-11378383-B2,G06F
US-11378383-B2,G06F
US-11453654-B2,G02B
US-11456776-B2,H04L
US-11456776-B2,H04L
US-11456776-B2,H04L
US-11382760-B2,A61F
US-11382760-B2,A61F
US-11382760-B2,A61F
US-11446266-B2,A61K
US-11446266-B2,A61K
US-11446266-B2,A61K
US-11446266-B2,A61K
US-11446266-B2,A61K
US-11437978-B2,H04B
US-11397148-B2,G01N
US-11407829-B2,A61K
US-11407829-B2,A61K
US-11407829-B2,A61K
US-11407829-B2,A61K
US-11407829-B2,A61K
US-11374056-B2,H01L
US-11374056-B2,H01L
US-11374056-B2,H01L
US-11382018-B2,H04W
US-11382018-B2,H04W
US-11382018-B2,H04W
US-11382018-B2,H04W
US-11382018-B2,H04W
US-11378746-B2,G06F
US-11416699-B2,G06N
US-11435551-B2,H04N
US-11379962-B2,H04N
US-11456419-B2,H01L
US-11456419-B2,H01L
US-11456419-B2,H01L
US-11422402-B2,G06F
US-11422402-B2,G06F
US-11422402-B2,G06F
US-11422402-B2,G06F
US-11384177-B2,E21B
US-11384177-B2,E21B
US-11384177-B2,E21B
US-11418715-B2,G06F
US-11401219-B2,B01J
US-11401219-B2,B01J
US-11401219-B2,B01J
US-11401219-B2,B01J
US-11401219-B2,B01J
US-11407172-B2,B29C
US-11407172-B2,B29C
US-11407172-B2,B29C
US-11407172-B2,B29C
US-11418602-B2,G06F
US-11400006-B2,A61B
US-11376319-B2,A61K
US-11376319-B2,A61K
US-11410444-B2,G06F
US-11410444-B2,G06F
US-11410444-B2,G06F
US-11410444-B2,G06F
US-11392816-B2,G06K
US-11374644-B2,H04W
US-11376109-B2,A61F
US-11412422-B2,H04L
US-11364337-B2,A61M
US-11364337-B2,A61M
US-11364337-B2,A61M
US-11364337-B2,A61M
US-11364337-B2,A61M
US-11364337-B2,A61M
US-11364337-B2,A61M
US-11450645-B2,H01L
US-11450645-B2,H01L
US-11450645-B2,H01L
US-11450645-B2,H01L
US-11450645-B2,H01L
US-11385163-B2,G01N
US-11363375-B2,G01S
US-11422364-B2,G06T
US-11389955-B2,G06F
US-11449505-B2,G06F
US-11449505-B2,G06F
US-11376718-B2,F04B
US-11413537-B2,G06F
US-11413537-B2,G06F
US-11423539-B2,A61B
US-11421980-B2,G01S
US-11421980-B2,G01S
US-11401923-B2,F04B
US-11410365-B2,G06F
US-11410365-B2,G06F
US-11360211-B2,G06V
US-11375912-B2,A61B
US-11398593-B2,H01L
US-11398593-B2,H01L
US-11398593-B2,H01L
US-11420401-B2,B29C
US-11420401-B2,B29C
US-11354655-B2,G06F
US-11354655-B2,G06F
US-11449952-B2,G06F
US-11438650-B2,H04N
US-11438650-B2,H04N
US-11438650-B2,H04N
US-11438650-B2,H04N
US-11393841-B2,H01L
US-11393841-B2,H01L
US-11393841-B2,H01L
US-11412960-B2,A61B
US-11412960-B2,A61B
US-11412960-B2,A61B
US-11412960-B2,A61B
US-11444109-B2,H04N
US-11444109-B2,H04N
US-11444109-B2,H04N
US-11444109-B2,H04N
US-11455469-B2,G06F
US-11455469-B2,G06F
US-11455469-B2,G06F
US-11438395-B2,H04N
US-11438395-B2,H04N
US-11438395-B2,H04N
US-11407574-B2,B65D
US-11396158-B2,B32B
US-11396158-B2,B32B
US-11446383-B2,A61K
US-11446383-B2,A61K
US-11446383-B2,A61K
US-11446383-B2,A61K
US-11446383-B2,A61K
US-11411015-B2,H01L
US-11411015-B2,H01L
US-11372255-B2,G06F
US-11372255-B2,G06F
US-11450698-B2,H01L
US-11450698-B2,H01L
US-11450698-B2,H01L
US-11434291-B2,A61K
US-11419647-B2,A61B
US-11419647-B2,A61B
US-11419647-B2,A61B
US-11419647-B2,A61B
US-11419647-B2,A61B
US-11401234-B2,A61K
US-11401234-B2,A61K
US-11401234-B2,A61K
US-11351355-B2,A61M
US-11351355-B2,A61M
US-11351355-B2,A61M
US-11351355-B2,A61M
US-11351355-B2,A61M
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11386886-B2,G10L
US-11386886-B2,G10L
US-11432574-B2,C12N
US-11375403-B2,H04L
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11386278-B2,H04B
US-11402589-B2,G02B
US-11402589-B2,G02B
US-11451603-B2,H04L
US-11451603-B2,H04L
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11452433-B2,A61B
US-11452433-B2,A61B
US-11452433-B2,A61B
US-11446260-B2,A61K
US-11446260-B2,A61K
US-11446260-B2,A61K
US-11446260-B2,A61K
US-11446260-B2,A61K
US-11446260-B2,A61K
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11439749-B2,A61M
US-11439749-B2,A61M
US-11439749-B2,A61M
US-11439749-B2,A61M
US-11416022-B2,G06F
US-11416022-B2,G06F
US-11433084-B2,A61K
US-11433084-B2,A61K
US-11433084-B2,A61K
US-11406524-B2,A61F
US-11406524-B2,A61F
US-11416001-B2,G06F
US-11416001-B2,G06F
US-11356221-B2,H04L
US-11356221-B2,H04L
US-11436134-B2,G06F
US-11436134-B2,G06F
US-11436134-B2,G06F
US-11409969-B2,H04B
US-11375241-B2,H04N
US-11375241-B2,H04N
US-11375241-B2,H04N
US-11375241-B2,H04N
US-11438668-B2,H04N
US-11438668-B2,H04N
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11436431-B2,G06V
US-11436431-B2,G06V
US-11445622-B2,G06F
US-11417842-B2,C08F
US-11417842-B2,C08F
US-11424884-B2,H04L
US-11379973-B2,G06T
US-11379973-B2,G06T
US-11408811-B2,E21B
US-11408811-B2,E21B
US-11454603-B2,G01N
US-11454603-B2,G01N
US-11454603-B2,G01N
US-11416109-B2,G06F
US-11416109-B2,G06F
US-11416109-B2,G06F
US-11367437-B2,G10L
US-11367437-B2,G10L
US-11367437-B2,G10L
US-11367437-B2,G10L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11386539-B2,H01L
US-11422371-B2,H04N
US-11360542-B2,G06F
US-11360542-B2,G06F
US-11436736-B2,G06T
US-11436736-B2,G06T
US-11387213-B2,H01L
US-11387213-B2,H01L
US-11387213-B2,H01L
US-11387213-B2,H01L
US-11443228-B2,G06N
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11431960-B2,H04N
US-11363222-B2,H04N
US-11363222-B2,H04N
US-11363222-B2,H04N
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11385961-B2,G06F
US-11385961-B2,G06F
US-11385961-B2,G06F
US-11385961-B2,G06F
US-11433630-B2,G02B
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11423376-B2,G06F
US-11399950-B2,A61F
US-11399950-B2,A61F
US-11384000-B2,G06F
US-11434270-B2,A61K
US-11434270-B2,A61K
US-11369714-B2,C12N
US-11448742-B2,G01S
US-11448742-B2,G01S
US-11448742-B2,G01S
US-11448742-B2,G01S
US-11410148-B2,H04L
US-11373280-B2,G06T
US-11373280-B2,G06T
US-11404307-B2,H01L
US-11404307-B2,H01L
US-11404307-B2,H01L
US-11404307-B2,H01L
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11375479-B2,H04W
US-11375479-B2,H04W
US-11375479-B2,H04W
US-11353839-B2,H05B
US-11353839-B2,H05B
US-11353839-B2,H05B
US-11353839-B2,H05B
US-11353839-B2,H05B
US-11353839-B2,H05B
US-11435444-B2,G01S
US-11435444-B2,G01S
US-11435444-B2,G01S
US-11365041-B2,B65D
US-11365041-B2,B65D
US-11365041-B2,B65D
US-11397326-B2,G02B
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11374640-B2,H04L
US-11397228-B2,H04N
US-11439554-B2,A61B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11372388-B2,G05B
US-11372388-B2,G05B
US-11455459-B2,G06F
US-11455459-B2,G06F
US-11455459-B2,G06F
US-11455459-B2,G06F
US-11455459-B2,G06F
US-11365729-B2,F04B
US-11365729-B2,F04B
US-11430204-B2,H04N
US-11453193-B2,G06F
US-11386741-B2,G06T
US-11386741-B2,G06T
US-11408566-B2,E21B
US-11408566-B2,E21B
US-11408566-B2,E21B
US-11408566-B2,E21B
US-11354278-B2,G06F
US-11354278-B2,G06F
US-11354278-B2,G06F
US-11432771-B2,A61B
US-11432771-B2,A61B
US-11432771-B2,A61B
US-11432771-B2,A61B
US-11432771-B2,A61B
US-11376070-B2,A61B
US-11376070-B2,A61B
US-11376070-B2,A61B
US-11376070-B2,A61B
US-11442764-B2,G06F
US-11442764-B2,G06F
US-11442764-B2,G06F
US-11442764-B2,G06F
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11382847-B2,A61K
US-11392814-B2,G06N
US-11392814-B2,G06N
US-11440275-B2,B29C
US-11440275-B2,B29C
US-11440275-B2,B29C
US-11440275-B2,B29C
US-11440275-B2,B29C
US-11422523-B2,G05B
US-11445941-B2,A61B
US-11445941-B2,A61B
US-11445941-B2,A61B
US-11445941-B2,A61B
US-11445941-B2,A61B
US-11445941-B2,A61B
US-11421011-B2,A61K
US-11421011-B2,A61K
US-11453892-B2,C12N
US-11453892-B2,C12N
US-11453892-B2,C12N
US-11453892-B2,C12N
US-11453892-B2,C12N
US-11453892-B2,C12N
US-11453892-B2,C12N
US-11441084-B2,B01J
US-11441084-B2,B01J
US-11441084-B2,B01J
US-11441084-B2,B01J
US-11441084-B2,B01J
US-11441084-B2,B01J
US-11441084-B2,B01J
US-11368762-B2,H04N
US-11368762-B2,H04N
US-11393239-B2,G06V
US-11353321-B2,G01B
US-11353321-B2,G01B
US-11363536-B2,H04W
US-11363536-B2,H04W
US-11363536-B2,H04W
US-11363536-B2,H04W
US-11394671-B2,H04L
US-11394671-B2,H04L
US-11394671-B2,H04L
US-11423146-B2,G06F
US-11423146-B2,G06F
US-11423146-B2,G06F
US-11388258-B2,G06F
US-11388258-B2,G06F
US-11382705-B2,A61B
US-11382705-B2,A61B
US-11382705-B2,A61B
US-11382705-B2,A61B
US-11384463-B2,G06V
US-11398087-B2,G06T
US-11412974-B2,A61B
US-11412974-B2,A61B
US-11412974-B2,A61B
US-11412974-B2,A61B
US-11354261-B2,G06F
US-11354261-B2,G06F
US-11354261-B2,G06F
US-11406832-B2,G16H
US-11453169-B2,B29C
US-11405208-B2,H04L
US-11405208-B2,H04L
US-11405208-B2,H04L
US-11428911-B2,G02B
US-11428911-B2,G02B
US-11428911-B2,G02B
US-11428911-B2,G02B
US-11451557-B2,H04L
US-11409410-B2,G06F
US-11409410-B2,G06F
US-11409410-B2,G06F
US-11409410-B2,G06F
US-11409410-B2,G06F
US-11409410-B2,G06F


2025-01-26 09:40:21 - root - INFO - Please check the answer again by reviewing For United States utility patents under the B2 classification granted between June and September of 2022, identify the most frequent 4-digit IPC code for each patent. Then, list the publication numbers and IPC4 codes of patents where this code appears 10 or more times., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
publication_number,ipc4
publication_number1:str,ipc4_code1:str
publication_number2:str,ipc4_code2:str
...
```

We analyzed United States utility patents under the B2 classification granted between June and September of 2022. For each patent, we identified the most frequent 4-digit IPC code (ipc4). We then listed the publication numbers and ipc4 codes of patents where this ipc4 code appears in 10 or more patents. The table above shows the `publication_number` and the corresponding `ipc4` code for each such patent. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Too long, hard cut:
publication_number,ipc4
US-11444995-B2,G06F
US-11441406-B2,E21B
US-11450326-B2,G06V
US-11447750-B2,A61B
US-11447750-B2,A61B
US-11375590-B2,H05B
US-11375590-B2,H05B
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11393967-B2,H01L
US-11440728-B2,B65D
US-11440728-B2,B65D
US-11440728-B2,B65D
US-11440728-B2,B65D
US-11451086-B2,G05B
US-11381650-B2,H04L
US-11381650-B2,H04L
US-11381650-B2,H04L
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11450090-B2,G06F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11351045-B2,A61F
US-11392648-B2,G06F
US-11392648-B2,G06F
US-11392648-B2,G06F
US-11419318-B2,A61K
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11446908-B2,B32B
US-11429930-B2,G06F
US-11429930-B2,G06F
US-11405983-B2,H05B
US-11405983-B2,H05B
US-11389834-B2,G05B
US-11407174-B2,B29C
US-11407174-B2,B29C
US-11449524-B2,G06F
US-11449524-B2,G06F
US-11380566-B2,H01L
US-11380566-B2,H01L
US-11388673-B2,H04W
US-11388673-B2,H04W
US-11388673-B2,H04W
US-11388673-B2,H04W
US-11388673-B2,H04W
US-11388673-B2,H04W
US-11381283-B2,H04W
US-11381283-B2,H04W
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11426701-B2,B29C
US-11368189-B2,G06F
US-11374186-B2,H01L
US-11373404-B2,G06F
US-11400138-B2,A61K
US-11400138-B2,A61K
US-11400138-B2,A61K
US-11375960-B2,A61B
US-11375960-B2,A61B
US-11375960-B2,A61B
US-11375960-B2,A61B
US-11390055-B2,B32B
US-11443406-B2,G06F
US-11443406-B2,G06F
US-11379726-B2,G06N
US-11379726-B2,G06N
US-11379726-B2,G06N
US-11434426-B2,G02F
US-11374026-B2,H01L
US-11453749-B2,G01N
US-11430084-B2,G06F
US-11445494-B2,H04W
US-11445494-B2,H04W
US-11445494-B2,H04W
US-11445494-B2,H04W
US-11378383-B2,G06F
US-11378383-B2,G06F
US-11453654-B2,G02B
US-11456776-B2,H04L
US-11456776-B2,H04L
US-11456776-B2,H04L
US-11382760-B2,A61F
US-11382760-B2,A61F
US-11382760-B2,A61F
US-11446266-B2,A61K
US-11446266-B2,A61K
US-11446266-B2,A61K
US-11446266-B2,A61K
US-11446266-B2,A61K
US-11437978-B2,H04B
US-11397148-B2,G01N
US-11407829-B2,A61K
US-11407829-B2,A61K
US-11407829-B2,A61K
US-11407829-B2,A61K
US-11407829-B2,A61K
US-11374056-B2,H01L
US-11374056-B2,H01L
US-11374056-B2,H01L
US-11382018-B2,H04W
US-11382018-B2,H04W
US-11382018-B2,H04W
US-11382018-B2,H04W
US-11382018-B2,H04W
US-11378746-B2,G06F
US-11416699-B2,G06N
US-11435551-B2,H04N
US-11379962-B2,H04N
US-11456419-B2,H01L
US-11456419-B2,H01L
US-11456419-B2,H01L
US-11422402-B2,G06F
US-11422402-B2,G06F
US-11422402-B2,G06F
US-11422402-B2,G06F
US-11384177-B2,E21B
US-11384177-B2,E21B
US-11384177-B2,E21B
US-11418715-B2,G06F
US-11401219-B2,B01J
US-11401219-B2,B01J
US-11401219-B2,B01J
US-11401219-B2,B01J
US-11401219-B2,B01J
US-11407172-B2,B29C
US-11407172-B2,B29C
US-11407172-B2,B29C
US-11407172-B2,B29C
US-11418602-B2,G06F
US-11400006-B2,A61B
US-11376319-B2,A61K
US-11376319-B2,A61K
US-11410444-B2,G06F
US-11410444-B2,G06F
US-11410444-B2,G06F
US-11410444-B2,G06F
US-11392816-B2,G06K
US-11374644-B2,H04W
US-11376109-B2,A61F
US-11412422-B2,H04L
US-11364337-B2,A61M
US-11364337-B2,A61M
US-11364337-B2,A61M
US-11364337-B2,A61M
US-11364337-B2,A61M
US-11364337-B2,A61M
US-11364337-B2,A61M
US-11450645-B2,H01L
US-11450645-B2,H01L
US-11450645-B2,H01L
US-11450645-B2,H01L
US-11450645-B2,H01L
US-11385163-B2,G01N
US-11363375-B2,G01S
US-11422364-B2,G06T
US-11389955-B2,G06F
US-11449505-B2,G06F
US-11449505-B2,G06F
US-11376718-B2,F04B
US-11413537-B2,G06F
US-11413537-B2,G06F
US-11423539-B2,A61B
US-11421980-B2,G01S
US-11421980-B2,G01S
US-11401923-B2,F04B
US-11410365-B2,G06F
US-11410365-B2,G06F
US-11360211-B2,G06V
US-11375912-B2,A61B
US-11398593-B2,H01L
US-11398593-B2,H01L
US-11398593-B2,H01L
US-11420401-B2,B29C
US-11420401-B2,B29C
US-11354655-B2,G06F
US-11354655-B2,G06F
US-11449952-B2,G06F
US-11438650-B2,H04N
US-11438650-B2,H04N
US-11438650-B2,H04N
US-11438650-B2,H04N
US-11393841-B2,H01L
US-11393841-B2,H01L
US-11393841-B2,H01L
US-11412960-B2,A61B
US-11412960-B2,A61B
US-11412960-B2,A61B
US-11412960-B2,A61B
US-11444109-B2,H04N
US-11444109-B2,H04N
US-11444109-B2,H04N
US-11444109-B2,H04N
US-11455469-B2,G06F
US-11455469-B2,G06F
US-11455469-B2,G06F
US-11438395-B2,H04N
US-11438395-B2,H04N
US-11438395-B2,H04N
US-11407574-B2,B65D
US-11396158-B2,B32B
US-11396158-B2,B32B
US-11446383-B2,A61K
US-11446383-B2,A61K
US-11446383-B2,A61K
US-11446383-B2,A61K
US-11446383-B2,A61K
US-11411015-B2,H01L
US-11411015-B2,H01L
US-11372255-B2,G06F
US-11372255-B2,G06F
US-11450698-B2,H01L
US-11450698-B2,H01L
US-11450698-B2,H01L
US-11434291-B2,A61K
US-11419647-B2,A61B
US-11419647-B2,A61B
US-11419647-B2,A61B
US-11419647-B2,A61B
US-11419647-B2,A61B
US-11401234-B2,A61K
US-11401234-B2,A61K
US-11401234-B2,A61K
US-11351355-B2,A61M
US-11351355-B2,A61M
US-11351355-B2,A61M
US-11351355-B2,A61M
US-11351355-B2,A61M
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11413710-B2,B23K
US-11386886-B2,G10L
US-11386886-B2,G10L
US-11432574-B2,C12N
US-11375403-B2,H04L
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11357437-B2,A61B
US-11386278-B2,H04B
US-11402589-B2,G02B
US-11402589-B2,G02B
US-11451603-B2,H04L
US-11451603-B2,H04L
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11412923-B2,A61B
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11387209-B2,H01L
US-11452433-B2,A61B
US-11452433-B2,A61B
US-11452433-B2,A61B
US-11446260-B2,A61K
US-11446260-B2,A61K
US-11446260-B2,A61K
US-11446260-B2,A61K
US-11446260-B2,A61K
US-11446260-B2,A61K
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11457276-B2,H04N
US-11439749-B2,A61M
US-11439749-B2,A61M
US-11439749-B2,A61M
US-11439749-B2,A61M
US-11416022-B2,G06F
US-11416022-B2,G06F
US-11433084-B2,A61K
US-11433084-B2,A61K
US-11433084-B2,A61K
US-11406524-B2,A61F
US-11406524-B2,A61F
US-11416001-B2,G06F
US-11416001-B2,G06F
US-11356221-B2,H04L
US-11356221-B2,H04L
US-11436134-B2,G06F
US-11436134-B2,G06F
US-11436134-B2,G06F
US-11409969-B2,H04B
US-11375241-B2,H04N
US-11375241-B2,H04N
US-11375241-B2,H04N
US-11375241-B2,H04N
US-11438668-B2,H04N
US-11438668-B2,H04N
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11396572-B2,C08F
US-11436431-B2,G06V
US-11436431-B2,G06V
US-11445622-B2,G06F
US-11417842-B2,C08F
US-11417842-B2,C08F
US-11424884-B2,H04L
US-11379973-B2,G06T
US-11379973-B2,G06T
US-11408811-B2,E21B
US-11408811-B2,E21B
US-11454603-B2,G01N
US-11454603-B2,G01N
US-11454603-B2,G01N
US-11416109-B2,G06F
US-11416109-B2,G06F
US-11416109-B2,G06F
US-11367437-B2,G10L
US-11367437-B2,G10L
US-11367437-B2,G10L
US-11367437-B2,G10L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11424341-B2,H01L
US-11386539-B2,H01L
US-11422371-B2,H04N
US-11360542-B2,G06F
US-11360542-B2,G06F
US-11436736-B2,G06T
US-11436736-B2,G06T
US-11387213-B2,H01L
US-11387213-B2,H01L
US-11387213-B2,H01L
US-11387213-B2,H01L
US-11443228-B2,G06N
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11370724-B2,B01J
US-11431960-B2,H04N
US-11363222-B2,H04N
US-11363222-B2,H04N
US-11363222-B2,H04N
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11380765-B2,H01L
US-11385961-B2,G06F
US-11385961-B2,G06F
US-11385961-B2,G06F
US-11385961-B2,G06F
US-11433630-B2,G02B
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11412231-B2,H04N
US-11423376-B2,G06F
US-11399950-B2,A61F
US-11399950-B2,A61F
US-11384000-B2,G06F
US-11434270-B2,A61K
US-11434270-B2,A61K
US-11369714-B2,C12N
US-11448742-B2,G01S
US-11448742-B2,G01S
US-11448742-B2,G01S
US-11448742-B2,G01S
US-11410148-B2,H04L
US-11373280-B2,G06T
US-11373280-B2,G06T
US-11404307-B2,H01L
US-11404307-B2,H01L
US-11404307-B2,H01L
US-11404307-B2,H01L
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11436630-B2,H04N
US-11375479-B2,H04W
US-11375479-B2,H04W
US-11375479-B2,H04W
US-11353839-B2,H05B
US-11353839-B2,H05B
US-11353839-B2,H05B
US-11353839-B2,H05B
US-11353839-B2,H05B
US-11353839-B2,H05B
US-11435444-B2,G01S
US-11435444-B2,G01S
US-11435444-B2,G01S
US-11365041-B2,B65D
US-11365041-B2,B65D
US-11365041-B2,B65D
US-11397326-B2,G02B
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11443120-B2,G06F
US-11374640-B2,H04L
US-11397228-B2,H04N
US-11439554-B2,A61B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11428067-B2,E21B
US-11372388-B2,G05B
US-11372388-B2,G05B
US-11455459-B2,G06F
US-11455459-B2,G06F
US-11455459-B2,G06F
US-11455459-B2,G
Current sql:
WITH code_counts AS (
    SELECT
        SUBSTRING(ipc_u2.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
        COUNT(*) AS "code_count"
    FROM
        PATENTS.PATENTS.PUBLICATIONS t2,
        LATERAL FLATTEN(input => t2."ipc") ipc_u2
    WHERE
        t2."country_code" = 'US'
        AND t2."kind_code" = 'B2'
        AND t2."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY
        "ipc4_code"
    HAVING
        COUNT(*) >= 10
),
ipc_codes AS (
    SELECT
        t."publication_number",
        SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
    FROM
        PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE
        t."country_code" = 'US'
        AND t."kind_code" = 'B2'
        AND t."grant_date" BETWEEN 20220601 AND 20220930
),
ranked_ipc AS (
    SELECT
        ic."publication_number",
        ic."ipc4_code",
        DENSE_RANK() OVER (
            PARTITION BY ic."publication_number"
            ORDER BY cc."code_count" DESC NULLS LAST
        ) AS "rank"
    FROM
        ipc_codes ic
    INNER JOIN
        code_counts cc ON ic."ipc4_code" = cc."ipc4_code"
)
SELECT
    "publication_number",
    "ipc4_code" AS "ipc4"
FROM
    ranked_ipc
WHERE
    "rank" = 1
2025-01-26 09:40:55 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 09:40:55 - root - INFO - ```sql
WITH code_counts AS (
    SELECT
        SUBSTRING(ipc_u2.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code",
        COUNT(*) AS "code_count"
    FROM
        PATENTS.PATENTS.PUBLICATIONS t2,
        LATERAL FLATTEN(input => t2."ipc") ipc_u2
    WHERE
        t2."country_code" = 'US'
        AND t2."kind_code" = 'B2'
        AND t2."grant_date" BETWEEN 20220601 AND 20220930
    GROUP BY
        "ipc4_code"
    HAVING
        COUNT(*) >= 10
),
ipc_codes AS (
    SELECT
        t."publication_number",
        SUBSTRING(ipc_u.value::VARIANT:"code"::STRING, 1, 4) AS "ipc4_code"
    FROM
        PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."ipc") ipc_u
    WHERE
        t."country_code" = 'US'
        AND t."kind_code" = 'B2'
        AND t."grant_date" BETWEEN 20220601 AND 20220930
),
ranked_ipc AS (
    SELECT
        ic."publication_number",
        ic."ipc4_code",
        DENSE_RANK() OVER (
            PARTITION BY ic."publication_number"
            ORDER BY cc."code_count" DESC NULLS LAST
        ) AS "rank"
    FROM
        ipc_codes ic
    INNER JOIN
        code_counts cc ON ic."ipc4_code" = cc."ipc4_code"
)
SELECT
    "publication_number",
    "ipc4_code" AS "ipc4"
FROM
    ranked_ipc
WHERE
    "rank" = 1
```
2025-01-26 09:40:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 09:40:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 09:40:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 09:40:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 611
2025-01-26 09:40:56 - snowflake.connector.connection - INFO - closed
2025-01-26 09:40:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 09:40:57 - root - INFO - itercount: 3
2025-01-26 09:40:57 - root - INFO - 0
2025-01-26 09:40:57 - root - INFO - Total iteration counts: 3
