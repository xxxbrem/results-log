2025-01-23 18:01:42 - openai._base_client - INFO - Retrying request to /chat/completions in 0.419862 seconds
2025-01-23 18:02:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 18:02:21 - root - INFO - SQL:
SELECT DISTINCT "month_year"
   FROM "interest_metrics"
   LIMIT 100;
Results:
month_year
07-2018
""
08-2018
09-2018
10-2018
11-2018
12-2018
01-2019
02-2019
03-2019
04-2019
05-2019
06-2019
07-2019
08-2019

2025-01-23 18:02:21 - root - INFO - SQL:
SELECT DISTINCT "interest_id"
   FROM "interest_metrics"
   LIMIT 100;
Results:
interest_id
32486.0
6106.0
18923.0
6344.0
100.0
69.0
79.0
6111.0
6214.0
19422.0
6110.0
4895.0
6217.0
4.0
6218.0
6123.0
171.0
19613.0
17.0
6.0
6013.0
4870.0
19423.0
6089.0
161.0
6286.0
5991.0
92.0
6184.0
19621.0
63.0
103.0
38.0
17786.0
6232.0
165.0
18351.0
15.0
""
17314.0
6151.0
4914.0
115.0
5968.0
36.0
5943.0
133.0
1.0
114.0
6107.0
150.0
60.0
96.0
22403.0
40.0
19758.0
17730.0
5938.0
4869.0
4897.0
6029.0
31.0
16137.0
6330.0
6334.0
6315.0
4852.0
16.0
6108.0
6206.0
6006.0
6228.0
20768.0
4902.0
6277.0
19757.0
4911.0
4910.0
6285.0
11974.0
6219.0
10250.0
6128.0
5946.0
158.0
15935.0
4855.0
149.0
16197.0
11067.0
17674.0
4913.0
56.0
6341.0
6316.0
18647.0
17803.0
23.0
132.0
6365.0

2025-01-23 18:02:21 - root - INFO - SQL:
SELECT DISTINCT "interest_name"
   FROM "interest_map"
   LIMIT 100;
Results:
interest_name
Fitness Enthusiasts
Gamers
Car Enthusiasts
Luxury Retail Researchers
Brides & Wedding Planners
Vacation Planners
Motorcycle Enthusiasts
Business News Readers
Thrift Store Shoppers
Advertising Professionals
NFL Fans
NBA Fans
NCAA Fans
MLB Fans
Nascar Fans
Eco-Conscious Consumers
Moviegoers
DIYers
Grill Masters
Techies
Home Design Enthusiasts
Doctors
Streaming Video Fans
Auto Insurance Shoppers
Teachers
College Students
Department Store Shoppers
Home Decor Shoppers
Kids Clothing Shoppers
Teen Girl Clothing Shoppers
Mens Clothing Shoppers
Baby Products Buyers
Jewelry & Watch Shoppers
Sporting Goods Shoppers
Furniture Shoppers
Bed & Bath Shoppers
Intimates Shoppers
Fast Fashion Shoppers
Apartment Hunters
Home Buyers
Moving Services Shoppers
Job Seekers
Charitable Donors
NHL Fans
Discount Big Box Shoppers
Black Friday Deal Shoppers
Hip Hop Fans
Online Investors
Seasonal Allergy Sufferers
Discount Device Shoppers
Mobile Phone Comparison Shoppers
Budget Wireless Shoppers
Menopause Researchers
Online Health Researchers
Beauty & Skincare Buyers
Streaming Device Shoppers
New & Expecting Parents
High-End Kids Furniture and Clothes Shoppers
Hands-On Parents
Fantasy & Comic Fans
Lawyers
Healthy Eaters
Drug Store Shoppers
Lawn & Garden Enthusiasts
Nurses
Mailing & Shipping Shoppers
Office Supply Shoppers
Ink & Toner Shoppers
Luxury Retail Shoppers
Contractors & Construction Professionals
Luxury Travel Researchers
Democrats
Republicans
HDTV Researchers
Hardware Shoppers
Reggaeton Fans
Online Movie Downloaders
Sale Seekers
Theme Park Researchers
Ski and Snowboard Enthusiasts
Travel Researchers
Coupon Researchers
Parents with Toddlers
Parents with Kids
Young Boomers
Day Care Users
Stay-at-Home Parents
Exercise and Gym Researchers
Home Kitchen Chefs
Restaurant Researchers
Order-in Eaters
Nutrition Conscious Eaters
Flower & Gift Basket Shoppers
Plus Size Women
Live Concert Fans
Country Music Fans
Comedy Fans
Cruise Travel Intenders
Pain Medication Users
Joint Pain Sufferers

2025-01-23 18:02:21 - root - INFO - SQL:
SELECT "composition"
   FROM "interest_metrics"
   ORDER BY "composition" DESC
   LIMIT 100;
Results:
composition
21.2
20.28
19.45
18.99
18.82
18.39
18.18
17.44
17.19
15.15
15.05
14.92
14.92
14.91
14.39
14.29
14.23
14.15
14.1
13.97
13.9
13.81
13.67
13.64
13.35
13.03
12.93
12.87
12.85
12.8
12.73
12.68
12.64
12.64
12.62
12.62
12.56
12.47
12.42
12.41
12.41
12.33
12.3
12.27
12.26
12.22
12.16
12.03
11.99
11.97
11.93
11.93
11.89
11.75
11.74
11.74
11.73
11.72
11.71
11.68
11.63
11.63
11.61
11.57
11.57
11.5
11.48
11.4
11.38
11.27
11.23
11.21
11.18
11.15
11.14
11.1
11.08
11.06
11.06
11.04
11.03
11.01
11.0
10.99
10.99
10.96
10.95
10.95
10.91
10.91
10.89
10.88
10.86
10.85
10.85
10.82
10.82
10.8
10.79
10.77

2025-01-23 18:02:21 - root - INFO - SQL:
SELECT "composition"
   FROM "interest_metrics"
   ORDER BY "composition" ASC
   LIMIT 100;
Results:
composition
1.51
1.51
1.52
1.52
1.52
1.52
1.52
1.52
1.52
1.52
1.52
1.53
1.53
1.53
1.53
1.54
1.54
1.54
1.54
1.54
1.54
1.54
1.54
1.54
1.54
1.54
1.54
1.54
1.54
1.54
1.54
1.55
1.55
1.55
1.55
1.55
1.55
1.55
1.55
1.55
1.55
1.55
1.55
1.55
1.55
1.55
1.55
1.55
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.58
1.58
1.58
1.58

2025-01-23 18:02:21 - root - INFO - SQL:
SELECT "interest_id", "composition"
   FROM "interest_metrics"
   LIMIT 100;
Results:
interest_id,composition
32486.0,11.89
6106.0,9.93
18923.0,10.85
6344.0,10.32
100.0,10.77
69.0,10.82
79.0,11.21
6111.0,10.71
6214.0,9.71
19422.0,10.11
6110.0,11.57
4895.0,9.47
6217.0,10.8
4.0,13.97
6218.0,9.29
6123.0,9.49
171.0,14.91
19613.0,12.62
17.0,7.89
6.0,11.99
6013.0,9.35
4870.0,10.29
19423.0,12.22
6089.0,6.97
161.0,11.48
6286.0,14.1
5991.0,11.04
92.0,9.77
6184.0,13.35
19621.0,11.61
63.0,9.37
103.0,6.61
38.0,9.48
17786.0,13.67
6232.0,9.97
165.0,6.05
18351.0,6.09
15.0,6.9
,6.12
17314.0,10.43
6151.0,6.83
4914.0,7.42
115.0,11.68
5968.0,12.87
36.0,9.27
5943.0,6.37
133.0,10.91
1.0,7.02
114.0,6.25
6107.0,8.84
150.0,5.3
60.0,6.71
96.0,7.21
22403.0,12.27
40.0,10.86
19758.0,6.28
17730.0,11.38
5938.0,11.63
4869.0,6.47
4897.0,12.93
6029.0,8.72
31.0,7.9
16137.0,9.65
6330.0,6.82
6334.0,11.63
6315.0,8.14
4852.0,6.77
16.0,6.24
6108.0,6.65
6206.0,10.76
6006.0,6.26
6228.0,10.22
20768.0,6.53
4902.0,8.17
6277.0,11.72
19757.0,10.95
4911.0,6.87
,7.13
4910.0,6.09
6285.0,9.97
11974.0,7.19
6219.0,6.37
10250.0,11.4
6128.0,6.28
5946.0,5.99
158.0,7.46
15935.0,9.13
4855.0,5.99
149.0,6.88
16197.0,6.13
11067.0,5.14
17674.0,6.25
4913.0,6.76
56.0,7.09
6341.0,5.68
6316.0,6.52
18647.0,6.45
17803.0,6.21
23.0,5.41
132.0,7.48

2025-01-23 18:02:21 - root - INFO - SQL:
SELECT "id", "interest_name"
   FROM "interest_map"
   LIMIT 100;
Results:
id,interest_name
1,Fitness Enthusiasts
2,Gamers
3,Car Enthusiasts
4,Luxury Retail Researchers
5,Brides & Wedding Planners
6,Vacation Planners
7,Motorcycle Enthusiasts
8,Business News Readers
12,Thrift Store Shoppers
13,Advertising Professionals
14,NFL Fans
15,NBA Fans
16,NCAA Fans
17,MLB Fans
18,Nascar Fans
19,Eco-Conscious Consumers
20,Moviegoers
21,DIYers
22,Grill Masters
23,Techies
24,Home Design Enthusiasts
25,Doctors
26,Streaming Video Fans
27,Auto Insurance Shoppers
28,Teachers
29,College Students
30,Department Store Shoppers
31,Home Decor Shoppers
33,Kids Clothing Shoppers
34,Teen Girl Clothing Shoppers
35,Mens Clothing Shoppers
36,Baby Products Buyers
37,Jewelry & Watch Shoppers
38,Sporting Goods Shoppers
39,Furniture Shoppers
40,Bed & Bath Shoppers
41,Intimates Shoppers
42,Fast Fashion Shoppers
43,Apartment Hunters
44,Home Buyers
45,Moving Services Shoppers
46,Job Seekers
48,Charitable Donors
49,NHL Fans
50,Discount Big Box Shoppers
51,Black Friday Deal Shoppers
53,Hip Hop Fans
54,Online Investors
55,Seasonal Allergy Sufferers
56,Discount Device Shoppers
57,Mobile Phone Comparison Shoppers
58,Budget Wireless Shoppers
59,Menopause Researchers
60,Online Health Researchers
61,Beauty & Skincare Buyers
62,Streaming Device Shoppers
63,New & Expecting Parents
64,High-End Kids Furniture and Clothes Shoppers
65,Hands-On Parents
66,Fantasy & Comic Fans
67,Lawyers
69,Healthy Eaters
70,Drug Store Shoppers
71,Lawn & Garden Enthusiasts
72,Nurses
73,Mailing & Shipping Shoppers
74,Office Supply Shoppers
75,Ink & Toner Shoppers
77,Luxury Retail Shoppers
78,Contractors & Construction Professionals
79,Luxury Travel Researchers
80,Democrats
81,Republicans
82,HDTV Researchers
83,Hardware Shoppers
84,Reggaeton Fans
85,Online Movie Downloaders
86,Sale Seekers
87,Theme Park Researchers
88,Ski and Snowboard Enthusiasts
89,Travel Researchers
90,Coupon Researchers
91,Parents with Toddlers
92,Parents with Kids
93,Young Boomers
94,Day Care Users
95,Stay-at-Home Parents
96,Exercise and Gym Researchers
97,Home Kitchen Chefs
98,Restaurant Researchers
99,Order-in Eaters
100,Nutrition Conscious Eaters
101,Flower & Gift Basket Shoppers
102,Plus Size Women
103,Live Concert Fans
104,Country Music Fans
106,Comedy Fans
107,Cruise Travel Intenders
108,Pain Medication Users
109,Joint Pain Sufferers

2025-01-23 18:02:21 - root - INFO - SQL:
SELECT "interest_id", MAX("composition") AS "max_composition"
   FROM "interest_metrics"
   GROUP BY "interest_id"
   ORDER BY "max_composition" DESC
   LIMIT 100;
Results:
interest_id,max_composition
21057.0,21.2
6284.0,18.82
39.0,17.44
77.0,17.19
12133.0,15.15
5969.0,15.05
171.0,14.91
4898.0,14.23
6286.0,14.1
4.0,13.97
17786.0,13.67
6184.0,13.35
19298.0,13.03
4897.0,12.93
5968.0,12.87
19613.0,12.62
6.0,12.56
64.0,12.41
22403.0,12.27
19423.0,12.22
10977.0,12.16
158.0,11.97
32486.0,11.89
6277.0,11.72
115.0,11.68
6334.0,11.63
5938.0,11.63
19621.0,11.61
6110.0,11.57
161.0,11.48
10250.0,11.4
17730.0,11.38
34.0,11.23
79.0,11.21
5991.0,11.04
19757.0,10.95
133.0,10.91
40.0,10.86
18923.0,10.85
69.0,10.82
5.0,10.82
6217.0,10.8
100.0,10.77
6206.0,10.76
6111.0,10.71
4943.0,10.7
10981.0,10.62
5960.0,10.61
6343.0,10.54
41548.0,10.46
17314.0,10.43
21237.0,10.36
6344.0,10.32
6324.0,10.3
4870.0,10.29
5944.0,10.24
6228.0,10.22
89.0,10.14
19422.0,10.11
6029.0,10.05
82.0,9.99
7541.0,9.98
6285.0,9.97
6232.0,9.97
6106.0,9.93
18783.0,9.83
92.0,9.77
6214.0,9.71
6208.0,9.67
,9.66
16137.0,9.65
6378.0,9.64
6123.0,9.49
38.0,9.48
4895.0,9.47
10008.0,9.46
4944.0,9.46
141.0,9.46
63.0,9.37
6013.0,9.35
6308.0,9.33
6218.0,9.29
36.0,9.27
6112.0,9.22
5970.0,9.21
18619.0,9.15
15935.0,9.13
13497.0,9.03
21061.0,8.97
10009.0,8.95
6107.0,8.84
16138.0,8.81
5911.0,8.69
60.0,8.66
15879.0,8.65
17269.0,8.64
21060.0,8.58
30.0,8.56
7425.0,8.54
21058.0,8.5

2025-01-23 18:02:21 - root - INFO - SQL:
SELECT "interest_id", MIN("composition") AS "min_composition"
   FROM "interest_metrics"
   GROUP BY "interest_id"
   ORDER BY "min_composition" ASC
   LIMIT 100;
Results:
interest_id,min_composition
,1.51
45524.0,1.51
4918.0,1.52
16198.0,1.52
17274.0,1.52
20768.0,1.52
34083.0,1.52
34645.0,1.52
35742.0,1.52
39336.0,1.52
44449.0,1.52
6127.0,1.53
6314.0,1.53
34951.0,1.53
36877.0,1.53
53.0,1.54
4847.0,1.54
18203.0,1.54
18620.0,1.54
21247.0,1.54
22408.0,1.54
33969.0,1.54
34647.0,1.54
38364.0,1.54
39190.0,1.54
42000.0,1.54
44482.0,1.54
49502.0,1.54
66.0,1.55
165.0,1.55
4867.0,1.55
6138.0,1.55
6222.0,1.55
6228.0,1.55
6365.0,1.55
18351.0,1.55
21243.0,1.55
34642.0,1.55
37881.0,1.55
39195.0,1.55
41062.0,1.55
45522.0,1.55
13.0,1.56
14.0,1.56
71.0,1.56
4920.0,1.56
6010.0,1.56
6050.0,1.56
6076.0,1.56
6131.0,1.56
7453.0,1.56
19599.0,1.56
19631.0,1.56
19635.0,1.56
20753.0,1.56
20756.0,1.56
37410.0,1.56
37417.0,1.56
39337.0,1.56
39767.0,1.56
39770.0,1.56
41061.0,1.56
44459.0,1.56
44471.0,1.56
44485.0,1.56
169.0,1.57
4855.0,1.57
4899.0,1.57
4910.0,1.57
6169.0,1.57
6316.0,1.57
19611.0,1.57
21244.0,1.57
33970.0,1.57
34087.0,1.57
34948.0,1.57
36343.0,1.57
38283.0,1.57
38991.0,1.57
40194.0,1.57
41076.0,1.57
41195.0,1.57
42008.0,1.57
44579.0,1.57
45528.0,1.57
49973.0,1.57
8.0,1.58
24.0,1.58
27.0,1.58
59.0,1.58
164.0,1.58
6162.0,1.58
6332.0,1.58
19296.0,1.58
21246.0,1.58
22095.0,1.58
22400.0,1.58
33963.0,1.58
33964.0,1.58
33968.0,1.58

2025-01-23 18:02:21 - root - INFO - SQL:
SELECT im."interest_name", MAX(m."composition") AS "max_composition"
    FROM "interest_metrics" AS m
    JOIN "interest_map" AS im ON m."interest_id" = im."id"
    GROUP BY im."interest_name"
    ORDER BY "max_composition" DESC
    LIMIT 100;
Results:
interest_name,max_composition
Work Comes First Travelers,21.2
Gym Equipment Owners,18.82
Furniture Shoppers,17.44
Luxury Retail Shoppers,17.19
Luxury Boutique Hotel Researchers,15.15
Luxury Bedding Shoppers,15.05
Shoe Shoppers,14.91
Cosmetics and Beauty Shoppers,14.23
Luxury Hotel Guests,14.1
Luxury Retail Researchers,13.97
Womens Fashion Brands Shoppers,13.67
Reusable Drinkware Shoppers,13.35
Beach Supplies Shoppers,13.03
Parents of Teenagers Going to College,12.93
Luxury Kitchen Goods Shoppers,12.87
Land Rover Shoppers,12.62
Vacation Planners,12.56
High-End Kids Furniture and Clothes Shoppers,12.41
Pandora Jewelry Shoppers,12.27
Kitchen Appliance Shoppers,12.22
Christmas Celebration Researchers,12.16
Flight and Hotel Shoppers,11.97
Vacation Rental Accommodation Researchers,11.89
Harry Potter Fans,11.72
Mens Shoe Shoppers,11.68
Supermarket Shoppers,11.63
Costa Rica Trip Planners,11.63
Portugal Trip Planners,11.61
Apartment Furniture Shoppers,11.57
Travel Reward Points Enthusiasts,11.48
Halloween Costume Shoppers,11.4
Luxury Department Store Shoppers,11.38
Teen Girl Clothing Shoppers,11.23
Luxury Travel Researchers,11.21
Gluten-Free Recipe Researchers,11.04
Natural Pet Food Shoppers,10.95
High End Camera Shoppers - Dupe,10.91
Bed & Bath Shoppers,10.86
Online Home Decor Shoppers,10.85
Healthy Eaters,10.82
Brides & Wedding Planners,10.82
Weight Loss Researchers,10.8
Nutrition Conscious Eaters,10.77
Preppy Clothing Shoppers,10.76
Wine Lovers,10.71
Online Grocery Shoppers,10.7
New Years Eve Party Ticket Purchasers,10.62
New Zealand Trip Planners,10.61
Patio Furniture Shoppers,10.54
Winter Apparel Shoppers,10.46
Lobbyists,10.43
Chelsea Fans,10.36
Hair Care Shoppers,10.32
Las Vegas Trip Planners,10.3
Tech-Savvy Moms,10.29
Financial Advisors,10.24
Paleo Eaters,10.22
Travel Researchers,10.14
Home Design and Living Publication Readers,10.11
Indoor Cycling & Spinning Enthusiasts,10.05
HDTV Researchers,9.99
Alabama Trip Planners,9.98
Golf Enthusiasts,9.97
Competitive Tri-Athletes,9.97
Luxury Second Home Owners,9.93
Nursing and Physicians Assistant Journal Researchers,9.83
Parents with Kids,9.77
Home Remodelers,9.71
Recently Retired Individuals,9.67
Olympics Fans,9.65
Luggage Shoppers,9.64
Misc-Deal Seekers or Coupon Shoppers,9.49
Sporting Goods Shoppers,9.48
Mature Parents,9.47
Skin Care Researchers,9.46
Pre-Measured Grocery Shoppers,9.46
Japanese Luxury Car Enthusiasts,9.46
New & Expecting Parents,9.37
Competitive Sports Participants,9.35
Food Safety Decision Makers,9.33
Running Enthusiasts,9.29
Baby Products Buyers,9.27
Olympic Sports Enthusiasts,9.22
Luxury Home Fixture Shoppers,9.21
Asian Food Enthusiasts,9.15
Pregnancy Resources Researchers,9.13
Restaurant Supply Shoppers,9.03
"Work Hard, Play Hard Travelers",8.97
Investment Services Intenders,8.95
Ski House Second Home Owners,8.84
Special Olympics Fans,8.81
Credit Score Researchers,8.69
Online Health Researchers,8.66
Freelancers,8.65
At-Home Gym Intenders,8.64
Family Adventures Travelers,8.58
Department Store Shoppers,8.56
Life Insurance Researchers,8.54
Mid-Range Grocery Shoppers,8.5
Countdown to the Beach Travelers,8.5

2025-01-23 18:02:21 - root - INFO - SQL:
SELECT "month_year", "interest_id", "composition"
    FROM "interest_metrics"
    WHERE "composition" > 0.9
    ORDER BY "composition" DESC
    LIMIT 100;
Results:
month_year,interest_id,composition
12-2018,21057.0,21.2
10-2018,21057.0,20.28
11-2018,21057.0,19.45
01-2019,21057.0,18.99
07-2018,6284.0,18.82
02-2019,21057.0,18.39
09-2018,21057.0,18.18
07-2018,39.0,17.44
07-2018,77.0,17.19
10-2018,12133.0,15.15
12-2018,5969.0,15.05
11-2018,5969.0,14.92
01-2019,5969.0,14.92
07-2018,171.0,14.91
02-2019,5969.0,14.39
09-2018,5969.0,14.29
07-2018,4898.0,14.23
10-2018,5969.0,14.15
07-2018,6286.0,14.1
07-2018,4.0,13.97
08-2018,6284.0,13.9
12-2018,12133.0,13.81
07-2018,17786.0,13.67
02-2019,12133.0,13.64
07-2018,6184.0,13.35
10-2018,19298.0,13.03
07-2018,4897.0,12.93
07-2018,5968.0,12.87
02-2019,19298.0,12.85
09-2018,12133.0,12.8
08-2018,77.0,12.73
11-2018,12133.0,12.68
10-2018,6284.0,12.64
03-2019,12133.0,12.64
07-2018,19613.0,12.62
12-2018,19298.0,12.62
10-2018,6.0,12.56
10-2018,6286.0,12.47
08-2018,21057.0,12.42
12-2018,64.0,12.41
02-2019,6286.0,12.41
10-2018,64.0,12.33
03-2019,5969.0,12.3
07-2018,22403.0,12.27
01-2019,12133.0,12.26
07-2018,19423.0,12.22
10-2018,10977.0,12.16
08-2018,39.0,12.03
07-2018,6.0,11.99
10-2018,158.0,11.97
09-2018,64.0,11.93
11-2018,19298.0,11.93
07-2018,32486.0,11.89
01-2019,64.0,11.75
09-2018,19298.0,11.74
12-2018,77.0,11.74
10-2018,77.0,11.73
07-2018,6277.0,11.72
01-2019,19298.0,11.71
07-2018,115.0,11.68
07-2018,5938.0,11.63
07-2018,6334.0,11.63
07-2018,19621.0,11.61
07-2018,6110.0,11.57
12-2018,10977.0,11.57
12-2018,6286.0,11.5
07-2018,161.0,11.48
07-2018,10250.0,11.4
07-2018,17730.0,11.38
03-2019,19298.0,11.27
12-2018,34.0,11.23
07-2018,79.0,11.21
09-2018,6286.0,11.18
07-2018,5969.0,11.15
11-2018,6286.0,11.14
10-2018,39.0,11.1
12-2018,6.0,11.08
09-2018,6284.0,11.06
11-2018,6284.0,11.06
07-2018,5991.0,11.04
02-2019,6.0,11.03
04-2019,5969.0,11.01
10-2018,19621.0,11.0
02-2019,64.0,10.99
03-2019,6286.0,10.99
01-2019,10977.0,10.96
07-2018,19757.0,10.95
07-2018,21057.0,10.95
07-2018,133.0,10.91
12-2018,6284.0,10.91
10-2018,10250.0,10.89
11-2018,10977.0,10.88
07-2018,40.0,10.86
07-2018,18923.0,10.85
08-2018,5969.0,10.85
07-2018,69.0,10.82
07-2018,5.0,10.82
07-2018,6217.0,10.8
07-2018,12133.0,10.79
07-2018,100.0,10.77

2025-01-23 18:02:21 - root - INFO - SQL:
SELECT "interest_id", "percentile_ranking"
    FROM "interest_metrics"
    LIMIT 100;
Results:
interest_id,percentile_ranking
32486.0,99.86
6106.0,99.73
18923.0,99.59
6344.0,99.45
100.0,99.31
69.0,99.18
79.0,99.04
6111.0,98.9
6214.0,98.9
19422.0,98.63
6110.0,98.49
4895.0,98.35
6217.0,98.22
4.0,98.08
6218.0,97.94
6123.0,97.81
171.0,97.67
19613.0,97.53
17.0,97.39
6.0,97.26
6013.0,97.12
4870.0,96.98
19423.0,96.84
6089.0,96.71
161.0,96.57
6286.0,96.57
5991.0,96.3
92.0,96.16
6184.0,96.02
19621.0,95.88
63.0,95.75
103.0,95.61
38.0,95.47
17786.0,95.34
6232.0,95.2
165.0,95.06
18351.0,94.92
15.0,94.79
,96.4
17314.0,94.65
6151.0,94.65
4914.0,94.65
115.0,94.24
5968.0,94.24
36.0,93.96
5943.0,93.83
133.0,93.69
1.0,93.69
114.0,93.42
6107.0,93.28
150.0,93.28
60.0,93.0
96.0,92.87
22403.0,92.73
40.0,92.59
19758.0,92.59
17730.0,92.32
5938.0,92.18
4869.0,92.18
4897.0,91.91
6029.0,91.77
31.0,91.77
16137.0,91.5
6330.0,91.36
6334.0,91.36
6315.0,91.36
4852.0,90.95
16.0,90.95
6108.0,90.67
6206.0,90.67
6006.0,90.4
6228.0,90.4
20768.0,90.4
4902.0,89.99
6277.0,89.85
19757.0,89.71
4911.0,89.71
,96.23
4910.0,89.44
6285.0,89.3
11974.0,89.16
6219.0,89.16
10250.0,88.89
6128.0,88.75
5946.0,88.61
158.0,88.61
15935.0,88.34
4855.0,88.2
149.0,88.2
16197.0,87.93
11067.0,87.79
17674.0,87.65
4913.0,87.65
56.0,87.38
6341.0,87.38
6316.0,87.38
18647.0,87.38
17803.0,87.38
23.0,86.69
132.0,86.56

2025-01-23 18:02:21 - root - INFO - SQL:
SELECT "interest_id", "month_year", MAX("composition") AS "max_composition"
    FROM "interest_metrics"
    GROUP BY "interest_id"
    LIMIT 100;
Results:
interest_id,month_year,max_composition
,,9.66
1.0,07-2018,7.02
2.0,02-2019,3.09
3.0,07-2018,6.14
4.0,07-2018,13.97
5.0,07-2018,10.82
6.0,10-2018,12.56
7.0,07-2018,2.64
8.0,07-2018,6.67
12.0,07-2018,7.23
13.0,07-2018,6.72
14.0,07-2018,3.53
15.0,07-2018,6.9
16.0,07-2018,6.24
17.0,07-2018,7.89
18.0,07-2018,3.18
19.0,07-2018,6.57
20.0,07-2018,4.08
21.0,10-2018,5.26
22.0,07-2018,6.26
23.0,07-2018,5.41
24.0,07-2018,6.54
25.0,07-2018,4.31
26.0,07-2018,6.01
27.0,07-2018,6.81
28.0,10-2018,7.36
29.0,07-2018,5.2
30.0,10-2018,8.56
31.0,07-2018,7.9
33.0,07-2018,7.6
34.0,12-2018,11.23
35.0,07-2018,5.25
36.0,07-2018,9.27
37.0,07-2018,7.82
38.0,07-2018,9.48
39.0,07-2018,17.44
40.0,07-2018,10.86
41.0,07-2018,6.96
42.0,07-2018,4.9
43.0,07-2018,5.98
44.0,07-2018,6.11
45.0,07-2018,6.29
46.0,07-2018,3.4
48.0,10-2018,5.55
49.0,07-2018,5.09
50.0,10-2018,3.86
51.0,07-2018,2.67
53.0,07-2018,3.03
54.0,10-2018,3.88
55.0,10-2018,7.67
56.0,07-2018,7.09
57.0,07-2018,2.32
58.0,07-2018,2.18
59.0,07-2018,3.97
60.0,10-2018,8.66
61.0,07-2018,6.59
62.0,07-2018,4.15
63.0,07-2018,9.37
64.0,12-2018,12.41
65.0,07-2018,5.94
66.0,07-2018,6.51
67.0,10-2018,6.76
69.0,07-2018,10.82
70.0,07-2018,6.96
71.0,07-2018,3.43
72.0,07-2018,3.63
73.0,07-2018,7.06
74.0,07-2018,7.37
75.0,07-2018,7.23
77.0,07-2018,17.19
78.0,10-2018,2.78
79.0,07-2018,11.21
80.0,07-2018,4.47
81.0,07-2018,3.31
82.0,07-2018,9.99
83.0,10-2018,4.64
84.0,02-2019,3.88
85.0,07-2018,6.46
86.0,07-2018,6.13
87.0,07-2018,5.01
88.0,07-2018,4.99
89.0,10-2018,10.14
90.0,07-2018,5.91
91.0,07-2018,5.87
92.0,07-2018,9.77
93.0,07-2018,7.08
94.0,07-2018,3.52
95.0,07-2018,7.15
96.0,07-2018,7.21
97.0,07-2018,6.41
98.0,07-2018,7.64
99.0,07-2018,6.79
100.0,07-2018,10.77
101.0,07-2018,7.38
102.0,07-2018,7.74
103.0,07-2018,6.61
104.0,07-2018,5.42
106.0,07-2018,1.83
107.0,07-2018,8.32
108.0,07-2018,4.24

2025-01-23 18:02:21 - root - INFO - SQL:
SELECT "interest_id", AVG("composition") AS "avg_composition"
    FROM "interest_metrics"
    GROUP BY "interest_id"
    ORDER BY "avg_composition" DESC
    LIMIT 10;
Results:
interest_id,avg_composition
21057.0,17.4825
5969.0,11.093571428571428
6284.0,10.48642857142857
12133.0,10.43357142857143
77.0,9.762142857142857
19298.0,9.51142857142857
39.0,9.507857142857143
6286.0,9.36357142857143
64.0,8.86357142857143
10977.0,8.622142857142856

2025-01-23 18:02:21 - root - INFO - SQL:
SELECT "interest_id", AVG("composition") AS "avg_composition"
    FROM "interest_metrics"
    GROUP BY "interest_id"
    ORDER BY "avg_composition" ASC
    LIMIT 10;
Results:
interest_id,avg_composition
34951.0,1.57
42008.0,1.57
34950.0,1.59
15882.0,1.6533333333333333
16198.0,1.6580000000000001
42401.0,1.66
17274.0,1.69
42012.0,1.73
33958.0,1.7383333333333333
19599.0,1.7642857142857142

2025-01-23 18:02:21 - root - INFO - SQL:
SELECT im."interest_name", AVG(m."index_value") AS "avg_index_value"
    FROM "interest_metrics" AS m
    JOIN "interest_map" AS im ON m."interest_id" = im."id"
    GROUP BY im."interest_name"
    LIMIT 100;
Results:
interest_name,avg_index_value
ACC Fans,1.56375
Accounting & CPA Continuing Education Researchers,1.337142857142857
Action Figure and Collectibles Shoppers,1.0274999999999999
Action Movie and TV Enthusiasts,0.63
Acura Vehicle Shoppers,1.2327272727272727
Adult Acne Sufferers,1.1891666666666667
Advertising Professionals,1.4461538461538461
Affordable Hotel Bookers,2.157857142857143
Africa Trip Planners,1.496666666666667
Aftermarket Accessories Shoppers,1.4600000000000002
Agricultural and Food Issues Researchers,1.384
Agriculture and Climate Advocates,1.4700000000000002
Airstream Enthusiasts,1.5045454545454546
Alabama Trip Planners,1.4257142857142857
Alaskan Cruise Planners,1.6257142857142857
Alternative Medicine Enthusiasts,1.116666666666667
Alzheimer and Dementia Researchers,1.4249999999999996
Ancestry Researchers,1.1723076923076923
Android Fans,1.2100000000000002
Anesthesiologists,1.6821428571428572
Animal Humane Society Helpers,1.087142857142857
Animal Rights Researchers,0.9175
Anime Fans,0.7399999999999999
Antiquing Enthusiasts,1.1325
Apartment Furniture Shoppers,2.5685714285714285
Apartment Hunters,1.4164285714285714
Apple Fans,1.7192857142857143
Aquarium Trip Planners,1.2275
Archery Enthusiasts,1.0675000000000001
Architects,1.7666666666666666
Architecture Enthusiasts,1.7053846153846153
Arizona Cardinals Fans,1.28875
Arizona Diamondbacks Fans,1.6466666666666665
Arizona Trip Planners,1.4399999999999997
Arizona Wildcats Fans,0.88
Arkansas Razorbacks Fans,1.5550000000000002
Arsenal Fans,1.3378571428571429
Arthritis Sufferers,1.5371428571428571
As Seen on TV Shoppers,1.2330769230769232
Asheville Trip Planners,1.7483333333333333
Asian Food Enthusiasts,1.1414285714285715
Aspen Skiers and Snowboarders,2.6439999999999992
Aspen Trip Planners,1.571
Asthma Sufferers,1.4885714285714282
Astrology Enthusiasts,0.7216666666666667
At-Home Gym Intenders,2.532857142857143
Athleisure Shoppers,1.6466666666666665
Atlanta Braves Fans,1.6733333333333333
Atlanta Falcons Fans,1.1283333333333334
Atlanta Hawks Fans,1.3788888888888888
Atlanta Trip Planners,1.3164285714285715
Atlanta United Fans,1.3414285714285714
Auburn Tigers Fans,1.5466666666666669
Audi Vehicle Shoppers,1.3935714285714287
Audio Book Listeners,1.5635714285714286
Audio Equipment Researchers,1.3184615384615386
Austin Trip Planners,1.6435714285714287
Australia Trip Planners,1.6707142857142856
Authors,1.3135714285714286
Auto Body Shoppers,0.9853846153846153
Auto Insurance Shoppers,1.4957142857142858
Auto Repair Researchers,1.1246153846153848
Auto Show Enthusiasts,1.659285714285714
Auto-Looking for New Car Purchase or Lease,1.497142857142857
Automotive Auctions Enthusiasts,1.1755555555555555
Automotive News Readers,0.88
Automotive Racing Enthusiasts,1.67
Automotive Safety Researchers,1.577142857142857
Automotive Service Professionals,1.1642857142857144
Aviation Enthusiasts,1.4509999999999998
Avid Readers,1.737857142857143
BBQ Enthusiasts,1.2315384615384615
BBQ Recipe Researchers,1.2938461538461539
BMW Vehicle Shoppers,1.4515384615384617
Baby Products Buyers,1.2458333333333333
Back Pain Sufferers,1.4407142857142856
Background Check Users,1.0474999999999999
Backyard Farmers,0.9583333333333334
Ballet Enthusiasts,2.2928571428571423
Baltimore Orioles Fans,1.8161538461538458
Baltimore Ravens Fans,1.0814285714285714
Bargain Shopping Researchers,1.3542857142857143
Baseball Enthusiasts,2.2528571428571427
Basketball Enthusiasts,1.687142857142857
Beach House Second Home Owners,1.8514285714285712
Beach Supplies Shoppers,2.4864285714285717
Beard Care Shoppers,1.2735714285714281
Beauty & Skincare Buyers,1.7392857142857145
Bed & Bath Shoppers,1.805714285714286
Beer Aficionados,1.6335714285714285
Beer Lovers,1.614285714285714
Bible Study Researchers,1.08
Big & Tall Men,2.5907142857142853
Big 12 Fans,1.55
Big Box Shoppers,1.83
Big East Fans,2.33
Bigfoot Folklore Enthusiasts,0.97
Billiards Enthusiasts,1.6681818181818182
Biohackers,1.565
Bird Watching Enthusiasts,1.4544444444444444

2025-01-23 18:02:54 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 18:02:54 - root - INFO - ```sql
WITH max_compositions AS (
    SELECT
        m."interest_id",
        im."interest_name",
        m."month_year",
        m."composition",
        ROW_NUMBER() OVER (PARTITION BY m."interest_id" ORDER BY m."composition" DESC) AS rn
    FROM
        "interest_metrics" m
        JOIN "interest_map" im ON m."interest_id" = im."id"
)
SELECT "month_year", "interest_name", "composition"
FROM max_compositions
WHERE rn = 1
ORDER BY "composition" DESC
LIMIT 10
UNION ALL
SELECT "month_year", "interest_name", "composition"
FROM max_compositions
WHERE rn = 1
ORDER BY "composition" ASC
LIMIT 10;
```
2025-01-23 18:03:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 18:03:32 - root - INFO - ```sql
WITH max_compositions AS (
    SELECT
        m."interest_id",
        im."interest_name",
        m."month_year",
        m."composition",
        ROW_NUMBER() OVER (
            PARTITION BY m."interest_id"
            ORDER BY m."composition" DESC
        ) AS rn
    FROM
        "interest_metrics" m
        JOIN "interest_map" im ON m."interest_id" = im."id"
    WHERE m."composition" IS NOT NULL
)
SELECT "month_year", "interest_name", "composition" FROM (
    SELECT "month_year", "interest_name", "composition"
    FROM max_compositions
    WHERE rn = 1
    ORDER BY "composition" DESC
    LIMIT 10
)
UNION ALL
SELECT "month_year", "interest_name", "composition" FROM (
    SELECT "month_year", "interest_name", "composition"
    FROM max_compositions
    WHERE rn = 1
    ORDER BY "composition" ASC
    LIMIT 10
)
ORDER BY "composition" DESC;
```
2025-01-23 18:04:03 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 18:04:03 - root - INFO - SQL:
WITH max_compositions AS (
    SELECT
        m."interest_id",
        im."interest_name",
        m."month_year",
        m."composition",
        ROW_NUMBER() OVER (
            PARTITION BY m."interest_id"
            ORDER BY m."composition" DESC
        ) AS rn
    FROM
        "interest_metrics" m
        JOIN "interest_map" im ON m."interest_id" = im."id"
    WHERE m."composition" IS NOT NULL
)
SELECT "month_year", "interest_name", "composition" FROM (
    SELECT "month_year", "interest_name", "composition"
    FROM max_compositions
    WHERE rn = 1
    ORDER BY "composition" DESC
    LIMIT 10
)
UNION ALL
SELECT "month_year", "interest_name", "composition" FROM (
    SELECT "month_year", "interest_name", "composition"
    FROM max_compositions
    WHERE rn = 1
    ORDER BY "composition" ASC
    LIMIT 10
)
ORDER BY "composition" DESC;
Results:
month_year,interest_name,composition
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
07-2018,Readers of Jamaican Content,1.86
02-2019,Automotive News Readers,1.84
07-2018,Comedy Fans,1.83
08-2019,World of Warcraft Enthusiasts,1.82
08-2018,Miami Heat Fans,1.81
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2019,Hearthstone Video Game Fans,1.66
09-2018,Scifi Movie and TV Enthusiasts,1.61
09-2018,Action Movie and TV Enthusiasts,1.59
03-2019,The Sims Video Game Fans,1.57

2025-01-23 18:04:03 - root - INFO - SQL:
SELECT im."interest_name", m."composition"
FROM "interest_metrics" AS m
JOIN "interest_map" AS im ON m."interest_id" = im."id"
WHERE m."composition" > 0.5
LIMIT 100
Results:
interest_name,composition
Vacation Rental Accommodation Researchers,11.89
Luxury Second Home Owners,9.93
Online Home Decor Shoppers,10.85
Hair Care Shoppers,10.32
Nutrition Conscious Eaters,10.77
Healthy Eaters,10.82
Luxury Travel Researchers,11.21
Wine Lovers,10.71
Home Remodelers,9.71
Home Design and Living Publication Readers,10.11
Apartment Furniture Shoppers,11.57
Mature Parents,9.47
Weight Loss Researchers,10.8
Luxury Retail Researchers,13.97
Running Enthusiasts,9.29
Misc-Deal Seekers or Coupon Shoppers,9.49
Shoe Shoppers,14.91
Land Rover Shoppers,12.62
MLB Fans,7.89
Vacation Planners,11.99
Competitive Sports Participants,9.35
Tech-Savvy Moms,10.29
Kitchen Appliance Shoppers,12.22
Mens Fitness Publication Readers,6.97
Travel Reward Points Enthusiasts,11.48
Luxury Hotel Guests,14.1
Gluten-Free Recipe Researchers,11.04
Parents with Kids,9.77
Reusable Drinkware Shoppers,13.35
Portugal Trip Planners,11.61
New & Expecting Parents,9.37
Live Concert Fans,6.61
Sporting Goods Shoppers,9.48
Womens Fashion Brands Shoppers,13.67
Golf Enthusiasts,9.97
Liberal News Readers,6.05
Drama Show Watchers,6.09
NBA Fans,6.9
Lobbyists,10.43
Wedding Registrants,6.83
Mens Health Researchers,7.42
Mens Shoe Shoppers,11.68
Luxury Kitchen Goods Shoppers,12.87
Baby Products Buyers,9.27
Financial News Readers,6.37
High End Camera Shoppers - Dupe,10.91
Fitness Enthusiasts,7.02
Womens Fashion Magazine Readers,6.25
Ski House Second Home Owners,8.84
TV Junkies,5.3
Online Health Researchers,6.71
Exercise and Gym Researchers,7.21
Pandora Jewelry Shoppers,12.27
Bed & Bath Shoppers,10.86
Dog Lovers,6.28
Luxury Department Store Shoppers,11.38
Costa Rica Trip Planners,11.63
Womens Fitness Enthusiasts,6.47
Parents of Teenagers Going to College,12.93
Indoor Cycling & Spinning Enthusiasts,8.72
Home Decor Shoppers,7.9
Olympics Fans,9.65
Pet Store Goers,6.82
Supermarket Shoppers,11.63
Boston Trip Planners,8.14
Health & Fitness,6.77
NCAA Fans,6.24
Beach House Second Home Owners,6.65
Preppy Clothing Shoppers,10.76
Breast Cancer Fund Raisers,6.26
Paleo Eaters,10.22
Beer Aficionados,6.53
Yogis,8.17
Harry Potter Fans,11.72
Natural Pet Food Shoppers,10.95
Dieters,6.87
Cholesterol Researchers,6.09
Competitive Tri-Athletes,9.97
Price Conscious Home Shoppers,7.19
Cycling Enthusiasts,6.37
Halloween Costume Shoppers,11.4
Realtors & Real Estate Researchers,6.28
Readers of Filipinos Content,5.99
Flight and Hotel Shoppers,7.46
Pregnancy Resources Researchers,9.13
Entertainment & Tabloid Magazine Readers,5.99
Streaming Radio Listeners,6.88
Financial Business Intelligence Researchers,6.13
NCAA Football Fans,5.14
Medical Advice Researchers,6.25
Womens Health Researchers,6.76
Discount Device Shoppers,7.09
Pharmacy Shoppers,5.68
Philadelphia Trip Planners,6.52
Gourmet Food & Wine Researchers,6.45
TV Advertising Professionals,6.21
Techies,5.41
Apple Fans,7.48
Executive and C-Suite,6.45
Luggage Shoppers,9.64

2025-01-23 18:04:03 - root - INFO - SQL:
SELECT "interest_id", COUNT(*) AS "occurrences"
FROM "interest_metrics"
GROUP BY "interest_id"
LIMIT 100
Results:
interest_id,occurrences
,1193
1.0,12
2.0,11
3.0,10
4.0,14
5.0,14
6.0,14
7.0,11
8.0,13
12.0,14
13.0,13
14.0,12
15.0,14
16.0,14
17.0,14
18.0,14
19.0,10
20.0,14
21.0,12
22.0,13
23.0,6
24.0,12
25.0,14
26.0,11
27.0,14
28.0,14
29.0,14
30.0,14
31.0,14
33.0,14
34.0,14
35.0,14
36.0,12
37.0,14
38.0,14
39.0,14
40.0,14
41.0,14
42.0,14
43.0,14
44.0,14
45.0,14
46.0,14
48.0,14
49.0,14
50.0,14
51.0,11
53.0,10
54.0,14
55.0,14
56.0,14
57.0,8
58.0,10
59.0,13
60.0,14
61.0,14
62.0,13
63.0,12
64.0,14
65.0,14
66.0,10
67.0,14
69.0,13
70.0,14
71.0,12
72.0,14
73.0,14
74.0,14
75.0,14
77.0,14
78.0,14
79.0,14
80.0,14
81.0,12
82.0,14
83.0,14
84.0,14
85.0,14
86.0,14
87.0,14
88.0,14
89.0,14
90.0,11
91.0,13
92.0,13
93.0,11
94.0,14
95.0,14
96.0,14
97.0,11
98.0,14
99.0,14
100.0,14
101.0,14
102.0,14
103.0,12
104.0,10
106.0,1
107.0,14
108.0,14

2025-01-23 18:04:03 - root - INFO - SQL:
SELECT "interest_id", "composition", "index_value"
FROM "interest_metrics"
LIMIT 100
Results:
interest_id,composition,index_value
32486.0,11.89,6.19
6106.0,9.93,5.31
18923.0,10.85,5.29
6344.0,10.32,5.1
100.0,10.77,5.04
69.0,10.82,5.03
79.0,11.21,4.97
6111.0,10.71,4.83
6214.0,9.71,4.83
19422.0,10.11,4.81
6110.0,11.57,4.79
4895.0,9.47,4.67
6217.0,10.8,4.62
4.0,13.97,4.53
6218.0,9.29,4.5
6123.0,9.49,4.49
171.0,14.91,4.47
19613.0,12.62,4.38
17.0,7.89,4.15
6.0,11.99,4.08
6013.0,9.35,3.99
4870.0,10.29,3.95
19423.0,12.22,3.92
6089.0,6.97,3.84
161.0,11.48,3.82
6286.0,14.1,3.82
5991.0,11.04,3.81
92.0,9.77,3.77
6184.0,13.35,3.75
19621.0,11.61,3.74
63.0,9.37,3.73
103.0,6.61,3.69
38.0,9.48,3.66
17786.0,13.67,3.65
6232.0,9.97,3.64
165.0,6.05,3.59
18351.0,6.09,3.58
15.0,6.9,3.56
,6.12,2.85
17314.0,10.43,3.55
6151.0,6.83,3.55
4914.0,7.42,3.55
115.0,11.68,3.53
5968.0,12.87,3.53
36.0,9.27,3.51
5943.0,6.37,3.48
133.0,10.91,3.44
1.0,7.02,3.44
114.0,6.25,3.41
6107.0,8.84,3.39
150.0,5.3,3.39
60.0,6.71,3.36
96.0,7.21,3.35
22403.0,12.27,3.33
40.0,10.86,3.32
19758.0,6.28,3.32
17730.0,11.38,3.3
5938.0,11.63,3.29
4869.0,6.47,3.29
4897.0,12.93,3.27
6029.0,8.72,3.26
31.0,7.9,3.26
16137.0,9.65,3.24
6330.0,6.82,3.22
6334.0,11.63,3.22
6315.0,8.14,3.22
4852.0,6.77,3.2
16.0,6.24,3.2
6108.0,6.65,3.17
6206.0,10.76,3.17
6006.0,6.26,3.15
6228.0,10.22,3.15
20768.0,6.53,3.15
4902.0,8.17,3.12
6277.0,11.72,3.1
19757.0,10.95,3.08
4911.0,6.87,3.08
,7.13,2.84
4910.0,6.09,3.07
6285.0,9.97,3.04
11974.0,7.19,3.02
6219.0,6.37,3.02
10250.0,11.4,3.01
6128.0,6.28,2.98
5946.0,5.99,2.97
158.0,7.46,2.97
15935.0,9.13,2.96
4855.0,5.99,2.95
149.0,6.88,2.95
16197.0,6.13,2.94
11067.0,5.14,2.93
17674.0,6.25,2.92
4913.0,6.76,2.92
56.0,7.09,2.91
6341.0,5.68,2.91
6316.0,6.52,2.91
18647.0,6.45,2.91
17803.0,6.21,2.91
23.0,5.41,2.89
132.0,7.48,2.88

2025-01-23 18:04:03 - root - INFO - itercount: 0
2025-01-23 18:04:03 - root - INFO - Table: weekly_salesDDL:
CREATE TABLE "weekly_sales" (
"week_date" TEXT,
  "region" TEXT,
  "platform" TEXT,
  "segment" TEXT,
  "customer_type" TEXT,
  "transactions" INTEGER,
  "sales" INTEGER
)
Table: shopping_cart_usersDDL:
CREATE TABLE "shopping_cart_users" (
"user_id" INTEGER,
  "cookie_id" TEXT,
  "start_date" TEXT
)
Table: bitcoin_membersDDL:
CREATE TABLE "bitcoin_members" (
"member_id" TEXT,
  "first_name" TEXT,
  "region" TEXT
)
Table: interest_metricsDDL:
CREATE TABLE "interest_metrics" (
"_month" REAL,
  "_year" REAL,
  "month_year" TEXT,
  "interest_id" REAL,
  "composition" REAL,
  "index_value" REAL,
  "ranking" INTEGER,
  "percentile_ranking" REAL
)
Table: customer_regionsDDL:
CREATE TABLE "customer_regions" (
"region_id" INTEGER,
  "region_name" TEXT
)
Table: customer_transactionsDDL:
CREATE TABLE "customer_transactions" (
"customer_id" INTEGER,
  "txn_date" TEXT,
  "txn_type" TEXT,
  "txn_amount" INTEGER
)
Table: bitcoin_transactionsDDL:
CREATE TABLE "bitcoin_transactions" (
"txn_id" INTEGER,
  "member_id" TEXT,
  "ticker" TEXT,
  "txn_date" TEXT,
  "txn_type" TEXT,
  "quantity" REAL,
  "percentage_fee" REAL,
  "txn_time" TEXT
)
Table: customer_nodesDDL:
CREATE TABLE "customer_nodes" (
"customer_id" INTEGER,
  "region_id" INTEGER,
  "node_id" INTEGER,
  "start_date" TEXT,
  "end_date" TEXT
)
Table: cleaned_weekly_salesDDL:
CREATE TABLE "cleaned_weekly_sales" (
"week_date_formatted" TEXT,
  "week_date" TEXT,
  "region" TEXT,
  "platform" TEXT,
  "segment" TEXT,
  "customer_type" TEXT,
  "transactions" INTEGER,
  "sales" INTEGER,
  "week_number" INTEGER,
  "month_number" INTEGER,
  "calendar_year" INTEGER,
  "age_band" TEXT,
  "demographic" TEXT,
  "avg_transaction" REAL
)
Table: veg_txn_dfDDL:
CREATE TABLE "veg_txn_df" (
"index" INTEGER,
  "txn_date" TEXT,
  "txn_time" TEXT,
  "item_code" INTEGER,
  "qty_sold(kg)" REAL,
  "unit_selling_px_rmb/kg" REAL,
  "sale/return" TEXT,
  "discount(%)" INTEGER,
  "day_of_week" TEXT
)
Table: shopping_cart_eventsDDL:
CREATE TABLE "shopping_cart_events" (
"visit_id" TEXT,
  "cookie_id" TEXT,
  "page_id" INTEGER,
  "event_type" INTEGER,
  "sequence_number" INTEGER,
  "event_time" TEXT
)
Table: shopping_cart_page_hierarchyDDL:
CREATE TABLE "shopping_cart_page_hierarchy" (
"page_id" INTEGER,
  "page_name" TEXT,
  "product_category" TEXT,
  "product_id" REAL
)
Table: bitcoin_pricesDDL:
CREATE TABLE "bitcoin_prices" (
"ticker" TEXT,
  "market_date" TEXT,
  "price" REAL,
  "open" REAL,
  "high" REAL,
  "low" REAL,
  "volume" TEXT,
  "change" TEXT
)
Table: interest_mapDDL:
CREATE TABLE "interest_map" (
"id" INTEGER,
  "interest_name" TEXT,
  "interest_summary" TEXT,
  "created_at" TEXT,
  "last_modified" TEXT
)
Table: veg_loss_rate_dfDDL:
CREATE TABLE "veg_loss_rate_df" (
"index" INTEGER,
  "item_code" INTEGER,
  "item_name" TEXT,
  "loss_rate_%" REAL
)
Table: shopping_cart_campaign_identifierDDL:
CREATE TABLE "shopping_cart_campaign_identifier" (
"campaign_id" INTEGER,
  "products" TEXT,
  "campaign_name" TEXT,
  "start_date" TEXT,
  "end_date" TEXT
)
Table: veg_catDDL:
CREATE TABLE "veg_cat" (
"index" INTEGER,
  "item_code" INTEGER,
  "item_name" TEXT,
  "category_code" INTEGER,
  "category_name" TEXT
)
Table: veg_whsle_dfDDL:
CREATE TABLE "veg_whsle_df" (
"index" INTEGER,
  "whsle_date" TEXT,
  "item_code" INTEGER,
  "whsle_px_rmb-kg" REAL
)
Table: shopping_cart_event_identifierDDL:
CREATE TABLE "shopping_cart_event_identifier" (
"event_type" INTEGER,
  "event_name" TEXT
)
External knowledge that might be helpful: 
None
The table structure information is (table names): 
['weekly_sales', 'shopping_cart_users', 'bitcoin_members', 'interest_metrics', 'customer_regions', 'customer_transactions', 'bitcoin_transactions', 'customer_nodes', 'cleaned_weekly_sales', 'veg_txn_df', 'shopping_cart_events', 'shopping_cart_page_hierarchy', 'bitcoin_prices', 'interest_map', 'veg_loss_rate_df', 'shopping_cart_campaign_identifier', 'veg_cat', 'veg_whsle_df', 'shopping_cart_event_identifier']
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table:** `interest_metrics`
  - **"month_year"**: Used to display the time in MM-YYYY format.
  - **"interest_id"**: Used to identify interest categories; will join with `interest_map` to get the interest names.
  - **"composition"**: Composition value for each interest category, needed to determine the highest values.
  
- **Table:** `interest_map`
  - **"id"**: Corresponds to `interest_metrics`.`interest_id`; used for joining tables.
  - **"interest_name"**: Name of the interest category; needed for display.

**Conditions and Usage:**

- **Join Condition**: `interest_metrics`.`interest_id` = `interest_map`.`id`
- **Aggregation**: Find the maximum composition value for each interest category across all months.
- **Ordering**: Sort the interest categories based on their highest composition values to find the top 10 and bottom 10.
- **Display**: For each selected category, display the time (MM-YYYY), interest name, and the composition value.

**SQL Queries to Explore the Data:**

1. **List all distinct months and years available:**
   ```sql
   SELECT DISTINCT "month_year"
   FROM "interest_metrics"
   LIMIT 100;
   ```

2. **List all distinct interest IDs:**
   ```sql
   SELECT DISTINCT "interest_id"
   FROM "interest_metrics"
   LIMIT 100;
   ```

3. **List all interest names:**
   ```sql
   SELECT DISTINCT "interest_name"
   FROM "interest_map"
   LIMIT 100;
   ```

4. **View composition values in descending order:**
   ```sql
   SELECT "composition"
   FROM "interest_metrics"
   ORDER BY "composition" DESC
   LIMIT 100;
   ```

5. **View composition values in ascending order:**
   ```sql
   SELECT "composition"
   FROM "interest_metrics"
   ORDER BY "composition" ASC
   LIMIT 100;
   ```

6. **See interest IDs with their composition values:**
   ```sql
   SELECT "interest_id", "composition"
   FROM "interest_metrics"
   LIMIT 100;
   ```

7. **Map interest IDs to interest names:**
   ```sql
   SELECT "id", "interest_name"
   FROM "interest_map"
   LIMIT 100;
   ```

8. **Find maximum composition value for each interest ID:**
   ```sql
   SELECT "interest_id", MAX("composition") AS "max_composition"
   FROM "interest_metrics"
   GROUP BY "interest_id"
   ORDER BY "max_composition" DESC
   LIMIT 100;
   ```

9. **Find minimum composition value for each interest ID:**
   ```sql
   SELECT "interest_id", MIN("composition") AS "min_composition"
   FROM "interest_metrics"
   GROUP BY "interest_id"
   ORDER BY "min_composition" ASC
   LIMIT 100;
   ```

10. **Get interest names with their maximum composition values:**
    ```sql
    SELECT im."interest_name", MAX(m."composition") AS "max_composition"
    FROM "interest_metrics" AS m
    JOIN "interest_map" AS im ON m."interest_id" = im."id"
    GROUP BY im."interest_name"
    ORDER BY "max_composition" DESC
    LIMIT 100;
    ```

11. **Retrieve time, interest ID, and composition for high composition values:**
    ```sql
    SELECT "month_year", "interest_id", "composition"
    FROM "interest_metrics"
    WHERE "composition" > 0.9
    ORDER BY "composition" DESC
    LIMIT 100;
    ```

12. **List all interest categories with their percentile rankings:**
    ```sql
    SELECT "interest_id", "percentile_ranking"
    FROM "interest_metrics"
    LIMIT 100;
    ```

13. **Find the month and year when each interest had its maximum composition:**
    ```sql
    SELECT "interest_id", "month_year", MAX("composition") AS "max_composition"
    FROM "interest_metrics"
    GROUP BY "interest_id"
    LIMIT 100;
    ```

14. **Get the top 10 interest categories by average composition:**
    ```sql
    SELECT "interest_id", AVG("composition") AS "avg_composition"
    FROM "interest_metrics"
    GROUP BY "interest_id"
    ORDER BY "avg_composition" DESC
    LIMIT 10;
    ```

15. **Get the bottom 10 interest categories by average composition:**
    ```sql
    SELECT "interest_id", AVG("composition") AS "avg_composition"
    FROM "interest_metrics"
    GROUP BY "interest_id"
    ORDER BY "avg_composition" ASC
    LIMIT 10;
    ```

16. **Show interest names and their average index values:**
    ```sql
    SELECT im."interest_name", AVG(m."index_value") AS "avg_index_value"
    FROM "interest_metrics" AS m
    JOIN "interest_map" AS im ON m."interest_id" = im."id"
    GROUP BY im."interest_name"
    LIMIT 100;
    ```

17. **List the rankings of interest categories for a specific month:**
    ```sql
    SELECT m."month_year", im."interest_name", m."ranking"
    FROM "interest_metrics" AS m
    JOIN "interest_map" AS im ON m."interest_id" = im."id"
    WHERE m."month_year" = '01-2020'
    ORDER BY m."ranking" ASC
    LIMIT 100;
    ```

18. **Find interest categories with composition above a certain threshold:**
    ```sql
    SELECT im."interest_name", m."composition"
    FROM "interest_metrics" AS m
    JOIN "interest_map" AS im ON m."interest_id" = im."id"
    WHERE m."composition" > 0.5
    LIMIT 100;
    ```

19. **Count the number of times each interest category appears:**
    ```sql
    SELECT "interest_id", COUNT(*) AS "occurrences"
    FROM "interest_metrics"
    GROUP BY "interest_id"
    LIMIT 100;
    ```

20. **Retrieve the composition values along with index values:**
    ```sql
    SELECT "interest_id", "composition", "index_value"
    FROM "interest_metrics"
    LIMIT 100;
    ```

These queries help in understanding the data structure and content of the relevant tables, which is essential for performing the required analysis.Query:
SELECT DISTINCT "month_year"
   FROM "interest_metrics"
   LIMIT 100;
Answer:
month_year
07-2018
""
08-2018
09-2018
10-2018
11-2018
12-2018
01-2019
02-2019
03-2019
04-2019
05-2019
06-2019
07-2019
08-2019
Query:
SELECT DISTINCT "interest_id"
   FROM "interest_metrics"
   LIMIT 100;
Answer:
interest_id
32486.0
6106.0
18923.0
6344.0
100.0
69.0
79.0
6111.0
6214.0
19422.0
6110.0
4895.0
6217.0
4.0
6218.0
6123.0
171.0
19613.0
17.0
6.0
6013.0
4870.0
19423.0
6089.0
161.0
6286.0
5991.0
92.0
6184.0
19621.0
63.0
103.0
38.0
17786.0
6232.0
165.0
18351.0
15.0
""
17314.0
6151.0
4914.0
115.0
5968.0
36.0
5943.0
133.0
1.0
114.0
6107.0
150.0
60.0
96.0
22403.0
40.0
19758.0
17730.0
5938.0
4869.0
4897.0
6029.0
31.0
16137.0
6330.0
6334.0
6315.0
4852.0
16.0
6108.0
6206.0
6006.0
6228.0
20768.0
4902.0
6277.0
19757.0
4911.0
4910.0
6285.0
11974.0
6219.0
10250.0
6128.0
5946.0
158.0
15935.0
4855.0
149.0
16197.0
11067.0
17674.0
4913.0
56.0
6341.0
6316.0
18647.0
17803.0
23.0
132.0
6365.0
Query:
SELECT DISTINCT "interest_name"
   FROM "interest_map"
   LIMIT 100;
Answer:
interest_name
Fitness Enthusiasts
Gamers
Car Enthusiasts
Luxury Retail Researchers
Brides & Wedding Planners
Vacation Planners
Motorcycle Enthusiasts
Business News Readers
Thrift Store Shoppers
Advertising Professionals
NFL Fans
NBA Fans
NCAA Fans
MLB Fans
Nascar Fans
Eco-Conscious Consumers
Moviegoers
DIYers
Grill Masters
Techies
Home Design Enthusiasts
Doctors
Streaming Video Fans
Auto Insurance Shoppers
Teachers
College Students
Department Store Shoppers
Home Decor Shoppers
Kids Clothing Shoppers
Teen Girl Clothing Shoppers
Mens Clothing Shoppers
Baby Products Buyers
Jewelry & Watch Shoppers
Sporting Goods Shoppers
Furniture Shoppers
Bed & Bath Shoppers
Intimates Shoppers
Fast Fashion Shoppers
Apartment Hunters
Home Buyers
Moving Services Shoppers
Job Seekers
Charitable Donors
NHL Fans
Discount Big Box Shoppers
Black Friday Deal Shoppers
Hip Hop Fans
Online Investors
Seasonal Allergy Sufferers
Discount Device Shoppers
Mobile Phone Comparison Shoppers
Budget Wireless Shoppers
Menopause Researchers
Online Health Researchers
Beauty & Skincare Buyers
Streaming Device Shoppers
New & Expecting Parents
High-End Kids Furniture and Clothes Shoppers
Hands-On Parents
Fantasy & Comic Fans
Lawyers
Healthy Eaters
Drug Store Shoppers
Lawn & Garden Enthusiasts
Nurses
Mailing & Shipping Shoppers
Office Supply Shoppers
Ink & Toner Shoppers
Luxury Retail Shoppers
Contractors & Construction Professionals
Luxury Travel Researchers
Democrats
Republicans
HDTV Researchers
Hardware Shoppers
Reggaeton Fans
Online Movie Downloaders
Sale Seekers
Theme Park Researchers
Ski and Snowboard Enthusiasts
Travel Researchers
Coupon Researchers
Parents with Toddlers
Parents with Kids
Young Boomers
Day Care Users
Stay-at-Home Parents
Exercise and Gym Researchers
Home Kitchen Chefs
Restaurant Researchers
Order-in Eaters
Nutrition Conscious Eaters
Flower & Gift Basket Shoppers
Plus Size Women
Live Concert Fans
Country Music Fans
Comedy Fans
Cruise Travel Intenders
Pain Medication Users
Joint Pain Sufferers
Query:
SELECT "composition"
   FROM "interest_metrics"
   ORDER BY "composition" DESC
   LIMIT 100;
Answer:
composition
21.2
20.28
19.45
18.99
18.82
18.39
18.18
17.44
17.19
15.15
15.05
14.92
14.92
14.91
14.39
14.29
14.23
14.15
14.1
13.97
13.9
13.81
13.67
13.64
13.35
13.03
12.93
12.87
12.85
12.8
12.73
12.68
12.64
12.64
12.62
12.62
12.56
12.47
12.42
12.41
12.41
12.33
12.3
12.27
12.26
12.22
12.16
12.03
11.99
11.97
11.93
11.93
11.89
11.75
11.74
11.74
11.73
11.72
11.71
11.68
11.63
11.63
11.61
11.57
11.57
11.5
11.48
11.4
11.38
11.27
11.23
11.21
11.18
11.15
11.14
11.1
11.08
11.06
11.06
11.04
11.03
11.01
11.0
10.99
10.99
10.96
10.95
10.95
10.91
10.91
10.89
10.88
10.86
10.85
10.85
10.82
10.82
10.8
10.79
10.77
Query:
SELECT "composition"
   FROM "interest_metrics"
   ORDER BY "composition" ASC
   LIMIT 100;
Answer:
composition
1.51
1.51
1.52
1.52
1.52
1.52
1.52
1.52
1.52
1.52
1.52
1.53
1.53
1.53
1.53
1.54
1.54
1.54
1.54
1.54
1.54
1.54
1.54
1.54
1.54
1.54
1.54
1.54
1.54
1.54
1.54
1.55
1.55
1.55
1.55
1.55
1.55
1.55
1.55
1.55
1.55
1.55
1.55
1.55
1.55
1.55
1.55
1.55
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.56
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.57
1.58
1.58
1.58
1.58
Query:
SELECT "interest_id", "composition"
   FROM "interest_metrics"
   LIMIT 100;
Answer:
interest_id,composition
32486.0,11.89
6106.0,9.93
18923.0,10.85
6344.0,10.32
100.0,10.77
69.0,10.82
79.0,11.21
6111.0,10.71
6214.0,9.71
19422.0,10.11
6110.0,11.57
4895.0,9.47
6217.0,10.8
4.0,13.97
6218.0,9.29
6123.0,9.49
171.0,14.91
19613.0,12.62
17.0,7.89
6.0,11.99
6013.0,9.35
4870.0,10.29
19423.0,12.22
6089.0,6.97
161.0,11.48
6286.0,14.1
5991.0,11.04
92.0,9.77
6184.0,13.35
19621.0,11.61
63.0,9.37
103.0,6.61
38.0,9.48
17786.0,13.67
6232.0,9.97
165.0,6.05
18351.0,6.09
15.0,6.9
,6.12
17314.0,10.43
6151.0,6.83
4914.0,7.42
115.0,11.68
5968.0,12.87
36.0,9.27
5943.0,6.37
133.0,10.91
1.0,7.02
114.0,6.25
6107.0,8.84
150.0,5.3
60.0,6.71
96.0,7.21
22403.0,12.27
40.0,10.86
19758.0,6.28
17730.0,11.38
5938.0,11.63
4869.0,6.47
4897.0,12.93
6029.0,8.72
31.0,7.9
16137.0,9.65
6330.0,6.82
6334.0,11.63
6315.0,8.14
4852.0,6.77
16.0,6.24
6108.0,6.65
6206.0,10.76
6006.0,6.26
6228.0,10.22
20768.0,6.53
4902.0,8.17
6277.0,11.72
19757.0,10.95
4911.0,6.87
,7.13
4910.0,6.09
6285.0,9.97
11974.0,7.19
6219.0,6.37
10250.0,11.4
6128.0,6.28
5946.0,5.99
158.0,7.46
15935.0,9.13
4855.0,5.99
149.0,6.88
16197.0,6.13
11067.0,5.14
17674.0,6.25
4913.0,6.76
56.0,7.09
6341.0,5.68
6316.0,6.52
18647.0,6.45
17803.0,6.21
23.0,5.41
132.0,7.48
Query:
SELECT "id", "interest_name"
   FROM "interest_map"
   LIMIT 100;
Answer:
id,interest_name
1,Fitness Enthusiasts
2,Gamers
3,Car Enthusiasts
4,Luxury Retail Researchers
5,Brides & Wedding Planners
6,Vacation Planners
7,Motorcycle Enthusiasts
8,Business News Readers
12,Thrift Store Shoppers
13,Advertising Professionals
14,NFL Fans
15,NBA Fans
16,NCAA Fans
17,MLB Fans
18,Nascar Fans
19,Eco-Conscious Consumers
20,Moviegoers
21,DIYers
22,Grill Masters
23,Techies
24,Home Design Enthusiasts
25,Doctors
26,Streaming Video Fans
27,Auto Insurance Shoppers
28,Teachers
29,College Students
30,Department Store Shoppers
31,Home Decor Shoppers
33,Kids Clothing Shoppers
34,Teen Girl Clothing Shoppers
35,Mens Clothing Shoppers
36,Baby Products Buyers
37,Jewelry & Watch Shoppers
38,Sporting Goods Shoppers
39,Furniture Shoppers
40,Bed & Bath Shoppers
41,Intimates Shoppers
42,Fast Fashion Shoppers
43,Apartment Hunters
44,Home Buyers
45,Moving Services Shoppers
46,Job Seekers
48,Charitable Donors
49,NHL Fans
50,Discount Big Box Shoppers
51,Black Friday Deal Shoppers
53,Hip Hop Fans
54,Online Investors
55,Seasonal Allergy Sufferers
56,Discount Device Shoppers
57,Mobile Phone Comparison Shoppers
58,Budget Wireless Shoppers
59,Menopause Researchers
60,Online Health Researchers
61,Beauty & Skincare Buyers
62,Streaming Device Shoppers
63,New & Expecting Parents
64,High-End Kids Furniture and Clothes Shoppers
65,Hands-On Parents
66,Fantasy & Comic Fans
67,Lawyers
69,Healthy Eaters
70,Drug Store Shoppers
71,Lawn & Garden Enthusiasts
72,Nurses
73,Mailing & Shipping Shoppers
74,Office Supply Shoppers
75,Ink & Toner Shoppers
77,Luxury Retail Shoppers
78,Contractors & Construction Professionals
79,Luxury Travel Researchers
80,Democrats
81,Republicans
82,HDTV Researchers
83,Hardware Shoppers
84,Reggaeton Fans
85,Online Movie Downloaders
86,Sale Seekers
87,Theme Park Researchers
88,Ski and Snowboard Enthusiasts
89,Travel Researchers
90,Coupon Researchers
91,Parents with Toddlers
92,Parents with Kids
93,Young Boomers
94,Day Care Users
95,Stay-at-Home Parents
96,Exercise and Gym Researchers
97,Home Kitchen Chefs
98,Restaurant Researchers
99,Order-in Eaters
100,Nutrition Conscious Eaters
101,Flower & Gift Basket Shoppers
102,Plus Size Women
103,Live Concert Fans
104,Country Music Fans
106,Comedy Fans
107,Cruise Travel Intenders
108,Pain Medication Users
109,Joint Pain Sufferers
Query:
SELECT "interest_id", MAX("composition") AS "max_composition"
   FROM "interest_metrics"
   GROUP BY "interest_id"
   ORDER BY "max_composition" DESC
   LIMIT 100;
Answer:
interest_id,max_composition
21057.0,21.2
6284.0,18.82
39.0,17.44
77.0,17.19
12133.0,15.15
5969.0,15.05
171.0,14.91
4898.0,14.23
6286.0,14.1
4.0,13.97
17786.0,13.67
6184.0,13.35
19298.0,13.03
4897.0,12.93
5968.0,12.87
19613.0,12.62
6.0,12.56
64.0,12.41
22403.0,12.27
19423.0,12.22
10977.0,12.16
158.0,11.97
32486.0,11.89
6277.0,11.72
115.0,11.68
6334.0,11.63
5938.0,11.63
19621.0,11.61
6110.0,11.57
161.0,11.48
10250.0,11.4
17730.0,11.38
34.0,11.23
79.0,11.21
5991.0,11.04
19757.0,10.95
133.0,10.91
40.0,10.86
18923.0,10.85
69.0,10.82
5.0,10.82
6217.0,10.8
100.0,10.77
6206.0,10.76
6111.0,10.71
4943.0,10.7
10981.0,10.62
5960.0,10.61
6343.0,10.54
41548.0,10.46
17314.0,10.43
21237.0,10.36
6344.0,10.32
6324.0,10.3
4870.0,10.29
5944.0,10.24
6228.0,10.22
89.0,10.14
19422.0,10.11
6029.0,10.05
82.0,9.99
7541.0,9.98
6285.0,9.97
6232.0,9.97
6106.0,9.93
18783.0,9.83
92.0,9.77
6214.0,9.71
6208.0,9.67
,9.66
16137.0,9.65
6378.0,9.64
6123.0,9.49
38.0,9.48
4895.0,9.47
10008.0,9.46
4944.0,9.46
141.0,9.46
63.0,9.37
6013.0,9.35
6308.0,9.33
6218.0,9.29
36.0,9.27
6112.0,9.22
5970.0,9.21
18619.0,9.15
15935.0,9.13
13497.0,9.03
21061.0,8.97
10009.0,8.95
6107.0,8.84
16138.0,8.81
5911.0,8.69
60.0,8.66
15879.0,8.65
17269.0,8.64
21060.0,8.58
30.0,8.56
7425.0,8.54
21058.0,8.5
Query:
SELECT "interest_id", MIN("composition") AS "min_composition"
   FROM "interest_metrics"
   GROUP BY "interest_id"
   ORDER BY "min_composition" ASC
   LIMIT 100;
Answer:
interest_id,min_composition
,1.51
45524.0,1.51
4918.0,1.52
16198.0,1.52
17274.0,1.52
20768.0,1.52
34083.0,1.52
34645.0,1.52
35742.0,1.52
39336.0,1.52
44449.0,1.52
6127.0,1.53
6314.0,1.53
34951.0,1.53
36877.0,1.53
53.0,1.54
4847.0,1.54
18203.0,1.54
18620.0,1.54
21247.0,1.54
22408.0,1.54
33969.0,1.54
34647.0,1.54
38364.0,1.54
39190.0,1.54
42000.0,1.54
44482.0,1.54
49502.0,1.54
66.0,1.55
165.0,1.55
4867.0,1.55
6138.0,1.55
6222.0,1.55
6228.0,1.55
6365.0,1.55
18351.0,1.55
21243.0,1.55
34642.0,1.55
37881.0,1.55
39195.0,1.55
41062.0,1.55
45522.0,1.55
13.0,1.56
14.0,1.56
71.0,1.56
4920.0,1.56
6010.0,1.56
6050.0,1.56
6076.0,1.56
6131.0,1.56
7453.0,1.56
19599.0,1.56
19631.0,1.56
19635.0,1.56
20753.0,1.56
20756.0,1.56
37410.0,1.56
37417.0,1.56
39337.0,1.56
39767.0,1.56
39770.0,1.56
41061.0,1.56
44459.0,1.56
44471.0,1.56
44485.0,1.56
169.0,1.57
4855.0,1.57
4899.0,1.57
4910.0,1.57
6169.0,1.57
6316.0,1.57
19611.0,1.57
21244.0,1.57
33970.0,1.57
34087.0,1.57
34948.0,1.57
36343.0,1.57
38283.0,1.57
38991.0,1.57
40194.0,1.57
41076.0,1.57
41195.0,1.57
42008.0,1.57
44579.0,1.57
45528.0,1.57
49973.0,1.57
8.0,1.58
24.0,1.58
27.0,1.58
59.0,1.58
164.0,1.58
6162.0,1.58
6332.0,1.58
19296.0,1.58
21246.0,1.58
22095.0,1.58
22400.0,1.58
33963.0,1.58
33964.0,1.58
33968.0,1.58
Query:
SELECT im."interest_name", MAX(m."composition") AS "max_composition"
    FROM "interest_metrics" AS m
    JOIN "interest_map" AS im ON m."interest_id" = im."id"
    GROUP BY im."interest_name"
    ORDER BY "max_composition" DESC
    LIMIT 100;
Answer:
interest_name,max_composition
Work Comes First Travelers,21.2
Gym Equipment Owners,18.82
Furniture Shoppers,17.44
Luxury Retail Shoppers,17.19
Luxury Boutique Hotel Researchers,15.15
Luxury Bedding Shoppers,15.05
Shoe Shoppers,14.91
Cosmetics and Beauty Shoppers,14.23
Luxury Hotel Guests,14.1
Luxury Retail Researchers,13.97
Womens Fashion Brands Shoppers,13.67
Reusable Drinkware Shoppers,13.35
Beach Supplies Shoppers,13.03
Parents of Teenagers Going to College,12.93
Luxury Kitchen Goods Shoppers,12.87
Land Rover Shoppers,12.62
Vacation Planners,12.56
High-End Kids Furniture and Clothes Shoppers,12.41
Pandora Jewelry Shoppers,12.27
Kitchen Appliance Shoppers,12.22
Christmas Celebration Researchers,12.16
Flight and Hotel Shoppers,11.97
Vacation Rental Accommodation Researchers,11.89
Harry Potter Fans,11.72
Mens Shoe Shoppers,11.68
Supermarket Shoppers,11.63
Costa Rica Trip Planners,11.63
Portugal Trip Planners,11.61
Apartment Furniture Shoppers,11.57
Travel Reward Points Enthusiasts,11.48
Halloween Costume Shoppers,11.4
Luxury Department Store Shoppers,11.38
Teen Girl Clothing Shoppers,11.23
Luxury Travel Researchers,11.21
Gluten-Free Recipe Researchers,11.04
Natural Pet Food Shoppers,10.95
High End Camera Shoppers - Dupe,10.91
Bed & Bath Shoppers,10.86
Online Home Decor Shoppers,10.85
Healthy Eaters,10.82
Brides & Wedding Planners,10.82
Weight Loss Researchers,10.8
Nutrition Conscious Eaters,10.77
Preppy Clothing Shoppers,10.76
Wine Lovers,10.71
Online Grocery Shoppers,10.7
New Years Eve Party Ticket Purchasers,10.62
New Zealand Trip Planners,10.61
Patio Furniture Shoppers,10.54
Winter Apparel Shoppers,10.46
Lobbyists,10.43
Chelsea Fans,10.36
Hair Care Shoppers,10.32
Las Vegas Trip Planners,10.3
Tech-Savvy Moms,10.29
Financial Advisors,10.24
Paleo Eaters,10.22
Travel Researchers,10.14
Home Design and Living Publication Readers,10.11
Indoor Cycling & Spinning Enthusiasts,10.05
HDTV Researchers,9.99
Alabama Trip Planners,9.98
Golf Enthusiasts,9.97
Competitive Tri-Athletes,9.97
Luxury Second Home Owners,9.93
Nursing and Physicians Assistant Journal Researchers,9.83
Parents with Kids,9.77
Home Remodelers,9.71
Recently Retired Individuals,9.67
Olympics Fans,9.65
Luggage Shoppers,9.64
Misc-Deal Seekers or Coupon Shoppers,9.49
Sporting Goods Shoppers,9.48
Mature Parents,9.47
Skin Care Researchers,9.46
Pre-Measured Grocery Shoppers,9.46
Japanese Luxury Car Enthusiasts,9.46
New & Expecting Parents,9.37
Competitive Sports Participants,9.35
Food Safety Decision Makers,9.33
Running Enthusiasts,9.29
Baby Products Buyers,9.27
Olympic Sports Enthusiasts,9.22
Luxury Home Fixture Shoppers,9.21
Asian Food Enthusiasts,9.15
Pregnancy Resources Researchers,9.13
Restaurant Supply Shoppers,9.03
"Work Hard, Play Hard Travelers",8.97
Investment Services Intenders,8.95
Ski House Second Home Owners,8.84
Special Olympics Fans,8.81
Credit Score Researchers,8.69
Online Health Researchers,8.66
Freelancers,8.65
At-Home Gym Intenders,8.64
Family Adventures Travelers,8.58
Department Store Shoppers,8.56
Life Insurance Researchers,8.54
Mid-Range Grocery Shoppers,8.5
Countdown to the Beach Travelers,8.5
Query:
SELECT "month_year", "interest_id", "composition"
    FROM "interest_metrics"
    WHERE "composition" > 0.9
    ORDER BY "composition" DESC
    LIMIT 100;
Answer:
month_year,interest_id,composition
12-2018,21057.0,21.2
10-2018,21057.0,20.28
11-2018,21057.0,19.45
01-2019,21057.0,18.99
07-2018,6284.0,18.82
02-2019,21057.0,18.39
09-2018,21057.0,18.18
07-2018,39.0,17.44
07-2018,77.0,17.19
10-2018,12133.0,15.15
12-2018,5969.0,15.05
11-2018,5969.0,14.92
01-2019,5969.0,14.92
07-2018,171.0,14.91
02-2019,5969.0,14.39
09-2018,5969.0,14.29
07-2018,4898.0,14.23
10-2018,5969.0,14.15
07-2018,6286.0,14.1
07-2018,4.0,13.97
08-2018,6284.0,13.9
12-2018,12133.0,13.81
07-2018,17786.0,13.67
02-2019,12133.0,13.64
07-2018,6184.0,13.35
10-2018,19298.0,13.03
07-2018,4897.0,12.93
07-2018,5968.0,12.87
02-2019,19298.0,12.85
09-2018,12133.0,12.8
08-2018,77.0,12.73
11-2018,12133.0,12.68
10-2018,6284.0,12.64
03-2019,12133.0,12.64
07-2018,19613.0,12.62
12-2018,19298.0,12.62
10-2018,6.0,12.56
10-2018,6286.0,12.47
08-2018,21057.0,12.42
12-2018,64.0,12.41
02-2019,6286.0,12.41
10-2018,64.0,12.33
03-2019,5969.0,12.3
07-2018,22403.0,12.27
01-2019,12133.0,12.26
07-2018,19423.0,12.22
10-2018,10977.0,12.16
08-2018,39.0,12.03
07-2018,6.0,11.99
10-2018,158.0,11.97
09-2018,64.0,11.93
11-2018,19298.0,11.93
07-2018,32486.0,11.89
01-2019,64.0,11.75
09-2018,19298.0,11.74
12-2018,77.0,11.74
10-2018,77.0,11.73
07-2018,6277.0,11.72
01-2019,19298.0,11.71
07-2018,115.0,11.68
07-2018,5938.0,11.63
07-2018,6334.0,11.63
07-2018,19621.0,11.61
07-2018,6110.0,11.57
12-2018,10977.0,11.57
12-2018,6286.0,11.5
07-2018,161.0,11.48
07-2018,10250.0,11.4
07-2018,17730.0,11.38
03-2019,19298.0,11.27
12-2018,34.0,11.23
07-2018,79.0,11.21
09-2018,6286.0,11.18
07-2018,5969.0,11.15
11-2018,6286.0,11.14
10-2018,39.0,11.1
12-2018,6.0,11.08
09-2018,6284.0,11.06
11-2018,6284.0,11.06
07-2018,5991.0,11.04
02-2019,6.0,11.03
04-2019,5969.0,11.01
10-2018,19621.0,11.0
02-2019,64.0,10.99
03-2019,6286.0,10.99
01-2019,10977.0,10.96
07-2018,19757.0,10.95
07-2018,21057.0,10.95
07-2018,133.0,10.91
12-2018,6284.0,10.91
10-2018,10250.0,10.89
11-2018,10977.0,10.88
07-2018,40.0,10.86
07-2018,18923.0,10.85
08-2018,5969.0,10.85
07-2018,69.0,10.82
07-2018,5.0,10.82
07-2018,6217.0,10.8
07-2018,12133.0,10.79
07-2018,100.0,10.77
Query:
SELECT "interest_id", "percentile_ranking"
    FROM "interest_metrics"
    LIMIT 100;
Answer:
interest_id,percentile_ranking
32486.0,99.86
6106.0,99.73
18923.0,99.59
6344.0,99.45
100.0,99.31
69.0,99.18
79.0,99.04
6111.0,98.9
6214.0,98.9
19422.0,98.63
6110.0,98.49
4895.0,98.35
6217.0,98.22
4.0,98.08
6218.0,97.94
6123.0,97.81
171.0,97.67
19613.0,97.53
17.0,97.39
6.0,97.26
6013.0,97.12
4870.0,96.98
19423.0,96.84
6089.0,96.71
161.0,96.57
6286.0,96.57
5991.0,96.3
92.0,96.16
6184.0,96.02
19621.0,95.88
63.0,95.75
103.0,95.61
38.0,95.47
17786.0,95.34
6232.0,95.2
165.0,95.06
18351.0,94.92
15.0,94.79
,96.4
17314.0,94.65
6151.0,94.65
4914.0,94.65
115.0,94.24
5968.0,94.24
36.0,93.96
5943.0,93.83
133.0,93.69
1.0,93.69
114.0,93.42
6107.0,93.28
150.0,93.28
60.0,93.0
96.0,92.87
22403.0,92.73
40.0,92.59
19758.0,92.59
17730.0,92.32
5938.0,92.18
4869.0,92.18
4897.0,91.91
6029.0,91.77
31.0,91.77
16137.0,91.5
6330.0,91.36
6334.0,91.36
6315.0,91.36
4852.0,90.95
16.0,90.95
6108.0,90.67
6206.0,90.67
6006.0,90.4
6228.0,90.4
20768.0,90.4
4902.0,89.99
6277.0,89.85
19757.0,89.71
4911.0,89.71
,96.23
4910.0,89.44
6285.0,89.3
11974.0,89.16
6219.0,89.16
10250.0,88.89
6128.0,88.75
5946.0,88.61
158.0,88.61
15935.0,88.34
4855.0,88.2
149.0,88.2
16197.0,87.93
11067.0,87.79
17674.0,87.65
4913.0,87.65
56.0,87.38
6341.0,87.38
6316.0,87.38
18647.0,87.38
17803.0,87.38
23.0,86.69
132.0,86.56
Query:
SELECT "interest_id", "month_year", MAX("composition") AS "max_composition"
    FROM "interest_metrics"
    GROUP BY "interest_id"
    LIMIT 100;
Answer:
interest_id,month_year,max_composition
,,9.66
1.0,07-2018,7.02
2.0,02-2019,3.09
3.0,07-2018,6.14
4.0,07-2018,13.97
5.0,07-2018,10.82
6.0,10-2018,12.56
7.0,07-2018,2.64
8.0,07-2018,6.67
12.0,07-2018,7.23
13.0,07-2018,6.72
14.0,07-2018,3.53
15.0,07-2018,6.9
16.0,07-2018,6.24
17.0,07-2018,7.89
18.0,07-2018,3.18
19.0,07-2018,6.57
20.0,07-2018,4.08
21.0,10-2018,5.26
22.0,07-2018,6.26
23.0,07-2018,5.41
24.0,07-2018,6.54
25.0,07-2018,4.31
26.0,07-2018,6.01
27.0,07-2018,6.81
28.0,10-2018,7.36
29.0,07-2018,5.2
30.0,10-2018,8.56
31.0,07-2018,7.9
33.0,07-2018,7.6
34.0,12-2018,11.23
35.0,07-2018,5.25
36.0,07-2018,9.27
37.0,07-2018,7.82
38.0,07-2018,9.48
39.0,07-2018,17.44
40.0,07-2018,10.86
41.0,07-2018,6.96
42.0,07-2018,4.9
43.0,07-2018,5.98
44.0,07-2018,6.11
45.0,07-2018,6.29
46.0,07-2018,3.4
48.0,10-2018,5.55
49.0,07-2018,5.09
50.0,10-2018,3.86
51.0,07-2018,2.67
53.0,07-2018,3.03
54.0,10-2018,3.88
55.0,10-2018,7.67
56.0,07-2018,7.09
57.0,07-2018,2.32
58.0,07-2018,2.18
59.0,07-2018,3.97
60.0,10-2018,8.66
61.0,07-2018,6.59
62.0,07-2018,4.15
63.0,07-2018,9.37
64.0,12-2018,12.41
65.0,07-2018,5.94
66.0,07-2018,6.51
67.0,10-2018,6.76
69.0,07-2018,10.82
70.0,07-2018,6.96
71.0,07-2018,3.43
72.0,07-2018,3.63
73.0,07-2018,7.06
74.0,07-2018,7.37
75.0,07-2018,7.23
77.0,07-2018,17.19
78.0,10-2018,2.78
79.0,07-2018,11.21
80.0,07-2018,4.47
81.0,07-2018,3.31
82.0,07-2018,9.99
83.0,10-2018,4.64
84.0,02-2019,3.88
85.0,07-2018,6.46
86.0,07-2018,6.13
87.0,07-2018,5.01
88.0,07-2018,4.99
89.0,10-2018,10.14
90.0,07-2018,5.91
91.0,07-2018,5.87
92.0,07-2018,9.77
93.0,07-2018,7.08
94.0,07-2018,3.52
95.0,07-2018,7.15
96.0,07-2018,7.21
97.0,07-2018,6.41
98.0,07-2018,7.64
99.0,07-2018,6.79
100.0,07-2018,10.77
101.0,07-2018,7.38
102.0,07-2018,7.74
103.0,07-2018,6.61
104.0,07-2018,5.42
106.0,07-2018,1.83
107.0,07-2018,8.32
108.0,07-2018,4.24
Query:
SELECT "interest_id", AVG("composition") AS "avg_composition"
    FROM "interest_metrics"
    GROUP BY "interest_id"
    ORDER BY "avg_composition" DESC
    LIMIT 10;
Answer:
interest_id,avg_composition
21057.0,17.4825
5969.0,11.093571428571428
6284.0,10.48642857142857
12133.0,10.43357142857143
77.0,9.762142857142857
19298.0,9.51142857142857
39.0,9.507857142857143
6286.0,9.36357142857143
64.0,8.86357142857143
10977.0,8.622142857142856
Query:
SELECT "interest_id", AVG("composition") AS "avg_composition"
    FROM "interest_metrics"
    GROUP BY "interest_id"
    ORDER BY "avg_composition" ASC
    LIMIT 10;
Answer:
interest_id,avg_composition
34951.0,1.57
42008.0,1.57
34950.0,1.59
15882.0,1.6533333333333333
16198.0,1.6580000000000001
42401.0,1.66
17274.0,1.69
42012.0,1.73
33958.0,1.7383333333333333
19599.0,1.7642857142857142
Query:
SELECT im."interest_name", AVG(m."index_value") AS "avg_index_value"
    FROM "interest_metrics" AS m
    JOIN "interest_map" AS im ON m."interest_id" = im."id"
    GROUP BY im."interest_name"
    LIMIT 100;
Answer:
interest_name,avg_index_value
ACC Fans,1.56375
Accounting & CPA Continuing Education Researchers,1.337142857142857
Action Figure and Collectibles Shoppers,1.0274999999999999
Action Movie and TV Enthusiasts,0.63
Acura Vehicle Shoppers,1.2327272727272727
Adult Acne Sufferers,1.1891666666666667
Advertising Professionals,1.4461538461538461
Affordable Hotel Bookers,2.157857142857143
Africa Trip Planners,1.496666666666667
Aftermarket Accessories Shoppers,1.4600000000000002
Agricultural and Food Issues Researchers,1.384
Agriculture and Climate Advocates,1.4700000000000002
Airstream Enthusiasts,1.5045454545454546
Alabama Trip Planners,1.4257142857142857
Alaskan Cruise Planners,1.6257142857142857
Alternative Medicine Enthusiasts,1.116666666666667
Alzheimer and Dementia Researchers,1.4249999999999996
Ancestry Researchers,1.1723076923076923
Android Fans,1.2100000000000002
Anesthesiologists,1.6821428571428572
Animal Humane Society Helpers,1.087142857142857
Animal Rights Researchers,0.9175
Anime Fans,0.7399999999999999
Antiquing Enthusiasts,1.1325
Apartment Furniture Shoppers,2.5685714285714285
Apartment Hunters,1.4164285714285714
Apple Fans,1.7192857142857143
Aquarium Trip Planners,1.2275
Archery Enthusiasts,1.0675000000000001
Architects,1.7666666666666666
Architecture Enthusiasts,1.7053846153846153
Arizona Cardinals Fans,1.28875
Arizona Diamondbacks Fans,1.6466666666666665
Arizona Trip Planners,1.4399999999999997
Arizona Wildcats Fans,0.88
Arkansas Razorbacks Fans,1.5550000000000002
Arsenal Fans,1.3378571428571429
Arthritis Sufferers,1.5371428571428571
As Seen on TV Shoppers,1.2330769230769232
Asheville Trip Planners,1.7483333333333333
Asian Food Enthusiasts,1.1414285714285715
Aspen Skiers and Snowboarders,2.6439999999999992
Aspen Trip Planners,1.571
Asthma Sufferers,1.4885714285714282
Astrology Enthusiasts,0.7216666666666667
At-Home Gym Intenders,2.532857142857143
Athleisure Shoppers,1.6466666666666665
Atlanta Braves Fans,1.6733333333333333
Atlanta Falcons Fans,1.1283333333333334
Atlanta Hawks Fans,1.3788888888888888
Atlanta Trip Planners,1.3164285714285715
Atlanta United Fans,1.3414285714285714
Auburn Tigers Fans,1.5466666666666669
Audi Vehicle Shoppers,1.3935714285714287
Audio Book Listeners,1.5635714285714286
Audio Equipment Researchers,1.3184615384615386
Austin Trip Planners,1.6435714285714287
Australia Trip Planners,1.6707142857142856
Authors,1.3135714285714286
Auto Body Shoppers,0.9853846153846153
Auto Insurance Shoppers,1.4957142857142858
Auto Repair Researchers,1.1246153846153848
Auto Show Enthusiasts,1.659285714285714
Auto-Looking for New Car Purchase or Lease,1.497142857142857
Automotive Auctions Enthusiasts,1.1755555555555555
Automotive News Readers,0.88
Automotive Racing Enthusiasts,1.67
Automotive Safety Researchers,1.577142857142857
Automotive Service Professionals,1.1642857142857144
Aviation Enthusiasts,1.4509999999999998
Avid Readers,1.737857142857143
BBQ Enthusiasts,1.2315384615384615
BBQ Recipe Researchers,1.2938461538461539
BMW Vehicle Shoppers,1.4515384615384617
Baby Products Buyers,1.2458333333333333
Back Pain Sufferers,1.4407142857142856
Background Check Users,1.0474999999999999
Backyard Farmers,0.9583333333333334
Ballet Enthusiasts,2.2928571428571423
Baltimore Orioles Fans,1.8161538461538458
Baltimore Ravens Fans,1.0814285714285714
Bargain Shopping Researchers,1.3542857142857143
Baseball Enthusiasts,2.2528571428571427
Basketball Enthusiasts,1.687142857142857
Beach House Second Home Owners,1.8514285714285712
Beach Supplies Shoppers,2.4864285714285717
Beard Care Shoppers,1.2735714285714281
Beauty & Skincare Buyers,1.7392857142857145
Bed & Bath Shoppers,1.805714285714286
Beer Aficionados,1.6335714285714285
Beer Lovers,1.614285714285714
Bible Study Researchers,1.08
Big & Tall Men,2.5907142857142853
Big 12 Fans,1.55
Big Box Shoppers,1.83
Big East Fans,2.33
Bigfoot Folklore Enthusiasts,0.97
Billiards Enthusiasts,1.6681818181818182
Biohackers,1.565
Bird Watching Enthusiasts,1.4544444444444444
Query:
WITH max_compositions AS (
    SELECT
        m."interest_id",
        im."interest_name",
        m."month_year",
        m."composition",
        ROW_NUMBER() OVER (
            PARTITION BY m."interest_id"
            ORDER BY m."composition" DESC
        ) AS rn
    FROM
        "interest_metrics" m
        JOIN "interest_map" im ON m."interest_id" = im."id"
    WHERE m."composition" IS NOT NULL
)
SELECT "month_year", "interest_name", "composition" FROM (
    SELECT "month_year", "interest_name", "composition"
    FROM max_compositions
    WHERE rn = 1
    ORDER BY "composition" DESC
    LIMIT 10
)
UNION ALL
SELECT "month_year", "interest_name", "composition" FROM (
    SELECT "month_year", "interest_name", "composition"
    FROM max_compositions
    WHERE rn = 1
    ORDER BY "composition" ASC
    LIMIT 10
)
ORDER BY "composition" DESC;
Answer:
month_year,interest_name,composition
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
07-2018,Readers of Jamaican Content,1.86
02-2019,Automotive News Readers,1.84
07-2018,Comedy Fans,1.83
08-2019,World of Warcraft Enthusiasts,1.82
08-2018,Miami Heat Fans,1.81
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2019,Hearthstone Video Game Fans,1.66
09-2018,Scifi Movie and TV Enthusiasts,1.61
09-2018,Action Movie and TV Enthusiasts,1.59
03-2019,The Sims Video Game Fans,1.57
Query:
SELECT im."interest_name", m."composition"
FROM "interest_metrics" AS m
JOIN "interest_map" AS im ON m."interest_id" = im."id"
WHERE m."composition" > 0.5
LIMIT 100
Answer:
interest_name,composition
Vacation Rental Accommodation Researchers,11.89
Luxury Second Home Owners,9.93
Online Home Decor Shoppers,10.85
Hair Care Shoppers,10.32
Nutrition Conscious Eaters,10.77
Healthy Eaters,10.82
Luxury Travel Researchers,11.21
Wine Lovers,10.71
Home Remodelers,9.71
Home Design and Living Publication Readers,10.11
Apartment Furniture Shoppers,11.57
Mature Parents,9.47
Weight Loss Researchers,10.8
Luxury Retail Researchers,13.97
Running Enthusiasts,9.29
Misc-Deal Seekers or Coupon Shoppers,9.49
Shoe Shoppers,14.91
Land Rover Shoppers,12.62
MLB Fans,7.89
Vacation Planners,11.99
Competitive Sports Participants,9.35
Tech-Savvy Moms,10.29
Kitchen Appliance Shoppers,12.22
Mens Fitness Publication Readers,6.97
Travel Reward Points Enthusiasts,11.48
Luxury Hotel Guests,14.1
Gluten-Free Recipe Researchers,11.04
Parents with Kids,9.77
Reusable Drinkware Shoppers,13.35
Portugal Trip Planners,11.61
New & Expecting Parents,9.37
Live Concert Fans,6.61
Sporting Goods Shoppers,9.48
Womens Fashion Brands Shoppers,13.67
Golf Enthusiasts,9.97
Liberal News Readers,6.05
Drama Show Watchers,6.09
NBA Fans,6.9
Lobbyists,10.43
Wedding Registrants,6.83
Mens Health Researchers,7.42
Mens Shoe Shoppers,11.68
Luxury Kitchen Goods Shoppers,12.87
Baby Products Buyers,9.27
Financial News Readers,6.37
High End Camera Shoppers - Dupe,10.91
Fitness Enthusiasts,7.02
Womens Fashion Magazine Readers,6.25
Ski House Second Home Owners,8.84
TV Junkies,5.3
Online Health Researchers,6.71
Exercise and Gym Researchers,7.21
Pandora Jewelry Shoppers,12.27
Bed & Bath Shoppers,10.86
Dog Lovers,6.28
Luxury Department Store Shoppers,11.38
Costa Rica Trip Planners,11.63
Womens Fitness Enthusiasts,6.47
Parents of Teenagers Going to College,12.93
Indoor Cycling & Spinning Enthusiasts,8.72
Home Decor Shoppers,7.9
Olympics Fans,9.65
Pet Store Goers,6.82
Supermarket Shoppers,11.63
Boston Trip Planners,8.14
Health & Fitness,6.77
NCAA Fans,6.24
Beach House Second Home Owners,6.65
Preppy Clothing Shoppers,10.76
Breast Cancer Fund Raisers,6.26
Paleo Eaters,10.22
Beer Aficionados,6.53
Yogis,8.17
Harry Potter Fans,11.72
Natural Pet Food Shoppers,10.95
Dieters,6.87
Cholesterol Researchers,6.09
Competitive Tri-Athletes,9.97
Price Conscious Home Shoppers,7.19
Cycling Enthusiasts,6.37
Halloween Costume Shoppers,11.4
Realtors & Real Estate Researchers,6.28
Readers of Filipinos Content,5.99
Flight and Hotel Shoppers,7.46
Pregnancy Resources Researchers,9.13
Entertainment & Tabloid Magazine Readers,5.99
Streaming Radio Listeners,6.88
Financial Business Intelligence Researchers,6.13
NCAA Football Fans,5.14
Medical Advice Researchers,6.25
Womens Health Researchers,6.76
Discount Device Shoppers,7.09
Pharmacy Shoppers,5.68
Philadelphia Trip Planners,6.52
Gourmet Food & Wine Researchers,6.45
TV Advertising Professionals,6.21
Techies,5.41
Apple Fans,7.48
Executive and C-Suite,6.45
Luggage Shoppers,9.64
Query:
SELECT "interest_id", COUNT(*) AS "occurrences"
FROM "interest_metrics"
GROUP BY "interest_id"
LIMIT 100
Answer:
interest_id,occurrences
,1193
1.0,12
2.0,11
3.0,10
4.0,14
5.0,14
6.0,14
7.0,11
8.0,13
12.0,14
13.0,13
14.0,12
15.0,14
16.0,14
17.0,14
18.0,14
19.0,10
20.0,14
21.0,12
22.0,13
23.0,6
24.0,12
25.0,14
26.0,11
27.0,14
28.0,14
29.0,14
30.0,14
31.0,14
33.0,14
34.0,14
35.0,14
36.0,12
37.0,14
38.0,14
39.0,14
40.0,14
41.0,14
42.0,14
43.0,14
44.0,14
45.0,14
46.0,14
48.0,14
49.0,14
50.0,14
51.0,11
53.0,10
54.0,14
55.0,14
56.0,14
57.0,8
58.0,10
59.0,13
60.0,14
61.0,14
62.0,13
63.0,12
64.0,14
65.0,14
66.0,10
67.0,14
69.0,13
70.0,14
71.0,12
72.0,14
73.0,14
74.0,14
75.0,14
77.0,14
78.0,14
79.0,14
80.0,14
81.0,12
82.0,14
83.0,14
84.0,14
85.0,14
86.0,14
87.0,14
88.0,14
89.0,14
90.0,11
91.0,13
92.0,13
93.0,11
94.0,14
95.0,14
96.0,14
97.0,11
98.0,14
99.0,14
100.0,14
101.0,14
102.0,14
103.0,12
104.0,10
106.0,1
107.0,14
108.0,14
Query:
SELECT "interest_id", "composition", "index_value"
FROM "interest_metrics"
LIMIT 100
Answer:
interest_id,composition,index_value
32486.0,11.89,6.19
6106.0,9.93,5.31
18923.0,10.85,5.29
6344.0,10.32,5.1
100.0,10.77,5.04
69.0,10.82,5.03
79.0,11.21,4.97
6111.0,10.71,4.83
6214.0,9.71,4.83
19422.0,10.11,4.81
6110.0,11.57,4.79
4895.0,9.47,4.67
6217.0,10.8,4.62
4.0,13.97,4.53
6218.0,9.29,4.5
6123.0,9.49,4.49
171.0,14.91,4.47
19613.0,12.62,4.38
17.0,7.89,4.15
6.0,11.99,4.08
6013.0,9.35,3.99
4870.0,10.29,3.95
19423.0,12.22,3.92
6089.0,6.97,3.84
161.0,11.48,3.82
6286.0,14.1,3.82
5991.0,11.04,3.81
92.0,9.77,3.77
6184.0,13.35,3.75
19621.0,11.61,3.74
63.0,9.37,3.73
103.0,6.61,3.69
38.0,9.48,3.66
17786.0,13.67,3.65
6232.0,9.97,3.64
165.0,6.05,3.59
18351.0,6.09,3.58
15.0,6.9,3.56
,6.12,2.85
17314.0,10.43,3.55
6151.0,6.83,3.55
4914.0,7.42,3.55
115.0,11.68,3.53
5968.0,12.87,3.53
36.0,9.27,3.51
5943.0,6.37,3.48
133.0,10.91,3.44
1.0,7.02,3.44
114.0,6.25,3.41
6107.0,8.84,3.39
150.0,5.3,3.39
60.0,6.71,3.36
96.0,7.21,3.35
22403.0,12.27,3.33
40.0,10.86,3.32
19758.0,6.28,3.32
17730.0,11.38,3.3
5938.0,11.63,3.29
4869.0,6.47,3.29
4897.0,12.93,3.27
6029.0,8.72,3.26
31.0,7.9,3.26
16137.0,9.65,3.24
6330.0,6.82,3.22
6334.0,11.63,3.22
6315.0,8.14,3.22
4852.0,6.77,3.2
16.0,6.24,3.2
6108.0,6.65,3.17
6206.0,10.76,3.17
6006.0,6.26,3.15
6228.0,10.22,3.15
20768.0,6.53,3.15
4902.0,8.17,3.12
6277.0,11.72,3.1
19757.0,10.95,3.08
4911.0,6.87,3.08
,7.13,2.84
4910.0,6.09,3.07
6285.0,9.97,3.04
11974.0,7.19,3.02
6219.0,6.37,3.02
10250.0,11.4,3.01
6128.0,6.28,2.98
5946.0,5.99,2.97
158.0,7.46,2.97
15935.0,9.13,2.96
4855.0,5.99,2.95
149.0,6.88,2.95
16197.0,6.13,2.94
11067.0,5.14,2.93
17674.0,6.25,2.92
4913.0,6.76,2.92
56.0,7.09,2.91
6341.0,5.68,2.91
6316.0,6.52,2.91
18647.0,6.45,2.91
17803.0,6.21,2.91
23.0,5.41,2.89
132.0,7.48,2.88
End Exploring Related Columns
Task: Identify the top 10 and bottom 10 interest categories based on their highest composition values across all months. For each category, display the time(MM-YYYY), interest name, and the composition value

Please answer only one complete SQL in sqlite dialect in ```sql``` format.
Usage example: ```sql
SELECT DISTINCT "column_name" FROM "table_name" WHERE ... ``` (Replace "table_name" with the actual table name. Enclose table and column names with double quotations if they contain special characters or match reserved keywords.)
Follow the answer format like: To identify the top 10 and bottom 10 interest categories based on their highest composition values across all months, we would analyze the `interest_metrics` table, joined with the `interest_map` table to get the interest names. For each interest category, we find the month where it had its highest composition value.

Here is the requested data in CSV format:

```csv
Time(MM-YYYY),Interest_Name,Composition_Value
MM-YYYY1:str,Interest_Name1:str,Composition_Value1:float
MM-YYYY2:str,Interest_Name2:str,Composition_Value2:float
...
```

*Note: Since the actual data is not provided, we've included the metanames and their data types.*.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: 

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-23 18:04:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 18:04:30 - root - INFO - ```sql
WITH max_compositions AS (
    SELECT
        m."interest_id",
        im."interest_name",
        m."month_year",
        m."composition",
        ROW_NUMBER() OVER (
            PARTITION BY m."interest_id"
            ORDER BY m."composition" DESC
        ) AS rn
    FROM
        "interest_metrics" m
        JOIN "interest_map" im ON m."interest_id" = im."id"
    WHERE m."composition" IS NOT NULL
)
SELECT
    "month_year" AS "Time(MM-YYYY)",
    "interest_name" AS "Interest_Name",
    "composition" AS "Composition_Value"
FROM (
    SELECT "month_year", "interest_name", "composition"
    FROM max_compositions
    WHERE rn = 1
    ORDER BY "composition" DESC
    LIMIT 10
)
UNION ALL
SELECT
    "month_year", "interest_name", "composition"
FROM (
    SELECT "month_year", "interest_name", "composition"
    FROM max_compositions
    WHERE rn = 1
    ORDER BY "composition" ASC
    LIMIT 10
)
ORDER BY "Composition_Value" DESC;
```
2025-01-23 18:04:30 - root - INFO - itercount: 1
2025-01-23 18:04:30 - root - INFO - 0
2025-01-23 18:04:30 - root - INFO - results: 
Time(MM-YYYY),Interest_Name,Composition_Value
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
07-2018,Readers of Jamaican Content,1.86
02-2019,Automotive News Readers,1.84
07-2018,Comedy Fans,1.83
08-2019,World of Warcraft Enthusiasts,1.82
08-2018,Miami Heat Fans,1.81
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2019,Hearthstone Video Game Fans,1.66
09-2018,Scifi Movie and TV Enthusiasts,1.61
09-2018,Action Movie and TV Enthusiasts,1.59
03-2019,The Sims Video Game Fans,1.57


2025-01-23 18:04:30 - root - INFO - Please check the answer again by reviewing Identify the top 10 and bottom 10 interest categories based on their highest composition values across all months. For each category, display the time(MM-YYYY), interest name, and the composition value, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To identify the top 10 and bottom 10 interest categories based on their highest composition values across all months, we would analyze the `interest_metrics` table, joined with the `interest_map` table to get the interest names. For each interest category, we find the month where it had its highest composition value.

Here is the requested data in CSV format:

```csv
Time(MM-YYYY),Interest_Name,Composition_Value
MM-YYYY1:str,Interest_Name1:str,Composition_Value1:float
MM-YYYY2:str,Interest_Name2:str,Composition_Value2:float
...
```

*Note: Since the actual data is not provided, we've included the metanames and their data types.* The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Time(MM-YYYY),Interest_Name,Composition_Value
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
07-2018,Readers of Jamaican Content,1.86
02-2019,Automotive News Readers,1.84
07-2018,Comedy Fans,1.83
08-2019,World of Warcraft Enthusiasts,1.82
08-2018,Miami Heat Fans,1.81
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2019,Hearthstone Video Game Fans,1.66
09-2018,Scifi Movie and TV Enthusiasts,1.61
09-2018,Action Movie and TV Enthusiasts,1.59
03-2019,The Sims Video Game Fans,1.57
Current sql:
WITH max_compositions AS (
    SELECT
        m."interest_id",
        im."interest_name",
        m."month_year",
        m."composition",
        ROW_NUMBER() OVER (
            PARTITION BY m."interest_id"
            ORDER BY m."composition" DESC
        ) AS rn
    FROM
        "interest_metrics" m
        JOIN "interest_map" im ON m."interest_id" = im."id"
    WHERE m."composition" IS NOT NULL
)
SELECT
    "month_year" AS "Time(MM-YYYY)",
    "interest_name" AS "Interest_Name",
    "composition" AS "Composition_Value"
FROM (
    SELECT "month_year", "interest_name", "composition"
    FROM max_compositions
    WHERE rn = 1
    ORDER BY "composition" DESC
    LIMIT 10
)
UNION ALL
SELECT
    "month_year", "interest_name", "composition"
FROM (
    SELECT "month_year", "interest_name", "composition"
    FROM max_compositions
    WHERE rn = 1
    ORDER BY "composition" ASC
    LIMIT 10
)
ORDER BY "Composition_Value" DESC;For tasks asking fullname or name, you may combine first name and last name into one column called name.

2025-01-23 18:05:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 18:05:14 - root - INFO - ```sql
WITH max_compositions AS (
    SELECT
        m."interest_id",
        im."interest_name",
        m."month_year",
        m."composition",
        ROW_NUMBER() OVER (
            PARTITION BY m."interest_id"
            ORDER BY m."composition" DESC
        ) AS rn
    FROM
        "interest_metrics" m
        JOIN "interest_map" im ON m."interest_id" = im."id"
    WHERE m."composition" IS NOT NULL
)
SELECT
    "month_year" AS "Time(MM-YYYY)",
    "interest_name" AS "Interest_Name",
    ROUND("composition", 4) AS "Composition_Value"
FROM (
    SELECT "month_year", "interest_name", "composition"
    FROM max_compositions
    WHERE rn = 1
    ORDER BY "composition" DESC
    LIMIT 10
)
UNION ALL
SELECT
    "month_year" AS "Time(MM-YYYY)",
    "interest_name" AS "Interest_Name",
    ROUND("composition", 4) AS "Composition_Value"
FROM (
    SELECT "month_year", "interest_name", "composition"
    FROM max_compositions
    WHERE rn = 1
    ORDER BY "composition" ASC
    LIMIT 10
)
ORDER BY "Composition_Value" DESC;
```
2025-01-23 18:05:14 - root - INFO - itercount: 2
2025-01-23 18:05:14 - root - INFO - 0
2025-01-23 18:05:14 - root - INFO - Total iteration counts: 2
