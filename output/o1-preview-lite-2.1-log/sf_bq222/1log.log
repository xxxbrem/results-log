2025-01-23 18:44:02 - openai._base_client - INFO - Retrying request to /chat/completions in 0.475253 seconds
2025-01-23 18:44:55 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 18:44:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 18:44:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 18:44:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 18:44:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-23 18:44:57 - snowflake.connector.connection - INFO - closed
2025-01-23 18:44:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 18:44:57 - root - INFO - SQL:
SELECT * FROM PATENTS.PATENTS.PUBLICATIONS LIMIT 10;
Results:
Too long, hard cut:
publication_number,application_number,country_code,kind_code,application_kind,application_number_formatted,pct_number,family_id,spif_publication_number,spif_application_number,title_localized,abstract_localized,claims_localized,claims_localized_html,description_localized,description_localized_html,publication_date,filing_date,grant_date,priority_date,priority_claim,inventor,inventor_harmonized,assignee,assignee_harmonized,examiner,uspc,ipc,cpc,fi,fterm,locarno,citation,parent,child,entity_status,art_unit
CR-5634-A,CR-5634-A,CR,A,A,CR5634A,,44839011,,,"[
  {
    ""language"": ""es"",
    ""text"": ""Procedimiento para el analisis de aflatoxinas por cromatografia directa"",
    ""truncated"": false
  }
]","[
  {
    ""language"": ""es"",
    ""text"": ""consiste en colocar una muestra solida de cereal o leguminosa en una bandeja especial desarrollada para esta metodologia (bandeja de cromatografia), la cual en su base interior (fondo) posee un substrato sensible a las aflatoxinas, que al momento de la prueba se remoja con un disolvente extractor. Las particulas contaminadas liberan aflatoxinas que eluyen hacia el substrato en una area localizada alrededor de la particula contaminada. Despues de remover la muestra la bandeja se observa bajo luz ultravioleta de 365 nm, con la cual se observan pequenas manchas azules en los sitios donde hubo particulas contaminadas. Se encontro que existe una correlacion altamente significativa entre el numero de particulas que liberan aflatoxinas hacia el substrato sensible (manchas azules) y el contenido de aflatoxinas obtenido mediante un metodo quimico cuantitativo."",
    ""truncated"": false
  }
]",[],[],[],[],19980507,19971015,0,19971015,"[
  {
    ""application_number"": ""CR-5634-A"",
    ""category"": """",
    ""filing_date"": 19971015,
    ""npl_text"": """",
    ""publication_number"": """",
    ""type"": """"
  }
]","[
  ""FAUSTO CAMACHO CHACON""
]","[
  {
    ""country_code"": ""CR"",
    ""name"": ""FAUSTO CAMACHO CHACON""
  }
]","[
  ""Univ Costa Rica""
]","[
  {
    ""country_code"": ""CR"",
    ""name"": ""UNIV COSTA RICA""
  }
]",[],[],"[
  {
    ""code"": ""G01N21/01"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]",[],[],[],[],[],[],[],,
CR-5990-A,CR-5990-A,CR,A,A,CR5990A,,44839034,,,"[
  {
    ""language"": ""es"",
    ""text"": ""Derivados de acido fenil-metoxi-imino-glioxilico como plaguicidas"",
    ""truncated"": false
  }
]","[
  {
    ""language"": ""es"",
    ""text"": ""derivados de acido 2-imino-metil-fenil-acetico que tiene una actividad microbicida, insecticida, y acaricida, a un proceso para la preparacion de los mismos, a nuevos intermediarios para su preparacion, a composiciones agroquimicas que contienen estos ingredientes activos, asi como a su uso en el control y prevencion de hongos, acaros, e insectos patagonicos de plantas end agricultura y en el campo de higiene."",
    ""truncated"": false
  }
]",[],[],[],[],19991217,19990322,0,19980327,"[
  {
    ""application_number"": ""CH-7359998-A"",
    ""category"": """",
    ""filing_date"": 19980327,
    ""npl_text"": """",
    ""publication_number"": """",
    ""type"": """"
  }
]","[
  ""HUGO ZIEGLER"",
  ""RENE ZURFUG""
]","[
  {
    ""country_code"": ""CH"",
    ""name"": ""HUGO ZIEGLER""
  },
  {
    ""country_code"": ""CH"",
    ""name"": ""RENE ZURFUG""
  }
]","[
  ""Bayer Ag""
]","[
  {
    ""country_code"": ""DE"",
    ""name"": ""BAYER AG""
  }
]",[],[],[],[],[],[],[],[],[],[],,
FI-429-A,FI-429D-A,FI,A,A,,,36849362,,,"[
  {
    ""language"": ""fi"",
    ""text"": ""Förbättringar af tjärbränningsugnar med rörledning för trädestillation"",
    ""truncated"": false
  }
]",[],[],[],[],[],18920810,0,0,0,"[
  {
    ""application_number"": ""FI-429T-A"",
    ""category"": """",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": """",
    ""type"": """"
  }
]","[
  ""LOEFHJELM KARL""
]","[
  {
    ""country_code"": ""FI"",
    ""name"": ""KARL LOEFHJELM""
  }
]",[],[],[],[],"[
  {
    ""code"": ""C10C1/00"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]",[],[],[],[],[],[],[],,
HK-6083-A,HK-6083-A,HK,A,A,HK6083A,,9714822,,,"[
  {
    ""language"": ""en"",
    ""text"": ""A new or improved alternating current control device"",
    ""truncated"": false
  }
]",[],[],[],[],[],19830217,19830217,0,19780111,"[
  {
    ""application_number"": ""GB-102478-A"",
    ""category"": """",
    ""filing_date"": 19780111,
    ""npl_text"": """",
    ""publication_number"": """",
    ""type"": """"
  }
]","[
  ""SPENCER GRAHAM JOHN"",
  ""TYLOR RONALD"",
  ""WATKINS FREDERICK GEORGE""
]","[
  {
    ""country_code"": """",
    ""name"": ""SPENCER GRAHAM JOHN""
  },
  {
    ""country_code"": """",
    ""name"": ""TYLOR RONALD""
  },
  {
    ""country_code"": """",
    ""name"": ""WATKINS FREDERICK GEORGE""
  }
]","[
  ""Crabtree Electrical Ind Ltd""
]","[
  {
    ""country_code"": ""GB"",
    ""name"": ""CRABTREE ELECTRICAL IND LTD""
  }
]

2025-01-23 18:44:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 18:44:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 18:44:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 18:44:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 93
2025-01-23 18:44:59 - snowflake.connector.connection - INFO - closed
2025-01-23 18:44:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 18:44:59 - root - INFO - SQL:
SELECT DISTINCT "country_code" FROM PATENTS.PATENTS.PUBLICATIONS LIMIT 100;
Results:
country_code
DO
LT
TR
BG
YU
ZM
AU
CU
HK
GT
TN
UA
MW
CO
GR
MD
PL
CR
CH
KR
RO
US
DE
DD
PH
EG
PA
IT
CY
OA
SG
GB
ZW
RS
MA
SA
MN
HR
NL
ZA
EP
BA
MY
LV
CS
JP
HU
DZ
AR
KE
SI
CA
SK
IS
SE
AP
IE
ES
EA
CN
MC
PE
AT
IL
TW
MT
BE
IN
EC
MX
EE
GE
NO
LU
DK
FI
NI
HN
CZ
SV
BR
ID
KZ
WO
RU
JO
SM
ME
PT
CL
NZ
FR
SU

2025-01-23 18:44:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 18:44:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 18:44:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 18:45:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 18:45:01 - snowflake.connector.connection - INFO - closed
2025-01-23 18:45:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 18:45:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 18:45:38 - root - INFO - ```sql
SELECT
    cpc_def."titleFull" AS "Full_Title",
    cpc_group_stats."cpc_group" AS "CPC_Group",
    cpc_group_stats."best_year" AS "Best_Year"
FROM
    (
        SELECT
            "cpc_group",
            "best_year"
        FROM
            (
                SELECT
                    "cpc_group",
                    "filing_year" AS "best_year",
                    SUM("filing_count" * POWER(0.1, DATEDIFF('year', TO_DATE("filing_year" || '-01-01'), CURRENT_DATE()))) /
                    SUM(POWER(0.1, DATEDIFF('year', TO_DATE("filing_year" || '-01-01'), CURRENT_DATE()))) AS "ema"
                FROM
                    (
                        SELECT
                            LEFT(cpc_code.value:"code"::STRING, 4) AS "cpc_group",
                            EXTRACT(year FROM TO_DATE("filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
                            COUNT(*) AS "filing_count"
                        FROM
                            "PATENTS"."PATENTS"."PUBLICATIONS",
                            LATERAL FLATTEN(input => "cpc") cpc_code
                        WHERE
                            "country_code" = 'DE'
                            AND TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD') BETWEEN '2016-12-01' AND '2016-12-31'
                        GROUP BY
                            "cpc_group", "filing_year"
                    ) sub
                GROUP BY
                    "cpc_group", "filing_year"
            ) ema_calc
        QUALIFY ROW_NUMBER() OVER (PARTITION BY "cpc_group" ORDER BY "ema" DESC) = 1
    ) cpc_group_stats
LEFT JOIN "PATENTS"."PATENTS"."CPC_DEFINITION" cpc_def
    ON cpc_def."symbol" = cpc_group_stats."cpc_group"
ORDER BY
    cpc_group_stats."cpc_group";
```
2025-01-23 18:45:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 18:45:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 18:45:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 18:45:45 - snowflake.connector.connection - INFO - closed
2025-01-23 18:45:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 18:46:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 18:46:14 - root - INFO - ```sql
SELECT
    cpc_def."titleFull" AS "Full_Title",
    cpc_group_stats."cpc_group" AS "CPC_Group",
    cpc_group_stats."best_year" AS "Best_Year"
FROM
    (
        SELECT
            "cpc_group",
            "best_year"
        FROM
            (
                SELECT
                    "cpc_group",
                    "filing_year" AS "best_year",
                    SUM("filing_count" * POWER(0.1, DATEDIFF('year', TO_DATE("filing_year" || '-01-01'), CURRENT_DATE()))) /
                    SUM(POWER(0.1, DATEDIFF('year', TO_DATE("filing_year" || '-01-01'), CURRENT_DATE()))) AS "ema"
                FROM
                    (
                        SELECT
                            LEFT(cpc_code.value:"code"::STRING, 4) AS "cpc_group",
                            EXTRACT(year FROM TRY_TO_DATE("filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
                            COUNT(*) AS "filing_count"
                        FROM
                            "PATENTS"."PATENTS"."PUBLICATIONS",
                            LATERAL FLATTEN(input => "cpc") cpc_code
                        WHERE
                            "country_code" = 'DE'
                            AND TRY_TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD') BETWEEN '2016-12-01' AND '2016-12-31'
                            AND "filing_date" != 0
                        GROUP BY
                            "cpc_group", "filing_year"
                        HAVING
                            "filing_year" IS NOT NULL
                    ) sub
                GROUP BY
                    "cpc_group", "filing_year"
            ) ema_calc
        QUALIFY ROW_NUMBER() OVER (PARTITION BY "cpc_group" ORDER BY "ema" DESC) = 1
    ) cpc_group_stats
LEFT JOIN "PATENTS"."PATENTS"."CPC_DEFINITION" cpc_def
    ON cpc_def."symbol" = cpc_group_stats."cpc_group"
ORDER BY
    cpc_group_stats."cpc_group";
```
2025-01-23 18:46:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 18:46:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 18:46:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 18:46:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 48
2025-01-23 18:46:16 - snowflake.connector.connection - INFO - closed
2025-01-23 18:46:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 18:47:23 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 18:47:23 - root - INFO - SQL:
SELECT
    cpc_def."titleFull" AS "Full_Title",
    cpc_group_stats."cpc_group" AS "CPC_Group",
    cpc_group_stats."best_year" AS "Best_Year"
FROM
    (
        SELECT
            "cpc_group",
            "best_year"
        FROM
            (
                SELECT
                    "cpc_group",
                    "filing_year" AS "best_year",
                    SUM("filing_count" * POWER(0.1, DATEDIFF('year', TO_DATE("filing_year" || '-01-01'), CURRENT_DATE()))) /
                    SUM(POWER(0.1, DATEDIFF('year', TO_DATE("filing_year" || '-01-01'), CURRENT_DATE()))) AS "ema"
                FROM
                    (
                        SELECT
                            LEFT(cpc_code.value:"code"::STRING, 4) AS "cpc_group",
                            EXTRACT(year FROM TRY_TO_DATE("filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
                            COUNT(*) AS "filing_count"
                        FROM
                            "PATENTS"."PATENTS"."PUBLICATIONS",
                            LATERAL FLATTEN(input => "cpc") cpc_code
                        WHERE
                            "country_code" = 'DE'
                            AND TRY_TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD') BETWEEN '2016-12-01' AND '2016-12-31'
                            AND "filing_date" != 0
                        GROUP BY
                            "cpc_group", "filing_year"
                        HAVING
                            "filing_year" IS NOT NULL
                    ) sub
                GROUP BY
                    "cpc_group", "filing_year"
            ) ema_calc
        QUALIFY ROW_NUMBER() OVER (PARTITION BY "cpc_group" ORDER BY "ema" DESC) = 1
    ) cpc_group_stats
LEFT JOIN "PATENTS"."PATENTS"."CPC_DEFINITION" cpc_def
    ON cpc_def."symbol" = cpc_group_stats."cpc_group"
ORDER BY
    cpc_group_stats."cpc_group";
Results:
Too long, hard cut:
Full_Title,CPC_Group,Best_Year
DOMESTIC WASHING OR CLEANING; SUCTION CLEANERS IN GENERAL,A47L,2015
"FILTERS IMPLANTABLE INTO BLOOD VESSELS; PROSTHESES; DEVICES PROVIDING PATENCY TO, OR PREVENTING COLLAPSING OF, TUBULAR STRUCTURES OF THE BODY, e.g. STENTS; ORTHOPAEDIC, NURSING OR CONTRACEPTIVE DEVICES; FOMENTATION; TREATMENT OR PROTECTION OF EYES OR EARS; BANDAGES, DRESSINGS OR ABSORBENT PADS; FIRST-AID KITS",A61F,2015
"APPARATUS FOR PHYSICAL TRAINING, GYMNASTICS, SWIMMING, CLIMBING, OR FENCING; BALL GAMES; TRAINING EQUIPMENT",A63B,2015
"DEVICES FOR THEATRES, CIRCUSES, OR THE LIKE; CONJURING APPLIANCES OR THE LIKE",A63J,2015
WORKING METALLIC POWDER; MANUFACTURE OF ARTICLES FROM METALLIC POWDER; MAKING METALLIC POWDER; APPARATUS OR DEVICES SPECIALLY ADAPTED FOR METALLIC POWDER,B22F,2006
MILLING,B23C,2015
"SOLDERING OR UNSOLDERING; WELDING; CLADDING OR PLATING BY SOLDERING OR WELDING; CUTTING BY APPLYING HEAT LOCALLY, e.g. FLAME CUTTING; WORKING BY LASER BEAM",B23K,2015
"DETAILS, COMPONENTS, OR ACCESSORIES FOR MACHINE TOOLS, e.g. ARRANGEMENTS FOR COPYING OR CONTROLLING; MACHINE TOOLS IN GENERAL CHARACTERISED BY THE CONSTRUCTION OF PARTICULAR DETAILS OR COMPONENTS; COMBINATIONS OR ASSOCIATIONS OF METAL-WORKING MACHINES, NOT DIRECTED TO A PARTICULAR RESULT",B23Q,2015
MANIPULATORS; CHAMBERS PROVIDED WITH MANIPULATION DEVICES,B25J,2015
"CUTTING; DETAILS COMMON TO MACHINES FOR PERFORATING, PUNCHING, CUTTING-OUT, STAMPING-OUT OR SEVERING",B26D,2015
PERFORATING; PUNCHING; CUTTING-OUT; STAMPING-OUT; SEVERING BY MEANS OTHER THAN CUTTING,B26F,2015
"SHAPING OR JOINING OF PLASTICS; SHAPING OF MATERIAL IN A PLASTIC STATE, NOT OTHERWISE PROVIDED FOR; AFTER-TREATMENT OF THE SHAPED PRODUCTS, e.g. REPAIRING",B29C,2015
"INDEXING SCHEME ASSOCIATED WITH SUBCLASS B29C, RELATING TO PARTICULAR ARTICLES",B29L,2015
PROPULSION OF ELECTRICALLY-PROPELLED VEHICLES; SUPPLYING ELECTRIC POWER FOR AUXILIARY EQUIPMENT OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRODYNAMIC BRAKE SYSTEMS FOR VEHICLES IN GENERAL; MAGNETIC SUSPENSION OR LEVITATION FOR VEHICLES; MONITORING OPERATING VARIABLES OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRIC SAFETY DEVICES FOR ELECTRICALLY-PROPELLED VEHICLES,B60L,2016
"VEHICLES, VEHICLE FITTINGS, OR VEHICLE PARTS, NOT OTHERWISE PROVIDED FOR",B60R,2013
"SERVICING, CLEANING, REPAIRING, SUPPORTING, LIFTING, OR MANOEUVRING OF VEHICLES, NOT OTHERWISE PROVIDED FOR",B60S,2016
"VEHICLE BRAKE CONTROL SYSTEMS OR PARTS THEREOF; BRAKE CONTROL SYSTEMS OR PARTS THEREOF, IN GENERAL; ARRANGEMENT OF BRAKING ELEMENTS ON VEHICLES IN GENERAL; PORTABLE DEVICES FOR PREVENTING UNWANTED MOVEMENT OF VEHICLES; VEHICLE MODIFICATIONS TO FACILITATE COOLING OF BRAKES",B60T,2015
BRAKES OR OTHER RETARDING DEVICES SPECIALLY ADAPTED FOR RAIL VEHICLES; ARRANGEMENT OR DISPOSITION THEREOF IN RAIL VEHICLES,B61H,2015
"HAND-PROPELLED VEHICLES, e.g. HAND CARTS OR PERAMBULATORS; SLEDGES",B62B,2015
COSMONAUTICS; VEHICLES OR EQUIPMENT THEREFOR,B64G,2015
"MACHINES, APPARATUS OR DEVICES FOR, OR METHODS OF, PACKAGING ARTICLES OR MATERIALS; UNPACKING",B65B,2015
SPECIFIC USES OR APPLICATIONS OF NANOSTRUCTURES; MEASUREMENT OR ANALYSIS OF NANOSTRUCTURES; MANUFACTURE OR TREATMENT OF NANOSTRUCTURES,B82Y,2006
MANUFACTURE OF IRON OR STEEL,C21B,2013
PRODUCTION AND REFINING OF METALS; PRETREATMENT OF RAW MATERIALS,C22B,2013
"NON-POSITIVE DISPLACEMENT MACHINES OR ENGINES, e.g. STEAM TURBINES",F01D,2015
INTERNAL-COMBUSTION PISTON ENGINES; COMBUSTION ENGINES IN GENERAL,F02B,2015
"INDEXING SCHEME FOR ASPECTS RELATING TO NON-POSITIVE-DISPLACEMENT MACHINES OR ENGINES, GAS-TURBINES OR JET-PROPULSION PLANTS",F05D,2015
SHAFTS; FLEXIBLE SHAFTS; ELEMENTS OR CRANKSHAFT MECHANISMS; ROTARY BODIES OTHER THAN GEARING ELEMENTS; BEARINGS,F16C,2015
COUPLINGS FOR TRANSMITTING ROTATION; CLUTCHES; BRAKES,F16D,2015
VALVES; TAPS; COCKS; ACTUATING-FLOATS; DEVICES FOR VENTING OR AERATING,F16K,2012
REFRIGERATORS; COLD ROOMS; ICE-BOXES; COOLING OR FREEZING APPARATUS NOT OTHERWISE PROVIDED FOR,F25D,2015
"FURNACES, KILNS, OVENS, OR RETORTS IN GENERAL; OPEN SINTERING OR LIKE APPARATUS",F27B,2013
"DETAILS OR ACCESSORIES OF FURNACES, KILNS, OVENS, OR RETORTS, IN SO FAR AS THEY ARE OF KINDS OCCURRING IN MORE THAN ONE KIND OF FURNACE",F27D,2013
MEASURING ELECTRIC VARIABLES; MEASURING MAGNETIC VARIABLES,G01R,2016
RADIO DIRECTION-FINDING; RADIO NAVIGATION; DETERMINING DISTANCE OR VELOCITY BY USE OF RADIO WAVES; LOCATING OR PRESENCE-DETECTING BY USE OF THE REFLECTION OR RERADIATION OF RADIO WAVES; ANALOGOUS ARRANGEMENTS USING OTHER WAVES,G01S,2016
ELECTROGRAPHY; ELECTROPHOTOGRAPHY; MAGNETOGRAPHY,G03G,2009
CONTROL OR REGULATING SYSTEMS IN GENERAL; FUNCTIONAL ELEMENTS OF SUCH SYSTEMS; MONITORING OR TESTING ARRANGEMENTS FOR SUCH SYSTEMS OR ELEMENTS,G05B,2015
"PROCESSES OR MEANS, e.g. BATTERIES, FOR THE DIRECT CONVERSION OF CHEMICAL ENERGY INTO ELECTRICAL ENERGY",H01M,2016
CIRCUIT ARRANGEMENTS OR SYSTEMS FOR SUPPLYING OR DISTRIBUTING ELECTRIC POWER; SYSTEMS FOR STORING ELECTRIC ENERGY,H02J,2016
"IMPEDANCE NETWORKS, e.g. 

2025-01-23 18:47:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 18:47:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 18:47:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 18:47:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 18:47:24 - snowflake.connector.connection - INFO - closed
2025-01-23 18:47:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 18:47:25 - root - INFO - SQL:
SELECT "publication_number", "grant_date" FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "grant_date" BETWEEN 20161201 AND 20161231 LIMIT 100;
Results:
publication_number,grant_date
DE-102015114819-B3,20161222
DE-112006001900-B4,20161215
RU-2604500-C1,20161210
KR-101688574-B1,20161221
KR-101685829-B1,20161212
KR-101690893-B1,20161228
KR-101688758-B1,20161221
AU-2015207934-B2,20161208
US-9522312-B2,20161220
JP-6038569-B2,20161207
JP-6053144-B2,20161227
JP-6051422-B2,20161227
US-9531453-B2,20161227
US-9516929-B1,20161213
EP-2636423-B1,20161207
FR-3030443-B1,20161209
FR-2933892-B1,20161230
US-9522418-B2,20161220
US-9529473-B2,20161227
EP-2903185-B1,20161221
KR-101689855-B1,20161226
KR-101690655-B1,20161228
KR-101690861-B1,20161228
KR-101689017-B1,20161223
KR-101690043-B1,20161228
KR-101684962-B1,20161209
KR-101682521-B1,20161206
KR-101681874-B1,20161202
KR-101688034-B1,20161220
US-9514786-B2,20161206
ES-2561934-B1,20161209
JP-6044917-B1,20161214
KR-101677718-B1,20161206
KR-101690331-B1,20161227
JP-6039196-B2,20161207
JP-6039332-B2,20161207
JP-6040682-B2,20161207
JP-6042255-B2,20161214
JP-6053747-B2,20161227
RU-2604294-C1,20161210
RU-166963-U1,20161220
AU-2013206757-B2,20161222
JP-6044148-B2,20161214
JP-6053903-B1,20161227
KR-101684517-B1,20161208
KR-101686006-B1,20161213
KR-101691069-B1,20161230
KR-101685861-B1,20161212
KR-101685409-B1,20161213
KR-101691045-B1,20161229
US-9531867-B2,20161227
US-9529903-B2,20161227
KR-101690772-B1,20161229
KR-101689501-B1,20161223
KR-101691483-B1,20161230
CN-103298972-B,20161221
CN-103185353-B,20161221
CN-104112539-B,20161228
CN-103744846-B,20161228
CN-104751568-B,20161228
US-9513680-B2,20161206
US-9518924-B2,20161213
US-9520447-B2,20161213
US-9513676-B2,20161206
JP-6047217-B1,20161221
KR-101690544-B1,20161228
CN-103958277-B,20161221
CN-104234659-B,20161228
CN-104139310-B,20161228
CN-103426965-B,20161228
CN-104627431-B,20161207
CN-104776707-B,20161207
KR-101690580-B1,20161228
KR-101689788-B1,20161227
CN-103085523-B,20161221
CN-103078923-B,20161228
CN-103477337-B,20161228
CN-103430599-B,20161214
CN-103687974-B,20161221
CN-103280586-B,20161228
CN-104174599-B,20161228
CN-104192340-B,20161207
CN-104494390-B,20161207
JP-1487073-S,20161212
CA-168133-S,20161215
JP-1565184-S,20161212
JP-6041466-B2,20161207
JP-6042613-B2,20161214
JP-6038817-B2,20161207
JP-6050450-B2,20161221
JP-6041584-B2,20161214
JP-6051996-B2,20161227
JP-6042378-B2,20161214
JP-6053830-B2,20161227
JP-6044919-B2,20161214
JP-6054331-B2,20161227
CN-205814045-U,20161221
CN-205813256-U,20161221
CN-205795800-U,20161214
CN-205785887-U,20161207

2025-01-23 18:47:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 18:47:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 18:47:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 18:47:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7
2025-01-23 18:47:26 - snowflake.connector.connection - INFO - closed
2025-01-23 18:47:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 18:47:26 - root - INFO - SQL:
SELECT "publication_number", "grant_date" FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "country_code" = 'DE' AND "grant_date" BETWEEN 20161201 AND 20161231 LIMIT 100;
Results:
publication_number,grant_date
DE-102015114819-B3,20161222
DE-112006001900-B4,20161215
DE-102009051197-B4,20161222
DE-102011005349-B4,20161215
DE-102012004706-B4,20161222
DE-102013203286-B4,20161222
DE-112013006743-B4,20161208

2025-01-23 18:47:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 18:47:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 18:47:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 18:47:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-23 18:47:28 - snowflake.connector.connection - INFO - closed
2025-01-23 18:47:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 18:47:28 - root - INFO - SQL:
SELECT "publication_number", "cpc" FROM PATENTS.PATENTS.PUBLICATIONS LIMIT 10;
Results:
publication_number,cpc
CR-5634-A,[]
CR-5990-A,[]
FI-429-A,[]
HK-6083-A,"[
  {
    ""code"": ""H02M5/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
HU-T52763-A,"[
  {
    ""code"": ""A01N47/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D521/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
JP-H03206829-A,"[
  {
    ""code"": ""Y02A40/81"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
JP-S62159089-A,"[
  {
    ""code"": ""Y02E30/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
US-416-A,"[
  {
    ""code"": ""Y10T83/465"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""B26F1/42"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
US-2528225-A,"[
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A41580-A,"[
  {
    ""code"": ""B22D11/086"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"

2025-01-23 18:47:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 18:47:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 18:47:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 18:47:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 18:47:30 - snowflake.connector.connection - INFO - closed
2025-01-23 18:47:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 18:47:30 - root - INFO - SQL:
SELECT "publication_number", cpc_code.value:"code"::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS,
   LATERAL FLATTEN(input => "cpc") cpc_code
   LIMIT 100;
Results:
publication_number,cpc_code
US-8857551-B2,B60G3/145
US-8857551-B2,B60G2200/44
US-8857551-B2,B60G2300/122
US-8857551-B2,B60G2300/45
US-8857551-B2,B60G3/145
US-8857551-B2,B60G3/00
US-8857551-B2,B60G2200/44
US-8857551-B2,B62K5/08
US-8857551-B2,B60G2300/122
US-8857551-B2,B60G3/26
US-8857551-B2,B60G2300/45
US-8857551-B2,B62K5/08
US-8857551-B2,B60G3/00
US-8857551-B2,B60G3/26
US-9370027-B2,H04L12/1863
US-9370027-B2,H04W60/00
US-9370027-B2,H04W8/18
US-9370027-B2,H04W80/04
US-9370027-B2,H04W4/06
US-9370027-B2,H04W76/002
US-9370027-B2,H04L12/189
US-9370027-B2,H04L12/1863
US-9370027-B2,H04W4/06
US-9370027-B2,H04W80/04
US-9370027-B2,H04L12/1863
US-9370027-B2,H04W60/00
US-9370027-B2,H04W76/40
US-9370027-B2,H04W8/18
US-9370027-B2,H04W4/06
US-9370027-B2,H04W80/04
US-9370027-B2,H04L12/189
US-9370027-B2,H04L12/189
US-9370027-B2,H04W60/00
US-9370027-B2,H04W8/18
US-9370027-B2,H04W76/40
US-9042351-B2,H04W28/18
US-9042351-B2,H04L5/0091
US-9042351-B2,H04W52/0229
US-9042351-B2,H04W28/18
US-9042351-B2,H04W52/0229
US-9042351-B2,H04W52/0229
US-9042351-B2,H04W28/18
US-9042351-B2,Y02D30/70
US-9042351-B2,Y02D30/70
US-9042351-B2,H04L5/0091
US-10561638-B2,A61P43/00
US-10561638-B2,A61P9/10
US-10561638-B2,A61P9/06
US-10561638-B2,A61P25/36
US-10561638-B2,A61P25/34
US-10561638-B2,A61P25/32
US-10561638-B2,A61P25/30
US-10561638-B2,A61P25/28
US-10561638-B2,A61P25/24
US-10561638-B2,A61P25/22
US-10561638-B2,A61P25/20
US-10561638-B2,A61P25/18
US-10561638-B2,A61P25/14
US-10561638-B2,A61P25/12
US-10561638-B2,A61P25/08
US-10561638-B2,A61P25/06
US-10561638-B2,A61P25/02
US-10561638-B2,A61P11/02
US-10561638-B2,A61P11/00
US-10561638-B2,A61P1/08
US-10561638-B2,A61K31/417
US-10561638-B2,A61K31/415
US-10561638-B2,A61K9/08
US-10561638-B2,A61K31/415
US-10561638-B2,A61K31/4164
US-10561638-B2,A61K45/06
US-10561638-B2,A61K31/417
US-10561638-B2,A61K31/417
US-10561638-B2,A61K31/417
US-10561638-B2,A61K31/415
US-10561638-B2,A61K45/06
US-10561638-B2,A61K9/08
US-10561638-B2,A61K31/4164
US-10561638-B2,A61K9/08
US-8962445-B2,H01L21/76232
US-8962445-B2,H01L29/66666
US-8962445-B2,H01L21/76232
US-8962445-B2,H01L21/76224
US-8962445-B2,H01L29/66666
US-8962445-B2,H01L27/10891
US-8962445-B2,H01L21/76232
US-8962445-B2,H01L21/76224
US-8962445-B2,H01L27/10885
US-8962445-B2,H01L27/10823
US-8962445-B2,H01L29/66666
US-8962445-B2,H10B12/488
US-8962445-B2,H10B12/34
US-8962445-B2,H10B12/482
US-8962445-B2,H10B12/488
US-8962445-B2,H10B12/34
US-8962445-B2,H10B12/01
US-8962445-B2,H10B12/482
US-9270639-B2,H04L63/0227
US-9270639-B2,H04L47/125
US-9270639-B2,H04L63/0218

2025-01-23 18:47:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 18:47:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 18:47:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 18:47:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 55
2025-01-23 18:47:31 - snowflake.connector.connection - INFO - closed
2025-01-23 18:47:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 18:47:32 - root - INFO - SQL:
SELECT "publication_number", cpc_code.value:"code"::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS,
   LATERAL FLATTEN(input => "cpc") cpc_code
   WHERE "country_code" = 'DE' AND "grant_date" BETWEEN 20161201 AND 20161231
   LIMIT 100;
Results:
publication_number,cpc_code
DE-102013203286-B4,B60R22/4676
DE-112013006743-B4,C21B7/14
DE-112013006743-B4,C21B7/14
DE-112013006743-B4,C22B7/00
DE-112013006743-B4,F27B7/00
DE-112013006743-B4,F27D3/1518
DE-102009051197-B4,H04N1/047
DE-102009051197-B4,H04N1/193
DE-102009051197-B4,H04N1/1934
DE-102009051197-B4,H04N1/12
DE-102009051197-B4,H04N2201/04787
DE-102009051197-B4,G03G2215/0158
DE-102011005349-B4,H03H7/0115
DE-102011005349-B4,H03H7/1758
DE-102011005349-B4,H03H7/175
DE-102011005349-B4,H03H7/42
DE-102011005349-B4,H03H7/1766
DE-102011005349-B4,H03H7/1758
DE-102011005349-B4,H03H7/42
DE-102011005349-B4,H03H7/1775
DE-102011005349-B4,H03H7/06
DE-102011005349-B4,H03H7/03
DE-102011005349-B4,H03H7/1766
DE-102011005349-B4,H03H7/1775
DE-102011005349-B4,H03H7/06
DE-102011005349-B4,H03H7/0115
DE-102011005349-B4,H03H7/03
DE-102011005349-B4,H04B1/28
DE-102011005349-B4,H04B1/28
DE-102011005349-B4,H03H7/175
DE-102012004706-B4,F16K31/002
DE-102012004706-B4,F16K27/0263
DE-102015114819-B3,B64G1/283
DE-102015114819-B3,F16C33/66
DE-102015114819-B3,F16C33/6603
DE-102015114819-B3,B64G1/283
DE-102015114819-B3,F16C2326/47
DE-102015114819-B3,F16C2326/47
DE-102015114819-B3,B64G1/285
DE-102015114819-B3,B64G1/283
DE-102015114819-B3,F16C19/06
DE-102015114819-B3,F16C32/0408
DE-102015114819-B3,B64G1/285
DE-102015114819-B3,B64G1/28
DE-112006001900-B4,B22F9/26
DE-112006001900-B4,B22F2999/00
DE-112006001900-B4,B22F2998/00
DE-112006001900-B4,Y10S977/775
DE-112006001900-B4,B22F9/26
DE-112006001900-B4,B22F9/24
DE-112006001900-B4,B22F9/26
DE-112006001900-B4,B22F2999/00
DE-112006001900-B4,B22F2998/00
DE-112006001900-B4,B82Y40/00
DE-112006001900-B4,Y10S977/775

2025-01-23 18:47:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 18:47:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 18:47:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 18:47:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 18:47:33 - snowflake.connector.connection - INFO - closed
2025-01-23 18:47:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 18:47:34 - root - INFO - SQL:
SELECT "publication_number", LEFT(cpc_code.value:"code"::STRING, 4) AS "cpc_group"
   FROM PATENTS.PATENTS.PUBLICATIONS,
   LATERAL FLATTEN(input => "cpc") cpc_code
   LIMIT 100;
Results:
publication_number,cpc_group
US-8521396-B2,B62K
US-8521396-B2,B62M
US-8521396-B2,B62K
US-8521396-B2,B62M
US-8521396-B2,B62K
US-8521396-B2,B62K
US-8521396-B2,B62K
US-8521396-B2,B62K
US-9247876-B2,G02B
US-9247876-B2,A61B
US-9247876-B2,A61B
US-9247876-B2,G02B
US-9247876-B2,A61B
US-9247876-B2,A61B
US-9247876-B2,G02B
US-9247876-B2,A61B
US-9247876-B2,A61B
US-9247876-B2,A61B
US-9247876-B2,A61B
US-9247876-B2,A61B
US-9247876-B2,G02B
US-8723487-B2,H02M
US-8723487-B2,H02M
US-8723487-B2,Y02B
US-8723487-B2,H02M
US-8723487-B2,Y02B
US-8723487-B2,H02M
US-8723487-B2,H02M
US-8723487-B2,H02M
US-9278232-B2,A61N
US-9278232-B2,A61N
US-9278232-B2,A61N
US-9278232-B2,A61N
US-9278232-B2,A61N
US-9278232-B2,A61N
US-9278232-B2,A61N
US-9278232-B2,A61N
US-9278232-B2,A61N
US-9278232-B2,A61N
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,Y02E
US-8402104-B2,G06Q
US-8402104-B2,H04L
US-8402104-B2,H04L
US-8402104-B2,G06Q
US-8872639-B2,G06F
US-8872639-B2,G06F
US-8872639-B2,B60K
US-8872639-B2,G02B
US-8872639-B2,B60K
US-8872639-B2,B60K
US-8872639-B2,G02B
US-8872639-B2,B60K
US-8872639-B2,B60K
US-8872639-B2,G02B
US-8872639-B2,G06F
US-8872639-B2,G06F
US-8872639-B2,B60K
US-8872639-B2,G02B
US-8872639-B2,G06F
US-8872639-B2,G02B
US-8872639-B2,G02B
US-8872639-B2,B60K
US-8872639-B2,B60K
US-8872639-B2,B60K
US-8872639-B2,B60K
US-8872639-B2,B60K
US-8872639-B2,B60K
US-8872639-B2,G02B
US-8872639-B2,G06F
US-8872639-B2,G02B
US-8872639-B2,G02B
US-8872639-B2,B60K
US-8872639-B2,B60K
US-8872639-B2,B60K
US-8872639-B2,B60K
US-8872639-B2,B60K
US-9042220-B2,H04L
US-9042220-B2,H04L
US-9042220-B2,H04L
US-9042220-B2,H04L
US-9042220-B2,H04L
US-9042220-B2,H04L
US-9042220-B2,H04L
US-9042220-B2,H04L

2025-01-23 18:47:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 18:47:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 18:47:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 18:47:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 18:47:35 - snowflake.connector.connection - INFO - closed
2025-01-23 18:47:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 18:47:35 - root - INFO - SQL:
SELECT "publication_number", "filing_date", FLOOR("filing_date" / 10000) AS "filing_year"
    FROM PATENTS.PATENTS.PUBLICATIONS LIMIT 100;
Results:
publication_number,filing_date,filing_year
CR-5634-A,19971015,1997
CR-5990-A,19990322,1999
FI-429-A,0,0
HK-6083-A,19830217,1983
HU-T52763-A,19900109,1990
JP-H03206829-A,19900101,1990
JP-S62159089-A,19860106,1986
US-416-A,0,0
US-2528225-A,19480102,1948
AT-A41580-A,19800125,1980
AT-A47682-A,19820209,1982
AT-A63682-A,19820219,1982
CA-920790-A,19700116,1970
CA-950907-A,19700224,1970
CA-920830-A,19700501,1970
CA-9086-A,0,0
CH-3256-A,18901220,1890
CH-540255-A,19690318,1969
CH-433637-A,19660117,1966
CH-8494-A,18940609,1894
CH-9587-A,18941217,1894
CH-9968-A,18950125,1895
DD-8297-A,0,0
FR-1334211-A,19620924,1962
FR-1444995-A,19650616,1965
FR-1474468-A,19660402,1966
FR-1478988-A,19660506,1966
FR-1485992-A,19660704,1966
FR-1487706-A,19660725,1966
FR-1508237-A,19661121,1966
GB-893001-A,19600102,1960
GB-873984-A,19580106,1958
GB-307790-A,19290107,1929
GB-534192-A,19400116,1940
HK-39487-A,19870521,1987
HK-52284-A,19840705,1984
HK-55992-A,19920730,1992
HK-60178-A,19781012,1978
HK-82486-A,19861030,1986
HU-T58725-A,19910225,1991
JP-S62157892-A,19860106,1986
JP-H06198910-A,19930106,1993
MA-42286-A,20150702,2015
OA-07542-A,19830922,1983
OA-08399-A,19860626,1986
PH-11723-A,19730907,1973
PH-15213-A,19780905,1978
PH-17928-A,19820512,1982
PH-23905-A,19880217,1988
TR-26506-A,19900307,1990
US-4613-A,0,0
US-4234270-A,19790102,1979
US-6310-A,0,0
US-8947-A,0,0
YU-24971-A,19710204,1971
YU-51397-A,19971230,1997
YU-53588-A,19880317,1988
YU-94082-A,19820430,1982
AT-A134275-A,19750221,1975
AT-A160683-A,19830503,1983
AT-A168281-A,19810413,1981
AT-A179178-A,19780313,1978
AT-A196182-A,19820518,1982
AT-A202882-A,19820524,1982
AT-A205780-A,19800416,1980
AT-A245590-A,19901205,1990
AT-A250686-A,19860918,1986
AT-A269985-A,19850916,1985
AT-A272073-A,19730328,1973
AT-A312885-A,19851029,1985
AT-A404675-A,19750527,1975
AT-A482077-A,19770706,1977
AT-A519575-A,19750707,1975
AT-A710279-A,19791105,1979
AT-A735378-A,19781012,1978
AT-A876472-A,19721012,1972
AT-A906278-A,19781219,1978
BE-804534-A,19730906,1973
BE-806687-A,19731029,1973
BE-813367-A,19740405,1974
BE-823416-A,19741216,1974
BE-825816-A,19750221,1975
BE-833811-A,19750925,1975
BE-837312-A,19760105,1976
BE-837857-A,19760123,1976
BE-840231-A,19760331,1976
BE-848755-A,19761125,1976
BE-852837-A,19770324,1977
BE-853553-A,19770413,1977
BE-857395-A,19770802,1977
BE-861199-A,19771125,1977
BE-866723-A,19780505,1978
BE-868080-A,19780613,1978
BE-868938-A,19780712,1978
BE-869056-A,19780717,1978
BE-871421-A,19781020,1978
BE-873394-A,19790110,1979
BE-877768-A,19790718,1979
BE-885287-A,19800918,1980
BE-509322-A,19520218,1952

2025-01-23 18:47:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 18:47:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 18:47:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 18:47:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 15
2025-01-23 18:47:37 - snowflake.connector.connection - INFO - closed
2025-01-23 18:47:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 18:47:37 - root - INFO - SQL:
SELECT
        LEFT(cpc_code.value:"code"::STRING, 4) AS "cpc_group",
        FLOOR("filing_date" / 10000) AS "filing_year",
        COUNT(*) AS "filing_count"
    FROM PATENTS.PATENTS.PUBLICATIONS,
    LATERAL FLATTEN(input => "cpc") cpc_code
    WHERE "country_code" = 'DE' AND "grant_date" BETWEEN 20161201 AND 20161231
    GROUP BY "cpc_group", "filing_year"
    ORDER BY "cpc_group", "filing_year"
    LIMIT 100;
Results:
cpc_group,filing_year,filing_count
B22F,2006,8
B60R,2013,1
B64G,2015,6
B82Y,2006,1
C21B,2013,2
C22B,2013,1
F16C,2015,6
F16K,2012,2
F27B,2013,1
F27D,2013,1
G03G,2009,1
H03H,2011,16
H04B,2011,2
H04N,2009,5
Y10S,2006,2

2025-01-23 18:47:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 18:47:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 18:47:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 18:47:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 18:47:38 - snowflake.connector.connection - INFO - closed
2025-01-23 18:47:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 18:47:39 - root - INFO - SQL:
SELECT "symbol", "titleFull" FROM PATENTS.PATENTS.CPC_DEFINITION LIMIT 100;
Results:
Too long, hard cut:
symbol,titleFull
B,PERFORMING OPERATIONS; TRANSPORTING
H,ELECTRICITY
Y,GENERAL TAGGING OF NEW TECHNOLOGICAL DEVELOPMENTS; GENERAL TAGGING OF CROSS-SECTIONAL TECHNOLOGIES SPANNING OVER SEVERAL SECTIONS OF THE IPC; TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS
D,TEXTILES; PAPER
F,MECHANICAL ENGINEERING; LIGHTING; HEATING; WEAPONS; BLASTING
E,FIXED CONSTRUCTIONS
C,CHEMISTRY; METALLURGY
G,PHYSICS
A,HUMAN NECESSITIES
A45,HAND OR TRAVELLING ARTICLES
A24,TOBACCO; CIGARS; CIGARETTES; SIMULATED SMOKING DEVICES; SMOKERS' REQUISITES
A61,MEDICAL OR VETERINARY SCIENCE; HYGIENE
A63,SPORTS; GAMES; AMUSEMENTS
A22,BUTCHERING; MEAT TREATMENT; PROCESSING POULTRY OR FISH
A42,HEADWEAR
A99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
A43,FOOTWEAR
A01,AGRICULTURE; FORESTRY; ANIMAL HUSBANDRY; HUNTING; TRAPPING; FISHING
A62,LIFE-SAVING; FIRE-FIGHTING
A23,"FOODS OR FOODSTUFFS; TREATMENT THEREOF, NOT COVERED BY OTHER CLASSES"
A47,FURNITURE; DOMESTIC ARTICLES OR APPLIANCES; COFFEE MILLS; SPICE MILLS; SUCTION CLEANERS IN GENERAL
A46,BRUSHWARE
A44,HABERDASHERY; JEWELLERY
A21,BAKING; EDIBLE DOUGHS
A41,WEARING APPAREL
B27,WORKING OR PRESERVING WOOD OR SIMILAR MATERIAL; NAILING OR STAPLING MACHINES IN GENERAL
B68,SADDLERY; UPHOLSTERY
B04,CENTRIFUGAL APPARATUS OR MACHINES FOR CARRYING-OUT PHYSICAL OR CHEMICAL PROCESSES
B23,MACHINE TOOLS; METAL-WORKING NOT OTHERWISE PROVIDED FOR
B30,PRESSES
B21,MECHANICAL METAL-WORKING WITHOUT ESSENTIALLY REMOVING MATERIAL; PUNCHING METAL
B25,HAND TOOLS; PORTABLE POWER-DRIVEN TOOLS; MANIPULATORS
B99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
B29,WORKING OF PLASTICS; WORKING OF SUBSTANCES IN A PLASTIC STATE IN GENERAL
B31,"MAKING ARTICLES OF PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER; WORKING PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER"
B26,HAND CUTTING TOOLS; CUTTING; SEVERING
B66,HOISTING; LIFTING; HAULING
B02,"CRUSHING, PULVERISING, OR DISINTEGRATING; PREPARATORY TREATMENT OF GRAIN FOR MILLING"
B65,CONVEYING; PACKING; STORING; HANDLING THIN OR FILAMENTARY MATERIAL
B61,RAILWAYS
B24,GRINDING; POLISHING
B06,GENERATING OR TRANSMITTING MECHANICAL VIBRATIONS IN GENERAL
B43,WRITING OR DRAWING IMPLEMENTS; BUREAU ACCESSORIES
B62,LAND VEHICLES FOR TRAVELLING OTHERWISE THAN ON RAILS
B64,AIRCRAFT; AVIATION; COSMONAUTICS
B22,CASTING; POWDER METALLURGY
B28,"WORKING CEMENT, CLAY, OR STONE"
B09,DISPOSAL OF SOLID WASTE; RECLAMATION OF CONTAMINATED SOIL
B01,PHYSICAL OR CHEMICAL PROCESSES OR APPARATUS IN GENERAL
B63,SHIPS OR OTHER WATERBORNE VESSELS; RELATED EQUIPMENT
B60,VEHICLES IN GENERAL
B44,DECORATIVE ARTS
B07,SEPARATING SOLIDS FROM SOLIDS; SORTING
B08,CLEANING
B82,NANOTECHNOLOGY
B42,BOOKBINDING; ALBUMS; FILES; SPECIAL PRINTED MATTER
B32,LAYERED PRODUCTS
B81,MICROSTRUCTURAL TECHNOLOGY
B05,"SPRAYING OR ATOMISING IN GENERAL; APPLYING FLUENT MATERIALS TO SURFACES, IN GENERAL"
B41,PRINTING; LINING MACHINES; TYPEWRITERS; STAMPS
B03,SEPARATION OF SOLID MATERIALS USING LIQUIDS OR USING PNEUMATIC TABLES OR JIGS; MAGNETIC OR ELECTROSTATIC SEPARATION OF SOLID MATERIALS FROM SOLID MATERIALS OR FLUIDS; SEPARATION BY HIGH-VOLTAGE ELECTRIC FIELDS
B67,"OPENING, CLOSING OR CLEANING BOTTLES, JARS OR SIMILAR CONTAINERS; LIQUID HANDLING"
B33,ADDITIVE MANUFACTURING TECHNOLOGY
C22,METALLURGY; FERROUS OR NON-FERROUS ALLOYS; TREATMENT OF ALLOYS OR NON-FERROUS METALS
C23,"COATING METALLIC MATERIAL; COATING MATERIAL WITH METALLIC MATERIAL; CHEMICAL SURFACE TREATMENT; DIFFUSION TREATMENT OF METALLIC MATERIAL; COATING BY VACUUM EVAPORATION, BY SPUTTERING, BY ION IMPLANTATION OR BY CHEMICAL VAPOUR DEPOSITION, IN GENERAL; INHIBITING CORROSION OF METALLIC MATERIAL OR INCRUSTATION IN GENERAL"
C06,EXPLOSIVES; MATCHES
C02,"TREATMENT OF WATER, WASTE WATER, SEWAGE, OR SLUDGE"
C07,ORGANIC CHEMISTRY
C25,ELECTROLYTIC OR ELECTROPHORETIC PROCESSES; APPARATUS THEREFOR
C30,CRYSTAL GROWTH
C12,BIOCHEMISTRY; BEER; SPIRITS; WINE; VINEGAR; MICROBIOLOGY; ENZYMOLOGY; MUTATION OR GENETIC ENGINEERING
C99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
C05,FERTILISERS; MANUFACTURE THEREOF
C40,COMBINATORIAL TECHNOLOGY
C11,"ANIMAL OR VEGETABLE OILS, FATS, FATTY SUBSTANCES OR WAXES; FATTY ACIDS THEREFROM; DETERGENTS; CANDLES"
C08,ORGANIC MACROMOLECULAR COMPOUNDS; THEIR PREPARATION OR CHEMICAL WORKING-UP; COMPOSITIONS BASED THEREON
C10,"PETROLEUM, GAS OR COKE INDUSTRIES; TECHNICAL GASES CONTAINING CARBON MONOXIDE; FUELS; LUBRICANTS; PEAT"
C21,METALLURGY OF IRON
C04,CEMENTS; CONCRETE; ARTIFICIAL STONE; CERAMICS; REFRACTORIES
C09,DYES; PAINTS; POLISHES; NATURAL RESINS; ADHESIVES; COMPOSITIONS NOT OTHERWISE PROVIDED FOR; APPLICATIONS OF MATERIALS NOT OTHERWISE PROVIDED FOR
C03,GLASS; MINERAL OR SLAG WOOL
C13,SUGAR INDUSTRY
C14,SKINS; HIDES; PELTS; LEATHER
C01,INORGANIC CHEMISTRY
D02,YARNS; MECHANICAL FINISHING OF YARNS OR ROPES; WARPING OR BEAMING
D21,PAPER-MAKING; PRODUCTION OF CELLULOSE
D04,BRAIDING; LACE-MAKING; KNITTING; TRIMMINGS; NON-WOVEN F

2025-01-23 18:47:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 18:47:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 18:47:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 18:47:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 15
2025-01-23 18:47:40 - snowflake.connector.connection - INFO - closed
2025-01-23 18:47:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 18:47:41 - root - INFO - SQL:
SELECT
        cpc_group_stats."cpc_group",
        cpc_def."titleFull",
        cpc_group_stats."filing_year",
        cpc_group_stats."filing_count"
    FROM
        (
            SELECT
                LEFT(cpc_code.value:"code"::STRING, 4) AS "cpc_group",
                FLOOR("filing_date" / 10000) AS "filing_year",
                COUNT(*) AS "filing_count"
            FROM PATENTS.PATENTS.PUBLICATIONS,
            LATERAL FLATTEN(input => "cpc") cpc_code
            WHERE "country_code" = 'DE' AND "grant_date" BETWEEN 20161201 AND 20161231
            GROUP BY "cpc_group", "filing_year"
        ) cpc_group_stats
    LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_def
    ON cpc_def."symbol" = cpc_group_stats."cpc_group"
    ORDER BY cpc_group_stats."cpc_group", cpc_group_stats."filing_year"
    LIMIT 100;
Results:
cpc_group,titleFull,filing_year,filing_count
B22F,WORKING METALLIC POWDER; MANUFACTURE OF ARTICLES FROM METALLIC POWDER; MAKING METALLIC POWDER; APPARATUS OR DEVICES SPECIALLY ADAPTED FOR METALLIC POWDER,2006,8
B60R,"VEHICLES, VEHICLE FITTINGS, OR VEHICLE PARTS, NOT OTHERWISE PROVIDED FOR",2013,1
B64G,COSMONAUTICS; VEHICLES OR EQUIPMENT THEREFOR,2015,6
B82Y,SPECIFIC USES OR APPLICATIONS OF NANOSTRUCTURES; MEASUREMENT OR ANALYSIS OF NANOSTRUCTURES; MANUFACTURE OR TREATMENT OF NANOSTRUCTURES,2006,1
C21B,MANUFACTURE OF IRON OR STEEL,2013,2
C22B,PRODUCTION AND REFINING OF METALS; PRETREATMENT OF RAW MATERIALS,2013,1
F16C,SHAFTS; FLEXIBLE SHAFTS; ELEMENTS OR CRANKSHAFT MECHANISMS; ROTARY BODIES OTHER THAN GEARING ELEMENTS; BEARINGS,2015,6
F16K,VALVES; TAPS; COCKS; ACTUATING-FLOATS; DEVICES FOR VENTING OR AERATING,2012,2
F27B,"FURNACES, KILNS, OVENS, OR RETORTS IN GENERAL; OPEN SINTERING OR LIKE APPARATUS",2013,1
F27D,"DETAILS OR ACCESSORIES OF FURNACES, KILNS, OVENS, OR RETORTS, IN SO FAR AS THEY ARE OF KINDS OCCURRING IN MORE THAN ONE KIND OF FURNACE",2013,1
G03G,ELECTROGRAPHY; ELECTROPHOTOGRAPHY; MAGNETOGRAPHY,2009,1
H03H,"IMPEDANCE NETWORKS, e.g. RESONANT CIRCUITS; RESONATORS",2011,16
H04B,TRANSMISSION,2011,2
H04N,"PICTORIAL COMMUNICATION, e.g. TELEVISION",2009,5
Y10S,TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS,2006,2

2025-01-23 18:47:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 18:47:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 18:47:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 18:47:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-23 18:47:42 - snowflake.connector.connection - INFO - closed
2025-01-23 18:47:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 18:48:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 18:48:13 - root - INFO - ```sql
SELECT
    cpc_def."titleFull" AS "Full_Title",
    cpc_group_stats."cpc_group" AS "CPC_Group",
    cpc_group_stats."best_year" AS "Best_Year"
FROM
    (
        SELECT
            "cpc_group",
            "best_year"
        FROM
            (
                SELECT
                    "cpc_group",
                    "filing_year" AS "best_year",
                    SUM("filing_count" * POWER(0.1, DATEDIFF('year', TO_DATE("filing_year" || '-01-01'), CURRENT_DATE()))) /
                    SUM(POWER(0.1, DATEDIFF('year', TO_DATE("filing_year" || '-01-01'), CURRENT_DATE()))) AS "ema"
                FROM
                    (
                        SELECT
                            LEFT(cpc_code.value:"code"::STRING, 4) AS "cpc_group",
                            EXTRACT(year FROM TRY_TO_DATE("filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
                            COUNT(*) AS "filing_count"
                        FROM
                            "PATENTS"."PATENTS"."PUBLICATIONS",
                            LATERAL FLATTEN(input => "cpc") cpc_code
                        WHERE
                            "country_code" = 'DE'
                            AND TRY_TO_DATE("grant_date"::VARCHAR, 'YYYYMMDD') BETWEEN '2016-01-01' AND '2016-12-31'
                            AND "grant_date" != 0
                            AND "filing_date" != 0
                        GROUP BY
                            "cpc_group", "filing_year"
                        HAVING
                            "filing_year" IS NOT NULL
                    ) sub
                GROUP BY
                    "cpc_group", "filing_year"
            ) ema_calc
        QUALIFY ROW_NUMBER() OVER (PARTITION BY "cpc_group" ORDER BY "ema" DESC) = 1
    ) cpc_group_stats
LEFT JOIN "PATENTS"."PATENTS"."CPC_DEFINITION" cpc_def
    ON cpc_def."symbol" = cpc_group_stats."cpc_group"
ORDER BY
    cpc_group_stats."cpc_group"
LIMIT 100;
```
2025-01-23 18:48:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 18:48:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 18:48:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 18:48:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 91
2025-01-23 18:48:15 - snowflake.connector.connection - INFO - closed
2025-01-23 18:48:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 18:48:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 18:48:38 - root - INFO - SQL:
SELECT
    cpc_def."titleFull" AS "Full_Title",
    cpc_group_stats."cpc_group" AS "CPC_Group",
    cpc_group_stats."best_year" AS "Best_Year"
FROM
    (
        SELECT
            "cpc_group",
            "best_year"
        FROM
            (
                SELECT
                    "cpc_group",
                    "filing_year" AS "best_year",
                    SUM("filing_count" * POWER(0.1, DATEDIFF('year', TO_DATE("filing_year" || '-01-01'), CURRENT_DATE()))) /
                    SUM(POWER(0.1, DATEDIFF('year', TO_DATE("filing_year" || '-01-01'), CURRENT_DATE()))) AS "ema"
                FROM
                    (
                        SELECT
                            LEFT(cpc_code.value:"code"::STRING, 4) AS "cpc_group",
                            EXTRACT(year FROM TRY_TO_DATE("filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
                            COUNT(*) AS "filing_count"
                        FROM
                            "PATENTS"."PATENTS"."PUBLICATIONS",
                            LATERAL FLATTEN(input => "cpc") cpc_code
                        WHERE
                            "country_code" = 'DE'
                            AND TRY_TO_DATE("grant_date"::VARCHAR, 'YYYYMMDD') BETWEEN '2016-01-01' AND '2016-12-31'
                            AND "grant_date" != 0
                            AND "filing_date" != 0
                        GROUP BY
                            "cpc_group", "filing_year"
                        HAVING
                            "filing_year" IS NOT NULL
                    ) sub
                GROUP BY
                    "cpc_group", "filing_year"
            ) ema_calc
        QUALIFY ROW_NUMBER() OVER (PARTITION BY "cpc_group" ORDER BY "ema" DESC) = 1
    ) cpc_group_stats
LEFT JOIN "PATENTS"."PATENTS"."CPC_DEFINITION" cpc_def
    ON cpc_def."symbol" = cpc_group_stats."cpc_group"
ORDER BY
    cpc_group_stats."cpc_group"
LIMIT 100;
Results:
Too long, hard cut:
Full_Title,CPC_Group,Best_Year
"SOIL WORKING IN AGRICULTURE OR FORESTRY; PARTS, DETAILS, OR ACCESSORIES OF AGRICULTURAL MACHINES OR IMPLEMENTS, IN GENERAL",A01B,2012
"HAIRDRESSING OR SHAVING EQUIPMENT; EQUIPMENT FOR COSMETICS OR COSMETIC TREATMENTS, e.g. FOR MANICURING OR PEDICURING",A45D,2013
TABLES; DESKS; OFFICE FURNITURE; CABINETS; DRAWERS; GENERAL DETAILS OF FURNITURE,A47B,2013
"TRANSPORT, PERSONAL CONVEYANCES, OR ACCOMMODATION SPECIALLY ADAPTED FOR PATIENTS OR DISABLED PERSONS; OPERATING TABLES OR CHAIRS; CHAIRS FOR DENTISTRY; FUNERAL DEVICES",A61G,2010
CONTAINERS SPECIALLY ADAPTED FOR MEDICAL OR PHARMACEUTICAL PURPOSES; DEVICES OR METHODS SPECIALLY ADAPTED FOR BRINGING PHARMACEUTICAL PRODUCTS INTO PARTICULAR PHYSICAL OR ADMINISTERING FORMS; DEVICES FOR ADMINISTERING FOOD OR MEDICINES ORALLY; BABY COMFORTERS; DEVICES FOR RECEIVING SPITTLE,A61J,2013
"MIXING, e.g. DISSOLVING, EMULSIFYING OR DISPERSING",B01F,2012
"CHEMICAL OR PHYSICAL PROCESSES, e.g. CATALYSIS OR COLLOID CHEMISTRY; THEIR RELEVANT APPARATUS",B01J,2012
MAGNETIC OR ELECTROSTATIC SEPARATION OF SOLID MATERIALS FROM SOLID MATERIALS OR FLUIDS; SEPARATION BY HIGH-VOLTAGE ELECTRIC FIELDS,B03C,2012
WORKING METALLIC POWDER; MANUFACTURE OF ARTICLES FROM METALLIC POWDER; MAKING METALLIC POWDER; APPARATUS OR DEVICES SPECIALLY ADAPTED FOR METALLIC POWDER,B22F,2006
"SOLDERING OR UNSOLDERING; WELDING; CLADDING OR PLATING BY SOLDERING OR WELDING; CUTTING BY APPLYING HEAT LOCALLY, e.g. FLAME CUTTING; WORKING BY LASER BEAM",B23K,2011
"MACHINES, DEVICES, OR PROCESSES FOR GRINDING OR POLISHING; DRESSING OR CONDITIONING OF ABRADING SURFACES; FEEDING OF GRINDING, POLISHING, OR LAPPING AGENTS",B24B,2012
MANIPULATORS; CHAMBERS PROVIDED WITH MANIPULATION DEVICES,B25J,2015
WORKING VENEER OR PLYWOOD,B27D,2009
PRESSES IN GENERAL,B30B,2009
"LAYERED PRODUCTS, i.e. PRODUCTS BUILT-UP OF STRATA OF FLAT OR NON-FLAT, e.g. CELLULAR OR HONEYCOMB, FORM",B32B,2002
VEHICLE TYRES; TYRE INFLATION; TYRE CHANGING; CONNECTING VALVES TO INFLATABLE ELASTIC BODIES IN GENERAL; DEVICES OR ARRANGEMENTS RELATED TO TYRES,B60C,2013
VEHICLE SUSPENSION ARRANGEMENTS,B60G,2011
"ARRANGEMENTS OF HEATING, COOLING, VENTILATING OR OTHER AIR-TREATING DEVICES SPECIALLY ADAPTED FOR PASSENGER OR GOODS SPACES OF VEHICLES",B60H,2004
PROPULSION OF ELECTRICALLY-PROPELLED VEHICLES; SUPPLYING ELECTRIC POWER FOR AUXILIARY EQUIPMENT OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRODYNAMIC BRAKE SYSTEMS FOR VEHICLES IN GENERAL; MAGNETIC SUSPENSION OR LEVITATION FOR VEHICLES; MONITORING OPERATING VARIABLES OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRIC SAFETY DEVICES FOR ELECTRICALLY-PROPELLED VEHICLES,B60L,2010
"VEHICLES, VEHICLE FITTINGS, OR VEHICLE PARTS, NOT OTHERWISE PROVIDED FOR",B60R,2015
"CYCLE SADDLES OR SEATS; AUXILIARY DEVICES OR ACCESSORIES SPECIALLY ADAPTED TO CYCLES AND NOT OTHERWISE PROVIDED FOR, e.g. ARTICLE CARRIERS OR CYCLE PROTECTORS",B62J,2014
RIDER PROPULSION OF WHEELED VEHICLES OR SLEDGES; POWERED PROPULSION OF SLEDGES OR SINGLE-TRACK CYCLES; TRANSMISSIONS SPECIALLY ADAPTED FOR SUCH VEHICLES,B62M,2014
COSMONAUTICS; VEHICLES OR EQUIPMENT THEREFOR,B64G,2015
"CONTAINERS FOR STORAGE OR TRANSPORT OF ARTICLES OR MATERIALS, e.g. BAGS, BARRELS, BOTTLES, BOXES, CANS, CARTONS, CRATES, DRUMS, JARS, TANKS, HOPPERS, FORWARDING CONTAINERS; ACCESSORIES, CLOSURES, OR FITTINGS THEREFOR; PACKAGING ELEMENTS; PACKAGES",B65D,2013
"HANDLING THIN OR FILAMENTARY MATERIAL, e.g. SHEETS, WEBS, CABLES",B65H,2009
SPECIFIC USES OR APPLICATIONS OF NANOSTRUCTURES; MEASUREMENT OR ANALYSIS OF NANOSTRUCTURES; MANUFACTURE OR TREATMENT OF NANOSTRUCTURES,B82Y,2006
"LIME, MAGNESIA; SLAG; CEMENTS; COMPOSITIONS THEREOF, e.g. MORTARS, CONCRETE OR LIKE BUILDING MATERIALS; ARTIFICIAL STONE; CERAMICS; REFRACTORIES; TREATMENT OF NATURAL STONE",C04B,2014
MACROMOLECULAR COMPOUNDS OBTAINED OTHERWISE THAN BY REACTIONS ONLY INVOLVING UNSATURATED CARBON-TO-CARBON BONDS,C08G,2012
"CRACKING HYDROCARBON OILS; PRODUCTION OF LIQUID HYDROCARBON MIXTURES, e.g. BY DESTRUCTIVE HYDROGENATION, OLIGOMERISATION, POLYMERISATION; RECOVERY OF HYDROCARBON OILS FROM OIL-SHALE, OIL-SAND, OR GASES; REFINING MIXTURES MAINLY CONSISTING OF HYDROCARBONS; REFORMING OF NAPHTHA; MINERAL WAXES",C10G,2012
MANUFACTURE OF IRON OR STEEL,C21B,2013
PRODUCTION AND REFINING OF METALS; PRETREATMENT OF RAW MATERIALS,C22B,2012
"COATING METALLIC MATERIAL; COATING MATERIAL WITH METALLIC MATERIAL; SURFACE TREATMENT OF METALLIC MATERIAL BY DIFFUSION INTO THE SURFACE, BY CHEMICAL CONVERSION OR SUBSTITUTION; COATING BY VACUUM EVAPORATION, BY SPUTTERING, BY ION IMPLANTATION OR BY CHEMICAL VAPOUR DEPOSITION, IN GENERAL",C23C,2008
"CHEMICAL FEATURES IN THE MANUFACTURE OF ARTIFICIAL FILAMENTS, THREADS, FIBRES, BRISTLES OR RIBBONS; APPARATUS SPECIALLY ADAPTED FOR THE MANUFACTURE OF CARBON FILAMENTS",D01F,2002
KNITTING,D04B,2014
"MAKING TEXTILE FABRICS, e.g. FROM FIBRES OR FILAMENTARY MATERIAL; FABRICS MADE BY SUCH PROCESSES OR APPARATUS, e.g. FELTS, NON-WOVEN FABRICS; COTTON-WOOL; WADDING ; NON-WOVEN 

2025-01-23 18:48:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 18:48:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 18:48:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 18:48:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 15
2025-01-23 18:48:40 - snowflake.connector.connection - INFO - closed
2025-01-23 18:48:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 18:48:40 - root - INFO - SQL:
SELECT
    LEFT(cpc_code.value:"code"::STRING, 4) AS "cpc_group",
    COUNT(*) AS "total_filings"
FROM PATENTS.PATENTS.PUBLICATIONS,
LATERAL FLATTEN(input => "cpc") cpc_code
WHERE "country_code" = 'DE'
  AND TRY_TO_DATE("grant_date"::VARCHAR, 'YYYYMMDD') BETWEEN '2016-12-01' AND '2016-12-31'
  AND "grant_date" != 0
GROUP BY "cpc_group"
ORDER BY "total_filings" DESC
LIMIT 100
Results:
cpc_group,total_filings
H03H,16
B22F,8
F16C,6
B64G,6
H04N,5
C21B,2
F16K,2
Y10S,2
H04B,2
F27B,1
C22B,1
B60R,1
B82Y,1
F27D,1
G03G,1

2025-01-23 18:48:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 18:48:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 18:48:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 18:48:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 15
2025-01-23 18:48:42 - snowflake.connector.connection - INFO - closed
2025-01-23 18:48:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 18:48:42 - root - INFO - SQL:
SELECT
    cpc_group_stats."cpc_group",
    cpc_def."titleFull",
    cpc_group_stats."total_filings"
FROM
    (
        SELECT
            LEFT(cpc_code.value:"code"::STRING, 4) AS "cpc_group",
            COUNT(*) AS "total_filings"
        FROM PATENTS.PATENTS.PUBLICATIONS,
        LATERAL FLATTEN(input => "cpc") cpc_code
        WHERE "country_code" = 'DE'
          AND TRY_TO_DATE("grant_date"::VARCHAR, 'YYYYMMDD') BETWEEN '2016-12-01' AND '2016-12-31'
          AND "grant_date" != 0
        GROUP BY "cpc_group"
    ) cpc_group_stats
LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_def
ON cpc_def."symbol" = cpc_group_stats."cpc_group"
ORDER BY cpc_group_stats."total_filings" DESC
LIMIT 100
Results:
cpc_group,titleFull,total_filings
H03H,"IMPEDANCE NETWORKS, e.g. RESONANT CIRCUITS; RESONATORS",16
B22F,WORKING METALLIC POWDER; MANUFACTURE OF ARTICLES FROM METALLIC POWDER; MAKING METALLIC POWDER; APPARATUS OR DEVICES SPECIALLY ADAPTED FOR METALLIC POWDER,8
B64G,COSMONAUTICS; VEHICLES OR EQUIPMENT THEREFOR,6
F16C,SHAFTS; FLEXIBLE SHAFTS; ELEMENTS OR CRANKSHAFT MECHANISMS; ROTARY BODIES OTHER THAN GEARING ELEMENTS; BEARINGS,6
H04N,"PICTORIAL COMMUNICATION, e.g. TELEVISION",5
C21B,MANUFACTURE OF IRON OR STEEL,2
F16K,VALVES; TAPS; COCKS; ACTUATING-FLOATS; DEVICES FOR VENTING OR AERATING,2
H04B,TRANSMISSION,2
Y10S,TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS,2
F27B,"FURNACES, KILNS, OVENS, OR RETORTS IN GENERAL; OPEN SINTERING OR LIKE APPARATUS",1
G03G,ELECTROGRAPHY; ELECTROPHOTOGRAPHY; MAGNETOGRAPHY,1
B60R,"VEHICLES, VEHICLE FITTINGS, OR VEHICLE PARTS, NOT OTHERWISE PROVIDED FOR",1
B82Y,SPECIFIC USES OR APPLICATIONS OF NANOSTRUCTURES; MEASUREMENT OR ANALYSIS OF NANOSTRUCTURES; MANUFACTURE OR TREATMENT OF NANOSTRUCTURES,1
F27D,"DETAILS OR ACCESSORIES OF FURNACES, KILNS, OVENS, OR RETORTS, IN SO FAR AS THEY ARE OF KINDS OCCURRING IN MORE THAN ONE KIND OF FURNACE",1
C22B,PRODUCTION AND REFINING OF METALS; PRETREATMENT OF RAW MATERIALS,1

2025-01-23 18:48:42 - root - INFO - itercount: 0
2025-01-23 18:48:42 - root - INFO - Database Name: PATENTS
Schema Name: PATENTS
DDL describes table information.
,0
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,1
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""spif_publication_number"" VARCHAR(16777216),
	""spif_application_number"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""claims_localized_html"" VARIANT,
	""description_localized"" VARIANT,
	""description_localized_html"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""locarno"" VARIANT,
	""citation"" VARIANT,
	""parent"" VARIANT,
	""child"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,2
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **Table**: `PATENTS.PATENTS.PUBLICATIONS`
   - **"publication_number"**: Identifies each patent publication.
   - **"country_code"**: To filter patents from Germany (`'DE'`).
   - **"grant_date"**: To filter patents granted in December 2016.
   - **"filing_date"**: To determine the filing year of the patent.
   - **"cpc"**: Contains the CPC codes assigned to each patent; we'll extract CPC groups at level 4 from this JSON variant column.

2. **Table**: `PATENTS.PATENTS.CPC_DEFINITION`
   - **"symbol"**: The CPC code symbol; to join with CPC groups and obtain titles.
   - **"titleFull"**: The full title of the CPC group; to display in the results.

**Conditions that may be used:**

- `"country_code" = 'DE'` to select patents from Germany.
- `"grant_date"` between `20161201` and `20161231` to select patents granted in December 2016.
- Extract filing years from `"filing_date"` for yearly analysis.
- Extract CPC group codes at level 4 from `"cpc"` column.

---

**SQL Queries to Explore the Data:**

1. **View Sample Data from `PUBLICATIONS` Table**

   ```sql
   SELECT * FROM PATENTS.PATENTS.PUBLICATIONS LIMIT 10;
   ```

2. **List Distinct Country Codes**

   ```sql
   SELECT DISTINCT "country_code" FROM PATENTS.PATENTS.PUBLICATIONS LIMIT 100;
   ```

3. **View Grant Dates for German Patents**

   ```sql
   SELECT "grant_date" FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "country_code" = 'DE' LIMIT 100;
   ```

4. **Find Patents Granted in December 2016**

   ```sql
   SELECT "publication_number", "grant_date" FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "grant_date" BETWEEN 20161201 AND 20161231 LIMIT 100;
   ```

5. **Get German Patents Granted in December 2016**

   ```sql
   SELECT "publication_number", "grant_date" FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "country_code" = 'DE' AND "grant_date" BETWEEN 20161201 AND 20161231 LIMIT 100;
   ```

6. **Explore the Structure of the "cpc" Column**

   ```sql
   SELECT "publication_number", "cpc" FROM PATENTS.PATENTS.PUBLICATIONS LIMIT 10;
   ```

7. **Extract CPC Codes from the "cpc" Column**

   ```sql
   SELECT "publication_number", cpc_code.value:"code"::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS,
   LATERAL FLATTEN(input => "cpc") cpc_code
   LIMIT 100;
   ```

8. **Get CPC Codes for German Patents Granted in December 2016**

   ```sql
   SELECT "publication_number", cpc_code.value:"code"::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS,
   LATERAL FLATTEN(input => "cpc") cpc_code
   WHERE "country_code" = 'DE' AND "grant_date" BETWEEN 20161201 AND 20161231
   LIMIT 100;
   ```

9. **Extract CPC Groups at Level 4**

   ```sql
   SELECT "publication_number", LEFT(cpc_code.value:"code"::STRING, 4) AS "cpc_group"
   FROM PATENTS.PATENTS.PUBLICATIONS,
   LATERAL FLATTEN(input => "cpc") cpc_code
   LIMIT 100;
   ```

10. **Determine Filing Years for Patents**

    ```sql
    SELECT "publication_number", "filing_date", FLOOR("filing_date" / 10000) AS "filing_year"
    FROM PATENTS.PATENTS.PUBLICATIONS LIMIT 100;
    ```

11. **Count Filings per Year per CPC Group**

    ```sql
    SELECT
        LEFT(cpc_code.value:"code"::STRING, 4) AS "cpc_group",
        FLOOR("filing_date" / 10000) AS "filing_year",
        COUNT(*) AS "filing_count"
    FROM PATENTS.PATENTS.PUBLICATIONS,
    LATERAL FLATTEN(input => "cpc") cpc_code
    WHERE "country_code" = 'DE' AND "grant_date" BETWEEN 20161201 AND 20161231
    GROUP BY "cpc_group", "filing_year"
    ORDER BY "cpc_group", "filing_year"
    LIMIT 100;
    ```

12. **View CPC Symbols and Titles from `CPC_DEFINITION` Table**

    ```sql
    SELECT "symbol", "titleFull" FROM PATENTS.PATENTS.CPC_DEFINITION LIMIT 100;
    ```

13. **Join CPC Groups with Their Full Titles**

    ```sql
    SELECT
        cpc_group_stats."cpc_group",
        cpc_def."titleFull",
        cpc_group_stats."filing_year",
        cpc_group_stats."filing_count"
    FROM
        (
            SELECT
                LEFT(cpc_code.value:"code"::STRING, 4) AS "cpc_group",
                FLOOR("filing_date" / 10000) AS "filing_year",
                COUNT(*) AS "filing_count"
            FROM PATENTS.PATENTS.PUBLICATIONS,
            LATERAL FLATTEN(input => "cpc") cpc_code
            WHERE "country_code" = 'DE' AND "grant_date" BETWEEN 20161201 AND 20161231
            GROUP BY "cpc_group", "filing_year"
        ) cpc_group_stats
    LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_def
    ON cpc_def."symbol" = cpc_group_stats."cpc_group"
    ORDER BY cpc_group_stats."cpc_group", cpc_group_stats."filing_year"
    LIMIT 100;
    ```

14. **Analyze Filing Trends Over the Years for a Specific CPC Group**

    ```sql
    SELECT
        FLOOR("filing_date" / 10000) AS "filing_year",
        COUNT(*) AS "filing_count"
    FROM PATENTS.PATENTS.PUBLICATIONS,
    LATERAL FLATTEN(input => "cpc") cpc_code
    WHERE "country_code" = 'DE'
        AND "grant_date" BETWEEN 20161201 AND 20161231
        AND LEFT(cpc_code.value:"code"::STRING, 4) = 'H04L'  -- Example CPC group
    GROUP BY "filing_year"
    ORDER BY "filing_year"
    LIMIT 100;
    ```

15. **Calculate Total Filings per CPC Group**

    ```sql
    SELECT
        LEFT(cpc_code.value:"code"::STRING, 4) AS "cpc_group",
        COUNT(*) AS "total_filings"
    FROM PATENTS.PATENTS.PUBLICATIONS,
    LATERAL FLATTEN(input => "cpc") cpc_code
    WHERE "country_code" = 'DE' AND "grant_date" BETWEEN 20161201 AND 20161231
    GROUP BY "cpc_group"
    ORDER BY "total_filings" DESC
    LIMIT 100;
    ```

16. **Identify Top CPC Groups by Filing Count**

    ```sql
    SELECT
        cpc_group_stats."cpc_group",
        cpc_def."titleFull",
        cpc_group_stats."total_filings"
    FROM
        (
            SELECT
                LEFT(cpc_code.value:"code"::STRING, 4) AS "cpc_group",
                COUNT(*) AS "total_filings"
            FROM PATENTS.PATENTS.PUBLICATIONS,
            LATERAL FLATTEN(input => "cpc") cpc_code
            WHERE "country_code" = 'DE' AND "grant_date" BETWEEN 20161201 AND 20161231
            GROUP BY "cpc_group"
        ) cpc_group_stats
    LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_def
    ON cpc_def."symbol" = cpc_group_stats."cpc_group"
    ORDER BY cpc_group_stats."total_filings" DESC
    LIMIT 100;
    ```

These queries range from simple data retrieval to more complex analyses involving joins and aggregations. They help in understanding the data structure, exploring relevant columns, and preparing to compute the exponential moving average of patent filings per CPC group.Query:
SELECT * FROM PATENTS.PATENTS.PUBLICATIONS LIMIT 10;
Answer:
Too long, hard cut:
publication_number,application_number,country_code,kind_code,application_kind,application_number_formatted,pct_number,family_id,spif_publication_number,spif_application_number,title_localized,abstract_localized,claims_localized,claims_localized_html,description_localized,description_localized_html,publication_date,filing_date,grant_date,priority_date,priority_claim,inventor,inventor_harmonized,assignee,assignee_harmonized,examiner,uspc,ipc,cpc,fi,fterm,locarno,citation,parent,child,entity_status,art_unit
CR-5634-A,CR-5634-A,CR,A,A,CR5634A,,44839011,,,"[
  {
    ""language"": ""es"",
    ""text"": ""Procedimiento para el analisis de aflatoxinas por cromatografia directa"",
    ""truncated"": false
  }
]","[
  {
    ""language"": ""es"",
    ""text"": ""consiste en colocar una muestra solida de cereal o leguminosa en una bandeja especial desarrollada para esta metodologia (bandeja de cromatografia), la cual en su base interior (fondo) posee un substrato sensible a las aflatoxinas, que al momento de la prueba se remoja con un disolvente extractor. Las particulas contaminadas liberan aflatoxinas que eluyen hacia el substrato en una area localizada alrededor de la particula contaminada. Despues de remover la muestra la bandeja se observa bajo luz ultravioleta de 365 nm, con la cual se observan pequenas manchas azules en los sitios donde hubo particulas contaminadas. Se encontro que existe una correlacion altamente significativa entre el numero de particulas que liberan aflatoxinas hacia el substrato sensible (manchas azules) y el contenido de aflatoxinas obtenido mediante un metodo quimico cuantitativo."",
    ""truncated"": false
  }
]",[],[],[],[],19980507,19971015,0,19971015,"[
  {
    ""application_number"": ""CR-5634-A"",
    ""category"": """",
    ""filing_date"": 19971015,
    ""npl_text"": """",
    ""publication_number"": """",
    ""type"": """"
  }
]","[
  ""FAUSTO CAMACHO CHACON""
]","[
  {
    ""country_code"": ""CR"",
    ""name"": ""FAUSTO CAMACHO CHACON""
  }
]","[
  ""Univ Costa Rica""
]","[
  {
    ""country_code"": ""CR"",
    ""name"": ""UNIV COSTA RICA""
  }
]",[],[],"[
  {
    ""code"": ""G01N21/01"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]",[],[],[],[],[],[],[],,
CR-5990-A,CR-5990-A,CR,A,A,CR5990A,,44839034,,,"[
  {
    ""language"": ""es"",
    ""text"": ""Derivados de acido fenil-metoxi-imino-glioxilico como plaguicidas"",
    ""truncated"": false
  }
]","[
  {
    ""language"": ""es"",
    ""text"": ""derivados de acido 2-imino-metil-fenil-acetico que tiene una actividad microbicida, insecticida, y acaricida, a un proceso para la preparacion de los mismos, a nuevos intermediarios para su preparacion, a composiciones agroquimicas que contienen estos ingredientes activos, asi como a su uso en el control y prevencion de hongos, acaros, e insectos patagonicos de plantas end agricultura y en el campo de higiene."",
    ""truncated"": false
  }
]",[],[],[],[],19991217,19990322,0,19980327,"[
  {
    ""application_number"": ""CH-7359998-A"",
    ""category"": """",
    ""filing_date"": 19980327,
    ""npl_text"": """",
    ""publication_number"": """",
    ""type"": """"
  }
]","[
  ""HUGO ZIEGLER"",
  ""RENE ZURFUG""
]","[
  {
    ""country_code"": ""CH"",
    ""name"": ""HUGO ZIEGLER""
  },
  {
    ""country_code"": ""CH"",
    ""name"": ""RENE ZURFUG""
  }
]","[
  ""Bayer Ag""
]","[
  {
    ""country_code"": ""DE"",
    ""name"": ""BAYER AG""
  }
]",[],[],[],[],[],[],[],[],[],[],,
FI-429-A,FI-429D-A,FI,A,A,,,36849362,,,"[
  {
    ""language"": ""fi"",
    ""text"": ""Förbättringar af tjärbränningsugnar med rörledning för trädestillation"",
    ""truncated"": false
  }
]",[],[],[],[],[],18920810,0,0,0,"[
  {
    ""application_number"": ""FI-429T-A"",
    ""category"": """",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": """",
    ""type"": """"
  }
]","[
  ""LOEFHJELM KARL""
]","[
  {
    ""country_code"": ""FI"",
    ""name"": ""KARL LOEFHJELM""
  }
]",[],[],[],[],"[
  {
    ""code"": ""C10C1/00"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]",[],[],[],[],[],[],[],,
HK-6083-A,HK-6083-A,HK,A,A,HK6083A,,9714822,,,"[
  {
    ""language"": ""en"",
    ""text"": ""A new or improved alternating current control device"",
    ""truncated"": false
  }
]",[],[],[],[],[],19830217,19830217,0,19780111,"[
  {
    ""application_number"": ""GB-102478-A"",
    ""category"": """",
    ""filing_date"": 19780111,
    ""npl_text"": """",
    ""publication_number"": """",
    ""type"": """"
  }
]","[
  ""SPENCER GRAHAM JOHN"",
  ""TYLOR RONALD"",
  ""WATKINS FREDERICK GEORGE""
]","[
  {
    ""country_code"": """",
    ""name"": ""SPENCER GRAHAM JOHN""
  },
  {
    ""country_code"": """",
    ""name"": ""TYLOR RONALD""
  },
  {
    ""country_code"": """",
    ""name"": ""WATKINS FREDERICK GEORGE""
  }
]","[
  ""Crabtree Electrical Ind Ltd""
]","[
  {
    ""country_code"": ""GB"",
    ""name"": ""CRABTREE ELECTRICAL IND LTD""
  }
]
Query:
SELECT DISTINCT "country_code" FROM PATENTS.PATENTS.PUBLICATIONS LIMIT 100;
Answer:
country_code
DO
LT
TR
BG
YU
ZM
AU
CU
HK
GT
TN
UA
MW
CO
GR
MD
PL
CR
CH
KR
RO
US
DE
DD
PH
EG
PA
IT
CY
OA
SG
GB
ZW
RS
MA
SA
MN
HR
NL
ZA
EP
BA
MY
LV
CS
JP
HU
DZ
AR
KE
SI
CA
SK
IS
SE
AP
IE
ES
EA
CN
MC
PE
AT
IL
TW
MT
BE
IN
EC
MX
EE
GE
NO
LU
DK
FI
NI
HN
CZ
SV
BR
ID
KZ
WO
RU
JO
SM
ME
PT
CL
NZ
FR
SU
Query:
SELECT
    cpc_def."titleFull" AS "Full_Title",
    cpc_group_stats."cpc_group" AS "CPC_Group",
    cpc_group_stats."best_year" AS "Best_Year"
FROM
    (
        SELECT
            "cpc_group",
            "best_year"
        FROM
            (
                SELECT
                    "cpc_group",
                    "filing_year" AS "best_year",
                    SUM("filing_count" * POWER(0.1, DATEDIFF('year', TO_DATE("filing_year" || '-01-01'), CURRENT_DATE()))) /
                    SUM(POWER(0.1, DATEDIFF('year', TO_DATE("filing_year" || '-01-01'), CURRENT_DATE()))) AS "ema"
                FROM
                    (
                        SELECT
                            LEFT(cpc_code.value:"code"::STRING, 4) AS "cpc_group",
                            EXTRACT(year FROM TRY_TO_DATE("filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
                            COUNT(*) AS "filing_count"
                        FROM
                            "PATENTS"."PATENTS"."PUBLICATIONS",
                            LATERAL FLATTEN(input => "cpc") cpc_code
                        WHERE
                            "country_code" = 'DE'
                            AND TRY_TO_DATE("publication_date"::VARCHAR, 'YYYYMMDD') BETWEEN '2016-12-01' AND '2016-12-31'
                            AND "filing_date" != 0
                        GROUP BY
                            "cpc_group", "filing_year"
                        HAVING
                            "filing_year" IS NOT NULL
                    ) sub
                GROUP BY
                    "cpc_group", "filing_year"
            ) ema_calc
        QUALIFY ROW_NUMBER() OVER (PARTITION BY "cpc_group" ORDER BY "ema" DESC) = 1
    ) cpc_group_stats
LEFT JOIN "PATENTS"."PATENTS"."CPC_DEFINITION" cpc_def
    ON cpc_def."symbol" = cpc_group_stats."cpc_group"
ORDER BY
    cpc_group_stats."cpc_group";
Answer:
Too long, hard cut:
Full_Title,CPC_Group,Best_Year
DOMESTIC WASHING OR CLEANING; SUCTION CLEANERS IN GENERAL,A47L,2015
"FILTERS IMPLANTABLE INTO BLOOD VESSELS; PROSTHESES; DEVICES PROVIDING PATENCY TO, OR PREVENTING COLLAPSING OF, TUBULAR STRUCTURES OF THE BODY, e.g. STENTS; ORTHOPAEDIC, NURSING OR CONTRACEPTIVE DEVICES; FOMENTATION; TREATMENT OR PROTECTION OF EYES OR EARS; BANDAGES, DRESSINGS OR ABSORBENT PADS; FIRST-AID KITS",A61F,2015
"APPARATUS FOR PHYSICAL TRAINING, GYMNASTICS, SWIMMING, CLIMBING, OR FENCING; BALL GAMES; TRAINING EQUIPMENT",A63B,2015
"DEVICES FOR THEATRES, CIRCUSES, OR THE LIKE; CONJURING APPLIANCES OR THE LIKE",A63J,2015
WORKING METALLIC POWDER; MANUFACTURE OF ARTICLES FROM METALLIC POWDER; MAKING METALLIC POWDER; APPARATUS OR DEVICES SPECIALLY ADAPTED FOR METALLIC POWDER,B22F,2006
MILLING,B23C,2015
"SOLDERING OR UNSOLDERING; WELDING; CLADDING OR PLATING BY SOLDERING OR WELDING; CUTTING BY APPLYING HEAT LOCALLY, e.g. FLAME CUTTING; WORKING BY LASER BEAM",B23K,2015
"DETAILS, COMPONENTS, OR ACCESSORIES FOR MACHINE TOOLS, e.g. ARRANGEMENTS FOR COPYING OR CONTROLLING; MACHINE TOOLS IN GENERAL CHARACTERISED BY THE CONSTRUCTION OF PARTICULAR DETAILS OR COMPONENTS; COMBINATIONS OR ASSOCIATIONS OF METAL-WORKING MACHINES, NOT DIRECTED TO A PARTICULAR RESULT",B23Q,2015
MANIPULATORS; CHAMBERS PROVIDED WITH MANIPULATION DEVICES,B25J,2015
"CUTTING; DETAILS COMMON TO MACHINES FOR PERFORATING, PUNCHING, CUTTING-OUT, STAMPING-OUT OR SEVERING",B26D,2015
PERFORATING; PUNCHING; CUTTING-OUT; STAMPING-OUT; SEVERING BY MEANS OTHER THAN CUTTING,B26F,2015
"SHAPING OR JOINING OF PLASTICS; SHAPING OF MATERIAL IN A PLASTIC STATE, NOT OTHERWISE PROVIDED FOR; AFTER-TREATMENT OF THE SHAPED PRODUCTS, e.g. REPAIRING",B29C,2015
"INDEXING SCHEME ASSOCIATED WITH SUBCLASS B29C, RELATING TO PARTICULAR ARTICLES",B29L,2015
PROPULSION OF ELECTRICALLY-PROPELLED VEHICLES; SUPPLYING ELECTRIC POWER FOR AUXILIARY EQUIPMENT OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRODYNAMIC BRAKE SYSTEMS FOR VEHICLES IN GENERAL; MAGNETIC SUSPENSION OR LEVITATION FOR VEHICLES; MONITORING OPERATING VARIABLES OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRIC SAFETY DEVICES FOR ELECTRICALLY-PROPELLED VEHICLES,B60L,2016
"VEHICLES, VEHICLE FITTINGS, OR VEHICLE PARTS, NOT OTHERWISE PROVIDED FOR",B60R,2013
"SERVICING, CLEANING, REPAIRING, SUPPORTING, LIFTING, OR MANOEUVRING OF VEHICLES, NOT OTHERWISE PROVIDED FOR",B60S,2016
"VEHICLE BRAKE CONTROL SYSTEMS OR PARTS THEREOF; BRAKE CONTROL SYSTEMS OR PARTS THEREOF, IN GENERAL; ARRANGEMENT OF BRAKING ELEMENTS ON VEHICLES IN GENERAL; PORTABLE DEVICES FOR PREVENTING UNWANTED MOVEMENT OF VEHICLES; VEHICLE MODIFICATIONS TO FACILITATE COOLING OF BRAKES",B60T,2015
BRAKES OR OTHER RETARDING DEVICES SPECIALLY ADAPTED FOR RAIL VEHICLES; ARRANGEMENT OR DISPOSITION THEREOF IN RAIL VEHICLES,B61H,2015
"HAND-PROPELLED VEHICLES, e.g. HAND CARTS OR PERAMBULATORS; SLEDGES",B62B,2015
COSMONAUTICS; VEHICLES OR EQUIPMENT THEREFOR,B64G,2015
"MACHINES, APPARATUS OR DEVICES FOR, OR METHODS OF, PACKAGING ARTICLES OR MATERIALS; UNPACKING",B65B,2015
SPECIFIC USES OR APPLICATIONS OF NANOSTRUCTURES; MEASUREMENT OR ANALYSIS OF NANOSTRUCTURES; MANUFACTURE OR TREATMENT OF NANOSTRUCTURES,B82Y,2006
MANUFACTURE OF IRON OR STEEL,C21B,2013
PRODUCTION AND REFINING OF METALS; PRETREATMENT OF RAW MATERIALS,C22B,2013
"NON-POSITIVE DISPLACEMENT MACHINES OR ENGINES, e.g. STEAM TURBINES",F01D,2015
INTERNAL-COMBUSTION PISTON ENGINES; COMBUSTION ENGINES IN GENERAL,F02B,2015
"INDEXING SCHEME FOR ASPECTS RELATING TO NON-POSITIVE-DISPLACEMENT MACHINES OR ENGINES, GAS-TURBINES OR JET-PROPULSION PLANTS",F05D,2015
SHAFTS; FLEXIBLE SHAFTS; ELEMENTS OR CRANKSHAFT MECHANISMS; ROTARY BODIES OTHER THAN GEARING ELEMENTS; BEARINGS,F16C,2015
COUPLINGS FOR TRANSMITTING ROTATION; CLUTCHES; BRAKES,F16D,2015
VALVES; TAPS; COCKS; ACTUATING-FLOATS; DEVICES FOR VENTING OR AERATING,F16K,2012
REFRIGERATORS; COLD ROOMS; ICE-BOXES; COOLING OR FREEZING APPARATUS NOT OTHERWISE PROVIDED FOR,F25D,2015
"FURNACES, KILNS, OVENS, OR RETORTS IN GENERAL; OPEN SINTERING OR LIKE APPARATUS",F27B,2013
"DETAILS OR ACCESSORIES OF FURNACES, KILNS, OVENS, OR RETORTS, IN SO FAR AS THEY ARE OF KINDS OCCURRING IN MORE THAN ONE KIND OF FURNACE",F27D,2013
MEASURING ELECTRIC VARIABLES; MEASURING MAGNETIC VARIABLES,G01R,2016
RADIO DIRECTION-FINDING; RADIO NAVIGATION; DETERMINING DISTANCE OR VELOCITY BY USE OF RADIO WAVES; LOCATING OR PRESENCE-DETECTING BY USE OF THE REFLECTION OR RERADIATION OF RADIO WAVES; ANALOGOUS ARRANGEMENTS USING OTHER WAVES,G01S,2016
ELECTROGRAPHY; ELECTROPHOTOGRAPHY; MAGNETOGRAPHY,G03G,2009
CONTROL OR REGULATING SYSTEMS IN GENERAL; FUNCTIONAL ELEMENTS OF SUCH SYSTEMS; MONITORING OR TESTING ARRANGEMENTS FOR SUCH SYSTEMS OR ELEMENTS,G05B,2015
"PROCESSES OR MEANS, e.g. BATTERIES, FOR THE DIRECT CONVERSION OF CHEMICAL ENERGY INTO ELECTRICAL ENERGY",H01M,2016
CIRCUIT ARRANGEMENTS OR SYSTEMS FOR SUPPLYING OR DISTRIBUTING ELECTRIC POWER; SYSTEMS FOR STORING ELECTRIC ENERGY,H02J,2016
"IMPEDANCE NETWORKS, e.g. 
Query:
SELECT "publication_number", "grant_date" FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "grant_date" BETWEEN 20161201 AND 20161231 LIMIT 100;
Answer:
publication_number,grant_date
DE-102015114819-B3,20161222
DE-112006001900-B4,20161215
RU-2604500-C1,20161210
KR-101688574-B1,20161221
KR-101685829-B1,20161212
KR-101690893-B1,20161228
KR-101688758-B1,20161221
AU-2015207934-B2,20161208
US-9522312-B2,20161220
JP-6038569-B2,20161207
JP-6053144-B2,20161227
JP-6051422-B2,20161227
US-9531453-B2,20161227
US-9516929-B1,20161213
EP-2636423-B1,20161207
FR-3030443-B1,20161209
FR-2933892-B1,20161230
US-9522418-B2,20161220
US-9529473-B2,20161227
EP-2903185-B1,20161221
KR-101689855-B1,20161226
KR-101690655-B1,20161228
KR-101690861-B1,20161228
KR-101689017-B1,20161223
KR-101690043-B1,20161228
KR-101684962-B1,20161209
KR-101682521-B1,20161206
KR-101681874-B1,20161202
KR-101688034-B1,20161220
US-9514786-B2,20161206
ES-2561934-B1,20161209
JP-6044917-B1,20161214
KR-101677718-B1,20161206
KR-101690331-B1,20161227
JP-6039196-B2,20161207
JP-6039332-B2,20161207
JP-6040682-B2,20161207
JP-6042255-B2,20161214
JP-6053747-B2,20161227
RU-2604294-C1,20161210
RU-166963-U1,20161220
AU-2013206757-B2,20161222
JP-6044148-B2,20161214
JP-6053903-B1,20161227
KR-101684517-B1,20161208
KR-101686006-B1,20161213
KR-101691069-B1,20161230
KR-101685861-B1,20161212
KR-101685409-B1,20161213
KR-101691045-B1,20161229
US-9531867-B2,20161227
US-9529903-B2,20161227
KR-101690772-B1,20161229
KR-101689501-B1,20161223
KR-101691483-B1,20161230
CN-103298972-B,20161221
CN-103185353-B,20161221
CN-104112539-B,20161228
CN-103744846-B,20161228
CN-104751568-B,20161228
US-9513680-B2,20161206
US-9518924-B2,20161213
US-9520447-B2,20161213
US-9513676-B2,20161206
JP-6047217-B1,20161221
KR-101690544-B1,20161228
CN-103958277-B,20161221
CN-104234659-B,20161228
CN-104139310-B,20161228
CN-103426965-B,20161228
CN-104627431-B,20161207
CN-104776707-B,20161207
KR-101690580-B1,20161228
KR-101689788-B1,20161227
CN-103085523-B,20161221
CN-103078923-B,20161228
CN-103477337-B,20161228
CN-103430599-B,20161214
CN-103687974-B,20161221
CN-103280586-B,20161228
CN-104174599-B,20161228
CN-104192340-B,20161207
CN-104494390-B,20161207
JP-1487073-S,20161212
CA-168133-S,20161215
JP-1565184-S,20161212
JP-6041466-B2,20161207
JP-6042613-B2,20161214
JP-6038817-B2,20161207
JP-6050450-B2,20161221
JP-6041584-B2,20161214
JP-6051996-B2,20161227
JP-6042378-B2,20161214
JP-6053830-B2,20161227
JP-6044919-B2,20161214
JP-6054331-B2,20161227
CN-205814045-U,20161221
CN-205813256-U,20161221
CN-205795800-U,20161214
CN-205785887-U,20161207
Query:
SELECT "publication_number", "grant_date" FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "country_code" = 'DE' AND "grant_date" BETWEEN 20161201 AND 20161231 LIMIT 100;
Answer:
publication_number,grant_date
DE-102015114819-B3,20161222
DE-112006001900-B4,20161215
DE-102009051197-B4,20161222
DE-102011005349-B4,20161215
DE-102012004706-B4,20161222
DE-102013203286-B4,20161222
DE-112013006743-B4,20161208
Query:
SELECT "publication_number", "cpc" FROM PATENTS.PATENTS.PUBLICATIONS LIMIT 10;
Answer:
publication_number,cpc
CR-5634-A,[]
CR-5990-A,[]
FI-429-A,[]
HK-6083-A,"[
  {
    ""code"": ""H02M5/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
HU-T52763-A,"[
  {
    ""code"": ""A01N47/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D521/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
JP-H03206829-A,"[
  {
    ""code"": ""Y02A40/81"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
JP-S62159089-A,"[
  {
    ""code"": ""Y02E30/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
US-416-A,"[
  {
    ""code"": ""Y10T83/465"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""B26F1/42"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
US-2528225-A,"[
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A41580-A,"[
  {
    ""code"": ""B22D11/086"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
Query:
SELECT "publication_number", cpc_code.value:"code"::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS,
   LATERAL FLATTEN(input => "cpc") cpc_code
   LIMIT 100;
Answer:
publication_number,cpc_code
US-8857551-B2,B60G3/145
US-8857551-B2,B60G2200/44
US-8857551-B2,B60G2300/122
US-8857551-B2,B60G2300/45
US-8857551-B2,B60G3/145
US-8857551-B2,B60G3/00
US-8857551-B2,B60G2200/44
US-8857551-B2,B62K5/08
US-8857551-B2,B60G2300/122
US-8857551-B2,B60G3/26
US-8857551-B2,B60G2300/45
US-8857551-B2,B62K5/08
US-8857551-B2,B60G3/00
US-8857551-B2,B60G3/26
US-9370027-B2,H04L12/1863
US-9370027-B2,H04W60/00
US-9370027-B2,H04W8/18
US-9370027-B2,H04W80/04
US-9370027-B2,H04W4/06
US-9370027-B2,H04W76/002
US-9370027-B2,H04L12/189
US-9370027-B2,H04L12/1863
US-9370027-B2,H04W4/06
US-9370027-B2,H04W80/04
US-9370027-B2,H04L12/1863
US-9370027-B2,H04W60/00
US-9370027-B2,H04W76/40
US-9370027-B2,H04W8/18
US-9370027-B2,H04W4/06
US-9370027-B2,H04W80/04
US-9370027-B2,H04L12/189
US-9370027-B2,H04L12/189
US-9370027-B2,H04W60/00
US-9370027-B2,H04W8/18
US-9370027-B2,H04W76/40
US-9042351-B2,H04W28/18
US-9042351-B2,H04L5/0091
US-9042351-B2,H04W52/0229
US-9042351-B2,H04W28/18
US-9042351-B2,H04W52/0229
US-9042351-B2,H04W52/0229
US-9042351-B2,H04W28/18
US-9042351-B2,Y02D30/70
US-9042351-B2,Y02D30/70
US-9042351-B2,H04L5/0091
US-10561638-B2,A61P43/00
US-10561638-B2,A61P9/10
US-10561638-B2,A61P9/06
US-10561638-B2,A61P25/36
US-10561638-B2,A61P25/34
US-10561638-B2,A61P25/32
US-10561638-B2,A61P25/30
US-10561638-B2,A61P25/28
US-10561638-B2,A61P25/24
US-10561638-B2,A61P25/22
US-10561638-B2,A61P25/20
US-10561638-B2,A61P25/18
US-10561638-B2,A61P25/14
US-10561638-B2,A61P25/12
US-10561638-B2,A61P25/08
US-10561638-B2,A61P25/06
US-10561638-B2,A61P25/02
US-10561638-B2,A61P11/02
US-10561638-B2,A61P11/00
US-10561638-B2,A61P1/08
US-10561638-B2,A61K31/417
US-10561638-B2,A61K31/415
US-10561638-B2,A61K9/08
US-10561638-B2,A61K31/415
US-10561638-B2,A61K31/4164
US-10561638-B2,A61K45/06
US-10561638-B2,A61K31/417
US-10561638-B2,A61K31/417
US-10561638-B2,A61K31/417
US-10561638-B2,A61K31/415
US-10561638-B2,A61K45/06
US-10561638-B2,A61K9/08
US-10561638-B2,A61K31/4164
US-10561638-B2,A61K9/08
US-8962445-B2,H01L21/76232
US-8962445-B2,H01L29/66666
US-8962445-B2,H01L21/76232
US-8962445-B2,H01L21/76224
US-8962445-B2,H01L29/66666
US-8962445-B2,H01L27/10891
US-8962445-B2,H01L21/76232
US-8962445-B2,H01L21/76224
US-8962445-B2,H01L27/10885
US-8962445-B2,H01L27/10823
US-8962445-B2,H01L29/66666
US-8962445-B2,H10B12/488
US-8962445-B2,H10B12/34
US-8962445-B2,H10B12/482
US-8962445-B2,H10B12/488
US-8962445-B2,H10B12/34
US-8962445-B2,H10B12/01
US-8962445-B2,H10B12/482
US-9270639-B2,H04L63/0227
US-9270639-B2,H04L47/125
US-9270639-B2,H04L63/0218
Query:
SELECT "publication_number", cpc_code.value:"code"::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS,
   LATERAL FLATTEN(input => "cpc") cpc_code
   WHERE "country_code" = 'DE' AND "grant_date" BETWEEN 20161201 AND 20161231
   LIMIT 100;
Answer:
publication_number,cpc_code
DE-102013203286-B4,B60R22/4676
DE-112013006743-B4,C21B7/14
DE-112013006743-B4,C21B7/14
DE-112013006743-B4,C22B7/00
DE-112013006743-B4,F27B7/00
DE-112013006743-B4,F27D3/1518
DE-102009051197-B4,H04N1/047
DE-102009051197-B4,H04N1/193
DE-102009051197-B4,H04N1/1934
DE-102009051197-B4,H04N1/12
DE-102009051197-B4,H04N2201/04787
DE-102009051197-B4,G03G2215/0158
DE-102011005349-B4,H03H7/0115
DE-102011005349-B4,H03H7/1758
DE-102011005349-B4,H03H7/175
DE-102011005349-B4,H03H7/42
DE-102011005349-B4,H03H7/1766
DE-102011005349-B4,H03H7/1758
DE-102011005349-B4,H03H7/42
DE-102011005349-B4,H03H7/1775
DE-102011005349-B4,H03H7/06
DE-102011005349-B4,H03H7/03
DE-102011005349-B4,H03H7/1766
DE-102011005349-B4,H03H7/1775
DE-102011005349-B4,H03H7/06
DE-102011005349-B4,H03H7/0115
DE-102011005349-B4,H03H7/03
DE-102011005349-B4,H04B1/28
DE-102011005349-B4,H04B1/28
DE-102011005349-B4,H03H7/175
DE-102012004706-B4,F16K31/002
DE-102012004706-B4,F16K27/0263
DE-102015114819-B3,B64G1/283
DE-102015114819-B3,F16C33/66
DE-102015114819-B3,F16C33/6603
DE-102015114819-B3,B64G1/283
DE-102015114819-B3,F16C2326/47
DE-102015114819-B3,F16C2326/47
DE-102015114819-B3,B64G1/285
DE-102015114819-B3,B64G1/283
DE-102015114819-B3,F16C19/06
DE-102015114819-B3,F16C32/0408
DE-102015114819-B3,B64G1/285
DE-102015114819-B3,B64G1/28
DE-112006001900-B4,B22F9/26
DE-112006001900-B4,B22F2999/00
DE-112006001900-B4,B22F2998/00
DE-112006001900-B4,Y10S977/775
DE-112006001900-B4,B22F9/26
DE-112006001900-B4,B22F9/24
DE-112006001900-B4,B22F9/26
DE-112006001900-B4,B22F2999/00
DE-112006001900-B4,B22F2998/00
DE-112006001900-B4,B82Y40/00
DE-112006001900-B4,Y10S977/775
Query:
SELECT "publication_number", LEFT(cpc_code.value:"code"::STRING, 4) AS "cpc_group"
   FROM PATENTS.PATENTS.PUBLICATIONS,
   LATERAL FLATTEN(input => "cpc") cpc_code
   LIMIT 100;
Answer:
publication_number,cpc_group
US-8521396-B2,B62K
US-8521396-B2,B62M
US-8521396-B2,B62K
US-8521396-B2,B62M
US-8521396-B2,B62K
US-8521396-B2,B62K
US-8521396-B2,B62K
US-8521396-B2,B62K
US-9247876-B2,G02B
US-9247876-B2,A61B
US-9247876-B2,A61B
US-9247876-B2,G02B
US-9247876-B2,A61B
US-9247876-B2,A61B
US-9247876-B2,G02B
US-9247876-B2,A61B
US-9247876-B2,A61B
US-9247876-B2,A61B
US-9247876-B2,A61B
US-9247876-B2,A61B
US-9247876-B2,G02B
US-8723487-B2,H02M
US-8723487-B2,H02M
US-8723487-B2,Y02B
US-8723487-B2,H02M
US-8723487-B2,Y02B
US-8723487-B2,H02M
US-8723487-B2,H02M
US-8723487-B2,H02M
US-9278232-B2,A61N
US-9278232-B2,A61N
US-9278232-B2,A61N
US-9278232-B2,A61N
US-9278232-B2,A61N
US-9278232-B2,A61N
US-9278232-B2,A61N
US-9278232-B2,A61N
US-9278232-B2,A61N
US-9278232-B2,A61N
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,H01M
US-8758938-B2,Y02E
US-8402104-B2,G06Q
US-8402104-B2,H04L
US-8402104-B2,H04L
US-8402104-B2,G06Q
US-8872639-B2,G06F
US-8872639-B2,G06F
US-8872639-B2,B60K
US-8872639-B2,G02B
US-8872639-B2,B60K
US-8872639-B2,B60K
US-8872639-B2,G02B
US-8872639-B2,B60K
US-8872639-B2,B60K
US-8872639-B2,G02B
US-8872639-B2,G06F
US-8872639-B2,G06F
US-8872639-B2,B60K
US-8872639-B2,G02B
US-8872639-B2,G06F
US-8872639-B2,G02B
US-8872639-B2,G02B
US-8872639-B2,B60K
US-8872639-B2,B60K
US-8872639-B2,B60K
US-8872639-B2,B60K
US-8872639-B2,B60K
US-8872639-B2,B60K
US-8872639-B2,G02B
US-8872639-B2,G06F
US-8872639-B2,G02B
US-8872639-B2,G02B
US-8872639-B2,B60K
US-8872639-B2,B60K
US-8872639-B2,B60K
US-8872639-B2,B60K
US-8872639-B2,B60K
US-9042220-B2,H04L
US-9042220-B2,H04L
US-9042220-B2,H04L
US-9042220-B2,H04L
US-9042220-B2,H04L
US-9042220-B2,H04L
US-9042220-B2,H04L
US-9042220-B2,H04L
Query:
SELECT "publication_number", "filing_date", FLOOR("filing_date" / 10000) AS "filing_year"
    FROM PATENTS.PATENTS.PUBLICATIONS LIMIT 100;
Answer:
publication_number,filing_date,filing_year
CR-5634-A,19971015,1997
CR-5990-A,19990322,1999
FI-429-A,0,0
HK-6083-A,19830217,1983
HU-T52763-A,19900109,1990
JP-H03206829-A,19900101,1990
JP-S62159089-A,19860106,1986
US-416-A,0,0
US-2528225-A,19480102,1948
AT-A41580-A,19800125,1980
AT-A47682-A,19820209,1982
AT-A63682-A,19820219,1982
CA-920790-A,19700116,1970
CA-950907-A,19700224,1970
CA-920830-A,19700501,1970
CA-9086-A,0,0
CH-3256-A,18901220,1890
CH-540255-A,19690318,1969
CH-433637-A,19660117,1966
CH-8494-A,18940609,1894
CH-9587-A,18941217,1894
CH-9968-A,18950125,1895
DD-8297-A,0,0
FR-1334211-A,19620924,1962
FR-1444995-A,19650616,1965
FR-1474468-A,19660402,1966
FR-1478988-A,19660506,1966
FR-1485992-A,19660704,1966
FR-1487706-A,19660725,1966
FR-1508237-A,19661121,1966
GB-893001-A,19600102,1960
GB-873984-A,19580106,1958
GB-307790-A,19290107,1929
GB-534192-A,19400116,1940
HK-39487-A,19870521,1987
HK-52284-A,19840705,1984
HK-55992-A,19920730,1992
HK-60178-A,19781012,1978
HK-82486-A,19861030,1986
HU-T58725-A,19910225,1991
JP-S62157892-A,19860106,1986
JP-H06198910-A,19930106,1993
MA-42286-A,20150702,2015
OA-07542-A,19830922,1983
OA-08399-A,19860626,1986
PH-11723-A,19730907,1973
PH-15213-A,19780905,1978
PH-17928-A,19820512,1982
PH-23905-A,19880217,1988
TR-26506-A,19900307,1990
US-4613-A,0,0
US-4234270-A,19790102,1979
US-6310-A,0,0
US-8947-A,0,0
YU-24971-A,19710204,1971
YU-51397-A,19971230,1997
YU-53588-A,19880317,1988
YU-94082-A,19820430,1982
AT-A134275-A,19750221,1975
AT-A160683-A,19830503,1983
AT-A168281-A,19810413,1981
AT-A179178-A,19780313,1978
AT-A196182-A,19820518,1982
AT-A202882-A,19820524,1982
AT-A205780-A,19800416,1980
AT-A245590-A,19901205,1990
AT-A250686-A,19860918,1986
AT-A269985-A,19850916,1985
AT-A272073-A,19730328,1973
AT-A312885-A,19851029,1985
AT-A404675-A,19750527,1975
AT-A482077-A,19770706,1977
AT-A519575-A,19750707,1975
AT-A710279-A,19791105,1979
AT-A735378-A,19781012,1978
AT-A876472-A,19721012,1972
AT-A906278-A,19781219,1978
BE-804534-A,19730906,1973
BE-806687-A,19731029,1973
BE-813367-A,19740405,1974
BE-823416-A,19741216,1974
BE-825816-A,19750221,1975
BE-833811-A,19750925,1975
BE-837312-A,19760105,1976
BE-837857-A,19760123,1976
BE-840231-A,19760331,1976
BE-848755-A,19761125,1976
BE-852837-A,19770324,1977
BE-853553-A,19770413,1977
BE-857395-A,19770802,1977
BE-861199-A,19771125,1977
BE-866723-A,19780505,1978
BE-868080-A,19780613,1978
BE-868938-A,19780712,1978
BE-869056-A,19780717,1978
BE-871421-A,19781020,1978
BE-873394-A,19790110,1979
BE-877768-A,19790718,1979
BE-885287-A,19800918,1980
BE-509322-A,19520218,1952
Query:
SELECT
        LEFT(cpc_code.value:"code"::STRING, 4) AS "cpc_group",
        FLOOR("filing_date" / 10000) AS "filing_year",
        COUNT(*) AS "filing_count"
    FROM PATENTS.PATENTS.PUBLICATIONS,
    LATERAL FLATTEN(input => "cpc") cpc_code
    WHERE "country_code" = 'DE' AND "grant_date" BETWEEN 20161201 AND 20161231
    GROUP BY "cpc_group", "filing_year"
    ORDER BY "cpc_group", "filing_year"
    LIMIT 100;
Answer:
cpc_group,filing_year,filing_count
B22F,2006,8
B60R,2013,1
B64G,2015,6
B82Y,2006,1
C21B,2013,2
C22B,2013,1
F16C,2015,6
F16K,2012,2
F27B,2013,1
F27D,2013,1
G03G,2009,1
H03H,2011,16
H04B,2011,2
H04N,2009,5
Y10S,2006,2
Query:
SELECT "symbol", "titleFull" FROM PATENTS.PATENTS.CPC_DEFINITION LIMIT 100;
Answer:
Too long, hard cut:
symbol,titleFull
B,PERFORMING OPERATIONS; TRANSPORTING
H,ELECTRICITY
Y,GENERAL TAGGING OF NEW TECHNOLOGICAL DEVELOPMENTS; GENERAL TAGGING OF CROSS-SECTIONAL TECHNOLOGIES SPANNING OVER SEVERAL SECTIONS OF THE IPC; TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS
D,TEXTILES; PAPER
F,MECHANICAL ENGINEERING; LIGHTING; HEATING; WEAPONS; BLASTING
E,FIXED CONSTRUCTIONS
C,CHEMISTRY; METALLURGY
G,PHYSICS
A,HUMAN NECESSITIES
A45,HAND OR TRAVELLING ARTICLES
A24,TOBACCO; CIGARS; CIGARETTES; SIMULATED SMOKING DEVICES; SMOKERS' REQUISITES
A61,MEDICAL OR VETERINARY SCIENCE; HYGIENE
A63,SPORTS; GAMES; AMUSEMENTS
A22,BUTCHERING; MEAT TREATMENT; PROCESSING POULTRY OR FISH
A42,HEADWEAR
A99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
A43,FOOTWEAR
A01,AGRICULTURE; FORESTRY; ANIMAL HUSBANDRY; HUNTING; TRAPPING; FISHING
A62,LIFE-SAVING; FIRE-FIGHTING
A23,"FOODS OR FOODSTUFFS; TREATMENT THEREOF, NOT COVERED BY OTHER CLASSES"
A47,FURNITURE; DOMESTIC ARTICLES OR APPLIANCES; COFFEE MILLS; SPICE MILLS; SUCTION CLEANERS IN GENERAL
A46,BRUSHWARE
A44,HABERDASHERY; JEWELLERY
A21,BAKING; EDIBLE DOUGHS
A41,WEARING APPAREL
B27,WORKING OR PRESERVING WOOD OR SIMILAR MATERIAL; NAILING OR STAPLING MACHINES IN GENERAL
B68,SADDLERY; UPHOLSTERY
B04,CENTRIFUGAL APPARATUS OR MACHINES FOR CARRYING-OUT PHYSICAL OR CHEMICAL PROCESSES
B23,MACHINE TOOLS; METAL-WORKING NOT OTHERWISE PROVIDED FOR
B30,PRESSES
B21,MECHANICAL METAL-WORKING WITHOUT ESSENTIALLY REMOVING MATERIAL; PUNCHING METAL
B25,HAND TOOLS; PORTABLE POWER-DRIVEN TOOLS; MANIPULATORS
B99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
B29,WORKING OF PLASTICS; WORKING OF SUBSTANCES IN A PLASTIC STATE IN GENERAL
B31,"MAKING ARTICLES OF PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER; WORKING PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER"
B26,HAND CUTTING TOOLS; CUTTING; SEVERING
B66,HOISTING; LIFTING; HAULING
B02,"CRUSHING, PULVERISING, OR DISINTEGRATING; PREPARATORY TREATMENT OF GRAIN FOR MILLING"
B65,CONVEYING; PACKING; STORING; HANDLING THIN OR FILAMENTARY MATERIAL
B61,RAILWAYS
B24,GRINDING; POLISHING
B06,GENERATING OR TRANSMITTING MECHANICAL VIBRATIONS IN GENERAL
B43,WRITING OR DRAWING IMPLEMENTS; BUREAU ACCESSORIES
B62,LAND VEHICLES FOR TRAVELLING OTHERWISE THAN ON RAILS
B64,AIRCRAFT; AVIATION; COSMONAUTICS
B22,CASTING; POWDER METALLURGY
B28,"WORKING CEMENT, CLAY, OR STONE"
B09,DISPOSAL OF SOLID WASTE; RECLAMATION OF CONTAMINATED SOIL
B01,PHYSICAL OR CHEMICAL PROCESSES OR APPARATUS IN GENERAL
B63,SHIPS OR OTHER WATERBORNE VESSELS; RELATED EQUIPMENT
B60,VEHICLES IN GENERAL
B44,DECORATIVE ARTS
B07,SEPARATING SOLIDS FROM SOLIDS; SORTING
B08,CLEANING
B82,NANOTECHNOLOGY
B42,BOOKBINDING; ALBUMS; FILES; SPECIAL PRINTED MATTER
B32,LAYERED PRODUCTS
B81,MICROSTRUCTURAL TECHNOLOGY
B05,"SPRAYING OR ATOMISING IN GENERAL; APPLYING FLUENT MATERIALS TO SURFACES, IN GENERAL"
B41,PRINTING; LINING MACHINES; TYPEWRITERS; STAMPS
B03,SEPARATION OF SOLID MATERIALS USING LIQUIDS OR USING PNEUMATIC TABLES OR JIGS; MAGNETIC OR ELECTROSTATIC SEPARATION OF SOLID MATERIALS FROM SOLID MATERIALS OR FLUIDS; SEPARATION BY HIGH-VOLTAGE ELECTRIC FIELDS
B67,"OPENING, CLOSING OR CLEANING BOTTLES, JARS OR SIMILAR CONTAINERS; LIQUID HANDLING"
B33,ADDITIVE MANUFACTURING TECHNOLOGY
C22,METALLURGY; FERROUS OR NON-FERROUS ALLOYS; TREATMENT OF ALLOYS OR NON-FERROUS METALS
C23,"COATING METALLIC MATERIAL; COATING MATERIAL WITH METALLIC MATERIAL; CHEMICAL SURFACE TREATMENT; DIFFUSION TREATMENT OF METALLIC MATERIAL; COATING BY VACUUM EVAPORATION, BY SPUTTERING, BY ION IMPLANTATION OR BY CHEMICAL VAPOUR DEPOSITION, IN GENERAL; INHIBITING CORROSION OF METALLIC MATERIAL OR INCRUSTATION IN GENERAL"
C06,EXPLOSIVES; MATCHES
C02,"TREATMENT OF WATER, WASTE WATER, SEWAGE, OR SLUDGE"
C07,ORGANIC CHEMISTRY
C25,ELECTROLYTIC OR ELECTROPHORETIC PROCESSES; APPARATUS THEREFOR
C30,CRYSTAL GROWTH
C12,BIOCHEMISTRY; BEER; SPIRITS; WINE; VINEGAR; MICROBIOLOGY; ENZYMOLOGY; MUTATION OR GENETIC ENGINEERING
C99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
C05,FERTILISERS; MANUFACTURE THEREOF
C40,COMBINATORIAL TECHNOLOGY
C11,"ANIMAL OR VEGETABLE OILS, FATS, FATTY SUBSTANCES OR WAXES; FATTY ACIDS THEREFROM; DETERGENTS; CANDLES"
C08,ORGANIC MACROMOLECULAR COMPOUNDS; THEIR PREPARATION OR CHEMICAL WORKING-UP; COMPOSITIONS BASED THEREON
C10,"PETROLEUM, GAS OR COKE INDUSTRIES; TECHNICAL GASES CONTAINING CARBON MONOXIDE; FUELS; LUBRICANTS; PEAT"
C21,METALLURGY OF IRON
C04,CEMENTS; CONCRETE; ARTIFICIAL STONE; CERAMICS; REFRACTORIES
C09,DYES; PAINTS; POLISHES; NATURAL RESINS; ADHESIVES; COMPOSITIONS NOT OTHERWISE PROVIDED FOR; APPLICATIONS OF MATERIALS NOT OTHERWISE PROVIDED FOR
C03,GLASS; MINERAL OR SLAG WOOL
C13,SUGAR INDUSTRY
C14,SKINS; HIDES; PELTS; LEATHER
C01,INORGANIC CHEMISTRY
D02,YARNS; MECHANICAL FINISHING OF YARNS OR ROPES; WARPING OR BEAMING
D21,PAPER-MAKING; PRODUCTION OF CELLULOSE
D04,BRAIDING; LACE-MAKING; KNITTING; TRIMMINGS; NON-WOVEN F
Query:
SELECT
        cpc_group_stats."cpc_group",
        cpc_def."titleFull",
        cpc_group_stats."filing_year",
        cpc_group_stats."filing_count"
    FROM
        (
            SELECT
                LEFT(cpc_code.value:"code"::STRING, 4) AS "cpc_group",
                FLOOR("filing_date" / 10000) AS "filing_year",
                COUNT(*) AS "filing_count"
            FROM PATENTS.PATENTS.PUBLICATIONS,
            LATERAL FLATTEN(input => "cpc") cpc_code
            WHERE "country_code" = 'DE' AND "grant_date" BETWEEN 20161201 AND 20161231
            GROUP BY "cpc_group", "filing_year"
        ) cpc_group_stats
    LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_def
    ON cpc_def."symbol" = cpc_group_stats."cpc_group"
    ORDER BY cpc_group_stats."cpc_group", cpc_group_stats."filing_year"
    LIMIT 100;
Answer:
cpc_group,titleFull,filing_year,filing_count
B22F,WORKING METALLIC POWDER; MANUFACTURE OF ARTICLES FROM METALLIC POWDER; MAKING METALLIC POWDER; APPARATUS OR DEVICES SPECIALLY ADAPTED FOR METALLIC POWDER,2006,8
B60R,"VEHICLES, VEHICLE FITTINGS, OR VEHICLE PARTS, NOT OTHERWISE PROVIDED FOR",2013,1
B64G,COSMONAUTICS; VEHICLES OR EQUIPMENT THEREFOR,2015,6
B82Y,SPECIFIC USES OR APPLICATIONS OF NANOSTRUCTURES; MEASUREMENT OR ANALYSIS OF NANOSTRUCTURES; MANUFACTURE OR TREATMENT OF NANOSTRUCTURES,2006,1
C21B,MANUFACTURE OF IRON OR STEEL,2013,2
C22B,PRODUCTION AND REFINING OF METALS; PRETREATMENT OF RAW MATERIALS,2013,1
F16C,SHAFTS; FLEXIBLE SHAFTS; ELEMENTS OR CRANKSHAFT MECHANISMS; ROTARY BODIES OTHER THAN GEARING ELEMENTS; BEARINGS,2015,6
F16K,VALVES; TAPS; COCKS; ACTUATING-FLOATS; DEVICES FOR VENTING OR AERATING,2012,2
F27B,"FURNACES, KILNS, OVENS, OR RETORTS IN GENERAL; OPEN SINTERING OR LIKE APPARATUS",2013,1
F27D,"DETAILS OR ACCESSORIES OF FURNACES, KILNS, OVENS, OR RETORTS, IN SO FAR AS THEY ARE OF KINDS OCCURRING IN MORE THAN ONE KIND OF FURNACE",2013,1
G03G,ELECTROGRAPHY; ELECTROPHOTOGRAPHY; MAGNETOGRAPHY,2009,1
H03H,"IMPEDANCE NETWORKS, e.g. RESONANT CIRCUITS; RESONATORS",2011,16
H04B,TRANSMISSION,2011,2
H04N,"PICTORIAL COMMUNICATION, e.g. TELEVISION",2009,5
Y10S,TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS,2006,2
Query:
SELECT
    cpc_def."titleFull" AS "Full_Title",
    cpc_group_stats."cpc_group" AS "CPC_Group",
    cpc_group_stats."best_year" AS "Best_Year"
FROM
    (
        SELECT
            "cpc_group",
            "best_year"
        FROM
            (
                SELECT
                    "cpc_group",
                    "filing_year" AS "best_year",
                    SUM("filing_count" * POWER(0.1, DATEDIFF('year', TO_DATE("filing_year" || '-01-01'), CURRENT_DATE()))) /
                    SUM(POWER(0.1, DATEDIFF('year', TO_DATE("filing_year" || '-01-01'), CURRENT_DATE()))) AS "ema"
                FROM
                    (
                        SELECT
                            LEFT(cpc_code.value:"code"::STRING, 4) AS "cpc_group",
                            EXTRACT(year FROM TRY_TO_DATE("filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
                            COUNT(*) AS "filing_count"
                        FROM
                            "PATENTS"."PATENTS"."PUBLICATIONS",
                            LATERAL FLATTEN(input => "cpc") cpc_code
                        WHERE
                            "country_code" = 'DE'
                            AND TRY_TO_DATE("grant_date"::VARCHAR, 'YYYYMMDD') BETWEEN '2016-01-01' AND '2016-12-31'
                            AND "grant_date" != 0
                            AND "filing_date" != 0
                        GROUP BY
                            "cpc_group", "filing_year"
                        HAVING
                            "filing_year" IS NOT NULL
                    ) sub
                GROUP BY
                    "cpc_group", "filing_year"
            ) ema_calc
        QUALIFY ROW_NUMBER() OVER (PARTITION BY "cpc_group" ORDER BY "ema" DESC) = 1
    ) cpc_group_stats
LEFT JOIN "PATENTS"."PATENTS"."CPC_DEFINITION" cpc_def
    ON cpc_def."symbol" = cpc_group_stats."cpc_group"
ORDER BY
    cpc_group_stats."cpc_group"
LIMIT 100;
Answer:
Too long, hard cut:
Full_Title,CPC_Group,Best_Year
"SOIL WORKING IN AGRICULTURE OR FORESTRY; PARTS, DETAILS, OR ACCESSORIES OF AGRICULTURAL MACHINES OR IMPLEMENTS, IN GENERAL",A01B,2012
"HAIRDRESSING OR SHAVING EQUIPMENT; EQUIPMENT FOR COSMETICS OR COSMETIC TREATMENTS, e.g. FOR MANICURING OR PEDICURING",A45D,2013
TABLES; DESKS; OFFICE FURNITURE; CABINETS; DRAWERS; GENERAL DETAILS OF FURNITURE,A47B,2013
"TRANSPORT, PERSONAL CONVEYANCES, OR ACCOMMODATION SPECIALLY ADAPTED FOR PATIENTS OR DISABLED PERSONS; OPERATING TABLES OR CHAIRS; CHAIRS FOR DENTISTRY; FUNERAL DEVICES",A61G,2010
CONTAINERS SPECIALLY ADAPTED FOR MEDICAL OR PHARMACEUTICAL PURPOSES; DEVICES OR METHODS SPECIALLY ADAPTED FOR BRINGING PHARMACEUTICAL PRODUCTS INTO PARTICULAR PHYSICAL OR ADMINISTERING FORMS; DEVICES FOR ADMINISTERING FOOD OR MEDICINES ORALLY; BABY COMFORTERS; DEVICES FOR RECEIVING SPITTLE,A61J,2013
"MIXING, e.g. DISSOLVING, EMULSIFYING OR DISPERSING",B01F,2012
"CHEMICAL OR PHYSICAL PROCESSES, e.g. CATALYSIS OR COLLOID CHEMISTRY; THEIR RELEVANT APPARATUS",B01J,2012
MAGNETIC OR ELECTROSTATIC SEPARATION OF SOLID MATERIALS FROM SOLID MATERIALS OR FLUIDS; SEPARATION BY HIGH-VOLTAGE ELECTRIC FIELDS,B03C,2012
WORKING METALLIC POWDER; MANUFACTURE OF ARTICLES FROM METALLIC POWDER; MAKING METALLIC POWDER; APPARATUS OR DEVICES SPECIALLY ADAPTED FOR METALLIC POWDER,B22F,2006
"SOLDERING OR UNSOLDERING; WELDING; CLADDING OR PLATING BY SOLDERING OR WELDING; CUTTING BY APPLYING HEAT LOCALLY, e.g. FLAME CUTTING; WORKING BY LASER BEAM",B23K,2011
"MACHINES, DEVICES, OR PROCESSES FOR GRINDING OR POLISHING; DRESSING OR CONDITIONING OF ABRADING SURFACES; FEEDING OF GRINDING, POLISHING, OR LAPPING AGENTS",B24B,2012
MANIPULATORS; CHAMBERS PROVIDED WITH MANIPULATION DEVICES,B25J,2015
WORKING VENEER OR PLYWOOD,B27D,2009
PRESSES IN GENERAL,B30B,2009
"LAYERED PRODUCTS, i.e. PRODUCTS BUILT-UP OF STRATA OF FLAT OR NON-FLAT, e.g. CELLULAR OR HONEYCOMB, FORM",B32B,2002
VEHICLE TYRES; TYRE INFLATION; TYRE CHANGING; CONNECTING VALVES TO INFLATABLE ELASTIC BODIES IN GENERAL; DEVICES OR ARRANGEMENTS RELATED TO TYRES,B60C,2013
VEHICLE SUSPENSION ARRANGEMENTS,B60G,2011
"ARRANGEMENTS OF HEATING, COOLING, VENTILATING OR OTHER AIR-TREATING DEVICES SPECIALLY ADAPTED FOR PASSENGER OR GOODS SPACES OF VEHICLES",B60H,2004
PROPULSION OF ELECTRICALLY-PROPELLED VEHICLES; SUPPLYING ELECTRIC POWER FOR AUXILIARY EQUIPMENT OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRODYNAMIC BRAKE SYSTEMS FOR VEHICLES IN GENERAL; MAGNETIC SUSPENSION OR LEVITATION FOR VEHICLES; MONITORING OPERATING VARIABLES OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRIC SAFETY DEVICES FOR ELECTRICALLY-PROPELLED VEHICLES,B60L,2010
"VEHICLES, VEHICLE FITTINGS, OR VEHICLE PARTS, NOT OTHERWISE PROVIDED FOR",B60R,2015
"CYCLE SADDLES OR SEATS; AUXILIARY DEVICES OR ACCESSORIES SPECIALLY ADAPTED TO CYCLES AND NOT OTHERWISE PROVIDED FOR, e.g. ARTICLE CARRIERS OR CYCLE PROTECTORS",B62J,2014
RIDER PROPULSION OF WHEELED VEHICLES OR SLEDGES; POWERED PROPULSION OF SLEDGES OR SINGLE-TRACK CYCLES; TRANSMISSIONS SPECIALLY ADAPTED FOR SUCH VEHICLES,B62M,2014
COSMONAUTICS; VEHICLES OR EQUIPMENT THEREFOR,B64G,2015
"CONTAINERS FOR STORAGE OR TRANSPORT OF ARTICLES OR MATERIALS, e.g. BAGS, BARRELS, BOTTLES, BOXES, CANS, CARTONS, CRATES, DRUMS, JARS, TANKS, HOPPERS, FORWARDING CONTAINERS; ACCESSORIES, CLOSURES, OR FITTINGS THEREFOR; PACKAGING ELEMENTS; PACKAGES",B65D,2013
"HANDLING THIN OR FILAMENTARY MATERIAL, e.g. SHEETS, WEBS, CABLES",B65H,2009
SPECIFIC USES OR APPLICATIONS OF NANOSTRUCTURES; MEASUREMENT OR ANALYSIS OF NANOSTRUCTURES; MANUFACTURE OR TREATMENT OF NANOSTRUCTURES,B82Y,2006
"LIME, MAGNESIA; SLAG; CEMENTS; COMPOSITIONS THEREOF, e.g. MORTARS, CONCRETE OR LIKE BUILDING MATERIALS; ARTIFICIAL STONE; CERAMICS; REFRACTORIES; TREATMENT OF NATURAL STONE",C04B,2014
MACROMOLECULAR COMPOUNDS OBTAINED OTHERWISE THAN BY REACTIONS ONLY INVOLVING UNSATURATED CARBON-TO-CARBON BONDS,C08G,2012
"CRACKING HYDROCARBON OILS; PRODUCTION OF LIQUID HYDROCARBON MIXTURES, e.g. BY DESTRUCTIVE HYDROGENATION, OLIGOMERISATION, POLYMERISATION; RECOVERY OF HYDROCARBON OILS FROM OIL-SHALE, OIL-SAND, OR GASES; REFINING MIXTURES MAINLY CONSISTING OF HYDROCARBONS; REFORMING OF NAPHTHA; MINERAL WAXES",C10G,2012
MANUFACTURE OF IRON OR STEEL,C21B,2013
PRODUCTION AND REFINING OF METALS; PRETREATMENT OF RAW MATERIALS,C22B,2012
"COATING METALLIC MATERIAL; COATING MATERIAL WITH METALLIC MATERIAL; SURFACE TREATMENT OF METALLIC MATERIAL BY DIFFUSION INTO THE SURFACE, BY CHEMICAL CONVERSION OR SUBSTITUTION; COATING BY VACUUM EVAPORATION, BY SPUTTERING, BY ION IMPLANTATION OR BY CHEMICAL VAPOUR DEPOSITION, IN GENERAL",C23C,2008
"CHEMICAL FEATURES IN THE MANUFACTURE OF ARTIFICIAL FILAMENTS, THREADS, FIBRES, BRISTLES OR RIBBONS; APPARATUS SPECIALLY ADAPTED FOR THE MANUFACTURE OF CARBON FILAMENTS",D01F,2002
KNITTING,D04B,2014
"MAKING TEXTILE FABRICS, e.g. FROM FIBRES OR FILAMENTARY MATERIAL; FABRICS MADE BY SUCH PROCESSES OR APPARATUS, e.g. FELTS, NON-WOVEN FABRICS; COTTON-WOOL; WADDING ; NON-WOVEN 
Query:
SELECT
    LEFT(cpc_code.value:"code"::STRING, 4) AS "cpc_group",
    COUNT(*) AS "total_filings"
FROM PATENTS.PATENTS.PUBLICATIONS,
LATERAL FLATTEN(input => "cpc") cpc_code
WHERE "country_code" = 'DE'
  AND TRY_TO_DATE("grant_date"::VARCHAR, 'YYYYMMDD') BETWEEN '2016-12-01' AND '2016-12-31'
  AND "grant_date" != 0
GROUP BY "cpc_group"
ORDER BY "total_filings" DESC
LIMIT 100
Answer:
cpc_group,total_filings
H03H,16
B22F,8
F16C,6
B64G,6
H04N,5
C21B,2
F16K,2
Y10S,2
H04B,2
F27B,1
C22B,1
B60R,1
B82Y,1
F27D,1
G03G,1
Query:
SELECT
    cpc_group_stats."cpc_group",
    cpc_def."titleFull",
    cpc_group_stats."total_filings"
FROM
    (
        SELECT
            LEFT(cpc_code.value:"code"::STRING, 4) AS "cpc_group",
            COUNT(*) AS "total_filings"
        FROM PATENTS.PATENTS.PUBLICATIONS,
        LATERAL FLATTEN(input => "cpc") cpc_code
        WHERE "country_code" = 'DE'
          AND TRY_TO_DATE("grant_date"::VARCHAR, 'YYYYMMDD') BETWEEN '2016-12-01' AND '2016-12-31'
          AND "grant_date" != 0
        GROUP BY "cpc_group"
    ) cpc_group_stats
LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_def
ON cpc_def."symbol" = cpc_group_stats."cpc_group"
ORDER BY cpc_group_stats."total_filings" DESC
LIMIT 100
Answer:
cpc_group,titleFull,total_filings
H03H,"IMPEDANCE NETWORKS, e.g. RESONANT CIRCUITS; RESONATORS",16
B22F,WORKING METALLIC POWDER; MANUFACTURE OF ARTICLES FROM METALLIC POWDER; MAKING METALLIC POWDER; APPARATUS OR DEVICES SPECIALLY ADAPTED FOR METALLIC POWDER,8
B64G,COSMONAUTICS; VEHICLES OR EQUIPMENT THEREFOR,6
F16C,SHAFTS; FLEXIBLE SHAFTS; ELEMENTS OR CRANKSHAFT MECHANISMS; ROTARY BODIES OTHER THAN GEARING ELEMENTS; BEARINGS,6
H04N,"PICTORIAL COMMUNICATION, e.g. TELEVISION",5
C21B,MANUFACTURE OF IRON OR STEEL,2
F16K,VALVES; TAPS; COCKS; ACTUATING-FLOATS; DEVICES FOR VENTING OR AERATING,2
H04B,TRANSMISSION,2
Y10S,TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS,2
F27B,"FURNACES, KILNS, OVENS, OR RETORTS IN GENERAL; OPEN SINTERING OR LIKE APPARATUS",1
G03G,ELECTROGRAPHY; ELECTROPHOTOGRAPHY; MAGNETOGRAPHY,1
B60R,"VEHICLES, VEHICLE FITTINGS, OR VEHICLE PARTS, NOT OTHERWISE PROVIDED FOR",1
B82Y,SPECIFIC USES OR APPLICATIONS OF NANOSTRUCTURES; MEASUREMENT OR ANALYSIS OF NANOSTRUCTURES; MANUFACTURE OR TREATMENT OF NANOSTRUCTURES,1
F27D,"DETAILS OR ACCESSORIES OF FURNACES, KILNS, OVENS, OR RETORTS, IN SO FAR AS THEY ARE OF KINDS OCCURRING IN MORE THAN ONE KIND OF FURNACE",1
C22B,PRODUCTION AND REFINING OF METALS; PRETREATMENT OF RAW MATERIALS,1
End Exploring Related Columns
Task: Find the CPC technology areas in Germany with the highest exponential moving average of patent filings each year (smoothing factor 0.1) for patents granted in December 2016. Show me the full title, CPC group and the best year for each CPC group at level 4.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To identify the CPC technology areas in Germany with the highest exponential moving average of patent filings each year (using a smoothing factor of 0.1) for patents granted in December 2016, we analyze the patent filings grouped by CPC groups at level 4. Below are the full titles, CPC groups, and the best years for each CPC group at level 4 with the highest exponential moving averages.

```csv
Full_Title,CPC_Group,Best_Year
full_title1:str,CPC_group1:str,best_year1:int
full_title2:str,CPC_group2:str,best_year2:int
...
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-23 18:49:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 18:49:14 - root - INFO - ```sql
SELECT
    cpc_def."titleFull" AS "Full_Title",
    cpc_group_stats."cpc_group" AS "CPC_Group",
    cpc_group_stats."best_year" AS "Best_Year"
FROM
    (
        SELECT
            "cpc_group",
            "filing_year" AS "best_year"
        FROM
            (
                SELECT
                    "cpc_group",
                    "filing_year",
                    SUM("filing_count" * POWER(0.1, 2016 - "filing_year")) /
                    SUM(POWER(0.1, 2016 - "filing_year")) AS "ema"
                FROM
                    (
                        SELECT
                            LEFT(cpc_code.value:"code"::STRING, 4) AS "cpc_group",
                            EXTRACT(year FROM TRY_TO_DATE("filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
                            COUNT(*) AS "filing_count"
                        FROM
                            "PATENTS"."PATENTS"."PUBLICATIONS",
                            LATERAL FLATTEN(input => "cpc") cpc_code
                        WHERE
                            "country_code" = 'DE'
                            AND TRY_TO_DATE("grant_date"::VARCHAR, 'YYYYMMDD') BETWEEN '2016-12-01' AND '2016-12-31'
                            AND "grant_date" != 0
                            AND "filing_date" != 0
                        GROUP BY
                            "cpc_group", "filing_year"
                        HAVING
                            "filing_year" IS NOT NULL
                    ) sub
                GROUP BY
                    "cpc_group", "filing_year"
            ) ema_calc
        QUALIFY ROW_NUMBER() OVER (PARTITION BY "cpc_group" ORDER BY "ema" DESC) = 1
    ) cpc_group_stats
LEFT JOIN "PATENTS"."PATENTS"."CPC_DEFINITION" cpc_def
    ON cpc_def."symbol" = cpc_group_stats."cpc_group"
ORDER BY
    cpc_group_stats."cpc_group";
```
2025-01-23 18:49:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 18:49:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 18:49:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 18:49:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 15
2025-01-23 18:49:15 - snowflake.connector.connection - INFO - closed
2025-01-23 18:49:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 18:49:16 - root - INFO - itercount: 1
2025-01-23 18:49:16 - root - INFO - 0
2025-01-23 18:49:16 - root - INFO - results: 
Full_Title,CPC_Group,Best_Year
WORKING METALLIC POWDER; MANUFACTURE OF ARTICLES FROM METALLIC POWDER; MAKING METALLIC POWDER; APPARATUS OR DEVICES SPECIALLY ADAPTED FOR METALLIC POWDER,B22F,2006
"VEHICLES, VEHICLE FITTINGS, OR VEHICLE PARTS, NOT OTHERWISE PROVIDED FOR",B60R,2013
COSMONAUTICS; VEHICLES OR EQUIPMENT THEREFOR,B64G,2015
SPECIFIC USES OR APPLICATIONS OF NANOSTRUCTURES; MEASUREMENT OR ANALYSIS OF NANOSTRUCTURES; MANUFACTURE OR TREATMENT OF NANOSTRUCTURES,B82Y,2006
MANUFACTURE OF IRON OR STEEL,C21B,2013
PRODUCTION AND REFINING OF METALS; PRETREATMENT OF RAW MATERIALS,C22B,2013
SHAFTS; FLEXIBLE SHAFTS; ELEMENTS OR CRANKSHAFT MECHANISMS; ROTARY BODIES OTHER THAN GEARING ELEMENTS; BEARINGS,F16C,2015
VALVES; TAPS; COCKS; ACTUATING-FLOATS; DEVICES FOR VENTING OR AERATING,F16K,2012
"FURNACES, KILNS, OVENS, OR RETORTS IN GENERAL; OPEN SINTERING OR LIKE APPARATUS",F27B,2013
"DETAILS OR ACCESSORIES OF FURNACES, KILNS, OVENS, OR RETORTS, IN SO FAR AS THEY ARE OF KINDS OCCURRING IN MORE THAN ONE KIND OF FURNACE",F27D,2013
ELECTROGRAPHY; ELECTROPHOTOGRAPHY; MAGNETOGRAPHY,G03G,2009
"IMPEDANCE NETWORKS, e.g. RESONANT CIRCUITS; RESONATORS",H03H,2011
TRANSMISSION,H04B,2011
"PICTORIAL COMMUNICATION, e.g. TELEVISION",H04N,2009
TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS,Y10S,2006


2025-01-23 18:49:16 - root - INFO - Please check the answer again by reviewing Find the CPC technology areas in Germany with the highest exponential moving average of patent filings each year (smoothing factor 0.1) for patents granted in December 2016. Show me the full title, CPC group and the best year for each CPC group at level 4., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To identify the CPC technology areas in Germany with the highest exponential moving average of patent filings each year (using a smoothing factor of 0.1) for patents granted in December 2016, we analyze the patent filings grouped by CPC groups at level 4. Below are the full titles, CPC groups, and the best years for each CPC group at level 4 with the highest exponential moving averages.

```csv
Full_Title,CPC_Group,Best_Year
full_title1:str,CPC_group1:str,best_year1:int
full_title2:str,CPC_group2:str,best_year2:int
...
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Full_Title,CPC_Group,Best_Year
WORKING METALLIC POWDER; MANUFACTURE OF ARTICLES FROM METALLIC POWDER; MAKING METALLIC POWDER; APPARATUS OR DEVICES SPECIALLY ADAPTED FOR METALLIC POWDER,B22F,2006
"VEHICLES, VEHICLE FITTINGS, OR VEHICLE PARTS, NOT OTHERWISE PROVIDED FOR",B60R,2013
COSMONAUTICS; VEHICLES OR EQUIPMENT THEREFOR,B64G,2015
SPECIFIC USES OR APPLICATIONS OF NANOSTRUCTURES; MEASUREMENT OR ANALYSIS OF NANOSTRUCTURES; MANUFACTURE OR TREATMENT OF NANOSTRUCTURES,B82Y,2006
MANUFACTURE OF IRON OR STEEL,C21B,2013
PRODUCTION AND REFINING OF METALS; PRETREATMENT OF RAW MATERIALS,C22B,2013
SHAFTS; FLEXIBLE SHAFTS; ELEMENTS OR CRANKSHAFT MECHANISMS; ROTARY BODIES OTHER THAN GEARING ELEMENTS; BEARINGS,F16C,2015
VALVES; TAPS; COCKS; ACTUATING-FLOATS; DEVICES FOR VENTING OR AERATING,F16K,2012
"FURNACES, KILNS, OVENS, OR RETORTS IN GENERAL; OPEN SINTERING OR LIKE APPARATUS",F27B,2013
"DETAILS OR ACCESSORIES OF FURNACES, KILNS, OVENS, OR RETORTS, IN SO FAR AS THEY ARE OF KINDS OCCURRING IN MORE THAN ONE KIND OF FURNACE",F27D,2013
ELECTROGRAPHY; ELECTROPHOTOGRAPHY; MAGNETOGRAPHY,G03G,2009
"IMPEDANCE NETWORKS, e.g. RESONANT CIRCUITS; RESONATORS",H03H,2011
TRANSMISSION,H04B,2011
"PICTORIAL COMMUNICATION, e.g. TELEVISION",H04N,2009
TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS,Y10S,2006
Current sql:
SELECT
    cpc_def."titleFull" AS "Full_Title",
    cpc_group_stats."cpc_group" AS "CPC_Group",
    cpc_group_stats."best_year" AS "Best_Year"
FROM
    (
        SELECT
            "cpc_group",
            "filing_year" AS "best_year"
        FROM
            (
                SELECT
                    "cpc_group",
                    "filing_year",
                    SUM("filing_count" * POWER(0.1, 2016 - "filing_year")) /
                    SUM(POWER(0.1, 2016 - "filing_year")) AS "ema"
                FROM
                    (
                        SELECT
                            LEFT(cpc_code.value:"code"::STRING, 4) AS "cpc_group",
                            EXTRACT(year FROM TRY_TO_DATE("filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
                            COUNT(*) AS "filing_count"
                        FROM
                            "PATENTS"."PATENTS"."PUBLICATIONS",
                            LATERAL FLATTEN(input => "cpc") cpc_code
                        WHERE
                            "country_code" = 'DE'
                            AND TRY_TO_DATE("grant_date"::VARCHAR, 'YYYYMMDD') BETWEEN '2016-12-01' AND '2016-12-31'
                            AND "grant_date" != 0
                            AND "filing_date" != 0
                        GROUP BY
                            "cpc_group", "filing_year"
                        HAVING
                            "filing_year" IS NOT NULL
                    ) sub
                GROUP BY
                    "cpc_group", "filing_year"
            ) ema_calc
        QUALIFY ROW_NUMBER() OVER (PARTITION BY "cpc_group" ORDER BY "ema" DESC) = 1
    ) cpc_group_stats
LEFT JOIN "PATENTS"."PATENTS"."CPC_DEFINITION" cpc_def
    ON cpc_def."symbol" = cpc_group_stats."cpc_group"
ORDER BY
    cpc_group_stats."cpc_group";When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-23 18:49:52 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 18:49:52 - root - INFO - ```sql
SELECT
    cpc_def."titleFull" AS "Full_Title",
    cpc_group_stats."cpc_group" AS "CPC_Group",
    cpc_group_stats."best_year" AS "Best_Year"
FROM
    (
        SELECT
            "cpc_group",
            "filing_year" AS "best_year"
        FROM
            (
                SELECT
                    "cpc_group",
                    "filing_year",
                    SUM("filing_count" * POWER(0.1, 2016 - "filing_year")) /
                    SUM(POWER(0.1, 2016 - "filing_year")) AS "ema"
                FROM
                    (
                        SELECT
                            LEFT(cpc_code.value:"code"::STRING, 4) AS "cpc_group",
                            EXTRACT(year FROM TRY_TO_DATE("filing_date"::VARCHAR, 'YYYYMMDD')) AS "filing_year",
                            COUNT(*) AS "filing_count"
                        FROM
                            "PATENTS"."PATENTS"."PUBLICATIONS",
                            LATERAL FLATTEN(input => "cpc") cpc_code
                        WHERE
                            "country_code" = 'DE'
                                AND TRY_TO_DATE("grant_date"::VARCHAR, 'YYYYMMDD') BETWEEN '2016-12-01' AND '2016-12-31'
                                AND "grant_date" != 0
                                AND "filing_date" != 0
                        GROUP BY
                            "cpc_group", "filing_year"
                        HAVING
                            "filing_year" IS NOT NULL
                    ) sub
                GROUP BY
                    "cpc_group", "filing_year"
            ) ema_calc
        QUALIFY ROW_NUMBER() OVER (PARTITION BY "cpc_group" ORDER BY "ema" DESC NULLS LAST) = 1
    ) cpc_group_stats
LEFT JOIN "PATENTS"."PATENTS"."CPC_DEFINITION" cpc_def
    ON cpc_def."symbol" = cpc_group_stats."cpc_group"
ORDER BY
    cpc_group_stats."cpc_group";
```
2025-01-23 18:49:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 18:49:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 18:49:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 18:49:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 15
2025-01-23 18:49:54 - snowflake.connector.connection - INFO - closed
2025-01-23 18:49:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 18:49:54 - root - INFO - itercount: 2
2025-01-23 18:49:54 - root - INFO - 0
2025-01-23 18:49:54 - root - INFO - Total iteration counts: 2
