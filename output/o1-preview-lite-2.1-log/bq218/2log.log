2025-01-24 02:08:19 - openai._base_client - INFO - Retrying request to /chat/completions in 0.466521 seconds
2025-01-24 02:09:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 02:09:11 - root - INFO - SQL:
-- 1. Select distinct item numbers and descriptions.
SELECT DISTINCT item_number, item_description
FROM `bigquery-public-data.iowa_liquor_sales.sales`
LIMIT 100
Results:
item_number,item_description
102013,JAGERMEISTER MINIMEISTER ICE BUCKET VAP
101151,FIREBALL CINNAMON WHISKEY ADULT TRICK OR TREAT BAG MINI
11771,BLACK VELVET MINI
37010,SVEDKA ROSE MINI
38530,WHEATLEY VODKA MINI
39225,NEW AMSTERDAM TANGERINE MINI
39555,DEEP EDDY LEMON MINI
39706,WESTERN SON WATERMELON MINI
39714,SMIRNOFF SOURCED WATERMELON MINI
42712,MALIBU COCONUT RUM MINI
65251,JAGERMEISTER LIQUEUR MINI
69713,DR MCGILLICUDDYS PEACH MINI
75218,KINKY GREEN MINI
78115,SAINTS ''N SINNERS MINI
84102,99 SOUR CHERRY MINI
84197,99 PINEAPPLE MINI
86078,JOSE CUERVO ESPECIAL SILVER MINI
89781,SAUZA GOLD MINI
100423,FIREBALL CINNAMON WHISKEY 100ML CARRIER
86379,WHISKEYSMITH WHISKEYRITA
32233,SEAGRAMS EXTRA DRY GIN
52593,E & J VS BRANDY
53213,PAUL MASSON GRANDE AMBER BRANDY VS
57325,BETINI MARGARITA
57328,BETINI TROPICAL SUNSET
58909,JOSE CUERVO AUTHENTIC WHITE PEACH LIGHT MARGARITA
26087,BIRD DOG HONEY FLAVORED WHISKEY MINI
15244,WINDSOR CANADIAN
19475,MAKERS MARK REPLICA
34154,BELVEDERE PURE
40593,NEW AMSTERDAM PEACH
61212,HIGH WEST OLD FASHIONED BARREL FINISHED COCKTAIL WHISKEY
69634,DR MCGILLICUDDYS CHERRY
77264,TOOTERS RED-DICULOUS ON THE BEACH
86438,SKREWBALL PEANUT BUTTER WHISKEY
87484,DON JULIO BLANCO
88185,OLMECA ALTOS PLATA
89624,PATRON REPOSADO
965344,SOOH JINRO STRAWBERRY SOJU
101047,FIREBALL PARTY COOLER
73704,EVAN WILLIAMS HONEY RESERVE MINI
43685,CROSS KEYS RUM MINI
71441,AFTER SHOCK CINNAMON LIQUEUR MINI
73720,EVAN WILLIAMS CINNAMON RESERVE MINI
75218,KINKY GREEN LIQUEUR MINI
34421,GREY GOOSE VODKA MINI
73807,FRAPPACHATA MOCHA ICED COFFEE
71410,ADELAIDES COCONUT LIQUEUR MINI
100001,ABSENTE W/GLASS & SPOON PACK
25984,JACK DANIELS 12YR
101431,FRANGELICO LIQUEUR W/4 SHOT GLASSES
102345,CASAMIGOS ANEJO W/ MASON JAR JUICER
15888,THE QUIET MAN 8YR
16676,BASIL HAYDEN 8YR
17916,ELIJAH CRAIG
18196,EZRA BROOKS 50 MO KY SOUR MASH BOURBON
18276,FIGHTING COCK BOURBON
19009,JEFFERSONS VERY SMALL BATCH
19019,JESSE JAMES BOURBON
19498,MAKERS MARK 101
20246,OLD CROW
21067,PENELOPE BARREL STRENGTH
21224,REDEMPTION BOURBON BARREL PROOF 9YR
21677,2XO SNEAKER HEAD
22121,WILD TURKEY 81
23329,BP KOVAL SINGLE BARREL WHISKEY RYE BOTTLED IN BOND
24456,KESSLER BLEND WHISKEY
24574,LITTLE BOOK CHAPTER 4 LESSONS HONORED
25702,THE QUINTESSENTIAL SPECIAL RELEASE - UNTITLED CIGAR MALT PRO

2025-01-24 02:09:13 - root - INFO - SQL:
-- 2. Retrieve total sales per item for the year 2022.
SELECT item_number, item_description, SUM(sale_dollars) AS total_sales_2022
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) = 2022
GROUP BY item_number, item_description
LIMIT 100
Results:
item_number,item_description,total_sales_2022
10775,CROWN ROYAL PEACH MINI,18203.129999999986
26164,BIRD DOG BLACK CHERRY MINI,10552.5
27453,CINERATOR MINI,31226.910000000007
39208,SEAGRAMS STRAWBERRY LEMONADE VODKA MINI,8024.699999999996
39280,NEW AMSTERDAM PASSION FRUIT FLAVORED VODKA MINI,10927.65
65061,GOLDSCHLAGER CINNAMON SCHNAPPS MINI,16056.0
69064,DR MCGILLICUDDYS APPLE PIE FOOTBALL PET MINI,12682.5
78128,SMIRNOFF PINK LEMONADE MINI,60545.21000000003
86970,OLE SMOKY BLUE FLAME MOONSHINE MINI,11908.910000000014
56193,PAUL MASSON PEACH GRANDE AMBER BRANDY,26674.619999999995
43134,BACARDI LIMON,16605.0
69722,DR MCGILLICUDDYS BUTTERSCOTCH,2584.0800000000004
89641,PATRON ANEJO MINI,19483.200000000008
11773,BLACK VELVET,266083.73999999993
12476,CANADIAN MIST WHISKY PET,24033.50000000002
15779,JAMESON BLACK BARREL,13015.919999999995
16075,MAKOTO 23 YR,17066.25
20116,OLD GRAND DAD 114PRF,70251.83999999998
21184,RABBIT HOLE DARERINGER SHERY BOURBON CASK,97691.13000000009
21946,WILD TURKEY KENTUCKY SPIRIT,11565.0
22172,WILD TURKEY RARE BREED RYE BARREL PROOF,13320.0
26820,JACK DANIELS OLD #7 BLACK LABEL FLAT,800747.5699999996
32236,SEAGRAMS EXTRA DRY GIN,187342.01000000015
33467,ABSOLUT LIME,131597.21000000002
34014,ABSOLUT APEACH,89055.59
34433,GREY GOOSE,889042.5
35914,FIVE O'CLOCK VODKA,206053.70000000007
36447,INGENIOZ,33876.81000000001
37302,SVEDKA CHERRY LIMEADE VODKA,30744.0
38174,TITOS HANDMADE VODKA,1334628.9300000004
39577,NORTH FORTY RASPBERRY VODKA,11193.75
46689,PAPAS PILAR DARK RUM,9094.5
5153,GLENLIVET FOUNDERS RESERVE,78533.55000000006
52582,E & J VSOP,102941.93999999994
5486,MACALLAN 12YR,87911.20000000003
56006,CHRISTIAN BROS PEACH,56898.0
6316,TOMATIN SINGLE MALT,27126.0
64388,BUMBU RUM,18340.0
66306,RAMAZZOTTI AMARO,6657.75
73055,RUMCHATA,931839.75
76435,OAK & EDEN WHEAT & SPIRE,10815.0
79026,ARROW CREME DE MENTHE GREEN,21166.469999999998
80580,ARROW SUPER PEPPERMINT SCHNAPPS,9795.0
81966,ARROW MCDALES BUTTERSCOTCH SCHNAPPS,16687.16999999999
82840,DEKUYPER LUSCIOUS PEACHTREE PET,91913.00999999997
88602,SOLANA AGAVE BLANCO,50394.23999999995
89006,ASOMBROSO LA ROSA REPOSADO,12038.320000000014

2025-01-24 02:09:15 - root - INFO - SQL:
-- 3. Retrieve total sales per item for the year 2023.
SELECT item_number, item_description, SUM(sale_dollars) AS total_sales_2023
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) = 2023
GROUP BY item_number, item_description
LIMIT 100
Results:
item_number,item_description,total_sales_2023
102013,JAGERMEISTER MINIMEISTER ICE BUCKET VAP,9680.999999999985
101151,FIREBALL CINNAMON WHISKEY ADULT TRICK OR TREAT BAG MINI,194738.40000000002
11771,BLACK VELVET MINI,367728.1400000001
39555,DEEP EDDY LEMON MINI,105114.01000000002
65251,JAGERMEISTER LIQUEUR MINI,201936.42000000007
69713,DR MCGILLICUDDYS PEACH MINI,15015.0
75218,KINKY GREEN MINI,61376.03999999999
84102,99 SOUR CHERRY MINI,42043.67999999998
84197,99 PINEAPPLE MINI,111796.56000000001
86078,JOSE CUERVO ESPECIAL SILVER MINI,38665.0
100423,FIREBALL CINNAMON WHISKEY 100ML CARRIER,932589.0
89781,SAUZA GOLD MINI,24308.100000000002
57328,BETINI TROPICAL SUNSET,2157.840000000001
15244,WINDSOR CANADIAN,12926.550000000001
40593,NEW AMSTERDAM PEACH,115794.0
69634,DR MCGILLICUDDYS CHERRY,43080.0
86438,SKREWBALL PEANUT BUTTER WHISKEY,55745.789999999986
53213,PAUL MASSON GRANDE AMBER BRANDY VS,255474.23999999996
16676,BASIL HAYDEN 8YR,863493.75
17916,ELIJAH CRAIG,913466.5200000001
21067,PENELOPE BARREL STRENGTH,92520.0
22121,WILD TURKEY 81,82517.25
24456,KESSLER BLEND WHISKEY,71229.51
26233,CM NASSIF FAMILY RESERVE,11253.0
28236,BOMBAY SAPPHIRE GIN,401274.6799999999
28858,TANQUERAY SEVILLA ORANGE,52013.21999999997
28886,TANQUERAY NO TEN,73192.61000000003
31475,NEW AMSTERDAM GIN,188881.5
34030,ABSOLUT CITRON,276925.25999999995
34267,GREY GOOSE LE CITRON,14968.5
36871,CIROC 80PRF,59524.44000000002
38176,TITOS HANDMADE VODKA,6565380.0
41846,EVERCLEAR 151,379255.5
47865,D'USSE VSOP,432240.0
5159,GLENFIDDICH 14YR,135176.25
56196,PAUL MASSON PEACH GRANDE AMBER BRANDY,79182.22000000002
66097,PROPER NO. TWELVE  APPLE,65982.0
67900,BAILEYS CHOCOLATE,299230.3000000001
68625,MIDNIGHT MOON COOKIES & CREAM MOONSHAKE,19820.25
69611,DR MCGILLICUDDYS APPLE PIE,137512.14
73200,CAPTAIN MORGAN CHERRY VANILLA,212770.67999999993
75183,KETEL ONE BOTANICAL PEACH & ORANGE BLOSSOM,142868.0
77842,SMIRNOFF STRAWBERRY,149575.16000000015
78191,ANGELS ENVY BARREL,16332.579999999974
80015,BLUE CHAIR BAY KEY LIME RUM CREAM,45803.39999999999
80239,IOWISH CREAM SALTED CARAMEL,189112.5
84456,PARAMOUNT PEACH SCHNAPPS,20787.44
86749,OLE SMOKY CHERRY MOONSHINE,70414.5

2025-01-24 02:09:17 - root - INFO - SQL:
-- 4. Compare total sales per item between 2022 and 2023.
SELECT item_number, item_description, EXTRACT(YEAR FROM date) AS year, SUM(sale_dollars) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) IN (2022, 2023)
GROUP BY item_number, item_description, year
ORDER BY item_number, year
LIMIT 100
Results:
item_number,item_description,year,total_sales
100015,FIREBALL CINNAMON WHISKEY BAG IN BOX 1,2022,630.0
100015,FIREBALL CINNAMON WHISKEY BAG IN BOX,2022,31275.0
10006,SCORESBY RARE SCOTCH,2022,22967.28000000001
10006,SCORESBY RARE SCOTCH,2023,19998.160000000014
100077,KRAKEN RUM W/ TIKI GLASS,2022,13030.08
10008,SCORESBY RARE SCOTCH,2022,187142.25
10008,SCORESBY RARE SCOTCH,2023,170148.0
10009,SCORESBY RARE SCOTCH,2022,16226.549999999997
10009,SCORESBY RARE SCOTCH,2023,15973.799999999996
100104,HERRADURA ULTRA ANEJO,2022,78327.59000000001
100104,HERRADURA ULTRA ANEJO,2023,120996.9200000001
100148,JACK DANIELS SINGLE BARREL W/SNIFTER GLASS,2023,22443.75
100215,TEQUILA ROSE LIQUEUR W/2 SHOT GLASSES,2022,24142.5
100215,TEQUILA ROSE LIQUEUR W/2 SHOT GLASSES,2023,23925.0
100216,TARANTULA AZUL HOLIDAY W/2 SHOT GLASSES,2022,256.31
100220,TWISTED SHOTZ TRADITIONAL PARTY PACK 3.0,2022,45006.58000000003
100220,TWISTED SHOTZ TRADITIONAL PARTY PACK 3.0,2023,41121.92000000007
100248,MARTELL BLUE SWIFT W/ 2 GLASSES,2022,7301.039999999998
100280,THE BITTER TRUTH COCKTAIL BAR PACK,2022,128.25
100306,PATRON EXTRA ANEJO,2022,44197.23000000002
100306,PATRON EXTRA ANEJO,2023,27068.16
100413,FIREBALL CINNAMON WHISKEY PARTY BUCKET,2022,1198384.1999999995
100413,FIREBALL CINNAMON WHISKEY PARTY BUCKET,2023,1192192.2000000011
100423,FIREBALL CINNAMON WHISKEY 100ML CARRIER,2022,607671.0
100423,FIREBALL CINNAMON WHISKEY 100ML CARRIER,2023,932589.0
100429,WRITERS TEARS COPPER POT VAP W/ FLASK,2022,3695.1000000000013
100429,WRITERS TEARS COPPER POT VAP W/ FLASK,2023,711.9
100433,SUNTORY TOKI W/HIGHBALL GLASS,2022,14296.460000000001
100433,SUNTORY TOKI W/HIGHBALL GLASS,2023,787.25
100443,REDBREAST TRI PACK MINI,2023,13487.999999999987
100490,ABSOLUT MINI BAR,2023,14687.720000000003
100509,HYPNOTIQ W/ ROCK GLASSES,2022,4768.5
100533,BACARDI OCHO GIFT TUBE,2022,4365.0
100533,BACARDI OCHO GIFT TUBE,2023,2250.0
100535,FIREBALL GIFT BOX,2022,39938.40000000004
100535,FIREBALL GIFT BOX,2023,34830.000000000015
100568,BOURBON TIME,2022,3762.0
100572,JOHNNIE WALKER 200ML COLLECTION PACK,2022,27656.25
100572,JOHNNIE WALKER 200ML COLLECTION PACK,2023,10706.879999999996
100605,JAMESON W/GINGER ALE,2022,5651.099999999998
100605,JAMESON W/GINGER ALE,2023,2608.2
100618,CRYSTAL HEAD VODKA W/4 SKULL GLASSES,2023,8106.559999999996

2025-01-24 02:09:19 - root - INFO - SQL:
-- 5. List items with sales in 2023 but not in 2022.
SELECT DISTINCT s2023.item_number, s2023.item_description
FROM `bigquery-public-data.iowa_liquor_sales.sales` AS s2023
WHERE EXTRACT(YEAR FROM s2023.date) = 2023
  AND s2023.item_number NOT IN (
    SELECT DISTINCT item_number
    FROM `bigquery-public-data.iowa_liquor_sales.sales`
    WHERE EXTRACT(YEAR FROM date) = 2022
  )
LIMIT 100
Results:
item_number,item_description
102027,99 PUNCHES VARIETY MINI
102042,RUMCHATA PUMPKIN SPICE MINI
86079,JOSE CUERVO ESPECIAL GOLD MINI
68622,MIDNIGHT MOON CHOCOLATE BROWNIE MOONSHAKE MINI
102057,FIREBALL FALL TAILGATE BAG
78187,TWISTED TEA WHISKEY MINI
25999,BP KEEPERS HEART IRISH + AMERICAN FINISHED IN A STOUT BARREL
16017,HEAVEN HILL BOTTLED-IN-BOND 7YR
17093,BP BULLEIT SINGLE BARREL
22382,WIDOW JANE PARADIGM
22564,PIGGYBACK RYE LEGENDS SERIES FORMULA 1
69939,RUMPLE MINZE
911475,HA JP WISERS 27YR
22249,WOODFORD RESERVE HOLIDAY 2023
17207,BARREL PROOF BOURBON WHISKEY
26357,BARRELL SEAGRASS
38810,WHITE CLAW PINEAPPLE VODKA
66522,RUMCHATA COCONUT
64352,CITRONGE ORANGE
10778,CROWN ROYAL PEACH
101989,GREY GOOSE GLASS PACK
16254,BEN HOLLADAY 6YR MO BOURBON
22376,BIRD DOG GINGERBREAD
25614,FIELD OF DREAMS WHISKEY
33420,BELVEDERE PURE
89155,DON JULIO REPOSADO
89580,MILAGRO ANEJO
57210,BUZZBALLZ BIGGIES TEQUILA RITA
57578,BUZZBALLZ BIGGIES STRAWBERRY RITA
21493,SILK & GOLD BOURBON
66524,RUMCHATA PUMPKIN SPICE
57575,BUZZBALLZ BIGGIES CHOCOLATE TEASE
76684,FIREBALL DRAGNUM
37952,IOWA STATE 1858 VODKA
102097,MIDNIGHT MOON HOLIDAY CANDY CANE
66726,SHANKYS WHIP BLACK SPIRITS MINI
65929,MALIBU PEACH MINI
16275,AO SUNTORY WORLD WHISKY
102015,JAGERMEISTER ALUMINUM SHOT CUP VAP
18637,BEN HOLLADAY RICKHOUSE PROOF BOURBON WHISKEY
19236,BP KNOB CREEK SINGLE BARREL
21462,BENCHMARK FULL PROOF
22262,BP YELLOWSTONE HAND PICKED 109PRF
22289,YELLOWSTONE LIMITED EDITION 2023
25940,REBEL STRAIGHT RYE 100
25949,CM THE MAGI BLENDED RYE WHISKEY
6303,ARDBEG HEAVY VAPOURS - COMMITTEE RELEASE
927516,HA MICHTERS US*1 UNBLENDED AMERICAN WHISKEY
88267,MILAGRO ANEJO
38561,WHITE CLAW PREMIUM VODKA
101664,BUSHMILLS W/GOLF FLASK
102014,ELIJAH CRAIG RYE HOLIDAY VAP
26678,REDWOOD EMPIRE PIPE DREAM BOURBON
33431,ABSOLUT WILD BERRY
68623,MIDNIGHT MOON CHOCOLATE BROWNIE MOONSHAKE
73122,BUBBAS MARSHMALLOW CHOCOLATE WHISKEY
76495,OLE SMOKY BANANA WHISKEY
80240,IOWISH CREAM AMARETTO
86401,KENTUCKY COFFEE WHISKEY
87355,CUTWATER TEQUILA BLANCO
922426,MIJENTA TEQUILA BLANCO
985631,CHICKEN COCK CHANTICLEER COGNAC FINISH BOURBON
102040,CROWN ROYAL DELUXE 1.75L W HOLIDAY BAG AND BOX
102092,CAPTAIN MORGAN OSR W/NFL TIN CUP
922442,PLOW POINT SMALL BATCH WHISKEY
34516,SOBIESKI VODKA PET
14467,REVEL STOKE BUTTERSQUATCH BUTTERSCOTCH MINI

2025-01-24 02:09:21 - root - INFO - SQL:
-- 6. Calculate the percentage growth in sales from 2022 to 2023 for each item.
SELECT
  item_number,
  item_description,
  (SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2023 THEN sale_dollars ELSE 0 END) -
   SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2022 THEN sale_dollars ELSE 0 END)
  ) / SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2022 THEN sale_dollars ELSE NULL END) * 100 AS growth_percentage
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) IN (2022, 2023)
GROUP BY item_number, item_description
LIMIT 100
Results:
item_number,item_description,growth_percentage
35318,BARTON VODKA,-2.8419766698417464
101641,CODY ROAD SIX SHOOTER VARIETY PACK MINIS,-20.079787234042552
101682,BACARDI FLAVORED RUM PARTY BUCKET,-100.0
101953,BACARDI FLAVORED RUM PARTY BUCKET,
26172,BIRD DOG PEACH MINI,-3.7291817523533672
36964,GREY GOOSE MINI,-4.330708661417323
37305,PERMA FROST SCHNAPPS MINI,-100.0
52591,E & J VS MINI,0.042294155853960874
68622,MIDNIGHT MOON CHOCOLATE BROWNIE MOONSHAKE MINI,
84230,99 BRAND MYSTERY FLAVOR PET MINI,-37.027027027027096
86691,JACK DANIELS TENNESSEE FIRE MINI,-19.205134534682795
89191,JOSE CUERVO ESPECIAL REPOSADO MINI,-12.344875275316296
14534,REVEL STOKE SMORGASM TOASTED SMORES WHISKEY MINI,-90.50966608084359
102095,BAILEYS MULTI PACK MINI,
26823,JACK DANIELS OLD #7 BLACK LABEL,3.6943027897639134
47861,D'USSE VSOP,-56.15956072351421
27615,WHITE DOG MASH #1,-3.731343283582089
37994,SMIRNOFF 80PRF,7.878410537346328
43334,CAPTAIN MORGAN ORIGINAL SPICED,8.2676019388192
68034,BAILEYS ORIGINAL IRISH CREAM,-4.900126189411791
87509,1800 SILVER,30.721472479686206
88354,TEREMANA BLANCO TEQUILA,52.25441490178816
48099,HENNESSY VS,-13.56534590752339
64722,CIROC PEACH,-21.341653666146644
925984,HA JACK DANIELS 12YR,
11586,BLACK VELVET RESERVE,-71.27276088363065
16580,BAKERS 7YR,257.8059071729958
18392,GARRISON BROTHERS SNGL BRL SAMPLER TEXAS STRAIGHT BOURBON,
19486,MAKERS 46,-0.8384831938697617
20366,OLD FORESTER BOURBON 86PRF,29.322957963580958
21480,BENCHMARK OLD NO 8,16.99873878725183
22156,WILD TURKEY 101,4.065880908138366
25113,LEADSLINGERS BOURBON WHISKEY 10YR,-69.83471074380165
27016,RITTENHOUSE RYE WHISKEY,8.779828905898244
27171,MINOR CASE STRAIGHT RYE,26.60377358490566
27181,JACK DANIELS TENNESSEE RYE,-58.75298411796107
2849,CRYSTAL HEAD W/ 2 SKULL GLASSES,-100.0
34116,ABSOLUT MANDRIN,5.78909868186669
37403,ABSOLUT WATERMELON,33.45454545454542
41943,360 GEORGIA PEACH,-14.082607067559906
43316,CAPTAIN MORGAN PRIVATE STOCK,-23.559148216762534
4381,BALVENIE 21YR PORTWOOD,-19.162173372044794
43869,KASAMA SMALL BATCH RUM 7YR,1743.6363636363637
48122,HENNESSY XO,-44.631260107297734
49156,REMY MARTIN XO EXCELLENCE,45.45669414887439
5006,GLENFIDDICH 12YR SPECIAL RESERVE,-7.370837150728569

2025-01-24 02:09:23 - root - INFO - SQL:
-- 7. Get total sales and number of transactions per item in 2023.
SELECT
  item_number,
  item_description,
  SUM(sale_dollars) AS total_sales_2023,
  COUNT(*) AS transactions_2023
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) = 2023
GROUP BY item_number, item_description
LIMIT 100
Results:
item_number,item_description,total_sales_2023,transactions_2023
35918,FIVE O'CLOCK VODKA,814809.7799999999,9511
41691,UV BLUE RASPBERRY MINI,58439.40000000001,1565
69940,RUMPLE MINZE PEPPERMINT SCHNAPPS LIQUEUR MINI,288967.5,3243
28039,JIM BEAM VANILLA MINI,48678.0,1071
38811,WHITE CLAW PINEAPPLE VODKA MINI,3812.52,101
38844,TRULY PINEAPPLE MANGO MINI,11048.850000000002,523
67522,KAHLUA COFFEE MINI,21235.500000000004,911
75208,KINKY PINK MINI,144459.47999999995,5077
75224,KINKY RED MINI,71438.40000000004,2325
81124,99 PEPPERMINT MINI,202470.65999999986,2733
84400,99 MANGOES MINI,34684.20000000003,590
86828,OLE SMOKY HUNCH PUNCH MOONSHINE MINI,48200.230000000025,1025
52579,E & J VSOP MINI,14384.00000000001,323
75231,KINKY PINK,2478.19,42
47863,D'USSE VSOP,421298.7200000001,1657
49084,REMY MARTIN 1738 ACCORD ROYAL,389527.1700000002,1570
56195,PAUL MASSON PEACH GRANDE AMBER BRANDY,68373.48000000004,1054
65254,JAGERMEISTER LIQUEUR,288092.16,2820
87402,JOSE CUERVO ESPECIAL SILVER,226502.00000000017,1302
89193,JOSE CUERVO ESPECIAL REPOSADO,405719.7999999998,2968
24866,ROSSVILLE UNION BARREL PROOF 7YR,8820.0,110
25039,JD TWICE BARRELED HERITAGE RYE,10125.0,180
101819,RABBIT HOLE 2PK W/CAVEHILL & HEIGOLD,12639.379999999994,63
15206,FARMSTOCK IOWA BATCH,32168.399999999994,171
17107,BUZZARDS ROOST CHAR #1 STRAIGHT BOURBON WHISKEY,4284.119999999998,38
19000,BP JEFFERSONS RESERVE BOURBON BARREL,22170.209999999992,262
20369,OLD FORESTER 1870 WHISKY ROW SERIES,34082.18999999999,294
21589,EH TAYLOR JR SINGLE BARREL,15054.000000000036,301
21946,WILD TURKEY KENTUCKY SPIRIT SINGLE BARREL,14127.75,209
25604,SEAGRAMS 7 CROWN,227708.25,4798
26585,GENTLEMAN JACK,65808.0,342
27605,TIN CUP,155186.25,1088
34197,CIROC 80PRF,38211.640000000014,418
37336,UV VODKA,48940.5,582
43126,BACARDI SUPERIOR,567726.8400000001,4616
49186,REMY MARTIN VSOP,513363.4699999999,1540
5067,GLENMORANGIE SIGNET,25459.770000000008,55
5346,JOHNNIE WALKER RED,319342.5,2626

2025-01-24 02:09:25 - root - INFO - SQL:
-- 8. Find the top 100 items by total sales in 2023.
SELECT item_number, item_description, SUM(sale_dollars) AS total_sales_2023
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) = 2023
GROUP BY item_number, item_description
ORDER BY total_sales_2023 DESC
LIMIT 100
Results:
item_number,item_description,total_sales_2023
38178,TITOS HANDMADE VODKA,11393245.5
38177,TITOS HANDMADE VODKA,10001010.240000002
11788,BLACK VELVET,8560030.74
1799,CAPTAIN MORGAN ORIGINAL SPICED BARREL,7061536.239999997
38176,TITOS HANDMADE VODKA,6565380.0
88296,PATRON SILVER,5252856.0
43337,CAPTAIN MORGAN ORIGINAL SPICED,5014554.57
65013,FIREBALL CINNAMON WHISKEY MINI SLEEVE,4394133.450000003
10807,CROWN ROYAL REGAL APPLE,3787875.199999998
10802,CROWN ROYAL PEACH,3705297.9199999976
11297,CROWN ROYAL,3506902.4900000016
64870,FIREBALL CINNAMON WHISKEY,3481509.3000000003
26827,JACK DANIELS OLD #7 BLACK LABEL,3470328.3799999994
26826,JACK DANIELS OLD #7 BLACK LABEL,3142294.539999998
15627,JAMESON,3038113.8000000007
11296,CROWN ROYAL,2934681.6000000006
26828,JACK DANIELS OLD #7 BLACK LABEL,2659707.9600000004
15626,JAMESON,2597208.9599999995
38008,SMIRNOFF 80PRF PET,2477608.41
64864,FIREBALL CINNAMON WHISKEY,2451872.0
11298,CROWN ROYAL,2415090.359999999
10808,CROWN ROYAL REGAL APPLE,2349334.6299999985
36308,HAWKEYE VODKA,2344074.93
48106,HENNESSY VS,2280671.86
48105,HENNESSY VS,2102410.240000002
17206,CEDAR RIDGE BOURBON,1933558.3100000003
42717,MALIBU COCONUT,1924516.23
43336,CAPTAIN MORGAN ORIGINAL SPICED,1903360.3199999994
34368,FRIS DANISH VODKA,1818087.1799999992
64865,FIREBALL CINNAMON WHISKEY PET,1789262.0700000005
19476,MAKERS MARK,1721601.0
64866,FIREBALL CINNAMON WHISKEY,1709734.5
38088,PLATINUM 7X VODKA,1705444.56
64867,FIREBALL CINNAMON WHISKEY,1655136.0
38174,TITOS HANDMADE VODKA,1651129.8300000015
87485,DON JULIO BLANCO,1625383.3800000008
64858,FIREBALL CINNAMON WHISKEY MINI DISPENSER,1568007.9000000008
69947,RUMPLE MINZE PEPPERMINT SCHNAPPS LIQUEUR,1560944.2499999995
64868,FIREBALL CINNAMON WHISKEY,1559764.0
36904,MCCORMICK 80PRF VODKA PET,1529576.7599999977
19066,JIM BEAM,1512192.0
64904,FIREBALL CINNAMON WHISKEY PET,1496656.0
34006,ABSOLUT SWEDISH VODKA 80PRF,1492659.2300000004
22215,WOODFORD RESERVE,1466267.25
42716,MALIBU COCONUT,1463273.7900000007
43028,ADMIRAL NELSON SPICED,1422665.6000000003
34821,SVEDKA 80PRF,1406316.5999999999
10805,CROWN ROYAL REGAL APPLE,1382035.2000000011

2025-01-24 02:09:27 - root - INFO - SQL:
-- 9. List items with a significant increase in sales (more than 50%) from 2022 to 2023.
SELECT
  item_number,
  item_description,
  (SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2023 THEN sale_dollars ELSE 0 END) -
   SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2022 THEN sale_dollars ELSE 0 END)
  ) / SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2022 THEN sale_dollars ELSE NULL END) * 100 AS growth_percentage
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) IN (2022, 2023)
GROUP BY item_number, item_description
HAVING growth_percentage > 50
ORDER BY growth_percentage DESC
LIMIT 100
Results:
item_number,item_description,growth_percentage
74782,JACK DANIELS WINTER JACK,82851.2924213117
84155,99 CHERRIES MINI,14440.909090909083
64319,THE BUTTERFLY CANNON ROSA FLAVORED TEQUILA,13139.999999999998
38073,STATE VODKA,5882.974358974359
65543,LICOR 43 CHOCOLATE,4146.742209631728
101515,FIREBALL CINNAMON WHISKEY KEG,3038.586956521739
76497,KRAKEN GOLD SPICED RUM,3021.5384615384614
916631,TUMBLIN DICE BOURBON SINGLE BARREL BARREL PROOF 6YR,2999.9999999999995
902419,EL TESORO PLATINUM,2800.0000000000005
16832,BLADE & BOW,2697.019867549669
76851,INFUSED TEQUILA JALAPENO LIME,2629.166666666669
915848,HA RED SPOT,2449.999999999999
994785,HA CRAGGANMORE DISTILLERS EDITION,2366.488888888889
902421,EL TESORO ANEJO,2300.0
18605,HIGH WEST BOURBON WHISKEY,2230.0
26143,HIGH WEST DOUBLE RYE WHISKEY,2142.8571428571427
965235,ITALICUS ROSOLINO,1943.752779012895
62811,ON THE ROCKS KNOB CREEK OLD FASHIONED,1770.4663212435232
43869,KASAMA SMALL BATCH RUM 7YR,1743.6363636363637
983349,ICE HOLE CHERRY SCHNAPPS,1705.478775913129
63237,HEUBLEIN DIRTY MARTINI,1674.6835443037974
84400,99 MANGOES MINI,1659.726027397262
942631,FLOR DE CANA 12YR CENTENARIO,1600.0000000000005
63233,HEUBLEIN MYERS MAI TAI,1576.0
982781,DEKUYPER BUTTERSHOTS MINI,1500.0
943676,SELVAREY WHITE RUM,1500.0
62813,ON THE ROCKS EFFEN COSMOPOLITAN,1474.404761904762
63235,HEUBLEIN MANHATTAN,1385.5172413793105
926219,BARRELL PRIVATE RELEASE WHISKEY,1383.3333333333335
39371,BLUE ICE AMERICAN HUCKLEBERRY VODKA,1370.6935975609754
62814,ON THE ROCKS HORNITOS MARGARITA,1358.433734939759
902933,EL TESORO REPOSADO,1300.0
903998,AUCHENTOSHAN 12YR,1300.0
915783,CLONAKILTY IRISH WHISKEY SINGLE BATCH / DOUBLE OAK,1299.9999999999998
902420,MT GAY EXTRA OLD RUM,1200.0000000000002
928666,MAGELLAN GIN,1200.0
86487,MR BOSTON TRIPLE SEC,1176.527331189709
900598,KNAPPOGUE CASTLE 16YR TWIN WOOD,1116.6315789473686
63231,HEUBLEIN OLD FASHIONED,1090.6976744186047
941702,UV ORANGE,950.0
65787,MARASKA NOCELINO,934.8375319459656
35358,BLUE ICE AMERICAN POTATO VODKA,929.5054200542006
906264,TAMDHU 15 YO SINGLE MALT SCOTCH,921.0114747131323
904803,VEEV ACAI,900.0
64854,DORDA DOUBLE CHOCOLATE LIQUEUR,868.8034188034187
987039,OLE SMOKY BOURBON BALL,838.3333333333333

2025-01-24 02:09:29 - root - INFO - SQL:
-- 10. Compute total sales per item per month for 2023.
SELECT
  item_number,
  item_description,
  EXTRACT(MONTH FROM date) AS month,
  SUM(sale_dollars) AS monthly_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) = 2023
GROUP BY item_number, item_description, month
ORDER BY item_number, month
LIMIT 100
Results:
item_number,item_description,month,monthly_sales
10006,SCORESBY RARE SCOTCH,1,1660.26
10006,SCORESBY RARE SCOTCH,2,1444.5200000000002
10006,SCORESBY RARE SCOTCH,3,1875.9999999999995
10006,SCORESBY RARE SCOTCH,4,1500.7999999999997
10006,SCORESBY RARE SCOTCH,5,1744.6800000000003
10006,SCORESBY RARE SCOTCH,6,1941.66
10006,SCORESBY RARE SCOTCH,7,1688.3999999999996
10006,SCORESBY RARE SCOTCH,8,1857.2399999999993
10006,SCORESBY RARE SCOTCH,9,2119.8799999999997
10006,SCORESBY RARE SCOTCH,10,1500.8
10006,SCORESBY RARE SCOTCH,11,1050.5599999999997
10006,SCORESBY RARE SCOTCH,12,1613.36
10008,SCORESBY RARE SCOTCH,1,13332.0
10008,SCORESBY RARE SCOTCH,2,13761.0
10008,SCORESBY RARE SCOTCH,3,14833.5
10008,SCORESBY RARE SCOTCH,4,12688.5
10008,SCORESBY RARE SCOTCH,5,15625.5
10008,SCORESBY RARE SCOTCH,6,14916.0
10008,SCORESBY RARE SCOTCH,7,13249.5
10008,SCORESBY RARE SCOTCH,8,16203.0
10008,SCORESBY RARE SCOTCH,9,13629.0
10008,SCORESBY RARE SCOTCH,10,12903.0
10008,SCORESBY RARE SCOTCH,11,14322.0
10008,SCORESBY RARE SCOTCH,12,14685.0
10009,SCORESBY RARE SCOTCH,1,1051.44
10009,SCORESBY RARE SCOTCH,2,1476.0599999999995
10009,SCORESBY RARE SCOTCH,3,1294.08
10009,SCORESBY RARE SCOTCH,4,1324.4099999999994
10009,SCORESBY RARE SCOTCH,5,1182.8700000000001
10009,SCORESBY RARE SCOTCH,6,1688.3699999999994
10009,SCORESBY RARE SCOTCH,7,1213.1999999999996
10009,SCORESBY RARE SCOTCH,8,1536.7199999999996
10009,SCORESBY RARE SCOTCH,9,1455.8400000000001
10009,SCORESBY RARE SCOTCH,10,1283.97
10009,SCORESBY RARE SCOTCH,11,1577.1599999999999
10009,SCORESBY RARE SCOTCH,12,889.6800000000002
100104,HERRADURA ULTRA ANEJO,1,8278.159999999998
100104,HERRADURA ULTRA ANEJO,2,9447.899999999998
100104,HERRADURA ULTRA ANEJO,3,4319.039999999999
100104,HERRADURA ULTRA ANEJO,4,3509.2200000000003
100104,HERRADURA ULTRA ANEJO,5,10797.6
100104,HERRADURA ULTRA ANEJO,6,9603.0
100104,HERRADURA ULTRA ANEJO,7,9405.0
100104,HERRADURA ULTRA ANEJO,8,10593.0
100104,HERRADURA ULTRA ANEJO,9,9702.0

2025-01-24 02:09:29 - root - INFO - itercount: 0
2025-01-24 02:09:29 - root - INFO - Database Name: bigquery-public-data
Schema Name: iowa_liquor_sales
DDL describes table information.
,0
table_name,sales
ddl,"CREATE TABLE `bigquery-public-data.iowa_liquor_sales.sales`
(
  invoice_and_item_number STRING OPTIONS(description=""Concatenated invoice and line number associated with the liquor order. This provides a unique identifier for the individual liquor products included in the store order.""),
  date DATE OPTIONS(description=""Date of order""),
  store_number STRING OPTIONS(description=""Unique number assigned to the store who ordered the liquor.""),
  store_name STRING OPTIONS(description=""Name of store who ordered the liquor.""),
  address STRING OPTIONS(description=""Address of store who ordered the liquor.""),
  city STRING OPTIONS(description=""City where the store who ordered the liquor is located""),
  zip_code STRING OPTIONS(description=""Zip code where the store who ordered the liquor is located""),
  store_location GEOGRAPHY OPTIONS(description=""Location of store who ordered the liquor. The Address, City, State and Zip Code are geocoded to provide geographic coordinates. Accuracy of geocoding is dependent on how well the address is interpreted and the completeness of the reference data used.""),
  county_number STRING OPTIONS(description=""Iowa county number for the county where store who ordered the liquor is located""),
  county STRING OPTIONS(description=""County where the store who ordered the liquor is located""),
  category STRING OPTIONS(description=""Category code associated with the liquor ordered""),
  category_name STRING OPTIONS(description=""Category of the liquor ordered.""),
  vendor_number STRING OPTIONS(description=""The vendor number of the company for the brand of liquor ordered""),
  vendor_name STRING OPTIONS(description=""The vendor name of the company for the brand of liquor ordered""),
  item_number STRING OPTIONS(description=""Item number for the individual liquor product ordered.""),
  item_description STRING OPTIONS(description=""Description of the individual liquor product ordered.""),
  pack INT64 OPTIONS(description=""The number of bottles in a case for the liquor ordered""),
  bottle_volume_ml INT64 OPTIONS(description=""Volume of each liquor bottle ordered in milliliters.""),
  state_bottle_cost FLOAT64 OPTIONS(description=""The amount that Alcoholic Beverages Division paid for each bottle of liquor ordered""),
  state_bottle_retail FLOAT64 OPTIONS(description=""The amount the store paid for each bottle of liquor ordered""),
  bottles_sold INT64 OPTIONS(description=""The number of bottles of liquor ordered by the store""),
  sale_dollars FLOAT64 OPTIONS(description=""Total cost of liquor order (number of bottles multiplied by the state bottle retail)""),
  volume_sold_liters FLOAT64 OPTIONS(description=""Total volume of liquor ordered in liters. (i.e. (Bottle Volume (ml) x Bottles Sold)/1,000)\""""),
  volume_sold_gallons FLOAT64 OPTIONS(description=""Total volume of liquor ordered in gallons. (i.e. (Bottle Volume (ml) x Bottles Sold)/3785.411784)\"""")
)
OPTIONS(
  description=""Sales Dataset""
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'iowa_liquor_sales': ['sales']}}
Begin Exploring Related Columns
**Columns and their potential usage:**

- `date`: Used to filter sales records for the years 2022 and 2023.
- `item_number`: Identifies each unique liquor item.
- `item_description`: Provides a description of the item.
- `sale_dollars`: Used to calculate total sales revenue per item.

**Conditions that may be used:**

- `WHERE EXTRACT(YEAR FROM date) = 2022` to filter records from the year 2022.
- `WHERE EXTRACT(YEAR FROM date) = 2023` to filter records from the year 2023.
- `GROUP BY item_number, item_description` to aggregate data per item.
- `ORDER BY growth_percentage DESC` to sort items by highest growth.

---

**BigQuery SQL queries:**

```sql
-- 1. Select distinct item numbers and descriptions.
SELECT DISTINCT item_number, item_description
FROM `bigquery-public-data.iowa_liquor_sales.sales`
LIMIT 100;

-- 2. Retrieve total sales per item for the year 2022.
SELECT item_number, item_description, SUM(sale_dollars) AS total_sales_2022
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) = 2022
GROUP BY item_number, item_description
LIMIT 100;

-- 3. Retrieve total sales per item for the year 2023.
SELECT item_number, item_description, SUM(sale_dollars) AS total_sales_2023
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) = 2023
GROUP BY item_number, item_description
LIMIT 100;

-- 4. Compare total sales per item between 2022 and 2023.
SELECT item_number, item_description, EXTRACT(YEAR FROM date) AS year, SUM(sale_dollars) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) IN (2022, 2023)
GROUP BY item_number, item_description, year
ORDER BY item_number, year
LIMIT 100;

-- 5. List items with sales in 2023 but not in 2022.
SELECT DISTINCT s2023.item_number, s2023.item_description
FROM `bigquery-public-data.iowa_liquor_sales.sales` AS s2023
WHERE EXTRACT(YEAR FROM s2023.date) = 2023
  AND s2023.item_number NOT IN (
    SELECT DISTINCT item_number
    FROM `bigquery-public-data.iowa_liquor_sales.sales`
    WHERE EXTRACT(YEAR FROM date) = 2022
  )
LIMIT 100;

-- 6. Calculate the percentage growth in sales from 2022 to 2023 for each item.
SELECT
  item_number,
  item_description,
  (SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2023 THEN sale_dollars ELSE 0 END) -
   SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2022 THEN sale_dollars ELSE 0 END)
  ) / SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2022 THEN sale_dollars ELSE NULL END) * 100 AS growth_percentage
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) IN (2022, 2023)
GROUP BY item_number, item_description
LIMIT 100;

-- 7. Get total sales and number of transactions per item in 2023.
SELECT
  item_number,
  item_description,
  SUM(sale_dollars) AS total_sales_2023,
  COUNT(*) AS transactions_2023
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) = 2023
GROUP BY item_number, item_description
LIMIT 100;

-- 8. Find the top 100 items by total sales in 2023.
SELECT item_number, item_description, SUM(sale_dollars) AS total_sales_2023
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) = 2023
GROUP BY item_number, item_description
ORDER BY total_sales_2023 DESC
LIMIT 100;

-- 9. List items with a significant increase in sales (more than 50%) from 2022 to 2023.
SELECT
  item_number,
  item_description,
  (SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2023 THEN sale_dollars ELSE 0 END) -
   SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2022 THEN sale_dollars ELSE 0 END)
  ) / SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2022 THEN sale_dollars ELSE NULL END) * 100 AS growth_percentage
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) IN (2022, 2023)
GROUP BY item_number, item_description
HAVING growth_percentage > 50
ORDER BY growth_percentage DESC
LIMIT 100;

-- 10. Compute total sales per item per month for 2023.
SELECT
  item_number,
  item_description,
  EXTRACT(MONTH FROM date) AS month,
  SUM(sale_dollars) AS monthly_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) = 2023
GROUP BY item_number, item_description, month
ORDER BY item_number, month
LIMIT 100;
```

These queries help in understanding the sales data related to each item, their performance over the years 2022 and 2023, and enable calculation of year-over-year growth percentages required to identify the top 5 items with the highest growth.Query:
-- 1. Select distinct item numbers and descriptions.
SELECT DISTINCT item_number, item_description
FROM `bigquery-public-data.iowa_liquor_sales.sales`
LIMIT 100
Answer:
item_number,item_description
102013,JAGERMEISTER MINIMEISTER ICE BUCKET VAP
101151,FIREBALL CINNAMON WHISKEY ADULT TRICK OR TREAT BAG MINI
11771,BLACK VELVET MINI
37010,SVEDKA ROSE MINI
38530,WHEATLEY VODKA MINI
39225,NEW AMSTERDAM TANGERINE MINI
39555,DEEP EDDY LEMON MINI
39706,WESTERN SON WATERMELON MINI
39714,SMIRNOFF SOURCED WATERMELON MINI
42712,MALIBU COCONUT RUM MINI
65251,JAGERMEISTER LIQUEUR MINI
69713,DR MCGILLICUDDYS PEACH MINI
75218,KINKY GREEN MINI
78115,SAINTS ''N SINNERS MINI
84102,99 SOUR CHERRY MINI
84197,99 PINEAPPLE MINI
86078,JOSE CUERVO ESPECIAL SILVER MINI
89781,SAUZA GOLD MINI
100423,FIREBALL CINNAMON WHISKEY 100ML CARRIER
86379,WHISKEYSMITH WHISKEYRITA
32233,SEAGRAMS EXTRA DRY GIN
52593,E & J VS BRANDY
53213,PAUL MASSON GRANDE AMBER BRANDY VS
57325,BETINI MARGARITA
57328,BETINI TROPICAL SUNSET
58909,JOSE CUERVO AUTHENTIC WHITE PEACH LIGHT MARGARITA
26087,BIRD DOG HONEY FLAVORED WHISKEY MINI
15244,WINDSOR CANADIAN
19475,MAKERS MARK REPLICA
34154,BELVEDERE PURE
40593,NEW AMSTERDAM PEACH
61212,HIGH WEST OLD FASHIONED BARREL FINISHED COCKTAIL WHISKEY
69634,DR MCGILLICUDDYS CHERRY
77264,TOOTERS RED-DICULOUS ON THE BEACH
86438,SKREWBALL PEANUT BUTTER WHISKEY
87484,DON JULIO BLANCO
88185,OLMECA ALTOS PLATA
89624,PATRON REPOSADO
965344,SOOH JINRO STRAWBERRY SOJU
101047,FIREBALL PARTY COOLER
73704,EVAN WILLIAMS HONEY RESERVE MINI
43685,CROSS KEYS RUM MINI
71441,AFTER SHOCK CINNAMON LIQUEUR MINI
73720,EVAN WILLIAMS CINNAMON RESERVE MINI
75218,KINKY GREEN LIQUEUR MINI
34421,GREY GOOSE VODKA MINI
73807,FRAPPACHATA MOCHA ICED COFFEE
71410,ADELAIDES COCONUT LIQUEUR MINI
100001,ABSENTE W/GLASS & SPOON PACK
25984,JACK DANIELS 12YR
101431,FRANGELICO LIQUEUR W/4 SHOT GLASSES
102345,CASAMIGOS ANEJO W/ MASON JAR JUICER
15888,THE QUIET MAN 8YR
16676,BASIL HAYDEN 8YR
17916,ELIJAH CRAIG
18196,EZRA BROOKS 50 MO KY SOUR MASH BOURBON
18276,FIGHTING COCK BOURBON
19009,JEFFERSONS VERY SMALL BATCH
19019,JESSE JAMES BOURBON
19498,MAKERS MARK 101
20246,OLD CROW
21067,PENELOPE BARREL STRENGTH
21224,REDEMPTION BOURBON BARREL PROOF 9YR
21677,2XO SNEAKER HEAD
22121,WILD TURKEY 81
23329,BP KOVAL SINGLE BARREL WHISKEY RYE BOTTLED IN BOND
24456,KESSLER BLEND WHISKEY
24574,LITTLE BOOK CHAPTER 4 LESSONS HONORED
25702,THE QUINTESSENTIAL SPECIAL RELEASE - UNTITLED CIGAR MALT PRO
Query:
-- 2. Retrieve total sales per item for the year 2022.
SELECT item_number, item_description, SUM(sale_dollars) AS total_sales_2022
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) = 2022
GROUP BY item_number, item_description
LIMIT 100
Answer:
item_number,item_description,total_sales_2022
10775,CROWN ROYAL PEACH MINI,18203.129999999986
26164,BIRD DOG BLACK CHERRY MINI,10552.5
27453,CINERATOR MINI,31226.910000000007
39208,SEAGRAMS STRAWBERRY LEMONADE VODKA MINI,8024.699999999996
39280,NEW AMSTERDAM PASSION FRUIT FLAVORED VODKA MINI,10927.65
65061,GOLDSCHLAGER CINNAMON SCHNAPPS MINI,16056.0
69064,DR MCGILLICUDDYS APPLE PIE FOOTBALL PET MINI,12682.5
78128,SMIRNOFF PINK LEMONADE MINI,60545.21000000003
86970,OLE SMOKY BLUE FLAME MOONSHINE MINI,11908.910000000014
56193,PAUL MASSON PEACH GRANDE AMBER BRANDY,26674.619999999995
43134,BACARDI LIMON,16605.0
69722,DR MCGILLICUDDYS BUTTERSCOTCH,2584.0800000000004
89641,PATRON ANEJO MINI,19483.200000000008
11773,BLACK VELVET,266083.73999999993
12476,CANADIAN MIST WHISKY PET,24033.50000000002
15779,JAMESON BLACK BARREL,13015.919999999995
16075,MAKOTO 23 YR,17066.25
20116,OLD GRAND DAD 114PRF,70251.83999999998
21184,RABBIT HOLE DARERINGER SHERY BOURBON CASK,97691.13000000009
21946,WILD TURKEY KENTUCKY SPIRIT,11565.0
22172,WILD TURKEY RARE BREED RYE BARREL PROOF,13320.0
26820,JACK DANIELS OLD #7 BLACK LABEL FLAT,800747.5699999996
32236,SEAGRAMS EXTRA DRY GIN,187342.01000000015
33467,ABSOLUT LIME,131597.21000000002
34014,ABSOLUT APEACH,89055.59
34433,GREY GOOSE,889042.5
35914,FIVE O'CLOCK VODKA,206053.70000000007
36447,INGENIOZ,33876.81000000001
37302,SVEDKA CHERRY LIMEADE VODKA,30744.0
38174,TITOS HANDMADE VODKA,1334628.9300000004
39577,NORTH FORTY RASPBERRY VODKA,11193.75
46689,PAPAS PILAR DARK RUM,9094.5
5153,GLENLIVET FOUNDERS RESERVE,78533.55000000006
52582,E & J VSOP,102941.93999999994
5486,MACALLAN 12YR,87911.20000000003
56006,CHRISTIAN BROS PEACH,56898.0
6316,TOMATIN SINGLE MALT,27126.0
64388,BUMBU RUM,18340.0
66306,RAMAZZOTTI AMARO,6657.75
73055,RUMCHATA,931839.75
76435,OAK & EDEN WHEAT & SPIRE,10815.0
79026,ARROW CREME DE MENTHE GREEN,21166.469999999998
80580,ARROW SUPER PEPPERMINT SCHNAPPS,9795.0
81966,ARROW MCDALES BUTTERSCOTCH SCHNAPPS,16687.16999999999
82840,DEKUYPER LUSCIOUS PEACHTREE PET,91913.00999999997
88602,SOLANA AGAVE BLANCO,50394.23999999995
89006,ASOMBROSO LA ROSA REPOSADO,12038.320000000014
Query:
-- 3. Retrieve total sales per item for the year 2023.
SELECT item_number, item_description, SUM(sale_dollars) AS total_sales_2023
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) = 2023
GROUP BY item_number, item_description
LIMIT 100
Answer:
item_number,item_description,total_sales_2023
102013,JAGERMEISTER MINIMEISTER ICE BUCKET VAP,9680.999999999985
101151,FIREBALL CINNAMON WHISKEY ADULT TRICK OR TREAT BAG MINI,194738.40000000002
11771,BLACK VELVET MINI,367728.1400000001
39555,DEEP EDDY LEMON MINI,105114.01000000002
65251,JAGERMEISTER LIQUEUR MINI,201936.42000000007
69713,DR MCGILLICUDDYS PEACH MINI,15015.0
75218,KINKY GREEN MINI,61376.03999999999
84102,99 SOUR CHERRY MINI,42043.67999999998
84197,99 PINEAPPLE MINI,111796.56000000001
86078,JOSE CUERVO ESPECIAL SILVER MINI,38665.0
100423,FIREBALL CINNAMON WHISKEY 100ML CARRIER,932589.0
89781,SAUZA GOLD MINI,24308.100000000002
57328,BETINI TROPICAL SUNSET,2157.840000000001
15244,WINDSOR CANADIAN,12926.550000000001
40593,NEW AMSTERDAM PEACH,115794.0
69634,DR MCGILLICUDDYS CHERRY,43080.0
86438,SKREWBALL PEANUT BUTTER WHISKEY,55745.789999999986
53213,PAUL MASSON GRANDE AMBER BRANDY VS,255474.23999999996
16676,BASIL HAYDEN 8YR,863493.75
17916,ELIJAH CRAIG,913466.5200000001
21067,PENELOPE BARREL STRENGTH,92520.0
22121,WILD TURKEY 81,82517.25
24456,KESSLER BLEND WHISKEY,71229.51
26233,CM NASSIF FAMILY RESERVE,11253.0
28236,BOMBAY SAPPHIRE GIN,401274.6799999999
28858,TANQUERAY SEVILLA ORANGE,52013.21999999997
28886,TANQUERAY NO TEN,73192.61000000003
31475,NEW AMSTERDAM GIN,188881.5
34030,ABSOLUT CITRON,276925.25999999995
34267,GREY GOOSE LE CITRON,14968.5
36871,CIROC 80PRF,59524.44000000002
38176,TITOS HANDMADE VODKA,6565380.0
41846,EVERCLEAR 151,379255.5
47865,D'USSE VSOP,432240.0
5159,GLENFIDDICH 14YR,135176.25
56196,PAUL MASSON PEACH GRANDE AMBER BRANDY,79182.22000000002
66097,PROPER NO. TWELVE  APPLE,65982.0
67900,BAILEYS CHOCOLATE,299230.3000000001
68625,MIDNIGHT MOON COOKIES & CREAM MOONSHAKE,19820.25
69611,DR MCGILLICUDDYS APPLE PIE,137512.14
73200,CAPTAIN MORGAN CHERRY VANILLA,212770.67999999993
75183,KETEL ONE BOTANICAL PEACH & ORANGE BLOSSOM,142868.0
77842,SMIRNOFF STRAWBERRY,149575.16000000015
78191,ANGELS ENVY BARREL,16332.579999999974
80015,BLUE CHAIR BAY KEY LIME RUM CREAM,45803.39999999999
80239,IOWISH CREAM SALTED CARAMEL,189112.5
84456,PARAMOUNT PEACH SCHNAPPS,20787.44
86749,OLE SMOKY CHERRY MOONSHINE,70414.5
Query:
-- 4. Compare total sales per item between 2022 and 2023.
SELECT item_number, item_description, EXTRACT(YEAR FROM date) AS year, SUM(sale_dollars) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) IN (2022, 2023)
GROUP BY item_number, item_description, year
ORDER BY item_number, year
LIMIT 100
Answer:
item_number,item_description,year,total_sales
100015,FIREBALL CINNAMON WHISKEY BAG IN BOX 1,2022,630.0
100015,FIREBALL CINNAMON WHISKEY BAG IN BOX,2022,31275.0
10006,SCORESBY RARE SCOTCH,2022,22967.28000000001
10006,SCORESBY RARE SCOTCH,2023,19998.160000000014
100077,KRAKEN RUM W/ TIKI GLASS,2022,13030.08
10008,SCORESBY RARE SCOTCH,2022,187142.25
10008,SCORESBY RARE SCOTCH,2023,170148.0
10009,SCORESBY RARE SCOTCH,2022,16226.549999999997
10009,SCORESBY RARE SCOTCH,2023,15973.799999999996
100104,HERRADURA ULTRA ANEJO,2022,78327.59000000001
100104,HERRADURA ULTRA ANEJO,2023,120996.9200000001
100148,JACK DANIELS SINGLE BARREL W/SNIFTER GLASS,2023,22443.75
100215,TEQUILA ROSE LIQUEUR W/2 SHOT GLASSES,2022,24142.5
100215,TEQUILA ROSE LIQUEUR W/2 SHOT GLASSES,2023,23925.0
100216,TARANTULA AZUL HOLIDAY W/2 SHOT GLASSES,2022,256.31
100220,TWISTED SHOTZ TRADITIONAL PARTY PACK 3.0,2022,45006.58000000003
100220,TWISTED SHOTZ TRADITIONAL PARTY PACK 3.0,2023,41121.92000000007
100248,MARTELL BLUE SWIFT W/ 2 GLASSES,2022,7301.039999999998
100280,THE BITTER TRUTH COCKTAIL BAR PACK,2022,128.25
100306,PATRON EXTRA ANEJO,2022,44197.23000000002
100306,PATRON EXTRA ANEJO,2023,27068.16
100413,FIREBALL CINNAMON WHISKEY PARTY BUCKET,2022,1198384.1999999995
100413,FIREBALL CINNAMON WHISKEY PARTY BUCKET,2023,1192192.2000000011
100423,FIREBALL CINNAMON WHISKEY 100ML CARRIER,2022,607671.0
100423,FIREBALL CINNAMON WHISKEY 100ML CARRIER,2023,932589.0
100429,WRITERS TEARS COPPER POT VAP W/ FLASK,2022,3695.1000000000013
100429,WRITERS TEARS COPPER POT VAP W/ FLASK,2023,711.9
100433,SUNTORY TOKI W/HIGHBALL GLASS,2022,14296.460000000001
100433,SUNTORY TOKI W/HIGHBALL GLASS,2023,787.25
100443,REDBREAST TRI PACK MINI,2023,13487.999999999987
100490,ABSOLUT MINI BAR,2023,14687.720000000003
100509,HYPNOTIQ W/ ROCK GLASSES,2022,4768.5
100533,BACARDI OCHO GIFT TUBE,2022,4365.0
100533,BACARDI OCHO GIFT TUBE,2023,2250.0
100535,FIREBALL GIFT BOX,2022,39938.40000000004
100535,FIREBALL GIFT BOX,2023,34830.000000000015
100568,BOURBON TIME,2022,3762.0
100572,JOHNNIE WALKER 200ML COLLECTION PACK,2022,27656.25
100572,JOHNNIE WALKER 200ML COLLECTION PACK,2023,10706.879999999996
100605,JAMESON W/GINGER ALE,2022,5651.099999999998
100605,JAMESON W/GINGER ALE,2023,2608.2
100618,CRYSTAL HEAD VODKA W/4 SKULL GLASSES,2023,8106.559999999996
Query:
-- 5. List items with sales in 2023 but not in 2022.
SELECT DISTINCT s2023.item_number, s2023.item_description
FROM `bigquery-public-data.iowa_liquor_sales.sales` AS s2023
WHERE EXTRACT(YEAR FROM s2023.date) = 2023
  AND s2023.item_number NOT IN (
    SELECT DISTINCT item_number
    FROM `bigquery-public-data.iowa_liquor_sales.sales`
    WHERE EXTRACT(YEAR FROM date) = 2022
  )
LIMIT 100
Answer:
item_number,item_description
102027,99 PUNCHES VARIETY MINI
102042,RUMCHATA PUMPKIN SPICE MINI
86079,JOSE CUERVO ESPECIAL GOLD MINI
68622,MIDNIGHT MOON CHOCOLATE BROWNIE MOONSHAKE MINI
102057,FIREBALL FALL TAILGATE BAG
78187,TWISTED TEA WHISKEY MINI
25999,BP KEEPERS HEART IRISH + AMERICAN FINISHED IN A STOUT BARREL
16017,HEAVEN HILL BOTTLED-IN-BOND 7YR
17093,BP BULLEIT SINGLE BARREL
22382,WIDOW JANE PARADIGM
22564,PIGGYBACK RYE LEGENDS SERIES FORMULA 1
69939,RUMPLE MINZE
911475,HA JP WISERS 27YR
22249,WOODFORD RESERVE HOLIDAY 2023
17207,BARREL PROOF BOURBON WHISKEY
26357,BARRELL SEAGRASS
38810,WHITE CLAW PINEAPPLE VODKA
66522,RUMCHATA COCONUT
64352,CITRONGE ORANGE
10778,CROWN ROYAL PEACH
101989,GREY GOOSE GLASS PACK
16254,BEN HOLLADAY 6YR MO BOURBON
22376,BIRD DOG GINGERBREAD
25614,FIELD OF DREAMS WHISKEY
33420,BELVEDERE PURE
89155,DON JULIO REPOSADO
89580,MILAGRO ANEJO
57210,BUZZBALLZ BIGGIES TEQUILA RITA
57578,BUZZBALLZ BIGGIES STRAWBERRY RITA
21493,SILK & GOLD BOURBON
66524,RUMCHATA PUMPKIN SPICE
57575,BUZZBALLZ BIGGIES CHOCOLATE TEASE
76684,FIREBALL DRAGNUM
37952,IOWA STATE 1858 VODKA
102097,MIDNIGHT MOON HOLIDAY CANDY CANE
66726,SHANKYS WHIP BLACK SPIRITS MINI
65929,MALIBU PEACH MINI
16275,AO SUNTORY WORLD WHISKY
102015,JAGERMEISTER ALUMINUM SHOT CUP VAP
18637,BEN HOLLADAY RICKHOUSE PROOF BOURBON WHISKEY
19236,BP KNOB CREEK SINGLE BARREL
21462,BENCHMARK FULL PROOF
22262,BP YELLOWSTONE HAND PICKED 109PRF
22289,YELLOWSTONE LIMITED EDITION 2023
25940,REBEL STRAIGHT RYE 100
25949,CM THE MAGI BLENDED RYE WHISKEY
6303,ARDBEG HEAVY VAPOURS - COMMITTEE RELEASE
927516,HA MICHTERS US*1 UNBLENDED AMERICAN WHISKEY
88267,MILAGRO ANEJO
38561,WHITE CLAW PREMIUM VODKA
101664,BUSHMILLS W/GOLF FLASK
102014,ELIJAH CRAIG RYE HOLIDAY VAP
26678,REDWOOD EMPIRE PIPE DREAM BOURBON
33431,ABSOLUT WILD BERRY
68623,MIDNIGHT MOON CHOCOLATE BROWNIE MOONSHAKE
73122,BUBBAS MARSHMALLOW CHOCOLATE WHISKEY
76495,OLE SMOKY BANANA WHISKEY
80240,IOWISH CREAM AMARETTO
86401,KENTUCKY COFFEE WHISKEY
87355,CUTWATER TEQUILA BLANCO
922426,MIJENTA TEQUILA BLANCO
985631,CHICKEN COCK CHANTICLEER COGNAC FINISH BOURBON
102040,CROWN ROYAL DELUXE 1.75L W HOLIDAY BAG AND BOX
102092,CAPTAIN MORGAN OSR W/NFL TIN CUP
922442,PLOW POINT SMALL BATCH WHISKEY
34516,SOBIESKI VODKA PET
14467,REVEL STOKE BUTTERSQUATCH BUTTERSCOTCH MINI
Query:
-- 6. Calculate the percentage growth in sales from 2022 to 2023 for each item.
SELECT
  item_number,
  item_description,
  (SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2023 THEN sale_dollars ELSE 0 END) -
   SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2022 THEN sale_dollars ELSE 0 END)
  ) / SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2022 THEN sale_dollars ELSE NULL END) * 100 AS growth_percentage
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) IN (2022, 2023)
GROUP BY item_number, item_description
LIMIT 100
Answer:
item_number,item_description,growth_percentage
35318,BARTON VODKA,-2.8419766698417464
101641,CODY ROAD SIX SHOOTER VARIETY PACK MINIS,-20.079787234042552
101682,BACARDI FLAVORED RUM PARTY BUCKET,-100.0
101953,BACARDI FLAVORED RUM PARTY BUCKET,
26172,BIRD DOG PEACH MINI,-3.7291817523533672
36964,GREY GOOSE MINI,-4.330708661417323
37305,PERMA FROST SCHNAPPS MINI,-100.0
52591,E & J VS MINI,0.042294155853960874
68622,MIDNIGHT MOON CHOCOLATE BROWNIE MOONSHAKE MINI,
84230,99 BRAND MYSTERY FLAVOR PET MINI,-37.027027027027096
86691,JACK DANIELS TENNESSEE FIRE MINI,-19.205134534682795
89191,JOSE CUERVO ESPECIAL REPOSADO MINI,-12.344875275316296
14534,REVEL STOKE SMORGASM TOASTED SMORES WHISKEY MINI,-90.50966608084359
102095,BAILEYS MULTI PACK MINI,
26823,JACK DANIELS OLD #7 BLACK LABEL,3.6943027897639134
47861,D'USSE VSOP,-56.15956072351421
27615,WHITE DOG MASH #1,-3.731343283582089
37994,SMIRNOFF 80PRF,7.878410537346328
43334,CAPTAIN MORGAN ORIGINAL SPICED,8.2676019388192
68034,BAILEYS ORIGINAL IRISH CREAM,-4.900126189411791
87509,1800 SILVER,30.721472479686206
88354,TEREMANA BLANCO TEQUILA,52.25441490178816
48099,HENNESSY VS,-13.56534590752339
64722,CIROC PEACH,-21.341653666146644
925984,HA JACK DANIELS 12YR,
11586,BLACK VELVET RESERVE,-71.27276088363065
16580,BAKERS 7YR,257.8059071729958
18392,GARRISON BROTHERS SNGL BRL SAMPLER TEXAS STRAIGHT BOURBON,
19486,MAKERS 46,-0.8384831938697617
20366,OLD FORESTER BOURBON 86PRF,29.322957963580958
21480,BENCHMARK OLD NO 8,16.99873878725183
22156,WILD TURKEY 101,4.065880908138366
25113,LEADSLINGERS BOURBON WHISKEY 10YR,-69.83471074380165
27016,RITTENHOUSE RYE WHISKEY,8.779828905898244
27171,MINOR CASE STRAIGHT RYE,26.60377358490566
27181,JACK DANIELS TENNESSEE RYE,-58.75298411796107
2849,CRYSTAL HEAD W/ 2 SKULL GLASSES,-100.0
34116,ABSOLUT MANDRIN,5.78909868186669
37403,ABSOLUT WATERMELON,33.45454545454542
41943,360 GEORGIA PEACH,-14.082607067559906
43316,CAPTAIN MORGAN PRIVATE STOCK,-23.559148216762534
4381,BALVENIE 21YR PORTWOOD,-19.162173372044794
43869,KASAMA SMALL BATCH RUM 7YR,1743.6363636363637
48122,HENNESSY XO,-44.631260107297734
49156,REMY MARTIN XO EXCELLENCE,45.45669414887439
5006,GLENFIDDICH 12YR SPECIAL RESERVE,-7.370837150728569
Query:
-- 7. Get total sales and number of transactions per item in 2023.
SELECT
  item_number,
  item_description,
  SUM(sale_dollars) AS total_sales_2023,
  COUNT(*) AS transactions_2023
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) = 2023
GROUP BY item_number, item_description
LIMIT 100
Answer:
item_number,item_description,total_sales_2023,transactions_2023
35918,FIVE O'CLOCK VODKA,814809.7799999999,9511
41691,UV BLUE RASPBERRY MINI,58439.40000000001,1565
69940,RUMPLE MINZE PEPPERMINT SCHNAPPS LIQUEUR MINI,288967.5,3243
28039,JIM BEAM VANILLA MINI,48678.0,1071
38811,WHITE CLAW PINEAPPLE VODKA MINI,3812.52,101
38844,TRULY PINEAPPLE MANGO MINI,11048.850000000002,523
67522,KAHLUA COFFEE MINI,21235.500000000004,911
75208,KINKY PINK MINI,144459.47999999995,5077
75224,KINKY RED MINI,71438.40000000004,2325
81124,99 PEPPERMINT MINI,202470.65999999986,2733
84400,99 MANGOES MINI,34684.20000000003,590
86828,OLE SMOKY HUNCH PUNCH MOONSHINE MINI,48200.230000000025,1025
52579,E & J VSOP MINI,14384.00000000001,323
75231,KINKY PINK,2478.19,42
47863,D'USSE VSOP,421298.7200000001,1657
49084,REMY MARTIN 1738 ACCORD ROYAL,389527.1700000002,1570
56195,PAUL MASSON PEACH GRANDE AMBER BRANDY,68373.48000000004,1054
65254,JAGERMEISTER LIQUEUR,288092.16,2820
87402,JOSE CUERVO ESPECIAL SILVER,226502.00000000017,1302
89193,JOSE CUERVO ESPECIAL REPOSADO,405719.7999999998,2968
24866,ROSSVILLE UNION BARREL PROOF 7YR,8820.0,110
25039,JD TWICE BARRELED HERITAGE RYE,10125.0,180
101819,RABBIT HOLE 2PK W/CAVEHILL & HEIGOLD,12639.379999999994,63
15206,FARMSTOCK IOWA BATCH,32168.399999999994,171
17107,BUZZARDS ROOST CHAR #1 STRAIGHT BOURBON WHISKEY,4284.119999999998,38
19000,BP JEFFERSONS RESERVE BOURBON BARREL,22170.209999999992,262
20369,OLD FORESTER 1870 WHISKY ROW SERIES,34082.18999999999,294
21589,EH TAYLOR JR SINGLE BARREL,15054.000000000036,301
21946,WILD TURKEY KENTUCKY SPIRIT SINGLE BARREL,14127.75,209
25604,SEAGRAMS 7 CROWN,227708.25,4798
26585,GENTLEMAN JACK,65808.0,342
27605,TIN CUP,155186.25,1088
34197,CIROC 80PRF,38211.640000000014,418
37336,UV VODKA,48940.5,582
43126,BACARDI SUPERIOR,567726.8400000001,4616
49186,REMY MARTIN VSOP,513363.4699999999,1540
5067,GLENMORANGIE SIGNET,25459.770000000008,55
5346,JOHNNIE WALKER RED,319342.5,2626
Query:
-- 8. Find the top 100 items by total sales in 2023.
SELECT item_number, item_description, SUM(sale_dollars) AS total_sales_2023
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) = 2023
GROUP BY item_number, item_description
ORDER BY total_sales_2023 DESC
LIMIT 100
Answer:
item_number,item_description,total_sales_2023
38178,TITOS HANDMADE VODKA,11393245.5
38177,TITOS HANDMADE VODKA,10001010.240000002
11788,BLACK VELVET,8560030.74
1799,CAPTAIN MORGAN ORIGINAL SPICED BARREL,7061536.239999997
38176,TITOS HANDMADE VODKA,6565380.0
88296,PATRON SILVER,5252856.0
43337,CAPTAIN MORGAN ORIGINAL SPICED,5014554.57
65013,FIREBALL CINNAMON WHISKEY MINI SLEEVE,4394133.450000003
10807,CROWN ROYAL REGAL APPLE,3787875.199999998
10802,CROWN ROYAL PEACH,3705297.9199999976
11297,CROWN ROYAL,3506902.4900000016
64870,FIREBALL CINNAMON WHISKEY,3481509.3000000003
26827,JACK DANIELS OLD #7 BLACK LABEL,3470328.3799999994
26826,JACK DANIELS OLD #7 BLACK LABEL,3142294.539999998
15627,JAMESON,3038113.8000000007
11296,CROWN ROYAL,2934681.6000000006
26828,JACK DANIELS OLD #7 BLACK LABEL,2659707.9600000004
15626,JAMESON,2597208.9599999995
38008,SMIRNOFF 80PRF PET,2477608.41
64864,FIREBALL CINNAMON WHISKEY,2451872.0
11298,CROWN ROYAL,2415090.359999999
10808,CROWN ROYAL REGAL APPLE,2349334.6299999985
36308,HAWKEYE VODKA,2344074.93
48106,HENNESSY VS,2280671.86
48105,HENNESSY VS,2102410.240000002
17206,CEDAR RIDGE BOURBON,1933558.3100000003
42717,MALIBU COCONUT,1924516.23
43336,CAPTAIN MORGAN ORIGINAL SPICED,1903360.3199999994
34368,FRIS DANISH VODKA,1818087.1799999992
64865,FIREBALL CINNAMON WHISKEY PET,1789262.0700000005
19476,MAKERS MARK,1721601.0
64866,FIREBALL CINNAMON WHISKEY,1709734.5
38088,PLATINUM 7X VODKA,1705444.56
64867,FIREBALL CINNAMON WHISKEY,1655136.0
38174,TITOS HANDMADE VODKA,1651129.8300000015
87485,DON JULIO BLANCO,1625383.3800000008
64858,FIREBALL CINNAMON WHISKEY MINI DISPENSER,1568007.9000000008
69947,RUMPLE MINZE PEPPERMINT SCHNAPPS LIQUEUR,1560944.2499999995
64868,FIREBALL CINNAMON WHISKEY,1559764.0
36904,MCCORMICK 80PRF VODKA PET,1529576.7599999977
19066,JIM BEAM,1512192.0
64904,FIREBALL CINNAMON WHISKEY PET,1496656.0
34006,ABSOLUT SWEDISH VODKA 80PRF,1492659.2300000004
22215,WOODFORD RESERVE,1466267.25
42716,MALIBU COCONUT,1463273.7900000007
43028,ADMIRAL NELSON SPICED,1422665.6000000003
34821,SVEDKA 80PRF,1406316.5999999999
10805,CROWN ROYAL REGAL APPLE,1382035.2000000011
Query:
-- 9. List items with a significant increase in sales (more than 50%) from 2022 to 2023.
SELECT
  item_number,
  item_description,
  (SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2023 THEN sale_dollars ELSE 0 END) -
   SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2022 THEN sale_dollars ELSE 0 END)
  ) / SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2022 THEN sale_dollars ELSE NULL END) * 100 AS growth_percentage
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) IN (2022, 2023)
GROUP BY item_number, item_description
HAVING growth_percentage > 50
ORDER BY growth_percentage DESC
LIMIT 100
Answer:
item_number,item_description,growth_percentage
74782,JACK DANIELS WINTER JACK,82851.2924213117
84155,99 CHERRIES MINI,14440.909090909083
64319,THE BUTTERFLY CANNON ROSA FLAVORED TEQUILA,13139.999999999998
38073,STATE VODKA,5882.974358974359
65543,LICOR 43 CHOCOLATE,4146.742209631728
101515,FIREBALL CINNAMON WHISKEY KEG,3038.586956521739
76497,KRAKEN GOLD SPICED RUM,3021.5384615384614
916631,TUMBLIN DICE BOURBON SINGLE BARREL BARREL PROOF 6YR,2999.9999999999995
902419,EL TESORO PLATINUM,2800.0000000000005
16832,BLADE & BOW,2697.019867549669
76851,INFUSED TEQUILA JALAPENO LIME,2629.166666666669
915848,HA RED SPOT,2449.999999999999
994785,HA CRAGGANMORE DISTILLERS EDITION,2366.488888888889
902421,EL TESORO ANEJO,2300.0
18605,HIGH WEST BOURBON WHISKEY,2230.0
26143,HIGH WEST DOUBLE RYE WHISKEY,2142.8571428571427
965235,ITALICUS ROSOLINO,1943.752779012895
62811,ON THE ROCKS KNOB CREEK OLD FASHIONED,1770.4663212435232
43869,KASAMA SMALL BATCH RUM 7YR,1743.6363636363637
983349,ICE HOLE CHERRY SCHNAPPS,1705.478775913129
63237,HEUBLEIN DIRTY MARTINI,1674.6835443037974
84400,99 MANGOES MINI,1659.726027397262
942631,FLOR DE CANA 12YR CENTENARIO,1600.0000000000005
63233,HEUBLEIN MYERS MAI TAI,1576.0
982781,DEKUYPER BUTTERSHOTS MINI,1500.0
943676,SELVAREY WHITE RUM,1500.0
62813,ON THE ROCKS EFFEN COSMOPOLITAN,1474.404761904762
63235,HEUBLEIN MANHATTAN,1385.5172413793105
926219,BARRELL PRIVATE RELEASE WHISKEY,1383.3333333333335
39371,BLUE ICE AMERICAN HUCKLEBERRY VODKA,1370.6935975609754
62814,ON THE ROCKS HORNITOS MARGARITA,1358.433734939759
902933,EL TESORO REPOSADO,1300.0
903998,AUCHENTOSHAN 12YR,1300.0
915783,CLONAKILTY IRISH WHISKEY SINGLE BATCH / DOUBLE OAK,1299.9999999999998
902420,MT GAY EXTRA OLD RUM,1200.0000000000002
928666,MAGELLAN GIN,1200.0
86487,MR BOSTON TRIPLE SEC,1176.527331189709
900598,KNAPPOGUE CASTLE 16YR TWIN WOOD,1116.6315789473686
63231,HEUBLEIN OLD FASHIONED,1090.6976744186047
941702,UV ORANGE,950.0
65787,MARASKA NOCELINO,934.8375319459656
35358,BLUE ICE AMERICAN POTATO VODKA,929.5054200542006
906264,TAMDHU 15 YO SINGLE MALT SCOTCH,921.0114747131323
904803,VEEV ACAI,900.0
64854,DORDA DOUBLE CHOCOLATE LIQUEUR,868.8034188034187
987039,OLE SMOKY BOURBON BALL,838.3333333333333
Query:
-- 10. Compute total sales per item per month for 2023.
SELECT
  item_number,
  item_description,
  EXTRACT(MONTH FROM date) AS month,
  SUM(sale_dollars) AS monthly_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) = 2023
GROUP BY item_number, item_description, month
ORDER BY item_number, month
LIMIT 100
Answer:
item_number,item_description,month,monthly_sales
10006,SCORESBY RARE SCOTCH,1,1660.26
10006,SCORESBY RARE SCOTCH,2,1444.5200000000002
10006,SCORESBY RARE SCOTCH,3,1875.9999999999995
10006,SCORESBY RARE SCOTCH,4,1500.7999999999997
10006,SCORESBY RARE SCOTCH,5,1744.6800000000003
10006,SCORESBY RARE SCOTCH,6,1941.66
10006,SCORESBY RARE SCOTCH,7,1688.3999999999996
10006,SCORESBY RARE SCOTCH,8,1857.2399999999993
10006,SCORESBY RARE SCOTCH,9,2119.8799999999997
10006,SCORESBY RARE SCOTCH,10,1500.8
10006,SCORESBY RARE SCOTCH,11,1050.5599999999997
10006,SCORESBY RARE SCOTCH,12,1613.36
10008,SCORESBY RARE SCOTCH,1,13332.0
10008,SCORESBY RARE SCOTCH,2,13761.0
10008,SCORESBY RARE SCOTCH,3,14833.5
10008,SCORESBY RARE SCOTCH,4,12688.5
10008,SCORESBY RARE SCOTCH,5,15625.5
10008,SCORESBY RARE SCOTCH,6,14916.0
10008,SCORESBY RARE SCOTCH,7,13249.5
10008,SCORESBY RARE SCOTCH,8,16203.0
10008,SCORESBY RARE SCOTCH,9,13629.0
10008,SCORESBY RARE SCOTCH,10,12903.0
10008,SCORESBY RARE SCOTCH,11,14322.0
10008,SCORESBY RARE SCOTCH,12,14685.0
10009,SCORESBY RARE SCOTCH,1,1051.44
10009,SCORESBY RARE SCOTCH,2,1476.0599999999995
10009,SCORESBY RARE SCOTCH,3,1294.08
10009,SCORESBY RARE SCOTCH,4,1324.4099999999994
10009,SCORESBY RARE SCOTCH,5,1182.8700000000001
10009,SCORESBY RARE SCOTCH,6,1688.3699999999994
10009,SCORESBY RARE SCOTCH,7,1213.1999999999996
10009,SCORESBY RARE SCOTCH,8,1536.7199999999996
10009,SCORESBY RARE SCOTCH,9,1455.8400000000001
10009,SCORESBY RARE SCOTCH,10,1283.97
10009,SCORESBY RARE SCOTCH,11,1577.1599999999999
10009,SCORESBY RARE SCOTCH,12,889.6800000000002
100104,HERRADURA ULTRA ANEJO,1,8278.159999999998
100104,HERRADURA ULTRA ANEJO,2,9447.899999999998
100104,HERRADURA ULTRA ANEJO,3,4319.039999999999
100104,HERRADURA ULTRA ANEJO,4,3509.2200000000003
100104,HERRADURA ULTRA ANEJO,5,10797.6
100104,HERRADURA ULTRA ANEJO,6,9603.0
100104,HERRADURA ULTRA ANEJO,7,9405.0
100104,HERRADURA ULTRA ANEJO,8,10593.0
100104,HERRADURA ULTRA ANEJO,9,9702.0
End Exploring Related Columns
Task: What are the top 5 items with the highest year-over-year growth percentage in total sales revenue for the year 2023?

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
Item_Number,Item_Description,Year_Over_Year_Growth_Percentage
item_number1:str,item_description1:str,growth_percentage1:float >= 0
item_number2:str,item_description2:str,growth_percentage2:float >= 0
item_number3:str,item_description3:str,growth_percentage3:float >= 0
item_number4:str,item_description4:str,growth_percentage4:float >= 0
item_number5:str,item_description5:str,growth_percentage5:float >= 0
```

To identify the top 5 items with the highest year-over-year growth percentage in total sales revenue for 2023, we compare each item's total sales revenue in 2022 and 2023, calculate the growth percentage, and list the items in descending order of growth. The actual values require processing the sales data from the `sales` table..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'iowa_liquor_sales': ['sales']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-24 02:09:46 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 02:09:46 - root - INFO - ```sql
SELECT
  item_number AS Item_Number,
  item_description AS Item_Description,
  (
    (
      SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2023 THEN sale_dollars ELSE 0 END) - 
      SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2022 THEN sale_dollars ELSE 0 END)
    ) / SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2022 THEN sale_dollars ELSE NULL END)
  ) * 100 AS Year_Over_Year_Growth_Percentage
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) IN (2022, 2023)
GROUP BY Item_Number, Item_Description
HAVING SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2022 THEN sale_dollars ELSE 0 END) > 0
ORDER BY Year_Over_Year_Growth_Percentage DESC
LIMIT 5;
```
2025-01-24 02:09:48 - root - INFO - itercount: 1
2025-01-24 02:09:48 - root - INFO - 0
2025-01-24 02:09:48 - root - INFO - results: 
Item_Number,Item_Description,Year_Over_Year_Growth_Percentage
74782,JACK DANIELS WINTER JACK,82851.29242131172
84155,99 CHERRIES MINI,14440.90909090909
64319,THE BUTTERFLY CANNON ROSA FLAVORED TEQUILA,13139.999999999998
38073,STATE VODKA,5882.974358974359
65543,LICOR 43 CHOCOLATE,4146.742209631728


2025-01-24 02:09:48 - root - INFO - Please check the answer again by reviewing What are the top 5 items with the highest year-over-year growth percentage in total sales revenue for the year 2023?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Item_Number,Item_Description,Year_Over_Year_Growth_Percentage
item_number1:str,item_description1:str,growth_percentage1:float >= 0
item_number2:str,item_description2:str,growth_percentage2:float >= 0
item_number3:str,item_description3:str,growth_percentage3:float >= 0
item_number4:str,item_description4:str,growth_percentage4:float >= 0
item_number5:str,item_description5:str,growth_percentage5:float >= 0
```

To identify the top 5 items with the highest year-over-year growth percentage in total sales revenue for 2023, we compare each item's total sales revenue in 2022 and 2023, calculate the growth percentage, and list the items in descending order of growth. The actual values require processing the sales data from the `sales` table. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Item_Number,Item_Description,Year_Over_Year_Growth_Percentage
74782,JACK DANIELS WINTER JACK,82851.29242131172
84155,99 CHERRIES MINI,14440.90909090909
64319,THE BUTTERFLY CANNON ROSA FLAVORED TEQUILA,13139.999999999998
38073,STATE VODKA,5882.974358974359
65543,LICOR 43 CHOCOLATE,4146.742209631728
Current sql:
SELECT
  item_number AS Item_Number,
  item_description AS Item_Description,
  (
    (
      SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2023 THEN sale_dollars ELSE 0 END) - 
      SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2022 THEN sale_dollars ELSE 0 END)
    ) / SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2022 THEN sale_dollars ELSE NULL END)
  ) * 100 AS Year_Over_Year_Growth_Percentage
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) IN (2022, 2023)
GROUP BY Item_Number, Item_Description
HAVING SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2022 THEN sale_dollars ELSE 0 END) > 0
ORDER BY Year_Over_Year_Growth_Percentage DESC
LIMIT 5;
2025-01-24 02:10:18 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 02:10:18 - root - INFO - ```sql
SELECT
  item_number AS Item_Number,
  item_description AS Item_Description,
  (
    (
      SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2023 THEN sale_dollars ELSE 0 END) - 
      SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2022 THEN sale_dollars ELSE 0 END)
    ) / SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2022 THEN sale_dollars ELSE NULL END)
  ) * 100 AS Year_Over_Year_Growth_Percentage
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM date) IN (2022, 2023)
GROUP BY Item_Number, Item_Description
HAVING SUM(CASE WHEN EXTRACT(YEAR FROM date) = 2022 THEN sale_dollars ELSE 0 END) > 0
ORDER BY Year_Over_Year_Growth_Percentage DESC
LIMIT 5;
```
2025-01-24 02:10:19 - root - INFO - itercount: 2
2025-01-24 02:10:19 - root - INFO - 0
2025-01-24 02:10:19 - root - INFO - Total iteration counts: 2
