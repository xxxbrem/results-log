2025-01-24 02:08:19 - openai._base_client - INFO - Retrying request to /chat/completions in 0.433174 seconds
2025-01-24 02:08:57 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 02:08:59 - root - INFO - SQL:
SELECT `date`, `item_number`, `item_description`, `sale_dollars`
FROM `bigquery-public-data.iowa_liquor_sales.sales`
LIMIT 100;
Results:
date,item_number,item_description,sale_dollars
2023-12-08,64138,DISARONNO AMARETTO,-1374.3
2023-07-24,10777,CROWN ROYAL PEACH,-737.76
2024-05-30,43127,BACARDI SUPERIOR,-342.0
2023-08-07,86390,MONTEZUMA TRIPLE SEC,-76.8
2024-10-01,19486,MAKERS 46,-900.0
2023-02-09,36308,HAWKEYE VODKA,-135.0
2023-12-11,66932,SMIRNOFF RED WHITE AND MERRY,-297.12
2024-12-31,100104,HERRADURA ULTRA ANEJO,-891.0
2023-04-10,82627,DEKUYPER CHERRY PUCKER,-141.72
2023-05-23,82827,DEKUYPER RAGIN' ROOT BEER,-141.72
2023-06-28,86507,PARAMOUNT TRIPLE SEC,-73.68
2024-10-21,985987,BOLS TRIPLE SEC 30PRF,-72.0
2024-12-12,38088,PLATINUM 7X VODKA,-84.96
2023-11-16,58877,JOSE CUERVO GOLDEN STRAWBERRY MARGARITA,-99.36
2024-08-08,10805,CROWN ROYAL REGAL APPLE,-305.76
2024-02-27,11786,BLACK VELVET PET,-99.0
2023-06-26,26572,HORSE SOLDIER BARREL STRENGTH BOURBON WHISKEY,-810.0
2024-03-11,42714,MALIBU COCONUT,-197.76
2023-02-22,43024,ADMIRAL NELSON SPICED,-107.76
2023-03-08,48696,MARTELL VSSD,-395.88
2023-06-16,64136,DISARONNO AMARETTO,-284.76
2024-10-08,77637,SMIRNOFF CHERRY,-148.56
2024-10-25,87103,ASTRAL TEQUILA,-206.88
2023-10-23,26185,HOOTEN YOUNG AMERICAN WHISKEY 12YR,-338.22
2024-06-03,904916,SCORPION MEZCAL REPOSADO,-267.06
2023-11-16,69609,DR MCGILLICUDDYS APPLE PIE MINI,-360.0
2023-04-18,10628,CANADIAN CLUB WHISKY,-21.75
2023-11-08,14536,REVEL STOKE SMOREGASM TOASTED SMORES WHISKY,-28.5
2022-12-06,67296,YUKON JACK PERMA FROST,-27.76
2023-04-24,67296,YUKON JACK PERMA FROST,-27.76
2022-11-09,89533,FAMILIA CAMARENA REPOSADO,-40.5
2024-06-28,65013,FIREBALL CINNAMON WHISKEY MINI SLEEVE,-154.8
2023-07-14,11294,CROWN ROYAL,-38.22
2024-04-08,89887,TORADA GOLD,-10.98
2023-07-03,10802,CROWN ROYAL PEACH,-26.24
2023-12-14,16017,HEAVEN HILL BOTTLED-IN-BOND 7YR,-37.5
2024-10-08,22215,WOODFORD RESERVE,-36.08
2023-06-26,27060,MICHTERS US*1 KENTUCKY STRAIGHT SINGLE BARREL RYE,-36.75
2023-01-10,34433,GREY GOOSE,-22.5

2025-01-24 02:09:01 - root - INFO - SQL:
SELECT DISTINCT EXTRACT(YEAR FROM `date`) AS year
FROM `bigquery-public-data.iowa_liquor_sales.sales`
ORDER BY year
LIMIT 100;
Results:
year
2012
2013
2014
2015
2016
2017
2018
2019
2020
2021
2022
2023
2024

2025-01-24 02:09:03 - root - INFO - SQL:
SELECT EXTRACT(YEAR FROM `date`) AS year, SUM(`sale_dollars`) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
GROUP BY year
ORDER BY year
LIMIT 100;
Results:
year,total_sales
2012,255203313.5700007
2013,258103792.81999946
2014,270587738.0900023
2015,284328572.1100055
2016,299447564.8500055
2017,314530044.81000364
2018,334216843.0700035
2019,349220341.6300043
2020,396663131.6600008
2021,428123535.40000564
2022,428780003.49000204
2023,446070662.519995
2024,447235413.61999565

2025-01-24 02:09:05 - root - INFO - SQL:
SELECT `item_number`, `item_description`, SUM(`sale_dollars`) AS total_sales_2023
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
GROUP BY `item_number`, `item_description`
ORDER BY total_sales_2023 DESC
LIMIT 100;
Results:
item_number,item_description,total_sales_2023
38178,TITOS HANDMADE VODKA,11393245.5
38177,TITOS HANDMADE VODKA,10001010.240000002
11788,BLACK VELVET,8560030.74
1799,CAPTAIN MORGAN ORIGINAL SPICED BARREL,7061536.2399999965
38176,TITOS HANDMADE VODKA,6565380.0
88296,PATRON SILVER,5252856.0
43337,CAPTAIN MORGAN ORIGINAL SPICED,5014554.57
65013,FIREBALL CINNAMON WHISKEY MINI SLEEVE,4394133.450000002
10807,CROWN ROYAL REGAL APPLE,3787875.199999996
10802,CROWN ROYAL PEACH,3705297.919999997
11297,CROWN ROYAL,3506902.489999999
64870,FIREBALL CINNAMON WHISKEY,3481509.300000001
26827,JACK DANIELS OLD #7 BLACK LABEL,3470328.3800000004
26826,JACK DANIELS OLD #7 BLACK LABEL,3142294.5399999996
15627,JAMESON,3038113.8000000003
11296,CROWN ROYAL,2934681.5999999987
26828,JACK DANIELS OLD #7 BLACK LABEL,2659707.960000001
15626,JAMESON,2597208.9599999995
38008,SMIRNOFF 80PRF PET,2477608.41
64864,FIREBALL CINNAMON WHISKEY,2451872.0
11298,CROWN ROYAL,2415090.3599999994
10808,CROWN ROYAL REGAL APPLE,2349334.63
36308,HAWKEYE VODKA,2344074.93
48106,HENNESSY VS,2280671.86
48105,HENNESSY VS,2102410.2400000007
17206,CEDAR RIDGE BOURBON,1933558.3099999998
42717,MALIBU COCONUT,1924516.2300000004
43336,CAPTAIN MORGAN ORIGINAL SPICED,1903360.3200000005
34368,FRIS DANISH VODKA,1818087.1799999988
64865,FIREBALL CINNAMON WHISKEY PET,1789262.0700000005
19476,MAKERS MARK,1721601.0
64866,FIREBALL CINNAMON WHISKEY,1709734.5
38088,PLATINUM 7X VODKA,1705444.5599999994
64867,FIREBALL CINNAMON WHISKEY,1655136.0
38174,TITOS HANDMADE VODKA,1651129.8300000026
87485,DON JULIO BLANCO,1625383.3800000001
64858,FIREBALL CINNAMON WHISKEY MINI DISPENSER,1568007.9000000001
69947,RUMPLE MINZE PEPPERMINT SCHNAPPS LIQUEUR,1560944.2500000005
64868,FIREBALL CINNAMON WHISKEY,1559764.0
36904,MCCORMICK 80PRF VODKA PET,1529576.7599999972
19066,JIM BEAM,1512192.0
64904,FIREBALL CINNAMON WHISKEY PET,1496656.0
34006,ABSOLUT SWEDISH VODKA 80PRF,1492659.2300000004
22215,WOODFORD RESERVE,1466267.25
42716,MALIBU COCONUT,1463273.790000001
43028,ADMIRAL NELSON SPICED,1422665.6000000003
34821,SVEDKA 80PRF,1406316.5999999999
10805,CROWN ROYAL REGAL APPLE,1382035.2000000011

2025-01-24 02:09:06 - root - INFO - SQL:
SELECT `item_number`, `item_description`, SUM(`sale_dollars`) AS total_sales_2022
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2022
GROUP BY `item_number`, `item_description`
ORDER BY total_sales_2022 DESC
LIMIT 100;
Results:
item_number,item_description,total_sales_2022
38178,TITOS HANDMADE VODKA,10659997.5
38177,TITOS HANDMADE VODKA,9032344.649999997
11788,BLACK VELVET,8276139.200000001
38176,TITOS HANDMADE VODKA,5853930.0
88296,PATRON SILVER,5324760.0
10802,CROWN ROYAL PEACH,5298659.219999998
43337,CAPTAIN MORGAN ORIGINAL SPICED,4888821.760000001
10807,CROWN ROYAL REGAL APPLE,4844648.659999996
1799,CAPTAIN MORGAN ORIGINAL SPICED BARREL,4228686.0
11296,CROWN ROYAL,3820673.9
11297,CROWN ROYAL,3667743.3900000006
65013,FIREBALL CINNAMON WHISKEY MINI SLEEVE,3590669.8500000024
26827,JACK DANIELS OLD #7 BLACK LABEL,3468126.329999999
64870,FIREBALL CINNAMON WHISKEY,2927321.099999999
26826,JACK DANIELS OLD #7 BLACK LABEL,2870444.0500000007
26828,JACK DANIELS OLD #7 BLACK LABEL,2860557.179999999
48106,HENNESSY VS,2857427.519999998
15626,JAMESON,2827872.9299999997
15627,JAMESON,2772618.33
11298,CROWN ROYAL,2620041.529999997
43338,CAPTAIN MORGAN ORIGINAL SPICED,2602557.0
64864,FIREBALL CINNAMON WHISKEY,2543960.0
36308,HAWKEYE VODKA,2296345.400000004
48105,HENNESSY VS,2196215.56
10808,CROWN ROYAL REGAL APPLE,2190215.4799999995
64866,FIREBALL CINNAMON WHISKEY,1973484.0
17206,CEDAR RIDGE BOURBON,1923020.5599999998
64867,FIREBALL CINNAMON WHISKEY,1857777.2099999997
43336,CAPTAIN MORGAN ORIGINAL SPICED,1798147.2599999988
64868,FIREBALL CINNAMON WHISKEY,1755820.0
64865,FIREBALL CINNAMON WHISKEY PET,1751908.2000000007
42716,MALIBU COCONUT,1662090.51
22215,WOODFORD RESERVE,1632339.6600000008
38008,SMIRNOFF 80PRF PET,1601061.24
38088,PLATINUM 7X VODKA,1592801.7600000002
42717,MALIBU COCONUT,1579528.1000000006
19476,MAKERS MARK,1567026.0
34006,ABSOLUT SWEDISH VODKA 80PRF,1517647.560000001
64858,FIREBALL CINNAMON WHISKEY MINI DISPENSER,1499663.6999999986
87485,DON JULIO BLANCO,1496291.8399999996
34368,FRIS DANISH VODKA,1489000.2399999998
69947,RUMPLE MINZE PEPPERMINT SCHNAPPS LIQUEUR,1472388.2800000007
65257,JAGERMEISTER LIQUEUR,1467116.04
10809,CROWN ROYAL REGAL APPLE,1441188.6199999996
25608,SEAGRAMS 7 CROWN,1436643.300000001
43028,ADMIRAL NELSON SPICED,1402516.8999999985
68036,BAILEYS ORIGINAL IRISH CREAM,1401817.8800000008
64904,FIREBALL CINNAMON WHISKEY PET,1386417.0

2025-01-24 02:09:08 - root - INFO - SQL:
SELECT DISTINCT `item_number`, `item_description`
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
LIMIT 100;
Results:
item_number,item_description
101641,CODY ROAD SIX SHOOTER VARIETY PACK MINIS
101953,BACARDI FLAVORED RUM PARTY BUCKET
26172,BIRD DOG PEACH MINI
36964,GREY GOOSE MINI
52591,E & J VS MINI
68622,MIDNIGHT MOON CHOCOLATE BROWNIE MOONSHAKE MINI
84230,99 BRAND MYSTERY FLAVOR PET MINI
86691,JACK DANIELS TENNESSEE FIRE MINI
89191,JOSE CUERVO ESPECIAL REPOSADO MINI
102095,BAILEYS MULTI PACK MINI
47861,D'USSE VSOP
88354,TEREMANA BLANCO TEQUILA
26823,JACK DANIELS OLD #7 BLACK LABEL
48099,HENNESSY VS
64722,CIROC PEACH
925984,HA JACK DANIELS 12YR
16580,BAKERS 7YR
18392,GARRISON BROTHERS SNGL BRL SAMPLER TEXAS STRAIGHT BOURBON
20366,OLD FORESTER BOURBON 86PRF
21480,BENCHMARK OLD NO 8
22156,WILD TURKEY 101
25113,LEADSLINGERS BOURBON WHISKEY 10YR
37403,ABSOLUT WATERMELON
37994,SMIRNOFF 80PRF
41943,360 GEORGIA PEACH
43316,CAPTAIN MORGAN PRIVATE STOCK
43334,CAPTAIN MORGAN ORIGINAL SPICED
4381,BALVENIE 21YR PORTWOOD
43869,KASAMA SMALL BATCH RUM 7YR
5006,GLENFIDDICH 12YR SPECIAL RESERVE
5106,GRANTS BLENDED SCOTCH
68034,BAILEYS ORIGINAL IRISH CREAM
73749,EVAN WILLIAMS APPLE
75210,KINKY PINK
76445,OAK & EDEN RYE & RUMBA
80023,BUFFALO TRACE BOURBON CREAM
87509,1800 SILVER
89566,MONTE ALBAN MEZCAL
89796,SAUZA CONMEMORATIVO
902207,HA OLD RIP VAN WINKLE 10YR (PAPPY)
903803,HA THOMAS HANDY RYE 2023
919487,HA MAKERS MARK CELLAR AGED
921686,HA 2XO TRIBUTE BLEND
989215,SOOH JINRO CHAMISUL GRAPEFRUIT SOJU
34007,ABSOLUT SWEDISH VODKA 80PRF
37701,BLUE OX VODKA
87050,SKREWBALL PEANUT BUTTER WHISKEY
63205,HEUBLEIN CORAZON MARGARITA
10789,CROWN ROYAL VANILLA
11586,BLACK VELVET RESERVE
14501,REVEL STOKE SMOKESCREEN SMOKED VANILLA
26714,CM OBTAINIUM LIGHT WHISKEY
27016,RITTENHOUSE RYE WHISKEY
27171,MINOR CASE STRAIGHT RYE
37061,BROKEN SHED VODKA
39203,WESTERN SON STRAWBERRY VODKA
48122,HENNESSY XO
53645,CEDAR RIDGE FRUIT BRANDY
64497,CANADIAN CLUB APPLE
66226,PIMMS CUP NO 1
66932,SMIRNOFF RED WHITE AND MERRY
76493,173 CRAFT DISTILLERY BARREL & KANE
87172,CALIROSA ROSA BLANCO
89242,CORRALEJO REPOSADO
37998,SMIRNOFF 80PRF
42718,MALIBU COCONUT
45248,PARAMOUNT GOLD RUM
52597,E & J VS SQUARE
49508,BADEL STARA SLJIVOVICA PREMIUM SELECTION
19486,MAKERS 46
21215,REBEL KSBW 100PRF

2025-01-24 02:09:10 - root - INFO - SQL:
SELECT `item_number`, `item_description`, EXTRACT(MONTH FROM `date`) AS month, SUM(`sale_dollars`) AS monthly_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
GROUP BY `item_number`, `item_description`, month
ORDER BY `item_number`, month
LIMIT 100;
Results:
item_number,item_description,month,monthly_sales
10006,SCORESBY RARE SCOTCH,1,1660.2599999999998
10006,SCORESBY RARE SCOTCH,2,1444.52
10006,SCORESBY RARE SCOTCH,3,1876.0
10006,SCORESBY RARE SCOTCH,4,1500.8
10006,SCORESBY RARE SCOTCH,5,1744.6799999999998
10006,SCORESBY RARE SCOTCH,6,1941.66
10006,SCORESBY RARE SCOTCH,7,1688.4
10006,SCORESBY RARE SCOTCH,8,1857.2399999999996
10006,SCORESBY RARE SCOTCH,9,2119.8799999999997
10006,SCORESBY RARE SCOTCH,10,1500.8
10006,SCORESBY RARE SCOTCH,11,1050.5599999999997
10006,SCORESBY RARE SCOTCH,12,1613.36
10008,SCORESBY RARE SCOTCH,1,13332.0
10008,SCORESBY RARE SCOTCH,2,13761.0
10008,SCORESBY RARE SCOTCH,3,14833.5
10008,SCORESBY RARE SCOTCH,4,12688.5
10008,SCORESBY RARE SCOTCH,5,15625.5
10008,SCORESBY RARE SCOTCH,6,14916.0
10008,SCORESBY RARE SCOTCH,7,13249.5
10008,SCORESBY RARE SCOTCH,8,16203.0
10008,SCORESBY RARE SCOTCH,9,13629.0
10008,SCORESBY RARE SCOTCH,10,12903.0
10008,SCORESBY RARE SCOTCH,11,14322.0
10008,SCORESBY RARE SCOTCH,12,14685.0
10009,SCORESBY RARE SCOTCH,1,1051.44
10009,SCORESBY RARE SCOTCH,2,1476.0599999999995
10009,SCORESBY RARE SCOTCH,3,1294.08
10009,SCORESBY RARE SCOTCH,4,1324.41
10009,SCORESBY RARE SCOTCH,5,1182.87
10009,SCORESBY RARE SCOTCH,6,1688.3699999999997
10009,SCORESBY RARE SCOTCH,7,1213.2000000000003
10009,SCORESBY RARE SCOTCH,8,1536.7199999999998
10009,SCORESBY RARE SCOTCH,9,1455.8399999999995
10009,SCORESBY RARE SCOTCH,10,1283.97
10009,SCORESBY RARE SCOTCH,11,1577.1599999999999
10009,SCORESBY RARE SCOTCH,12,889.6800000000001
100104,HERRADURA ULTRA ANEJO,1,8278.159999999996
100104,HERRADURA ULTRA ANEJO,2,9447.899999999996
100104,HERRADURA ULTRA ANEJO,3,4319.04
100104,HERRADURA ULTRA ANEJO,4,3509.2200000000003
100104,HERRADURA ULTRA ANEJO,5,10797.6
100104,HERRADURA ULTRA ANEJO,6,9603.0
100104,HERRADURA ULTRA ANEJO,7,9405.0
100104,HERRADURA ULTRA ANEJO,8,10593.0
100104,HERRADURA ULTRA ANEJO,9,9702.0
100104,HERRADURA ULTRA ANEJO,10,12226.5

2025-01-24 02:09:12 - root - INFO - SQL:
SELECT `item_number`, `item_description`, EXTRACT(YEAR FROM `date`) AS year, SUM(`sale_dollars`) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) IN (2022, 2023)
GROUP BY `item_number`, `item_description`, year
ORDER BY `item_number`, year
LIMIT 100;
Results:
item_number,item_description,year,total_sales
100015,FIREBALL CINNAMON WHISKEY BAG IN BOX,2022,31275.0
100015,FIREBALL CINNAMON WHISKEY BAG IN BOX 1,2022,630.0
10006,SCORESBY RARE SCOTCH,2022,22967.279999999995
10006,SCORESBY RARE SCOTCH,2023,19998.160000000014
100077,KRAKEN RUM W/ TIKI GLASS,2022,13030.08
10008,SCORESBY RARE SCOTCH,2022,187142.25
10008,SCORESBY RARE SCOTCH,2023,170148.0
10009,SCORESBY RARE SCOTCH,2022,16226.55
10009,SCORESBY RARE SCOTCH,2023,15973.799999999992
100104,HERRADURA ULTRA ANEJO,2022,78327.58999999998
100104,HERRADURA ULTRA ANEJO,2023,120996.92000000013
100148,JACK DANIELS SINGLE BARREL W/SNIFTER GLASS,2023,22443.75
100215,TEQUILA ROSE LIQUEUR W/2 SHOT GLASSES,2022,24142.5
100215,TEQUILA ROSE LIQUEUR W/2 SHOT GLASSES,2023,23925.0
100216,TARANTULA AZUL HOLIDAY W/2 SHOT GLASSES,2022,256.31
100220,TWISTED SHOTZ TRADITIONAL PARTY PACK 3.0,2022,45006.580000000016
100220,TWISTED SHOTZ TRADITIONAL PARTY PACK 3.0,2023,41121.92000000008
100248,MARTELL BLUE SWIFT W/ 2 GLASSES,2022,7301.039999999997
100280,THE BITTER TRUTH COCKTAIL BAR PACK,2022,128.25
100306,PATRON EXTRA ANEJO,2022,44197.229999999996
100306,PATRON EXTRA ANEJO,2023,27068.159999999993
100413,FIREBALL CINNAMON WHISKEY PARTY BUCKET,2022,1198384.1999999997
100413,FIREBALL CINNAMON WHISKEY PARTY BUCKET,2023,1192192.2000000004
100423,FIREBALL CINNAMON WHISKEY 100ML CARRIER,2022,607671.0
100423,FIREBALL CINNAMON WHISKEY 100ML CARRIER,2023,932589.0
100429,WRITERS TEARS COPPER POT VAP W/ FLASK,2022,3695.1000000000017
100429,WRITERS TEARS COPPER POT VAP W/ FLASK,2023,711.9
100433,SUNTORY TOKI W/HIGHBALL GLASS,2022,14296.459999999995
100433,SUNTORY TOKI W/HIGHBALL GLASS,2023,787.25
100443,REDBREAST TRI PACK MINI,2023,13487.99999999998
100490,ABSOLUT MINI BAR,2023,14687.720000000007
100509,HYPNOTIQ W/ ROCK GLASSES,2022,4768.5
100533,BACARDI OCHO GIFT TUBE,2022,4365.0
100533,BACARDI OCHO GIFT TUBE,2023,2250.0
100535,FIREBALL GIFT BOX,2022,39938.400000000045
100535,FIREBALL GIFT BOX,2023,34830.000000000015
100568,BOURBON TIME,2022,3762.0
100572,JOHNNIE WALKER 200ML COLLECTION PACK,2022,27656.25
100572,JOHNNIE WALKER 200ML COLLECTION PACK,2023,10706.88
100605,JAMESON W/GINGER ALE,2022,5651.099999999998
100605,JAMESON W/GINGER ALE,2023,2608.1999999999994
100618,CRYSTAL HEAD VODKA W/4 SKULL GLASSES,2023,8106.559999999997

2025-01-24 02:09:14 - root - INFO - SQL:
SELECT DISTINCT `item_number`, `item_description`
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2022

INTERSECT DISTINCT

SELECT DISTINCT `item_number`, `item_description`
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
LIMIT 100;
Results:
item_number,item_description
27780,JIM BEAM APPLE MINI
27793,DR. APPLE WHISKEY MINI
89623,PATRON REPOSADO MINI
52312,CHRISTIAN BROS BRANDY
19064,JIM BEAM
77201,SODA JERK ROOT BEER SHOT MINI
77902,SMIRNOFF PEPPERMINT TWIST MINI
10550,BLACK VELVET TOASTED CARAMEL
16850,BLANTONS BOURBON
17092,BULLEIT BOURBON BARREL STRENGTH
18412,GEORGE REMUS STRAIGHT BOURBON
20536,KENTUCKY TAVERN BOURBON
5157,GLENFIDDICH 18YR
5446,LAPHROAIG 10YR
87408,JOSE CUERVO ESPECIAL SILVER
89644,PATRON ANEJO
1258,GLENMORANGIE TASTER PACK
21596,TEN HIGH
28043,JIM BEAM VANILLA
41019,360 DOUBLE CHOCOLATE
45886,SAILOR JERRY SPICED NAVY RUM
58836,JOSE CUERVO AUTHENTIC LIME MARGARITA
77786,TUACA PERFECT CHILL
79336,PARAMOUNT CREME DE MENTHE GREEN
84201,99 PINEAPPLE
86559,SHEEP DOG PEANUT BUTTER
88036,MARGARITAVILLE SILVER TEQUILA
33937,PEARL CUCUMBER
80687,DEKUYPER BLUSTERY PEPPERMINT BURST
26503,WHEEL HORSE RYE
27433,BIRD DOG PEACH
43076,ADMIRAL NELSON COCONUT
22400,SAZERAC RYE
41670,BURNETTS BLUE RASPBERRY
43128,BACARDI SUPERIOR
2446,TOOTERS RAINBOW PACK
80486,TIPPY COW ORANGE CREAM
87906,AMOR REPOSADO
86390,MONTEZUMA TRIPLE SEC
35435,SVEDKA 80PRF PET
15258,WINDSOR CANADIAN BLACK CHERRY
54448,PARAMOUNT APRICOT BRANDY
55088,PARAMOUNT BLACKBERRY BRANDY
10624,CANADIAN CLUB WHISKY
86610,BEACH BONFIRE CINNAMON WHISKEY
87121,CAMPOVASO BLANCO TEQUILA
902256,SOOH MELLOW CORN WHISKEY
87270,CASA NOBLE REPOSADO
15622,JAMESON
87769,CAMPO BRAVO PLATA TEQUILA MINI
90038,XICALA REPOSADO MEXCAL
65792,MARTELL BLUE SWIFT
6339,TULLIBARDINE 12 YEAR OLD SINGLE MALT SCOTCH
20305,OLD ELK SOUR MASH BOURBON
902243,SOOH BENEDICTINE LIQUEUR DOM
15770,THE IRISHMAN HARVEST IRISH WHISKEY
900367,SOOH JACK DANIELS SINGLE BARREL BARREL PROOF
47646,BRANSON VS PHANTOM
48696,MARTELL VSSD
976365,99 XXPRESSO MINI
951036,SOOH ASBACH URALT BRANDY 3YR
965803,MATHILDE LIQUER CASSIS BLACK CURRANT
925213,THE CLOVER BARREL STRENGTH STRAIGHT BOURBON BUY THE BARREL
26780,WOODY CREEK DISTILLERS COLORADO STRAIGHT RYE
972958,CHACHO - JALAPENO AGUARDIENTE
988426,CANCION BLANCO TEQUILA
985558,KOVAL DRY GIN
905690,HA OBAN DISTILLERS EDITION
911020,LOT 40
906315,TOMATIN SCOTCH WHISKY 14 YR
987281,CASAMIGOS BLANCO MINI

2025-01-24 02:09:16 - root - INFO - SQL:
SELECT
  `item_number`,
  `item_description`,
  SUM(IF(EXTRACT(YEAR FROM `date`) = 2023, `sale_dollars`, 0)) AS sales_2023,
  SUM(IF(EXTRACT(YEAR FROM `date`) = 2022, `sale_dollars`, 0)) AS sales_2022,
  SAFE_DIVIDE(
    SUM(IF(EXTRACT(YEAR FROM `date`) = 2023, `sale_dollars`, 0)) - SUM(IF(EXTRACT(YEAR FROM `date`) = 2022, `sale_dollars`, 0)),
    SUM(IF(EXTRACT(YEAR FROM `date`) = 2022, `sale_dollars`, 0))
  ) * 100 AS growth_percentage
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) IN (2022, 2023)
GROUP BY `item_number`, `item_description`
ORDER BY growth_percentage DESC
LIMIT 100;
Results:
item_number,item_description,sales_2023,sales_2022,growth_percentage
74782,JACK DANIELS WINTER JACK,141523.1999999999,170.61,82851.2924213117
84155,99 CHERRIES MINI,86373.0,594.0,14440.90909090909
64319,THE BUTTERFLY CANNON ROSA FLAVORED TEQUILA,7626.239999999998,57.6,13139.999999999995
38073,STATE VODKA,5833.400000000001,97.5,5882.974358974359
65543,LICOR 43 CHOCOLATE,326054.25,7677.75,4146.742209631728
101515,FIREBALL CINNAMON WHISKEY KEG,69300.0,2208.0,3038.586956521739
76497,KRAKEN GOLD SPICED RUM,33478.5,1072.5,3021.5384615384614
916631,TUMBLIN DICE BOURBON SINGLE BARREL BARREL PROOF 6YR,9318.6,300.6,2999.9999999999995
902419,EL TESORO PLATINUM,7306.259999999998,251.94,2799.9999999999995
16832,BLADE & BOW,316762.5,11325.0,2697.019867549669
76851,INFUSED TEQUILA JALAPENO LIME,17233.050000000003,631.44,2629.166666666667
915848,HA RED SPOT,10703.879999999997,419.76,2449.999999999999
994785,HA CRAGGANMORE DISTILLERS EDITION,1664.88,67.5,2366.488888888889
902421,EL TESORO ANEJO,8640.0,360.0,2300.0
18605,HIGH WEST BOURBON WHISKEY,12232.5,525.0,2230.0
26143,HIGH WEST DOUBLE RYE WHISKEY,8242.5,367.5,2142.8571428571427
965235,ITALICUS ROSOLINO,8273.519999999999,404.82,1943.7527790128943
62811,ON THE ROCKS KNOB CREEK OLD FASHIONED,67687.5,3618.75,1770.4663212435232
43869,KASAMA SMALL BATCH RUM 7YR,24843.0,1347.5,1743.6363636363637
983349,ICE HOLE CHERRY SCHNAPPS,4389.48,243.12,1705.478775913129
63237,HEUBLEIN DIRTY MARTINI,13669.5,770.25,1674.6835443037974
84400,99 MANGOES MINI,34684.200000000026,1971.0,1659.7260273972615
942631,FLOR DE CANA 12YR CENTENARIO,3016.1400000000003,177.42,1600.0000000000005
63233,HEUBLEIN MYERS MAI TAI,16341.0,975.0,1576.0
943676,SELVAREY WHITE RUM,2736.0,171.0,1500.0
982781,DEKUYPER BUTTERSHOTS MINI,1440.0,90.0,1500.0
62813,ON THE ROCKS EFFEN COSMOPOLITAN,49593.75,3150.0,1474.404761904762
63235,HEUBLEIN MANHATTAN,21001.5,1413.75,1385.5172413793105
926219,BARRELL PRIVATE RELEASE WHISKEY,15131.78,1020.12,1383.3333333333335
39371,BLUE ICE AMERICAN HUCKLEBERRY VODKA,4630.919999999999,314.88,1370.6935975609754
62814,ON THE ROCKS HORNITOS MARGARITA,45393.75,3112.5,1358.433734939759
903998,AUCHENTOSHAN 12YR,3969.0,283.5,1300.0

2025-01-24 02:09:16 - root - INFO - itercount: 0
2025-01-24 02:09:16 - root - INFO - Database Name: bigquery-public-data
Schema Name: iowa_liquor_sales
DDL describes table information.
,0
table_name,sales
ddl,"CREATE TABLE `bigquery-public-data.iowa_liquor_sales.sales`
(
  invoice_and_item_number STRING OPTIONS(description=""Concatenated invoice and line number associated with the liquor order. This provides a unique identifier for the individual liquor products included in the store order.""),
  date DATE OPTIONS(description=""Date of order""),
  store_number STRING OPTIONS(description=""Unique number assigned to the store who ordered the liquor.""),
  store_name STRING OPTIONS(description=""Name of store who ordered the liquor.""),
  address STRING OPTIONS(description=""Address of store who ordered the liquor.""),
  city STRING OPTIONS(description=""City where the store who ordered the liquor is located""),
  zip_code STRING OPTIONS(description=""Zip code where the store who ordered the liquor is located""),
  store_location GEOGRAPHY OPTIONS(description=""Location of store who ordered the liquor. The Address, City, State and Zip Code are geocoded to provide geographic coordinates. Accuracy of geocoding is dependent on how well the address is interpreted and the completeness of the reference data used.""),
  county_number STRING OPTIONS(description=""Iowa county number for the county where store who ordered the liquor is located""),
  county STRING OPTIONS(description=""County where the store who ordered the liquor is located""),
  category STRING OPTIONS(description=""Category code associated with the liquor ordered""),
  category_name STRING OPTIONS(description=""Category of the liquor ordered.""),
  vendor_number STRING OPTIONS(description=""The vendor number of the company for the brand of liquor ordered""),
  vendor_name STRING OPTIONS(description=""The vendor name of the company for the brand of liquor ordered""),
  item_number STRING OPTIONS(description=""Item number for the individual liquor product ordered.""),
  item_description STRING OPTIONS(description=""Description of the individual liquor product ordered.""),
  pack INT64 OPTIONS(description=""The number of bottles in a case for the liquor ordered""),
  bottle_volume_ml INT64 OPTIONS(description=""Volume of each liquor bottle ordered in milliliters.""),
  state_bottle_cost FLOAT64 OPTIONS(description=""The amount that Alcoholic Beverages Division paid for each bottle of liquor ordered""),
  state_bottle_retail FLOAT64 OPTIONS(description=""The amount the store paid for each bottle of liquor ordered""),
  bottles_sold INT64 OPTIONS(description=""The number of bottles of liquor ordered by the store""),
  sale_dollars FLOAT64 OPTIONS(description=""Total cost of liquor order (number of bottles multiplied by the state bottle retail)""),
  volume_sold_liters FLOAT64 OPTIONS(description=""Total volume of liquor ordered in liters. (i.e. (Bottle Volume (ml) x Bottles Sold)/1,000)\""""),
  volume_sold_gallons FLOAT64 OPTIONS(description=""Total volume of liquor ordered in gallons. (i.e. (Bottle Volume (ml) x Bottles Sold)/3785.411784)\"""")
)
OPTIONS(
  description=""Sales Dataset""
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'iowa_liquor_sales': ['sales']}}
Begin Exploring Related Columns
**Columns and their potential usage:**

- `date`: Used to extract the year of each sale for filtering and grouping by year.
- `item_number`: Unique identifier for each liquor item; used to group sales data by item.
- `item_description`: Description of each liquor item; useful for displaying item names.
- `sale_dollars`: Total cost of liquor order; used to calculate total sales revenue.
- `bottles_sold`: Number of bottles sold; can be used to analyze sales volume.
- **Conditions that may be used:**
  - `EXTRACT(YEAR FROM date) = 2023` to filter sales data for the year 2023.
  - `EXTRACT(YEAR FROM date) = 2022` to filter sales data for the year 2022.
  - Grouping by `item_number` and year to compare sales between years.

---

**SQL Queries:**

1. **Sample sales data:**
```sql
SELECT `date`, `item_number`, `item_description`, `sale_dollars`
FROM `bigquery-public-data.iowa_liquor_sales.sales`
LIMIT 100;
```

2. **Distinct years available in the data:**
```sql
SELECT DISTINCT EXTRACT(YEAR FROM `date`) AS year
FROM `bigquery-public-data.iowa_liquor_sales.sales`
ORDER BY year
LIMIT 100;
```

3. **Total sales revenue per year:**
```sql
SELECT EXTRACT(YEAR FROM `date`) AS year, SUM(`sale_dollars`) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
GROUP BY year
ORDER BY year
LIMIT 100;
```

4. **Top 100 items by total sales revenue in 2023:**
```sql
SELECT `item_number`, `item_description`, SUM(`sale_dollars`) AS total_sales_2023
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
GROUP BY `item_number`, `item_description`
ORDER BY total_sales_2023 DESC
LIMIT 100;
```

5. **Top 100 items by total sales revenue in 2022:**
```sql
SELECT `item_number`, `item_description`, SUM(`sale_dollars`) AS total_sales_2022
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2022
GROUP BY `item_number`, `item_description`
ORDER BY total_sales_2022 DESC
LIMIT 100;
```

6. **List of unique items sold in 2023:**
```sql
SELECT DISTINCT `item_number`, `item_description`
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
LIMIT 100;
```

7. **Monthly sales revenue per item in 2023:**
```sql
SELECT `item_number`, `item_description`, EXTRACT(MONTH FROM `date`) AS month, SUM(`sale_dollars`) AS monthly_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
GROUP BY `item_number`, `item_description`, month
ORDER BY `item_number`, month
LIMIT 100;
```

8. **Total sales revenue per item for 2022 and 2023:**
```sql
SELECT `item_number`, `item_description`, EXTRACT(YEAR FROM `date`) AS year, SUM(`sale_dollars`) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) IN (2022, 2023)
GROUP BY `item_number`, `item_description`, year
ORDER BY `item_number`, year
LIMIT 100;
```

9. **Items sold in both 2022 and 2023:**
```sql
SELECT DISTINCT `item_number`, `item_description`
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2022

INTERSECT DISTINCT

SELECT DISTINCT `item_number`, `item_description`
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
LIMIT 100;
```

10. **Calculate year-over-year growth percentage in sales revenue per item:**
```sql
SELECT
  `item_number`,
  `item_description`,
  SUM(IF(EXTRACT(YEAR FROM `date`) = 2023, `sale_dollars`, 0)) AS sales_2023,
  SUM(IF(EXTRACT(YEAR FROM `date`) = 2022, `sale_dollars`, 0)) AS sales_2022,
  SAFE_DIVIDE(
    SUM(IF(EXTRACT(YEAR FROM `date`) = 2023, `sale_dollars`, 0)) - SUM(IF(EXTRACT(YEAR FROM `date`) = 2022, `sale_dollars`, 0)),
    SUM(IF(EXTRACT(YEAR FROM `date`) = 2022, `sale_dollars`, 0))
  ) * 100 AS growth_percentage
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) IN (2022, 2023)
GROUP BY `item_number`, `item_description`
ORDER BY growth_percentage DESC
LIMIT 100;
```

In these queries, we explore the sales data to understand the values in the relevant columns and how they relate to the task. The final query calculates the year-over-year growth percentage in total sales revenue for each item between 2022 and 2023, which is essential for identifying the top 5 items with the highest growth in 2023.Query:
SELECT `date`, `item_number`, `item_description`, `sale_dollars`
FROM `bigquery-public-data.iowa_liquor_sales.sales`
LIMIT 100;
Answer:
date,item_number,item_description,sale_dollars
2023-12-08,64138,DISARONNO AMARETTO,-1374.3
2023-07-24,10777,CROWN ROYAL PEACH,-737.76
2024-05-30,43127,BACARDI SUPERIOR,-342.0
2023-08-07,86390,MONTEZUMA TRIPLE SEC,-76.8
2024-10-01,19486,MAKERS 46,-900.0
2023-02-09,36308,HAWKEYE VODKA,-135.0
2023-12-11,66932,SMIRNOFF RED WHITE AND MERRY,-297.12
2024-12-31,100104,HERRADURA ULTRA ANEJO,-891.0
2023-04-10,82627,DEKUYPER CHERRY PUCKER,-141.72
2023-05-23,82827,DEKUYPER RAGIN' ROOT BEER,-141.72
2023-06-28,86507,PARAMOUNT TRIPLE SEC,-73.68
2024-10-21,985987,BOLS TRIPLE SEC 30PRF,-72.0
2024-12-12,38088,PLATINUM 7X VODKA,-84.96
2023-11-16,58877,JOSE CUERVO GOLDEN STRAWBERRY MARGARITA,-99.36
2024-08-08,10805,CROWN ROYAL REGAL APPLE,-305.76
2024-02-27,11786,BLACK VELVET PET,-99.0
2023-06-26,26572,HORSE SOLDIER BARREL STRENGTH BOURBON WHISKEY,-810.0
2024-03-11,42714,MALIBU COCONUT,-197.76
2023-02-22,43024,ADMIRAL NELSON SPICED,-107.76
2023-03-08,48696,MARTELL VSSD,-395.88
2023-06-16,64136,DISARONNO AMARETTO,-284.76
2024-10-08,77637,SMIRNOFF CHERRY,-148.56
2024-10-25,87103,ASTRAL TEQUILA,-206.88
2023-10-23,26185,HOOTEN YOUNG AMERICAN WHISKEY 12YR,-338.22
2024-06-03,904916,SCORPION MEZCAL REPOSADO,-267.06
2023-11-16,69609,DR MCGILLICUDDYS APPLE PIE MINI,-360.0
2023-04-18,10628,CANADIAN CLUB WHISKY,-21.75
2023-11-08,14536,REVEL STOKE SMOREGASM TOASTED SMORES WHISKY,-28.5
2022-12-06,67296,YUKON JACK PERMA FROST,-27.76
2023-04-24,67296,YUKON JACK PERMA FROST,-27.76
2022-11-09,89533,FAMILIA CAMARENA REPOSADO,-40.5
2024-06-28,65013,FIREBALL CINNAMON WHISKEY MINI SLEEVE,-154.8
2023-07-14,11294,CROWN ROYAL,-38.22
2024-04-08,89887,TORADA GOLD,-10.98
2023-07-03,10802,CROWN ROYAL PEACH,-26.24
2023-12-14,16017,HEAVEN HILL BOTTLED-IN-BOND 7YR,-37.5
2024-10-08,22215,WOODFORD RESERVE,-36.08
2023-06-26,27060,MICHTERS US*1 KENTUCKY STRAIGHT SINGLE BARREL RYE,-36.75
2023-01-10,34433,GREY GOOSE,-22.5
Query:
SELECT DISTINCT EXTRACT(YEAR FROM `date`) AS year
FROM `bigquery-public-data.iowa_liquor_sales.sales`
ORDER BY year
LIMIT 100;
Answer:
year
2012
2013
2014
2015
2016
2017
2018
2019
2020
2021
2022
2023
2024
Query:
SELECT EXTRACT(YEAR FROM `date`) AS year, SUM(`sale_dollars`) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
GROUP BY year
ORDER BY year
LIMIT 100;
Answer:
year,total_sales
2012,255203313.5700007
2013,258103792.81999946
2014,270587738.0900023
2015,284328572.1100055
2016,299447564.8500055
2017,314530044.81000364
2018,334216843.0700035
2019,349220341.6300043
2020,396663131.6600008
2021,428123535.40000564
2022,428780003.49000204
2023,446070662.519995
2024,447235413.61999565
Query:
SELECT `item_number`, `item_description`, SUM(`sale_dollars`) AS total_sales_2023
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
GROUP BY `item_number`, `item_description`
ORDER BY total_sales_2023 DESC
LIMIT 100;
Answer:
item_number,item_description,total_sales_2023
38178,TITOS HANDMADE VODKA,11393245.5
38177,TITOS HANDMADE VODKA,10001010.240000002
11788,BLACK VELVET,8560030.74
1799,CAPTAIN MORGAN ORIGINAL SPICED BARREL,7061536.2399999965
38176,TITOS HANDMADE VODKA,6565380.0
88296,PATRON SILVER,5252856.0
43337,CAPTAIN MORGAN ORIGINAL SPICED,5014554.57
65013,FIREBALL CINNAMON WHISKEY MINI SLEEVE,4394133.450000002
10807,CROWN ROYAL REGAL APPLE,3787875.199999996
10802,CROWN ROYAL PEACH,3705297.919999997
11297,CROWN ROYAL,3506902.489999999
64870,FIREBALL CINNAMON WHISKEY,3481509.300000001
26827,JACK DANIELS OLD #7 BLACK LABEL,3470328.3800000004
26826,JACK DANIELS OLD #7 BLACK LABEL,3142294.5399999996
15627,JAMESON,3038113.8000000003
11296,CROWN ROYAL,2934681.5999999987
26828,JACK DANIELS OLD #7 BLACK LABEL,2659707.960000001
15626,JAMESON,2597208.9599999995
38008,SMIRNOFF 80PRF PET,2477608.41
64864,FIREBALL CINNAMON WHISKEY,2451872.0
11298,CROWN ROYAL,2415090.3599999994
10808,CROWN ROYAL REGAL APPLE,2349334.63
36308,HAWKEYE VODKA,2344074.93
48106,HENNESSY VS,2280671.86
48105,HENNESSY VS,2102410.2400000007
17206,CEDAR RIDGE BOURBON,1933558.3099999998
42717,MALIBU COCONUT,1924516.2300000004
43336,CAPTAIN MORGAN ORIGINAL SPICED,1903360.3200000005
34368,FRIS DANISH VODKA,1818087.1799999988
64865,FIREBALL CINNAMON WHISKEY PET,1789262.0700000005
19476,MAKERS MARK,1721601.0
64866,FIREBALL CINNAMON WHISKEY,1709734.5
38088,PLATINUM 7X VODKA,1705444.5599999994
64867,FIREBALL CINNAMON WHISKEY,1655136.0
38174,TITOS HANDMADE VODKA,1651129.8300000026
87485,DON JULIO BLANCO,1625383.3800000001
64858,FIREBALL CINNAMON WHISKEY MINI DISPENSER,1568007.9000000001
69947,RUMPLE MINZE PEPPERMINT SCHNAPPS LIQUEUR,1560944.2500000005
64868,FIREBALL CINNAMON WHISKEY,1559764.0
36904,MCCORMICK 80PRF VODKA PET,1529576.7599999972
19066,JIM BEAM,1512192.0
64904,FIREBALL CINNAMON WHISKEY PET,1496656.0
34006,ABSOLUT SWEDISH VODKA 80PRF,1492659.2300000004
22215,WOODFORD RESERVE,1466267.25
42716,MALIBU COCONUT,1463273.790000001
43028,ADMIRAL NELSON SPICED,1422665.6000000003
34821,SVEDKA 80PRF,1406316.5999999999
10805,CROWN ROYAL REGAL APPLE,1382035.2000000011
Query:
SELECT `item_number`, `item_description`, SUM(`sale_dollars`) AS total_sales_2022
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2022
GROUP BY `item_number`, `item_description`
ORDER BY total_sales_2022 DESC
LIMIT 100;
Answer:
item_number,item_description,total_sales_2022
38178,TITOS HANDMADE VODKA,10659997.5
38177,TITOS HANDMADE VODKA,9032344.649999997
11788,BLACK VELVET,8276139.200000001
38176,TITOS HANDMADE VODKA,5853930.0
88296,PATRON SILVER,5324760.0
10802,CROWN ROYAL PEACH,5298659.219999998
43337,CAPTAIN MORGAN ORIGINAL SPICED,4888821.760000001
10807,CROWN ROYAL REGAL APPLE,4844648.659999996
1799,CAPTAIN MORGAN ORIGINAL SPICED BARREL,4228686.0
11296,CROWN ROYAL,3820673.9
11297,CROWN ROYAL,3667743.3900000006
65013,FIREBALL CINNAMON WHISKEY MINI SLEEVE,3590669.8500000024
26827,JACK DANIELS OLD #7 BLACK LABEL,3468126.329999999
64870,FIREBALL CINNAMON WHISKEY,2927321.099999999
26826,JACK DANIELS OLD #7 BLACK LABEL,2870444.0500000007
26828,JACK DANIELS OLD #7 BLACK LABEL,2860557.179999999
48106,HENNESSY VS,2857427.519999998
15626,JAMESON,2827872.9299999997
15627,JAMESON,2772618.33
11298,CROWN ROYAL,2620041.529999997
43338,CAPTAIN MORGAN ORIGINAL SPICED,2602557.0
64864,FIREBALL CINNAMON WHISKEY,2543960.0
36308,HAWKEYE VODKA,2296345.400000004
48105,HENNESSY VS,2196215.56
10808,CROWN ROYAL REGAL APPLE,2190215.4799999995
64866,FIREBALL CINNAMON WHISKEY,1973484.0
17206,CEDAR RIDGE BOURBON,1923020.5599999998
64867,FIREBALL CINNAMON WHISKEY,1857777.2099999997
43336,CAPTAIN MORGAN ORIGINAL SPICED,1798147.2599999988
64868,FIREBALL CINNAMON WHISKEY,1755820.0
64865,FIREBALL CINNAMON WHISKEY PET,1751908.2000000007
42716,MALIBU COCONUT,1662090.51
22215,WOODFORD RESERVE,1632339.6600000008
38008,SMIRNOFF 80PRF PET,1601061.24
38088,PLATINUM 7X VODKA,1592801.7600000002
42717,MALIBU COCONUT,1579528.1000000006
19476,MAKERS MARK,1567026.0
34006,ABSOLUT SWEDISH VODKA 80PRF,1517647.560000001
64858,FIREBALL CINNAMON WHISKEY MINI DISPENSER,1499663.6999999986
87485,DON JULIO BLANCO,1496291.8399999996
34368,FRIS DANISH VODKA,1489000.2399999998
69947,RUMPLE MINZE PEPPERMINT SCHNAPPS LIQUEUR,1472388.2800000007
65257,JAGERMEISTER LIQUEUR,1467116.04
10809,CROWN ROYAL REGAL APPLE,1441188.6199999996
25608,SEAGRAMS 7 CROWN,1436643.300000001
43028,ADMIRAL NELSON SPICED,1402516.8999999985
68036,BAILEYS ORIGINAL IRISH CREAM,1401817.8800000008
64904,FIREBALL CINNAMON WHISKEY PET,1386417.0
Query:
SELECT DISTINCT `item_number`, `item_description`
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
LIMIT 100;
Answer:
item_number,item_description
101641,CODY ROAD SIX SHOOTER VARIETY PACK MINIS
101953,BACARDI FLAVORED RUM PARTY BUCKET
26172,BIRD DOG PEACH MINI
36964,GREY GOOSE MINI
52591,E & J VS MINI
68622,MIDNIGHT MOON CHOCOLATE BROWNIE MOONSHAKE MINI
84230,99 BRAND MYSTERY FLAVOR PET MINI
86691,JACK DANIELS TENNESSEE FIRE MINI
89191,JOSE CUERVO ESPECIAL REPOSADO MINI
102095,BAILEYS MULTI PACK MINI
47861,D'USSE VSOP
88354,TEREMANA BLANCO TEQUILA
26823,JACK DANIELS OLD #7 BLACK LABEL
48099,HENNESSY VS
64722,CIROC PEACH
925984,HA JACK DANIELS 12YR
16580,BAKERS 7YR
18392,GARRISON BROTHERS SNGL BRL SAMPLER TEXAS STRAIGHT BOURBON
20366,OLD FORESTER BOURBON 86PRF
21480,BENCHMARK OLD NO 8
22156,WILD TURKEY 101
25113,LEADSLINGERS BOURBON WHISKEY 10YR
37403,ABSOLUT WATERMELON
37994,SMIRNOFF 80PRF
41943,360 GEORGIA PEACH
43316,CAPTAIN MORGAN PRIVATE STOCK
43334,CAPTAIN MORGAN ORIGINAL SPICED
4381,BALVENIE 21YR PORTWOOD
43869,KASAMA SMALL BATCH RUM 7YR
5006,GLENFIDDICH 12YR SPECIAL RESERVE
5106,GRANTS BLENDED SCOTCH
68034,BAILEYS ORIGINAL IRISH CREAM
73749,EVAN WILLIAMS APPLE
75210,KINKY PINK
76445,OAK & EDEN RYE & RUMBA
80023,BUFFALO TRACE BOURBON CREAM
87509,1800 SILVER
89566,MONTE ALBAN MEZCAL
89796,SAUZA CONMEMORATIVO
902207,HA OLD RIP VAN WINKLE 10YR (PAPPY)
903803,HA THOMAS HANDY RYE 2023
919487,HA MAKERS MARK CELLAR AGED
921686,HA 2XO TRIBUTE BLEND
989215,SOOH JINRO CHAMISUL GRAPEFRUIT SOJU
34007,ABSOLUT SWEDISH VODKA 80PRF
37701,BLUE OX VODKA
87050,SKREWBALL PEANUT BUTTER WHISKEY
63205,HEUBLEIN CORAZON MARGARITA
10789,CROWN ROYAL VANILLA
11586,BLACK VELVET RESERVE
14501,REVEL STOKE SMOKESCREEN SMOKED VANILLA
26714,CM OBTAINIUM LIGHT WHISKEY
27016,RITTENHOUSE RYE WHISKEY
27171,MINOR CASE STRAIGHT RYE
37061,BROKEN SHED VODKA
39203,WESTERN SON STRAWBERRY VODKA
48122,HENNESSY XO
53645,CEDAR RIDGE FRUIT BRANDY
64497,CANADIAN CLUB APPLE
66226,PIMMS CUP NO 1
66932,SMIRNOFF RED WHITE AND MERRY
76493,173 CRAFT DISTILLERY BARREL & KANE
87172,CALIROSA ROSA BLANCO
89242,CORRALEJO REPOSADO
37998,SMIRNOFF 80PRF
42718,MALIBU COCONUT
45248,PARAMOUNT GOLD RUM
52597,E & J VS SQUARE
49508,BADEL STARA SLJIVOVICA PREMIUM SELECTION
19486,MAKERS 46
21215,REBEL KSBW 100PRF
Query:
SELECT `item_number`, `item_description`, EXTRACT(MONTH FROM `date`) AS month, SUM(`sale_dollars`) AS monthly_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
GROUP BY `item_number`, `item_description`, month
ORDER BY `item_number`, month
LIMIT 100;
Answer:
item_number,item_description,month,monthly_sales
10006,SCORESBY RARE SCOTCH,1,1660.2599999999998
10006,SCORESBY RARE SCOTCH,2,1444.52
10006,SCORESBY RARE SCOTCH,3,1876.0
10006,SCORESBY RARE SCOTCH,4,1500.8
10006,SCORESBY RARE SCOTCH,5,1744.6799999999998
10006,SCORESBY RARE SCOTCH,6,1941.66
10006,SCORESBY RARE SCOTCH,7,1688.4
10006,SCORESBY RARE SCOTCH,8,1857.2399999999996
10006,SCORESBY RARE SCOTCH,9,2119.8799999999997
10006,SCORESBY RARE SCOTCH,10,1500.8
10006,SCORESBY RARE SCOTCH,11,1050.5599999999997
10006,SCORESBY RARE SCOTCH,12,1613.36
10008,SCORESBY RARE SCOTCH,1,13332.0
10008,SCORESBY RARE SCOTCH,2,13761.0
10008,SCORESBY RARE SCOTCH,3,14833.5
10008,SCORESBY RARE SCOTCH,4,12688.5
10008,SCORESBY RARE SCOTCH,5,15625.5
10008,SCORESBY RARE SCOTCH,6,14916.0
10008,SCORESBY RARE SCOTCH,7,13249.5
10008,SCORESBY RARE SCOTCH,8,16203.0
10008,SCORESBY RARE SCOTCH,9,13629.0
10008,SCORESBY RARE SCOTCH,10,12903.0
10008,SCORESBY RARE SCOTCH,11,14322.0
10008,SCORESBY RARE SCOTCH,12,14685.0
10009,SCORESBY RARE SCOTCH,1,1051.44
10009,SCORESBY RARE SCOTCH,2,1476.0599999999995
10009,SCORESBY RARE SCOTCH,3,1294.08
10009,SCORESBY RARE SCOTCH,4,1324.41
10009,SCORESBY RARE SCOTCH,5,1182.87
10009,SCORESBY RARE SCOTCH,6,1688.3699999999997
10009,SCORESBY RARE SCOTCH,7,1213.2000000000003
10009,SCORESBY RARE SCOTCH,8,1536.7199999999998
10009,SCORESBY RARE SCOTCH,9,1455.8399999999995
10009,SCORESBY RARE SCOTCH,10,1283.97
10009,SCORESBY RARE SCOTCH,11,1577.1599999999999
10009,SCORESBY RARE SCOTCH,12,889.6800000000001
100104,HERRADURA ULTRA ANEJO,1,8278.159999999996
100104,HERRADURA ULTRA ANEJO,2,9447.899999999996
100104,HERRADURA ULTRA ANEJO,3,4319.04
100104,HERRADURA ULTRA ANEJO,4,3509.2200000000003
100104,HERRADURA ULTRA ANEJO,5,10797.6
100104,HERRADURA ULTRA ANEJO,6,9603.0
100104,HERRADURA ULTRA ANEJO,7,9405.0
100104,HERRADURA ULTRA ANEJO,8,10593.0
100104,HERRADURA ULTRA ANEJO,9,9702.0
100104,HERRADURA ULTRA ANEJO,10,12226.5
Query:
SELECT `item_number`, `item_description`, EXTRACT(YEAR FROM `date`) AS year, SUM(`sale_dollars`) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) IN (2022, 2023)
GROUP BY `item_number`, `item_description`, year
ORDER BY `item_number`, year
LIMIT 100;
Answer:
item_number,item_description,year,total_sales
100015,FIREBALL CINNAMON WHISKEY BAG IN BOX,2022,31275.0
100015,FIREBALL CINNAMON WHISKEY BAG IN BOX 1,2022,630.0
10006,SCORESBY RARE SCOTCH,2022,22967.279999999995
10006,SCORESBY RARE SCOTCH,2023,19998.160000000014
100077,KRAKEN RUM W/ TIKI GLASS,2022,13030.08
10008,SCORESBY RARE SCOTCH,2022,187142.25
10008,SCORESBY RARE SCOTCH,2023,170148.0
10009,SCORESBY RARE SCOTCH,2022,16226.55
10009,SCORESBY RARE SCOTCH,2023,15973.799999999992
100104,HERRADURA ULTRA ANEJO,2022,78327.58999999998
100104,HERRADURA ULTRA ANEJO,2023,120996.92000000013
100148,JACK DANIELS SINGLE BARREL W/SNIFTER GLASS,2023,22443.75
100215,TEQUILA ROSE LIQUEUR W/2 SHOT GLASSES,2022,24142.5
100215,TEQUILA ROSE LIQUEUR W/2 SHOT GLASSES,2023,23925.0
100216,TARANTULA AZUL HOLIDAY W/2 SHOT GLASSES,2022,256.31
100220,TWISTED SHOTZ TRADITIONAL PARTY PACK 3.0,2022,45006.580000000016
100220,TWISTED SHOTZ TRADITIONAL PARTY PACK 3.0,2023,41121.92000000008
100248,MARTELL BLUE SWIFT W/ 2 GLASSES,2022,7301.039999999997
100280,THE BITTER TRUTH COCKTAIL BAR PACK,2022,128.25
100306,PATRON EXTRA ANEJO,2022,44197.229999999996
100306,PATRON EXTRA ANEJO,2023,27068.159999999993
100413,FIREBALL CINNAMON WHISKEY PARTY BUCKET,2022,1198384.1999999997
100413,FIREBALL CINNAMON WHISKEY PARTY BUCKET,2023,1192192.2000000004
100423,FIREBALL CINNAMON WHISKEY 100ML CARRIER,2022,607671.0
100423,FIREBALL CINNAMON WHISKEY 100ML CARRIER,2023,932589.0
100429,WRITERS TEARS COPPER POT VAP W/ FLASK,2022,3695.1000000000017
100429,WRITERS TEARS COPPER POT VAP W/ FLASK,2023,711.9
100433,SUNTORY TOKI W/HIGHBALL GLASS,2022,14296.459999999995
100433,SUNTORY TOKI W/HIGHBALL GLASS,2023,787.25
100443,REDBREAST TRI PACK MINI,2023,13487.99999999998
100490,ABSOLUT MINI BAR,2023,14687.720000000007
100509,HYPNOTIQ W/ ROCK GLASSES,2022,4768.5
100533,BACARDI OCHO GIFT TUBE,2022,4365.0
100533,BACARDI OCHO GIFT TUBE,2023,2250.0
100535,FIREBALL GIFT BOX,2022,39938.400000000045
100535,FIREBALL GIFT BOX,2023,34830.000000000015
100568,BOURBON TIME,2022,3762.0
100572,JOHNNIE WALKER 200ML COLLECTION PACK,2022,27656.25
100572,JOHNNIE WALKER 200ML COLLECTION PACK,2023,10706.88
100605,JAMESON W/GINGER ALE,2022,5651.099999999998
100605,JAMESON W/GINGER ALE,2023,2608.1999999999994
100618,CRYSTAL HEAD VODKA W/4 SKULL GLASSES,2023,8106.559999999997
Query:
SELECT DISTINCT `item_number`, `item_description`
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2022

INTERSECT DISTINCT

SELECT DISTINCT `item_number`, `item_description`
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
LIMIT 100;
Answer:
item_number,item_description
27780,JIM BEAM APPLE MINI
27793,DR. APPLE WHISKEY MINI
89623,PATRON REPOSADO MINI
52312,CHRISTIAN BROS BRANDY
19064,JIM BEAM
77201,SODA JERK ROOT BEER SHOT MINI
77902,SMIRNOFF PEPPERMINT TWIST MINI
10550,BLACK VELVET TOASTED CARAMEL
16850,BLANTONS BOURBON
17092,BULLEIT BOURBON BARREL STRENGTH
18412,GEORGE REMUS STRAIGHT BOURBON
20536,KENTUCKY TAVERN BOURBON
5157,GLENFIDDICH 18YR
5446,LAPHROAIG 10YR
87408,JOSE CUERVO ESPECIAL SILVER
89644,PATRON ANEJO
1258,GLENMORANGIE TASTER PACK
21596,TEN HIGH
28043,JIM BEAM VANILLA
41019,360 DOUBLE CHOCOLATE
45886,SAILOR JERRY SPICED NAVY RUM
58836,JOSE CUERVO AUTHENTIC LIME MARGARITA
77786,TUACA PERFECT CHILL
79336,PARAMOUNT CREME DE MENTHE GREEN
84201,99 PINEAPPLE
86559,SHEEP DOG PEANUT BUTTER
88036,MARGARITAVILLE SILVER TEQUILA
33937,PEARL CUCUMBER
80687,DEKUYPER BLUSTERY PEPPERMINT BURST
26503,WHEEL HORSE RYE
27433,BIRD DOG PEACH
43076,ADMIRAL NELSON COCONUT
22400,SAZERAC RYE
41670,BURNETTS BLUE RASPBERRY
43128,BACARDI SUPERIOR
2446,TOOTERS RAINBOW PACK
80486,TIPPY COW ORANGE CREAM
87906,AMOR REPOSADO
86390,MONTEZUMA TRIPLE SEC
35435,SVEDKA 80PRF PET
15258,WINDSOR CANADIAN BLACK CHERRY
54448,PARAMOUNT APRICOT BRANDY
55088,PARAMOUNT BLACKBERRY BRANDY
10624,CANADIAN CLUB WHISKY
86610,BEACH BONFIRE CINNAMON WHISKEY
87121,CAMPOVASO BLANCO TEQUILA
902256,SOOH MELLOW CORN WHISKEY
87270,CASA NOBLE REPOSADO
15622,JAMESON
87769,CAMPO BRAVO PLATA TEQUILA MINI
90038,XICALA REPOSADO MEXCAL
65792,MARTELL BLUE SWIFT
6339,TULLIBARDINE 12 YEAR OLD SINGLE MALT SCOTCH
20305,OLD ELK SOUR MASH BOURBON
902243,SOOH BENEDICTINE LIQUEUR DOM
15770,THE IRISHMAN HARVEST IRISH WHISKEY
900367,SOOH JACK DANIELS SINGLE BARREL BARREL PROOF
47646,BRANSON VS PHANTOM
48696,MARTELL VSSD
976365,99 XXPRESSO MINI
951036,SOOH ASBACH URALT BRANDY 3YR
965803,MATHILDE LIQUER CASSIS BLACK CURRANT
925213,THE CLOVER BARREL STRENGTH STRAIGHT BOURBON BUY THE BARREL
26780,WOODY CREEK DISTILLERS COLORADO STRAIGHT RYE
972958,CHACHO - JALAPENO AGUARDIENTE
988426,CANCION BLANCO TEQUILA
985558,KOVAL DRY GIN
905690,HA OBAN DISTILLERS EDITION
911020,LOT 40
906315,TOMATIN SCOTCH WHISKY 14 YR
987281,CASAMIGOS BLANCO MINI
Query:
SELECT
  `item_number`,
  `item_description`,
  SUM(IF(EXTRACT(YEAR FROM `date`) = 2023, `sale_dollars`, 0)) AS sales_2023,
  SUM(IF(EXTRACT(YEAR FROM `date`) = 2022, `sale_dollars`, 0)) AS sales_2022,
  SAFE_DIVIDE(
    SUM(IF(EXTRACT(YEAR FROM `date`) = 2023, `sale_dollars`, 0)) - SUM(IF(EXTRACT(YEAR FROM `date`) = 2022, `sale_dollars`, 0)),
    SUM(IF(EXTRACT(YEAR FROM `date`) = 2022, `sale_dollars`, 0))
  ) * 100 AS growth_percentage
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) IN (2022, 2023)
GROUP BY `item_number`, `item_description`
ORDER BY growth_percentage DESC
LIMIT 100;
Answer:
item_number,item_description,sales_2023,sales_2022,growth_percentage
74782,JACK DANIELS WINTER JACK,141523.1999999999,170.61,82851.2924213117
84155,99 CHERRIES MINI,86373.0,594.0,14440.90909090909
64319,THE BUTTERFLY CANNON ROSA FLAVORED TEQUILA,7626.239999999998,57.6,13139.999999999995
38073,STATE VODKA,5833.400000000001,97.5,5882.974358974359
65543,LICOR 43 CHOCOLATE,326054.25,7677.75,4146.742209631728
101515,FIREBALL CINNAMON WHISKEY KEG,69300.0,2208.0,3038.586956521739
76497,KRAKEN GOLD SPICED RUM,33478.5,1072.5,3021.5384615384614
916631,TUMBLIN DICE BOURBON SINGLE BARREL BARREL PROOF 6YR,9318.6,300.6,2999.9999999999995
902419,EL TESORO PLATINUM,7306.259999999998,251.94,2799.9999999999995
16832,BLADE & BOW,316762.5,11325.0,2697.019867549669
76851,INFUSED TEQUILA JALAPENO LIME,17233.050000000003,631.44,2629.166666666667
915848,HA RED SPOT,10703.879999999997,419.76,2449.999999999999
994785,HA CRAGGANMORE DISTILLERS EDITION,1664.88,67.5,2366.488888888889
902421,EL TESORO ANEJO,8640.0,360.0,2300.0
18605,HIGH WEST BOURBON WHISKEY,12232.5,525.0,2230.0
26143,HIGH WEST DOUBLE RYE WHISKEY,8242.5,367.5,2142.8571428571427
965235,ITALICUS ROSOLINO,8273.519999999999,404.82,1943.7527790128943
62811,ON THE ROCKS KNOB CREEK OLD FASHIONED,67687.5,3618.75,1770.4663212435232
43869,KASAMA SMALL BATCH RUM 7YR,24843.0,1347.5,1743.6363636363637
983349,ICE HOLE CHERRY SCHNAPPS,4389.48,243.12,1705.478775913129
63237,HEUBLEIN DIRTY MARTINI,13669.5,770.25,1674.6835443037974
84400,99 MANGOES MINI,34684.200000000026,1971.0,1659.7260273972615
942631,FLOR DE CANA 12YR CENTENARIO,3016.1400000000003,177.42,1600.0000000000005
63233,HEUBLEIN MYERS MAI TAI,16341.0,975.0,1576.0
943676,SELVAREY WHITE RUM,2736.0,171.0,1500.0
982781,DEKUYPER BUTTERSHOTS MINI,1440.0,90.0,1500.0
62813,ON THE ROCKS EFFEN COSMOPOLITAN,49593.75,3150.0,1474.404761904762
63235,HEUBLEIN MANHATTAN,21001.5,1413.75,1385.5172413793105
926219,BARRELL PRIVATE RELEASE WHISKEY,15131.78,1020.12,1383.3333333333335
39371,BLUE ICE AMERICAN HUCKLEBERRY VODKA,4630.919999999999,314.88,1370.6935975609754
62814,ON THE ROCKS HORNITOS MARGARITA,45393.75,3112.5,1358.433734939759
903998,AUCHENTOSHAN 12YR,3969.0,283.5,1300.0
End Exploring Related Columns
Task: What are the top 5 items with the highest year-over-year growth percentage in total sales revenue for the year 2023?

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
Item_Number,Item_Description,Year_Over_Year_Growth_Percentage
item_number1:str,item_description1:str,growth_percentage1:float >= 0
item_number2:str,item_description2:str,growth_percentage2:float >= 0
item_number3:str,item_description3:str,growth_percentage3:float >= 0
item_number4:str,item_description4:str,growth_percentage4:float >= 0
item_number5:str,item_description5:str,growth_percentage5:float >= 0
```

To identify the top 5 items with the highest year-over-year growth percentage in total sales revenue for 2023, we compare each item's total sales revenue in 2022 and 2023, calculate the growth percentage, and list the items in descending order of growth. The actual values require processing the sales data from the `sales` table..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'iowa_liquor_sales': ['sales']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-24 02:09:42 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 02:09:42 - root - INFO - ```sql
SELECT
  `item_number` AS Item_Number,
  `item_description` AS Item_Description,
  SAFE_DIVIDE(
    SUM(IF(EXTRACT(YEAR FROM `date`) = 2023, `sale_dollars`, 0)) - SUM(IF(EXTRACT(YEAR FROM `date`) = 2022, `sale_dollars`, 0)),
    SUM(IF(EXTRACT(YEAR FROM `date`) = 2022, `sale_dollars`, NULL))
  ) * 100 AS Year_Over_Year_Growth_Percentage
FROM `bigquery-public-data`.`iowa_liquor_sales`.`sales`
WHERE EXTRACT(YEAR FROM `date`) IN (2022, 2023)
GROUP BY `item_number`, `item_description`
HAVING SUM(IF(EXTRACT(YEAR FROM `date`) = 2022, `sale_dollars`, 0)) > 0
ORDER BY Year_Over_Year_Growth_Percentage DESC, `item_number`
LIMIT 5;
```
2025-01-24 02:09:44 - root - INFO - itercount: 1
2025-01-24 02:09:44 - root - INFO - 0
2025-01-24 02:09:44 - root - INFO - results: 
Item_Number,Item_Description,Year_Over_Year_Growth_Percentage
74782,JACK DANIELS WINTER JACK,82851.29242131175
84155,99 CHERRIES MINI,14440.909090909085
64319,THE BUTTERFLY CANNON ROSA FLAVORED TEQUILA,13139.999999999998
38073,STATE VODKA,5882.974358974359
65543,LICOR 43 CHOCOLATE,4146.742209631728


2025-01-24 02:09:44 - root - INFO - Please check the answer again by reviewing What are the top 5 items with the highest year-over-year growth percentage in total sales revenue for the year 2023?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Item_Number,Item_Description,Year_Over_Year_Growth_Percentage
item_number1:str,item_description1:str,growth_percentage1:float >= 0
item_number2:str,item_description2:str,growth_percentage2:float >= 0
item_number3:str,item_description3:str,growth_percentage3:float >= 0
item_number4:str,item_description4:str,growth_percentage4:float >= 0
item_number5:str,item_description5:str,growth_percentage5:float >= 0
```

To identify the top 5 items with the highest year-over-year growth percentage in total sales revenue for 2023, we compare each item's total sales revenue in 2022 and 2023, calculate the growth percentage, and list the items in descending order of growth. The actual values require processing the sales data from the `sales` table. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Item_Number,Item_Description,Year_Over_Year_Growth_Percentage
74782,JACK DANIELS WINTER JACK,82851.29242131175
84155,99 CHERRIES MINI,14440.909090909085
64319,THE BUTTERFLY CANNON ROSA FLAVORED TEQUILA,13139.999999999998
38073,STATE VODKA,5882.974358974359
65543,LICOR 43 CHOCOLATE,4146.742209631728
Current sql:
SELECT
  `item_number` AS Item_Number,
  `item_description` AS Item_Description,
  SAFE_DIVIDE(
    SUM(IF(EXTRACT(YEAR FROM `date`) = 2023, `sale_dollars`, 0)) - SUM(IF(EXTRACT(YEAR FROM `date`) = 2022, `sale_dollars`, 0)),
    SUM(IF(EXTRACT(YEAR FROM `date`) = 2022, `sale_dollars`, NULL))
  ) * 100 AS Year_Over_Year_Growth_Percentage
FROM `bigquery-public-data`.`iowa_liquor_sales`.`sales`
WHERE EXTRACT(YEAR FROM `date`) IN (2022, 2023)
GROUP BY `item_number`, `item_description`
HAVING SUM(IF(EXTRACT(YEAR FROM `date`) = 2022, `sale_dollars`, 0)) > 0
ORDER BY Year_Over_Year_Growth_Percentage DESC, `item_number`
LIMIT 5;
2025-01-24 02:10:04 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 02:10:04 - root - INFO - ```csv
Item_Number,Item_Description,Year_Over_Year_Growth_Percentage
74782,JACK DANIELS WINTER JACK,82851.2924
84155,99 CHERRIES MINI,14440.9091
64319,THE BUTTERFLY CANNON ROSA FLAVORED TEQUILA,13140.0000
38073,STATE VODKA,5882.9744
65543,LICOR 43 CHOCOLATE,4146.7422
```

```sql
SELECT
  `item_number` AS Item_Number,
  `item_description` AS Item_Description,
  ROUND(SAFE_DIVIDE(
    SUM(IF(EXTRACT(YEAR FROM `date`) = 2023, `sale_dollars`, 0)) - SUM(IF(EXTRACT(YEAR FROM `date`) = 2022, `sale_dollars`, 0)),
    SUM(IF(EXTRACT(YEAR FROM `date`) = 2022, `sale_dollars`, NULL))
  ) * 100, 4) AS Year_Over_Year_Growth_Percentage
FROM `bigquery-public-data`.`iowa_liquor_sales`.`sales`
WHERE EXTRACT(YEAR FROM `date`) IN (2022, 2023)
GROUP BY `item_number`, `item_description`
HAVING SUM(IF(EXTRACT(YEAR FROM `date`) = 2022, `sale_dollars`, 0)) > 0
ORDER BY Year_Over_Year_Growth_Percentage DESC, `item_number`
LIMIT 5;
```
2025-01-24 02:10:06 - root - INFO - itercount: 2
2025-01-24 02:10:06 - root - INFO - 0
2025-01-24 02:10:06 - root - INFO - Total iteration counts: 2
