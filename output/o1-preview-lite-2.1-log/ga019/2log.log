2025-01-29 23:52:37 - openai._base_client - INFO - Retrying request to /chat/completions in 0.428586 seconds
2025-01-29 23:54:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-29 23:54:29 - root - INFO - SQL:
-- 1. List distinct users who installed during August and September 2018
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20180930'
  AND DATE(TIMESTAMP_MICROS(`user_first_touch_timestamp`)) BETWEEN '2018-08-01' AND '2018-09-30'
LIMIT 100;
Results:
user_pseudo_id
0A26E7281EC31038AD42F28C930FFF90
C679FF00E17790E7E16AB903212EE05C
69541D4D4F182FBB46C3225DA0077DDD
34D724E03220C00EF885D4EF69E66EF3
B65315819D817477B810CA2370FB5935
7B12B56BE42BA15EE493BDC9902B54E4
0DC0F2DDD3229D9AD560E74852FF762F
AEF44B916D5444AAD2B2E4D2E8F24893
F9DD9310584E4F0FA1401F066FEEABD1
730E559E3EBF85DDC5E4785AFC108D59
A254F6E99D57060676D7E27D7FD2C523
E0664E9E7883956A6E3084FD68AA274B
E2ABF58F758941B31BB4630BD519394F
32691653B988011A1D8855300C372CE4
ABB9A6AD029F190506DCF3B87C27E9BC
BFD4EBE156525A32FE1824222EB5FDB3
00802DA458DB2440535C1C3796892482
C6612BDBF9E70C3C8A39B77FFA145CB8
94C7225B71EBBFD33183DD3B59591546
B240CAEDDBC7AEE341900E113CED23DC
0DF6A14F536F6514A6F18BC12A532A82
273A89749418A5955558607B7BB45974
688C1F640EFE5747507270CA7363EC0D
4F34EA13CE343BE6955B67914BD4DF9E
25777661D3D36C3E3656E98F29441CD8
2A43899555261D422AF07565EE51395E
AB714CB216CB456740B54DD82E11FDB9
B529E84EE03C578C7E92CE5836AB1C1D
21DA809CF1B07A7E8D2D73D9030FEEBC
5E272234767505C052A88FAD206933F7
458ED5949D7749672DDC8A8CBC7A45AF
A100243833A4A2AC7041C41B4807F961
5ACF1A6BFE350F7BB661BF389AF7E2F0
0AFE3DE6A443BD660CDD5B1FA36686F6
5E3CBF1204F069C8F4474D492A361CCD
C70D7B092E7900B08A63C36C5D908CD8
21C8516D8DA71E5746CE3C9F1CF61C32
0FDAC2A4A154F9E946D749BFE67B1FCD
45028CA4ED6D9709B55F50CF82E88B3C
7FA1A5B3B4CFDA6EE43060AEE7DDD9B9
7555C0DCEAF5B37E48F328B269DE5CD9
B0D104EE63ABB85675B078664B5924A8
D85672E8322401603F6706560AAFACA7
7439CA3E049F434742CB5C63A55FC24D
DE83C52DBCD401E9FCEE79F25A63B3E7
81A07F200581534596EAE948BDEE015E
1124EFE951E4EE78CFFDDCB080C0E48A
9B3B7AB4B77B74807ED37CD63DE0624E
01A2CCF65B4BB5DF87B1F9177616C5AF
191D3EAE9DFA341F8D8CC5DC8BDD1D80
5C4773A411EA7DA0CE90122B51F37E5D
00676A8589DE5A948F2FFCBFCA568E50
F9F7DDA79A4265363A0B0B361C197338
7746132EFF1AE873A93DD6520B7D43F2
3CD1DEB660E64A41BA76E124B1C0103F
7CC61FB109657777ADD59480BC290F29
AA9C5876D7EB769A269380558FEE0C6E
38C4E3FBD09FA68179F2DE3F133D942D
06CA59D82946D37E6ACDD0EF9A19B8CB
FF845C3FA64B4020EF5272852ABC11CC
AEAA78A175DF8EC1874201A0F5B0E651
6040FA99B7E38468A771643D0702322F
9C4FD2B8EFBE7F68A56C522FF0C52491
5C17C05950C71938CFA82EA7C517748B
817263174EAD24B45AE311E4B5D339EB
C3CF8D010A218064A32EC45C3F446B2E
9521F610DD97622967149844C7CB029E
59FBC4CB04E905D3C1E7548C67392E1A
1845E883F5E20391CD3BD68F488A3C5E
BBC2EEB75E601743F13AF88E06F80659
72FC15A9C0E3262CFCF42B619ECF3774
AED716F2A571507087AF004F331D9949
9BCF204FEB7332261F870DE9EAD57DCC
EBC93C4A364F6830FECB16C6482F0D58
FEEAEF16683900608922225433583714
24B74996895DBBFE033044C0D0088766
918AB13390C2B040E4B0D5086EBF3349
89414B24EED890A8B14119C52A56AC5F
5A44D0AF57DD95C0F5301649B7A23509
196CDAC439AE9EB9B70F6868A05FAD3D
501ED1D90DFFE96E802854A6364809BB
B8C8015FECAD94364B76E74CA9C1A946
6B41B995AAB96DF47E8B522BBD2358C3
57036430EAE106C2B00D97400191304B
12225CC7E9BF710AB6AD6EE9DE761259
27A574ADFE1884A1F60965FE0A2F8C6C
891646F131CE2CCADB5D6676A104CB9D
02BDEEED9EC58C4DF3E3808CFF51C484
E5DFF57F779B2CC4C2C96EEDEB665ACC
0ADCAB98C7686603278BCDD71FE16CC8
A934DACA2D665AA46C5B136AFD32EEBB
2201BA84231D7CC8147F47074DF99E1F
6795CE3FC3D5319BEFFE39428A456919

2025-01-29 23:54:34 - root - INFO - SQL:
-- 2. Get installation dates for users who installed during August and September 2018
SELECT DISTINCT `user_pseudo_id`, DATE(TIMESTAMP_MICROS(`user_first_touch_timestamp`)) AS install_date
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20180930'
  AND DATE(TIMESTAMP_MICROS(`user_first_touch_timestamp`)) BETWEEN '2018-08-01' AND '2018-09-30'
LIMIT 100;
Results:
user_pseudo_id,install_date
383F4B98EC31DD2A915427D36A30354E,2018-08-05
1608F85B710EC4AE0024BB8A1C339071,2018-08-10
89C1D9AF4193728E41F48DC623DEE51F,2018-08-04
811898C76CEDFA57991289FAC0C1A004,2018-08-10
665B1505AECAE3569C2B0FED30223A3D,2018-08-10
3D7382CF3E5091189D2961E0EA3A2ACE,2018-08-07
8479882D86055C6A33EA8ED16B94C30F,2018-08-08
952593544FF78585E08BCBD1E858B570,2018-08-10
E3766F65834BCE7AA781B3B641314E82,2018-08-10
336FED02BA10D201C1B88C1CECB2E9D1,2018-08-09
99C532E3C3875B528AFF60A995C8197D,2018-08-07
3CD1DEB660E64A41BA76E124B1C0103F,2018-08-04
C79C76E03BB4638BDAF2C31322F7B160,2018-08-11
8D86121A671969882C35F9E4C325EECE,2018-08-10
AFF1262CCD472757FC92B2A93C75CD81,2018-08-11
310228A29216613C01B08D8B37AA21E1,2018-08-30
F6F73677A4E6A0F7AACEE96107700035,2018-09-08
D4DDA67EF184AFBC5E2D52FBDEDD7837,2018-08-11
4549717C06BAFE84FB1FFE5DDBD7EB2E,2018-09-09
AE257B45A80D36AAE84F28E46DBF6644,2018-09-09
96685CED0793A219EFE8976477D7DA56,2018-09-05
A135A27E4373605B2EB6E48DCA05720A,2018-08-26
A677442E9D284590F976180D77E3DE84,2018-08-22
6E596EA31C1209D9F775EE90E40CDB29,2018-09-11
0B63D33B5B2251B42D4237903F07FB6C,2018-09-10
A645F59DABBD8ED670286DCF716EBF47,2018-08-11
431104D44BC343ADB59D5881CA18A904,2018-08-07
0E799E05DE124310257B263EF3556AD0,2018-09-10
FBE5BE5E3836527EC27D14834D72B911,2018-09-03
801D5C2787FB2911F810418022C1CD56,2018-09-10
5F5BDACD88C832FAD2E2AC9C20B008C1,2018-09-10
A62611DA6D4B45AC3DB2450BF3A24C23,2018-08-31
D88929586E5166ACCF1A6F037A2DB293,2018-09-10
13384203033F4AA0BF7DF21547E04578,2018-08-05
AED41960DDA933F8914955C5EF2A852E,2018-09-04
F40390B3966B0F225C46E00B78F9886D,2018-09-11
6A9D932B71F94BBFD5BA8A1B5D48903C,2018-08-23
050231DF01854EFA691E0D5F4DB9ADB2,2018-09-01
93DA73B120BE64477ED6F5EDB6D014DB,2018-09-09
0458C336714B6986CD8BF62F5B7FA382,2018-09-09
5FFBFE051291F79717B99F5D72B02CDC,2018-08-01
5BFDC0426DE9C09CA5FF18E4982F2506,2018-08-07
B7D2B63ABE215157570ABD2E2E6EC9BE,2018-08-03
56A069E37C273BE2092ADEB0D527D9B3,2018-08-06
F314B55E64BF801420642F189A3F408A,2018-08-06
EF7772819E807EDBD8DB0F0B5210030E,2018-08-01
3D7CFE25BCB531BCDE2E25BE5D8526FB,2018-08-08
8FE3582D9BA2520A7DBE106334280C58,2018-08-07
F3B0F2F150A1D91E15BB07FACD1EFC89,2018-08-05
79F6D4E6174818E127A589E96D3BB371,2018-08-08
81D5B7A398025886388342CE7159C9C3,2018-08-07
D2AD0448EFF5028698BB4FE8E22256EA,2018-08-08

2025-01-29 23:54:38 - root - INFO - SQL:
-- 3. List events for users within 7 days after installation
SELECT `user_pseudo_id`, `event_name`, TIMESTAMP_MICROS(`event_timestamp`) AS event_time
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) BETWEEN TIMESTAMP_MICROS(`user_first_touch_timestamp`)
    AND TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
LIMIT 100;
Results:
user_pseudo_id,event_name,event_time
486D0900B48B18D315367260129BFFB6,user_engagement,2018-09-23 01:57:08.464000+00:00
B31FAF033014AD1356CAC0542C141057,session_start,2018-09-22 13:48:44.180000+00:00
B31FAF033014AD1356CAC0542C141057,level_complete,2018-09-22 13:49:16.971000+00:00
B31FAF033014AD1356CAC0542C141057,level_up,2018-09-22 13:48:27.971001+00:00
B31FAF033014AD1356CAC0542C141057,screen_view,2018-09-22 13:47:43.102001+00:00
B31FAF033014AD1356CAC0542C141057,screen_view,2018-09-22 13:47:32.094005+00:00
B31FAF033014AD1356CAC0542C141057,screen_view,2018-09-22 13:48:23.116006+00:00
B31FAF033014AD1356CAC0542C141057,screen_view,2018-09-22 13:48:24.461009+00:00
B31FAF033014AD1356CAC0542C141057,screen_view,2018-09-22 13:47:49.483010+00:00
B31FAF033014AD1356CAC0542C141057,screen_view,2018-09-22 13:48:31.059004+00:00
B31FAF033014AD1356CAC0542C141057,screen_view,2018-09-22 13:49:30.076005+00:00
B31FAF033014AD1356CAC0542C141057,screen_view,2018-09-22 13:48:27.378009+00:00
B31FAF033014AD1356CAC0542C141057,post_score,2018-09-22 13:48:12.971003+00:00
B31FAF033014AD1356CAC0542C141057,screen_view,2018-09-22 13:48:45.998000+00:00
B31FAF033014AD1356CAC0542C141057,level_start,2018-09-22 13:48:05.459011+00:00
B31FAF033014AD1356CAC0542C141057,level_end,2018-09-22 13:48:06.971002+00:00
B31FAF033014AD1356CAC0542C141057,level_retry,2018-09-22 13:48:49.324008+00:00
B31FAF033014AD1356CAC0542C141057,level_start,2018-09-22 13:48:08.355011+00:00
B31FAF033014AD1356CAC0542C141057,select_content,2018-09-22 13:47:37.039003+00:00
B31FAF033014AD1356CAC0542C141057,select_content,2018-09-22 13:48:37.385007+00:00
B31FAF033014AD1356CAC0542C141057,user_engagement,2018-09-22 13:48:27.072004+00:00
B31FAF033014AD1356CAC0542C141057,user_engagement,2018-09-22 13:47:32.417008+00:00
B31FAF033014AD1356CAC0542C141057,user_engagement,2018-09-22 13:48:27.023006+00:00
B31FAF033014AD1356CAC0542C141057,user_engagement,2018-09-22 13:49:09.331007+00:00
B31FAF033014AD1356CAC0542C141057,user_engagement,2018-09-22 13:48:51.213013+00:00
486D0900B48B18D315367260129BFFB6,session_start,2018-09-22 16:53:48.834000+00:00
486D0900B48B18D315367260129BFFB6,app_exception,2018-09-22 16:56:50.950026+00:00
486D0900B48B18D315367260129BFFB6,app_exception,2018-09-22 16:58:44.419013+00:00

2025-01-29 23:54:42 - root - INFO - SQL:
-- 4. List users who have events beyond 7 days after installation
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) > TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
LIMIT 100;
Results:
user_pseudo_id
FC55032FC8C06EB1A1220D1ABD1164C9
4BB019F8F6D1FE7BA78CA42A4698EF56
2D644942A18A482A9AD370DA9F38B709
3DC258E32531148709A4BF575C0F076E
B99FD965B0874192EE94E8A8FE85EA9E
7E40E634997585B0C69B6F67C01C191B
E6FEE8B98E75EA5311FE004F98559A27
6CD2676098B3E076AD66D10BF4565BFA
FA30269453141794E79B8F15EE0BA5B9
AC978F51AA488D36AC372688F0E803E2
BE36C49B1AB3968D420923AEC4FDD7AE
89BD2B0E233951461CF06C9B4FDA0D81
418C1FE4FF01EA36F511E5D9073F11BD
D5F9D9AF22EF5073E10342973D48FB2C
A232A112349100CF520C1B717217EA99
B49D910719C2E687FA278E5E0AFE74C1
53866E32BA0ABFD846772D4B7B9B5921
42E6A7C3536775E3B8C3DB919AE9A452
FFA9AE78B23263835F8AAED57713EBE9
3875A92B5F5C2BBA1355CED06A986079
197AF7AF510DCB8AB8F42F87057F99C4
19AB27B8A0F2C7C738683CA2F5FFEBE1
19DEEA6B15B314DB0ED2A4936959D8F9
0CAAA1B6F161BA4D363EB7A2DEF64A08
B5395F8C2077B59B3D6C5719C0CA0339
A19F659EA9BA36A3595F088F30A6B7E7
E2216EDD73FE4AE219043A46F0EE9003
CF2439F24FF3E5C1B14DAE41335E2FEA
7A24963AB998AC045AF363D6DDE7F169
75F979DE60C91A6631485A88457C108E
B8B62795AD07E431D8565555C6882EA3
841A68D5D1F94857BEB64225193B2432
DE3F49561A3E21ED2C9CC518F564961E
F2ACDC8D64D4218BA63EB8732C110BA5
D9AA0EC27AF47514DDB5C664A6EF758A
5DA9B8E6D16C68613B3C805D9E449623
D4498C9FB447D7127B04ED7810C32D9F
9C8494CDC3107F7BE54CCF3E820252D6
7F089F4710219060252DB2AEF508A662
6EC263DBA95206A1A9EB55CD93F58FD2
A3CDDBDA41C8290EF828C2DCE98B346B
014693E9CD0C8BEC15597BBF730E0A75
BB29F8B0FF330F326605FA421BB37BC1
F866B1D9D660101FF4C436E5D93D2C08
71F005E58FCF825DFF3DFBC29FC806F1
6531C074EA6897B52557F141AB2FD77A
396CD60DADAB9CBA7DDCAF239B477135
C1327B694B124442335CFFD6FD3B15EC
A66F392F752B3A59F2644F4158644FF1
48FFB36AFFB051EC56910335F81BB3C6
E7CCB643C1D0028BF305EDD85397255E
F655D26B0F7A4093F1D2FFBD5E61B09D
5269565AB96D3D27ADEA4D7EF4DC2A88
8EFA45B60DF34986EDC7C7CC0CD7CD69
C1A0D9FB3527654CA715A732B5FB5202
31017A05A48B25FED4834F968D5D0F83
8DC5189969449E1BF8588B3EA64974A1
FAEA82CB9B0515460B95BC9F02B6E110
75120F32A68A6C4FB643349E125D8C31
28C4A09298C441D5AFD39E749D9F3DA3
AD99B4950F9D70E0FD5E8563F2A664FB
74EFA3B9E98982CB94246D7F95DF29D0
0E10123B79C73F4F30CC49462652D604
55F9FB7C14AA4BAB066EA326D4A2221B
5E9B9E20975EF45745B511D401456619
80F152611EE983C7ED2200A2233684C1
8581D07F873789998E8929C212D70CA4
E1A3C786B2E4D56629EE808A3A174995
6095502F2573E3B246D9297314490E87
295D9E24D8DE65A010313E667131EF19
29BC86DCA0D500C9410F392B57C28DD3
BE46B64DFFEE5B00F197D666EB57E781
0D6A346C85BF606BE12F9A70FC20A7B7
9E63A50ABB7C292735533D3308161DBD
06620D97BAC22D30DDE66F80BC5E7EA3
C679FF00E17790E7E16AB903212EE05C
263C111D407C5E17AC6310581C3B9255
717914316B7E4BD629C168B3A05634DC
9A48089B85BC2C1F630A2DDE3B200F83
64EA802089E68A699EC86438C9504F94
5E9BF00B469B284E028094EA15A9F1FE
CF41EE09246399E27F5D78EBB3FA02EA
8A967B0EBC5488B83E64805029677B66
EA35FE295A7C1F8F67836AEB608CEBBD
ED90CC7C8BC768DBF3B8B87A75422721
FE57ACE9DC234A25BDAD9CD6BC190B83
E371044DC93C1A7AF36C2B7A76E8CD16
826D755FFE3C52017D944D3330309379
E0664E9E7883956A6E3084FD68AA274B
B529E84EE03C578C7E92CE5836AB1C1D
C14A95DFD8457015BFFCBAF2431EAFCF
F1A4ACA5337DF6B0DAE14420BC457CE3
6C7CED4AEF652AC9A7009008F1DC5211

2025-01-29 23:54:47 - root - INFO - SQL:
-- 5. Count of events per user within 7 days after installation
SELECT `user_pseudo_id`, COUNT(*) AS event_count
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) BETWEEN TIMESTAMP_MICROS(`user_first_touch_timestamp`)
    AND TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
GROUP BY `user_pseudo_id`
LIMIT 100;
Results:
user_pseudo_id,event_count
4A8D4276A1EBBD17E6CB7EE30FE71CC2,125
9AFF07DCC4DC8276854BC916473FEDDA,777
7F8E0A83EA3833F063DA2107E073AC03,9
ED5C290C8F82C28C033482D31299D8CD,30
359A34F575B808FEFE58BC5B40816F09,649
C6D97C0D6DA580A6FDB44BB2C3015A85,155
F7164A70962E5AED09AD0CEB0A3C7C82,117
1C9927831BAA7A0569130EADD6320C69,303
D4BE9C6F73E39CCE4ED1901AF98A9E3A,8
814700C58B117F7ABFFB1145B9C29D29,419
005F127942F3FD25588272950FDFD339,3
8EC69D56A1BBBE4F2691746E39B8756D,668
BB322D2CA948F548EA3A05A2BD93B1A3,449
57EC50FBC6C7277B8EDCCE44C1352BD4,14998
383F4B98EC31DD2A915427D36A30354E,719
1D89281562AC3FEFB76A42ED406BF1B5,20
019FCC6C080A33E9B697CAA476C4156E,261
B2884EF528224A5E0631D23868603057,24
F720D2FE0350DA0E19A729BE9A4B73FB,33
434B79A24E73A32E488354A1AAD98495,167
FDFBC68590B06B23FACCF2DE6A0FEAD7,103
370BAFBB7AFD77B12726F4712DB42DF8,122
63FEF9F33B5B4155C207095EBA23730A,998
E3DB69E48378F1EED6C064C7614AACAB,4
F3A2F44C99758CC6006BFE28AC78EBFE,95
093E3E8BB59252BCD92BA5B7EAE55BBD,200
E8EF9920D6437CA7E5AEAF580FFBD26D,81
13F080023BC02C4DC81CF648D346DA49,2
65A5F4580F975A3253988138FBAB03AC,21
7E74A2BB6BBF4746DEE15F957B315401,2657
AF06A87FD3FD797F7FA3A44DFC445701,74
50D529BFD3EFEB1C8216DF9A321A552A,705
C1CBEBB972ADB547F2B4B9F3FBB44E38,5
C3E3CDDD1E35362AA59854F8FA511BB0,243
45CB5196EB384766A8EDEFEEF410CC23,60
A62611DA6D4B45AC3DB2450BF3A24C23,109
23FD6C65AB271F4DD5FC2FDEA888032D,1477
0BF28246916A6D54E16290E925B16593,1763
71B1D9279ABC5D66169F2937CFB9DA47,24
9FE14774A6A768A1C1BEBCE0DE0669A5,696
5F221A89D8CA4217F46AEF4C5D9C925E,5
F37600D4287F1C83A90F3A8CE687FAA3,65
4F09BB9CBF9E3C4A742B1D8B42D2E60A,213
D4EC4DAD608E47C043A3A6E659050CE3,45
4ABF69A40A3BC6057CD49D74A6C18AC2,140
72AC12CE2E2F425A2546D18F14B0077A,368
337A3F347AE32CE90A631DF3028500A5,38
1440D2F8CDB64BFAA5621779B8C92571,609
AC86F727F3237AD98B97B536AE6A8035,179
2CC12B6413FBC345930F7B81394B96A6,4
07D1A24DC2164260EEA5FB510C491431,22
857415053FD447A7EDDACD7FB72A8E9E,39
03915D9B9DC76855CC63C18E94C93760,377
AF7F48274AA5128EBCF3698F4FC8F61B,4940
8D76B80E2CCAE0EDD0F2D50D1ABCC0B3,36
3309F4DE80E33A212A45B29D973EBC9C,73
BDD854D198AD34410E91C75C2ED5F525,51
1FEB41A72F244D352EA79982CC259EA0,280
66163D6663552C5C43D3DB1D98FCA9DA,624
F37D0945286059018632F1151EFE1AD3,57
2CCA4395A5281BAC61DD7C846837F50B,709
1608F85B710EC4AE0024BB8A1C339071,1144
B285B6DE14EFCE4E5F460B28881666A3,8
1F58AAA40540B7B531EF090A0669384E,4
D5E0BD50D8A6244443E08E2E71B3739D,318
A2BA4DC59DE828E7FA1A3D2746162D86,61
C40F22701672A6B7AFF9F4F6FBC235EA,442
E98C2033935E43DBA50950F7039FF492,67
D17D42F01E95FAA1D5083EFE4D319503,69

2025-01-29 23:54:52 - root - INFO - SQL:
-- 6. Users who only had events within 7 days after installation and none after
SELECT `user_pseudo_id`
FROM (
  SELECT `user_pseudo_id`,
    MAX(TIMESTAMP_MICROS(`event_timestamp`)) AS last_event_time,
    TIMESTAMP_MICROS(`user_first_touch_timestamp`) AS install_time
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  GROUP BY `user_pseudo_id`, install_time
)
WHERE last_event_time <= install_time + INTERVAL 7 DAY
LIMIT 100;
Results:
user_pseudo_id
61F5B317AB1EF10E3C7E68C930A1018C
665B1505AECAE3569C2B0FED30223A3D
1808658733660F3EC33CDCC3EC995394
0C0803BC7D87E45A797914F9DAACD364
952593544FF78585E08BCBD1E858B570
E3766F65834BCE7AA781B3B641314E82
36D35160F560D4FE9D1B0E48063F3665
55F725AB1CC8281CDAC2FFEDC35423F4
C337446FADC0FB49C18BB3C9C86339B6
98001421668C25D7C0B41F550C53D949
5DD61074AA5F92DE0CE1F00516BFDBF5
0A0B3A969C027FAED144D9E15F0A2375
B0B8369C7B317332A28A914D018BD475
F488B4536BA104FE39ED63F2D4959B9C
3BCAC13975252993F0225A6408781512
40B409D2F011F83053D8E40B6EACBD92
00B13A0B8C9E83965F9395EA745D98F2
8875E076B50263771FFC844ED47A12AC
ADBF591A2A1DE60915F718F8FD6ED4C1
E63C6A09F5D06DBFA6FBF832AE8997BE
0811766182AB8CE075D0E653F8B79E05
B862FC7AE439EF77BEF67082070EFB78
8F1879A37D4A45B618D310F69BCFFAEE
E93281A256FC37DDA502B64B6E210282
DB8FF95DA0346459D3EF59D5142D9ECA
C259024130B11594A8BC902098A8C6A4
989D5092D062D1B432BEB9C618B21431
B65315819D817477B810CA2370FB5935
7F12F87E29E894031F904B8BCA1BC05F
7705D52DD2286DC2E6DB831A2E129E94
1CF4635F6034EB147F361912D5F73268
9434EE4CFDFE0F5BCFE40126A569F3BB
07D5951C19A83B2CB9C8BA9319B5A9FD
EC8A980198BB3331B3088F123019D1B9
B3234CECCA15CEE80BDE39DA9D8AE687
801D5C2787FB2911F810418022C1CD56
F0AC931DD49207C2ABADA1AE09FC27EC
A21FA27B87923DDDF416E3B7F7EC47AB
B2EB23C3BE3D6036CCEFD2747E51E872
0AFF9E84E0311BC3CEB3AF2358D70B4D
79352792B72C3FF7BBC40ACFE7235AFE
83D42C0BEC5C0325916E5797073CEE9A
5B64EFC31A1378A17ABFFAD603A2E1B4
4B0E55D94CB208CC6A4B0F5A86032D41
6D5E557789275879745EB60D8AA53498
723B27DABF02945DAFCDE7843622D8E8
A25F3BC7C453989DF4127EEAD4F3FDC6
C83DB20A4364A88C81A58AC7B47EC995
7197BEF5542521683ED1B58EDB184770
CF77B186B6800C045AAB1496A019B4E9
E61A380E8D23814F4247CF6D2E11F13A
C60030D930B4915AE9974309F8C32C92
92BA07C5AF1103CDD804CDA9F7199B95
82E19322741E476045ECAE2EB0AEBC5B
7EDFFF7CB9DB49F6C61708EEBA33A32D
847C41413ECD9C277B4896E786340891
735D0773BF0193D26BA48A56D1C69CAB
D03DB5B7CD510FC8309C5681588A7C8B
3A66B71F62FBDEF60DED96B73BA783A8
8C1CB07E72786B08197308216F1A43B4
707C0AFA81F8D488E330273B62D3C26F
CED40D58D49739D575C4FE563CF079D6
D84C3BFD237D79D5FA1A8189F7DC6845
93ABDBDD5D7852AE62B0448B1B5E73AB
17A6B18F52178D4C258DEDC5CDB93F3E
3D9CD866FA73F2327C3B63DF16A477D9
E257276F0588FCD48CDBB90133C335E2
60597897170A939505105BF1863E9E4E
ACDEFD8D3F601128F8B6B55256028E1C
814700C58B117F7ABFFB1145B9C29D29
AA287C3266DB6069B75DCBB51006D808
B16AA0715E1721E18F4B9316E4A0B3E1
AF0D4AA31F5CC6DADA427AAEA0B7FD2A
CA37F774EBF501D06CF14866877A2EA3
39E4645E037720D29EDE6A424C8B7AF7
C59E095CFA4F1A81AAAE3150E384AB21
2D23CD90AE51556D7B8FAD2C358D308A
AE5C3CFC7F5F1225DC2E5190DF8CE3E6
4DB647101091FF7904FF733D992443B5
F3B0F2F150A1D91E15BB07FACD1EFC89
945743E3AC497529EFF0081BC6FC0931
942E123C7E8C0B62935889D03D77BE8E
19856982238BAE6AF8C9AEBFE3D77A48
3B8B6295198F4D19C6FDCCC61D9A76C2
977C7813C0DE5EB1BB6FB362DF190D99
C08E0DCBBC8F969D51C14B0E479EA9FA
0327DBE89EBE6C41E1D85E7EA1C29062
4BAD26C68B3F0EC7F290D5160E16AB16
82C4C434811FFE6491CD496EFEA96382
6344D6DD4B7741E868D17A8CC19E03C8
7D87123EF025F4B3A92359C10CBD8039
F108523E7DD7905608275CC84287B217
71AAE70AC95236B7ADF665241789A2DB

2025-01-29 23:54:55 - root - INFO - SQL:
-- 7. Events occurring more than 7 days after installation
SELECT `user_pseudo_id`, `event_name`, TIMESTAMP_MICROS(`event_timestamp`) AS event_time
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) > TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
LIMIT 100;
Results:
user_pseudo_id,event_name,event_time
817C3E590030EB56A11A38D56919B6C5,session_start,2018-09-05 21:19:36.439000+00:00
817C3E590030EB56A11A38D56919B6C5,session_start,2018-09-05 22:38:53.015000+00:00
817C3E590030EB56A11A38D56919B6C5,level_complete_quickplay,2018-09-05 22:41:15.887008+00:00
817C3E590030EB56A11A38D56919B6C5,screen_view,2018-09-05 22:41:55.748012+00:00
817C3E590030EB56A11A38D56919B6C5,screen_view,2018-09-05 22:41:20.773013+00:00
817C3E590030EB56A11A38D56919B6C5,screen_view,2018-09-05 22:42:27.687014+00:00
817C3E590030EB56A11A38D56919B6C5,post_score,2018-09-05 22:42:04.888010+00:00
817C3E590030EB56A11A38D56919B6C5,screen_view,2018-09-05 21:20:39.133000+00:00
817C3E590030EB56A11A38D56919B6C5,level_start_quickplay,2018-09-05 21:19:20.140002+00:00
817C3E590030EB56A11A38D56919B6C5,level_reset_quickplay,2018-09-05 21:19:41.300000+00:00
817C3E590030EB56A11A38D56919B6C5,level_start_quickplay,2018-09-05 21:20:34.304001+00:00
817C3E590030EB56A11A38D56919B6C5,level_reset_quickplay,2018-09-05 21:22:19.721002+00:00
817C3E590030EB56A11A38D56919B6C5,level_start_quickplay,2018-09-05 21:23:03.725003+00:00
817C3E590030EB56A11A38D56919B6C5,level_reset_quickplay,2018-09-05 22:38:56.951002+00:00
817C3E590030EB56A11A38D56919B6C5,level_start_quickplay,2018-09-05 22:39:24.957003+00:00
817C3E590030EB56A11A38D56919B6C5,level_reset_quickplay,2018-09-05 22:38:35.503004+00:00
817C3E590030EB56A11A38D56919B6C5,level_start_quickplay,2018-09-05 22:38:36.506005+00:00
817C3E590030EB56A11A38D56919B6C5,level_end_quickplay,2018-09-05 22:41:23.888009+00:00
817C3E590030EB56A11A38D56919B6C5,level_start_quickplay,2018-09-05 22:41:09.684015+00:00
817C3E590030EB56A11A38D56919B6C5,user_engagement,2018-09-05 21:01:27.816005+00:00
817C3E590030EB56A11A38D56919B6C5,user_engagement,2018-09-05 21:22:02.943004+00:00
817C3E590030EB56A11A38D56919B6C5,user_engagement,2018-09-05 21:23:48.340007+00:00
817C3E590030EB56A11A38D56919B6C5,user_engagement,2018-09-05 22:42:22.723011+00:00
817C3E590030EB56A11A38D56919B6C5,user_engagement,2018-09-05 22:43:46.137017+00:00
9F7B0D1BFB822F5E26E91E184E2E437C,session_start,2018-09-05 07:42:19.406000+00:00
9F7B0D1BFB822F5E26E91E184E2E437C,screen_view,2018-09-05 07:42:39.405001+00:00
9F7B0D1BFB822F5E26E91E184E2E437C,screen_view,2018-09-05 07:42:31.291000+00:00
9F7B0D1BFB822F5E26E91E184E2E437C,user_engagement,2018-09-05 07:42:01.624004+00:00

2025-01-29 23:55:00 - root - INFO - SQL:
-- 8. Number of users who did not have any event after 7 days of installation
SELECT COUNT(*) AS user_count
FROM (
  SELECT `user_pseudo_id`,
    MAX(TIMESTAMP_MICROS(`event_timestamp`)) AS last_event_time,
    TIMESTAMP_MICROS(`user_first_touch_timestamp`) AS install_time
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  GROUP BY `user_pseudo_id`, install_time
)
WHERE last_event_time <= install_time + INTERVAL 7 DAY
LIMIT 100;
Results:
user_count
2493

2025-01-29 23:55:05 - root - INFO - SQL:
-- 9. List of event names and their counts beyond 7 days after installation
SELECT `event_name`, COUNT(*) AS event_count
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) > TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
GROUP BY `event_name`
ORDER BY event_count DESC
LIMIT 100;
Results:
event_name,event_count
screen_view,1129091
user_engagement,596857
level_start_quickplay,252034
level_end_quickplay,170626
post_score,114437
level_complete_quickplay,106714
level_fail_quickplay,63899
level_reset_quickplay,58489
select_content,47622
session_start,35866
level_start,15306
level_retry_quickplay,13272
level_end,11204
level_retry,8467
level_up,7719
level_complete,7526
level_fail,3485
spend_virtual_currency,3119
use_extra_steps,2997
app_exception,2459
os_update,1537
level_reset,1337
app_update,1077
error,990
no_more_extra_steps,871
ad_reward,729
app_remove,621
completed_5_levels,368
firebase_campaign,226
challenge_a_friend,138
first_open,9
app_clear_data,7
in_app_purchase,5

2025-01-29 23:55:09 - root - INFO - SQL:
-- 10. List users with their total number of events after installation
SELECT `user_pseudo_id`, COUNT(*) AS total_events
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) >= TIMESTAMP_MICROS(`user_first_touch_timestamp`)
GROUP BY `user_pseudo_id`
LIMIT 100;
Results:
user_pseudo_id,total_events
295D9E24D8DE65A010313E667131EF19,12266
F9BE4FD7C6FE584C111EC4F3474B01AA,22
C7DD86F06FD4AA8A0967E27E20750FCD,205
FA30269453141794E79B8F15EE0BA5B9,6456
0A26E7281EC31038AD42F28C930FFF90,3243
BE36C49B1AB3968D420923AEC4FDD7AE,1372
E5AFF3DE508996512D61B49A63D1D063,263
5145D8121071A9EA903A1098034962F6,1449
A0EDEFE9E2CC092F97266CDF9DB5830F,34
F0186BDA8E7BF76675999CFDCFB10F6B,180
E41F819718B0E2C49D347493BFACA027,4
418C1FE4FF01EA36F511E5D9073F11BD,3930
1E6348F7A97962E7EAA87C7FF638569F,1331
59BE43F3FE7AB3F91B016B56508D4C46,1020
3875A92B5F5C2BBA1355CED06A986079,41896
51AE09760820E12217697F7007D6C78B,164
12225CC7E9BF710AB6AD6EE9DE761259,905
C98FE4C10160A105798C65E6AA160974,38
0E65A1967A3EE64A4D33E6038D677FAD,7
B5395F8C2077B59B3D6C5719C0CA0339,14299
A4442ED82DBC31EB300EE7BD825C85E1,9
27293EA0B2F41A672E15EF7B1FA21298,111
289F2AE59FE48FFF6DD12D0AB553C14E,563
0A9D7004114F34B9CD49538E173E01A7,247
AC31184536F28AD520C398EC582A3537,262
C8FDED9EDFF7241123AA2FDEC0E84238,35
B8C8015FECAD94364B76E74CA9C1A946,223
6B41B995AAB96DF47E8B522BBD2358C3,190
749D1C8A698B9549D1E4CEAD631A4610,659
6158C7CD861E2F83D6AA22CCF92AEE97,88
86CA1B6FDD0C4D4DF2B34DB3615134C7,37
E90A8FDA1D41057AAB8A72644731B422,17
36390262EE0C669101AD7ACFE181689C,533
7ED8C235689771F6B0F29BBF295A346F,1385
27A574ADFE1884A1F60965FE0A2F8C6C,212
717914316B7E4BD629C168B3A05634DC,636
329041D331D6165A7AB15EA5D452A8E6,257
B711923F02FB2923F0A4DBC8CA2CE3AD,505
93C5C5EEACDB9F83DD795449363339E2,301
EB96D4E588761A891B492920DB8CDC25,603
891646F131CE2CCADB5D6676A104CB9D,99
152C2738DCE249CB59AC64A3C7EDC918,38
BFD4EBE156525A32FE1824222EB5FDB3,200
915283C2BCF30F60C78E1B0791E47FA8,11
8131D03808054C6791B7DBDD01CD4CA8,15
A62CD597E76D7FC17D8BEA76BC613AFA,4
84B38C413A7F3C683BCC6CBCCA246FBE,44
C3FCDF18C57A6F16E5EE6867CA6679E1,1272
AED41960DDA933F8914955C5EF2A852E,1249
51FB83B864E295B2E3961F703F37C945,154
5C9E7451F0D78507AB638C4C98D0F7D5,155
8A9F6BCE5D510942A986330594E32D81,292
E7CCB643C1D0028BF305EDD85397255E,490
F655D26B0F7A4093F1D2FFBD5E61B09D,4750
711364F41553811B33FD216391234D59,735
31D5069785D55AD5A7059983946A8959,3
A51BF75239709A5494645BEAABC3453D,3841
E98AFA6BD0908A7BDF0FE75396B204DD,622
7FB0FA98A8949CD6D75B48C449DAE33B,359
21DCA7DC9C0479FEE7081E05188B6258,216
E0664E9E7883956A6E3084FD68AA274B,44978
2201BA84231D7CC8147F47074DF99E1F,1003
859BD5756C9635B9A657B90A7265679A,8175
8BE78CDB3DC97B9022E260222059E3CF,4
8876B3BBA28536588C22FEB683454240,101
690CE4729AC49CA52E5669DF0B426535,57
8C33815E0A269B776AAB4B60A4F7BC63,1757

2025-01-29 23:55:09 - root - INFO - itercount: 0
2025-01-29 23:55:09 - root - INFO - Database Name: firebase-public-project
Schema Name: analytics_153293282
DDL describes table information.
,0
table_name,events_20180801
ddl,"CREATE TABLE `firebase-public-project.analytics_153293282.events_20180801`
(
  event_date STRING,
  event_timestamp INT64,
  event_name STRING,
  event_params ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64>>>,
  event_previous_timestamp INT64,
  event_value_in_usd FLOAT64,
  event_bundle_sequence_id INT64,
  event_server_timestamp_offset INT64,
  user_id STRING,
  user_pseudo_id STRING,
  user_properties ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64, set_timestamp_micros INT64>>>,
  user_first_touch_timestamp INT64,
  user_ltv STRUCT<revenue FLOAT64, currency STRING>,
  device STRUCT<category STRING, mobile_brand_name STRING, mobile_model_name STRING, mobile_marketing_name STRING, mobile_os_hardware_model STRING, operating_system STRING, operating_system_version STRING, vendor_id STRING, advertising_id STRING, language STRING, is_limited_ad_tracking STRING, time_zone_offset_seconds INT64>,
  geo STRUCT<continent STRING, country STRING, region STRING, city STRING>,
  app_info STRUCT<id STRING, version STRING, install_store STRING, firebase_app_id STRING, install_source STRING>,
  traffic_source STRUCT<name STRING, medium STRING, source STRING>,
  stream_id STRING,
  platform STRING
);"

Some other tables have the similar structure: ['events_20180801', 'events_20180621', 'events_20180616', 'events_20180912', 'events_20180814', 'events_20180716', 'events_20181003', 'events_20180620', 'events_20180624', 'events_20180918', 'events_20180612', 'events_20180911', 'events_20180724', 'events_20180807', 'events_20180710', 'events_20180808', 'events_20180702', 'events_20180719', 'events_20180914', 'events_20180913', 'events_20180915', 'events_20180728', 'events_20180817', 'events_20180628', 'events_20180906', 'events_20180704', 'events_20180711', 'events_20180720', 'events_20180706', 'events_20180926', 'events_20180924', 'events_20180731', 'events_20180804', 'events_20180920', 'events_20180715', 'events_20180709', 'events_20180928', 'events_20180904', 'events_20180903', 'events_20180818', 'events_20180820', 'events_20180707', 'events_20180930', 'events_20180821', 'events_20180812', 'events_20180830', 'events_20180908', 'events_20180708', 'events_20180910', 'events_20180922', 'events_20180713', 'events_20180618', 'events_20180811', 'events_20181001', 'events_20180626', 'events_20180828', 'events_20180717', 'events_20180806', 'events_20180721', 'events_20180725', 'events_20180824', 'events_20180923', 'events_20180627', 'events_20180726', 'events_20180729', 'events_20180929', 'events_20180925', 'events_20180722', 'events_20180630', 'events_20180730', 'events_20180831', 'events_20180701', 'events_20180619', 'events_20180810', 'events_20180822', 'events_20180921', 'events_20180819', 'events_20180927', 'events_20180905', 'events_20180816', 'events_20180622', 'events_20180802', 'events_20180826', 'events_20180714', 'events_20180901', 'events_20180916', 'events_20180809', 'events_20181002', 'events_20180703', 'events_20180617', 'events_20180902', 'events_20180625', 'events_20180827', 'events_20180805', 'events_20180825', 'events_20180919', 'events_20180917', 'events_20180705', 'events_20180613', 'events_20180907', 'events_20180909', 'events_20180727', 'events_20180813', 'events_20180614', 'events_20180623', 'events_20180829', 'events_20180615', 'events_20180712', 'events_20180718', 'events_20180815', 'events_20180629', 'events_20180803', 'events_20180823', 'events_20180723']
External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180612', 'events_20180613', 'events_20180614', 'events_20180615', 'events_20180616', 'events_20180617', 'events_20180618', 'events_20180619', 'events_20180620', 'events_20180621', 'events_20180622', 'events_20180623', 'events_20180624', 'events_20180625', 'events_20180626', 'events_20180627', 'events_20180628', 'events_20180629', 'events_20180630', 'events_20180701', 'events_20180702', 'events_20180703', 'events_20180704', 'events_20180705', 'events_20180706', 'events_20180707', 'events_20180708', 'events_20180709', 'events_20180710', 'events_20180711', 'events_20180712', 'events_20180713', 'events_20180714', 'events_20180715', 'events_20180716', 'events_20180717', 'events_20180718', 'events_20180719', 'events_20180720', 'events_20180721', 'events_20180722', 'events_20180723', 'events_20180724', 'events_20180725', 'events_20180726', 'events_20180727', 'events_20180728', 'events_20180729', 'events_20180730', 'events_20180731', 'events_20180801', 'events_20180802', 'events_20180803', 'events_20180804', 'events_20180805', 'events_20180806', 'events_20180807', 'events_20180808', 'events_20180809', 'events_20180810', 'events_20180811', 'events_20180812', 'events_20180813', 'events_20180814', 'events_20180815', 'events_20180816', 'events_20180817', 'events_20180818', 'events_20180819', 'events_20180820', 'events_20180821', 'events_20180822', 'events_20180823', 'events_20180824', 'events_20180825', 'events_20180826', 'events_20180827', 'events_20180828', 'events_20180829', 'events_20180830', 'events_20180831', 'events_20180901', 'events_20180902', 'events_20180903', 'events_20180904', 'events_20180905', 'events_20180906', 'events_20180907', 'events_20180908', 'events_20180909', 'events_20180910', 'events_20180911', 'events_20180912', 'events_20180913', 'events_20180914', 'events_20180915', 'events_20180916', 'events_20180917', 'events_20180918', 'events_20180919', 'events_20180920', 'events_20180921', 'events_20180922', 'events_20180923', 'events_20180924', 'events_20180925', 'events_20180926', 'events_20180927', 'events_20180928', 'events_20180929', 'events_20180930', 'events_20181001', 'events_20181002', 'events_20181003']}}
Begin Exploring Related Columns
Considered tables and columns relevant to the task:

- **`user_pseudo_id`**: to uniquely identify users.
- **`user_first_touch_timestamp`**: to determine when the user first installed the app.
- **`event_timestamp`**: to find events per user and their event times.
- **`event_name`**: to identify different types of events.
- **`event_date`**: to filter events by date.

Conditions that may be used:

- Users who installed the app during August and September 2018.
- Events occurring within 7 days after installation.
- Users who have events beyond 7 days after installation.

Here are 10 BigQuery SQL queries:

```sql
-- 1. List distinct users who installed during August and September 2018
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20180930'
  AND DATE(TIMESTAMP_MICROS(`user_first_touch_timestamp`)) BETWEEN '2018-08-01' AND '2018-09-30'
LIMIT 100;
```

```sql
-- 2. Get installation dates for users who installed during August and September 2018
SELECT DISTINCT `user_pseudo_id`, DATE(TIMESTAMP_MICROS(`user_first_touch_timestamp`)) AS install_date
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20180930'
  AND DATE(TIMESTAMP_MICROS(`user_first_touch_timestamp`)) BETWEEN '2018-08-01' AND '2018-09-30'
LIMIT 100;
```

```sql
-- 3. List events for users within 7 days after installation
SELECT `user_pseudo_id`, `event_name`, TIMESTAMP_MICROS(`event_timestamp`) AS event_time
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) BETWEEN TIMESTAMP_MICROS(`user_first_touch_timestamp`)
    AND TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
LIMIT 100;
```

```sql
-- 4. List users who have events beyond 7 days after installation
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) > TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
LIMIT 100;
```

```sql
-- 5. Count of events per user within 7 days after installation
SELECT `user_pseudo_id`, COUNT(*) AS event_count
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) BETWEEN TIMESTAMP_MICROS(`user_first_touch_timestamp`)
    AND TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
GROUP BY `user_pseudo_id`
LIMIT 100;
```

```sql
-- 6. Users who only had events within 7 days after installation and none after
SELECT `user_pseudo_id`
FROM (
  SELECT `user_pseudo_id`,
    MAX(TIMESTAMP_MICROS(`event_timestamp`)) AS last_event_time,
    TIMESTAMP_MICROS(`user_first_touch_timestamp`) AS install_time
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  GROUP BY `user_pseudo_id`, install_time
)
WHERE last_event_time <= install_time + INTERVAL 7 DAY
LIMIT 100;
```

```sql
-- 7. Events occurring more than 7 days after installation
SELECT `user_pseudo_id`, `event_name`, TIMESTAMP_MICROS(`event_timestamp`) AS event_time
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) > TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
LIMIT 100;
```

```sql
-- 8. Number of users who did not have any event after 7 days of installation
SELECT COUNT(*) AS user_count
FROM (
  SELECT `user_pseudo_id`,
    MAX(TIMESTAMP_MICROS(`event_timestamp`)) AS last_event_time,
    TIMESTAMP_MICROS(`user_first_touch_timestamp`) AS install_time
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  GROUP BY `user_pseudo_id`, install_time
)
WHERE last_event_time <= install_time + INTERVAL 7 DAY
LIMIT 100;
```

```sql
-- 9. List of event names and their counts beyond 7 days after installation
SELECT `event_name`, COUNT(*) AS event_count
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) > TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
GROUP BY `event_name`
ORDER BY event_count DESC
LIMIT 100;
```

```sql
-- 10. List users with their total number of events after installation
SELECT `user_pseudo_id`, COUNT(*) AS total_events
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) >= TIMESTAMP_MICROS(`user_first_touch_timestamp`)
GROUP BY `user_pseudo_id`
LIMIT 100;
```Query:
-- 1. List distinct users who installed during August and September 2018
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20180930'
  AND DATE(TIMESTAMP_MICROS(`user_first_touch_timestamp`)) BETWEEN '2018-08-01' AND '2018-09-30'
LIMIT 100;
Answer:
user_pseudo_id
0A26E7281EC31038AD42F28C930FFF90
C679FF00E17790E7E16AB903212EE05C
69541D4D4F182FBB46C3225DA0077DDD
34D724E03220C00EF885D4EF69E66EF3
B65315819D817477B810CA2370FB5935
7B12B56BE42BA15EE493BDC9902B54E4
0DC0F2DDD3229D9AD560E74852FF762F
AEF44B916D5444AAD2B2E4D2E8F24893
F9DD9310584E4F0FA1401F066FEEABD1
730E559E3EBF85DDC5E4785AFC108D59
A254F6E99D57060676D7E27D7FD2C523
E0664E9E7883956A6E3084FD68AA274B
E2ABF58F758941B31BB4630BD519394F
32691653B988011A1D8855300C372CE4
ABB9A6AD029F190506DCF3B87C27E9BC
BFD4EBE156525A32FE1824222EB5FDB3
00802DA458DB2440535C1C3796892482
C6612BDBF9E70C3C8A39B77FFA145CB8
94C7225B71EBBFD33183DD3B59591546
B240CAEDDBC7AEE341900E113CED23DC
0DF6A14F536F6514A6F18BC12A532A82
273A89749418A5955558607B7BB45974
688C1F640EFE5747507270CA7363EC0D
4F34EA13CE343BE6955B67914BD4DF9E
25777661D3D36C3E3656E98F29441CD8
2A43899555261D422AF07565EE51395E
AB714CB216CB456740B54DD82E11FDB9
B529E84EE03C578C7E92CE5836AB1C1D
21DA809CF1B07A7E8D2D73D9030FEEBC
5E272234767505C052A88FAD206933F7
458ED5949D7749672DDC8A8CBC7A45AF
A100243833A4A2AC7041C41B4807F961
5ACF1A6BFE350F7BB661BF389AF7E2F0
0AFE3DE6A443BD660CDD5B1FA36686F6
5E3CBF1204F069C8F4474D492A361CCD
C70D7B092E7900B08A63C36C5D908CD8
21C8516D8DA71E5746CE3C9F1CF61C32
0FDAC2A4A154F9E946D749BFE67B1FCD
45028CA4ED6D9709B55F50CF82E88B3C
7FA1A5B3B4CFDA6EE43060AEE7DDD9B9
7555C0DCEAF5B37E48F328B269DE5CD9
B0D104EE63ABB85675B078664B5924A8
D85672E8322401603F6706560AAFACA7
7439CA3E049F434742CB5C63A55FC24D
DE83C52DBCD401E9FCEE79F25A63B3E7
81A07F200581534596EAE948BDEE015E
1124EFE951E4EE78CFFDDCB080C0E48A
9B3B7AB4B77B74807ED37CD63DE0624E
01A2CCF65B4BB5DF87B1F9177616C5AF
191D3EAE9DFA341F8D8CC5DC8BDD1D80
5C4773A411EA7DA0CE90122B51F37E5D
00676A8589DE5A948F2FFCBFCA568E50
F9F7DDA79A4265363A0B0B361C197338
7746132EFF1AE873A93DD6520B7D43F2
3CD1DEB660E64A41BA76E124B1C0103F
7CC61FB109657777ADD59480BC290F29
AA9C5876D7EB769A269380558FEE0C6E
38C4E3FBD09FA68179F2DE3F133D942D
06CA59D82946D37E6ACDD0EF9A19B8CB
FF845C3FA64B4020EF5272852ABC11CC
AEAA78A175DF8EC1874201A0F5B0E651
6040FA99B7E38468A771643D0702322F
9C4FD2B8EFBE7F68A56C522FF0C52491
5C17C05950C71938CFA82EA7C517748B
817263174EAD24B45AE311E4B5D339EB
C3CF8D010A218064A32EC45C3F446B2E
9521F610DD97622967149844C7CB029E
59FBC4CB04E905D3C1E7548C67392E1A
1845E883F5E20391CD3BD68F488A3C5E
BBC2EEB75E601743F13AF88E06F80659
72FC15A9C0E3262CFCF42B619ECF3774
AED716F2A571507087AF004F331D9949
9BCF204FEB7332261F870DE9EAD57DCC
EBC93C4A364F6830FECB16C6482F0D58
FEEAEF16683900608922225433583714
24B74996895DBBFE033044C0D0088766
918AB13390C2B040E4B0D5086EBF3349
89414B24EED890A8B14119C52A56AC5F
5A44D0AF57DD95C0F5301649B7A23509
196CDAC439AE9EB9B70F6868A05FAD3D
501ED1D90DFFE96E802854A6364809BB
B8C8015FECAD94364B76E74CA9C1A946
6B41B995AAB96DF47E8B522BBD2358C3
57036430EAE106C2B00D97400191304B
12225CC7E9BF710AB6AD6EE9DE761259
27A574ADFE1884A1F60965FE0A2F8C6C
891646F131CE2CCADB5D6676A104CB9D
02BDEEED9EC58C4DF3E3808CFF51C484
E5DFF57F779B2CC4C2C96EEDEB665ACC
0ADCAB98C7686603278BCDD71FE16CC8
A934DACA2D665AA46C5B136AFD32EEBB
2201BA84231D7CC8147F47074DF99E1F
6795CE3FC3D5319BEFFE39428A456919
Query:
-- 2. Get installation dates for users who installed during August and September 2018
SELECT DISTINCT `user_pseudo_id`, DATE(TIMESTAMP_MICROS(`user_first_touch_timestamp`)) AS install_date
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20180930'
  AND DATE(TIMESTAMP_MICROS(`user_first_touch_timestamp`)) BETWEEN '2018-08-01' AND '2018-09-30'
LIMIT 100;
Answer:
user_pseudo_id,install_date
383F4B98EC31DD2A915427D36A30354E,2018-08-05
1608F85B710EC4AE0024BB8A1C339071,2018-08-10
89C1D9AF4193728E41F48DC623DEE51F,2018-08-04
811898C76CEDFA57991289FAC0C1A004,2018-08-10
665B1505AECAE3569C2B0FED30223A3D,2018-08-10
3D7382CF3E5091189D2961E0EA3A2ACE,2018-08-07
8479882D86055C6A33EA8ED16B94C30F,2018-08-08
952593544FF78585E08BCBD1E858B570,2018-08-10
E3766F65834BCE7AA781B3B641314E82,2018-08-10
336FED02BA10D201C1B88C1CECB2E9D1,2018-08-09
99C532E3C3875B528AFF60A995C8197D,2018-08-07
3CD1DEB660E64A41BA76E124B1C0103F,2018-08-04
C79C76E03BB4638BDAF2C31322F7B160,2018-08-11
8D86121A671969882C35F9E4C325EECE,2018-08-10
AFF1262CCD472757FC92B2A93C75CD81,2018-08-11
310228A29216613C01B08D8B37AA21E1,2018-08-30
F6F73677A4E6A0F7AACEE96107700035,2018-09-08
D4DDA67EF184AFBC5E2D52FBDEDD7837,2018-08-11
4549717C06BAFE84FB1FFE5DDBD7EB2E,2018-09-09
AE257B45A80D36AAE84F28E46DBF6644,2018-09-09
96685CED0793A219EFE8976477D7DA56,2018-09-05
A135A27E4373605B2EB6E48DCA05720A,2018-08-26
A677442E9D284590F976180D77E3DE84,2018-08-22
6E596EA31C1209D9F775EE90E40CDB29,2018-09-11
0B63D33B5B2251B42D4237903F07FB6C,2018-09-10
A645F59DABBD8ED670286DCF716EBF47,2018-08-11
431104D44BC343ADB59D5881CA18A904,2018-08-07
0E799E05DE124310257B263EF3556AD0,2018-09-10
FBE5BE5E3836527EC27D14834D72B911,2018-09-03
801D5C2787FB2911F810418022C1CD56,2018-09-10
5F5BDACD88C832FAD2E2AC9C20B008C1,2018-09-10
A62611DA6D4B45AC3DB2450BF3A24C23,2018-08-31
D88929586E5166ACCF1A6F037A2DB293,2018-09-10
13384203033F4AA0BF7DF21547E04578,2018-08-05
AED41960DDA933F8914955C5EF2A852E,2018-09-04
F40390B3966B0F225C46E00B78F9886D,2018-09-11
6A9D932B71F94BBFD5BA8A1B5D48903C,2018-08-23
050231DF01854EFA691E0D5F4DB9ADB2,2018-09-01
93DA73B120BE64477ED6F5EDB6D014DB,2018-09-09
0458C336714B6986CD8BF62F5B7FA382,2018-09-09
5FFBFE051291F79717B99F5D72B02CDC,2018-08-01
5BFDC0426DE9C09CA5FF18E4982F2506,2018-08-07
B7D2B63ABE215157570ABD2E2E6EC9BE,2018-08-03
56A069E37C273BE2092ADEB0D527D9B3,2018-08-06
F314B55E64BF801420642F189A3F408A,2018-08-06
EF7772819E807EDBD8DB0F0B5210030E,2018-08-01
3D7CFE25BCB531BCDE2E25BE5D8526FB,2018-08-08
8FE3582D9BA2520A7DBE106334280C58,2018-08-07
F3B0F2F150A1D91E15BB07FACD1EFC89,2018-08-05
79F6D4E6174818E127A589E96D3BB371,2018-08-08
81D5B7A398025886388342CE7159C9C3,2018-08-07
D2AD0448EFF5028698BB4FE8E22256EA,2018-08-08
Query:
-- 3. List events for users within 7 days after installation
SELECT `user_pseudo_id`, `event_name`, TIMESTAMP_MICROS(`event_timestamp`) AS event_time
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) BETWEEN TIMESTAMP_MICROS(`user_first_touch_timestamp`)
    AND TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
LIMIT 100;
Answer:
user_pseudo_id,event_name,event_time
486D0900B48B18D315367260129BFFB6,user_engagement,2018-09-23 01:57:08.464000+00:00
B31FAF033014AD1356CAC0542C141057,session_start,2018-09-22 13:48:44.180000+00:00
B31FAF033014AD1356CAC0542C141057,level_complete,2018-09-22 13:49:16.971000+00:00
B31FAF033014AD1356CAC0542C141057,level_up,2018-09-22 13:48:27.971001+00:00
B31FAF033014AD1356CAC0542C141057,screen_view,2018-09-22 13:47:43.102001+00:00
B31FAF033014AD1356CAC0542C141057,screen_view,2018-09-22 13:47:32.094005+00:00
B31FAF033014AD1356CAC0542C141057,screen_view,2018-09-22 13:48:23.116006+00:00
B31FAF033014AD1356CAC0542C141057,screen_view,2018-09-22 13:48:24.461009+00:00
B31FAF033014AD1356CAC0542C141057,screen_view,2018-09-22 13:47:49.483010+00:00
B31FAF033014AD1356CAC0542C141057,screen_view,2018-09-22 13:48:31.059004+00:00
B31FAF033014AD1356CAC0542C141057,screen_view,2018-09-22 13:49:30.076005+00:00
B31FAF033014AD1356CAC0542C141057,screen_view,2018-09-22 13:48:27.378009+00:00
B31FAF033014AD1356CAC0542C141057,post_score,2018-09-22 13:48:12.971003+00:00
B31FAF033014AD1356CAC0542C141057,screen_view,2018-09-22 13:48:45.998000+00:00
B31FAF033014AD1356CAC0542C141057,level_start,2018-09-22 13:48:05.459011+00:00
B31FAF033014AD1356CAC0542C141057,level_end,2018-09-22 13:48:06.971002+00:00
B31FAF033014AD1356CAC0542C141057,level_retry,2018-09-22 13:48:49.324008+00:00
B31FAF033014AD1356CAC0542C141057,level_start,2018-09-22 13:48:08.355011+00:00
B31FAF033014AD1356CAC0542C141057,select_content,2018-09-22 13:47:37.039003+00:00
B31FAF033014AD1356CAC0542C141057,select_content,2018-09-22 13:48:37.385007+00:00
B31FAF033014AD1356CAC0542C141057,user_engagement,2018-09-22 13:48:27.072004+00:00
B31FAF033014AD1356CAC0542C141057,user_engagement,2018-09-22 13:47:32.417008+00:00
B31FAF033014AD1356CAC0542C141057,user_engagement,2018-09-22 13:48:27.023006+00:00
B31FAF033014AD1356CAC0542C141057,user_engagement,2018-09-22 13:49:09.331007+00:00
B31FAF033014AD1356CAC0542C141057,user_engagement,2018-09-22 13:48:51.213013+00:00
486D0900B48B18D315367260129BFFB6,session_start,2018-09-22 16:53:48.834000+00:00
486D0900B48B18D315367260129BFFB6,app_exception,2018-09-22 16:56:50.950026+00:00
486D0900B48B18D315367260129BFFB6,app_exception,2018-09-22 16:58:44.419013+00:00
Query:
-- 4. List users who have events beyond 7 days after installation
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) > TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
LIMIT 100;
Answer:
user_pseudo_id
FC55032FC8C06EB1A1220D1ABD1164C9
4BB019F8F6D1FE7BA78CA42A4698EF56
2D644942A18A482A9AD370DA9F38B709
3DC258E32531148709A4BF575C0F076E
B99FD965B0874192EE94E8A8FE85EA9E
7E40E634997585B0C69B6F67C01C191B
E6FEE8B98E75EA5311FE004F98559A27
6CD2676098B3E076AD66D10BF4565BFA
FA30269453141794E79B8F15EE0BA5B9
AC978F51AA488D36AC372688F0E803E2
BE36C49B1AB3968D420923AEC4FDD7AE
89BD2B0E233951461CF06C9B4FDA0D81
418C1FE4FF01EA36F511E5D9073F11BD
D5F9D9AF22EF5073E10342973D48FB2C
A232A112349100CF520C1B717217EA99
B49D910719C2E687FA278E5E0AFE74C1
53866E32BA0ABFD846772D4B7B9B5921
42E6A7C3536775E3B8C3DB919AE9A452
FFA9AE78B23263835F8AAED57713EBE9
3875A92B5F5C2BBA1355CED06A986079
197AF7AF510DCB8AB8F42F87057F99C4
19AB27B8A0F2C7C738683CA2F5FFEBE1
19DEEA6B15B314DB0ED2A4936959D8F9
0CAAA1B6F161BA4D363EB7A2DEF64A08
B5395F8C2077B59B3D6C5719C0CA0339
A19F659EA9BA36A3595F088F30A6B7E7
E2216EDD73FE4AE219043A46F0EE9003
CF2439F24FF3E5C1B14DAE41335E2FEA
7A24963AB998AC045AF363D6DDE7F169
75F979DE60C91A6631485A88457C108E
B8B62795AD07E431D8565555C6882EA3
841A68D5D1F94857BEB64225193B2432
DE3F49561A3E21ED2C9CC518F564961E
F2ACDC8D64D4218BA63EB8732C110BA5
D9AA0EC27AF47514DDB5C664A6EF758A
5DA9B8E6D16C68613B3C805D9E449623
D4498C9FB447D7127B04ED7810C32D9F
9C8494CDC3107F7BE54CCF3E820252D6
7F089F4710219060252DB2AEF508A662
6EC263DBA95206A1A9EB55CD93F58FD2
A3CDDBDA41C8290EF828C2DCE98B346B
014693E9CD0C8BEC15597BBF730E0A75
BB29F8B0FF330F326605FA421BB37BC1
F866B1D9D660101FF4C436E5D93D2C08
71F005E58FCF825DFF3DFBC29FC806F1
6531C074EA6897B52557F141AB2FD77A
396CD60DADAB9CBA7DDCAF239B477135
C1327B694B124442335CFFD6FD3B15EC
A66F392F752B3A59F2644F4158644FF1
48FFB36AFFB051EC56910335F81BB3C6
E7CCB643C1D0028BF305EDD85397255E
F655D26B0F7A4093F1D2FFBD5E61B09D
5269565AB96D3D27ADEA4D7EF4DC2A88
8EFA45B60DF34986EDC7C7CC0CD7CD69
C1A0D9FB3527654CA715A732B5FB5202
31017A05A48B25FED4834F968D5D0F83
8DC5189969449E1BF8588B3EA64974A1
FAEA82CB9B0515460B95BC9F02B6E110
75120F32A68A6C4FB643349E125D8C31
28C4A09298C441D5AFD39E749D9F3DA3
AD99B4950F9D70E0FD5E8563F2A664FB
74EFA3B9E98982CB94246D7F95DF29D0
0E10123B79C73F4F30CC49462652D604
55F9FB7C14AA4BAB066EA326D4A2221B
5E9B9E20975EF45745B511D401456619
80F152611EE983C7ED2200A2233684C1
8581D07F873789998E8929C212D70CA4
E1A3C786B2E4D56629EE808A3A174995
6095502F2573E3B246D9297314490E87
295D9E24D8DE65A010313E667131EF19
29BC86DCA0D500C9410F392B57C28DD3
BE46B64DFFEE5B00F197D666EB57E781
0D6A346C85BF606BE12F9A70FC20A7B7
9E63A50ABB7C292735533D3308161DBD
06620D97BAC22D30DDE66F80BC5E7EA3
C679FF00E17790E7E16AB903212EE05C
263C111D407C5E17AC6310581C3B9255
717914316B7E4BD629C168B3A05634DC
9A48089B85BC2C1F630A2DDE3B200F83
64EA802089E68A699EC86438C9504F94
5E9BF00B469B284E028094EA15A9F1FE
CF41EE09246399E27F5D78EBB3FA02EA
8A967B0EBC5488B83E64805029677B66
EA35FE295A7C1F8F67836AEB608CEBBD
ED90CC7C8BC768DBF3B8B87A75422721
FE57ACE9DC234A25BDAD9CD6BC190B83
E371044DC93C1A7AF36C2B7A76E8CD16
826D755FFE3C52017D944D3330309379
E0664E9E7883956A6E3084FD68AA274B
B529E84EE03C578C7E92CE5836AB1C1D
C14A95DFD8457015BFFCBAF2431EAFCF
F1A4ACA5337DF6B0DAE14420BC457CE3
6C7CED4AEF652AC9A7009008F1DC5211
Query:
-- 5. Count of events per user within 7 days after installation
SELECT `user_pseudo_id`, COUNT(*) AS event_count
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) BETWEEN TIMESTAMP_MICROS(`user_first_touch_timestamp`)
    AND TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
GROUP BY `user_pseudo_id`
LIMIT 100;
Answer:
user_pseudo_id,event_count
4A8D4276A1EBBD17E6CB7EE30FE71CC2,125
9AFF07DCC4DC8276854BC916473FEDDA,777
7F8E0A83EA3833F063DA2107E073AC03,9
ED5C290C8F82C28C033482D31299D8CD,30
359A34F575B808FEFE58BC5B40816F09,649
C6D97C0D6DA580A6FDB44BB2C3015A85,155
F7164A70962E5AED09AD0CEB0A3C7C82,117
1C9927831BAA7A0569130EADD6320C69,303
D4BE9C6F73E39CCE4ED1901AF98A9E3A,8
814700C58B117F7ABFFB1145B9C29D29,419
005F127942F3FD25588272950FDFD339,3
8EC69D56A1BBBE4F2691746E39B8756D,668
BB322D2CA948F548EA3A05A2BD93B1A3,449
57EC50FBC6C7277B8EDCCE44C1352BD4,14998
383F4B98EC31DD2A915427D36A30354E,719
1D89281562AC3FEFB76A42ED406BF1B5,20
019FCC6C080A33E9B697CAA476C4156E,261
B2884EF528224A5E0631D23868603057,24
F720D2FE0350DA0E19A729BE9A4B73FB,33
434B79A24E73A32E488354A1AAD98495,167
FDFBC68590B06B23FACCF2DE6A0FEAD7,103
370BAFBB7AFD77B12726F4712DB42DF8,122
63FEF9F33B5B4155C207095EBA23730A,998
E3DB69E48378F1EED6C064C7614AACAB,4
F3A2F44C99758CC6006BFE28AC78EBFE,95
093E3E8BB59252BCD92BA5B7EAE55BBD,200
E8EF9920D6437CA7E5AEAF580FFBD26D,81
13F080023BC02C4DC81CF648D346DA49,2
65A5F4580F975A3253988138FBAB03AC,21
7E74A2BB6BBF4746DEE15F957B315401,2657
AF06A87FD3FD797F7FA3A44DFC445701,74
50D529BFD3EFEB1C8216DF9A321A552A,705
C1CBEBB972ADB547F2B4B9F3FBB44E38,5
C3E3CDDD1E35362AA59854F8FA511BB0,243
45CB5196EB384766A8EDEFEEF410CC23,60
A62611DA6D4B45AC3DB2450BF3A24C23,109
23FD6C65AB271F4DD5FC2FDEA888032D,1477
0BF28246916A6D54E16290E925B16593,1763
71B1D9279ABC5D66169F2937CFB9DA47,24
9FE14774A6A768A1C1BEBCE0DE0669A5,696
5F221A89D8CA4217F46AEF4C5D9C925E,5
F37600D4287F1C83A90F3A8CE687FAA3,65
4F09BB9CBF9E3C4A742B1D8B42D2E60A,213
D4EC4DAD608E47C043A3A6E659050CE3,45
4ABF69A40A3BC6057CD49D74A6C18AC2,140
72AC12CE2E2F425A2546D18F14B0077A,368
337A3F347AE32CE90A631DF3028500A5,38
1440D2F8CDB64BFAA5621779B8C92571,609
AC86F727F3237AD98B97B536AE6A8035,179
2CC12B6413FBC345930F7B81394B96A6,4
07D1A24DC2164260EEA5FB510C491431,22
857415053FD447A7EDDACD7FB72A8E9E,39
03915D9B9DC76855CC63C18E94C93760,377
AF7F48274AA5128EBCF3698F4FC8F61B,4940
8D76B80E2CCAE0EDD0F2D50D1ABCC0B3,36
3309F4DE80E33A212A45B29D973EBC9C,73
BDD854D198AD34410E91C75C2ED5F525,51
1FEB41A72F244D352EA79982CC259EA0,280
66163D6663552C5C43D3DB1D98FCA9DA,624
F37D0945286059018632F1151EFE1AD3,57
2CCA4395A5281BAC61DD7C846837F50B,709
1608F85B710EC4AE0024BB8A1C339071,1144
B285B6DE14EFCE4E5F460B28881666A3,8
1F58AAA40540B7B531EF090A0669384E,4
D5E0BD50D8A6244443E08E2E71B3739D,318
A2BA4DC59DE828E7FA1A3D2746162D86,61
C40F22701672A6B7AFF9F4F6FBC235EA,442
E98C2033935E43DBA50950F7039FF492,67
D17D42F01E95FAA1D5083EFE4D319503,69
Query:
-- 6. Users who only had events within 7 days after installation and none after
SELECT `user_pseudo_id`
FROM (
  SELECT `user_pseudo_id`,
    MAX(TIMESTAMP_MICROS(`event_timestamp`)) AS last_event_time,
    TIMESTAMP_MICROS(`user_first_touch_timestamp`) AS install_time
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  GROUP BY `user_pseudo_id`, install_time
)
WHERE last_event_time <= install_time + INTERVAL 7 DAY
LIMIT 100;
Answer:
user_pseudo_id
61F5B317AB1EF10E3C7E68C930A1018C
665B1505AECAE3569C2B0FED30223A3D
1808658733660F3EC33CDCC3EC995394
0C0803BC7D87E45A797914F9DAACD364
952593544FF78585E08BCBD1E858B570
E3766F65834BCE7AA781B3B641314E82
36D35160F560D4FE9D1B0E48063F3665
55F725AB1CC8281CDAC2FFEDC35423F4
C337446FADC0FB49C18BB3C9C86339B6
98001421668C25D7C0B41F550C53D949
5DD61074AA5F92DE0CE1F00516BFDBF5
0A0B3A969C027FAED144D9E15F0A2375
B0B8369C7B317332A28A914D018BD475
F488B4536BA104FE39ED63F2D4959B9C
3BCAC13975252993F0225A6408781512
40B409D2F011F83053D8E40B6EACBD92
00B13A0B8C9E83965F9395EA745D98F2
8875E076B50263771FFC844ED47A12AC
ADBF591A2A1DE60915F718F8FD6ED4C1
E63C6A09F5D06DBFA6FBF832AE8997BE
0811766182AB8CE075D0E653F8B79E05
B862FC7AE439EF77BEF67082070EFB78
8F1879A37D4A45B618D310F69BCFFAEE
E93281A256FC37DDA502B64B6E210282
DB8FF95DA0346459D3EF59D5142D9ECA
C259024130B11594A8BC902098A8C6A4
989D5092D062D1B432BEB9C618B21431
B65315819D817477B810CA2370FB5935
7F12F87E29E894031F904B8BCA1BC05F
7705D52DD2286DC2E6DB831A2E129E94
1CF4635F6034EB147F361912D5F73268
9434EE4CFDFE0F5BCFE40126A569F3BB
07D5951C19A83B2CB9C8BA9319B5A9FD
EC8A980198BB3331B3088F123019D1B9
B3234CECCA15CEE80BDE39DA9D8AE687
801D5C2787FB2911F810418022C1CD56
F0AC931DD49207C2ABADA1AE09FC27EC
A21FA27B87923DDDF416E3B7F7EC47AB
B2EB23C3BE3D6036CCEFD2747E51E872
0AFF9E84E0311BC3CEB3AF2358D70B4D
79352792B72C3FF7BBC40ACFE7235AFE
83D42C0BEC5C0325916E5797073CEE9A
5B64EFC31A1378A17ABFFAD603A2E1B4
4B0E55D94CB208CC6A4B0F5A86032D41
6D5E557789275879745EB60D8AA53498
723B27DABF02945DAFCDE7843622D8E8
A25F3BC7C453989DF4127EEAD4F3FDC6
C83DB20A4364A88C81A58AC7B47EC995
7197BEF5542521683ED1B58EDB184770
CF77B186B6800C045AAB1496A019B4E9
E61A380E8D23814F4247CF6D2E11F13A
C60030D930B4915AE9974309F8C32C92
92BA07C5AF1103CDD804CDA9F7199B95
82E19322741E476045ECAE2EB0AEBC5B
7EDFFF7CB9DB49F6C61708EEBA33A32D
847C41413ECD9C277B4896E786340891
735D0773BF0193D26BA48A56D1C69CAB
D03DB5B7CD510FC8309C5681588A7C8B
3A66B71F62FBDEF60DED96B73BA783A8
8C1CB07E72786B08197308216F1A43B4
707C0AFA81F8D488E330273B62D3C26F
CED40D58D49739D575C4FE563CF079D6
D84C3BFD237D79D5FA1A8189F7DC6845
93ABDBDD5D7852AE62B0448B1B5E73AB
17A6B18F52178D4C258DEDC5CDB93F3E
3D9CD866FA73F2327C3B63DF16A477D9
E257276F0588FCD48CDBB90133C335E2
60597897170A939505105BF1863E9E4E
ACDEFD8D3F601128F8B6B55256028E1C
814700C58B117F7ABFFB1145B9C29D29
AA287C3266DB6069B75DCBB51006D808
B16AA0715E1721E18F4B9316E4A0B3E1
AF0D4AA31F5CC6DADA427AAEA0B7FD2A
CA37F774EBF501D06CF14866877A2EA3
39E4645E037720D29EDE6A424C8B7AF7
C59E095CFA4F1A81AAAE3150E384AB21
2D23CD90AE51556D7B8FAD2C358D308A
AE5C3CFC7F5F1225DC2E5190DF8CE3E6
4DB647101091FF7904FF733D992443B5
F3B0F2F150A1D91E15BB07FACD1EFC89
945743E3AC497529EFF0081BC6FC0931
942E123C7E8C0B62935889D03D77BE8E
19856982238BAE6AF8C9AEBFE3D77A48
3B8B6295198F4D19C6FDCCC61D9A76C2
977C7813C0DE5EB1BB6FB362DF190D99
C08E0DCBBC8F969D51C14B0E479EA9FA
0327DBE89EBE6C41E1D85E7EA1C29062
4BAD26C68B3F0EC7F290D5160E16AB16
82C4C434811FFE6491CD496EFEA96382
6344D6DD4B7741E868D17A8CC19E03C8
7D87123EF025F4B3A92359C10CBD8039
F108523E7DD7905608275CC84287B217
71AAE70AC95236B7ADF665241789A2DB
Query:
-- 7. Events occurring more than 7 days after installation
SELECT `user_pseudo_id`, `event_name`, TIMESTAMP_MICROS(`event_timestamp`) AS event_time
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) > TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
LIMIT 100;
Answer:
user_pseudo_id,event_name,event_time
817C3E590030EB56A11A38D56919B6C5,session_start,2018-09-05 21:19:36.439000+00:00
817C3E590030EB56A11A38D56919B6C5,session_start,2018-09-05 22:38:53.015000+00:00
817C3E590030EB56A11A38D56919B6C5,level_complete_quickplay,2018-09-05 22:41:15.887008+00:00
817C3E590030EB56A11A38D56919B6C5,screen_view,2018-09-05 22:41:55.748012+00:00
817C3E590030EB56A11A38D56919B6C5,screen_view,2018-09-05 22:41:20.773013+00:00
817C3E590030EB56A11A38D56919B6C5,screen_view,2018-09-05 22:42:27.687014+00:00
817C3E590030EB56A11A38D56919B6C5,post_score,2018-09-05 22:42:04.888010+00:00
817C3E590030EB56A11A38D56919B6C5,screen_view,2018-09-05 21:20:39.133000+00:00
817C3E590030EB56A11A38D56919B6C5,level_start_quickplay,2018-09-05 21:19:20.140002+00:00
817C3E590030EB56A11A38D56919B6C5,level_reset_quickplay,2018-09-05 21:19:41.300000+00:00
817C3E590030EB56A11A38D56919B6C5,level_start_quickplay,2018-09-05 21:20:34.304001+00:00
817C3E590030EB56A11A38D56919B6C5,level_reset_quickplay,2018-09-05 21:22:19.721002+00:00
817C3E590030EB56A11A38D56919B6C5,level_start_quickplay,2018-09-05 21:23:03.725003+00:00
817C3E590030EB56A11A38D56919B6C5,level_reset_quickplay,2018-09-05 22:38:56.951002+00:00
817C3E590030EB56A11A38D56919B6C5,level_start_quickplay,2018-09-05 22:39:24.957003+00:00
817C3E590030EB56A11A38D56919B6C5,level_reset_quickplay,2018-09-05 22:38:35.503004+00:00
817C3E590030EB56A11A38D56919B6C5,level_start_quickplay,2018-09-05 22:38:36.506005+00:00
817C3E590030EB56A11A38D56919B6C5,level_end_quickplay,2018-09-05 22:41:23.888009+00:00
817C3E590030EB56A11A38D56919B6C5,level_start_quickplay,2018-09-05 22:41:09.684015+00:00
817C3E590030EB56A11A38D56919B6C5,user_engagement,2018-09-05 21:01:27.816005+00:00
817C3E590030EB56A11A38D56919B6C5,user_engagement,2018-09-05 21:22:02.943004+00:00
817C3E590030EB56A11A38D56919B6C5,user_engagement,2018-09-05 21:23:48.340007+00:00
817C3E590030EB56A11A38D56919B6C5,user_engagement,2018-09-05 22:42:22.723011+00:00
817C3E590030EB56A11A38D56919B6C5,user_engagement,2018-09-05 22:43:46.137017+00:00
9F7B0D1BFB822F5E26E91E184E2E437C,session_start,2018-09-05 07:42:19.406000+00:00
9F7B0D1BFB822F5E26E91E184E2E437C,screen_view,2018-09-05 07:42:39.405001+00:00
9F7B0D1BFB822F5E26E91E184E2E437C,screen_view,2018-09-05 07:42:31.291000+00:00
9F7B0D1BFB822F5E26E91E184E2E437C,user_engagement,2018-09-05 07:42:01.624004+00:00
Query:
-- 8. Number of users who did not have any event after 7 days of installation
SELECT COUNT(*) AS user_count
FROM (
  SELECT `user_pseudo_id`,
    MAX(TIMESTAMP_MICROS(`event_timestamp`)) AS last_event_time,
    TIMESTAMP_MICROS(`user_first_touch_timestamp`) AS install_time
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  GROUP BY `user_pseudo_id`, install_time
)
WHERE last_event_time <= install_time + INTERVAL 7 DAY
LIMIT 100;
Answer:
user_count
2493
Query:
-- 9. List of event names and their counts beyond 7 days after installation
SELECT `event_name`, COUNT(*) AS event_count
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) > TIMESTAMP_MICROS(`user_first_touch_timestamp`) + INTERVAL 7 DAY
GROUP BY `event_name`
ORDER BY event_count DESC
LIMIT 100;
Answer:
event_name,event_count
screen_view,1129091
user_engagement,596857
level_start_quickplay,252034
level_end_quickplay,170626
post_score,114437
level_complete_quickplay,106714
level_fail_quickplay,63899
level_reset_quickplay,58489
select_content,47622
session_start,35866
level_start,15306
level_retry_quickplay,13272
level_end,11204
level_retry,8467
level_up,7719
level_complete,7526
level_fail,3485
spend_virtual_currency,3119
use_extra_steps,2997
app_exception,2459
os_update,1537
level_reset,1337
app_update,1077
error,990
no_more_extra_steps,871
ad_reward,729
app_remove,621
completed_5_levels,368
firebase_campaign,226
challenge_a_friend,138
first_open,9
app_clear_data,7
in_app_purchase,5
Query:
-- 10. List users with their total number of events after installation
SELECT `user_pseudo_id`, COUNT(*) AS total_events
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
  AND TIMESTAMP_MICROS(`event_timestamp`) >= TIMESTAMP_MICROS(`user_first_touch_timestamp`)
GROUP BY `user_pseudo_id`
LIMIT 100;
Answer:
user_pseudo_id,total_events
295D9E24D8DE65A010313E667131EF19,12266
F9BE4FD7C6FE584C111EC4F3474B01AA,22
C7DD86F06FD4AA8A0967E27E20750FCD,205
FA30269453141794E79B8F15EE0BA5B9,6456
0A26E7281EC31038AD42F28C930FFF90,3243
BE36C49B1AB3968D420923AEC4FDD7AE,1372
E5AFF3DE508996512D61B49A63D1D063,263
5145D8121071A9EA903A1098034962F6,1449
A0EDEFE9E2CC092F97266CDF9DB5830F,34
F0186BDA8E7BF76675999CFDCFB10F6B,180
E41F819718B0E2C49D347493BFACA027,4
418C1FE4FF01EA36F511E5D9073F11BD,3930
1E6348F7A97962E7EAA87C7FF638569F,1331
59BE43F3FE7AB3F91B016B56508D4C46,1020
3875A92B5F5C2BBA1355CED06A986079,41896
51AE09760820E12217697F7007D6C78B,164
12225CC7E9BF710AB6AD6EE9DE761259,905
C98FE4C10160A105798C65E6AA160974,38
0E65A1967A3EE64A4D33E6038D677FAD,7
B5395F8C2077B59B3D6C5719C0CA0339,14299
A4442ED82DBC31EB300EE7BD825C85E1,9
27293EA0B2F41A672E15EF7B1FA21298,111
289F2AE59FE48FFF6DD12D0AB553C14E,563
0A9D7004114F34B9CD49538E173E01A7,247
AC31184536F28AD520C398EC582A3537,262
C8FDED9EDFF7241123AA2FDEC0E84238,35
B8C8015FECAD94364B76E74CA9C1A946,223
6B41B995AAB96DF47E8B522BBD2358C3,190
749D1C8A698B9549D1E4CEAD631A4610,659
6158C7CD861E2F83D6AA22CCF92AEE97,88
86CA1B6FDD0C4D4DF2B34DB3615134C7,37
E90A8FDA1D41057AAB8A72644731B422,17
36390262EE0C669101AD7ACFE181689C,533
7ED8C235689771F6B0F29BBF295A346F,1385
27A574ADFE1884A1F60965FE0A2F8C6C,212
717914316B7E4BD629C168B3A05634DC,636
329041D331D6165A7AB15EA5D452A8E6,257
B711923F02FB2923F0A4DBC8CA2CE3AD,505
93C5C5EEACDB9F83DD795449363339E2,301
EB96D4E588761A891B492920DB8CDC25,603
891646F131CE2CCADB5D6676A104CB9D,99
152C2738DCE249CB59AC64A3C7EDC918,38
BFD4EBE156525A32FE1824222EB5FDB3,200
915283C2BCF30F60C78E1B0791E47FA8,11
8131D03808054C6791B7DBDD01CD4CA8,15
A62CD597E76D7FC17D8BEA76BC613AFA,4
84B38C413A7F3C683BCC6CBCCA246FBE,44
C3FCDF18C57A6F16E5EE6867CA6679E1,1272
AED41960DDA933F8914955C5EF2A852E,1249
51FB83B864E295B2E3961F703F37C945,154
5C9E7451F0D78507AB638C4C98D0F7D5,155
8A9F6BCE5D510942A986330594E32D81,292
E7CCB643C1D0028BF305EDD85397255E,490
F655D26B0F7A4093F1D2FFBD5E61B09D,4750
711364F41553811B33FD216391234D59,735
31D5069785D55AD5A7059983946A8959,3
A51BF75239709A5494645BEAABC3453D,3841
E98AFA6BD0908A7BDF0FE75396B204DD,622
7FB0FA98A8949CD6D75B48C449DAE33B,359
21DCA7DC9C0479FEE7081E05188B6258,216
E0664E9E7883956A6E3084FD68AA274B,44978
2201BA84231D7CC8147F47074DF99E1F,1003
859BD5756C9635B9A657B90A7265679A,8175
8BE78CDB3DC97B9022E260222059E3CF,4
8876B3BBA28536588C22FEB683454240,101
690CE4729AC49CA52E5669DF0B426535,57
8C33815E0A269B776AAB4B60A4F7BC63,1757
End Exploring Related Columns
Task: Could you determine what percentage of users either did not uninstall our app within seven days or never uninstalled it after installing during August and September 2018?

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
Percentage_of_users
value:0<=float<=100
(Attention: answer in one row)
```

To determine the percentage of users who either did not uninstall the app within seven days or never uninstalled it after installing during August and September 2018, we would analyze the user activity data in the `events_YYYYMMDD` tables for those months. By identifying users who installed the app during that period and tracking their uninstall events within seven days, we can calculate the required percentage..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180612', 'events_20180613', 'events_20180614', 'events_20180615', 'events_20180616', 'events_20180617', 'events_20180618', 'events_20180619', 'events_20180620', 'events_20180621', 'events_20180622', 'events_20180623', 'events_20180624', 'events_20180625', 'events_20180626', 'events_20180627', 'events_20180628', 'events_20180629', 'events_20180630', 'events_20180701', 'events_20180702', 'events_20180703', 'events_20180704', 'events_20180705', 'events_20180706', 'events_20180707', 'events_20180708', 'events_20180709', 'events_20180710', 'events_20180711', 'events_20180712', 'events_20180713', 'events_20180714', 'events_20180715', 'events_20180716', 'events_20180717', 'events_20180718', 'events_20180719', 'events_20180720', 'events_20180721', 'events_20180722', 'events_20180723', 'events_20180724', 'events_20180725', 'events_20180726', 'events_20180727', 'events_20180728', 'events_20180729', 'events_20180730', 'events_20180731', 'events_20180801', 'events_20180802', 'events_20180803', 'events_20180804', 'events_20180805', 'events_20180806', 'events_20180807', 'events_20180808', 'events_20180809', 'events_20180810', 'events_20180811', 'events_20180812', 'events_20180813', 'events_20180814', 'events_20180815', 'events_20180816', 'events_20180817', 'events_20180818', 'events_20180819', 'events_20180820', 'events_20180821', 'events_20180822', 'events_20180823', 'events_20180824', 'events_20180825', 'events_20180826', 'events_20180827', 'events_20180828', 'events_20180829', 'events_20180830', 'events_20180831', 'events_20180901', 'events_20180902', 'events_20180903', 'events_20180904', 'events_20180905', 'events_20180906', 'events_20180907', 'events_20180908', 'events_20180909', 'events_20180910', 'events_20180911', 'events_20180912', 'events_20180913', 'events_20180914', 'events_20180915', 'events_20180916', 'events_20180917', 'events_20180918', 'events_20180919', 'events_20180920', 'events_20180921', 'events_20180922', 'events_20180923', 'events_20180924', 'events_20180925', 'events_20180926', 'events_20180927', 'events_20180928', 'events_20180929', 'events_20180930', 'events_20181001', 'events_20181002', 'events_20181003']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-29 23:56:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-29 23:56:17 - root - INFO - ```sql
SELECT
  ((COUNT(DISTINCT installs.`user_pseudo_id`) - COUNT(DISTINCT uninstalls.`user_pseudo_id`)) * 100.0 / COUNT(DISTINCT installs.`user_pseudo_id`)) AS Percentage_of_users
FROM (
  SELECT DISTINCT `user_pseudo_id`, TIMESTAMP_MICROS(`user_first_touch_timestamp`) AS install_time
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE
    DATE(TIMESTAMP_MICROS(`user_first_touch_timestamp`)) BETWEEN '2018-08-01' AND '2018-09-30'
    AND `_TABLE_SUFFIX` BETWEEN '20180801' AND '20180930'
) AS installs
LEFT JOIN (
  SELECT DISTINCT e.`user_pseudo_id`
  FROM (
    SELECT DISTINCT `user_pseudo_id`, TIMESTAMP_MICROS(`user_first_touch_timestamp`) AS install_time
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE
      DATE(TIMESTAMP_MICROS(`user_first_touch_timestamp`)) BETWEEN '2018-08-01' AND '2018-09-30'
      AND `_TABLE_SUFFIX` BETWEEN '20180801' AND '20180930'
  ) AS i
  JOIN `firebase-public-project.analytics_153293282.events_*` AS e
    ON i.`user_pseudo_id` = e.`user_pseudo_id`
    AND e.`event_name` = 'app_remove'
    AND `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
    AND TIMESTAMP_MICROS(e.`event_timestamp`) <= i.install_time + INTERVAL 7 DAY
) AS uninstalls
  ON installs.`user_pseudo_id` = uninstalls.`user_pseudo_id`;
```
2025-01-29 23:56:21 - root - INFO - itercount: 1
2025-01-29 23:56:21 - root - INFO - 0
2025-01-29 23:56:21 - root - INFO - results: 
Percentage_of_users
74.78314745972739


2025-01-29 23:56:21 - root - INFO - Please check the answer again by reviewing Could you determine what percentage of users either did not uninstall our app within seven days or never uninstalled it after installing during August and September 2018?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Percentage_of_users
value:0<=float<=100
(Attention: answer in one row)
```

To determine the percentage of users who either did not uninstall the app within seven days or never uninstalled it after installing during August and September 2018, we would analyze the user activity data in the `events_YYYYMMDD` tables for those months. By identifying users who installed the app during that period and tracking their uninstall events within seven days, we can calculate the required percentage. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Percentage_of_users
74.78314745972739
Current sql:
SELECT
  ((COUNT(DISTINCT installs.`user_pseudo_id`) - COUNT(DISTINCT uninstalls.`user_pseudo_id`)) * 100.0 / COUNT(DISTINCT installs.`user_pseudo_id`)) AS Percentage_of_users
FROM (
  SELECT DISTINCT `user_pseudo_id`, TIMESTAMP_MICROS(`user_first_touch_timestamp`) AS install_time
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE
    DATE(TIMESTAMP_MICROS(`user_first_touch_timestamp`)) BETWEEN '2018-08-01' AND '2018-09-30'
    AND `_TABLE_SUFFIX` BETWEEN '20180801' AND '20180930'
) AS installs
LEFT JOIN (
  SELECT DISTINCT e.`user_pseudo_id`
  FROM (
    SELECT DISTINCT `user_pseudo_id`, TIMESTAMP_MICROS(`user_first_touch_timestamp`) AS install_time
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE
      DATE(TIMESTAMP_MICROS(`user_first_touch_timestamp`)) BETWEEN '2018-08-01' AND '2018-09-30'
      AND `_TABLE_SUFFIX` BETWEEN '20180801' AND '20180930'
  ) AS i
  JOIN `firebase-public-project.analytics_153293282.events_*` AS e
    ON i.`user_pseudo_id` = e.`user_pseudo_id`
    AND e.`event_name` = 'app_remove'
    AND `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
    AND TIMESTAMP_MICROS(e.`event_timestamp`) <= i.install_time + INTERVAL 7 DAY
) AS uninstalls
  ON installs.`user_pseudo_id` = uninstalls.`user_pseudo_id`;
2025-01-29 23:57:24 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-29 23:57:24 - root - INFO - ```sql
SELECT
  ((COUNT(DISTINCT installs.`user_pseudo_id`) - COUNT(DISTINCT uninstalls.`user_pseudo_id`)) * 100.0 / COUNT(DISTINCT installs.`user_pseudo_id`)) AS Percentage_of_users
FROM (
  SELECT DISTINCT `user_pseudo_id`, TIMESTAMP_MICROS(`user_first_touch_timestamp`) AS install_time
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE
    DATE(TIMESTAMP_MICROS(`user_first_touch_timestamp`)) BETWEEN '2018-08-01' AND '2018-09-30'
    AND `_TABLE_SUFFIX` BETWEEN '20180801' AND '20180930'
) AS installs
LEFT JOIN (
  SELECT DISTINCT e.`user_pseudo_id`
  FROM (
    SELECT DISTINCT `user_pseudo_id`, TIMESTAMP_MICROS(`user_first_touch_timestamp`) AS install_time
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE
      DATE(TIMESTAMP_MICROS(`user_first_touch_timestamp`)) BETWEEN '2018-08-01' AND '2018-09-30'
      AND `_TABLE_SUFFIX` BETWEEN '20180801' AND '20180930'
  ) AS i
  JOIN `firebase-public-project.analytics_153293282.events_*` AS e
    ON i.`user_pseudo_id` = e.`user_pseudo_id`
    AND e.`event_name` = 'app_remove'
    AND `_TABLE_SUFFIX` BETWEEN '20180801' AND '20181007'
    AND TIMESTAMP_MICROS(e.`event_timestamp`) <= i.install_time + INTERVAL 7 DAY
) AS uninstalls
  ON installs.`user_pseudo_id` = uninstalls.`user_pseudo_id`;
```
2025-01-29 23:57:29 - root - INFO - itercount: 2
2025-01-29 23:57:29 - root - INFO - 0
2025-01-29 23:57:29 - root - INFO - Total iteration counts: 2
