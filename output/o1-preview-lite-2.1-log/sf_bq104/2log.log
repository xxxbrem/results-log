2025-01-24 06:47:28 - openai._base_client - INFO - Retrying request to /chat/completions in 0.380775 seconds
2025-01-24 06:48:42 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 06:48:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:48:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:48:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:48:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:48:44 - snowflake.connector.connection - INFO - closed
2025-01-24 06:48:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:48:45 - root - INFO - SQL:
-- 1. List distinct terms from TOP_RISING_TERMS
SELECT DISTINCT "term"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
LIMIT 100;
Results:
term
seahawks vs lions
coastal flood advisory
emmy winners 2024
ga power outage map
duke power outage
commanders vs bengals
michigan football
ohio state football
canelo
witherspoon
blooket
peter dante
playstation network status
thursday night football tonight
real madrid alavés
aurora borealis
college football
premier league
texas ou game
yankees vs athletics
berlanga
helene update
fever vs mystics
alabama vs georgia
college football schedule
dragon ball daima
bills
tito jackson
one direction
vanderbilt
millie bobby brown
gavin creel
mace
buccaneers vs lions
eminem
real madrid vs vfb stuttgart
canvas
ken page
hat trick
49ers
ryan williams
p diddy
ryan wesley routh
koko
cardinals vs 49ers
raiders vs broncos
lake lure dam
teco outage map
transformers one
tottenham
new orleans saints vs kansas city chiefs match player stats
pager
colts vs titans
cowboys game
arsenal vs bolton
egyptian snakes
bivol vs beterbiev
seahawks vs patriots
trump shooter
priscilla presley
tim walz
hurricane
gamut definition
matt gaetz
colombia vs chile
nova
yankees
milton hurricane tracker
florida hurricane
ghost of yotei
jayden daniels
clemson football
tennessee football
browns vs jaguars
iran
lucas coly
lunar eclipse tonight
skrrt meaning
anna maria island
falcons vs panthers
bengals
fpl outage map
usc vs michigan
spongebob squarepants krabby patty
milton
hurricane helene 2024
bears vs colts
panthers vs raiders
jaguars vs texans
patriots vs 49ers
tampa bay buccaneers
real madrid vs villarreal
liam payne dead
zach wilson
perry florida
seattle seahawks
kansas city chiefs
carly gregg
frontline
jets

2025-01-24 06:48:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:48:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:48:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:48:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:48:46 - snowflake.connector.connection - INFO - closed
2025-01-24 06:48:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:48:47 - root - INFO - SQL:
-- 2. Get top rising terms from one year ago
SELECT DISTINCT "term"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
WHERE "week" BETWEEN '2022-10-01' AND '2022-10-31'
LIMIT 100;
Results:
term
fever vs mystics
vanderbilt
college football schedule
millie bobby brown
dragon ball daima
bills
alabama vs georgia
tito jackson
one direction
helene update
berlanga
premier league
yankees vs athletics
thursday night football tonight
blooket
college football
texas ou game
peter dante
playstation network status
aurora borealis
real madrid alavés
commanders vs bengals
ohio state football
michigan football
canelo
witherspoon
congressman mark green
olivia nuzzi
chiefs vs falcons
oregon football
hurricane watch
marcellus williams
fed rate cuts
skrrt
hurricane helene path tracker
padres vs dodgers
liam payme
hassan nasrallah
gamut
outer banks season 4
helene
hurricane milton updates
dallas cowboys vs steelers match player stats
ga power outage map
seahawks vs lions
coastal flood advisory
emmy winners 2024
duke power outage
europa league
auburn vs georgia
dolphins vs patriots
jack doherty
jojo siwa magazine cover
what time is the debate tonight
packers vs rams
aidan hutchinson
chiefs game today
saints
gamut definition
hurricane
colombia vs chile
nova
yankees
matt gaetz
milton hurricane tracker
rashee rice
nova france
quizlet live
venus de milo
anna delvey
broncos
labor day
nadine storm
falcons
brett favre
smite definition
tina peters
baby reindeer
liam payne death
israel news
pavel durov
ratan tata
canelo vs berlanga
steelers vs colts
mike lindell
scansion
savannah bananas
karl anthony towns
victoria secret fashion show
hurricane milton update
steelers game
atlanta falcons
giants
giants vs seahawks
ravens vs bengals
trump shooting
dancing with the stars 2024
debate tonight time
strength through joy
gavin creel

2025-01-24 06:48:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:48:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:48:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:48:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:48:48 - snowflake.connector.connection - INFO - closed
2025-01-24 06:48:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:48:49 - root - INFO - SQL:
-- 3. List DMA IDs and names from TOP_RISING_TERMS
SELECT DISTINCT "dma_id", "dma_name"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
LIMIT 100;
Results:
dma_id,dma_name
744,Honolulu HI
740,North Platte NE
751,Denver CO
641,San Antonio TX
581,Terre Haute IN
828,Monterey-Salinas CA
521,Providence-New Bedford MA
634,Amarillo TX
755,Great Falls MT
597,Parkersburg WV
619,Springfield MO
603,Joplin MO-Pittsburg KS
551,Lansing MI
606,Dothan AL
506,Boston MA-Manchester NH
671,Tulsa OK
711,Meridian MS
566,Harrisburg-Lancaster-Lebanon-York PA
526,Utica NY
622,New Orleans LA
662,Abilene-Sweetwater TX
618,Houston TX
511,Washington DC (Hagerstown MD)
800,Bakersfield CA
686,Mobile AL-Pensacola (Ft. Walton Beach) FL
524,Atlanta GA
790,Albuquerque-Santa Fe NM
508,Pittsburgh PA
525,Albany GA
522,Columbus GA
610,Rockford IL
640,Memphis TN
502,Binghamton NY
532,Albany-Schenectady-Troy NY
548,West Palm Beach-Ft. Pierce FL
570,Florence-Myrtle Beach SC
611,Rochester-Mason City-Austin IA
574,Johnstown-Altoona-State College PA
635,Austin TX
642,Lafayette LA
515,Cincinnati OH
512,Baltimore MD
510,Cleveland-Akron (Canton) OH
760,Twin Falls ID
702,La Crosse-Eau Claire WI
705,Wausau-Rhinelander WI
636,Harlingen-Weslaco-Brownsville-McAllen TX
541,Lexington KY
565,Elmira (Corning) NY
669,Madison WI
530,Tallahassee FL-Thomasville GA
501,New York NY
649,Evansville IN
747,Juneau AK
555,Syracuse NY
675,Peoria-Bloomington IL
687,Minot-Bismarck-Dickinson(Williston) ND
803,Los Angeles CA
722,Lincoln & Hastings-Kearney NE
602,Chicago IL
577,Wilkes Barre-Scranton PA
648,Champaign & Springfield-Decatur IL
734,Jonesboro AR
616,Kansas City MO
600,Corpus Christi TX
862,Sacramento-Stockton-Modesto CA
771,Yuma AZ-El Centro CA
598,Clarksburg-Weston WV
725,Sioux Falls(Mitchell) SD
802,Eureka CA
754,Butte-Bozeman MT
798,Glendive MT
627,Wichita Falls TX & Lawton OK
670,Ft. Smith-Fayetteville-Springdale-Rogers AR
698,Montgomery-Selma AL
569,Harrisonburg VA
556,Richmond-Petersburg VA
544,Norfolk-Portsmouth-Newport News VA
757,Boise ID
718,Jackson MS
613,Minneapolis-St. Paul MN
533,Hartford & New Haven CT
743,Anchorage AK
746,Biloxi-Gulfport MS
801,Eugene OR
571,Ft. Myers-Naples FL
745,Fairbanks AK
752,Colorado Springs-Pueblo CO
605,Topeka KS
513,Flint-Saginaw-Bay City MI
866,Fresno-Visalia CA
592,Gainesville FL
759,Cheyenne WY-Scottsbluff NE
624,Sioux City IA
650,Oklahoma City OK
503,Macon GA
692,Beaumont-Port Arthur TX
514,Buffalo NY
558,Lima OH
659,Nashville TN

2025-01-24 06:48:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:48:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:48:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:48:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:48:51 - snowflake.connector.connection - INFO - closed
2025-01-24 06:48:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:48:51 - root - INFO - SQL:
-- 4. Retrieve search scores for top rising terms per DMA from TOP_TERMS
SELECT "dma_id", "dma_name", "term", "score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS"
WHERE "term" IN (
    SELECT DISTINCT "term"
    FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
    WHERE "week" BETWEEN '2022-10-01' AND '2022-10-31'
)
LIMIT 100;
Results:
dma_id,dma_name,term,score
500,Portland-Auburn ME,49ers,8.0
500,Portland-Auburn ME,49ers,7.0
500,Portland-Auburn ME,49ers,25.0
500,Portland-Auburn ME,49ers,18.0
500,Portland-Auburn ME,49ers,16.0
500,Portland-Auburn ME,49ers,37.0
500,Portland-Auburn ME,49ers,16.0
500,Portland-Auburn ME,49ers,19.0
500,Portland-Auburn ME,49ers,13.0
500,Portland-Auburn ME,49ers,21.0
500,Portland-Auburn ME,49ers,26.0
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,3.0
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,2.0
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,2.0
500,Portland-Auburn ME,49ers,2.0
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,3.0
500,Portland-Auburn ME,49ers,10.0
500,Portland-Auburn ME,49ers,9.0
500,Portland-Auburn ME,49ers,7.0
500,Portland-Auburn ME,49ers,12.0
500,Portland-Auburn ME,49ers,17.0
500,Portland-Auburn ME,49ers,14.0
500,Portland-Auburn ME,49ers,4.0
500,Portland-Auburn ME,49ers,5.0
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,7.0
500,Portland-Auburn ME,49ers,9.0
500,Portland-Auburn ME,49ers,6.0
500,Portland-Auburn ME,49ers,12.0
500,Portland-Auburn ME,49ers,3.0
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,3.0
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,3.0
500,Portland-Auburn ME,49ers,3.0
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,3.0
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,4.0
500,Portland-Auburn ME,49ers,4.0
500,Portland-Auburn ME,49ers,11.0
500,Portland-Auburn ME,49ers,8.0
500,Portland-Auburn ME,49ers,13.0
500,Portland-Auburn ME,49ers,8.0
500,Portland-Auburn ME,49ers,5.0
500,Portland-Auburn ME,49ers,12.0
500,Portland-Auburn ME,49ers,5.0
500,Portland-Auburn ME,49ers,5.0
500,Portland-Auburn ME,49ers,12.0
500,Portland-Auburn ME,49ers,5.0
500,Portland-Auburn ME,49ers,7.0
500,Portland-Auburn ME,49ers,6.0
500,Portland-Auburn ME,49ers,19.0
500,Portland-Auburn ME,49ers,70.0
500,Portland-Auburn ME,49ers,3.0
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,2.0
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,3.0
500,Portland-Auburn ME,49ers,3.0
500,Portland-Auburn ME,49ers,4.0
500,Portland-Auburn ME,49ers,9.0
500,Portland-Auburn ME,49ers,13.0
500,Portland-Auburn ME,49ers,8.0
500,Portland-Auburn ME,49ers,4.0
500,Portland-Auburn ME,49ers,14.0
500,Portland-Auburn ME,49ers,34.0
500,Portland-Auburn ME,49ers,8.0
500,Portland-Auburn ME,49ers,9.0
500,Portland-Auburn ME,49ers,15.0
500,Portland-Auburn ME,49ers,22.0
500,Portland-Auburn ME,49ers,60.0
500,Portland-Auburn ME,49ers,60.0
500,Portland-Auburn ME,49ers,2.0

2025-01-24 06:48:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:48:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:48:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:48:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:48:53 - snowflake.connector.connection - INFO - closed
2025-01-24 06:48:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:48:53 - root - INFO - SQL:
-- 5. Sum search scores for each DMA for top rising terms
SELECT "dma_id", "dma_name", SUM("score") AS "total_score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS"
WHERE "term" IN (
    SELECT DISTINCT "term"
    FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
    WHERE "week" BETWEEN '2022-10-01' AND '2022-10-31'
)
GROUP BY "dma_id", "dma_name"
ORDER BY "total_score" DESC
LIMIT 100;
Results:
dma_id,dma_name,total_score
868,Chico-Redding CA,11774
866,Fresno-Visalia CA,11395
862,Sacramento-Stockton-Modesto CA,10630
802,Eureka CA,10020
828,Monterey-Salinas CA,9878
813,Medford-Klamath Falls OR,9675
800,Bakersfield CA,8852
807,San Francisco-Oakland-San Jose CA,8813
855,Santa Barbara-Santa Maria-San Luis Obispo CA,8561
811,Reno NV,8255
820,Portland OR,7713
765,El Paso TX,7688
757,Boise ID,7686
744,Honolulu HI,7679
804,Palm Springs CA,7421
821,Bend OR,7253
881,Spokane WA,7231
790,Albuquerque-Santa Fe NM,7194
789,Tucson (Sierra Vista) AZ,7002
801,Eugene OR,7000
839,Las Vegas NV,6677
718,Jackson MS,6676
803,Los Angeles CA,6510
640,Memphis TN,6426
753,Phoenix AZ,6412
810,Yakima-Pasco-Richland-Kennewick WA,6411
743,Anchorage AK,6354
771,Yuma AZ-El Centro CA,6347
825,San Diego CA,6278
762,Missoula MT,6211
770,Salt Lake City UT,6181
725,Sioux Falls(Mitchell) SD,5738
635,Austin TX,5687
501,New York NY,5684
819,Seattle-Tacoma WA,5670
687,Minot-Bismarck-Dickinson(Williston) ND,5669
758,Idaho Falls-Pocatello ID,5658
544,Norfolk-Portsmouth-Newport News VA,5610
556,Richmond-Petersburg VA,5609
633,Odessa-Midland TX,5543
716,Baton Rouge LA,5536
546,Columbia SC,5522
517,Charlotte NC,5508
637,Cedar Rapids-Waterloo-Iowa City & Dubuque IA,5420
538,Rochester NY,5356
612,Shreveport LA,5324
533,Hartford & New Haven CT,5274
636,Harlingen-Weslaco-Brownsville-McAllen TX,5256
724,Fargo-Valley City ND,5242
641,San Antonio TX,5226
651,Lubbock TX,5206
754,Butte-Bozeman MT,5206
760,Twin Falls ID,5187
679,Des Moines-Ames IA,5159
532,Albany-Schenectady-Troy NY,5154
623,Dallas-Ft. Worth TX,5132
600,Corpus Christi TX,5109
647,Greenwood-Greenville MS,5050
573,Roanoke-Lynchburg VA,5047
682,Davenport IA-Rock Island-Moline IL,5037
521,Providence-New Bedford MA,5018
634,Amarillo TX,5004
566,Harrisburg-Lancaster-Lebanon-York PA,4988
622,New Orleans LA,4975
520,Augusta GA,4944
752,Colorado Springs-Pueblo CO,4927
518,Greensboro-High Point-Winston Salem NC,4921
536,Youngstown OH,4890
519,Charleston SC,4883
577,Wilkes Barre-Scranton PA,4848
543,Springfield-Holyoke MA,4841
756,Billings MT,4826
642,Lafayette LA,4817
628,Monroe LA-El Dorado AR,4786
625,Waco-Temple-Bryan TX,4747
710,Hattiesburg-Laurel MS,4745
751,Denver CO,4690
555,Syracuse NY,4665
542,Dayton OH,4657
570,Florence-Myrtle Beach SC,4636
506,Boston MA-Manchester NH,4623
516,Erie PA,4616
671,Tulsa OK,4615
548,West Palm Beach-Ft. Pierce FL,4590
560,Raleigh-Durham (Fayetteville) NC,4578
669,Madison WI,4576
755,Great Falls MT,4570
511,Washington DC (Hagerstown MD),4542
746,Biloxi-Gulfport MS,4532
610,Rockford IL,4522
673,Columbus-Tupelo-West Point MS,4516
624,Sioux City IA,4464
547,Toledo OH,4429
504,Philadelphia PA,4414
534,Orlando-Daytona Beach-Melbourne FL,4407
686,Mobile AL-Pensacola (Ft. Walton Beach) FL,4402
539,Tampa-St. Petersburg (Sarasota) FL,4383
524,Atlanta GA,4382
661,San Angelo TX,4376
650,Oklahoma City OK,4375

2025-01-24 06:48:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:48:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:48:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:48:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-24 06:48:55 - snowflake.connector.connection - INFO - closed
2025-01-24 06:48:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:48:55 - root - INFO - SQL:
-- 6. Find top 10 terms from last October with highest percent gain
SELECT "term", "percent_gain"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
WHERE "week" BETWEEN '2022-10-01' AND '2022-10-31'
ORDER BY "percent_gain" DESC
LIMIT 10;
Results:
term,percent_gain
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850

2025-01-24 06:48:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:48:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:48:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:48:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:48:59 - snowflake.connector.connection - INFO - closed
2025-01-24 06:48:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:48:59 - root - INFO - SQL:
-- 7. Get average scores per DMA for the top rising terms
SELECT "dma_id", "dma_name", AVG("score") AS "average_score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
WHERE "week" BETWEEN '2022-10-01' AND '2022-10-31'
GROUP BY "dma_id", "dma_name"
ORDER BY "average_score" DESC
LIMIT 100;
Results:
dma_id,dma_name,average_score
798,Glendive MT,89.421053
740,North Platte NE,59.886076
747,Juneau AK,59.740260
552,Presque Isle ME,55.500000
766,Helena MT,54.657534
596,Zanesville OH,53.985000
583,Alpena MI,51.111111
549,Watertown NY,50.576642
773,Grand Junction-Montrose CO,50.195122
638,St. Joseph MO,49.248848
558,Lima OH,49.118132
736,Bowling Green KY,47.888383
597,Parkersburg WV,47.616379
767,Casper-Riverton WY,47.172840
639,Jackson TN,46.594787
526,Utica NY,46.092511
631,Ottumwa IA-Kirksville MO,45.972222
644,Alexandria LA,45.934028
734,Jonesboro AR,45.806250
764,Rapid City SD,45.708061
598,Clarksburg-Weston WV,45.699438
661,San Angelo TX,45.338028
647,Greenwood-Greenville MS,45.288321
626,Victoria TX,45.014286
760,Twin Falls ID,44.918841
606,Dothan AL,44.864253
711,Meridian MS,44.550388
759,Cheyenne WY-Scottsbluff NE,44.389961
569,Harrisonburg VA,44.170854
755,Great Falls MT,44.164706
737,Mankato MN,43.900383
802,Eureka CA,43.784091
525,Albany GA,43.717042
745,Fairbanks AK,43.565217
754,Butte-Bozeman MT,43.228758
565,Elmira (Corning) NY,43.159140
710,Hattiesburg-Laurel MS,43.035644
502,Binghamton NY,42.963190
643,Lake Charles LA,42.879828
553,Marquette MI,42.835784
582,Lafayette IN,42.809969
559,Bluefield-Beckley-Oak Hill WV,42.432494
746,Biloxi-Gulfport MS,42.426563
576,Salisbury MD,42.300380
657,Sherman-Ada OK,41.901923
554,Wheeling WV-Steubenville OH,41.427273
756,Billings MT,41.403888
611,Rochester-Mason City-Austin IA,41.120611
717,Quincy IL-Hannibal MO-Keokuk IA,40.994695
605,Topeka KS,40.816446
771,Yuma AZ-El Centro CA,40.812371
673,Columbus-Tupelo-West Point MS,40.745955
503,Macon GA,40.728750
762,Missoula MT,40.722567
743,Anchorage AK,40.523132
813,Medford-Klamath Falls OR,40.417094
758,Idaho Falls-Pocatello ID,40.333333
662,Abilene-Sweetwater TX,40.297710
516,Erie PA,40.252664
868,Chico-Redding CA,40.138112
603,Joplin MO-Pittsburg KS,40.127042
821,Bend OR,40.103359
610,Rockford IL,40.086103
581,Terre Haute IN,40.067061
522,Columbus GA,39.828467
687,Minot-Bismarck-Dickinson(Williston) ND,39.636704
656,Panama City FL,39.601983
628,Monroe LA-El Dorado AR,39.547993
692,Beaumont-Port Arthur TX,39.306854
627,Wichita Falls TX & Lawton OK,39.278689
570,Florence-Myrtle Beach SC,39.247120
624,Sioux City IA,39.168331
675,Peoria-Bloomington IL,38.974093
550,Wilmington NC,38.843236
564,Charleston-Huntington WV,38.733333
545,Greenville-New Bern-Washington NC,38.539313
804,Palm Springs CA,38.437898
537,Bangor ME,38.401316
575,Chattanooga TN,38.384127
698,Montgomery-Selma AL,38.361333
592,Gainesville FL,38.238450
531,Tri-Cities TN-VA,38.061881
555,Syracuse NY,38.046000
520,Augusta GA,37.974699
718,Jackson MS,37.961823
574,Johnstown-Altoona-State College PA,37.709091
634,Amarillo TX,37.633188
523,Burlington VT-Plattsburgh NY,37.249398
543,Springfield-Holyoke MA,37.210875
633,Odessa-Midland TX,37.204478
676,Duluth MN-Superior WI,37.195122
691,Huntsville-Decatur (Florence) AL,37.148380
810,Yakima-Pasco-Richland-Kennewick WA,37.132979
855,Santa Barbara-Santa Maria-San Luis Obispo CA,37.078261
540,Traverse City-Cadillac MI,36.904828
632,Paducah KY-Cape Girardeau MO-Harrisburg-Mount Vernon IL,36.865311
649,Evansville IN,36.861148
725,Sioux Falls(Mitchell) SD,36.771598
651,Lubbock TX,36.698910
542,Dayton OH,36.696881

2025-01-24 06:48:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:48:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:48:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:49:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:49:02 - snowflake.connector.connection - INFO - closed
2025-01-24 06:49:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:49:02 - root - INFO - SQL:
-- 8. Count the number of times each term appears in TOP_RISING_TERMS
SELECT "term", COUNT(*) AS "appearance_count"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
GROUP BY "term"
ORDER BY "appearance_count" DESC
LIMIT 100;
Results:
term,appearance_count
college football scores,495180
thursday night football,439320
monday night football,385140
cowboys game,384930
blooket,330120
ncaa football scores,330120
blooket join,275100
kahoot,275100
gimkit,275100
lions game,220080
alabama football,220080
ohio state football,220080
georgia football,220080
penn state football,220080
hurricane watch,220080
davante adams,220080
hurricane tracker,220080
colorado football,220080
hurricane helene,219870
emerson romero,219870
falcons,219870
tropical storm warning,165060
champions league,165060
iowa football,165060
hurricane milton tracker,165060
hurricane,165060
michigan football,165060
college football,165060
real madrid,165060
notre dame football,165060
hurricane milton,165060
uefa champions league,165060
nebraska football,165060
gimkit join,165060
padres,165060
anna delvey,165060
hurricane helene tracker,164850
menendez brothers,164850
jets,164850
agatha all along,164850
hurricane nadine,164850
yankees,110040
verizon outage,110040
pap definition,110040
bengals vs chiefs,110040
diddy,110040
premier league,110040
playstation network status,110040
patriots vs 49ers,110040
jaguars vs texans,110040
arch manning,110040
seahawks vs patriots,110040
monday night football tonight,110040
padres vs dodgers,110040
broncos vs buccaneers,110040
ncaa football,110040
buccaneers vs saints,110040
auburn football,110040
peal meaning,110040
gamut definition,110040
colombia vs chile,110040
milton path,110040
marcellus williams,110040
raiders vs ravens,110040
pete rose,110040
chargers vs broncos,110040
panthers vs raiders,110040
colorado vs ucf,110040
bears vs colts,110040
eagles vs saints,110040
witherspoon,110040
kris kristofferson,110040
auburn vs georgia,110040
priscilla presley,110040
bills vs jets,110040
jaguars vs bears,110040
how to register to vote in the us,110040
julienne,110040
chiefs vs falcons,110040
shiva,110040
jd vance,110040
minnesota vs michigan,110040
helene,110040
packers vs rams,110040
ratan tata,110040
packers vs titans,110040
aiden hutchinson,110040
steelers vs broncos,110040
colts vs titans,110040
gamut,110040
alabama vs georgia,110040
bills vs texans,110040
college football schedule,110040
wanda smith,110040
bengals vs giants,110040
skrrt,110040
venus de milo,110040
alabama vs vanderbilt,110040
witherspoon meaning,110040
rams vs bears,110040

2025-01-24 06:49:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:49:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:49:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:49:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:49:05 - snowflake.connector.connection - INFO - closed
2025-01-24 06:49:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:49:06 - root - INFO - SQL:
-- 9. List terms and their average scores from TOP_TERMS
SELECT "term", AVG("score") AS "average_score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS"
GROUP BY "term"
ORDER BY "average_score" DESC
LIMIT 100;
Results:
term,average_score
Metallica Tour' 2025,96.029586
Boise state VS- Hawaii,93.666667
D.E.I,93.046392
Panthers vs-raiders,92.728723
COVID-19 XEC variant,92.360000
BYUfootball,92.293814
E.l.f,88.619048
Mr. Prada,88.618182
Red Flag fire weather Warning,86.905350
Trump rally Long Island,85.926829
Devara review,84.057252
BioLab Conyers,83.852713
Michael Jordan mansion Highland Park,83.298561
Tyler Badie injury,83.125000
Gary Ruvkun,82.980392
Eggs recalled salmonella,82.435045
Huracan Milton trayectoria,82.062963
Kirby Smart Jets,82.041096
Tina Peters sentencing,81.573477
Florida homeless law,80.713355
Alma Police Department Morgan Nick,80.239865
Mi State vs Boston College,79.984962
Simpsons series finale,79.956113
SSI recipients extra check November,79.926254
Seth Altman,79.559140
George Baldock,79.491166
COVID XEC variant,79.316716
Missing cat Yellowstone,78.955090
Hurricane Kirk path,78.882530
Hurricane Helene death toll,78.834835
North Carolina governor Mark Robinson,78.608481
Rashee Rice injury update,78.603175
Social Security benefits 2025,78.422713
Aston Villa vs Bayern,78.317460
Mollie Kathleen Gold Mine,78.205047
Han Kang,78.177444
Chromakopia,78.099432
Ron Hale,78.098976
Is The port strike over,77.990476
Daniel Day-Lewis,77.977528
Disney World Hurricane Milton,77.852713
Real Madrid  Alavés,77.785498
Oprah and Kamala,77.751445
Trump watches,77.719880
Ghost of Yotei,77.640387
Teamsters endorsement,77.639296
England vs Greece,77.128527
Baby pygmy hippopotamus,77.127273
Kentucky Sheriff shoots Judge,76.880342
Nell Smith,76.851752
Kentucky sheriff shoots judge,76.650289
Peter Todd,76.065015
Taylor Rousseau Grigg,75.965789
Waterville Dam,75.956164
Mercury Morris,75.775457
Eduardo Xol,75.701449
California banning plastic bags,75.689895
Lilly Ledbetter,75.661891
McDonald's Halloween buckets,75.642173
Lucas Coly,75.618926
Lake Lure Dam,75.556452
Milan vs Liverpool,75.501377
Eric Adams indictment,75.484043
Missouri execution,75.483965
Ken Page,75.418605
Freddie Owens,75.339744
Is Hurricane Milton over,75.331148
Monsters Netflix Menendez,75.105769
Fever vs Mystics,75.048523
UCLA vs Penn State,74.990991
People's Choice Country Awards,74.685961
Helene storm path,74.114796
Hurricane Kirk,73.968051
Agatha All Along episode 5,73.578947
Agatha All Along Episode 4,73.307692
El Taiger,73.279720
Indigenous Peoples' Day,73.183607
Matthew Sluka,73.084656
Luis Tiant,73.041775
Mickey 17,73.010101
Yung Filly,73.005618
Todd Downing,72.948424
Wisconsin vs Rutgers,72.905556
Mid-Autumn Festival,72.822674
That '90s Show,72.703927
Brandon McManus,72.519512
Birmingham shooting,72.134211
It's What's Inside,71.946927
Geoffrey Hinton,71.835962
Oklahoma vs Auburn,71.825221
JD Souther,71.592075
Milton Hurricane update,71.229765
Nico Collins injury,70.847503
Nebraska vs Purdue,70.706122
Crystal Palace vs Man United,70.647597
Carly Gregg,70.519231
World Mental Health Day 2024,70.102667
FEMA Hurricane Helene,69.916256
Agatha All Along episode 6,69.795014
Tropicana implosion,69.476190

2025-01-24 06:49:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:49:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:49:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:49:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:49:08 - snowflake.connector.connection - INFO - closed
2025-01-24 06:49:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:49:09 - root - INFO - SQL:
-- 10. Find DMAs with the highest number of unique terms
SELECT "dma_id", "dma_name", COUNT(DISTINCT "term") AS "unique_terms_count"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS"
GROUP BY "dma_id", "dma_name"
ORDER BY "unique_terms_count" DESC
LIMIT 100;
Results:
dma_id,dma_name,unique_terms_count
538,Rochester NY,660
813,Medford-Klamath Falls OR,660
542,Dayton OH,660
600,Corpus Christi TX,660
673,Columbus-Tupelo-West Point MS,660
612,Shreveport LA,660
636,Harlingen-Weslaco-Brownsville-McAllen TX,660
702,La Crosse-Eau Claire WI,660
705,Wausau-Rhinelander WI,660
760,Twin Falls ID,660
717,Quincy IL-Hannibal MO-Keokuk IA,660
583,Alpena MI,660
557,Knoxville TN,660
716,Baton Rouge LA,660
564,Charleston-Huntington WV,660
765,El Paso TX,660
724,Fargo-Valley City ND,660
825,San Diego CA,660
675,Peoria-Bloomington IL,660
747,Juneau AK,660
602,Chicago IL,660
555,Syracuse NY,660
649,Evansville IN,660
803,Los Angeles CA,660
722,Lincoln & Hastings-Kearney NE,660
576,Salisbury MD,660
687,Minot-Bismarck-Dickinson(Williston) ND,660
527,Indianapolis IN,660
810,Yakima-Pasco-Richland-Kennewick WA,660
628,Monroe LA-El Dorado AR,660
651,Lubbock TX,660
767,Casper-Riverton WY,660
643,Lake Charles LA,660
507,Savannah GA,660
577,Wilkes Barre-Scranton PA,660
734,Jonesboro AR,660
648,Champaign & Springfield-Decatur IL,660
710,Hattiesburg-Laurel MS,660
839,Las Vegas NV,660
802,Eureka CA,660
725,Sioux Falls(Mitchell) SD,660
736,Bowling Green KY,660
588,South Bend-Elkhart IN,660
868,Chico-Redding CA,660
647,Greenwood-Greenville MS,660
573,Roanoke-Lynchburg VA,660
536,Youngstown OH,660
659,Nashville TN,660
558,Lima OH,660
679,Des Moines-Ames IA,660
514,Buffalo NY,660
549,Watertown NY,660
575,Chattanooga TN,660
766,Helena MT,660
811,Reno NV,660
626,Victoria TX,660
509,Ft. Wayne IN,660
819,Seattle-Tacoma WA,660
534,Orlando-Daytona Beach-Melbourne FL,660
511,Washington DC (Hagerstown MD),660
581,Terre Haute IN,660
641,San Antonio TX,660
828,Monterey-Salinas CA,660
546,Columbia SC,660
523,Burlington VT-Plattsburgh NY,660
625,Waco-Temple-Bryan TX,660
709,Tyler-Longview(Lufkin & Nacogdoches) TX,660
519,Charleston SC,660
652,Omaha NE,660
530,Tallahassee FL-Thomasville GA,660
501,New York NY,660
749,Laredo TX,660
535,Columbus OH,660
574,Johnstown-Altoona-State College PA,660
598,Clarksburg-Weston WV,660
771,Yuma AZ-El Centro CA,660
656,Panama City FL,660
693,Little Rock-Pine Bluff AR,660
758,Idaho Falls-Pocatello ID,660
801,Eugene OR,660
571,Ft. Myers-Naples FL,660
740,North Platte NE,660
751,Denver CO,660
567,Greenville-Spartanburg-Asheville-Anderson,660
862,Sacramento-Stockton-Modesto CA,660
584,Charlottesville VA,660
789,Tucson (Sierra Vista) AZ,660
560,Raleigh-Durham (Fayetteville) NC,660
520,Augusta GA,660
537,Bangor ME,660
508,Pittsburgh PA,660
790,Albuquerque-Santa Fe NM,660
610,Rockford IL,660
525,Albany GA,660
639,Jackson TN,660
531,Tri-Cities TN-VA,660
762,Missoula MT,660
616,Kansas City MO,660
633,Odessa-Midland TX,660
676,Duluth MN-Superior WI,660

2025-01-24 06:49:09 - root - INFO - itercount: 0
2025-01-24 06:49:09 - root - INFO - Database Name: GOOGLE_TRENDS
Schema Name: GOOGLE_TRENDS
DDL describes table information.
,0
table_name,TOP_TERMS
description,
DDL,"create or replace TABLE TOP_TERMS (
	""dma_name"" VARCHAR(16777216),
	""dma_id"" NUMBER(38,0),
	""term"" VARCHAR(16777216),
	""week"" DATE,
	""score"" NUMBER(38,0),
	""rank"" NUMBER(38,0),
	""refresh_date"" DATE
);"

,1
table_name,TOP_RISING_TERMS
description,
DDL,"create or replace TABLE TOP_RISING_TERMS (
	""dma_id"" NUMBER(38,0),
	""term"" VARCHAR(16777216),
	""week"" DATE,
	""score"" NUMBER(38,0),
	""rank"" NUMBER(38,0),
	""percent_gain"" NUMBER(38,0),
	""refresh_date"" DATE,
	""dma_name"" VARCHAR(16777216)
);"

,2
table_name,INTERNATIONAL_TOP_RISING_TERMS
description,
DDL,"create or replace TABLE INTERNATIONAL_TOP_RISING_TERMS (
	""percent_gain"" NUMBER(38,0),
	""region_name"" VARCHAR(16777216),
	""term"" VARCHAR(16777216),
	""week"" DATE,
	""score"" NUMBER(38,0),
	""refresh_date"" DATE,
	""country_name"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""region_code"" VARCHAR(16777216),
	""rank"" NUMBER(38,0)
);"

,3
table_name,INTERNATIONAL_TOP_TERMS
description,
DDL,"create or replace TABLE INTERNATIONAL_TOP_TERMS (
	""term"" VARCHAR(16777216),
	""refresh_date"" DATE,
	""region_code"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""region_name"" VARCHAR(16777216),
	""week"" DATE,
	""score"" NUMBER(38,0),
	""rank"" NUMBER(38,0),
	""country_name"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'GOOGLE_TRENDS': {'GOOGLE_TRENDS': ['INTERNATIONAL_TOP_RISING_TERMS', 'INTERNATIONAL_TOP_TERMS', 'TOP_RISING_TERMS', 'TOP_TERMS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table:** `"GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"`
  - `"term"`: To identify the top rising search terms.
  - `"week"`: To filter terms from one year ago.
  - `"dma_id"`: To identify the Designated Market Area (DMA).
  - `"dma_name"`: To get the name of the DMA.
  - `"score"`: Search score of the term in the DMA.
  - `"percent_gain"`: Percentage increase of the term's search frequency.
- **Table:** `"GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS"`
  - `"term"`: To retrieve search scores for the top rising terms.
  - `"week"`: To filter data for relevant weeks.
  - `"dma_id"`: To identify the DMA.
  - `"dma_name"`: To get the name of the DMA.
  - `"score"`: Search score of the term in the DMA.

**Conditions that may be used:**

- **Date Filter:** Restrict data to one year ago (e.g., between `'2022-10-01'` and `'2022-10-31'`).
- **Term Matching:** Use terms from `"TOP_RISING_TERMS"` to find corresponding scores in `"TOP_TERMS"`.
- **Grouping:** Aggregate data by `"dma_id"` and `"dma_name"` to calculate total or average scores.
- **Ordering:** Sort results based on `"score"`, `"total_score"`, or `"percent_gain"` to find highest values.

---

**SQL Queries:**

```sql
-- 1. List distinct terms from TOP_RISING_TERMS
SELECT DISTINCT "term"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
LIMIT 100;
```

```sql
-- 2. Get top rising terms from one year ago
SELECT DISTINCT "term"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
WHERE "week" BETWEEN '2022-10-01' AND '2022-10-31'
LIMIT 100;
```

```sql
-- 3. List DMA IDs and names from TOP_RISING_TERMS
SELECT DISTINCT "dma_id", "dma_name"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
LIMIT 100;
```

```sql
-- 4. Retrieve search scores for top rising terms per DMA from TOP_TERMS
SELECT "dma_id", "dma_name", "term", "score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS"
WHERE "term" IN (
    SELECT DISTINCT "term"
    FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
    WHERE "week" BETWEEN '2022-10-01' AND '2022-10-31'
)
LIMIT 100;
```

```sql
-- 5. Sum search scores for each DMA for top rising terms
SELECT "dma_id", "dma_name", SUM("score") AS "total_score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS"
WHERE "term" IN (
    SELECT DISTINCT "term"
    FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
    WHERE "week" BETWEEN '2022-10-01' AND '2022-10-31'
)
GROUP BY "dma_id", "dma_name"
ORDER BY "total_score" DESC
LIMIT 100;
```

```sql
-- 6. Find top 10 terms from last October with highest percent gain
SELECT "term", "percent_gain"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
WHERE "week" BETWEEN '2022-10-01' AND '2022-10-31'
ORDER BY "percent_gain" DESC
LIMIT 10;
```

```sql
-- 7. Get average scores per DMA for the top rising terms
SELECT "dma_id", "dma_name", AVG("score") AS "average_score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
WHERE "week" BETWEEN '2022-10-01' AND '2022-10-31'
GROUP BY "dma_id", "dma_name"
ORDER BY "average_score" DESC
LIMIT 100;
```

```sql
-- 8. Count the number of times each term appears in TOP_RISING_TERMS
SELECT "term", COUNT(*) AS "appearance_count"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
GROUP BY "term"
ORDER BY "appearance_count" DESC
LIMIT 100;
```

```sql
-- 9. List terms and their average scores from TOP_TERMS
SELECT "term", AVG("score") AS "average_score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS"
GROUP BY "term"
ORDER BY "average_score" DESC
LIMIT 100;
```

```sql
-- 10. Find DMAs with the highest number of unique terms
SELECT "dma_id", "dma_name", COUNT(DISTINCT "term") AS "unique_terms_count"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS"
GROUP BY "dma_id", "dma_name"
ORDER BY "unique_terms_count" DESC
LIMIT 100;
```

---

These queries are designed to explore the relevant data for the task:

- **Queries 1-3:** Retrieve basic information about terms and DMAs.
- **Queries 4-5:** Join data between tables based on terms and calculate total scores per DMA.
- **Query 6:** Identify top terms from a specific time frame with the highest percentage gain.
- **Query 7:** Calculate average scores for DMAs for the top rising terms.
- **Query 8:** Determine how frequently each term appears in the data.
- **Query 9:** Find average scores of terms across all DMAs.
- **Query 10:** Identify DMAs with the most diverse search interests.

All column names are enclosed in double quotations, and the queries adhere to the specified guidelines, avoiding time functions and CTEs, and ensuring each query is unique.Query:
-- 1. List distinct terms from TOP_RISING_TERMS
SELECT DISTINCT "term"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
LIMIT 100;
Answer:
term
seahawks vs lions
coastal flood advisory
emmy winners 2024
ga power outage map
duke power outage
commanders vs bengals
michigan football
ohio state football
canelo
witherspoon
blooket
peter dante
playstation network status
thursday night football tonight
real madrid alavés
aurora borealis
college football
premier league
texas ou game
yankees vs athletics
berlanga
helene update
fever vs mystics
alabama vs georgia
college football schedule
dragon ball daima
bills
tito jackson
one direction
vanderbilt
millie bobby brown
gavin creel
mace
buccaneers vs lions
eminem
real madrid vs vfb stuttgart
canvas
ken page
hat trick
49ers
ryan williams
p diddy
ryan wesley routh
koko
cardinals vs 49ers
raiders vs broncos
lake lure dam
teco outage map
transformers one
tottenham
new orleans saints vs kansas city chiefs match player stats
pager
colts vs titans
cowboys game
arsenal vs bolton
egyptian snakes
bivol vs beterbiev
seahawks vs patriots
trump shooter
priscilla presley
tim walz
hurricane
gamut definition
matt gaetz
colombia vs chile
nova
yankees
milton hurricane tracker
florida hurricane
ghost of yotei
jayden daniels
clemson football
tennessee football
browns vs jaguars
iran
lucas coly
lunar eclipse tonight
skrrt meaning
anna maria island
falcons vs panthers
bengals
fpl outage map
usc vs michigan
spongebob squarepants krabby patty
milton
hurricane helene 2024
bears vs colts
panthers vs raiders
jaguars vs texans
patriots vs 49ers
tampa bay buccaneers
real madrid vs villarreal
liam payne dead
zach wilson
perry florida
seattle seahawks
kansas city chiefs
carly gregg
frontline
jets
Query:
-- 2. Get top rising terms from one year ago
SELECT DISTINCT "term"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
WHERE "week" BETWEEN '2022-10-01' AND '2022-10-31'
LIMIT 100;
Answer:
term
fever vs mystics
vanderbilt
college football schedule
millie bobby brown
dragon ball daima
bills
alabama vs georgia
tito jackson
one direction
helene update
berlanga
premier league
yankees vs athletics
thursday night football tonight
blooket
college football
texas ou game
peter dante
playstation network status
aurora borealis
real madrid alavés
commanders vs bengals
ohio state football
michigan football
canelo
witherspoon
congressman mark green
olivia nuzzi
chiefs vs falcons
oregon football
hurricane watch
marcellus williams
fed rate cuts
skrrt
hurricane helene path tracker
padres vs dodgers
liam payme
hassan nasrallah
gamut
outer banks season 4
helene
hurricane milton updates
dallas cowboys vs steelers match player stats
ga power outage map
seahawks vs lions
coastal flood advisory
emmy winners 2024
duke power outage
europa league
auburn vs georgia
dolphins vs patriots
jack doherty
jojo siwa magazine cover
what time is the debate tonight
packers vs rams
aidan hutchinson
chiefs game today
saints
gamut definition
hurricane
colombia vs chile
nova
yankees
matt gaetz
milton hurricane tracker
rashee rice
nova france
quizlet live
venus de milo
anna delvey
broncos
labor day
nadine storm
falcons
brett favre
smite definition
tina peters
baby reindeer
liam payne death
israel news
pavel durov
ratan tata
canelo vs berlanga
steelers vs colts
mike lindell
scansion
savannah bananas
karl anthony towns
victoria secret fashion show
hurricane milton update
steelers game
atlanta falcons
giants
giants vs seahawks
ravens vs bengals
trump shooting
dancing with the stars 2024
debate tonight time
strength through joy
gavin creel
Query:
-- 3. List DMA IDs and names from TOP_RISING_TERMS
SELECT DISTINCT "dma_id", "dma_name"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
LIMIT 100;
Answer:
dma_id,dma_name
744,Honolulu HI
740,North Platte NE
751,Denver CO
641,San Antonio TX
581,Terre Haute IN
828,Monterey-Salinas CA
521,Providence-New Bedford MA
634,Amarillo TX
755,Great Falls MT
597,Parkersburg WV
619,Springfield MO
603,Joplin MO-Pittsburg KS
551,Lansing MI
606,Dothan AL
506,Boston MA-Manchester NH
671,Tulsa OK
711,Meridian MS
566,Harrisburg-Lancaster-Lebanon-York PA
526,Utica NY
622,New Orleans LA
662,Abilene-Sweetwater TX
618,Houston TX
511,Washington DC (Hagerstown MD)
800,Bakersfield CA
686,Mobile AL-Pensacola (Ft. Walton Beach) FL
524,Atlanta GA
790,Albuquerque-Santa Fe NM
508,Pittsburgh PA
525,Albany GA
522,Columbus GA
610,Rockford IL
640,Memphis TN
502,Binghamton NY
532,Albany-Schenectady-Troy NY
548,West Palm Beach-Ft. Pierce FL
570,Florence-Myrtle Beach SC
611,Rochester-Mason City-Austin IA
574,Johnstown-Altoona-State College PA
635,Austin TX
642,Lafayette LA
515,Cincinnati OH
512,Baltimore MD
510,Cleveland-Akron (Canton) OH
760,Twin Falls ID
702,La Crosse-Eau Claire WI
705,Wausau-Rhinelander WI
636,Harlingen-Weslaco-Brownsville-McAllen TX
541,Lexington KY
565,Elmira (Corning) NY
669,Madison WI
530,Tallahassee FL-Thomasville GA
501,New York NY
649,Evansville IN
747,Juneau AK
555,Syracuse NY
675,Peoria-Bloomington IL
687,Minot-Bismarck-Dickinson(Williston) ND
803,Los Angeles CA
722,Lincoln & Hastings-Kearney NE
602,Chicago IL
577,Wilkes Barre-Scranton PA
648,Champaign & Springfield-Decatur IL
734,Jonesboro AR
616,Kansas City MO
600,Corpus Christi TX
862,Sacramento-Stockton-Modesto CA
771,Yuma AZ-El Centro CA
598,Clarksburg-Weston WV
725,Sioux Falls(Mitchell) SD
802,Eureka CA
754,Butte-Bozeman MT
798,Glendive MT
627,Wichita Falls TX & Lawton OK
670,Ft. Smith-Fayetteville-Springdale-Rogers AR
698,Montgomery-Selma AL
569,Harrisonburg VA
556,Richmond-Petersburg VA
544,Norfolk-Portsmouth-Newport News VA
757,Boise ID
718,Jackson MS
613,Minneapolis-St. Paul MN
533,Hartford & New Haven CT
743,Anchorage AK
746,Biloxi-Gulfport MS
801,Eugene OR
571,Ft. Myers-Naples FL
745,Fairbanks AK
752,Colorado Springs-Pueblo CO
605,Topeka KS
513,Flint-Saginaw-Bay City MI
866,Fresno-Visalia CA
592,Gainesville FL
759,Cheyenne WY-Scottsbluff NE
624,Sioux City IA
650,Oklahoma City OK
503,Macon GA
692,Beaumont-Port Arthur TX
514,Buffalo NY
558,Lima OH
659,Nashville TN
Query:
-- 4. Retrieve search scores for top rising terms per DMA from TOP_TERMS
SELECT "dma_id", "dma_name", "term", "score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS"
WHERE "term" IN (
    SELECT DISTINCT "term"
    FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
    WHERE "week" BETWEEN '2022-10-01' AND '2022-10-31'
)
LIMIT 100;
Answer:
dma_id,dma_name,term,score
500,Portland-Auburn ME,49ers,8.0
500,Portland-Auburn ME,49ers,7.0
500,Portland-Auburn ME,49ers,25.0
500,Portland-Auburn ME,49ers,18.0
500,Portland-Auburn ME,49ers,16.0
500,Portland-Auburn ME,49ers,37.0
500,Portland-Auburn ME,49ers,16.0
500,Portland-Auburn ME,49ers,19.0
500,Portland-Auburn ME,49ers,13.0
500,Portland-Auburn ME,49ers,21.0
500,Portland-Auburn ME,49ers,26.0
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,3.0
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,2.0
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,2.0
500,Portland-Auburn ME,49ers,2.0
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,3.0
500,Portland-Auburn ME,49ers,10.0
500,Portland-Auburn ME,49ers,9.0
500,Portland-Auburn ME,49ers,7.0
500,Portland-Auburn ME,49ers,12.0
500,Portland-Auburn ME,49ers,17.0
500,Portland-Auburn ME,49ers,14.0
500,Portland-Auburn ME,49ers,4.0
500,Portland-Auburn ME,49ers,5.0
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,7.0
500,Portland-Auburn ME,49ers,9.0
500,Portland-Auburn ME,49ers,6.0
500,Portland-Auburn ME,49ers,12.0
500,Portland-Auburn ME,49ers,3.0
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,3.0
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,3.0
500,Portland-Auburn ME,49ers,3.0
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,3.0
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,4.0
500,Portland-Auburn ME,49ers,4.0
500,Portland-Auburn ME,49ers,11.0
500,Portland-Auburn ME,49ers,8.0
500,Portland-Auburn ME,49ers,13.0
500,Portland-Auburn ME,49ers,8.0
500,Portland-Auburn ME,49ers,5.0
500,Portland-Auburn ME,49ers,12.0
500,Portland-Auburn ME,49ers,5.0
500,Portland-Auburn ME,49ers,5.0
500,Portland-Auburn ME,49ers,12.0
500,Portland-Auburn ME,49ers,5.0
500,Portland-Auburn ME,49ers,7.0
500,Portland-Auburn ME,49ers,6.0
500,Portland-Auburn ME,49ers,19.0
500,Portland-Auburn ME,49ers,70.0
500,Portland-Auburn ME,49ers,3.0
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,2.0
500,Portland-Auburn ME,49ers,
500,Portland-Auburn ME,49ers,3.0
500,Portland-Auburn ME,49ers,3.0
500,Portland-Auburn ME,49ers,4.0
500,Portland-Auburn ME,49ers,9.0
500,Portland-Auburn ME,49ers,13.0
500,Portland-Auburn ME,49ers,8.0
500,Portland-Auburn ME,49ers,4.0
500,Portland-Auburn ME,49ers,14.0
500,Portland-Auburn ME,49ers,34.0
500,Portland-Auburn ME,49ers,8.0
500,Portland-Auburn ME,49ers,9.0
500,Portland-Auburn ME,49ers,15.0
500,Portland-Auburn ME,49ers,22.0
500,Portland-Auburn ME,49ers,60.0
500,Portland-Auburn ME,49ers,60.0
500,Portland-Auburn ME,49ers,2.0
Query:
-- 5. Sum search scores for each DMA for top rising terms
SELECT "dma_id", "dma_name", SUM("score") AS "total_score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS"
WHERE "term" IN (
    SELECT DISTINCT "term"
    FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
    WHERE "week" BETWEEN '2022-10-01' AND '2022-10-31'
)
GROUP BY "dma_id", "dma_name"
ORDER BY "total_score" DESC
LIMIT 100;
Answer:
dma_id,dma_name,total_score
868,Chico-Redding CA,11774
866,Fresno-Visalia CA,11395
862,Sacramento-Stockton-Modesto CA,10630
802,Eureka CA,10020
828,Monterey-Salinas CA,9878
813,Medford-Klamath Falls OR,9675
800,Bakersfield CA,8852
807,San Francisco-Oakland-San Jose CA,8813
855,Santa Barbara-Santa Maria-San Luis Obispo CA,8561
811,Reno NV,8255
820,Portland OR,7713
765,El Paso TX,7688
757,Boise ID,7686
744,Honolulu HI,7679
804,Palm Springs CA,7421
821,Bend OR,7253
881,Spokane WA,7231
790,Albuquerque-Santa Fe NM,7194
789,Tucson (Sierra Vista) AZ,7002
801,Eugene OR,7000
839,Las Vegas NV,6677
718,Jackson MS,6676
803,Los Angeles CA,6510
640,Memphis TN,6426
753,Phoenix AZ,6412
810,Yakima-Pasco-Richland-Kennewick WA,6411
743,Anchorage AK,6354
771,Yuma AZ-El Centro CA,6347
825,San Diego CA,6278
762,Missoula MT,6211
770,Salt Lake City UT,6181
725,Sioux Falls(Mitchell) SD,5738
635,Austin TX,5687
501,New York NY,5684
819,Seattle-Tacoma WA,5670
687,Minot-Bismarck-Dickinson(Williston) ND,5669
758,Idaho Falls-Pocatello ID,5658
544,Norfolk-Portsmouth-Newport News VA,5610
556,Richmond-Petersburg VA,5609
633,Odessa-Midland TX,5543
716,Baton Rouge LA,5536
546,Columbia SC,5522
517,Charlotte NC,5508
637,Cedar Rapids-Waterloo-Iowa City & Dubuque IA,5420
538,Rochester NY,5356
612,Shreveport LA,5324
533,Hartford & New Haven CT,5274
636,Harlingen-Weslaco-Brownsville-McAllen TX,5256
724,Fargo-Valley City ND,5242
641,San Antonio TX,5226
651,Lubbock TX,5206
754,Butte-Bozeman MT,5206
760,Twin Falls ID,5187
679,Des Moines-Ames IA,5159
532,Albany-Schenectady-Troy NY,5154
623,Dallas-Ft. Worth TX,5132
600,Corpus Christi TX,5109
647,Greenwood-Greenville MS,5050
573,Roanoke-Lynchburg VA,5047
682,Davenport IA-Rock Island-Moline IL,5037
521,Providence-New Bedford MA,5018
634,Amarillo TX,5004
566,Harrisburg-Lancaster-Lebanon-York PA,4988
622,New Orleans LA,4975
520,Augusta GA,4944
752,Colorado Springs-Pueblo CO,4927
518,Greensboro-High Point-Winston Salem NC,4921
536,Youngstown OH,4890
519,Charleston SC,4883
577,Wilkes Barre-Scranton PA,4848
543,Springfield-Holyoke MA,4841
756,Billings MT,4826
642,Lafayette LA,4817
628,Monroe LA-El Dorado AR,4786
625,Waco-Temple-Bryan TX,4747
710,Hattiesburg-Laurel MS,4745
751,Denver CO,4690
555,Syracuse NY,4665
542,Dayton OH,4657
570,Florence-Myrtle Beach SC,4636
506,Boston MA-Manchester NH,4623
516,Erie PA,4616
671,Tulsa OK,4615
548,West Palm Beach-Ft. Pierce FL,4590
560,Raleigh-Durham (Fayetteville) NC,4578
669,Madison WI,4576
755,Great Falls MT,4570
511,Washington DC (Hagerstown MD),4542
746,Biloxi-Gulfport MS,4532
610,Rockford IL,4522
673,Columbus-Tupelo-West Point MS,4516
624,Sioux City IA,4464
547,Toledo OH,4429
504,Philadelphia PA,4414
534,Orlando-Daytona Beach-Melbourne FL,4407
686,Mobile AL-Pensacola (Ft. Walton Beach) FL,4402
539,Tampa-St. Petersburg (Sarasota) FL,4383
524,Atlanta GA,4382
661,San Angelo TX,4376
650,Oklahoma City OK,4375
Query:
-- 6. Find top 10 terms from last October with highest percent gain
SELECT "term", "percent_gain"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
WHERE "week" BETWEEN '2022-10-01' AND '2022-10-31'
ORDER BY "percent_gain" DESC
LIMIT 10;
Answer:
term,percent_gain
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
Query:
-- 7. Get average scores per DMA for the top rising terms
SELECT "dma_id", "dma_name", AVG("score") AS "average_score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
WHERE "week" BETWEEN '2022-10-01' AND '2022-10-31'
GROUP BY "dma_id", "dma_name"
ORDER BY "average_score" DESC
LIMIT 100;
Answer:
dma_id,dma_name,average_score
798,Glendive MT,89.421053
740,North Platte NE,59.886076
747,Juneau AK,59.740260
552,Presque Isle ME,55.500000
766,Helena MT,54.657534
596,Zanesville OH,53.985000
583,Alpena MI,51.111111
549,Watertown NY,50.576642
773,Grand Junction-Montrose CO,50.195122
638,St. Joseph MO,49.248848
558,Lima OH,49.118132
736,Bowling Green KY,47.888383
597,Parkersburg WV,47.616379
767,Casper-Riverton WY,47.172840
639,Jackson TN,46.594787
526,Utica NY,46.092511
631,Ottumwa IA-Kirksville MO,45.972222
644,Alexandria LA,45.934028
734,Jonesboro AR,45.806250
764,Rapid City SD,45.708061
598,Clarksburg-Weston WV,45.699438
661,San Angelo TX,45.338028
647,Greenwood-Greenville MS,45.288321
626,Victoria TX,45.014286
760,Twin Falls ID,44.918841
606,Dothan AL,44.864253
711,Meridian MS,44.550388
759,Cheyenne WY-Scottsbluff NE,44.389961
569,Harrisonburg VA,44.170854
755,Great Falls MT,44.164706
737,Mankato MN,43.900383
802,Eureka CA,43.784091
525,Albany GA,43.717042
745,Fairbanks AK,43.565217
754,Butte-Bozeman MT,43.228758
565,Elmira (Corning) NY,43.159140
710,Hattiesburg-Laurel MS,43.035644
502,Binghamton NY,42.963190
643,Lake Charles LA,42.879828
553,Marquette MI,42.835784
582,Lafayette IN,42.809969
559,Bluefield-Beckley-Oak Hill WV,42.432494
746,Biloxi-Gulfport MS,42.426563
576,Salisbury MD,42.300380
657,Sherman-Ada OK,41.901923
554,Wheeling WV-Steubenville OH,41.427273
756,Billings MT,41.403888
611,Rochester-Mason City-Austin IA,41.120611
717,Quincy IL-Hannibal MO-Keokuk IA,40.994695
605,Topeka KS,40.816446
771,Yuma AZ-El Centro CA,40.812371
673,Columbus-Tupelo-West Point MS,40.745955
503,Macon GA,40.728750
762,Missoula MT,40.722567
743,Anchorage AK,40.523132
813,Medford-Klamath Falls OR,40.417094
758,Idaho Falls-Pocatello ID,40.333333
662,Abilene-Sweetwater TX,40.297710
516,Erie PA,40.252664
868,Chico-Redding CA,40.138112
603,Joplin MO-Pittsburg KS,40.127042
821,Bend OR,40.103359
610,Rockford IL,40.086103
581,Terre Haute IN,40.067061
522,Columbus GA,39.828467
687,Minot-Bismarck-Dickinson(Williston) ND,39.636704
656,Panama City FL,39.601983
628,Monroe LA-El Dorado AR,39.547993
692,Beaumont-Port Arthur TX,39.306854
627,Wichita Falls TX & Lawton OK,39.278689
570,Florence-Myrtle Beach SC,39.247120
624,Sioux City IA,39.168331
675,Peoria-Bloomington IL,38.974093
550,Wilmington NC,38.843236
564,Charleston-Huntington WV,38.733333
545,Greenville-New Bern-Washington NC,38.539313
804,Palm Springs CA,38.437898
537,Bangor ME,38.401316
575,Chattanooga TN,38.384127
698,Montgomery-Selma AL,38.361333
592,Gainesville FL,38.238450
531,Tri-Cities TN-VA,38.061881
555,Syracuse NY,38.046000
520,Augusta GA,37.974699
718,Jackson MS,37.961823
574,Johnstown-Altoona-State College PA,37.709091
634,Amarillo TX,37.633188
523,Burlington VT-Plattsburgh NY,37.249398
543,Springfield-Holyoke MA,37.210875
633,Odessa-Midland TX,37.204478
676,Duluth MN-Superior WI,37.195122
691,Huntsville-Decatur (Florence) AL,37.148380
810,Yakima-Pasco-Richland-Kennewick WA,37.132979
855,Santa Barbara-Santa Maria-San Luis Obispo CA,37.078261
540,Traverse City-Cadillac MI,36.904828
632,Paducah KY-Cape Girardeau MO-Harrisburg-Mount Vernon IL,36.865311
649,Evansville IN,36.861148
725,Sioux Falls(Mitchell) SD,36.771598
651,Lubbock TX,36.698910
542,Dayton OH,36.696881
Query:
-- 8. Count the number of times each term appears in TOP_RISING_TERMS
SELECT "term", COUNT(*) AS "appearance_count"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
GROUP BY "term"
ORDER BY "appearance_count" DESC
LIMIT 100;
Answer:
term,appearance_count
college football scores,495180
thursday night football,439320
monday night football,385140
cowboys game,384930
blooket,330120
ncaa football scores,330120
blooket join,275100
kahoot,275100
gimkit,275100
lions game,220080
alabama football,220080
ohio state football,220080
georgia football,220080
penn state football,220080
hurricane watch,220080
davante adams,220080
hurricane tracker,220080
colorado football,220080
hurricane helene,219870
emerson romero,219870
falcons,219870
tropical storm warning,165060
champions league,165060
iowa football,165060
hurricane milton tracker,165060
hurricane,165060
michigan football,165060
college football,165060
real madrid,165060
notre dame football,165060
hurricane milton,165060
uefa champions league,165060
nebraska football,165060
gimkit join,165060
padres,165060
anna delvey,165060
hurricane helene tracker,164850
menendez brothers,164850
jets,164850
agatha all along,164850
hurricane nadine,164850
yankees,110040
verizon outage,110040
pap definition,110040
bengals vs chiefs,110040
diddy,110040
premier league,110040
playstation network status,110040
patriots vs 49ers,110040
jaguars vs texans,110040
arch manning,110040
seahawks vs patriots,110040
monday night football tonight,110040
padres vs dodgers,110040
broncos vs buccaneers,110040
ncaa football,110040
buccaneers vs saints,110040
auburn football,110040
peal meaning,110040
gamut definition,110040
colombia vs chile,110040
milton path,110040
marcellus williams,110040
raiders vs ravens,110040
pete rose,110040
chargers vs broncos,110040
panthers vs raiders,110040
colorado vs ucf,110040
bears vs colts,110040
eagles vs saints,110040
witherspoon,110040
kris kristofferson,110040
auburn vs georgia,110040
priscilla presley,110040
bills vs jets,110040
jaguars vs bears,110040
how to register to vote in the us,110040
julienne,110040
chiefs vs falcons,110040
shiva,110040
jd vance,110040
minnesota vs michigan,110040
helene,110040
packers vs rams,110040
ratan tata,110040
packers vs titans,110040
aiden hutchinson,110040
steelers vs broncos,110040
colts vs titans,110040
gamut,110040
alabama vs georgia,110040
bills vs texans,110040
college football schedule,110040
wanda smith,110040
bengals vs giants,110040
skrrt,110040
venus de milo,110040
alabama vs vanderbilt,110040
witherspoon meaning,110040
rams vs bears,110040
Query:
-- 9. List terms and their average scores from TOP_TERMS
SELECT "term", AVG("score") AS "average_score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS"
GROUP BY "term"
ORDER BY "average_score" DESC
LIMIT 100;
Answer:
term,average_score
Metallica Tour' 2025,96.029586
Boise state VS- Hawaii,93.666667
D.E.I,93.046392
Panthers vs-raiders,92.728723
COVID-19 XEC variant,92.360000
BYUfootball,92.293814
E.l.f,88.619048
Mr. Prada,88.618182
Red Flag fire weather Warning,86.905350
Trump rally Long Island,85.926829
Devara review,84.057252
BioLab Conyers,83.852713
Michael Jordan mansion Highland Park,83.298561
Tyler Badie injury,83.125000
Gary Ruvkun,82.980392
Eggs recalled salmonella,82.435045
Huracan Milton trayectoria,82.062963
Kirby Smart Jets,82.041096
Tina Peters sentencing,81.573477
Florida homeless law,80.713355
Alma Police Department Morgan Nick,80.239865
Mi State vs Boston College,79.984962
Simpsons series finale,79.956113
SSI recipients extra check November,79.926254
Seth Altman,79.559140
George Baldock,79.491166
COVID XEC variant,79.316716
Missing cat Yellowstone,78.955090
Hurricane Kirk path,78.882530
Hurricane Helene death toll,78.834835
North Carolina governor Mark Robinson,78.608481
Rashee Rice injury update,78.603175
Social Security benefits 2025,78.422713
Aston Villa vs Bayern,78.317460
Mollie Kathleen Gold Mine,78.205047
Han Kang,78.177444
Chromakopia,78.099432
Ron Hale,78.098976
Is The port strike over,77.990476
Daniel Day-Lewis,77.977528
Disney World Hurricane Milton,77.852713
Real Madrid  Alavés,77.785498
Oprah and Kamala,77.751445
Trump watches,77.719880
Ghost of Yotei,77.640387
Teamsters endorsement,77.639296
England vs Greece,77.128527
Baby pygmy hippopotamus,77.127273
Kentucky Sheriff shoots Judge,76.880342
Nell Smith,76.851752
Kentucky sheriff shoots judge,76.650289
Peter Todd,76.065015
Taylor Rousseau Grigg,75.965789
Waterville Dam,75.956164
Mercury Morris,75.775457
Eduardo Xol,75.701449
California banning plastic bags,75.689895
Lilly Ledbetter,75.661891
McDonald's Halloween buckets,75.642173
Lucas Coly,75.618926
Lake Lure Dam,75.556452
Milan vs Liverpool,75.501377
Eric Adams indictment,75.484043
Missouri execution,75.483965
Ken Page,75.418605
Freddie Owens,75.339744
Is Hurricane Milton over,75.331148
Monsters Netflix Menendez,75.105769
Fever vs Mystics,75.048523
UCLA vs Penn State,74.990991
People's Choice Country Awards,74.685961
Helene storm path,74.114796
Hurricane Kirk,73.968051
Agatha All Along episode 5,73.578947
Agatha All Along Episode 4,73.307692
El Taiger,73.279720
Indigenous Peoples' Day,73.183607
Matthew Sluka,73.084656
Luis Tiant,73.041775
Mickey 17,73.010101
Yung Filly,73.005618
Todd Downing,72.948424
Wisconsin vs Rutgers,72.905556
Mid-Autumn Festival,72.822674
That '90s Show,72.703927
Brandon McManus,72.519512
Birmingham shooting,72.134211
It's What's Inside,71.946927
Geoffrey Hinton,71.835962
Oklahoma vs Auburn,71.825221
JD Souther,71.592075
Milton Hurricane update,71.229765
Nico Collins injury,70.847503
Nebraska vs Purdue,70.706122
Crystal Palace vs Man United,70.647597
Carly Gregg,70.519231
World Mental Health Day 2024,70.102667
FEMA Hurricane Helene,69.916256
Agatha All Along episode 6,69.795014
Tropicana implosion,69.476190
Query:
-- 10. Find DMAs with the highest number of unique terms
SELECT "dma_id", "dma_name", COUNT(DISTINCT "term") AS "unique_terms_count"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS"
GROUP BY "dma_id", "dma_name"
ORDER BY "unique_terms_count" DESC
LIMIT 100;
Answer:
dma_id,dma_name,unique_terms_count
538,Rochester NY,660
813,Medford-Klamath Falls OR,660
542,Dayton OH,660
600,Corpus Christi TX,660
673,Columbus-Tupelo-West Point MS,660
612,Shreveport LA,660
636,Harlingen-Weslaco-Brownsville-McAllen TX,660
702,La Crosse-Eau Claire WI,660
705,Wausau-Rhinelander WI,660
760,Twin Falls ID,660
717,Quincy IL-Hannibal MO-Keokuk IA,660
583,Alpena MI,660
557,Knoxville TN,660
716,Baton Rouge LA,660
564,Charleston-Huntington WV,660
765,El Paso TX,660
724,Fargo-Valley City ND,660
825,San Diego CA,660
675,Peoria-Bloomington IL,660
747,Juneau AK,660
602,Chicago IL,660
555,Syracuse NY,660
649,Evansville IN,660
803,Los Angeles CA,660
722,Lincoln & Hastings-Kearney NE,660
576,Salisbury MD,660
687,Minot-Bismarck-Dickinson(Williston) ND,660
527,Indianapolis IN,660
810,Yakima-Pasco-Richland-Kennewick WA,660
628,Monroe LA-El Dorado AR,660
651,Lubbock TX,660
767,Casper-Riverton WY,660
643,Lake Charles LA,660
507,Savannah GA,660
577,Wilkes Barre-Scranton PA,660
734,Jonesboro AR,660
648,Champaign & Springfield-Decatur IL,660
710,Hattiesburg-Laurel MS,660
839,Las Vegas NV,660
802,Eureka CA,660
725,Sioux Falls(Mitchell) SD,660
736,Bowling Green KY,660
588,South Bend-Elkhart IN,660
868,Chico-Redding CA,660
647,Greenwood-Greenville MS,660
573,Roanoke-Lynchburg VA,660
536,Youngstown OH,660
659,Nashville TN,660
558,Lima OH,660
679,Des Moines-Ames IA,660
514,Buffalo NY,660
549,Watertown NY,660
575,Chattanooga TN,660
766,Helena MT,660
811,Reno NV,660
626,Victoria TX,660
509,Ft. Wayne IN,660
819,Seattle-Tacoma WA,660
534,Orlando-Daytona Beach-Melbourne FL,660
511,Washington DC (Hagerstown MD),660
581,Terre Haute IN,660
641,San Antonio TX,660
828,Monterey-Salinas CA,660
546,Columbia SC,660
523,Burlington VT-Plattsburgh NY,660
625,Waco-Temple-Bryan TX,660
709,Tyler-Longview(Lufkin & Nacogdoches) TX,660
519,Charleston SC,660
652,Omaha NE,660
530,Tallahassee FL-Thomasville GA,660
501,New York NY,660
749,Laredo TX,660
535,Columbus OH,660
574,Johnstown-Altoona-State College PA,660
598,Clarksburg-Weston WV,660
771,Yuma AZ-El Centro CA,660
656,Panama City FL,660
693,Little Rock-Pine Bluff AR,660
758,Idaho Falls-Pocatello ID,660
801,Eugene OR,660
571,Ft. Myers-Naples FL,660
740,North Platte NE,660
751,Denver CO,660
567,Greenville-Spartanburg-Asheville-Anderson,660
862,Sacramento-Stockton-Modesto CA,660
584,Charlottesville VA,660
789,Tucson (Sierra Vista) AZ,660
560,Raleigh-Durham (Fayetteville) NC,660
520,Augusta GA,660
537,Bangor ME,660
508,Pittsburgh PA,660
790,Albuquerque-Santa Fe NM,660
610,Rockford IL,660
525,Albany GA,660
639,Jackson TN,660
531,Tri-Cities TN-VA,660
762,Missoula MT,660
616,Kansas City MO,660
633,Odessa-Midland TX,660
676,Duluth MN-Superior WI,660
End Exploring Related Columns
Task: Identify which DMA had the highest search scores for the terms that were top rising one year ago

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
dma_name,total_search_score
dma_name1:str,score1:int
(Attention: answer in one row)
```

**Explanation:**

The DMA (Designated Market Area) with the highest search scores for the terms that were top rising one year ago is identified by aggregating the search scores of those terms for each DMA. The DMA with the highest total search score across these terms is presented in the result..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'GOOGLE_TRENDS': {'GOOGLE_TRENDS': ['INTERNATIONAL_TOP_RISING_TERMS', 'INTERNATIONAL_TOP_TERMS', 'TOP_RISING_TERMS', 'TOP_TERMS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-24 06:49:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 06:49:21 - root - INFO - ```sql
SELECT "dma_name", SUM("score") AS "total_search_score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS"
WHERE "term" IN (
    SELECT DISTINCT "term"
    FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
    WHERE "week" BETWEEN '2022-10-01' AND '2022-10-31'
)
GROUP BY "dma_name"
ORDER BY "total_search_score" DESC NULLS LAST
LIMIT 1;
```
2025-01-24 06:49:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:49:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:49:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:49:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 06:49:22 - snowflake.connector.connection - INFO - closed
2025-01-24 06:49:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:49:23 - root - INFO - itercount: 1
2025-01-24 06:49:23 - root - INFO - 0
2025-01-24 06:49:23 - root - INFO - results: 
dma_name,total_search_score
Chico-Redding CA,11774


2025-01-24 06:49:23 - root - INFO - Please check the answer again by reviewing Identify which DMA had the highest search scores for the terms that were top rising one year ago, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
dma_name,total_search_score
dma_name1:str,score1:int
(Attention: answer in one row)
```

**Explanation:**

The DMA (Designated Market Area) with the highest search scores for the terms that were top rising one year ago is identified by aggregating the search scores of those terms for each DMA. The DMA with the highest total search score across these terms is presented in the result. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
dma_name,total_search_score
Chico-Redding CA,11774
Current sql:
SELECT "dma_name", SUM("score") AS "total_search_score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS"
WHERE "term" IN (
    SELECT DISTINCT "term"
    FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
    WHERE "week" BETWEEN '2022-10-01' AND '2022-10-31'
)
GROUP BY "dma_name"
ORDER BY "total_search_score" DESC NULLS LAST
LIMIT 1;
2025-01-24 06:50:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 06:50:01 - root - INFO - ```sql
SELECT "dma_name", SUM("score") AS "total_search_score"
FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_TERMS"
WHERE "term" IN (
    SELECT DISTINCT "term"
    FROM "GOOGLE_TRENDS"."GOOGLE_TRENDS"."TOP_RISING_TERMS"
    WHERE "week" BETWEEN '2022-10-01' AND '2022-10-31'
)
GROUP BY "dma_name"
ORDER BY "total_search_score" DESC NULLS LAST
LIMIT 1;
```
2025-01-24 06:50:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:50:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:50:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:50:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 06:50:03 - snowflake.connector.connection - INFO - closed
2025-01-24 06:50:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:50:03 - root - INFO - itercount: 2
2025-01-24 06:50:03 - root - INFO - 0
2025-01-24 06:50:03 - root - INFO - Total iteration counts: 2
