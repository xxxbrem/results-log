2025-01-27 10:00:10 - openai._base_client - INFO - Retrying request to /chat/completions in 0.453600 seconds
2025-01-27 10:00:59 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 10:00:59 - root - INFO - SQL:
SELECT DISTINCT "Location" FROM "SalaryDataset" LIMIT 100;
Results:
Location
Bangalore
Pune
Hyderabad
New Delhi
Mumbai

2025-01-27 10:00:59 - root - INFO - SQL:
SELECT DISTINCT "CompanyName" FROM "SalaryDataset" LIMIT 100;
Results:
CompanyName
Mu Sigma
IBM
Tata Consultancy Services
Impact Analytics
Accenture
Infosys
Capgemini
Cognizant Technology Solutions
Anheuser-Busch InBev
Fractal
Embibe
Amazon
Google
Flipkart
HP Inc.
Wipro
Ericsson-Worldwide
MiQ
Deloitte
Microsoft
Genpact
Fresher
Société Générale
Flutura
Fuzzy Logix
DXC Technology
Jio
Honeywell
Affine
Philips
Bharat Light & Power
Antuit
Nielsen
[24]7.ai
Fidelity Investments
Myntra
First Student
Oracle
Ola
Walmart Global Tech
Tredence
Intel Corporation
Mercedes-Benz Research and Development India
SAP
Wipro Technologies
Thoucentric
Walmart
Brillio
Great Learning
Gramener
HCL Technologies
Happiest Minds Technologies
Hewlett Packard Enterprise | HPE
Noodle.ai
Cisco Systems
INSOFE
Optum
Adobe
ABB
EY
Swiggy
Subex
iNeuron
ZS Associates
Robert Bosch India
Scienaptic Systems
FlyNava Technologies
Nokia
UnitedHealth Group
Sigmoid Analytics
Idexcel
Citi
GE Healthcare
SigTuple
Dell Technologies
Ericsson IT Solutions & Services
Aptus Data Labs
UniQreate
LinkedIn
Apexon
Shadowfax Technologies
Bharti Airtel
Applied Materials
FICO
YouPlus
Mphasis
Target
Gojek
Blueocean Market Intelligence
CRED
Rolls-Royce
Curl Analytics
J.P. Morgan
Knowledge Lens
ascena
QuantZig
Baker Hughes
Everlytics
Siemens
ANZ Bank

2025-01-27 10:00:59 - root - INFO - SQL:
SELECT DISTINCT "Salary" FROM "SalaryDataset" LIMIT 100;
Results:
Salary
"₹6,48,573/yr"
"₹11,91,950/yr"
"₹8,36,874/yr"
"₹6,69,578/yr"
"₹9,44,110/yr"
"₹9,08,764/yr"
"₹9,26,124/yr"
"₹7,36,708/yr"
"₹16,46,721/yr"
"₹13,92,960/yr"
"₹14,04,773/yr"
"₹15,07,343/yr"
"₹15,58,095/yr"
"₹25,57,843/yr"
"₹15,10,081/yr"
"₹7,32,821/yr"
"₹12,21,750/yr"
"₹17,39,484/yr"
"₹11,24,939/yr"
"₹16,30,396/yr"
"₹10,09,436/yr"
"₹5,50,980/yr"
"₹18,70,000/yr"
"₹7,58,376/yr"
"₹15,56,575/yr"
"₹11,94,327/yr"
"₹14,70,000/yr"
"₹15,49,942/yr"
"₹15,41,572/yr"
"₹8,11,182/yr"
"₹12,05,874/yr"
"₹7,27,111/yr"
"₹19,23,257/yr"
"₹21,43,501/yr"
"₹19,26,965/yr"
"₹41,271/mo"
"₹12,94,984/yr"
"₹23,34,960/yr"
"₹22,67,616/yr"
"₹13,66,992/yr"
"₹14,53,427/yr"
"₹14,58,032/yr"
"₹17,30,166/yr"
"₹6,58,109/yr"
"₹7,94,460/yr"
"₹25,67,381/yr"
"₹16,37,231/yr"
"₹9,00,000/yr"
"₹9,02,935/yr"
"₹9,70,782/yr"
"₹10,50,000/yr"
"₹21,19,584/yr"
"₹16,87,111/yr"
"₹14,65,641/yr"
"₹6,00,000/yr"
"₹18,05,869/yr"
"₹26,24,063/yr"
"₹9,55,297/yr"
"₹7,61,478/yr"
"₹28,05,476/yr"
"₹9,69,112/yr"
"₹4,50,979/yr"
"₹13,38,795/yr"
"₹10,40,493/yr"
"₹12,91,549/yr"
"₹49,928/mo"
"₹16,63,189/yr"
"₹13,23,387/yr"
"₹12,46,266/yr"
"₹4,94,147/yr"
"₹18,92,758/yr"
"₹15,72,054/yr"
"₹20,24,533/yr"
"₹19,27,564/yr"
"₹8,00,000/yr"
"₹20,09,790/yr"
"₹8,31,462/yr"
"₹5,16,323/yr"
"₹23,33,241/yr"
"₹12,00,000/yr"
"₹20,06,522/yr"
"₹21,60,000/yr"
"₹13,41,316/yr"
"₹16,34,105/yr"
"₹13,89,256/yr"
"₹10,00,000/yr"
"₹12,31,116/yr"
"₹23,52,941/yr"
"₹7,44,551/yr"
"₹30,14,686/yr"
"₹13,57,204/yr"
"₹10,53,196/yr"
"₹13,37,606/yr"
"₹48,825/mo"
"₹32,953/mo"
"₹16,49,930/yr"
"₹11,38,060/yr"
"₹16,12,744/yr"
"₹4,32,776/yr"
"₹9,87,471/yr"

2025-01-27 10:00:59 - root - INFO - SQL:
SELECT "Location", COUNT(*) AS "NumberOfEntries"
   FROM "SalaryDataset"
   GROUP BY "Location"
   LIMIT 100;
Results:
Location,NumberOfEntries
Bangalore,1584
Hyderabad,669
Mumbai,617
New Delhi,656
Pune,818

2025-01-27 10:00:59 - root - INFO - SQL:
SELECT "Location", "Salary"
   FROM "SalaryDataset"
   WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
   LIMIT 100;
Results:
Location,Salary
Pune,"₹7,17,331/yr"
Pune,"₹11,63,186/yr"
Pune,"₹10,36,536/yr"
Pune,"₹7,42,883/yr"
Pune,"₹12,94,039/yr"
Pune,"₹11,54,579/yr"
Pune,"₹7,65,632/yr"
Pune,"₹6,02,937/yr"
Pune,"₹11,50,000/yr"
Pune,"₹8,54,957/yr"
Pune,"₹9,56,307/yr"
Pune,"₹8,16,946/yr"
Pune,"₹10,70,536/yr"
Pune,"₹11,46,043/yr"
Pune,"₹11,14,163/yr"
Pune,"₹20,54,972/yr"
Pune,"₹11,34,768/yr"
Pune,"₹8,78,252/yr"
Pune,"₹8,98,351/yr"
Pune,"₹8,14,017/yr"
Pune,"₹4,25,000/yr"
Pune,"₹9,40,423/yr"
Pune,"₹11,21,845/yr"
Pune,"₹12,15,906/yr"
Pune,"₹10,55,811/yr"
Pune,"₹16,22,612/yr"
Pune,"₹42,249/mo"
Pune,"₹7,18,534/yr"
Pune,"₹4,23,422/yr"
Pune,"₹17,33,746/yr"
Pune,"₹16,55,120/yr"
Pune,"₹14,21,672/yr"
Pune,"₹9,34,857/yr"
Pune,"₹8,56,429/yr"
Pune,"₹18,00,000/yr"
Pune,"₹4,11,680/yr"
Pune,"₹61,248/mo"
Pune,"₹51,920/mo"
Pune,"₹2,32,796/mo"
Pune,"₹10,01,630/yr"
Pune,"₹15,77,759/yr"
Pune,"₹52,491/mo"
Pune,"₹52,16,933/yr"
Pune,"₹14,63,658/yr"
Pune,"₹17,72,001/yr"
Pune,"₹8,34,387/yr"
Pune,"₹8,28,221/yr"
Pune,"₹1,00,275/mo"
Pune,"₹9,32,104/yr"
Pune,"₹9,83,550/yr"
Pune,"₹25,446/mo"
Pune,₹602/hr
Pune,"₹53,475/mo"
Pune,"₹11,61,602/yr"
Pune,"₹63,058/mo"
Pune,"₹46,977/mo"
Pune,"₹2,83,914/yr"
Pune,"₹7,31,758/yr"
Pune,"₹16,87,208/yr"
Pune,"₹7,13,466/yr"
Pune,"₹56,250/mo"
Pune,"₹4,99,961/yr"
Pune,"₹8,95,000/yr"
Pune,"₹2,53,851/yr"
Pune,"₹6,37,645/yr"
Pune,"₹19,54,650/yr"
Pune,"₹6,69,083/yr"
Pune,"₹18,33,778/yr"
Pune,"₹25,000/mo"
Pune,"£7,03,427/yr"
Pune,"₹1,15,884/yr"
Pune,"₹6,19,069/yr"
Pune,"₹16,00,000/yr"
Pune,"₹30,147/mo"
Pune,"₹4,00,000/yr"
Pune,"₹6,42,322/yr"
Pune,"₹1,01,398/mo"
Pune,"₹30,000/mo"
Pune,"₹2,89,045/mo"
Pune,"₹75,71,032/yr"
Pune,"₹14,38,481/yr"
Pune,"₹2,141/hr"
Pune,"₹1,00,000/mo"
Pune,"₹44,44,315/yr"
Pune,"₹3,01,469/yr"
Pune,"£2,05,049/yr"
Pune,"₹70,000/mo"
Pune,"₹6,00,000/yr"
Pune,"₹6,42,322/yr"
Pune,"₹9,05,000/yr"
Pune,"₹6,23,238/yr"
Pune,"₹8,70,000/yr"
Pune,"₹64,232/mo"
Pune,"₹12,50,000/yr"
Pune,"₹11,76,710/yr"
Pune,"₹4,14,794/yr"
Pune,"₹25,69,287/yr"
Pune,"₹14,04,565/yr"
Pune,"₹7,87,318/yr"
Pune,"₹20,54,972/yr"

2025-01-27 10:00:59 - root - INFO - SQL:
SELECT "Salary",
          REPLACE(REPLACE(REPLACE(REPLACE("Salary", '$', ''), ',', ''), ' per year', ''), ' per month', '') AS "SalaryNumeric"
   FROM "SalaryDataset"
   LIMIT 100;
Results:
Salary,SalaryNumeric
"₹6,48,573/yr",₹648573/yr
"₹11,91,950/yr",₹1191950/yr
"₹8,36,874/yr",₹836874/yr
"₹6,69,578/yr",₹669578/yr
"₹9,44,110/yr",₹944110/yr
"₹9,08,764/yr",₹908764/yr
"₹9,26,124/yr",₹926124/yr
"₹7,36,708/yr",₹736708/yr
"₹16,46,721/yr",₹1646721/yr
"₹13,92,960/yr",₹1392960/yr
"₹14,04,773/yr",₹1404773/yr
"₹15,07,343/yr",₹1507343/yr
"₹15,58,095/yr",₹1558095/yr
"₹25,57,843/yr",₹2557843/yr
"₹15,10,081/yr",₹1510081/yr
"₹7,32,821/yr",₹732821/yr
"₹12,21,750/yr",₹1221750/yr
"₹17,39,484/yr",₹1739484/yr
"₹11,24,939/yr",₹1124939/yr
"₹16,30,396/yr",₹1630396/yr
"₹10,09,436/yr",₹1009436/yr
"₹5,50,980/yr",₹550980/yr
"₹18,70,000/yr",₹1870000/yr
"₹7,58,376/yr",₹758376/yr
"₹15,56,575/yr",₹1556575/yr
"₹11,94,327/yr",₹1194327/yr
"₹14,70,000/yr",₹1470000/yr
"₹15,49,942/yr",₹1549942/yr
"₹10,09,436/yr",₹1009436/yr
"₹15,41,572/yr",₹1541572/yr
"₹8,11,182/yr",₹811182/yr
"₹12,05,874/yr",₹1205874/yr
"₹7,27,111/yr",₹727111/yr
"₹19,23,257/yr",₹1923257/yr
"₹21,43,501/yr",₹2143501/yr
"₹19,26,965/yr",₹1926965/yr
"₹41,271/mo",₹41271/mo
"₹12,94,984/yr",₹1294984/yr
"₹23,34,960/yr",₹2334960/yr
"₹22,67,616/yr",₹2267616/yr
"₹13,66,992/yr",₹1366992/yr
"₹14,53,427/yr",₹1453427/yr
"₹14,58,032/yr",₹1458032/yr
"₹17,30,166/yr",₹1730166/yr
"₹6,58,109/yr",₹658109/yr
"₹7,94,460/yr",₹794460/yr
"₹25,67,381/yr",₹2567381/yr
"₹16,37,231/yr",₹1637231/yr
"₹9,00,000/yr",₹900000/yr
"₹9,02,935/yr",₹902935/yr
"₹9,70,782/yr",₹970782/yr
"₹10,50,000/yr",₹1050000/yr
"₹21,19,584/yr",₹2119584/yr
"₹16,87,111/yr",₹1687111/yr
"₹14,65,641/yr",₹1465641/yr
"₹6,00,000/yr",₹600000/yr
"₹18,05,869/yr",₹1805869/yr
"₹26,24,063/yr",₹2624063/yr
"₹9,55,297/yr",₹955297/yr
"₹7,61,478/yr",₹761478/yr
"₹28,05,476/yr",₹2805476/yr
"₹9,69,112/yr",₹969112/yr
"₹4,50,979/yr",₹450979/yr
"₹13,38,795/yr",₹1338795/yr
"₹10,40,493/yr",₹1040493/yr
"₹12,91,549/yr",₹1291549/yr
"₹49,928/mo",₹49928/mo
"₹16,63,189/yr",₹1663189/yr
"₹13,23,387/yr",₹1323387/yr
"₹12,46,266/yr",₹1246266/yr
"₹4,94,147/yr",₹494147/yr
"₹18,92,758/yr",₹1892758/yr
"₹15,72,054/yr",₹1572054/yr
"₹20,24,533/yr",₹2024533/yr
"₹19,27,564/yr",₹1927564/yr
"₹8,00,000/yr",₹800000/yr
"₹20,09,790/yr",₹2009790/yr
"₹8,31,462/yr",₹831462/yr
"₹5,16,323/yr",₹516323/yr
"₹23,33,241/yr",₹2333241/yr
"₹12,00,000/yr",₹1200000/yr
"₹20,06,522/yr",₹2006522/yr
"₹21,60,000/yr",₹2160000/yr
"₹13,41,316/yr",₹1341316/yr
"₹16,34,105/yr",₹1634105/yr
"₹13,89,256/yr",₹1389256/yr
"₹10,00,000/yr",₹1000000/yr
"₹12,31,116/yr",₹1231116/yr
"₹23,52,941/yr",₹2352941/yr
"₹7,44,551/yr",₹744551/yr
"₹30,14,686/yr",₹3014686/yr
"₹13,57,204/yr",₹1357204/yr
"₹10,53,196/yr",₹1053196/yr
"₹13,37,606/yr",₹1337606/yr
"₹48,825/mo",₹48825/mo
"₹32,953/mo",₹32953/mo
"₹16,49,930/yr",₹1649930/yr
"₹11,38,060/yr",₹1138060/yr
"₹16,12,744/yr",₹1612744/yr
"₹4,32,776/yr",₹432776/yr

2025-01-27 10:01:58 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 10:01:58 - root - INFO - ```sql
SELECT
    sd."Location",
    sd."CompanyName",
    AVG(
        CASE
            WHEN sd."Salary" LIKE '%/yr' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE(
                                    REPLACE(
                                        sd."Salary",
                                        '₹', ''
                                    ),
                                    ',', ''
                                ),
                                '/yr', ''
                            ),
                            ' per year', ''
                        ),
                        ' ', ''
                    ) AS REAL
                )
            WHEN sd."Salary" LIKE '%/mo' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE(
                                    REPLACE(
                                        sd."Salary",
                                        '₹', ''
                                    ),
                                    ',', ''
                                ),
                                '/mo', ''
                            ),
                            ' per month', ''
                        ),
                        ' ', ''
                    ) AS REAL
                ) * 12
            WHEN sd."Salary" LIKE '%/hr' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE(
                                    REPLACE(
                                        sd."Salary",
                                        '₹', ''
                                    ),
                                    ',', ''
                                ),
                                '/hr', ''
                            ),
                            ' per hour', ''
                        ),
                        ' ', ''
                    ) AS REAL
                ) * 8 * 250
            ELSE NULL
        END
    ) AS "Average Salary in State",
    (
        SELECT AVG(
            CASE
                WHEN sd2."Salary" LIKE '%/yr' THEN
                    CAST(
                        REPLACE(
                            REPLACE(
                                REPLACE(
                                    REPLACE(
                                        REPLACE(
                                            sd2."Salary",
                                            '₹', ''
                                        ),
                                        ',', ''
                                    ),
                                    '/yr', ''
                                ),
                                ' per year', ''
                            ),
                            ' ', ''
                        ) AS REAL
                    )
                WHEN sd2."Salary" LIKE '%/mo' THEN
                    CAST(
                        REPLACE(
                            REPLACE(
                                REPLACE(
                                    REPLACE(
                                        REPLACE(
                                            sd2."Salary",
                                            '₹', ''
                                        ),
                                        ',', ''
                                    ),
                                    '/mo', ''
                                ),
                                ' per month', ''
                            ),
                            ' ', ''
                        ) AS REAL
                    ) * 12
                WHEN sd2."Salary" LIKE '%/hr' THEN
                    CAST(
                        REPLACE(
                            REPLACE(
                                REPLACE(
                                    REPLACE(
                                        REPLACE(
                                            sd2."Salary",
                                            '₹', ''
                                        ),
                                        ',', ''
                                    ),
                                    '/hr', ''
                                ),
                                ' per hour', ''
                            ),
                            ' ', ''
                        ) AS REAL
                    ) * 8 * 250
                ELSE NULL
            END
        )
        FROM "SalaryDataset" sd2
        WHERE sd2."CompanyName" = sd."CompanyName"
    ) AS "Average Salary in Country"
FROM "SalaryDataset" sd
WHERE sd."Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
GROUP BY sd."Location", sd."CompanyName"
ORDER BY "Average Salary in State" DESC
LIMIT 5;
```
2025-01-27 10:02:45 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 10:02:45 - root - INFO - SQL:
SELECT
    sd."Location",
    sd."CompanyName",
    AVG(
        CASE
            WHEN sd."Salary" LIKE '%/yr' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE(
                                    REPLACE(
                                        sd."Salary",
                                        '₹', ''
                                    ),
                                    ',', ''
                                ),
                                '/yr', ''
                            ),
                            ' per year', ''
                        ),
                        ' ', ''
                    ) AS REAL
                )
            WHEN sd."Salary" LIKE '%/mo' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE(
                                    REPLACE(
                                        sd."Salary",
                                        '₹', ''
                                    ),
                                    ',', ''
                                ),
                                '/mo', ''
                            ),
                            ' per month', ''
                        ),
                        ' ', ''
                    ) AS REAL
                ) * 12
            WHEN sd."Salary" LIKE '%/hr' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE(
                                    REPLACE(
                                        sd."Salary",
                                        '₹', ''
                                    ),
                                    ',', ''
                                ),
                                '/hr', ''
                            ),
                            ' per hour', ''
                        ),
                        ' ', ''
                    ) AS REAL
                ) * 8 * 250
            ELSE NULL
        END
    ) AS "Average Salary in State",
    (
        SELECT AVG(
            CASE
                WHEN sd2."Salary" LIKE '%/yr' THEN
                    CAST(
                        REPLACE(
                            REPLACE(
                                REPLACE(
                                    REPLACE(
                                        REPLACE(
                                            sd2."Salary",
                                            '₹', ''
                                        ),
                                        ',', ''
                                    ),
                                    '/yr', ''
                                ),
                                ' per year', ''
                            ),
                            ' ', ''
                        ) AS REAL
                    )
                WHEN sd2."Salary" LIKE '%/mo' THEN
                    CAST(
                        REPLACE(
                            REPLACE(
                                REPLACE(
                                    REPLACE(
                                        REPLACE(
                                            sd2."Salary",
                                            '₹', ''
                                        ),
                                        ',', ''
                                    ),
                                    '/mo', ''
                                ),
                                ' per month', ''
                            ),
                            ' ', ''
                        ) AS REAL
                    ) * 12
                WHEN sd2."Salary" LIKE '%/hr' THEN
                    CAST(
                        REPLACE(
                            REPLACE(
                                REPLACE(
                                    REPLACE(
                                        REPLACE(
                                            sd2."Salary",
                                            '₹', ''
                                        ),
                                        ',', ''
                                    ),
                                    '/hr', ''
                                ),
                                ' per hour', ''
                            ),
                            ' ', ''
                        ) AS REAL
                    ) * 8 * 250
                ELSE NULL
            END
        )
        FROM "SalaryDataset" sd2
        WHERE sd2."CompanyName" = sd."CompanyName"
    ) AS "Average Salary in Country"
FROM "SalaryDataset" sd
WHERE sd."Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
GROUP BY sd."Location", sd."CompanyName"
ORDER BY "Average Salary in State" DESC
LIMIT 5;
Results:
Location,CompanyName,Average Salary in State,Average Salary in Country
Mumbai,Rahul Industries,6044006.0,3203617.0
Hyderabad,Meta,6034000.0,5274337.0
Pune,Atos,5273205.0,5273205.0
Pune,Volkswagen,5184922.0,5184922.0
Hyderabad,Qwerty Concepts,5081882.0,5081882.0

2025-01-27 10:02:45 - root - INFO - SQL:
SELECT
    "CompanyName",
    AVG(
        CASE
            WHEN "Salary" LIKE '%/yr' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE("Salary", '₹', ''),
                                ',', ''
                            ),
                            '/yr',
                            ''
                        ),
                        ' ',
                        ''
                    ) AS REAL
                )
            WHEN "Salary" LIKE '%/mo' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE("Salary", '₹', ''),
                                ',', ''
                            ),
                            '/mo',
                            ''
                        ),
                        ' ',
                        ''
                    ) AS REAL
                ) * 12
            WHEN "Salary" LIKE '%/hr' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE("Salary", '₹', ''),
                                ',', ''
                            ),
                            '/hr',
                            ''
                        ),
                        ' ',
                        ''
                    ) AS REAL
                ) * 8 * 250
            ELSE NULL
        END
    ) AS "AverageSalaryInState"
FROM "SalaryDataset"
WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
GROUP BY "CompanyName"
LIMIT 100
Results:
CompanyName,AverageSalaryInState
,1193394.6666666667
159 Solutions,828777.0
1mg,991426.0
20K Group,42892.0
2COMS,725546.0
3LOQ Labs,778644.0
3i Infotech,734390.0
54y4,1200000.0
5x,450000.0
6sense,515940.0
72 Dragons,276516.0
91springboard,750000.0
AAKASH,601956.0
AB Innovative Software,426816.0
ABC,727593.75
ABC Supply Co.,524121.0
ABC do ABC,513743.0
ABCDEF,2039825.3333333333
ABSAS Solutions,267396.0
ACD Communications,866307.0
ACS Solutions,992754.0
ADHOC Services,563464.0
ADP,1011690.2
AGS Health,413352.0
AGS Transact Technologies,423084.0
AI Touch,181620.0
AIG,1187386.0
AIR Worldwide,398975.0
ALBOT,600000.0
ANB Systems,1500000.0
ANSHULTECH,103166.0
AON,2385732.0
AROHA TECHNOLOGIES,621588.0
ASD,2363988.0
ASSAD,517986.0
ATS Services (India),412440.0
AXA,1070000.0
AXA GO Business Operations,1210770.0
AXA XL,731213.0
AXIS MY INDIA,374059.0
Aays Analytics,894346.0
Abhijeet Group,222840.0
Absolutdata,558121.0
Abzooba,1269893.8333333333
Accenture,770538.5909090909
Accion Labs,406548.0
Acclivis Technologies,1003261.0
Accretive Wiz@work Consultants,1300000.0
Actiknow,363669.0
Activa (CA),1490685.0
Acuity Knowledge Partners,508899.0
Acuris Global,144720.0
Adani Group,95700.0
Add Innovations,310791.0
Adda 247,127836.0
Adglobal360,835736.5
Aditi Software,469326.0
Aditya Birla Group,812590.0
Adobe,871087.0
Advanced Infrastructure Engineering,363228.0
Advisory Board,414388.0
Aegis,3626400.0
Aegon,2508152.0
Aera Technology,1118107.25
Aera Technology Associate,1007334.0
Aeries Technology,1410268.0
AffinityX,193764.0
Agape Marketing Agency,564654.0
Agile CRM,312884.0
Aibono,120000.0
Aikon Labs,314473.0
Aikon Technologies,471708.0
Airavaat Car Rentals,1400000.0
Airpay,892152.0
Ajay bharti,401953.0
Ajeenkya DY Patil University,414794.0
Akaike Technologies,904395.0
Aktana,1800000.0
Algo Engines,1200000.0
Algo8.ai,575502.0
AlgoAnalytics Financial Consultancy,1219564.0
AlgoAnalytics Pvt. Ltd.,1444692.0
AlgonoX Technologies,1074883.0
Algoritmo (Singapore),192696.0
Algoscale,537441.0
Aligned Automation,2579455.0
Alliance Healthcare,300000.0
Allianz,369852.0
Allstate,540810.0
Alpha Alternatives,187404.0
Alphonso Global Solutions,258900.0
Altimetrik,1572363.0
Altius Equipments,380088.0
Amadeus,339420.0
Aman Singh,120000.0
Amazon,621040.2916666666
Amazon Flex,464246.0
Ambrapali Electrotech,413058.0
Amdocs,773543.0
Ameex,429953.0

2025-01-27 10:02:45 - root - INFO - SQL:
SELECT
    "CompanyName",
    AVG(
        CASE
            WHEN "Salary" LIKE '%/yr' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE("Salary", '₹', ''),
                                ',', ''
                            ),
                            '/yr',
                            ''
                        ),
                        ' ',
                        ''
                    ) AS REAL
                )
            WHEN "Salary" LIKE '%/mo' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE("Salary", '₹', ''),
                                ',', ''
                            ),
                            '/mo',
                            ''
                        ),
                        ' ',
                        ''
                    ) AS REAL
                ) * 12
            WHEN "Salary" LIKE '%/hr' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE("Salary", '₹', ''),
                                ',', ''
                            ),
                            '/hr',
                            ''
                        ),
                        ' ',
                        ''
                    ) AS REAL
                ) * 8 * 250
            ELSE NULL
        END
    ) AS "AverageSalaryInCountry"
FROM "SalaryDataset"
GROUP BY "CompanyName"
LIMIT 100
Results:
CompanyName,AverageSalaryInCountry
,1193394.6666666667
& Other Stories,722247.0
---,120000.0
159 Solutions,828777.0
1mg,991426.0
20K Group,32260.0
2COMS,467574.0
360DigiTMG,359620.0
3K Technologies,798116.0
3LOQ Labs,778644.0
3i Infotech,734390.0
4CRisk.ai,700000.0
54y4,1200000.0
5x,450000.0
6sense,515940.0
72 Dragons,276516.0
91springboard,750000.0
AAKASH,601956.0
AAP,321161.0
AB Innovative Software,426816.0
ABB,955297.0
ABC,854280.05
ABC Consultants,4282144.0
ABC Supply Co.,524121.0
ABC Tech,732816.0
ABC do ABC,513743.0
ABCDEF,1643757.75
ABSAS Solutions,267396.0
ACD Communications,866307.0
ACS Solutions,992754.0
ADHOC Services,563464.0
ADP,1011690.2
AFFINSYS AI,1450359.0
AGS Health,413352.0
AGS Transact Technologies,423084.0
AI Touch,181620.0
AIEnterprise,712525.0
AIG,922211.5
AIR Worldwide,398975.0
AIndra Labs,304188.0
AJIO,180000.0
ALBOT,600000.0
ALL IT Services,904392.0
ALTEN,1461604.0
AMCORE Financial,1800000.0
AMPROVIT TECHNOLOGIES,810204.0
ANB Systems,1500000.0
ANSHULTECH,103166.0
ANZ Bank,1111352.0
AON,2385732.0
AROHA TECHNOLOGIES,621588.0
ASD,2363988.0
ASSAD,517986.0
ATS Services (India),412440.0
AXA,1144288.0
AXA GO Business Operations,1344055.0
AXA XL,731213.0
AXIS MY INDIA,374059.0
Aashish sharma,1225579.0
Aays Analytics,894346.0
Abbott,1124740.0
Abhijeet Group,222840.0
Abhinav Immigration Services Pvt. Ltd.,1324539.0
Absolutdata,558121.0
Abzooba,1269893.8333333333
Acalvio,2442736.0
Accentue,1041548.5
Accenture,743136.4333333333
Accion Labs,406548.0
Acclivis Technologies,1003261.0
Accretive Wiz@work Consultants,1300000.0
Accurence,1227876.0
Acies,415492.0
Actiknow,363669.0
Activa (CA),1490685.0
Acuity Knowledge Partners,508899.0
Acuris Global,144720.0
AdWyze,380808.0
Adani Group,95700.0
Adappt Intelligence,360000.0
Add Innovations,310791.0
Adda 247,127836.0
Adecco,1349689.0
Adglobal360,835736.5
Aditi Software,469326.0
Aditya Birla Group,1086794.0
Admit.me,1973587.0
Adobe,1032769.25
Advanced Infrastructure Engineering,363228.0
Advisory Board,414388.0
Aegis,1993310.0
Aegon,2508152.0
Aera Technology,1118107.25
Aera Technology Associate,1007334.0
Aeries Technology,1410268.0
Affine,784572.0
AffinityAnswers,735014.0
AffinityX,193764.0
Affle,933286.0
AgEye Technologies,518492.0

2025-01-27 10:02:45 - root - INFO - SQL:
SELECT
    "CompanyName",
    AVG(
        CASE
            WHEN "Salary" LIKE '%/yr' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE("Salary", '₹', ''),
                                ',', ''
                            ),
                            '/yr',
                            ''
                        ),
                        ' ',
                        ''
                    ) AS REAL
                )
            WHEN "Salary" LIKE '%/mo' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE("Salary", '₹', ''),
                                ',', ''
                            ),
                            '/mo',
                            ''
                        ),
                        ' ',
                        ''
                    ) AS REAL
                ) * 12
            WHEN "Salary" LIKE '%/hr' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE("Salary", '₹', ''),
                                ',', ''
                            ),
                            '/hr',
                            ''
                        ),
                        ' ',
                        ''
                    ) AS REAL
                ) * 8 * 250
            ELSE NULL
        END
    ) AS "AverageSalaryInState"
FROM "SalaryDataset"
WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
GROUP BY "CompanyName"
ORDER BY "AverageSalaryInState" DESC
LIMIT 5
Results:
CompanyName,AverageSalaryInState
Meta,6034000.0
Atos,5273205.0
Volkswagen,5184922.0
Qwerty Concepts,5081882.0
RAKESH GROUP,5016304.0

2025-01-27 10:02:45 - root - INFO - itercount: 0
2025-01-27 10:02:45 - root - INFO - Table: hardware_dim_customerDDL:
CREATE TABLE "hardware_dim_customer" (
"customer_code" INTEGER,
  "customer" TEXT,
  "platform" TEXT,
  "channel" TEXT,
  "market" TEXT,
  "sub_zone" TEXT,
  "region" TEXT
)
Table: hardware_fact_pre_invoice_deductionsDDL:
CREATE TABLE "hardware_fact_pre_invoice_deductions" (
"customer_code" INTEGER,
  "fiscal_year" INTEGER,
  "pre_invoice_discount_pct" REAL
)
Table: web_sales_repsDDL:
CREATE TABLE "web_sales_reps" (
"id" INTEGER,
  "name" TEXT,
  "region_id" INTEGER
)
Table: hardware_dim_productDDL:
CREATE TABLE "hardware_dim_product" (
"product_code" TEXT,
  "division" TEXT,
  "segment" TEXT,
  "category" TEXT,
  "product" TEXT,
  "variant" TEXT
)
Table: web_ordersDDL:
CREATE TABLE "web_orders" (
"id" INTEGER,
  "account_id" INTEGER,
  "occurred_at" TEXT,
  "standard_qty" INTEGER,
  "gloss_qty" INTEGER,
  "poster_qty" INTEGER,
  "total" INTEGER,
  "standard_amt_usd" REAL,
  "gloss_amt_usd" REAL,
  "poster_amt_usd" REAL,
  "total_amt_usd" REAL
)
Table: StaffHoursDDL:
CREATE TABLE "StaffHours" (
"StaffMember" TEXT,
  "EventDate" TEXT,
  "EventTime" TEXT,
  "EventType" TEXT
)
Table: university_enrollmentDDL:
CREATE TABLE "university_enrollment" (
"OfferNo" INTEGER,
  "StdNo" INTEGER,
  "EnrGrade" REAL
)
Table: university_facultyDDL:
CREATE TABLE "university_faculty" (
"FacNo" INTEGER,
  "FacFirstName" TEXT,
  "FacLastName" TEXT,
  "FacCity" TEXT,
  "FacState" TEXT,
  "FacDept" TEXT,
  "FacRank" TEXT,
  "FacSalary" INTEGER,
  "FacSupervisor" REAL,
  "FacHireDate" TEXT,
  "FacZipCode" TEXT
)
Table: university_studentDDL:
CREATE TABLE "university_student" (
"StdNo" INTEGER,
  "StdFirstName" TEXT,
  "StdLastName" TEXT,
  "StdCity" TEXT,
  "StdState" TEXT,
  "StdZip" TEXT,
  "StdMajor" TEXT,
  "StdClass" TEXT,
  "StdGPA" REAL
)
Table: university_offeringDDL:
CREATE TABLE "university_offering" (
"OfferNo" INTEGER,
  "CourseNo" TEXT,
  "OffTerm" TEXT,
  "OffYear" INTEGER,
  "OffLocation" TEXT,
  "OffTime" TEXT,
  "FacNo" REAL,
  "OffDays" TEXT
)
Table: web_accountsDDL:
CREATE TABLE "web_accounts" (
"id" INTEGER,
  "name" TEXT,
  "website" TEXT,
  "lat" REAL,
  "long" REAL,
  "primary_poc" TEXT,
  "sales_rep_id" INTEGER
)
Table: web_eventsDDL:
CREATE TABLE "web_events" (
"id" INTEGER,
  "account_id" INTEGER,
  "occurred_at" TEXT,
  "channel" TEXT
)
Table: SalaryDatasetDDL:
CREATE TABLE "SalaryDataset" (
"index" INTEGER,
  "CompanyName" TEXT,
  "JobTitle" TEXT,
  "SalariesReported" REAL,
  "Location" TEXT,
  "Salary" TEXT
)
Table: web_regionDDL:
CREATE TABLE "web_region" (
"id" INTEGER,
  "name" TEXT
)
Table: hardware_fact_gross_priceDDL:
CREATE TABLE "hardware_fact_gross_price" (
"product_code" TEXT,
  "fiscal_year" INTEGER,
  "gross_price" REAL
)
Table: hardware_fact_manufacturing_costDDL:
CREATE TABLE "hardware_fact_manufacturing_cost" (
"product_code" TEXT,
  "cost_year" INTEGER,
  "manufacturing_cost" REAL
)
Table: university_courseDDL:
CREATE TABLE "university_course" (
"CourseNo" TEXT,
  "CrsDesc" TEXT,
  "CrsUnits" INTEGER
)
Table: hardware_fact_sales_monthlyDDL:
CREATE TABLE "hardware_fact_sales_monthly" (
"date" TEXT,
  "product_code" TEXT,
  "customer_code" INTEGER,
  "sold_quantity" INTEGER,
  "fiscal_year" INTEGER
)
External knowledge that might be helpful: 
None
The table structure information is (table names): 
['hardware_dim_customer', 'hardware_fact_pre_invoice_deductions', 'web_sales_reps', 'hardware_dim_product', 'web_orders', 'StaffHours', 'university_enrollment', 'university_faculty', 'university_student', 'university_offering', 'web_accounts', 'web_events', 'SalaryDataset', 'web_region', 'hardware_fact_gross_price', 'hardware_fact_manufacturing_cost', 'university_course', 'hardware_fact_sales_monthly']
Begin Exploring Related Columns
**Relevant Columns and Potential Usage:**

- `"CompanyName"`: Used to identify and group data by company.
- `"Location"`: Used to filter data for Mumbai, Pune, New Delhi, and Hyderabad.
- `"Salary"`: Contains salary information that needs to be converted to numerical values for averaging.

**Conditions that may be used:**

- Filter `"Location"` to include only 'Mumbai', 'Pune', 'New Delhi', 'Hyderabad'.
- Extract numeric values from `"Salary"` by removing non-numeric characters like '$', ',', ' per year', and ' per month'.
- Group data by `"CompanyName"` to calculate average salaries.

**SQL Queries:**

1. **View distinct locations in the dataset:**
   ```sql
   SELECT DISTINCT "Location" FROM "SalaryDataset" LIMIT 100;
   ```

2. **View distinct company names in the dataset:**
   ```sql
   SELECT DISTINCT "CompanyName" FROM "SalaryDataset" LIMIT 100;
   ```

3. **View distinct salary formats to understand how to extract numeric values:**
   ```sql
   SELECT DISTINCT "Salary" FROM "SalaryDataset" LIMIT 100;
   ```

4. **Count the number of salary entries per location:**
   ```sql
   SELECT "Location", COUNT(*) AS "NumberOfEntries"
   FROM "SalaryDataset"
   GROUP BY "Location"
   LIMIT 100;
   ```

5. **Retrieve sample salaries for the specified cities:**
   ```sql
   SELECT "Location", "Salary"
   FROM "SalaryDataset"
   WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
   LIMIT 100;
   ```

6. **Extract numeric salary values by removing non-numeric characters:**
   ```sql
   SELECT "Salary",
          REPLACE(REPLACE(REPLACE(REPLACE("Salary", '$', ''), ',', ''), ' per year', ''), ' per month', '') AS "SalaryNumeric"
   FROM "SalaryDataset"
   LIMIT 100;
   ```

7. **Convert the extracted salary values to a numeric data type:**
   ```sql
   SELECT "Salary",
          CAST(REPLACE(REPLACE(REPLACE(REPLACE("Salary", '$', ''), ',', ''), ' per year', ''), ' per month', '') AS REAL) AS "SalaryNumeric"
   FROM "SalaryDataset"
   LIMIT 100;
   ```

8. **Calculate the average salary per company in the specified cities:**
   ```sql
   SELECT "CompanyName",
          AVG(CAST(REPLACE(REPLACE(REPLACE(REPLACE("Salary", '$', ''), ',', ''), ' per year', ''), ' per month', '') AS REAL)) AS "AverageSalaryInState"
   FROM "SalaryDataset"
   WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
   GROUP BY "CompanyName"
   LIMIT 100;
   ```

9. **Calculate the national average salary per company:**
   ```sql
   SELECT "CompanyName",
          AVG(CAST(REPLACE(REPLACE(REPLACE(REPLACE("Salary", '$', ''), ',', ''), ' per year', ''), ' per month', '') AS REAL)) AS "AverageSalaryInCountry"
   FROM "SalaryDataset"
   GROUP BY "CompanyName"
   LIMIT 100;
   ```

10. **Identify the top 5 companies by average salary in the specified cities:**
    ```sql
    SELECT "CompanyName",
           AVG(CAST(REPLACE(REPLACE(REPLACE(REPLACE("Salary", '$', ''), ',', ''), ' per year', ''), ' per month', '') AS REAL)) AS "AverageSalaryInState"
    FROM "SalaryDataset"
    WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
    GROUP BY "CompanyName"
    ORDER BY "AverageSalaryInState" DESC
    LIMIT 5;
    ```

These queries help in understanding the data structure and extracting the necessary information to create the detailed report as per the task requirements.Query:
SELECT DISTINCT "Location" FROM "SalaryDataset" LIMIT 100;
Answer:
Location
Bangalore
Pune
Hyderabad
New Delhi
Mumbai
Query:
SELECT DISTINCT "CompanyName" FROM "SalaryDataset" LIMIT 100;
Answer:
CompanyName
Mu Sigma
IBM
Tata Consultancy Services
Impact Analytics
Accenture
Infosys
Capgemini
Cognizant Technology Solutions
Anheuser-Busch InBev
Fractal
Embibe
Amazon
Google
Flipkart
HP Inc.
Wipro
Ericsson-Worldwide
MiQ
Deloitte
Microsoft
Genpact
Fresher
Société Générale
Flutura
Fuzzy Logix
DXC Technology
Jio
Honeywell
Affine
Philips
Bharat Light & Power
Antuit
Nielsen
[24]7.ai
Fidelity Investments
Myntra
First Student
Oracle
Ola
Walmart Global Tech
Tredence
Intel Corporation
Mercedes-Benz Research and Development India
SAP
Wipro Technologies
Thoucentric
Walmart
Brillio
Great Learning
Gramener
HCL Technologies
Happiest Minds Technologies
Hewlett Packard Enterprise | HPE
Noodle.ai
Cisco Systems
INSOFE
Optum
Adobe
ABB
EY
Swiggy
Subex
iNeuron
ZS Associates
Robert Bosch India
Scienaptic Systems
FlyNava Technologies
Nokia
UnitedHealth Group
Sigmoid Analytics
Idexcel
Citi
GE Healthcare
SigTuple
Dell Technologies
Ericsson IT Solutions & Services
Aptus Data Labs
UniQreate
LinkedIn
Apexon
Shadowfax Technologies
Bharti Airtel
Applied Materials
FICO
YouPlus
Mphasis
Target
Gojek
Blueocean Market Intelligence
CRED
Rolls-Royce
Curl Analytics
J.P. Morgan
Knowledge Lens
ascena
QuantZig
Baker Hughes
Everlytics
Siemens
ANZ Bank
Query:
SELECT DISTINCT "Salary" FROM "SalaryDataset" LIMIT 100;
Answer:
Salary
"₹6,48,573/yr"
"₹11,91,950/yr"
"₹8,36,874/yr"
"₹6,69,578/yr"
"₹9,44,110/yr"
"₹9,08,764/yr"
"₹9,26,124/yr"
"₹7,36,708/yr"
"₹16,46,721/yr"
"₹13,92,960/yr"
"₹14,04,773/yr"
"₹15,07,343/yr"
"₹15,58,095/yr"
"₹25,57,843/yr"
"₹15,10,081/yr"
"₹7,32,821/yr"
"₹12,21,750/yr"
"₹17,39,484/yr"
"₹11,24,939/yr"
"₹16,30,396/yr"
"₹10,09,436/yr"
"₹5,50,980/yr"
"₹18,70,000/yr"
"₹7,58,376/yr"
"₹15,56,575/yr"
"₹11,94,327/yr"
"₹14,70,000/yr"
"₹15,49,942/yr"
"₹15,41,572/yr"
"₹8,11,182/yr"
"₹12,05,874/yr"
"₹7,27,111/yr"
"₹19,23,257/yr"
"₹21,43,501/yr"
"₹19,26,965/yr"
"₹41,271/mo"
"₹12,94,984/yr"
"₹23,34,960/yr"
"₹22,67,616/yr"
"₹13,66,992/yr"
"₹14,53,427/yr"
"₹14,58,032/yr"
"₹17,30,166/yr"
"₹6,58,109/yr"
"₹7,94,460/yr"
"₹25,67,381/yr"
"₹16,37,231/yr"
"₹9,00,000/yr"
"₹9,02,935/yr"
"₹9,70,782/yr"
"₹10,50,000/yr"
"₹21,19,584/yr"
"₹16,87,111/yr"
"₹14,65,641/yr"
"₹6,00,000/yr"
"₹18,05,869/yr"
"₹26,24,063/yr"
"₹9,55,297/yr"
"₹7,61,478/yr"
"₹28,05,476/yr"
"₹9,69,112/yr"
"₹4,50,979/yr"
"₹13,38,795/yr"
"₹10,40,493/yr"
"₹12,91,549/yr"
"₹49,928/mo"
"₹16,63,189/yr"
"₹13,23,387/yr"
"₹12,46,266/yr"
"₹4,94,147/yr"
"₹18,92,758/yr"
"₹15,72,054/yr"
"₹20,24,533/yr"
"₹19,27,564/yr"
"₹8,00,000/yr"
"₹20,09,790/yr"
"₹8,31,462/yr"
"₹5,16,323/yr"
"₹23,33,241/yr"
"₹12,00,000/yr"
"₹20,06,522/yr"
"₹21,60,000/yr"
"₹13,41,316/yr"
"₹16,34,105/yr"
"₹13,89,256/yr"
"₹10,00,000/yr"
"₹12,31,116/yr"
"₹23,52,941/yr"
"₹7,44,551/yr"
"₹30,14,686/yr"
"₹13,57,204/yr"
"₹10,53,196/yr"
"₹13,37,606/yr"
"₹48,825/mo"
"₹32,953/mo"
"₹16,49,930/yr"
"₹11,38,060/yr"
"₹16,12,744/yr"
"₹4,32,776/yr"
"₹9,87,471/yr"
Query:
SELECT "Location", COUNT(*) AS "NumberOfEntries"
   FROM "SalaryDataset"
   GROUP BY "Location"
   LIMIT 100;
Answer:
Location,NumberOfEntries
Bangalore,1584
Hyderabad,669
Mumbai,617
New Delhi,656
Pune,818
Query:
SELECT "Location", "Salary"
   FROM "SalaryDataset"
   WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
   LIMIT 100;
Answer:
Location,Salary
Pune,"₹7,17,331/yr"
Pune,"₹11,63,186/yr"
Pune,"₹10,36,536/yr"
Pune,"₹7,42,883/yr"
Pune,"₹12,94,039/yr"
Pune,"₹11,54,579/yr"
Pune,"₹7,65,632/yr"
Pune,"₹6,02,937/yr"
Pune,"₹11,50,000/yr"
Pune,"₹8,54,957/yr"
Pune,"₹9,56,307/yr"
Pune,"₹8,16,946/yr"
Pune,"₹10,70,536/yr"
Pune,"₹11,46,043/yr"
Pune,"₹11,14,163/yr"
Pune,"₹20,54,972/yr"
Pune,"₹11,34,768/yr"
Pune,"₹8,78,252/yr"
Pune,"₹8,98,351/yr"
Pune,"₹8,14,017/yr"
Pune,"₹4,25,000/yr"
Pune,"₹9,40,423/yr"
Pune,"₹11,21,845/yr"
Pune,"₹12,15,906/yr"
Pune,"₹10,55,811/yr"
Pune,"₹16,22,612/yr"
Pune,"₹42,249/mo"
Pune,"₹7,18,534/yr"
Pune,"₹4,23,422/yr"
Pune,"₹17,33,746/yr"
Pune,"₹16,55,120/yr"
Pune,"₹14,21,672/yr"
Pune,"₹9,34,857/yr"
Pune,"₹8,56,429/yr"
Pune,"₹18,00,000/yr"
Pune,"₹4,11,680/yr"
Pune,"₹61,248/mo"
Pune,"₹51,920/mo"
Pune,"₹2,32,796/mo"
Pune,"₹10,01,630/yr"
Pune,"₹15,77,759/yr"
Pune,"₹52,491/mo"
Pune,"₹52,16,933/yr"
Pune,"₹14,63,658/yr"
Pune,"₹17,72,001/yr"
Pune,"₹8,34,387/yr"
Pune,"₹8,28,221/yr"
Pune,"₹1,00,275/mo"
Pune,"₹9,32,104/yr"
Pune,"₹9,83,550/yr"
Pune,"₹25,446/mo"
Pune,₹602/hr
Pune,"₹53,475/mo"
Pune,"₹11,61,602/yr"
Pune,"₹63,058/mo"
Pune,"₹46,977/mo"
Pune,"₹2,83,914/yr"
Pune,"₹7,31,758/yr"
Pune,"₹16,87,208/yr"
Pune,"₹7,13,466/yr"
Pune,"₹56,250/mo"
Pune,"₹4,99,961/yr"
Pune,"₹8,95,000/yr"
Pune,"₹2,53,851/yr"
Pune,"₹6,37,645/yr"
Pune,"₹19,54,650/yr"
Pune,"₹6,69,083/yr"
Pune,"₹18,33,778/yr"
Pune,"₹25,000/mo"
Pune,"£7,03,427/yr"
Pune,"₹1,15,884/yr"
Pune,"₹6,19,069/yr"
Pune,"₹16,00,000/yr"
Pune,"₹30,147/mo"
Pune,"₹4,00,000/yr"
Pune,"₹6,42,322/yr"
Pune,"₹1,01,398/mo"
Pune,"₹30,000/mo"
Pune,"₹2,89,045/mo"
Pune,"₹75,71,032/yr"
Pune,"₹14,38,481/yr"
Pune,"₹2,141/hr"
Pune,"₹1,00,000/mo"
Pune,"₹44,44,315/yr"
Pune,"₹3,01,469/yr"
Pune,"£2,05,049/yr"
Pune,"₹70,000/mo"
Pune,"₹6,00,000/yr"
Pune,"₹6,42,322/yr"
Pune,"₹9,05,000/yr"
Pune,"₹6,23,238/yr"
Pune,"₹8,70,000/yr"
Pune,"₹64,232/mo"
Pune,"₹12,50,000/yr"
Pune,"₹11,76,710/yr"
Pune,"₹4,14,794/yr"
Pune,"₹25,69,287/yr"
Pune,"₹14,04,565/yr"
Pune,"₹7,87,318/yr"
Pune,"₹20,54,972/yr"
Query:
SELECT "Salary",
          REPLACE(REPLACE(REPLACE(REPLACE("Salary", '$', ''), ',', ''), ' per year', ''), ' per month', '') AS "SalaryNumeric"
   FROM "SalaryDataset"
   LIMIT 100;
Answer:
Salary,SalaryNumeric
"₹6,48,573/yr",₹648573/yr
"₹11,91,950/yr",₹1191950/yr
"₹8,36,874/yr",₹836874/yr
"₹6,69,578/yr",₹669578/yr
"₹9,44,110/yr",₹944110/yr
"₹9,08,764/yr",₹908764/yr
"₹9,26,124/yr",₹926124/yr
"₹7,36,708/yr",₹736708/yr
"₹16,46,721/yr",₹1646721/yr
"₹13,92,960/yr",₹1392960/yr
"₹14,04,773/yr",₹1404773/yr
"₹15,07,343/yr",₹1507343/yr
"₹15,58,095/yr",₹1558095/yr
"₹25,57,843/yr",₹2557843/yr
"₹15,10,081/yr",₹1510081/yr
"₹7,32,821/yr",₹732821/yr
"₹12,21,750/yr",₹1221750/yr
"₹17,39,484/yr",₹1739484/yr
"₹11,24,939/yr",₹1124939/yr
"₹16,30,396/yr",₹1630396/yr
"₹10,09,436/yr",₹1009436/yr
"₹5,50,980/yr",₹550980/yr
"₹18,70,000/yr",₹1870000/yr
"₹7,58,376/yr",₹758376/yr
"₹15,56,575/yr",₹1556575/yr
"₹11,94,327/yr",₹1194327/yr
"₹14,70,000/yr",₹1470000/yr
"₹15,49,942/yr",₹1549942/yr
"₹10,09,436/yr",₹1009436/yr
"₹15,41,572/yr",₹1541572/yr
"₹8,11,182/yr",₹811182/yr
"₹12,05,874/yr",₹1205874/yr
"₹7,27,111/yr",₹727111/yr
"₹19,23,257/yr",₹1923257/yr
"₹21,43,501/yr",₹2143501/yr
"₹19,26,965/yr",₹1926965/yr
"₹41,271/mo",₹41271/mo
"₹12,94,984/yr",₹1294984/yr
"₹23,34,960/yr",₹2334960/yr
"₹22,67,616/yr",₹2267616/yr
"₹13,66,992/yr",₹1366992/yr
"₹14,53,427/yr",₹1453427/yr
"₹14,58,032/yr",₹1458032/yr
"₹17,30,166/yr",₹1730166/yr
"₹6,58,109/yr",₹658109/yr
"₹7,94,460/yr",₹794460/yr
"₹25,67,381/yr",₹2567381/yr
"₹16,37,231/yr",₹1637231/yr
"₹9,00,000/yr",₹900000/yr
"₹9,02,935/yr",₹902935/yr
"₹9,70,782/yr",₹970782/yr
"₹10,50,000/yr",₹1050000/yr
"₹21,19,584/yr",₹2119584/yr
"₹16,87,111/yr",₹1687111/yr
"₹14,65,641/yr",₹1465641/yr
"₹6,00,000/yr",₹600000/yr
"₹18,05,869/yr",₹1805869/yr
"₹26,24,063/yr",₹2624063/yr
"₹9,55,297/yr",₹955297/yr
"₹7,61,478/yr",₹761478/yr
"₹28,05,476/yr",₹2805476/yr
"₹9,69,112/yr",₹969112/yr
"₹4,50,979/yr",₹450979/yr
"₹13,38,795/yr",₹1338795/yr
"₹10,40,493/yr",₹1040493/yr
"₹12,91,549/yr",₹1291549/yr
"₹49,928/mo",₹49928/mo
"₹16,63,189/yr",₹1663189/yr
"₹13,23,387/yr",₹1323387/yr
"₹12,46,266/yr",₹1246266/yr
"₹4,94,147/yr",₹494147/yr
"₹18,92,758/yr",₹1892758/yr
"₹15,72,054/yr",₹1572054/yr
"₹20,24,533/yr",₹2024533/yr
"₹19,27,564/yr",₹1927564/yr
"₹8,00,000/yr",₹800000/yr
"₹20,09,790/yr",₹2009790/yr
"₹8,31,462/yr",₹831462/yr
"₹5,16,323/yr",₹516323/yr
"₹23,33,241/yr",₹2333241/yr
"₹12,00,000/yr",₹1200000/yr
"₹20,06,522/yr",₹2006522/yr
"₹21,60,000/yr",₹2160000/yr
"₹13,41,316/yr",₹1341316/yr
"₹16,34,105/yr",₹1634105/yr
"₹13,89,256/yr",₹1389256/yr
"₹10,00,000/yr",₹1000000/yr
"₹12,31,116/yr",₹1231116/yr
"₹23,52,941/yr",₹2352941/yr
"₹7,44,551/yr",₹744551/yr
"₹30,14,686/yr",₹3014686/yr
"₹13,57,204/yr",₹1357204/yr
"₹10,53,196/yr",₹1053196/yr
"₹13,37,606/yr",₹1337606/yr
"₹48,825/mo",₹48825/mo
"₹32,953/mo",₹32953/mo
"₹16,49,930/yr",₹1649930/yr
"₹11,38,060/yr",₹1138060/yr
"₹16,12,744/yr",₹1612744/yr
"₹4,32,776/yr",₹432776/yr
Query:
SELECT
    sd."Location",
    sd."CompanyName",
    AVG(
        CASE
            WHEN sd."Salary" LIKE '%/yr' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE(
                                    REPLACE(
                                        sd."Salary",
                                        '₹', ''
                                    ),
                                    ',', ''
                                ),
                                '/yr', ''
                            ),
                            ' per year', ''
                        ),
                        ' ', ''
                    ) AS REAL
                )
            WHEN sd."Salary" LIKE '%/mo' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE(
                                    REPLACE(
                                        sd."Salary",
                                        '₹', ''
                                    ),
                                    ',', ''
                                ),
                                '/mo', ''
                            ),
                            ' per month', ''
                        ),
                        ' ', ''
                    ) AS REAL
                ) * 12
            WHEN sd."Salary" LIKE '%/hr' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE(
                                    REPLACE(
                                        sd."Salary",
                                        '₹', ''
                                    ),
                                    ',', ''
                                ),
                                '/hr', ''
                            ),
                            ' per hour', ''
                        ),
                        ' ', ''
                    ) AS REAL
                ) * 8 * 250
            ELSE NULL
        END
    ) AS "Average Salary in State",
    (
        SELECT AVG(
            CASE
                WHEN sd2."Salary" LIKE '%/yr' THEN
                    CAST(
                        REPLACE(
                            REPLACE(
                                REPLACE(
                                    REPLACE(
                                        REPLACE(
                                            sd2."Salary",
                                            '₹', ''
                                        ),
                                        ',', ''
                                    ),
                                    '/yr', ''
                                ),
                                ' per year', ''
                            ),
                            ' ', ''
                        ) AS REAL
                    )
                WHEN sd2."Salary" LIKE '%/mo' THEN
                    CAST(
                        REPLACE(
                            REPLACE(
                                REPLACE(
                                    REPLACE(
                                        REPLACE(
                                            sd2."Salary",
                                            '₹', ''
                                        ),
                                        ',', ''
                                    ),
                                    '/mo', ''
                                ),
                                ' per month', ''
                            ),
                            ' ', ''
                        ) AS REAL
                    ) * 12
                WHEN sd2."Salary" LIKE '%/hr' THEN
                    CAST(
                        REPLACE(
                            REPLACE(
                                REPLACE(
                                    REPLACE(
                                        REPLACE(
                                            sd2."Salary",
                                            '₹', ''
                                        ),
                                        ',', ''
                                    ),
                                    '/hr', ''
                                ),
                                ' per hour', ''
                            ),
                            ' ', ''
                        ) AS REAL
                    ) * 8 * 250
                ELSE NULL
            END
        )
        FROM "SalaryDataset" sd2
        WHERE sd2."CompanyName" = sd."CompanyName"
    ) AS "Average Salary in Country"
FROM "SalaryDataset" sd
WHERE sd."Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
GROUP BY sd."Location", sd."CompanyName"
ORDER BY "Average Salary in State" DESC
LIMIT 5;
Answer:
Location,CompanyName,Average Salary in State,Average Salary in Country
Mumbai,Rahul Industries,6044006.0,3203617.0
Hyderabad,Meta,6034000.0,5274337.0
Pune,Atos,5273205.0,5273205.0
Pune,Volkswagen,5184922.0,5184922.0
Hyderabad,Qwerty Concepts,5081882.0,5081882.0
Query:
SELECT
    "CompanyName",
    AVG(
        CASE
            WHEN "Salary" LIKE '%/yr' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE("Salary", '₹', ''),
                                ',', ''
                            ),
                            '/yr',
                            ''
                        ),
                        ' ',
                        ''
                    ) AS REAL
                )
            WHEN "Salary" LIKE '%/mo' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE("Salary", '₹', ''),
                                ',', ''
                            ),
                            '/mo',
                            ''
                        ),
                        ' ',
                        ''
                    ) AS REAL
                ) * 12
            WHEN "Salary" LIKE '%/hr' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE("Salary", '₹', ''),
                                ',', ''
                            ),
                            '/hr',
                            ''
                        ),
                        ' ',
                        ''
                    ) AS REAL
                ) * 8 * 250
            ELSE NULL
        END
    ) AS "AverageSalaryInState"
FROM "SalaryDataset"
WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
GROUP BY "CompanyName"
LIMIT 100
Answer:
CompanyName,AverageSalaryInState
,1193394.6666666667
159 Solutions,828777.0
1mg,991426.0
20K Group,42892.0
2COMS,725546.0
3LOQ Labs,778644.0
3i Infotech,734390.0
54y4,1200000.0
5x,450000.0
6sense,515940.0
72 Dragons,276516.0
91springboard,750000.0
AAKASH,601956.0
AB Innovative Software,426816.0
ABC,727593.75
ABC Supply Co.,524121.0
ABC do ABC,513743.0
ABCDEF,2039825.3333333333
ABSAS Solutions,267396.0
ACD Communications,866307.0
ACS Solutions,992754.0
ADHOC Services,563464.0
ADP,1011690.2
AGS Health,413352.0
AGS Transact Technologies,423084.0
AI Touch,181620.0
AIG,1187386.0
AIR Worldwide,398975.0
ALBOT,600000.0
ANB Systems,1500000.0
ANSHULTECH,103166.0
AON,2385732.0
AROHA TECHNOLOGIES,621588.0
ASD,2363988.0
ASSAD,517986.0
ATS Services (India),412440.0
AXA,1070000.0
AXA GO Business Operations,1210770.0
AXA XL,731213.0
AXIS MY INDIA,374059.0
Aays Analytics,894346.0
Abhijeet Group,222840.0
Absolutdata,558121.0
Abzooba,1269893.8333333333
Accenture,770538.5909090909
Accion Labs,406548.0
Acclivis Technologies,1003261.0
Accretive Wiz@work Consultants,1300000.0
Actiknow,363669.0
Activa (CA),1490685.0
Acuity Knowledge Partners,508899.0
Acuris Global,144720.0
Adani Group,95700.0
Add Innovations,310791.0
Adda 247,127836.0
Adglobal360,835736.5
Aditi Software,469326.0
Aditya Birla Group,812590.0
Adobe,871087.0
Advanced Infrastructure Engineering,363228.0
Advisory Board,414388.0
Aegis,3626400.0
Aegon,2508152.0
Aera Technology,1118107.25
Aera Technology Associate,1007334.0
Aeries Technology,1410268.0
AffinityX,193764.0
Agape Marketing Agency,564654.0
Agile CRM,312884.0
Aibono,120000.0
Aikon Labs,314473.0
Aikon Technologies,471708.0
Airavaat Car Rentals,1400000.0
Airpay,892152.0
Ajay bharti,401953.0
Ajeenkya DY Patil University,414794.0
Akaike Technologies,904395.0
Aktana,1800000.0
Algo Engines,1200000.0
Algo8.ai,575502.0
AlgoAnalytics Financial Consultancy,1219564.0
AlgoAnalytics Pvt. Ltd.,1444692.0
AlgonoX Technologies,1074883.0
Algoritmo (Singapore),192696.0
Algoscale,537441.0
Aligned Automation,2579455.0
Alliance Healthcare,300000.0
Allianz,369852.0
Allstate,540810.0
Alpha Alternatives,187404.0
Alphonso Global Solutions,258900.0
Altimetrik,1572363.0
Altius Equipments,380088.0
Amadeus,339420.0
Aman Singh,120000.0
Amazon,621040.2916666666
Amazon Flex,464246.0
Ambrapali Electrotech,413058.0
Amdocs,773543.0
Ameex,429953.0
Query:
SELECT
    "CompanyName",
    AVG(
        CASE
            WHEN "Salary" LIKE '%/yr' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE("Salary", '₹', ''),
                                ',', ''
                            ),
                            '/yr',
                            ''
                        ),
                        ' ',
                        ''
                    ) AS REAL
                )
            WHEN "Salary" LIKE '%/mo' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE("Salary", '₹', ''),
                                ',', ''
                            ),
                            '/mo',
                            ''
                        ),
                        ' ',
                        ''
                    ) AS REAL
                ) * 12
            WHEN "Salary" LIKE '%/hr' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE("Salary", '₹', ''),
                                ',', ''
                            ),
                            '/hr',
                            ''
                        ),
                        ' ',
                        ''
                    ) AS REAL
                ) * 8 * 250
            ELSE NULL
        END
    ) AS "AverageSalaryInCountry"
FROM "SalaryDataset"
GROUP BY "CompanyName"
LIMIT 100
Answer:
CompanyName,AverageSalaryInCountry
,1193394.6666666667
& Other Stories,722247.0
---,120000.0
159 Solutions,828777.0
1mg,991426.0
20K Group,32260.0
2COMS,467574.0
360DigiTMG,359620.0
3K Technologies,798116.0
3LOQ Labs,778644.0
3i Infotech,734390.0
4CRisk.ai,700000.0
54y4,1200000.0
5x,450000.0
6sense,515940.0
72 Dragons,276516.0
91springboard,750000.0
AAKASH,601956.0
AAP,321161.0
AB Innovative Software,426816.0
ABB,955297.0
ABC,854280.05
ABC Consultants,4282144.0
ABC Supply Co.,524121.0
ABC Tech,732816.0
ABC do ABC,513743.0
ABCDEF,1643757.75
ABSAS Solutions,267396.0
ACD Communications,866307.0
ACS Solutions,992754.0
ADHOC Services,563464.0
ADP,1011690.2
AFFINSYS AI,1450359.0
AGS Health,413352.0
AGS Transact Technologies,423084.0
AI Touch,181620.0
AIEnterprise,712525.0
AIG,922211.5
AIR Worldwide,398975.0
AIndra Labs,304188.0
AJIO,180000.0
ALBOT,600000.0
ALL IT Services,904392.0
ALTEN,1461604.0
AMCORE Financial,1800000.0
AMPROVIT TECHNOLOGIES,810204.0
ANB Systems,1500000.0
ANSHULTECH,103166.0
ANZ Bank,1111352.0
AON,2385732.0
AROHA TECHNOLOGIES,621588.0
ASD,2363988.0
ASSAD,517986.0
ATS Services (India),412440.0
AXA,1144288.0
AXA GO Business Operations,1344055.0
AXA XL,731213.0
AXIS MY INDIA,374059.0
Aashish sharma,1225579.0
Aays Analytics,894346.0
Abbott,1124740.0
Abhijeet Group,222840.0
Abhinav Immigration Services Pvt. Ltd.,1324539.0
Absolutdata,558121.0
Abzooba,1269893.8333333333
Acalvio,2442736.0
Accentue,1041548.5
Accenture,743136.4333333333
Accion Labs,406548.0
Acclivis Technologies,1003261.0
Accretive Wiz@work Consultants,1300000.0
Accurence,1227876.0
Acies,415492.0
Actiknow,363669.0
Activa (CA),1490685.0
Acuity Knowledge Partners,508899.0
Acuris Global,144720.0
AdWyze,380808.0
Adani Group,95700.0
Adappt Intelligence,360000.0
Add Innovations,310791.0
Adda 247,127836.0
Adecco,1349689.0
Adglobal360,835736.5
Aditi Software,469326.0
Aditya Birla Group,1086794.0
Admit.me,1973587.0
Adobe,1032769.25
Advanced Infrastructure Engineering,363228.0
Advisory Board,414388.0
Aegis,1993310.0
Aegon,2508152.0
Aera Technology,1118107.25
Aera Technology Associate,1007334.0
Aeries Technology,1410268.0
Affine,784572.0
AffinityAnswers,735014.0
AffinityX,193764.0
Affle,933286.0
AgEye Technologies,518492.0
Query:
SELECT
    "CompanyName",
    AVG(
        CASE
            WHEN "Salary" LIKE '%/yr' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE("Salary", '₹', ''),
                                ',', ''
                            ),
                            '/yr',
                            ''
                        ),
                        ' ',
                        ''
                    ) AS REAL
                )
            WHEN "Salary" LIKE '%/mo' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE("Salary", '₹', ''),
                                ',', ''
                            ),
                            '/mo',
                            ''
                        ),
                        ' ',
                        ''
                    ) AS REAL
                ) * 12
            WHEN "Salary" LIKE '%/hr' THEN
                CAST(
                    REPLACE(
                        REPLACE(
                            REPLACE(
                                REPLACE("Salary", '₹', ''),
                                ',', ''
                            ),
                            '/hr',
                            ''
                        ),
                        ' ',
                        ''
                    ) AS REAL
                ) * 8 * 250
            ELSE NULL
        END
    ) AS "AverageSalaryInState"
FROM "SalaryDataset"
WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
GROUP BY "CompanyName"
ORDER BY "AverageSalaryInState" DESC
LIMIT 5
Answer:
CompanyName,AverageSalaryInState
Meta,6034000.0
Atos,5273205.0
Volkswagen,5184922.0
Qwerty Concepts,5081882.0
RAKESH GROUP,5016304.0
End Exploring Related Columns
Task: For the salary dataset, create a detailed SQL report that compares the top 5 companies by average salary in Mumbai, Pune, New Delhi, and Hyderabad to the national average salary. The report should include the following columns: Location, Company Name, Average Salary in State, and Average Salary in Country.

Please answer only one complete SQL in sqlite dialect in ```sql``` format.
Usage example: ```sql
SELECT DISTINCT "column_name" FROM "table_name" WHERE ... ``` (Replace "table_name" with the actual table name. Enclose table and column names with double quotations if they contain special characters or match reserved keywords.)
Follow the answer format like: ```csv
Location,Company Name,Average Salary in State,Average Salary in Country
Mumbai,company1:str,avg_salary_state1:float,avg_salary_country1:float
Pune,company2:str,avg_salary_state2:float,avg_salary_country2:float
...
```

**Explanation:**

This report compares the top 5 companies by average salary in the cities of Mumbai, Pune, New Delhi, and Hyderabad to the national average salary. It includes the following columns:

- **Location**: The city where the company is located.
- **Company Name**: The name of the company.
- **Average Salary in State**: The average salary offered by the company in that city.
- **Average Salary in Country**: The national average salary for the company across all locations..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: 

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-27 10:03:19 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 10:03:19 - root - INFO - ```sql
SELECT
    "Location",
    "CompanyName",
    AVG(
        CASE
            WHEN "Salary" LIKE '%/yr' THEN
                CAST(
                    REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), '/yr', '') AS REAL
                )
            WHEN "Salary" LIKE '%/mo' THEN
                CAST(
                    REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), '/mo', '') AS REAL
                ) * 12
            WHEN "Salary" LIKE '%/hr' THEN
                CAST(
                    REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), '/hr', '') AS REAL
                ) * 8 * 250
            ELSE NULL
        END
    ) AS "Average Salary in State",
    (
        SELECT AVG(
            CASE
                WHEN sd2."Salary" LIKE '%/yr' THEN
                    CAST(
                        REPLACE(REPLACE(REPLACE(sd2."Salary", '₹', ''), ',', ''), '/yr', '') AS REAL
                    )
                WHEN sd2."Salary" LIKE '%/mo' THEN
                    CAST(
                        REPLACE(REPLACE(REPLACE(sd2."Salary", '₹', ''), ',', ''), '/mo', '') AS REAL
                    ) * 12
                WHEN sd2."Salary" LIKE '%/hr' THEN
                    CAST(
                        REPLACE(REPLACE(REPLACE(sd2."Salary", '₹', ''), ',', ''), '/hr', '') AS REAL
                    ) * 8 * 250
                ELSE NULL
            END
        )
        FROM "SalaryDataset" sd2
        WHERE sd2."CompanyName" = sd."CompanyName"
    ) AS "Average Salary in Country"
FROM "SalaryDataset" sd
WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
GROUP BY "Location", "CompanyName"
ORDER BY "Average Salary in State" DESC
LIMIT 5;
```
2025-01-27 10:03:19 - root - INFO - itercount: 1
2025-01-27 10:03:19 - root - INFO - 0
2025-01-27 10:03:19 - root - INFO - results: 
Location,CompanyName,Average Salary in State,Average Salary in Country
Mumbai,Rahul Industries,6044006.0,3203617.0
Hyderabad,Meta,6034000.0,5274337.0
Pune,Atos,5273205.0,5273205.0
Pune,Volkswagen,5184922.0,5184922.0
Hyderabad,Qwerty Concepts,5081882.0,5081882.0


2025-01-27 10:03:19 - root - INFO - Please check the answer again by reviewing For the salary dataset, create a detailed SQL report that compares the top 5 companies by average salary in Mumbai, Pune, New Delhi, and Hyderabad to the national average salary. The report should include the following columns: Location, Company Name, Average Salary in State, and Average Salary in Country., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Location,Company Name,Average Salary in State,Average Salary in Country
Mumbai,company1:str,avg_salary_state1:float,avg_salary_country1:float
Pune,company2:str,avg_salary_state2:float,avg_salary_country2:float
...
```

**Explanation:**

This report compares the top 5 companies by average salary in the cities of Mumbai, Pune, New Delhi, and Hyderabad to the national average salary. It includes the following columns:

- **Location**: The city where the company is located.
- **Company Name**: The name of the company.
- **Average Salary in State**: The average salary offered by the company in that city.
- **Average Salary in Country**: The national average salary for the company across all locations. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Location,CompanyName,Average Salary in State,Average Salary in Country
Mumbai,Rahul Industries,6044006.0,3203617.0
Hyderabad,Meta,6034000.0,5274337.0
Pune,Atos,5273205.0,5273205.0
Pune,Volkswagen,5184922.0,5184922.0
Hyderabad,Qwerty Concepts,5081882.0,5081882.0
Current sql:
SELECT
    "Location",
    "CompanyName",
    AVG(
        CASE
            WHEN "Salary" LIKE '%/yr' THEN
                CAST(
                    REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), '/yr', '') AS REAL
                )
            WHEN "Salary" LIKE '%/mo' THEN
                CAST(
                    REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), '/mo', '') AS REAL
                ) * 12
            WHEN "Salary" LIKE '%/hr' THEN
                CAST(
                    REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), '/hr', '') AS REAL
                ) * 8 * 250
            ELSE NULL
        END
    ) AS "Average Salary in State",
    (
        SELECT AVG(
            CASE
                WHEN sd2."Salary" LIKE '%/yr' THEN
                    CAST(
                        REPLACE(REPLACE(REPLACE(sd2."Salary", '₹', ''), ',', ''), '/yr', '') AS REAL
                    )
                WHEN sd2."Salary" LIKE '%/mo' THEN
                    CAST(
                        REPLACE(REPLACE(REPLACE(sd2."Salary", '₹', ''), ',', ''), '/mo', '') AS REAL
                    ) * 12
                WHEN sd2."Salary" LIKE '%/hr' THEN
                    CAST(
                        REPLACE(REPLACE(REPLACE(sd2."Salary", '₹', ''), ',', ''), '/hr', '') AS REAL
                    ) * 8 * 250
                ELSE NULL
            END
        )
        FROM "SalaryDataset" sd2
        WHERE sd2."CompanyName" = sd."CompanyName"
    ) AS "Average Salary in Country"
FROM "SalaryDataset" sd
WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
GROUP BY "Location", "CompanyName"
ORDER BY "Average Salary in State" DESC
LIMIT 5;
2025-01-27 10:04:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 10:04:05 - root - INFO - ```sql
SELECT
    "Location",
    "CompanyName",
    AVG(
        CASE
            WHEN "Salary" LIKE '%/yr' THEN
                CAST(
                    REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), '/yr', '') AS REAL
                )
            WHEN "Salary" LIKE '%/mo' THEN
                CAST(
                    REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), '/mo', '') AS REAL
                ) * 12
            WHEN "Salary" LIKE '%/hr' THEN
                CAST(
                    REPLACE(REPLACE(REPLACE("Salary", '₹', ''), ',', ''), '/hr', '') AS REAL
                ) * 8 * 250
            ELSE NULL
        END
    ) AS "Average Salary in State",
    (
        SELECT AVG(
            CASE
                WHEN sd2."Salary" LIKE '%/yr' THEN
                    CAST(
                        REPLACE(REPLACE(REPLACE(sd2."Salary", '₹', ''), ',', ''), '/yr', '') AS REAL
                    )
                WHEN sd2."Salary" LIKE '%/mo' THEN
                    CAST(
                        REPLACE(REPLACE(REPLACE(sd2."Salary", '₹', ''), ',', ''), '/mo', '') AS REAL
                    ) * 12
                WHEN sd2."Salary" LIKE '%/hr' THEN
                    CAST(
                        REPLACE(REPLACE(REPLACE(sd2."Salary", '₹', ''), ',', ''), '/hr', '') AS REAL
                    ) * 8 * 250
                ELSE NULL
            END
        )
        FROM "SalaryDataset" sd2
        WHERE sd2."CompanyName" = sd."CompanyName"
    ) AS "Average Salary in Country"
FROM "SalaryDataset" sd
WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
GROUP BY "Location", "CompanyName"
ORDER BY "Average Salary in State" DESC
LIMIT 5;
```
2025-01-27 10:04:05 - root - INFO - itercount: 2
2025-01-27 10:04:05 - root - INFO - 0
2025-01-27 10:04:05 - root - INFO - Total iteration counts: 2
