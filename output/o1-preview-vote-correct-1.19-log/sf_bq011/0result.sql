SELECT COUNT(DISTINCT u."USER_PSEUDO_ID") AS "number_of_users"
FROM (
  SELECT DISTINCT "USER_PSEUDO_ID" 
  FROM (
    SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210101"
    UNION ALL
    SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210102"
    UNION ALL
    SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210103"
    UNION ALL
    SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210104"
    UNION ALL
    SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210105"
  )
) AS u
WHERE u."USER_PSEUDO_ID" NOT IN (
  SELECT DISTINCT "USER_PSEUDO_ID"
  FROM (
    SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210106"
    UNION ALL
    SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210107"
  )
);