SELECT COUNT(*) AS "number_of_users"
FROM (
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM (
        SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210101"
        UNION ALL
        SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210102"
        UNION ALL
        SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210103"
        UNION ALL
        SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210104"
        UNION ALL
        SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210105"
    ) AS last5days_users
    WHERE "USER_PSEUDO_ID" IS NOT NULL
    EXCEPT
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM (
        SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210106"
        UNION ALL
        SELECT "USER_PSEUDO_ID" FROM "GA4"."GA4_OBFUSCATED_SAMPLE_ECOMMERCE"."EVENTS_20210107"
    ) AS last2days_users
    WHERE "USER_PSEUDO_ID" IS NOT NULL
) AS users_active_in_last7days_but_not_last2days;