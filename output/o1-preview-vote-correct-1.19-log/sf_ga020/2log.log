2025-01-20 16:06:50 - openai._base_client - INFO - Retrying request to /chat/completions in 0.494645 seconds
2025-01-20 16:08:04 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 16:08:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 16:08:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 16:08:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 16:08:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 33
2025-01-20 16:08:06 - snowflake.connector.connection - INFO - closed
2025-01-20 16:08:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 16:08:06 - root - INFO - SQL:
SELECT DISTINCT "event_name"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
   LIMIT 1000;
Results:
event_name
session_start
level_complete_quickplay
screen_view
post_score
level_start_quickplay
level_end_quickplay
level_fail_quickplay
user_engagement
os_update
app_update
level_complete
level_up
level_end
level_fail
app_exception
select_content
error
level_start
level_retry_quickplay
use_extra_steps
level_reset
level_reset_quickplay
no_more_extra_steps
level_retry
app_remove
firebase_campaign
in_app_purchase
spend_virtual_currency
completed_5_levels
dynamic_link_app_open
ad_reward
challenge_a_friend
first_open

2025-01-20 16:08:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 16:08:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 16:08:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 16:08:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 447
2025-01-20 16:08:08 - snowflake.connector.connection - INFO - closed
2025-01-20 16:08:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 16:08:08 - root - INFO - SQL:
SELECT DISTINCT "user_pseudo_id"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
   WHERE "event_date" = '20180801'
   LIMIT 1000;
Results:
Too long, hard cut:
user_pseudo_id
B458770ED6E295374FEEB3A68902CC28
841A68D5D1F94857BEB64225193B2432
27293EA0B2F41A672E15EF7B1FA21298
EE99F8CB32999A0FDAABBA18B05D4E48
2B5ABA17A30D32531C09DAF2865F9E55
159002C6F393752AD79B3C2E8C7104C7
A8D7DCCA39D8703F2928AD2D7BBB6BE9
F4634EFF4D9470DCA00051E3304B81AF
EBC3581ADA874D494FBE2C7CCF53BF99
D41AA91B61872612B5F5F4E42870042C
45BDDEC4DF8773F88DC51D1AFD145521
CEBD783B8F2E96E9F3B9424D4FB130E7
D9AA0EC27AF47514DDB5C664A6EF758A
55BFC405FFA33C0781DE73101011E45B
CFA0F8C5E25A71062E573EF8E6BC9F76
EFB696A82D093B3AFBE92FF526DD5CEA
04EF01C1F4723249F90F920DF018F16C
DA48D36D07835B1918BDF831AF83B5EF
5E624075FDFE3003C34E1138546B2450
210C3692734E251EEF4E952BC57DD998
B1D1ED35873581A23E48C4CD03DDFF81
C80CEE0983AB5B21D3F4B46089FDD9EB
AA35092B507100A45CBF225A23D56864
91814809BD9374D5CEDFC6A31727CC55
CC81C3C01DE545318860C5BFDC6AD31E
91F5161F80D1083CA7B37A08DEC9EC78
B54ED4ED7A122CAD69ED8771E62F4D72
46D808E730894AB0AC6E0F493B6FC864
1F0D27B8A7E058446D4A6409E2E73B19
934A101CA7B97944D05E0FC2ED3E203D
372D9BB5088C4E9000C65B06459B403A
6B7F85DBAABE78A99689D49CAE22072E
56FA726AC14329729C5A9B020B508034
7ED8C235689771F6B0F29BBF295A346F
1D435E381B7264B0A2DDDC9D911F9AE8
CD327D0141209436D7C03D644B969700
81E2E892D1C23CE76B072FA71310829F
6683CAFB77FB7B60C78CD233EB2B62F7
A7AAA5EF977926DBCF801D15F83EE4A5
96161BF2E55C7E32ED5F411432875ECB
FDA4BBBCF1EA2D95CDD77BFC5F00A837
F4EA0F2888792BD62555AD46ED534839
0F93A84CB0774C5BAB3E5FF8A72A694D
E66C3B8A38C424C7CBE0B5388EE5F77E
E643F6549E6C7EA0FD01EF4BF7A40F76
0EAC48BCE6DA434412A01656309CB1FF
32DC4BE3AF515BD8BD59B4DC0052A3AB
33E5EA9FE1E29AC3127D975A5494213D
7CA838857E3B7B8C9FC6A34E975FBF22
137944D29FEB9F2C96187C5F6604F5DB
EEBCB25D5F056CCF59DDE654388ACD2B
C74B58C4CD2770A1E97D6DC13D42CCAC
81F5705397CE9F0236B2B672AE113154
C464722AE0E9423DE721E72B8A524141
B99FD965B0874192EE94E8A8FE85EA9E
59772415A60A0B7E16588D219D7B85F1
A1FB1AAB886471FD9FFEADD8221847E8
914089851FFF3E8C0B3F64C73C8C6444
A064A84CD3CF7058F39333D6212E8615
9C2DD86B2DCB9FFB2356BC97F1ACE65F
17934EF7C1BC1CF2C7D942401FDE84CE
E19F04BAB15FBA761833F71BCF5D97D3
01562149DD13E75D732F0A9CA2D8CF5C
0E05F56141200FF41FCC0C7FA297FF08
3FC8ECFC8F2976C5B56D0D782F36BD7F
EF7772819E807EDBD8DB0F0B5210030E
AEB21692315E4F72D255C75E3584C12E
AFA6BA99FB329CB459E8E57FDE1DF9AE
FCB218A1B5C858D56B849CA70EDCF6B4
377303AA2F5C5C80E5AAAD26C029BD5A
EC1A759709685E136767F2C1BA4751ED
68C5F7CFAEAB93924B7B55D7129C0286
C60EACB47CF25AEEFD16C5E332078852
27B1CD26769B068D16FAAF82D4F2C1A8
38328F5729077611D47495753D2C04D1
70646770530D6BDEB05AFC16DD2559C2
CA51DAF1373B5C2A16C174AFBD2132A4
628E501EA1130A3A1C63DC1A3DF9D43A
13E6C8A193FF140F7D4222B569DD5B50
84E491A60BE52A4C6A438A89FADE283C
3E5101BCD089218A0E026C6750673B33
A72750663D0181C7817F61B3DD2CA656
FCA08F9B0DCB6E33A74F672CE7F73BE3
64EA802089E68A699EC86438C9504F94
8065F8E98407106A65D35195984B2258
C74E5AF2DAC240FA7F3B1612D5AEAA78
27C6D0E213A8121BF39FEA92C19D9144
B621164BDFE39D8021DDA4F652A284A5
2F4A6CF5C60E72BC578CA0E5189505F7
EF500E0CF578004836D1D38C8901862B
428B364B8F2B42ED8D7C5AD1020705EF
396CD60DADAB9CBA7DDCAF239B477135
EF028BE6C2230A5166A1A247D4687BA3
76690E22DDCE2B1FFA98C6A4376B8EA2
328DC7FE55E8881B2EA668C9A2855BB7
2B90CE94C6039DF03E72FE15B5320ABA
674EAE8D70D203FEDBE60DEAE2F834CC
01C784BDB7AF4DC8DAD6DCD21AF56E25
5A7EB17BF7D867AADECA2FDAF0941E88
0C777BD44F304574371C97674DCD0702
C2B541CA130165D03BA9BA7DC0E79273
E9DCE2D958652BD58E846DCE86BDD90A
E594F4CE9B23146A461021258CC7ACA2
12E5626928FE0885DEEF068683E8BD63
D47DCBB00B2B462C916A5A07DCFAB039
682A8CD0767A569DC68E7AA0201BFBA3
C4411A9EA6C9822AD521C60A4ED25F25
4593E981ECEF849FC7DA0F7FDA0F250E
E53BC2A0AD86417B443AF14EE3082C0F
53717D02C147929860D981CD68CE2D9A
8F6C5F7611B67A4A437FF283B6C10181
A1927ED722EA16A3B82E7EE0FA22FF4F
8941AB73D7CE7EF67AE0D6B866A8B5D0
6C654E9F5D2B57F4F2E2D9F240EC882C
9F61F3B36299C77519005F1B90A90108
03A75C48AFA4420AF4B3C23D7EDAC213
76B29DA61902BE1C9F957B66B017DA47
706C748E6D1E0768BFEFE6362B5D3F67
48C39ABD5CE13587DC55ADCAA366F951
ED244919E490C36963714E4C3E3025AB
85B9BAA3105AD395E7D84C61108F0D7E
6A2F4E7AB1816D2F6EC741BC92141766
1FDB055D4BD4AEC379A7B2F34E862913
D4A45A0CA838C439F64D565450B9A7D6
5FFBFE051291F79717B99F5D72B02CDC
7BCFAF1D468E309D866E9FEA7795FF85
AC14799A5E8C340D6CADCBAE72037D81
38AE6258A71E0D270D87AF7EFB0D419C
B215751EAC030DECC9124D90D2AC41A9
184B6DE721CD75D84BB9975E19003195
85C63B84706E6DD9752813675F9FB5F8
1A5905FC810CA20956805F3BACBEBCEF
C8859A791226C6027B90F72F880C3528
28C4A09298C441D5AFD39E749D9F3DA3
D11624EBD7C1693F9C3B4803A8D71DBA
A62D86FAFF43F1EC89D6F867915D7D56
D4B90F489AEED383CB46669EEEB12E92
42421044D6B3F0190A37145A20403036
8211CABE9A3F1FE1BF3154E0C8D30368
476409D7DFD0B2B2B0AB11E5F6D7DDBE
887A958AF69B7172916C3748444BFF0B
EBE661044C1949546986A852F35083A1
7D05DF6F0141D016FD20F7B8E71FAB0A
82486A3B62D50DB914F1C6857733DAB2
8601A3659DC5C1F0444E5CCDA5ED3E14
A944897CEB774B1BC2AFEA13A907B39E
1DC9B625F2C4F54E9281D4D19F9FEBBB
C7E2273D8B11257FCCC915D27C1FCA24
82D556A8003F97B39A2D2E8E5520F9B6
053914EB0DA99A613D6AF0E92FCA9940
39BE7CAB9B8602ABD10A1BFB4E66BBB2
EF

2025-01-20 16:08:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 16:08:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 16:08:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 16:08:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 16:08:10 - snowflake.connector.connection - INFO - closed
2025-01-20 16:08:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 16:08:10 - root - INFO - SQL:
SELECT "user_pseudo_id", "user_first_touch_timestamp"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
   LIMIT 1000;
Results:
Too long, hard cut:
user_pseudo_id,user_first_touch_timestamp
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
841A68D5D1F94857BEB64225193B2432,1510416265184000
841A68D5D1F94857BEB64225193B2432,1510416265184000
841A68D5D1F94857BEB64225193B2432,1510416265184000
841A68D5D1F94857BEB64225193B2432,1510416265184000
841A68D5D1F94857BEB64225193B2432,1510416265184000
841A68D5D1F94857BEB64225193B2432,1510416265184000
841A68D5D1F94857BEB64225193B2432,1510416265184000
841A68D5D1F94857BEB64225193B2432,1510416265184000
841A68D5D1F94857BEB64225193B2432,1510416265184000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB

2025-01-20 16:08:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 16:08:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 16:08:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 16:08:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 16:08:11 - snowflake.connector.connection - INFO - closed
2025-01-20 16:08:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 16:08:12 - root - INFO - SQL:
SELECT "event_name"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
   WHERE "event_name" ILIKE '%quickplay%'
   LIMIT 1000;
Results:
Too long, hard cut:
event_name
level_complete_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_complete_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_retry_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_retry_quickplay
level_start_quickplay
level_end_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_complete_quickplay
level_complete_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_start_quickplay
level_reset_quickplay
level_start_quickplay
level_start_quickplay
level_reset_quickplay
level_start_quickplay
level_reset_quickplay
level_start_quickplay
level_reset_quickplay
level_start_quickplay
level_reset_quickplay
level_start_quickplay
level_reset_quickplay
level_start_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_complete_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_complete_quickplay
level_complete_quickplay
level_complete_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_complete_quickplay
level_complete_quickplay
level_complete_quickplay
level_complete_quickplay
level_start_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_start_quickplay
level_complete_quickplay
level_complete_quickplay
level_complete_quickplay
level_complete_quickplay
level_complete_quickplay
level_reset_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_retry_quic

2025-01-20 16:08:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 16:08:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 16:08:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 16:08:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 16:08:13 - snowflake.connector.connection - INFO - closed
2025-01-20 16:08:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 16:08:14 - root - INFO - SQL:
SELECT f.value
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
   LATERAL FLATTEN(input => t."event_params") f
   LIMIT 1000;
Results:
Too long, hard cut:
VALUE
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 2637284676279794019
  }
}"
"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 2637284676279794019
  }
}"
"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 21
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 2637284676279794019
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 21
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 2637284676279794019
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 2637284676279794028
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 2637284676279794029
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""GADOInterstitialViewController""
  }
}"
"{
  ""key"": ""firebase_screen"",
  ""value"": {
    ""string_value"": ""FIRootViewController/Interstitial""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""GADOInterstitialViewController""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 2637284676279794029
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 2637284676279794019
  }
}"
"{
  ""key"": ""firebase_previous_screen"",
  ""value"": {
    ""string_value"": ""FIRootViewController/Interstitial""
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""GADOInterstitialViewController""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 2637284676279794019
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIMainMenuViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 2637284676279794020
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 2637284676279794020
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 2637284676279794021
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""FIMainMenuViewController""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 2637284676279794021
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 2637284676279794019
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 2637284676279794019
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIOutOfStepsViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 2637284676279794022
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_valu

2025-01-20 16:08:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 16:08:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 16:08:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 16:08:15 - snowflake.connector.connection - INFO - closed
2025-01-20 16:08:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 16:09:03 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 16:09:03 - root - INFO - The error you're encountering is due to the fact that the `LATERAL FLATTEN` function does not expose a column named `"key"` directly accessible as `f."key"`. Instead, when you flatten the `"event_params"` column, each `f.value` contains a JSON object that includes the `"key"` and `"value"` fields.

To extract the `"key"` from the JSON data in `f.value`, you need to use JSON parsing syntax. Here's the corrected query:

```sql
SELECT DISTINCT f.value:"key"::STRING AS "key_name"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 1000;
```

**Explanation:**

- **`f.value`**: This column contains the JSON object from the flattened `"event_params"` array.
- **`f.value:"key"`**: Uses JSON path notation to extract the `"key"` field from the JSON object.
- **`::STRING`**: Casts the extracted value to a string data type.
- **`AS "key_name"`**: Assigns an alias to the extracted `"key"` value for clarity.

**Example Result:**

```csv
key_name
"firebase_screen_class"
"firebase_event_origin"
"firebase_screen_id"
"value"
"board"
"firebase_previous_id"
"firebase_screen"
...
```

If you also want to extract the corresponding `"value"` for each key, you can modify the query as follows:

```sql
SELECT DISTINCT
    f.value:"key"::STRING AS "key_name",
    f.value:"value" AS "param_value"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 1000;
```

**Explanation:**

- **`f.value:"value"`**: Extracts the `"value"` field from the JSON object.
- **No casting is applied to `param_value`**: Depending on the data type, you may need to cast it to `STRING`, `NUMBER`, etc.

**Example Result:**

```csv
key_name,param_value
"firebase_screen_class","FIRootViewController"
"firebase_event_origin","auto"
"firebase_screen_id",2637284676279794019
"value",21
"board","S"
...
```

**Reason for the Error:**

- **Invalid Identifier `f."key"`**: The `LATERAL FLATTEN` function does not create a column named `"key"` directly accessible as `f."key"`. Instead, the data you're seeking is nested within the `f.value` JSON object.
- **Accessing JSON Fields**: To access fields within a JSON object stored in a `VARIANT` column, use the JSON parsing syntax: `column_name:"json_field"`.

**Additional Notes:**

- **Reserved Words**: The term `"key"` is a reserved word and might cause issues if not handled properly. By using the JSON parsing syntax and proper quoting, we avoid any conflicts.
- **Double Quotes**: Ensure that all identifiers (like column names and aliases) are enclosed in double quotes when they contain special characters or are case-sensitive.

---

By adjusting your query as shown above, you should be able to extract the distinct keys from the `"event_params"` column without encountering the compilation error.
2025-01-20 16:09:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 16:09:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 16:09:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 16:09:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 16:09:05 - snowflake.connector.connection - INFO - closed
2025-01-20 16:09:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 16:09:53 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 16:09:53 - root - INFO - SQL:
SELECT DISTINCT
    f.value:"key"::STRING AS "key_name",
    f.value:"value" AS "param_value"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 1000;
Results:
Too long, hard cut:
key_name,param_value
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": 2637284676279794019
}"
value,"{
  ""int_value"": 21
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
board,"{
  ""string_value"": ""S""
}"
firebase_screen_id,"{
  ""int_value"": 2637284676279794029
}"
firebase_screen,"{
  ""string_value"": ""FIRootViewController/Interstitial""
}"
firebase_screen_class,"{
  ""string_value"": ""GADOInterstitialViewController""
}"
firebase_previous_id,"{
  ""int_value"": 2637284676279794029
}"
firebase_previous_screen,"{
  ""string_value"": ""FIRootViewController/Interstitial""
}"
firebase_previous_id,"{
  ""int_value"": 2637284676279794019
}"
firebase_screen_class,"{
  ""string_value"": ""FIMainMenuViewController""
}"
firebase_screen_id,"{
  ""int_value"": 2637284676279794020
}"
firebase_previous_id,"{
  ""int_value"": 2637284676279794020
}"
firebase_screen_class,"{
  ""string_value"": ""main_menu""
}"
firebase_previous_class,"{
  ""string_value"": ""FIMainMenuViewController""
}"
firebase_previous_class,"{
  ""string_value"": ""main_menu""
}"
firebase_previous_id,"{
  ""int_value"": 2637284676279794022
}"
firebase_screen_class,"{
  ""string_value"": ""iap""
}"
firebase_screen_id,"{
  ""int_value"": 2637284676279794023
}"
firebase_screen_class,"{
  ""string_value"": ""out_of_steps""
}"
firebase_previous_class,"{
  ""string_value"": ""iap""
}"
firebase_previous_class,"{
  ""string_value"": ""out_of_steps""
}"
firebase_screen_class,"{
  ""string_value"": ""FIGameOverViewController""
}"
firebase_screen_id,"{
  ""int_value"": 2637284676279794027
}"
firebase_screen_id,"{
  ""int_value"": 2637284676279794030
}"
firebase_previous_id,"{
  ""int_value"": 2637284676279794031
}"
firebase_previous_id,"{
  ""int_value"": 2637284676279794032
}"
engagement_time_msec,"{
  ""int_value"": 4359
}"
firebase_previous_id,"{
  ""int_value"": -2614613710786332226
}"
firebase_previous_id,"{
  ""int_value"": -7592093320680571154
}"
firebase_previous_id,"{
  ""int_value"": -7592093320680571153
}"
firebase_screen_id,"{
  ""int_value"": -7592093320680571149
}"
previous_app_version,"{
  ""string_value"": ""2.6.30""
}"
level_name,"{
  ""string_value"": ""level_4""
}"
firebase_previous_id,"{
  ""int_value"": 5344990970727766679
}"
content_type,"{
  ""string_value"": ""level""
}"
firebase_previous_id,"{
  ""int_value"": 2637284676279794028
}"
firebase_screen_id,"{
  ""int_value"": 2637284676279794024
}"
firebase_previous_id,"{
  ""int_value"": 2637284676279794024
}"
firebase_previous_class,"{
  ""string_value"": ""extra_steps""
}"
firebase_screen_id,"{
  ""int_value"": 2637284676279794033
}"
level_name,"{
  ""string_value"": ""level_0""
}"
engagement_time_msec,"{
  ""int_value"": 72368
}"
previous_os_version,"{
  ""string_value"": ""11.4""
}"
engagement_time_msec,"{
  ""int_value"": 1819
}"
firebase_previous_id,"{
  ""int_value"": -7592093320680571150
}"
engagement_time_msec,"{
  ""int_value"": 54343
}"
value,"{
  ""double_value"": 1.100000000000000e+01
}"
value,"{
  ""double_value"": 2.100000000000000e+01
}"
firebase_previous_id,"{
  ""int_value"": 5344990970727766674
}"
firebase_previous_id,"{
  ""int_value"": 5344990970727766675
}"
firebase_screen_id,"{
  ""int_value"": 5344990970727766681
}"
firebase_previous_id,"{
  ""int_value"": 5344990970727766685
}"
firebase_screen_id,"{
  ""int_value"": 5344990970727766688
}"
firebase_screen_class,"{
  ""string_value"": ""level_select""
}"
firebase_screen_id,"{
  ""int_value"": 5344990970727766702
}"
value,"{
  ""int_value"": 33
}"
firebase_screen_class,"{
  ""string_value"": ""GADNFullScreenAdViewController""
}"
firebase_screen_id,"{
  ""double_value"": -7.592093320680571e+18
}"
firebase_screen_id,"{
  ""int_value"": 5344990970727766687
}"
firebase_previous_id,"{
  ""int_value"": 5344990970727766689
}"
engagement_time_msec,"{
  ""int_value"": 93951
}"
firebase_previous_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_screen_class,"{
  ""string_value"": ""FIOutOfStepsViewController""
}"
firebase_screen_id,"{
  ""int_value"": 2637284676279794022
}"
firebase_previous_class,"{
  ""string_value"": ""FIOutOfStepsViewController""
}"
firebase_screen_class,"{
  ""string_value"": ""extra_steps""
}"
firebase_previous_id,"{
  ""int_value"": 2637284676279794026
}"
firebase_previous_id,"{
  ""int_value"": 2637284676279794030
}"
firebase_screen_id,"{
  ""double_value"": 2.637284676279794e+18
}"
level,"{
  ""double_value"": 0.000000000000000e+00
}"
item_id,"{
  ""string_value"": ""Quickplay""
}"
engagement_time_msec,"{
  ""int_value"": 76608
}"
engagement_time_msec,"{
  ""int_value"": 63439
}"
firebase_screen_id,"{
  ""int_value"": -7592093320680571151
}"
engagement_time_msec,"{
  ""int_value"": 120171
}"
engagement_time_msec,"{
  ""int_value"": 26624
}"
firebase_previous_id,"{
  ""int_value"": 5344990970727766694
}"
firebase_previous_id,"{
  ""int_value"": 534499

2025-01-20 16:09:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 16:09:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 16:09:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 16:09:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 16:09:55 - snowflake.connector.connection - INFO - closed
2025-01-20 16:09:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 16:10:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 16:10:14 - root - INFO - ```sql
SELECT
    f.value:"value"::STRING AS "event_param_value",
    f.value:"key"::STRING AS "event_param_key"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
WHERE t."event_name" ILIKE '%quickplay%'
LIMIT 1000;
```
2025-01-20 16:10:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 16:10:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 16:10:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 16:10:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 16:10:16 - snowflake.connector.connection - INFO - closed
2025-01-20 16:10:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 16:11:20 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 16:11:20 - root - INFO - SQL:
SELECT
    f.value:"value"::STRING AS "event_param_value",
    f.value:"key"::STRING AS "event_param_key"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
WHERE t."event_name" ILIKE '%quickplay%'
LIMIT 1000;
Results:
Too long, hard cut:
event_param_value,event_param_key
"{""int_value"":21}",value
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":2637284676279794019}",firebase_screen_id
"{""string_value"":""S""}",board
"{""int_value"":21}",value
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":2637284676279794019}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""main_menu""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":2637284676279794021}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":2637284676279794019}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":2637284676279794019}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""game_over""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":2637284676279794027}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":2637284676279794019}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""game_over""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":2637284676279794031}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":2637284676279794019}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""main_menu""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":-2614613710786332224}",firebase_screen_id
"{""string_value"":""S""}",board
"{""int_value"":21}",value
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":-7592093320680571154}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""main_menu""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":-7592093320680571152}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":-7592093320680571154}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""game_over""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":-7592093320680571150}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""main_menu""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":5344990970727766676}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":5344990970727766674}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":5344990970727766674}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""game_over""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":5344990970727766682}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":5344990970727766674}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":5344990970727766674}",firebase_screen_id
"{""string_value"":""S""}",board
"{""int_value"":29}",value
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":-6841316843749891991}",firebase_screen_id
"{""string_value"":""M""}",board
"{""string_value"":""main_menu""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":-6841316843749891989}",firebase_screen_id
"{""string_value"":""M""}",board
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":-6841316843749891991}",firebase_screen_id
"{""string_value"":""M""}",board
"{""int_value"":22}",value
"{""string_value"":""FI

2025-01-20 16:11:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 16:11:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 16:11:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 16:11:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 16:11:21 - snowflake.connector.connection - INFO - closed
2025-01-20 16:11:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 16:11:22 - root - INFO - SQL:
SELECT "event_timestamp", "event_name"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000
Results:
Too long, hard cut:
event_timestamp,event_name
1533178516177000,session_start
1533186548206000,session_start
1533178706133033,level_complete_quickplay
1533186675592002,level_complete_quickplay
1533178649867023,screen_view
1533178654065028,screen_view
1533178577238001,screen_view
1533178589239002,screen_view
1533178544470012,screen_view
1533178619839003,screen_view
1533178634839004,screen_view
1533178592839005,screen_view
1533178622840006,screen_view
1533178572533010,screen_view
1533178645114013,screen_view
1533178637114014,screen_view
1533178632893019,screen_view
1533178659866022,screen_view
1533178680673037,screen_view
1533178700673038,screen_view
1533186529737004,screen_view
1533186639178006,screen_view
1533186655178007,screen_view
1533178694133031,post_score
1533186632592000,post_score
1533178513674000,screen_view
1533178505779007,level_start_quickplay
1533178604533011,level_end_quickplay
1533178616533012,level_fail_quickplay
1533178652337015,level_start_quickplay
1533178757133032,level_end_quickplay
1533186595977000,level_start_quickplay
1533186658592001,level_end_quickplay
1533178513778006,select_content
1533178510469009,user_engagement
1533178587838000,user_engagement
1533178625531007,user_engagement
1533178606892016,user_engagement
1533178728673034,user_engagement
1533178759086039,user_engagement
1533186577737001,user_engagement
1533186608176003,user_engagement
1533186609960008,user_engagement
1533178609064025,user_engagement
1533176867427006,os_update
1533176872452000,session_start
1533176888209004,screen_view
1533176912209005,screen_view
1533176930248002,screen_view
1533176913629003,screen_view
1533176878339008,level_start_quickplay
1533176917337007,select_content
1533176882247001,user_engagement
1533153346436000,session_start
1533153565261001,error
1533153427747002,level_complete_quickplay
1533153526463016,screen_view
1533153306935005,screen_view
1533153390935006,screen_view
1533153403144011,screen_view
1533153501316006,screen_view
1533153480317007,screen_view
1533153500660012,screen_view
1533153552462015,screen_view
1533153501747000,post_score
1533153386415003,screen_view
1533153377417008,level_start_quickplay
1533153501747001,level_end_quickplay
1533153554895008,level_start_quickplay
1533153354416007,select_content
1533153335144010,user_engagement
1533153440315003,user_engagement
1533153483659009,user_engagement
1533153572283002,user_engagement
1533146745626004,app_update
1533146807631000,session_start
1533146992865000,level_complete
1533146982986000,level_complete
1533147027807000,level_complete
1533147036897000,level_complete
1533146989865070,level_up
1533146947986003,level_up
1533146975807003,level_up
1533147097897008,level_up
1533146967161058,screen_view
1533147030181018,screen_view
1533146924401064,screen_view
1533147007327003,screen_view
1533146766012005,screen_view
1533146807013006,screen_view
1533146800896004,screen_view
1533146868046003,screen_view
1533146883046004,screen_view
1533146907046005,screen_view
1533146836046006,screen_view
1533146862339010,screen_view
1533146904894013,screen_view
1533146818895014,screen_view
1533146820473019,screen_view
1533146958762023,screen_view
1533146950762024,screen_view
1533146932763025,screen_view
1533146935763026,screen_view
1533146927994030,screen_view
1533146946539033,screen_view
1533146946540034,screen_view
1533146906458038,screen_view
1533146893020039,screen_view
1533146948020040,screen_view
1533146961209045,screen_view
1533146972210046,screen_view
1533146908920050,screen_view
1533146962485053,screen_view
1533146939160057,screen_view
1533146965390074,screen_view
1533146935391075,screen_view
1533146909204079,screen_view
1533146977731081,screen_view
1533146953539007,screen_view
1533146997539008,screen_view
1533147000264009,screen_view
1533146993794012,screen_view
1533147010349007,screen_view
1533146961349008,screen_view
1533146961100012,screen_view
1533146957627014,screen_view
1533147025179017,screen_view
1533147075452012,screen_view
1533147073453013,screen_view
1533147048781017,screen_view
1533147090305019,screen_view
1533147127724003,screen_view
1533147144724004,screen_view
1533147123724005,screen_view
1533147111724006,screen_view
1533147136233010,screen_view
1533146984865067,post_score
1533147014986000,post_score
1533147046807000,post_score
1533147057897005,post_score
1533146822471003,screen_view
1533146786346001,level_start_quickplay
1533146819339011,level_end_quickplay
1533146862339012,level_fail_quickplay
1533146893947015,level_start_quickplay
1533146965994031,level_end_quickplay
1533146889994032,level_fail_quickplay
1533146910920052,level_start
1533146983865068,level_end
1533146923204080,level_start
1533146990986001,level_end
1533146986265010,level_start
1533146963807001,level_end
1533146973100013,level_start
1533147046897006,level_end
1533147021782018,level_start
1533147060234011,level_end
1533147104234012,level_fail
1533146789345000,select_content
1533146901814041,select_content
1533146950917051,select_content
1533146829895003,user_engagement
1533146879045000

2025-01-20 16:11:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 16:11:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 16:11:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 16:11:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 849
2025-01-20 16:11:24 - snowflake.connector.connection - INFO - closed
2025-01-20 16:11:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 16:11:25 - root - INFO - SQL:
SELECT
    t."user_pseudo_id",
    f.value:"key"::STRING AS "property_key",
    f.value:"value" AS "property_value"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
     LATERAL FLATTEN(input => t."user_properties") f
LIMIT 1000
Results:
Too long, hard cut:
user_pseudo_id,property_key,property_value
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,"{
  ""set_timestamp_micros"": 1528374603614000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,"{
  ""set_timestamp_micros"": 1464610100753000,
  ""string_value"": ""true""
}"
B458770ED6E295374FEEB3A68902CC28,ad_frequency,"{
  ""set_timestamp_micros"": 1486124557706000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,"{
  ""set_timestamp_micros"": 1464609977006000,
  ""string_value"": ""20""
}"
B458770ED6E295374FEEB3A68902CC28,first_open_time,"{
  ""int_value"": 1464609963675000,
  ""set_timestamp_micros"": 1464609973675000
}"
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,"{
  ""set_timestamp_micros"": 1528374613614000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,"{
  ""set_timestamp_micros"": 1464610110753000,
  ""string_value"": ""true""
}"
B458770ED6E295374FEEB3A68902CC28,ad_frequency,"{
  ""set_timestamp_micros"": 1486124567706000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,"{
  ""set_timestamp_micros"": 1464609987006000,
  ""string_value"": ""20""
}"
B458770ED6E295374FEEB3A68902CC28,first_open_time,"{
  ""int_value"": 1464609963675000,
  ""set_timestamp_micros"": 1464609983675000
}"
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,"{
  ""set_timestamp_micros"": 1528374639614000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,"{
  ""set_timestamp_micros"": 1464610136753000,
  ""string_value"": ""true""
}"
B458770ED6E295374FEEB3A68902CC28,ad_frequency,"{
  ""set_timestamp_micros"": 1486124593706000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,"{
  ""set_timestamp_micros"": 1464610013006000,
  ""string_value"": ""20""
}"
B458770ED6E295374FEEB3A68902CC28,first_open_time,"{
  ""int_value"": 1464609963675000,
  ""set_timestamp_micros"": 1464610009675000
}"
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,"{
  ""set_timestamp_micros"": 1528374686614000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,"{
  ""set_timestamp_micros"": 1464610183753000,
  ""string_value"": ""true""
}"
B458770ED6E295374FEEB3A68902CC28,ad_frequency,"{
  ""set_timestamp_micros"": 1486124640706000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,"{
  ""set_timestamp_micros"": 1464610060006000,
  ""string_value"": ""20""
}"
B458770ED6E295374FEEB3A68902CC28,first_open_time,"{
  ""int_value"": 1464609963675000,
  ""set_timestamp_micros"": 1464610056675000
}"
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,"{
  ""set_timestamp_micros"": 1528374666614000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,"{
  ""set_timestamp_micros"": 1464610163753000,
  ""string_value"": ""true""
}"
B458770ED6E295374FEEB3A68902CC28,ad_frequency,"{
  ""set_timestamp_micros"": 1486124620706000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,"{
  ""set_timestamp_micros"": 1464610040006000,
  ""string_value"": ""20""
}"
B458770ED6E295374FEEB3A68902CC28,first_open_time,"{
  ""int_value"": 1464609963675000,
  ""set_timestamp_micros"": 1464610036675000
}"
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,"{
  ""set_timestamp_micros"": 1528374663614000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,"{
  ""set_timestamp_micros"": 1464610160753000,
  ""string_value"": ""true""
}"
B458770ED6E295374FEEB3A68902CC28,ad_frequency,"{
  ""set_timestamp_micros"": 1486124617706000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,"{
  ""set_timestamp_micros"": 1464610037006000,
  ""string_value"": ""20""
}"
B458770ED6E295374FEEB3A68902CC28,first_open_time,"{
  ""int_value"": 1464609963675000,
  ""set_timestamp_micros"": 1464610033675000
}"
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,"{
  ""set_timestamp_micros"": 1528374674614000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,"{
  ""set_timestamp_micros"": 1464610171753000,
  ""string_value"": ""true""
}"
B458770ED6E295374FEEB3A68902CC28,ad_frequency,"{
  ""set_timestamp_micros"": 1486124628706000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,"{
  ""set_timestamp_micros"": 1464610048006000,
  ""string_value"": ""20""
}"
B458770ED6E295374FEEB3A68902CC28,first_open_time,"{
  ""int_value"": 1464609963675000,
  ""set_timestamp_micros"": 1464610044675000
}"
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,"{
  ""set_timestamp_micros"": 1528374686614000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,"{
  ""set_timestamp_micros"": 1464610183753000,
  ""string_value"": ""true""
}"
B458770ED6E295374FEEB3A68902CC28,ad_frequency,"{
  ""set_timestamp_micros"": 1486124640706000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,initial_extra_s

2025-01-20 16:11:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 16:11:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 16:11:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 16:11:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-20 16:11:26 - snowflake.connector.connection - INFO - closed
2025-01-20 16:11:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 16:11:26 - root - INFO - SQL:
SELECT DISTINCT "platform"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000
Results:
platform
IOS
ANDROID

2025-01-20 16:11:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 16:11:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 16:11:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 16:11:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 16:11:28 - snowflake.connector.connection - INFO - closed
2025-01-20 16:11:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 16:11:28 - root - INFO - SQL:
SELECT "user_pseudo_id", "event_date"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
WHERE "event_name" ILIKE '%quickplay%'
LIMIT 1000
Results:
Too long, hard cut:
user_pseudo_id,event_date
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
841A68D5D1F94857BEB64225193B2432,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
2B5ABA17A30D32531C09DAF2865F9E55,20180801
2B5ABA17A30D32531C09DAF2865F9E55,20180801
2B5ABA17A30D32531C09DAF2865F9E55,20180801
159002C6F393752AD79B3C2E8C7104C7,20180801
159002C6F393752AD79B3C2E8C7104C7,20180801
159002C6F393752AD79B3C2E8C7104C7,20180801
A8D7DCCA39D8703F2928AD2D7BBB6BE9,20180801
A8D7DCCA39D8703F2928AD2D7BBB6BE9,20180801
A8D7DCCA39D8703F2928AD2D7BBB6BE9,20180801
F4634EFF4D9470DCA00051E3304B81AF,20180801
F4634EFF4D9470DCA00051E3304B81AF,20180801
F4634EFF4D9470DCA00051E3304B81AF,20180801
F4634EFF4D9470DCA00051E3304B81AF,20180801
F4634EFF4D9470DCA00051E3304B81AF,20180801
F4634EFF4D9470DCA00051E3304B81AF,20180801
EBC3581ADA874D494FBE2C7CCF53BF99,20180801
EBC3581ADA874D494FBE2C7CCF53BF99,20180801
EBC3581ADA874D494FBE2C7CCF53BF99,20180801
D41AA91B61872612B5F5F4E42870042C,20180801
D41AA91B61872612B5F5F4E42870042C,20180801
D41AA91B61872612B5F5F4E42870042C,20180801
D41AA91B61872612B5F5F4E42870042C,20180801
D41AA91B61872612B5F5F4E42870042C,20180801
D41AA91B61872612B5F5F4E42870042C,20180801
D41AA91B61872612B5F5F4E42870042C,20180801
D41AA91B61872612B5F5F4E42870042C,20180801
D41AA91B61872612B5F5F4E42870042C,20180801
D41AA91B61872612B5F5F4E42870042C,20180801
D41AA91B61872612B5F5F4E42870042C,20180801
45BDDEC4DF8773F88DC51D1AFD145521,20180801
45BDDEC4DF8773F88DC51D1AFD145521,20180801
45BDDEC4DF8773F88DC51D1AFD145521,20180801
CEBD783B8F2E96E9F3B9424D4FB130E7,20180801
CEBD783B8F2E96E9F3B9424D4FB130E7,20180801
CEBD783B8F2E96E9F3B9424D4FB130E7,20180801
D9AA0EC27AF47514DDB5C664A6EF758A,20180801
D9AA0EC27AF47514DDB5C664A6EF758A,20180801
D9AA0EC27AF47514DDB5C664A6EF758A,20180801
D9AA0EC27AF47514DDB5C664A6EF758A,20180801
D9AA0EC27AF47514DDB5C664A6EF758A,20180801
D9AA0EC27AF47514DDB5C664A6EF758A,20180801
D9AA0EC27AF47514DDB5C664A6EF758A,20180801
D9AA0EC27AF47514DDB5C664A6EF758A,20180801
D9AA0EC27AF47514DDB5C664A6EF758A,20180801
D9AA0EC27AF47514DDB5C664A6EF758A,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
55BFC405FFA33C0781DE73101011E45B,20180801
55BFC405FFA33C0781DE73101011E45B,20180801
55BFC405FFA33C0781DE73101011E45B,20180801
CFA0F8C5E25A71062E573EF8E6BC9F76,20180801
CFA0F8C5E25A71062E573EF8E6BC9F76,20180801
CFA0F8C5E25A71062E573EF8E6BC9F76,20180801
CFA0F8C5E25A71062E573EF8E6BC9F76,20180801
CFA0F8C5E25A71062E573EF8E6BC9F76,20180801
CFA0F8C5E25A71062E573EF8E6BC9F76,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
EFB696A82D093B3AFBE92FF526DD5CEA,20180801
EFB696A82D093B3AFBE92FF526DD5CEA,20180801
EFB696A82D093B3AFBE92FF526DD5CEA,20180801
EFB696A82D093B3AFBE92FF526DD5CEA,20180801
EFB696A82D093B3AFBE92FF526DD5CEA,20180801
EFB696A82D093B3AFBE92FF526DD5CEA,20180801
EFB696A82D093B3AFBE92FF526DD5CEA,20180801
EFB696A82D093B3AFBE92FF526DD5CEA,20180801
EFB696A82D093B3AFBE92FF526DD5CEA,20180801
EFB696A82D093B3AFB

2025-01-20 16:11:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 16:11:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 16:11:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 16:11:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 16:11:29 - snowflake.connector.connection - INFO - closed
2025-01-20 16:11:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 16:13:06 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 16:13:06 - root - INFO - ```sql
SELECT "user_pseudo_id", "event_date"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000;
```
2025-01-20 16:13:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 16:13:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 16:13:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 16:13:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 16:13:07 - snowflake.connector.connection - INFO - closed
2025-01-20 16:13:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 16:13:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 16:13:37 - root - INFO - SQL:
SELECT "user_pseudo_id", "event_date"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000;
Results:
Too long, hard cut:
user_pseudo_id,event_date
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
841A68D5D1F94857BEB64225193B2432,20180801
841A68D5D1F94857BEB64225193B2432,20180801
841A68D5D1F94857BEB64225193B2432,20180801
841A68D5D1F94857BEB64225193B2432,20180801
841A68D5D1F94857BEB64225193B2432,20180801
841A68D5D1F94857BEB64225193B2432,20180801
841A68D5D1F94857BEB64225193B2432,20180801
841A68D5D1F94857BEB64225193B2432,20180801
841A68D5D1F94857BEB64225193B2432,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDA

2025-01-20 16:13:37 - root - INFO - itercount: 0
2025-01-20 16:13:37 - root - INFO - Database Name: FIREBASE
Schema Name: ANALYTICS_153293282
DDL describes table information.
,0
table_name,EVENTS_20180613
description,
DDL,"create or replace TABLE EVENTS_20180613 (
	""event_date"" VARCHAR(16777216),
	""event_timestamp"" NUMBER(38,0),
	""event_name"" VARCHAR(16777216),
	""event_params"" VARIANT,
	""event_previous_timestamp"" NUMBER(38,0),
	""user_id"" VARCHAR(16777216),
	""user_pseudo_id"" VARCHAR(16777216),
	""user_properties"" VARIANT,
	""user_first_touch_timestamp"" NUMBER(38,0),
	""user_ltv"" VARIANT,
	""device"" VARIANT,
	""geo"" VARIANT,
	""app_info"" VARIANT,
	""traffic_source"" VARIANT,
	""stream_id"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']
External knowledge that might be helpful: 
How to Calculate User Retention in Big Query from Google Demo Game Analytics Data

As a Product / Website Analyst, I was pretty psyched to discover Googles public Google Analytics 4 (GA4) gaming event dataset called `firebase-public-project.analytics_153293282.events_*`. The table allows experienced developers and learners alike to experiment with raw GA4 data in Big Query for free. Event data is basically a log of user interactions with your product for analysis .For newbies interested in learning more about event data and GA4, visit my prior blog. This article provides SQL queries for a quick table overview and explains how to utilize Google Big Query to calculate user retention.


What is Retention?
User retention rates are key indicators for whether your product team meets user needs. Improving retention is often central to long term growth strategies.

**Retention measures how often and for how long users tend to return to your product.**

The metric can be a powerful proxy for product usefulness and user opinion. Its analysis can reveal critical information like how well your site converts new visitors to users and which items and features are associated with users coming back. If user data is available, retention can also help a business understand the profiles of its most active users (power users). Finally, retention is a great guardrail metric for A/B tests. Successful, product oriented companies prioritize a healthy user bases over short term profits.


**Common Retention Calculation Strategies**

Two common strategies to calculate retention are: 

a) N-Day retention

b) Unbounded Retention.


a) For N-Day retention, analysts calculate how many users with certain characteristics return over successive periods. It is called N days because we define the length of each period. For example, with N=7 day retention, if User A becomes part of our cohort of interest on day 0 and returns to the product day 5 and day 15, they are counted as retained for week 1 (17 days) and week 3 (1521 days) but not week 2 (814 days).


b) For Unbounded Retention, a user is counted as retained each week so long as their most recent product contact was after the week. For example, if User A becomes part of the cohort on day 0 and last returned to the site on day 21, they will be counted as retained in week 1 (17 days), week 2 (814 days), and week 3 (1521 days) but not week 4 (2228 days).

By calculating these metrics, companies can evaluate how well their products hold users interests. It also them closer to identifying the patterns that generate return users.



The table structure information is ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}
Begin Exploring Related Columns
Based on the task, the relevant tables, columns, and potential usages are as follows:

---

**Relevant Tables:**

- **FIREBASE.ANALYTICS_153293282.EVENTS_20180801** to **FIREBASE.ANALYTICS_153293282.EVENTS_20180815**
  - These tables contain event data for dates between August 1 and August 15, 2018, which is the initial engagement period of interest.

---

**Relevant Columns and Their Potential Usage:**

- **"event_date"**: Used to filter events by specific dates.
- **"event_timestamp"**: Provides the exact timestamp of each event; useful for calculating retention periods.
- **"event_name"**: Identifies the types of events; used to filter for quickplay events.
- **"event_params"**: Contains additional details about events in a nested JSON format; may include specific quickplay event types.
- **"user_pseudo_id"**: A unique identifier for users; used to track user activity over time.
- **"user_first_touch_timestamp"**: Indicates the timestamp when the user first engaged with the app; used to determine initial engagement.
- **"user_properties"**: May include additional user attributes that could be relevant for analysis.

---

**Conditions That May Be Used:**

- Filter users with **"user_first_touch_timestamp"** between August 1 and August 15, 2018.
- Identify events occurring during the **second week after initial engagement** (days 8 to 14).
- Filter events where **"event_name"** relates to 'quickplay'.
- Extract and analyze specific **event types** from the **"event_params"** column.
- Use **ILIKE '%quickplay%'** for case-insensitive matching of event names containing 'quickplay'.

---

**SQL Queries:**

1. **Retrieve distinct event names to identify possible quickplay events:**

   ```sql
   SELECT DISTINCT "event_name"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
   LIMIT 1000;
   ```

2. **List unique users who first engaged on August 1, 2018:**

   ```sql
   SELECT DISTINCT "user_pseudo_id"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
   WHERE "event_date" = '20180801'
   LIMIT 1000;
   ```

3. **Get user first touch timestamps to understand the format and range:**

   ```sql
   SELECT "user_pseudo_id", "user_first_touch_timestamp"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
   LIMIT 1000;
   ```

4. **Retrieve events with 'quickplay' in the event name to see how they are logged:**

   ```sql
   SELECT "event_name"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
   WHERE "event_name" ILIKE '%quickplay%'
   LIMIT 1000;
   ```

5. **Explore the contents of the "event_params" column:**

   ```sql
   SELECT f.value
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
   LATERAL FLATTEN(input => t."event_params") f
   LIMIT 1000;
   ```

6. **Retrieve distinct keys from "event_params" to identify available parameters:**

   ```sql
   SELECT DISTINCT f."key"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
   LATERAL FLATTEN(input => t."event_params") f
   LIMIT 1000;
   ```

7. **List distinct event types within 'quickplay' events from "event_params":**

   ```sql
   SELECT DISTINCT f.value::VARIANT:"event_type"::STRING AS "event_type"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
   LATERAL FLATTEN(input => t."event_params") f
   WHERE t."event_name" ILIKE '%quickplay%'
   LIMIT 1000;
   ```

8. **Obtain "event_timestamp" and "event_name" for events during August 1, 2018:**

   ```sql
   SELECT "event_timestamp", "event_name"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
   LIMIT 1000;
   ```

9. **Retrieve "user_properties" to understand user attributes:**

   ```sql
   SELECT "user_pseudo_id", "user_properties"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
   LIMIT 1000;
   ```

10. **Get the platforms used by users to see if it affects retention:**

    ```sql
    SELECT DISTINCT "platform"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
    LIMIT 1000;
    ```

11. **Identify users who performed 'quickplay' events and their event dates:**

    ```sql
    SELECT "user_pseudo_id", "event_date"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
    WHERE "event_name" ILIKE '%quickplay%'
    LIMIT 1000;
    ```

12. **Extract the 'level_name' from "event_params" for 'quickplay' events:**

    ```sql
    SELECT f.value::VARIANT:"level_name"::STRING AS "level_name"
    FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
    LATERAL FLATTEN(input => t."event_params") f
    WHERE t."event_name" ILIKE '%quickplay%'
    LIMIT 1000;
    ```

---

These queries are designed to enhance understanding of the data related to the task:

- **Queries 1 & 4**: Identify and explore event names containing 'quickplay'.
- **Queries 2 & 3**: Examine user engagement dates and initial touchpoints.
- **Queries 5, 6, 7 & 12**: Explore the structure and contents of the nested "event_params" column to extract specific event details like "event_type" and "level_name".
- **Query 8**: View event timestamps to help calculate retention periods.
- **Query 9**: Investigate user attributes that might influence retention.
- **Query 10**: Determine if platform type correlates with retention rates.
- **Query 11**: Connect users with their quickplay events and event dates.

**Note:** All queries adhere to the guidelines provided:

- They use the correct database, schema, and table names.
- All column names are enclosed in double quotations.
- Each query is simple, non-nested, and different from the others.
- `LIMIT 1000` is used to restrict the number of returned rows.
- `DISTINCT` and `ILIKE` are employed where appropriate.
- Complex functions, CTEs, or time conversions are avoided unless certain.

---

By running these queries, you can gather initial insights into the data structure and content, which will be essential for calculating user retention rates and identifying the quickplay event type with the lowest retention in the specified period.Query:
SELECT DISTINCT "event_name"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
   LIMIT 1000;
Answer:
event_name
session_start
level_complete_quickplay
screen_view
post_score
level_start_quickplay
level_end_quickplay
level_fail_quickplay
user_engagement
os_update
app_update
level_complete
level_up
level_end
level_fail
app_exception
select_content
error
level_start
level_retry_quickplay
use_extra_steps
level_reset
level_reset_quickplay
no_more_extra_steps
level_retry
app_remove
firebase_campaign
in_app_purchase
spend_virtual_currency
completed_5_levels
dynamic_link_app_open
ad_reward
challenge_a_friend
first_open
Query:
SELECT DISTINCT "user_pseudo_id"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
   WHERE "event_date" = '20180801'
   LIMIT 1000;
Answer:
Too long, hard cut:
user_pseudo_id
B458770ED6E295374FEEB3A68902CC28
841A68D5D1F94857BEB64225193B2432
27293EA0B2F41A672E15EF7B1FA21298
EE99F8CB32999A0FDAABBA18B05D4E48
2B5ABA17A30D32531C09DAF2865F9E55
159002C6F393752AD79B3C2E8C7104C7
A8D7DCCA39D8703F2928AD2D7BBB6BE9
F4634EFF4D9470DCA00051E3304B81AF
EBC3581ADA874D494FBE2C7CCF53BF99
D41AA91B61872612B5F5F4E42870042C
45BDDEC4DF8773F88DC51D1AFD145521
CEBD783B8F2E96E9F3B9424D4FB130E7
D9AA0EC27AF47514DDB5C664A6EF758A
55BFC405FFA33C0781DE73101011E45B
CFA0F8C5E25A71062E573EF8E6BC9F76
EFB696A82D093B3AFBE92FF526DD5CEA
04EF01C1F4723249F90F920DF018F16C
DA48D36D07835B1918BDF831AF83B5EF
5E624075FDFE3003C34E1138546B2450
210C3692734E251EEF4E952BC57DD998
B1D1ED35873581A23E48C4CD03DDFF81
C80CEE0983AB5B21D3F4B46089FDD9EB
AA35092B507100A45CBF225A23D56864
91814809BD9374D5CEDFC6A31727CC55
CC81C3C01DE545318860C5BFDC6AD31E
91F5161F80D1083CA7B37A08DEC9EC78
B54ED4ED7A122CAD69ED8771E62F4D72
46D808E730894AB0AC6E0F493B6FC864
1F0D27B8A7E058446D4A6409E2E73B19
934A101CA7B97944D05E0FC2ED3E203D
372D9BB5088C4E9000C65B06459B403A
6B7F85DBAABE78A99689D49CAE22072E
56FA726AC14329729C5A9B020B508034
7ED8C235689771F6B0F29BBF295A346F
1D435E381B7264B0A2DDDC9D911F9AE8
CD327D0141209436D7C03D644B969700
81E2E892D1C23CE76B072FA71310829F
6683CAFB77FB7B60C78CD233EB2B62F7
A7AAA5EF977926DBCF801D15F83EE4A5
96161BF2E55C7E32ED5F411432875ECB
FDA4BBBCF1EA2D95CDD77BFC5F00A837
F4EA0F2888792BD62555AD46ED534839
0F93A84CB0774C5BAB3E5FF8A72A694D
E66C3B8A38C424C7CBE0B5388EE5F77E
E643F6549E6C7EA0FD01EF4BF7A40F76
0EAC48BCE6DA434412A01656309CB1FF
32DC4BE3AF515BD8BD59B4DC0052A3AB
33E5EA9FE1E29AC3127D975A5494213D
7CA838857E3B7B8C9FC6A34E975FBF22
137944D29FEB9F2C96187C5F6604F5DB
EEBCB25D5F056CCF59DDE654388ACD2B
C74B58C4CD2770A1E97D6DC13D42CCAC
81F5705397CE9F0236B2B672AE113154
C464722AE0E9423DE721E72B8A524141
B99FD965B0874192EE94E8A8FE85EA9E
59772415A60A0B7E16588D219D7B85F1
A1FB1AAB886471FD9FFEADD8221847E8
914089851FFF3E8C0B3F64C73C8C6444
A064A84CD3CF7058F39333D6212E8615
9C2DD86B2DCB9FFB2356BC97F1ACE65F
17934EF7C1BC1CF2C7D942401FDE84CE
E19F04BAB15FBA761833F71BCF5D97D3
01562149DD13E75D732F0A9CA2D8CF5C
0E05F56141200FF41FCC0C7FA297FF08
3FC8ECFC8F2976C5B56D0D782F36BD7F
EF7772819E807EDBD8DB0F0B5210030E
AEB21692315E4F72D255C75E3584C12E
AFA6BA99FB329CB459E8E57FDE1DF9AE
FCB218A1B5C858D56B849CA70EDCF6B4
377303AA2F5C5C80E5AAAD26C029BD5A
EC1A759709685E136767F2C1BA4751ED
68C5F7CFAEAB93924B7B55D7129C0286
C60EACB47CF25AEEFD16C5E332078852
27B1CD26769B068D16FAAF82D4F2C1A8
38328F5729077611D47495753D2C04D1
70646770530D6BDEB05AFC16DD2559C2
CA51DAF1373B5C2A16C174AFBD2132A4
628E501EA1130A3A1C63DC1A3DF9D43A
13E6C8A193FF140F7D4222B569DD5B50
84E491A60BE52A4C6A438A89FADE283C
3E5101BCD089218A0E026C6750673B33
A72750663D0181C7817F61B3DD2CA656
FCA08F9B0DCB6E33A74F672CE7F73BE3
64EA802089E68A699EC86438C9504F94
8065F8E98407106A65D35195984B2258
C74E5AF2DAC240FA7F3B1612D5AEAA78
27C6D0E213A8121BF39FEA92C19D9144
B621164BDFE39D8021DDA4F652A284A5
2F4A6CF5C60E72BC578CA0E5189505F7
EF500E0CF578004836D1D38C8901862B
428B364B8F2B42ED8D7C5AD1020705EF
396CD60DADAB9CBA7DDCAF239B477135
EF028BE6C2230A5166A1A247D4687BA3
76690E22DDCE2B1FFA98C6A4376B8EA2
328DC7FE55E8881B2EA668C9A2855BB7
2B90CE94C6039DF03E72FE15B5320ABA
674EAE8D70D203FEDBE60DEAE2F834CC
01C784BDB7AF4DC8DAD6DCD21AF56E25
5A7EB17BF7D867AADECA2FDAF0941E88
0C777BD44F304574371C97674DCD0702
C2B541CA130165D03BA9BA7DC0E79273
E9DCE2D958652BD58E846DCE86BDD90A
E594F4CE9B23146A461021258CC7ACA2
12E5626928FE0885DEEF068683E8BD63
D47DCBB00B2B462C916A5A07DCFAB039
682A8CD0767A569DC68E7AA0201BFBA3
C4411A9EA6C9822AD521C60A4ED25F25
4593E981ECEF849FC7DA0F7FDA0F250E
E53BC2A0AD86417B443AF14EE3082C0F
53717D02C147929860D981CD68CE2D9A
8F6C5F7611B67A4A437FF283B6C10181
A1927ED722EA16A3B82E7EE0FA22FF4F
8941AB73D7CE7EF67AE0D6B866A8B5D0
6C654E9F5D2B57F4F2E2D9F240EC882C
9F61F3B36299C77519005F1B90A90108
03A75C48AFA4420AF4B3C23D7EDAC213
76B29DA61902BE1C9F957B66B017DA47
706C748E6D1E0768BFEFE6362B5D3F67
48C39ABD5CE13587DC55ADCAA366F951
ED244919E490C36963714E4C3E3025AB
85B9BAA3105AD395E7D84C61108F0D7E
6A2F4E7AB1816D2F6EC741BC92141766
1FDB055D4BD4AEC379A7B2F34E862913
D4A45A0CA838C439F64D565450B9A7D6
5FFBFE051291F79717B99F5D72B02CDC
7BCFAF1D468E309D866E9FEA7795FF85
AC14799A5E8C340D6CADCBAE72037D81
38AE6258A71E0D270D87AF7EFB0D419C
B215751EAC030DECC9124D90D2AC41A9
184B6DE721CD75D84BB9975E19003195
85C63B84706E6DD9752813675F9FB5F8
1A5905FC810CA20956805F3BACBEBCEF
C8859A791226C6027B90F72F880C3528
28C4A09298C441D5AFD39E749D9F3DA3
D11624EBD7C1693F9C3B4803A8D71DBA
A62D86FAFF43F1EC89D6F867915D7D56
D4B90F489AEED383CB46669EEEB12E92
42421044D6B3F0190A37145A20403036
8211CABE9A3F1FE1BF3154E0C8D30368
476409D7DFD0B2B2B0AB11E5F6D7DDBE
887A958AF69B7172916C3748444BFF0B
EBE661044C1949546986A852F35083A1
7D05DF6F0141D016FD20F7B8E71FAB0A
82486A3B62D50DB914F1C6857733DAB2
8601A3659DC5C1F0444E5CCDA5ED3E14
A944897CEB774B1BC2AFEA13A907B39E
1DC9B625F2C4F54E9281D4D19F9FEBBB
C7E2273D8B11257FCCC915D27C1FCA24
82D556A8003F97B39A2D2E8E5520F9B6
053914EB0DA99A613D6AF0E92FCA9940
39BE7CAB9B8602ABD10A1BFB4E66BBB2
EF
Query:
SELECT "user_pseudo_id", "user_first_touch_timestamp"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
   LIMIT 1000;
Answer:
Too long, hard cut:
user_pseudo_id,user_first_touch_timestamp
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
B458770ED6E295374FEEB3A68902CC28,1464609963675000
841A68D5D1F94857BEB64225193B2432,1510416265184000
841A68D5D1F94857BEB64225193B2432,1510416265184000
841A68D5D1F94857BEB64225193B2432,1510416265184000
841A68D5D1F94857BEB64225193B2432,1510416265184000
841A68D5D1F94857BEB64225193B2432,1510416265184000
841A68D5D1F94857BEB64225193B2432,1510416265184000
841A68D5D1F94857BEB64225193B2432,1510416265184000
841A68D5D1F94857BEB64225193B2432,1510416265184000
841A68D5D1F94857BEB64225193B2432,1510416265184000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
27293EA0B2F41A672E15EF7B1FA21298,1520149684096000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB32999A0FDAABBA18B05D4E48,1476052728192000
EE99F8CB
Query:
SELECT "event_name"
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
   WHERE "event_name" ILIKE '%quickplay%'
   LIMIT 1000;
Answer:
Too long, hard cut:
event_name
level_complete_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_complete_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_retry_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_retry_quickplay
level_start_quickplay
level_end_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_complete_quickplay
level_complete_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_start_quickplay
level_reset_quickplay
level_start_quickplay
level_start_quickplay
level_reset_quickplay
level_start_quickplay
level_reset_quickplay
level_start_quickplay
level_reset_quickplay
level_start_quickplay
level_reset_quickplay
level_start_quickplay
level_reset_quickplay
level_start_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_complete_quickplay
level_complete_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_complete_quickplay
level_complete_quickplay
level_complete_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_complete_quickplay
level_complete_quickplay
level_complete_quickplay
level_complete_quickplay
level_start_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_start_quickplay
level_complete_quickplay
level_complete_quickplay
level_complete_quickplay
level_complete_quickplay
level_complete_quickplay
level_reset_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_start_quickplay
level_end_quickplay
level_fail_quickplay
level_retry_quic
Query:
SELECT f.value
   FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
   LATERAL FLATTEN(input => t."event_params") f
   LIMIT 1000;
Answer:
Too long, hard cut:
VALUE
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 2637284676279794019
  }
}"
"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 2637284676279794019
  }
}"
"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 21
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 2637284676279794019
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 21
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 2637284676279794019
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 2637284676279794028
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 2637284676279794029
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""GADOInterstitialViewController""
  }
}"
"{
  ""key"": ""firebase_screen"",
  ""value"": {
    ""string_value"": ""FIRootViewController/Interstitial""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""GADOInterstitialViewController""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 2637284676279794029
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 2637284676279794019
  }
}"
"{
  ""key"": ""firebase_previous_screen"",
  ""value"": {
    ""string_value"": ""FIRootViewController/Interstitial""
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""GADOInterstitialViewController""
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 2637284676279794019
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIMainMenuViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 2637284676279794020
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 2637284676279794020
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 2637284676279794021
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""FIMainMenuViewController""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 2637284676279794021
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIRootViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 2637284676279794019
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": 2637284676279794019
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FIOutOfStepsViewController""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 2637284676279794022
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_valu
Query:
SELECT DISTINCT
    f.value:"key"::STRING AS "key_name",
    f.value:"value" AS "param_value"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 1000;
Answer:
Too long, hard cut:
key_name,param_value
firebase_screen_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_event_origin,"{
  ""string_value"": ""auto""
}"
firebase_screen_id,"{
  ""int_value"": 2637284676279794019
}"
value,"{
  ""int_value"": 21
}"
firebase_event_origin,"{
  ""string_value"": ""app+gtm""
}"
board,"{
  ""string_value"": ""S""
}"
firebase_screen_id,"{
  ""int_value"": 2637284676279794029
}"
firebase_screen,"{
  ""string_value"": ""FIRootViewController/Interstitial""
}"
firebase_screen_class,"{
  ""string_value"": ""GADOInterstitialViewController""
}"
firebase_previous_id,"{
  ""int_value"": 2637284676279794029
}"
firebase_previous_screen,"{
  ""string_value"": ""FIRootViewController/Interstitial""
}"
firebase_previous_id,"{
  ""int_value"": 2637284676279794019
}"
firebase_screen_class,"{
  ""string_value"": ""FIMainMenuViewController""
}"
firebase_screen_id,"{
  ""int_value"": 2637284676279794020
}"
firebase_previous_id,"{
  ""int_value"": 2637284676279794020
}"
firebase_screen_class,"{
  ""string_value"": ""main_menu""
}"
firebase_previous_class,"{
  ""string_value"": ""FIMainMenuViewController""
}"
firebase_previous_class,"{
  ""string_value"": ""main_menu""
}"
firebase_previous_id,"{
  ""int_value"": 2637284676279794022
}"
firebase_screen_class,"{
  ""string_value"": ""iap""
}"
firebase_screen_id,"{
  ""int_value"": 2637284676279794023
}"
firebase_screen_class,"{
  ""string_value"": ""out_of_steps""
}"
firebase_previous_class,"{
  ""string_value"": ""iap""
}"
firebase_previous_class,"{
  ""string_value"": ""out_of_steps""
}"
firebase_screen_class,"{
  ""string_value"": ""FIGameOverViewController""
}"
firebase_screen_id,"{
  ""int_value"": 2637284676279794027
}"
firebase_screen_id,"{
  ""int_value"": 2637284676279794030
}"
firebase_previous_id,"{
  ""int_value"": 2637284676279794031
}"
firebase_previous_id,"{
  ""int_value"": 2637284676279794032
}"
engagement_time_msec,"{
  ""int_value"": 4359
}"
firebase_previous_id,"{
  ""int_value"": -2614613710786332226
}"
firebase_previous_id,"{
  ""int_value"": -7592093320680571154
}"
firebase_previous_id,"{
  ""int_value"": -7592093320680571153
}"
firebase_screen_id,"{
  ""int_value"": -7592093320680571149
}"
previous_app_version,"{
  ""string_value"": ""2.6.30""
}"
level_name,"{
  ""string_value"": ""level_4""
}"
firebase_previous_id,"{
  ""int_value"": 5344990970727766679
}"
content_type,"{
  ""string_value"": ""level""
}"
firebase_previous_id,"{
  ""int_value"": 2637284676279794028
}"
firebase_screen_id,"{
  ""int_value"": 2637284676279794024
}"
firebase_previous_id,"{
  ""int_value"": 2637284676279794024
}"
firebase_previous_class,"{
  ""string_value"": ""extra_steps""
}"
firebase_screen_id,"{
  ""int_value"": 2637284676279794033
}"
level_name,"{
  ""string_value"": ""level_0""
}"
engagement_time_msec,"{
  ""int_value"": 72368
}"
previous_os_version,"{
  ""string_value"": ""11.4""
}"
engagement_time_msec,"{
  ""int_value"": 1819
}"
firebase_previous_id,"{
  ""int_value"": -7592093320680571150
}"
engagement_time_msec,"{
  ""int_value"": 54343
}"
value,"{
  ""double_value"": 1.100000000000000e+01
}"
value,"{
  ""double_value"": 2.100000000000000e+01
}"
firebase_previous_id,"{
  ""int_value"": 5344990970727766674
}"
firebase_previous_id,"{
  ""int_value"": 5344990970727766675
}"
firebase_screen_id,"{
  ""int_value"": 5344990970727766681
}"
firebase_previous_id,"{
  ""int_value"": 5344990970727766685
}"
firebase_screen_id,"{
  ""int_value"": 5344990970727766688
}"
firebase_screen_class,"{
  ""string_value"": ""level_select""
}"
firebase_screen_id,"{
  ""int_value"": 5344990970727766702
}"
value,"{
  ""int_value"": 33
}"
firebase_screen_class,"{
  ""string_value"": ""GADNFullScreenAdViewController""
}"
firebase_screen_id,"{
  ""double_value"": -7.592093320680571e+18
}"
firebase_screen_id,"{
  ""int_value"": 5344990970727766687
}"
firebase_previous_id,"{
  ""int_value"": 5344990970727766689
}"
engagement_time_msec,"{
  ""int_value"": 93951
}"
firebase_previous_class,"{
  ""string_value"": ""FIRootViewController""
}"
firebase_screen_class,"{
  ""string_value"": ""FIOutOfStepsViewController""
}"
firebase_screen_id,"{
  ""int_value"": 2637284676279794022
}"
firebase_previous_class,"{
  ""string_value"": ""FIOutOfStepsViewController""
}"
firebase_screen_class,"{
  ""string_value"": ""extra_steps""
}"
firebase_previous_id,"{
  ""int_value"": 2637284676279794026
}"
firebase_previous_id,"{
  ""int_value"": 2637284676279794030
}"
firebase_screen_id,"{
  ""double_value"": 2.637284676279794e+18
}"
level,"{
  ""double_value"": 0.000000000000000e+00
}"
item_id,"{
  ""string_value"": ""Quickplay""
}"
engagement_time_msec,"{
  ""int_value"": 76608
}"
engagement_time_msec,"{
  ""int_value"": 63439
}"
firebase_screen_id,"{
  ""int_value"": -7592093320680571151
}"
engagement_time_msec,"{
  ""int_value"": 120171
}"
engagement_time_msec,"{
  ""int_value"": 26624
}"
firebase_previous_id,"{
  ""int_value"": 5344990970727766694
}"
firebase_previous_id,"{
  ""int_value"": 534499
Query:
SELECT
    f.value:"value"::STRING AS "event_param_value",
    f.value:"key"::STRING AS "event_param_key"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
LATERAL FLATTEN(input => t."event_params") f
WHERE t."event_name" ILIKE '%quickplay%'
LIMIT 1000;
Answer:
Too long, hard cut:
event_param_value,event_param_key
"{""int_value"":21}",value
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":2637284676279794019}",firebase_screen_id
"{""string_value"":""S""}",board
"{""int_value"":21}",value
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":2637284676279794019}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""main_menu""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":2637284676279794021}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":2637284676279794019}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":2637284676279794019}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""game_over""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":2637284676279794027}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":2637284676279794019}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""game_over""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":2637284676279794031}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":2637284676279794019}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""main_menu""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":-2614613710786332224}",firebase_screen_id
"{""string_value"":""S""}",board
"{""int_value"":21}",value
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":-7592093320680571154}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""main_menu""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":-7592093320680571152}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":-7592093320680571154}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""game_over""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":-7592093320680571150}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""main_menu""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":5344990970727766676}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":5344990970727766674}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":5344990970727766674}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""game_over""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":5344990970727766682}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":5344990970727766674}",firebase_screen_id
"{""string_value"":""S""}",board
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":5344990970727766674}",firebase_screen_id
"{""string_value"":""S""}",board
"{""int_value"":29}",value
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":-6841316843749891991}",firebase_screen_id
"{""string_value"":""M""}",board
"{""string_value"":""main_menu""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":-6841316843749891989}",firebase_screen_id
"{""string_value"":""M""}",board
"{""string_value"":""FIRootViewController""}",firebase_screen_class
"{""string_value"":""app+gtm""}",firebase_event_origin
"{""int_value"":-6841316843749891991}",firebase_screen_id
"{""string_value"":""M""}",board
"{""int_value"":22}",value
"{""string_value"":""FI
Query:
SELECT "event_timestamp", "event_name"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000
Answer:
Too long, hard cut:
event_timestamp,event_name
1533178516177000,session_start
1533186548206000,session_start
1533178706133033,level_complete_quickplay
1533186675592002,level_complete_quickplay
1533178649867023,screen_view
1533178654065028,screen_view
1533178577238001,screen_view
1533178589239002,screen_view
1533178544470012,screen_view
1533178619839003,screen_view
1533178634839004,screen_view
1533178592839005,screen_view
1533178622840006,screen_view
1533178572533010,screen_view
1533178645114013,screen_view
1533178637114014,screen_view
1533178632893019,screen_view
1533178659866022,screen_view
1533178680673037,screen_view
1533178700673038,screen_view
1533186529737004,screen_view
1533186639178006,screen_view
1533186655178007,screen_view
1533178694133031,post_score
1533186632592000,post_score
1533178513674000,screen_view
1533178505779007,level_start_quickplay
1533178604533011,level_end_quickplay
1533178616533012,level_fail_quickplay
1533178652337015,level_start_quickplay
1533178757133032,level_end_quickplay
1533186595977000,level_start_quickplay
1533186658592001,level_end_quickplay
1533178513778006,select_content
1533178510469009,user_engagement
1533178587838000,user_engagement
1533178625531007,user_engagement
1533178606892016,user_engagement
1533178728673034,user_engagement
1533178759086039,user_engagement
1533186577737001,user_engagement
1533186608176003,user_engagement
1533186609960008,user_engagement
1533178609064025,user_engagement
1533176867427006,os_update
1533176872452000,session_start
1533176888209004,screen_view
1533176912209005,screen_view
1533176930248002,screen_view
1533176913629003,screen_view
1533176878339008,level_start_quickplay
1533176917337007,select_content
1533176882247001,user_engagement
1533153346436000,session_start
1533153565261001,error
1533153427747002,level_complete_quickplay
1533153526463016,screen_view
1533153306935005,screen_view
1533153390935006,screen_view
1533153403144011,screen_view
1533153501316006,screen_view
1533153480317007,screen_view
1533153500660012,screen_view
1533153552462015,screen_view
1533153501747000,post_score
1533153386415003,screen_view
1533153377417008,level_start_quickplay
1533153501747001,level_end_quickplay
1533153554895008,level_start_quickplay
1533153354416007,select_content
1533153335144010,user_engagement
1533153440315003,user_engagement
1533153483659009,user_engagement
1533153572283002,user_engagement
1533146745626004,app_update
1533146807631000,session_start
1533146992865000,level_complete
1533146982986000,level_complete
1533147027807000,level_complete
1533147036897000,level_complete
1533146989865070,level_up
1533146947986003,level_up
1533146975807003,level_up
1533147097897008,level_up
1533146967161058,screen_view
1533147030181018,screen_view
1533146924401064,screen_view
1533147007327003,screen_view
1533146766012005,screen_view
1533146807013006,screen_view
1533146800896004,screen_view
1533146868046003,screen_view
1533146883046004,screen_view
1533146907046005,screen_view
1533146836046006,screen_view
1533146862339010,screen_view
1533146904894013,screen_view
1533146818895014,screen_view
1533146820473019,screen_view
1533146958762023,screen_view
1533146950762024,screen_view
1533146932763025,screen_view
1533146935763026,screen_view
1533146927994030,screen_view
1533146946539033,screen_view
1533146946540034,screen_view
1533146906458038,screen_view
1533146893020039,screen_view
1533146948020040,screen_view
1533146961209045,screen_view
1533146972210046,screen_view
1533146908920050,screen_view
1533146962485053,screen_view
1533146939160057,screen_view
1533146965390074,screen_view
1533146935391075,screen_view
1533146909204079,screen_view
1533146977731081,screen_view
1533146953539007,screen_view
1533146997539008,screen_view
1533147000264009,screen_view
1533146993794012,screen_view
1533147010349007,screen_view
1533146961349008,screen_view
1533146961100012,screen_view
1533146957627014,screen_view
1533147025179017,screen_view
1533147075452012,screen_view
1533147073453013,screen_view
1533147048781017,screen_view
1533147090305019,screen_view
1533147127724003,screen_view
1533147144724004,screen_view
1533147123724005,screen_view
1533147111724006,screen_view
1533147136233010,screen_view
1533146984865067,post_score
1533147014986000,post_score
1533147046807000,post_score
1533147057897005,post_score
1533146822471003,screen_view
1533146786346001,level_start_quickplay
1533146819339011,level_end_quickplay
1533146862339012,level_fail_quickplay
1533146893947015,level_start_quickplay
1533146965994031,level_end_quickplay
1533146889994032,level_fail_quickplay
1533146910920052,level_start
1533146983865068,level_end
1533146923204080,level_start
1533146990986001,level_end
1533146986265010,level_start
1533146963807001,level_end
1533146973100013,level_start
1533147046897006,level_end
1533147021782018,level_start
1533147060234011,level_end
1533147104234012,level_fail
1533146789345000,select_content
1533146901814041,select_content
1533146950917051,select_content
1533146829895003,user_engagement
1533146879045000
Query:
SELECT
    t."user_pseudo_id",
    f.value:"key"::STRING AS "property_key",
    f.value:"value" AS "property_value"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801" t,
     LATERAL FLATTEN(input => t."user_properties") f
LIMIT 1000
Answer:
Too long, hard cut:
user_pseudo_id,property_key,property_value
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,"{
  ""set_timestamp_micros"": 1528374603614000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,"{
  ""set_timestamp_micros"": 1464610100753000,
  ""string_value"": ""true""
}"
B458770ED6E295374FEEB3A68902CC28,ad_frequency,"{
  ""set_timestamp_micros"": 1486124557706000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,"{
  ""set_timestamp_micros"": 1464609977006000,
  ""string_value"": ""20""
}"
B458770ED6E295374FEEB3A68902CC28,first_open_time,"{
  ""int_value"": 1464609963675000,
  ""set_timestamp_micros"": 1464609973675000
}"
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,"{
  ""set_timestamp_micros"": 1528374613614000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,"{
  ""set_timestamp_micros"": 1464610110753000,
  ""string_value"": ""true""
}"
B458770ED6E295374FEEB3A68902CC28,ad_frequency,"{
  ""set_timestamp_micros"": 1486124567706000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,"{
  ""set_timestamp_micros"": 1464609987006000,
  ""string_value"": ""20""
}"
B458770ED6E295374FEEB3A68902CC28,first_open_time,"{
  ""int_value"": 1464609963675000,
  ""set_timestamp_micros"": 1464609983675000
}"
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,"{
  ""set_timestamp_micros"": 1528374639614000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,"{
  ""set_timestamp_micros"": 1464610136753000,
  ""string_value"": ""true""
}"
B458770ED6E295374FEEB3A68902CC28,ad_frequency,"{
  ""set_timestamp_micros"": 1486124593706000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,"{
  ""set_timestamp_micros"": 1464610013006000,
  ""string_value"": ""20""
}"
B458770ED6E295374FEEB3A68902CC28,first_open_time,"{
  ""int_value"": 1464609963675000,
  ""set_timestamp_micros"": 1464610009675000
}"
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,"{
  ""set_timestamp_micros"": 1528374686614000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,"{
  ""set_timestamp_micros"": 1464610183753000,
  ""string_value"": ""true""
}"
B458770ED6E295374FEEB3A68902CC28,ad_frequency,"{
  ""set_timestamp_micros"": 1486124640706000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,"{
  ""set_timestamp_micros"": 1464610060006000,
  ""string_value"": ""20""
}"
B458770ED6E295374FEEB3A68902CC28,first_open_time,"{
  ""int_value"": 1464609963675000,
  ""set_timestamp_micros"": 1464610056675000
}"
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,"{
  ""set_timestamp_micros"": 1528374666614000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,"{
  ""set_timestamp_micros"": 1464610163753000,
  ""string_value"": ""true""
}"
B458770ED6E295374FEEB3A68902CC28,ad_frequency,"{
  ""set_timestamp_micros"": 1486124620706000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,"{
  ""set_timestamp_micros"": 1464610040006000,
  ""string_value"": ""20""
}"
B458770ED6E295374FEEB3A68902CC28,first_open_time,"{
  ""int_value"": 1464609963675000,
  ""set_timestamp_micros"": 1464610036675000
}"
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,"{
  ""set_timestamp_micros"": 1528374663614000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,"{
  ""set_timestamp_micros"": 1464610160753000,
  ""string_value"": ""true""
}"
B458770ED6E295374FEEB3A68902CC28,ad_frequency,"{
  ""set_timestamp_micros"": 1486124617706000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,"{
  ""set_timestamp_micros"": 1464610037006000,
  ""string_value"": ""20""
}"
B458770ED6E295374FEEB3A68902CC28,first_open_time,"{
  ""int_value"": 1464609963675000,
  ""set_timestamp_micros"": 1464610033675000
}"
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,"{
  ""set_timestamp_micros"": 1528374674614000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,"{
  ""set_timestamp_micros"": 1464610171753000,
  ""string_value"": ""true""
}"
B458770ED6E295374FEEB3A68902CC28,ad_frequency,"{
  ""set_timestamp_micros"": 1486124628706000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,initial_extra_steps,"{
  ""set_timestamp_micros"": 1464610048006000,
  ""string_value"": ""20""
}"
B458770ED6E295374FEEB3A68902CC28,first_open_time,"{
  ""int_value"": 1464609963675000,
  ""set_timestamp_micros"": 1464610044675000
}"
B458770ED6E295374FEEB3A68902CC28,firebase_exp_3,"{
  ""set_timestamp_micros"": 1528374686614000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,plays_quickplay,"{
  ""set_timestamp_micros"": 1464610183753000,
  ""string_value"": ""true""
}"
B458770ED6E295374FEEB3A68902CC28,ad_frequency,"{
  ""set_timestamp_micros"": 1486124640706000,
  ""string_value"": ""2""
}"
B458770ED6E295374FEEB3A68902CC28,initial_extra_s
Query:
SELECT DISTINCT "platform"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000
Answer:
platform
IOS
ANDROID
Query:
SELECT "user_pseudo_id", "event_date"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
WHERE "event_name" ILIKE '%quickplay%'
LIMIT 1000
Answer:
Too long, hard cut:
user_pseudo_id,event_date
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
841A68D5D1F94857BEB64225193B2432,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
2B5ABA17A30D32531C09DAF2865F9E55,20180801
2B5ABA17A30D32531C09DAF2865F9E55,20180801
2B5ABA17A30D32531C09DAF2865F9E55,20180801
159002C6F393752AD79B3C2E8C7104C7,20180801
159002C6F393752AD79B3C2E8C7104C7,20180801
159002C6F393752AD79B3C2E8C7104C7,20180801
A8D7DCCA39D8703F2928AD2D7BBB6BE9,20180801
A8D7DCCA39D8703F2928AD2D7BBB6BE9,20180801
A8D7DCCA39D8703F2928AD2D7BBB6BE9,20180801
F4634EFF4D9470DCA00051E3304B81AF,20180801
F4634EFF4D9470DCA00051E3304B81AF,20180801
F4634EFF4D9470DCA00051E3304B81AF,20180801
F4634EFF4D9470DCA00051E3304B81AF,20180801
F4634EFF4D9470DCA00051E3304B81AF,20180801
F4634EFF4D9470DCA00051E3304B81AF,20180801
EBC3581ADA874D494FBE2C7CCF53BF99,20180801
EBC3581ADA874D494FBE2C7CCF53BF99,20180801
EBC3581ADA874D494FBE2C7CCF53BF99,20180801
D41AA91B61872612B5F5F4E42870042C,20180801
D41AA91B61872612B5F5F4E42870042C,20180801
D41AA91B61872612B5F5F4E42870042C,20180801
D41AA91B61872612B5F5F4E42870042C,20180801
D41AA91B61872612B5F5F4E42870042C,20180801
D41AA91B61872612B5F5F4E42870042C,20180801
D41AA91B61872612B5F5F4E42870042C,20180801
D41AA91B61872612B5F5F4E42870042C,20180801
D41AA91B61872612B5F5F4E42870042C,20180801
D41AA91B61872612B5F5F4E42870042C,20180801
D41AA91B61872612B5F5F4E42870042C,20180801
45BDDEC4DF8773F88DC51D1AFD145521,20180801
45BDDEC4DF8773F88DC51D1AFD145521,20180801
45BDDEC4DF8773F88DC51D1AFD145521,20180801
CEBD783B8F2E96E9F3B9424D4FB130E7,20180801
CEBD783B8F2E96E9F3B9424D4FB130E7,20180801
CEBD783B8F2E96E9F3B9424D4FB130E7,20180801
D9AA0EC27AF47514DDB5C664A6EF758A,20180801
D9AA0EC27AF47514DDB5C664A6EF758A,20180801
D9AA0EC27AF47514DDB5C664A6EF758A,20180801
D9AA0EC27AF47514DDB5C664A6EF758A,20180801
D9AA0EC27AF47514DDB5C664A6EF758A,20180801
D9AA0EC27AF47514DDB5C664A6EF758A,20180801
D9AA0EC27AF47514DDB5C664A6EF758A,20180801
D9AA0EC27AF47514DDB5C664A6EF758A,20180801
D9AA0EC27AF47514DDB5C664A6EF758A,20180801
D9AA0EC27AF47514DDB5C664A6EF758A,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
04EF01C1F4723249F90F920DF018F16C,20180801
55BFC405FFA33C0781DE73101011E45B,20180801
55BFC405FFA33C0781DE73101011E45B,20180801
55BFC405FFA33C0781DE73101011E45B,20180801
CFA0F8C5E25A71062E573EF8E6BC9F76,20180801
CFA0F8C5E25A71062E573EF8E6BC9F76,20180801
CFA0F8C5E25A71062E573EF8E6BC9F76,20180801
CFA0F8C5E25A71062E573EF8E6BC9F76,20180801
CFA0F8C5E25A71062E573EF8E6BC9F76,20180801
CFA0F8C5E25A71062E573EF8E6BC9F76,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
DA48D36D07835B1918BDF831AF83B5EF,20180801
EFB696A82D093B3AFBE92FF526DD5CEA,20180801
EFB696A82D093B3AFBE92FF526DD5CEA,20180801
EFB696A82D093B3AFBE92FF526DD5CEA,20180801
EFB696A82D093B3AFBE92FF526DD5CEA,20180801
EFB696A82D093B3AFBE92FF526DD5CEA,20180801
EFB696A82D093B3AFBE92FF526DD5CEA,20180801
EFB696A82D093B3AFBE92FF526DD5CEA,20180801
EFB696A82D093B3AFBE92FF526DD5CEA,20180801
EFB696A82D093B3AFBE92FF526DD5CEA,20180801
EFB696A82D093B3AFB
Query:
SELECT "user_pseudo_id", "event_date"
FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
LIMIT 1000;
Answer:
Too long, hard cut:
user_pseudo_id,event_date
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
B458770ED6E295374FEEB3A68902CC28,20180801
841A68D5D1F94857BEB64225193B2432,20180801
841A68D5D1F94857BEB64225193B2432,20180801
841A68D5D1F94857BEB64225193B2432,20180801
841A68D5D1F94857BEB64225193B2432,20180801
841A68D5D1F94857BEB64225193B2432,20180801
841A68D5D1F94857BEB64225193B2432,20180801
841A68D5D1F94857BEB64225193B2432,20180801
841A68D5D1F94857BEB64225193B2432,20180801
841A68D5D1F94857BEB64225193B2432,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
27293EA0B2F41A672E15EF7B1FA21298,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDAABBA18B05D4E48,20180801
EE99F8CB32999A0FDA
End Exploring Related Columns
Task: Which quickplay event type had the lowest user retention rate during the second week after their initial engagement, for users who first engaged between August 1 and August 15, 2018?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Event_Type,Retention_Rate_Week2
event_type:str,retention_rate:0<=float<=100
(Attention: answer in one row)
```

**Explanation:**

The table above indicates the specific quickplay event type that had the lowest user retention rate during the second week after initial engagement for users who first engaged between August 1 and August 15, 2018. The `Event_Type` column represents the name of the quickplay event type, and the `Retention_Rate_Week2` column shows the retention rate as a percentage between 0 and 100..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-20 16:15:23 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 16:15:23 - root - INFO - ```sql
SELECT
    t1."event_name" AS "Event_Type",
    ROUND((COUNT(DISTINCT CASE WHEN t2."has_return_event" = 1 THEN t1."user_pseudo_id" END)::FLOAT
           / COUNT(DISTINCT t1."user_pseudo_id")) * 100, 4) AS "Retention_Rate_Week2"
FROM (
    SELECT
        "user_pseudo_id",
        "event_name",
        DATE(TO_TIMESTAMP_LTZ("user_first_touch_timestamp"/1e6)) AS "first_engagement_date"
    FROM (
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180802"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180803"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180804"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180805"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180806"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180807"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180808"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180809"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180810"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180811"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180812"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180813"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180814"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180815"
    ) AS t
    WHERE
        DATE(TO_TIMESTAMP_LTZ(t."user_first_touch_timestamp"/1e6)) BETWEEN '2018-08-01' AND '2018-08-15'
        AND t."event_name" IN (
            'level_complete_quickplay',
            'level_start_quickplay',
            'level_end_quickplay',
            'level_fail_quickplay',
            'level_retry_quickplay',
            'level_reset_quickplay'
        )
        AND DATE(TO_TIMESTAMP_LTZ(t."event_timestamp"/1e6)) = DATE(TO_TIMESTAMP_LTZ(t."user_first_touch_timestamp"/1e6))
) AS t1
LEFT JOIN (
    SELECT
        "user_pseudo_id",
        1 AS "has_return_event"
    FROM (
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180808"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180809"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180810"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180811"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180812"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180813"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180814"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180815"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180816"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180817"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180818"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180819"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180820"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180821"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180822"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180823"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180824"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180825"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180826"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180827"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180828"
    ) AS t
    WHERE
        t."user_pseudo_id" IN (SELECT DISTINCT "user_pseudo_id" FROM t1)
        AND DATEDIFF('DAY', DATE(TO_TIMESTAMP_LTZ(t."user_first_touch_timestamp"/1e6)), DATE(TO_TIMESTAMP_LTZ(t."event_timestamp"/1e6))) BETWEEN 7 AND 13
    GROUP BY "user_pseudo_id"
) AS t2
ON t1."user_pseudo_id" = t2."user_pseudo_id"
GROUP BY t1."event_name"
ORDER BY "Retention_Rate_Week2" ASC NULLS LAST
LIMIT 1;
```
2025-01-20 16:15:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 16:15:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 16:15:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 16:15:25 - snowflake.connector.connection - INFO - closed
2025-01-20 16:15:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 16:15:25 - root - INFO - itercount: 1
2025-01-20 16:15:25 - root - INFO - 002003 (42S02): 01b9d74f-0004-7ed2-0001-11c300f1e96a: SQL compilation error:
Object 'T1' does not exist or not authorized.
2025-01-20 16:15:25 - root - INFO - Input sql:
SELECT
    t1."event_name" AS "Event_Type",
    ROUND((COUNT(DISTINCT CASE WHEN t2."has_return_event" = 1 THEN t1."user_pseudo_id" END)::FLOAT
           / COUNT(DISTINCT t1."user_pseudo_id")) * 100, 4) AS "Retention_Rate_Week2"
FROM (
    SELECT
        "user_pseudo_id",
        "event_name",
        DATE(TO_TIMESTAMP_LTZ("user_first_touch_timestamp"/1e6)) AS "first_engagement_date"
    FROM (
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180802"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180803"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180804"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180805"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180806"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180807"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180808"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180809"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180810"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180811"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180812"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180813"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180814"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180815"
    ) AS t
    WHERE
        DATE(TO_TIMESTAMP_LTZ(t."user_first_touch_timestamp"/1e6)) BETWEEN '2018-08-01' AND '2018-08-15'
        AND t."event_name" IN (
            'level_complete_quickplay',
            'level_start_quickplay',
            'level_end_quickplay',
            'level_fail_quickplay',
            'level_retry_quickplay',
            'level_reset_quickplay'
        )
        AND DATE(TO_TIMESTAMP_LTZ(t."event_timestamp"/1e6)) = DATE(TO_TIMESTAMP_LTZ(t."user_first_touch_timestamp"/1e6))
) AS t1
LEFT JOIN (
    SELECT
        "user_pseudo_id",
        1 AS "has_return_event"
    FROM (
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180808"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180809"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180810"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180811"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180812"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180813"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180814"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180815"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180816"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180817"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180818"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180819"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180820"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180821"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180822"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180823"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180824"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180825"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180826"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180827"
        UNION ALL
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180828"
    ) AS t
    WHERE
        t."user_pseudo_id" IN (SELECT DISTINCT "user_pseudo_id" FROM t1)
        AND DATEDIFF('DAY', DATE(TO_TIMESTAMP_LTZ(t."user_first_touch_timestamp"/1e6)), DATE(TO_TIMESTAMP_LTZ(t."event_timestamp"/1e6))) BETWEEN 7 AND 13
    GROUP BY "user_pseudo_id"
) AS t2
ON t1."user_pseudo_id" = t2."user_pseudo_id"
GROUP BY t1."event_name"
ORDER BY "Retention_Rate_Week2" ASC NULLS LAST
LIMIT 1;
The error information is:
002003 (42S02): 01b9d74f-0004-7ed2-0001-11c300f1e96a: SQL compilation error:
Object 'T1' does not exist or not authorized.
Please correct it and output only 1 complete SQL query.
2025-01-20 16:17:53 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 16:17:53 - root - INFO - ```sql
WITH initial_events AS (
    SELECT
        "user_pseudo_id",
        "event_name",
        DATE(TO_TIMESTAMP_LTZ("user_first_touch_timestamp" / 1e6)) AS "first_engagement_date",
        DATE(TO_TIMESTAMP_LTZ("event_timestamp" / 1e6)) AS "event_date"
    FROM (
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180802"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180803"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180804"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180805"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180806"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180807"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180808"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180809"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180810"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180811"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180812"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180813"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180814"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180815"
    ) AS t
    WHERE
        DATE(TO_TIMESTAMP_LTZ(t."user_first_touch_timestamp" / 1e6)) BETWEEN '2018-08-01' AND '2018-08-15'
        AND t."event_name" IN (
            'level_complete_quickplay',
            'level_start_quickplay',
            'level_end_quickplay',
            'level_fail_quickplay',
            'level_retry_quickplay',
            'level_reset_quickplay'
        )
        AND DATE(TO_TIMESTAMP_LTZ(t."event_timestamp" / 1e6)) = DATE(TO_TIMESTAMP_LTZ(t."user_first_touch_timestamp" / 1e6))
),
retention_events AS (
    SELECT
        "user_pseudo_id",
        DATE(TO_TIMESTAMP_LTZ("event_timestamp" / 1e6)) AS "event_date"
    FROM (
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180808"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180809"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180810"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180811"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180812"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180813"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180814"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180815"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180816"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180817"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180818"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180819"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180820"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180821"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180822"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180823"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180824"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180825"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180826"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180827"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180828"
    ) AS t
    WHERE t."user_pseudo_id" IN (SELECT DISTINCT "user_pseudo_id" FROM initial_events)
),
user_retention AS (
    SELECT
        ie."user_pseudo_id",
        ie."event_name",
        MIN(DATEDIFF('DAY', ie."first_engagement_date", re."event_date")) AS "days_since_engagement"
    FROM initial_events ie
    LEFT JOIN retention_events re
        ON ie."user_pseudo_id" = re."user_pseudo_id"
    GROUP BY ie."user_pseudo_id", ie."event_name"
)
SELECT
    "event_name" AS "Event_Type",
    ROUND((COUNT(DISTINCT CASE WHEN "days_since_engagement" BETWEEN 7 AND 13 THEN "user_pseudo_id" END) * 100.0)
          / COUNT(DISTINCT "user_pseudo_id"), 4) AS "Retention_Rate_Week2"
FROM user_retention
GROUP BY "event_name"
ORDER BY "Retention_Rate_Week2" ASC NULLS LAST
LIMIT 1;
```
2025-01-20 16:17:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 16:17:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 16:17:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 16:17:55 - snowflake.connector.connection - INFO - closed
2025-01-20 16:17:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 16:17:55 - root - INFO - itercount: 2
2025-01-20 16:17:55 - root - INFO - 001789 (42601): 01b9d751-0004-7ed2-0001-11c300f201be: SQL compilation error:
invalid number of result columns for set operator input branches, expected 19, got 20 in branch 21
2025-01-20 16:17:55 - root - INFO - Input sql:
WITH initial_events AS (
    SELECT
        "user_pseudo_id",
        "event_name",
        DATE(TO_TIMESTAMP_LTZ("user_first_touch_timestamp" / 1e6)) AS "first_engagement_date",
        DATE(TO_TIMESTAMP_LTZ("event_timestamp" / 1e6)) AS "event_date"
    FROM (
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180802"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180803"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180804"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180805"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180806"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180807"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180808"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180809"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180810"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180811"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180812"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180813"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180814"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180815"
    ) AS t
    WHERE
        DATE(TO_TIMESTAMP_LTZ(t."user_first_touch_timestamp" / 1e6)) BETWEEN '2018-08-01' AND '2018-08-15'
        AND t."event_name" IN (
            'level_complete_quickplay',
            'level_start_quickplay',
            'level_end_quickplay',
            'level_fail_quickplay',
            'level_retry_quickplay',
            'level_reset_quickplay'
        )
        AND DATE(TO_TIMESTAMP_LTZ(t."event_timestamp" / 1e6)) = DATE(TO_TIMESTAMP_LTZ(t."user_first_touch_timestamp" / 1e6))
),
retention_events AS (
    SELECT
        "user_pseudo_id",
        DATE(TO_TIMESTAMP_LTZ("event_timestamp" / 1e6)) AS "event_date"
    FROM (
        SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180808"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180809"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180810"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180811"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180812"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180813"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180814"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180815"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180816"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180817"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180818"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180819"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180820"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180821"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180822"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180823"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180824"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180825"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180826"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180827"
        UNION ALL SELECT * FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180828"
    ) AS t
    WHERE t."user_pseudo_id" IN (SELECT DISTINCT "user_pseudo_id" FROM initial_events)
),
user_retention AS (
    SELECT
        ie."user_pseudo_id",
        ie."event_name",
        MIN(DATEDIFF('DAY', ie."first_engagement_date", re."event_date")) AS "days_since_engagement"
    FROM initial_events ie
    LEFT JOIN retention_events re
        ON ie."user_pseudo_id" = re."user_pseudo_id"
    GROUP BY ie."user_pseudo_id", ie."event_name"
)
SELECT
    "event_name" AS "Event_Type",
    ROUND((COUNT(DISTINCT CASE WHEN "days_since_engagement" BETWEEN 7 AND 13 THEN "user_pseudo_id" END) * 100.0)
          / COUNT(DISTINCT "user_pseudo_id"), 4) AS "Retention_Rate_Week2"
FROM user_retention
GROUP BY "event_name"
ORDER BY "Retention_Rate_Week2" ASC NULLS LAST
LIMIT 1;
The error information is:
001789 (42601): 01b9d751-0004-7ed2-0001-11c300f201be: SQL compilation error:
invalid number of result columns for set operator input branches, expected 19, got 20 in branch 21
Please correct it and output only 1 complete SQL query.
2025-01-20 16:19:15 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 16:19:15 - root - INFO - ```sql
WITH initial_events AS (
    SELECT
        "user_pseudo_id",
        "event_name",
        DATE(TO_TIMESTAMP_LTZ("user_first_touch_timestamp" / 1e6)) AS "first_engagement_date",
        DATE(TO_TIMESTAMP_LTZ("event_timestamp" / 1e6)) AS "event_date"
    FROM (
        SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180802"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180803"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180804"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180805"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180806"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180807"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180808"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180809"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180810"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180811"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180812"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180813"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180814"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180815"
    ) AS t
    WHERE
        DATE(TO_TIMESTAMP_LTZ(t."user_first_touch_timestamp" / 1e6)) BETWEEN '2018-08-01' AND '2018-08-15'
        AND t."event_name" IN (
            'level_complete_quickplay',
            'level_start_quickplay',
            'level_end_quickplay',
            'level_fail_quickplay',
            'level_retry_quickplay',
            'level_reset_quickplay'
        )
        AND DATE(TO_TIMESTAMP_LTZ(t."event_timestamp" / 1e6)) = DATE(TO_TIMESTAMP_LTZ(t."user_first_touch_timestamp" / 1e6))
),
retention_events AS (
    SELECT
        "user_pseudo_id",
        DATE(TO_TIMESTAMP_LTZ("event_timestamp" / 1e6)) AS "event_date",
        "user_first_touch_timestamp"
    FROM (
        SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180808"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180809"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180810"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180811"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180812"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180813"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180814"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180815"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180816"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180817"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180818"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180819"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180820"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180821"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180822"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180823"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180824"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180825"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180826"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180827"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180828"
    ) AS t
    WHERE t."user_pseudo_id" IN (SELECT DISTINCT "user_pseudo_id" FROM initial_events)
),
user_retention AS (
    SELECT
        ie."user_pseudo_id",
        ie."event_name",
        MIN(DATEDIFF('DAY', ie."first_engagement_date", re."event_date")) AS "days_since_engagement"
    FROM initial_events ie
    LEFT JOIN retention_events re
        ON ie."user_pseudo_id" = re."user_pseudo_id"
    GROUP BY ie."user_pseudo_id", ie."event_name"
)
SELECT
    "event_name" AS "Event_Type",
    ROUND((COUNT(DISTINCT CASE WHEN "days_since_engagement" BETWEEN 7 AND 13 THEN "user_pseudo_id" END) * 100.0)
          / COUNT(DISTINCT "user_pseudo_id"), 4) AS "Retention_Rate_Week2"
FROM user_retention
GROUP BY "event_name"
ORDER BY "Retention_Rate_Week2" ASC NULLS LAST
LIMIT 1;
```
2025-01-20 16:19:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 16:19:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 16:19:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 16:19:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 16:19:21 - snowflake.connector.connection - INFO - closed
2025-01-20 16:19:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 16:19:22 - root - INFO - itercount: 3
2025-01-20 16:19:22 - root - INFO - 0
2025-01-20 16:19:22 - root - INFO - results: 
Event_Type,Retention_Rate_Week2
level_complete_quickplay,4.8951


2025-01-20 16:19:22 - root - INFO - Please check the answer again by reviewing Which quickplay event type had the lowest user retention rate during the second week after their initial engagement, for users who first engaged between August 1 and August 15, 2018?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Event_Type,Retention_Rate_Week2
event_type:str,retention_rate:0<=float<=100
(Attention: answer in one row)
```

**Explanation:**

The table above indicates the specific quickplay event type that had the lowest user retention rate during the second week after initial engagement for users who first engaged between August 1 and August 15, 2018. The `Event_Type` column represents the name of the quickplay event type, and the `Retention_Rate_Week2` column shows the retention rate as a percentage between 0 and 100. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Event_Type,Retention_Rate_Week2
level_complete_quickplay,4.8951
Current sql:
WITH initial_events AS (
    SELECT
        "user_pseudo_id",
        "event_name",
        DATE(TO_TIMESTAMP_LTZ("user_first_touch_timestamp" / 1e6)) AS "first_engagement_date",
        DATE(TO_TIMESTAMP_LTZ("event_timestamp" / 1e6)) AS "event_date"
    FROM (
        SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180802"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180803"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180804"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180805"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180806"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180807"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180808"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180809"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180810"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180811"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180812"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180813"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180814"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180815"
    ) AS t
    WHERE
        DATE(TO_TIMESTAMP_LTZ(t."user_first_touch_timestamp" / 1e6)) BETWEEN '2018-08-01' AND '2018-08-15'
        AND t."event_name" IN (
            'level_complete_quickplay',
            'level_start_quickplay',
            'level_end_quickplay',
            'level_fail_quickplay',
            'level_retry_quickplay',
            'level_reset_quickplay'
        )
        AND DATE(TO_TIMESTAMP_LTZ(t."event_timestamp" / 1e6)) = DATE(TO_TIMESTAMP_LTZ(t."user_first_touch_timestamp" / 1e6))
),
retention_events AS (
    SELECT
        "user_pseudo_id",
        DATE(TO_TIMESTAMP_LTZ("event_timestamp" / 1e6)) AS "event_date",
        "user_first_touch_timestamp"
    FROM (
        SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180808"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180809"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180810"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180811"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180812"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180813"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180814"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180815"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180816"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180817"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180818"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180819"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180820"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180821"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180822"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180823"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180824"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180825"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180826"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180827"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp" FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180828"
    ) AS t
    WHERE t."user_pseudo_id" IN (SELECT DISTINCT "user_pseudo_id" FROM initial_events)
),
user_retention AS (
    SELECT
        ie."user_pseudo_id",
        ie."event_name",
        MIN(DATEDIFF('DAY', ie."first_engagement_date", re."event_date")) AS "days_since_engagement"
    FROM initial_events ie
    LEFT JOIN retention_events re
        ON ie."user_pseudo_id" = re."user_pseudo_id"
    GROUP BY ie."user_pseudo_id", ie."event_name"
)
SELECT
    "event_name" AS "Event_Type",
    ROUND((COUNT(DISTINCT CASE WHEN "days_since_engagement" BETWEEN 7 AND 13 THEN "user_pseudo_id" END) * 100.0)
          / COUNT(DISTINCT "user_pseudo_id"), 4) AS "Retention_Rate_Week2"
FROM user_retention
GROUP BY "event_name"
ORDER BY "Retention_Rate_Week2" ASC NULLS LAST
LIMIT 1;
2025-01-20 16:21:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 16:21:02 - root - INFO - ```sql
WITH initial_events AS (
    SELECT
        "user_pseudo_id",
        "event_name",
        DATE(TO_TIMESTAMP_LTZ("user_first_touch_timestamp" / 1e6)) AS "first_engagement_date",
        DATE(TO_TIMESTAMP_LTZ("event_timestamp" / 1e6)) AS "event_date"
    FROM (
        SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180801"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180802"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180803"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180804"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180805"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180806"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180807"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180808"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180809"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180810"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180811"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180812"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180813"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180814"
        UNION ALL SELECT "user_pseudo_id", "event_name", "user_first_touch_timestamp", "event_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180815"
    ) AS t
    WHERE
        DATE(TO_TIMESTAMP_LTZ(t."user_first_touch_timestamp" / 1e6)) BETWEEN '2018-08-01' AND '2018-08-15'
        AND t."event_name" IN (
            'level_complete_quickplay',
            'level_start_quickplay',
            'level_end_quickplay',
            'level_fail_quickplay',
            'level_retry_quickplay',
            'level_reset_quickplay'
        )
        AND DATE(TO_TIMESTAMP_LTZ(t."event_timestamp" / 1e6)) = DATE(TO_TIMESTAMP_LTZ(t."user_first_touch_timestamp" / 1e6))
),
retention_events AS (
    SELECT
        "user_pseudo_id",
        DATE(TO_TIMESTAMP_LTZ("event_timestamp" / 1e6)) AS "event_date",
        "user_first_touch_timestamp"
    FROM (
        SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180808"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180809"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180810"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180811"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180812"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180813"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180814"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180815"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180816"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180817"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180818"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180819"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180820"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180821"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180822"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180823"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180824"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180825"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180826"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180827"
        UNION ALL SELECT "user_pseudo_id", "event_timestamp", "user_first_touch_timestamp"
        FROM FIREBASE.ANALYTICS_153293282."EVENTS_20180828"
    ) AS t
    WHERE t."user_pseudo_id" IN (SELECT DISTINCT "user_pseudo_id" FROM initial_events)
),
user_retention AS (
    SELECT
        ie."user_pseudo_id",
        ie."event_name",
        MIN(DATEDIFF('DAY', ie."first_engagement_date", re."event_date")) AS "days_since_engagement"
    FROM initial_events ie
    LEFT JOIN retention_events re
        ON ie."user_pseudo_id" = re."user_pseudo_id"
    GROUP BY ie."user_pseudo_id", ie."event_name"
)
SELECT
    "event_name" AS "Event_Type",
    ROUND((COUNT(DISTINCT CASE WHEN "days_since_engagement" BETWEEN 7 AND 13 THEN ie."user_pseudo_id" END) * 100.0)
          / COUNT(DISTINCT ie."user_pseudo_id"), 4) AS "Retention_Rate_Week2"
FROM user_retention ie
GROUP BY "event_name"
ORDER BY "Retention_Rate_Week2" ASC NULLS LAST
LIMIT 1;
```
2025-01-20 16:21:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 16:21:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 16:21:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 16:21:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 16:21:05 - snowflake.connector.connection - INFO - closed
2025-01-20 16:21:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 16:21:05 - root - INFO - itercount: 4
2025-01-20 16:21:05 - root - INFO - 0
2025-01-20 16:21:05 - root - INFO - Total iteration counts: 4
