2025-01-20 18:40:03 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:40:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:40:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:40:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:40:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 18:40:05 - snowflake.connector.connection - INFO - closed
2025-01-20 18:40:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:40:05 - root - INFO - SQL:
SELECT DISTINCT f.value::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A61%'
   LIMIT 100;
Results:
Too long, hard cut:
cpc_code
"{""code"":""A61P31/16"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B2018/00059"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K31/351"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61L2/18"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61P31/18"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/369"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K31/506"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61P5/38"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M2210/0625"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61L2300/42"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B2017/1225"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B8/06"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K39/46445"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M2039/2426"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K38/17"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61H1/0266"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61F2002/4685"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61N1/3925"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K35/32"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/0533"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61M25/01"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K31/522"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61K31/57"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61L27/12"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61F5/0193"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61D2003/003"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B8/06"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B90/50"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61F2230/0006"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B1/00142"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B2562/164"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61M5/2459"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K2039/523"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61G17/042"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B17/22"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61H19/50"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M39/16"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M2205/3331"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61F2002/30387"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61F5/05841"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K48/0058"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61B2017/0432"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B2019/4873"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K47/4823"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61L27/52"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/7275"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61M2025/0226"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K9/2846"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K39/39"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61B6/4085"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B17/1739"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K47/6923"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M39/284"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61K31/165"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/150435"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B5/15105"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61F2/4611"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K51/1096"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K9/0041"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61K35/744"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61M25/0693"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K35/741"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61K39/4613"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61J7/0076"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K9/7023"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B90/20"",""first"":false,""inventive"":true,""tree"":

2025-01-20 18:40:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:40:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:40:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:40:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 18:40:07 - snowflake.connector.connection - INFO - closed
2025-01-20 18:40:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:40:08 - root - INFO - SQL:
SELECT t."assignee_harmonized"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 100;
Results:
Too long, hard cut:
assignee_harmonized
"[
  {
    ""country_code"": ""CR"",
    ""name"": ""UNIV COSTA RICA""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BAYER AG""
  }
]"
[]
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""CRABTREE ELECTRICAL IND LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""BASF AG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""MORITA SANGYO KK""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""TOSHIBA CORP""
  }
]"
[]
"[
  {
    ""country_code"": """",
    ""name"": ""ADOLPH BEREN""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""VOEST ALPINE AG""
  }
]"
"[
  {
    ""country_code"": ""HU"",
    ""name"": ""CHINOIN GYOGYSZER ES VEGYESZET""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""PFUETZNER HELMUT DIPL ING DR T""
  },
  {
    ""country_code"": ""AT"",
    ""name"": ""KRAUSE ERWIN DIPL ING""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BROCKWAY GLASS CO INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""CIBA GEIGY""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""MUELLER G""
  }
]"
"[
  {
    ""country_code"": ""CA"",
    ""name"": ""SHARMAN JAMES""
  }
]"
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""LE BLON CHARLES""
  },
  {
    ""country_code"": ""FR"",
    ""name"": ""A OBLASSER A GODDYN ET CIE SOC""
  }
]"
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""ICI LTD""
  }
]"
"[
  {
    ""country_code"": ""IT"",
    ""name"": ""FARINA & FIGLI A""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""KNOBEL & HEER""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""ROESCH ARTHUR""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""ENGEL HUGO""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BOECKLEIN JOSEF""
  }
]"
[]
[]
"[
  {
    ""country_code"": """",
    ""name"": ""M & T CHEMICALS INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""LOEWE OPTA AG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""BAYER AG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""MITSUBISHI HEAVY IND LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""GLOBE UNION INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ISAP SPA""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""JOSHUA BIGWOOD AND SON LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ERWIN SCHWARZ""
  }
]"
[]
"[
  {
    ""country_code"": """",
    ""name"": ""BOSCH GMBH ROBERT""
  }
]"
"[
  {
    ""country_code"": ""NL"",
    ""name"": ""PHILIPS NV""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""SUWA SEIKOSHA KK""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""NIPPON STEEL CORP""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""HOLLINGSWORTH GMBH""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""ECKOLD VORRICHTUNG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""DOWELANCO""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""IGARASHI KAZUYOSHI""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HITACHI LTD""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""CHIYODA CORP""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ROUSSEL UCLAF""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""PETROL ENGINERING S A""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""IRECO CHEMICALS""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""COLGATE PALMOLIVE CO""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""FERRER INT""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""LILLY CO ELI""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""MAUSER WERKE GMBH""
  }
]"
[]
"[
  {
    ""country_code"": """",
    ""name"": ""HOEYER ELLEFSEN AS""
  }
]"
[]
[]
"[
  {
    ""country_code"": ""IT"",
    ""name"": ""SOMET SOC MEC TESSILE""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""MIODRAG SPASOJEVIC""
  }
]"
"[
  {
    ""country_code"": ""YU"",
    ""name"": ""TEHNOLOSKI FAK N SAD""
  }
]"
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""BEECHAM GROUP LTD""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""HOECHST AG""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""BLUM GMBH JULIUS""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""SCHWAMM HORST""
  },
  {
    ""country_code"": ""AT"",
    ""name"": ""PEZZEI FRIEDBERT""
  },
  {
    ""country_code"": ""AT"",
    ""name"": ""KREMS CHEMIE GMBH""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""ELTREVA AG""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""GANNER ERWIN""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""GRASS ALFRED METALLWAREN""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""INKOMAG FA""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""PROHASKA HEINZ""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""SIEMENS AG OESTERREICH""
 

2025-01-20 18:40:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:40:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:40:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:40:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 18:40:09 - snowflake.connector.connection - INFO - closed
2025-01-20 18:40:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:40:09 - root - INFO - SQL:
SELECT t."publication_number", t."filing_date"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A61%'
   LIMIT 100;
Results:
publication_number,filing_date
US-2007010420-A1,20050706
US-2007010420-A1,20050706
US-2007010420-A1,20050706
US-2007010420-A1,20050706
US-2007010420-A1,20050706
US-2007010420-A1,20050706
US-2006047298-A1,20050826
US-2006047298-A1,20050826
US-2006047298-A1,20050826
US-2006047298-A1,20050826
US-2006047298-A1,20050826
US-2006047298-A1,20050826
US-2006047298-A1,20050826
US-2006047298-A1,20050826
US-2006047298-A1,20050826
US-2006047298-A1,20050826
US-2006047298-A1,20050826
US-2006047298-A1,20050826
US-2006020170-A1,20050909
US-2006020170-A1,20050909
US-2006020170-A1,20050909
US-2006020170-A1,20050909
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006069023-A1,20050919
US-2006069023-A1,20050919
US-2006069023-A1,20050919
US-2006069023-A1,20050919
US-2006069023-A1,20050919
US-2006068001-A1,20051116
US-2006068001-A1,20051116
US-2006068001-A1,20051116
US-2006068001-A1,20051116
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2007142872-A1,20051221
US-2007142872-A1,20051221
US-2007142872-A1,20051221
US-2007142872-A1,20051221
US-2007142872-A1,20051221
US-2007142872-A1,20051221
US-2007142872-A1,20051221
US-2007142872-A1,20051221
US-2007175960-A1,20060131
US-2007175960-A1,20060131
US-2007175960-A1,20060131
US-2007175960-A1,20060131
US-2007175960-A1,20060131

2025-01-20 18:40:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:40:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:40:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:40:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 18:40:11 - snowflake.connector.connection - INFO - closed
2025-01-20 18:40:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:40:11 - root - INFO - SQL:
SELECT t."filing_date", CAST(LEFT(t."filing_date"::STRING, 4) AS INTEGER) AS "year"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 100;
Results:
filing_date,year
19971015,1997
19990322,1999
0,0
19830217,1983
19900109,1990
19900101,1990
19860106,1986
0,0
19480102,1948
19800125,1980
19820209,1982
19820219,1982
19700116,1970
19700224,1970
19700501,1970
0,0
18901220,1890
19690318,1969
19660117,1966
18940609,1894
18941217,1894
18950125,1895
0,0
19620924,1962
19650616,1965
19660402,1966
19660506,1966
19660704,1966
19660725,1966
19661121,1966
19600102,1960
19580106,1958
19290107,1929
19400116,1940
19870521,1987
19840705,1984
19920730,1992
19781012,1978
19861030,1986
19910225,1991
19860106,1986
19930106,1993
20150702,2015
19830922,1983
19860626,1986
19730907,1973
19780905,1978
19820512,1982
19880217,1988
19900307,1990
0,0
19790102,1979
0,0
0,0
19710204,1971
19971230,1997
19880317,1988
19820430,1982
19750221,1975
19830503,1983
19810413,1981
19780313,1978
19820518,1982
19820524,1982
19800416,1980
19901205,1990
19860918,1986
19850916,1985
19730328,1973
19851029,1985
19750527,1975
19770706,1977
19750707,1975
19791105,1979
19781012,1978
19721012,1972
19781219,1978
19730906,1973
19731029,1973
19740405,1974
19741216,1974
19750221,1975
19750925,1975
19760105,1976
19760123,1976
19760331,1976
19761125,1976
19770324,1977
19770413,1977
19770802,1977
19771125,1977
19780505,1978
19780613,1978
19780712,1978
19780717,1978
19781020,1978
19790110,1979
19790718,1979
19800918,1980
19520218,1952

2025-01-20 18:40:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:40:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:40:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:40:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 18:40:13 - snowflake.connector.connection - INFO - closed
2025-01-20 18:40:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:40:13 - root - INFO - SQL:
SELECT t."assignee_harmonized", t."publication_number"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A61%'
   LIMIT 100;
Results:
Too long, hard cut:
assignee_harmonized,publication_number
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SEEGENE INC""
  }
]",WO-2021187824-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SEEGENE INC""
  }
]",WO-2021187824-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SEEGENE INC""
  }
]",WO-2021187824-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SEEGENE INC""
  }
]",WO-2021187824-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SEEGENE INC""
  }
]",WO-2021187824-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""NAVIPHARM CO LTD""
  }
]",WO-2022075760-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""NAVIPHARM CO LTD""
  }
]",WO-2022075760-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""NAVIPHARM CO LTD""
  }
]",WO-2022075760-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""NAVIPHARM CO LTD""
  }
]",WO-2022075760-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""NAVIPHARM CO LTD""
  }
]",WO-2022075760-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""NAVIPHARM CO LTD""
  }
]",WO-2022075760-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""NAVIPHARM CO LTD""
  }
]",WO-2022075760-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""NAVIPHARM CO LTD""
  }
]",WO-2022075760-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""GENECHEM INC""
  }
]",WO-2023128556-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""GENECHEM INC""
  }
]",WO-2023128556-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""GENECHEM INC""
  }
]",WO-2023128556-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""GENECHEM INC""
  }
]",WO-2023128556-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""GENECHEM INC""
  }
]",WO-2023128556-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""GENECHEM INC""
  }
]",WO-2023128556-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""GENECHEM INC""
  }
]",WO-2023128556-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""GENECHEM INC""
  }
]",WO-2023128556-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""GENECHEM INC""
  }
]",WO-2023128556-A1
"[
  {
    ""country_code"": ""MX"",
    ""name"": ""PORTER MORA NUIRYS CRISTINA""
  },
  {
    ""country_code"": ""MX"",
    ""name"": ""ZEA PRADO FRANCISCO""
  }
]",WO-2022015149-A1
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""NOVARTIS AG""
  }
]",PE-20070075-A1
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""NOVARTIS AG""
  }
]",PE-20070075-A1
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""NOVARTIS AG""
  }
]",PE-20070075-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[

2025-01-20 18:40:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:40:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:40:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:40:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 18:40:15 - snowflake.connector.connection - INFO - closed
2025-01-20 18:40:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:40:15 - root - INFO - SQL:
SELECT t."assignee_harmonized", COUNT(t."publication_number") AS "num_applications"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A61%'
   GROUP BY t."assignee_harmonized"
   LIMIT 100;
Results:
Too long, hard cut:
assignee_harmonized,num_applications
"[
  {
    ""country_code"": ""US"",
    ""name"": ""INNOVATION TECH INC""
  }
]",66
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""AIREX CO LTD""
  }
]",36
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""DENTAL MONITORING""
  }
]",35
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""Tricares SAS""
  }
]",17
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PFIZER""
  }
]",1279
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""SIEMENS AG""
  }
]",186
"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV JOSEPH FOURIER""
  }
]",8
"[
  {
    ""country_code"": ""US"",
    ""name"": ""NUCURRENT INC""
  }
]",10
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""HUA MEDICINE SHANGHAI LTD""
  }
]",46
"[
  {
    ""country_code"": ""US"",
    ""name"": ""CALMWAVE INC""
  }
]",11
"[
  {
    ""country_code"": ""US"",
    ""name"": ""INTERIUS BIOTHERAPEUTICS INC""
  }
]",4
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""VERNALIS RES LTD""
  }
]",20
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""TAKEDA PHARMACEUTICALS CO""
  }
]",218
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DAIICHI SANKYO CO LTD""
  }
]",105
"[
  {
    ""country_code"": """",
    ""name"": ""CHUANLIN LIU""
  }
]",1
"[
  {
    ""country_code"": """",
    ""name"": ""LIGAND PHARM INC""
  }
]",7
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MIM SOFTWARE INC""
  }
]",15
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""RILEY LOUIS JOHN""
  }
]",1
"[
  {
    ""country_code"": """",
    ""name"": ""ANGIO MEDICAL CORP""
  },
  {
    ""country_code"": """",
    ""name"": ""UNIV BOSTON""
  }
]",12
"[
  {
    ""country_code"": """",
    ""name"": ""BLOGG NOMINEES PTY LTD""
  }
]",1
"[
  {
    ""country_code"": ""US"",
    ""name"": ""POLY MED INC""
  }
]",51
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MALLINCKRODT LLC""
  }
]",61
"[
  {
    ""country_code"": ""BR"",
    ""name"": ""EPIONE DERMATOLOGIA E CIRURGIA MEDICOS ASSOCIADOS""
  }
]",4
"[
  {
    ""country_code"": ""US"",
    ""name"": ""KATALYST SURGICAL LLC""
  }
]",41
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""VOLKSWAGEN AG""
  }
]",14
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BOEING CO""
  }
]",16
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""DUERR DENTAL GMBH CO KG""
  }
]",13
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""KOREA ADVANCED INST SCI & TECH""
  }
]",46
"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV MINNESOTA""
  }
]",56
"[
  {
    ""country_code"": """",
    ""name"": ""WEI WEI""
  }
]",8
"[
  {
    ""country_code"": """",
    ""name"": ""UNIV EAST CHINA SCIENCE & TECH""
  }
]",29
"[
  {
    ""country_code"": """",
    ""name"": ""ZHONGXIN TECH GUANGDONG CO LTD""
  }
]",5
"[
  {
    ""country_code"": """",
    ""name"": ""CLEVELAND CLINIC FOUNDATION""
  }
]",4
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GILLETTE CO""
  }
]",107
"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV RUTGERS""
  }
]",47
"[
  {
    ""country_code"": """",
    ""name"": ""AMERICAN OPTICAL CORP""
  }
]",2
"[
  {
    ""country_code"": """",
    ""name"": ""GAF CORP""
  }
]",6
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""VECTURA DELIVERY DEVICES LTD""
  }
]",86
"[
  {
    ""country_code"": """",
    ""name"": ""BACON RAYMOND J""
  }
]",4
"[
  {
    ""country_code"": """",
    ""name"": ""CONNAUGHT LAB""
  }
]",8
"[
  {
    ""country_code"": """",
    ""name"": ""BIOMEDICAL INT CO""
  }
]",8
"[
  {
    ""country_code"": """",
    ""name"": ""FISONS LTD""
  }
]",2
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""MILLIPORE SA""
  }
]",2
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""CENTRE NAT RECH SCIENT""
  }
]",53
"[
  {
    ""country_code"": """",
    ""name"": ""SOBICO INC""
  }
]",2
"[
  {
    ""country_code"": ""DK"",
    ""name"": ""PHARMEXA AS""
  }
]",7
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""VALOIS SAS""
  }
]",10
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MCNEIL PPC INC""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""MERCK AND CO INC""
  }
]",19
"[
  {
    ""country_code"": ""US"",
    ""name"": ""STIMWAVE TECH INC""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""GREENE GRAHAM PATRICK""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""SPECK BENJAMIN""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""LOMBARD PAUL""
  }
]",5
"[
  {
    ""country_code"": ""US"",
    ""name"": ""NEUROGENERATION INC""
  }
]",2
"[
  {
    ""country_code"": ""US"",
    ""name"": ""VET THERAPEUTICS INC""
  }
]",5
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""KHANFILTER INC""
  }
]",2
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""PROKARIUM LTD""
  }
]",38
"[
  {
    ""country_code"": """",
    ""name"": ""ZHANG JINLIANG""
  }
]",6
"[
  {
    ""country_code"": """",
    ""name"": ""BEIJING JIANXUKANG TECH CO LTD""
  }
]",2
"[
  {
    ""country_code"": """",
    ""name"": ""Zealand pharma c

2025-01-20 18:40:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:40:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:40:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:40:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 18:40:17 - snowflake.connector.connection - INFO - closed
2025-01-20 18:40:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:40:17 - root - INFO - SQL:
SELECT CAST(LEFT(t."filing_date"::STRING, 4) AS INTEGER) AS "year", COUNT(t."publication_number") AS "num_applications"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A61%'
   GROUP BY "year"
   LIMIT 100;
Results:
year,num_applications
2007,9611
1961,64
1958,59
1956,21
1933,2
1951,14
1909,1
2004,8809
1983,589
1928,16
2013,11846
1954,34
1908,1
2001,6254
1980,292
1971,145
2022,11658
2015,17110
1921,8
1963,63
1905,1
1966,105
1989,1185
1982,514
1999,4564
1972,261
1985,662
1903,1
1960,36
1984,457
1967,54
1939,27
1940,23
1911,19
1906,3
1932,9
1987,898
2000,4596
1968,107
1941,21
1935,25
1944,17
1949,7
1991,1245
1929,14
1986,852
2011,10742
1950,35
1946,20
2014,14244
1974,349
1916,3
1992,2048
1952,22
1947,16
1931,19
1927,6
2012,10559
1923,5
1957,40
2017,26227
1899,2
1998,3760
1988,1170
1934,12
1955,45
2008,9179
1993,2357
1964,65
1937,6
2010,10356
1945,34
1994,2560
2019,22288
1962,75
2020,20867
1930,1
1920,9
1926,4
0,143
1979,396
1981,475
1997,3618
1977,366
1969,119
1938,6
2005,9092
1976,350
1970,214
1915,3
2009,10456
1995,2396
1953,28
1907,3
2016,23264
1996,3111
1975,343
1959,25
1917,1
2003,7938

2025-01-20 18:40:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:40:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:40:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:40:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 18:40:18 - snowflake.connector.connection - INFO - closed
2025-01-20 18:40:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:40:19 - root - INFO - SQL:
SELECT t."assignee_harmonized", COUNT(t."publication_number") AS "num_applications"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A61%'
   GROUP BY t."assignee_harmonized"
   ORDER BY "num_applications" DESC
   LIMIT 100;
Results:
Too long, hard cut:
assignee_harmonized,num_applications
[],56002
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PROCTER & GAMBLE""
  }
]",2302
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""NOVARTIS AG""
  }
]",1629
"[
  {
    ""country_code"": ""US"",
    ""name"": ""COVIDIEN LP""
  }
]",1304
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PFIZER""
  }
]",1279
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""OREAL""
  }
]",1212
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""HOFFMANN LA ROCHE""
  }
]",989
"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV CALIFORNIA""
  }
]",906
"[
  {
    ""country_code"": ""US"",
    ""name"": ""LILLY CO ELI""
  }
]",851
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BECTON DICKINSON CO""
  }
]",847
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BOEHRINGER INGELHEIM INT""
  }
]",829
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""MERCK PATENT GMBH""
  }
]",788
"[
  {
    ""country_code"": ""NL"",
    ""name"": ""KONINKLIJKE PHILIPS NV""
  }
]",784
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASTRAZENECA AB""
  }
]",773
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BRISTOL MYERS SQUIBB CO""
  }
]",746
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ETHICON LLC""
  }
]",700
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BOSTON SCIENT SCIMED INC""
  }
]",695
"[
  {
    ""country_code"": ""US"",
    ""name"": ""COLGATE PALMOLIVE CO""
  }
]",678
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ETHICON ENDO SURGERY INC""
  }
]",647
"[
  {
    ""country_code"": """",
    ""name"": ""PROCTER & GAMBLE""
  }
]",632
"[
  {
    ""country_code"": ""US"",
    ""name"": ""KIMBERLY CLARK CO""
  }
]",627
"[
  {
    ""country_code"": ""BE"",
    ""name"": ""JANSSEN PHARMACEUTICA NV""
  }
]",611
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GENENTECH INC""
  }
]",572
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""IMMATICS BIOTECHNOLOGIES GMBH""
  }
]",569
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""CILAG GMBH INT""
  }
]",568
"[
  {
    ""country_code"": ""US"",
    ""name"": ""AMGEN INC""
  }
]",564
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MEDTRONIC INC""
  }
]",563
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""OLYMPUS CORP""
  }
]",552
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""SANOFI AVENTIS DEUTSCHLAND""
  }
]",548
"[
  {
    ""country_code"": ""US"",
    ""name"": ""VERTEX PHARMA""
  }
]",542
"[
  {
    ""country_code"": ""NZ"",
    ""name"": ""FISHER & PAYKEL HEALTHCARE LTD""
  }
]",535
"[
  {
    ""country_code"": ""US"",
    ""name"": ""EDWARDS LIFESCIENCES CORP""
  }
]",526
"[
  {
    ""country_code"": """",
    ""name"": ""OREAL""
  }
]",525
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",491
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ABBVIE INC""
  }
]",462
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ALLERGAN INC""
  }
]",447
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SMITH & NEPHEW INC""
  }
]",438
"[
  {
    ""country_code"": """",
    ""name"": ""HOFFMANN LA ROCHE""
  }
]",437
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""SMITH & NEPHEW""
  }
]",419
"[
  {
    ""country_code"": ""IL"",
    ""name"": ""BIOSENSE WEBSTER ISRAEL LTD""
  }
]",417
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""TERUMO CORP""
  }
]",406
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GEN ELECTRIC""
  }
]",391
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ETHICON INC""
  }
]",389
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""MEDOS INT SARL""
  }
]",388
"[
  {
    ""country_code"": ""US"",
    ""name"": ""INCYTE CORP""
  }
]",386
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""ALCON INC""
  }
]",383
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SMITHKLINE BEECHAM CORP""
  }
]",379
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""SANOFI SA""
  }
]",363
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""SANOFI AVENTIS""
  }
]",348
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""FUJIFILM CORP""
  }
]",346
"[
  {
    ""country_code"": ""US"",
    ""name"": ""KCI LICENSING INC""
  }
]",344
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""GRUENENTHAL GMBH""
  }
]",342
"[
  {
    ""country_code"": ""US"",
    ""name"": ""DEPUY SYNTHES PRODUCTS INC""
  }
]",342
"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV LELAND STANFORD JUNIOR""
  }
]",339
"[
  {
    ""country_code"": """",
    ""name"": ""COLGATE PALMOLIVE CO""
  }
]",334
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PFIZER PROD INC""
  }
]",330
"[
  {
    ""country_code"": ""US"",
    ""name"": ""REGENERON PHARMA""
  }
]",324
"[
  {
    ""country_code"": ""PR"",
    ""name"": ""ETHICON LLC""
  }
]",322
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GILEAD SCIENCES INC""
  }
]",317
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GLOBUS MEDICAL INC""
  }
]",316
"[
  {
    ""country_code"": ""

2025-01-20 18:40:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:40:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:40:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:40:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 18:40:20 - snowflake.connector.connection - INFO - closed
2025-01-20 18:40:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:40:21 - root - INFO - SQL:
SELECT t."assignee_harmonized", CAST(LEFT(t."filing_date"::STRING, 4) AS INTEGER) AS "year", COUNT(t."publication_number") AS "num_applications"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A61%'
   GROUP BY t."assignee_harmonized", "year"
   LIMIT 100;
Results:
Too long, hard cut:
assignee_harmonized,year,num_applications
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MEDTRONIC VASCULAR INC""
  }
]",2018,89
"[
  {
    ""country_code"": ""BR"",
    ""name"": ""NATURA COSMETICOS SA""
  }
]",2017,47
"[
  {
    ""country_code"": ""LI"",
    ""name"": ""SKAJSTER FAMILIENSTIFTUNG""
  }
]",2017,20
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""APROFOL AG""
  }
]",2018,6
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SEAL SHIELD LLC""
  }
]",2020,15
[],2014,2668
"[
  {
    ""country_code"": ""US"",
    ""name"": ""COOPERVISION INC""
  }
]",1987,10
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MICROVENTION INC""
  }
]",2002,5
"[
  {
    ""country_code"": ""US"",
    ""name"": ""AMGEN INC""
  }
]",2014,10
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""HUMAN METABOLOMICS INST INC""
  }
]",2017,3
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BREEGI SCIENT INC""
  }
]",2018,10
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""KOREA RES INST CHEMICAL TECH""
  }
]",2018,20
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ETHICON LLC""
  },
  {
    ""country_code"": ""CH"",
    ""name"": ""CILAG GMBH INT""
  }
]",2020,14
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""HOECHST AG""
  }
]",1991,10
"[
  {
    ""country_code"": ""NL"",
    ""name"": ""DSM IP ASSETS BV""
  }
]",2006,51
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ARROW INT INVESTMENT""
  }
]",1994,14
"[
  {
    ""country_code"": ""US"",
    ""name"": ""WISCONSIN ALUMNI RES FOUND""
  }
]",1997,5
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""NIWA KOZO""
  }
]",1987,7
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""SCIENCE UNION & CIE""
  }
]",1976,4
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DAINIPPON PHARMACEUTICAL CO""
  }
]",1993,2
"[
  {
    ""country_code"": """",
    ""name"": ""BUNDER GLAS G M B H""
  }
]",1973,3
"[
  {
    ""country_code"": """",
    ""name"": ""FUAAN DEV LTD""
  }
]",1986,2
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""SCHUCKMANN ALFRED VON""
  }
]",2020,32
"[
  {
    ""country_code"": ""TW"",
    ""name"": ""BIONIME CORP""
  }
]",2022,15
"[
  {
    ""country_code"": ""US"",
    ""name"": ""AMO DEV LLC""
  }
]",2022,29
"[
  {
    ""country_code"": """",
    ""name"": ""SHASTRI VENKATRAM P""
  },
  {
    ""country_code"": """",
    ""name"": ""LEE PHILIP J""
  },
  {
    ""country_code"": """",
    ""name"": ""MITRAGOTRI SAMIR""
  },
  {
    ""country_code"": """",
    ""name"": ""LANGER ROBERT S""
  }
]",2003,14
"[
  {
    ""country_code"": ""US"",
    ""name"": ""Spine Thera""
  }
]",2021,25
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""FUJIFILM CORP""
  }
]",2022,6
"[
  {
    ""country_code"": ""CU"",
    ""name"": ""CT INGENIERIA GENETICA BIOTECNOLOGIA""
  }
]",2007,4
"[
  {
    ""country_code"": ""US"",
    ""name"": ""EMBOL X INC""
  }
]",1999,20
"[
  {
    ""country_code"": """",
    ""name"": ""MERCK & CO INC""
  }
]",1990,1
"[
  {
    ""country_code"": ""US"",
    ""name"": ""DEPUY PRODUCTS INC""
  }
]",2011,8
"[
  {
    ""country_code"": """",
    ""name"": ""4D PHARMA RES LTD""
  }
]",2018,92
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""CENTRE NAT RECH SCIENT""
  },
  {
    ""country_code"": ""FR"",
    ""name"": ""HEMARINA SA""
  },
  {
    ""country_code"": ""FR"",
    ""name"": ""UNIV PARIS CURIE""
  },
  {
    ""country_code"": ""FR"",
    ""name"": ""HEMARINA""
  }
]",2015,47
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MASSACHUSETTS INST TECHNOLOGY""
  }
]",2007,3
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""OREAL""
  }
]",1994,24
"[
  {
    ""country_code"": """",
    ""name"": ""XU GUO-FENG""
  },
  {
    ""country_code"": """",
    ""name"": ""XU BIN""
  }
]",2008,14
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SURROZEN OPERATING INC""
  }
]",2018,21
"[
  {
    ""country_code"": ""BE"",
    ""name"": ""JANSSEN PHARMACEUTICA NV""
  }
]",2008,71
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""FROMBIO CO LTD""
  }
]",2022,12
"[
  {
    ""country_code"": ""US"",
    ""name"": ""THE CHILDRENS HOSPITAL CORP""
  }
]",2018,12
"[
  {
    ""country_code"": ""US"",
    ""name"": ""TERUMO CARDIOVASCULAR SYS CORP""
  }
]",2020,39
"[
  {
    ""country_code"": ""US"",
    ""name"": ""JOHNSON & JOHNSON VISION CARE""
  }
]",2017,2
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""BIOGAIA AB""
  }
]",2008,12
"[
  {
    ""country_code"": ""US"",
    ""name"": ""DEKA BIOSCIENCES INC""
  }
]",2023,21
"[
  {
    ""country_code"": """",
    ""name"": ""SPINE SOLUTIONS INC""
  }
]",2003,41
"[
  {
    ""country_code"": ""US"",
    ""name"": ""NIKKEN INTERNATIONAL INC""
  }
]",2012,2
"[
  {
    ""country_code"": ""IT"",
    ""name"": ""BIOINNOVA S R L S""
  },
  {
    ""country_code"": ""IT"",
    ""name"": ""NATURAMLA SRL""
  }
]",2022,2
"[
  {
    ""country_code"": ""DK"",
    ""name"": ""NOVO NORDISK AS""
  }
]",2013,40
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""SYNTHES GMB""


2025-01-20 18:40:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:40:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:40:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:40:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 76
2025-01-20 18:40:22 - snowflake.connector.connection - INFO - closed
2025-01-20 18:40:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:40:23 - root - INFO - SQL:
SELECT sub."year", MAX(sub."num_applications") AS "max_applications"
    FROM (
      SELECT t."assignee_harmonized", CAST(LEFT(t."filing_date"::STRING, 4) AS INTEGER) AS "year", COUNT(t."publication_number") AS "num_applications"
      FROM PATENTS.PATENTS.PUBLICATIONS t,
      LATERAL FLATTEN(input => t."cpc") f
      WHERE f.value::STRING LIKE '%A61%'
      GROUP BY t."assignee_harmonized", "year"
    ) sub
    WHERE sub."assignee_harmonized" = (
      SELECT t."assignee_harmonized"
      FROM PATENTS.PATENTS.PUBLICATIONS t,
      LATERAL FLATTEN(input => t."cpc") f
      WHERE f.value::STRING LIKE '%A61%'
      GROUP BY t."assignee_harmonized"
      ORDER BY COUNT(t."publication_number") DESC
      LIMIT 1
    )
    GROUP BY sub."year"
    ORDER BY "max_applications" DESC
    LIMIT 100;
Results:
year,max_applications
2016,3648
2017,3540
2018,3284
2015,3199
2019,2798
2014,2668
2013,2638
2002,2265
2021,2258
2011,2158
2020,2133
2012,2020
2004,1934
2003,1895
2009,1894
2010,1747
2006,1562
2001,1537
2022,1420
2005,1320
2008,1301
2007,1227
2000,1000
1999,758
1998,733
2023,557
1996,522
1997,480
1994,478
1992,319
1993,314
1995,266
1991,238
1990,195
1989,183
0,137
1988,135
2024,124
1987,120
1981,95
1986,92
1979,72
1982,71
1985,66
1973,59
1974,58
1983,52
1976,43
1969,42
1980,39
1971,37
1984,31
1975,29
1977,27
1966,27
1964,26
1970,25
1978,21
1972,20
1965,16
1968,11
1967,9
1928,5
1934,4
1929,4
1963,4
1923,2
1954,2
1941,1
1936,1
1959,1
1952,1
1948,1
1949,1
1962,1
1950,1

2025-01-20 18:40:23 - root - INFO - itercount: 0
2025-01-20 18:40:23 - root - INFO - Database Name: PATENTS
Schema Name: PATENTS
DDL describes table information.
,0
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,1
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""spif_publication_number"" VARCHAR(16777216),
	""spif_application_number"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""claims_localized_html"" VARIANT,
	""description_localized"" VARIANT,
	""description_localized_html"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""locarno"" VARIANT,
	""citation"" VARIANT,
	""parent"" VARIANT,
	""child"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,2
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table:** `PATENTS.PATENTS.PUBLICATIONS`
  - **"assignee"**: Contains assignee names.
  - **"assignee_harmonized"**: Contains standardized assignee names.
  - **"filing_date"**: Date when the application was filed; used to extract the year.
  - **"cpc"**: Contains CPC classification codes; used to filter patents in category 'A61'.

**Conditions that may be used:**

- Filter where `cpc` codes include 'A61'.
- Extract the year from `"filing_date"`.
- Group by `"assignee_harmonized"` and year.
- Count the number of applications filed.

**SQL Queries:**

1. **Select distinct CPC codes containing 'A61':**

   ```sql
   SELECT DISTINCT f.value::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A61%'
   LIMIT 100;
   ```

2. **View assignee harmonized names:**

   ```sql
   SELECT t."assignee_harmonized"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 100;
   ```

3. **Select filings with CPC code 'A61':**

   ```sql
   SELECT t."publication_number", t."filing_date"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A61%'
   LIMIT 100;
   ```

4. **Extract year from filing_date:**

   ```sql
   SELECT t."filing_date", CAST(LEFT(t."filing_date"::STRING, 4) AS INTEGER) AS "year"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 100;
   ```

5. **List assignees with filings in category 'A61':**

   ```sql
   SELECT t."assignee_harmonized", t."publication_number"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A61%'
   LIMIT 100;
   ```

6. **Count filings per assignee in 'A61':**

   ```sql
   SELECT t."assignee_harmonized", COUNT(t."publication_number") AS "num_applications"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A61%'
   GROUP BY t."assignee_harmonized"
   LIMIT 100;
   ```

7. **Count filings per year in 'A61':**

   ```sql
   SELECT CAST(LEFT(t."filing_date"::STRING, 4) AS INTEGER) AS "year", COUNT(t."publication_number") AS "num_applications"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A61%'
   GROUP BY "year"
   LIMIT 100;
   ```

8. **Top assignees in 'A61' category:**

   ```sql
   SELECT t."assignee_harmonized", COUNT(t."publication_number") AS "num_applications"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A61%'
   GROUP BY t."assignee_harmonized"
   ORDER BY "num_applications" DESC
   LIMIT 100;
   ```

9. **Filings per assignee per year in 'A61':**

   ```sql
   SELECT t."assignee_harmonized", CAST(LEFT(t."filing_date"::STRING, 4) AS INTEGER) AS "year", COUNT(t."publication_number") AS "num_applications"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A61%'
   GROUP BY t."assignee_harmonized", "year"
   LIMIT 100;
   ```

10. **Find the year with most filings for top assignee in 'A61':**

    ```sql
    SELECT sub."year", MAX(sub."num_applications") AS "max_applications"
    FROM (
      SELECT t."assignee_harmonized", CAST(LEFT(t."filing_date"::STRING, 4) AS INTEGER) AS "year", COUNT(t."publication_number") AS "num_applications"
      FROM PATENTS.PATENTS.PUBLICATIONS t,
      LATERAL FLATTEN(input => t."cpc") f
      WHERE f.value::STRING LIKE '%A61%'
      GROUP BY t."assignee_harmonized", "year"
    ) sub
    WHERE sub."assignee_harmonized" = (
      SELECT t."assignee_harmonized"
      FROM PATENTS.PATENTS.PUBLICATIONS t,
      LATERAL FLATTEN(input => t."cpc") f
      WHERE f.value::STRING LIKE '%A61%'
      GROUP BY t."assignee_harmonized"
      ORDER BY COUNT(t."publication_number") DESC
      LIMIT 1
    )
    GROUP BY sub."year"
    ORDER BY "max_applications" DESC
    LIMIT 100;
    ```

These queries explore the relevant data needed to determine the year in which the assignee with the most applications in the patent category 'A61' filed the most applications.Query:
SELECT DISTINCT f.value::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A61%'
   LIMIT 100;
Answer:
Too long, hard cut:
cpc_code
"{""code"":""A61P31/16"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B2018/00059"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K31/351"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61L2/18"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61P31/18"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/369"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K31/506"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61P5/38"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M2210/0625"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61L2300/42"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B2017/1225"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B8/06"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K39/46445"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M2039/2426"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K38/17"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61H1/0266"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61F2002/4685"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61N1/3925"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K35/32"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/0533"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61M25/01"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K31/522"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61K31/57"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61L27/12"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61F5/0193"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61D2003/003"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B8/06"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B90/50"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61F2230/0006"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B1/00142"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B2562/164"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61M5/2459"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K2039/523"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61G17/042"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B17/22"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61H19/50"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M39/16"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M2205/3331"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61F2002/30387"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61F5/05841"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K48/0058"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61B2017/0432"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B2019/4873"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K47/4823"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61L27/52"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/7275"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61M2025/0226"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K9/2846"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K39/39"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61B6/4085"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B17/1739"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K47/6923"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61M39/284"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61K31/165"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61B5/150435"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B5/15105"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61F2/4611"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K51/1096"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K9/0041"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61K35/744"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61M25/0693"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K35/741"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61K39/4613"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61J7/0076"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K9/7023"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B90/20"",""first"":false,""inventive"":true,""tree"":
Query:
SELECT t."assignee_harmonized"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 100;
Answer:
Too long, hard cut:
assignee_harmonized
"[
  {
    ""country_code"": ""CR"",
    ""name"": ""UNIV COSTA RICA""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BAYER AG""
  }
]"
[]
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""CRABTREE ELECTRICAL IND LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""BASF AG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""MORITA SANGYO KK""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""TOSHIBA CORP""
  }
]"
[]
"[
  {
    ""country_code"": """",
    ""name"": ""ADOLPH BEREN""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""VOEST ALPINE AG""
  }
]"
"[
  {
    ""country_code"": ""HU"",
    ""name"": ""CHINOIN GYOGYSZER ES VEGYESZET""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""PFUETZNER HELMUT DIPL ING DR T""
  },
  {
    ""country_code"": ""AT"",
    ""name"": ""KRAUSE ERWIN DIPL ING""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BROCKWAY GLASS CO INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""CIBA GEIGY""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""MUELLER G""
  }
]"
"[
  {
    ""country_code"": ""CA"",
    ""name"": ""SHARMAN JAMES""
  }
]"
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""LE BLON CHARLES""
  },
  {
    ""country_code"": ""FR"",
    ""name"": ""A OBLASSER A GODDYN ET CIE SOC""
  }
]"
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""ICI LTD""
  }
]"
"[
  {
    ""country_code"": ""IT"",
    ""name"": ""FARINA & FIGLI A""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""KNOBEL & HEER""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""ROESCH ARTHUR""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""ENGEL HUGO""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BOECKLEIN JOSEF""
  }
]"
[]
[]
"[
  {
    ""country_code"": """",
    ""name"": ""M & T CHEMICALS INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""LOEWE OPTA AG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""BAYER AG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""MITSUBISHI HEAVY IND LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""GLOBE UNION INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ISAP SPA""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""JOSHUA BIGWOOD AND SON LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ERWIN SCHWARZ""
  }
]"
[]
"[
  {
    ""country_code"": """",
    ""name"": ""BOSCH GMBH ROBERT""
  }
]"
"[
  {
    ""country_code"": ""NL"",
    ""name"": ""PHILIPS NV""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""SUWA SEIKOSHA KK""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""NIPPON STEEL CORP""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""HOLLINGSWORTH GMBH""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""ECKOLD VORRICHTUNG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""DOWELANCO""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""IGARASHI KAZUYOSHI""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HITACHI LTD""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""CHIYODA CORP""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ROUSSEL UCLAF""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""PETROL ENGINERING S A""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""IRECO CHEMICALS""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""COLGATE PALMOLIVE CO""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""FERRER INT""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""LILLY CO ELI""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""MAUSER WERKE GMBH""
  }
]"
[]
"[
  {
    ""country_code"": """",
    ""name"": ""HOEYER ELLEFSEN AS""
  }
]"
[]
[]
"[
  {
    ""country_code"": ""IT"",
    ""name"": ""SOMET SOC MEC TESSILE""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""MIODRAG SPASOJEVIC""
  }
]"
"[
  {
    ""country_code"": ""YU"",
    ""name"": ""TEHNOLOSKI FAK N SAD""
  }
]"
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""BEECHAM GROUP LTD""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""HOECHST AG""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""BLUM GMBH JULIUS""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""SCHWAMM HORST""
  },
  {
    ""country_code"": ""AT"",
    ""name"": ""PEZZEI FRIEDBERT""
  },
  {
    ""country_code"": ""AT"",
    ""name"": ""KREMS CHEMIE GMBH""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""ELTREVA AG""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""GANNER ERWIN""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""GRASS ALFRED METALLWAREN""
  }
]"
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""INKOMAG FA""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""PROHASKA HEINZ""
  }
]"
"[
  {
    ""country_code"": ""AT"",
    ""name"": ""SIEMENS AG OESTERREICH""
 
Query:
SELECT t."publication_number", t."filing_date"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A61%'
   LIMIT 100;
Answer:
publication_number,filing_date
US-2007010420-A1,20050706
US-2007010420-A1,20050706
US-2007010420-A1,20050706
US-2007010420-A1,20050706
US-2007010420-A1,20050706
US-2007010420-A1,20050706
US-2006047298-A1,20050826
US-2006047298-A1,20050826
US-2006047298-A1,20050826
US-2006047298-A1,20050826
US-2006047298-A1,20050826
US-2006047298-A1,20050826
US-2006047298-A1,20050826
US-2006047298-A1,20050826
US-2006047298-A1,20050826
US-2006047298-A1,20050826
US-2006047298-A1,20050826
US-2006047298-A1,20050826
US-2006020170-A1,20050909
US-2006020170-A1,20050909
US-2006020170-A1,20050909
US-2006020170-A1,20050909
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006015009-A1,20050914
US-2006069023-A1,20050919
US-2006069023-A1,20050919
US-2006069023-A1,20050919
US-2006069023-A1,20050919
US-2006069023-A1,20050919
US-2006068001-A1,20051116
US-2006068001-A1,20051116
US-2006068001-A1,20051116
US-2006068001-A1,20051116
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2006148712-A1,20051128
US-2007142872-A1,20051221
US-2007142872-A1,20051221
US-2007142872-A1,20051221
US-2007142872-A1,20051221
US-2007142872-A1,20051221
US-2007142872-A1,20051221
US-2007142872-A1,20051221
US-2007142872-A1,20051221
US-2007175960-A1,20060131
US-2007175960-A1,20060131
US-2007175960-A1,20060131
US-2007175960-A1,20060131
US-2007175960-A1,20060131
Query:
SELECT t."filing_date", CAST(LEFT(t."filing_date"::STRING, 4) AS INTEGER) AS "year"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 100;
Answer:
filing_date,year
19971015,1997
19990322,1999
0,0
19830217,1983
19900109,1990
19900101,1990
19860106,1986
0,0
19480102,1948
19800125,1980
19820209,1982
19820219,1982
19700116,1970
19700224,1970
19700501,1970
0,0
18901220,1890
19690318,1969
19660117,1966
18940609,1894
18941217,1894
18950125,1895
0,0
19620924,1962
19650616,1965
19660402,1966
19660506,1966
19660704,1966
19660725,1966
19661121,1966
19600102,1960
19580106,1958
19290107,1929
19400116,1940
19870521,1987
19840705,1984
19920730,1992
19781012,1978
19861030,1986
19910225,1991
19860106,1986
19930106,1993
20150702,2015
19830922,1983
19860626,1986
19730907,1973
19780905,1978
19820512,1982
19880217,1988
19900307,1990
0,0
19790102,1979
0,0
0,0
19710204,1971
19971230,1997
19880317,1988
19820430,1982
19750221,1975
19830503,1983
19810413,1981
19780313,1978
19820518,1982
19820524,1982
19800416,1980
19901205,1990
19860918,1986
19850916,1985
19730328,1973
19851029,1985
19750527,1975
19770706,1977
19750707,1975
19791105,1979
19781012,1978
19721012,1972
19781219,1978
19730906,1973
19731029,1973
19740405,1974
19741216,1974
19750221,1975
19750925,1975
19760105,1976
19760123,1976
19760331,1976
19761125,1976
19770324,1977
19770413,1977
19770802,1977
19771125,1977
19780505,1978
19780613,1978
19780712,1978
19780717,1978
19781020,1978
19790110,1979
19790718,1979
19800918,1980
19520218,1952
Query:
SELECT t."assignee_harmonized", t."publication_number"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A61%'
   LIMIT 100;
Answer:
Too long, hard cut:
assignee_harmonized,publication_number
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SEEGENE INC""
  }
]",WO-2021187824-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SEEGENE INC""
  }
]",WO-2021187824-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SEEGENE INC""
  }
]",WO-2021187824-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SEEGENE INC""
  }
]",WO-2021187824-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SEEGENE INC""
  }
]",WO-2021187824-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""NAVIPHARM CO LTD""
  }
]",WO-2022075760-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""NAVIPHARM CO LTD""
  }
]",WO-2022075760-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""NAVIPHARM CO LTD""
  }
]",WO-2022075760-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""NAVIPHARM CO LTD""
  }
]",WO-2022075760-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""NAVIPHARM CO LTD""
  }
]",WO-2022075760-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""NAVIPHARM CO LTD""
  }
]",WO-2022075760-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""NAVIPHARM CO LTD""
  }
]",WO-2022075760-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""NAVIPHARM CO LTD""
  }
]",WO-2022075760-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""GENECHEM INC""
  }
]",WO-2023128556-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""GENECHEM INC""
  }
]",WO-2023128556-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""GENECHEM INC""
  }
]",WO-2023128556-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""GENECHEM INC""
  }
]",WO-2023128556-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""GENECHEM INC""
  }
]",WO-2023128556-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""GENECHEM INC""
  }
]",WO-2023128556-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""GENECHEM INC""
  }
]",WO-2023128556-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""GENECHEM INC""
  }
]",WO-2023128556-A1
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""GENECHEM INC""
  }
]",WO-2023128556-A1
"[
  {
    ""country_code"": ""MX"",
    ""name"": ""PORTER MORA NUIRYS CRISTINA""
  },
  {
    ""country_code"": ""MX"",
    ""name"": ""ZEA PRADO FRANCISCO""
  }
]",WO-2022015149-A1
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""NOVARTIS AG""
  }
]",PE-20070075-A1
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""NOVARTIS AG""
  }
]",PE-20070075-A1
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""NOVARTIS AG""
  }
]",PE-20070075-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASCILION AB""
  }
]",WO-2017095321-A1
"[
Query:
SELECT t."assignee_harmonized", COUNT(t."publication_number") AS "num_applications"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A61%'
   GROUP BY t."assignee_harmonized"
   LIMIT 100;
Answer:
Too long, hard cut:
assignee_harmonized,num_applications
"[
  {
    ""country_code"": ""US"",
    ""name"": ""INNOVATION TECH INC""
  }
]",66
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""AIREX CO LTD""
  }
]",36
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""DENTAL MONITORING""
  }
]",35
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""Tricares SAS""
  }
]",17
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PFIZER""
  }
]",1279
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""SIEMENS AG""
  }
]",186
"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV JOSEPH FOURIER""
  }
]",8
"[
  {
    ""country_code"": ""US"",
    ""name"": ""NUCURRENT INC""
  }
]",10
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""HUA MEDICINE SHANGHAI LTD""
  }
]",46
"[
  {
    ""country_code"": ""US"",
    ""name"": ""CALMWAVE INC""
  }
]",11
"[
  {
    ""country_code"": ""US"",
    ""name"": ""INTERIUS BIOTHERAPEUTICS INC""
  }
]",4
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""VERNALIS RES LTD""
  }
]",20
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""TAKEDA PHARMACEUTICALS CO""
  }
]",218
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DAIICHI SANKYO CO LTD""
  }
]",105
"[
  {
    ""country_code"": """",
    ""name"": ""CHUANLIN LIU""
  }
]",1
"[
  {
    ""country_code"": """",
    ""name"": ""LIGAND PHARM INC""
  }
]",7
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MIM SOFTWARE INC""
  }
]",15
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""RILEY LOUIS JOHN""
  }
]",1
"[
  {
    ""country_code"": """",
    ""name"": ""ANGIO MEDICAL CORP""
  },
  {
    ""country_code"": """",
    ""name"": ""UNIV BOSTON""
  }
]",12
"[
  {
    ""country_code"": """",
    ""name"": ""BLOGG NOMINEES PTY LTD""
  }
]",1
"[
  {
    ""country_code"": ""US"",
    ""name"": ""POLY MED INC""
  }
]",51
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MALLINCKRODT LLC""
  }
]",61
"[
  {
    ""country_code"": ""BR"",
    ""name"": ""EPIONE DERMATOLOGIA E CIRURGIA MEDICOS ASSOCIADOS""
  }
]",4
"[
  {
    ""country_code"": ""US"",
    ""name"": ""KATALYST SURGICAL LLC""
  }
]",41
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""VOLKSWAGEN AG""
  }
]",14
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BOEING CO""
  }
]",16
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""DUERR DENTAL GMBH CO KG""
  }
]",13
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""KOREA ADVANCED INST SCI & TECH""
  }
]",46
"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV MINNESOTA""
  }
]",56
"[
  {
    ""country_code"": """",
    ""name"": ""WEI WEI""
  }
]",8
"[
  {
    ""country_code"": """",
    ""name"": ""UNIV EAST CHINA SCIENCE & TECH""
  }
]",29
"[
  {
    ""country_code"": """",
    ""name"": ""ZHONGXIN TECH GUANGDONG CO LTD""
  }
]",5
"[
  {
    ""country_code"": """",
    ""name"": ""CLEVELAND CLINIC FOUNDATION""
  }
]",4
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GILLETTE CO""
  }
]",107
"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV RUTGERS""
  }
]",47
"[
  {
    ""country_code"": """",
    ""name"": ""AMERICAN OPTICAL CORP""
  }
]",2
"[
  {
    ""country_code"": """",
    ""name"": ""GAF CORP""
  }
]",6
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""VECTURA DELIVERY DEVICES LTD""
  }
]",86
"[
  {
    ""country_code"": """",
    ""name"": ""BACON RAYMOND J""
  }
]",4
"[
  {
    ""country_code"": """",
    ""name"": ""CONNAUGHT LAB""
  }
]",8
"[
  {
    ""country_code"": """",
    ""name"": ""BIOMEDICAL INT CO""
  }
]",8
"[
  {
    ""country_code"": """",
    ""name"": ""FISONS LTD""
  }
]",2
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""MILLIPORE SA""
  }
]",2
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""CENTRE NAT RECH SCIENT""
  }
]",53
"[
  {
    ""country_code"": """",
    ""name"": ""SOBICO INC""
  }
]",2
"[
  {
    ""country_code"": ""DK"",
    ""name"": ""PHARMEXA AS""
  }
]",7
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""VALOIS SAS""
  }
]",10
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MCNEIL PPC INC""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""MERCK AND CO INC""
  }
]",19
"[
  {
    ""country_code"": ""US"",
    ""name"": ""STIMWAVE TECH INC""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""GREENE GRAHAM PATRICK""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""SPECK BENJAMIN""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""LOMBARD PAUL""
  }
]",5
"[
  {
    ""country_code"": ""US"",
    ""name"": ""NEUROGENERATION INC""
  }
]",2
"[
  {
    ""country_code"": ""US"",
    ""name"": ""VET THERAPEUTICS INC""
  }
]",5
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""KHANFILTER INC""
  }
]",2
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""PROKARIUM LTD""
  }
]",38
"[
  {
    ""country_code"": """",
    ""name"": ""ZHANG JINLIANG""
  }
]",6
"[
  {
    ""country_code"": """",
    ""name"": ""BEIJING JIANXUKANG TECH CO LTD""
  }
]",2
"[
  {
    ""country_code"": """",
    ""name"": ""Zealand pharma c
Query:
SELECT CAST(LEFT(t."filing_date"::STRING, 4) AS INTEGER) AS "year", COUNT(t."publication_number") AS "num_applications"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A61%'
   GROUP BY "year"
   LIMIT 100;
Answer:
year,num_applications
2007,9611
1961,64
1958,59
1956,21
1933,2
1951,14
1909,1
2004,8809
1983,589
1928,16
2013,11846
1954,34
1908,1
2001,6254
1980,292
1971,145
2022,11658
2015,17110
1921,8
1963,63
1905,1
1966,105
1989,1185
1982,514
1999,4564
1972,261
1985,662
1903,1
1960,36
1984,457
1967,54
1939,27
1940,23
1911,19
1906,3
1932,9
1987,898
2000,4596
1968,107
1941,21
1935,25
1944,17
1949,7
1991,1245
1929,14
1986,852
2011,10742
1950,35
1946,20
2014,14244
1974,349
1916,3
1992,2048
1952,22
1947,16
1931,19
1927,6
2012,10559
1923,5
1957,40
2017,26227
1899,2
1998,3760
1988,1170
1934,12
1955,45
2008,9179
1993,2357
1964,65
1937,6
2010,10356
1945,34
1994,2560
2019,22288
1962,75
2020,20867
1930,1
1920,9
1926,4
0,143
1979,396
1981,475
1997,3618
1977,366
1969,119
1938,6
2005,9092
1976,350
1970,214
1915,3
2009,10456
1995,2396
1953,28
1907,3
2016,23264
1996,3111
1975,343
1959,25
1917,1
2003,7938
Query:
SELECT t."assignee_harmonized", COUNT(t."publication_number") AS "num_applications"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A61%'
   GROUP BY t."assignee_harmonized"
   ORDER BY "num_applications" DESC
   LIMIT 100;
Answer:
Too long, hard cut:
assignee_harmonized,num_applications
[],56002
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PROCTER & GAMBLE""
  }
]",2302
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""NOVARTIS AG""
  }
]",1629
"[
  {
    ""country_code"": ""US"",
    ""name"": ""COVIDIEN LP""
  }
]",1304
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PFIZER""
  }
]",1279
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""OREAL""
  }
]",1212
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""HOFFMANN LA ROCHE""
  }
]",989
"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV CALIFORNIA""
  }
]",906
"[
  {
    ""country_code"": ""US"",
    ""name"": ""LILLY CO ELI""
  }
]",851
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BECTON DICKINSON CO""
  }
]",847
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BOEHRINGER INGELHEIM INT""
  }
]",829
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""MERCK PATENT GMBH""
  }
]",788
"[
  {
    ""country_code"": ""NL"",
    ""name"": ""KONINKLIJKE PHILIPS NV""
  }
]",784
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""ASTRAZENECA AB""
  }
]",773
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BRISTOL MYERS SQUIBB CO""
  }
]",746
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ETHICON LLC""
  }
]",700
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BOSTON SCIENT SCIMED INC""
  }
]",695
"[
  {
    ""country_code"": ""US"",
    ""name"": ""COLGATE PALMOLIVE CO""
  }
]",678
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ETHICON ENDO SURGERY INC""
  }
]",647
"[
  {
    ""country_code"": """",
    ""name"": ""PROCTER & GAMBLE""
  }
]",632
"[
  {
    ""country_code"": ""US"",
    ""name"": ""KIMBERLY CLARK CO""
  }
]",627
"[
  {
    ""country_code"": ""BE"",
    ""name"": ""JANSSEN PHARMACEUTICA NV""
  }
]",611
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GENENTECH INC""
  }
]",572
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""IMMATICS BIOTECHNOLOGIES GMBH""
  }
]",569
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""CILAG GMBH INT""
  }
]",568
"[
  {
    ""country_code"": ""US"",
    ""name"": ""AMGEN INC""
  }
]",564
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MEDTRONIC INC""
  }
]",563
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""OLYMPUS CORP""
  }
]",552
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""SANOFI AVENTIS DEUTSCHLAND""
  }
]",548
"[
  {
    ""country_code"": ""US"",
    ""name"": ""VERTEX PHARMA""
  }
]",542
"[
  {
    ""country_code"": ""NZ"",
    ""name"": ""FISHER & PAYKEL HEALTHCARE LTD""
  }
]",535
"[
  {
    ""country_code"": ""US"",
    ""name"": ""EDWARDS LIFESCIENCES CORP""
  }
]",526
"[
  {
    ""country_code"": """",
    ""name"": ""OREAL""
  }
]",525
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""SAMSUNG ELECTRONICS CO LTD""
  }
]",491
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ABBVIE INC""
  }
]",462
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ALLERGAN INC""
  }
]",447
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SMITH & NEPHEW INC""
  }
]",438
"[
  {
    ""country_code"": """",
    ""name"": ""HOFFMANN LA ROCHE""
  }
]",437
"[
  {
    ""country_code"": ""GB"",
    ""name"": ""SMITH & NEPHEW""
  }
]",419
"[
  {
    ""country_code"": ""IL"",
    ""name"": ""BIOSENSE WEBSTER ISRAEL LTD""
  }
]",417
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""TERUMO CORP""
  }
]",406
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GEN ELECTRIC""
  }
]",391
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ETHICON INC""
  }
]",389
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""MEDOS INT SARL""
  }
]",388
"[
  {
    ""country_code"": ""US"",
    ""name"": ""INCYTE CORP""
  }
]",386
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""ALCON INC""
  }
]",383
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SMITHKLINE BEECHAM CORP""
  }
]",379
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""SANOFI SA""
  }
]",363
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""SANOFI AVENTIS""
  }
]",348
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""FUJIFILM CORP""
  }
]",346
"[
  {
    ""country_code"": ""US"",
    ""name"": ""KCI LICENSING INC""
  }
]",344
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""GRUENENTHAL GMBH""
  }
]",342
"[
  {
    ""country_code"": ""US"",
    ""name"": ""DEPUY SYNTHES PRODUCTS INC""
  }
]",342
"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV LELAND STANFORD JUNIOR""
  }
]",339
"[
  {
    ""country_code"": """",
    ""name"": ""COLGATE PALMOLIVE CO""
  }
]",334
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PFIZER PROD INC""
  }
]",330
"[
  {
    ""country_code"": ""US"",
    ""name"": ""REGENERON PHARMA""
  }
]",324
"[
  {
    ""country_code"": ""PR"",
    ""name"": ""ETHICON LLC""
  }
]",322
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GILEAD SCIENCES INC""
  }
]",317
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GLOBUS MEDICAL INC""
  }
]",316
"[
  {
    ""country_code"": ""
Query:
SELECT t."assignee_harmonized", CAST(LEFT(t."filing_date"::STRING, 4) AS INTEGER) AS "year", COUNT(t."publication_number") AS "num_applications"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::STRING LIKE '%A61%'
   GROUP BY t."assignee_harmonized", "year"
   LIMIT 100;
Answer:
Too long, hard cut:
assignee_harmonized,year,num_applications
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MEDTRONIC VASCULAR INC""
  }
]",2018,89
"[
  {
    ""country_code"": ""BR"",
    ""name"": ""NATURA COSMETICOS SA""
  }
]",2017,47
"[
  {
    ""country_code"": ""LI"",
    ""name"": ""SKAJSTER FAMILIENSTIFTUNG""
  }
]",2017,20
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""APROFOL AG""
  }
]",2018,6
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SEAL SHIELD LLC""
  }
]",2020,15
[],2014,2668
"[
  {
    ""country_code"": ""US"",
    ""name"": ""COOPERVISION INC""
  }
]",1987,10
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MICROVENTION INC""
  }
]",2002,5
"[
  {
    ""country_code"": ""US"",
    ""name"": ""AMGEN INC""
  }
]",2014,10
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""HUMAN METABOLOMICS INST INC""
  }
]",2017,3
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BREEGI SCIENT INC""
  }
]",2018,10
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""KOREA RES INST CHEMICAL TECH""
  }
]",2018,20
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ETHICON LLC""
  },
  {
    ""country_code"": ""CH"",
    ""name"": ""CILAG GMBH INT""
  }
]",2020,14
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""HOECHST AG""
  }
]",1991,10
"[
  {
    ""country_code"": ""NL"",
    ""name"": ""DSM IP ASSETS BV""
  }
]",2006,51
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ARROW INT INVESTMENT""
  }
]",1994,14
"[
  {
    ""country_code"": ""US"",
    ""name"": ""WISCONSIN ALUMNI RES FOUND""
  }
]",1997,5
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""NIWA KOZO""
  }
]",1987,7
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""SCIENCE UNION & CIE""
  }
]",1976,4
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DAINIPPON PHARMACEUTICAL CO""
  }
]",1993,2
"[
  {
    ""country_code"": """",
    ""name"": ""BUNDER GLAS G M B H""
  }
]",1973,3
"[
  {
    ""country_code"": """",
    ""name"": ""FUAAN DEV LTD""
  }
]",1986,2
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""SCHUCKMANN ALFRED VON""
  }
]",2020,32
"[
  {
    ""country_code"": ""TW"",
    ""name"": ""BIONIME CORP""
  }
]",2022,15
"[
  {
    ""country_code"": ""US"",
    ""name"": ""AMO DEV LLC""
  }
]",2022,29
"[
  {
    ""country_code"": """",
    ""name"": ""SHASTRI VENKATRAM P""
  },
  {
    ""country_code"": """",
    ""name"": ""LEE PHILIP J""
  },
  {
    ""country_code"": """",
    ""name"": ""MITRAGOTRI SAMIR""
  },
  {
    ""country_code"": """",
    ""name"": ""LANGER ROBERT S""
  }
]",2003,14
"[
  {
    ""country_code"": ""US"",
    ""name"": ""Spine Thera""
  }
]",2021,25
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""FUJIFILM CORP""
  }
]",2022,6
"[
  {
    ""country_code"": ""CU"",
    ""name"": ""CT INGENIERIA GENETICA BIOTECNOLOGIA""
  }
]",2007,4
"[
  {
    ""country_code"": ""US"",
    ""name"": ""EMBOL X INC""
  }
]",1999,20
"[
  {
    ""country_code"": """",
    ""name"": ""MERCK & CO INC""
  }
]",1990,1
"[
  {
    ""country_code"": ""US"",
    ""name"": ""DEPUY PRODUCTS INC""
  }
]",2011,8
"[
  {
    ""country_code"": """",
    ""name"": ""4D PHARMA RES LTD""
  }
]",2018,92
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""CENTRE NAT RECH SCIENT""
  },
  {
    ""country_code"": ""FR"",
    ""name"": ""HEMARINA SA""
  },
  {
    ""country_code"": ""FR"",
    ""name"": ""UNIV PARIS CURIE""
  },
  {
    ""country_code"": ""FR"",
    ""name"": ""HEMARINA""
  }
]",2015,47
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MASSACHUSETTS INST TECHNOLOGY""
  }
]",2007,3
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""OREAL""
  }
]",1994,24
"[
  {
    ""country_code"": """",
    ""name"": ""XU GUO-FENG""
  },
  {
    ""country_code"": """",
    ""name"": ""XU BIN""
  }
]",2008,14
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SURROZEN OPERATING INC""
  }
]",2018,21
"[
  {
    ""country_code"": ""BE"",
    ""name"": ""JANSSEN PHARMACEUTICA NV""
  }
]",2008,71
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""FROMBIO CO LTD""
  }
]",2022,12
"[
  {
    ""country_code"": ""US"",
    ""name"": ""THE CHILDRENS HOSPITAL CORP""
  }
]",2018,12
"[
  {
    ""country_code"": ""US"",
    ""name"": ""TERUMO CARDIOVASCULAR SYS CORP""
  }
]",2020,39
"[
  {
    ""country_code"": ""US"",
    ""name"": ""JOHNSON & JOHNSON VISION CARE""
  }
]",2017,2
"[
  {
    ""country_code"": ""SE"",
    ""name"": ""BIOGAIA AB""
  }
]",2008,12
"[
  {
    ""country_code"": ""US"",
    ""name"": ""DEKA BIOSCIENCES INC""
  }
]",2023,21
"[
  {
    ""country_code"": """",
    ""name"": ""SPINE SOLUTIONS INC""
  }
]",2003,41
"[
  {
    ""country_code"": ""US"",
    ""name"": ""NIKKEN INTERNATIONAL INC""
  }
]",2012,2
"[
  {
    ""country_code"": ""IT"",
    ""name"": ""BIOINNOVA S R L S""
  },
  {
    ""country_code"": ""IT"",
    ""name"": ""NATURAMLA SRL""
  }
]",2022,2
"[
  {
    ""country_code"": ""DK"",
    ""name"": ""NOVO NORDISK AS""
  }
]",2013,40
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""SYNTHES GMB""

Query:
SELECT sub."year", MAX(sub."num_applications") AS "max_applications"
    FROM (
      SELECT t."assignee_harmonized", CAST(LEFT(t."filing_date"::STRING, 4) AS INTEGER) AS "year", COUNT(t."publication_number") AS "num_applications"
      FROM PATENTS.PATENTS.PUBLICATIONS t,
      LATERAL FLATTEN(input => t."cpc") f
      WHERE f.value::STRING LIKE '%A61%'
      GROUP BY t."assignee_harmonized", "year"
    ) sub
    WHERE sub."assignee_harmonized" = (
      SELECT t."assignee_harmonized"
      FROM PATENTS.PATENTS.PUBLICATIONS t,
      LATERAL FLATTEN(input => t."cpc") f
      WHERE f.value::STRING LIKE '%A61%'
      GROUP BY t."assignee_harmonized"
      ORDER BY COUNT(t."publication_number") DESC
      LIMIT 1
    )
    GROUP BY sub."year"
    ORDER BY "max_applications" DESC
    LIMIT 100;
Answer:
year,max_applications
2016,3648
2017,3540
2018,3284
2015,3199
2019,2798
2014,2668
2013,2638
2002,2265
2021,2258
2011,2158
2020,2133
2012,2020
2004,1934
2003,1895
2009,1894
2010,1747
2006,1562
2001,1537
2022,1420
2005,1320
2008,1301
2007,1227
2000,1000
1999,758
1998,733
2023,557
1996,522
1997,480
1994,478
1992,319
1993,314
1995,266
1991,238
1990,195
1989,183
0,137
1988,135
2024,124
1987,120
1981,95
1986,92
1979,72
1982,71
1985,66
1973,59
1974,58
1983,52
1976,43
1969,42
1980,39
1971,37
1984,31
1975,29
1977,27
1966,27
1964,26
1970,25
1978,21
1972,20
1965,16
1968,11
1967,9
1928,5
1934,4
1929,4
1963,4
1923,2
1954,2
1941,1
1936,1
1959,1
1952,1
1948,1
1949,1
1962,1
1950,1
End Exploring Related Columns
Task: In which year did the assignee with the most applications in the patent category 'A61' file the most?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Year
year:int
(Attention: answer in one row)
```

The year in which the assignee with the most applications in the patent category 'A61' filed the highest number of applications..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to active users, it refers to has engagement_time_msec parameter rather than directly counting users.

2025-01-20 18:41:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:41:10 - root - INFO - ```sql
WITH top_assignee AS (
  SELECT a.VALUE:"name"::STRING AS "assignee_name", COUNT(DISTINCT t."publication_number") AS "num_applications"
  FROM PATENTS.PATENTS.PUBLICATIONS t
  , LATERAL FLATTEN(input => t."assignee_harmonized") a
  , LATERAL FLATTEN(input => t."cpc") f
  WHERE f.VALUE:"code"::STRING LIKE 'A61%'
  GROUP BY "assignee_name"
  ORDER BY "num_applications" DESC NULLS LAST
  LIMIT 1
)
SELECT "year", "num_applications"
FROM (
  SELECT CAST(SUBSTR(t."filing_date"::STRING,1,4) AS INTEGER) AS "year", COUNT(DISTINCT t."publication_number") AS "num_applications"
  FROM PATENTS.PATENTS.PUBLICATIONS t
  , LATERAL FLATTEN(input => t."assignee_harmonized") a
  , LATERAL FLATTEN(input => t."cpc") f
  WHERE f.VALUE:"code"::STRING LIKE 'A61%'
    AND a.VALUE:"name"::STRING = (SELECT "assignee_name" FROM top_assignee)
    AND t."filing_date" IS NOT NULL AND t."filing_date" != 0
  GROUP BY "year"
  HAVING "year" != 0
)
ORDER BY "num_applications" DESC NULLS LAST
LIMIT 1;
```
2025-01-20 18:41:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:41:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:41:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:41:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 18:41:12 - snowflake.connector.connection - INFO - closed
2025-01-20 18:41:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:41:12 - root - INFO - itercount: 1
2025-01-20 18:41:12 - root - INFO - 0
2025-01-20 18:41:12 - root - INFO - results: 
year,num_applications
1997,15


2025-01-20 18:41:12 - root - INFO - Please check the answer again by reviewing In which year did the assignee with the most applications in the patent category 'A61' file the most?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Year
year:int
(Attention: answer in one row)
```

The year in which the assignee with the most applications in the patent category 'A61' filed the highest number of applications. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
year,num_applications
1997,15
Current sql:
WITH top_assignee AS (
  SELECT a.VALUE:"name"::STRING AS "assignee_name", COUNT(DISTINCT t."publication_number") AS "num_applications"
  FROM PATENTS.PATENTS.PUBLICATIONS t
  , LATERAL FLATTEN(input => t."assignee_harmonized") a
  , LATERAL FLATTEN(input => t."cpc") f
  WHERE f.VALUE:"code"::STRING LIKE 'A61%'
  GROUP BY "assignee_name"
  ORDER BY "num_applications" DESC NULLS LAST
  LIMIT 1
)
SELECT "year", "num_applications"
FROM (
  SELECT CAST(SUBSTR(t."filing_date"::STRING,1,4) AS INTEGER) AS "year", COUNT(DISTINCT t."publication_number") AS "num_applications"
  FROM PATENTS.PATENTS.PUBLICATIONS t
  , LATERAL FLATTEN(input => t."assignee_harmonized") a
  , LATERAL FLATTEN(input => t."cpc") f
  WHERE f.VALUE:"code"::STRING LIKE 'A61%'
    AND a.VALUE:"name"::STRING = (SELECT "assignee_name" FROM top_assignee)
    AND t."filing_date" IS NOT NULL AND t."filing_date" != 0
  GROUP BY "year"
  HAVING "year" != 0
)
ORDER BY "num_applications" DESC NULLS LAST
LIMIT 1;
2025-01-20 18:42:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:42:09 - root - INFO - ```sql
WITH top_assignee AS (
  SELECT a.VALUE:"name"::STRING AS "assignee_name", COUNT(DISTINCT t."publication_number") AS "num_applications"
  FROM PATENTS.PATENTS.PUBLICATIONS t
  , LATERAL FLATTEN(input => t."assignee_harmonized") a
  , LATERAL FLATTEN(input => t."cpc") f
  WHERE f.VALUE:"code"::STRING LIKE 'A61%'
    AND a.VALUE:"name"::STRING IS NOT NULL AND a.VALUE:"name"::STRING != ''
  GROUP BY "assignee_name"
  ORDER BY "num_applications" DESC NULLS LAST
  LIMIT 1
)
SELECT "year"
FROM (
  SELECT CAST(SUBSTR(t."filing_date"::STRING,1,4) AS INTEGER) AS "year", COUNT(DISTINCT t."publication_number") AS "num_applications"
  FROM PATENTS.PATENTS.PUBLICATIONS t
  , LATERAL FLATTEN(input => t."assignee_harmonized") a
  , LATERAL FLATTEN(input => t."cpc") f
  WHERE f.VALUE:"code"::STRING LIKE 'A61%'
    AND a.VALUE:"name"::STRING = (SELECT "assignee_name" FROM top_assignee)
    AND t."filing_date" IS NOT NULL AND t."filing_date" != '0'
  GROUP BY "year"
  HAVING "year" != 0
)
ORDER BY "num_applications" DESC NULLS LAST
LIMIT 1;
```
2025-01-20 18:42:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:42:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:42:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:42:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 18:42:10 - snowflake.connector.connection - INFO - closed
2025-01-20 18:42:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:42:11 - root - INFO - itercount: 2
2025-01-20 18:42:11 - root - INFO - 0
2025-01-20 18:42:11 - root - INFO - results: 
year
1997


2025-01-20 18:42:11 - root - INFO - Please check the answer again by reviewing In which year did the assignee with the most applications in the patent category 'A61' file the most?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Year
year:int
(Attention: answer in one row)
```

The year in which the assignee with the most applications in the patent category 'A61' filed the highest number of applications. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
year
1997
Current sql:
WITH top_assignee AS (
  SELECT a.VALUE:"name"::STRING AS "assignee_name", COUNT(DISTINCT t."publication_number") AS "num_applications"
  FROM PATENTS.PATENTS.PUBLICATIONS t
  , LATERAL FLATTEN(input => t."assignee_harmonized") a
  , LATERAL FLATTEN(input => t."cpc") f
  WHERE f.VALUE:"code"::STRING LIKE 'A61%'
    AND a.VALUE:"name"::STRING IS NOT NULL AND a.VALUE:"name"::STRING != ''
  GROUP BY "assignee_name"
  ORDER BY "num_applications" DESC NULLS LAST
  LIMIT 1
)
SELECT "year"
FROM (
  SELECT CAST(SUBSTR(t."filing_date"::STRING,1,4) AS INTEGER) AS "year", COUNT(DISTINCT t."publication_number") AS "num_applications"
  FROM PATENTS.PATENTS.PUBLICATIONS t
  , LATERAL FLATTEN(input => t."assignee_harmonized") a
  , LATERAL FLATTEN(input => t."cpc") f
  WHERE f.VALUE:"code"::STRING LIKE 'A61%'
    AND a.VALUE:"name"::STRING = (SELECT "assignee_name" FROM top_assignee)
    AND t."filing_date" IS NOT NULL AND t."filing_date" != '0'
  GROUP BY "year"
  HAVING "year" != 0
)
ORDER BY "num_applications" DESC NULLS LAST
LIMIT 1;
2025-01-20 18:42:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 18:42:56 - root - INFO - ```sql
WITH top_assignee AS (
  SELECT a.VALUE:"name"::STRING AS "assignee_name", COUNT(DISTINCT t."publication_number") AS "num_applications"
  FROM PATENTS.PATENTS.PUBLICATIONS t
  , LATERAL FLATTEN(input => t."assignee_harmonized") a
  , LATERAL FLATTEN(input => t."cpc") f
  WHERE f.VALUE:"code"::STRING LIKE 'A61%'
    AND a.VALUE:"name"::STRING IS NOT NULL AND a.VALUE:"name"::STRING != ''
  GROUP BY "assignee_name"
  ORDER BY "num_applications" DESC NULLS LAST
  LIMIT 1
)
SELECT "year"
FROM (
  SELECT CAST(SUBSTR(t."filing_date"::STRING,1,4) AS INTEGER) AS "year", COUNT(DISTINCT t."publication_number") AS "num_applications"
  FROM PATENTS.PATENTS.PUBLICATIONS t
  , LATERAL FLATTEN(input => t."assignee_harmonized") a
  , LATERAL FLATTEN(input => t."cpc") f
  WHERE f.VALUE:"code"::STRING LIKE 'A61%'
    AND a.VALUE:"name"::STRING = (SELECT "assignee_name" FROM top_assignee)
    AND t."filing_date" IS NOT NULL AND t."filing_date" != '0'
  GROUP BY "year"
  HAVING "year" != 0
)
ORDER BY "num_applications" DESC NULLS LAST
LIMIT 1;
```
2025-01-20 18:42:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 18:42:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 18:42:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 18:42:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 18:42:58 - snowflake.connector.connection - INFO - closed
2025-01-20 18:42:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 18:42:58 - root - INFO - itercount: 3
2025-01-20 18:42:58 - root - INFO - 0
2025-01-20 18:42:58 - root - INFO - Total iteration counts: 3
