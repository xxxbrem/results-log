2025-01-20 00:35:07 - openai._base_client - INFO - Retrying request to /chat/completions in 0.452074 seconds
2025-01-20 00:36:31 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 00:36:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:36:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:36:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:36:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 384
2025-01-20 00:36:33 - snowflake.connector.connection - INFO - closed
2025-01-20 00:36:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:36:34 - root - INFO - SQL:
SELECT "OrderID", "Sides"
   FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
   LIMIT 1000;
Results:
Too long, hard cut:
OrderID,Sides
d8eefa63-6f10-4566-8f15-81460448f2ac,"[
  {
    ""OrderID"": ""d8eefa63-6f10-4566-8f15-81460448f2ac"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
7fa78bef-912c-41cb-b381-4c03b5a7c508,"[
  {
    ""OrderID"": ""7fa78bef-912c-41cb-b381-4c03b5a7c508"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
5a4c4d8b-b9b8-4307-a0c3-8c753ed93520,"[
  {
    ""OrderID"": ""5a4c4d8b-b9b8-4307-a0c3-8c753ed93520"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
a204ef77-1071-48ee-a5f5-21579311cd91,"[
  {
    ""OrderID"": ""a204ef77-1071-48ee-a5f5-21579311cd91"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
b7a40778-7293-407b-8636-91a7ffe9817a,"[
  {
    ""OrderID"": ""b7a40778-7293-407b-8636-91a7ffe9817a"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
c67a3f6a-7253-4ec8-91be-a4a3f07aa27b,"[
  {
    ""OrderID"": ""c67a3f6a-7253-4ec8-91be-a4a3f07aa27b"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
83e09901-1182-4ad0-b423-0f92bf78a7a2,"[
  {
    ""OrderID"": ""83e09901-1182-4ad0-b423-0f92bf78a7a2"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
8161e8ff-9aa3-4e27-9322-363a4a063a27,"[
  {
    ""OrderID"": ""8161e8ff-9aa3-4e27-9322-363a4a063a27"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
2e2c0922-e696-44f6-899e-9112f6129088,"[
  {
    ""OrderID"": ""2e2c0922-e696-44f6-899e-9112f6129088"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
8afcaa49-daca-470f-9479-6bfd2c648ccf,"[
  {
    ""OrderID"": ""8afcaa49-daca-470f-9479-6bfd2c648ccf"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
4e25aae7-5b30-408a-a23e-ea3afb86c445,"[
  {
    ""OrderID"": ""4e25aae7-5b30-408a-a23e-ea3afb86c445"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
048dab46-3718-4dd2-b12e-709ce317c069,"[
  {
    ""OrderID"": ""048dab46-3718-4dd2-b12e-709ce317c069"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
0e00e452-329b-44df-90a5-902b7e737608,"[
  {
    ""OrderID"": ""0e00e452-329b-44df-90a5-902b7e737608"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
ae17c30f-0689-4013-8485-05f5eb5f7721,"[
  {
    ""OrderID"": ""ae17c30f-0689-4013-8485-05f5eb5f7721"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
3a9010bf-80a3-46aa-ae04-afd4b1f39e1a,"[
  {
    ""OrderID"": ""3a9010bf-80a3-46aa-ae04-afd4b1f39e1a"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
5880746a-b864-46b5-8204-060bbe7104a4,"[
  {
    ""OrderID"": ""5880746a-b864-46b5-8204-060bbe7104a4"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
68bf4c18-8084-435b-8786-2ae9b104339e,"[
  {
    ""OrderID"": ""68bf4c18-8084-435b-8786-2ae9b104339e"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""

2025-01-20 00:36:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:36:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:36:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:36:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 425
2025-01-20 00:36:36 - snowflake.connector.connection - INFO - closed
2025-01-20 00:36:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:36:37 - root - INFO - SQL:
SELECT "OrderID", f.value
   FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
        LATERAL FLATTEN(input => t."Sides") f
   LIMIT 1000;
Results:
Too long, hard cut:
OrderID,VALUE
d8eefa63-6f10-4566-8f15-81460448f2ac,"{
  ""OrderID"": ""d8eefa63-6f10-4566-8f15-81460448f2ac"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
7fa78bef-912c-41cb-b381-4c03b5a7c508,"{
  ""OrderID"": ""7fa78bef-912c-41cb-b381-4c03b5a7c508"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
5a4c4d8b-b9b8-4307-a0c3-8c753ed93520,"{
  ""OrderID"": ""5a4c4d8b-b9b8-4307-a0c3-8c753ed93520"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
a204ef77-1071-48ee-a5f5-21579311cd91,"{
  ""OrderID"": ""a204ef77-1071-48ee-a5f5-21579311cd91"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
b7a40778-7293-407b-8636-91a7ffe9817a,"{
  ""OrderID"": ""b7a40778-7293-407b-8636-91a7ffe9817a"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
c67a3f6a-7253-4ec8-91be-a4a3f07aa27b,"{
  ""OrderID"": ""c67a3f6a-7253-4ec8-91be-a4a3f07aa27b"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
83e09901-1182-4ad0-b423-0f92bf78a7a2,"{
  ""OrderID"": ""83e09901-1182-4ad0-b423-0f92bf78a7a2"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
8161e8ff-9aa3-4e27-9322-363a4a063a27,"{
  ""OrderID"": ""8161e8ff-9aa3-4e27-9322-363a4a063a27"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
2e2c0922-e696-44f6-899e-9112f6129088,"{
  ""OrderID"": ""2e2c0922-e696-44f6-899e-9112f6129088"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
8afcaa49-daca-470f-9479-6bfd2c648ccf,"{
  ""OrderID"": ""8afcaa49-daca-470f-9479-6bfd2c648ccf"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
4e25aae7-5b30-408a-a23e-ea3afb86c445,"{
  ""OrderID"": ""4e25aae7-5b30-408a-a23e-ea3afb86c445"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
048dab46-3718-4dd2-b12e-709ce317c069,"{
  ""OrderID"": ""048dab46-3718-4dd2-b12e-709ce317c069"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
0e00e452-329b-44df-90a5-902b7e737608,"{
  ""OrderID"": ""0e00e452-329b-44df-90a5-902b7e737608"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
ae17c30f-0689-4013-8485-05f5eb5f7721,"{
  ""OrderID"": ""ae17c30f-0689-4013-8485-05f5eb5f7721"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
3a9010bf-80a3-46aa-ae04-afd4b1f39e1a,"{
  ""OrderID"": ""3a9010bf-80a3-46aa-ae04-afd4b1f39e1a"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
5880746a-b864-46b5-8204-060bbe7104a4,"{
  ""OrderID"": ""5880746a-b864-46b5-8204-060bbe7104a4"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
68bf4c18-8084-435b-8786-2ae9b104339e,"{
  ""OrderID"": ""68bf4c18-8084-435b-8786-2ae9b104339e"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
0fe87fac-d58a-4bb9-8552-c1e58d91bb82,"{
  ""OrderID"": ""0fe87fac-d58a-4bb9-8552-c1e58d91bb82"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
94641ac8-057f-4f66-ba2f-81edc252bbcf,"{
  ""OrderID"": ""94641ac8-057f-4f66-ba2f-81edc252bbcf"",
  ""PartyIDs"": [
    {
     

2025-01-20 00:36:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:36:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:36:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:36:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 00:36:38 - snowflake.connector.connection - INFO - closed
2025-01-20 00:36:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:36:38 - root - INFO - SQL:
SELECT f.value:"Side"::STRING AS "Side"
   FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
        LATERAL FLATTEN(input => t."Sides") f
   LIMIT 1000;
Results:
Too long, hard cut:
Side
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHO

2025-01-20 00:36:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:36:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:36:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:36:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 00:36:40 - snowflake.connector.connection - INFO - closed
2025-01-20 00:36:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:37:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 00:37:29 - root - INFO - ```sql
SELECT
  pid.value:"PartyID"::STRING AS "Strategy",
  AVG(t."LastPx" - t."StrikePrice") AS "AvgIntrinsicValue"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") pid
WHERE f.value:"Side"::STRING = 'LONG'
  AND pid.value:"PartyRole"::STRING = 'INITIATING TRADER'
  AND pid.value:"PartyIDSource"::STRING = 'PROP CODE'
  AND pid.value:"PartyID" IN ('MOMOES', 'FEELLUCKY')
GROUP BY pid.value:"PartyID"::STRING;
```
2025-01-20 00:37:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:37:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:37:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:37:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 00:37:30 - snowflake.connector.connection - INFO - closed
2025-01-20 00:37:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:39:26 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 00:39:26 - root - INFO - SQL:
SELECT
  pid.value:"PartyID"::STRING AS "Strategy",
  AVG(t."LastPx" - t."StrikePrice") AS "AvgIntrinsicValue"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") pid
WHERE f.value:"Side"::STRING = 'LONG'
  AND pid.value:"PartyRole"::STRING = 'INITIATING TRADER'
  AND pid.value:"PartyIDSource"::STRING = 'PROP CODE'
  AND pid.value:"PartyID" IN ('MOMOES', 'FEELLUCKY')
GROUP BY pid.value:"PartyID"::STRING;
Results:
Strategy,AvgIntrinsicValue
MOMOES,-0.005202354927083043

2025-01-20 00:39:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:39:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:39:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:39:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 00:39:28 - snowflake.connector.connection - INFO - closed
2025-01-20 00:39:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:39:28 - root - INFO - SQL:
SELECT t."LastPx" - t."StrikePrice" AS "IntrinsicValue"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t
LIMIT 1000
Results:
Too long, hard cut:
IntrinsicValue
0.0
0.0
0.75
-0.5
1.25
0.75
1.5
0.25
0.5
0.5
1.5
-0.5
1.5
-1.0
-1.0
0.0
0.0
-0.75
-0.75
-1.5
-1.0
0.75
0.0
0.5
0.75
-0.5
0.0
0.5
0.0
-0.5
0.25
-0.25
-1.0
-0.25
-0.75
0.5
0.5
-0.5
-1.25
-2.25
-0.25
-0.5
0.0
-0.75
2.25
0.25
-0.75
0.75
-0.75
0.75
-0.75
1.25
0.0
-0.75
0.0
1.0
-0.625
0.5
0.0
-0.75
0.75
-2.0
0.25
-1.0
1.25
0.0
-0.25
-0.75
0.25
0.0
-0.25
0.375
1.0
0.0
-0.75
0.25
-1.25
-1.875
1.0
-3.25
0.25
0.25
1.0
-3.25
-0.75
5.625
0.25
-0.25
0.0
-0.5
0.125
-2.5
1.0
2.0
0.0
-0.25
-0.5
0.0
2.5
1.5
-0.25
-0.75
-0.25
0.25
-0.25
-0.25
-0.25
0.375
0.625
-0.75
-0.25
-1.25
-1.0
0.5
0.0
0.0
-1.0
2.25
-4.75
1.0
-1.0
-0.5
0.5
-1.75
-0.25
-0.5
0.5
-0.5
1.0
0.25
2.25
1.25
0.75
2.0
-0.25
-0.25
-1.25
-0.5
1.25
-0.25
-0.25
-0.5
-0.5
0.5
0.75
-1.25
-0.25
0.0
0.0
0.0
0.0
0.0
-0.25
-1.0
0.5
-1.0
-1.75
0.0
0.25
-0.25
-0.25
0.0
0.75
0.125
-1.625
0.25
1.25
-0.5
0.25
1.5
0.25
-0.25
0.0
0.5
-0.25
0.5
0.25
-0.25
-0.25
-0.25
-2.5
-0.25
0.5
0.375
0.25
-0.5
-0.5
-0.75
0.125
0.125
-0.25
-0.25
-0.125
0.5
-0.25
0.25
0.25
0.25
-0.25
-0.75
0.0
0.25
-0.5
-0.25
0.875
-0.5
0.25
-2.5
-0.25
-0.25
0.5
1.625
-5.25
0.0
2.0
2.25
-1.0
-2.25
1.625
1.0
0.5
1.25
1.5
1.5
0.5
-0.5
-1.0
0.75
0.75
-0.125
1.0
0.25
0.75
0.125
-0.625
-0.25
0.0
0.25
0.5
0.5
0.5
0.0
-0.75
-0.25
-1.75
0.0
-0.5
1.25
0.25
-0.25
-3.5
0.25
0.25
-0.5
-2.5
1.25
1.25
-0.75
-0.25
0.25
0.0
-1.25
0.25
1.0
-1.0
-0.75
0.5
0.25
0.25
-0.25
0.25
-0.5
0.75
1.0
0.0
0.25
-0.75
2.25
0.25
-0.75
0.0
0.75
0.25
-2.5
-0.75
-0.25
0.0
0.0
0.5
-0.5
2.0
0.25
0.375
-0.125
1.25
0.0
0.0
0.0
-0.5
-0.25
0.25
0.0
0.5
-0.25
0.25
0.0
0.75
0.5
1.5
0.75
0.75
0.25
-0.5
0.0
-0.25
0.25
0.5
-0.75
0.25
-1.0
-0.25
-0.125
0.0
-0.25
-0.625
0.25
1.0
-0.75
0.25
-1.0
1.0
-0.25
0.375
-0.375
0.0
0.5
-0.25
0.25
-1.5
0.0
-1.25
-0.5
0.25
1.0
0.25
0.0
1.5
0.5
0.25
-0.75
0.625
0.125
1.75
0.125
1.25
-2.125
0.75
0.0
0.25
-2.25
0.0
0.5
-0.25
0.0
-0.25
0.25
0.5
0.25
-0.75
-1.25
0.75
-1.0
0.5
0.75
0.25
-0.125
-2.75
-0.25
0.0
-0.25
-0.25
0.0
-1.75
-0.75
-1.25
-0.75
-1.0
-2.0
0.25
2.5
1.0
1.75
0.75
-2.0
-2.0
1.75
-2.5
1.0
-0.75
0.75
1.5
1.0
-2.25
-0.5
1.0
0.25
-0.5
0.25
0.75
-0.75
0.75
-2.25
2.75
0.375
-1.0
-0.75
1.0
0.75
0.0
0.0
0.5
0.5
-1.625
0.25
-2.125
0.125
-0.875
1.0
-0.125
-0.25
-0.125
0.75
-1.125
-0.25
0.0
0.5
1.0
0.0
0.75
0.375
2.0
-0.5
0.0
0.5
-0.375
-1.5
-0.5
-0.25
-0.75
0.25
0.0
0.375
1.0
0.25
0.75
1.0
-0.25
-0.25
0.0
0.5
0.0
-0.75
0.5
-0.25
-0.25
0.25
-0.5
-0.75
-0.25
-2.25
0.0
-1.0
0.125
0.875
-0.25
-0.5
-0.125
0.25
1.0
-1.625
-0.5
-0.875
-0.75
-0.375
1.5
1.25
-0.375
0.0
-0.5
0.75
-0.5
-1.5
-0.5
0.25
0.5
-1.125
-2.5
-1.0
0.0
2.0
-3.0
-4.0
0.25
0.0
-0.25
0.25
-0.25
1.0
1.0
-2.0
-0.25
-0.75
1.0
1.5
0.5
-0.25
-0.75
1.0
-0.25
-0.25
-0.5
-0.25
1.75
-1.25
-0.5
0.75
-0.5
0.375
0.75
0.5
0.75
1.25
1.0
0.25
-1.0
-0.5
0.5
2.0
-0.25
-0.25
1.0
-0.75
-1.0
-1.75
-0.75
0.0
0.25
0.5
-0.5
0.5
-1.25
-0.75
0.25
0.75
-0.25
-0.25
0.25
-0.75
-0.5
1.0
2.25
-2.0
0.5
0.0
0.5
-0.625
0.75
-1.375
0.5
-0.25
0.5
0.125
0.25
-0.5
-1.0
0.0
-0.75
0.5
-0.5
2.0
0.5
0.0
0.25
-0.25
1.75
-0.5
0.0
-0.25
-1.5
0.5
0.0
1.25
0.25
-0.25
0.5
0.25
-0.25
0.0
-0.25
0.0
0.25
0.125
0.0
-0.5
0.125
-0.5
-0.5
0.25
-0.125
0.25
0.0
0.25
0.0
-0.5
-0.75
-0.25
-0.25
0.25
0.375
-0.25
-0.25
-0.125
0.0
0.0
-0.125
0.0
-0.625
-0.25
-0.5
0.125
-0.875
1.625
1.0
0.25
0.375
-0.25
1.375
2.0
-0.5
0.0
-0.375
0.5
0.0
-0.125
-0.5
0.5
0.5
0.25
-0.375
0.75
0.0
-0.25
0.0
0.5
-0.5
0.25
-0.25
0.0
0.0
0.0
0.0
-0.5
-0.25
0.25
0.0
0.0
0.0
0.25
0.75
0.25
0.25
0.0
-0.25
0.25
0.0
-0.25
0.25
0.0
0.0
0.0
1.0
-0.5
0.0
0.125
0.25
0.0
0.0
0.25
-0.25
-0.125
-0.375
0.125
-0.5
0.0
-0.125
-0.75
0.75
0.875
-1.5
-1.0
0.0
-0.25
-0.5
0.5
-0.25
1.375
0.0
-0.25
-0.125
-0.25
0.0
0.25
-0.5
-0.125
0.25
-0.25
0.25
0.125
-0.125
-0.5
-0.5
1.5
-0.25
2.0
0.25
-0.125
0.25
0.25
0.0
0.75
-0.75
-0.25
0.75
-0.5
0.75
-1.25
-1.25
1.25
-0.5
-1.5
1.0
-0.25
1.125
0.75
-1.0
0.0
0.0
-0.5
1.0
0.375
0.25
0.0
-0.25
1.0
-0.75
-1.0
-0.5
0.25
0.0
-0.25
0.25
-1.0
-1.0
-0.75
-0.25
0.0
-0.75
-1.0
0.25
0.0
-0.75
0.0
-0.75
1.25
0.0
-0.5
-0.25
0.75
-0.75
-0.75
-0.5
-1.0
0.75
-0.75
2.25
0.25
0.25
0.25
-0.5
0.5
0.5
0.25
0.5
0.25
0.0
-0.75
-2.0
1.5
0.75
0.5
0.5
-0.75
-1.75
0.25
-2.0
0.75
-0.75
0.0
-0.125
-0.25
-0.25
0.0
-0.25
0.5
0.0
0.0
0.0
0.5
0.375
0.5
0.5
-0.125
-1.25
0.125
-0.5
-0.875
0.75
1.75
0.0
0.75
-0.75
0.25
0.0
-0.5
-0.5
0.5
0.0
0.25
-0.25
0.25
-0.25
0.5
0.5
0.75
-1.5
-0.375
0.0
0.125
-0.25
-0.5
0.0
0.25
0.25
0.125
-0.25
0.5
0.5
-1.25
-1.0
-0.5
0.0
-0.625
1.25
0.0
-2.5
0.25
-0.5
-1.5
1.0
0.0
0.0
1.0
0.5
2.25
-1.0
0.75
0.75
0.5
-0.75
-0.5
-1.0
-0.25
0.0
2.75
0.0
-1.0
0.0
0.0
0.5
0.5
3.0
-1.0
0.0
-0.5
0.0
-0.25
0.0
0.25
-1.75
0.75
1.0
0.25
-1.0
0.5
1.25
0.25
1.0
-1.75
1.25
-1.0
4.25
-1.0
0.5
0.25
0.75
-1.25
0.75
-1.0
0.25
0.75
1.0
-0.5
0.0
0.0
-1.5
0.0
-0.5
3.0
-3.75
-0.25
0.0
-0.875
0.5
0.0
-0.5
-0.25
0.0
-0.75
0.75
0.5
-0.25
-0.25
-1.25
0.25
0.25
0.0
-1.25
-0.25
0.25
0.0
0.5
-0.25
-0.25
0.5
0.5
-1.875
-0.5
0.0
-0.125
0.75
0.0
-0.75
0.5
-1.0
-0.25
-0.5
-0.625
0.25
-0.5
-0.25
-0.125
0.125
0.375
-0.5
0.75
0.75
-1.5
1.375
0.5
-0.25
-0.25
2.2

2025-01-20 00:39:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:39:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:39:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:39:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 00:39:29 - snowflake.connector.connection - INFO - closed
2025-01-20 00:39:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:39:30 - root - INFO - SQL:
SELECT
    t."TradeDate",
    pid.value:"PartyID"::STRING AS "Strategy",
    t."LastPx" - t."StrikePrice" AS "IntrinsicValue"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") pid
WHERE f.value:"Side"::STRING ILIKE '%LONG%'
  AND pid.value:"PartyRole"::STRING = 'INITIATING TRADER'
  AND pid.value:"PartyIDSource"::STRING = 'PROP CODE'
LIMIT 1000
Results:
Too long, hard cut:
TradeDate,Strategy,IntrinsicValue
2020-05-18,MOMOES,0.0
2020-05-18,MOMOES,0.0
2020-05-18,MOMOES,0.75
2020-05-18,MOMOES,-0.5
2020-05-18,MOMOES,1.25
2020-05-18,MOMOES,0.75
2020-05-18,MOMOES,1.5
2020-05-18,MOMOES,0.25
2020-05-18,MOMOES,0.5
2020-05-18,MOMOES,0.5
2020-05-18,MOMOES,1.5
2020-05-18,MOMOES,-0.5
2020-05-18,MOMOES,1.5
2020-05-18,MOMOES,-1.0
2020-05-18,MOMOES,-1.0
2020-05-18,MOMOES,0.0
2020-05-18,MOMOES,0.0
2020-05-18,MOMOES,-0.75
2020-05-18,MOMOES,-0.75
2020-05-18,MOMOES,-1.5
2020-05-18,MOMOES,-1.0
2020-05-18,MOMOES,0.75
2020-05-18,MOMOES,0.0
2020-05-18,MOMOES,0.5
2020-05-18,MOMOES,0.75
2020-05-18,MOMOES,-0.5
2020-05-18,MOMOES,0.0
2020-05-18,MOMOES,0.5
2020-05-18,MOMOES,0.0
2020-05-18,MOMOES,-0.5
2020-05-18,MOMOES,0.25
2020-05-18,MOMOES,-0.25
2020-05-18,MOMOES,-1.0
2020-05-18,MOMOES,-0.25
2020-05-19,MOMOES,-0.75
2020-05-19,MOMOES,0.5
2020-05-19,MOMOES,0.5
2020-05-19,MOMOES,-0.5
2020-05-19,MOMOES,-1.25
2020-05-19,MOMOES,-2.25
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-0.5
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,-0.75
2020-05-19,MOMOES,2.25
2020-05-19,MOMOES,0.25
2020-05-19,MOMOES,-0.75
2020-05-19,MOMOES,0.75
2020-05-19,MOMOES,-0.75
2020-05-19,MOMOES,0.75
2020-05-19,MOMOES,-0.75
2020-05-19,MOMOES,1.25
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,-0.75
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,1.0
2020-05-19,MOMOES,-0.625
2020-05-19,MOMOES,0.5
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,-0.75
2020-05-19,MOMOES,0.75
2020-05-19,MOMOES,-2.0
2020-05-19,MOMOES,0.25
2020-05-19,MOMOES,-1.0
2020-05-19,MOMOES,1.25
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-0.75
2020-05-19,MOMOES,0.25
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,0.375
2020-05-19,MOMOES,1.0
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,-0.75
2020-05-19,MOMOES,0.25
2020-05-19,MOMOES,-1.25
2020-05-19,MOMOES,-1.875
2020-05-19,MOMOES,1.0
2020-05-19,MOMOES,-3.25
2020-05-19,MOMOES,0.25
2020-05-19,MOMOES,0.25
2020-05-19,MOMOES,1.0
2020-05-19,MOMOES,-3.25
2020-05-19,MOMOES,-0.75
2020-05-19,MOMOES,5.625
2020-05-19,MOMOES,0.25
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,-0.5
2020-05-19,MOMOES,0.125
2020-05-19,MOMOES,-2.5
2020-05-19,MOMOES,1.0
2020-05-19,MOMOES,2.0
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-0.5
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,2.5
2020-05-19,MOMOES,1.5
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-0.75
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,0.25
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,0.375
2020-05-19,MOMOES,0.625
2020-05-19,MOMOES,-0.75
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-1.25
2020-05-19,MOMOES,-1.0
2020-05-19,MOMOES,0.5
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,-1.0
2020-05-19,MOMOES,2.25
2020-05-19,MOMOES,-4.75
2020-05-19,MOMOES,1.0
2020-05-19,MOMOES,-1.0
2020-05-19,MOMOES,-0.5
2020-05-19,MOMOES,0.5
2020-05-19,MOMOES,-1.75
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-0.5
2020-05-19,MOMOES,0.5
2020-05-19,MOMOES,-0.5
2020-05-19,MOMOES,1.0
2020-05-19,MOMOES,0.25
2020-05-19,MOMOES,2.25
2020-05-19,MOMOES,1.25
2020-05-19,MOMOES,0.75
2020-05-19,MOMOES,2.0
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-1.25
2020-05-19,MOMOES,-0.5
2020-05-19,MOMOES,1.25
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-0.5
2020-05-19,MOMOES,-0.5
2020-05-19,MOMOES,0.5
2020-05-19,MOMOES,0.75
2020-05-19,MOMOES,-1.25
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-1.0
2020-05-19,MOMOES,0.5
2020-05-19,MOMOES,-1.0
2020-05-19,MOMOES,-1.75
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,0.25
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,0.75
2020-05-19,MOMOES,0.125
2020-05-19,MOMOES,-1.625
2020-05-19,MOMOES,0.25
2020-05-20,MOMOES,1.25
2020-05-20,MOMOES,-0.5
2020-05-20,MOMOES,0.25
2020-05-20,MOMOES,1.5
2020-05-20,MOMOES,0.25
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,0.0
2020-05-20,MOMOES,0.5
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,0.5
2020-05-20,MOMOES,0.25
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,-2.5
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,0.5
2020-05-20,MOMOES,0.375
2020-05-20,MOMOES,0.25
2020-05-20,MOMOES,-0.5
2020-05-20,MOMOES,-0.5
2020-05-20,MOMOES,-0.75
2020-05-20,MOMOES,0.125
2020-05-20,MOMOES,0.125
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,-0.125
2020-05-20,MOMOES,0.5
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,0.25
2020-05-20,MOMOES,0.25
2020-05-20,MOMOES,0.25
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,-0.75
2020-05-20,MOMOES,0.0
2020-05-20,MOMOES,0.25
2020-05-20,MOMOES,-0.5
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,0.875
2020-05-20,MOMOES,-0.5
2020-05-20,MOMOES,0.25
2020-05-20,MOMOES,-2.5
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,0.5
2020-05-20,MOMOES,1.625
2020-05-20,MOMOES,-5.25
2020-05-20,MOMOES,0.0
2020-05-20,MOMOES,2.0
2

2025-01-20 00:39:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:39:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:39:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:39:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 13
2025-01-20 00:39:31 - snowflake.connector.connection - INFO - closed
2025-01-20 00:39:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:39:32 - root - INFO - SQL:
SELECT "Symbol", COUNT(*) AS "TradeCount"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
GROUP BY "Symbol"
LIMIT 1000
Results:
Symbol,TradeCount
ESZ0,147993
BTCK0,24818
NQZ0,156552
ESU0,191463
BTCN0,60765
BTCU0,62066
NQU0,207415
BTCQ0,61347
NQM0,80200
BTCV0,69689
BTCZ0,56424
ESM0,65423
BTCM0,38407

2025-01-20 00:39:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:39:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:39:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:39:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-20 00:39:33 - snowflake.connector.connection - INFO - closed
2025-01-20 00:39:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:39:34 - root - INFO - SQL:
SELECT f.value:"Side"::STRING AS "Side", COUNT(*) AS "Count"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") f
GROUP BY f.value:"Side"::STRING
LIMIT 1000
Results:
Side,Count
SHORT,443312
LONG,779250

2025-01-20 00:39:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:39:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:39:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:39:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 00:39:35 - snowflake.connector.connection - INFO - closed
2025-01-20 00:39:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:40:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 00:40:38 - root - INFO - ```sql
SELECT
    pid.value:"PartyID"::STRING AS "Strategy",
    AVG(t."LastPx" - t."StrikePrice") AS "AvgIntrinsicValue"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") pid
WHERE f.value:"Side"::STRING = 'LONG'
GROUP BY pid.value:"PartyID"::STRING;
```
2025-01-20 00:40:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:40:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:40:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:40:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 9
2025-01-20 00:40:40 - snowflake.connector.connection - INFO - closed
2025-01-20 00:40:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:42:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 00:42:05 - root - INFO - SQL:
SELECT
    pid.value:"PartyID"::STRING AS "Strategy",
    AVG(t."LastPx" - t."StrikePrice") AS "AvgIntrinsicValue"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") pid
WHERE f.value:"Side"::STRING = 'LONG'
GROUP BY pid.value:"PartyID"::STRING;
Results:
Strategy,AvgIntrinsicValue
LUCKYBTC,0.016179263197873148
PREDICTES,-0.0018594337724254291
LUCKYES,-0.006717415681876995
MOMOBTC,0.09964695498676081
MOMONQ,0.004894004137160459
PREDICTBTC,-0.0187683284457478
MOMOES,-0.005202354927083043
LUCKYNQ,-0.021882035708675848
PREDICTNQ,-0.40202702702702703

2025-01-20 00:42:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:42:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:42:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:42:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 00:42:07 - snowflake.connector.connection - INFO - closed
2025-01-20 00:42:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:42:07 - root - INFO - SQL:
SELECT
    AVG(t."LastPx" - t."StrikePrice") AS "AverageIntrinsicValue"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t
LIMIT 1000
Results:
AverageIntrinsicValue
-0.010741884665153996

2025-01-20 00:42:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:42:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:42:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:42:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 00:42:09 - snowflake.connector.connection - INFO - closed
2025-01-20 00:42:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:42:09 - root - INFO - SQL:
SELECT
    t."OrderID",
    f.value:"Side"::STRING AS "Side",
    t."LastPx" - t."StrikePrice" AS "IntrinsicValue"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") f
WHERE f.value:"Side"::STRING = 'LONG'
LIMIT 1000
Results:
Too long, hard cut:
OrderID,Side,IntrinsicValue
9b714e1a-f0af-4bf5-a9b2-e347a1684570,LONG,2.25
28150993-e066-46a4-8fdb-335cbe22faf0,LONG,-0.5
01feee11-69d1-4a2e-b36a-9ebba87736e6,LONG,-1.75
48fe371f-f591-4840-8e9c-6d9f5891ac11,LONG,0.0
840efeb4-19b9-4bcd-9f49-39b5860a4839,LONG,0.0
c0e59831-9d93-4e84-8225-ae9f69bd372c,LONG,-0.5
45754918-2d7a-4d3c-a2e1-e576408a3b6d,LONG,0.0
0bb20482-2074-4d0c-8a8e-bd8036e71f5f,LONG,-0.25
c8fba02e-cc8b-4dad-ab13-511fb6410e8c,LONG,2.25
516dd0f6-3aa7-4f2e-b139-c31b68be6502,LONG,0.75
dfe79093-86f2-4c3f-b80d-8d12cfe90ccc,LONG,0.25
b246a020-d478-45e4-902a-7e49b9d6435f,LONG,-0.25
eb6923c0-49f9-49e1-bf41-d294f6cf4663,LONG,0.75
e0d857f6-fdb3-41a5-a852-b028f3b33715,LONG,-0.75
6d36cc04-f932-4082-b172-909cef2778d6,LONG,-0.25
13f84ec0-2541-49d4-bc0f-cda7e100b262,LONG,0.0
084b933c-0e83-4ab9-b197-dc46a8947dc2,LONG,-0.25
2e8b9e61-ec83-4bbe-b58b-b7cfbb842926,LONG,-0.5
dea5784b-c9c4-4456-9c97-5def6d979b2b,LONG,-0.25
74c822dd-a4e0-4758-812f-0f99cf7ae2f4,LONG,-0.5
5d3df63d-4bf8-4acb-8084-7296ed57d820,LONG,0.5
a02f81df-7983-49ba-a0ca-e78314e01a45,LONG,0.25
3ee25339-a105-4be0-bf81-a8cd27010c25,LONG,-1.0
5ef10390-0f9e-4a87-9447-80a5297f02c4,LONG,0.5
115cc308-4003-4734-82d2-bda11de04ac7,LONG,0.5
3c48b3f0-b341-4dfa-a26f-20d40dcdc1b4,LONG,0.25
ced9e10e-2f1a-46be-a987-2e4edbe1e2fa,LONG,0.25
cf8a7898-bb04-4127-89a5-5db5433f06b5,LONG,0.25
b793d3d3-42f0-44de-8f60-4a049d0ad454,LONG,-0.75
70e53ae5-387a-4168-8e13-5ca14ba7055c,LONG,-0.25
94d3fee1-9df7-4161-8e33-afb26f43ba84,LONG,0.875
e7ad788f-2eca-4252-8f89-f572e24ed65b,LONG,0.25
a77247c9-0aa3-4aa3-b736-74d15ee17756,LONG,-0.75
48666f41-3507-456b-a9bd-d942dd92cd7f,LONG,-0.5
da34e1e6-a5c2-4e6b-bba1-4bc5e136a2cc,LONG,-0.25
071efa5e-1513-4873-b831-1db5e2c131db,LONG,0.875
09028b79-66a7-415e-91b1-b1721a7ce8a4,LONG,3.0
d94098c0-c8dd-46f7-89ae-510850771bdd,LONG,1.75
ed4dff23-961a-4a51-89b0-0009b25af117,LONG,-0.25
a8de7074-5d45-43ce-a804-9117b86a70fa,LONG,0.25
6861cc17-3163-4149-941c-f035ff8fd8ef,LONG,0.0
f05b4e4f-2257-4454-842e-6d6304169889,LONG,-0.75
8d94d916-912c-4590-95da-846edc4f92c7,LONG,0.25
b348b2ed-6369-4a47-ad1a-e95bd3b4a205,LONG,1.5
81da75a4-0901-4521-a31e-48e62fb9945d,LONG,0.0
1ae08af3-ba99-4a8c-8c98-0d4a76fa04b4,LONG,0.0
12192413-9669-4d96-9ce7-af45dadde3fc,LONG,-0.625
c630a218-a524-45b4-ad13-c7c7fb7ca557,LONG,-0.5
a68c0078-c56f-495f-8e23-edf6546d22d2,LONG,0.5
4e026ebe-6db0-414e-9a10-a642e3a98ed8,LONG,-1.0
f3890a7d-15f8-4e2b-8caa-83cf056bb6a9,LONG,0.875
2c69a7dc-c16a-400a-b724-9da51f5509d1,LONG,-0.5
f88ce14b-2c3a-4d84-8628-d8e61bb152d3,LONG,0.25
135d80c0-556b-4e72-9a2b-31ad4d520f4b,LONG,0.25
fd92d81f-98bc-4509-8dfc-774be7eff8eb,LONG,-0.25
08b4a8e7-5c89-49dd-b6c6-1d2d74151c5e,LONG,0.25
bab3f26e-c418-41f7-a259-2edd91529e6c,LONG,1.0
6497b826-c493-4d2c-a1c0-977614ac8d3e,LONG,0.25
a31008ce-2045-4679-8de6-7726c7ef7538,LONG,-2.25
1d848c46-bc8d-4be7-bc7b-ac365975522c,LONG,-0.75
780a7e8d-c9a5-4428-8a9d-3c9126eeff39,LONG,1.0
94d92855-6704-41c5-9597-786884aded06,LONG,0.0
fc2e0174-2b0b-4b1d-b9d1-958d8ac653d2,LONG,-1.0
b0a699f7-d659-4d1f-8368-bc3ba90d0118,LONG,1.25
4eca185c-9e2c-499f-8aac-1dec1324a95d,LONG,-0.75
72eaf8fb-a6b8-4821-b014-757c74735389,LONG,-0.75
f7554db4-d94a-47cf-9036-4881131c0eda,LONG,-1.75
770b6541-2344-4cb6-ae10-1575b9393be4,LONG,1.25
d743a293-bb88-4b61-8199-62e151b4bb48,LONG,1.5
0c5ce0ee-a49e-4722-b81d-064dfb150b3c,LONG,3.0
4aab3386-3caa-4dc0-9e8d-744288ff2992,LONG,-1.75
fb1998c5-6a74-48bf-8aa6-7a0cb45c973d,LONG,2.25
867cd8dc-c1ed-4113-899b-0543125a4819,LONG,-1.25
b4af693c-91c7-4b30-934d-03959846d2e6,LONG,-2.5
a2734fe3-b1e1-42d1-a8f0-d25668ca994d,LONG,1.0
dd5f03b4-ffbb-4265-b459-45102b02cdfe,LONG,0.75
959c8167-f63f-4cf7-8498-f46076067584,LONG,2.0
419802b8-734b-4c87-8d89-6ffd6d1240a9,LONG,0.5
3f802557-a753-4cb7-a49a-61eba0632d66,LONG,0.25
ab5f0ecf-e796-4797-b708-f46d8e61ab9d,LONG,1.0
b6966401-d404-41d5-b232-3832713e8b0a,LONG,-2.0
70f2ffe2-af0c-4615-b63d-ced647789371,LONG,1.5
10a5bf49-6b28-4b51-b8a8-e4871f42a8a7,LONG,0.25
9b3b1eb8-79bb-4dea-8ca6-d7160ff56e98,LONG,0.5
3c33c430-6d03-4179-8dc1-7d9df021fa9a,LONG,-2.625
a470612b-79f3-4469-a578-92e9a633f368,LONG,-0.25
a43f5a80-2f6e-46e9-9c70-dcf097d8887b,LONG,-0.5
fc072b27-7bb9-4cbd-b1f2-c7ac58f0d2dd,LONG,-0.75
e37120e5-763a-4173-8616-1654c13b7bf8,LONG,1.0
94ff3d3e-19c5-4d01-b12f-c19bd0665c53,LONG,-2.625
11624afa-e16c-463d-a591-44734d8ea1ae,LONG,-0.25
e6248477-6964-49d3-922a-1bba4f0657fd,LONG,-1.0
4ce0354a-5532-41cb-9afd-b364f366f2b0,LONG,-0.25
b4b44fee-675f-4213-94af-5feb266d98b2,LONG,-0.25
7d70a1e5-5781-4e6d-a055-63c5ac96c775,LONG,0.0
0a0ca590-eeb3-46fe-959a-61191b992fab,LONG,0.5
a4270289-719b-466c-9acb-8f3ef61d5a73,LONG,-0.25
4637ec8d-b064-46bc-9dec-8b72efcade7e,LONG,-0.5
4de26240-6e35-4df1-b7c2-03d2ef52c1d6,LONG,0.75
6ea1d66d-4bc2-4483-a3e4-37e107bc6961,LONG,0.0
7824ac89-65aa-4a5a-8092-553a288e450b,LONG,-0.75
9c3f31a0-3e69-43bb-b121-4db73b439042,LONG,-0.5
bf43f650-1cb5-4cd9-969a-ed0a361bdb2e,LONG,-1.0
733d0852-c8cd-4bde-aef6-590c7f567b1e,LONG,-0.75
45662c70-2c3c-41ac-b765-514030a06f66,LONG,-1.0
447c0547-aa67-45e6-bbe1-3cd

2025-01-20 00:42:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:42:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:42:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:42:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 735
2025-01-20 00:42:11 - snowflake.connector.connection - INFO - closed
2025-01-20 00:42:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:42:11 - root - INFO - SQL:
SELECT DISTINCT t."LastPx" - t."StrikePrice" AS "IntrinsicValue"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") f
WHERE f.value:"Side"::STRING = 'LONG'
LIMIT 1000
Results:
IntrinsicValue
-0.5
0.75
0.5
0.875
1.5
1.125
-2.0
-2.875
-3.25
4.5
4.375
-3.5
2.375
-4.875
-9.5
-6.5
-13.5
7.625
6.375
8.0
8.75
-13.625
6.125
15.5
-10.0
12.625
-6.625
11.75
-11.25
-15.25
10.625
6.875
-8.25
-9.125
-44.5
-19.75
16.375
-21.0
-18.875
20.875
-23.5
26.625
21.5
16.0
-19.125
-23.25
-38.25
22.5
-62.5
80.0
-82.5
-100.0
2.5
-7.125
-9.25
-10.375
-8.875
8.375
-7.375
-17.0
-16.25
-7.875
-14.625
20.375
17.5
48.125
-28.75
-11.875
39.75
12.875
-16.0
-12.375
20.125
18.125
-27.125
25.0
38.5
21.25
22.625
47.5
-77.5
42.5
-65.0
57.5
62.5
127.5
-39.0
-17.625
-92.25
32.125
-105.0
30.0
-47.75
-27.375
48.625
245.0
192.5
135.0
-33.875
28.625
58.25
-57.625
35.75
-24.75
87.625
-215.0
-490.0
-33.625
24.625
-51.625
-37.75
43.75
120.0
-38.75
-35.5
37.375
-30.625
-152.5
-167.5
-1.75
0.0
-0.625
-7.25
-1.125
-1.5
-0.375
1.375
-4.125
-7.75
2.875
6.0
4.625
4.75
-6.25
-4.375
-12.5
5.625
-8.625
8.125
9.875
-5.625
-5.875
7.5
12.125
10.25
70.5
-14.0
-20.0
-10.875
27.75
9.375
-9.625
27.5
-20.5
-29.75
25.25
18.5
10.375
22.25
18.375
62.375
-57.5
-85.0
32.5
50.0
152.5
1.875
-4.0
-4.25
-8.0
-1.625
10.5
5.25
6.25
4.875
19.0
5.875
16.625
-11.0
11.125
18.0
12.375
-36.875
-39.5
16.125
-51.75
-32.375
23.625
-21.125
18.625
-16.125
-26.875
-42.5
37.5
82.5
75.0
-52.5
-310.0
125.0
132.5
150.0
7.375
-13.125
11.625
-17.25
-140.0
28.125
13.125
29.25
-24.0
18.875
34.25
-19.375
29.0
-23.0
-22.125
24.125
33.5
-75.0
140.0
-112.5
-90.0
177.5
97.5
-25.125
102.5
30.75
20.75
37.625
-44.0
29.5
-21.25
41.5
260.0
-92.5
23.125
-46.625
32.625
36.5
-31.5
-28.25
-230.0
297.5
182.5
200.0
322.5
-42.25
30.25
332.5
255.0
-257.5
272.5
-0.25
-0.875
0.375
-2.375
-1.25
0.625
-3.0
3.75
-3.125
3.375
-5.75
3.125
-3.625
7.75
7.875
-8.125
26.25
-13.875
-10.125
-20.75
-10.625
7.125
9.75
13.75
-8.5
-8.375
8.625
-31.625
10.125
29.125
15.0
-17.125
16.5
13.0
14.625
-20.125
29.625
-17.5
-18.375
-28.125
31.875
-33.0
-14.125
33.25
26.125
-27.0
20.25
24.5
35.0
40.0
60.0
482.5
-117.5
-67.5
145.0
-3.75
-5.5
17.875
14.125
17.25
13.875
12.25
-11.5
14.75
-18.625
13.5
-24.5
23.25
14.875
21.125
23.375
21.75
18.25
-24.25
-16.625
-12.125
19.625
-56.0
-25.5
23.5
-25.875
-47.5
52.5
-70.0
122.5
-435.0
72.5
77.5
215.0
-15.5
100.0
-132.5
24.375
-23.75
35.5
-34.5
-36.625
38.25
-21.375
-33.25
-18.0
19.375
42.875
-41.0
30.875
-1407.5
360.0
202.5
25.625
-45.125
-28.375
-24.875
46.25
21.875
-30.5
-29.375
167.5
175.0
-265.0
38.75
31.375
37.75
32.25
-37.375
33.625
-102.5
-36.375
32.875
37.875
-43.625
28.375
-42.625
-46.875
34.125
-130.0
-290.0
137.5
2.25
1.0
-2.5
5.0
2.75
-1.875
-3.375
-2.125
12.5
2.625
10.0
-6.75
-11.75
9.0
6.5
8.25
13.625
10.75
-14.25
-11.625
-19.25
-14.5
-20.375
-12.875
-10.75
58.125
22.0
-13.75
-20.875
19.875
-14.75
-19.0
-26.0
20.5
-15.625
25.5
-22.25
-21.5
21.625
26.375
-16.875
-19.625
25.375
-72.5
247.5
-95.0
92.5
-110.0
-307.5
-4.625
17.0
-22.5
-15.125
8.5
22.375
13.375
13.25
16.75
-14.375
15.125
15.25
-17.75
-32.0
16.25
-22.0
32.75
17.625
-24.625
-30.0
45.0
-45.0
-87.5
-107.5
-23.375
-27.5
45.625
19.5
-38.125
-29.5
26.0
27.25
130.0
-487.5
265.0
0.005000000000109139
47.125
25.75
37.25
-23.125
28.875
24.875
54.75
36.25
-97.5
-29.25
-56.625
-25.625
-36.75
39.0
-31.875
32.0
-39.875
-41.25
-432.5
197.5
-29.625
-36.25
27.125
-26.125
40.25
-122.5
-155.0
3.0
1.25
-0.125
0.125
-2.75
-2.25
3.25
3.5
-5.125
4.125
4.25
-4.5
9.25
6.625
-7.5
7.0
-6.375
3.625
8.875
7.25
-7.625
-13.375
-9.875
14.25
-16.75
9.625
19.75
11.5
-15.875
22.75
11.875
-11.125
-22.75
21.375
-18.25
27.0
15.75
-36.5
-22.625
-20.25
-18.5
64.625
23.75
15.375
29.875
-37.5
187.5
95.0
220.0
4.0
9.125
-6.875
9.5
11.0
-15.0
12.0
14.0
-18.125
11.25
-21.625
17.125
-9.375
-17.375
-21.75
-25.75
19.25
-26.375
-28.0
29.75
15.875
-24.125
-26.25
85.0
90.0
11.375
-11.375
-10.25
-13.25
-12.75
25.125
17.375
-40.0
70.0
-16.5
-27.75
28.0
22.875
26.5
30.125
27.375
36.75
28.75
-29.0
-19.875
-37.125
87.5
-137.5
-80.0
-266.375
50.75
-29.875
-20.625
48.0
31.5
165.0
-32.625
-35.25
53.625
31.125
32.375
42.625
-175.0
160.0
270.0
76.25
62.875
-35.375
-41.125
-115.0
-125.0
112.5
0.25
-0.75
-1.0
2.0
-2.625
-5.0
1.75
-4.75
1.625
3.875
5.75
-7.0
-1.375
-5.25
5.5
2.125
6.75
5.125
-6.125
-9.75
10.875
-5.375
15.625
-8.75
-16.375
12.75
-10.5
14.375
41.75
-13.0
-27.25
-12.625
-15.75
27.625
-22.375
17.75
16.875
23.0
55.0
-35.0
20.0
20.625
-25.0
110.0
-270.0
-3.875
-19.5
-6.0
5.375
-9.0
18.75
-14.875
-12.25
-12.0
22.125
40.125
-15.375
14.5
19.125
-26.625
37.0
28.25
-30.75
-23.875
-55.0
-32.5
-60.0
65.0
-17.875
-31.75
-312.5
-50.0
107.5
67.5
-26.5
-31.375
24.75
34.0
24.25
21.0
-32.75
-64.625
34.625
24.0
-21.875
117.5
-120.0
105.0
147.5
23.875
-18.75
-29.125
33.75
26.75
-31.0
-39.375
-25.25
-267.5
-207.5
-26.75
-22.875
-35.75
30.625
-25.375
31.25
29.375
347.5
302.5
-150.0
-41.375
-24.375
45.5
-142.5

2025-01-20 00:42:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:42:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:42:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:42:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-20 00:42:13 - snowflake.connector.connection - INFO - closed
2025-01-20 00:42:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:42:13 - root - INFO - SQL:
SELECT
    f.value:"Side"::STRING AS "Side",
    AVG(t."LastPx" - t."StrikePrice") AS "AvgIntrinsicValue"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") f
GROUP BY f.value:"Side"::STRING
LIMIT 1000
Results:
Side,AvgIntrinsicValue
LONG,-0.0034340648059031117
SHORT,-0.023587507218392464

2025-01-20 00:42:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:42:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:42:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:42:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 188
2025-01-20 00:42:14 - snowflake.connector.connection - INFO - closed
2025-01-20 00:42:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:42:15 - root - INFO - SQL:
SELECT "TradeDate", COUNT(*) AS "TotalTrades"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
GROUP BY "TradeDate"
LIMIT 1000
Results:
TradeDate,TotalTrades
2020-09-08,5550
2020-09-11,5525
2020-09-16,7508
2020-09-17,7400
2020-09-24,7143
2020-10-04,6644
2020-11-01,6690
2020-11-17,7090
2020-11-18,7163
2020-11-15,6457
2020-05-19,8735
2020-05-26,7411
2020-06-03,7400
2020-06-10,6089
2020-06-12,5575
2020-06-21,4449
2020-06-22,5467
2020-06-24,5472
2020-06-25,5525
2020-07-02,5398
2020-07-19,6744
2020-08-02,6704
2020-08-09,6695
2020-08-16,6727
2020-08-25,7910
2020-08-30,6729
2020-05-30,5457
2020-07-04,4340
2020-07-30,7894
2020-08-28,7804
2020-09-09,5731
2020-09-12,4339
2020-09-20,5667
2020-10-02,7135
2020-10-09,5965
2020-10-16,6219
2020-10-18,2966
2020-11-07,6614
2020-11-10,7256
2020-11-12,8186
2020-11-22,5560
2020-09-05,4340
2020-09-23,2887
2020-09-04,5478
2020-05-21,8724
2020-05-22,8542
2020-05-27,7448
2020-06-19,5620
2020-07-06,5425
2020-07-08,5412
2020-07-10,4176
2020-07-23,8101
2020-08-12,7906
2020-08-17,7868
2020-08-19,7701
2020-08-24,7898
2020-08-27,7856
2020-09-02,7707
2020-08-22,6562
2020-06-13,4329
2020-06-16,6336
2020-07-21,8065
2020-06-06,1105
2020-09-14,5405
2020-09-19,5415
2020-09-22,7438
2020-09-28,6804
2020-09-30,6118
2020-10-03,6579
2020-10-12,6116
2020-10-15,6098
2020-10-05,7180
2020-10-19,7906
2020-10-29,8224
2020-10-30,7850
2020-11-06,8154
2020-11-16,7030
2020-10-11,5523
2020-05-24,5774
2020-05-25,7335
2020-06-09,6017
2020-06-18,6073
2020-06-23,5439
2020-06-15,5313
2020-07-09,5335
2020-07-14,8066
2020-07-31,7772
2020-08-05,6846
2020-08-10,7893
2020-08-20,7881
2020-08-01,6573
2020-07-24,7924
2020-09-07,5464
2020-09-10,5584
2020-09-13,4489
2020-09-15,5920
2020-09-27,5598
2020-10-01,7114
2020-10-07,6083
2020-10-08,6093
2020-10-14,6088
2020-10-24,6607
2020-10-25,6809
2020-10-28,8484
2020-11-05,8232
2020-11-09,7150
2020-11-13,8116
2020-11-20,7034
2020-11-23,6837
2020-10-13,6076
2020-10-21,7631
2020-10-31,6608
2020-06-04,7393
2020-06-08,2051
2020-06-11,6287
2020-06-17,6197
2020-06-20,4403
2020-06-26,5264
2020-06-28,4431
2020-07-20,8041
2020-07-22,8072
2020-08-13,7858
2020-07-29,7860
2020-08-21,7751
2020-08-23,6717
2020-08-31,7889
2020-07-07,5316
2020-08-03,7910
2020-08-18,7343
2020-08-29,6585
2020-09-18,6868
2020-09-26,6229
2020-10-17,4447
2020-10-23,8504
2020-10-26,8582
2020-10-27,8797
2020-11-02,8231
2020-11-03,8007
2020-11-04,8187
2020-11-19,7111
2020-11-21,5477
2020-11-14,6612
2020-05-28,7312
2020-05-29,6901
2020-05-31,5660
2020-06-01,7452
2020-06-02,7617
2020-06-30,5343
2020-07-01,5415
2020-07-03,4980
2020-07-13,1401
2020-07-26,6634
2020-07-28,7251
2020-08-26,7750
2020-07-18,6576
2020-08-08,6593
2020-08-15,6592
2020-06-27,4310
2020-09-01,7946
2020-09-03,5742
2020-05-23,6593
2020-09-21,7181
2020-09-25,2310
2020-09-29,6259
2020-10-06,6542
2020-10-10,5454
2020-10-22,8121
2020-11-08,6462
2020-11-11,8198
2020-09-06,4469
2020-10-20,7610
2020-05-18,2353
2020-05-20,8658
2020-06-05,4285
2020-07-05,4441
2020-07-15,8095
2020-07-16,8137
2020-07-17,7911
2020-07-25,6638
2020-07-27,7196
2020-08-06,7669
2020-08-07,7774
2020-08-11,7755
2020-08-04,7774
2020-08-14,7760
2020-06-14,4396
2020-06-29,5449
2020-06-07,2260

2025-01-20 00:42:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:42:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:42:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:42:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 13
2025-01-20 00:42:16 - snowflake.connector.connection - INFO - closed
2025-01-20 00:42:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:42:16 - root - INFO - SQL:
SELECT
    t."Symbol",
    COUNT(*) AS "TradeCount"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t
GROUP BY t."Symbol"
LIMIT 1000
Results:
Symbol,TradeCount
ESZ0,147993
BTCK0,24818
NQZ0,156552
ESU0,191463
BTCN0,60765
BTCU0,62066
NQU0,207415
BTCQ0,61347
NQM0,80200
BTCV0,69689
BTCZ0,56424
ESM0,65423
BTCM0,38407

2025-01-20 00:42:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:42:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:42:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:42:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 00:42:18 - snowflake.connector.connection - INFO - closed
2025-01-20 00:42:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:42:18 - root - INFO - SQL:
SELECT
    t."OrderID",
    f.value:"Side"::STRING AS "Side",
    t."LastPx" AS "Price"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") f
LIMIT 1000
Results:
Too long, hard cut:
OrderID,Side,Price
13d16468-0b06-49d3-9bdc-dc36502bf963,SHORT,11502.0
560a2490-86f4-4f9f-a621-956e413b3da5,SHORT,11502.0
77781b63-55ee-4f77-a4ca-a9ddb83489ec,SHORT,11502.0
41fa4ce5-13fc-4e01-827e-986bff0fdacb,SHORT,11502.0
b81b508f-f806-48d9-a394-226b1d959c6f,SHORT,11502.0
0e4b7434-0da6-480a-83a0-5481c3ca8a60,SHORT,11502.0
1e3c7ee7-601e-41fa-872d-84325cb11edf,SHORT,11502.0
64a1b69e-b7a2-4d2e-bfd3-a1d7d2b449e8,SHORT,11502.0
9374ad1d-06ac-4aaa-a675-65b8832bba4d,SHORT,11502.0
a265dc44-4d01-4e2f-8a8a-54ceca9e6ea8,SHORT,11502.0
f2399821-a835-4182-b169-1bd51774f966,SHORT,11502.0
fdc1fa4d-3494-415f-9985-ed684c6a0176,SHORT,11502.0
946d0d8b-e0d7-4473-83cc-db512467fe32,SHORT,11502.0
7805b66c-6df7-4d13-8936-fd41302d9c42,SHORT,11502.0
c19751d5-5838-4958-8f36-050f329231fe,SHORT,11502.0
091bbb71-05ba-4404-b180-1fc805b531e6,SHORT,11502.0
be539c12-3421-4108-b478-8d567a6c95c6,SHORT,11502.0
0c7ff41d-f686-4899-ab6b-bc10265b4019,SHORT,11502.0
3d4a8b57-3809-46a5-94c5-41a366876ee9,SHORT,11502.0
4b93afa3-ed9c-4b85-bcd2-084a2d27f36c,SHORT,11502.0
be06f275-15c5-464c-b9df-7c04052e8116,SHORT,11502.0
0ed10a65-39f7-454f-b7b1-e2c5a2335c5d,SHORT,11502.0
d2df7344-3b71-478f-ba76-0c47ea28a769,SHORT,11502.75
0a7e4430-86c5-46fb-bf32-d72248b646ac,SHORT,11525.0
6a9422e6-f9d7-40d8-a0e4-c79322cda30d,SHORT,11531.375
feb5cbc0-392c-41a3-8eb3-a7e6bcf8d71d,SHORT,11528.625
c6d587ee-4dcc-41f2-8b9a-126126e55a1b,SHORT,11528.25
798e2676-0c6c-4d6d-9e5d-2e98f24a1834,SHORT,11529.0
2fab1dd8-9136-4e2e-8fd0-87a9b8810009,SHORT,11570.375
5945c18f-2a32-4fb6-85a6-c52b08e00a3e,SHORT,11565.875
03ab2bb2-ad51-4f42-8a22-6f5f93ba9ce6,SHORT,11580.5
134170d2-4994-48ac-957c-2dc24c712950,SHORT,11580.75
665577db-637d-43de-86e2-c4ad01b5c574,SHORT,11571.375
2fdac4f6-2436-4117-b9dd-84026d8b8d59,SHORT,11564.625
aef124a0-07ad-4e1c-98b2-2bf80f1777b6,SHORT,11558.125
d0a9976f-5a16-4d24-a048-27cb0d1811be,SHORT,11552.75
4d57a765-7d23-45d1-ac2d-4039d32f5861,SHORT,11551.625
73ea42c7-8b6c-40f9-9a6c-7c61c1b49ab3,SHORT,11554.0
6501ebcd-56e2-427d-82fd-7e6596adcc48,SHORT,11554.375
fd5aaea4-f8e8-4041-a33e-34cf8c094f15,SHORT,11552.75
7511996a-893f-41a3-9d29-0d2219a372f8,SHORT,11544.625
71035bb1-1c1a-43bc-97cb-31445a6b9490,SHORT,11536.5
6b4bb844-26f3-43f4-96d9-dd02722f6334,SHORT,11536.25
4860dd01-82cf-4c47-a2cf-ac57dd0c98b2,SHORT,11537.375
051b9edc-e6e8-4042-bd4b-a861ccbf97d7,SHORT,11543.375
44c99b56-9abd-43f8-b2ce-6f58d361471a,SHORT,11540.75
11386d3c-2d1c-4355-bbed-e0b102c32fdd,SHORT,11536.5
75c8a1b1-50a5-4155-be79-e4908b0ed544,SHORT,11526.75
c7d71eed-90e0-43bf-ac69-8a43543f5d4d,SHORT,11530.125
1359b427-79ec-4793-b1c6-5b7c716f1193,SHORT,11541.0
e00bc0bc-5193-4f88-910a-e5d375f3c519,SHORT,11528.125
64158f64-12e4-4ef0-b026-8b7f2a1005f2,SHORT,11528.875
61365df8-e013-45cd-a119-541c3beca07a,SHORT,11541.75
306c8e2c-23df-4ac2-acf3-cecbb73828d6,SHORT,11535.5
ea1e0010-6176-4d35-ba49-a148da853035,SHORT,11533.125
697d85ea-0649-4f99-9d7d-2bd706fbc10a,SHORT,11533.375
be405dc1-8f4e-4bbd-b878-8bc1675f2794,SHORT,11537.625
5de10485-b3f0-4900-9d79-f301a3f40f73,SHORT,11563.0
aefa46b5-a519-43ac-90eb-4864adef54d9,SHORT,11564.0
33b4711c-4e38-40a8-93bc-bbf18bb99565,SHORT,11555.125
1a8c4985-88ee-4580-bfc4-8c68107ab007,SHORT,11558.875
bd76567f-b671-413d-a4f9-642a70785608,SHORT,11528.875
fb6f74c7-5c50-4328-b8d3-c92f555eac7b,SHORT,11528.875
f0cf085b-9c29-4ce8-a193-e841c6912b62,SHORT,11495.25
59a9df52-6604-45c7-91e3-26c6f343dde2,SHORT,11490.0
b9618b37-7ffc-4a1a-b766-28fa81a45c98,SHORT,11491.625
72fc943c-0037-40c3-8779-534be0dd5989,SHORT,11484.125
d0329db4-ebd2-4fa8-871d-57ff6441a3c4,SHORT,11486.75
22ca24f2-046a-4a08-add0-ed7c2220b3bd,SHORT,11486.375
38f2bd39-0360-4e43-a845-72d4f9adf6ee,SHORT,11490.5
7c2a1c1d-7efe-43b5-8946-9bee9824098d,SHORT,11485.875
6a613dbe-188a-4b3d-bcdf-6414cf9206a1,SHORT,11496.0
44958d40-c81e-4cb5-af35-1ab5e127a99c,SHORT,11495.25
bf7b6196-54b7-45a8-8bed-fa4dcca8da67,SHORT,11490.0
5039bae6-b7da-4d1a-9fe5-4eac02cd2839,SHORT,11490.625
650ffc6c-723d-4c52-9a7a-3490525e0f50,SHORT,11490.875
c454a260-5a26-4f87-8034-a23012772b48,SHORT,11500.125
90b225ab-016a-4bf4-891b-81714d3fbb80,SHORT,11499.125
c87f49c5-84a6-4725-a8be-b6fa47819292,SHORT,11501.0
14ae574d-c17b-4bb4-b9d3-0fe76c5d19b0,SHORT,11494.625
8e1f5b4e-b85b-4bc8-910d-a83d5939ac77,SHORT,11500.875
8dbf9d73-7dcf-4f05-80e5-14c10b28d029,SHORT,11505.75
7812ee5f-58e8-431b-b7c3-d07c67a355da,SHORT,11493.5
a44c79a0-ab79-40dc-8c36-b32ba07c39e0,SHORT,11500.75
7989ed5c-c62d-4934-a397-0201e92e7e00,SHORT,11500.625
58d37ed7-d986-401e-8b00-ec96db2fcaaf,SHORT,11504.625
da48b065-032a-41bb-8283-6a65e4c5d18d,SHORT,11512.25
da0f7e56-732e-4f4c-b670-68a14cc0bdab,SHORT,11527.625
1d2e8f77-52cd-48d1-bfcc-45c89fbaf1d6,SHORT,11518.75
d15b2c7f-a7f6-4458-89ee-372f992c6b38,SHORT,11545.625
c90bdf80-0bf0-4b9e-a110-dfe8be0c2e4f,SHORT,11562.875
c46539c9-4805-4028-b34f-f48dad321209,SHORT,11549.875
65b2e3a5-0c2c-4717-8665-0b92a0f8ed06,SHORT,11550.75
d63986d9-b858-49f7-9f4f-0a0328089431,SHORT,11550.375
4bcf2662-377e-4ee6-a978-7698c0e6633b,SHORT,11546.625
d8b58827-c43d-4e73-9b7c-efc29dd4ac40,SH

2025-01-20 00:42:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:42:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:42:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:42:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-20 00:42:20 - snowflake.connector.connection - INFO - closed
2025-01-20 00:42:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:42:20 - root - INFO - SQL:
SELECT DISTINCT f.value:"Side"::STRING AS "SideType"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") f
LIMIT 1000
Results:
SideType
SHORT
LONG

2025-01-20 00:42:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:42:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:42:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:42:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 00:42:21 - snowflake.connector.connection - INFO - closed
2025-01-20 00:42:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:42:22 - root - INFO - SQL:
SELECT
    t."TradeDate",
    t."LastPx" - t."StrikePrice" AS "IntrinsicValue"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") f
WHERE f.value:"Side"::STRING = 'LONG'
LIMIT 1000
Results:
Too long, hard cut:
TradeDate,IntrinsicValue
2020-05-18,2.25
2020-05-18,-0.5
2020-05-18,-1.75
2020-05-18,0.0
2020-05-18,0.0
2020-05-18,-0.5
2020-05-18,0.0
2020-05-18,-0.25
2020-05-18,2.25
2020-05-18,0.75
2020-05-18,0.25
2020-05-18,-0.25
2020-05-18,0.75
2020-05-18,-0.75
2020-05-18,-0.25
2020-05-18,0.0
2020-05-18,-0.25
2020-05-18,-0.5
2020-05-18,-0.25
2020-05-18,-0.5
2020-05-18,0.5
2020-05-18,0.25
2020-05-18,-1.0
2020-05-18,0.5
2020-05-18,0.5
2020-05-18,0.25
2020-05-18,0.25
2020-05-18,0.25
2020-05-19,-0.75
2020-05-19,-0.25
2020-05-19,0.875
2020-05-19,0.25
2020-05-19,-0.75
2020-05-19,-0.5
2020-05-19,-0.25
2020-05-19,0.875
2020-05-19,3.0
2020-05-19,1.75
2020-05-19,-0.25
2020-05-19,0.25
2020-05-19,0.0
2020-05-19,-0.75
2020-05-19,0.25
2020-05-19,1.5
2020-05-19,0.0
2020-05-19,0.0
2020-05-19,-0.625
2020-05-19,-0.5
2020-05-19,0.5
2020-05-19,-1.0
2020-05-19,0.875
2020-05-19,-0.5
2020-05-19,0.25
2020-05-19,0.25
2020-05-19,-0.25
2020-05-19,0.25
2020-05-19,1.0
2020-05-19,0.25
2020-05-19,-2.25
2020-05-19,-0.75
2020-05-19,1.0
2020-05-19,0.0
2020-05-19,-1.0
2020-05-19,1.25
2020-05-19,-0.75
2020-05-19,-0.75
2020-05-19,-1.75
2020-05-19,1.25
2020-05-19,1.5
2020-05-19,3.0
2020-05-19,-1.75
2020-05-19,2.25
2020-05-19,-1.25
2020-05-19,-2.5
2020-05-19,1.0
2020-05-19,0.75
2020-05-19,2.0
2020-05-19,0.5
2020-05-19,0.25
2020-05-19,1.0
2020-05-19,-2.0
2020-05-19,1.5
2020-05-19,0.25
2020-05-19,0.5
2020-05-19,-2.625
2020-05-19,-0.25
2020-05-19,-0.5
2020-05-19,-0.75
2020-05-19,1.0
2020-05-19,-2.625
2020-05-19,-0.25
2020-05-19,-1.0
2020-05-19,-0.25
2020-05-19,-0.25
2020-05-19,0.0
2020-05-19,0.5
2020-05-19,-0.25
2020-05-19,-0.5
2020-05-19,0.75
2020-05-19,0.0
2020-05-19,-0.75
2020-05-19,-0.5
2020-05-19,-1.0
2020-05-19,-0.75
2020-05-19,-1.0
2020-05-19,-1.5
2020-05-19,1.5
2020-05-19,0.5
2020-05-19,2.25
2020-05-19,1.25
2020-05-19,-0.75
2020-05-19,0.5
2020-05-19,-0.5
2020-05-19,0.25
2020-05-19,-1.25
2020-05-19,-0.875
2020-05-19,0.0
2020-05-19,-0.5
2020-05-19,0.75
2020-05-19,1.5
2020-05-19,-0.75
2020-05-19,0.75
2020-05-19,0.25
2020-05-19,-0.25
2020-05-19,-1.0
2020-05-19,0.0
2020-05-19,-0.5
2020-05-19,0.25
2020-05-19,0.0
2020-05-19,-0.25
2020-05-19,1.5
2020-05-19,0.0
2020-05-19,-0.25
2020-05-19,-7.25
2020-05-19,0.0
2020-05-19,-1.25
2020-05-19,-1.0
2020-05-19,0.25
2020-05-19,0.0
2020-05-19,0.0
2020-05-19,0.0
2020-05-19,-0.25
2020-05-19,0.0
2020-05-19,0.0
2020-05-19,-0.25
2020-05-19,1.125
2020-05-19,-0.75
2020-05-19,-1.125
2020-05-19,-2.5
2020-05-19,-0.5
2020-05-19,-0.25
2020-05-19,0.25
2020-05-19,0.75
2020-05-19,-1.5
2020-05-19,0.5
2020-05-19,-0.25
2020-05-20,-0.25
2020-05-20,-1.75
2020-05-20,-1.25
2020-05-20,1.0
2020-05-20,-0.75
2020-05-20,0.875
2020-05-20,-0.25
2020-05-20,-1.0
2020-05-20,-0.25
2020-05-20,0.5
2020-05-20,0.0
2020-05-20,-0.25
2020-05-20,0.25
2020-05-20,1.0
2020-05-20,0.0
2020-05-20,-1.0
2020-05-20,0.625
2020-05-20,-0.5
2020-05-20,0.5
2020-05-20,-0.25
2020-05-20,0.0
2020-05-20,0.25
2020-05-20,-0.125
2020-05-20,0.125
2020-05-20,-0.25
2020-05-20,-2.0
2020-05-20,0.0
2020-05-20,0.125
2020-05-20,-1.0
2020-05-20,0.25
2020-05-20,-0.25
2020-05-20,0.5
2020-05-20,0.625
2020-05-20,-0.5
2020-05-20,-0.25
2020-05-20,0.0
2020-05-20,1.0
2020-05-20,0.75
2020-05-20,-0.25
2020-05-20,-0.25
2020-05-20,-1.0
2020-05-20,1.25
2020-05-20,-0.25
2020-05-20,0.75
2020-05-20,-0.125
2020-05-20,0.375
2020-05-20,0.75
2020-05-20,-0.25
2020-05-20,0.5
2020-05-20,0.125
2020-05-20,-2.375
2020-05-20,-1.5
2020-05-20,-1.0
2020-05-20,-5.0
2020-05-20,0.5
2020-05-20,-2.0
2020-05-20,-1.5
2020-05-20,0.5
2020-05-20,-0.5
2020-05-20,0.25
2020-05-20,-0.75
2020-05-20,0.25
2020-05-20,-0.75
2020-05-20,-0.25
2020-05-20,-0.625
2020-05-20,-0.75
2020-05-20,0.0
2020-05-20,0.5
2020-05-20,0.0
2020-05-20,-1.5
2020-05-20,1.0
2020-05-20,0.0
2020-05-20,-1.25
2020-05-20,0.0
2020-05-20,0.0
2020-05-20,0.5
2020-05-20,0.25
2020-05-20,0.75
2020-05-20,0.5
2020-05-20,1.0
2020-05-20,-0.75
2020-05-20,0.75
2020-05-20,-1.0
2020-05-20,1.25
2020-05-20,-0.75
2020-05-20,-0.5
2020-05-20,0.0
2020-05-20,0.0
2020-05-20,0.5
2020-05-20,0.25
2020-05-20,-0.5
2020-05-20,1.25
2020-05-20,-1.0
2020-05-20,0.5
2020-05-20,-0.5
2020-05-20,0.0
2020-05-20,-0.25
2020-05-20,-2.75
2020-05-20,0.0
2020-05-20,1.0
2020-05-18,-1.0
2020-05-18,0.25
2020-05-18,-1.5
2020-05-18,-0.75
2020-05-18,0.5
2020-05-18,0.0
2020-05-18,2.25
2020-05-18,0.25
2020-05-18,-0.25
2020-05-18,-0.5
2020-05-18,0.5
2020-05-18,0.5
2020-05-18,0.0
2020-05-18,1.0
2020-05-18,-1.5
2020-05-18,0.5
2020-05-18,1.0
2020-05-18,-1.0
2020-05-18,0.0
2020-05-18,0.0
2020-05-18,0.0
2020-05-18,0.375
2020-05-18,-0.25
2020-05-18,-0.5
2020-05-18,-0.75
2020-05-18,0.0
2020-05-18,-0.75
2020-05-18,-0.375
2020-05-18,0.5
2020-05-18,-0.75
2020-05-18,0.5
2020-05-18,0.0
2020-05-18,0.25
2020-05-18,0.875
2020-05-18,0.5
2020-05-18,0.75
2020-05-18,-0.125
2020-05-18,-1.25
2020-05-18,0.0
2020-05-18,0.0
2020-05-18,0.0
2020-05-18,-0.75
2020-05-19,0.75
2020-05-19,1.25
2020-05-19,-1.25
2020-05-19,0.0
2020-05-19,2.5
2020-05-19,-0.5
2020-05-19,-1.375
2020-05-19,0.25
2020-05-19,-0.25
2020-05-19,-0.25
2020-05-19,0.25
2020-05-19,-0

2025-01-20 00:42:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:42:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:42:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:42:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 00:42:23 - snowflake.connector.connection - INFO - closed
2025-01-20 00:42:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:42:24 - root - INFO - SQL:
SELECT t."OrderID", t."StrikePrice", t."LastPx" AS "LastPrice"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t
LIMIT 1000
Results:
Too long, hard cut:
OrderID,StrikePrice,LastPrice
d8eefa63-6f10-4566-8f15-81460448f2ac,2953.125,2953.125
7fa78bef-912c-41cb-b381-4c03b5a7c508,2952.375,2952.375
5a4c4d8b-b9b8-4307-a0c3-8c753ed93520,2952.625,2953.375
a204ef77-1071-48ee-a5f5-21579311cd91,2953.125,2952.625
b7a40778-7293-407b-8636-91a7ffe9817a,2952.375,2953.625
c67a3f6a-7253-4ec8-91be-a4a3f07aa27b,2952.375,2953.125
83e09901-1182-4ad0-b423-0f92bf78a7a2,2953.875,2955.375
8161e8ff-9aa3-4e27-9322-363a4a063a27,2953.625,2953.875
2e2c0922-e696-44f6-899e-9112f6129088,2953.125,2953.625
8afcaa49-daca-470f-9479-6bfd2c648ccf,2952.125,2952.625
4e25aae7-5b30-408a-a23e-ea3afb86c445,2951.125,2952.625
048dab46-3718-4dd2-b12e-709ce317c069,2955.625,2955.125
0e00e452-329b-44df-90a5-902b7e737608,2955.375,2956.875
ae17c30f-0689-4013-8485-05f5eb5f7721,2955.375,2954.375
3a9010bf-80a3-46aa-ae04-afd4b1f39e1a,2954.625,2953.625
5880746a-b864-46b5-8204-060bbe7104a4,2952.875,2952.875
68bf4c18-8084-435b-8786-2ae9b104339e,2954.375,2954.375
0fe87fac-d58a-4bb9-8552-c1e58d91bb82,2957.625,2956.875
94641ac8-057f-4f66-ba2f-81edc252bbcf,2959.375,2958.625
dd4279ad-7a00-4c6f-b26f-0f98aff69aed,2960.375,2958.875
1f0ab9f6-7171-4b0c-a2bd-b61787f165b1,2961.125,2960.125
416c6876-0548-4ea1-b8a6-6b19faca54fc,2961.125,2961.875
02d3b3ec-e025-412a-b53e-53fd8f805f11,2948.5,2948.5
d5b05f8d-eacf-4a34-ae2f-c941d28df7be,2945.875,2946.375
24d610a1-88c7-4cf9-998f-8718b84e2b62,2945.375,2946.125
f52dc7f7-3b0a-4056-827b-e9a8c4224317,2945.375,2944.875
3ab867aa-821f-4ec4-80dc-60e8a0bcf354,2945.625,2945.625
18e91378-d1fa-4d56-a1cd-b27121387413,2946.625,2947.125
88d9d75c-d6b7-43bd-8545-df39e9f273c4,2949.125,2949.125
b6a97240-f7a2-4fcc-af61-e5ffc4d75d2a,2951.625,2951.125
41d4e6b5-c613-4675-96e5-8e6063386673,2952.875,2953.125
e5b35941-b7e3-4d9d-801b-f6ac65323e88,2952.125,2951.875
e93153ae-70f8-4602-a719-1d1abd75e9be,2948.625,2947.625
f9c32f86-511b-4a4a-9aa0-f762006a586f,2949.625,2949.375
94e09d1d-877e-4fbb-9be3-364d960577ad,2952.625,2951.875
497c97b4-f2fb-4be6-ad24-9f9e5546bfa0,2951.875,2952.375
0157053c-746e-406f-abc2-6b1f9bc62ae6,2950.125,2950.625
56abca1f-5414-4a66-b431-e59046936355,2950.375,2949.875
2d19f341-9f61-4c27-8bf6-b8ade6ba71f8,2946.875,2945.625
c75e3f77-7307-4de6-941e-d9cf75cb100e,2948.875,2946.625
3fbb2eeb-10ac-4781-9231-28d422db11b3,2947.625,2947.375
2b3dc23e-a437-4043-b5ee-969f9619bd88,2945.375,2944.875
0af6d51f-c835-48e8-9a92-5a0964659acf,2943.875,2943.875
ab9d61e3-062b-4399-88e9-11e4efced08c,2946.125,2945.375
baf8e745-9e0b-4c04-b19d-6710bb1f735c,2942.875,2945.125
a3442000-1e3c-431b-a47a-3e2b77d976b7,2939.625,2939.875
824fa119-2a12-4e7c-ae8f-2e8d6a4e4fa0,2941.375,2940.625
e936da46-4ed7-4b63-831a-2b7899ad3128,2940.375,2941.125
4d3106b8-e576-4a1d-be03-22131581df01,2940.875,2940.125
f87055ed-fd64-4348-8f0b-7c67d7579c29,2940.625,2941.375
ddb26ae8-e4ab-471b-bc06-e74b4e761795,2942.625,2941.875
861d684d-4a02-403c-a475-357fa889aaa3,2941.875,2943.125
39f4ee8e-781b-4a01-9679-97ffd40e39ee,2941.375,2941.375
08367e10-4c05-471f-84ec-2c2a075f1681,2942.125,2941.375
127ddd6f-93fb-46b5-a39c-1b5b6a1b0be1,2936.875,2936.875
e8b5cc7e-e869-4e8f-9283-c8358b9f7300,2936.375,2937.375
4522704f-d2a3-44a7-bb6f-a7d709df8df9,2937.5,2936.875
b1fa25d4-9786-4002-a9dc-729c5b40be2c,2937.625,2938.125
94509fdd-4b95-404a-a9af-7258bba2b1d4,2937.625,2937.625
176dabfe-8db3-4840-82ab-132ecae1cc53,2939.875,2939.125
262c0482-fb54-4367-a8bc-dc45208d9692,2938.875,2939.625
4f0201f8-367a-42a8-88b2-f4d1144edfd7,2943.375,2941.375
8266205a-e3ac-43da-9733-10713852308c,2945.375,2945.625
cab452ae-6a5d-4ac7-a1e9-5e877088acf2,2947.875,2946.875
63276372-545b-4ed7-95a3-24dd5f9ad505,2946.375,2947.625
338c1f98-7fbf-4726-94a8-845a17d630c8,2946.375,2946.375
28cf600f-0f6c-4335-8e7c-c0646236912c,2946.875,2946.625
aaa93d25-5efc-457c-bcf0-7d4d9063a83c,2946.625,2945.875
467b9488-998c-4e5a-8f08-c4d8bcc3dff3,2948.875,2949.125
d6e38690-238f-4b18-98c6-999971593967,2950.5,2950.5
757ddea5-aee0-4f4c-b784-502ff88018af,2947.125,2946.875
8a661be5-3185-4abe-b897-cdf7e1bb1d86,2948.5,2948.875
51e70637-6b45-4d99-a726-36ae9b651761,2947.625,2948.625
375912c0-dae4-43a0-87db-55f3c3b7cf3a,2947.125,2947.125
7975e9c9-27f8-4b27-b137-7f5a2b190493,2946.875,2946.125
d9cbea5c-0e32-4089-84fc-d259d9b5d0b9,2946.625,2946.875
8ecf434f-5a91-496c-b4b5-bca361c1077b,2950.625,2949.375
452c4d1e-0d7e-4265-98e3-b84a13e85840,2957.5,2955.625
f11eb609-5a4a-45b5-bdc3-79f4274c80e9,2957.625,2958.625
22637dff-9b81-4db0-ad64-53cd88e2c996,2961.125,2957.875
9a341b8b-b217-479f-8446-df1ec7cd8695,2959.625,2959.875
3d03b0b9-8a7c-4f26-898e-767f5c41921c,2961.125,2961.375
6e2e4160-f024-497d-9d74-eb1d47dc988d,2966.875,2967.875
dff99cc9-90ea-4d32-ac73-0357e2be16ee,2970.375,2967.125
0a388c74-525e-4e92-910c-3bbc37abf2d1,2972.875,2972.125
04988554-4170-4e90-9572-702f1724d576,2968.0,2973.625
63458d12-9ac9-4eb2-964b-94b06eca1e6e,2955.375,2955.625
3a85f81e-4247-4483-b5e6-5275a71f7bca,2950.875,2950.625
1c1533da-c5d5-42d8-8305-545ef6b6905f,2937.375,2937.375
0aa6c545-fd39-4da5-9e8a-3e0e7bb65424,2941.125,2940.625
8beae55e-c7a2-4e4d-a7b7-4fb4c55cd857

2025-01-20 00:42:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:42:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:42:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:42:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 13
2025-01-20 00:42:25 - snowflake.connector.connection - INFO - closed
2025-01-20 00:42:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:42:26 - root - INFO - SQL:
SELECT
    t."Symbol",
    f.value:"Side"::STRING AS "Side",
    AVG(t."LastPx" - t."StrikePrice") AS "AvgIntrinsicValue"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") f
WHERE f.value:"Side"::STRING = 'LONG'
GROUP BY t."Symbol", f.value:"Side"::STRING
LIMIT 1000
Results:
Symbol,Side,AvgIntrinsicValue
ESM0,LONG,-0.005999766388729155
BTCK0,LONG,0.13270477955201918
BTCU0,LONG,0.06655014788921754
NQZ0,LONG,0.004765389351942744
NQM0,LONG,-0.008536225583056428
NQU0,LONG,-0.02486461542637658
BTCN0,LONG,-0.010484057909931933
BTCV0,LONG,-0.025685592893008882
BTCQ0,LONG,-0.003773048404383298
ESZ0,LONG,-0.007529098854860641
BTCM0,LONG,0.052361954846314264
BTCZ0,LONG,-0.11724510864221807
ESU0,LONG,6.515846538782318e-05

2025-01-20 00:42:26 - root - INFO - itercount: 0
2025-01-20 00:42:26 - root - INFO - Database Name: CYMBAL_INVESTMENTS
Schema Name: CYMBAL_INVESTMENTS
DDL describes table information.
,0
table_name,TRADE_CAPTURE_REPORT
description,
DDL,"create or replace TABLE TRADE_CAPTURE_REPORT (
	""SendingTime"" NUMBER(38,0),
	""TargetCompID"" VARCHAR(16777216),
	""SenderCompID"" VARCHAR(16777216),
	""Symbol"" VARCHAR(16777216),
	""Quantity"" NUMBER(38,0),
	""OrderID"" VARCHAR(16777216),
	""TransactTime"" NUMBER(38,0),
	""StrikePrice"" FLOAT,
	""LastPx"" FLOAT,
	""MaturityDate"" NUMBER(38,0),
	""TradeReportID"" VARCHAR(16777216),
	""TradeDate"" DATE,
	""CFICode"" VARCHAR(16777216),
	""Sides"" VARIANT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'CYMBAL_INVESTMENTS': {'CYMBAL_INVESTMENTS': ['TRADE_CAPTURE_REPORT']}}
Begin Exploring Related Columns
**Relevant columns and potential usage:**

- **"Sides"**: This VARIANT column likely contains details about each side of the trade, including the side type (e.g., 'long'), the strategy used (e.g., 'feeling-lucky', 'momentum'), and the intrinsic value.
  
- **"LastPx"**: Represents the last price at which the trade was executed. May be used in calculating the intrinsic value.
  
- **"StrikePrice"**: The strike price of the instrument, relevant for options or derivatives when calculating intrinsic value.
  
- **"TradeDate"**: The date of the trade. Could be used to filter trades within a certain timeframe.
  
- **Conditions that may be used:**

  - Filter trades where the side is 'long'.
  - Filter trades where the strategy is 'feeling-lucky' or 'momentum'.
  - Extract and compare intrinsic values based on strategy types.

---

**SQL Queries:**

1. ```sql
   SELECT "OrderID", "Sides"
   FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
   LIMIT 1000;
   ```

2. ```sql
   SELECT "OrderID", f.value
   FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
        LATERAL FLATTEN(input => t."Sides") f
   LIMIT 1000;
   ```

3. ```sql
   SELECT f.value:"Side"::STRING AS "Side"
   FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
        LATERAL FLATTEN(input => t."Sides") f
   LIMIT 1000;
   ```

4. ```sql
   SELECT DISTINCT f.value:"Strategy"::STRING AS "Strategy"
   FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
        LATERAL FLATTEN(input => t."Sides") f
   LIMIT 1000;
   ```

5. ```sql
   SELECT f.value:"IntrinsicValue"::FLOAT AS "IntrinsicValue"
   FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
        LATERAL FLATTEN(input => t."Sides") f
   LIMIT 1000;
   ```

6. ```sql
   SELECT "TradeDate", f.value:"Strategy"::STRING AS "Strategy", f.value:"IntrinsicValue"::FLOAT AS "IntrinsicValue"
   FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
        LATERAL FLATTEN(input => t."Sides") f
   WHERE f.value:"Side"::STRING ILIKE '%long%'
   LIMIT 1000;
   ```

7. ```sql
   SELECT "Symbol", COUNT(*) AS "TradeCount"
   FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
   GROUP BY "Symbol"
   LIMIT 1000;
   ```

8. ```sql
   SELECT f.value:"Side"::STRING AS "Side", COUNT(*) AS "Count"
   FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
        LATERAL FLATTEN(input => t."Sides") f
   GROUP BY f.value:"Side"::STRING
   LIMIT 1000;
   ```

9. ```sql
   SELECT "OrderID", f.value:"Strategy"::STRING AS "Strategy", f.value:"IntrinsicValue"::FLOAT AS "IntrinsicValue"
   FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
        LATERAL FLATTEN(input => t."Sides") f
   WHERE f.value:"Strategy"::STRING = 'feeling-lucky'
   LIMIT 1000;
   ```

10. ```sql
    SELECT AVG(f.value:"IntrinsicValue"::FLOAT) AS "AverageIntrinsicValue", f.value:"Strategy"::STRING AS "Strategy"
    FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
         LATERAL FLATTEN(input => t."Sides") f
    WHERE f.value:"Side"::STRING ILIKE '%long%'
    GROUP BY f.value:"Strategy"::STRING
    LIMIT 1000;
    ```

11. ```sql
    SELECT "OrderID", f.value:"Side"::STRING AS "Side", f.value:"Strategy"::STRING AS "Strategy", f.value:"IntrinsicValue"::FLOAT AS "IntrinsicValue"
    FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
         LATERAL FLATTEN(input => t."Sides") f
    WHERE f.value:"Strategy"::STRING = 'momentum' AND f.value:"Side"::STRING ILIKE '%long%'
    LIMIT 1000;
    ```

12. ```sql
    SELECT DISTINCT f.value:"IntrinsicValue"::FLOAT AS "IntrinsicValue"
    FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
         LATERAL FLATTEN(input => t."Sides") f
    WHERE f.value:"Side"::STRING = 'long'
    LIMIT 1000;
    ```

13. ```sql
    SELECT f.value:"Strategy"::STRING AS "Strategy", f.value:"Side"::STRING AS "Side", AVG(f.value:"IntrinsicValue"::FLOAT) AS "AvgIntrinsicValue"
    FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
         LATERAL FLATTEN(input => t."Sides") f
    GROUP BY f.value:"Strategy"::STRING, f.value:"Side"::STRING
    LIMIT 1000;
    ```

14. ```sql
    SELECT "TradeDate", COUNT(*) AS "TotalTrades"
    FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
    GROUP BY "TradeDate"
    LIMIT 1000;
    ```

15. ```sql
    SELECT "Symbol", f.value:"Strategy"::STRING AS "Strategy", COUNT(*) AS "TradeCount"
    FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
         LATERAL FLATTEN(input => t."Sides") f
    GROUP BY "Symbol", f.value:"Strategy"::STRING
    LIMIT 1000;
    ```

16. ```sql
    SELECT "OrderID", f.value:"Side"::STRING AS "Side", f.value:"Strategy"::STRING AS "Strategy", f.value:"Price"::FLOAT AS "Price"
    FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
         LATERAL FLATTEN(input => t."Sides") f
    WHERE f.value:"Strategy"::STRING IN ('feeling-lucky', 'momentum')
    LIMIT 1000;
    ```

17. ```sql
    SELECT DISTINCT f.value:"Side"::STRING AS "SideType"
    FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
         LATERAL FLATTEN(input => t."Sides") f
    LIMIT 1000;
    ```

18. ```sql
    SELECT "TradeDate", f.value:"IntrinsicValue"::FLOAT AS "IntrinsicValue"
    FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
         LATERAL FLATTEN(input => t."Sides") f
    WHERE f.value:"Side"::STRING ILIKE '%long%' AND f.value:"Strategy"::STRING = 'feeling-lucky'
    LIMIT 1000;
    ```

19. ```sql
    SELECT "OrderID", f.value:"StrikePrice"::FLOAT AS "StrikePrice", f.value:"LastPx"::FLOAT AS "LastPrice"
    FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t
    LIMIT 1000;
    ```

20. ```sql
    SELECT "Symbol", f.value:"Strategy"::STRING AS "Strategy", AVG(f.value:"IntrinsicValue"::FLOAT) AS "AvgIntrinsicValue"
    FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
         LATERAL FLATTEN(input => t."Sides") f
    WHERE f.value:"Side"::STRING = 'long'
    GROUP BY "Symbol", f.value:"Strategy"::STRING
    LIMIT 1000;
    ```

---

These queries are intended to explore the data within the relevant columns, particularly the "Sides" VARIANT column, to understand how to extract and compare the intrinsic values for the different strategies under long-side trades.Query:
SELECT "OrderID", "Sides"
   FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
   LIMIT 1000;
Answer:
Too long, hard cut:
OrderID,Sides
d8eefa63-6f10-4566-8f15-81460448f2ac,"[
  {
    ""OrderID"": ""d8eefa63-6f10-4566-8f15-81460448f2ac"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
7fa78bef-912c-41cb-b381-4c03b5a7c508,"[
  {
    ""OrderID"": ""7fa78bef-912c-41cb-b381-4c03b5a7c508"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
5a4c4d8b-b9b8-4307-a0c3-8c753ed93520,"[
  {
    ""OrderID"": ""5a4c4d8b-b9b8-4307-a0c3-8c753ed93520"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
a204ef77-1071-48ee-a5f5-21579311cd91,"[
  {
    ""OrderID"": ""a204ef77-1071-48ee-a5f5-21579311cd91"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
b7a40778-7293-407b-8636-91a7ffe9817a,"[
  {
    ""OrderID"": ""b7a40778-7293-407b-8636-91a7ffe9817a"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
c67a3f6a-7253-4ec8-91be-a4a3f07aa27b,"[
  {
    ""OrderID"": ""c67a3f6a-7253-4ec8-91be-a4a3f07aa27b"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
83e09901-1182-4ad0-b423-0f92bf78a7a2,"[
  {
    ""OrderID"": ""83e09901-1182-4ad0-b423-0f92bf78a7a2"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
8161e8ff-9aa3-4e27-9322-363a4a063a27,"[
  {
    ""OrderID"": ""8161e8ff-9aa3-4e27-9322-363a4a063a27"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
2e2c0922-e696-44f6-899e-9112f6129088,"[
  {
    ""OrderID"": ""2e2c0922-e696-44f6-899e-9112f6129088"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
8afcaa49-daca-470f-9479-6bfd2c648ccf,"[
  {
    ""OrderID"": ""8afcaa49-daca-470f-9479-6bfd2c648ccf"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
4e25aae7-5b30-408a-a23e-ea3afb86c445,"[
  {
    ""OrderID"": ""4e25aae7-5b30-408a-a23e-ea3afb86c445"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
048dab46-3718-4dd2-b12e-709ce317c069,"[
  {
    ""OrderID"": ""048dab46-3718-4dd2-b12e-709ce317c069"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
0e00e452-329b-44df-90a5-902b7e737608,"[
  {
    ""OrderID"": ""0e00e452-329b-44df-90a5-902b7e737608"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
ae17c30f-0689-4013-8485-05f5eb5f7721,"[
  {
    ""OrderID"": ""ae17c30f-0689-4013-8485-05f5eb5f7721"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
3a9010bf-80a3-46aa-ae04-afd4b1f39e1a,"[
  {
    ""OrderID"": ""3a9010bf-80a3-46aa-ae04-afd4b1f39e1a"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
5880746a-b864-46b5-8204-060bbe7104a4,"[
  {
    ""OrderID"": ""5880746a-b864-46b5-8204-060bbe7104a4"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
68bf4c18-8084-435b-8786-2ae9b104339e,"[
  {
    ""OrderID"": ""68bf4c18-8084-435b-8786-2ae9b104339e"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
Query:
SELECT "OrderID", f.value
   FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
        LATERAL FLATTEN(input => t."Sides") f
   LIMIT 1000;
Answer:
Too long, hard cut:
OrderID,VALUE
d8eefa63-6f10-4566-8f15-81460448f2ac,"{
  ""OrderID"": ""d8eefa63-6f10-4566-8f15-81460448f2ac"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
7fa78bef-912c-41cb-b381-4c03b5a7c508,"{
  ""OrderID"": ""7fa78bef-912c-41cb-b381-4c03b5a7c508"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
5a4c4d8b-b9b8-4307-a0c3-8c753ed93520,"{
  ""OrderID"": ""5a4c4d8b-b9b8-4307-a0c3-8c753ed93520"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
a204ef77-1071-48ee-a5f5-21579311cd91,"{
  ""OrderID"": ""a204ef77-1071-48ee-a5f5-21579311cd91"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
b7a40778-7293-407b-8636-91a7ffe9817a,"{
  ""OrderID"": ""b7a40778-7293-407b-8636-91a7ffe9817a"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
c67a3f6a-7253-4ec8-91be-a4a3f07aa27b,"{
  ""OrderID"": ""c67a3f6a-7253-4ec8-91be-a4a3f07aa27b"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
83e09901-1182-4ad0-b423-0f92bf78a7a2,"{
  ""OrderID"": ""83e09901-1182-4ad0-b423-0f92bf78a7a2"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
8161e8ff-9aa3-4e27-9322-363a4a063a27,"{
  ""OrderID"": ""8161e8ff-9aa3-4e27-9322-363a4a063a27"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
2e2c0922-e696-44f6-899e-9112f6129088,"{
  ""OrderID"": ""2e2c0922-e696-44f6-899e-9112f6129088"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
8afcaa49-daca-470f-9479-6bfd2c648ccf,"{
  ""OrderID"": ""8afcaa49-daca-470f-9479-6bfd2c648ccf"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
4e25aae7-5b30-408a-a23e-ea3afb86c445,"{
  ""OrderID"": ""4e25aae7-5b30-408a-a23e-ea3afb86c445"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
048dab46-3718-4dd2-b12e-709ce317c069,"{
  ""OrderID"": ""048dab46-3718-4dd2-b12e-709ce317c069"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
0e00e452-329b-44df-90a5-902b7e737608,"{
  ""OrderID"": ""0e00e452-329b-44df-90a5-902b7e737608"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
ae17c30f-0689-4013-8485-05f5eb5f7721,"{
  ""OrderID"": ""ae17c30f-0689-4013-8485-05f5eb5f7721"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
3a9010bf-80a3-46aa-ae04-afd4b1f39e1a,"{
  ""OrderID"": ""3a9010bf-80a3-46aa-ae04-afd4b1f39e1a"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
5880746a-b864-46b5-8204-060bbe7104a4,"{
  ""OrderID"": ""5880746a-b864-46b5-8204-060bbe7104a4"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
68bf4c18-8084-435b-8786-2ae9b104339e,"{
  ""OrderID"": ""68bf4c18-8084-435b-8786-2ae9b104339e"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
0fe87fac-d58a-4bb9-8552-c1e58d91bb82,"{
  ""OrderID"": ""0fe87fac-d58a-4bb9-8552-c1e58d91bb82"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""MOMOES"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""LONG""
}"
94641ac8-057f-4f66-ba2f-81edc252bbcf,"{
  ""OrderID"": ""94641ac8-057f-4f66-ba2f-81edc252bbcf"",
  ""PartyIDs"": [
    {
     
Query:
SELECT f.value:"Side"::STRING AS "Side"
   FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
        LATERAL FLATTEN(input => t."Sides") f
   LIMIT 1000;
Answer:
Too long, hard cut:
Side
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHO
Query:
SELECT
  pid.value:"PartyID"::STRING AS "Strategy",
  AVG(t."LastPx" - t."StrikePrice") AS "AvgIntrinsicValue"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") pid
WHERE f.value:"Side"::STRING = 'LONG'
  AND pid.value:"PartyRole"::STRING = 'INITIATING TRADER'
  AND pid.value:"PartyIDSource"::STRING = 'PROP CODE'
  AND pid.value:"PartyID" IN ('MOMOES', 'FEELLUCKY')
GROUP BY pid.value:"PartyID"::STRING;
Answer:
Strategy,AvgIntrinsicValue
MOMOES,-0.005202354927083043
Query:
SELECT t."LastPx" - t."StrikePrice" AS "IntrinsicValue"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t
LIMIT 1000
Answer:
Too long, hard cut:
IntrinsicValue
0.0
0.0
0.75
-0.5
1.25
0.75
1.5
0.25
0.5
0.5
1.5
-0.5
1.5
-1.0
-1.0
0.0
0.0
-0.75
-0.75
-1.5
-1.0
0.75
0.0
0.5
0.75
-0.5
0.0
0.5
0.0
-0.5
0.25
-0.25
-1.0
-0.25
-0.75
0.5
0.5
-0.5
-1.25
-2.25
-0.25
-0.5
0.0
-0.75
2.25
0.25
-0.75
0.75
-0.75
0.75
-0.75
1.25
0.0
-0.75
0.0
1.0
-0.625
0.5
0.0
-0.75
0.75
-2.0
0.25
-1.0
1.25
0.0
-0.25
-0.75
0.25
0.0
-0.25
0.375
1.0
0.0
-0.75
0.25
-1.25
-1.875
1.0
-3.25
0.25
0.25
1.0
-3.25
-0.75
5.625
0.25
-0.25
0.0
-0.5
0.125
-2.5
1.0
2.0
0.0
-0.25
-0.5
0.0
2.5
1.5
-0.25
-0.75
-0.25
0.25
-0.25
-0.25
-0.25
0.375
0.625
-0.75
-0.25
-1.25
-1.0
0.5
0.0
0.0
-1.0
2.25
-4.75
1.0
-1.0
-0.5
0.5
-1.75
-0.25
-0.5
0.5
-0.5
1.0
0.25
2.25
1.25
0.75
2.0
-0.25
-0.25
-1.25
-0.5
1.25
-0.25
-0.25
-0.5
-0.5
0.5
0.75
-1.25
-0.25
0.0
0.0
0.0
0.0
0.0
-0.25
-1.0
0.5
-1.0
-1.75
0.0
0.25
-0.25
-0.25
0.0
0.75
0.125
-1.625
0.25
1.25
-0.5
0.25
1.5
0.25
-0.25
0.0
0.5
-0.25
0.5
0.25
-0.25
-0.25
-0.25
-2.5
-0.25
0.5
0.375
0.25
-0.5
-0.5
-0.75
0.125
0.125
-0.25
-0.25
-0.125
0.5
-0.25
0.25
0.25
0.25
-0.25
-0.75
0.0
0.25
-0.5
-0.25
0.875
-0.5
0.25
-2.5
-0.25
-0.25
0.5
1.625
-5.25
0.0
2.0
2.25
-1.0
-2.25
1.625
1.0
0.5
1.25
1.5
1.5
0.5
-0.5
-1.0
0.75
0.75
-0.125
1.0
0.25
0.75
0.125
-0.625
-0.25
0.0
0.25
0.5
0.5
0.5
0.0
-0.75
-0.25
-1.75
0.0
-0.5
1.25
0.25
-0.25
-3.5
0.25
0.25
-0.5
-2.5
1.25
1.25
-0.75
-0.25
0.25
0.0
-1.25
0.25
1.0
-1.0
-0.75
0.5
0.25
0.25
-0.25
0.25
-0.5
0.75
1.0
0.0
0.25
-0.75
2.25
0.25
-0.75
0.0
0.75
0.25
-2.5
-0.75
-0.25
0.0
0.0
0.5
-0.5
2.0
0.25
0.375
-0.125
1.25
0.0
0.0
0.0
-0.5
-0.25
0.25
0.0
0.5
-0.25
0.25
0.0
0.75
0.5
1.5
0.75
0.75
0.25
-0.5
0.0
-0.25
0.25
0.5
-0.75
0.25
-1.0
-0.25
-0.125
0.0
-0.25
-0.625
0.25
1.0
-0.75
0.25
-1.0
1.0
-0.25
0.375
-0.375
0.0
0.5
-0.25
0.25
-1.5
0.0
-1.25
-0.5
0.25
1.0
0.25
0.0
1.5
0.5
0.25
-0.75
0.625
0.125
1.75
0.125
1.25
-2.125
0.75
0.0
0.25
-2.25
0.0
0.5
-0.25
0.0
-0.25
0.25
0.5
0.25
-0.75
-1.25
0.75
-1.0
0.5
0.75
0.25
-0.125
-2.75
-0.25
0.0
-0.25
-0.25
0.0
-1.75
-0.75
-1.25
-0.75
-1.0
-2.0
0.25
2.5
1.0
1.75
0.75
-2.0
-2.0
1.75
-2.5
1.0
-0.75
0.75
1.5
1.0
-2.25
-0.5
1.0
0.25
-0.5
0.25
0.75
-0.75
0.75
-2.25
2.75
0.375
-1.0
-0.75
1.0
0.75
0.0
0.0
0.5
0.5
-1.625
0.25
-2.125
0.125
-0.875
1.0
-0.125
-0.25
-0.125
0.75
-1.125
-0.25
0.0
0.5
1.0
0.0
0.75
0.375
2.0
-0.5
0.0
0.5
-0.375
-1.5
-0.5
-0.25
-0.75
0.25
0.0
0.375
1.0
0.25
0.75
1.0
-0.25
-0.25
0.0
0.5
0.0
-0.75
0.5
-0.25
-0.25
0.25
-0.5
-0.75
-0.25
-2.25
0.0
-1.0
0.125
0.875
-0.25
-0.5
-0.125
0.25
1.0
-1.625
-0.5
-0.875
-0.75
-0.375
1.5
1.25
-0.375
0.0
-0.5
0.75
-0.5
-1.5
-0.5
0.25
0.5
-1.125
-2.5
-1.0
0.0
2.0
-3.0
-4.0
0.25
0.0
-0.25
0.25
-0.25
1.0
1.0
-2.0
-0.25
-0.75
1.0
1.5
0.5
-0.25
-0.75
1.0
-0.25
-0.25
-0.5
-0.25
1.75
-1.25
-0.5
0.75
-0.5
0.375
0.75
0.5
0.75
1.25
1.0
0.25
-1.0
-0.5
0.5
2.0
-0.25
-0.25
1.0
-0.75
-1.0
-1.75
-0.75
0.0
0.25
0.5
-0.5
0.5
-1.25
-0.75
0.25
0.75
-0.25
-0.25
0.25
-0.75
-0.5
1.0
2.25
-2.0
0.5
0.0
0.5
-0.625
0.75
-1.375
0.5
-0.25
0.5
0.125
0.25
-0.5
-1.0
0.0
-0.75
0.5
-0.5
2.0
0.5
0.0
0.25
-0.25
1.75
-0.5
0.0
-0.25
-1.5
0.5
0.0
1.25
0.25
-0.25
0.5
0.25
-0.25
0.0
-0.25
0.0
0.25
0.125
0.0
-0.5
0.125
-0.5
-0.5
0.25
-0.125
0.25
0.0
0.25
0.0
-0.5
-0.75
-0.25
-0.25
0.25
0.375
-0.25
-0.25
-0.125
0.0
0.0
-0.125
0.0
-0.625
-0.25
-0.5
0.125
-0.875
1.625
1.0
0.25
0.375
-0.25
1.375
2.0
-0.5
0.0
-0.375
0.5
0.0
-0.125
-0.5
0.5
0.5
0.25
-0.375
0.75
0.0
-0.25
0.0
0.5
-0.5
0.25
-0.25
0.0
0.0
0.0
0.0
-0.5
-0.25
0.25
0.0
0.0
0.0
0.25
0.75
0.25
0.25
0.0
-0.25
0.25
0.0
-0.25
0.25
0.0
0.0
0.0
1.0
-0.5
0.0
0.125
0.25
0.0
0.0
0.25
-0.25
-0.125
-0.375
0.125
-0.5
0.0
-0.125
-0.75
0.75
0.875
-1.5
-1.0
0.0
-0.25
-0.5
0.5
-0.25
1.375
0.0
-0.25
-0.125
-0.25
0.0
0.25
-0.5
-0.125
0.25
-0.25
0.25
0.125
-0.125
-0.5
-0.5
1.5
-0.25
2.0
0.25
-0.125
0.25
0.25
0.0
0.75
-0.75
-0.25
0.75
-0.5
0.75
-1.25
-1.25
1.25
-0.5
-1.5
1.0
-0.25
1.125
0.75
-1.0
0.0
0.0
-0.5
1.0
0.375
0.25
0.0
-0.25
1.0
-0.75
-1.0
-0.5
0.25
0.0
-0.25
0.25
-1.0
-1.0
-0.75
-0.25
0.0
-0.75
-1.0
0.25
0.0
-0.75
0.0
-0.75
1.25
0.0
-0.5
-0.25
0.75
-0.75
-0.75
-0.5
-1.0
0.75
-0.75
2.25
0.25
0.25
0.25
-0.5
0.5
0.5
0.25
0.5
0.25
0.0
-0.75
-2.0
1.5
0.75
0.5
0.5
-0.75
-1.75
0.25
-2.0
0.75
-0.75
0.0
-0.125
-0.25
-0.25
0.0
-0.25
0.5
0.0
0.0
0.0
0.5
0.375
0.5
0.5
-0.125
-1.25
0.125
-0.5
-0.875
0.75
1.75
0.0
0.75
-0.75
0.25
0.0
-0.5
-0.5
0.5
0.0
0.25
-0.25
0.25
-0.25
0.5
0.5
0.75
-1.5
-0.375
0.0
0.125
-0.25
-0.5
0.0
0.25
0.25
0.125
-0.25
0.5
0.5
-1.25
-1.0
-0.5
0.0
-0.625
1.25
0.0
-2.5
0.25
-0.5
-1.5
1.0
0.0
0.0
1.0
0.5
2.25
-1.0
0.75
0.75
0.5
-0.75
-0.5
-1.0
-0.25
0.0
2.75
0.0
-1.0
0.0
0.0
0.5
0.5
3.0
-1.0
0.0
-0.5
0.0
-0.25
0.0
0.25
-1.75
0.75
1.0
0.25
-1.0
0.5
1.25
0.25
1.0
-1.75
1.25
-1.0
4.25
-1.0
0.5
0.25
0.75
-1.25
0.75
-1.0
0.25
0.75
1.0
-0.5
0.0
0.0
-1.5
0.0
-0.5
3.0
-3.75
-0.25
0.0
-0.875
0.5
0.0
-0.5
-0.25
0.0
-0.75
0.75
0.5
-0.25
-0.25
-1.25
0.25
0.25
0.0
-1.25
-0.25
0.25
0.0
0.5
-0.25
-0.25
0.5
0.5
-1.875
-0.5
0.0
-0.125
0.75
0.0
-0.75
0.5
-1.0
-0.25
-0.5
-0.625
0.25
-0.5
-0.25
-0.125
0.125
0.375
-0.5
0.75
0.75
-1.5
1.375
0.5
-0.25
-0.25
2.2
Query:
SELECT
    t."TradeDate",
    pid.value:"PartyID"::STRING AS "Strategy",
    t."LastPx" - t."StrikePrice" AS "IntrinsicValue"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") pid
WHERE f.value:"Side"::STRING ILIKE '%LONG%'
  AND pid.value:"PartyRole"::STRING = 'INITIATING TRADER'
  AND pid.value:"PartyIDSource"::STRING = 'PROP CODE'
LIMIT 1000
Answer:
Too long, hard cut:
TradeDate,Strategy,IntrinsicValue
2020-05-18,MOMOES,0.0
2020-05-18,MOMOES,0.0
2020-05-18,MOMOES,0.75
2020-05-18,MOMOES,-0.5
2020-05-18,MOMOES,1.25
2020-05-18,MOMOES,0.75
2020-05-18,MOMOES,1.5
2020-05-18,MOMOES,0.25
2020-05-18,MOMOES,0.5
2020-05-18,MOMOES,0.5
2020-05-18,MOMOES,1.5
2020-05-18,MOMOES,-0.5
2020-05-18,MOMOES,1.5
2020-05-18,MOMOES,-1.0
2020-05-18,MOMOES,-1.0
2020-05-18,MOMOES,0.0
2020-05-18,MOMOES,0.0
2020-05-18,MOMOES,-0.75
2020-05-18,MOMOES,-0.75
2020-05-18,MOMOES,-1.5
2020-05-18,MOMOES,-1.0
2020-05-18,MOMOES,0.75
2020-05-18,MOMOES,0.0
2020-05-18,MOMOES,0.5
2020-05-18,MOMOES,0.75
2020-05-18,MOMOES,-0.5
2020-05-18,MOMOES,0.0
2020-05-18,MOMOES,0.5
2020-05-18,MOMOES,0.0
2020-05-18,MOMOES,-0.5
2020-05-18,MOMOES,0.25
2020-05-18,MOMOES,-0.25
2020-05-18,MOMOES,-1.0
2020-05-18,MOMOES,-0.25
2020-05-19,MOMOES,-0.75
2020-05-19,MOMOES,0.5
2020-05-19,MOMOES,0.5
2020-05-19,MOMOES,-0.5
2020-05-19,MOMOES,-1.25
2020-05-19,MOMOES,-2.25
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-0.5
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,-0.75
2020-05-19,MOMOES,2.25
2020-05-19,MOMOES,0.25
2020-05-19,MOMOES,-0.75
2020-05-19,MOMOES,0.75
2020-05-19,MOMOES,-0.75
2020-05-19,MOMOES,0.75
2020-05-19,MOMOES,-0.75
2020-05-19,MOMOES,1.25
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,-0.75
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,1.0
2020-05-19,MOMOES,-0.625
2020-05-19,MOMOES,0.5
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,-0.75
2020-05-19,MOMOES,0.75
2020-05-19,MOMOES,-2.0
2020-05-19,MOMOES,0.25
2020-05-19,MOMOES,-1.0
2020-05-19,MOMOES,1.25
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-0.75
2020-05-19,MOMOES,0.25
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,0.375
2020-05-19,MOMOES,1.0
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,-0.75
2020-05-19,MOMOES,0.25
2020-05-19,MOMOES,-1.25
2020-05-19,MOMOES,-1.875
2020-05-19,MOMOES,1.0
2020-05-19,MOMOES,-3.25
2020-05-19,MOMOES,0.25
2020-05-19,MOMOES,0.25
2020-05-19,MOMOES,1.0
2020-05-19,MOMOES,-3.25
2020-05-19,MOMOES,-0.75
2020-05-19,MOMOES,5.625
2020-05-19,MOMOES,0.25
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,-0.5
2020-05-19,MOMOES,0.125
2020-05-19,MOMOES,-2.5
2020-05-19,MOMOES,1.0
2020-05-19,MOMOES,2.0
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-0.5
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,2.5
2020-05-19,MOMOES,1.5
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-0.75
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,0.25
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,0.375
2020-05-19,MOMOES,0.625
2020-05-19,MOMOES,-0.75
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-1.25
2020-05-19,MOMOES,-1.0
2020-05-19,MOMOES,0.5
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,-1.0
2020-05-19,MOMOES,2.25
2020-05-19,MOMOES,-4.75
2020-05-19,MOMOES,1.0
2020-05-19,MOMOES,-1.0
2020-05-19,MOMOES,-0.5
2020-05-19,MOMOES,0.5
2020-05-19,MOMOES,-1.75
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-0.5
2020-05-19,MOMOES,0.5
2020-05-19,MOMOES,-0.5
2020-05-19,MOMOES,1.0
2020-05-19,MOMOES,0.25
2020-05-19,MOMOES,2.25
2020-05-19,MOMOES,1.25
2020-05-19,MOMOES,0.75
2020-05-19,MOMOES,2.0
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-1.25
2020-05-19,MOMOES,-0.5
2020-05-19,MOMOES,1.25
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-0.5
2020-05-19,MOMOES,-0.5
2020-05-19,MOMOES,0.5
2020-05-19,MOMOES,0.75
2020-05-19,MOMOES,-1.25
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-1.0
2020-05-19,MOMOES,0.5
2020-05-19,MOMOES,-1.0
2020-05-19,MOMOES,-1.75
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,0.25
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,-0.25
2020-05-19,MOMOES,0.0
2020-05-19,MOMOES,0.75
2020-05-19,MOMOES,0.125
2020-05-19,MOMOES,-1.625
2020-05-19,MOMOES,0.25
2020-05-20,MOMOES,1.25
2020-05-20,MOMOES,-0.5
2020-05-20,MOMOES,0.25
2020-05-20,MOMOES,1.5
2020-05-20,MOMOES,0.25
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,0.0
2020-05-20,MOMOES,0.5
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,0.5
2020-05-20,MOMOES,0.25
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,-2.5
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,0.5
2020-05-20,MOMOES,0.375
2020-05-20,MOMOES,0.25
2020-05-20,MOMOES,-0.5
2020-05-20,MOMOES,-0.5
2020-05-20,MOMOES,-0.75
2020-05-20,MOMOES,0.125
2020-05-20,MOMOES,0.125
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,-0.125
2020-05-20,MOMOES,0.5
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,0.25
2020-05-20,MOMOES,0.25
2020-05-20,MOMOES,0.25
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,-0.75
2020-05-20,MOMOES,0.0
2020-05-20,MOMOES,0.25
2020-05-20,MOMOES,-0.5
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,0.875
2020-05-20,MOMOES,-0.5
2020-05-20,MOMOES,0.25
2020-05-20,MOMOES,-2.5
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,-0.25
2020-05-20,MOMOES,0.5
2020-05-20,MOMOES,1.625
2020-05-20,MOMOES,-5.25
2020-05-20,MOMOES,0.0
2020-05-20,MOMOES,2.0
2
Query:
SELECT "Symbol", COUNT(*) AS "TradeCount"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
GROUP BY "Symbol"
LIMIT 1000
Answer:
Symbol,TradeCount
ESZ0,147993
BTCK0,24818
NQZ0,156552
ESU0,191463
BTCN0,60765
BTCU0,62066
NQU0,207415
BTCQ0,61347
NQM0,80200
BTCV0,69689
BTCZ0,56424
ESM0,65423
BTCM0,38407
Query:
SELECT f.value:"Side"::STRING AS "Side", COUNT(*) AS "Count"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") f
GROUP BY f.value:"Side"::STRING
LIMIT 1000
Answer:
Side,Count
SHORT,443312
LONG,779250
Query:
SELECT
    pid.value:"PartyID"::STRING AS "Strategy",
    AVG(t."LastPx" - t."StrikePrice") AS "AvgIntrinsicValue"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") f,
     LATERAL FLATTEN(input => f.value:"PartyIDs") pid
WHERE f.value:"Side"::STRING = 'LONG'
GROUP BY pid.value:"PartyID"::STRING;
Answer:
Strategy,AvgIntrinsicValue
LUCKYBTC,0.016179263197873148
PREDICTES,-0.0018594337724254291
LUCKYES,-0.006717415681876995
MOMOBTC,0.09964695498676081
MOMONQ,0.004894004137160459
PREDICTBTC,-0.0187683284457478
MOMOES,-0.005202354927083043
LUCKYNQ,-0.021882035708675848
PREDICTNQ,-0.40202702702702703
Query:
SELECT
    AVG(t."LastPx" - t."StrikePrice") AS "AverageIntrinsicValue"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t
LIMIT 1000
Answer:
AverageIntrinsicValue
-0.010741884665153996
Query:
SELECT
    t."OrderID",
    f.value:"Side"::STRING AS "Side",
    t."LastPx" - t."StrikePrice" AS "IntrinsicValue"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") f
WHERE f.value:"Side"::STRING = 'LONG'
LIMIT 1000
Answer:
Too long, hard cut:
OrderID,Side,IntrinsicValue
9b714e1a-f0af-4bf5-a9b2-e347a1684570,LONG,2.25
28150993-e066-46a4-8fdb-335cbe22faf0,LONG,-0.5
01feee11-69d1-4a2e-b36a-9ebba87736e6,LONG,-1.75
48fe371f-f591-4840-8e9c-6d9f5891ac11,LONG,0.0
840efeb4-19b9-4bcd-9f49-39b5860a4839,LONG,0.0
c0e59831-9d93-4e84-8225-ae9f69bd372c,LONG,-0.5
45754918-2d7a-4d3c-a2e1-e576408a3b6d,LONG,0.0
0bb20482-2074-4d0c-8a8e-bd8036e71f5f,LONG,-0.25
c8fba02e-cc8b-4dad-ab13-511fb6410e8c,LONG,2.25
516dd0f6-3aa7-4f2e-b139-c31b68be6502,LONG,0.75
dfe79093-86f2-4c3f-b80d-8d12cfe90ccc,LONG,0.25
b246a020-d478-45e4-902a-7e49b9d6435f,LONG,-0.25
eb6923c0-49f9-49e1-bf41-d294f6cf4663,LONG,0.75
e0d857f6-fdb3-41a5-a852-b028f3b33715,LONG,-0.75
6d36cc04-f932-4082-b172-909cef2778d6,LONG,-0.25
13f84ec0-2541-49d4-bc0f-cda7e100b262,LONG,0.0
084b933c-0e83-4ab9-b197-dc46a8947dc2,LONG,-0.25
2e8b9e61-ec83-4bbe-b58b-b7cfbb842926,LONG,-0.5
dea5784b-c9c4-4456-9c97-5def6d979b2b,LONG,-0.25
74c822dd-a4e0-4758-812f-0f99cf7ae2f4,LONG,-0.5
5d3df63d-4bf8-4acb-8084-7296ed57d820,LONG,0.5
a02f81df-7983-49ba-a0ca-e78314e01a45,LONG,0.25
3ee25339-a105-4be0-bf81-a8cd27010c25,LONG,-1.0
5ef10390-0f9e-4a87-9447-80a5297f02c4,LONG,0.5
115cc308-4003-4734-82d2-bda11de04ac7,LONG,0.5
3c48b3f0-b341-4dfa-a26f-20d40dcdc1b4,LONG,0.25
ced9e10e-2f1a-46be-a987-2e4edbe1e2fa,LONG,0.25
cf8a7898-bb04-4127-89a5-5db5433f06b5,LONG,0.25
b793d3d3-42f0-44de-8f60-4a049d0ad454,LONG,-0.75
70e53ae5-387a-4168-8e13-5ca14ba7055c,LONG,-0.25
94d3fee1-9df7-4161-8e33-afb26f43ba84,LONG,0.875
e7ad788f-2eca-4252-8f89-f572e24ed65b,LONG,0.25
a77247c9-0aa3-4aa3-b736-74d15ee17756,LONG,-0.75
48666f41-3507-456b-a9bd-d942dd92cd7f,LONG,-0.5
da34e1e6-a5c2-4e6b-bba1-4bc5e136a2cc,LONG,-0.25
071efa5e-1513-4873-b831-1db5e2c131db,LONG,0.875
09028b79-66a7-415e-91b1-b1721a7ce8a4,LONG,3.0
d94098c0-c8dd-46f7-89ae-510850771bdd,LONG,1.75
ed4dff23-961a-4a51-89b0-0009b25af117,LONG,-0.25
a8de7074-5d45-43ce-a804-9117b86a70fa,LONG,0.25
6861cc17-3163-4149-941c-f035ff8fd8ef,LONG,0.0
f05b4e4f-2257-4454-842e-6d6304169889,LONG,-0.75
8d94d916-912c-4590-95da-846edc4f92c7,LONG,0.25
b348b2ed-6369-4a47-ad1a-e95bd3b4a205,LONG,1.5
81da75a4-0901-4521-a31e-48e62fb9945d,LONG,0.0
1ae08af3-ba99-4a8c-8c98-0d4a76fa04b4,LONG,0.0
12192413-9669-4d96-9ce7-af45dadde3fc,LONG,-0.625
c630a218-a524-45b4-ad13-c7c7fb7ca557,LONG,-0.5
a68c0078-c56f-495f-8e23-edf6546d22d2,LONG,0.5
4e026ebe-6db0-414e-9a10-a642e3a98ed8,LONG,-1.0
f3890a7d-15f8-4e2b-8caa-83cf056bb6a9,LONG,0.875
2c69a7dc-c16a-400a-b724-9da51f5509d1,LONG,-0.5
f88ce14b-2c3a-4d84-8628-d8e61bb152d3,LONG,0.25
135d80c0-556b-4e72-9a2b-31ad4d520f4b,LONG,0.25
fd92d81f-98bc-4509-8dfc-774be7eff8eb,LONG,-0.25
08b4a8e7-5c89-49dd-b6c6-1d2d74151c5e,LONG,0.25
bab3f26e-c418-41f7-a259-2edd91529e6c,LONG,1.0
6497b826-c493-4d2c-a1c0-977614ac8d3e,LONG,0.25
a31008ce-2045-4679-8de6-7726c7ef7538,LONG,-2.25
1d848c46-bc8d-4be7-bc7b-ac365975522c,LONG,-0.75
780a7e8d-c9a5-4428-8a9d-3c9126eeff39,LONG,1.0
94d92855-6704-41c5-9597-786884aded06,LONG,0.0
fc2e0174-2b0b-4b1d-b9d1-958d8ac653d2,LONG,-1.0
b0a699f7-d659-4d1f-8368-bc3ba90d0118,LONG,1.25
4eca185c-9e2c-499f-8aac-1dec1324a95d,LONG,-0.75
72eaf8fb-a6b8-4821-b014-757c74735389,LONG,-0.75
f7554db4-d94a-47cf-9036-4881131c0eda,LONG,-1.75
770b6541-2344-4cb6-ae10-1575b9393be4,LONG,1.25
d743a293-bb88-4b61-8199-62e151b4bb48,LONG,1.5
0c5ce0ee-a49e-4722-b81d-064dfb150b3c,LONG,3.0
4aab3386-3caa-4dc0-9e8d-744288ff2992,LONG,-1.75
fb1998c5-6a74-48bf-8aa6-7a0cb45c973d,LONG,2.25
867cd8dc-c1ed-4113-899b-0543125a4819,LONG,-1.25
b4af693c-91c7-4b30-934d-03959846d2e6,LONG,-2.5
a2734fe3-b1e1-42d1-a8f0-d25668ca994d,LONG,1.0
dd5f03b4-ffbb-4265-b459-45102b02cdfe,LONG,0.75
959c8167-f63f-4cf7-8498-f46076067584,LONG,2.0
419802b8-734b-4c87-8d89-6ffd6d1240a9,LONG,0.5
3f802557-a753-4cb7-a49a-61eba0632d66,LONG,0.25
ab5f0ecf-e796-4797-b708-f46d8e61ab9d,LONG,1.0
b6966401-d404-41d5-b232-3832713e8b0a,LONG,-2.0
70f2ffe2-af0c-4615-b63d-ced647789371,LONG,1.5
10a5bf49-6b28-4b51-b8a8-e4871f42a8a7,LONG,0.25
9b3b1eb8-79bb-4dea-8ca6-d7160ff56e98,LONG,0.5
3c33c430-6d03-4179-8dc1-7d9df021fa9a,LONG,-2.625
a470612b-79f3-4469-a578-92e9a633f368,LONG,-0.25
a43f5a80-2f6e-46e9-9c70-dcf097d8887b,LONG,-0.5
fc072b27-7bb9-4cbd-b1f2-c7ac58f0d2dd,LONG,-0.75
e37120e5-763a-4173-8616-1654c13b7bf8,LONG,1.0
94ff3d3e-19c5-4d01-b12f-c19bd0665c53,LONG,-2.625
11624afa-e16c-463d-a591-44734d8ea1ae,LONG,-0.25
e6248477-6964-49d3-922a-1bba4f0657fd,LONG,-1.0
4ce0354a-5532-41cb-9afd-b364f366f2b0,LONG,-0.25
b4b44fee-675f-4213-94af-5feb266d98b2,LONG,-0.25
7d70a1e5-5781-4e6d-a055-63c5ac96c775,LONG,0.0
0a0ca590-eeb3-46fe-959a-61191b992fab,LONG,0.5
a4270289-719b-466c-9acb-8f3ef61d5a73,LONG,-0.25
4637ec8d-b064-46bc-9dec-8b72efcade7e,LONG,-0.5
4de26240-6e35-4df1-b7c2-03d2ef52c1d6,LONG,0.75
6ea1d66d-4bc2-4483-a3e4-37e107bc6961,LONG,0.0
7824ac89-65aa-4a5a-8092-553a288e450b,LONG,-0.75
9c3f31a0-3e69-43bb-b121-4db73b439042,LONG,-0.5
bf43f650-1cb5-4cd9-969a-ed0a361bdb2e,LONG,-1.0
733d0852-c8cd-4bde-aef6-590c7f567b1e,LONG,-0.75
45662c70-2c3c-41ac-b765-514030a06f66,LONG,-1.0
447c0547-aa67-45e6-bbe1-3cd
Query:
SELECT DISTINCT t."LastPx" - t."StrikePrice" AS "IntrinsicValue"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") f
WHERE f.value:"Side"::STRING = 'LONG'
LIMIT 1000
Answer:
IntrinsicValue
-0.5
0.75
0.5
0.875
1.5
1.125
-2.0
-2.875
-3.25
4.5
4.375
-3.5
2.375
-4.875
-9.5
-6.5
-13.5
7.625
6.375
8.0
8.75
-13.625
6.125
15.5
-10.0
12.625
-6.625
11.75
-11.25
-15.25
10.625
6.875
-8.25
-9.125
-44.5
-19.75
16.375
-21.0
-18.875
20.875
-23.5
26.625
21.5
16.0
-19.125
-23.25
-38.25
22.5
-62.5
80.0
-82.5
-100.0
2.5
-7.125
-9.25
-10.375
-8.875
8.375
-7.375
-17.0
-16.25
-7.875
-14.625
20.375
17.5
48.125
-28.75
-11.875
39.75
12.875
-16.0
-12.375
20.125
18.125
-27.125
25.0
38.5
21.25
22.625
47.5
-77.5
42.5
-65.0
57.5
62.5
127.5
-39.0
-17.625
-92.25
32.125
-105.0
30.0
-47.75
-27.375
48.625
245.0
192.5
135.0
-33.875
28.625
58.25
-57.625
35.75
-24.75
87.625
-215.0
-490.0
-33.625
24.625
-51.625
-37.75
43.75
120.0
-38.75
-35.5
37.375
-30.625
-152.5
-167.5
-1.75
0.0
-0.625
-7.25
-1.125
-1.5
-0.375
1.375
-4.125
-7.75
2.875
6.0
4.625
4.75
-6.25
-4.375
-12.5
5.625
-8.625
8.125
9.875
-5.625
-5.875
7.5
12.125
10.25
70.5
-14.0
-20.0
-10.875
27.75
9.375
-9.625
27.5
-20.5
-29.75
25.25
18.5
10.375
22.25
18.375
62.375
-57.5
-85.0
32.5
50.0
152.5
1.875
-4.0
-4.25
-8.0
-1.625
10.5
5.25
6.25
4.875
19.0
5.875
16.625
-11.0
11.125
18.0
12.375
-36.875
-39.5
16.125
-51.75
-32.375
23.625
-21.125
18.625
-16.125
-26.875
-42.5
37.5
82.5
75.0
-52.5
-310.0
125.0
132.5
150.0
7.375
-13.125
11.625
-17.25
-140.0
28.125
13.125
29.25
-24.0
18.875
34.25
-19.375
29.0
-23.0
-22.125
24.125
33.5
-75.0
140.0
-112.5
-90.0
177.5
97.5
-25.125
102.5
30.75
20.75
37.625
-44.0
29.5
-21.25
41.5
260.0
-92.5
23.125
-46.625
32.625
36.5
-31.5
-28.25
-230.0
297.5
182.5
200.0
322.5
-42.25
30.25
332.5
255.0
-257.5
272.5
-0.25
-0.875
0.375
-2.375
-1.25
0.625
-3.0
3.75
-3.125
3.375
-5.75
3.125
-3.625
7.75
7.875
-8.125
26.25
-13.875
-10.125
-20.75
-10.625
7.125
9.75
13.75
-8.5
-8.375
8.625
-31.625
10.125
29.125
15.0
-17.125
16.5
13.0
14.625
-20.125
29.625
-17.5
-18.375
-28.125
31.875
-33.0
-14.125
33.25
26.125
-27.0
20.25
24.5
35.0
40.0
60.0
482.5
-117.5
-67.5
145.0
-3.75
-5.5
17.875
14.125
17.25
13.875
12.25
-11.5
14.75
-18.625
13.5
-24.5
23.25
14.875
21.125
23.375
21.75
18.25
-24.25
-16.625
-12.125
19.625
-56.0
-25.5
23.5
-25.875
-47.5
52.5
-70.0
122.5
-435.0
72.5
77.5
215.0
-15.5
100.0
-132.5
24.375
-23.75
35.5
-34.5
-36.625
38.25
-21.375
-33.25
-18.0
19.375
42.875
-41.0
30.875
-1407.5
360.0
202.5
25.625
-45.125
-28.375
-24.875
46.25
21.875
-30.5
-29.375
167.5
175.0
-265.0
38.75
31.375
37.75
32.25
-37.375
33.625
-102.5
-36.375
32.875
37.875
-43.625
28.375
-42.625
-46.875
34.125
-130.0
-290.0
137.5
2.25
1.0
-2.5
5.0
2.75
-1.875
-3.375
-2.125
12.5
2.625
10.0
-6.75
-11.75
9.0
6.5
8.25
13.625
10.75
-14.25
-11.625
-19.25
-14.5
-20.375
-12.875
-10.75
58.125
22.0
-13.75
-20.875
19.875
-14.75
-19.0
-26.0
20.5
-15.625
25.5
-22.25
-21.5
21.625
26.375
-16.875
-19.625
25.375
-72.5
247.5
-95.0
92.5
-110.0
-307.5
-4.625
17.0
-22.5
-15.125
8.5
22.375
13.375
13.25
16.75
-14.375
15.125
15.25
-17.75
-32.0
16.25
-22.0
32.75
17.625
-24.625
-30.0
45.0
-45.0
-87.5
-107.5
-23.375
-27.5
45.625
19.5
-38.125
-29.5
26.0
27.25
130.0
-487.5
265.0
0.005000000000109139
47.125
25.75
37.25
-23.125
28.875
24.875
54.75
36.25
-97.5
-29.25
-56.625
-25.625
-36.75
39.0
-31.875
32.0
-39.875
-41.25
-432.5
197.5
-29.625
-36.25
27.125
-26.125
40.25
-122.5
-155.0
3.0
1.25
-0.125
0.125
-2.75
-2.25
3.25
3.5
-5.125
4.125
4.25
-4.5
9.25
6.625
-7.5
7.0
-6.375
3.625
8.875
7.25
-7.625
-13.375
-9.875
14.25
-16.75
9.625
19.75
11.5
-15.875
22.75
11.875
-11.125
-22.75
21.375
-18.25
27.0
15.75
-36.5
-22.625
-20.25
-18.5
64.625
23.75
15.375
29.875
-37.5
187.5
95.0
220.0
4.0
9.125
-6.875
9.5
11.0
-15.0
12.0
14.0
-18.125
11.25
-21.625
17.125
-9.375
-17.375
-21.75
-25.75
19.25
-26.375
-28.0
29.75
15.875
-24.125
-26.25
85.0
90.0
11.375
-11.375
-10.25
-13.25
-12.75
25.125
17.375
-40.0
70.0
-16.5
-27.75
28.0
22.875
26.5
30.125
27.375
36.75
28.75
-29.0
-19.875
-37.125
87.5
-137.5
-80.0
-266.375
50.75
-29.875
-20.625
48.0
31.5
165.0
-32.625
-35.25
53.625
31.125
32.375
42.625
-175.0
160.0
270.0
76.25
62.875
-35.375
-41.125
-115.0
-125.0
112.5
0.25
-0.75
-1.0
2.0
-2.625
-5.0
1.75
-4.75
1.625
3.875
5.75
-7.0
-1.375
-5.25
5.5
2.125
6.75
5.125
-6.125
-9.75
10.875
-5.375
15.625
-8.75
-16.375
12.75
-10.5
14.375
41.75
-13.0
-27.25
-12.625
-15.75
27.625
-22.375
17.75
16.875
23.0
55.0
-35.0
20.0
20.625
-25.0
110.0
-270.0
-3.875
-19.5
-6.0
5.375
-9.0
18.75
-14.875
-12.25
-12.0
22.125
40.125
-15.375
14.5
19.125
-26.625
37.0
28.25
-30.75
-23.875
-55.0
-32.5
-60.0
65.0
-17.875
-31.75
-312.5
-50.0
107.5
67.5
-26.5
-31.375
24.75
34.0
24.25
21.0
-32.75
-64.625
34.625
24.0
-21.875
117.5
-120.0
105.0
147.5
23.875
-18.75
-29.125
33.75
26.75
-31.0
-39.375
-25.25
-267.5
-207.5
-26.75
-22.875
-35.75
30.625
-25.375
31.25
29.375
347.5
302.5
-150.0
-41.375
-24.375
45.5
-142.5
Query:
SELECT
    f.value:"Side"::STRING AS "Side",
    AVG(t."LastPx" - t."StrikePrice") AS "AvgIntrinsicValue"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") f
GROUP BY f.value:"Side"::STRING
LIMIT 1000
Answer:
Side,AvgIntrinsicValue
LONG,-0.0034340648059031117
SHORT,-0.023587507218392464
Query:
SELECT "TradeDate", COUNT(*) AS "TotalTrades"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
GROUP BY "TradeDate"
LIMIT 1000
Answer:
TradeDate,TotalTrades
2020-09-08,5550
2020-09-11,5525
2020-09-16,7508
2020-09-17,7400
2020-09-24,7143
2020-10-04,6644
2020-11-01,6690
2020-11-17,7090
2020-11-18,7163
2020-11-15,6457
2020-05-19,8735
2020-05-26,7411
2020-06-03,7400
2020-06-10,6089
2020-06-12,5575
2020-06-21,4449
2020-06-22,5467
2020-06-24,5472
2020-06-25,5525
2020-07-02,5398
2020-07-19,6744
2020-08-02,6704
2020-08-09,6695
2020-08-16,6727
2020-08-25,7910
2020-08-30,6729
2020-05-30,5457
2020-07-04,4340
2020-07-30,7894
2020-08-28,7804
2020-09-09,5731
2020-09-12,4339
2020-09-20,5667
2020-10-02,7135
2020-10-09,5965
2020-10-16,6219
2020-10-18,2966
2020-11-07,6614
2020-11-10,7256
2020-11-12,8186
2020-11-22,5560
2020-09-05,4340
2020-09-23,2887
2020-09-04,5478
2020-05-21,8724
2020-05-22,8542
2020-05-27,7448
2020-06-19,5620
2020-07-06,5425
2020-07-08,5412
2020-07-10,4176
2020-07-23,8101
2020-08-12,7906
2020-08-17,7868
2020-08-19,7701
2020-08-24,7898
2020-08-27,7856
2020-09-02,7707
2020-08-22,6562
2020-06-13,4329
2020-06-16,6336
2020-07-21,8065
2020-06-06,1105
2020-09-14,5405
2020-09-19,5415
2020-09-22,7438
2020-09-28,6804
2020-09-30,6118
2020-10-03,6579
2020-10-12,6116
2020-10-15,6098
2020-10-05,7180
2020-10-19,7906
2020-10-29,8224
2020-10-30,7850
2020-11-06,8154
2020-11-16,7030
2020-10-11,5523
2020-05-24,5774
2020-05-25,7335
2020-06-09,6017
2020-06-18,6073
2020-06-23,5439
2020-06-15,5313
2020-07-09,5335
2020-07-14,8066
2020-07-31,7772
2020-08-05,6846
2020-08-10,7893
2020-08-20,7881
2020-08-01,6573
2020-07-24,7924
2020-09-07,5464
2020-09-10,5584
2020-09-13,4489
2020-09-15,5920
2020-09-27,5598
2020-10-01,7114
2020-10-07,6083
2020-10-08,6093
2020-10-14,6088
2020-10-24,6607
2020-10-25,6809
2020-10-28,8484
2020-11-05,8232
2020-11-09,7150
2020-11-13,8116
2020-11-20,7034
2020-11-23,6837
2020-10-13,6076
2020-10-21,7631
2020-10-31,6608
2020-06-04,7393
2020-06-08,2051
2020-06-11,6287
2020-06-17,6197
2020-06-20,4403
2020-06-26,5264
2020-06-28,4431
2020-07-20,8041
2020-07-22,8072
2020-08-13,7858
2020-07-29,7860
2020-08-21,7751
2020-08-23,6717
2020-08-31,7889
2020-07-07,5316
2020-08-03,7910
2020-08-18,7343
2020-08-29,6585
2020-09-18,6868
2020-09-26,6229
2020-10-17,4447
2020-10-23,8504
2020-10-26,8582
2020-10-27,8797
2020-11-02,8231
2020-11-03,8007
2020-11-04,8187
2020-11-19,7111
2020-11-21,5477
2020-11-14,6612
2020-05-28,7312
2020-05-29,6901
2020-05-31,5660
2020-06-01,7452
2020-06-02,7617
2020-06-30,5343
2020-07-01,5415
2020-07-03,4980
2020-07-13,1401
2020-07-26,6634
2020-07-28,7251
2020-08-26,7750
2020-07-18,6576
2020-08-08,6593
2020-08-15,6592
2020-06-27,4310
2020-09-01,7946
2020-09-03,5742
2020-05-23,6593
2020-09-21,7181
2020-09-25,2310
2020-09-29,6259
2020-10-06,6542
2020-10-10,5454
2020-10-22,8121
2020-11-08,6462
2020-11-11,8198
2020-09-06,4469
2020-10-20,7610
2020-05-18,2353
2020-05-20,8658
2020-06-05,4285
2020-07-05,4441
2020-07-15,8095
2020-07-16,8137
2020-07-17,7911
2020-07-25,6638
2020-07-27,7196
2020-08-06,7669
2020-08-07,7774
2020-08-11,7755
2020-08-04,7774
2020-08-14,7760
2020-06-14,4396
2020-06-29,5449
2020-06-07,2260
Query:
SELECT
    t."Symbol",
    COUNT(*) AS "TradeCount"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t
GROUP BY t."Symbol"
LIMIT 1000
Answer:
Symbol,TradeCount
ESZ0,147993
BTCK0,24818
NQZ0,156552
ESU0,191463
BTCN0,60765
BTCU0,62066
NQU0,207415
BTCQ0,61347
NQM0,80200
BTCV0,69689
BTCZ0,56424
ESM0,65423
BTCM0,38407
Query:
SELECT
    t."OrderID",
    f.value:"Side"::STRING AS "Side",
    t."LastPx" AS "Price"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") f
LIMIT 1000
Answer:
Too long, hard cut:
OrderID,Side,Price
13d16468-0b06-49d3-9bdc-dc36502bf963,SHORT,11502.0
560a2490-86f4-4f9f-a621-956e413b3da5,SHORT,11502.0
77781b63-55ee-4f77-a4ca-a9ddb83489ec,SHORT,11502.0
41fa4ce5-13fc-4e01-827e-986bff0fdacb,SHORT,11502.0
b81b508f-f806-48d9-a394-226b1d959c6f,SHORT,11502.0
0e4b7434-0da6-480a-83a0-5481c3ca8a60,SHORT,11502.0
1e3c7ee7-601e-41fa-872d-84325cb11edf,SHORT,11502.0
64a1b69e-b7a2-4d2e-bfd3-a1d7d2b449e8,SHORT,11502.0
9374ad1d-06ac-4aaa-a675-65b8832bba4d,SHORT,11502.0
a265dc44-4d01-4e2f-8a8a-54ceca9e6ea8,SHORT,11502.0
f2399821-a835-4182-b169-1bd51774f966,SHORT,11502.0
fdc1fa4d-3494-415f-9985-ed684c6a0176,SHORT,11502.0
946d0d8b-e0d7-4473-83cc-db512467fe32,SHORT,11502.0
7805b66c-6df7-4d13-8936-fd41302d9c42,SHORT,11502.0
c19751d5-5838-4958-8f36-050f329231fe,SHORT,11502.0
091bbb71-05ba-4404-b180-1fc805b531e6,SHORT,11502.0
be539c12-3421-4108-b478-8d567a6c95c6,SHORT,11502.0
0c7ff41d-f686-4899-ab6b-bc10265b4019,SHORT,11502.0
3d4a8b57-3809-46a5-94c5-41a366876ee9,SHORT,11502.0
4b93afa3-ed9c-4b85-bcd2-084a2d27f36c,SHORT,11502.0
be06f275-15c5-464c-b9df-7c04052e8116,SHORT,11502.0
0ed10a65-39f7-454f-b7b1-e2c5a2335c5d,SHORT,11502.0
d2df7344-3b71-478f-ba76-0c47ea28a769,SHORT,11502.75
0a7e4430-86c5-46fb-bf32-d72248b646ac,SHORT,11525.0
6a9422e6-f9d7-40d8-a0e4-c79322cda30d,SHORT,11531.375
feb5cbc0-392c-41a3-8eb3-a7e6bcf8d71d,SHORT,11528.625
c6d587ee-4dcc-41f2-8b9a-126126e55a1b,SHORT,11528.25
798e2676-0c6c-4d6d-9e5d-2e98f24a1834,SHORT,11529.0
2fab1dd8-9136-4e2e-8fd0-87a9b8810009,SHORT,11570.375
5945c18f-2a32-4fb6-85a6-c52b08e00a3e,SHORT,11565.875
03ab2bb2-ad51-4f42-8a22-6f5f93ba9ce6,SHORT,11580.5
134170d2-4994-48ac-957c-2dc24c712950,SHORT,11580.75
665577db-637d-43de-86e2-c4ad01b5c574,SHORT,11571.375
2fdac4f6-2436-4117-b9dd-84026d8b8d59,SHORT,11564.625
aef124a0-07ad-4e1c-98b2-2bf80f1777b6,SHORT,11558.125
d0a9976f-5a16-4d24-a048-27cb0d1811be,SHORT,11552.75
4d57a765-7d23-45d1-ac2d-4039d32f5861,SHORT,11551.625
73ea42c7-8b6c-40f9-9a6c-7c61c1b49ab3,SHORT,11554.0
6501ebcd-56e2-427d-82fd-7e6596adcc48,SHORT,11554.375
fd5aaea4-f8e8-4041-a33e-34cf8c094f15,SHORT,11552.75
7511996a-893f-41a3-9d29-0d2219a372f8,SHORT,11544.625
71035bb1-1c1a-43bc-97cb-31445a6b9490,SHORT,11536.5
6b4bb844-26f3-43f4-96d9-dd02722f6334,SHORT,11536.25
4860dd01-82cf-4c47-a2cf-ac57dd0c98b2,SHORT,11537.375
051b9edc-e6e8-4042-bd4b-a861ccbf97d7,SHORT,11543.375
44c99b56-9abd-43f8-b2ce-6f58d361471a,SHORT,11540.75
11386d3c-2d1c-4355-bbed-e0b102c32fdd,SHORT,11536.5
75c8a1b1-50a5-4155-be79-e4908b0ed544,SHORT,11526.75
c7d71eed-90e0-43bf-ac69-8a43543f5d4d,SHORT,11530.125
1359b427-79ec-4793-b1c6-5b7c716f1193,SHORT,11541.0
e00bc0bc-5193-4f88-910a-e5d375f3c519,SHORT,11528.125
64158f64-12e4-4ef0-b026-8b7f2a1005f2,SHORT,11528.875
61365df8-e013-45cd-a119-541c3beca07a,SHORT,11541.75
306c8e2c-23df-4ac2-acf3-cecbb73828d6,SHORT,11535.5
ea1e0010-6176-4d35-ba49-a148da853035,SHORT,11533.125
697d85ea-0649-4f99-9d7d-2bd706fbc10a,SHORT,11533.375
be405dc1-8f4e-4bbd-b878-8bc1675f2794,SHORT,11537.625
5de10485-b3f0-4900-9d79-f301a3f40f73,SHORT,11563.0
aefa46b5-a519-43ac-90eb-4864adef54d9,SHORT,11564.0
33b4711c-4e38-40a8-93bc-bbf18bb99565,SHORT,11555.125
1a8c4985-88ee-4580-bfc4-8c68107ab007,SHORT,11558.875
bd76567f-b671-413d-a4f9-642a70785608,SHORT,11528.875
fb6f74c7-5c50-4328-b8d3-c92f555eac7b,SHORT,11528.875
f0cf085b-9c29-4ce8-a193-e841c6912b62,SHORT,11495.25
59a9df52-6604-45c7-91e3-26c6f343dde2,SHORT,11490.0
b9618b37-7ffc-4a1a-b766-28fa81a45c98,SHORT,11491.625
72fc943c-0037-40c3-8779-534be0dd5989,SHORT,11484.125
d0329db4-ebd2-4fa8-871d-57ff6441a3c4,SHORT,11486.75
22ca24f2-046a-4a08-add0-ed7c2220b3bd,SHORT,11486.375
38f2bd39-0360-4e43-a845-72d4f9adf6ee,SHORT,11490.5
7c2a1c1d-7efe-43b5-8946-9bee9824098d,SHORT,11485.875
6a613dbe-188a-4b3d-bcdf-6414cf9206a1,SHORT,11496.0
44958d40-c81e-4cb5-af35-1ab5e127a99c,SHORT,11495.25
bf7b6196-54b7-45a8-8bed-fa4dcca8da67,SHORT,11490.0
5039bae6-b7da-4d1a-9fe5-4eac02cd2839,SHORT,11490.625
650ffc6c-723d-4c52-9a7a-3490525e0f50,SHORT,11490.875
c454a260-5a26-4f87-8034-a23012772b48,SHORT,11500.125
90b225ab-016a-4bf4-891b-81714d3fbb80,SHORT,11499.125
c87f49c5-84a6-4725-a8be-b6fa47819292,SHORT,11501.0
14ae574d-c17b-4bb4-b9d3-0fe76c5d19b0,SHORT,11494.625
8e1f5b4e-b85b-4bc8-910d-a83d5939ac77,SHORT,11500.875
8dbf9d73-7dcf-4f05-80e5-14c10b28d029,SHORT,11505.75
7812ee5f-58e8-431b-b7c3-d07c67a355da,SHORT,11493.5
a44c79a0-ab79-40dc-8c36-b32ba07c39e0,SHORT,11500.75
7989ed5c-c62d-4934-a397-0201e92e7e00,SHORT,11500.625
58d37ed7-d986-401e-8b00-ec96db2fcaaf,SHORT,11504.625
da48b065-032a-41bb-8283-6a65e4c5d18d,SHORT,11512.25
da0f7e56-732e-4f4c-b670-68a14cc0bdab,SHORT,11527.625
1d2e8f77-52cd-48d1-bfcc-45c89fbaf1d6,SHORT,11518.75
d15b2c7f-a7f6-4458-89ee-372f992c6b38,SHORT,11545.625
c90bdf80-0bf0-4b9e-a110-dfe8be0c2e4f,SHORT,11562.875
c46539c9-4805-4028-b34f-f48dad321209,SHORT,11549.875
65b2e3a5-0c2c-4717-8665-0b92a0f8ed06,SHORT,11550.75
d63986d9-b858-49f7-9f4f-0a0328089431,SHORT,11550.375
4bcf2662-377e-4ee6-a978-7698c0e6633b,SHORT,11546.625
d8b58827-c43d-4e73-9b7c-efc29dd4ac40,SH
Query:
SELECT DISTINCT f.value:"Side"::STRING AS "SideType"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") f
LIMIT 1000
Answer:
SideType
SHORT
LONG
Query:
SELECT
    t."TradeDate",
    t."LastPx" - t."StrikePrice" AS "IntrinsicValue"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") f
WHERE f.value:"Side"::STRING = 'LONG'
LIMIT 1000
Answer:
Too long, hard cut:
TradeDate,IntrinsicValue
2020-05-18,2.25
2020-05-18,-0.5
2020-05-18,-1.75
2020-05-18,0.0
2020-05-18,0.0
2020-05-18,-0.5
2020-05-18,0.0
2020-05-18,-0.25
2020-05-18,2.25
2020-05-18,0.75
2020-05-18,0.25
2020-05-18,-0.25
2020-05-18,0.75
2020-05-18,-0.75
2020-05-18,-0.25
2020-05-18,0.0
2020-05-18,-0.25
2020-05-18,-0.5
2020-05-18,-0.25
2020-05-18,-0.5
2020-05-18,0.5
2020-05-18,0.25
2020-05-18,-1.0
2020-05-18,0.5
2020-05-18,0.5
2020-05-18,0.25
2020-05-18,0.25
2020-05-18,0.25
2020-05-19,-0.75
2020-05-19,-0.25
2020-05-19,0.875
2020-05-19,0.25
2020-05-19,-0.75
2020-05-19,-0.5
2020-05-19,-0.25
2020-05-19,0.875
2020-05-19,3.0
2020-05-19,1.75
2020-05-19,-0.25
2020-05-19,0.25
2020-05-19,0.0
2020-05-19,-0.75
2020-05-19,0.25
2020-05-19,1.5
2020-05-19,0.0
2020-05-19,0.0
2020-05-19,-0.625
2020-05-19,-0.5
2020-05-19,0.5
2020-05-19,-1.0
2020-05-19,0.875
2020-05-19,-0.5
2020-05-19,0.25
2020-05-19,0.25
2020-05-19,-0.25
2020-05-19,0.25
2020-05-19,1.0
2020-05-19,0.25
2020-05-19,-2.25
2020-05-19,-0.75
2020-05-19,1.0
2020-05-19,0.0
2020-05-19,-1.0
2020-05-19,1.25
2020-05-19,-0.75
2020-05-19,-0.75
2020-05-19,-1.75
2020-05-19,1.25
2020-05-19,1.5
2020-05-19,3.0
2020-05-19,-1.75
2020-05-19,2.25
2020-05-19,-1.25
2020-05-19,-2.5
2020-05-19,1.0
2020-05-19,0.75
2020-05-19,2.0
2020-05-19,0.5
2020-05-19,0.25
2020-05-19,1.0
2020-05-19,-2.0
2020-05-19,1.5
2020-05-19,0.25
2020-05-19,0.5
2020-05-19,-2.625
2020-05-19,-0.25
2020-05-19,-0.5
2020-05-19,-0.75
2020-05-19,1.0
2020-05-19,-2.625
2020-05-19,-0.25
2020-05-19,-1.0
2020-05-19,-0.25
2020-05-19,-0.25
2020-05-19,0.0
2020-05-19,0.5
2020-05-19,-0.25
2020-05-19,-0.5
2020-05-19,0.75
2020-05-19,0.0
2020-05-19,-0.75
2020-05-19,-0.5
2020-05-19,-1.0
2020-05-19,-0.75
2020-05-19,-1.0
2020-05-19,-1.5
2020-05-19,1.5
2020-05-19,0.5
2020-05-19,2.25
2020-05-19,1.25
2020-05-19,-0.75
2020-05-19,0.5
2020-05-19,-0.5
2020-05-19,0.25
2020-05-19,-1.25
2020-05-19,-0.875
2020-05-19,0.0
2020-05-19,-0.5
2020-05-19,0.75
2020-05-19,1.5
2020-05-19,-0.75
2020-05-19,0.75
2020-05-19,0.25
2020-05-19,-0.25
2020-05-19,-1.0
2020-05-19,0.0
2020-05-19,-0.5
2020-05-19,0.25
2020-05-19,0.0
2020-05-19,-0.25
2020-05-19,1.5
2020-05-19,0.0
2020-05-19,-0.25
2020-05-19,-7.25
2020-05-19,0.0
2020-05-19,-1.25
2020-05-19,-1.0
2020-05-19,0.25
2020-05-19,0.0
2020-05-19,0.0
2020-05-19,0.0
2020-05-19,-0.25
2020-05-19,0.0
2020-05-19,0.0
2020-05-19,-0.25
2020-05-19,1.125
2020-05-19,-0.75
2020-05-19,-1.125
2020-05-19,-2.5
2020-05-19,-0.5
2020-05-19,-0.25
2020-05-19,0.25
2020-05-19,0.75
2020-05-19,-1.5
2020-05-19,0.5
2020-05-19,-0.25
2020-05-20,-0.25
2020-05-20,-1.75
2020-05-20,-1.25
2020-05-20,1.0
2020-05-20,-0.75
2020-05-20,0.875
2020-05-20,-0.25
2020-05-20,-1.0
2020-05-20,-0.25
2020-05-20,0.5
2020-05-20,0.0
2020-05-20,-0.25
2020-05-20,0.25
2020-05-20,1.0
2020-05-20,0.0
2020-05-20,-1.0
2020-05-20,0.625
2020-05-20,-0.5
2020-05-20,0.5
2020-05-20,-0.25
2020-05-20,0.0
2020-05-20,0.25
2020-05-20,-0.125
2020-05-20,0.125
2020-05-20,-0.25
2020-05-20,-2.0
2020-05-20,0.0
2020-05-20,0.125
2020-05-20,-1.0
2020-05-20,0.25
2020-05-20,-0.25
2020-05-20,0.5
2020-05-20,0.625
2020-05-20,-0.5
2020-05-20,-0.25
2020-05-20,0.0
2020-05-20,1.0
2020-05-20,0.75
2020-05-20,-0.25
2020-05-20,-0.25
2020-05-20,-1.0
2020-05-20,1.25
2020-05-20,-0.25
2020-05-20,0.75
2020-05-20,-0.125
2020-05-20,0.375
2020-05-20,0.75
2020-05-20,-0.25
2020-05-20,0.5
2020-05-20,0.125
2020-05-20,-2.375
2020-05-20,-1.5
2020-05-20,-1.0
2020-05-20,-5.0
2020-05-20,0.5
2020-05-20,-2.0
2020-05-20,-1.5
2020-05-20,0.5
2020-05-20,-0.5
2020-05-20,0.25
2020-05-20,-0.75
2020-05-20,0.25
2020-05-20,-0.75
2020-05-20,-0.25
2020-05-20,-0.625
2020-05-20,-0.75
2020-05-20,0.0
2020-05-20,0.5
2020-05-20,0.0
2020-05-20,-1.5
2020-05-20,1.0
2020-05-20,0.0
2020-05-20,-1.25
2020-05-20,0.0
2020-05-20,0.0
2020-05-20,0.5
2020-05-20,0.25
2020-05-20,0.75
2020-05-20,0.5
2020-05-20,1.0
2020-05-20,-0.75
2020-05-20,0.75
2020-05-20,-1.0
2020-05-20,1.25
2020-05-20,-0.75
2020-05-20,-0.5
2020-05-20,0.0
2020-05-20,0.0
2020-05-20,0.5
2020-05-20,0.25
2020-05-20,-0.5
2020-05-20,1.25
2020-05-20,-1.0
2020-05-20,0.5
2020-05-20,-0.5
2020-05-20,0.0
2020-05-20,-0.25
2020-05-20,-2.75
2020-05-20,0.0
2020-05-20,1.0
2020-05-18,-1.0
2020-05-18,0.25
2020-05-18,-1.5
2020-05-18,-0.75
2020-05-18,0.5
2020-05-18,0.0
2020-05-18,2.25
2020-05-18,0.25
2020-05-18,-0.25
2020-05-18,-0.5
2020-05-18,0.5
2020-05-18,0.5
2020-05-18,0.0
2020-05-18,1.0
2020-05-18,-1.5
2020-05-18,0.5
2020-05-18,1.0
2020-05-18,-1.0
2020-05-18,0.0
2020-05-18,0.0
2020-05-18,0.0
2020-05-18,0.375
2020-05-18,-0.25
2020-05-18,-0.5
2020-05-18,-0.75
2020-05-18,0.0
2020-05-18,-0.75
2020-05-18,-0.375
2020-05-18,0.5
2020-05-18,-0.75
2020-05-18,0.5
2020-05-18,0.0
2020-05-18,0.25
2020-05-18,0.875
2020-05-18,0.5
2020-05-18,0.75
2020-05-18,-0.125
2020-05-18,-1.25
2020-05-18,0.0
2020-05-18,0.0
2020-05-18,0.0
2020-05-18,-0.75
2020-05-19,0.75
2020-05-19,1.25
2020-05-19,-1.25
2020-05-19,0.0
2020-05-19,2.5
2020-05-19,-0.5
2020-05-19,-1.375
2020-05-19,0.25
2020-05-19,-0.25
2020-05-19,-0.25
2020-05-19,0.25
2020-05-19,-0
Query:
SELECT t."OrderID", t."StrikePrice", t."LastPx" AS "LastPrice"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t
LIMIT 1000
Answer:
Too long, hard cut:
OrderID,StrikePrice,LastPrice
d8eefa63-6f10-4566-8f15-81460448f2ac,2953.125,2953.125
7fa78bef-912c-41cb-b381-4c03b5a7c508,2952.375,2952.375
5a4c4d8b-b9b8-4307-a0c3-8c753ed93520,2952.625,2953.375
a204ef77-1071-48ee-a5f5-21579311cd91,2953.125,2952.625
b7a40778-7293-407b-8636-91a7ffe9817a,2952.375,2953.625
c67a3f6a-7253-4ec8-91be-a4a3f07aa27b,2952.375,2953.125
83e09901-1182-4ad0-b423-0f92bf78a7a2,2953.875,2955.375
8161e8ff-9aa3-4e27-9322-363a4a063a27,2953.625,2953.875
2e2c0922-e696-44f6-899e-9112f6129088,2953.125,2953.625
8afcaa49-daca-470f-9479-6bfd2c648ccf,2952.125,2952.625
4e25aae7-5b30-408a-a23e-ea3afb86c445,2951.125,2952.625
048dab46-3718-4dd2-b12e-709ce317c069,2955.625,2955.125
0e00e452-329b-44df-90a5-902b7e737608,2955.375,2956.875
ae17c30f-0689-4013-8485-05f5eb5f7721,2955.375,2954.375
3a9010bf-80a3-46aa-ae04-afd4b1f39e1a,2954.625,2953.625
5880746a-b864-46b5-8204-060bbe7104a4,2952.875,2952.875
68bf4c18-8084-435b-8786-2ae9b104339e,2954.375,2954.375
0fe87fac-d58a-4bb9-8552-c1e58d91bb82,2957.625,2956.875
94641ac8-057f-4f66-ba2f-81edc252bbcf,2959.375,2958.625
dd4279ad-7a00-4c6f-b26f-0f98aff69aed,2960.375,2958.875
1f0ab9f6-7171-4b0c-a2bd-b61787f165b1,2961.125,2960.125
416c6876-0548-4ea1-b8a6-6b19faca54fc,2961.125,2961.875
02d3b3ec-e025-412a-b53e-53fd8f805f11,2948.5,2948.5
d5b05f8d-eacf-4a34-ae2f-c941d28df7be,2945.875,2946.375
24d610a1-88c7-4cf9-998f-8718b84e2b62,2945.375,2946.125
f52dc7f7-3b0a-4056-827b-e9a8c4224317,2945.375,2944.875
3ab867aa-821f-4ec4-80dc-60e8a0bcf354,2945.625,2945.625
18e91378-d1fa-4d56-a1cd-b27121387413,2946.625,2947.125
88d9d75c-d6b7-43bd-8545-df39e9f273c4,2949.125,2949.125
b6a97240-f7a2-4fcc-af61-e5ffc4d75d2a,2951.625,2951.125
41d4e6b5-c613-4675-96e5-8e6063386673,2952.875,2953.125
e5b35941-b7e3-4d9d-801b-f6ac65323e88,2952.125,2951.875
e93153ae-70f8-4602-a719-1d1abd75e9be,2948.625,2947.625
f9c32f86-511b-4a4a-9aa0-f762006a586f,2949.625,2949.375
94e09d1d-877e-4fbb-9be3-364d960577ad,2952.625,2951.875
497c97b4-f2fb-4be6-ad24-9f9e5546bfa0,2951.875,2952.375
0157053c-746e-406f-abc2-6b1f9bc62ae6,2950.125,2950.625
56abca1f-5414-4a66-b431-e59046936355,2950.375,2949.875
2d19f341-9f61-4c27-8bf6-b8ade6ba71f8,2946.875,2945.625
c75e3f77-7307-4de6-941e-d9cf75cb100e,2948.875,2946.625
3fbb2eeb-10ac-4781-9231-28d422db11b3,2947.625,2947.375
2b3dc23e-a437-4043-b5ee-969f9619bd88,2945.375,2944.875
0af6d51f-c835-48e8-9a92-5a0964659acf,2943.875,2943.875
ab9d61e3-062b-4399-88e9-11e4efced08c,2946.125,2945.375
baf8e745-9e0b-4c04-b19d-6710bb1f735c,2942.875,2945.125
a3442000-1e3c-431b-a47a-3e2b77d976b7,2939.625,2939.875
824fa119-2a12-4e7c-ae8f-2e8d6a4e4fa0,2941.375,2940.625
e936da46-4ed7-4b63-831a-2b7899ad3128,2940.375,2941.125
4d3106b8-e576-4a1d-be03-22131581df01,2940.875,2940.125
f87055ed-fd64-4348-8f0b-7c67d7579c29,2940.625,2941.375
ddb26ae8-e4ab-471b-bc06-e74b4e761795,2942.625,2941.875
861d684d-4a02-403c-a475-357fa889aaa3,2941.875,2943.125
39f4ee8e-781b-4a01-9679-97ffd40e39ee,2941.375,2941.375
08367e10-4c05-471f-84ec-2c2a075f1681,2942.125,2941.375
127ddd6f-93fb-46b5-a39c-1b5b6a1b0be1,2936.875,2936.875
e8b5cc7e-e869-4e8f-9283-c8358b9f7300,2936.375,2937.375
4522704f-d2a3-44a7-bb6f-a7d709df8df9,2937.5,2936.875
b1fa25d4-9786-4002-a9dc-729c5b40be2c,2937.625,2938.125
94509fdd-4b95-404a-a9af-7258bba2b1d4,2937.625,2937.625
176dabfe-8db3-4840-82ab-132ecae1cc53,2939.875,2939.125
262c0482-fb54-4367-a8bc-dc45208d9692,2938.875,2939.625
4f0201f8-367a-42a8-88b2-f4d1144edfd7,2943.375,2941.375
8266205a-e3ac-43da-9733-10713852308c,2945.375,2945.625
cab452ae-6a5d-4ac7-a1e9-5e877088acf2,2947.875,2946.875
63276372-545b-4ed7-95a3-24dd5f9ad505,2946.375,2947.625
338c1f98-7fbf-4726-94a8-845a17d630c8,2946.375,2946.375
28cf600f-0f6c-4335-8e7c-c0646236912c,2946.875,2946.625
aaa93d25-5efc-457c-bcf0-7d4d9063a83c,2946.625,2945.875
467b9488-998c-4e5a-8f08-c4d8bcc3dff3,2948.875,2949.125
d6e38690-238f-4b18-98c6-999971593967,2950.5,2950.5
757ddea5-aee0-4f4c-b784-502ff88018af,2947.125,2946.875
8a661be5-3185-4abe-b897-cdf7e1bb1d86,2948.5,2948.875
51e70637-6b45-4d99-a726-36ae9b651761,2947.625,2948.625
375912c0-dae4-43a0-87db-55f3c3b7cf3a,2947.125,2947.125
7975e9c9-27f8-4b27-b137-7f5a2b190493,2946.875,2946.125
d9cbea5c-0e32-4089-84fc-d259d9b5d0b9,2946.625,2946.875
8ecf434f-5a91-496c-b4b5-bca361c1077b,2950.625,2949.375
452c4d1e-0d7e-4265-98e3-b84a13e85840,2957.5,2955.625
f11eb609-5a4a-45b5-bdc3-79f4274c80e9,2957.625,2958.625
22637dff-9b81-4db0-ad64-53cd88e2c996,2961.125,2957.875
9a341b8b-b217-479f-8446-df1ec7cd8695,2959.625,2959.875
3d03b0b9-8a7c-4f26-898e-767f5c41921c,2961.125,2961.375
6e2e4160-f024-497d-9d74-eb1d47dc988d,2966.875,2967.875
dff99cc9-90ea-4d32-ac73-0357e2be16ee,2970.375,2967.125
0a388c74-525e-4e92-910c-3bbc37abf2d1,2972.875,2972.125
04988554-4170-4e90-9572-702f1724d576,2968.0,2973.625
63458d12-9ac9-4eb2-964b-94b06eca1e6e,2955.375,2955.625
3a85f81e-4247-4483-b5e6-5275a71f7bca,2950.875,2950.625
1c1533da-c5d5-42d8-8305-545ef6b6905f,2937.375,2937.375
0aa6c545-fd39-4da5-9e8a-3e0e7bb65424,2941.125,2940.625
8beae55e-c7a2-4e4d-a7b7-4fb4c55cd857
Query:
SELECT
    t."Symbol",
    f.value:"Side"::STRING AS "Side",
    AVG(t."LastPx" - t."StrikePrice") AS "AvgIntrinsicValue"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") f
WHERE f.value:"Side"::STRING = 'LONG'
GROUP BY t."Symbol", f.value:"Side"::STRING
LIMIT 1000
Answer:
Symbol,Side,AvgIntrinsicValue
ESM0,LONG,-0.005999766388729155
BTCK0,LONG,0.13270477955201918
BTCU0,LONG,0.06655014788921754
NQZ0,LONG,0.004765389351942744
NQM0,LONG,-0.008536225583056428
NQU0,LONG,-0.02486461542637658
BTCN0,LONG,-0.010484057909931933
BTCV0,LONG,-0.025685592893008882
BTCQ0,LONG,-0.003773048404383298
ESZ0,LONG,-0.007529098854860641
BTCM0,LONG,0.052361954846314264
BTCZ0,LONG,-0.11724510864221807
ESU0,LONG,6.515846538782318e-05
End Exploring Related Columns
Task: How much higher the average intrinsic value is for trades using the feeling-lucky strategy compared to those using the momentum strategy under long-side trades?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
higher
value:float > 0
```

The average intrinsic value for trades using the feeling-lucky strategy is higher than those using the momentum strategy under long-side trades by a positive amount..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'CYMBAL_INVESTMENTS': {'CYMBAL_INVESTMENTS': ['TRADE_CAPTURE_REPORT']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
You need to follow the format's positive and negative signs.

2025-01-20 00:43:16 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 00:43:16 - root - INFO - ```sql
SELECT
  ROUND(
    (
      SELECT AVG(t."LastPx" - t."StrikePrice")
      FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
           LATERAL FLATTEN(input => t."Sides") f,
           LATERAL FLATTEN(input => f.value:"PartyIDs") pid
      WHERE f.value:"Side"::STRING = 'LONG'
        AND pid.value:"PartyRole"::STRING = 'INITIATING TRADER'
        AND pid.value:"PartyIDSource"::STRING = 'PROP CODE'
        AND pid.value:"PartyID"::STRING LIKE 'LUCKY%'
    ) -
    (
      SELECT AVG(t."LastPx" - t."StrikePrice")
      FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
           LATERAL FLATTEN(input => t."Sides") f,
           LATERAL FLATTEN(input => f.value:"PartyIDs") pid
      WHERE f.value:"Side"::STRING = 'LONG'
        AND pid.value:"PartyRole"::STRING = 'INITIATING TRADER'
        AND pid.value:"PartyIDSource"::STRING = 'PROP CODE'
        AND pid.value:"PartyID"::STRING LIKE 'MOMO%'
    )
  , 4) AS "higher";
```
2025-01-20 00:43:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:43:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:43:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:43:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 00:43:18 - snowflake.connector.connection - INFO - closed
2025-01-20 00:43:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:43:18 - root - INFO - itercount: 1
2025-01-20 00:43:18 - root - INFO - 0
2025-01-20 00:43:18 - root - INFO - results: 
higher
-0.0231


2025-01-20 00:43:18 - root - INFO - Please check the answer again by reviewing How much higher the average intrinsic value is for trades using the feeling-lucky strategy compared to those using the momentum strategy under long-side trades?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
higher
value:float > 0
```

The average intrinsic value for trades using the feeling-lucky strategy is higher than those using the momentum strategy under long-side trades by a positive amount. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
higher
-0.0231
Current sql:
SELECT
  ROUND(
    (
      SELECT AVG(t."LastPx" - t."StrikePrice")
      FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
           LATERAL FLATTEN(input => t."Sides") f,
           LATERAL FLATTEN(input => f.value:"PartyIDs") pid
      WHERE f.value:"Side"::STRING = 'LONG'
        AND pid.value:"PartyRole"::STRING = 'INITIATING TRADER'
        AND pid.value:"PartyIDSource"::STRING = 'PROP CODE'
        AND pid.value:"PartyID"::STRING LIKE 'LUCKY%'
    ) -
    (
      SELECT AVG(t."LastPx" - t."StrikePrice")
      FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
           LATERAL FLATTEN(input => t."Sides") f,
           LATERAL FLATTEN(input => f.value:"PartyIDs") pid
      WHERE f.value:"Side"::STRING = 'LONG'
        AND pid.value:"PartyRole"::STRING = 'INITIATING TRADER'
        AND pid.value:"PartyIDSource"::STRING = 'PROP CODE'
        AND pid.value:"PartyID"::STRING LIKE 'MOMO%'
    )
  , 4) AS "higher";
2025-01-20 00:44:20 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 00:44:20 - root - INFO - ```sql
SELECT
  ROUND(
    (
      SELECT AVG(t."LastPx" - t."StrikePrice")
      FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
           LATERAL FLATTEN(input => t."Sides") f,
           LATERAL FLATTEN(input => f.value:"PartyIDs") pid
      WHERE f.value:"Side"::STRING = 'LONG'
        AND pid.value:"PartyRole"::STRING = 'INITIATING TRADER'
        AND pid.value:"PartyIDSource"::STRING = 'PROP CODE'
        AND pid.value:"PartyID"::STRING LIKE 'LUCKY%'
    ) -
    (
      SELECT AVG(t."LastPx" - t."StrikePrice")
      FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
           LATERAL FLATTEN(input => t."Sides") f,
           LATERAL FLATTEN(input => f.value:"PartyIDs") pid
      WHERE f.value:"Side"::STRING = 'LONG'
        AND pid.value:"PartyRole"::STRING = 'INITIATING TRADER'
        AND pid.value:"PartyIDSource"::STRING = 'PROP CODE'
        AND pid.value:"PartyID"::STRING LIKE 'MOMO%'
    )
  , 4) AS "higher";
```
2025-01-20 00:44:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:44:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:44:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:44:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 00:44:22 - snowflake.connector.connection - INFO - closed
2025-01-20 00:44:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:44:22 - root - INFO - itercount: 2
2025-01-20 00:44:22 - root - INFO - 0
2025-01-20 00:44:22 - root - INFO - Total iteration counts: 2
