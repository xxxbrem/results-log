2025-01-20 00:35:07 - openai._base_client - INFO - Retrying request to /chat/completions in 0.480533 seconds
2025-01-20 00:36:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 00:36:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:36:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:36:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:36:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 426
2025-01-20 00:36:25 - snowflake.connector.connection - INFO - closed
2025-01-20 00:36:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:36:25 - root - INFO - SQL:
-- 1. Retrieve distinct values from the "Sides" column to understand its structure
SELECT DISTINCT "Sides"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
LIMIT 1000
Results:
Too long, hard cut:
Sides
"[
  {
    ""OrderID"": ""7805b66c-6df7-4d13-8936-fd41302d9c42"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""0ed10a65-39f7-454f-b7b1-e2c5a2335c5d"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""c6d587ee-4dcc-41f2-8b9a-126126e55a1b"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""4860dd01-82cf-4c47-a2cf-ac57dd0c98b2"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""75c8a1b1-50a5-4155-be79-e4908b0ed544"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""e00bc0bc-5193-4f88-910a-e5d375f3c519"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""bd76567f-b671-413d-a4f9-642a70785608"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""fb6f74c7-5c50-4328-b8d3-c92f555eac7b"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""8e1f5b4e-b85b-4bc8-910d-a83d5939ac77"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""86c89d01-ea2d-4139-acb1-7801a4ff7045"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""473b0975-ef33-4175-97e8-b6cc4097c377"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""73ea42c7-8b6c-40f9-9a6c-7c61c1b49ab3"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""051b9edc-e6e8-4042-bd4b-a861ccbf97d7"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""da0f7e56-732e-4f4c-b670-68a14cc0bdab"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""36a1ee37-e27c-445e-8e97-18d49ca03534"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""d8bbbbef-5761-4d88-94cd-30b75726eed3"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""646d233a-a9bb-4f2f-a2f8-8805ec43c3a9"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""9266931f-e68b-4561-bcf9-ccd06e9cd56a"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""8294f311-5917-454b-87f4-6d57c3db7817"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }


2025-01-20 00:36:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:36:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:36:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:36:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 464
2025-01-20 00:36:28 - snowflake.connector.connection - INFO - closed
2025-01-20 00:36:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:36:28 - root - INFO - SQL:
-- 2. View sample "Sides" data to inspect its content
SELECT "Sides"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
LIMIT 1000
Results:
Too long, hard cut:
Sides
"[
  {
    ""OrderID"": ""d8eefa63-6f10-4566-8f15-81460448f2ac"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""7fa78bef-912c-41cb-b381-4c03b5a7c508"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""5a4c4d8b-b9b8-4307-a0c3-8c753ed93520"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""a204ef77-1071-48ee-a5f5-21579311cd91"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""b7a40778-7293-407b-8636-91a7ffe9817a"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""c67a3f6a-7253-4ec8-91be-a4a3f07aa27b"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""83e09901-1182-4ad0-b423-0f92bf78a7a2"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""8161e8ff-9aa3-4e27-9322-363a4a063a27"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""2e2c0922-e696-44f6-899e-9112f6129088"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""8afcaa49-daca-470f-9479-6bfd2c648ccf"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""4e25aae7-5b30-408a-a23e-ea3afb86c445"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""048dab46-3718-4dd2-b12e-709ce317c069"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""0e00e452-329b-44df-90a5-902b7e737608"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""ae17c30f-0689-4013-8485-05f5eb5f7721"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""3a9010bf-80a3-46aa-ae04-afd4b1f39e1a"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""5880746a-b864-46b5-8204-060bbe7104a4"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""68bf4c18-8084-435b-8786-2ae9b104339e"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""0fe87fac-d58a-4bb9-8552-c1e58d91bb82"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""94641ac8-057f-4f66-ba2f-81edc252bbcf"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""dd4279ad-7a00-4c6f-b26f-0f98aff69aed"",
    ""P

2025-01-20 00:36:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:36:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:36:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:36:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 475
2025-01-20 00:36:31 - snowflake.connector.connection - INFO - closed
2025-01-20 00:36:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:36:31 - root - INFO - SQL:
-- 3. Flatten the "Sides" column to extract individual elements
SELECT s.value
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") s
LIMIT 1000
Results:
Too long, hard cut:
VALUE
"{
  ""OrderID"": ""13d16468-0b06-49d3-9bdc-dc36502bf963"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""560a2490-86f4-4f9f-a621-956e413b3da5"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""77781b63-55ee-4f77-a4ca-a9ddb83489ec"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""41fa4ce5-13fc-4e01-827e-986bff0fdacb"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""b81b508f-f806-48d9-a394-226b1d959c6f"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""0e4b7434-0da6-480a-83a0-5481c3ca8a60"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""1e3c7ee7-601e-41fa-872d-84325cb11edf"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""64a1b69e-b7a2-4d2e-bfd3-a1d7d2b449e8"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""9374ad1d-06ac-4aaa-a675-65b8832bba4d"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""a265dc44-4d01-4e2f-8a8a-54ceca9e6ea8"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""f2399821-a835-4182-b169-1bd51774f966"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""fdc1fa4d-3494-415f-9985-ed684c6a0176"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""946d0d8b-e0d7-4473-83cc-db512467fe32"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""7805b66c-6df7-4d13-8936-fd41302d9c42"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""c19751d5-5838-4958-8f36-050f329231fe"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""091bbb71-05ba-4404-b180-1fc805b531e6"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""be539c12-3421-4108-b478-8d567a6c95c6"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""0c7ff41d-f686-4899-ab6b-bc10265b4019"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""3d4a8b57-3809-46a5-94c5-41a366876ee9"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""4b93afa3-ed9c-4b85-bcd2-084a2d27f36c"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""be06f275-15c5-464c-b9df-7c04052e8116"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"":

2025-01-20 00:36:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:36:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:36:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:36:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 00:36:33 - snowflake.connector.connection - INFO - closed
2025-01-20 00:36:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:36:33 - root - INFO - SQL:
-- 4. Extract the "Side" field from the "Sides" JSON data
SELECT s.value:"Side"::STRING AS "Side"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") s
LIMIT 1000
Results:
Too long, hard cut:
Side
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHO

2025-01-20 00:36:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:36:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:36:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:36:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 00:36:34 - snowflake.connector.connection - INFO - closed
2025-01-20 00:36:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:37:27 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 00:37:27 - root - INFO - ```sql
SELECT
    (AVG(CASE WHEN s.value:"PartyIDs"[0]:"PartyID"::STRING = 'PREDICTNQ' THEN ("LastPx" - "StrikePrice") END) -
     AVG(CASE WHEN s.value:"PartyIDs"[0]:"PartyID"::STRING = 'MOMOES' THEN ("LastPx" - "StrikePrice") END)) AS "higher"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") s
WHERE s.value:"Side"::STRING = 'LONG'
  AND s.value:"PartyIDs"[0]:"PartyID"::STRING IN ('PREDICTNQ', 'MOMOES');
```
2025-01-20 00:37:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:37:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:37:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:37:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 00:37:29 - snowflake.connector.connection - INFO - closed
2025-01-20 00:37:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:38:20 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 00:38:20 - root - INFO - SQL:
SELECT
    (AVG(CASE WHEN s.value:"PartyIDs"[0]:"PartyID"::STRING = 'PREDICTNQ' THEN ("LastPx" - "StrikePrice") END) -
     AVG(CASE WHEN s.value:"PartyIDs"[0]:"PartyID"::STRING = 'MOMOES' THEN ("LastPx" - "StrikePrice") END)) AS "higher"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") s
WHERE s.value:"Side"::STRING = 'LONG'
  AND s.value:"PartyIDs"[0]:"PartyID"::STRING IN ('PREDICTNQ', 'MOMOES');
Results:
higher
-0.396824672099944

2025-01-20 00:38:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:38:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:38:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:38:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 9
2025-01-20 00:38:22 - snowflake.connector.connection - INFO - closed
2025-01-20 00:38:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:38:23 - root - INFO - SQL:
-- 6. Retrieve distinct strategies used in trades
SELECT DISTINCT s.value:"PartyIDs"[0]:"PartyID"::STRING AS "Strategy"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") s
WHERE s.value:"PartyIDs"[0]:"PartyID"::STRING IS NOT NULL
LIMIT 1000
Results:
Strategy
LUCKYBTC
PREDICTES
LUCKYES
MOMOBTC
MOMONQ
PREDICTBTC
PREDICTNQ
MOMOES
LUCKYNQ

2025-01-20 00:38:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:38:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:38:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:38:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 00:38:24 - snowflake.connector.connection - INFO - closed
2025-01-20 00:38:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:38:24 - root - INFO - SQL:
-- 7. Calculate the intrinsic value for trades
SELECT "StrikePrice",
       "LastPx",
       ("LastPx" - "StrikePrice") AS "IntrinsicValue"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
WHERE "StrikePrice" IS NOT NULL AND "LastPx" IS NOT NULL
LIMIT 1000
Results:
Too long, hard cut:
StrikePrice,LastPx,IntrinsicValue
2953.125,2953.125,0.0
2952.375,2952.375,0.0
2952.625,2953.375,0.75
2953.125,2952.625,-0.5
2952.375,2953.625,1.25
2952.375,2953.125,0.75
2953.875,2955.375,1.5
2953.625,2953.875,0.25
2953.125,2953.625,0.5
2952.125,2952.625,0.5
2951.125,2952.625,1.5
2955.625,2955.125,-0.5
2955.375,2956.875,1.5
2955.375,2954.375,-1.0
2954.625,2953.625,-1.0
2952.875,2952.875,0.0
2954.375,2954.375,0.0
2957.625,2956.875,-0.75
2959.375,2958.625,-0.75
2960.375,2958.875,-1.5
2961.125,2960.125,-1.0
2961.125,2961.875,0.75
2948.5,2948.5,0.0
2945.875,2946.375,0.5
2945.375,2946.125,0.75
2945.375,2944.875,-0.5
2945.625,2945.625,0.0
2946.625,2947.125,0.5
2949.125,2949.125,0.0
2951.625,2951.125,-0.5
2952.875,2953.125,0.25
2952.125,2951.875,-0.25
2948.625,2947.625,-1.0
2949.625,2949.375,-0.25
2952.625,2951.875,-0.75
2951.875,2952.375,0.5
2950.125,2950.625,0.5
2950.375,2949.875,-0.5
2946.875,2945.625,-1.25
2948.875,2946.625,-2.25
2947.625,2947.375,-0.25
2945.375,2944.875,-0.5
2943.875,2943.875,0.0
2946.125,2945.375,-0.75
2942.875,2945.125,2.25
2939.625,2939.875,0.25
2941.375,2940.625,-0.75
2940.375,2941.125,0.75
2940.875,2940.125,-0.75
2940.625,2941.375,0.75
2942.625,2941.875,-0.75
2941.875,2943.125,1.25
2941.375,2941.375,0.0
2942.125,2941.375,-0.75
2936.875,2936.875,0.0
2936.375,2937.375,1.0
2937.5,2936.875,-0.625
2937.625,2938.125,0.5
2937.625,2937.625,0.0
2939.875,2939.125,-0.75
2938.875,2939.625,0.75
2943.375,2941.375,-2.0
2945.375,2945.625,0.25
2947.875,2946.875,-1.0
2946.375,2947.625,1.25
2946.375,2946.375,0.0
2946.875,2946.625,-0.25
2946.625,2945.875,-0.75
2948.875,2949.125,0.25
2950.5,2950.5,0.0
2947.125,2946.875,-0.25
2948.5,2948.875,0.375
2947.625,2948.625,1.0
2947.125,2947.125,0.0
2946.875,2946.125,-0.75
2946.625,2946.875,0.25
2950.625,2949.375,-1.25
2957.5,2955.625,-1.875
2957.625,2958.625,1.0
2961.125,2957.875,-3.25
2959.625,2959.875,0.25
2961.125,2961.375,0.25
2966.875,2967.875,1.0
2970.375,2967.125,-3.25
2972.875,2972.125,-0.75
2968.0,2973.625,5.625
2955.375,2955.625,0.25
2950.875,2950.625,-0.25
2937.375,2937.375,0.0
2941.125,2940.625,-0.5
2942.0,2942.125,0.125
2943.375,2940.875,-2.5
2942.125,2943.125,1.0
2938.625,2940.625,2.0
2936.625,2936.625,0.0
2937.125,2936.875,-0.25
2939.875,2939.375,-0.5
2940.375,2940.375,0.0
2938.875,2941.375,2.5
2938.75,2940.25,1.5
2934.625,2934.375,-0.25
2933.875,2933.125,-0.75
2934.375,2934.125,-0.25
2934.625,2934.875,0.25
2938.875,2938.625,-0.25
2938.625,2938.375,-0.25
2941.625,2941.375,-0.25
2941.75,2942.125,0.375
2945.375,2946.0,0.625
2945.375,2944.625,-0.75
2946.125,2945.875,-0.25
2938.625,2937.375,-1.25
2939.125,2938.125,-1.0
2943.375,2943.875,0.5
2942.875,2942.875,0.0
2940.625,2940.625,0.0
2940.125,2939.125,-1.0
2937.375,2939.625,2.25
2941.125,2936.375,-4.75
2942.125,2943.125,1.0
2943.375,2942.375,-1.0
2944.625,2944.125,-0.5
2946.125,2946.625,0.5
2947.875,2946.125,-1.75
2940.875,2940.625,-0.25
2948.875,2948.375,-0.5
2949.375,2949.875,0.5
2951.125,2950.625,-0.5
2950.875,2951.875,1.0
2953.875,2954.125,0.25
2952.375,2954.625,2.25
2950.625,2951.875,1.25
2948.875,2949.625,0.75
2944.625,2946.625,2.0
2947.375,2947.125,-0.25
2948.875,2948.625,-0.25
2949.375,2948.125,-1.25
2948.625,2948.125,-0.5
2948.125,2949.375,1.25
2950.875,2950.625,-0.25
2951.875,2951.625,-0.25
2952.625,2952.125,-0.5
2952.875,2952.375,-0.5
2952.375,2952.875,0.5
2951.875,2952.625,0.75
2953.875,2952.625,-1.25
2955.875,2955.625,-0.25
2954.875,2954.875,0.0
2954.625,2954.625,0.0
2954.875,2954.875,0.0
2955.375,2955.375,0.0
2955.375,2955.375,0.0
2955.625,2955.375,-0.25
2942.625,2941.625,-1.0
2943.125,2943.625,0.5
2940.625,2939.625,-1.0
2933.375,2931.625,-1.75
2918.75,2918.75,0.0
2917.375,2917.625,0.25
2917.375,2917.125,-0.25
2916.875,2916.625,-0.25
2917.125,2917.125,0.0
2916.625,2917.375,0.75
2914.625,2914.75,0.125
2916.375,2914.75,-1.625
2921.875,2922.125,0.25
2923.625,2924.875,1.25
2925.125,2924.625,-0.5
2926.5,2926.75,0.25
2925.875,2927.375,1.5
2925.625,2925.875,0.25
2928.625,2928.375,-0.25
2928.375,2928.375,0.0
2927.875,2928.375,0.5
2927.875,2927.625,-0.25
2930.125,2930.625,0.5
2930.375,2930.625,0.25
2931.375,2931.125,-0.25
2931.625,2931.375,-0.25
2931.625,2931.375,-0.25
2934.625,2932.125,-2.5
2934.125,2933.875,-0.25
2933.625,2934.125,0.5
2936.375,2936.75,0.375
2935.875,2936.125,0.25
2931.875,2931.375,-0.5
2932.875,2932.375,-0.5
2933.125,2932.375,-0.75
2933.875,2934.0,0.125
2934.375,2934.5,0.125
2935.875,2935.625,-0.25
2936.125,2935.875,-0.25
2936.5,2936.375,-0.125
2935.875,2936.375,0.5
2940.625,2940.375,-0.25
2939.875,2940.125,0.25
2940.625,2940.875,0.25
2940.375,2940.625,0.25
2939.125,2938.875,-0.25
2938.125,2937.375,-0.75
2939.625,2939.625,0.0
2937.625,2937.875,0.25
2934.875,2934.375,-0.5
2935.375,2935.125,-0.25
2934.375,2935.25,0.875
2928.375,2927.875,-0.5
2928.875,2929.125,0.25
2931.375,2928.875,-2.5
2931.375,2931.125,-0.25
2930.625,2930.375,-0.25
2929.875,2930.375,0.5
2928.375,2930.0,1.625
2939.125,2933.875,-5.25
2937.625,2937.625,0.0
2935.375,2937.375,2.0
2933.125,2935.375,2.25
2934.625,2933.625,

2025-01-20 00:38:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:38:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:38:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:38:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 00:38:26 - snowflake.connector.connection - INFO - closed
2025-01-20 00:38:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:38:26 - root - INFO - SQL:
-- 8. Retrieve trade dates along with prices
SELECT "TradeDate",
       "StrikePrice",
       "LastPx"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
WHERE "TradeDate" IS NOT NULL AND "StrikePrice" IS NOT NULL AND "LastPx" IS NOT NULL
LIMIT 1000
Results:
Too long, hard cut:
TradeDate,StrikePrice,LastPx
2020-05-18,2953.125,2953.125
2020-05-18,2952.375,2952.375
2020-05-18,2952.625,2953.375
2020-05-18,2953.125,2952.625
2020-05-18,2952.375,2953.625
2020-05-18,2952.375,2953.125
2020-05-18,2953.875,2955.375
2020-05-18,2953.625,2953.875
2020-05-18,2953.125,2953.625
2020-05-18,2952.125,2952.625
2020-05-18,2951.125,2952.625
2020-05-18,2955.625,2955.125
2020-05-18,2955.375,2956.875
2020-05-18,2955.375,2954.375
2020-05-18,2954.625,2953.625
2020-05-18,2952.875,2952.875
2020-05-18,2954.375,2954.375
2020-05-18,2957.625,2956.875
2020-05-18,2959.375,2958.625
2020-05-18,2960.375,2958.875
2020-05-18,2961.125,2960.125
2020-05-18,2961.125,2961.875
2020-05-18,2948.5,2948.5
2020-05-18,2945.875,2946.375
2020-05-18,2945.375,2946.125
2020-05-18,2945.375,2944.875
2020-05-18,2945.625,2945.625
2020-05-18,2946.625,2947.125
2020-05-18,2949.125,2949.125
2020-05-18,2951.625,2951.125
2020-05-18,2952.875,2953.125
2020-05-18,2952.125,2951.875
2020-05-18,2948.625,2947.625
2020-05-18,2949.625,2949.375
2020-05-19,2952.625,2951.875
2020-05-19,2951.875,2952.375
2020-05-19,2950.125,2950.625
2020-05-19,2950.375,2949.875
2020-05-19,2946.875,2945.625
2020-05-19,2948.875,2946.625
2020-05-19,2947.625,2947.375
2020-05-19,2945.375,2944.875
2020-05-19,2943.875,2943.875
2020-05-19,2946.125,2945.375
2020-05-19,2942.875,2945.125
2020-05-19,2939.625,2939.875
2020-05-19,2941.375,2940.625
2020-05-19,2940.375,2941.125
2020-05-19,2940.875,2940.125
2020-05-19,2940.625,2941.375
2020-05-19,2942.625,2941.875
2020-05-19,2941.875,2943.125
2020-05-19,2941.375,2941.375
2020-05-19,2942.125,2941.375
2020-05-19,2936.875,2936.875
2020-05-19,2936.375,2937.375
2020-05-19,2937.5,2936.875
2020-05-19,2937.625,2938.125
2020-05-19,2937.625,2937.625
2020-05-19,2939.875,2939.125
2020-05-19,2938.875,2939.625
2020-05-19,2943.375,2941.375
2020-05-19,2945.375,2945.625
2020-05-19,2947.875,2946.875
2020-05-19,2946.375,2947.625
2020-05-19,2946.375,2946.375
2020-05-19,2946.875,2946.625
2020-05-19,2946.625,2945.875
2020-05-19,2948.875,2949.125
2020-05-19,2950.5,2950.5
2020-05-19,2947.125,2946.875
2020-05-19,2948.5,2948.875
2020-05-19,2947.625,2948.625
2020-05-19,2947.125,2947.125
2020-05-19,2946.875,2946.125
2020-05-19,2946.625,2946.875
2020-05-19,2950.625,2949.375
2020-05-19,2957.5,2955.625
2020-05-19,2957.625,2958.625
2020-05-19,2961.125,2957.875
2020-05-19,2959.625,2959.875
2020-05-19,2961.125,2961.375
2020-05-19,2966.875,2967.875
2020-05-19,2970.375,2967.125
2020-05-19,2972.875,2972.125
2020-05-19,2968.0,2973.625
2020-05-19,2955.375,2955.625
2020-05-19,2950.875,2950.625
2020-05-19,2937.375,2937.375
2020-05-19,2941.125,2940.625
2020-05-19,2942.0,2942.125
2020-05-19,2943.375,2940.875
2020-05-19,2942.125,2943.125
2020-05-19,2938.625,2940.625
2020-05-19,2936.625,2936.625
2020-05-19,2937.125,2936.875
2020-05-19,2939.875,2939.375
2020-05-19,2940.375,2940.375
2020-05-19,2938.875,2941.375
2020-05-19,2938.75,2940.25
2020-05-19,2934.625,2934.375
2020-05-19,2933.875,2933.125
2020-05-19,2934.375,2934.125
2020-05-19,2934.625,2934.875
2020-05-19,2938.875,2938.625
2020-05-19,2938.625,2938.375
2020-05-19,2941.625,2941.375
2020-05-19,2941.75,2942.125
2020-05-19,2945.375,2946.0
2020-05-19,2945.375,2944.625
2020-05-19,2946.125,2945.875
2020-05-19,2938.625,2937.375
2020-05-19,2939.125,2938.125
2020-05-19,2943.375,2943.875
2020-05-19,2942.875,2942.875
2020-05-19,2940.625,2940.625
2020-05-19,2940.125,2939.125
2020-05-19,2937.375,2939.625
2020-05-19,2941.125,2936.375
2020-05-19,2942.125,2943.125
2020-05-19,2943.375,2942.375
2020-05-19,2944.625,2944.125
2020-05-19,2946.125,2946.625
2020-05-19,2947.875,2946.125
2020-05-19,2940.875,2940.625
2020-05-19,2948.875,2948.375
2020-05-19,2949.375,2949.875
2020-05-19,2951.125,2950.625
2020-05-19,2950.875,2951.875
2020-05-19,2953.875,2954.125
2020-05-19,2952.375,2954.625
2020-05-19,2950.625,2951.875
2020-05-19,2948.875,2949.625
2020-05-19,2944.625,2946.625
2020-05-19,2947.375,2947.125
2020-05-19,2948.875,2948.625
2020-05-19,2949.375,2948.125
2020-05-19,2948.625,2948.125
2020-05-19,2948.125,2949.375
2020-05-19,2950.875,2950.625
2020-05-19,2951.875,2951.625
2020-05-19,2952.625,2952.125
2020-05-19,2952.875,2952.375
2020-05-19,2952.375,2952.875
2020-05-19,2951.875,2952.625
2020-05-19,2953.875,2952.625
2020-05-19,2955.875,2955.625
2020-05-19,2954.875,2954.875
2020-05-19,2954.625,2954.625
2020-05-19,2954.875,2954.875
2020-05-19,2955.375,2955.375
2020-05-19,2955.375,2955.375
2020-05-19,2955.625,2955.375
2020-05-19,2942.625,2941.625
2020-05-19,2943.125,2943.625
2020-05-19,2940.625,2939.625
2020-05-19,2933.375,2931.625
2020-05-19,2918.75,2918.75
2020-05-19,2917.375,2917.625
2020-05-19,2917.375,2917.125
2020-05-19,2916.875,2916.625
2020-05-19,2917.125,2917.125
2020-05-19,2916.625,2917.375
2020-05-19,2914.625,2914.75
2020-05-19,2916.375,2914.75
2020-05-19,2921.875,2922.125
2020-05-20,2923.625,2924.875
2020-05-20,2925.125,2924.625
2020-05-20,2926.5,2926.75
2020-05-20,2925.875,2927.375
2020-05-20,2925.625,2925.875
2020-05-20,2928.625,2928.375
2020-05-20,29

2025-01-20 00:38:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:38:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:38:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:38:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 13
2025-01-20 00:38:27 - snowflake.connector.connection - INFO - closed
2025-01-20 00:38:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:38:28 - root - INFO - SQL:
-- 9. List distinct symbols from the trades
SELECT DISTINCT "Symbol"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
WHERE "Symbol" IS NOT NULL
LIMIT 1000
Results:
Symbol
ESZ0
BTCK0
NQZ0
ESU0
BTCN0
BTCU0
NQU0
BTCQ0
NQM0
BTCV0
BTCZ0
ESM0
BTCM0

2025-01-20 00:38:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:38:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:38:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:38:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 00:38:29 - snowflake.connector.connection - INFO - closed
2025-01-20 00:38:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:38:30 - root - INFO - SQL:
-- 10. Retrieve quantities traded along with symbols and trade dates
SELECT "Quantity",
       "Symbol",
       "TradeDate"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
WHERE "Quantity" IS NOT NULL AND "Symbol" IS NOT NULL AND "TradeDate" IS NOT NULL
LIMIT 1000
Results:
Too long, hard cut:
Quantity,Symbol,TradeDate
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0

2025-01-20 00:38:30 - root - INFO - itercount: 0
2025-01-20 00:38:30 - root - INFO - Database Name: CYMBAL_INVESTMENTS
Schema Name: CYMBAL_INVESTMENTS
DDL describes table information.
,0
table_name,TRADE_CAPTURE_REPORT
description,
DDL,"create or replace TABLE TRADE_CAPTURE_REPORT (
	""SendingTime"" NUMBER(38,0),
	""TargetCompID"" VARCHAR(16777216),
	""SenderCompID"" VARCHAR(16777216),
	""Symbol"" VARCHAR(16777216),
	""Quantity"" NUMBER(38,0),
	""OrderID"" VARCHAR(16777216),
	""TransactTime"" NUMBER(38,0),
	""StrikePrice"" FLOAT,
	""LastPx"" FLOAT,
	""MaturityDate"" NUMBER(38,0),
	""TradeReportID"" VARCHAR(16777216),
	""TradeDate"" DATE,
	""CFICode"" VARCHAR(16777216),
	""Sides"" VARIANT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'CYMBAL_INVESTMENTS': {'CYMBAL_INVESTMENTS': ['TRADE_CAPTURE_REPORT']}}
Begin Exploring Related Columns
Columns and potential usage:

- **"Sides"**: Contains side information in a VARIANT (JSON) format. We can extract whether the trade is a long-side trade and determine the strategy used ("feeling-lucky" or "momentum").

- **"StrikePrice"**: Used to calculate the intrinsic value of the trade.

- **"LastPx"**: The execution price of the trade; used in calculating intrinsic value.

- **"Quantity"**: The number of units traded; may be used in calculations.

- **"Symbol"**: Identifies the traded instrument.

Conditions that may be used:

- Filter trades where **"Sides"** indicates a long-side trade.

- Extract and filter trades based on the strategy ("feeling-lucky" or "momentum") from **"Sides"**.

- Calculate the average intrinsic value for each strategy under long-side trades.

Here are at least 10 simple, short, non-nested Snowflake SQL queries to understand values in the related columns:

```sql
-- 1. Retrieve distinct values from the "Sides" column to understand its structure
SELECT DISTINCT "Sides"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
LIMIT 1000;

-- 2. View sample "Sides" data to inspect its content
SELECT "Sides"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
LIMIT 1000;

-- 3. Flatten the "Sides" column to extract individual elements
SELECT s.value
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") s
LIMIT 1000;

-- 4. Extract the "Side" field from the "Sides" JSON data
SELECT s.value:"Side"::STRING AS "Side"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") s
LIMIT 1000;

-- 5. Extract the "Strategy" field from the "Sides" JSON data
SELECT s.value:"Strategy"::STRING AS "Strategy"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") s
LIMIT 1000;

-- 6. Retrieve distinct strategies used in trades
SELECT DISTINCT s.value:"Strategy"::STRING AS "Strategy"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") s
LIMIT 1000;

-- 7. Calculate the intrinsic value for trades
SELECT "StrikePrice",
       "LastPx",
       ("LastPx" - "StrikePrice") AS "IntrinsicValue"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
LIMIT 1000;

-- 8. Retrieve trade dates along with prices
SELECT "TradeDate",
       "StrikePrice",
       "LastPx"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
LIMIT 1000;

-- 9. List distinct symbols from the trades
SELECT DISTINCT "Symbol"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
LIMIT 1000;

-- 10. Retrieve quantities traded along with symbols and trade dates
SELECT "Quantity",
       "Symbol",
       "TradeDate"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
LIMIT 1000;
```

These queries help in exploring the structure and content of the relevant columns, particularly the **"Sides"** column, and in understanding how to extract and use the data needed to solve the task.Query:
-- 1. Retrieve distinct values from the "Sides" column to understand its structure
SELECT DISTINCT "Sides"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
LIMIT 1000
Answer:
Too long, hard cut:
Sides
"[
  {
    ""OrderID"": ""7805b66c-6df7-4d13-8936-fd41302d9c42"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""0ed10a65-39f7-454f-b7b1-e2c5a2335c5d"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""c6d587ee-4dcc-41f2-8b9a-126126e55a1b"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""4860dd01-82cf-4c47-a2cf-ac57dd0c98b2"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""75c8a1b1-50a5-4155-be79-e4908b0ed544"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""e00bc0bc-5193-4f88-910a-e5d375f3c519"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""bd76567f-b671-413d-a4f9-642a70785608"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""fb6f74c7-5c50-4328-b8d3-c92f555eac7b"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""8e1f5b4e-b85b-4bc8-910d-a83d5939ac77"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""86c89d01-ea2d-4139-acb1-7801a4ff7045"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""473b0975-ef33-4175-97e8-b6cc4097c377"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""73ea42c7-8b6c-40f9-9a6c-7c61c1b49ab3"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""051b9edc-e6e8-4042-bd4b-a861ccbf97d7"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""da0f7e56-732e-4f4c-b670-68a14cc0bdab"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""36a1ee37-e27c-445e-8e97-18d49ca03534"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""d8bbbbef-5761-4d88-94cd-30b75726eed3"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""646d233a-a9bb-4f2f-a2f8-8805ec43c3a9"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""9266931f-e68b-4561-bcf9-ccd06e9cd56a"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }
]"
"[
  {
    ""OrderID"": ""8294f311-5917-454b-87f4-6d57c3db7817"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""PREDICTNQ"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""SHORT""
  }

Query:
-- 2. View sample "Sides" data to inspect its content
SELECT "Sides"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
LIMIT 1000
Answer:
Too long, hard cut:
Sides
"[
  {
    ""OrderID"": ""d8eefa63-6f10-4566-8f15-81460448f2ac"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""7fa78bef-912c-41cb-b381-4c03b5a7c508"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""5a4c4d8b-b9b8-4307-a0c3-8c753ed93520"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""a204ef77-1071-48ee-a5f5-21579311cd91"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""b7a40778-7293-407b-8636-91a7ffe9817a"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""c67a3f6a-7253-4ec8-91be-a4a3f07aa27b"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""83e09901-1182-4ad0-b423-0f92bf78a7a2"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""8161e8ff-9aa3-4e27-9322-363a4a063a27"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""2e2c0922-e696-44f6-899e-9112f6129088"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""8afcaa49-daca-470f-9479-6bfd2c648ccf"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""4e25aae7-5b30-408a-a23e-ea3afb86c445"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""048dab46-3718-4dd2-b12e-709ce317c069"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""0e00e452-329b-44df-90a5-902b7e737608"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""ae17c30f-0689-4013-8485-05f5eb5f7721"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""3a9010bf-80a3-46aa-ae04-afd4b1f39e1a"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""5880746a-b864-46b5-8204-060bbe7104a4"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""68bf4c18-8084-435b-8786-2ae9b104339e"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""0fe87fac-d58a-4bb9-8552-c1e58d91bb82"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""94641ac8-057f-4f66-ba2f-81edc252bbcf"",
    ""PartyIDs"": [
      {
        ""PartyID"": ""MOMOES"",
        ""PartyIDSource"": ""PROP CODE"",
        ""PartyRole"": ""INITIATING TRADER""
      }
    ],
    ""Side"": ""LONG""
  }
]"
"[
  {
    ""OrderID"": ""dd4279ad-7a00-4c6f-b26f-0f98aff69aed"",
    ""P
Query:
-- 3. Flatten the "Sides" column to extract individual elements
SELECT s.value
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") s
LIMIT 1000
Answer:
Too long, hard cut:
VALUE
"{
  ""OrderID"": ""13d16468-0b06-49d3-9bdc-dc36502bf963"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""560a2490-86f4-4f9f-a621-956e413b3da5"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""77781b63-55ee-4f77-a4ca-a9ddb83489ec"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""41fa4ce5-13fc-4e01-827e-986bff0fdacb"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""b81b508f-f806-48d9-a394-226b1d959c6f"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""0e4b7434-0da6-480a-83a0-5481c3ca8a60"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""1e3c7ee7-601e-41fa-872d-84325cb11edf"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""64a1b69e-b7a2-4d2e-bfd3-a1d7d2b449e8"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""9374ad1d-06ac-4aaa-a675-65b8832bba4d"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""a265dc44-4d01-4e2f-8a8a-54ceca9e6ea8"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""f2399821-a835-4182-b169-1bd51774f966"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""fdc1fa4d-3494-415f-9985-ed684c6a0176"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""946d0d8b-e0d7-4473-83cc-db512467fe32"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""7805b66c-6df7-4d13-8936-fd41302d9c42"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""c19751d5-5838-4958-8f36-050f329231fe"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""091bbb71-05ba-4404-b180-1fc805b531e6"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""be539c12-3421-4108-b478-8d567a6c95c6"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""0c7ff41d-f686-4899-ab6b-bc10265b4019"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""3d4a8b57-3809-46a5-94c5-41a366876ee9"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""4b93afa3-ed9c-4b85-bcd2-084a2d27f36c"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"": ""be06f275-15c5-464c-b9df-7c04052e8116"",
  ""PartyIDs"": [
    {
      ""PartyID"": ""PREDICTNQ"",
      ""PartyIDSource"": ""PROP CODE"",
      ""PartyRole"": ""INITIATING TRADER""
    }
  ],
  ""Side"": ""SHORT""
}"
"{
  ""OrderID"":
Query:
-- 4. Extract the "Side" field from the "Sides" JSON data
SELECT s.value:"Side"::STRING AS "Side"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") s
LIMIT 1000
Answer:
Too long, hard cut:
Side
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHORT
SHO
Query:
SELECT
    (AVG(CASE WHEN s.value:"PartyIDs"[0]:"PartyID"::STRING = 'PREDICTNQ' THEN ("LastPx" - "StrikePrice") END) -
     AVG(CASE WHEN s.value:"PartyIDs"[0]:"PartyID"::STRING = 'MOMOES' THEN ("LastPx" - "StrikePrice") END)) AS "higher"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") s
WHERE s.value:"Side"::STRING = 'LONG'
  AND s.value:"PartyIDs"[0]:"PartyID"::STRING IN ('PREDICTNQ', 'MOMOES');
Answer:
higher
-0.396824672099944
Query:
-- 6. Retrieve distinct strategies used in trades
SELECT DISTINCT s.value:"PartyIDs"[0]:"PartyID"::STRING AS "Strategy"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") s
WHERE s.value:"PartyIDs"[0]:"PartyID"::STRING IS NOT NULL
LIMIT 1000
Answer:
Strategy
LUCKYBTC
PREDICTES
LUCKYES
MOMOBTC
MOMONQ
PREDICTBTC
PREDICTNQ
MOMOES
LUCKYNQ
Query:
-- 7. Calculate the intrinsic value for trades
SELECT "StrikePrice",
       "LastPx",
       ("LastPx" - "StrikePrice") AS "IntrinsicValue"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
WHERE "StrikePrice" IS NOT NULL AND "LastPx" IS NOT NULL
LIMIT 1000
Answer:
Too long, hard cut:
StrikePrice,LastPx,IntrinsicValue
2953.125,2953.125,0.0
2952.375,2952.375,0.0
2952.625,2953.375,0.75
2953.125,2952.625,-0.5
2952.375,2953.625,1.25
2952.375,2953.125,0.75
2953.875,2955.375,1.5
2953.625,2953.875,0.25
2953.125,2953.625,0.5
2952.125,2952.625,0.5
2951.125,2952.625,1.5
2955.625,2955.125,-0.5
2955.375,2956.875,1.5
2955.375,2954.375,-1.0
2954.625,2953.625,-1.0
2952.875,2952.875,0.0
2954.375,2954.375,0.0
2957.625,2956.875,-0.75
2959.375,2958.625,-0.75
2960.375,2958.875,-1.5
2961.125,2960.125,-1.0
2961.125,2961.875,0.75
2948.5,2948.5,0.0
2945.875,2946.375,0.5
2945.375,2946.125,0.75
2945.375,2944.875,-0.5
2945.625,2945.625,0.0
2946.625,2947.125,0.5
2949.125,2949.125,0.0
2951.625,2951.125,-0.5
2952.875,2953.125,0.25
2952.125,2951.875,-0.25
2948.625,2947.625,-1.0
2949.625,2949.375,-0.25
2952.625,2951.875,-0.75
2951.875,2952.375,0.5
2950.125,2950.625,0.5
2950.375,2949.875,-0.5
2946.875,2945.625,-1.25
2948.875,2946.625,-2.25
2947.625,2947.375,-0.25
2945.375,2944.875,-0.5
2943.875,2943.875,0.0
2946.125,2945.375,-0.75
2942.875,2945.125,2.25
2939.625,2939.875,0.25
2941.375,2940.625,-0.75
2940.375,2941.125,0.75
2940.875,2940.125,-0.75
2940.625,2941.375,0.75
2942.625,2941.875,-0.75
2941.875,2943.125,1.25
2941.375,2941.375,0.0
2942.125,2941.375,-0.75
2936.875,2936.875,0.0
2936.375,2937.375,1.0
2937.5,2936.875,-0.625
2937.625,2938.125,0.5
2937.625,2937.625,0.0
2939.875,2939.125,-0.75
2938.875,2939.625,0.75
2943.375,2941.375,-2.0
2945.375,2945.625,0.25
2947.875,2946.875,-1.0
2946.375,2947.625,1.25
2946.375,2946.375,0.0
2946.875,2946.625,-0.25
2946.625,2945.875,-0.75
2948.875,2949.125,0.25
2950.5,2950.5,0.0
2947.125,2946.875,-0.25
2948.5,2948.875,0.375
2947.625,2948.625,1.0
2947.125,2947.125,0.0
2946.875,2946.125,-0.75
2946.625,2946.875,0.25
2950.625,2949.375,-1.25
2957.5,2955.625,-1.875
2957.625,2958.625,1.0
2961.125,2957.875,-3.25
2959.625,2959.875,0.25
2961.125,2961.375,0.25
2966.875,2967.875,1.0
2970.375,2967.125,-3.25
2972.875,2972.125,-0.75
2968.0,2973.625,5.625
2955.375,2955.625,0.25
2950.875,2950.625,-0.25
2937.375,2937.375,0.0
2941.125,2940.625,-0.5
2942.0,2942.125,0.125
2943.375,2940.875,-2.5
2942.125,2943.125,1.0
2938.625,2940.625,2.0
2936.625,2936.625,0.0
2937.125,2936.875,-0.25
2939.875,2939.375,-0.5
2940.375,2940.375,0.0
2938.875,2941.375,2.5
2938.75,2940.25,1.5
2934.625,2934.375,-0.25
2933.875,2933.125,-0.75
2934.375,2934.125,-0.25
2934.625,2934.875,0.25
2938.875,2938.625,-0.25
2938.625,2938.375,-0.25
2941.625,2941.375,-0.25
2941.75,2942.125,0.375
2945.375,2946.0,0.625
2945.375,2944.625,-0.75
2946.125,2945.875,-0.25
2938.625,2937.375,-1.25
2939.125,2938.125,-1.0
2943.375,2943.875,0.5
2942.875,2942.875,0.0
2940.625,2940.625,0.0
2940.125,2939.125,-1.0
2937.375,2939.625,2.25
2941.125,2936.375,-4.75
2942.125,2943.125,1.0
2943.375,2942.375,-1.0
2944.625,2944.125,-0.5
2946.125,2946.625,0.5
2947.875,2946.125,-1.75
2940.875,2940.625,-0.25
2948.875,2948.375,-0.5
2949.375,2949.875,0.5
2951.125,2950.625,-0.5
2950.875,2951.875,1.0
2953.875,2954.125,0.25
2952.375,2954.625,2.25
2950.625,2951.875,1.25
2948.875,2949.625,0.75
2944.625,2946.625,2.0
2947.375,2947.125,-0.25
2948.875,2948.625,-0.25
2949.375,2948.125,-1.25
2948.625,2948.125,-0.5
2948.125,2949.375,1.25
2950.875,2950.625,-0.25
2951.875,2951.625,-0.25
2952.625,2952.125,-0.5
2952.875,2952.375,-0.5
2952.375,2952.875,0.5
2951.875,2952.625,0.75
2953.875,2952.625,-1.25
2955.875,2955.625,-0.25
2954.875,2954.875,0.0
2954.625,2954.625,0.0
2954.875,2954.875,0.0
2955.375,2955.375,0.0
2955.375,2955.375,0.0
2955.625,2955.375,-0.25
2942.625,2941.625,-1.0
2943.125,2943.625,0.5
2940.625,2939.625,-1.0
2933.375,2931.625,-1.75
2918.75,2918.75,0.0
2917.375,2917.625,0.25
2917.375,2917.125,-0.25
2916.875,2916.625,-0.25
2917.125,2917.125,0.0
2916.625,2917.375,0.75
2914.625,2914.75,0.125
2916.375,2914.75,-1.625
2921.875,2922.125,0.25
2923.625,2924.875,1.25
2925.125,2924.625,-0.5
2926.5,2926.75,0.25
2925.875,2927.375,1.5
2925.625,2925.875,0.25
2928.625,2928.375,-0.25
2928.375,2928.375,0.0
2927.875,2928.375,0.5
2927.875,2927.625,-0.25
2930.125,2930.625,0.5
2930.375,2930.625,0.25
2931.375,2931.125,-0.25
2931.625,2931.375,-0.25
2931.625,2931.375,-0.25
2934.625,2932.125,-2.5
2934.125,2933.875,-0.25
2933.625,2934.125,0.5
2936.375,2936.75,0.375
2935.875,2936.125,0.25
2931.875,2931.375,-0.5
2932.875,2932.375,-0.5
2933.125,2932.375,-0.75
2933.875,2934.0,0.125
2934.375,2934.5,0.125
2935.875,2935.625,-0.25
2936.125,2935.875,-0.25
2936.5,2936.375,-0.125
2935.875,2936.375,0.5
2940.625,2940.375,-0.25
2939.875,2940.125,0.25
2940.625,2940.875,0.25
2940.375,2940.625,0.25
2939.125,2938.875,-0.25
2938.125,2937.375,-0.75
2939.625,2939.625,0.0
2937.625,2937.875,0.25
2934.875,2934.375,-0.5
2935.375,2935.125,-0.25
2934.375,2935.25,0.875
2928.375,2927.875,-0.5
2928.875,2929.125,0.25
2931.375,2928.875,-2.5
2931.375,2931.125,-0.25
2930.625,2930.375,-0.25
2929.875,2930.375,0.5
2928.375,2930.0,1.625
2939.125,2933.875,-5.25
2937.625,2937.625,0.0
2935.375,2937.375,2.0
2933.125,2935.375,2.25
2934.625,2933.625,
Query:
-- 8. Retrieve trade dates along with prices
SELECT "TradeDate",
       "StrikePrice",
       "LastPx"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
WHERE "TradeDate" IS NOT NULL AND "StrikePrice" IS NOT NULL AND "LastPx" IS NOT NULL
LIMIT 1000
Answer:
Too long, hard cut:
TradeDate,StrikePrice,LastPx
2020-05-18,2953.125,2953.125
2020-05-18,2952.375,2952.375
2020-05-18,2952.625,2953.375
2020-05-18,2953.125,2952.625
2020-05-18,2952.375,2953.625
2020-05-18,2952.375,2953.125
2020-05-18,2953.875,2955.375
2020-05-18,2953.625,2953.875
2020-05-18,2953.125,2953.625
2020-05-18,2952.125,2952.625
2020-05-18,2951.125,2952.625
2020-05-18,2955.625,2955.125
2020-05-18,2955.375,2956.875
2020-05-18,2955.375,2954.375
2020-05-18,2954.625,2953.625
2020-05-18,2952.875,2952.875
2020-05-18,2954.375,2954.375
2020-05-18,2957.625,2956.875
2020-05-18,2959.375,2958.625
2020-05-18,2960.375,2958.875
2020-05-18,2961.125,2960.125
2020-05-18,2961.125,2961.875
2020-05-18,2948.5,2948.5
2020-05-18,2945.875,2946.375
2020-05-18,2945.375,2946.125
2020-05-18,2945.375,2944.875
2020-05-18,2945.625,2945.625
2020-05-18,2946.625,2947.125
2020-05-18,2949.125,2949.125
2020-05-18,2951.625,2951.125
2020-05-18,2952.875,2953.125
2020-05-18,2952.125,2951.875
2020-05-18,2948.625,2947.625
2020-05-18,2949.625,2949.375
2020-05-19,2952.625,2951.875
2020-05-19,2951.875,2952.375
2020-05-19,2950.125,2950.625
2020-05-19,2950.375,2949.875
2020-05-19,2946.875,2945.625
2020-05-19,2948.875,2946.625
2020-05-19,2947.625,2947.375
2020-05-19,2945.375,2944.875
2020-05-19,2943.875,2943.875
2020-05-19,2946.125,2945.375
2020-05-19,2942.875,2945.125
2020-05-19,2939.625,2939.875
2020-05-19,2941.375,2940.625
2020-05-19,2940.375,2941.125
2020-05-19,2940.875,2940.125
2020-05-19,2940.625,2941.375
2020-05-19,2942.625,2941.875
2020-05-19,2941.875,2943.125
2020-05-19,2941.375,2941.375
2020-05-19,2942.125,2941.375
2020-05-19,2936.875,2936.875
2020-05-19,2936.375,2937.375
2020-05-19,2937.5,2936.875
2020-05-19,2937.625,2938.125
2020-05-19,2937.625,2937.625
2020-05-19,2939.875,2939.125
2020-05-19,2938.875,2939.625
2020-05-19,2943.375,2941.375
2020-05-19,2945.375,2945.625
2020-05-19,2947.875,2946.875
2020-05-19,2946.375,2947.625
2020-05-19,2946.375,2946.375
2020-05-19,2946.875,2946.625
2020-05-19,2946.625,2945.875
2020-05-19,2948.875,2949.125
2020-05-19,2950.5,2950.5
2020-05-19,2947.125,2946.875
2020-05-19,2948.5,2948.875
2020-05-19,2947.625,2948.625
2020-05-19,2947.125,2947.125
2020-05-19,2946.875,2946.125
2020-05-19,2946.625,2946.875
2020-05-19,2950.625,2949.375
2020-05-19,2957.5,2955.625
2020-05-19,2957.625,2958.625
2020-05-19,2961.125,2957.875
2020-05-19,2959.625,2959.875
2020-05-19,2961.125,2961.375
2020-05-19,2966.875,2967.875
2020-05-19,2970.375,2967.125
2020-05-19,2972.875,2972.125
2020-05-19,2968.0,2973.625
2020-05-19,2955.375,2955.625
2020-05-19,2950.875,2950.625
2020-05-19,2937.375,2937.375
2020-05-19,2941.125,2940.625
2020-05-19,2942.0,2942.125
2020-05-19,2943.375,2940.875
2020-05-19,2942.125,2943.125
2020-05-19,2938.625,2940.625
2020-05-19,2936.625,2936.625
2020-05-19,2937.125,2936.875
2020-05-19,2939.875,2939.375
2020-05-19,2940.375,2940.375
2020-05-19,2938.875,2941.375
2020-05-19,2938.75,2940.25
2020-05-19,2934.625,2934.375
2020-05-19,2933.875,2933.125
2020-05-19,2934.375,2934.125
2020-05-19,2934.625,2934.875
2020-05-19,2938.875,2938.625
2020-05-19,2938.625,2938.375
2020-05-19,2941.625,2941.375
2020-05-19,2941.75,2942.125
2020-05-19,2945.375,2946.0
2020-05-19,2945.375,2944.625
2020-05-19,2946.125,2945.875
2020-05-19,2938.625,2937.375
2020-05-19,2939.125,2938.125
2020-05-19,2943.375,2943.875
2020-05-19,2942.875,2942.875
2020-05-19,2940.625,2940.625
2020-05-19,2940.125,2939.125
2020-05-19,2937.375,2939.625
2020-05-19,2941.125,2936.375
2020-05-19,2942.125,2943.125
2020-05-19,2943.375,2942.375
2020-05-19,2944.625,2944.125
2020-05-19,2946.125,2946.625
2020-05-19,2947.875,2946.125
2020-05-19,2940.875,2940.625
2020-05-19,2948.875,2948.375
2020-05-19,2949.375,2949.875
2020-05-19,2951.125,2950.625
2020-05-19,2950.875,2951.875
2020-05-19,2953.875,2954.125
2020-05-19,2952.375,2954.625
2020-05-19,2950.625,2951.875
2020-05-19,2948.875,2949.625
2020-05-19,2944.625,2946.625
2020-05-19,2947.375,2947.125
2020-05-19,2948.875,2948.625
2020-05-19,2949.375,2948.125
2020-05-19,2948.625,2948.125
2020-05-19,2948.125,2949.375
2020-05-19,2950.875,2950.625
2020-05-19,2951.875,2951.625
2020-05-19,2952.625,2952.125
2020-05-19,2952.875,2952.375
2020-05-19,2952.375,2952.875
2020-05-19,2951.875,2952.625
2020-05-19,2953.875,2952.625
2020-05-19,2955.875,2955.625
2020-05-19,2954.875,2954.875
2020-05-19,2954.625,2954.625
2020-05-19,2954.875,2954.875
2020-05-19,2955.375,2955.375
2020-05-19,2955.375,2955.375
2020-05-19,2955.625,2955.375
2020-05-19,2942.625,2941.625
2020-05-19,2943.125,2943.625
2020-05-19,2940.625,2939.625
2020-05-19,2933.375,2931.625
2020-05-19,2918.75,2918.75
2020-05-19,2917.375,2917.625
2020-05-19,2917.375,2917.125
2020-05-19,2916.875,2916.625
2020-05-19,2917.125,2917.125
2020-05-19,2916.625,2917.375
2020-05-19,2914.625,2914.75
2020-05-19,2916.375,2914.75
2020-05-19,2921.875,2922.125
2020-05-20,2923.625,2924.875
2020-05-20,2925.125,2924.625
2020-05-20,2926.5,2926.75
2020-05-20,2925.875,2927.375
2020-05-20,2925.625,2925.875
2020-05-20,2928.625,2928.375
2020-05-20,29
Query:
-- 9. List distinct symbols from the trades
SELECT DISTINCT "Symbol"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
WHERE "Symbol" IS NOT NULL
LIMIT 1000
Answer:
Symbol
ESZ0
BTCK0
NQZ0
ESU0
BTCN0
BTCU0
NQU0
BTCQ0
NQM0
BTCV0
BTCZ0
ESM0
BTCM0
Query:
-- 10. Retrieve quantities traded along with symbols and trade dates
SELECT "Quantity",
       "Symbol",
       "TradeDate"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT
WHERE "Quantity" IS NOT NULL AND "Symbol" IS NOT NULL AND "TradeDate" IS NOT NULL
LIMIT 1000
Answer:
Too long, hard cut:
Quantity,Symbol,TradeDate
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-18
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-19
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0,2020-05-20
1,ESM0
End Exploring Related Columns
Task: How much higher the average intrinsic value is for trades using the feeling-lucky strategy compared to those using the momentum strategy under long-side trades?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
higher
value:float > 0
```

The average intrinsic value for trades using the feeling-lucky strategy is higher than those using the momentum strategy under long-side trades by a positive amount..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'CYMBAL_INVESTMENTS': {'CYMBAL_INVESTMENTS': ['TRADE_CAPTURE_REPORT']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
You need to follow the format's positive and negative signs.

2025-01-20 00:39:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 00:39:25 - root - INFO - ```sql
SELECT
    (AVG(CASE WHEN s.value:"PartyIDs"[0]:"PartyID"::STRING LIKE 'LUCKY%' THEN ("LastPx" - "StrikePrice") END) -
     AVG(CASE WHEN s.value:"PartyIDs"[0]:"PartyID"::STRING LIKE 'MOMO%' THEN ("LastPx" - "StrikePrice") END)) AS "higher"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") s
WHERE s.value:"Side"::STRING = 'LONG'
  AND (s.value:"PartyIDs"[0]:"PartyID"::STRING LIKE 'LUCKY%' OR s.value:"PartyIDs"[0]:"PartyID"::STRING LIKE 'MOMO%')
  AND "LastPx" IS NOT NULL AND "StrikePrice" IS NOT NULL;
```

```csv
higher
value:float > 0
```
2025-01-20 00:39:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:39:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:39:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:39:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 00:39:26 - snowflake.connector.connection - INFO - closed
2025-01-20 00:39:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:39:27 - root - INFO - itercount: 1
2025-01-20 00:39:27 - root - INFO - 0
2025-01-20 00:39:27 - root - INFO - results: 
higher
-0.023069449773148013


2025-01-20 00:39:27 - root - INFO - Please check the answer again by reviewing How much higher the average intrinsic value is for trades using the feeling-lucky strategy compared to those using the momentum strategy under long-side trades?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
higher
value:float > 0
```

The average intrinsic value for trades using the feeling-lucky strategy is higher than those using the momentum strategy under long-side trades by a positive amount. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
higher
-0.023069449773148013
Current sql:
SELECT
    (AVG(CASE WHEN s.value:"PartyIDs"[0]:"PartyID"::STRING LIKE 'LUCKY%' THEN ("LastPx" - "StrikePrice") END) -
     AVG(CASE WHEN s.value:"PartyIDs"[0]:"PartyID"::STRING LIKE 'MOMO%' THEN ("LastPx" - "StrikePrice") END)) AS "higher"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") s
WHERE s.value:"Side"::STRING = 'LONG'
  AND (s.value:"PartyIDs"[0]:"PartyID"::STRING LIKE 'LUCKY%' OR s.value:"PartyIDs"[0]:"PartyID"::STRING LIKE 'MOMO%')
  AND "LastPx" IS NOT NULL AND "StrikePrice" IS NOT NULL;
2025-01-20 00:40:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 00:40:38 - root - INFO - ```sql
SELECT
    (AVG(CASE WHEN pid.value:"PartyID"::STRING LIKE 'LUCKY%' THEN ("LastPx" - "StrikePrice") END) -
     AVG(CASE WHEN pid.value:"PartyID"::STRING LIKE 'MOMO%' THEN ("LastPx" - "StrikePrice") END)) AS "higher"
FROM CYMBAL_INVESTMENTS.CYMBAL_INVESTMENTS.TRADE_CAPTURE_REPORT t,
     LATERAL FLATTEN(input => t."Sides") s,
     LATERAL FLATTEN(input => s.value:"PartyIDs") pid
WHERE s.value:"Side"::STRING = 'LONG'
  AND (pid.value:"PartyID"::STRING LIKE 'LUCKY%' OR pid.value:"PartyID"::STRING LIKE 'MOMO%')
  AND "LastPx" IS NOT NULL AND "StrikePrice" IS NOT NULL;
```

```csv
higher
value:float > 0
```
2025-01-20 00:40:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 00:40:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 00:40:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 00:40:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 00:40:39 - snowflake.connector.connection - INFO - closed
2025-01-20 00:40:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 00:40:40 - root - INFO - itercount: 2
2025-01-20 00:40:40 - root - INFO - 0
2025-01-20 00:40:40 - root - INFO - Total iteration counts: 2
