2025-01-20 22:56:13 - openai._base_client - INFO - Retrying request to /chat/completions in 0.412218 seconds
2025-01-20 22:57:11 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 22:57:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 22:57:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 22:57:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 22:57:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 22:57:13 - snowflake.connector.connection - INFO - closed
2025-01-20 22:57:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 22:57:13 - root - INFO - SQL:
SELECT DISTINCT "item_number", "item_description"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   LIMIT 100;
Results:
item_number,item_description
67540,KAHLUA FRENCH VANILLA LIQUEUR
64559,THE BITTER TRUTH ELDERFLOWER LIQUEUR
64716,CIROC PEACH
64593,CANADIAN CLUB DOCK 57 BLACKBERRY
30316,GORDON'S GIN LONDON DRY
33256,SEAGRAMS LIME TWISTED GIN
36617,NEW AMSTERDAM RASPBERRY
77740,SMIRNOFF RASPBERRY
84142,99 PEACHES PET MINI
43025,ADMIRAL NELSON SPICED PET
100662,VAN GOGH FRUIT SAMPLER NP MINI
73526,DEKUYPER MELON LIQUEUR
101706,ST GERMAIN W/ CARAFE PACK
73456,DEKUYPER LUSCIOUS RAZZMATAZZ
26101,KEEPERS HEARTS IRISH WHISKEY
12476,CANADIAN MIST WHISKY PET
102096,FIREBALL WINTER BAG
5430,LAGAVULIN 16YR SINGLE MALT SCOTCH
5924,GLENLIVET CARIBBEAN RESERVE
58836,JOSE CUERVO AUTHENTIC LIME MARGARITA
64121,ANCHO REYES
64489,CAROLANS SALTED CARAMEL
65109,GREY GOOSE VX
14530,REVEL STOKE CHERRY MINI
27474,BIRD DOG BLACKBERRY
28279,JIM BEAM PEACH
34366,FRIS DANISH VODKA
36871,CIROC 80PRF
35427,RUSSIAN STANDARD PLATINUM VODKA
12861,RICH & RARE CARAMEL MINI
37888,SEAGRAMS VODKA
38008,SMIRNOFF 80PRF PET
77900,SMIRNOFF SOURS BERRY LEMON
86018,BLACK VELVET PEACH CANADIAN WHISKEY
102092,CAPTAIN MORGAN OSR W/NFL TIN CUP
74740,SLOW AND LOW
57168,CHI-CHI'S CHOCOLATE MALT
4716,CHIVAS REGAL 12YR
37868,FROST TRAIL VODKA
18861,LARCENY BARREL PROOF
26586,GENTLEMAN JACK
21878,VERY OLD BARTON BOURBON CRAFTED 86PRF
18858,LARCENY
54444,PARAMOUNT APRICOT BRANDY
5606,MCCLELLAND ISLAY
67186,TUACA LIQUEUR
82847,DEKUYPER LUSCIOUS PEACHTREE
30236,GILBEYS GIN
34433,GREY GOOSE
87194,818 BLANCO TEQUILA
34578,PINNACLE
36595,KINKY VODKA
39868,SMIRNOFF 100PRF
88922,1800 CRISTALINO
54448,PARAMOUNT APRICOT BRANDY
101126,JIM BEAM FLAVORS 50ML VARIETY PACK
34001,ABSOLUT SWEDISH VODKA 80PRF MINI
80236,IOWISH CREAM LIQUEUR
19068,JIM BEAM
86884,SOUTHERN COMFORT
31658,PARAMOUNT GIN
33660,SVEDKA MANGO PINEAPPLE
16538,ANCIENT AGE 10 STAR BOURBON
65896,METAXA OUZO
67556,KAMORA COFFEE LIQUEUR
67296,YUKON JACK PERMA FROST SCHNAPPS DISCO
68559,KERRYGOLD IRISH CREAM LIQUEUR
101239,WHISTLEPIG RYE PIGLETS MINI
101462,YUKON JACK ASSORTED MINIS
35916,FIVE O'CLOCK VODKA
36258,DEHNER DISTILLERY VODKA
33110,INDOGGO STRAWBERRY GIN
86668,JACK DANIELS TENNESSEE HONEY MINI
36901,MCCORMICK 80PRF VODKA MINI
36908,MCCORMICK VODKA PET
42009,UV CAKE VODKA
77050,FIELD FIRE
63345,ON THE ROCKS COCKTAILS TRES GEN JALAPENO PINEAPPLE MARGARITA
102057,FIREBALL FALL TAILGATE BAG
35947,FLEISCHMANNS 80PRF VODKA
51328,MARASKA SLIVOVITZ 10YR
87725,GRAN CORAMINO REPOSADO CRISTALINO
84187,99 CINNAMON
17085,BULLEIT BOURBON
22244,YELLOWSTONE SELECT
86112,DEKUYPER TRIPLE SEC
59037,DESERT ISLAND LONG ISLAND ICED TEA COCKTAIL
20368,OLD FORESTER BOURBON 86PRF
31718,PHILLIPS GIN
42666,MT GAY ECLIPSE RUM
21538,STAGG BOURBON
68036,BAILEYS ORIGINAL IRISH CREAM
67526,KAHLUA COFFEE
26700,CODY ROAD RYE MINI
28236,BOMBAY SAPPHIRE GIN
34395,EFFEN CUCUMBER
35946,FLEISCHMANN'S ROYAL VODKA
15582,FINAGRENS IRISH WHISKEY
34423,GREY GOOSE
84393,99 WATERMELON PET MINI

2025-01-20 22:57:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 22:57:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 22:57:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 22:57:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 13
2025-01-20 22:57:15 - snowflake.connector.connection - INFO - closed
2025-01-20 22:57:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 22:57:15 - root - INFO - SQL:
SELECT DISTINCT EXTRACT(YEAR FROM "date") AS "year"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   ORDER BY "year"
   LIMIT 100;
Results:
year
2012
2013
2014
2015
2016
2017
2018
2019
2020
2021
2022
2023
2024

2025-01-20 22:57:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 22:57:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 22:57:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 22:57:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 22:57:16 - snowflake.connector.connection - INFO - closed
2025-01-20 22:57:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 22:57:17 - root - INFO - SQL:
SELECT "date", "item_number", "sale_dollars"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   ORDER BY "date" DESC
   LIMIT 100;
Results:
date,item_number,sale_dollars
2024-09-30,89196,216.0
2024-09-30,64858,77.4
2024-09-30,80145,18.0
2024-09-30,76637,7.26
2024-09-30,47859,67.47
2024-09-30,11290,8.64
2024-09-30,38177,237.12
2024-09-30,16342,390.0
2024-09-30,11290,17.28
2024-09-30,26667,149.88
2024-09-30,14519,42.75
2024-09-30,14192,45.0
2024-09-30,43331,86.4
2024-09-30,64866,162.0
2024-09-30,64759,7.5
2024-09-30,35916,136.56
2024-09-30,18989,269.82
2024-09-30,38176,180.0
2024-09-30,35914,69.6
2024-09-30,985535,810.51
2024-09-30,88371,143.22
2024-09-30,35435,144.0
2024-09-30,65013,309.6
2024-09-30,65013,154.8
2024-09-30,100423,72.0
2024-09-30,21212,82.5
2024-09-30,87586,44.28
2024-09-30,19064,201.6
2024-09-30,20368,32.25
2024-09-30,69618,53.36
2024-09-30,80456,120.6
2024-09-30,71886,5.01
2024-09-30,15818,15.75
2024-09-30,11774,117.12
2024-09-30,34001,23.76
2024-09-30,26821,207.0
2024-09-30,16396,234.0
2024-09-30,38179,15.72
2024-09-30,43120,1349.4
2024-09-30,10550,54.0
2024-09-30,62971,117.0
2024-09-30,36447,94.05
2024-09-30,11290,17.28
2024-09-30,87043,82.5
2024-09-30,30528,69.78
2024-09-30,12408,90.0
2024-09-30,76106,15.0
2024-09-30,87181,225.0
2024-09-30,19026,90.0
2024-09-30,37996,74.28
2024-09-30,48254,413.76
2024-09-30,27544,198.0
2024-09-30,67309,135.0
2024-09-30,86669,37.14
2024-09-30,64870,144.0
2024-09-30,27474,103.5
2024-09-30,80358,13.13
2024-09-30,86987,49.5
2024-09-30,19494,45.0
2024-09-30,16344,101.25
2024-09-30,21024,60.15
2024-09-30,11776,54.0
2024-09-30,76721,43.5
2024-09-30,49185,216.96
2024-09-30,22215,432.96
2024-09-30,43036,13.14
2024-09-30,22228,1462.5
2024-09-30,64863,7.5
2024-09-30,57210,45.0
2024-09-30,102202,92.51
2024-09-30,11776,108.0
2024-09-30,47865,150.0
2024-09-30,69667,202.56
2024-09-30,25601,111.12
2024-09-30,11786,108.0
2024-09-30,39422,13.84
2024-09-30,69657,202.56
2024-09-30,84160,77.4
2024-09-30,10803,34.56
2024-09-30,8828,34.5
2024-09-30,18103,180.0
2024-09-30,75206,14.52
2024-09-30,25393,25.48
2024-09-30,89242,163.8
2024-09-30,26827,91.23
2024-09-30,36970,144.0
2024-09-30,21598,83.16
2024-09-30,73055,63.0
2024-09-30,87035,21.0
2024-09-30,15621,19.8
2024-09-30,87485,278.94
2024-09-30,38176,180.0
2024-09-30,40594,144.0
2024-09-30,86884,7.17
2024-09-30,86691,51.75
2024-09-30,102149,70.8
2024-09-30,65199,20.25
2024-09-30,26826,286.44
2024-09-30,36904,66.24
2024-09-30,88290,28.5

2025-01-20 22:57:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 22:57:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 22:57:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 22:57:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 22:57:18 - snowflake.connector.connection - INFO - closed
2025-01-20 22:57:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 22:57:18 - root - INFO - SQL:
SELECT "item_number", SUM("sale_dollars") AS "total_sales_2022"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") = 2022
   GROUP BY "item_number"
   ORDER BY "total_sales_2022" DESC
   LIMIT 100;
Results:
item_number,total_sales_2022
38178,10659997.5
38177,9032344.649999999
11788,8276139.199999998
38176,5853930.0
88296,5324760.0
10802,5298659.22
43337,4888821.760000001
10807,4844648.66
1799,4228686.0
11296,3820673.9
11297,3667743.3899999997
65013,3590669.8499999996
26827,3468126.3300000005
64870,2927321.1
26826,2870444.0500000003
26828,2860557.18
48106,2857427.52
15626,2827872.9300000006
15627,2772618.330000001
11298,2620041.529999999
43338,2602557.0
64864,2543960.0
36308,2296345.4000000004
48105,2196215.56
10808,2190215.4800000004
64866,1973484.0
17206,1923020.5599999998
64867,1857777.2100000002
43336,1798147.26
64868,1755820.0
64865,1751908.2000000002
42716,1662090.5099999995
22215,1632339.6600000006
38008,1601061.2400000002
38088,1592801.7599999995
42717,1579528.1000000008
19476,1567026.0
34006,1517647.5599999996
64858,1499663.6999999997
87485,1496291.84
34368,1489000.2399999998
69947,1472388.2799999993
65257,1467116.0400000005
10809,1441188.62
25608,1436643.3000000005
43028,1402516.9
68036,1401817.8800000004
64904,1386417.0
69637,1361613.0
19066,1353693.0
38174,1334628.93
36904,1314139.8599999996
48099,1277673.2800000003
34821,1255385.6999999995
936600,1200638.7
100413,1198384.2
89196,1185747.21
88294,1182015.0
11774,1172327.61
10805,1168011.5600000003
87280,1162656.66
17086,1160149.3299999998
87408,1149408.7599999998
19477,1135046.25
65256,1119895.18
42718,1096336.3599999999
89197,1090671.0
87026,1082583.0
43334,1069207.5
11776,1060111.0999999999
89387,1049580.5
37994,1014546.1399999999
43127,1000179.0
15628,984333.5400000002
18006,982917.0
11294,962722.5199999998
19067,961233.0
34007,957106.9299999995
34422,934771.5
89164,932063.6400000004
73055,931839.75
16676,929745.0
37996,929255.1799999998
43285,916944.48
27102,909434.2600000001
43128,907785.0
19068,901065.0
11777,899887.9500000001
34433,889042.5
19478,883471.5
58838,880270.9500000002
35918,877052.7
67526,867167.31
10791,865405.7399999999
77487,860255.7599999998
17916,853030.5
68037,838925.09
65426,834627.3000000003
89577,832291.1999999998
15248,830790.0

2025-01-20 22:57:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 22:57:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 22:57:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 22:57:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 22:57:20 - snowflake.connector.connection - INFO - closed
2025-01-20 22:57:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 22:57:20 - root - INFO - SQL:
SELECT "item_number", SUM("sale_dollars") AS "total_sales_2023"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") = 2023
   GROUP BY "item_number"
   ORDER BY "total_sales_2023" DESC
   LIMIT 100;
Results:
item_number,total_sales_2023
38178,11393245.5
38177,10001010.24
11788,8560030.740000002
1799,7061536.239999999
38176,6565380.0
88296,5252856.0
43337,5014554.57
65013,4394133.450000001
10807,3787875.2
10802,3705297.9199999995
11297,3506902.4899999993
64870,3481509.3000000003
26827,3470328.3799999994
26826,3142294.54
15627,3038113.8000000003
11296,2934681.6
26828,2659707.96
15626,2597208.96
38008,2477608.41
64864,2451872.0
11298,2415090.36
10808,2349334.6299999994
36308,2344074.93
48106,2280671.8600000003
48105,2102410.2399999998
17206,1933558.3099999994
42717,1924516.2300000004
43336,1903360.3199999994
34368,1818087.1799999995
64865,1789262.0699999996
19476,1721601.0
64866,1709734.5
38088,1705444.5599999994
64867,1655136.0
38174,1651129.8299999998
87485,1625383.38
64858,1568007.9000000001
69947,1560944.25
64868,1559764.0
36904,1529576.759999999
19066,1512192.0
64904,1496656.0
34006,1492659.2299999997
22215,1466267.25
42716,1463273.7900000005
43028,1422665.6
34821,1406316.5999999999
10805,1382035.2000000002
25608,1371486.5999999999
87280,1360029.5400000003
11774,1350765.37
68036,1344223.16
65257,1335269.1300000004
936600,1306044.0
87408,1278666.0
88294,1275277.5
89196,1269540.0
10809,1260472.8
42718,1242495.3199999996
69637,1202797.46
100413,1192192.2000000002
43338,1185786.0
89197,1162581.0
43334,1157605.3200000003
10784,1133856.6399999997
17086,1132353.4599999997
86439,1111297.3599999999
11294,1110227.3
48099,1104352.4799999997
37994,1094476.25
77487,1092768.6
65256,1076607.6500000001
18006,1065265.5
19477,1061842.5
11776,1059006.9499999997
43127,1015896.75
89387,996215.2599999999
11777,993814.6999999998
65426,975531.0
34422,974358.0
89177,960131.5900000002
36304,953160.0
15628,951201.0599999997
19067,947622.0
100423,932589.0
37996,918076.0400000002
17916,913466.52
19478,905403.0
16676,863493.75
73055,849597.0
17958,849583.5
89577,847872.1799999999
28867,842312.8899999997
34007,838989.4500000002
34433,836049.75
68037,833288.3800000002
35918,814809.7800000001
43285,813276.0300000001
67527,811854.71
58838,809004.9899999996

2025-01-20 22:57:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 22:57:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 22:57:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 22:57:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 22:57:22 - snowflake.connector.connection - INFO - closed
2025-01-20 22:57:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 22:57:22 - root - INFO - SQL:
SELECT "item_number", EXTRACT(YEAR FROM "date") AS "year", SUM("sale_dollars") AS "total_sales"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") IN (2022, 2023)
   GROUP BY "item_number", "year"
   ORDER BY "item_number", "year"
   LIMIT 100;
Results:
item_number,year,total_sales
100015,2022,31905.0
10006,2022,22967.28
10006,2023,19998.159999999993
100077,2022,13030.08
10008,2022,187142.25
10008,2023,170148.0
10009,2022,16226.550000000003
10009,2023,15973.799999999996
100104,2022,78327.58999999998
100104,2023,120996.91999999998
100148,2023,22443.75
100215,2022,24142.5
100215,2023,23925.0
100216,2022,256.31
100220,2022,45006.58000000001
100220,2023,41121.92000000002
100248,2022,7301.039999999999
100280,2022,128.25
100306,2022,44197.22999999999
100306,2023,27068.159999999996
100413,2022,1198384.1999999997
100413,2023,1192192.2000000002
100423,2022,607671.0
100423,2023,932589.0
100429,2022,3695.100000000001
100429,2023,711.9
100433,2022,14296.46
100433,2023,787.25
100443,2023,13487.999999999995
100490,2023,14687.720000000001
100509,2022,4768.5
100533,2022,4365.0
100533,2023,2250.0
100535,2022,39938.4
100535,2023,34830.0
100568,2022,3762.0
100572,2022,27656.25
100572,2023,10706.879999999997
100605,2022,5651.0999999999985
100605,2023,2608.2
100618,2023,8106.559999999999
100636,2022,848.25
100639,2022,168828.16000000006
100639,2023,159854.08
100642,2023,52947.0
100662,2023,1917.0
100686,2022,19550.64
100686,2023,19696.8
100700,2022,102309.76000000002
100700,2023,75571.19999999997
100737,2022,17063.24
100737,2023,42075.74000000001
100759,2022,6264.0
100795,2022,6418.799999999999
100795,2023,7785.6399999999985
100803,2023,8709.119999999995
100815,2022,42562.689999999995
100815,2023,2043.75
100844,2022,18205.5
100844,2023,30393.0
100847,2022,264630.60000000003
100847,2023,180729.0
100854,2023,7894.499999999996
100855,2022,4462.5
100861,2022,63777.60000000002
100861,2023,148762.8
100862,2022,29876.4
100862,2023,309.6
100865,2023,28496.64
100891,2022,2077.5
100891,2023,607.5
100938,2022,45511.19999999999
100938,2023,36378.00000000001
100939,2022,11973.0
100939,2023,5811.0
100944,2022,68906.23999999998
100944,2023,288.64
100948,2023,5087.88
100954,2022,50457.0
100954,2023,36712.5
101037,2022,294.0
101044,2022,756.0
101046,2022,84972.30000000002
101046,2023,58565.99999999999
101047,2022,68886.0
101047,2023,44136.0
101100,2022,4821.959999999999
101151,2022,279181.8
101151,2023,194738.39999999994
101163,2022,28622.25
101163,2023,25179.0
101172,2022,1293.75
101172,2023,362.25
101180,2022,94053.9
101180,2023,439154.6999999999
101183,2022,7142.400000000002
101183,2023,2380.7999999999997
101192,2022,175.5
101200,2022,5921.1
101209,2023,2488.5

2025-01-20 22:57:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 22:57:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 22:57:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 22:57:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 22:57:24 - snowflake.connector.connection - INFO - closed
2025-01-20 22:57:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 22:57:24 - root - INFO - SQL:
SELECT "item_number", COUNT(*) AS "transaction_count_2023"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") = 2023
   GROUP BY "item_number"
   ORDER BY "transaction_count_2023" DESC
   LIMIT 100;
Results:
item_number,transaction_count_2023
11788,27032
65013,24782
36308,24716
38176,23540
64870,21982
38178,20730
36904,19670
38174,17535
64858,15939
64864,15201
36304,14183
11774,14174
38177,11938
11776,11883
10807,11498
43331,11203
43336,11001
10802,10949
26826,10576
36306,10493
36305,10011
38194,9955
43334,9941
10803,9788
48105,9771
42716,9700
43028,9696
35918,9511
64866,9458
11296,9371
19066,9243
37994,9240
36875,9217
34006,9203
25608,8955
10805,8908
26821,8832
1799,8789
64865,8768
100413,8578
100423,8319
10550,8302
43337,8198
87408,8094
11294,7979
37996,7824
89196,7800
37991,7763
36908,7747
15626,7674
19064,7431
58838,7423
19061,7403
88296,7365
48106,7120
36301,7043
36873,6850
11771,6590
11290,6581
36886,6514
11786,6381
38008,6365
64904,6249
19476,6218
23828,6214
88294,6068
39492,6056
43024,5944
11777,5940
45278,5908
11297,5843
88371,5837
64868,5813
84172,5775
34001,5536
89191,5440
11298,5402
38088,5373
36969,5264
64863,5254
26828,5248
26827,5223
10548,5186
42717,5084
75208,5077
65256,5073
15248,5037
36968,4905
64867,4866
86884,4836
34821,4817
25604,4798
26820,4791
10808,4781
86843,4726
80023,4717
43285,4717
69636,4699
36985,4690
18006,4681

2025-01-20 22:57:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 22:57:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 22:57:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 22:57:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 22:57:26 - snowflake.connector.connection - INFO - closed
2025-01-20 22:57:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 22:57:26 - root - INFO - SQL:
SELECT "item_number", "item_description", SUM("sale_dollars") AS "total_sales_2023"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") = 2023
   GROUP BY "item_number", "item_description"
   ORDER BY "total_sales_2023" DESC
   LIMIT 100;
Results:
item_number,item_description,total_sales_2023
38178,TITOS HANDMADE VODKA,11393245.5
38177,TITOS HANDMADE VODKA,10001010.240000002
11788,BLACK VELVET,8560030.740000002
1799,CAPTAIN MORGAN ORIGINAL SPICED BARREL,7061536.239999999
38176,TITOS HANDMADE VODKA,6565380.0
88296,PATRON SILVER,5252856.0
43337,CAPTAIN MORGAN ORIGINAL SPICED,5014554.569999999
65013,FIREBALL CINNAMON WHISKEY MINI SLEEVE,4394133.450000001
10807,CROWN ROYAL REGAL APPLE,3787875.2000000007
10802,CROWN ROYAL PEACH,3705297.9200000004
11297,CROWN ROYAL,3506902.4899999993
64870,FIREBALL CINNAMON WHISKEY,3481509.3000000003
26827,JACK DANIELS OLD #7 BLACK LABEL,3470328.3799999994
26826,JACK DANIELS OLD #7 BLACK LABEL,3142294.539999999
15627,JAMESON,3038113.8000000003
11296,CROWN ROYAL,2934681.6000000006
26828,JACK DANIELS OLD #7 BLACK LABEL,2659707.96
15626,JAMESON,2597208.96
38008,SMIRNOFF 80PRF PET,2477608.4100000006
64864,FIREBALL CINNAMON WHISKEY,2451872.0
11298,CROWN ROYAL,2415090.3599999994
10808,CROWN ROYAL REGAL APPLE,2349334.630000001
36308,HAWKEYE VODKA,2344074.93
48106,HENNESSY VS,2280671.86
48105,HENNESSY VS,2102410.2399999998
17206,CEDAR RIDGE BOURBON,1933558.3099999996
42717,MALIBU COCONUT,1924516.2300000007
43336,CAPTAIN MORGAN ORIGINAL SPICED,1903360.3199999996
34368,FRIS DANISH VODKA,1818087.1800000002
64865,FIREBALL CINNAMON WHISKEY PET,1789262.07
19476,MAKERS MARK,1721601.0
64866,FIREBALL CINNAMON WHISKEY,1709734.5
38088,PLATINUM 7X VODKA,1705444.5599999991
64867,FIREBALL CINNAMON WHISKEY,1655136.0
38174,TITOS HANDMADE VODKA,1651129.8300000003
87485,DON JULIO BLANCO,1625383.38
64858,FIREBALL CINNAMON WHISKEY MINI DISPENSER,1568007.8999999997
69947,RUMPLE MINZE PEPPERMINT SCHNAPPS LIQUEUR,1560944.2500000002
64868,FIREBALL CINNAMON WHISKEY,1559764.0
36904,MCCORMICK 80PRF VODKA PET,1529576.7599999995
19066,JIM BEAM,1512192.0
64904,FIREBALL CINNAMON WHISKEY PET,1496656.0
34006,ABSOLUT SWEDISH VODKA 80PRF,1492659.23
22215,WOODFORD RESERVE,1466267.25
42716,MALIBU COCONUT,1463273.7900000005
43028,ADMIRAL NELSON SPICED,1422665.5999999999
34821,SVEDKA 80PRF,1406316.5999999996
10805,CROWN ROYAL REGAL APPLE,1382035.1999999997
25608,SEAGRAMS 7 CROWN,1371486.5999999999
87280,CASAMIGOS BLANCO,1360029.5400000003
11774,BLACK VELVET,1350765.3699999999
68036,BAILEYS ORIGINAL IRISH CREAM,1344223.16
65257,JAGERMEISTER LIQUEUR,1335269.1299999994
936600,KIRKLAND SIGNATURE AMERICAN VODKA,1306044.0
87408,JOSE CUERVO ESPECIAL SILVER,1278666.0
88294,PATRON SILVER,1275277.5
89196,JOSE CUERVO ESPECIAL REPOSADO,1269540.0
10809,CROWN ROYAL REGAL APPLE,1260472.8000000003
42718,MALIBU COCONUT,1242495.3199999994
69637,DR MCGILLICUDDYS CHERRY,1202797.46
100413,FIREBALL CINNAMON WHISKEY PARTY BUCKET,1192192.2
43338,CAPTAIN MORGAN ORIGINAL SPICED,1185786.0
89197,JOSE CUERVO ESPECIAL REPOSADO,1162581.0
43334,CAPTAIN MORGAN ORIGINAL SPICED,1157605.32
10784,CROWN ROYAL SALTED CARAMEL,1133856.6400000001
17086,BULLEIT BOURBON,1132353.46
86439,SKREWBALL PEANUT BUTTER WHISKEY,1111297.3599999999
11294,CROWN ROYAL,1110227.3
48099,HENNESSY VS,1104352.4800000002
37994,SMIRNOFF 80PRF,1094476.25
77487,TORTILLA GOLD DSS,1092768.6
65256,JAGERMEISTER LIQUEUR,1076607.6500000001
18006,BUFFALO TRACE BOURBON,1065265.5
19477,MAKERS MARK,1061842.5
11776,BLACK VELVET,1059006.9499999997
43127,BACARDI SUPERIOR,1015896.75
89387,JUAREZ GOLD,996215.2599999999
11777,BLACK VELVET,993814.7000000002
65426,LICOR 43,975531.0
34422,GREY GOOSE,974358.0
89177,CASAMIGOS REPOSADO,960131.5900000001
36304,HAWKEYE VODKA,953160.0
15628,JAMESON,951201.0599999997
19067,JIM BEAM,947622.0
100423,FIREBALL CINNAMON WHISKEY 100ML CARRIER,932589.0
37996,SMIRNOFF 80PRF,918076.0399999999
17916,ELIJAH CRAIG,913466.5200000003
19478,MAKERS MARK,905403.0
16676,BASIL HAYDEN 8YR,863493.75
73055,RUMCHATA,849597.0
17958,EVAN WILLIAMS BLACK,849583.5
89577,MONTEZUMA GOLD,847872.1800000002
28867,TANQUERAY GIN,842312.8899999997
34007,ABSOLUT SWEDISH VODKA 80PRF,838989.4500000001
34433,GREY GOOSE,836049.75
68037,BAILEYS ORIGINAL IRISH CREAM,833288.3800000001
35918,FIVE O'CLOCK VODKA,814809.7799999999
43285,CAPTAIN MORGAN ORIGINAL SPICED PET,813276.0300000001
67527,KAHLUA COFFEE,811854.7100000001
58838,JOSE CUERVO AUTHENTIC LIME MARGARITA,809004.99

2025-01-20 22:57:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 22:57:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 22:57:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 22:57:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 22:57:27 - snowflake.connector.connection - INFO - closed
2025-01-20 22:57:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 22:57:28 - root - INFO - SQL:
SELECT "item_number", AVG("sale_dollars") AS "average_sale_2023"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") = 2023
   GROUP BY "item_number"
   ORDER BY "average_sale_2023" DESC
   LIMIT 100;
Results:
item_number,average_sale_2023
915767,37483.53
926442,31260.0
985419,28350.0
974304,27090.0
926875,22620.0
995198,20866.56
915194,20866.56
916841,20448.0
989290,19711.296000000002
978191,18627.24
917337,18096.0
922473,17010.0
922471,16695.0
988687,16182.0
909265,15147.0
919121,14212.89
936600,13894.08510638298
925114,13609.44
921022,13395.0
925473,13387.5
962095,12926.25
988603,12912.54
925937,12600.0
919564,12440.0
915188,12108.342857142856
919413,11997.0
925213,11878.02
985532,11846.25
985534,11715.359999999999
916850,11476.26
926885,11371.5
920487,11137.5
944632,10923.12
918681,10800.0
923063,10800.0
990019,10742.4
926740,10710.0
920380,10610.14
922261,10575.0
926125,10502.0
918638,10440.0
989289,10322.400000000003
999927,10260.0
918410,10170.0
924923,10003.5
922263,10003.5
926519,9987.779999999999
989288,9618.0
992900,9523.8
994950,9512.935384615386
922290,9506.25
927367,9464.76
922393,9450.0
917929,9383.333333333334
916631,9318.6
917545,8990.32
922208,8904.6
928270,8883.0
923060,8817.6
922262,8775.0
992000,8773.050000000001
908806,8687.56
926684,8666.175000000001
921198,8662.5
922500,8640.0
910470,8640.0
928271,8487.0
921219,8381.25
989291,8378.510769230767
919217,8280.0
919000,8092.26
987514,8020.197551020405
918217,7998.75
922180,7897.5
936859,7810.0992000000015
925934,7702.5
926786,7649.399999999999
988063,7569.246315789478
926219,7565.89
926018,7290.63
914970,7286.400000000001
926632,7200.0
922430,7200.0
922374,7020.0
992148,6969.240000000001
925182,6930.0
905934,6850.8
985687,6750.0
926595,6508.759999999999
944175,6480.0
924890,6336.0
930746,6328.988076923077
926052,6300.0
989292,6087.057777777776
918202,6063.75
916445,6041.828571428572
918460,6030.0
906254,5914.799999999999
922402,5907.84
985682,5850.0

2025-01-20 22:57:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 22:57:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 22:57:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 22:57:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 22:57:29 - snowflake.connector.connection - INFO - closed
2025-01-20 22:57:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 22:57:30 - root - INFO - SQL:
SELECT DISTINCT s1."item_number", s1."item_description"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES" s1
    WHERE EXTRACT(YEAR FROM s1."date") = 2023
      AND s1."item_number" NOT IN (
        SELECT DISTINCT s2."item_number"
        FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES" s2
        WHERE EXTRACT(YEAR FROM s2."date") = 2022
      )
    LIMIT 100;
Results:
item_number,item_description
88543,SAUZA CIEN ANOS PLATA
76239,MOSHINE PEACH MINI
102057,FIREBALL FALL TAILGATE BAG
59205,1800 PASSION FRUIT ULTIMATE MARGARITA
77532,TRADER VICS CHOCOLATE LIQUEUR
18424,REMUS HIGHEST RYE
37690,CM KNEE HIGH DISTILLING VODKA
28485,FORDS GIN
102035,DOS HOMBRES MEZCAL + FEVER TREE PINK GRAPEFRUIT SODA VAP
37785,CM KNEE-HIGH DISTILLING CO LEVY APPLE PIE VODKA
916271,MACKMYRA INTELLIGENS AI:02 SWEDISH SINGLE MALT WHISKY
73253,DAMSO BLUEBERRY SOJU
21671,BP TOWN BRANCH SINGLE BARREL RESERVE BOURBON
942265,THE SCARLET IBIS TRINIDAD RUM
923060,BRECKENRIDGE RESERVE BLEND BETA
916150,AMRUT PEATED INDIAN SINGLE MALT WHISKY
926311,THE CLOVER TENNESSEE STRAIGHT BOURBON
986149,ARETTE GRAN CLASE EXTRA ANEJO
990410,PAOLUCCI AMARO CIOCIARO
906064,TOMINTOUL CIGAR MALT SCOTCH WHISKY
22290,BP YELLOWSTONE HAND PICKED 119PRF
87281,CASAMIGOS BLANCO MINI
61706,JEFFERSONS THE MANHATTAN BARREL FINISH
100662,VAN GOGH FRUIT SAMPLER NP MINI
68624,MIDNIGHT MOON COOKIES & CREAM MOONSHAKE MINI
26471,CLAYTON JAMES TENNESSEE WHISKEY
4987,GLENGOYNE SINGLE MALT SCOTCH 12 YR
25045,LUCA MARIANO SINGLE BARREL RYE
102096,FIREBALL WINTER BAG
76495,OLE SMOKY BANANA WHISKEY
101527,WRITERS TEARS COPPER POT IRISH WHISKEY W/FLASK
80364,OLE SMOKY SOME BEACH CREAM MOONSHINE
59645,GREY GOOSE CLASSIC MARTINI COCKTAIL
28013,10TH MOUNTAIN RYE
906100,SPEYBURN BRADAN ORACH SCOTCH
4436,BENROMACH 10YR
102037,ABSOLUT BLUE W/ CRANBERRY JUICE
38829,WHITE CLAW MANGO VODKA
38782,CM KNEE-HIGH DISTILLING CO SWEET-TEA VODKA
85490,SAN MATIAS ANEJO 135YR
944106,BLACK TOT RUM
923614,FILIBUSTER BOONDOGGLER
922450,BIRD DOG BLACKBERRY RESERVE
937577,CENTURY FARMS CAPTAINS VODKA
985350,CHULA PARRANDA ANEJO
906258,GLEN SCOTIA 10 YEAR OLD UNPEATED SINGLE MALT SCOTCH WHISKY
986143,TEQUILA TAPATIO REPOSADO
21239,1792 SMALL BATCH BOURBON
915864,HA REDBREAST 27 YO
927934,BROTHERHOOD BOURBON
903151,KETEL ONE MINI
920487,OLD SOUL CASK STRENGTH SINGLE BARREL BUY THE BARREL
949387,SAZERAC DE FORGE COGNAC
985764,DON JULIO ROSADO
902846,JOHNNIE WALKER BLACK MINI
927289,IOWISH WHISKEY
942331,SEVEN FATHOMS RUM
984195,99 BUTTERSCOTCH
938771,WYCH DR DISTILLING CARAMEL APPLE
87289,CASAMIGOS MEZCAL
925467,SAGAMORE RYE SHERRY FINISH
985908,ROCK N ROLL TEQUILA GUITAR CRISTALINO REPOSADO
931167,MCCORMICK GIN
85425,CASAMIGOS CRISTALINO
22489,JOJO CHOCOLATE CHIP COOKIE DOUGH FLAVORED WHISKEY
102149,FROST TRAIL VODKA MINI
59551,DELOLA SPRITZ L''ORANGE
967388,SOOH BORGHETTI ESPRESSO LIQUEUR
33427,SOBIESKI GRAPEFRUIT VODKA
63834,ZING ZANG BLAZING BLOODY MARY RTS
102042,RUMCHATA PUMPKIN SPICE MINI
4828,DALMORE 15YR
77534,TRADER VICS WHITE CHOCOLATE LIQUEUR
4476,ARDBEG BIZARREBQ
17921,ELIJAH CRAIG TOASTED BARREL RYDER CUP
85482,UNA VIDA REPOSADO TEQUILA
916269,MACKMYRA BJORKSAV SWEDISH SINGLE MALT WHISKY
77980,TATTERSALL ORANGE LIQUEUR
992167,HA LAST DROP 50YR BGSW 700ML & 50ML
923328,KOVAL SINGLE BARREL WHISKEY RYE AMBURANA BARREL FINISHED
906059,TORABHAIG ALLT GLEANN SINGLE MALT SCOTCH WHISKY
902213,SCORPION MEZCAL ANEJO 1YR
937747,E.T.51 ESPRESSO FLAVORED VODKA
26349,RANCH ROAD WHISKEY
945995,CALICO JACK WHIPPED
951072,BISTRA APRICOT BRANDY
67900,BAILEYS CHOCOLATE
88530,CASAMIGOS REPOSADO
65922,NEW AMSTERDAM PINK WHITNEY PET
76262,KINKY PEACH MANGO MINI
73558,DIRTY MONKEY
102040,CROWN ROYAL DELUXE 1.75L W HOLIDAY BAG AND BOX
967617,MARIE BRIZARD BLCKBERRY LIQUEUR
904362,HA BALVENIE 25YR
76696,CM KNEE-HIGH DISTILILNG CO. WATERMELON VODKA
989006,ASOMBROSO LA ROSA REPOSADO
951584,R. JELINEK 5YR SLIVOVITZ
988102,MONTE ALBAN SILVER TEQUILA
38134,TATTERSALL TIGHTLINE ORGANIC VODKA
905838,OLD PULTENEY SINGLE MALT SCOTCH 18YR

2025-01-20 22:57:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 22:57:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 22:57:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 22:57:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 22:57:31 - snowflake.connector.connection - INFO - closed
2025-01-20 22:57:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 22:57:32 - root - INFO - SQL:
SELECT EXTRACT(MONTH FROM "date") AS "month", "item_number", SUM("sale_dollars") AS "monthly_sales"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE EXTRACT(YEAR FROM "date") = 2023
    GROUP BY "month", "item_number"
    ORDER BY "month", "monthly_sales" DESC
    LIMIT 100;
Results:
month,item_number,monthly_sales
1,38177,890069.44
1,38178,505077.0
1,43337,420207.0200000001
1,38176,404550.0
1,11788,399824.3199999999
1,88296,393876.0
1,10802,379272.9600000001
1,65013,328782.30000000005
1,11297,281306.2000000001
1,1799,278667.0
1,26827,268702.75999999995
1,15627,261263.94000000003
1,10807,251746.55999999997
1,64870,246588.30000000002
1,15626,212990.08
1,64864,209600.0
1,10808,207800.71000000005
1,43338,195885.0
1,48106,191660.93000000005
1,36308,186111.18
1,26826,185135.72
1,64866,158571.0
1,64865,158016.56999999998
1,64868,152559.0
1,42717,150738.21000000002
1,11298,150318.51999999996
1,11296,148544.64
1,19476,145476.0
1,64867,141318.0
1,69947,129736.55999999997
1,43336,126862.65000000004
1,25608,125415.25
1,64904,122728.0
1,26828,121757.22000000002
1,64858,118731.59999999999
1,86439,117771.0
1,36904,116001.35999999996
1,42716,115838.63
1,17206,114588.90999999999
1,43028,114066.06000000001
1,38174,113608.61999999998
1,34368,111615.14000000001
1,10805,111296.64000000001
1,87485,110971.63000000006
1,43334,109950.0
1,65257,109145.00999999998
1,936859,108625.92
1,38088,104939.75999999998
1,38008,104011.0
1,19066,100369.5
1,34006,100238.12999999999
1,67526,99395.27999999998
1,37994,97654.62
1,48099,97619.40000000001
1,17086,96694.39999999998
1,16832,96262.5
1,34821,92922.3
1,67527,92681.64000000001
1,89196,90810.0
1,65426,89805.75
1,69637,88440.0
1,11774,88410.58000000003
1,18006,88218.0
1,17916,87985.44
1,65256,86227.65000000002
1,28867,85812.22999999997
1,11777,85172.00000000001
1,87408,84888.0
1,11776,84725.05000000003
1,42718,82573.75999999997
1,43127,80925.75
1,19067,79111.5
1,68036,78401.05999999998
1,68037,77843.28
1,11294,77828.65999999999
1,88294,77760.0
1,87280,77573.1
1,89387,77568.86
1,10809,77300.83999999998
1,73055,76482.0
1,64136,76078.37999999998
1,16562,74014.5
1,936600,73993.5
1,37998,73847.81000000003
1,100413,73530.00000000001
1,48105,73310.87999999998
1,43285,72733.68000000001
1,34422,72304.5
1,989289,72256.8
1,36304,70197.0
1,34007,70011.37000000001
1,11287,69518.81999999999
1,988063,69094.08
1,37996,68226.18000000002
1,35918,68141.25
1,917929,66960.0
1,89177,66585.19999999997
1,15248,64800.0
1,100423,64539.0
1,89577,64506.78000000001

2025-01-20 22:57:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 22:57:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 22:57:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 22:57:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 22:57:34 - snowflake.connector.connection - INFO - closed
2025-01-20 22:57:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 22:57:34 - root - INFO - SQL:
SELECT t1."item_number", (t2."total_bottles_2023" - t1."total_bottles_2022") AS "bottle_increase"
    FROM
      (SELECT "item_number", SUM("bottles_sold") AS "total_bottles_2022"
       FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
       WHERE EXTRACT(YEAR FROM "date") = 2022
       GROUP BY "item_number") t1
    JOIN
      (SELECT "item_number", SUM("bottles_sold") AS "total_bottles_2023"
       FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
       WHERE EXTRACT(YEAR FROM "date") = 2023
       GROUP BY "item_number") t2
    ON t1."item_number" = t2."item_number"
    ORDER BY "bottle_increase" DESC
    LIMIT 100;
Results:
item_number,bottle_increase
64870,170886
65013,124568
1799,99497
84171,89109
36904,67476
36304,49900
38176,47430
38177,45459
38008,39609
38174,38930
100423,36102
76501,32625
77487,30509
86439,30220
10784,27082
34368,25831
38178,25728
11774,24767
37067,22447
43024,18219
10803,17476
84192,17455
84208,17209
80023,17108
43331,16292
84217,16285
911070,16104
42717,16037
10805,15721
38194,15197
19064,15165
65543,14638
988849,14136
84219,14129
11290,13976
36305,13771
88290,13640
76843,12891
38179,12497
87403,12426
962476,12096
89193,12070
11294,10914
26826,10857
53214,10794
936859,10344
23824,9907
43334,9873
36875,9640
84404,9630
19066,9606
86112,8798
66936,8656
74782,8629
101180,8525
946574,8352
80398,8203
16832,8145
38088,7955
87402,7941
36306,7684
34821,7509
37994,7395
18859,7370
87380,7366
88371,7275
36302,7005
33180,6990
80397,6893
27781,6828
987507,6826
88548,6744
987514,6732
962094,6570
75255,6536
39422,6392
936600,6390
21215,6135
15622,6134
28866,6051
944650,5988
89194,5973
65426,5962
19476,5725
78297,5462
32232,5426
86019,5344
992900,5322
86884,5319
35948,5309
52199,5231
88291,5220
988063,5184
87484,5171
87619,5163
35947,5154
926684,5130
87409,5079
21236,5065
76413,5065

2025-01-20 22:57:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 22:57:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 22:57:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 22:57:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 22:57:35 - snowflake.connector.connection - INFO - closed
2025-01-20 22:57:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 22:58:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 22:58:09 - root - INFO - ```sql
SELECT COALESCE(t2."item_number", t1."item_number") AS "item_number",
       (COALESCE(t2."total_bottles_2023", 0) - COALESCE(t1."total_bottles_2022", 0)) AS "bottle_increase"
FROM
  (SELECT "item_number", SUM("bottles_sold") AS "total_bottles_2022"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") = 2022
   GROUP BY "item_number") t1
FULL OUTER JOIN
  (SELECT "item_number", SUM("bottles_sold") AS "total_bottles_2023"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") = 2023
   GROUP BY "item_number") t2
ON t1."item_number" = t2."item_number"
ORDER BY "bottle_increase" DESC
LIMIT 100;
```
2025-01-20 22:58:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 22:58:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 22:58:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 22:58:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 22:58:11 - snowflake.connector.connection - INFO - closed
2025-01-20 22:58:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 22:58:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 22:58:56 - root - INFO - SQL:
SELECT COALESCE(t2."item_number", t1."item_number") AS "item_number",
       (COALESCE(t2."total_bottles_2023", 0) - COALESCE(t1."total_bottles_2022", 0)) AS "bottle_increase"
FROM
  (SELECT "item_number", SUM("bottles_sold") AS "total_bottles_2022"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") = 2022
   GROUP BY "item_number") t1
FULL OUTER JOIN
  (SELECT "item_number", SUM("bottles_sold") AS "total_bottles_2023"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") = 2023
   GROUP BY "item_number") t2
ON t1."item_number" = t2."item_number"
ORDER BY "bottle_increase" DESC
LIMIT 100;
Results:
item_number,bottle_increase
64870,170886
65013,124568
1799,99497
84171,89109
36904,67476
36304,49900
38176,47430
38177,45459
38008,39609
38174,38930
100423,36102
76501,32625
77487,30509
86439,30220
10784,27082
34368,25831
38178,25728
11774,24767
10777,23979
37067,22447
43024,18219
10803,17476
84192,17455
84208,17209
80023,17108
43331,16292
84217,16285
911070,16104
42717,16037
10805,15721
102092,15535
38194,15197
19064,15165
65533,15102
37868,14857
65543,14638
988849,14136
84219,14129
11290,13976
36305,13771
88290,13640
21493,13318
76843,12891
38179,12497
87403,12426
10778,12365
962476,12096
67900,12095
89193,12070
11294,10914
26826,10857
53214,10794
936859,10344
102149,10304
58855,9933
23824,9907
43334,9873
36875,9640
84404,9630
19066,9606
84135,9403
76830,9371
37712,9099
68024,8990
10776,8934
86112,8798
84214,8746
66936,8656
74782,8629
80362,8601
101180,8525
101988,8506
946574,8352
80398,8203
16832,8145
78186,8045
38088,7955
87402,7941
25614,7809
102057,7757
36306,7684
37959,7603
34821,7509
86423,7491
37994,7395
18859,7370
87380,7366
88371,7275
37952,7229
36302,7005
33180,6990
80397,6893
27781,6828
987507,6826
66524,6824
88548,6744
987514,6732
962094,6570
75255,6536
39422,6392

2025-01-20 22:58:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 22:58:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 22:58:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 22:58:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 22:58:58 - snowflake.connector.connection - INFO - closed
2025-01-20 22:58:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 22:58:58 - root - INFO - SQL:
-- Corrected SQL1:

SELECT COALESCE("vendor_number", 'Unknown') AS "vendor_number",
       COALESCE("vendor_name", 'Unknown') AS "vendor_name",
       SUM("sale_dollars") AS "vendor_sales_2023"
FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
WHERE EXTRACT(YEAR FROM "date") = 2023
GROUP BY COALESCE("vendor_number", 'Unknown'), COALESCE("vendor_name", 'Unknown')
ORDER BY "vendor_sales_2023" DESC
LIMIT 100
Results:
vendor_number,vendor_name,vendor_sales_2023
260,DIAGEO AMERICAS,89011840.78999999
421,SAZERAC COMPANY  INC,66752599.620000005
301,FIFTH GENERATION INC,30844469.729999993
65,JIM BEAM BRANDS,30037947.909999996
370,PERNOD RICARD USA,27709155.02
259,HEAVEN HILL BRANDS,27513247.949999984
35,BACARDI USA INC,22604057.980000008
85,BROWN FORMAN CORP.,20513550.880000006
434,LUXCO INC,16096204.780000003
395,PROXIMO,15669739.900000002
205,E & J GALLO WINERY,9603379.85
420,MOET HENNESSY USA,8389969.7
192,"MAST-JAGERMEISTER US, INC",5266611.97
346,OLE SMOKY DISTILLERY LLC,5252152.9
619,CAMPARI AMERICA,5226865.09
300,MCCORMICK DISTILLING CO.,4720609.33
380,PHILLIPS BEVERAGE,4232280.54
389,REMY COINTREAU USA INC,3821612.8800000004
240,WILLIAM GRANT & SONS INC,3686419.9899999998
125,CEDAR RIDGE VINEYARDS LL,3616066.419999999
255,INFINIUM SPIRITS,3373387.3699999996
368,PARK STREET IMPORTS,3092789.0500000003
297,LAIRD & COMPANY,3070549.6399999997
115,CONSTELLATION BRANDS INC,2539778.1899999995
772,INTERCONTINENTAL PACKAGING COMPANY/PRESTIGE BEVERAGE GROUP,2409294.17
305,MHW LTD,2368884.95
777,"BLUE OX SPIRITS, INC.",2135285.9200000004
830,KIRIN BEER & SPIRITS OF AMERICA INC / FOUR ROSES DISTILLERY,2045571.170000001
803,LEVECKE CORPORATION,1731901.5
654,REVELTON DISTILLING COMPANY,1338860.7
217,MISA IMPORTS INC,1237775.13
306,MISSISSIPPI RIVER DISTILLING COMPANY LLC,1180620.3599999999
214,GOAMERICAGO BEVERAGES LLC / WHISTLEPIG,1021470.7099999998
277,STOLI GROUP,980504.96
492,WESTERN SPIRITS BEVERAGE,918640.7900000004
118,AMERICAN SPIRITS EXCHANGE,872681.0300000001
154,DUNKEL CORPORATION / IOWA DISTILLING,782511.4399999998
229,DEHNER DISTILLERY,693855.5900000001
266,EDRINGTON GROUP USA LLC,675753.9600000001
130,DISARONNO INTERNATIONAL,674977.8400000001
620,MPL BRANDS NV INC/ PATCO BRANDS,608959.08
566,"FOUNDRY DISTILLING COMPANY, LLC",543898.8700000001
472,"TEQUILAS PREMIUM, INC",537352.5399999999
755,WINESOURCE INTERNATIONAL INC.,526883.7099999998
911,FIELD OF DREAMS BEVERAGE COMPANY LLC,468540.0
482,"SOVEREIGN BRANDS, LLC",400293.44999999995
578,S&B FARMS DISTILLERY,372008.23999999993
287,CHATHAM IMPORTS INC,366185.25
342,DV SPIRITS LLC,364011.40000000014
384,PIEDMONT DISTILLERS INC,358055.4799999999
481,SUGARLANDS DISTILLING COMPANY LLC,286576.68
521,JEM BEVERAGE COMPANY / WESTERN SON,279088.00000000006
978,W J DEUTSCH & SONS LTD,272533.17999999993
325,LONELY OAK DISTILLERY,265744.68999999994
195,SWELL LIQUOR LLC,248410.5
536,OLD ELK DISTILLERIES LLC,231076.5
209,MINHAS MICRO DISTILLERY,222525.29999999996
908,BUZZBALLZ LLC / SOUTHERN CHAMPION,192315.0
460,SHAW-ROSS INTERNATIONAL,189432.59999999995
391,HOTALING & CO,187829.12000000005
163,STOLLER IMPORTS INC / MARSALLE COMPANY,182356.74
293,JINRO AMERICA INC,170374.50999999992
100,AIKO IMPORTERS INC,165455.29000000007
422,MACH FLYNT INC.,164553.69
525,CATS EYE DISTILLERY,159136.27
594,"AMERICAN HERITAGE DISTILLERS, LLC / CENTURY FARMS DISTILLERY",156114.09999999998
357,PALM BAY INTERNATIONAL,148822.97999999995
454,SALOON SPIRITS LLC,148289.94
338,"MARUSSIA BEVERAGES USA, INC / NICHE IMPORT",141347.71
617,MIDWEST LIQUOR COMPANY,135158.96000000002
785,MAISON FERRAND USA / COGNAC FERRAND USA INC,123354.9
573,TEMPLETON DISTILLING LLC,115031.34
642,"JAMES JOSEPH SANCTIFIED SPIRITS, LLC / OAK&EDEN",110080.5
363,PATERNO IMPORTS LTD / TERLATO WINES INTERNATIONAL,106614.52000000002
917,"LONE STAR DISTILLERY, LLC/GARRISON BROTHERS DISTILLERY",99193.39
902,"ZING ZANG, LLC",92539.87
611,"GLOBAL BEVERAGE TEAM, LLC",92474.43000000002
888,"TRUST ME VODKA, INC.",92233.5
116,BAD BEAR ENTERPRISES LLC / LEGENDARY RYE,90137.61
79,BRECKENRIDGE DISTILLERY / DOUBLE DIAMOND DISTILLERY LLC,85560.54000000002
285,CHARLES JACQUIN ET CIE,84688.54999999999
353,"JOHN ERNEST DISTILLERY, INC.",77341.93
796,173 CRAFT DISTILLERY,74398.68000000001
926,"GRATON SPIRITS COMPANY, LLC / PURPLE BRANDS",70132.5
308,MANGO BOTTLING,69229.95999999999
261,GRAND PRIX BEVERAGE LLC,68099.82
899,"KENTUCKY PEERLESS DISTILLING COMPANY, LLC",63965.34
900,ATOMIC BRANDS INC,63546.81000000001
662,IA-NATIVE SPIRITS,61793.54
549,"GREEN FROG DISTILLERY, LLC",61004.25
557,"WORLDWIDE LIBATIONS, LLC",60962.84
666,"NORTHWEST NATURAL SPIRITS, LLC / CASCADE SPIRITS",60917.640000000014
448,ST GEORGE SPIRITS INC,59704.5
826,KNEE-HIGH DISTILLING CO. LLC,59103.579999999994
564,JACOB RIEGER & COMPANY LLC,51218.319999999985
558,ALTAMAR BRANDS LLC,49533.81999999999
786,BOTTLE TREE BEVERAGE COMPANY LLC / CATHEAD DISTILLERY,49163.46000000001
764,SODA JERK LLC,48804.0
634,"SAGAMORE WHISKEY, LLC",47210.04999999999
727,BENCHMARK BEVERAGE COMPANY LLC,46451.85

2025-01-20 22:58:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 22:58:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 22:58:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 22:59:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-20 22:59:00 - snowflake.connector.connection - INFO - closed
2025-01-20 22:59:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 22:59:00 - root - INFO - SQL:
-- Corrected SQL2:

SELECT COALESCE(t1."item_number", t2."item_number") AS "item_number",
       COALESCE(t1."total_sales_2022", 0) AS "total_sales_2022",
       COALESCE(t2."total_sales_2023", 0) AS "total_sales_2023"
FROM
  (SELECT "item_number", SUM("sale_dollars") AS "total_sales_2022"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") = 2022
   GROUP BY "item_number") t1
FULL OUTER JOIN
  (SELECT "item_number", SUM("sale_dollars") AS "total_sales_2023"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") = 2023
   GROUP BY "item_number") t2
ON t1."item_number" = t2."item_number"
WHERE COALESCE(t2."total_sales_2023", 0) < COALESCE(t1."total_sales_2022", 0)
ORDER BY (COALESCE(t1."total_sales_2022", 0) - COALESCE(t2."total_sales_2023", 0)) DESC
LIMIT 100
Results:
item_number,total_sales_2022,total_sales_2023
10802,5298659.22,3705297.92
43338,2602557.0,1185786.0
87026,1082583.0,0.0
10807,4844648.659999999,3787875.1999999997
11296,3820673.9000000004,2934681.5999999996
48106,2857427.52,2280671.86
37998,724159.99,246351.15999999997
89164,932063.64,553463.1000000001
101787,374139.0,61425.0
101217,294624.0,0.0
64866,1973484.0,1709734.5
49189,614309.14,352409.8400000001
49186,768142.9800000001,513363.4700000003
47861,440870.4,193279.52000000002
15626,2827872.9299999997,2597208.96
11298,2620041.5299999993,2415090.36
64867,1857777.2099999997,1655136.0
26828,2860557.18,2659707.96
42716,1662090.5099999993,1463273.7900000003
64868,1755820.0,1559764.0
88163,252877.52000000002,61196.48000000001
28279,670576.5,485727.0
10809,1441188.6199999999,1260472.8000000003
48164,358882.27999999997,179651.80000000002
48122,396192.69,219366.90000000002
48099,1277673.2799999998,1104352.48
67901,209226.18000000005,37926.42
22215,1632339.6600000008,1466267.25
47865,597984.0,432240.0
11297,3667743.3899999997,3506902.4899999993
69637,1361613.0,1202797.46
18856,157815.0,0.0
989290,252869.76,98556.48000000001
22244,349650.0,195720.0
101600,151227.0,0.0
38841,207455.25,59402.25
10791,865405.7400000001,717585.2800000003
37167,143632.5,577.5
10628,659590.5,517824.0
89198,743447.25,601956.0
73200,352048.9499999999,212770.68
47863,559915.86,421298.72000000003
38577,228225.0,90627.0
86692,493521.8,359124.15000000014
901369,132153.36000000002,0.0
65257,1467116.04,1335269.1299999994
78293,209556.26000000004,78637.76000000001
101907,127575.0,0.0
49185,669003.7800000001,544589.19
27102,909434.2599999999,785024.4999999999
34155,191716.53000000003,68232.64
19068,901065.0,781224.0
38847,205683.0,86266.5
34007,957106.9299999997,838989.45
900138,117361.80000000003,0.0
101615,119448.0,10638.0
36969,719137.5,611088.0
18198,105124.5,0.0
49086,514361.37000000017,410076.2399999998
43285,916944.48,813276.03
48108,301909.74,199773.36
43128,907785.0,806612.25
48105,2196215.5600000005,2102410.24
919216,93597.12000000002,0.0
64864,2543960.0,2451872.0
64736,119821.35999999999,28275.799999999996
27125,309866.27,218978.08000000002
43126,658451.2800000004,567726.8399999999
5329,489060.0,398580.0
926229,88862.40000000001,0.0
59201,126639.54000000002,38387.94
17194,119539.91999999997,31703.499999999996
39492,715833.75,628548.0
15248,830790.0,744795.0
101151,279181.8,194738.40000000002
100847,264630.6,180729.0
73055,931839.75,849597.0
78133,271654.34,189896.82000000004
58913,107239.79999999999,25813.58999999999
558,78473.60999999997,0.0
25606,332730.0,256905.0
37997,427809.36,352010.6799999999
37938,283736.63999999996,210524.16
19477,1135046.25,1061842.5
962475,95477.76000000001,23224.32
82860,72064.62000000002,0.0
88296,5324760.0,5252856.0
34578,564435.0,492705.0
18196,71559.75,0.0
58838,880270.9500000002,809004.9899999998
28617,70950.0,0.0
19324,69963.75,0.0
11586,97371.0,27972.0
11366,176812.5,108037.5
27783,543708.0,474969.0
100944,68906.23999999999,288.64
994155,68121.0,0.0
67526,867167.3100000002,799778.86
5040,88566.83999999998,21413.530000000002
27780,289044.0,222327.0

2025-01-20 22:59:00 - root - INFO - itercount: 0
2025-01-20 22:59:00 - root - INFO - Database Name: IOWA_LIQUOR_SALES
Schema Name: IOWA_LIQUOR_SALES
DDL describes table information.
,0
table_name,SALES
description,
DDL,"create or replace TABLE SALES (
	""invoice_and_item_number"" VARCHAR(16777216),
	""date"" DATE,
	""store_number"" VARCHAR(16777216),
	""store_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""zip_code"" VARCHAR(16777216),
	""store_location"" BINARY(8388608),
	""county_number"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""category"" VARCHAR(16777216),
	""category_name"" VARCHAR(16777216),
	""vendor_number"" VARCHAR(16777216),
	""vendor_name"" VARCHAR(16777216),
	""item_number"" VARCHAR(16777216),
	""item_description"" VARCHAR(16777216),
	""pack"" NUMBER(38,0),
	""bottle_volume_ml"" NUMBER(38,0),
	""state_bottle_cost"" FLOAT,
	""state_bottle_retail"" FLOAT,
	""bottles_sold"" NUMBER(38,0),
	""sale_dollars"" FLOAT,
	""volume_sold_liters"" FLOAT,
	""volume_sold_gallons"" FLOAT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'IOWA_LIQUOR_SALES': {'IOWA_LIQUOR_SALES': ['SALES']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table**: `"IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"`

**Columns and Potential Usage:**

- **"date"**: To extract the year of each sale, allowing us to differentiate between sales in 2022 and 2023.
- **"item_number"**: Unique identifier for each item, used to group and compare sales by item.
- **"item_description"**: Provides the name of the item for clarity in results.
- **"sale_dollars"**: Represents the total sales revenue for each transaction, used to calculate total sales per item per year.

**SQL Queries:**

1. **View distinct items sold:**
   ```sql
   SELECT DISTINCT "item_number", "item_description"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   LIMIT 100;
   ```

2. **List of years present in the data:**
   ```sql
   SELECT DISTINCT EXTRACT(YEAR FROM "date") AS "year"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   ORDER BY "year"
   LIMIT 100;
   ```

3. **Sample sales data with dates and sale amounts:**
   ```sql
   SELECT "date", "item_number", "sale_dollars"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   ORDER BY "date" DESC
   LIMIT 100;
   ```

4. **Total sales per item for 2022:**
   ```sql
   SELECT "item_number", SUM("sale_dollars") AS "total_sales_2022"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") = 2022
   GROUP BY "item_number"
   ORDER BY "total_sales_2022" DESC
   LIMIT 100;
   ```

5. **Total sales per item for 2023:**
   ```sql
   SELECT "item_number", SUM("sale_dollars") AS "total_sales_2023"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") = 2023
   GROUP BY "item_number"
   ORDER BY "total_sales_2023" DESC
   LIMIT 100;
   ```

6. **Comparison of sales between 2022 and 2023 for items:**
   ```sql
   SELECT "item_number", EXTRACT(YEAR FROM "date") AS "year", SUM("sale_dollars") AS "total_sales"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") IN (2022, 2023)
   GROUP BY "item_number", "year"
   ORDER BY "item_number", "year"
   LIMIT 100;
   ```

7. **Number of transactions per item in 2023:**
   ```sql
   SELECT "item_number", COUNT(*) AS "transaction_count_2023"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") = 2023
   GROUP BY "item_number"
   ORDER BY "transaction_count_2023" DESC
   LIMIT 100;
   ```

8. **List of items with their sales amounts and descriptions in 2023:**
   ```sql
   SELECT "item_number", "item_description", SUM("sale_dollars") AS "total_sales_2023"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") = 2023
   GROUP BY "item_number", "item_description"
   ORDER BY "total_sales_2023" DESC
   LIMIT 100;
   ```

9. **Average sale per transaction for each item in 2023:**
   ```sql
   SELECT "item_number", AVG("sale_dollars") AS "average_sale_2023"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") = 2023
   GROUP BY "item_number"
   ORDER BY "average_sale_2023" DESC
   LIMIT 100;
   ```

10. **Items with sales only in 2023 and not in 2022:**
    ```sql
    SELECT DISTINCT s1."item_number", s1."item_description"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES" s1
    WHERE EXTRACT(YEAR FROM s1."date") = 2023
      AND s1."item_number" NOT IN (
        SELECT DISTINCT s2."item_number"
        FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES" s2
        WHERE EXTRACT(YEAR FROM s2."date") = 2022
      )
    LIMIT 100;
    ```

11. **Sample data to observe sales trends over months in 2023:**
    ```sql
    SELECT EXTRACT(MONTH FROM "date") AS "month", "item_number", SUM("sale_dollars") AS "monthly_sales"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE EXTRACT(YEAR FROM "date") = 2023
    GROUP BY "month", "item_number"
    ORDER BY "month", "monthly_sales" DESC
    LIMIT 100;
    ```

12. **Items with the highest increase in sales quantity between 2022 and 2023:**
    ```sql
    SELECT t1."item_number", (t2."total_bottles_2023" - t1."total_bottles_2022") AS "bottle_increase"
    FROM
      (SELECT "item_number", SUM("bottles_sold") AS "total_bottles_2022"
       FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
       WHERE EXTRACT(YEAR FROM "date") = 2022
       GROUP BY "item_number") t1
    JOIN
      (SELECT "item_number", SUM("bottles_sold") AS "total_bottles_2023"
       FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
       WHERE EXTRACT(YEAR FROM "date") = 2023
       GROUP BY "item_number") t2
    ON t1."item_number" = t2."item_number"
    ORDER BY "bottle_increase" DESC
    LIMIT 100;
    ```

13. **Top stores by sales of a specific item in 2023:**
    ```sql
    SELECT "store_number", "store_name", SUM("sale_dollars") AS "total_sales"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE EXTRACT(YEAR FROM "date") = 2023 AND "item_number" = 'SpecificItemNumber'
    GROUP BY "store_number", "store_name"
    ORDER BY "total_sales" DESC
    LIMIT 100;
    ```

14. **Total sales per vendor in 2023:**
    ```sql
    SELECT "vendor_number", "vendor_name", SUM("sale_dollars") AS "vendor_sales_2023"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE EXTRACT(YEAR FROM "date") = 2023
    GROUP BY "vendor_number", "vendor_name"
    ORDER BY "vendor_sales_2023" DESC
    LIMIT 100;
    ```

15. **Items with decreasing sales from 2022 to 2023:**
    ```sql
    SELECT t1."item_number", t1."total_sales_2022", t2."total_sales_2023"
    FROM
      (SELECT "item_number", SUM("sale_dollars") AS "total_sales_2022"
       FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
       WHERE EXTRACT(YEAR FROM "date") = 2022
       GROUP BY "item_number") t1
    JOIN
      (SELECT "item_number", SUM("sale_dollars") AS "total_sales_2023"
       FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
       WHERE EXTRACT(YEAR FROM "date") = 2023
       GROUP BY "item_number") t2
    ON t1."item_number" = t2."item_number"
    WHERE t2."total_sales_2023" < t1."total_sales_2022"
    ORDER BY (t1."total_sales_2022" - t2."total_sales_2023") DESC
    LIMIT 100;
    ```

These queries explore the relevant data needed to analyze year-over-year growth percentages in total sales revenue for each item between 2022 and 2023.Query:
SELECT DISTINCT "item_number", "item_description"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   LIMIT 100;
Answer:
item_number,item_description
67540,KAHLUA FRENCH VANILLA LIQUEUR
64559,THE BITTER TRUTH ELDERFLOWER LIQUEUR
64716,CIROC PEACH
64593,CANADIAN CLUB DOCK 57 BLACKBERRY
30316,GORDON'S GIN LONDON DRY
33256,SEAGRAMS LIME TWISTED GIN
36617,NEW AMSTERDAM RASPBERRY
77740,SMIRNOFF RASPBERRY
84142,99 PEACHES PET MINI
43025,ADMIRAL NELSON SPICED PET
100662,VAN GOGH FRUIT SAMPLER NP MINI
73526,DEKUYPER MELON LIQUEUR
101706,ST GERMAIN W/ CARAFE PACK
73456,DEKUYPER LUSCIOUS RAZZMATAZZ
26101,KEEPERS HEARTS IRISH WHISKEY
12476,CANADIAN MIST WHISKY PET
102096,FIREBALL WINTER BAG
5430,LAGAVULIN 16YR SINGLE MALT SCOTCH
5924,GLENLIVET CARIBBEAN RESERVE
58836,JOSE CUERVO AUTHENTIC LIME MARGARITA
64121,ANCHO REYES
64489,CAROLANS SALTED CARAMEL
65109,GREY GOOSE VX
14530,REVEL STOKE CHERRY MINI
27474,BIRD DOG BLACKBERRY
28279,JIM BEAM PEACH
34366,FRIS DANISH VODKA
36871,CIROC 80PRF
35427,RUSSIAN STANDARD PLATINUM VODKA
12861,RICH & RARE CARAMEL MINI
37888,SEAGRAMS VODKA
38008,SMIRNOFF 80PRF PET
77900,SMIRNOFF SOURS BERRY LEMON
86018,BLACK VELVET PEACH CANADIAN WHISKEY
102092,CAPTAIN MORGAN OSR W/NFL TIN CUP
74740,SLOW AND LOW
57168,CHI-CHI'S CHOCOLATE MALT
4716,CHIVAS REGAL 12YR
37868,FROST TRAIL VODKA
18861,LARCENY BARREL PROOF
26586,GENTLEMAN JACK
21878,VERY OLD BARTON BOURBON CRAFTED 86PRF
18858,LARCENY
54444,PARAMOUNT APRICOT BRANDY
5606,MCCLELLAND ISLAY
67186,TUACA LIQUEUR
82847,DEKUYPER LUSCIOUS PEACHTREE
30236,GILBEYS GIN
34433,GREY GOOSE
87194,818 BLANCO TEQUILA
34578,PINNACLE
36595,KINKY VODKA
39868,SMIRNOFF 100PRF
88922,1800 CRISTALINO
54448,PARAMOUNT APRICOT BRANDY
101126,JIM BEAM FLAVORS 50ML VARIETY PACK
34001,ABSOLUT SWEDISH VODKA 80PRF MINI
80236,IOWISH CREAM LIQUEUR
19068,JIM BEAM
86884,SOUTHERN COMFORT
31658,PARAMOUNT GIN
33660,SVEDKA MANGO PINEAPPLE
16538,ANCIENT AGE 10 STAR BOURBON
65896,METAXA OUZO
67556,KAMORA COFFEE LIQUEUR
67296,YUKON JACK PERMA FROST SCHNAPPS DISCO
68559,KERRYGOLD IRISH CREAM LIQUEUR
101239,WHISTLEPIG RYE PIGLETS MINI
101462,YUKON JACK ASSORTED MINIS
35916,FIVE O'CLOCK VODKA
36258,DEHNER DISTILLERY VODKA
33110,INDOGGO STRAWBERRY GIN
86668,JACK DANIELS TENNESSEE HONEY MINI
36901,MCCORMICK 80PRF VODKA MINI
36908,MCCORMICK VODKA PET
42009,UV CAKE VODKA
77050,FIELD FIRE
63345,ON THE ROCKS COCKTAILS TRES GEN JALAPENO PINEAPPLE MARGARITA
102057,FIREBALL FALL TAILGATE BAG
35947,FLEISCHMANNS 80PRF VODKA
51328,MARASKA SLIVOVITZ 10YR
87725,GRAN CORAMINO REPOSADO CRISTALINO
84187,99 CINNAMON
17085,BULLEIT BOURBON
22244,YELLOWSTONE SELECT
86112,DEKUYPER TRIPLE SEC
59037,DESERT ISLAND LONG ISLAND ICED TEA COCKTAIL
20368,OLD FORESTER BOURBON 86PRF
31718,PHILLIPS GIN
42666,MT GAY ECLIPSE RUM
21538,STAGG BOURBON
68036,BAILEYS ORIGINAL IRISH CREAM
67526,KAHLUA COFFEE
26700,CODY ROAD RYE MINI
28236,BOMBAY SAPPHIRE GIN
34395,EFFEN CUCUMBER
35946,FLEISCHMANN'S ROYAL VODKA
15582,FINAGRENS IRISH WHISKEY
34423,GREY GOOSE
84393,99 WATERMELON PET MINI
Query:
SELECT DISTINCT EXTRACT(YEAR FROM "date") AS "year"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   ORDER BY "year"
   LIMIT 100;
Answer:
year
2012
2013
2014
2015
2016
2017
2018
2019
2020
2021
2022
2023
2024
Query:
SELECT "date", "item_number", "sale_dollars"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   ORDER BY "date" DESC
   LIMIT 100;
Answer:
date,item_number,sale_dollars
2024-09-30,89196,216.0
2024-09-30,64858,77.4
2024-09-30,80145,18.0
2024-09-30,76637,7.26
2024-09-30,47859,67.47
2024-09-30,11290,8.64
2024-09-30,38177,237.12
2024-09-30,16342,390.0
2024-09-30,11290,17.28
2024-09-30,26667,149.88
2024-09-30,14519,42.75
2024-09-30,14192,45.0
2024-09-30,43331,86.4
2024-09-30,64866,162.0
2024-09-30,64759,7.5
2024-09-30,35916,136.56
2024-09-30,18989,269.82
2024-09-30,38176,180.0
2024-09-30,35914,69.6
2024-09-30,985535,810.51
2024-09-30,88371,143.22
2024-09-30,35435,144.0
2024-09-30,65013,309.6
2024-09-30,65013,154.8
2024-09-30,100423,72.0
2024-09-30,21212,82.5
2024-09-30,87586,44.28
2024-09-30,19064,201.6
2024-09-30,20368,32.25
2024-09-30,69618,53.36
2024-09-30,80456,120.6
2024-09-30,71886,5.01
2024-09-30,15818,15.75
2024-09-30,11774,117.12
2024-09-30,34001,23.76
2024-09-30,26821,207.0
2024-09-30,16396,234.0
2024-09-30,38179,15.72
2024-09-30,43120,1349.4
2024-09-30,10550,54.0
2024-09-30,62971,117.0
2024-09-30,36447,94.05
2024-09-30,11290,17.28
2024-09-30,87043,82.5
2024-09-30,30528,69.78
2024-09-30,12408,90.0
2024-09-30,76106,15.0
2024-09-30,87181,225.0
2024-09-30,19026,90.0
2024-09-30,37996,74.28
2024-09-30,48254,413.76
2024-09-30,27544,198.0
2024-09-30,67309,135.0
2024-09-30,86669,37.14
2024-09-30,64870,144.0
2024-09-30,27474,103.5
2024-09-30,80358,13.13
2024-09-30,86987,49.5
2024-09-30,19494,45.0
2024-09-30,16344,101.25
2024-09-30,21024,60.15
2024-09-30,11776,54.0
2024-09-30,76721,43.5
2024-09-30,49185,216.96
2024-09-30,22215,432.96
2024-09-30,43036,13.14
2024-09-30,22228,1462.5
2024-09-30,64863,7.5
2024-09-30,57210,45.0
2024-09-30,102202,92.51
2024-09-30,11776,108.0
2024-09-30,47865,150.0
2024-09-30,69667,202.56
2024-09-30,25601,111.12
2024-09-30,11786,108.0
2024-09-30,39422,13.84
2024-09-30,69657,202.56
2024-09-30,84160,77.4
2024-09-30,10803,34.56
2024-09-30,8828,34.5
2024-09-30,18103,180.0
2024-09-30,75206,14.52
2024-09-30,25393,25.48
2024-09-30,89242,163.8
2024-09-30,26827,91.23
2024-09-30,36970,144.0
2024-09-30,21598,83.16
2024-09-30,73055,63.0
2024-09-30,87035,21.0
2024-09-30,15621,19.8
2024-09-30,87485,278.94
2024-09-30,38176,180.0
2024-09-30,40594,144.0
2024-09-30,86884,7.17
2024-09-30,86691,51.75
2024-09-30,102149,70.8
2024-09-30,65199,20.25
2024-09-30,26826,286.44
2024-09-30,36904,66.24
2024-09-30,88290,28.5
Query:
SELECT "item_number", SUM("sale_dollars") AS "total_sales_2022"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") = 2022
   GROUP BY "item_number"
   ORDER BY "total_sales_2022" DESC
   LIMIT 100;
Answer:
item_number,total_sales_2022
38178,10659997.5
38177,9032344.649999999
11788,8276139.199999998
38176,5853930.0
88296,5324760.0
10802,5298659.22
43337,4888821.760000001
10807,4844648.66
1799,4228686.0
11296,3820673.9
11297,3667743.3899999997
65013,3590669.8499999996
26827,3468126.3300000005
64870,2927321.1
26826,2870444.0500000003
26828,2860557.18
48106,2857427.52
15626,2827872.9300000006
15627,2772618.330000001
11298,2620041.529999999
43338,2602557.0
64864,2543960.0
36308,2296345.4000000004
48105,2196215.56
10808,2190215.4800000004
64866,1973484.0
17206,1923020.5599999998
64867,1857777.2100000002
43336,1798147.26
64868,1755820.0
64865,1751908.2000000002
42716,1662090.5099999995
22215,1632339.6600000006
38008,1601061.2400000002
38088,1592801.7599999995
42717,1579528.1000000008
19476,1567026.0
34006,1517647.5599999996
64858,1499663.6999999997
87485,1496291.84
34368,1489000.2399999998
69947,1472388.2799999993
65257,1467116.0400000005
10809,1441188.62
25608,1436643.3000000005
43028,1402516.9
68036,1401817.8800000004
64904,1386417.0
69637,1361613.0
19066,1353693.0
38174,1334628.93
36904,1314139.8599999996
48099,1277673.2800000003
34821,1255385.6999999995
936600,1200638.7
100413,1198384.2
89196,1185747.21
88294,1182015.0
11774,1172327.61
10805,1168011.5600000003
87280,1162656.66
17086,1160149.3299999998
87408,1149408.7599999998
19477,1135046.25
65256,1119895.18
42718,1096336.3599999999
89197,1090671.0
87026,1082583.0
43334,1069207.5
11776,1060111.0999999999
89387,1049580.5
37994,1014546.1399999999
43127,1000179.0
15628,984333.5400000002
18006,982917.0
11294,962722.5199999998
19067,961233.0
34007,957106.9299999995
34422,934771.5
89164,932063.6400000004
73055,931839.75
16676,929745.0
37996,929255.1799999998
43285,916944.48
27102,909434.2600000001
43128,907785.0
19068,901065.0
11777,899887.9500000001
34433,889042.5
19478,883471.5
58838,880270.9500000002
35918,877052.7
67526,867167.31
10791,865405.7399999999
77487,860255.7599999998
17916,853030.5
68037,838925.09
65426,834627.3000000003
89577,832291.1999999998
15248,830790.0
Query:
SELECT "item_number", SUM("sale_dollars") AS "total_sales_2023"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") = 2023
   GROUP BY "item_number"
   ORDER BY "total_sales_2023" DESC
   LIMIT 100;
Answer:
item_number,total_sales_2023
38178,11393245.5
38177,10001010.24
11788,8560030.740000002
1799,7061536.239999999
38176,6565380.0
88296,5252856.0
43337,5014554.57
65013,4394133.450000001
10807,3787875.2
10802,3705297.9199999995
11297,3506902.4899999993
64870,3481509.3000000003
26827,3470328.3799999994
26826,3142294.54
15627,3038113.8000000003
11296,2934681.6
26828,2659707.96
15626,2597208.96
38008,2477608.41
64864,2451872.0
11298,2415090.36
10808,2349334.6299999994
36308,2344074.93
48106,2280671.8600000003
48105,2102410.2399999998
17206,1933558.3099999994
42717,1924516.2300000004
43336,1903360.3199999994
34368,1818087.1799999995
64865,1789262.0699999996
19476,1721601.0
64866,1709734.5
38088,1705444.5599999994
64867,1655136.0
38174,1651129.8299999998
87485,1625383.38
64858,1568007.9000000001
69947,1560944.25
64868,1559764.0
36904,1529576.759999999
19066,1512192.0
64904,1496656.0
34006,1492659.2299999997
22215,1466267.25
42716,1463273.7900000005
43028,1422665.6
34821,1406316.5999999999
10805,1382035.2000000002
25608,1371486.5999999999
87280,1360029.5400000003
11774,1350765.37
68036,1344223.16
65257,1335269.1300000004
936600,1306044.0
87408,1278666.0
88294,1275277.5
89196,1269540.0
10809,1260472.8
42718,1242495.3199999996
69637,1202797.46
100413,1192192.2000000002
43338,1185786.0
89197,1162581.0
43334,1157605.3200000003
10784,1133856.6399999997
17086,1132353.4599999997
86439,1111297.3599999999
11294,1110227.3
48099,1104352.4799999997
37994,1094476.25
77487,1092768.6
65256,1076607.6500000001
18006,1065265.5
19477,1061842.5
11776,1059006.9499999997
43127,1015896.75
89387,996215.2599999999
11777,993814.6999999998
65426,975531.0
34422,974358.0
89177,960131.5900000002
36304,953160.0
15628,951201.0599999997
19067,947622.0
100423,932589.0
37996,918076.0400000002
17916,913466.52
19478,905403.0
16676,863493.75
73055,849597.0
17958,849583.5
89577,847872.1799999999
28867,842312.8899999997
34007,838989.4500000002
34433,836049.75
68037,833288.3800000002
35918,814809.7800000001
43285,813276.0300000001
67527,811854.71
58838,809004.9899999996
Query:
SELECT "item_number", EXTRACT(YEAR FROM "date") AS "year", SUM("sale_dollars") AS "total_sales"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") IN (2022, 2023)
   GROUP BY "item_number", "year"
   ORDER BY "item_number", "year"
   LIMIT 100;
Answer:
item_number,year,total_sales
100015,2022,31905.0
10006,2022,22967.28
10006,2023,19998.159999999993
100077,2022,13030.08
10008,2022,187142.25
10008,2023,170148.0
10009,2022,16226.550000000003
10009,2023,15973.799999999996
100104,2022,78327.58999999998
100104,2023,120996.91999999998
100148,2023,22443.75
100215,2022,24142.5
100215,2023,23925.0
100216,2022,256.31
100220,2022,45006.58000000001
100220,2023,41121.92000000002
100248,2022,7301.039999999999
100280,2022,128.25
100306,2022,44197.22999999999
100306,2023,27068.159999999996
100413,2022,1198384.1999999997
100413,2023,1192192.2000000002
100423,2022,607671.0
100423,2023,932589.0
100429,2022,3695.100000000001
100429,2023,711.9
100433,2022,14296.46
100433,2023,787.25
100443,2023,13487.999999999995
100490,2023,14687.720000000001
100509,2022,4768.5
100533,2022,4365.0
100533,2023,2250.0
100535,2022,39938.4
100535,2023,34830.0
100568,2022,3762.0
100572,2022,27656.25
100572,2023,10706.879999999997
100605,2022,5651.0999999999985
100605,2023,2608.2
100618,2023,8106.559999999999
100636,2022,848.25
100639,2022,168828.16000000006
100639,2023,159854.08
100642,2023,52947.0
100662,2023,1917.0
100686,2022,19550.64
100686,2023,19696.8
100700,2022,102309.76000000002
100700,2023,75571.19999999997
100737,2022,17063.24
100737,2023,42075.74000000001
100759,2022,6264.0
100795,2022,6418.799999999999
100795,2023,7785.6399999999985
100803,2023,8709.119999999995
100815,2022,42562.689999999995
100815,2023,2043.75
100844,2022,18205.5
100844,2023,30393.0
100847,2022,264630.60000000003
100847,2023,180729.0
100854,2023,7894.499999999996
100855,2022,4462.5
100861,2022,63777.60000000002
100861,2023,148762.8
100862,2022,29876.4
100862,2023,309.6
100865,2023,28496.64
100891,2022,2077.5
100891,2023,607.5
100938,2022,45511.19999999999
100938,2023,36378.00000000001
100939,2022,11973.0
100939,2023,5811.0
100944,2022,68906.23999999998
100944,2023,288.64
100948,2023,5087.88
100954,2022,50457.0
100954,2023,36712.5
101037,2022,294.0
101044,2022,756.0
101046,2022,84972.30000000002
101046,2023,58565.99999999999
101047,2022,68886.0
101047,2023,44136.0
101100,2022,4821.959999999999
101151,2022,279181.8
101151,2023,194738.39999999994
101163,2022,28622.25
101163,2023,25179.0
101172,2022,1293.75
101172,2023,362.25
101180,2022,94053.9
101180,2023,439154.6999999999
101183,2022,7142.400000000002
101183,2023,2380.7999999999997
101192,2022,175.5
101200,2022,5921.1
101209,2023,2488.5
Query:
SELECT "item_number", COUNT(*) AS "transaction_count_2023"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") = 2023
   GROUP BY "item_number"
   ORDER BY "transaction_count_2023" DESC
   LIMIT 100;
Answer:
item_number,transaction_count_2023
11788,27032
65013,24782
36308,24716
38176,23540
64870,21982
38178,20730
36904,19670
38174,17535
64858,15939
64864,15201
36304,14183
11774,14174
38177,11938
11776,11883
10807,11498
43331,11203
43336,11001
10802,10949
26826,10576
36306,10493
36305,10011
38194,9955
43334,9941
10803,9788
48105,9771
42716,9700
43028,9696
35918,9511
64866,9458
11296,9371
19066,9243
37994,9240
36875,9217
34006,9203
25608,8955
10805,8908
26821,8832
1799,8789
64865,8768
100413,8578
100423,8319
10550,8302
43337,8198
87408,8094
11294,7979
37996,7824
89196,7800
37991,7763
36908,7747
15626,7674
19064,7431
58838,7423
19061,7403
88296,7365
48106,7120
36301,7043
36873,6850
11771,6590
11290,6581
36886,6514
11786,6381
38008,6365
64904,6249
19476,6218
23828,6214
88294,6068
39492,6056
43024,5944
11777,5940
45278,5908
11297,5843
88371,5837
64868,5813
84172,5775
34001,5536
89191,5440
11298,5402
38088,5373
36969,5264
64863,5254
26828,5248
26827,5223
10548,5186
42717,5084
75208,5077
65256,5073
15248,5037
36968,4905
64867,4866
86884,4836
34821,4817
25604,4798
26820,4791
10808,4781
86843,4726
80023,4717
43285,4717
69636,4699
36985,4690
18006,4681
Query:
SELECT "item_number", "item_description", SUM("sale_dollars") AS "total_sales_2023"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") = 2023
   GROUP BY "item_number", "item_description"
   ORDER BY "total_sales_2023" DESC
   LIMIT 100;
Answer:
item_number,item_description,total_sales_2023
38178,TITOS HANDMADE VODKA,11393245.5
38177,TITOS HANDMADE VODKA,10001010.240000002
11788,BLACK VELVET,8560030.740000002
1799,CAPTAIN MORGAN ORIGINAL SPICED BARREL,7061536.239999999
38176,TITOS HANDMADE VODKA,6565380.0
88296,PATRON SILVER,5252856.0
43337,CAPTAIN MORGAN ORIGINAL SPICED,5014554.569999999
65013,FIREBALL CINNAMON WHISKEY MINI SLEEVE,4394133.450000001
10807,CROWN ROYAL REGAL APPLE,3787875.2000000007
10802,CROWN ROYAL PEACH,3705297.9200000004
11297,CROWN ROYAL,3506902.4899999993
64870,FIREBALL CINNAMON WHISKEY,3481509.3000000003
26827,JACK DANIELS OLD #7 BLACK LABEL,3470328.3799999994
26826,JACK DANIELS OLD #7 BLACK LABEL,3142294.539999999
15627,JAMESON,3038113.8000000003
11296,CROWN ROYAL,2934681.6000000006
26828,JACK DANIELS OLD #7 BLACK LABEL,2659707.96
15626,JAMESON,2597208.96
38008,SMIRNOFF 80PRF PET,2477608.4100000006
64864,FIREBALL CINNAMON WHISKEY,2451872.0
11298,CROWN ROYAL,2415090.3599999994
10808,CROWN ROYAL REGAL APPLE,2349334.630000001
36308,HAWKEYE VODKA,2344074.93
48106,HENNESSY VS,2280671.86
48105,HENNESSY VS,2102410.2399999998
17206,CEDAR RIDGE BOURBON,1933558.3099999996
42717,MALIBU COCONUT,1924516.2300000007
43336,CAPTAIN MORGAN ORIGINAL SPICED,1903360.3199999996
34368,FRIS DANISH VODKA,1818087.1800000002
64865,FIREBALL CINNAMON WHISKEY PET,1789262.07
19476,MAKERS MARK,1721601.0
64866,FIREBALL CINNAMON WHISKEY,1709734.5
38088,PLATINUM 7X VODKA,1705444.5599999991
64867,FIREBALL CINNAMON WHISKEY,1655136.0
38174,TITOS HANDMADE VODKA,1651129.8300000003
87485,DON JULIO BLANCO,1625383.38
64858,FIREBALL CINNAMON WHISKEY MINI DISPENSER,1568007.8999999997
69947,RUMPLE MINZE PEPPERMINT SCHNAPPS LIQUEUR,1560944.2500000002
64868,FIREBALL CINNAMON WHISKEY,1559764.0
36904,MCCORMICK 80PRF VODKA PET,1529576.7599999995
19066,JIM BEAM,1512192.0
64904,FIREBALL CINNAMON WHISKEY PET,1496656.0
34006,ABSOLUT SWEDISH VODKA 80PRF,1492659.23
22215,WOODFORD RESERVE,1466267.25
42716,MALIBU COCONUT,1463273.7900000005
43028,ADMIRAL NELSON SPICED,1422665.5999999999
34821,SVEDKA 80PRF,1406316.5999999996
10805,CROWN ROYAL REGAL APPLE,1382035.1999999997
25608,SEAGRAMS 7 CROWN,1371486.5999999999
87280,CASAMIGOS BLANCO,1360029.5400000003
11774,BLACK VELVET,1350765.3699999999
68036,BAILEYS ORIGINAL IRISH CREAM,1344223.16
65257,JAGERMEISTER LIQUEUR,1335269.1299999994
936600,KIRKLAND SIGNATURE AMERICAN VODKA,1306044.0
87408,JOSE CUERVO ESPECIAL SILVER,1278666.0
88294,PATRON SILVER,1275277.5
89196,JOSE CUERVO ESPECIAL REPOSADO,1269540.0
10809,CROWN ROYAL REGAL APPLE,1260472.8000000003
42718,MALIBU COCONUT,1242495.3199999994
69637,DR MCGILLICUDDYS CHERRY,1202797.46
100413,FIREBALL CINNAMON WHISKEY PARTY BUCKET,1192192.2
43338,CAPTAIN MORGAN ORIGINAL SPICED,1185786.0
89197,JOSE CUERVO ESPECIAL REPOSADO,1162581.0
43334,CAPTAIN MORGAN ORIGINAL SPICED,1157605.32
10784,CROWN ROYAL SALTED CARAMEL,1133856.6400000001
17086,BULLEIT BOURBON,1132353.46
86439,SKREWBALL PEANUT BUTTER WHISKEY,1111297.3599999999
11294,CROWN ROYAL,1110227.3
48099,HENNESSY VS,1104352.4800000002
37994,SMIRNOFF 80PRF,1094476.25
77487,TORTILLA GOLD DSS,1092768.6
65256,JAGERMEISTER LIQUEUR,1076607.6500000001
18006,BUFFALO TRACE BOURBON,1065265.5
19477,MAKERS MARK,1061842.5
11776,BLACK VELVET,1059006.9499999997
43127,BACARDI SUPERIOR,1015896.75
89387,JUAREZ GOLD,996215.2599999999
11777,BLACK VELVET,993814.7000000002
65426,LICOR 43,975531.0
34422,GREY GOOSE,974358.0
89177,CASAMIGOS REPOSADO,960131.5900000001
36304,HAWKEYE VODKA,953160.0
15628,JAMESON,951201.0599999997
19067,JIM BEAM,947622.0
100423,FIREBALL CINNAMON WHISKEY 100ML CARRIER,932589.0
37996,SMIRNOFF 80PRF,918076.0399999999
17916,ELIJAH CRAIG,913466.5200000003
19478,MAKERS MARK,905403.0
16676,BASIL HAYDEN 8YR,863493.75
73055,RUMCHATA,849597.0
17958,EVAN WILLIAMS BLACK,849583.5
89577,MONTEZUMA GOLD,847872.1800000002
28867,TANQUERAY GIN,842312.8899999997
34007,ABSOLUT SWEDISH VODKA 80PRF,838989.4500000001
34433,GREY GOOSE,836049.75
68037,BAILEYS ORIGINAL IRISH CREAM,833288.3800000001
35918,FIVE O'CLOCK VODKA,814809.7799999999
43285,CAPTAIN MORGAN ORIGINAL SPICED PET,813276.0300000001
67527,KAHLUA COFFEE,811854.7100000001
58838,JOSE CUERVO AUTHENTIC LIME MARGARITA,809004.99
Query:
SELECT "item_number", AVG("sale_dollars") AS "average_sale_2023"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") = 2023
   GROUP BY "item_number"
   ORDER BY "average_sale_2023" DESC
   LIMIT 100;
Answer:
item_number,average_sale_2023
915767,37483.53
926442,31260.0
985419,28350.0
974304,27090.0
926875,22620.0
995198,20866.56
915194,20866.56
916841,20448.0
989290,19711.296000000002
978191,18627.24
917337,18096.0
922473,17010.0
922471,16695.0
988687,16182.0
909265,15147.0
919121,14212.89
936600,13894.08510638298
925114,13609.44
921022,13395.0
925473,13387.5
962095,12926.25
988603,12912.54
925937,12600.0
919564,12440.0
915188,12108.342857142856
919413,11997.0
925213,11878.02
985532,11846.25
985534,11715.359999999999
916850,11476.26
926885,11371.5
920487,11137.5
944632,10923.12
918681,10800.0
923063,10800.0
990019,10742.4
926740,10710.0
920380,10610.14
922261,10575.0
926125,10502.0
918638,10440.0
989289,10322.400000000003
999927,10260.0
918410,10170.0
924923,10003.5
922263,10003.5
926519,9987.779999999999
989288,9618.0
992900,9523.8
994950,9512.935384615386
922290,9506.25
927367,9464.76
922393,9450.0
917929,9383.333333333334
916631,9318.6
917545,8990.32
922208,8904.6
928270,8883.0
923060,8817.6
922262,8775.0
992000,8773.050000000001
908806,8687.56
926684,8666.175000000001
921198,8662.5
922500,8640.0
910470,8640.0
928271,8487.0
921219,8381.25
989291,8378.510769230767
919217,8280.0
919000,8092.26
987514,8020.197551020405
918217,7998.75
922180,7897.5
936859,7810.0992000000015
925934,7702.5
926786,7649.399999999999
988063,7569.246315789478
926219,7565.89
926018,7290.63
914970,7286.400000000001
926632,7200.0
922430,7200.0
922374,7020.0
992148,6969.240000000001
925182,6930.0
905934,6850.8
985687,6750.0
926595,6508.759999999999
944175,6480.0
924890,6336.0
930746,6328.988076923077
926052,6300.0
989292,6087.057777777776
918202,6063.75
916445,6041.828571428572
918460,6030.0
906254,5914.799999999999
922402,5907.84
985682,5850.0
Query:
SELECT DISTINCT s1."item_number", s1."item_description"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES" s1
    WHERE EXTRACT(YEAR FROM s1."date") = 2023
      AND s1."item_number" NOT IN (
        SELECT DISTINCT s2."item_number"
        FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES" s2
        WHERE EXTRACT(YEAR FROM s2."date") = 2022
      )
    LIMIT 100;
Answer:
item_number,item_description
88543,SAUZA CIEN ANOS PLATA
76239,MOSHINE PEACH MINI
102057,FIREBALL FALL TAILGATE BAG
59205,1800 PASSION FRUIT ULTIMATE MARGARITA
77532,TRADER VICS CHOCOLATE LIQUEUR
18424,REMUS HIGHEST RYE
37690,CM KNEE HIGH DISTILLING VODKA
28485,FORDS GIN
102035,DOS HOMBRES MEZCAL + FEVER TREE PINK GRAPEFRUIT SODA VAP
37785,CM KNEE-HIGH DISTILLING CO LEVY APPLE PIE VODKA
916271,MACKMYRA INTELLIGENS AI:02 SWEDISH SINGLE MALT WHISKY
73253,DAMSO BLUEBERRY SOJU
21671,BP TOWN BRANCH SINGLE BARREL RESERVE BOURBON
942265,THE SCARLET IBIS TRINIDAD RUM
923060,BRECKENRIDGE RESERVE BLEND BETA
916150,AMRUT PEATED INDIAN SINGLE MALT WHISKY
926311,THE CLOVER TENNESSEE STRAIGHT BOURBON
986149,ARETTE GRAN CLASE EXTRA ANEJO
990410,PAOLUCCI AMARO CIOCIARO
906064,TOMINTOUL CIGAR MALT SCOTCH WHISKY
22290,BP YELLOWSTONE HAND PICKED 119PRF
87281,CASAMIGOS BLANCO MINI
61706,JEFFERSONS THE MANHATTAN BARREL FINISH
100662,VAN GOGH FRUIT SAMPLER NP MINI
68624,MIDNIGHT MOON COOKIES & CREAM MOONSHAKE MINI
26471,CLAYTON JAMES TENNESSEE WHISKEY
4987,GLENGOYNE SINGLE MALT SCOTCH 12 YR
25045,LUCA MARIANO SINGLE BARREL RYE
102096,FIREBALL WINTER BAG
76495,OLE SMOKY BANANA WHISKEY
101527,WRITERS TEARS COPPER POT IRISH WHISKEY W/FLASK
80364,OLE SMOKY SOME BEACH CREAM MOONSHINE
59645,GREY GOOSE CLASSIC MARTINI COCKTAIL
28013,10TH MOUNTAIN RYE
906100,SPEYBURN BRADAN ORACH SCOTCH
4436,BENROMACH 10YR
102037,ABSOLUT BLUE W/ CRANBERRY JUICE
38829,WHITE CLAW MANGO VODKA
38782,CM KNEE-HIGH DISTILLING CO SWEET-TEA VODKA
85490,SAN MATIAS ANEJO 135YR
944106,BLACK TOT RUM
923614,FILIBUSTER BOONDOGGLER
922450,BIRD DOG BLACKBERRY RESERVE
937577,CENTURY FARMS CAPTAINS VODKA
985350,CHULA PARRANDA ANEJO
906258,GLEN SCOTIA 10 YEAR OLD UNPEATED SINGLE MALT SCOTCH WHISKY
986143,TEQUILA TAPATIO REPOSADO
21239,1792 SMALL BATCH BOURBON
915864,HA REDBREAST 27 YO
927934,BROTHERHOOD BOURBON
903151,KETEL ONE MINI
920487,OLD SOUL CASK STRENGTH SINGLE BARREL BUY THE BARREL
949387,SAZERAC DE FORGE COGNAC
985764,DON JULIO ROSADO
902846,JOHNNIE WALKER BLACK MINI
927289,IOWISH WHISKEY
942331,SEVEN FATHOMS RUM
984195,99 BUTTERSCOTCH
938771,WYCH DR DISTILLING CARAMEL APPLE
87289,CASAMIGOS MEZCAL
925467,SAGAMORE RYE SHERRY FINISH
985908,ROCK N ROLL TEQUILA GUITAR CRISTALINO REPOSADO
931167,MCCORMICK GIN
85425,CASAMIGOS CRISTALINO
22489,JOJO CHOCOLATE CHIP COOKIE DOUGH FLAVORED WHISKEY
102149,FROST TRAIL VODKA MINI
59551,DELOLA SPRITZ L''ORANGE
967388,SOOH BORGHETTI ESPRESSO LIQUEUR
33427,SOBIESKI GRAPEFRUIT VODKA
63834,ZING ZANG BLAZING BLOODY MARY RTS
102042,RUMCHATA PUMPKIN SPICE MINI
4828,DALMORE 15YR
77534,TRADER VICS WHITE CHOCOLATE LIQUEUR
4476,ARDBEG BIZARREBQ
17921,ELIJAH CRAIG TOASTED BARREL RYDER CUP
85482,UNA VIDA REPOSADO TEQUILA
916269,MACKMYRA BJORKSAV SWEDISH SINGLE MALT WHISKY
77980,TATTERSALL ORANGE LIQUEUR
992167,HA LAST DROP 50YR BGSW 700ML & 50ML
923328,KOVAL SINGLE BARREL WHISKEY RYE AMBURANA BARREL FINISHED
906059,TORABHAIG ALLT GLEANN SINGLE MALT SCOTCH WHISKY
902213,SCORPION MEZCAL ANEJO 1YR
937747,E.T.51 ESPRESSO FLAVORED VODKA
26349,RANCH ROAD WHISKEY
945995,CALICO JACK WHIPPED
951072,BISTRA APRICOT BRANDY
67900,BAILEYS CHOCOLATE
88530,CASAMIGOS REPOSADO
65922,NEW AMSTERDAM PINK WHITNEY PET
76262,KINKY PEACH MANGO MINI
73558,DIRTY MONKEY
102040,CROWN ROYAL DELUXE 1.75L W HOLIDAY BAG AND BOX
967617,MARIE BRIZARD BLCKBERRY LIQUEUR
904362,HA BALVENIE 25YR
76696,CM KNEE-HIGH DISTILILNG CO. WATERMELON VODKA
989006,ASOMBROSO LA ROSA REPOSADO
951584,R. JELINEK 5YR SLIVOVITZ
988102,MONTE ALBAN SILVER TEQUILA
38134,TATTERSALL TIGHTLINE ORGANIC VODKA
905838,OLD PULTENEY SINGLE MALT SCOTCH 18YR
Query:
SELECT EXTRACT(MONTH FROM "date") AS "month", "item_number", SUM("sale_dollars") AS "monthly_sales"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE EXTRACT(YEAR FROM "date") = 2023
    GROUP BY "month", "item_number"
    ORDER BY "month", "monthly_sales" DESC
    LIMIT 100;
Answer:
month,item_number,monthly_sales
1,38177,890069.44
1,38178,505077.0
1,43337,420207.0200000001
1,38176,404550.0
1,11788,399824.3199999999
1,88296,393876.0
1,10802,379272.9600000001
1,65013,328782.30000000005
1,11297,281306.2000000001
1,1799,278667.0
1,26827,268702.75999999995
1,15627,261263.94000000003
1,10807,251746.55999999997
1,64870,246588.30000000002
1,15626,212990.08
1,64864,209600.0
1,10808,207800.71000000005
1,43338,195885.0
1,48106,191660.93000000005
1,36308,186111.18
1,26826,185135.72
1,64866,158571.0
1,64865,158016.56999999998
1,64868,152559.0
1,42717,150738.21000000002
1,11298,150318.51999999996
1,11296,148544.64
1,19476,145476.0
1,64867,141318.0
1,69947,129736.55999999997
1,43336,126862.65000000004
1,25608,125415.25
1,64904,122728.0
1,26828,121757.22000000002
1,64858,118731.59999999999
1,86439,117771.0
1,36904,116001.35999999996
1,42716,115838.63
1,17206,114588.90999999999
1,43028,114066.06000000001
1,38174,113608.61999999998
1,34368,111615.14000000001
1,10805,111296.64000000001
1,87485,110971.63000000006
1,43334,109950.0
1,65257,109145.00999999998
1,936859,108625.92
1,38088,104939.75999999998
1,38008,104011.0
1,19066,100369.5
1,34006,100238.12999999999
1,67526,99395.27999999998
1,37994,97654.62
1,48099,97619.40000000001
1,17086,96694.39999999998
1,16832,96262.5
1,34821,92922.3
1,67527,92681.64000000001
1,89196,90810.0
1,65426,89805.75
1,69637,88440.0
1,11774,88410.58000000003
1,18006,88218.0
1,17916,87985.44
1,65256,86227.65000000002
1,28867,85812.22999999997
1,11777,85172.00000000001
1,87408,84888.0
1,11776,84725.05000000003
1,42718,82573.75999999997
1,43127,80925.75
1,19067,79111.5
1,68036,78401.05999999998
1,68037,77843.28
1,11294,77828.65999999999
1,88294,77760.0
1,87280,77573.1
1,89387,77568.86
1,10809,77300.83999999998
1,73055,76482.0
1,64136,76078.37999999998
1,16562,74014.5
1,936600,73993.5
1,37998,73847.81000000003
1,100413,73530.00000000001
1,48105,73310.87999999998
1,43285,72733.68000000001
1,34422,72304.5
1,989289,72256.8
1,36304,70197.0
1,34007,70011.37000000001
1,11287,69518.81999999999
1,988063,69094.08
1,37996,68226.18000000002
1,35918,68141.25
1,917929,66960.0
1,89177,66585.19999999997
1,15248,64800.0
1,100423,64539.0
1,89577,64506.78000000001
Query:
SELECT t1."item_number", (t2."total_bottles_2023" - t1."total_bottles_2022") AS "bottle_increase"
    FROM
      (SELECT "item_number", SUM("bottles_sold") AS "total_bottles_2022"
       FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
       WHERE EXTRACT(YEAR FROM "date") = 2022
       GROUP BY "item_number") t1
    JOIN
      (SELECT "item_number", SUM("bottles_sold") AS "total_bottles_2023"
       FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
       WHERE EXTRACT(YEAR FROM "date") = 2023
       GROUP BY "item_number") t2
    ON t1."item_number" = t2."item_number"
    ORDER BY "bottle_increase" DESC
    LIMIT 100;
Answer:
item_number,bottle_increase
64870,170886
65013,124568
1799,99497
84171,89109
36904,67476
36304,49900
38176,47430
38177,45459
38008,39609
38174,38930
100423,36102
76501,32625
77487,30509
86439,30220
10784,27082
34368,25831
38178,25728
11774,24767
37067,22447
43024,18219
10803,17476
84192,17455
84208,17209
80023,17108
43331,16292
84217,16285
911070,16104
42717,16037
10805,15721
38194,15197
19064,15165
65543,14638
988849,14136
84219,14129
11290,13976
36305,13771
88290,13640
76843,12891
38179,12497
87403,12426
962476,12096
89193,12070
11294,10914
26826,10857
53214,10794
936859,10344
23824,9907
43334,9873
36875,9640
84404,9630
19066,9606
86112,8798
66936,8656
74782,8629
101180,8525
946574,8352
80398,8203
16832,8145
38088,7955
87402,7941
36306,7684
34821,7509
37994,7395
18859,7370
87380,7366
88371,7275
36302,7005
33180,6990
80397,6893
27781,6828
987507,6826
88548,6744
987514,6732
962094,6570
75255,6536
39422,6392
936600,6390
21215,6135
15622,6134
28866,6051
944650,5988
89194,5973
65426,5962
19476,5725
78297,5462
32232,5426
86019,5344
992900,5322
86884,5319
35948,5309
52199,5231
88291,5220
988063,5184
87484,5171
87619,5163
35947,5154
926684,5130
87409,5079
21236,5065
76413,5065
Query:
SELECT COALESCE(t2."item_number", t1."item_number") AS "item_number",
       (COALESCE(t2."total_bottles_2023", 0) - COALESCE(t1."total_bottles_2022", 0)) AS "bottle_increase"
FROM
  (SELECT "item_number", SUM("bottles_sold") AS "total_bottles_2022"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") = 2022
   GROUP BY "item_number") t1
FULL OUTER JOIN
  (SELECT "item_number", SUM("bottles_sold") AS "total_bottles_2023"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") = 2023
   GROUP BY "item_number") t2
ON t1."item_number" = t2."item_number"
ORDER BY "bottle_increase" DESC
LIMIT 100;
Answer:
item_number,bottle_increase
64870,170886
65013,124568
1799,99497
84171,89109
36904,67476
36304,49900
38176,47430
38177,45459
38008,39609
38174,38930
100423,36102
76501,32625
77487,30509
86439,30220
10784,27082
34368,25831
38178,25728
11774,24767
10777,23979
37067,22447
43024,18219
10803,17476
84192,17455
84208,17209
80023,17108
43331,16292
84217,16285
911070,16104
42717,16037
10805,15721
102092,15535
38194,15197
19064,15165
65533,15102
37868,14857
65543,14638
988849,14136
84219,14129
11290,13976
36305,13771
88290,13640
21493,13318
76843,12891
38179,12497
87403,12426
10778,12365
962476,12096
67900,12095
89193,12070
11294,10914
26826,10857
53214,10794
936859,10344
102149,10304
58855,9933
23824,9907
43334,9873
36875,9640
84404,9630
19066,9606
84135,9403
76830,9371
37712,9099
68024,8990
10776,8934
86112,8798
84214,8746
66936,8656
74782,8629
80362,8601
101180,8525
101988,8506
946574,8352
80398,8203
16832,8145
78186,8045
38088,7955
87402,7941
25614,7809
102057,7757
36306,7684
37959,7603
34821,7509
86423,7491
37994,7395
18859,7370
87380,7366
88371,7275
37952,7229
36302,7005
33180,6990
80397,6893
27781,6828
987507,6826
66524,6824
88548,6744
987514,6732
962094,6570
75255,6536
39422,6392
Query:
-- Corrected SQL1:

SELECT COALESCE("vendor_number", 'Unknown') AS "vendor_number",
       COALESCE("vendor_name", 'Unknown') AS "vendor_name",
       SUM("sale_dollars") AS "vendor_sales_2023"
FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
WHERE EXTRACT(YEAR FROM "date") = 2023
GROUP BY COALESCE("vendor_number", 'Unknown'), COALESCE("vendor_name", 'Unknown')
ORDER BY "vendor_sales_2023" DESC
LIMIT 100
Answer:
vendor_number,vendor_name,vendor_sales_2023
260,DIAGEO AMERICAS,89011840.78999999
421,SAZERAC COMPANY  INC,66752599.620000005
301,FIFTH GENERATION INC,30844469.729999993
65,JIM BEAM BRANDS,30037947.909999996
370,PERNOD RICARD USA,27709155.02
259,HEAVEN HILL BRANDS,27513247.949999984
35,BACARDI USA INC,22604057.980000008
85,BROWN FORMAN CORP.,20513550.880000006
434,LUXCO INC,16096204.780000003
395,PROXIMO,15669739.900000002
205,E & J GALLO WINERY,9603379.85
420,MOET HENNESSY USA,8389969.7
192,"MAST-JAGERMEISTER US, INC",5266611.97
346,OLE SMOKY DISTILLERY LLC,5252152.9
619,CAMPARI AMERICA,5226865.09
300,MCCORMICK DISTILLING CO.,4720609.33
380,PHILLIPS BEVERAGE,4232280.54
389,REMY COINTREAU USA INC,3821612.8800000004
240,WILLIAM GRANT & SONS INC,3686419.9899999998
125,CEDAR RIDGE VINEYARDS LL,3616066.419999999
255,INFINIUM SPIRITS,3373387.3699999996
368,PARK STREET IMPORTS,3092789.0500000003
297,LAIRD & COMPANY,3070549.6399999997
115,CONSTELLATION BRANDS INC,2539778.1899999995
772,INTERCONTINENTAL PACKAGING COMPANY/PRESTIGE BEVERAGE GROUP,2409294.17
305,MHW LTD,2368884.95
777,"BLUE OX SPIRITS, INC.",2135285.9200000004
830,KIRIN BEER & SPIRITS OF AMERICA INC / FOUR ROSES DISTILLERY,2045571.170000001
803,LEVECKE CORPORATION,1731901.5
654,REVELTON DISTILLING COMPANY,1338860.7
217,MISA IMPORTS INC,1237775.13
306,MISSISSIPPI RIVER DISTILLING COMPANY LLC,1180620.3599999999
214,GOAMERICAGO BEVERAGES LLC / WHISTLEPIG,1021470.7099999998
277,STOLI GROUP,980504.96
492,WESTERN SPIRITS BEVERAGE,918640.7900000004
118,AMERICAN SPIRITS EXCHANGE,872681.0300000001
154,DUNKEL CORPORATION / IOWA DISTILLING,782511.4399999998
229,DEHNER DISTILLERY,693855.5900000001
266,EDRINGTON GROUP USA LLC,675753.9600000001
130,DISARONNO INTERNATIONAL,674977.8400000001
620,MPL BRANDS NV INC/ PATCO BRANDS,608959.08
566,"FOUNDRY DISTILLING COMPANY, LLC",543898.8700000001
472,"TEQUILAS PREMIUM, INC",537352.5399999999
755,WINESOURCE INTERNATIONAL INC.,526883.7099999998
911,FIELD OF DREAMS BEVERAGE COMPANY LLC,468540.0
482,"SOVEREIGN BRANDS, LLC",400293.44999999995
578,S&B FARMS DISTILLERY,372008.23999999993
287,CHATHAM IMPORTS INC,366185.25
342,DV SPIRITS LLC,364011.40000000014
384,PIEDMONT DISTILLERS INC,358055.4799999999
481,SUGARLANDS DISTILLING COMPANY LLC,286576.68
521,JEM BEVERAGE COMPANY / WESTERN SON,279088.00000000006
978,W J DEUTSCH & SONS LTD,272533.17999999993
325,LONELY OAK DISTILLERY,265744.68999999994
195,SWELL LIQUOR LLC,248410.5
536,OLD ELK DISTILLERIES LLC,231076.5
209,MINHAS MICRO DISTILLERY,222525.29999999996
908,BUZZBALLZ LLC / SOUTHERN CHAMPION,192315.0
460,SHAW-ROSS INTERNATIONAL,189432.59999999995
391,HOTALING & CO,187829.12000000005
163,STOLLER IMPORTS INC / MARSALLE COMPANY,182356.74
293,JINRO AMERICA INC,170374.50999999992
100,AIKO IMPORTERS INC,165455.29000000007
422,MACH FLYNT INC.,164553.69
525,CATS EYE DISTILLERY,159136.27
594,"AMERICAN HERITAGE DISTILLERS, LLC / CENTURY FARMS DISTILLERY",156114.09999999998
357,PALM BAY INTERNATIONAL,148822.97999999995
454,SALOON SPIRITS LLC,148289.94
338,"MARUSSIA BEVERAGES USA, INC / NICHE IMPORT",141347.71
617,MIDWEST LIQUOR COMPANY,135158.96000000002
785,MAISON FERRAND USA / COGNAC FERRAND USA INC,123354.9
573,TEMPLETON DISTILLING LLC,115031.34
642,"JAMES JOSEPH SANCTIFIED SPIRITS, LLC / OAK&EDEN",110080.5
363,PATERNO IMPORTS LTD / TERLATO WINES INTERNATIONAL,106614.52000000002
917,"LONE STAR DISTILLERY, LLC/GARRISON BROTHERS DISTILLERY",99193.39
902,"ZING ZANG, LLC",92539.87
611,"GLOBAL BEVERAGE TEAM, LLC",92474.43000000002
888,"TRUST ME VODKA, INC.",92233.5
116,BAD BEAR ENTERPRISES LLC / LEGENDARY RYE,90137.61
79,BRECKENRIDGE DISTILLERY / DOUBLE DIAMOND DISTILLERY LLC,85560.54000000002
285,CHARLES JACQUIN ET CIE,84688.54999999999
353,"JOHN ERNEST DISTILLERY, INC.",77341.93
796,173 CRAFT DISTILLERY,74398.68000000001
926,"GRATON SPIRITS COMPANY, LLC / PURPLE BRANDS",70132.5
308,MANGO BOTTLING,69229.95999999999
261,GRAND PRIX BEVERAGE LLC,68099.82
899,"KENTUCKY PEERLESS DISTILLING COMPANY, LLC",63965.34
900,ATOMIC BRANDS INC,63546.81000000001
662,IA-NATIVE SPIRITS,61793.54
549,"GREEN FROG DISTILLERY, LLC",61004.25
557,"WORLDWIDE LIBATIONS, LLC",60962.84
666,"NORTHWEST NATURAL SPIRITS, LLC / CASCADE SPIRITS",60917.640000000014
448,ST GEORGE SPIRITS INC,59704.5
826,KNEE-HIGH DISTILLING CO. LLC,59103.579999999994
564,JACOB RIEGER & COMPANY LLC,51218.319999999985
558,ALTAMAR BRANDS LLC,49533.81999999999
786,BOTTLE TREE BEVERAGE COMPANY LLC / CATHEAD DISTILLERY,49163.46000000001
764,SODA JERK LLC,48804.0
634,"SAGAMORE WHISKEY, LLC",47210.04999999999
727,BENCHMARK BEVERAGE COMPANY LLC,46451.85
Query:
-- Corrected SQL2:

SELECT COALESCE(t1."item_number", t2."item_number") AS "item_number",
       COALESCE(t1."total_sales_2022", 0) AS "total_sales_2022",
       COALESCE(t2."total_sales_2023", 0) AS "total_sales_2023"
FROM
  (SELECT "item_number", SUM("sale_dollars") AS "total_sales_2022"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") = 2022
   GROUP BY "item_number") t1
FULL OUTER JOIN
  (SELECT "item_number", SUM("sale_dollars") AS "total_sales_2023"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE EXTRACT(YEAR FROM "date") = 2023
   GROUP BY "item_number") t2
ON t1."item_number" = t2."item_number"
WHERE COALESCE(t2."total_sales_2023", 0) < COALESCE(t1."total_sales_2022", 0)
ORDER BY (COALESCE(t1."total_sales_2022", 0) - COALESCE(t2."total_sales_2023", 0)) DESC
LIMIT 100
Answer:
item_number,total_sales_2022,total_sales_2023
10802,5298659.22,3705297.92
43338,2602557.0,1185786.0
87026,1082583.0,0.0
10807,4844648.659999999,3787875.1999999997
11296,3820673.9000000004,2934681.5999999996
48106,2857427.52,2280671.86
37998,724159.99,246351.15999999997
89164,932063.64,553463.1000000001
101787,374139.0,61425.0
101217,294624.0,0.0
64866,1973484.0,1709734.5
49189,614309.14,352409.8400000001
49186,768142.9800000001,513363.4700000003
47861,440870.4,193279.52000000002
15626,2827872.9299999997,2597208.96
11298,2620041.5299999993,2415090.36
64867,1857777.2099999997,1655136.0
26828,2860557.18,2659707.96
42716,1662090.5099999993,1463273.7900000003
64868,1755820.0,1559764.0
88163,252877.52000000002,61196.48000000001
28279,670576.5,485727.0
10809,1441188.6199999999,1260472.8000000003
48164,358882.27999999997,179651.80000000002
48122,396192.69,219366.90000000002
48099,1277673.2799999998,1104352.48
67901,209226.18000000005,37926.42
22215,1632339.6600000008,1466267.25
47865,597984.0,432240.0
11297,3667743.3899999997,3506902.4899999993
69637,1361613.0,1202797.46
18856,157815.0,0.0
989290,252869.76,98556.48000000001
22244,349650.0,195720.0
101600,151227.0,0.0
38841,207455.25,59402.25
10791,865405.7400000001,717585.2800000003
37167,143632.5,577.5
10628,659590.5,517824.0
89198,743447.25,601956.0
73200,352048.9499999999,212770.68
47863,559915.86,421298.72000000003
38577,228225.0,90627.0
86692,493521.8,359124.15000000014
901369,132153.36000000002,0.0
65257,1467116.04,1335269.1299999994
78293,209556.26000000004,78637.76000000001
101907,127575.0,0.0
49185,669003.7800000001,544589.19
27102,909434.2599999999,785024.4999999999
34155,191716.53000000003,68232.64
19068,901065.0,781224.0
38847,205683.0,86266.5
34007,957106.9299999997,838989.45
900138,117361.80000000003,0.0
101615,119448.0,10638.0
36969,719137.5,611088.0
18198,105124.5,0.0
49086,514361.37000000017,410076.2399999998
43285,916944.48,813276.03
48108,301909.74,199773.36
43128,907785.0,806612.25
48105,2196215.5600000005,2102410.24
919216,93597.12000000002,0.0
64864,2543960.0,2451872.0
64736,119821.35999999999,28275.799999999996
27125,309866.27,218978.08000000002
43126,658451.2800000004,567726.8399999999
5329,489060.0,398580.0
926229,88862.40000000001,0.0
59201,126639.54000000002,38387.94
17194,119539.91999999997,31703.499999999996
39492,715833.75,628548.0
15248,830790.0,744795.0
101151,279181.8,194738.40000000002
100847,264630.6,180729.0
73055,931839.75,849597.0
78133,271654.34,189896.82000000004
58913,107239.79999999999,25813.58999999999
558,78473.60999999997,0.0
25606,332730.0,256905.0
37997,427809.36,352010.6799999999
37938,283736.63999999996,210524.16
19477,1135046.25,1061842.5
962475,95477.76000000001,23224.32
82860,72064.62000000002,0.0
88296,5324760.0,5252856.0
34578,564435.0,492705.0
18196,71559.75,0.0
58838,880270.9500000002,809004.9899999998
28617,70950.0,0.0
19324,69963.75,0.0
11586,97371.0,27972.0
11366,176812.5,108037.5
27783,543708.0,474969.0
100944,68906.23999999999,288.64
994155,68121.0,0.0
67526,867167.3100000002,799778.86
5040,88566.83999999998,21413.530000000002
27780,289044.0,222327.0
End Exploring Related Columns
Task: What are the top 5 items with the highest year-over-year growth percentage in total sales revenue for the year 2023?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To identify the top 5 items with the highest year-over-year growth percentage in total sales revenue for the year 2023, we compare each item's total sales revenue in 2023 to its total in 2022. The growth percentage is calculated as:

```
((Sales in 2023 - Sales in 2022) / Sales in 2022) * 100
```

Here is the list of the top 5 items:

```csv
item_number,item_description,year_over_year_growth_percentage
item_number1:str,item_description1:str,growth_percentage1:float
item_number2:str,item_description2:str,growth_percentage2:float
item_number3:str,item_description3:str,growth_percentage3:float
item_number4:str,item_description4:str,growth_percentage4:float
item_number5:str,item_description5:str,growth_percentage5:float
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'IOWA_LIQUOR_SALES': {'IOWA_LIQUOR_SALES': ['SALES']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-20 23:00:03 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 23:00:03 - root - INFO - ```sql
WITH sales_2022 AS (
  SELECT "item_number", SUM("sale_dollars") AS "total_sales_2022"
  FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
  WHERE EXTRACT(YEAR FROM "date") = 2022
  GROUP BY "item_number"
),
sales_2023 AS (
  SELECT "item_number", SUM("sale_dollars") AS "total_sales_2023"
  FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
  WHERE EXTRACT(YEAR FROM "date") = 2023
  GROUP BY "item_number"
)
SELECT 
  s2."item_number",
  i."item_description",
  s1."total_sales_2022",
  s2."total_sales_2023",
  ROUND(((s2."total_sales_2023" - s1."total_sales_2022") / s1."total_sales_2022") * 100, 2) AS "year_over_year_growth_percentage"
FROM sales_2022 s1
INNER JOIN sales_2023 s2 ON s1."item_number" = s2."item_number"
JOIN (SELECT DISTINCT "item_number", "item_description" FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES") i
  ON s1."item_number" = i."item_number"
WHERE s1."total_sales_2022" > 0
ORDER BY "year_over_year_growth_percentage" DESC NULLS LAST
LIMIT 5;
```
2025-01-20 23:00:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 23:00:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 23:00:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 23:00:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-20 23:00:06 - snowflake.connector.connection - INFO - closed
2025-01-20 23:00:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 23:00:06 - root - INFO - itercount: 1
2025-01-20 23:00:06 - root - INFO - 0
2025-01-20 23:00:06 - root - INFO - results: 
item_number,item_description,total_sales_2022,total_sales_2023,year_over_year_growth_percentage
74782,JACK DANIELS WINTER JACK,170.61,141523.19999999998,82851.29
84155,99 CHERRIES MINI,594.0,86373.0,14440.91
64319,THE BUTTERFLY CANNON ROSA FLAVORED TEQUILA,57.6,7626.239999999997,13140.0
38073,STATE VODKA,97.5,5833.4,5882.97
902421,SOOH EL TESORO ANEJO,360.0,19800.0,5400.0


2025-01-20 23:00:06 - root - INFO - Please check the answer again by reviewing What are the top 5 items with the highest year-over-year growth percentage in total sales revenue for the year 2023?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To identify the top 5 items with the highest year-over-year growth percentage in total sales revenue for the year 2023, we compare each item's total sales revenue in 2023 to its total in 2022. The growth percentage is calculated as:

```
((Sales in 2023 - Sales in 2022) / Sales in 2022) * 100
```

Here is the list of the top 5 items:

```csv
item_number,item_description,year_over_year_growth_percentage
item_number1:str,item_description1:str,growth_percentage1:float
item_number2:str,item_description2:str,growth_percentage2:float
item_number3:str,item_description3:str,growth_percentage3:float
item_number4:str,item_description4:str,growth_percentage4:float
item_number5:str,item_description5:str,growth_percentage5:float
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
item_number,item_description,total_sales_2022,total_sales_2023,year_over_year_growth_percentage
74782,JACK DANIELS WINTER JACK,170.61,141523.19999999998,82851.29
84155,99 CHERRIES MINI,594.0,86373.0,14440.91
64319,THE BUTTERFLY CANNON ROSA FLAVORED TEQUILA,57.6,7626.239999999997,13140.0
38073,STATE VODKA,97.5,5833.4,5882.97
902421,SOOH EL TESORO ANEJO,360.0,19800.0,5400.0
Current sql:
WITH sales_2022 AS (
  SELECT "item_number", SUM("sale_dollars") AS "total_sales_2022"
  FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
  WHERE EXTRACT(YEAR FROM "date") = 2022
  GROUP BY "item_number"
),
sales_2023 AS (
  SELECT "item_number", SUM("sale_dollars") AS "total_sales_2023"
  FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
  WHERE EXTRACT(YEAR FROM "date") = 2023
  GROUP BY "item_number"
)
SELECT 
  s2."item_number",
  i."item_description",
  s1."total_sales_2022",
  s2."total_sales_2023",
  ROUND(((s2."total_sales_2023" - s1."total_sales_2022") / s1."total_sales_2022") * 100, 2) AS "year_over_year_growth_percentage"
FROM sales_2022 s1
INNER JOIN sales_2023 s2 ON s1."item_number" = s2."item_number"
JOIN (SELECT DISTINCT "item_number", "item_description" FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES") i
  ON s1."item_number" = i."item_number"
WHERE s1."total_sales_2022" > 0
ORDER BY "year_over_year_growth_percentage" DESC NULLS LAST
LIMIT 5;
2025-01-20 23:00:34 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 23:00:34 - root - INFO - ```sql
WITH sales_2022 AS (
  SELECT "item_number", SUM("sale_dollars") AS "total_sales_2022"
  FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
  WHERE EXTRACT(YEAR FROM "date") = 2022
  GROUP BY "item_number"
),
sales_2023 AS (
  SELECT "item_number", SUM("sale_dollars") AS "total_sales_2023"
  FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
  WHERE EXTRACT(YEAR FROM "date") = 2023
  GROUP BY "item_number"
)
SELECT 
  s2."item_number",
  i."item_description",
  ROUND(((s2."total_sales_2023" - s1."total_sales_2022") / s1."total_sales_2022") * 100, 4) AS "year_over_year_growth_percentage"
FROM sales_2022 s1
INNER JOIN sales_2023 s2 ON s1."item_number" = s2."item_number"
JOIN (
  SELECT DISTINCT "item_number", "item_description"
  FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
) i ON s1."item_number" = i."item_number"
WHERE s1."total_sales_2022" > 0
ORDER BY "year_over_year_growth_percentage" DESC NULLS LAST
LIMIT 5;
```
2025-01-20 23:00:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 23:00:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 23:00:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 23:00:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-20 23:00:36 - snowflake.connector.connection - INFO - closed
2025-01-20 23:00:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 23:00:36 - root - INFO - itercount: 2
2025-01-20 23:00:36 - root - INFO - 0
2025-01-20 23:00:36 - root - INFO - results: 
item_number,item_description,year_over_year_growth_percentage
74782,JACK DANIELS WINTER JACK,82851.2924
84155,99 CHERRIES MINI,14440.9091
64319,THE BUTTERFLY CANNON ROSA FLAVORED TEQUILA,13140.0
38073,STATE VODKA,5882.9744
902421,EL TESORO ANEJO,5400.0


2025-01-20 23:00:36 - root - INFO - Please check the answer again by reviewing What are the top 5 items with the highest year-over-year growth percentage in total sales revenue for the year 2023?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To identify the top 5 items with the highest year-over-year growth percentage in total sales revenue for the year 2023, we compare each item's total sales revenue in 2023 to its total in 2022. The growth percentage is calculated as:

```
((Sales in 2023 - Sales in 2022) / Sales in 2022) * 100
```

Here is the list of the top 5 items:

```csv
item_number,item_description,year_over_year_growth_percentage
item_number1:str,item_description1:str,growth_percentage1:float
item_number2:str,item_description2:str,growth_percentage2:float
item_number3:str,item_description3:str,growth_percentage3:float
item_number4:str,item_description4:str,growth_percentage4:float
item_number5:str,item_description5:str,growth_percentage5:float
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
item_number,item_description,year_over_year_growth_percentage
74782,JACK DANIELS WINTER JACK,82851.2924
84155,99 CHERRIES MINI,14440.9091
64319,THE BUTTERFLY CANNON ROSA FLAVORED TEQUILA,13140.0
38073,STATE VODKA,5882.9744
902421,EL TESORO ANEJO,5400.0
Current sql:
WITH sales_2022 AS (
  SELECT "item_number", SUM("sale_dollars") AS "total_sales_2022"
  FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
  WHERE EXTRACT(YEAR FROM "date") = 2022
  GROUP BY "item_number"
),
sales_2023 AS (
  SELECT "item_number", SUM("sale_dollars") AS "total_sales_2023"
  FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
  WHERE EXTRACT(YEAR FROM "date") = 2023
  GROUP BY "item_number"
)
SELECT 
  s2."item_number",
  i."item_description",
  ROUND(((s2."total_sales_2023" - s1."total_sales_2022") / s1."total_sales_2022") * 100, 4) AS "year_over_year_growth_percentage"
FROM sales_2022 s1
INNER JOIN sales_2023 s2 ON s1."item_number" = s2."item_number"
JOIN (
  SELECT DISTINCT "item_number", "item_description"
  FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
) i ON s1."item_number" = i."item_number"
WHERE s1."total_sales_2022" > 0
ORDER BY "year_over_year_growth_percentage" DESC NULLS LAST
LIMIT 5;
2025-01-20 23:00:53 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 23:00:53 - root - INFO - ```sql
WITH sales_2022 AS (
  SELECT "item_number", SUM("sale_dollars") AS "total_sales_2022"
  FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
  WHERE EXTRACT(YEAR FROM "date") = 2022
  GROUP BY "item_number"
),
sales_2023 AS (
  SELECT "item_number", SUM("sale_dollars") AS "total_sales_2023"
  FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
  WHERE EXTRACT(YEAR FROM "date") = 2023
  GROUP BY "item_number"
)
SELECT 
  s2."item_number",
  i."item_description",
  ROUND(((s2."total_sales_2023" - s1."total_sales_2022") / s1."total_sales_2022") * 100, 4) AS "year_over_year_growth_percentage"
FROM sales_2022 s1
INNER JOIN sales_2023 s2 ON s1."item_number" = s2."item_number"
JOIN (
  SELECT DISTINCT "item_number", "item_description"
  FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
) i ON s1."item_number" = i."item_number"
WHERE s1."total_sales_2022" > 0
ORDER BY "year_over_year_growth_percentage" DESC NULLS LAST
LIMIT 5;
```
2025-01-20 23:00:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 23:00:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 23:00:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 23:00:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-20 23:00:54 - snowflake.connector.connection - INFO - closed
2025-01-20 23:00:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 23:00:55 - root - INFO - itercount: 3
2025-01-20 23:00:55 - root - INFO - 0
2025-01-20 23:00:55 - root - INFO - Total iteration counts: 3
