2025-01-20 19:05:46 - openai._base_client - INFO - Retrying request to /chat/completions in 0.430517 seconds
2025-01-20 19:06:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 19:06:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:06:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:06:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:06:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:06:33 - snowflake.connector.connection - INFO - closed
2025-01-20 19:06:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:06:34 - root - INFO - SQL:
SELECT DISTINCT "interest_id"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   LIMIT 1000;
Results:
Too long, hard cut:
interest_id
32486.0
6106.0
18923.0
6344.0
100.0
6111.0
19422.0
6110.0
6217.0
171.0
19613.0
17.0
6.0
6013.0
4870.0
19423.0
6089.0
6286.0
19621.0
63.0
165.0
18351.0
""
17314.0
4914.0
6107.0
40.0
5938.0
16137.0
6330.0
6006.0
6228.0
4902.0
97.0
20764.0
5.0
19610.0
4940.0
10838.0
6255.0
69.0
79.0
4895.0
5991.0
114.0
96.0
19758.0
6029.0
6334.0
6315.0
6206.0
20768.0
4855.0
56.0
23.0
98.0
18646.0
6162.0
128.0
6308.0
148.0
18347.0
4910.0
32703.0
6214.0
4.0
6218.0
161.0
92.0
6184.0
6232.0
36.0
150.0
17730.0
4869.0
31.0
19757.0
4911.0
5946.0
6378.0
6172.0
169.0
6299.0
6304.0
6123.0
103.0
38.0
17786.0
15.0
115.0
22403.0
4852.0
6108.0
6219.0
10250.0
149.0
16197.0
11067.0
4913.0
6316.0
17803.0
44.0
19.0
4873.0
86.0
24.0
12133.0
6141.0
4943.0
18996.0
85.0
19587.0
135.0
19588.0
77.0
4944.0
111.0
151.0
7461.0
17785.0
6318.0
7605.0
12.0
70.0
19579.0
18490.0
147.0
6062.0
19760.0
6115.0
6265.0
18350.0
6148.0
6340.0
109.0
12027.0
18784.0
34.0
102.0
6323.0
5896.0
6301.0
22411.0
6321.0
62.0
6222.0
6341.0
17673.0
6112.0
20753.0
125.0
17269.0
6284.0
7557.0
117.0
33.0
17320.0
18202.0
10008.0
10976.0
21242.0
21293.0
6278.0
64.0
88.0
5921.0
21057.0
6133.0
22096.0
18622.0
19294.0
5963.0
10988.0
116.0
21061.0
5984.0
45.0
21058.0
4857.0
6024.0
157.0
143.0
14901.0
6320.0
19604.0
7536.0
16196.0
18203.0
38360.0
36864.0
37876.0
10954.0
133.0
11974.0
15935.0
18647.0
5968.0
5943.0
16.0
6277.0
6285.0
6128.0
17674.0
93.0
22502.0
20750.0
6087.0
104.0
39.0
5952.0
164.0
5989.0
138.0
12277.0
61.0
6211.0
5972.0
6023.0
5960.0
90.0
6144.0
49.0
75.0
18781.0
4848.0
5930.0
13496.0
4920.0
163.0
33191.0
5918.0
13421.0
12025.0
19297.0
10870.0
19606.0
170.0
6151.0
1.0
60.0
158.0
132.0
6365.0
7537.0
6227.0
6085.0
11975.0
13.0
89.0
37.0
6084.0
8.0
4909.0
6127.0
66.0
7453.0
6171.0
131.0
10839.0
67.0
4861.0
19630.0
5970.0
4907.0
20767.0
10837.0
130.0
27.0
19879.0
4915.0
6250.0
6237.0
6302.0
22425.0
6207.0
141.0
6181.0
6298.0
6145.0
22.0
4918.0
17671.0
5906.0
35.0
21292.0
19250.0
82.0
13498.0
4925.0
6319.0
10365.0
6366.0
4898.0
7425.0
16119.0
65.0
5898.0
6051.0
5901.0
4866.0
6095.0
6229.0
20814.0
4904.0
7527.0
20963.0
6221.0
6210.0
139.0
19603.0
126.0
5920.0
7529.0
41.0
10972.0
22424.0
19338.0
19578.0
6263.0
10980.0
6267.0
119.0
4859.0
155.0
12031.0
107.0
17318.0
21060.0
5961.0
18997.0
6142.0
87.0
22423.0
21236.0
21238.0
80.0
6208.0
23778.0
18204.0
19628.0
19590.0
22095.0
145.0
20815.0
6305.0
6328.0
30.0
4928.0
59.0
55.0
18619.0
6030.0
10284.0
6209.0
6169.0
142.0
6194.0
153.0
10832.0
6088.0
11065.0
22093.0
6393.0
50.0
20755.0
12821.0
14800.0
6300.0
10009.0
18807.0
32705.0
6335.0
108.0
6149.0
10364.0
6367.0
4903.0
110.0
20816.0
4867.0
20730.0
7546.0
18924.0
4908.0
19593.0
6230.0
6317.0
5936.0
18783.0
7597.0
7545.0
6345.0
17729.0
4906.0
10970.0
22401.0
10836.0
4933.0
6215.0
6156.0
5945.0
112.0
6339.0
6122.0
19594.0
4931.0
6034.0
22398.0
72.0
19609.0
6332.0
21248.0
58.0
10971.0
7598.0
19626.0
19631.0
6047.0
21244.0
34462.0
34082.0
34461.0
34077.0
34084.0
34079.0
34460.0
33534.0
21245.0
34651.0
34643.0
34647.0
34650.0
34638.0
34646.0
36343.0
37411.0
37423.0
37874.0
37420.0
36876.0
38355.0
37414.0
38362.0
38351.0
37887.0
37166.0
38365.0
37165.0
37878.0
37416.0
38358.0
38989.0
39190.0
39192.0
39770.0
39651.0
39199.0
39659.0
41854.0
41191.0
41192.0
42238.0
42237.0
41554.0
40692.0
40687.0
40427.0
40694.0
42964.0
44470.0
44476.0
44479.0
44456.0
45524.0
44379.0
45669.0
45668.0
46567.0
49979.0
10011.0
22427.0
16138.0
18621.0
6329.0
6076.0
5914.0
6337.0
10977.0
12132.0
5911.0
6260.0
4917.0
5907.0
4924.0
95.0
5942.0
10978.0
19627.0
83.0
17672.0
6234.0
6322.0
28.0
19633.0
5909.0
10872.0
6324.0
6134.0
6253.0
6174.0
6212.0
6391.0
6159.0
19878.0
7543.0
10834.0
25.0
5934.0
6257.0
22400.0
4935.0
5929.0
22417.0
10975.0
6098.0
12032.0
6385.0
6124.0
32702.0
19612.0
10974.0
10010.0
6049.0
19634.0
166.0
5971.0
19624.0
21249.0
6236.0
121.0
10955.0
19615.0
5900.0
21251.0
15884.0
17274.0
11977.0
20752.0
2.0
19596.0
33474.0
34574.0
34088.0
34468.0
33972.0
33962.0
33958.0
35953.0
35169.0
34637.0
34644.0
34649.0
34642.0
37413.0
37877.0
36869.0
38284.0
37418.0
38361.0
37417.0
37412.0
38990.0
40183.0
40685.0
40683.0
39196.0
39649.0
40697.0
40691.0
40688.0
39643.0
40195.0
39547.0
39645.0
39658.0
39331.0
39338.0
39654.0
41856.0
41190.0
41855.0
41078.0
41079.0
41066.0
41059.0
40695.0
40526.0
44453.0
44587.0
45670.0
44473.0
44466.0
44484.0
45519.0
45675.0
45679.0
45673.0
44483.0
44589.0
44471.0
44458.0
44467.0
44384.0
45528.0
43551.0
39655.0
44580.0
42008.0
49972.0
51678.0
49975.0
84.0
13428.0
19635.0
19595.0
35742.0
37875.0
36873.0
36863.0
40525.0
40187.0
40699.0
41067.0
41075.0
43550.0
44486.0
45672.0
14802.0
44459.0
7540.0
12490.0
21237.0
4897.0
101.0
137.0
20731.0
6182.0
3.0
6336.0
15877.0
5951.0
6143.0
6173.0
12820.0
19295.0
6045.0
4894.0
5999.0
6220.0
6264.0
5895.0
5944.0
14.0
99.0
74.0
5924.0
21059.0
162.0
22413.0
26.0
6266.0
5910.0
18352.0
6183.0
6081.0
21239.0
7535.0
5958.0
4930.0
19617.0
5956.0
168.0
134.0
17271.0
18.0
4936.0
32701.0
10833.0
81.0
7464.0
71.0
19607.0
10251.0
4937.0
6303.0
1

2025-01-20 19:06:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:06:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:06:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:06:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:06:35 - snowflake.connector.connection - INFO - closed
2025-01-20 19:06:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:06:36 - root - INFO - SQL:
SELECT "interest_id", "composition"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   LIMIT 1000;
Results:
Too long, hard cut:
interest_id,composition
32486.0,11.89
6106.0,9.93
18923.0,10.85
6344.0,10.32
100.0,10.77
69.0,10.82
79.0,11.21
6111.0,10.71
6214.0,9.71
19422.0,10.11
6110.0,11.57
4895.0,9.47
6217.0,10.8
4.0,13.97
6218.0,9.29
6123.0,9.49
171.0,14.91
19613.0,12.62
17.0,7.89
6.0,11.99
6013.0,9.35
4870.0,10.29
19423.0,12.22
6089.0,6.97
161.0,11.48
6286.0,14.1
5991.0,11.04
92.0,9.77
6184.0,13.35
19621.0,11.61
63.0,9.37
103.0,6.61
38.0,9.48
17786.0,13.67
6232.0,9.97
165.0,6.05
18351.0,6.09
15.0,6.9
,6.12
17314.0,10.43
6151.0,6.83
4914.0,7.42
115.0,11.68
5968.0,12.87
36.0,9.27
5943.0,6.37
133.0,10.91
1.0,7.02
114.0,6.25
6107.0,8.84
150.0,5.3
60.0,6.71
96.0,7.21
22403.0,12.27
40.0,10.86
19758.0,6.28
17730.0,11.38
5938.0,11.63
4869.0,6.47
4897.0,12.93
6029.0,8.72
31.0,7.9
16137.0,9.65
6330.0,6.82
6334.0,11.63
6315.0,8.14
4852.0,6.77
16.0,6.24
6108.0,6.65
6206.0,10.76
6006.0,6.26
6228.0,10.22
20768.0,6.53
4902.0,8.17
6277.0,11.72
19757.0,10.95
4911.0,6.87
,7.13
4910.0,6.09
6285.0,9.97
11974.0,7.19
6219.0,6.37
10250.0,11.4
6128.0,6.28
5946.0,5.99
158.0,7.46
15935.0,9.13
4855.0,5.99
149.0,6.88
16197.0,6.13
11067.0,5.14
17674.0,6.25
4913.0,6.76
56.0,7.09
6341.0,5.68
6316.0,6.52
18647.0,6.45
17803.0,6.21
23.0,5.41
132.0,7.48
6365.0,6.45
6378.0,9.64
17673.0,8.07
97.0,6.41
7537.0,7.82
20764.0,5.85
44.0,6.11
5.0,10.82
6227.0,6.07
19.0,6.57
93.0,7.08
6085.0,7.08
6112.0,9.22
4873.0,5.45
11975.0,7.81
22502.0,8.24
86.0,6.13
19610.0,7.56
20753.0,5.79
24.0,6.54
20750.0,5.87
12133.0,10.79
6141.0,6.34
6172.0,5.88
98.0,7.64
125.0,6.38
17269.0,8.64
4943.0,8.81
18996.0,7.84
13.0,6.72
89.0,8.48
169.0,6.1
101.0,7.38
6087.0,5.41
104.0,5.42
6284.0,18.82
7557.0,8.17
37.0,7.82
6084.0,6.97
8.0,6.67
5969.0,11.15
39.0,17.44
117.0,6.49
19298.0,10.27
22427.0,8.04
85.0,6.46
5952.0,7.11
164.0,6.14
19587.0,5.85
33.0,7.6
135.0,7.01
19588.0,5.87
17320.0,3.98
77.0,17.19
18648.0,7.1
5989.0,5.57
138.0,7.3
18202.0,7.61
137.0,7.94
4940.0,5.89
12277.0,6.2
4909.0,7.01
4944.0,8.32
10008.0,9.46
6299.0,5.71
20731.0,5.86
10838.0,6.8
111.0,7.42
6127.0,5.96
6304.0,8.31
61.0,6.59
6211.0,8.09
66.0,6.51
6182.0,6.57
151.0,7.97
3.0,6.14
10976.0,8.16
18646.0,6.85
21242.0,7.36
7453.0,6.45
6162.0,6.32
128.0,6.5
5972.0,6.58
6171.0,8.19
131.0,5.09
21293.0,7.28
7461.0,7.0
17785.0,7.66
10839.0,5.59
4912.0,7.77
6318.0,6.65
7605.0,6.82
4905.0,5.66
6023.0,8.02
67.0,6.67
16138.0,8.81
5960.0,7.86
6308.0,7.67
18621.0,7.31
4861.0,5.29
12.0,7.23
90.0,5.91
19630.0,7.15
6278.0,6.18
70.0,6.96
64.0,8.8
19579.0,6.24
6329.0,7.63
5970.0,9.21
4907.0,6.26
6076.0,5.75
18490.0,7.09
20767.0,7.73
147.0,6.17
10837.0,7.48
130.0,7.66
5914.0,6.4
6144.0,6.61
88.0,4.99
6255.0,7.55
27.0,6.81
6336.0,8.5
5921.0,7.37
19879.0,6.95
15877.0,5.77
21057.0,10.95
148.0,5.49
32704.0,8.04
5951.0,6.09
6062.0,7.33
4915.0,6.28
6133.0,3.82
6250.0,5.54
6143.0,5.47
49.0,5.09
6173.0,7.66
75.0,7.23
19614.0,5.57
18781.0,6.56
4848.0,6.49
6237.0,7.7
19760.0,5.36
5930.0,6.17
6302.0,7.41
13496.0,6.78
12820.0,6.07
4920.0,5.93
6115.0,6.67
22425.0,6.41
73.0,7.06
22096.0,6.56
6337.0,7.02
6265.0,7.31
19295.0,8.44
18347.0,7.8
6343.0,8.15
6207.0,7.81
18350.0,6.85
6064.0,7.02
18622.0,7.44
141.0,7.77
6181.0,6.11
6148.0,7.13
10977.0,8.3
6045.0,7.42
6298.0,5.38
6145.0,6.1
22.0,6.26
12132.0,7.12
4918.0,6.29
17671.0,5.65
5906.0,7.69
35.0,5.25
5911.0,6.94
6340.0,7.44
21292.0,7.19
19250.0,7.45
19294.0,7.22
163.0,6.4
82.0,9.99
13498.0,6.42
4925.0,6.4
109.0,6.75
6319.0,7.39
33191.0,3.99
10365.0,5.21
6366.0,6.6
4898.0,14.23
4894.0,5.81
12027.0,8.32
5963.0,5.36
6260.0,5.27
4917.0,6.1
7425.0,7.43
20817.0,3.62
16119.0,7.93
5999.0,5.14
5907.0,7.12
18784.0,6.92
65.0,5.94
5898.0,7.85
6220.0,7.59
19296.0,6.66
6264.0,7.7
6051.0,5.31
5918.0,6.8
5895.0,7.89
12602.0,7.15
5901.0,6.79
34.0,8.26
10988.0,8.17
116.0,6.31
4866.0,6.33
6095.0,7.5
6229.0,7.2
13421.0,7.15
102.0,7.74
4919.0,6.35
20814.0,3.89
4904.0,6.28
7527.0,5.97
12026.0,7.21
4924.0,5.11
21061.0,7.23
20963.0,5.78
6323.0,6.28
5944.0,6.39
14.0,3.53
6221.0,5.94
99.0,6.79
6210.0,6.09
139.0,6.87
74.0,7.37
19603.0,6.05
5924.0,5.68
126.0,3.8
5920.0,6.07
7529.0,6.5
95.0,7.15
21059.0,6.66
162.0,5.16
41.0,6.96
10972.0,7.35
5942.0,6.29
22413.0,6.26
7540.0,6.8
5896.0,6.09
22424.0,6.05
26.0,6.01
19338.0,7.68
4847.0,5.65
19578.0,4.14
6263.0,4.98
12490.0,6.85
22428.0,5.59
21237.0,5.27
10980.0,6.14
5984.0,4.9
6267.0,6.88
6235.0,4.67
45.0,6.29
18620.0,6.16
12025.0,8.45
43.0,5.98
119.0,6.31
6266.0,6.64
4859.0,6.48
6077.0,4.83
21058.0,8.5
155.0,4.97
4857.0,6.56
12031.0,6.67
10978.0,6.53
22419.0,6.84
107.0,8.32
5913.0,6.0
32703.0,5.53
19619.0,6.0
19627.0,3.98
17318.0,4.93
21060.0,8.58
5961.0,7.12
5910.0,5.22
18997.0,5.8
5957.0,6.08
83.0,4.04
19592.0,5.08
160.0,5.92
6142.0,5.5
87.0,5.01
22423.0,5.33
6164.0,5.37
18352.0,6.55
113.0,5.53
21236.0,4.04
6183.0,6.71
21238.0,4.92
80.0,4.47
6081.0,5.92
6208.0,9.67
91.0,5.87
23778.0,5.13
18204.0,5.93
17540.0,5.06
21239.0,3.52
19628.0,4.66
18995.0,4.97
19590.0,4.59
29.0,5.2
22095.0,4.54
145.0,4.89
19297.0,4.26
19600.0,5.21
10870.0,3.29
6160.0,4.93
18998.0,4.12
6314.0,3.77
20815.0,3.03
6301.0,5.

2025-01-20 19:06:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:06:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:06:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:06:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:06:37 - snowflake.connector.connection - INFO - closed
2025-01-20 19:06:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:06:38 - root - INFO - SQL:
SELECT "month_year", "composition"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   LIMIT 1000;
Results:
Too long, hard cut:
month_year,composition
07-2018,11.89
07-2018,9.93
07-2018,10.85
07-2018,10.32
07-2018,10.77
07-2018,10.82
07-2018,11.21
07-2018,10.71
07-2018,9.71
07-2018,10.11
07-2018,11.57
07-2018,9.47
07-2018,10.8
07-2018,13.97
07-2018,9.29
07-2018,9.49
07-2018,14.91
07-2018,12.62
07-2018,7.89
07-2018,11.99
07-2018,9.35
07-2018,10.29
07-2018,12.22
07-2018,6.97
07-2018,11.48
07-2018,14.1
07-2018,11.04
07-2018,9.77
07-2018,13.35
07-2018,11.61
07-2018,9.37
07-2018,6.61
07-2018,9.48
07-2018,13.67
07-2018,9.97
07-2018,6.05
07-2018,6.09
07-2018,6.9
,6.12
07-2018,10.43
07-2018,6.83
07-2018,7.42
07-2018,11.68
07-2018,12.87
07-2018,9.27
07-2018,6.37
07-2018,10.91
07-2018,7.02
07-2018,6.25
07-2018,8.84
07-2018,5.3
07-2018,6.71
07-2018,7.21
07-2018,12.27
07-2018,10.86
07-2018,6.28
07-2018,11.38
07-2018,11.63
07-2018,6.47
07-2018,12.93
07-2018,8.72
07-2018,7.9
07-2018,9.65
07-2018,6.82
07-2018,11.63
07-2018,8.14
07-2018,6.77
07-2018,6.24
07-2018,6.65
07-2018,10.76
07-2018,6.26
07-2018,10.22
07-2018,6.53
07-2018,8.17
07-2018,11.72
07-2018,10.95
07-2018,6.87
,7.13
07-2018,6.09
07-2018,9.97
07-2018,7.19
07-2018,6.37
07-2018,11.4
07-2018,6.28
07-2018,5.99
07-2018,7.46
07-2018,9.13
07-2018,5.99
07-2018,6.88
07-2018,6.13
07-2018,5.14
07-2018,6.25
07-2018,6.76
07-2018,7.09
07-2018,5.68
07-2018,6.52
07-2018,6.45
07-2018,6.21
07-2018,5.41
07-2018,7.48
07-2018,6.45
07-2018,9.64
07-2018,8.07
07-2018,6.41
07-2018,7.82
07-2018,5.85
07-2018,6.11
07-2018,10.82
07-2018,6.07
07-2018,6.57
07-2018,7.08
07-2018,7.08
07-2018,9.22
07-2018,5.45
07-2018,7.81
07-2018,8.24
07-2018,6.13
07-2018,7.56
07-2018,5.79
07-2018,6.54
07-2018,5.87
07-2018,10.79
07-2018,6.34
07-2018,5.88
07-2018,7.64
07-2018,6.38
07-2018,8.64
07-2018,8.81
07-2018,7.84
07-2018,6.72
07-2018,8.48
07-2018,6.1
07-2018,7.38
07-2018,5.41
07-2018,5.42
07-2018,18.82
07-2018,8.17
07-2018,7.82
07-2018,6.97
07-2018,6.67
07-2018,11.15
07-2018,17.44
07-2018,6.49
07-2018,10.27
07-2018,8.04
07-2018,6.46
07-2018,7.11
07-2018,6.14
07-2018,5.85
07-2018,7.6
07-2018,7.01
07-2018,5.87
07-2018,3.98
07-2018,17.19
07-2018,7.1
07-2018,5.57
07-2018,7.3
07-2018,7.61
07-2018,7.94
07-2018,5.89
07-2018,6.2
07-2018,7.01
07-2018,8.32
07-2018,9.46
07-2018,5.71
07-2018,5.86
07-2018,6.8
07-2018,7.42
07-2018,5.96
07-2018,8.31
07-2018,6.59
07-2018,8.09
07-2018,6.51
07-2018,6.57
07-2018,7.97
07-2018,6.14
07-2018,8.16
07-2018,6.85
07-2018,7.36
07-2018,6.45
07-2018,6.32
07-2018,6.5
07-2018,6.58
07-2018,8.19
07-2018,5.09
07-2018,7.28
07-2018,7.0
07-2018,7.66
07-2018,5.59
07-2018,7.77
07-2018,6.65
07-2018,6.82
07-2018,5.66
07-2018,8.02
07-2018,6.67
07-2018,8.81
07-2018,7.86
07-2018,7.67
07-2018,7.31
07-2018,5.29
07-2018,7.23
07-2018,5.91
07-2018,7.15
07-2018,6.18
07-2018,6.96
07-2018,8.8
07-2018,6.24
07-2018,7.63
07-2018,9.21
07-2018,6.26
07-2018,5.75
07-2018,7.09
07-2018,7.73
07-2018,6.17
07-2018,7.48
07-2018,7.66
07-2018,6.4
07-2018,6.61
07-2018,4.99
07-2018,7.55
07-2018,6.81
07-2018,8.5
07-2018,7.37
07-2018,6.95
07-2018,5.77
07-2018,10.95
07-2018,5.49
07-2018,8.04
07-2018,6.09
07-2018,7.33
07-2018,6.28
07-2018,3.82
07-2018,5.54
07-2018,5.47
07-2018,5.09
07-2018,7.66
07-2018,7.23
07-2018,5.57
07-2018,6.56
07-2018,6.49
07-2018,7.7
07-2018,5.36
07-2018,6.17
07-2018,7.41
07-2018,6.78
07-2018,6.07
07-2018,5.93
07-2018,6.67
07-2018,6.41
07-2018,7.06
07-2018,6.56
07-2018,7.02
07-2018,7.31
07-2018,8.44
07-2018,7.8
07-2018,8.15
07-2018,7.81
07-2018,6.85
07-2018,7.02
07-2018,7.44
07-2018,7.77
07-2018,6.11
07-2018,7.13
07-2018,8.3
07-2018,7.42
07-2018,5.38
07-2018,6.1
07-2018,6.26
07-2018,7.12
07-2018,6.29
07-2018,5.65
07-2018,7.69
07-2018,5.25
07-2018,6.94
07-2018,7.44
07-2018,7.19
07-2018,7.45
07-2018,7.22
07-2018,6.4
07-2018,9.99
07-2018,6.42
07-2018,6.4
07-2018,6.75
07-2018,7.39
07-2018,3.99
07-2018,5.21
07-2018,6.6
07-2018,14.23
07-2018,5.81
07-2018,8.32
07-2018,5.36
07-2018,5.27
07-2018,6.1
07-2018,7.43
07-2018,3.62
07-2018,7.93
07-2018,5.14
07-2018,7.12
07-2018,6.92
07-2018,5.94
07-2018,7.85
07-2018,7.59
07-2018,6.66
07-2018,7.7
07-2018,5.31
07-2018,6.8
07-2018,7.89
07-2018,7.15
07-2018,6.79
07-2018,8.26
07-2018,8.17
07-2018,6.31
07-2018,6.33
07-2018,7.5
07-2018,7.2
07-2018,7.15
07-2018,7.74
07-2018,6.35
07-2018,3.89
07-2018,6.28
07-2018,5.97
07-2018,7.21
07-2018,5.11
07-2018,7.23
07-2018,5.78
07-2018,6.28
07-2018,6.39
07-2018,3.53
07-2018,5.94
07-2018,6.79
07-2018,6.09
07-2018,6.87
07-2018,7.37
07-2018,6.05
07-2018,5.68
07-2018,3.8
07-2018,6.07
07-2018,6.5
07-2018,7.15
07-2018,6.66
07-2018,5.16
07-2018,6.96
07-2018,7.35
07-2018,6.29
07-2018,6.26
07-2018,6.8
07-2018,6.09
07-2018,6.05
07-2018,6.01
07-2018,7.68
07-2018,5.65
07-2018,4.14
07-2018,4.98
07-2018,6.85
07-2018,5.59
07-2018,5.27
07-2018,6.14
07-2018,4.9
07-2018,6.88
07-2018,4.67
07-2018,6.29
07-2018,6.16
07-2018,8.45
07-2018,5.98
07-2018,6.31
07-2018,6.64
07-2018,6.48
07-2018,4.83
07-2018,8.5
07-2018,4.97
07-2018,6.56
07-2018,6.67
07-2018,6.53
07-2018,6.84
07-2018,8.32
07-2018,6.0
07-2018,5.53
07-2018,6.0
07-2018,3.98
07-2018,4.93
07-2018,8.58
07-2018,7.12
07-2018,5.22
07

2025-01-20 19:06:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:06:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:06:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:06:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 15
2025-01-20 19:06:39 - snowflake.connector.connection - INFO - closed
2025-01-20 19:06:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:06:39 - root - INFO - SQL:
SELECT DISTINCT "month_year"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   LIMIT 1000;
Results:
month_year
07-2018
""
08-2018
10-2018
11-2018
12-2018
01-2019
04-2019
05-2019
06-2019
07-2019
08-2019
09-2018
02-2019
03-2019

2025-01-20 19:06:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:06:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:06:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:06:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:06:41 - snowflake.connector.connection - INFO - closed
2025-01-20 19:06:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:06:41 - root - INFO - SQL:
SELECT "id", "interest_name"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP
   LIMIT 1000;
Results:
Too long, hard cut:
id,interest_name
1,Fitness Enthusiasts
2,Gamers
3,Car Enthusiasts
4,Luxury Retail Researchers
5,Brides & Wedding Planners
6,Vacation Planners
7,Motorcycle Enthusiasts
8,Business News Readers
12,Thrift Store Shoppers
13,Advertising Professionals
14,NFL Fans
15,NBA Fans
16,NCAA Fans
17,MLB Fans
18,Nascar Fans
19,Eco-Conscious Consumers
20,Moviegoers
21,DIYers
22,Grill Masters
23,Techies
24,Home Design Enthusiasts
25,Doctors
26,Streaming Video Fans
27,Auto Insurance Shoppers
28,Teachers
29,College Students
30,Department Store Shoppers
31,Home Decor Shoppers
33,Kids Clothing Shoppers
34,Teen Girl Clothing Shoppers
35,Mens Clothing Shoppers
36,Baby Products Buyers
37,Jewelry & Watch Shoppers
38,Sporting Goods Shoppers
39,Furniture Shoppers
40,Bed & Bath Shoppers
41,Intimates Shoppers
42,Fast Fashion Shoppers
43,Apartment Hunters
44,Home Buyers
45,Moving Services Shoppers
46,Job Seekers
48,Charitable Donors
49,NHL Fans
50,Discount Big Box Shoppers
51,Black Friday Deal Shoppers
53,Hip Hop Fans
54,Online Investors
55,Seasonal Allergy Sufferers
56,Discount Device Shoppers
57,Mobile Phone Comparison Shoppers
58,Budget Wireless Shoppers
59,Menopause Researchers
60,Online Health Researchers
61,Beauty & Skincare Buyers
62,Streaming Device Shoppers
63,New & Expecting Parents
64,High-End Kids Furniture and Clothes Shoppers
65,Hands-On Parents
66,Fantasy & Comic Fans
67,Lawyers
69,Healthy Eaters
70,Drug Store Shoppers
71,Lawn & Garden Enthusiasts
72,Nurses
73,Mailing & Shipping Shoppers
74,Office Supply Shoppers
75,Ink & Toner Shoppers
77,Luxury Retail Shoppers
78,Contractors & Construction Professionals
79,Luxury Travel Researchers
80,Democrats
81,Republicans
82,HDTV Researchers
83,Hardware Shoppers
84,Reggaeton Fans
85,Online Movie Downloaders
86,Sale Seekers
87,Theme Park Researchers
88,Ski and Snowboard Enthusiasts
89,Travel Researchers
90,Coupon Researchers
91,Parents with Toddlers
92,Parents with Kids
93,Young Boomers
94,Day Care Users
95,Stay-at-Home Parents
96,Exercise and Gym Researchers
97,Home Kitchen Chefs
98,Restaurant Researchers
99,Order-in Eaters
100,Nutrition Conscious Eaters
101,Flower & Gift Basket Shoppers
102,Plus Size Women
103,Live Concert Fans
104,Country Music Fans
106,Comedy Fans
107,Cruise Travel Intenders
108,Pain Medication Users
109,Joint Pain Sufferers
110,Pain Management Researchers
111,Retirement Planners
112,Auto Repair Researchers
113,Avid Readers
114,Womens Fashion Magazine Readers
115,Mens Shoe Shoppers
116,Home Security Shoppers
117,Boxing Fans
118,Sleep Disorder Researchers
119,Mortgage Researchers
121,Coders & Developers
123,Military Servicemembers & Veterans
124,Healthcare Discount Shoppers
125,Postal Employees
126,Soccer Fans
128,Kitchen & Bathroom Remodelers
129,Aftermarket Accessories Shoppers
130,Automotive Safety Researchers
131,Android Fans
132,Apple Fans
133,High End Camera Shoppers - Dupe
134,Home Printer Shoppers
135,Major Appliance Shoppers
136,Tablet Researchers
137,Online Alcohol Shoppers
138,Home Kitchen Bakers
139,Makeup Researchers
140,Pet Owners
141,Skin Care Researchers
142,Credit Card Researchers
143,Health Insurance Researchers
145,Property Insurance Researchers
146,Audio Equipment Researchers
147,Broadway Fans
148,Celebrity Gossip Fans
149,Streaming Radio Listeners
150,TV Junkies
151,Big & Tall Men
153,Phone Accessory Shoppers
154,Prepaid Smartphone Shoppers
155,Business Travelers
157,Car Rental Shoppers
158,Flight and Hotel Shoppers
160,Sightseeing Travelers
161,Travel Reward Points Enthusiasts
162,Retirees
163,Federal Employees
164,Conservative News Readers
165,Liberal News Readers
166,Doves
168,Social Conservatives
169,Social Liberals
170,Voters
171,Shoe Shoppers
4847,Readers of Hispanic Content
4848,Working Parents
4852,Health & Fitness
4855,Entertainment & Tabloid Magazine Readers
4857,Business Accounting Software Researchers
4858,Business Filing Researchers
4859,Business Logistics Managers
4861,IT Decision Makers
4866,Small Business Employees
4867,Sweepstakes Enthusiasts
4869,Womens Fitness Enthusiasts
4870,Tech-Savvy Moms
4872,Readers of Mexican Content
4873,TV Game Show Fans
4894,Credit Union Researchers
4895,Mature Parents
4896,Streaming Music Enthusiasts
4897,Parents of Teenagers Going to College
4898,Cosmetics and Beauty Shoppers
4899,Readers of Japanese Content
4902,Yogis
4903,Asthma Sufferers
4904,Adult Acne Sufferers
4905,Heartburn Sufferers
4906,Sinus Researchers
4907,Headache and Migraine Sufferers
4908,Back Pain Sufferers
4909,First Aid Researchers
4910,Cholesterol Researchers
4911,Dieters
4912,Vitamin Shoppers
4913,Womens Health Researchers
4914,Mens Health Researchers
4915,Food Allergies Researchers
4916,Arthritis Sufferers
4917,Teen Content Readers
4918,Gastrointestinal Researchers
4919,Military Families
4920,LGBT Activists
4921,Tire Shoppers
4924,Surfers
4925,Gun Control Advocates
4926,Gun Rights Advocates
4927,Immigration Rights Advocates
4928,Immigration Control Advocates
4929,Right Wing Radicals
4930,Occupy Movement Supporters
4931,Marijua

2025-01-20 19:06:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:06:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:06:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:06:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:06:43 - snowflake.connector.connection - INFO - closed
2025-01-20 19:06:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:06:43 - root - INFO - SQL:
SELECT "interest_id", "composition"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   WHERE "composition" > 0.5
   LIMIT 1000;
Results:
Too long, hard cut:
interest_id,composition
32486.0,11.89
6106.0,9.93
18923.0,10.85
6344.0,10.32
100.0,10.77
69.0,10.82
79.0,11.21
6111.0,10.71
6214.0,9.71
19422.0,10.11
6110.0,11.57
4895.0,9.47
6217.0,10.8
4.0,13.97
6218.0,9.29
6123.0,9.49
171.0,14.91
19613.0,12.62
17.0,7.89
6.0,11.99
6013.0,9.35
4870.0,10.29
19423.0,12.22
6089.0,6.97
161.0,11.48
6286.0,14.1
5991.0,11.04
92.0,9.77
6184.0,13.35
19621.0,11.61
63.0,9.37
103.0,6.61
38.0,9.48
17786.0,13.67
6232.0,9.97
165.0,6.05
18351.0,6.09
15.0,6.9
,6.12
17314.0,10.43
6151.0,6.83
4914.0,7.42
115.0,11.68
5968.0,12.87
36.0,9.27
5943.0,6.37
133.0,10.91
1.0,7.02
114.0,6.25
6107.0,8.84
150.0,5.3
60.0,6.71
96.0,7.21
22403.0,12.27
40.0,10.86
19758.0,6.28
17730.0,11.38
5938.0,11.63
4869.0,6.47
4897.0,12.93
6029.0,8.72
31.0,7.9
16137.0,9.65
6330.0,6.82
6334.0,11.63
6315.0,8.14
4852.0,6.77
16.0,6.24
6108.0,6.65
6206.0,10.76
6006.0,6.26
6228.0,10.22
20768.0,6.53
4902.0,8.17
6277.0,11.72
19757.0,10.95
4911.0,6.87
,7.13
4910.0,6.09
6285.0,9.97
11974.0,7.19
6219.0,6.37
10250.0,11.4
6128.0,6.28
5946.0,5.99
158.0,7.46
15935.0,9.13
4855.0,5.99
149.0,6.88
16197.0,6.13
11067.0,5.14
17674.0,6.25
4913.0,6.76
56.0,7.09
6341.0,5.68
6316.0,6.52
18647.0,6.45
17803.0,6.21
23.0,5.41
132.0,7.48
6365.0,6.45
6378.0,9.64
17673.0,8.07
97.0,6.41
7537.0,7.82
20764.0,5.85
44.0,6.11
5.0,10.82
6227.0,6.07
19.0,6.57
93.0,7.08
6085.0,7.08
6112.0,9.22
4873.0,5.45
11975.0,7.81
22502.0,8.24
86.0,6.13
19610.0,7.56
20753.0,5.79
24.0,6.54
20750.0,5.87
12133.0,10.79
6141.0,6.34
6172.0,5.88
98.0,7.64
125.0,6.38
17269.0,8.64
4943.0,8.81
18996.0,7.84
13.0,6.72
89.0,8.48
169.0,6.1
101.0,7.38
6087.0,5.41
104.0,5.42
6284.0,18.82
7557.0,8.17
37.0,7.82
6084.0,6.97
8.0,6.67
5969.0,11.15
39.0,17.44
117.0,6.49
19298.0,10.27
22427.0,8.04
85.0,6.46
5952.0,7.11
164.0,6.14
19587.0,5.85
33.0,7.6
135.0,7.01
19588.0,5.87
17320.0,3.98
77.0,17.19
18648.0,7.1
5989.0,5.57
138.0,7.3
18202.0,7.61
137.0,7.94
4940.0,5.89
12277.0,6.2
4909.0,7.01
4944.0,8.32
10008.0,9.46
6299.0,5.71
20731.0,5.86
10838.0,6.8
111.0,7.42
6127.0,5.96
6304.0,8.31
61.0,6.59
6211.0,8.09
66.0,6.51
6182.0,6.57
151.0,7.97
3.0,6.14
10976.0,8.16
18646.0,6.85
21242.0,7.36
7453.0,6.45
6162.0,6.32
128.0,6.5
5972.0,6.58
6171.0,8.19
131.0,5.09
21293.0,7.28
7461.0,7.0
17785.0,7.66
10839.0,5.59
4912.0,7.77
6318.0,6.65
7605.0,6.82
4905.0,5.66
6023.0,8.02
67.0,6.67
16138.0,8.81
5960.0,7.86
6308.0,7.67
18621.0,7.31
4861.0,5.29
12.0,7.23
90.0,5.91
19630.0,7.15
6278.0,6.18
70.0,6.96
64.0,8.8
19579.0,6.24
6329.0,7.63
5970.0,9.21
4907.0,6.26
6076.0,5.75
18490.0,7.09
20767.0,7.73
147.0,6.17
10837.0,7.48
130.0,7.66
5914.0,6.4
6144.0,6.61
88.0,4.99
6255.0,7.55
27.0,6.81
6336.0,8.5
5921.0,7.37
19879.0,6.95
15877.0,5.77
21057.0,10.95
148.0,5.49
32704.0,8.04
5951.0,6.09
6062.0,7.33
4915.0,6.28
6133.0,3.82
6250.0,5.54
6143.0,5.47
49.0,5.09
6173.0,7.66
75.0,7.23
19614.0,5.57
18781.0,6.56
4848.0,6.49
6237.0,7.7
19760.0,5.36
5930.0,6.17
6302.0,7.41
13496.0,6.78
12820.0,6.07
4920.0,5.93
6115.0,6.67
22425.0,6.41
73.0,7.06
22096.0,6.56
6337.0,7.02
6265.0,7.31
19295.0,8.44
18347.0,7.8
6343.0,8.15
6207.0,7.81
18350.0,6.85
6064.0,7.02
18622.0,7.44
141.0,7.77
6181.0,6.11
6148.0,7.13
10977.0,8.3
6045.0,7.42
6298.0,5.38
6145.0,6.1
22.0,6.26
12132.0,7.12
4918.0,6.29
17671.0,5.65
5906.0,7.69
35.0,5.25
5911.0,6.94
6340.0,7.44
21292.0,7.19
19250.0,7.45
19294.0,7.22
163.0,6.4
82.0,9.99
13498.0,6.42
4925.0,6.4
109.0,6.75
6319.0,7.39
33191.0,3.99
10365.0,5.21
6366.0,6.6
4898.0,14.23
4894.0,5.81
12027.0,8.32
5963.0,5.36
6260.0,5.27
4917.0,6.1
7425.0,7.43
20817.0,3.62
16119.0,7.93
5999.0,5.14
5907.0,7.12
18784.0,6.92
65.0,5.94
5898.0,7.85
6220.0,7.59
19296.0,6.66
6264.0,7.7
6051.0,5.31
5918.0,6.8
5895.0,7.89
12602.0,7.15
5901.0,6.79
34.0,8.26
10988.0,8.17
116.0,6.31
4866.0,6.33
6095.0,7.5
6229.0,7.2
13421.0,7.15
102.0,7.74
4919.0,6.35
20814.0,3.89
4904.0,6.28
7527.0,5.97
12026.0,7.21
4924.0,5.11
21061.0,7.23
20963.0,5.78
6323.0,6.28
5944.0,6.39
14.0,3.53
6221.0,5.94
99.0,6.79
6210.0,6.09
139.0,6.87
74.0,7.37
19603.0,6.05
5924.0,5.68
126.0,3.8
5920.0,6.07
7529.0,6.5
95.0,7.15
21059.0,6.66
162.0,5.16
41.0,6.96
10972.0,7.35
5942.0,6.29
22413.0,6.26
7540.0,6.8
5896.0,6.09
22424.0,6.05
26.0,6.01
19338.0,7.68
4847.0,5.65
19578.0,4.14
6263.0,4.98
12490.0,6.85
22428.0,5.59
21237.0,5.27
10980.0,6.14
5984.0,4.9
6267.0,6.88
6235.0,4.67
45.0,6.29
18620.0,6.16
12025.0,8.45
43.0,5.98
119.0,6.31
6266.0,6.64
4859.0,6.48
6077.0,4.83
21058.0,8.5
155.0,4.97
4857.0,6.56
12031.0,6.67
10978.0,6.53
22419.0,6.84
107.0,8.32
5913.0,6.0
32703.0,5.53
19619.0,6.0
19627.0,3.98
17318.0,4.93
21060.0,8.58
5961.0,7.12
5910.0,5.22
18997.0,5.8
5957.0,6.08
83.0,4.04
19592.0,5.08
160.0,5.92
6142.0,5.5
87.0,5.01
22423.0,5.33
6164.0,5.37
18352.0,6.55
113.0,5.53
21236.0,4.04
6183.0,6.71
21238.0,4.92
80.0,4.47
6081.0,5.92
6208.0,9.67
91.0,5.87
23778.0,5.13
18204.0,5.93
17540.0,5.06
21239.0,3.52
19628.0,4.66
18995.0,4.97
19590.0,4.59
29.0,5.2
22095.0,4.54
145.0,4.89
19297.0,4.26
19600.0,5.21
10870.0,3.29
6160.0,4.93
18998.0,4.12
6314.0,3.77
20815.0,3.03
6301.0,5.

2025-01-20 19:06:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:06:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:06:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:06:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:06:44 - snowflake.connector.connection - INFO - closed
2025-01-20 19:06:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:06:45 - root - INFO - SQL:
SELECT "interest_id", MAX("composition") AS "max_composition"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   GROUP BY "interest_id"
   LIMIT 1000;
Results:
Too long, hard cut:
interest_id,max_composition
32486.0,11.89
6106.0,9.93
18923.0,10.85
6344.0,10.32
100.0,10.77
6111.0,10.71
19422.0,10.11
6110.0,11.57
6217.0,10.8
171.0,14.91
19613.0,12.62
17.0,7.89
6.0,12.56
6013.0,9.35
4870.0,10.29
19423.0,12.22
6089.0,6.97
6286.0,14.1
19621.0,11.61
63.0,9.37
165.0,6.05
18351.0,6.09
,9.66
17314.0,10.43
4914.0,7.42
6107.0,8.84
40.0,10.86
5938.0,11.63
16137.0,9.65
6330.0,6.82
6006.0,6.26
6228.0,10.22
4902.0,8.17
97.0,6.41
20764.0,5.85
5.0,10.82
19610.0,7.56
4940.0,5.89
10838.0,6.8
6255.0,7.55
69.0,10.82
79.0,11.21
4895.0,9.47
5991.0,11.04
114.0,6.25
96.0,7.21
19758.0,6.28
6029.0,10.05
6334.0,11.63
6315.0,8.14
6206.0,10.76
20768.0,6.53
4855.0,5.99
56.0,7.09
23.0,5.41
98.0,7.64
18646.0,6.85
6162.0,6.32
128.0,6.5
6308.0,9.33
148.0,5.49
18347.0,7.8
4910.0,6.09
32703.0,5.69
6214.0,9.71
4.0,13.97
6218.0,9.29
161.0,11.48
92.0,9.77
6184.0,13.35
6232.0,9.97
36.0,9.27
150.0,5.3
17730.0,11.38
4869.0,6.47
31.0,7.9
19757.0,10.95
4911.0,6.87
5946.0,5.99
6378.0,9.64
6172.0,6.1
169.0,6.1
6299.0,5.71
6304.0,8.31
6123.0,9.49
103.0,6.61
38.0,9.48
17786.0,13.67
15.0,6.9
115.0,11.68
22403.0,12.27
4852.0,6.77
6108.0,6.65
6219.0,6.37
10250.0,11.4
149.0,6.88
16197.0,6.13
11067.0,7.93
4913.0,6.76
6316.0,6.52
17803.0,6.21
44.0,6.11
19.0,6.57
4873.0,5.57
86.0,6.13
24.0,6.54
12133.0,15.15
6141.0,6.34
4943.0,10.7
18996.0,7.84
85.0,6.46
19587.0,5.85
135.0,7.01
19588.0,5.87
77.0,17.19
4944.0,9.46
111.0,7.42
151.0,7.97
7461.0,7.0
17785.0,7.66
6318.0,6.65
7605.0,6.82
12.0,7.23
70.0,6.96
19579.0,6.24
18490.0,7.09
147.0,6.17
6062.0,7.33
19760.0,5.36
6115.0,6.67
6265.0,7.31
18350.0,6.85
6148.0,7.13
6340.0,7.44
109.0,6.75
12027.0,8.32
18784.0,7.47
34.0,11.23
102.0,7.74
6323.0,6.28
5896.0,6.09
6301.0,5.58
22411.0,5.22
6321.0,4.97
62.0,4.15
6222.0,3.49
6341.0,5.68
17673.0,8.07
6112.0,9.22
20753.0,5.79
125.0,6.38
17269.0,8.64
6284.0,18.82
7557.0,8.17
117.0,6.49
33.0,7.6
17320.0,3.98
18202.0,8.23
10008.0,9.46
10976.0,8.16
21242.0,7.36
21293.0,7.28
6278.0,6.18
64.0,12.41
88.0,4.99
5921.0,7.37
21057.0,21.2
6133.0,3.82
22096.0,6.56
18622.0,7.44
19294.0,7.22
5963.0,5.36
10988.0,8.17
116.0,6.31
21061.0,8.97
5984.0,4.9
45.0,6.29
21058.0,8.5
4857.0,6.56
6024.0,4.7
157.0,4.94
143.0,4.68
14901.0,4.15
6320.0,4.72
19604.0,5.82
7536.0,5.84
16196.0,4.59
18203.0,2.9
38360.0,3.48
36864.0,3.35
37876.0,2.26
10954.0,1.88
133.0,10.91
11974.0,7.19
15935.0,9.13
18647.0,6.45
5968.0,12.87
5943.0,6.37
16.0,6.24
6277.0,11.72
6285.0,9.97
6128.0,6.28
17674.0,7.88
93.0,7.08
22502.0,8.24
20750.0,5.87
6087.0,5.41
104.0,5.42
39.0,17.44
5952.0,7.11
164.0,6.14
5989.0,5.57
138.0,7.3
12277.0,6.2
61.0,6.59
6211.0,8.09
5972.0,6.6
6023.0,8.02
5960.0,10.61
90.0,5.91
6144.0,6.61
49.0,5.09
75.0,7.23
18781.0,6.56
4848.0,6.49
5930.0,6.17
13496.0,6.78
4920.0,5.93
163.0,6.4
33191.0,4.39
5918.0,6.8
13421.0,7.15
12025.0,8.45
19297.0,4.26
10870.0,3.29
19606.0,4.42
170.0,4.76
6151.0,6.83
1.0,7.02
60.0,8.66
158.0,11.97
132.0,7.48
6365.0,6.45
7537.0,7.82
6227.0,6.45
6085.0,7.08
11975.0,7.81
13.0,6.72
89.0,10.14
37.0,7.82
6084.0,6.97
8.0,6.67
4909.0,7.01
6127.0,5.96
66.0,6.51
7453.0,6.45
6171.0,8.19
131.0,5.09
10839.0,5.59
67.0,6.76
4861.0,5.29
19630.0,7.15
5970.0,9.21
4907.0,6.26
20767.0,7.73
10837.0,7.48
130.0,7.66
27.0,6.81
19879.0,6.95
4915.0,6.28
6250.0,5.54
6237.0,7.7
6302.0,7.41
22425.0,6.41
6207.0,7.81
141.0,9.46
6181.0,6.11
6298.0,5.38
6145.0,6.1
22.0,6.26
4918.0,6.29
17671.0,5.65
5906.0,7.69
35.0,5.25
21292.0,7.19
19250.0,7.7
82.0,9.99
13498.0,6.42
4925.0,6.4
6319.0,7.39
10365.0,5.21
6366.0,6.6
4898.0,14.23
7425.0,8.54
16119.0,7.93
65.0,5.94
5898.0,7.85
6051.0,5.31
5901.0,6.79
4866.0,6.33
6095.0,7.5
6229.0,7.2
20814.0,5.78
4904.0,6.28
7527.0,5.97
20963.0,5.78
6221.0,5.94
6210.0,6.09
139.0,6.87
19603.0,6.05
126.0,6.67
5920.0,6.07
7529.0,6.5
41.0,6.96
10972.0,7.35
22424.0,6.05
19338.0,7.68
19578.0,4.14
6263.0,5.14
10980.0,6.14
6267.0,6.88
119.0,6.31
4859.0,6.48
155.0,4.97
12031.0,7.08
107.0,8.32
17318.0,4.93
21060.0,8.58
5961.0,7.12
18997.0,6.05
6142.0,6.25
87.0,5.01
22423.0,5.33
21236.0,6.64
21238.0,5.15
80.0,4.47
6208.0,9.67
23778.0,5.52
18204.0,6.51
19628.0,4.66
19590.0,4.59
22095.0,4.54
145.0,4.89
20815.0,3.03
6305.0,6.2
6328.0,5.43
30.0,8.56
4928.0,4.78
59.0,3.97
55.0,7.67
18619.0,9.15
6030.0,3.85
10284.0,5.02
6209.0,4.45
6169.0,3.8
142.0,4.73
6194.0,4.39
153.0,5.08
10832.0,4.4
6088.0,4.28
11065.0,4.22
22093.0,4.34
6393.0,3.17
50.0,3.86
20755.0,4.77
12821.0,5.18
14800.0,4.11
6300.0,4.91
10009.0,8.95
18807.0,4.1
32705.0,4.69
6335.0,4.41
108.0,4.24
6149.0,4.1
10364.0,3.29
6367.0,3.78
4903.0,3.67
110.0,5.78
20816.0,2.79
4867.0,5.44
20730.0,4.0
7546.0,4.72
18924.0,4.61
4908.0,3.29
19593.0,6.18
6230.0,4.39
6317.0,4.67
5936.0,3.78
18783.0,9.83
7597.0,3.18
7545.0,4.19
6345.0,3.94
17729.0,6.7
4906.0,3.09
10970.0,4.04
22401.0,3.62
10836.0,4.18
4933.0,3.46
6215.0,3.81
6156.0,2.99
5945.0,4.87
112.0,2.95
6339.0,3.79
6122.0,3.05
19594.0,2.48
4931.0,4.05
6034.0,4.69
22398.0,3.52
72.0,3.63
19609.0,3.17
6332.0,2.65
21248.0,2.88
58.0,2.18
10971.0,2.67
7598.0,2.82
19626.0,1.99
19631.0,2.

2025-01-20 19:06:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:06:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:06:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:06:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 19:06:46 - snowflake.connector.connection - INFO - closed
2025-01-20 19:06:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:07:31 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 19:07:31 - root - INFO - ```sql
SELECT 
    t1."month_year" AS "Time", 
    t2."interest_name" AS "Interest Name", 
    t1."composition" AS "Composition Value"
FROM
    BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS t1
JOIN 
    BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP t2
    ON t1."interest_id" = t2."id"
WHERE
    (t1."interest_id", t1."composition") IN (
        SELECT 
            "interest_id", 
            MAX("composition") 
        FROM 
            BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
        GROUP BY 
            "interest_id"
    )
ORDER BY 
    t1."composition" DESC
LIMIT 10

UNION ALL

SELECT 
    t1."month_year" AS "Time", 
    t2."interest_name" AS "Interest Name", 
    t1."composition" AS "Composition Value"
FROM
    BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS t1
JOIN 
    BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP t2
    ON t1."interest_id" = t2."id"
WHERE
    (t1."interest_id", t1."composition") IN (
        SELECT 
            "interest_id", 
            MAX("composition") 
        FROM 
            BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
        GROUP BY 
            "interest_id"
    )
ORDER BY 
    t1."composition" ASC
LIMIT 10;
```
2025-01-20 19:07:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:07:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:07:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:07:33 - snowflake.connector.connection - INFO - closed
2025-01-20 19:07:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:08:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 19:08:37 - root - INFO - ```sql
WITH MaxCompositions AS (
    SELECT
        t1."interest_id",
        t2."interest_name" AS "Interest Name",
        t1."month_year" AS "Time",
        t1."composition" AS "Composition Value",
        ROW_NUMBER() OVER (PARTITION BY t1."interest_id" ORDER BY t1."composition" DESC) AS rn
    FROM 
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS t1
    JOIN 
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP t2
        ON t1."interest_id" = t2."id"
)
SELECT "Time", "Interest Name", "Composition Value"
FROM (
    SELECT "Time", "Interest Name", "Composition Value",
        ROW_NUMBER() OVER (ORDER BY "Composition Value" DESC) AS rank_desc,
        ROW_NUMBER() OVER (ORDER BY "Composition Value" ASC) AS rank_asc
    FROM MaxCompositions
    WHERE rn = 1
) sub
WHERE rank_desc <= 10 OR rank_asc <= 10
ORDER BY "Composition Value" DESC;
```

This query identifies the top 10 and bottom 10 interest categories based on their highest composition values across all months. It selects the time (`"Time"`), interest name (`"Interest Name"`), and the maximum composition value (`"Composition Value"`) for each interest category.

**Explanation:**

- **CTE `MaxCompositions`:**
  - Joins `INTEREST_METRICS` (`t1`) with `INTEREST_MAP` (`t2`) to get interest names.
  - Uses `ROW_NUMBER()` partitioned by `interest_id` and ordered by `composition` in descending order to find the record with the highest composition for each interest ID (`rn = 1`).

- **Main Query:**
  - Filters the rows where `rn = 1`, meaning only the maximum composition values for each interest category.
  - Assigns rankings (`rank_desc` and `rank_asc`) to identify the top and bottom interest categories.
  - Selects the top 10 (`rank_desc <= 10`) and bottom 10 (`rank_asc <= 10`) categories.
  - Orders the final results by `"Composition Value"` in descending order.

**Note:** This query avoids the syntax error caused by placing `ORDER BY` and `LIMIT` clauses before the `UNION ALL` operator. By using Common Table Expressions (CTEs) and proper ranking functions, it ensures compatibility and correctness.
2025-01-20 19:08:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:08:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:08:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:08:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-01-20 19:08:38 - snowflake.connector.connection - INFO - closed
2025-01-20 19:08:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:09:54 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 19:09:54 - root - INFO - SQL:
WITH MaxCompositions AS (
    SELECT
        t1."interest_id",
        t2."interest_name" AS "Interest Name",
        t1."month_year" AS "Time",
        t1."composition" AS "Composition Value",
        ROW_NUMBER() OVER (PARTITION BY t1."interest_id" ORDER BY t1."composition" DESC) AS rn
    FROM 
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS t1
    JOIN 
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP t2
        ON t1."interest_id" = t2."id"
)
SELECT "Time", "Interest Name", "Composition Value"
FROM (
    SELECT "Time", "Interest Name", "Composition Value",
        ROW_NUMBER() OVER (ORDER BY "Composition Value" DESC) AS rank_desc,
        ROW_NUMBER() OVER (ORDER BY "Composition Value" ASC) AS rank_asc
    FROM MaxCompositions
    WHERE rn = 1
) sub
WHERE rank_desc <= 10 OR rank_asc <= 10
ORDER BY "Composition Value" DESC;
Results:
Time,Interest Name,Composition Value
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
07-2018,Readers of Jamaican Content,1.86
02-2019,Automotive News Readers,1.84
07-2018,Comedy Fans,1.83
08-2019,World of Warcraft Enthusiasts,1.82
08-2018,Miami Heat Fans,1.81
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2019,Hearthstone Video Game Fans,1.66
09-2018,Scifi Movie and TV Enthusiasts,1.61
09-2018,Action Movie and TV Enthusiasts,1.59
03-2019,The Sims Video Game Fans,1.57

2025-01-20 19:09:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:09:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:09:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:09:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 15
2025-01-20 19:09:56 - snowflake.connector.connection - INFO - closed
2025-01-20 19:09:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:09:56 - root - INFO - SQL:
SELECT "month_year", AVG("composition") AS "avg_composition"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
GROUP BY "month_year"
LIMIT 1000
Results:
month_year,avg_composition
07-2018,5.670631001371743
,3.935435510887772
08-2018,3.806623207301173
09-2018,3.5034358974358972
10-2018,4.066382730455076
11-2018,3.398491379310345
12-2018,3.498140703517588
01-2019,3.0821171634121276
02-2019,3.5352899197145407
03-2019,3.2845070422535207
05-2019,2.345647607934656
04-2019,2.795550500454959
06-2019,2.153082524271845
07-2019,2.444421296296296
08-2019,2.9340905134899913

2025-01-20 19:09:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:09:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:09:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:09:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:09:58 - snowflake.connector.connection - INFO - closed
2025-01-20 19:09:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:09:58 - root - INFO - SQL:
SELECT "interest_id", "percentile_ranking"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
LIMIT 1000
Results:
Too long, hard cut:
interest_id,percentile_ranking
32486.0,99.86
6106.0,99.73
18923.0,99.59
6344.0,99.45
100.0,99.31
69.0,99.18
79.0,99.04
6111.0,98.9
6214.0,98.9
19422.0,98.63
6110.0,98.49
4895.0,98.35
6217.0,98.22
4.0,98.08
6218.0,97.94
6123.0,97.81
171.0,97.67
19613.0,97.53
17.0,97.39
6.0,97.26
6013.0,97.12
4870.0,96.98
19423.0,96.84
6089.0,96.71
161.0,96.57
6286.0,96.57
5991.0,96.3
92.0,96.16
6184.0,96.02
19621.0,95.88
63.0,95.75
103.0,95.61
38.0,95.47
17786.0,95.34
6232.0,95.2
165.0,95.06
18351.0,94.92
15.0,94.79
,96.4
17314.0,94.65
6151.0,94.65
4914.0,94.65
115.0,94.24
5968.0,94.24
36.0,93.96
5943.0,93.83
133.0,93.69
1.0,93.69
114.0,93.42
6107.0,93.28
150.0,93.28
60.0,93.0
96.0,92.87
22403.0,92.73
40.0,92.59
19758.0,92.59
17730.0,92.32
5938.0,92.18
4869.0,92.18
4897.0,91.91
6029.0,91.77
31.0,91.77
16137.0,91.5
6330.0,91.36
6334.0,91.36
6315.0,91.36
4852.0,90.95
16.0,90.95
6108.0,90.67
6206.0,90.67
6006.0,90.4
6228.0,90.4
20768.0,90.4
4902.0,89.99
6277.0,89.85
19757.0,89.71
4911.0,89.71
,96.23
4910.0,89.44
6285.0,89.3
11974.0,89.16
6219.0,89.16
10250.0,88.89
6128.0,88.75
5946.0,88.61
158.0,88.61
15935.0,88.34
4855.0,88.2
149.0,88.2
16197.0,87.93
11067.0,87.79
17674.0,87.65
4913.0,87.65
56.0,87.38
6341.0,87.38
6316.0,87.38
18647.0,87.38
17803.0,87.38
23.0,86.69
132.0,86.56
6365.0,86.56
6378.0,86.28
17673.0,86.15
97.0,86.15
7537.0,86.15
20764.0,86.15
44.0,85.6
5.0,85.6
6227.0,85.6
19.0,85.19
93.0,85.19
6085.0,84.91
6112.0,84.77
4873.0,84.64
11975.0,84.5
22502.0,84.36
86.0,84.36
19610.0,84.09
20753.0,83.95
24.0,83.95
20750.0,83.95
12133.0,83.95
6141.0,83.4
6172.0,83.4
98.0,83.4
125.0,82.99
17269.0,82.99
4943.0,82.72
18996.0,82.72
13.0,82.72
89.0,82.72
169.0,82.17
101.0,82.17
6087.0,81.89
104.0,81.89
6284.0,81.89
7557.0,81.89
37.0,81.89
6084.0,81.21
8.0,81.07
5969.0,81.07
39.0,81.07
117.0,80.66
19298.0,80.52
22427.0,80.52
85.0,80.25
5952.0,80.25
164.0,80.25
19587.0,79.84
33.0,79.84
135.0,79.56
19588.0,79.42
17320.0,79.42
77.0,79.42
18648.0,79.01
5989.0,78.88
138.0,78.74
18202.0,78.74
137.0,78.46
4940.0,78.33
12277.0,78.33
4909.0,78.33
4944.0,78.33
10008.0,77.78
6299.0,77.64
20731.0,77.64
10838.0,77.64
111.0,77.64
6127.0,77.09
6304.0,77.09
61.0,77.09
6211.0,76.68
66.0,76.68
6182.0,76.68
151.0,76.68
3.0,76.13
10976.0,75.99
18646.0,75.99
21242.0,75.99
7453.0,75.58
6162.0,75.45
128.0,75.45
5972.0,75.45
6171.0,75.03
131.0,75.03
21293.0,75.03
7461.0,75.03
17785.0,75.03
10839.0,75.03
4912.0,75.03
6318.0,74.07
7605.0,74.07
4905.0,74.07
6023.0,74.07
67.0,73.53
16138.0,73.53
5960.0,73.53
6308.0,73.53
18621.0,73.53
4861.0,72.84
12.0,72.7
90.0,72.7
19630.0,72.7
6278.0,72.29
70.0,72.29
64.0,72.29
19579.0,72.29
6329.0,71.74
5970.0,71.74
4907.0,71.47
6076.0,71.47
18490.0,71.19
20767.0,71.19
147.0,71.19
10837.0,70.78
130.0,70.78
5914.0,70.78
6144.0,70.78
88.0,70.23
6255.0,70.23
27.0,70.23
6336.0,70.23
5921.0,69.68
19879.0,69.68
15877.0,69.41
21057.0,69.41
148.0,69.14
32704.0,69.14
5951.0,69.14
6062.0,69.14
4915.0,68.59
6133.0,68.59
6250.0,68.59
6143.0,68.59
49.0,68.59
6173.0,67.9
75.0,67.76
19614.0,67.76
18781.0,67.49
4848.0,67.49
6237.0,67.49
19760.0,67.49
5930.0,66.94
6302.0,66.94
13496.0,66.94
12820.0,66.94
4920.0,66.39
6115.0,66.26
22425.0,66.26
73.0,66.26
22096.0,65.84
6337.0,65.84
6265.0,65.84
19295.0,65.43
18347.0,65.43
6343.0,65.43
6207.0,65.43
18350.0,65.43
6064.0,64.75
18622.0,64.75
141.0,64.75
6181.0,64.75
6148.0,64.75
10977.0,64.75
6045.0,63.92
6298.0,63.92
6145.0,63.92
22.0,63.92
12132.0,63.92
4918.0,63.92
17671.0,63.1
5906.0,63.1
35.0,62.83
5911.0,62.83
6340.0,62.83
21292.0,62.41
19250.0,62.41
19294.0,62.41
163.0,62.0
82.0,62.0
13498.0,62.0
4925.0,62.0
109.0,62.0
6319.0,62.0
33191.0,61.18
10365.0,61.18
6366.0,60.91
4898.0,60.91
4894.0,60.63
12027.0,60.63
5963.0,60.63
6260.0,60.63
4917.0,60.63
7425.0,60.63
20817.0,60.63
16119.0,59.67
5999.0,59.67
5907.0,59.4
18784.0,59.4
65.0,59.12
5898.0,59.12
6220.0,59.12
19296.0,59.12
6264.0,59.12
6051.0,59.12
5918.0,58.3
5895.0,58.3
12602.0,58.02
5901.0,58.02
34.0,57.75
10988.0,57.61
116.0,57.61
4866.0,57.61
6095.0,57.61
6229.0,57.61
13421.0,57.61
102.0,56.79
4919.0,56.65
20814.0,56.65
4904.0,56.65
7527.0,56.24
12026.0,56.24
4924.0,55.97
21061.0,55.97
20963.0,55.69
6323.0,55.69
5944.0,55.69
14.0,55.69
6221.0,55.14
99.0,55.14
6210.0,55.14
139.0,55.14
74.0,55.14
19603.0,54.46
5924.0,54.46
126.0,54.46
5920.0,54.46
7529.0,54.46
95.0,53.77
21059.0,53.77
162.0,53.5
41.0,53.5
10972.0,53.5
5942.0,53.09
22413.0,53.09
7540.0,52.81
5896.0,52.81
22424.0,52.54
26.0,52.54
19338.0,52.54
4847.0,52.54
19578.0,52.54
6263.0,51.85
12490.0,51.71
22428.0,51.71
21237.0,51.71
10980.0,51.71
5984.0,51.71
6267.0,51.03
6235.0,51.03
45.0,51.03
18620.0,51.03
12025.0,50.48
43.0,50.34
119.0,50.34
6266.0,50.07
4859.0,50.07
6077.0,49.79
21058.0,49.79
155.0,49.52
4857.0,49.52
12031.0,49.52
10978.0,49.11
22419.0,49.11
107.0,49.11
5913.0,49.11
32703.0,48.56
19619.0,48.42
19627.0,48.42
17318.0,48.15
21060.0,48.01
5961.0,48.01
5910.0,48.01
18997.0,47.6
5957.0,47.6
83.0,47.6
19592.0,47.19
160.0,47.05
6142.0,47.05
87.0,46.78
22423.

2025-01-20 19:09:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:09:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:09:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:10:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:10:00 - snowflake.connector.connection - INFO - closed
2025-01-20 19:10:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:10:00 - root - INFO - SQL:
SELECT im."interest_id", im."month_year", im."composition", m."interest_name"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
JOIN BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP m
ON im."interest_id" = m."id"
LIMIT 1000
Results:
Too long, hard cut:
interest_id,month_year,composition,interest_name
32486.0,07-2018,11.89,Vacation Rental Accommodation Researchers
6106.0,07-2018,9.93,Luxury Second Home Owners
18923.0,07-2018,10.85,Online Home Decor Shoppers
6344.0,07-2018,10.32,Hair Care Shoppers
100.0,07-2018,10.77,Nutrition Conscious Eaters
69.0,07-2018,10.82,Healthy Eaters
79.0,07-2018,11.21,Luxury Travel Researchers
6111.0,07-2018,10.71,Wine Lovers
6214.0,07-2018,9.71,Home Remodelers
19422.0,07-2018,10.11,Home Design and Living Publication Readers
6110.0,07-2018,11.57,Apartment Furniture Shoppers
4895.0,07-2018,9.47,Mature Parents
6217.0,07-2018,10.8,Weight Loss Researchers
4.0,07-2018,13.97,Luxury Retail Researchers
6218.0,07-2018,9.29,Running Enthusiasts
6123.0,07-2018,9.49,Misc-Deal Seekers or Coupon Shoppers
171.0,07-2018,14.91,Shoe Shoppers
19613.0,07-2018,12.62,Land Rover Shoppers
17.0,07-2018,7.89,MLB Fans
6.0,07-2018,11.99,Vacation Planners
6013.0,07-2018,9.35,Competitive Sports Participants
4870.0,07-2018,10.29,Tech-Savvy Moms
19423.0,07-2018,12.22,Kitchen Appliance Shoppers
6089.0,07-2018,6.97,Mens Fitness Publication Readers
161.0,07-2018,11.48,Travel Reward Points Enthusiasts
6286.0,07-2018,14.1,Luxury Hotel Guests
5991.0,07-2018,11.04,Gluten-Free Recipe Researchers
92.0,07-2018,9.77,Parents with Kids
6184.0,07-2018,13.35,Reusable Drinkware Shoppers
19621.0,07-2018,11.61,Portugal Trip Planners
63.0,07-2018,9.37,New & Expecting Parents
103.0,07-2018,6.61,Live Concert Fans
38.0,07-2018,9.48,Sporting Goods Shoppers
17786.0,07-2018,13.67,Womens Fashion Brands Shoppers
6232.0,07-2018,9.97,Golf Enthusiasts
165.0,07-2018,6.05,Liberal News Readers
18351.0,07-2018,6.09,Drama Show Watchers
15.0,07-2018,6.9,NBA Fans
17314.0,07-2018,10.43,Lobbyists
6151.0,07-2018,6.83,Wedding Registrants
4914.0,07-2018,7.42,Mens Health Researchers
115.0,07-2018,11.68,Mens Shoe Shoppers
5968.0,07-2018,12.87,Luxury Kitchen Goods Shoppers
36.0,07-2018,9.27,Baby Products Buyers
5943.0,07-2018,6.37,Financial News Readers
133.0,07-2018,10.91,High End Camera Shoppers - Dupe
1.0,07-2018,7.02,Fitness Enthusiasts
114.0,07-2018,6.25,Womens Fashion Magazine Readers
6107.0,07-2018,8.84,Ski House Second Home Owners
150.0,07-2018,5.3,TV Junkies
60.0,07-2018,6.71,Online Health Researchers
96.0,07-2018,7.21,Exercise and Gym Researchers
22403.0,07-2018,12.27,Pandora Jewelry Shoppers
40.0,07-2018,10.86,Bed & Bath Shoppers
19758.0,07-2018,6.28,Dog Lovers
17730.0,07-2018,11.38,Luxury Department Store Shoppers
5938.0,07-2018,11.63,Costa Rica Trip Planners
4869.0,07-2018,6.47,Womens Fitness Enthusiasts
4897.0,07-2018,12.93,Parents of Teenagers Going to College
6029.0,07-2018,8.72,Indoor Cycling & Spinning Enthusiasts
31.0,07-2018,7.9,Home Decor Shoppers
16137.0,07-2018,9.65,Olympics Fans
6330.0,07-2018,6.82,Pet Store Goers
6334.0,07-2018,11.63,Supermarket Shoppers
6315.0,07-2018,8.14,Boston Trip Planners
4852.0,07-2018,6.77,Health & Fitness
16.0,07-2018,6.24,NCAA Fans
6108.0,07-2018,6.65,Beach House Second Home Owners
6206.0,07-2018,10.76,Preppy Clothing Shoppers
6006.0,07-2018,6.26,Breast Cancer Fund Raisers
6228.0,07-2018,10.22,Paleo Eaters
20768.0,07-2018,6.53,Beer Aficionados
4902.0,07-2018,8.17,Yogis
6277.0,07-2018,11.72,Harry Potter Fans
19757.0,07-2018,10.95,Natural Pet Food Shoppers
4911.0,07-2018,6.87,Dieters
4910.0,07-2018,6.09,Cholesterol Researchers
6285.0,07-2018,9.97,Competitive Tri-Athletes
11974.0,07-2018,7.19,Price Conscious Home Shoppers
6219.0,07-2018,6.37,Cycling Enthusiasts
10250.0,07-2018,11.4,Halloween Costume Shoppers
6128.0,07-2018,6.28,Realtors & Real Estate Researchers
5946.0,07-2018,5.99,Readers of Filipinos Content
158.0,07-2018,7.46,Flight and Hotel Shoppers
15935.0,07-2018,9.13,Pregnancy Resources Researchers
4855.0,07-2018,5.99,Entertainment & Tabloid Magazine Readers
149.0,07-2018,6.88,Streaming Radio Listeners
16197.0,07-2018,6.13,Financial Business Intelligence Researchers
11067.0,07-2018,5.14,NCAA Football Fans
17674.0,07-2018,6.25,Medical Advice Researchers
4913.0,07-2018,6.76,Womens Health Researchers
56.0,07-2018,7.09,Discount Device Shoppers
6341.0,07-2018,5.68,Pharmacy Shoppers
6316.0,07-2018,6.52,Philadelphia Trip Planners
18647.0,07-2018,6.45,Gourmet Food & Wine Researchers
17803.0,07-2018,6.21,TV Advertising Professionals
23.0,07-2018,5.41,Techies
132.0,07-2018,7.48,Apple Fans
6365.0,07-2018,6.45,Executive and C-Suite
6378.0,07-2018,9.64,Luggage Shoppers
17673.0,07-2018,8.07,Coffee Chain Shoppers
97.0,07-2018,6.41,Home Kitchen Chefs
7537.0,07-2018,7.82,Ecommerce Platform Researchers
20764.0,07-2018,5.85,Entertainment Industry Decision Makers
44.0,07-2018,6.11,Home Buyers
5.0,07-2018,10.82,Brides & Wedding Planners
6227.0,07-2018,6.07,Personal Stock Portfolio Managers
19.0,07-2018,6.57,Eco-Conscious Consumers
93.0,07-2018,7.08,Young Boomers
6085.0,07-2018,7.08,Discount Womens Shoes Shoppers
6112.0,07-2018,9.22,Olympic Sports Enthusiasts
4873.0,07-2018,5.45,TV Game Show Fans
11975.0,07-2018,7.81,Landscape Architects
22502.0,07-2018,8.24,Lacrosse Enth

2025-01-20 19:10:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:10:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:10:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:10:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:10:02 - snowflake.connector.connection - INFO - closed
2025-01-20 19:10:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:10:02 - root - INFO - SQL:
SELECT DISTINCT "interest_name", "id"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP
LIMIT 1000
Results:
Too long, hard cut:
interest_name,id
Fitness Enthusiasts,1
Gamers,2
Car Enthusiasts,3
Luxury Retail Researchers,4
Brides & Wedding Planners,5
Vacation Planners,6
Business News Readers,8
Thrift Store Shoppers,12
Advertising Professionals,13
NCAA Fans,16
Nascar Fans,18
Moviegoers,20
DIYers,21
Grill Masters,22
Techies,23
Home Design Enthusiasts,24
Streaming Video Fans,26
College Students,29
Kids Clothing Shoppers,33
Teen Girl Clothing Shoppers,34
Mens Clothing Shoppers,35
Sporting Goods Shoppers,38
Furniture Shoppers,39
Fast Fashion Shoppers,42
Home Buyers,44
Job Seekers,46
NHL Fans,49
Hip Hop Fans,53
Seasonal Allergy Sufferers,55
Online Health Researchers,60
Nurses,72
Online Movie Downloaders,85
Coupon Researchers,90
Home Kitchen Chefs,97
Flower & Gift Basket Shoppers,101
Aftermarket Accessories Shoppers,129
Home Printer Shoppers,134
Major Appliance Shoppers,135
Tablet Researchers,136
Property Insurance Researchers,145
Audio Equipment Researchers,146
Broadway Fans,147
Sightseeing Travelers,160
Tech-Savvy Moms,4870
MLB Fans,17
Department Store Shoppers,30
Discount Big Box Shoppers,50
High-End Kids Furniture and Clothes Shoppers,64
Lawyers,67
Democrats,80
Travel Researchers,89
Live Concert Fans,103
Retirement Planners,111
Automotive Safety Researchers,130
Apple Fans,132
Flight and Hotel Shoppers,158
Retirees,162
Entertainment & Tabloid Magazine Readers,4855
Streaming Music Enthusiasts,4896
Mens Health Researchers,4914
Food Allergies Researchers,4915
Online Auto Shoppers,5967
Mature Parents,4895
Cardio Health Researchers,5895
NFL Fans,14
Eco-Conscious Consumers,19
Doctors,25
Apartment Hunters,43
Moving Services Shoppers,45
Budget Wireless Shoppers,58
Beauty & Skincare Buyers,61
Hands-On Parents,65
Lawn & Garden Enthusiasts,71
Contractors & Construction Professionals,78
Nutrition Conscious Eaters,100
Mens Shoe Shoppers,115
High End Camera Shoppers - Dupe,133
Skin Care Researchers,141
Streaming Radio Listeners,149
Shoe Shoppers,171
Back Pain Sufferers,4908
Marijuana Prohibition Advocates,4932
Motorcycle Enthusiasts,7
NBA Fans,15
Baby Products Buyers,36
Black Friday Deal Shoppers,51
Mobile Phone Comparison Shoppers,57
Menopause Researchers,59
Streaming Device Shoppers,62
New & Expecting Parents,63
Drug Store Shoppers,70
Luxury Retail Shoppers,77
Luxury Travel Researchers,79
Republicans,81
HDTV Researchers,82
Reggaeton Fans,84
Ski and Snowboard Enthusiasts,88
Day Care Users,94
Exercise and Gym Researchers,96
Restaurant Researchers,98
Order-in Eaters,99
Plus Size Women,102
Cruise Travel Intenders,107
Womens Fashion Magazine Readers,114
Mortgage Researchers,119
Military Servicemembers & Veterans,123
Healthcare Discount Shoppers,124
Soccer Fans,126
Kitchen & Bathroom Remodelers,128
Online Alcohol Shoppers,137
Home Kitchen Bakers,138
Pet Owners,140
Credit Card Researchers,142
Federal Employees,163
Social Liberals,169
Health & Fitness,4852
Business Accounting Software Researchers,4857
Adult Acne Sufferers,4904
Womens Health Researchers,4913
Arthritis Sufferers,4916
Tire Shoppers,4921
Gun Control Advocates,4925
Conservative Think Tank Readers,4935
Orthopedic Health Researchers,5896
Oncology Researchers,5898
Parents of High School Students,5945
Auto Insurance Shoppers,27
Jewelry & Watch Shoppers,37
Bed & Bath Shoppers,40
Online Investors,54
Discount Device Shoppers,56
Fantasy & Comic Fans,66
Healthy Eaters,69
Hardware Shoppers,83
Sale Seekers,86
Theme Park Researchers,87
Parents with Kids,92
Stay-at-Home Parents,95
Android Fans,131
Health Insurance Researchers,143
Travel Reward Points Enthusiasts,161
Doves,166
Voters,170
Working Parents,4848
Credit Union Researchers,4894
Heartburn Sufferers,4905
Sinus Researchers,4906
First Aid Researchers,4909
Surfers,4924
Marijuana Legalization Advocates,4931
Pre-Measured Grocery Shoppers,4944
Diabetes,5901
Credit Score Researchers,5911
Business Decision Makers,5920
Tax Filers,5930
Australia Trip Planners,5952
New Homeowners,5962
Readers of Arabic Content,5971
Financial Investors,5972
Readers of African American Content,5999
Readers of Tamil Content,6047
Italian Chain Restaurant Eaters,6062
Solar Energy Solution Shoppers,6064
Media Buying Professionals,6084
Whiskey Lovers,6088
Readers of Cuban Content,6122
Misc-Deal Seekers or Coupon Shoppers,6123
Fantasy Football Enthusiasts,6133
Fast Food Lovers,6145
Christmas Enthusiasts,6168
High-End Camera Shoppers,6171
Finance Continuing Education Researchers,6182
High End TV Shoppers,6188
Divorcees,6226
Yachting Enthusiasts,6234
Environmental Activists,6255
Word Game Enthusiasts,6259
Blockbuster Movie Fans,6260
Competitive Tri-Athletes,6285
Atlanta Trip Planners,6303
Miami Trip Planners,6320
Supermarket Shoppers,6334
Executive and C-Suite,6365
Readers of South American Content,7598
Seattle Seahawks Fans,10869
Halloween Thrill Seekers,10972
Civil Engineers,11977
Alzheimer and Dementia Researchers,19297
France Trip Planners,19603
Postal Employees,125
Teachers,28
Home Decor Shoppers,31
Intimates Shoppers,41
Charitable Donors,48
Ink & Toner Shoppers,75
Young Boomers,93
J

2025-01-20 19:10:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:10:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:10:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:10:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 19:10:03 - snowflake.connector.connection - INFO - closed
2025-01-20 19:10:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:10:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 19:10:33 - root - INFO - ```sql
SELECT "interest_id", "composition"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
WHERE "composition" < 5
LIMIT 1000;
```
2025-01-20 19:10:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:10:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:10:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:10:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:10:35 - snowflake.connector.connection - INFO - closed
2025-01-20 19:10:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:11:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 19:11:13 - root - INFO - SQL:
SELECT "interest_id", "composition"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
WHERE "composition" < 5
LIMIT 1000;
Results:
Too long, hard cut:
interest_id,composition
17320.0,3.98
88.0,4.99
6133.0,3.82
33191.0,3.99
20817.0,3.62
20814.0,3.89
14.0,3.53
126.0,3.8
19578.0,4.14
6263.0,4.98
5984.0,4.9
6235.0,4.67
6077.0,4.83
155.0,4.97
19627.0,3.98
17318.0,4.93
83.0,4.04
21236.0,4.04
21238.0,4.92
80.0,4.47
21239.0,3.52
19628.0,4.66
18995.0,4.97
19590.0,4.59
22095.0,4.54
145.0,4.89
19297.0,4.26
10870.0,3.29
6160.0,4.93
18998.0,4.12
6314.0,3.77
20815.0,3.03
6024.0,4.7
6067.0,4.71
17672.0,4.09
6234.0,4.26
7535.0,4.18
5958.0,4.27
157.0,4.94
6177.0,4.41
143.0,4.68
4930.0,4.37
30.0,3.0
19617.0,4.07
5956.0,4.65
4928.0,4.76
59.0,3.97
14901.0,3.75
55.0,4.0
6321.0,4.97
6320.0,4.72
6030.0,3.85
168.0,3.75
134.0,4.54
32485.0,4.31
17271.0,3.74
6209.0,4.45
6169.0,3.8
142.0,4.73
6131.0,2.81
19625.0,4.32
28.0,4.84
6194.0,4.39
19633.0,3.17
10832.0,4.4
19606.0,4.42
6088.0,4.28
19623.0,4.6
11065.0,4.22
18.0,3.18
4916.0,4.29
6331.0,3.49
4936.0,4.54
22426.0,3.78
146.0,3.69
7534.0,4.22
20766.0,4.33
62.0,4.15
5933.0,4.37
5909.0,3.76
22093.0,4.34
10872.0,2.62
124.0,4.46
6393.0,2.91
32701.0,4.23
50.0,3.07
20755.0,4.77
20751.0,3.94
12821.0,4.63
6253.0,4.18
54.0,3.42
14800.0,4.11
5916.0,4.63
21241.0,3.47
6174.0,4.1
81.0,3.31
7464.0,3.52
6212.0,4.13
6300.0,4.91
170.0,4.76
10009.0,4.56
18807.0,4.1
6386.0,3.73
32705.0,4.38
42.0,4.9
6335.0,4.41
4899.0,3.1
108.0,4.24
6168.0,4.35
6222.0,3.49
71.0,3.43
20.0,4.08
6391.0,4.0
6159.0,4.06
6149.0,4.1
19878.0,3.35
7543.0,4.12
10834.0,4.6
22406.0,3.38
7536.0,3.05
10364.0,2.9
6367.0,3.78
129.0,3.62
25.0,4.31
21240.0,3.04
6231.0,4.12
6226.0,3.95
19607.0,3.27
4903.0,3.63
110.0,4.1
6216.0,3.19
17452.0,4.24
20816.0,2.79
5934.0,3.46
7454.0,4.38
4867.0,2.84
10251.0,3.21
20730.0,3.73
6257.0,4.49
7546.0,4.72
18924.0,4.13
5925.0,3.97
4908.0,3.29
19593.0,2.89
5917.0,4.04
6230.0,4.39
19611.0,2.95
22400.0,3.77
4935.0,4.46
6325.0,4.66
6317.0,4.28
5936.0,3.78
18783.0,4.87
7597.0,3.18
17669.0,3.92
7685.0,3.77
7545.0,4.19
15879.0,3.85
4932.0,4.18
6345.0,3.94
4937.0,3.77
4858.0,3.59
17729.0,3.48
4906.0,3.09
10970.0,4.04
5929.0,4.46
22422.0,3.12
19519.0,4.02
6303.0,3.87
22417.0,3.95
10975.0,3.98
22401.0,3.62
6098.0,3.99
118.0,3.83
12032.0,3.77
6385.0,3.26
6124.0,3.51
10836.0,4.18
32702.0,3.56
4933.0,3.46
10973.0,4.06
6215.0,3.21
10871.0,2.94
19612.0,2.57
5967.0,2.57
10974.0,4.46
5897.0,3.72
6010.0,2.76
21326.0,4.3
22421.0,3.2
7483.0,3.4
6156.0,2.99
5945.0,4.87
10249.0,4.48
6188.0,2.85
6387.0,3.89
19520.0,3.64
140.0,3.31
19759.0,3.23
16196.0,3.98
6390.0,3.6
112.0,2.95
7541.0,4.7
7542.0,4.31
6339.0,3.79
78.0,2.69
10010.0,3.25
6122.0,2.85
6049.0,2.54
20754.0,3.09
53.0,3.03
19634.0,2.53
46.0,3.4
17670.0,2.76
6333.0,3.5
19594.0,2.48
6189.0,3.03
4931.0,4.05
7.0,2.64
5922.0,3.13
6008.0,3.22
6389.0,3.39
22092.0,3.78
57.0,2.32
10979.0,3.28
19618.0,3.03
6306.0,3.04
19251.0,3.59
10326.0,3.96
14895.0,2.59
19602.0,2.79
4927.0,3.19
7544.0,3.37
6259.0,2.51
94.0,3.52
166.0,3.01
4929.0,3.33
22420.0,4.37
4896.0,3.09
6034.0,3.25
6224.0,3.68
5926.0,3.48
5971.0,2.5
84.0,3.42
21.0,2.63
19629.0,2.54
4921.0,2.83
22398.0,3.52
5962.0,3.13
19624.0,2.84
6120.0,2.79
18203.0,2.9
22091.0,3.99
19622.0,2.97
19605.0,3.15
6138.0,2.83
6225.0,3.31
72.0,3.63
123.0,2.83
19609.0,2.43
6223.0,3.45
4926.0,2.92
136.0,2.03
6332.0,2.62
14801.0,2.66
15883.0,1.97
21249.0,3.11
19601.0,2.13
21248.0,2.88
6236.0,2.29
11066.0,3.5
22415.0,3.1
21243.0,2.53
10366.0,2.36
22094.0,2.97
21247.0,2.65
121.0,2.44
19608.0,2.15
10955.0,2.94
19615.0,2.01
5904.0,2.14
5900.0,2.3
58.0,2.18
10007.0,2.45
21251.0,2.85
15884.0,1.82
154.0,2.61
19620.0,2.37
106.0,1.83
6048.0,2.49
10971.0,2.67
7598.0,2.61
19626.0,1.99
17274.0,1.86
19589.0,2.34
13428.0,2.23
11977.0,2.27
19631.0,2.15
20752.0,2.22
19597.0,2.45
19591.0,1.9
19635.0,2.05
19632.0,1.96
19599.0,1.92
6364.0,2.91
22408.0,2.12
16198.0,1.74
6047.0,2.04
10954.0,1.88
51.0,2.67
18348.0,2.05
10953.0,1.81
2.0,1.81
19616.0,2.31
15878.0,2.28
21250.0,2.25
4872.0,2.27
15882.0,1.73
19596.0,2.09
21246.0,2.26
6363.0,2.16
21244.0,2.23
6065.0,1.71
6050.0,1.77
16.0,4.65
34465.0,3.34
17.0,3.94
17320.0,3.24
11067.0,4.92
79.0,4.49
34463.0,3.06
4902.0,4.9
31.0,4.68
18923.0,4.0
6315.0,4.36
4914.0,3.73
7537.0,4.91
34464.0,3.0
88.0,3.94
49.0,4.11
33959.0,2.54
34469.0,4.54
33971.0,4.92
98.0,4.79
6051.0,4.41
11975.0,4.73
6250.0,4.03
4924.0,4.62
35.0,4.14
6143.0,4.12
33474.0,4.01
18648.0,4.21
33191.0,3.76
17673.0,4.88
34462.0,2.73
6108.0,3.45
100.0,3.59
21238.0,4.94
5963.0,3.98
6323.0,4.9
34082.0,3.45
69.0,3.5
6133.0,2.88
96.0,3.39
6263.0,4.31
34574.0,2.99
1.0,3.44
56.0,4.1
6085.0,4.09
5952.0,4.31
33960.0,2.68
5910.0,4.87
6111.0,4.11
132.0,4.04
33967.0,2.85
126.0,4.02
6235.0,3.81
6106.0,2.93
18995.0,4.93
5991.0,4.24
37.0,4.51
130.0,4.7
11974.0,3.7
6255.0,4.61
6089.0,2.63
83.0,3.57
138.0,4.14
60.0,3.93
4911.0,3.47
101.0,4.1
18621.0,4.37
20817.0,2.56
155.0,4.2
19578.0,3.18
4852.0,3.22
17318.0,4.34
6393.0,3.17
103.0,2.69
22095.0,3.84
6217.0,4.2
80.0,3.76
20767.0,4.69
6077.0,3.67
34461.0,3.31
18997.0,4.91
161.0,4.31
4912.0,4.61
21236.0,4.47
34466.0,2.41
33963.0,2.38
4928.0,4.39
14901.0,3.51
33969.0,2.59
6151.0,2

2025-01-20 19:11:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:11:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:11:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:11:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:11:14 - snowflake.connector.connection - INFO - closed
2025-01-20 19:11:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:11:15 - root - INFO - SQL:
SELECT "interest_id", "composition"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
ORDER BY "composition" DESC
LIMIT 1000
Results:
Too long, hard cut:
interest_id,composition
21057.0,21.2
21057.0,20.28
21057.0,19.45
21057.0,18.99
6284.0,18.82
21057.0,18.39
21057.0,18.18
39.0,17.44
77.0,17.19
12133.0,15.15
5969.0,15.05
5969.0,14.92
5969.0,14.92
171.0,14.91
5969.0,14.39
5969.0,14.29
4898.0,14.23
5969.0,14.15
6286.0,14.1
4.0,13.97
6284.0,13.9
12133.0,13.81
17786.0,13.67
12133.0,13.64
6184.0,13.35
19298.0,13.03
4897.0,12.93
5968.0,12.87
19298.0,12.85
12133.0,12.8
77.0,12.73
12133.0,12.68
6284.0,12.64
12133.0,12.64
19298.0,12.62
19613.0,12.62
6.0,12.56
6286.0,12.47
21057.0,12.42
64.0,12.41
6286.0,12.41
64.0,12.33
5969.0,12.3
22403.0,12.27
12133.0,12.26
19423.0,12.22
10977.0,12.16
39.0,12.03
6.0,11.99
158.0,11.97
64.0,11.93
19298.0,11.93
32486.0,11.89
64.0,11.75
77.0,11.74
19298.0,11.74
77.0,11.73
6277.0,11.72
19298.0,11.71
115.0,11.68
5938.0,11.63
6334.0,11.63
19621.0,11.61
6110.0,11.57
10977.0,11.57
6286.0,11.5
161.0,11.48
10250.0,11.4
17730.0,11.38
19298.0,11.27
34.0,11.23
79.0,11.21
6286.0,11.18
5969.0,11.15
6286.0,11.14
39.0,11.1
6.0,11.08
6284.0,11.06
6284.0,11.06
5991.0,11.04
6.0,11.03
5969.0,11.01
19621.0,11.0
6286.0,10.99
64.0,10.99
10977.0,10.96
19757.0,10.95
21057.0,10.95
6284.0,10.91
133.0,10.91
10250.0,10.89
10977.0,10.88
40.0,10.86
18923.0,10.85
5969.0,10.85
69.0,10.82
5.0,10.82
6217.0,10.8
12133.0,10.79
100.0,10.77
6206.0,10.76
6111.0,10.71
4943.0,10.7
64.0,10.69
10981.0,10.62
6284.0,10.61
5960.0,10.61
10977.0,10.61
6.0,10.57
6343.0,10.54
10977.0,10.52
5960.0,10.52
12133.0,10.51
10977.0,10.5
6343.0,10.48
41548.0,10.46
6284.0,10.43
17314.0,10.43
77.0,10.42
5960.0,10.4
6343.0,10.38
21237.0,10.36
6344.0,10.32
19621.0,10.31
6324.0,10.3
4870.0,10.29
77.0,10.28
19298.0,10.27
12133.0,10.26
5944.0,10.24
158.0,10.23
6228.0,10.22
6343.0,10.15
89.0,10.14
6286.0,10.12
19422.0,10.11
10981.0,10.09
39.0,10.08
34.0,10.07
10250.0,10.06
39.0,10.05
6029.0,10.05
34.0,10.04
19621.0,10.0
82.0,9.99
77.0,9.99
7541.0,9.98
6232.0,9.97
4943.0,9.97
6285.0,9.97
6343.0,9.96
10977.0,9.95
6106.0,9.93
39.0,9.93
4943.0,9.91
10981.0,9.91
7541.0,9.88
19621.0,9.86
41548.0,9.85
10981.0,9.85
18783.0,9.83
5960.0,9.82
6343.0,9.81
6.0,9.79
92.0,9.77
77.0,9.76
21237.0,9.72
6214.0,9.71
64.0,9.7
6208.0,9.67
,9.66
16137.0,9.65
39.0,9.65
10981.0,9.65
6378.0,9.64
4943.0,9.63
7541.0,9.62
77.0,9.61
18783.0,9.6
7541.0,9.6
158.0,9.57
64.0,9.57
5960.0,9.55
158.0,9.51
6123.0,9.49
6.0,9.48
38.0,9.48
4895.0,9.47
10008.0,9.46
5960.0,9.46
4944.0,9.46
141.0,9.46
6284.0,9.43
19298.0,9.43
39.0,9.43
63.0,9.37
6013.0,9.35
34.0,9.34
6308.0,9.33
10250.0,9.33
6343.0,9.31
19621.0,9.31
7541.0,9.3
10250.0,9.3
6218.0,9.29
36.0,9.27
6284.0,9.25
6.0,9.25
34.0,9.24
39.0,9.23
,9.23
7541.0,9.23
6112.0,9.22
5970.0,9.21
21237.0,9.2
19621.0,9.19
6343.0,9.18
10250.0,9.18
18619.0,9.15
15935.0,9.13
141.0,9.13
115.0,9.12
6286.0,9.11
41548.0,9.1
6286.0,9.1
19621.0,9.08
34.0,9.08
19298.0,9.06
141.0,9.06
10981.0,9.06
18783.0,9.04
18783.0,9.04
13497.0,9.03
115.0,8.98
4944.0,8.98
21061.0,8.97
4943.0,8.96
141.0,8.96
10009.0,8.95
7541.0,8.94
4944.0,8.91
10250.0,8.9
18783.0,8.87
10250.0,8.85
158.0,8.84
6107.0,8.84
6206.0,8.82
4943.0,8.81
16138.0,8.81
64.0,8.8
10981.0,8.77
6029.0,8.72
5960.0,8.7
21237.0,8.69
5911.0,8.69
89.0,8.67
21237.0,8.66
60.0,8.66
15879.0,8.65
17269.0,8.64
,8.62
,8.62
5944.0,8.59
,8.59
21060.0,8.58
30.0,8.56
89.0,8.55
7425.0,8.54
18783.0,8.51
41548.0,8.5
6336.0,8.5
21058.0,8.5
141.0,8.49
34.0,8.48
89.0,8.48
13497.0,8.47
21061.0,8.46
77.0,8.46
5944.0,8.46
12025.0,8.45
158.0,8.45
19295.0,8.44
12025.0,8.44
4944.0,8.44
7541.0,8.43
6324.0,8.43
158.0,8.43
6285.0,8.41
64.0,8.41
4943.0,8.38
5944.0,8.37
10981.0,8.36
6206.0,8.35
4944.0,8.32
12027.0,8.32
107.0,8.32
141.0,8.31
6304.0,8.31
13497.0,8.31
10977.0,8.3
4943.0,8.29
6285.0,8.29
18783.0,8.28
4944.0,8.28
5944.0,8.28
89.0,8.27
34.0,8.26
,8.25
5970.0,8.25
4944.0,8.25
22502.0,8.24
18202.0,8.23
89.0,8.23
21237.0,8.22
,8.21
6171.0,8.19
4902.0,8.17
39.0,8.17
7557.0,8.17
10988.0,8.17
10976.0,8.16
6343.0,8.15
6315.0,8.14
19621.0,8.14
5944.0,8.12
13497.0,8.12
13497.0,8.1
13497.0,8.1
19617.0,8.09
6211.0,8.09
17673.0,8.07
32704.0,8.04
22427.0,8.04
21060.0,8.02
6023.0,8.02
12025.0,7.99
4898.0,7.98
151.0,7.97
21061.0,7.95
137.0,7.94
4.0,7.94
11067.0,7.93
16119.0,7.93
6029.0,7.93
21237.0,7.92
89.0,7.92
6.0,7.9
171.0,7.9
6029.0,7.9
31.0,7.9
5895.0,7.89
17.0,7.89
17786.0,7.88
21060.0,7.88
17674.0,7.88
18783.0,7.87
34.0,7.87
5960.0,7.86
5898.0,7.85
10250.0,7.85
6029.0,7.85
18996.0,7.84
12025.0,7.83
7537.0,7.82
37.0,7.82
11975.0,7.81
6207.0,7.81
21061.0,7.81
7540.0,7.8
18347.0,7.8
141.0,7.8
,7.79
4912.0,7.77
141.0,7.77
19623.0,7.76
102.0,7.74
7425.0,7.74
7685.0,7.74
20767.0,7.73
,7.73
5970.0,7.73
5909.0,7.73
,7.72
22502.0,7.72
19250.0,7.7
6237.0,7.7
6264.0,7.7
21060.0,7.69
5960.0,7.69
5906.0,7.69
4944.0,7.68
19338.0,7.68
6029.0,7.68
4943.0,7.68
55.0,7.67
6308.0,7.67
5925.0,7.67
130.0,7.66
11067.0,7.66
6173.0,7.66
17785.0,7.66
7425.0,7.65
12025.0,7.64
5970.0,7.64
6217.0,7.64
98.0,7.64
21061.0,7.63
6329.0,7.63
18202.0,7.61
18202.0,7.6
6237.0,7.6
33.0,7.6
6220.0,7.59
13497.0,7.56
6285.0,7.

2025-01-20 19:11:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:11:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:11:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:11:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 19:11:16 - snowflake.connector.connection - INFO - closed
2025-01-20 19:11:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:11:17 - root - INFO - SQL:
SELECT im."interest_id", m."interest_name", im."percentile_ranking"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
JOIN BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP m
ON im."interest_id" = m."id"
LIMIT 1000
Results:
Too long, hard cut:
interest_id,interest_name,percentile_ranking
32486.0,Vacation Rental Accommodation Researchers,99.86
6106.0,Luxury Second Home Owners,99.73
18923.0,Online Home Decor Shoppers,99.59
6344.0,Hair Care Shoppers,99.45
100.0,Nutrition Conscious Eaters,99.31
69.0,Healthy Eaters,99.18
79.0,Luxury Travel Researchers,99.04
6111.0,Wine Lovers,98.9
6214.0,Home Remodelers,98.9
19422.0,Home Design and Living Publication Readers,98.63
6110.0,Apartment Furniture Shoppers,98.49
4895.0,Mature Parents,98.35
6217.0,Weight Loss Researchers,98.22
4.0,Luxury Retail Researchers,98.08
6218.0,Running Enthusiasts,97.94
6123.0,Misc-Deal Seekers or Coupon Shoppers,97.81
171.0,Shoe Shoppers,97.67
19613.0,Land Rover Shoppers,97.53
17.0,MLB Fans,97.39
6.0,Vacation Planners,97.26
6013.0,Competitive Sports Participants,97.12
4870.0,Tech-Savvy Moms,96.98
19423.0,Kitchen Appliance Shoppers,96.84
6089.0,Mens Fitness Publication Readers,96.71
161.0,Travel Reward Points Enthusiasts,96.57
6286.0,Luxury Hotel Guests,96.57
5991.0,Gluten-Free Recipe Researchers,96.3
92.0,Parents with Kids,96.16
6184.0,Reusable Drinkware Shoppers,96.02
19621.0,Portugal Trip Planners,95.88
63.0,New & Expecting Parents,95.75
103.0,Live Concert Fans,95.61
38.0,Sporting Goods Shoppers,95.47
17786.0,Womens Fashion Brands Shoppers,95.34
6232.0,Golf Enthusiasts,95.2
165.0,Liberal News Readers,95.06
18351.0,Drama Show Watchers,94.92
15.0,NBA Fans,94.79
17314.0,Lobbyists,94.65
6151.0,Wedding Registrants,94.65
4914.0,Mens Health Researchers,94.65
115.0,Mens Shoe Shoppers,94.24
5968.0,Luxury Kitchen Goods Shoppers,94.24
36.0,Baby Products Buyers,93.96
5943.0,Financial News Readers,93.83
133.0,High End Camera Shoppers - Dupe,93.69
1.0,Fitness Enthusiasts,93.69
114.0,Womens Fashion Magazine Readers,93.42
6107.0,Ski House Second Home Owners,93.28
150.0,TV Junkies,93.28
60.0,Online Health Researchers,93.0
96.0,Exercise and Gym Researchers,92.87
22403.0,Pandora Jewelry Shoppers,92.73
40.0,Bed & Bath Shoppers,92.59
19758.0,Dog Lovers,92.59
17730.0,Luxury Department Store Shoppers,92.32
5938.0,Costa Rica Trip Planners,92.18
4869.0,Womens Fitness Enthusiasts,92.18
4897.0,Parents of Teenagers Going to College,91.91
6029.0,Indoor Cycling & Spinning Enthusiasts,91.77
31.0,Home Decor Shoppers,91.77
16137.0,Olympics Fans,91.5
6330.0,Pet Store Goers,91.36
6334.0,Supermarket Shoppers,91.36
6315.0,Boston Trip Planners,91.36
4852.0,Health & Fitness,90.95
16.0,NCAA Fans,90.95
6108.0,Beach House Second Home Owners,90.67
6206.0,Preppy Clothing Shoppers,90.67
6006.0,Breast Cancer Fund Raisers,90.4
6228.0,Paleo Eaters,90.4
20768.0,Beer Aficionados,90.4
4902.0,Yogis,89.99
6277.0,Harry Potter Fans,89.85
19757.0,Natural Pet Food Shoppers,89.71
4911.0,Dieters,89.71
4910.0,Cholesterol Researchers,89.44
6285.0,Competitive Tri-Athletes,89.3
11974.0,Price Conscious Home Shoppers,89.16
6219.0,Cycling Enthusiasts,89.16
10250.0,Halloween Costume Shoppers,88.89
6128.0,Realtors & Real Estate Researchers,88.75
5946.0,Readers of Filipinos Content,88.61
158.0,Flight and Hotel Shoppers,88.61
15935.0,Pregnancy Resources Researchers,88.34
4855.0,Entertainment & Tabloid Magazine Readers,88.2
149.0,Streaming Radio Listeners,88.2
16197.0,Financial Business Intelligence Researchers,87.93
11067.0,NCAA Football Fans,87.79
17674.0,Medical Advice Researchers,87.65
4913.0,Womens Health Researchers,87.65
56.0,Discount Device Shoppers,87.38
6341.0,Pharmacy Shoppers,87.38
6316.0,Philadelphia Trip Planners,87.38
18647.0,Gourmet Food & Wine Researchers,87.38
17803.0,TV Advertising Professionals,87.38
23.0,Techies,86.69
132.0,Apple Fans,86.56
6365.0,Executive and C-Suite,86.56
6378.0,Luggage Shoppers,86.28
17673.0,Coffee Chain Shoppers,86.15
97.0,Home Kitchen Chefs,86.15
7537.0,Ecommerce Platform Researchers,86.15
20764.0,Entertainment Industry Decision Makers,86.15
44.0,Home Buyers,85.6
5.0,Brides & Wedding Planners,85.6
6227.0,Personal Stock Portfolio Managers,85.6
19.0,Eco-Conscious Consumers,85.19
93.0,Young Boomers,85.19
6085.0,Discount Womens Shoes Shoppers,84.91
6112.0,Olympic Sports Enthusiasts,84.77
4873.0,TV Game Show Fans,84.64
11975.0,Landscape Architects,84.5
22502.0,Lacrosse Enthusiasts,84.36
86.0,Sale Seekers,84.36
19610.0,Jaguar Vehicle Shoppers,84.09
20753.0,Tesla Enthusiasts,83.95
24.0,Home Design Enthusiasts,83.95
20750.0,BMW Vehicle Shoppers,83.95
12133.0,Luxury Boutique Hotel Researchers,83.95
6141.0,Entrepreneurs,83.4
6172.0,Camera Review Readers,83.4
98.0,Restaurant Researchers,83.4
125.0,Postal Employees,82.99
17269.0,At-Home Gym Intenders,82.99
4943.0,Online Grocery Shoppers,82.72
18996.0,Investment Banking Professionals,82.72
13.0,Advertising Professionals,82.72
89.0,Travel Researchers,82.72
169.0,Social Liberals,82.17
101.0,Flower & Gift Basket Shoppers,82.17
6087.0,Metal and Rock Music Fans,81.89
104.0,Country Music Fans,81.89
6284.0,Gym Equipment Owners,81.89
7557.0,Tailgaters,81.89
37.0,Jewelry & Watch Shoppers,81.89
6084.0,Media Buying Professionals,81.21
8.0,Business News Readers,81.07
5969.0,Luxury B

2025-01-20 19:11:17 - root - INFO - itercount: 0
2025-01-20 19:11:17 - root - INFO - Database Name: BANK_SALES_TRADING
Schema Name: BANK_SALES_TRADING
DDL describes table information.
,0
table_name,INTEREST_MAP
description,
DDL,"create or replace TABLE INTEREST_MAP (
	""id"" NUMBER(38,0),
	""interest_name"" VARCHAR(16777216),
	""interest_summary"" VARCHAR(16777216),
	""created_at"" VARCHAR(16777216),
	""last_modified"" VARCHAR(16777216)
);"

,1
table_name,INTEREST_METRICS
description,
DDL,"create or replace TABLE INTEREST_METRICS (
	""_month"" FLOAT,
	""_year"" FLOAT,
	""month_year"" VARCHAR(16777216),
	""interest_id"" FLOAT,
	""composition"" FLOAT,
	""index_value"" FLOAT,
	""ranking"" NUMBER(38,0),
	""percentile_ranking"" FLOAT
);"

,2
table_name,BITCOIN_PRICES
description,
DDL,"create or replace TABLE BITCOIN_PRICES (
	""ticker"" VARCHAR(16777216),
	""market_date"" VARCHAR(16777216),
	""price"" FLOAT,
	""open"" FLOAT,
	""high"" FLOAT,
	""low"" FLOAT,
	""volume"" VARCHAR(16777216),
	""change"" VARCHAR(16777216)
);"

,3
table_name,SHOPPING_CART_CAMPAIGN_IDENTIFIER
description,
DDL,"create or replace TABLE SHOPPING_CART_CAMPAIGN_IDENTIFIER (
	""campaign_id"" NUMBER(38,0),
	""products"" VARCHAR(16777216),
	""campaign_name"" VARCHAR(16777216),
	""start_date"" VARCHAR(16777216),
	""end_date"" VARCHAR(16777216)
);"

,4
table_name,SHOPPING_CART_EVENT_IDENTIFIER
description,
DDL,"create or replace TABLE SHOPPING_CART_EVENT_IDENTIFIER (
	""event_type"" NUMBER(38,0),
	""event_name"" VARCHAR(16777216)
);"

,5
table_name,VEG_CAT
description,
DDL,"create or replace TABLE VEG_CAT (
	""index"" NUMBER(38,0),
	""item_code"" NUMBER(38,0),
	""item_name"" VARCHAR(16777216),
	""category_code"" NUMBER(38,0),
	""category_name"" VARCHAR(16777216)
);"

,6
table_name,VEG_WHSLE_DF
description,
DDL,"create or replace TABLE VEG_WHSLE_DF (
	""index"" NUMBER(38,0),
	""whsle_date"" VARCHAR(16777216),
	""item_code"" NUMBER(38,0),
	""whsle_px_rmb-kg"" FLOAT
);"

,7
table_name,BITCOIN_TRANSACTIONS
description,
DDL,"create or replace TABLE BITCOIN_TRANSACTIONS (
	""txn_id"" NUMBER(38,0),
	""member_id"" VARCHAR(16777216),
	""ticker"" VARCHAR(16777216),
	""txn_date"" VARCHAR(16777216),
	""txn_type"" VARCHAR(16777216),
	""quantity"" FLOAT,
	""percentage_fee"" FLOAT,
	""txn_time"" VARCHAR(16777216)
);"

,8
table_name,SHOPPING_CART_EVENTS
description,
DDL,"create or replace TABLE SHOPPING_CART_EVENTS (
	""visit_id"" VARCHAR(16777216),
	""cookie_id"" VARCHAR(16777216),
	""page_id"" NUMBER(38,0),
	""event_type"" NUMBER(38,0),
	""sequence_number"" NUMBER(38,0),
	""event_time"" VARCHAR(16777216)
);"

,9
table_name,VEG_LOSS_RATE_DF
description,
DDL,"create or replace TABLE VEG_LOSS_RATE_DF (
	""index"" NUMBER(38,0),
	""item_code"" NUMBER(38,0),
	""item_name"" VARCHAR(16777216),
	""loss_rate_%"" FLOAT
);"

,10
table_name,CUSTOMER_NODES
description,
DDL,"create or replace TABLE CUSTOMER_NODES (
	""customer_id"" NUMBER(38,0),
	""region_id"" NUMBER(38,0),
	""node_id"" NUMBER(38,0),
	""start_date"" VARCHAR(16777216),
	""end_date"" VARCHAR(16777216)
);"

,11
table_name,WEEKLY_SALES
description,
DDL,"create or replace TABLE WEEKLY_SALES (
	""week_date"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216),
	""segment"" VARCHAR(16777216),
	""customer_type"" VARCHAR(16777216),
	""transactions"" NUMBER(38,0),
	""sales"" NUMBER(38,0)
);"

,12
table_name,BITCOIN_MEMBERS
description,
DDL,"create or replace TABLE BITCOIN_MEMBERS (
	""member_id"" VARCHAR(16777216),
	""first_name"" VARCHAR(16777216),
	""region"" VARCHAR(16777216)
);"

,13
table_name,CLEANED_WEEKLY_SALES
description,
DDL,"create or replace TABLE CLEANED_WEEKLY_SALES (
	""week_date_formatted"" VARCHAR(16777216),
	""week_date"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216),
	""segment"" VARCHAR(16777216),
	""customer_type"" VARCHAR(16777216),
	""transactions"" NUMBER(38,0),
	""sales"" NUMBER(38,0),
	""week_number"" NUMBER(38,0),
	""month_number"" NUMBER(38,0),
	""calendar_year"" NUMBER(38,0),
	""age_band"" VARCHAR(16777216),
	""demographic"" VARCHAR(16777216),
	""avg_transaction"" FLOAT
);"

,14
table_name,CUSTOMER_REGIONS
description,
DDL,"create or replace TABLE CUSTOMER_REGIONS (
	""region_id"" NUMBER(38,0),
	""region_name"" VARCHAR(16777216)
);"

,15
table_name,CUSTOMER_TRANSACTIONS
description,
DDL,"create or replace TABLE CUSTOMER_TRANSACTIONS (
	""customer_id"" NUMBER(38,0),
	""txn_date"" VARCHAR(16777216),
	""txn_type"" VARCHAR(16777216),
	""txn_amount"" NUMBER(38,0)
);"

,16
table_name,SHOPPING_CART_USERS
description,
DDL,"create or replace TABLE SHOPPING_CART_USERS (
	""user_id"" NUMBER(38,0),
	""cookie_id"" VARCHAR(16777216),
	""start_date"" VARCHAR(16777216)
);"

,17
table_name,VEG_TXN_DF
description,
DDL,"create or replace TABLE VEG_TXN_DF (
	""index"" NUMBER(38,0),
	""txn_date"" VARCHAR(16777216),
	""txn_time"" VARCHAR(16777216),
	""item_code"" NUMBER(38,0),
	""qty_sold(kg)"" FLOAT,
	""unit_selling_px_rmb/kg"" FLOAT,
	""sale/return"" VARCHAR(16777216),
	""discount(%)"" NUMBER(38,0),
	""day_of_week"" VARCHAR(16777216)
);"

,18
table_name,SHOPPING_CART_PAGE_HIERARCHY
description,
DDL,"create or replace TABLE SHOPPING_CART_PAGE_HIERARCHY (
	""page_id"" NUMBER(38,0),
	""page_name"" VARCHAR(16777216),
	""product_category"" VARCHAR(16777216),
	""product_id"" FLOAT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'BANK_SALES_TRADING': {'BANK_SALES_TRADING': ['BITCOIN_MEMBERS', 'BITCOIN_PRICES', 'BITCOIN_TRANSACTIONS', 'CLEANED_WEEKLY_SALES', 'CUSTOMER_NODES', 'CUSTOMER_REGIONS', 'CUSTOMER_TRANSACTIONS', 'INTEREST_MAP', 'INTEREST_METRICS', 'SHOPPING_CART_CAMPAIGN_IDENTIFIER', 'SHOPPING_CART_EVENTS', 'SHOPPING_CART_EVENT_IDENTIFIER', 'SHOPPING_CART_PAGE_HIERARCHY', 'SHOPPING_CART_USERS', 'VEG_CAT', 'VEG_LOSS_RATE_DF', 'VEG_TXN_DF', 'VEG_WHSLE_DF', 'WEEKLY_SALES']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **Table:** `BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS`
   - **"interest_id"**: Used to identify each interest category; corresponds to "id" in `INTEREST_MAP` table.
   - **"composition"**: The composition value for an interest category in a given month; used for ranking.
   - **"month_year"**: Indicates the time period (in MM-YYYY format); used to display the time.
   - **"_month"** and **"_year"**: Components of the date; may be used for date-related conditions.
   - **"percentile_ranking"**: May provide additional insights into the ranking of interest categories.

2. **Table:** `BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP`
   - **"id"**: The unique identifier for each interest category; used to join with `INTEREST_METRICS`.
   - **"interest_name"**: The name of the interest category; used to display the interest name.

**Potential Conditions:**

- Joining `INTEREST_METRICS` and `INTEREST_MAP` on `"interest_id" = "id"` to access interest names.
- Filtering records for specific months or years using `"month_year"`.
- Calculating the maximum `"composition"` value for each `"interest_id"`.
- Ordering results based on `"composition"` values to identify top/bottom categories.
- Limiting results to the top 10 and bottom 10 interest categories.

---

**Sample SQL Queries:**

1. **Retrieve distinct interest IDs:**
   ```sql
   SELECT DISTINCT "interest_id"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   LIMIT 1000;
   ```

2. **Fetch interest IDs with their composition values:**
   ```sql
   SELECT "interest_id", "composition"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   LIMIT 1000;
   ```

3. **Get month and year along with composition values:**
   ```sql
   SELECT "month_year", "composition"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   LIMIT 1000;
   ```

4. **List all unique months available:**
   ```sql
   SELECT DISTINCT "month_year"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   LIMIT 1000;
   ```

5. **Retrieve interest IDs and their corresponding names:**
   ```sql
   SELECT "id", "interest_name"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP
   LIMIT 1000;
   ```

6. **Select records with high composition values:**
   ```sql
   SELECT "interest_id", "composition"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   WHERE "composition" > 0.5
   LIMIT 1000;
   ```

7. **Find the maximum composition value for each interest ID:**
   ```sql
   SELECT "interest_id", MAX("composition") AS "max_composition"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   GROUP BY "interest_id"
   LIMIT 1000;
   ```

8. **Get composition values for a specific month (e.g., January 2021):**
   ```sql
   SELECT "interest_id", "month_year", "composition"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   WHERE "month_year" = '01-2021'
   LIMIT 1000;
   ```

9. **Calculate average composition per month:**
   ```sql
   SELECT "month_year", AVG("composition") AS "avg_composition"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   GROUP BY "month_year"
   LIMIT 1000;
   ```

10. **Retrieve percentile rankings for interest categories:**
    ```sql
    SELECT "interest_id", "percentile_ranking"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
    LIMIT 1000;
    ```

11. **Join `INTEREST_METRICS` with `INTEREST_MAP` to get interest names:**
    ```sql
    SELECT im."interest_id", im."month_year", im."composition", m."interest_name"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
    JOIN BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP m
    ON im."interest_id" = m."id"
    LIMIT 1000;
    ```

12. **List all interest names with their IDs:**
    ```sql
    SELECT DISTINCT "interest_name", "id"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP
    LIMIT 1000;
    ```

13. **Select interest categories with composition below a threshold:**
    ```sql
    SELECT "interest_id", "composition"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
    WHERE "composition" < 0.1
    LIMIT 1000;
    ```

14. **Fetch records ordered by composition descending:**
    ```sql
    SELECT "interest_id", "composition"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
    ORDER BY "composition" DESC
    LIMIT 1000;
    ```

15. **Find the interest categories with their percentile rankings:**
    ```sql
    SELECT im."interest_id", m."interest_name", im."percentile_ranking"
    FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
    JOIN BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP m
    ON im."interest_id" = m."id"
    LIMIT 1000;
    ```

---

These queries will help in understanding the values and distribution of data in the relevant columns, which is essential for identifying the top 10 and bottom 10 interest categories based on their highest composition values across all months.Query:
SELECT DISTINCT "interest_id"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   LIMIT 1000;
Answer:
Too long, hard cut:
interest_id
32486.0
6106.0
18923.0
6344.0
100.0
6111.0
19422.0
6110.0
6217.0
171.0
19613.0
17.0
6.0
6013.0
4870.0
19423.0
6089.0
6286.0
19621.0
63.0
165.0
18351.0
""
17314.0
4914.0
6107.0
40.0
5938.0
16137.0
6330.0
6006.0
6228.0
4902.0
97.0
20764.0
5.0
19610.0
4940.0
10838.0
6255.0
69.0
79.0
4895.0
5991.0
114.0
96.0
19758.0
6029.0
6334.0
6315.0
6206.0
20768.0
4855.0
56.0
23.0
98.0
18646.0
6162.0
128.0
6308.0
148.0
18347.0
4910.0
32703.0
6214.0
4.0
6218.0
161.0
92.0
6184.0
6232.0
36.0
150.0
17730.0
4869.0
31.0
19757.0
4911.0
5946.0
6378.0
6172.0
169.0
6299.0
6304.0
6123.0
103.0
38.0
17786.0
15.0
115.0
22403.0
4852.0
6108.0
6219.0
10250.0
149.0
16197.0
11067.0
4913.0
6316.0
17803.0
44.0
19.0
4873.0
86.0
24.0
12133.0
6141.0
4943.0
18996.0
85.0
19587.0
135.0
19588.0
77.0
4944.0
111.0
151.0
7461.0
17785.0
6318.0
7605.0
12.0
70.0
19579.0
18490.0
147.0
6062.0
19760.0
6115.0
6265.0
18350.0
6148.0
6340.0
109.0
12027.0
18784.0
34.0
102.0
6323.0
5896.0
6301.0
22411.0
6321.0
62.0
6222.0
6341.0
17673.0
6112.0
20753.0
125.0
17269.0
6284.0
7557.0
117.0
33.0
17320.0
18202.0
10008.0
10976.0
21242.0
21293.0
6278.0
64.0
88.0
5921.0
21057.0
6133.0
22096.0
18622.0
19294.0
5963.0
10988.0
116.0
21061.0
5984.0
45.0
21058.0
4857.0
6024.0
157.0
143.0
14901.0
6320.0
19604.0
7536.0
16196.0
18203.0
38360.0
36864.0
37876.0
10954.0
133.0
11974.0
15935.0
18647.0
5968.0
5943.0
16.0
6277.0
6285.0
6128.0
17674.0
93.0
22502.0
20750.0
6087.0
104.0
39.0
5952.0
164.0
5989.0
138.0
12277.0
61.0
6211.0
5972.0
6023.0
5960.0
90.0
6144.0
49.0
75.0
18781.0
4848.0
5930.0
13496.0
4920.0
163.0
33191.0
5918.0
13421.0
12025.0
19297.0
10870.0
19606.0
170.0
6151.0
1.0
60.0
158.0
132.0
6365.0
7537.0
6227.0
6085.0
11975.0
13.0
89.0
37.0
6084.0
8.0
4909.0
6127.0
66.0
7453.0
6171.0
131.0
10839.0
67.0
4861.0
19630.0
5970.0
4907.0
20767.0
10837.0
130.0
27.0
19879.0
4915.0
6250.0
6237.0
6302.0
22425.0
6207.0
141.0
6181.0
6298.0
6145.0
22.0
4918.0
17671.0
5906.0
35.0
21292.0
19250.0
82.0
13498.0
4925.0
6319.0
10365.0
6366.0
4898.0
7425.0
16119.0
65.0
5898.0
6051.0
5901.0
4866.0
6095.0
6229.0
20814.0
4904.0
7527.0
20963.0
6221.0
6210.0
139.0
19603.0
126.0
5920.0
7529.0
41.0
10972.0
22424.0
19338.0
19578.0
6263.0
10980.0
6267.0
119.0
4859.0
155.0
12031.0
107.0
17318.0
21060.0
5961.0
18997.0
6142.0
87.0
22423.0
21236.0
21238.0
80.0
6208.0
23778.0
18204.0
19628.0
19590.0
22095.0
145.0
20815.0
6305.0
6328.0
30.0
4928.0
59.0
55.0
18619.0
6030.0
10284.0
6209.0
6169.0
142.0
6194.0
153.0
10832.0
6088.0
11065.0
22093.0
6393.0
50.0
20755.0
12821.0
14800.0
6300.0
10009.0
18807.0
32705.0
6335.0
108.0
6149.0
10364.0
6367.0
4903.0
110.0
20816.0
4867.0
20730.0
7546.0
18924.0
4908.0
19593.0
6230.0
6317.0
5936.0
18783.0
7597.0
7545.0
6345.0
17729.0
4906.0
10970.0
22401.0
10836.0
4933.0
6215.0
6156.0
5945.0
112.0
6339.0
6122.0
19594.0
4931.0
6034.0
22398.0
72.0
19609.0
6332.0
21248.0
58.0
10971.0
7598.0
19626.0
19631.0
6047.0
21244.0
34462.0
34082.0
34461.0
34077.0
34084.0
34079.0
34460.0
33534.0
21245.0
34651.0
34643.0
34647.0
34650.0
34638.0
34646.0
36343.0
37411.0
37423.0
37874.0
37420.0
36876.0
38355.0
37414.0
38362.0
38351.0
37887.0
37166.0
38365.0
37165.0
37878.0
37416.0
38358.0
38989.0
39190.0
39192.0
39770.0
39651.0
39199.0
39659.0
41854.0
41191.0
41192.0
42238.0
42237.0
41554.0
40692.0
40687.0
40427.0
40694.0
42964.0
44470.0
44476.0
44479.0
44456.0
45524.0
44379.0
45669.0
45668.0
46567.0
49979.0
10011.0
22427.0
16138.0
18621.0
6329.0
6076.0
5914.0
6337.0
10977.0
12132.0
5911.0
6260.0
4917.0
5907.0
4924.0
95.0
5942.0
10978.0
19627.0
83.0
17672.0
6234.0
6322.0
28.0
19633.0
5909.0
10872.0
6324.0
6134.0
6253.0
6174.0
6212.0
6391.0
6159.0
19878.0
7543.0
10834.0
25.0
5934.0
6257.0
22400.0
4935.0
5929.0
22417.0
10975.0
6098.0
12032.0
6385.0
6124.0
32702.0
19612.0
10974.0
10010.0
6049.0
19634.0
166.0
5971.0
19624.0
21249.0
6236.0
121.0
10955.0
19615.0
5900.0
21251.0
15884.0
17274.0
11977.0
20752.0
2.0
19596.0
33474.0
34574.0
34088.0
34468.0
33972.0
33962.0
33958.0
35953.0
35169.0
34637.0
34644.0
34649.0
34642.0
37413.0
37877.0
36869.0
38284.0
37418.0
38361.0
37417.0
37412.0
38990.0
40183.0
40685.0
40683.0
39196.0
39649.0
40697.0
40691.0
40688.0
39643.0
40195.0
39547.0
39645.0
39658.0
39331.0
39338.0
39654.0
41856.0
41190.0
41855.0
41078.0
41079.0
41066.0
41059.0
40695.0
40526.0
44453.0
44587.0
45670.0
44473.0
44466.0
44484.0
45519.0
45675.0
45679.0
45673.0
44483.0
44589.0
44471.0
44458.0
44467.0
44384.0
45528.0
43551.0
39655.0
44580.0
42008.0
49972.0
51678.0
49975.0
84.0
13428.0
19635.0
19595.0
35742.0
37875.0
36873.0
36863.0
40525.0
40187.0
40699.0
41067.0
41075.0
43550.0
44486.0
45672.0
14802.0
44459.0
7540.0
12490.0
21237.0
4897.0
101.0
137.0
20731.0
6182.0
3.0
6336.0
15877.0
5951.0
6143.0
6173.0
12820.0
19295.0
6045.0
4894.0
5999.0
6220.0
6264.0
5895.0
5944.0
14.0
99.0
74.0
5924.0
21059.0
162.0
22413.0
26.0
6266.0
5910.0
18352.0
6183.0
6081.0
21239.0
7535.0
5958.0
4930.0
19617.0
5956.0
168.0
134.0
17271.0
18.0
4936.0
32701.0
10833.0
81.0
7464.0
71.0
19607.0
10251.0
4937.0
6303.0
1
Query:
SELECT "interest_id", "composition"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   LIMIT 1000;
Answer:
Too long, hard cut:
interest_id,composition
32486.0,11.89
6106.0,9.93
18923.0,10.85
6344.0,10.32
100.0,10.77
69.0,10.82
79.0,11.21
6111.0,10.71
6214.0,9.71
19422.0,10.11
6110.0,11.57
4895.0,9.47
6217.0,10.8
4.0,13.97
6218.0,9.29
6123.0,9.49
171.0,14.91
19613.0,12.62
17.0,7.89
6.0,11.99
6013.0,9.35
4870.0,10.29
19423.0,12.22
6089.0,6.97
161.0,11.48
6286.0,14.1
5991.0,11.04
92.0,9.77
6184.0,13.35
19621.0,11.61
63.0,9.37
103.0,6.61
38.0,9.48
17786.0,13.67
6232.0,9.97
165.0,6.05
18351.0,6.09
15.0,6.9
,6.12
17314.0,10.43
6151.0,6.83
4914.0,7.42
115.0,11.68
5968.0,12.87
36.0,9.27
5943.0,6.37
133.0,10.91
1.0,7.02
114.0,6.25
6107.0,8.84
150.0,5.3
60.0,6.71
96.0,7.21
22403.0,12.27
40.0,10.86
19758.0,6.28
17730.0,11.38
5938.0,11.63
4869.0,6.47
4897.0,12.93
6029.0,8.72
31.0,7.9
16137.0,9.65
6330.0,6.82
6334.0,11.63
6315.0,8.14
4852.0,6.77
16.0,6.24
6108.0,6.65
6206.0,10.76
6006.0,6.26
6228.0,10.22
20768.0,6.53
4902.0,8.17
6277.0,11.72
19757.0,10.95
4911.0,6.87
,7.13
4910.0,6.09
6285.0,9.97
11974.0,7.19
6219.0,6.37
10250.0,11.4
6128.0,6.28
5946.0,5.99
158.0,7.46
15935.0,9.13
4855.0,5.99
149.0,6.88
16197.0,6.13
11067.0,5.14
17674.0,6.25
4913.0,6.76
56.0,7.09
6341.0,5.68
6316.0,6.52
18647.0,6.45
17803.0,6.21
23.0,5.41
132.0,7.48
6365.0,6.45
6378.0,9.64
17673.0,8.07
97.0,6.41
7537.0,7.82
20764.0,5.85
44.0,6.11
5.0,10.82
6227.0,6.07
19.0,6.57
93.0,7.08
6085.0,7.08
6112.0,9.22
4873.0,5.45
11975.0,7.81
22502.0,8.24
86.0,6.13
19610.0,7.56
20753.0,5.79
24.0,6.54
20750.0,5.87
12133.0,10.79
6141.0,6.34
6172.0,5.88
98.0,7.64
125.0,6.38
17269.0,8.64
4943.0,8.81
18996.0,7.84
13.0,6.72
89.0,8.48
169.0,6.1
101.0,7.38
6087.0,5.41
104.0,5.42
6284.0,18.82
7557.0,8.17
37.0,7.82
6084.0,6.97
8.0,6.67
5969.0,11.15
39.0,17.44
117.0,6.49
19298.0,10.27
22427.0,8.04
85.0,6.46
5952.0,7.11
164.0,6.14
19587.0,5.85
33.0,7.6
135.0,7.01
19588.0,5.87
17320.0,3.98
77.0,17.19
18648.0,7.1
5989.0,5.57
138.0,7.3
18202.0,7.61
137.0,7.94
4940.0,5.89
12277.0,6.2
4909.0,7.01
4944.0,8.32
10008.0,9.46
6299.0,5.71
20731.0,5.86
10838.0,6.8
111.0,7.42
6127.0,5.96
6304.0,8.31
61.0,6.59
6211.0,8.09
66.0,6.51
6182.0,6.57
151.0,7.97
3.0,6.14
10976.0,8.16
18646.0,6.85
21242.0,7.36
7453.0,6.45
6162.0,6.32
128.0,6.5
5972.0,6.58
6171.0,8.19
131.0,5.09
21293.0,7.28
7461.0,7.0
17785.0,7.66
10839.0,5.59
4912.0,7.77
6318.0,6.65
7605.0,6.82
4905.0,5.66
6023.0,8.02
67.0,6.67
16138.0,8.81
5960.0,7.86
6308.0,7.67
18621.0,7.31
4861.0,5.29
12.0,7.23
90.0,5.91
19630.0,7.15
6278.0,6.18
70.0,6.96
64.0,8.8
19579.0,6.24
6329.0,7.63
5970.0,9.21
4907.0,6.26
6076.0,5.75
18490.0,7.09
20767.0,7.73
147.0,6.17
10837.0,7.48
130.0,7.66
5914.0,6.4
6144.0,6.61
88.0,4.99
6255.0,7.55
27.0,6.81
6336.0,8.5
5921.0,7.37
19879.0,6.95
15877.0,5.77
21057.0,10.95
148.0,5.49
32704.0,8.04
5951.0,6.09
6062.0,7.33
4915.0,6.28
6133.0,3.82
6250.0,5.54
6143.0,5.47
49.0,5.09
6173.0,7.66
75.0,7.23
19614.0,5.57
18781.0,6.56
4848.0,6.49
6237.0,7.7
19760.0,5.36
5930.0,6.17
6302.0,7.41
13496.0,6.78
12820.0,6.07
4920.0,5.93
6115.0,6.67
22425.0,6.41
73.0,7.06
22096.0,6.56
6337.0,7.02
6265.0,7.31
19295.0,8.44
18347.0,7.8
6343.0,8.15
6207.0,7.81
18350.0,6.85
6064.0,7.02
18622.0,7.44
141.0,7.77
6181.0,6.11
6148.0,7.13
10977.0,8.3
6045.0,7.42
6298.0,5.38
6145.0,6.1
22.0,6.26
12132.0,7.12
4918.0,6.29
17671.0,5.65
5906.0,7.69
35.0,5.25
5911.0,6.94
6340.0,7.44
21292.0,7.19
19250.0,7.45
19294.0,7.22
163.0,6.4
82.0,9.99
13498.0,6.42
4925.0,6.4
109.0,6.75
6319.0,7.39
33191.0,3.99
10365.0,5.21
6366.0,6.6
4898.0,14.23
4894.0,5.81
12027.0,8.32
5963.0,5.36
6260.0,5.27
4917.0,6.1
7425.0,7.43
20817.0,3.62
16119.0,7.93
5999.0,5.14
5907.0,7.12
18784.0,6.92
65.0,5.94
5898.0,7.85
6220.0,7.59
19296.0,6.66
6264.0,7.7
6051.0,5.31
5918.0,6.8
5895.0,7.89
12602.0,7.15
5901.0,6.79
34.0,8.26
10988.0,8.17
116.0,6.31
4866.0,6.33
6095.0,7.5
6229.0,7.2
13421.0,7.15
102.0,7.74
4919.0,6.35
20814.0,3.89
4904.0,6.28
7527.0,5.97
12026.0,7.21
4924.0,5.11
21061.0,7.23
20963.0,5.78
6323.0,6.28
5944.0,6.39
14.0,3.53
6221.0,5.94
99.0,6.79
6210.0,6.09
139.0,6.87
74.0,7.37
19603.0,6.05
5924.0,5.68
126.0,3.8
5920.0,6.07
7529.0,6.5
95.0,7.15
21059.0,6.66
162.0,5.16
41.0,6.96
10972.0,7.35
5942.0,6.29
22413.0,6.26
7540.0,6.8
5896.0,6.09
22424.0,6.05
26.0,6.01
19338.0,7.68
4847.0,5.65
19578.0,4.14
6263.0,4.98
12490.0,6.85
22428.0,5.59
21237.0,5.27
10980.0,6.14
5984.0,4.9
6267.0,6.88
6235.0,4.67
45.0,6.29
18620.0,6.16
12025.0,8.45
43.0,5.98
119.0,6.31
6266.0,6.64
4859.0,6.48
6077.0,4.83
21058.0,8.5
155.0,4.97
4857.0,6.56
12031.0,6.67
10978.0,6.53
22419.0,6.84
107.0,8.32
5913.0,6.0
32703.0,5.53
19619.0,6.0
19627.0,3.98
17318.0,4.93
21060.0,8.58
5961.0,7.12
5910.0,5.22
18997.0,5.8
5957.0,6.08
83.0,4.04
19592.0,5.08
160.0,5.92
6142.0,5.5
87.0,5.01
22423.0,5.33
6164.0,5.37
18352.0,6.55
113.0,5.53
21236.0,4.04
6183.0,6.71
21238.0,4.92
80.0,4.47
6081.0,5.92
6208.0,9.67
91.0,5.87
23778.0,5.13
18204.0,5.93
17540.0,5.06
21239.0,3.52
19628.0,4.66
18995.0,4.97
19590.0,4.59
29.0,5.2
22095.0,4.54
145.0,4.89
19297.0,4.26
19600.0,5.21
10870.0,3.29
6160.0,4.93
18998.0,4.12
6314.0,3.77
20815.0,3.03
6301.0,5.
Query:
SELECT "month_year", "composition"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   LIMIT 1000;
Answer:
Too long, hard cut:
month_year,composition
07-2018,11.89
07-2018,9.93
07-2018,10.85
07-2018,10.32
07-2018,10.77
07-2018,10.82
07-2018,11.21
07-2018,10.71
07-2018,9.71
07-2018,10.11
07-2018,11.57
07-2018,9.47
07-2018,10.8
07-2018,13.97
07-2018,9.29
07-2018,9.49
07-2018,14.91
07-2018,12.62
07-2018,7.89
07-2018,11.99
07-2018,9.35
07-2018,10.29
07-2018,12.22
07-2018,6.97
07-2018,11.48
07-2018,14.1
07-2018,11.04
07-2018,9.77
07-2018,13.35
07-2018,11.61
07-2018,9.37
07-2018,6.61
07-2018,9.48
07-2018,13.67
07-2018,9.97
07-2018,6.05
07-2018,6.09
07-2018,6.9
,6.12
07-2018,10.43
07-2018,6.83
07-2018,7.42
07-2018,11.68
07-2018,12.87
07-2018,9.27
07-2018,6.37
07-2018,10.91
07-2018,7.02
07-2018,6.25
07-2018,8.84
07-2018,5.3
07-2018,6.71
07-2018,7.21
07-2018,12.27
07-2018,10.86
07-2018,6.28
07-2018,11.38
07-2018,11.63
07-2018,6.47
07-2018,12.93
07-2018,8.72
07-2018,7.9
07-2018,9.65
07-2018,6.82
07-2018,11.63
07-2018,8.14
07-2018,6.77
07-2018,6.24
07-2018,6.65
07-2018,10.76
07-2018,6.26
07-2018,10.22
07-2018,6.53
07-2018,8.17
07-2018,11.72
07-2018,10.95
07-2018,6.87
,7.13
07-2018,6.09
07-2018,9.97
07-2018,7.19
07-2018,6.37
07-2018,11.4
07-2018,6.28
07-2018,5.99
07-2018,7.46
07-2018,9.13
07-2018,5.99
07-2018,6.88
07-2018,6.13
07-2018,5.14
07-2018,6.25
07-2018,6.76
07-2018,7.09
07-2018,5.68
07-2018,6.52
07-2018,6.45
07-2018,6.21
07-2018,5.41
07-2018,7.48
07-2018,6.45
07-2018,9.64
07-2018,8.07
07-2018,6.41
07-2018,7.82
07-2018,5.85
07-2018,6.11
07-2018,10.82
07-2018,6.07
07-2018,6.57
07-2018,7.08
07-2018,7.08
07-2018,9.22
07-2018,5.45
07-2018,7.81
07-2018,8.24
07-2018,6.13
07-2018,7.56
07-2018,5.79
07-2018,6.54
07-2018,5.87
07-2018,10.79
07-2018,6.34
07-2018,5.88
07-2018,7.64
07-2018,6.38
07-2018,8.64
07-2018,8.81
07-2018,7.84
07-2018,6.72
07-2018,8.48
07-2018,6.1
07-2018,7.38
07-2018,5.41
07-2018,5.42
07-2018,18.82
07-2018,8.17
07-2018,7.82
07-2018,6.97
07-2018,6.67
07-2018,11.15
07-2018,17.44
07-2018,6.49
07-2018,10.27
07-2018,8.04
07-2018,6.46
07-2018,7.11
07-2018,6.14
07-2018,5.85
07-2018,7.6
07-2018,7.01
07-2018,5.87
07-2018,3.98
07-2018,17.19
07-2018,7.1
07-2018,5.57
07-2018,7.3
07-2018,7.61
07-2018,7.94
07-2018,5.89
07-2018,6.2
07-2018,7.01
07-2018,8.32
07-2018,9.46
07-2018,5.71
07-2018,5.86
07-2018,6.8
07-2018,7.42
07-2018,5.96
07-2018,8.31
07-2018,6.59
07-2018,8.09
07-2018,6.51
07-2018,6.57
07-2018,7.97
07-2018,6.14
07-2018,8.16
07-2018,6.85
07-2018,7.36
07-2018,6.45
07-2018,6.32
07-2018,6.5
07-2018,6.58
07-2018,8.19
07-2018,5.09
07-2018,7.28
07-2018,7.0
07-2018,7.66
07-2018,5.59
07-2018,7.77
07-2018,6.65
07-2018,6.82
07-2018,5.66
07-2018,8.02
07-2018,6.67
07-2018,8.81
07-2018,7.86
07-2018,7.67
07-2018,7.31
07-2018,5.29
07-2018,7.23
07-2018,5.91
07-2018,7.15
07-2018,6.18
07-2018,6.96
07-2018,8.8
07-2018,6.24
07-2018,7.63
07-2018,9.21
07-2018,6.26
07-2018,5.75
07-2018,7.09
07-2018,7.73
07-2018,6.17
07-2018,7.48
07-2018,7.66
07-2018,6.4
07-2018,6.61
07-2018,4.99
07-2018,7.55
07-2018,6.81
07-2018,8.5
07-2018,7.37
07-2018,6.95
07-2018,5.77
07-2018,10.95
07-2018,5.49
07-2018,8.04
07-2018,6.09
07-2018,7.33
07-2018,6.28
07-2018,3.82
07-2018,5.54
07-2018,5.47
07-2018,5.09
07-2018,7.66
07-2018,7.23
07-2018,5.57
07-2018,6.56
07-2018,6.49
07-2018,7.7
07-2018,5.36
07-2018,6.17
07-2018,7.41
07-2018,6.78
07-2018,6.07
07-2018,5.93
07-2018,6.67
07-2018,6.41
07-2018,7.06
07-2018,6.56
07-2018,7.02
07-2018,7.31
07-2018,8.44
07-2018,7.8
07-2018,8.15
07-2018,7.81
07-2018,6.85
07-2018,7.02
07-2018,7.44
07-2018,7.77
07-2018,6.11
07-2018,7.13
07-2018,8.3
07-2018,7.42
07-2018,5.38
07-2018,6.1
07-2018,6.26
07-2018,7.12
07-2018,6.29
07-2018,5.65
07-2018,7.69
07-2018,5.25
07-2018,6.94
07-2018,7.44
07-2018,7.19
07-2018,7.45
07-2018,7.22
07-2018,6.4
07-2018,9.99
07-2018,6.42
07-2018,6.4
07-2018,6.75
07-2018,7.39
07-2018,3.99
07-2018,5.21
07-2018,6.6
07-2018,14.23
07-2018,5.81
07-2018,8.32
07-2018,5.36
07-2018,5.27
07-2018,6.1
07-2018,7.43
07-2018,3.62
07-2018,7.93
07-2018,5.14
07-2018,7.12
07-2018,6.92
07-2018,5.94
07-2018,7.85
07-2018,7.59
07-2018,6.66
07-2018,7.7
07-2018,5.31
07-2018,6.8
07-2018,7.89
07-2018,7.15
07-2018,6.79
07-2018,8.26
07-2018,8.17
07-2018,6.31
07-2018,6.33
07-2018,7.5
07-2018,7.2
07-2018,7.15
07-2018,7.74
07-2018,6.35
07-2018,3.89
07-2018,6.28
07-2018,5.97
07-2018,7.21
07-2018,5.11
07-2018,7.23
07-2018,5.78
07-2018,6.28
07-2018,6.39
07-2018,3.53
07-2018,5.94
07-2018,6.79
07-2018,6.09
07-2018,6.87
07-2018,7.37
07-2018,6.05
07-2018,5.68
07-2018,3.8
07-2018,6.07
07-2018,6.5
07-2018,7.15
07-2018,6.66
07-2018,5.16
07-2018,6.96
07-2018,7.35
07-2018,6.29
07-2018,6.26
07-2018,6.8
07-2018,6.09
07-2018,6.05
07-2018,6.01
07-2018,7.68
07-2018,5.65
07-2018,4.14
07-2018,4.98
07-2018,6.85
07-2018,5.59
07-2018,5.27
07-2018,6.14
07-2018,4.9
07-2018,6.88
07-2018,4.67
07-2018,6.29
07-2018,6.16
07-2018,8.45
07-2018,5.98
07-2018,6.31
07-2018,6.64
07-2018,6.48
07-2018,4.83
07-2018,8.5
07-2018,4.97
07-2018,6.56
07-2018,6.67
07-2018,6.53
07-2018,6.84
07-2018,8.32
07-2018,6.0
07-2018,5.53
07-2018,6.0
07-2018,3.98
07-2018,4.93
07-2018,8.58
07-2018,7.12
07-2018,5.22
07
Query:
SELECT DISTINCT "month_year"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   LIMIT 1000;
Answer:
month_year
07-2018
""
08-2018
10-2018
11-2018
12-2018
01-2019
04-2019
05-2019
06-2019
07-2019
08-2019
09-2018
02-2019
03-2019
Query:
SELECT "id", "interest_name"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP
   LIMIT 1000;
Answer:
Too long, hard cut:
id,interest_name
1,Fitness Enthusiasts
2,Gamers
3,Car Enthusiasts
4,Luxury Retail Researchers
5,Brides & Wedding Planners
6,Vacation Planners
7,Motorcycle Enthusiasts
8,Business News Readers
12,Thrift Store Shoppers
13,Advertising Professionals
14,NFL Fans
15,NBA Fans
16,NCAA Fans
17,MLB Fans
18,Nascar Fans
19,Eco-Conscious Consumers
20,Moviegoers
21,DIYers
22,Grill Masters
23,Techies
24,Home Design Enthusiasts
25,Doctors
26,Streaming Video Fans
27,Auto Insurance Shoppers
28,Teachers
29,College Students
30,Department Store Shoppers
31,Home Decor Shoppers
33,Kids Clothing Shoppers
34,Teen Girl Clothing Shoppers
35,Mens Clothing Shoppers
36,Baby Products Buyers
37,Jewelry & Watch Shoppers
38,Sporting Goods Shoppers
39,Furniture Shoppers
40,Bed & Bath Shoppers
41,Intimates Shoppers
42,Fast Fashion Shoppers
43,Apartment Hunters
44,Home Buyers
45,Moving Services Shoppers
46,Job Seekers
48,Charitable Donors
49,NHL Fans
50,Discount Big Box Shoppers
51,Black Friday Deal Shoppers
53,Hip Hop Fans
54,Online Investors
55,Seasonal Allergy Sufferers
56,Discount Device Shoppers
57,Mobile Phone Comparison Shoppers
58,Budget Wireless Shoppers
59,Menopause Researchers
60,Online Health Researchers
61,Beauty & Skincare Buyers
62,Streaming Device Shoppers
63,New & Expecting Parents
64,High-End Kids Furniture and Clothes Shoppers
65,Hands-On Parents
66,Fantasy & Comic Fans
67,Lawyers
69,Healthy Eaters
70,Drug Store Shoppers
71,Lawn & Garden Enthusiasts
72,Nurses
73,Mailing & Shipping Shoppers
74,Office Supply Shoppers
75,Ink & Toner Shoppers
77,Luxury Retail Shoppers
78,Contractors & Construction Professionals
79,Luxury Travel Researchers
80,Democrats
81,Republicans
82,HDTV Researchers
83,Hardware Shoppers
84,Reggaeton Fans
85,Online Movie Downloaders
86,Sale Seekers
87,Theme Park Researchers
88,Ski and Snowboard Enthusiasts
89,Travel Researchers
90,Coupon Researchers
91,Parents with Toddlers
92,Parents with Kids
93,Young Boomers
94,Day Care Users
95,Stay-at-Home Parents
96,Exercise and Gym Researchers
97,Home Kitchen Chefs
98,Restaurant Researchers
99,Order-in Eaters
100,Nutrition Conscious Eaters
101,Flower & Gift Basket Shoppers
102,Plus Size Women
103,Live Concert Fans
104,Country Music Fans
106,Comedy Fans
107,Cruise Travel Intenders
108,Pain Medication Users
109,Joint Pain Sufferers
110,Pain Management Researchers
111,Retirement Planners
112,Auto Repair Researchers
113,Avid Readers
114,Womens Fashion Magazine Readers
115,Mens Shoe Shoppers
116,Home Security Shoppers
117,Boxing Fans
118,Sleep Disorder Researchers
119,Mortgage Researchers
121,Coders & Developers
123,Military Servicemembers & Veterans
124,Healthcare Discount Shoppers
125,Postal Employees
126,Soccer Fans
128,Kitchen & Bathroom Remodelers
129,Aftermarket Accessories Shoppers
130,Automotive Safety Researchers
131,Android Fans
132,Apple Fans
133,High End Camera Shoppers - Dupe
134,Home Printer Shoppers
135,Major Appliance Shoppers
136,Tablet Researchers
137,Online Alcohol Shoppers
138,Home Kitchen Bakers
139,Makeup Researchers
140,Pet Owners
141,Skin Care Researchers
142,Credit Card Researchers
143,Health Insurance Researchers
145,Property Insurance Researchers
146,Audio Equipment Researchers
147,Broadway Fans
148,Celebrity Gossip Fans
149,Streaming Radio Listeners
150,TV Junkies
151,Big & Tall Men
153,Phone Accessory Shoppers
154,Prepaid Smartphone Shoppers
155,Business Travelers
157,Car Rental Shoppers
158,Flight and Hotel Shoppers
160,Sightseeing Travelers
161,Travel Reward Points Enthusiasts
162,Retirees
163,Federal Employees
164,Conservative News Readers
165,Liberal News Readers
166,Doves
168,Social Conservatives
169,Social Liberals
170,Voters
171,Shoe Shoppers
4847,Readers of Hispanic Content
4848,Working Parents
4852,Health & Fitness
4855,Entertainment & Tabloid Magazine Readers
4857,Business Accounting Software Researchers
4858,Business Filing Researchers
4859,Business Logistics Managers
4861,IT Decision Makers
4866,Small Business Employees
4867,Sweepstakes Enthusiasts
4869,Womens Fitness Enthusiasts
4870,Tech-Savvy Moms
4872,Readers of Mexican Content
4873,TV Game Show Fans
4894,Credit Union Researchers
4895,Mature Parents
4896,Streaming Music Enthusiasts
4897,Parents of Teenagers Going to College
4898,Cosmetics and Beauty Shoppers
4899,Readers of Japanese Content
4902,Yogis
4903,Asthma Sufferers
4904,Adult Acne Sufferers
4905,Heartburn Sufferers
4906,Sinus Researchers
4907,Headache and Migraine Sufferers
4908,Back Pain Sufferers
4909,First Aid Researchers
4910,Cholesterol Researchers
4911,Dieters
4912,Vitamin Shoppers
4913,Womens Health Researchers
4914,Mens Health Researchers
4915,Food Allergies Researchers
4916,Arthritis Sufferers
4917,Teen Content Readers
4918,Gastrointestinal Researchers
4919,Military Families
4920,LGBT Activists
4921,Tire Shoppers
4924,Surfers
4925,Gun Control Advocates
4926,Gun Rights Advocates
4927,Immigration Rights Advocates
4928,Immigration Control Advocates
4929,Right Wing Radicals
4930,Occupy Movement Supporters
4931,Marijua
Query:
SELECT "interest_id", "composition"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   WHERE "composition" > 0.5
   LIMIT 1000;
Answer:
Too long, hard cut:
interest_id,composition
32486.0,11.89
6106.0,9.93
18923.0,10.85
6344.0,10.32
100.0,10.77
69.0,10.82
79.0,11.21
6111.0,10.71
6214.0,9.71
19422.0,10.11
6110.0,11.57
4895.0,9.47
6217.0,10.8
4.0,13.97
6218.0,9.29
6123.0,9.49
171.0,14.91
19613.0,12.62
17.0,7.89
6.0,11.99
6013.0,9.35
4870.0,10.29
19423.0,12.22
6089.0,6.97
161.0,11.48
6286.0,14.1
5991.0,11.04
92.0,9.77
6184.0,13.35
19621.0,11.61
63.0,9.37
103.0,6.61
38.0,9.48
17786.0,13.67
6232.0,9.97
165.0,6.05
18351.0,6.09
15.0,6.9
,6.12
17314.0,10.43
6151.0,6.83
4914.0,7.42
115.0,11.68
5968.0,12.87
36.0,9.27
5943.0,6.37
133.0,10.91
1.0,7.02
114.0,6.25
6107.0,8.84
150.0,5.3
60.0,6.71
96.0,7.21
22403.0,12.27
40.0,10.86
19758.0,6.28
17730.0,11.38
5938.0,11.63
4869.0,6.47
4897.0,12.93
6029.0,8.72
31.0,7.9
16137.0,9.65
6330.0,6.82
6334.0,11.63
6315.0,8.14
4852.0,6.77
16.0,6.24
6108.0,6.65
6206.0,10.76
6006.0,6.26
6228.0,10.22
20768.0,6.53
4902.0,8.17
6277.0,11.72
19757.0,10.95
4911.0,6.87
,7.13
4910.0,6.09
6285.0,9.97
11974.0,7.19
6219.0,6.37
10250.0,11.4
6128.0,6.28
5946.0,5.99
158.0,7.46
15935.0,9.13
4855.0,5.99
149.0,6.88
16197.0,6.13
11067.0,5.14
17674.0,6.25
4913.0,6.76
56.0,7.09
6341.0,5.68
6316.0,6.52
18647.0,6.45
17803.0,6.21
23.0,5.41
132.0,7.48
6365.0,6.45
6378.0,9.64
17673.0,8.07
97.0,6.41
7537.0,7.82
20764.0,5.85
44.0,6.11
5.0,10.82
6227.0,6.07
19.0,6.57
93.0,7.08
6085.0,7.08
6112.0,9.22
4873.0,5.45
11975.0,7.81
22502.0,8.24
86.0,6.13
19610.0,7.56
20753.0,5.79
24.0,6.54
20750.0,5.87
12133.0,10.79
6141.0,6.34
6172.0,5.88
98.0,7.64
125.0,6.38
17269.0,8.64
4943.0,8.81
18996.0,7.84
13.0,6.72
89.0,8.48
169.0,6.1
101.0,7.38
6087.0,5.41
104.0,5.42
6284.0,18.82
7557.0,8.17
37.0,7.82
6084.0,6.97
8.0,6.67
5969.0,11.15
39.0,17.44
117.0,6.49
19298.0,10.27
22427.0,8.04
85.0,6.46
5952.0,7.11
164.0,6.14
19587.0,5.85
33.0,7.6
135.0,7.01
19588.0,5.87
17320.0,3.98
77.0,17.19
18648.0,7.1
5989.0,5.57
138.0,7.3
18202.0,7.61
137.0,7.94
4940.0,5.89
12277.0,6.2
4909.0,7.01
4944.0,8.32
10008.0,9.46
6299.0,5.71
20731.0,5.86
10838.0,6.8
111.0,7.42
6127.0,5.96
6304.0,8.31
61.0,6.59
6211.0,8.09
66.0,6.51
6182.0,6.57
151.0,7.97
3.0,6.14
10976.0,8.16
18646.0,6.85
21242.0,7.36
7453.0,6.45
6162.0,6.32
128.0,6.5
5972.0,6.58
6171.0,8.19
131.0,5.09
21293.0,7.28
7461.0,7.0
17785.0,7.66
10839.0,5.59
4912.0,7.77
6318.0,6.65
7605.0,6.82
4905.0,5.66
6023.0,8.02
67.0,6.67
16138.0,8.81
5960.0,7.86
6308.0,7.67
18621.0,7.31
4861.0,5.29
12.0,7.23
90.0,5.91
19630.0,7.15
6278.0,6.18
70.0,6.96
64.0,8.8
19579.0,6.24
6329.0,7.63
5970.0,9.21
4907.0,6.26
6076.0,5.75
18490.0,7.09
20767.0,7.73
147.0,6.17
10837.0,7.48
130.0,7.66
5914.0,6.4
6144.0,6.61
88.0,4.99
6255.0,7.55
27.0,6.81
6336.0,8.5
5921.0,7.37
19879.0,6.95
15877.0,5.77
21057.0,10.95
148.0,5.49
32704.0,8.04
5951.0,6.09
6062.0,7.33
4915.0,6.28
6133.0,3.82
6250.0,5.54
6143.0,5.47
49.0,5.09
6173.0,7.66
75.0,7.23
19614.0,5.57
18781.0,6.56
4848.0,6.49
6237.0,7.7
19760.0,5.36
5930.0,6.17
6302.0,7.41
13496.0,6.78
12820.0,6.07
4920.0,5.93
6115.0,6.67
22425.0,6.41
73.0,7.06
22096.0,6.56
6337.0,7.02
6265.0,7.31
19295.0,8.44
18347.0,7.8
6343.0,8.15
6207.0,7.81
18350.0,6.85
6064.0,7.02
18622.0,7.44
141.0,7.77
6181.0,6.11
6148.0,7.13
10977.0,8.3
6045.0,7.42
6298.0,5.38
6145.0,6.1
22.0,6.26
12132.0,7.12
4918.0,6.29
17671.0,5.65
5906.0,7.69
35.0,5.25
5911.0,6.94
6340.0,7.44
21292.0,7.19
19250.0,7.45
19294.0,7.22
163.0,6.4
82.0,9.99
13498.0,6.42
4925.0,6.4
109.0,6.75
6319.0,7.39
33191.0,3.99
10365.0,5.21
6366.0,6.6
4898.0,14.23
4894.0,5.81
12027.0,8.32
5963.0,5.36
6260.0,5.27
4917.0,6.1
7425.0,7.43
20817.0,3.62
16119.0,7.93
5999.0,5.14
5907.0,7.12
18784.0,6.92
65.0,5.94
5898.0,7.85
6220.0,7.59
19296.0,6.66
6264.0,7.7
6051.0,5.31
5918.0,6.8
5895.0,7.89
12602.0,7.15
5901.0,6.79
34.0,8.26
10988.0,8.17
116.0,6.31
4866.0,6.33
6095.0,7.5
6229.0,7.2
13421.0,7.15
102.0,7.74
4919.0,6.35
20814.0,3.89
4904.0,6.28
7527.0,5.97
12026.0,7.21
4924.0,5.11
21061.0,7.23
20963.0,5.78
6323.0,6.28
5944.0,6.39
14.0,3.53
6221.0,5.94
99.0,6.79
6210.0,6.09
139.0,6.87
74.0,7.37
19603.0,6.05
5924.0,5.68
126.0,3.8
5920.0,6.07
7529.0,6.5
95.0,7.15
21059.0,6.66
162.0,5.16
41.0,6.96
10972.0,7.35
5942.0,6.29
22413.0,6.26
7540.0,6.8
5896.0,6.09
22424.0,6.05
26.0,6.01
19338.0,7.68
4847.0,5.65
19578.0,4.14
6263.0,4.98
12490.0,6.85
22428.0,5.59
21237.0,5.27
10980.0,6.14
5984.0,4.9
6267.0,6.88
6235.0,4.67
45.0,6.29
18620.0,6.16
12025.0,8.45
43.0,5.98
119.0,6.31
6266.0,6.64
4859.0,6.48
6077.0,4.83
21058.0,8.5
155.0,4.97
4857.0,6.56
12031.0,6.67
10978.0,6.53
22419.0,6.84
107.0,8.32
5913.0,6.0
32703.0,5.53
19619.0,6.0
19627.0,3.98
17318.0,4.93
21060.0,8.58
5961.0,7.12
5910.0,5.22
18997.0,5.8
5957.0,6.08
83.0,4.04
19592.0,5.08
160.0,5.92
6142.0,5.5
87.0,5.01
22423.0,5.33
6164.0,5.37
18352.0,6.55
113.0,5.53
21236.0,4.04
6183.0,6.71
21238.0,4.92
80.0,4.47
6081.0,5.92
6208.0,9.67
91.0,5.87
23778.0,5.13
18204.0,5.93
17540.0,5.06
21239.0,3.52
19628.0,4.66
18995.0,4.97
19590.0,4.59
29.0,5.2
22095.0,4.54
145.0,4.89
19297.0,4.26
19600.0,5.21
10870.0,3.29
6160.0,4.93
18998.0,4.12
6314.0,3.77
20815.0,3.03
6301.0,5.
Query:
SELECT "interest_id", MAX("composition") AS "max_composition"
   FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
   GROUP BY "interest_id"
   LIMIT 1000;
Answer:
Too long, hard cut:
interest_id,max_composition
32486.0,11.89
6106.0,9.93
18923.0,10.85
6344.0,10.32
100.0,10.77
6111.0,10.71
19422.0,10.11
6110.0,11.57
6217.0,10.8
171.0,14.91
19613.0,12.62
17.0,7.89
6.0,12.56
6013.0,9.35
4870.0,10.29
19423.0,12.22
6089.0,6.97
6286.0,14.1
19621.0,11.61
63.0,9.37
165.0,6.05
18351.0,6.09
,9.66
17314.0,10.43
4914.0,7.42
6107.0,8.84
40.0,10.86
5938.0,11.63
16137.0,9.65
6330.0,6.82
6006.0,6.26
6228.0,10.22
4902.0,8.17
97.0,6.41
20764.0,5.85
5.0,10.82
19610.0,7.56
4940.0,5.89
10838.0,6.8
6255.0,7.55
69.0,10.82
79.0,11.21
4895.0,9.47
5991.0,11.04
114.0,6.25
96.0,7.21
19758.0,6.28
6029.0,10.05
6334.0,11.63
6315.0,8.14
6206.0,10.76
20768.0,6.53
4855.0,5.99
56.0,7.09
23.0,5.41
98.0,7.64
18646.0,6.85
6162.0,6.32
128.0,6.5
6308.0,9.33
148.0,5.49
18347.0,7.8
4910.0,6.09
32703.0,5.69
6214.0,9.71
4.0,13.97
6218.0,9.29
161.0,11.48
92.0,9.77
6184.0,13.35
6232.0,9.97
36.0,9.27
150.0,5.3
17730.0,11.38
4869.0,6.47
31.0,7.9
19757.0,10.95
4911.0,6.87
5946.0,5.99
6378.0,9.64
6172.0,6.1
169.0,6.1
6299.0,5.71
6304.0,8.31
6123.0,9.49
103.0,6.61
38.0,9.48
17786.0,13.67
15.0,6.9
115.0,11.68
22403.0,12.27
4852.0,6.77
6108.0,6.65
6219.0,6.37
10250.0,11.4
149.0,6.88
16197.0,6.13
11067.0,7.93
4913.0,6.76
6316.0,6.52
17803.0,6.21
44.0,6.11
19.0,6.57
4873.0,5.57
86.0,6.13
24.0,6.54
12133.0,15.15
6141.0,6.34
4943.0,10.7
18996.0,7.84
85.0,6.46
19587.0,5.85
135.0,7.01
19588.0,5.87
77.0,17.19
4944.0,9.46
111.0,7.42
151.0,7.97
7461.0,7.0
17785.0,7.66
6318.0,6.65
7605.0,6.82
12.0,7.23
70.0,6.96
19579.0,6.24
18490.0,7.09
147.0,6.17
6062.0,7.33
19760.0,5.36
6115.0,6.67
6265.0,7.31
18350.0,6.85
6148.0,7.13
6340.0,7.44
109.0,6.75
12027.0,8.32
18784.0,7.47
34.0,11.23
102.0,7.74
6323.0,6.28
5896.0,6.09
6301.0,5.58
22411.0,5.22
6321.0,4.97
62.0,4.15
6222.0,3.49
6341.0,5.68
17673.0,8.07
6112.0,9.22
20753.0,5.79
125.0,6.38
17269.0,8.64
6284.0,18.82
7557.0,8.17
117.0,6.49
33.0,7.6
17320.0,3.98
18202.0,8.23
10008.0,9.46
10976.0,8.16
21242.0,7.36
21293.0,7.28
6278.0,6.18
64.0,12.41
88.0,4.99
5921.0,7.37
21057.0,21.2
6133.0,3.82
22096.0,6.56
18622.0,7.44
19294.0,7.22
5963.0,5.36
10988.0,8.17
116.0,6.31
21061.0,8.97
5984.0,4.9
45.0,6.29
21058.0,8.5
4857.0,6.56
6024.0,4.7
157.0,4.94
143.0,4.68
14901.0,4.15
6320.0,4.72
19604.0,5.82
7536.0,5.84
16196.0,4.59
18203.0,2.9
38360.0,3.48
36864.0,3.35
37876.0,2.26
10954.0,1.88
133.0,10.91
11974.0,7.19
15935.0,9.13
18647.0,6.45
5968.0,12.87
5943.0,6.37
16.0,6.24
6277.0,11.72
6285.0,9.97
6128.0,6.28
17674.0,7.88
93.0,7.08
22502.0,8.24
20750.0,5.87
6087.0,5.41
104.0,5.42
39.0,17.44
5952.0,7.11
164.0,6.14
5989.0,5.57
138.0,7.3
12277.0,6.2
61.0,6.59
6211.0,8.09
5972.0,6.6
6023.0,8.02
5960.0,10.61
90.0,5.91
6144.0,6.61
49.0,5.09
75.0,7.23
18781.0,6.56
4848.0,6.49
5930.0,6.17
13496.0,6.78
4920.0,5.93
163.0,6.4
33191.0,4.39
5918.0,6.8
13421.0,7.15
12025.0,8.45
19297.0,4.26
10870.0,3.29
19606.0,4.42
170.0,4.76
6151.0,6.83
1.0,7.02
60.0,8.66
158.0,11.97
132.0,7.48
6365.0,6.45
7537.0,7.82
6227.0,6.45
6085.0,7.08
11975.0,7.81
13.0,6.72
89.0,10.14
37.0,7.82
6084.0,6.97
8.0,6.67
4909.0,7.01
6127.0,5.96
66.0,6.51
7453.0,6.45
6171.0,8.19
131.0,5.09
10839.0,5.59
67.0,6.76
4861.0,5.29
19630.0,7.15
5970.0,9.21
4907.0,6.26
20767.0,7.73
10837.0,7.48
130.0,7.66
27.0,6.81
19879.0,6.95
4915.0,6.28
6250.0,5.54
6237.0,7.7
6302.0,7.41
22425.0,6.41
6207.0,7.81
141.0,9.46
6181.0,6.11
6298.0,5.38
6145.0,6.1
22.0,6.26
4918.0,6.29
17671.0,5.65
5906.0,7.69
35.0,5.25
21292.0,7.19
19250.0,7.7
82.0,9.99
13498.0,6.42
4925.0,6.4
6319.0,7.39
10365.0,5.21
6366.0,6.6
4898.0,14.23
7425.0,8.54
16119.0,7.93
65.0,5.94
5898.0,7.85
6051.0,5.31
5901.0,6.79
4866.0,6.33
6095.0,7.5
6229.0,7.2
20814.0,5.78
4904.0,6.28
7527.0,5.97
20963.0,5.78
6221.0,5.94
6210.0,6.09
139.0,6.87
19603.0,6.05
126.0,6.67
5920.0,6.07
7529.0,6.5
41.0,6.96
10972.0,7.35
22424.0,6.05
19338.0,7.68
19578.0,4.14
6263.0,5.14
10980.0,6.14
6267.0,6.88
119.0,6.31
4859.0,6.48
155.0,4.97
12031.0,7.08
107.0,8.32
17318.0,4.93
21060.0,8.58
5961.0,7.12
18997.0,6.05
6142.0,6.25
87.0,5.01
22423.0,5.33
21236.0,6.64
21238.0,5.15
80.0,4.47
6208.0,9.67
23778.0,5.52
18204.0,6.51
19628.0,4.66
19590.0,4.59
22095.0,4.54
145.0,4.89
20815.0,3.03
6305.0,6.2
6328.0,5.43
30.0,8.56
4928.0,4.78
59.0,3.97
55.0,7.67
18619.0,9.15
6030.0,3.85
10284.0,5.02
6209.0,4.45
6169.0,3.8
142.0,4.73
6194.0,4.39
153.0,5.08
10832.0,4.4
6088.0,4.28
11065.0,4.22
22093.0,4.34
6393.0,3.17
50.0,3.86
20755.0,4.77
12821.0,5.18
14800.0,4.11
6300.0,4.91
10009.0,8.95
18807.0,4.1
32705.0,4.69
6335.0,4.41
108.0,4.24
6149.0,4.1
10364.0,3.29
6367.0,3.78
4903.0,3.67
110.0,5.78
20816.0,2.79
4867.0,5.44
20730.0,4.0
7546.0,4.72
18924.0,4.61
4908.0,3.29
19593.0,6.18
6230.0,4.39
6317.0,4.67
5936.0,3.78
18783.0,9.83
7597.0,3.18
7545.0,4.19
6345.0,3.94
17729.0,6.7
4906.0,3.09
10970.0,4.04
22401.0,3.62
10836.0,4.18
4933.0,3.46
6215.0,3.81
6156.0,2.99
5945.0,4.87
112.0,2.95
6339.0,3.79
6122.0,3.05
19594.0,2.48
4931.0,4.05
6034.0,4.69
22398.0,3.52
72.0,3.63
19609.0,3.17
6332.0,2.65
21248.0,2.88
58.0,2.18
10971.0,2.67
7598.0,2.82
19626.0,1.99
19631.0,2.
Query:
WITH MaxCompositions AS (
    SELECT
        t1."interest_id",
        t2."interest_name" AS "Interest Name",
        t1."month_year" AS "Time",
        t1."composition" AS "Composition Value",
        ROW_NUMBER() OVER (PARTITION BY t1."interest_id" ORDER BY t1."composition" DESC) AS rn
    FROM 
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS t1
    JOIN 
        BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP t2
        ON t1."interest_id" = t2."id"
)
SELECT "Time", "Interest Name", "Composition Value"
FROM (
    SELECT "Time", "Interest Name", "Composition Value",
        ROW_NUMBER() OVER (ORDER BY "Composition Value" DESC) AS rank_desc,
        ROW_NUMBER() OVER (ORDER BY "Composition Value" ASC) AS rank_asc
    FROM MaxCompositions
    WHERE rn = 1
) sub
WHERE rank_desc <= 10 OR rank_asc <= 10
ORDER BY "Composition Value" DESC;
Answer:
Time,Interest Name,Composition Value
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
07-2018,Readers of Jamaican Content,1.86
02-2019,Automotive News Readers,1.84
07-2018,Comedy Fans,1.83
08-2019,World of Warcraft Enthusiasts,1.82
08-2018,Miami Heat Fans,1.81
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2019,Hearthstone Video Game Fans,1.66
09-2018,Scifi Movie and TV Enthusiasts,1.61
09-2018,Action Movie and TV Enthusiasts,1.59
03-2019,The Sims Video Game Fans,1.57
Query:
SELECT "month_year", AVG("composition") AS "avg_composition"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
GROUP BY "month_year"
LIMIT 1000
Answer:
month_year,avg_composition
07-2018,5.670631001371743
,3.935435510887772
08-2018,3.806623207301173
09-2018,3.5034358974358972
10-2018,4.066382730455076
11-2018,3.398491379310345
12-2018,3.498140703517588
01-2019,3.0821171634121276
02-2019,3.5352899197145407
03-2019,3.2845070422535207
05-2019,2.345647607934656
04-2019,2.795550500454959
06-2019,2.153082524271845
07-2019,2.444421296296296
08-2019,2.9340905134899913
Query:
SELECT "interest_id", "percentile_ranking"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
LIMIT 1000
Answer:
Too long, hard cut:
interest_id,percentile_ranking
32486.0,99.86
6106.0,99.73
18923.0,99.59
6344.0,99.45
100.0,99.31
69.0,99.18
79.0,99.04
6111.0,98.9
6214.0,98.9
19422.0,98.63
6110.0,98.49
4895.0,98.35
6217.0,98.22
4.0,98.08
6218.0,97.94
6123.0,97.81
171.0,97.67
19613.0,97.53
17.0,97.39
6.0,97.26
6013.0,97.12
4870.0,96.98
19423.0,96.84
6089.0,96.71
161.0,96.57
6286.0,96.57
5991.0,96.3
92.0,96.16
6184.0,96.02
19621.0,95.88
63.0,95.75
103.0,95.61
38.0,95.47
17786.0,95.34
6232.0,95.2
165.0,95.06
18351.0,94.92
15.0,94.79
,96.4
17314.0,94.65
6151.0,94.65
4914.0,94.65
115.0,94.24
5968.0,94.24
36.0,93.96
5943.0,93.83
133.0,93.69
1.0,93.69
114.0,93.42
6107.0,93.28
150.0,93.28
60.0,93.0
96.0,92.87
22403.0,92.73
40.0,92.59
19758.0,92.59
17730.0,92.32
5938.0,92.18
4869.0,92.18
4897.0,91.91
6029.0,91.77
31.0,91.77
16137.0,91.5
6330.0,91.36
6334.0,91.36
6315.0,91.36
4852.0,90.95
16.0,90.95
6108.0,90.67
6206.0,90.67
6006.0,90.4
6228.0,90.4
20768.0,90.4
4902.0,89.99
6277.0,89.85
19757.0,89.71
4911.0,89.71
,96.23
4910.0,89.44
6285.0,89.3
11974.0,89.16
6219.0,89.16
10250.0,88.89
6128.0,88.75
5946.0,88.61
158.0,88.61
15935.0,88.34
4855.0,88.2
149.0,88.2
16197.0,87.93
11067.0,87.79
17674.0,87.65
4913.0,87.65
56.0,87.38
6341.0,87.38
6316.0,87.38
18647.0,87.38
17803.0,87.38
23.0,86.69
132.0,86.56
6365.0,86.56
6378.0,86.28
17673.0,86.15
97.0,86.15
7537.0,86.15
20764.0,86.15
44.0,85.6
5.0,85.6
6227.0,85.6
19.0,85.19
93.0,85.19
6085.0,84.91
6112.0,84.77
4873.0,84.64
11975.0,84.5
22502.0,84.36
86.0,84.36
19610.0,84.09
20753.0,83.95
24.0,83.95
20750.0,83.95
12133.0,83.95
6141.0,83.4
6172.0,83.4
98.0,83.4
125.0,82.99
17269.0,82.99
4943.0,82.72
18996.0,82.72
13.0,82.72
89.0,82.72
169.0,82.17
101.0,82.17
6087.0,81.89
104.0,81.89
6284.0,81.89
7557.0,81.89
37.0,81.89
6084.0,81.21
8.0,81.07
5969.0,81.07
39.0,81.07
117.0,80.66
19298.0,80.52
22427.0,80.52
85.0,80.25
5952.0,80.25
164.0,80.25
19587.0,79.84
33.0,79.84
135.0,79.56
19588.0,79.42
17320.0,79.42
77.0,79.42
18648.0,79.01
5989.0,78.88
138.0,78.74
18202.0,78.74
137.0,78.46
4940.0,78.33
12277.0,78.33
4909.0,78.33
4944.0,78.33
10008.0,77.78
6299.0,77.64
20731.0,77.64
10838.0,77.64
111.0,77.64
6127.0,77.09
6304.0,77.09
61.0,77.09
6211.0,76.68
66.0,76.68
6182.0,76.68
151.0,76.68
3.0,76.13
10976.0,75.99
18646.0,75.99
21242.0,75.99
7453.0,75.58
6162.0,75.45
128.0,75.45
5972.0,75.45
6171.0,75.03
131.0,75.03
21293.0,75.03
7461.0,75.03
17785.0,75.03
10839.0,75.03
4912.0,75.03
6318.0,74.07
7605.0,74.07
4905.0,74.07
6023.0,74.07
67.0,73.53
16138.0,73.53
5960.0,73.53
6308.0,73.53
18621.0,73.53
4861.0,72.84
12.0,72.7
90.0,72.7
19630.0,72.7
6278.0,72.29
70.0,72.29
64.0,72.29
19579.0,72.29
6329.0,71.74
5970.0,71.74
4907.0,71.47
6076.0,71.47
18490.0,71.19
20767.0,71.19
147.0,71.19
10837.0,70.78
130.0,70.78
5914.0,70.78
6144.0,70.78
88.0,70.23
6255.0,70.23
27.0,70.23
6336.0,70.23
5921.0,69.68
19879.0,69.68
15877.0,69.41
21057.0,69.41
148.0,69.14
32704.0,69.14
5951.0,69.14
6062.0,69.14
4915.0,68.59
6133.0,68.59
6250.0,68.59
6143.0,68.59
49.0,68.59
6173.0,67.9
75.0,67.76
19614.0,67.76
18781.0,67.49
4848.0,67.49
6237.0,67.49
19760.0,67.49
5930.0,66.94
6302.0,66.94
13496.0,66.94
12820.0,66.94
4920.0,66.39
6115.0,66.26
22425.0,66.26
73.0,66.26
22096.0,65.84
6337.0,65.84
6265.0,65.84
19295.0,65.43
18347.0,65.43
6343.0,65.43
6207.0,65.43
18350.0,65.43
6064.0,64.75
18622.0,64.75
141.0,64.75
6181.0,64.75
6148.0,64.75
10977.0,64.75
6045.0,63.92
6298.0,63.92
6145.0,63.92
22.0,63.92
12132.0,63.92
4918.0,63.92
17671.0,63.1
5906.0,63.1
35.0,62.83
5911.0,62.83
6340.0,62.83
21292.0,62.41
19250.0,62.41
19294.0,62.41
163.0,62.0
82.0,62.0
13498.0,62.0
4925.0,62.0
109.0,62.0
6319.0,62.0
33191.0,61.18
10365.0,61.18
6366.0,60.91
4898.0,60.91
4894.0,60.63
12027.0,60.63
5963.0,60.63
6260.0,60.63
4917.0,60.63
7425.0,60.63
20817.0,60.63
16119.0,59.67
5999.0,59.67
5907.0,59.4
18784.0,59.4
65.0,59.12
5898.0,59.12
6220.0,59.12
19296.0,59.12
6264.0,59.12
6051.0,59.12
5918.0,58.3
5895.0,58.3
12602.0,58.02
5901.0,58.02
34.0,57.75
10988.0,57.61
116.0,57.61
4866.0,57.61
6095.0,57.61
6229.0,57.61
13421.0,57.61
102.0,56.79
4919.0,56.65
20814.0,56.65
4904.0,56.65
7527.0,56.24
12026.0,56.24
4924.0,55.97
21061.0,55.97
20963.0,55.69
6323.0,55.69
5944.0,55.69
14.0,55.69
6221.0,55.14
99.0,55.14
6210.0,55.14
139.0,55.14
74.0,55.14
19603.0,54.46
5924.0,54.46
126.0,54.46
5920.0,54.46
7529.0,54.46
95.0,53.77
21059.0,53.77
162.0,53.5
41.0,53.5
10972.0,53.5
5942.0,53.09
22413.0,53.09
7540.0,52.81
5896.0,52.81
22424.0,52.54
26.0,52.54
19338.0,52.54
4847.0,52.54
19578.0,52.54
6263.0,51.85
12490.0,51.71
22428.0,51.71
21237.0,51.71
10980.0,51.71
5984.0,51.71
6267.0,51.03
6235.0,51.03
45.0,51.03
18620.0,51.03
12025.0,50.48
43.0,50.34
119.0,50.34
6266.0,50.07
4859.0,50.07
6077.0,49.79
21058.0,49.79
155.0,49.52
4857.0,49.52
12031.0,49.52
10978.0,49.11
22419.0,49.11
107.0,49.11
5913.0,49.11
32703.0,48.56
19619.0,48.42
19627.0,48.42
17318.0,48.15
21060.0,48.01
5961.0,48.01
5910.0,48.01
18997.0,47.6
5957.0,47.6
83.0,47.6
19592.0,47.19
160.0,47.05
6142.0,47.05
87.0,46.78
22423.
Query:
SELECT im."interest_id", im."month_year", im."composition", m."interest_name"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
JOIN BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP m
ON im."interest_id" = m."id"
LIMIT 1000
Answer:
Too long, hard cut:
interest_id,month_year,composition,interest_name
32486.0,07-2018,11.89,Vacation Rental Accommodation Researchers
6106.0,07-2018,9.93,Luxury Second Home Owners
18923.0,07-2018,10.85,Online Home Decor Shoppers
6344.0,07-2018,10.32,Hair Care Shoppers
100.0,07-2018,10.77,Nutrition Conscious Eaters
69.0,07-2018,10.82,Healthy Eaters
79.0,07-2018,11.21,Luxury Travel Researchers
6111.0,07-2018,10.71,Wine Lovers
6214.0,07-2018,9.71,Home Remodelers
19422.0,07-2018,10.11,Home Design and Living Publication Readers
6110.0,07-2018,11.57,Apartment Furniture Shoppers
4895.0,07-2018,9.47,Mature Parents
6217.0,07-2018,10.8,Weight Loss Researchers
4.0,07-2018,13.97,Luxury Retail Researchers
6218.0,07-2018,9.29,Running Enthusiasts
6123.0,07-2018,9.49,Misc-Deal Seekers or Coupon Shoppers
171.0,07-2018,14.91,Shoe Shoppers
19613.0,07-2018,12.62,Land Rover Shoppers
17.0,07-2018,7.89,MLB Fans
6.0,07-2018,11.99,Vacation Planners
6013.0,07-2018,9.35,Competitive Sports Participants
4870.0,07-2018,10.29,Tech-Savvy Moms
19423.0,07-2018,12.22,Kitchen Appliance Shoppers
6089.0,07-2018,6.97,Mens Fitness Publication Readers
161.0,07-2018,11.48,Travel Reward Points Enthusiasts
6286.0,07-2018,14.1,Luxury Hotel Guests
5991.0,07-2018,11.04,Gluten-Free Recipe Researchers
92.0,07-2018,9.77,Parents with Kids
6184.0,07-2018,13.35,Reusable Drinkware Shoppers
19621.0,07-2018,11.61,Portugal Trip Planners
63.0,07-2018,9.37,New & Expecting Parents
103.0,07-2018,6.61,Live Concert Fans
38.0,07-2018,9.48,Sporting Goods Shoppers
17786.0,07-2018,13.67,Womens Fashion Brands Shoppers
6232.0,07-2018,9.97,Golf Enthusiasts
165.0,07-2018,6.05,Liberal News Readers
18351.0,07-2018,6.09,Drama Show Watchers
15.0,07-2018,6.9,NBA Fans
17314.0,07-2018,10.43,Lobbyists
6151.0,07-2018,6.83,Wedding Registrants
4914.0,07-2018,7.42,Mens Health Researchers
115.0,07-2018,11.68,Mens Shoe Shoppers
5968.0,07-2018,12.87,Luxury Kitchen Goods Shoppers
36.0,07-2018,9.27,Baby Products Buyers
5943.0,07-2018,6.37,Financial News Readers
133.0,07-2018,10.91,High End Camera Shoppers - Dupe
1.0,07-2018,7.02,Fitness Enthusiasts
114.0,07-2018,6.25,Womens Fashion Magazine Readers
6107.0,07-2018,8.84,Ski House Second Home Owners
150.0,07-2018,5.3,TV Junkies
60.0,07-2018,6.71,Online Health Researchers
96.0,07-2018,7.21,Exercise and Gym Researchers
22403.0,07-2018,12.27,Pandora Jewelry Shoppers
40.0,07-2018,10.86,Bed & Bath Shoppers
19758.0,07-2018,6.28,Dog Lovers
17730.0,07-2018,11.38,Luxury Department Store Shoppers
5938.0,07-2018,11.63,Costa Rica Trip Planners
4869.0,07-2018,6.47,Womens Fitness Enthusiasts
4897.0,07-2018,12.93,Parents of Teenagers Going to College
6029.0,07-2018,8.72,Indoor Cycling & Spinning Enthusiasts
31.0,07-2018,7.9,Home Decor Shoppers
16137.0,07-2018,9.65,Olympics Fans
6330.0,07-2018,6.82,Pet Store Goers
6334.0,07-2018,11.63,Supermarket Shoppers
6315.0,07-2018,8.14,Boston Trip Planners
4852.0,07-2018,6.77,Health & Fitness
16.0,07-2018,6.24,NCAA Fans
6108.0,07-2018,6.65,Beach House Second Home Owners
6206.0,07-2018,10.76,Preppy Clothing Shoppers
6006.0,07-2018,6.26,Breast Cancer Fund Raisers
6228.0,07-2018,10.22,Paleo Eaters
20768.0,07-2018,6.53,Beer Aficionados
4902.0,07-2018,8.17,Yogis
6277.0,07-2018,11.72,Harry Potter Fans
19757.0,07-2018,10.95,Natural Pet Food Shoppers
4911.0,07-2018,6.87,Dieters
4910.0,07-2018,6.09,Cholesterol Researchers
6285.0,07-2018,9.97,Competitive Tri-Athletes
11974.0,07-2018,7.19,Price Conscious Home Shoppers
6219.0,07-2018,6.37,Cycling Enthusiasts
10250.0,07-2018,11.4,Halloween Costume Shoppers
6128.0,07-2018,6.28,Realtors & Real Estate Researchers
5946.0,07-2018,5.99,Readers of Filipinos Content
158.0,07-2018,7.46,Flight and Hotel Shoppers
15935.0,07-2018,9.13,Pregnancy Resources Researchers
4855.0,07-2018,5.99,Entertainment & Tabloid Magazine Readers
149.0,07-2018,6.88,Streaming Radio Listeners
16197.0,07-2018,6.13,Financial Business Intelligence Researchers
11067.0,07-2018,5.14,NCAA Football Fans
17674.0,07-2018,6.25,Medical Advice Researchers
4913.0,07-2018,6.76,Womens Health Researchers
56.0,07-2018,7.09,Discount Device Shoppers
6341.0,07-2018,5.68,Pharmacy Shoppers
6316.0,07-2018,6.52,Philadelphia Trip Planners
18647.0,07-2018,6.45,Gourmet Food & Wine Researchers
17803.0,07-2018,6.21,TV Advertising Professionals
23.0,07-2018,5.41,Techies
132.0,07-2018,7.48,Apple Fans
6365.0,07-2018,6.45,Executive and C-Suite
6378.0,07-2018,9.64,Luggage Shoppers
17673.0,07-2018,8.07,Coffee Chain Shoppers
97.0,07-2018,6.41,Home Kitchen Chefs
7537.0,07-2018,7.82,Ecommerce Platform Researchers
20764.0,07-2018,5.85,Entertainment Industry Decision Makers
44.0,07-2018,6.11,Home Buyers
5.0,07-2018,10.82,Brides & Wedding Planners
6227.0,07-2018,6.07,Personal Stock Portfolio Managers
19.0,07-2018,6.57,Eco-Conscious Consumers
93.0,07-2018,7.08,Young Boomers
6085.0,07-2018,7.08,Discount Womens Shoes Shoppers
6112.0,07-2018,9.22,Olympic Sports Enthusiasts
4873.0,07-2018,5.45,TV Game Show Fans
11975.0,07-2018,7.81,Landscape Architects
22502.0,07-2018,8.24,Lacrosse Enth
Query:
SELECT DISTINCT "interest_name", "id"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP
LIMIT 1000
Answer:
Too long, hard cut:
interest_name,id
Fitness Enthusiasts,1
Gamers,2
Car Enthusiasts,3
Luxury Retail Researchers,4
Brides & Wedding Planners,5
Vacation Planners,6
Business News Readers,8
Thrift Store Shoppers,12
Advertising Professionals,13
NCAA Fans,16
Nascar Fans,18
Moviegoers,20
DIYers,21
Grill Masters,22
Techies,23
Home Design Enthusiasts,24
Streaming Video Fans,26
College Students,29
Kids Clothing Shoppers,33
Teen Girl Clothing Shoppers,34
Mens Clothing Shoppers,35
Sporting Goods Shoppers,38
Furniture Shoppers,39
Fast Fashion Shoppers,42
Home Buyers,44
Job Seekers,46
NHL Fans,49
Hip Hop Fans,53
Seasonal Allergy Sufferers,55
Online Health Researchers,60
Nurses,72
Online Movie Downloaders,85
Coupon Researchers,90
Home Kitchen Chefs,97
Flower & Gift Basket Shoppers,101
Aftermarket Accessories Shoppers,129
Home Printer Shoppers,134
Major Appliance Shoppers,135
Tablet Researchers,136
Property Insurance Researchers,145
Audio Equipment Researchers,146
Broadway Fans,147
Sightseeing Travelers,160
Tech-Savvy Moms,4870
MLB Fans,17
Department Store Shoppers,30
Discount Big Box Shoppers,50
High-End Kids Furniture and Clothes Shoppers,64
Lawyers,67
Democrats,80
Travel Researchers,89
Live Concert Fans,103
Retirement Planners,111
Automotive Safety Researchers,130
Apple Fans,132
Flight and Hotel Shoppers,158
Retirees,162
Entertainment & Tabloid Magazine Readers,4855
Streaming Music Enthusiasts,4896
Mens Health Researchers,4914
Food Allergies Researchers,4915
Online Auto Shoppers,5967
Mature Parents,4895
Cardio Health Researchers,5895
NFL Fans,14
Eco-Conscious Consumers,19
Doctors,25
Apartment Hunters,43
Moving Services Shoppers,45
Budget Wireless Shoppers,58
Beauty & Skincare Buyers,61
Hands-On Parents,65
Lawn & Garden Enthusiasts,71
Contractors & Construction Professionals,78
Nutrition Conscious Eaters,100
Mens Shoe Shoppers,115
High End Camera Shoppers - Dupe,133
Skin Care Researchers,141
Streaming Radio Listeners,149
Shoe Shoppers,171
Back Pain Sufferers,4908
Marijuana Prohibition Advocates,4932
Motorcycle Enthusiasts,7
NBA Fans,15
Baby Products Buyers,36
Black Friday Deal Shoppers,51
Mobile Phone Comparison Shoppers,57
Menopause Researchers,59
Streaming Device Shoppers,62
New & Expecting Parents,63
Drug Store Shoppers,70
Luxury Retail Shoppers,77
Luxury Travel Researchers,79
Republicans,81
HDTV Researchers,82
Reggaeton Fans,84
Ski and Snowboard Enthusiasts,88
Day Care Users,94
Exercise and Gym Researchers,96
Restaurant Researchers,98
Order-in Eaters,99
Plus Size Women,102
Cruise Travel Intenders,107
Womens Fashion Magazine Readers,114
Mortgage Researchers,119
Military Servicemembers & Veterans,123
Healthcare Discount Shoppers,124
Soccer Fans,126
Kitchen & Bathroom Remodelers,128
Online Alcohol Shoppers,137
Home Kitchen Bakers,138
Pet Owners,140
Credit Card Researchers,142
Federal Employees,163
Social Liberals,169
Health & Fitness,4852
Business Accounting Software Researchers,4857
Adult Acne Sufferers,4904
Womens Health Researchers,4913
Arthritis Sufferers,4916
Tire Shoppers,4921
Gun Control Advocates,4925
Conservative Think Tank Readers,4935
Orthopedic Health Researchers,5896
Oncology Researchers,5898
Parents of High School Students,5945
Auto Insurance Shoppers,27
Jewelry & Watch Shoppers,37
Bed & Bath Shoppers,40
Online Investors,54
Discount Device Shoppers,56
Fantasy & Comic Fans,66
Healthy Eaters,69
Hardware Shoppers,83
Sale Seekers,86
Theme Park Researchers,87
Parents with Kids,92
Stay-at-Home Parents,95
Android Fans,131
Health Insurance Researchers,143
Travel Reward Points Enthusiasts,161
Doves,166
Voters,170
Working Parents,4848
Credit Union Researchers,4894
Heartburn Sufferers,4905
Sinus Researchers,4906
First Aid Researchers,4909
Surfers,4924
Marijuana Legalization Advocates,4931
Pre-Measured Grocery Shoppers,4944
Diabetes,5901
Credit Score Researchers,5911
Business Decision Makers,5920
Tax Filers,5930
Australia Trip Planners,5952
New Homeowners,5962
Readers of Arabic Content,5971
Financial Investors,5972
Readers of African American Content,5999
Readers of Tamil Content,6047
Italian Chain Restaurant Eaters,6062
Solar Energy Solution Shoppers,6064
Media Buying Professionals,6084
Whiskey Lovers,6088
Readers of Cuban Content,6122
Misc-Deal Seekers or Coupon Shoppers,6123
Fantasy Football Enthusiasts,6133
Fast Food Lovers,6145
Christmas Enthusiasts,6168
High-End Camera Shoppers,6171
Finance Continuing Education Researchers,6182
High End TV Shoppers,6188
Divorcees,6226
Yachting Enthusiasts,6234
Environmental Activists,6255
Word Game Enthusiasts,6259
Blockbuster Movie Fans,6260
Competitive Tri-Athletes,6285
Atlanta Trip Planners,6303
Miami Trip Planners,6320
Supermarket Shoppers,6334
Executive and C-Suite,6365
Readers of South American Content,7598
Seattle Seahawks Fans,10869
Halloween Thrill Seekers,10972
Civil Engineers,11977
Alzheimer and Dementia Researchers,19297
France Trip Planners,19603
Postal Employees,125
Teachers,28
Home Decor Shoppers,31
Intimates Shoppers,41
Charitable Donors,48
Ink & Toner Shoppers,75
Young Boomers,93
J
Query:
SELECT "interest_id", "composition"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
WHERE "composition" < 5
LIMIT 1000;
Answer:
Too long, hard cut:
interest_id,composition
17320.0,3.98
88.0,4.99
6133.0,3.82
33191.0,3.99
20817.0,3.62
20814.0,3.89
14.0,3.53
126.0,3.8
19578.0,4.14
6263.0,4.98
5984.0,4.9
6235.0,4.67
6077.0,4.83
155.0,4.97
19627.0,3.98
17318.0,4.93
83.0,4.04
21236.0,4.04
21238.0,4.92
80.0,4.47
21239.0,3.52
19628.0,4.66
18995.0,4.97
19590.0,4.59
22095.0,4.54
145.0,4.89
19297.0,4.26
10870.0,3.29
6160.0,4.93
18998.0,4.12
6314.0,3.77
20815.0,3.03
6024.0,4.7
6067.0,4.71
17672.0,4.09
6234.0,4.26
7535.0,4.18
5958.0,4.27
157.0,4.94
6177.0,4.41
143.0,4.68
4930.0,4.37
30.0,3.0
19617.0,4.07
5956.0,4.65
4928.0,4.76
59.0,3.97
14901.0,3.75
55.0,4.0
6321.0,4.97
6320.0,4.72
6030.0,3.85
168.0,3.75
134.0,4.54
32485.0,4.31
17271.0,3.74
6209.0,4.45
6169.0,3.8
142.0,4.73
6131.0,2.81
19625.0,4.32
28.0,4.84
6194.0,4.39
19633.0,3.17
10832.0,4.4
19606.0,4.42
6088.0,4.28
19623.0,4.6
11065.0,4.22
18.0,3.18
4916.0,4.29
6331.0,3.49
4936.0,4.54
22426.0,3.78
146.0,3.69
7534.0,4.22
20766.0,4.33
62.0,4.15
5933.0,4.37
5909.0,3.76
22093.0,4.34
10872.0,2.62
124.0,4.46
6393.0,2.91
32701.0,4.23
50.0,3.07
20755.0,4.77
20751.0,3.94
12821.0,4.63
6253.0,4.18
54.0,3.42
14800.0,4.11
5916.0,4.63
21241.0,3.47
6174.0,4.1
81.0,3.31
7464.0,3.52
6212.0,4.13
6300.0,4.91
170.0,4.76
10009.0,4.56
18807.0,4.1
6386.0,3.73
32705.0,4.38
42.0,4.9
6335.0,4.41
4899.0,3.1
108.0,4.24
6168.0,4.35
6222.0,3.49
71.0,3.43
20.0,4.08
6391.0,4.0
6159.0,4.06
6149.0,4.1
19878.0,3.35
7543.0,4.12
10834.0,4.6
22406.0,3.38
7536.0,3.05
10364.0,2.9
6367.0,3.78
129.0,3.62
25.0,4.31
21240.0,3.04
6231.0,4.12
6226.0,3.95
19607.0,3.27
4903.0,3.63
110.0,4.1
6216.0,3.19
17452.0,4.24
20816.0,2.79
5934.0,3.46
7454.0,4.38
4867.0,2.84
10251.0,3.21
20730.0,3.73
6257.0,4.49
7546.0,4.72
18924.0,4.13
5925.0,3.97
4908.0,3.29
19593.0,2.89
5917.0,4.04
6230.0,4.39
19611.0,2.95
22400.0,3.77
4935.0,4.46
6325.0,4.66
6317.0,4.28
5936.0,3.78
18783.0,4.87
7597.0,3.18
17669.0,3.92
7685.0,3.77
7545.0,4.19
15879.0,3.85
4932.0,4.18
6345.0,3.94
4937.0,3.77
4858.0,3.59
17729.0,3.48
4906.0,3.09
10970.0,4.04
5929.0,4.46
22422.0,3.12
19519.0,4.02
6303.0,3.87
22417.0,3.95
10975.0,3.98
22401.0,3.62
6098.0,3.99
118.0,3.83
12032.0,3.77
6385.0,3.26
6124.0,3.51
10836.0,4.18
32702.0,3.56
4933.0,3.46
10973.0,4.06
6215.0,3.21
10871.0,2.94
19612.0,2.57
5967.0,2.57
10974.0,4.46
5897.0,3.72
6010.0,2.76
21326.0,4.3
22421.0,3.2
7483.0,3.4
6156.0,2.99
5945.0,4.87
10249.0,4.48
6188.0,2.85
6387.0,3.89
19520.0,3.64
140.0,3.31
19759.0,3.23
16196.0,3.98
6390.0,3.6
112.0,2.95
7541.0,4.7
7542.0,4.31
6339.0,3.79
78.0,2.69
10010.0,3.25
6122.0,2.85
6049.0,2.54
20754.0,3.09
53.0,3.03
19634.0,2.53
46.0,3.4
17670.0,2.76
6333.0,3.5
19594.0,2.48
6189.0,3.03
4931.0,4.05
7.0,2.64
5922.0,3.13
6008.0,3.22
6389.0,3.39
22092.0,3.78
57.0,2.32
10979.0,3.28
19618.0,3.03
6306.0,3.04
19251.0,3.59
10326.0,3.96
14895.0,2.59
19602.0,2.79
4927.0,3.19
7544.0,3.37
6259.0,2.51
94.0,3.52
166.0,3.01
4929.0,3.33
22420.0,4.37
4896.0,3.09
6034.0,3.25
6224.0,3.68
5926.0,3.48
5971.0,2.5
84.0,3.42
21.0,2.63
19629.0,2.54
4921.0,2.83
22398.0,3.52
5962.0,3.13
19624.0,2.84
6120.0,2.79
18203.0,2.9
22091.0,3.99
19622.0,2.97
19605.0,3.15
6138.0,2.83
6225.0,3.31
72.0,3.63
123.0,2.83
19609.0,2.43
6223.0,3.45
4926.0,2.92
136.0,2.03
6332.0,2.62
14801.0,2.66
15883.0,1.97
21249.0,3.11
19601.0,2.13
21248.0,2.88
6236.0,2.29
11066.0,3.5
22415.0,3.1
21243.0,2.53
10366.0,2.36
22094.0,2.97
21247.0,2.65
121.0,2.44
19608.0,2.15
10955.0,2.94
19615.0,2.01
5904.0,2.14
5900.0,2.3
58.0,2.18
10007.0,2.45
21251.0,2.85
15884.0,1.82
154.0,2.61
19620.0,2.37
106.0,1.83
6048.0,2.49
10971.0,2.67
7598.0,2.61
19626.0,1.99
17274.0,1.86
19589.0,2.34
13428.0,2.23
11977.0,2.27
19631.0,2.15
20752.0,2.22
19597.0,2.45
19591.0,1.9
19635.0,2.05
19632.0,1.96
19599.0,1.92
6364.0,2.91
22408.0,2.12
16198.0,1.74
6047.0,2.04
10954.0,1.88
51.0,2.67
18348.0,2.05
10953.0,1.81
2.0,1.81
19616.0,2.31
15878.0,2.28
21250.0,2.25
4872.0,2.27
15882.0,1.73
19596.0,2.09
21246.0,2.26
6363.0,2.16
21244.0,2.23
6065.0,1.71
6050.0,1.77
16.0,4.65
34465.0,3.34
17.0,3.94
17320.0,3.24
11067.0,4.92
79.0,4.49
34463.0,3.06
4902.0,4.9
31.0,4.68
18923.0,4.0
6315.0,4.36
4914.0,3.73
7537.0,4.91
34464.0,3.0
88.0,3.94
49.0,4.11
33959.0,2.54
34469.0,4.54
33971.0,4.92
98.0,4.79
6051.0,4.41
11975.0,4.73
6250.0,4.03
4924.0,4.62
35.0,4.14
6143.0,4.12
33474.0,4.01
18648.0,4.21
33191.0,3.76
17673.0,4.88
34462.0,2.73
6108.0,3.45
100.0,3.59
21238.0,4.94
5963.0,3.98
6323.0,4.9
34082.0,3.45
69.0,3.5
6133.0,2.88
96.0,3.39
6263.0,4.31
34574.0,2.99
1.0,3.44
56.0,4.1
6085.0,4.09
5952.0,4.31
33960.0,2.68
5910.0,4.87
6111.0,4.11
132.0,4.04
33967.0,2.85
126.0,4.02
6235.0,3.81
6106.0,2.93
18995.0,4.93
5991.0,4.24
37.0,4.51
130.0,4.7
11974.0,3.7
6255.0,4.61
6089.0,2.63
83.0,3.57
138.0,4.14
60.0,3.93
4911.0,3.47
101.0,4.1
18621.0,4.37
20817.0,2.56
155.0,4.2
19578.0,3.18
4852.0,3.22
17318.0,4.34
6393.0,3.17
103.0,2.69
22095.0,3.84
6217.0,4.2
80.0,3.76
20767.0,4.69
6077.0,3.67
34461.0,3.31
18997.0,4.91
161.0,4.31
4912.0,4.61
21236.0,4.47
34466.0,2.41
33963.0,2.38
4928.0,4.39
14901.0,3.51
33969.0,2.59
6151.0,2
Query:
SELECT "interest_id", "composition"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS
ORDER BY "composition" DESC
LIMIT 1000
Answer:
Too long, hard cut:
interest_id,composition
21057.0,21.2
21057.0,20.28
21057.0,19.45
21057.0,18.99
6284.0,18.82
21057.0,18.39
21057.0,18.18
39.0,17.44
77.0,17.19
12133.0,15.15
5969.0,15.05
5969.0,14.92
5969.0,14.92
171.0,14.91
5969.0,14.39
5969.0,14.29
4898.0,14.23
5969.0,14.15
6286.0,14.1
4.0,13.97
6284.0,13.9
12133.0,13.81
17786.0,13.67
12133.0,13.64
6184.0,13.35
19298.0,13.03
4897.0,12.93
5968.0,12.87
19298.0,12.85
12133.0,12.8
77.0,12.73
12133.0,12.68
6284.0,12.64
12133.0,12.64
19298.0,12.62
19613.0,12.62
6.0,12.56
6286.0,12.47
21057.0,12.42
64.0,12.41
6286.0,12.41
64.0,12.33
5969.0,12.3
22403.0,12.27
12133.0,12.26
19423.0,12.22
10977.0,12.16
39.0,12.03
6.0,11.99
158.0,11.97
64.0,11.93
19298.0,11.93
32486.0,11.89
64.0,11.75
77.0,11.74
19298.0,11.74
77.0,11.73
6277.0,11.72
19298.0,11.71
115.0,11.68
5938.0,11.63
6334.0,11.63
19621.0,11.61
6110.0,11.57
10977.0,11.57
6286.0,11.5
161.0,11.48
10250.0,11.4
17730.0,11.38
19298.0,11.27
34.0,11.23
79.0,11.21
6286.0,11.18
5969.0,11.15
6286.0,11.14
39.0,11.1
6.0,11.08
6284.0,11.06
6284.0,11.06
5991.0,11.04
6.0,11.03
5969.0,11.01
19621.0,11.0
6286.0,10.99
64.0,10.99
10977.0,10.96
19757.0,10.95
21057.0,10.95
6284.0,10.91
133.0,10.91
10250.0,10.89
10977.0,10.88
40.0,10.86
18923.0,10.85
5969.0,10.85
69.0,10.82
5.0,10.82
6217.0,10.8
12133.0,10.79
100.0,10.77
6206.0,10.76
6111.0,10.71
4943.0,10.7
64.0,10.69
10981.0,10.62
6284.0,10.61
5960.0,10.61
10977.0,10.61
6.0,10.57
6343.0,10.54
10977.0,10.52
5960.0,10.52
12133.0,10.51
10977.0,10.5
6343.0,10.48
41548.0,10.46
6284.0,10.43
17314.0,10.43
77.0,10.42
5960.0,10.4
6343.0,10.38
21237.0,10.36
6344.0,10.32
19621.0,10.31
6324.0,10.3
4870.0,10.29
77.0,10.28
19298.0,10.27
12133.0,10.26
5944.0,10.24
158.0,10.23
6228.0,10.22
6343.0,10.15
89.0,10.14
6286.0,10.12
19422.0,10.11
10981.0,10.09
39.0,10.08
34.0,10.07
10250.0,10.06
39.0,10.05
6029.0,10.05
34.0,10.04
19621.0,10.0
82.0,9.99
77.0,9.99
7541.0,9.98
6232.0,9.97
4943.0,9.97
6285.0,9.97
6343.0,9.96
10977.0,9.95
6106.0,9.93
39.0,9.93
4943.0,9.91
10981.0,9.91
7541.0,9.88
19621.0,9.86
41548.0,9.85
10981.0,9.85
18783.0,9.83
5960.0,9.82
6343.0,9.81
6.0,9.79
92.0,9.77
77.0,9.76
21237.0,9.72
6214.0,9.71
64.0,9.7
6208.0,9.67
,9.66
16137.0,9.65
39.0,9.65
10981.0,9.65
6378.0,9.64
4943.0,9.63
7541.0,9.62
77.0,9.61
18783.0,9.6
7541.0,9.6
158.0,9.57
64.0,9.57
5960.0,9.55
158.0,9.51
6123.0,9.49
6.0,9.48
38.0,9.48
4895.0,9.47
10008.0,9.46
5960.0,9.46
4944.0,9.46
141.0,9.46
6284.0,9.43
19298.0,9.43
39.0,9.43
63.0,9.37
6013.0,9.35
34.0,9.34
6308.0,9.33
10250.0,9.33
6343.0,9.31
19621.0,9.31
7541.0,9.3
10250.0,9.3
6218.0,9.29
36.0,9.27
6284.0,9.25
6.0,9.25
34.0,9.24
39.0,9.23
,9.23
7541.0,9.23
6112.0,9.22
5970.0,9.21
21237.0,9.2
19621.0,9.19
6343.0,9.18
10250.0,9.18
18619.0,9.15
15935.0,9.13
141.0,9.13
115.0,9.12
6286.0,9.11
41548.0,9.1
6286.0,9.1
19621.0,9.08
34.0,9.08
19298.0,9.06
141.0,9.06
10981.0,9.06
18783.0,9.04
18783.0,9.04
13497.0,9.03
115.0,8.98
4944.0,8.98
21061.0,8.97
4943.0,8.96
141.0,8.96
10009.0,8.95
7541.0,8.94
4944.0,8.91
10250.0,8.9
18783.0,8.87
10250.0,8.85
158.0,8.84
6107.0,8.84
6206.0,8.82
4943.0,8.81
16138.0,8.81
64.0,8.8
10981.0,8.77
6029.0,8.72
5960.0,8.7
21237.0,8.69
5911.0,8.69
89.0,8.67
21237.0,8.66
60.0,8.66
15879.0,8.65
17269.0,8.64
,8.62
,8.62
5944.0,8.59
,8.59
21060.0,8.58
30.0,8.56
89.0,8.55
7425.0,8.54
18783.0,8.51
41548.0,8.5
6336.0,8.5
21058.0,8.5
141.0,8.49
34.0,8.48
89.0,8.48
13497.0,8.47
21061.0,8.46
77.0,8.46
5944.0,8.46
12025.0,8.45
158.0,8.45
19295.0,8.44
12025.0,8.44
4944.0,8.44
7541.0,8.43
6324.0,8.43
158.0,8.43
6285.0,8.41
64.0,8.41
4943.0,8.38
5944.0,8.37
10981.0,8.36
6206.0,8.35
4944.0,8.32
12027.0,8.32
107.0,8.32
141.0,8.31
6304.0,8.31
13497.0,8.31
10977.0,8.3
4943.0,8.29
6285.0,8.29
18783.0,8.28
4944.0,8.28
5944.0,8.28
89.0,8.27
34.0,8.26
,8.25
5970.0,8.25
4944.0,8.25
22502.0,8.24
18202.0,8.23
89.0,8.23
21237.0,8.22
,8.21
6171.0,8.19
4902.0,8.17
39.0,8.17
7557.0,8.17
10988.0,8.17
10976.0,8.16
6343.0,8.15
6315.0,8.14
19621.0,8.14
5944.0,8.12
13497.0,8.12
13497.0,8.1
13497.0,8.1
19617.0,8.09
6211.0,8.09
17673.0,8.07
32704.0,8.04
22427.0,8.04
21060.0,8.02
6023.0,8.02
12025.0,7.99
4898.0,7.98
151.0,7.97
21061.0,7.95
137.0,7.94
4.0,7.94
11067.0,7.93
16119.0,7.93
6029.0,7.93
21237.0,7.92
89.0,7.92
6.0,7.9
171.0,7.9
6029.0,7.9
31.0,7.9
5895.0,7.89
17.0,7.89
17786.0,7.88
21060.0,7.88
17674.0,7.88
18783.0,7.87
34.0,7.87
5960.0,7.86
5898.0,7.85
10250.0,7.85
6029.0,7.85
18996.0,7.84
12025.0,7.83
7537.0,7.82
37.0,7.82
11975.0,7.81
6207.0,7.81
21061.0,7.81
7540.0,7.8
18347.0,7.8
141.0,7.8
,7.79
4912.0,7.77
141.0,7.77
19623.0,7.76
102.0,7.74
7425.0,7.74
7685.0,7.74
20767.0,7.73
,7.73
5970.0,7.73
5909.0,7.73
,7.72
22502.0,7.72
19250.0,7.7
6237.0,7.7
6264.0,7.7
21060.0,7.69
5960.0,7.69
5906.0,7.69
4944.0,7.68
19338.0,7.68
6029.0,7.68
4943.0,7.68
55.0,7.67
6308.0,7.67
5925.0,7.67
130.0,7.66
11067.0,7.66
6173.0,7.66
17785.0,7.66
7425.0,7.65
12025.0,7.64
5970.0,7.64
6217.0,7.64
98.0,7.64
21061.0,7.63
6329.0,7.63
18202.0,7.61
18202.0,7.6
6237.0,7.6
33.0,7.6
6220.0,7.59
13497.0,7.56
6285.0,7.
Query:
SELECT im."interest_id", m."interest_name", im."percentile_ranking"
FROM BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS im
JOIN BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP m
ON im."interest_id" = m."id"
LIMIT 1000
Answer:
Too long, hard cut:
interest_id,interest_name,percentile_ranking
32486.0,Vacation Rental Accommodation Researchers,99.86
6106.0,Luxury Second Home Owners,99.73
18923.0,Online Home Decor Shoppers,99.59
6344.0,Hair Care Shoppers,99.45
100.0,Nutrition Conscious Eaters,99.31
69.0,Healthy Eaters,99.18
79.0,Luxury Travel Researchers,99.04
6111.0,Wine Lovers,98.9
6214.0,Home Remodelers,98.9
19422.0,Home Design and Living Publication Readers,98.63
6110.0,Apartment Furniture Shoppers,98.49
4895.0,Mature Parents,98.35
6217.0,Weight Loss Researchers,98.22
4.0,Luxury Retail Researchers,98.08
6218.0,Running Enthusiasts,97.94
6123.0,Misc-Deal Seekers or Coupon Shoppers,97.81
171.0,Shoe Shoppers,97.67
19613.0,Land Rover Shoppers,97.53
17.0,MLB Fans,97.39
6.0,Vacation Planners,97.26
6013.0,Competitive Sports Participants,97.12
4870.0,Tech-Savvy Moms,96.98
19423.0,Kitchen Appliance Shoppers,96.84
6089.0,Mens Fitness Publication Readers,96.71
161.0,Travel Reward Points Enthusiasts,96.57
6286.0,Luxury Hotel Guests,96.57
5991.0,Gluten-Free Recipe Researchers,96.3
92.0,Parents with Kids,96.16
6184.0,Reusable Drinkware Shoppers,96.02
19621.0,Portugal Trip Planners,95.88
63.0,New & Expecting Parents,95.75
103.0,Live Concert Fans,95.61
38.0,Sporting Goods Shoppers,95.47
17786.0,Womens Fashion Brands Shoppers,95.34
6232.0,Golf Enthusiasts,95.2
165.0,Liberal News Readers,95.06
18351.0,Drama Show Watchers,94.92
15.0,NBA Fans,94.79
17314.0,Lobbyists,94.65
6151.0,Wedding Registrants,94.65
4914.0,Mens Health Researchers,94.65
115.0,Mens Shoe Shoppers,94.24
5968.0,Luxury Kitchen Goods Shoppers,94.24
36.0,Baby Products Buyers,93.96
5943.0,Financial News Readers,93.83
133.0,High End Camera Shoppers - Dupe,93.69
1.0,Fitness Enthusiasts,93.69
114.0,Womens Fashion Magazine Readers,93.42
6107.0,Ski House Second Home Owners,93.28
150.0,TV Junkies,93.28
60.0,Online Health Researchers,93.0
96.0,Exercise and Gym Researchers,92.87
22403.0,Pandora Jewelry Shoppers,92.73
40.0,Bed & Bath Shoppers,92.59
19758.0,Dog Lovers,92.59
17730.0,Luxury Department Store Shoppers,92.32
5938.0,Costa Rica Trip Planners,92.18
4869.0,Womens Fitness Enthusiasts,92.18
4897.0,Parents of Teenagers Going to College,91.91
6029.0,Indoor Cycling & Spinning Enthusiasts,91.77
31.0,Home Decor Shoppers,91.77
16137.0,Olympics Fans,91.5
6330.0,Pet Store Goers,91.36
6334.0,Supermarket Shoppers,91.36
6315.0,Boston Trip Planners,91.36
4852.0,Health & Fitness,90.95
16.0,NCAA Fans,90.95
6108.0,Beach House Second Home Owners,90.67
6206.0,Preppy Clothing Shoppers,90.67
6006.0,Breast Cancer Fund Raisers,90.4
6228.0,Paleo Eaters,90.4
20768.0,Beer Aficionados,90.4
4902.0,Yogis,89.99
6277.0,Harry Potter Fans,89.85
19757.0,Natural Pet Food Shoppers,89.71
4911.0,Dieters,89.71
4910.0,Cholesterol Researchers,89.44
6285.0,Competitive Tri-Athletes,89.3
11974.0,Price Conscious Home Shoppers,89.16
6219.0,Cycling Enthusiasts,89.16
10250.0,Halloween Costume Shoppers,88.89
6128.0,Realtors & Real Estate Researchers,88.75
5946.0,Readers of Filipinos Content,88.61
158.0,Flight and Hotel Shoppers,88.61
15935.0,Pregnancy Resources Researchers,88.34
4855.0,Entertainment & Tabloid Magazine Readers,88.2
149.0,Streaming Radio Listeners,88.2
16197.0,Financial Business Intelligence Researchers,87.93
11067.0,NCAA Football Fans,87.79
17674.0,Medical Advice Researchers,87.65
4913.0,Womens Health Researchers,87.65
56.0,Discount Device Shoppers,87.38
6341.0,Pharmacy Shoppers,87.38
6316.0,Philadelphia Trip Planners,87.38
18647.0,Gourmet Food & Wine Researchers,87.38
17803.0,TV Advertising Professionals,87.38
23.0,Techies,86.69
132.0,Apple Fans,86.56
6365.0,Executive and C-Suite,86.56
6378.0,Luggage Shoppers,86.28
17673.0,Coffee Chain Shoppers,86.15
97.0,Home Kitchen Chefs,86.15
7537.0,Ecommerce Platform Researchers,86.15
20764.0,Entertainment Industry Decision Makers,86.15
44.0,Home Buyers,85.6
5.0,Brides & Wedding Planners,85.6
6227.0,Personal Stock Portfolio Managers,85.6
19.0,Eco-Conscious Consumers,85.19
93.0,Young Boomers,85.19
6085.0,Discount Womens Shoes Shoppers,84.91
6112.0,Olympic Sports Enthusiasts,84.77
4873.0,TV Game Show Fans,84.64
11975.0,Landscape Architects,84.5
22502.0,Lacrosse Enthusiasts,84.36
86.0,Sale Seekers,84.36
19610.0,Jaguar Vehicle Shoppers,84.09
20753.0,Tesla Enthusiasts,83.95
24.0,Home Design Enthusiasts,83.95
20750.0,BMW Vehicle Shoppers,83.95
12133.0,Luxury Boutique Hotel Researchers,83.95
6141.0,Entrepreneurs,83.4
6172.0,Camera Review Readers,83.4
98.0,Restaurant Researchers,83.4
125.0,Postal Employees,82.99
17269.0,At-Home Gym Intenders,82.99
4943.0,Online Grocery Shoppers,82.72
18996.0,Investment Banking Professionals,82.72
13.0,Advertising Professionals,82.72
89.0,Travel Researchers,82.72
169.0,Social Liberals,82.17
101.0,Flower & Gift Basket Shoppers,82.17
6087.0,Metal and Rock Music Fans,81.89
104.0,Country Music Fans,81.89
6284.0,Gym Equipment Owners,81.89
7557.0,Tailgaters,81.89
37.0,Jewelry & Watch Shoppers,81.89
6084.0,Media Buying Professionals,81.21
8.0,Business News Readers,81.07
5969.0,Luxury B
End Exploring Related Columns
Task: Identify the top 10 and bottom 10 interest categories based on their highest composition values across all months. For each category, display the time(MM-YYYY), interest name, and the composition value

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Time,Interest Name,Composition Value
MM-YYYY:str,interest_name:str,value:float
...
```

To identify the top 10 and bottom 10 interest categories based on their highest composition values across all months, we would:

1. **Determine the Maximum Composition for Each Interest Category**: For each `interest_id` in the `INTEREST_METRICS` table, find the record with the highest `composition` value and note the corresponding `month_year`.

2. **Associate Interest Names**: Join these records with the `INTEREST_MAP` table on `interest_id` (from `INTEREST_METRICS`) and `id` (from `INTEREST_MAP`) to retrieve the `interest_name`.

3. **Select Top and Bottom Categories**: Order the results by the maximum `composition` value in descending order to identify the top 10 categories and in ascending order for the bottom 10 categories.

4. **Compile the Results**: For each of these categories, display the `Time` (in `MM-YYYY` format from `month_year`), `Interest Name`, and `Composition Value`.

**Note**: Without actual data, we list the expected column names and data types. The `...` indicates additional rows for the remaining categories..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'BANK_SALES_TRADING': {'BANK_SALES_TRADING': ['BITCOIN_MEMBERS', 'BITCOIN_PRICES', 'BITCOIN_TRANSACTIONS', 'CLEANED_WEEKLY_SALES', 'CUSTOMER_NODES', 'CUSTOMER_REGIONS', 'CUSTOMER_TRANSACTIONS', 'INTEREST_MAP', 'INTEREST_METRICS', 'SHOPPING_CART_CAMPAIGN_IDENTIFIER', 'SHOPPING_CART_EVENTS', 'SHOPPING_CART_EVENT_IDENTIFIER', 'SHOPPING_CART_PAGE_HIERARCHY', 'SHOPPING_CART_USERS', 'VEG_CAT', 'VEG_LOSS_RATE_DF', 'VEG_TXN_DF', 'VEG_WHSLE_DF', 'WEEKLY_SALES']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-20 19:11:47 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 19:11:47 - root - INFO - ```sql
WITH MaxCompositions AS (
    SELECT
        im."interest_id",
        im."month_year" AS "Time",
        m."interest_name" AS "Interest Name",
        im."composition" AS "Composition Value",
        ROW_NUMBER() OVER (PARTITION BY im."interest_id" ORDER BY im."composition" DESC, im."month_year") AS rn
    FROM 
        "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
    JOIN 
        "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
        ON im."interest_id" = m."id"
)
SELECT "Time", "Interest Name", "Composition Value"
FROM (
    SELECT "Time", "Interest Name", "Composition Value",
        ROW_NUMBER() OVER (ORDER BY "Composition Value" DESC, "Interest Name") AS rank_desc,
        ROW_NUMBER() OVER (ORDER BY "Composition Value" ASC, "Interest Name") AS rank_asc
    FROM MaxCompositions
    WHERE rn = 1
) sub
WHERE rank_desc <= 10 OR rank_asc <= 10
ORDER BY "Composition Value" DESC, "Interest Name";
```
2025-01-20 19:11:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:11:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:11:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:11:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-01-20 19:11:49 - snowflake.connector.connection - INFO - closed
2025-01-20 19:11:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:11:49 - root - INFO - itercount: 1
2025-01-20 19:11:49 - root - INFO - 0
2025-01-20 19:11:49 - root - INFO - results: 
Time,Interest Name,Composition Value
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
07-2018,Readers of Jamaican Content,1.86
02-2019,Automotive News Readers,1.84
07-2018,Comedy Fans,1.83
08-2019,World of Warcraft Enthusiasts,1.82
08-2018,Miami Heat Fans,1.81
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2019,Hearthstone Video Game Fans,1.66
09-2018,Scifi Movie and TV Enthusiasts,1.61
09-2018,Action Movie and TV Enthusiasts,1.59
03-2019,The Sims Video Game Fans,1.57


2025-01-20 19:11:49 - root - INFO - Please check the answer again by reviewing Identify the top 10 and bottom 10 interest categories based on their highest composition values across all months. For each category, display the time(MM-YYYY), interest name, and the composition value, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Time,Interest Name,Composition Value
MM-YYYY:str,interest_name:str,value:float
...
```

To identify the top 10 and bottom 10 interest categories based on their highest composition values across all months, we would:

1. **Determine the Maximum Composition for Each Interest Category**: For each `interest_id` in the `INTEREST_METRICS` table, find the record with the highest `composition` value and note the corresponding `month_year`.

2. **Associate Interest Names**: Join these records with the `INTEREST_MAP` table on `interest_id` (from `INTEREST_METRICS`) and `id` (from `INTEREST_MAP`) to retrieve the `interest_name`.

3. **Select Top and Bottom Categories**: Order the results by the maximum `composition` value in descending order to identify the top 10 categories and in ascending order for the bottom 10 categories.

4. **Compile the Results**: For each of these categories, display the `Time` (in `MM-YYYY` format from `month_year`), `Interest Name`, and `Composition Value`.

**Note**: Without actual data, we list the expected column names and data types. The `...` indicates additional rows for the remaining categories. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Time,Interest Name,Composition Value
12-2018,Work Comes First Travelers,21.2
07-2018,Gym Equipment Owners,18.82
07-2018,Furniture Shoppers,17.44
07-2018,Luxury Retail Shoppers,17.19
10-2018,Luxury Boutique Hotel Researchers,15.15
12-2018,Luxury Bedding Shoppers,15.05
07-2018,Shoe Shoppers,14.91
07-2018,Cosmetics and Beauty Shoppers,14.23
07-2018,Luxury Hotel Guests,14.1
07-2018,Luxury Retail Researchers,13.97
07-2018,Readers of Jamaican Content,1.86
02-2019,Automotive News Readers,1.84
07-2018,Comedy Fans,1.83
08-2019,World of Warcraft Enthusiasts,1.82
08-2018,Miami Heat Fans,1.81
07-2018,Online Role Playing Game Enthusiasts,1.73
08-2019,Hearthstone Video Game Fans,1.66
09-2018,Scifi Movie and TV Enthusiasts,1.61
09-2018,Action Movie and TV Enthusiasts,1.59
03-2019,The Sims Video Game Fans,1.57
Current sql:
WITH MaxCompositions AS (
    SELECT
        im."interest_id",
        im."month_year" AS "Time",
        m."interest_name" AS "Interest Name",
        im."composition" AS "Composition Value",
        ROW_NUMBER() OVER (PARTITION BY im."interest_id" ORDER BY im."composition" DESC, im."month_year") AS rn
    FROM 
        "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
    JOIN 
        "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
        ON im."interest_id" = m."id"
)
SELECT "Time", "Interest Name", "Composition Value"
FROM (
    SELECT "Time", "Interest Name", "Composition Value",
        ROW_NUMBER() OVER (ORDER BY "Composition Value" DESC, "Interest Name") AS rank_desc,
        ROW_NUMBER() OVER (ORDER BY "Composition Value" ASC, "Interest Name") AS rank_asc
    FROM MaxCompositions
    WHERE rn = 1
) sub
WHERE rank_desc <= 10 OR rank_asc <= 10
ORDER BY "Composition Value" DESC, "Interest Name";For tasks asking fullname or name, you may combine first name and last name into one column called name.
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-20 19:12:20 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 19:12:20 - root - INFO - ```sql
WITH MaxCompositions AS (
    SELECT
        im."interest_id",
        im."month_year" AS "Time",
        m."interest_name" AS "Interest Name",
        ROUND(im."composition", 4) AS "Composition Value",
        ROW_NUMBER() OVER (PARTITION BY im."interest_id" ORDER BY im."composition" DESC NULLS LAST, im."month_year") AS rn
    FROM 
        "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
    JOIN 
        "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
            ON im."interest_id" = m."id"
    WHERE im."composition" IS NOT NULL
)
SELECT "Time", "Interest Name", "Composition Value"
FROM (
    SELECT "Time", "Interest Name", "Composition Value",
        ROW_NUMBER() OVER (ORDER BY "Composition Value" DESC NULLS LAST, "Interest Name") AS rank_desc,
        ROW_NUMBER() OVER (ORDER BY "Composition Value" ASC NULLS LAST, "Interest Name") AS rank_asc
    FROM MaxCompositions
    WHERE rn = 1
) sub
WHERE rank_desc <= 10 OR rank_asc <= 10
ORDER BY "Composition Value" DESC NULLS LAST, "Interest Name";
```
2025-01-20 19:12:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 19:12:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 19:12:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 19:12:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-01-20 19:12:21 - snowflake.connector.connection - INFO - closed
2025-01-20 19:12:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 19:12:22 - root - INFO - itercount: 2
2025-01-20 19:12:22 - root - INFO - 0
2025-01-20 19:12:22 - root - INFO - Total iteration counts: 2
