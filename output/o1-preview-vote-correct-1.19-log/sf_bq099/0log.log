2025-01-20 01:02:33 - openai._base_client - INFO - Retrying request to /chat/completions in 0.499592 seconds
2025-01-20 01:04:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 01:04:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:04:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:04:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:04:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 01:04:15 - snowflake.connector.connection - INFO - closed
2025-01-20 01:04:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:04:15 - root - INFO - SQL:
SELECT f.value
   FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
   LIMIT 1000;
Results:
Too long, hard cut:
VALUE
"{
  ""code"": ""G06F1/3253"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06F1/266"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06F13/364"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06F1/3237"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06F1/266"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06F1/3237"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06F1/3253"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06F13/364"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""Y02D10/00"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""Y02D30/50"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""Y02D10/00"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""Y02D30/50"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""G06F13/364"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/08"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H03K2017/0806"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/687"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/082"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H03K2017/0806"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01L2224/73265"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01L2224/48091"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01L2924/13091"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/6871"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/687"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L2224/73265"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H03K2017/6875"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/102"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01L2924/13055"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/082"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/08"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H03K2017/6875"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01L2224/48091"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H03K2017/0806"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/102"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/687"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/6871"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L2924/13091"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/08104"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/08"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L2924/13055"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/08104"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H04N1/3877"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H04N1/3877"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06K15/1842"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H04N2201/0094"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H04N1/3877"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06K15/1886"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""B64C25/26"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""B64C25/26"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L31/022425"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""Y10T428/24917"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01L31/028"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L31/022458"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C30B29/06"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""Y10T428/24917"",
  ""first"": false,

2025-01-20 01:04:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:04:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:04:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:04:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 01:04:17 - snowflake.connector.connection - INFO - closed
2025-01-20 01:04:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:04:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 01:04:30 - root - INFO - ```sql
SELECT f.value::VARIANT:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
LIMIT 1000;
```
2025-01-20 01:04:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:04:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:04:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:04:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 01:04:32 - snowflake.connector.connection - INFO - closed
2025-01-20 01:04:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:05:51 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 01:05:51 - root - INFO - SQL:
SELECT f.value::VARIANT:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
LIMIT 1000;
Results:
Too long, hard cut:
cpc_code
H01L2223/665
H01L29/0821
H01L29/36
H03F3/195
H03F3/213
H01L2223/6655
H01L29/365
H01L23/66
H01L29/737
H01L29/7325
H01L29/0821
H01L29/205
H01L29/73
H01L2223/6677
H01L29/7371
H01L29/0826
H01L29/165
H01L29/66242
H03F2200/451
H01L29/7378
H01L29/7371
H01L29/36
H01L2223/6683
H01L2223/6683
H01L2223/6655
H03F3/195
H01L29/7371
H01L29/365
H01L29/165
H01L29/0821
H01L29/66242
H01L23/66
H01L29/205
H01L29/737
H01L29/0826
H01L29/36
H01L29/7378
H01L2223/665
H01L29/73
H01L29/7325
H01L2223/6677
H01L29/365
Y10T29/4984
F26B15/12
F26B15/122
F26B25/004
F26B2210/14
F26B15/122
Y10T29/4984
F26B2210/14
F26B15/122
F26B25/004
F26B15/12
Y10T29/4984
F26B2210/14
B23C5/2213
B23C2200/367
B23C2210/161
B23C2226/315
B23C2210/168
B23C5/22
B23C2226/125
B23C2200/367
B23C2220/00
B23C5/22
B23C5/22
B23C2220/00
B23C2210/161
B23C5/2298
G06F1/1656
H04M1/185
H04M1/21
G06F1/1626
H04B1/3888
F24V30/00
H04M1/21
H04M1/185
H04B1/3888
G06F1/1656
G06F1/1626
F24V30/00
G06F1/1656
G06F1/1626
F24V30/00
H04M1/21
H04M1/185
H04B1/3888
H05B45/20
H05B47/19
H05B45/20
H05B45/24
F21V33/00
F21V3/02
F21S9/02
F21Y2113/10
F21Y2115/10
F21S10/00
F21V31/00
F21V33/008
A01K85/01
A01K79/02
F21Y2115/10
F21V31/00
A01K69/06
F21V3/0625
A01K75/02
F21L4/08
F21V31/00
F21V33/008
H05B37/0272
F21Y2115/10
F21V3/0625
H05B33/0866
A01K85/01
F21L4/08
H05B33/086
A01K85/01
A01K85/01
A01K79/02
A01K79/02
A01K75/02
H05B47/19
G06F8/65
G06F8/65
G06F8/71
G06F8/654
G06F8/61
H04L41/082
H04L41/082
G06F8/61
G06F8/71
G06F8/654
G06F8/65
H04L43/0811
H04L41/0654
H04L41/0654
H04L2012/40273
H04L12/40
H04L2012/40215
H04L2012/40273
H04L12/40176
H04L2012/40215
H04L2012/40273
H04L2012/40215
H04L12/40
H04L41/0654
H04L12/40006
H04L12/40176
H04L12/40006
H04L43/0811
A61B5/7475
A61B5/14532
G16H20/10
A61B5/7475
A61B5/14532
A61B5/14546
G16H40/63
G08B21/24
A61B5/14546
A61B5/7475
A61B5/14532
G04G13/02
A61B5/00
G16H40/63
G08B21/24
G16H40/63
A62C37/04
G01M3/045
G05B19/042
A62C35/68
A62C3/004
G05B2219/2625
A62C37/36
A62C37/50
G01N17/043
G05B19/042
A62C37/36
G05B2219/2625
A62C37/04
A62C35/62
G01N17/043
A62C3/004
A62C35/68
A62C35/62
G01M3/045
A62C37/50
A01K91/065
A01K91/065
A01K93/00
A01K93/00
A01K97/01
A01K93/00
A01K97/01
H04L67/325
H04L67/1097
H04L67/2852
H04L67/5682
H04L67/60
H04L67/62
H04L67/60
G06F16/182
H04L67/1097
G06F16/182
H04L67/1097
H04L49/1507
H04L49/1515
H04Q11/0062
H04B10/40
H04L12/4625
H04Q2011/006
H04B10/25
H04Q11/0003
H04Q2011/0096
H04Q11/0071
H04Q2011/0098
H04L12/44
H04L41/0826
H04L12/4625
H04L47/125
H04Q2011/0098
H04Q2011/0096
H04Q11/0071
H04L45/122
H04L41/12
H04L47/125
H04L41/12
H04Q2011/0096
H04L45/122
H04L12/44
H04Q2011/0098
H04L41/0826
H04Q11/0071
H04Q2011/0096
H04Q2011/006
H04Q2011/0052
H04Q11/0071
H04Q11/0062
H04Q11/0005
H04Q11/0003
H04L49/1515
H04L49/15
H04L47/125
H04L45/122
H04L41/0826
H04L12/4625
H04L12/44
H04B10/25
H04B10/40
H04L41/12
H04L41/12
H01S5/0237
H01L24/03
H01S5/02345
H01S5/0237
H01L2924/12042
H01L2224/04026
H01L24/32
H01L2224/83801
H01L2224/29111
H01L2224/29144
H01L2224/0383
H01L2224/29144
H01L2224/32245
H01L2224/05684
H01L2924/15747
H01L2224/29109
H01L2224/29139
H01L2224/05681
H01L2224/29139
H01L2224/05573
H01L2224/32245
H01L2224/29111
H01L2224/0568
H01L2224/05681
H01L2224/05684
H01L24/83
H01L2924/12042
H01S5/02212
H01L24/29
H01L2924/15747
H01L2224/0567
H01L24/05
H01L2224/05686
H01L2224/05666
H01L24/83
H01L2224/05664
H01S5/02212
H01L2224/0383
H01L2224/04026
H01L2224/29109
H01L24/32
H01L2224/05624
H01L2224/05666
H01L24/29
G01N2021/399
H01L2224/05663
H01L2224/05669
H01L2224/0567
H01L2224/05686
H01L2224/05664
H01L2224/05669
H01L24/03
H01L2224/05573
H01L24/05
H01S5/068
H01L2224/83801
H01L2224/05624
G01N21/39
H01L2224/05663
H01L2224/0568
G01N2021/399
H01S5/02272
H01S5/068
G01N21/39
H05K5/0204
H05K5/0204
H05K7/183
G12B9/10
G12B9/10
H05K5/0204
H05K7/183
G01C21/3438
G01C21/343
H04W4/02
H04W4/40
G06Q30/0643
G06Q10/02
G06Q10/047
G06Q30/06
G06Q10/063
G01C21/343
G01C21/362
G01C21/343
G05D1/0287
G05D2201/0213
G05D1/0088
G01C21/362
G06Q30/0639
G06Q10/08
G05D1/0287
G05D1/0088
H04W72/569
H04W72/569
H04W74/0841
H04L1/1607
H04L5/14
H04W76/11
H04L5/005
H04W72/0446
H04W76/11
H04L1/1607
H04L5/005
H04L5/14
H04W72/0446
H04W74/0841
H04W72/569
H04W72/21
H04W72/0453
H04W72/0446
H04W52/146
H04L5/0053
H04L5/0051
H04L1/0013
H02P6/182
H02P25/089
G01R27/2611
H02P6/16
H02P6/182
H02P25/089
G01R27/2611
H02P6/182
H02P6/185
H02P6/16
C12N9/1029
C07K2319/00
C12N9/1029
C07K2319/00
C12N9/1029
C07K2319/00
B62D21/15
B60K1/04
B62D21/09
B60K2001/0438
B60K1/04
B60K2001/0438
B60K2001/0438
B60K1/04
B60K1/04
B60K2001/0438
F16L23/06
F16L37/18
F16L37/18
H04L41/0894
H04L45/42
H04L63/0227
H04L47/122
H04L41/12
H04L63/20
H04L45/04
H04L41/0893
H04L41/0893
H04L41/12
H04L63/0227
H04L63/20
H04L63/0263
C04B35/2683
C04B35/26
C04B2235/3286
C04B35/26
C04B2235/3418
C04B35/2641
C04B2235/3418
C04B2235/3224
C04B35/2608
C04B2235/3201
C04B2235/80
C04B2235/3213
C04B2235/96
C04B35/622
C04B2235/3217
C04B2235/3293
C04B2235/767
C04B2235/3275
C04B2235/3213
C04B2235/3229
C04B2235/3229
C04B2235/3201
C04B2235/3286
C04B2235/3232
C04B2235/3262
H01Q7/06
C04B2235/

2025-01-20 01:05:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:05:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:05:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:05:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 119
2025-01-20 01:05:52 - snowflake.connector.connection - INFO - closed
2025-01-20 01:05:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:05:53 - root - INFO - SQL:
-- Corrected Query 1
SELECT DISTINCT t."publication_number"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A01B3%'
LIMIT 1000
Results:
publication_number
BE-826346-A
PL-440426-A1
US-2784656-A
AU-2016269849-A1
US-159642-A
KR-102484290-B1
KR-100626846-B1
ZA-808003-B
BE-1007083-A5
KR-20020000597-A
DE-102017102683-A1
EP-3474651-C0
CN-114651538-A
KR-101378314-B1
US-1412308-A
GB-2039201-B
KR-101593221-B1
DE-463858-C
CN-107646212-A
CN-113796181-A
US-130700-A
FR-508965-A
CA-2977468-A1
DE-1963184-U
DE-140654-C
CN-113761309-A
KR-102593393-B1
US-5845717-A
US-10375891-B2
KR-101169320-B1
US-5267618-A
US-5669452-A
GB-2090713-B
CN-107072143-A
KR-200473688-Y1
IL-268624-A
CN-100366901-C
GB-2598141-A
NL-7909063-A
AU-2002301383-B2
NO-910950-L
EP-3586579-A1
KR-20020067218-A
GB-696973-A
CA-997451-A
US-828171-A
US-1471180-A
CA-2945250-A1
CN-115362764-A
GB-2089182-B
DE-829523-C
FR-2943502-A1
US-5407014-A
US-1860534-A
JP-S6342702-Y2
KR-20070101567-A
BE-872468-A
GB-792883-A
JP-6998053-B2
US-395573-A
US-231385-A
US-376176-A
US-1636048-A
CN-104040083-B
US-2843032-A
KR-100191418-B1
US-3054462-A
CN-109005687-A
US-3963079-A
IT-8519066-A1
CA-3089518-A1
AU-7115874-A
CN-106973572-B
CN-108289407-A
CN-114916261-A
CN-108575125-A
KR-20130063834-A
US-1545136-A
AT-A720679-A
US-290366-A
HU-E050035-T2
KR-20010029583-A
US-469659-A
US-220177-A
GB-436304-A
US-2888084-A
CA-2543900-A1
NL-183071-C
FR-2287837-B1
DE-8707829-U1
KR-200487998-Y1
FR-960102-A
US-501724-A
IT-1064821-B
BE-727862-A
KR-200386017-Y1
RU-191537-U1
US-2039702-A
KR-200194260-Y1
NO-153631-B
US-694931-A
KR-200149462-Y1
US-2019324472-A1
IT-1166526-B
US-1093294-A
KR-900006618-B1
US-2031188-A
US-1081539-A
US-2545590-A
US-3129772-A
CN-109392332-A
CN-116671357-A
US-2024164239-A1
DE-102010019819-B4
CN-105325075-A
US-2597821-A
JP-6910281-B2
CN-107094377-A
US-530054-A

2025-01-20 01:05:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:05:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:05:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:05:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 01:05:54 - snowflake.connector.connection - INFO - closed
2025-01-20 01:05:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:05:55 - root - INFO - SQL:
-- Corrected Query 2
SELECT f.value
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."assignee_harmonized") f
LIMIT 1000
Results:
Too long, hard cut:
VALUE
"{
  ""country_code"": ""US"",
  ""name"": ""PSIQUANTUM CORP""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""TYCO FIRE PRODUCTS LP""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""BLACK & DECKER INC""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""SAFRAN""
}"
"{
  ""country_code"": ""CN"",
  ""name"": ""GUANGDONG OPPO MOBILE TELECOMMUNICATIONS CORP LTD""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""PREC BIOSCIENCES INC""
}"
"{
  ""country_code"": ""IT"",
  ""name"": ""AREA IMPIANTI S P A""
}"
"{
  ""country_code"": ""SE"",
  ""name"": ""CANDELA TECH AB""
}"
"{
  ""country_code"": ""PL"",
  ""name"": ""UNIV PRZYRODNICZY W POZNANIU""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""TOTALENERGIES ONE TECH""
}"
"{
  ""country_code"": ""DE"",
  ""name"": ""BOSCH GMBH ROBERT""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""MICROSOFT TECHNOLOGY LICENSING LLC""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""PANASONIC IP MAN CO LTD""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""NAUTILUS SUBSIDIARY INC""
}"
"{
  ""country_code"": ""CN"",
  ""name"": ""VIVO MOBILE COMMUNICATION CO LTD""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""INST NAT SANTE RECH MED""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""HOPITAUX PARIS ASSIST PUBLIQUE""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""UNIV VERSAILLES SAINT QUENTIN EN YVELINES""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""LEXAT""
}"
"{
  ""country_code"": ""KR"",
  ""name"": ""KMW INC""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""PANASONIC IP MAN CO LTD""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""MEDTRONIC INC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""CNH IND AMERICA LLC""
}"
"{
  ""country_code"": ""CN"",
  ""name"": ""HONOR DEVICE CO LTD""
}"
"{
  ""country_code"": ""DE"",
  ""name"": ""BAYER AG""
}"
"{
  ""country_code"": ""DE"",
  ""name"": ""SIEMENS AG""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""FRANCE ETAT""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""JOHNSON ROBERT ROYCE""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""CALGON CARBON CORP""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""RENAULT""
}"
"{
  ""country_code"": ""IT"",
  ""name"": ""WEBER SPA""
}"
"{
  ""country_code"": ""AT"",
  ""name"": ""INJECT STAR POEKELMASCH""
}"
"{
  ""country_code"": ""NL"",
  ""name"": ""UITERT SPEC MASCHF VAN""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""MOTOROLA INC""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""SIGMA ENTERPRISES INC""
}"
"{
  ""country_code"": """",
  ""name"": ""WALTER IGNAZ""
}"
"{
  ""country_code"": ""AT"",
  ""name"": ""ROHRMOSER ALOIS SKIFABRIK""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""MITSUI TOATSU CHEMICALS""
}"
"{
  ""country_code"": ""IT"",
  ""name"": ""MONTEDISON SPA""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""MICROBIAL CHEM RES FOUND""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""ROCKWELL CIM""
}"
"{
  ""country_code"": ""AU"",
  ""name"": ""COMMW SCIENT IND RES ORG""
}"
"{
  ""country_code"": ""DE"",
  ""name"": ""HOESCH STAHL AG""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""CIBEVIAL""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""IMEDEX""
}"
"{
  ""country_code"": ""DE"",
  ""name"": ""EM TECH GMBH""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""STANLEY WORKS LTD""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""APPLIED MED RES LTD""
}"
"{
  ""country_code"": ""DE"",
  ""name"": ""BAYER AG""
}"
"{
  ""country_code"": ""CH"",
  ""name"": ""CABLOPTIC SA""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""US GOV HEALTH & HUMAN SERV""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""RENAULT""
}"
"{
  ""country_code"": ""DE"",
  ""name"": ""TILLACK JOACHIM""
}"
"{
  ""country_code"": ""SE"",
  ""name"": ""CELLECO HEDEMORA AB""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""GREEN CROSS CORP""
}"
"{
  ""country_code"": ""DE"",
  ""name"": ""KURHESSISCHE MOLKEREIZENTRALE""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""IBM""
}"
"{
  ""country_code"": ""GB"",
  ""name"": ""SMITHKLINE BEECHAM PLC""
}"
"{
  ""country_code"": ""DE"",
  ""name"": ""JOHANN PEFFEKOEVER GMBH & CO K""
}"
"{
  ""country_code"": ""IT"",
  ""name"": ""OCEAN IDROCLIMA S P A""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""SERVICE DE MACHINES ET OUTILLA""
}"
"{
  ""country_code"": ""DE"",
  ""name"": ""BALCKE DUERR GMBH""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""SALOMON SA""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""KONISHIROKU PHOTO IND""
}"
"{
  ""country_code"": ""DK"",
  ""name"": ""DSC COMMUNICATIONS AS""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""USF FILTRATION & SEPARATIONS""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""FENDER MUSICAL INSTR CORP""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""TORAY INDUSTRIES""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""MOBIL OIL CORP""
}"
"{
  ""country_code"": ""GB"",
  ""name"": ""ASTRAZENECA UK LTD""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""TEXTRON AUTOMOTIVE CO INC""
}"
"{
  ""country_code"": ""DE"",
  ""name"": ""BAS

2025-01-20 01:05:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:05:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:05:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:05:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 01:05:56 - snowflake.connector.connection - INFO - closed
2025-01-20 01:05:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:05:57 - root - INFO - SQL:
-- Corrected Query 3
SELECT f.value::VARIANT:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."assignee_harmonized") f
LIMIT 1000
Results:
Too long, hard cut:
assignee_name
OROSKAR ANIL R
PARIKH SAURABH P
OROSKAR ASHA A
JOHNSON KENNETH U
ESCARCEGA ANTHONY J
HILAKIVI ILKKA T
LEICA MICROSYSTEMS
IBM
MATSUSHITA ELECTRIC IND CO LTD
NCR CORP
SHIM WOO-SEOK
PARK YOUNG-WOOK
LEE JUNG-HYEON
YOON KWANG-SUB
KIM CHUL-HO
PARK TAE-JIN
LAGASSEY PAUL J
HYNIX SEMICONDUCTOR INC
MIN HYUN K
CHO YONG B
HONEYWELL INT INC
MEDTRONIC VASCULAR INC
IBM
SMS MEER GMBH
NICOLET PLASTIQUE LTEE
AUTOMATED PACKAGING SYST INC
SUMITOMO CHEMICAL CO
IBM
SEIKO EPSON CORP
PALVA TAPIO
MONTESANO MARCOS
MICROSOFT CORP
PARAMOUNT LEISURE IND INC
BROWN THOMAS R
LAO ICH-KIEN
SLIVERNAIL WILLIAM B
MARTINEZ RANDY G
DALOLA ALBERT J
MEDIVIR AB
JENQ CHING-SHI
YEN TING P
TOYODA GOSEI KK
LEVIN EDUARD
NOBLE PAUL E
BOSTIC R S
CAWLEY CLIFF
CAWLEY DON
GLENN JAMES
OKI ELECTRIC IND CO LTD
NITTO DENKO CORP
CONVERGIN
STRAND JOHN T
UNIV NORTH CAROLINA
EPSHTEYN GRIGORIY
INFOLENZ CORP
SHARP KK
IBM
NISSIN KOGYO KK
ANALOG DEVICES INC
IBIDEN CO LTD
NEOSE TECHNOLOGIES INC
CYCLACEL LTD
SHTURMAN CARDIOLOGY SYSTEMS
HITACHI CABLE
SANYO ELECTRIC CO
NOYES ANNA V
DEAK JOHN C
SCHEIBEL JEFFREY J
VINSON PHILLIP K
HARTMAN FREDERICK A
LAURENT JAMES CHARLES THEOPHIL
SEVERNS JOHN C
RADOMYSELSKI ARSENI V
FRANCE PAUL A
COLLINS JEROME H
THOEN CHRISTIAAN ARTHUR J K
SAKKAB NABIL Y
ELEMENT CXI LLC
BUCH DEEP
GARG VIVEK
MAIYURAN SUBRAMANIAM
SUN MICROSYSTEMS INC
SHAPIRO PEYSAKH
SHAPIRO SABINA
SHAPIRO JOHN R
SHAPIRO AMENDA D
HALLIBURTON ENERGY SERV INC
HAYASHI CHIHIRO
NOVELL INC
SYNERGISTIC NEUROTHERAPY ADJUS
WESTFALIA SEPARATOR AG
POLLARD ALBERT C
STEWART ROBERT E
AIZIKOWITZ TAMAR
ROTH ISRAEL
SHERWIN REUVEN
BROADCOM CORP
SWA HOLDING COMPANY INC
CELION NETWORKS INC
KONICA MINOLTA OPTO INC
NAVARRO LUIS
NAVARRO NESTOR
SALAT CARLOS BONE
EHBEN THOMAS
SCHMIDT SEBASTIAN
STROB WOLFGANG
UNIV CHICAGO
RIGEL PHARMACEUTICALS INC
SHINKO ELECTRIC IND CO
UPHUS REINHARD
KIM IN GYU
PARK BYUNG IL
KOO JA HYUNG
KIM YANG HO
HEO KYEONG WOOK
SUNG SI KYONG
LEE DONG HYUK
KO YOUNG HWAN
HWANG JUN HYEON
SONG HO JIN
HWANG JIN SEONG
HONG YOUNG HO
CHOI HWAN JONG
HWANG GEUN BAE
KANG CHUN SU
KIM TAC GEUN
WEI ANDY
KAMMLER THORSTEN
HOENTSCHEL JAN
HORSTMANN MANFRED
WOOD DONALD MARK
DISHMAN RICHARD L
AMMENDOLA ALDO
AULINGER-FUCHS KATHARINA
GOTSCHLICH ASTRID
KRAMER BERND
LANG MARTIN
SAEB WAEL
SINKS UDO
WUZIK ANDREAS
TAE GI-HYUN
KIM KYUNG-TAE
HUBERAG
WINDISCH VINCENT
YUEN PUI-HO
HUANG JING JUN
XU JINGZHEN
MASAKI KOJI
MORI NORIKO
BENTHIC GEOTECH PTY LTD
FREHEL FRANCOIS
THIERRY ROGER
GAUTIER CHRISTOPHE
AURELIUM BIOPHARMA INC
FETISSOVA NATALY
BLANVALET CLAUDE
LAMBERT PIERRE
FUJIWARA RYUHEI
CANON KK
OAK DAVE S
DO TRI
SOETARMAN RONNY
MEEKS STEVEN W
VELIDANDLA VAMSI
DANELSKI DARIN L
MUELLER FRANZ-JOSEF
DISTRIB GABLEX INC
SUZAKI HIDEFUMI
TAKEHARA HIROYASU
OTA YORITO
CABOT CORP
CRESCENZO GIOVANNI D
LIPTON RICHARD J
WALFISH SHELDON
FUJITSU LTD
DE MARCKEN CARL
KOBAYASHI MASAKAZU
SHOWA DENKO KK
PATARCHI ALBERTO
MICRON TECHNOLOGY INC
GARAY MICHELLE
MARRS CHRISTOPHER
SOUTHALL MICHAEL
CISCO TECH INC
CARDIAC PACEMAKERS INC
TRILITHIC INC
KACIN MARTY
KLOBA DAVID
GRAY MICHAEL
CLAGETT BILL
LEWINSKI MATTHEW
HIMAX TECH LTD
ORACLE INT CORP
MITSUBISHI ELECTRIC CORP
INOUE NAOKI
CHADANI KENICHI
NAKANO YUKIO
LEE CHUNGHO
KINOSHITA HIROYUKI
KRIVOKAPIC ZORAN
ZHENG WEI
CHANG MARK S
SUGINO RINJI
CHANG CHI
SAMSUNG ELECTRONICS CO LTD
KEY TECHNOLOGY INC
RAMASWAMY KUMAR
KNUTSON PAUL G
COOPER JEFFREY A
HYNIX SEMICONDUCTOR INC
GOODYEAR TIRE & RUBBER
KONINKL PHILIPS ELECTRONICS NV
DIRECTV GROUP INC
SAMSUNG TECHWIN CO LTD
ZIMMER DENTAL INC
GENENTECH INC
SUMITOMO ELECTRIC INDUSTRIES
LIBMAN CO
CLANCY KEVIN
KRAYN KEN
HERTLEIN ROBERT
SKIBA TERENCE
STANLEY RANDY
LEMASTER HERB
RIBARICH THOMAS J
TOSHIBA KK
NAKANE HIROSHI
NEOTRACT INC
STAMPS COM INC
BENOTEC
HARRISON PHIL
ZALEWSKI GARY M
VANAMO KAARLE
ARRINGTON KENNETH L
FRALEY MARK E
GARBACCIO ROBERT M
HUANG SHAEI Y
LINDSLEY CRAIG W
STEEN JUSTIN T
YANG FENG
FUJIFILM CORP
BEHAVIOR TECH COMPUTER CORP
HATTIG MYRON
SAMSUNG ELECTRONICS CO LTD
IM JAE H
LEE KANG S
DEGNER BRETT WILLIAM
LIGTENBERG CHRIS
ANDRE BARTLEY K
KOUGH DOUGLAS B
SAMSUNG ELECTRONICS CO LTD
TOSHIBA KK
DONG MING
GEN SOUND COMPANY LTD
PATODIA PRATEEK
AT & T KNOWLEDGE VENTURES LP
SAMSUNG ELECTRONICS CO LTD
BROTHER IND LTD
FANUC LTD
DENSO CORP
MANN WILLIAM F III
HIRKA JEFFREY L
ISONO EIJI
TAJIRI KATSUYA
SHINTAKU NOBUYUKI
YAMADA SHUZO
MIYAKE KUNIAKI
INOUE MITSUAKI
TANAKA MASAKAZU
JACOBS JED
AIRBUS FRANCE
NAMIKI PRECISION JEWEL CO LTD
KIM IK NYUN
IBM
SHERMAN JASON T
DEKA PRODUCTS LP
BJ SERVICES CO
MUKAI MANABU
TOMIZAWA TAKESHI
TAKEDA DAISUKE
WAKUTSU TAKASHI
SERIZAWA MUTSUMU
HUTCHINS DONALD H
OKI ELECTRIC IND CO LTD
INDIAN OIL CORP LTD
ABBOTT LAB VASCULAR ENTPR LTD
ABB TURBO SYSTEMS AG
SMITH NED
WISEMAN WILLARD M
KUMAR ALOK
SCARLATA VINCENT R
SIDDIQI FARAZ
BRUTCH TASNEEM
ASAHI INTECC CO LTD
KIMOTO KK
KRI INC
DAINIPPON INK & CHEMICALS
INNOLUX DISPLAY CORP
PHILIP MORRIS USA INC
BROSE JORG
KNORLEIN MICHAEL
ALCATEL LUCENT
HENRICHS JOSEPH R
CELSUS BIOPHARMACEUTICALS INC
CRAIG PAUL M
BODENSIEK PAUL
KUBOTA MASANORI
KUBOTA AYAKO
KUBOTA MUNETAKA


2025-01-20 01:05:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:05:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:05:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:05:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 01:05:58 - snowflake.connector.connection - INFO - closed
2025-01-20 01:05:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:05:58 - root - INFO - SQL:
-- Corrected Query 4
SELECT t."filing_date"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 1000
Results:
Too long, hard cut:
filing_date
19971015
19990322
0
19830217
19900109
19900101
19860106
0
19480102
19800125
19820209
19820219
19700116
19700224
19700501
0
18901220
19690318
19660117
18940609
18941217
18950125
0
19620924
19650616
19660402
19660506
19660704
19660725
19661121
19600102
19580106
19290107
19400116
19870521
19840705
19920730
19781012
19861030
19910225
19860106
19930106
20150702
19830922
19860626
19730907
19780905
19820512
19880217
19900307
0
19790102
0
0
19710204
19971230
19880317
19820430
19750221
19830503
19810413
19780313
19820518
19820524
19800416
19901205
19860918
19850916
19730328
19851029
19750527
19770706
19750707
19791105
19781012
19721012
19781219
19730906
19731029
19740405
19741216
19750221
19750925
19760105
19760123
19760331
19761125
19770324
19770413
19770802
19771125
19780505
19780613
19780712
19780717
19781020
19790110
19790718
19800918
19520218
19581027
19590724
19590915
19591103
19591202
19600518
19600524
19610929
19620219
19631211
19640430
19670405
0
19701231
19710930
19720218
19720225
19720428
19720619
19741003
19701210
19710528
19710901
19710902
19710924
19711005
19720321
19720428
19720517
19720905
19721106
0
19730129
19730402
0
19730828
19730924
19731009
19731022
0
19731114
19731206
19740325
0
19740523
19740523
19750213
19750507
19750710
19750826
0
0
19760203
19760602
19760630
19760902
19761006
19761214
19770114
19770125
19770211
0
19770407
0
0
19770908
19771103
19780118
0
19780406
0
19790208
19790912
19791002
19791116
19800221
19800312
19800527
19801017
0
19801215
19810209
19810421
19810525
19810603
19810923
19820121
19820720
19821101
19821103
19821222
0
19830503
19830504
19830510
19830524
19830607
19830719
0
19831230
19840503
19840703
19840802
19840906
19840924
19841220
19850409
19850513
19850718
19850919
19851128
19860218
19861105
19870121
19870302
19880929
18991221
19020507
19021112
19030316
19030921
19020820
19040315
19050821
19620127
18951218
18950924
18970331
19690130
18971110
18971027
18980218
18980429
18990624
19000210
19600226
19640227
19011009
19600310
19620309
19610310
19040217
19040615
19040913
19710305
19620326
19720310
19060228
19060723
19071207
19700324
19090220
19710329
19670403
19100617
19100723
19680410
19600516
19620517
19120619
19710429
19720428
19140108
19660509
19720508
19670517
19140731
19690513
19650526
19690519
19680531
19191125
19200412
19210514
19690630
19780912
19800311
0
0
0
0
0
0
0
0
19770401
19770518
19750521
19810716
19770831
19770907
19870813
19841114
0
0
19470908
19490315
0
19860729
19890125
19670616
19670912
19600120
19600707
19611127
19620626
19620705
0
19631224
19631226
19640519
19640708
19641009
19370114
19500120
19340122
19240212
19370209
19530213
19430325
19200218
19520227
19620213
19530226
19510312
19630219
19660216
19570301
19440420
19440422
19510406
19600309
19690217
19520418
19911010
19850415
19840420
19881013
19961007
19970827
19980917
19870108
19760109
19810108
19950109
19770110
19860110
19830112
19830111
19960110
19880111
19711229
19980109
19980109
19870112
19830114
19930112
19850111
19940118
19830112
19840113
19950113
19950113
19790117
19820113
19990111
19770119
19860114
19750111
19850116
19720111
19910122
19780121
19740109
19840117
19780119
19820120
19860114
19870114
19940126
19970117
19770127
19760128
19780125
19920121
19720124
19890117
19980120
19940128
19980120
19950124
19930122
19870120
19870120
19810127
19940131
19980604
19830330
19941206
0
0
19150111
0
0
0
0
0
19870116
0
19930115
19350212
0
0
0
19600208
19480210
0
0
0
19870202
19760504
19910809
19840810
19680814
19790905
19800829
19751008
19791205
19711208
20030401
19991029
19961122
19830119
19961128
19970103
19950112
19880309
19880314
20000713
19920114
19991103
19880211
19750515
19941219
19941229
19970314
19991220
19751008
19830928
19970321
19920811
19920812
19970213
19970218
19990324
19920828
20001222
19970205
19950414
19840105
19830209
19990301
19920828
19950524
19950526
19770725
20000202
19970425
19921130
19890210
20000210
19840629
20000501
20000112
19890201
20000131
19970701
19921218
19780307
19841016
19950816
19680314
19711029
19970725
20000118
19930315
19990402
20000330
19890622
19951011
19780710
19930310
20000404
19930520
19780904
19930420
19990430
19990520
19850411
19951206
19990608
20000327
19890831
19790119
20000414
19930705
19790219
19720810
19891130
19971008
19960119
20000505
19790528
19790614
19990628
19900119
19900103
19711224
19790824
20000519
19851106
19841211
19960312
19960129
19900320
19730228
19791113
20000816
19971212
19940121
19990819
20000530
19900502
19990813
20000615
19800219
19730516
19960607
19980224
19800319
19730612
19800402
19990817
19990830
19900627
19730723
19800619
19960607
20000721
20000627
19860730
19860731
19900810
19800730
19800820
19900827
19990909
20000929
19980203
19991001
19900912
19901018
19980123
20000726
19740314
19960808
19740508
19960823
20000707
20000830
19870319
20000505
19960918
19961008
19980618
19910301
20001207
19961001
19910114
19940727
19960913
19910410
19870622
19980424
19910403
19980528
19980601
19870819
19870908
19870910
19750218
19860

2025-01-20 01:05:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:05:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:05:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:06:00 - snowflake.connector.connection - INFO - closed
2025-01-20 01:06:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:06:19 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 01:06:19 - root - INFO - ```sql
SELECT EXTRACT(YEAR FROM TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 1000;
```
2025-01-20 01:06:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:06:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:06:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:06:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 01:06:21 - snowflake.connector.connection - INFO - closed
2025-01-20 01:06:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:07:28 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 01:07:28 - root - INFO - SQL:
SELECT EXTRACT(YEAR FROM TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 1000;
Results:
Too long, hard cut:
filing_year
1997.0
1999.0
""
1983.0
1990.0
1990.0
1986.0
""
1948.0
1980.0
1982.0
1982.0
1970.0
1970.0
1970.0
""
1890.0
1969.0
1966.0
1894.0
1894.0
1895.0
""
1962.0
1965.0
1966.0
1966.0
1966.0
1966.0
1966.0
1960.0
1958.0
1929.0
1940.0
1987.0
1984.0
1992.0
1978.0
1986.0
1991.0
1986.0
1993.0
2015.0
1983.0
1986.0
1973.0
1978.0
1982.0
1988.0
1990.0
""
1979.0
""
""
1971.0
1997.0
1988.0
1982.0
1975.0
1983.0
1981.0
1978.0
1982.0
1982.0
1980.0
1990.0
1986.0
1985.0
1973.0
1985.0
1975.0
1977.0
1975.0
1979.0
1978.0
1972.0
1978.0
1973.0
1973.0
1974.0
1974.0
1975.0
1975.0
1976.0
1976.0
1976.0
1976.0
1977.0
1977.0
1977.0
1977.0
1978.0
1978.0
1978.0
1978.0
1978.0
1979.0
1979.0
1980.0
1952.0
1958.0
1959.0
1959.0
1959.0
1959.0
1960.0
1960.0
1961.0
1962.0
1963.0
1964.0
1967.0
""
1970.0
1971.0
1972.0
1972.0
1972.0
1972.0
1974.0
1970.0
1971.0
1971.0
1971.0
1971.0
1971.0
1972.0
1972.0
1972.0
1972.0
1972.0
""
1973.0
1973.0
""
1973.0
1973.0
1973.0
1973.0
""
1973.0
1973.0
1974.0
""
1974.0
1974.0
1975.0
1975.0
1975.0
1975.0
""
""
1976.0
1976.0
1976.0
1976.0
1976.0
1976.0
1977.0
1977.0
1977.0
""
1977.0
""
""
1977.0
1977.0
1978.0
""
1978.0
""
1979.0
1979.0
1979.0
1979.0
1980.0
1980.0
1980.0
1980.0
""
1980.0
1981.0
1981.0
1981.0
1981.0
1981.0
1982.0
1982.0
1982.0
1982.0
1982.0
""
1983.0
1983.0
1983.0
1983.0
1983.0
1983.0
""
1983.0
1984.0
1984.0
1984.0
1984.0
1984.0
1984.0
1985.0
1985.0
1985.0
1985.0
1985.0
1986.0
1986.0
1987.0
1987.0
1988.0
1899.0
1902.0
1902.0
1903.0
1903.0
1902.0
1904.0
1905.0
1962.0
1895.0
1895.0
1897.0
1969.0
1897.0
1897.0
1898.0
1898.0
1899.0
1900.0
1960.0
1964.0
1901.0
1960.0
1962.0
1961.0
1904.0
1904.0
1904.0
1971.0
1962.0
1972.0
1906.0
1906.0
1907.0
1970.0
1909.0
1971.0
1967.0
1910.0
1910.0
1968.0
1960.0
1962.0
1912.0
1971.0
1972.0
1914.0
1966.0
1972.0
1967.0
1914.0
1969.0
1965.0
1969.0
1968.0
1919.0
1920.0
1921.0
1969.0
1978.0
1980.0
""
""
""
""
""
""
""
""
1977.0
1977.0
1975.0
1981.0
1977.0
1977.0
1987.0
1984.0
""
""
1947.0
1949.0
""
1986.0
1989.0
1967.0
1967.0
1960.0
1960.0
1961.0
1962.0
1962.0
""
1963.0
1963.0
1964.0
1964.0
1964.0
1937.0
1950.0
1934.0
1924.0
1937.0
1953.0
1943.0
1920.0
1952.0
1962.0
1953.0
1951.0
1963.0
1966.0
1957.0
1944.0
1944.0
1951.0
1960.0
1969.0
1952.0
1991.0
1985.0
1984.0
1988.0
1996.0
1997.0
1998.0
1987.0
1976.0
1981.0
1995.0
1977.0
1986.0
1983.0
1983.0
1996.0
1988.0
1971.0
1998.0
1998.0
1987.0
1983.0
1993.0
1985.0
1994.0
1983.0
1984.0
1995.0
1995.0
1979.0
1982.0
1999.0
1977.0
1986.0
1975.0
1985.0
1972.0
1991.0
1978.0
1974.0
1984.0
1978.0
1982.0
1986.0
1987.0
1994.0
1997.0
1977.0
1976.0
1978.0
1992.0
1972.0
1989.0
1998.0
1994.0
1998.0
1995.0
1993.0
1987.0
1987.0
1981.0
1994.0
1998.0
1983.0
1994.0
""
""
1915.0
""
""
""
""
""
1987.0
""
1993.0
1935.0
""
""
""
1960.0
1948.0
""
""
""
1987.0
1976.0
1991.0
1984.0
1968.0
1979.0
1980.0
1975.0
1979.0
1971.0
2003.0
1999.0
1996.0
1983.0
1996.0
1997.0
1995.0
1988.0
1988.0
2000.0
1992.0
1999.0
1988.0
1975.0
1994.0
1994.0
1997.0
1999.0
1975.0
1983.0
1997.0
1992.0
1992.0
1997.0
1997.0
1999.0
1992.0
2000.0
1997.0
1995.0
1984.0
1983.0
1999.0
1992.0
1995.0
1995.0
1977.0
2000.0
1997.0
1992.0
1989.0
2000.0
1984.0
2000.0
2000.0
1989.0
2000.0
1997.0
1992.0
1978.0
1984.0
1995.0
1968.0
1971.0
1997.0
2000.0
1993.0
1999.0
2000.0
1989.0
1995.0
1978.0
1993.0
2000.0
1993.0
1978.0
1993.0
1999.0
1999.0
1985.0
1995.0
1999.0
2000.0
1989.0
1979.0
2000.0
1993.0
1979.0
1972.0
1989.0
1997.0
1996.0
2000.0
1979.0
1979.0
1999.0
1990.0
1990.0
1971.0
1979.0
2000.0
1985.0
1984.0
1996.0
1996.0
1990.0
1973.0
1979.0
2000.0
1997.0
1994.0
1999.0
2000.0
1990.0
1999.0
2000.0
1980.0
1973.0
1996.0
1998.0
1980.0
1973.0
1980.0
1999.0
1999.0
1990.0
1973.0
1980.0
1996.0
2000.0
2000.0
1986.0
1986.0
1990.0
1980.0
1980.0
1990.0
1999.0
2000.0
1998.0
1999.0
1990.0
1990.0
1998.0
2000.0
1974.0
1996.0
1974.0
1996.0
2000.0
2000.0
1987.0
2000.0
1996.0
1996.0
1998.0
1991.0
2000.0
1996.0
1991.0
1994.0
1996.0
1991.0
1987.0
1998.0
1991.0
1998.0
1998.0
1987.0
1987.0
1987.0
1975.0
1986.0
1975.0
1982.0
1982.0
1975.0
1982.0
1975.0
1975.0
1982.0
1991.0
1975.0
1991.0
1975.0
1982.0
2001.0
1998.0
2001.0
1977.0
1980.0
1982.0
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
1964.0
1964.0
""
1966.0
1966.0
1966.0
1974.0
1967.0
1967.0
1968.0
1968.0
1968.0
1969.0
1969.0
1969.0
""
""
""
""
1992.0
1994.0
2000.0
2000.0
2000.0
2000.0
2001.0
2001.0
2002.0
2003.0
2003.0
2003.0
2003.0
2003.0
2003.0
1976.0
1977.0
1977.0
1978.0
1978.0
1979.0
1979.0
1979.0
1979.0
1980.0
1982.0
1982.0
1983.0
1983.0
1984.0
1985.0
1985.0
1986.0
1986.0
1986.0
1986.0
1987.0
1988.0
1988.0
1989.0
1989.0
1989.0
1989.0
1990.0
1990.0
1990.0
1991.0
1991.0
1992.0
1992.0
1993.0
1993.0
1994.0
1994.0
1994.0
1994.0
1995.0
1996.0
1996.0
1997.0
1997.0
1998.0
1999.0
1999.0
1999.0
1999.0
1906.0
1906.0
1908.0
1907.0
1908.0
1908.0
1907.0
1909.0
1910.0
1910.0
1912.0
1912.0
1912.0
1913.0
1915.0
1916.0
1915.0
1916.0
1917.0
1916.0
1919.0
1919.0
""
""
""


2025-01-20 01:07:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:07:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:07:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:07:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 213
2025-01-20 01:07:30 - snowflake.connector.connection - INFO - closed
2025-01-20 01:07:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:07:30 - root - INFO - SQL:
-- Corrected Query 6
SELECT t."country_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A01B3%'
LIMIT 1000
Results:
country_code
KR
RU
US
US
BE
BE
US
US
US
US
US
US
US
US
US
AU
GB
GB
US
US
US
CN
CN
DE
CA
CA
EP
EP
US
KR
DE
KR
KR
CN
CN
CN
CN
CN
DE
KR
CN
CN
NO
CA
KR
US
CN
CN
CN
GB
DE
US
US
US
US
US
US
FR
FR
US
US
US
US
KR
KR
DE
DE
DE
US
US
US
US
US
US
US
US
US
GB
US
US
BE
BE
BE
US
US
US
US
CA
KR
CA
CA
KR
KR
KR
KR
KR
KR
KR
KR
GB
IL
IL
US
US
US
US
GB
GB
GB
GB
DE
CN
US
FR
FR
US
US
US
US
US
FR
FR
FR
FR
FR
FR
CN
CN
CN
DE
US
US
US
US
US
US
PL
PL
PL
PL
BE
BE
BE
US
US
US
US
KR
CN
CN
CN
IT
IT
ZA
ZA
ZA
ZA
GB
IT
IT
CA
KR
CN
CN
CN
AT
NL
US
AU
AU
HU
KR
JP
JP
KR
AU
AU
EP
EP
KR
KR
CN
CN
CN
CN
CN
NL
NL
FR
GB
GB
GB
CN
CN
IT
IT
IT
IT
IT
IT
JP
JP
JP
CN
CN
CN
CN
CN
KR
CN
CN
NO
CN

2025-01-20 01:07:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:07:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:07:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:07:31 - snowflake.connector.connection - INFO - closed
2025-01-20 01:07:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:08:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 01:08:22 - root - INFO - The error you're encountering is due to the use of `JOIN LATERAL FLATTEN` with an `ON` clause, which is not supported in Snowflake SQL. Instead, you should use `CROSS JOIN LATERAL FLATTEN` without an `ON` clause.

Here is the corrected version of **Query 7**:

```sql
-- Corrected Query 7
SELECT f_assignee.value::VARIANT:"name"::STRING AS "assignee_name",
       COUNT(DISTINCT t."publication_number") AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."cpc") f_cpc
CROSS JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee
WHERE f_cpc.value::VARIANT:"code"::STRING ILIKE 'A01B3%'
GROUP BY "assignee_name"
ORDER BY "application_count" DESC
LIMIT 1000;
```

**Corrections to Other Queries with Similar Errors:**

```sql
-- Corrected Query 8
SELECT f_assignee.value::VARIANT:"name"::STRING AS "assignee_name",
       EXTRACT(YEAR FROM TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')) AS "filing_year",
       COUNT(DISTINCT t."publication_number") AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."cpc") f_cpc
CROSS JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee
WHERE f_cpc.value::VARIANT:"code"::STRING ILIKE 'A01B3%'
GROUP BY "assignee_name", "filing_year"
ORDER BY "application_count" DESC
LIMIT 1000;
```

```sql
-- Corrected Query 9
SELECT t."country_code",
       COUNT(DISTINCT t."publication_number") AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A01B3%'
  AND EXTRACT(YEAR FROM TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')) = 2020
GROUP BY t."country_code"
ORDER BY "application_count" DESC
LIMIT 1000;
```

```sql
-- Corrected Query 10
SELECT t."publication_number", t."filing_date", t."country_code"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A01B3%'
LIMIT 1000;
```

**Explanation:**

- **Use of `CROSS JOIN LATERAL FLATTEN`:** In Snowflake, when joining a table with a table function like `LATERAL FLATTEN`, you should use `CROSS JOIN LATERAL` instead of `JOIN LATERAL ... ON TRUE`. The `CROSS JOIN LATERAL` syntax allows you to join each row of the left table with the result of the lateral function without requiring an `ON` clause.

- **Removal of `ON TRUE`:** Since `CROSS JOIN LATERAL` doesn't require an `ON` clause, you can omit `ON TRUE` entirely.

By making these changes, the queries should run without the previous error and correctly process the data from the `VARIANT` columns.

**Note:** Ensure that all other queries using `JOIN LATERAL FLATTEN` are adjusted similarly to use `CROSS JOIN LATERAL FLATTEN` without an `ON` clause.
2025-01-20 01:08:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:08:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:08:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:08:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 94
2025-01-20 01:08:23 - snowflake.connector.connection - INFO - closed
2025-01-20 01:08:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:09:12 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 01:09:12 - root - INFO - SQL:
-- Corrected Query 8
SELECT f_assignee.value::VARIANT:"name"::STRING AS "assignee_name",
       EXTRACT(YEAR FROM TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')) AS "filing_year",
       COUNT(DISTINCT t."publication_number") AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."cpc") f_cpc
CROSS JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee
WHERE f_cpc.value::VARIANT:"code"::STRING ILIKE 'A01B3%'
GROUP BY "assignee_name", "filing_year"
ORDER BY "application_count" DESC
LIMIT 1000;
Results:
assignee_name,filing_year,application_count
AMAZONEN WERKE DREYER H,1979,2
CHOATE STOREY NORMAN,1934,1
BETEK GMBH & CO KG,2015,1
HUBEI SHUANGYU MACHINERY TECH CO LTD,2018,1
SAMSUNG KWANGJU ELECTRONICS CO,2004,1
LELY NV C VAN DER,1985,1
GLASIER HAROLD H,1931,1
CARLUCCI JAMES J,1974,1
CAMPBELL CLARENCE L,1935,1
HARRELL DANNY H,1991,1
WANG XUEDONG,2022,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,2018,1
GUERBET FRANCOIS,1973,1
DAEHO FARMING MACHINERY CO LTD,2000,1
KORSMEYER ERNEST H,1920,1
EMPR IMPORT EXPORT Y DISTRIB P,1991,1
RUDOLPH HASSON PAUL,1934,1
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,2017,1
HOLGER LETH,1926,1
AUGUST SETTERGREN OTTO GORAN,1948,1
SOUTHERN PLOW COMPANY,1912,1
WILLIAM DREFKE,1926,1
WALTER ROWAN JAMES,1947,1
LEINFELDER DIPL-LANDW HERMANN,1967,1
NIEMEYER SOEHNE STAHL PFLUG,1950,1
KIM BYUNG SUB,1996,1
Liu Yueshang,2022,1
INT HARVESTER GREAT BRITAIN,1956,1
SHEPPARD RICHARD H,1950,1
CHRISTEN ARNE JENSEN,1926,1
PATENT CONCERN NV,1978,1
WALLNER KLAUS,2016,1
SAMSUNG SDI CO LTD,2006,1
UNIV CHUNG ANG IND,2011,1
ARWAC LTD,2020,1
KUHN SA,2016,1
SAPHIR MASCHB GMBH,2017,1
WILLIAM HENRY HONY FROST,1934,1
TWOSE OF TIVERTON LTD,1981,1
DEERE & CO,2002,1
NEW ZEALAND INVENTIONS DEV,1974,1
LEMKEN GMBH & CO KG,2010,1
LG ELECTRONICS INC,2019,1
KIM JONG JIN,2001,1
EDMOND HEE,1918,1
GERBER MAURICE,2009,1
CHRISTOPHER H R WOODWARD,1918,1
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,2022,1
LIM HEON HO,2015,1
DEERE & CO,1979,1
AGSOILWORKS TECH COMPANY LLC,2019,1
BOTVID SETTERGREN ANDERS GOSTA,1948,1
RICHARD CO,1960,1
TEXAS INDUSTRIES INC,1975,1
LELY NV C VAN DER,1976,1
EDWARDS JOHN W,2004,1
GEORGE A KELLY PLOW COMPANY,1901,1
DEERE & CO,2019,1
OTULAK PRZEMYSLAW PRO CNC,2022,1
SJOEHOLMS MEKANISKA AB,1982,1
QUINSTAR CORP,1996,1
KUBOTA KK,2000,1
TRECKER FRANCIS J,1954,1
MARTIN CHARLES H,2017,1
MCKAY RALPH LTD,1980,1
ELEOS ROBOTICS INC,2019,1
UNIV TONGJI,2017,1
CHO SUNG GU,1997,1
BULLS CO LTD,2012,1
FISHER VAN E,1925,1
ZHANG LIJIN,2021,1
SIGFRID ANDERSON ANDERS,1960,1
JIM ALEX SMITH,1955,1
LELY NV C VAN DER,1975,1
MARTIN DOMINIC R,2017,1
DEERE & CO,2017,1
UNIV SYDNEY,2016,1
DAIYO TANGO CO LTD,1987,1
KIM JAE KEUN,2000,1
CHONGQING TIANJI IND CO LTD,2015,1
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,2023,1
GERBER HUBERT,2009,1
SALGE HENRY F,1913,1
PREC PLANTING LLC,2016,1
UNIV JIANGSU,2021,1
LELY NV C VAN DER,1983,1
LEIJENAAR SYTZE,1993,1
UNIV HEILONGJIANG SCI & TECH,2018,1
ALLEN SAMUEL L,1904,1
HUBER FRANZ FERDINAND,2017,1
CNH IND AMERICA LLC,2022,1
ARTHUR BROOKS SPURR,1951,1
LELY NV C VAN DER,1981,1
AMAZONEN-WERKE H DREYER GMBH & CO KG,2015,1

2025-01-20 01:09:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:09:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:09:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:09:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 94
2025-01-20 01:09:13 - snowflake.connector.connection - INFO - closed
2025-01-20 01:09:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:09:14 - root - INFO - SQL:
-- Corrected Query 8
SELECT f_assignee.value::VARIANT:"name"::STRING AS "assignee_name",
       EXTRACT(YEAR FROM TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')) AS "filing_year",
       COUNT(DISTINCT t."publication_number") AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."cpc") f_cpc
CROSS JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee
WHERE f_cpc.value::VARIANT:"code"::STRING ILIKE 'A01B3%'
GROUP BY "assignee_name", "filing_year"
ORDER BY "application_count" DESC
LIMIT 1000
Results:
assignee_name,filing_year,application_count
AMAZONEN WERKE DREYER H,1979,2
ALLEN SAMUEL L,1904,1
HUBEI SHUANGYU MACHINERY TECH CO LTD,2018,1
LELY NV C VAN DER,1981,1
UNIV SYDNEY,2016,1
KIM BYUNG SUB,1996,1
CNH IND AMERICA LLC,2022,1
WILLIAM HENRY HONY FROST,1934,1
SAPHIR MASCHB GMBH,2017,1
DEERE & CO,2002,1
CARLUCCI JAMES J,1974,1
Liu Yueshang,2022,1
OTULAK PRZEMYSLAW PRO CNC,2022,1
EDMOND HEE,1918,1
GERBER MAURICE,2009,1
CHRISTOPHER H R WOODWARD,1918,1
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,2022,1
LIM HEON HO,2015,1
LELY NV C VAN DER,1975,1
MARTIN DOMINIC R,2017,1
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,2017,1
HOLGER LETH,1926,1
UNIV JIANGSU,2021,1
DAEHO FARMING MACHINERY CO LTD,2000,1
GUERBET FRANCOIS,1973,1
TWOSE OF TIVERTON LTD,1981,1
KUHN SA,2016,1
TRECKER FRANCIS J,1954,1
MCKAY RALPH LTD,1980,1
MARTIN CHARLES H,2017,1
GEORGE A KELLY PLOW COMPANY,1901,1
WANG XUEDONG,2022,1
ARTHUR BROOKS SPURR,1951,1
NIEMEYER SOEHNE STAHL PFLUG,1950,1
LEINFELDER DIPL-LANDW HERMANN,1967,1
KORSMEYER ERNEST H,1920,1
HUBER FRANZ FERDINAND,2017,1
SHEPPARD RICHARD H,1950,1
EDWARDS JOHN W,2004,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,2018,1
INT HARVESTER GREAT BRITAIN,1956,1
CAMPBELL CLARENCE L,1935,1
HARRELL DANNY H,1991,1
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,2023,1
ELEOS ROBOTICS INC,2019,1
UNIV TONGJI,2017,1
CHO SUNG GU,1997,1
PREC PLANTING LLC,2016,1
AUGUST SETTERGREN OTTO GORAN,1948,1
LEIJENAAR SYTZE,1993,1
LELY NV C VAN DER,1983,1
NEW ZEALAND INVENTIONS DEV,1974,1
LEMKEN GMBH & CO KG,2010,1
UNIV HEILONGJIANG SCI & TECH,2018,1
GERBER HUBERT,2009,1
SALGE HENRY F,1913,1
RICHARD CO,1960,1
DEERE & CO,1979,1
AGSOILWORKS TECH COMPANY LLC,2019,1
TEXAS INDUSTRIES INC,1975,1
JIM ALEX SMITH,1955,1
EMPR IMPORT EXPORT Y DISTRIB P,1991,1
LELY NV C VAN DER,1985,1
GLASIER HAROLD H,1931,1
SAMSUNG KWANGJU ELECTRONICS CO,2004,1
DAIYO TANGO CO LTD,1987,1
WILLIAM DREFKE,1926,1
WALTER ROWAN JAMES,1947,1
CHOATE STOREY NORMAN,1934,1
FISHER VAN E,1925,1
ZHANG LIJIN,2021,1
BULLS CO LTD,2012,1
SIGFRID ANDERSON ANDERS,1960,1
CHRISTEN ARNE JENSEN,1926,1
LELY NV C VAN DER,1976,1
DEERE & CO,2019,1
SAMSUNG SDI CO LTD,2006,1
LG ELECTRONICS INC,2019,1
KIM JONG JIN,2001,1
UNIV CHUNG ANG IND,2011,1
ARWAC LTD,2020,1
WALLNER KLAUS,2016,1
PATENT CONCERN NV,1978,1
KUBOTA KK,2000,1
SJOEHOLMS MEKANISKA AB,1982,1
QUINSTAR CORP,1996,1
CHONGQING TIANJI IND CO LTD,2015,1
KIM JAE KEUN,2000,1
BOTVID SETTERGREN ANDERS GOSTA,1948,1
SOUTHERN PLOW COMPANY,1912,1
RUDOLPH HASSON PAUL,1934,1
DEERE & CO,2017,1
AMAZONEN-WERKE H DREYER GMBH & CO KG,2015,1
BETEK GMBH & CO KG,2015,1

2025-01-20 01:09:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:09:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:09:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:09:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-20 01:09:15 - snowflake.connector.connection - INFO - closed
2025-01-20 01:09:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:09:16 - root - INFO - SQL:
-- Corrected Query 9
SELECT t."country_code",
       COUNT(DISTINCT t."publication_number") AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A01B3%'
  AND EXTRACT(YEAR FROM TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')) = 2020
GROUP BY t."country_code"
ORDER BY "application_count" DESC
LIMIT 1000
Results:
country_code,application_count
KR,1
GB,1

2025-01-20 01:09:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:09:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:09:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:09:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 213
2025-01-20 01:09:17 - snowflake.connector.connection - INFO - closed
2025-01-20 01:09:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:09:17 - root - INFO - SQL:
-- Corrected Query 10
SELECT t."publication_number", t."filing_date", t."country_code"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A01B3%'
LIMIT 1000
Results:
Too long, hard cut:
publication_number,filing_date,country_code
US-231385-A,0,US
US-1093294-A,19130605,US
KR-20070101567-A,20060411,KR
KR-20070101567-A,20060411,KR
DE-1963184-U,19670306,DE
DE-1963184-U,19670306,DE
DE-1963184-U,19670306,DE
DE-102010019819-B4,20100508,DE
US-220177-A,0,US
US-3054462-A,19600912,US
US-3054462-A,19600912,US
FR-508965-A,19180709,FR
FR-508965-A,19180709,FR
US-2888084-A,19540216,US
US-1545136-A,19250227,US
US-1545136-A,19250227,US
CN-116671357-A,20230721,CN
CN-116671357-A,20230721,CN
CN-116671357-A,20230721,CN
GB-2039201-B,19791119,GB
US-10375891-B2,20170627,US
US-10375891-B2,20170627,US
US-10375891-B2,20170627,US
US-694931-A,19010629,US
CN-109392332-A,20181219,CN
CN-109392332-A,20181219,CN
DE-463858-C,19261012,DE
CA-2945250-A1,20161012,CA
CA-2945250-A1,20161012,CA
EP-3586579-A1,20190625,EP
EP-3586579-A1,20190625,EP
US-2019324472-A1,20190628,US
US-2843032-A,19550520,US
US-2843032-A,19550520,US
US-1860534-A,19310309,US
US-1860534-A,19310309,US
US-501724-A,0,US
US-2784656-A,19501212,US
US-2784656-A,19501212,US
US-2039702-A,19351227,US
US-2039702-A,19351227,US
AU-7115874-A,19740712,AU
GB-436304-A,19340411,GB
GB-436304-A,19340411,GB
US-5669452-A,19960806,US
US-5669452-A,19960806,US
BE-826346-A,19750306,BE
BE-826346-A,19750306,BE
US-159642-A,0,US
US-395573-A,0,US
KR-200386017-Y1,20050318,KR
RU-191537-U1,20190611,RU
KR-20130063834-A,20111207,KR
DE-140654-C,0,DE
DE-102017102683-A1,20170210,DE
KR-101378314-B1,20120821,KR
KR-200194260-Y1,20000406,KR
JP-S6342702-Y2,19820216,JP
JP-6910281-B2,20171214,JP
JP-6910281-B2,20171214,JP
KR-100191418-B1,19960724,KR
KR-100191418-B1,19960724,KR
CN-114916261-A,20220602,CN
CN-114916261-A,20220602,CN
NO-910950-L,19910311,NO
CA-3089518-A1,20190124,CA
CN-108575125-A,20180711,CN
CN-108575125-A,20180711,CN
CN-113796181-A,20210917,CN
CN-113796181-A,20210917,CN
CN-106973572-B,20170122,CN
NL-183071-C,19751202,NL
NL-183071-C,19751202,NL
FR-2943502-A1,20090331,FR
GB-2598141-A,20200820,GB
GB-2598141-A,20200820,GB
GB-2598141-A,20200820,GB
CN-107646212-A,20170731,CN
CN-107646212-A,20170731,CN
IT-1166526-B,19830525,IT
IT-1166526-B,19830525,IT
IT-1166526-B,19830525,IT
IT-1166526-B,19830525,IT
IT-1166526-B,19830525,IT
IT-1166526-B,19830525,IT
KR-20020067218-A,20010216,KR
CN-115362764-A,20220531,CN
CN-115362764-A,20220531,CN
NO-153631-B,19820721,NO
CN-104040083-B,20121115,CN
KR-20010029583-A,20000307,KR
CN-105325075-A,20151127,CN
CN-105325075-A,20151127,CN
CN-109005687-A,20180717,CN
CN-109005687-A,20180717,CN
CN-109005687-A,20180717,CN
CN-107072143-A,20151020,CN
CN-107072143-A,20151020,CN
CN-107072143-A,20151020,CN
CN-107094377-A,20170509,CN
CN-107094377-A,20170509,CN
KR-200487998-Y1,20180627,KR
US-130700-A,0,US
FR-960102-A,0,FR
FR-960102-A,0,FR
US-5267618-A,19911010,US
US-5267618-A,19911010,US
KR-102593393-B1,20180918,KR
KR-102593393-B1,20180918,KR
KR-102484290-B1,20201120,KR
KR-102484290-B1,20201120,KR
KR-102484290-B1,20201120,KR
KR-102484290-B1,20201120,KR
KR-900006618-B1,19871026,KR
US-290366-A,0,US
US-3963079-A,19741111,US
US-3963079-A,19741111,US
US-3963079-A,19741111,US
US-3963079-A,19741111,US
US-2031188-A,19340228,US
US-2031188-A,19340228,US
KR-101169320-B1,20120118,KR
KR-101593221-B1,20150530,KR
GB-696973-A,19510312,GB
IL-268624-A,20190811,IL
IL-268624-A,20190811,IL
US-2597821-A,19470203,US
US-2597821-A,19470203,US
US-2597821-A,19470203,US
US-2597821-A,19470203,US
US-2024164239-A1,20221118,US
US-2024164239-A1,20221118,US
US-2024164239-A1,20221118,US
FR-2287837-B1,19751013,FR
FR-2287837-B1,19751013,FR
FR-2287837-B1,19751013,FR
FR-2287837-B1,19751013,FR
FR-2287837-B1,19751013,FR
FR-2287837-B1,19751013,FR
BE-872468-A,19781201,BE
BE-872468-A,19781201,BE
BE-872468-A,19781201,BE
US-5845717-A,19961226,US
US-5845717-A,19961226,US
GB-2090713-B,19810112,GB
GB-2090713-B,19810112,GB
GB-2090713-B,19810112,GB
GB-2090713-B,19810112,GB
DE-829523-C,19500507,DE
CN-100366901-C,20040610,CN
US-1081539-A,19120124,US
US-376176-A,0,US
GB-792883-A,19560228,GB
US-5407014-A,19930323,US
US-5407014-A,19930323,US
CA-2543900-A1,20041029,CA
CA-2543900-A1,20041029,CA
US-2545590-A,19480220,US
US-2545590-A,19480220,US
CA-997451-A,19730209,CA
CN-108289407-A,20160916,CN
CN-108289407-A,20160916,CN
CN-108289407-A,20160916,CN
US-1412308-A,19200608,US
US-1412308-A,19200608,US
DE-8707829-U1,19870602,DE
KR-20020000597-A,20000626,KR
CN-114651538-A,20220225,CN
CN-114651538-A,20220225,CN
CN-114651538-A,20220225,CN
IT-8519066-A1,19850110,IT
IT-8519066-A1,19850110,IT
US-828171-A,19040310,US
US-3129772-A,19601116,US
US-3129772-A,19601116,US
US-530054-A,0,US
US-1471180-A,19180917,US
US-1471180-A,19180917,US
BE-727862-A,19690203,BE
US-1636048-A,19260329,US
US-1636048-A,19260329,US
PL-440426-A1,20220221,PL
PL-440426-A1,20220221,PL
PL-440426-A1,20220221,PL
PL-440426-A1,20220221,PL
BE-1007083-A5,19930526,BE
BE-1007083-A5,19930526,BE
CN-113761309-A,20210816,CN
CN-113761309-A,20210816,CN
CN-113761309-A,20210816,CN
KR-200149462-Y1,19970715,KR
HU-E050035-T2,20161104,HU
KR-200473688-Y1,20130225,KR
JP-6998053-B2,20180921,JP
JP-6998053-B2,201

2025-01-20 01:09:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:09:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:09:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:09:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 01:09:19 - snowflake.connector.connection - INFO - closed
2025-01-20 01:09:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:09:19 - root - INFO - SQL:
-- Corrected Query 11
SELECT t."filing_date",
       TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') AS "filing_date_formatted"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 1000
Results:
Too long, hard cut:
filing_date,filing_date_formatted
19971015,1997-10-15
19990322,1999-03-22
0,
19830217,1983-02-17
19900109,1990-01-09
19900101,1990-01-01
19860106,1986-01-06
0,
19480102,1948-01-02
19800125,1980-01-25
19820209,1982-02-09
19820219,1982-02-19
19700116,1970-01-16
19700224,1970-02-24
19700501,1970-05-01
0,
18901220,1890-12-20
19690318,1969-03-18
19660117,1966-01-17
18940609,1894-06-09
18941217,1894-12-17
18950125,1895-01-25
0,
19620924,1962-09-24
19650616,1965-06-16
19660402,1966-04-02
19660506,1966-05-06
19660704,1966-07-04
19660725,1966-07-25
19661121,1966-11-21
19600102,1960-01-02
19580106,1958-01-06
19290107,1929-01-07
19400116,1940-01-16
19870521,1987-05-21
19840705,1984-07-05
19920730,1992-07-30
19781012,1978-10-12
19861030,1986-10-30
19910225,1991-02-25
19860106,1986-01-06
19930106,1993-01-06
20150702,2015-07-02
19830922,1983-09-22
19860626,1986-06-26
19730907,1973-09-07
19780905,1978-09-05
19820512,1982-05-12
19880217,1988-02-17
19900307,1990-03-07
0,
19790102,1979-01-02
0,
0,
19710204,1971-02-04
19971230,1997-12-30
19880317,1988-03-17
19820430,1982-04-30
19750221,1975-02-21
19830503,1983-05-03
19810413,1981-04-13
19780313,1978-03-13
19820518,1982-05-18
19820524,1982-05-24
19800416,1980-04-16
19901205,1990-12-05
19860918,1986-09-18
19850916,1985-09-16
19730328,1973-03-28
19851029,1985-10-29
19750527,1975-05-27
19770706,1977-07-06
19750707,1975-07-07
19791105,1979-11-05
19781012,1978-10-12
19721012,1972-10-12
19781219,1978-12-19
19730906,1973-09-06
19731029,1973-10-29
19740405,1974-04-05
19741216,1974-12-16
19750221,1975-02-21
19750925,1975-09-25
19760105,1976-01-05
19760123,1976-01-23
19760331,1976-03-31
19761125,1976-11-25
19770324,1977-03-24
19770413,1977-04-13
19770802,1977-08-02
19771125,1977-11-25
19780505,1978-05-05
19780613,1978-06-13
19780712,1978-07-12
19780717,1978-07-17
19781020,1978-10-20
19790110,1979-01-10
19790718,1979-07-18
19800918,1980-09-18
19520218,1952-02-18
19581027,1958-10-27
19590724,1959-07-24
19590915,1959-09-15
19591103,1959-11-03
19591202,1959-12-02
19600518,1960-05-18
19600524,1960-05-24
19610929,1961-09-29
19620219,1962-02-19
19631211,1963-12-11
19640430,1964-04-30
19670405,1967-04-05
0,
19701231,1970-12-31
19710930,1971-09-30
19720218,1972-02-18
19720225,1972-02-25
19720428,1972-04-28
19720619,1972-06-19
19741003,1974-10-03
19701210,1970-12-10
19710528,1971-05-28
19710901,1971-09-01
19710902,1971-09-02
19710924,1971-09-24
19711005,1971-10-05
19720321,1972-03-21
19720428,1972-04-28
19720517,1972-05-17
19720905,1972-09-05
19721106,1972-11-06
0,
19730129,1973-01-29
19730402,1973-04-02
0,
19730828,1973-08-28
19730924,1973-09-24
19731009,1973-10-09
19731022,1973-10-22
0,
19731114,1973-11-14
19731206,1973-12-06
19740325,1974-03-25
0,
19740523,1974-05-23
19740523,1974-05-23
19750213,1975-02-13
19750507,1975-05-07
19750710,1975-07-10
19750826,1975-08-26
0,
0,
19760203,1976-02-03
19760602,1976-06-02
19760630,1976-06-30
19760902,1976-09-02
19761006,1976-10-06
19761214,1976-12-14
19770114,1977-01-14
19770125,1977-01-25
19770211,1977-02-11
0,
19770407,1977-04-07
0,
0,
19770908,1977-09-08
19771103,1977-11-03
19780118,1978-01-18
0,
19780406,1978-04-06
0,
19790208,1979-02-08
19790912,1979-09-12
19791002,1979-10-02
19791116,1979-11-16
19800221,1980-02-21
19800312,1980-03-12
19800527,1980-05-27
19801017,1980-10-17
0,
19801215,1980-12-15
19810209,1981-02-09
19810421,1981-04-21
19810525,1981-05-25
19810603,1981-06-03
19810923,1981-09-23
19820121,1982-01-21
19820720,1982-07-20
19821101,1982-11-01
19821103,1982-11-03
19821222,1982-12-22
0,
19830503,1983-05-03
19830504,1983-05-04
19830510,1983-05-10
19830524,1983-05-24
19830607,1983-06-07
19830719,1983-07-19
0,
19831230,1983-12-30
19840503,1984-05-03
19840703,1984-07-03
19840802,1984-08-02
19840906,1984-09-06
19840924,1984-09-24
19841220,1984-12-20
19850409,1985-04-09
19850513,1985-05-13
19850718,1985-07-18
19850919,1985-09-19
19851128,1985-11-28
19860218,1986-02-18
19861105,1986-11-05
19870121,1987-01-21
19870302,1987-03-02
19880929,1988-09-29
18991221,1899-12-21
19020507,1902-05-07
19021112,1902-11-12
19030316,1903-03-16
19030921,1903-09-21
19020820,1902-08-20
19040315,1904-03-15
19050821,1905-08-21
19620127,1962-01-27
18951218,1895-12-18
18950924,1895-09-24
18970331,1897-03-31
19690130,1969-01-30
18971110,1897-11-10
18971027,1897-10-27
18980218,1898-02-18
18980429,1898-04-29
18990624,1899-06-24
19000210,1900-02-10
19600226,1960-02-26
19640227,1964-02-27
19011009,1901-10-09
19600310,1960-03-10
19620309,1962-03-09
19610310,1961-03-10
19040217,1904-02-17
19040615,1904-06-15
19040913,1904-09-13
19710305,1971-03-05
19620326,1962-03-26
19720310,1972-03-10
19060228,1906-02-28
19060723,1906-07-23
19071207,1907-12-07
19700324,1970-03-24
19090220,1909-02-20
19710329,1971-03-29
19670403,1967-04-03
19100617,1910-06-17
19100723,1910-07-23
19680410,1968-04-10
19600516,1960-05-16
19620517,1962-05-17
19120619,1912-06-19
19710429,1971-04-29
19720428,1972-04-28
19140108,1914-01-08
19660509,1966-05-09
19720508,1972-05-08
19670517,1967-05-17
19140731,1914-07-31


2025-01-20 01:09:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:09:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:09:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:09:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 01:09:21 - snowflake.connector.connection - INFO - closed
2025-01-20 01:09:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:09:21 - root - INFO - SQL:
-- Corrected Query 12
SELECT DISTINCT f.value::VARIANT:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f
LIMIT 1000
Results:
Too long, hard cut:
assignee_name
SIMPES FAIP S P A
NUOVA FEDER SPA
EMAK SPA
BRUNNER JURAJ ING
KRAUS PETER
HERNANDO ARTIME FELIPE RUPERTO
KIMBERLY CLARK CO
UNIV MAGDEBURG TECH
ROCKWOOL INT
DANFOSS AS
JANSSEN PHARMACEUTICALS INC
ETUDE REALISA CYBERNETIQUE IND
PEUGEOT
KRAFT FOODS R & D INC
MEGABASS INC
METALLURGICAL PROCESSES LTD
DEGTYAREV VALENTIN N
COREL CORP
MILLIGAN STEPHEN D
MARANDI ALI
PIONEER TOHOKU CORP
BAUER DAVID L
SANCHEZ MAURICIO
SEPRO CORP
ECHIGO MASATOSHI
COOPER ALEX
HUNG JONATHAN
MONOGEN INC
ZHOU YUE
CORSON PHILLIP L
DUDLEY KRISTYE DORILAM ADDISON
NIKE INC
BENDIX COMMERCIAL VEHICLE SYS
NOVA CHEMICALS (INTERNATIONAL) S A
MICROELECTRONICS TECH INC
HURWITZ JONATHAN EPHRAIM DAVID
TECHNION RES & DEV FOUNDATION
CHICAGO BY PRODUCTS CORP
GLASS MURRAY L
EXXON RESEARCH ENGINEERING CO
STIFT ROBERT J
ALEXANDER RAMADEN GEORGE
LOCK LEE CHOY
NIPPON KOGAKU KK
TAIWAN SEMICONDUCTOR MFG
LEE TU
CHARLES O SANDER
TROUP JOHN H
KOTZIN
WILLIAM SCHEPLER
JOHNSON RES CORP
WYSS FRANZ
CLARK ELMER A
SLAVEN JOHN J
OF CHEMICAL INDUSTRY SOC
AMERICAN TOBACCO CO
AMETEK INC
AJINOMOTO KK
BOWLER FRANK WM
FRIEDRICH SCHUMANN
ALFA FARMACEUTICI SPA
MASTER VIBRATOR CO
HALL WILLIAM L
NIIGATA PREFECTURE
GRINKEVICH ALEKSANDR VASIL EVICH
SERVIER LAB
LYUBEZNOV VALERIJ KONSTANTINOVICH
DVOEGLAZOV ALEKSEJ IVANOVICH
SCHAEFER ELEKTROTECHNIK U SONDERMASCHINEN GMBH
ATATUERK UENIVERSITESI BILIMSEL ARASTIRMA PROJELERI BIRIMI
ASEA AB
SHINDENGEN ELECTRIC MFG CO
ZIMMERMANN GISELA
VIVATECH COMPANY
BESTHEALTH4U LDA
BUENO CARLOS JAYME
EGOROVA ELENA GERTRUDOVNA
BAUN D
OLIP ITALIA SPA
UNIV OF KENTUCKY
TUMIDEI GABRIELE
ESPINO RIZALINO M
TODO PRODUKTIONS & FOERSAELJNI
TECHEM ENERGY SERVICES GMBH
FARMER L
BERETTA A ING SPA
ELIESON CHAIMSONOVITZ PROSPER
MARSHALL & ILSLEY BANK
JAMES B BLACKBURN
BERACA SABARA QUIMICOS E INGRE
SWEETSER BERT M
LELAND ELECTRIC CO
BOGIE N
KELVINATOR CORP
REDINGTON COUNTERS INC
STOCK EQUIPMENT CO
BISSETT & SONS LTD J
TAITO CORP
GROSS ISAK
TELEX CORP THE
TURNER BROTHERS ASBEST
HITACHI SOFTWARE ENG
BECKER JENS-ULRIK
BELLIS MARK J E
SNIFFIN KEVIN
EBISAWA FUMIHIRO
METAL IND RES & DEV CT
KIM SUNG-HO
CYR DOUGLAS ROBERT
BORSIG GMBH
NEC LAB AMERICA INC
KIOXIA CORP
SUBARU CORP
MIN OBORONY ROSSIJSKOJ FEDERAT
FURMAN EVGENIJJ L
HOTSET HEIZPATRONEN ZUBEHOER
CREAVIS TECH & INNOVATION GMBH
SIGMEX LTD
MATRA DEFENSE
JEOL USA INC
SHAIKH IMTIYAZ
RAAB THOMAS WOLFGANG
NICHIA CORP
KHAN NASEEM A
BEAR BRIAN RICHARD
ROCHE DIAGNOSTICS OPERATIONS INC
POWER FINGERPRINTING INC
COVIDIEN AG
KLAESSIG OSKAR PAUL
FIRM OF OTTO URBAN
GREAT WESTERN ELECTRO CHEMICAL CO
FAVRE & CIE
TRAYWAY MFG CO
KING SEELEY CORP
RUDGE WHITWORTH LIMITED
BANGE CHARLES DE
MADDEN CHARLES H
POETSCHKE PAUL
JEPSON SYSTEMS COMPANY LTD
HENRY DREYFUS
WIRTGEN GMBH
MCKAY ROBERT
UNIV MASSACHUSETTS
PHAM NGHI
S & S CYCLE INC
HITACHI LG DATA STORAGE INC
DEGUCHI HIROSHI
HANDGEN ERIN A
LASSUS ANDERS
FUJIO SHOHHEI
FOSTER WHEELER ENERGIA OY
NOBLE FIBER TECHNOLOGIES LLC
CHEN FENG-TIEN
BLASTWORKS INC
GTX INC
TOWERJAZZ PANASONIC SEMICONDUCTOR CO LTD
SIN SIST DE IMPLANTE NACIONAL LTDA
GOLDEN LADY SPA
ALMASSY STANISLAV
SWAMINATHAN GANESH
HORSCH LEEB APPLICATION SYSTEMS GMBH
RES & IND COOPERATION GROUP
KANG JI YEON
JUNG GI YUL
HAESHIN
KANTO ISHI PHARMA CO LTD
KONO NAOYUKI
SWEEN TY
DEVROE ERIC
LARYNGEAL MASK CO LTD
MOLYNEUX STEPHEN
JOHNSON & JOHNSON SURGICAL VISION INC
BERTHIEZ C N M P
BASF PLANT SCIENCE CO GMBH
CQLT SAARGUMMI TECH SARL
HEFEI MIDEA REFRIGERATOR CO
FERROLI SPA
STEFFENS RALF
ZHANG JINGLIN
XIAMEN CHANGELIGHT CO LTD
MURATA TOSHIKI
SUMITOMO METAL MINING CO
SOLINAS MEDICAL INC
HEWLETT PACKARD DEVELOPMENT CO LP
RADIABEAM TECH LLC
Evol Science LLC
MARTINEZ CANALES MONICA LUCIA
ROLLERBLADE INC
WAVE OPTICS LTD
JIANGSU SHEMAR ELECTRIC CO LTD
KANG MIN SOO
LUEDTKE OLIVER
BUONO JUAN C MR
FARGO KENDALL M
KELLER IGOR
MONOPANEL SA
TOLEDO ERAN
GALLER KURT
GOTFRIED YECHIEL
VIVANT MEDICAL INC
CANON STAAR CO INC
KROPPE WILLIAM J
SURFACE SPECIALTIES AUSTRIA
YAO ROSE
HAMMONDS CARL L
ADDISON CLEAR WAVE LLC
DOBRESKI DAVID V
TARAMINO GRAZIANA
YUN CHANG-HUN
KIM SAN HONG
SCINTOMICS GMBH
ZIMMER INC
ST MICROELECTRONICS ROUSSET
BEXSON BIOMEDICAL INC
HEFEI CAS LANRUI TECH CO LTD
BUESCH BERND
IVANOVA TATYANA P
HOBOT TECH INC
VASSEUR JEAN-PHILIPPE
OILUND LESTER D
CHRISTL WERNER
FINE HOWARD A
TUTTLE G TYSON
KOESTER DAVID A
OPOLSKI STEVEN W
JIANG MING
ADVANCED BIONICS LLC
KOFLER KEVIN J
HOOVER LTD
RONG GUOHUA
SHENZHEN ROYOLE TECHNOLOGIES CO LTD
MASSI OSVALDO MAXIMILIANO
SHANDONG SHUNFENG BIOTECHNOLOGY CO LTD
UNIV ALBERT LUDWIGS FREIBURG
TORBJORN AFDAL
CHARMGLOW PRODUCTS INC
GE HEALTHCARE AS
LOFFLER STEPHEN
PALMER ROBERT F
HENLEY S TYRE & RUBBER COMPANY
RONALD W SCHULTZ
GIBERT CARLOS M
STANTON JOHN H
SONAB DEV AB
LICHTENSTEIN JULIUS
MORRIS KATCHER
BROWN DENNIS N
ULTIMOS DESARROLLOS
LAVROVSKY VLADIMIR V
WILLIAM D ALTON
GUILD LEIGH S
THOMAS HYDRAULIC SPEED COUTROL
THEODORE DAVID T
HAAKER WILLIAM
BOLOIT IRON WORKS
CARSON WILLIAM
BARTH W
REED TOOL CO
HORTON JAMES ALEXANDER
GARVIE HERBERT THOMPSON
BEMIS BROS BAG COMPANY
MCKAY JOHN A
VMW RANSHOFEN BERNDORF AG
KE

2025-01-20 01:09:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:09:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:09:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:09:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 93
2025-01-20 01:09:23 - snowflake.connector.connection - INFO - closed
2025-01-20 01:09:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:09:23 - root - INFO - SQL:
-- Corrected Query 13
SELECT t."country_code",
       COUNT(DISTINCT t."publication_number") AS "total_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t
GROUP BY t."country_code"
ORDER BY "total_applications" DESC
LIMIT 1000
Results:
country_code,total_applications
CN,208729
JP,110525
US,57953
KR,28416
CA,13358
DE,12656
AU,9744
WO,9409
EP,8335
GB,5551
AT,4482
BR,4469
TW,4270
IT,3866
CH,3513
FR,3326
RU,2979
SU,2526
BE,2457
ES,2080
SE,1473
NL,1274
ZA,1261
PL,1187
IL,1185
HU,969
NO,890
MX,863
DD,722
AR,666
DK,575
CS,528
UA,479
FI,467
HK,440
CZ,414
PT,372
IE,372
SG,284
NZ,276
CL,267
BG,265
YU,228
IN,222
TR,222
GR,207
MY,195
RO,172
HR,167
LU,139
CO,118
SI,117
PH,116
EA,108
SK,99
CY,81
PE,77
AP,65
MA,54
LT,50
ID,43
CR,41
RS,38
MD,30
OA,29
IS,28
JO,26
CU,23
GE,23
LV,23
SA,20
EG,18
GT,15
TN,15
EC,14
SM,11
ZM,10
EE,7
NI,7
DO,6
HN,5
PA,5
KE,5
ME,5
MC,4
MW,4
SV,3
ZW,2
MT,1
BA,1
KZ,1
MN,1
DZ,1

2025-01-20 01:09:23 - root - INFO - itercount: 0
2025-01-20 01:09:23 - root - INFO - Database Name: PATENTS
Schema Name: PATENTS
DDL describes table information.
,0
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,1
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""spif_publication_number"" VARCHAR(16777216),
	""spif_application_number"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""claims_localized_html"" VARIANT,
	""description_localized"" VARIANT,
	""description_localized_html"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""locarno"" VARIANT,
	""citation"" VARIANT,
	""parent"" VARIANT,
	""child"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,2
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
To address the task, we need to identify the relevant tables, columns, and possible conditions.

**Relevant Tables and Columns:**

- **Table:** `PATENTS.PATENTS.PUBLICATIONS`

  - **"cpc"**: Contains the Cooperative Patent Classification codes in a VARIANT format; used to identify patents in class "A01B3".
  
  - **"assignee_harmonized"**: A VARIANT column containing the assignee names; used to identify the assignees of patents.
  
  - **"filing_date"**: Numeric date of the application filing; used to extract the year with the most applications.
  
  - **"country_code"**: Country code associated with the patent; used to find the country with the most applications.
  
  - **"publication_number"**: Identifier for the patent publication; used to count the number of applications.

**Possible Conditions:**

- Filter patents classified under CPC code starting with "A01B3".
  
- Extract and group by assignee names to find the top assignees.
  
- Extract the year from "filing_date" to identify the year with the most applications.
  
- Group by "country_code" to find the country with the most applications in that year.

**SQL Queries to Explore the Data:**

1. **View sample CPC codes to understand the structure:**

   ```sql
   SELECT f.value
   FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
   LIMIT 1000;
   ```

2. **Extract CPC codes composed from VARIANT fields:**

   ```sql
   SELECT f.value::VARIANT:"section"::STRING || f.value::VARIANT:"class"::STRING || f.value::VARIANT:"subclass"::STRING || f.value::VARIANT:"main_group"::STRING || '/' || f.value::VARIANT:"subgroup"::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
   LIMIT 1000;
   ```

3. **List patents classified under CPC code "A01B3%":**

   ```sql
   SELECT DISTINCT t."publication_number"
   FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::VARIANT:"section"::STRING || f.value::VARIANT:"class"::STRING || f.value::VARIANT:"subclass"::STRING || f.value::VARIANT:"main_group"::STRING ILIKE 'A01B3%'
   LIMIT 1000;
   ```

4. **Explore the structure of "assignee_harmonized":**

   ```sql
   SELECT f.value
   FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."assignee_harmonized") f
   LIMIT 1000;
   ```

5. **Extract assignee names from "assignee_harmonized":**

   ```sql
   SELECT f.value::VARIANT:"name"::STRING AS "assignee_name"
   FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."assignee_harmonized") f
   LIMIT 1000;
   ```

6. **List filing dates to understand the format:**

   ```sql
   SELECT t."filing_date"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 1000;
   ```

7. **Extract filing years from "filing_date":**

   ```sql
   SELECT TO_VARCHAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 1000;
   ```

8. **List country codes for patents in class "A01B3":**

   ```sql
   SELECT t."country_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::VARIANT:"section"::STRING || f.value::VARIANT:"class"::STRING || f.value::VARIANT:"subclass"::STRING || f.value::VARIANT:"main_group"::STRING ILIKE 'A01B3%'
   LIMIT 1000;
   ```

9. **Count the number of applications per assignee for class "A01B3":**

   ```sql
   SELECT f_assignee.value::VARIANT:"name"::STRING AS "assignee_name", COUNT(DISTINCT t."publication_number") AS "application_count"
   FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f_cpc, LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee
   WHERE f_cpc.value::VARIANT:"section"::STRING || f_cpc.value::VARIANT:"class"::STRING || f_cpc.value::VARIANT:"subclass"::STRING || f_cpc.value::VARIANT:"main_group"::STRING ILIKE 'A01B3%'
   GROUP BY "assignee_name"
   ORDER BY "application_count" DESC
   LIMIT 1000;
   ```

10. **Identify the year with the most applications per assignee:**

    ```sql
    SELECT f_assignee.value::VARIANT:"name"::STRING AS "assignee_name", TO_VARCHAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') AS "filing_year", COUNT(DISTINCT t."publication_number") AS "application_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f_cpc, LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee
    WHERE f_cpc.value::VARIANT:"section"::STRING || f_cpc.value::VARIANT:"class"::STRING || f_cpc.value::VARIANT:"subclass"::STRING || f_cpc.value::VARIANT:"main_group"::STRING ILIKE 'A01B3%'
    GROUP BY "assignee_name", "filing_year"
    ORDER BY "assignee_name", "application_count" DESC
    LIMIT 1000;
    ```

11. **Find the most common country code for applications in a given year:**

    ```sql
    SELECT t."country_code", COUNT(DISTINCT t."publication_number") AS "application_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::VARIANT:"section"::STRING || f.value::VARIANT:"class"::STRING || f.value::VARIANT:"subclass"::STRING || f.value::VARIANT:"main_group"::STRING ILIKE 'A01B3%'
    AND TO_VARCHAR(TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD'), 'YYYY') = '2020'
    GROUP BY t."country_code"
    ORDER BY "application_count" DESC
    LIMIT 1000;
    ```

12. **List patents with their filing date and country code for class "A01B3":**

    ```sql
    SELECT t."publication_number", t."filing_date", t."country_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::VARIANT:"section"::STRING || f.value::VARIANT:"class"::STRING || f.value::VARIANT:"subclass"::STRING || f.value::VARIANT:"main_group"::STRING ILIKE 'A01B3%'
    LIMIT 1000;
    ```

13. **Explore the structure of "filing_date" to confirm date format:**

    ```sql
    SELECT t."filing_date", TO_DATE(t."filing_date"::VARCHAR, 'YYYYMMDD') AS "filing_date_formatted"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    LIMIT 1000;
    ```

14. **List distinct assignee names:**

    ```sql
    SELECT DISTINCT f.value::VARIANT:"name"::STRING AS "assignee_name"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."assignee_harmonized") f
    LIMIT 1000;
    ```

15. **Count total number of patents per country code:**

    ```sql
    SELECT t."country_code", COUNT(DISTINCT t."publication_number") AS "total_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    GROUP BY t."country_code"
    ORDER BY "total_applications" DESC
    LIMIT 1000;
    ```

These queries aim to explore the relevant data needed to address the task by examining the necessary columns and understanding the structure of the VARIANT fields.Query:
SELECT f.value
   FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
   LIMIT 1000;
Answer:
Too long, hard cut:
VALUE
"{
  ""code"": ""G06F1/3253"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06F1/266"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06F13/364"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06F1/3237"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06F1/266"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06F1/3237"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06F1/3253"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06F13/364"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""Y02D10/00"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""Y02D30/50"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""Y02D10/00"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""Y02D30/50"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""G06F13/364"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/08"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H03K2017/0806"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/687"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/082"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H03K2017/0806"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01L2224/73265"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01L2224/48091"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01L2924/13091"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/6871"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/687"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L2224/73265"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H03K2017/6875"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/102"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01L2924/13055"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/082"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/08"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H03K2017/6875"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01L2224/48091"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H03K2017/0806"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/102"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/687"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/6871"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L2924/13091"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/08104"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/08"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L2924/13055"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H03K17/08104"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H04N1/3877"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H04N1/3877"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06K15/1842"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H04N2201/0094"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H04N1/3877"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""G06K15/1886"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""B64C25/26"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""B64C25/26"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L31/022425"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""Y10T428/24917"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
"{
  ""code"": ""H01L31/028"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""H01L31/022458"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""C30B29/06"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
"{
  ""code"": ""Y10T428/24917"",
  ""first"": false,
Query:
SELECT f.value::VARIANT:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
LIMIT 1000;
Answer:
Too long, hard cut:
cpc_code
H01L2223/665
H01L29/0821
H01L29/36
H03F3/195
H03F3/213
H01L2223/6655
H01L29/365
H01L23/66
H01L29/737
H01L29/7325
H01L29/0821
H01L29/205
H01L29/73
H01L2223/6677
H01L29/7371
H01L29/0826
H01L29/165
H01L29/66242
H03F2200/451
H01L29/7378
H01L29/7371
H01L29/36
H01L2223/6683
H01L2223/6683
H01L2223/6655
H03F3/195
H01L29/7371
H01L29/365
H01L29/165
H01L29/0821
H01L29/66242
H01L23/66
H01L29/205
H01L29/737
H01L29/0826
H01L29/36
H01L29/7378
H01L2223/665
H01L29/73
H01L29/7325
H01L2223/6677
H01L29/365
Y10T29/4984
F26B15/12
F26B15/122
F26B25/004
F26B2210/14
F26B15/122
Y10T29/4984
F26B2210/14
F26B15/122
F26B25/004
F26B15/12
Y10T29/4984
F26B2210/14
B23C5/2213
B23C2200/367
B23C2210/161
B23C2226/315
B23C2210/168
B23C5/22
B23C2226/125
B23C2200/367
B23C2220/00
B23C5/22
B23C5/22
B23C2220/00
B23C2210/161
B23C5/2298
G06F1/1656
H04M1/185
H04M1/21
G06F1/1626
H04B1/3888
F24V30/00
H04M1/21
H04M1/185
H04B1/3888
G06F1/1656
G06F1/1626
F24V30/00
G06F1/1656
G06F1/1626
F24V30/00
H04M1/21
H04M1/185
H04B1/3888
H05B45/20
H05B47/19
H05B45/20
H05B45/24
F21V33/00
F21V3/02
F21S9/02
F21Y2113/10
F21Y2115/10
F21S10/00
F21V31/00
F21V33/008
A01K85/01
A01K79/02
F21Y2115/10
F21V31/00
A01K69/06
F21V3/0625
A01K75/02
F21L4/08
F21V31/00
F21V33/008
H05B37/0272
F21Y2115/10
F21V3/0625
H05B33/0866
A01K85/01
F21L4/08
H05B33/086
A01K85/01
A01K85/01
A01K79/02
A01K79/02
A01K75/02
H05B47/19
G06F8/65
G06F8/65
G06F8/71
G06F8/654
G06F8/61
H04L41/082
H04L41/082
G06F8/61
G06F8/71
G06F8/654
G06F8/65
H04L43/0811
H04L41/0654
H04L41/0654
H04L2012/40273
H04L12/40
H04L2012/40215
H04L2012/40273
H04L12/40176
H04L2012/40215
H04L2012/40273
H04L2012/40215
H04L12/40
H04L41/0654
H04L12/40006
H04L12/40176
H04L12/40006
H04L43/0811
A61B5/7475
A61B5/14532
G16H20/10
A61B5/7475
A61B5/14532
A61B5/14546
G16H40/63
G08B21/24
A61B5/14546
A61B5/7475
A61B5/14532
G04G13/02
A61B5/00
G16H40/63
G08B21/24
G16H40/63
A62C37/04
G01M3/045
G05B19/042
A62C35/68
A62C3/004
G05B2219/2625
A62C37/36
A62C37/50
G01N17/043
G05B19/042
A62C37/36
G05B2219/2625
A62C37/04
A62C35/62
G01N17/043
A62C3/004
A62C35/68
A62C35/62
G01M3/045
A62C37/50
A01K91/065
A01K91/065
A01K93/00
A01K93/00
A01K97/01
A01K93/00
A01K97/01
H04L67/325
H04L67/1097
H04L67/2852
H04L67/5682
H04L67/60
H04L67/62
H04L67/60
G06F16/182
H04L67/1097
G06F16/182
H04L67/1097
H04L49/1507
H04L49/1515
H04Q11/0062
H04B10/40
H04L12/4625
H04Q2011/006
H04B10/25
H04Q11/0003
H04Q2011/0096
H04Q11/0071
H04Q2011/0098
H04L12/44
H04L41/0826
H04L12/4625
H04L47/125
H04Q2011/0098
H04Q2011/0096
H04Q11/0071
H04L45/122
H04L41/12
H04L47/125
H04L41/12
H04Q2011/0096
H04L45/122
H04L12/44
H04Q2011/0098
H04L41/0826
H04Q11/0071
H04Q2011/0096
H04Q2011/006
H04Q2011/0052
H04Q11/0071
H04Q11/0062
H04Q11/0005
H04Q11/0003
H04L49/1515
H04L49/15
H04L47/125
H04L45/122
H04L41/0826
H04L12/4625
H04L12/44
H04B10/25
H04B10/40
H04L41/12
H04L41/12
H01S5/0237
H01L24/03
H01S5/02345
H01S5/0237
H01L2924/12042
H01L2224/04026
H01L24/32
H01L2224/83801
H01L2224/29111
H01L2224/29144
H01L2224/0383
H01L2224/29144
H01L2224/32245
H01L2224/05684
H01L2924/15747
H01L2224/29109
H01L2224/29139
H01L2224/05681
H01L2224/29139
H01L2224/05573
H01L2224/32245
H01L2224/29111
H01L2224/0568
H01L2224/05681
H01L2224/05684
H01L24/83
H01L2924/12042
H01S5/02212
H01L24/29
H01L2924/15747
H01L2224/0567
H01L24/05
H01L2224/05686
H01L2224/05666
H01L24/83
H01L2224/05664
H01S5/02212
H01L2224/0383
H01L2224/04026
H01L2224/29109
H01L24/32
H01L2224/05624
H01L2224/05666
H01L24/29
G01N2021/399
H01L2224/05663
H01L2224/05669
H01L2224/0567
H01L2224/05686
H01L2224/05664
H01L2224/05669
H01L24/03
H01L2224/05573
H01L24/05
H01S5/068
H01L2224/83801
H01L2224/05624
G01N21/39
H01L2224/05663
H01L2224/0568
G01N2021/399
H01S5/02272
H01S5/068
G01N21/39
H05K5/0204
H05K5/0204
H05K7/183
G12B9/10
G12B9/10
H05K5/0204
H05K7/183
G01C21/3438
G01C21/343
H04W4/02
H04W4/40
G06Q30/0643
G06Q10/02
G06Q10/047
G06Q30/06
G06Q10/063
G01C21/343
G01C21/362
G01C21/343
G05D1/0287
G05D2201/0213
G05D1/0088
G01C21/362
G06Q30/0639
G06Q10/08
G05D1/0287
G05D1/0088
H04W72/569
H04W72/569
H04W74/0841
H04L1/1607
H04L5/14
H04W76/11
H04L5/005
H04W72/0446
H04W76/11
H04L1/1607
H04L5/005
H04L5/14
H04W72/0446
H04W74/0841
H04W72/569
H04W72/21
H04W72/0453
H04W72/0446
H04W52/146
H04L5/0053
H04L5/0051
H04L1/0013
H02P6/182
H02P25/089
G01R27/2611
H02P6/16
H02P6/182
H02P25/089
G01R27/2611
H02P6/182
H02P6/185
H02P6/16
C12N9/1029
C07K2319/00
C12N9/1029
C07K2319/00
C12N9/1029
C07K2319/00
B62D21/15
B60K1/04
B62D21/09
B60K2001/0438
B60K1/04
B60K2001/0438
B60K2001/0438
B60K1/04
B60K1/04
B60K2001/0438
F16L23/06
F16L37/18
F16L37/18
H04L41/0894
H04L45/42
H04L63/0227
H04L47/122
H04L41/12
H04L63/20
H04L45/04
H04L41/0893
H04L41/0893
H04L41/12
H04L63/0227
H04L63/20
H04L63/0263
C04B35/2683
C04B35/26
C04B2235/3286
C04B35/26
C04B2235/3418
C04B35/2641
C04B2235/3418
C04B2235/3224
C04B35/2608
C04B2235/3201
C04B2235/80
C04B2235/3213
C04B2235/96
C04B35/622
C04B2235/3217
C04B2235/3293
C04B2235/767
C04B2235/3275
C04B2235/3213
C04B2235/3229
C04B2235/3229
C04B2235/3201
C04B2235/3286
C04B2235/3232
C04B2235/3262
H01Q7/06
C04B2235/
Query:
-- Corrected Query 1
SELECT DISTINCT t."publication_number"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A01B3%'
LIMIT 1000
Answer:
publication_number
BE-826346-A
PL-440426-A1
US-2784656-A
AU-2016269849-A1
US-159642-A
KR-102484290-B1
KR-100626846-B1
ZA-808003-B
BE-1007083-A5
KR-20020000597-A
DE-102017102683-A1
EP-3474651-C0
CN-114651538-A
KR-101378314-B1
US-1412308-A
GB-2039201-B
KR-101593221-B1
DE-463858-C
CN-107646212-A
CN-113796181-A
US-130700-A
FR-508965-A
CA-2977468-A1
DE-1963184-U
DE-140654-C
CN-113761309-A
KR-102593393-B1
US-5845717-A
US-10375891-B2
KR-101169320-B1
US-5267618-A
US-5669452-A
GB-2090713-B
CN-107072143-A
KR-200473688-Y1
IL-268624-A
CN-100366901-C
GB-2598141-A
NL-7909063-A
AU-2002301383-B2
NO-910950-L
EP-3586579-A1
KR-20020067218-A
GB-696973-A
CA-997451-A
US-828171-A
US-1471180-A
CA-2945250-A1
CN-115362764-A
GB-2089182-B
DE-829523-C
FR-2943502-A1
US-5407014-A
US-1860534-A
JP-S6342702-Y2
KR-20070101567-A
BE-872468-A
GB-792883-A
JP-6998053-B2
US-395573-A
US-231385-A
US-376176-A
US-1636048-A
CN-104040083-B
US-2843032-A
KR-100191418-B1
US-3054462-A
CN-109005687-A
US-3963079-A
IT-8519066-A1
CA-3089518-A1
AU-7115874-A
CN-106973572-B
CN-108289407-A
CN-114916261-A
CN-108575125-A
KR-20130063834-A
US-1545136-A
AT-A720679-A
US-290366-A
HU-E050035-T2
KR-20010029583-A
US-469659-A
US-220177-A
GB-436304-A
US-2888084-A
CA-2543900-A1
NL-183071-C
FR-2287837-B1
DE-8707829-U1
KR-200487998-Y1
FR-960102-A
US-501724-A
IT-1064821-B
BE-727862-A
KR-200386017-Y1
RU-191537-U1
US-2039702-A
KR-200194260-Y1
NO-153631-B
US-694931-A
KR-200149462-Y1
US-2019324472-A1
IT-1166526-B
US-1093294-A
KR-900006618-B1
US-2031188-A
US-1081539-A
US-2545590-A
US-3129772-A
CN-109392332-A
CN-116671357-A
US-2024164239-A1
DE-102010019819-B4
CN-105325075-A
US-2597821-A
JP-6910281-B2
CN-107094377-A
US-530054-A
Query:
-- Corrected Query 2
SELECT f.value
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."assignee_harmonized") f
LIMIT 1000
Answer:
Too long, hard cut:
VALUE
"{
  ""country_code"": ""US"",
  ""name"": ""PSIQUANTUM CORP""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""TYCO FIRE PRODUCTS LP""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""BLACK & DECKER INC""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""SAFRAN""
}"
"{
  ""country_code"": ""CN"",
  ""name"": ""GUANGDONG OPPO MOBILE TELECOMMUNICATIONS CORP LTD""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""PREC BIOSCIENCES INC""
}"
"{
  ""country_code"": ""IT"",
  ""name"": ""AREA IMPIANTI S P A""
}"
"{
  ""country_code"": ""SE"",
  ""name"": ""CANDELA TECH AB""
}"
"{
  ""country_code"": ""PL"",
  ""name"": ""UNIV PRZYRODNICZY W POZNANIU""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""TOTALENERGIES ONE TECH""
}"
"{
  ""country_code"": ""DE"",
  ""name"": ""BOSCH GMBH ROBERT""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""MICROSOFT TECHNOLOGY LICENSING LLC""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""PANASONIC IP MAN CO LTD""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""NAUTILUS SUBSIDIARY INC""
}"
"{
  ""country_code"": ""CN"",
  ""name"": ""VIVO MOBILE COMMUNICATION CO LTD""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""INST NAT SANTE RECH MED""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""HOPITAUX PARIS ASSIST PUBLIQUE""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""UNIV VERSAILLES SAINT QUENTIN EN YVELINES""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""LEXAT""
}"
"{
  ""country_code"": ""KR"",
  ""name"": ""KMW INC""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""PANASONIC IP MAN CO LTD""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""MEDTRONIC INC""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""CNH IND AMERICA LLC""
}"
"{
  ""country_code"": ""CN"",
  ""name"": ""HONOR DEVICE CO LTD""
}"
"{
  ""country_code"": ""DE"",
  ""name"": ""BAYER AG""
}"
"{
  ""country_code"": ""DE"",
  ""name"": ""SIEMENS AG""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""FRANCE ETAT""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""JOHNSON ROBERT ROYCE""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""CALGON CARBON CORP""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""RENAULT""
}"
"{
  ""country_code"": ""IT"",
  ""name"": ""WEBER SPA""
}"
"{
  ""country_code"": ""AT"",
  ""name"": ""INJECT STAR POEKELMASCH""
}"
"{
  ""country_code"": ""NL"",
  ""name"": ""UITERT SPEC MASCHF VAN""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""MOTOROLA INC""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""SIGMA ENTERPRISES INC""
}"
"{
  ""country_code"": """",
  ""name"": ""WALTER IGNAZ""
}"
"{
  ""country_code"": ""AT"",
  ""name"": ""ROHRMOSER ALOIS SKIFABRIK""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""MITSUI TOATSU CHEMICALS""
}"
"{
  ""country_code"": ""IT"",
  ""name"": ""MONTEDISON SPA""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""MICROBIAL CHEM RES FOUND""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""ROCKWELL CIM""
}"
"{
  ""country_code"": ""AU"",
  ""name"": ""COMMW SCIENT IND RES ORG""
}"
"{
  ""country_code"": ""DE"",
  ""name"": ""HOESCH STAHL AG""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""CIBEVIAL""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""IMEDEX""
}"
"{
  ""country_code"": ""DE"",
  ""name"": ""EM TECH GMBH""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""STANLEY WORKS LTD""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""APPLIED MED RES LTD""
}"
"{
  ""country_code"": ""DE"",
  ""name"": ""BAYER AG""
}"
"{
  ""country_code"": ""CH"",
  ""name"": ""CABLOPTIC SA""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""US GOV HEALTH & HUMAN SERV""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""RENAULT""
}"
"{
  ""country_code"": ""DE"",
  ""name"": ""TILLACK JOACHIM""
}"
"{
  ""country_code"": ""SE"",
  ""name"": ""CELLECO HEDEMORA AB""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""GREEN CROSS CORP""
}"
"{
  ""country_code"": ""DE"",
  ""name"": ""KURHESSISCHE MOLKEREIZENTRALE""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""IBM""
}"
"{
  ""country_code"": ""GB"",
  ""name"": ""SMITHKLINE BEECHAM PLC""
}"
"{
  ""country_code"": ""DE"",
  ""name"": ""JOHANN PEFFEKOEVER GMBH & CO K""
}"
"{
  ""country_code"": ""IT"",
  ""name"": ""OCEAN IDROCLIMA S P A""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""SERVICE DE MACHINES ET OUTILLA""
}"
"{
  ""country_code"": ""DE"",
  ""name"": ""BALCKE DUERR GMBH""
}"
"{
  ""country_code"": ""FR"",
  ""name"": ""SALOMON SA""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""KONISHIROKU PHOTO IND""
}"
"{
  ""country_code"": ""DK"",
  ""name"": ""DSC COMMUNICATIONS AS""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""USF FILTRATION & SEPARATIONS""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""FENDER MUSICAL INSTR CORP""
}"
"{
  ""country_code"": ""JP"",
  ""name"": ""TORAY INDUSTRIES""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""MOBIL OIL CORP""
}"
"{
  ""country_code"": ""GB"",
  ""name"": ""ASTRAZENECA UK LTD""
}"
"{
  ""country_code"": ""US"",
  ""name"": ""TEXTRON AUTOMOTIVE CO INC""
}"
"{
  ""country_code"": ""DE"",
  ""name"": ""BAS
Query:
-- Corrected Query 3
SELECT f.value::VARIANT:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."assignee_harmonized") f
LIMIT 1000
Answer:
Too long, hard cut:
assignee_name
OROSKAR ANIL R
PARIKH SAURABH P
OROSKAR ASHA A
JOHNSON KENNETH U
ESCARCEGA ANTHONY J
HILAKIVI ILKKA T
LEICA MICROSYSTEMS
IBM
MATSUSHITA ELECTRIC IND CO LTD
NCR CORP
SHIM WOO-SEOK
PARK YOUNG-WOOK
LEE JUNG-HYEON
YOON KWANG-SUB
KIM CHUL-HO
PARK TAE-JIN
LAGASSEY PAUL J
HYNIX SEMICONDUCTOR INC
MIN HYUN K
CHO YONG B
HONEYWELL INT INC
MEDTRONIC VASCULAR INC
IBM
SMS MEER GMBH
NICOLET PLASTIQUE LTEE
AUTOMATED PACKAGING SYST INC
SUMITOMO CHEMICAL CO
IBM
SEIKO EPSON CORP
PALVA TAPIO
MONTESANO MARCOS
MICROSOFT CORP
PARAMOUNT LEISURE IND INC
BROWN THOMAS R
LAO ICH-KIEN
SLIVERNAIL WILLIAM B
MARTINEZ RANDY G
DALOLA ALBERT J
MEDIVIR AB
JENQ CHING-SHI
YEN TING P
TOYODA GOSEI KK
LEVIN EDUARD
NOBLE PAUL E
BOSTIC R S
CAWLEY CLIFF
CAWLEY DON
GLENN JAMES
OKI ELECTRIC IND CO LTD
NITTO DENKO CORP
CONVERGIN
STRAND JOHN T
UNIV NORTH CAROLINA
EPSHTEYN GRIGORIY
INFOLENZ CORP
SHARP KK
IBM
NISSIN KOGYO KK
ANALOG DEVICES INC
IBIDEN CO LTD
NEOSE TECHNOLOGIES INC
CYCLACEL LTD
SHTURMAN CARDIOLOGY SYSTEMS
HITACHI CABLE
SANYO ELECTRIC CO
NOYES ANNA V
DEAK JOHN C
SCHEIBEL JEFFREY J
VINSON PHILLIP K
HARTMAN FREDERICK A
LAURENT JAMES CHARLES THEOPHIL
SEVERNS JOHN C
RADOMYSELSKI ARSENI V
FRANCE PAUL A
COLLINS JEROME H
THOEN CHRISTIAAN ARTHUR J K
SAKKAB NABIL Y
ELEMENT CXI LLC
BUCH DEEP
GARG VIVEK
MAIYURAN SUBRAMANIAM
SUN MICROSYSTEMS INC
SHAPIRO PEYSAKH
SHAPIRO SABINA
SHAPIRO JOHN R
SHAPIRO AMENDA D
HALLIBURTON ENERGY SERV INC
HAYASHI CHIHIRO
NOVELL INC
SYNERGISTIC NEUROTHERAPY ADJUS
WESTFALIA SEPARATOR AG
POLLARD ALBERT C
STEWART ROBERT E
AIZIKOWITZ TAMAR
ROTH ISRAEL
SHERWIN REUVEN
BROADCOM CORP
SWA HOLDING COMPANY INC
CELION NETWORKS INC
KONICA MINOLTA OPTO INC
NAVARRO LUIS
NAVARRO NESTOR
SALAT CARLOS BONE
EHBEN THOMAS
SCHMIDT SEBASTIAN
STROB WOLFGANG
UNIV CHICAGO
RIGEL PHARMACEUTICALS INC
SHINKO ELECTRIC IND CO
UPHUS REINHARD
KIM IN GYU
PARK BYUNG IL
KOO JA HYUNG
KIM YANG HO
HEO KYEONG WOOK
SUNG SI KYONG
LEE DONG HYUK
KO YOUNG HWAN
HWANG JUN HYEON
SONG HO JIN
HWANG JIN SEONG
HONG YOUNG HO
CHOI HWAN JONG
HWANG GEUN BAE
KANG CHUN SU
KIM TAC GEUN
WEI ANDY
KAMMLER THORSTEN
HOENTSCHEL JAN
HORSTMANN MANFRED
WOOD DONALD MARK
DISHMAN RICHARD L
AMMENDOLA ALDO
AULINGER-FUCHS KATHARINA
GOTSCHLICH ASTRID
KRAMER BERND
LANG MARTIN
SAEB WAEL
SINKS UDO
WUZIK ANDREAS
TAE GI-HYUN
KIM KYUNG-TAE
HUBERAG
WINDISCH VINCENT
YUEN PUI-HO
HUANG JING JUN
XU JINGZHEN
MASAKI KOJI
MORI NORIKO
BENTHIC GEOTECH PTY LTD
FREHEL FRANCOIS
THIERRY ROGER
GAUTIER CHRISTOPHE
AURELIUM BIOPHARMA INC
FETISSOVA NATALY
BLANVALET CLAUDE
LAMBERT PIERRE
FUJIWARA RYUHEI
CANON KK
OAK DAVE S
DO TRI
SOETARMAN RONNY
MEEKS STEVEN W
VELIDANDLA VAMSI
DANELSKI DARIN L
MUELLER FRANZ-JOSEF
DISTRIB GABLEX INC
SUZAKI HIDEFUMI
TAKEHARA HIROYASU
OTA YORITO
CABOT CORP
CRESCENZO GIOVANNI D
LIPTON RICHARD J
WALFISH SHELDON
FUJITSU LTD
DE MARCKEN CARL
KOBAYASHI MASAKAZU
SHOWA DENKO KK
PATARCHI ALBERTO
MICRON TECHNOLOGY INC
GARAY MICHELLE
MARRS CHRISTOPHER
SOUTHALL MICHAEL
CISCO TECH INC
CARDIAC PACEMAKERS INC
TRILITHIC INC
KACIN MARTY
KLOBA DAVID
GRAY MICHAEL
CLAGETT BILL
LEWINSKI MATTHEW
HIMAX TECH LTD
ORACLE INT CORP
MITSUBISHI ELECTRIC CORP
INOUE NAOKI
CHADANI KENICHI
NAKANO YUKIO
LEE CHUNGHO
KINOSHITA HIROYUKI
KRIVOKAPIC ZORAN
ZHENG WEI
CHANG MARK S
SUGINO RINJI
CHANG CHI
SAMSUNG ELECTRONICS CO LTD
KEY TECHNOLOGY INC
RAMASWAMY KUMAR
KNUTSON PAUL G
COOPER JEFFREY A
HYNIX SEMICONDUCTOR INC
GOODYEAR TIRE & RUBBER
KONINKL PHILIPS ELECTRONICS NV
DIRECTV GROUP INC
SAMSUNG TECHWIN CO LTD
ZIMMER DENTAL INC
GENENTECH INC
SUMITOMO ELECTRIC INDUSTRIES
LIBMAN CO
CLANCY KEVIN
KRAYN KEN
HERTLEIN ROBERT
SKIBA TERENCE
STANLEY RANDY
LEMASTER HERB
RIBARICH THOMAS J
TOSHIBA KK
NAKANE HIROSHI
NEOTRACT INC
STAMPS COM INC
BENOTEC
HARRISON PHIL
ZALEWSKI GARY M
VANAMO KAARLE
ARRINGTON KENNETH L
FRALEY MARK E
GARBACCIO ROBERT M
HUANG SHAEI Y
LINDSLEY CRAIG W
STEEN JUSTIN T
YANG FENG
FUJIFILM CORP
BEHAVIOR TECH COMPUTER CORP
HATTIG MYRON
SAMSUNG ELECTRONICS CO LTD
IM JAE H
LEE KANG S
DEGNER BRETT WILLIAM
LIGTENBERG CHRIS
ANDRE BARTLEY K
KOUGH DOUGLAS B
SAMSUNG ELECTRONICS CO LTD
TOSHIBA KK
DONG MING
GEN SOUND COMPANY LTD
PATODIA PRATEEK
AT & T KNOWLEDGE VENTURES LP
SAMSUNG ELECTRONICS CO LTD
BROTHER IND LTD
FANUC LTD
DENSO CORP
MANN WILLIAM F III
HIRKA JEFFREY L
ISONO EIJI
TAJIRI KATSUYA
SHINTAKU NOBUYUKI
YAMADA SHUZO
MIYAKE KUNIAKI
INOUE MITSUAKI
TANAKA MASAKAZU
JACOBS JED
AIRBUS FRANCE
NAMIKI PRECISION JEWEL CO LTD
KIM IK NYUN
IBM
SHERMAN JASON T
DEKA PRODUCTS LP
BJ SERVICES CO
MUKAI MANABU
TOMIZAWA TAKESHI
TAKEDA DAISUKE
WAKUTSU TAKASHI
SERIZAWA MUTSUMU
HUTCHINS DONALD H
OKI ELECTRIC IND CO LTD
INDIAN OIL CORP LTD
ABBOTT LAB VASCULAR ENTPR LTD
ABB TURBO SYSTEMS AG
SMITH NED
WISEMAN WILLARD M
KUMAR ALOK
SCARLATA VINCENT R
SIDDIQI FARAZ
BRUTCH TASNEEM
ASAHI INTECC CO LTD
KIMOTO KK
KRI INC
DAINIPPON INK & CHEMICALS
INNOLUX DISPLAY CORP
PHILIP MORRIS USA INC
BROSE JORG
KNORLEIN MICHAEL
ALCATEL LUCENT
HENRICHS JOSEPH R
CELSUS BIOPHARMACEUTICALS INC
CRAIG PAUL M
BODENSIEK PAUL
KUBOTA MASANORI
KUBOTA AYAKO
KUBOTA MUNETAKA

Query:
-- Corrected Query 4
SELECT t."filing_date"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 1000
Answer:
Too long, hard cut:
filing_date
19971015
19990322
0
19830217
19900109
19900101
19860106
0
19480102
19800125
19820209
19820219
19700116
19700224
19700501
0
18901220
19690318
19660117
18940609
18941217
18950125
0
19620924
19650616
19660402
19660506
19660704
19660725
19661121
19600102
19580106
19290107
19400116
19870521
19840705
19920730
19781012
19861030
19910225
19860106
19930106
20150702
19830922
19860626
19730907
19780905
19820512
19880217
19900307
0
19790102
0
0
19710204
19971230
19880317
19820430
19750221
19830503
19810413
19780313
19820518
19820524
19800416
19901205
19860918
19850916
19730328
19851029
19750527
19770706
19750707
19791105
19781012
19721012
19781219
19730906
19731029
19740405
19741216
19750221
19750925
19760105
19760123
19760331
19761125
19770324
19770413
19770802
19771125
19780505
19780613
19780712
19780717
19781020
19790110
19790718
19800918
19520218
19581027
19590724
19590915
19591103
19591202
19600518
19600524
19610929
19620219
19631211
19640430
19670405
0
19701231
19710930
19720218
19720225
19720428
19720619
19741003
19701210
19710528
19710901
19710902
19710924
19711005
19720321
19720428
19720517
19720905
19721106
0
19730129
19730402
0
19730828
19730924
19731009
19731022
0
19731114
19731206
19740325
0
19740523
19740523
19750213
19750507
19750710
19750826
0
0
19760203
19760602
19760630
19760902
19761006
19761214
19770114
19770125
19770211
0
19770407
0
0
19770908
19771103
19780118
0
19780406
0
19790208
19790912
19791002
19791116
19800221
19800312
19800527
19801017
0
19801215
19810209
19810421
19810525
19810603
19810923
19820121
19820720
19821101
19821103
19821222
0
19830503
19830504
19830510
19830524
19830607
19830719
0
19831230
19840503
19840703
19840802
19840906
19840924
19841220
19850409
19850513
19850718
19850919
19851128
19860218
19861105
19870121
19870302
19880929
18991221
19020507
19021112
19030316
19030921
19020820
19040315
19050821
19620127
18951218
18950924
18970331
19690130
18971110
18971027
18980218
18980429
18990624
19000210
19600226
19640227
19011009
19600310
19620309
19610310
19040217
19040615
19040913
19710305
19620326
19720310
19060228
19060723
19071207
19700324
19090220
19710329
19670403
19100617
19100723
19680410
19600516
19620517
19120619
19710429
19720428
19140108
19660509
19720508
19670517
19140731
19690513
19650526
19690519
19680531
19191125
19200412
19210514
19690630
19780912
19800311
0
0
0
0
0
0
0
0
19770401
19770518
19750521
19810716
19770831
19770907
19870813
19841114
0
0
19470908
19490315
0
19860729
19890125
19670616
19670912
19600120
19600707
19611127
19620626
19620705
0
19631224
19631226
19640519
19640708
19641009
19370114
19500120
19340122
19240212
19370209
19530213
19430325
19200218
19520227
19620213
19530226
19510312
19630219
19660216
19570301
19440420
19440422
19510406
19600309
19690217
19520418
19911010
19850415
19840420
19881013
19961007
19970827
19980917
19870108
19760109
19810108
19950109
19770110
19860110
19830112
19830111
19960110
19880111
19711229
19980109
19980109
19870112
19830114
19930112
19850111
19940118
19830112
19840113
19950113
19950113
19790117
19820113
19990111
19770119
19860114
19750111
19850116
19720111
19910122
19780121
19740109
19840117
19780119
19820120
19860114
19870114
19940126
19970117
19770127
19760128
19780125
19920121
19720124
19890117
19980120
19940128
19980120
19950124
19930122
19870120
19870120
19810127
19940131
19980604
19830330
19941206
0
0
19150111
0
0
0
0
0
19870116
0
19930115
19350212
0
0
0
19600208
19480210
0
0
0
19870202
19760504
19910809
19840810
19680814
19790905
19800829
19751008
19791205
19711208
20030401
19991029
19961122
19830119
19961128
19970103
19950112
19880309
19880314
20000713
19920114
19991103
19880211
19750515
19941219
19941229
19970314
19991220
19751008
19830928
19970321
19920811
19920812
19970213
19970218
19990324
19920828
20001222
19970205
19950414
19840105
19830209
19990301
19920828
19950524
19950526
19770725
20000202
19970425
19921130
19890210
20000210
19840629
20000501
20000112
19890201
20000131
19970701
19921218
19780307
19841016
19950816
19680314
19711029
19970725
20000118
19930315
19990402
20000330
19890622
19951011
19780710
19930310
20000404
19930520
19780904
19930420
19990430
19990520
19850411
19951206
19990608
20000327
19890831
19790119
20000414
19930705
19790219
19720810
19891130
19971008
19960119
20000505
19790528
19790614
19990628
19900119
19900103
19711224
19790824
20000519
19851106
19841211
19960312
19960129
19900320
19730228
19791113
20000816
19971212
19940121
19990819
20000530
19900502
19990813
20000615
19800219
19730516
19960607
19980224
19800319
19730612
19800402
19990817
19990830
19900627
19730723
19800619
19960607
20000721
20000627
19860730
19860731
19900810
19800730
19800820
19900827
19990909
20000929
19980203
19991001
19900912
19901018
19980123
20000726
19740314
19960808
19740508
19960823
20000707
20000830
19870319
20000505
19960918
19961008
19980618
19910301
20001207
19961001
19910114
19940727
19960913
19910410
19870622
19980424
19910403
19980528
19980601
19870819
19870908
19870910
19750218
19860
Query:
SELECT EXTRACT(YEAR FROM TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 1000;
Answer:
Too long, hard cut:
filing_year
1997.0
1999.0
""
1983.0
1990.0
1990.0
1986.0
""
1948.0
1980.0
1982.0
1982.0
1970.0
1970.0
1970.0
""
1890.0
1969.0
1966.0
1894.0
1894.0
1895.0
""
1962.0
1965.0
1966.0
1966.0
1966.0
1966.0
1966.0
1960.0
1958.0
1929.0
1940.0
1987.0
1984.0
1992.0
1978.0
1986.0
1991.0
1986.0
1993.0
2015.0
1983.0
1986.0
1973.0
1978.0
1982.0
1988.0
1990.0
""
1979.0
""
""
1971.0
1997.0
1988.0
1982.0
1975.0
1983.0
1981.0
1978.0
1982.0
1982.0
1980.0
1990.0
1986.0
1985.0
1973.0
1985.0
1975.0
1977.0
1975.0
1979.0
1978.0
1972.0
1978.0
1973.0
1973.0
1974.0
1974.0
1975.0
1975.0
1976.0
1976.0
1976.0
1976.0
1977.0
1977.0
1977.0
1977.0
1978.0
1978.0
1978.0
1978.0
1978.0
1979.0
1979.0
1980.0
1952.0
1958.0
1959.0
1959.0
1959.0
1959.0
1960.0
1960.0
1961.0
1962.0
1963.0
1964.0
1967.0
""
1970.0
1971.0
1972.0
1972.0
1972.0
1972.0
1974.0
1970.0
1971.0
1971.0
1971.0
1971.0
1971.0
1972.0
1972.0
1972.0
1972.0
1972.0
""
1973.0
1973.0
""
1973.0
1973.0
1973.0
1973.0
""
1973.0
1973.0
1974.0
""
1974.0
1974.0
1975.0
1975.0
1975.0
1975.0
""
""
1976.0
1976.0
1976.0
1976.0
1976.0
1976.0
1977.0
1977.0
1977.0
""
1977.0
""
""
1977.0
1977.0
1978.0
""
1978.0
""
1979.0
1979.0
1979.0
1979.0
1980.0
1980.0
1980.0
1980.0
""
1980.0
1981.0
1981.0
1981.0
1981.0
1981.0
1982.0
1982.0
1982.0
1982.0
1982.0
""
1983.0
1983.0
1983.0
1983.0
1983.0
1983.0
""
1983.0
1984.0
1984.0
1984.0
1984.0
1984.0
1984.0
1985.0
1985.0
1985.0
1985.0
1985.0
1986.0
1986.0
1987.0
1987.0
1988.0
1899.0
1902.0
1902.0
1903.0
1903.0
1902.0
1904.0
1905.0
1962.0
1895.0
1895.0
1897.0
1969.0
1897.0
1897.0
1898.0
1898.0
1899.0
1900.0
1960.0
1964.0
1901.0
1960.0
1962.0
1961.0
1904.0
1904.0
1904.0
1971.0
1962.0
1972.0
1906.0
1906.0
1907.0
1970.0
1909.0
1971.0
1967.0
1910.0
1910.0
1968.0
1960.0
1962.0
1912.0
1971.0
1972.0
1914.0
1966.0
1972.0
1967.0
1914.0
1969.0
1965.0
1969.0
1968.0
1919.0
1920.0
1921.0
1969.0
1978.0
1980.0
""
""
""
""
""
""
""
""
1977.0
1977.0
1975.0
1981.0
1977.0
1977.0
1987.0
1984.0
""
""
1947.0
1949.0
""
1986.0
1989.0
1967.0
1967.0
1960.0
1960.0
1961.0
1962.0
1962.0
""
1963.0
1963.0
1964.0
1964.0
1964.0
1937.0
1950.0
1934.0
1924.0
1937.0
1953.0
1943.0
1920.0
1952.0
1962.0
1953.0
1951.0
1963.0
1966.0
1957.0
1944.0
1944.0
1951.0
1960.0
1969.0
1952.0
1991.0
1985.0
1984.0
1988.0
1996.0
1997.0
1998.0
1987.0
1976.0
1981.0
1995.0
1977.0
1986.0
1983.0
1983.0
1996.0
1988.0
1971.0
1998.0
1998.0
1987.0
1983.0
1993.0
1985.0
1994.0
1983.0
1984.0
1995.0
1995.0
1979.0
1982.0
1999.0
1977.0
1986.0
1975.0
1985.0
1972.0
1991.0
1978.0
1974.0
1984.0
1978.0
1982.0
1986.0
1987.0
1994.0
1997.0
1977.0
1976.0
1978.0
1992.0
1972.0
1989.0
1998.0
1994.0
1998.0
1995.0
1993.0
1987.0
1987.0
1981.0
1994.0
1998.0
1983.0
1994.0
""
""
1915.0
""
""
""
""
""
1987.0
""
1993.0
1935.0
""
""
""
1960.0
1948.0
""
""
""
1987.0
1976.0
1991.0
1984.0
1968.0
1979.0
1980.0
1975.0
1979.0
1971.0
2003.0
1999.0
1996.0
1983.0
1996.0
1997.0
1995.0
1988.0
1988.0
2000.0
1992.0
1999.0
1988.0
1975.0
1994.0
1994.0
1997.0
1999.0
1975.0
1983.0
1997.0
1992.0
1992.0
1997.0
1997.0
1999.0
1992.0
2000.0
1997.0
1995.0
1984.0
1983.0
1999.0
1992.0
1995.0
1995.0
1977.0
2000.0
1997.0
1992.0
1989.0
2000.0
1984.0
2000.0
2000.0
1989.0
2000.0
1997.0
1992.0
1978.0
1984.0
1995.0
1968.0
1971.0
1997.0
2000.0
1993.0
1999.0
2000.0
1989.0
1995.0
1978.0
1993.0
2000.0
1993.0
1978.0
1993.0
1999.0
1999.0
1985.0
1995.0
1999.0
2000.0
1989.0
1979.0
2000.0
1993.0
1979.0
1972.0
1989.0
1997.0
1996.0
2000.0
1979.0
1979.0
1999.0
1990.0
1990.0
1971.0
1979.0
2000.0
1985.0
1984.0
1996.0
1996.0
1990.0
1973.0
1979.0
2000.0
1997.0
1994.0
1999.0
2000.0
1990.0
1999.0
2000.0
1980.0
1973.0
1996.0
1998.0
1980.0
1973.0
1980.0
1999.0
1999.0
1990.0
1973.0
1980.0
1996.0
2000.0
2000.0
1986.0
1986.0
1990.0
1980.0
1980.0
1990.0
1999.0
2000.0
1998.0
1999.0
1990.0
1990.0
1998.0
2000.0
1974.0
1996.0
1974.0
1996.0
2000.0
2000.0
1987.0
2000.0
1996.0
1996.0
1998.0
1991.0
2000.0
1996.0
1991.0
1994.0
1996.0
1991.0
1987.0
1998.0
1991.0
1998.0
1998.0
1987.0
1987.0
1987.0
1975.0
1986.0
1975.0
1982.0
1982.0
1975.0
1982.0
1975.0
1975.0
1982.0
1991.0
1975.0
1991.0
1975.0
1982.0
2001.0
1998.0
2001.0
1977.0
1980.0
1982.0
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
""
1964.0
1964.0
""
1966.0
1966.0
1966.0
1974.0
1967.0
1967.0
1968.0
1968.0
1968.0
1969.0
1969.0
1969.0
""
""
""
""
1992.0
1994.0
2000.0
2000.0
2000.0
2000.0
2001.0
2001.0
2002.0
2003.0
2003.0
2003.0
2003.0
2003.0
2003.0
1976.0
1977.0
1977.0
1978.0
1978.0
1979.0
1979.0
1979.0
1979.0
1980.0
1982.0
1982.0
1983.0
1983.0
1984.0
1985.0
1985.0
1986.0
1986.0
1986.0
1986.0
1987.0
1988.0
1988.0
1989.0
1989.0
1989.0
1989.0
1990.0
1990.0
1990.0
1991.0
1991.0
1992.0
1992.0
1993.0
1993.0
1994.0
1994.0
1994.0
1994.0
1995.0
1996.0
1996.0
1997.0
1997.0
1998.0
1999.0
1999.0
1999.0
1999.0
1906.0
1906.0
1908.0
1907.0
1908.0
1908.0
1907.0
1909.0
1910.0
1910.0
1912.0
1912.0
1912.0
1913.0
1915.0
1916.0
1915.0
1916.0
1917.0
1916.0
1919.0
1919.0
""
""
""

Query:
-- Corrected Query 6
SELECT t."country_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A01B3%'
LIMIT 1000
Answer:
country_code
KR
RU
US
US
BE
BE
US
US
US
US
US
US
US
US
US
AU
GB
GB
US
US
US
CN
CN
DE
CA
CA
EP
EP
US
KR
DE
KR
KR
CN
CN
CN
CN
CN
DE
KR
CN
CN
NO
CA
KR
US
CN
CN
CN
GB
DE
US
US
US
US
US
US
FR
FR
US
US
US
US
KR
KR
DE
DE
DE
US
US
US
US
US
US
US
US
US
GB
US
US
BE
BE
BE
US
US
US
US
CA
KR
CA
CA
KR
KR
KR
KR
KR
KR
KR
KR
GB
IL
IL
US
US
US
US
GB
GB
GB
GB
DE
CN
US
FR
FR
US
US
US
US
US
FR
FR
FR
FR
FR
FR
CN
CN
CN
DE
US
US
US
US
US
US
PL
PL
PL
PL
BE
BE
BE
US
US
US
US
KR
CN
CN
CN
IT
IT
ZA
ZA
ZA
ZA
GB
IT
IT
CA
KR
CN
CN
CN
AT
NL
US
AU
AU
HU
KR
JP
JP
KR
AU
AU
EP
EP
KR
KR
CN
CN
CN
CN
CN
NL
NL
FR
GB
GB
GB
CN
CN
IT
IT
IT
IT
IT
IT
JP
JP
JP
CN
CN
CN
CN
CN
KR
CN
CN
NO
CN
Query:
-- Corrected Query 8
SELECT f_assignee.value::VARIANT:"name"::STRING AS "assignee_name",
       EXTRACT(YEAR FROM TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')) AS "filing_year",
       COUNT(DISTINCT t."publication_number") AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."cpc") f_cpc
CROSS JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee
WHERE f_cpc.value::VARIANT:"code"::STRING ILIKE 'A01B3%'
GROUP BY "assignee_name", "filing_year"
ORDER BY "application_count" DESC
LIMIT 1000;
Answer:
assignee_name,filing_year,application_count
AMAZONEN WERKE DREYER H,1979,2
CHOATE STOREY NORMAN,1934,1
BETEK GMBH & CO KG,2015,1
HUBEI SHUANGYU MACHINERY TECH CO LTD,2018,1
SAMSUNG KWANGJU ELECTRONICS CO,2004,1
LELY NV C VAN DER,1985,1
GLASIER HAROLD H,1931,1
CARLUCCI JAMES J,1974,1
CAMPBELL CLARENCE L,1935,1
HARRELL DANNY H,1991,1
WANG XUEDONG,2022,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,2018,1
GUERBET FRANCOIS,1973,1
DAEHO FARMING MACHINERY CO LTD,2000,1
KORSMEYER ERNEST H,1920,1
EMPR IMPORT EXPORT Y DISTRIB P,1991,1
RUDOLPH HASSON PAUL,1934,1
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,2017,1
HOLGER LETH,1926,1
AUGUST SETTERGREN OTTO GORAN,1948,1
SOUTHERN PLOW COMPANY,1912,1
WILLIAM DREFKE,1926,1
WALTER ROWAN JAMES,1947,1
LEINFELDER DIPL-LANDW HERMANN,1967,1
NIEMEYER SOEHNE STAHL PFLUG,1950,1
KIM BYUNG SUB,1996,1
Liu Yueshang,2022,1
INT HARVESTER GREAT BRITAIN,1956,1
SHEPPARD RICHARD H,1950,1
CHRISTEN ARNE JENSEN,1926,1
PATENT CONCERN NV,1978,1
WALLNER KLAUS,2016,1
SAMSUNG SDI CO LTD,2006,1
UNIV CHUNG ANG IND,2011,1
ARWAC LTD,2020,1
KUHN SA,2016,1
SAPHIR MASCHB GMBH,2017,1
WILLIAM HENRY HONY FROST,1934,1
TWOSE OF TIVERTON LTD,1981,1
DEERE & CO,2002,1
NEW ZEALAND INVENTIONS DEV,1974,1
LEMKEN GMBH & CO KG,2010,1
LG ELECTRONICS INC,2019,1
KIM JONG JIN,2001,1
EDMOND HEE,1918,1
GERBER MAURICE,2009,1
CHRISTOPHER H R WOODWARD,1918,1
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,2022,1
LIM HEON HO,2015,1
DEERE & CO,1979,1
AGSOILWORKS TECH COMPANY LLC,2019,1
BOTVID SETTERGREN ANDERS GOSTA,1948,1
RICHARD CO,1960,1
TEXAS INDUSTRIES INC,1975,1
LELY NV C VAN DER,1976,1
EDWARDS JOHN W,2004,1
GEORGE A KELLY PLOW COMPANY,1901,1
DEERE & CO,2019,1
OTULAK PRZEMYSLAW PRO CNC,2022,1
SJOEHOLMS MEKANISKA AB,1982,1
QUINSTAR CORP,1996,1
KUBOTA KK,2000,1
TRECKER FRANCIS J,1954,1
MARTIN CHARLES H,2017,1
MCKAY RALPH LTD,1980,1
ELEOS ROBOTICS INC,2019,1
UNIV TONGJI,2017,1
CHO SUNG GU,1997,1
BULLS CO LTD,2012,1
FISHER VAN E,1925,1
ZHANG LIJIN,2021,1
SIGFRID ANDERSON ANDERS,1960,1
JIM ALEX SMITH,1955,1
LELY NV C VAN DER,1975,1
MARTIN DOMINIC R,2017,1
DEERE & CO,2017,1
UNIV SYDNEY,2016,1
DAIYO TANGO CO LTD,1987,1
KIM JAE KEUN,2000,1
CHONGQING TIANJI IND CO LTD,2015,1
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,2023,1
GERBER HUBERT,2009,1
SALGE HENRY F,1913,1
PREC PLANTING LLC,2016,1
UNIV JIANGSU,2021,1
LELY NV C VAN DER,1983,1
LEIJENAAR SYTZE,1993,1
UNIV HEILONGJIANG SCI & TECH,2018,1
ALLEN SAMUEL L,1904,1
HUBER FRANZ FERDINAND,2017,1
CNH IND AMERICA LLC,2022,1
ARTHUR BROOKS SPURR,1951,1
LELY NV C VAN DER,1981,1
AMAZONEN-WERKE H DREYER GMBH & CO KG,2015,1
Query:
-- Corrected Query 8
SELECT f_assignee.value::VARIANT:"name"::STRING AS "assignee_name",
       EXTRACT(YEAR FROM TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')) AS "filing_year",
       COUNT(DISTINCT t."publication_number") AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."cpc") f_cpc
CROSS JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee
WHERE f_cpc.value::VARIANT:"code"::STRING ILIKE 'A01B3%'
GROUP BY "assignee_name", "filing_year"
ORDER BY "application_count" DESC
LIMIT 1000
Answer:
assignee_name,filing_year,application_count
AMAZONEN WERKE DREYER H,1979,2
ALLEN SAMUEL L,1904,1
HUBEI SHUANGYU MACHINERY TECH CO LTD,2018,1
LELY NV C VAN DER,1981,1
UNIV SYDNEY,2016,1
KIM BYUNG SUB,1996,1
CNH IND AMERICA LLC,2022,1
WILLIAM HENRY HONY FROST,1934,1
SAPHIR MASCHB GMBH,2017,1
DEERE & CO,2002,1
CARLUCCI JAMES J,1974,1
Liu Yueshang,2022,1
OTULAK PRZEMYSLAW PRO CNC,2022,1
EDMOND HEE,1918,1
GERBER MAURICE,2009,1
CHRISTOPHER H R WOODWARD,1918,1
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,2022,1
LIM HEON HO,2015,1
LELY NV C VAN DER,1975,1
MARTIN DOMINIC R,2017,1
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,2017,1
HOLGER LETH,1926,1
UNIV JIANGSU,2021,1
DAEHO FARMING MACHINERY CO LTD,2000,1
GUERBET FRANCOIS,1973,1
TWOSE OF TIVERTON LTD,1981,1
KUHN SA,2016,1
TRECKER FRANCIS J,1954,1
MCKAY RALPH LTD,1980,1
MARTIN CHARLES H,2017,1
GEORGE A KELLY PLOW COMPANY,1901,1
WANG XUEDONG,2022,1
ARTHUR BROOKS SPURR,1951,1
NIEMEYER SOEHNE STAHL PFLUG,1950,1
LEINFELDER DIPL-LANDW HERMANN,1967,1
KORSMEYER ERNEST H,1920,1
HUBER FRANZ FERDINAND,2017,1
SHEPPARD RICHARD H,1950,1
EDWARDS JOHN W,2004,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,2018,1
INT HARVESTER GREAT BRITAIN,1956,1
CAMPBELL CLARENCE L,1935,1
HARRELL DANNY H,1991,1
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,2023,1
ELEOS ROBOTICS INC,2019,1
UNIV TONGJI,2017,1
CHO SUNG GU,1997,1
PREC PLANTING LLC,2016,1
AUGUST SETTERGREN OTTO GORAN,1948,1
LEIJENAAR SYTZE,1993,1
LELY NV C VAN DER,1983,1
NEW ZEALAND INVENTIONS DEV,1974,1
LEMKEN GMBH & CO KG,2010,1
UNIV HEILONGJIANG SCI & TECH,2018,1
GERBER HUBERT,2009,1
SALGE HENRY F,1913,1
RICHARD CO,1960,1
DEERE & CO,1979,1
AGSOILWORKS TECH COMPANY LLC,2019,1
TEXAS INDUSTRIES INC,1975,1
JIM ALEX SMITH,1955,1
EMPR IMPORT EXPORT Y DISTRIB P,1991,1
LELY NV C VAN DER,1985,1
GLASIER HAROLD H,1931,1
SAMSUNG KWANGJU ELECTRONICS CO,2004,1
DAIYO TANGO CO LTD,1987,1
WILLIAM DREFKE,1926,1
WALTER ROWAN JAMES,1947,1
CHOATE STOREY NORMAN,1934,1
FISHER VAN E,1925,1
ZHANG LIJIN,2021,1
BULLS CO LTD,2012,1
SIGFRID ANDERSON ANDERS,1960,1
CHRISTEN ARNE JENSEN,1926,1
LELY NV C VAN DER,1976,1
DEERE & CO,2019,1
SAMSUNG SDI CO LTD,2006,1
LG ELECTRONICS INC,2019,1
KIM JONG JIN,2001,1
UNIV CHUNG ANG IND,2011,1
ARWAC LTD,2020,1
WALLNER KLAUS,2016,1
PATENT CONCERN NV,1978,1
KUBOTA KK,2000,1
SJOEHOLMS MEKANISKA AB,1982,1
QUINSTAR CORP,1996,1
CHONGQING TIANJI IND CO LTD,2015,1
KIM JAE KEUN,2000,1
BOTVID SETTERGREN ANDERS GOSTA,1948,1
SOUTHERN PLOW COMPANY,1912,1
RUDOLPH HASSON PAUL,1934,1
DEERE & CO,2017,1
AMAZONEN-WERKE H DREYER GMBH & CO KG,2015,1
BETEK GMBH & CO KG,2015,1
Query:
-- Corrected Query 9
SELECT t."country_code",
       COUNT(DISTINCT t."publication_number") AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A01B3%'
  AND EXTRACT(YEAR FROM TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')) = 2020
GROUP BY t."country_code"
ORDER BY "application_count" DESC
LIMIT 1000
Answer:
country_code,application_count
KR,1
GB,1
Query:
-- Corrected Query 10
SELECT t."publication_number", t."filing_date", t."country_code"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A01B3%'
LIMIT 1000
Answer:
Too long, hard cut:
publication_number,filing_date,country_code
US-231385-A,0,US
US-1093294-A,19130605,US
KR-20070101567-A,20060411,KR
KR-20070101567-A,20060411,KR
DE-1963184-U,19670306,DE
DE-1963184-U,19670306,DE
DE-1963184-U,19670306,DE
DE-102010019819-B4,20100508,DE
US-220177-A,0,US
US-3054462-A,19600912,US
US-3054462-A,19600912,US
FR-508965-A,19180709,FR
FR-508965-A,19180709,FR
US-2888084-A,19540216,US
US-1545136-A,19250227,US
US-1545136-A,19250227,US
CN-116671357-A,20230721,CN
CN-116671357-A,20230721,CN
CN-116671357-A,20230721,CN
GB-2039201-B,19791119,GB
US-10375891-B2,20170627,US
US-10375891-B2,20170627,US
US-10375891-B2,20170627,US
US-694931-A,19010629,US
CN-109392332-A,20181219,CN
CN-109392332-A,20181219,CN
DE-463858-C,19261012,DE
CA-2945250-A1,20161012,CA
CA-2945250-A1,20161012,CA
EP-3586579-A1,20190625,EP
EP-3586579-A1,20190625,EP
US-2019324472-A1,20190628,US
US-2843032-A,19550520,US
US-2843032-A,19550520,US
US-1860534-A,19310309,US
US-1860534-A,19310309,US
US-501724-A,0,US
US-2784656-A,19501212,US
US-2784656-A,19501212,US
US-2039702-A,19351227,US
US-2039702-A,19351227,US
AU-7115874-A,19740712,AU
GB-436304-A,19340411,GB
GB-436304-A,19340411,GB
US-5669452-A,19960806,US
US-5669452-A,19960806,US
BE-826346-A,19750306,BE
BE-826346-A,19750306,BE
US-159642-A,0,US
US-395573-A,0,US
KR-200386017-Y1,20050318,KR
RU-191537-U1,20190611,RU
KR-20130063834-A,20111207,KR
DE-140654-C,0,DE
DE-102017102683-A1,20170210,DE
KR-101378314-B1,20120821,KR
KR-200194260-Y1,20000406,KR
JP-S6342702-Y2,19820216,JP
JP-6910281-B2,20171214,JP
JP-6910281-B2,20171214,JP
KR-100191418-B1,19960724,KR
KR-100191418-B1,19960724,KR
CN-114916261-A,20220602,CN
CN-114916261-A,20220602,CN
NO-910950-L,19910311,NO
CA-3089518-A1,20190124,CA
CN-108575125-A,20180711,CN
CN-108575125-A,20180711,CN
CN-113796181-A,20210917,CN
CN-113796181-A,20210917,CN
CN-106973572-B,20170122,CN
NL-183071-C,19751202,NL
NL-183071-C,19751202,NL
FR-2943502-A1,20090331,FR
GB-2598141-A,20200820,GB
GB-2598141-A,20200820,GB
GB-2598141-A,20200820,GB
CN-107646212-A,20170731,CN
CN-107646212-A,20170731,CN
IT-1166526-B,19830525,IT
IT-1166526-B,19830525,IT
IT-1166526-B,19830525,IT
IT-1166526-B,19830525,IT
IT-1166526-B,19830525,IT
IT-1166526-B,19830525,IT
KR-20020067218-A,20010216,KR
CN-115362764-A,20220531,CN
CN-115362764-A,20220531,CN
NO-153631-B,19820721,NO
CN-104040083-B,20121115,CN
KR-20010029583-A,20000307,KR
CN-105325075-A,20151127,CN
CN-105325075-A,20151127,CN
CN-109005687-A,20180717,CN
CN-109005687-A,20180717,CN
CN-109005687-A,20180717,CN
CN-107072143-A,20151020,CN
CN-107072143-A,20151020,CN
CN-107072143-A,20151020,CN
CN-107094377-A,20170509,CN
CN-107094377-A,20170509,CN
KR-200487998-Y1,20180627,KR
US-130700-A,0,US
FR-960102-A,0,FR
FR-960102-A,0,FR
US-5267618-A,19911010,US
US-5267618-A,19911010,US
KR-102593393-B1,20180918,KR
KR-102593393-B1,20180918,KR
KR-102484290-B1,20201120,KR
KR-102484290-B1,20201120,KR
KR-102484290-B1,20201120,KR
KR-102484290-B1,20201120,KR
KR-900006618-B1,19871026,KR
US-290366-A,0,US
US-3963079-A,19741111,US
US-3963079-A,19741111,US
US-3963079-A,19741111,US
US-3963079-A,19741111,US
US-2031188-A,19340228,US
US-2031188-A,19340228,US
KR-101169320-B1,20120118,KR
KR-101593221-B1,20150530,KR
GB-696973-A,19510312,GB
IL-268624-A,20190811,IL
IL-268624-A,20190811,IL
US-2597821-A,19470203,US
US-2597821-A,19470203,US
US-2597821-A,19470203,US
US-2597821-A,19470203,US
US-2024164239-A1,20221118,US
US-2024164239-A1,20221118,US
US-2024164239-A1,20221118,US
FR-2287837-B1,19751013,FR
FR-2287837-B1,19751013,FR
FR-2287837-B1,19751013,FR
FR-2287837-B1,19751013,FR
FR-2287837-B1,19751013,FR
FR-2287837-B1,19751013,FR
BE-872468-A,19781201,BE
BE-872468-A,19781201,BE
BE-872468-A,19781201,BE
US-5845717-A,19961226,US
US-5845717-A,19961226,US
GB-2090713-B,19810112,GB
GB-2090713-B,19810112,GB
GB-2090713-B,19810112,GB
GB-2090713-B,19810112,GB
DE-829523-C,19500507,DE
CN-100366901-C,20040610,CN
US-1081539-A,19120124,US
US-376176-A,0,US
GB-792883-A,19560228,GB
US-5407014-A,19930323,US
US-5407014-A,19930323,US
CA-2543900-A1,20041029,CA
CA-2543900-A1,20041029,CA
US-2545590-A,19480220,US
US-2545590-A,19480220,US
CA-997451-A,19730209,CA
CN-108289407-A,20160916,CN
CN-108289407-A,20160916,CN
CN-108289407-A,20160916,CN
US-1412308-A,19200608,US
US-1412308-A,19200608,US
DE-8707829-U1,19870602,DE
KR-20020000597-A,20000626,KR
CN-114651538-A,20220225,CN
CN-114651538-A,20220225,CN
CN-114651538-A,20220225,CN
IT-8519066-A1,19850110,IT
IT-8519066-A1,19850110,IT
US-828171-A,19040310,US
US-3129772-A,19601116,US
US-3129772-A,19601116,US
US-530054-A,0,US
US-1471180-A,19180917,US
US-1471180-A,19180917,US
BE-727862-A,19690203,BE
US-1636048-A,19260329,US
US-1636048-A,19260329,US
PL-440426-A1,20220221,PL
PL-440426-A1,20220221,PL
PL-440426-A1,20220221,PL
PL-440426-A1,20220221,PL
BE-1007083-A5,19930526,BE
BE-1007083-A5,19930526,BE
CN-113761309-A,20210816,CN
CN-113761309-A,20210816,CN
CN-113761309-A,20210816,CN
KR-200149462-Y1,19970715,KR
HU-E050035-T2,20161104,HU
KR-200473688-Y1,20130225,KR
JP-6998053-B2,20180921,JP
JP-6998053-B2,201
Query:
-- Corrected Query 11
SELECT t."filing_date",
       TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') AS "filing_date_formatted"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 1000
Answer:
Too long, hard cut:
filing_date,filing_date_formatted
19971015,1997-10-15
19990322,1999-03-22
0,
19830217,1983-02-17
19900109,1990-01-09
19900101,1990-01-01
19860106,1986-01-06
0,
19480102,1948-01-02
19800125,1980-01-25
19820209,1982-02-09
19820219,1982-02-19
19700116,1970-01-16
19700224,1970-02-24
19700501,1970-05-01
0,
18901220,1890-12-20
19690318,1969-03-18
19660117,1966-01-17
18940609,1894-06-09
18941217,1894-12-17
18950125,1895-01-25
0,
19620924,1962-09-24
19650616,1965-06-16
19660402,1966-04-02
19660506,1966-05-06
19660704,1966-07-04
19660725,1966-07-25
19661121,1966-11-21
19600102,1960-01-02
19580106,1958-01-06
19290107,1929-01-07
19400116,1940-01-16
19870521,1987-05-21
19840705,1984-07-05
19920730,1992-07-30
19781012,1978-10-12
19861030,1986-10-30
19910225,1991-02-25
19860106,1986-01-06
19930106,1993-01-06
20150702,2015-07-02
19830922,1983-09-22
19860626,1986-06-26
19730907,1973-09-07
19780905,1978-09-05
19820512,1982-05-12
19880217,1988-02-17
19900307,1990-03-07
0,
19790102,1979-01-02
0,
0,
19710204,1971-02-04
19971230,1997-12-30
19880317,1988-03-17
19820430,1982-04-30
19750221,1975-02-21
19830503,1983-05-03
19810413,1981-04-13
19780313,1978-03-13
19820518,1982-05-18
19820524,1982-05-24
19800416,1980-04-16
19901205,1990-12-05
19860918,1986-09-18
19850916,1985-09-16
19730328,1973-03-28
19851029,1985-10-29
19750527,1975-05-27
19770706,1977-07-06
19750707,1975-07-07
19791105,1979-11-05
19781012,1978-10-12
19721012,1972-10-12
19781219,1978-12-19
19730906,1973-09-06
19731029,1973-10-29
19740405,1974-04-05
19741216,1974-12-16
19750221,1975-02-21
19750925,1975-09-25
19760105,1976-01-05
19760123,1976-01-23
19760331,1976-03-31
19761125,1976-11-25
19770324,1977-03-24
19770413,1977-04-13
19770802,1977-08-02
19771125,1977-11-25
19780505,1978-05-05
19780613,1978-06-13
19780712,1978-07-12
19780717,1978-07-17
19781020,1978-10-20
19790110,1979-01-10
19790718,1979-07-18
19800918,1980-09-18
19520218,1952-02-18
19581027,1958-10-27
19590724,1959-07-24
19590915,1959-09-15
19591103,1959-11-03
19591202,1959-12-02
19600518,1960-05-18
19600524,1960-05-24
19610929,1961-09-29
19620219,1962-02-19
19631211,1963-12-11
19640430,1964-04-30
19670405,1967-04-05
0,
19701231,1970-12-31
19710930,1971-09-30
19720218,1972-02-18
19720225,1972-02-25
19720428,1972-04-28
19720619,1972-06-19
19741003,1974-10-03
19701210,1970-12-10
19710528,1971-05-28
19710901,1971-09-01
19710902,1971-09-02
19710924,1971-09-24
19711005,1971-10-05
19720321,1972-03-21
19720428,1972-04-28
19720517,1972-05-17
19720905,1972-09-05
19721106,1972-11-06
0,
19730129,1973-01-29
19730402,1973-04-02
0,
19730828,1973-08-28
19730924,1973-09-24
19731009,1973-10-09
19731022,1973-10-22
0,
19731114,1973-11-14
19731206,1973-12-06
19740325,1974-03-25
0,
19740523,1974-05-23
19740523,1974-05-23
19750213,1975-02-13
19750507,1975-05-07
19750710,1975-07-10
19750826,1975-08-26
0,
0,
19760203,1976-02-03
19760602,1976-06-02
19760630,1976-06-30
19760902,1976-09-02
19761006,1976-10-06
19761214,1976-12-14
19770114,1977-01-14
19770125,1977-01-25
19770211,1977-02-11
0,
19770407,1977-04-07
0,
0,
19770908,1977-09-08
19771103,1977-11-03
19780118,1978-01-18
0,
19780406,1978-04-06
0,
19790208,1979-02-08
19790912,1979-09-12
19791002,1979-10-02
19791116,1979-11-16
19800221,1980-02-21
19800312,1980-03-12
19800527,1980-05-27
19801017,1980-10-17
0,
19801215,1980-12-15
19810209,1981-02-09
19810421,1981-04-21
19810525,1981-05-25
19810603,1981-06-03
19810923,1981-09-23
19820121,1982-01-21
19820720,1982-07-20
19821101,1982-11-01
19821103,1982-11-03
19821222,1982-12-22
0,
19830503,1983-05-03
19830504,1983-05-04
19830510,1983-05-10
19830524,1983-05-24
19830607,1983-06-07
19830719,1983-07-19
0,
19831230,1983-12-30
19840503,1984-05-03
19840703,1984-07-03
19840802,1984-08-02
19840906,1984-09-06
19840924,1984-09-24
19841220,1984-12-20
19850409,1985-04-09
19850513,1985-05-13
19850718,1985-07-18
19850919,1985-09-19
19851128,1985-11-28
19860218,1986-02-18
19861105,1986-11-05
19870121,1987-01-21
19870302,1987-03-02
19880929,1988-09-29
18991221,1899-12-21
19020507,1902-05-07
19021112,1902-11-12
19030316,1903-03-16
19030921,1903-09-21
19020820,1902-08-20
19040315,1904-03-15
19050821,1905-08-21
19620127,1962-01-27
18951218,1895-12-18
18950924,1895-09-24
18970331,1897-03-31
19690130,1969-01-30
18971110,1897-11-10
18971027,1897-10-27
18980218,1898-02-18
18980429,1898-04-29
18990624,1899-06-24
19000210,1900-02-10
19600226,1960-02-26
19640227,1964-02-27
19011009,1901-10-09
19600310,1960-03-10
19620309,1962-03-09
19610310,1961-03-10
19040217,1904-02-17
19040615,1904-06-15
19040913,1904-09-13
19710305,1971-03-05
19620326,1962-03-26
19720310,1972-03-10
19060228,1906-02-28
19060723,1906-07-23
19071207,1907-12-07
19700324,1970-03-24
19090220,1909-02-20
19710329,1971-03-29
19670403,1967-04-03
19100617,1910-06-17
19100723,1910-07-23
19680410,1968-04-10
19600516,1960-05-16
19620517,1962-05-17
19120619,1912-06-19
19710429,1971-04-29
19720428,1972-04-28
19140108,1914-01-08
19660509,1966-05-09
19720508,1972-05-08
19670517,1967-05-17
19140731,1914-07-31

Query:
-- Corrected Query 12
SELECT DISTINCT f.value::VARIANT:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f
LIMIT 1000
Answer:
Too long, hard cut:
assignee_name
SIMPES FAIP S P A
NUOVA FEDER SPA
EMAK SPA
BRUNNER JURAJ ING
KRAUS PETER
HERNANDO ARTIME FELIPE RUPERTO
KIMBERLY CLARK CO
UNIV MAGDEBURG TECH
ROCKWOOL INT
DANFOSS AS
JANSSEN PHARMACEUTICALS INC
ETUDE REALISA CYBERNETIQUE IND
PEUGEOT
KRAFT FOODS R & D INC
MEGABASS INC
METALLURGICAL PROCESSES LTD
DEGTYAREV VALENTIN N
COREL CORP
MILLIGAN STEPHEN D
MARANDI ALI
PIONEER TOHOKU CORP
BAUER DAVID L
SANCHEZ MAURICIO
SEPRO CORP
ECHIGO MASATOSHI
COOPER ALEX
HUNG JONATHAN
MONOGEN INC
ZHOU YUE
CORSON PHILLIP L
DUDLEY KRISTYE DORILAM ADDISON
NIKE INC
BENDIX COMMERCIAL VEHICLE SYS
NOVA CHEMICALS (INTERNATIONAL) S A
MICROELECTRONICS TECH INC
HURWITZ JONATHAN EPHRAIM DAVID
TECHNION RES & DEV FOUNDATION
CHICAGO BY PRODUCTS CORP
GLASS MURRAY L
EXXON RESEARCH ENGINEERING CO
STIFT ROBERT J
ALEXANDER RAMADEN GEORGE
LOCK LEE CHOY
NIPPON KOGAKU KK
TAIWAN SEMICONDUCTOR MFG
LEE TU
CHARLES O SANDER
TROUP JOHN H
KOTZIN
WILLIAM SCHEPLER
JOHNSON RES CORP
WYSS FRANZ
CLARK ELMER A
SLAVEN JOHN J
OF CHEMICAL INDUSTRY SOC
AMERICAN TOBACCO CO
AMETEK INC
AJINOMOTO KK
BOWLER FRANK WM
FRIEDRICH SCHUMANN
ALFA FARMACEUTICI SPA
MASTER VIBRATOR CO
HALL WILLIAM L
NIIGATA PREFECTURE
GRINKEVICH ALEKSANDR VASIL EVICH
SERVIER LAB
LYUBEZNOV VALERIJ KONSTANTINOVICH
DVOEGLAZOV ALEKSEJ IVANOVICH
SCHAEFER ELEKTROTECHNIK U SONDERMASCHINEN GMBH
ATATUERK UENIVERSITESI BILIMSEL ARASTIRMA PROJELERI BIRIMI
ASEA AB
SHINDENGEN ELECTRIC MFG CO
ZIMMERMANN GISELA
VIVATECH COMPANY
BESTHEALTH4U LDA
BUENO CARLOS JAYME
EGOROVA ELENA GERTRUDOVNA
BAUN D
OLIP ITALIA SPA
UNIV OF KENTUCKY
TUMIDEI GABRIELE
ESPINO RIZALINO M
TODO PRODUKTIONS & FOERSAELJNI
TECHEM ENERGY SERVICES GMBH
FARMER L
BERETTA A ING SPA
ELIESON CHAIMSONOVITZ PROSPER
MARSHALL & ILSLEY BANK
JAMES B BLACKBURN
BERACA SABARA QUIMICOS E INGRE
SWEETSER BERT M
LELAND ELECTRIC CO
BOGIE N
KELVINATOR CORP
REDINGTON COUNTERS INC
STOCK EQUIPMENT CO
BISSETT & SONS LTD J
TAITO CORP
GROSS ISAK
TELEX CORP THE
TURNER BROTHERS ASBEST
HITACHI SOFTWARE ENG
BECKER JENS-ULRIK
BELLIS MARK J E
SNIFFIN KEVIN
EBISAWA FUMIHIRO
METAL IND RES & DEV CT
KIM SUNG-HO
CYR DOUGLAS ROBERT
BORSIG GMBH
NEC LAB AMERICA INC
KIOXIA CORP
SUBARU CORP
MIN OBORONY ROSSIJSKOJ FEDERAT
FURMAN EVGENIJJ L
HOTSET HEIZPATRONEN ZUBEHOER
CREAVIS TECH & INNOVATION GMBH
SIGMEX LTD
MATRA DEFENSE
JEOL USA INC
SHAIKH IMTIYAZ
RAAB THOMAS WOLFGANG
NICHIA CORP
KHAN NASEEM A
BEAR BRIAN RICHARD
ROCHE DIAGNOSTICS OPERATIONS INC
POWER FINGERPRINTING INC
COVIDIEN AG
KLAESSIG OSKAR PAUL
FIRM OF OTTO URBAN
GREAT WESTERN ELECTRO CHEMICAL CO
FAVRE & CIE
TRAYWAY MFG CO
KING SEELEY CORP
RUDGE WHITWORTH LIMITED
BANGE CHARLES DE
MADDEN CHARLES H
POETSCHKE PAUL
JEPSON SYSTEMS COMPANY LTD
HENRY DREYFUS
WIRTGEN GMBH
MCKAY ROBERT
UNIV MASSACHUSETTS
PHAM NGHI
S & S CYCLE INC
HITACHI LG DATA STORAGE INC
DEGUCHI HIROSHI
HANDGEN ERIN A
LASSUS ANDERS
FUJIO SHOHHEI
FOSTER WHEELER ENERGIA OY
NOBLE FIBER TECHNOLOGIES LLC
CHEN FENG-TIEN
BLASTWORKS INC
GTX INC
TOWERJAZZ PANASONIC SEMICONDUCTOR CO LTD
SIN SIST DE IMPLANTE NACIONAL LTDA
GOLDEN LADY SPA
ALMASSY STANISLAV
SWAMINATHAN GANESH
HORSCH LEEB APPLICATION SYSTEMS GMBH
RES & IND COOPERATION GROUP
KANG JI YEON
JUNG GI YUL
HAESHIN
KANTO ISHI PHARMA CO LTD
KONO NAOYUKI
SWEEN TY
DEVROE ERIC
LARYNGEAL MASK CO LTD
MOLYNEUX STEPHEN
JOHNSON & JOHNSON SURGICAL VISION INC
BERTHIEZ C N M P
BASF PLANT SCIENCE CO GMBH
CQLT SAARGUMMI TECH SARL
HEFEI MIDEA REFRIGERATOR CO
FERROLI SPA
STEFFENS RALF
ZHANG JINGLIN
XIAMEN CHANGELIGHT CO LTD
MURATA TOSHIKI
SUMITOMO METAL MINING CO
SOLINAS MEDICAL INC
HEWLETT PACKARD DEVELOPMENT CO LP
RADIABEAM TECH LLC
Evol Science LLC
MARTINEZ CANALES MONICA LUCIA
ROLLERBLADE INC
WAVE OPTICS LTD
JIANGSU SHEMAR ELECTRIC CO LTD
KANG MIN SOO
LUEDTKE OLIVER
BUONO JUAN C MR
FARGO KENDALL M
KELLER IGOR
MONOPANEL SA
TOLEDO ERAN
GALLER KURT
GOTFRIED YECHIEL
VIVANT MEDICAL INC
CANON STAAR CO INC
KROPPE WILLIAM J
SURFACE SPECIALTIES AUSTRIA
YAO ROSE
HAMMONDS CARL L
ADDISON CLEAR WAVE LLC
DOBRESKI DAVID V
TARAMINO GRAZIANA
YUN CHANG-HUN
KIM SAN HONG
SCINTOMICS GMBH
ZIMMER INC
ST MICROELECTRONICS ROUSSET
BEXSON BIOMEDICAL INC
HEFEI CAS LANRUI TECH CO LTD
BUESCH BERND
IVANOVA TATYANA P
HOBOT TECH INC
VASSEUR JEAN-PHILIPPE
OILUND LESTER D
CHRISTL WERNER
FINE HOWARD A
TUTTLE G TYSON
KOESTER DAVID A
OPOLSKI STEVEN W
JIANG MING
ADVANCED BIONICS LLC
KOFLER KEVIN J
HOOVER LTD
RONG GUOHUA
SHENZHEN ROYOLE TECHNOLOGIES CO LTD
MASSI OSVALDO MAXIMILIANO
SHANDONG SHUNFENG BIOTECHNOLOGY CO LTD
UNIV ALBERT LUDWIGS FREIBURG
TORBJORN AFDAL
CHARMGLOW PRODUCTS INC
GE HEALTHCARE AS
LOFFLER STEPHEN
PALMER ROBERT F
HENLEY S TYRE & RUBBER COMPANY
RONALD W SCHULTZ
GIBERT CARLOS M
STANTON JOHN H
SONAB DEV AB
LICHTENSTEIN JULIUS
MORRIS KATCHER
BROWN DENNIS N
ULTIMOS DESARROLLOS
LAVROVSKY VLADIMIR V
WILLIAM D ALTON
GUILD LEIGH S
THOMAS HYDRAULIC SPEED COUTROL
THEODORE DAVID T
HAAKER WILLIAM
BOLOIT IRON WORKS
CARSON WILLIAM
BARTH W
REED TOOL CO
HORTON JAMES ALEXANDER
GARVIE HERBERT THOMPSON
BEMIS BROS BAG COMPANY
MCKAY JOHN A
VMW RANSHOFEN BERNDORF AG
KE
Query:
-- Corrected Query 13
SELECT t."country_code",
       COUNT(DISTINCT t."publication_number") AS "total_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t
GROUP BY t."country_code"
ORDER BY "total_applications" DESC
LIMIT 1000
Answer:
country_code,total_applications
CN,208729
JP,110525
US,57953
KR,28416
CA,13358
DE,12656
AU,9744
WO,9409
EP,8335
GB,5551
AT,4482
BR,4469
TW,4270
IT,3866
CH,3513
FR,3326
RU,2979
SU,2526
BE,2457
ES,2080
SE,1473
NL,1274
ZA,1261
PL,1187
IL,1185
HU,969
NO,890
MX,863
DD,722
AR,666
DK,575
CS,528
UA,479
FI,467
HK,440
CZ,414
PT,372
IE,372
SG,284
NZ,276
CL,267
BG,265
YU,228
IN,222
TR,222
GR,207
MY,195
RO,172
HR,167
LU,139
CO,118
SI,117
PH,116
EA,108
SK,99
CY,81
PE,77
AP,65
MA,54
LT,50
ID,43
CR,41
RS,38
MD,30
OA,29
IS,28
JO,26
CU,23
GE,23
LV,23
SA,20
EG,18
GT,15
TN,15
EC,14
SM,11
ZM,10
EE,7
NI,7
DO,6
HN,5
PA,5
KE,5
ME,5
MC,4
MW,4
SV,3
ZW,2
MT,1
BA,1
KZ,1
MN,1
DZ,1
End Exploring Related Columns
Task: For patent class A01B3, I want to analyze the information of the top 3 assignees based on the total number of applications. Please provide the following five pieces of information: the name of this assignee,  total number of applications, the year with the most applications, the number of applications in that year, and the country code with the most applications during that year.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: I'm sorry, but I don't have access to the database to provide the specific information requested. Without the actual data, I cannot generate the names of the top 3 assignees for patent class A01B3 and their associated application statistics..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-20 01:10:19 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 01:10:19 - root - INFO - ```sql
WITH cpc_patents AS (
    SELECT t."publication_number",
           t."country_code",
           t."filing_date",
           f_cpc.value::VARIANT:"code"::STRING AS "cpc_code",
           f_assignee.value::VARIANT:"name"::STRING AS "assignee_name",
           EXTRACT(YEAR FROM TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')) AS "filing_year"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    CROSS JOIN LATERAL FLATTEN(input => t."cpc") f_cpc
    CROSS JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee
    WHERE f_cpc.value::VARIANT:"code"::STRING LIKE 'A01B3%'
      AND f_assignee.value::VARIANT:"name" IS NOT NULL
),
assignee_totals AS (
    SELECT "assignee_name",
           COUNT(DISTINCT "publication_number") AS "total_applications"
    FROM cpc_patents
    GROUP BY "assignee_name"
),
assignee_yearly_counts AS (
    SELECT "assignee_name", "filing_year", COUNT(DISTINCT "publication_number") AS "yearly_count"
    FROM cpc_patents
    GROUP BY "assignee_name", "filing_year"
),
assignee_max_year AS (
    SELECT ayc."assignee_name", ayc."filing_year", ayc."yearly_count"
    FROM assignee_yearly_counts ayc
    INNER JOIN (
        SELECT "assignee_name", MAX("yearly_count") AS "max_yearly_applications"
        FROM assignee_yearly_counts
        GROUP BY "assignee_name"
    ) ay_max ON ayc."assignee_name" = ay_max."assignee_name" AND ayc."yearly_count" = ay_max."max_yearly_applications"
),
assignee_country_counts AS (
    SELECT "assignee_name", "filing_year", "country_code", COUNT(DISTINCT "publication_number") AS "country_count"
    FROM cpc_patents
    GROUP BY "assignee_name", "filing_year", "country_code"
),
assignee_max_country AS (
    SELECT acc."assignee_name", acc."filing_year", acc."country_code", acc."country_count"
    FROM assignee_country_counts acc
    INNER JOIN (
        SELECT "assignee_name", "filing_year", MAX("country_count") AS "max_country_count"
        FROM assignee_country_counts
        GROUP BY "assignee_name", "filing_year"
    ) acc_max ON acc."assignee_name" = acc_max."assignee_name" AND acc."filing_year" = acc_max."filing_year" AND acc."country_count" = acc_max."max_country_count"
)
SELECT a."assignee_name",
       a."total_applications",
       am."filing_year" AS "year_with_most_applications",
       am."yearly_count" AS "applications_in_that_year",
       amc."country_code" AS "country_with_most_applications_in_that_year"
FROM assignee_totals a
JOIN assignee_max_year am ON a."assignee_name" = am."assignee_name"
JOIN assignee_max_country amc ON am."assignee_name" = amc."assignee_name" AND am."filing_year" = amc."filing_year"
ORDER BY a."total_applications" DESC NULLS LAST
LIMIT 3;
```
2025-01-20 01:10:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:10:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:10:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:10:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-20 01:10:21 - snowflake.connector.connection - INFO - closed
2025-01-20 01:10:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:10:21 - root - INFO - itercount: 1
2025-01-20 01:10:21 - root - INFO - 0
2025-01-20 01:10:21 - root - INFO - results: 
assignee_name,total_applications,year_with_most_applications,applications_in_that_year,country_with_most_applications_in_that_year
LELY NV C VAN DER,5,1981,1,GB
LELY NV C VAN DER,5,1985,1,IT
LELY NV C VAN DER,5,1983,1,IT


2025-01-20 01:10:21 - root - INFO - Please check the answer again by reviewing For patent class A01B3, I want to analyze the information of the top 3 assignees based on the total number of applications. Please provide the following five pieces of information: the name of this assignee,  total number of applications, the year with the most applications, the number of applications in that year, and the country code with the most applications during that year., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: I'm sorry, but I don't have access to the database to provide the specific information requested. Without the actual data, I cannot generate the names of the top 3 assignees for patent class A01B3 and their associated application statistics. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
assignee_name,total_applications,year_with_most_applications,applications_in_that_year,country_with_most_applications_in_that_year
LELY NV C VAN DER,5,1981,1,GB
LELY NV C VAN DER,5,1985,1,IT
LELY NV C VAN DER,5,1983,1,IT
Current sql:
WITH cpc_patents AS (
    SELECT t."publication_number",
           t."country_code",
           t."filing_date",
           f_cpc.value::VARIANT:"code"::STRING AS "cpc_code",
           f_assignee.value::VARIANT:"name"::STRING AS "assignee_name",
           EXTRACT(YEAR FROM TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')) AS "filing_year"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    CROSS JOIN LATERAL FLATTEN(input => t."cpc") f_cpc
    CROSS JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee
    WHERE f_cpc.value::VARIANT:"code"::STRING LIKE 'A01B3%'
      AND f_assignee.value::VARIANT:"name" IS NOT NULL
),
assignee_totals AS (
    SELECT "assignee_name",
           COUNT(DISTINCT "publication_number") AS "total_applications"
    FROM cpc_patents
    GROUP BY "assignee_name"
),
assignee_yearly_counts AS (
    SELECT "assignee_name", "filing_year", COUNT(DISTINCT "publication_number") AS "yearly_count"
    FROM cpc_patents
    GROUP BY "assignee_name", "filing_year"
),
assignee_max_year AS (
    SELECT ayc."assignee_name", ayc."filing_year", ayc."yearly_count"
    FROM assignee_yearly_counts ayc
    INNER JOIN (
        SELECT "assignee_name", MAX("yearly_count") AS "max_yearly_applications"
        FROM assignee_yearly_counts
        GROUP BY "assignee_name"
    ) ay_max ON ayc."assignee_name" = ay_max."assignee_name" AND ayc."yearly_count" = ay_max."max_yearly_applications"
),
assignee_country_counts AS (
    SELECT "assignee_name", "filing_year", "country_code", COUNT(DISTINCT "publication_number") AS "country_count"
    FROM cpc_patents
    GROUP BY "assignee_name", "filing_year", "country_code"
),
assignee_max_country AS (
    SELECT acc."assignee_name", acc."filing_year", acc."country_code", acc."country_count"
    FROM assignee_country_counts acc
    INNER JOIN (
        SELECT "assignee_name", "filing_year", MAX("country_count") AS "max_country_count"
        FROM assignee_country_counts
        GROUP BY "assignee_name", "filing_year"
    ) acc_max ON acc."assignee_name" = acc_max."assignee_name" AND acc."filing_year" = acc_max."filing_year" AND acc."country_count" = acc_max."max_country_count"
)
SELECT a."assignee_name",
       a."total_applications",
       am."filing_year" AS "year_with_most_applications",
       am."yearly_count" AS "applications_in_that_year",
       amc."country_code" AS "country_with_most_applications_in_that_year"
FROM assignee_totals a
JOIN assignee_max_year am ON a."assignee_name" = am."assignee_name"
JOIN assignee_max_country amc ON am."assignee_name" = amc."assignee_name" AND am."filing_year" = amc."filing_year"
ORDER BY a."total_applications" DESC NULLS LAST
LIMIT 3;
2025-01-20 01:11:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 01:11:25 - root - INFO - ```sql
WITH cpc_patents AS (
    SELECT t."publication_number",
           t."country_code",
           TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') AS "filing_date",
           f_cpc.value::VARIANT:"code"::STRING AS "cpc_code",
           f_assignee.value::VARIANT:"name"::STRING AS "assignee_name",
           EXTRACT(YEAR FROM TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')) AS "filing_year"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    CROSS JOIN LATERAL FLATTEN(input => t."cpc") f_cpc
    CROSS JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee
    WHERE f_cpc.value::VARIANT:"code"::STRING LIKE 'A01B3%'
      AND f_assignee.value::VARIANT:"name" IS NOT NULL
),
assignee_totals AS (
    SELECT "assignee_name",
           COUNT(DISTINCT "publication_number") AS "total_applications"
    FROM cpc_patents
    GROUP BY "assignee_name"
),
assignee_yearly_counts AS (
    SELECT "assignee_name", "filing_year", COUNT(DISTINCT "publication_number") AS "yearly_count"
    FROM cpc_patents
    GROUP BY "assignee_name", "filing_year"
),
assignee_max_year AS (
    SELECT ayc."assignee_name", ayc."filing_year", ayc."yearly_count"
    FROM (
        SELECT ayc.*, ROW_NUMBER() OVER (PARTITION BY "assignee_name" ORDER BY "yearly_count" DESC, "filing_year" ASC) AS rn
        FROM assignee_yearly_counts ayc
    ) ayc
    WHERE ayc.rn = 1
),
assignee_country_counts AS (
    SELECT "assignee_name", "filing_year", "country_code", COUNT(DISTINCT "publication_number") AS "country_count"
    FROM cpc_patents
    GROUP BY "assignee_name", "filing_year", "country_code"
),
assignee_max_country AS (
    SELECT acc."assignee_name", acc."filing_year", acc."country_code", acc."country_count"
    FROM (
        SELECT acc.*, ROW_NUMBER() OVER (PARTITION BY "assignee_name", "filing_year" ORDER BY "country_count" DESC) AS rn
        FROM assignee_country_counts acc
    ) acc
    WHERE acc.rn = 1
)
SELECT a."assignee_name",
       a."total_applications",
       am."filing_year" AS "year_with_most_applications",
       am."yearly_count" AS "applications_in_that_year",
       amc."country_code" AS "country_with_most_applications_in_that_year"
FROM assignee_totals a
JOIN assignee_max_year am ON a."assignee_name" = am."assignee_name"
LEFT JOIN assignee_max_country amc ON am."assignee_name" = amc."assignee_name" AND am."filing_year" = amc."filing_year"
ORDER BY a."total_applications" DESC NULLS LAST
LIMIT 3;
```
2025-01-20 01:11:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:11:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:11:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:11:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-20 01:11:26 - snowflake.connector.connection - INFO - closed
2025-01-20 01:11:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:11:27 - root - INFO - itercount: 2
2025-01-20 01:11:27 - root - INFO - 0
2025-01-20 01:11:27 - root - INFO - results: 
assignee_name,total_applications,year_with_most_applications,applications_in_that_year,country_with_most_applications_in_that_year
LELY NV C VAN DER,5,1975,1,NL
DEERE & CO,4,1979,1,NL
AMAZONEN WERKE DREYER H,2,1979,2,GB


2025-01-20 01:11:27 - root - INFO - Please check the answer again by reviewing For patent class A01B3, I want to analyze the information of the top 3 assignees based on the total number of applications. Please provide the following five pieces of information: the name of this assignee,  total number of applications, the year with the most applications, the number of applications in that year, and the country code with the most applications during that year., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: I'm sorry, but I don't have access to the database to provide the specific information requested. Without the actual data, I cannot generate the names of the top 3 assignees for patent class A01B3 and their associated application statistics. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
assignee_name,total_applications,year_with_most_applications,applications_in_that_year,country_with_most_applications_in_that_year
LELY NV C VAN DER,5,1975,1,NL
DEERE & CO,4,1979,1,NL
AMAZONEN WERKE DREYER H,2,1979,2,GB
Current sql:
WITH cpc_patents AS (
    SELECT t."publication_number",
           t."country_code",
           TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') AS "filing_date",
           f_cpc.value::VARIANT:"code"::STRING AS "cpc_code",
           f_assignee.value::VARIANT:"name"::STRING AS "assignee_name",
           EXTRACT(YEAR FROM TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')) AS "filing_year"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    CROSS JOIN LATERAL FLATTEN(input => t."cpc") f_cpc
    CROSS JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee
    WHERE f_cpc.value::VARIANT:"code"::STRING LIKE 'A01B3%'
      AND f_assignee.value::VARIANT:"name" IS NOT NULL
),
assignee_totals AS (
    SELECT "assignee_name",
           COUNT(DISTINCT "publication_number") AS "total_applications"
    FROM cpc_patents
    GROUP BY "assignee_name"
),
assignee_yearly_counts AS (
    SELECT "assignee_name", "filing_year", COUNT(DISTINCT "publication_number") AS "yearly_count"
    FROM cpc_patents
    GROUP BY "assignee_name", "filing_year"
),
assignee_max_year AS (
    SELECT ayc."assignee_name", ayc."filing_year", ayc."yearly_count"
    FROM (
        SELECT ayc.*, ROW_NUMBER() OVER (PARTITION BY "assignee_name" ORDER BY "yearly_count" DESC, "filing_year" ASC) AS rn
        FROM assignee_yearly_counts ayc
    ) ayc
    WHERE ayc.rn = 1
),
assignee_country_counts AS (
    SELECT "assignee_name", "filing_year", "country_code", COUNT(DISTINCT "publication_number") AS "country_count"
    FROM cpc_patents
    GROUP BY "assignee_name", "filing_year", "country_code"
),
assignee_max_country AS (
    SELECT acc."assignee_name", acc."filing_year", acc."country_code", acc."country_count"
    FROM (
        SELECT acc.*, ROW_NUMBER() OVER (PARTITION BY "assignee_name", "filing_year" ORDER BY "country_count" DESC) AS rn
        FROM assignee_country_counts acc
    ) acc
    WHERE acc.rn = 1
)
SELECT a."assignee_name",
       a."total_applications",
       am."filing_year" AS "year_with_most_applications",
       am."yearly_count" AS "applications_in_that_year",
       amc."country_code" AS "country_with_most_applications_in_that_year"
FROM assignee_totals a
JOIN assignee_max_year am ON a."assignee_name" = am."assignee_name"
LEFT JOIN assignee_max_country amc ON am."assignee_name" = amc."assignee_name" AND am."filing_year" = amc."filing_year"
ORDER BY a."total_applications" DESC NULLS LAST
LIMIT 3;
2025-01-20 01:12:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 01:12:09 - root - INFO - ```sql
WITH cpc_patents AS (
    SELECT t."publication_number",
           t."country_code",
           TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD') AS "filing_date",
           f_cpc.value::VARIANT:"code"::STRING AS "cpc_code",
           f_assignee.value::VARIANT:"name"::STRING AS "assignee_name",
           EXTRACT(YEAR FROM TRY_TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')) AS "filing_year"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    CROSS JOIN LATERAL FLATTEN(input => t."cpc") f_cpc
    CROSS JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee
    WHERE f_cpc.value::VARIANT:"code"::STRING LIKE 'A01B3%'
      AND f_assignee.value::VARIANT:"name" IS NOT NULL
),
assignee_totals AS (
    SELECT "assignee_name",
           COUNT(DISTINCT "publication_number") AS "total_applications"
    FROM cpc_patents
    GROUP BY "assignee_name"
),
assignee_yearly_counts AS (
    SELECT "assignee_name", "filing_year", COUNT(DISTINCT "publication_number") AS "yearly_count"
    FROM cpc_patents
    GROUP BY "assignee_name", "filing_year"
),
assignee_max_year AS (
    SELECT ayc."assignee_name", ayc."filing_year", ayc."yearly_count"
    FROM (
        SELECT ayc.*, ROW_NUMBER() OVER (PARTITION BY "assignee_name" ORDER BY "yearly_count" DESC, "filing_year" ASC) AS rn
        FROM assignee_yearly_counts ayc
    ) ayc
    WHERE ayc.rn = 1
),
assignee_country_counts AS (
    SELECT "assignee_name", "filing_year", "country_code", COUNT(DISTINCT "publication_number") AS "country_count"
    FROM cpc_patents
    GROUP BY "assignee_name", "filing_year", "country_code"
),
assignee_max_country AS (
    SELECT acc."assignee_name", acc."filing_year", acc."country_code", acc."country_count"
    FROM (
        SELECT acc.*, ROW_NUMBER() OVER (PARTITION BY "assignee_name", "filing_year" ORDER BY "country_count" DESC) AS rn
        FROM assignee_country_counts acc
    ) acc
    WHERE acc.rn = 1
)
SELECT a."assignee_name",
       a."total_applications",
       am."filing_year" AS "year_with_most_applications",
       am."yearly_count" AS "applications_in_that_year",
       amc."country_code" AS "country_with_most_applications_in_that_year"
FROM assignee_totals a
JOIN assignee_max_year am ON a."assignee_name" = am."assignee_name"
LEFT JOIN assignee_max_country amc ON am."assignee_name" = amc."assignee_name" AND am."filing_year" = amc."filing_year"
ORDER BY a."total_applications" DESC NULLS LAST
LIMIT 3;
```
2025-01-20 01:12:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:12:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:12:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:12:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-20 01:12:11 - snowflake.connector.connection - INFO - closed
2025-01-20 01:12:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:12:11 - root - INFO - itercount: 3
2025-01-20 01:12:11 - root - INFO - 0
2025-01-20 01:12:11 - root - INFO - Total iteration counts: 3
