2025-01-20 01:02:33 - openai._base_client - INFO - Retrying request to /chat/completions in 0.458795 seconds
2025-01-20 01:03:34 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 01:03:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:03:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:03:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:03:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 313
2025-01-20 01:03:37 - snowflake.connector.connection - INFO - closed
2025-01-20 01:03:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:03:37 - root - INFO - SQL:
-- Query 1: View sample CPC entries to understand the structure
SELECT t."publication_number", t."cpc"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 1000;
Results:
Too long, hard cut:
publication_number,cpc
CR-5634-A,[]
CR-5990-A,[]
FI-429-A,[]
HK-6083-A,"[
  {
    ""code"": ""H02M5/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
HU-T52763-A,"[
  {
    ""code"": ""A01N47/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D521/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
JP-H03206829-A,"[
  {
    ""code"": ""Y02A40/81"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
JP-S62159089-A,"[
  {
    ""code"": ""Y02E30/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
US-416-A,"[
  {
    ""code"": ""Y10T83/465"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""B26F1/42"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
US-2528225-A,"[
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A41580-A,"[
  {
    ""code"": ""B22D11/086"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A47682-A,"[
  {
    ""code"": ""C07D471/16"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D471/22"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A63682-A,"[
  {
    ""code"": ""G01N33/48728"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-920790-A,"[
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-950907-A,"[
  {
    ""code"": ""C11B5/0064"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/35"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C11B5/0035"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M135/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C09K15/30"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D263/56"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/44"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D235/12"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/3447"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/48"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/46"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D277/64"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/47"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/224"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/102"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/106"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/104"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/10"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/221"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/226"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/225"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/22"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10L1/14"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-920830-A,"[
  {
    ""code"": ""E02D5/808"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/385"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/26"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/28"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/54"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-9086-A,[]
CH-3256-A,[]
CH-540255-A,"[
  {
    ""code"": ""C07D213/32"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/51"",
    ""first"": false,
    ""inven

2025-01-20 01:03:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:03:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:03:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:03:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 01:03:39 - snowflake.connector.connection - INFO - closed
2025-01-20 01:03:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:03:39 - root - INFO - SQL:
-- Query 2: Flatten the "cpc" column to extract individual CPC codes
SELECT t."publication_number", c.value AS "cpc_entry"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
LIMIT 1000;
Results:
Too long, hard cut:
publication_number,cpc_entry
US-2004046148-A1,"{
  ""code"": ""C23F1/26"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""H01L21/3212"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""C23F3/06"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""H01L21/32134"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""C23F3/06"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""C09G1/02"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""H01L21/32115"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""C23F3/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""C23F1/18"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""C09G1/02"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""C23F3/06"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""H01L21/32115"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""H01L21/3212"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""C23F1/18"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""C23F3/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""H01L21/32134"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004249430-A1,"{
  ""code"": ""A61N1/05"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
US-2004249430-A1,"{
  ""code"": ""A61N1/05"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
US-2004249430-A1,"{
  ""code"": ""A61N1/056"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004249430-A1,"{
  ""code"": ""A61N1/056"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004254481-A1,"{
  ""code"": ""A61B7/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004254481-A1,"{
  ""code"": ""A61B5/318"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004254481-A1,"{
  ""code"": ""A61B7/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004254481-A1,"{
  ""code"": ""A61B5/0816"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
US-2004254481-A1,"{
  ""code"": ""A61B5/0816"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
US-2004254481-A1,"{
  ""code"": ""A61B5/318"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/0421"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/3095"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/3072"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/02476"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/0217"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/18308"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/18375"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/18377"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/04253"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/04252"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/18369"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/18375"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/18369"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/18308"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/0217"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/3072"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/02476"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/18377"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/0421"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/3095"",
  ""first"": false,

2025-01-20 01:03:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:03:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:03:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:03:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 01:03:41 - snowflake.connector.connection - INFO - closed
2025-01-20 01:03:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:03:41 - root - INFO - SQL:
-- Query 3: Extract CPC codes from the flattened "cpc" column
SELECT t."publication_number", c.value:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
LIMIT 1000;
Results:
Too long, hard cut:
publication_number,cpc_code
US-2018235635-A1,A61B17/072
US-2018235635-A1,A61B2017/07257
US-2018235635-A1,A61B17/1155
US-2018235635-A1,A61B2017/1157
US-2018235635-A1,A61B2017/1157
US-2018235635-A1,A61B2017/07257
US-2018235635-A1,A61B17/072
US-2018235635-A1,A61B17/1155
US-2018235635-A1,A61B17/1155
US-2018201131-A1,B60K28/066
US-2018201131-A1,B60W2540/24
US-2018201131-A1,B60K28/063
US-2018201131-A1,B60W2540/24
US-2018201131-A1,B60K28/06
US-2018201131-A1,B60K28/063
US-2018201131-A1,B60W40/08
US-2018201131-A1,B60K28/06
US-2018201131-A1,B60W2040/0836
US-2018201131-A1,B60W2040/0836
US-2018201131-A1,B60K28/063
US-2018201131-A1,B60W40/08
US-2018201131-A1,B60K28/063
US-2017235415-A1,G06F3/044
US-2017235415-A1,G06F3/0416
US-2017235415-A1,G06F3/04166
US-2017235415-A1,G06F3/0446
US-2017235415-A1,G06F3/0418
US-2017235415-A1,G06F3/04166
US-2017235415-A1,G06F3/0418
US-2017235415-A1,G06F3/044
US-2017244772-A1,H04L2012/6483
US-2017244772-A1,H04N21/8456
US-2017244772-A1,H04L67/02
US-2017244772-A1,H04N21/8455
US-2017244772-A1,H04N21/4751
US-2017244772-A1,H04L65/4084
US-2017244772-A1,H04L61/1582
US-2017244772-A1,H04L65/607
US-2017244772-A1,H04L67/34
US-2017244772-A1,H04L65/613
US-2017244772-A1,H04L65/613
US-2017244772-A1,H04L67/02
US-2017244772-A1,H04L2012/6483
US-2017244772-A1,H04N21/8456
US-2017244772-A1,H04N21/8455
US-2017244772-A1,H04L61/457
US-2017244772-A1,H04L65/612
US-2017244772-A1,H04L65/70
US-2017244772-A1,H04L65/612
US-2017244772-A1,H04N21/4751
US-2017244772-A1,H04L65/65
US-2017244772-A1,H04L67/34
US-2017251351-A1,H04M15/44
US-2017251351-A1,H04L12/1439
US-2017251351-A1,H04M15/60
US-2017251351-A1,H04L12/1435
US-2017251351-A1,H04M15/43
US-2017251351-A1,H04W4/24
US-2017251351-A1,H04M15/43
US-2017251351-A1,H04W4/24
US-2017251351-A1,H04M15/62
US-2017251351-A1,H04M15/41
US-2017251351-A1,H04M15/44
US-2017251351-A1,H04M15/41
US-2017251351-A1,H04L12/1435
US-2017251351-A1,H04W24/08
US-2017251351-A1,H04M15/62
US-2017251351-A1,H04L12/1439
US-2017251351-A1,H04W4/24
US-2017251351-A1,H04W24/08
US-2017251351-A1,H04M15/60
US-2018332422-A1,A63F2300/538
US-2018332422-A1,A63F2300/6063
US-2018332422-A1,A63F13/86
US-2018332422-A1,H04S7/303
US-2018332422-A1,H04S2400/11
US-2018332422-A1,G11B27/005
US-2018332422-A1,G06F3/165
US-2018332422-A1,H04S2420/11
US-2018332422-A1,H04N21/233
US-2018332422-A1,G11B2020/10546
US-2018332422-A1,A63F13/525
US-2018332422-A1,A63F2300/538
US-2018332422-A1,A63F2300/6661
US-2018332422-A1,H04N21/23418
US-2018332422-A1,G11B20/10527
US-2018332422-A1,A63F2300/6607
US-2018332422-A1,A63F2300/6607
US-2018332422-A1,A63F2300/6063
US-2018332422-A1,G06T15/20
US-2018332422-A1,A63F13/525
US-2018332422-A1,A63F2300/6661
US-2018332422-A1,H04S2420/11
US-2018332422-A1,G11B20/10527
US-2018332422-A1,G11B2020/10546
US-2018332422-A1,H04N21/23418
US-2018332422-A1,G06T15/20
US-2018332422-A1,H04N21/233
US-2018332422-A1,H04S2400/11
US-2018332422-A1,G06F3/165
US-2018332422-A1,G11B27/005
US-2018332422-A1,H04S7/303
US-2018332422-A1,A63F13/86
US-2018344618-A1,A61K8/37
US-2018344618-A1,A61K8/8182
US-2018344618-A1,A61K8/062
US-2018344618-A1,A61K2800/5426
US-2018344618-A1,A61Q1/10
US-2018344618-A1,A61K2800/594
US-2018344618-A1,A61K2800/594
US-2018344618-A1,A61K8/062
US-2018344618-A1,A61K2800/524
US-2018344618-A1,A61Q1/10
US-2018344618-A1,A61K8/86
US-2018344618-A1,A61K2800/43
US-2018344618-A1,A61K2800/524
US-2018344618-A1,A61K8/416
US-2018344618-A1,A61K2800/43
US-2018344618-A1,A61K8/463
US-2018344618-A1,A61K2800/5426
US-2018344618-A1,A61K8/8182
US-2018344618-A1,A61K2800/83
US-2018344618-A1,A61K8/31
US-2018344618-A1,A61K8/463
US-2018344618-A1,A61K2800/43
US-2018344618-A1,A61K8/8182
US-2018344618-A1,A61K2800/5426
US-2018344618-A1,A61K8/732
US-2018344618-A1,A61K2800/594
US-2018344618-A1,A61K8/375
US-2018344618-A1,A61K8/463
US-2018344618-A1,A61K8/062
US-2018344618-A1,A61K8/8111
US-2018344618-A1,A61Q1/10
US-2018344618-A1,A61K8/92
US-2018344618-A1,A61K2800/524
US-2018344618-A1,A61K8/8147
US-2018344618-A1,A61K2800/83
US-2018344618-A1,A61K8/86
US-2018344618-A1,A61K8/31
US-2018344618-A1,A61K8/416
US-2018344618-A1,A61K8/37
US-2017365978-A1,H01S5/04254
US-2017365978-A1,H01S5/4087
US-2017365978-A1,B23K26/382
US-2017365978-A1,B23K26/703
US-2017365978-A1,H01S5/04254
US-2017365978-A1,B23K26/21
US-2017365978-A1,B23K26/38
US-2017365978-A1,H01S5/4087
US-2017365978-A1,H01S5/143
US-2017365978-A1,H01S5/4025
US-2017365978-A1,B23K26/382
US-2017365978-A1,H01S5/02423
US-2017365978-A1,H01S5/143
US-2017365978-A1,H01S3/08086
US-2017365978-A1,B23K26/703
US-2017365978-A1,H01S5/4025
US-2017365978-A1,G02B27/30
US-2017365978-A1,H01S5/4012
US-2017365978-A1,B23K26/38
US-2017365978-A1,H01S5/02423
US-2017365978-A1,H01S5/4012
US-2017365978-A1,H01S5/02423
US-2017365978-A1,H01S5/4025
US-2017365978-A1,H01S5/143
US-2017365978-A1,G02B27/30
US-2017365978-A1,H01S3/08086
US-2017365978-A1,H01S5/02236
US-2017365978-A1,B23K26/21
US-2017365978-A1,H01S5/023
US-2017365978-A1,H01S5/0233
US-2017365978-A1,H01S5/0235
US-2017365978-A1,H01S5/023
US-2017365978-A1,H01S5/0233
US-2017282979-A1,B62D21/14
US-

2025-01-20 01:03:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:03:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:03:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:03:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 213
2025-01-20 01:03:43 - snowflake.connector.connection - INFO - closed
2025-01-20 01:03:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:03:43 - root - INFO - SQL:
-- Query 4: Find publications with CPC code starting with 'A01B3'
SELECT t."publication_number", c.value:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value:"code"::STRING LIKE 'A01B3%'
LIMIT 1000;
Results:
Too long, hard cut:
publication_number,cpc_code
KR-200386017-Y1,A01B3/28
RU-191537-U1,A01B35/20
US-694931-A,A01B3/08
CN-109392332-A,A01B35/20
CN-109392332-A,A01B35/26
DE-463858-C,A01B35/04
CA-2945250-A1,A01B33/106
CA-2945250-A1,A01B33/106
EP-3586579-A1,A01B33/087
EP-3586579-A1,A01B37/00
US-2843032-A,A01B39/14
US-2843032-A,A01B39/14
US-1860534-A,A01B3/50
US-1860534-A,A01B3/50
US-501724-A,A01B3/464
US-2784656-A,A01B35/14
US-2784656-A,A01B35/14
US-2039702-A,A01B39/19
US-2039702-A,A01B39/19
AU-7115874-A,A01B35/26
GB-436304-A,A01B35/16
GB-436304-A,A01B33/021
US-5669452-A,A01B35/04
US-5669452-A,A01B35/04
US-159642-A,A01B35/08
US-395573-A,A01B35/26
US-2019324472-A1,A01B39/18
BE-826346-A,A01B33/106
BE-826346-A,A01B33/106
CN-108575125-A,A01B33/12
CN-108575125-A,A01B33/10
CN-113796181-A,A01B33/08
CN-113796181-A,A01B33/10
CN-106973572-B,A01B39/18
NL-183071-C,A01B33/065
NL-183071-C,A01B33/065
FR-2943502-A1,A01B39/163
CN-107072143-A,A01B35/225
CN-107072143-A,A01B35/225
CN-107072143-A,A01B35/225
CN-107094377-A,A01B33/08
CN-107094377-A,A01B33/144
KR-20020067218-A,A01B39/18
CN-115362764-A,A01B35/16
CN-115362764-A,A01B35/28
NO-153631-B,A01B35/00
CN-104040083-B,A01B33/14
JP-S6342702-Y2,A01B33/028
JP-6910281-B2,A01B33/028
JP-6910281-B2,A01B33/024
KR-100191418-B1,A01B35/28
KR-100191418-B1,A01B35/18
GB-2598141-A,A01B39/06
GB-2598141-A,A01B39/18
GB-2598141-A,A01B39/18
CN-107646212-A,A01B35/22
CN-107646212-A,A01B35/04
IT-1166526-B,A01B33/146
IT-1166526-B,A01B33/106
IT-1166526-B,A01B33/065
IT-1166526-B,A01B33/065
IT-1166526-B,A01B33/106
IT-1166526-B,A01B33/146
DE-102010019819-B4,A01B3/464
US-1093294-A,A01B3/10
KR-20070101567-A,A01B33/146
KR-20070101567-A,A01B33/06
DE-1963184-U,A01B33/08
DE-1963184-U,A01B33/10
DE-1963184-U,A01B33/00
US-231385-A,A01B33/065
US-2888084-A,A01B33/06
US-1545136-A,A01B39/26
US-1545136-A,A01B39/26
US-220177-A,A01B35/18
US-3054462-A,A01B35/12
US-3054462-A,A01B35/12
FR-508965-A,A01B3/30
FR-508965-A,A01B3/18
CN-116671357-A,A01B39/085
CN-116671357-A,A01B39/22
CN-116671357-A,A01B39/20
GB-2039201-B,A01B33/106
US-10375891-B2,A01B39/18
US-10375891-B2,A01B39/18
US-10375891-B2,A01B39/18
CN-108289407-A,A01B33/16
CN-108289407-A,A01B33/16
CN-108289407-A,A01B35/32
KR-20020000597-A,A01B35/22
CN-114651538-A,A01B39/22
CN-114651538-A,A01B39/18
CN-114651538-A,A01B39/085
IT-8519066-A1,A01B33/065
IT-8519066-A1,A01B33/106
PL-440426-A1,A01B33/00
PL-440426-A1,A01B33/021
PL-440426-A1,A01B33/02
PL-440426-A1,A01B33/04
BE-1007083-A5,A01B39/16
BE-1007083-A5,A01B39/26
BE-727862-A,A01B33/021
US-1636048-A,A01B35/24
US-1636048-A,A01B35/24
US-1412308-A,A01B3/54
US-1412308-A,A01B3/54
US-828171-A,A01B3/26
US-3129772-A,A01B39/085
US-3129772-A,A01B39/085
US-530054-A,A01B39/14
US-1471180-A,A01B3/50
US-1471180-A,A01B3/50
DE-8707829-U1,A01B33/142
KR-20010029583-A,A01B33/00
CN-105325075-A,A01B33/103
CN-105325075-A,A01B33/024
CN-109005687-A,A01B33/065
CN-109005687-A,A01B33/082
CN-109005687-A,A01B33/08
KR-20130063834-A,A01B39/18
DE-140654-C,A01B3/12
KR-200194260-Y1,A01B35/10
DE-102017102683-A1,A01B35/18
KR-101378314-B1,A01B33/082
KR-200149462-Y1,A01B35/28
AU-2016269849-A1,A01B39/18
AU-2016269849-A1,A01B39/18
CN-113761309-A,A01B39/16
CN-113761309-A,A01B39/26
CN-113761309-A,A01B39/20
HU-E050035-T2,A01B35/24
KR-200473688-Y1,A01B35/16
JP-6998053-B2,A01B39/18
JP-6998053-B2,A01B39/18
KR-100626846-B1,A01B3/50
ZA-808003-B,A01B39/22
ZA-808003-B,A01B35/225
ZA-808003-B,A01B39/22
ZA-808003-B,A01B35/225
GB-2089182-B,A01B33/065
IT-1064821-B,A01B33/065
IT-1064821-B,A01B33/065
CA-2977468-A1,A01B33/024
AT-A720679-A,A01B33/106
NL-7909063-A,A01B33/103
US-469659-A,A01B35/08
EP-3474651-C0,A01B33/06
EP-3474651-C0,A01B35/16
AU-2002301383-B2,A01B35/225
AU-2002301383-B2,A01B35/225
CN-114916261-A,A01B35/20
CN-114916261-A,A01B35/26
NO-910950-L,A01B35/26
CA-3089518-A1,A01B39/18
KR-200487998-Y1,A01B39/18
BE-872468-A,A01B33/065
BE-872468-A,A01B33/16
BE-872468-A,A01B33/12
US-5845717-A,A01B37/00
US-5845717-A,A01B37/00
KR-102593393-B1,A01B33/082
KR-102593393-B1,A01B33/082
KR-102484290-B1,A01B33/14
KR-102484290-B1,A01B35/28
KR-102484290-B1,A01B33/14
KR-102484290-B1,A01B35/28
KR-900006618-B1,A01B33/14
US-2545590-A,A01B33/025
US-2545590-A,A01B33/025
CA-997451-A,A01B3/74
GB-2090713-B,A01B35/12
GB-2090713-B,A01B39/10
GB-2090713-B,A01B35/12
GB-2090713-B,A01B39/10
DE-829523-C,A01B3/32
CN-100366901-C,A01B33/021
US-130700-A,A01B35/08
FR-960102-A,A01B33/087
FR-960102-A,A01B33/082
US-5267618-A,A01B3/46
US-5267618-A,A01B3/46
KR-101169320-B1,A01B35/10
KR-101593221-B1,A01B3/36
GB-696973-A,A01B35/06
IL-268624-A,A01B3/24
IL-268624-A,A01B3/24
US-2597821-A,A01B39/00
US-2597821-A,A01B39/00
US-2597821-A,A01B35/26
US-2597821-A,A01B35/26
CA-2543900-A1,A01B33/103
CA-2543900-A1,A01B33/103
US-1081539-A,A01B35/06
US-376176-A,A01B3/26
GB-792883-A,A01B3/36
US-5407014-A,A01B31/00
US-5407014-A,A01B31/00
US-2024164239-A1,A01B35/08
US-2024164239-A1,A01B35/08
US-2024164239-A1,A01B35/08
FR-2287837-B1,A01B33/024
FR-2287837-B1,A01B33/08
FR-2287837-B1,A01B33/021
FR-2287837-B1,A01B33/08
FR-2287837-B1,A01B33/021
FR-2287837-B1,A01B33/024
US

2025-01-20 01:03:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:03:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:03:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:03:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 01:03:45 - snowflake.connector.connection - INFO - closed
2025-01-20 01:03:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:03:45 - root - INFO - SQL:
-- Query 5: Extract assignee names from "assignee_harmonized"
SELECT t."publication_number", a.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
LIMIT 1000;
Results:
Too long, hard cut:
publication_number,assignee_name
US-2019196084-A1,DURA OPERATING LLC
US-2018141325-A1,FUJIFILM CORP
US-2018187834-A1,SICK AG
US-2018204863-A1,IMEC VZW
US-2019223595-A1,GOPAL PAUL
US-2018155335-A1,UNIV HEALTH NETWORK
US-2018233997-A1,HONDA MOTOR CO LTD
US-2018337677-A1,IBM
US-2019266471-A1,IBM
US-2019267026-A1,AT & T IP I LP
US-2018254937-A1,COMMISSARIAT ENERGIE ATOMIQUE
US-2018277952-A1,FRACTUS ANTENNAS SL
US-2018211887-A1,SAMSUNG ELECTRONICS CO LTD
US-2018277686-A1,3 5 POWER ELECTRONICS GMBH
US-2018279332-A1,SAMSUNG ELECTRONICS CO LTD
US-2019297963-A1,MONTGOMERY TYRONE
US-2018342366-A1,NUFLARE TECHNOLOGY INC
US-2018239126-A1,SONY CORP
US-2019289218-A1,TAIWAN SEMICONDUCTOR MFG CO LTD
US-2019335520-A1,NOKIA SOLUTIONS & NETWORKS OY
US-2019140216-A1,SAMSUNG DISPLAY CO LTD
US-2018357938-A1,MCGREGOR JAMES BERRY
US-2018330780-A1,ST MICROELECTRONICS ROUSSET
US-2018370418-A1,OMRON TATEISI ELECTRONICS CO
US-2018286309-A1,SEMICONDUCTOR ENERGY LAB
US-2020057100-A1,ROHDE & SCHWARZ
US-2018294519-A1,HYUNDAI MOTOR CO LTD
US-2018294519-A1,KIA MOTORS CORP
US-2018291661-A1,CALDWELL MFG CO NORTH AMERICA LLC
US-2018293364-A1,DEAVER F SCOTT
US-2019157285-A1,TAIWAN SEMICONDUCTOR MFG CO LTD
US-2019003958-A1,CANON KK
US-2018306523-A1,FURUKAWA ELECTRIC CO LTD
US-2020015412-A1,CNH IND CANADA LTD
US-2019028639-A1,CANON KK
US-2019026669-A1,FILMIO INC
US-2018327034-A1,TOYOTA MOTOR CO LTD
US-2018365575-A1,GUTTMANN MOSHE
US-2018365575-A1,MALOWANY DAN IOSEF
US-2018365575-A1,AXLER GREGORY
US-2018365575-A1,Seematics Systems Ltd
US-2019010977-A1,MITSUBISHI HEAVY IND COMPRESSOR CORP
US-2021194641-A1,ERICSSON TELEFON AB L M
US-2021211830-A1,HEWLETT PACKARD DEVELOPMENT CO
US-2019089625-A1,NEW H3C TECH CO LTD
US-2019131531-A1,NOVALED GMBH
US-2020215441-A1,Polin Su Parklari Ve Havuz Sistemleri Anonim Sirketi
US-2019377516-A1,WESTERN DIGITAL TECH INC
US-2019058291-A1,HARUMOTO TECH SHEN ZHEN CO LTD
US-2020061221-A1,IBM
US-2018367810-A1,GE VIDEO COMPRESSION LLC
US-2020065758-A1,EXEL INC D/B/A DHL SUPPLY CHAIN USA
US-2020075499-A1,SEMICONDUCTOR COMPONENTS IND LLC
US-2020070846-A1,GM GLOBAL TECH OPERATIONS LLC
US-2019021138-A1,NVENT SERVICES GMBH
US-2019289695-A1,BOE TECHNOLOGY GROUP CO LTD
US-2019289695-A1,HEFEI BOE OPTOELECTRONICS TECH
US-2019258410-A1,BRITTNER ROD
US-2019258410-A1,BENSON RONALD G
US-2019159884-A1,MEDTRONIC VASCULAR INC
US-2020105090-A1,IGT RENO NEV
US-2020111592-A1,TAIWAN OASIS TECH CO LTD
US-2020072916-A1,HI LLC
US-2020180517-A1,LEAR CORP
US-2020194059-A1,IBM
US-2019186567-A1,MERITOR HEAVY VEHICLE BRAKING SYSTEMS UK LTD
US-2020162643-A1,CJ CGV CO LTD
US-2019200474-A1,FANUC CORP
US-2019231855-A1,BAXALTA INC
US-2019231855-A1,Baxalta GmbH
US-2019140614-A1,MURATA MANUFACTURING CO
US-2020067339-A1,DELTA ELECTRONICS INC
US-2020217420-A1,UNITED TECHNOLOGIES CORP
US-2019149296-A1,HUAWEI TECH CO LTD
US-2019313538-A1,DENSO TEN LTD
US-2019177896-A1,BEYER BEKIR
US-2020269134-A1,HAN TAI-SHENG
US-2019370625-A1,TOSHIBA MEMORY CORP
US-2019278346-A1,CORRPRO CO INC
US-2019156634-A1,WYMAC GAMING SOLUTIONS PTY LTD
US-2019189294-A1,EUROPEAN SPALLATION SOURCE ERIC
US-2019189294-A1,MIFLER CONSULTING KFT
US-2019361208-A1,SEIKO EPSON CORP
US-2019146513-A1,KUBOTA KK
US-2019240122-A1,NATURA COSMETICOS SA
US-2019237797-A1,SAMSUNG SDI CO LTD
US-2021219627-A1,BRIZAY MACHA
US-2020156909-A1,SHIJIAZHUANG NURON BRAKE TECH CO LTD
US-2019172610-A1,SUMITOMO ELECTRIC INDUSTRIES
US-2020179906-A1,UNIV FUZHOU
US-2019320367-A1,ERICSSON TELEFON AB L M
US-2019365512-A1,KONINKLIJKE PHILIPS NV
US-2020040810-A1,MAZDA MOTOR
US-2020063085-A1,UNIV ARIZONA
US-2019262825-A1,KIMBERLY CLARK CO
US-2019262825-A1,UNIV ILLINOIS
US-2020295406-A1,MEDTRONIC INC
US-2020311734-A1,AMERICAN EXPRESS TRAVEL RELATED SERVICES CO INC
US-2019307948-A1,LEVY FRANK
US-2019307948-A1,LEVY KIMBERLEY
US-2020004364-A1,SAMSUNG DISPLAY CO LTD
US-2019293875-A1,TELESCENT INC
US-2019319476-A1,SHENZHEN XGEAR TECH CO LTD
US-2019236670-A1,BOEMI ANDREW A
US-2019236670-A1,SNYDER JOHN L
US-2019236670-A1,VOGELBERGER PETER C
US-2019322036-A1,IO TECH GROUP LTD
US-2020334774-A1,CAPITAL ONE SERVICES LLC
US-2019332731-A1,ALIBABA GROUP HOLDING LTD
US-2019324130-A1,KOITO MFG CO LTD
US-2020070883-A1,CITIC DICASTAL CO LTD
US-2020079767-A1,VITAE PHARMACEUTICALS LLC
US-2019328740-A1,UNIV CALIFORNIA
US-2020348923-A1,FORD GLOBAL TECH LLC
US-2020004235-A1,DISNEY ENTPR INC
US-2019360681-A1,Focused Innovation Group LLC
US-2019364081-A1,DISNEY ENTPR INC
US-2019278249-A1,INOVATECH ENG CORPORATION
US-2019296159-A1,SHINETSU CHEMICAL CO
US-2019355117-A1,UNIV COLUMBIA
US-2019287354-A1,PANASONIC IP MAN CO LTD
US-2019291222-A1,RATTUNDE AG
US-2019294624-A1,TOSHIBA KK
US-2019294624-A1,TOSHIBA DIGITAL SOLUTIONS CORP
US-2019390139-A1,VERSUM MAT US LLC
US-2019312662-A1,FUTUREWEI TECHNOLOGIES INC
US-2020014162-A1,CONNECTEURS ELECTRIQUES DEUTSCH
US-2019388150-A1,AVAVA INC
US-2019324472-A1,LG ELECTRONICS INC
US-2020412453-A1,ROLLS ROYCE CORP
US-2020412453-A1,ROLLS ROYCE NAM TECH INC
US-2021116345-A1,THOMPSON JERRY J
US-2019322088-A1,EXXONMOBIL CHEMICA

2025-01-20 01:03:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:03:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:03:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:03:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 87
2025-01-20 01:03:46 - snowflake.connector.connection - INFO - closed
2025-01-20 01:03:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:03:47 - root - INFO - SQL:
-- Query 6: Get assignee names for publications in CPC class 'A01B3'
SELECT DISTINCT a.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value:"code"::STRING LIKE 'A01B3%'
LIMIT 1000;
Results:
assignee_name
KIM JAE KEUN
KUHN SA
TRECKER FRANCIS J
WANG XUEDONG
GERBER HUBERT
JIM ALEX SMITH
LEMKEN GMBH & CO KG
BOTVID SETTERGREN ANDERS GOSTA
GLASIER HAROLD H
MARTIN DOMINIC R
RICHARD CO
GERBER MAURICE
NIEMEYER SOEHNE STAHL PFLUG
ARWAC LTD
AMAZONEN WERKE DREYER H
UNIV JIANGSU
GUERBET FRANCOIS
ELEOS ROBOTICS INC
WILLIAM HENRY HONY FROST
WALLNER KLAUS
SJOEHOLMS MEKANISKA AB
SOUTHERN PLOW COMPANY
TEXAS INDUSTRIES INC
AMAZONEN-WERKE H DREYER GMBH & CO KG
KIM BYUNG SUB
CAMPBELL CLARENCE L
KORSMEYER ERNEST H
LEINFELDER DIPL-LANDW HERMANN
ARTHUR BROOKS SPURR
CHOATE STOREY NORMAN
SIGFRID ANDERSON ANDERS
ZHANG LIJIN
WILLIAM DREFKE
SHEPPARD RICHARD H
QUINSTAR CORP
DAEHO FARMING MACHINERY CO LTD
CHRISTOPHER H R WOODWARD
SAPHIR MASCHB GMBH
Liu Yueshang
MCKAY RALPH LTD
CHONGQING YUBAO AGRICULTURE EXPL CO LTD
CHONGQING TIANJI IND CO LTD
PREC PLANTING LLC
AUGUST SETTERGREN OTTO GORAN
INT HARVESTER GREAT BRITAIN
BULLS CO LTD
TWOSE OF TIVERTON LTD
HUBEI SHUANGYU MACHINERY TECH CO LTD
KUBOTA KK
FISHER VAN E
SALGE HENRY F
KIM JONG JIN
HUBER FRANZ FERDINAND
UNIV HEILONGJIANG SCI & TECH
LEIJENAAR SYTZE
CNH IND AMERICA LLC
UNIV CHUNG ANG IND
WALTER ROWAN JAMES
SAMSUNG SDI CO LTD
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY
CHRISTEN ARNE JENSEN
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC
CHO SUNG GU
MARTIN CHARLES H
LG ELECTRONICS INC
NEW ZEALAND INVENTIONS DEV
HARRELL DANNY H
RUDOLPH HASSON PAUL
HOLGER LETH
LIM HEON HO
LELY NV C VAN DER
DEERE & CO
SAMSUNG KWANGJU ELECTRONICS CO
DAIYO TANGO CO LTD
GEORGE A KELLY PLOW COMPANY
OTULAK PRZEMYSLAW PRO CNC
PATENT CONCERN NV
UNIV TONGJI
EDMOND HEE
EDWARDS JOHN W
EMPR IMPORT EXPORT Y DISTRIB P
CARLUCCI JAMES J
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD
ALLEN SAMUEL L
AGSOILWORKS TECH COMPANY LLC
UNIV SYDNEY
BETEK GMBH & CO KG

2025-01-20 01:03:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:03:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:03:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:03:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 87
2025-01-20 01:03:48 - snowflake.connector.connection - INFO - closed
2025-01-20 01:03:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:03:49 - root - INFO - SQL:
-- Query 7: Count applications per assignee in CPC class 'A01B3'
SELECT a.value:"name"::STRING AS "assignee_name", COUNT(DISTINCT t."publication_number") AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value:"code"::STRING LIKE 'A01B3%'
GROUP BY "assignee_name"
ORDER BY "application_count" DESC
LIMIT 1000;
Results:
assignee_name,application_count
LELY NV C VAN DER,5
DEERE & CO,4
AMAZONEN WERKE DREYER H,2
BOTVID SETTERGREN ANDERS GOSTA,1
KUHN SA,1
MARTIN DOMINIC R,1
SAMSUNG SDI CO LTD,1
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1
PREC PLANTING LLC,1
LEMKEN GMBH & CO KG,1
WILLIAM DREFKE,1
ZHANG LIJIN,1
SIGFRID ANDERSON ANDERS,1
GEORGE A KELLY PLOW COMPANY,1
LG ELECTRONICS INC,1
NEW ZEALAND INVENTIONS DEV,1
QUINSTAR CORP,1
DAEHO FARMING MACHINERY CO LTD,1
SOUTHERN PLOW COMPANY,1
TEXAS INDUSTRIES INC,1
KIM BYUNG SUB,1
SHEPPARD RICHARD H,1
AMAZONEN-WERKE H DREYER GMBH & CO KG,1
MARTIN CHARLES H,1
KIM JAE KEUN,1
EDWARDS JOHN W,1
WILLIAM HENRY HONY FROST,1
SJOEHOLMS MEKANISKA AB,1
ELEOS ROBOTICS INC,1
FISHER VAN E,1
KUBOTA KK,1
DAIYO TANGO CO LTD,1
SAMSUNG KWANGJU ELECTRONICS CO,1
GLASIER HAROLD H,1
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,1
CHRISTEN ARNE JENSEN,1
CHO SUNG GU,1
GERBER HUBERT,1
WANG XUEDONG,1
AUGUST SETTERGREN OTTO GORAN,1
CNH IND AMERICA LLC,1
LEIJENAAR SYTZE,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,1
AGSOILWORKS TECH COMPANY LLC,1
ALLEN SAMUEL L,1
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,1
MCKAY RALPH LTD,1
OTULAK PRZEMYSLAW PRO CNC,1
PATENT CONCERN NV,1
UNIV TONGJI,1
HUBER FRANZ FERDINAND,1
UNIV HEILONGJIANG SCI & TECH,1
Liu Yueshang,1
SAPHIR MASCHB GMBH,1
EDMOND HEE,1
GUERBET FRANCOIS,1
RICHARD CO,1
CHOATE STOREY NORMAN,1
LEINFELDER DIPL-LANDW HERMANN,1
KORSMEYER ERNEST H,1
ARTHUR BROOKS SPURR,1
CHONGQING TIANJI IND CO LTD,1
UNIV CHUNG ANG IND,1
WALTER ROWAN JAMES,1
HUBEI SHUANGYU MACHINERY TECH CO LTD,1
TWOSE OF TIVERTON LTD,1
INT HARVESTER GREAT BRITAIN,1
BULLS CO LTD,1
RUDOLPH HASSON PAUL,1
UNIV JIANGSU,1
ARWAC LTD,1
NIEMEYER SOEHNE STAHL PFLUG,1
SALGE HENRY F,1
KIM JONG JIN,1
CARLUCCI JAMES J,1
EMPR IMPORT EXPORT Y DISTRIB P,1
HOLGER LETH,1
LIM HEON HO,1
BETEK GMBH & CO KG,1
UNIV SYDNEY,1
GERBER MAURICE,1
CAMPBELL CLARENCE L,1
WALLNER KLAUS,1
CHRISTOPHER H R WOODWARD,1
TRECKER FRANCIS J,1
JIM ALEX SMITH,1
HARRELL DANNY H,1

2025-01-20 01:03:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:03:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:03:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:03:50 - snowflake.connector.connection - INFO - closed
2025-01-20 01:03:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:04:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 01:04:17 - root - INFO - The error message indicates that the query is attempting to parse a value of `'0'` as a date using the format `'YYYYMMDD'`, which is not a valid date format. This occurs because some records in the `"filing_date"` column have invalid or missing dates represented as `0` or other non-date values.

To resolve this issue, we need to modify the query to exclude records where `"filing_date"` cannot be parsed as a valid date. Here are a few ways to handle this:

1. **Filter out invalid dates using a WHERE clause:**

   We can add a condition to exclude records where `"filing_date"` is `0` or not an 8-digit number.

   ```sql
   SELECT t."publication_number", t."filing_date",
          TO_CHAR(TO_DATE(t."filing_date"::STRING, 'YYYYMMDD'), 'YYYY') AS "filing_year"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   WHERE t."filing_date" > 19000101  -- Assuming dates are after January 1, 1900
     AND LENGTH(t."filing_date"::STRING) = 8
   LIMIT 1000;
   ```

2. **Use `TRY_TO_DATE` to handle invalid dates gracefully:**

   The `TRY_TO_DATE` function attempts to parse the date and returns `NULL` if it fails. We can then filter out the `NULL` values.

   ```sql
   SELECT t."publication_number", t."filing_date",
          TO_CHAR(TRY_TO_DATE(t."filing_date"::STRING, 'YYYYMMDD'), 'YYYY') AS "filing_year"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   WHERE TRY_TO_DATE(t."filing_date"::STRING, 'YYYYMMDD') IS NOT NULL
   LIMIT 1000;
   ```

   Alternatively, use a subquery to filter out `NULL` years:

   ```sql
   SELECT "publication_number", "filing_date", "filing_year"
   FROM (
     SELECT t."publication_number", t."filing_date",
            TO_CHAR(TRY_TO_DATE(t."filing_date"::STRING, 'YYYYMMDD'), 'YYYY') AS "filing_year"
     FROM PATENTS.PATENTS.PUBLICATIONS t
   ) sub
   WHERE "filing_year" IS NOT NULL
   LIMIT 1000;
   ```

3. **Use a regular expression to ensure the date format is correct:**

   ```sql
   SELECT t."publication_number", t."filing_date",
          TO_CHAR(TO_DATE(t."filing_date"::STRING, 'YYYYMMDD'), 'YYYY') AS "filing_year"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   WHERE REGEXP_LIKE(t."filing_date"::STRING, '^\d{8}$')
   LIMIT 1000;
   ```

   This query only includes records where the `"filing_date"` consists of exactly 8 digits.

**Explanation:**

The error occurs because the `TO_DATE` function cannot parse the value `'0'` as a date in the `'YYYYMMDD'` format. By adding a condition to filter out invalid or malformed dates, we ensure that only records with valid dates are processed.

**Updated Query:**

Here's the adjusted query using `TRY_TO_DATE`:

```sql
SELECT t."publication_number", t."filing_date",
       TO_CHAR(TRY_TO_DATE(t."filing_date"::STRING, 'YYYYMMDD'), 'YYYY') AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE TRY_TO_DATE(t."filing_date"::STRING, 'YYYYMMDD') IS NOT NULL
LIMIT 1000;
```

**Sample Results:**

```csv
publication_number,filing_date,filing_year
US-2018001234-A1,20171231,2017
US-2018005678-A1,20180115,2018
US-2018009101-A1,20171201,2017
...
```

This query retrieves the `"publication_number"`, `"filing_date"`, and the extracted `"filing_year"` for records with valid filing dates.

**Note:** The sample results are illustrative. The actual data will depend on the contents of the `PATENTS.PATENTS.PUBLICATIONS` table.
2025-01-20 01:04:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:04:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:04:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:04:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 01:04:19 - snowflake.connector.connection - INFO - closed
2025-01-20 01:04:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:04:48 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 01:04:48 - root - INFO - SQL:
SELECT t."publication_number", t."filing_date",
          TO_CHAR(TO_DATE(t."filing_date"::STRING, 'YYYYMMDD'), 'YYYY') AS "filing_year"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   WHERE t."filing_date" > 19000101  -- Assuming dates are after January 1, 1900
     AND LENGTH(t."filing_date"::STRING) = 8
   LIMIT 1000;
Results:
Too long, hard cut:
publication_number,filing_date,filing_year
CN-213876397-U,20210119,2021
CN-214833400-U,20210119,2021
CN-214066419-U,20210120,2021
CN-214244054-U,20210120,2021
CN-214294023-U,20210120,2021
CN-214995710-U,20210120,2021
CN-214682489-U,20210121,2021
CN-214413421-U,20210121,2021
CN-214974752-U,20210121,2021
CN-214196462-U,20210121,2021
CN-214386227-U,20210122,2021
CN-214477141-U,20210122,2021
CN-214391350-U,20210902,2021
CN-215025685-U,20210122,2021
CN-214362850-U,20210125,2021
CN-215876011-U,20210122,2021
CN-214549176-U,20210125,2021
CN-214552811-U,20210125,2021
CN-214121216-U,20210125,2021
CN-215903984-U,20210126,2021
CN-214202449-U,20210125,2021
CN-214613168-U,20210125,2021
CN-213907201-U,20210126,2021
CN-214573933-U,20210126,2021
CN-213876513-U,20210127,2021
CN-214522965-U,20210127,2021
CN-214801320-U,20210125,2021
CN-214686114-U,20210127,2021
CN-214171464-U,20210127,2021
CN-214357762-U,20210127,2021
CN-214742053-U,20210127,2021
CN-213955243-U,20210128,2021
CN-214278147-U,20210128,2021
CN-214844909-U,20210128,2021
CN-214666458-U,20210128,2021
CN-214842776-U,20210128,2021
CN-214575708-U,20210128,2021
CN-215082240-U,20210128,2021
CN-214202692-U,20210130,2021
CN-214878864-U,20210130,2021
CN-214041949-U,20210130,2021
CN-215159870-U,20210130,2021
CN-214549984-U,20210130,2021
CN-215643409-U,20210201,2021
CN-214649580-U,20210201,2021
CN-214914572-U,20210201,2021
CN-215794173-U,20210129,2021
CN-214496842-U,20210201,2021
CN-215914717-U,20210201,2021
CN-214517024-U,20210201,2021
CN-214572413-U,20210201,2021
CN-214715286-U,20210202,2021
CN-214983050-U,20210202,2021
CN-214200705-U,20210202,2021
CN-214984951-U,20210202,2021
CN-214173170-U,20210202,2021
CN-215383847-U,20210202,2021
CN-214675809-U,20210203,2021
CN-214357173-U,20210203,2021
CN-215751125-U,20210203,2021
CN-215130215-U,20210203,2021
CN-214363393-U,20210204,2021
CN-214575072-U,20210204,2021
CN-214562366-U,20210204,2021
CN-215624340-U,20210204,2021
CN-214306968-U,20210204,2021
CN-214682433-U,20210205,2021
CN-214659071-U,20210205,2021
CN-214348851-U,20210205,2021
CN-215152539-U,20210205,2021
CN-214226644-U,20210207,2021
CN-214955175-U,20210205,2021
CN-214730823-U,20210207,2021
CN-214826107-U,20210205,2021
CN-215082866-U,20210205,2021
CN-215185519-U,20210205,2021
CN-214274011-U,20210207,2021
CN-214204421-U,20210207,2021
CN-214278490-U,20210207,2021
CN-214880082-U,20210208,2021
CN-215408439-U,20210207,2021
CN-214898449-U,20210208,2021
CN-215247418-U,20210209,2021
CN-215083502-U,20210218,2021
CN-214494539-U,20210219,2021
CN-215280361-U,20210220,2021
CN-214040622-U,20210221,2021
CN-213231849-U,20210222,2021
CN-214992561-U,20210222,2021
CN-214479603-U,20210223,2021
CN-214592931-U,20210223,2021
CN-214198349-U,20210223,2021
CN-214633866-U,20210223,2021
CN-215244489-U,20210223,2021
CN-215225252-U,20210224,2021
CN-215242675-U,20210223,2021
CN-215362744-U,20210224,2021
CN-214816893-U,20210225,2021
CN-214575906-U,20210225,2021
CN-214608409-U,20210226,2021
CN-214316794-U,20210226,2021
CN-214644542-U,20210226,2021
CN-214389146-U,20210301,2021
CN-215059600-U,20210301,2021
CN-214804098-U,20210301,2021
CN-214763449-U,20210301,2021
CN-214536674-U,20210301,2021
CN-214147606-U,20210302,2021
CN-214617553-U,20210302,2021
CN-214337023-U,20210302,2021
CN-214379854-U,20210302,2021
CN-214512518-U,20210303,2021
CN-214608869-U,20210304,2021
CN-214692106-U,20210303,2021
CN-215652174-U,20210304,2021
CN-214993944-U,20210303,2021
CN-214436335-U,20210304,2021
CN-214583280-U,20210308,2021
CN-214387007-U,20210307,2021
CN-214774083-U,20210306,2021
CN-214405646-U,20210305,2021
CN-214381782-U,20210308,2021
CN-214748932-U,20210306,2021
CN-215127650-U,20210308,2021
CN-214760436-U,20210308,2021
CN-214457762-U,20210306,2021
CN-214572592-U,20210305,2021
CN-214555757-U,20210309,2021
CN-214509295-U,20210309,2021
CN-214969035-U,20210309,2021
CN-214693650-U,20210310,2021
CN-214960404-U,20210310,2021
CN-214377762-U,20210310,2021
CN-214482590-U,20210311,2021
CN-215297031-U,20210312,2021
CN-214646628-U,20210312,2021
CN-214397066-U,20210311,2021
CN-215274309-U,20210313,2021
CN-214535333-U,20210313,2021
CN-215361093-U,20210313,2021
CN-214700732-U,20210315,2021
CN-214601146-U,20210315,2021
CN-215028665-U,20210316,2021
CN-214502357-U,20210316,2021
CN-214893139-U,20210315,2021
CN-215008204-U,20210315,2021
CN-215123062-U,20210316,2021
CN-214516831-U,20210316,2021
CN-214649153-U,20210316,2021
CN-214829540-U,20210317,2021
CN-214750133-U,20210317,2021
CN-218625958-U,20210317,2021
CN-214642763-U,20210317,2021
CN-215130687-U,20210316,2021
CN-214647899-U,20210318,2021
CN-214381800-U,20210318,2021
CN-214956910-U,20210318,2021
CN-214916416-U,20210318,2021
CN-215615927-U,20210318,2021
CN-213375840-U,20210319,2021
CN-215155549-U,20210319,2021
CN-214580863-U,20210320,2021
CN-214482019-U,20210320,2021
CN-214700498-U,20210322,2021
CN-215781521-U,20210322,2021
CN-215015329-U,20210322,2021
CN-215273587-U,20210323,2021
CN-216091492-U,20220122,2022
CN-216963330-U,20210323,2021
CN-214373004-U,20210323,2021
CN-214492826-U,20210323,202

2025-01-20 01:04:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:04:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:04:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:04:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 57
2025-01-20 01:04:49 - snowflake.connector.connection - INFO - closed
2025-01-20 01:04:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:04:50 - root - INFO - SQL:
-- Corrected Query 9: Count applications per year in CPC class 'A01B3' with valid filing dates
SELECT TO_CHAR(TRY_TO_DATE(t."filing_date"::STRING, 'YYYYMMDD'), 'YYYY') AS "filing_year",
       COUNT(DISTINCT t."publication_number") AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value:"code"::STRING LIKE 'A01B3%'
  AND TRY_TO_DATE(t."filing_date"::STRING, 'YYYYMMDD') IS NOT NULL
GROUP BY "filing_year"
ORDER BY "filing_year"
LIMIT 1000
Results:
filing_year,application_count
1901,1
1904,1
1912,1
1913,1
1918,2
1920,1
1925,1
1926,2
1931,1
1934,2
1935,1
1947,1
1948,1
1950,2
1951,1
1954,1
1955,1
1956,1
1960,2
1967,1
1969,1
1973,1
1974,2
1975,3
1976,1
1978,1
1979,3
1980,1
1981,2
1982,2
1983,1
1985,1
1987,2
1991,2
1993,2
1996,3
1997,1
2000,3
2001,1
2002,1
2004,3
2005,1
2006,1
2009,1
2010,1
2011,1
2012,3
2013,1
2015,3
2016,4
2017,8
2018,6
2019,5
2020,2
2021,2
2022,5
2023,1

2025-01-20 01:04:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:04:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:04:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:04:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-01-20 01:04:51 - snowflake.connector.connection - INFO - closed
2025-01-20 01:04:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:04:52 - root - INFO - SQL:
-- Corrected Query 10: Get country codes for applications in CPC class 'A01B3' excluding null country codes
SELECT t."country_code",
       COUNT(DISTINCT t."publication_number") AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value:"code"::STRING LIKE 'A01B3%'
  AND t."country_code" IS NOT NULL
GROUP BY t."country_code"
ORDER BY "application_count" DESC
LIMIT 1000
Results:
country_code,application_count
US,36
KR,18
CN,17
GB,7
DE,7
CA,5
FR,4
BE,4
AU,3
IT,3
JP,3
NO,2
NL,2
EP,2
RU,1
IL,1
PL,1
ZA,1
AT,1
HU,1

2025-01-20 01:04:52 - root - INFO - itercount: 0
2025-01-20 01:04:52 - root - INFO - Database Name: PATENTS
Schema Name: PATENTS
DDL describes table information.
,0
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,1
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""spif_publication_number"" VARCHAR(16777216),
	""spif_application_number"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""claims_localized_html"" VARIANT,
	""description_localized"" VARIANT,
	""description_localized_html"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""locarno"" VARIANT,
	""citation"" VARIANT,
	""parent"" VARIANT,
	""child"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,2
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
First, let's identify the relevant tables and columns for the task:

- **Table:** `PUBLICATIONS`

  - **"cpc":** Used to filter patents in the CPC class `A01B3`. This column is of `VARIANT` type and may contain nested JSON data.
  - **"assignee_harmonized":** Contains the assignee names, stored as `VARIANT`. We may need to extract the `"name"` field.
  - **"filing_date":** Used to determine the filing year of applications.
  - **"publication_number":** Unique identifier for applications, used to count total applications.
  - **"country_code":** Represents the country code of the application.

- **Conditions that may be used:**

  - Filtering on `"cpc"` codes that match `'A01B3'`.
  - Extracting and grouping by the year from `"filing_date"`.
  - Extracting the `"name"` field from `"assignee_harmonized"`.

Here are some SQL queries to explore the data:

```sql
-- Query 1: View sample CPC entries to understand the structure
SELECT t."publication_number", t."cpc"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 1000;
```

```sql
-- Query 2: Flatten the "cpc" column to extract individual CPC codes
SELECT t."publication_number", c.value AS "cpc_entry"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
LIMIT 1000;
```

```sql
-- Query 3: Extract CPC codes from the flattened "cpc" column
SELECT t."publication_number", c.value:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
LIMIT 1000;
```

```sql
-- Query 4: Find publications with CPC code starting with 'A01B3'
SELECT t."publication_number", c.value:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value:"code"::STRING LIKE 'A01B3%'
LIMIT 1000;
```

```sql
-- Query 5: Extract assignee names from "assignee_harmonized"
SELECT t."publication_number", a.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
LIMIT 1000;
```

```sql
-- Query 6: Get assignee names for publications in CPC class 'A01B3'
SELECT DISTINCT a.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value:"code"::STRING LIKE 'A01B3%'
LIMIT 1000;
```

```sql
-- Query 7: Count applications per assignee in CPC class 'A01B3'
SELECT a.value:"name"::STRING AS "assignee_name", COUNT(DISTINCT t."publication_number") AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value:"code"::STRING LIKE 'A01B3%'
GROUP BY "assignee_name"
ORDER BY "application_count" DESC
LIMIT 1000;
```

```sql
-- Query 8: Extract filing year from "filing_date"
SELECT t."publication_number", t."filing_date", TO_CHAR(TO_DATE(t."filing_date"::STRING, 'YYYYMMDD'), 'YYYY') AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 1000;
```

```sql
-- Query 9: Count applications per year in CPC class 'A01B3'
SELECT TO_CHAR(TO_DATE(t."filing_date"::STRING, 'YYYYMMDD'), 'YYYY') AS "filing_year", COUNT(DISTINCT t."publication_number") AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value:"code"::STRING LIKE 'A01B3%'
GROUP BY "filing_year"
ORDER BY "filing_year"
LIMIT 1000;
```

```sql
-- Query 10: Get country codes for applications in CPC class 'A01B3'
SELECT t."country_code", COUNT(DISTINCT t."publication_number") AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value:"code"::STRING LIKE 'A01B3%'
GROUP BY t."country_code"
ORDER BY "application_count" DESC
LIMIT 1000;
```

These queries aim to:

1. **Understand the structure of the `"cpc"` column** by viewing sample entries.
2. **Flatten and extract CPC codes** to filter patents belonging to the CPC class `'A01B3'`.
3. **Extract assignee names** from the `"assignee_harmonized"` column.
4. **Count the number of applications per assignee** to identify top assignees.
5. **Determine the filing year** of applications to find out in which year the most applications were filed.
6. **Count applications per country code** to identify regions with the most filings.

Please note that these queries are designed to explore the data structure and content, helping to understand how to extract and manipulate the necessary information for further analysis.Query:
-- Query 1: View sample CPC entries to understand the structure
SELECT t."publication_number", t."cpc"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,cpc
CR-5634-A,[]
CR-5990-A,[]
FI-429-A,[]
HK-6083-A,"[
  {
    ""code"": ""H02M5/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
HU-T52763-A,"[
  {
    ""code"": ""A01N47/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D521/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
JP-H03206829-A,"[
  {
    ""code"": ""Y02A40/81"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
JP-S62159089-A,"[
  {
    ""code"": ""Y02E30/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
US-416-A,"[
  {
    ""code"": ""Y10T83/465"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""B26F1/42"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
US-2528225-A,"[
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A41580-A,"[
  {
    ""code"": ""B22D11/086"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A47682-A,"[
  {
    ""code"": ""C07D471/16"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D471/22"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A63682-A,"[
  {
    ""code"": ""G01N33/48728"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-920790-A,"[
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-950907-A,"[
  {
    ""code"": ""C11B5/0064"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/35"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C11B5/0035"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M135/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C09K15/30"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D263/56"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/44"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D235/12"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/3447"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/48"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/46"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D277/64"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/47"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/224"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/102"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/106"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/104"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/10"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/221"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/226"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/225"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/22"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10L1/14"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-920830-A,"[
  {
    ""code"": ""E02D5/808"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/385"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/26"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/28"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/54"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-9086-A,[]
CH-3256-A,[]
CH-540255-A,"[
  {
    ""code"": ""C07D213/32"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/51"",
    ""first"": false,
    ""inven
Query:
-- Query 2: Flatten the "cpc" column to extract individual CPC codes
SELECT t."publication_number", c.value AS "cpc_entry"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,cpc_entry
US-2004046148-A1,"{
  ""code"": ""C23F1/26"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""H01L21/3212"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""C23F3/06"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""H01L21/32134"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""C23F3/06"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""C09G1/02"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""H01L21/32115"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""C23F3/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""C23F1/18"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""C09G1/02"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""C23F3/06"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""H01L21/32115"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""H01L21/3212"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""C23F1/18"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""C23F3/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004046148-A1,"{
  ""code"": ""H01L21/32134"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004249430-A1,"{
  ""code"": ""A61N1/05"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
US-2004249430-A1,"{
  ""code"": ""A61N1/05"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
US-2004249430-A1,"{
  ""code"": ""A61N1/056"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004249430-A1,"{
  ""code"": ""A61N1/056"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004254481-A1,"{
  ""code"": ""A61B7/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004254481-A1,"{
  ""code"": ""A61B5/318"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004254481-A1,"{
  ""code"": ""A61B7/04"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004254481-A1,"{
  ""code"": ""A61B5/0816"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
US-2004254481-A1,"{
  ""code"": ""A61B5/0816"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
US-2004254481-A1,"{
  ""code"": ""A61B5/318"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/0421"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/3095"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/3072"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/02476"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/0217"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/18308"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/18375"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/18377"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/04253"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/04252"",
  ""first"": false,
  ""inventive"": true,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/18369"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/18375"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/18369"",
  ""first"": true,
  ""inventive"": true,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/18308"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/0217"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/3072"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/02476"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/18377"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/0421"",
  ""first"": false,
  ""inventive"": false,
  ""tree"": []
}"
US-2004179568-A1,"{
  ""code"": ""H01S5/3095"",
  ""first"": false,
Query:
-- Query 3: Extract CPC codes from the flattened "cpc" column
SELECT t."publication_number", c.value:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,cpc_code
US-2018235635-A1,A61B17/072
US-2018235635-A1,A61B2017/07257
US-2018235635-A1,A61B17/1155
US-2018235635-A1,A61B2017/1157
US-2018235635-A1,A61B2017/1157
US-2018235635-A1,A61B2017/07257
US-2018235635-A1,A61B17/072
US-2018235635-A1,A61B17/1155
US-2018235635-A1,A61B17/1155
US-2018201131-A1,B60K28/066
US-2018201131-A1,B60W2540/24
US-2018201131-A1,B60K28/063
US-2018201131-A1,B60W2540/24
US-2018201131-A1,B60K28/06
US-2018201131-A1,B60K28/063
US-2018201131-A1,B60W40/08
US-2018201131-A1,B60K28/06
US-2018201131-A1,B60W2040/0836
US-2018201131-A1,B60W2040/0836
US-2018201131-A1,B60K28/063
US-2018201131-A1,B60W40/08
US-2018201131-A1,B60K28/063
US-2017235415-A1,G06F3/044
US-2017235415-A1,G06F3/0416
US-2017235415-A1,G06F3/04166
US-2017235415-A1,G06F3/0446
US-2017235415-A1,G06F3/0418
US-2017235415-A1,G06F3/04166
US-2017235415-A1,G06F3/0418
US-2017235415-A1,G06F3/044
US-2017244772-A1,H04L2012/6483
US-2017244772-A1,H04N21/8456
US-2017244772-A1,H04L67/02
US-2017244772-A1,H04N21/8455
US-2017244772-A1,H04N21/4751
US-2017244772-A1,H04L65/4084
US-2017244772-A1,H04L61/1582
US-2017244772-A1,H04L65/607
US-2017244772-A1,H04L67/34
US-2017244772-A1,H04L65/613
US-2017244772-A1,H04L65/613
US-2017244772-A1,H04L67/02
US-2017244772-A1,H04L2012/6483
US-2017244772-A1,H04N21/8456
US-2017244772-A1,H04N21/8455
US-2017244772-A1,H04L61/457
US-2017244772-A1,H04L65/612
US-2017244772-A1,H04L65/70
US-2017244772-A1,H04L65/612
US-2017244772-A1,H04N21/4751
US-2017244772-A1,H04L65/65
US-2017244772-A1,H04L67/34
US-2017251351-A1,H04M15/44
US-2017251351-A1,H04L12/1439
US-2017251351-A1,H04M15/60
US-2017251351-A1,H04L12/1435
US-2017251351-A1,H04M15/43
US-2017251351-A1,H04W4/24
US-2017251351-A1,H04M15/43
US-2017251351-A1,H04W4/24
US-2017251351-A1,H04M15/62
US-2017251351-A1,H04M15/41
US-2017251351-A1,H04M15/44
US-2017251351-A1,H04M15/41
US-2017251351-A1,H04L12/1435
US-2017251351-A1,H04W24/08
US-2017251351-A1,H04M15/62
US-2017251351-A1,H04L12/1439
US-2017251351-A1,H04W4/24
US-2017251351-A1,H04W24/08
US-2017251351-A1,H04M15/60
US-2018332422-A1,A63F2300/538
US-2018332422-A1,A63F2300/6063
US-2018332422-A1,A63F13/86
US-2018332422-A1,H04S7/303
US-2018332422-A1,H04S2400/11
US-2018332422-A1,G11B27/005
US-2018332422-A1,G06F3/165
US-2018332422-A1,H04S2420/11
US-2018332422-A1,H04N21/233
US-2018332422-A1,G11B2020/10546
US-2018332422-A1,A63F13/525
US-2018332422-A1,A63F2300/538
US-2018332422-A1,A63F2300/6661
US-2018332422-A1,H04N21/23418
US-2018332422-A1,G11B20/10527
US-2018332422-A1,A63F2300/6607
US-2018332422-A1,A63F2300/6607
US-2018332422-A1,A63F2300/6063
US-2018332422-A1,G06T15/20
US-2018332422-A1,A63F13/525
US-2018332422-A1,A63F2300/6661
US-2018332422-A1,H04S2420/11
US-2018332422-A1,G11B20/10527
US-2018332422-A1,G11B2020/10546
US-2018332422-A1,H04N21/23418
US-2018332422-A1,G06T15/20
US-2018332422-A1,H04N21/233
US-2018332422-A1,H04S2400/11
US-2018332422-A1,G06F3/165
US-2018332422-A1,G11B27/005
US-2018332422-A1,H04S7/303
US-2018332422-A1,A63F13/86
US-2018344618-A1,A61K8/37
US-2018344618-A1,A61K8/8182
US-2018344618-A1,A61K8/062
US-2018344618-A1,A61K2800/5426
US-2018344618-A1,A61Q1/10
US-2018344618-A1,A61K2800/594
US-2018344618-A1,A61K2800/594
US-2018344618-A1,A61K8/062
US-2018344618-A1,A61K2800/524
US-2018344618-A1,A61Q1/10
US-2018344618-A1,A61K8/86
US-2018344618-A1,A61K2800/43
US-2018344618-A1,A61K2800/524
US-2018344618-A1,A61K8/416
US-2018344618-A1,A61K2800/43
US-2018344618-A1,A61K8/463
US-2018344618-A1,A61K2800/5426
US-2018344618-A1,A61K8/8182
US-2018344618-A1,A61K2800/83
US-2018344618-A1,A61K8/31
US-2018344618-A1,A61K8/463
US-2018344618-A1,A61K2800/43
US-2018344618-A1,A61K8/8182
US-2018344618-A1,A61K2800/5426
US-2018344618-A1,A61K8/732
US-2018344618-A1,A61K2800/594
US-2018344618-A1,A61K8/375
US-2018344618-A1,A61K8/463
US-2018344618-A1,A61K8/062
US-2018344618-A1,A61K8/8111
US-2018344618-A1,A61Q1/10
US-2018344618-A1,A61K8/92
US-2018344618-A1,A61K2800/524
US-2018344618-A1,A61K8/8147
US-2018344618-A1,A61K2800/83
US-2018344618-A1,A61K8/86
US-2018344618-A1,A61K8/31
US-2018344618-A1,A61K8/416
US-2018344618-A1,A61K8/37
US-2017365978-A1,H01S5/04254
US-2017365978-A1,H01S5/4087
US-2017365978-A1,B23K26/382
US-2017365978-A1,B23K26/703
US-2017365978-A1,H01S5/04254
US-2017365978-A1,B23K26/21
US-2017365978-A1,B23K26/38
US-2017365978-A1,H01S5/4087
US-2017365978-A1,H01S5/143
US-2017365978-A1,H01S5/4025
US-2017365978-A1,B23K26/382
US-2017365978-A1,H01S5/02423
US-2017365978-A1,H01S5/143
US-2017365978-A1,H01S3/08086
US-2017365978-A1,B23K26/703
US-2017365978-A1,H01S5/4025
US-2017365978-A1,G02B27/30
US-2017365978-A1,H01S5/4012
US-2017365978-A1,B23K26/38
US-2017365978-A1,H01S5/02423
US-2017365978-A1,H01S5/4012
US-2017365978-A1,H01S5/02423
US-2017365978-A1,H01S5/4025
US-2017365978-A1,H01S5/143
US-2017365978-A1,G02B27/30
US-2017365978-A1,H01S3/08086
US-2017365978-A1,H01S5/02236
US-2017365978-A1,B23K26/21
US-2017365978-A1,H01S5/023
US-2017365978-A1,H01S5/0233
US-2017365978-A1,H01S5/0235
US-2017365978-A1,H01S5/023
US-2017365978-A1,H01S5/0233
US-2017282979-A1,B62D21/14
US-
Query:
-- Query 4: Find publications with CPC code starting with 'A01B3'
SELECT t."publication_number", c.value:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value:"code"::STRING LIKE 'A01B3%'
LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,cpc_code
KR-200386017-Y1,A01B3/28
RU-191537-U1,A01B35/20
US-694931-A,A01B3/08
CN-109392332-A,A01B35/20
CN-109392332-A,A01B35/26
DE-463858-C,A01B35/04
CA-2945250-A1,A01B33/106
CA-2945250-A1,A01B33/106
EP-3586579-A1,A01B33/087
EP-3586579-A1,A01B37/00
US-2843032-A,A01B39/14
US-2843032-A,A01B39/14
US-1860534-A,A01B3/50
US-1860534-A,A01B3/50
US-501724-A,A01B3/464
US-2784656-A,A01B35/14
US-2784656-A,A01B35/14
US-2039702-A,A01B39/19
US-2039702-A,A01B39/19
AU-7115874-A,A01B35/26
GB-436304-A,A01B35/16
GB-436304-A,A01B33/021
US-5669452-A,A01B35/04
US-5669452-A,A01B35/04
US-159642-A,A01B35/08
US-395573-A,A01B35/26
US-2019324472-A1,A01B39/18
BE-826346-A,A01B33/106
BE-826346-A,A01B33/106
CN-108575125-A,A01B33/12
CN-108575125-A,A01B33/10
CN-113796181-A,A01B33/08
CN-113796181-A,A01B33/10
CN-106973572-B,A01B39/18
NL-183071-C,A01B33/065
NL-183071-C,A01B33/065
FR-2943502-A1,A01B39/163
CN-107072143-A,A01B35/225
CN-107072143-A,A01B35/225
CN-107072143-A,A01B35/225
CN-107094377-A,A01B33/08
CN-107094377-A,A01B33/144
KR-20020067218-A,A01B39/18
CN-115362764-A,A01B35/16
CN-115362764-A,A01B35/28
NO-153631-B,A01B35/00
CN-104040083-B,A01B33/14
JP-S6342702-Y2,A01B33/028
JP-6910281-B2,A01B33/028
JP-6910281-B2,A01B33/024
KR-100191418-B1,A01B35/28
KR-100191418-B1,A01B35/18
GB-2598141-A,A01B39/06
GB-2598141-A,A01B39/18
GB-2598141-A,A01B39/18
CN-107646212-A,A01B35/22
CN-107646212-A,A01B35/04
IT-1166526-B,A01B33/146
IT-1166526-B,A01B33/106
IT-1166526-B,A01B33/065
IT-1166526-B,A01B33/065
IT-1166526-B,A01B33/106
IT-1166526-B,A01B33/146
DE-102010019819-B4,A01B3/464
US-1093294-A,A01B3/10
KR-20070101567-A,A01B33/146
KR-20070101567-A,A01B33/06
DE-1963184-U,A01B33/08
DE-1963184-U,A01B33/10
DE-1963184-U,A01B33/00
US-231385-A,A01B33/065
US-2888084-A,A01B33/06
US-1545136-A,A01B39/26
US-1545136-A,A01B39/26
US-220177-A,A01B35/18
US-3054462-A,A01B35/12
US-3054462-A,A01B35/12
FR-508965-A,A01B3/30
FR-508965-A,A01B3/18
CN-116671357-A,A01B39/085
CN-116671357-A,A01B39/22
CN-116671357-A,A01B39/20
GB-2039201-B,A01B33/106
US-10375891-B2,A01B39/18
US-10375891-B2,A01B39/18
US-10375891-B2,A01B39/18
CN-108289407-A,A01B33/16
CN-108289407-A,A01B33/16
CN-108289407-A,A01B35/32
KR-20020000597-A,A01B35/22
CN-114651538-A,A01B39/22
CN-114651538-A,A01B39/18
CN-114651538-A,A01B39/085
IT-8519066-A1,A01B33/065
IT-8519066-A1,A01B33/106
PL-440426-A1,A01B33/00
PL-440426-A1,A01B33/021
PL-440426-A1,A01B33/02
PL-440426-A1,A01B33/04
BE-1007083-A5,A01B39/16
BE-1007083-A5,A01B39/26
BE-727862-A,A01B33/021
US-1636048-A,A01B35/24
US-1636048-A,A01B35/24
US-1412308-A,A01B3/54
US-1412308-A,A01B3/54
US-828171-A,A01B3/26
US-3129772-A,A01B39/085
US-3129772-A,A01B39/085
US-530054-A,A01B39/14
US-1471180-A,A01B3/50
US-1471180-A,A01B3/50
DE-8707829-U1,A01B33/142
KR-20010029583-A,A01B33/00
CN-105325075-A,A01B33/103
CN-105325075-A,A01B33/024
CN-109005687-A,A01B33/065
CN-109005687-A,A01B33/082
CN-109005687-A,A01B33/08
KR-20130063834-A,A01B39/18
DE-140654-C,A01B3/12
KR-200194260-Y1,A01B35/10
DE-102017102683-A1,A01B35/18
KR-101378314-B1,A01B33/082
KR-200149462-Y1,A01B35/28
AU-2016269849-A1,A01B39/18
AU-2016269849-A1,A01B39/18
CN-113761309-A,A01B39/16
CN-113761309-A,A01B39/26
CN-113761309-A,A01B39/20
HU-E050035-T2,A01B35/24
KR-200473688-Y1,A01B35/16
JP-6998053-B2,A01B39/18
JP-6998053-B2,A01B39/18
KR-100626846-B1,A01B3/50
ZA-808003-B,A01B39/22
ZA-808003-B,A01B35/225
ZA-808003-B,A01B39/22
ZA-808003-B,A01B35/225
GB-2089182-B,A01B33/065
IT-1064821-B,A01B33/065
IT-1064821-B,A01B33/065
CA-2977468-A1,A01B33/024
AT-A720679-A,A01B33/106
NL-7909063-A,A01B33/103
US-469659-A,A01B35/08
EP-3474651-C0,A01B33/06
EP-3474651-C0,A01B35/16
AU-2002301383-B2,A01B35/225
AU-2002301383-B2,A01B35/225
CN-114916261-A,A01B35/20
CN-114916261-A,A01B35/26
NO-910950-L,A01B35/26
CA-3089518-A1,A01B39/18
KR-200487998-Y1,A01B39/18
BE-872468-A,A01B33/065
BE-872468-A,A01B33/16
BE-872468-A,A01B33/12
US-5845717-A,A01B37/00
US-5845717-A,A01B37/00
KR-102593393-B1,A01B33/082
KR-102593393-B1,A01B33/082
KR-102484290-B1,A01B33/14
KR-102484290-B1,A01B35/28
KR-102484290-B1,A01B33/14
KR-102484290-B1,A01B35/28
KR-900006618-B1,A01B33/14
US-2545590-A,A01B33/025
US-2545590-A,A01B33/025
CA-997451-A,A01B3/74
GB-2090713-B,A01B35/12
GB-2090713-B,A01B39/10
GB-2090713-B,A01B35/12
GB-2090713-B,A01B39/10
DE-829523-C,A01B3/32
CN-100366901-C,A01B33/021
US-130700-A,A01B35/08
FR-960102-A,A01B33/087
FR-960102-A,A01B33/082
US-5267618-A,A01B3/46
US-5267618-A,A01B3/46
KR-101169320-B1,A01B35/10
KR-101593221-B1,A01B3/36
GB-696973-A,A01B35/06
IL-268624-A,A01B3/24
IL-268624-A,A01B3/24
US-2597821-A,A01B39/00
US-2597821-A,A01B39/00
US-2597821-A,A01B35/26
US-2597821-A,A01B35/26
CA-2543900-A1,A01B33/103
CA-2543900-A1,A01B33/103
US-1081539-A,A01B35/06
US-376176-A,A01B3/26
GB-792883-A,A01B3/36
US-5407014-A,A01B31/00
US-5407014-A,A01B31/00
US-2024164239-A1,A01B35/08
US-2024164239-A1,A01B35/08
US-2024164239-A1,A01B35/08
FR-2287837-B1,A01B33/024
FR-2287837-B1,A01B33/08
FR-2287837-B1,A01B33/021
FR-2287837-B1,A01B33/08
FR-2287837-B1,A01B33/021
FR-2287837-B1,A01B33/024
US
Query:
-- Query 5: Extract assignee names from "assignee_harmonized"
SELECT t."publication_number", a.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,assignee_name
US-2019196084-A1,DURA OPERATING LLC
US-2018141325-A1,FUJIFILM CORP
US-2018187834-A1,SICK AG
US-2018204863-A1,IMEC VZW
US-2019223595-A1,GOPAL PAUL
US-2018155335-A1,UNIV HEALTH NETWORK
US-2018233997-A1,HONDA MOTOR CO LTD
US-2018337677-A1,IBM
US-2019266471-A1,IBM
US-2019267026-A1,AT & T IP I LP
US-2018254937-A1,COMMISSARIAT ENERGIE ATOMIQUE
US-2018277952-A1,FRACTUS ANTENNAS SL
US-2018211887-A1,SAMSUNG ELECTRONICS CO LTD
US-2018277686-A1,3 5 POWER ELECTRONICS GMBH
US-2018279332-A1,SAMSUNG ELECTRONICS CO LTD
US-2019297963-A1,MONTGOMERY TYRONE
US-2018342366-A1,NUFLARE TECHNOLOGY INC
US-2018239126-A1,SONY CORP
US-2019289218-A1,TAIWAN SEMICONDUCTOR MFG CO LTD
US-2019335520-A1,NOKIA SOLUTIONS & NETWORKS OY
US-2019140216-A1,SAMSUNG DISPLAY CO LTD
US-2018357938-A1,MCGREGOR JAMES BERRY
US-2018330780-A1,ST MICROELECTRONICS ROUSSET
US-2018370418-A1,OMRON TATEISI ELECTRONICS CO
US-2018286309-A1,SEMICONDUCTOR ENERGY LAB
US-2020057100-A1,ROHDE & SCHWARZ
US-2018294519-A1,HYUNDAI MOTOR CO LTD
US-2018294519-A1,KIA MOTORS CORP
US-2018291661-A1,CALDWELL MFG CO NORTH AMERICA LLC
US-2018293364-A1,DEAVER F SCOTT
US-2019157285-A1,TAIWAN SEMICONDUCTOR MFG CO LTD
US-2019003958-A1,CANON KK
US-2018306523-A1,FURUKAWA ELECTRIC CO LTD
US-2020015412-A1,CNH IND CANADA LTD
US-2019028639-A1,CANON KK
US-2019026669-A1,FILMIO INC
US-2018327034-A1,TOYOTA MOTOR CO LTD
US-2018365575-A1,GUTTMANN MOSHE
US-2018365575-A1,MALOWANY DAN IOSEF
US-2018365575-A1,AXLER GREGORY
US-2018365575-A1,Seematics Systems Ltd
US-2019010977-A1,MITSUBISHI HEAVY IND COMPRESSOR CORP
US-2021194641-A1,ERICSSON TELEFON AB L M
US-2021211830-A1,HEWLETT PACKARD DEVELOPMENT CO
US-2019089625-A1,NEW H3C TECH CO LTD
US-2019131531-A1,NOVALED GMBH
US-2020215441-A1,Polin Su Parklari Ve Havuz Sistemleri Anonim Sirketi
US-2019377516-A1,WESTERN DIGITAL TECH INC
US-2019058291-A1,HARUMOTO TECH SHEN ZHEN CO LTD
US-2020061221-A1,IBM
US-2018367810-A1,GE VIDEO COMPRESSION LLC
US-2020065758-A1,EXEL INC D/B/A DHL SUPPLY CHAIN USA
US-2020075499-A1,SEMICONDUCTOR COMPONENTS IND LLC
US-2020070846-A1,GM GLOBAL TECH OPERATIONS LLC
US-2019021138-A1,NVENT SERVICES GMBH
US-2019289695-A1,BOE TECHNOLOGY GROUP CO LTD
US-2019289695-A1,HEFEI BOE OPTOELECTRONICS TECH
US-2019258410-A1,BRITTNER ROD
US-2019258410-A1,BENSON RONALD G
US-2019159884-A1,MEDTRONIC VASCULAR INC
US-2020105090-A1,IGT RENO NEV
US-2020111592-A1,TAIWAN OASIS TECH CO LTD
US-2020072916-A1,HI LLC
US-2020180517-A1,LEAR CORP
US-2020194059-A1,IBM
US-2019186567-A1,MERITOR HEAVY VEHICLE BRAKING SYSTEMS UK LTD
US-2020162643-A1,CJ CGV CO LTD
US-2019200474-A1,FANUC CORP
US-2019231855-A1,BAXALTA INC
US-2019231855-A1,Baxalta GmbH
US-2019140614-A1,MURATA MANUFACTURING CO
US-2020067339-A1,DELTA ELECTRONICS INC
US-2020217420-A1,UNITED TECHNOLOGIES CORP
US-2019149296-A1,HUAWEI TECH CO LTD
US-2019313538-A1,DENSO TEN LTD
US-2019177896-A1,BEYER BEKIR
US-2020269134-A1,HAN TAI-SHENG
US-2019370625-A1,TOSHIBA MEMORY CORP
US-2019278346-A1,CORRPRO CO INC
US-2019156634-A1,WYMAC GAMING SOLUTIONS PTY LTD
US-2019189294-A1,EUROPEAN SPALLATION SOURCE ERIC
US-2019189294-A1,MIFLER CONSULTING KFT
US-2019361208-A1,SEIKO EPSON CORP
US-2019146513-A1,KUBOTA KK
US-2019240122-A1,NATURA COSMETICOS SA
US-2019237797-A1,SAMSUNG SDI CO LTD
US-2021219627-A1,BRIZAY MACHA
US-2020156909-A1,SHIJIAZHUANG NURON BRAKE TECH CO LTD
US-2019172610-A1,SUMITOMO ELECTRIC INDUSTRIES
US-2020179906-A1,UNIV FUZHOU
US-2019320367-A1,ERICSSON TELEFON AB L M
US-2019365512-A1,KONINKLIJKE PHILIPS NV
US-2020040810-A1,MAZDA MOTOR
US-2020063085-A1,UNIV ARIZONA
US-2019262825-A1,KIMBERLY CLARK CO
US-2019262825-A1,UNIV ILLINOIS
US-2020295406-A1,MEDTRONIC INC
US-2020311734-A1,AMERICAN EXPRESS TRAVEL RELATED SERVICES CO INC
US-2019307948-A1,LEVY FRANK
US-2019307948-A1,LEVY KIMBERLEY
US-2020004364-A1,SAMSUNG DISPLAY CO LTD
US-2019293875-A1,TELESCENT INC
US-2019319476-A1,SHENZHEN XGEAR TECH CO LTD
US-2019236670-A1,BOEMI ANDREW A
US-2019236670-A1,SNYDER JOHN L
US-2019236670-A1,VOGELBERGER PETER C
US-2019322036-A1,IO TECH GROUP LTD
US-2020334774-A1,CAPITAL ONE SERVICES LLC
US-2019332731-A1,ALIBABA GROUP HOLDING LTD
US-2019324130-A1,KOITO MFG CO LTD
US-2020070883-A1,CITIC DICASTAL CO LTD
US-2020079767-A1,VITAE PHARMACEUTICALS LLC
US-2019328740-A1,UNIV CALIFORNIA
US-2020348923-A1,FORD GLOBAL TECH LLC
US-2020004235-A1,DISNEY ENTPR INC
US-2019360681-A1,Focused Innovation Group LLC
US-2019364081-A1,DISNEY ENTPR INC
US-2019278249-A1,INOVATECH ENG CORPORATION
US-2019296159-A1,SHINETSU CHEMICAL CO
US-2019355117-A1,UNIV COLUMBIA
US-2019287354-A1,PANASONIC IP MAN CO LTD
US-2019291222-A1,RATTUNDE AG
US-2019294624-A1,TOSHIBA KK
US-2019294624-A1,TOSHIBA DIGITAL SOLUTIONS CORP
US-2019390139-A1,VERSUM MAT US LLC
US-2019312662-A1,FUTUREWEI TECHNOLOGIES INC
US-2020014162-A1,CONNECTEURS ELECTRIQUES DEUTSCH
US-2019388150-A1,AVAVA INC
US-2019324472-A1,LG ELECTRONICS INC
US-2020412453-A1,ROLLS ROYCE CORP
US-2020412453-A1,ROLLS ROYCE NAM TECH INC
US-2021116345-A1,THOMPSON JERRY J
US-2019322088-A1,EXXONMOBIL CHEMICA
Query:
-- Query 6: Get assignee names for publications in CPC class 'A01B3'
SELECT DISTINCT a.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value:"code"::STRING LIKE 'A01B3%'
LIMIT 1000;
Answer:
assignee_name
KIM JAE KEUN
KUHN SA
TRECKER FRANCIS J
WANG XUEDONG
GERBER HUBERT
JIM ALEX SMITH
LEMKEN GMBH & CO KG
BOTVID SETTERGREN ANDERS GOSTA
GLASIER HAROLD H
MARTIN DOMINIC R
RICHARD CO
GERBER MAURICE
NIEMEYER SOEHNE STAHL PFLUG
ARWAC LTD
AMAZONEN WERKE DREYER H
UNIV JIANGSU
GUERBET FRANCOIS
ELEOS ROBOTICS INC
WILLIAM HENRY HONY FROST
WALLNER KLAUS
SJOEHOLMS MEKANISKA AB
SOUTHERN PLOW COMPANY
TEXAS INDUSTRIES INC
AMAZONEN-WERKE H DREYER GMBH & CO KG
KIM BYUNG SUB
CAMPBELL CLARENCE L
KORSMEYER ERNEST H
LEINFELDER DIPL-LANDW HERMANN
ARTHUR BROOKS SPURR
CHOATE STOREY NORMAN
SIGFRID ANDERSON ANDERS
ZHANG LIJIN
WILLIAM DREFKE
SHEPPARD RICHARD H
QUINSTAR CORP
DAEHO FARMING MACHINERY CO LTD
CHRISTOPHER H R WOODWARD
SAPHIR MASCHB GMBH
Liu Yueshang
MCKAY RALPH LTD
CHONGQING YUBAO AGRICULTURE EXPL CO LTD
CHONGQING TIANJI IND CO LTD
PREC PLANTING LLC
AUGUST SETTERGREN OTTO GORAN
INT HARVESTER GREAT BRITAIN
BULLS CO LTD
TWOSE OF TIVERTON LTD
HUBEI SHUANGYU MACHINERY TECH CO LTD
KUBOTA KK
FISHER VAN E
SALGE HENRY F
KIM JONG JIN
HUBER FRANZ FERDINAND
UNIV HEILONGJIANG SCI & TECH
LEIJENAAR SYTZE
CNH IND AMERICA LLC
UNIV CHUNG ANG IND
WALTER ROWAN JAMES
SAMSUNG SDI CO LTD
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY
CHRISTEN ARNE JENSEN
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC
CHO SUNG GU
MARTIN CHARLES H
LG ELECTRONICS INC
NEW ZEALAND INVENTIONS DEV
HARRELL DANNY H
RUDOLPH HASSON PAUL
HOLGER LETH
LIM HEON HO
LELY NV C VAN DER
DEERE & CO
SAMSUNG KWANGJU ELECTRONICS CO
DAIYO TANGO CO LTD
GEORGE A KELLY PLOW COMPANY
OTULAK PRZEMYSLAW PRO CNC
PATENT CONCERN NV
UNIV TONGJI
EDMOND HEE
EDWARDS JOHN W
EMPR IMPORT EXPORT Y DISTRIB P
CARLUCCI JAMES J
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD
ALLEN SAMUEL L
AGSOILWORKS TECH COMPANY LLC
UNIV SYDNEY
BETEK GMBH & CO KG
Query:
-- Query 7: Count applications per assignee in CPC class 'A01B3'
SELECT a.value:"name"::STRING AS "assignee_name", COUNT(DISTINCT t."publication_number") AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c,
     LATERAL FLATTEN(input => t."assignee_harmonized") a
WHERE c.value:"code"::STRING LIKE 'A01B3%'
GROUP BY "assignee_name"
ORDER BY "application_count" DESC
LIMIT 1000;
Answer:
assignee_name,application_count
LELY NV C VAN DER,5
DEERE & CO,4
AMAZONEN WERKE DREYER H,2
BOTVID SETTERGREN ANDERS GOSTA,1
KUHN SA,1
MARTIN DOMINIC R,1
SAMSUNG SDI CO LTD,1
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,1
PREC PLANTING LLC,1
LEMKEN GMBH & CO KG,1
WILLIAM DREFKE,1
ZHANG LIJIN,1
SIGFRID ANDERSON ANDERS,1
GEORGE A KELLY PLOW COMPANY,1
LG ELECTRONICS INC,1
NEW ZEALAND INVENTIONS DEV,1
QUINSTAR CORP,1
DAEHO FARMING MACHINERY CO LTD,1
SOUTHERN PLOW COMPANY,1
TEXAS INDUSTRIES INC,1
KIM BYUNG SUB,1
SHEPPARD RICHARD H,1
AMAZONEN-WERKE H DREYER GMBH & CO KG,1
MARTIN CHARLES H,1
KIM JAE KEUN,1
EDWARDS JOHN W,1
WILLIAM HENRY HONY FROST,1
SJOEHOLMS MEKANISKA AB,1
ELEOS ROBOTICS INC,1
FISHER VAN E,1
KUBOTA KK,1
DAIYO TANGO CO LTD,1
SAMSUNG KWANGJU ELECTRONICS CO,1
GLASIER HAROLD H,1
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,1
CHRISTEN ARNE JENSEN,1
CHO SUNG GU,1
GERBER HUBERT,1
WANG XUEDONG,1
AUGUST SETTERGREN OTTO GORAN,1
CNH IND AMERICA LLC,1
LEIJENAAR SYTZE,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,1
AGSOILWORKS TECH COMPANY LLC,1
ALLEN SAMUEL L,1
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,1
MCKAY RALPH LTD,1
OTULAK PRZEMYSLAW PRO CNC,1
PATENT CONCERN NV,1
UNIV TONGJI,1
HUBER FRANZ FERDINAND,1
UNIV HEILONGJIANG SCI & TECH,1
Liu Yueshang,1
SAPHIR MASCHB GMBH,1
EDMOND HEE,1
GUERBET FRANCOIS,1
RICHARD CO,1
CHOATE STOREY NORMAN,1
LEINFELDER DIPL-LANDW HERMANN,1
KORSMEYER ERNEST H,1
ARTHUR BROOKS SPURR,1
CHONGQING TIANJI IND CO LTD,1
UNIV CHUNG ANG IND,1
WALTER ROWAN JAMES,1
HUBEI SHUANGYU MACHINERY TECH CO LTD,1
TWOSE OF TIVERTON LTD,1
INT HARVESTER GREAT BRITAIN,1
BULLS CO LTD,1
RUDOLPH HASSON PAUL,1
UNIV JIANGSU,1
ARWAC LTD,1
NIEMEYER SOEHNE STAHL PFLUG,1
SALGE HENRY F,1
KIM JONG JIN,1
CARLUCCI JAMES J,1
EMPR IMPORT EXPORT Y DISTRIB P,1
HOLGER LETH,1
LIM HEON HO,1
BETEK GMBH & CO KG,1
UNIV SYDNEY,1
GERBER MAURICE,1
CAMPBELL CLARENCE L,1
WALLNER KLAUS,1
CHRISTOPHER H R WOODWARD,1
TRECKER FRANCIS J,1
JIM ALEX SMITH,1
HARRELL DANNY H,1
Query:
SELECT t."publication_number", t."filing_date",
          TO_CHAR(TO_DATE(t."filing_date"::STRING, 'YYYYMMDD'), 'YYYY') AS "filing_year"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   WHERE t."filing_date" > 19000101  -- Assuming dates are after January 1, 1900
     AND LENGTH(t."filing_date"::STRING) = 8
   LIMIT 1000;
Answer:
Too long, hard cut:
publication_number,filing_date,filing_year
CN-213876397-U,20210119,2021
CN-214833400-U,20210119,2021
CN-214066419-U,20210120,2021
CN-214244054-U,20210120,2021
CN-214294023-U,20210120,2021
CN-214995710-U,20210120,2021
CN-214682489-U,20210121,2021
CN-214413421-U,20210121,2021
CN-214974752-U,20210121,2021
CN-214196462-U,20210121,2021
CN-214386227-U,20210122,2021
CN-214477141-U,20210122,2021
CN-214391350-U,20210902,2021
CN-215025685-U,20210122,2021
CN-214362850-U,20210125,2021
CN-215876011-U,20210122,2021
CN-214549176-U,20210125,2021
CN-214552811-U,20210125,2021
CN-214121216-U,20210125,2021
CN-215903984-U,20210126,2021
CN-214202449-U,20210125,2021
CN-214613168-U,20210125,2021
CN-213907201-U,20210126,2021
CN-214573933-U,20210126,2021
CN-213876513-U,20210127,2021
CN-214522965-U,20210127,2021
CN-214801320-U,20210125,2021
CN-214686114-U,20210127,2021
CN-214171464-U,20210127,2021
CN-214357762-U,20210127,2021
CN-214742053-U,20210127,2021
CN-213955243-U,20210128,2021
CN-214278147-U,20210128,2021
CN-214844909-U,20210128,2021
CN-214666458-U,20210128,2021
CN-214842776-U,20210128,2021
CN-214575708-U,20210128,2021
CN-215082240-U,20210128,2021
CN-214202692-U,20210130,2021
CN-214878864-U,20210130,2021
CN-214041949-U,20210130,2021
CN-215159870-U,20210130,2021
CN-214549984-U,20210130,2021
CN-215643409-U,20210201,2021
CN-214649580-U,20210201,2021
CN-214914572-U,20210201,2021
CN-215794173-U,20210129,2021
CN-214496842-U,20210201,2021
CN-215914717-U,20210201,2021
CN-214517024-U,20210201,2021
CN-214572413-U,20210201,2021
CN-214715286-U,20210202,2021
CN-214983050-U,20210202,2021
CN-214200705-U,20210202,2021
CN-214984951-U,20210202,2021
CN-214173170-U,20210202,2021
CN-215383847-U,20210202,2021
CN-214675809-U,20210203,2021
CN-214357173-U,20210203,2021
CN-215751125-U,20210203,2021
CN-215130215-U,20210203,2021
CN-214363393-U,20210204,2021
CN-214575072-U,20210204,2021
CN-214562366-U,20210204,2021
CN-215624340-U,20210204,2021
CN-214306968-U,20210204,2021
CN-214682433-U,20210205,2021
CN-214659071-U,20210205,2021
CN-214348851-U,20210205,2021
CN-215152539-U,20210205,2021
CN-214226644-U,20210207,2021
CN-214955175-U,20210205,2021
CN-214730823-U,20210207,2021
CN-214826107-U,20210205,2021
CN-215082866-U,20210205,2021
CN-215185519-U,20210205,2021
CN-214274011-U,20210207,2021
CN-214204421-U,20210207,2021
CN-214278490-U,20210207,2021
CN-214880082-U,20210208,2021
CN-215408439-U,20210207,2021
CN-214898449-U,20210208,2021
CN-215247418-U,20210209,2021
CN-215083502-U,20210218,2021
CN-214494539-U,20210219,2021
CN-215280361-U,20210220,2021
CN-214040622-U,20210221,2021
CN-213231849-U,20210222,2021
CN-214992561-U,20210222,2021
CN-214479603-U,20210223,2021
CN-214592931-U,20210223,2021
CN-214198349-U,20210223,2021
CN-214633866-U,20210223,2021
CN-215244489-U,20210223,2021
CN-215225252-U,20210224,2021
CN-215242675-U,20210223,2021
CN-215362744-U,20210224,2021
CN-214816893-U,20210225,2021
CN-214575906-U,20210225,2021
CN-214608409-U,20210226,2021
CN-214316794-U,20210226,2021
CN-214644542-U,20210226,2021
CN-214389146-U,20210301,2021
CN-215059600-U,20210301,2021
CN-214804098-U,20210301,2021
CN-214763449-U,20210301,2021
CN-214536674-U,20210301,2021
CN-214147606-U,20210302,2021
CN-214617553-U,20210302,2021
CN-214337023-U,20210302,2021
CN-214379854-U,20210302,2021
CN-214512518-U,20210303,2021
CN-214608869-U,20210304,2021
CN-214692106-U,20210303,2021
CN-215652174-U,20210304,2021
CN-214993944-U,20210303,2021
CN-214436335-U,20210304,2021
CN-214583280-U,20210308,2021
CN-214387007-U,20210307,2021
CN-214774083-U,20210306,2021
CN-214405646-U,20210305,2021
CN-214381782-U,20210308,2021
CN-214748932-U,20210306,2021
CN-215127650-U,20210308,2021
CN-214760436-U,20210308,2021
CN-214457762-U,20210306,2021
CN-214572592-U,20210305,2021
CN-214555757-U,20210309,2021
CN-214509295-U,20210309,2021
CN-214969035-U,20210309,2021
CN-214693650-U,20210310,2021
CN-214960404-U,20210310,2021
CN-214377762-U,20210310,2021
CN-214482590-U,20210311,2021
CN-215297031-U,20210312,2021
CN-214646628-U,20210312,2021
CN-214397066-U,20210311,2021
CN-215274309-U,20210313,2021
CN-214535333-U,20210313,2021
CN-215361093-U,20210313,2021
CN-214700732-U,20210315,2021
CN-214601146-U,20210315,2021
CN-215028665-U,20210316,2021
CN-214502357-U,20210316,2021
CN-214893139-U,20210315,2021
CN-215008204-U,20210315,2021
CN-215123062-U,20210316,2021
CN-214516831-U,20210316,2021
CN-214649153-U,20210316,2021
CN-214829540-U,20210317,2021
CN-214750133-U,20210317,2021
CN-218625958-U,20210317,2021
CN-214642763-U,20210317,2021
CN-215130687-U,20210316,2021
CN-214647899-U,20210318,2021
CN-214381800-U,20210318,2021
CN-214956910-U,20210318,2021
CN-214916416-U,20210318,2021
CN-215615927-U,20210318,2021
CN-213375840-U,20210319,2021
CN-215155549-U,20210319,2021
CN-214580863-U,20210320,2021
CN-214482019-U,20210320,2021
CN-214700498-U,20210322,2021
CN-215781521-U,20210322,2021
CN-215015329-U,20210322,2021
CN-215273587-U,20210323,2021
CN-216091492-U,20220122,2022
CN-216963330-U,20210323,2021
CN-214373004-U,20210323,2021
CN-214492826-U,20210323,202
Query:
-- Corrected Query 9: Count applications per year in CPC class 'A01B3' with valid filing dates
SELECT TO_CHAR(TRY_TO_DATE(t."filing_date"::STRING, 'YYYYMMDD'), 'YYYY') AS "filing_year",
       COUNT(DISTINCT t."publication_number") AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value:"code"::STRING LIKE 'A01B3%'
  AND TRY_TO_DATE(t."filing_date"::STRING, 'YYYYMMDD') IS NOT NULL
GROUP BY "filing_year"
ORDER BY "filing_year"
LIMIT 1000
Answer:
filing_year,application_count
1901,1
1904,1
1912,1
1913,1
1918,2
1920,1
1925,1
1926,2
1931,1
1934,2
1935,1
1947,1
1948,1
1950,2
1951,1
1954,1
1955,1
1956,1
1960,2
1967,1
1969,1
1973,1
1974,2
1975,3
1976,1
1978,1
1979,3
1980,1
1981,2
1982,2
1983,1
1985,1
1987,2
1991,2
1993,2
1996,3
1997,1
2000,3
2001,1
2002,1
2004,3
2005,1
2006,1
2009,1
2010,1
2011,1
2012,3
2013,1
2015,3
2016,4
2017,8
2018,6
2019,5
2020,2
2021,2
2022,5
2023,1
Query:
-- Corrected Query 10: Get country codes for applications in CPC class 'A01B3' excluding null country codes
SELECT t."country_code",
       COUNT(DISTINCT t."publication_number") AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") c
WHERE c.value:"code"::STRING LIKE 'A01B3%'
  AND t."country_code" IS NOT NULL
GROUP BY t."country_code"
ORDER BY "application_count" DESC
LIMIT 1000
Answer:
country_code,application_count
US,36
KR,18
CN,17
GB,7
DE,7
CA,5
FR,4
BE,4
AU,3
IT,3
JP,3
NO,2
NL,2
EP,2
RU,1
IL,1
PL,1
ZA,1
AT,1
HU,1
End Exploring Related Columns
Task: For patent class A01B3, I want to analyze the information of the top 3 assignees based on the total number of applications. Please provide the following five pieces of information: the name of this assignee,  total number of applications, the year with the most applications, the number of applications in that year, and the country code with the most applications during that year.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: I'm sorry, but I don't have access to the database to provide the specific information requested. Without the actual data, I cannot generate the names of the top 3 assignees for patent class A01B3 and their associated application statistics..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-20 01:05:54 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 01:05:54 - root - INFO - ```sql
WITH cpc_applications AS (
    SELECT
        t."publication_number",
        t."filing_date",
        t."country_code",
        a.value:"name"::STRING AS "assignee_name",
        TO_CHAR(TRY_TO_DATE(t."filing_date"::STRING, 'YYYYMMDD'), 'YYYY') AS "filing_year"
    FROM
        PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE
        c.value:"code"::STRING LIKE 'A01B3%'
        AND a.value:"name"::STRING IS NOT NULL
        AND t."filing_date" IS NOT NULL
),
assignee_totals AS (
    SELECT
        "assignee_name",
        COUNT(DISTINCT "publication_number") AS "total_number_of_applications"
    FROM
        cpc_applications
    GROUP BY
        "assignee_name"
),
top_assignees AS (
    SELECT
        "assignee_name",
        "total_number_of_applications"
    FROM
        assignee_totals
    ORDER BY
        "total_number_of_applications" DESC NULLS LAST
    LIMIT 3
),
assignee_years AS (
    SELECT
        cpc_applications."assignee_name",
        cpc_applications."filing_year",
        COUNT(DISTINCT cpc_applications."publication_number") AS "applications_in_year"
    FROM
        cpc_applications
    INNER JOIN
        top_assignees ON cpc_applications."assignee_name" = top_assignees."assignee_name"
    GROUP BY
        cpc_applications."assignee_name",
        cpc_applications."filing_year"
),
max_year_per_assignee AS (
    SELECT
        "assignee_name",
        "filing_year",
        "applications_in_year",
        RANK() OVER (
            PARTITION BY "assignee_name"
            ORDER BY "applications_in_year" DESC NULLS LAST, "filing_year"
        ) AS rank
    FROM
        assignee_years
),
top_year_per_assignee AS (
    SELECT
        "assignee_name",
        "filing_year",
        "applications_in_year" AS "number_of_applications_in_that_year"
    FROM
        max_year_per_assignee
    WHERE
        rank = 1
),
country_counts AS (
    SELECT
        cpc_applications."assignee_name",
        cpc_applications."filing_year",
        cpc_applications."country_code",
        COUNT(DISTINCT cpc_applications."publication_number") AS "application_count"
    FROM
        cpc_applications
    INNER JOIN
        top_year_per_assignee ON cpc_applications."assignee_name" = top_year_per_assignee."assignee_name"
                              AND cpc_applications."filing_year" = top_year_per_assignee."filing_year"
    GROUP BY
        cpc_applications."assignee_name",
        cpc_applications."filing_year",
        cpc_applications."country_code"
),
max_country_per_assignee AS (
    SELECT
        "assignee_name",
        "filing_year",
        "country_code",
        "application_count",
        RANK() OVER (
            PARTITION BY "assignee_name", "filing_year"
            ORDER BY "application_count" DESC NULLS LAST, "country_code"
        ) AS rank
    FROM
        country_counts
),
top_country_per_assignee AS (
    SELECT
        "assignee_name",
        "filing_year",
        "country_code" AS "country_code_with_most_applications_during_that_year"
    FROM
        max_country_per_assignee
    WHERE
        rank = 1
)
SELECT
    ta."assignee_name" AS "name_of_assignee",
    ta."total_number_of_applications",
    tyy."filing_year" AS "year_with_most_applications",
    tyy."number_of_applications_in_that_year",
    tcpa."country_code_with_most_applications_during_that_year"
FROM
    top_assignees ta
INNER JOIN
    top_year_per_assignee tyy ON ta."assignee_name" = tyy."assignee_name"
INNER JOIN
    top_country_per_assignee tcpa ON tyy."assignee_name" = tcpa."assignee_name"
                                 AND tyy."filing_year" = tcpa."filing_year"
ORDER BY
    ta."total_number_of_applications" DESC NULLS LAST,
    ta."assignee_name";
```
2025-01-20 01:05:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:05:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:05:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:05:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-20 01:05:55 - snowflake.connector.connection - INFO - closed
2025-01-20 01:05:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:05:56 - root - INFO - itercount: 1
2025-01-20 01:05:56 - root - INFO - 0
2025-01-20 01:05:56 - root - INFO - results: 
name_of_assignee,total_number_of_applications,year_with_most_applications,number_of_applications_in_that_year,country_code_with_most_applications_during_that_year
LELY NV C VAN DER,5,1975,1,NL
DEERE & CO,4,1979,1,NL
AMAZONEN WERKE DREYER H,2,1979,2,AT


2025-01-20 01:05:56 - root - INFO - Please check the answer again by reviewing For patent class A01B3, I want to analyze the information of the top 3 assignees based on the total number of applications. Please provide the following five pieces of information: the name of this assignee,  total number of applications, the year with the most applications, the number of applications in that year, and the country code with the most applications during that year., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: I'm sorry, but I don't have access to the database to provide the specific information requested. Without the actual data, I cannot generate the names of the top 3 assignees for patent class A01B3 and their associated application statistics. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
name_of_assignee,total_number_of_applications,year_with_most_applications,number_of_applications_in_that_year,country_code_with_most_applications_during_that_year
LELY NV C VAN DER,5,1975,1,NL
DEERE & CO,4,1979,1,NL
AMAZONEN WERKE DREYER H,2,1979,2,AT
Current sql:
WITH cpc_applications AS (
    SELECT
        t."publication_number",
        t."filing_date",
        t."country_code",
        a.value:"name"::STRING AS "assignee_name",
        TO_CHAR(TRY_TO_DATE(t."filing_date"::STRING, 'YYYYMMDD'), 'YYYY') AS "filing_year"
    FROM
        PATENTS.PATENTS.PUBLICATIONS t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE
        c.value:"code"::STRING LIKE 'A01B3%'
        AND a.value:"name"::STRING IS NOT NULL
        AND t."filing_date" IS NOT NULL
),
assignee_totals AS (
    SELECT
        "assignee_name",
        COUNT(DISTINCT "publication_number") AS "total_number_of_applications"
    FROM
        cpc_applications
    GROUP BY
        "assignee_name"
),
top_assignees AS (
    SELECT
        "assignee_name",
        "total_number_of_applications"
    FROM
        assignee_totals
    ORDER BY
        "total_number_of_applications" DESC NULLS LAST
    LIMIT 3
),
assignee_years AS (
    SELECT
        cpc_applications."assignee_name",
        cpc_applications."filing_year",
        COUNT(DISTINCT cpc_applications."publication_number") AS "applications_in_year"
    FROM
        cpc_applications
    INNER JOIN
        top_assignees ON cpc_applications."assignee_name" = top_assignees."assignee_name"
    GROUP BY
        cpc_applications."assignee_name",
        cpc_applications."filing_year"
),
max_year_per_assignee AS (
    SELECT
        "assignee_name",
        "filing_year",
        "applications_in_year",
        RANK() OVER (
            PARTITION BY "assignee_name"
            ORDER BY "applications_in_year" DESC NULLS LAST, "filing_year"
        ) AS rank
    FROM
        assignee_years
),
top_year_per_assignee AS (
    SELECT
        "assignee_name",
        "filing_year",
        "applications_in_year" AS "number_of_applications_in_that_year"
    FROM
        max_year_per_assignee
    WHERE
        rank = 1
),
country_counts AS (
    SELECT
        cpc_applications."assignee_name",
        cpc_applications."filing_year",
        cpc_applications."country_code",
        COUNT(DISTINCT cpc_applications."publication_number") AS "application_count"
    FROM
        cpc_applications
    INNER JOIN
        top_year_per_assignee ON cpc_applications."assignee_name" = top_year_per_assignee."assignee_name"
                              AND cpc_applications."filing_year" = top_year_per_assignee."filing_year"
    GROUP BY
        cpc_applications."assignee_name",
        cpc_applications."filing_year",
        cpc_applications."country_code"
),
max_country_per_assignee AS (
    SELECT
        "assignee_name",
        "filing_year",
        "country_code",
        "application_count",
        RANK() OVER (
            PARTITION BY "assignee_name", "filing_year"
            ORDER BY "application_count" DESC NULLS LAST, "country_code"
        ) AS rank
    FROM
        country_counts
),
top_country_per_assignee AS (
    SELECT
        "assignee_name",
        "filing_year",
        "country_code" AS "country_code_with_most_applications_during_that_year"
    FROM
        max_country_per_assignee
    WHERE
        rank = 1
)
SELECT
    ta."assignee_name" AS "name_of_assignee",
    ta."total_number_of_applications",
    tyy."filing_year" AS "year_with_most_applications",
    tyy."number_of_applications_in_that_year",
    tcpa."country_code_with_most_applications_during_that_year"
FROM
    top_assignees ta
INNER JOIN
    top_year_per_assignee tyy ON ta."assignee_name" = tyy."assignee_name"
INNER JOIN
    top_country_per_assignee tcpa ON tyy."assignee_name" = tcpa."assignee_name"
                                 AND tyy."filing_year" = tcpa."filing_year"
ORDER BY
    ta."total_number_of_applications" DESC NULLS LAST,
    ta."assignee_name";
2025-01-20 01:06:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 01:06:39 - root - INFO - ```sql
WITH cpc_applications AS (
    SELECT
        t."publication_number",
        t."filing_date",
        t."country_code",
        a.value:"name"::STRING AS "assignee_name",
        TO_CHAR(TRY_TO_DATE(t."filing_date"::STRING, 'YYYYMMDD'), 'YYYY') AS "filing_year"
    FROM
        "PATENTS"."PATENTS"."PUBLICATIONS" t,
        LATERAL FLATTEN(input => t."cpc") c,
        LATERAL FLATTEN(input => t."assignee_harmonized") a
    WHERE
        c.value:"code"::STRING LIKE 'A01B3%'
        AND a.value:"name"::STRING IS NOT NULL
        AND t."filing_date" IS NOT NULL
),
assignee_totals AS (
    SELECT
        "assignee_name",
        COUNT(DISTINCT "publication_number") AS "total_number_of_applications"
    FROM
        cpc_applications
    GROUP BY
        "assignee_name"
),
top_assignees AS (
    SELECT
        "assignee_name",
        "total_number_of_applications"
    FROM
        assignee_totals
    ORDER BY
        "total_number_of_applications" DESC NULLS LAST,
        "assignee_name"
    LIMIT 3
),
assignee_years AS (
    SELECT
        cpc_applications."assignee_name",
        cpc_applications."filing_year",
        COUNT(DISTINCT cpc_applications."publication_number") AS "applications_in_year"
    FROM
        cpc_applications
    INNER JOIN
        top_assignees ON cpc_applications."assignee_name" = top_assignees."assignee_name"
    GROUP BY
        cpc_applications."assignee_name",
        cpc_applications."filing_year"
),
max_year_per_assignee AS (
    SELECT
        "assignee_name",
        "filing_year",
        "applications_in_year",
        RANK() OVER (
            PARTITION BY "assignee_name"
            ORDER BY "applications_in_year" DESC NULLS LAST,
                     "filing_year"
        ) AS rank
    FROM
        assignee_years
),
top_year_per_assignee AS (
    SELECT
        "assignee_name",
        "filing_year",
        "applications_in_year" AS "number_of_applications_in_that_year"
    FROM
        max_year_per_assignee
    WHERE
        rank = 1
),
country_counts AS (
    SELECT
        cpc_applications."assignee_name",
        cpc_applications."filing_year",
        cpc_applications."country_code",
        COUNT(DISTINCT cpc_applications."publication_number") AS "application_count"
    FROM
        cpc_applications
    INNER JOIN
        top_year_per_assignee ON cpc_applications."assignee_name" = top_year_per_assignee."assignee_name"
                              AND cpc_applications."filing_year" = top_year_per_assignee."filing_year"
    GROUP BY
        cpc_applications."assignee_name",
        cpc_applications."filing_year",
        cpc_applications."country_code"
),
max_country_per_assignee AS (
    SELECT
        "assignee_name",
        "filing_year",
        "country_code",
        "application_count",
        RANK() OVER (
            PARTITION BY "assignee_name", "filing_year"
            ORDER BY "application_count" DESC NULLS LAST,
                     "country_code"
        ) AS rank
    FROM
        country_counts
),
top_country_per_assignee AS (
    SELECT
        "assignee_name",
        "filing_year",
        "country_code" AS "country_code_with_most_applications_during_that_year"
    FROM
        max_country_per_assignee
    WHERE
        rank = 1
)
SELECT
    ta."assignee_name" AS "name_of_assignee",
    ta."total_number_of_applications",
    tyy."filing_year" AS "year_with_most_applications",
    tyy."number_of_applications_in_that_year",
    tcpa."country_code_with_most_applications_during_that_year"
FROM
    top_assignees ta
INNER JOIN
    top_year_per_assignee tyy ON ta."assignee_name" = tyy."assignee_name"
INNER JOIN
    top_country_per_assignee tcpa ON tyy."assignee_name" = tcpa."assignee_name"
                                 AND tyy."filing_year" = tcpa."filing_year"
ORDER BY
    ta."total_number_of_applications" DESC NULLS LAST,
    ta."assignee_name";
```
2025-01-20 01:06:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-20 01:06:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 01:06:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 01:06:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-20 01:06:41 - snowflake.connector.connection - INFO - closed
2025-01-20 01:06:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 01:06:42 - root - INFO - itercount: 2
2025-01-20 01:06:42 - root - INFO - 0
2025-01-20 01:06:42 - root - INFO - Total iteration counts: 2
