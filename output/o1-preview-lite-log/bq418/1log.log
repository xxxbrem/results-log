2025-01-26 20:33:32 - openai._base_client - INFO - Retrying request to /chat/completions in 0.380344 seconds
2025-01-26 20:35:11 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:35:13 - root - INFO - SQL:
SELECT DISTINCT drugName
   FROM `isb-cgc-bq.targetome_versioned.interactions_v1`
   LIMIT 100;
Results:
drugName
Pamidronate Disodium
Gemtuzumab Ozogamicin
Ibritumomab Tiuxetan
Rolapitant Hydrochloride
Uridine Triacetate
Venetoclax
Ondansetron Hydrochloride
Palonosetron Hydrochloride
Aprepitant
Defibrotide Sodium
Romiplostim
Eltrombopag Olamine
Imiquimod
Raloxifene Hydrochloride
Lanreotide Acetate
Prednisone
Mechlorethamine Hydrochloride
Chlorambucil
Cyclophosphamide
Melphalan Hydrochloride
Ifosfamide
Bendamustine Hydrochloride
Busulfan
Thiotepa
Lomustine
Carmustine
Dacarbazine
Temozolomide
Pemetrexed Disodium
Pralatrexate
Mercaptopurine
Thioguanine
Fludarabine Phosphate
Clofarabine
Nelarabine
Fluorouracil
Cytarabine
Gemcitabine Hydrochloride
Capecitabine
Azacitidine
Decitabine
Vincristine Sulfate
Vinblastine Sulfate
Vinorelbine Tartrate
Etoposide
Paclitaxel
Docetaxel
Cabazitaxel
Trabectedin
Dactinomycin
Doxorubicin Hydrochloride
Daunorubicin Hydrochloride
Mitoxantrone Hydrochloride
Idarubicin Hydrochloride
Epirubicin Hydrochloride
Bleomycin
Mitomycin C
Ixabepilone
Cisplatin
Carboplatin
Oxaliplatin
Procarbazine Hydrochloride
Rituximab
Trastuzumab
Cetuximab
Bevacizumab
Panitumumab
Ofatumumab
Ipilimumab
Brentuximab Vedotin
Pertuzumab
Obinutuzumab
Ramucirumab
Pembrolizumab
Blinatumomab
Nivolumab
Daratumumab
Necitumumab
Elotuzumab
Aminolevulinic Acid
Imatinib Mesylate
Gefitinib
Erlotinib Hydrochloride
Sorafenib Tosylate
Sunitinib Malate
Dasatinib
Lapatinib Ditosylate
Temsirolimus
Nilotinib
Pazopanib Hydrochloride
Vandetanib
Vemurafenib
Crizotinib
Ruxolitinib Phosphate
Axitinib
Bosutinib
Regorafenib
Ponatinib Hydrochloride
Dabrafenib
Trametinib

2025-01-26 20:35:15 - root - INFO - SQL:
SELECT DISTINCT synonym
   FROM `isb-cgc-bq.targetome_versioned.drug_synonyms_v1`
   WHERE LOWER(synonym) LIKE '%sorafenib%'
   LIMIT 100;
Results:
synonym
sorafenib tosylate
Sorafenib Tosylate
sorafenib
SORAFENIB TOSYLATE
Sorafenib
SORAFENIB

2025-01-26 20:35:16 - root - INFO - SQL:
SELECT DISTINCT drugID
   FROM `isb-cgc-bq.targetome_versioned.drug_synonyms_v1`
   WHERE LOWER(synonym) = 'sorafenib'
   LIMIT 100;
Results:
drugID
157

2025-01-26 20:36:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:36:14 - root - INFO - ```sql
SELECT DISTINCT e.expID, e.exp_assayValueMedian, e.exp_assayValueLow, e.exp_assayValueHigh
FROM `isb-cgc-bq.targetome_versioned.experiments_v1` e
JOIN `isb-cgc-bq.targetome_versioned.interactions_v1` i ON e.expID = i.expID
WHERE LOWER(i.drugName) LIKE '%sorafenib%'
  AND e.exp_assayValueMedian <= 100
LIMIT 100;
```
2025-01-26 20:38:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:38:22 - root - INFO - SQL:
SELECT DISTINCT e.expID, e.exp_assayValueMedian, e.exp_assayValueLow, e.exp_assayValueHigh
FROM `isb-cgc-bq.targetome_versioned.experiments_v1` e
JOIN `isb-cgc-bq.targetome_versioned.interactions_v1` i ON e.expID = i.expID
WHERE LOWER(i.drugName) LIKE '%sorafenib%'
  AND e.exp_assayValueMedian <= 100
LIMIT 100;
Results:
expID,exp_assayValueMedian,exp_assayValueLow,exp_assayValueHigh
1591,7.0,,
1700,16.0,,
3983,41.0,,
4016,93.0,,
4069,20.0,,
1809,6.3,,
1822,13.0,,
1853,95.0,,
4773,62.0,,
4775,37.0,,
4788,13.0,,
4829,2.7,,
4839,31.0,,
4857,68.0,,
4869,59.0,,
2008,22.0,,
2105,20.0,,
2136,18.0,,
2171,7.4,,
2264,25.0,,
2431,39.0,,
2440,82.0,,
2545,17.0,,
2682,30.0,,
2784,95.0,,
2913,79.0,,
2956,13.0,,
3167,16.0,,
3246,4.5,,
3354,93.0,,
3389,31.0,,
3395,82.0,,
3410,48.0,,
3426,16.0,,
3485,31.0,,
3516,44.0,,
3524,68.0,,
3563,54.0,,
3566,39.0,,
3638,16.0,,
3657,7.4,,
3663,59.0,,
3664,13.0,,
3678,3.0,,
3694,25.0,,
3695,24.0,,
3716,79.0,,
3736,16.0,,
3871,33.0,,
4206,1.5,,
4215,6.6,,

2025-01-26 20:39:20 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:39:20 - root - INFO - ```sql
SELECT DISTINCT e.expID, e.exp_assayValueMedian,
       COALESCE(e.exp_assayValueLow, e.exp_assayValueMedian) AS exp_assayValueLow,
       COALESCE(e.exp_assayValueHigh, e.exp_assayValueMedian) AS exp_assayValueHigh
FROM `isb-cgc-bq.targetome_versioned.experiments_v1` e
JOIN `isb-cgc-bq.targetome_versioned.interactions_v1` i ON e.expID = i.expID
WHERE LOWER(i.drugName) LIKE '%sorafenib%'
  AND e.exp_assayValueMedian <= 100
  AND (e.exp_assayValueLow <= 100 OR e.exp_assayValueLow IS NULL)
  AND (e.exp_assayValueHigh <= 100 OR e.exp_assayValueHigh IS NULL)
LIMIT 100;
```
2025-01-26 20:41:42 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:41:42 - root - INFO - SQL:
SELECT DISTINCT e.expID, e.exp_assayValueMedian,
       COALESCE(e.exp_assayValueLow, e.exp_assayValueMedian) AS exp_assayValueLow,
       COALESCE(e.exp_assayValueHigh, e.exp_assayValueMedian) AS exp_assayValueHigh
FROM `isb-cgc-bq.targetome_versioned.experiments_v1` e
JOIN `isb-cgc-bq.targetome_versioned.interactions_v1` i ON e.expID = i.expID
WHERE LOWER(i.drugName) LIKE '%sorafenib%'
  AND e.exp_assayValueMedian <= 100
  AND (e.exp_assayValueLow <= 100 OR e.exp_assayValueLow IS NULL)
  AND (e.exp_assayValueHigh <= 100 OR e.exp_assayValueHigh IS NULL)
LIMIT 100;
Results:
expID,exp_assayValueMedian,exp_assayValueLow,exp_assayValueHigh
1591,7.0,7.0,7.0
1700,16.0,16.0,16.0
3983,41.0,41.0,41.0
4016,93.0,93.0,93.0
4069,20.0,20.0,20.0
1809,6.3,6.3,6.3
1822,13.0,13.0,13.0
1853,95.0,95.0,95.0
4773,62.0,62.0,62.0
4775,37.0,37.0,37.0
4788,13.0,13.0,13.0
4829,2.7,2.7,2.7
4839,31.0,31.0,31.0
4857,68.0,68.0,68.0
4869,59.0,59.0,59.0
2008,22.0,22.0,22.0
2105,20.0,20.0,20.0
2136,18.0,18.0,18.0
2171,7.4,7.4,7.4
2264,25.0,25.0,25.0
2431,39.0,39.0,39.0
2440,82.0,82.0,82.0
2545,17.0,17.0,17.0
2682,30.0,30.0,30.0
2784,95.0,95.0,95.0
2913,79.0,79.0,79.0
2956,13.0,13.0,13.0
3167,16.0,16.0,16.0
3246,4.5,4.5,4.5
3354,93.0,93.0,93.0
3389,31.0,31.0,31.0
3395,82.0,82.0,82.0
3410,48.0,48.0,48.0
3426,16.0,16.0,16.0
3485,31.0,31.0,31.0
3516,44.0,44.0,44.0
3524,68.0,68.0,68.0
3563,54.0,54.0,54.0
3566,39.0,39.0,39.0
3638,16.0,16.0,16.0
3657,7.4,7.4,7.4
3663,59.0,59.0,59.0
3664,13.0,13.0,13.0
3678,3.0,3.0,3.0
3694,25.0,25.0,25.0
3695,24.0,24.0,24.0
3716,79.0,79.0,79.0
3736,16.0,16.0,16.0
3871,33.0,33.0,33.0
4206,1.5,1.5,1.5
4215,6.6,6.6,6.6

2025-01-26 20:41:43 - root - INFO - SQL:
-- Corrected Query 2
SELECT DISTINCT p.uniprot_id, p.stable_id
FROM `isb-cgc-bq.reactome_versioned.physical_entity_v77` p
WHERE p.uniprot_id IN (
  SELECT DISTINCT i.target_uniprotID
  FROM `isb-cgc-bq.targetome_versioned.interactions_v1` i
  WHERE LOWER(i.drugName) LIKE '%sorafenib%'
    AND LOWER(i.targetSpecies) LIKE '%homo sapiens%'
    AND i.target_uniprotID IS NOT NULL
)
LIMIT 100
Results:
uniprot_id,stable_id
P04049,R-HSA-109786
Q02750,R-HSA-109837
P27361,R-HSA-109842
P36507,R-HSA-109848
P28482,R-HSA-109853
P23458,R-HSA-1112543
P29597,R-HSA-1112598
Q16566,R-HSA-111902
P17612,R-HSA-111936
P22694,R-HSA-111937
Q16566,R-HSA-112280
Q02750,R-HSA-112339
P28482,R-HSA-112354
P27361,R-HSA-112359
Q02750,R-HSA-112374
O96017,R-HSA-113824
O96017,R-HSA-113825
O14757,R-HSA-113826
P11802,R-HSA-113830
O14757,R-HSA-113838
P11802,R-HSA-113843
P00533,R-HSA-1169417
P00533,R-HSA-1169418
P00533,R-HSA-1173211
P00533,R-HSA-1173212
P00533,R-HSA-1177528
P00533,R-HSA-1177530
P00533,R-HSA-1177531
P00533,R-HSA-1177532
P00533,R-HSA-1177541
P00533,R-HSA-1177542
P00533,R-HSA-1181211
P00533,R-HSA-1181214
P00533,R-HSA-1181386
P00533,R-HSA-1181399
P00533,R-HSA-1182984
P00533,R-HSA-1182985
P00533,R-HSA-1214162
P00533,R-HSA-1228010
P00533,R-HSA-1228012
P00533,R-HSA-1228015
P00533,R-HSA-1228016
P00533,R-HSA-1228025
P00533,R-HSA-1228031
P00533,R-HSA-1228034
P00533,R-HSA-1228037
P00533,R-HSA-1228038
P00533,R-HSA-1228039
P00533,R-HSA-1228040
P00533,R-HSA-1228041
P00533,R-HSA-1228042
P00533,R-HSA-1228044
P00533,R-HSA-1248649
P04626,R-HSA-1248698
Q13627,R-HSA-1362267
P06213,R-HSA-141718
P06213,R-HSA-141719
P06213,R-HSA-141722
P16591,R-HSA-1433364
P10721,R-HSA-1433492
P42679,R-HSA-1433581
P10721,R-HSA-1472116
P31749,R-HSA-1500573
P42336,R-HSA-1500691
P42336,R-HSA-1500695
P42336,R-HSA-1500701
P42336,R-HSA-1500705
P42336,R-HSA-1500706
P42336,R-HSA-1500709
P42336,R-HSA-1500714
P42336,R-HSA-1500716
P42336,R-HSA-1500718
P42336,R-HSA-1500719
P42336,R-HSA-1500720
P17252,R-HSA-156469
P30291,R-HSA-156491
P30291,R-HSA-156694
P53350,R-HSA-156720
P24941,R-HSA-157440
Q99640,R-HSA-157457
P80370,R-HSA-1604447
Q9UBF8,R-HSA-1604615
O00750,R-HSA-1604619
Q8TBX8,R-HSA-1604638
P11362,R-HSA-1614373
P11362,R-HSA-1614377
P22607,R-HSA-1614387
P22607,R-HSA-1614390
P22607,R-HSA-1614394
P22607,R-HSA-1614398
P22607,R-HSA-1614400
P22607,R-HSA-1614402
P22607,R-HSA-1614406
P22607,R-HSA-1614410

2025-01-26 20:41:46 - root - INFO - SQL:
-- Corrected Query 3
SELECT DISTINCT pp.pathway_stable_id
FROM `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp
WHERE pp.pe_stable_id IN (
  SELECT DISTINCT pe.stable_id
  FROM `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe
  WHERE pe.uniprot_id IN (
    SELECT DISTINCT i.target_uniprotID
    FROM `isb-cgc-bq.targetome_versioned.interactions_v1` i
    WHERE LOWER(i.drugName) LIKE '%sorafenib%'
      AND LOWER(i.targetSpecies) LIKE '%homo sapiens%'
      AND i.target_uniprotID IS NOT NULL
  )
)
  AND LOWER(pp.evidence_code) = 'tas'
LIMIT 100
Results:
pathway_stable_id
R-HSA-68875
R-HSA-68877
R-HSA-68881
R-HSA-68882
R-HSA-68884
R-HSA-68886
R-HSA-68911
R-HSA-68949
R-HSA-68962
R-HSA-69002
R-HSA-69017
R-HSA-69052
R-HSA-69200
R-HSA-69202
R-HSA-69206
R-HSA-69231
R-HSA-69236
R-HSA-69239
R-HSA-69242
R-HSA-69273
R-HSA-69275
R-HSA-69278
R-HSA-69306
R-HSA-69416
R-HSA-69473
R-HSA-69478
R-HSA-69481
R-HSA-69541
R-HSA-69563
R-HSA-69580
R-HSA-69601
R-HSA-69610
R-HSA-69613
R-HSA-69615
R-HSA-69618
R-HSA-69620
R-HSA-69656
R-HSA-70221
R-HSA-71387
R-HSA-72086
R-HSA-72163
R-HSA-72172
R-HSA-72203
R-HSA-72312
R-HSA-73728
R-HSA-73762
R-HSA-73772
R-HSA-73776
R-HSA-73779
R-HSA-73854
R-HSA-73857
R-HSA-73863
R-HSA-73864
R-HSA-73886
R-HSA-73887
R-HSA-73894
R-HSA-74160
R-HSA-74713
R-HSA-74749
R-HSA-74751
R-HSA-74752
R-HSA-75035
R-HSA-75153
R-HSA-75815
R-HSA-75892
R-HSA-75893
R-HSA-75953
R-HSA-75955
R-HSA-76002
R-HSA-76005
R-HSA-76009
R-HSA-76042
R-HSA-77075
R-HSA-77387
R-HSA-109581
R-HSA-109582
R-HSA-109606
R-HSA-109704
R-HSA-110056
R-HSA-111446
R-HSA-111458
R-HSA-111461
R-HSA-111465
R-HSA-111471
R-HSA-111885
R-HSA-111931
R-HSA-111932
R-HSA-111933
R-HSA-111995
R-HSA-111996
R-HSA-111997
R-HSA-112040
R-HSA-112043
R-HSA-112310
R-HSA-112314
R-HSA-112315
R-HSA-112316
R-HSA-112382
R-HSA-112399
R-HSA-112409

2025-01-26 20:41:48 - root - INFO - SQL:
-- Corrected Query 4
SELECT DISTINCT p.stable_id, p.name
FROM `isb-cgc-bq.reactome_versioned.pathway_v77` p
WHERE p.stable_id IN (
  SELECT DISTINCT pp.pathway_stable_id
  FROM `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp
  WHERE LOWER(pp.evidence_code) = 'tas'
    AND pp.pe_stable_id IN (
      SELECT DISTINCT pe.stable_id
      FROM `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe
      WHERE pe.uniprot_id IN (
        SELECT DISTINCT i.target_uniprotID
        FROM `isb-cgc-bq.targetome_versioned.interactions_v1` i
        WHERE LOWER(i.drugName) LIKE '%sorafenib%'
          AND LOWER(i.targetSpecies) LIKE '%homo sapiens%'
          AND i.target_uniprotID IS NOT NULL
      )
    )
)
  AND p.lowest_level = TRUE
  AND LOWER(p.species) LIKE '%homo sapiens%'
LIMIT 100
Results:
stable_id,name
R-HSA-5250924,B-WICH complex positively regulates rRNA expression
R-HSA-8854521,Interaction between PHLDA1 and AURKA
R-HSA-9702636,tandutinib-resistant FLT3 mutants
R-HSA-202424,Downstream TCR signaling
R-HSA-437239,Recycling pathway of L1
R-HSA-139910,Activation of BMF and translocation to mitochondria
R-HSA-9022692,Regulation of MECP2 expression and activity
R-HSA-5603027,IKBKG deficiency causes anhidrotic ectodermal dysplasia with immunodeficiency (EDA-ID) (via TLR)
R-HSA-5603037,IRAK4 deficiency (TLR5)
R-HSA-9014325,"TICAM1,TRAF6-dependent induction of TAK1 complex"
R-HSA-6785631,ERBB2 Regulates Cell Motility
R-HSA-8849469,PTK6 Regulates RTKs and Their Effectors AKT1 and DOK1
R-HSA-180292,GAB1 signalosome
R-HSA-8852405,Signaling by MST1
R-HSA-381340,Transcriptional regulation of white adipocyte differentiation
R-HSA-5689880,Ub-specific processing proteases
R-HSA-445144,Signal transduction by L1
R-HSA-9702620,quizartinib-resistant FLT3 mutants
R-HSA-918233,TRAF3-dependent IRF activation pathway
R-HSA-5685938,HDR through Single Strand Annealing (SSA)
R-HSA-8849471,"PTK6 Regulates RHO GTPases, RAS GTPase and MAP kinases"
R-HSA-5690714,CD22 mediated BCR regulation
R-HSA-2871796,FCERI mediated MAPK activation
R-HSA-389359,CD28 dependent Vav1 pathway
R-HSA-1810476,RIP-mediated NFkB activation via ZBP1
R-HSA-216083,Integrin cell surface interactions
R-HSA-3642279,TGFBR2 MSI Frameshift Mutants in Cancer
R-HSA-9665251,Resistance of ERBB2 KD mutants to lapatinib
R-HSA-8853334,Signaling by FGFR3 fusions in cancer
R-HSA-2514859,"Inactivation, recovery and regulation of the phototransduction cascade"
R-HSA-167590,Nef Mediated CD4 Down-regulation
R-HSA-1236974,ER-Phagosome pathway
R-HSA-9604323,Negative regulation of NOTCH4 signaling
R-HSA-2565942,Regulation of PLK1 Activity at G2/M Transition
R-HSA-9013418,RHOBTB2 GTPase cycle
R-HSA-9634638,Estrogen-dependent nuclear events downstream of ESR-membrane signaling
R-HSA-9616222,Transcriptional regulation of granulopoiesis
R-HSA-6783783,Interleukin-10 signaling
R-HSA-8941858,Regulation of RUNX3 expression and activity
R-HSA-114604,GPVI-mediated activation cascade
R-HSA-9603381,Activated NTRK3 signals through PI3K
R-HSA-2730905,Role of LAT2/NTAL/LAB on calcium mobilization
R-HSA-2871809,FCERI mediated Ca+2 mobilization
R-HSA-200425,Carnitine metabolism
R-HSA-6806942,MET Receptor Activation
R-HSA-3645790,TGFBR2 Kinase Domain Mutants in Cancer
R-HSA-416550,Sema4D mediated inhibition of cell attachment and migration
R-HSA-114516,Disinhibition of SNARE formation
R-HSA-9702577,semaxanib-resistant FLT3 mutants
R-HSA-5358751,S45 mutants of beta-catenin aren't phosphorylated
R-HSA-5578768,Physiological factors
R-HSA-180336,SHC1 events in EGFR signaling
R-HSA-8854050,FBXL7 down-regulates AURKA during mitotic entry and in early mitosis
R-HSA-9662834,CD163 mediating an anti-inflammatory response
R-HSA-70221,Glycogen breakdown (glycogenolysis)
R-HSA-6804760,Regulation of TP53 Activity through Methylation
R-HSA-9665737,Drug resistance in ERBB2 TMD/JMD mutants
R-HSA-69601,Ubiquitin Mediated Degradation of Phosphorylated Cdc25A
R-HSA-5579030,Defective CYP19A1 causes AEXS
R-HSA-6804114,TP53 Regulates Transcription of Genes Involved in G2 Cell Cycle Arrest
R-HSA-195399,VEGF binds to VEGFR leading to receptor dimerization
R-HSA-1266695,Interleukin-7 signaling

2025-01-26 20:41:50 - root - INFO - SQL:
-- Corrected Query 5
SELECT pp.pathway_stable_id, COUNT(DISTINCT i.targetID) AS target_count
FROM `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp
JOIN `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe ON pp.pe_stable_id = pe.stable_id
JOIN `isb-cgc-bq.targetome_versioned.interactions_v1` i ON pe.uniprot_id = i.target_uniprotID
WHERE LOWER(i.drugName) LIKE '%sorafenib%'
  AND LOWER(i.targetSpecies) LIKE '%homo sapiens%'
  AND LOWER(pp.evidence_code) = 'tas'
GROUP BY pp.pathway_stable_id
LIMIT 100
Results:
pathway_stable_id,target_count
R-HSA-68875,6
R-HSA-68877,13
R-HSA-68881,1
R-HSA-68882,3
R-HSA-68884,1
R-HSA-68886,15
R-HSA-68911,1
R-HSA-68949,1
R-HSA-68962,1
R-HSA-69002,1
R-HSA-69017,1
R-HSA-69052,1
R-HSA-69200,1
R-HSA-69202,8
R-HSA-69206,8
R-HSA-69231,7
R-HSA-69236,7
R-HSA-69239,1
R-HSA-69242,8
R-HSA-69273,5
R-HSA-69275,13
R-HSA-69278,31
R-HSA-69306,1
R-HSA-69416,1
R-HSA-69473,3
R-HSA-69478,2
R-HSA-69481,5
R-HSA-69541,1
R-HSA-69563,2
R-HSA-69580,2
R-HSA-69601,2
R-HSA-69610,2
R-HSA-69613,2
R-HSA-69615,3
R-HSA-69618,3
R-HSA-69620,8
R-HSA-69656,8
R-HSA-70221,2
R-HSA-71387,2
R-HSA-72086,1
R-HSA-72163,1
R-HSA-72172,1
R-HSA-72203,1
R-HSA-72312,5
R-HSA-73728,1
R-HSA-73762,1
R-HSA-73772,1
R-HSA-73776,1
R-HSA-73779,1
R-HSA-73854,2
R-HSA-73857,42
R-HSA-73863,1
R-HSA-73864,2
R-HSA-73886,1
R-HSA-73887,8
R-HSA-73894,6
R-HSA-74160,44
R-HSA-74713,1
R-HSA-74749,3
R-HSA-74751,9
R-HSA-74752,9
R-HSA-75035,2
R-HSA-75153,7
R-HSA-75815,1
R-HSA-75892,2
R-HSA-75893,4
R-HSA-75953,1
R-HSA-75955,2
R-HSA-76002,21
R-HSA-76005,1
R-HSA-76009,6
R-HSA-76042,1
R-HSA-77075,1
R-HSA-77387,1
R-HSA-109581,11
R-HSA-109582,29
R-HSA-109606,3
R-HSA-109704,6
R-HSA-110056,5
R-HSA-111446,1
R-HSA-111458,2
R-HSA-111461,2
R-HSA-111465,7
R-HSA-111471,2
R-HSA-111885,9
R-HSA-111931,2
R-HSA-111932,3
R-HSA-111933,7
R-HSA-111995,1
R-HSA-111996,8
R-HSA-111997,7

2025-01-26 20:41:53 - root - INFO - SQL:
-- Corrected Query 6
SELECT pathway_stable_id, 
       COUNT(DISTINCT CASE WHEN is_target THEN target_uniprotID END) AS target_count,
       COUNT(DISTINCT CASE WHEN NOT is_target THEN target_uniprotID END) AS non_target_count
FROM (
  SELECT pp.pathway_stable_id, pe.uniprot_id AS target_uniprotID,
         pe.uniprot_id IN (
           SELECT DISTINCT i.target_uniprotID
           FROM `isb-cgc-bq.targetome_versioned.interactions_v1` i
           WHERE LOWER(i.drugName) LIKE '%sorafenib%'
             AND LOWER(i.targetSpecies) LIKE '%homo sapiens%'
             AND i.target_uniprotID IS NOT NULL
         ) AS is_target
  FROM `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp
  JOIN `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe ON pp.pe_stable_id = pe.stable_id
  WHERE LOWER(pp.evidence_code) = 'tas'
)
GROUP BY pathway_stable_id
LIMIT 100
Results:
pathway_stable_id,target_count,non_target_count
R-HSA-15869,0,99
R-HSA-68616,0,6
R-HSA-68827,0,59
R-HSA-68867,0,68
R-HSA-68875,6,107
R-HSA-68877,13,190
R-HSA-68882,3,229
R-HSA-68884,1,12
R-HSA-68886,15,375
R-HSA-68911,1,4
R-HSA-68949,1,70
R-HSA-68952,0,8
R-HSA-68962,1,32
R-HSA-69002,1,84
R-HSA-69017,1,72
R-HSA-69052,1,90
R-HSA-69091,0,14
R-HSA-69109,0,14
R-HSA-69166,0,14
R-HSA-69183,0,15
R-HSA-69186,0,20
R-HSA-69190,0,24
R-HSA-69200,1,3
R-HSA-69202,8,75
R-HSA-69205,0,24
R-HSA-69206,8,118
R-HSA-69231,7,40
R-HSA-69236,7,40
R-HSA-69239,1,118
R-HSA-69242,8,152
R-HSA-69273,5,20
R-HSA-69275,13,185
R-HSA-69278,31,501
R-HSA-69306,1,127
R-HSA-69416,1,10
R-HSA-69473,3,75
R-HSA-69478,2,3
R-HSA-69481,5,146
R-HSA-69541,1,56
R-HSA-69560,0,4
R-HSA-69563,2,64
R-HSA-69580,2,64
R-HSA-69601,2,50
R-HSA-69610,2,50
R-HSA-69613,2,50
R-HSA-69615,3,65
R-HSA-69618,3,108
R-HSA-69620,8,267
R-HSA-69656,8,77
R-HSA-69895,0,4
R-HSA-70171,0,69
R-HSA-70221,2,12
R-HSA-70263,0,34
R-HSA-70268,0,29
R-HSA-70326,0,89
R-HSA-70350,0,5
R-HSA-70370,0,5
R-HSA-70635,0,10
R-HSA-70688,0,3
R-HSA-70895,0,20
R-HSA-70921,0,8
R-HSA-71032,0,5
R-HSA-71064,0,12
R-HSA-71240,0,11

2025-01-26 20:41:55 - root - INFO - SQL:
-- Corrected Query 7
SELECT pathway_stable_id, COUNT(DISTINCT target_uniprotID) AS target_count
FROM (
  SELECT pp.pathway_stable_id, i.target_uniprotID
  FROM `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp
  JOIN `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe ON pp.pe_stable_id = pe.stable_id
  JOIN `isb-cgc-bq.targetome_versioned.interactions_v1` i ON pe.uniprot_id = i.target_uniprotID
  WHERE LOWER(i.drugName) LIKE '%sorafenib%'
    AND LOWER(i.targetSpecies) LIKE '%homo sapiens%'
    AND LOWER(pp.evidence_code) = 'tas'
)
GROUP BY pathway_stable_id
ORDER BY target_count DESC
LIMIT 100 OFFSET 3
Results:
pathway_stable_id,target_count
R-HSA-9006934,68
R-HSA-1266738,61
R-HSA-168249,60
R-HSA-1280215,57
R-HSA-422475,54
R-HSA-9675108,54
R-HSA-5663202,49
R-HSA-449147,46
R-HSA-74160,44
R-HSA-5683057,43
R-HSA-212436,42
R-HSA-5663205,42
R-HSA-73857,42
R-HSA-9716542,41
R-HSA-194315,41
R-HSA-9006925,41
R-HSA-372790,37
R-HSA-388396,36
R-HSA-5684996,35
R-HSA-5673001,34
R-HSA-1640170,33
R-HSA-1257604,33
R-HSA-1430728,31
R-HSA-69278,31
R-HSA-8953897,31
R-HSA-2262752,31
R-HSA-3700989,31
R-HSA-166016,29
R-HSA-109582,29
R-HSA-168898,29
R-HSA-194138,28
R-HSA-1280218,28
R-HSA-5633007,27
R-HSA-166058,26
R-HSA-4420097,26
R-HSA-168179,26
R-HSA-199418,26
R-HSA-168188,26
R-HSA-9012999,26
R-HSA-181438,26
R-HSA-168164,25
R-HSA-166166,25
R-HSA-937061,25
R-HSA-975155,24
R-HSA-975871,24
R-HSA-556833,24
R-HSA-975138,24
R-HSA-6811558,24
R-HSA-168142,24
R-HSA-168176,24
R-HSA-168181,24
R-HSA-168138,24
R-HSA-2454202,23
R-HSA-2559583,23
R-HSA-195258,23
R-HSA-450294,22
R-HSA-2219528,22
R-HSA-448424,22
R-HSA-2682334,22
R-HSA-76002,21
R-HSA-166520,19
R-HSA-6804756,19
R-HSA-416476,18
R-HSA-9658195,18
R-HSA-2559580,18
R-HSA-2029480,17
R-HSA-112316,17
R-HSA-187037,16
R-HSA-112315,16
R-HSA-3928665,16
R-HSA-68886,15
R-HSA-6802949,15
R-HSA-202403,15
R-HSA-6802946,15
R-HSA-9013149,15
R-HSA-5621481,15
R-HSA-6802957,15
R-HSA-6802955,15
R-HSA-9649948,15
R-HSA-112314,15
R-HSA-1483257,14
R-HSA-9656223,14
R-HSA-388841,14
R-HSA-2219530,14
R-HSA-442755,14
R-HSA-6802952,14
R-HSA-1227986,14
R-HSA-453274,13

2025-01-26 20:42:43 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:42:43 - root - INFO - ```sql
SELECT pathway_stable_id, COUNT(DISTINCT target_uniprotID) AS target_count
FROM (
  SELECT pp.pathway_stable_id, i.target_uniprotID
  FROM `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp
  JOIN `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe ON pp.pe_stable_id = pe.stable_id
  JOIN `isb-cgc-bq.targetome_versioned.interactions_v1` i ON pe.uniprot_id = i.target_uniprotID
  WHERE LOWER(i.drugName) LIKE '%sorafenib%'
)
GROUP BY pathway_stable_id
ORDER BY target_count DESC
LIMIT 100;
```
2025-01-26 20:43:34 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:43:34 - root - INFO - SQL:
SELECT pathway_stable_id, COUNT(DISTINCT target_uniprotID) AS target_count
FROM (
  SELECT pp.pathway_stable_id, i.target_uniprotID
  FROM `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp
  JOIN `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe ON pp.pe_stable_id = pe.stable_id
  JOIN `isb-cgc-bq.targetome_versioned.interactions_v1` i ON pe.uniprot_id = i.target_uniprotID
  WHERE LOWER(i.drugName) LIKE '%sorafenib%'
)
GROUP BY pathway_stable_id
ORDER BY target_count DESC
LIMIT 100;
Results:
pathway_stable_id,target_count
R-HSA-162582,175
R-HSA-1643685,85
R-HSA-168256,84
R-HSA-1266738,74
R-HSA-9006934,70
R-HSA-9675108,63
R-HSA-422475,63
R-HSA-168249,61
R-HSA-1280215,58
R-HSA-212436,53
R-HSA-73857,53
R-HSA-74160,53
R-HSA-5663202,49
R-HSA-9006925,48
R-HSA-449147,47
R-HSA-5663205,44
R-HSA-9716542,43
R-HSA-5683057,43
R-HSA-194315,43
R-HSA-372790,42
R-HSA-388396,41
R-HSA-8953897,37
R-HSA-2262752,37
R-HSA-5684996,35
R-HSA-1257604,35
R-HSA-1640170,34
R-HSA-5673001,34
R-HSA-109582,33
R-HSA-1430728,32
R-HSA-69278,32
R-HSA-3700989,31
R-HSA-166016,30
R-HSA-168898,30
R-HSA-1280218,29
R-HSA-194138,28
R-HSA-9012999,27
R-HSA-168188,27
R-HSA-166058,27
R-HSA-168179,27
R-HSA-5633007,27
R-HSA-181438,27
R-HSA-937061,26
R-HSA-168164,26
R-HSA-199418,26
R-HSA-556833,26
R-HSA-166166,26
R-HSA-4420097,26
R-HSA-168181,25
R-HSA-168142,25
R-HSA-168138,25
R-HSA-975871,25
R-HSA-168176,25
R-HSA-975155,25
R-HSA-975138,25
R-HSA-6811558,24
R-HSA-2454202,24
R-HSA-112316,24
R-HSA-195258,24
R-HSA-2682334,24
R-HSA-112315,23
R-HSA-2559583,23
R-HSA-450294,23
R-HSA-166520,23
R-HSA-112314,23
R-HSA-448424,23
R-HSA-2219528,22
R-HSA-442755,22
R-HSA-187037,21
R-HSA-438064,21
R-HSA-76002,21
R-HSA-6804756,19
R-HSA-9658195,19
R-HSA-5357801,18
R-HSA-109581,18
R-HSA-2559580,18
R-HSA-416476,18
R-HSA-2029480,17
R-HSA-418594,16
R-HSA-3928665,16
R-HSA-9013149,15
R-HSA-6802957,15
R-HSA-6802955,15
R-HSA-68886,15
R-HSA-202403,15
R-HSA-6802949,15
R-HSA-195721,15
R-HSA-6802946,15
R-HSA-373760,15

2025-01-26 20:43:36 - root - INFO - SQL:
-- Corrected Query 9
SELECT DISTINCT pe.uniprot_id
FROM `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe
JOIN `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp ON pe.stable_id = pp.pe_stable_id
WHERE pp.pathway_stable_id IN (
  -- Replace with actual Top 3 pathways based on highest target counts or chi-squared statistics
  'R-HSA-69278', 'R-HSA-74160', 'R-HSA-73857'
)
  AND pe.uniprot_id NOT IN (
    SELECT DISTINCT i.target_uniprotID
    FROM `isb-cgc-bq.targetome_versioned.interactions_v1` i
    WHERE LOWER(i.drugName) LIKE '%sorafenib%'
      AND LOWER(i.targetSpecies) LIKE '%homo sapiens%'
      AND i.target_uniprotID IS NOT NULL
  )
LIMIT 100
Results:
uniprot_id
P14635
Q8NFH3
O43929
O60763
P49736
Q09028
Q96GY3
P33993
Q9BPX3
Q9Y248
P20248
Q15021
Q96HA1
Q9BTX1
P06493
P37198
P55735
Q92621
Q9BVL2-1
Q15003
Q96GX5
Q9BRX5
P67775
O75419
O95347
Q5SRE5
Q92973
Q08379
Q13415
P33992
Q8WYP5
P06400
P25205
Q66LE6
P30154
Q14186
Q9BQQ3
Q9UJA3
Q9BW27
P52948-5
Q14691
Q9H0U4
O43913
P57740
P04183
Q52LA3
Q5TKA1
Q6MZP7
P62826
Q01094
O95067
P78396
P56211
Q15329
Q9BRT9
O43768
P24385
P30153
P33991
Q13547
Q8NFH4
Q9NTJ3
O75694
Q13416
Q14188
Q14566
Q14974
Q16254
Q8N1F7
Q96EE3-1
P28749
Q8NFH5
Q9BVL2-2
P62714
P62820
Q7Z3B4
Q9UBD5
Q8WUM0
Q9Y5N6
P10244
Q12769
Q08999
A8MYZ6
O00487
O75909
P0CG48
P0DP23
P10070
P12643
P28066
P49721
Q14469
Q8WVF2
Q99436
Q9HCE1
P51608-2
P52747
P56179
P63165
Q13224

2025-01-26 20:44:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:44:29 - root - INFO - ```sql
-- Corrected Query 10
SELECT 'Within Top 3 Pathways' AS GroupLabel,
       SUM(CASE WHEN is_target THEN 1 ELSE 0 END) AS Target_Count,
       SUM(CASE WHEN NOT is_target THEN 1 ELSE 0 END) AS Non_Target_Count
FROM (
  SELECT pe.uniprot_id,
         pe.uniprot_id IN (
           SELECT DISTINCT i.target_uniprotID
           FROM `isb-cgc-bq.targetome_versioned.interactions_v1` i
           WHERE LOWER(i.drugName) LIKE '%sorafenib%'
             AND LOWER(i.targetSpecies) LIKE '%homo sapiens%'
             AND i.target_uniprotID IS NOT NULL
         ) AS is_target
  FROM `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe
  JOIN `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp ON pe.stable_id = pp.pe_stable_id
  WHERE pp.pathway_stable_id IN (
    'R-HSA-69278', 'R-HSA-74160', 'R-HSA-73857'
  )
)
UNION ALL
SELECT 'Outside Top 3 Pathways' AS GroupLabel,
       SUM(CASE WHEN is_target THEN 1 ELSE 0 END) AS Target_Count,
       SUM(CASE WHEN NOT is_target THEN 1 ELSE 0 END) AS Non_Target_Count
FROM (
  SELECT pe.uniprot_id,
         pe.uniprot_id IN (
           SELECT DISTINCT i.target_uniprotID
           FROM `isb-cgc-bq.targetome_versioned.interactions_v1` i
           WHERE LOWER(i.drugName) LIKE '%sorafenib%'
             AND LOWER(i.targetSpecies) LIKE '%homo sapiens%'
             AND i.target_uniprotID IS NOT NULL
         ) AS is_target
  FROM `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe
  JOIN `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp ON pe.stable_id = pp.pe_stable_id
  WHERE pp.pathway_stable_id NOT IN (
    'R-HSA-69278', 'R-HSA-74160', 'R-HSA-73857'
  )
)
LIMIT 100;
```
2025-01-26 20:45:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:45:05 - root - INFO - SQL:
-- Corrected Query 10
SELECT 'Within Top 3 Pathways' AS GroupLabel,
       SUM(CASE WHEN is_target THEN 1 ELSE 0 END) AS Target_Count,
       SUM(CASE WHEN NOT is_target THEN 1 ELSE 0 END) AS Non_Target_Count
FROM (
  SELECT pe.uniprot_id,
         pe.uniprot_id IN (
           SELECT DISTINCT i.target_uniprotID
           FROM `isb-cgc-bq.targetome_versioned.interactions_v1` i
           WHERE LOWER(i.drugName) LIKE '%sorafenib%'
             AND LOWER(i.targetSpecies) LIKE '%homo sapiens%'
             AND i.target_uniprotID IS NOT NULL
         ) AS is_target
  FROM `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe
  JOIN `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp ON pe.stable_id = pp.pe_stable_id
  WHERE pp.pathway_stable_id IN (
    'R-HSA-69278', 'R-HSA-74160', 'R-HSA-73857'
  )
)
UNION ALL
SELECT 'Outside Top 3 Pathways' AS GroupLabel,
       SUM(CASE WHEN is_target THEN 1 ELSE 0 END) AS Target_Count,
       SUM(CASE WHEN NOT is_target THEN 1 ELSE 0 END) AS Non_Target_Count
FROM (
  SELECT pe.uniprot_id,
         pe.uniprot_id IN (
           SELECT DISTINCT i.target_uniprotID
           FROM `isb-cgc-bq.targetome_versioned.interactions_v1` i
           WHERE LOWER(i.drugName) LIKE '%sorafenib%'
             AND LOWER(i.targetSpecies) LIKE '%homo sapiens%'
             AND i.target_uniprotID IS NOT NULL
         ) AS is_target
  FROM `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe
  JOIN `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp ON pe.stable_id = pp.pe_stable_id
  WHERE pp.pathway_stable_id NOT IN (
    'R-HSA-69278', 'R-HSA-74160', 'R-HSA-73857'
  )
)
LIMIT 100;
Results:
GroupLabel,Target_Count,Non_Target_Count
Within Top 3 Pathways,1597,35935
Outside Top 3 Pathways,121323,1422506

2025-01-26 20:45:05 - root - INFO - itercount: 0
2025-01-26 20:45:05 - root - INFO - Database Name: isb-cgc-bq
Schema Name: reactome_versioned
DDL describes table information.
,0
table_name,pathway_hierarchy_v77
ddl,"CREATE TABLE `isb-cgc-bq.reactome_versioned.pathway_hierarchy_v77`
(
  parent_id STRING OPTIONS(description=""Reactome pathway stable identifier associated with 'child' pathways""),
  child_id STRING OPTIONS(description=""Reactome pathway stable identifier associated with 'parent' pathways"")
)
OPTIONS(
  friendly_name=""REACTOME PATHWAYS HIERARCHY V77 VERSIONED"",
  description=""Reactome pathways parent to child hierarchy downloaded from https://reactome.org/download-data/ on 08/2021 and filtered to only include human pathways (i.e., species = 'Homo sapiens'). This data is part of the version 77 release of Reactome. Additional information and the Creative Commons license agreement can be found here: https://reactome.org/license"",
  labels=[(""access"", ""open""), (""source"", ""reactome""), (""category"", ""reference_database""), (""status"", ""current""), (""data_type"", ""pathway_annotations"")]
);"

,1
table_name,pe_to_pathway_v77
ddl,"CREATE TABLE `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77`
(
  pe_stable_id STRING OPTIONS(description=""Reactome physical entity stable identifier""),
  pathway_stable_id STRING OPTIONS(description=""Reactome pathway stable identifier""),
  evidence_code STRING OPTIONS(description=""Code that indicates the type of evidence supporting physical entity relation to pathway"")
)
OPTIONS(
  friendly_name=""REACTOME PHYSICAL ENTITIES TO PATHWAY MAPPING V77 VERSIONED"",
  description=""External protein, gene, or small molecules mapped to Reactome pathways. This data was downloaded from https://reactome.org/download-data on 8/2021 and filtered to include only human physical entities and pathways. This data is part of the version 77 release of Reactome. Additional information and the Creative Commons license agreement can be found here: https://reactome.org/license"",
  labels=[(""access"", ""open""), (""source"", ""reactome""), (""category"", ""reference_database""), (""status"", ""current""), (""data_type"", ""pathway_annotations"")]
);"

,2
table_name,physical_entity_v77
ddl,"CREATE TABLE `isb-cgc-bq.reactome_versioned.physical_entity_v77`
(
  ensembl_id STRING OPTIONS(description=""Ensembl database identifier""),
  uniprot_id STRING OPTIONS(description=""UniProt database identifier""),
  stable_id STRING OPTIONS(description=""Reactome physical entity stable identifier""),
  name STRING OPTIONS(description=""Reactome physical entity name""),
  location STRING OPTIONS(description=""Reactome physical entity location"")
)
OPTIONS(
  friendly_name=""REACTOME PHYSICAL ENTITIES V77 VERSIONED"",
  description=""External protein, gene, or small molecule identifiers that have been mapped to Reactome physical entities. This data was downloaded from https://reactome.org/download-data on 8/2021 and filtered to include only human physical entities. This data is part of the version 77 release of Reactome. Additional information and the Creative Commons license agreement can be found here: https://reactome.org/license"",
  labels=[(""access"", ""open""), (""source"", ""reactome""), (""category"", ""reference_database""), (""status"", ""current""), (""data_type"", ""pathway_annotations"")]
);"

,3
table_name,pathway_v77
ddl,"CREATE TABLE `isb-cgc-bq.reactome_versioned.pathway_v77`
(
  stable_id STRING OPTIONS(description=""Reactome pathway stable identifier""),
  url STRING OPTIONS(description=""URL to pathway on the Reactome website""),
  name STRING OPTIONS(description=""Reactome pathway name""),
  species STRING OPTIONS(description=""Reactome pathway species""),
  lowest_level BOOL OPTIONS(description=""Indicates if pathway is at the lowest level in the hierarchy, i.e., not a parent"")
)
OPTIONS(
  friendly_name=""REACTOME PATHWAYS V77 VERSIONED"",
  description=""Reactome pathways downloaded from https://reactome.org/download-data/ on 08/2021 and filtered to only include human pathways (i.e., species = 'Homo sapiens'). This data is part of the version 77 release of Reactome. Additional information and the Creative Commons license agreement can be found here: https://reactome.org/license"",
  labels=[(""access"", ""open""), (""source"", ""reactome""), (""category"", ""reference_database""), (""status"", ""current""), (""data_type"", ""pathway_annotations"")]
);"

Database Name: isb-cgc-bq
Schema Name: targetome_versioned
DDL describes table information.
,0
table_name,target_synonyms_v1
ddl,"CREATE TABLE `isb-cgc-bq.targetome_versioned.target_synonyms_v1`
(
  targetID INT64 OPTIONS(description=""ID for Targetome target""),
  synonym STRING OPTIONS(description=""Synonym or alias for Targetome target"")
)
OPTIONS(
  friendly_name=""TARGETOME TARGET SYNONYMS V1 VERSIONED"",
  description=""Synonyms for targets involved in Targetome interactions. More information can be found here: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5759325/. Data was downloaded from the Targetome Git repository (https://github.com/ablucher/The-Cancer-Targetome) in July 2021."",
  labels=[(""access"", ""open""), (""data_type"", ""drug_target_interactions""), (""source"", ""targetome""), (""category"", ""reference_database""), (""status"", ""current"")]
);"

,1
table_name,sources_v1
ddl,"CREATE TABLE `isb-cgc-bq.targetome_versioned.sources_v1`
(
  sourceID INT64 OPTIONS(description=""ID for source supporting Targetome interaction""),
  PubMedID STRING OPTIONS(description=""PubMedID identifying literature""),
  databaseName STRING OPTIONS(description=""Name of database from which supporting evidence and literature are obtained""),
  db_version STRING OPTIONS(description=""Database version""),
  db_downloadURL STRING OPTIONS(description=""URL from which database was downloaded""),
  db_downloadDate STRING OPTIONS(description=""Date on which database was downloaded"")
)
OPTIONS(
  friendly_name=""TARGETOME SOURCES V1 VERSIONED"",
  description=""Targetome literature evidence table, providing support for Targetome interactions. More information can be found here: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5759325/. Data was downloaded from the Targetome Git repository (https://github.com/ablucher/The-Cancer-Targetome) in July 2021."",
  labels=[(""access"", ""open""), (""data_type"", ""drug_target_interactions""), (""source"", ""targetome""), (""category"", ""reference_database""), (""status"", ""current"")]
);"

,2
table_name,interactions_v1
ddl,"CREATE TABLE `isb-cgc-bq.targetome_versioned.interactions_v1`
(
  interactionID INT64 OPTIONS(description=""ID for Targetome drug to target interaction""),
  drugID INT64 OPTIONS(description=""ID of drug involved in interaction""),
  targetID INT64 OPTIONS(description=""ID of target (e.g., protein, DNA, RNA) involved in interaction""),
  interactionType STRING OPTIONS(description=""Type of Targetome interaction, e.g., Antagonist, Inhibition, etc.""),
  drugName STRING OPTIONS(description=""Name of the Targetome drug""),
  drug_approvalDate STRING OPTIONS(description=""Date drug was approved for use""),
  drug_atcClassID STRING OPTIONS(description=""Anatomical Therapeutic Chemical (ATC) drug classification ID""),
  drug_atcClassName STRING OPTIONS(description=""Anatomical Therapeutic Chemical (ATC) drug classification name""),
  drug_atcClassStatus STRING OPTIONS(description=""Anatomical Therapeutic Chemical (ATC) approval status""),
  drug_epcClassID STRING OPTIONS(description=""FDA Established Pharmacologic Class (EPC) drug classification ID""),
  drug_epcClassName STRING OPTIONS(description=""FDA Established Pharmacologic Class (EPC) drug classification name""),
  targetName STRING OPTIONS(description=""Name of Targetome target""),
  targetType STRING OPTIONS(description=""Type of Targetome target (e.g., protein, DNA, or RNA)""),
  target_uniprotID STRING OPTIONS(description=""Uniprot ID of Targetome target""),
  targetSpecies STRING OPTIONS(description=""Species of Targetome target""),
  sourceID INT64 OPTIONS(description=""ID for source supporting Targetome interaction""),
  expID INT64 OPTIONS(description=""ID for experimental evidence supporting Targetome interaction"")
)
OPTIONS(
  friendly_name=""TARGETOME INTERACTIONS V1 VERSIONED"",
  description=""Targetome interactions table linking drugs to targets, supported by experimental or literature evidence. This table is part of a database that aggregates drug-target interaction and bioactivity information for FDA-approved antineoplastic drugs across four publicly available resources. It includes putative target interactions encompassing multiple targets for each antineoplastic drug and introduces a framework for categorizing the supporting evidence behind each drug-target interaction. More information can be found here: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5759325/. Data was downloaded from the Targetome Git repository (https://github.com/ablucher/The-Cancer-Targetome) in July 2021."",
  labels=[(""access"", ""open""), (""data_type"", ""drug_target_interactions""), (""source"", ""targetome""), (""category"", ""reference_database""), (""status"", ""current"")]
);"

,3
table_name,experiments_v1
ddl,"CREATE TABLE `isb-cgc-bq.targetome_versioned.experiments_v1`
(
  expID INT64 OPTIONS(description=""ID for experimental evidence supporting Targetome interactions""),
  exp_assayType STRING OPTIONS(description=""Assay type used for experimental evidence""),
  exp_assayValueLow FLOAT64 OPTIONS(description=""Low value for experimental assay""),
  exp_assayValueMedian FLOAT64 OPTIONS(description=""Median value for experimental assay""),
  exp_assayValueHigh FLOAT64 OPTIONS(description=""High value for experimental assay""),
  exp_assayUnits STRING OPTIONS(description=""Units of measurement for experimental assay""),
  exp_assayRelation STRING OPTIONS(description=""Relation of values for experimental assay""),
  exp_assayDescription STRING OPTIONS(description=""Experimental assay description""),
  exp_assaySpecies STRING OPTIONS(description=""Species used in experimental assay""),
  exp_parentSource STRING OPTIONS(description=""Source from which experimental assay was obtained""),
  sourceID INT64 OPTIONS(description=""ID for source of supporting Targetome evidence""),
  PubMedID STRING OPTIONS(description=""PubMedID identifying literature""),
  databaseName STRING OPTIONS(description=""Name of database from which supporting evidence and literature are obtained""),
  db_version STRING OPTIONS(description=""Database version""),
  db_downloadURL STRING OPTIONS(description=""URL from which database was downloaded""),
  db_downloadDate STRING OPTIONS(description=""Date on which database was downloaded"")
)
OPTIONS(
  friendly_name=""TARGETOME EXPERIMENTAL EVIDENCE V1 VERSIONED"",
  description=""Targetome experimental evidence table, providing experimental support for Targetome interactions. More information can be found here: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5759325/. Data was downloaded from the Targetome Git repository (https://github.com/ablucher/The-Cancer-Targetome) in July 2021."",
  labels=[(""access"", ""open""), (""data_type"", ""drug_target_interactions""), (""source"", ""targetome""), (""category"", ""reference_database""), (""status"", ""current"")]
);"

,4
table_name,drug_synonyms_v1
ddl,"CREATE TABLE `isb-cgc-bq.targetome_versioned.drug_synonyms_v1`
(
  drugID INT64 OPTIONS(description=""Unique ID of the Targetome drug""),
  synonym STRING OPTIONS(description=""Synonym or alias for the Targetome drug"")
)
OPTIONS(
  friendly_name=""TARGETOME DRUG SYNONYMS V1 VERSIONED"",
  description=""Synonyms for drugs involved in Targetome interactions. More information can be found here: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5759325/. Data was downloaded from the Targetome Git repository (https://github.com/ablucher/The-Cancer-Targetome) in July 2021."",
  labels=[(""access"", ""open""), (""data_type"", ""drug_target_interactions""), (""source"", ""targetome""), (""category"", ""reference_database""), (""status"", ""current"")]
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'isb-cgc-bq': {'reactome_versioned': ['pathway_hierarchy_v77', 'pathway_v77', 'pe_to_pathway_v77', 'physical_entity_v77'], 'targetome_versioned': ['drug_synonyms_v1', 'experiments_v1', 'interactions_v1', 'sources_v1', 'target_synonyms_v1']}}
Begin Exploring Related Columns
Here are the relevant tables, columns, and their potential usage for the task:

**Relevant Tables and Columns:**

1. **`interactions_v1`**
   - `drugName`: To identify interactions involving 'sorafenib'.
   - `drugID`: To join with `drug_synonyms_v1` for drug synonyms.
   - `targetID`: To identify target proteins.
   - `target_uniprotID`: To map targets to UniProt IDs.
   - `targetSpecies`: To filter targets with species 'homo sapiens'.
   - `expID`: To join with `experiments_v1` for assay data.

2. **`drug_synonyms_v1`**
   - `drugID`: To join with `interactions_v1`.
   - `synonym`: To find synonyms of 'sorafenib'.

3. **`experiments_v1`**
   - `expID`: To join with `interactions_v1` for assay data.
   - `exp_assayValueMedian`: To apply assay condition (median ≤ 100).
   - `exp_assayValueLow`: Assay values below ≤ 100 or NULL.
   - `exp_assayValueHigh`: Assay values above ≤ 100 or NULL.

4. **`physical_entity_v77`**
   - `uniprot_id`: To map UniProt IDs to Reactome physical entities.
   - `stable_id`: Reactome physical entity stable identifier.

5. **`pe_to_pathway_v77`**
   - `pe_stable_id`: To map physical entities to pathways.
   - `pathway_stable_id`: Reactome pathway stable identifier.
   - `evidence_code`: To filter pathways with evidence code 'TAS'.

6. **`pathway_v77`**
   - `stable_id`: Reactome pathway stable identifier.
   - `name`: Pathway name.
   - `species`: To filter pathways for 'Homo sapiens'.
   - `lowest_level`: To select pathways at the lowest level.

**Conditions that may be used:**

- `interactions_v1.drugName` = 'sorafenib' or `drug_synonyms_v1.synonym` = 'sorafenib'.
- `interactions_v1.targetSpecies` = 'Homo sapiens'.
- `experiments_v1.exp_assayValueMedian` ≤ 100.
- `experiments_v1.exp_assayValueLow` ≤ 100 or NULL.
- `experiments_v1.exp_assayValueHigh` ≤ 100 or NULL.
- `pe_to_pathway_v77.evidence_code` = 'TAS'.
- `pathway_v77.lowest_level` = TRUE.
- `pathway_v77.species` = 'Homo sapiens'.

---

**SQL Queries:**

1. **List distinct drug names in `interactions_v1`.**

   ```sql
   SELECT DISTINCT drugName
   FROM `isb-cgc-bq.targetome_versioned.interactions_v1`
   LIMIT 100;
   ```

2. **Find all synonyms of 'sorafenib' in `drug_synonyms_v1`.**

   ```sql
   SELECT DISTINCT synonym
   FROM `isb-cgc-bq.targetome_versioned.drug_synonyms_v1`
   WHERE LOWER(synonym) LIKE '%sorafenib%'
   LIMIT 100;
   ```

3. **Get `drugID` for 'sorafenib' from `drug_synonyms_v1`.**

   ```sql
   SELECT DISTINCT drugID
   FROM `isb-cgc-bq.targetome_versioned.drug_synonyms_v1`
   WHERE LOWER(synonym) = 'sorafenib'
   LIMIT 100;
   ```

4. **List targets associated with 'sorafenib' from `interactions_v1`.**

   ```sql
   SELECT DISTINCT targetID, targetName, target_uniprotID
   FROM `isb-cgc-bq.targetome_versioned.interactions_v1`
   WHERE LOWER(drugName) = 'sorafenib'
     AND LOWER(targetSpecies) = 'homo sapiens'
   LIMIT 100;
   ```

5. **Retrieve assay data for targets of 'sorafenib' with conditions.**

   ```sql
   SELECT DISTINCT e.expID, e.exp_assayValueMedian, e.exp_assayValueLow, e.exp_assayValueHigh
   FROM `isb-cgc-bq.targetome_versioned.experiments_v1` e
   JOIN `isb-cgc-bq.targetome_versioned.interactions_v1` i ON e.expID = i.expID
   WHERE LOWER(i.drugName) = 'sorafenib'
     AND e.exp_assayValueMedian <= 100
     AND (e.exp_assayValueLow <= 100 OR e.exp_assayValueLow IS NULL)
     AND (e.exp_assayValueHigh <= 100 OR e.exp_assayValueHigh IS NULL)
   LIMIT 100;
   ```

6. **Map target UniProt IDs to Reactome physical entities.**

   ```sql
   SELECT DISTINCT p.uniprot_id, p.stable_id
   FROM `isb-cgc-bq.reactome_versioned.physical_entity_v77` p
   WHERE p.uniprot_id IN (
     SELECT DISTINCT target_uniprotID
     FROM `isb-cgc-bq.targetome_versioned.interactions_v1`
     WHERE LOWER(drugName) = 'sorafenib'
       AND LOWER(targetSpecies) = 'homo sapiens'
   )
   LIMIT 100;
   ```

7. **Find pathways associated with target physical entities (TAS evidence).**

   ```sql
   SELECT DISTINCT pp.pathway_stable_id
   FROM `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp
   WHERE pp.pe_stable_id IN (
     SELECT DISTINCT stable_id
     FROM `isb-cgc-bq.reactome_versioned.physical_entity_v77`
     WHERE uniprot_id IN (
       SELECT DISTINCT target_uniprotID
       FROM `isb-cgc-bq.targetome_versioned.interactions_v1`
       WHERE LOWER(drugName) = 'sorafenib'
         AND LOWER(targetSpecies) = 'homo sapiens'
     )
   )
     AND pp.evidence_code = 'TAS'
   LIMIT 100;
   ```

8. **Get pathway details for pathways at the lowest level.**

   ```sql
   SELECT DISTINCT p.stable_id, p.name
   FROM `isb-cgc-bq.reactome_versioned.pathway_v77` p
   WHERE p.stable_id IN (
     SELECT DISTINCT pathway_stable_id
     FROM `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77`
     WHERE evidence_code = 'TAS'
   )
     AND p.lowest_level = TRUE
     AND LOWER(p.species) = 'homo sapiens'
   LIMIT 100;
   ```

9. **Count the number of targets within each pathway.**

   ```sql
   SELECT pp.pathway_stable_id, COUNT(DISTINCT i.targetID) AS target_count
   FROM `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp
   JOIN `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe ON pp.pe_stable_id = pe.stable_id
   JOIN `isb-cgc-bq.targetome_versioned.interactions_v1` i ON pe.uniprot_id = i.target_uniprotID
   WHERE LOWER(i.drugName) = 'sorafenib'
     AND LOWER(i.targetSpecies) = 'homo sapiens'
     AND pp.evidence_code = 'TAS'
   GROUP BY pp.pathway_stable_id
   LIMIT 100;
   ```

10. **Calculate chi-squared statistics for pathways (simplified example).**

    ```sql
    SELECT pathway_stable_id, 
           COUNT(DISTINCT CASE WHEN is_target THEN target_uniprotID END) AS target_count,
           COUNT(DISTINCT CASE WHEN NOT is_target THEN target_uniprotID END) AS non_target_count
    FROM (
      SELECT pp.pathway_stable_id, i.target_uniprotID, TRUE AS is_target
      FROM `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp
      JOIN `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe ON pp.pe_stable_id = pe.stable_id
      JOIN `isb-cgc-bq.targetome_versioned.interactions_v1` i ON pe.uniprot_id = i.target_uniprotID
      WHERE LOWER(i.drugName) = 'sorafenib'
        AND LOWER(i.targetSpecies) = 'homo sapiens'
        AND pp.evidence_code = 'TAS'
    )
    GROUP BY pathway_stable_id
    LIMIT 100;
    ```

11. **List pathways outside top 3 with target counts.**

    ```sql
    SELECT pathway_stable_id, COUNT(DISTINCT target_uniprotID) AS target_count
    FROM (
      SELECT pp.pathway_stable_id, i.target_uniprotID
      FROM `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp
      JOIN `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe ON pp.pe_stable_id = pe.stable_id
      JOIN `isb-cgc-bq.targetome_versioned.interactions_v1` i ON pe.uniprot_id = i.target_uniprotID
      WHERE LOWER(i.drugName) = 'sorafenib'
        AND LOWER(i.targetSpecies) = 'homo sapiens'
        AND pp.evidence_code = 'TAS'
    )
    GROUP BY pathway_stable_id
    ORDER BY target_count DESC
    LIMIT 100 OFFSET 3;
    ```

12. **Find targets not associated with any pathway.**

    ```sql
    SELECT DISTINCT i.target_uniprotID
    FROM `isb-cgc-bq.targetome_versioned.interactions_v1` i
    WHERE LOWER(i.drugName) = 'sorafenib'
      AND LOWER(i.targetSpecies) = 'homo sapiens'
      AND i.target_uniprotID NOT IN (
        SELECT DISTINCT pe.uniprot_id
        FROM `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe
        JOIN `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp ON pe.stable_id = pp.pe_stable_id
      )
    LIMIT 100;
    ```

13. **List all non-targets within the top 3 pathways.**

    ```sql
    SELECT DISTINCT pe.uniprot_id
    FROM `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe
    JOIN `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp ON pe.stable_id = pp.pe_stable_id
    WHERE pp.pathway_stable_id IN (SELECT pathway_stable_id FROM [Top 3 pathways])
      AND pe.uniprot_id NOT IN (
        SELECT DISTINCT target_uniprotID
        FROM `isb-cgc-bq.targetome_versioned.interactions_v1`
        WHERE LOWER(drugName) = 'sorafenib'
          AND LOWER(targetSpecies) = 'homo sapiens'
      )
    LIMIT 100;
    ```

14. **Get the counts of targets and non-targets in and outside the top 3 pathways.**

    (Note: This query is illustrative; actual calculation of chi-squared statistics requires more steps.)

    ```sql
    SELECT 'Within Top 3 Pathways' AS Group,
           SUM(CASE WHEN is_target THEN 1 ELSE 0 END) AS Target_Count,
           SUM(CASE WHEN NOT is_target THEN 1 ELSE 0 END) AS Non_Target_Count
    FROM (
      SELECT pe.uniprot_id,
             pe.uniprot_id IN (
               SELECT DISTINCT target_uniprotID
               FROM `isb-cgc-bq.targetome_versioned.interactions_v1`
               WHERE LOWER(drugName) = 'sorafenib'
                 AND LOWER(targetSpecies) = 'homo sapiens'
             ) AS is_target
      FROM `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe
      JOIN `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp ON pe.stable_id = pp.pe_stable_id
      WHERE pp.pathway_stable_id IN (SELECT pathway_stable_id FROM [Top 3 pathways])
    )
    UNION ALL
    SELECT 'Outside Top 3 Pathways' AS Group,
           SUM(CASE WHEN is_target THEN 1 ELSE 0 END) AS Target_Count,
           SUM(CASE WHEN NOT is_target THEN 1 ELSE 0 END) AS Non_Target_Count
    FROM (
      SELECT pe.uniprot_id,
             pe.uniprot_id IN (
               SELECT DISTINCT target_uniprotID
               FROM `isb-cgc-bq.targetome_versioned.interactions_v1`
               WHERE LOWER(drugName) = 'sorafenib'
                 AND LOWER(targetSpecies) = 'homo sapiens'
             ) AS is_target
      FROM `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe
      JOIN `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp ON pe.stable_id = pp.pe_stable_id
      WHERE pp.pathway_stable_id NOT IN (SELECT pathway_stable_id FROM [Top 3 pathways])
    )
    LIMIT 100;
    ```

---

These queries progressively explore the data from identifying 'sorafenib' and its associated targets, applying assay conditions, mapping targets to pathways with TAS evidence at the lowest level, and finally preparing to calculate counts needed for the chi-squared statistic.Query:
SELECT DISTINCT drugName
   FROM `isb-cgc-bq.targetome_versioned.interactions_v1`
   LIMIT 100;
Answer:
drugName
Pamidronate Disodium
Gemtuzumab Ozogamicin
Ibritumomab Tiuxetan
Rolapitant Hydrochloride
Uridine Triacetate
Venetoclax
Ondansetron Hydrochloride
Palonosetron Hydrochloride
Aprepitant
Defibrotide Sodium
Romiplostim
Eltrombopag Olamine
Imiquimod
Raloxifene Hydrochloride
Lanreotide Acetate
Prednisone
Mechlorethamine Hydrochloride
Chlorambucil
Cyclophosphamide
Melphalan Hydrochloride
Ifosfamide
Bendamustine Hydrochloride
Busulfan
Thiotepa
Lomustine
Carmustine
Dacarbazine
Temozolomide
Pemetrexed Disodium
Pralatrexate
Mercaptopurine
Thioguanine
Fludarabine Phosphate
Clofarabine
Nelarabine
Fluorouracil
Cytarabine
Gemcitabine Hydrochloride
Capecitabine
Azacitidine
Decitabine
Vincristine Sulfate
Vinblastine Sulfate
Vinorelbine Tartrate
Etoposide
Paclitaxel
Docetaxel
Cabazitaxel
Trabectedin
Dactinomycin
Doxorubicin Hydrochloride
Daunorubicin Hydrochloride
Mitoxantrone Hydrochloride
Idarubicin Hydrochloride
Epirubicin Hydrochloride
Bleomycin
Mitomycin C
Ixabepilone
Cisplatin
Carboplatin
Oxaliplatin
Procarbazine Hydrochloride
Rituximab
Trastuzumab
Cetuximab
Bevacizumab
Panitumumab
Ofatumumab
Ipilimumab
Brentuximab Vedotin
Pertuzumab
Obinutuzumab
Ramucirumab
Pembrolizumab
Blinatumomab
Nivolumab
Daratumumab
Necitumumab
Elotuzumab
Aminolevulinic Acid
Imatinib Mesylate
Gefitinib
Erlotinib Hydrochloride
Sorafenib Tosylate
Sunitinib Malate
Dasatinib
Lapatinib Ditosylate
Temsirolimus
Nilotinib
Pazopanib Hydrochloride
Vandetanib
Vemurafenib
Crizotinib
Ruxolitinib Phosphate
Axitinib
Bosutinib
Regorafenib
Ponatinib Hydrochloride
Dabrafenib
Trametinib
Query:
SELECT DISTINCT synonym
   FROM `isb-cgc-bq.targetome_versioned.drug_synonyms_v1`
   WHERE LOWER(synonym) LIKE '%sorafenib%'
   LIMIT 100;
Answer:
synonym
sorafenib tosylate
Sorafenib Tosylate
sorafenib
SORAFENIB TOSYLATE
Sorafenib
SORAFENIB
Query:
SELECT DISTINCT drugID
   FROM `isb-cgc-bq.targetome_versioned.drug_synonyms_v1`
   WHERE LOWER(synonym) = 'sorafenib'
   LIMIT 100;
Answer:
drugID
157
Query:
SELECT DISTINCT e.expID, e.exp_assayValueMedian, e.exp_assayValueLow, e.exp_assayValueHigh
FROM `isb-cgc-bq.targetome_versioned.experiments_v1` e
JOIN `isb-cgc-bq.targetome_versioned.interactions_v1` i ON e.expID = i.expID
WHERE LOWER(i.drugName) LIKE '%sorafenib%'
  AND e.exp_assayValueMedian <= 100
LIMIT 100;
Answer:
expID,exp_assayValueMedian,exp_assayValueLow,exp_assayValueHigh
1591,7.0,,
1700,16.0,,
3983,41.0,,
4016,93.0,,
4069,20.0,,
1809,6.3,,
1822,13.0,,
1853,95.0,,
4773,62.0,,
4775,37.0,,
4788,13.0,,
4829,2.7,,
4839,31.0,,
4857,68.0,,
4869,59.0,,
2008,22.0,,
2105,20.0,,
2136,18.0,,
2171,7.4,,
2264,25.0,,
2431,39.0,,
2440,82.0,,
2545,17.0,,
2682,30.0,,
2784,95.0,,
2913,79.0,,
2956,13.0,,
3167,16.0,,
3246,4.5,,
3354,93.0,,
3389,31.0,,
3395,82.0,,
3410,48.0,,
3426,16.0,,
3485,31.0,,
3516,44.0,,
3524,68.0,,
3563,54.0,,
3566,39.0,,
3638,16.0,,
3657,7.4,,
3663,59.0,,
3664,13.0,,
3678,3.0,,
3694,25.0,,
3695,24.0,,
3716,79.0,,
3736,16.0,,
3871,33.0,,
4206,1.5,,
4215,6.6,,
Query:
SELECT DISTINCT e.expID, e.exp_assayValueMedian,
       COALESCE(e.exp_assayValueLow, e.exp_assayValueMedian) AS exp_assayValueLow,
       COALESCE(e.exp_assayValueHigh, e.exp_assayValueMedian) AS exp_assayValueHigh
FROM `isb-cgc-bq.targetome_versioned.experiments_v1` e
JOIN `isb-cgc-bq.targetome_versioned.interactions_v1` i ON e.expID = i.expID
WHERE LOWER(i.drugName) LIKE '%sorafenib%'
  AND e.exp_assayValueMedian <= 100
  AND (e.exp_assayValueLow <= 100 OR e.exp_assayValueLow IS NULL)
  AND (e.exp_assayValueHigh <= 100 OR e.exp_assayValueHigh IS NULL)
LIMIT 100;
Answer:
expID,exp_assayValueMedian,exp_assayValueLow,exp_assayValueHigh
1591,7.0,7.0,7.0
1700,16.0,16.0,16.0
3983,41.0,41.0,41.0
4016,93.0,93.0,93.0
4069,20.0,20.0,20.0
1809,6.3,6.3,6.3
1822,13.0,13.0,13.0
1853,95.0,95.0,95.0
4773,62.0,62.0,62.0
4775,37.0,37.0,37.0
4788,13.0,13.0,13.0
4829,2.7,2.7,2.7
4839,31.0,31.0,31.0
4857,68.0,68.0,68.0
4869,59.0,59.0,59.0
2008,22.0,22.0,22.0
2105,20.0,20.0,20.0
2136,18.0,18.0,18.0
2171,7.4,7.4,7.4
2264,25.0,25.0,25.0
2431,39.0,39.0,39.0
2440,82.0,82.0,82.0
2545,17.0,17.0,17.0
2682,30.0,30.0,30.0
2784,95.0,95.0,95.0
2913,79.0,79.0,79.0
2956,13.0,13.0,13.0
3167,16.0,16.0,16.0
3246,4.5,4.5,4.5
3354,93.0,93.0,93.0
3389,31.0,31.0,31.0
3395,82.0,82.0,82.0
3410,48.0,48.0,48.0
3426,16.0,16.0,16.0
3485,31.0,31.0,31.0
3516,44.0,44.0,44.0
3524,68.0,68.0,68.0
3563,54.0,54.0,54.0
3566,39.0,39.0,39.0
3638,16.0,16.0,16.0
3657,7.4,7.4,7.4
3663,59.0,59.0,59.0
3664,13.0,13.0,13.0
3678,3.0,3.0,3.0
3694,25.0,25.0,25.0
3695,24.0,24.0,24.0
3716,79.0,79.0,79.0
3736,16.0,16.0,16.0
3871,33.0,33.0,33.0
4206,1.5,1.5,1.5
4215,6.6,6.6,6.6
Query:
-- Corrected Query 2
SELECT DISTINCT p.uniprot_id, p.stable_id
FROM `isb-cgc-bq.reactome_versioned.physical_entity_v77` p
WHERE p.uniprot_id IN (
  SELECT DISTINCT i.target_uniprotID
  FROM `isb-cgc-bq.targetome_versioned.interactions_v1` i
  WHERE LOWER(i.drugName) LIKE '%sorafenib%'
    AND LOWER(i.targetSpecies) LIKE '%homo sapiens%'
    AND i.target_uniprotID IS NOT NULL
)
LIMIT 100
Answer:
uniprot_id,stable_id
P04049,R-HSA-109786
Q02750,R-HSA-109837
P27361,R-HSA-109842
P36507,R-HSA-109848
P28482,R-HSA-109853
P23458,R-HSA-1112543
P29597,R-HSA-1112598
Q16566,R-HSA-111902
P17612,R-HSA-111936
P22694,R-HSA-111937
Q16566,R-HSA-112280
Q02750,R-HSA-112339
P28482,R-HSA-112354
P27361,R-HSA-112359
Q02750,R-HSA-112374
O96017,R-HSA-113824
O96017,R-HSA-113825
O14757,R-HSA-113826
P11802,R-HSA-113830
O14757,R-HSA-113838
P11802,R-HSA-113843
P00533,R-HSA-1169417
P00533,R-HSA-1169418
P00533,R-HSA-1173211
P00533,R-HSA-1173212
P00533,R-HSA-1177528
P00533,R-HSA-1177530
P00533,R-HSA-1177531
P00533,R-HSA-1177532
P00533,R-HSA-1177541
P00533,R-HSA-1177542
P00533,R-HSA-1181211
P00533,R-HSA-1181214
P00533,R-HSA-1181386
P00533,R-HSA-1181399
P00533,R-HSA-1182984
P00533,R-HSA-1182985
P00533,R-HSA-1214162
P00533,R-HSA-1228010
P00533,R-HSA-1228012
P00533,R-HSA-1228015
P00533,R-HSA-1228016
P00533,R-HSA-1228025
P00533,R-HSA-1228031
P00533,R-HSA-1228034
P00533,R-HSA-1228037
P00533,R-HSA-1228038
P00533,R-HSA-1228039
P00533,R-HSA-1228040
P00533,R-HSA-1228041
P00533,R-HSA-1228042
P00533,R-HSA-1228044
P00533,R-HSA-1248649
P04626,R-HSA-1248698
Q13627,R-HSA-1362267
P06213,R-HSA-141718
P06213,R-HSA-141719
P06213,R-HSA-141722
P16591,R-HSA-1433364
P10721,R-HSA-1433492
P42679,R-HSA-1433581
P10721,R-HSA-1472116
P31749,R-HSA-1500573
P42336,R-HSA-1500691
P42336,R-HSA-1500695
P42336,R-HSA-1500701
P42336,R-HSA-1500705
P42336,R-HSA-1500706
P42336,R-HSA-1500709
P42336,R-HSA-1500714
P42336,R-HSA-1500716
P42336,R-HSA-1500718
P42336,R-HSA-1500719
P42336,R-HSA-1500720
P17252,R-HSA-156469
P30291,R-HSA-156491
P30291,R-HSA-156694
P53350,R-HSA-156720
P24941,R-HSA-157440
Q99640,R-HSA-157457
P80370,R-HSA-1604447
Q9UBF8,R-HSA-1604615
O00750,R-HSA-1604619
Q8TBX8,R-HSA-1604638
P11362,R-HSA-1614373
P11362,R-HSA-1614377
P22607,R-HSA-1614387
P22607,R-HSA-1614390
P22607,R-HSA-1614394
P22607,R-HSA-1614398
P22607,R-HSA-1614400
P22607,R-HSA-1614402
P22607,R-HSA-1614406
P22607,R-HSA-1614410
Query:
-- Corrected Query 3
SELECT DISTINCT pp.pathway_stable_id
FROM `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp
WHERE pp.pe_stable_id IN (
  SELECT DISTINCT pe.stable_id
  FROM `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe
  WHERE pe.uniprot_id IN (
    SELECT DISTINCT i.target_uniprotID
    FROM `isb-cgc-bq.targetome_versioned.interactions_v1` i
    WHERE LOWER(i.drugName) LIKE '%sorafenib%'
      AND LOWER(i.targetSpecies) LIKE '%homo sapiens%'
      AND i.target_uniprotID IS NOT NULL
  )
)
  AND LOWER(pp.evidence_code) = 'tas'
LIMIT 100
Answer:
pathway_stable_id
R-HSA-68875
R-HSA-68877
R-HSA-68881
R-HSA-68882
R-HSA-68884
R-HSA-68886
R-HSA-68911
R-HSA-68949
R-HSA-68962
R-HSA-69002
R-HSA-69017
R-HSA-69052
R-HSA-69200
R-HSA-69202
R-HSA-69206
R-HSA-69231
R-HSA-69236
R-HSA-69239
R-HSA-69242
R-HSA-69273
R-HSA-69275
R-HSA-69278
R-HSA-69306
R-HSA-69416
R-HSA-69473
R-HSA-69478
R-HSA-69481
R-HSA-69541
R-HSA-69563
R-HSA-69580
R-HSA-69601
R-HSA-69610
R-HSA-69613
R-HSA-69615
R-HSA-69618
R-HSA-69620
R-HSA-69656
R-HSA-70221
R-HSA-71387
R-HSA-72086
R-HSA-72163
R-HSA-72172
R-HSA-72203
R-HSA-72312
R-HSA-73728
R-HSA-73762
R-HSA-73772
R-HSA-73776
R-HSA-73779
R-HSA-73854
R-HSA-73857
R-HSA-73863
R-HSA-73864
R-HSA-73886
R-HSA-73887
R-HSA-73894
R-HSA-74160
R-HSA-74713
R-HSA-74749
R-HSA-74751
R-HSA-74752
R-HSA-75035
R-HSA-75153
R-HSA-75815
R-HSA-75892
R-HSA-75893
R-HSA-75953
R-HSA-75955
R-HSA-76002
R-HSA-76005
R-HSA-76009
R-HSA-76042
R-HSA-77075
R-HSA-77387
R-HSA-109581
R-HSA-109582
R-HSA-109606
R-HSA-109704
R-HSA-110056
R-HSA-111446
R-HSA-111458
R-HSA-111461
R-HSA-111465
R-HSA-111471
R-HSA-111885
R-HSA-111931
R-HSA-111932
R-HSA-111933
R-HSA-111995
R-HSA-111996
R-HSA-111997
R-HSA-112040
R-HSA-112043
R-HSA-112310
R-HSA-112314
R-HSA-112315
R-HSA-112316
R-HSA-112382
R-HSA-112399
R-HSA-112409
Query:
-- Corrected Query 4
SELECT DISTINCT p.stable_id, p.name
FROM `isb-cgc-bq.reactome_versioned.pathway_v77` p
WHERE p.stable_id IN (
  SELECT DISTINCT pp.pathway_stable_id
  FROM `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp
  WHERE LOWER(pp.evidence_code) = 'tas'
    AND pp.pe_stable_id IN (
      SELECT DISTINCT pe.stable_id
      FROM `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe
      WHERE pe.uniprot_id IN (
        SELECT DISTINCT i.target_uniprotID
        FROM `isb-cgc-bq.targetome_versioned.interactions_v1` i
        WHERE LOWER(i.drugName) LIKE '%sorafenib%'
          AND LOWER(i.targetSpecies) LIKE '%homo sapiens%'
          AND i.target_uniprotID IS NOT NULL
      )
    )
)
  AND p.lowest_level = TRUE
  AND LOWER(p.species) LIKE '%homo sapiens%'
LIMIT 100
Answer:
stable_id,name
R-HSA-5250924,B-WICH complex positively regulates rRNA expression
R-HSA-8854521,Interaction between PHLDA1 and AURKA
R-HSA-9702636,tandutinib-resistant FLT3 mutants
R-HSA-202424,Downstream TCR signaling
R-HSA-437239,Recycling pathway of L1
R-HSA-139910,Activation of BMF and translocation to mitochondria
R-HSA-9022692,Regulation of MECP2 expression and activity
R-HSA-5603027,IKBKG deficiency causes anhidrotic ectodermal dysplasia with immunodeficiency (EDA-ID) (via TLR)
R-HSA-5603037,IRAK4 deficiency (TLR5)
R-HSA-9014325,"TICAM1,TRAF6-dependent induction of TAK1 complex"
R-HSA-6785631,ERBB2 Regulates Cell Motility
R-HSA-8849469,PTK6 Regulates RTKs and Their Effectors AKT1 and DOK1
R-HSA-180292,GAB1 signalosome
R-HSA-8852405,Signaling by MST1
R-HSA-381340,Transcriptional regulation of white adipocyte differentiation
R-HSA-5689880,Ub-specific processing proteases
R-HSA-445144,Signal transduction by L1
R-HSA-9702620,quizartinib-resistant FLT3 mutants
R-HSA-918233,TRAF3-dependent IRF activation pathway
R-HSA-5685938,HDR through Single Strand Annealing (SSA)
R-HSA-8849471,"PTK6 Regulates RHO GTPases, RAS GTPase and MAP kinases"
R-HSA-5690714,CD22 mediated BCR regulation
R-HSA-2871796,FCERI mediated MAPK activation
R-HSA-389359,CD28 dependent Vav1 pathway
R-HSA-1810476,RIP-mediated NFkB activation via ZBP1
R-HSA-216083,Integrin cell surface interactions
R-HSA-3642279,TGFBR2 MSI Frameshift Mutants in Cancer
R-HSA-9665251,Resistance of ERBB2 KD mutants to lapatinib
R-HSA-8853334,Signaling by FGFR3 fusions in cancer
R-HSA-2514859,"Inactivation, recovery and regulation of the phototransduction cascade"
R-HSA-167590,Nef Mediated CD4 Down-regulation
R-HSA-1236974,ER-Phagosome pathway
R-HSA-9604323,Negative regulation of NOTCH4 signaling
R-HSA-2565942,Regulation of PLK1 Activity at G2/M Transition
R-HSA-9013418,RHOBTB2 GTPase cycle
R-HSA-9634638,Estrogen-dependent nuclear events downstream of ESR-membrane signaling
R-HSA-9616222,Transcriptional regulation of granulopoiesis
R-HSA-6783783,Interleukin-10 signaling
R-HSA-8941858,Regulation of RUNX3 expression and activity
R-HSA-114604,GPVI-mediated activation cascade
R-HSA-9603381,Activated NTRK3 signals through PI3K
R-HSA-2730905,Role of LAT2/NTAL/LAB on calcium mobilization
R-HSA-2871809,FCERI mediated Ca+2 mobilization
R-HSA-200425,Carnitine metabolism
R-HSA-6806942,MET Receptor Activation
R-HSA-3645790,TGFBR2 Kinase Domain Mutants in Cancer
R-HSA-416550,Sema4D mediated inhibition of cell attachment and migration
R-HSA-114516,Disinhibition of SNARE formation
R-HSA-9702577,semaxanib-resistant FLT3 mutants
R-HSA-5358751,S45 mutants of beta-catenin aren't phosphorylated
R-HSA-5578768,Physiological factors
R-HSA-180336,SHC1 events in EGFR signaling
R-HSA-8854050,FBXL7 down-regulates AURKA during mitotic entry and in early mitosis
R-HSA-9662834,CD163 mediating an anti-inflammatory response
R-HSA-70221,Glycogen breakdown (glycogenolysis)
R-HSA-6804760,Regulation of TP53 Activity through Methylation
R-HSA-9665737,Drug resistance in ERBB2 TMD/JMD mutants
R-HSA-69601,Ubiquitin Mediated Degradation of Phosphorylated Cdc25A
R-HSA-5579030,Defective CYP19A1 causes AEXS
R-HSA-6804114,TP53 Regulates Transcription of Genes Involved in G2 Cell Cycle Arrest
R-HSA-195399,VEGF binds to VEGFR leading to receptor dimerization
R-HSA-1266695,Interleukin-7 signaling
Query:
-- Corrected Query 5
SELECT pp.pathway_stable_id, COUNT(DISTINCT i.targetID) AS target_count
FROM `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp
JOIN `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe ON pp.pe_stable_id = pe.stable_id
JOIN `isb-cgc-bq.targetome_versioned.interactions_v1` i ON pe.uniprot_id = i.target_uniprotID
WHERE LOWER(i.drugName) LIKE '%sorafenib%'
  AND LOWER(i.targetSpecies) LIKE '%homo sapiens%'
  AND LOWER(pp.evidence_code) = 'tas'
GROUP BY pp.pathway_stable_id
LIMIT 100
Answer:
pathway_stable_id,target_count
R-HSA-68875,6
R-HSA-68877,13
R-HSA-68881,1
R-HSA-68882,3
R-HSA-68884,1
R-HSA-68886,15
R-HSA-68911,1
R-HSA-68949,1
R-HSA-68962,1
R-HSA-69002,1
R-HSA-69017,1
R-HSA-69052,1
R-HSA-69200,1
R-HSA-69202,8
R-HSA-69206,8
R-HSA-69231,7
R-HSA-69236,7
R-HSA-69239,1
R-HSA-69242,8
R-HSA-69273,5
R-HSA-69275,13
R-HSA-69278,31
R-HSA-69306,1
R-HSA-69416,1
R-HSA-69473,3
R-HSA-69478,2
R-HSA-69481,5
R-HSA-69541,1
R-HSA-69563,2
R-HSA-69580,2
R-HSA-69601,2
R-HSA-69610,2
R-HSA-69613,2
R-HSA-69615,3
R-HSA-69618,3
R-HSA-69620,8
R-HSA-69656,8
R-HSA-70221,2
R-HSA-71387,2
R-HSA-72086,1
R-HSA-72163,1
R-HSA-72172,1
R-HSA-72203,1
R-HSA-72312,5
R-HSA-73728,1
R-HSA-73762,1
R-HSA-73772,1
R-HSA-73776,1
R-HSA-73779,1
R-HSA-73854,2
R-HSA-73857,42
R-HSA-73863,1
R-HSA-73864,2
R-HSA-73886,1
R-HSA-73887,8
R-HSA-73894,6
R-HSA-74160,44
R-HSA-74713,1
R-HSA-74749,3
R-HSA-74751,9
R-HSA-74752,9
R-HSA-75035,2
R-HSA-75153,7
R-HSA-75815,1
R-HSA-75892,2
R-HSA-75893,4
R-HSA-75953,1
R-HSA-75955,2
R-HSA-76002,21
R-HSA-76005,1
R-HSA-76009,6
R-HSA-76042,1
R-HSA-77075,1
R-HSA-77387,1
R-HSA-109581,11
R-HSA-109582,29
R-HSA-109606,3
R-HSA-109704,6
R-HSA-110056,5
R-HSA-111446,1
R-HSA-111458,2
R-HSA-111461,2
R-HSA-111465,7
R-HSA-111471,2
R-HSA-111885,9
R-HSA-111931,2
R-HSA-111932,3
R-HSA-111933,7
R-HSA-111995,1
R-HSA-111996,8
R-HSA-111997,7
Query:
-- Corrected Query 6
SELECT pathway_stable_id, 
       COUNT(DISTINCT CASE WHEN is_target THEN target_uniprotID END) AS target_count,
       COUNT(DISTINCT CASE WHEN NOT is_target THEN target_uniprotID END) AS non_target_count
FROM (
  SELECT pp.pathway_stable_id, pe.uniprot_id AS target_uniprotID,
         pe.uniprot_id IN (
           SELECT DISTINCT i.target_uniprotID
           FROM `isb-cgc-bq.targetome_versioned.interactions_v1` i
           WHERE LOWER(i.drugName) LIKE '%sorafenib%'
             AND LOWER(i.targetSpecies) LIKE '%homo sapiens%'
             AND i.target_uniprotID IS NOT NULL
         ) AS is_target
  FROM `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp
  JOIN `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe ON pp.pe_stable_id = pe.stable_id
  WHERE LOWER(pp.evidence_code) = 'tas'
)
GROUP BY pathway_stable_id
LIMIT 100
Answer:
pathway_stable_id,target_count,non_target_count
R-HSA-15869,0,99
R-HSA-68616,0,6
R-HSA-68827,0,59
R-HSA-68867,0,68
R-HSA-68875,6,107
R-HSA-68877,13,190
R-HSA-68882,3,229
R-HSA-68884,1,12
R-HSA-68886,15,375
R-HSA-68911,1,4
R-HSA-68949,1,70
R-HSA-68952,0,8
R-HSA-68962,1,32
R-HSA-69002,1,84
R-HSA-69017,1,72
R-HSA-69052,1,90
R-HSA-69091,0,14
R-HSA-69109,0,14
R-HSA-69166,0,14
R-HSA-69183,0,15
R-HSA-69186,0,20
R-HSA-69190,0,24
R-HSA-69200,1,3
R-HSA-69202,8,75
R-HSA-69205,0,24
R-HSA-69206,8,118
R-HSA-69231,7,40
R-HSA-69236,7,40
R-HSA-69239,1,118
R-HSA-69242,8,152
R-HSA-69273,5,20
R-HSA-69275,13,185
R-HSA-69278,31,501
R-HSA-69306,1,127
R-HSA-69416,1,10
R-HSA-69473,3,75
R-HSA-69478,2,3
R-HSA-69481,5,146
R-HSA-69541,1,56
R-HSA-69560,0,4
R-HSA-69563,2,64
R-HSA-69580,2,64
R-HSA-69601,2,50
R-HSA-69610,2,50
R-HSA-69613,2,50
R-HSA-69615,3,65
R-HSA-69618,3,108
R-HSA-69620,8,267
R-HSA-69656,8,77
R-HSA-69895,0,4
R-HSA-70171,0,69
R-HSA-70221,2,12
R-HSA-70263,0,34
R-HSA-70268,0,29
R-HSA-70326,0,89
R-HSA-70350,0,5
R-HSA-70370,0,5
R-HSA-70635,0,10
R-HSA-70688,0,3
R-HSA-70895,0,20
R-HSA-70921,0,8
R-HSA-71032,0,5
R-HSA-71064,0,12
R-HSA-71240,0,11
Query:
-- Corrected Query 7
SELECT pathway_stable_id, COUNT(DISTINCT target_uniprotID) AS target_count
FROM (
  SELECT pp.pathway_stable_id, i.target_uniprotID
  FROM `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp
  JOIN `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe ON pp.pe_stable_id = pe.stable_id
  JOIN `isb-cgc-bq.targetome_versioned.interactions_v1` i ON pe.uniprot_id = i.target_uniprotID
  WHERE LOWER(i.drugName) LIKE '%sorafenib%'
    AND LOWER(i.targetSpecies) LIKE '%homo sapiens%'
    AND LOWER(pp.evidence_code) = 'tas'
)
GROUP BY pathway_stable_id
ORDER BY target_count DESC
LIMIT 100 OFFSET 3
Answer:
pathway_stable_id,target_count
R-HSA-9006934,68
R-HSA-1266738,61
R-HSA-168249,60
R-HSA-1280215,57
R-HSA-422475,54
R-HSA-9675108,54
R-HSA-5663202,49
R-HSA-449147,46
R-HSA-74160,44
R-HSA-5683057,43
R-HSA-212436,42
R-HSA-5663205,42
R-HSA-73857,42
R-HSA-9716542,41
R-HSA-194315,41
R-HSA-9006925,41
R-HSA-372790,37
R-HSA-388396,36
R-HSA-5684996,35
R-HSA-5673001,34
R-HSA-1640170,33
R-HSA-1257604,33
R-HSA-1430728,31
R-HSA-69278,31
R-HSA-8953897,31
R-HSA-2262752,31
R-HSA-3700989,31
R-HSA-166016,29
R-HSA-109582,29
R-HSA-168898,29
R-HSA-194138,28
R-HSA-1280218,28
R-HSA-5633007,27
R-HSA-166058,26
R-HSA-4420097,26
R-HSA-168179,26
R-HSA-199418,26
R-HSA-168188,26
R-HSA-9012999,26
R-HSA-181438,26
R-HSA-168164,25
R-HSA-166166,25
R-HSA-937061,25
R-HSA-975155,24
R-HSA-975871,24
R-HSA-556833,24
R-HSA-975138,24
R-HSA-6811558,24
R-HSA-168142,24
R-HSA-168176,24
R-HSA-168181,24
R-HSA-168138,24
R-HSA-2454202,23
R-HSA-2559583,23
R-HSA-195258,23
R-HSA-450294,22
R-HSA-2219528,22
R-HSA-448424,22
R-HSA-2682334,22
R-HSA-76002,21
R-HSA-166520,19
R-HSA-6804756,19
R-HSA-416476,18
R-HSA-9658195,18
R-HSA-2559580,18
R-HSA-2029480,17
R-HSA-112316,17
R-HSA-187037,16
R-HSA-112315,16
R-HSA-3928665,16
R-HSA-68886,15
R-HSA-6802949,15
R-HSA-202403,15
R-HSA-6802946,15
R-HSA-9013149,15
R-HSA-5621481,15
R-HSA-6802957,15
R-HSA-6802955,15
R-HSA-9649948,15
R-HSA-112314,15
R-HSA-1483257,14
R-HSA-9656223,14
R-HSA-388841,14
R-HSA-2219530,14
R-HSA-442755,14
R-HSA-6802952,14
R-HSA-1227986,14
R-HSA-453274,13
Query:
SELECT pathway_stable_id, COUNT(DISTINCT target_uniprotID) AS target_count
FROM (
  SELECT pp.pathway_stable_id, i.target_uniprotID
  FROM `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp
  JOIN `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe ON pp.pe_stable_id = pe.stable_id
  JOIN `isb-cgc-bq.targetome_versioned.interactions_v1` i ON pe.uniprot_id = i.target_uniprotID
  WHERE LOWER(i.drugName) LIKE '%sorafenib%'
)
GROUP BY pathway_stable_id
ORDER BY target_count DESC
LIMIT 100;
Answer:
pathway_stable_id,target_count
R-HSA-162582,175
R-HSA-1643685,85
R-HSA-168256,84
R-HSA-1266738,74
R-HSA-9006934,70
R-HSA-9675108,63
R-HSA-422475,63
R-HSA-168249,61
R-HSA-1280215,58
R-HSA-212436,53
R-HSA-73857,53
R-HSA-74160,53
R-HSA-5663202,49
R-HSA-9006925,48
R-HSA-449147,47
R-HSA-5663205,44
R-HSA-9716542,43
R-HSA-5683057,43
R-HSA-194315,43
R-HSA-372790,42
R-HSA-388396,41
R-HSA-8953897,37
R-HSA-2262752,37
R-HSA-5684996,35
R-HSA-1257604,35
R-HSA-1640170,34
R-HSA-5673001,34
R-HSA-109582,33
R-HSA-1430728,32
R-HSA-69278,32
R-HSA-3700989,31
R-HSA-166016,30
R-HSA-168898,30
R-HSA-1280218,29
R-HSA-194138,28
R-HSA-9012999,27
R-HSA-168188,27
R-HSA-166058,27
R-HSA-168179,27
R-HSA-5633007,27
R-HSA-181438,27
R-HSA-937061,26
R-HSA-168164,26
R-HSA-199418,26
R-HSA-556833,26
R-HSA-166166,26
R-HSA-4420097,26
R-HSA-168181,25
R-HSA-168142,25
R-HSA-168138,25
R-HSA-975871,25
R-HSA-168176,25
R-HSA-975155,25
R-HSA-975138,25
R-HSA-6811558,24
R-HSA-2454202,24
R-HSA-112316,24
R-HSA-195258,24
R-HSA-2682334,24
R-HSA-112315,23
R-HSA-2559583,23
R-HSA-450294,23
R-HSA-166520,23
R-HSA-112314,23
R-HSA-448424,23
R-HSA-2219528,22
R-HSA-442755,22
R-HSA-187037,21
R-HSA-438064,21
R-HSA-76002,21
R-HSA-6804756,19
R-HSA-9658195,19
R-HSA-5357801,18
R-HSA-109581,18
R-HSA-2559580,18
R-HSA-416476,18
R-HSA-2029480,17
R-HSA-418594,16
R-HSA-3928665,16
R-HSA-9013149,15
R-HSA-6802957,15
R-HSA-6802955,15
R-HSA-68886,15
R-HSA-202403,15
R-HSA-6802949,15
R-HSA-195721,15
R-HSA-6802946,15
R-HSA-373760,15
Query:
-- Corrected Query 9
SELECT DISTINCT pe.uniprot_id
FROM `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe
JOIN `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp ON pe.stable_id = pp.pe_stable_id
WHERE pp.pathway_stable_id IN (
  -- Replace with actual Top 3 pathways based on highest target counts or chi-squared statistics
  'R-HSA-69278', 'R-HSA-74160', 'R-HSA-73857'
)
  AND pe.uniprot_id NOT IN (
    SELECT DISTINCT i.target_uniprotID
    FROM `isb-cgc-bq.targetome_versioned.interactions_v1` i
    WHERE LOWER(i.drugName) LIKE '%sorafenib%'
      AND LOWER(i.targetSpecies) LIKE '%homo sapiens%'
      AND i.target_uniprotID IS NOT NULL
  )
LIMIT 100
Answer:
uniprot_id
P14635
Q8NFH3
O43929
O60763
P49736
Q09028
Q96GY3
P33993
Q9BPX3
Q9Y248
P20248
Q15021
Q96HA1
Q9BTX1
P06493
P37198
P55735
Q92621
Q9BVL2-1
Q15003
Q96GX5
Q9BRX5
P67775
O75419
O95347
Q5SRE5
Q92973
Q08379
Q13415
P33992
Q8WYP5
P06400
P25205
Q66LE6
P30154
Q14186
Q9BQQ3
Q9UJA3
Q9BW27
P52948-5
Q14691
Q9H0U4
O43913
P57740
P04183
Q52LA3
Q5TKA1
Q6MZP7
P62826
Q01094
O95067
P78396
P56211
Q15329
Q9BRT9
O43768
P24385
P30153
P33991
Q13547
Q8NFH4
Q9NTJ3
O75694
Q13416
Q14188
Q14566
Q14974
Q16254
Q8N1F7
Q96EE3-1
P28749
Q8NFH5
Q9BVL2-2
P62714
P62820
Q7Z3B4
Q9UBD5
Q8WUM0
Q9Y5N6
P10244
Q12769
Q08999
A8MYZ6
O00487
O75909
P0CG48
P0DP23
P10070
P12643
P28066
P49721
Q14469
Q8WVF2
Q99436
Q9HCE1
P51608-2
P52747
P56179
P63165
Q13224
Query:
-- Corrected Query 10
SELECT 'Within Top 3 Pathways' AS GroupLabel,
       SUM(CASE WHEN is_target THEN 1 ELSE 0 END) AS Target_Count,
       SUM(CASE WHEN NOT is_target THEN 1 ELSE 0 END) AS Non_Target_Count
FROM (
  SELECT pe.uniprot_id,
         pe.uniprot_id IN (
           SELECT DISTINCT i.target_uniprotID
           FROM `isb-cgc-bq.targetome_versioned.interactions_v1` i
           WHERE LOWER(i.drugName) LIKE '%sorafenib%'
             AND LOWER(i.targetSpecies) LIKE '%homo sapiens%'
             AND i.target_uniprotID IS NOT NULL
         ) AS is_target
  FROM `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe
  JOIN `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp ON pe.stable_id = pp.pe_stable_id
  WHERE pp.pathway_stable_id IN (
    'R-HSA-69278', 'R-HSA-74160', 'R-HSA-73857'
  )
)
UNION ALL
SELECT 'Outside Top 3 Pathways' AS GroupLabel,
       SUM(CASE WHEN is_target THEN 1 ELSE 0 END) AS Target_Count,
       SUM(CASE WHEN NOT is_target THEN 1 ELSE 0 END) AS Non_Target_Count
FROM (
  SELECT pe.uniprot_id,
         pe.uniprot_id IN (
           SELECT DISTINCT i.target_uniprotID
           FROM `isb-cgc-bq.targetome_versioned.interactions_v1` i
           WHERE LOWER(i.drugName) LIKE '%sorafenib%'
             AND LOWER(i.targetSpecies) LIKE '%homo sapiens%'
             AND i.target_uniprotID IS NOT NULL
         ) AS is_target
  FROM `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe
  JOIN `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp ON pe.stable_id = pp.pe_stable_id
  WHERE pp.pathway_stable_id NOT IN (
    'R-HSA-69278', 'R-HSA-74160', 'R-HSA-73857'
  )
)
LIMIT 100;
Answer:
GroupLabel,Target_Count,Non_Target_Count
Within Top 3 Pathways,1597,35935
Outside Top 3 Pathways,121323,1422506
End Exploring Related Columns
Task: What are the counts of targets and non-targets within and outside the top 3 pathways with the highest chi-squared statistic for target species 'homo sapiens' associated with 'sorafenib' only? The targets should meet specific assay conditions (median assay value ≤ 100, with assay values below and above also ≤ 100 or NULL if not applicable), and only pathways with TAS evidence at the lowest level should be considered.

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
Group,IsTarget,Count
Within Top 3 Pathways,Yes,count1:int
Within Top 3 Pathways,No,count2:int
Outside Top 3 Pathways,Yes,count3:int
Outside Top 3 Pathways,No,count4:int
```

This table shows the counts of targets and non-targets within and outside the top 3 pathways with the highest chi-squared statistic for target species 'homo sapiens' associated with 'sorafenib' only. The targets meet the specific assay conditions (median assay value ≤ 100, with assay values below and above also ≤ 100 or NULL if not applicable), and only pathways with TAS evidence at the lowest level are considered..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'isb-cgc-bq': {'reactome_versioned': ['pathway_hierarchy_v77', 'pathway_v77', 'pe_to_pathway_v77', 'physical_entity_v77'], 'targetome_versioned': ['drug_synonyms_v1', 'experiments_v1', 'interactions_v1', 'sources_v1', 'target_synonyms_v1']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-26 20:46:00 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:46:00 - root - INFO - ```sql
WITH sorafenib_targets AS (
  SELECT DISTINCT i.targetID, i.target_uniprotID
  FROM `isb-cgc-bq.targetome_versioned.interactions_v1` i
  JOIN `isb-cgc-bq.targetome_versioned.experiments_v1` e ON i.expID = e.expID
  WHERE (
    LOWER(i.drugName) = 'sorafenib' OR
    LOWER(i.drugName) IN (
      SELECT LOWER(synonym)
      FROM `isb-cgc-bq.targetome_versioned.drug_synonyms_v1`
      WHERE LOWER(synonym) = 'sorafenib'
    )
  )
  AND LOWER(i.targetSpecies) = 'homo sapiens'
  AND e.exp_assayValueMedian <= 100
  AND (e.exp_assayValueLow <= 100 OR e.exp_assayValueLow IS NULL)
  AND (e.exp_assayValueHigh <= 100 OR e.exp_assayValueHigh IS NULL)
  AND i.target_uniprotID IS NOT NULL
),
all_physical_entities AS (
  SELECT DISTINCT pe.uniprot_id, pp.pathway_stable_id
  FROM `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe
  JOIN `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp ON pe.stable_id = pp.pe_stable_id
  JOIN `isb-cgc-bq.reactome_versioned.pathway_v77` p ON pp.pathway_stable_id = p.stable_id
  WHERE pp.evidence_code = 'TAS'
    AND p.lowest_level = TRUE
    AND LOWER(p.species) = 'homo sapiens'
),
target_uniprot_ids AS (
  SELECT DISTINCT target_uniprotID
  FROM sorafenib_targets
),
annotated_entities AS (
  SELECT
    pathway_stable_id,
    uniprot_id,
    CASE WHEN uniprot_id IN (SELECT target_uniprotID FROM target_uniprot_ids) THEN 1 ELSE 0 END AS is_target
  FROM all_physical_entities
),
counts_per_pathway AS (
  SELECT
    pathway_stable_id,
    SUM(is_target) AS target_count,
    SUM(1 - is_target) AS non_target_count,
    COUNT(*) AS total_count
  FROM annotated_entities
  GROUP BY pathway_stable_id
),
total_counts AS (
  SELECT
    SUM(target_count) AS total_target_count,
    SUM(non_target_count) AS total_non_target_count,
    SUM(total_count) AS grand_total_count
  FROM counts_per_pathway
),
expected_counts_per_pathway AS (
  SELECT
    cp.pathway_stable_id,
    cp.target_count,
    cp.non_target_count,
    cp.total_count,
    tc.total_target_count,
    tc.total_non_target_count,
    tc.grand_total_count,
    (cp.total_count * tc.total_target_count) / tc.grand_total_count AS expected_target_count,
    (cp.total_count * tc.total_non_target_count) / tc.grand_total_count AS expected_non_target_count
  FROM counts_per_pathway cp
  CROSS JOIN total_counts tc
),
chi_squared_per_pathway AS (
  SELECT
    pathway_stable_id,
    target_count,
    non_target_count,
    expected_target_count,
    expected_non_target_count,
    ((target_count - expected_target_count)*(target_count - expected_target_count))/expected_target_count +
    ((non_target_count - expected_non_target_count)*(non_target_count - expected_non_target_count))/expected_non_target_count AS chi_squared
  FROM expected_counts_per_pathway
  WHERE expected_target_count > 0 AND expected_non_target_count > 0
),
top_three_pathways AS (
  SELECT pathway_stable_id
  FROM chi_squared_per_pathway
  ORDER BY chi_squared DESC
  LIMIT 3
),
counts_within_top3 AS (
  SELECT 
    'Within Top 3 Pathways' AS `Group`,
    CASE WHEN is_target = 1 THEN 'Yes' ELSE 'No' END AS IsTarget,
    COUNT(*) AS `Count`
  FROM annotated_entities
  WHERE pathway_stable_id IN (SELECT pathway_stable_id FROM top_three_pathways)
  GROUP BY `Group`, IsTarget
),
counts_outside_top3 AS (
  SELECT 
    'Outside Top 3 Pathways' AS `Group`,
    CASE WHEN is_target = 1 THEN 'Yes' ELSE 'No' END AS IsTarget,
    COUNT(*) AS `Count`
  FROM annotated_entities
  WHERE pathway_stable_id NOT IN (SELECT pathway_stable_id FROM top_three_pathways)
  GROUP BY `Group`, IsTarget
)
SELECT *
FROM counts_within_top3
UNION ALL
SELECT *
FROM counts_outside_top3
ORDER BY `Group`, IsTarget;
```
2025-01-26 20:46:04 - root - INFO - itercount: 1
2025-01-26 20:46:04 - root - INFO - 0
2025-01-26 20:46:04 - root - INFO - results: 
Group,IsTarget,Count
Outside Top 3 Pathways,No,32006


2025-01-26 20:46:04 - root - INFO - Please check the answer again by reviewing What are the counts of targets and non-targets within and outside the top 3 pathways with the highest chi-squared statistic for target species 'homo sapiens' associated with 'sorafenib' only? The targets should meet specific assay conditions (median assay value ≤ 100, with assay values below and above also ≤ 100 or NULL if not applicable), and only pathways with TAS evidence at the lowest level should be considered., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Group,IsTarget,Count
Within Top 3 Pathways,Yes,count1:int
Within Top 3 Pathways,No,count2:int
Outside Top 3 Pathways,Yes,count3:int
Outside Top 3 Pathways,No,count4:int
```

This table shows the counts of targets and non-targets within and outside the top 3 pathways with the highest chi-squared statistic for target species 'homo sapiens' associated with 'sorafenib' only. The targets meet the specific assay conditions (median assay value ≤ 100, with assay values below and above also ≤ 100 or NULL if not applicable), and only pathways with TAS evidence at the lowest level are considered. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Group,IsTarget,Count
Outside Top 3 Pathways,No,32006
Current sql:
WITH sorafenib_targets AS (
  SELECT DISTINCT i.targetID, i.target_uniprotID
  FROM `isb-cgc-bq.targetome_versioned.interactions_v1` i
  JOIN `isb-cgc-bq.targetome_versioned.experiments_v1` e ON i.expID = e.expID
  WHERE (
    LOWER(i.drugName) = 'sorafenib' OR
    LOWER(i.drugName) IN (
      SELECT LOWER(synonym)
      FROM `isb-cgc-bq.targetome_versioned.drug_synonyms_v1`
      WHERE LOWER(synonym) = 'sorafenib'
    )
  )
  AND LOWER(i.targetSpecies) = 'homo sapiens'
  AND e.exp_assayValueMedian <= 100
  AND (e.exp_assayValueLow <= 100 OR e.exp_assayValueLow IS NULL)
  AND (e.exp_assayValueHigh <= 100 OR e.exp_assayValueHigh IS NULL)
  AND i.target_uniprotID IS NOT NULL
),
all_physical_entities AS (
  SELECT DISTINCT pe.uniprot_id, pp.pathway_stable_id
  FROM `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe
  JOIN `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp ON pe.stable_id = pp.pe_stable_id
  JOIN `isb-cgc-bq.reactome_versioned.pathway_v77` p ON pp.pathway_stable_id = p.stable_id
  WHERE pp.evidence_code = 'TAS'
    AND p.lowest_level = TRUE
    AND LOWER(p.species) = 'homo sapiens'
),
target_uniprot_ids AS (
  SELECT DISTINCT target_uniprotID
  FROM sorafenib_targets
),
annotated_entities AS (
  SELECT
    pathway_stable_id,
    uniprot_id,
    CASE WHEN uniprot_id IN (SELECT target_uniprotID FROM target_uniprot_ids) THEN 1 ELSE 0 END AS is_target
  FROM all_physical_entities
),
counts_per_pathway AS (
  SELECT
    pathway_stable_id,
    SUM(is_target) AS target_count,
    SUM(1 - is_target) AS non_target_count,
    COUNT(*) AS total_count
  FROM annotated_entities
  GROUP BY pathway_stable_id
),
total_counts AS (
  SELECT
    SUM(target_count) AS total_target_count,
    SUM(non_target_count) AS total_non_target_count,
    SUM(total_count) AS grand_total_count
  FROM counts_per_pathway
),
expected_counts_per_pathway AS (
  SELECT
    cp.pathway_stable_id,
    cp.target_count,
    cp.non_target_count,
    cp.total_count,
    tc.total_target_count,
    tc.total_non_target_count,
    tc.grand_total_count,
    (cp.total_count * tc.total_target_count) / tc.grand_total_count AS expected_target_count,
    (cp.total_count * tc.total_non_target_count) / tc.grand_total_count AS expected_non_target_count
  FROM counts_per_pathway cp
  CROSS JOIN total_counts tc
),
chi_squared_per_pathway AS (
  SELECT
    pathway_stable_id,
    target_count,
    non_target_count,
    expected_target_count,
    expected_non_target_count,
    ((target_count - expected_target_count)*(target_count - expected_target_count))/expected_target_count +
    ((non_target_count - expected_non_target_count)*(non_target_count - expected_non_target_count))/expected_non_target_count AS chi_squared
  FROM expected_counts_per_pathway
  WHERE expected_target_count > 0 AND expected_non_target_count > 0
),
top_three_pathways AS (
  SELECT pathway_stable_id
  FROM chi_squared_per_pathway
  ORDER BY chi_squared DESC
  LIMIT 3
),
counts_within_top3 AS (
  SELECT 
    'Within Top 3 Pathways' AS `Group`,
    CASE WHEN is_target = 1 THEN 'Yes' ELSE 'No' END AS IsTarget,
    COUNT(*) AS `Count`
  FROM annotated_entities
  WHERE pathway_stable_id IN (SELECT pathway_stable_id FROM top_three_pathways)
  GROUP BY `Group`, IsTarget
),
counts_outside_top3 AS (
  SELECT 
    'Outside Top 3 Pathways' AS `Group`,
    CASE WHEN is_target = 1 THEN 'Yes' ELSE 'No' END AS IsTarget,
    COUNT(*) AS `Count`
  FROM annotated_entities
  WHERE pathway_stable_id NOT IN (SELECT pathway_stable_id FROM top_three_pathways)
  GROUP BY `Group`, IsTarget
)
SELECT *
FROM counts_within_top3
UNION ALL
SELECT *
FROM counts_outside_top3
ORDER BY `Group`, IsTarget;
2025-01-26 20:46:50 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:46:50 - root - INFO - ```sql
WITH sorafenib_targets AS (
  SELECT DISTINCT i.targetID, i.target_uniprotID
  FROM `isb-cgc-bq.targetome_versioned.interactions_v1` i
  JOIN `isb-cgc-bq.targetome_versioned.experiments_v1` e ON i.expID = e.expID
  WHERE LOWER(i.drugName) = 'sorafenib'
    AND LOWER(i.targetSpecies) = 'homo sapiens'
    AND e.exp_assayValueMedian <= 100
    AND (e.exp_assayValueLow <= 100 OR e.exp_assayValueLow IS NULL)
    AND (e.exp_assayValueHigh <= 100 OR e.exp_assayValueHigh IS NULL)
    AND i.target_uniprotID IS NOT NULL
),
all_physical_entities AS (
  SELECT DISTINCT pe.uniprot_id, pp.pathway_stable_id
  FROM `isb-cgc-bq.reactome_versioned.physical_entity_v77` pe
  JOIN `isb-cgc-bq.reactome_versioned.pe_to_pathway_v77` pp ON pe.stable_id = pp.pe_stable_id
  JOIN `isb-cgc-bq.reactome_versioned.pathway_v77` p ON pp.pathway_stable_id = p.stable_id
  WHERE pp.evidence_code = 'TAS'
    AND p.lowest_level = TRUE
    AND LOWER(p.species) = 'homo sapiens'
),
annotated_entities AS (
  SELECT
    pathway_stable_id,
    uniprot_id,
    CASE WHEN uniprot_id IN (SELECT target_uniprotID FROM sorafenib_targets) THEN 1 ELSE 0 END AS is_target
  FROM all_physical_entities
),
counts_per_pathway AS (
  SELECT
    pathway_stable_id,
    SUM(is_target) AS target_count,
    SUM(1 - is_target) AS non_target_count,
    COUNT(*) AS total_count
  FROM annotated_entities
  GROUP BY pathway_stable_id
),
total_counts AS (
  SELECT
    SUM(target_count) AS total_target_count,
    SUM(non_target_count) AS total_non_target_count,
    SUM(total_count) AS grand_total_count
  FROM counts_per_pathway
),
expected_counts_per_pathway AS (
  SELECT
    cp.pathway_stable_id,
    cp.target_count,
    cp.non_target_count,
    cp.total_count,
    tc.total_target_count,
    tc.total_non_target_count,
    tc.grand_total_count,
    (cp.total_count * tc.total_target_count) / tc.grand_total_count AS expected_target_count,
    (cp.total_count * tc.total_non_target_count) / tc.grand_total_count AS expected_non_target_count
  FROM counts_per_pathway cp
  CROSS JOIN total_counts tc
),
chi_squared_per_pathway AS (
  SELECT
    pathway_stable_id,
    target_count,
    non_target_count,
    expected_target_count,
    expected_non_target_count,
    ((target_count - expected_target_count)*(target_count - expected_target_count))/expected_target_count +
    ((non_target_count - expected_non_target_count)*(non_target_count - expected_non_target_count))/expected_non_target_count AS chi_squared
  FROM expected_counts_per_pathway
  WHERE expected_target_count > 0 AND expected_non_target_count > 0
),
top_three_pathways AS (
  SELECT pathway_stable_id
  FROM chi_squared_per_pathway
  ORDER BY chi_squared DESC
  LIMIT 3
),
counts_within_top3 AS (
  SELECT 
    'Within Top 3 Pathways' AS `Group`,
    CASE WHEN is_target = 1 THEN 'Yes' ELSE 'No' END AS IsTarget,
    COUNT(*) AS `Count`
  FROM annotated_entities
  WHERE pathway_stable_id IN (SELECT pathway_stable_id FROM top_three_pathways)
  GROUP BY `Group`, IsTarget
),
counts_outside_top3 AS (
  SELECT 
    'Outside Top 3 Pathways' AS `Group`,
    CASE WHEN is_target = 1 THEN 'Yes' ELSE 'No' END AS IsTarget,
    COUNT(*) AS `Count`
  FROM annotated_entities
  WHERE pathway_stable_id NOT IN (SELECT pathway_stable_id FROM top_three_pathways)
  GROUP BY `Group`, IsTarget
)
SELECT *
FROM counts_within_top3
UNION ALL
SELECT *
FROM counts_outside_top3
ORDER BY `Group`, IsTarget;
```
2025-01-26 20:46:53 - root - INFO - itercount: 2
2025-01-26 20:46:53 - root - INFO - 0
2025-01-26 20:46:53 - root - INFO - Total iteration counts: 2
