2025-01-28 04:45:27 - openai._base_client - INFO - Retrying request to /chat/completions in 0.471570 seconds
2025-01-28 04:46:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-28 04:46:13 - root - INFO - SQL:
SELECT DISTINCT strftime('%Y', "whsle_date") AS "Year"
   FROM "veg_whsle_df"
   WHERE "whsle_date" IS NOT NULL
   LIMIT 100;
Results:
Year
2020
2021
2022
2023

2025-01-28 04:46:13 - root - INFO - SQL:
SELECT DISTINCT "item_code", "item_name"
   FROM "veg_cat"
   WHERE "item_code" IS NOT NULL AND "item_name" IS NOT NULL
   LIMIT 100;
Results:
item_code,item_name
102900005115168,Niushou Shengcai
102900005115199,Sichuan Red Cedar
102900005115625,Local Xiaomao Cabbage
102900005115748,White Caitai
102900005115762,Amaranth
102900005115779,Yunnan Shengcai
102900005115786,Zhuyecai
102900005115793,Chinese Cabbage
102900005115816,Nanguajian
102900005115823,Shanghaiqing
102900005115854,Radish Leaves
102900005115861,Niushou Youcai
102900005115878,Garden Chrysanthemum
102900005115885,Caidian Quinoa Artemisia
102900005115908,Caixin
102900005115946,Muercai
102900005115960,Chinese Cabbage
102900005115977,Wandoujian
102900005115984,Yunnan Lettuces
102900005116639,Machixian
102900005116776,Local Spinach
102900005116790,Yellow Xincai (1)
102900005116806,Black Rapeseed
102900005118572,Local Shanghaiqing
102900005118817,Spinach
102900005118831,Wawacai
102900005119975,Hongshujian
102900005122654,Zhijiang Red Bolt
102900005128748,Huanghuacai
102900011000175,Kuaicai
102900011000571,Suizhou Bubble Green
102900011002414,Panax Notoginseng
102900011006689,Dongmenkou Xiaobaicai
102900011006948,Foreign Garland Chrysanthemum 
102900011006955,Ice Grass
102900011007464,Perilla
102900011007471,Mint
102900011007495,The Dandelion
102900011008133,Siguajian
102900011008164,Naibaicai
102900011008485,Mustard
102900011008492,Big Broccoli
102900011008515,Miantiaocai
102900011008522,Sweet Chinese Cabbage
102900011008676,Jicai
102900011015384,Malan Head
102900011015391,Ganlanye
102900011021644,Hongshan Caitai
102900011022849,The Local Yellow Youcai
102900011022924,Green Caitai
102900011023464,Xiaoqingcai (1)
102900011026502,Fresh Rice Dumplings Leaves
102900011026618,Aihao
102900011027462,Naibai Caimiao
102900011027615,Juhua Youcai
102900011029688,Shuanggou Cabbage
102900011030042,Zhijiang Red Bolt (Bag)
102900011030059,Yunnan Lettuce (Bag)
102900011030097,Yunnan Leaf Lettuce (Bag)
102900011030103,Garden Chrysanthemum (Bag)
102900011030110,Spinach (Bag)
102900011030134,Caixin (Bag)
102900011030141,Shanghai Green (Bag)
102900011030158,Xiaoqingcai (2)
102900011030400,Hongshan Shoutidai
102900011030417,Hongshan Gift Box
102900011030905,Yuxingcao (Bag)
102900011031216,Ice Grass (Box)
102900011032176,Basil (Bag)
102900011032282,Xiangtianhongcaitai (Bag)
102900011032480,Artemisia Stelleriana
102900011032589,Yuxingcao 
102900011032787,Zhuyecai (Bag)
102900011033081,Chuncai
102900011033173,Sophora Japonica
102900011033234,Hongshujian (Bag)
102900011033241,Caidian Quinoa Artemisia (Bag)
102900011033531,Red Coral (Leaf)
102900011033562,Red Oak Leaf
102900011033586,Green Butter
102900011033906,Powcan Mountain Chinese Cabbage 
102900011033920,Huangxincai (2)
102900011034200,Amaranth (Bag)
102900011034217,Chinese Cabbage (Bag)
102900011034224,Xiaoqingcai (Bag)
102900011034231,Cabbage Stem (Bag)
102900011034316,Zhimaxiancai
102900011034323,Xianzongye
102900011034354,Xianzongye (Bag) (1)
102900011035481,Foreign Garland Chrysanthemum  (Bag)
102900011035764,Longyacai
102900011035771,Yellow Baicai (1)
102900011035849,Chinese Cabbage Seedling
102900011036686,Muercai (Bag)
102900051000890,Broccoli
102900051009220,Youcaitai
102900051010455,Huangbaicai (2)
102900051010790,Purple Beicai
106971563780002,Xianzongye (Bag) (2)
106972776821582,Xianzongye (Bag) (3)

2025-01-28 04:46:13 - root - INFO - SQL:
SELECT DISTINCT "category_name"
   FROM "veg_cat"
   WHERE "category_name" IS NOT NULL
   LIMIT 100;
Results:
category_name
Flower/Leaf Vegetables
Cabbage
Aquatic Tuberous Vegetables
Solanum
Capsicum
Edible Mushroom

2025-01-28 04:46:13 - root - INFO - SQL:
SELECT "whsle_date", "item_code", "whsle_px_rmb-kg"
   FROM "veg_whsle_df"
   WHERE "whsle_px_rmb-kg" IS NOT NULL
   LIMIT 100;
Results:
whsle_date,item_code,whsle_px_rmb-kg
2020-07-01 00:00:00,102900005115762,3.88
2020-07-01 00:00:00,102900005115779,6.72
2020-07-01 00:00:00,102900005115786,3.19
2020-07-01 00:00:00,102900005115793,9.24
2020-07-01 00:00:00,102900005115823,7.03
2020-07-01 00:00:00,102900005115908,4.6
2020-07-01 00:00:00,102900005115946,4.2
2020-07-01 00:00:00,102900005115960,2.1
2020-07-01 00:00:00,102900005115984,3.44
2020-07-01 00:00:00,102900005116226,4.64
2020-07-01 00:00:00,102900005116233,5.76
2020-07-01 00:00:00,102900005116257,6.56
2020-07-01 00:00:00,102900005116509,1.63
2020-07-01 00:00:00,102900005116530,10.8
2020-07-01 00:00:00,102900005116547,4.06
2020-07-01 00:00:00,102900005116714,9.23
2020-07-01 00:00:00,102900005116790,3.97
2020-07-01 00:00:00,102900005116912,8.16
2020-07-01 00:00:00,102900005116943,7.83
2020-07-01 00:00:00,102900005117056,4.32
2020-07-01 00:00:00,102900005117209,7.58
2020-07-01 00:00:00,102900005118817,8.47
2020-07-01 00:00:00,102900005118824,5.65
2020-07-01 00:00:00,102900005118831,4.13
2020-07-01 00:00:00,102900005119944,10.29
2020-07-01 00:00:00,102900005119975,3.6
2020-07-01 00:00:00,102900005123880,7.5
2020-07-01 00:00:00,102900005125808,12.1
2020-07-01 00:00:00,102900005125815,6.16
2020-07-01 00:00:00,102900011001219,8.24
2020-07-01 00:00:00,102900011006948,11.69
2020-07-01 00:00:00,102900011008522,4.44
2020-07-01 00:00:00,102900011009970,6.03
2020-07-01 00:00:00,102900051000944,29.43
2020-07-01 00:00:00,102900051004294,6.81
2020-07-01 00:00:00,102900051010455,4.63
2020-07-02 00:00:00,102900005115762,3.93
2020-07-02 00:00:00,102900005115779,4.23
2020-07-02 00:00:00,102900005115786,3.18
2020-07-02 00:00:00,102900005115793,9.19
2020-07-02 00:00:00,102900005115823,7.03
2020-07-02 00:00:00,102900005115908,4.52
2020-07-02 00:00:00,102900005115946,4.23
2020-07-02 00:00:00,102900005115960,2.1
2020-07-02 00:00:00,102900005115984,3.58
2020-07-02 00:00:00,102900005116226,4.57
2020-07-02 00:00:00,102900005116233,5.71
2020-07-02 00:00:00,102900005116257,3.72
2020-07-02 00:00:00,102900005116509,1.46
2020-07-02 00:00:00,102900005116530,10.8
2020-07-02 00:00:00,102900005116547,4.05
2020-07-02 00:00:00,102900005116714,8.9
2020-07-02 00:00:00,102900005116790,3.97
2020-07-02 00:00:00,102900005116912,8.05
2020-07-02 00:00:00,102900005116943,7.27
2020-07-02 00:00:00,102900005117056,4.48
2020-07-02 00:00:00,102900005117209,7.33
2020-07-02 00:00:00,102900005118817,7.88
2020-07-02 00:00:00,102900005118824,5.76
2020-07-02 00:00:00,102900005118831,4.11
2020-07-02 00:00:00,102900005119944,10.13
2020-07-02 00:00:00,102900005119975,3.6
2020-07-02 00:00:00,102900005123880,6.46
2020-07-02 00:00:00,102900005125808,12.13
2020-07-02 00:00:00,102900005125815,6.15
2020-07-02 00:00:00,102900011000328,7.1
2020-07-02 00:00:00,102900011001219,8.24
2020-07-02 00:00:00,102900011006689,6.83
2020-07-02 00:00:00,102900011006948,11.75
2020-07-02 00:00:00,102900011008522,4.44
2020-07-02 00:00:00,102900011009970,5.52
2020-07-02 00:00:00,102900051000944,29.54
2020-07-02 00:00:00,102900051004294,6.85
2020-07-02 00:00:00,102900051010455,4.76
2020-07-03 00:00:00,102900005115762,3.57
2020-07-03 00:00:00,102900005115779,4.61
2020-07-03 00:00:00,102900005115786,3.79
2020-07-03 00:00:00,102900005115793,9.2
2020-07-03 00:00:00,102900005115823,6.76
2020-07-03 00:00:00,102900005115908,3.89
2020-07-03 00:00:00,102900005115946,4.3
2020-07-03 00:00:00,102900005115960,2.11
2020-07-03 00:00:00,102900005115984,3.75
2020-07-03 00:00:00,102900005116226,4.42
2020-07-03 00:00:00,102900005116233,5.7
2020-07-03 00:00:00,102900005116257,6.56
2020-07-03 00:00:00,102900005116509,1.48
2020-07-03 00:00:00,102900005116530,10.8
2020-07-03 00:00:00,102900005116547,4.05
2020-07-03 00:00:00,102900005116714,8.97
2020-07-03 00:00:00,102900005116790,3.98
2020-07-03 00:00:00,102900005116912,7.9
2020-07-03 00:00:00,102900005116943,6.75
2020-07-03 00:00:00,102900005117056,5.31
2020-07-03 00:00:00,102900005117209,6.21
2020-07-03 00:00:00,102900005118824,5.61
2020-07-03 00:00:00,102900005118831,4.05
2020-07-03 00:00:00,102900005119944,10.05
2020-07-03 00:00:00,102900005119975,3.6
2020-07-03 00:00:00,102900005123880,6.23

2025-01-28 04:46:13 - root - INFO - SQL:
SELECT "txn_date", "item_code", "unit_selling_px_rmb/kg", "qty_sold(kg)"
   FROM "veg_txn_df"
   WHERE "unit_selling_px_rmb/kg" IS NOT NULL AND "qty_sold(kg)" IS NOT NULL
   LIMIT 100;
Results:
txn_date,item_code,unit_selling_px_rmb/kg,qty_sold(kg)
2020-07-01 00:00:00,102900005117056,7.6,0.396
2020-07-01 00:00:00,102900005115960,3.2,0.849
2020-07-01 00:00:00,102900005117056,7.6,0.409
2020-07-01 00:00:00,102900005115823,10.0,0.421
2020-07-01 00:00:00,102900005115908,8.0,0.539
2020-07-01 00:00:00,102900005117056,7.6,0.277
2020-07-01 00:00:00,102900005115779,8.0,0.338
2020-07-01 00:00:00,102900005117056,7.6,0.132
2020-07-01 00:00:00,102900005115779,8.0,0.213
2020-07-01 00:00:00,102900011008522,8.0,0.514
2020-07-01 00:00:00,102900005118824,10.0,0.251
2020-07-01 00:00:00,102900005115984,6.0,0.251
2020-07-01 00:00:00,102900005116530,18.0,0.217
2020-07-01 00:00:00,102900005115984,6.0,0.468
2020-07-01 00:00:00,102900005116226,8.0,0.589
2020-07-01 00:00:00,102900005118824,10.0,0.711
2020-07-01 00:00:00,102900005115779,8.0,1.003
2020-07-01 00:00:00,102900005116530,18.0,0.095
2020-07-01 00:00:00,102900005116233,10.0,0.15
2020-07-01 00:00:00,102900005115984,6.0,0.502
2020-07-01 00:00:00,102900005115984,6.0,0.452
2020-07-01 00:00:00,102900005115908,8.0,0.501
2020-07-01 00:00:00,102900005115779,8.0,0.201
2020-07-01 00:00:00,102900005115779,8.0,0.439
2020-07-01 00:00:00,102900005115762,6.0,0.686
2020-07-01 00:00:00,102900005116714,14.0,0.329
2020-07-01 00:00:00,102900005115908,8.0,0.251
2020-07-01 00:00:00,102900005118817,14.0,0.243
2020-07-01 00:00:00,102900005116530,18.0,0.256
2020-07-01 00:00:00,102900005115984,6.0,0.318
2020-07-01 00:00:00,102900011009970,9.0,0.445
2020-07-01 00:00:00,102900005115779,8.0,0.363
2020-07-01 00:00:00,102900005117209,16.0,0.482
2020-07-01 00:00:00,102900011001219,14.0,0.343
2020-07-01 00:00:00,102900005115984,6.0,0.502
2020-07-01 00:00:00,102900005115779,8.0,0.301
2020-07-01 00:00:00,102900005117056,7.6,0.198
2020-07-01 00:00:00,102900051004294,14.0,0.172
2020-07-01 00:00:00,102900005117056,7.6,0.66
2020-07-01 00:00:00,102900005115984,6.0,0.753
2020-07-01 00:00:00,102900005115984,6.0,0.552
2020-07-01 00:00:00,102900051004294,14.0,0.057
2020-07-01 00:00:00,102900005115960,3.2,1.101
2020-07-01 00:00:00,102900005116547,6.0,0.435
2020-07-01 00:00:00,102900005115984,6.0,0.201
2020-07-01 00:00:00,102900005116547,6.0,0.452
2020-07-01 00:00:00,102900005115984,6.0,0.385
2020-07-01 00:00:00,102900005116714,14.0,0.522
2020-07-01 00:00:00,102900005115984,6.0,0.435
2020-07-01 00:00:00,102900051000944,39.8,0.545
2020-07-01 00:00:00,102900011009970,9.0,0.368
2020-07-01 00:00:00,102900005115908,8.0,0.313
2020-07-01 00:00:00,102900005115779,8.0,0.276
2020-07-01 00:00:00,102900005116547,6.0,0.217
2020-07-01 00:00:00,102900005116714,14.0,0.236
2020-07-01 00:00:00,102900011008522,8.0,0.451
2020-07-01 00:00:00,102900005116530,18.0,0.184
2020-07-01 00:00:00,102900005115984,6.0,0.418
2020-07-01 00:00:00,102900005115984,6.0,0.502
2020-07-01 00:00:00,102900005116547,6.0,0.468
2020-07-01 00:00:00,102900005119975,6.0,0.234
2020-07-01 00:00:00,102900005125815,10.0,0.301
2020-07-01 00:00:00,102900005115786,6.0,0.786
2020-07-01 00:00:00,102900011009970,9.0,0.401
2020-07-01 00:00:00,102900005115960,3.2,0.629
2020-07-01 00:00:00,102900011009970,9.0,0.457
2020-07-01 00:00:00,102900005116714,14.0,0.401
2020-07-01 00:00:00,102900005117056,7.6,0.554
2020-07-01 00:00:00,102900051010455,9.0,0.969
2020-07-01 00:00:00,102900005119975,6.0,0.468
2020-07-01 00:00:00,102900005117056,7.6,0.145
2020-07-01 00:00:00,102900005115779,8.0,0.251
2020-07-01 00:00:00,102900005116509,4.0,0.829
2020-07-01 00:00:00,102900005117056,7.6,0.581
2020-07-01 00:00:00,102900005116509,4.0,0.402
2020-07-01 00:00:00,102900005115762,6.0,0.702
2020-07-01 00:00:00,102900051010455,9.0,0.768
2020-07-01 00:00:00,102900005119975,6.0,0.234
2020-07-01 00:00:00,102900005115984,6.0,0.769
2020-07-01 00:00:00,102900005116714,14.0,0.329
2020-07-01 00:00:00,102900005115984,6.0,0.585
2020-07-01 00:00:00,102900005116509,4.0,0.402
2020-07-01 00:00:00,102900005115762,6.0,0.636
2020-07-01 00:00:00,102900005116530,18.0,0.095
2020-07-01 00:00:00,102900005115779,8.0,0.426
2020-07-01 00:00:00,102900005116509,4.0,0.427
2020-07-01 00:00:00,102900005115984,6.0,0.636
2020-07-01 00:00:00,102900005116530,18.0,0.312
2020-07-01 00:00:00,102900051004294,14.0,0.372
2020-07-01 00:00:00,102900005117056,7.6,0.515
2020-07-01 00:00:00,102900005116943,18.0,0.339
2020-07-01 00:00:00,102900005115960,3.2,1.321
2020-07-01 00:00:00,102900005116714,14.0,0.386
2020-07-01 00:00:00,102900005116257,6.0,0.585
2020-07-01 00:00:00,102900005125808,25.8,0.182
2020-07-01 00:00:00,102900005115779,8.0,0.476
2020-07-01 00:00:00,102900005125808,25.8,0.058
2020-07-01 00:00:00,102900005125815,10.0,0.2
2020-07-01 00:00:00,102900005115779,8.0,0.338
2020-07-01 00:00:00,102900011009970,9.0,0.523

2025-01-28 04:46:13 - root - INFO - SQL:
SELECT "item_code", "item_name", "loss_rate_%"
   FROM "veg_loss_rate_df"
   WHERE "loss_rate_%" IS NOT NULL
   LIMIT 100;
Results:
item_code,item_name,loss_rate_%
102900005115168,Niushou Shengcai,4.39
102900005115199,Sichuan Red Cedar,10.46
102900005115250,Xixia Black Mushroom (1),10.8
102900005115625,Local Xiaomao Cabbage,0.18
102900005115748,White Caitai,8.78
102900005115762,Amaranth,18.52
102900005115779,Yunnan Shengcai,15.25
102900005115786,Zhuyecai,13.62
102900005115793,Chinese Cabbage,7.59
102900005115816,Nanguajian,13.46
102900005115823,Shanghaiqing,14.43
102900005115854,Radish Leaves,5.35
102900005115861,Niushou Youcai,12.17
102900005115878,Garden Chrysanthemum,6.27
102900005115885,Caidian Quinoa Artemisia,0.47
102900005115908,Caixin,13.7
102900005115946,Muercai,7.61
102900005115960,Chinese Cabbage,22.27
102900005115977,Wandoujian,8.36
102900005115984,Yunnan Lettuces,12.81
102900005116042,Lotus Root,15.32
102900005116219,Red Hot Peppers,6.73
102900005116226,Green Hot Peppers,6.72
102900005116233,Red Pepper (1),11.76
102900005116257,Eggplant (2),6.07
102900005116509,Green Eggplant (1),5.01
102900005116530,Xixia Mushroom (1),13.82
102900005116547,Needle Mushroom (1),3.43
102900005116639,Machixian,11.78
102900005116714,Broccoli,9.26
102900005116776,Local Spinach,10.46
102900005116790,Yellow Xincai (1),10.64
102900005116806,Black Rapeseed,0.1
102900005116837,Ping Mushroom,11.6
102900005116899,Net Lotus Root (1),5.54
102900005116905,Green Hangjiao (1),0.0
102900005116912,Jigu Mushroom (1),8.99
102900005116943,Red Hang Pepper,9.99
102900005117056,Paopaojiao (Jingpin),7.08
102900005117209,7 Colour Pepper (1),15.98
102900005117353,The White Mushroom (1),9.43
102900005118572,Local Shanghaiqing,11.99
102900005118817,Spinach,18.51
102900005118824,High Melon (1),29.25
102900005118831,Wawacai,2.48
102900005119098,The Agaricus Bisporus,12.78
102900005119104,The Crab Flavor Mushroom (1),9.24
102900005119944,Haixian Mushroom (1),9.89
102900005119968,Green Hangzhou Pepper (2),9.0
102900005119975,Hongshujian,8.42
102900005122654,Zhijiang Red Bolt,11.38
102900005123880,Bell Pepper (1),16.33
102900005125808,Millet Pepper,5.86
102900005125815,Apricot Bao Mushroom (1),5.05
102900005128748,Huanghuacai,16.89
102900011000175,Kuaicai,20.38
102900011000328,Luosi Pepper,10.18
102900011000335,Round Eggplant,0.32
102900011000571,Suizhou Bubble Green,12.2
102900011000632,Purple Cabbage (1),25.53
102900011000861,Red Line Pepper,7.71
102900011001219,The Red Bell Pepper (1),8.93
102900011001561,Lotus (Ea),12.17
102900011001691,Water Chestnut (Lingjiao),9.61
102900011001806,Jigu Mushroom (Bunch),12.42
102900011001813,Needle Mushroom (Bag) (1),8.85
102900011002414,Panax Notoginseng,16.95
102900011006689,Dongmenkou Xiaobaicai,27.84
102900011006948,Foreign Garland Chrysanthemum ,26.16
102900011006955,Ice Grass,15.01
102900011007044,Tremella (Flower),9.14
102900011007464,Perilla,12.88
102900011007471,Mint,13.28
102900011007495,The Dandelion,15.92
102900011007969,Red Lotus Root Zone,16.63
102900011008133,Siguajian,15.98
102900011008164,Naibaicai,15.68
102900011008485,Mustard,13.75
102900011008492,Big Broccoli,4.69
102900011008515,Miantiaocai,12.8
102900011008522,Sweet Chinese Cabbage,9.43
102900011008577,Hericium ,16.19
102900011008676,Jicai,11.56
102900011009246,Fresh Black Fungus (1),7.63
102900011009277,Water Chestnut,11.02
102900011009444,Dalong Eggplant,10.94
102900011009772,Fruit Pepper (Orange),9.43
102900011009970,Qinggengsanhua,17.06
102900011010563,Chicken Fir Bacteria,11.93
102900011010891,Wild Lotus Root (1),7.97
102900011011058,Black Porcini,10.17
102900011011546,Haixian Mushroom (Bag) (1),5.96
102900011011669,Xiuzhen Mushroom,11.93
102900011011782,Chinese Caterpillar Fungus Flowers (Box) (1),11.93
102900011012482,Tea Tree Mushroom (Bag),9.97
102900011012871,Black Chicken  Mushroom,11.03
102900011012994,Apricot Bao Mushroom (Bag),10.03
102900011013274,The White Mushroom (Bag),6.57
102900011015384,Malan Head,15.16
102900011015391,Ganlanye,11.58

2025-01-28 04:46:13 - root - INFO - SQL:
SELECT w."whsle_date", w."item_code", c."category_name", w."whsle_px_rmb-kg"
   FROM "veg_whsle_df" AS w
   INNER JOIN "veg_cat" AS c ON w."item_code" = c."item_code"
   WHERE w."whsle_px_rmb-kg" IS NOT NULL
   LIMIT 100;
Results:
Too long, hard cut:
whsle_date,item_code,category_name,whsle_px_rmb-kg
2020-07-01 00:00:00,102900005115762,Flower/Leaf Vegetables,3.88
2020-07-01 00:00:00,102900005115779,Flower/Leaf Vegetables,6.72
2020-07-01 00:00:00,102900005115786,Flower/Leaf Vegetables,3.19
2020-07-01 00:00:00,102900005115793,Flower/Leaf Vegetables,9.24
2020-07-01 00:00:00,102900005115823,Flower/Leaf Vegetables,7.03
2020-07-01 00:00:00,102900005115908,Flower/Leaf Vegetables,4.6
2020-07-01 00:00:00,102900005115946,Flower/Leaf Vegetables,4.2
2020-07-01 00:00:00,102900005115960,Flower/Leaf Vegetables,2.1
2020-07-01 00:00:00,102900005115984,Flower/Leaf Vegetables,3.44
2020-07-01 00:00:00,102900005116226,Capsicum,4.64
2020-07-01 00:00:00,102900005116233,Capsicum,5.76
2020-07-01 00:00:00,102900005116257,Solanum,6.56
2020-07-01 00:00:00,102900005116509,Solanum,1.63
2020-07-01 00:00:00,102900005116530,Edible Mushroom,10.8
2020-07-01 00:00:00,102900005116547,Edible Mushroom,4.06
2020-07-01 00:00:00,102900005116714,Cabbage,9.23
2020-07-01 00:00:00,102900005116790,Flower/Leaf Vegetables,3.97
2020-07-01 00:00:00,102900005116912,Edible Mushroom,8.16
2020-07-01 00:00:00,102900005116943,Capsicum,7.83
2020-07-01 00:00:00,102900005117056,Capsicum,4.32
2020-07-01 00:00:00,102900005117209,Capsicum,7.58
2020-07-01 00:00:00,102900005118817,Flower/Leaf Vegetables,8.47
2020-07-01 00:00:00,102900005118824,Aquatic Tuberous Vegetables,5.65
2020-07-01 00:00:00,102900005118831,Flower/Leaf Vegetables,4.13
2020-07-01 00:00:00,102900005119944,Edible Mushroom,10.29
2020-07-01 00:00:00,102900005119975,Flower/Leaf Vegetables,3.6
2020-07-01 00:00:00,102900005123880,Capsicum,7.5
2020-07-01 00:00:00,102900005125808,Capsicum,12.1
2020-07-01 00:00:00,102900005125815,Edible Mushroom,6.16
2020-07-01 00:00:00,102900011001219,Capsicum,8.24
2020-07-01 00:00:00,102900011006948,Flower/Leaf Vegetables,11.69
2020-07-01 00:00:00,102900011008522,Flower/Leaf Vegetables,4.44
2020-07-01 00:00:00,102900011009970,Cabbage,6.03
2020-07-01 00:00:00,102900051000944,Aquatic Tuberous Vegetables,29.43
2020-07-01 00:00:00,102900051004294,Capsicum,6.81
2020-07-01 00:00:00,102900051010455,Flower/Leaf Vegetables,4.63
2020-07-02 00:00:00,102900005115762,Flower/Leaf Vegetables,3.93
2020-07-02 00:00:00,102900005115779,Flower/Leaf Vegetables,4.23
2020-07-02 00:00:00,102900005115786,Flower/Leaf Vegetables,3.18
2020-07-02 00:00:00,102900005115793,Flower/Leaf Vegetables,9.19
2020-07-02 00:00:00,102900005115823,Flower/Leaf Vegetables,7.03
2020-07-02 00:00:00,102900005115908,Flower/Leaf Vegetables,4.52
2020-07-02 00:00:00,102900005115946,Flower/Leaf Vegetables,4.23
2020-07-02 00:00:00,102900005115960,Flower/Leaf Vegetables,2.1
2020-07-02 00:00:00,102900005115984,Flower/Leaf Vegetables,3.58
2020-07-02 00:00:00,102900005116226,Capsicum,4.57
2020-07-02 00:00:00,102900005116233,Capsicum,5.71
2020-07-02 00:00:00,102900005116257,Solanum,3.72
2020-07-02 00:00:00,102900005116509,Solanum,1.46
2020-07-02 00:00:00,102900005116530,Edible Mushroom,10.8
2020-07-02 00:00:00,102900005116547,Edible Mushroom,4.05
2020-07-02 00:00:00,102900005116714,Cabbage,8.9
2020-07-02 00:00:00,102900005116790,Flower/Leaf Vegetables,3.97
2020-07-02 00:00:00,102900005116912,Edible Mushroom,8.05
2020-07-02 00:00:00,102900005116943,Capsicum,7.27
2020-07-02 00:00:00,102900005117056,Capsicum,4.48
2020-07-02 00:00:00,102900005117209,Capsicum,7.33
2020-07-02 00:00:00,102900005118817,Flower/Leaf Vegetables,7.88
2020-07-02 00:00:00,102900005118824,Aquatic Tuberous Vegetables,5.76
2020-07-02 00:00:00,102900005118831,Flower/Leaf Vegetables,4.11
2020-07-02 00:00:00,102900005119944,Edible Mushroom,10.13
2020-07-02 00:00:00,102900005119975,Flower/Leaf Vegetables,3.6
2020-07-02 00:00:00,102900005123880,Capsicum,6.46
2020-07-02 00:00:00,102900005125808,Capsicum,12.13
2020-07-02 00:00:00,102900005125815,Edible Mushroom,6.15
2020-07-02 00:00:00,102900011000328,Capsicum,7.1
2020-07-02 00:00:00,102900011001219,Capsicum,8.24
2020-07-02 00:00:00,102900011006689,Flower/Leaf Vegetables,6.83
2020-07-02 00:00:00,102900011006948,Flower/Leaf Vegetables,11.75
2020-07-02 00:00:00,102900011008522,Flower/Leaf Vegetables,4.44
2020-07-02 00:00:00,102900011009970,Cabbage,5.52
2020-07-02 00:00:00,102900051000944,Aquatic Tuberous Vegetables,29.54
2020-07-02 00:00:00,102900051004294,Capsicum,6.85
2020-07-02 00:00:00,102900051010455,Flower/Leaf Vegetables,4.76
2020-07-03 00:00:00,102900005115762,Flower/Leaf Vegetables,3.57
2020-07-03 00:00:00,102900005115779,Flower/Leaf Vegetables,4.61
2020-07-03 00:00:00,102900005115786,Flower/Leaf Vegetables,3.79
2020-07-03 00:00:00,102900005115793,Flower/Leaf Vegetables,9.2
2020-07-03 00:00:00,102900005115823,Flower/Leaf Vegetables,6.76
2020-07-03 00:00:00,102900005115908,Flower/Leaf Vegetables,3.89
2020-07-03 00:00:00,102900005115946,Flower/Leaf Vegetables,4.3
2020-07-03 00:00:00,102900005115960,Flower/Leaf Vegetables,2.11
2020-07-03 00:00:00,102900005115984,Flower/Leaf Vegetables,3.75
2020-07-03 00:00:00,102900005116226,Capsicum,4.42
2020-07-03 00:00:00,1029000

2025-01-28 04:46:15 - root - INFO - SQL:
SELECT "item_code", SUM("qty_sold(kg)") AS "Total_Qty_Sold"
   FROM "veg_txn_df"
   WHERE "qty_sold(kg)" IS NOT NULL
   GROUP BY "item_code"
   LIMIT 100;
Results:
item_code,Total_Qty_Sold
102900005115168,899.8369999999926
102900005115199,333.2229999999997
102900005115250,2810.715999999994
102900005115625,121.01999999999997
102900005115748,718.6759999999995
102900005115762,5100.061000000054
102900005115779,15910.461000000087
102900005115786,7240.764000000127
102900005115793,1707.3030000000058
102900005115816,18.427999999999997
102900005115823,7606.756000000144
102900005115854,415.3249999999997
102900005115861,3836.5659999999516
102900005115878,4110.161999999955
102900005115885,939.5750000000013
102900005115908,4496.717000000026
102900005115946,1566.6399999999949
102900005115960,19187.218000000375
102900005115977,85.04799999999996
102900005115984,10305.364000000254
102900005116219,438.5929999999993
102900005116226,1186.5310000000086
102900005116233,3457.8749999999845
102900005116257,13602.00100000012
102900005116509,3516.7630000000017
102900005116530,11920.227000000103
102900005116547,4697.469999999988
102900005116639,94.31500000000001
102900005116714,27537.227999999166
102900005116790,2911.298999999998
102900005116806,101.12500000000004
102900005116837,2542.9590000000007
102900005116899,27149.44000000034
102900005116905,1.817
102900005116912,375.22200000000095
102900005116943,658.5600000000022
102900005117056,9703.125000000142
102900005117209,263.19199999999995
102900005117353,22.0
102900005118572,596.6969999999978
102900005118817,5216.4610000000885
102900005118824,1179.652000000004
102900005118831,8982.0
102900005119098,627.7179999999994
102900005119104,102.0
102900005119944,502.16500000000093
102900005119968,128.49999999999997
102900005119975,5159.433000000111
102900005122654,4962.4540000000015
102900005123880,212.04299999999992
102900005125808,1447.3529999999964
102900005125815,2404.977000000032
102900005128748,1.7839999999999996
102900011000175,91.27200000000008
102900011000328,7792.181000000182
102900011000335,7.658
102900011000571,675.2210000000007
102900011000632,13.251000000000001
102900011000861,27.713000000000026
102900011001219,278.61199999999997
102900011001561,2095.0
102900011001691,126.42200000000003
102900011001806,1071.0
102900011001813,2149.0
102900011002414,45.251999999999995
102900011006689,1543.4780000000026
102900011006948,732.6150000000006
102900011006955,16.337
102900011007044,287.0
102900011007464,30.172000000000004
102900011007471,7.5680000000000005
102900011007495,4.232
102900011007969,100.46900000000015
102900011008133,14.226999999999999
102900011008164,5816.308000000122
102900011008485,51.73500000000001
102900011008492,7.48
102900011008515,12.936000000000002
102900011008522,4685.261000000009
102900011008577,3.0
102900011008676,15.886999999999997
102900011009246,212.1709999999997
102900011009277,1671.4240000000004
102900011009444,1167.2180000000023
102900011009772,0.415
102900011009970,8393.786000000093
102900011010563,1.2149999999999999
102900011010891,448.8599999999998
102900011011058,1.084
102900011011546,1266.0
102900011011669,14.708000000000002
102900011012482,90.0
102900011012871,5.795000000000002
102900011012994,1343.0
102900011013274,2927.0
102900011015384,3.3899999999999997
102900011015391,0.9430000000000001
102900011016701,28164.33100000042
102900011016909,101.37900000000002
102900011018095,978.0

2025-01-28 04:46:15 - root - INFO - SQL:
SELECT t."txn_date", c."category_name", t."item_code", t."qty_sold(kg)"
   FROM "veg_txn_df" AS t
   INNER JOIN "veg_cat" AS c ON t."item_code" = c."item_code"
   WHERE t."qty_sold(kg)" IS NOT NULL
   LIMIT 100;
Results:
Too long, hard cut:
txn_date,category_name,item_code,qty_sold(kg)
2020-07-01 00:00:00,Capsicum,102900005117056,0.396
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115960,0.849
2020-07-01 00:00:00,Capsicum,102900005117056,0.409
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115823,0.421
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115908,0.539
2020-07-01 00:00:00,Capsicum,102900005117056,0.277
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115779,0.338
2020-07-01 00:00:00,Capsicum,102900005117056,0.132
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115779,0.213
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900011008522,0.514
2020-07-01 00:00:00,Aquatic Tuberous Vegetables,102900005118824,0.251
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.251
2020-07-01 00:00:00,Edible Mushroom,102900005116530,0.217
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.468
2020-07-01 00:00:00,Capsicum,102900005116226,0.589
2020-07-01 00:00:00,Aquatic Tuberous Vegetables,102900005118824,0.711
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115779,1.003
2020-07-01 00:00:00,Edible Mushroom,102900005116530,0.095
2020-07-01 00:00:00,Capsicum,102900005116233,0.15
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.502
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.452
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115908,0.501
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115779,0.201
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115779,0.439
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115762,0.686
2020-07-01 00:00:00,Cabbage,102900005116714,0.329
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115908,0.251
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005118817,0.243
2020-07-01 00:00:00,Edible Mushroom,102900005116530,0.256
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.318
2020-07-01 00:00:00,Cabbage,102900011009970,0.445
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115779,0.363
2020-07-01 00:00:00,Capsicum,102900005117209,0.482
2020-07-01 00:00:00,Capsicum,102900011001219,0.343
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.502
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115779,0.301
2020-07-01 00:00:00,Capsicum,102900005117056,0.198
2020-07-01 00:00:00,Capsicum,102900051004294,0.172
2020-07-01 00:00:00,Capsicum,102900005117056,0.66
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.753
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.552
2020-07-01 00:00:00,Capsicum,102900051004294,0.057
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115960,1.101
2020-07-01 00:00:00,Edible Mushroom,102900005116547,0.435
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.201
2020-07-01 00:00:00,Edible Mushroom,102900005116547,0.452
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.385
2020-07-01 00:00:00,Cabbage,102900005116714,0.522
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.435
2020-07-01 00:00:00,Aquatic Tuberous Vegetables,102900051000944,0.545
2020-07-01 00:00:00,Cabbage,102900011009970,0.368
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115908,0.313
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115779,0.276
2020-07-01 00:00:00,Edible Mushroom,102900005116547,0.217
2020-07-01 00:00:00,Cabbage,102900005116714,0.236
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900011008522,0.451
2020-07-01 00:00:00,Edible Mushroom,102900005116530,0.184
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.418
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.502
2020-07-01 00:00:00,Edible Mushroom,102900005116547,0.468
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005119975,0.234
2020-07-01 00:00:00,Edible Mushroom,102900005125815,0.301
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115786,0.786
2020-07-01 00:00:00,Cabbage,102900011009970,0.401
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115960,0.629
2020-07-01 00:00:00,Cabbage,102900011009970,0.457
2020-07-01 00:00:00,Cabbage,102900005116714,0.401
2020-07-01 00:00:00,Capsicum,102900005117056,0.554
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900051010455,0.969
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005119975,0.468
2020-07-01 00:00:00,Capsicum,102900005117056,0.145
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115779,0.251
2020-07-01 00:00:00,Solanum,102900005116509,0.829
2020-07-01 00:00:00,Capsicum,102900005117056,0.581
2020-07-01 00:00:00,Solanum,102900005116509,0.402
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115762,0.702
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900051010455,0.768
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005119975,0.234
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.769
2020-07-01 00:00:00,Cabbage,102900005116714,0.329
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.585
2020-07-01 00:00:00,Solanum,102900005116509,0.402
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115762,0.636

2025-01-28 04:46:15 - root - INFO - SQL:
SELECT strftime('%Y', w."whsle_date") AS "Year", c."category_name",
           ROUND(AVG(w."whsle_px_rmb-kg"), 2) AS "Avg_Wholesale_Price"
    FROM "veg_whsle_df" AS w
    INNER JOIN "veg_cat" AS c ON w."item_code" = c."item_code"
    WHERE w."whsle_date" BETWEEN '2020-01-01' AND '2023-12-31'
    GROUP BY "Year", c."category_name"
    LIMIT 100;
Results:
Year,category_name,Avg_Wholesale_Price
2020,Aquatic Tuberous Vegetables,7.89
2020,Cabbage,5.66
2020,Capsicum,9.42
2020,Edible Mushroom,6.72
2020,Flower/Leaf Vegetables,4.63
2020,Solanum,4.88
2021,Aquatic Tuberous Vegetables,7.77
2021,Cabbage,6.02
2021,Capsicum,8.62
2021,Edible Mushroom,6.4
2021,Flower/Leaf Vegetables,4.92
2021,Solanum,5.55
2022,Aquatic Tuberous Vegetables,8.29
2022,Cabbage,4.99
2022,Capsicum,6.99
2022,Edible Mushroom,5.9
2022,Flower/Leaf Vegetables,3.66
2022,Solanum,6.1
2023,Aquatic Tuberous Vegetables,8.24
2023,Cabbage,6.95
2023,Capsicum,6.09
2023,Edible Mushroom,5.49
2023,Flower/Leaf Vegetables,5.23
2023,Solanum,6.06

2025-01-28 04:46:16 - root - INFO - SQL:
SELECT strftime('%Y', w."whsle_date") AS "Year", c."category_name",
           ROUND(MAX(w."whsle_px_rmb-kg"), 2) AS "Max_Wholesale_Price",
           ROUND(MIN(w."whsle_px_rmb-kg"), 2) AS "Min_Wholesale_Price"
    FROM "veg_whsle_df" AS w
    INNER JOIN "veg_cat" AS c ON w."item_code" = c."item_code"
    WHERE w."whsle_date" BETWEEN '2020-01-01' AND '2023-12-31'
    GROUP BY "Year", c."category_name"
    LIMIT 100;
Results:
Year,category_name,Max_Wholesale_Price,Min_Wholesale_Price
2020,Aquatic Tuberous Vegetables,29.54,0.76
2020,Cabbage,10.8,1.6
2020,Capsicum,45.39,0.4
2020,Edible Mushroom,80.0,1.33
2020,Flower/Leaf Vegetables,45.77,0.51
2020,Solanum,10.89,1.46
2021,Aquatic Tuberous Vegetables,38.78,1.18
2021,Cabbage,14.38,1.31
2021,Capsicum,51.27,1.67
2021,Edible Mushroom,60.0,0.5
2021,Flower/Leaf Vegetables,58.6,0.17
2021,Solanum,14.45,0.6
2022,Aquatic Tuberous Vegetables,48.01,0.01
2022,Cabbage,12.27,0.01
2022,Capsicum,112.36,0.01
2022,Edible Mushroom,65.99,0.01
2022,Flower/Leaf Vegetables,40.45,0.01
2022,Solanum,15.82,0.01
2023,Aquatic Tuberous Vegetables,32.91,0.1
2023,Cabbage,10.8,0.1
2023,Capsicum,27.59,0.01
2023,Edible Mushroom,61.27,0.11
2023,Flower/Leaf Vegetables,141.0,0.01
2023,Solanum,10.72,0.01

2025-01-28 04:46:16 - root - INFO - SQL:
SELECT strftime('%Y', w."whsle_date") AS "Year", c."category_name",
           ROUND(MAX(w."whsle_px_rmb-kg") - MIN(w."whsle_px_rmb-kg"), 2) AS "Wholesale_Price_Difference"
    FROM "veg_whsle_df" AS w
    INNER JOIN "veg_cat" AS c ON w."item_code" = c."item_code"
    WHERE w."whsle_date" BETWEEN '2020-01-01' AND '2023-12-31'
    GROUP BY "Year", c."category_name"
    LIMIT 100;
Results:
Year,category_name,Wholesale_Price_Difference
2020,Aquatic Tuberous Vegetables,28.78
2020,Cabbage,9.2
2020,Capsicum,44.99
2020,Edible Mushroom,78.67
2020,Flower/Leaf Vegetables,45.26
2020,Solanum,9.43
2021,Aquatic Tuberous Vegetables,37.6
2021,Cabbage,13.07
2021,Capsicum,49.6
2021,Edible Mushroom,59.5
2021,Flower/Leaf Vegetables,58.43
2021,Solanum,13.85
2022,Aquatic Tuberous Vegetables,48.0
2022,Cabbage,12.26
2022,Capsicum,112.35
2022,Edible Mushroom,65.98
2022,Flower/Leaf Vegetables,40.44
2022,Solanum,15.81
2023,Aquatic Tuberous Vegetables,32.81
2023,Cabbage,10.7
2023,Capsicum,27.58
2023,Edible Mushroom,61.16
2023,Flower/Leaf Vegetables,140.99
2023,Solanum,10.71

2025-01-28 04:46:16 - root - INFO - SQL:
SELECT c."category_name", ROUND(AVG(l."loss_rate_%"), 2) AS "Average_Loss_Rate"
    FROM "veg_loss_rate_df" AS l
    INNER JOIN "veg_cat" AS c ON l."item_code" = c."item_code"
    WHERE l."loss_rate_%" IS NOT NULL
    GROUP BY c."category_name"
    LIMIT 100;
Results:
category_name,Average_Loss_Rate
Aquatic Tuberous Vegetables,11.97
Cabbage,14.14
Capsicum,8.52
Edible Mushroom,8.13
Flower/Leaf Vegetables,10.28
Solanum,7.12

2025-01-28 04:46:16 - root - INFO - SQL:
SELECT strftime('%Y', w."whsle_date") AS "Year", c."category_name",
           ROUND(SUM(w."whsle_px_rmb-kg"), 2) AS "Total_Wholesale_Price"
    FROM "veg_whsle_df" AS w
    INNER JOIN "veg_cat" AS c ON w."item_code" = c."item_code"
    WHERE w."whsle_date" BETWEEN '2020-01-01' AND '2023-12-31' AND w."whsle_px_rmb-kg" IS NOT NULL
    GROUP BY "Year", c."category_name"
    LIMIT 100;
Results:
Year,category_name,Total_Wholesale_Price
2020,Aquatic Tuberous Vegetables,3100.02
2020,Cabbage,2081.23
2020,Capsicum,16858.16
2020,Edible Mushroom,13418.15
2020,Flower/Leaf Vegetables,13164.04
2020,Solanum,3108.8
2021,Aquatic Tuberous Vegetables,8368.2
2021,Cabbage,4436.48
2021,Capsicum,34067.81
2021,Edible Mushroom,29824.91
2021,Flower/Leaf Vegetables,33801.62
2021,Solanum,7261.52
2022,Aquatic Tuberous Vegetables,12043.21
2022,Cabbage,3895.81
2022,Capsicum,34859.95
2022,Edible Mushroom,27710.04
2022,Flower/Leaf Vegetables,28349.77
2022,Solanum,7453.19
2023,Aquatic Tuberous Vegetables,6501.96
2023,Cabbage,2739.81
2023,Capsicum,12398.71
2023,Edible Mushroom,9801.5
2023,Flower/Leaf Vegetables,15405.66
2023,Solanum,3148.86

2025-01-28 04:46:21 - root - INFO - SQL:
SELECT strftime('%Y', t."txn_date") AS "Year", c."category_name",
           ROUND(SUM(t."unit_selling_px_rmb/kg" * t."qty_sold(kg)"), 2) AS "Total_Selling_Price"
    FROM "veg_txn_df" AS t
    INNER JOIN "veg_cat" AS c ON t."item_code" = c."item_code"
    WHERE t."txn_date" BETWEEN '2020-01-01' AND '2023-12-31' AND t."unit_selling_px_rmb/kg" IS NOT NULL AND t."qty_sold(kg)" IS NOT NULL
    GROUP BY "Year", c."category_name"
    LIMIT 100;
Results:
Year,category_name,Total_Selling_Price
2020,Aquatic Tuberous Vegetables,52632.11
2020,Cabbage,84182.93
2020,Capsicum,125532.39
2020,Edible Mushroom,138141.9
2020,Flower/Leaf Vegetables,234438.6
2020,Solanum,34601.35
2021,Aquatic Tuberous Vegetables,116848.79
2021,Cabbage,112078.95
2021,Capsicum,236386.53
2021,Edible Mushroom,206950.35
2021,Flower/Leaf Vegetables,364896.96
2021,Solanum,63201.07
2022,Aquatic Tuberous Vegetables,131482.06
2022,Cabbage,122287.35
2022,Capsicum,247008.65
2022,Edible Mushroom,168545.96
2022,Flower/Leaf Vegetables,308505.47
2022,Solanum,58942.91
2023,Aquatic Tuberous Vegetables,49126.94
2023,Cabbage,57202.49
2023,Capsicum,145205.45
2023,Edible Mushroom,105959.58
2023,Flower/Leaf Vegetables,171228.76
2023,Solanum,34378.93

2025-01-28 04:46:23 - root - INFO - SQL:
SELECT c."category_name",
           ROUND(SUM(l."loss_rate_%" * s."Total_Qty_Sold" / 100), 2) AS "Total_Loss"
    FROM (
        SELECT "item_code", SUM("qty_sold(kg)") AS "Total_Qty_Sold"
        FROM "veg_txn_df"
        WHERE "txn_date" BETWEEN '2020-01-01' AND '2023-12-31'
        GROUP BY "item_code"
    ) AS s
    INNER JOIN "veg_loss_rate_df" AS l ON s."item_code" = l."item_code"
    INNER JOIN "veg_cat" AS c ON s."item_code" = c."item_code"
    GROUP BY c."category_name"
    LIMIT 100;
Results:
category_name,Total_Loss
Aquatic Tuberous Vegetables,3344.39
Cabbage,4534.34
Capsicum,7382.63
Edible Mushroom,5150.39
Flower/Leaf Vegetables,24768.36
Solanum,1425.64

2025-01-28 04:46:28 - root - INFO - SQL:
SELECT w."Year", w."category_name",
           ROUND(s."Total_Selling_Price" - w."Total_Wholesale_Price", 2) AS "Profit"
    FROM (
        SELECT strftime('%Y', w."whsle_date") AS "Year", c."category_name",
               SUM(w."whsle_px_rmb-kg") AS "Total_Wholesale_Price"
        FROM "veg_whsle_df" AS w
        INNER JOIN "veg_cat" AS c ON w."item_code" = c."item_code"
        WHERE w."whsle_date" BETWEEN '2020-01-01' AND '2023-12-31' AND w."whsle_px_rmb-kg" IS NOT NULL
        GROUP BY "Year", c."category_name"
    ) AS w
    INNER JOIN (
        SELECT strftime('%Y', t."txn_date") AS "Year", c."category_name",
               SUM(t."unit_selling_px_rmb/kg" * t."qty_sold(kg)") AS "Total_Selling_Price"
        FROM "veg_txn_df" AS t
        INNER JOIN "veg_cat" AS c ON t."item_code" = c."item_code"
        WHERE t."txn_date" BETWEEN '2020-01-01' AND '2023-12-31' AND t."unit_selling_px_rmb/kg" IS NOT NULL AND t."qty_sold(kg)" IS NOT NULL
        GROUP BY "Year", c."category_name"
    ) AS s ON w."Year" = s."Year" AND w."category_name" = s."category_name"
    LIMIT 100;
Results:
Year,category_name,Profit
2020,Aquatic Tuberous Vegetables,49532.09
2020,Cabbage,82101.7
2020,Capsicum,108674.23
2020,Edible Mushroom,124723.75
2020,Flower/Leaf Vegetables,221274.56
2020,Solanum,31492.55
2021,Aquatic Tuberous Vegetables,108480.59
2021,Cabbage,107642.47
2021,Capsicum,202318.72
2021,Edible Mushroom,177125.44
2021,Flower/Leaf Vegetables,331095.34
2021,Solanum,55939.55
2022,Aquatic Tuberous Vegetables,119438.85
2022,Cabbage,118391.54
2022,Capsicum,212148.7
2022,Edible Mushroom,140835.92
2022,Flower/Leaf Vegetables,280155.7
2022,Solanum,51489.72
2023,Aquatic Tuberous Vegetables,42624.98
2023,Cabbage,54462.68
2023,Capsicum,132806.74
2023,Edible Mushroom,96158.08
2023,Flower/Leaf Vegetables,155823.1
2023,Solanum,31230.07

2025-01-28 04:46:28 - root - INFO - itercount: 0
2025-01-28 04:46:28 - root - INFO - Table: weekly_salesDDL:
CREATE TABLE "weekly_sales" (
"week_date" TEXT,
  "region" TEXT,
  "platform" TEXT,
  "segment" TEXT,
  "customer_type" TEXT,
  "transactions" INTEGER,
  "sales" INTEGER
)
Table: shopping_cart_usersDDL:
CREATE TABLE "shopping_cart_users" (
"user_id" INTEGER,
  "cookie_id" TEXT,
  "start_date" TEXT
)
Table: bitcoin_membersDDL:
CREATE TABLE "bitcoin_members" (
"member_id" TEXT,
  "first_name" TEXT,
  "region" TEXT
)
Table: interest_metricsDDL:
CREATE TABLE "interest_metrics" (
"_month" REAL,
  "_year" REAL,
  "month_year" TEXT,
  "interest_id" REAL,
  "composition" REAL,
  "index_value" REAL,
  "ranking" INTEGER,
  "percentile_ranking" REAL
)
Table: customer_regionsDDL:
CREATE TABLE "customer_regions" (
"region_id" INTEGER,
  "region_name" TEXT
)
Table: customer_transactionsDDL:
CREATE TABLE "customer_transactions" (
"customer_id" INTEGER,
  "txn_date" TEXT,
  "txn_type" TEXT,
  "txn_amount" INTEGER
)
Table: bitcoin_transactionsDDL:
CREATE TABLE "bitcoin_transactions" (
"txn_id" INTEGER,
  "member_id" TEXT,
  "ticker" TEXT,
  "txn_date" TEXT,
  "txn_type" TEXT,
  "quantity" REAL,
  "percentage_fee" REAL,
  "txn_time" TEXT
)
Table: customer_nodesDDL:
CREATE TABLE "customer_nodes" (
"customer_id" INTEGER,
  "region_id" INTEGER,
  "node_id" INTEGER,
  "start_date" TEXT,
  "end_date" TEXT
)
Table: cleaned_weekly_salesDDL:
CREATE TABLE "cleaned_weekly_sales" (
"week_date_formatted" TEXT,
  "week_date" TEXT,
  "region" TEXT,
  "platform" TEXT,
  "segment" TEXT,
  "customer_type" TEXT,
  "transactions" INTEGER,
  "sales" INTEGER,
  "week_number" INTEGER,
  "month_number" INTEGER,
  "calendar_year" INTEGER,
  "age_band" TEXT,
  "demographic" TEXT,
  "avg_transaction" REAL
)
Table: veg_txn_dfDDL:
CREATE TABLE "veg_txn_df" (
"index" INTEGER,
  "txn_date" TEXT,
  "txn_time" TEXT,
  "item_code" INTEGER,
  "qty_sold(kg)" REAL,
  "unit_selling_px_rmb/kg" REAL,
  "sale/return" TEXT,
  "discount(%)" INTEGER,
  "day_of_week" TEXT
)
Table: shopping_cart_eventsDDL:
CREATE TABLE "shopping_cart_events" (
"visit_id" TEXT,
  "cookie_id" TEXT,
  "page_id" INTEGER,
  "event_type" INTEGER,
  "sequence_number" INTEGER,
  "event_time" TEXT
)
Table: shopping_cart_page_hierarchyDDL:
CREATE TABLE "shopping_cart_page_hierarchy" (
"page_id" INTEGER,
  "page_name" TEXT,
  "product_category" TEXT,
  "product_id" REAL
)
Table: bitcoin_pricesDDL:
CREATE TABLE "bitcoin_prices" (
"ticker" TEXT,
  "market_date" TEXT,
  "price" REAL,
  "open" REAL,
  "high" REAL,
  "low" REAL,
  "volume" TEXT,
  "change" TEXT
)
Table: interest_mapDDL:
CREATE TABLE "interest_map" (
"id" INTEGER,
  "interest_name" TEXT,
  "interest_summary" TEXT,
  "created_at" TEXT,
  "last_modified" TEXT
)
Table: veg_loss_rate_dfDDL:
CREATE TABLE "veg_loss_rate_df" (
"index" INTEGER,
  "item_code" INTEGER,
  "item_name" TEXT,
  "loss_rate_%" REAL
)
Table: shopping_cart_campaign_identifierDDL:
CREATE TABLE "shopping_cart_campaign_identifier" (
"campaign_id" INTEGER,
  "products" TEXT,
  "campaign_name" TEXT,
  "start_date" TEXT,
  "end_date" TEXT
)
Table: veg_catDDL:
CREATE TABLE "veg_cat" (
"index" INTEGER,
  "item_code" INTEGER,
  "item_name" TEXT,
  "category_code" INTEGER,
  "category_name" TEXT
)
Table: veg_whsle_dfDDL:
CREATE TABLE "veg_whsle_df" (
"index" INTEGER,
  "whsle_date" TEXT,
  "item_code" INTEGER,
  "whsle_px_rmb-kg" REAL
)
Table: shopping_cart_event_identifierDDL:
CREATE TABLE "shopping_cart_event_identifier" (
"event_type" INTEGER,
  "event_name" TEXT
)
External knowledge that might be helpful: 
None
The table structure information is (table names): 
['weekly_sales', 'shopping_cart_users', 'bitcoin_members', 'interest_metrics', 'customer_regions', 'customer_transactions', 'bitcoin_transactions', 'customer_nodes', 'cleaned_weekly_sales', 'veg_txn_df', 'shopping_cart_events', 'shopping_cart_page_hierarchy', 'bitcoin_prices', 'interest_map', 'veg_loss_rate_df', 'shopping_cart_campaign_identifier', 'veg_cat', 'veg_whsle_df', 'shopping_cart_event_identifier']
Begin Exploring Related Columns
To analyze our financial performance over the years 2020 to 2023 for the vegetable wholesale data, we need to consider the relevant tables and columns. Below is an outline of the columns and their potential usage, followed by SQL queries to understand the data.

---

**Relevant Tables and Columns:**

1. **`veg_whsle_df`** (Vegetable Wholesale Data)
   - `"whsle_date"`: Date of the wholesale transaction.
     - *Potential Usage*: Filter data by year (2020 to 2023).
   - `"item_code"`: Unique code for each vegetable item.
     - *Potential Usage*: Join with `veg_cat` to get category information.
   - `"whsle_px_rmb-kg"`: Wholesale price in RMB per kilogram.
     - *Potential Usage*: Calculate average, maximum, minimum wholesale prices, and total wholesale price.

2. **`veg_txn_df`** (Vegetable Transaction Data)
   - `"txn_date"`: Date of the retail transaction.
     - *Potential Usage*: Filter data by year (2020 to 2023).
   - `"item_code"`: Unique code for each vegetable item.
     - *Potential Usage*: Join with `veg_cat` to get category information.
   - `"qty_sold(kg)"`: Quantity sold in kilograms.
     - *Potential Usage*: Calculate total selling quantity.
   - `"unit_selling_px_rmb/kg"`: Selling price in RMB per kilogram.
     - *Potential Usage*: Calculate total selling price.

3. **`veg_cat`** (Vegetable Category Data)
   - `"item_code"`: Unique code for each vegetable item.
     - *Potential Usage*: Join with other tables to get category information.
   - `"category_name"`: Name of the category.
     - *Potential Usage*: Group data by category for analysis.

4. **`veg_loss_rate_df`** (Vegetable Loss Rate Data)
   - `"item_code"`: Unique code for each vegetable item.
     - *Potential Usage*: Join with other tables to get loss rate information.
   - `"loss_rate_%"`: Loss rate as a percentage.
     - *Potential Usage*: Calculate average loss rate and total loss.

---

**Conditions That May Be Used:**

- **Date Range**: Filter records to include only those from the years 2020 to 2023.
  - Example: `WHERE "whsle_date" BETWEEN '2020-01-01' AND '2023-12-31'`
- **Joins**: Use INNER JOIN on `"item_code"` to combine data from different tables.
- **Grouping**: Group data by `"Year"` and `"Category"` to perform aggregate calculations.
- **Calculations**: Compute averages, sums, maximums, minimums, and differences as required.

---

**SQL Queries:**

1. **List Distinct Years in Wholesale Data:**

   ```sql
   SELECT DISTINCT strftime('%Y', "whsle_date") AS "Year"
   FROM "veg_whsle_df"
   WHERE "whsle_date" IS NOT NULL
   LIMIT 100;
   ```

2. **List Distinct Item Codes and Names:**

   ```sql
   SELECT DISTINCT "item_code", "item_name"
   FROM "veg_cat"
   WHERE "item_code" IS NOT NULL AND "item_name" IS NOT NULL
   LIMIT 100;
   ```

3. **List Distinct Category Names:**

   ```sql
   SELECT DISTINCT "category_name"
   FROM "veg_cat"
   WHERE "category_name" IS NOT NULL
   LIMIT 100;
   ```

4. **Get Wholesale Prices with Dates and Item Codes:**

   ```sql
   SELECT "whsle_date", "item_code", "whsle_px_rmb-kg"
   FROM "veg_whsle_df"
   WHERE "whsle_px_rmb-kg" IS NOT NULL
   LIMIT 100;
   ```

5. **Get Selling Prices and Quantities from Transaction Data:**

   ```sql
   SELECT "txn_date", "item_code", "unit_selling_px_rmb/kg", "qty_sold(kg)"
   FROM "veg_txn_df"
   WHERE "unit_selling_px_rmb/kg" IS NOT NULL AND "qty_sold(kg)" IS NOT NULL
   LIMIT 100;
   ```

6. **List Loss Rates for Each Item:**

   ```sql
   SELECT "item_code", "item_name", "loss_rate_%"
   FROM "veg_loss_rate_df"
   WHERE "loss_rate_%" IS NOT NULL
   LIMIT 100;
   ```

7. **Get Wholesale Prices Joined with Category Names:**

   ```sql
   SELECT w."whsle_date", w."item_code", c."category_name", w."whsle_px_rmb-kg"
   FROM "veg_whsle_df" AS w
   INNER JOIN "veg_cat" AS c ON w."item_code" = c."item_code"
   WHERE w."whsle_px_rmb-kg" IS NOT NULL
   LIMIT 100;
   ```

8. **Get Total Quantity Sold Per Item:**

   ```sql
   SELECT "item_code", SUM("qty_sold(kg)") AS "Total_Qty_Sold"
   FROM "veg_txn_df"
   WHERE "qty_sold(kg)" IS NOT NULL
   GROUP BY "item_code"
   LIMIT 100;
   ```

9. **List Transaction Dates and Categories:**

   ```sql
   SELECT t."txn_date", c."category_name", t."item_code", t."qty_sold(kg)"
   FROM "veg_txn_df" AS t
   INNER JOIN "veg_cat" AS c ON t."item_code" = c."item_code"
   WHERE t."qty_sold(kg)" IS NOT NULL
   LIMIT 100;
   ```

10. **Get Average Wholesale Price Per Category Per Year:**

    ```sql
    SELECT strftime('%Y', w."whsle_date") AS "Year", c."category_name",
           ROUND(AVG(w."whsle_px_rmb-kg"), 2) AS "Avg_Wholesale_Price"
    FROM "veg_whsle_df" AS w
    INNER JOIN "veg_cat" AS c ON w."item_code" = c."item_code"
    WHERE w."whsle_date" BETWEEN '2020-01-01' AND '2023-12-31'
    GROUP BY "Year", c."category_name"
    LIMIT 100;
    ```

11. **Get Maximum and Minimum Wholesale Prices Per Category Per Year:**

    ```sql
    SELECT strftime('%Y', w."whsle_date") AS "Year", c."category_name",
           ROUND(MAX(w."whsle_px_rmb-kg"), 2) AS "Max_Wholesale_Price",
           ROUND(MIN(w."whsle_px_rmb-kg"), 2) AS "Min_Wholesale_Price"
    FROM "veg_whsle_df" AS w
    INNER JOIN "veg_cat" AS c ON w."item_code" = c."item_code"
    WHERE w."whsle_date" BETWEEN '2020-01-01' AND '2023-12-31'
    GROUP BY "Year", c."category_name"
    LIMIT 100;
    ```

12. **Calculate Wholesale Price Difference Per Category Per Year:**

    ```sql
    SELECT strftime('%Y', w."whsle_date") AS "Year", c."category_name",
           ROUND(MAX(w."whsle_px_rmb-kg") - MIN(w."whsle_px_rmb-kg"), 2) AS "Wholesale_Price_Difference"
    FROM "veg_whsle_df" AS w
    INNER JOIN "veg_cat" AS c ON w."item_code" = c."item_code"
    WHERE w."whsle_date" BETWEEN '2020-01-01' AND '2023-12-31'
    GROUP BY "Year", c."category_name"
    LIMIT 100;
    ```

13. **Get Average Loss Rate Per Category:**

    ```sql
    SELECT c."category_name", ROUND(AVG(l."loss_rate_%"), 2) AS "Average_Loss_Rate"
    FROM "veg_loss_rate_df" AS l
    INNER JOIN "veg_cat" AS c ON l."item_code" = c."item_code"
    WHERE l."loss_rate_%" IS NOT NULL
    GROUP BY c."category_name"
    LIMIT 100;
    ```

14. **Get Total Wholesale Price Per Category Per Year:**

    ```sql
    SELECT strftime('%Y', w."whsle_date") AS "Year", c."category_name",
           ROUND(SUM(w."whsle_px_rmb-kg"), 2) AS "Total_Wholesale_Price"
    FROM "veg_whsle_df" AS w
    INNER JOIN "veg_cat" AS c ON w."item_code" = c."item_code"
    WHERE w."whsle_date" BETWEEN '2020-01-01' AND '2023-12-31' AND w."whsle_px_rmb-kg" IS NOT NULL
    GROUP BY "Year", c."category_name"
    LIMIT 100;
    ```

15. **Get Total Selling Price Per Category Per Year:**

    ```sql
    SELECT strftime('%Y', t."txn_date") AS "Year", c."category_name",
           ROUND(SUM(t."unit_selling_px_rmb/kg" * t."qty_sold(kg)"), 2) AS "Total_Selling_Price"
    FROM "veg_txn_df" AS t
    INNER JOIN "veg_cat" AS c ON t."item_code" = c."item_code"
    WHERE t."txn_date" BETWEEN '2020-01-01' AND '2023-12-31' AND t."unit_selling_px_rmb/kg" IS NOT NULL AND t."qty_sold(kg)" IS NOT NULL
    GROUP BY "Year", c."category_name"
    LIMIT 100;
    ```

16. **Calculate Total Loss Per Category Using Loss Rates:**

    ```sql
    SELECT c."category_name",
           ROUND(SUM(l."loss_rate_%" * s."Total_Qty_Sold" / 100), 2) AS "Total_Loss"
    FROM (
        SELECT "item_code", SUM("qty_sold(kg)") AS "Total_Qty_Sold"
        FROM "veg_txn_df"
        WHERE "txn_date" BETWEEN '2020-01-01' AND '2023-12-31'
        GROUP BY "item_code"
    ) AS s
    INNER JOIN "veg_loss_rate_df" AS l ON s."item_code" = l."item_code"
    INNER JOIN "veg_cat" AS c ON s."item_code" = c."item_code"
    GROUP BY c."category_name"
    LIMIT 100;
    ```

17. **Calculate Profit Per Category Per Year:**

    ```sql
    SELECT w."Year", w."category_name",
           ROUND(s."Total_Selling_Price" - w."Total_Wholesale_Price", 2) AS "Profit"
    FROM (
        SELECT strftime('%Y', w."whsle_date") AS "Year", c."category_name",
               SUM(w."whsle_px_rmb-kg") AS "Total_Wholesale_Price"
        FROM "veg_whsle_df" AS w
        INNER JOIN "veg_cat" AS c ON w."item_code" = c."item_code"
        WHERE w."whsle_date" BETWEEN '2020-01-01' AND '2023-12-31' AND w."whsle_px_rmb-kg" IS NOT NULL
        GROUP BY "Year", c."category_name"
    ) AS w
    INNER JOIN (
        SELECT strftime('%Y', t."txn_date") AS "Year", c."category_name",
               SUM(t."unit_selling_px_rmb/kg" * t."qty_sold(kg)") AS "Total_Selling_Price"
        FROM "veg_txn_df" AS t
        INNER JOIN "veg_cat" AS c ON t."item_code" = c."item_code"
        WHERE t."txn_date" BETWEEN '2020-01-01' AND '2023-12-31' AND t."unit_selling_px_rmb/kg" IS NOT NULL AND t."qty_sold(kg)" IS NOT NULL
        GROUP BY "Year", c."category_name"
    ) AS s ON w."Year" = s."Year" AND w."category_name" = s."category_name"
    LIMIT 100;
    ```

---

These SQL queries will help us extract the necessary data to perform a comprehensive analysis of our financial performance over the specified years. By executing these queries, we can obtain insights into wholesale and selling prices, loss rates, and profit margins for each category, which are essential for informed decision-making.Query:
SELECT DISTINCT strftime('%Y', "whsle_date") AS "Year"
   FROM "veg_whsle_df"
   WHERE "whsle_date" IS NOT NULL
   LIMIT 100;
Answer:
Year
2020
2021
2022
2023
Query:
SELECT DISTINCT "item_code", "item_name"
   FROM "veg_cat"
   WHERE "item_code" IS NOT NULL AND "item_name" IS NOT NULL
   LIMIT 100;
Answer:
item_code,item_name
102900005115168,Niushou Shengcai
102900005115199,Sichuan Red Cedar
102900005115625,Local Xiaomao Cabbage
102900005115748,White Caitai
102900005115762,Amaranth
102900005115779,Yunnan Shengcai
102900005115786,Zhuyecai
102900005115793,Chinese Cabbage
102900005115816,Nanguajian
102900005115823,Shanghaiqing
102900005115854,Radish Leaves
102900005115861,Niushou Youcai
102900005115878,Garden Chrysanthemum
102900005115885,Caidian Quinoa Artemisia
102900005115908,Caixin
102900005115946,Muercai
102900005115960,Chinese Cabbage
102900005115977,Wandoujian
102900005115984,Yunnan Lettuces
102900005116639,Machixian
102900005116776,Local Spinach
102900005116790,Yellow Xincai (1)
102900005116806,Black Rapeseed
102900005118572,Local Shanghaiqing
102900005118817,Spinach
102900005118831,Wawacai
102900005119975,Hongshujian
102900005122654,Zhijiang Red Bolt
102900005128748,Huanghuacai
102900011000175,Kuaicai
102900011000571,Suizhou Bubble Green
102900011002414,Panax Notoginseng
102900011006689,Dongmenkou Xiaobaicai
102900011006948,Foreign Garland Chrysanthemum 
102900011006955,Ice Grass
102900011007464,Perilla
102900011007471,Mint
102900011007495,The Dandelion
102900011008133,Siguajian
102900011008164,Naibaicai
102900011008485,Mustard
102900011008492,Big Broccoli
102900011008515,Miantiaocai
102900011008522,Sweet Chinese Cabbage
102900011008676,Jicai
102900011015384,Malan Head
102900011015391,Ganlanye
102900011021644,Hongshan Caitai
102900011022849,The Local Yellow Youcai
102900011022924,Green Caitai
102900011023464,Xiaoqingcai (1)
102900011026502,Fresh Rice Dumplings Leaves
102900011026618,Aihao
102900011027462,Naibai Caimiao
102900011027615,Juhua Youcai
102900011029688,Shuanggou Cabbage
102900011030042,Zhijiang Red Bolt (Bag)
102900011030059,Yunnan Lettuce (Bag)
102900011030097,Yunnan Leaf Lettuce (Bag)
102900011030103,Garden Chrysanthemum (Bag)
102900011030110,Spinach (Bag)
102900011030134,Caixin (Bag)
102900011030141,Shanghai Green (Bag)
102900011030158,Xiaoqingcai (2)
102900011030400,Hongshan Shoutidai
102900011030417,Hongshan Gift Box
102900011030905,Yuxingcao (Bag)
102900011031216,Ice Grass (Box)
102900011032176,Basil (Bag)
102900011032282,Xiangtianhongcaitai (Bag)
102900011032480,Artemisia Stelleriana
102900011032589,Yuxingcao 
102900011032787,Zhuyecai (Bag)
102900011033081,Chuncai
102900011033173,Sophora Japonica
102900011033234,Hongshujian (Bag)
102900011033241,Caidian Quinoa Artemisia (Bag)
102900011033531,Red Coral (Leaf)
102900011033562,Red Oak Leaf
102900011033586,Green Butter
102900011033906,Powcan Mountain Chinese Cabbage 
102900011033920,Huangxincai (2)
102900011034200,Amaranth (Bag)
102900011034217,Chinese Cabbage (Bag)
102900011034224,Xiaoqingcai (Bag)
102900011034231,Cabbage Stem (Bag)
102900011034316,Zhimaxiancai
102900011034323,Xianzongye
102900011034354,Xianzongye (Bag) (1)
102900011035481,Foreign Garland Chrysanthemum  (Bag)
102900011035764,Longyacai
102900011035771,Yellow Baicai (1)
102900011035849,Chinese Cabbage Seedling
102900011036686,Muercai (Bag)
102900051000890,Broccoli
102900051009220,Youcaitai
102900051010455,Huangbaicai (2)
102900051010790,Purple Beicai
106971563780002,Xianzongye (Bag) (2)
106972776821582,Xianzongye (Bag) (3)
Query:
SELECT DISTINCT "category_name"
   FROM "veg_cat"
   WHERE "category_name" IS NOT NULL
   LIMIT 100;
Answer:
category_name
Flower/Leaf Vegetables
Cabbage
Aquatic Tuberous Vegetables
Solanum
Capsicum
Edible Mushroom
Query:
SELECT "whsle_date", "item_code", "whsle_px_rmb-kg"
   FROM "veg_whsle_df"
   WHERE "whsle_px_rmb-kg" IS NOT NULL
   LIMIT 100;
Answer:
whsle_date,item_code,whsle_px_rmb-kg
2020-07-01 00:00:00,102900005115762,3.88
2020-07-01 00:00:00,102900005115779,6.72
2020-07-01 00:00:00,102900005115786,3.19
2020-07-01 00:00:00,102900005115793,9.24
2020-07-01 00:00:00,102900005115823,7.03
2020-07-01 00:00:00,102900005115908,4.6
2020-07-01 00:00:00,102900005115946,4.2
2020-07-01 00:00:00,102900005115960,2.1
2020-07-01 00:00:00,102900005115984,3.44
2020-07-01 00:00:00,102900005116226,4.64
2020-07-01 00:00:00,102900005116233,5.76
2020-07-01 00:00:00,102900005116257,6.56
2020-07-01 00:00:00,102900005116509,1.63
2020-07-01 00:00:00,102900005116530,10.8
2020-07-01 00:00:00,102900005116547,4.06
2020-07-01 00:00:00,102900005116714,9.23
2020-07-01 00:00:00,102900005116790,3.97
2020-07-01 00:00:00,102900005116912,8.16
2020-07-01 00:00:00,102900005116943,7.83
2020-07-01 00:00:00,102900005117056,4.32
2020-07-01 00:00:00,102900005117209,7.58
2020-07-01 00:00:00,102900005118817,8.47
2020-07-01 00:00:00,102900005118824,5.65
2020-07-01 00:00:00,102900005118831,4.13
2020-07-01 00:00:00,102900005119944,10.29
2020-07-01 00:00:00,102900005119975,3.6
2020-07-01 00:00:00,102900005123880,7.5
2020-07-01 00:00:00,102900005125808,12.1
2020-07-01 00:00:00,102900005125815,6.16
2020-07-01 00:00:00,102900011001219,8.24
2020-07-01 00:00:00,102900011006948,11.69
2020-07-01 00:00:00,102900011008522,4.44
2020-07-01 00:00:00,102900011009970,6.03
2020-07-01 00:00:00,102900051000944,29.43
2020-07-01 00:00:00,102900051004294,6.81
2020-07-01 00:00:00,102900051010455,4.63
2020-07-02 00:00:00,102900005115762,3.93
2020-07-02 00:00:00,102900005115779,4.23
2020-07-02 00:00:00,102900005115786,3.18
2020-07-02 00:00:00,102900005115793,9.19
2020-07-02 00:00:00,102900005115823,7.03
2020-07-02 00:00:00,102900005115908,4.52
2020-07-02 00:00:00,102900005115946,4.23
2020-07-02 00:00:00,102900005115960,2.1
2020-07-02 00:00:00,102900005115984,3.58
2020-07-02 00:00:00,102900005116226,4.57
2020-07-02 00:00:00,102900005116233,5.71
2020-07-02 00:00:00,102900005116257,3.72
2020-07-02 00:00:00,102900005116509,1.46
2020-07-02 00:00:00,102900005116530,10.8
2020-07-02 00:00:00,102900005116547,4.05
2020-07-02 00:00:00,102900005116714,8.9
2020-07-02 00:00:00,102900005116790,3.97
2020-07-02 00:00:00,102900005116912,8.05
2020-07-02 00:00:00,102900005116943,7.27
2020-07-02 00:00:00,102900005117056,4.48
2020-07-02 00:00:00,102900005117209,7.33
2020-07-02 00:00:00,102900005118817,7.88
2020-07-02 00:00:00,102900005118824,5.76
2020-07-02 00:00:00,102900005118831,4.11
2020-07-02 00:00:00,102900005119944,10.13
2020-07-02 00:00:00,102900005119975,3.6
2020-07-02 00:00:00,102900005123880,6.46
2020-07-02 00:00:00,102900005125808,12.13
2020-07-02 00:00:00,102900005125815,6.15
2020-07-02 00:00:00,102900011000328,7.1
2020-07-02 00:00:00,102900011001219,8.24
2020-07-02 00:00:00,102900011006689,6.83
2020-07-02 00:00:00,102900011006948,11.75
2020-07-02 00:00:00,102900011008522,4.44
2020-07-02 00:00:00,102900011009970,5.52
2020-07-02 00:00:00,102900051000944,29.54
2020-07-02 00:00:00,102900051004294,6.85
2020-07-02 00:00:00,102900051010455,4.76
2020-07-03 00:00:00,102900005115762,3.57
2020-07-03 00:00:00,102900005115779,4.61
2020-07-03 00:00:00,102900005115786,3.79
2020-07-03 00:00:00,102900005115793,9.2
2020-07-03 00:00:00,102900005115823,6.76
2020-07-03 00:00:00,102900005115908,3.89
2020-07-03 00:00:00,102900005115946,4.3
2020-07-03 00:00:00,102900005115960,2.11
2020-07-03 00:00:00,102900005115984,3.75
2020-07-03 00:00:00,102900005116226,4.42
2020-07-03 00:00:00,102900005116233,5.7
2020-07-03 00:00:00,102900005116257,6.56
2020-07-03 00:00:00,102900005116509,1.48
2020-07-03 00:00:00,102900005116530,10.8
2020-07-03 00:00:00,102900005116547,4.05
2020-07-03 00:00:00,102900005116714,8.97
2020-07-03 00:00:00,102900005116790,3.98
2020-07-03 00:00:00,102900005116912,7.9
2020-07-03 00:00:00,102900005116943,6.75
2020-07-03 00:00:00,102900005117056,5.31
2020-07-03 00:00:00,102900005117209,6.21
2020-07-03 00:00:00,102900005118824,5.61
2020-07-03 00:00:00,102900005118831,4.05
2020-07-03 00:00:00,102900005119944,10.05
2020-07-03 00:00:00,102900005119975,3.6
2020-07-03 00:00:00,102900005123880,6.23
Query:
SELECT "txn_date", "item_code", "unit_selling_px_rmb/kg", "qty_sold(kg)"
   FROM "veg_txn_df"
   WHERE "unit_selling_px_rmb/kg" IS NOT NULL AND "qty_sold(kg)" IS NOT NULL
   LIMIT 100;
Answer:
txn_date,item_code,unit_selling_px_rmb/kg,qty_sold(kg)
2020-07-01 00:00:00,102900005117056,7.6,0.396
2020-07-01 00:00:00,102900005115960,3.2,0.849
2020-07-01 00:00:00,102900005117056,7.6,0.409
2020-07-01 00:00:00,102900005115823,10.0,0.421
2020-07-01 00:00:00,102900005115908,8.0,0.539
2020-07-01 00:00:00,102900005117056,7.6,0.277
2020-07-01 00:00:00,102900005115779,8.0,0.338
2020-07-01 00:00:00,102900005117056,7.6,0.132
2020-07-01 00:00:00,102900005115779,8.0,0.213
2020-07-01 00:00:00,102900011008522,8.0,0.514
2020-07-01 00:00:00,102900005118824,10.0,0.251
2020-07-01 00:00:00,102900005115984,6.0,0.251
2020-07-01 00:00:00,102900005116530,18.0,0.217
2020-07-01 00:00:00,102900005115984,6.0,0.468
2020-07-01 00:00:00,102900005116226,8.0,0.589
2020-07-01 00:00:00,102900005118824,10.0,0.711
2020-07-01 00:00:00,102900005115779,8.0,1.003
2020-07-01 00:00:00,102900005116530,18.0,0.095
2020-07-01 00:00:00,102900005116233,10.0,0.15
2020-07-01 00:00:00,102900005115984,6.0,0.502
2020-07-01 00:00:00,102900005115984,6.0,0.452
2020-07-01 00:00:00,102900005115908,8.0,0.501
2020-07-01 00:00:00,102900005115779,8.0,0.201
2020-07-01 00:00:00,102900005115779,8.0,0.439
2020-07-01 00:00:00,102900005115762,6.0,0.686
2020-07-01 00:00:00,102900005116714,14.0,0.329
2020-07-01 00:00:00,102900005115908,8.0,0.251
2020-07-01 00:00:00,102900005118817,14.0,0.243
2020-07-01 00:00:00,102900005116530,18.0,0.256
2020-07-01 00:00:00,102900005115984,6.0,0.318
2020-07-01 00:00:00,102900011009970,9.0,0.445
2020-07-01 00:00:00,102900005115779,8.0,0.363
2020-07-01 00:00:00,102900005117209,16.0,0.482
2020-07-01 00:00:00,102900011001219,14.0,0.343
2020-07-01 00:00:00,102900005115984,6.0,0.502
2020-07-01 00:00:00,102900005115779,8.0,0.301
2020-07-01 00:00:00,102900005117056,7.6,0.198
2020-07-01 00:00:00,102900051004294,14.0,0.172
2020-07-01 00:00:00,102900005117056,7.6,0.66
2020-07-01 00:00:00,102900005115984,6.0,0.753
2020-07-01 00:00:00,102900005115984,6.0,0.552
2020-07-01 00:00:00,102900051004294,14.0,0.057
2020-07-01 00:00:00,102900005115960,3.2,1.101
2020-07-01 00:00:00,102900005116547,6.0,0.435
2020-07-01 00:00:00,102900005115984,6.0,0.201
2020-07-01 00:00:00,102900005116547,6.0,0.452
2020-07-01 00:00:00,102900005115984,6.0,0.385
2020-07-01 00:00:00,102900005116714,14.0,0.522
2020-07-01 00:00:00,102900005115984,6.0,0.435
2020-07-01 00:00:00,102900051000944,39.8,0.545
2020-07-01 00:00:00,102900011009970,9.0,0.368
2020-07-01 00:00:00,102900005115908,8.0,0.313
2020-07-01 00:00:00,102900005115779,8.0,0.276
2020-07-01 00:00:00,102900005116547,6.0,0.217
2020-07-01 00:00:00,102900005116714,14.0,0.236
2020-07-01 00:00:00,102900011008522,8.0,0.451
2020-07-01 00:00:00,102900005116530,18.0,0.184
2020-07-01 00:00:00,102900005115984,6.0,0.418
2020-07-01 00:00:00,102900005115984,6.0,0.502
2020-07-01 00:00:00,102900005116547,6.0,0.468
2020-07-01 00:00:00,102900005119975,6.0,0.234
2020-07-01 00:00:00,102900005125815,10.0,0.301
2020-07-01 00:00:00,102900005115786,6.0,0.786
2020-07-01 00:00:00,102900011009970,9.0,0.401
2020-07-01 00:00:00,102900005115960,3.2,0.629
2020-07-01 00:00:00,102900011009970,9.0,0.457
2020-07-01 00:00:00,102900005116714,14.0,0.401
2020-07-01 00:00:00,102900005117056,7.6,0.554
2020-07-01 00:00:00,102900051010455,9.0,0.969
2020-07-01 00:00:00,102900005119975,6.0,0.468
2020-07-01 00:00:00,102900005117056,7.6,0.145
2020-07-01 00:00:00,102900005115779,8.0,0.251
2020-07-01 00:00:00,102900005116509,4.0,0.829
2020-07-01 00:00:00,102900005117056,7.6,0.581
2020-07-01 00:00:00,102900005116509,4.0,0.402
2020-07-01 00:00:00,102900005115762,6.0,0.702
2020-07-01 00:00:00,102900051010455,9.0,0.768
2020-07-01 00:00:00,102900005119975,6.0,0.234
2020-07-01 00:00:00,102900005115984,6.0,0.769
2020-07-01 00:00:00,102900005116714,14.0,0.329
2020-07-01 00:00:00,102900005115984,6.0,0.585
2020-07-01 00:00:00,102900005116509,4.0,0.402
2020-07-01 00:00:00,102900005115762,6.0,0.636
2020-07-01 00:00:00,102900005116530,18.0,0.095
2020-07-01 00:00:00,102900005115779,8.0,0.426
2020-07-01 00:00:00,102900005116509,4.0,0.427
2020-07-01 00:00:00,102900005115984,6.0,0.636
2020-07-01 00:00:00,102900005116530,18.0,0.312
2020-07-01 00:00:00,102900051004294,14.0,0.372
2020-07-01 00:00:00,102900005117056,7.6,0.515
2020-07-01 00:00:00,102900005116943,18.0,0.339
2020-07-01 00:00:00,102900005115960,3.2,1.321
2020-07-01 00:00:00,102900005116714,14.0,0.386
2020-07-01 00:00:00,102900005116257,6.0,0.585
2020-07-01 00:00:00,102900005125808,25.8,0.182
2020-07-01 00:00:00,102900005115779,8.0,0.476
2020-07-01 00:00:00,102900005125808,25.8,0.058
2020-07-01 00:00:00,102900005125815,10.0,0.2
2020-07-01 00:00:00,102900005115779,8.0,0.338
2020-07-01 00:00:00,102900011009970,9.0,0.523
Query:
SELECT "item_code", "item_name", "loss_rate_%"
   FROM "veg_loss_rate_df"
   WHERE "loss_rate_%" IS NOT NULL
   LIMIT 100;
Answer:
item_code,item_name,loss_rate_%
102900005115168,Niushou Shengcai,4.39
102900005115199,Sichuan Red Cedar,10.46
102900005115250,Xixia Black Mushroom (1),10.8
102900005115625,Local Xiaomao Cabbage,0.18
102900005115748,White Caitai,8.78
102900005115762,Amaranth,18.52
102900005115779,Yunnan Shengcai,15.25
102900005115786,Zhuyecai,13.62
102900005115793,Chinese Cabbage,7.59
102900005115816,Nanguajian,13.46
102900005115823,Shanghaiqing,14.43
102900005115854,Radish Leaves,5.35
102900005115861,Niushou Youcai,12.17
102900005115878,Garden Chrysanthemum,6.27
102900005115885,Caidian Quinoa Artemisia,0.47
102900005115908,Caixin,13.7
102900005115946,Muercai,7.61
102900005115960,Chinese Cabbage,22.27
102900005115977,Wandoujian,8.36
102900005115984,Yunnan Lettuces,12.81
102900005116042,Lotus Root,15.32
102900005116219,Red Hot Peppers,6.73
102900005116226,Green Hot Peppers,6.72
102900005116233,Red Pepper (1),11.76
102900005116257,Eggplant (2),6.07
102900005116509,Green Eggplant (1),5.01
102900005116530,Xixia Mushroom (1),13.82
102900005116547,Needle Mushroom (1),3.43
102900005116639,Machixian,11.78
102900005116714,Broccoli,9.26
102900005116776,Local Spinach,10.46
102900005116790,Yellow Xincai (1),10.64
102900005116806,Black Rapeseed,0.1
102900005116837,Ping Mushroom,11.6
102900005116899,Net Lotus Root (1),5.54
102900005116905,Green Hangjiao (1),0.0
102900005116912,Jigu Mushroom (1),8.99
102900005116943,Red Hang Pepper,9.99
102900005117056,Paopaojiao (Jingpin),7.08
102900005117209,7 Colour Pepper (1),15.98
102900005117353,The White Mushroom (1),9.43
102900005118572,Local Shanghaiqing,11.99
102900005118817,Spinach,18.51
102900005118824,High Melon (1),29.25
102900005118831,Wawacai,2.48
102900005119098,The Agaricus Bisporus,12.78
102900005119104,The Crab Flavor Mushroom (1),9.24
102900005119944,Haixian Mushroom (1),9.89
102900005119968,Green Hangzhou Pepper (2),9.0
102900005119975,Hongshujian,8.42
102900005122654,Zhijiang Red Bolt,11.38
102900005123880,Bell Pepper (1),16.33
102900005125808,Millet Pepper,5.86
102900005125815,Apricot Bao Mushroom (1),5.05
102900005128748,Huanghuacai,16.89
102900011000175,Kuaicai,20.38
102900011000328,Luosi Pepper,10.18
102900011000335,Round Eggplant,0.32
102900011000571,Suizhou Bubble Green,12.2
102900011000632,Purple Cabbage (1),25.53
102900011000861,Red Line Pepper,7.71
102900011001219,The Red Bell Pepper (1),8.93
102900011001561,Lotus (Ea),12.17
102900011001691,Water Chestnut (Lingjiao),9.61
102900011001806,Jigu Mushroom (Bunch),12.42
102900011001813,Needle Mushroom (Bag) (1),8.85
102900011002414,Panax Notoginseng,16.95
102900011006689,Dongmenkou Xiaobaicai,27.84
102900011006948,Foreign Garland Chrysanthemum ,26.16
102900011006955,Ice Grass,15.01
102900011007044,Tremella (Flower),9.14
102900011007464,Perilla,12.88
102900011007471,Mint,13.28
102900011007495,The Dandelion,15.92
102900011007969,Red Lotus Root Zone,16.63
102900011008133,Siguajian,15.98
102900011008164,Naibaicai,15.68
102900011008485,Mustard,13.75
102900011008492,Big Broccoli,4.69
102900011008515,Miantiaocai,12.8
102900011008522,Sweet Chinese Cabbage,9.43
102900011008577,Hericium ,16.19
102900011008676,Jicai,11.56
102900011009246,Fresh Black Fungus (1),7.63
102900011009277,Water Chestnut,11.02
102900011009444,Dalong Eggplant,10.94
102900011009772,Fruit Pepper (Orange),9.43
102900011009970,Qinggengsanhua,17.06
102900011010563,Chicken Fir Bacteria,11.93
102900011010891,Wild Lotus Root (1),7.97
102900011011058,Black Porcini,10.17
102900011011546,Haixian Mushroom (Bag) (1),5.96
102900011011669,Xiuzhen Mushroom,11.93
102900011011782,Chinese Caterpillar Fungus Flowers (Box) (1),11.93
102900011012482,Tea Tree Mushroom (Bag),9.97
102900011012871,Black Chicken  Mushroom,11.03
102900011012994,Apricot Bao Mushroom (Bag),10.03
102900011013274,The White Mushroom (Bag),6.57
102900011015384,Malan Head,15.16
102900011015391,Ganlanye,11.58
Query:
SELECT w."whsle_date", w."item_code", c."category_name", w."whsle_px_rmb-kg"
   FROM "veg_whsle_df" AS w
   INNER JOIN "veg_cat" AS c ON w."item_code" = c."item_code"
   WHERE w."whsle_px_rmb-kg" IS NOT NULL
   LIMIT 100;
Answer:
Too long, hard cut:
whsle_date,item_code,category_name,whsle_px_rmb-kg
2020-07-01 00:00:00,102900005115762,Flower/Leaf Vegetables,3.88
2020-07-01 00:00:00,102900005115779,Flower/Leaf Vegetables,6.72
2020-07-01 00:00:00,102900005115786,Flower/Leaf Vegetables,3.19
2020-07-01 00:00:00,102900005115793,Flower/Leaf Vegetables,9.24
2020-07-01 00:00:00,102900005115823,Flower/Leaf Vegetables,7.03
2020-07-01 00:00:00,102900005115908,Flower/Leaf Vegetables,4.6
2020-07-01 00:00:00,102900005115946,Flower/Leaf Vegetables,4.2
2020-07-01 00:00:00,102900005115960,Flower/Leaf Vegetables,2.1
2020-07-01 00:00:00,102900005115984,Flower/Leaf Vegetables,3.44
2020-07-01 00:00:00,102900005116226,Capsicum,4.64
2020-07-01 00:00:00,102900005116233,Capsicum,5.76
2020-07-01 00:00:00,102900005116257,Solanum,6.56
2020-07-01 00:00:00,102900005116509,Solanum,1.63
2020-07-01 00:00:00,102900005116530,Edible Mushroom,10.8
2020-07-01 00:00:00,102900005116547,Edible Mushroom,4.06
2020-07-01 00:00:00,102900005116714,Cabbage,9.23
2020-07-01 00:00:00,102900005116790,Flower/Leaf Vegetables,3.97
2020-07-01 00:00:00,102900005116912,Edible Mushroom,8.16
2020-07-01 00:00:00,102900005116943,Capsicum,7.83
2020-07-01 00:00:00,102900005117056,Capsicum,4.32
2020-07-01 00:00:00,102900005117209,Capsicum,7.58
2020-07-01 00:00:00,102900005118817,Flower/Leaf Vegetables,8.47
2020-07-01 00:00:00,102900005118824,Aquatic Tuberous Vegetables,5.65
2020-07-01 00:00:00,102900005118831,Flower/Leaf Vegetables,4.13
2020-07-01 00:00:00,102900005119944,Edible Mushroom,10.29
2020-07-01 00:00:00,102900005119975,Flower/Leaf Vegetables,3.6
2020-07-01 00:00:00,102900005123880,Capsicum,7.5
2020-07-01 00:00:00,102900005125808,Capsicum,12.1
2020-07-01 00:00:00,102900005125815,Edible Mushroom,6.16
2020-07-01 00:00:00,102900011001219,Capsicum,8.24
2020-07-01 00:00:00,102900011006948,Flower/Leaf Vegetables,11.69
2020-07-01 00:00:00,102900011008522,Flower/Leaf Vegetables,4.44
2020-07-01 00:00:00,102900011009970,Cabbage,6.03
2020-07-01 00:00:00,102900051000944,Aquatic Tuberous Vegetables,29.43
2020-07-01 00:00:00,102900051004294,Capsicum,6.81
2020-07-01 00:00:00,102900051010455,Flower/Leaf Vegetables,4.63
2020-07-02 00:00:00,102900005115762,Flower/Leaf Vegetables,3.93
2020-07-02 00:00:00,102900005115779,Flower/Leaf Vegetables,4.23
2020-07-02 00:00:00,102900005115786,Flower/Leaf Vegetables,3.18
2020-07-02 00:00:00,102900005115793,Flower/Leaf Vegetables,9.19
2020-07-02 00:00:00,102900005115823,Flower/Leaf Vegetables,7.03
2020-07-02 00:00:00,102900005115908,Flower/Leaf Vegetables,4.52
2020-07-02 00:00:00,102900005115946,Flower/Leaf Vegetables,4.23
2020-07-02 00:00:00,102900005115960,Flower/Leaf Vegetables,2.1
2020-07-02 00:00:00,102900005115984,Flower/Leaf Vegetables,3.58
2020-07-02 00:00:00,102900005116226,Capsicum,4.57
2020-07-02 00:00:00,102900005116233,Capsicum,5.71
2020-07-02 00:00:00,102900005116257,Solanum,3.72
2020-07-02 00:00:00,102900005116509,Solanum,1.46
2020-07-02 00:00:00,102900005116530,Edible Mushroom,10.8
2020-07-02 00:00:00,102900005116547,Edible Mushroom,4.05
2020-07-02 00:00:00,102900005116714,Cabbage,8.9
2020-07-02 00:00:00,102900005116790,Flower/Leaf Vegetables,3.97
2020-07-02 00:00:00,102900005116912,Edible Mushroom,8.05
2020-07-02 00:00:00,102900005116943,Capsicum,7.27
2020-07-02 00:00:00,102900005117056,Capsicum,4.48
2020-07-02 00:00:00,102900005117209,Capsicum,7.33
2020-07-02 00:00:00,102900005118817,Flower/Leaf Vegetables,7.88
2020-07-02 00:00:00,102900005118824,Aquatic Tuberous Vegetables,5.76
2020-07-02 00:00:00,102900005118831,Flower/Leaf Vegetables,4.11
2020-07-02 00:00:00,102900005119944,Edible Mushroom,10.13
2020-07-02 00:00:00,102900005119975,Flower/Leaf Vegetables,3.6
2020-07-02 00:00:00,102900005123880,Capsicum,6.46
2020-07-02 00:00:00,102900005125808,Capsicum,12.13
2020-07-02 00:00:00,102900005125815,Edible Mushroom,6.15
2020-07-02 00:00:00,102900011000328,Capsicum,7.1
2020-07-02 00:00:00,102900011001219,Capsicum,8.24
2020-07-02 00:00:00,102900011006689,Flower/Leaf Vegetables,6.83
2020-07-02 00:00:00,102900011006948,Flower/Leaf Vegetables,11.75
2020-07-02 00:00:00,102900011008522,Flower/Leaf Vegetables,4.44
2020-07-02 00:00:00,102900011009970,Cabbage,5.52
2020-07-02 00:00:00,102900051000944,Aquatic Tuberous Vegetables,29.54
2020-07-02 00:00:00,102900051004294,Capsicum,6.85
2020-07-02 00:00:00,102900051010455,Flower/Leaf Vegetables,4.76
2020-07-03 00:00:00,102900005115762,Flower/Leaf Vegetables,3.57
2020-07-03 00:00:00,102900005115779,Flower/Leaf Vegetables,4.61
2020-07-03 00:00:00,102900005115786,Flower/Leaf Vegetables,3.79
2020-07-03 00:00:00,102900005115793,Flower/Leaf Vegetables,9.2
2020-07-03 00:00:00,102900005115823,Flower/Leaf Vegetables,6.76
2020-07-03 00:00:00,102900005115908,Flower/Leaf Vegetables,3.89
2020-07-03 00:00:00,102900005115946,Flower/Leaf Vegetables,4.3
2020-07-03 00:00:00,102900005115960,Flower/Leaf Vegetables,2.11
2020-07-03 00:00:00,102900005115984,Flower/Leaf Vegetables,3.75
2020-07-03 00:00:00,102900005116226,Capsicum,4.42
2020-07-03 00:00:00,1029000
Query:
SELECT "item_code", SUM("qty_sold(kg)") AS "Total_Qty_Sold"
   FROM "veg_txn_df"
   WHERE "qty_sold(kg)" IS NOT NULL
   GROUP BY "item_code"
   LIMIT 100;
Answer:
item_code,Total_Qty_Sold
102900005115168,899.8369999999926
102900005115199,333.2229999999997
102900005115250,2810.715999999994
102900005115625,121.01999999999997
102900005115748,718.6759999999995
102900005115762,5100.061000000054
102900005115779,15910.461000000087
102900005115786,7240.764000000127
102900005115793,1707.3030000000058
102900005115816,18.427999999999997
102900005115823,7606.756000000144
102900005115854,415.3249999999997
102900005115861,3836.5659999999516
102900005115878,4110.161999999955
102900005115885,939.5750000000013
102900005115908,4496.717000000026
102900005115946,1566.6399999999949
102900005115960,19187.218000000375
102900005115977,85.04799999999996
102900005115984,10305.364000000254
102900005116219,438.5929999999993
102900005116226,1186.5310000000086
102900005116233,3457.8749999999845
102900005116257,13602.00100000012
102900005116509,3516.7630000000017
102900005116530,11920.227000000103
102900005116547,4697.469999999988
102900005116639,94.31500000000001
102900005116714,27537.227999999166
102900005116790,2911.298999999998
102900005116806,101.12500000000004
102900005116837,2542.9590000000007
102900005116899,27149.44000000034
102900005116905,1.817
102900005116912,375.22200000000095
102900005116943,658.5600000000022
102900005117056,9703.125000000142
102900005117209,263.19199999999995
102900005117353,22.0
102900005118572,596.6969999999978
102900005118817,5216.4610000000885
102900005118824,1179.652000000004
102900005118831,8982.0
102900005119098,627.7179999999994
102900005119104,102.0
102900005119944,502.16500000000093
102900005119968,128.49999999999997
102900005119975,5159.433000000111
102900005122654,4962.4540000000015
102900005123880,212.04299999999992
102900005125808,1447.3529999999964
102900005125815,2404.977000000032
102900005128748,1.7839999999999996
102900011000175,91.27200000000008
102900011000328,7792.181000000182
102900011000335,7.658
102900011000571,675.2210000000007
102900011000632,13.251000000000001
102900011000861,27.713000000000026
102900011001219,278.61199999999997
102900011001561,2095.0
102900011001691,126.42200000000003
102900011001806,1071.0
102900011001813,2149.0
102900011002414,45.251999999999995
102900011006689,1543.4780000000026
102900011006948,732.6150000000006
102900011006955,16.337
102900011007044,287.0
102900011007464,30.172000000000004
102900011007471,7.5680000000000005
102900011007495,4.232
102900011007969,100.46900000000015
102900011008133,14.226999999999999
102900011008164,5816.308000000122
102900011008485,51.73500000000001
102900011008492,7.48
102900011008515,12.936000000000002
102900011008522,4685.261000000009
102900011008577,3.0
102900011008676,15.886999999999997
102900011009246,212.1709999999997
102900011009277,1671.4240000000004
102900011009444,1167.2180000000023
102900011009772,0.415
102900011009970,8393.786000000093
102900011010563,1.2149999999999999
102900011010891,448.8599999999998
102900011011058,1.084
102900011011546,1266.0
102900011011669,14.708000000000002
102900011012482,90.0
102900011012871,5.795000000000002
102900011012994,1343.0
102900011013274,2927.0
102900011015384,3.3899999999999997
102900011015391,0.9430000000000001
102900011016701,28164.33100000042
102900011016909,101.37900000000002
102900011018095,978.0
Query:
SELECT t."txn_date", c."category_name", t."item_code", t."qty_sold(kg)"
   FROM "veg_txn_df" AS t
   INNER JOIN "veg_cat" AS c ON t."item_code" = c."item_code"
   WHERE t."qty_sold(kg)" IS NOT NULL
   LIMIT 100;
Answer:
Too long, hard cut:
txn_date,category_name,item_code,qty_sold(kg)
2020-07-01 00:00:00,Capsicum,102900005117056,0.396
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115960,0.849
2020-07-01 00:00:00,Capsicum,102900005117056,0.409
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115823,0.421
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115908,0.539
2020-07-01 00:00:00,Capsicum,102900005117056,0.277
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115779,0.338
2020-07-01 00:00:00,Capsicum,102900005117056,0.132
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115779,0.213
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900011008522,0.514
2020-07-01 00:00:00,Aquatic Tuberous Vegetables,102900005118824,0.251
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.251
2020-07-01 00:00:00,Edible Mushroom,102900005116530,0.217
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.468
2020-07-01 00:00:00,Capsicum,102900005116226,0.589
2020-07-01 00:00:00,Aquatic Tuberous Vegetables,102900005118824,0.711
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115779,1.003
2020-07-01 00:00:00,Edible Mushroom,102900005116530,0.095
2020-07-01 00:00:00,Capsicum,102900005116233,0.15
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.502
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.452
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115908,0.501
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115779,0.201
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115779,0.439
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115762,0.686
2020-07-01 00:00:00,Cabbage,102900005116714,0.329
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115908,0.251
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005118817,0.243
2020-07-01 00:00:00,Edible Mushroom,102900005116530,0.256
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.318
2020-07-01 00:00:00,Cabbage,102900011009970,0.445
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115779,0.363
2020-07-01 00:00:00,Capsicum,102900005117209,0.482
2020-07-01 00:00:00,Capsicum,102900011001219,0.343
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.502
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115779,0.301
2020-07-01 00:00:00,Capsicum,102900005117056,0.198
2020-07-01 00:00:00,Capsicum,102900051004294,0.172
2020-07-01 00:00:00,Capsicum,102900005117056,0.66
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.753
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.552
2020-07-01 00:00:00,Capsicum,102900051004294,0.057
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115960,1.101
2020-07-01 00:00:00,Edible Mushroom,102900005116547,0.435
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.201
2020-07-01 00:00:00,Edible Mushroom,102900005116547,0.452
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.385
2020-07-01 00:00:00,Cabbage,102900005116714,0.522
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.435
2020-07-01 00:00:00,Aquatic Tuberous Vegetables,102900051000944,0.545
2020-07-01 00:00:00,Cabbage,102900011009970,0.368
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115908,0.313
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115779,0.276
2020-07-01 00:00:00,Edible Mushroom,102900005116547,0.217
2020-07-01 00:00:00,Cabbage,102900005116714,0.236
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900011008522,0.451
2020-07-01 00:00:00,Edible Mushroom,102900005116530,0.184
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.418
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.502
2020-07-01 00:00:00,Edible Mushroom,102900005116547,0.468
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005119975,0.234
2020-07-01 00:00:00,Edible Mushroom,102900005125815,0.301
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115786,0.786
2020-07-01 00:00:00,Cabbage,102900011009970,0.401
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115960,0.629
2020-07-01 00:00:00,Cabbage,102900011009970,0.457
2020-07-01 00:00:00,Cabbage,102900005116714,0.401
2020-07-01 00:00:00,Capsicum,102900005117056,0.554
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900051010455,0.969
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005119975,0.468
2020-07-01 00:00:00,Capsicum,102900005117056,0.145
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115779,0.251
2020-07-01 00:00:00,Solanum,102900005116509,0.829
2020-07-01 00:00:00,Capsicum,102900005117056,0.581
2020-07-01 00:00:00,Solanum,102900005116509,0.402
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115762,0.702
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900051010455,0.768
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005119975,0.234
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.769
2020-07-01 00:00:00,Cabbage,102900005116714,0.329
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115984,0.585
2020-07-01 00:00:00,Solanum,102900005116509,0.402
2020-07-01 00:00:00,Flower/Leaf Vegetables,102900005115762,0.636
Query:
SELECT strftime('%Y', w."whsle_date") AS "Year", c."category_name",
           ROUND(AVG(w."whsle_px_rmb-kg"), 2) AS "Avg_Wholesale_Price"
    FROM "veg_whsle_df" AS w
    INNER JOIN "veg_cat" AS c ON w."item_code" = c."item_code"
    WHERE w."whsle_date" BETWEEN '2020-01-01' AND '2023-12-31'
    GROUP BY "Year", c."category_name"
    LIMIT 100;
Answer:
Year,category_name,Avg_Wholesale_Price
2020,Aquatic Tuberous Vegetables,7.89
2020,Cabbage,5.66
2020,Capsicum,9.42
2020,Edible Mushroom,6.72
2020,Flower/Leaf Vegetables,4.63
2020,Solanum,4.88
2021,Aquatic Tuberous Vegetables,7.77
2021,Cabbage,6.02
2021,Capsicum,8.62
2021,Edible Mushroom,6.4
2021,Flower/Leaf Vegetables,4.92
2021,Solanum,5.55
2022,Aquatic Tuberous Vegetables,8.29
2022,Cabbage,4.99
2022,Capsicum,6.99
2022,Edible Mushroom,5.9
2022,Flower/Leaf Vegetables,3.66
2022,Solanum,6.1
2023,Aquatic Tuberous Vegetables,8.24
2023,Cabbage,6.95
2023,Capsicum,6.09
2023,Edible Mushroom,5.49
2023,Flower/Leaf Vegetables,5.23
2023,Solanum,6.06
Query:
SELECT strftime('%Y', w."whsle_date") AS "Year", c."category_name",
           ROUND(MAX(w."whsle_px_rmb-kg"), 2) AS "Max_Wholesale_Price",
           ROUND(MIN(w."whsle_px_rmb-kg"), 2) AS "Min_Wholesale_Price"
    FROM "veg_whsle_df" AS w
    INNER JOIN "veg_cat" AS c ON w."item_code" = c."item_code"
    WHERE w."whsle_date" BETWEEN '2020-01-01' AND '2023-12-31'
    GROUP BY "Year", c."category_name"
    LIMIT 100;
Answer:
Year,category_name,Max_Wholesale_Price,Min_Wholesale_Price
2020,Aquatic Tuberous Vegetables,29.54,0.76
2020,Cabbage,10.8,1.6
2020,Capsicum,45.39,0.4
2020,Edible Mushroom,80.0,1.33
2020,Flower/Leaf Vegetables,45.77,0.51
2020,Solanum,10.89,1.46
2021,Aquatic Tuberous Vegetables,38.78,1.18
2021,Cabbage,14.38,1.31
2021,Capsicum,51.27,1.67
2021,Edible Mushroom,60.0,0.5
2021,Flower/Leaf Vegetables,58.6,0.17
2021,Solanum,14.45,0.6
2022,Aquatic Tuberous Vegetables,48.01,0.01
2022,Cabbage,12.27,0.01
2022,Capsicum,112.36,0.01
2022,Edible Mushroom,65.99,0.01
2022,Flower/Leaf Vegetables,40.45,0.01
2022,Solanum,15.82,0.01
2023,Aquatic Tuberous Vegetables,32.91,0.1
2023,Cabbage,10.8,0.1
2023,Capsicum,27.59,0.01
2023,Edible Mushroom,61.27,0.11
2023,Flower/Leaf Vegetables,141.0,0.01
2023,Solanum,10.72,0.01
Query:
SELECT strftime('%Y', w."whsle_date") AS "Year", c."category_name",
           ROUND(MAX(w."whsle_px_rmb-kg") - MIN(w."whsle_px_rmb-kg"), 2) AS "Wholesale_Price_Difference"
    FROM "veg_whsle_df" AS w
    INNER JOIN "veg_cat" AS c ON w."item_code" = c."item_code"
    WHERE w."whsle_date" BETWEEN '2020-01-01' AND '2023-12-31'
    GROUP BY "Year", c."category_name"
    LIMIT 100;
Answer:
Year,category_name,Wholesale_Price_Difference
2020,Aquatic Tuberous Vegetables,28.78
2020,Cabbage,9.2
2020,Capsicum,44.99
2020,Edible Mushroom,78.67
2020,Flower/Leaf Vegetables,45.26
2020,Solanum,9.43
2021,Aquatic Tuberous Vegetables,37.6
2021,Cabbage,13.07
2021,Capsicum,49.6
2021,Edible Mushroom,59.5
2021,Flower/Leaf Vegetables,58.43
2021,Solanum,13.85
2022,Aquatic Tuberous Vegetables,48.0
2022,Cabbage,12.26
2022,Capsicum,112.35
2022,Edible Mushroom,65.98
2022,Flower/Leaf Vegetables,40.44
2022,Solanum,15.81
2023,Aquatic Tuberous Vegetables,32.81
2023,Cabbage,10.7
2023,Capsicum,27.58
2023,Edible Mushroom,61.16
2023,Flower/Leaf Vegetables,140.99
2023,Solanum,10.71
Query:
SELECT c."category_name", ROUND(AVG(l."loss_rate_%"), 2) AS "Average_Loss_Rate"
    FROM "veg_loss_rate_df" AS l
    INNER JOIN "veg_cat" AS c ON l."item_code" = c."item_code"
    WHERE l."loss_rate_%" IS NOT NULL
    GROUP BY c."category_name"
    LIMIT 100;
Answer:
category_name,Average_Loss_Rate
Aquatic Tuberous Vegetables,11.97
Cabbage,14.14
Capsicum,8.52
Edible Mushroom,8.13
Flower/Leaf Vegetables,10.28
Solanum,7.12
Query:
SELECT strftime('%Y', w."whsle_date") AS "Year", c."category_name",
           ROUND(SUM(w."whsle_px_rmb-kg"), 2) AS "Total_Wholesale_Price"
    FROM "veg_whsle_df" AS w
    INNER JOIN "veg_cat" AS c ON w."item_code" = c."item_code"
    WHERE w."whsle_date" BETWEEN '2020-01-01' AND '2023-12-31' AND w."whsle_px_rmb-kg" IS NOT NULL
    GROUP BY "Year", c."category_name"
    LIMIT 100;
Answer:
Year,category_name,Total_Wholesale_Price
2020,Aquatic Tuberous Vegetables,3100.02
2020,Cabbage,2081.23
2020,Capsicum,16858.16
2020,Edible Mushroom,13418.15
2020,Flower/Leaf Vegetables,13164.04
2020,Solanum,3108.8
2021,Aquatic Tuberous Vegetables,8368.2
2021,Cabbage,4436.48
2021,Capsicum,34067.81
2021,Edible Mushroom,29824.91
2021,Flower/Leaf Vegetables,33801.62
2021,Solanum,7261.52
2022,Aquatic Tuberous Vegetables,12043.21
2022,Cabbage,3895.81
2022,Capsicum,34859.95
2022,Edible Mushroom,27710.04
2022,Flower/Leaf Vegetables,28349.77
2022,Solanum,7453.19
2023,Aquatic Tuberous Vegetables,6501.96
2023,Cabbage,2739.81
2023,Capsicum,12398.71
2023,Edible Mushroom,9801.5
2023,Flower/Leaf Vegetables,15405.66
2023,Solanum,3148.86
Query:
SELECT strftime('%Y', t."txn_date") AS "Year", c."category_name",
           ROUND(SUM(t."unit_selling_px_rmb/kg" * t."qty_sold(kg)"), 2) AS "Total_Selling_Price"
    FROM "veg_txn_df" AS t
    INNER JOIN "veg_cat" AS c ON t."item_code" = c."item_code"
    WHERE t."txn_date" BETWEEN '2020-01-01' AND '2023-12-31' AND t."unit_selling_px_rmb/kg" IS NOT NULL AND t."qty_sold(kg)" IS NOT NULL
    GROUP BY "Year", c."category_name"
    LIMIT 100;
Answer:
Year,category_name,Total_Selling_Price
2020,Aquatic Tuberous Vegetables,52632.11
2020,Cabbage,84182.93
2020,Capsicum,125532.39
2020,Edible Mushroom,138141.9
2020,Flower/Leaf Vegetables,234438.6
2020,Solanum,34601.35
2021,Aquatic Tuberous Vegetables,116848.79
2021,Cabbage,112078.95
2021,Capsicum,236386.53
2021,Edible Mushroom,206950.35
2021,Flower/Leaf Vegetables,364896.96
2021,Solanum,63201.07
2022,Aquatic Tuberous Vegetables,131482.06
2022,Cabbage,122287.35
2022,Capsicum,247008.65
2022,Edible Mushroom,168545.96
2022,Flower/Leaf Vegetables,308505.47
2022,Solanum,58942.91
2023,Aquatic Tuberous Vegetables,49126.94
2023,Cabbage,57202.49
2023,Capsicum,145205.45
2023,Edible Mushroom,105959.58
2023,Flower/Leaf Vegetables,171228.76
2023,Solanum,34378.93
Query:
SELECT c."category_name",
           ROUND(SUM(l."loss_rate_%" * s."Total_Qty_Sold" / 100), 2) AS "Total_Loss"
    FROM (
        SELECT "item_code", SUM("qty_sold(kg)") AS "Total_Qty_Sold"
        FROM "veg_txn_df"
        WHERE "txn_date" BETWEEN '2020-01-01' AND '2023-12-31'
        GROUP BY "item_code"
    ) AS s
    INNER JOIN "veg_loss_rate_df" AS l ON s."item_code" = l."item_code"
    INNER JOIN "veg_cat" AS c ON s."item_code" = c."item_code"
    GROUP BY c."category_name"
    LIMIT 100;
Answer:
category_name,Total_Loss
Aquatic Tuberous Vegetables,3344.39
Cabbage,4534.34
Capsicum,7382.63
Edible Mushroom,5150.39
Flower/Leaf Vegetables,24768.36
Solanum,1425.64
Query:
SELECT w."Year", w."category_name",
           ROUND(s."Total_Selling_Price" - w."Total_Wholesale_Price", 2) AS "Profit"
    FROM (
        SELECT strftime('%Y', w."whsle_date") AS "Year", c."category_name",
               SUM(w."whsle_px_rmb-kg") AS "Total_Wholesale_Price"
        FROM "veg_whsle_df" AS w
        INNER JOIN "veg_cat" AS c ON w."item_code" = c."item_code"
        WHERE w."whsle_date" BETWEEN '2020-01-01' AND '2023-12-31' AND w."whsle_px_rmb-kg" IS NOT NULL
        GROUP BY "Year", c."category_name"
    ) AS w
    INNER JOIN (
        SELECT strftime('%Y', t."txn_date") AS "Year", c."category_name",
               SUM(t."unit_selling_px_rmb/kg" * t."qty_sold(kg)") AS "Total_Selling_Price"
        FROM "veg_txn_df" AS t
        INNER JOIN "veg_cat" AS c ON t."item_code" = c."item_code"
        WHERE t."txn_date" BETWEEN '2020-01-01' AND '2023-12-31' AND t."unit_selling_px_rmb/kg" IS NOT NULL AND t."qty_sold(kg)" IS NOT NULL
        GROUP BY "Year", c."category_name"
    ) AS s ON w."Year" = s."Year" AND w."category_name" = s."category_name"
    LIMIT 100;
Answer:
Year,category_name,Profit
2020,Aquatic Tuberous Vegetables,49532.09
2020,Cabbage,82101.7
2020,Capsicum,108674.23
2020,Edible Mushroom,124723.75
2020,Flower/Leaf Vegetables,221274.56
2020,Solanum,31492.55
2021,Aquatic Tuberous Vegetables,108480.59
2021,Cabbage,107642.47
2021,Capsicum,202318.72
2021,Edible Mushroom,177125.44
2021,Flower/Leaf Vegetables,331095.34
2021,Solanum,55939.55
2022,Aquatic Tuberous Vegetables,119438.85
2022,Cabbage,118391.54
2022,Capsicum,212148.7
2022,Edible Mushroom,140835.92
2022,Flower/Leaf Vegetables,280155.7
2022,Solanum,51489.72
2023,Aquatic Tuberous Vegetables,42624.98
2023,Cabbage,54462.68
2023,Capsicum,132806.74
2023,Edible Mushroom,96158.08
2023,Flower/Leaf Vegetables,155823.1
2023,Solanum,31230.07
End Exploring Related Columns
Task: For veg whsle data, can you analyze our financial performance over the years 2020 to 2023? I need insights into the average wholesale price, maximum wholesale price, minimum wholesale price, wholesale price difference, total wholesale price, total selling price, average loss rate, total loss, and profit for each category within each year. Round all calculated values to two decimal places.

Please answer only one complete SQL in sqlite dialect in ```sql``` format.
Usage example: ```sql
SELECT DISTINCT "column_name" FROM "table_name" WHERE ... ``` (Replace "table_name" with the actual table name. Enclose table and column names with double quotations if they contain special characters or match reserved keywords.)
Follow the answer format like: Below is the analysis of the financial performance over the years 2020 to 2023 for each category, including the requested insights. All calculated values are rounded to two decimal places.

```csv
Year,Category,Average_Wholesale_Price,Maximum_Wholesale_Price,Minimum_Wholesale_Price,Wholesale_Price_Difference,Total_Wholesale_Price,Total_Selling_Price,Average_Loss_Rate,Total_Loss,Profit
year:int,category:str,avg_wholesale_price:float,max_wholesale_price:float,min_wholesale_price:float,wholesale_price_difference:float,total_wholesale_price:float,total_selling_price:float,avg_loss_rate:float,total_loss:float,profit:float
year:int,category:str,avg_wholesale_price:float,max_wholesale_price:float,min_wholesale_price:float,wholesale_price_difference:float,total_wholesale_price:float,total_selling_price:float,avg_loss_rate:float,total_loss:float,profit:float
...
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: 

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-28 04:47:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-28 04:47:32 - root - INFO - Below is the analysis of the financial performance over the years 2020 to 2023 for each category, including the requested insights. All calculated values are rounded to two decimal places.

```sql
WITH
avg_wholesale_prices AS (
    SELECT
        w."item_code",
        strftime('%Y', w."whsle_date") AS "Year",
        AVG(w."whsle_px_rmb-kg") AS "Avg_Wholesale_Price",
        MAX(w."whsle_px_rmb-kg") AS "Max_Wholesale_Price",
        MIN(w."whsle_px_rmb-kg") AS "Min_Wholesale_Price"
    FROM
        "veg_whsle_df" w
    WHERE
        w."whsle_date" BETWEEN '2020-01-01' AND '2023-12-31'
    GROUP BY
        w."item_code", "Year"
),
total_qty_sold AS (
    SELECT
        t."item_code",
        strftime('%Y', t."txn_date") AS "Year",
        SUM(t."qty_sold(kg)") AS "Total_Qty_Sold",
        SUM(t."qty_sold(kg)" * t."unit_selling_px_rmb/kg") AS "Total_Selling_Price"
    FROM
        "veg_txn_df" t
    WHERE
        t."txn_date" BETWEEN '2020-01-01' AND '2023-12-31'
    GROUP BY
        t."item_code", "Year"
),
loss_rate AS (
    SELECT
        l."item_code",
        l."loss_rate_%"
    FROM
        "veg_loss_rate_df" l
),
combined AS (
    SELECT
        t."item_code",
        t."Year",
        t."Total_Qty_Sold",
        t."Total_Selling_Price",
        a."Avg_Wholesale_Price",
        a."Max_Wholesale_Price",
        a."Min_Wholesale_Price",
        l."loss_rate_%"
    FROM
        total_qty_sold t
        LEFT JOIN avg_wholesale_prices a ON t."item_code" = a."item_code" AND t."Year" = a."Year"
        LEFT JOIN loss_rate l ON t."item_code" = l."item_code"
)
SELECT
    c."Year",
    cat."category_name" AS "Category",
    ROUND(AVG(c."Avg_Wholesale_Price"), 2) AS "Average_Wholesale_Price",
    ROUND(MAX(c."Max_Wholesale_Price"), 2) AS "Maximum_Wholesale_Price",
    ROUND(MIN(c."Min_Wholesale_Price"), 2) AS "Minimum_Wholesale_Price",
    ROUND(MAX(c."Max_Wholesale_Price") - MIN(c."Min_Wholesale_Price"), 2) AS "Wholesale_Price_Difference",
    ROUND(SUM(COALESCE(c."Avg_Wholesale_Price" * c."Total_Qty_Sold", 0)), 2) AS "Total_Wholesale_Price",
    ROUND(SUM(c."Total_Selling_Price"), 2) AS "Total_Selling_Price",
    ROUND(AVG(c."loss_rate_%"), 2) AS "Average_Loss_Rate",
    ROUND(SUM(COALESCE(c."Total_Qty_Sold" * c."loss_rate_%" / 100, 0)), 2) AS "Total_Loss",
    ROUND(SUM(c."Total_Selling_Price") - SUM(COALESCE(c."Avg_Wholesale_Price" * c."Total_Qty_Sold", 0)), 2) AS "Profit"
FROM
    combined c
    INNER JOIN "veg_cat" cat ON c."item_code" = cat."item_code"
WHERE
    c."Year" BETWEEN '2020' AND '2023'
GROUP BY
    c."Year", "Category"
ORDER BY
    c."Year", "Category";
```
2025-01-28 04:47:35 - root - INFO - itercount: 1
2025-01-28 04:47:35 - root - INFO - 0
2025-01-28 04:47:35 - root - INFO - results: 
Year,Category,Average_Wholesale_Price,Maximum_Wholesale_Price,Minimum_Wholesale_Price,Wholesale_Price_Difference,Total_Wholesale_Price,Total_Selling_Price,Average_Loss_Rate,Total_Loss,Profit
2020,Aquatic Tuberous Vegetables,8.03,29.54,0.76,28.78,38494.6,52632.11,14.07,441.46,14137.5
2020,Cabbage,5.66,10.8,1.6,9.2,55411.89,84182.93,13.16,1183.51,28771.04
2020,Capsicum,8.79,45.39,0.4,44.99,88428.48,125532.39,9.39,972.38,37103.91
2020,Edible Mushroom,11.2,80.0,1.33,78.67,86547.65,138141.9,10.24,1293.32,51594.25
2020,Flower/Leaf Vegetables,5.72,45.77,0.51,45.26,144551.46,234438.6,12.44,5836.97,89887.15
2020,Solanum,5.09,10.89,1.46,9.43,23876.59,34601.35,7.14,320.86,10724.76
2021,Aquatic Tuberous Vegetables,8.59,38.78,1.18,37.6,90515.61,116848.79,12.44,1028.98,26333.18
2021,Cabbage,6.38,14.38,1.31,13.07,79858.79,112078.95,17.28,1508.6,32220.15
2021,Capsicum,8.21,51.27,1.67,49.6,151980.29,236386.53,8.39,1678.9,84406.24
2021,Edible Mushroom,5.92,60.0,0.5,59.5,135275.0,206950.35,9.21,2154.36,71675.36
2021,Flower/Leaf Vegetables,4.94,58.6,0.17,58.43,245085.26,364896.96,11.6,8466.76,119811.7
2021,Solanum,5.69,14.45,0.6,13.85,44329.93,63201.07,6.13,491.37,18871.14
2022,Aquatic Tuberous Vegetables,7.19,48.01,0.01,48.0,93708.3,131482.06,11.68,1323.15,37773.76
2022,Cabbage,6.88,12.27,0.01,12.26,79235.82,122287.35,14.14,1322.62,43051.53
2022,Capsicum,7.54,112.36,0.01,112.35,162443.03,247008.65,8.61,2863.57,84565.62
2022,Edible Mushroom,6.5,65.99,0.01,65.98,107829.73,168545.96,7.8,1241.65,60716.23
2022,Flower/Leaf Vegetables,5.31,40.45,0.01,40.44,186735.19,308505.47,10.54,7176.46,121770.28
2022,Solanum,5.57,15.82,0.01,15.81,37596.31,58942.91,6.7,396.89,21346.6
2023,Aquatic Tuberous Vegetables,9.09,32.91,0.1,32.81,33481.02,49126.94,13.25,550.8,15645.92
2023,Cabbage,6.7,10.8,0.1,10.7,39912.55,57202.49,11.92,519.62,17289.94
2023,Capsicum,7.39,27.59,0.01,27.58,86644.43,145205.45,8.82,1867.77,58561.02
2023,Edible Mushroom,7.31,61.27,0.11,61.16,66213.22,105959.58,7.64,461.07,39746.36
2023,Flower/Leaf Vegetables,11.68,141.0,0.01,140.99,115866.54,171228.76,10.9,3288.16,55362.22
2023,Solanum,5.64,10.72,0.01,10.71,21772.98,34378.93,7.26,216.52,12605.95


2025-01-28 04:47:35 - root - INFO - Please check the answer again by reviewing For veg whsle data, can you analyze our financial performance over the years 2020 to 2023? I need insights into the average wholesale price, maximum wholesale price, minimum wholesale price, wholesale price difference, total wholesale price, total selling price, average loss rate, total loss, and profit for each category within each year. Round all calculated values to two decimal places., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: Below is the analysis of the financial performance over the years 2020 to 2023 for each category, including the requested insights. All calculated values are rounded to two decimal places.

```csv
Year,Category,Average_Wholesale_Price,Maximum_Wholesale_Price,Minimum_Wholesale_Price,Wholesale_Price_Difference,Total_Wholesale_Price,Total_Selling_Price,Average_Loss_Rate,Total_Loss,Profit
year:int,category:str,avg_wholesale_price:float,max_wholesale_price:float,min_wholesale_price:float,wholesale_price_difference:float,total_wholesale_price:float,total_selling_price:float,avg_loss_rate:float,total_loss:float,profit:float
year:int,category:str,avg_wholesale_price:float,max_wholesale_price:float,min_wholesale_price:float,wholesale_price_difference:float,total_wholesale_price:float,total_selling_price:float,avg_loss_rate:float,total_loss:float,profit:float
...
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Year,Category,Average_Wholesale_Price,Maximum_Wholesale_Price,Minimum_Wholesale_Price,Wholesale_Price_Difference,Total_Wholesale_Price,Total_Selling_Price,Average_Loss_Rate,Total_Loss,Profit
2020,Aquatic Tuberous Vegetables,8.03,29.54,0.76,28.78,38494.6,52632.11,14.07,441.46,14137.5
2020,Cabbage,5.66,10.8,1.6,9.2,55411.89,84182.93,13.16,1183.51,28771.04
2020,Capsicum,8.79,45.39,0.4,44.99,88428.48,125532.39,9.39,972.38,37103.91
2020,Edible Mushroom,11.2,80.0,1.33,78.67,86547.65,138141.9,10.24,1293.32,51594.25
2020,Flower/Leaf Vegetables,5.72,45.77,0.51,45.26,144551.46,234438.6,12.44,5836.97,89887.15
2020,Solanum,5.09,10.89,1.46,9.43,23876.59,34601.35,7.14,320.86,10724.76
2021,Aquatic Tuberous Vegetables,8.59,38.78,1.18,37.6,90515.61,116848.79,12.44,1028.98,26333.18
2021,Cabbage,6.38,14.38,1.31,13.07,79858.79,112078.95,17.28,1508.6,32220.15
2021,Capsicum,8.21,51.27,1.67,49.6,151980.29,236386.53,8.39,1678.9,84406.24
2021,Edible Mushroom,5.92,60.0,0.5,59.5,135275.0,206950.35,9.21,2154.36,71675.36
2021,Flower/Leaf Vegetables,4.94,58.6,0.17,58.43,245085.26,364896.96,11.6,8466.76,119811.7
2021,Solanum,5.69,14.45,0.6,13.85,44329.93,63201.07,6.13,491.37,18871.14
2022,Aquatic Tuberous Vegetables,7.19,48.01,0.01,48.0,93708.3,131482.06,11.68,1323.15,37773.76
2022,Cabbage,6.88,12.27,0.01,12.26,79235.82,122287.35,14.14,1322.62,43051.53
2022,Capsicum,7.54,112.36,0.01,112.35,162443.03,247008.65,8.61,2863.57,84565.62
2022,Edible Mushroom,6.5,65.99,0.01,65.98,107829.73,168545.96,7.8,1241.65,60716.23
2022,Flower/Leaf Vegetables,5.31,40.45,0.01,40.44,186735.19,308505.47,10.54,7176.46,121770.28
2022,Solanum,5.57,15.82,0.01,15.81,37596.31,58942.91,6.7,396.89,21346.6
2023,Aquatic Tuberous Vegetables,9.09,32.91,0.1,32.81,33481.02,49126.94,13.25,550.8,15645.92
2023,Cabbage,6.7,10.8,0.1,10.7,39912.55,57202.49,11.92,519.62,17289.94
2023,Capsicum,7.39,27.59,0.01,27.58,86644.43,145205.45,8.82,1867.77,58561.02
2023,Edible Mushroom,7.31,61.27,0.11,61.16,66213.22,105959.58,7.64,461.07,39746.36
2023,Flower/Leaf Vegetables,11.68,141.0,0.01,140.99,115866.54,171228.76,10.9,3288.16,55362.22
2023,Solanum,5.64,10.72,0.01,10.71,21772.98,34378.93,7.26,216.52,12605.95
Current sql:
WITH
avg_wholesale_prices AS (
    SELECT
        w."item_code",
        strftime('%Y', w."whsle_date") AS "Year",
        AVG(w."whsle_px_rmb-kg") AS "Avg_Wholesale_Price",
        MAX(w."whsle_px_rmb-kg") AS "Max_Wholesale_Price",
        MIN(w."whsle_px_rmb-kg") AS "Min_Wholesale_Price"
    FROM
        "veg_whsle_df" w
    WHERE
        w."whsle_date" BETWEEN '2020-01-01' AND '2023-12-31'
    GROUP BY
        w."item_code", "Year"
),
total_qty_sold AS (
    SELECT
        t."item_code",
        strftime('%Y', t."txn_date") AS "Year",
        SUM(t."qty_sold(kg)") AS "Total_Qty_Sold",
        SUM(t."qty_sold(kg)" * t."unit_selling_px_rmb/kg") AS "Total_Selling_Price"
    FROM
        "veg_txn_df" t
    WHERE
        t."txn_date" BETWEEN '2020-01-01' AND '2023-12-31'
    GROUP BY
        t."item_code", "Year"
),
loss_rate AS (
    SELECT
        l."item_code",
        l."loss_rate_%"
    FROM
        "veg_loss_rate_df" l
),
combined AS (
    SELECT
        t."item_code",
        t."Year",
        t."Total_Qty_Sold",
        t."Total_Selling_Price",
        a."Avg_Wholesale_Price",
        a."Max_Wholesale_Price",
        a."Min_Wholesale_Price",
        l."loss_rate_%"
    FROM
        total_qty_sold t
        LEFT JOIN avg_wholesale_prices a ON t."item_code" = a."item_code" AND t."Year" = a."Year"
        LEFT JOIN loss_rate l ON t."item_code" = l."item_code"
)
SELECT
    c."Year",
    cat."category_name" AS "Category",
    ROUND(AVG(c."Avg_Wholesale_Price"), 2) AS "Average_Wholesale_Price",
    ROUND(MAX(c."Max_Wholesale_Price"), 2) AS "Maximum_Wholesale_Price",
    ROUND(MIN(c."Min_Wholesale_Price"), 2) AS "Minimum_Wholesale_Price",
    ROUND(MAX(c."Max_Wholesale_Price") - MIN(c."Min_Wholesale_Price"), 2) AS "Wholesale_Price_Difference",
    ROUND(SUM(COALESCE(c."Avg_Wholesale_Price" * c."Total_Qty_Sold", 0)), 2) AS "Total_Wholesale_Price",
    ROUND(SUM(c."Total_Selling_Price"), 2) AS "Total_Selling_Price",
    ROUND(AVG(c."loss_rate_%"), 2) AS "Average_Loss_Rate",
    ROUND(SUM(COALESCE(c."Total_Qty_Sold" * c."loss_rate_%" / 100, 0)), 2) AS "Total_Loss",
    ROUND(SUM(c."Total_Selling_Price") - SUM(COALESCE(c."Avg_Wholesale_Price" * c."Total_Qty_Sold", 0)), 2) AS "Profit"
FROM
    combined c
    INNER JOIN "veg_cat" cat ON c."item_code" = cat."item_code"
WHERE
    c."Year" BETWEEN '2020' AND '2023'
GROUP BY
    c."Year", "Category"
ORDER BY
    c."Year", "Category";
2025-01-28 04:48:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-28 04:48:40 - root - INFO - Below is the analysis of the financial performance over the years 2020 to 2023 for each category, including the requested insights. All calculated values are rounded to two decimal places.

```csv
Year,Category,Average_Wholesale_Price,Maximum_Wholesale_Price,Minimum_Wholesale_Price,Wholesale_Price_Difference,Total_Wholesale_Price,Total_Selling_Price,Average_Loss_Rate,Total_Loss,Profit
year:int,category:str,avg_wholesale_price:float,max_wholesale_price:float,min_wholesale_price:float,wholesale_price_difference:float,total_wholesale_price:float,total_selling_price:float,avg_loss_rate:float,total_loss:float,profit:float
2020,Aquatic Tuberous Vegetables,8.03,29.54,0.76,28.78,38494.60,52632.11,14.07,441.46,14137.51
2020,Cabbage,5.66,10.80,1.60,9.20,55411.89,84182.93,13.16,1183.51,28771.04
2020,Capsicum,8.79,45.39,0.40,44.99,88428.48,125532.39,9.39,972.38,37103.91
2020,Edible Mushroom,11.20,80.00,1.33,78.67,86547.65,138141.90,10.24,1293.32,51594.25
2020,Flower/Leaf Vegetables,5.72,45.77,0.51,45.26,144551.46,234438.60,12.44,5836.97,89887.14
2020,Solanum,5.09,10.89,1.46,9.43,23876.59,34601.35,7.14,320.86,10724.76
2021,Aquatic Tuberous Vegetables,8.59,38.78,1.18,37.60,90515.61,116848.79,12.44,1028.98,26333.18
2021,Cabbage,6.38,14.38,1.31,13.07,79858.79,112078.95,17.28,1508.60,32220.15
2021,Capsicum,8.21,51.27,1.67,49.60,151980.29,236386.53,8.39,1678.90,84406.24
2021,Edible Mushroom,5.92,60.00,0.50,59.50,135275.00,206950.35,9.21,2154.36,71675.35
2021,Flower/Leaf Vegetables,4.94,58.60,0.17,58.43,245085.26,364896.96,11.60,8466.76,119811.70
2021,Solanum,5.69,14.45,0.60,13.85,44329.93,63201.07,6.13,491.37,18871.14
2022,Aquatic Tuberous Vegetables,7.19,48.01,0.01,48.00,93708.30,131482.06,11.68,1323.15,37773.76
2022,Cabbage,6.88,12.27,0.01,12.26,79235.82,122287.35,14.14,1322.62,43051.53
2022,Capsicum,7.54,112.36,0.01,112.35,162443.03,247008.65,8.61,2863.57,84565.62
2022,Edible Mushroom,6.50,65.99,0.01,65.98,107829.73,168545.96,7.80,1241.65,60716.23
2022,Flower/Leaf Vegetables,5.31,40.45,0.01,40.44,186735.19,308505.47,10.54,7176.46,121770.28
2022,Solanum,5.57,15.82,0.01,15.81,37596.31,58942.91,6.70,396.89,21346.60
2023,Aquatic Tuberous Vegetables,9.09,32.91,0.10,32.81,33481.02,49126.94,13.25,550.80,15645.92
2023,Cabbage,6.70,10.80,0.10,10.70,39912.55,57202.49,11.92,519.62,17289.94
2023,Capsicum,7.39,27.59,0.01,27.58,86644.43,145205.45,8.82,1867.77,58561.02
2023,Edible Mushroom,7.31,61.27,0.11,61.16,66213.22,105959.58,7.64,461.07,39746.36
2023,Flower/Leaf Vegetables,11.68,141.00,0.01,140.99,115866.54,171228.76,10.90,3288.16,55362.22
2023,Solanum,5.64,10.72,0.01,10.71,21772.98,34378.93,7.26,216.52,12605.95
```

Current SQL:

```sql
WITH
    avg_wholesale_prices AS (
        SELECT
            w."item_code",
            strftime('%Y', w."whsle_date") AS "Year",
            AVG(w."whsle_px_rmb-kg") AS "Avg_Wholesale_Price",
            MAX(w."whsle_px_rmb-kg") AS "Max_Wholesale_Price",
            MIN(w."whsle_px_rmb-kg") AS "Min_Wholesale_Price"
        FROM
            "veg_whsle_df" w
        WHERE
            w."whsle_date" BETWEEN '2020-01-01' AND '2023-12-31'
        GROUP BY
            w."item_code", "Year"
    ),
    total_qty_sold AS (
        SELECT
            t."item_code",
            strftime('%Y', t."txn_date") AS "Year",
            SUM(t."qty_sold(kg)") AS "Total_Qty_Sold",
            SUM(t."qty_sold(kg)" * t."unit_selling_px_rmb/kg") AS "Total_Selling_Price"
        FROM
            "veg_txn_df" t
        WHERE
            t."txn_date" BETWEEN '2020-01-01' AND '2023-12-31'
        GROUP BY
            t."item_code", "Year"
    ),
    loss_rate AS (
        SELECT
            l."item_code",
            l."loss_rate_%"
        FROM
            "veg_loss_rate_df" l
    ),
    combined AS (
        SELECT
            t."item_code",
            t."Year",
            t."Total_Qty_Sold",
            t."Total_Selling_Price",
            a."Avg_Wholesale_Price",
            a."Max_Wholesale_Price",
            a."Min_Wholesale_Price",
            l."loss_rate_%"
        FROM
            total_qty_sold t
            LEFT JOIN avg_wholesale_prices a ON t."item_code" = a."item_code" AND t."Year" = a."Year"
            LEFT JOIN loss_rate l ON t."item_code" = l."item_code"
    )
SELECT
    c."Year",
    cat."category_name" AS "Category",
    ROUND(AVG(c."Avg_Wholesale_Price"), 2) AS "Average_Wholesale_Price",
    ROUND(MAX(c."Max_Wholesale_Price"), 2) AS "Maximum_Wholesale_Price",
    ROUND(MIN(c."Min_Wholesale_Price"), 2) AS "Minimum_Wholesale_Price",
    ROUND(MAX(c."Max_Wholesale_Price") - MIN(c."Min_Wholesale_Price"), 2) AS "Wholesale_Price_Difference",
    ROUND(SUM(COALESCE(c."Avg_Wholesale_Price" * c."Total_Qty_Sold", 0)), 2) AS "Total_Wholesale_Price",
    ROUND(SUM(c."Total_Selling_Price"), 2) AS "Total_Selling_Price",
    ROUND(AVG(c."loss_rate_%"), 2) AS "Average_Loss_Rate",
    ROUND(SUM(COALESCE(c."Total_Qty_Sold" * c."loss_rate_%" / 100, 0)), 2) AS "Total_Loss",
    ROUND(SUM(c."Total_Selling_Price") - SUM(COALESCE(c."Avg_Wholesale_Price" * c."Total_Qty_Sold", 0)), 2) AS "Profit"
FROM
    combined c
    INNER JOIN "veg_cat" cat ON c."item_code" = cat."item_code"
WHERE
    c."Year" BETWEEN '2020' AND '2023'
GROUP BY
    c."Year", "Category"
ORDER BY
    c."Year", "Category";
```
2025-01-28 04:48:43 - root - INFO - itercount: 2
2025-01-28 04:48:43 - root - INFO - 0
2025-01-28 04:48:43 - root - INFO - Total iteration counts: 2
