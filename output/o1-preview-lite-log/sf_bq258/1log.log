2025-01-26 08:08:41 - openai._base_client - INFO - Retrying request to /chat/completions in 0.433860 seconds
2025-01-26 08:09:49 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 08:09:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:09:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:09:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:09:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 26
2025-01-26 08:09:50 - snowflake.connector.connection - INFO - closed
2025-01-26 08:09:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:09:51 - root - INFO - SQL:
SELECT DISTINCT "category"
   FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS"
   LIMIT 100;
Results:
category
Accessories
Plus
Swim
Active
Socks & Hosiery
Socks
Dresses
Pants & Capris
Fashion Hoodies & Sweatshirts
Skirts
Blazers & Jackets
Suits
Tops & Tees
Sweaters
Jeans
Sleep & Lounge
Suits & Sport Coats
Pants
Intimates
Outerwear & Coats
Maternity
Jumpsuits & Rompers
Clothing Sets
Underwear
Shorts
Leggings

2025-01-26 08:09:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:09:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:09:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:09:52 - snowflake.connector.connection - INFO - closed
2025-01-26 08:09:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:10:19 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 08:10:19 - root - INFO - The error you're encountering occurs because the `"delivered_at"` column is of numeric type (`NUMBER(38,0)`), and you're trying to compare it directly to a string `'2022-01-01'`. The database doesn't recognize the string `'2022-01-01'` as a numeric value, leading to the error:

```
100038 (22018): Numeric value '2022-01-01' is not recognized
```

**Explanation:**

- **Data Type Mismatch:** The `"delivered_at"` column stores numeric values, likely Unix timestamps (number of seconds since January 1, 1970).
- **Invalid Comparison:** Comparing a numeric column directly to a date string without proper conversion causes a data type mismatch.

**Solution:**

To fix this, you need to convert the numeric Unix timestamp in `"delivered_at"` to a `TIMESTAMP` data type using the `TO_TIMESTAMP` function before performing the comparison.

Here's the corrected SQL query:

```sql
SELECT "order_id", "product_id", "sale_price", "delivered_at"
FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS"
WHERE TO_TIMESTAMP("delivered_at") < '2022-01-01'
LIMIT 100;
```

**Additional Details:**

- **Conversion Function:** `TO_TIMESTAMP("delivered_at")` converts the numeric Unix timestamp to a `TIMESTAMP` value.
- **Date Comparison:** Now that both sides of the comparison are dates, the query can execute without errors.
- **Consistent Data Types:** Ensure that any date or time comparisons involve consistent data types.

**Verifying the Data:**

To better understand the data in the `"delivered_at"` column, you can run the following query to view the original numeric values alongside their converted timestamps:

```sql
SELECT "delivered_at", TO_TIMESTAMP("delivered_at") AS "delivered_timestamp"
FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS"
LIMIT 10;
```

**Example Results:**

| delivered_at | delivered_timestamp     |
|--------------|-------------------------|
| 1614556800   | 2021-03-01 00:00:00.000 |
| 1609459200   | 2021-01-01 00:00:00.000 |
| 1601510400   | 2020-10-01 00:00:00.000 |
| ...          | ...                     |

This shows how the numeric timestamps correspond to actual dates.

**Applying the Same Correction to Other Queries:**

When working with other date/time fields such as `"created_at"`, `"shipped_at"`, etc., which are also stored as numeric Unix timestamps, you should convert them using `TO_TIMESTAMP` before performing date comparisons or extracting date parts.

**Modified Queries:**

Here are some of the earlier queries adjusted to account for the Unix timestamp data type:

1. **Get monthly order count per category:**

   ```sql
   SELECT p."category",
          DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at")) AS "month",
          COUNT(*) AS "order_count"
   FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
   JOIN THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
     ON oi."product_id" = p."id"
   GROUP BY p."category", "month"
   LIMIT 100;
   ```

2. **Compute total cost per category per month:**

   ```sql
   SELECT p."category",
          DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at")) AS "month",
          SUM(p."cost") AS "total_cost"
   FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
   JOIN THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
     ON oi."product_id" = p."id"
   WHERE TO_TIMESTAMP(oi."delivered_at") < '2022-01-01'
   GROUP BY p."category", "month"
   LIMIT 100;
   ```

3. **Calculate profit per category per month:**

   ```sql
   SELECT p."category",
          DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at")) AS "month",
          SUM(oi."sale_price" - p."cost") AS "profit"
   FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
   JOIN THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
     ON oi."product_id" = p."id"
   WHERE TO_TIMESTAMP(oi."delivered_at") < '2022-01-01'
   GROUP BY p."category", "month"
   LIMIT 100;
   ```

**Important Notes:**

- **Date Literals:** In Snowflake, date literals like `'2022-01-01'` are automatically interpreted as `DATE` data types.
- **Unix Timestamps:** Since your timestamp columns are stored as Unix timestamps, always use `TO_TIMESTAMP` to convert them before any date manipulation.
- **Consistent Use:** Apply the `TO_TIMESTAMP` function consistently across all queries where date comparisons or date part extractions are needed.

**Final Thoughts:**

By ensuring that all date/time fields are properly converted to `TIMESTAMP` types before performing operations, you can avoid data type mismatches and execute your queries successfully.

---

Feel free to apply these adjustments to your queries, and let me know if you need further assistance!
2025-01-26 08:10:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:10:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:10:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:10:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-26 08:10:21 - snowflake.connector.connection - INFO - closed
2025-01-26 08:10:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:10:50 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 08:10:50 - root - INFO - ```sql
SELECT "order_id", "product_id", "sale_price", "delivered_at", TO_TIMESTAMP("delivered_at") AS "delivered_date"
FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS"
LIMIT 100;
```
2025-01-26 08:10:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:10:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:10:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:10:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 08:10:51 - snowflake.connector.connection - INFO - closed
2025-01-26 08:10:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:11:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 08:11:17 - root - INFO - ```sql
SELECT "order_id", "product_id", "sale_price", "delivered_at", TRY_TO_TIMESTAMP("delivered_at") AS "delivered_date"
FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS"
WHERE TRY_TO_TIMESTAMP("delivered_at") < '2022-01-01' AND TRY_TO_TIMESTAMP("delivered_at") IS NOT NULL
LIMIT 100;
```
2025-01-26 08:11:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:11:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:11:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:11:18 - snowflake.connector.connection - INFO - closed
2025-01-26 08:11:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:11:18 - root - INFO - SQL:
SELECT "order_id", "product_id", "sale_price", "delivered_at", TRY_TO_TIMESTAMP("delivered_at") AS "delivered_date"
FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS"
WHERE TRY_TO_TIMESTAMP("delivered_at") < '2022-01-01' AND TRY_TO_TIMESTAMP("delivered_at") IS NOT NULL
LIMIT 100;
Results:
001065 (22023): 01b9f72b-0004-8343-0001-11c300fac98e: SQL compilation error:
Function TRY_CAST cannot be used with arguments of types NUMBER(38,0) and TIMESTAMP_NTZ(0)
2025-01-26 08:11:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:11:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:11:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:11:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-26 08:11:20 - snowflake.connector.connection - INFO - closed
2025-01-26 08:11:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:12:07 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 08:12:07 - root - INFO - ```sql
SELECT
  p."category",
  DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at")) AS "month",
  SUM(oi."sale_price") AS "monthly_revenue",
  COUNT(oi."order_id") AS "orders_count",
  SUM(p."cost") AS "total_cost",
  SUM(oi."sale_price" - p."cost") AS "profit",
  CASE WHEN SUM(p."cost") <> 0 THEN SUM(oi."sale_price" - p."cost") / SUM(p."cost") ELSE NULL END AS "profit_to_cost_ratio"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
  ON oi."product_id" = p."id"
WHERE
  TO_TIMESTAMP(oi."created_at") < '2022-01-01'
GROUP BY
  p."category", "month"
ORDER BY
  p."category", "month"
LIMIT 100;
```
2025-01-26 08:12:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:12:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:12:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:12:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-26 08:12:09 - snowflake.connector.connection - INFO - closed
2025-01-26 08:12:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:12:53 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 08:12:53 - root - INFO - ```sql
SELECT
  p."category",
  DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at" / 1000)) AS "month",
  SUM(oi."sale_price") AS "monthly_revenue",
  COUNT(DISTINCT oi."order_id") AS "orders_count",
  SUM(p."cost") AS "total_cost",
  SUM(oi."sale_price" - p."cost") AS "profit",
  CASE WHEN SUM(p."cost") <> 0 THEN ROUND(SUM(oi."sale_price" - p."cost") / SUM(p."cost"), 2) ELSE NULL END AS "profit_to_cost_ratio"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
  ON oi."product_id" = p."id"
GROUP BY
  p."category",
  "month"
ORDER BY
  p."category",
  "month"
LIMIT 100;
```
2025-01-26 08:12:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:12:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:12:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:12:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 08:12:54 - snowflake.connector.connection - INFO - closed
2025-01-26 08:12:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:13:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 08:13:25 - root - INFO - ```sql
SELECT "order_id", "product_id", "sale_price", "status", "delivered_at"
FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS"
WHERE "status" = 'Completed'
LIMIT 100;
```
2025-01-26 08:13:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:13:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:13:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:13:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-26 08:13:27 - snowflake.connector.connection - INFO - closed
2025-01-26 08:13:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:13:27 - root - INFO - SQL:
SELECT "order_id", "product_id", "sale_price", "status", "delivered_at"
FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS"
WHERE "status" = 'Completed'
LIMIT 100;
Results:
No data found for the specified query.

2025-01-26 08:13:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:13:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:13:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:13:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 08:13:29 - snowflake.connector.connection - INFO - closed
2025-01-26 08:13:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:13:29 - root - INFO - SQL:
SELECT oi."order_id", oi."product_id", p."category", oi."sale_price"
   FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
   JOIN THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
     ON oi."product_id" = p."id"
   LIMIT 100;
Results:
order_id,product_id,category,sale_price
14805,14235,Accessories,0.0199999995529651
71201,14235,Accessories,0.0199999995529651
81114,14235,Accessories,0.0199999995529651
109826,14235,Accessories,0.0199999995529651
49859,14235,Accessories,0.0199999995529651
6684,14235,Accessories,0.0199999995529651
82012,14159,Accessories,0.4900000095367431
28060,14159,Accessories,0.4900000095367431
63169,14159,Accessories,0.4900000095367431
12239,14159,Accessories,0.4900000095367431
50479,14159,Accessories,0.4900000095367431
73832,14159,Accessories,0.4900000095367431
108606,14159,Accessories,0.4900000095367431
114916,14159,Accessories,0.4900000095367431
35245,14202,Accessories,1.5
42210,14202,Accessories,1.5
5718,14202,Accessories,1.5
6074,14202,Accessories,1.5
25844,14202,Accessories,1.5
33209,14202,Accessories,1.5
57511,28700,Accessories,1.5
108498,28700,Accessories,1.5
5338,28700,Accessories,1.5
33098,14202,Accessories,1.5
76384,28700,Accessories,1.5
101325,14202,Accessories,1.5
7232,14202,Accessories,1.5
46807,14202,Accessories,1.5
120416,28700,Accessories,1.5
61834,13629,Accessories,1.5099999904632568
79332,13629,Accessories,1.5099999904632568
14956,13629,Accessories,1.5099999904632568
3229,13629,Accessories,1.5099999904632568
69780,13629,Accessories,1.5099999904632568
103440,13629,Accessories,1.5099999904632568
100896,13629,Accessories,1.5099999904632568
18515,13629,Accessories,1.5099999904632568
18022,14298,Accessories,1.7200000286102295
63483,14298,Accessories,1.7200000286102295
90395,12536,Intimates,1.75
105059,12536,Intimates,1.75
122880,12536,Intimates,1.75
106189,12536,Intimates,1.75
21501,15332,Plus,1.8200000524520876
35298,15332,Plus,1.8200000524520876
111104,15332,Plus,1.8200000524520876
7274,15332,Plus,1.8200000524520876
11963,15332,Plus,1.8200000524520876
12507,15332,Plus,1.8200000524520876
83546,15332,Plus,1.8200000524520876
33669,13659,Accessories,1.8200000524520876
34236,13659,Accessories,1.8200000524520876
105655,15332,Plus,1.8200000524520876
111185,15332,Plus,1.8200000524520876
112616,15332,Plus,1.8200000524520876
54378,15332,Plus,1.8200000524520876
6059,15332,Plus,1.8200000524520876
28271,13659,Accessories,1.8200000524520876
34370,13659,Accessories,1.8200000524520876
55186,15332,Plus,1.8200000524520876
62067,13659,Accessories,1.8200000524520876
88741,15332,Plus,1.8200000524520876
11966,9204,Socks & Hosiery,1.950000047683716
72980,3049,Active,1.950000047683716
21690,3049,Active,1.950000047683716
80738,3049,Active,1.950000047683716
119820,3049,Active,1.950000047683716
29862,3049,Active,1.950000047683716
115326,9204,Socks & Hosiery,1.950000047683716
121983,3049,Active,1.950000047683716
20438,3049,Active,1.950000047683716
32712,14549,Maternity,1.9800000190734863
100600,14549,Maternity,1.9800000190734863
73565,14549,Maternity,1.9800000190734863
18204,14549,Maternity,1.9800000190734863
26774,14549,Maternity,1.9800000190734863
70016,14549,Maternity,1.9800000190734863
72412,14549,Maternity,1.9800000190734863
80353,14549,Maternity,1.9800000190734863
34337,13606,Accessories,2.5
119193,13606,Accessories,2.5
70001,13606,Accessories,2.5
33789,13606,Accessories,2.5
9452,13606,Accessories,2.5
74155,13606,Accessories,2.5
78943,13606,Accessories,2.5
82140,13606,Accessories,2.5
115070,13606,Accessories,2.5
29512,28913,Accessories,2.5899999141693115
65881,28913,Accessories,2.5899999141693115
20397,28913,Accessories,2.5899999141693115
9775,28913,Accessories,2.5899999141693115
11503,28913,Accessories,2.5899999141693115
79830,28913,Accessories,2.5899999141693115
85088,28913,Accessories,2.5899999141693115
33372,28913,Accessories,2.5899999141693115
6653,13690,Accessories,2.6700000762939453
41376,13690,Accessories,2.6700000762939453
5930,15395,Plus,2.6700000762939453
10820,13690,Accessories,2.6700000762939453

2025-01-26 08:13:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:13:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:13:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:13:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 26
2025-01-26 08:13:30 - snowflake.connector.connection - INFO - closed
2025-01-26 08:13:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:13:31 - root - INFO - SQL:
SELECT p."category", SUM(oi."sale_price") AS "total_revenue"
   FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
   JOIN THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
     ON oi."product_id" = p."id"
   GROUP BY p."category"
   LIMIT 100;
Results:
category,total_revenue
Accessories,426937.3099739477
Intimates,443541.7106554508
Socks & Hosiery,62033.70993947983
Sleep & Lounge,548868.940983057
Tops & Tees,497956.07168388367
Leggings,87022.33988285065
Shorts,515053.82150888443
Sweaters,816881.8499956131
Underwear,203074.67025232315
Blazers & Jackets,284830.890540123
Pants & Capris,183690.72078704834
Dresses,447111.8608894348
Jumpsuits & Rompers,41770.06012630463
Fashion Hoodies & Sweatshirts,653688.1405649185
Pants,422951.41153144836
Suits & Sport Coats,635448.5994358063
Suits,128779.5800743103
Plus,158538.950476408
Jeans,1256239.8812875748
Socks,126569.1599957943
Active,441559.9801414013
Maternity,262485.38956069946
Swim,649922.6206922531
Skirts,102504.10020780563
Outerwear & Coats,1322241.8987178802
Clothing Sets,18734.360023498535

2025-01-26 08:13:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:13:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:13:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:13:32 - snowflake.connector.connection - INFO - closed
2025-01-26 08:13:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:13:44 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 08:13:44 - root - INFO - ```sql
SELECT
  p."category",
  DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at" / 1000)) AS "month",
  COUNT(*) AS "order_count"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
  ON oi."product_id" = p."id"
GROUP BY
  p."category",
  "month"
LIMIT 100;
```
2025-01-26 08:13:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:13:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:13:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:13:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 08:13:46 - snowflake.connector.connection - INFO - closed
2025-01-26 08:13:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:14:16 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 08:14:16 - root - INFO - ```sql
SELECT
  p."category",
  DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at" / 1000000)) AS "month",
  COUNT(*) AS "order_count"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
  ON oi."product_id" = p."id"
GROUP BY
  p."category",
  DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at" / 1000000))
LIMIT 100;
```
2025-01-26 08:14:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:14:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:14:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:14:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 08:14:17 - snowflake.connector.connection - INFO - closed
2025-01-26 08:14:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:15:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 08:15:01 - root - INFO - SQL:
SELECT
  p."category",
  DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at" / 1000000)) AS "month",
  COUNT(*) AS "order_count"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
  ON oi."product_id" = p."id"
GROUP BY
  p."category",
  DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at" / 1000000))
LIMIT 100;
Results:
category,month,order_count
Accessories,2024-07-01,422
Accessories,2024-01-01,267
Accessories,2024-10-01,728
Accessories,2024-02-01,300
Accessories,2024-06-01,377
Accessories,2022-02-01,90
Accessories,2024-04-01,345
Accessories,2024-09-01,570
Accessories,2024-03-01,321
Accessories,2022-10-01,137
Plus,2024-10-01,346
Plus,2022-03-01,59
Accessories,2022-07-01,122
Maternity,2023-12-01,160
Intimates,2024-09-01,744
Accessories,2023-11-01,286
Accessories,2022-11-01,167
Intimates,2024-06-01,507
Plus,2024-09-01,234
Accessories,2023-08-01,238
Plus,2023-06-01,73
Socks,2023-12-01,184
Intimates,2022-05-01,146
Sleep & Lounge,2021-02-01,61
Accessories,2020-06-01,33
Accessories,2022-03-01,111
Plus,2023-09-01,96
Plus,2024-06-01,167
Plus,2024-04-01,148
Plus,2020-11-01,32
Accessories,2023-06-01,182
Accessories,2019-05-01,6
Intimates,2023-04-01,249
Intimates,2023-11-01,348
Plus,2024-02-01,103
Intimates,2024-05-01,480
Socks,2021-06-01,50
Socks & Hosiery,2024-04-01,127
Plus,2022-08-01,57
Socks & Hosiery,2024-08-01,180
Leggings,2020-12-01,19
Tops & Tees,2023-08-01,259
Underwear,2024-02-01,218
Tops & Tees,2023-07-01,260
Sleep & Lounge,2024-04-01,362
Plus,2024-03-01,124
Socks & Hosiery,2022-12-01,62
Socks & Hosiery,2023-02-01,64
Plus,2024-07-01,193
Socks,2024-09-01,366
Socks,2021-10-01,64
Socks,2019-07-01,10
Socks,2023-03-01,106
Intimates,2020-11-01,89
Socks,2019-10-01,12
Leggings,2020-10-01,18
Socks,2023-02-01,108
Tops & Tees,2022-03-01,151
Plus,2020-03-01,19
Socks,2020-10-01,30
Shorts,2020-11-01,68
Leggings,2020-03-01,19
Active,2022-11-01,154
Accessories,2021-08-01,74
Accessories,2024-08-01,489
Maternity,2021-09-01,45
Accessories,2023-07-01,219
Intimates,2024-02-01,399
Accessories,2021-10-01,92
Plus,2022-11-01,60
Socks,2023-09-01,150
Active,2024-03-01,300
Accessories,2023-03-01,173
Accessories,2023-01-01,169
Maternity,2023-04-01,79
Accessories,2021-11-01,86
Accessories,2022-09-01,140
Accessories,2021-07-01,94
Socks & Hosiery,2023-11-01,98
Socks,2021-12-01,56
Intimates,2023-05-01,261
Plus,2022-05-01,49
Plus,2021-02-01,30
Sleep & Lounge,2024-10-01,798
Intimates,2024-01-01,412
Accessories,2023-05-01,186
Intimates,2019-07-01,14
Intimates,2023-01-01,210
Accessories,2019-03-01,3
Accessories,2021-05-01,65
Active,2024-06-01,337
Leggings,2020-04-01,20
Intimates,2020-09-01,65
Shorts,2021-09-01,115
Shorts,2021-10-01,107
Active,2024-08-01,428
Socks,2020-02-01,17
Socks & Hosiery,2022-08-01,59
Accessories,2020-04-01,42
Plus,2023-01-01,60

2025-01-26 08:15:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:15:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:15:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:15:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-26 08:15:02 - snowflake.connector.connection - INFO - closed
2025-01-26 08:15:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:15:24 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 08:15:24 - root - INFO - ```sql
SELECT
  p."category",
  DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at" / 1000)) AS "month",
  COUNT(*) AS "order_count"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
  ON oi."product_id" = p."id"
GROUP BY
  p."category",
  DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at" / 1000))
LIMIT 100;
```
2025-01-26 08:15:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:15:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:15:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:15:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 08:15:26 - snowflake.connector.connection - INFO - closed
2025-01-26 08:15:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:16:04 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 08:16:04 - root - INFO - ```sql
SELECT
  p."category",
  DATE_TRUNC('month', TO_TIMESTAMP_NTZ(oi."created_at", 'epoch_milliseconds')) AS "month",
  SUM(p."cost") AS "total_cost"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
ON
  oi."product_id" = p."id"
WHERE
  TO_TIMESTAMP_NTZ(oi."delivered_at", 'epoch_milliseconds') < '2022-01-01'
GROUP BY
  p."category",
  "month"
LIMIT 100;
```
2025-01-26 08:16:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:16:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:16:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:16:05 - snowflake.connector.connection - INFO - closed
2025-01-26 08:16:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:16:19 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 08:16:19 - root - INFO - ```sql
SELECT
  p."category",
  DATE_TRUNC('month', TO_TIMESTAMP_NTZ(oi."created_at", 3)) AS "month",
  SUM(p."cost") AS "total_cost"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
  ON oi."product_id" = p."id"
WHERE
  TO_TIMESTAMP_NTZ(oi."delivered_at", 3) < '2022-01-01'
GROUP BY
  p."category",
  "month"
LIMIT 100;
```
2025-01-26 08:16:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:16:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:16:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:16:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-26 08:16:21 - snowflake.connector.connection - INFO - closed
2025-01-26 08:16:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:16:21 - root - INFO - SQL:
SELECT
  p."category",
  DATE_TRUNC('month', TO_TIMESTAMP_NTZ(oi."created_at", 3)) AS "month",
  SUM(p."cost") AS "total_cost"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
  ON oi."product_id" = p."id"
WHERE
  TO_TIMESTAMP_NTZ(oi."delivered_at", 3) < '2022-01-01'
GROUP BY
  p."category",
  "month"
LIMIT 100;
Results:
No data found for the specified query.

2025-01-26 08:16:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:16:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:16:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:16:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-26 08:16:22 - snowflake.connector.connection - INFO - closed
2025-01-26 08:16:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:17:24 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 08:17:24 - root - INFO - ```sql
SELECT
  p."category",
  SUM(oi."sale_price") AS "total_revenue",
  COUNT(*) AS "order_count",
  SUM(p."cost") AS "total_cost",
  SUM(oi."sale_price" - p."cost") AS "profit",
  CASE WHEN SUM(p."cost") <> 0 THEN ROUND(SUM(oi."sale_price" - p."cost") / SUM(p."cost"), 2) ELSE NULL END AS "profit_to_cost_ratio"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
  ON oi."product_id" = p."id"
GROUP BY
  p."category"
ORDER BY
  p."category"
LIMIT 100;
```
2025-01-26 08:17:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:17:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:17:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:17:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 26
2025-01-26 08:17:25 - snowflake.connector.connection - INFO - closed
2025-01-26 08:17:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:18:43 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 08:18:43 - root - INFO - SQL:
SELECT
  p."category",
  SUM(oi."sale_price") AS "total_revenue",
  COUNT(*) AS "order_count",
  SUM(p."cost") AS "total_cost",
  SUM(oi."sale_price" - p."cost") AS "profit",
  CASE WHEN SUM(p."cost") <> 0 THEN ROUND(SUM(oi."sale_price" - p."cost") / SUM(p."cost"), 2) ELSE NULL END AS "profit_to_cost_ratio"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
  ON oi."product_id" = p."id"
GROUP BY
  p."category"
ORDER BY
  p."category"
LIMIT 100;
Results:
category,total_revenue,order_count,total_cost,profit,profit_to_cost_ratio
Accessories,426937.3099739477,9876,171096.9168307665,255840.3931431812,1.5
Active,441559.9801414013,8881,185191.5272508636,256368.45289053768,1.38
Blazers & Jackets,284830.890540123,3109,108080.69835994003,176750.19218018296,1.64
Clothing Sets,18734.360023498535,202,11637.925386813478,7096.434636685057,0.61
Dresses,447111.8608894348,5304,201145.91800210255,245965.94288733223,1.22
Fashion Hoodies & Sweatshirts,653688.1405649185,11921,340273.04220220534,313415.0983627132,0.92
Intimates,443541.7106554508,13309,235614.82883713764,207926.88181831318,0.88
Jeans,1256239.8812875748,12719,672077.4799035509,584162.4013840238,0.87
Jumpsuits & Rompers,41770.06012630463,888,22224.494231877212,19545.565894427415,0.88
Leggings,87022.33988285065,3190,52274.622346711665,34747.71753613898,0.66
Maternity,262485.38956069946,5057,115877.79667712291,146607.59288357655,1.27
Outerwear & Coats,1322241.8987178802,9103,587591.9272744494,734649.9714434309,1.25
Pants,422951.41153144836,7071,194310.29789643275,228641.11363501562,1.18
Pants & Capris,183690.72078704834,3412,97070.56670718525,86620.15407986309,0.89
Plus,158538.950476408,4369,79352.63377180489,79186.31670460312,1.0
Shorts,515053.82150888443,11170,257945.9051182496,257107.91639063484,1.0
Skirts,102504.10020780563,2015,40811.22840352045,61692.87180428518,1.51
Sleep & Lounge,548868.940983057,11152,264375.5049253032,284493.4360577538,1.08
Socks,126569.1599957943,6235,76487.21929606877,50081.940699725536,0.65
Socks & Hosiery,62033.70993947983,3700,24959.739046142568,37073.97089333726,1.49
Suits,128779.5800743103,1104,77756.09290896359,51023.48716534671,0.66
Suits & Sport Coats,635448.5994358063,5103,254953.13236611083,380495.4670696954,1.49
Sweaters,816881.8499956131,10866,393671.3018383027,423210.5481573104,1.08
Swim,649922.6206922531,11365,330078.00332746434,319844.6173647888,0.97
Tops & Tees,497956.07168388367,11976,278654.3148072619,219301.75687662174,0.79
Underwear,203074.67025232315,7484,95465.27329001566,107609.39696230748,1.13

2025-01-26 08:18:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:18:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:18:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:18:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 08:18:45 - snowflake.connector.connection - INFO - closed
2025-01-26 08:18:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:18:45 - root - INFO - SQL:
SELECT
  oi."order_id",
  o."status" AS "order_status",
  oi."product_id",
  oi."sale_price"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDERS" o
ON
  oi."order_id" = o."order_id"
LIMIT 100
Results:
order_id,order_status,product_id,sale_price
14805,Cancelled,14235,0.0199999995529651
71201,Complete,14235,0.0199999995529651
81114,Complete,14235,0.0199999995529651
109826,Complete,14235,0.0199999995529651
49859,Returned,14235,0.0199999995529651
6684,Shipped,14235,0.0199999995529651
82012,Cancelled,14159,0.4900000095367431
28060,Processing,14159,0.4900000095367431
63169,Processing,14159,0.4900000095367431
12239,Shipped,14159,0.4900000095367431
50479,Shipped,14159,0.4900000095367431
73832,Shipped,14159,0.4900000095367431
108606,Shipped,14159,0.4900000095367431
114916,Shipped,14159,0.4900000095367431
35245,Cancelled,14202,1.5
42210,Complete,14202,1.5
5718,Processing,14202,1.5
6074,Processing,14202,1.5
25844,Processing,14202,1.5
33209,Processing,14202,1.5
57511,Processing,28700,1.5
108498,Processing,28700,1.5
5338,Returned,28700,1.5
33098,Returned,14202,1.5
76384,Returned,28700,1.5
101325,Returned,14202,1.5
7232,Shipped,14202,1.5
46807,Shipped,14202,1.5
120416,Shipped,28700,1.5
61834,Cancelled,13629,1.5099999904632568
79332,Cancelled,13629,1.5099999904632568
14956,Complete,13629,1.5099999904632568
3229,Processing,13629,1.5099999904632568
69780,Processing,13629,1.5099999904632568
103440,Processing,13629,1.5099999904632568
100896,Returned,13629,1.5099999904632568
18515,Shipped,13629,1.5099999904632568
18022,Shipped,14298,1.7200000286102295
63483,Shipped,14298,1.7200000286102295
90395,Complete,12536,1.75
105059,Complete,12536,1.75
122880,Complete,12536,1.75
106189,Shipped,12536,1.75
21501,Cancelled,15332,1.8200000524520876
35298,Cancelled,15332,1.8200000524520876
111104,Cancelled,15332,1.8200000524520876
7274,Complete,15332,1.8200000524520876
11963,Complete,15332,1.8200000524520876
12507,Complete,15332,1.8200000524520876
83546,Complete,15332,1.8200000524520876
33669,Processing,13659,1.8200000524520876
34236,Processing,13659,1.8200000524520876
105655,Processing,15332,1.8200000524520876
111185,Processing,15332,1.8200000524520876
112616,Processing,15332,1.8200000524520876
54378,Returned,15332,1.8200000524520876
6059,Shipped,15332,1.8200000524520876
28271,Shipped,13659,1.8200000524520876
34370,Shipped,13659,1.8200000524520876
55186,Shipped,15332,1.8200000524520876
62067,Shipped,13659,1.8200000524520876
88741,Shipped,15332,1.8200000524520876
11966,Cancelled,9204,1.950000047683716
72980,Cancelled,3049,1.950000047683716
21690,Complete,3049,1.950000047683716
80738,Complete,3049,1.950000047683716
119820,Complete,3049,1.950000047683716
29862,Processing,3049,1.950000047683716
115326,Processing,9204,1.950000047683716
121983,Processing,3049,1.950000047683716
20438,Shipped,3049,1.950000047683716
32712,Complete,14549,1.9800000190734863
100600,Complete,14549,1.9800000190734863
73565,Processing,14549,1.9800000190734863
18204,Shipped,14549,1.9800000190734863
26774,Shipped,14549,1.9800000190734863
70016,Shipped,14549,1.9800000190734863
72412,Shipped,14549,1.9800000190734863
80353,Shipped,14549,1.9800000190734863
34337,Cancelled,13606,2.5
119193,Cancelled,13606,2.5
70001,Complete,13606,2.5
33789,Processing,13606,2.5
9452,Shipped,13606,2.5
74155,Shipped,13606,2.5
78943,Shipped,13606,2.5
82140,Shipped,13606,2.5
115070,Shipped,13606,2.5
29512,Cancelled,28913,2.5899999141693115
65881,Cancelled,28913,2.5899999141693115
20397,Complete,28913,2.5899999141693115
9775,Processing,28913,2.5899999141693115
11503,Processing,28913,2.5899999141693115
79830,Processing,28913,2.5899999141693115
85088,Processing,28913,2.5899999141693115
33372,Shipped,28913,2.5899999141693115
6653,Cancelled,13690,2.6700000762939453
41376,Cancelled,13690,2.6700000762939453
5930,Complete,15395,2.6700000762939453
10820,Complete,13690,2.6700000762939453

2025-01-26 08:18:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:18:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:18:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:18:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 08:18:47 - snowflake.connector.connection - INFO - closed
2025-01-26 08:18:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:18:47 - root - INFO - SQL:
SELECT
  p."category",
  DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at" / 1000000)) AS "month",
  SUM(oi."sale_price") AS "monthly_revenue"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
ON
  oi."product_id" = p."id"
GROUP BY
  p."category",
  "month"
ORDER BY
  p."category",
  "month"
LIMIT 100
Results:
category,month,monthly_revenue
Accessories,2019-02-01,42.90000057220459
Accessories,2019-03-01,82.38000011444092
Accessories,2019-04-01,83.95000076293945
Accessories,2019-05-01,169.3200032711029
Accessories,2019-06-01,565.9999980926514
Accessories,2019-07-01,406.540002822876
Accessories,2019-08-01,743.5099983215332
Accessories,2019-09-01,656.3500077724457
Accessories,2019-10-01,1159.1799988746643
Accessories,2019-11-01,886.7700064182281
Accessories,2019-12-01,1176.7000085115433
Accessories,2020-01-01,1119.3299977779388
Accessories,2020-02-01,1289.6300203800201
Accessories,2020-03-01,964.4700031280518
Accessories,2020-04-01,1729.2199885845184
Accessories,2020-05-01,1867.4900104999542
Accessories,2020-06-01,1479.0300011634827
Accessories,2020-07-01,1542.5799911022186
Accessories,2020-08-01,2448.600004673004
Accessories,2020-09-01,1615.5200028419495
Accessories,2020-10-01,2797.199989080429
Accessories,2020-11-01,2999.7800030708313
Accessories,2020-12-01,2729.9200110435486
Accessories,2021-01-01,2821.3199968338013
Accessories,2021-02-01,2431.5799856185913
Accessories,2021-03-01,2947.699996829033
Accessories,2021-04-01,3343.589996099472
Accessories,2021-05-01,3058.2200179100037
Accessories,2021-06-01,2817.8800036907196
Accessories,2021-07-01,4384.099987030029
Accessories,2021-08-01,3434.4700107574463
Accessories,2021-09-01,4094.4499912261963
Accessories,2021-10-01,4042.259989976883
Accessories,2021-11-01,3377.2099800109863
Accessories,2021-12-01,2882.1999986171722
Accessories,2022-01-01,5339.400004148483
Accessories,2022-02-01,4232.74000620842
Accessories,2022-03-01,4839.059978961945
Accessories,2022-04-01,4599.249974727631
Accessories,2022-05-01,4868.160014152527
Accessories,2022-06-01,6321.680026292801
Accessories,2022-07-01,5228.419990181923
Accessories,2022-08-01,5187.689974583685
Accessories,2022-09-01,5524.569988250732
Accessories,2022-10-01,5736.299985408783
Accessories,2022-11-01,6877.370015382767
Accessories,2022-12-01,6659.860012054443
Accessories,2023-01-01,7938.559997797012
Accessories,2023-02-01,6390.309992074966
Accessories,2023-03-01,8462.279976844788
Accessories,2023-04-01,8418.410002727062
Accessories,2023-05-01,8645.320052862167
Accessories,2023-06-01,7469.79000210762
Accessories,2023-07-01,10159.879982233047
Accessories,2023-08-01,9329.280014038086
Accessories,2023-09-01,8519.270018815994
Accessories,2023-10-01,9776.35997390747
Accessories,2023-11-01,12254.210008382797
Accessories,2023-12-01,12208.480020523071
Accessories,2024-01-01,11857.03000094369
Accessories,2024-02-01,11368.429980516434
Accessories,2024-03-01,13032.650015354156
Accessories,2024-04-01,14470.700029850006
Accessories,2024-05-01,15192.440013170242
Accessories,2024-06-01,16308.209975838661
Accessories,2024-07-01,19732.370028395206
Accessories,2024-08-01,22264.76996922493
Accessories,2024-09-01,27165.109978199005
Accessories,2024-10-01,32367.59996630624
Active,2019-02-01,187.93999862670898
Active,2019-03-01,156.9800033569336
Active,2019-04-01,189.3299970626831
Active,2019-05-01,270.94000244140625
Active,2019-06-01,412.52999687194824
Active,2019-07-01,772.930009841919
Active,2019-08-01,405.26000213623047
Active,2019-09-01,1211.9699993133545
Active,2019-10-01,2045.2799921035767
Active,2019-11-01,926.8199996948242
Active,2019-12-01,937.0
Active,2020-01-01,1041.1900053024292
Active,2020-02-01,1899.1900043487549
Active,2020-03-01,654.3300008773804
Active,2020-04-01,1558.6400017738342
Active,2020-05-01,1381.7299966812134
Active,2020-06-01,995.9899988174438
Active,2020-07-01,1700.3699989318848
Active,2020-08-01,1845.71000289917
Active,2020-09-01,2275.6899938583374
Active,2020-10-01,1560.8599920272827
Active,2020-11-01,3012.3800010681152
Active,2020-12-01,2470.5200085639954
Active,2021-01-01,2521.7500009536743
Active,2021-02-01,2309.040003299713
Active,2021-03-01,3969.2600088119507
Active,2021-04-01,3154.3600091934204
Active,2021-05-01,2917.67001247406
Active,2021-06-01,3739.620005607605
Active,2021-07-01,3581.4100008010864
Active,2021-08-01,3555.2299842834473

2025-01-26 08:18:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:18:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:18:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:18:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 08:18:49 - snowflake.connector.connection - INFO - closed
2025-01-26 08:18:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:18:49 - root - INFO - SQL:
SELECT
  p."category",
  DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at" / 1000000)) AS "month",
  COUNT(DISTINCT oi."order_id") AS "orders_count"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
ON
  oi."product_id" = p."id"
GROUP BY
  p."category",
  "month"
LIMIT 100
Results:
category,month,orders_count
Accessories,2024-10-01,711
Accessories,2024-01-01,258
Accessories,2023-03-01,162
Accessories,2022-10-01,135
Accessories,2024-04-01,340
Accessories,2024-03-01,316
Accessories,2024-09-01,558
Accessories,2024-06-01,369
Accessories,2023-08-01,232
Sleep & Lounge,2021-02-01,59
Accessories,2021-08-01,73
Maternity,2021-09-01,45
Socks & Hosiery,2023-11-01,96
Accessories,2022-02-01,88
Active,2021-09-01,66
Accessories,2019-05-01,6
Accessories,2024-07-01,413
Plus,2024-06-01,166
Socks & Hosiery,2023-02-01,64
Active,2024-05-01,329
Socks,2019-02-01,5
Accessories,2023-11-01,282
Plus,2022-03-01,58
Plus,2024-10-01,341
Accessories,2024-02-01,291
Accessories,2023-01-01,159
Accessories,2024-08-01,481
Tops & Tees,2020-04-01,45
Plus,2022-05-01,46
Intimates,2022-07-01,174
Socks,2024-01-01,169
Socks,2021-06-01,46
Sleep & Lounge,2023-09-01,259
Plus,2020-11-01,32
Accessories,2022-09-01,139
Accessories,2021-05-01,63
Active,2024-06-01,327
Socks & Hosiery,2024-08-01,176
Socks,2023-12-01,176
Swim,2021-05-01,89
Intimates,2024-09-01,707
Plus,2024-07-01,189
Leggings,2023-10-01,88
Swim,2022-03-01,137
Intimates,2023-11-01,332
Intimates,2024-05-01,454
Underwear,2019-04-01,2
Socks & Hosiery,2022-08-01,55
Maternity,2019-07-01,6
Accessories,2022-11-01,161
Plus,2024-08-01,237
Accessories,2021-07-01,91
Leggings,2020-12-01,18
Accessories,2023-05-01,184
Accessories,2020-11-01,60
Intimates,2022-11-01,173
Intimates,2022-05-01,137
Plus,2021-02-01,30
Intimates,2021-10-01,137
Underwear,2021-09-01,64
Active,2024-02-01,226
Dresses,2024-01-01,141
Accessories,2020-06-01,31
Intimates,2024-06-01,480
Intimates,2023-04-01,230
Sleep & Lounge,2024-01-01,334
Intimates,2024-01-01,386
Socks,2019-07-01,10
Accessories,2021-11-01,85
Plus,2024-03-01,122
Socks & Hosiery,2024-02-01,95
Maternity,2023-04-01,76
Socks,2021-10-01,64
Tops & Tees,2020-08-01,47
Accessories,2022-03-01,108
Socks,2024-09-01,356
Intimates,2020-03-01,51
Tops & Tees,2023-09-01,259
Intimates,2021-08-01,102
Shorts,2020-05-01,39
Socks,2021-02-01,32
Accessories,2020-04-01,40
Leggings,2022-06-01,42
Plus,2022-12-01,58
Plus,2021-07-01,24
Dresses,2023-03-01,78
Intimates,2022-08-01,195
Fashion Hoodies & Sweatshirts,2023-02-01,214
Plus,2023-01-01,60
Accessories,2021-10-01,91
Plus,2024-09-01,230
Intimates,2023-05-01,239
Plus,2023-09-01,94
Socks,2023-10-01,190
Plus,2022-04-01,56
Socks,2023-09-01,144
Socks & Hosiery,2022-02-01,46
Intimates,2024-02-01,376
Socks,2024-04-01,198
Accessories,2023-06-01,177

2025-01-26 08:18:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:18:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:18:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:18:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 08:18:50 - snowflake.connector.connection - INFO - closed
2025-01-26 08:18:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:18:51 - root - INFO - SQL:
SELECT
  p."category",
  DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at" / 1000000)) AS "month",
  SUM(oi."sale_price" - p."cost") / NULLIF(SUM(p."cost"), 0) AS "profit_to_cost_ratio"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
ON
  oi."product_id" = p."id"
WHERE
  p."cost" > 0
GROUP BY
  p."category",
  "month"
LIMIT 100
Results:
category,month,profit_to_cost_ratio
Accessories,2024-07-01,1.4979525362578106
Accessories,2024-10-01,1.4923778112853836
Accessories,2024-01-01,1.4967177045726971
Accessories,2024-08-01,1.4671478758925554
Accessories,2024-02-01,1.486323630770613
Accessories,2022-02-01,1.5509875616781281
Accessories,2024-04-01,1.4962290870139132
Accessories,2024-09-01,1.524250935833139
Accessories,2024-03-01,1.4877657208324615
Accessories,2021-08-01,1.4862561304078878
Accessories,2023-01-01,1.4849959715208065
Plus,2024-10-01,1.0054032230482706
Socks & Hosiery,2022-08-01,1.4569292910910747
Active,2024-03-01,1.3782695420741402
Active,2024-05-01,1.3793747695341418
Plus,2024-06-01,1.0209089317176323
Accessories,2022-11-01,1.5400331766887458
Accessories,2023-07-01,1.4809711143324256
Plus,2021-02-01,1.00801543033076
Plus,2020-11-01,0.9891979294522179
Intimates,2022-05-01,0.8836554468236154
Accessories,2024-06-01,1.4894868860025394
Accessories,2023-03-01,1.5151047475632675
Accessories,2022-10-01,1.4522294353112992
Plus,2022-03-01,0.9768593578560409
Plus,2023-09-01,0.9862092831957874
Plus,2023-06-01,0.966959034774762
Maternity,2023-12-01,1.2822338561990836
Accessories,2021-11-01,1.5184424259195686
Accessories,2023-11-01,1.5079180248879003
Plus,2024-04-01,0.9552436303685543
Accessories,2023-06-01,1.4812643997087385
Plus,2024-03-01,0.9971316856323044
Plus,2022-11-01,1.0051962349609587
Socks & Hosiery,2023-11-01,1.505026954877638
Sleep & Lounge,2021-02-01,1.1715366050181473
Socks,2023-12-01,0.6659601649868302
Intimates,2024-02-01,0.8966464110033201
Maternity,2021-09-01,1.308088902902513
Intimates,2023-11-01,0.8901219326211074
Intimates,2023-04-01,0.8736931457993321
Intimates,2024-09-01,0.8860880153506876
Tops & Tees,2020-04-01,0.8076821748114459
Accessories,2023-05-01,1.4728723526533873
Intimates,2019-07-01,0.9224525892323454
Plus,2024-08-01,0.9988031377077271
Plus,2021-07-01,1.0166338712611518
Socks,2019-07-01,0.6472176339605294
Socks & Hosiery,2021-10-01,1.493955366202276
Socks,2021-06-01,0.6445038440831141
Plus,2022-08-01,0.9806231155902527
Socks,2023-05-01,0.648489366927219
Plus,2023-04-01,1.0179949544691582
Leggings,2023-10-01,0.6624754168973324
Intimates,2022-11-01,0.8804579255928526
Socks & Hosiery,2023-09-01,1.4861019980233525
Leggings,2024-05-01,0.6556839144489682
Intimates,2020-09-01,0.9227351913927205
Socks & Hosiery,2021-09-01,1.4905363279379802
Plus,2020-03-01,0.9278357569806661
Underwear,2023-02-01,1.1133982717994735
Intimates,2020-11-01,0.8680643916156647
Tops & Tees,2024-02-01,0.7813105952989445
Leggings,2021-12-01,0.6492398717744716
Accessories,2023-08-01,1.4987216861439514
Plus,2023-01-01,0.9669474966851618
Accessories,2021-10-01,1.5283519590132342
Plus,2022-05-01,1.0127184621772025
Socks & Hosiery,2022-11-01,1.5308951084626843
Socks,2023-09-01,0.6513979701047347
Intimates,2023-05-01,0.8757603173295189
Accessories,2022-07-01,1.5018027368436773
Maternity,2023-04-01,1.2970018029282027
Accessories,2022-09-01,1.4943385494915298
Accessories,2021-07-01,1.5098259636324285
Socks & Hosiery,2024-02-01,1.504625930463064
Plus,2024-09-01,1.0253942319819682
Sleep & Lounge,2024-10-01,1.0914881165586474
Intimates,2024-06-01,0.874177211794708
Sleep & Lounge,2024-01-01,1.0379126220743404
Active,2021-09-01,1.3928511117470446
Accessories,2020-04-01,1.439062136376607
Accessories,2022-03-01,1.5030680656669522
Intimates,2024-01-01,0.8861465974832557
Intimates,2021-08-01,0.8789851565726475
Tops & Tees,2020-08-01,0.8080967752871954
Socks & Hosiery,2022-12-01,1.5139916383673273
Socks & Hosiery,2023-02-01,1.4763382613912888
Plus,2024-07-01,0.9940437945333274
Accessories,2020-06-01,1.536544547155537
Socks,2021-10-01,0.6661233382927225
Intimates,2023-08-01,0.8767937201128041
Socks & Hosiery,2022-07-01,1.4735126951887036
Socks & Hosiery,2022-02-01,1.5179735993407797
Intimates,2020-03-01,0.8646948813570826
Socks & Hosiery,2024-09-01,1.4677659901719042
Socks,2024-05-01,0.6568912517671612
Socks,2021-09-01,0.6481518305030666
Socks,2020-12-01,0.6712627595846345
Socks,2023-03-01,0.6459267683069988

2025-01-26 08:18:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:18:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:18:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:18:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 08:18:52 - snowflake.connector.connection - INFO - closed
2025-01-26 08:18:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:18:52 - root - INFO - SQL:
SELECT
  oi."order_id",
  oi."product_id",
  oi."sale_price",
  p."cost",
  TO_TIMESTAMP(oi."delivered_at" / 1000000) AS "delivered_at"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
ON
  oi."product_id" = p."id"
LIMIT 100
Results:
Too long, hard cut:
order_id,product_id,sale_price,cost,delivered_at
14805,14235,0.0199999995529651,0.0082999997779726,
71201,14235,0.0199999995529651,0.0082999997779726,2024-10-22 03:26:00.000000
81114,14235,0.0199999995529651,0.0082999997779726,2022-08-23 02:49:00.000000
109826,14235,0.0199999995529651,0.0082999997779726,2024-01-28 16:59:00.000000
49859,14235,0.0199999995529651,0.0082999997779726,2023-04-24 12:38:00.000000
6684,14235,0.0199999995529651,0.0082999997779726,
82012,14159,0.4900000095367431,0.1773800033208727,
28060,14159,0.4900000095367431,0.1773800033208727,
63169,14159,0.4900000095367431,0.1773800033208727,
12239,14159,0.4900000095367431,0.1773800033208727,
50479,14159,0.4900000095367431,0.1773800033208727,
73832,14159,0.4900000095367431,0.1773800033208727,
108606,14159,0.4900000095367431,0.1773800033208727,
114916,14159,0.4900000095367431,0.1773800033208727,
35245,14202,1.5,0.617999997921288,
42210,14202,1.5,0.617999997921288,2021-12-30 03:13:00.000000
5718,14202,1.5,0.617999997921288,
6074,14202,1.5,0.617999997921288,
25844,14202,1.5,0.617999997921288,
33209,14202,1.5,0.617999997921288,
57511,28700,1.5,0.6059999980498105,
108498,28700,1.5,0.6059999980498105,
5338,28700,1.5,0.6059999980498105,2020-03-16 16:13:00.000000
33098,14202,1.5,0.617999997921288,2024-03-31 18:20:00.000000
76384,28700,1.5,0.6059999980498105,2023-08-12 19:28:00.000000
101325,14202,1.5,0.617999997921288,2022-10-09 22:20:00.000000
7232,14202,1.5,0.617999997921288,
46807,14202,1.5,0.617999997921288,
120416,28700,1.5,0.6059999980498105,
61834,13629,1.5099999904632568,0.6447699947352707,
79332,13629,1.5099999904632568,0.6447699947352707,
14956,13629,1.5099999904632568,0.6447699947352707,2024-07-26 03:58:00.000000
3229,13629,1.5099999904632568,0.6447699947352707,
69780,13629,1.5099999904632568,0.6447699947352707,
103440,13629,1.5099999904632568,0.6447699947352707,
100896,13629,1.5099999904632568,0.6447699947352707,2024-07-01 06:11:00.000000
18515,13629,1.5099999904632568,0.6447699947352707,
18022,14298,1.7200000286102295,0.6450000075250863,
63483,14298,1.7200000286102295,0.6450000075250863,
90395,12536,1.75,1.0132499965839088,2021-02-20 23:07:00.000000
105059,12536,1.75,1.0132499965839088,2024-03-10 17:41:00.000000
122880,12536,1.75,1.0132499965839088,2021-07-08 13:30:00.000000
106189,12536,1.75,1.0132499965839088,
21501,15332,1.8200000524520876,0.8918000261083245,
35298,15332,1.8200000524520876,0.8918000261083245,
111104,15332,1.8200000524520876,0.8918000261083245,
7274,15332,1.8200000524520876,0.8918000261083245,2022-09-03 03:22:00.000000
11963,15332,1.8200000524520876,0.8918000261083245,2024-10-09 20:49:00.000000
12507,15332,1.8200000524520876,0.8918000261083245,2020-08-26 19:03:00.000000
83546,15332,1.8200000524520876,0.8918000261083245,2023-05-12 08:34:00.000000
33669,13659,1.8200000524520876,0.7498400190880893,
34236,13659,1.8200000524520876,0.7498400190880893,
105655,15332,1.8200000524520876,0.8918000261083245,
111185,15332,1.8200000524520876,0.8918000261083245,
112616,15332,1.8200000524520876,0.8918000261083245,
54378,15332,1.8200000524520876,0.8918000261083245,2023-11-12 18:44:00.000000
6059,15332,1.8200000524520876,0.8918000261083245,
28271,13659,1.8200000524520876,0.7498400190880893,
34370,13659,1.8200000524520876,0.7498400190880893,
55186,15332,1.8200000524520876,0.8918000261083245,
62067,13659,1.8200000524520876,0.7498400190880893,
88741,15332,1.8200000524520876,0.8918000261083245,
11966,9204,1.950000047683716,0.7722000156065448,
72980,3049,1.950000047683716,0.9165000273510814,
21690,3049,1.950000047683716,0.9165000273510814,2024-10-21 02:46:50.988061
80738,3049,1.950000047683716,0.9165000273510814,2023-04-29 05:53:00.000000
119820,3049,1.950000047683716,0.9165000273510814,2024-10-23 05:51:58.791730
29862,3049,1.950000047683716,0.9165000273510814,
115326,9204,1.950000047683716,0.7722000156065448,
121983,3049,1.950000047683716,0.9165000273510814,
20438,3049,1.950000047683716,0.9165000273510814,
32712,14549,1.9800000190734863,0.7840800106805563,2021-09-10 03:09:00.000000
100600,14549,1.9800000190734863,0.7840800106805563,2023-06-11 16:50:00.000000
73565,14549,1.9800000190734863,0.7840800106805563,
18204,14549,1.9800000190734863,0.7840800106805563,
26774,14549,1.9800000190734863,0.7840800106805563,
70016,14549,1.9800000190734863,0.7840800106805563,
72412,14549,1.9800000190734863,0.7840800106805563,
80353,14549,1.9800000190734863,0.7840800106805563,
34337,13606,2.5,1.1074999999254942,
119193,13606,2.5,1.1074999999254942,
70001,13606,2.5,1.1074999999254942,2020-04-10 05:16:00.000000
33789,13606,2.5,1.1074999999254942,
9452,13606,2.5,1.1074999999254942,
74155,13606,2.5,1.1074999999254942,
78943,13606,2.5,1.1074999999254942,
82140,13606,2.5,1.1074999999254942,
115070,13606,2.5,1.1074999999254942,
29512,28913,2.5899999141693115,1.0722599617259203,
65881,28913,2.5899999141693115,1.0722599617259203,
20397,28913,2.5899999141693115,1.0722599617259203,2024-02-25 09:54:00.000000
9775,28913,2.5899999141693115,1.0722599617259203,
11503,28913,2.58

2025-01-26 08:18:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:18:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:18:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:18:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 69
2025-01-26 08:18:54 - snowflake.connector.connection - INFO - closed
2025-01-26 08:18:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:18:54 - root - INFO - SQL:
SELECT
  DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at" / 1000000)) AS "month",
  SUM(oi."sale_price") AS "monthly_revenue"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
ON
  oi."product_id" = p."id"
WHERE
  p."category" = 'Accessories'
GROUP BY
  "month"
ORDER BY
  "month"
LIMIT 100
Results:
month,monthly_revenue
2019-02-01,42.90000057220459
2019-03-01,82.38000011444092
2019-04-01,83.95000076293945
2019-05-01,169.3200032711029
2019-06-01,565.9999980926514
2019-07-01,406.540002822876
2019-08-01,743.5099983215332
2019-09-01,656.3500077724457
2019-10-01,1159.1799988746643
2019-11-01,886.7700064182281
2019-12-01,1176.7000085115433
2020-01-01,1119.3299977779388
2020-02-01,1289.6300203800201
2020-03-01,964.4700031280518
2020-04-01,1729.2199885845184
2020-05-01,1867.4900104999542
2020-06-01,1479.0300011634827
2020-07-01,1542.5799911022186
2020-08-01,2448.600004673004
2020-09-01,1615.5200028419495
2020-10-01,2797.199989080429
2020-11-01,2999.7800030708313
2020-12-01,2729.9200110435486
2021-01-01,2821.3199968338013
2021-02-01,2431.5799856185913
2021-03-01,2947.699996829033
2021-04-01,3343.589996099472
2021-05-01,3058.2200179100037
2021-06-01,2817.8800036907196
2021-07-01,4384.099987030029
2021-08-01,3434.4700107574463
2021-09-01,4094.4499912261963
2021-10-01,4042.259989976883
2021-11-01,3377.2099800109863
2021-12-01,2882.1999986171722
2022-01-01,5339.400004148483
2022-02-01,4232.74000620842
2022-03-01,4839.059978961945
2022-04-01,4599.249974727631
2022-05-01,4868.160014152527
2022-06-01,6321.680026292801
2022-07-01,5228.419990181923
2022-08-01,5187.689974583685
2022-09-01,5524.569988250732
2022-10-01,5736.299985408783
2022-11-01,6877.370015382767
2022-12-01,6659.860012054443
2023-01-01,7938.559997797012
2023-02-01,6390.309992074966
2023-03-01,8462.279976844788
2023-04-01,8418.410002727062
2023-05-01,8645.320052862167
2023-06-01,7469.79000210762
2023-07-01,10159.879982233047
2023-08-01,9329.280014038086
2023-09-01,8519.270018815994
2023-10-01,9776.35997390747
2023-11-01,12254.210008382797
2023-12-01,12208.480020523071
2024-01-01,11857.03000094369
2024-02-01,11368.429980516434
2024-03-01,13032.650015354156
2024-04-01,14470.700029850006
2024-05-01,15192.440013170242
2024-06-01,16308.209975838661
2024-07-01,19732.370028395206
2024-08-01,22264.76996922493
2024-09-01,27165.109978199005
2024-10-01,32367.59996630624

2025-01-26 08:18:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:18:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:18:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:18:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 08:18:55 - snowflake.connector.connection - INFO - closed
2025-01-26 08:18:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:18:56 - root - INFO - SQL:
SELECT
  "id",
  "category",
  "name",
  "cost",
  "retail_price"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS"
LIMIT 100
Results:
Too long, hard cut:
id,category,name,cost,retail_price
13842,Accessories,Low Profile Dyed Cotton Twill Cap - Navy W39S55D,2.518749990849756,6.25
13928,Accessories,Low Profile Dyed Cotton Twill Cap - Putty W39S55D,2.3383499148894105,5.949999809265137
14115,Accessories,Enzyme Regular Solid Army Caps-Black W35S45D,4.879559879379869,10.989999771118164
14157,Accessories,Enzyme Regular Solid Army Caps-Olive W35S45D (One Size),4.648769887297898,10.989999771118164
14273,Accessories,Washed Canvas Ivy Cap - Black W11S64C,6.507929886473045,15.989999771118164
15674,Plus,Low Profile Dyed Cotton Twill Cap - Navy W39S55D,3.1062499998370185,6.25
15816,Plus,Low Profile Dyed Cotton Twill Cap - Putty W39S55D,3.1772999091416594,5.949999809265137
28646,Accessories,4 Panel Large Bill Flap Hat W15S48B (One Size Fits Most/Khaki),8.73562987972319,19.989999771118164
28670,Accessories,Low Profile Dyed Cotton Twill Cap - Black W39S55D,2.6759399153566363,6.179999828338623
28714,Accessories,Low Profile Dyed Cotton Twill Cap - Khaki W39S55D,2.275000000372529,6.25
28779,Accessories,Fishing Hat (01)-Khaki W10S32F,7.36748991528362,20.989999771118164
28904,Accessories,Fashion Plaid Ivy Cap - Blue W10S69F,6.7957498848550015,15.989999771118164
29007,Accessories,Washed Hunting Fishing Outdoor Hat-Camo W11S41D,10.795999868229032,26.989999771118164
12777,Swim,Womens MW Tankini Boyshorts Swimsuit Swimwear Crisscross Back Multiple Prints S-xxl,16.691290760814255,44.9900016784668
12810,Swim,Mw Long Ruffle Tankini Bikini Swimsuit Bra Straps Multiple Prints,21.055320884742144,44.9900016784668
12812,Swim,Womens long tankini bikini swimsuit Marina West 2 piece multiple prints bra straps,21.14530090284795,44.9900016784668
12853,Swim,Womens MW Tankini Boyshorts Swimsuit Swimwear Fashion prints S-XXL,18.71584077014294,44.9900016784668
12900,Swim,Womens One Piece/bikini Monokini Swimsuit w/ Fringe MW Multiple Prints and Solids,17.39565078823306,39.9900016784668
13247,Swim,Womens swimsuit MW Swimwear Set Halter w/ Boyshorts 2 piece bikini multiple prints,20.65041088706643,44.9900016784668
13477,Swim,MW Women's Swimsuit Two Piece Black Tankini with Bikini Bottoms,22.600890809484422,54.9900016784668
13574,Swim,Womens MW Two Piece Tankini Boyshorts Swimsuit Brown & Turquoise Ethnic Print,19.39069080118597,44.9900016784668
2848,Active,2XU Women's Compression Recovery Sock,20.946700439925493,44.950000762939446
3039,Active,2XU Women's Compression Race Sock,22.627350425997378,49.950000762939446
9041,Socks & Hosiery,2XU Women's Compression Race Sock,20.479500227209176,49.950000762939446
13122,Swim,2XU Women's Swimmers Compression Long Sleeve Top,68.73737201425911,150.41000366210938
18147,Active,2XU Non-Stirrup Compression Calf Guard,17.069900398133232,40.450000762939446
18363,Active,2XU Men's Compression Recovery Tights,65.0955812367481,159.94000244140625
18394,Active,2XU Men's Compression Race Sock,22.97700039561093,49.950000762939446
18465,Active,2XU Men's Elite Compression Performance Sock,27.240000218153,60.0
18593,Active,2XU Men's Compression Recovery Sock,17.00110065520704,43.150001525878906
18607,Active,2XU Men's Compression 3/4 Tights,30.63616928671479,79.98999786376953
18644,Active,2XU Men's Elite Compression Long Sleeve Top,41.28767906982421,107.5199966430664
18664,Active,2XU Recovery Compression Leg Sleeves,25.83845043245256,59.950000762939446
18708,Active,2XU Men's Thermal Compression Long Sleeve Top,42.59726061337233,111.22000122070312
18796,Active,2XU Men's Compression Long Sleeve Top,36.31391910439163,84.05999755859375
24644,Socks,2XU Men's Compression Race Sock,27.872100528435407,49.950000762939446
24674,Socks,2XU Men's Elite Compression Performance Sock,35.64000008627772,60.0
24731,Socks,2XU Men's Compression Recovery Sock,25.58795095982142,43.150001525878906
27569,Swim,2XU Men's Swimmers Compression Long Sleeve Top,92.6525625942932,150.41000366210938
3206,Dresses,AGB Women's Long Sleeve Striped Sweater Dress,38.31499995291233,79.0
3660,Dresses,AGB Women's Short Sleeve Cowl Necked Sweater Dress,21.91964971384816,50.38999938964844
3682,Dresses,AGB Women's Striped Long Sleeve Sweater Dress With Sash,18.956299259465936,45.34999847412109
3730,Dresses,AGB Women's V-Neck Dress With Draped Side,39.070999938994646,89.0
3943,Dresses,AGB Women's Plus-Size Ruched Short Sleeve V-Neck Dress with Empire Waistline,26.28080032457113,53.200000762939446
5353,Pants & Capris,AGB Women's Solid Challis Palazzo Pant With Self Sash,22.46999996714294,42.0
5433,Pants & Capris,BKE Women's Casual Linen Cotton Natural Comfortable Pants,11.640959460911304,20.209999084472656
9035,Socks & Hosiery,HDE Women's Solid Color Premium Microfiber Tights,1.3983000106409191,3.950000047683716
14170,Accessories,HDE Ladies Fashion Leather Skinny Belt with Bow Buckle & Gold Accents,1.1859000150532462,2.950000047683716
28411,Accessories,HDE Solid Color Suspenders - 20 Styles,2.083760045012236,4.880000114440918
28548,Accessories,HDE Classic Bow Tie,1.280300021749735,2.950000047683716
28873,Accessories,HDE Colorful P

2025-01-26 08:18:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:18:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:18:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:18:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 08:18:57 - snowflake.connector.connection - INFO - closed
2025-01-26 08:18:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:18:58 - root - INFO - SQL:
SELECT
  p."category",
  p."name",
  COUNT(oi."product_id") AS "units_sold"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
ON
  oi."product_id" = p."id"
GROUP BY
  p."category",
  p."name"
ORDER BY
  p."category",
  "units_sold" DESC
LIMIT 100
Results:
Too long, hard cut:
category,name,units_sold
Accessories,Boxed 3 pc. Initial Cotton Handkerchiefs,24
Accessories,Ray-Ban RB4141 Round Wayfarer Sunglasses,23
Accessories,Kenneth Cole REACTION Men's Passcase Wallet,22
Accessories,Von Zipper Elmore Sunglasses,21
Accessories,Tom Ford Marko FT0144 Sunglasses - 18V Shiny Rhodium (Blue Lens) - 58mm,20
Accessories,Ray-Ban 0RB3491 Aviator Sunglasses,18
Accessories,Oakley Men's Dispatch II Square Sunglasses,18
Accessories,Ray Ban RB3479 Folding Aviator Sunglasses - 001 Arista (G-15XLT Lens) - 58mm,18
Accessories,Costa Del Mar - Blackfin - Camo Frame-580 Green Mirror Glass Polarized Lenses,18
Accessories,D1067 Dg Eyewear Semi Rimless Aviator Metal Pilot Sunglasses,18
Accessories,Ray-Ban Women's 4101 Jackie Ohh Sunglasses,17
Accessories,Ray-Ban RB3293 Bubble Wrap Aviator Sunglasses,17
Accessories,TrendsBlue Classic Soft Unisex Solid Color Warm Winter Fringe Scarf - Different Colors Available,17
Accessories,Best PILOT TROOPER Brown Shell AVIATOR Faux Leather Hat USHANKA Trapper Men and Women,17
Accessories,S5 Selected Smooth Small Eyeglass Case,16
Accessories,Tommy Hilfiger  Men's Cambrige Slim Billfold,16
Accessories,US Marines Black Cowhide Leather Trifold Wallet,16
Accessories,LOCS Sunglasses Hardcore Black Dark Lens 0103 Designer Stylish w Bag,16
Accessories,Elegant Solid Color Infinity Loop Jersey Scarf - Different Colors Available,16
Accessories,Eyeglasses Boss Black Boss 0479 0807 Black,16
Accessories,Spy Optic Dirty MO Sunglasses,16
Accessories,Minus33 100% Merino Wool Base Layer 740 Expedition Balaclava Black One Size,16
Accessories,Oakley Men's Flak Jacket XLJ Iridium Sunglasses,16
Accessories,neff Men's Daily Sunglass,16
Accessories,Ray-Ban Wayfarer 601S78 Polarized Wayfarer SunglassesMatte Black52 mm,16
Accessories,Dosh Street Billfold Wallet,16
Accessories,Ray-Ban Aviator Large Metal Sunglasses,15
Accessories,Wool Greek Fishermans Cap,15
Accessories,Ray-Ban Unisex RB4034P Sunglasses,15
Accessories,DOLCE & GABBANA DG4167 501/8G BLACK GRAY GRADIENT 5917,15
Accessories,Ray-Ban RB4075 Sunglasses,15
Accessories,Ray-Ban RB3407 Outdoorsman II Sunglasses,15
Accessories,G&G Black Wayfarer 80's Blues Brothers Sunglasses Super Dark,15
Accessories,Dorfman-Pacific Weathered Cotton Outback Hat With Chin Cord,14
Accessories,JiMarti JM01 Sunglasses for Golf Fishing Cycling-Unbreakable-... Frame,14
Accessories,Croakies Unisex Adult Terra Spec Cord Adjustable Eyewear Retainer,14
Accessories,Ray-Ban Aviator Sunglasses,14
Accessories,Port Authority - Extra Long Fleece Scarf,14
Accessories,Hollywood Solid Pashmina Scarf,14
Accessories,Ray-Ban Meteor Wayfarer Sunglasses,14
Accessories,Unisex Chequered Arab Arafat Shemagh Kafiyah Desert Style Scarf Throw - 17 Gorgeous Colours while stocks last!,14
Accessories,X-Gear Men's Deluxe Camper Tool,14
Accessories,Persol Men's 0PO0714 Square Polarized Sunglasses,14
Accessories,Brixton Men's Hooligan Classic Drivers Cap,14
Accessories,Men's Italian Lambskin Leather Driving Gloves By Fratelli Orsini Everyday,14
Accessories,Mountain Hardwear Men's Micro Dome Beanie,14
Accessories,Carrera Carrera Champion/L/S Black Frame/Grey Gradient Lens 62Mm,14
Accessories,Knit Collegiate Rugby Stripe Winter Scarf & Beanie Hat Set - Assorted Colors,14
Accessories,Mens Piano Keyboard Themed Gift Set: Wallet Music Note Keychain & Socks,13
Accessories,Buxton Deluxe Snap Card Case for Women,13
Accessories,Oakley Men's Straight Jacket Polarized Sunglasses,13
Accessories,Native Eyewear Throttle Sunglasses,13
Accessories,Carrera  Endurls Resin Sunglasses,13
Accessories,Oakley Frogskin Polarized Aviator Sunglasses,13
Accessories,Skechers Men's 5017 Aviator Sunglasses,13
Accessories,DC Men's Big Star Beanie,13
Accessories,Columbia Unisex Baddabing II Headring,13
Accessories,Joseph Abboud Men's Glace Sheepskin Baby Cable Cashmere Lined Glove,13
Accessories,WHOLESALE LOT MENS 10 HANDKERCHIEFS NEW POCKET SQUARES SOLID COLORS FORMAL,13
Accessories,Carrera Topcar 1/S Aviator Sunglasses,13
Accessories,Klondike Sterling Touch Screen Fleece Gloves Mid-weight Winter iPhone iPad Compatible,13
Accessories,Ray-Ban Unisex RB4105 Folding Wayfarer Sunglasses,13
Accessories,Tommy Hilfiger Men's Double Stitched Canvas Belt,13
Accessories,Guide Gear Leather Rabbit Fur Hat,13
Accessories,XS Sport Wrap TR90 Sunglasses UV400 Unbreakable Protection for Cycling Ski or Golf,13
Accessories,Ray Ban RB3447 Unisex Icons Sunglasses - Choice of Frame and Lens,13
Accessories,Ray Ban RB3025 Aviator Sunglasses,13
Accessories,JiMarti JM63 Sport Wrap Sunglasses for Cycling Running Fishing Golf TR90 Frame,13
Accessories,Oakley Pit Bull Sunglasses,13
Accessories,Dakota Dan Winter Trooper Trapper Faux Fur Hat,13
Accessories,Designer Bow Ties for Men & Boys by Tok Tok Designs (Y166),13
Accessories,Lauren Solid Color Stunning Pashmina Scarf/Wrap,13
Accessories,Trendy Plaid & Houndstooth Check Soft Square Scarf - Different Colors Available By TrendsBlue,12
Accessories,Ray Ban Sunglasses RB 3030 Outdoorsman,12
Accessories,New

2025-01-26 08:18:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:18:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:18:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:18:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 70
2025-01-26 08:18:59 - snowflake.connector.connection - INFO - closed
2025-01-26 08:18:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:18:59 - root - INFO - SQL:
SELECT
  DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at" / 1000000)) AS "month",
  SUM(oi."sale_price") AS "total_revenue",
  COUNT(DISTINCT oi."order_id") AS "total_orders"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
GROUP BY
  "month"
ORDER BY
  "month"
LIMIT 100
Results:
month,total_revenue,total_orders
2019-01-01,591.7399978637695,5
2019-02-01,2913.099986553192,35
2019-03-01,6013.850018501282,65
2019-04-01,7094.610024929047,86
2019-05-01,6236.669998407364,93
2019-06-01,11868.149987220764,144
2019-07-01,13770.510034561157,178
2019-08-01,17094.91003894806,214
2019-09-01,21261.790072202682,254
2019-10-01,22827.220034837723,274
2019-11-01,23955.80003762245,286
2019-12-01,27891.56003987789,311
2020-01-01,29570.650020837784,366
2020-02-01,34505.1600124836,388
2020-03-01,32640.36001443863,430
2020-04-01,36885.88999795914,460
2020-05-01,39519.81000304222,473
2020-06-01,37337.75005745888,482
2020-07-01,45958.470054388046,539
2020-08-01,51906.95005142689,606
2020-09-01,48473.65003871918,616
2020-10-01,60201.36998152733,714
2020-11-01,60494.74007964134,737
2020-12-01,67115.4000544548,783
2021-01-01,70824.7600274086,803
2021-02-01,58615.380001068115,698
2021-03-01,75475.599989295,875
2021-04-01,76103.03003525734,867
2021-05-01,82666.82004833221,1003
2021-06-01,83248.12016427517,991
2021-07-01,89529.30012202263,1071
2021-08-01,89756.39010858536,1081
2021-09-01,93203.14015293121,1119
2021-10-01,104375.2200512886,1272
2021-11-01,101976.05008339882,1196
2021-12-01,106648.60001420975,1235
2022-01-01,107931.32024502754,1331
2022-02-01,108077.87010645866,1252
2022-03-01,125060.57000148296,1442
2022-04-01,126106.69009137154,1470
2022-05-01,127573.71005558968,1524
2022-06-01,136939.9502775669,1627
2022-07-01,159377.45011866093,1729
2022-08-01,153951.18012265116,1818
2022-09-01,144993.0900771618,1731
2022-10-01,162629.28028202057,2021
2022-11-01,165796.6401696205,1911
2022-12-01,172347.13002562523,2035
2023-01-01,185897.37019395828,2126
2023-02-01,188464.45002174377,2108
2023-03-01,197816.85012841225,2269
2023-04-01,185431.78010799363,2341
2023-05-01,219914.69043135643,2536
2023-06-01,213704.57002985477,2518
2023-07-01,227827.2801876068,2727
2023-08-01,242320.87019777298,2869
2023-09-01,238959.30027377605,2862
2023-10-01,259164.92024493217,3183
2023-11-01,284499.3900786638,3348
2023-12-01,310206.8604063988,3542
2024-01-01,311697.49025132135,3614
2024-02-01,307729.7304265499,3714
2024-03-01,348587.2702960968,4153
2024-04-01,361021.6802973747,4289
2024-05-01,399783.7303934097,4775
2024-06-01,398330.65041172504,4944
2024-07-01,476711.50058927014,5654
2024-08-01,548317.610450983,6474
2024-09-01,616196.4706864357,7359
2024-10-01,786516.1608133502,9107

2025-01-26 08:18:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:18:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:18:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:19:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-26 08:19:01 - snowflake.connector.connection - INFO - closed
2025-01-26 08:19:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:19:01 - root - INFO - SQL:
SELECT
  "status",
  COUNT(*) AS "status_count"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDERS"
GROUP BY
  "status"
LIMIT 100
Results:
status,status_count
Cancelled,18554
Complete,31193
Processing,25119
Shipped,37538
Returned,12443

2025-01-26 08:19:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:19:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:19:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:19:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 26
2025-01-26 08:19:03 - snowflake.connector.connection - INFO - closed
2025-01-26 08:19:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:19:03 - root - INFO - SQL:
SELECT
  p."category",
  AVG(oi."sale_price") AS "average_sale_price"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
ON
  oi."product_id" = p."id"
GROUP BY
  p."category"
LIMIT 100
Results:
category,average_sale_price
Socks,20.299785083527553
Active,49.71962393214743
Maternity,51.90535684411696
Swim,57.18632826152689
Skirts,50.870521194940764
Outerwear & Coats,145.25342180796224
Clothing Sets,92.74435655197294
Accessories,43.229780272777205
Intimates,33.32644906870921
Socks & Hosiery,16.765867551210764
Sleep & Lounge,49.21708581268445
Tops & Tees,41.579498303597504
Leggings,27.279730370799577
Shorts,46.110458505719286
Sweaters,75.17778851422908
Underwear,27.134509654238798
Blazers & Jackets,91.61495353493824
Pants & Capris,53.83667080511382
Dresses,84.29710801082858
Jumpsuits & Rompers,47.03835599809079
Fashion Hoodies & Sweatshirts,54.835008855374426
Pants,59.8149358692474
Suits & Sport Coats,124.52451488062047
Suits,116.64817035716513
Plus,36.28723975198169
Jeans,98.7687617963342

2025-01-26 08:19:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:19:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:19:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:19:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 08:19:04 - snowflake.connector.connection - INFO - closed
2025-01-26 08:19:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:19:05 - root - INFO - SQL:
SELECT
  "created_at",
  DATE_TRUNC('month', TO_TIMESTAMP("created_at" / 1000000)) AS "month",
  DATE_TRUNC('year', TO_TIMESTAMP("created_at" / 1000000)) AS "year"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS"
LIMIT 100
Results:
created_at,month,year
1720493802000000,2024-07-01,2024-01-01
1729178375000000,2024-10-01,2024-01-01
1661055328000000,2022-08-01,2022-01-01
1705966661000000,2024-01-01,2024-01-01
1682314135000000,2023-04-01,2023-01-01
1660568548000000,2022-08-01,2022-01-01
1728974694000000,2024-10-01,2024-01-01
1578751742000000,2020-01-01,2020-01-01
1724075554000000,2024-08-01,2024-01-01
1707744445000000,2024-02-01,2024-01-01
1589599622000000,2020-05-01,2020-01-01
1719644204000000,2024-06-01,2024-01-01
1676676572000000,2023-02-01,2023-01-01
1677412017000000,2023-02-01,2023-01-01
1644903349000000,2022-02-01,2022-01-01
1640474769000000,2021-12-01,2021-01-01
1712764905000000,2024-04-01,2024-01-01
1729229967961963,2024-10-01,2024-01-01
1728007329000000,2024-10-01,2024-01-01
1706150578000000,2024-01-01,2024-01-01
1678868815000000,2023-03-01,2023-01-01
1725160469000000,2024-09-01,2024-01-01
1584054833000000,2020-03-01,2020-01-01
1711463348000000,2024-03-01,2024-01-01
1691764084000000,2023-08-01,2023-01-01
1664945844000000,2022-10-01,2022-01-01
1714261237000000,2024-04-01,2024-01-01
1697644910000000,2023-10-01,2023-01-01
1713164402000000,2024-04-01,2024-01-01
1713939170000000,2024-04-01,2024-01-01
1630040509000000,2021-08-01,2021-01-01
1721827103000000,2024-07-01,2024-01-01
1723866706000000,2024-08-01,2024-01-01
1711160959000000,2024-03-01,2024-01-01
1673535930000000,2023-01-01,2023-01-01
1720008585000000,2024-07-01,2024-01-01
1727331685000000,2024-09-01,2024-01-01
1711365932000000,2024-03-01,2024-01-01
1681125614000000,2023-04-01,2023-01-01
1613663024000000,2021-02-01,2021-01-01
1709804342000000,2024-03-01,2024-01-01
1625784303000000,2021-07-01,2021-01-01
1721440493000000,2024-07-01,2024-01-01
1684964345000000,2023-05-01,2023-01-01
1663712939000000,2022-09-01,2022-01-01
1728651619000000,2024-10-01,2024-01-01
1662168770000000,2022-09-01,2022-01-01
1728711702000000,2024-10-01,2024-01-01
1598071602000000,2020-08-01,2020-01-01
1683435417000000,2023-05-01,2023-01-01
1616121803000000,2021-03-01,2021-01-01
1721729098000000,2024-07-01,2024-01-01
1646128179000000,2022-03-01,2022-01-01
1624148896000000,2021-06-01,2021-01-01
1694142554000000,2023-09-01,2023-01-01
1699606015000000,2023-11-01,2023-01-01
1728595477000000,2024-10-01,2024-01-01
1577363357000000,2019-12-01,2019-01-01
1659157484000000,2022-07-01,2022-01-01
1688102275000000,2023-06-01,2023-01-01
1718984008000000,2024-06-01,2024-01-01
1728792686000000,2024-10-01,2024-01-01
1661412281000000,2022-08-01,2022-01-01
1709760112000000,2024-03-01,2024-01-01
1729132031988061,2024-10-01,2024-01-01
1682148158000000,2023-04-01,2023-01-01
1729667408791730,2024-10-01,2024-01-01
1716998581000000,2024-05-01,2024-01-01
1689600724000000,2023-07-01,2023-01-01
1631714690000000,2021-09-01,2021-01-01
1727670101000000,2024-09-01,2024-01-01
1630893640000000,2021-09-01,2021-01-01
1686134163000000,2023-06-01,2023-01-01
1713246214000000,2024-04-01,2024-01-01
1680349493000000,2023-04-01,2023-01-01
1681866831000000,2023-04-01,2023-01-01
1724850147000000,2024-08-01,2024-01-01
1703229622000000,2023-12-01,2023-01-01
1696682971000000,2023-10-01,2023-01-01
1636621532000000,2021-11-01,2021-01-01
1712238862000000,2024-04-01,2024-01-01
1586076861000000,2020-04-01,2020-01-01
1694514076000000,2023-09-01,2023-01-01
1694296944000000,2023-09-01,2023-01-01
1729315495590414,2024-10-01,2024-01-01
1707811221000000,2024-02-01,2024-01-01
1659508800000000,2022-08-01,2022-01-01
1648442250000000,2022-03-01,2022-01-01
1707641550000000,2024-02-01,2024-01-01
1706666847000000,2024-01-01,2024-01-01
1708747362000000,2024-02-01,2024-01-01
1699314104000000,2023-11-01,2023-01-01
1655114618000000,2022-06-01,2022-01-01
1722239693000000,2024-07-01,2024-01-01
1643305037000000,2022-01-01,2022-01-01
1694957157000000,2023-09-01,2023-01-01
1663827894000000,2022-09-01,2022-01-01
1651299410000000,2022-04-01,2022-01-01
1717261432000000,2024-06-01,2024-01-01
1727528534000000,2024-09-01,2024-01-01

2025-01-26 08:19:05 - root - INFO - itercount: 0
2025-01-26 08:19:05 - root - INFO - Database Name: THELOOK_ECOMMERCE
Schema Name: THELOOK_ECOMMERCE
DDL describes table information.
,0
table_name,DISTRIBUTION_CENTERS
description,
DDL,"create or replace TABLE DISTRIBUTION_CENTERS (
	""id"" NUMBER(38,0),
	""name"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT
);"

,1
table_name,ORDERS
description,
DDL,"create or replace TABLE ORDERS (
	""order_id"" NUMBER(38,0),
	""user_id"" NUMBER(38,0),
	""status"" VARCHAR(16777216),
	""gender"" VARCHAR(16777216),
	""created_at"" NUMBER(38,0),
	""returned_at"" NUMBER(38,0),
	""shipped_at"" NUMBER(38,0),
	""delivered_at"" NUMBER(38,0),
	""num_of_item"" NUMBER(38,0)
);"

,2
table_name,USERS
description,
DDL,"create or replace TABLE USERS (
	""id"" NUMBER(38,0),
	""first_name"" VARCHAR(16777216),
	""last_name"" VARCHAR(16777216),
	""email"" VARCHAR(16777216),
	""age"" NUMBER(38,0),
	""gender"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""postal_code"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""traffic_source"" VARCHAR(16777216),
	""created_at"" NUMBER(38,0)
);"

,3
table_name,EVENTS
description,
DDL,"create or replace TABLE EVENTS (
	""id"" NUMBER(38,0),
	""user_id"" NUMBER(38,0),
	""sequence_number"" NUMBER(38,0),
	""session_id"" VARCHAR(16777216),
	""created_at"" NUMBER(38,0),
	""ip_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""postal_code"" VARCHAR(16777216),
	""browser"" VARCHAR(16777216),
	""traffic_source"" VARCHAR(16777216),
	""uri"" VARCHAR(16777216),
	""event_type"" VARCHAR(16777216)
);"

,4
table_name,INVENTORY_ITEMS
description,
DDL,"create or replace TABLE INVENTORY_ITEMS (
	""id"" NUMBER(38,0),
	""product_id"" NUMBER(38,0),
	""created_at"" NUMBER(38,0),
	""sold_at"" NUMBER(38,0),
	""cost"" FLOAT,
	""product_category"" VARCHAR(16777216),
	""product_name"" VARCHAR(16777216),
	""product_brand"" VARCHAR(16777216),
	""product_retail_price"" FLOAT,
	""product_department"" VARCHAR(16777216),
	""product_sku"" VARCHAR(16777216),
	""product_distribution_center_id"" NUMBER(38,0)
);"

,5
table_name,PRODUCTS
description,
DDL,"create or replace TABLE PRODUCTS (
	""id"" NUMBER(38,0),
	""cost"" FLOAT,
	""category"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""brand"" VARCHAR(16777216),
	""retail_price"" FLOAT,
	""department"" VARCHAR(16777216),
	""sku"" VARCHAR(16777216),
	""distribution_center_id"" NUMBER(38,0)
);"

,6
table_name,ORDER_ITEMS
description,
DDL,"create or replace TABLE ORDER_ITEMS (
	""id"" NUMBER(38,0),
	""order_id"" NUMBER(38,0),
	""user_id"" NUMBER(38,0),
	""product_id"" NUMBER(38,0),
	""inventory_item_id"" NUMBER(38,0),
	""status"" VARCHAR(16777216),
	""created_at"" NUMBER(38,0),
	""shipped_at"" NUMBER(38,0),
	""delivered_at"" NUMBER(38,0),
	""returned_at"" NUMBER(38,0),
	""sale_price"" FLOAT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'THELOOK_ECOMMERCE': {'THELOOK_ECOMMERCE': ['DISTRIBUTION_CENTERS', 'EVENTS', 'INVENTORY_ITEMS', 'ORDERS', 'ORDER_ITEMS', 'PRODUCTS', 'USERS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **PRODUCTS**
  - `"id"`: Product identifier; used to link to `"product_id"` in `ORDER_ITEMS`.
  - `"category"`: Used to group data by product category.
  - `"cost"`: Cost of the product; used to calculate total cost.
  - `"retail_price"`: Retail price of the product; can be used to compare with sale price.

- **ORDER_ITEMS**
  - `"order_id"`: Identifier for the order; used to link to `ORDERS` table.
  - `"product_id"`: Identifier for the product; used to link to `PRODUCTS` table.
  - `"sale_price"`: Sale price of the item; used to calculate revenue.
  - `"created_at"`: Timestamp when the order item was created; used to determine the month.
  - `"delivered_at"`: Delivery timestamp; used to filter items delivered before 2022.
  - `"status"`: Status of the order item; used to filter for completed and delivered orders.

- **ORDERS**
  - `"order_id"`: Identifier for the order; used to link to `ORDER_ITEMS` table.
  - `"status"`: Overall status of the order.
  - `"created_at"`: Timestamp when the order was created.
  - `"delivered_at"`: Delivery timestamp for the order.
  
**Conditions that may be used:**

- Include only orders with `"status"` indicating completion and delivery.
- Filter records where `"delivered_at"` is before `'2022-01-01'`.
- Group data by product `"category"` and by month extracted from `"created_at"`.
- Use `"sale_price"` and `"cost"` to calculate revenue, profit, and profit-to-cost ratio.

---

**SQL Queries:**

1. **Retrieve distinct product categories:**

   ```sql
   SELECT DISTINCT "category"
   FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS"
   LIMIT 100;
   ```

2. **List all order items delivered before 2022:**

   ```sql
   SELECT "order_id", "product_id", "sale_price", "delivered_at"
   FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS"
   WHERE "delivered_at" < '2022-01-01'
   LIMIT 100;
   ```

3. **Find completed and delivered order items before 2022:**

   ```sql
   SELECT "order_id", "product_id", "sale_price", "status", "delivered_at"
   FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS"
   WHERE "status" = 'Completed' AND "delivered_at" < '2022-01-01'
   LIMIT 100;
   ```

4. **Join `ORDER_ITEMS` with `PRODUCTS` to get categories:**

   ```sql
   SELECT oi."order_id", oi."product_id", p."category", oi."sale_price"
   FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
   JOIN THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
     ON oi."product_id" = p."id"
   LIMIT 100;
   ```

5. **Calculate total revenue per category:**

   ```sql
   SELECT p."category", SUM(oi."sale_price") AS "total_revenue"
   FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
   JOIN THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
     ON oi."product_id" = p."id"
   GROUP BY p."category"
   LIMIT 100;
   ```

6. **Get monthly order count per category:**

   ```sql
   SELECT p."category", DATE_TRUNC('month', oi."created_at") AS "month", COUNT(*) AS "order_count"
   FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
   JOIN THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
     ON oi."product_id" = p."id"
   GROUP BY p."category", "month"
   LIMIT 100;
   ```

7. **Compute total cost per category per month:**

   ```sql
   SELECT p."category", DATE_TRUNC('month', oi."created_at") AS "month", SUM(p."cost") AS "total_cost"
   FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
   JOIN THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
     ON oi."product_id" = p."id"
   WHERE oi."delivered_at" < '2022-01-01'
   GROUP BY p."category", "month"
   LIMIT 100;
   ```

8. **Calculate profit per category per month:**

   ```sql
   SELECT p."category", DATE_TRUNC('month', oi."created_at") AS "month",
          SUM(oi."sale_price" - p."cost") AS "profit"
   FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
   JOIN THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
     ON oi."product_id" = p."id"
   WHERE oi."delivered_at" < '2022-01-01'
   GROUP BY p."category", "month"
   LIMIT 100;
   ```

9. **List orders with their statuses from `ORDERS` table:**

   ```sql
   SELECT oi."order_id", o."status" AS "order_status", oi."product_id", oi."sale_price"
   FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
   JOIN THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDERS" o
     ON oi."order_id" = o."order_id"
   LIMIT 100;
   ```

10. **Get total revenue per category per month:**

    ```sql
    SELECT p."category", DATE_TRUNC('month', oi."created_at") AS "month",
           SUM(oi."sale_price") AS "monthly_revenue"
    FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
    JOIN THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
      ON oi."product_id" = p."id"
    WHERE oi."delivered_at" < '2022-01-01'
    GROUP BY p."category", "month"
    ORDER BY p."category", "month"
    LIMIT 100;
    ```

11. **Get number of orders per category per month:**

    ```sql
    SELECT p."category", DATE_TRUNC('month', oi."created_at") AS "month",
           COUNT(DISTINCT oi."order_id") AS "orders_count"
    FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
    JOIN THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
      ON oi."product_id" = p."id"
    WHERE oi."delivered_at" < '2022-01-01'
    GROUP BY p."category", "month"
    LIMIT 100;
    ```

12. **Calculate profit-to-cost ratio per category per month:**

    ```sql
    SELECT p."category", DATE_TRUNC('month', oi."created_at") AS "month",
           SUM(oi."sale_price" - p."cost") / SUM(p."cost") AS "profit_to_cost_ratio"
    FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
    JOIN THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
      ON oi."product_id" = p."id"
    WHERE oi."delivered_at" < '2022-01-01' AND p."cost" > 0
    GROUP BY p."category", "month"
    LIMIT 100;
    ```

13. **Retrieve sale prices and costs for delivered order items:**

    ```sql
    SELECT oi."order_id", oi."product_id", oi."sale_price", p."cost", oi."delivered_at"
    FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
    JOIN THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
      ON oi."product_id" = p."id"
    WHERE oi."delivered_at" < '2022-01-01'
    LIMIT 100;
    ```

14. **Find the month-over-month revenue for a specific category:**

    ```sql
    SELECT DATE_TRUNC('month', oi."created_at") AS "month",
           SUM(oi."sale_price") AS "monthly_revenue"
    FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
    JOIN THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
      ON oi."product_id" = p."id"
    WHERE p."category" = 'Electronics' AND oi."delivered_at" < '2022-01-01'
    GROUP BY "month"
    ORDER BY "month"
    LIMIT 100;
    ```

15. **List products with their categories and prices:**

    ```sql
    SELECT "id", "category", "name", "cost", "retail_price"
    FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS"
    LIMIT 100;
    ```

16. **Identify top-selling products per category:**

    ```sql
    SELECT p."category", p."name", COUNT(oi."product_id") AS "units_sold"
    FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
    JOIN THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
      ON oi."product_id" = p."id"
    WHERE oi."delivered_at" < '2022-01-01'
    GROUP BY p."category", p."name"
    ORDER BY p."category", "units_sold" DESC
    LIMIT 100;
    ```

17. **Aggregate monthly revenue and orders for all categories:**

    ```sql
    SELECT DATE_TRUNC('month', oi."created_at") AS "month",
           SUM(oi."sale_price") AS "total_revenue",
           COUNT(DISTINCT oi."order_id") AS "total_orders"
    FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
    WHERE oi."delivered_at" < '2022-01-01'
    GROUP BY "month"
    ORDER BY "month"
    LIMIT 100;
    ```

18. **Check the status distribution of orders:**

    ```sql
    SELECT "status", COUNT(*) AS "status_count"
    FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDERS"
    GROUP BY "status"
    LIMIT 100;
    ```

19. **Find average sale price per category:**

    ```sql
    SELECT p."category", AVG(oi."sale_price") AS "average_sale_price"
    FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
    JOIN THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
      ON oi."product_id" = p."id"
    GROUP BY p."category"
    LIMIT 100;
    ```

20. **Extract month and year from `created_at` timestamps:**

    ```sql
    SELECT "created_at", DATE_TRUNC('month', "created_at") AS "month", DATE_TRUNC('year', "created_at") AS "year"
    FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS"
    LIMIT 100;
    ```

These queries help to understand the relevant data in the tables and how they can be utilized to generate the required monthly report for each product category, focusing on revenue, orders, costs, profit, and ratios for orders completed and delivered before 2022.Query:
SELECT DISTINCT "category"
   FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS"
   LIMIT 100;
Answer:
category
Accessories
Plus
Swim
Active
Socks & Hosiery
Socks
Dresses
Pants & Capris
Fashion Hoodies & Sweatshirts
Skirts
Blazers & Jackets
Suits
Tops & Tees
Sweaters
Jeans
Sleep & Lounge
Suits & Sport Coats
Pants
Intimates
Outerwear & Coats
Maternity
Jumpsuits & Rompers
Clothing Sets
Underwear
Shorts
Leggings
Query:
SELECT "order_id", "product_id", "sale_price", "delivered_at", TRY_TO_TIMESTAMP("delivered_at") AS "delivered_date"
FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS"
WHERE TRY_TO_TIMESTAMP("delivered_at") < '2022-01-01' AND TRY_TO_TIMESTAMP("delivered_at") IS NOT NULL
LIMIT 100;
Answer:
001065 (22023): 01b9f72b-0004-8343-0001-11c300fac98e: SQL compilation error:
Function TRY_CAST cannot be used with arguments of types NUMBER(38,0) and TIMESTAMP_NTZ(0)Query:
SELECT "order_id", "product_id", "sale_price", "status", "delivered_at"
FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS"
WHERE "status" = 'Completed'
LIMIT 100;
Answer:
No data found for the specified query.
Query:
SELECT oi."order_id", oi."product_id", p."category", oi."sale_price"
   FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
   JOIN THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
     ON oi."product_id" = p."id"
   LIMIT 100;
Answer:
order_id,product_id,category,sale_price
14805,14235,Accessories,0.0199999995529651
71201,14235,Accessories,0.0199999995529651
81114,14235,Accessories,0.0199999995529651
109826,14235,Accessories,0.0199999995529651
49859,14235,Accessories,0.0199999995529651
6684,14235,Accessories,0.0199999995529651
82012,14159,Accessories,0.4900000095367431
28060,14159,Accessories,0.4900000095367431
63169,14159,Accessories,0.4900000095367431
12239,14159,Accessories,0.4900000095367431
50479,14159,Accessories,0.4900000095367431
73832,14159,Accessories,0.4900000095367431
108606,14159,Accessories,0.4900000095367431
114916,14159,Accessories,0.4900000095367431
35245,14202,Accessories,1.5
42210,14202,Accessories,1.5
5718,14202,Accessories,1.5
6074,14202,Accessories,1.5
25844,14202,Accessories,1.5
33209,14202,Accessories,1.5
57511,28700,Accessories,1.5
108498,28700,Accessories,1.5
5338,28700,Accessories,1.5
33098,14202,Accessories,1.5
76384,28700,Accessories,1.5
101325,14202,Accessories,1.5
7232,14202,Accessories,1.5
46807,14202,Accessories,1.5
120416,28700,Accessories,1.5
61834,13629,Accessories,1.5099999904632568
79332,13629,Accessories,1.5099999904632568
14956,13629,Accessories,1.5099999904632568
3229,13629,Accessories,1.5099999904632568
69780,13629,Accessories,1.5099999904632568
103440,13629,Accessories,1.5099999904632568
100896,13629,Accessories,1.5099999904632568
18515,13629,Accessories,1.5099999904632568
18022,14298,Accessories,1.7200000286102295
63483,14298,Accessories,1.7200000286102295
90395,12536,Intimates,1.75
105059,12536,Intimates,1.75
122880,12536,Intimates,1.75
106189,12536,Intimates,1.75
21501,15332,Plus,1.8200000524520876
35298,15332,Plus,1.8200000524520876
111104,15332,Plus,1.8200000524520876
7274,15332,Plus,1.8200000524520876
11963,15332,Plus,1.8200000524520876
12507,15332,Plus,1.8200000524520876
83546,15332,Plus,1.8200000524520876
33669,13659,Accessories,1.8200000524520876
34236,13659,Accessories,1.8200000524520876
105655,15332,Plus,1.8200000524520876
111185,15332,Plus,1.8200000524520876
112616,15332,Plus,1.8200000524520876
54378,15332,Plus,1.8200000524520876
6059,15332,Plus,1.8200000524520876
28271,13659,Accessories,1.8200000524520876
34370,13659,Accessories,1.8200000524520876
55186,15332,Plus,1.8200000524520876
62067,13659,Accessories,1.8200000524520876
88741,15332,Plus,1.8200000524520876
11966,9204,Socks & Hosiery,1.950000047683716
72980,3049,Active,1.950000047683716
21690,3049,Active,1.950000047683716
80738,3049,Active,1.950000047683716
119820,3049,Active,1.950000047683716
29862,3049,Active,1.950000047683716
115326,9204,Socks & Hosiery,1.950000047683716
121983,3049,Active,1.950000047683716
20438,3049,Active,1.950000047683716
32712,14549,Maternity,1.9800000190734863
100600,14549,Maternity,1.9800000190734863
73565,14549,Maternity,1.9800000190734863
18204,14549,Maternity,1.9800000190734863
26774,14549,Maternity,1.9800000190734863
70016,14549,Maternity,1.9800000190734863
72412,14549,Maternity,1.9800000190734863
80353,14549,Maternity,1.9800000190734863
34337,13606,Accessories,2.5
119193,13606,Accessories,2.5
70001,13606,Accessories,2.5
33789,13606,Accessories,2.5
9452,13606,Accessories,2.5
74155,13606,Accessories,2.5
78943,13606,Accessories,2.5
82140,13606,Accessories,2.5
115070,13606,Accessories,2.5
29512,28913,Accessories,2.5899999141693115
65881,28913,Accessories,2.5899999141693115
20397,28913,Accessories,2.5899999141693115
9775,28913,Accessories,2.5899999141693115
11503,28913,Accessories,2.5899999141693115
79830,28913,Accessories,2.5899999141693115
85088,28913,Accessories,2.5899999141693115
33372,28913,Accessories,2.5899999141693115
6653,13690,Accessories,2.6700000762939453
41376,13690,Accessories,2.6700000762939453
5930,15395,Plus,2.6700000762939453
10820,13690,Accessories,2.6700000762939453
Query:
SELECT p."category", SUM(oi."sale_price") AS "total_revenue"
   FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
   JOIN THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
     ON oi."product_id" = p."id"
   GROUP BY p."category"
   LIMIT 100;
Answer:
category,total_revenue
Accessories,426937.3099739477
Intimates,443541.7106554508
Socks & Hosiery,62033.70993947983
Sleep & Lounge,548868.940983057
Tops & Tees,497956.07168388367
Leggings,87022.33988285065
Shorts,515053.82150888443
Sweaters,816881.8499956131
Underwear,203074.67025232315
Blazers & Jackets,284830.890540123
Pants & Capris,183690.72078704834
Dresses,447111.8608894348
Jumpsuits & Rompers,41770.06012630463
Fashion Hoodies & Sweatshirts,653688.1405649185
Pants,422951.41153144836
Suits & Sport Coats,635448.5994358063
Suits,128779.5800743103
Plus,158538.950476408
Jeans,1256239.8812875748
Socks,126569.1599957943
Active,441559.9801414013
Maternity,262485.38956069946
Swim,649922.6206922531
Skirts,102504.10020780563
Outerwear & Coats,1322241.8987178802
Clothing Sets,18734.360023498535
Query:
SELECT
  p."category",
  DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at" / 1000000)) AS "month",
  COUNT(*) AS "order_count"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
  ON oi."product_id" = p."id"
GROUP BY
  p."category",
  DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at" / 1000000))
LIMIT 100;
Answer:
category,month,order_count
Accessories,2024-07-01,422
Accessories,2024-01-01,267
Accessories,2024-10-01,728
Accessories,2024-02-01,300
Accessories,2024-06-01,377
Accessories,2022-02-01,90
Accessories,2024-04-01,345
Accessories,2024-09-01,570
Accessories,2024-03-01,321
Accessories,2022-10-01,137
Plus,2024-10-01,346
Plus,2022-03-01,59
Accessories,2022-07-01,122
Maternity,2023-12-01,160
Intimates,2024-09-01,744
Accessories,2023-11-01,286
Accessories,2022-11-01,167
Intimates,2024-06-01,507
Plus,2024-09-01,234
Accessories,2023-08-01,238
Plus,2023-06-01,73
Socks,2023-12-01,184
Intimates,2022-05-01,146
Sleep & Lounge,2021-02-01,61
Accessories,2020-06-01,33
Accessories,2022-03-01,111
Plus,2023-09-01,96
Plus,2024-06-01,167
Plus,2024-04-01,148
Plus,2020-11-01,32
Accessories,2023-06-01,182
Accessories,2019-05-01,6
Intimates,2023-04-01,249
Intimates,2023-11-01,348
Plus,2024-02-01,103
Intimates,2024-05-01,480
Socks,2021-06-01,50
Socks & Hosiery,2024-04-01,127
Plus,2022-08-01,57
Socks & Hosiery,2024-08-01,180
Leggings,2020-12-01,19
Tops & Tees,2023-08-01,259
Underwear,2024-02-01,218
Tops & Tees,2023-07-01,260
Sleep & Lounge,2024-04-01,362
Plus,2024-03-01,124
Socks & Hosiery,2022-12-01,62
Socks & Hosiery,2023-02-01,64
Plus,2024-07-01,193
Socks,2024-09-01,366
Socks,2021-10-01,64
Socks,2019-07-01,10
Socks,2023-03-01,106
Intimates,2020-11-01,89
Socks,2019-10-01,12
Leggings,2020-10-01,18
Socks,2023-02-01,108
Tops & Tees,2022-03-01,151
Plus,2020-03-01,19
Socks,2020-10-01,30
Shorts,2020-11-01,68
Leggings,2020-03-01,19
Active,2022-11-01,154
Accessories,2021-08-01,74
Accessories,2024-08-01,489
Maternity,2021-09-01,45
Accessories,2023-07-01,219
Intimates,2024-02-01,399
Accessories,2021-10-01,92
Plus,2022-11-01,60
Socks,2023-09-01,150
Active,2024-03-01,300
Accessories,2023-03-01,173
Accessories,2023-01-01,169
Maternity,2023-04-01,79
Accessories,2021-11-01,86
Accessories,2022-09-01,140
Accessories,2021-07-01,94
Socks & Hosiery,2023-11-01,98
Socks,2021-12-01,56
Intimates,2023-05-01,261
Plus,2022-05-01,49
Plus,2021-02-01,30
Sleep & Lounge,2024-10-01,798
Intimates,2024-01-01,412
Accessories,2023-05-01,186
Intimates,2019-07-01,14
Intimates,2023-01-01,210
Accessories,2019-03-01,3
Accessories,2021-05-01,65
Active,2024-06-01,337
Leggings,2020-04-01,20
Intimates,2020-09-01,65
Shorts,2021-09-01,115
Shorts,2021-10-01,107
Active,2024-08-01,428
Socks,2020-02-01,17
Socks & Hosiery,2022-08-01,59
Accessories,2020-04-01,42
Plus,2023-01-01,60
Query:
SELECT
  p."category",
  DATE_TRUNC('month', TO_TIMESTAMP_NTZ(oi."created_at", 3)) AS "month",
  SUM(p."cost") AS "total_cost"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
  ON oi."product_id" = p."id"
WHERE
  TO_TIMESTAMP_NTZ(oi."delivered_at", 3) < '2022-01-01'
GROUP BY
  p."category",
  "month"
LIMIT 100;
Answer:
No data found for the specified query.
Query:
SELECT
  p."category",
  SUM(oi."sale_price") AS "total_revenue",
  COUNT(*) AS "order_count",
  SUM(p."cost") AS "total_cost",
  SUM(oi."sale_price" - p."cost") AS "profit",
  CASE WHEN SUM(p."cost") <> 0 THEN ROUND(SUM(oi."sale_price" - p."cost") / SUM(p."cost"), 2) ELSE NULL END AS "profit_to_cost_ratio"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
  ON oi."product_id" = p."id"
GROUP BY
  p."category"
ORDER BY
  p."category"
LIMIT 100;
Answer:
category,total_revenue,order_count,total_cost,profit,profit_to_cost_ratio
Accessories,426937.3099739477,9876,171096.9168307665,255840.3931431812,1.5
Active,441559.9801414013,8881,185191.5272508636,256368.45289053768,1.38
Blazers & Jackets,284830.890540123,3109,108080.69835994003,176750.19218018296,1.64
Clothing Sets,18734.360023498535,202,11637.925386813478,7096.434636685057,0.61
Dresses,447111.8608894348,5304,201145.91800210255,245965.94288733223,1.22
Fashion Hoodies & Sweatshirts,653688.1405649185,11921,340273.04220220534,313415.0983627132,0.92
Intimates,443541.7106554508,13309,235614.82883713764,207926.88181831318,0.88
Jeans,1256239.8812875748,12719,672077.4799035509,584162.4013840238,0.87
Jumpsuits & Rompers,41770.06012630463,888,22224.494231877212,19545.565894427415,0.88
Leggings,87022.33988285065,3190,52274.622346711665,34747.71753613898,0.66
Maternity,262485.38956069946,5057,115877.79667712291,146607.59288357655,1.27
Outerwear & Coats,1322241.8987178802,9103,587591.9272744494,734649.9714434309,1.25
Pants,422951.41153144836,7071,194310.29789643275,228641.11363501562,1.18
Pants & Capris,183690.72078704834,3412,97070.56670718525,86620.15407986309,0.89
Plus,158538.950476408,4369,79352.63377180489,79186.31670460312,1.0
Shorts,515053.82150888443,11170,257945.9051182496,257107.91639063484,1.0
Skirts,102504.10020780563,2015,40811.22840352045,61692.87180428518,1.51
Sleep & Lounge,548868.940983057,11152,264375.5049253032,284493.4360577538,1.08
Socks,126569.1599957943,6235,76487.21929606877,50081.940699725536,0.65
Socks & Hosiery,62033.70993947983,3700,24959.739046142568,37073.97089333726,1.49
Suits,128779.5800743103,1104,77756.09290896359,51023.48716534671,0.66
Suits & Sport Coats,635448.5994358063,5103,254953.13236611083,380495.4670696954,1.49
Sweaters,816881.8499956131,10866,393671.3018383027,423210.5481573104,1.08
Swim,649922.6206922531,11365,330078.00332746434,319844.6173647888,0.97
Tops & Tees,497956.07168388367,11976,278654.3148072619,219301.75687662174,0.79
Underwear,203074.67025232315,7484,95465.27329001566,107609.39696230748,1.13
Query:
SELECT
  oi."order_id",
  o."status" AS "order_status",
  oi."product_id",
  oi."sale_price"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDERS" o
ON
  oi."order_id" = o."order_id"
LIMIT 100
Answer:
order_id,order_status,product_id,sale_price
14805,Cancelled,14235,0.0199999995529651
71201,Complete,14235,0.0199999995529651
81114,Complete,14235,0.0199999995529651
109826,Complete,14235,0.0199999995529651
49859,Returned,14235,0.0199999995529651
6684,Shipped,14235,0.0199999995529651
82012,Cancelled,14159,0.4900000095367431
28060,Processing,14159,0.4900000095367431
63169,Processing,14159,0.4900000095367431
12239,Shipped,14159,0.4900000095367431
50479,Shipped,14159,0.4900000095367431
73832,Shipped,14159,0.4900000095367431
108606,Shipped,14159,0.4900000095367431
114916,Shipped,14159,0.4900000095367431
35245,Cancelled,14202,1.5
42210,Complete,14202,1.5
5718,Processing,14202,1.5
6074,Processing,14202,1.5
25844,Processing,14202,1.5
33209,Processing,14202,1.5
57511,Processing,28700,1.5
108498,Processing,28700,1.5
5338,Returned,28700,1.5
33098,Returned,14202,1.5
76384,Returned,28700,1.5
101325,Returned,14202,1.5
7232,Shipped,14202,1.5
46807,Shipped,14202,1.5
120416,Shipped,28700,1.5
61834,Cancelled,13629,1.5099999904632568
79332,Cancelled,13629,1.5099999904632568
14956,Complete,13629,1.5099999904632568
3229,Processing,13629,1.5099999904632568
69780,Processing,13629,1.5099999904632568
103440,Processing,13629,1.5099999904632568
100896,Returned,13629,1.5099999904632568
18515,Shipped,13629,1.5099999904632568
18022,Shipped,14298,1.7200000286102295
63483,Shipped,14298,1.7200000286102295
90395,Complete,12536,1.75
105059,Complete,12536,1.75
122880,Complete,12536,1.75
106189,Shipped,12536,1.75
21501,Cancelled,15332,1.8200000524520876
35298,Cancelled,15332,1.8200000524520876
111104,Cancelled,15332,1.8200000524520876
7274,Complete,15332,1.8200000524520876
11963,Complete,15332,1.8200000524520876
12507,Complete,15332,1.8200000524520876
83546,Complete,15332,1.8200000524520876
33669,Processing,13659,1.8200000524520876
34236,Processing,13659,1.8200000524520876
105655,Processing,15332,1.8200000524520876
111185,Processing,15332,1.8200000524520876
112616,Processing,15332,1.8200000524520876
54378,Returned,15332,1.8200000524520876
6059,Shipped,15332,1.8200000524520876
28271,Shipped,13659,1.8200000524520876
34370,Shipped,13659,1.8200000524520876
55186,Shipped,15332,1.8200000524520876
62067,Shipped,13659,1.8200000524520876
88741,Shipped,15332,1.8200000524520876
11966,Cancelled,9204,1.950000047683716
72980,Cancelled,3049,1.950000047683716
21690,Complete,3049,1.950000047683716
80738,Complete,3049,1.950000047683716
119820,Complete,3049,1.950000047683716
29862,Processing,3049,1.950000047683716
115326,Processing,9204,1.950000047683716
121983,Processing,3049,1.950000047683716
20438,Shipped,3049,1.950000047683716
32712,Complete,14549,1.9800000190734863
100600,Complete,14549,1.9800000190734863
73565,Processing,14549,1.9800000190734863
18204,Shipped,14549,1.9800000190734863
26774,Shipped,14549,1.9800000190734863
70016,Shipped,14549,1.9800000190734863
72412,Shipped,14549,1.9800000190734863
80353,Shipped,14549,1.9800000190734863
34337,Cancelled,13606,2.5
119193,Cancelled,13606,2.5
70001,Complete,13606,2.5
33789,Processing,13606,2.5
9452,Shipped,13606,2.5
74155,Shipped,13606,2.5
78943,Shipped,13606,2.5
82140,Shipped,13606,2.5
115070,Shipped,13606,2.5
29512,Cancelled,28913,2.5899999141693115
65881,Cancelled,28913,2.5899999141693115
20397,Complete,28913,2.5899999141693115
9775,Processing,28913,2.5899999141693115
11503,Processing,28913,2.5899999141693115
79830,Processing,28913,2.5899999141693115
85088,Processing,28913,2.5899999141693115
33372,Shipped,28913,2.5899999141693115
6653,Cancelled,13690,2.6700000762939453
41376,Cancelled,13690,2.6700000762939453
5930,Complete,15395,2.6700000762939453
10820,Complete,13690,2.6700000762939453
Query:
SELECT
  p."category",
  DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at" / 1000000)) AS "month",
  SUM(oi."sale_price") AS "monthly_revenue"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
ON
  oi."product_id" = p."id"
GROUP BY
  p."category",
  "month"
ORDER BY
  p."category",
  "month"
LIMIT 100
Answer:
category,month,monthly_revenue
Accessories,2019-02-01,42.90000057220459
Accessories,2019-03-01,82.38000011444092
Accessories,2019-04-01,83.95000076293945
Accessories,2019-05-01,169.3200032711029
Accessories,2019-06-01,565.9999980926514
Accessories,2019-07-01,406.540002822876
Accessories,2019-08-01,743.5099983215332
Accessories,2019-09-01,656.3500077724457
Accessories,2019-10-01,1159.1799988746643
Accessories,2019-11-01,886.7700064182281
Accessories,2019-12-01,1176.7000085115433
Accessories,2020-01-01,1119.3299977779388
Accessories,2020-02-01,1289.6300203800201
Accessories,2020-03-01,964.4700031280518
Accessories,2020-04-01,1729.2199885845184
Accessories,2020-05-01,1867.4900104999542
Accessories,2020-06-01,1479.0300011634827
Accessories,2020-07-01,1542.5799911022186
Accessories,2020-08-01,2448.600004673004
Accessories,2020-09-01,1615.5200028419495
Accessories,2020-10-01,2797.199989080429
Accessories,2020-11-01,2999.7800030708313
Accessories,2020-12-01,2729.9200110435486
Accessories,2021-01-01,2821.3199968338013
Accessories,2021-02-01,2431.5799856185913
Accessories,2021-03-01,2947.699996829033
Accessories,2021-04-01,3343.589996099472
Accessories,2021-05-01,3058.2200179100037
Accessories,2021-06-01,2817.8800036907196
Accessories,2021-07-01,4384.099987030029
Accessories,2021-08-01,3434.4700107574463
Accessories,2021-09-01,4094.4499912261963
Accessories,2021-10-01,4042.259989976883
Accessories,2021-11-01,3377.2099800109863
Accessories,2021-12-01,2882.1999986171722
Accessories,2022-01-01,5339.400004148483
Accessories,2022-02-01,4232.74000620842
Accessories,2022-03-01,4839.059978961945
Accessories,2022-04-01,4599.249974727631
Accessories,2022-05-01,4868.160014152527
Accessories,2022-06-01,6321.680026292801
Accessories,2022-07-01,5228.419990181923
Accessories,2022-08-01,5187.689974583685
Accessories,2022-09-01,5524.569988250732
Accessories,2022-10-01,5736.299985408783
Accessories,2022-11-01,6877.370015382767
Accessories,2022-12-01,6659.860012054443
Accessories,2023-01-01,7938.559997797012
Accessories,2023-02-01,6390.309992074966
Accessories,2023-03-01,8462.279976844788
Accessories,2023-04-01,8418.410002727062
Accessories,2023-05-01,8645.320052862167
Accessories,2023-06-01,7469.79000210762
Accessories,2023-07-01,10159.879982233047
Accessories,2023-08-01,9329.280014038086
Accessories,2023-09-01,8519.270018815994
Accessories,2023-10-01,9776.35997390747
Accessories,2023-11-01,12254.210008382797
Accessories,2023-12-01,12208.480020523071
Accessories,2024-01-01,11857.03000094369
Accessories,2024-02-01,11368.429980516434
Accessories,2024-03-01,13032.650015354156
Accessories,2024-04-01,14470.700029850006
Accessories,2024-05-01,15192.440013170242
Accessories,2024-06-01,16308.209975838661
Accessories,2024-07-01,19732.370028395206
Accessories,2024-08-01,22264.76996922493
Accessories,2024-09-01,27165.109978199005
Accessories,2024-10-01,32367.59996630624
Active,2019-02-01,187.93999862670898
Active,2019-03-01,156.9800033569336
Active,2019-04-01,189.3299970626831
Active,2019-05-01,270.94000244140625
Active,2019-06-01,412.52999687194824
Active,2019-07-01,772.930009841919
Active,2019-08-01,405.26000213623047
Active,2019-09-01,1211.9699993133545
Active,2019-10-01,2045.2799921035767
Active,2019-11-01,926.8199996948242
Active,2019-12-01,937.0
Active,2020-01-01,1041.1900053024292
Active,2020-02-01,1899.1900043487549
Active,2020-03-01,654.3300008773804
Active,2020-04-01,1558.6400017738342
Active,2020-05-01,1381.7299966812134
Active,2020-06-01,995.9899988174438
Active,2020-07-01,1700.3699989318848
Active,2020-08-01,1845.71000289917
Active,2020-09-01,2275.6899938583374
Active,2020-10-01,1560.8599920272827
Active,2020-11-01,3012.3800010681152
Active,2020-12-01,2470.5200085639954
Active,2021-01-01,2521.7500009536743
Active,2021-02-01,2309.040003299713
Active,2021-03-01,3969.2600088119507
Active,2021-04-01,3154.3600091934204
Active,2021-05-01,2917.67001247406
Active,2021-06-01,3739.620005607605
Active,2021-07-01,3581.4100008010864
Active,2021-08-01,3555.2299842834473
Query:
SELECT
  p."category",
  DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at" / 1000000)) AS "month",
  COUNT(DISTINCT oi."order_id") AS "orders_count"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
ON
  oi."product_id" = p."id"
GROUP BY
  p."category",
  "month"
LIMIT 100
Answer:
category,month,orders_count
Accessories,2024-10-01,711
Accessories,2024-01-01,258
Accessories,2023-03-01,162
Accessories,2022-10-01,135
Accessories,2024-04-01,340
Accessories,2024-03-01,316
Accessories,2024-09-01,558
Accessories,2024-06-01,369
Accessories,2023-08-01,232
Sleep & Lounge,2021-02-01,59
Accessories,2021-08-01,73
Maternity,2021-09-01,45
Socks & Hosiery,2023-11-01,96
Accessories,2022-02-01,88
Active,2021-09-01,66
Accessories,2019-05-01,6
Accessories,2024-07-01,413
Plus,2024-06-01,166
Socks & Hosiery,2023-02-01,64
Active,2024-05-01,329
Socks,2019-02-01,5
Accessories,2023-11-01,282
Plus,2022-03-01,58
Plus,2024-10-01,341
Accessories,2024-02-01,291
Accessories,2023-01-01,159
Accessories,2024-08-01,481
Tops & Tees,2020-04-01,45
Plus,2022-05-01,46
Intimates,2022-07-01,174
Socks,2024-01-01,169
Socks,2021-06-01,46
Sleep & Lounge,2023-09-01,259
Plus,2020-11-01,32
Accessories,2022-09-01,139
Accessories,2021-05-01,63
Active,2024-06-01,327
Socks & Hosiery,2024-08-01,176
Socks,2023-12-01,176
Swim,2021-05-01,89
Intimates,2024-09-01,707
Plus,2024-07-01,189
Leggings,2023-10-01,88
Swim,2022-03-01,137
Intimates,2023-11-01,332
Intimates,2024-05-01,454
Underwear,2019-04-01,2
Socks & Hosiery,2022-08-01,55
Maternity,2019-07-01,6
Accessories,2022-11-01,161
Plus,2024-08-01,237
Accessories,2021-07-01,91
Leggings,2020-12-01,18
Accessories,2023-05-01,184
Accessories,2020-11-01,60
Intimates,2022-11-01,173
Intimates,2022-05-01,137
Plus,2021-02-01,30
Intimates,2021-10-01,137
Underwear,2021-09-01,64
Active,2024-02-01,226
Dresses,2024-01-01,141
Accessories,2020-06-01,31
Intimates,2024-06-01,480
Intimates,2023-04-01,230
Sleep & Lounge,2024-01-01,334
Intimates,2024-01-01,386
Socks,2019-07-01,10
Accessories,2021-11-01,85
Plus,2024-03-01,122
Socks & Hosiery,2024-02-01,95
Maternity,2023-04-01,76
Socks,2021-10-01,64
Tops & Tees,2020-08-01,47
Accessories,2022-03-01,108
Socks,2024-09-01,356
Intimates,2020-03-01,51
Tops & Tees,2023-09-01,259
Intimates,2021-08-01,102
Shorts,2020-05-01,39
Socks,2021-02-01,32
Accessories,2020-04-01,40
Leggings,2022-06-01,42
Plus,2022-12-01,58
Plus,2021-07-01,24
Dresses,2023-03-01,78
Intimates,2022-08-01,195
Fashion Hoodies & Sweatshirts,2023-02-01,214
Plus,2023-01-01,60
Accessories,2021-10-01,91
Plus,2024-09-01,230
Intimates,2023-05-01,239
Plus,2023-09-01,94
Socks,2023-10-01,190
Plus,2022-04-01,56
Socks,2023-09-01,144
Socks & Hosiery,2022-02-01,46
Intimates,2024-02-01,376
Socks,2024-04-01,198
Accessories,2023-06-01,177
Query:
SELECT
  p."category",
  DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at" / 1000000)) AS "month",
  SUM(oi."sale_price" - p."cost") / NULLIF(SUM(p."cost"), 0) AS "profit_to_cost_ratio"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
ON
  oi."product_id" = p."id"
WHERE
  p."cost" > 0
GROUP BY
  p."category",
  "month"
LIMIT 100
Answer:
category,month,profit_to_cost_ratio
Accessories,2024-07-01,1.4979525362578106
Accessories,2024-10-01,1.4923778112853836
Accessories,2024-01-01,1.4967177045726971
Accessories,2024-08-01,1.4671478758925554
Accessories,2024-02-01,1.486323630770613
Accessories,2022-02-01,1.5509875616781281
Accessories,2024-04-01,1.4962290870139132
Accessories,2024-09-01,1.524250935833139
Accessories,2024-03-01,1.4877657208324615
Accessories,2021-08-01,1.4862561304078878
Accessories,2023-01-01,1.4849959715208065
Plus,2024-10-01,1.0054032230482706
Socks & Hosiery,2022-08-01,1.4569292910910747
Active,2024-03-01,1.3782695420741402
Active,2024-05-01,1.3793747695341418
Plus,2024-06-01,1.0209089317176323
Accessories,2022-11-01,1.5400331766887458
Accessories,2023-07-01,1.4809711143324256
Plus,2021-02-01,1.00801543033076
Plus,2020-11-01,0.9891979294522179
Intimates,2022-05-01,0.8836554468236154
Accessories,2024-06-01,1.4894868860025394
Accessories,2023-03-01,1.5151047475632675
Accessories,2022-10-01,1.4522294353112992
Plus,2022-03-01,0.9768593578560409
Plus,2023-09-01,0.9862092831957874
Plus,2023-06-01,0.966959034774762
Maternity,2023-12-01,1.2822338561990836
Accessories,2021-11-01,1.5184424259195686
Accessories,2023-11-01,1.5079180248879003
Plus,2024-04-01,0.9552436303685543
Accessories,2023-06-01,1.4812643997087385
Plus,2024-03-01,0.9971316856323044
Plus,2022-11-01,1.0051962349609587
Socks & Hosiery,2023-11-01,1.505026954877638
Sleep & Lounge,2021-02-01,1.1715366050181473
Socks,2023-12-01,0.6659601649868302
Intimates,2024-02-01,0.8966464110033201
Maternity,2021-09-01,1.308088902902513
Intimates,2023-11-01,0.8901219326211074
Intimates,2023-04-01,0.8736931457993321
Intimates,2024-09-01,0.8860880153506876
Tops & Tees,2020-04-01,0.8076821748114459
Accessories,2023-05-01,1.4728723526533873
Intimates,2019-07-01,0.9224525892323454
Plus,2024-08-01,0.9988031377077271
Plus,2021-07-01,1.0166338712611518
Socks,2019-07-01,0.6472176339605294
Socks & Hosiery,2021-10-01,1.493955366202276
Socks,2021-06-01,0.6445038440831141
Plus,2022-08-01,0.9806231155902527
Socks,2023-05-01,0.648489366927219
Plus,2023-04-01,1.0179949544691582
Leggings,2023-10-01,0.6624754168973324
Intimates,2022-11-01,0.8804579255928526
Socks & Hosiery,2023-09-01,1.4861019980233525
Leggings,2024-05-01,0.6556839144489682
Intimates,2020-09-01,0.9227351913927205
Socks & Hosiery,2021-09-01,1.4905363279379802
Plus,2020-03-01,0.9278357569806661
Underwear,2023-02-01,1.1133982717994735
Intimates,2020-11-01,0.8680643916156647
Tops & Tees,2024-02-01,0.7813105952989445
Leggings,2021-12-01,0.6492398717744716
Accessories,2023-08-01,1.4987216861439514
Plus,2023-01-01,0.9669474966851618
Accessories,2021-10-01,1.5283519590132342
Plus,2022-05-01,1.0127184621772025
Socks & Hosiery,2022-11-01,1.5308951084626843
Socks,2023-09-01,0.6513979701047347
Intimates,2023-05-01,0.8757603173295189
Accessories,2022-07-01,1.5018027368436773
Maternity,2023-04-01,1.2970018029282027
Accessories,2022-09-01,1.4943385494915298
Accessories,2021-07-01,1.5098259636324285
Socks & Hosiery,2024-02-01,1.504625930463064
Plus,2024-09-01,1.0253942319819682
Sleep & Lounge,2024-10-01,1.0914881165586474
Intimates,2024-06-01,0.874177211794708
Sleep & Lounge,2024-01-01,1.0379126220743404
Active,2021-09-01,1.3928511117470446
Accessories,2020-04-01,1.439062136376607
Accessories,2022-03-01,1.5030680656669522
Intimates,2024-01-01,0.8861465974832557
Intimates,2021-08-01,0.8789851565726475
Tops & Tees,2020-08-01,0.8080967752871954
Socks & Hosiery,2022-12-01,1.5139916383673273
Socks & Hosiery,2023-02-01,1.4763382613912888
Plus,2024-07-01,0.9940437945333274
Accessories,2020-06-01,1.536544547155537
Socks,2021-10-01,0.6661233382927225
Intimates,2023-08-01,0.8767937201128041
Socks & Hosiery,2022-07-01,1.4735126951887036
Socks & Hosiery,2022-02-01,1.5179735993407797
Intimates,2020-03-01,0.8646948813570826
Socks & Hosiery,2024-09-01,1.4677659901719042
Socks,2024-05-01,0.6568912517671612
Socks,2021-09-01,0.6481518305030666
Socks,2020-12-01,0.6712627595846345
Socks,2023-03-01,0.6459267683069988
Query:
SELECT
  oi."order_id",
  oi."product_id",
  oi."sale_price",
  p."cost",
  TO_TIMESTAMP(oi."delivered_at" / 1000000) AS "delivered_at"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
ON
  oi."product_id" = p."id"
LIMIT 100
Answer:
Too long, hard cut:
order_id,product_id,sale_price,cost,delivered_at
14805,14235,0.0199999995529651,0.0082999997779726,
71201,14235,0.0199999995529651,0.0082999997779726,2024-10-22 03:26:00.000000
81114,14235,0.0199999995529651,0.0082999997779726,2022-08-23 02:49:00.000000
109826,14235,0.0199999995529651,0.0082999997779726,2024-01-28 16:59:00.000000
49859,14235,0.0199999995529651,0.0082999997779726,2023-04-24 12:38:00.000000
6684,14235,0.0199999995529651,0.0082999997779726,
82012,14159,0.4900000095367431,0.1773800033208727,
28060,14159,0.4900000095367431,0.1773800033208727,
63169,14159,0.4900000095367431,0.1773800033208727,
12239,14159,0.4900000095367431,0.1773800033208727,
50479,14159,0.4900000095367431,0.1773800033208727,
73832,14159,0.4900000095367431,0.1773800033208727,
108606,14159,0.4900000095367431,0.1773800033208727,
114916,14159,0.4900000095367431,0.1773800033208727,
35245,14202,1.5,0.617999997921288,
42210,14202,1.5,0.617999997921288,2021-12-30 03:13:00.000000
5718,14202,1.5,0.617999997921288,
6074,14202,1.5,0.617999997921288,
25844,14202,1.5,0.617999997921288,
33209,14202,1.5,0.617999997921288,
57511,28700,1.5,0.6059999980498105,
108498,28700,1.5,0.6059999980498105,
5338,28700,1.5,0.6059999980498105,2020-03-16 16:13:00.000000
33098,14202,1.5,0.617999997921288,2024-03-31 18:20:00.000000
76384,28700,1.5,0.6059999980498105,2023-08-12 19:28:00.000000
101325,14202,1.5,0.617999997921288,2022-10-09 22:20:00.000000
7232,14202,1.5,0.617999997921288,
46807,14202,1.5,0.617999997921288,
120416,28700,1.5,0.6059999980498105,
61834,13629,1.5099999904632568,0.6447699947352707,
79332,13629,1.5099999904632568,0.6447699947352707,
14956,13629,1.5099999904632568,0.6447699947352707,2024-07-26 03:58:00.000000
3229,13629,1.5099999904632568,0.6447699947352707,
69780,13629,1.5099999904632568,0.6447699947352707,
103440,13629,1.5099999904632568,0.6447699947352707,
100896,13629,1.5099999904632568,0.6447699947352707,2024-07-01 06:11:00.000000
18515,13629,1.5099999904632568,0.6447699947352707,
18022,14298,1.7200000286102295,0.6450000075250863,
63483,14298,1.7200000286102295,0.6450000075250863,
90395,12536,1.75,1.0132499965839088,2021-02-20 23:07:00.000000
105059,12536,1.75,1.0132499965839088,2024-03-10 17:41:00.000000
122880,12536,1.75,1.0132499965839088,2021-07-08 13:30:00.000000
106189,12536,1.75,1.0132499965839088,
21501,15332,1.8200000524520876,0.8918000261083245,
35298,15332,1.8200000524520876,0.8918000261083245,
111104,15332,1.8200000524520876,0.8918000261083245,
7274,15332,1.8200000524520876,0.8918000261083245,2022-09-03 03:22:00.000000
11963,15332,1.8200000524520876,0.8918000261083245,2024-10-09 20:49:00.000000
12507,15332,1.8200000524520876,0.8918000261083245,2020-08-26 19:03:00.000000
83546,15332,1.8200000524520876,0.8918000261083245,2023-05-12 08:34:00.000000
33669,13659,1.8200000524520876,0.7498400190880893,
34236,13659,1.8200000524520876,0.7498400190880893,
105655,15332,1.8200000524520876,0.8918000261083245,
111185,15332,1.8200000524520876,0.8918000261083245,
112616,15332,1.8200000524520876,0.8918000261083245,
54378,15332,1.8200000524520876,0.8918000261083245,2023-11-12 18:44:00.000000
6059,15332,1.8200000524520876,0.8918000261083245,
28271,13659,1.8200000524520876,0.7498400190880893,
34370,13659,1.8200000524520876,0.7498400190880893,
55186,15332,1.8200000524520876,0.8918000261083245,
62067,13659,1.8200000524520876,0.7498400190880893,
88741,15332,1.8200000524520876,0.8918000261083245,
11966,9204,1.950000047683716,0.7722000156065448,
72980,3049,1.950000047683716,0.9165000273510814,
21690,3049,1.950000047683716,0.9165000273510814,2024-10-21 02:46:50.988061
80738,3049,1.950000047683716,0.9165000273510814,2023-04-29 05:53:00.000000
119820,3049,1.950000047683716,0.9165000273510814,2024-10-23 05:51:58.791730
29862,3049,1.950000047683716,0.9165000273510814,
115326,9204,1.950000047683716,0.7722000156065448,
121983,3049,1.950000047683716,0.9165000273510814,
20438,3049,1.950000047683716,0.9165000273510814,
32712,14549,1.9800000190734863,0.7840800106805563,2021-09-10 03:09:00.000000
100600,14549,1.9800000190734863,0.7840800106805563,2023-06-11 16:50:00.000000
73565,14549,1.9800000190734863,0.7840800106805563,
18204,14549,1.9800000190734863,0.7840800106805563,
26774,14549,1.9800000190734863,0.7840800106805563,
70016,14549,1.9800000190734863,0.7840800106805563,
72412,14549,1.9800000190734863,0.7840800106805563,
80353,14549,1.9800000190734863,0.7840800106805563,
34337,13606,2.5,1.1074999999254942,
119193,13606,2.5,1.1074999999254942,
70001,13606,2.5,1.1074999999254942,2020-04-10 05:16:00.000000
33789,13606,2.5,1.1074999999254942,
9452,13606,2.5,1.1074999999254942,
74155,13606,2.5,1.1074999999254942,
78943,13606,2.5,1.1074999999254942,
82140,13606,2.5,1.1074999999254942,
115070,13606,2.5,1.1074999999254942,
29512,28913,2.5899999141693115,1.0722599617259203,
65881,28913,2.5899999141693115,1.0722599617259203,
20397,28913,2.5899999141693115,1.0722599617259203,2024-02-25 09:54:00.000000
9775,28913,2.5899999141693115,1.0722599617259203,
11503,28913,2.58
Query:
SELECT
  DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at" / 1000000)) AS "month",
  SUM(oi."sale_price") AS "monthly_revenue"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
ON
  oi."product_id" = p."id"
WHERE
  p."category" = 'Accessories'
GROUP BY
  "month"
ORDER BY
  "month"
LIMIT 100
Answer:
month,monthly_revenue
2019-02-01,42.90000057220459
2019-03-01,82.38000011444092
2019-04-01,83.95000076293945
2019-05-01,169.3200032711029
2019-06-01,565.9999980926514
2019-07-01,406.540002822876
2019-08-01,743.5099983215332
2019-09-01,656.3500077724457
2019-10-01,1159.1799988746643
2019-11-01,886.7700064182281
2019-12-01,1176.7000085115433
2020-01-01,1119.3299977779388
2020-02-01,1289.6300203800201
2020-03-01,964.4700031280518
2020-04-01,1729.2199885845184
2020-05-01,1867.4900104999542
2020-06-01,1479.0300011634827
2020-07-01,1542.5799911022186
2020-08-01,2448.600004673004
2020-09-01,1615.5200028419495
2020-10-01,2797.199989080429
2020-11-01,2999.7800030708313
2020-12-01,2729.9200110435486
2021-01-01,2821.3199968338013
2021-02-01,2431.5799856185913
2021-03-01,2947.699996829033
2021-04-01,3343.589996099472
2021-05-01,3058.2200179100037
2021-06-01,2817.8800036907196
2021-07-01,4384.099987030029
2021-08-01,3434.4700107574463
2021-09-01,4094.4499912261963
2021-10-01,4042.259989976883
2021-11-01,3377.2099800109863
2021-12-01,2882.1999986171722
2022-01-01,5339.400004148483
2022-02-01,4232.74000620842
2022-03-01,4839.059978961945
2022-04-01,4599.249974727631
2022-05-01,4868.160014152527
2022-06-01,6321.680026292801
2022-07-01,5228.419990181923
2022-08-01,5187.689974583685
2022-09-01,5524.569988250732
2022-10-01,5736.299985408783
2022-11-01,6877.370015382767
2022-12-01,6659.860012054443
2023-01-01,7938.559997797012
2023-02-01,6390.309992074966
2023-03-01,8462.279976844788
2023-04-01,8418.410002727062
2023-05-01,8645.320052862167
2023-06-01,7469.79000210762
2023-07-01,10159.879982233047
2023-08-01,9329.280014038086
2023-09-01,8519.270018815994
2023-10-01,9776.35997390747
2023-11-01,12254.210008382797
2023-12-01,12208.480020523071
2024-01-01,11857.03000094369
2024-02-01,11368.429980516434
2024-03-01,13032.650015354156
2024-04-01,14470.700029850006
2024-05-01,15192.440013170242
2024-06-01,16308.209975838661
2024-07-01,19732.370028395206
2024-08-01,22264.76996922493
2024-09-01,27165.109978199005
2024-10-01,32367.59996630624
Query:
SELECT
  "id",
  "category",
  "name",
  "cost",
  "retail_price"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS"
LIMIT 100
Answer:
Too long, hard cut:
id,category,name,cost,retail_price
13842,Accessories,Low Profile Dyed Cotton Twill Cap - Navy W39S55D,2.518749990849756,6.25
13928,Accessories,Low Profile Dyed Cotton Twill Cap - Putty W39S55D,2.3383499148894105,5.949999809265137
14115,Accessories,Enzyme Regular Solid Army Caps-Black W35S45D,4.879559879379869,10.989999771118164
14157,Accessories,Enzyme Regular Solid Army Caps-Olive W35S45D (One Size),4.648769887297898,10.989999771118164
14273,Accessories,Washed Canvas Ivy Cap - Black W11S64C,6.507929886473045,15.989999771118164
15674,Plus,Low Profile Dyed Cotton Twill Cap - Navy W39S55D,3.1062499998370185,6.25
15816,Plus,Low Profile Dyed Cotton Twill Cap - Putty W39S55D,3.1772999091416594,5.949999809265137
28646,Accessories,4 Panel Large Bill Flap Hat W15S48B (One Size Fits Most/Khaki),8.73562987972319,19.989999771118164
28670,Accessories,Low Profile Dyed Cotton Twill Cap - Black W39S55D,2.6759399153566363,6.179999828338623
28714,Accessories,Low Profile Dyed Cotton Twill Cap - Khaki W39S55D,2.275000000372529,6.25
28779,Accessories,Fishing Hat (01)-Khaki W10S32F,7.36748991528362,20.989999771118164
28904,Accessories,Fashion Plaid Ivy Cap - Blue W10S69F,6.7957498848550015,15.989999771118164
29007,Accessories,Washed Hunting Fishing Outdoor Hat-Camo W11S41D,10.795999868229032,26.989999771118164
12777,Swim,Womens MW Tankini Boyshorts Swimsuit Swimwear Crisscross Back Multiple Prints S-xxl,16.691290760814255,44.9900016784668
12810,Swim,Mw Long Ruffle Tankini Bikini Swimsuit Bra Straps Multiple Prints,21.055320884742144,44.9900016784668
12812,Swim,Womens long tankini bikini swimsuit Marina West 2 piece multiple prints bra straps,21.14530090284795,44.9900016784668
12853,Swim,Womens MW Tankini Boyshorts Swimsuit Swimwear Fashion prints S-XXL,18.71584077014294,44.9900016784668
12900,Swim,Womens One Piece/bikini Monokini Swimsuit w/ Fringe MW Multiple Prints and Solids,17.39565078823306,39.9900016784668
13247,Swim,Womens swimsuit MW Swimwear Set Halter w/ Boyshorts 2 piece bikini multiple prints,20.65041088706643,44.9900016784668
13477,Swim,MW Women's Swimsuit Two Piece Black Tankini with Bikini Bottoms,22.600890809484422,54.9900016784668
13574,Swim,Womens MW Two Piece Tankini Boyshorts Swimsuit Brown & Turquoise Ethnic Print,19.39069080118597,44.9900016784668
2848,Active,2XU Women's Compression Recovery Sock,20.946700439925493,44.950000762939446
3039,Active,2XU Women's Compression Race Sock,22.627350425997378,49.950000762939446
9041,Socks & Hosiery,2XU Women's Compression Race Sock,20.479500227209176,49.950000762939446
13122,Swim,2XU Women's Swimmers Compression Long Sleeve Top,68.73737201425911,150.41000366210938
18147,Active,2XU Non-Stirrup Compression Calf Guard,17.069900398133232,40.450000762939446
18363,Active,2XU Men's Compression Recovery Tights,65.0955812367481,159.94000244140625
18394,Active,2XU Men's Compression Race Sock,22.97700039561093,49.950000762939446
18465,Active,2XU Men's Elite Compression Performance Sock,27.240000218153,60.0
18593,Active,2XU Men's Compression Recovery Sock,17.00110065520704,43.150001525878906
18607,Active,2XU Men's Compression 3/4 Tights,30.63616928671479,79.98999786376953
18644,Active,2XU Men's Elite Compression Long Sleeve Top,41.28767906982421,107.5199966430664
18664,Active,2XU Recovery Compression Leg Sleeves,25.83845043245256,59.950000762939446
18708,Active,2XU Men's Thermal Compression Long Sleeve Top,42.59726061337233,111.22000122070312
18796,Active,2XU Men's Compression Long Sleeve Top,36.31391910439163,84.05999755859375
24644,Socks,2XU Men's Compression Race Sock,27.872100528435407,49.950000762939446
24674,Socks,2XU Men's Elite Compression Performance Sock,35.64000008627772,60.0
24731,Socks,2XU Men's Compression Recovery Sock,25.58795095982142,43.150001525878906
27569,Swim,2XU Men's Swimmers Compression Long Sleeve Top,92.6525625942932,150.41000366210938
3206,Dresses,AGB Women's Long Sleeve Striped Sweater Dress,38.31499995291233,79.0
3660,Dresses,AGB Women's Short Sleeve Cowl Necked Sweater Dress,21.91964971384816,50.38999938964844
3682,Dresses,AGB Women's Striped Long Sleeve Sweater Dress With Sash,18.956299259465936,45.34999847412109
3730,Dresses,AGB Women's V-Neck Dress With Draped Side,39.070999938994646,89.0
3943,Dresses,AGB Women's Plus-Size Ruched Short Sleeve V-Neck Dress with Empire Waistline,26.28080032457113,53.200000762939446
5353,Pants & Capris,AGB Women's Solid Challis Palazzo Pant With Self Sash,22.46999996714294,42.0
5433,Pants & Capris,BKE Women's Casual Linen Cotton Natural Comfortable Pants,11.640959460911304,20.209999084472656
9035,Socks & Hosiery,HDE Women's Solid Color Premium Microfiber Tights,1.3983000106409191,3.950000047683716
14170,Accessories,HDE Ladies Fashion Leather Skinny Belt with Bow Buckle & Gold Accents,1.1859000150532462,2.950000047683716
28411,Accessories,HDE Solid Color Suspenders - 20 Styles,2.083760045012236,4.880000114440918
28548,Accessories,HDE Classic Bow Tie,1.280300021749735,2.950000047683716
28873,Accessories,HDE Colorful P
Query:
SELECT
  p."category",
  p."name",
  COUNT(oi."product_id") AS "units_sold"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
ON
  oi."product_id" = p."id"
GROUP BY
  p."category",
  p."name"
ORDER BY
  p."category",
  "units_sold" DESC
LIMIT 100
Answer:
Too long, hard cut:
category,name,units_sold
Accessories,Boxed 3 pc. Initial Cotton Handkerchiefs,24
Accessories,Ray-Ban RB4141 Round Wayfarer Sunglasses,23
Accessories,Kenneth Cole REACTION Men's Passcase Wallet,22
Accessories,Von Zipper Elmore Sunglasses,21
Accessories,Tom Ford Marko FT0144 Sunglasses - 18V Shiny Rhodium (Blue Lens) - 58mm,20
Accessories,Ray-Ban 0RB3491 Aviator Sunglasses,18
Accessories,Oakley Men's Dispatch II Square Sunglasses,18
Accessories,Ray Ban RB3479 Folding Aviator Sunglasses - 001 Arista (G-15XLT Lens) - 58mm,18
Accessories,Costa Del Mar - Blackfin - Camo Frame-580 Green Mirror Glass Polarized Lenses,18
Accessories,D1067 Dg Eyewear Semi Rimless Aviator Metal Pilot Sunglasses,18
Accessories,Ray-Ban Women's 4101 Jackie Ohh Sunglasses,17
Accessories,Ray-Ban RB3293 Bubble Wrap Aviator Sunglasses,17
Accessories,TrendsBlue Classic Soft Unisex Solid Color Warm Winter Fringe Scarf - Different Colors Available,17
Accessories,Best PILOT TROOPER Brown Shell AVIATOR Faux Leather Hat USHANKA Trapper Men and Women,17
Accessories,S5 Selected Smooth Small Eyeglass Case,16
Accessories,Tommy Hilfiger  Men's Cambrige Slim Billfold,16
Accessories,US Marines Black Cowhide Leather Trifold Wallet,16
Accessories,LOCS Sunglasses Hardcore Black Dark Lens 0103 Designer Stylish w Bag,16
Accessories,Elegant Solid Color Infinity Loop Jersey Scarf - Different Colors Available,16
Accessories,Eyeglasses Boss Black Boss 0479 0807 Black,16
Accessories,Spy Optic Dirty MO Sunglasses,16
Accessories,Minus33 100% Merino Wool Base Layer 740 Expedition Balaclava Black One Size,16
Accessories,Oakley Men's Flak Jacket XLJ Iridium Sunglasses,16
Accessories,neff Men's Daily Sunglass,16
Accessories,Ray-Ban Wayfarer 601S78 Polarized Wayfarer SunglassesMatte Black52 mm,16
Accessories,Dosh Street Billfold Wallet,16
Accessories,Ray-Ban Aviator Large Metal Sunglasses,15
Accessories,Wool Greek Fishermans Cap,15
Accessories,Ray-Ban Unisex RB4034P Sunglasses,15
Accessories,DOLCE & GABBANA DG4167 501/8G BLACK GRAY GRADIENT 5917,15
Accessories,Ray-Ban RB4075 Sunglasses,15
Accessories,Ray-Ban RB3407 Outdoorsman II Sunglasses,15
Accessories,G&G Black Wayfarer 80's Blues Brothers Sunglasses Super Dark,15
Accessories,Dorfman-Pacific Weathered Cotton Outback Hat With Chin Cord,14
Accessories,JiMarti JM01 Sunglasses for Golf Fishing Cycling-Unbreakable-... Frame,14
Accessories,Croakies Unisex Adult Terra Spec Cord Adjustable Eyewear Retainer,14
Accessories,Ray-Ban Aviator Sunglasses,14
Accessories,Port Authority - Extra Long Fleece Scarf,14
Accessories,Hollywood Solid Pashmina Scarf,14
Accessories,Ray-Ban Meteor Wayfarer Sunglasses,14
Accessories,Unisex Chequered Arab Arafat Shemagh Kafiyah Desert Style Scarf Throw - 17 Gorgeous Colours while stocks last!,14
Accessories,X-Gear Men's Deluxe Camper Tool,14
Accessories,Persol Men's 0PO0714 Square Polarized Sunglasses,14
Accessories,Brixton Men's Hooligan Classic Drivers Cap,14
Accessories,Men's Italian Lambskin Leather Driving Gloves By Fratelli Orsini Everyday,14
Accessories,Mountain Hardwear Men's Micro Dome Beanie,14
Accessories,Carrera Carrera Champion/L/S Black Frame/Grey Gradient Lens 62Mm,14
Accessories,Knit Collegiate Rugby Stripe Winter Scarf & Beanie Hat Set - Assorted Colors,14
Accessories,Mens Piano Keyboard Themed Gift Set: Wallet Music Note Keychain & Socks,13
Accessories,Buxton Deluxe Snap Card Case for Women,13
Accessories,Oakley Men's Straight Jacket Polarized Sunglasses,13
Accessories,Native Eyewear Throttle Sunglasses,13
Accessories,Carrera  Endurls Resin Sunglasses,13
Accessories,Oakley Frogskin Polarized Aviator Sunglasses,13
Accessories,Skechers Men's 5017 Aviator Sunglasses,13
Accessories,DC Men's Big Star Beanie,13
Accessories,Columbia Unisex Baddabing II Headring,13
Accessories,Joseph Abboud Men's Glace Sheepskin Baby Cable Cashmere Lined Glove,13
Accessories,WHOLESALE LOT MENS 10 HANDKERCHIEFS NEW POCKET SQUARES SOLID COLORS FORMAL,13
Accessories,Carrera Topcar 1/S Aviator Sunglasses,13
Accessories,Klondike Sterling Touch Screen Fleece Gloves Mid-weight Winter iPhone iPad Compatible,13
Accessories,Ray-Ban Unisex RB4105 Folding Wayfarer Sunglasses,13
Accessories,Tommy Hilfiger Men's Double Stitched Canvas Belt,13
Accessories,Guide Gear Leather Rabbit Fur Hat,13
Accessories,XS Sport Wrap TR90 Sunglasses UV400 Unbreakable Protection for Cycling Ski or Golf,13
Accessories,Ray Ban RB3447 Unisex Icons Sunglasses - Choice of Frame and Lens,13
Accessories,Ray Ban RB3025 Aviator Sunglasses,13
Accessories,JiMarti JM63 Sport Wrap Sunglasses for Cycling Running Fishing Golf TR90 Frame,13
Accessories,Oakley Pit Bull Sunglasses,13
Accessories,Dakota Dan Winter Trooper Trapper Faux Fur Hat,13
Accessories,Designer Bow Ties for Men & Boys by Tok Tok Designs (Y166),13
Accessories,Lauren Solid Color Stunning Pashmina Scarf/Wrap,13
Accessories,Trendy Plaid & Houndstooth Check Soft Square Scarf - Different Colors Available By TrendsBlue,12
Accessories,Ray Ban Sunglasses RB 3030 Outdoorsman,12
Accessories,New
Query:
SELECT
  DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at" / 1000000)) AS "month",
  SUM(oi."sale_price") AS "total_revenue",
  COUNT(DISTINCT oi."order_id") AS "total_orders"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
GROUP BY
  "month"
ORDER BY
  "month"
LIMIT 100
Answer:
month,total_revenue,total_orders
2019-01-01,591.7399978637695,5
2019-02-01,2913.099986553192,35
2019-03-01,6013.850018501282,65
2019-04-01,7094.610024929047,86
2019-05-01,6236.669998407364,93
2019-06-01,11868.149987220764,144
2019-07-01,13770.510034561157,178
2019-08-01,17094.91003894806,214
2019-09-01,21261.790072202682,254
2019-10-01,22827.220034837723,274
2019-11-01,23955.80003762245,286
2019-12-01,27891.56003987789,311
2020-01-01,29570.650020837784,366
2020-02-01,34505.1600124836,388
2020-03-01,32640.36001443863,430
2020-04-01,36885.88999795914,460
2020-05-01,39519.81000304222,473
2020-06-01,37337.75005745888,482
2020-07-01,45958.470054388046,539
2020-08-01,51906.95005142689,606
2020-09-01,48473.65003871918,616
2020-10-01,60201.36998152733,714
2020-11-01,60494.74007964134,737
2020-12-01,67115.4000544548,783
2021-01-01,70824.7600274086,803
2021-02-01,58615.380001068115,698
2021-03-01,75475.599989295,875
2021-04-01,76103.03003525734,867
2021-05-01,82666.82004833221,1003
2021-06-01,83248.12016427517,991
2021-07-01,89529.30012202263,1071
2021-08-01,89756.39010858536,1081
2021-09-01,93203.14015293121,1119
2021-10-01,104375.2200512886,1272
2021-11-01,101976.05008339882,1196
2021-12-01,106648.60001420975,1235
2022-01-01,107931.32024502754,1331
2022-02-01,108077.87010645866,1252
2022-03-01,125060.57000148296,1442
2022-04-01,126106.69009137154,1470
2022-05-01,127573.71005558968,1524
2022-06-01,136939.9502775669,1627
2022-07-01,159377.45011866093,1729
2022-08-01,153951.18012265116,1818
2022-09-01,144993.0900771618,1731
2022-10-01,162629.28028202057,2021
2022-11-01,165796.6401696205,1911
2022-12-01,172347.13002562523,2035
2023-01-01,185897.37019395828,2126
2023-02-01,188464.45002174377,2108
2023-03-01,197816.85012841225,2269
2023-04-01,185431.78010799363,2341
2023-05-01,219914.69043135643,2536
2023-06-01,213704.57002985477,2518
2023-07-01,227827.2801876068,2727
2023-08-01,242320.87019777298,2869
2023-09-01,238959.30027377605,2862
2023-10-01,259164.92024493217,3183
2023-11-01,284499.3900786638,3348
2023-12-01,310206.8604063988,3542
2024-01-01,311697.49025132135,3614
2024-02-01,307729.7304265499,3714
2024-03-01,348587.2702960968,4153
2024-04-01,361021.6802973747,4289
2024-05-01,399783.7303934097,4775
2024-06-01,398330.65041172504,4944
2024-07-01,476711.50058927014,5654
2024-08-01,548317.610450983,6474
2024-09-01,616196.4706864357,7359
2024-10-01,786516.1608133502,9107
Query:
SELECT
  "status",
  COUNT(*) AS "status_count"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDERS"
GROUP BY
  "status"
LIMIT 100
Answer:
status,status_count
Cancelled,18554
Complete,31193
Processing,25119
Shipped,37538
Returned,12443
Query:
SELECT
  p."category",
  AVG(oi."sale_price") AS "average_sale_price"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
JOIN
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
ON
  oi."product_id" = p."id"
GROUP BY
  p."category"
LIMIT 100
Answer:
category,average_sale_price
Socks,20.299785083527553
Active,49.71962393214743
Maternity,51.90535684411696
Swim,57.18632826152689
Skirts,50.870521194940764
Outerwear & Coats,145.25342180796224
Clothing Sets,92.74435655197294
Accessories,43.229780272777205
Intimates,33.32644906870921
Socks & Hosiery,16.765867551210764
Sleep & Lounge,49.21708581268445
Tops & Tees,41.579498303597504
Leggings,27.279730370799577
Shorts,46.110458505719286
Sweaters,75.17778851422908
Underwear,27.134509654238798
Blazers & Jackets,91.61495353493824
Pants & Capris,53.83667080511382
Dresses,84.29710801082858
Jumpsuits & Rompers,47.03835599809079
Fashion Hoodies & Sweatshirts,54.835008855374426
Pants,59.8149358692474
Suits & Sport Coats,124.52451488062047
Suits,116.64817035716513
Plus,36.28723975198169
Jeans,98.7687617963342
Query:
SELECT
  "created_at",
  DATE_TRUNC('month', TO_TIMESTAMP("created_at" / 1000000)) AS "month",
  DATE_TRUNC('year', TO_TIMESTAMP("created_at" / 1000000)) AS "year"
FROM
  THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS"
LIMIT 100
Answer:
created_at,month,year
1720493802000000,2024-07-01,2024-01-01
1729178375000000,2024-10-01,2024-01-01
1661055328000000,2022-08-01,2022-01-01
1705966661000000,2024-01-01,2024-01-01
1682314135000000,2023-04-01,2023-01-01
1660568548000000,2022-08-01,2022-01-01
1728974694000000,2024-10-01,2024-01-01
1578751742000000,2020-01-01,2020-01-01
1724075554000000,2024-08-01,2024-01-01
1707744445000000,2024-02-01,2024-01-01
1589599622000000,2020-05-01,2020-01-01
1719644204000000,2024-06-01,2024-01-01
1676676572000000,2023-02-01,2023-01-01
1677412017000000,2023-02-01,2023-01-01
1644903349000000,2022-02-01,2022-01-01
1640474769000000,2021-12-01,2021-01-01
1712764905000000,2024-04-01,2024-01-01
1729229967961963,2024-10-01,2024-01-01
1728007329000000,2024-10-01,2024-01-01
1706150578000000,2024-01-01,2024-01-01
1678868815000000,2023-03-01,2023-01-01
1725160469000000,2024-09-01,2024-01-01
1584054833000000,2020-03-01,2020-01-01
1711463348000000,2024-03-01,2024-01-01
1691764084000000,2023-08-01,2023-01-01
1664945844000000,2022-10-01,2022-01-01
1714261237000000,2024-04-01,2024-01-01
1697644910000000,2023-10-01,2023-01-01
1713164402000000,2024-04-01,2024-01-01
1713939170000000,2024-04-01,2024-01-01
1630040509000000,2021-08-01,2021-01-01
1721827103000000,2024-07-01,2024-01-01
1723866706000000,2024-08-01,2024-01-01
1711160959000000,2024-03-01,2024-01-01
1673535930000000,2023-01-01,2023-01-01
1720008585000000,2024-07-01,2024-01-01
1727331685000000,2024-09-01,2024-01-01
1711365932000000,2024-03-01,2024-01-01
1681125614000000,2023-04-01,2023-01-01
1613663024000000,2021-02-01,2021-01-01
1709804342000000,2024-03-01,2024-01-01
1625784303000000,2021-07-01,2021-01-01
1721440493000000,2024-07-01,2024-01-01
1684964345000000,2023-05-01,2023-01-01
1663712939000000,2022-09-01,2022-01-01
1728651619000000,2024-10-01,2024-01-01
1662168770000000,2022-09-01,2022-01-01
1728711702000000,2024-10-01,2024-01-01
1598071602000000,2020-08-01,2020-01-01
1683435417000000,2023-05-01,2023-01-01
1616121803000000,2021-03-01,2021-01-01
1721729098000000,2024-07-01,2024-01-01
1646128179000000,2022-03-01,2022-01-01
1624148896000000,2021-06-01,2021-01-01
1694142554000000,2023-09-01,2023-01-01
1699606015000000,2023-11-01,2023-01-01
1728595477000000,2024-10-01,2024-01-01
1577363357000000,2019-12-01,2019-01-01
1659157484000000,2022-07-01,2022-01-01
1688102275000000,2023-06-01,2023-01-01
1718984008000000,2024-06-01,2024-01-01
1728792686000000,2024-10-01,2024-01-01
1661412281000000,2022-08-01,2022-01-01
1709760112000000,2024-03-01,2024-01-01
1729132031988061,2024-10-01,2024-01-01
1682148158000000,2023-04-01,2023-01-01
1729667408791730,2024-10-01,2024-01-01
1716998581000000,2024-05-01,2024-01-01
1689600724000000,2023-07-01,2023-01-01
1631714690000000,2021-09-01,2021-01-01
1727670101000000,2024-09-01,2024-01-01
1630893640000000,2021-09-01,2021-01-01
1686134163000000,2023-06-01,2023-01-01
1713246214000000,2024-04-01,2024-01-01
1680349493000000,2023-04-01,2023-01-01
1681866831000000,2023-04-01,2023-01-01
1724850147000000,2024-08-01,2024-01-01
1703229622000000,2023-12-01,2023-01-01
1696682971000000,2023-10-01,2023-01-01
1636621532000000,2021-11-01,2021-01-01
1712238862000000,2024-04-01,2024-01-01
1586076861000000,2020-04-01,2020-01-01
1694514076000000,2023-09-01,2023-01-01
1694296944000000,2023-09-01,2023-01-01
1729315495590414,2024-10-01,2024-01-01
1707811221000000,2024-02-01,2024-01-01
1659508800000000,2022-08-01,2022-01-01
1648442250000000,2022-03-01,2022-01-01
1707641550000000,2024-02-01,2024-01-01
1706666847000000,2024-01-01,2024-01-01
1708747362000000,2024-02-01,2024-01-01
1699314104000000,2023-11-01,2023-01-01
1655114618000000,2022-06-01,2022-01-01
1722239693000000,2024-07-01,2024-01-01
1643305037000000,2022-01-01,2022-01-01
1694957157000000,2023-09-01,2023-01-01
1663827894000000,2022-09-01,2022-01-01
1651299410000000,2022-04-01,2022-01-01
1717261432000000,2024-06-01,2024-01-01
1727528534000000,2024-09-01,2024-01-01
End Exploring Related Columns
Task: Generate a monthly report for each product category detailing the month-over-month percentage growth in revenue and orders, along with the monthly total cost, profit, and profit-to-cost ratio for orders that were completed and delivered before 2022

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Product_Category,Month,Revenue_Growth(%),Orders_Growth(%),Total_Cost,Profit,Profit_to_Cost_Ratio
category1:str,month1:str,revenue_growth1:float,orders_growth1:float,total_cost1:float,profit1:float,ratio1:float
category1:str,month2:str,revenue_growth2:float,orders_growth2:float,total_cost2:float,profit2:float,ratio2:float
...
```

In this report, each row represents a product category for a specific month, detailing the month-over-month percentage growth in revenue and orders, along with the monthly total cost, profit, and profit-to-cost ratio for orders that were completed and delivered before 2022..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'THELOOK_ECOMMERCE': {'THELOOK_ECOMMERCE': ['DISTRIBUTION_CENTERS', 'EVENTS', 'INVENTORY_ITEMS', 'ORDERS', 'ORDER_ITEMS', 'PRODUCTS', 'USERS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-26 08:20:18 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 08:20:18 - root - INFO - ```sql
WITH base_data AS (
    SELECT
        p."category",
        DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at" / 1000000)) AS "month",
        oi."sale_price",
        p."cost",
        oi."order_id",
        oi."product_id"
    FROM
        THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
    JOIN
        THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
        ON oi."product_id" = p."id"
    WHERE
        oi."status" = 'Complete'
        AND TO_TIMESTAMP(oi."delivered_at" / 1000000) < '2022-01-01'
        AND oi."delivered_at" IS NOT NULL
),
monthly_data AS (
    SELECT
        "category",
        "month",
        SUM(oi."sale_price") AS total_revenue,
        COUNT(DISTINCT oi."order_id") AS total_orders,
        SUM(p."cost") AS total_cost,
        SUM(oi."sale_price" - p."cost") AS profit,
        CASE WHEN SUM(p."cost") <> 0 THEN SUM(oi."sale_price" - p."cost") / SUM(p."cost") ELSE NULL END AS profit_to_cost_ratio
    FROM
        base_data
    GROUP BY
        "category",
        "month"
),
final_data AS (
    SELECT
        "category",
        "month",
        total_revenue,
        total_orders,
        total_cost,
        profit,
        profit_to_cost_ratio,
        LAG(total_revenue) OVER (PARTITION BY "category" ORDER BY "month") AS previous_revenue,
        LAG(total_orders) OVER (PARTITION BY "category" ORDER BY "month") AS previous_orders
    FROM
        monthly_data
)
SELECT
    "category" AS Product_Category,
    TO_CHAR("month", 'YYYY-MM') AS "Month",
    ROUND(((total_revenue - previous_revenue) / NULLIF(previous_revenue, 0)) * 100, 4) AS "Revenue_Growth(%)",
    ROUND(((total_orders - previous_orders) / NULLIF(previous_orders, 0)) * 100, 4) AS "Orders_Growth(%)",
    ROUND(total_cost, 4) AS Total_Cost,
    ROUND(profit, 4) AS Profit,
    ROUND(profit_to_cost_ratio, 4) AS Profit_to_Cost_Ratio
FROM
    final_data
ORDER BY
    "category",
    "month";
```
2025-01-26 08:20:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:20:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:20:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:20:19 - snowflake.connector.connection - INFO - closed
2025-01-26 08:20:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:20:20 - root - INFO - itercount: 1
2025-01-26 08:20:20 - root - INFO - 000904 (42000): 01b9f734-0004-7d15-0001-11c300fabc4e: SQL compilation error: error line 23 at position 12
invalid identifier 'OI."sale_price"'
2025-01-26 08:20:20 - root - INFO - Input sql:
WITH base_data AS (
    SELECT
        p."category",
        DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at" / 1000000)) AS "month",
        oi."sale_price",
        p."cost",
        oi."order_id",
        oi."product_id"
    FROM
        THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
    JOIN
        THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
        ON oi."product_id" = p."id"
    WHERE
        oi."status" = 'Complete'
        AND TO_TIMESTAMP(oi."delivered_at" / 1000000) < '2022-01-01'
        AND oi."delivered_at" IS NOT NULL
),
monthly_data AS (
    SELECT
        "category",
        "month",
        SUM(oi."sale_price") AS total_revenue,
        COUNT(DISTINCT oi."order_id") AS total_orders,
        SUM(p."cost") AS total_cost,
        SUM(oi."sale_price" - p."cost") AS profit,
        CASE WHEN SUM(p."cost") <> 0 THEN SUM(oi."sale_price" - p."cost") / SUM(p."cost") ELSE NULL END AS profit_to_cost_ratio
    FROM
        base_data
    GROUP BY
        "category",
        "month"
),
final_data AS (
    SELECT
        "category",
        "month",
        total_revenue,
        total_orders,
        total_cost,
        profit,
        profit_to_cost_ratio,
        LAG(total_revenue) OVER (PARTITION BY "category" ORDER BY "month") AS previous_revenue,
        LAG(total_orders) OVER (PARTITION BY "category" ORDER BY "month") AS previous_orders
    FROM
        monthly_data
)
SELECT
    "category" AS Product_Category,
    TO_CHAR("month", 'YYYY-MM') AS "Month",
    ROUND(((total_revenue - previous_revenue) / NULLIF(previous_revenue, 0)) * 100, 4) AS "Revenue_Growth(%)",
    ROUND(((total_orders - previous_orders) / NULLIF(previous_orders, 0)) * 100, 4) AS "Orders_Growth(%)",
    ROUND(total_cost, 4) AS Total_Cost,
    ROUND(profit, 4) AS Profit,
    ROUND(profit_to_cost_ratio, 4) AS Profit_to_Cost_Ratio
FROM
    final_data
ORDER BY
    "category",
    "month";
The error information is:
000904 (42000): 01b9f734-0004-7d15-0001-11c300fabc4e: SQL compilation error: error line 23 at position 12
invalid identifier 'OI."sale_price"'
Please correct it and output only 1 complete SQL query.
2025-01-26 08:20:48 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 08:20:48 - root - INFO - ```sql
WITH base_data AS (
    SELECT
        p."category",
        DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at" / 1000000)) AS "month",
        oi."sale_price",
        p."cost",
        oi."order_id",
        oi."product_id"
    FROM
        THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
    JOIN
        THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
        ON oi."product_id" = p."id"
    WHERE
        oi."status" = 'Complete'
        AND TO_TIMESTAMP(oi."delivered_at" / 1000000) < '2022-01-01'
        AND oi."delivered_at" IS NOT NULL
),
monthly_data AS (
    SELECT
        "category",
        "month",
        SUM("sale_price") AS total_revenue,
        COUNT(DISTINCT "order_id") AS total_orders,
        SUM("cost") AS total_cost,
        SUM("sale_price" - "cost") AS profit,
        CASE WHEN SUM("cost") <> 0 THEN SUM("sale_price" - "cost") / SUM("cost") ELSE NULL END AS profit_to_cost_ratio
    FROM
        base_data
    GROUP BY
        "category",
        "month"
),
final_data AS (
    SELECT
        "category",
        "month",
        total_revenue,
        total_orders,
        total_cost,
        profit,
        profit_to_cost_ratio,
        LAG(total_revenue) OVER (PARTITION BY "category" ORDER BY "month") AS previous_revenue,
        LAG(total_orders) OVER (PARTITION BY "category" ORDER BY "month") AS previous_orders
    FROM
        monthly_data
)
SELECT
    "category" AS Product_Category,
    TO_CHAR("month", 'YYYY-MM') AS "Month",
    ROUND(((total_revenue - previous_revenue) / NULLIF(previous_revenue, 0)) * 100, 4) AS "Revenue_Growth(%)",
    ROUND(((total_orders - previous_orders) / NULLIF(previous_orders, 0)) * 100, 4) AS "Orders_Growth(%)",
    ROUND(total_cost, 4) AS Total_Cost,
    ROUND(profit, 4) AS Profit,
    ROUND(profit_to_cost_ratio, 4) AS Profit_to_Cost_Ratio
FROM
    final_data
ORDER BY
    "category",
    "month";
```
2025-01-26 08:20:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:20:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:20:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:20:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 796
2025-01-26 08:20:50 - snowflake.connector.connection - INFO - closed
2025-01-26 08:20:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:20:50 - root - INFO - itercount: 2
2025-01-26 08:20:50 - root - INFO - 0
2025-01-26 08:20:51 - root - INFO - results: 
PRODUCT_CATEGORY,Month,Revenue_Growth(%),Orders_Growth(%),TOTAL_COST,PROFIT,PROFIT_TO_COST_RATIO
Accessories,2019-02,,,11.8039,15.1461,1.2831
Accessories,2019-04,85.5288,-50.0000,22.5,27.5,1.2222
Accessories,2019-05,183.3,200.0000,54.7881,86.8619,1.5854
Accessories,2019-06,8.0833,33.3333,59.9366,93.1634,1.5544
Accessories,2019-08,143.083,75.0000,142.1037,230.0563,1.6189
Accessories,2019-09,-76.7896,-28.5714,35.4061,50.9739,1.4397
Accessories,2019-10,-56.182,-60.0000,15.1798,22.6703,1.4935
Accessories,2019-11,531.1493,50.0000,104.4865,134.4035,1.2863
Accessories,2019-12,-1.5865,233.3333,91.7858,143.3142,1.5614
Accessories,2020-01,-4.0111,-30.0000,90.1761,135.4939,1.5025
Accessories,2020-02,-45.5001,-71.4286,48.9201,74.0699,1.5141
Accessories,2020-03,138.1982,350.0000,114.9966,177.9634,1.5476
Accessories,2020-04,51.833,11.1111,190.7046,254.1054,1.3325
Accessories,2020-05,1.9244,-10.0000,166.9902,286.3798,1.715
Accessories,2020-06,-37.0845,-11.1111,109.9494,175.2906,1.5943
Accessories,2020-07,42.3117,87.5000,165.4063,240.5237,1.4541
Accessories,2020-08,22.0605,-26.6667,213.5075,281.9726,1.3207
Accessories,2020-09,-5.4129,27.2727,192.5481,276.1119,1.434
Accessories,2020-10,53.2604,28.5714,297.438,420.832,1.4149
Accessories,2020-11,74.9746,5.5556,525.3464,731.4436,1.3923
Accessories,2020-12,-80.7812,-52.6316,91.5548,149.9852,1.6382
Accessories,2021-01,282.9511,122.2222,372.3377,552.6423,1.4843
Accessories,2021-02,-51.493,-40.0000,180.9455,267.7345,1.4796
Accessories,2021-03,33.8816,16.6667,236.4382,364.2618,1.5406
Accessories,2021-04,-9.0611,14.2857,209.1395,337.1305,1.612
Accessories,2021-05,13.8704,-31.2500,248.599,373.441,1.5022
Accessories,2021-06,1.2555,81.8182,242.5018,387.3482,1.5973
Accessories,2021-07,62.8356,0.0000,413.3824,612.2376,1.481
Accessories,2021-08,-13.5333,15.0000,351.1761,535.6439,1.5253
Accessories,2021-09,-20.8768,-34.7826,286.6373,415.0427,1.448
Accessories,2021-10,17.3327,26.6667,340.4941,482.8059,1.418
Accessories,2021-11,-33.52,-10.5263,216.8263,330.5037,1.5243
Accessories,2021-12,71.1837,58.8235,375.1764,561.7636,1.4973
Active,2019-02,,,44.2825,63.6675,1.4378
Active,2019-03,-36.0908,0.0000,26.5691,42.4209,1.5966
Active,2019-04,-56.5154,-50.0000,12.66,17.34,1.3697
Active,2019-05,280.0,100.0000,43.586,70.414,1.6155
Active,2019-06,9.6404,50.0000,50.0408,74.9492,1.4978
Active,2019-07,54.3404,0.0000,77.8638,115.0462,1.4775
Active,2019-08,-41.6153,0.0000,49.3281,63.3019,1.2833
Active,2019-09,82.6068,33.3333,86.0598,119.6102,1.3898
Active,2019-10,-66.9422,-25.0000,29.2177,38.7723,1.327
Active,2019-11,5.8097,-33.3333,30.3046,41.6354,1.3739
Active,2019-12,234.9597,150.0000,97.1063,143.8637,1.4815
Active,2020-01,24.0196,40.0000,122.9775,175.8725,1.4301
Active,2020-02,287.5088,100.0000,448.2454,709.8246,1.5836
Active,2020-03,-83.4267,-64.2857,75.8951,116.0349,1.5289
Active,2020-04,37.498,60.0000,111.8746,152.0254,1.3589
Active,2020-05,-0.2956,-12.5000,115.9111,147.2089,1.27
Active,2020-06,50.6195,14.2857,167.618,228.6921,1.3644
Active,2020-07,12.5962,-25.0000,180.5938,265.6362,1.4709
Active,2020-08,2.6377,100.0000,191.6263,266.3737,1.3901
Active,2020-09,39.8974,16.6667,272.9557,367.7743,1.3474
Active,2020-10,-53.6076,-42.8571,120.5216,176.7283,1.4664
Active,2020-11,32.3061,50.0000,165.6398,227.6402,1.3743
Active,2020-12,77.8122,8.3333,303.3206,395.9794,1.3055
Active,2021-01,-10.7822,15.3846,251.9634,371.9366,1.4762
Active,2021-02,-9.3637,0.0000,233.977,331.503,1.4168
Active,2021-03,362.1543,26.6667,1132.5493,1480.8407,1.3075
Active,2021-04,-69.5786,15.7895,335.1348,459.8952,1.3723
Active,2021-05,-7.562,-18.1818,307.1734,427.7366,1.3925
Active,2021-06,77.189,27.7778,535.2447,766.9353,1.4329
Active,2021-07,-30.9366,-30.4348,362.0828,537.2472,1.4838
Active,2021-08,-60.0925,-37.5000,151.8259,207.0741,1.3639
Active,2021-09,-29.9638,-20.0000,109.7006,141.6594,1.2913
Active,2021-10,277.9838,137.5000,410.8918,539.2082,1.3123
Active,2021-11,-20.6315,5.2632,308.9792,445.1008,1.4406
Active,2021-12,51.3341,30.0000,482.2083,658.9717,1.3666
Blazers & Jackets,2019-06,,,18.1344,35.0456,1.9326
Blazers & Jackets,2019-07,368.2211,0.0000,84.411,164.589,1.9499
Blazers & Jackets,2019-09,-59.8594,100.0000,37.4962,62.4538,1.6656
Blazers & Jackets,2019-10,-76.9385,-50.0000,9.8884,13.1615,1.331
Blazers & Jackets,2019-11,-35.705,0.0000,6.2689,8.5511,1.3641
Blazers & Jackets,2019-12,1065.4521,100.0000,62.7063,110.0137,1.7544
Blazers & Jackets,2020-02,-69.6098,0.0000,21.1007,31.3893,1.4876
Blazers & Jackets,2020-03,234.5209,0.0000,61.5781,114.0119,1.8515
Blazers & Jackets,2020-04,-36.8301,50.0000,43.5621,67.3579,1.5463
Blazers & Jackets,2020-05,92.9679,-33.3333,91.0719,122.9681,1.3502
Blazers & Jackets,2020-06,17.9546,0.0000,90.5104,161.9597,1.7894
Blazers & Jackets,2020-07,-33.5683,100.0000,65.0179,102.7021,1.5796
Blazers & Jackets,2020-08,56.7315,-25.0000,101.2958,161.5742,1.5951
Blazers & Jackets,2020-09,50.0285,33.3333,142.4598,251.9202,1.7684
Blazers & Jackets,2020-10,65.1301,75.0000,241.9684,409.2716,1.6914
Blazers & Jackets,2020-11,-56.6826,-57.1429,114.0272,168.0728,1.474
Blazers & Jackets,2020-12,52.6374,0.0000,151.3935,279.1965,1.8442
Blazers & Jackets,2021-01,26.2965,66.6667,197.6773,346.1427,1.751
Blazers & Jackets,2021-02,-67.2631,-40.0000,63.2106,114.8194,1.8165
Blazers & Jackets,2021-03,169.4209,66.6667,171.7333,307.9167,1.793
Blazers & Jackets,2021-04,-64.6909,-20.0000,63.8525,105.5075,1.6524
Blazers & Jackets,2021-05,128.5309,50.0000,135.8033,251.2367,1.85
Blazers & Jackets,2021-06,184.3789,33.3333,420.6985,679.9615,1.6163
Blazers & Jackets,2021-07,-3.5697,12.5000,405.4678,655.9023,1.6176
Blazers & Jackets,2021-08,-28.0194,-44.4444,313.168,450.812,1.4395
Blazers & Jackets,2021-09,-36.73,80.0000,181.1554,302.2146,1.6683
Blazers & Jackets,2021-10,110.8447,-22.2222,384.2001,634.9599,1.6527
Blazers & Jackets,2021-11,-8.8063,0.0000,356.8534,572.5566,1.6045
Blazers & Jackets,2021-12,6.5977,0.0000,376.3628,614.3672,1.6324
Clothing Sets,2020-10,,,35.7985,19.1915,0.5361
Clothing Sets,2021-01,27.2777,0.0000,41.0841,28.9059,0.7036
Clothing Sets,2021-11,-28.5612,0.0000,32.9,17.1,0.5198
Clothing Sets,2021-12,18.0,0.0000,38.94,20.06,0.5152
Dresses,2019-05,,,30.4963,38.3537,1.2577
Dresses,2019-06,271.7938,0.0000,109.9554,146.0246,1.328
Dresses,2019-07,-84.3933,-50.0000,18.6567,21.2934,1.1413
Dresses,2019-08,0.0,0.0000,17.578,22.372,1.2727
Dresses,2019-09,168.1352,100.0000,47.4812,59.6387,1.256
Dresses,2019-10,191.8036,50.0000,138.1952,174.3848,1.2619
Dresses,2019-11,26.0413,0.0000,159.8482,234.1318,1.4647
Dresses,2019-12,50.3249,0.0000,268.9432,323.3068,1.2021
Dresses,2020-01,-98.1207,-66.6667,4.9974,6.1326,1.2272
Dresses,2020-02,3412.938,300.0000,179.7418,211.2482,1.1753
Dresses,2020-03,-77.759,-25.0000,36.6609,50.2992,1.372
Dresses,2020-04,250.138,33.3333,133.9169,170.5631,1.2736
Dresses,2020-05,97.5302,0.0000,283.2044,318.2356,1.1237
Dresses,2020-06,-49.29,0.0000,138.0005,166.9895,1.2101
Dresses,2020-07,60.5135,75.0000,212.9483,276.6017,1.2989
Dresses,2020-08,25.3355,-14.2857,266.925,346.655,1.2987
Dresses,2020-09,-28.6532,-16.6667,188.6976,249.0724,1.32
Dresses,2020-10,9.9664,120.0000,212.3117,269.0883,1.2674
Dresses,2020-11,-4.651,-36.3636,218.6085,240.4015,1.0997
Dresses,2020-12,17.5574,14.2857,250.3724,289.2276,1.1552
Dresses,2021-01,98.0115,50.0000,460.4427,608.0273,1.3205
Dresses,2021-02,-41.3086,-58.3333,299.7988,327.3012,1.0917
Dresses,2021-03,111.8721,160.0000,609.1539,719.4961,1.1811
Dresses,2021-04,-48.7126,-61.5385,321.6156,359.8144,1.1188
Dresses,2021-05,25.4362,140.0000,389.9619,464.7981,1.1919
Dresses,2021-06,-43.5573,-16.6667,209.2531,273.1969,1.3056
Dresses,2021-07,226.0296,20.0000,729.7207,843.2093,1.1555
Dresses,2021-08,-20.4783,-16.6667,583.1072,667.7129,1.1451
Dresses,2021-09,-9.5857,0.0000,510.9652,619.9548,1.2133
Dresses,2021-10,11.3279,50.0000,551.4583,707.5717,1.2831
Dresses,2021-11,-24.2147,-40.0000,432.3722,521.7878,1.2068
Dresses,2021-12,73.0622,77.7778,742.4716,908.8184,1.224
Fashion Hoodies & Sweatshirts,2019-02,,,230.1069,170.1631,0.7395
Fashion Hoodies & Sweatshirts,2019-04,-77.0405,-50.0000,51.973,39.927,0.7682
Fashion Hoodies & Sweatshirts,2019-06,75.3863,50.0000,88.0405,73.1395,0.8307
Fashion Hoodies & Sweatshirts,2019-07,86.7539,100.0000,156.3401,144.6699,0.9254
Fashion Hoodies & Sweatshirts,2019-08,16.3118,0.0000,183.6343,166.4757,0.9066
Fashion Hoodies & Sweatshirts,2019-09,9.1943,16.6667,203.3563,178.9437,0.88
Fashion Hoodies & Sweatshirts,2019-10,7.502,0.0000,207.9781,203.0019,0.9761
Fashion Hoodies & Sweatshirts,2019-11,44.4547,0.0000,321.8741,271.8059,0.8444
Fashion Hoodies & Sweatshirts,2019-12,-39.5398,0.0000,178.6497,180.2903,1.0092
Fashion Hoodies & Sweatshirts,2020-01,53.3014,71.4286,291.6905,258.5695,0.8865
Fashion Hoodies & Sweatshirts,2020-02,-21.7206,-25.0000,217.9156,212.8244,0.9766
Fashion Hoodies & Sweatshirts,2020-03,30.6635,22.2222,309.3265,253.4935,0.8195
Fashion Hoodies & Sweatshirts,2020-04,18.0289,9.0909,354.7976,309.4924,0.8723
Fashion Hoodies & Sweatshirts,2020-05,12.6902,-16.6667,373.5428,375.0472,1.004
Fashion Hoodies & Sweatshirts,2020-06,-38.145,0.0000,238.2739,224.7661,0.9433
Fashion Hoodies & Sweatshirts,2020-07,42.0396,20.0000,360.9201,296.7799,0.8223
Fashion Hoodies & Sweatshirts,2020-08,41.7865,41.6667,491.3257,441.2043,0.898
Fashion Hoodies & Sweatshirts,2020-09,109.6737,70.5882,1045.9829,909.287,0.8693
Fashion Hoodies & Sweatshirts,2020-10,-52.1718,-27.5862,479.7318,455.4382,0.9494
Fashion Hoodies & Sweatshirts,2020-11,-6.5272,-23.8095,443.9605,430.1695,0.9689
Fashion Hoodies & Sweatshirts,2020-12,54.7493,50.0000,682.4071,670.3029,0.9823
Fashion Hoodies & Sweatshirts,2021-01,-23.3272,-12.5000,531.7322,505.4278,0.9505
Fashion Hoodies & Sweatshirts,2021-02,-28.203,-28.5714,388.4146,356.2354,0.9172
Fashion Hoodies & Sweatshirts,2021-03,-1.0112,0.0000,374.6785,362.4416,0.9673
Fashion Hoodies & Sweatshirts,2021-04,13.1118,13.3333,428.483,405.2869,0.9459
Fashion Hoodies & Sweatshirts,2021-05,-21.0634,-29.4118,343.7689,314.3811,0.9145
Fashion Hoodies & Sweatshirts,2021-06,207.8128,125.0000,1112.2626,913.6074,0.8214
Fashion Hoodies & Sweatshirts,2021-07,-56.8561,-33.3333,438.6691,435.3709,0.9925
Fashion Hoodies & Sweatshirts,2021-08,86.3107,66.6667,838.3041,790.1259,0.9425
Fashion Hoodies & Sweatshirts,2021-09,-28.0952,-30.0000,598.9358,571.9842,0.955
Fashion Hoodies & Sweatshirts,2021-10,39.2136,38.0952,832.5159,797.5641,0.958
Fashion Hoodies & Sweatshirts,2021-11,-33.3763,-27.5862,541.6452,544.3748,1.005
Fashion Hoodies & Sweatshirts,2021-12,20.7703,14.2857,652.6621,658.9279,1.0096
Intimates,2019-03,,,24.696,21.304,0.8626
Intimates,2019-04,-8.6957,-50.0000,21.168,20.832,0.9841
Intimates,2019-05,721.1429,500.0000,187.583,157.297,0.8385
Intimates,2019-06,-69.5575,-33.3333,56.3088,48.6812,0.8645
Intimates,2019-07,131.0601,50.0000,123.0876,119.5024,0.9709
Intimates,2019-08,-29.3541,0.0000,91.5653,79.8148,0.8717
Intimates,2019-09,109.5927,50.0000,187.5739,171.6261,0.915
Intimates,2019-10,-57.9232,-22.2222,80.1665,70.9735,0.8853
Intimates,2019-11,18.9692,14.2857,96.578,83.232,0.8618
Intimates,2019-12,50.4811,-25.0000,144.2301,126.3499,0.876
Intimates,2020-01,-31.6875,33.3333,98.4502,86.3898,0.8775
Intimates,2020-02,109.024,25.0000,206.4151,179.9449,0.8718
Intimates,2020-03,-20.3618,10.0000,165.7833,141.9067,0.856
Intimates,2020-04,94.618,45.4545,323.3337,275.4863,0.852
Intimates,2020-05,-36.2797,-12.5000,202.5491,179.0209,0.8838
Intimates,2020-06,58.621,-14.2857,314.1182,291.1318,0.9268
Intimates,2020-07,32.8162,83.3333,429.8183,374.0517,0.8703
Intimates,2020-08,-30.9851,-31.8182,287.1177,267.6723,0.9323
Intimates,2020-09,-15.249,-6.6667,243.155,227.035,0.9337
Intimates,2020-10,-31.7786,7.1429,172.1709,148.5991,0.8631
Intimates,2020-11,122.5177,20.0000,372.4188,341.3512,0.9166
Intimates,2020-12,14.2413,22.2222,437.3845,378.0355,0.8643
Intimates,2021-01,-14.8856,-13.6364,365.2606,328.7794,0.9001
Intimates,2021-02,-44.1387,-15.7895,205.9859,181.7141,0.8822
Intimates,2021-03,151.4857,43.7500,517.7737,457.2362,0.8831
Intimates,2021-04,-22.4736,-17.3913,402.2994,353.5906,0.8789
Intimates,2021-05,-24.4387,0.0000,300.8228,270.3372,0.8987
Intimates,2021-06,-4.9723,0.0000,297.675,245.085,0.8233
Intimates,2021-07,37.6575,10.5263,394.3257,352.8243,0.8948
Intimates,2021-08,47.5848,38.0952,586.4556,516.2244,0.8802
Intimates,2021-09,1.0674,0.0000,582.1012,532.3488,0.9145
Intimates,2021-10,7.6154,0.0000,634.4137,564.9063,0.8904
Intimates,2021-11,26.0423,10.3448,817.6515,693.9985,0.8488
Intimates,2021-12,-53.9563,-21.8750,368.4847,327.5353,0.8889
Jeans,2019-03,,,23.2342,16.7558,0.7212
Jeans,2019-04,486.3966,100.0000,134.301,100.199,0.7461
Jeans,2019-05,-63.0064,-50.0000,46.2377,40.5123,0.8762
Jeans,2019-06,318.4323,200.0000,195.815,167.175,0.8537
Jeans,2019-07,130.5711,100.0000,444.868,392.082,0.8813
Jeans,2019-08,8.8751,66.6667,481.9274,429.3026,0.8908
Jeans,2019-09,-76.5164,-60.0000,117.7782,96.2118,0.8169
Jeans,2019-10,116.5989,25.0000,237.361,226.139,0.9527
Jeans,2019-11,-3.9784,20.0000,230.8496,214.2104,0.9279
Jeans,2019-12,-15.9776,-33.3333,209.8871,164.0629,0.7817
Jeans,2020-01,33.0044,100.0000,264.1894,233.1806,0.8826
Jeans,2020-02,157.2934,87.5000,690.3651,589.3349,0.8537
Jeans,2020-03,18.8693,-20.0000,810.1165,711.0535,0.8777
Jeans,2020-04,-23.9119,-25.0000,609.3219,548.1081,0.8995
Jeans,2020-05,-16.6913,-22.2222,517.451,446.789,0.8634
Jeans,2020-06,22.0889,71.4286,615.9232,561.3068,0.9113
Jeans,2020-07,15.6579,16.6667,719.7272,641.8328,0.8918
Jeans,2020-08,28.0076,14.2857,922.5433,820.3567,0.8892
Jeans,2020-09,-7.1375,25.0000,875.7855,742.7144,0.8481
Jeans,2020-10,-16.3083,-15.0000,711.4826,643.0674,0.9038
Jeans,2020-11,-0.8829,-29.4118,734.1315,608.4585,0.8288
Jeans,2020-12,22.8409,33.3333,894.6735,754.5765,0.8434
Jeans,2021-01,-8.2419,6.2500,811.8911,701.4289,0.8639
Jeans,2021-02,28.0509,5.8824,1067.39,870.43,0.8155
Jeans,2021-03,-38.8049,-16.6667,645.8294,540.0206,0.8362
Jeans,2021-04,166.5295,73.3333,1651.542,1509.098,0.9138
Jeans,2021-05,-47.7429,-34.6154,887.624,764.036,0.8608
Jeans,2021-06,104.1159,76.4706,1836.0976,1535.2024,0.8361
Jeans,2021-07,-10.8104,-6.6667,1589.4958,1417.3543,0.8917
Jeans,2021-08,-3.9832,10.7143,1545.6619,1341.4182,0.8679
Jeans,2021-09,-3.2039,-12.9032,1493.3062,1301.2738,0.8714
Jeans,2021-10,6.4614,3.7037,1609.0419,1366.1081,0.849
Jeans,2021-11,-7.9898,0.0000,1466.8933,1270.5467,0.8661
Jeans,2021-12,-9.9158,-14.2857,1297.3024,1168.6976,0.9009
Jumpsuits & Rompers,2019-05,,,8.0157,7.7943,0.9724
Jumpsuits & Rompers,2019-07,-37.2549,0.0000,5.4659,4.4541,0.8149
Jumpsuits & Rompers,2019-10,10.2823,0.0000,5.3606,5.5794,1.0408
Jumpsuits & Rompers,2019-12,1.3711,0.0000,5.9997,5.0903,0.8484
Jumpsuits & Rompers,2020-01,439.0442,100.0000,32.5683,27.2117,0.8355
Jumpsuits & Rompers,2020-02,-60.6892,-50.0000,12.6665,10.8335,0.8553
Jumpsuits & Rompers,2020-04,39.5319,0.0000,17.3131,15.4769,0.8939
Jumpsuits & Rompers,2020-06,-66.4837,0.0000,5.9346,5.0554,0.8519
Jumpsuits & Rompers,2020-07,38.1256,0.0000,8.2124,6.9676,0.8484
Jumpsuits & Rompers,2020-10,229.5784,200.0000,27.2448,22.7852,0.8363
Jumpsuits & Rompers,2020-12,-46.7919,-33.3333,13.5291,13.0909,0.9676
Jumpsuits & Rompers,2021-01,268.1443,-50.0000,52.626,45.374,0.8622
Jumpsuits & Rompers,2021-02,-54.1122,100.0000,22.8433,22.1267,0.9686
Jumpsuits & Rompers,2021-03,1123.0375,-50.0000,306.35,243.65,0.7953
Jumpsuits & Rompers,2021-04,-80.2364,100.0000,60.3559,48.3441,0.801
Jumpsuits & Rompers,2021-05,-46.4213,0.0000,33.1092,25.1308,0.759
Jumpsuits & Rompers,2021-06,46.7548,100.0000,45.7428,39.7272,0.8685
Jumpsuits & Rompers,2021-07,-34.3278,-25.0000,30.3745,25.7555,0.8479
Jumpsuits & Rompers,2021-08,202.9752,-33.3333,94.0493,76.0107,0.8082
Jumpsuits & Rompers,2021-09,86.3989,100.0000,163.3019,153.6881,0.9411
Jumpsuits & Rompers,2021-10,-49.5378,-50.0000,89.1662,70.7937,0.794
Jumpsuits & Rompers,2021-11,-91.2853,-50.0000,6.8585,7.0815,1.0325
Jumpsuits & Rompers,2021-12,109.9713,100.0000,16.0534,13.2166,0.8233
Leggings,2019-04,,,11.4942,8.4957,0.7391
Leggings,2019-06,-65.0825,0.0000,4.0205,2.9595,0.7361
Leggings,2019-07,69.4842,0.0000,7.0034,4.8266,0.6892
Leggings,2019-08,218.5968,100.0000,21.6162,16.0738,0.7436
Leggings,2019-09,98.9652,50.0000,44.6576,30.3324,0.6792
Leggings,2019-10,-27.1903,-33.3333,33.4137,21.1863,0.6341
Leggings,2019-11,-41.4835,0.0000,19.6141,12.3359,0.6289
Leggings,2019-12,140.6886,50.0000,48.1207,28.7793,0.5981
Leggings,2020-01,-40.3901,0.0000,27.0385,18.8015,0.6954
Leggings,2020-02,11.2347,33.3333,30.376,20.614,0.6786
Leggings,2020-03,269.445,50.0000,110.0073,78.3726,0.7124
Leggings,2020-04,-59.0774,-33.3333,45.2192,31.8708,0.7048
Leggings,2020-05,58.8403,-25.0000,69.5211,52.9289,0.7613
Leggings,2020-06,53.0911,0.0000,119.6532,67.8068,0.5667
Leggings,2020-07,-71.754,-66.6667,30.0756,22.8744,0.7606
Leggings,2020-08,166.4212,500.0000,87.4347,53.6353,0.6134
Leggings,2020-09,-27.7805,-33.3333,61.5501,40.3299,0.6552
Leggings,2020-10,-24.5976,0.0000,46.9607,29.8593,0.6358
Leggings,2020-11,32.114,0.0000,59.731,41.759,0.6991
Leggings,2020-12,9.0945,75.0000,66.5749,44.1451,0.6631
Leggings,2021-02,20.0235,-57.1429,81.7271,51.1629,0.626
Leggings,2021-03,71.1265,133.3333,138.75,88.66,0.639
Leggings,2021-04,-89.0286,-71.4286,15.1867,9.7633,0.6429
Leggings,2021-05,426.4128,100.0000,74.4175,56.9225,0.7649
Leggings,2021-06,5.6951,100.0000,83.6328,55.1872,0.6599
Leggings,2021-07,22.0213,0.0000,104.3769,65.0131,0.6229
Leggings,2021-08,59.2538,25.0000,159.7589,110.0011,0.6885
Leggings,2021-09,-62.6075,-30.0000,60.6064,40.2636,0.6643
Leggings,2021-10,10.9943,-28.5714,67.3608,44.5992,0.6621
Leggings,2021-11,143.1851,60.0000,164.1398,108.1302,0.6588
Leggings,2021-12,-57.6597,-12.5000,71.7885,43.4915,0.6058
Maternity,2019-02,,,28.458,33.542,1.1786
Maternity,2019-03,-38.7097,0.0000,17.974,20.026,1.1142
Maternity,2019-04,-19.7368,100.0000,13.2757,17.2243,1.2974
Maternity,2019-05,622.1311,100.0000,96.2652,123.9848,1.2879
Maternity,2019-07,-84.118,-75.0000,13.6772,21.3028,1.5575
Maternity,2019-08,2.1155,0.0000,15.7525,19.9675,1.2676
Maternity,2019-09,48.2923,100.0000,24.8377,28.1323,1.1326
Maternity,2019-11,84.2364,50.0000,41.2347,56.3553,1.3667
Maternity,2019-12,-28.3123,-66.6667,28.6136,41.3464,1.445
Maternity,2020-01,125.1286,100.0000,70.8015,86.6985,1.2245
Maternity,2020-02,52.6159,100.0000,107.3952,132.9748,1.2382
Maternity,2020-03,-39.1272,-25.0000,63.4924,82.8276,1.3045
Maternity,2020-04,72.1774,0.0000,106.0252,145.9048,1.3761
Maternity,2020-05,36.9349,133.3333,147.7963,197.1837,1.3342
Maternity,2020-07,-52.5799,-28.5714,72.8543,90.7358,1.2454
Maternity,2020-08,67.7181,20.0000,122.2338,152.1362,1.2446
Maternity,2020-09,-55.3596,-50.0000,52.1015,70.3785,1.3508
Maternity,2020-10,147.2975,66.6667,141.5739,161.3161,1.1394
Maternity,2020-11,-78.2099,-60.0000,27.222,38.778,1.4245
Maternity,2020-12,469.8333,300.0000,164.1732,211.9168,1.2908
Maternity,2021-01,32.1253,0.0000,222.8543,274.0557,1.2298
Maternity,2021-02,-35.2317,-37.5000,134.5213,187.3187,1.3925
Maternity,2021-03,-34.7657,20.0000,97.33,112.62,1.1571
Maternity,2021-04,137.4613,50.0000,226.7675,271.7825,1.1985
Maternity,2021-05,28.964,11.1111,289.1439,353.8061,1.2236
Maternity,2021-06,-26.8792,20.0000,198.699,271.431,1.366
Maternity,2021-07,5.9345,-41.6667,226.7114,271.3186,1.1968
Maternity,2021-08,-13.4771,28.5714,191.4529,239.4571,1.2507
Maternity,2021-09,12.9911,-11.1111,198.9388,287.9512,1.4474
Maternity,2021-10,-25.9278,37.5000,156.9658,203.6842,1.2976
Maternity,2021-11,68.7425,0.0000,259.9688,348.6012,1.3409
Maternity,2021-12,2.7343,-27.2727,279.5859,345.6241,1.2362
Outerwear & Coats,2019-03,,,419.895,483.105,1.1505
Outerwear & Coats,2019-04,-95.3499,0.0000,20.1552,21.8348,1.0833
Outerwear & Coats,2019-06,2717.1944,300.0000,498.4235,684.5164,1.3734
Outerwear & Coats,2019-07,-85.9714,-50.0000,73.1175,92.8324,1.2696
Outerwear & Coats,2019-08,233.9861,150.0000,228.3703,325.8797,1.427
Outerwear & Coats,2019-09,-29.4632,-20.0000,175.2773,215.6727,1.2305
Outerwear & Coats,2019-10,-5.2283,0.0000,159.3898,211.1202,1.3246
Outerwear & Coats,2019-11,-17.6837,-25.0000,140.9858,164.0042,1.1633
Outerwear & Coats,2019-12,180.1567,66.6667,385.3213,469.1287,1.2175
Outerwear & Coats,2020-01,24.3829,20.0000,478.9994,583.7906,1.2188
Outerwear & Coats,2020-02,20.8536,50.0000,564.6094,719.8106,1.2749
Outerwear & Coats,2020-03,-44.5688,-22.2222,330.1188,381.8512,1.1567
Outerwear & Coats,2020-04,-53.9236,-57.1429,148.2232,179.8268,1.2132
Outerwear & Coats,2020-05,378.2106,133.3333,681.4327,887.3373,1.3022
Outerwear & Coats,2020-06,38.1178,28.5714,955.5809,1211.1691,1.2675
Outerwear & Coats,2020-07,-56.5847,-33.3333,421.2064,519.4936,1.2333
Outerwear & Coats,2020-08,135.5852,166.6667,1006.5333,1209.6167,1.2018
Outerwear & Coats,2020-09,-34.5839,-18.7500,650.3136,799.4064,1.2293
Outerwear & Coats,2020-10,16.1852,30.7692,736.2117,948.1483,1.2879
Outerwear & Coats,2020-11,18.0502,-11.7647,888.9004,1099.4896,1.2369
Outerwear & Coats,2020-12,-11.7578,0.0000,746.7783,1007.8217,1.3496
Outerwear & Coats,2021-01,140.5865,-13.3333,1918.0324,2303.2976,1.2009
Outerwear & Coats,2021-02,-71.5556,-23.0769,536.813,663.917,1.2368
Outerwear & Coats,2021-03,30.0659,20.0000,698.5685,863.1715,1.2356
Outerwear & Coats,2021-04,-14.722,0.0000,591.8312,739.9888,1.2503
Outerwear & Coats,2021-05,189.2042,50.0000,1726.3047,2125.3753,1.2312
Outerwear & Coats,2021-06,-61.0077,-33.3333,684.2782,817.5817,1.1948
Outerwear & Coats,2021-07,16.4982,0.0000,784.3661,965.2739,1.2306
Outerwear & Coats,2021-08,90.386,125.0000,1486.0353,1845.0347,1.2416
Outerwear & Coats,2021-09,-9.3156,-37.0370,1339.2958,1681.4642,1.2555
Outerwear & Coats,2021-10,-2.6752,35.2941,1311.1335,1628.8165,1.2423
Outerwear & Coats,2021-11,66.1372,30.4348,2201.0912,2683.2588,1.2191
Outerwear & Coats,2021-12,-45.8098,-16.6667,1171.5612,1475.2788,1.2592
Pants,2019-04,,,70.795,79.205,1.1188
Pants,2019-05,-73.34,-50.0000,20.195,19.7951,0.9802
Pants,2019-06,437.5094,200.0000,91.1644,123.7856,1.3578
Pants,2019-08,-48.83,-33.3333,53.7102,56.2798,1.0478
Pants,2019-09,-33.6758,0.0000,30.8299,42.1201,1.3662
Pants,2019-10,126.1001,50.0000,78.0319,86.9081,1.1138
Pants,2019-11,179.7563,133.3333,207.0046,254.4253,1.2291
Pants,2019-12,-56.8754,-57.1429,92.368,106.622,1.1543
Pants,2020-01,49.3442,66.6667,141.0757,156.1043,1.1065
Pants,2020-02,53.8798,40.0000,214.0662,243.2338,1.1363
Pants,2020-03,-10.2733,14.2857,190.0238,220.2962,1.1593
Pants,2020-04,-57.2894,-50.0000,81.5956,93.6544,1.1478
Pants,2020-05,137.3638,25.0000,195.599,220.381,1.1267
Pants,2020-06,32.3934,-20.0000,261.5356,289.1944,1.1058
Pants,2020-07,9.2114,75.0000,267.0148,334.4452,1.2525
Pants,2020-08,-3.6594,28.5714,260.3268,319.1232,1.2259
Pants,2020-09,-57.439,-44.4444,110.228,136.3921,1.2374
Pants,2020-10,130.8126,80.0000,267.3704,301.8596,1.129
Pants,2020-11,9.3951,22.2222,284.0142,338.6958,1.1925
Pants,2020-12,24.448,0.0000,363.8642,411.0858,1.1298
Pants,2021-01,14.9777,45.4545,416.8696,474.1504,1.1374
Pants,2021-02,-56.3882,-62.5000,180.221,208.369,1.1562
Pants,2021-03,143.8869,133.3333,434.646,513.074,1.1804
Pants,2021-04,4.9814,-21.4286,438.1497,556.7803,1.2708
Pants,2021-05,-2.9389,36.3636,444.0393,521.6508,1.1748
Pants,2021-06,7.4558,0.0000,474.4351,563.2549,1.1872
Pants,2021-07,-27.5824,6.6667,344.8467,406.6233,1.1791
Pants,2021-08,52.9189,12.5000,515.5747,633.5653,1.2289
Pants,2021-09,7.671,5.5556,580.1716,657.1184,1.1326
Pants,2021-10,-24.1803,-21.0526,429.5344,508.5756,1.184
Pants,2021-11,23.3214,40.0000,536.4761,620.4139,1.1565
Pants,2021-12,3.9684,-28.5714,557.2085,645.5915,1.1586
Pants & Capris,2019-04,,,22.3978,20.5922,0.9194
Pants & Capris,2019-05,-72.1563,0.0000,6.6793,5.2907,0.7921
Pants & Capris,2019-07,1695.3216,400.0000,117.0345,97.8655,0.8362
Pants & Capris,2019-08,-31.5961,-80.0000,73.353,73.647,1.004
Pants & Capris,2019-09,-53.0612,0.0000,38.847,30.153,0.7762
Pants & Capris,2019-10,-49.4203,0.0000,18.5319,16.3681,0.8832
Pants & Capris,2019-11,592.6934,300.0000,119.0701,122.6799,1.0303
Pants & Capris,2019-12,-78.5067,-50.0000,28.2757,23.6843,0.8376
Pants & Capris,2020-01,15.435,0.0000,33.6188,26.3612,0.7841
Pants & Capris,2020-02,21.6906,0.0000,36.1421,36.8479,1.0195
Pants & Capris,2020-03,54.4458,100.0000,57.5874,55.1426,0.9575
Pants & Capris,2020-04,61.8558,-25.0000,95.1843,87.2757,0.9169
Pants & Capris,2020-06,-53.1678,0.0000,44.2811,41.1689,0.9297
Pants & Capris,2020-07,152.7794,0.0000,110.773,105.227,0.9499
Pants & Capris,2020-08,-60.6574,0.0000,45.7382,39.2418,0.858
Pants & Capris,2020-09,-65.3213,-33.3333,15.1671,14.3029,0.943
Pants & Capris,2020-10,1140.2104,100.0000,194.5056,170.9844,0.8791
Pants & Capris,2020-11,-29.9051,25.0000,135.5859,120.6041,0.8895
Pants & Capris,2020-12,-15.2543,0.0000,116.1829,100.9271,0.8687
Pants & Capris,2021-01,-13.0257,-20.0000,99.7982,89.0318,0.8921
Pants & Capris,2021-02,-18.9959,-25.0000,77.8715,75.0885,0.9643
Pants & Capris,2021-03,25.6865,33.3333,102.3731,89.877,0.8779
Pants & Capris,2021-04,129.2224,50.0000,233.6844,206.9956,0.8858
Pants & Capris,2021-05,-48.8382,16.6667,122.1378,103.3222,0.8459
Pants & Capris,2021-06,137.8648,71.4286,278.4414,257.8486,0.926
Pants & Capris,2021-07,-20.5877,-8.3333,226.9157,198.9643,0.8768
Pants & Capris,2021-08,-22.3161,-27.2727,173.9664,156.8736,0.9017
Pants & Capris,2021-09,67.8938,37.5000,295.9535,259.5065,0.8768
Pants & Capris,2021-10,2.1208,18.1818,303.8752,263.3648,0.8667
Pants & Capris,2021-11,-41.1378,-61.5385,176.0072,157.8828,0.897
Pants & Capris,2021-12,122.8249,200.0000,403.5719,340.4181,0.8435
Plus,2019-03,,,6.8847,6.1053,0.8868
Plus,2019-05,30.7929,0.0000,9.2595,7.7304,0.8349
Plus,2019-07,477.163,100.0000,51.3712,46.6888,0.9089
Plus,2019-08,-1.1524,50.0000,46.0333,50.8967,1.1056
Plus,2019-09,0.0619,-33.3333,51.857,45.133,0.8703
Plus,2019-10,261.7899,100.0000,171.1062,179.7938,1.0508
Plus,2019-11,-66.1698,0.0000,61.9359,56.7741,0.9167
Plus,2019-12,-56.2463,-50.0000,24.5336,27.4064,1.1171
Plus,2020-01,648.7485,150.0000,188.9535,199.9465,1.0582
Plus,2020-02,-80.9745,-80.0000,33.3695,40.6205,1.2173
Plus,2020-03,87.8227,500.0000,72.9301,66.0399,0.9055
Plus,2020-04,214.6506,-16.6667,219.9983,217.2717,0.9876
Plus,2020-05,-73.7073,-20.0000,58.9473,56.0227,0.9504
Plus,2020-06,45.4727,75.0000,81.4284,85.8216,1.054
Plus,2020-07,71.5874,-28.5714,153.6054,133.3746,0.8683
Plus,2020-08,-2.9166,60.0000,147.5508,131.0593,0.8882
Plus,2020-09,-55.3605,-25.0000,63.3167,61.0533,0.9643
Plus,2020-10,93.7606,-33.3333,124.4329,116.5471,0.9366
Plus,2020-11,-21.6574,125.0000,97.3954,91.3946,0.9384
Plus,2020-12,14.9054,-33.3333,103.5924,113.3376,1.0941
Plus,2021-01,92.6197,50.0000,212.1662,205.6838,0.9694
Plus,2021-02,-57.8413,-22.2222,92.1562,84.0038,0.9115
Plus,2021-03,105.6823,0.0000,177.1635,185.1665,1.0452
Plus,2021-04,-35.7216,14.2857,119.3573,113.5427,0.9513
Plus,2021-05,-55.1567,-50.0000,52.9815,51.4585,0.9713
Plus,2021-06,36.0973,75.0000,73.065,69.0749,0.9454
Plus,2021-07,-46.5386,-57.1429,36.4086,39.5814,1.0871
Plus,2021-08,667.022,300.0000,304.1098,278.7502,0.9166
Plus,2021-09,-9.9784,41.6667,262.3311,262.3689,1.0001
Plus,2021-10,-15.8719,-58.8235,226.8271,214.5929,0.9461
Plus,2021-11,-24.7383,0.0000,168.1738,164.0462,0.9755
Plus,2021-12,-34.4922,28.5714,111.4007,106.2293,0.9536
Shorts,2019-02,,,40.1587,43.8313,1.0915
Shorts,2019-03,-26.2055,0.0000,30.0077,31.9723,1.0655
Shorts,2019-04,199.6128,0.0000,94.073,91.627,0.974
Shorts,2019-05,6.0205,0.0000,100.2736,96.6064,0.9634
Shorts,2019-06,-37.8048,50.0000,62.0447,60.4054,0.9736
Shorts,2019-07,31.9886,66.6667,80.5725,81.0475,1.0059
Shorts,2019-08,104.4549,20.0000,164.5972,165.8428,1.0076
Shorts,2019-09,-52.6389,-50.0000,74.185,82.315,1.1096
Shorts,2019-10,-39.3994,66.6667,46.2821,48.5579,1.0492
Shorts,2019-11,161.609,20.0000,125.1674,122.9426,0.9822
Shorts,2019-12,67.6313,83.3333,209.1874,206.7226,0.9882
Shorts,2020-01,-40.1794,-54.5455,126.8073,121.9927,0.962
Shorts,2020-02,77.0177,80.0000,222.6874,217.7326,0.9777
Shorts,2020-03,15.9234,-11.1111,261.2641,249.2859,0.9542
Shorts,2020-04,-48.3831,-37.5000,135.3651,128.1649,0.9468
Shorts,2020-05,80.1958,200.0000,232.8003,242.0697,1.0398
Shorts,2020-06,12.6077,-33.3333,270.0341,264.7059,0.9803
Shorts,2020-07,-1.9785,-10.0000,255.5791,268.5809,1.0509
Shorts,2020-08,-12.1451,33.3333,229.3514,231.1486,1.0078
Shorts,2020-09,68.7557,58.3333,393.1522,383.9678,0.9766
Shorts,2020-10,-24.6474,-26.3158,286.7007,298.8793,1.0425
Shorts,2020-11,9.8979,-14.2857,333.2679,310.2721,0.931
Shorts,2020-12,7.5799,33.3333,345.9971,346.3229,1.0009
Shorts,2021-01,65.0335,31.2500,573.6561,568.9039,0.9917
Shorts,2021-02,41.7457,-33.3333,809.3451,810.1849,1.001
Shorts,2021-03,-58.6152,14.2857,343.7854,326.4546,0.9496
Shorts,2021-04,52.9795,18.7500,518.1336,507.1964,0.9789
Shorts,2021-05,6.6359,21.0526,535.9929,557.3771,1.0399
Shorts,2021-06,-23.2949,-13.0435,421.5536,417.1164,0.9895
Shorts,2021-07,9.6927,15.0000,460.1483,459.8117,0.9993
Shorts,2021-08,88.8441,43.4783,882.355,854.935,0.9689
Shorts,2021-09,-40.7462,-18.1818,503.5,525.91,1.0445
Shorts,2021-10,6.5144,0.0000,544.7946,551.6754,1.0126
Shorts,2021-11,-18.0032,-37.0370,462.3414,436.7286,0.9446
Shorts,2021-12,6.4967,35.2941,474.5435,482.9365,1.0177
Skirts,2019-09,,,64.113,90.917,1.4181
Skirts,2019-10,23.7889,-33.3333,84.7404,107.1696,1.2647
Skirts,2019-11,-4.9086,0.0000,67.1029,115.3871,1.7196
Skirts,2019-12,-70.7381,0.0000,21.5288,31.8713,1.4804
Skirts,2020-02,-3.764,0.0000,19.2673,32.1228,1.6672
Skirts,2020-03,-24.1098,-50.0000,15.912,23.088,1.451
Skirts,2020-04,89.7179,100.0000,26.2783,47.7116,1.8156
Skirts,2020-05,39.208,0.0000,40.668,62.332,1.5327
Skirts,2020-06,-67.0971,-50.0000,13.0815,20.8085,1.5907
Skirts,2020-07,460.6079,200.0000,74.2944,115.6956,1.5573
Skirts,2020-08,0.9474,0.0000,69.7864,122.0036,1.7482
Skirts,2020-09,-60.9312,-66.6667,28.2486,46.6814,1.6525
Skirts,2020-11,-73.3218,0.0000,8.7156,11.2744,1.2936
Skirts,2020-12,454.7274,300.0000,44.2482,66.6418,1.5061
Skirts,2021-01,-72.9913,-75.0000,12.9085,17.0416,1.3202
Skirts,2021-02,809.3155,500.0000,110.7641,161.5759,1.4587
Skirts,2021-03,-78.156,-66.6667,23.862,35.628,1.4931
Skirts,2021-04,156.7154,150.0000,60.6405,92.0795,1.5184
Skirts,2021-05,-65.99,-60.0000,19.5803,32.3597,1.6527
Skirts,2021-06,80.362,50.0000,37.6301,56.0499,1.4895
Skirts,2021-07,51.2062,0.0000,54.7489,86.9011,1.5873
Skirts,2021-08,-58.348,-33.3333,24.052,34.948,1.453
Skirts,2021-09,221.4068,50.0000,82.5197,107.1103,1.298
Skirts,2021-10,216.2896,133.3333,236.1404,363.6396,1.5399
Skirts,2021-11,-77.9202,-42.8571,54.1826,78.2474,1.4441
Skirts,2021-12,86.5136,-50.0000,101.53,145.47,1.4328
Sleep & Lounge,2019-02,,,60.1585,106.3415,1.7677
Sleep & Lounge,2019-03,-61.5616,-50.0000,40.256,23.744,0.5898
Sleep & Lounge,2019-04,274.9062,100.0000,103.2342,136.7058,1.3242
Sleep & Lounge,2019-05,-80.1659,0.0000,22.6387,24.9513,1.1022
Sleep & Lounge,2019-06,-68.5018,-50.0000,5.8761,9.1139,1.551
Sleep & Lounge,2019-07,1270.6471,500.0000,96.9607,108.4993,1.119
Sleep & Lounge,2019-08,70.2618,-16.6667,156.1372,193.6828,1.2405
Sleep & Lounge,2019-09,-70.562,-40.0000,49.1098,53.8702,1.0969
Sleep & Lounge,2019-10,138.1433,133.3333,102.8857,142.3543,1.3836
Sleep & Lounge,2019-11,-41.6979,-57.1429,62.1159,80.8641,1.3018
Sleep & Lounge,2019-12,255.4833,233.3333,223.2123,285.0577,1.2771
Sleep & Lounge,2020-01,10.4236,-10.0000,270.3793,290.8707,1.0758
Sleep & Lounge,2020-02,-2.2931,0.0000,263.4053,284.9747,1.0819
Sleep & Lounge,2020-03,14.8656,22.2222,278.2512,351.6487,1.2638
Sleep & Lounge,2020-04,16.6106,18.1818,377.8946,356.6354,0.9437
Sleep & Lounge,2020-05,-51.2709,-46.1538,156.2597,201.6703,1.2906
Sleep & Lounge,2020-06,31.0424,14.2857,231.2659,237.7741,1.0281
Sleep & Lounge,2020-07,13.9498,37.5000,219.9711,314.4989,1.4297
Sleep & Lounge,2020-08,-12.6312,-36.3636,244.8296,222.1304,0.9073
Sleep & Lounge,2020-09,-42.115,28.5714,122.8429,147.4571,1.2004
Sleep & Lounge,2020-10,189.434,77.7778,354.1601,428.1799,1.209
Sleep & Lounge,2020-11,-45.6119,-37.5000,183.8159,241.6841,1.3148
Sleep & Lounge,2020-12,184.7544,140.0000,572.0806,639.5494,1.1179
Sleep & Lounge,2021-01,-31.7184,-16.6667,364.3077,463.0124,1.2709
Sleep & Lounge,2021-02,-30.878,-50.0000,251.5564,320.3036,1.2733
Sleep & Lounge,2021-03,66.5093,90.0000,487.9124,464.2876,0.9516
Sleep & Lounge,2021-04,-34.7616,-15.7895,266.3456,354.8544,1.3323
Sleep & Lounge,2021-05,86.8835,43.7500,578.084,582.836,1.0082
Sleep & Lounge,2021-06,-37.4677,-34.7826,386.0869,339.8631,0.8803
Sleep & Lounge,2021-07,47.9138,66.6667,558.3894,515.3906,0.923
Sleep & Lounge,2021-08,-16.1812,-20.0000,484.0367,415.9933,0.8594
Sleep & Lounge,2021-09,71.1443,75.0000,797.7981,742.5519,0.9308
Sleep & Lounge,2021-10,-31.3383,-42.8571,548.1935,509.4365,0.9293
Sleep & Lounge,2021-11,0.8576,35.0000,527.1803,539.5197,1.0234
Sleep & Lounge,2021-12,22.1965,-3.7037,673.8507,629.6194,0.9344
Socks,2019-02,,,30.1788,21.6412,0.7171
Socks,2019-03,-81.9375,-75.0000,5.719,3.641,0.6367
Socks,2019-04,348.718,100.0000,25.677,16.323,0.6357
Socks,2019-06,185.5952,-50.0000,74.9687,44.9812,0.6
Socks,2019-07,-79.8166,100.0000,14.4824,9.7276,0.6717
Socks,2019-08,-46.5097,-50.0000,7.3297,5.6203,0.7668
Socks,2019-09,603.3977,200.0000,57.8435,33.2466,0.5748
Socks,2019-10,-58.5684,0.0000,22.2279,15.5121,0.6979
Socks,2019-11,95.9459,33.3333,42.3171,31.6328,0.7475
Socks,2019-12,-64.8546,-50.0000,14.8462,11.1438,0.7506
Socks,2020-01,146.9411,50.0000,38.0829,26.0971,0.6853
Socks,2020-02,-26.7685,0.0000,27.626,19.374,0.7013
Socks,2020-03,239.4255,200.0000,94.1293,65.4007,0.6948
Socks,2020-04,-52.3036,-33.3333,46.4479,29.6421,0.6382
Socks,2020-05,-9.7122,-33.3333,39.7734,28.9267,0.7273
Socks,2020-06,94.1194,100.0000,81.9625,51.3975,0.6271
Socks,2020-07,-9.0282,-25.0000,76.4981,44.8219,0.5859
Socks,2020-08,-23.3844,-16.6667,55.3197,37.6303,0.6802
Socks,2020-09,105.7343,120.0000,116.9818,74.2482,0.6347
Socks,2020-10,-35.4285,-36.3636,73.0537,50.4263,0.6903
Socks,2020-11,-21.8254,-14.2857,57.3773,39.1527,0.6824
Socks,2020-12,117.7769,50.0000,127.4217,82.7983,0.6498
Socks,2021-01,14.756,66.6667,144.4125,96.8275,0.6705
Socks,2021-02,-42.381,-60.0000,82.331,56.669,0.6883
Socks,2021-03,155.2302,133.3333,214.6493,140.1207,0.6528
Socks,2021-04,-76.3932,-64.2857,48.5928,35.1572,0.7235
Socks,2021-05,349.2537,300.0000,228.6688,147.5812,0.6454
Socks,2021-06,-30.4797,-40.0000,159.8036,101.7664,0.6368
Socks,2021-07,-55.7289,-8.3333,68.4525,47.3475,0.6917
Socks,2021-08,109.6373,18.1818,147.4892,95.2708,0.646
Socks,2021-09,54.1728,46.1538,228.4422,145.8278,0.6384
Socks,2021-10,-25.9732,-21.0526,166.9414,110.1186,0.6596
Socks,2021-11,33.574,33.3333,226.9377,143.1423,0.6308
Socks,2021-12,-50.5296,-45.0000,111.4387,71.6413,0.6429
Socks & Hosiery,2019-02,,,4.22,5.78,1.3697
Socks & Hosiery,2019-05,300.0,100.0000,14.815,25.185,1.7
Socks & Hosiery,2019-07,-70.0,-50.0000,4.812,7.188,1.4938
Socks & Hosiery,2019-08,199.9167,100.0000,14.4602,21.5298,1.4889
Socks & Hosiery,2019-10,24.868,50.0000,18.8091,26.1309,1.3893
Socks & Hosiery,2019-11,6.2305,33.3333,18.6771,29.0629,1.5561
Socks & Hosiery,2019-12,-9.1328,-25.0000,17.5573,25.8227,1.4708
Socks & Hosiery,2020-01,-3.2503,0.0000,17.7684,24.2016,1.3621
Socks & Hosiery,2020-02,24.2792,0.0000,19.614,32.5459,1.6593
Socks & Hosiery,2020-03,-51.1311,-33.3333,9.9485,15.5414,1.5622
Socks & Hosiery,2020-04,257.6304,200.0000,35.0174,56.1426,1.6033
Socks & Hosiery,2020-05,-50.6362,-66.6667,17.385,27.615,1.5884
Socks & Hosiery,2020-06,-40.0889,0.0000,10.9401,16.0199,1.4643
Socks & Hosiery,2020-07,226.2982,150.0000,37.5992,50.3707,1.3397
Socks & Hosiery,2020-08,6.6955,20.0000,37.2517,56.6083,1.5196
Socks & Hosiery,2020-09,-45.7916,-33.3333,19.888,30.992,1.5583
Socks & Hosiery,2020-10,33.5495,0.0000,26.205,41.7451,1.593
Socks & Hosiery,2020-11,16.2178,25.0000,30.9244,48.0456,1.5536
Socks & Hosiery,2020-12,-22.7808,-40.0000,23.5187,37.4613,1.5928
Socks & Hosiery,2021-01,67.6451,166.6667,42.4409,59.789,1.4088
Socks & Hosiery,2021-02,-18.8301,-50.0000,33.3358,49.6442,1.4892
Socks & Hosiery,2021-03,-42.444,-50.0000,19.7002,28.0598,1.4243
Socks & Hosiery,2021-04,150.5234,250.0000,48.5324,71.1176,1.4654
Socks & Hosiery,2021-05,1.0781,-14.2857,48.1261,72.8139,1.513
Socks & Hosiery,2021-06,-5.0025,16.6667,47.52,67.37,1.4177
Socks & Hosiery,2021-07,69.7102,28.5714,80.4119,114.5681,1.4248
Socks & Hosiery,2021-08,-14.6374,0.0000,68.298,98.142,1.437
Socks & Hosiery,2021-09,-42.0392,-11.1111,40.459,56.011,1.3844
Socks & Hosiery,2021-10,81.2481,12.5000,69.3597,105.4904,1.5209
Socks & Hosiery,2021-11,-12.6852,11.1111,58.2297,94.4402,1.6219
Socks & Hosiery,2021-12,-19.3948,-10.0000,52.5432,70.5168,1.3421
Suits,2019-02,,,52.1676,36.1024,0.692
Suits,2019-08,126.5776,0.0000,129.6,70.4,0.5432
Suits,2019-09,-38.7,0.0000,71.3532,51.2468,0.7182
Suits,2019-11,37.8467,0.0000,98.696,70.304,0.7123
Suits,2019-12,-51.9349,0.0000,48.3319,32.8982,0.6807
Suits,2020-01,-6.4508,0.0000,49.1655,26.8245,0.5456
Suits,2020-02,29.0696,0.0000,54.5325,43.5475,0.7986
Suits,2020-04,98.8071,100.0000,118.2027,76.7873,0.6496
Suits,2020-06,-37.125,-50.0000,71.3532,51.2468,0.7182
Suits,2020-07,4.0049,0.0000,73.0632,54.4468,0.7452
Suits,2020-10,219.1828,200.0000,252.5669,154.4231,0.6114
Suits,2020-12,-15.2338,0.0000,212.4196,132.5704,0.6241
Suits,2021-01,61.7757,33.3333,319.0132,239.0968,0.7495
Suits,2021-02,-58.7752,-50.0000,137.8245,92.2555,0.6694
Suits,2021-03,293.9282,150.0000,536.9403,369.4097,0.688
Suits,2021-04,-37.9346,0.0000,341.4593,221.0707,0.6474
Suits,2021-09,-53.558,-40.0000,156.6801,104.5699,0.6674
Suits,2021-10,112.3445,100.0000,342.9218,211.8282,0.6177
Suits,2021-11,-10.4029,-33.3333,297.4884,199.5516,0.6708
Suits,2021-12,9.295,0.0000,317.5374,225.7026,0.7108
Suits & Sport Coats,2019-05,,,125.6958,174.2942,1.3866
Suits & Sport Coats,2019-06,-73.3491,0.0000,34.0587,45.8913,1.3474
Suits & Sport Coats,2019-07,-10.8943,100.0000,26.586,44.654,1.6796
Suits & Sport Coats,2019-08,369.3992,0.0000,131.1552,203.2448,1.5497
Suits & Sport Coats,2019-10,89.5783,100.0000,272.868,361.082,1.3233
Suits & Sport Coats,2019-11,-25.1471,-25.0000,201.4724,273.0576,1.3553
Suits & Sport Coats,2019-12,-62.7126,-33.3333,76.7061,100.234,1.3067
Suits & Sport Coats,2020-01,297.3042,300.0000,289.4744,413.5156,1.4285
Suits & Sport Coats,2020-02,-33.4343,-62.5000,193.0521,274.8978,1.424
Suits & Sport Coats,2020-03,-55.5508,-33.3333,90.64,117.36,1.2948
Suits & Sport Coats,2020-04,43.2692,-50.0000,118.604,179.396,1.5126
Suits & Sport Coats,2020-05,-26.3423,0.0000,93.068,126.432,1.3585
Suits & Sport Coats,2020-06,20.7016,200.0000,108.4397,156.5003,1.4432
Suits & Sport Coats,2020-07,178.1762,133.3333,293.4419,443.5581,1.5116
Suits & Sport Coats,2020-08,7.2524,-28.5714,331.7266,458.7233,1.3828
Suits & Sport Coats,2020-09,4.2153,60.0000,337.8962,485.8738,1.4379
Suits & Sport Coats,2020-10,0.2246,-37.5000,313.3957,512.2243,1.6344
Suits & Sport Coats,2020-11,-32.7281,20.0000,220.9869,334.4231,1.5133
Suits & Sport Coats,2020-12,155.4617,83.3333,564.9836,853.8764,1.5113
Suits & Sport Coats,2021-01,-19.1492,-18.1818,485.3061,661.8539,1.3638
Suits & Sport Coats,2021-02,-30.701,-22.2222,322.0444,472.9256,1.4685
Suits & Sport Coats,2021-03,64.3471,57.1429,515.4891,791.0209,1.5345
Suits & Sport Coats,2021-04,-10.975,-18.1818,493.8261,669.2938,1.3553
Suits & Sport Coats,2021-05,8.4935,-22.2222,513.3566,748.5534,1.4582
Suits & Sport Coats,2021-06,59.681,42.8571,818.2259,1196.8041,1.4627
Suits & Sport Coats,2021-07,-33.799,10.0000,511.0636,822.9064,1.6102
Suits & Sport Coats,2021-08,-48.193,-36.3636,280.7571,410.3329,1.4615
Suits & Sport Coats,2021-09,67.3226,42.8571,477.3184,679.0316,1.4226
Suits & Sport Coats,2021-10,33.7234,20.0000,575.8761,970.4339,1.6851
Suits & Sport Coats,2021-11,-43.6956,-41.6667,356.6008,514.0392,1.4415
Suits & Sport Coats,2021-12,11.92,-14.2857,376.2925,598.1274,1.5895
Sweaters,2019-02,,,51.7344,53.8656,1.0412
Sweaters,2019-04,79.8295,0.0000,79.7196,110.1804,1.3821
Sweaters,2019-05,-61.5798,-50.0000,34.5101,38.4499,1.1142
Sweaters,2019-06,412.3081,200.0000,191.8342,181.9458,0.9485
Sweaters,2019-07,-57.7291,-66.6667,84.53,73.47,0.8692
Sweaters,2019-08,222.0127,700.0000,252.9245,255.8555,1.0116
Sweaters,2019-09,-48.8915,-25.0000,121.1023,138.9277,1.1472
Sweaters,2019-10,-16.6558,-33.3333,97.6265,119.0935,1.2199
Sweaters,2019-11,158.1395,25.0000,276.6271,282.8129,1.0224
Sweaters,2019-12,-35.4176,0.0000,161.7402,199.5598,1.2338
Sweaters,2020-01,42.8176,-20.0000,261.139,254.861,0.976
Sweaters,2020-02,28.0194,175.0000,314.1372,346.4428,1.1028
Sweaters,2020-03,-35.9805,-27.2727,195.472,227.428,1.1635
Sweaters,2020-04,56.5642,25.0000,333.718,328.392,0.984
Sweaters,2020-05,-39.8212,-10.0000,193.6754,204.7746,1.0573
Sweaters,2020-06,81.9199,22.2222,355.9515,368.9085,1.0364
Sweaters,2020-07,49.3516,54.5455,525.5662,557.0238,1.0599
Sweaters,2020-08,-37.5036,-47.0588,332.2848,344.2952,1.0361
Sweaters,2020-09,4.6233,-11.1111,355.1666,352.6934,0.993
Sweaters,2020-10,-5.1211,25.0000,310.8933,360.7167,1.1603
Sweaters,2020-11,66.5163,60.0000,554.4266,563.9134,1.0171
Sweaters,2020-12,9.8619,6.2500,621.7698,606.8602,0.976
Sweaters,2021-01,79.4503,64.7059,1072.2523,1132.5277,1.0562
Sweaters,2021-02,-31.5564,-39.2857,715.1084,793.9216,1.1102
Sweaters,2021-03,20.2408,41.1765,922.675,891.795,0.9665
Sweaters,2021-04,-34.0309,-33.3333,574.3737,622.6163,1.084
Sweaters,2021-05,68.5286,50.0000,987.3559,1029.914,1.0431
Sweaters,2021-06,-31.9922,-12.5000,649.3636,722.5364,1.1127
Sweaters,2021-07,-2.2093,-9.5238,641.117,700.473,1.0926
Sweaters,2021-08,-18.7531,-10.5263,539.4949,550.505,1.0204
Sweaters,2021-09,44.0431,23.5294,752.0561,818.0139,1.0877
Sweaters,2021-10,-15.263,-4.7619,629.8285,700.6015,1.1124
Sweaters,2021-11,71.3243,35.0000,1111.2084,1168.1416,1.0512
Sweaters,2021-12,69.1614,11.1111,1799.8517,2055.9283,1.1423
Swim,2019-03,,,25.2816,16.3685,0.6474
Swim,2019-04,24.8499,0.0000,31.98,20.02,0.626
Swim,2019-05,326.6538,300.0000,107.8465,114.0135,1.0572
Swim,2019-06,26.7781,0.0000,167.4767,113.7933,0.6795
Swim,2019-07,-47.5593,-50.0000,67.3745,80.1255,1.1893
Swim,2019-08,18.1627,50.0000,83.762,90.528,1.0808
Swim,2019-09,-48.6488,0.0000,43.752,45.748,1.0456
Swim,2019-10,292.6704,100.0000,163.6901,187.7499,1.147
Swim,2019-11,11.0801,16.6667,183.8709,206.5091,1.1231
Swim,2019-12,-57.4261,-42.8571,94.8655,71.3345,0.752
Swim,2020-01,265.728,125.0000,292.6007,315.2393,1.0774
Swim,2020-02,-3.1077,11.1111,295.5148,293.4352,0.993
Swim,2020-03,-20.4567,30.0000,246.8699,221.6001,0.8976
Swim,2020-04,1.1548,-15.3846,255.7533,218.1267,0.8529
Swim,2020-05,-41.8144,-63.6364,138.5112,137.2188,0.9907
Swim,2020-06,208.871,275.0000,425.5424,426.1076,1.0013
Swim,2020-07,2.2768,-20.0000,400.5746,470.4654,1.1745
Swim,2020-08,-25.465,-8.3333,320.5367,328.6933,1.0254
Swim,2020-09,13.0662,36.3636,361.5645,372.4955,1.0302
Swim,2020-10,64.1664,26.6667,615.9361,589.1439,0.9565
Swim,2020-11,-30.0511,-21.0526,448.0389,394.9011,0.8814
Swim,2020-12,51.7783,13.3333,643.3376,636.0625,0.9887
Swim,2021-01,-38.2429,-5.8824,420.0187,370.1013,0.8812
Swim,2021-02,38.6954,-18.7500,531.7847,564.0753,1.0607
Swim,2021-03,-17.3699,46.1538,458.4204,447.0896,0.9753
Swim,2021-04,-8.3202,-21.0526,420.1864,409.9836,0.9757
Swim,2021-05,70.8927,60.0000,800.1192,618.5808,0.7731
Swim,2021-06,8.462,4.1667,779.0981,759.6519,0.975
Swim,2021-07,-19.7258,-20.0000,649.7957,585.4243,0.9009
Swim,2021-08,-15.152,5.0000,561.7484,486.3116,0.8657
Swim,2021-09,42.4251,28.5714,803.1005,689.5995,0.8587
Swim,2021-10,54.4738,29.6296,1101.6838,1204.1462,1.093
Swim,2021-11,-40.9744,-22.8571,684.2534,676.7766,0.9891
Swim,2021-12,26.9781,-3.7037,810.7218,917.4882,1.1317
Tops & Tees,2019-02,,,74.36,55.64,0.7483
Tops & Tees,2019-04,-52.7462,100.0000,33.9825,27.4475,0.8077
Tops & Tees,2019-05,-20.2344,0.0000,25.734,23.266,0.9041
Tops & Tees,2019-06,119.3878,50.0000,60.0223,47.4777,0.791
Tops & Tees,2019-07,104.5953,0.0000,126.09,93.85,0.7443
Tops & Tees,2019-08,-7.6021,100.0000,110.2074,93.0126,0.844
Tops & Tees,2019-09,47.5445,0.0000,161.0801,138.7599,0.8614
Tops & Tees,2019-10,53.2651,33.3333,250.0727,209.4773,0.8377
Tops & Tees,2019-11,-57.7717,-50.0000,107.43,86.63,0.8064
Tops & Tees,2019-12,125.1263,125.0000,238.2618,198.6182,0.8336
Tops & Tees,2020-01,6.6105,33.3333,255.9691,209.7909,0.8196
Tops & Tees,2020-02,-65.0271,-50.0000,89.7699,73.1201,0.8145
Tops & Tees,2020-03,-18.3559,-33.3333,78.6409,54.3491,0.6911
Tops & Tees,2020-04,251.7257,275.0000,256.9855,210.7745,0.8202
Tops & Tees,2020-05,-17.013,-33.3333,213.1116,175.0684,0.8215
Tops & Tees,2020-06,-19.849,-10.0000,177.677,133.453,0.7511
Tops & Tees,2020-07,81.9015,33.3333,313.9869,251.9631,0.8025
Tops & Tees,2020-08,-25.6613,0.0000,231.6747,189.0453,0.816
Tops & Tees,2020-09,100.8343,66.6667,466.3972,378.5528,0.8117
Tops & Tees,2020-10,-5.6323,-5.0000,441.8239,355.5361,0.8047
Tops & Tees,2020-11,-15.8084,-10.5263,372.2872,299.0228,0.8032
Tops & Tees,2020-12,86.863,64.7059,699.7882,554.6418,0.7926
Tops & Tees,2021-01,-48.8421,-42.8571,355.2065,286.5335,0.8067
Tops & Tees,2021-02,11.2803,0.0000,410.8309,303.2991,0.7383
Tops & Tees,2021-03,42.7891,62.5000,573.1402,446.5598,0.7791
Tops & Tees,2021-04,50.9444,-23.0769,880.6685,658.5115,0.7477
Tops & Tees,2021-05,-49.0287,0.0000,431.2066,353.3334,0.8194
Tops & Tees,2021-06,-32.9199,-35.0000,299.7102,226.5598,0.7559
Tops & Tees,2021-07,102.2289,100.0000,594.1989,470.0711,0.7911
Tops & Tees,2021-08,6.0032,-11.5385,633.6928,494.4672,0.7803
Tops & Tees,2021-09,-44.054,0.0000,358.0777,273.0823,0.7626
Tops & Tees,2021-10,160.4839,34.7826,926.0867,717.9833,0.7753
Tops & Tees,2021-11,-13.1734,-3.2258,806.1676,621.3224,0.7707
Tops & Tees,2021-12,-0.7173,6.6667,783.059,634.191,0.8099
Underwear,2019-03,,,6.5806,8.4094,1.2779
Underwear,2019-04,0.0,0.0000,6.7905,8.1995,1.2075
Underwear,2019-05,467.0447,200.0000,39.249,45.751,1.1657
Underwear,2019-06,90.6824,100.0000,74.7338,87.3462,1.1688
Underwear,2019-07,-54.8371,-50.0000,34.1962,39.0038,1.1406
Underwear,2019-08,21.5847,33.3333,40.173,48.827,1.2154
Underwear,2019-09,-42.6966,-50.0000,25.384,25.616,1.0091
Underwear,2019-10,178.4118,150.0000,68.207,73.783,1.0818
Underwear,2019-11,-26.7624,0.0000,47.7632,56.2268,1.1772
Underwear,2019-12,86.9891,20.0000,91.2987,103.1513,1.1298
Underwear,2020-01,-64.5153,-66.6667,30.412,38.588,1.2688
Underwear,2020-02,155.7826,250.0000,83.7431,92.7469,1.1075
Underwear,2020-03,8.4424,0.0000,87.1012,104.2888,1.1973
Underwear,2020-04,-22.4254,-28.5714,69.8913,78.5787,1.1243
Underwear,2020-05,53.0882,80.0000,105.952,121.3381,1.1452
Underwear,2020-06,-7.7874,-11.1111,97.5101,112.0799,1.1494
Underwear,2020-07,25.86,-25.0000,133.4976,130.2924,0.976
Underwear,2020-08,94.6321,100.0000,239.5497,273.8703,1.1433
Underwear,2020-09,-30.963,8.3333,162.4953,191.9547,1.1813
Underwear,2020-10,-38.753,-38.4615,101.5587,115.5313,1.1376
Underwear,2020-11,66.7189,37.5000,169.126,192.804,1.14
Underwear,2020-12,-31.2022,-9.0909,119.665,129.335,1.0808
Underwear,2021-01,32.9317,30.0000,157.6463,173.3537,1.0996
Underwear,2021-02,-9.6737,-30.7692,142.4882,156.4919,1.0983
Underwear,2021-03,-15.4024,11.1111,119.7995,133.1305,1.1113
Underwear,2021-04,-6.0807,0.0000,108.6307,128.9193,1.1868
Underwear,2021-05,33.5129,40.0000,147.4759,169.6841,1.1506
Underwear,2021-06,52.9102,14.2857,227.4392,257.5308,1.1323
Underwear,2021-07,-29.1915,-31.2500,164.0584,179.3416,1.0932
Underwear,2021-08,-7.7461,18.1818,149.3543,167.4457,1.1211
Underwear,2021-09,8.6048,15.3846,157.2584,186.8016,1.1879
Underwear,2021-10,71.2318,46.6667,283.4265,305.7135,1.0786
Underwear,2021-11,2.8177,-13.6364,283.0854,322.6546,1.1398
Underwear,2021-12,-30.9473,-5.2632,199.3643,218.9158,1.0981


2025-01-26 08:20:51 - root - INFO - Please check the answer again by reviewing Generate a monthly report for each product category detailing the month-over-month percentage growth in revenue and orders, along with the monthly total cost, profit, and profit-to-cost ratio for orders that were completed and delivered before 2022, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Product_Category,Month,Revenue_Growth(%),Orders_Growth(%),Total_Cost,Profit,Profit_to_Cost_Ratio
category1:str,month1:str,revenue_growth1:float,orders_growth1:float,total_cost1:float,profit1:float,ratio1:float
category1:str,month2:str,revenue_growth2:float,orders_growth2:float,total_cost2:float,profit2:float,ratio2:float
...
```

In this report, each row represents a product category for a specific month, detailing the month-over-month percentage growth in revenue and orders, along with the monthly total cost, profit, and profit-to-cost ratio for orders that were completed and delivered before 2022. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Too long, hard cut:
PRODUCT_CATEGORY,Month,Revenue_Growth(%),Orders_Growth(%),TOTAL_COST,PROFIT,PROFIT_TO_COST_RATIO
Accessories,2019-02,,,11.8039,15.1461,1.2831
Accessories,2019-04,85.5288,-50.0000,22.5,27.5,1.2222
Accessories,2019-05,183.3,200.0000,54.7881,86.8619,1.5854
Accessories,2019-06,8.0833,33.3333,59.9366,93.1634,1.5544
Accessories,2019-08,143.083,75.0000,142.1037,230.0563,1.6189
Accessories,2019-09,-76.7896,-28.5714,35.4061,50.9739,1.4397
Accessories,2019-10,-56.182,-60.0000,15.1798,22.6703,1.4935
Accessories,2019-11,531.1493,50.0000,104.4865,134.4035,1.2863
Accessories,2019-12,-1.5865,233.3333,91.7858,143.3142,1.5614
Accessories,2020-01,-4.0111,-30.0000,90.1761,135.4939,1.5025
Accessories,2020-02,-45.5001,-71.4286,48.9201,74.0699,1.5141
Accessories,2020-03,138.1982,350.0000,114.9966,177.9634,1.5476
Accessories,2020-04,51.833,11.1111,190.7046,254.1054,1.3325
Accessories,2020-05,1.9244,-10.0000,166.9902,286.3798,1.715
Accessories,2020-06,-37.0845,-11.1111,109.9494,175.2906,1.5943
Accessories,2020-07,42.3117,87.5000,165.4063,240.5237,1.4541
Accessories,2020-08,22.0605,-26.6667,213.5075,281.9726,1.3207
Accessories,2020-09,-5.4129,27.2727,192.5481,276.1119,1.434
Accessories,2020-10,53.2604,28.5714,297.438,420.832,1.4149
Accessories,2020-11,74.9746,5.5556,525.3464,731.4436,1.3923
Accessories,2020-12,-80.7812,-52.6316,91.5548,149.9852,1.6382
Accessories,2021-01,282.9511,122.2222,372.3377,552.6423,1.4843
Accessories,2021-02,-51.493,-40.0000,180.9455,267.7345,1.4796
Accessories,2021-03,33.8816,16.6667,236.4382,364.2618,1.5406
Accessories,2021-04,-9.0611,14.2857,209.1395,337.1305,1.612
Accessories,2021-05,13.8704,-31.2500,248.599,373.441,1.5022
Accessories,2021-06,1.2555,81.8182,242.5018,387.3482,1.5973
Accessories,2021-07,62.8356,0.0000,413.3824,612.2376,1.481
Accessories,2021-08,-13.5333,15.0000,351.1761,535.6439,1.5253
Accessories,2021-09,-20.8768,-34.7826,286.6373,415.0427,1.448
Accessories,2021-10,17.3327,26.6667,340.4941,482.8059,1.418
Accessories,2021-11,-33.52,-10.5263,216.8263,330.5037,1.5243
Accessories,2021-12,71.1837,58.8235,375.1764,561.7636,1.4973
Active,2019-02,,,44.2825,63.6675,1.4378
Active,2019-03,-36.0908,0.0000,26.5691,42.4209,1.5966
Active,2019-04,-56.5154,-50.0000,12.66,17.34,1.3697
Active,2019-05,280.0,100.0000,43.586,70.414,1.6155
Active,2019-06,9.6404,50.0000,50.0408,74.9492,1.4978
Active,2019-07,54.3404,0.0000,77.8638,115.0462,1.4775
Active,2019-08,-41.6153,0.0000,49.3281,63.3019,1.2833
Active,2019-09,82.6068,33.3333,86.0598,119.6102,1.3898
Active,2019-10,-66.9422,-25.0000,29.2177,38.7723,1.327
Active,2019-11,5.8097,-33.3333,30.3046,41.6354,1.3739
Active,2019-12,234.9597,150.0000,97.1063,143.8637,1.4815
Active,2020-01,24.0196,40.0000,122.9775,175.8725,1.4301
Active,2020-02,287.5088,100.0000,448.2454,709.8246,1.5836
Active,2020-03,-83.4267,-64.2857,75.8951,116.0349,1.5289
Active,2020-04,37.498,60.0000,111.8746,152.0254,1.3589
Active,2020-05,-0.2956,-12.5000,115.9111,147.2089,1.27
Active,2020-06,50.6195,14.2857,167.618,228.6921,1.3644
Active,2020-07,12.5962,-25.0000,180.5938,265.6362,1.4709
Active,2020-08,2.6377,100.0000,191.6263,266.3737,1.3901
Active,2020-09,39.8974,16.6667,272.9557,367.7743,1.3474
Active,2020-10,-53.6076,-42.8571,120.5216,176.7283,1.4664
Active,2020-11,32.3061,50.0000,165.6398,227.6402,1.3743
Active,2020-12,77.8122,8.3333,303.3206,395.9794,1.3055
Active,2021-01,-10.7822,15.3846,251.9634,371.9366,1.4762
Active,2021-02,-9.3637,0.0000,233.977,331.503,1.4168
Active,2021-03,362.1543,26.6667,1132.5493,1480.8407,1.3075
Active,2021-04,-69.5786,15.7895,335.1348,459.8952,1.3723
Active,2021-05,-7.562,-18.1818,307.1734,427.7366,1.3925
Active,2021-06,77.189,27.7778,535.2447,766.9353,1.4329
Active,2021-07,-30.9366,-30.4348,362.0828,537.2472,1.4838
Active,2021-08,-60.0925,-37.5000,151.8259,207.0741,1.3639
Active,2021-09,-29.9638,-20.0000,109.7006,141.6594,1.2913
Active,2021-10,277.9838,137.5000,410.8918,539.2082,1.3123
Active,2021-11,-20.6315,5.2632,308.9792,445.1008,1.4406
Active,2021-12,51.3341,30.0000,482.2083,658.9717,1.3666
Blazers & Jackets,2019-06,,,18.1344,35.0456,1.9326
Blazers & Jackets,2019-07,368.2211,0.0000,84.411,164.589,1.9499
Blazers & Jackets,2019-09,-59.8594,100.0000,37.4962,62.4538,1.6656
Blazers & Jackets,2019-10,-76.9385,-50.0000,9.8884,13.1615,1.331
Blazers & Jackets,2019-11,-35.705,0.0000,6.2689,8.5511,1.3641
Blazers & Jackets,2019-12,1065.4521,100.0000,62.7063,110.0137,1.7544
Blazers & Jackets,2020-02,-69.6098,0.0000,21.1007,31.3893,1.4876
Blazers & Jackets,2020-03,234.5209,0.0000,61.5781,114.0119,1.8515
Blazers & Jackets,2020-04,-36.8301,50.0000,43.5621,67.3579,1.5463
Blazers & Jackets,2020-05,92.9679,-33.3333,91.0719,122.9681,1.3502
Blazers & Jackets,2020-06,17.9546,0.0000,90.5104,161.9597,1.7894
Blazers & Jackets,2020-07,-33.5683,100.0000,65.0179,102.7021,1.5796
Blazers & Jackets,2020-08,56.7315,-25.0000,101.2958,161.5742,1.5951
Blazers & Jackets,2020-09,50.0285,33.3333,142.4598,251.9202,1.7684
Blazers & Jackets,2020-10,65.1301,75.0000,241.9684,409.2716,1.6914
Blazers & Jackets,2020-11,-56.6826,-57.1429,114.0272,168.0728,1.474
Blazers & Jackets,2020-12,52.6374,0.0000,151.3935,279.1965,1.8442
Blazers & Jackets,2021-01,26.2965,66.6667,197.6773,346.1427,1.751
Blazers & Jackets,2021-02,-67.2631,-40.0000,63.2106,114.8194,1.8165
Blazers & Jackets,2021-03,169.4209,66.6667,171.7333,307.9167,1.793
Blazers & Jackets,2021-04,-64.6909,-20.0000,63.8525,105.5075,1.6524
Blazers & Jackets,2021-05,128.5309,50.0000,135.8033,251.2367,1.85
Blazers & Jackets,2021-06,184.3789,33.3333,420.6985,679.9615,1.6163
Blazers & Jackets,2021-07,-3.5697,12.5000,405.4678,655.9023,1.6176
Blazers & Jackets,2021-08,-28.0194,-44.4444,313.168,450.812,1.4395
Blazers & Jackets,2021-09,-36.73,80.0000,181.1554,302.2146,1.6683
Blazers & Jackets,2021-10,110.8447,-22.2222,384.2001,634.9599,1.6527
Blazers & Jackets,2021-11,-8.8063,0.0000,356.8534,572.5566,1.6045
Blazers & Jackets,2021-12,6.5977,0.0000,376.3628,614.3672,1.6324
Clothing Sets,2020-10,,,35.7985,19.1915,0.5361
Clothing Sets,2021-01,27.2777,0.0000,41.0841,28.9059,0.7036
Clothing Sets,2021-11,-28.5612,0.0000,32.9,17.1,0.5198
Clothing Sets,2021-12,18.0,0.0000,38.94,20.06,0.5152
Dresses,2019-05,,,30.4963,38.3537,1.2577
Dresses,2019-06,271.7938,0.0000,109.9554,146.0246,1.328
Dresses,2019-07,-84.3933,-50.0000,18.6567,21.2934,1.1413
Dresses,2019-08,0.0,0.0000,17.578,22.372,1.2727
Dresses,2019-09,168.1352,100.0000,47.4812,59.6387,1.256
Dresses,2019-10,191.8036,50.0000,138.1952,174.3848,1.2619
Dresses,2019-11,26.0413,0.0000,159.8482,234.1318,1.4647
Dresses,2019-12,50.3249,0.0000,268.9432,323.3068,1.2021
Dresses,2020-01,-98.1207,-66.6667,4.9974,6.1326,1.2272
Dresses,2020-02,3412.938,300.0000,179.7418,211.2482,1.1753
Dresses,2020-03,-77.759,-25.0000,36.6609,50.2992,1.372
Dresses,2020-04,250.138,33.3333,133.9169,170.5631,1.2736
Dresses,2020-05,97.5302,0.0000,283.2044,318.2356,1.1237
Dresses,2020-06,-49.29,0.0000,138.0005,166.9895,1.2101
Dresses,2020-07,60.5135,75.0000,212.9483,276.6017,1.2989
Dresses,2020-08,25.3355,-14.2857,266.925,346.655,1.2987
Dresses,2020-09,-28.6532,-16.6667,188.6976,249.0724,1.32
Dresses,2020-10,9.9664,120.0000,212.3117,269.0883,1.2674
Dresses,2020-11,-4.651,-36.3636,218.6085,240.4015,1.0997
Dresses,2020-12,17.5574,14.2857,250.3724,289.2276,1.1552
Dresses,2021-01,98.0115,50.0000,460.4427,608.0273,1.3205
Dresses,2021-02,-41.3086,-58.3333,299.7988,327.3012,1.0917
Dresses,2021-03,111.8721,160.0000,609.1539,719.4961,1.1811
Dresses,2021-04,-48.7126,-61.5385,321.6156,359.8144,1.1188
Dresses,2021-05,25.4362,140.0000,389.9619,464.7981,1.1919
Dresses,2021-06,-43.5573,-16.6667,209.2531,273.1969,1.3056
Dresses,2021-07,226.0296,20.0000,729.7207,843.2093,1.1555
Dresses,2021-08,-20.4783,-16.6667,583.1072,667.7129,1.1451
Dresses,2021-09,-9.5857,0.0000,510.9652,619.9548,1.2133
Dresses,2021-10,11.3279,50.0000,551.4583,707.5717,1.2831
Dresses,2021-11,-24.2147,-40.0000,432.3722,521.7878,1.2068
Dresses,2021-12,73.0622,77.7778,742.4716,908.8184,1.224
Fashion Hoodies & Sweatshirts,2019-02,,,230.1069,170.1631,0.7395
Fashion Hoodies & Sweatshirts,2019-04,-77.0405,-50.0000,51.973,39.927,0.7682
Fashion Hoodies & Sweatshirts,2019-06,75.3863,50.0000,88.0405,73.1395,0.8307
Fashion Hoodies & Sweatshirts,2019-07,86.7539,100.0000,156.3401,144.6699,0.9254
Fashion Hoodies & Sweatshirts,2019-08,16.3118,0.0000,183.6343,166.4757,0.9066
Fashion Hoodies & Sweatshirts,2019-09,9.1943,16.6667,203.3563,178.9437,0.88
Fashion Hoodies & Sweatshirts,2019-10,7.502,0.0000,207.9781,203.0019,0.9761
Fashion Hoodies & Sweatshirts,2019-11,44.4547,0.0000,321.8741,271.8059,0.8444
Fashion Hoodies & Sweatshirts,2019-12,-39.5398,0.0000,178.6497,180.2903,1.0092
Fashion Hoodies & Sweatshirts,2020-01,53.3014,71.4286,291.6905,258.5695,0.8865
Fashion Hoodies & Sweatshirts,2020-02,-21.7206,-25.0000,217.9156,212.8244,0.9766
Fashion Hoodies & Sweatshirts,2020-03,30.6635,22.2222,309.3265,253.4935,0.8195
Fashion Hoodies & Sweatshirts,2020-04,18.0289,9.0909,354.7976,309.4924,0.8723
Fashion Hoodies & Sweatshirts,2020-05,12.6902,-16.6667,373.5428,375.0472,1.004
Fashion Hoodies & Sweatshirts,2020-06,-38.145,0.0000,238.2739,224.7661,0.9433
Fashion Hoodies & Sweatshirts,2020-07,42.0396,20.0000,360.9201,296.7799,0.8223
Fashion Hoodies & Sweatshirts,2020-08,41.7865,41.6667,491.3257,441.2043,0.898
Fashion Hoodies & Sweatshirts,2020-09,109.6737,70.5882,1045.9829,909.287,0.8693
Fashion Hoodies & Sweatshirts,2020-10,-52.1718,-27.5862,479.7318,455.4382,0.9494
Fashion Hoodies & Sweatshirts,2020-11,-6.5272,-23.8095,443.9605,430.1695,0.9689
Fashion Hoodies & Sweatshirts,2020-12,54.7493,50.0000,682.4071,670.3029,0.9823
Fashion Hoodies & Sweatshirts,2021-01,-23.3272,-12.5000,531.7322,505.4278,0.9505
Fashion Hoodies & Sweatshirts,2021-02,-28.203,-28.5714,388.4146,356.2354,0.9172
Fashion Hoodies & Sweatshirts,2021-03,-1.0112,0.0000,374.6785,362.4416,0.9673
Fashion Hoodies & Sweatshirts,2021-04,13.1118,13.3333,428.483,405.2869,0.9459
Fashion Hoodies & Sweatshirts,2021-05,-21.0634,-29.4118,343.7689,314.3811,0.9145
Fashion Hoodies & Sw
Current sql:
WITH base_data AS (
    SELECT
        p."category",
        DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at" / 1000000)) AS "month",
        oi."sale_price",
        p."cost",
        oi."order_id",
        oi."product_id"
    FROM
        THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
    JOIN
        THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
        ON oi."product_id" = p."id"
    WHERE
        oi."status" = 'Complete'
        AND TO_TIMESTAMP(oi."delivered_at" / 1000000) < '2022-01-01'
        AND oi."delivered_at" IS NOT NULL
),
monthly_data AS (
    SELECT
        "category",
        "month",
        SUM("sale_price") AS total_revenue,
        COUNT(DISTINCT "order_id") AS total_orders,
        SUM("cost") AS total_cost,
        SUM("sale_price" - "cost") AS profit,
        CASE WHEN SUM("cost") <> 0 THEN SUM("sale_price" - "cost") / SUM("cost") ELSE NULL END AS profit_to_cost_ratio
    FROM
        base_data
    GROUP BY
        "category",
        "month"
),
final_data AS (
    SELECT
        "category",
        "month",
        total_revenue,
        total_orders,
        total_cost,
        profit,
        profit_to_cost_ratio,
        LAG(total_revenue) OVER (PARTITION BY "category" ORDER BY "month") AS previous_revenue,
        LAG(total_orders) OVER (PARTITION BY "category" ORDER BY "month") AS previous_orders
    FROM
        monthly_data
)
SELECT
    "category" AS Product_Category,
    TO_CHAR("month", 'YYYY-MM') AS "Month",
    ROUND(((total_revenue - previous_revenue) / NULLIF(previous_revenue, 0)) * 100, 4) AS "Revenue_Growth(%)",
    ROUND(((total_orders - previous_orders) / NULLIF(previous_orders, 0)) * 100, 4) AS "Orders_Growth(%)",
    ROUND(total_cost, 4) AS Total_Cost,
    ROUND(profit, 4) AS Profit,
    ROUND(profit_to_cost_ratio, 4) AS Profit_to_Cost_Ratio
FROM
    final_data
ORDER BY
    "category",
    "month";
2025-01-26 08:23:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 08:23:01 - root - INFO - ```sql
WITH base_data AS (
    SELECT
        p."category",
        DATE_TRUNC('month', TO_TIMESTAMP(oi."created_at" / 1000000)) AS "month",
        oi."sale_price",
        p."cost",
        oi."order_id",
        oi."product_id"
    FROM
        THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."ORDER_ITEMS" oi
    JOIN
        THELOOK_ECOMMERCE.THELOOK_ECOMMERCE."PRODUCTS" p
        ON oi."product_id" = p."id"
    WHERE
        oi."status" = 'Complete'
        AND TO_TIMESTAMP(oi."delivered_at" / 1000000) < '2022-01-01'
        AND oi."delivered_at" IS NOT NULL
),
monthly_data AS (
    SELECT
        "category",
        "month",
        SUM("sale_price") AS total_revenue,
        COUNT(DISTINCT "order_id") AS total_orders,
        SUM("cost") AS total_cost,
        SUM("sale_price" - "cost") AS profit,
        CASE WHEN SUM("cost") <> 0 THEN SUM("sale_price" - "cost") / SUM("cost") ELSE NULL END AS profit_to_cost_ratio
    FROM
        base_data
    GROUP BY
        "category",
        "month"
),
final_data AS (
    SELECT
        "category",
        "month",
        total_revenue,
        total_orders,
        total_cost,
        profit,
        profit_to_cost_ratio,
        LAG(total_revenue) OVER (PARTITION BY "category" ORDER BY "month") AS previous_revenue,
        LAG(total_orders) OVER (PARTITION BY "category" ORDER BY "month") AS previous_orders
    FROM
        monthly_data
)
SELECT
    "category" AS Product_Category,
    TO_CHAR("month", 'YYYY-MM') AS "Month",
    ROUND(((total_revenue - previous_revenue) / NULLIF(previous_revenue, 0)) * 100, 4) AS "Revenue_Growth(%)",
    ROUND(((total_orders - previous_orders) / NULLIF(previous_orders, 0)) * 100, 4) AS "Orders_Growth(%)",
    ROUND(total_cost, 4) AS Total_Cost,
    ROUND(profit, 4) AS Profit,
    ROUND(profit_to_cost_ratio, 4) AS Profit_to_Cost_Ratio
FROM
    final_data
ORDER BY
    "category",
    "month";
```
2025-01-26 08:23:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 08:23:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 08:23:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 08:23:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 796
2025-01-26 08:23:03 - snowflake.connector.connection - INFO - closed
2025-01-26 08:23:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 08:23:03 - root - INFO - itercount: 3
2025-01-26 08:23:03 - root - INFO - 0
2025-01-26 08:23:04 - root - INFO - Total iteration counts: 3
