SELECT
    s."DATE" AS "Date",
    s."ASIN",
    p."PRODUCT_TITLE" AS "Product_Title",
    s."ORDERED_UNITS",
    ROUND(s."ORDERED_REVENUE", 4) AS "Ordered_Revenue",
    ROUND(s."ORDERED_REVENUE" / NULLIF(s."ORDERED_UNITS", 0), 4) AS "Average_Selling_Price_ASP",
    t."GLANCE_VIEWS",
    ROUND(s."ORDERED_UNITS" / NULLIF(t."GLANCE_VIEWS", 0), 4) AS "Conversion_Rate",
    s."SHIPPED_UNITS",
    ROUND(s."SHIPPED_REVENUE", 4) AS "Shipped_Revenue",
    ROUND(n."NET_PPM", 4) AS "Net_Profit_Margin_PPM",
    CONCAT('Sellable Units: ', COALESCE(i."SELLABLE_ON_HAND_UNITS", 0), ', Unsellable Units: ', COALESCE(i."UNSELLABLE_ON_HAND_UNITS", 0)) AS "Inventory_Details"
FROM 
    AMAZON_VENDOR_ANALYTICS__SAMPLE_DATASET.PUBLIC.RETAIL_ANALYTICS_SALES s
LEFT JOIN 
    AMAZON_VENDOR_ANALYTICS__SAMPLE_DATASET.PUBLIC.PRODUCT_CATALOG p
    ON s."ASIN" = p."ASIN"
LEFT JOIN 
    AMAZON_VENDOR_ANALYTICS__SAMPLE_DATASET.PUBLIC.RETAIL_ANALYTICS_TRAFFIC t
    ON s."ASIN" = t."ASIN" AND s."DATE" = t."DATE"
LEFT JOIN 
    AMAZON_VENDOR_ANALYTICS__SAMPLE_DATASET.PUBLIC.RETAIL_ANALYTICS_NET_PPM n
    ON s."ASIN" = n."ASIN" AND s."DATE" = n."DATE"
LEFT JOIN 
    AMAZON_VENDOR_ANALYTICS__SAMPLE_DATASET.PUBLIC.RETAIL_ANALYTICS_INVENTORY i
    ON s."ASIN" = i."ASIN" AND s."DATE" = i."DATE"
WHERE 
    s."DISTRIBUTOR_VIEW" = 'Manufacturing'
    AND s."DATE" BETWEEN '2022-01-07' AND '2022-02-06'