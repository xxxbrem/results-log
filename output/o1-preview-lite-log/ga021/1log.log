2025-01-30 00:33:20 - openai._base_client - INFO - Retrying request to /chat/completions in 0.487731 seconds
2025-01-30 00:34:16 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 00:34:22 - root - INFO - SQL:
SELECT DISTINCT `event_name` 
    FROM `firebase-public-project.analytics_153293282.events_*`
    LIMIT 100;
Results:
event_name
level_retry_quickplay
use_extra_steps
app_remove
app_clear_data
dynamic_link_first_open
level_fail_quickplay
user_engagement
completed_5_levels
os_update
in_app_purchase
level_complete
level_reset
firebase_campaign
challenge_accepted
ad_reward
challenge_a_friend
spend_virtual_currency
first_open
level_start
level_end
level_end_quickplay
level_reset_quickplay
app_update
dynamic_link_app_open
notification_foreground
screen_view
post_score
level_start_quickplay
level_fail
level_up
level_retry
app_exception
no_more_extra_steps
error
level_complete_quickplay
session_start
select_content

2025-01-30 00:34:29 - root - INFO - SQL:
SELECT DISTINCT `user_pseudo_id` 
    FROM `firebase-public-project.analytics_153293282.events_*` 
    WHERE `event_name` = 'session_start' 
      AND `event_date` BETWEEN '20180702' AND '20180716'
    LIMIT 100;
Results:
user_pseudo_id
9603F4B5ABFC1E48B0BF68C83669F845
5631892AB2E836FD3A72540D3C316C51
71746D859E4E6D655FEE8FFBC3B6C7E9
079E84FBF40BA6D3E74C7E61A7BD4F91
38DEEAB5F723A89A66CF180A175808D5
734AC9568F0674F7BBE59D45B5B90EA7
EF1CF9C1C84826BE2985E02194F65C38
22A78172D80C16E12B45C62A746F1461
48EA1B5A51811D700199781B10C48121
D9FEC4E4418413FCE771B203FD7D48D2
6B07E90CD14662B55877A7CBC80A1133
3E5E7324D21924DA3A6BE8E817B3C5FE
DA48D36D07835B1918BDF831AF83B5EF
F99CC3598522ABE54B9DCAC2969179CC
CA51DAF1373B5C2A16C174AFBD2132A4
28AA4A0542C8873691715C284D13C34B
FCA08F9B0DCB6E33A74F672CE7F73BE3
B6BA0A7B30C70EE6C34956C88563B361
2C33E7A3E02384439F6F3A61AE37D6AE
04D1448BED7366A1CACEDA442F7A18D8
FB06AF1BD3F3737D1FF77A949823A580
44759496F6F519B1A4BEF55BE55C631C
9EEE374E4BE34101A39330BD8191446A
96710B78A294951BF7CDEA5BBEE15766
751F1516AC974AC343F62070D3BA39F5
CB2A03B9DC1894380C75344D15BC0BE6
6CC62DC4D07B240209DC6837340DDF9F
0F67E233B19D2898229CD156974A93AE
4BF98D09CA8359FC59ADAF56D00338F8
3DC258E32531148709A4BF575C0F076E
68EA8FDC3D7F8984530BB60FAE9A42FD
05F7B2C58D627CE948B06C10E39CDF91
54827B02505D08E40E29E608008431B4
7842C62D45ECE888132F21C9F4417B21
9542C5C6A8B0B9CA47A82C94208FDC7E
E6FD2A5EF0543141D34A92D5BE0C2CCC
2684EA4DDB1F988E3C979AB15CFF601F
4193343164266373A13B35D5D04053E2
7507B0AA39479D2DB533FDDF9E12DB98
13BC94A3DC715A7CF8DB34C820766E27
030D58D3258598A9563844AD6A28FA61
012A1B5594934B98BD38FDD68C560702
94E691DE59E7A869E02CCC207D0EB360
5E09265F12D64B9FA85FF9427A0A7FB0
FB581F2AC74E08CD38CCAAA9A99F0217
09CAEE95CE99F27D00EA630EEDBCECA2
A3D25F3FA1983C40DE78BD7B05CEBAD0
58613864711355CE99E999ED2B37A963
81BFFE61CAB181676917D75F1B617CB2
0046A2D1B1135C0AB4462B8FF036739E
FC2C90CE72B673FDFFC262F04C817C53
CC88655DF7CDE5E8225BA20B5D6EC59B
018F03084C88E944163F76A0D0C2FBA1
4AB1C9375139B1C30ED33E1D29F0E7AA
2039439F42FBFE73F7FFB4B1637776D5
EBC3581ADA874D494FBE2C7CCF53BF99
3D2787408CD80B30103939EB61746866
F6EB4832FA8E8C989D1A6EA0A15312FF
5800569BC32997BCE5774BA3C675C4E4
F1F2C328BF34010DBA50842CA03956E2
A5EF117D3FA84DCA56D332FE725BF4D7
261F6186CC817A991565A91C4C92CAFA
88BA2493921D796D2E246973E3E9774B
22DC6A6AE86C0AA33EBB8C3164A26925
CD4078C6EC791735D5402B2A3793D2FF
BCD37BC09EFDBC9BEEE314EBBF815D01
54B8D30BE1F3471830044059A37419F6
2F5BBABE9DD0271DCD62E501F76DA736
7E438E53A94A9E6EA6531E272C86F512
CF06C47EAD622F909BFCC83FF4D0ECE8
AD4F00389084ECC4B5362689C228EB0F
3422CA1B4B6A9ACE78187868F362C3C7
812A0C9302E7E1A711B416C0904C99CD
6BFD3E06D9C82ACB070A6C891A6AE15D
9373B5D36107012F6F9137090C523FA1
C7BDDD0BAC5D80E447FCDD12A580273E
6EDF43D6306C4F1CE0500424B27F6411
2E03DB1924573F3131EEC916E5444F56
1F25763EC8BCAEC7FB069E81659A2153
570495249052C5E40EC34A2B054DA1A1
1406751556EEDB1D112BF86CACAE9C88
D8A4973047AF2FA8E9061F6F52E6BD61
BD23A737D75442D2C32CE2259D15D624
537B074515EB8F5DDF89269910D94309
5B888A06EFF60B86B10367EEC3B44E85
E270414CD8C904F7BB039FB243540B3E
DFC2120907EE81E1836E3A9E257498C9
C95B2A35A6BC7C94839B2FF05FE914CF
7410C5CC4FA11D31DB5F9B1D8ECD6BD0
535B3809F6411A9F8FB0B2C78CE59284
711364F41553811B33FD216391234D59
DF7B1F6B6AEF483760B6439EF91BC26A
75C683C1AE98FC6CCE6EA156C9E90A35

2025-01-30 00:35:26 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 00:35:26 - root - INFO - ```sql
SELECT DISTINCT ep.value.string_value AS quickplay_type
FROM `firebase-public-project.analytics_153293282.events_*`, UNNEST(`event_params`) AS ep
WHERE `event_name` = 'quickplay'
  AND ep.key = 'quickplay_type'
LIMIT 100;
```
2025-01-30 00:36:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 00:36:17 - root - INFO - ```sql
SELECT DISTINCT ep.value.string_value AS quickplay_type
FROM `firebase-public-project.analytics_153293282.events_*`, UNNEST(`event_params`) AS ep
WHERE `event_name` LIKE '%quickplay%'
  AND ep.key = 'level_name'
LIMIT 100;
```
2025-01-30 00:36:47 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 00:36:47 - root - INFO - ```sql
SELECT DISTINCT `event_name` AS quickplay_event_type
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` LIKE '%quickplay%'
LIMIT 100;
```
2025-01-30 00:37:53 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 00:37:53 - root - INFO - SQL:
SELECT DISTINCT `event_name` AS quickplay_event_type
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` LIKE '%quickplay%'
LIMIT 100;
Results:
quickplay_event_type
level_complete_quickplay
level_start_quickplay
level_fail_quickplay
level_end_quickplay
level_reset_quickplay
level_retry_quickplay

2025-01-30 00:38:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 00:38:14 - root - INFO - I apologize for the error. The issue is that the numbering (e.g., `1)`) was included inside the SQL code blocks, causing syntax errors when running the queries.

Here are the corrected SQL queries without the numbering inside the code blocks:

1)

```sql
SELECT DISTINCT ep.key
FROM `firebase-public-project.analytics_153293282.events_*`, UNNEST(`event_params`) AS ep
WHERE `event_name` LIKE '%quickplay%'
  AND `event_date` BETWEEN '20180702' AND '20180716'
LIMIT 100;
```

2)

```sql
SELECT DISTINCT ep.value.string_value AS level_name
FROM `firebase-public-project.analytics_153293282.events_*`, UNNEST(`event_params`) AS ep
WHERE `event_name` LIKE '%quickplay%'
  AND `event_date` BETWEEN '20180702' AND '20180716'
  AND ep.key = 'level_name'
LIMIT 100;
```

3)

```sql
SELECT ep.value.string_value AS level_name, COUNT(*) AS event_count
FROM `firebase-public-project.analytics_153293282.events_*`, UNNEST(`event_params`) AS ep
WHERE `event_name` LIKE '%quickplay%'
  AND `event_date` BETWEEN '20180702' AND '20180716'
  AND ep.key = 'level_name'
GROUP BY level_name
LIMIT 100;
```

4)

```sql
SELECT `user_pseudo_id`, MIN(`event_timestamp`) AS first_quickplay_timestamp
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` LIKE '%quickplay%'
  AND `event_date` BETWEEN '20180702' AND '20180716'
GROUP BY `user_pseudo_id`
LIMIT 100;
```

5)

```sql
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` LIKE '%quickplay%'
  AND `event_date` > '20180716'
LIMIT 100;
```

6)

```sql
SELECT `user_pseudo_id`, COUNT(*) AS event_count
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` LIKE '%quickplay%'
  AND `event_date` > '20180716'
GROUP BY `user_pseudo_id`
LIMIT 100;
```

7)

```sql
SELECT `user_pseudo_id`, `event_date`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` LIKE '%quickplay%'
  AND `event_date` > '20180716'
ORDER BY `user_pseudo_id`, `event_date`
LIMIT 100;
```

These corrected queries should run without syntax errors. Please let me know if you encounter any other issues or need further assistance.
2025-01-30 00:39:06 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 00:39:06 - root - INFO - SQL:
SELECT DISTINCT ep.key
FROM `firebase-public-project.analytics_153293282.events_*`, UNNEST(`event_params`) AS ep
WHERE `event_name` LIKE '%quickplay%'
  AND `event_date` BETWEEN '20180702' AND '20180716'
LIMIT 100;
Results:
key
board
firebase_screen_class
value
firebase_screen_id
firebase_event_origin

2025-01-30 00:39:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 00:39:56 - root - INFO - ```sql
SELECT DISTINCT ep.key
FROM `firebase-public-project.analytics_153293282.events_*`, UNNEST(`event_params`) AS ep
WHERE `event_name` LIKE '%quickplay%'
LIMIT 100;
```
2025-01-30 00:40:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 00:40:38 - root - INFO - SQL:
SELECT DISTINCT ep.key
FROM `firebase-public-project.analytics_153293282.events_*`, UNNEST(`event_params`) AS ep
WHERE `event_name` LIKE '%quickplay%'
LIMIT 100;
Results:
key
firebase_screen_class
board
firebase_screen_id
value
firebase_event_origin

2025-01-30 00:41:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 00:41:22 - root - INFO - ```sql
SELECT DISTINCT ep.key
FROM `firebase-public-project.analytics_153293282.events_*`, UNNEST(`event_params`) AS ep
LIMIT 100;
```
2025-01-30 00:42:18 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 00:42:18 - root - INFO - SQL:
SELECT DISTINCT ep.key
FROM `firebase-public-project.analytics_153293282.events_*`, UNNEST(`event_params`) AS ep
LIMIT 100;
Results:
key
firebase_screen_class
level
product_id
update_with_analytics
campaign
firebase_screen_id
timestamp
quantity
previous_app_version
message_name
firebase_error
dynamic_link_link_id
validated
board
firebase_previous_class
item_id
message_id
firebase_event_origin
score
level_name
dynamic_link_link_name
ad_event_id
price
previous_first_open_count
value
firebase_conversion
type
product_name
click_timestamp
firebase_previous_id
time
item_name
previous_os_version
source
medium
firebase_screen
dynamic_link_accept_time
engagement_time_msec
fatal
firebase_previous_screen
system_app_update
message_time
content_type
ad_unit_code
currency
message_device_time
virtual_currency_name
gclid
error_value
system_app
term
content

2025-01-30 00:42:25 - root - INFO - SQL:
SELECT `user_pseudo_id`, MIN(`event_timestamp`) AS first_quickplay_timestamp
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` IN (
    'level_start_quickplay',
    'level_complete_quickplay',
    'level_fail_quickplay',
    'level_end_quickplay',
    'level_reset_quickplay',
    'level_retry_quickplay'
)
GROUP BY `user_pseudo_id`
LIMIT 100
Results:
user_pseudo_id,first_quickplay_timestamp
C57026026F451C8B63B19481023BE944,1529358529943007
309D006B3FE6151EE530B0C6A79CFA11,1528820185474007
77F297ECE32E4728993468CE558B9AFE,1529948962888008
6F0928CF979D92A11C602CB5EFA37F49,1528819296461006
244301BD63080095E545DC9446957C57,1537081960787011
A66E12586B3B31AAEF02D1B1DD09EFDF,1533566684914004
82C61B1EAAF07052E9ADAABB8137D220,1537622340657014
060ADA8C8F2558D7C9AC00CA15B84DB3,1536343687995007
52674FCAD5A82E22BFA5EB24BDB2ED99,1536096341004007
92BA07C5AF1103CDD804CDA9F7199B95,1537628275575002
EC65A4E9E110812FCB0654E5783D0ED1,1530422838848001
69495B8489F605F197D1E8697BCBF02B,1532308588095006
FF2667B2C3C60D19E7B7D63C99BB4CAA,1529760023759004
B5D5EECC05D20983F8E3729AFD3295C6,1537853326810008
FE47196822AB89CCE12396BBB50306A3,1537202458646009
13F23FAD6BD15A62B3E2D32E1F117BB3,1537772289212001
DB26CECA494F76A0F55941026125C0DB,1529941500674009
AF7F48274AA5128EBCF3698F4FC8F61B,1536890270992008
C139256BC6B95411865D96398AAC81B2,1530221469710004
0F1B0F6CA38544C25AF8F668E7BED38A,1528853903861008
F505D39D04A5141F7A113A0AE18B0475,1536128006558019
1386E5CC85E430BBC566EC1019DC3C32,1536088979210008
1762CA37B5E74A04C62CFEE59A9A5111,1529032805039007
81FBBC1EAB021C62534AB79EACEC0501,1529170642356011
15DEF8BA7C049332809AAAF77295F3A8,1529395991581000
136C3AB6E42E34223C8A7503EE355E12,1528814478848007
135BE5A161033D5A7BC7A0A8F4C80ACE,1528826879642008
0A367084F9CA18D023CF9A8B8FF81905,1528839601947007
8FA32288838A699CAD94D57C8B3F7EF1,1537846512199009
186F51E5AACB37852E3650E7027E33B1,1535049911899005
ED589AAA205D32DDAC8B10CD75E5E968,1537774107902002
48AB910A8DE8485D4C34238EA61F782C,1529095336694008
7BD09067E1183BA65712D575B62685D3,1535893195919004
959635567E419A061EECCCA478EDC718,1531167822104079
18E3B6030C95894AA0147632DC697D0E,1537784592212011
584D2E4F744800A59C8C3F3AC63B675E,1528857062611001
48C8A04DA2A666406E943C164A94D0B3,1529339272044007
59454BAC415BB1F18517C6FD2C023E49,1528796451274008
AE55489045EA81B6DBB191298D293184,1536304635482008
A81D28013F1A7D03564C48121CE3D1FA,1537258633796009
E5A2CB7A471E740E758BE5E2E0C79BC2,1529314829280008
49CF61B01BD5584B86EFC08E40F6EB03,1529362603985010
8BD465AC77DC9D8B4C597BF35950FDA3,1529306310567012
6722ACD286AC0F5CA22E745302CAEB89,1535497469181004
2741C47CC50AE98B39CC5B561BFEA504,1528855627108010
635808C1DDFBC662DC3015097E26E62A,1532435806656000
D299D5763E03F1CC4DA8550AF1B4CEE4,1529660712468001
1C679E92B10C3EEDDD36467BE24D7449,1529423163702065
8A315264BC7C1FAA87051112FD46F3D4,1529352463152009
E6B92CC2D56E83206D33E752DADEAB5C,1529698650642007

2025-01-30 00:42:31 - root - INFO - SQL:
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` IN (
    'level_start_quickplay',
    'level_complete_quickplay',
    'level_fail_quickplay',
    'level_end_quickplay',
    'level_reset_quickplay',
    'level_retry_quickplay'
)
LIMIT 100
Results:
user_pseudo_id
BB262970AF9A445625B2D6D3F76AD327
88A41BFED275BB69125BE1F5524F3B42
E512079B53179DF9A608CF4ADE47DE9D
98578513E0F25350F961CDCBA9D3656F
3A2180BCAA45AB7675057130B18F8522
8C7A0CAF2B29D568268B8D331E37ABF6
F0FC99F563E1247AD70240E5AA132ABF
1B3AD9683D475EFB398E131DFE65AE61
8D08248A4E1A8D0A7D0101CC99A98AD0
898B790ACC7834117A9B2C98A8B6F1F5
C6111251D5DB67692ABDD1D54BA056AF
36390262EE0C669101AD7ACFE181689C
E9DCE2D958652BD58E846DCE86BDD90A
2927B0054220D4D4565BD60B590F82B0
F212EF8CB9E42FEF69DB0D970EFA5939
EEBCB25D5F056CCF59DDE654388ACD2B
488BE19C45D3D8B2DF02214BC19B44B4
CFB69F749BBDFB928C7E83704070B1A3
17636078D57884AD7EA5406C60E2BD10
4D6582BFA74C0705C44ED36CCB8CE527
BDCFD1F0FDE47E594874CA47CD49C303
CCC7BB053BBC6824C53FAA4A8C63E3FE
C4D21EF78D8A4B00805216847EBCAFBB
6F5FF93E2A273D4D80B6A21BE014217A
63550F65F0818B874ADA2B18C463AB21
C3E3CDDD1E35362AA59854F8FA511BB0
87B1F896770D48526901F75489E30535
108D09DB520942B16C86056E4F92D707
5A976ACE1440285CDDFF5377299D13D3
5BA23094CD864C7FB5265F83652FA028
136F2C0A18FA7D6A967EEBDC2C7E3346
E8950841C7635FFAE97EE03DE2A92072
37DEF17DD3761C66B7F56806F978E726
717914316B7E4BD629C168B3A05634DC
FB149ABD1F42826AA82A9D0D3FB03342
B711923F02FB2923F0A4DBC8CA2CE3AD
27FAC926A196086540A33D26831E5D18
AC84CEAED9C93CFA450E22E735D19F1D
47641CFD956212B88DE89050A1218D3E
7B4884B8AA78518C3EC6B4B3FECD526E
B36FAA12AF854F00E4EC23696D2786CC
32DEB1F24ABD2430CC3EB1A917D1DD77
72556FDF7DF77445D94FB19C87334F1D
E642A5334B708A0A18F5590AB4554780
96D78D93EA38723BCFD4AAAEE9DC6ACD
F73A0D4A6FB35C664DDAE0F4F145F8B0
E676E450E4EF9C561937FBB18A52C237
0B80FE0B9AF69F6B040D6F48FFEB8A8B
00F541FA1C141575D0AD7048F809CC6E
46CAF574E4F98302ED5E559FED2EA454
7CE5EA721C3169E682540F2C897A3904
247B17FFC9A82C34B999CFBDA295584F
8DD47B40A0938BA8BD9FF0B34D83B28E
2DE9CB964C424DB7C1B6DE60E1C6A108
A51BF75239709A5494645BEAABC3453D
EACCA0856B7B7B2AEC2CB1808C1034E5
5FFBFE051291F79717B99F5D72B02CDC
35CF08DA631AC27582D6A0FE710131F7
BFC4C22D2C9FF3D314BC4F1D86E92044
31E8B3EB3D9167E813FDFB812898F2F6
7DBEEB7A2488FE1FFC0808686AC09606
4EBC9E555CE3316055264858BF18DB51
4789C778386485B99F4077B97DFE34E3
9B18A1CBA96D52D05CFA7CB7C9011EDE
9A9023B132EB5D23ED8B335C90E7D28A
1C65943AF5217570A2E4D9B58B6E6FC4
0A9710D5EF9520ED2030965DE41E7436
55EEC95A163C7791E528B12D5FA32CA9
487DE902636DD8A9844A2D61FE7BD568
9BD663F05EA7660B40800C28E2BF59FC
01C784BDB7AF4DC8DAD6DCD21AF56E25
99ED19E25F424068C78C51C1C51F9E3C
AD8EC45CB90A8CEFC376341115A6E1E7
B7706BCDE12360F565E9F5DB0A5256D8
A0903E7042C13251799B68B16FD1EBA6
A1927ED722EA16A3B82E7EE0FA22FF4F
CD86D0CCD91B43EA8B6FBAD81378AB5B
DCF02493CA8559E632F3E2FB070DBEF0
EBE661044C1949546986A852F35083A1
9C2E5AEEBFD459AD8112A26F015C8D8C
01A2CCF65B4BB5DF87B1F9177616C5AF
5F99FAB2A6750F6391E248AF619389AA
2F0F260BD7B876C346B41977D0D03D62
920DB84FCC0F4421650B9E257E33180B
535852E6378668E758A59C4FD24F14D4
4CC453DA57531954D7C053B93A20B5D0
53B99AF8D463E4FB9FA1DD1D94043B9D
9A12E7E2B3CF644B8304DF8E1A9CE2D8
8FAD3B149C27A6E915B1404A00DD08A0
B909E553481A3C9AD11258FBF6200D66
24D41A78A6BB1244608DB32351B0658B
D1A34C0FAE2F326F2C050020A3B990C5
B24F51D3B429580F5C4FF054CE98FC41

2025-01-30 00:42:37 - root - INFO - SQL:
SELECT `user_pseudo_id`, COUNT(*) AS event_count
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` IN (
    'level_start_quickplay',
    'level_complete_quickplay',
    'level_fail_quickplay',
    'level_end_quickplay',
    'level_reset_quickplay',
    'level_retry_quickplay'
)
GROUP BY `user_pseudo_id`
LIMIT 100
Results:
user_pseudo_id,event_count
487DE902636DD8A9844A2D61FE7BD568,2486
2F0F260BD7B876C346B41977D0D03D62,353
734ADBB5D0874A5007E58B2F99625EE0,82
4FAE9F054706890DC522E924EBF17286,316
898B790ACC7834117A9B2C98A8B6F1F5,1607
C5788CC4CA50494F16D5CE2F5B913078,1
A91AAEDD376FE48EA2866594A13C5C2E,4
36390262EE0C669101AD7ACFE181689C,260
DF2C3B7E8FB37490F6F265867863951C,42
213F7CCE718883579D85966F63301ADD,213
FB149ABD1F42826AA82A9D0D3FB03342,513
31E8B3EB3D9167E813FDFB812898F2F6,59
5BDEA4C55EFDF16308475E1ACA152767,30
8802C1F08F68501AB77C5097CD19CE1A,19790
A0BD8C1DC54A57DAD494FB3941800B9D,36
EEBCB25D5F056CCF59DDE654388ACD2B,784
879503A3ED5F2DCB6592E99C42E1BDFE,196
075EBEDBF28134BE41FB4E7D943F858C,352
CD86D0CCD91B43EA8B6FBAD81378AB5B,66
6A8061EE9C5A6A6A48545DA3A6713C0A,49
41CA0FA528C7227EA1E592DCC4733C40,1066
51861EE26D72E3AC5B5E6A3396CA7E78,11
ADBF591A2A1DE60915F718F8FD6ED4C1,5
DCF02493CA8559E632F3E2FB070DBEF0,73
38383D77F69C1CAA39B0CAC891CB0E0B,142
EBE661044C1949546986A852F35083A1,542
B5F3D00E28A57C9522F2DEE3CB903DD1,910
45EB0927832513B89E58E6C6C93D841C,64
2927B0054220D4D4565BD60B590F82B0,1370
5A06B4FB19BFBF838B73B57297121379,333
B32B9B49419747FED767C4942DA42EFB,16
E512079B53179DF9A608CF4ADE47DE9D,962
98578513E0F25350F961CDCBA9D3656F,204
537BF60056C260DCA1ADB5CD1824383A,12
29CC43D76ACDDDC0A3D9F640532B7D27,3
F7C189BBD2C256AE9A6745443DBE891D,11
5FFBFE051291F79717B99F5D72B02CDC,20
35CF08DA631AC27582D6A0FE710131F7,171
1B959D672ABAE4A3BFB9D720D415E064,5
9A12E7E2B3CF644B8304DF8E1A9CE2D8,755
2344AFC9EF64F71D5500B8390FD997C6,1
5ACD59093D1C49F2EADAE29D7181A9CF,1
83EB6E905B20079A153828894109C0FF,16
3A2180BCAA45AB7675057130B18F8522,68
41F6537F5D6EB1798536910D0722A344,32
AAADF44F1C6A57099FEF88D15C7CF64D,673
4FCB0434161F0EE1E92046C850A90DD1,5
55EEC95A163C7791E528B12D5FA32CA9,125
9BD663F05EA7660B40800C28E2BF59FC,148
528939A93F1D3693AD8A56F340B7D777,32
E9B766FA2D5B25A0E71F4A023F2BE733,35
AD8EC45CB90A8CEFC376341115A6E1E7,38
B7706BCDE12360F565E9F5DB0A5256D8,554
71770AF53DC5204BBCE3B7DB7EB9CDAC,6
E53BC2A0AD86417B443AF14EE3082C0F,1118
11FCE87078342891B101FE7F59E76347,47
6B08E53DCB961355CFDD135921EF13BC,1
36C32F82A22E7DC2DB04DA29BF71199F,9
17636078D57884AD7EA5406C60E2BD10,557
2AC0EF5047BC538BDA6388E644409B5D,107
24D41A78A6BB1244608DB32351B0658B,49
F0945E5A97F876E9C084AC260BA4A6F1,5
0FD8410E5528FC512E551697BB8911C8,93
1C65943AF5217570A2E4D9B58B6E6FC4,165
D1A34C0FAE2F326F2C050020A3B990C5,2
91F5161F80D1083CA7B37A08DEC9EC78,91
805F3B2AC44D55805F8B5C1660A15CFF,7
CAC12C9CF0AD0E78C9679E12A7425625,21
D2FA501819D653CF9B408901BADDE2BA,10

2025-01-30 00:42:50 - root - INFO - SQL:
SELECT `user_pseudo_id`, `event_date`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` IN (
    'level_start_quickplay',
    'level_complete_quickplay',
    'level_fail_quickplay',
    'level_end_quickplay',
    'level_reset_quickplay',
    'level_retry_quickplay'
)
ORDER BY `user_pseudo_id`, `event_date`
LIMIT 100
Results:
user_pseudo_id,event_date
0005E3C4A38470408E9FFE32F1FD1A13,20180915
0005E3C4A38470408E9FFE32F1FD1A13,20180915
0005E3C4A38470408E9FFE32F1FD1A13,20180915
0007A96FEDC18F960EF004FCCB5FB41C,20180813
0007A96FEDC18F960EF004FCCB5FB41C,20180821
0007A96FEDC18F960EF004FCCB5FB41C,20180821
0007A96FEDC18F960EF004FCCB5FB41C,20180821
000A8B9167F5F9B7BF620708D320E32F,20180725
000A8B9167F5F9B7BF620708D320E32F,20180725
000A8B9167F5F9B7BF620708D320E32F,20180725
000A8B9167F5F9B7BF620708D320E32F,20180725
000A8B9167F5F9B7BF620708D320E32F,20180725
000A8B9167F5F9B7BF620708D320E32F,20180725
000A8B9167F5F9B7BF620708D320E32F,20180725
000A8B9167F5F9B7BF620708D320E32F,20180725
000A8B9167F5F9B7BF620708D320E32F,20180725
000A8B9167F5F9B7BF620708D320E32F,20180725
000F49564E9F2B85F3B1AF1A0DDCB872,20180726
000F49564E9F2B85F3B1AF1A0DDCB872,20180726
000F49564E9F2B85F3B1AF1A0DDCB872,20180726
000F49564E9F2B85F3B1AF1A0DDCB872,20180817
001373EB022B5377FD914A42CFF11F38,20180612
001373EB022B5377FD914A42CFF11F38,20180612
001373EB022B5377FD914A42CFF11F38,20180612
001373EB022B5377FD914A42CFF11F38,20180613
001373EB022B5377FD914A42CFF11F38,20180613
001373EB022B5377FD914A42CFF11F38,20180613
0014DFDE712A8A42EE68057DD4062E42,20180612
0014DFDE712A8A42EE68057DD4062E42,20180612
0014DFDE712A8A42EE68057DD4062E42,20180612
0014DFDE712A8A42EE68057DD4062E42,20180612
0014DFDE712A8A42EE68057DD4062E42,20180613
0014DFDE712A8A42EE68057DD4062E42,20180613
0014DFDE712A8A42EE68057DD4062E42,20180613
0014DFDE712A8A42EE68057DD4062E42,20180614
0014DFDE712A8A42EE68057DD4062E42,20180614
0014DFDE712A8A42EE68057DD4062E42,20180614
0014DFDE712A8A42EE68057DD4062E42,20180615
0014DFDE712A8A42EE68057DD4062E42,20180616
0014DFDE712A8A42EE68057DD4062E42,20180616
0014DFDE712A8A42EE68057DD4062E42,20180616
0014DFDE712A8A42EE68057DD4062E42,20180617
0014DFDE712A8A42EE68057DD4062E42,20180617
0014DFDE712A8A42EE68057DD4062E42,20180617
0014DFDE712A8A42EE68057DD4062E42,20180625
0014DFDE712A8A42EE68057DD4062E42,20180625
0014DFDE712A8A42EE68057DD4062E42,20180626
0014DFDE712A8A42EE68057DD4062E42,20180626
0014DFDE712A8A42EE68057DD4062E42,20180628
0014DFDE712A8A42EE68057DD4062E42,20180628
0014DFDE712A8A42EE68057DD4062E42,20180915
0014DFDE712A8A42EE68057DD4062E42,20180915
0014DFDE712A8A42EE68057DD4062E42,20180915
0015EE183D5A306035B51F4F6CE1E6FE,20180808
0015EE183D5A306035B51F4F6CE1E6FE,20180808
0015EE183D5A306035B51F4F6CE1E6FE,20180808
0015EE183D5A306035B51F4F6CE1E6FE,20180808
0015EE183D5A306035B51F4F6CE1E6FE,20180808
0015EE183D5A306035B51F4F6CE1E6FE,20180808
0015EE183D5A306035B51F4F6CE1E6FE,20180808
0015EE183D5A306035B51F4F6CE1E6FE,20180808
0015EE183D5A306035B51F4F6CE1E6FE,20180808
0015EE183D5A306035B51F4F6CE1E6FE,20180808

2025-01-30 00:42:50 - root - INFO - itercount: 0
2025-01-30 00:42:50 - root - INFO - Database Name: firebase-public-project
Schema Name: analytics_153293282
DDL describes table information.
,0
table_name,events_20180801
ddl,"CREATE TABLE `firebase-public-project.analytics_153293282.events_20180801`
(
  event_date STRING,
  event_timestamp INT64,
  event_name STRING,
  event_params ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64>>>,
  event_previous_timestamp INT64,
  event_value_in_usd FLOAT64,
  event_bundle_sequence_id INT64,
  event_server_timestamp_offset INT64,
  user_id STRING,
  user_pseudo_id STRING,
  user_properties ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64, set_timestamp_micros INT64>>>,
  user_first_touch_timestamp INT64,
  user_ltv STRUCT<revenue FLOAT64, currency STRING>,
  device STRUCT<category STRING, mobile_brand_name STRING, mobile_model_name STRING, mobile_marketing_name STRING, mobile_os_hardware_model STRING, operating_system STRING, operating_system_version STRING, vendor_id STRING, advertising_id STRING, language STRING, is_limited_ad_tracking STRING, time_zone_offset_seconds INT64>,
  geo STRUCT<continent STRING, country STRING, region STRING, city STRING>,
  app_info STRUCT<id STRING, version STRING, install_store STRING, firebase_app_id STRING, install_source STRING>,
  traffic_source STRUCT<name STRING, medium STRING, source STRING>,
  stream_id STRING,
  platform STRING
);"

Some other tables have the similar structure: ['events_20180801', 'events_20180621', 'events_20180616', 'events_20180912', 'events_20180814', 'events_20180716', 'events_20181003', 'events_20180620', 'events_20180624', 'events_20180918', 'events_20180612', 'events_20180911', 'events_20180724', 'events_20180807', 'events_20180710', 'events_20180808', 'events_20180702', 'events_20180719', 'events_20180914', 'events_20180913', 'events_20180915', 'events_20180728', 'events_20180817', 'events_20180628', 'events_20180906', 'events_20180704', 'events_20180711', 'events_20180720', 'events_20180706', 'events_20180926', 'events_20180924', 'events_20180731', 'events_20180804', 'events_20180920', 'events_20180715', 'events_20180709', 'events_20180928', 'events_20180904', 'events_20180903', 'events_20180818', 'events_20180820', 'events_20180707', 'events_20180930', 'events_20180821', 'events_20180812', 'events_20180830', 'events_20180908', 'events_20180708', 'events_20180910', 'events_20180922', 'events_20180713', 'events_20180618', 'events_20180811', 'events_20181001', 'events_20180626', 'events_20180828', 'events_20180717', 'events_20180806', 'events_20180721', 'events_20180725', 'events_20180824', 'events_20180923', 'events_20180627', 'events_20180726', 'events_20180729', 'events_20180929', 'events_20180925', 'events_20180722', 'events_20180630', 'events_20180730', 'events_20180831', 'events_20180701', 'events_20180619', 'events_20180810', 'events_20180822', 'events_20180921', 'events_20180819', 'events_20180927', 'events_20180905', 'events_20180816', 'events_20180622', 'events_20180802', 'events_20180826', 'events_20180714', 'events_20180901', 'events_20180916', 'events_20180809', 'events_20181002', 'events_20180703', 'events_20180617', 'events_20180902', 'events_20180625', 'events_20180827', 'events_20180805', 'events_20180825', 'events_20180919', 'events_20180917', 'events_20180705', 'events_20180613', 'events_20180907', 'events_20180909', 'events_20180727', 'events_20180813', 'events_20180614', 'events_20180623', 'events_20180829', 'events_20180615', 'events_20180712', 'events_20180718', 'events_20180815', 'events_20180629', 'events_20180803', 'events_20180823', 'events_20180723']
External knowledge that might be helpful: 
How to Calculate User Retention in Big Query from Google Demo Game Analytics Data

As a Product / Website Analyst, I was pretty psyched to discover Google’s public Google Analytics 4 (GA4) gaming event dataset called `firebase-public-project.analytics_153293282.events_*`. The table allows experienced developers and learners alike to experiment with raw GA4 data in Big Query for free. Event data is basically a log of user interactions with your product for analysis .For newbies interested in learning more about event data and GA4, visit my prior blog. This article provides SQL queries for a quick table overview and explains how to utilize Google Big Query to calculate user retention.


What is Retention?
User retention rates are key indicators for whether your product team meets user needs. Improving retention is often central to long term growth strategies.

**Retention measure’s how often and for how long users tend to return to your product.**

The metric can be a powerful proxy for product usefulness and user opinion. Its analysis can reveal critical information like how well your site converts new visitors to users and which items and features are associated with users coming back. If user data is available, retention can also help a business understand the profiles of its most active users (power users). Finally, retention is a great guardrail metric for A/B tests. Successful, product oriented companies prioritize a healthy user bases over short term profits.


**Common Retention Calculation Strategies**

Two common strategies to calculate retention are: 

a) N-Day retention

b) Unbounded Retention.


a) For N-Day retention, analysts calculate how many users with certain characteristics return over successive periods. It is called N days because we define the length of each period. For example, with N=7 day retention, if User A becomes part of our cohort of interest on day 0 and returns to the product day 5 and day 15, they are counted as retained for week 1 (1–7 days) and week 3 (15–21 days) but not week 2 (8–14 days).


b) For Unbounded Retention, a user is counted as retained each week so long as their most recent product contact was after the week. For example, if User A becomes part of the cohort on day 0 and last returned to the site on day 21, they will be counted as retained in week 1 (1–7 days), week 2 (8–14 days), and week 3 (15–21 days) but not week 4 (22–28 days).

By calculating these metrics, companies can evaluate how well their products hold users’ interests. It also them closer to identifying the patterns that generate return users.



The table structure information is ({database name: {schema name: {table name}}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180612', 'events_20180613', 'events_20180614', 'events_20180615', 'events_20180616', 'events_20180617', 'events_20180618', 'events_20180619', 'events_20180620', 'events_20180621', 'events_20180622', 'events_20180623', 'events_20180624', 'events_20180625', 'events_20180626', 'events_20180627', 'events_20180628', 'events_20180629', 'events_20180630', 'events_20180701', 'events_20180702', 'events_20180703', 'events_20180704', 'events_20180705', 'events_20180706', 'events_20180707', 'events_20180708', 'events_20180709', 'events_20180710', 'events_20180711', 'events_20180712', 'events_20180713', 'events_20180714', 'events_20180715', 'events_20180716', 'events_20180717', 'events_20180718', 'events_20180719', 'events_20180720', 'events_20180721', 'events_20180722', 'events_20180723', 'events_20180724', 'events_20180725', 'events_20180726', 'events_20180727', 'events_20180728', 'events_20180729', 'events_20180730', 'events_20180731', 'events_20180801', 'events_20180802', 'events_20180803', 'events_20180804', 'events_20180805', 'events_20180806', 'events_20180807', 'events_20180808', 'events_20180809', 'events_20180810', 'events_20180811', 'events_20180812', 'events_20180813', 'events_20180814', 'events_20180815', 'events_20180816', 'events_20180817', 'events_20180818', 'events_20180819', 'events_20180820', 'events_20180821', 'events_20180822', 'events_20180823', 'events_20180824', 'events_20180825', 'events_20180826', 'events_20180827', 'events_20180828', 'events_20180829', 'events_20180830', 'events_20180831', 'events_20180901', 'events_20180902', 'events_20180903', 'events_20180904', 'events_20180905', 'events_20180906', 'events_20180907', 'events_20180908', 'events_20180909', 'events_20180910', 'events_20180911', 'events_20180912', 'events_20180913', 'events_20180914', 'events_20180915', 'events_20180916', 'events_20180917', 'events_20180918', 'events_20180919', 'events_20180920', 'events_20180921', 'events_20180922', 'events_20180923', 'events_20180924', 'events_20180925', 'events_20180926', 'events_20180927', 'events_20180928', 'events_20180929', 'events_20180930', 'events_20181001', 'events_20181002', 'events_20181003']}}
Begin Exploring Related Columns
**Relevant Columns and Their Potential Usage:**

- `event_name`: Used to filter for specific events such as `session_start` and `quickplay`.
- `event_date`: Used to select events within the specified date range ('20180702' to '20180716').
- `event_timestamp`: Used to determine the timing of events and calculate time differences.
- `user_pseudo_id`: Used to uniquely identify users across events.
- `event_params`: Used to extract additional parameters related to `quickplay` event types.

**Conditions That May Be Used:**

- `event_name = 'session_start'`: To focus on users who started a session during the specified period.
- `event_name = 'quickplay'`: To identify `quickplay` events.
- `event_date BETWEEN '20180702' AND '20180716'`: To limit events to the specified date range.
- Extracting `quickplay` event types from `event_params` where `ep.key = 'quickplay_type'`.

---

**SQL Queries:**

1. **List distinct event names to understand available events:**

    ```sql
    SELECT DISTINCT `event_name` 
    FROM `firebase-public-project.analytics_153293282.events_*`
    LIMIT 100;
    ```

2. **Retrieve users who started a session between July 2, 2018, and July 16, 2018:**

    ```sql
    SELECT DISTINCT `user_pseudo_id` 
    FROM `firebase-public-project.analytics_153293282.events_*` 
    WHERE `event_name` = 'session_start' 
      AND `event_date` BETWEEN '20180702' AND '20180716'
    LIMIT 100;
    ```

3. **Get `quickplay` events within the specified date range:**

    ```sql
    SELECT `user_pseudo_id`, `event_timestamp`, `event_date` 
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `event_name` = 'quickplay'
      AND `event_date` BETWEEN '20180702' AND '20180716'
    LIMIT 100;
    ```

4. **Extract distinct keys from `event_params` for `quickplay` events:**

    ```sql
    SELECT DISTINCT ep.key
    FROM `firebase-public-project.analytics_153293282.events_*`, UNNEST(`event_params`) AS ep
    WHERE `event_name` = 'quickplay'
      AND `event_date` BETWEEN '20180702' AND '20180716'
    LIMIT 100;
    ```

5. **Extract distinct `quickplay` event types from `event_params`:**

    ```sql
    SELECT DISTINCT ep.value.string_value AS quickplay_type
    FROM `firebase-public-project.analytics_153293282.events_*`, UNNEST(`event_params`) AS ep
    WHERE `event_name` = 'quickplay'
      AND `event_date` BETWEEN '20180702' AND '20180716'
      AND ep.key = 'quickplay_type'
    LIMIT 100;
    ```

6. **Count `quickplay` events per event type during the specified period:**

    ```sql
    SELECT ep.value.string_value AS quickplay_type, COUNT(*) AS event_count
    FROM `firebase-public-project.analytics_153293282.events_*`, UNNEST(`event_params`) AS ep
    WHERE `event_name` = 'quickplay'
      AND `event_date` BETWEEN '20180702' AND '20180716'
      AND ep.key = 'quickplay_type'
    GROUP BY quickplay_type
    LIMIT 100;
    ```

7. **List users and their first `quickplay` event timestamp during the period:**

    ```sql
    SELECT `user_pseudo_id`, MIN(`event_timestamp`) AS first_quickplay_timestamp
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `event_name` = 'quickplay'
      AND `event_date` BETWEEN '20180702' AND '20180716'
    GROUP BY `user_pseudo_id`
    LIMIT 100;
    ```

8. **Identify users who performed a `quickplay` event after July 16, 2018:**

    ```sql
    SELECT DISTINCT `user_pseudo_id`
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `event_name` = 'quickplay'
      AND `event_date` > '20180716'
    LIMIT 100;
    ```

9. **Count events per user who had `quickplay` events after the initial period:**

    ```sql
    SELECT `user_pseudo_id`, COUNT(*) AS event_count
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `event_name` = 'quickplay'
      AND `event_date` > '20180716'
    GROUP BY `user_pseudo_id`
    LIMIT 100;
    ```

10. **Get dates when users had `quickplay` events after July 16, 2018:**

    ```sql
    SELECT `user_pseudo_id`, `event_date`
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `event_name` = 'quickplay'
      AND `event_date` > '20180716'
    ORDER BY `user_pseudo_id`, `event_date`
    LIMIT 100;
    ```

---

These queries help in understanding the distribution of `quickplay` events, identifying users who participated in these events during the specified period, extracting event types, and examining user activity after the initial period to assess retention.Query:
SELECT DISTINCT `event_name` 
    FROM `firebase-public-project.analytics_153293282.events_*`
    LIMIT 100;
Answer:
event_name
level_retry_quickplay
use_extra_steps
app_remove
app_clear_data
dynamic_link_first_open
level_fail_quickplay
user_engagement
completed_5_levels
os_update
in_app_purchase
level_complete
level_reset
firebase_campaign
challenge_accepted
ad_reward
challenge_a_friend
spend_virtual_currency
first_open
level_start
level_end
level_end_quickplay
level_reset_quickplay
app_update
dynamic_link_app_open
notification_foreground
screen_view
post_score
level_start_quickplay
level_fail
level_up
level_retry
app_exception
no_more_extra_steps
error
level_complete_quickplay
session_start
select_content
Query:
SELECT DISTINCT `user_pseudo_id` 
    FROM `firebase-public-project.analytics_153293282.events_*` 
    WHERE `event_name` = 'session_start' 
      AND `event_date` BETWEEN '20180702' AND '20180716'
    LIMIT 100;
Answer:
user_pseudo_id
9603F4B5ABFC1E48B0BF68C83669F845
5631892AB2E836FD3A72540D3C316C51
71746D859E4E6D655FEE8FFBC3B6C7E9
079E84FBF40BA6D3E74C7E61A7BD4F91
38DEEAB5F723A89A66CF180A175808D5
734AC9568F0674F7BBE59D45B5B90EA7
EF1CF9C1C84826BE2985E02194F65C38
22A78172D80C16E12B45C62A746F1461
48EA1B5A51811D700199781B10C48121
D9FEC4E4418413FCE771B203FD7D48D2
6B07E90CD14662B55877A7CBC80A1133
3E5E7324D21924DA3A6BE8E817B3C5FE
DA48D36D07835B1918BDF831AF83B5EF
F99CC3598522ABE54B9DCAC2969179CC
CA51DAF1373B5C2A16C174AFBD2132A4
28AA4A0542C8873691715C284D13C34B
FCA08F9B0DCB6E33A74F672CE7F73BE3
B6BA0A7B30C70EE6C34956C88563B361
2C33E7A3E02384439F6F3A61AE37D6AE
04D1448BED7366A1CACEDA442F7A18D8
FB06AF1BD3F3737D1FF77A949823A580
44759496F6F519B1A4BEF55BE55C631C
9EEE374E4BE34101A39330BD8191446A
96710B78A294951BF7CDEA5BBEE15766
751F1516AC974AC343F62070D3BA39F5
CB2A03B9DC1894380C75344D15BC0BE6
6CC62DC4D07B240209DC6837340DDF9F
0F67E233B19D2898229CD156974A93AE
4BF98D09CA8359FC59ADAF56D00338F8
3DC258E32531148709A4BF575C0F076E
68EA8FDC3D7F8984530BB60FAE9A42FD
05F7B2C58D627CE948B06C10E39CDF91
54827B02505D08E40E29E608008431B4
7842C62D45ECE888132F21C9F4417B21
9542C5C6A8B0B9CA47A82C94208FDC7E
E6FD2A5EF0543141D34A92D5BE0C2CCC
2684EA4DDB1F988E3C979AB15CFF601F
4193343164266373A13B35D5D04053E2
7507B0AA39479D2DB533FDDF9E12DB98
13BC94A3DC715A7CF8DB34C820766E27
030D58D3258598A9563844AD6A28FA61
012A1B5594934B98BD38FDD68C560702
94E691DE59E7A869E02CCC207D0EB360
5E09265F12D64B9FA85FF9427A0A7FB0
FB581F2AC74E08CD38CCAAA9A99F0217
09CAEE95CE99F27D00EA630EEDBCECA2
A3D25F3FA1983C40DE78BD7B05CEBAD0
58613864711355CE99E999ED2B37A963
81BFFE61CAB181676917D75F1B617CB2
0046A2D1B1135C0AB4462B8FF036739E
FC2C90CE72B673FDFFC262F04C817C53
CC88655DF7CDE5E8225BA20B5D6EC59B
018F03084C88E944163F76A0D0C2FBA1
4AB1C9375139B1C30ED33E1D29F0E7AA
2039439F42FBFE73F7FFB4B1637776D5
EBC3581ADA874D494FBE2C7CCF53BF99
3D2787408CD80B30103939EB61746866
F6EB4832FA8E8C989D1A6EA0A15312FF
5800569BC32997BCE5774BA3C675C4E4
F1F2C328BF34010DBA50842CA03956E2
A5EF117D3FA84DCA56D332FE725BF4D7
261F6186CC817A991565A91C4C92CAFA
88BA2493921D796D2E246973E3E9774B
22DC6A6AE86C0AA33EBB8C3164A26925
CD4078C6EC791735D5402B2A3793D2FF
BCD37BC09EFDBC9BEEE314EBBF815D01
54B8D30BE1F3471830044059A37419F6
2F5BBABE9DD0271DCD62E501F76DA736
7E438E53A94A9E6EA6531E272C86F512
CF06C47EAD622F909BFCC83FF4D0ECE8
AD4F00389084ECC4B5362689C228EB0F
3422CA1B4B6A9ACE78187868F362C3C7
812A0C9302E7E1A711B416C0904C99CD
6BFD3E06D9C82ACB070A6C891A6AE15D
9373B5D36107012F6F9137090C523FA1
C7BDDD0BAC5D80E447FCDD12A580273E
6EDF43D6306C4F1CE0500424B27F6411
2E03DB1924573F3131EEC916E5444F56
1F25763EC8BCAEC7FB069E81659A2153
570495249052C5E40EC34A2B054DA1A1
1406751556EEDB1D112BF86CACAE9C88
D8A4973047AF2FA8E9061F6F52E6BD61
BD23A737D75442D2C32CE2259D15D624
537B074515EB8F5DDF89269910D94309
5B888A06EFF60B86B10367EEC3B44E85
E270414CD8C904F7BB039FB243540B3E
DFC2120907EE81E1836E3A9E257498C9
C95B2A35A6BC7C94839B2FF05FE914CF
7410C5CC4FA11D31DB5F9B1D8ECD6BD0
535B3809F6411A9F8FB0B2C78CE59284
711364F41553811B33FD216391234D59
DF7B1F6B6AEF483760B6439EF91BC26A
75C683C1AE98FC6CCE6EA156C9E90A35
Query:
SELECT DISTINCT `event_name` AS quickplay_event_type
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` LIKE '%quickplay%'
LIMIT 100;
Answer:
quickplay_event_type
level_complete_quickplay
level_start_quickplay
level_fail_quickplay
level_end_quickplay
level_reset_quickplay
level_retry_quickplay
Query:
SELECT DISTINCT ep.key
FROM `firebase-public-project.analytics_153293282.events_*`, UNNEST(`event_params`) AS ep
WHERE `event_name` LIKE '%quickplay%'
  AND `event_date` BETWEEN '20180702' AND '20180716'
LIMIT 100;
Answer:
key
board
firebase_screen_class
value
firebase_screen_id
firebase_event_origin
Query:
SELECT DISTINCT ep.key
FROM `firebase-public-project.analytics_153293282.events_*`, UNNEST(`event_params`) AS ep
WHERE `event_name` LIKE '%quickplay%'
LIMIT 100;
Answer:
key
firebase_screen_class
board
firebase_screen_id
value
firebase_event_origin
Query:
SELECT DISTINCT ep.key
FROM `firebase-public-project.analytics_153293282.events_*`, UNNEST(`event_params`) AS ep
LIMIT 100;
Answer:
key
firebase_screen_class
level
product_id
update_with_analytics
campaign
firebase_screen_id
timestamp
quantity
previous_app_version
message_name
firebase_error
dynamic_link_link_id
validated
board
firebase_previous_class
item_id
message_id
firebase_event_origin
score
level_name
dynamic_link_link_name
ad_event_id
price
previous_first_open_count
value
firebase_conversion
type
product_name
click_timestamp
firebase_previous_id
time
item_name
previous_os_version
source
medium
firebase_screen
dynamic_link_accept_time
engagement_time_msec
fatal
firebase_previous_screen
system_app_update
message_time
content_type
ad_unit_code
currency
message_device_time
virtual_currency_name
gclid
error_value
system_app
term
content
Query:
SELECT `user_pseudo_id`, MIN(`event_timestamp`) AS first_quickplay_timestamp
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` IN (
    'level_start_quickplay',
    'level_complete_quickplay',
    'level_fail_quickplay',
    'level_end_quickplay',
    'level_reset_quickplay',
    'level_retry_quickplay'
)
GROUP BY `user_pseudo_id`
LIMIT 100
Answer:
user_pseudo_id,first_quickplay_timestamp
C57026026F451C8B63B19481023BE944,1529358529943007
309D006B3FE6151EE530B0C6A79CFA11,1528820185474007
77F297ECE32E4728993468CE558B9AFE,1529948962888008
6F0928CF979D92A11C602CB5EFA37F49,1528819296461006
244301BD63080095E545DC9446957C57,1537081960787011
A66E12586B3B31AAEF02D1B1DD09EFDF,1533566684914004
82C61B1EAAF07052E9ADAABB8137D220,1537622340657014
060ADA8C8F2558D7C9AC00CA15B84DB3,1536343687995007
52674FCAD5A82E22BFA5EB24BDB2ED99,1536096341004007
92BA07C5AF1103CDD804CDA9F7199B95,1537628275575002
EC65A4E9E110812FCB0654E5783D0ED1,1530422838848001
69495B8489F605F197D1E8697BCBF02B,1532308588095006
FF2667B2C3C60D19E7B7D63C99BB4CAA,1529760023759004
B5D5EECC05D20983F8E3729AFD3295C6,1537853326810008
FE47196822AB89CCE12396BBB50306A3,1537202458646009
13F23FAD6BD15A62B3E2D32E1F117BB3,1537772289212001
DB26CECA494F76A0F55941026125C0DB,1529941500674009
AF7F48274AA5128EBCF3698F4FC8F61B,1536890270992008
C139256BC6B95411865D96398AAC81B2,1530221469710004
0F1B0F6CA38544C25AF8F668E7BED38A,1528853903861008
F505D39D04A5141F7A113A0AE18B0475,1536128006558019
1386E5CC85E430BBC566EC1019DC3C32,1536088979210008
1762CA37B5E74A04C62CFEE59A9A5111,1529032805039007
81FBBC1EAB021C62534AB79EACEC0501,1529170642356011
15DEF8BA7C049332809AAAF77295F3A8,1529395991581000
136C3AB6E42E34223C8A7503EE355E12,1528814478848007
135BE5A161033D5A7BC7A0A8F4C80ACE,1528826879642008
0A367084F9CA18D023CF9A8B8FF81905,1528839601947007
8FA32288838A699CAD94D57C8B3F7EF1,1537846512199009
186F51E5AACB37852E3650E7027E33B1,1535049911899005
ED589AAA205D32DDAC8B10CD75E5E968,1537774107902002
48AB910A8DE8485D4C34238EA61F782C,1529095336694008
7BD09067E1183BA65712D575B62685D3,1535893195919004
959635567E419A061EECCCA478EDC718,1531167822104079
18E3B6030C95894AA0147632DC697D0E,1537784592212011
584D2E4F744800A59C8C3F3AC63B675E,1528857062611001
48C8A04DA2A666406E943C164A94D0B3,1529339272044007
59454BAC415BB1F18517C6FD2C023E49,1528796451274008
AE55489045EA81B6DBB191298D293184,1536304635482008
A81D28013F1A7D03564C48121CE3D1FA,1537258633796009
E5A2CB7A471E740E758BE5E2E0C79BC2,1529314829280008
49CF61B01BD5584B86EFC08E40F6EB03,1529362603985010
8BD465AC77DC9D8B4C597BF35950FDA3,1529306310567012
6722ACD286AC0F5CA22E745302CAEB89,1535497469181004
2741C47CC50AE98B39CC5B561BFEA504,1528855627108010
635808C1DDFBC662DC3015097E26E62A,1532435806656000
D299D5763E03F1CC4DA8550AF1B4CEE4,1529660712468001
1C679E92B10C3EEDDD36467BE24D7449,1529423163702065
8A315264BC7C1FAA87051112FD46F3D4,1529352463152009
E6B92CC2D56E83206D33E752DADEAB5C,1529698650642007
Query:
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` IN (
    'level_start_quickplay',
    'level_complete_quickplay',
    'level_fail_quickplay',
    'level_end_quickplay',
    'level_reset_quickplay',
    'level_retry_quickplay'
)
LIMIT 100
Answer:
user_pseudo_id
BB262970AF9A445625B2D6D3F76AD327
88A41BFED275BB69125BE1F5524F3B42
E512079B53179DF9A608CF4ADE47DE9D
98578513E0F25350F961CDCBA9D3656F
3A2180BCAA45AB7675057130B18F8522
8C7A0CAF2B29D568268B8D331E37ABF6
F0FC99F563E1247AD70240E5AA132ABF
1B3AD9683D475EFB398E131DFE65AE61
8D08248A4E1A8D0A7D0101CC99A98AD0
898B790ACC7834117A9B2C98A8B6F1F5
C6111251D5DB67692ABDD1D54BA056AF
36390262EE0C669101AD7ACFE181689C
E9DCE2D958652BD58E846DCE86BDD90A
2927B0054220D4D4565BD60B590F82B0
F212EF8CB9E42FEF69DB0D970EFA5939
EEBCB25D5F056CCF59DDE654388ACD2B
488BE19C45D3D8B2DF02214BC19B44B4
CFB69F749BBDFB928C7E83704070B1A3
17636078D57884AD7EA5406C60E2BD10
4D6582BFA74C0705C44ED36CCB8CE527
BDCFD1F0FDE47E594874CA47CD49C303
CCC7BB053BBC6824C53FAA4A8C63E3FE
C4D21EF78D8A4B00805216847EBCAFBB
6F5FF93E2A273D4D80B6A21BE014217A
63550F65F0818B874ADA2B18C463AB21
C3E3CDDD1E35362AA59854F8FA511BB0
87B1F896770D48526901F75489E30535
108D09DB520942B16C86056E4F92D707
5A976ACE1440285CDDFF5377299D13D3
5BA23094CD864C7FB5265F83652FA028
136F2C0A18FA7D6A967EEBDC2C7E3346
E8950841C7635FFAE97EE03DE2A92072
37DEF17DD3761C66B7F56806F978E726
717914316B7E4BD629C168B3A05634DC
FB149ABD1F42826AA82A9D0D3FB03342
B711923F02FB2923F0A4DBC8CA2CE3AD
27FAC926A196086540A33D26831E5D18
AC84CEAED9C93CFA450E22E735D19F1D
47641CFD956212B88DE89050A1218D3E
7B4884B8AA78518C3EC6B4B3FECD526E
B36FAA12AF854F00E4EC23696D2786CC
32DEB1F24ABD2430CC3EB1A917D1DD77
72556FDF7DF77445D94FB19C87334F1D
E642A5334B708A0A18F5590AB4554780
96D78D93EA38723BCFD4AAAEE9DC6ACD
F73A0D4A6FB35C664DDAE0F4F145F8B0
E676E450E4EF9C561937FBB18A52C237
0B80FE0B9AF69F6B040D6F48FFEB8A8B
00F541FA1C141575D0AD7048F809CC6E
46CAF574E4F98302ED5E559FED2EA454
7CE5EA721C3169E682540F2C897A3904
247B17FFC9A82C34B999CFBDA295584F
8DD47B40A0938BA8BD9FF0B34D83B28E
2DE9CB964C424DB7C1B6DE60E1C6A108
A51BF75239709A5494645BEAABC3453D
EACCA0856B7B7B2AEC2CB1808C1034E5
5FFBFE051291F79717B99F5D72B02CDC
35CF08DA631AC27582D6A0FE710131F7
BFC4C22D2C9FF3D314BC4F1D86E92044
31E8B3EB3D9167E813FDFB812898F2F6
7DBEEB7A2488FE1FFC0808686AC09606
4EBC9E555CE3316055264858BF18DB51
4789C778386485B99F4077B97DFE34E3
9B18A1CBA96D52D05CFA7CB7C9011EDE
9A9023B132EB5D23ED8B335C90E7D28A
1C65943AF5217570A2E4D9B58B6E6FC4
0A9710D5EF9520ED2030965DE41E7436
55EEC95A163C7791E528B12D5FA32CA9
487DE902636DD8A9844A2D61FE7BD568
9BD663F05EA7660B40800C28E2BF59FC
01C784BDB7AF4DC8DAD6DCD21AF56E25
99ED19E25F424068C78C51C1C51F9E3C
AD8EC45CB90A8CEFC376341115A6E1E7
B7706BCDE12360F565E9F5DB0A5256D8
A0903E7042C13251799B68B16FD1EBA6
A1927ED722EA16A3B82E7EE0FA22FF4F
CD86D0CCD91B43EA8B6FBAD81378AB5B
DCF02493CA8559E632F3E2FB070DBEF0
EBE661044C1949546986A852F35083A1
9C2E5AEEBFD459AD8112A26F015C8D8C
01A2CCF65B4BB5DF87B1F9177616C5AF
5F99FAB2A6750F6391E248AF619389AA
2F0F260BD7B876C346B41977D0D03D62
920DB84FCC0F4421650B9E257E33180B
535852E6378668E758A59C4FD24F14D4
4CC453DA57531954D7C053B93A20B5D0
53B99AF8D463E4FB9FA1DD1D94043B9D
9A12E7E2B3CF644B8304DF8E1A9CE2D8
8FAD3B149C27A6E915B1404A00DD08A0
B909E553481A3C9AD11258FBF6200D66
24D41A78A6BB1244608DB32351B0658B
D1A34C0FAE2F326F2C050020A3B990C5
B24F51D3B429580F5C4FF054CE98FC41
Query:
SELECT `user_pseudo_id`, COUNT(*) AS event_count
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` IN (
    'level_start_quickplay',
    'level_complete_quickplay',
    'level_fail_quickplay',
    'level_end_quickplay',
    'level_reset_quickplay',
    'level_retry_quickplay'
)
GROUP BY `user_pseudo_id`
LIMIT 100
Answer:
user_pseudo_id,event_count
487DE902636DD8A9844A2D61FE7BD568,2486
2F0F260BD7B876C346B41977D0D03D62,353
734ADBB5D0874A5007E58B2F99625EE0,82
4FAE9F054706890DC522E924EBF17286,316
898B790ACC7834117A9B2C98A8B6F1F5,1607
C5788CC4CA50494F16D5CE2F5B913078,1
A91AAEDD376FE48EA2866594A13C5C2E,4
36390262EE0C669101AD7ACFE181689C,260
DF2C3B7E8FB37490F6F265867863951C,42
213F7CCE718883579D85966F63301ADD,213
FB149ABD1F42826AA82A9D0D3FB03342,513
31E8B3EB3D9167E813FDFB812898F2F6,59
5BDEA4C55EFDF16308475E1ACA152767,30
8802C1F08F68501AB77C5097CD19CE1A,19790
A0BD8C1DC54A57DAD494FB3941800B9D,36
EEBCB25D5F056CCF59DDE654388ACD2B,784
879503A3ED5F2DCB6592E99C42E1BDFE,196
075EBEDBF28134BE41FB4E7D943F858C,352
CD86D0CCD91B43EA8B6FBAD81378AB5B,66
6A8061EE9C5A6A6A48545DA3A6713C0A,49
41CA0FA528C7227EA1E592DCC4733C40,1066
51861EE26D72E3AC5B5E6A3396CA7E78,11
ADBF591A2A1DE60915F718F8FD6ED4C1,5
DCF02493CA8559E632F3E2FB070DBEF0,73
38383D77F69C1CAA39B0CAC891CB0E0B,142
EBE661044C1949546986A852F35083A1,542
B5F3D00E28A57C9522F2DEE3CB903DD1,910
45EB0927832513B89E58E6C6C93D841C,64
2927B0054220D4D4565BD60B590F82B0,1370
5A06B4FB19BFBF838B73B57297121379,333
B32B9B49419747FED767C4942DA42EFB,16
E512079B53179DF9A608CF4ADE47DE9D,962
98578513E0F25350F961CDCBA9D3656F,204
537BF60056C260DCA1ADB5CD1824383A,12
29CC43D76ACDDDC0A3D9F640532B7D27,3
F7C189BBD2C256AE9A6745443DBE891D,11
5FFBFE051291F79717B99F5D72B02CDC,20
35CF08DA631AC27582D6A0FE710131F7,171
1B959D672ABAE4A3BFB9D720D415E064,5
9A12E7E2B3CF644B8304DF8E1A9CE2D8,755
2344AFC9EF64F71D5500B8390FD997C6,1
5ACD59093D1C49F2EADAE29D7181A9CF,1
83EB6E905B20079A153828894109C0FF,16
3A2180BCAA45AB7675057130B18F8522,68
41F6537F5D6EB1798536910D0722A344,32
AAADF44F1C6A57099FEF88D15C7CF64D,673
4FCB0434161F0EE1E92046C850A90DD1,5
55EEC95A163C7791E528B12D5FA32CA9,125
9BD663F05EA7660B40800C28E2BF59FC,148
528939A93F1D3693AD8A56F340B7D777,32
E9B766FA2D5B25A0E71F4A023F2BE733,35
AD8EC45CB90A8CEFC376341115A6E1E7,38
B7706BCDE12360F565E9F5DB0A5256D8,554
71770AF53DC5204BBCE3B7DB7EB9CDAC,6
E53BC2A0AD86417B443AF14EE3082C0F,1118
11FCE87078342891B101FE7F59E76347,47
6B08E53DCB961355CFDD135921EF13BC,1
36C32F82A22E7DC2DB04DA29BF71199F,9
17636078D57884AD7EA5406C60E2BD10,557
2AC0EF5047BC538BDA6388E644409B5D,107
24D41A78A6BB1244608DB32351B0658B,49
F0945E5A97F876E9C084AC260BA4A6F1,5
0FD8410E5528FC512E551697BB8911C8,93
1C65943AF5217570A2E4D9B58B6E6FC4,165
D1A34C0FAE2F326F2C050020A3B990C5,2
91F5161F80D1083CA7B37A08DEC9EC78,91
805F3B2AC44D55805F8B5C1660A15CFF,7
CAC12C9CF0AD0E78C9679E12A7425625,21
D2FA501819D653CF9B408901BADDE2BA,10
Query:
SELECT `user_pseudo_id`, `event_date`
FROM `firebase-public-project.analytics_153293282.events_*`
WHERE `event_name` IN (
    'level_start_quickplay',
    'level_complete_quickplay',
    'level_fail_quickplay',
    'level_end_quickplay',
    'level_reset_quickplay',
    'level_retry_quickplay'
)
ORDER BY `user_pseudo_id`, `event_date`
LIMIT 100
Answer:
user_pseudo_id,event_date
0005E3C4A38470408E9FFE32F1FD1A13,20180915
0005E3C4A38470408E9FFE32F1FD1A13,20180915
0005E3C4A38470408E9FFE32F1FD1A13,20180915
0007A96FEDC18F960EF004FCCB5FB41C,20180813
0007A96FEDC18F960EF004FCCB5FB41C,20180821
0007A96FEDC18F960EF004FCCB5FB41C,20180821
0007A96FEDC18F960EF004FCCB5FB41C,20180821
000A8B9167F5F9B7BF620708D320E32F,20180725
000A8B9167F5F9B7BF620708D320E32F,20180725
000A8B9167F5F9B7BF620708D320E32F,20180725
000A8B9167F5F9B7BF620708D320E32F,20180725
000A8B9167F5F9B7BF620708D320E32F,20180725
000A8B9167F5F9B7BF620708D320E32F,20180725
000A8B9167F5F9B7BF620708D320E32F,20180725
000A8B9167F5F9B7BF620708D320E32F,20180725
000A8B9167F5F9B7BF620708D320E32F,20180725
000A8B9167F5F9B7BF620708D320E32F,20180725
000F49564E9F2B85F3B1AF1A0DDCB872,20180726
000F49564E9F2B85F3B1AF1A0DDCB872,20180726
000F49564E9F2B85F3B1AF1A0DDCB872,20180726
000F49564E9F2B85F3B1AF1A0DDCB872,20180817
001373EB022B5377FD914A42CFF11F38,20180612
001373EB022B5377FD914A42CFF11F38,20180612
001373EB022B5377FD914A42CFF11F38,20180612
001373EB022B5377FD914A42CFF11F38,20180613
001373EB022B5377FD914A42CFF11F38,20180613
001373EB022B5377FD914A42CFF11F38,20180613
0014DFDE712A8A42EE68057DD4062E42,20180612
0014DFDE712A8A42EE68057DD4062E42,20180612
0014DFDE712A8A42EE68057DD4062E42,20180612
0014DFDE712A8A42EE68057DD4062E42,20180612
0014DFDE712A8A42EE68057DD4062E42,20180613
0014DFDE712A8A42EE68057DD4062E42,20180613
0014DFDE712A8A42EE68057DD4062E42,20180613
0014DFDE712A8A42EE68057DD4062E42,20180614
0014DFDE712A8A42EE68057DD4062E42,20180614
0014DFDE712A8A42EE68057DD4062E42,20180614
0014DFDE712A8A42EE68057DD4062E42,20180615
0014DFDE712A8A42EE68057DD4062E42,20180616
0014DFDE712A8A42EE68057DD4062E42,20180616
0014DFDE712A8A42EE68057DD4062E42,20180616
0014DFDE712A8A42EE68057DD4062E42,20180617
0014DFDE712A8A42EE68057DD4062E42,20180617
0014DFDE712A8A42EE68057DD4062E42,20180617
0014DFDE712A8A42EE68057DD4062E42,20180625
0014DFDE712A8A42EE68057DD4062E42,20180625
0014DFDE712A8A42EE68057DD4062E42,20180626
0014DFDE712A8A42EE68057DD4062E42,20180626
0014DFDE712A8A42EE68057DD4062E42,20180628
0014DFDE712A8A42EE68057DD4062E42,20180628
0014DFDE712A8A42EE68057DD4062E42,20180915
0014DFDE712A8A42EE68057DD4062E42,20180915
0014DFDE712A8A42EE68057DD4062E42,20180915
0015EE183D5A306035B51F4F6CE1E6FE,20180808
0015EE183D5A306035B51F4F6CE1E6FE,20180808
0015EE183D5A306035B51F4F6CE1E6FE,20180808
0015EE183D5A306035B51F4F6CE1E6FE,20180808
0015EE183D5A306035B51F4F6CE1E6FE,20180808
0015EE183D5A306035B51F4F6CE1E6FE,20180808
0015EE183D5A306035B51F4F6CE1E6FE,20180808
0015EE183D5A306035B51F4F6CE1E6FE,20180808
0015EE183D5A306035B51F4F6CE1E6FE,20180808
0015EE183D5A306035B51F4F6CE1E6FE,20180808
End Exploring Related Columns
Task: What is the retention rate for users two weeks after their initial quickplay event, calculated separately for each quickplay event type, within the period from July 2, 2018, to July 16, 2018? Please focus on users who started a session (session_start) during this period.

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
quickplay_event_type,retention_rate_after_two_weeks
event_type1:str,rate1:float between 0 and 100
event_type2:str,rate2:float between 0 and 100
...
```

The table displays the retention rates for users two weeks after their initial quickplay event, calculated separately for each quickplay event type. This calculation focuses on users who started a session (`session_start`) between July 2, 2018, and July 16, 2018..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180612', 'events_20180613', 'events_20180614', 'events_20180615', 'events_20180616', 'events_20180617', 'events_20180618', 'events_20180619', 'events_20180620', 'events_20180621', 'events_20180622', 'events_20180623', 'events_20180624', 'events_20180625', 'events_20180626', 'events_20180627', 'events_20180628', 'events_20180629', 'events_20180630', 'events_20180701', 'events_20180702', 'events_20180703', 'events_20180704', 'events_20180705', 'events_20180706', 'events_20180707', 'events_20180708', 'events_20180709', 'events_20180710', 'events_20180711', 'events_20180712', 'events_20180713', 'events_20180714', 'events_20180715', 'events_20180716', 'events_20180717', 'events_20180718', 'events_20180719', 'events_20180720', 'events_20180721', 'events_20180722', 'events_20180723', 'events_20180724', 'events_20180725', 'events_20180726', 'events_20180727', 'events_20180728', 'events_20180729', 'events_20180730', 'events_20180731', 'events_20180801', 'events_20180802', 'events_20180803', 'events_20180804', 'events_20180805', 'events_20180806', 'events_20180807', 'events_20180808', 'events_20180809', 'events_20180810', 'events_20180811', 'events_20180812', 'events_20180813', 'events_20180814', 'events_20180815', 'events_20180816', 'events_20180817', 'events_20180818', 'events_20180819', 'events_20180820', 'events_20180821', 'events_20180822', 'events_20180823', 'events_20180824', 'events_20180825', 'events_20180826', 'events_20180827', 'events_20180828', 'events_20180829', 'events_20180830', 'events_20180831', 'events_20180901', 'events_20180902', 'events_20180903', 'events_20180904', 'events_20180905', 'events_20180906', 'events_20180907', 'events_20180908', 'events_20180909', 'events_20180910', 'events_20180911', 'events_20180912', 'events_20180913', 'events_20180914', 'events_20180915', 'events_20180916', 'events_20180917', 'events_20180918', 'events_20180919', 'events_20180920', 'events_20180921', 'events_20180922', 'events_20180923', 'events_20180924', 'events_20180925', 'events_20180926', 'events_20180927', 'events_20180928', 'events_20180929', 'events_20180930', 'events_20181001', 'events_20181002', 'events_20181003']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-30 00:43:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 00:43:30 - root - INFO - ```sql
WITH initial_events AS (
    SELECT
        user_pseudo_id,
        MIN(event_timestamp) AS first_event_timestamp,
        event_name AS quickplay_event_type
    FROM
        `firebase-public-project.analytics_153293282.events_*`
    WHERE
        event_date BETWEEN '20180702' AND '20180716'
        AND event_name IN (
            'level_start_quickplay',
            'level_complete_quickplay',
            'level_fail_quickplay',
            'level_end_quickplay',
            'level_reset_quickplay',
            'level_retry_quickplay'
        )
    GROUP BY
        user_pseudo_id,
        event_name
),
session_users AS (
    SELECT DISTINCT user_pseudo_id
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE event_name = 'session_start'
      AND event_date BETWEEN '20180702' AND '20180716'
),
retention AS (
    SELECT
        ie.quickplay_event_type,
        ie.user_pseudo_id,
        ie.first_event_timestamp,
        TIMESTAMP_ADD(TIMESTAMP_MICROS(ie.first_event_timestamp), INTERVAL 14 DAY) AS start_retention_period,
        TIMESTAMP_ADD(TIMESTAMP_MICROS(ie.first_event_timestamp), INTERVAL 28 DAY) AS end_retention_period
    FROM
        initial_events ie
    JOIN
        session_users su
        ON ie.user_pseudo_id = su.user_pseudo_id
),
retained_users AS (
    SELECT DISTINCT
        r.quickplay_event_type,
        r.user_pseudo_id
    FROM
        retention r
    JOIN
        `firebase-public-project.analytics_153293282.events_*` ev
    ON
        r.user_pseudo_id = ev.user_pseudo_id
    WHERE
        ev.event_timestamp BETWEEN
            UNIX_MICROS(r.start_retention_period)
            AND UNIX_MICROS(r.end_retention_period)
        AND ev.event_name = r.quickplay_event_type
),
user_counts AS (
    SELECT
        quickplay_event_type,
        COUNT(DISTINCT user_pseudo_id) AS total_users
    FROM
        retention
    GROUP BY
        quickplay_event_type
),
retained_counts AS (
    SELECT
        quickplay_event_type,
        COUNT(DISTINCT user_pseudo_id) AS retained_users
    FROM
        retained_users
    GROUP BY
        quickplay_event_type
)
SELECT
    uc.quickplay_event_type,
    ROUND(100 * IFNULL(rc.retained_users, 0) / uc.total_users, 4) AS retention_rate_after_two_weeks
FROM
    user_counts uc
LEFT JOIN
    retained_counts rc
    ON uc.quickplay_event_type = rc.quickplay_event_type
ORDER BY
    uc.quickplay_event_type;
```
2025-01-30 00:43:37 - root - INFO - itercount: 1
2025-01-30 00:43:37 - root - INFO - 0
2025-01-30 00:43:37 - root - INFO - results: 
quickplay_event_type,retention_rate_after_two_weeks
level_complete_quickplay,49.3277
level_end_quickplay,45.9879
level_fail_quickplay,40.1163
level_reset_quickplay,23.494
level_retry_quickplay,35.4545
level_start_quickplay,43.6395


2025-01-30 00:43:37 - root - INFO - Please check the answer again by reviewing What is the retention rate for users two weeks after their initial quickplay event, calculated separately for each quickplay event type, within the period from July 2, 2018, to July 16, 2018? Please focus on users who started a session (session_start) during this period., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
quickplay_event_type,retention_rate_after_two_weeks
event_type1:str,rate1:float between 0 and 100
event_type2:str,rate2:float between 0 and 100
...
```

The table displays the retention rates for users two weeks after their initial quickplay event, calculated separately for each quickplay event type. This calculation focuses on users who started a session (`session_start`) between July 2, 2018, and July 16, 2018. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
quickplay_event_type,retention_rate_after_two_weeks
level_complete_quickplay,49.3277
level_end_quickplay,45.9879
level_fail_quickplay,40.1163
level_reset_quickplay,23.494
level_retry_quickplay,35.4545
level_start_quickplay,43.6395
Current sql:
WITH initial_events AS (
    SELECT
        user_pseudo_id,
        MIN(event_timestamp) AS first_event_timestamp,
        event_name AS quickplay_event_type
    FROM
        `firebase-public-project.analytics_153293282.events_*`
    WHERE
        event_date BETWEEN '20180702' AND '20180716'
        AND event_name IN (
            'level_start_quickplay',
            'level_complete_quickplay',
            'level_fail_quickplay',
            'level_end_quickplay',
            'level_reset_quickplay',
            'level_retry_quickplay'
        )
    GROUP BY
        user_pseudo_id,
        event_name
),
session_users AS (
    SELECT DISTINCT user_pseudo_id
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE event_name = 'session_start'
      AND event_date BETWEEN '20180702' AND '20180716'
),
retention AS (
    SELECT
        ie.quickplay_event_type,
        ie.user_pseudo_id,
        ie.first_event_timestamp,
        TIMESTAMP_ADD(TIMESTAMP_MICROS(ie.first_event_timestamp), INTERVAL 14 DAY) AS start_retention_period,
        TIMESTAMP_ADD(TIMESTAMP_MICROS(ie.first_event_timestamp), INTERVAL 28 DAY) AS end_retention_period
    FROM
        initial_events ie
    JOIN
        session_users su
        ON ie.user_pseudo_id = su.user_pseudo_id
),
retained_users AS (
    SELECT DISTINCT
        r.quickplay_event_type,
        r.user_pseudo_id
    FROM
        retention r
    JOIN
        `firebase-public-project.analytics_153293282.events_*` ev
    ON
        r.user_pseudo_id = ev.user_pseudo_id
    WHERE
        ev.event_timestamp BETWEEN
            UNIX_MICROS(r.start_retention_period)
            AND UNIX_MICROS(r.end_retention_period)
        AND ev.event_name = r.quickplay_event_type
),
user_counts AS (
    SELECT
        quickplay_event_type,
        COUNT(DISTINCT user_pseudo_id) AS total_users
    FROM
        retention
    GROUP BY
        quickplay_event_type
),
retained_counts AS (
    SELECT
        quickplay_event_type,
        COUNT(DISTINCT user_pseudo_id) AS retained_users
    FROM
        retained_users
    GROUP BY
        quickplay_event_type
)
SELECT
    uc.quickplay_event_type,
    ROUND(100 * IFNULL(rc.retained_users, 0) / uc.total_users, 4) AS retention_rate_after_two_weeks
FROM
    user_counts uc
LEFT JOIN
    retained_counts rc
    ON uc.quickplay_event_type = rc.quickplay_event_type
ORDER BY
    uc.quickplay_event_type;
2025-01-30 00:44:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-30 00:44:10 - root - INFO - ```sql
WITH initial_events AS (
    SELECT
        user_pseudo_id,
        MIN(event_timestamp) AS first_event_timestamp,
        event_name AS quickplay_event_type
    FROM
        `firebase-public-project.analytics_153293282.events_*`
    WHERE
        event_date BETWEEN '20180702' AND '20180716'
        AND event_name IN (
            'level_complete_quickplay',
            'level_end_quickplay',
            'level_fail_quickplay',
            'level_reset_quickplay',
            'level_retry_quickplay',
            'level_start_quickplay'
        )
    GROUP BY
        user_pseudo_id,
        event_name
),
session_users AS (
    SELECT DISTINCT user_pseudo_id
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE event_name = 'session_start'
      AND event_date BETWEEN '20180702' AND '20180716'
),
retention AS (
    SELECT
        ie.quickplay_event_type,
        ie.user_pseudo_id,
        ie.first_event_timestamp,
        TIMESTAMP_ADD(TIMESTAMP_MICROS(ie.first_event_timestamp), INTERVAL 14 DAY) AS start_retention_period,
        TIMESTAMP_ADD(TIMESTAMP_MICROS(ie.first_event_timestamp), INTERVAL 28 DAY) AS end_retention_period
    FROM
        initial_events ie
    JOIN
        session_users su
        ON ie.user_pseudo_id = su.user_pseudo_id
),
retained_users AS (
    SELECT DISTINCT
        r.quickplay_event_type,
        r.user_pseudo_id
    FROM
        retention r
    JOIN
        `firebase-public-project.analytics_153293282.events_*` ev
    ON
        r.user_pseudo_id = ev.user_pseudo_id
    WHERE
        ev.event_timestamp BETWEEN
            UNIX_MICROS(r.start_retention_period)
            AND UNIX_MICROS(r.end_retention_period)
        AND ev.event_name = r.quickplay_event_type
),
user_counts AS (
    SELECT
        quickplay_event_type,
        COUNT(DISTINCT user_pseudo_id) AS total_users
    FROM
        retention
    GROUP BY
        quickplay_event_type
),
retained_counts AS (
    SELECT
        quickplay_event_type,
        COUNT(DISTINCT user_pseudo_id) AS retained_users
    FROM
        retained_users
    GROUP BY
        quickplay_event_type
)
SELECT
    uc.quickplay_event_type,
    ROUND(100 * IFNULL(rc.retained_users, 0) / uc.total_users, 4) AS retention_rate_after_two_weeks
FROM
    user_counts uc
LEFT JOIN
    retained_counts rc
    ON uc.quickplay_event_type = rc.quickplay_event_type
ORDER BY
    uc.quickplay_event_type;
```
2025-01-30 00:44:17 - root - INFO - itercount: 2
2025-01-30 00:44:17 - root - INFO - 0
2025-01-30 00:44:17 - root - INFO - Total iteration counts: 2
