2025-01-28 06:01:47 - openai._base_client - INFO - Retrying request to /chat/completions in 0.485829 seconds
2025-01-28 06:02:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-28 06:02:41 - root - INFO - SQL:
-- 1. List all distinct provider states
SELECT DISTINCT nppes_provider_state
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
LIMIT 100;
Results:
nppes_provider_state
CA
NY
TX
NJ
IN
OR
MS
VA
PR
CO
PA
NC
WY
NM
MN
WI
TN
GA
ME
CT
NV
DE
RI
HI
MP
AS
OH
MI
FL
SC
OK
KY
WA
SD
KS
LA
MA
ID
IL
AL
UT
AR
IA
MD
AZ
ND
NH
NE
MO
MT
WV
VT
AK
DC
VI
ZZ
AP
AE
GU
AA
XX

2025-01-28 06:02:43 - root - INFO - SQL:
-- 2. List all distinct drug names
SELECT DISTINCT drug_name
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
LIMIT 100;
Results:
drug_name
LANTUS SOLOSTAR
GABAPENTIN
LATANOPROST
FLUTICASONE PROPIONATE
LISINOPRIL-HYDROCHLOROTHIAZIDE
LISINOPRIL
ENOXAPARIN SODIUM
FLUOXETINE HCL
SYMBICORT
POLYETHYLENE GLYCOL 3350
QUETIAPINE FUMARATE
NAPROXEN
TEMAZEPAM
ALLOPURINOL
PAROXETINE HCL
LOSARTAN POTASSIUM
PREDNISONE
TAMSULOSIN HCL
PENICILLIN V POTASSIUM
DULERA
TRIAMCINOLONE ACETONIDE
TRIAMTERENE-HYDROCHLOROTHIAZID
NIFEDIPINE ER
DIAZEPAM
VENLAFAXINE HCL ER
KETOCONAZOLE
LEVOCETIRIZINE DIHYDROCHLORIDE
NOVOLOG FLEXPEN
INSULIN SYRINGE
DESONIDE
HYDROCHLOROTHIAZIDE
METOPROLOL SUCCINATE
ANASTROZOLE
ZETIA
GAVILYTE-N
NEUPRO
PRAVASTATIN SODIUM
CLONIDINE
MELOXICAM
HYDROCODONE-ACETAMINOPHEN
ETODOLAC
DILTIAZEM 24HR CD
BUPROPION HCL
HYDRALAZINE HCL
PIOGLITAZONE HCL
LOVASTATIN
ILEVRO
BRIMONIDINE TARTRATE
CYCLOGYL
IBUPROFEN
GLIMEPIRIDE
MYRBETRIQ
NITROSTAT
LIDOCAINE
VENLAFAXINE HCL
FAMOTIDINE
BUPROPION HCL SR
NOVOLIN R
CITALOPRAM HBR
TORSEMIDE
BENICAR
CIPROFLOXACIN HCL
LEVEMIR FLEXPEN
SOTALOL
HYDROXYUREA
RESTASIS
SANTYL
AMLODIPINE BESYLATE-BENAZEPRIL
METOCLOPRAMIDE HCL
LACTULOSE
XARELTO
FENOFIBRIC ACID
ROPINIROLE HCL
ESTRADIOL
JANUVIA
DIVALPROEX SODIUM ER
DOXYCYCLINE HYCLATE
CLONIDINE HCL
BUPROPION XL
PROPRANOLOL HCL ER
QVAR
CEFUROXIME
RAMIPRIL
AMOXICILLIN
HYDROCORTISONE
KLOR-CON 10
K-TAB ER
HYDROXYZINE PAMOATE
FLECAINIDE ACETATE
APIDRA
VALACYCLOVIR
IRBESARTAN
ACETAMINOPHEN-CODEINE
CHLORTHALIDONE
TACROLIMUS
HUMALOG MIX 75-25
TRAMADOL HCL-ACETAMINOPHEN
SAPHRIS
MONTELUKAST SODIUM
ISOSORBIDE DINITRATE

2025-01-28 06:02:45 - root - INFO - SQL:
-- 3. Get total number of prescriptions per state
SELECT nppes_provider_state, COUNT(*) AS prescription_count
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY nppes_provider_state
ORDER BY prescription_count DESC
LIMIT 100;
Results:
nppes_provider_state,prescription_count
CA,2314491
NY,1650337
FL,1611230
TX,1472194
PA,1229100
OH,1001853
NC,876296
IL,866555
MI,824210
GA,665123
NJ,650274
TN,634761
MA,557193
MO,553249
IN,536177
VA,532042
WI,463181
WA,458140
KY,451198
AZ,422552
AL,416414
SC,403874
MN,401258
LA,394524
PR,340193
MD,337502
OR,317042
CO,310071
OK,290335
IA,287799
CT,285153
AR,270034
MS,269114
KS,245809
WV,205148
NE,166946
NV,149874
ME,138404
UT,137461
NM,131194
ID,112680
NH,103139
RI,100820
MT,79659
HI,79295
SD,75409
DE,68643
ND,66876
VT,53720
DC,40964
WY,34780
AK,28789
VI,3909
GU,1966
ZZ,940
AE,258
MP,253
AP,95
XX,77
AA,29
AS,12

2025-01-28 06:02:47 - root - INFO - SQL:
-- 4. Get total claim counts per drug
SELECT drug_name, SUM(total_claim_count) AS total_claims
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY drug_name
ORDER BY total_claims DESC
LIMIT 100;
Results:
drug_name,total_claims
LISINOPRIL,37599566
LEVOTHYROXINE SODIUM,37075950
AMLODIPINE BESYLATE,35659180
SIMVASTATIN,33549777
OMEPRAZOLE,32276944
HYDROCODONE-ACETAMINOPHEN,32204330
ATORVASTATIN CALCIUM,31959252
FUROSEMIDE,26372608
METFORMIN HCL,22952294
GABAPENTIN,21323652
METOPROLOL TARTRATE,20782646
LOSARTAN POTASSIUM,17873509
HYDROCHLOROTHIAZIDE,17373067
METOPROLOL SUCCINATE,16781720
WARFARIN SODIUM,15241971
CLOPIDOGREL,14563125
PRAVASTATIN SODIUM,14190361
CARVEDILOL,13310395
TRAMADOL HCL,13242625
ALPRAZOLAM,13081892
ATENOLOL,12883671
POTASSIUM CHLORIDE,12506552
TAMSULOSIN HCL,11685280
SERTRALINE HCL,11187864
PANTOPRAZOLE SODIUM,11071364
CITALOPRAM HBR,10234686
PREDNISONE,9844536
TRAZODONE HCL,9663151
FLUTICASONE PROPIONATE,9614633
LORAZEPAM,9560017
ZOLPIDEM TARTRATE,9448045
CLONAZEPAM,9267099
CRESTOR,8600472
OXYCODONE-ACETAMINOPHEN,8250381
DONEPEZIL HCL,8052913
MELOXICAM,7921650
PROAIR HFA,7686762
ALLOPURINOL,7530262
ALENDRONATE SODIUM,7293735
RANITIDINE HCL,7170871
LISINOPRIL-HYDROCHLOROTHIAZIDE,7042874
NEXIUM,6968108
MONTELUKAST SODIUM,6855005
ESCITALOPRAM OXALATE,6711864
DULOXETINE HCL,6503301
QUETIAPINE FUMARATE,6398416
LATANOPROST,6339049
AZITHROMYCIN,6135891
CIPROFLOXACIN HCL,5924418
FLUOXETINE HCL,5834784
GLIMEPIRIDE,5613158
OXYCODONE HCL,5603775
LOVASTATIN,5551048
ISOSORBIDE MONONITRATE ER,5542060
ADVAIR DISKUS,5541448
LOSARTAN-HYDROCHLOROTHIAZIDE,5512996
SPIRIVA,5339480
SYNTHROID,5306839
MIRTAZAPINE,5235802
GLIPIZIDE,5077217
AMOXICILLIN,4970056
FENOFIBRATE,4957587
NAMENDA,4879366
SPIRONOLACTONE,4612646
RISPERIDONE,4511603
TRIAMTERENE-HYDROCHLOROTHIAZID,4407324
FINASTERIDE,4357389
IBUPROFEN,4326254
PAROXETINE HCL,4313490
CLONIDINE HCL,4299189
ENALAPRIL MALEATE,4211624
JANUVIA,4112402
LANTUS SOLOSTAR,3967264
LYRICA,3933987
METFORMIN HCL ER,3927209
LANTUS,3799781
VENLAFAXINE HCL ER,3776399
CEPHALEXIN,3636174
FAMOTIDINE,3621252
DIOVAN,3614837
SULFAMETHOXAZOLE-TRIMETHOPRIM,3569752
AMITRIPTYLINE HCL,3539561
DIAZEPAM,3510005
HYDRALAZINE HCL,3501872
LEVOFLOXACIN,3378066
POLYETHYLENE GLYCOL 3350,3178311
ZETIA,3174655
TEMAZEPAM,3171737
VALSARTAN-HYDROCHLOROTHIAZIDE,3065182

2025-01-28 06:02:49 - root - INFO - SQL:
-- 5. Get total claim counts per state
SELECT nppes_provider_state, SUM(total_claim_count) AS total_claims
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY nppes_provider_state
ORDER BY total_claims DESC
LIMIT 100;
Results:
nppes_provider_state,total_claims
CA,116440694
FL,91441123
NY,79570924
TX,75682169
PA,62946334
OH,53494076
NC,46020420
IL,42527191
MI,39461213
GA,39066489
TN,35472398
MO,31071230
NJ,29242463
IN,27822613
KY,26196384
AL,26162156
MA,26156247
VA,25549776
PR,24988874
LA,22456360
SC,21795317
WI,21461606
AZ,19873807
WA,19108957
MN,17312127
MS,15737130
AR,15647866
OK,14918485
IA,14673562
OR,13889191
MD,13798859
CT,12892970
CO,12823030
KS,12042320
WV,11216491
NE,7991763
NV,7457176
UT,5796245
NM,5770207
ME,5699119
RI,5535266
ID,4852448
NH,4095519
HI,3777714
SD,3525885
MT,3315266
ND,3061665
DE,3042265
VT,2115996
DC,1487724
WY,1380174
AK,1074367
VI,197072
GU,76979
ZZ,33284
AE,7617
MP,7104
XX,1909
AP,1839
AA,999
AS,218

2025-01-28 06:02:51 - root - INFO - SQL:
-- 6. Get total claim counts per state and drug
SELECT nppes_provider_state, drug_name, SUM(total_claim_count) AS total_claims
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY nppes_provider_state, drug_name
ORDER BY total_claims DESC
LIMIT 100;
Results:
nppes_provider_state,drug_name,total_claims
CA,HYDROCODONE-ACETAMINOPHEN,3726576
CA,AMLODIPINE BESYLATE,3725846
CA,ATORVASTATIN CALCIUM,3672387
CA,LEVOTHYROXINE SODIUM,3489384
CA,SIMVASTATIN,3391598
CA,LISINOPRIL,3328132
CA,OMEPRAZOLE,2893661
FL,LISINOPRIL,2871093
TX,HYDROCODONE-ACETAMINOPHEN,2828779
FL,AMLODIPINE BESYLATE,2689327
NY,AMLODIPINE BESYLATE,2606392
FL,OMEPRAZOLE,2591089
CA,METFORMIN HCL,2583231
FL,LEVOTHYROXINE SODIUM,2561909
FL,SIMVASTATIN,2530274
NY,SIMVASTATIN,2483824
TX,LEVOTHYROXINE SODIUM,2447248
TX,LISINOPRIL,2351958
NY,ATORVASTATIN CALCIUM,2343736
CA,LOSARTAN POTASSIUM,2213792
TX,AMLODIPINE BESYLATE,2212275
NY,OMEPRAZOLE,2158771
NY,LEVOTHYROXINE SODIUM,2091879
FL,ATORVASTATIN CALCIUM,2064692
PA,LISINOPRIL,2033522
PA,LEVOTHYROXINE SODIUM,2024303
CA,FUROSEMIDE,1999403
PA,SIMVASTATIN,1931843
TX,ATORVASTATIN CALCIUM,1879085
NY,LISINOPRIL,1878852
TX,SIMVASTATIN,1858339
FL,METFORMIN HCL,1845228
CA,HYDROCHLOROTHIAZIDE,1788127
MI,HYDROCODONE-ACETAMINOPHEN,1787940
CA,GABAPENTIN,1785041
CA,ATENOLOL,1782218
OH,LISINOPRIL,1778440
PA,AMLODIPINE BESYLATE,1760543
PA,ATORVASTATIN CALCIUM,1743254
PA,OMEPRAZOLE,1734422
FL,HYDROCODONE-ACETAMINOPHEN,1725922
CA,METOPROLOL TARTRATE,1655218
OH,LEVOTHYROXINE SODIUM,1624110
NY,FUROSEMIDE,1604273
TX,FUROSEMIDE,1601027
FL,METOPROLOL TARTRATE,1589154
FL,FUROSEMIDE,1575080
OH,ATORVASTATIN CALCIUM,1546208
FL,LOSARTAN POTASSIUM,1538109
PA,FUROSEMIDE,1506694
NY,METOPROLOL SUCCINATE,1497362
NY,METFORMIN HCL,1483466
NY,METOPROLOL TARTRATE,1476125
FL,GABAPENTIN,1474132
OH,AMLODIPINE BESYLATE,1468596
FL,ALPRAZOLAM,1439338
PA,METOPROLOL TARTRATE,1436931
TX,OMEPRAZOLE,1421370

2025-01-28 06:02:53 - root - INFO - SQL:
-- 7. Find top 5 most prescribed drugs in California
SELECT drug_name, SUM(total_claim_count) AS total_claims
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
WHERE nppes_provider_state = 'CA'
GROUP BY drug_name
ORDER BY total_claims DESC
LIMIT 5;
Results:
drug_name,total_claims
HYDROCODONE-ACETAMINOPHEN,3726576
AMLODIPINE BESYLATE,3725846
ATORVASTATIN CALCIUM,3672387
LEVOTHYROXINE SODIUM,3489384
SIMVASTATIN,3391598

2025-01-28 06:02:55 - root - INFO - SQL:
-- 8. Get total number of beneficiaries per drug
SELECT drug_name, SUM(bene_count) AS total_beneficiaries
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY drug_name
ORDER BY total_beneficiaries DESC
LIMIT 100;
Results:
drug_name,total_beneficiaries
HYDROCODONE-ACETAMINOPHEN,10817697
LISINOPRIL,8675692
AMLODIPINE BESYLATE,7682266
SIMVASTATIN,7497208
ATORVASTATIN CALCIUM,7405135
OMEPRAZOLE,7300874
LEVOTHYROXINE SODIUM,7245310
FUROSEMIDE,5852856
METFORMIN HCL,4900356
AZITHROMYCIN,4774572
GABAPENTIN,4651440
PREDNISONE,4586037
CIPROFLOXACIN HCL,4457864
METOPROLOL TARTRATE,4360023
TRAMADOL HCL,4246389
HYDROCHLOROTHIAZIDE,3845495
FLUTICASONE PROPIONATE,3702451
LOSARTAN POTASSIUM,3701880
AMOXICILLIN,3612816
METOPROLOL SUCCINATE,3325886
PRAVASTATIN SODIUM,2922575
OXYCODONE-ACETAMINOPHEN,2748892
CLOPIDOGREL,2720095
PROAIR HFA,2624217
CEPHALEXIN,2592387
CARVEDILOL,2564595
LEVOFLOXACIN,2549252
ALPRAZOLAM,2468364
POTASSIUM CHLORIDE,2456536
ATENOLOL,2456457
WARFARIN SODIUM,2412911
TAMSULOSIN HCL,2335881
PANTOPRAZOLE SODIUM,2260849
SULFAMETHOXAZOLE-TRIMETHOPRIM,2247455
MELOXICAM,2236180
LORAZEPAM,1873998
AMOX TR-POTASSIUM CLAVULANATE,1785717
ZOLPIDEM TARTRATE,1768819
TRAZODONE HCL,1739764
METHYLPREDNISOLONE,1729370
SERTRALINE HCL,1720269
CITALOPRAM HBR,1641972
IBUPROFEN,1530694
TRIAMCINOLONE ACETONIDE,1489891
PREDNISOLONE ACETATE,1455967
CRESTOR,1420185
CLONAZEPAM,1312098
LISINOPRIL-HYDROCHLOROTHIAZIDE,1282602
LATANOPROST,1247824
RANITIDINE HCL,1223838
OXYCODONE HCL,1211847
ALLOPURINOL,1195957
ALENDRONATE SODIUM,1183838
DONEPEZIL HCL,1111167
MONTELUKAST SODIUM,1096358
DOXYCYCLINE HYCLATE,1067596
NEXIUM,971653
ADVAIR DISKUS,941621
GLIMEPIRIDE,911256
LOVASTATIN,883168
NAPROXEN,868369
ZOSTAVAX,866039
ESCITALOPRAM OXALATE,859694
NITROSTAT,831141
LOSARTAN-HYDROCHLOROTHIAZIDE,811266
ISOSORBIDE MONONITRATE ER,806568
MUPIROCIN,794516
SPIRIVA,794338
SYNTHROID,787996
DULOXETINE HCL,766721
GLIPIZIDE,760896
QUETIAPINE FUMARATE,755979
FINASTERIDE,712001
MIRTAZAPINE,708195
ACETAMINOPHEN-CODEINE,700454
POLYETHYLENE GLYCOL 3350,691040
FLUOXETINE HCL,686133
CLOBETASOL PROPIONATE,672141
TRIAMTERENE-HYDROCHLOROTHIAZID,645974

2025-01-28 06:02:57 - root - INFO - SQL:
-- 9. Calculate average cost per prescription for each drug
SELECT drug_name, SUM(total_drug_cost)/SUM(total_claim_count) AS avg_cost_per_prescription
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY drug_name
ORDER BY avg_cost_per_prescription DESC
LIMIT 100;
Results:
drug_name,avg_cost_per_prescription
ADAGEN,94218.08307692308
ELAPRASE,58922.49405405405
CINRYZE,52784.52038490566
FIRAZYR,48099.664440753055
BERINERT,47776.396711590285
CARBAGLU,44471.74333333333
NAGLAZYME,42268.612844036696
RAVICTI,41223.500497925306
PROCYSBI,40156.55495327103
ALDURAZYME,39379.55583333333
H.P. ACTHAR,39204.23321896073
CHENODAL,36052.11075000001
ACTIMMUNE,33417.86827683616
YERVOY,32363.61
HARVONI,32080.829197146304
GATTEX,28956.995817245814
KALBITOR,28842.325021897806
SOVALDI,28340.424900299837
ELELYSO,28307.300000000003
JUXTAPID,27518.29496865204
LUMIZYME,27010.800597014924
KALYDECO,25481.912769516726
VPRIV,22641.465223880597
OLYSIO,22558.138000295647
INCIVEK,22557.087058823527
APOKYN,22329.24423580786
SOLIRIS,22265.210060240966
ARCALYST,21002.0
REMODULIN,20897.5380952381
MOZOBIL,20282.172083333335
KYNAMRO,20201.490625000002
ILARIS,19728.650555555552
VENTAVIS,17345.661
ZAVESCA,16975.584468085104
KORLYM,15957.928796296295
TARGRETIN,15888.06256
SYPRINE,15785.365827586207
ADCETRIS,15459.004
SIGNIFOR,15243.0755
KUVAN,14731.920958286355
FABRAZYME,14477.500735551663
CEREZYME,14467.57185858586
TYVASO,14185.003846153842
AFINITOR DISPERZ,13565.781923076924
BIVIGAM,12455.43
XALKORI,11575.664203494345
SABRIL,11442.97229428173
STELARA,11051.114118488837
POMALYST,10956.69026162791
ICLUSIG,10725.371255230126
OCTAGAM,10576.266011477763
COMETRIQ,10489.468520179375
SEROSTIM,10414.583615059546
KEYTRUDA,10196.00846153846
ACTIQ,10121.035454545454
CAPRELSA,9873.375465686275
AFINITOR,9699.803753008038
INLYTA,9660.476653789005
STIVARGA,9531.084188398085
TALWIN,9481.949999999999
REVLIMID,9364.143442414335
ZEMAIRA,9301.863337570363
ZYKADIA,9105.113513513514
MEKINIST,9028.769855687604
JEVTANA,9015.62534883721
JAKAFI,8997.707499677379
ERIVEDGE,8984.350845070423
IMBRUVICA,8907.086982665869
DACOGEN,8906.497647058823
ZELBORAF,8896.525093023258

2025-01-28 06:02:59 - root - INFO - SQL:
-- 10. Find the most prescribed medication in each state
SELECT
  state_drug.nppes_provider_state AS State,
  state_drug.drug_name AS Drug_Name,
  state_drug.total_claims AS Total_Claims
FROM (
  SELECT
    nppes_provider_state,
    drug_name,
    SUM(total_claim_count) AS total_claims,
    RANK() OVER (PARTITION BY nppes_provider_state ORDER BY SUM(total_claim_count) DESC) AS rank
  FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
  GROUP BY nppes_provider_state, drug_name
) AS state_drug
WHERE state_drug.rank = 1
ORDER BY state_drug.nppes_provider_state
LIMIT 100;
Results:
State,Drug_Name,Total_Claims
AA,AMOXICILLIN,225
AE,HYDROCODONE-ACETAMINOPHEN,654
AK,LISINOPRIL,47684
AL,HYDROCODONE-ACETAMINOPHEN,1213330
AP,HYDROCODONE-ACETAMINOPHEN,208
AR,HYDROCODONE-ACETAMINOPHEN,587649
AS,LISINOPRIL,46
AZ,LISINOPRIL,828863
CA,HYDROCODONE-ACETAMINOPHEN,3726576
CO,LEVOTHYROXINE SODIUM,589164
CT,ATORVASTATIN CALCIUM,461074
DC,AMLODIPINE BESYLATE,69324
DE,ATORVASTATIN CALCIUM,97290
FL,LISINOPRIL,2871093
GA,AMLODIPINE BESYLATE,1281335
GU,AMLODIPINE BESYLATE,5271
HI,ATORVASTATIN CALCIUM,156380
IA,LEVOTHYROXINE SODIUM,544870
ID,HYDROCODONE-ACETAMINOPHEN,211426
IL,LISINOPRIL,1334343
IN,HYDROCODONE-ACETAMINOPHEN,1035865
KS,LEVOTHYROXINE SODIUM,447078
KY,HYDROCODONE-ACETAMINOPHEN,983246
LA,HYDROCODONE-ACETAMINOPHEN,793627
MA,LISINOPRIL,1126516
MD,LISINOPRIL,463264
ME,LISINOPRIL,208274
MI,HYDROCODONE-ACETAMINOPHEN,1787940
MN,LISINOPRIL,692802
MO,LISINOPRIL,1064850
MP,AMLODIPINE BESYLATE,564
MS,HYDROCODONE-ACETAMINOPHEN,623183
MT,LEVOTHYROXINE SODIUM,145710
NC,AMLODIPINE BESYLATE,1389222
ND,LEVOTHYROXINE SODIUM,114009
NE,LEVOTHYROXINE SODIUM,308512
NH,LISINOPRIL,149289
NJ,ATORVASTATIN CALCIUM,945135
NM,LEVOTHYROXINE SODIUM,267086
NV,HYDROCODONE-ACETAMINOPHEN,294378
NY,AMLODIPINE BESYLATE,2606392
OH,LISINOPRIL,1778440
OK,HYDROCODONE-ACETAMINOPHEN,638774
OR,LISINOPRIL,541027
PA,LISINOPRIL,2033522
PR,SIMVASTATIN,1101152
RI,LISINOPRIL,212723
SC,HYDROCODONE-ACETAMINOPHEN,704846
SD,LEVOTHYROXINE SODIUM,142784
TN,HYDROCODONE-ACETAMINOPHEN,1377155
TX,HYDROCODONE-ACETAMINOPHEN,2828779
UT,LEVOTHYROXINE SODIUM,230671
VA,LISINOPRIL,818906
VI,AMLODIPINE BESYLATE,12153
VT,LISINOPRIL,74698
WA,LISINOPRIL,771338
WI,LISINOPRIL,679420
WV,HYDROCODONE-ACETAMINOPHEN,400008
WY,LEVOTHYROXINE SODIUM,72201
XX,SIMVASTATIN,135
ZZ,HYDROCODONE-ACETAMINOPHEN,2232

2025-01-28 06:03:04 - root - INFO - SQL:
-- 11. Find the number of providers prescribing each drug
SELECT drug_name, COUNT(DISTINCT npi) AS provider_count
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY drug_name
ORDER BY provider_count DESC
LIMIT 100;
Results:
drug_name,provider_count
HYDROCODONE-ACETAMINOPHEN,332670
LISINOPRIL,273518
OMEPRAZOLE,264842
AMLODIPINE BESYLATE,259828
GABAPENTIN,254001
ATORVASTATIN CALCIUM,247176
FUROSEMIDE,240799
LEVOTHYROXINE SODIUM,239458
SIMVASTATIN,239013
METOPROLOL TARTRATE,225246
HYDROCHLOROTHIAZIDE,219320
TRAMADOL HCL,215668
METFORMIN HCL,211800
PREDNISONE,211480
LOSARTAN POTASSIUM,203941
METOPROLOL SUCCINATE,197700
CLOPIDOGREL,188714
PANTOPRAZOLE SODIUM,187685
SERTRALINE HCL,182566
ATENOLOL,182027
WARFARIN SODIUM,180434
FLUTICASONE PROPIONATE,179744
PRAVASTATIN SODIUM,179715
CARVEDILOL,178731
ZOLPIDEM TARTRATE,172579
CIPROFLOXACIN HCL,169102
AZITHROMYCIN,168900
CITALOPRAM HBR,168733
ALPRAZOLAM,168384
PROAIR HFA,167530
POTASSIUM CHLORIDE,166692
TRAZODONE HCL,166204
AMOXICILLIN,164821
OXYCODONE-ACETAMINOPHEN,162469
LORAZEPAM,161133
TAMSULOSIN HCL,158762
CLONAZEPAM,150597
CRESTOR,147617
ALLOPURINOL,147379
ALENDRONATE SODIUM,140647
DULOXETINE HCL,138852
NEXIUM,138178
MELOXICAM,137191
RANITIDINE HCL,137158
FLUOXETINE HCL,136811
LISINOPRIL-HYDROCHLOROTHIAZIDE,136204
MONTELUKAST SODIUM,136058
ESCITALOPRAM OXALATE,134842
ADVAIR DISKUS,130418
IBUPROFEN,127341
SULFAMETHOXAZOLE-TRIMETHOPRIM,126831
CEPHALEXIN,126152
DONEPEZIL HCL,123016
PAROXETINE HCL,118198
SPIRONOLACTONE,117954
SPIRIVA,116721
LOVASTATIN,112837
LOSARTAN-HYDROCHLOROTHIAZIDE,112536
ISOSORBIDE MONONITRATE ER,110988
AMITRIPTYLINE HCL,110942
GLIPIZIDE,110692
CLONIDINE HCL,109254
LEVOFLOXACIN,107904
TRIAMTERENE-HYDROCHLOROTHIAZID,106790
QUETIAPINE FUMARATE,105229
LYRICA,104553
VENLAFAXINE HCL ER,103054
FENOFIBRATE,101933
MIRTAZAPINE,101307
SYNTHROID,100029
LANTUS SOLOSTAR,99510
DIOVAN,98054
DIAZEPAM,97824
ENALAPRIL MALEATE,96564
GLIMEPIRIDE,95714
OXYCODONE HCL,95207
JANUVIA,95176
LANTUS,94668
NAPROXEN,92706
AMOX TR-POTASSIUM CLAVULANATE,91950
CYCLOBENZAPRINE HCL,90498
TRIAMCINOLONE ACETONIDE,89505
FAMOTIDINE,88666
HYDRALAZINE HCL,87758
ZETIA,85915
CELEBREX,85912
METFORMIN HCL ER,85254
FINASTERIDE,85112

2025-01-28 06:03:06 - root - INFO - SQL:
-- 12. Get total drug cost per state
SELECT nppes_provider_state, SUM(total_drug_cost) AS total_cost
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY nppes_provider_state
ORDER BY total_cost DESC
LIMIT 100;
Results:
nppes_provider_state,total_cost
CA,9633494580.83
NY,7521861271.35999
FL,6969574542.379993
TX,6462480867.609992
PA,4841813377.079992
OH,4050597920.300001
NC,3357740486.2099996
MI,3193421559.0900006
IL,3120595897.41
NJ,2980085648.5600014
GA,2787324531.740001
TN,2449796259.9899974
MO,2266900573.05
IN,2151310576.0699973
MA,1993379967.3800004
VA,1845291759.1399996
AL,1774188310.3900003
KY,1749915624.0499985
SC,1625039227.0200002
WI,1595424680.749999
LA,1586697376.66
AZ,1531414913.7199998
WA,1374073749.7699993
MD,1285911121.54
MN,1268712288.7500005
CT,1213947159.8299997
OK,1099747189.1000004
PR,998242828.4500014
CO,987955657.2399999
MS,971791465.0899996
OR,940748728.5399998
AR,924771139.8099996
IA,851657297.3799996
KS,812376124.8000007
WV,774905769.86
NV,530336271.7500001
NE,513097615.1699999
UT,446198781.29000014
ME,445414042.08
NM,402878429.6
RI,345326474.99000007
HI,342155461.1400002
ID,340866011.09
NH,322343632.6399999
DE,313539382.5
MT,235183327.44999996
SD,233180044.24000004
ND,198826531.82999998
DC,192973624.24999988
VT,171127800.38000014
WY,89775137.25999999
AK,78887893.48
VI,9122593.649999999
GU,3012622.0100000002
ZZ,2394695.3499999996
AE,482799.32
MP,273092.65
AP,68270.66
XX,41955.98999999999
AA,9045.199999999999
AS,1660.4500000000003

2025-01-28 06:03:08 - root - INFO - SQL:
-- 13. List drugs with the highest total drug cost
SELECT drug_name, SUM(total_drug_cost) AS total_cost
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY drug_name
ORDER BY total_cost DESC
LIMIT 100;
Results:
drug_name,total_cost
SOVALDI,2485823689.28
NEXIUM,2422256935.2699995
CRESTOR,2395819380.209999
ABILIFY,2246738757.4499993
ADVAIR DISKUS,2064905171.0499985
SPIRIVA,1956946798.48
LANTUS SOLOSTAR,1805583150.83
JANUVIA,1591852562.3299997
LANTUS,1511895513.56
REVLIMID,1501156471.1099997
DULOXETINE HCL,1299549926.3799994
NAMENDA,1241647331.020001
LYRICA,1208504599.4599996
COPAXONE,1084451472.8400002
HUMIRA,1061315938.98
ENBREL,1059207127.8000001
XARELTO,915381796.09
ZETIA,898243212.4600005
CELEBREX,881309305.3099996
OXYCONTIN,851332366.6400001
RENVELA,802718750.14
SYMBICORT,790798550.2900001
DIOVAN,784411444.9700001
GLEEVEC,783235048.15
HUMALOG,752870628.3700002
ATORVASTATIN CALCIUM,733947717.3100002
SENSIPAR,683162759.69
HYDROCODONE-ACETAMINOPHEN,658789651.37
METOPROLOL SUCCINATE,646937388.21
NOVOLOG FLEXPEN,625962433.6000001
LEVOTHYROXINE SODIUM,621294485.3900005
TRUVADA,620532757.1500001
OLYSIO,610400656.1499999
ZYTIGA,559179652.48
TECFIDERA,525482767.33
RESTASIS,523204440.12
ATRIPLA,518824755.4399998
OMEPRAZOLE,517533247.78000003
LEVEMIR FLEXPEN,491353136.93
INVEGA SUSTENNA,490550534.99
SEROQUEL XR,489588648.6700001
VESICARE,488845587.36999977
GABAPENTIN,475796482.4899998
PROAIR HFA,451525668.5599999
EXELON,450012839.46999997
NAMENDA XR,444653593.32000005
OXYCODONE-ACETAMINOPHEN,444323992.0899998
PRADAXA,443856922.4499999
FENOFIBRATE,438239797.47999996
PRAVASTATIN SODIUM,432287194.7399998
NOVOLOG,396680339.9199999
ISENTRESS,374356991.35
PREZISTA,365911525.47
POTASSIUM CHLORIDE,364394350.9599998
LETAIRIS,363415750.06
TRACLEER,361118458.96
COMBIVENT RESPIMAT,358973349.4699999
LUMIGAN,358222504.86999995
FENTANYL,345832972.7699999
QUETIAPINE FUMARATE,344499121.15999997
SIMVASTATIN,341421087.82999986
LATUDA,336714149.85
LEVEMIR,328371357.5300001
CLOPIDOGREL,327030151.1399999
LIDOCAINE,323922405.00999993
HARVONI,319268412.17
JANUMET,319255029.14000005
TARCEVA,310565637.91
XTANDI,308447612.5
DIVALPROEX SODIUM ER,307495238.9599999
VICTOZA 3-PAK,306217214.05999994
AMLODIPINE BESYLATE,298507550.6199999
DEXILANT,297462930.8999999
MORPHINE SULFATE ER,290867807.89
RANEXA,289918921.92
BENICAR,282708959.5700001
LISINOPRIL,277213345.6500002
OXYCODONE HCL,272529852.76000005
TAMSULOSIN HCL,272151299.9099999
OLANZAPINE,270030069.6700001
FORTEO,269541419.89
TRAVATAN Z,268699916.27
GILENYA,256725761.24999997
LOSARTAN POTASSIUM,256379132.92999998
REYATAZ,252765728.40000007

2025-01-28 06:03:10 - root - INFO - SQL:
-- 14. Get total beneficiaries aged 65+ per drug
SELECT drug_name, SUM(bene_count_ge65) AS beneficiaries_65_plus
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY drug_name
ORDER BY beneficiaries_65_plus DESC
LIMIT 100;
Results:
drug_name,beneficiaries_65_plus
HYDROCODONE-ACETAMINOPHEN,3883349
LISINOPRIL,2651998
OMEPRAZOLE,2422390
AMLODIPINE BESYLATE,2001780
LEVOTHYROXINE SODIUM,1950708
SIMVASTATIN,1909051
ATORVASTATIN CALCIUM,1876894
FUROSEMIDE,1511192
GABAPENTIN,1372683
METFORMIN HCL,1343137
PREDNISONE,1286630
AZITHROMYCIN,1219132
CIPROFLOXACIN HCL,1123199
TRAMADOL HCL,1098659
METOPROLOL TARTRATE,957220
AMOXICILLIN,871558
FLUTICASONE PROPIONATE,840562
LOSARTAN POTASSIUM,830905
HYDROCHLOROTHIAZIDE,813544
TAMSULOSIN HCL,713260
PRAVASTATIN SODIUM,710091
METOPROLOL SUCCINATE,695195
CLOPIDOGREL,661094
OXYCODONE-ACETAMINOPHEN,654360
PREDNISOLONE ACETATE,648581
CARVEDILOL,642135
LEVOFLOXACIN,580143
ALPRAZOLAM,576331
POTASSIUM CHLORIDE,565691
ZOSTAVAX,563827
WARFARIN SODIUM,553508
MELOXICAM,544731
PROAIR HFA,541022
CEPHALEXIN,536946
DONEPEZIL HCL,531151
ATENOLOL,519653
PANTOPRAZOLE SODIUM,470043
METHYLPREDNISOLONE,417082
SULFAMETHOXAZOLE-TRIMETHOPRIM,416766
ALENDRONATE SODIUM,400019
LATANOPROST,381354
LORAZEPAM,357478
TRIAMCINOLONE ACETONIDE,335573
AMOX TR-POTASSIUM CLAVULANATE,332445
CRESTOR,328058
ZOLPIDEM TARTRATE,318470
ALLOPURINOL,304775
SYNTHROID,302041
RANITIDINE HCL,294698
TRAZODONE HCL,294326
IBUPROFEN,291068
SERTRALINE HCL,285379
CITALOPRAM HBR,283001
LISINOPRIL-HYDROCHLOROTHIAZIDE,257756
FINASTERIDE,256705
LOSARTAN-HYDROCHLOROTHIAZIDE,248584
MONTELUKAST SODIUM,248168
LOVASTATIN,239732
NAMENDA,236966
OXYCODONE HCL,228901
ISOSORBIDE MONONITRATE ER,205739
CLONAZEPAM,200567
NITROSTAT,200421
CLOBETASOL PROPIONATE,200204
TRIAMTERENE-HYDROCHLOROTHIAZID,194245
DOXYCYCLINE HYCLATE,193843
METHOTREXATE,192703
OFLOXACIN,190494
SPIRIVA,186442
GLIMEPIRIDE,185744
NEXIUM,184226
ADVAIR DISKUS,183170
MUPIROCIN,177691
ESCITALOPRAM OXALATE,176776
POLYETHYLENE GLYCOL 3350,176727
MIRTAZAPINE,176533
KETOROLAC TROMETHAMINE,163903

2025-01-28 06:03:12 - root - INFO - SQL:
-- 15. Calculate average day supply per prescription for each drug
SELECT drug_name, SUM(total_day_supply)/SUM(total_claim_count) AS avg_day_supply
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY drug_name
ORDER BY avg_day_supply DESC
LIMIT 100;
Results:
drug_name,avg_day_supply
RECLAST,139.71604938271605
PROLIA,92.50020453243884
MYOBLOC,89.5
ESTRING,84.74696713615023
FEMRING,82.59065934065934
TOPROL XL,81.32471221227699
ELIPHOS,81.1906432748538
ROCALTROL,80.72394781798415
K-TAB ER,80.08234581530076
TRICOR,71.65191792001866
XEOMIN,69.23529411764706
QUASENSE,68.2394366197183
TRELSTAR,66.64630225080386
STELARA,60.50486548368632
MIMVEY LO,60.30769230769231
BOTOX,59.25662304500479
MEFLOQUINE HCL,57.827188940092164
TERAZOSIN HCL,57.37068429544774
LOVASTATIN,56.958063954770346
LISINOPRIL-HYDROCHLOROTHIAZIDE,56.84701131952666
ATENOLOL,56.810568431932175
TRIAMTERENE-HYDROCHLOROTHIAZID,56.543610363113764
ELIGARD,56.27415143603133
NOVOTWIST,55.31561181434599
RENO CAPS,55.22464312546957
SYNTHROID,55.20035260161463
CLIMARA,55.14840782938943
IN CONTROL PEN NEEDLE,55.12542433446489
SIMVASTATIN,54.95760648423982
LEVOXYL,54.9402819505431
HYDROCHLOROTHIAZIDE,54.55526609089806
FINASTERIDE,54.34736765526328
HEALTHY ACCENTS UNIFINE PENTIP,53.74354407836153
RAMIPRIL,53.73677074410925
PRAVASTATIN SODIUM,53.69261444441054
O-CAL PRENATAL,53.57142857142857
LOSARTAN-HYDROCHLOROTHIAZIDE,53.52488102657792
QUINAPRIL HCL,53.4457663459804
METFORMIN HCL ER,52.968711621917755
AVANDAMET,52.857142857142854
ATORVASTATIN CALCIUM,52.771981928738505
LOSARTAN POTASSIUM,52.63988766839237
CARTIA XT,52.463269179181864
DILT-XR,52.32506445991911
BENAZEPRIL HCL,52.18469057391348
BISOPROLOL-HYDROCHLOROTHIAZIDE,52.00131659352258
LISINOPRIL,51.96040595255807
ALLOPURINOL,51.82094620346543
TESTOSTERONE CYPIONATE,51.8017615667582
UNITHROID,51.29596933441747
DEPO-ESTRADIOL,51.12978986402967
ALFUZOSIN HCL ER,51.01085266709273
BD ULTRA-FINE PEN NEEDLE,50.678014861051594
ESTRADIOL,50.64161965517637
ANASTROZOLE,50.44128734977312
ATENOLOL-CHLORTHALIDONE,50.3754680112461
LEVOTHYROXINE SODIUM,50.11843478049787
TOLAZAMIDE,50.05210084033614
METFORMIN HCL,49.93054885929921
VERAPAMIL ER,49.86303113744174
GLIMEPIRIDE,49.72909492303619
AMLODIPINE BESYLATE,49.728438062793366
METOPROLOL SUCCINATE,49.71783047268099
DOXAZOSIN MESYLATE,49.71373339931497
INDAPAMIDE,49.64534107148065
GLIPIZIDE,49.52288291006668
TAMOXIFEN CITRATE,49.44167689331697
AVANDIA,49.29931972789116
CHLORTHALIDONE,49.25073418164009
IRBESARTAN,49.23917516565443
VALSARTAN-HYDROCHLOROTHIAZIDE,49.18995022155291
LEVOBUNOLOL HCL,49.05213152758652
LUPRON DEPOT,48.73303813740894
AMLODIPINE BESYLATE-BENAZEPRIL,48.67264343211363
BENAZEPRIL-HYDROCHLOROTHIAZIDE,48.64112536461437

2025-01-28 06:03:12 - root - INFO - itercount: 0
2025-01-28 06:03:12 - root - INFO - Database Name: bigquery-public-data
Schema Name: cms_codes
DDL describes table information.
,0
table_name,icd10_procedures_2019
ddl,"CREATE TABLE `bigquery-public-data.cms_codes.icd10_procedures_2019`
(
  order_number STRING OPTIONS(description=""Unique identifier that makes it easier for users to communicate a range of codes""),
  pcs_code STRING OPTIONS(description=""Procedure code""),
  is_header_code BOOL OPTIONS(description=""TRUE - The code is a “header” code and not valid for HIPAA-covered transactions. FALSE - The code is valid for submission for HIPAA-covered transactions.""),
  short_description STRING OPTIONS(description=""Short text description of the procedure""),
  long_description STRING OPTIONS(description=""Full text description of the procedure"")
);"

,1
table_name,hcpcs
ddl,"CREATE TABLE `bigquery-public-data.cms_codes.hcpcs`
(
  HCPC STRING,
  SEQNUM STRING,
  RECID INT64,
  LONG_DESCRIPTION STRING,
  SHORT_DESCRIPTION STRING,
  PRICE1 STRING,
  PRICE2 STRING,
  PRICE3 STRING,
  PRICE4 STRING,
  MULT_PI STRING,
  CIM1 STRING,
  CIM2 STRING,
  CIM3 STRING,
  MCM1 FLOAT64,
  MCM2 INT64,
  MCM3 STRING,
  STATUTE STRING,
  LABCERT1 STRING,
  LABCERT2 STRING,
  LABCERT3 STRING,
  LABCERT4 STRING,
  LABCERT5 STRING,
  LABCERT6 STRING,
  LABCERT7 STRING,
  LABCERT8 STRING,
  XREF1 STRING,
  XREF2 STRING,
  XREF3 STRING,
  XREF4 STRING,
  XREF5 STRING,
  COV STRING,
  ASC_GRP STRING,
  ASC_DT STRING,
  OPPS STRING,
  OPPS_PI STRING,
  OPPS_DT STRING,
  PROCNOTE STRING,
  BETOS STRING,
  TOS1 STRING,
  TOS2 STRING,
  TOS3 STRING,
  TOS4 STRING,
  TOS5 STRING,
  ANEST_BU STRING,
  ADD_DT STRING,
  ACT_EFF_DT STRING,
  TERM_DT STRING,
  ACTION_CD BOOL
);"

,2
table_name,icd9_diagnoses
ddl,"CREATE TABLE `bigquery-public-data.cms_codes.icd9_diagnoses`
(
  DIAGNOSIS_CODE STRING,
  LONG_DESCRIPTION STRING,
  SHORT_DESCRIPTION STRING
);"

,3
table_name,icd10_diagnoses_2019
ddl,"CREATE TABLE `bigquery-public-data.cms_codes.icd10_diagnoses_2019`
(
  order_number STRING OPTIONS(description=""Unique header code that makes it easier for users to communicate a range of codes""),
  cm_code STRING OPTIONS(description=""Diagnosis code""),
  is_header_code BOOL OPTIONS(description=""TRUE -  The code is a “header” code and not valid for HIPAA-covered transactions. FALSE - The code is valid for submission for HIPAA-covered transactions.""),
  short_description STRING OPTIONS(description=""Short text description of the diagnosis""),
  long_description STRING OPTIONS(description=""Full text description of the diagnosis"")
);"

,4
table_name,icd9_procedures
ddl,"CREATE TABLE `bigquery-public-data.cms_codes.icd9_procedures`
(
  PROCEDURE_CODE STRING,
  LONG_DESCRIPTION STRING,
  SHORT_DESCRIPTION STRING
);"

Database Name: bigquery-public-data
Schema Name: cms_medicare
DDL describes table information.
,0
table_name,physicians_and_other_supplier_2013
ddl,"CREATE TABLE `bigquery-public-data.cms_medicare.physicians_and_other_supplier_2013`
(
  npi STRING NOT NULL OPTIONS(description=""National Provider Identifier""),
  nppes_provider_last_org_name STRING OPTIONS(description=""Last Name/Organization Name of the Provider""),
  nppes_provider_first_name STRING OPTIONS(description=""First Name of the Provider""),
  nppes_provider_mi STRING OPTIONS(description=""Middle Initial of the Provider""),
  nppes_credentials STRING OPTIONS(description=""Credentials of the Provider""),
  nppes_provider_gender STRING OPTIONS(description=""Gender of the Provider""),
  nppes_entity_code STRING OPTIONS(description=""Entity Type of the Provider""),
  nppes_provider_street1 STRING OPTIONS(description=""Street Address 1 of the Provider""),
  nppes_provider_street2 STRING OPTIONS(description=""Street Address 2 of the Provider""),
  nppes_provider_city STRING OPTIONS(description=""City of the Provider""),
  nppes_provider_zip STRING OPTIONS(description=""Zip Code of the Provider""),
  nppes_provider_state STRING OPTIONS(description=""State Code of the Provider""),
  nppes_provider_country STRING OPTIONS(description=""Country Code of the Provider""),
  provider_type STRING OPTIONS(description=""Provider Type of the Provider""),
  medicare_participation_indicator STRING OPTIONS(description=""Medicare Participation Indicator""),
  place_of_service STRING NOT NULL OPTIONS(description=""Place of Service""),
  hcpcs_code STRING NOT NULL OPTIONS(description=""HCPCS""),
  hcpcs_description STRING OPTIONS(description=""HCPCS Description""),
  hcpcs_drug_indicator STRING OPTIONS(description=""Identifies HCPCS As Drug Included in the ASP Drug List""),
  line_srvc_cnt FLOAT64 OPTIONS(description=""Number of Services""),
  bene_unique_cnt INT64 OPTIONS(description=""Number of Medicare Beneficiaries""),
  bene_day_srvc_cnt INT64 OPTIONS(description=""Number of Distinct Medicare Beneficiary/Per Day Services""),
  average_medicare_allowed_amt FLOAT64 OPTIONS(description=""Average Medicare Allowed Amount""),
  stdev_medicare_allowed_amt FLOAT64 OPTIONS(description=""""),
  average_submitted_chrg_amt FLOAT64 OPTIONS(description=""Average Submitted Charge Amount""),
  stdev_submitted_chrg_amt FLOAT64 OPTIONS(description=""""),
  average_medicare_payment_amt FLOAT64 OPTIONS(description=""Average Medicare Payment Amount""),
  stdev_medicare_payment_amt FLOAT64 OPTIONS(description="""")
);"

Some other tables have the similar structure: ['physicians_and_other_supplier_2013', 'physicians_and_other_supplier_2012', 'physicians_and_other_supplier_2014', 'physicians_and_other_supplier_2015']
,1
table_name,home_health_agencies_2014
ddl,"CREATE TABLE `bigquery-public-data.cms_medicare.home_health_agencies_2014`
(
  provider_id STRING OPTIONS(description=""The 6-digit identification number for the home health agency on the claim.""),
  agency_name STRING OPTIONS(description=""The home health agency name, as reported in the POS file.""),
  street_address STRING OPTIONS(description=""The home health agency address, as reported in the POS file.""),
  city STRING OPTIONS(description=""The city where the home health agency is located, as reported in the POS file.""),
  state STRING OPTIONS(description=""The state where the home health agency is located, as reported in POS file. The fifty U.S. states and the District of Columbia are reported by the state postal abbreviation.""),
  zip_code INT64 OPTIONS(description=""The home health agency’s zip code, as reported in the POS file.""),
  total_episodes_non_lupa INT64 OPTIONS(description=""Total count of non-LUPA episodes provided by a specific home health agency or in a unique HHRG category in the calendar year.""),
  distinct_beneficiaries_non_lupa INT64 OPTIONS(description=""Number of distinct Medicare beneficiaries receiving at least one non-LUPA home health episode in the calendar year. Beneficiaries may receive multiple home health episodes per year but are only counted once in this field.""),
  average_number_of_total_visits_per_episode_non_lupa FLOAT64 OPTIONS(description=""Average number of total visits provided by the HHA during a non-LUPA episode.""),
  average_number_of_skilled_nursing_visits_per_episode_non_lupa FLOAT64 OPTIONS(description=""Average number of skilled nursing visits provided by the HHA during a non-LUPA episode.""),
  average_number_of_pt_visits_per_episode_non_lupa FLOAT64 OPTIONS(description=""Average number of physical therapy visits provided by the HHA during a non-LUPA episode.""),
  average_number_of_ot_visits_per_episode_non_lupa FLOAT64 OPTIONS(description=""Average number of occupational therapy visits provided by the HHA during a non-LUPA episode.""),
  average_number_of_st_visits_per_episode_non_lupa FLOAT64 OPTIONS(description=""Average number of speech therapy visits provided by the HHA during a non-LUPA episode.""),
  average_number_of_home_health_aide_visits_per_episode_non_lupa FLOAT64 OPTIONS(description=""Average number of home health aide visits provided by the HHA during a non-LUPA episode.""),
  average_number_of_medical_social_visits_per_episode_non_lupa FLOAT64 OPTIONS(description=""Average number of medical-social visits provided by the HHA during a non-LUPA episode.""),
  total_hha_charge_amount_non_lupa INT64 OPTIONS(description=""Total charges that the home health agency submitted for non-LUPA episodes.""),
  total_hha_medicare_payment_amount_non_lupa INT64 OPTIONS(description=""Total amount that Medicare paid for non-LUPA episodes. Home health services do not have any cost-sharing requirements and the Medicare payment amount will equal the allowed amount.""),
  total_hha_medicare_standard_payment_amount_non_lupa INT64 OPTIONS(description=""Total amount that Medicare paid for non-LUPA episodes adjusted for geographic differences in payment rates.""),
  outlier_payments_as_a_percent_of_medicare_payment_amount_non_lupa FLOAT64 OPTIONS(description=""The percent of total Medicare payments for non-LUPA episodes paid to an HHA for outlier episodes.""),
  total_lupa_episodes INT64 OPTIONS(description=""Total count of low utilization payment amount episodes provided by a specific HHA in the calendar year.""),
  total_hha_medicare_payment_amount_for_lupas INT64 OPTIONS(description=""Total amount that Medicare paid for LUPA episodes provided by a specific HHA in the calendar year.""),
  average_age INT64 OPTIONS(description=""Average age of beneficiaries. Beneficiary age is calculated at the end of the calendar year or at the time of death.""),
  male_beneficiaries INT64 OPTIONS(description=""Number of male beneficiaries.""),
  female_beneficiaries INT64 OPTIONS(description=""Number of female beneficiaries.""),
  nondual_beneficiaries INT64 OPTIONS(description=""Number of Medicare beneficiaries qualified to receive Medicare only benefits. Beneficiaries are classified as Medicare only entitlement if they received zero months of any Medicaid benefits (full or partial) in the given calendar year.""),
  dua_beneficiaries INT64 OPTIONS(description=""Number of Medicare beneficiaries qualified to receive Medicare and Medicaid benefits. Beneficiaries are classified as Medicare and Medicaid entitlement if in any month in the given calendar year they were receiving full or partial Medicaid benefits.""),
  white_beneficiaries INT64 OPTIONS(description=""Number of non-Hispanic white beneficiaries.""),
  black_beneficiaries INT64 OPTIONS(description=""Number of non-Hispanic black or African American beneficiaries.""),
  asian_pacific_islander_beneficiaries INT64 OPTIONS(description=""Number of Asian Pacific Islander beneficiaries.""),
  hispanic_beneficiaries INT64 OPTIONS(description=""Number of Hispanic beneficiaries.""),
  american_indian_or_alaska_native_beneficiaries INT64 OPTIONS(description=""Number of American Indian or Alaska Native beneficiaries.""),
  other_unknown_beneficiaries INT64 OPTIONS(description=""Number of beneficiaries with race not elsewhere classified.""),
  average_hcc_score FLOAT64 OPTIONS(description=""Average Hierarchical Condition Category (HCC) risk score of beneficiaries. Please refer to the “Additional Information” section of the Methodology document for more details on HCC risk scores.""),
  percent_of_beneficiaries_with_atrial_fibrillation INT64 OPTIONS(description=""Percent of beneficiaries meeting the CCW chronic condition algorithm for atrial fibrillation.""),
  percent_of_beneficiaries_with_alzheimers INT64 OPTIONS(description=""Percent of beneficiaries meeting the CCW chronic condition algorithm for Alzheimer’s, related disorders, or dementia.""),
  percent_of_beneficiaries_with_asthma INT64 OPTIONS(description=""Percent of beneficiaries meeting the CCW chronic condition algorithm for Asthma.""),
  percent_of_beneficiaries_with_cancer INT64 OPTIONS(description=""Percent of beneficiaries meeting the CCW chronic condition algorithms for cancer. Includes breast cancer, colorectal cancer, lung cancer and prostate cancer.""),
  percent_of_beneficiaries_with_chf INT64 OPTIONS(description=""Percent of beneficiaries meeting the CCW chronic condition algorithm for heart failure.""),
  percent_of_beneficiaries_with_chronic_kidney_disease INT64 OPTIONS(description=""Percent of beneficiaries meeting the CCW chronic condition algorithm for chronic kidney disease.""),
  percent_of_beneficiaries_with_copd INT64 OPTIONS(description=""Percent of beneficiaries meeting the CCW chronic condition algorithm for chronic obstructive pulmonary disease.""),
  percent_of_beneficiaries_with_depression INT64 OPTIONS(description=""Percent of beneficiaries meeting the CCW chronic condition algorithm for depression.""),
  percent_of_beneficiaries_with_diabetes INT64 OPTIONS(description=""Percent of beneficiaries meeting the CCW chronic condition algorithm for diabetes.""),
  percent_of_beneficiaries_with_hyperlipidemia INT64 OPTIONS(description=""Percent of beneficiaries meeting the CCW chronic condition algorithm for hyperlipidemia.""),
  percent_of_beneficiaries_with_hypertension INT64 OPTIONS(description=""Percent of beneficiaries meeting the CCW chronic condition algorithm for hypertension.""),
  percent_of_beneficiaries_with_ihd INT64 OPTIONS(description=""Percent of beneficiaries meeting the CCW chronic condition algorithm for ischemic heart disease.""),
  percent_of_beneficiaries_with_osteoporosis INT64 OPTIONS(description=""Percent of beneficiaries meeting the CCW chronic condition algorithm for osteoporosis.""),
  percent_of_beneficiaries_with_ra_oa INT64 OPTIONS(description=""Percent of beneficiaries meeting the CCW chronic condition algorithm for rheumatoid arthritis/osteoarthritis.""),
  percent_of_beneficiaries_with_schizophrenia INT64 OPTIONS(description=""Percent of beneficiaries meeting the CCW chronic condition algorithm for schizophrenia and other psychotic disorders.""),
  percent_of_beneficiaries_with_stroke INT64 OPTIONS(description=""Percent of beneficiaries meeting the CCW chronic condition algorithm for stroke."")
);"

Some other tables have the similar structure: ['home_health_agencies_2014', 'home_health_agencies_2013']
,2
table_name,inpatient_charges_2013
ddl,"CREATE TABLE `bigquery-public-data.cms_medicare.inpatient_charges_2013`
(
  provider_id STRING NOT NULL OPTIONS(description=""The CMS Certification Number (CCN) of the provider billing for outpatient hospital services""),
  provider_name STRING OPTIONS(description=""The name of the provider""),
  provider_street_address STRING OPTIONS(description=""The street address in which the provider is physically located""),
  provider_city STRING OPTIONS(description=""The city in which the provider is physically located""),
  provider_state STRING OPTIONS(description=""The state in which the provider is physically located""),
  provider_zipcode STRING OPTIONS(description=""The zip code in which the provider is physically located""),
  drg_definition STRING NOT NULL OPTIONS(description=""The code and description identifying the MS-DRG. MS-DRGs are a classification system that groups similar clinical conditions (diagnoses) and the procedures furnished by the hospital during the stay""),
  hospital_referral_region_description STRING OPTIONS(description=""The Hospital Referral Region (HRR) in which the provider is physically located""),
  total_discharges INT64 OPTIONS(description=""The number of discharges billed by the provider for inpatient hospital services""),
  average_covered_charges FLOAT64 OPTIONS(description=""The provider's average charge for services covered by Medicare for all discharges in the MS-DRG. These will vary from hospital to hospital because of differences in hospital charge structures""),
  average_total_payments FLOAT64 OPTIONS(description=""The average total payments to all providers for the MS-DRG including the MSDRG amount, teaching, disproportionate share, capital, and outlier payments for all cases. Also included 5 in average total payments are co-payment and deductible amounts that the patient is responsible for and any additional payments by third parties for coordination of benefits""),
  average_medicare_payments FLOAT64 OPTIONS(description=""The average amount that Medicare pays to the provider for Medicare's share of the MS-DRG. Average Medicare payment amounts include the MS-DRG amount, teaching, disproportionate share, capital, and outlier payments for all cases. Medicare payments DO NOT include beneficiary co-payments and deductible amounts nor any additional payments from third parties for coordination of benefits"")
);"

Some other tables have the similar structure: ['inpatient_charges_2013', 'inpatient_charges_2014', 'inpatient_charges_2011', 'inpatient_charges_2012', 'inpatient_charges_2015']
,3
table_name,nursing_facilities_2013
ddl,"CREATE TABLE `bigquery-public-data.cms_medicare.nursing_facilities_2013`
(
  provider_id STRING OPTIONS(description=""The 6-digit identification number for the skilled nursing facility on the claim.""),
  facility_name STRING OPTIONS(description=""The skilled nursing facility name, as reported in the POS file.""),
  street_address STRING OPTIONS(description=""The skilled nursing facility address, as reported in the POS file.""),
  city STRING OPTIONS(description=""The city where the skilled nursing facility is located, as reported in the POS file.""),
  state STRING OPTIONS(description=""The state where the skilled nursing facility is located, as reported in POS file. The fifty U.S. states and the District of Columbia are reported by the state postal abbreviation.""),
  zip_code INT64 OPTIONS(description=""The skilled nursing facility’s zip code, as reported in the POS file.""),
  total_stays INT64 OPTIONS(description=""Total number of skilled nursing facility stays.""),
  distinct_beneficiaries_per_provider INT64 OPTIONS(description=""Number of distinct Medicare beneficiaries with at least one skilled nursing facility day per provider. A beneficiary will only be counted once per provider, but may be double-counted across providers.""),
  average_length_of_stay_days INT64 OPTIONS(description=""Average lenth of stay, in days, for all Medicare beneficiaries with at least one stay in the skilled nursing facility in the year.""),
  total_snf_charge_amount INT64 OPTIONS(description=""Total of the charges that the skilled nursing facility submitted for all Medicare stays in the year.""),
  total_snf_medicare_allowed_amount INT64 OPTIONS(description=""Total Medicare allowed amount for all Medicare stays in the year. This figure is the sum of the amount Medicare pays, the deductible and coinsurance amounts that the beneficiary is responsible for paying, and any amounts that a third party is responsible for paying.""),
  total_snf_medicare_payment_amount INT64 OPTIONS(description=""Total amount that Medicare paid for all Medicare stays in the year after deductible and coinsurance amounts have been deducted.""),
  total_snf_medicare_standard_payment_amount INT64 OPTIONS(description=""Total amount that Medicare paid for all Medicare stays in the year after deductible and coinsurance amounts have been deducted, adjusted for geographic differences in payment rates."")
);"

Some other tables have the similar structure: ['nursing_facilities_2013', 'nursing_facilities_2014']
,4
table_name,outpatient_charges_2012
ddl,"CREATE TABLE `bigquery-public-data.cms_medicare.outpatient_charges_2012`
(
  provider_id STRING NOT NULL OPTIONS(description=""The CMS Certification Number (CCN) of the provider billing for outpatient hospital services""),
  provider_name STRING OPTIONS(description=""The name of the provider""),
  provider_street_address STRING OPTIONS(description=""The street address in which the provider is physically located""),
  provider_city STRING OPTIONS(description=""The city in which the provider is physically located""),
  provider_state STRING OPTIONS(description=""The state in which the provider is physically located""),
  provider_zipcode STRING OPTIONS(description=""The zip code in which the provider is physically located""),
  apc STRING NOT NULL OPTIONS(description=""The code and description identifying the MS-DRG. MS-DRGs are a classification system that groups similar clinical conditions (diagnoses) and the procedures furnished by the hospital during the stay""),
  hospital_referral_region STRING OPTIONS(description=""Code and description identifying the APC. APCs are a classification system where individual services (Healthcare Common Procedure Coding System [HCPCS] codes) are assigned based on similar clinical characteristics and similar costs""),
  outpatient_services INT64 OPTIONS(description=""The number of discharges billed by the provider for inpatient hospital services""),
  average_estimated_submitted_charges FLOAT64 OPTIONS(description=""The number of services billed by the provider for outpatient hospital services""),
  average_total_payments FLOAT64 OPTIONS(description=""The provider's average estimated submitted charge for services covered by Medicare for the APC. These will vary from hospital to hospital because of differences in hospital charge structures"")
);"

Some other tables have the similar structure: ['outpatient_charges_2012', 'outpatient_charges_2011', 'outpatient_charges_2014', 'outpatient_charges_2013', 'outpatient_charges_2015']
,5
table_name,part_d_prescriber_2014
ddl,"CREATE TABLE `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
(
  npi STRING NOT NULL OPTIONS(description=""National Provider Identifier""),
  nppes_provider_last_org_name STRING OPTIONS(description=""Last Name/Organization Name of the Provider""),
  nppes_provider_first_name STRING OPTIONS(description=""First Name of the Provider""),
  nppes_provider_city STRING OPTIONS(description=""City of the Provider""),
  nppes_provider_state STRING OPTIONS(description=""State Code of the Provider""),
  specialty_description STRING OPTIONS(description=""Provider Specialty Type""),
  description_flag STRING OPTIONS(description=""Source of Provider Specialty""),
  drug_name STRING NOT NULL OPTIONS(description=""Name of the drug""),
  generic_name STRING OPTIONS(description=""Generic name of the drug""),
  bene_count INT64 OPTIONS(description=""Number of Medicare Beneficiaries""),
  total_claim_count INT64 OPTIONS(description=""Number of Medicare Part D Claims, Including Refills""),
  total_day_supply INT64 OPTIONS(description=""Number of Day's Supply for All Claims""),
  total_drug_cost FLOAT64 OPTIONS(description=""Aggregate Cost Paid for All Claims""),
  bene_count_ge65 INT64 OPTIONS(description=""Number of Medicare Beneficiaries Age 65+""),
  bene_count_ge65_suppress_flag STRING OPTIONS(description=""Reason for Suppression of Bene_Count_ge65""),
  total_claim_count_ge65 INT64 OPTIONS(description=""Number of Claims, Including Refills, for Beneficiaries Age 65+""),
  ge65_suppress_flag STRING OPTIONS(description=""Reason for Suppression of Total_Claim_Count_Ge65, Total_Drug_Cost_Ge65, and Total_Day_Supply_Ge65""),
  total_day_supply_ge65 INT64 OPTIONS(description=""Number of Day's Supply for All Claims for Beneficiaries Age 65+""),
  total_drug_cost_ge65 FLOAT64 OPTIONS(description=""Aggregate Cost Paid for All Claims for Beneficiaries Age 65+""),
  total_30_day_fill_count FLOAT64 OPTIONS(description=""The aggregate number of Medicare Part D standardized 30-day fills. The standardized 30-day fill is derived from the number of days supplied on each Part D claim divided by 30. Standardized 30-day fill values less than 1.0 were bottom-coded with a value of 1.0 and standardized 30- day fill values greater than 12.0 were top-coded with a value of 12.0.""),
  total_30_day_fill_count_ge65 FLOAT64 OPTIONS(description=""The number of Medicare Part D standardized 30-day fills for beneficiaries age 65 and older. The standardized 30-day fill is derived from the number of days supplied on each Part D claim divided by 30. Standardized 30-day fill values less than 1.0 were bottom-coded with a value of 1.0 and standardized 30-day fill values greater than 12.0 were top-coded with a value of 12.0."")
);"

,6
table_name,hospice_providers_2014
ddl,"CREATE TABLE `bigquery-public-data.cms_medicare.hospice_providers_2014`
(
  provider_id STRING OPTIONS(description=""The 6-digit identification number for the hospice provider on the claim.""),
  name STRING OPTIONS(description=""The hospice provider name, as reported in the POS file.""),
  street_address STRING OPTIONS(description=""The hospice provider address, as reported in the POS file.""),
  city STRING OPTIONS(description=""The city where the hospice provider is located, as reported in the POS file.""),
  state STRING OPTIONS(description=""The state where the hospice is located, as reported in the POS file. The fifty U.S. states, the District of Columbia and Puerto Rico are reported by the state postal abbreviation.""),
  zip_code INT64 OPTIONS(description=""The hospice provider zip code, as reported in the POS file.""),
  hrr STRING OPTIONS(description=""The Hospital Referral Region the hospice provider is located, based on provider ZIP code.""),
  hospice_beneficiaries INT64 OPTIONS(description=""Number of distinct Medicare beneficiaries receiving at least one day of hospice care in the calendar year.""),
  total_days INT64 OPTIONS(description=""Total count of hospice care days provided in the calendar year. Includes first and last day of care.""),
  total_medicare_payment_amount INT64 OPTIONS(description=""Total amount that Medicare paid for hospice care. Hospice services do not have any cost-sharing requirements and the Medicare payment amount will equal the allowed amount.""),
  total_medicare_standard_payment_amount INT64 OPTIONS(description=""Total amount that Medicare paid for hospice care adjusted for geographic differences in payment rates.""),
  total_charge_amount INT64 OPTIONS(description=""Total charges that hospice providers submitted for hospice care.""),
  percent_routine_home_care_days INT64 OPTIONS(description=""Percent of total number of hospice days that were routine home care (RHC) days. RHC days identified using Revenue Code 0651.""),
  physician_services INT64 OPTIONS(description=""Total number of hospice care physician services provided. Physician services identified using Revenue Code 0657.""),
  home_health_visit_hours_per_day FLOAT64 OPTIONS(description=""Average number of hours per day of home health hospice care provided. Home health visits identified using Revenue Codes 0570, 0571, 0572 and 0579.""),
  skilled_nursing_visit_hours_per_day FLOAT64 OPTIONS(description=""Average number of hours per day of skilled nursing hospice care provided. Skilled nursing visits identified using Revenue Codes 0550, 0551, 0552 and 0559.""),
  social_service_visit_hours_per_day FLOAT64 OPTIONS(description=""Average number of hours per day of social services hospice care provided. Social service visits identified using Revenue Codes 0560, 0561, 0562 and 0569.""),
  total_live_discharges INT64 OPTIONS(description=""Number of distinct Medicare beneficiaries with live discharges from hospice care. A hospice beneficiary was considered to have a live discharge if hospice beneficary did not die in hospice care and was not receiving hospice care in CY2015. Includes live discharges for any reason including revocation.""),
  hospice_beneficiaries_with_seven_or_fewer_hospice_care_days INT64 OPTIONS(description=""Number of distinct Medicare beneficiaries with 7 or fewer hospice care days in CY2014. Excludes hospice beneficaries whose hospice care continued from a previous calendar year or into the next calendar year.""),
  hospice_beneficiaries_with_more_than_sixty_hospice_care_days INT64 OPTIONS(description=""Number of distinct Medicare beneficiaries with more than 60 hospice care days in CY2014.""),
  hospice_beneficiaries_with_more_than_one_hundred_eighty_hospice_care_days INT64 OPTIONS(description=""Number of distinct Medicare beneficiaries with more than 180 hospice care days in CY2014.""),
  home_health_visit_hours_per_day_during_week_prior_to_death FLOAT64 OPTIONS(description=""Average number of hours per day of home health hospice care provided during the seven days prior to death. Home health visits identified using Revenue Codes 0570, 0571, 0572 and 0579.""),
  skilled_nursing_visit_hours_per_day_during_week_prior_to_death FLOAT64 OPTIONS(description=""Average number of hours per day of skilled nursing hospice care provided during the seven days prior to death. Skilled nursing visits identified using Revenue Codes 0550, 0551, 0552 and 0559.""),
  social_service_visit_hours_per_day_during_week_prior_to_death FLOAT64 OPTIONS(description=""Average number of hours per day of social services hospice care provided during the seven days prior to death. Social service visits identified using Revenue Codes 0560, 0561, 0562 and 0569.""),
  average_age FLOAT64 OPTIONS(description=""Average age of Medicare beneficiaries using hospice care in CY2014.""),
  male_hospice_beneficiaries INT64 OPTIONS(description=""Number of distinct male Medicare beneficiaries receiving at least one day of hospice care in the calendar year.""),
  female_hospice_beneficiaries INT64 OPTIONS(description=""Number of distinct female Medicare beneficiaries receiving at least one day of hospice care in the calendar year.""),
  white_hospice_beneficiaries INT64 OPTIONS(description=""Number of distinct white Medicare beneficiaries receiving at least one day of hospice care in the calendar year.""),
  black_hospice_beneficiaries INT64 OPTIONS(description=""Number of distinct black Medicare beneficiaries receiving at least one day of hospice care in the calendar year.""),
  asian_hospice_beneficiaries INT64 OPTIONS(description=""Number of distinct Asian Medicare beneficiaries receiving at least one day of hospice care in the calendar year.""),
  hispanic_hospice_beneficiaries INT64 OPTIONS(description=""Number of distinct Hispanic Medicare beneficiaries receiving at least one day of hospice care in the calendar year.""),
  other_unknown_race_hospice_beneficiaries INT64 OPTIONS(description=""Number of distinct Medicare beneficiaries of other/unknown race receiving at least one day of hospice care in the calendar year.""),
  medicare_advantage_hospice_beneficiaries INT64 OPTIONS(description=""Number of distinct Medicare beneficiaries enrolled in Medicare Advantage for at least one month and receiving at least one day of hospice care in the calendar year.""),
  medicaid_eligible_hospice_beneficiaries INT64 OPTIONS(description=""Number of distinct Medicare beneficiaries eligible for Medicaid for at least one month and receiving at least one day of hospice care in the calendar year.""),
  hospice_beneficiaries_with_a_primary_diagnosis_of_cancer INT64 OPTIONS(description=""Number of distinct Medicare beneficiaries receiving hospice care for a primary diagnosis of cancer. Clinical Classifications Software single level diagnosis categories 11-17 were used to define cancer diagnoses. If a hospice beneficiary had more than one primary diagnosis the most frequent diagnosis in terms of hospice care days was used.""),
  hospice_beneficiaries_with_a_primary_diagnosis_of_dementia INT64 OPTIONS(description=""Number of distinct Medicare beneficiaries receiving hospice care for a primary diagnosis of dementia. Clinical Classifications Software single level diagnosis category 653 were used to define dementia diagnoses. If a hospice beneficiary had more than one primary diagnosis the most frequent diagnosis in terms of hospice care days was used.""),
  hospice_beneficiaries_with_a_primary_diagnosis_of_stroke INT64 OPTIONS(description=""Number of distinct Medicare beneficiaries receiving hospice care for a primary diagnosis of circulatory/heart disease. Clinical Classifications Software single level diagnosis categories 96-108 and 114-121 were used to define circulatory/heart diagnoses. If a hospice beneficiary had more than one primary diagnosis the most frequent diagnosis in terms of hospice care days was used.""),
  hospice_beneficiaries_with_a_primary_diagnosis_of_circulatory_heart_disease INT64 OPTIONS(description=""Number of distinct Medicare beneficiaries receiving hospice care for a primary diagnosis of stroke. Clinical Classifications Software single level diagnosis categories 109-113 were used to define stroke diagnoses. If a hospice beneficiaryhad more than one primary diagnosis the most frequent diagnosis in terms of hospice care days was used.""),
  hospice_beneficiaries_with_a_primary_diagnosis_of_respiratory_disease INT64 OPTIONS(description=""Number of distinct Medicare beneficiaries receiving hospice care for a primary diagnosis of respiratory disease. Clinical Classifications Software single level diagnosis categories 127-134 were used to define respiratory diagnoses. If a hospice beneficiary had more than one primary diagnosis the most frequent diagnosis in terms of hospice care days was used.""),
  hospice_beneficiaries_with_other_primary_diagnoses INT64 OPTIONS(description=""Number of distinct Medicare beneficiaries receiving hospice care for a primary diagnosis other than cancer, dementia, circulatory/heart, stroke, or respiratory. If a hospice beneficiary had more than one primary diagnosis the most frequent diagnosis in terms of hospice care days was used.""),
  site_of_service_home_hospice_beneficiaries INT64 OPTIONS(description=""Number of distinct Medicare beneficiaries receiving the majority of their hospice care days at home. Site of service was determined using HCPCS codes Q5001-Q5010, Q5001 indicates care provided in hospice beneficiary's private residence (home).""),
  site_of_service_assisted_living_facility_hospice_beneficiaries INT64 OPTIONS(description=""Number of distinct Medicare beneficiaries receiving the majority of their hospice care days in an assisted living facility. Site of service was determined using HCPCS codes Q5001-Q5010, Q5002 indicates care provided in an assisted living facility.""),
  site_of_service_long_term_care_or_non_skilled_nursing_facility_hospice_beneficiaries INT64 OPTIONS(description=""Number of distinct Medicare beneficiaries receiving the majority of their hospice care days in a long term care or non-skilled nursing facility. Site of service was determined using HCPCS codes Q5001-Q5010, Q5003 indicates care provided in a long term care or non-skilled nursing facility.""),
  site_of_service_skilled_nursing_facility_hospice_beneficiaries INT64 OPTIONS(description=""Number of distinct Medicare beneficiaries receiving the majority of their hospice care days in a skilled nursing facility. Site of service was determined using HCPCS codes Q5001-Q5010, Q5004 indicates care provided in a skilled nursing facility.""),
  site_of_service_inpatient_hospital_hospice_beneficiaries INT64 OPTIONS(description=""Number of distinct Medicare beneficiaries receiving the majority of their hospice care days in an inpatient hospital. Site of service was determined using HCPCS codes Q5001-Q5010, Q5005 indicates care provided in an inpatient hospital.""),
  site_of_service_inpatient_hospice_hospice_beneficiaries INT64 OPTIONS(description=""Number of distinct Medicare beneficiaries receiving the majority of their hospice care days in an inpatient hospice facility. Site of service was determined using HCPCS codes Q5001-Q5010, Q5006 indicates care provided in an inpatient hospice facility.""),
  site_of_service_other_facility_hospice_beneficiaries INT64 OPTIONS(description=""Number of distinct Medicare beneficiaries receiving the majority of their hospice care days in a long term care hospital, psychiatric facility, home care in a hospice facility or unknown facility. Site of service was determined using HCPCS codes Q5001-Q5010, Q5007-Q5010 indicate care provided in other facilities."")
);"

,7
table_name,referring_durable_medical_equip_2013
ddl,"CREATE TABLE `bigquery-public-data.cms_medicare.referring_durable_medical_equip_2013`
(
  referring_npi STRING OPTIONS(description=""NPI for the referring provider on the DMEPOS claim.""),
  referring_provider_last_name_organization_name STRING OPTIONS(description=""When the referring provider is registered in NPPES as an individual (entity type code=’I’), this is the referring provider’s last name. When the referring provider is registered as an organization (entity type code = ‘O’), this is the organization name.""),
  referring_provider_first_name STRING OPTIONS(description=""When the referring provider is registered in NPPES as an individual (entity type code=’I’), this is the referring provider’s first name. When the referring provider is registered as an organization (entity type code = ‘O’), this will be blank.""),
  referring_provider_middle_initial STRING OPTIONS(description=""When the referring provider is registered in NPPES as an individual (entity type code=’I’), this is the referring provider’s middle initial. When the referring provider is registered as an organization (entity type code = ‘O’), this will be blank.""),
  referring_provider_credentials STRING OPTIONS(description=""When the referring provider is registered in NPPES as an individual (entity type code=’I’), these are the referring provider’s credentials. When the referring provider is registered as an organization (entity type code = ‘O’), this will be blank.""),
  referring_provider_gender STRING OPTIONS(description=""When the referring provider is registered in NPPES as an individual (entity type code=’I’), this is the referring provider’s gender. When the referring provider is registered as an organization (entity type code = ‘O’), this will be blank.""),
  referring_provider_entity_code STRING OPTIONS(description=""Type of entity reported in NPPES. An entity code of ‘I’ identifies referring providers registered as individuals and an entity type code of ‘O’ identifies referring providers registered as organizations.""),
  referring_provider_street_1 STRING OPTIONS(description=""The first line of the referring provider’s street address, as reported in NPPES.""),
  referring_provider_street_2 STRING OPTIONS(description=""The second line of the referring provider’s street address, as reported in NPPES.""),
  referring_provider_city STRING OPTIONS(description=""The city where the referring provider is located, as reported in NPPES.""),
  referring_provider_state STRING OPTIONS(description=""The state where the referring provider is located, as reported in NPPES. The fifty U.S. states and the District of Columbia are reported by the state postal abbreviation. The following values are used for other areas: 'XX' = 'Unknown' 'AA' = 'Armed Forces Central/South America' 'AE' = 'Armed Forces Europe' 'AP' = 'Armed Forces Pacific' 'AS' = 'American Samoa' 'GU' = 'Guam' 'MP' = 'North Mariana Islands' 'PR' = 'Puerto Rico' 'VI' = 'Virgin Islands' 'ZZ' = 'Foreign Country'""),
  referring_provider_zip STRING OPTIONS(description=""The referring provider’s zip code, as reported in NPPES.""),
  referring_provider_country STRING OPTIONS(description=""The country where the referring provider is located, as reported in NPPES. The country code will be ‘US’ for any state or U.S. possession. For foreign countries (i.e., state values of ‘ZZ’), the provider country values include the following: ‘AE’ = ‘United Arab Emirates’; ‘IL’= Israel’; ‘AR’= ‘Argentina’; ‘IN’= India’; ‘AU’= ‘Australia’; ‘IS’= Iceland; ‘BR’= ‘Brazil’; ‘IT’= Italy’; ‘CA’= ‘Canada’; ‘JP’= Japan’; ‘CH’= Switzerland’; ‘KR’= ‘Korea’; ‘CN’= China’; ‘NL’= ‘Netherlands’; ‘CO’= Colombia’; ‘PK’= ‘Pakistan’; ‘DE’= ‘Germany’; ‘SA’= ‘Saudi Arabia’; ‘ES’= ‘Spain’; ‘SY’= ‘Syria’; ‘FR’= France’; ‘TR’= ‘Turkey’; ‘GB’= Great Britain’; ‘VE’= ‘Venezuela’; ‘HU’= Hungary’""),
  referring_provider_type STRING OPTIONS(description=""Derived from the Medicare provider/supplier specialty code reported on all of the NPI's Part B non-institutional claims (DMEPOS & non-DMEPOS). For referring providers that have more than one Medicare specialty code reported on their claims, the Medicare specialty code associated with the largest number of services was used. Where a prescriber's NPI did not have associated Part B claims, the taxonomy code associated with the NPI in NPPES was mapped to a Medicare specialty code using an external crosswalk published here: http://www.cms.gov/Medicare/Provider-Enrollment-and-Certification/MedicareProviderSupEnroll/Taxonomy.html. For any taxonomy codes that could not be mapped to a Medicare specialty code, the taxonomy classification description was used.""),
  referring_provider_type_flag STRING OPTIONS(description=""A flag variable that indicates the source of the Referring Provider Type: \""S\"" = Medicare Specialty Code description \""T\"" = Taxonomy Code Classification description""),
  number_of_suppliers INT64 OPTIONS(description=""Number of suppliers rendering products/services billed through DMEPOS MACs.""),
  number_of_supplier_hcpcs INT64 OPTIONS(description=""Total number of unique DMEPOS product/service hcpcs codes billed by suppliers and ordered by the referring provider.""),
  number_of_supplier_beneficiaries INT64 OPTIONS(description=""Total number of unique beneficiaries associated with DMEPOS claims submitted by suppliers and ordered by the referring provider. Beneficiary counts fewer than 11 have been suppressed to protect the privacy of Medicare beneficiaries.""),
  number_of_supplier_claims INT64 OPTIONS(description=""Total number of DMEPOS claims submitted by suppliers, reflecting products/services ordered by the referring provider.""),
  number_of_supplier_services INT64 OPTIONS(description=""Total DMEPOS products/services rendered by suppliers and ordered by the referring provider.""),
  supplier_submitted_charges FLOAT64 OPTIONS(description=""The total charges that suppliers submitted for all DMEPOS products/services ordered by the referring provider.""),
  supplier_medicare_allowed_amount FLOAT64 OPTIONS(description=""The Medicare allowed amount for all DMEPOS products/services ordered by the referring provider. This figure is the sum of the amount Medicare pays, the deductible and coinsurance amounts that the beneficiary is responsible for paying, and any amounts that a third party is responsible for paying.""),
  supplier_medicare_payment_amount FLOAT64 OPTIONS(description=""Amount that Medicare paid after deductible and coinsurance amounts have been deducted for all supplier's DMEPOS line item products/services ordered by the referring provider.""),
  durable_medical_equipment_suppression_indicator STRING OPTIONS(description=""A 1-byte value which defines the suppression, if needed, of the utilization, charge and payment information associated with durable medical equipment HCPCS codes. A value of '*' means the suppressed information is based on a dme-specific claim count of 1 through 10. A value of '#' means the dme-specific information has been counter-suppressed. Counter-suppression is needed when the display of dme-specific data could be used to recalculate suppressed values in non-dme-specific columns.""),
  number_of_durable_medical_equipment_suppliers INT64 OPTIONS(description=""Number of suppliers rendering durable medical equipment products/services.""),
  number_of_durable_medical_equipment_hcpcs INT64 OPTIONS(description=""Total number of unique beneficiaries associated with durable medical equipment claims submitted by suppliers and ordered by the referring provider. Beneficiary counts fewer than 11 have been suppressed to protect the privacy of Medicare beneficiaries.""),
  number_of_durable_medical_equipment_beneficiaries INT64 OPTIONS(description=""Total number of unique durable medical equipment hcpcs codes billed by suppliers and ordered by the referring provider.""),
  number_of_durable_medical_equipment_claims INT64 OPTIONS(description=""Total number of durable medical equipment claims submitted by suppliers, reflecting services ordered by the referring provider.""),
  number_of_durable_medical_equipment_services INT64 OPTIONS(description=""Total durable medical equipment products/services rendered by suppliers and ordered by the referring provider.""),
  durable_medical_equipment_submitted_charges FLOAT64 OPTIONS(description=""The total charges that suppliers submitted for all durable medical equipment products/services ordered by the referring provider.""),
  durable_medical_equipment_medicare_allowed_amount FLOAT64 OPTIONS(description=""The Medicare allowed amount for all durable medical equipment products/services ordered by the referring provider. This figure is the sum of the amount Medicare pays, the deductible and coinsurance amounts that the beneficiary is responsible for paying, and any amounts that a third party is responsible for paying.""),
  durable_medical_equipment_medicare_payment_amount FLOAT64 OPTIONS(description=""Amount that Medicare paid after deductible and coinsurance amounts have been deducted for all supplier's durable medical equipment line item products/services ordered by the referring provider.""),
  prosthetic_and_orthotic_suppression_indicator STRING OPTIONS(description=""A 1-byte value which defines the suppression, if needed, of the utilization, charge and payment information associated with prosthetic and orthotic HCPCS codes. A value of '*' means the suppressed information is based on a prosthetic and orthotic-specific claim count of 1 through 10. A value of '#' means the prosthetic and orthotic-specific information has been counter-suppressed. Counter-suppression is needed when the display of prosthetic and orthotic-specific data could be used to recalculate suppressed values in non-prosthetic and orthotic-specific columns.""),
  number_of_prosthetic_and_orthotic_suppliers INT64 OPTIONS(description=""Number of suppliers rendering prosthetic and orthotic products/services.""),
  number_of_prosthetic_and_orthotic_hcpcs INT64 OPTIONS(description=""Total number of unique prosthetic and orthotic hcpcs codes billed by suppliers and ordered by the referring provider.""),
  number_of_prosthetic_and_orthotic_beneficiaries INT64 OPTIONS(description=""Total number of unique beneficiaries associated with prosthetic and orthotic claims submitted by suppliers and ordered by the referring provider. Beneficiary counts fewer than 11 have been suppressed to protect the privacy of Medicare beneficiaries.""),
  number_of_prosthetic_and_orthotic_claims INT64 OPTIONS(description=""Total number of prosthetic and orthotic claims submitted by suppliers, reflecting products/services ordered by the referring provider.""),
  number_of_prosthetic_and_orthotic_services INT64 OPTIONS(description=""Total prosthetic and orthotic products/services rendered by suppliers and ordered by the referring provider.""),
  prosthetic_and_orthotic_submitted_charges FLOAT64 OPTIONS(description=""The total charges that suppliers submitted for all prosthetic and orthotic products/services ordered by the referring provider.""),
  prosthetic_and_orthotic_medicare_allowed_amount FLOAT64 OPTIONS(description=""The Medicare allowed amount for all prosthetic and orthotic products/services ordered by the referring provider. This figure is the sum of the amount Medicare pays, the deductible and coinsurance amounts that the beneficiary is responsible for paying, and any amounts that a third party is responsible for paying.""),
  prosthetic_and_orthotic_medicare_payment_amount FLOAT64 OPTIONS(description=""Amount that Medicare paid after deductible and coinsurance amounts have been deducted for all supplier's prosthetic and orthotic line item products/services ordered by the referring provider.""),
  drug_and_nutritional_suppression_indicator STRING OPTIONS(description=""A 1-byte value which defines the suppression, if needed, of the utilization, charge and payment information associated with drug and nutritional HCPCS codes. A value of '*' means the suppressed information is based on a drug and nutritional-specific claim count of 1 through 10. A value of '#' means the drug and nutritional-specific information has been counter-suppressed. Counter-suppression is needed when the display of drug and nutritional-specific data could be used to recalculate suppressed values in non-drug and nutritional-specific columns.""),
  number_of_drug_and_nutritional_products_suppliers INT64 OPTIONS(description=""Number of suppliers rendering drug and nutritional products/services.""),
  number_of_drug_and_nutritional_products_hcpcs INT64 OPTIONS(description=""Total number of unique drug and nutritional product hcpcs codes billed by suppliers and ordered by the referring provider.""),
  number_of_drug_and_nutritional_products_beneficiaries INT64 OPTIONS(description=""Total number of unique beneficiaries associated with drug and nutritional product claims submitted by suppliers and ordered by the referring provider. Beneficiary counts fewer than 11 have been suppressed to protect the privacy of Medicare beneficiaries.""),
  number_of_drug_and_nutritional_products_claims INT64 OPTIONS(description=""Total number of drug and nutritional product claims submitted by suppliers, reflecting services ordered by the referring provider.""),
  number_of_drug_and_nutritional_products_services INT64 OPTIONS(description=""Total drug and nutritional products/services rendered by suppliers and ordered by the referring provider.""),
  drug_and_nutritional_products_submitted_charges FLOAT64 OPTIONS(description=""The total charges that suppliers submitted for drug and nutritional products/services ordered by the referring provider.""),
  drug_and_nutritional_products_medicare_allowed_amount FLOAT64 OPTIONS(description=""The Medicare allowed amount for drug and nutritional products/services ordered by the referring provider. This figure is the sum of the amount Medicare pays, the deductible and coinsurance amounts that the beneficiary is responsible for paying, and any amounts that a third party is responsible for paying.""),
  drug_and_nutritional_products_medicare_payment_amount FLOAT64 OPTIONS(description=""Amount that Medicare paid suppliers after deductible and coinsurance amounts have been deducted for drug and nutritional line item products/services ordered by the referring provider."")
);"

Some other tables have the similar structure: ['referring_durable_medical_equip_2013', 'referring_durable_medical_equip_2014']
,8
table_name,hospital_general_info
ddl,"CREATE TABLE `bigquery-public-data.cms_medicare.hospital_general_info`
(
  provider_id STRING OPTIONS(description=""""),
  hospital_name STRING OPTIONS(description=""""),
  address STRING OPTIONS(description=""""),
  city STRING OPTIONS(description=""""),
  state STRING OPTIONS(description=""""),
  zip_code STRING OPTIONS(description=""""),
  county_name STRING OPTIONS(description=""""),
  phone_number STRING OPTIONS(description=""""),
  hospital_type STRING OPTIONS(description=""""),
  hospital_ownership STRING OPTIONS(description=""""),
  emergency_services BOOL OPTIONS(description=""""),
  meets_criteria_for_promoting_interoperability_of_ehrs BOOL OPTIONS(description=""""),
  hospital_overall_rating STRING OPTIONS(description=""""),
  hospital_overall_rating_footnote STRING OPTIONS(description=""""),
  mortality_group_measure_count STRING OPTIONS(description=""Count of measures included in the Mortality measure group""),
  facility_mortaility_measures_count STRING OPTIONS(description=""Number of Mortality measures used in the hospital’s overall star rating""),
  mortality_measures_better_count STRING OPTIONS(description=""Number of Mortality measures that are better than the national value""),
  mortality_measures_no_different_count STRING OPTIONS(description=""Number of Mortality measures that are no different than the national value""),
  mortality_measures_worse_count STRING OPTIONS(description=""Number of Mortality measures that are worse than the national value""),
  mortaility_group_footnote STRING OPTIONS(description=""Footnote about Mortality measures""),
  safety_measures_count STRING OPTIONS(description=""Count of measures included in the Safety of Care measure group""),
  facility_care_safety_measures_count STRING OPTIONS(description=""Number of Safety of care measures used in the hospital’s overall star rating""),
  safety_measures_better_count STRING OPTIONS(description=""Number of Safety of care measures that are better than the national value""),
  safety_measures_no_different_count STRING OPTIONS(description=""Number of Safety of care measures that are no different than the national value""),
  safety_measures_worse_count STRING OPTIONS(description=""Number of Safety of care measures that are worse than the national value""),
  safety_group_footnote STRING OPTIONS(description=""Footnote about Safety of care measures""),
  readmission_measures_count STRING OPTIONS(description=""Count of measures included in the Readmission measure group""),
  facility_readmission_measures_count STRING OPTIONS(description=""Number of Readmission measures used in the hospital’s overall star rating""),
  readmission_measures_better_count STRING OPTIONS(description=""Number of Readmission measures that are better than the national value""),
  readmission_measures_no_different_count STRING OPTIONS(description=""Number of Readmission measures that are no different than the national value""),
  readmission_measures_worse_count STRING OPTIONS(description=""Number of Readmission measures that are worse than the national value""),
  readmission_measures_footnote STRING OPTIONS(description=""Footnote about Readmission measures""),
  patient_experience_measures_count STRING OPTIONS(description=""Count of measures included in the Patient experience measure group""),
  facility_patient_experience_measures_count STRING OPTIONS(description=""Number of Patient experience measures used in the hospital’s overall star rating""),
  patient_experience_measures_footnote STRING OPTIONS(description=""Footnote about Patient experience measures""),
  timely_and_effective_care_measures_count STRING OPTIONS(description=""Count of measures included in the Timely and effective care measure group""),
  facility_timely_and_effective_care_measures_count STRING OPTIONS(description=""Number of Timely and effective care measures used in the hospital’s overall star rating""),
  timely_and_effective_care_measures_footnote STRING OPTIONS(description=""Footnote about Timely and effective care measures"")
);"

Database Name: bigquery-public-data
Schema Name: cms_synthetic_patient_data_omop
DDL describes table information.
,0
table_name,observation
ddl,"CREATE TABLE `bigquery-public-data.cms_synthetic_patient_data_omop.observation`
(
  observation_id INT64,
  person_id INT64,
  observation_concept_id INT64,
  observation_date DATE,
  observation_datetime DATETIME,
  observation_type_concept_id INT64,
  value_as_number FLOAT64,
  value_as_string STRING,
  value_as_concept_id INT64,
  qualifier_concept_id INT64,
  unit_concept_id INT64,
  provider_id INT64,
  visit_occurrence_id INT64,
  visit_detail_id INT64,
  observation_source_value STRING,
  observation_source_concept_id INT64,
  unit_source_value STRING,
  qualifier_source_value STRING
);"

,1
table_name,drug_era
ddl,"CREATE TABLE `bigquery-public-data.cms_synthetic_patient_data_omop.drug_era`
(
  drug_era_id INT64,
  person_id INT64,
  drug_concept_id INT64,
  drug_era_start_date DATE,
  drug_era_end_date DATE,
  drug_exposure_count INT64,
  gap_days INT64
);"

,2
table_name,observation_period
ddl,"CREATE TABLE `bigquery-public-data.cms_synthetic_patient_data_omop.observation_period`
(
  observation_period_id INT64,
  person_id INT64,
  observation_period_start_date DATE,
  observation_period_end_date DATE,
  period_type_concept_id INT64
);"

,3
table_name,drug_strength
ddl,"CREATE TABLE `bigquery-public-data.cms_synthetic_patient_data_omop.drug_strength`
(
  drug_concept_id INT64,
  ingredient_concept_id INT64,
  amount_value FLOAT64,
  amount_unit_concept_id INT64,
  numerator_value FLOAT64,
  numerator_unit_concept_id INT64,
  denominator_value FLOAT64,
  denominator_unit_concept_id INT64,
  box_size INT64,
  valid_start_date DATE,
  valid_end_date DATE,
  invalid_reason STRING
);"

,4
table_name,condition_era
ddl,"CREATE TABLE `bigquery-public-data.cms_synthetic_patient_data_omop.condition_era`
(
  condition_era_id INT64,
  person_id INT64,
  condition_concept_id INT64,
  condition_era_start_date DATE,
  condition_era_end_date DATE,
  condition_occurrence_count INT64
);"

,5
table_name,domain
ddl,"CREATE TABLE `bigquery-public-data.cms_synthetic_patient_data_omop.domain`
(
  domain_id STRING NOT NULL,
  domain_name STRING NOT NULL,
  domain_concept_id INT64 NOT NULL
);"

,6
table_name,provider
ddl,"CREATE TABLE `bigquery-public-data.cms_synthetic_patient_data_omop.provider`
(
  provider_id INT64 NOT NULL,
  provider_name STRING,
  npi STRING,
  dea STRING,
  specialty_concept_id INT64,
  care_site_id INT64,
  year_of_birth INT64,
  gender_concept_id INT64,
  provider_source_value STRING,
  specialty_source_value STRING,
  specialty_source_concept_id INT64,
  gender_source_value STRING,
  gender_source_concept_id INT64
);"

,7
table_name,person
ddl,"CREATE TABLE `bigquery-public-data.cms_synthetic_patient_data_omop.person`
(
  race_concept_id INT64,
  ethnicity_concept_id INT64,
  location_id INT64,
  provider_id INT64,
  care_site_id INT64,
  person_source_value STRING,
  gender_source_value STRING,
  gender_source_concept_id INT64,
  race_source_value STRING,
  race_source_concept_id INT64,
  ethnicity_source_value STRING,
  ethnicity_source_concept_id INT64,
  person_id INT64,
  gender_concept_id INT64,
  year_of_birth INT64,
  month_of_birth INT64,
  day_of_birth INT64,
  birth_datetime DATETIME
);"

,8
table_name,concept_relationship
ddl,"CREATE TABLE `bigquery-public-data.cms_synthetic_patient_data_omop.concept_relationship`
(
  concept_id_1 INT64,
  concept_id_2 INT64,
  relationship_id STRING,
  valid_start_date DATE,
  valid_end_date DATE,
  invalid_reason STRING
);"

,9
table_name,procedure_occurrence
ddl,"CREATE TABLE `bigquery-public-data.cms_synthetic_patient_data_omop.procedure_occurrence`
(
  procedure_type_concept_id INT64,
  modifier_concept_id INT64,
  quantity INT64,
  provider_id INT64,
  visit_occurrence_id INT64,
  visit_detail_id INT64,
  procedure_source_value STRING,
  procedure_source_concept_id INT64,
  modifier_source_value STRING,
  procedure_occurrence_id INT64,
  person_id INT64,
  procedure_concept_id INT64,
  procedure_dat DATE,
  procedure_datetime DATETIME
);"

,10
table_name,care_site
ddl,"CREATE TABLE `bigquery-public-data.cms_synthetic_patient_data_omop.care_site`
(
  care_site_id INT64 NOT NULL,
  care_site_name STRING,
  place_of_service_concept_id INT64,
  location_id INT64,
  care_site_source_value STRING,
  place_of_service_source_value STRING
);"

,11
table_name,vocabulary
ddl,"CREATE TABLE `bigquery-public-data.cms_synthetic_patient_data_omop.vocabulary`
(
  vocabulary_id STRING NOT NULL,
  vocabulary_name STRING NOT NULL,
  vocabulary_reference STRING NOT NULL,
  vocabulary_version STRING,
  vocabulary_concept_id INT64 NOT NULL
);"

,12
table_name,death
ddl,"CREATE TABLE `bigquery-public-data.cms_synthetic_patient_data_omop.death`
(
  person_id INT64,
  death_date DATE,
  death_datetime DATETIME,
  death_type_concept_id INT64,
  cause_concept_id INT64,
  cause_source_value STRING,
  cause_source_concept_id INT64
);"

,13
table_name,device_exposure
ddl,"CREATE TABLE `bigquery-public-data.cms_synthetic_patient_data_omop.device_exposure`
(
  device_exposure_id INT64,
  person_id INT64,
  device_concept_id INT64,
  device_exposure_start_date DATE,
  device_exposure_start_datetime DATETIME,
  device_exposure_end_date DATE,
  device_exposure_end_datetime DATETIME,
  device_type_concept_id INT64,
  unique_device_id STRING,
  quantity INT64,
  provider_id INT64,
  visit_occurrence_id INT64,
  visit_detail_id INT64,
  device_source_value STRING,
  device_source_concept_id INT64
);"

,14
table_name,relationship
ddl,"CREATE TABLE `bigquery-public-data.cms_synthetic_patient_data_omop.relationship`
(
  relationship_id STRING NOT NULL,
  relationship_name STRING NOT NULL,
  is_hierarchical STRING NOT NULL,
  defines_ancestry STRING NOT NULL,
  reverse_relationship_id STRING NOT NULL,
  relationship_concept_id INT64 NOT NULL
);"

,15
table_name,payer_plan_period
ddl,"CREATE TABLE `bigquery-public-data.cms_synthetic_patient_data_omop.payer_plan_period`
(
  payer_concept_id INT64,
  payer_source_value STRING,
  payer_source_concept_id INT64,
  plan_concept_id INT64,
  plan_source_value STRING,
  plan_source_concept_id INT64,
  sponsor_concept_id INT64,
  sponsor_source_value STRING,
  sponsor_source_concept_id INT64,
  family_source_value STRING,
  stop_reason_concept_id INT64,
  stop_reason_source_value STRING,
  stop_reason_source_concept_id INT64,
  payer_plan_period_id INT64,
  person_id INT64,
  payer_plan_period_start_date DATE,
  payer_plan_period_end_date DATE
);"

,16
table_name,concept
ddl,"CREATE TABLE `bigquery-public-data.cms_synthetic_patient_data_omop.concept`
(
  concept_id INT64,
  concept_name STRING,
  domain_id STRING,
  vocabulary_id STRING,
  concept_class_id STRING,
  standard_concept STRING,
  concept_code STRING,
  valid_start_date DATE,
  valid_end_date DATE,
  invalid_reason STRING
);"

,17
table_name,location
ddl,"CREATE TABLE `bigquery-public-data.cms_synthetic_patient_data_omop.location`
(
  location_id INT64 NOT NULL,
  address_1 STRING,
  address_2 STRING,
  city STRING,
  state STRING,
  zip STRING,
  county STRING,
  location_source_value STRING
);"

,18
table_name,condition_occurrence
ddl,"CREATE TABLE `bigquery-public-data.cms_synthetic_patient_data_omop.condition_occurrence`
(
  condition_occurrence_id INT64,
  person_id INT64,
  condition_concept_id INT64,
  condition_start_date DATE,
  condition_start_datetime DATETIME,
  condition_end_date DATE,
  condition_end_datetime DATETIME,
  condition_type_concept_id INT64,
  stop_reason STRING,
  provider_id INT64,
  visit_occurrence_id INT64,
  visit_detail_id INT64,
  condition_source_value STRING,
  condition_source_concept_id INT64,
  condition_status_source_value STRING,
  condition_status_concept_id INT64
);"

,19
table_name,drug_exposure
ddl,"CREATE TABLE `bigquery-public-data.cms_synthetic_patient_data_omop.drug_exposure`
(
  drug_type_concept_id INT64,
  stop_reason STRING,
  refills INT64,
  quantity FLOAT64,
  days_supply INT64,
  sig STRING,
  route_concept_id INT64,
  lot_number STRING,
  provider_id INT64,
  visit_occurrence_id INT64,
  visit_detail_id INT64,
  drug_source_value STRING,
  drug_source_concept_id INT64,
  route_source_value STRING,
  dose_unit_source_value STRING,
  drug_exposure_id INT64,
  person_id INT64,
  drug_concept_id INT64,
  drug_exposure_start_date DATE,
  drug_exposure_start_datetime DATETIME,
  drug_exposure_end_date DATE,
  drug_exposure_end_datetime DATETIME,
  verbatim_end_date DATE
);"

,20
table_name,concept_ancestor
ddl,"CREATE TABLE `bigquery-public-data.cms_synthetic_patient_data_omop.concept_ancestor`
(
  ancestor_concept_id INT64 NOT NULL,
  descendant_concept_id INT64 NOT NULL,
  min_levels_of_separation INT64 NOT NULL,
  max_levels_of_separation INT64 NOT NULL
);"

,21
table_name,cost
ddl,"CREATE TABLE `bigquery-public-data.cms_synthetic_patient_data_omop.cost`
(
  cost_id INT64 NOT NULL,
  cost_event_id INT64 NOT NULL,
  cost_domain_id STRING NOT NULL,
  cost_type_concept_id INT64 NOT NULL,
  currency_concept_id INT64,
  total_charge FLOAT64,
  total_cost FLOAT64,
  total_paid FLOAT64,
  paid_by_payer FLOAT64,
  paid_by_patient FLOAT64,
  paid_patient_copay FLOAT64,
  paid_patient_coinsurance FLOAT64,
  paid_patient_deductible FLOAT64,
  paid_by_primary FLOAT64,
  paid_ingredient_cost FLOAT64,
  paid_dispensing_fee FLOAT64,
  payer_plan_period_id INT64,
  amount_allowed FLOAT64,
  revenue_code_concept_id INT64,
  revenue_code_source_value STRING,
  drg_concept_id INT64,
  drg_source_value STRING
);"

,22
table_name,dose_era
ddl,"CREATE TABLE `bigquery-public-data.cms_synthetic_patient_data_omop.dose_era`
(
  dose_era_id INT64,
  person_id INT64,
  drug_concept_id INT64,
  unit_concept_id INT64,
  dose_value FLOAT64,
  dose_era_start_date DATE,
  dose_era_end_date DATE
);"

,23
table_name,concept_class
ddl,"CREATE TABLE `bigquery-public-data.cms_synthetic_patient_data_omop.concept_class`
(
  concept_class_id STRING NOT NULL,
  concept_class_name STRING NOT NULL,
  concept_class_concept_id INT64 NOT NULL
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'cms_codes': ['hcpcs', 'icd10_diagnoses_2019', 'icd10_procedures_2019', 'icd9_diagnoses', 'icd9_procedures'], 'cms_medicare': ['home_health_agencies_2013', 'home_health_agencies_2014', 'hospice_providers_2014', 'hospital_general_info', 'inpatient_charges_2011', 'inpatient_charges_2012', 'inpatient_charges_2013', 'inpatient_charges_2014', 'inpatient_charges_2015', 'nursing_facilities_2013', 'nursing_facilities_2014', 'outpatient_charges_2011', 'outpatient_charges_2012', 'outpatient_charges_2013', 'outpatient_charges_2014', 'outpatient_charges_2015', 'part_d_prescriber_2014', 'physicians_and_other_supplier_2012', 'physicians_and_other_supplier_2013', 'physicians_and_other_supplier_2014', 'physicians_and_other_supplier_2015', 'referring_durable_medical_equip_2013', 'referring_durable_medical_equip_2014'], 'cms_synthetic_patient_data_omop': ['care_site', 'concept', 'concept_ancestor', 'concept_class', 'concept_relationship', 'condition_era', 'condition_occurrence', 'cost', 'death', 'device_exposure', 'domain', 'dose_era', 'drug_era', 'drug_exposure', 'drug_strength', 'location', 'observation', 'observation_period', 'payer_plan_period', 'person', 'procedure_occurrence', 'provider', 'relationship', 'vocabulary']}}
Begin Exploring Related Columns
The tables and columns relevant to the task are:

**Table**: `bigquery-public-data.cms_medicare.part_d_prescriber_2014`

- `nppes_provider_state`: **Potential usage** - Used to group prescriptions by state.
- `drug_name`: **Potential usage** - Identifies the medications prescribed.
- `total_claim_count`: **Potential usage** - Determines how many times each medication was prescribed.
- `generic_name`: **Potential usage** - To analyze medications by their generic names.
- `bene_count`: **Potential usage** - Number of Medicare beneficiaries prescribed each medication.
- `total_drug_cost`: **Potential usage** - Total cost associated with each medication.
  
**Conditions that may be used**:

- **Data Year**: Since the data is for 2014, no additional date filters are required.
- **Privacy Suppression**: Be cautious of suppressed data where beneficiary counts are less than 11.
- **Grouping**: Aggregate data by state and medication to find the most prescribed medication in each state.

Here are SQL queries to explore the data:

```sql
-- 1. List all distinct provider states
SELECT DISTINCT nppes_provider_state
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
LIMIT 100;
```

```sql
-- 2. List all distinct drug names
SELECT DISTINCT drug_name
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
LIMIT 100;
```

```sql
-- 3. Get total number of prescriptions per state
SELECT nppes_provider_state, COUNT(*) AS prescription_count
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY nppes_provider_state
ORDER BY prescription_count DESC
LIMIT 100;
```

```sql
-- 4. Get total claim counts per drug
SELECT drug_name, SUM(total_claim_count) AS total_claims
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY drug_name
ORDER BY total_claims DESC
LIMIT 100;
```

```sql
-- 5. Get total claim counts per state
SELECT nppes_provider_state, SUM(total_claim_count) AS total_claims
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY nppes_provider_state
ORDER BY total_claims DESC
LIMIT 100;
```

```sql
-- 6. Get total claim counts per state and drug
SELECT nppes_provider_state, drug_name, SUM(total_claim_count) AS total_claims
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY nppes_provider_state, drug_name
ORDER BY total_claims DESC
LIMIT 100;
```

```sql
-- 7. Find top 5 most prescribed drugs in California
SELECT drug_name, SUM(total_claim_count) AS total_claims
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
WHERE nppes_provider_state = 'CA'
GROUP BY drug_name
ORDER BY total_claims DESC
LIMIT 5;
```

```sql
-- 8. Get total number of beneficiaries per drug
SELECT drug_name, SUM(bene_count) AS total_beneficiaries
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY drug_name
ORDER BY total_beneficiaries DESC
LIMIT 100;
```

```sql
-- 9. Calculate average cost per prescription for each drug
SELECT drug_name, SUM(total_drug_cost)/SUM(total_claim_count) AS avg_cost_per_prescription
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY drug_name
ORDER BY avg_cost_per_prescription DESC
LIMIT 100;
```

```sql
-- 10. Find the most prescribed medication in each state
SELECT
  state_drug.nppes_provider_state AS State,
  state_drug.drug_name AS Drug_Name,
  state_drug.total_claims AS Total_Claims
FROM (
  SELECT
    nppes_provider_state,
    drug_name,
    SUM(total_claim_count) AS total_claims,
    RANK() OVER (PARTITION BY nppes_provider_state ORDER BY SUM(total_claim_count) DESC) AS rank
  FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
  GROUP BY nppes_provider_state, drug_name
) AS state_drug
WHERE state_drug.rank = 1
ORDER BY state_drug.nppes_provider_state
LIMIT 100;
```

```sql
-- 11. Find the number of providers prescribing each drug
SELECT drug_name, COUNT(DISTINCT npi) AS provider_count
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY drug_name
ORDER BY provider_count DESC
LIMIT 100;
```

```sql
-- 12. Get total drug cost per state
SELECT nppes_provider_state, SUM(total_drug_cost) AS total_cost
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY nppes_provider_state
ORDER BY total_cost DESC
LIMIT 100;
```

```sql
-- 13. List drugs with the highest total drug cost
SELECT drug_name, SUM(total_drug_cost) AS total_cost
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY drug_name
ORDER BY total_cost DESC
LIMIT 100;
```

```sql
-- 14. Get total beneficiaries aged 65+ per drug
SELECT drug_name, SUM(bene_count_ge65) AS beneficiaries_65_plus
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY drug_name
ORDER BY beneficiaries_65_plus DESC
LIMIT 100;
```

```sql
-- 15. Calculate average day supply per prescription for each drug
SELECT drug_name, SUM(total_day_supply)/SUM(total_claim_count) AS avg_day_supply
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY drug_name
ORDER BY avg_day_supply DESC
LIMIT 100;
```

These queries explore the relevant columns and data needed to determine the most prescribed medication in each state in 2014.Query:
-- 1. List all distinct provider states
SELECT DISTINCT nppes_provider_state
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
LIMIT 100;
Answer:
nppes_provider_state
CA
NY
TX
NJ
IN
OR
MS
VA
PR
CO
PA
NC
WY
NM
MN
WI
TN
GA
ME
CT
NV
DE
RI
HI
MP
AS
OH
MI
FL
SC
OK
KY
WA
SD
KS
LA
MA
ID
IL
AL
UT
AR
IA
MD
AZ
ND
NH
NE
MO
MT
WV
VT
AK
DC
VI
ZZ
AP
AE
GU
AA
XX
Query:
-- 2. List all distinct drug names
SELECT DISTINCT drug_name
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
LIMIT 100;
Answer:
drug_name
LANTUS SOLOSTAR
GABAPENTIN
LATANOPROST
FLUTICASONE PROPIONATE
LISINOPRIL-HYDROCHLOROTHIAZIDE
LISINOPRIL
ENOXAPARIN SODIUM
FLUOXETINE HCL
SYMBICORT
POLYETHYLENE GLYCOL 3350
QUETIAPINE FUMARATE
NAPROXEN
TEMAZEPAM
ALLOPURINOL
PAROXETINE HCL
LOSARTAN POTASSIUM
PREDNISONE
TAMSULOSIN HCL
PENICILLIN V POTASSIUM
DULERA
TRIAMCINOLONE ACETONIDE
TRIAMTERENE-HYDROCHLOROTHIAZID
NIFEDIPINE ER
DIAZEPAM
VENLAFAXINE HCL ER
KETOCONAZOLE
LEVOCETIRIZINE DIHYDROCHLORIDE
NOVOLOG FLEXPEN
INSULIN SYRINGE
DESONIDE
HYDROCHLOROTHIAZIDE
METOPROLOL SUCCINATE
ANASTROZOLE
ZETIA
GAVILYTE-N
NEUPRO
PRAVASTATIN SODIUM
CLONIDINE
MELOXICAM
HYDROCODONE-ACETAMINOPHEN
ETODOLAC
DILTIAZEM 24HR CD
BUPROPION HCL
HYDRALAZINE HCL
PIOGLITAZONE HCL
LOVASTATIN
ILEVRO
BRIMONIDINE TARTRATE
CYCLOGYL
IBUPROFEN
GLIMEPIRIDE
MYRBETRIQ
NITROSTAT
LIDOCAINE
VENLAFAXINE HCL
FAMOTIDINE
BUPROPION HCL SR
NOVOLIN R
CITALOPRAM HBR
TORSEMIDE
BENICAR
CIPROFLOXACIN HCL
LEVEMIR FLEXPEN
SOTALOL
HYDROXYUREA
RESTASIS
SANTYL
AMLODIPINE BESYLATE-BENAZEPRIL
METOCLOPRAMIDE HCL
LACTULOSE
XARELTO
FENOFIBRIC ACID
ROPINIROLE HCL
ESTRADIOL
JANUVIA
DIVALPROEX SODIUM ER
DOXYCYCLINE HYCLATE
CLONIDINE HCL
BUPROPION XL
PROPRANOLOL HCL ER
QVAR
CEFUROXIME
RAMIPRIL
AMOXICILLIN
HYDROCORTISONE
KLOR-CON 10
K-TAB ER
HYDROXYZINE PAMOATE
FLECAINIDE ACETATE
APIDRA
VALACYCLOVIR
IRBESARTAN
ACETAMINOPHEN-CODEINE
CHLORTHALIDONE
TACROLIMUS
HUMALOG MIX 75-25
TRAMADOL HCL-ACETAMINOPHEN
SAPHRIS
MONTELUKAST SODIUM
ISOSORBIDE DINITRATE
Query:
-- 3. Get total number of prescriptions per state
SELECT nppes_provider_state, COUNT(*) AS prescription_count
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY nppes_provider_state
ORDER BY prescription_count DESC
LIMIT 100;
Answer:
nppes_provider_state,prescription_count
CA,2314491
NY,1650337
FL,1611230
TX,1472194
PA,1229100
OH,1001853
NC,876296
IL,866555
MI,824210
GA,665123
NJ,650274
TN,634761
MA,557193
MO,553249
IN,536177
VA,532042
WI,463181
WA,458140
KY,451198
AZ,422552
AL,416414
SC,403874
MN,401258
LA,394524
PR,340193
MD,337502
OR,317042
CO,310071
OK,290335
IA,287799
CT,285153
AR,270034
MS,269114
KS,245809
WV,205148
NE,166946
NV,149874
ME,138404
UT,137461
NM,131194
ID,112680
NH,103139
RI,100820
MT,79659
HI,79295
SD,75409
DE,68643
ND,66876
VT,53720
DC,40964
WY,34780
AK,28789
VI,3909
GU,1966
ZZ,940
AE,258
MP,253
AP,95
XX,77
AA,29
AS,12
Query:
-- 4. Get total claim counts per drug
SELECT drug_name, SUM(total_claim_count) AS total_claims
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY drug_name
ORDER BY total_claims DESC
LIMIT 100;
Answer:
drug_name,total_claims
LISINOPRIL,37599566
LEVOTHYROXINE SODIUM,37075950
AMLODIPINE BESYLATE,35659180
SIMVASTATIN,33549777
OMEPRAZOLE,32276944
HYDROCODONE-ACETAMINOPHEN,32204330
ATORVASTATIN CALCIUM,31959252
FUROSEMIDE,26372608
METFORMIN HCL,22952294
GABAPENTIN,21323652
METOPROLOL TARTRATE,20782646
LOSARTAN POTASSIUM,17873509
HYDROCHLOROTHIAZIDE,17373067
METOPROLOL SUCCINATE,16781720
WARFARIN SODIUM,15241971
CLOPIDOGREL,14563125
PRAVASTATIN SODIUM,14190361
CARVEDILOL,13310395
TRAMADOL HCL,13242625
ALPRAZOLAM,13081892
ATENOLOL,12883671
POTASSIUM CHLORIDE,12506552
TAMSULOSIN HCL,11685280
SERTRALINE HCL,11187864
PANTOPRAZOLE SODIUM,11071364
CITALOPRAM HBR,10234686
PREDNISONE,9844536
TRAZODONE HCL,9663151
FLUTICASONE PROPIONATE,9614633
LORAZEPAM,9560017
ZOLPIDEM TARTRATE,9448045
CLONAZEPAM,9267099
CRESTOR,8600472
OXYCODONE-ACETAMINOPHEN,8250381
DONEPEZIL HCL,8052913
MELOXICAM,7921650
PROAIR HFA,7686762
ALLOPURINOL,7530262
ALENDRONATE SODIUM,7293735
RANITIDINE HCL,7170871
LISINOPRIL-HYDROCHLOROTHIAZIDE,7042874
NEXIUM,6968108
MONTELUKAST SODIUM,6855005
ESCITALOPRAM OXALATE,6711864
DULOXETINE HCL,6503301
QUETIAPINE FUMARATE,6398416
LATANOPROST,6339049
AZITHROMYCIN,6135891
CIPROFLOXACIN HCL,5924418
FLUOXETINE HCL,5834784
GLIMEPIRIDE,5613158
OXYCODONE HCL,5603775
LOVASTATIN,5551048
ISOSORBIDE MONONITRATE ER,5542060
ADVAIR DISKUS,5541448
LOSARTAN-HYDROCHLOROTHIAZIDE,5512996
SPIRIVA,5339480
SYNTHROID,5306839
MIRTAZAPINE,5235802
GLIPIZIDE,5077217
AMOXICILLIN,4970056
FENOFIBRATE,4957587
NAMENDA,4879366
SPIRONOLACTONE,4612646
RISPERIDONE,4511603
TRIAMTERENE-HYDROCHLOROTHIAZID,4407324
FINASTERIDE,4357389
IBUPROFEN,4326254
PAROXETINE HCL,4313490
CLONIDINE HCL,4299189
ENALAPRIL MALEATE,4211624
JANUVIA,4112402
LANTUS SOLOSTAR,3967264
LYRICA,3933987
METFORMIN HCL ER,3927209
LANTUS,3799781
VENLAFAXINE HCL ER,3776399
CEPHALEXIN,3636174
FAMOTIDINE,3621252
DIOVAN,3614837
SULFAMETHOXAZOLE-TRIMETHOPRIM,3569752
AMITRIPTYLINE HCL,3539561
DIAZEPAM,3510005
HYDRALAZINE HCL,3501872
LEVOFLOXACIN,3378066
POLYETHYLENE GLYCOL 3350,3178311
ZETIA,3174655
TEMAZEPAM,3171737
VALSARTAN-HYDROCHLOROTHIAZIDE,3065182
Query:
-- 5. Get total claim counts per state
SELECT nppes_provider_state, SUM(total_claim_count) AS total_claims
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY nppes_provider_state
ORDER BY total_claims DESC
LIMIT 100;
Answer:
nppes_provider_state,total_claims
CA,116440694
FL,91441123
NY,79570924
TX,75682169
PA,62946334
OH,53494076
NC,46020420
IL,42527191
MI,39461213
GA,39066489
TN,35472398
MO,31071230
NJ,29242463
IN,27822613
KY,26196384
AL,26162156
MA,26156247
VA,25549776
PR,24988874
LA,22456360
SC,21795317
WI,21461606
AZ,19873807
WA,19108957
MN,17312127
MS,15737130
AR,15647866
OK,14918485
IA,14673562
OR,13889191
MD,13798859
CT,12892970
CO,12823030
KS,12042320
WV,11216491
NE,7991763
NV,7457176
UT,5796245
NM,5770207
ME,5699119
RI,5535266
ID,4852448
NH,4095519
HI,3777714
SD,3525885
MT,3315266
ND,3061665
DE,3042265
VT,2115996
DC,1487724
WY,1380174
AK,1074367
VI,197072
GU,76979
ZZ,33284
AE,7617
MP,7104
XX,1909
AP,1839
AA,999
AS,218
Query:
-- 6. Get total claim counts per state and drug
SELECT nppes_provider_state, drug_name, SUM(total_claim_count) AS total_claims
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY nppes_provider_state, drug_name
ORDER BY total_claims DESC
LIMIT 100;
Answer:
nppes_provider_state,drug_name,total_claims
CA,HYDROCODONE-ACETAMINOPHEN,3726576
CA,AMLODIPINE BESYLATE,3725846
CA,ATORVASTATIN CALCIUM,3672387
CA,LEVOTHYROXINE SODIUM,3489384
CA,SIMVASTATIN,3391598
CA,LISINOPRIL,3328132
CA,OMEPRAZOLE,2893661
FL,LISINOPRIL,2871093
TX,HYDROCODONE-ACETAMINOPHEN,2828779
FL,AMLODIPINE BESYLATE,2689327
NY,AMLODIPINE BESYLATE,2606392
FL,OMEPRAZOLE,2591089
CA,METFORMIN HCL,2583231
FL,LEVOTHYROXINE SODIUM,2561909
FL,SIMVASTATIN,2530274
NY,SIMVASTATIN,2483824
TX,LEVOTHYROXINE SODIUM,2447248
TX,LISINOPRIL,2351958
NY,ATORVASTATIN CALCIUM,2343736
CA,LOSARTAN POTASSIUM,2213792
TX,AMLODIPINE BESYLATE,2212275
NY,OMEPRAZOLE,2158771
NY,LEVOTHYROXINE SODIUM,2091879
FL,ATORVASTATIN CALCIUM,2064692
PA,LISINOPRIL,2033522
PA,LEVOTHYROXINE SODIUM,2024303
CA,FUROSEMIDE,1999403
PA,SIMVASTATIN,1931843
TX,ATORVASTATIN CALCIUM,1879085
NY,LISINOPRIL,1878852
TX,SIMVASTATIN,1858339
FL,METFORMIN HCL,1845228
CA,HYDROCHLOROTHIAZIDE,1788127
MI,HYDROCODONE-ACETAMINOPHEN,1787940
CA,GABAPENTIN,1785041
CA,ATENOLOL,1782218
OH,LISINOPRIL,1778440
PA,AMLODIPINE BESYLATE,1760543
PA,ATORVASTATIN CALCIUM,1743254
PA,OMEPRAZOLE,1734422
FL,HYDROCODONE-ACETAMINOPHEN,1725922
CA,METOPROLOL TARTRATE,1655218
OH,LEVOTHYROXINE SODIUM,1624110
NY,FUROSEMIDE,1604273
TX,FUROSEMIDE,1601027
FL,METOPROLOL TARTRATE,1589154
FL,FUROSEMIDE,1575080
OH,ATORVASTATIN CALCIUM,1546208
FL,LOSARTAN POTASSIUM,1538109
PA,FUROSEMIDE,1506694
NY,METOPROLOL SUCCINATE,1497362
NY,METFORMIN HCL,1483466
NY,METOPROLOL TARTRATE,1476125
FL,GABAPENTIN,1474132
OH,AMLODIPINE BESYLATE,1468596
FL,ALPRAZOLAM,1439338
PA,METOPROLOL TARTRATE,1436931
TX,OMEPRAZOLE,1421370
Query:
-- 7. Find top 5 most prescribed drugs in California
SELECT drug_name, SUM(total_claim_count) AS total_claims
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
WHERE nppes_provider_state = 'CA'
GROUP BY drug_name
ORDER BY total_claims DESC
LIMIT 5;
Answer:
drug_name,total_claims
HYDROCODONE-ACETAMINOPHEN,3726576
AMLODIPINE BESYLATE,3725846
ATORVASTATIN CALCIUM,3672387
LEVOTHYROXINE SODIUM,3489384
SIMVASTATIN,3391598
Query:
-- 8. Get total number of beneficiaries per drug
SELECT drug_name, SUM(bene_count) AS total_beneficiaries
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY drug_name
ORDER BY total_beneficiaries DESC
LIMIT 100;
Answer:
drug_name,total_beneficiaries
HYDROCODONE-ACETAMINOPHEN,10817697
LISINOPRIL,8675692
AMLODIPINE BESYLATE,7682266
SIMVASTATIN,7497208
ATORVASTATIN CALCIUM,7405135
OMEPRAZOLE,7300874
LEVOTHYROXINE SODIUM,7245310
FUROSEMIDE,5852856
METFORMIN HCL,4900356
AZITHROMYCIN,4774572
GABAPENTIN,4651440
PREDNISONE,4586037
CIPROFLOXACIN HCL,4457864
METOPROLOL TARTRATE,4360023
TRAMADOL HCL,4246389
HYDROCHLOROTHIAZIDE,3845495
FLUTICASONE PROPIONATE,3702451
LOSARTAN POTASSIUM,3701880
AMOXICILLIN,3612816
METOPROLOL SUCCINATE,3325886
PRAVASTATIN SODIUM,2922575
OXYCODONE-ACETAMINOPHEN,2748892
CLOPIDOGREL,2720095
PROAIR HFA,2624217
CEPHALEXIN,2592387
CARVEDILOL,2564595
LEVOFLOXACIN,2549252
ALPRAZOLAM,2468364
POTASSIUM CHLORIDE,2456536
ATENOLOL,2456457
WARFARIN SODIUM,2412911
TAMSULOSIN HCL,2335881
PANTOPRAZOLE SODIUM,2260849
SULFAMETHOXAZOLE-TRIMETHOPRIM,2247455
MELOXICAM,2236180
LORAZEPAM,1873998
AMOX TR-POTASSIUM CLAVULANATE,1785717
ZOLPIDEM TARTRATE,1768819
TRAZODONE HCL,1739764
METHYLPREDNISOLONE,1729370
SERTRALINE HCL,1720269
CITALOPRAM HBR,1641972
IBUPROFEN,1530694
TRIAMCINOLONE ACETONIDE,1489891
PREDNISOLONE ACETATE,1455967
CRESTOR,1420185
CLONAZEPAM,1312098
LISINOPRIL-HYDROCHLOROTHIAZIDE,1282602
LATANOPROST,1247824
RANITIDINE HCL,1223838
OXYCODONE HCL,1211847
ALLOPURINOL,1195957
ALENDRONATE SODIUM,1183838
DONEPEZIL HCL,1111167
MONTELUKAST SODIUM,1096358
DOXYCYCLINE HYCLATE,1067596
NEXIUM,971653
ADVAIR DISKUS,941621
GLIMEPIRIDE,911256
LOVASTATIN,883168
NAPROXEN,868369
ZOSTAVAX,866039
ESCITALOPRAM OXALATE,859694
NITROSTAT,831141
LOSARTAN-HYDROCHLOROTHIAZIDE,811266
ISOSORBIDE MONONITRATE ER,806568
MUPIROCIN,794516
SPIRIVA,794338
SYNTHROID,787996
DULOXETINE HCL,766721
GLIPIZIDE,760896
QUETIAPINE FUMARATE,755979
FINASTERIDE,712001
MIRTAZAPINE,708195
ACETAMINOPHEN-CODEINE,700454
POLYETHYLENE GLYCOL 3350,691040
FLUOXETINE HCL,686133
CLOBETASOL PROPIONATE,672141
TRIAMTERENE-HYDROCHLOROTHIAZID,645974
Query:
-- 9. Calculate average cost per prescription for each drug
SELECT drug_name, SUM(total_drug_cost)/SUM(total_claim_count) AS avg_cost_per_prescription
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY drug_name
ORDER BY avg_cost_per_prescription DESC
LIMIT 100;
Answer:
drug_name,avg_cost_per_prescription
ADAGEN,94218.08307692308
ELAPRASE,58922.49405405405
CINRYZE,52784.52038490566
FIRAZYR,48099.664440753055
BERINERT,47776.396711590285
CARBAGLU,44471.74333333333
NAGLAZYME,42268.612844036696
RAVICTI,41223.500497925306
PROCYSBI,40156.55495327103
ALDURAZYME,39379.55583333333
H.P. ACTHAR,39204.23321896073
CHENODAL,36052.11075000001
ACTIMMUNE,33417.86827683616
YERVOY,32363.61
HARVONI,32080.829197146304
GATTEX,28956.995817245814
KALBITOR,28842.325021897806
SOVALDI,28340.424900299837
ELELYSO,28307.300000000003
JUXTAPID,27518.29496865204
LUMIZYME,27010.800597014924
KALYDECO,25481.912769516726
VPRIV,22641.465223880597
OLYSIO,22558.138000295647
INCIVEK,22557.087058823527
APOKYN,22329.24423580786
SOLIRIS,22265.210060240966
ARCALYST,21002.0
REMODULIN,20897.5380952381
MOZOBIL,20282.172083333335
KYNAMRO,20201.490625000002
ILARIS,19728.650555555552
VENTAVIS,17345.661
ZAVESCA,16975.584468085104
KORLYM,15957.928796296295
TARGRETIN,15888.06256
SYPRINE,15785.365827586207
ADCETRIS,15459.004
SIGNIFOR,15243.0755
KUVAN,14731.920958286355
FABRAZYME,14477.500735551663
CEREZYME,14467.57185858586
TYVASO,14185.003846153842
AFINITOR DISPERZ,13565.781923076924
BIVIGAM,12455.43
XALKORI,11575.664203494345
SABRIL,11442.97229428173
STELARA,11051.114118488837
POMALYST,10956.69026162791
ICLUSIG,10725.371255230126
OCTAGAM,10576.266011477763
COMETRIQ,10489.468520179375
SEROSTIM,10414.583615059546
KEYTRUDA,10196.00846153846
ACTIQ,10121.035454545454
CAPRELSA,9873.375465686275
AFINITOR,9699.803753008038
INLYTA,9660.476653789005
STIVARGA,9531.084188398085
TALWIN,9481.949999999999
REVLIMID,9364.143442414335
ZEMAIRA,9301.863337570363
ZYKADIA,9105.113513513514
MEKINIST,9028.769855687604
JEVTANA,9015.62534883721
JAKAFI,8997.707499677379
ERIVEDGE,8984.350845070423
IMBRUVICA,8907.086982665869
DACOGEN,8906.497647058823
ZELBORAF,8896.525093023258
Query:
-- 10. Find the most prescribed medication in each state
SELECT
  state_drug.nppes_provider_state AS State,
  state_drug.drug_name AS Drug_Name,
  state_drug.total_claims AS Total_Claims
FROM (
  SELECT
    nppes_provider_state,
    drug_name,
    SUM(total_claim_count) AS total_claims,
    RANK() OVER (PARTITION BY nppes_provider_state ORDER BY SUM(total_claim_count) DESC) AS rank
  FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
  GROUP BY nppes_provider_state, drug_name
) AS state_drug
WHERE state_drug.rank = 1
ORDER BY state_drug.nppes_provider_state
LIMIT 100;
Answer:
State,Drug_Name,Total_Claims
AA,AMOXICILLIN,225
AE,HYDROCODONE-ACETAMINOPHEN,654
AK,LISINOPRIL,47684
AL,HYDROCODONE-ACETAMINOPHEN,1213330
AP,HYDROCODONE-ACETAMINOPHEN,208
AR,HYDROCODONE-ACETAMINOPHEN,587649
AS,LISINOPRIL,46
AZ,LISINOPRIL,828863
CA,HYDROCODONE-ACETAMINOPHEN,3726576
CO,LEVOTHYROXINE SODIUM,589164
CT,ATORVASTATIN CALCIUM,461074
DC,AMLODIPINE BESYLATE,69324
DE,ATORVASTATIN CALCIUM,97290
FL,LISINOPRIL,2871093
GA,AMLODIPINE BESYLATE,1281335
GU,AMLODIPINE BESYLATE,5271
HI,ATORVASTATIN CALCIUM,156380
IA,LEVOTHYROXINE SODIUM,544870
ID,HYDROCODONE-ACETAMINOPHEN,211426
IL,LISINOPRIL,1334343
IN,HYDROCODONE-ACETAMINOPHEN,1035865
KS,LEVOTHYROXINE SODIUM,447078
KY,HYDROCODONE-ACETAMINOPHEN,983246
LA,HYDROCODONE-ACETAMINOPHEN,793627
MA,LISINOPRIL,1126516
MD,LISINOPRIL,463264
ME,LISINOPRIL,208274
MI,HYDROCODONE-ACETAMINOPHEN,1787940
MN,LISINOPRIL,692802
MO,LISINOPRIL,1064850
MP,AMLODIPINE BESYLATE,564
MS,HYDROCODONE-ACETAMINOPHEN,623183
MT,LEVOTHYROXINE SODIUM,145710
NC,AMLODIPINE BESYLATE,1389222
ND,LEVOTHYROXINE SODIUM,114009
NE,LEVOTHYROXINE SODIUM,308512
NH,LISINOPRIL,149289
NJ,ATORVASTATIN CALCIUM,945135
NM,LEVOTHYROXINE SODIUM,267086
NV,HYDROCODONE-ACETAMINOPHEN,294378
NY,AMLODIPINE BESYLATE,2606392
OH,LISINOPRIL,1778440
OK,HYDROCODONE-ACETAMINOPHEN,638774
OR,LISINOPRIL,541027
PA,LISINOPRIL,2033522
PR,SIMVASTATIN,1101152
RI,LISINOPRIL,212723
SC,HYDROCODONE-ACETAMINOPHEN,704846
SD,LEVOTHYROXINE SODIUM,142784
TN,HYDROCODONE-ACETAMINOPHEN,1377155
TX,HYDROCODONE-ACETAMINOPHEN,2828779
UT,LEVOTHYROXINE SODIUM,230671
VA,LISINOPRIL,818906
VI,AMLODIPINE BESYLATE,12153
VT,LISINOPRIL,74698
WA,LISINOPRIL,771338
WI,LISINOPRIL,679420
WV,HYDROCODONE-ACETAMINOPHEN,400008
WY,LEVOTHYROXINE SODIUM,72201
XX,SIMVASTATIN,135
ZZ,HYDROCODONE-ACETAMINOPHEN,2232
Query:
-- 11. Find the number of providers prescribing each drug
SELECT drug_name, COUNT(DISTINCT npi) AS provider_count
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY drug_name
ORDER BY provider_count DESC
LIMIT 100;
Answer:
drug_name,provider_count
HYDROCODONE-ACETAMINOPHEN,332670
LISINOPRIL,273518
OMEPRAZOLE,264842
AMLODIPINE BESYLATE,259828
GABAPENTIN,254001
ATORVASTATIN CALCIUM,247176
FUROSEMIDE,240799
LEVOTHYROXINE SODIUM,239458
SIMVASTATIN,239013
METOPROLOL TARTRATE,225246
HYDROCHLOROTHIAZIDE,219320
TRAMADOL HCL,215668
METFORMIN HCL,211800
PREDNISONE,211480
LOSARTAN POTASSIUM,203941
METOPROLOL SUCCINATE,197700
CLOPIDOGREL,188714
PANTOPRAZOLE SODIUM,187685
SERTRALINE HCL,182566
ATENOLOL,182027
WARFARIN SODIUM,180434
FLUTICASONE PROPIONATE,179744
PRAVASTATIN SODIUM,179715
CARVEDILOL,178731
ZOLPIDEM TARTRATE,172579
CIPROFLOXACIN HCL,169102
AZITHROMYCIN,168900
CITALOPRAM HBR,168733
ALPRAZOLAM,168384
PROAIR HFA,167530
POTASSIUM CHLORIDE,166692
TRAZODONE HCL,166204
AMOXICILLIN,164821
OXYCODONE-ACETAMINOPHEN,162469
LORAZEPAM,161133
TAMSULOSIN HCL,158762
CLONAZEPAM,150597
CRESTOR,147617
ALLOPURINOL,147379
ALENDRONATE SODIUM,140647
DULOXETINE HCL,138852
NEXIUM,138178
MELOXICAM,137191
RANITIDINE HCL,137158
FLUOXETINE HCL,136811
LISINOPRIL-HYDROCHLOROTHIAZIDE,136204
MONTELUKAST SODIUM,136058
ESCITALOPRAM OXALATE,134842
ADVAIR DISKUS,130418
IBUPROFEN,127341
SULFAMETHOXAZOLE-TRIMETHOPRIM,126831
CEPHALEXIN,126152
DONEPEZIL HCL,123016
PAROXETINE HCL,118198
SPIRONOLACTONE,117954
SPIRIVA,116721
LOVASTATIN,112837
LOSARTAN-HYDROCHLOROTHIAZIDE,112536
ISOSORBIDE MONONITRATE ER,110988
AMITRIPTYLINE HCL,110942
GLIPIZIDE,110692
CLONIDINE HCL,109254
LEVOFLOXACIN,107904
TRIAMTERENE-HYDROCHLOROTHIAZID,106790
QUETIAPINE FUMARATE,105229
LYRICA,104553
VENLAFAXINE HCL ER,103054
FENOFIBRATE,101933
MIRTAZAPINE,101307
SYNTHROID,100029
LANTUS SOLOSTAR,99510
DIOVAN,98054
DIAZEPAM,97824
ENALAPRIL MALEATE,96564
GLIMEPIRIDE,95714
OXYCODONE HCL,95207
JANUVIA,95176
LANTUS,94668
NAPROXEN,92706
AMOX TR-POTASSIUM CLAVULANATE,91950
CYCLOBENZAPRINE HCL,90498
TRIAMCINOLONE ACETONIDE,89505
FAMOTIDINE,88666
HYDRALAZINE HCL,87758
ZETIA,85915
CELEBREX,85912
METFORMIN HCL ER,85254
FINASTERIDE,85112
Query:
-- 12. Get total drug cost per state
SELECT nppes_provider_state, SUM(total_drug_cost) AS total_cost
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY nppes_provider_state
ORDER BY total_cost DESC
LIMIT 100;
Answer:
nppes_provider_state,total_cost
CA,9633494580.83
NY,7521861271.35999
FL,6969574542.379993
TX,6462480867.609992
PA,4841813377.079992
OH,4050597920.300001
NC,3357740486.2099996
MI,3193421559.0900006
IL,3120595897.41
NJ,2980085648.5600014
GA,2787324531.740001
TN,2449796259.9899974
MO,2266900573.05
IN,2151310576.0699973
MA,1993379967.3800004
VA,1845291759.1399996
AL,1774188310.3900003
KY,1749915624.0499985
SC,1625039227.0200002
WI,1595424680.749999
LA,1586697376.66
AZ,1531414913.7199998
WA,1374073749.7699993
MD,1285911121.54
MN,1268712288.7500005
CT,1213947159.8299997
OK,1099747189.1000004
PR,998242828.4500014
CO,987955657.2399999
MS,971791465.0899996
OR,940748728.5399998
AR,924771139.8099996
IA,851657297.3799996
KS,812376124.8000007
WV,774905769.86
NV,530336271.7500001
NE,513097615.1699999
UT,446198781.29000014
ME,445414042.08
NM,402878429.6
RI,345326474.99000007
HI,342155461.1400002
ID,340866011.09
NH,322343632.6399999
DE,313539382.5
MT,235183327.44999996
SD,233180044.24000004
ND,198826531.82999998
DC,192973624.24999988
VT,171127800.38000014
WY,89775137.25999999
AK,78887893.48
VI,9122593.649999999
GU,3012622.0100000002
ZZ,2394695.3499999996
AE,482799.32
MP,273092.65
AP,68270.66
XX,41955.98999999999
AA,9045.199999999999
AS,1660.4500000000003
Query:
-- 13. List drugs with the highest total drug cost
SELECT drug_name, SUM(total_drug_cost) AS total_cost
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY drug_name
ORDER BY total_cost DESC
LIMIT 100;
Answer:
drug_name,total_cost
SOVALDI,2485823689.28
NEXIUM,2422256935.2699995
CRESTOR,2395819380.209999
ABILIFY,2246738757.4499993
ADVAIR DISKUS,2064905171.0499985
SPIRIVA,1956946798.48
LANTUS SOLOSTAR,1805583150.83
JANUVIA,1591852562.3299997
LANTUS,1511895513.56
REVLIMID,1501156471.1099997
DULOXETINE HCL,1299549926.3799994
NAMENDA,1241647331.020001
LYRICA,1208504599.4599996
COPAXONE,1084451472.8400002
HUMIRA,1061315938.98
ENBREL,1059207127.8000001
XARELTO,915381796.09
ZETIA,898243212.4600005
CELEBREX,881309305.3099996
OXYCONTIN,851332366.6400001
RENVELA,802718750.14
SYMBICORT,790798550.2900001
DIOVAN,784411444.9700001
GLEEVEC,783235048.15
HUMALOG,752870628.3700002
ATORVASTATIN CALCIUM,733947717.3100002
SENSIPAR,683162759.69
HYDROCODONE-ACETAMINOPHEN,658789651.37
METOPROLOL SUCCINATE,646937388.21
NOVOLOG FLEXPEN,625962433.6000001
LEVOTHYROXINE SODIUM,621294485.3900005
TRUVADA,620532757.1500001
OLYSIO,610400656.1499999
ZYTIGA,559179652.48
TECFIDERA,525482767.33
RESTASIS,523204440.12
ATRIPLA,518824755.4399998
OMEPRAZOLE,517533247.78000003
LEVEMIR FLEXPEN,491353136.93
INVEGA SUSTENNA,490550534.99
SEROQUEL XR,489588648.6700001
VESICARE,488845587.36999977
GABAPENTIN,475796482.4899998
PROAIR HFA,451525668.5599999
EXELON,450012839.46999997
NAMENDA XR,444653593.32000005
OXYCODONE-ACETAMINOPHEN,444323992.0899998
PRADAXA,443856922.4499999
FENOFIBRATE,438239797.47999996
PRAVASTATIN SODIUM,432287194.7399998
NOVOLOG,396680339.9199999
ISENTRESS,374356991.35
PREZISTA,365911525.47
POTASSIUM CHLORIDE,364394350.9599998
LETAIRIS,363415750.06
TRACLEER,361118458.96
COMBIVENT RESPIMAT,358973349.4699999
LUMIGAN,358222504.86999995
FENTANYL,345832972.7699999
QUETIAPINE FUMARATE,344499121.15999997
SIMVASTATIN,341421087.82999986
LATUDA,336714149.85
LEVEMIR,328371357.5300001
CLOPIDOGREL,327030151.1399999
LIDOCAINE,323922405.00999993
HARVONI,319268412.17
JANUMET,319255029.14000005
TARCEVA,310565637.91
XTANDI,308447612.5
DIVALPROEX SODIUM ER,307495238.9599999
VICTOZA 3-PAK,306217214.05999994
AMLODIPINE BESYLATE,298507550.6199999
DEXILANT,297462930.8999999
MORPHINE SULFATE ER,290867807.89
RANEXA,289918921.92
BENICAR,282708959.5700001
LISINOPRIL,277213345.6500002
OXYCODONE HCL,272529852.76000005
TAMSULOSIN HCL,272151299.9099999
OLANZAPINE,270030069.6700001
FORTEO,269541419.89
TRAVATAN Z,268699916.27
GILENYA,256725761.24999997
LOSARTAN POTASSIUM,256379132.92999998
REYATAZ,252765728.40000007
Query:
-- 14. Get total beneficiaries aged 65+ per drug
SELECT drug_name, SUM(bene_count_ge65) AS beneficiaries_65_plus
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY drug_name
ORDER BY beneficiaries_65_plus DESC
LIMIT 100;
Answer:
drug_name,beneficiaries_65_plus
HYDROCODONE-ACETAMINOPHEN,3883349
LISINOPRIL,2651998
OMEPRAZOLE,2422390
AMLODIPINE BESYLATE,2001780
LEVOTHYROXINE SODIUM,1950708
SIMVASTATIN,1909051
ATORVASTATIN CALCIUM,1876894
FUROSEMIDE,1511192
GABAPENTIN,1372683
METFORMIN HCL,1343137
PREDNISONE,1286630
AZITHROMYCIN,1219132
CIPROFLOXACIN HCL,1123199
TRAMADOL HCL,1098659
METOPROLOL TARTRATE,957220
AMOXICILLIN,871558
FLUTICASONE PROPIONATE,840562
LOSARTAN POTASSIUM,830905
HYDROCHLOROTHIAZIDE,813544
TAMSULOSIN HCL,713260
PRAVASTATIN SODIUM,710091
METOPROLOL SUCCINATE,695195
CLOPIDOGREL,661094
OXYCODONE-ACETAMINOPHEN,654360
PREDNISOLONE ACETATE,648581
CARVEDILOL,642135
LEVOFLOXACIN,580143
ALPRAZOLAM,576331
POTASSIUM CHLORIDE,565691
ZOSTAVAX,563827
WARFARIN SODIUM,553508
MELOXICAM,544731
PROAIR HFA,541022
CEPHALEXIN,536946
DONEPEZIL HCL,531151
ATENOLOL,519653
PANTOPRAZOLE SODIUM,470043
METHYLPREDNISOLONE,417082
SULFAMETHOXAZOLE-TRIMETHOPRIM,416766
ALENDRONATE SODIUM,400019
LATANOPROST,381354
LORAZEPAM,357478
TRIAMCINOLONE ACETONIDE,335573
AMOX TR-POTASSIUM CLAVULANATE,332445
CRESTOR,328058
ZOLPIDEM TARTRATE,318470
ALLOPURINOL,304775
SYNTHROID,302041
RANITIDINE HCL,294698
TRAZODONE HCL,294326
IBUPROFEN,291068
SERTRALINE HCL,285379
CITALOPRAM HBR,283001
LISINOPRIL-HYDROCHLOROTHIAZIDE,257756
FINASTERIDE,256705
LOSARTAN-HYDROCHLOROTHIAZIDE,248584
MONTELUKAST SODIUM,248168
LOVASTATIN,239732
NAMENDA,236966
OXYCODONE HCL,228901
ISOSORBIDE MONONITRATE ER,205739
CLONAZEPAM,200567
NITROSTAT,200421
CLOBETASOL PROPIONATE,200204
TRIAMTERENE-HYDROCHLOROTHIAZID,194245
DOXYCYCLINE HYCLATE,193843
METHOTREXATE,192703
OFLOXACIN,190494
SPIRIVA,186442
GLIMEPIRIDE,185744
NEXIUM,184226
ADVAIR DISKUS,183170
MUPIROCIN,177691
ESCITALOPRAM OXALATE,176776
POLYETHYLENE GLYCOL 3350,176727
MIRTAZAPINE,176533
KETOROLAC TROMETHAMINE,163903
Query:
-- 15. Calculate average day supply per prescription for each drug
SELECT drug_name, SUM(total_day_supply)/SUM(total_claim_count) AS avg_day_supply
FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
GROUP BY drug_name
ORDER BY avg_day_supply DESC
LIMIT 100;
Answer:
drug_name,avg_day_supply
RECLAST,139.71604938271605
PROLIA,92.50020453243884
MYOBLOC,89.5
ESTRING,84.74696713615023
FEMRING,82.59065934065934
TOPROL XL,81.32471221227699
ELIPHOS,81.1906432748538
ROCALTROL,80.72394781798415
K-TAB ER,80.08234581530076
TRICOR,71.65191792001866
XEOMIN,69.23529411764706
QUASENSE,68.2394366197183
TRELSTAR,66.64630225080386
STELARA,60.50486548368632
MIMVEY LO,60.30769230769231
BOTOX,59.25662304500479
MEFLOQUINE HCL,57.827188940092164
TERAZOSIN HCL,57.37068429544774
LOVASTATIN,56.958063954770346
LISINOPRIL-HYDROCHLOROTHIAZIDE,56.84701131952666
ATENOLOL,56.810568431932175
TRIAMTERENE-HYDROCHLOROTHIAZID,56.543610363113764
ELIGARD,56.27415143603133
NOVOTWIST,55.31561181434599
RENO CAPS,55.22464312546957
SYNTHROID,55.20035260161463
CLIMARA,55.14840782938943
IN CONTROL PEN NEEDLE,55.12542433446489
SIMVASTATIN,54.95760648423982
LEVOXYL,54.9402819505431
HYDROCHLOROTHIAZIDE,54.55526609089806
FINASTERIDE,54.34736765526328
HEALTHY ACCENTS UNIFINE PENTIP,53.74354407836153
RAMIPRIL,53.73677074410925
PRAVASTATIN SODIUM,53.69261444441054
O-CAL PRENATAL,53.57142857142857
LOSARTAN-HYDROCHLOROTHIAZIDE,53.52488102657792
QUINAPRIL HCL,53.4457663459804
METFORMIN HCL ER,52.968711621917755
AVANDAMET,52.857142857142854
ATORVASTATIN CALCIUM,52.771981928738505
LOSARTAN POTASSIUM,52.63988766839237
CARTIA XT,52.463269179181864
DILT-XR,52.32506445991911
BENAZEPRIL HCL,52.18469057391348
BISOPROLOL-HYDROCHLOROTHIAZIDE,52.00131659352258
LISINOPRIL,51.96040595255807
ALLOPURINOL,51.82094620346543
TESTOSTERONE CYPIONATE,51.8017615667582
UNITHROID,51.29596933441747
DEPO-ESTRADIOL,51.12978986402967
ALFUZOSIN HCL ER,51.01085266709273
BD ULTRA-FINE PEN NEEDLE,50.678014861051594
ESTRADIOL,50.64161965517637
ANASTROZOLE,50.44128734977312
ATENOLOL-CHLORTHALIDONE,50.3754680112461
LEVOTHYROXINE SODIUM,50.11843478049787
TOLAZAMIDE,50.05210084033614
METFORMIN HCL,49.93054885929921
VERAPAMIL ER,49.86303113744174
GLIMEPIRIDE,49.72909492303619
AMLODIPINE BESYLATE,49.728438062793366
METOPROLOL SUCCINATE,49.71783047268099
DOXAZOSIN MESYLATE,49.71373339931497
INDAPAMIDE,49.64534107148065
GLIPIZIDE,49.52288291006668
TAMOXIFEN CITRATE,49.44167689331697
AVANDIA,49.29931972789116
CHLORTHALIDONE,49.25073418164009
IRBESARTAN,49.23917516565443
VALSARTAN-HYDROCHLOROTHIAZIDE,49.18995022155291
LEVOBUNOLOL HCL,49.05213152758652
LUPRON DEPOT,48.73303813740894
AMLODIPINE BESYLATE-BENAZEPRIL,48.67264343211363
BENAZEPRIL-HYDROCHLOROTHIAZIDE,48.64112536461437
End Exploring Related Columns
Task: What is the most prescribed medication in each state in 2014?

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
State,Drug_Name
state_code1:str,drug_name1:str
state_code2:str,drug_name2:str
...
```

This table lists the most prescribed medication in each state in 2014, showing the state code and the corresponding drug name..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'cms_codes': ['hcpcs', 'icd10_diagnoses_2019', 'icd10_procedures_2019', 'icd9_diagnoses', 'icd9_procedures'], 'cms_medicare': ['home_health_agencies_2013', 'home_health_agencies_2014', 'hospice_providers_2014', 'hospital_general_info', 'inpatient_charges_2011', 'inpatient_charges_2012', 'inpatient_charges_2013', 'inpatient_charges_2014', 'inpatient_charges_2015', 'nursing_facilities_2013', 'nursing_facilities_2014', 'outpatient_charges_2011', 'outpatient_charges_2012', 'outpatient_charges_2013', 'outpatient_charges_2014', 'outpatient_charges_2015', 'part_d_prescriber_2014', 'physicians_and_other_supplier_2012', 'physicians_and_other_supplier_2013', 'physicians_and_other_supplier_2014', 'physicians_and_other_supplier_2015', 'referring_durable_medical_equip_2013', 'referring_durable_medical_equip_2014'], 'cms_synthetic_patient_data_omop': ['care_site', 'concept', 'concept_ancestor', 'concept_class', 'concept_relationship', 'condition_era', 'condition_occurrence', 'cost', 'death', 'device_exposure', 'domain', 'dose_era', 'drug_era', 'drug_exposure', 'drug_strength', 'location', 'observation', 'observation_period', 'payer_plan_period', 'person', 'procedure_occurrence', 'provider', 'relationship', 'vocabulary']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-28 06:03:27 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-28 06:03:27 - root - INFO - ```sql
SELECT
  state_drug.nppes_provider_state AS State,
  state_drug.drug_name AS Drug_Name
FROM (
  SELECT
    nppes_provider_state,
    drug_name,
    SUM(total_claim_count) AS total_claims,
    ROW_NUMBER() OVER (
      PARTITION BY nppes_provider_state 
      ORDER BY SUM(total_claim_count) DESC
    ) AS rn
  FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
  GROUP BY nppes_provider_state, drug_name
) AS state_drug
WHERE state_drug.rn = 1
ORDER BY state_drug.State;
```
2025-01-28 06:03:28 - root - INFO - itercount: 1
2025-01-28 06:03:28 - root - INFO - 400 Name State not found inside state_drug at [17:21]; reason: invalidQuery, location: query, message: Name State not found inside state_drug at [17:21]

Location: US
Job ID: 6ced5d64-2d91-46fb-8f12-8b0a5491f5b7

2025-01-28 06:03:28 - root - INFO - Input sql:
SELECT
  state_drug.nppes_provider_state AS State,
  state_drug.drug_name AS Drug_Name
FROM (
  SELECT
    nppes_provider_state,
    drug_name,
    SUM(total_claim_count) AS total_claims,
    ROW_NUMBER() OVER (
      PARTITION BY nppes_provider_state 
      ORDER BY SUM(total_claim_count) DESC
    ) AS rn
  FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
  GROUP BY nppes_provider_state, drug_name
) AS state_drug
WHERE state_drug.rn = 1
ORDER BY state_drug.State;
The error information is:
400 Name State not found inside state_drug at [17:21]; reason: invalidQuery, location: query, message: Name State not found inside state_drug at [17:21]

Location: US
Job ID: 6ced5d64-2d91-46fb-8f12-8b0a5491f5b7

Please correct it and output only 1 complete SQL query.
2025-01-28 06:03:50 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-28 06:03:50 - root - INFO - ```sql
SELECT
  state_drug.nppes_provider_state AS State,
  state_drug.drug_name AS Drug_Name
FROM (
  SELECT
    nppes_provider_state,
    drug_name,
    SUM(total_claim_count) AS total_claims,
    ROW_NUMBER() OVER (
      PARTITION BY nppes_provider_state 
      ORDER BY SUM(total_claim_count) DESC
    ) AS rn
  FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
  GROUP BY nppes_provider_state, drug_name
) AS state_drug
WHERE state_drug.rn = 1
ORDER BY State;
```
2025-01-28 06:03:52 - root - INFO - itercount: 2
2025-01-28 06:03:52 - root - INFO - 0
2025-01-28 06:03:52 - root - INFO - results: 
State,Drug_Name
AA,AMOXICILLIN
AE,HYDROCODONE-ACETAMINOPHEN
AK,LISINOPRIL
AL,HYDROCODONE-ACETAMINOPHEN
AP,HYDROCODONE-ACETAMINOPHEN
AR,HYDROCODONE-ACETAMINOPHEN
AS,LISINOPRIL
AZ,LISINOPRIL
CA,HYDROCODONE-ACETAMINOPHEN
CO,LEVOTHYROXINE SODIUM
CT,ATORVASTATIN CALCIUM
DC,AMLODIPINE BESYLATE
DE,ATORVASTATIN CALCIUM
FL,LISINOPRIL
GA,AMLODIPINE BESYLATE
GU,AMLODIPINE BESYLATE
HI,ATORVASTATIN CALCIUM
IA,LEVOTHYROXINE SODIUM
ID,HYDROCODONE-ACETAMINOPHEN
IL,LISINOPRIL
IN,HYDROCODONE-ACETAMINOPHEN
KS,LEVOTHYROXINE SODIUM
KY,HYDROCODONE-ACETAMINOPHEN
LA,HYDROCODONE-ACETAMINOPHEN
MA,LISINOPRIL
MD,LISINOPRIL
ME,LISINOPRIL
MI,HYDROCODONE-ACETAMINOPHEN
MN,LISINOPRIL
MO,LISINOPRIL
MP,AMLODIPINE BESYLATE
MS,HYDROCODONE-ACETAMINOPHEN
MT,LEVOTHYROXINE SODIUM
NC,AMLODIPINE BESYLATE
ND,LEVOTHYROXINE SODIUM
NE,LEVOTHYROXINE SODIUM
NH,LISINOPRIL
NJ,ATORVASTATIN CALCIUM
NM,LEVOTHYROXINE SODIUM
NV,HYDROCODONE-ACETAMINOPHEN
NY,AMLODIPINE BESYLATE
OH,LISINOPRIL
OK,HYDROCODONE-ACETAMINOPHEN
OR,LISINOPRIL
PA,LISINOPRIL
PR,SIMVASTATIN
RI,LISINOPRIL
SC,HYDROCODONE-ACETAMINOPHEN
SD,LEVOTHYROXINE SODIUM
TN,HYDROCODONE-ACETAMINOPHEN
TX,HYDROCODONE-ACETAMINOPHEN
UT,LEVOTHYROXINE SODIUM
VA,LISINOPRIL
VI,AMLODIPINE BESYLATE
VT,LISINOPRIL
WA,LISINOPRIL
WI,LISINOPRIL
WV,HYDROCODONE-ACETAMINOPHEN
WY,LEVOTHYROXINE SODIUM
XX,SIMVASTATIN
ZZ,HYDROCODONE-ACETAMINOPHEN


2025-01-28 06:03:52 - root - INFO - Please check the answer again by reviewing What is the most prescribed medication in each state in 2014?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
State,Drug_Name
state_code1:str,drug_name1:str
state_code2:str,drug_name2:str
...
```

This table lists the most prescribed medication in each state in 2014, showing the state code and the corresponding drug name. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
State,Drug_Name
AA,AMOXICILLIN
AE,HYDROCODONE-ACETAMINOPHEN
AK,LISINOPRIL
AL,HYDROCODONE-ACETAMINOPHEN
AP,HYDROCODONE-ACETAMINOPHEN
AR,HYDROCODONE-ACETAMINOPHEN
AS,LISINOPRIL
AZ,LISINOPRIL
CA,HYDROCODONE-ACETAMINOPHEN
CO,LEVOTHYROXINE SODIUM
CT,ATORVASTATIN CALCIUM
DC,AMLODIPINE BESYLATE
DE,ATORVASTATIN CALCIUM
FL,LISINOPRIL
GA,AMLODIPINE BESYLATE
GU,AMLODIPINE BESYLATE
HI,ATORVASTATIN CALCIUM
IA,LEVOTHYROXINE SODIUM
ID,HYDROCODONE-ACETAMINOPHEN
IL,LISINOPRIL
IN,HYDROCODONE-ACETAMINOPHEN
KS,LEVOTHYROXINE SODIUM
KY,HYDROCODONE-ACETAMINOPHEN
LA,HYDROCODONE-ACETAMINOPHEN
MA,LISINOPRIL
MD,LISINOPRIL
ME,LISINOPRIL
MI,HYDROCODONE-ACETAMINOPHEN
MN,LISINOPRIL
MO,LISINOPRIL
MP,AMLODIPINE BESYLATE
MS,HYDROCODONE-ACETAMINOPHEN
MT,LEVOTHYROXINE SODIUM
NC,AMLODIPINE BESYLATE
ND,LEVOTHYROXINE SODIUM
NE,LEVOTHYROXINE SODIUM
NH,LISINOPRIL
NJ,ATORVASTATIN CALCIUM
NM,LEVOTHYROXINE SODIUM
NV,HYDROCODONE-ACETAMINOPHEN
NY,AMLODIPINE BESYLATE
OH,LISINOPRIL
OK,HYDROCODONE-ACETAMINOPHEN
OR,LISINOPRIL
PA,LISINOPRIL
PR,SIMVASTATIN
RI,LISINOPRIL
SC,HYDROCODONE-ACETAMINOPHEN
SD,LEVOTHYROXINE SODIUM
TN,HYDROCODONE-ACETAMINOPHEN
TX,HYDROCODONE-ACETAMINOPHEN
UT,LEVOTHYROXINE SODIUM
VA,LISINOPRIL
VI,AMLODIPINE BESYLATE
VT,LISINOPRIL
WA,LISINOPRIL
WI,LISINOPRIL
WV,HYDROCODONE-ACETAMINOPHEN
WY,LEVOTHYROXINE SODIUM
XX,SIMVASTATIN
ZZ,HYDROCODONE-ACETAMINOPHEN
Current sql:
SELECT
  state_drug.nppes_provider_state AS State,
  state_drug.drug_name AS Drug_Name
FROM (
  SELECT
    nppes_provider_state,
    drug_name,
    SUM(total_claim_count) AS total_claims,
    ROW_NUMBER() OVER (
      PARTITION BY nppes_provider_state 
      ORDER BY SUM(total_claim_count) DESC
    ) AS rn
  FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
  GROUP BY nppes_provider_state, drug_name
) AS state_drug
WHERE state_drug.rn = 1
ORDER BY State;
2025-01-28 06:04:19 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-28 06:04:19 - root - INFO - ```sql
SELECT
  nppes_provider_state AS State,
  drug_name AS Drug_Name
FROM (
  SELECT
    nppes_provider_state,
    drug_name,
    SUM(total_claim_count) AS total_claims,
    ROW_NUMBER() OVER (
      PARTITION BY nppes_provider_state 
      ORDER BY SUM(total_claim_count) DESC
    ) AS rn
  FROM `bigquery-public-data.cms_medicare.part_d_prescriber_2014`
  GROUP BY nppes_provider_state, drug_name
) AS state_drug
WHERE rn = 1
ORDER BY State;
```
2025-01-28 06:04:22 - root - INFO - itercount: 3
2025-01-28 06:04:22 - root - INFO - 0
2025-01-28 06:04:22 - root - INFO - Total iteration counts: 3
