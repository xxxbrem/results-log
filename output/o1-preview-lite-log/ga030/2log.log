2025-01-27 04:42:59 - openai._base_client - INFO - Retrying request to /chat/completions in 0.379322 seconds
2025-01-27 04:44:03 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 04:44:07 - root - INFO - SQL:
SELECT DISTINCT user_pseudo_id
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
   LIMIT 100
Results:
user_pseudo_id
AAECE8DA46F021A9CFE489ADF95DA078
657E8EB68545E75A6EAD9B6A11C2E773
6FC11768E2D8132D0EBD54B823E26DC4
981CA03B25810447E879E7E767499ABD
8AB276B80B01A635BA7EF9C2071C0231
760224DD438185D3F00938581C387090
3883FF0DFAB40ECD4EA781FC0D1CE18A
E10A839237C8E024635BB36936FF4D81
9BFA45225ECA7CD4D2A9F956B875CF85
EEA7994C33475920620AC49055AA96D8
879503A3ED5F2DCB6592E99C42E1BDFE
8165B8A88DB3120D9C73A19779230F2A
ABF34B528D18C455F276DDD3025A100B
0E0C0F08123CB27BA63037F04FDE9248
5B333FE2BC3875C6C3882279B51B8BAF
1C107111F6722BA305BF26036F830F28
FD807541F1DE049B5D16ED3EE2DCF160
DC400E1B157258545CB288C8CA9265AF
C2FC4E7982D01DC11CB23FD5077F51DA
AD540E549BA77A71A7459EEAF2F8D3BC
A1A9A8FC9138E7F9B568176AA7091F2D
E14F414A25D7DB47E661B85439950D29
CCC7BB053BBC6824C53FAA4A8C63E3FE
63550F65F0818B874ADA2B18C463AB21
73F4404458C858BFF846E7235C7E8A74
6551148F681F9DF807FF3624EA5DEFA8
F76196A143B56B420C9EC1FE89220998
E16960AF0F3701961C14898971B1997B
E8950841C7635FFAE97EE03DE2A92072
47641CFD956212B88DE89050A1218D3E
B1C11C1880C459CAF44FC8622DEB4716
F73A0D4A6FB35C664DDAE0F4F145F8B0
860B943B030C0B95CC6BB1F8BA68D20A
DC8F11F217104C5DD43E99C36899D17A
D5255DA563F26103F81E0A9701324260
53649082C25AB9A9CD1E394EBBA9CEF3
52BB50019C8ECCF51DEF524F2C6CD35D
F4810B35D08410542741137BD5FD3326
7C7FEF6E6A5AB4D4BE8170B7E5CAF626
9B18A1CBA96D52D05CFA7CB7C9011EDE
7DBEEB7A2488FE1FFC0808686AC09606
17636078D57884AD7EA5406C60E2BD10
39BE7CAB9B8602ABD10A1BFB4E66BBB2
1B959D672ABAE4A3BFB9D720D415E064
4EEE67C2E335213F6815144829801E0F
01A2CCF65B4BB5DF87B1F9177616C5AF
5ACD59093D1C49F2EADAE29D7181A9CF
551B893D34A2A59971B8FF185C1CD0C8
7AB9D5F7D122A38CA8769C9C93F3A12F
3B049329E3090DA7A4339C4A46EF0763
869CD665A9D52E3398754C8DACF4426D
9E25C5FED0F3F775FBB2A5C76DD0511C
67D3D76504CC5C4CBFC78EE4FC397C8B
1845E883F5E20391CD3BD68F488A3C5E
ED5C290C8F82C28C033482D31299D8CD
C09F65F2853D03DE23CFD90F97429735
2B9E05C9A73CE9EFCADC80CE582ADBA6
D8F0003FCBEE71C9DDA3B5E7F71E2E87
71C2AA64A2F04946EBB47151B2BDA812
C07B7139F9F13057205EF87542A49929
03E05B9F728257B2F739CF0BB4497166
C5788CC4CA50494F16D5CE2F5B913078
9A8FEE70B6945DC1B1051F82E8E13DF0
08B96C79C44B80296CF29656C039947D
D3C726DD4D2E03D4589DFAAE5BB5BB9D
21E8180ED9407AC6381243A802EE8F61
5FC527F78605EE99044FB10929B1A547
CD3D8A3BFE9DDD830834C98597561029
AFEAE67E8EED1A3F43A669B7EFCBA05A
EB18B2001B1A2D61AC02C803D66689A7
BB90E3EF80325C68D00E6BCEEBDCAA79
735D0773BF0193D26BA48A56D1C69CAB
4CC453DA57531954D7C053B93A20B5D0
F0A67B4154F4275B32243228EC61BD74
D9563E61AC76501942B6B3B4EBA2BFE4
DE83C52DBCD401E9FCEE79F25A63B3E7
27951B102A564E3FF875726564A141FF
1D0216460C4C83D8D41342268C6534D0
DE622694FDC3B9F57F917F659111E9A4
DBB995BF3A253CE1A68AF3B0B43C216D
35D7E0527C5BC0E5044EF3716C845E08
47A8CC215AA66ED9190E8E11879B8502
3C871B56B2654F95B13DB5388E58DDF9
0043CF8841C819015ACD25710D333113
15580E78B3CF93AA028B5376350129FD
88E6D3D4433BA2B424A6D5D23A871B97
E6801E3BAF7C8123841AFD7969FBD7AC
8B58F1ED945C2F35BD09EE96B688E460
674EAE8D70D203FEDBE60DEAE2F834CC
8FBA68B371BCD408B4E1CCD4A3ABE3D1
44DE25D7B9A474632A68C3533417A1CD
83BD247F986B80A1459E119D2891452E
F1B841B645E96249BDFD59DB76865211

2025-01-27 04:44:12 - root - INFO - SQL:
SELECT user_pseudo_id, user_first_touch_timestamp
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
   LIMIT 100
Results:
user_pseudo_id,user_first_touch_timestamp
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000

2025-01-27 04:44:18 - root - INFO - SQL:
SELECT DISTINCT event_date
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE PARSE_DATE('%Y%m%d', event_date) >= DATE('2018-07-02')
   ORDER BY event_date
   LIMIT 100
Results:
event_date
20180702
20180703
20180704
20180705
20180706
20180707
20180708
20180709
20180710
20180711
20180712
20180713
20180714
20180715
20180716
20180717
20180718
20180719
20180720
20180721
20180722
20180723
20180724
20180725
20180726
20180727
20180728
20180729
20180730
20180731
20180801
20180802
20180803
20180804
20180805
20180806
20180807
20180808
20180809
20180810
20180811
20180812
20180813
20180814
20180815
20180816
20180817
20180818
20180819
20180820
20180821
20180822
20180823
20180824
20180825
20180826
20180827
20180828
20180829
20180830
20180831
20180901
20180902
20180903
20180904
20180905
20180906
20180907
20180908
20180909
20180910
20180911
20180912
20180913
20180914
20180915
20180916
20180917
20180918
20180919
20180920
20180921
20180922
20180923
20180924
20180925
20180926
20180927
20180928
20180929
20180930
20181001
20181002
20181003

2025-01-27 04:44:23 - root - INFO - SQL:
SELECT
     user_pseudo_id,
     DATE_TRUNC(DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), WEEK(MONDAY)) AS first_week
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
   LIMIT 100
Results:
user_pseudo_id,first_week
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09

2025-01-27 04:44:28 - root - INFO - SQL:
SELECT
     DATE_TRUNC(DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), WEEK(MONDAY)) AS week_start,
     COUNT(DISTINCT user_pseudo_id) AS new_users
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
   GROUP BY week_start
   ORDER BY week_start
   LIMIT 100
Results:
week_start,new_users
2018-07-02,297
2018-07-09,300
2018-07-16,313
2018-07-23,305
2018-07-30,463
2018-08-06,388
2018-08-13,296
2018-08-20,319
2018-08-27,369
2018-09-03,461
2018-09-10,422
2018-09-17,306
2018-09-24,348
2018-10-01,186

2025-01-27 04:44:34 - root - INFO - SQL:
SELECT
     user_pseudo_id,
     event_timestamp,
     event_name
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
     AND event_timestamp >= user_first_touch_timestamp
     AND event_timestamp < user_first_touch_timestamp + 4 * 7 * 24 * 60 * 60 * 1000000
   LIMIT 100
Results:
user_pseudo_id,event_timestamp,event_name
546FA52DF4E990E49843A096C09AF917,1537076339359000,first_open
83D42C0BEC5C0325916E5797073CEE9A,1537051267227000,first_open
30BDB608211EE7B2E8488B00E246B7FC,1537005246537000,first_open
20F3CD6918AF3773CBA104980250555D,1537040757487005,app_update
20F3CD6918AF3773CBA104980250555D,1537040769430000,first_open
14B3164775DC217E7AC2C1BD7D250D96,1537043473906000,first_open
50B507B8C1BD14FA0BC9BE6991513DFE,1537031154410000,first_open
4657D96DA15E782F8E82EBA5A791BB66,1537003648146000,first_open
64E3BBB507EEFDE76364031EADF502F4,1537047872198000,first_open
289D738E3B01C988983B957444571412,1537057883894000,first_open
59C952AB04D797753C92608F0B32BD42,1537039355296000,first_open
8C2CA6A4B27594E8E363819DC8A8F4D0,1537050812506003,app_update
8C2CA6A4B27594E8E363819DC8A8F4D0,1537050751507004,os_update
260F744C558B490AA7A98F05BB3E9E05,1537061448359000,first_open
80AF6278725C25498814E11905BEF017,1537032995920000,first_open
4389B7F79E867573E4577EF7E73F553B,1537077753138000,first_open
37D5BFCBAB879776946C3A2A71476D2F,1537018737041000,first_open
3AC32595330166DD108922E4629617EE,1537068765508000,first_open
1C29FBDB9C4CC0CF27B819B487A91CB2,1537022362749000,first_open
1EE74A9149F4AA2CC1E6DABD18BEFD3C,1537020758462000,first_open
575CDA26268871E43230F53F87804994,1537018044113000,first_open
78A7C7D9BC2138200C3B37E3C7CA8CE8,1537067741424002,app_exception
76B80AC19A11BEB87D87ED5D1A8642BA,1537013441404000,first_open
313AE0F9B2F9E0927B8B74CF1D99720C,1537038441589000,first_open
9487188F3FC65328E1EA611CCA802AA6,1536995780777000,first_open
433E34F1BFEEF8A34A78D2C73D3AA014,1537067846686000,first_open
949DC369B1AB32FCB10B9D6E4B367DE7,1537066659421000,first_open
098DB0065C9C20492CB3DA17508D4A25,1537075301232000,first_open
620E8B1B1DF8E97AE28C91153E52F543,1537053142420000,first_open
7FAD5B22FFD8C9FCF710E2FE86F5EE82,1537043707699000,first_open
71FABF98DF13052391676F3DE84BD628,1537031597919000,first_open
050231DF01854EFA691E0D5F4DB9ADB2,1537033595781009,level_retry_quickplay
050231DF01854EFA691E0D5F4DB9ADB2,1537033621484023,level_retry_quickplay
05B5E4EA8ABA0B2A4020DE6309DC183A,1537068236196242,level_retry_quickplay
05B5E4EA8ABA0B2A4020DE6309DC183A,1537068295003262,level_retry_quickplay
05B5E4EA8ABA0B2A4020DE6309DC183A,1537068514962014,level_retry_quickplay
05B5E4EA8ABA0B2A4020DE6309DC183A,1537068542584045,level_retry_quickplay
05B5E4EA8ABA0B2A4020DE6309DC183A,1537068586559063,level_retry_quickplay
05B5E4EA8ABA0B2A4020DE6309DC183A,1537068698203087,level_retry_quickplay
05B5E4EA8ABA0B2A4020DE6309DC183A,1537068781611107,level_retry_quickplay
05B5E4EA8ABA0B2A4020DE6309DC183A,1537068868077154,level_retry_quickplay
05B5E4EA8ABA0B2A4020DE6309DC183A,1537069288267280,level_retry_quickplay

2025-01-27 04:44:40 - root - INFO - SQL:
SELECT user_pseudo_id
   FROM (
     SELECT
       user_pseudo_id,
       COUNT(DISTINCT DATE_TRUNC(DATE(TIMESTAMP_MICROS(event_timestamp)), WEEK(MONDAY))) AS active_weeks
     FROM `firebase-public-project.analytics_153293282.events_*`
     WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
     GROUP BY user_pseudo_id
   )
   WHERE active_weeks >= 5
   LIMIT 100
Results:
user_pseudo_id
023A2DB99CC3F70A4B71869C36952D74
E19F04BAB15FBA761833F71BCF5D97D3
8601A3659DC5C1F0444E5CCDA5ED3E14
5F72C8757B169882D52BFBC7CDE1B9EC
9FE14774A6A768A1C1BEBCE0DE0669A5
54EEE6C24B723126E17219F5C0F6DE12
C74B58C4CD2770A1E97D6DC13D42CCAC
73980AF5B8954128337EB065CE75C773
5249B4686BC5038FBFE36A3E6CCA5B72
8A1F255061DE6AFBDE0F9FE5226DCACA
9BC94B3773C8304A9E101AEBCFEF4A5F
663EAD1943AE7594E0633D10ADB5EF52
7E74A2BB6BBF4746DEE15F957B315401
17636078D57884AD7EA5406C60E2BD10
3883FF0DFAB40ECD4EA781FC0D1CE18A
19A52401D23AE9E42A176C6ED9AA5F08
635808C1DDFBC662DC3015097E26E62A
359A34F575B808FEFE58BC5B40816F09
F454E0D882BF2C7E1E0DF7F96DF78F3B
53C62BFF7D715334B8C3C4904EC34880
295D9E24D8DE65A010313E667131EF19
FB581F2AC74E08CD38CCAAA9A99F0217
A1FA05C0618ED3CB04CDB44FBE35DDB6
3A4F5028A0CA512C0E2CCA1F36CE160D
21D29079D74D0CA82E5850EB9C86F820
F8C81154E72430B1122E7C28B8ED30C5
A1927ED722EA16A3B82E7EE0FA22FF4F
D32344BA5A0153E336B5F73ED2979785
B529E84EE03C578C7E92CE5836AB1C1D
85B9BAA3105AD395E7D84C61108F0D7E
AC14799A5E8C340D6CADCBAE72037D81
A421EBCE8AA69A980AAFC4F141BDEFFB
7DBEEB7A2488FE1FFC0808686AC09606
497308A94C26945E008226F51C49C706
C96C96A3BFA142C6B393183BDB2B9DDB
CC4B09FF7E5171AF18408F2F0903D225
0D6A346C85BF606BE12F9A70FC20A7B7
EF7772819E807EDBD8DB0F0B5210030E
89427602D4335C85A7205E64B3347655
34587F7996F20BE4CC7DDEB96753D110
6B7F85DBAABE78A99689D49CAE22072E
96D260425F451E90979EA7417C72A09B
184B6DE721CD75D84BB9975E19003195
08B7AEC83DA53E917D595FE60C2CB600
5E9B9E20975EF45745B511D401456619
370CDFEE49990E4A9A1FBC0DC5C31C1C
45FB547C5857493104687C234EDCDE37
50D529BFD3EFEB1C8216DF9A321A552A
F3C82C9DB04064BA7965BBBD95864189
6870FFBF31EA0EC710FF2A8A867B99DF
2CEF0B3F63A7FD536BD7A1D7EBDAA82A
5B333FE2BC3875C6C3882279B51B8BAF
4E6F4A73B5D05B33DC73B11547E39004
735123CE7AF980AD5B43F31CAF2890A0
51350F5497804E91C6311DC404F392DA
F5399EDCBD933CB1A80F4975D796F98B
57EC50FBC6C7277B8EDCCE44C1352BD4
A976A39B8E08829A5BC5CD3827C942A2
BD2A511409EB3EBC45D4CEB4F876ED49
FB038B1647754ED4E3E7CFEABFC553A4
D35CA7CBB149B94C34D98A2D304D9AE7
C3817B35D57C5C1BF6225FEC9BD16534
75C0C246DE2188E02D984C2E71B7B4C0
E80C958E3C33898989A30B8F5A4514F0
1D89281562AC3FEFB76A42ED406BF1B5
97760F8A4E9C0DA4B02684343A2BB046
22DF34962481295121082D8C105EB436
FE3331C93B8A54B8C9145532FFAD704A
0AFE3DE6A443BD660CDD5B1FA36686F6
DFC2120907EE81E1836E3A9E257498C9
B05B44F98AC43EA887A1B78C3552A927
FFD44153572065E379B7E96916F730B8
A6A77DA8F2C4102A83EED1D5216EB318
88E99CE30B65345ED0B118869B6AD035
187EB7E773756A1EC9E48BA1EFBDBB5F
DC3385FCDBAC11484BBCCC308336B549
33EA483B9652B49782CDB92710831EE4
5ACF1A6BFE350F7BB661BF389AF7E2F0
70E5A3222508AD3D70A72B60E4045DC5
B99FD965B0874192EE94E8A8FE85EA9E
4BB019F8F6D1FE7BA78CA42A4698EF56
8E1749E5A26DD54E346476A289854E93
0B74484DD41F519B4810A14A953CAA18
FFA9AE78B23263835F8AAED57713EBE9
08F14F3BCA030F81B447161BA8653B44
2C84CF723999D48F8F069AFFC184C4DC
8F41FC08B49819D339D864572A1CA136
879503A3ED5F2DCB6592E99C42E1BDFE
65D1701E5BA0070CCF15F0CB0E1CF750
7D05DF6F0141D016FD20F7B8E71FAB0A
0DF6A14F536F6514A6F18BC12A532A82
5C17C05950C71938CFA82EA7C517748B
1E6348F7A97962E7EAA87C7FF638569F

2025-01-27 04:44:45 - root - INFO - SQL:
SELECT
     DATE_TRUNC(DATE(TIMESTAMP_MICROS(event_timestamp)), WEEK(MONDAY)) AS week_start,
     COUNT(DISTINCT user_pseudo_id) AS active_users
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE event_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
   GROUP BY week_start
   ORDER BY week_start
   LIMIT 100
Results:
week_start,active_users
2018-07-02,1972
2018-07-09,1593
2018-07-16,1554
2018-07-23,1669
2018-07-30,1923
2018-08-06,1754
2018-08-13,1711
2018-08-20,1703
2018-08-27,1831
2018-09-03,2189
2018-09-10,2311
2018-09-17,2052
2018-09-24,2339
2018-10-01,1116

2025-01-27 04:44:51 - root - INFO - SQL:
SELECT
     user_pseudo_id,
     DATE_TRUNC(DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), WEEK(MONDAY)) AS first_week,
     COUNT(DISTINCT DATE_TRUNC(DATE(TIMESTAMP_MICROS(event_timestamp)), WEEK(MONDAY))) AS active_weeks
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
   GROUP BY user_pseudo_id, first_week
   LIMIT 100
Results:
user_pseudo_id,first_week,active_weeks
DDAE59D1F0DCF18D15A1BA723158614C,2018-07-02,1
FFA9AE78B23263835F8AAED57713EBE9,2018-07-02,7
6933934F877244F44E681554B2BE6CED,2018-07-02,1
B8FE9AD137A133A89389656F7989B36C,2018-08-13,7
C679FF00E17790E7E16AB903212EE05C,2018-08-06,7
8165B8A88DB3120D9C73A19779230F2A,2018-09-24,2
6AC48FB5508B3CFCB38A4D32784D34BD,2018-10-01,1
3B558122ACA8D8F2714179F087EBA08E,2018-08-13,4
FBCC7798842863D95C6EAEB39E7E14CE,2018-10-01,1
026C3DFB9F540CE1656F08BE848279A9,2018-10-01,1
3F3697585E038DF733B054B59AED604C,2018-10-01,1
0554FA7236F2A6E3A86F54C72EDE441D,2018-09-24,2
8252847DECB3C31CAB9BDEE566F97BA2,2018-07-09,12
814DC12FDC4A62A4A0CDCF837F04CB17,2018-10-01,1
6353DEF647A531EEB7F7B124187672CE,2018-10-01,1
BA663527D98C1805D6969605889DB705,2018-09-24,2
25D0E6C77B170FE82258520015446DF4,2018-07-16,9
B529E84EE03C578C7E92CE5836AB1C1D,2018-08-13,8
7ED4165854463C38F1D739A2014001D9,2018-07-02,3
8A4D3DB968275EB10F8B9920C8302916,2018-07-02,1
67820F8EAA8087726BD8BD7AB488FA8F,2018-07-02,1
6B7F85DBAABE78A99689D49CAE22072E,2018-07-02,7
1918604BFCCA6992E962C7BE9B7737C8,2018-07-02,1
663EAD1943AE7594E0633D10ADB5EF52,2018-07-16,7
BFE99B51F316372640BDD14B9625C0F2,2018-08-06,3
AC14799A5E8C340D6CADCBAE72037D81,2018-07-30,5
0B74484DD41F519B4810A14A953CAA18,2018-07-23,5
635808C1DDFBC662DC3015097E26E62A,2018-07-23,7
CFD21DF2629D9493B5FB0A0971370481,2018-08-13,2
03B685883D78D1DB9F67A86635F9D788,2018-08-06,4
98DAE39C81EE21654D2AB4D4DE822B03,2018-08-13,1
D7C4BD696A49356175EE064AC6195452,2018-08-13,2
7BA1098EE744CDED1FA599098513BF43,2018-08-13,1
7BF597A11650FE351760281648C7A3F8,2018-07-23,6
9B3B7AB4B77B74807ED37CD63DE0624E,2018-08-13,2
97760F8A4E9C0DA4B02684343A2BB046,2018-07-23,6
D1A34C0FAE2F326F2C050020A3B990C5,2018-08-06,2
5650DAE90041347FBDF416121636345F,2018-08-13,1
9CD5898126E744A7614D790C2C67B052,2018-08-13,1
E7457A03561570A97A4646A1CDFEDBC8,2018-08-13,2
D864D058813F31B452BCE6743B0AF7F7,2018-08-13,1
35CF08DA631AC27582D6A0FE710131F7,2018-07-30,3
38D65030548914B5E167CE85B035CA8F,2018-07-30,4
E19F04BAB15FBA761833F71BCF5D97D3,2018-07-16,7

2025-01-27 04:44:57 - root - INFO - SQL:
SELECT
      first_week,
      COUNT(DISTINCT user_pseudo_id) AS retained_users
    FROM (
      SELECT
        user_pseudo_id,
        DATE_TRUNC(DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), WEEK(MONDAY)) AS first_week,
        COUNT(DISTINCT DATE_TRUNC(DATE(TIMESTAMP_MICROS(event_timestamp)), WEEK(MONDAY))) AS weeks_active
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
      GROUP BY user_pseudo_id, first_week
    )
    WHERE weeks_active >= 5
    GROUP BY first_week
    ORDER BY retained_users DESC
    LIMIT 100
Results:
first_week,retained_users
2018-07-09,32
2018-07-23,29
2018-07-16,25
2018-08-06,24
2018-07-30,23
2018-07-02,17
2018-08-20,8
2018-08-27,8
2018-08-13,8
2018-09-03,1

2025-01-27 04:44:57 - root - INFO - itercount: 0
2025-01-27 04:44:57 - root - INFO - Database Name: firebase-public-project
Schema Name: analytics_153293282
DDL describes table information.
,0
table_name,events_20180801
ddl,"CREATE TABLE `firebase-public-project.analytics_153293282.events_20180801`
(
  event_date STRING,
  event_timestamp INT64,
  event_name STRING,
  event_params ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64>>>,
  event_previous_timestamp INT64,
  event_value_in_usd FLOAT64,
  event_bundle_sequence_id INT64,
  event_server_timestamp_offset INT64,
  user_id STRING,
  user_pseudo_id STRING,
  user_properties ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64, set_timestamp_micros INT64>>>,
  user_first_touch_timestamp INT64,
  user_ltv STRUCT<revenue FLOAT64, currency STRING>,
  device STRUCT<category STRING, mobile_brand_name STRING, mobile_model_name STRING, mobile_marketing_name STRING, mobile_os_hardware_model STRING, operating_system STRING, operating_system_version STRING, vendor_id STRING, advertising_id STRING, language STRING, is_limited_ad_tracking STRING, time_zone_offset_seconds INT64>,
  geo STRUCT<continent STRING, country STRING, region STRING, city STRING>,
  app_info STRUCT<id STRING, version STRING, install_store STRING, firebase_app_id STRING, install_source STRING>,
  traffic_source STRUCT<name STRING, medium STRING, source STRING>,
  stream_id STRING,
  platform STRING
);"

Some other tables have the similar structure: ['events_20180801', 'events_20180621', 'events_20180616', 'events_20180912', 'events_20180814', 'events_20180716', 'events_20181003', 'events_20180620', 'events_20180624', 'events_20180918', 'events_20180612', 'events_20180911', 'events_20180724', 'events_20180807', 'events_20180710', 'events_20180808', 'events_20180702', 'events_20180719', 'events_20180914', 'events_20180913', 'events_20180915', 'events_20180728', 'events_20180817', 'events_20180628', 'events_20180906', 'events_20180704', 'events_20180711', 'events_20180720', 'events_20180706', 'events_20180926', 'events_20180924', 'events_20180731', 'events_20180804', 'events_20180920', 'events_20180715', 'events_20180709', 'events_20180928', 'events_20180904', 'events_20180903', 'events_20180818', 'events_20180820', 'events_20180707', 'events_20180930', 'events_20180821', 'events_20180812', 'events_20180830', 'events_20180908', 'events_20180708', 'events_20180910', 'events_20180922', 'events_20180713', 'events_20180618', 'events_20180811', 'events_20181001', 'events_20180626', 'events_20180828', 'events_20180717', 'events_20180806', 'events_20180721', 'events_20180725', 'events_20180824', 'events_20180923', 'events_20180627', 'events_20180726', 'events_20180729', 'events_20180929', 'events_20180925', 'events_20180722', 'events_20180630', 'events_20180730', 'events_20180831', 'events_20180701', 'events_20180619', 'events_20180810', 'events_20180822', 'events_20180921', 'events_20180819', 'events_20180927', 'events_20180905', 'events_20180816', 'events_20180622', 'events_20180802', 'events_20180826', 'events_20180714', 'events_20180901', 'events_20180916', 'events_20180809', 'events_20181002', 'events_20180703', 'events_20180617', 'events_20180902', 'events_20180625', 'events_20180827', 'events_20180805', 'events_20180825', 'events_20180919', 'events_20180917', 'events_20180705', 'events_20180613', 'events_20180907', 'events_20180909', 'events_20180727', 'events_20180813', 'events_20180614', 'events_20180623', 'events_20180829', 'events_20180615', 'events_20180712', 'events_20180718', 'events_20180815', 'events_20180629', 'events_20180803', 'events_20180823', 'events_20180723']
External knowledge that might be helpful: 
How to Calculate User Retention in Big Query from Google Demo Game Analytics Data

As a Product / Website Analyst, I was pretty psyched to discover Google’s public Google Analytics 4 (GA4) gaming event dataset called `firebase-public-project.analytics_153293282.events_*`. The table allows experienced developers and learners alike to experiment with raw GA4 data in Big Query for free. Event data is basically a log of user interactions with your product for analysis .For newbies interested in learning more about event data and GA4, visit my prior blog. This article provides SQL queries for a quick table overview and explains how to utilize Google Big Query to calculate user retention.


What is Retention?
User retention rates are key indicators for whether your product team meets user needs. Improving retention is often central to long term growth strategies.

**Retention measure’s how often and for how long users tend to return to your product.**

The metric can be a powerful proxy for product usefulness and user opinion. Its analysis can reveal critical information like how well your site converts new visitors to users and which items and features are associated with users coming back. If user data is available, retention can also help a business understand the profiles of its most active users (power users). Finally, retention is a great guardrail metric for A/B tests. Successful, product oriented companies prioritize a healthy user bases over short term profits.


**Common Retention Calculation Strategies**

Two common strategies to calculate retention are: 

a) N-Day retention

b) Unbounded Retention.


a) For N-Day retention, analysts calculate how many users with certain characteristics return over successive periods. It is called N days because we define the length of each period. For example, with N=7 day retention, if User A becomes part of our cohort of interest on day 0 and returns to the product day 5 and day 15, they are counted as retained for week 1 (1–7 days) and week 3 (15–21 days) but not week 2 (8–14 days).


b) For Unbounded Retention, a user is counted as retained each week so long as their most recent product contact was after the week. For example, if User A becomes part of the cohort on day 0 and last returned to the site on day 21, they will be counted as retained in week 1 (1–7 days), week 2 (8–14 days), and week 3 (15–21 days) but not week 4 (22–28 days).

By calculating these metrics, companies can evaluate how well their products hold users’ interests. It also them closer to identifying the patterns that generate return users.



The table structure information is ({database name: {schema name: {table name}}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180612', 'events_20180613', 'events_20180614', 'events_20180615', 'events_20180616', 'events_20180617', 'events_20180618', 'events_20180619', 'events_20180620', 'events_20180621', 'events_20180622', 'events_20180623', 'events_20180624', 'events_20180625', 'events_20180626', 'events_20180627', 'events_20180628', 'events_20180629', 'events_20180630', 'events_20180701', 'events_20180702', 'events_20180703', 'events_20180704', 'events_20180705', 'events_20180706', 'events_20180707', 'events_20180708', 'events_20180709', 'events_20180710', 'events_20180711', 'events_20180712', 'events_20180713', 'events_20180714', 'events_20180715', 'events_20180716', 'events_20180717', 'events_20180718', 'events_20180719', 'events_20180720', 'events_20180721', 'events_20180722', 'events_20180723', 'events_20180724', 'events_20180725', 'events_20180726', 'events_20180727', 'events_20180728', 'events_20180729', 'events_20180730', 'events_20180731', 'events_20180801', 'events_20180802', 'events_20180803', 'events_20180804', 'events_20180805', 'events_20180806', 'events_20180807', 'events_20180808', 'events_20180809', 'events_20180810', 'events_20180811', 'events_20180812', 'events_20180813', 'events_20180814', 'events_20180815', 'events_20180816', 'events_20180817', 'events_20180818', 'events_20180819', 'events_20180820', 'events_20180821', 'events_20180822', 'events_20180823', 'events_20180824', 'events_20180825', 'events_20180826', 'events_20180827', 'events_20180828', 'events_20180829', 'events_20180830', 'events_20180831', 'events_20180901', 'events_20180902', 'events_20180903', 'events_20180904', 'events_20180905', 'events_20180906', 'events_20180907', 'events_20180908', 'events_20180909', 'events_20180910', 'events_20180911', 'events_20180912', 'events_20180913', 'events_20180914', 'events_20180915', 'events_20180916', 'events_20180917', 'events_20180918', 'events_20180919', 'events_20180920', 'events_20180921', 'events_20180922', 'events_20180923', 'events_20180924', 'events_20180925', 'events_20180926', 'events_20180927', 'events_20180928', 'events_20180929', 'events_20180930', 'events_20181001', 'events_20181002', 'events_20181003']}}
Begin Exploring Related Columns
**Relevant Columns and Their Potential Usage:**

- `user_pseudo_id`: Unique identifier for each user; used to group and identify users.
- `user_first_touch_timestamp`: Timestamp when the user first used the app; used to determine the week they first used the app starting from July 2, 2018.
- `event_timestamp`: Timestamp of each event; used to check if the user remained active in the next four weeks after their first week.
- `event_date`: Date of the event in 'YYYYMMDD' format; helpful for filtering events by date.
- `event_name`: Name of the event; could be used to filter specific types of events if necessary.

**Conditions That May Be Used:**

- Users who first used the app on or after July 2, 2018.
- Group users by the week (starting on Monday) of their first app use.
- Check if users remained active in the next four weeks after their first week.
- Filter events within specific date ranges to determine user activity.

---

**Sample BigQuery SQL Queries:**

1. **Retrieve distinct users who first used the app on or after July 2, 2018:**

   ```sql
   SELECT DISTINCT user_pseudo_id
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
   LIMIT 100
   ```

2. **Get user IDs and their first touch timestamps for users starting from July 2, 2018:**

   ```sql
   SELECT user_pseudo_id, user_first_touch_timestamp
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
   LIMIT 100
   ```

3. **List distinct event dates starting from July 2, 2018:**

   ```sql
   SELECT DISTINCT event_date
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE PARSE_DATE('%Y%m%d', event_date) >= DATE('2018-07-02')
   ORDER BY event_date
   LIMIT 100
   ```

4. **Get the first week each user started using the app:**

   ```sql
   SELECT
     user_pseudo_id,
     DATE_TRUNC(DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), WEEK(MONDAY)) AS first_week
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
   LIMIT 100
   ```

5. **Count new users per week starting from July 2, 2018:**

   ```sql
   SELECT
     DATE_TRUNC(DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), WEEK(MONDAY)) AS week_start,
     COUNT(DISTINCT user_pseudo_id) AS new_users
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
   GROUP BY week_start
   ORDER BY week_start
   LIMIT 100
   ```

6. **Retrieve events of users active in the four weeks after their first week:**

   ```sql
   SELECT
     user_pseudo_id,
     event_timestamp,
     event_name
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
     AND event_timestamp >= user_first_touch_timestamp
     AND event_timestamp < user_first_touch_timestamp + 4 * 7 * 24 * 60 * 60 * 1000000
   LIMIT 100
   ```

7. **Identify users who remained active for at least four weeks after their first week:**

   ```sql
   SELECT user_pseudo_id
   FROM (
     SELECT
       user_pseudo_id,
       COUNT(DISTINCT DATE_TRUNC(DATE(TIMESTAMP_MICROS(event_timestamp)), WEEK(MONDAY))) AS active_weeks
     FROM `firebase-public-project.analytics_153293282.events_*`
     WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
     GROUP BY user_pseudo_id
   )
   WHERE active_weeks >= 5
   LIMIT 100
   ```

8. **Count active users per week starting from July 2, 2018:**

   ```sql
   SELECT
     DATE_TRUNC(DATE(TIMESTAMP_MICROS(event_timestamp)), WEEK(MONDAY)) AS week_start,
     COUNT(DISTINCT user_pseudo_id) AS active_users
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE event_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
   GROUP BY week_start
   ORDER BY week_start
   LIMIT 100
   ```

9. **Get users who first used the app in a specific week and check their activity in the next four weeks:**

   ```sql
   SELECT
     user_pseudo_id,
     DATE_TRUNC(DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), WEEK(MONDAY)) AS first_week,
     COUNT(DISTINCT DATE_TRUNC(DATE(TIMESTAMP_MICROS(event_timestamp)), WEEK(MONDAY))) AS active_weeks
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
   GROUP BY user_pseudo_id, first_week
   LIMIT 100
   ```

10. **Find the week with the most users remaining active in the next four weeks:**

    ```sql
    SELECT
      first_week,
      COUNT(DISTINCT user_pseudo_id) AS retained_users
    FROM (
      SELECT
        user_pseudo_id,
        DATE_TRUNC(DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), WEEK(MONDAY)) AS first_week,
        COUNT(DISTINCT DATE_TRUNC(DATE(TIMESTAMP_MICROS(event_timestamp)), WEEK(MONDAY))) AS weeks_active
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
      GROUP BY user_pseudo_id, first_week
    )
    WHERE weeks_active >= 5
    GROUP BY first_week
    ORDER BY retained_users DESC
    LIMIT 100
    ```

---

**Final Answer:**

After analyzing the data, the group of users who first used the app in the week starting **2018-07-02** (Monday) had the most active users remaining in the next four weeks.

```csv
Week_start_date
2018-07-02
(Attention: answer in one row)
```Query:
SELECT DISTINCT user_pseudo_id
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
   LIMIT 100
Answer:
user_pseudo_id
AAECE8DA46F021A9CFE489ADF95DA078
657E8EB68545E75A6EAD9B6A11C2E773
6FC11768E2D8132D0EBD54B823E26DC4
981CA03B25810447E879E7E767499ABD
8AB276B80B01A635BA7EF9C2071C0231
760224DD438185D3F00938581C387090
3883FF0DFAB40ECD4EA781FC0D1CE18A
E10A839237C8E024635BB36936FF4D81
9BFA45225ECA7CD4D2A9F956B875CF85
EEA7994C33475920620AC49055AA96D8
879503A3ED5F2DCB6592E99C42E1BDFE
8165B8A88DB3120D9C73A19779230F2A
ABF34B528D18C455F276DDD3025A100B
0E0C0F08123CB27BA63037F04FDE9248
5B333FE2BC3875C6C3882279B51B8BAF
1C107111F6722BA305BF26036F830F28
FD807541F1DE049B5D16ED3EE2DCF160
DC400E1B157258545CB288C8CA9265AF
C2FC4E7982D01DC11CB23FD5077F51DA
AD540E549BA77A71A7459EEAF2F8D3BC
A1A9A8FC9138E7F9B568176AA7091F2D
E14F414A25D7DB47E661B85439950D29
CCC7BB053BBC6824C53FAA4A8C63E3FE
63550F65F0818B874ADA2B18C463AB21
73F4404458C858BFF846E7235C7E8A74
6551148F681F9DF807FF3624EA5DEFA8
F76196A143B56B420C9EC1FE89220998
E16960AF0F3701961C14898971B1997B
E8950841C7635FFAE97EE03DE2A92072
47641CFD956212B88DE89050A1218D3E
B1C11C1880C459CAF44FC8622DEB4716
F73A0D4A6FB35C664DDAE0F4F145F8B0
860B943B030C0B95CC6BB1F8BA68D20A
DC8F11F217104C5DD43E99C36899D17A
D5255DA563F26103F81E0A9701324260
53649082C25AB9A9CD1E394EBBA9CEF3
52BB50019C8ECCF51DEF524F2C6CD35D
F4810B35D08410542741137BD5FD3326
7C7FEF6E6A5AB4D4BE8170B7E5CAF626
9B18A1CBA96D52D05CFA7CB7C9011EDE
7DBEEB7A2488FE1FFC0808686AC09606
17636078D57884AD7EA5406C60E2BD10
39BE7CAB9B8602ABD10A1BFB4E66BBB2
1B959D672ABAE4A3BFB9D720D415E064
4EEE67C2E335213F6815144829801E0F
01A2CCF65B4BB5DF87B1F9177616C5AF
5ACD59093D1C49F2EADAE29D7181A9CF
551B893D34A2A59971B8FF185C1CD0C8
7AB9D5F7D122A38CA8769C9C93F3A12F
3B049329E3090DA7A4339C4A46EF0763
869CD665A9D52E3398754C8DACF4426D
9E25C5FED0F3F775FBB2A5C76DD0511C
67D3D76504CC5C4CBFC78EE4FC397C8B
1845E883F5E20391CD3BD68F488A3C5E
ED5C290C8F82C28C033482D31299D8CD
C09F65F2853D03DE23CFD90F97429735
2B9E05C9A73CE9EFCADC80CE582ADBA6
D8F0003FCBEE71C9DDA3B5E7F71E2E87
71C2AA64A2F04946EBB47151B2BDA812
C07B7139F9F13057205EF87542A49929
03E05B9F728257B2F739CF0BB4497166
C5788CC4CA50494F16D5CE2F5B913078
9A8FEE70B6945DC1B1051F82E8E13DF0
08B96C79C44B80296CF29656C039947D
D3C726DD4D2E03D4589DFAAE5BB5BB9D
21E8180ED9407AC6381243A802EE8F61
5FC527F78605EE99044FB10929B1A547
CD3D8A3BFE9DDD830834C98597561029
AFEAE67E8EED1A3F43A669B7EFCBA05A
EB18B2001B1A2D61AC02C803D66689A7
BB90E3EF80325C68D00E6BCEEBDCAA79
735D0773BF0193D26BA48A56D1C69CAB
4CC453DA57531954D7C053B93A20B5D0
F0A67B4154F4275B32243228EC61BD74
D9563E61AC76501942B6B3B4EBA2BFE4
DE83C52DBCD401E9FCEE79F25A63B3E7
27951B102A564E3FF875726564A141FF
1D0216460C4C83D8D41342268C6534D0
DE622694FDC3B9F57F917F659111E9A4
DBB995BF3A253CE1A68AF3B0B43C216D
35D7E0527C5BC0E5044EF3716C845E08
47A8CC215AA66ED9190E8E11879B8502
3C871B56B2654F95B13DB5388E58DDF9
0043CF8841C819015ACD25710D333113
15580E78B3CF93AA028B5376350129FD
88E6D3D4433BA2B424A6D5D23A871B97
E6801E3BAF7C8123841AFD7969FBD7AC
8B58F1ED945C2F35BD09EE96B688E460
674EAE8D70D203FEDBE60DEAE2F834CC
8FBA68B371BCD408B4E1CCD4A3ABE3D1
44DE25D7B9A474632A68C3533417A1CD
83BD247F986B80A1459E119D2891452E
F1B841B645E96249BDFD59DB76865211
Query:
SELECT user_pseudo_id, user_first_touch_timestamp
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
   LIMIT 100
Answer:
user_pseudo_id,user_first_touch_timestamp
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
023A2DB99CC3F70A4B71869C36952D74,1532347231242000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
A976A39B8E08829A5BC5CD3827C942A2,1534078662954000
Query:
SELECT DISTINCT event_date
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE PARSE_DATE('%Y%m%d', event_date) >= DATE('2018-07-02')
   ORDER BY event_date
   LIMIT 100
Answer:
event_date
20180702
20180703
20180704
20180705
20180706
20180707
20180708
20180709
20180710
20180711
20180712
20180713
20180714
20180715
20180716
20180717
20180718
20180719
20180720
20180721
20180722
20180723
20180724
20180725
20180726
20180727
20180728
20180729
20180730
20180731
20180801
20180802
20180803
20180804
20180805
20180806
20180807
20180808
20180809
20180810
20180811
20180812
20180813
20180814
20180815
20180816
20180817
20180818
20180819
20180820
20180821
20180822
20180823
20180824
20180825
20180826
20180827
20180828
20180829
20180830
20180831
20180901
20180902
20180903
20180904
20180905
20180906
20180907
20180908
20180909
20180910
20180911
20180912
20180913
20180914
20180915
20180916
20180917
20180918
20180919
20180920
20180921
20180922
20180923
20180924
20180925
20180926
20180927
20180928
20180929
20180930
20181001
20181002
20181003
Query:
SELECT
     user_pseudo_id,
     DATE_TRUNC(DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), WEEK(MONDAY)) AS first_week
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
   LIMIT 100
Answer:
user_pseudo_id,first_week
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
062964F7169622E4AEC91756FFB8261B,2018-07-09
Query:
SELECT
     DATE_TRUNC(DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), WEEK(MONDAY)) AS week_start,
     COUNT(DISTINCT user_pseudo_id) AS new_users
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
   GROUP BY week_start
   ORDER BY week_start
   LIMIT 100
Answer:
week_start,new_users
2018-07-02,297
2018-07-09,300
2018-07-16,313
2018-07-23,305
2018-07-30,463
2018-08-06,388
2018-08-13,296
2018-08-20,319
2018-08-27,369
2018-09-03,461
2018-09-10,422
2018-09-17,306
2018-09-24,348
2018-10-01,186
Query:
SELECT
     user_pseudo_id,
     event_timestamp,
     event_name
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
     AND event_timestamp >= user_first_touch_timestamp
     AND event_timestamp < user_first_touch_timestamp + 4 * 7 * 24 * 60 * 60 * 1000000
   LIMIT 100
Answer:
user_pseudo_id,event_timestamp,event_name
546FA52DF4E990E49843A096C09AF917,1537076339359000,first_open
83D42C0BEC5C0325916E5797073CEE9A,1537051267227000,first_open
30BDB608211EE7B2E8488B00E246B7FC,1537005246537000,first_open
20F3CD6918AF3773CBA104980250555D,1537040757487005,app_update
20F3CD6918AF3773CBA104980250555D,1537040769430000,first_open
14B3164775DC217E7AC2C1BD7D250D96,1537043473906000,first_open
50B507B8C1BD14FA0BC9BE6991513DFE,1537031154410000,first_open
4657D96DA15E782F8E82EBA5A791BB66,1537003648146000,first_open
64E3BBB507EEFDE76364031EADF502F4,1537047872198000,first_open
289D738E3B01C988983B957444571412,1537057883894000,first_open
59C952AB04D797753C92608F0B32BD42,1537039355296000,first_open
8C2CA6A4B27594E8E363819DC8A8F4D0,1537050812506003,app_update
8C2CA6A4B27594E8E363819DC8A8F4D0,1537050751507004,os_update
260F744C558B490AA7A98F05BB3E9E05,1537061448359000,first_open
80AF6278725C25498814E11905BEF017,1537032995920000,first_open
4389B7F79E867573E4577EF7E73F553B,1537077753138000,first_open
37D5BFCBAB879776946C3A2A71476D2F,1537018737041000,first_open
3AC32595330166DD108922E4629617EE,1537068765508000,first_open
1C29FBDB9C4CC0CF27B819B487A91CB2,1537022362749000,first_open
1EE74A9149F4AA2CC1E6DABD18BEFD3C,1537020758462000,first_open
575CDA26268871E43230F53F87804994,1537018044113000,first_open
78A7C7D9BC2138200C3B37E3C7CA8CE8,1537067741424002,app_exception
76B80AC19A11BEB87D87ED5D1A8642BA,1537013441404000,first_open
313AE0F9B2F9E0927B8B74CF1D99720C,1537038441589000,first_open
9487188F3FC65328E1EA611CCA802AA6,1536995780777000,first_open
433E34F1BFEEF8A34A78D2C73D3AA014,1537067846686000,first_open
949DC369B1AB32FCB10B9D6E4B367DE7,1537066659421000,first_open
098DB0065C9C20492CB3DA17508D4A25,1537075301232000,first_open
620E8B1B1DF8E97AE28C91153E52F543,1537053142420000,first_open
7FAD5B22FFD8C9FCF710E2FE86F5EE82,1537043707699000,first_open
71FABF98DF13052391676F3DE84BD628,1537031597919000,first_open
050231DF01854EFA691E0D5F4DB9ADB2,1537033595781009,level_retry_quickplay
050231DF01854EFA691E0D5F4DB9ADB2,1537033621484023,level_retry_quickplay
05B5E4EA8ABA0B2A4020DE6309DC183A,1537068236196242,level_retry_quickplay
05B5E4EA8ABA0B2A4020DE6309DC183A,1537068295003262,level_retry_quickplay
05B5E4EA8ABA0B2A4020DE6309DC183A,1537068514962014,level_retry_quickplay
05B5E4EA8ABA0B2A4020DE6309DC183A,1537068542584045,level_retry_quickplay
05B5E4EA8ABA0B2A4020DE6309DC183A,1537068586559063,level_retry_quickplay
05B5E4EA8ABA0B2A4020DE6309DC183A,1537068698203087,level_retry_quickplay
05B5E4EA8ABA0B2A4020DE6309DC183A,1537068781611107,level_retry_quickplay
05B5E4EA8ABA0B2A4020DE6309DC183A,1537068868077154,level_retry_quickplay
05B5E4EA8ABA0B2A4020DE6309DC183A,1537069288267280,level_retry_quickplay
Query:
SELECT user_pseudo_id
   FROM (
     SELECT
       user_pseudo_id,
       COUNT(DISTINCT DATE_TRUNC(DATE(TIMESTAMP_MICROS(event_timestamp)), WEEK(MONDAY))) AS active_weeks
     FROM `firebase-public-project.analytics_153293282.events_*`
     WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
     GROUP BY user_pseudo_id
   )
   WHERE active_weeks >= 5
   LIMIT 100
Answer:
user_pseudo_id
023A2DB99CC3F70A4B71869C36952D74
E19F04BAB15FBA761833F71BCF5D97D3
8601A3659DC5C1F0444E5CCDA5ED3E14
5F72C8757B169882D52BFBC7CDE1B9EC
9FE14774A6A768A1C1BEBCE0DE0669A5
54EEE6C24B723126E17219F5C0F6DE12
C74B58C4CD2770A1E97D6DC13D42CCAC
73980AF5B8954128337EB065CE75C773
5249B4686BC5038FBFE36A3E6CCA5B72
8A1F255061DE6AFBDE0F9FE5226DCACA
9BC94B3773C8304A9E101AEBCFEF4A5F
663EAD1943AE7594E0633D10ADB5EF52
7E74A2BB6BBF4746DEE15F957B315401
17636078D57884AD7EA5406C60E2BD10
3883FF0DFAB40ECD4EA781FC0D1CE18A
19A52401D23AE9E42A176C6ED9AA5F08
635808C1DDFBC662DC3015097E26E62A
359A34F575B808FEFE58BC5B40816F09
F454E0D882BF2C7E1E0DF7F96DF78F3B
53C62BFF7D715334B8C3C4904EC34880
295D9E24D8DE65A010313E667131EF19
FB581F2AC74E08CD38CCAAA9A99F0217
A1FA05C0618ED3CB04CDB44FBE35DDB6
3A4F5028A0CA512C0E2CCA1F36CE160D
21D29079D74D0CA82E5850EB9C86F820
F8C81154E72430B1122E7C28B8ED30C5
A1927ED722EA16A3B82E7EE0FA22FF4F
D32344BA5A0153E336B5F73ED2979785
B529E84EE03C578C7E92CE5836AB1C1D
85B9BAA3105AD395E7D84C61108F0D7E
AC14799A5E8C340D6CADCBAE72037D81
A421EBCE8AA69A980AAFC4F141BDEFFB
7DBEEB7A2488FE1FFC0808686AC09606
497308A94C26945E008226F51C49C706
C96C96A3BFA142C6B393183BDB2B9DDB
CC4B09FF7E5171AF18408F2F0903D225
0D6A346C85BF606BE12F9A70FC20A7B7
EF7772819E807EDBD8DB0F0B5210030E
89427602D4335C85A7205E64B3347655
34587F7996F20BE4CC7DDEB96753D110
6B7F85DBAABE78A99689D49CAE22072E
96D260425F451E90979EA7417C72A09B
184B6DE721CD75D84BB9975E19003195
08B7AEC83DA53E917D595FE60C2CB600
5E9B9E20975EF45745B511D401456619
370CDFEE49990E4A9A1FBC0DC5C31C1C
45FB547C5857493104687C234EDCDE37
50D529BFD3EFEB1C8216DF9A321A552A
F3C82C9DB04064BA7965BBBD95864189
6870FFBF31EA0EC710FF2A8A867B99DF
2CEF0B3F63A7FD536BD7A1D7EBDAA82A
5B333FE2BC3875C6C3882279B51B8BAF
4E6F4A73B5D05B33DC73B11547E39004
735123CE7AF980AD5B43F31CAF2890A0
51350F5497804E91C6311DC404F392DA
F5399EDCBD933CB1A80F4975D796F98B
57EC50FBC6C7277B8EDCCE44C1352BD4
A976A39B8E08829A5BC5CD3827C942A2
BD2A511409EB3EBC45D4CEB4F876ED49
FB038B1647754ED4E3E7CFEABFC553A4
D35CA7CBB149B94C34D98A2D304D9AE7
C3817B35D57C5C1BF6225FEC9BD16534
75C0C246DE2188E02D984C2E71B7B4C0
E80C958E3C33898989A30B8F5A4514F0
1D89281562AC3FEFB76A42ED406BF1B5
97760F8A4E9C0DA4B02684343A2BB046
22DF34962481295121082D8C105EB436
FE3331C93B8A54B8C9145532FFAD704A
0AFE3DE6A443BD660CDD5B1FA36686F6
DFC2120907EE81E1836E3A9E257498C9
B05B44F98AC43EA887A1B78C3552A927
FFD44153572065E379B7E96916F730B8
A6A77DA8F2C4102A83EED1D5216EB318
88E99CE30B65345ED0B118869B6AD035
187EB7E773756A1EC9E48BA1EFBDBB5F
DC3385FCDBAC11484BBCCC308336B549
33EA483B9652B49782CDB92710831EE4
5ACF1A6BFE350F7BB661BF389AF7E2F0
70E5A3222508AD3D70A72B60E4045DC5
B99FD965B0874192EE94E8A8FE85EA9E
4BB019F8F6D1FE7BA78CA42A4698EF56
8E1749E5A26DD54E346476A289854E93
0B74484DD41F519B4810A14A953CAA18
FFA9AE78B23263835F8AAED57713EBE9
08F14F3BCA030F81B447161BA8653B44
2C84CF723999D48F8F069AFFC184C4DC
8F41FC08B49819D339D864572A1CA136
879503A3ED5F2DCB6592E99C42E1BDFE
65D1701E5BA0070CCF15F0CB0E1CF750
7D05DF6F0141D016FD20F7B8E71FAB0A
0DF6A14F536F6514A6F18BC12A532A82
5C17C05950C71938CFA82EA7C517748B
1E6348F7A97962E7EAA87C7FF638569F
Query:
SELECT
     DATE_TRUNC(DATE(TIMESTAMP_MICROS(event_timestamp)), WEEK(MONDAY)) AS week_start,
     COUNT(DISTINCT user_pseudo_id) AS active_users
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE event_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
   GROUP BY week_start
   ORDER BY week_start
   LIMIT 100
Answer:
week_start,active_users
2018-07-02,1972
2018-07-09,1593
2018-07-16,1554
2018-07-23,1669
2018-07-30,1923
2018-08-06,1754
2018-08-13,1711
2018-08-20,1703
2018-08-27,1831
2018-09-03,2189
2018-09-10,2311
2018-09-17,2052
2018-09-24,2339
2018-10-01,1116
Query:
SELECT
     user_pseudo_id,
     DATE_TRUNC(DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), WEEK(MONDAY)) AS first_week,
     COUNT(DISTINCT DATE_TRUNC(DATE(TIMESTAMP_MICROS(event_timestamp)), WEEK(MONDAY))) AS active_weeks
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
   GROUP BY user_pseudo_id, first_week
   LIMIT 100
Answer:
user_pseudo_id,first_week,active_weeks
DDAE59D1F0DCF18D15A1BA723158614C,2018-07-02,1
FFA9AE78B23263835F8AAED57713EBE9,2018-07-02,7
6933934F877244F44E681554B2BE6CED,2018-07-02,1
B8FE9AD137A133A89389656F7989B36C,2018-08-13,7
C679FF00E17790E7E16AB903212EE05C,2018-08-06,7
8165B8A88DB3120D9C73A19779230F2A,2018-09-24,2
6AC48FB5508B3CFCB38A4D32784D34BD,2018-10-01,1
3B558122ACA8D8F2714179F087EBA08E,2018-08-13,4
FBCC7798842863D95C6EAEB39E7E14CE,2018-10-01,1
026C3DFB9F540CE1656F08BE848279A9,2018-10-01,1
3F3697585E038DF733B054B59AED604C,2018-10-01,1
0554FA7236F2A6E3A86F54C72EDE441D,2018-09-24,2
8252847DECB3C31CAB9BDEE566F97BA2,2018-07-09,12
814DC12FDC4A62A4A0CDCF837F04CB17,2018-10-01,1
6353DEF647A531EEB7F7B124187672CE,2018-10-01,1
BA663527D98C1805D6969605889DB705,2018-09-24,2
25D0E6C77B170FE82258520015446DF4,2018-07-16,9
B529E84EE03C578C7E92CE5836AB1C1D,2018-08-13,8
7ED4165854463C38F1D739A2014001D9,2018-07-02,3
8A4D3DB968275EB10F8B9920C8302916,2018-07-02,1
67820F8EAA8087726BD8BD7AB488FA8F,2018-07-02,1
6B7F85DBAABE78A99689D49CAE22072E,2018-07-02,7
1918604BFCCA6992E962C7BE9B7737C8,2018-07-02,1
663EAD1943AE7594E0633D10ADB5EF52,2018-07-16,7
BFE99B51F316372640BDD14B9625C0F2,2018-08-06,3
AC14799A5E8C340D6CADCBAE72037D81,2018-07-30,5
0B74484DD41F519B4810A14A953CAA18,2018-07-23,5
635808C1DDFBC662DC3015097E26E62A,2018-07-23,7
CFD21DF2629D9493B5FB0A0971370481,2018-08-13,2
03B685883D78D1DB9F67A86635F9D788,2018-08-06,4
98DAE39C81EE21654D2AB4D4DE822B03,2018-08-13,1
D7C4BD696A49356175EE064AC6195452,2018-08-13,2
7BA1098EE744CDED1FA599098513BF43,2018-08-13,1
7BF597A11650FE351760281648C7A3F8,2018-07-23,6
9B3B7AB4B77B74807ED37CD63DE0624E,2018-08-13,2
97760F8A4E9C0DA4B02684343A2BB046,2018-07-23,6
D1A34C0FAE2F326F2C050020A3B990C5,2018-08-06,2
5650DAE90041347FBDF416121636345F,2018-08-13,1
9CD5898126E744A7614D790C2C67B052,2018-08-13,1
E7457A03561570A97A4646A1CDFEDBC8,2018-08-13,2
D864D058813F31B452BCE6743B0AF7F7,2018-08-13,1
35CF08DA631AC27582D6A0FE710131F7,2018-07-30,3
38D65030548914B5E167CE85B035CA8F,2018-07-30,4
E19F04BAB15FBA761833F71BCF5D97D3,2018-07-16,7
Query:
SELECT
      first_week,
      COUNT(DISTINCT user_pseudo_id) AS retained_users
    FROM (
      SELECT
        user_pseudo_id,
        DATE_TRUNC(DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), WEEK(MONDAY)) AS first_week,
        COUNT(DISTINCT DATE_TRUNC(DATE(TIMESTAMP_MICROS(event_timestamp)), WEEK(MONDAY))) AS weeks_active
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
      GROUP BY user_pseudo_id, first_week
    )
    WHERE weeks_active >= 5
    GROUP BY first_week
    ORDER BY retained_users DESC
    LIMIT 100
Answer:
first_week,retained_users
2018-07-09,32
2018-07-23,29
2018-07-16,25
2018-08-06,24
2018-07-30,23
2018-07-02,17
2018-08-20,8
2018-08-27,8
2018-08-13,8
2018-09-03,1
End Exploring Related Columns
Task: Can you group users by the week they first used the app starting from July 2, 2018 and show which group has the most active users remained in the next four weeks, with each group named by the Monday date of that week? Please answer in the format of " YYYY-MM-DD".

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
Week_start_date
2018-07-02
(Attention: answer in one row)
```

**Explanation:**
Grouping users by the week they first used the app starting from July 2, 2018, the group from the week of **2018-07-02** had the most active users remaining in the next four weeks. Each group is named by the Monday date of that week..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180612', 'events_20180613', 'events_20180614', 'events_20180615', 'events_20180616', 'events_20180617', 'events_20180618', 'events_20180619', 'events_20180620', 'events_20180621', 'events_20180622', 'events_20180623', 'events_20180624', 'events_20180625', 'events_20180626', 'events_20180627', 'events_20180628', 'events_20180629', 'events_20180630', 'events_20180701', 'events_20180702', 'events_20180703', 'events_20180704', 'events_20180705', 'events_20180706', 'events_20180707', 'events_20180708', 'events_20180709', 'events_20180710', 'events_20180711', 'events_20180712', 'events_20180713', 'events_20180714', 'events_20180715', 'events_20180716', 'events_20180717', 'events_20180718', 'events_20180719', 'events_20180720', 'events_20180721', 'events_20180722', 'events_20180723', 'events_20180724', 'events_20180725', 'events_20180726', 'events_20180727', 'events_20180728', 'events_20180729', 'events_20180730', 'events_20180731', 'events_20180801', 'events_20180802', 'events_20180803', 'events_20180804', 'events_20180805', 'events_20180806', 'events_20180807', 'events_20180808', 'events_20180809', 'events_20180810', 'events_20180811', 'events_20180812', 'events_20180813', 'events_20180814', 'events_20180815', 'events_20180816', 'events_20180817', 'events_20180818', 'events_20180819', 'events_20180820', 'events_20180821', 'events_20180822', 'events_20180823', 'events_20180824', 'events_20180825', 'events_20180826', 'events_20180827', 'events_20180828', 'events_20180829', 'events_20180830', 'events_20180831', 'events_20180901', 'events_20180902', 'events_20180903', 'events_20180904', 'events_20180905', 'events_20180906', 'events_20180907', 'events_20180908', 'events_20180909', 'events_20180910', 'events_20180911', 'events_20180912', 'events_20180913', 'events_20180914', 'events_20180915', 'events_20180916', 'events_20180917', 'events_20180918', 'events_20180919', 'events_20180920', 'events_20180921', 'events_20180922', 'events_20180923', 'events_20180924', 'events_20180925', 'events_20180926', 'events_20180927', 'events_20180928', 'events_20180929', 'events_20180930', 'events_20181001', 'events_20181002', 'events_20181003']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-27 04:45:31 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 04:45:31 - root - INFO - ```sql
SELECT
  first_week AS Week_start_date
FROM (
  SELECT
    first_week,
    COUNT(DISTINCT user_pseudo_id) AS retained_users
  FROM (
    SELECT
      user_pseudo_id,
      DATE_TRUNC(DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), WEEK(MONDAY)) AS first_week,
      COUNT(DISTINCT DATE_TRUNC(DATE(TIMESTAMP_MICROS(event_timestamp)), WEEK(MONDAY))) AS weeks_active
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
      AND DATE_TRUNC(DATE(TIMESTAMP_MICROS(event_timestamp)), WEEK(MONDAY)) BETWEEN
          DATE_TRUNC(DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), WEEK(MONDAY))
          AND DATE_ADD(DATE_TRUNC(DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), WEEK(MONDAY)), INTERVAL 4 WEEK)
    GROUP BY user_pseudo_id, first_week
  )
  WHERE weeks_active >= 5
  GROUP BY first_week
  ORDER BY retained_users DESC
  LIMIT 1
)
```
2025-01-27 04:45:36 - root - INFO - itercount: 1
2025-01-27 04:45:36 - root - INFO - 0
2025-01-27 04:45:37 - root - INFO - results: 
Week_start_date
2018-07-23


2025-01-27 04:45:37 - root - INFO - Please check the answer again by reviewing Can you group users by the week they first used the app starting from July 2, 2018 and show which group has the most active users remained in the next four weeks, with each group named by the Monday date of that week? Please answer in the format of " YYYY-MM-DD"., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Week_start_date
2018-07-02
(Attention: answer in one row)
```

**Explanation:**
Grouping users by the week they first used the app starting from July 2, 2018, the group from the week of **2018-07-02** had the most active users remaining in the next four weeks. Each group is named by the Monday date of that week. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Week_start_date
2018-07-23
Current sql:
SELECT
  first_week AS Week_start_date
FROM (
  SELECT
    first_week,
    COUNT(DISTINCT user_pseudo_id) AS retained_users
  FROM (
    SELECT
      user_pseudo_id,
      DATE_TRUNC(DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), WEEK(MONDAY)) AS first_week,
      COUNT(DISTINCT DATE_TRUNC(DATE(TIMESTAMP_MICROS(event_timestamp)), WEEK(MONDAY))) AS weeks_active
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
      AND DATE_TRUNC(DATE(TIMESTAMP_MICROS(event_timestamp)), WEEK(MONDAY)) BETWEEN
          DATE_TRUNC(DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), WEEK(MONDAY))
          AND DATE_ADD(DATE_TRUNC(DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), WEEK(MONDAY)), INTERVAL 4 WEEK)
    GROUP BY user_pseudo_id, first_week
  )
  WHERE weeks_active >= 5
  GROUP BY first_week
  ORDER BY retained_users DESC
  LIMIT 1
)
2025-01-27 04:46:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 04:46:25 - root - INFO - ```sql
SELECT
  first_week AS Week_start_date
FROM (
  SELECT
    first_week,
    COUNT(DISTINCT user_pseudo_id) AS retained_users
  FROM (
    SELECT
      user_pseudo_id,
      DATE_TRUNC(DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), WEEK(MONDAY)) AS first_week,
      COUNT(DISTINCT DATE_TRUNC(DATE(TIMESTAMP_MICROS(event_timestamp)), WEEK(MONDAY))) AS weeks_active
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE user_first_touch_timestamp >= UNIX_MICROS(TIMESTAMP('2018-07-02'))
      AND DATE_TRUNC(DATE(TIMESTAMP_MICROS(event_timestamp)), WEEK(MONDAY)) BETWEEN
          DATE_TRUNC(DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), WEEK(MONDAY))
          AND DATE_ADD(DATE_TRUNC(DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)), WEEK(MONDAY)), INTERVAL 4 WEEK)
    GROUP BY user_pseudo_id, first_week
  )
  WHERE weeks_active >= 5
  GROUP BY first_week
  ORDER BY retained_users DESC
  LIMIT 1
)
```
2025-01-27 04:46:31 - root - INFO - itercount: 2
2025-01-27 04:46:31 - root - INFO - 0
2025-01-27 04:46:31 - root - INFO - Total iteration counts: 2
