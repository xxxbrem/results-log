2025-01-27 03:19:43 - openai._base_client - INFO - Retrying request to /chat/completions in 0.461386 seconds
2025-01-27 03:20:48 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 03:20:51 - root - INFO - SQL:
SELECT DISTINCT `measure_tag`
   FROM `bigquery-public-data.sec_quarterly_financials.numbers`
   LIMIT 100;
Results:
measure_tag
EquityDeemedContributionDistributionRelatedToNetAssetsTransferredToNoncontrollingInterestNet
ImpairmentLossOnPrepaidLicensingAndRoyaltyFees
FairValueInputsPricingSpreadDuringPeriod
InventoryProvisionNonControllingInterest
PortionOfOilAndGasSalesLessLeaseOperatingExpensesAndProductionTaxesAllocatedToInterest
InterestAndDefaultPenaltyOfConvertibleNote
EffectiveIncomeTaxRateReconciliationExpiringStateNols
IssuancePreferredStock
CommonStockIssuedForServicesToBeReceivedInFutureShares
NetIncomeLossAllocatedToPartnership
WarrantsIssuedInConnectionWithSeriesBPreferredOffering
ValueOfCommonSharesIssuedFromStockSubscriptionsPayable
IssuedAtFairValuePursuantToDebtSettlementAgreementsAmount
DilutiveEffectOfConvertibleDebentureExcludedFromDilutedEarningsPerShareCalculation
CommonStockIssuedForInterestOnConvertibleNotesShares
FairValueMeasurementWithUnobservableInputsReconciliationRecurringBasisIntangibleAssets
FairMarketValue
ShareBasedCompensationArrangementByShareBasedPaymentAwardPerSharePriceExpired
OtherComprehensiveIncomeLossNetUnrealizedGainsLossesOnSecuritiesNetOfTaxPeriodIncreaseDecrease
Selectedrestructuringcharges
RelatedPartyTransactionsZeroTwoEightOneOneZeroHvbMHNinelTvOneMM
DeferredGovernmentGrantsZeroTwoEightFiveOneZerogVFLxThreegMHTwoQh
InterestExpenseCertificatesOfDeposits
UnrealizedGainLossOnDerivativesNumberOfWarrants
PercentageOfLowestClosingPriceIn20TradingDays
ConvertibleNotesPayableIssuedToSettleAccountsPayable
RelatedPartiesServiceFee
NumberOfCommonStockSharesPurchased
RelatedPartyTransactionFlatFee
LossContingencyNumberofLLCs
ConvertiblePromissoryNotesPayableZeroThreeOneEightSixZeroxdmzNFiveSBwsNineC
StockholdersEquityZeroThreeOneEightSixZerozSixChMcnrHTwogX
ScheduleOfDisclosureOfSharebasedCompensationArrangementsBySharebasedPaymentAwardZeroThreeTwoTwoOneZeroRcZerogEightCzOneTZeroFiveq
WarrantExpiration
NetLossForThePeriod1
ForeignCurrencyExchangeAppreciationDepreciationRate
IncreaseDecreaseInPlacementOrRolloverOfMaturedTimeDeposits
ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsExercisesWeightedAverageGrantDateFairValue
ValuationAllowanceDeferredTaxAssetChangeInAmountNoncurrent
ExpenseAndOtherIncome
SurveyCost
SecurityDepositsAndMaintenancePaymentLiabilityAppliedAsRentalsReceivedInAdvance
IncomeTaxReconciliationNonDeductibleExpenseLossOnDerivative
DeferredTaxAssetsOthers
IssuanceOfStockUnder15MPurchaseAgreement
ValuationAllowancesAndReservesCreditedToCostsAndExpenses
CompanyRaised
OtherNetIncreaseInCet1
BenchmarkPercentageOfRevenueForMajorCustomer
GainLossOnIssuanceOfWarrant
DebtInstrumentAssignmentToInvestorOne
ForeignCurrencyAdjustment1
GainOnDisposalOfPropertyPlantAndEquipment
IncrementalCommonSharesAttributableToConversionOfPreferredStockSeriesBPreferredStock
ConversionOfStockAmountConverted13
ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsForfeituresIntrinsicValue
ConvertiblePreferredStockIssuedForSeries
WarrantsIssuedInConnectionWithRedeemablePreferredStock
GainLossOnStockWarrantsRevaluation
PercentageOfConvertiblePreferredStockDividendsPayable
NumberOfFreeTradingSharesIssuedForSatisfyingDisputedObligation
AdjustmentsToAdditionalPaidInCapitalWarrantsAndOptionsIssuedForServices
AftermarketPartSalesRevenueRelatedParty
CharitableContributionAtHistoricalContributionLevels
PurchasePriceAllocationCashUsedInRetailStoreAcquisitions
ConstructionManagementFeePercentage
TotalAccumulatedOtherComprehensiveIncomeLossNetOfTax
RepaymentsOfShortTermAndLongTermDebt
AdjustmentsToAdditionalPaidInCapitalContributionWithdrawalThroughIncreaseOfDebt
StockIssuedDuringPeriodSharesDividend
MaximumTargetNumberOfSharesIssuedBasedOnStockPerformanceInPercent
OrganizationAndBusinessZeroThreeOneSixEightZeronlzHXwSevenbcTZs

2025-01-27 03:20:53 - root - INFO - SQL:
SELECT `measure_tag`, `tag_label`
   FROM `bigquery-public-data.sec_quarterly_financials.measure_tag`
   WHERE LOWER(`tag_label`) LIKE '%revenue%'
   LIMIT 100;
Results:
measure_tag,tag_label
OperatingRevenues,Operating Revenues:
RevenuesPercentageIncreaseDecreaseAbstract,Revenues Percentage Increase (Decrease) Abstract
RevenuesAndOtherIncomeAbstract,Revenues and other income Abstract
RevenuesAndOtherIncomeAbstract,Revenues and Other Income [Abstract]
RevenuesAndNonOperatingIncomeAbstract,Revenues and Non Operating Income Abstract
SalesRevenueNetPercentToNetSales,Sales Revenue Net Percent To Net Sales
BroadcastingRevenuePercentageIncreaseDecrease,Broadcasting Revenue Percentage Increase (Decrease)
DigitalRevenuePercentageIncreaseDecrease,Digital Revenue Percentage Increase (Decrease)
OtherRevenuePercentageIncreaseDecrease,Other Revenue Percentage Increase (Decrease)
PublishingAdvertisingRevenuePercentageIncreaseDecrease,Publishing Advertising Revenue Percentage Increase (Decrease)
PublishingCirculationRevenuePercentageIncreaseDecrease,Publishing Circulation Revenue Percentage Increase (Decrease)
TotalRevenuePercentageIncreaseDecrease,Total Revenue Percentage Increase (Decrease)
SalesRevenueGoodsNetPercentageIncreaseDecrease,Sales Revenue Goods Net Percentage Increase Decrease
CostOfPurchasedCoalRevenue,Cost of purchased coal revenue
PurchasedCoalRevenue,Purchased coal revenue
StockBasedCompensationExpensesAllocatedToCostOfProductRevenue,Stock Based Compensation Expenses Allocated to Cost Of Product Revenue
CostOfRevenuesAmortizationOfAcquiredTechnologyIntangibleAssets,Cost of revenues: Amortization of acquired technology - based intangible assets
CostOfRevenuesServiceAndOther,Cost of revenues: Service and other
ServiceAndOtherRevenue,Service and other revenue
ContractDrillingsRevenues,Contract drilling revenues
RevenuesGoodsAndServices,Revenues
RevenueRelatedToNonMonetaryExchanges,Revenue Related To Non Monetary Exchanges
RelatedPartyRevenues,Related parties revenues
AccountsReceivableAndUnbilledRevenuesNet,"Accounts receivable and unbilled revenues, net"
DeferredRevenueDisclosureTextBlock,Deferred Revenue Disclosure [Text Block]
DeferredRevenueDisclosureTextBlock,Deferred Revenue Disclosure [Text Block]
ReconciliationOfRevenueFromSegmentsToConsolidatedTextBlock,Reconciliation of Revenue from Segments to Consolidated [Text Block]
RevenueRecognitionPolicyTextBlock,"Revenue Recognition, Policy [Text Block]"
RevenueRecognitionPolicyTextBlock,"Revenue Recognition, Policy [Text Block]"
ScheduleOfRevenueFromExternalCustomersAttributedToForeignCountriesByGeographicAreaTextBlock,Schedule of Revenue from External Customers Attributed to Foreign Countries by Geographic Area [Text Block]
GecsRevenueFromServices,GECS REVENUES FROM SERVICES
RevenueRecognitionTextBlock,Revenue Recognition Text Block
InformationAboutReceivablesRevenuesAndServicesTextBlock,"Information about Receivables, Revenues, and Services [Text Block]"
OtherNoninterestRevenueTextBlock,Other Noninterest Revenue [Text Block]
GrossVsNetRevenueDisclosureTextBlock,Gross Vs. Net Revenue Disclosure [Text Block]
GrossVsNetRevenueDisclosureTextBlock,Gross Vs. Net Revenue Disclosure [Text Block]
AdvertisingRevenue,Advertising Revenue
BrokerageCommissionsRevenue,Brokerage Commissions Revenue
BrokerageCommissionsRevenue,Brokerage Commissions Revenue
BrokeredNaturalGasMarginRevenue,Brokered Natural Gas Margin Revenue
CapitalLeasesIncomeStatementDirectFinancingLeaseRevenue,"Capital Leases, Income Statement, Direct Financing Lease Revenue"
CargoAndFreightRevenue,Cargo and Freight Revenue
CargoAndFreightRevenue,Cargo and Freight Revenue
CasinoRevenue,Casino Revenue
ClearingFeesRevenue,Clearing Fees Revenue

2025-01-27 03:20:54 - root - INFO - SQL:
SELECT DISTINCT `stprba`
   FROM `bigquery-public-data.sec_quarterly_financials.submission`
   WHERE `countryba` = 'US'
   LIMIT 100;
Results:
stprba
GA
PA
TX
IN
NV
HI
NM
MS
""
MN
CA
CT
NY
RI
NC
NJ
TN
CO
ME
OR
VA
WI
WY
DE
MA
IL
NH
WA
SC
MD
MO
VT
WV
FL
AL
OH
AZ
KS
OK
KY
MI
AR
DC
IA
LA
SD
UT
NE
MT
AK
ND
ID

2025-01-27 03:21:20 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 03:21:20 - root - INFO - ```sql
SELECT DISTINCT `company_name`, `stprba`
FROM `bigquery-public-data.sec_quarterly_financials.submission`
WHERE CAST(SUBSTR(CAST(`date_filed` AS STRING), 1, 4) AS INT64) = 2016
  AND `countryba` = 'US'
  AND `stprba` IS NOT NULL
  AND `stprba` != ''
LIMIT 100;
```
2025-01-27 03:22:43 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 03:22:43 - root - INFO - SQL:
SELECT DISTINCT `company_name`, `stprba`
FROM `bigquery-public-data.sec_quarterly_financials.submission`
WHERE CAST(SUBSTR(CAST(`date_filed` AS STRING), 1, 4) AS INT64) = 2016
  AND `countryba` = 'US'
  AND `stprba` IS NOT NULL
  AND `stprba` != ''
LIMIT 100;
Results:
company_name,stprba
DUO WORLD INC,NV
KROGER CO,OH
VIRTUSA CORP,MA
HF FINANCIAL CORP,SD
CALAVO GROWERS INC,CA
AMERICAN INDEPENDENCE CORP,NY
TIMKEN CO,OH
SOUTHSIDE BANCSHARES INC,TX
NORWOOD FINANCIAL CORP,PA
UTAH MEDICAL PRODUCTS INC,UT
PAR TECHNOLOGY CORP,NY
FIRST BANCORP /NC/,NC
LIONS GATE ENTERTAINMENT CORP /CN/,CA
"PLANET FITNESS, INC.",MA
VIBE WIRELESS CORP.,AZ
SPLUNK INC,CA
GUESS INC,CA
CHEROKEE INC,CA
BIOPHARMX CORP,CA
"PURE STORAGE, INC.",CA
NVIDIA CORP,CA
VIRCO MFG CORPORATION,CA
"TILLY'S, INC.",CA
QAD INC,CA
SIGMA DESIGNS INC,CA
VIOLIN MEMORY INC,CA
XACTLY CORP,CA
SEMTECH CORP,CA
TRIANGLE PETROLEUM CORP,CO
JAMMIN JAVA CORP.,CO
"MULTI SOFT II, INC",FL
OXFORD INDUSTRIES INC,GA
"DESTINATION XL GROUP, INC.",MA
EXA CORP,MA
LOWES COMPANIES INC,NC
"GORDMANS STORES, INC.",NE
DESTINATION MATERNITY CORP,NJ
TOYS R US INC,NJ
AEROPOSTALE INC,NY
"FOOT LOCKER, INC.",NY
VINCE HOLDING CORP.,NY
VANECK MERK GOLD TRUST,NY
TIFFANY & CO,NY
LAKELAND INDUSTRIES INC,NY
MESABI TRUST,NY
"EXPRESS, INC.",OH
"MACY'S, INC.",OH
DICKS SPORTING GOODS INC,PA
FREDS INC,TN
STAGE STORES INC,TX
"BAKERCORP INTERNATIONAL, INC.",TX
"MICHAELS COMPANIES, INC.",TX
"SPORTSMAN'S WAREHOUSE HOLDINGS, INC.",UT
TAPIMMUNE INC,FL
VINCOMPASS CORP.,CA
SEYCHELLE ENVIRONMENTAL TECHNOLOGIES INC /CA,CA
BARRACUDA NETWORKS INC,CA
STEELCASE INC,MI
SUPERVALU INC,MN
RED HAT INC,NC
TOUCAN INTERACTIVE CORP,NV
"NEW ENTERPRISE STONE & LIME CO., INC.",PA
"INTERNATIONAL WESTERN PETROLEUM, INC.",TX
PROPERTY MANAGEMENT CORP OF AMERICA,VA
INTELLISENSE SOLUTIONS INC.,AZ
"HOULIHAN LOKEY, INC.",CA
BUSCAR CO,CA
"ENSIGN GROUP, INC",CA
WNC HOUSING TAX CREDIT FUND VI LP SERIES 9,CA
WNC HOUSING TAX CREDIT FUND VI LP SERIES 10,CA
"RMR INDUSTRIALS, INC.",CA
"ORGANOVO HOLDINGS, INC.",CA
E DIGITAL CORP,CA
CORVEL CORP,CA
MEDIA ANALYTICS CORP,CA
MCKESSON CORP,CA
SIMLATUS CORP,CA
8X8 INC /DE/,CA
STEVIA FIRST CORP.,CA
VIASAT INC,CA
APPLIED MICRO CIRCUITS CORP,CA
WNC HOUSING TAX CREDIT FUND IV L P SERIES 2,CA
"AEROGROW INTERNATIONAL, INC.",CO
AMERICAN TAX CREDIT TRUST SERIES I,CT
"EARTH SCIENCE TECH, INC.",FL
FUTUREWORLD CORP.,FL
PETMED EXPRESS INC,FL
NICHOLAS FINANCIAL INC,FL
NOVELIS INC.,GA
SUGAR CREEK FINANCIAL CORP./MD/,IL

2025-01-27 03:22:45 - root - INFO - SQL:
SELECT n.`value`, s.`stprba`, n.`measure_tag`
FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
  ON n.`submission_number` = s.`submission_number`
WHERE s.`stprba` IS NOT NULL
  AND s.`stprba` != ''
LIMIT 100
Results:
value,stprba,measure_tag
1.0,TX,PreferredStockParOrStatedValuePerShare
116068000.0,TX,AccountsPayableCurrent
132546000.0,TX,CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalents
1525000.0,TX,AssetRetirementObligationsNoncurrent
48.0,TX,NumberOfStatesInWhichEntityOperates
1550000.0,TX,AssetRetirementObligationsNoncurrent
4233587.0,TX,CommonStockSharesOutstanding
147329000.0,TX,StockholdersEquity
451000.0,TX,CapitalLeasesFutureMinimumPaymentsDueInFiveYears
236000.0,TX,DerivativeLiabilitiesCurrent
132546000.0,TX,CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalents
821000.0,TX,LiabilityInsuranceProgramExcessLossFund
960000.0,TX,PreferredStockSharesAuthorized
0.0,TX,PreferredStockValue
146598000.0,TX,StockholdersEquity
2873000.0,TX,CashDepositsAndOtherAssetsNoncurrent
880000.0,TX,PrepaidRentAndOther
705000.0,TX,PrepaidInsurance
960000.0,TX,PreferredStockSharesAuthorized
74499000.0,TX,AccountsReceivableNetCurrent
117066000.0,TX,CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalents
422000.0,TX,StockholdersEquity
12497000.0,TX,StockholdersEquity
5611000.0,TX,PaymentsForAssetAcquisitionsGross
20725000.0,TX,PropertyPlantAndEquipmentGross
2794000.0,TX,PropertyPlantAndEquipmentGross
35.15,TX,SharePrice
137188000.0,TX,StockholdersEquity
2007000.0,TX,FinitelivedIntangibleAssetsAcquired1
4000.0,TX,DerivativeAssetsLiabilitiesAtFairValueNet
0.0,TX,DerivativeLiabilities
431000.0,TX,AssetAcquisitionConsiderationTransferredLiabilitiesIncurred
24895000.0,TX,PropertyPlantAndEquipmentGross
0.0,TX,DerivativeFairValueOfDerivativeLiabilityAmountOffsetAgainstCollateral
0.0,TX,EnergyMarketingContractsAssetsCurrent
0.0,TX,DerivativeFairValueOfDerivativeAsset
139000.0,TX,DerivativeAssetFairValueGrossLiability
0.0,TX,DerivativeFairValueOfDerivativeAsset
0.0,TX,DerivativeAssetFairValueGrossLiability
16003000.0,TX,PropertyPlantAndEquipmentGross
0.0,TX,DerivativeFairValueOfDerivativeLiabilityAmountOffsetAgainstCollateral
4600000.0,TX,LettersOfCreditOutstandingAmount
0.0,TX,DerivativeAssets
139000.0,TX,EnergyMarketingContractLiabilitiesCurrent
956000000.0,CA,CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalents
50000000.0,CA,TreasuryStockValue
834000000.0,CA,AccountsPayableCurrent
207000000.0,CA,DueToRelatedPartiesCurrent
48000000.0,CA,OtherLiabilitiesCurrent
4556000000.0,CA,Assets
,CA,CommitmentsAndContingencies
58000000.0,CA,EquityMethodInvestments
289000000.0,CA,Goodwill
28000000.0,CA,SoftwareTechnologyAndLicensesPayable
458000000.0,CA,PropertyPlantAndEquipmentNet
0.01,CA,CommonStockParOrStatedValuePerShare
40000000.0,CA,SoftwareTechnologyAndLicensesPayable
288000000.0,CA,AccruedMarketingAndAdvertisingCurrent

2025-01-27 03:22:46 - root - INFO - SQL:
SELECT n.`submission_number`, n.`value`, n.`measure_tag`, n.`period_end_date`
FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
WHERE n.`number_of_quarters` = 4
  AND n.`period_end_date` BETWEEN 20160101 AND 20161231
  AND n.`period_end_date` IS NOT NULL
LIMIT 100
Results:
submission_number,value,measure_tag,period_end_date
0000075677-15-000011,-3400000.0,CashFlowHedgeGainLossToBeReclassifiedWithinTwelveMonthsNetOfTax,20160331
0000717423-15-000022,4.13,UnderlyingDerivativeVolume,20161231
0000721748-15-000301,39600.0,OperatingLeasesIncomeStatementInitialDirectCosts,20161231
0000826675-15-000011,-2429000.0,CashFlowHedgeGainLossToBeReclassifiedWithinTwelveMonths,20160331
0000929008-15-000016,11400000.0,ShareBasedCompensation,20161231
0001001606-15-000015,9800000.0,AmortizationOfIntangibleAssets,20161231
0001002014-15-000233,220440.0,LeaseAndRentalExpense,20161231
0001012569-15-000073,137000000.0,RelinquishmentofIncentiveDistributions,20161231
0001021162-15-000017,2725000.0,AdjustmentsToAdditionalPaidInCapitalConvertibleDebtWithConversionFeature,20160331
0001064728-15-000042,-91000000.0,CashFlowHedgeGainLossToBeReclassifiedWithinTwelveMonths,20160331
0001064728-15-000042,75000000.0,PaymenttotheVEBAbasedontheconstructofthenegotiatedsettlement,20161231
0001078782-15-000761,0.0,MinimumLeaseCommitmentsThereafter,20160331
0001144204-15-024774,0.15,EffectiveIncomeTaxRatePreferentialTaxRate,20161231
0001144204-15-025260,0.15,EffectiveIncomeTaxRateReconciliationAtFederalStatutoryIncomeTaxRate,20161231
0001144204-15-031403,5000000.0,MinimumEarningsBeforeInterestTaxesDepreciationAndAmortization,20161231
0001144204-15-035673,4500000.0,MinimumEarningsBeforeInterestTaxesDepreciationAndAmortization,20161231
0001144204-15-035673,500000.0,MaximumCapitalExpendituresOfGuarantorAndItsSubsidiaries,20161231
0001193125-15-160100,57678.0,ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsVestedInPeriod,20161130
0001193125-15-177335,90000000.0,RetentionOfAnnualTransmissionCongestionRevenues,20161231
0001193125-15-179473,1250000.0,BusinessCombinationContingentConsiderationAcquisitionsMaximumVariableEarnout,20161231
0001193125-15-232464,5700000000.0,DefinedBenefitPlanFutureAmortizationOfGainLoss,20160331
0001469709-15-000183,0.0,TotalOperatingLeaseCommitmentsMineOperatingRights,20161231
0001486800-15-000031,35000000.0,MinimumEbitda,20160331
0001495231-15-000032,1800000.0,Businesscombinationpaymenttoacquireeformeetingperformancegoal,20161231
0001495231-15-000035,27000000.0,BusinessCombinationsSeparatelyRecognizedTransactionsContentOnlyRevenue,20161231
0001495231-15-000035,0.6,BusinessCombinationContingentConsiderationArrangementsPercentageofPerformancePaymentOwed,20161231
0001495231-15-000035,0.0,BusinessCombinationContingentConsiderationArrangementsChangeInTheRangeOfOutcomesContingentConsiderationLiabilityValueHigh,20161231
0001495231-15-000035,1080000.0,BusinessCombinationContingentConsiderationArrangementsChangeInTheRangeOfOutcomesContingentConsiderationLiabilityValueHigh,20161231
0001495231-15-000035,0.0,BusinessCombinationContingentConsiderationArrangementsPercentageofPerformancePaymentOwed,20161231
0001550695-15-000022,4.75,DebtInstrumentCovenantTotalDebttoEBITDAratio,20161231

2025-01-27 03:22:49 - root - INFO - SQL:
SELECT n.`value`, s.`stprba`, s.`company_name`, n.`measure_tag`
FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
  ON n.`submission_number` = s.`submission_number`
WHERE n.`number_of_quarters` = 4
  AND n.`period_end_date` BETWEEN 20160101 AND 20161231
  AND s.`countryba` = 'US'
  AND s.`stprba` IS NOT NULL
  AND s.`stprba` != ''
LIMIT 100
Results:
value,stprba,company_name,measure_tag
2598000000.0,CA,CLOROX CO /DE/,GrossProfit
0.0,CA,CLOROX CO /DE/,IncomeLossFromDiscontinuedOperationsNetOfTaxAttributableToReportingEntity
22000000.0,GA,COCA COLA CO,AmortizationForLeaseholdImprovements
1035000000.0,GA,COCA COLA CO,ProceedsfromDisposalsofbusinessesequitymethodinvestmentsandnonmarketablesecurities
41000000.0,GA,COCA COLA CO,MultiemployerPlanContributionsByEmployer
1147000000.0,GA,COCA COLA CO,CurrentFederalTaxExpenseBenefit
1434000000.0,GA,COCA COLA CO,ProceedsFromIssuanceOfCommonStock
-0.03,GA,COCA COLA CO,EffectiveIncomeTaxRateReconciliationEquityInEarningsLossesOfUnconsolidatedSubsidiary
733000000.0,GA,COCA COLA CO,InterestExpense
42000000.0,GA,COCA COLA CO,OtherComprehensiveIncomeLossForeignCurrencyTransactionGainLossArisingduringPeriodNetofTax
8136000000.0,GA,COCA COLA CO,IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest
1371000000.0,GA,COCA COLA CO,OtherCostAndExpenseOperating
1586000000.0,GA,COCA COLA CO,IncomeTaxExpenseBenefit
0.16,GA,COCA COLA CO,ShareBasedCompensationArrangementByShareBasedPaymentAwardFairValueAssumptionsExpectedVolatilityRate
10000000.0,GA,COCA COLA CO,ValuationAllowancesAndReservesDeductions
71000000.0,GA,COCA COLA CO,EmployeeServiceShareBasedCompensationTaxBenefitFromCompensationExpense
0.019,GA,COCA COLA CO,EffectiveIncomeTaxRateReconciliationTaxContingenciesDomestic
449000000.0,GA,COCA COLA CO,IncomeLossFromEquityMethodInvestmentsNetOfDividendsOrDistributions
-838000000.0,GA,COCA COLA CO,DeferredFederalIncomeTaxExpenseBenefit
139000000.0,GA,COCA COLA CO,AmortizationOfIntangibleAssets
41863000000.0,GA,COCA COLA CO,Revenues
0.0,GA,COCA COLA CO,EffectiveIncomeTaxRateReconciliationRepatriationForeignEarningsJobsCreationActOf2004
1.49,GA,COCA COLA CO,EarningsPerShareDiluted
642000000.0,GA,COCA COLA CO,InvestmentIncomeInterest
2262000000.0,GA,COCA COLA CO,PaymentsToAcquirePropertyPlantAndEquipment
500000000.0,GA,COCA COLA CO,IssuanceOfLongTermDebt
-613000000.0,GA,COCA COLA CO,OtherComprehensiveIncomeLossForeignCurrencyTransactionAndTranslationAdjustmentNetOfTax
0.0,GA,COCA COLA CO,IncomeLossFromEquityMethodInvestments
352000000.0,GA,COCA COLA CO,RestructuringCharges
-91000000.0,GA,COCA COLA CO,DeferredStateAndLocalIncomeTaxExpenseBenefit
0.012,GA,COCA COLA CO,EffectiveIncomeTaxRateReconciliationStateAndLocalIncomeTaxes
0.0425,GA,COCA COLA CO,DefinedBenefitPlanAssumptionsUsedCalculatingNetPeriodicBenefitCostDiscountRate
8000000.0,GA,COCA COLA CO,IntersegmentRevenue
31000000.0,GA,COCA COLA CO,Costincurredtoconvertbottlingagreements
86000000.0,GA,COCA COLA CO,DefinedBenefitPlanNetPeriodicBenefitCostExcludingSettlementCurtailmentAndSpecialTerminationBenefits
615000000.0,GA,COCA COLA CO,InvestmentIncomeInterest
946000000.0,GA,COCA COLA CO,RelatedPartyTransactionMarketingPaymentsDirectlyToRelatedParty

2025-01-27 03:22:51 - root - INFO - SQL:
SELECT DISTINCT mt.`measure_tag`, mt.`tag_label`
FROM `bigquery-public-data.sec_quarterly_financials.measure_tag` AS mt
WHERE mt.`tag_label` IS NOT NULL
  AND LOWER(mt.`tag_label`) LIKE '%revenue%'
LIMIT 100
Results:
measure_tag,tag_label
TotalRevenuePercentageIncreaseDecrease,Total Revenue Percentage Increase (Decrease)
RelatedPartyRevenues,Related parties revenues
ScheduleOfRevenueFromExternalCustomersAttributedToForeignCountriesByGeographicAreaTextBlock,Schedule of Revenue from External Customers Attributed to Foreign Countries by Geographic Area [Text Block]
CargoAndFreightRevenue,Cargo and Freight Revenue
ContractsRevenue,Contracts Revenue
ElectricalGenerationRevenue,Electrical Generation Revenue
ElectricalTransmissionAndDistributionRevenue,Electrical Transmission and Distribution Revenue
MaintenanceRevenue,Maintenance Revenue
PrincipalTransactionsRevenue,Principal Transactions Revenue
SalesRevenueEnergyServices,"Sales Revenue, Energy Services"
UnregulatedOperatingRevenue,Unregulated Operating Revenue
OtherElectricRevenues,Other electric revenues
WholesaleRevenues,Wholesale revenues
SuppliesRevenue,Supplies revenue
RevenueFromPressurePumping,Revenue From Pressure Pumping
OtherRevenues,Other Revenues
MortgageBankingRevenues,Mortgage Banking Revenues
GasMarketingRevenueNetOfRelatedCosts,"Gas Marketing Revenue, Net of Related Costs"
SubscriptionLicensingAndOtherRevenues,Subscription Licensing and Other Revenues
DeferredRevenue,Deferred Revenue
CustomerDepositsDeferredRevenue,Customer Deposits Deferred Revenue
OtherLiabilitiesAndDeferredRevenue,Other Liabilities And Deferred Revenue
UnearnedRevenue,Unearned revenue
AdvanceBillingsOnUncompletedContracts,Advance billings and unearned revenue on uncompleted contracts
UnderRecoveredRegulatoryClauseRevenues,Under recovered regulatory clause revenues
AccruedRevenues,Accrued revenues
AccruedUnbilledRevenueEnergy,Accrued unbilled revenue
ElectricUtilityRevenueAbstract,Electric Revenue [Abstract]
FinancialServicesRevenueAbstract,Financial Services Revenue [Abstract]
RealEstateRevenueNetAbstract,"Real Estate Revenue, Net [Abstract]"
RegulatedAndUnregulatedOperatingRevenueAbstract,Regulated and Unregulated Operating Revenue [Abstract]
SalesRevenueGoodsNetAbstract,"Sales Revenue, Goods, Net [Abstract]"
ContractDrillingIntangibleRevenues,Contract drilling intangible revenues
PaymentsForProceedsFromBusinessesAndInterestInAffiliatesTextBlock,Revenue Accounting for Contracts / Accounting for Joint Ventures
ServiceFees,Service revenues
StockBasedCompensationExpenseAssociatedWithCostOfSales,"Cost of revenues, stock-based compensation expense"
NonInsuranceServiceRevenues,Service revenues
MortgageServicingAndOther,Mortgage banking net revenue
AdditionsToUnearnedRevenue,Additions to unearned revenue
PrepaidRevenueShareExpensesAndOtherAssetsNoncurrent,"Prepaid revenue share, expenses and other assets, non-current"
UnbilledRevenue,Unbilled revenue
DeferredRevenueArrangementLineItems,Deferred Revenue Arrangement [Line Items]
ProFormaInformationOnCompanyRevenueAndNetEarningsAbstract,Pro forma information on company revenue and net earnings Abstract
PercentageOfNetRevenueFromSalesToSignificantCustomersIncludingTheirManufacturingSubcontractorsAbstract,Percentage Of Net Revenue From Sales To Significant Customers Including their Manufacturing Subcontractors Abstract
RevenueAndLongLivedAssetsAttributedToIndividualForeignCountriesLineItems,Revenue And Long Lived Assets Attributed To Individual Foreign Countries [Line Items]
DisposalGroupIncludingDiscontinuedOperationRevenueAbstract,Disposal Group Including Discontinued Operation Revenue Abstract
SalesAndTradingRevenueAbstract,Sales and Trading Revenue Abstract

2025-01-27 03:22:54 - root - INFO - SQL:
SELECT n.`submission_number`, n.`value`, n.`measure_tag`, s.`company_name`, s.`stprba`
FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
  ON n.`submission_number` = s.`submission_number`
WHERE n.`number_of_quarters` = 4
  AND n.`period_end_date` BETWEEN 20160101 AND 20161231
  AND s.`countryba` = 'US'
  AND s.`stprba` IS NOT NULL
  AND s.`stprba` != ''
  AND n.`measure_tag` IN (
    SELECT `measure_tag`
    FROM `bigquery-public-data.sec_quarterly_financials.measure_tag`
    WHERE `tag_label` IS NOT NULL
      AND LOWER(`tag_label`) LIKE '%revenue%'
  )
ORDER BY n.`value` DESC
LIMIT 100
Results:
submission_number,value,measure_tag,company_name,stprba
0001104659-19-024105,1747143000000.0,RevenueAndOperatingIncome,BANK OF CHILE,NY
0001104659-18-027756,1747143000000.0,RevenueAndOperatingIncome,BANK OF CHILE,NY
0001104659-19-024105,1717559000000.0,RevenueAndOperatingIncome,BANK OF CHILE,NY
0001104659-19-024105,1717559000000.0,RevenueAndOperatingIncome,BANK OF CHILE,NY
0001104659-18-027756,1717559000000.0,RevenueAndOperatingIncome,BANK OF CHILE,NY
0001104659-18-027756,1458296000000.0,OperatingRevenuesNetOfProvisionsForLoanLosses,BANK OF CHILE,NY
0001104659-19-024105,1458296000000.0,OperatingRevenuesNetOfProvisionsForLoanLosses,BANK OF CHILE,NY
0001104659-18-027756,1226733000000.0,InterestRevenueExpense,BANK OF CHILE,NY
0001104659-19-024105,1226733000000.0,InterestRevenueExpense,BANK OF CHILE,NY
0001104659-19-024105,1226733000000.0,InterestRevenueExpense,BANK OF CHILE,NY
0001104659-18-027756,1220368000000.0,InterestRevenueExpense,BANK OF CHILE,NY
0001104659-19-024105,1220368000000.0,InterestRevenueExpense,BANK OF CHILE,NY
0001104659-18-027756,1137333000000.0,RevenueAndOperatingIncome,BANK OF CHILE,NY
0001104659-19-024105,1137333000000.0,RevenueAndOperatingIncome,BANK OF CHILE,NY
0001104659-19-024105,873669000000.0,InterestRevenueExpense,BANK OF CHILE,NY
0001104659-18-027756,873669000000.0,InterestRevenueExpense,BANK OF CHILE,NY
0001185185-17-000924,571720000000.0,BusinessAcquisitionsProFormaRevenue,HOOKER FURNITURE CORP,VA
0000104169-17-000021,482130000000.0,Revenues,WAL MART STORES INC,AR
0000104169-16-000079,482130000000.0,Revenues,WAL MART STORES INC,AR
0000104169-18-000028,482130000000.0,Revenues,WALMART INC.,AR
0000104169-16-000079,478614000000.0,SalesRevenueNet,WAL MART STORES INC,AR
0000104169-18-000028,478614000000.0,SalesRevenueNet,WALMART INC.,AR
0000104169-17-000021,478614000000.0,SalesRevenueNet,WAL MART STORES INC,AR
0001104659-19-024105,422353000000.0,RevenueAndOperatingIncome,BANK OF CHILE,NY
0001104659-18-027756,422353000000.0,RevenueAndOperatingIncome,BANK OF CHILE,NY
0000104169-16-000079,360984000000.0,CostOfRevenue,WAL MART STORES INC,AR
0000104169-17-000021,360984000000.0,CostOfRevenue,WAL MART STORES INC,AR
0000104169-18-000028,360984000000.0,CostOfRevenue,WALMART INC.,AR
0000104169-17-000021,357559000000.0,Revenues,WAL MART STORES INC,AR
0000104169-16-000079,357559000000.0,Revenues,WAL MART STORES INC,AR
0000104169-18-000028,357559000000.0,Revenues,WALMART INC.,AR
0001104659-18-027756,346829000000.0,InterestRevenueExpense,BANK OF CHILE,NY

2025-01-27 03:22:57 - root - INFO - SQL:
SELECT s.`stprba`, SUM(n.`value`) AS `total_revenue`
FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
  ON n.`submission_number` = s.`submission_number`
WHERE n.`number_of_quarters` = 4
  AND n.`period_end_date` BETWEEN 20160101 AND 20161231
  AND s.`countryba` = 'US'
  AND s.`stprba` IS NOT NULL
  AND s.`stprba` != ''
  AND n.`measure_tag` IN (
    SELECT `measure_tag`
    FROM `bigquery-public-data.sec_quarterly_financials.measure_tag`
    WHERE `tag_label` IS NOT NULL
      AND LOWER(`tag_label`) LIKE '%revenue%'
  )
GROUP BY s.`stprba`
ORDER BY `total_revenue` DESC
LIMIT 100
Results:
stprba,total_revenue
NY,54567490590974.875
TX,30466878337154.598
CA,28097919465933.89
IL,16475171338763.547
WA,12388413931253.527
OH,9911236993649.855
MI,9771448675979.963
MA,9430360296708.02
PA,8657235380473.33
MN,8647154420131.662
NJ,8629589039550.321
AR,7865962653985.448
GA,7685580270676.557
VA,6752345705102.671
FL,5739246088610.498
NC,5229746387116.293
MO,5083019416194.108
CT,4861500342230.495
CO,4568385504310.364
RI,4510430467030.5
TN,4334978819894.095
NE,4084598013795.96
IN,3195434531321.0073
MD,2821784226300.4956
WI,2081012911689.3584
OK,1969169766220.9702
AZ,1876589077953.5527
ID,1505949572250.65
KY,1455800858127.2102
KS,1385052522044.1506
NV,1363543745541.3674
DE,1184682510772.88
IA,937330742749.0201
OR,756717724638.913
LA,666914002425.451
DC,601373713571.7002
AL,564662791593.156
UT,483297687359.85205
SC,371327450395.726
HI,141641154284.02002
NH,106699373260.13
ND,88754394174.45
ME,59981627040.58
SD,56784553394.24249
MS,52761015902.0
AK,23335694750.980003
NM,16597135801.2726
WY,11291090615.0
VT,9542364703.7
WV,5121116943.0
MT,4417660957.8

2025-01-27 03:22:59 - root - INFO - SQL:
SELECT n.`submission_number`, s.`company_name`, s.`stprba`, n.`value`, mt.`tag_label`
FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
  ON n.`submission_number` = s.`submission_number`
JOIN `bigquery-public-data.sec_quarterly_financials.measure_tag` AS mt
  ON n.`measure_tag` = mt.`measure_tag`
WHERE n.`number_of_quarters` = 4
  AND n.`period_end_date` BETWEEN 20160101 AND 20161231
  AND s.`countryba` = 'US'
  AND s.`stprba` IS NOT NULL
  AND s.`stprba` != ''
  AND mt.`tag_label` IS NOT NULL
  AND LOWER(mt.`tag_label`) LIKE '%revenue%'
LIMIT 100
Results:
submission_number,company_name,stprba,value,tag_label
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue

2025-01-27 03:23:02 - root - INFO - SQL:
SELECT s.`company_name`, s.`stprba`, MAX(n.`value`) AS `max_revenue`
FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
  ON n.`submission_number` = s.`submission_number`
WHERE n.`number_of_quarters` = 4
  AND n.`period_end_date` BETWEEN 20160101 AND 20161231
  AND s.`countryba` = 'US'
  AND s.`stprba` IS NOT NULL
  AND s.`stprba` != ''
  AND n.`measure_tag` IN (
    SELECT `measure_tag`
    FROM `bigquery-public-data.sec_quarterly_financials.measure_tag`
    WHERE `tag_label` IS NOT NULL
      AND LOWER(`tag_label`) LIKE '%revenue%'
  )
GROUP BY s.`company_name`, s.`stprba`
ORDER BY `max_revenue` DESC
LIMIT 100
Results:
company_name,stprba,max_revenue
BANK OF CHILE,NY,1747143000000.0
HOOKER FURNITURE CORP,VA,571720000000.0
WALMART INC.,AR,482130000000.0
WAL MART STORES INC,AR,482130000000.0
GENERAL ELECTRIC CO,MA,345301000000.0
EXXON MOBIL CORP,TX,226094000000.0
BERKSHIRE HATHAWAY INC,NE,223604000000.0
APPLE INC,CA,215639000000.0
MCKESSON CORP,CA,190884000000.0
UNITEDHEALTH GROUP INC,MN,184840000000.0
CVS HEALTH CORP,RI,177546000000.0
NAVIENT CORP,DE,174000000000.0
GENERAL MOTORS CO,MI,166380000000.0
AT&T INC.,TX,163786000000.0
AMAZON COM INC,WA,152283000000.0
FORD MOTOR CO,MI,151800000000.0
AMERISOURCEBERGEN CORP,PA,146849686000.0
CHEVRON CORP,CA,129030000000.0
VERIZON COMMUNICATIONS INC,NY,125980000000.0
CARDINAL HEALTH INC,OH,121561000000.0
COSTCO WHOLESALE CORP /NEW,WA,118719000000.0
"WALGREENS BOOTS ALLIANCE, INC.",IL,117351000000.0
KROGER CO,OH,114341000000.0
EXPRESS SCRIPTS HOLDING CO.,MO,102115500000.0
COMMUNITY HEALTH SYSTEMS INC,TN,98200000000.0
JPMORGAN CHASE & CO,NY,96569000000.0
BOEING CO,WA,94571000000.0
MICROSOFT CORP,WA,94490000000.0
ALPHABET INC.,CA,90272000000.0
HOME DEPOT INC,GA,88519000000.0
WELLS FARGO & COMPANY/MN,CA,88267000000.0
INTERNATIONAL BUSINESS MACHINES CORP,NY,85936000000.0
PHILLIPS 66,TX,85777000000.0
"ANTHEM, INC.",IN,84863000000.0
BANK OF AMERICA CORP /DE/,NC,84601000000.0
COMCAST CORP,PA,80736000000.0
COMCAST CORP,NY,80403000000.0
VALERO ENERGY CORP/TX,TX,75659000000.0
MARATHON PETROLEUM CORP,OH,75193000000.0
PHILIP MORRIS INTERNATIONAL INC.,NY,74953000000.0
JOHNSON & JOHNSON,NJ,74339000000.0
TARGET CORP,MN,73785000000.0
DELL TECHNOLOGIES INC,TX,73138000000.0
DOWDUPONT INC.,MI,71321000000.0
CITIGROUP INC,NY,70797000000.0
METLIFE INC,NY,68878000000.0
GULF ISLAND FABRICATION INC,TX,65981000000.0
PROCTER & GAMBLE CO,OH,65299000000.0
AETNA INC /PA/,CT,63155000000.0
PEPSICO INC,NY,62799000000.0
ARCHER DANIELS MIDLAND CO,IL,62346000000.0
UNITED PARCEL SERVICE INC,GA,61610000000.0
INTEL CORP,CA,59486000000.0
LOWES COMPANIES INC,NC,59074000000.0
PRUDENTIAL FINANCIAL INC,NJ,58779000000.0
"ALBERTSONS COMPANIES, INC.",ID,58734000000.0
UNITED TECHNOLOGIES CORP /DE/,CT,58103000000.0
COCA COLA CO,GA,58054000000.0
FEDEX CORP,TN,57899000000.0
SYSCO CORP,TX,55922506000.0

2025-01-27 03:23:05 - root - INFO - SQL:
SELECT s.`stprba`, AVG(n.`value`) AS `average_revenue`
FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
  ON n.`submission_number` = s.`submission_number`
WHERE n.`number_of_quarters` = 4
  AND n.`period_end_date` BETWEEN 20160101 AND 20161231
  AND s.`countryba` = 'US'
  AND s.`stprba` IS NOT NULL
  AND s.`stprba` != ''
  AND n.`measure_tag` IN (
    SELECT `measure_tag`
    FROM `bigquery-public-data.sec_quarterly_financials.measure_tag`
    WHERE `tag_label` IS NOT NULL
      AND LOWER(`tag_label`) LIKE '%revenue%'
  )
GROUP BY s.`stprba`
ORDER BY `average_revenue` DESC
LIMIT 100
Results:
stprba,average_revenue
RI,11932355732.884926
AR,11078820639.416122
NE,4694940245.742482
WA,4411828323.095987
MI,3071816622.4394727
ID,3048480915.4871464
NY,3022292472.4993
MN,2317650608.451263
IL,1822877997.2077394
MO,1819262496.8482847
OH,1672782614.962001
NC,1668712950.5795453
TN,1633991262.6815286
GA,1596506080.3233395
DE,1552663841.1177983
IN,1483488640.3533
CT,1481261530.234764
TX,1461451448.0335102
VA,1412329158.14739
NJ,1370428623.082471
KY,1252840669.6447592
PA,1174340122.1477659
CA,1104521383.1492553
DC,1103438006.553578
KS,1082918312.778851
MA,1044105435.8622696
IA,1002492772.9936043
OR,973896685.506967
MD,955241782.7692947
OK,805057140.7281151
CO,801893190.1545314
AL,754896780.204754
WI,752899027.3839935
FL,737597492.4316282
AZ,733042608.5756066
LA,718657330.1998397
MS,532939554.5656565
SC,498426107.9137262
NV,487502232.94292724
UT,364752971.5923412
HI,311984921.3304406
ND,309248760.1897212
ME,275145078.1677982
NH,267416975.58929822
NM,227358024.6749671
WY,225821812.29999998
SD,155149052.98973364
AK,132589174.72147727
VT,73402805.41307692
MT,64024071.85217391
WV,47860906.00934579

2025-01-27 03:23:08 - root - INFO - SQL:
SELECT s.`stprba`, n.`measure_tag`, SUM(n.`value`) AS `total_revenue`
FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
  ON n.`submission_number` = s.`submission_number`
WHERE n.`number_of_quarters` = 4
  AND n.`period_end_date` BETWEEN 20160101 AND 20161231
  AND s.`countryba` = 'US'
  AND s.`stprba` IS NOT NULL
  AND s.`stprba` != ''
  AND n.`measure_tag` IN (
    SELECT `measure_tag`
    FROM `bigquery-public-data.sec_quarterly_financials.measure_tag`
    WHERE `tag_label` IS NOT NULL
      AND LOWER(`tag_label`) LIKE '%revenue%'
  )
GROUP BY s.`stprba`, n.`measure_tag`
ORDER BY `total_revenue` DESC
LIMIT 100
Results:
stprba,measure_tag,total_revenue
NY,Revenues,14642876696173.0
NY,RevenueAndOperatingIncome,12098280320000.0
TX,Revenues,10686113518108.0
NY,InterestRevenueExpense,8658853000000.0
CA,SalesRevenueNet,8371793342249.0
CA,Revenues,8199679072599.0
IL,Revenues,6987829559116.0
MA,Revenues,4562691967185.0
WA,Revenues,4404654808782.0
TX,SalesRevenueNet,4402759206679.0
MN,Revenues,4111965607045.0
MI,Revenues,3797917127685.0
PA,Revenues,3444580657882.0
AR,Revenues,3211537250000.0
IL,SalesRevenueNet,3192077861317.0
WA,SalesRevenueNet,3169244278557.0
OH,Revenues,3141505531209.0
AR,SalesRevenueNet,3114193972306.0
NE,Revenues,3049752904916.0
NY,OperatingRevenuesNetOfProvisionsForLoanLosses,2916592000000.0
MO,Revenues,2890128724924.0703
RI,Revenues,2873619401715.0
NJ,Revenues,2809390322704.0
VA,Revenues,2532831359587.6
TX,RevenueFromContractWithCustomerExcludingAssessedTax,2441583193962.0
NY,SalesRevenueNet,2436178432331.0
GA,Revenues,2280241609912.0
MI,SalesRevenueNet,2228649877718.0
FL,Revenues,2217395748429.0
WA,RevenueFromContractWithCustomerExcludingAssessedTax,2168035504000.0
CA,RevenueFromContractWithCustomerExcludingAssessedTax,2153651393988.0
PA,SalesRevenueNet,1987453754957.0
NY,RevenuesNetOfInterestExpense,1966353887000.0
NY,SalesRevenueGoodsNet,1934152624722.0
MN,SalesRevenueNet,1798330649694.0
CT,Revenues,1790874641648.0
OH,SalesRevenueNet,1787133863810.0
OH,SalesRevenueGoodsNet,1667510524558.0
TX,SalesRevenueGoodsNet,1664754473450.0
CA,OilAndGasRevenue,1657458067000.0
MA,RevenueFromContractWithCustomerExcludingAssessedTax,1638472335926.0
NY,RevenueFromContractWithCustomerExcludingAssessedTax,1625533824037.0
NJ,SalesRevenueGoodsNet,1525240779245.0
MA,SalesRevenueNet,1495072862273.0
IL,RevenueFromContractWithCustomerExcludingAssessedTax,1442945650746.0
TX,SalesAndOtherOperatingRevenueIncludingSalesBasedTaxes,1440356000000.0
TX,RevenueFromContractWithCustomerIncludingAssessedTax,1423698043126.0
TN,Revenues,1407841188521.0
NY,Revenue,1404104913000.0
GA,RevenueFromContractWithCustomerExcludingAssessedTax,1359957967676.0
CA,RevenueFromContractWithCustomerIncludingAssessedTax,1317859858119.0
GA,SalesRevenueNet,1229525804358.0
MD,Revenues,1210052909418.0
IN,Revenues,1205320519283.0
NC,SalesRevenueNet,1203683365390.0
CO,Revenues,1192332677538.0
NC,Revenues,1190151915087.0

2025-01-27 03:23:11 - root - INFO - SQL:
SELECT n.`measure_tag`, mt.`tag_label`, COUNT(*) AS `usage_count`
FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
JOIN `bigquery-public-data.sec_quarterly_financials.measure_tag` AS mt
  ON n.`measure_tag` = mt.`measure_tag`
WHERE n.`number_of_quarters` = 4
  AND n.`period_end_date` BETWEEN 20160101 AND 20161231
  AND mt.`tag_label` IS NOT NULL
  AND LOWER(mt.`tag_label`) LIKE '%revenue%'
GROUP BY n.`measure_tag`, mt.`tag_label`
ORDER BY `usage_count` DESC
LIMIT 100
Results:
measure_tag,tag_label,usage_count
Revenues,Revenues,5346627
Revenue,Revenue,2409456
SalesRevenueNet,"Revenue, Net",1716720
RevenueFromContractWithCustomerExcludingAssessedTax,"Revenue from Contract with Customer, Excluding Assessed Tax",1029488
SalesRevenueGoodsNet,"Sales Revenue, Goods, Net",808037
CostOfRevenue,Cost of Revenue,650651
RevenueFromRelatedParties,Revenue from Related Parties,579866
IncreaseDecreaseInDeferredRevenue,Increase (Decrease) in Deferred Revenue,415584
SalesRevenueNet,"Sales Revenue, Net",400568
SalesRevenueServicesNet,"Sales Revenue, Services, Net",354342
RevenueFromContractWithCustomerExcludingAssessedTax,"Revenue From Contract With Customer, Excluding Assessed Tax",328560
SalesRevenueNet,"Revenue, Net (Deprecated 2018-01-31)",257508
SalesRevenueNet,"Revenue, Net""",257508
BusinessAcquisitionsProFormaRevenue,"Business Acquisition, Pro Forma Revenue",226560
OperatingLeasesIncomeStatementLeaseRevenue,"Operating Leases, Income Statement, Lease Revenue",217872
OtherRevenue,Other Revenue,198747
Revenue,TOTAL REVENUE {1},192304
RevenueFromContractWithCustomerExcludingAssessedTax,Revenue From Contract With Customer Excluding Assessed Tax,175232
RevenueFromContractWithCustomerIncludingAssessedTax,"Revenue from Contract with Customer, Including Assessed Tax",168399
DisposalGroupIncludingDiscontinuedOperationRevenue,"Disposal Group, Including Discontinued Operation, Revenue",167244
Revenues,Revenue,155727
PercentageOfTotalRevenue,Percentage Of Total Revenue,154128
RevenueFromContractWithCustomerExcludingAssessedTax,"Revenue from Contract with Customer, Excluding Assessed Tax""",153328
EquityMethodInvestmentSummarizedFinancialInformationRevenue,"Equity Method Investment, Summarized Financial Information, Revenue",143045
SalesRevenueGoodsNet,"Sales Revenue, Goods, Net (Deprecated 2018-01-31)",110690
OtherSalesRevenueNet,"Other Revenue, Net",105735
SalesRevenueGoodsNet,"Sales Revenue, Goods, Net""",99621
BusinessCombinationProFormaInformationRevenueOfAcquireeSinceAcquisitionDateActual,"Business Combination, Pro Forma Information, Revenue of Acquiree since Acquisition Date, Actual",86016
Revenue,Revenue {2},79184
Revenue,Revenue (Income Statement),67872
RealEstateRevenueNet,"Real Estate Revenue, Net",67344
RevenueFromContractWithCustomerExcludingAssessedTax,RevenueFromContractWithCustomerExcludingAssessedTax,65712
RelatedPartyTransactionOtherRevenuesFromTransactionsWithRelatedParty,"Related Party Transaction, Other Revenues from Transactions with Related Party",59644
OtherRevenue,Other revenue,58455
Revenue,Revenue:,56560
ManagementFeesRevenue,Management Fees Revenue,54362
LicensesRevenue,Licenses Revenue,53430
RoyaltyRevenue,Royalty Revenue,51376
ContractsRevenue,Contracts Revenue,51200
RevenuesNetOfInterestExpense,"Revenues, Net of Interest Expense",48204
Revenue,Revenue {1},45248
Revenue,Revenue [Default Label],45248
Revenue,Revenues,45248
PercentageOfRevenue,Percentage Of Revenue,41976

2025-01-27 03:23:11 - root - INFO - itercount: 0
2025-01-27 03:23:11 - root - INFO - Database Name: bigquery-public-data
Schema Name: sec_quarterly_financials
DDL describes table information.
,0
table_name,rendering
ddl,"CREATE TABLE `bigquery-public-data.sec_quarterly_financials.rendering`
(
  submission_number STRING NOT NULL OPTIONS(description=""Accession Number. The 20-character string formed from the 18-digit number assigned by the Commission to each EDGAR submission. submission_number: [adsh]""),
  report INT64 NOT NULL OPTIONS(description=""Represents the report grouping. The numeric value refers to the \\\""R file\\\"" as computed by the renderer and posted on the EDGAR website. Note that in some situations the numbers skip.""),
  file_type STRING OPTIONS(description=""The type of interactive data file rendered on the EDGAR website, H = .htm file, X = .xml file. file_type: [rfile]""),
  menu_category STRING OPTIONS(description=""If available, one of the menu categories as computed by the renderer: C=Cover, S=Statements, N=Notes, P=Policies, T=Tables, D=Details, O=Other, and U=Uncategorized. menu_category: [menucat]""),
  shortname STRING OPTIONS(description=""The portion of the long name used in the renderer menu.""),
  longname STRING OPTIONS(description=""The space-normalized text of the XBRL link \\\""definition\\\"" element content.""),
  roleuri STRING OPTIONS(description=""The XBRL \\\""roleuri\\\"" of the role.""),
  parentroleuri STRING OPTIONS(description=""The XBRL roleuri of a role for which this role has a matching shortname prefix and a higher level menu category, as computed by the renderer.""),
  parentreport INT64 OPTIONS(description=""The value of the report field for the role where roleuri equals this parentroleuri.""),
  ultimate_parent_report INT64 OPTIONS(description=""The highest ancestor report reachable by following parentreport relationships. A note (menucat = N) is its own ultimate parent. ultimate_parent_report: [ultparentrpt]"")
)
PARTITION BY DATE(_PARTITIONTIME);"

,1
table_name,numbers
ddl,"CREATE TABLE `bigquery-public-data.sec_quarterly_financials.numbers`
(
  submission_number STRING NOT NULL OPTIONS(description=""Accession Number. The 20-character string formed from the 18-digit number assigned by the Commission to each EDGAR submission. submission_number: [adsh]""),
  company_name STRING OPTIONS(description=""Name of registrant from the submission table. This corresponds to the name of the legal entity as recorded in EDGAR as of the filing date.""),
  measure_tag STRING NOT NULL OPTIONS(description=""The unique identifier (name) for a tag in a specific taxonomy release. measure_tag: [tag]""),
  version STRING NOT NULL OPTIONS(description=""For a standard tag, an identifier for the taxonomy; otherwise the accession number where the tag was defined.""),
  period_end_date INT64 NOT NULL OPTIONS(description=""The end date for the data value, rounded to the nearest month end. period_end_date: [ddate]""),
  number_of_quarters INT64 NOT NULL OPTIONS(description=""The count of the number of quarters represented by the data value, rounded to the nearest whole number. \\\""0\\\"" indicates it is a point-in-time value. number_of_quarters: [qtrs]""),
  units STRING NOT NULL OPTIONS(description=""The unit of measure for the value. units: [uom]""),
  dimension_hash STRING NOT NULL OPTIONS(description=""The 32-byte hexadecimal key for the dimensional information in the DIM data set. dimension_hash: [dimh]""),
  iprx INT64 NOT NULL OPTIONS(description=""A positive integer to distinguish different reported facts that otherwise would have the same primary key. For most purposes, data with iprx greater than 1 are not needed. The priority for the fact based on higher precision, closeness of the end date to a month end, and closeness of the duration to a multiple of three months. See fields dcml, durp and datp below.""),
  value FLOAT64 OPTIONS(description=""The value. This is not scaled, it is as found in the Interactive Data file, but is rounded to four digits to the right of the decimal point.""),
  footnote STRING OPTIONS(description=""The plain text of any superscripted footnotes on the value, if any, as shown on the statement page, truncated to 512 characters.""),
  footnote_length INT64 OPTIONS(description=""Number of bytes in the plain text of the footnote prior to truncation; zero if no footnote. footnote_length: [footlen]""),
  num_dimensions INT64 OPTIONS(description=""Small integer representing the number of dimensions. Note that this value is a function of the dimension segments. num_dimensions: [dimn]""),
  coregistrant STRING OPTIONS(description=""If specified, indicates a specific co-registrant, the parent company, or other entity (e.g., guarantor). NULL indicates the consolidated entity. Note that this value is a function of the dimension segments. coregistrant: [coreg]""),
  duration_fraction FLOAT64 OPTIONS(description=""The difference between the reported fact duration and the quarter duration (qtrs), expressed as a fraction of 1. For example, a fact with duration of 120 days rounded to a 91-day quarter has a durp value of 29/91 = +0.3187. duration_fraction: [durp]""),
  date_fraction FLOAT64 OPTIONS(description=""The difference between the reported fact date and the month-end rounded date (ddate), expressed as a fraction of 1. For example, a fact reported for 29/Dec, with ddate rounded to 31/Dec, has a datp value of minus 2/31 = -0.0645. date_fraction: [datp]""),
  decimal INT64 OPTIONS(description=""The value of the fact \\\""decimals\\\"" attribute, with INF represented by 32767. decimal: [dcml]"")
)
PARTITION BY DATE(_PARTITIONTIME);"

,2
table_name,sic_codes
ddl,"CREATE TABLE `bigquery-public-data.sec_quarterly_financials.sic_codes`
(
  sic_code STRING,
  ad_office STRING,
  industry_title STRING
);"

,3
table_name,presentation
ddl,"CREATE TABLE `bigquery-public-data.sec_quarterly_financials.presentation`
(
  submission_number STRING NOT NULL OPTIONS(description=""Accession Number. The 20-character string formed from the 18-digit number assigned by the Commission to each EDGAR submission. submission_number: [adsh]""),
  report INT64 NOT NULL OPTIONS(description=""Represents the report grouping. The numeric value refers to the \\\""R file\\\"" as computed by the renderer and posted on the EDGAR website. Note that in some situations the numbers skip.""),
  line INT64 NOT NULL OPTIONS(description=""Represents the tag's presentation line order for a given report. Together with the statement and report field, presentation location, order and grouping can be derived.""),
  statement STRING OPTIONS(description=""The financial statement location to which the value of the \\\""report\\\"" field pertains. statement: [stmt]""),
  presented_parenthetically BOOL OPTIONS(description=""1 indicates that the value was presented \\\""parenthetically\\\"" instead of in fields within the financial statements. For example: Receivables (net of allowance for bad debts of USD 200 in 2012) USD 700 presented_parenthetically: [inpth]""),
  rfile STRING OPTIONS(description=""The type of interactive data file rendered on the EDGAR website, H = .htm file, X = .xml file.""),
  measure_tag STRING OPTIONS(description=""The tag chosen by the filer for this line item. measure_tag: [tag]""),
  version STRING OPTIONS(description=""The taxonomy identifier if the tag is a standard tag, otherwise adsh.""),
  preferred_role STRING OPTIONS(description=""The XBRL link \\\""role\\\"" of the preferred label, using only the portion of the role URI after the last \\\""/\\\"". preferred_role: [prole]""),
  preferred_label STRING OPTIONS(description=""The text presented on the line item, also known as a \\\""preferred\\\"" label. preferred_label: [plabel]""),
  negating BOOL OPTIONS(description=""Flag to indicate whether the prole is treated as negating by the renderer."")
)
PARTITION BY DATE(_PARTITIONTIME);"

,4
table_name,dimension
ddl,"CREATE TABLE `bigquery-public-data.sec_quarterly_financials.dimension`
(
  segments_hash STRING NOT NULL OPTIONS(description=""MD5 hash of the segments field text. Although MD5 is unsuitable for cryptographic use, it is used here merely to limit the size of the primary key. segments_hash: [dimhash]""),
  segments STRING OPTIONS(description=""Concatenation of tag names representing the axis and members appearing in the XBRL segments. Tag names have their first characters \\\""Statement\\\"", last 4 characters \\\""Axis\\\"", and last 6 characters \\\""Member\\\"" or \\\""Domain\\\"" truncated where they appear. Namespaces and prefixes are ignored because EDGAR validation guarantees that the local-names are unique with a submission. Each dimension is represented as the pair \\\""{axis}={member};\\\"" and the axes concatenated in lexical order. Example: \\\""LegalEntity=Xyz;Scenario=Restated;\\\"" represents the XBRL segment with dimension LegalEntityAxis and member XyzMember, dimension StatementScenarioAxis and member RestatedMember.""),
  segment_truncation BOOL OPTIONS(description=""TRUE if the segments field would have been longer than 1024 characters had it not been truncated, else FALSE. segment_truncation: [segt]"")
)
PARTITION BY DATE(_PARTITIONTIME);"

,5
table_name,measure_tag
ddl,"CREATE TABLE `bigquery-public-data.sec_quarterly_financials.measure_tag`
(
  measure_tag STRING NOT NULL OPTIONS(description=""The unique identifier (name) for a tag in a specific taxonomy release. measure_tag:[tag]""),
  version STRING NOT NULL OPTIONS(description=""For a standard tag, an identifier for the taxonomy; otherwise the accession number where the tag was defined.""),
  custom BOOL OPTIONS(description=""1 if tag is custom (version=adsh), 0 if it is standard. Note: This flag is technically redundant with the version and adsh fields.""),
  abstract BOOL OPTIONS(description=""1 if the tag is not used to represent a numeric fact.""),
  datatype STRING OPTIONS(description=""If abstract=1, then NULL, otherwise the data type (e.g., monetary) for the tag.""),
  i_or_d STRING OPTIONS(description=""If abstract=1, then NULL; otherwise, I if the value is a point in time, or D if the value is a duration. i_or_d: [iord]""),
  credit_or_debit STRING OPTIONS(description=""If datatype = monetary, then the tag's natural accounting balance from the perspective of the balance sheet or income statement (debit or credit); if not defined, then NULL. credit_or_debit: [crdr]""),
  tag_label STRING OPTIONS(description=""If a standard tag, then the label text provided by the taxonomy, otherwise the text provided by the filer. A tag which had neither would have a NULL value here. tag_label: [tlabel]""),
  doc STRING OPTIONS(description=""The detailed definition for the tag, truncated to 2048 characters. If a standard tag, then the text provided by the taxonomy, otherwise the text assigned by the filer. Some tags have neither, in which case this field is NULL."")
)
PARTITION BY DATE(_PARTITIONTIME);"

,6
table_name,quick_summary
ddl,"CREATE TABLE `bigquery-public-data.sec_quarterly_financials.quick_summary`
(
  submission_number STRING NOT NULL OPTIONS(description=""Accession Number. The 20-character string formed from the 18-digit number assigned by the Commission to each EDGAR submission. submission_number: [adsh]""),
  company_name STRING OPTIONS(description=""Name of registrant from the submission table. This corresponds to the name of the legal entity as recorded in EDGAR as of the filing date.""),
  measure_tag STRING NOT NULL OPTIONS(description=""The unique identifier (name) for a tag in a specific taxonomy release. measure_tag: [tag]""),
  period_end_date STRING NOT NULL OPTIONS(description=""The end date for the data value, rounded to the nearest month end. period_end_date: [ddate]""),
  value FLOAT64 OPTIONS(description=""The value. This is not scaled, it is as found in the Interactive Data file, but is rounded to four digits to the right of the decimal point.""),
  units STRING NOT NULL OPTIONS(description=""The unit of measure for the value. units: [uom]""),
  number_of_quarters INT64 NOT NULL OPTIONS(description=""The count of the number of quarters represented by the data value, rounded to the nearest whole number. \\\""0\\\"" indicates it is a point-in-time value. number_of_quarters: [qtrs]""),
  version STRING NOT NULL OPTIONS(description=""For a standard tag, an identifier for the taxonomy; otherwise the accession number where the tag was defined.""),
  central_index_key INT64 OPTIONS(description=""Central Index Key (CIK). Ten digit number assigned by the Commission to each registrant that submits filings. central_index_key: [cik]""),
  ein STRING OPTIONS(description=""Employee Identification Number, 9 digit identification number assigned by the Internal Revenue Service to business entities operating in the United States.""),
  sic STRING OPTIONS(description=""Standard Industrial Classification (SIC). Four digit code assigned by the Commission as of the filing date, indicating the registrant's type of business.""),
  fiscal_year_end STRING OPTIONS(description=""Fiscal Year End Date. fiscal_year_end: [fye]""),
  form STRING OPTIONS(description=""The submission type of the registrant's filing.""),
  fiscal_year INT64 OPTIONS(description=""Fiscal Year Focus (as defined in EFM Ch. 6). fiscal_year: [fy]""),
  fiscal_period_focus STRING OPTIONS(description=""Fiscal Period Focus (as defined in EFM Ch. 6) within Fiscal Year. The 10-Q for the 1st, 2nd and 3rd quarters would have a fiscal period focus of Q1, Q2 (or H1), and Q3 (or M9) respectively, and a 10-K would have a fiscal period focus of FY. fiscal_period_focus: [fp]""),
  date_filed INT64 OPTIONS(description=""The date of the registrant's filing with the Commission. date_filed: [filed]""),
  date_accepted TIMESTAMP OPTIONS(description=""The acceptance date and time of the registrant's filing with the Commission. Filings accepted after 5:30pm EST are considered filed on the following business day. date_accepted: [accepted]"")
)
PARTITION BY DATE(_PARTITIONTIME);"

,7
table_name,calculation
ddl,"CREATE TABLE `bigquery-public-data.sec_quarterly_financials.calculation`
(
  submission_number STRING NOT NULL OPTIONS(description=""Accession Number. The 20-character string formed from the 18-digit number assigned by the Commission to each EDGAR submission. submission_number: [adsh]""),
  `group` INT64 NOT NULL OPTIONS(description=""Sequential number for grouping arcs in a submission. group: [grp]""),
  arc INT64 NOT NULL OPTIONS(description=""Sequential number for arcs within a group in a submission.""),
  negative INT64 OPTIONS(description=""Indicates a weight of -1 (TRUE if the arc is negative), but typically +1 (FALSE).""),
  parent_tag STRING OPTIONS(description=""The tag for the parent of the arc parent_tag: [ptag]""),
  parent_version STRING OPTIONS(description=""The version of the tag for the parent of the arc parent_version: [pversion]""),
  child_tag STRING OPTIONS(description=""The tag for the child of the arc child_tag: [ctag]""),
  child_version STRING OPTIONS(description=""The version of the tag for the child of the arc child_version: [cversion]"")
)
PARTITION BY DATE(_PARTITIONTIME);"

,8
table_name,submission
ddl,"CREATE TABLE `bigquery-public-data.sec_quarterly_financials.submission`
(
  submission_number STRING NOT NULL OPTIONS(description=""Accession Number. The 20-character string formed from the 18-digit number assigned by the Commission to each EDGAR submission. submission_number: [adsh]""),
  central_index_key INT64 OPTIONS(description=""Central Index Key (CIK). Ten digit number assigned by the Commission to each registrant that submits filings. central_index_key: [cik]""),
  company_name STRING OPTIONS(description=""Name of registrant. This corresponds to the name of the legal entity as recorded in EDGAR as of the filing date. company_name: [name]""),
  sic STRING OPTIONS(description=""Standard Industrial Classification (SIC). Four digit code assigned by the Commission as of the filing date, indicating the registrant's type of business.""),
  countryba STRING OPTIONS(description=""The ISO 3166-1 country of the registrant's business address.""),
  stprba STRING OPTIONS(description=""The state or province of the registrant's business address, if field countryba is US or CA.""),
  cityba STRING OPTIONS(description=""The city of the registrant's business address.""),
  zipba STRING OPTIONS(description=""The zip code of the registrant's business address.""),
  ba_street1 STRING OPTIONS(description=""The first line of the street of the registrant's business address. ba_street1: [bas1]""),
  ba_street2 STRING OPTIONS(description=""The second line of the street of the registrant's business address. ba_street2: [bas2]""),
  ba_phone STRING OPTIONS(description=""The phone number of the registrant's business address. ba_phone: [baph]""),
  countryma STRING OPTIONS(description=""The ISO 3166-1 country of the registrant's mailing address.""),
  stprma STRING OPTIONS(description=""The state or province of the registrant's mailing address, if field countryma is US or CA.""),
  cityma STRING OPTIONS(description=""The city of the registrant's mailing address.""),
  zipma STRING OPTIONS(description=""The zip code of the registrant's mailing address.""),
  ma_street1 STRING OPTIONS(description=""The first line of the street of the registrant's mailing address. ma_street1: [mas1]""),
  ma_street2 STRING OPTIONS(description=""The second line of the street of the registrant's mailing address. ma_street2: [mas2]""),
  country_inc STRING OPTIONS(description=""The country of incorporation for the registrant. country_inc: [countryinc]""),
  state_province_inc STRING OPTIONS(description=""The state or province of incorporation for the registrant, if countryinc is US or CA, otherwise NULL. state_province_inc: [stprinc]""),
  ein STRING OPTIONS(description=""Employee Identification Number, 9 digit identification number assigned by the Internal Revenue Service to business entities operating in the United States.""),
  former_name STRING OPTIONS(description=""Most recent former name of the registrant, if any. former_name: [former]""),
  date_changed INT64 OPTIONS(description=""Date of change from the former name, if any. date_changed: [changed]""),
  filer_status STRING OPTIONS(description=""Filer status with the Commission at the time of submission: 1-LAF=Large Accelerated, 2-ACC=Accelerated, 3-SRA=Smaller Reporting Accelerated, 4-NON=Non-Accelerated, 5-SML=Smaller Reporting Filer, NULL=not assigned. filer_status: [afs]""),
  well_known_seasoned_issuer BOOL OPTIONS(description=""Well Known Seasoned Issuer (WKSI). An issuer that meets specific Commission requirements at some point during a 60-day period preceding the date the issuer satisfies its obligation to update its shelf registration statement. well_known_seasoned_issuer: [wksi]""),
  fiscal_year_end STRING OPTIONS(description=""Fiscal Year End Date. fiscal_year_end: [fye]""),
  form STRING OPTIONS(description=""The submission type of the registrant's filing.""),
  period INT64 OPTIONS(description=""Balance Sheet Date.""),
  fiscal_year INT64 OPTIONS(description=""Fiscal Year Focus (as defined in EFM Ch. 6). fiscal_year: [fy]""),
  fiscal_period_focus STRING OPTIONS(description=""Fiscal Period Focus (as defined in EFM Ch. 6) within Fiscal Year. The 10-Q for the 1st, 2nd and 3rd quarters would have a fiscal period focus of Q1, Q2 (or H1), and Q3 (or M9) respectively, and a 10-K would have a fiscal period focus of FY. fiscal_period_focus: [fp]""),
  date_filed INT64 OPTIONS(description=""The date of the registrant's filing with the Commission. date_filed: [filed]""),
  date_accepted TIMESTAMP OPTIONS(description=""The acceptance date and time of the registrant's filing with the Commission. Filings accepted after 5:30pm EST are considered filed on the following business day. date_accepted: [accepted]""),
  has_previous_report BOOL OPTIONS(description=""Previous Report.  TRUE indicates that the submission information was subsequently amended prior to the end cutoff date of the data set. \""has_previous_report: [prevrpt]""),
  has_required_detail BOOL OPTIONS(description=""TRUE indicates that the XBRL submission contains quantitative disclosures within the footnotes and schedules at the required detail level (e.g., each amount). has_required_detail: [detail]""),
  instance STRING OPTIONS(description=""The name of the submitted XBRL Instance Document (EX-101.INS) type data file. The name often begins with the company ticker symbol.""),
  num_ciks INT64 OPTIONS(description=""Number of Central Index Keys (CIK) of registrants (i.e., business units) included in the consolidating entity's submitted filing. num_ciks: [nciks]""),
  additional_ciks STRING OPTIONS(description=""Additional CIKs of co-registrants included in a consolidating entity's EDGAR submission, separated by spaces. If there are no other co-registrants (i.e., nciks = 1), the value of aciks is NULL. For a very small number of filers, the list of co-registrants is too long to fit in the field. Where this is the case, PARTIAL will appear at the end of the list indicating that not all co-registrants' CIKs are included in the field; users should refer to the complete submission file for all CIK information. additional_ciks: [aciks]""),
  public_float_usd FLOAT64 OPTIONS(description=""Public float, in USD, if provided in this submission. public_float_usd: [pubfloatusd]""),
  float_date INT64 OPTIONS(description=""Date on which the public float was measured by the filer. float_date: [floatdate]""),
  float_axis STRING OPTIONS(description=""If the public float value was computed by summing across several tagged values, this indicates the nature of the summation. float_axis: [floataxis]""),
  float_terms INT64 OPTIONS(description=""If the public float was computed, the number of terms in the summation. float_terms: [floatmems]"")
)
PARTITION BY DATE(_PARTITIONTIME);"

,9
table_name,txt
ddl,"CREATE TABLE `bigquery-public-data.sec_quarterly_financials.txt`
(
  submission_number STRING NOT NULL OPTIONS(description=""Accession Number. The 20-character string formed from the 18-digit number assigned by the Commission to each EDGAR submission. submission_number: [adsh]""),
  measure_tag STRING NOT NULL OPTIONS(description=""The unique identifier (name) for a tag in a specific taxonomy release. measure_tag: [tag]""),
  version STRING NOT NULL OPTIONS(description=""For a standard tag, an identifier for the taxonomy; otherwise the accession number where the tag was defined. For example, \\\""invest/2013\\\"" indicates that the tag is defined in the 2013 INVEST taxonomy.""),
  period_end_date INT64 NOT NULL OPTIONS(description=""The end date for the data value, rounded to the nearest month end. period_end_date:[ddate]""),
  num_quarters INT64 NOT NULL OPTIONS(description=""The count of the number of quarters represented by the data value, rounded to the nearest whole number. A point in time value is represented by 0. num_quarters:[qtrs]""),
  iprx INT64 NOT NULL OPTIONS(description=""A positive integer to distinguish different reported facts that otherwise would have the same primary key. For most purposes, data with iprx greater than 1 are not needed. The priority for the fact based on higher precision, closeness of the end date to a month end, and closeness of the duration to a multiple of three months. See fields dcml, durp and datp below.""),
  language STRING OPTIONS(description=""The ISO language code of the fact content. language:[lang]""),
  language_decimal INT64 OPTIONS(description=""The value of the fact \\\""xml:lang\\\"" attribute, en-US represented by 32767, other \\\""en\\\"" dialects having lower values, and other languages lower still. language_decimal: [dcml]""),
  duration_fraction FLOAT64 OPTIONS(description=""The difference between the reported fact duration and the quarter duration (qtrs), expressed as a fraction of 1. For example, a fact with duration of 120 days rounded to a 91-day quarter has a durp value of 29/91 = +0.3187. duration_fraction: [durp]""),
  date_fraction FLOAT64 OPTIONS(description=""The difference between the reported fact date and the month-end rounded date (ddate), expressed as a fraction of 1. For example, a fact reported for 29/Dec, with ddate rounded to 31/Dec, has a datp value of minus 2/31 = -0.0645. date_fraction: [datp]""),
  dimension_hash STRING OPTIONS(description=""The 32-byte hexadecimal key for the dimensional information in the DIM data set. dimension_hash: [dimh]""),
  num_dimensions INT64 OPTIONS(description=""Small integer representing the number of dimensions, useful for sorting. Note that this value is function of the dimension segments. num_dimensions: [dimn]""),
  coregistrant STRING OPTIONS(description=""If specified, indicates a specific co-registrant, the parent company, or other entity (e.g., guarantor). NULL indicates the consolidated entity. Note that this value is a function of the dimension segments. coregistrant: [coreg]""),
  escaped BOOL OPTIONS(description=""Flag indicating whether the value has had tags removed.""),
  source_length INT64 OPTIONS(description=""Number of bytes in the original, unprocessed value. Zero indicates a NULL value. source_length: [srclen]""),
  text_length INT64 OPTIONS(description=""The original length of the whitespace normalized value, which may have been greater than 8192. text_length: [txtlen]""),
  footnote STRING OPTIONS(description=""The plain text of any superscripted footnotes on the value, as shown on the page, truncated to 512 characters, or if there is no footnote, then this field will be blank.""),
  footnote_length INT64 OPTIONS(description=""Number of bytes in the plain text of the footnote prior to truncation. footnote_length: [footlen]""),
  context STRING OPTIONS(description=""The value of the contextRef attribute in the source XBRL document, which can be used to recover the original HTML tagging if desired.""),
  value STRING OPTIONS(description=""The value, with all whitespace normalized, that is, all sequences of line feeds, carriage returns, tabs, non-breaking spaces, and spaces having been collapsed to a single space, and no leading or trailing spaces. Escaped XML that appears in EDGAR \\\""Text Block\\\"" tags is processed to remove all mark-up (comments, processing instructions, elements, attributes). The value is truncated to a maximum number of bytes. The resulting text is not intended for end user display but only for text analysis applications."")
)
PARTITION BY DATE(_PARTITIONTIME);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'sec_quarterly_financials': ['calculation', 'dimension', 'measure_tag', 'numbers', 'presentation', 'quick_summary', 'rendering', 'sic_codes', 'submission', 'txt']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table:** `bigquery-public-data.sec_quarterly_financials.numbers`
  - `measure_tag`: To identify revenue measures.
  - `value`: The revenue amount.
  - `submission_number`: To link to the `submission` table.
  - `period_end_date`: To filter for the year 2016.
  - `number_of_quarters`: To ensure data covers all four quarters (annual data).

- **Table:** `bigquery-public-data.sec_quarterly_financials.submission`
  - `submission_number`: To link from the `numbers` table.
  - `stprba`: State or province of the registrant's business address (U.S. state).
  - `countryba`: To filter for U.S. companies (`'US'`).

- **Table:** `bigquery-public-data.sec_quarterly_financials.measure_tag`
  - `measure_tag`: To identify revenue tags.
  - `tag_label`: Human-readable labels to help identify revenue-related tags.

**Conditions to be Used:**

- `numbers.period_end_date` between `20160101` and `20161231` (year 2016).
- `numbers.number_of_quarters` = `4` (annual data).
- `submission.countryba` = `'US'` (U.S. companies).
- Filter `measure_tag` to include revenue-related tags (e.g., tags containing `'Revenue'`).

---

**SQL Queries:**

1. **List distinct `measure_tag` values from the `numbers` table:**
   ```sql
   SELECT DISTINCT `measure_tag`
   FROM `bigquery-public-data.sec_quarterly_financials.numbers`
   LIMIT 100;
   ```

2. **Retrieve `measure_tag` and `tag_label` from `measure_tag` table where `tag_label` contains 'Revenue':**
   ```sql
   SELECT `measure_tag`, `tag_label`
   FROM `bigquery-public-data.sec_quarterly_financials.measure_tag`
   WHERE LOWER(`tag_label`) LIKE '%revenue%'
   LIMIT 100;
   ```

3. **List distinct U.S. state codes (`stprba`) from the `submission` table:**
   ```sql
   SELECT DISTINCT `stprba`
   FROM `bigquery-public-data.sec_quarterly_financials.submission`
   WHERE `countryba` = 'US'
   LIMIT 100;
   ```

4. **Get company names and state codes for submissions filed in 2016:**
   ```sql
   SELECT DISTINCT `company_name`, `stprba`
   FROM `bigquery-public-data.sec_quarterly_financials.submission`
   WHERE CAST(SUBSTR(CAST(`date_filed` AS STRING), 1, 4) AS INT64) = 2016
   LIMIT 100;
   ```

5. **Join `numbers` and `submission` tables to get financial values along with company state:**
   ```sql
   SELECT n.`value`, s.`stprba`, n.`measure_tag`
   FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
   JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
   ON n.`submission_number` = s.`submission_number`
   LIMIT 100;
   ```

6. **Filter `numbers` for annual data in 2016:**
   ```sql
   SELECT n.`submission_number`, n.`value`, n.`measure_tag`, n.`period_end_date`
   FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
   WHERE n.`number_of_quarters` = 4
     AND n.`period_end_date` BETWEEN 20160101 AND 20161231
   LIMIT 100;
   ```

7. **Join `numbers` and `submission` tables for U.S. companies with annual data in 2016:**
   ```sql
   SELECT n.`value`, s.`stprba`, s.`company_name`, n.`measure_tag`
   FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
   JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
   ON n.`submission_number` = s.`submission_number`
   WHERE n.`number_of_quarters` = 4
     AND n.`period_end_date` BETWEEN 20160101 AND 20161231
     AND s.`countryba` = 'US'
   LIMIT 100;
   ```

8. **Identify revenue-related `measure_tag` values and their labels:**
   ```sql
   SELECT DISTINCT mt.`measure_tag`, mt.`tag_label`
   FROM `bigquery-public-data.sec_quarterly_financials.measure_tag` AS mt
   WHERE LOWER(mt.`tag_label`) LIKE '%revenue%'
   LIMIT 100;
   ```

9. **Get top 100 revenue values across U.S. companies in 2016:**
   ```sql
   SELECT n.`submission_number`, n.`value`, n.`measure_tag`, s.`company_name`, s.`stprba`
   FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
   JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
   ON n.`submission_number` = s.`submission_number`
   WHERE n.`number_of_quarters` = 4
     AND n.`period_end_date` BETWEEN 20160101 AND 20161231
     AND s.`countryba` = 'US'
     AND n.`measure_tag` IN (
       SELECT `measure_tag`
       FROM `bigquery-public-data.sec_quarterly_financials.measure_tag`
       WHERE LOWER(`tag_label`) LIKE '%revenue%'
     )
   ORDER BY n.`value` DESC
   LIMIT 100;
   ```

10. **Calculate total annual revenue per U.S. state in 2016:**
    ```sql
    SELECT s.`stprba`, SUM(n.`value`) AS `total_revenue`
    FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
    JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
    ON n.`submission_number` = s.`submission_number`
    WHERE n.`number_of_quarters` = 4
      AND n.`period_end_date` BETWEEN 20160101 AND 20161231
      AND s.`countryba` = 'US'
      AND n.`measure_tag` IN (
        SELECT `measure_tag`
        FROM `bigquery-public-data.sec_quarterly_financials.measure_tag`
        WHERE LOWER(`tag_label`) LIKE '%revenue%'
      )
    GROUP BY s.`stprba`
    ORDER BY `total_revenue` DESC
    LIMIT 100;
    ```

11. **Retrieve detailed revenue information including `tag_label` for companies in 2016:**
    ```sql
    SELECT n.`submission_number`, s.`company_name`, s.`stprba`, n.`value`, mt.`tag_label`
    FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
    JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
      ON n.`submission_number` = s.`submission_number`
    JOIN `bigquery-public-data.sec_quarterly_financials.measure_tag` AS mt
      ON n.`measure_tag` = mt.`measure_tag`
    WHERE n.`number_of_quarters` = 4
      AND n.`period_end_date` BETWEEN 20160101 AND 20161231
      AND s.`countryba` = 'US'
      AND LOWER(mt.`tag_label`) LIKE '%revenue%'
    LIMIT 100;
    ```

12. **Identify companies with the highest reported revenue in 2016:**
    ```sql
    SELECT s.`company_name`, s.`stprba`, MAX(n.`value`) AS `max_revenue`
    FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
    JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
      ON n.`submission_number` = s.`submission_number`
    WHERE n.`number_of_quarters` = 4
      AND n.`period_end_date` BETWEEN 20160101 AND 20161231
      AND s.`countryba` = 'US'
      AND n.`measure_tag` IN (
        SELECT `measure_tag`
        FROM `bigquery-public-data.sec_quarterly_financials.measure_tag`
        WHERE LOWER(`tag_label`) LIKE '%revenue%'
      )
    GROUP BY s.`company_name`, s.`stprba`
    ORDER BY `max_revenue` DESC
    LIMIT 100;
    ```

13. **Find the average revenue per state in 2016:**
    ```sql
    SELECT s.`stprba`, AVG(n.`value`) AS `average_revenue`
    FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
    JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
      ON n.`submission_number` = s.`submission_number`
    WHERE n.`number_of_quarters` = 4
      AND n.`period_end_date` BETWEEN 20160101 AND 20161231
      AND s.`countryba` = 'US'
      AND n.`measure_tag` IN (
        SELECT `measure_tag`
        FROM `bigquery-public-data.sec_quarterly_financials.measure_tag`
        WHERE LOWER(`tag_label`) LIKE '%revenue%'
      )
    GROUP BY s.`stprba`
    ORDER BY `average_revenue` DESC
    LIMIT 100;
    ```

14. **Get revenue data by main categories (using `measure_tag`) for U.S. states in 2016:**
    ```sql
    SELECT s.`stprba`, n.`measure_tag`, SUM(n.`value`) AS `total_revenue`
    FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
    JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
      ON n.`submission_number` = s.`submission_number`
    WHERE n.`number_of_quarters` = 4
      AND n.`period_end_date` BETWEEN 20160101 AND 20161231
      AND s.`countryba` = 'US'
      AND n.`measure_tag` IN (
        SELECT `measure_tag`
        FROM `bigquery-public-data.sec_quarterly_financials.measure_tag`
        WHERE LOWER(`tag_label`) LIKE '%revenue%'
      )
    GROUP BY s.`stprba`, n.`measure_tag`
    ORDER BY `total_revenue` DESC
    LIMIT 100;
    ```

15. **List the top revenue measure tags used by companies in 2016:**
    ```sql
    SELECT n.`measure_tag`, mt.`tag_label`, COUNT(*) AS `usage_count`
    FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
    JOIN `bigquery-public-data.sec_quarterly_financials.measure_tag` AS mt
      ON n.`measure_tag` = mt.`measure_tag`
    WHERE n.`number_of_quarters` = 4
      AND n.`period_end_date` BETWEEN 20160101 AND 20161231
      AND LOWER(mt.`tag_label`) LIKE '%revenue%'
    GROUP BY n.`measure_tag`, mt.`tag_label`
    ORDER BY `usage_count` DESC
    LIMIT 100;
    ```

---

These queries progressively explore the data to identify the highest annual revenue reported by U.S. states in 2016 across the main revenue categories and covering all four quarters.Query:
SELECT DISTINCT `measure_tag`
   FROM `bigquery-public-data.sec_quarterly_financials.numbers`
   LIMIT 100;
Answer:
measure_tag
EquityDeemedContributionDistributionRelatedToNetAssetsTransferredToNoncontrollingInterestNet
ImpairmentLossOnPrepaidLicensingAndRoyaltyFees
FairValueInputsPricingSpreadDuringPeriod
InventoryProvisionNonControllingInterest
PortionOfOilAndGasSalesLessLeaseOperatingExpensesAndProductionTaxesAllocatedToInterest
InterestAndDefaultPenaltyOfConvertibleNote
EffectiveIncomeTaxRateReconciliationExpiringStateNols
IssuancePreferredStock
CommonStockIssuedForServicesToBeReceivedInFutureShares
NetIncomeLossAllocatedToPartnership
WarrantsIssuedInConnectionWithSeriesBPreferredOffering
ValueOfCommonSharesIssuedFromStockSubscriptionsPayable
IssuedAtFairValuePursuantToDebtSettlementAgreementsAmount
DilutiveEffectOfConvertibleDebentureExcludedFromDilutedEarningsPerShareCalculation
CommonStockIssuedForInterestOnConvertibleNotesShares
FairValueMeasurementWithUnobservableInputsReconciliationRecurringBasisIntangibleAssets
FairMarketValue
ShareBasedCompensationArrangementByShareBasedPaymentAwardPerSharePriceExpired
OtherComprehensiveIncomeLossNetUnrealizedGainsLossesOnSecuritiesNetOfTaxPeriodIncreaseDecrease
Selectedrestructuringcharges
RelatedPartyTransactionsZeroTwoEightOneOneZeroHvbMHNinelTvOneMM
DeferredGovernmentGrantsZeroTwoEightFiveOneZerogVFLxThreegMHTwoQh
InterestExpenseCertificatesOfDeposits
UnrealizedGainLossOnDerivativesNumberOfWarrants
PercentageOfLowestClosingPriceIn20TradingDays
ConvertibleNotesPayableIssuedToSettleAccountsPayable
RelatedPartiesServiceFee
NumberOfCommonStockSharesPurchased
RelatedPartyTransactionFlatFee
LossContingencyNumberofLLCs
ConvertiblePromissoryNotesPayableZeroThreeOneEightSixZeroxdmzNFiveSBwsNineC
StockholdersEquityZeroThreeOneEightSixZerozSixChMcnrHTwogX
ScheduleOfDisclosureOfSharebasedCompensationArrangementsBySharebasedPaymentAwardZeroThreeTwoTwoOneZeroRcZerogEightCzOneTZeroFiveq
WarrantExpiration
NetLossForThePeriod1
ForeignCurrencyExchangeAppreciationDepreciationRate
IncreaseDecreaseInPlacementOrRolloverOfMaturedTimeDeposits
ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsExercisesWeightedAverageGrantDateFairValue
ValuationAllowanceDeferredTaxAssetChangeInAmountNoncurrent
ExpenseAndOtherIncome
SurveyCost
SecurityDepositsAndMaintenancePaymentLiabilityAppliedAsRentalsReceivedInAdvance
IncomeTaxReconciliationNonDeductibleExpenseLossOnDerivative
DeferredTaxAssetsOthers
IssuanceOfStockUnder15MPurchaseAgreement
ValuationAllowancesAndReservesCreditedToCostsAndExpenses
CompanyRaised
OtherNetIncreaseInCet1
BenchmarkPercentageOfRevenueForMajorCustomer
GainLossOnIssuanceOfWarrant
DebtInstrumentAssignmentToInvestorOne
ForeignCurrencyAdjustment1
GainOnDisposalOfPropertyPlantAndEquipment
IncrementalCommonSharesAttributableToConversionOfPreferredStockSeriesBPreferredStock
ConversionOfStockAmountConverted13
ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsForfeituresIntrinsicValue
ConvertiblePreferredStockIssuedForSeries
WarrantsIssuedInConnectionWithRedeemablePreferredStock
GainLossOnStockWarrantsRevaluation
PercentageOfConvertiblePreferredStockDividendsPayable
NumberOfFreeTradingSharesIssuedForSatisfyingDisputedObligation
AdjustmentsToAdditionalPaidInCapitalWarrantsAndOptionsIssuedForServices
AftermarketPartSalesRevenueRelatedParty
CharitableContributionAtHistoricalContributionLevels
PurchasePriceAllocationCashUsedInRetailStoreAcquisitions
ConstructionManagementFeePercentage
TotalAccumulatedOtherComprehensiveIncomeLossNetOfTax
RepaymentsOfShortTermAndLongTermDebt
AdjustmentsToAdditionalPaidInCapitalContributionWithdrawalThroughIncreaseOfDebt
StockIssuedDuringPeriodSharesDividend
MaximumTargetNumberOfSharesIssuedBasedOnStockPerformanceInPercent
OrganizationAndBusinessZeroThreeOneSixEightZeronlzHXwSevenbcTZs
Query:
SELECT `measure_tag`, `tag_label`
   FROM `bigquery-public-data.sec_quarterly_financials.measure_tag`
   WHERE LOWER(`tag_label`) LIKE '%revenue%'
   LIMIT 100;
Answer:
measure_tag,tag_label
OperatingRevenues,Operating Revenues:
RevenuesPercentageIncreaseDecreaseAbstract,Revenues Percentage Increase (Decrease) Abstract
RevenuesAndOtherIncomeAbstract,Revenues and other income Abstract
RevenuesAndOtherIncomeAbstract,Revenues and Other Income [Abstract]
RevenuesAndNonOperatingIncomeAbstract,Revenues and Non Operating Income Abstract
SalesRevenueNetPercentToNetSales,Sales Revenue Net Percent To Net Sales
BroadcastingRevenuePercentageIncreaseDecrease,Broadcasting Revenue Percentage Increase (Decrease)
DigitalRevenuePercentageIncreaseDecrease,Digital Revenue Percentage Increase (Decrease)
OtherRevenuePercentageIncreaseDecrease,Other Revenue Percentage Increase (Decrease)
PublishingAdvertisingRevenuePercentageIncreaseDecrease,Publishing Advertising Revenue Percentage Increase (Decrease)
PublishingCirculationRevenuePercentageIncreaseDecrease,Publishing Circulation Revenue Percentage Increase (Decrease)
TotalRevenuePercentageIncreaseDecrease,Total Revenue Percentage Increase (Decrease)
SalesRevenueGoodsNetPercentageIncreaseDecrease,Sales Revenue Goods Net Percentage Increase Decrease
CostOfPurchasedCoalRevenue,Cost of purchased coal revenue
PurchasedCoalRevenue,Purchased coal revenue
StockBasedCompensationExpensesAllocatedToCostOfProductRevenue,Stock Based Compensation Expenses Allocated to Cost Of Product Revenue
CostOfRevenuesAmortizationOfAcquiredTechnologyIntangibleAssets,Cost of revenues: Amortization of acquired technology - based intangible assets
CostOfRevenuesServiceAndOther,Cost of revenues: Service and other
ServiceAndOtherRevenue,Service and other revenue
ContractDrillingsRevenues,Contract drilling revenues
RevenuesGoodsAndServices,Revenues
RevenueRelatedToNonMonetaryExchanges,Revenue Related To Non Monetary Exchanges
RelatedPartyRevenues,Related parties revenues
AccountsReceivableAndUnbilledRevenuesNet,"Accounts receivable and unbilled revenues, net"
DeferredRevenueDisclosureTextBlock,Deferred Revenue Disclosure [Text Block]
DeferredRevenueDisclosureTextBlock,Deferred Revenue Disclosure [Text Block]
ReconciliationOfRevenueFromSegmentsToConsolidatedTextBlock,Reconciliation of Revenue from Segments to Consolidated [Text Block]
RevenueRecognitionPolicyTextBlock,"Revenue Recognition, Policy [Text Block]"
RevenueRecognitionPolicyTextBlock,"Revenue Recognition, Policy [Text Block]"
ScheduleOfRevenueFromExternalCustomersAttributedToForeignCountriesByGeographicAreaTextBlock,Schedule of Revenue from External Customers Attributed to Foreign Countries by Geographic Area [Text Block]
GecsRevenueFromServices,GECS REVENUES FROM SERVICES
RevenueRecognitionTextBlock,Revenue Recognition Text Block
InformationAboutReceivablesRevenuesAndServicesTextBlock,"Information about Receivables, Revenues, and Services [Text Block]"
OtherNoninterestRevenueTextBlock,Other Noninterest Revenue [Text Block]
GrossVsNetRevenueDisclosureTextBlock,Gross Vs. Net Revenue Disclosure [Text Block]
GrossVsNetRevenueDisclosureTextBlock,Gross Vs. Net Revenue Disclosure [Text Block]
AdvertisingRevenue,Advertising Revenue
BrokerageCommissionsRevenue,Brokerage Commissions Revenue
BrokerageCommissionsRevenue,Brokerage Commissions Revenue
BrokeredNaturalGasMarginRevenue,Brokered Natural Gas Margin Revenue
CapitalLeasesIncomeStatementDirectFinancingLeaseRevenue,"Capital Leases, Income Statement, Direct Financing Lease Revenue"
CargoAndFreightRevenue,Cargo and Freight Revenue
CargoAndFreightRevenue,Cargo and Freight Revenue
CasinoRevenue,Casino Revenue
ClearingFeesRevenue,Clearing Fees Revenue
Query:
SELECT DISTINCT `stprba`
   FROM `bigquery-public-data.sec_quarterly_financials.submission`
   WHERE `countryba` = 'US'
   LIMIT 100;
Answer:
stprba
GA
PA
TX
IN
NV
HI
NM
MS
""
MN
CA
CT
NY
RI
NC
NJ
TN
CO
ME
OR
VA
WI
WY
DE
MA
IL
NH
WA
SC
MD
MO
VT
WV
FL
AL
OH
AZ
KS
OK
KY
MI
AR
DC
IA
LA
SD
UT
NE
MT
AK
ND
ID
Query:
SELECT DISTINCT `company_name`, `stprba`
FROM `bigquery-public-data.sec_quarterly_financials.submission`
WHERE CAST(SUBSTR(CAST(`date_filed` AS STRING), 1, 4) AS INT64) = 2016
  AND `countryba` = 'US'
  AND `stprba` IS NOT NULL
  AND `stprba` != ''
LIMIT 100;
Answer:
company_name,stprba
DUO WORLD INC,NV
KROGER CO,OH
VIRTUSA CORP,MA
HF FINANCIAL CORP,SD
CALAVO GROWERS INC,CA
AMERICAN INDEPENDENCE CORP,NY
TIMKEN CO,OH
SOUTHSIDE BANCSHARES INC,TX
NORWOOD FINANCIAL CORP,PA
UTAH MEDICAL PRODUCTS INC,UT
PAR TECHNOLOGY CORP,NY
FIRST BANCORP /NC/,NC
LIONS GATE ENTERTAINMENT CORP /CN/,CA
"PLANET FITNESS, INC.",MA
VIBE WIRELESS CORP.,AZ
SPLUNK INC,CA
GUESS INC,CA
CHEROKEE INC,CA
BIOPHARMX CORP,CA
"PURE STORAGE, INC.",CA
NVIDIA CORP,CA
VIRCO MFG CORPORATION,CA
"TILLY'S, INC.",CA
QAD INC,CA
SIGMA DESIGNS INC,CA
VIOLIN MEMORY INC,CA
XACTLY CORP,CA
SEMTECH CORP,CA
TRIANGLE PETROLEUM CORP,CO
JAMMIN JAVA CORP.,CO
"MULTI SOFT II, INC",FL
OXFORD INDUSTRIES INC,GA
"DESTINATION XL GROUP, INC.",MA
EXA CORP,MA
LOWES COMPANIES INC,NC
"GORDMANS STORES, INC.",NE
DESTINATION MATERNITY CORP,NJ
TOYS R US INC,NJ
AEROPOSTALE INC,NY
"FOOT LOCKER, INC.",NY
VINCE HOLDING CORP.,NY
VANECK MERK GOLD TRUST,NY
TIFFANY & CO,NY
LAKELAND INDUSTRIES INC,NY
MESABI TRUST,NY
"EXPRESS, INC.",OH
"MACY'S, INC.",OH
DICKS SPORTING GOODS INC,PA
FREDS INC,TN
STAGE STORES INC,TX
"BAKERCORP INTERNATIONAL, INC.",TX
"MICHAELS COMPANIES, INC.",TX
"SPORTSMAN'S WAREHOUSE HOLDINGS, INC.",UT
TAPIMMUNE INC,FL
VINCOMPASS CORP.,CA
SEYCHELLE ENVIRONMENTAL TECHNOLOGIES INC /CA,CA
BARRACUDA NETWORKS INC,CA
STEELCASE INC,MI
SUPERVALU INC,MN
RED HAT INC,NC
TOUCAN INTERACTIVE CORP,NV
"NEW ENTERPRISE STONE & LIME CO., INC.",PA
"INTERNATIONAL WESTERN PETROLEUM, INC.",TX
PROPERTY MANAGEMENT CORP OF AMERICA,VA
INTELLISENSE SOLUTIONS INC.,AZ
"HOULIHAN LOKEY, INC.",CA
BUSCAR CO,CA
"ENSIGN GROUP, INC",CA
WNC HOUSING TAX CREDIT FUND VI LP SERIES 9,CA
WNC HOUSING TAX CREDIT FUND VI LP SERIES 10,CA
"RMR INDUSTRIALS, INC.",CA
"ORGANOVO HOLDINGS, INC.",CA
E DIGITAL CORP,CA
CORVEL CORP,CA
MEDIA ANALYTICS CORP,CA
MCKESSON CORP,CA
SIMLATUS CORP,CA
8X8 INC /DE/,CA
STEVIA FIRST CORP.,CA
VIASAT INC,CA
APPLIED MICRO CIRCUITS CORP,CA
WNC HOUSING TAX CREDIT FUND IV L P SERIES 2,CA
"AEROGROW INTERNATIONAL, INC.",CO
AMERICAN TAX CREDIT TRUST SERIES I,CT
"EARTH SCIENCE TECH, INC.",FL
FUTUREWORLD CORP.,FL
PETMED EXPRESS INC,FL
NICHOLAS FINANCIAL INC,FL
NOVELIS INC.,GA
SUGAR CREEK FINANCIAL CORP./MD/,IL
Query:
SELECT n.`value`, s.`stprba`, n.`measure_tag`
FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
  ON n.`submission_number` = s.`submission_number`
WHERE s.`stprba` IS NOT NULL
  AND s.`stprba` != ''
LIMIT 100
Answer:
value,stprba,measure_tag
1.0,TX,PreferredStockParOrStatedValuePerShare
116068000.0,TX,AccountsPayableCurrent
132546000.0,TX,CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalents
1525000.0,TX,AssetRetirementObligationsNoncurrent
48.0,TX,NumberOfStatesInWhichEntityOperates
1550000.0,TX,AssetRetirementObligationsNoncurrent
4233587.0,TX,CommonStockSharesOutstanding
147329000.0,TX,StockholdersEquity
451000.0,TX,CapitalLeasesFutureMinimumPaymentsDueInFiveYears
236000.0,TX,DerivativeLiabilitiesCurrent
132546000.0,TX,CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalents
821000.0,TX,LiabilityInsuranceProgramExcessLossFund
960000.0,TX,PreferredStockSharesAuthorized
0.0,TX,PreferredStockValue
146598000.0,TX,StockholdersEquity
2873000.0,TX,CashDepositsAndOtherAssetsNoncurrent
880000.0,TX,PrepaidRentAndOther
705000.0,TX,PrepaidInsurance
960000.0,TX,PreferredStockSharesAuthorized
74499000.0,TX,AccountsReceivableNetCurrent
117066000.0,TX,CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalents
422000.0,TX,StockholdersEquity
12497000.0,TX,StockholdersEquity
5611000.0,TX,PaymentsForAssetAcquisitionsGross
20725000.0,TX,PropertyPlantAndEquipmentGross
2794000.0,TX,PropertyPlantAndEquipmentGross
35.15,TX,SharePrice
137188000.0,TX,StockholdersEquity
2007000.0,TX,FinitelivedIntangibleAssetsAcquired1
4000.0,TX,DerivativeAssetsLiabilitiesAtFairValueNet
0.0,TX,DerivativeLiabilities
431000.0,TX,AssetAcquisitionConsiderationTransferredLiabilitiesIncurred
24895000.0,TX,PropertyPlantAndEquipmentGross
0.0,TX,DerivativeFairValueOfDerivativeLiabilityAmountOffsetAgainstCollateral
0.0,TX,EnergyMarketingContractsAssetsCurrent
0.0,TX,DerivativeFairValueOfDerivativeAsset
139000.0,TX,DerivativeAssetFairValueGrossLiability
0.0,TX,DerivativeFairValueOfDerivativeAsset
0.0,TX,DerivativeAssetFairValueGrossLiability
16003000.0,TX,PropertyPlantAndEquipmentGross
0.0,TX,DerivativeFairValueOfDerivativeLiabilityAmountOffsetAgainstCollateral
4600000.0,TX,LettersOfCreditOutstandingAmount
0.0,TX,DerivativeAssets
139000.0,TX,EnergyMarketingContractLiabilitiesCurrent
956000000.0,CA,CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalents
50000000.0,CA,TreasuryStockValue
834000000.0,CA,AccountsPayableCurrent
207000000.0,CA,DueToRelatedPartiesCurrent
48000000.0,CA,OtherLiabilitiesCurrent
4556000000.0,CA,Assets
,CA,CommitmentsAndContingencies
58000000.0,CA,EquityMethodInvestments
289000000.0,CA,Goodwill
28000000.0,CA,SoftwareTechnologyAndLicensesPayable
458000000.0,CA,PropertyPlantAndEquipmentNet
0.01,CA,CommonStockParOrStatedValuePerShare
40000000.0,CA,SoftwareTechnologyAndLicensesPayable
288000000.0,CA,AccruedMarketingAndAdvertisingCurrent
Query:
SELECT n.`submission_number`, n.`value`, n.`measure_tag`, n.`period_end_date`
FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
WHERE n.`number_of_quarters` = 4
  AND n.`period_end_date` BETWEEN 20160101 AND 20161231
  AND n.`period_end_date` IS NOT NULL
LIMIT 100
Answer:
submission_number,value,measure_tag,period_end_date
0000075677-15-000011,-3400000.0,CashFlowHedgeGainLossToBeReclassifiedWithinTwelveMonthsNetOfTax,20160331
0000717423-15-000022,4.13,UnderlyingDerivativeVolume,20161231
0000721748-15-000301,39600.0,OperatingLeasesIncomeStatementInitialDirectCosts,20161231
0000826675-15-000011,-2429000.0,CashFlowHedgeGainLossToBeReclassifiedWithinTwelveMonths,20160331
0000929008-15-000016,11400000.0,ShareBasedCompensation,20161231
0001001606-15-000015,9800000.0,AmortizationOfIntangibleAssets,20161231
0001002014-15-000233,220440.0,LeaseAndRentalExpense,20161231
0001012569-15-000073,137000000.0,RelinquishmentofIncentiveDistributions,20161231
0001021162-15-000017,2725000.0,AdjustmentsToAdditionalPaidInCapitalConvertibleDebtWithConversionFeature,20160331
0001064728-15-000042,-91000000.0,CashFlowHedgeGainLossToBeReclassifiedWithinTwelveMonths,20160331
0001064728-15-000042,75000000.0,PaymenttotheVEBAbasedontheconstructofthenegotiatedsettlement,20161231
0001078782-15-000761,0.0,MinimumLeaseCommitmentsThereafter,20160331
0001144204-15-024774,0.15,EffectiveIncomeTaxRatePreferentialTaxRate,20161231
0001144204-15-025260,0.15,EffectiveIncomeTaxRateReconciliationAtFederalStatutoryIncomeTaxRate,20161231
0001144204-15-031403,5000000.0,MinimumEarningsBeforeInterestTaxesDepreciationAndAmortization,20161231
0001144204-15-035673,4500000.0,MinimumEarningsBeforeInterestTaxesDepreciationAndAmortization,20161231
0001144204-15-035673,500000.0,MaximumCapitalExpendituresOfGuarantorAndItsSubsidiaries,20161231
0001193125-15-160100,57678.0,ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsVestedInPeriod,20161130
0001193125-15-177335,90000000.0,RetentionOfAnnualTransmissionCongestionRevenues,20161231
0001193125-15-179473,1250000.0,BusinessCombinationContingentConsiderationAcquisitionsMaximumVariableEarnout,20161231
0001193125-15-232464,5700000000.0,DefinedBenefitPlanFutureAmortizationOfGainLoss,20160331
0001469709-15-000183,0.0,TotalOperatingLeaseCommitmentsMineOperatingRights,20161231
0001486800-15-000031,35000000.0,MinimumEbitda,20160331
0001495231-15-000032,1800000.0,Businesscombinationpaymenttoacquireeformeetingperformancegoal,20161231
0001495231-15-000035,27000000.0,BusinessCombinationsSeparatelyRecognizedTransactionsContentOnlyRevenue,20161231
0001495231-15-000035,0.6,BusinessCombinationContingentConsiderationArrangementsPercentageofPerformancePaymentOwed,20161231
0001495231-15-000035,0.0,BusinessCombinationContingentConsiderationArrangementsChangeInTheRangeOfOutcomesContingentConsiderationLiabilityValueHigh,20161231
0001495231-15-000035,1080000.0,BusinessCombinationContingentConsiderationArrangementsChangeInTheRangeOfOutcomesContingentConsiderationLiabilityValueHigh,20161231
0001495231-15-000035,0.0,BusinessCombinationContingentConsiderationArrangementsPercentageofPerformancePaymentOwed,20161231
0001550695-15-000022,4.75,DebtInstrumentCovenantTotalDebttoEBITDAratio,20161231
Query:
SELECT n.`value`, s.`stprba`, s.`company_name`, n.`measure_tag`
FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
  ON n.`submission_number` = s.`submission_number`
WHERE n.`number_of_quarters` = 4
  AND n.`period_end_date` BETWEEN 20160101 AND 20161231
  AND s.`countryba` = 'US'
  AND s.`stprba` IS NOT NULL
  AND s.`stprba` != ''
LIMIT 100
Answer:
value,stprba,company_name,measure_tag
2598000000.0,CA,CLOROX CO /DE/,GrossProfit
0.0,CA,CLOROX CO /DE/,IncomeLossFromDiscontinuedOperationsNetOfTaxAttributableToReportingEntity
22000000.0,GA,COCA COLA CO,AmortizationForLeaseholdImprovements
1035000000.0,GA,COCA COLA CO,ProceedsfromDisposalsofbusinessesequitymethodinvestmentsandnonmarketablesecurities
41000000.0,GA,COCA COLA CO,MultiemployerPlanContributionsByEmployer
1147000000.0,GA,COCA COLA CO,CurrentFederalTaxExpenseBenefit
1434000000.0,GA,COCA COLA CO,ProceedsFromIssuanceOfCommonStock
-0.03,GA,COCA COLA CO,EffectiveIncomeTaxRateReconciliationEquityInEarningsLossesOfUnconsolidatedSubsidiary
733000000.0,GA,COCA COLA CO,InterestExpense
42000000.0,GA,COCA COLA CO,OtherComprehensiveIncomeLossForeignCurrencyTransactionGainLossArisingduringPeriodNetofTax
8136000000.0,GA,COCA COLA CO,IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest
1371000000.0,GA,COCA COLA CO,OtherCostAndExpenseOperating
1586000000.0,GA,COCA COLA CO,IncomeTaxExpenseBenefit
0.16,GA,COCA COLA CO,ShareBasedCompensationArrangementByShareBasedPaymentAwardFairValueAssumptionsExpectedVolatilityRate
10000000.0,GA,COCA COLA CO,ValuationAllowancesAndReservesDeductions
71000000.0,GA,COCA COLA CO,EmployeeServiceShareBasedCompensationTaxBenefitFromCompensationExpense
0.019,GA,COCA COLA CO,EffectiveIncomeTaxRateReconciliationTaxContingenciesDomestic
449000000.0,GA,COCA COLA CO,IncomeLossFromEquityMethodInvestmentsNetOfDividendsOrDistributions
-838000000.0,GA,COCA COLA CO,DeferredFederalIncomeTaxExpenseBenefit
139000000.0,GA,COCA COLA CO,AmortizationOfIntangibleAssets
41863000000.0,GA,COCA COLA CO,Revenues
0.0,GA,COCA COLA CO,EffectiveIncomeTaxRateReconciliationRepatriationForeignEarningsJobsCreationActOf2004
1.49,GA,COCA COLA CO,EarningsPerShareDiluted
642000000.0,GA,COCA COLA CO,InvestmentIncomeInterest
2262000000.0,GA,COCA COLA CO,PaymentsToAcquirePropertyPlantAndEquipment
500000000.0,GA,COCA COLA CO,IssuanceOfLongTermDebt
-613000000.0,GA,COCA COLA CO,OtherComprehensiveIncomeLossForeignCurrencyTransactionAndTranslationAdjustmentNetOfTax
0.0,GA,COCA COLA CO,IncomeLossFromEquityMethodInvestments
352000000.0,GA,COCA COLA CO,RestructuringCharges
-91000000.0,GA,COCA COLA CO,DeferredStateAndLocalIncomeTaxExpenseBenefit
0.012,GA,COCA COLA CO,EffectiveIncomeTaxRateReconciliationStateAndLocalIncomeTaxes
0.0425,GA,COCA COLA CO,DefinedBenefitPlanAssumptionsUsedCalculatingNetPeriodicBenefitCostDiscountRate
8000000.0,GA,COCA COLA CO,IntersegmentRevenue
31000000.0,GA,COCA COLA CO,Costincurredtoconvertbottlingagreements
86000000.0,GA,COCA COLA CO,DefinedBenefitPlanNetPeriodicBenefitCostExcludingSettlementCurtailmentAndSpecialTerminationBenefits
615000000.0,GA,COCA COLA CO,InvestmentIncomeInterest
946000000.0,GA,COCA COLA CO,RelatedPartyTransactionMarketingPaymentsDirectlyToRelatedParty
Query:
SELECT DISTINCT mt.`measure_tag`, mt.`tag_label`
FROM `bigquery-public-data.sec_quarterly_financials.measure_tag` AS mt
WHERE mt.`tag_label` IS NOT NULL
  AND LOWER(mt.`tag_label`) LIKE '%revenue%'
LIMIT 100
Answer:
measure_tag,tag_label
TotalRevenuePercentageIncreaseDecrease,Total Revenue Percentage Increase (Decrease)
RelatedPartyRevenues,Related parties revenues
ScheduleOfRevenueFromExternalCustomersAttributedToForeignCountriesByGeographicAreaTextBlock,Schedule of Revenue from External Customers Attributed to Foreign Countries by Geographic Area [Text Block]
CargoAndFreightRevenue,Cargo and Freight Revenue
ContractsRevenue,Contracts Revenue
ElectricalGenerationRevenue,Electrical Generation Revenue
ElectricalTransmissionAndDistributionRevenue,Electrical Transmission and Distribution Revenue
MaintenanceRevenue,Maintenance Revenue
PrincipalTransactionsRevenue,Principal Transactions Revenue
SalesRevenueEnergyServices,"Sales Revenue, Energy Services"
UnregulatedOperatingRevenue,Unregulated Operating Revenue
OtherElectricRevenues,Other electric revenues
WholesaleRevenues,Wholesale revenues
SuppliesRevenue,Supplies revenue
RevenueFromPressurePumping,Revenue From Pressure Pumping
OtherRevenues,Other Revenues
MortgageBankingRevenues,Mortgage Banking Revenues
GasMarketingRevenueNetOfRelatedCosts,"Gas Marketing Revenue, Net of Related Costs"
SubscriptionLicensingAndOtherRevenues,Subscription Licensing and Other Revenues
DeferredRevenue,Deferred Revenue
CustomerDepositsDeferredRevenue,Customer Deposits Deferred Revenue
OtherLiabilitiesAndDeferredRevenue,Other Liabilities And Deferred Revenue
UnearnedRevenue,Unearned revenue
AdvanceBillingsOnUncompletedContracts,Advance billings and unearned revenue on uncompleted contracts
UnderRecoveredRegulatoryClauseRevenues,Under recovered regulatory clause revenues
AccruedRevenues,Accrued revenues
AccruedUnbilledRevenueEnergy,Accrued unbilled revenue
ElectricUtilityRevenueAbstract,Electric Revenue [Abstract]
FinancialServicesRevenueAbstract,Financial Services Revenue [Abstract]
RealEstateRevenueNetAbstract,"Real Estate Revenue, Net [Abstract]"
RegulatedAndUnregulatedOperatingRevenueAbstract,Regulated and Unregulated Operating Revenue [Abstract]
SalesRevenueGoodsNetAbstract,"Sales Revenue, Goods, Net [Abstract]"
ContractDrillingIntangibleRevenues,Contract drilling intangible revenues
PaymentsForProceedsFromBusinessesAndInterestInAffiliatesTextBlock,Revenue Accounting for Contracts / Accounting for Joint Ventures
ServiceFees,Service revenues
StockBasedCompensationExpenseAssociatedWithCostOfSales,"Cost of revenues, stock-based compensation expense"
NonInsuranceServiceRevenues,Service revenues
MortgageServicingAndOther,Mortgage banking net revenue
AdditionsToUnearnedRevenue,Additions to unearned revenue
PrepaidRevenueShareExpensesAndOtherAssetsNoncurrent,"Prepaid revenue share, expenses and other assets, non-current"
UnbilledRevenue,Unbilled revenue
DeferredRevenueArrangementLineItems,Deferred Revenue Arrangement [Line Items]
ProFormaInformationOnCompanyRevenueAndNetEarningsAbstract,Pro forma information on company revenue and net earnings Abstract
PercentageOfNetRevenueFromSalesToSignificantCustomersIncludingTheirManufacturingSubcontractorsAbstract,Percentage Of Net Revenue From Sales To Significant Customers Including their Manufacturing Subcontractors Abstract
RevenueAndLongLivedAssetsAttributedToIndividualForeignCountriesLineItems,Revenue And Long Lived Assets Attributed To Individual Foreign Countries [Line Items]
DisposalGroupIncludingDiscontinuedOperationRevenueAbstract,Disposal Group Including Discontinued Operation Revenue Abstract
SalesAndTradingRevenueAbstract,Sales and Trading Revenue Abstract
Query:
SELECT n.`submission_number`, n.`value`, n.`measure_tag`, s.`company_name`, s.`stprba`
FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
  ON n.`submission_number` = s.`submission_number`
WHERE n.`number_of_quarters` = 4
  AND n.`period_end_date` BETWEEN 20160101 AND 20161231
  AND s.`countryba` = 'US'
  AND s.`stprba` IS NOT NULL
  AND s.`stprba` != ''
  AND n.`measure_tag` IN (
    SELECT `measure_tag`
    FROM `bigquery-public-data.sec_quarterly_financials.measure_tag`
    WHERE `tag_label` IS NOT NULL
      AND LOWER(`tag_label`) LIKE '%revenue%'
  )
ORDER BY n.`value` DESC
LIMIT 100
Answer:
submission_number,value,measure_tag,company_name,stprba
0001104659-19-024105,1747143000000.0,RevenueAndOperatingIncome,BANK OF CHILE,NY
0001104659-18-027756,1747143000000.0,RevenueAndOperatingIncome,BANK OF CHILE,NY
0001104659-19-024105,1717559000000.0,RevenueAndOperatingIncome,BANK OF CHILE,NY
0001104659-19-024105,1717559000000.0,RevenueAndOperatingIncome,BANK OF CHILE,NY
0001104659-18-027756,1717559000000.0,RevenueAndOperatingIncome,BANK OF CHILE,NY
0001104659-18-027756,1458296000000.0,OperatingRevenuesNetOfProvisionsForLoanLosses,BANK OF CHILE,NY
0001104659-19-024105,1458296000000.0,OperatingRevenuesNetOfProvisionsForLoanLosses,BANK OF CHILE,NY
0001104659-18-027756,1226733000000.0,InterestRevenueExpense,BANK OF CHILE,NY
0001104659-19-024105,1226733000000.0,InterestRevenueExpense,BANK OF CHILE,NY
0001104659-19-024105,1226733000000.0,InterestRevenueExpense,BANK OF CHILE,NY
0001104659-18-027756,1220368000000.0,InterestRevenueExpense,BANK OF CHILE,NY
0001104659-19-024105,1220368000000.0,InterestRevenueExpense,BANK OF CHILE,NY
0001104659-18-027756,1137333000000.0,RevenueAndOperatingIncome,BANK OF CHILE,NY
0001104659-19-024105,1137333000000.0,RevenueAndOperatingIncome,BANK OF CHILE,NY
0001104659-19-024105,873669000000.0,InterestRevenueExpense,BANK OF CHILE,NY
0001104659-18-027756,873669000000.0,InterestRevenueExpense,BANK OF CHILE,NY
0001185185-17-000924,571720000000.0,BusinessAcquisitionsProFormaRevenue,HOOKER FURNITURE CORP,VA
0000104169-17-000021,482130000000.0,Revenues,WAL MART STORES INC,AR
0000104169-16-000079,482130000000.0,Revenues,WAL MART STORES INC,AR
0000104169-18-000028,482130000000.0,Revenues,WALMART INC.,AR
0000104169-16-000079,478614000000.0,SalesRevenueNet,WAL MART STORES INC,AR
0000104169-18-000028,478614000000.0,SalesRevenueNet,WALMART INC.,AR
0000104169-17-000021,478614000000.0,SalesRevenueNet,WAL MART STORES INC,AR
0001104659-19-024105,422353000000.0,RevenueAndOperatingIncome,BANK OF CHILE,NY
0001104659-18-027756,422353000000.0,RevenueAndOperatingIncome,BANK OF CHILE,NY
0000104169-16-000079,360984000000.0,CostOfRevenue,WAL MART STORES INC,AR
0000104169-17-000021,360984000000.0,CostOfRevenue,WAL MART STORES INC,AR
0000104169-18-000028,360984000000.0,CostOfRevenue,WALMART INC.,AR
0000104169-17-000021,357559000000.0,Revenues,WAL MART STORES INC,AR
0000104169-16-000079,357559000000.0,Revenues,WAL MART STORES INC,AR
0000104169-18-000028,357559000000.0,Revenues,WALMART INC.,AR
0001104659-18-027756,346829000000.0,InterestRevenueExpense,BANK OF CHILE,NY
Query:
SELECT s.`stprba`, SUM(n.`value`) AS `total_revenue`
FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
  ON n.`submission_number` = s.`submission_number`
WHERE n.`number_of_quarters` = 4
  AND n.`period_end_date` BETWEEN 20160101 AND 20161231
  AND s.`countryba` = 'US'
  AND s.`stprba` IS NOT NULL
  AND s.`stprba` != ''
  AND n.`measure_tag` IN (
    SELECT `measure_tag`
    FROM `bigquery-public-data.sec_quarterly_financials.measure_tag`
    WHERE `tag_label` IS NOT NULL
      AND LOWER(`tag_label`) LIKE '%revenue%'
  )
GROUP BY s.`stprba`
ORDER BY `total_revenue` DESC
LIMIT 100
Answer:
stprba,total_revenue
NY,54567490590974.875
TX,30466878337154.598
CA,28097919465933.89
IL,16475171338763.547
WA,12388413931253.527
OH,9911236993649.855
MI,9771448675979.963
MA,9430360296708.02
PA,8657235380473.33
MN,8647154420131.662
NJ,8629589039550.321
AR,7865962653985.448
GA,7685580270676.557
VA,6752345705102.671
FL,5739246088610.498
NC,5229746387116.293
MO,5083019416194.108
CT,4861500342230.495
CO,4568385504310.364
RI,4510430467030.5
TN,4334978819894.095
NE,4084598013795.96
IN,3195434531321.0073
MD,2821784226300.4956
WI,2081012911689.3584
OK,1969169766220.9702
AZ,1876589077953.5527
ID,1505949572250.65
KY,1455800858127.2102
KS,1385052522044.1506
NV,1363543745541.3674
DE,1184682510772.88
IA,937330742749.0201
OR,756717724638.913
LA,666914002425.451
DC,601373713571.7002
AL,564662791593.156
UT,483297687359.85205
SC,371327450395.726
HI,141641154284.02002
NH,106699373260.13
ND,88754394174.45
ME,59981627040.58
SD,56784553394.24249
MS,52761015902.0
AK,23335694750.980003
NM,16597135801.2726
WY,11291090615.0
VT,9542364703.7
WV,5121116943.0
MT,4417660957.8
Query:
SELECT n.`submission_number`, s.`company_name`, s.`stprba`, n.`value`, mt.`tag_label`
FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
  ON n.`submission_number` = s.`submission_number`
JOIN `bigquery-public-data.sec_quarterly_financials.measure_tag` AS mt
  ON n.`measure_tag` = mt.`measure_tag`
WHERE n.`number_of_quarters` = 4
  AND n.`period_end_date` BETWEEN 20160101 AND 20161231
  AND s.`countryba` = 'US'
  AND s.`stprba` IS NOT NULL
  AND s.`stprba` != ''
  AND mt.`tag_label` IS NOT NULL
  AND LOWER(mt.`tag_label`) LIKE '%revenue%'
LIMIT 100
Answer:
submission_number,company_name,stprba,value,tag_label
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
0000004457-16-000085,AMERCO /NV/,NV,4757000.0,Increase (Decrease) in Deferred Revenue
Query:
SELECT s.`company_name`, s.`stprba`, MAX(n.`value`) AS `max_revenue`
FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
  ON n.`submission_number` = s.`submission_number`
WHERE n.`number_of_quarters` = 4
  AND n.`period_end_date` BETWEEN 20160101 AND 20161231
  AND s.`countryba` = 'US'
  AND s.`stprba` IS NOT NULL
  AND s.`stprba` != ''
  AND n.`measure_tag` IN (
    SELECT `measure_tag`
    FROM `bigquery-public-data.sec_quarterly_financials.measure_tag`
    WHERE `tag_label` IS NOT NULL
      AND LOWER(`tag_label`) LIKE '%revenue%'
  )
GROUP BY s.`company_name`, s.`stprba`
ORDER BY `max_revenue` DESC
LIMIT 100
Answer:
company_name,stprba,max_revenue
BANK OF CHILE,NY,1747143000000.0
HOOKER FURNITURE CORP,VA,571720000000.0
WALMART INC.,AR,482130000000.0
WAL MART STORES INC,AR,482130000000.0
GENERAL ELECTRIC CO,MA,345301000000.0
EXXON MOBIL CORP,TX,226094000000.0
BERKSHIRE HATHAWAY INC,NE,223604000000.0
APPLE INC,CA,215639000000.0
MCKESSON CORP,CA,190884000000.0
UNITEDHEALTH GROUP INC,MN,184840000000.0
CVS HEALTH CORP,RI,177546000000.0
NAVIENT CORP,DE,174000000000.0
GENERAL MOTORS CO,MI,166380000000.0
AT&T INC.,TX,163786000000.0
AMAZON COM INC,WA,152283000000.0
FORD MOTOR CO,MI,151800000000.0
AMERISOURCEBERGEN CORP,PA,146849686000.0
CHEVRON CORP,CA,129030000000.0
VERIZON COMMUNICATIONS INC,NY,125980000000.0
CARDINAL HEALTH INC,OH,121561000000.0
COSTCO WHOLESALE CORP /NEW,WA,118719000000.0
"WALGREENS BOOTS ALLIANCE, INC.",IL,117351000000.0
KROGER CO,OH,114341000000.0
EXPRESS SCRIPTS HOLDING CO.,MO,102115500000.0
COMMUNITY HEALTH SYSTEMS INC,TN,98200000000.0
JPMORGAN CHASE & CO,NY,96569000000.0
BOEING CO,WA,94571000000.0
MICROSOFT CORP,WA,94490000000.0
ALPHABET INC.,CA,90272000000.0
HOME DEPOT INC,GA,88519000000.0
WELLS FARGO & COMPANY/MN,CA,88267000000.0
INTERNATIONAL BUSINESS MACHINES CORP,NY,85936000000.0
PHILLIPS 66,TX,85777000000.0
"ANTHEM, INC.",IN,84863000000.0
BANK OF AMERICA CORP /DE/,NC,84601000000.0
COMCAST CORP,PA,80736000000.0
COMCAST CORP,NY,80403000000.0
VALERO ENERGY CORP/TX,TX,75659000000.0
MARATHON PETROLEUM CORP,OH,75193000000.0
PHILIP MORRIS INTERNATIONAL INC.,NY,74953000000.0
JOHNSON & JOHNSON,NJ,74339000000.0
TARGET CORP,MN,73785000000.0
DELL TECHNOLOGIES INC,TX,73138000000.0
DOWDUPONT INC.,MI,71321000000.0
CITIGROUP INC,NY,70797000000.0
METLIFE INC,NY,68878000000.0
GULF ISLAND FABRICATION INC,TX,65981000000.0
PROCTER & GAMBLE CO,OH,65299000000.0
AETNA INC /PA/,CT,63155000000.0
PEPSICO INC,NY,62799000000.0
ARCHER DANIELS MIDLAND CO,IL,62346000000.0
UNITED PARCEL SERVICE INC,GA,61610000000.0
INTEL CORP,CA,59486000000.0
LOWES COMPANIES INC,NC,59074000000.0
PRUDENTIAL FINANCIAL INC,NJ,58779000000.0
"ALBERTSONS COMPANIES, INC.",ID,58734000000.0
UNITED TECHNOLOGIES CORP /DE/,CT,58103000000.0
COCA COLA CO,GA,58054000000.0
FEDEX CORP,TN,57899000000.0
SYSCO CORP,TX,55922506000.0
Query:
SELECT s.`stprba`, AVG(n.`value`) AS `average_revenue`
FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
  ON n.`submission_number` = s.`submission_number`
WHERE n.`number_of_quarters` = 4
  AND n.`period_end_date` BETWEEN 20160101 AND 20161231
  AND s.`countryba` = 'US'
  AND s.`stprba` IS NOT NULL
  AND s.`stprba` != ''
  AND n.`measure_tag` IN (
    SELECT `measure_tag`
    FROM `bigquery-public-data.sec_quarterly_financials.measure_tag`
    WHERE `tag_label` IS NOT NULL
      AND LOWER(`tag_label`) LIKE '%revenue%'
  )
GROUP BY s.`stprba`
ORDER BY `average_revenue` DESC
LIMIT 100
Answer:
stprba,average_revenue
RI,11932355732.884926
AR,11078820639.416122
NE,4694940245.742482
WA,4411828323.095987
MI,3071816622.4394727
ID,3048480915.4871464
NY,3022292472.4993
MN,2317650608.451263
IL,1822877997.2077394
MO,1819262496.8482847
OH,1672782614.962001
NC,1668712950.5795453
TN,1633991262.6815286
GA,1596506080.3233395
DE,1552663841.1177983
IN,1483488640.3533
CT,1481261530.234764
TX,1461451448.0335102
VA,1412329158.14739
NJ,1370428623.082471
KY,1252840669.6447592
PA,1174340122.1477659
CA,1104521383.1492553
DC,1103438006.553578
KS,1082918312.778851
MA,1044105435.8622696
IA,1002492772.9936043
OR,973896685.506967
MD,955241782.7692947
OK,805057140.7281151
CO,801893190.1545314
AL,754896780.204754
WI,752899027.3839935
FL,737597492.4316282
AZ,733042608.5756066
LA,718657330.1998397
MS,532939554.5656565
SC,498426107.9137262
NV,487502232.94292724
UT,364752971.5923412
HI,311984921.3304406
ND,309248760.1897212
ME,275145078.1677982
NH,267416975.58929822
NM,227358024.6749671
WY,225821812.29999998
SD,155149052.98973364
AK,132589174.72147727
VT,73402805.41307692
MT,64024071.85217391
WV,47860906.00934579
Query:
SELECT s.`stprba`, n.`measure_tag`, SUM(n.`value`) AS `total_revenue`
FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
  ON n.`submission_number` = s.`submission_number`
WHERE n.`number_of_quarters` = 4
  AND n.`period_end_date` BETWEEN 20160101 AND 20161231
  AND s.`countryba` = 'US'
  AND s.`stprba` IS NOT NULL
  AND s.`stprba` != ''
  AND n.`measure_tag` IN (
    SELECT `measure_tag`
    FROM `bigquery-public-data.sec_quarterly_financials.measure_tag`
    WHERE `tag_label` IS NOT NULL
      AND LOWER(`tag_label`) LIKE '%revenue%'
  )
GROUP BY s.`stprba`, n.`measure_tag`
ORDER BY `total_revenue` DESC
LIMIT 100
Answer:
stprba,measure_tag,total_revenue
NY,Revenues,14642876696173.0
NY,RevenueAndOperatingIncome,12098280320000.0
TX,Revenues,10686113518108.0
NY,InterestRevenueExpense,8658853000000.0
CA,SalesRevenueNet,8371793342249.0
CA,Revenues,8199679072599.0
IL,Revenues,6987829559116.0
MA,Revenues,4562691967185.0
WA,Revenues,4404654808782.0
TX,SalesRevenueNet,4402759206679.0
MN,Revenues,4111965607045.0
MI,Revenues,3797917127685.0
PA,Revenues,3444580657882.0
AR,Revenues,3211537250000.0
IL,SalesRevenueNet,3192077861317.0
WA,SalesRevenueNet,3169244278557.0
OH,Revenues,3141505531209.0
AR,SalesRevenueNet,3114193972306.0
NE,Revenues,3049752904916.0
NY,OperatingRevenuesNetOfProvisionsForLoanLosses,2916592000000.0
MO,Revenues,2890128724924.0703
RI,Revenues,2873619401715.0
NJ,Revenues,2809390322704.0
VA,Revenues,2532831359587.6
TX,RevenueFromContractWithCustomerExcludingAssessedTax,2441583193962.0
NY,SalesRevenueNet,2436178432331.0
GA,Revenues,2280241609912.0
MI,SalesRevenueNet,2228649877718.0
FL,Revenues,2217395748429.0
WA,RevenueFromContractWithCustomerExcludingAssessedTax,2168035504000.0
CA,RevenueFromContractWithCustomerExcludingAssessedTax,2153651393988.0
PA,SalesRevenueNet,1987453754957.0
NY,RevenuesNetOfInterestExpense,1966353887000.0
NY,SalesRevenueGoodsNet,1934152624722.0
MN,SalesRevenueNet,1798330649694.0
CT,Revenues,1790874641648.0
OH,SalesRevenueNet,1787133863810.0
OH,SalesRevenueGoodsNet,1667510524558.0
TX,SalesRevenueGoodsNet,1664754473450.0
CA,OilAndGasRevenue,1657458067000.0
MA,RevenueFromContractWithCustomerExcludingAssessedTax,1638472335926.0
NY,RevenueFromContractWithCustomerExcludingAssessedTax,1625533824037.0
NJ,SalesRevenueGoodsNet,1525240779245.0
MA,SalesRevenueNet,1495072862273.0
IL,RevenueFromContractWithCustomerExcludingAssessedTax,1442945650746.0
TX,SalesAndOtherOperatingRevenueIncludingSalesBasedTaxes,1440356000000.0
TX,RevenueFromContractWithCustomerIncludingAssessedTax,1423698043126.0
TN,Revenues,1407841188521.0
NY,Revenue,1404104913000.0
GA,RevenueFromContractWithCustomerExcludingAssessedTax,1359957967676.0
CA,RevenueFromContractWithCustomerIncludingAssessedTax,1317859858119.0
GA,SalesRevenueNet,1229525804358.0
MD,Revenues,1210052909418.0
IN,Revenues,1205320519283.0
NC,SalesRevenueNet,1203683365390.0
CO,Revenues,1192332677538.0
NC,Revenues,1190151915087.0
Query:
SELECT n.`measure_tag`, mt.`tag_label`, COUNT(*) AS `usage_count`
FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
JOIN `bigquery-public-data.sec_quarterly_financials.measure_tag` AS mt
  ON n.`measure_tag` = mt.`measure_tag`
WHERE n.`number_of_quarters` = 4
  AND n.`period_end_date` BETWEEN 20160101 AND 20161231
  AND mt.`tag_label` IS NOT NULL
  AND LOWER(mt.`tag_label`) LIKE '%revenue%'
GROUP BY n.`measure_tag`, mt.`tag_label`
ORDER BY `usage_count` DESC
LIMIT 100
Answer:
measure_tag,tag_label,usage_count
Revenues,Revenues,5346627
Revenue,Revenue,2409456
SalesRevenueNet,"Revenue, Net",1716720
RevenueFromContractWithCustomerExcludingAssessedTax,"Revenue from Contract with Customer, Excluding Assessed Tax",1029488
SalesRevenueGoodsNet,"Sales Revenue, Goods, Net",808037
CostOfRevenue,Cost of Revenue,650651
RevenueFromRelatedParties,Revenue from Related Parties,579866
IncreaseDecreaseInDeferredRevenue,Increase (Decrease) in Deferred Revenue,415584
SalesRevenueNet,"Sales Revenue, Net",400568
SalesRevenueServicesNet,"Sales Revenue, Services, Net",354342
RevenueFromContractWithCustomerExcludingAssessedTax,"Revenue From Contract With Customer, Excluding Assessed Tax",328560
SalesRevenueNet,"Revenue, Net (Deprecated 2018-01-31)",257508
SalesRevenueNet,"Revenue, Net""",257508
BusinessAcquisitionsProFormaRevenue,"Business Acquisition, Pro Forma Revenue",226560
OperatingLeasesIncomeStatementLeaseRevenue,"Operating Leases, Income Statement, Lease Revenue",217872
OtherRevenue,Other Revenue,198747
Revenue,TOTAL REVENUE {1},192304
RevenueFromContractWithCustomerExcludingAssessedTax,Revenue From Contract With Customer Excluding Assessed Tax,175232
RevenueFromContractWithCustomerIncludingAssessedTax,"Revenue from Contract with Customer, Including Assessed Tax",168399
DisposalGroupIncludingDiscontinuedOperationRevenue,"Disposal Group, Including Discontinued Operation, Revenue",167244
Revenues,Revenue,155727
PercentageOfTotalRevenue,Percentage Of Total Revenue,154128
RevenueFromContractWithCustomerExcludingAssessedTax,"Revenue from Contract with Customer, Excluding Assessed Tax""",153328
EquityMethodInvestmentSummarizedFinancialInformationRevenue,"Equity Method Investment, Summarized Financial Information, Revenue",143045
SalesRevenueGoodsNet,"Sales Revenue, Goods, Net (Deprecated 2018-01-31)",110690
OtherSalesRevenueNet,"Other Revenue, Net",105735
SalesRevenueGoodsNet,"Sales Revenue, Goods, Net""",99621
BusinessCombinationProFormaInformationRevenueOfAcquireeSinceAcquisitionDateActual,"Business Combination, Pro Forma Information, Revenue of Acquiree since Acquisition Date, Actual",86016
Revenue,Revenue {2},79184
Revenue,Revenue (Income Statement),67872
RealEstateRevenueNet,"Real Estate Revenue, Net",67344
RevenueFromContractWithCustomerExcludingAssessedTax,RevenueFromContractWithCustomerExcludingAssessedTax,65712
RelatedPartyTransactionOtherRevenuesFromTransactionsWithRelatedParty,"Related Party Transaction, Other Revenues from Transactions with Related Party",59644
OtherRevenue,Other revenue,58455
Revenue,Revenue:,56560
ManagementFeesRevenue,Management Fees Revenue,54362
LicensesRevenue,Licenses Revenue,53430
RoyaltyRevenue,Royalty Revenue,51376
ContractsRevenue,Contracts Revenue,51200
RevenuesNetOfInterestExpense,"Revenues, Net of Interest Expense",48204
Revenue,Revenue {1},45248
Revenue,Revenue [Default Label],45248
Revenue,Revenues,45248
PercentageOfRevenue,Percentage Of Revenue,41976
End Exploring Related Columns
Task: What was the highest annual revenue in billions of dollars reported by a U.S. state in 2016, across the main revenue categories and covering all four quarters?

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
State,Highest_Annual_Revenue_Billions
state_code:str,revenue_in_billions:float > 0
(Attention: answer in one row)
```

The table above presents the highest annual revenue in billions of dollars reported by a U.S. state in 2016, aggregated across the main revenue categories and covering all four quarters..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'sec_quarterly_financials': ['calculation', 'dimension', 'measure_tag', 'numbers', 'presentation', 'quick_summary', 'rendering', 'sic_codes', 'submission', 'txt']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
You need to follow the format's positive signs.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-27 03:23:31 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 03:23:31 - root - INFO - ```sql
SELECT s.stprba AS State, SUM(n.value)/1000000000 AS Highest_Annual_Revenue_Billions
FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
  ON n.submission_number = s.submission_number
JOIN `bigquery-public-data.sec_quarterly_financials.measure_tag` AS mt
  ON n.measure_tag = mt.measure_tag
WHERE n.number_of_quarters = 4
  AND n.period_end_date BETWEEN 20160101 AND 20161231
  AND s.countryba = 'US'
  AND s.stprba IS NOT NULL
  AND s.stprba != ''
  AND mt.tag_label IS NOT NULL
  AND LOWER(mt.tag_label) LIKE '%revenue%'
GROUP BY s.stprba
ORDER BY Highest_Annual_Revenue_Billions DESC
LIMIT 1;
```
2025-01-27 03:23:34 - root - INFO - itercount: 1
2025-01-27 03:23:34 - root - INFO - 0
2025-01-27 03:23:34 - root - INFO - results: 
State,Highest_Annual_Revenue_Billions
NY,3354873.132749591


2025-01-27 03:23:34 - root - INFO - Please check the answer again by reviewing What was the highest annual revenue in billions of dollars reported by a U.S. state in 2016, across the main revenue categories and covering all four quarters?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
State,Highest_Annual_Revenue_Billions
state_code:str,revenue_in_billions:float > 0
(Attention: answer in one row)
```

The table above presents the highest annual revenue in billions of dollars reported by a U.S. state in 2016, aggregated across the main revenue categories and covering all four quarters. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
State,Highest_Annual_Revenue_Billions
NY,3354873.132749591
Current sql:
SELECT s.stprba AS State, SUM(n.value)/1000000000 AS Highest_Annual_Revenue_Billions
FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
  ON n.submission_number = s.submission_number
JOIN `bigquery-public-data.sec_quarterly_financials.measure_tag` AS mt
  ON n.measure_tag = mt.measure_tag
WHERE n.number_of_quarters = 4
  AND n.period_end_date BETWEEN 20160101 AND 20161231
  AND s.countryba = 'US'
  AND s.stprba IS NOT NULL
  AND s.stprba != ''
  AND mt.tag_label IS NOT NULL
  AND LOWER(mt.tag_label) LIKE '%revenue%'
GROUP BY s.stprba
ORDER BY Highest_Annual_Revenue_Billions DESC
LIMIT 1;You need to follow the format's positive signs.

2025-01-27 03:23:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 03:23:56 - root - INFO - ```sql
SELECT s.stprba AS State, ROUND(SUM(n.value)/1000000000, 4) AS Highest_Annual_Revenue_Billions
FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
  ON n.submission_number = s.submission_number
JOIN `bigquery-public-data.sec_quarterly_financials.measure_tag` AS mt
  ON n.measure_tag = mt.measure_tag
WHERE n.number_of_quarters = 4
  AND n.period_end_date BETWEEN 20160101 AND 20161231
  AND s.countryba = 'US'
  AND s.stprba IS NOT NULL
  AND s.stprba != ''
  AND mt.tag_label IS NOT NULL
  AND LOWER(mt.tag_label) LIKE '%revenue%'
  AND n.value > 0
GROUP BY s.stprba
ORDER BY Highest_Annual_Revenue_Billions DESC
LIMIT 1;
```
2025-01-27 03:23:59 - root - INFO - itercount: 2
2025-01-27 03:23:59 - root - INFO - 0
2025-01-27 03:23:59 - root - INFO - results: 
State,Highest_Annual_Revenue_Billions
NY,3387650.5542


2025-01-27 03:23:59 - root - INFO - Please check the answer again by reviewing What was the highest annual revenue in billions of dollars reported by a U.S. state in 2016, across the main revenue categories and covering all four quarters?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
State,Highest_Annual_Revenue_Billions
state_code:str,revenue_in_billions:float > 0
(Attention: answer in one row)
```

The table above presents the highest annual revenue in billions of dollars reported by a U.S. state in 2016, aggregated across the main revenue categories and covering all four quarters. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
State,Highest_Annual_Revenue_Billions
NY,3387650.5542
Current sql:
SELECT s.stprba AS State, ROUND(SUM(n.value)/1000000000, 4) AS Highest_Annual_Revenue_Billions
FROM `bigquery-public-data.sec_quarterly_financials.numbers` AS n
JOIN `bigquery-public-data.sec_quarterly_financials.submission` AS s
  ON n.submission_number = s.submission_number
JOIN `bigquery-public-data.sec_quarterly_financials.measure_tag` AS mt
  ON n.measure_tag = mt.measure_tag
WHERE n.number_of_quarters = 4
  AND n.period_end_date BETWEEN 20160101 AND 20161231
  AND s.countryba = 'US'
  AND s.stprba IS NOT NULL
  AND s.stprba != ''
  AND mt.tag_label IS NOT NULL
  AND LOWER(mt.tag_label) LIKE '%revenue%'
  AND n.value > 0
GROUP BY s.stprba
ORDER BY Highest_Annual_Revenue_Billions DESC
LIMIT 1;You need to follow the format's positive signs.

2025-01-27 03:24:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 03:24:39 - root - INFO - ```sql
SELECT s.stprba AS State, ROUND(SUM(n.value)/1000000000, 4) AS Highest_Annual_Revenue_Billions
FROM `bigquery-public-data.sec_quarterly_financials.numbers` n
JOIN `bigquery-public-data.sec_quarterly_financials.submission` s
  ON n.submission_number = s.submission_number
WHERE n.number_of_quarters = 4
  AND n.period_end_date BETWEEN 20160101 AND 20161231
  AND n.measure_tag = 'Revenues'
  AND n.value > 0
  AND s.countryba = 'US'
  AND s.stprba IS NOT NULL
  AND s.stprba != ''
GROUP BY s.stprba
ORDER BY Highest_Annual_Revenue_Billions DESC
LIMIT 1;
```
2025-01-27 03:24:41 - root - INFO - itercount: 3
2025-01-27 03:24:41 - root - INFO - 0
2025-01-27 03:24:41 - root - INFO - results: 
State,Highest_Annual_Revenue_Billions
NY,14831.9755


2025-01-27 03:24:41 - root - INFO - Please check the answer again by reviewing What was the highest annual revenue in billions of dollars reported by a U.S. state in 2016, across the main revenue categories and covering all four quarters?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
State,Highest_Annual_Revenue_Billions
state_code:str,revenue_in_billions:float > 0
(Attention: answer in one row)
```

The table above presents the highest annual revenue in billions of dollars reported by a U.S. state in 2016, aggregated across the main revenue categories and covering all four quarters. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
State,Highest_Annual_Revenue_Billions
NY,14831.9755
Current sql:
SELECT s.stprba AS State, ROUND(SUM(n.value)/1000000000, 4) AS Highest_Annual_Revenue_Billions
FROM `bigquery-public-data.sec_quarterly_financials.numbers` n
JOIN `bigquery-public-data.sec_quarterly_financials.submission` s
  ON n.submission_number = s.submission_number
WHERE n.number_of_quarters = 4
  AND n.period_end_date BETWEEN 20160101 AND 20161231
  AND n.measure_tag = 'Revenues'
  AND n.value > 0
  AND s.countryba = 'US'
  AND s.stprba IS NOT NULL
  AND s.stprba != ''
GROUP BY s.stprba
ORDER BY Highest_Annual_Revenue_Billions DESC
LIMIT 1;You need to follow the format's positive signs.

2025-01-27 03:25:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 03:25:10 - root - INFO - ```sql
SELECT s.stprba AS State, ROUND(SUM(n.value)/1000000000, 4) AS Highest_Annual_Revenue_Billions
FROM `bigquery-public-data.sec_quarterly_financials.numbers` n
JOIN `bigquery-public-data.sec_quarterly_financials.submission` s
  ON n.submission_number = s.submission_number
WHERE n.number_of_quarters = 4
  AND n.period_end_date BETWEEN 20160101 AND 20161231
  AND n.measure_tag = 'Revenues'
  AND n.value > 0
  AND s.countryba = 'US'
  AND s.stprba IS NOT NULL
  AND s.stprba != ''
GROUP BY s.stprba
ORDER BY Highest_Annual_Revenue_Billions DESC
LIMIT 1;
```
2025-01-27 03:25:12 - root - INFO - itercount: 4
2025-01-27 03:25:12 - root - INFO - 0
2025-01-27 03:25:12 - root - INFO - Total iteration counts: 4
