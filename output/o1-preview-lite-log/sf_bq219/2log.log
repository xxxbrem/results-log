2025-01-24 02:11:27 - openai._base_client - INFO - Retrying request to /chat/completions in 0.402444 seconds
2025-01-24 02:12:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 02:12:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 02:12:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 02:12:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 02:12:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 02:12:19 - snowflake.connector.connection - INFO - closed
2025-01-24 02:12:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 02:12:19 - root - INFO - SQL:
SELECT *
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   LIMIT 100;
Results:
Too long, hard cut:
invoice_and_item_number,date,store_number,store_name,address,city,zip_code,store_location,county_number,county,category,category_name,vendor_number,vendor_name,item_number,item_description,pack,bottle_volume_ml,state_bottle_cost,state_bottle_retail,bottles_sold,sale_dollars,volume_sold_liters,volume_sold_gallons
RINV-05376800029,2024-08-08,10241,"FAREWAY STORES, INC. #237 / LE CLAIRE",1301 EAGLE RIDGE ROAD,LE CLAIRE,52753.0,bytearray(b'\x01\x01\x00\x00\x00 \x91\xc3\x1b\n\x97V\xc0\xe0\x12\x80\x7fJ\xcbD@'),,SCOTT,1031100.0,AMERICAN VODKAS,434,LUXCO INC,36308,HAWKEYE VODKA,6,1750,7.5,11.25,-12,-135.0,-21.0,-5.54
RINV-04825600013,2023-08-30,5512,CASEY'S GENERAL STORE #3639 / POSTVILLE,620 W TILDEN ST,POSTVILLE,52162.0,bytearray(b'\x01\x01\x00\x00\x00[\x7f\xa1\x00\x17\xe5V\xc0\x85.\xf5\xb4\xc2\x8aE@'),,ALLAMAKEE,1012100.0,CANADIAN WHISKIES,259,HEAVEN HILL BRANDS,10550,BLACK VELVET TOASTED CARAMEL,12,750,5.74,8.61,-24,-206.64,-18.0,-4.75
RINV-04673900228,2023-06-06,2633,HY-VEE #3 / BDI / DES MOINES,3221 SE 14TH ST,DES MOINES,50320.0,bytearray(b'\x01\x01\x00\x00\x00\x9a\xae4\xe4\x10fW\xc0M\x07@I\xf2\xc6D@'),,POLK,1041100.0,AMERICAN DRY GINS,421,SAZERAC COMPANY  INC,29287,BARTON GIN,12,1000,3.92,5.88,-12,-70.56,-12.0,-3.17
RINV-04933100044,2023-11-01,10227,GRIMES LIQUOR SHOP / GRIMES,3600 SOUTHEAST CROSSROADS DRIVE,GRIMES,50111.0,bytearray(b'\x01\x01\x00\x00\x00\x8a\xf1*\x03xqW\xc0q\xa2e\xf6\\\xd4D@'),,POLK,1062400.0,SPICED RUM,260,DIAGEO AMERICAS,43337,CAPTAIN MORGAN ORIGINAL SPICED,12,1000,12.99,19.49,-12,-233.88,-12.0,-3.17
RINV-04774000149,2023-07-27,3456,QUICK SHOP / CLEAR LAKE,904 N 8TH ST,CLEARLAKE,50428.0,bytearray(b'\x01\x01\x00\x00\x00\x13w\xc4:8XW\xc0\x98\x05\\UK\x92E@'),,CERRO GORDO,1081200.0,CREAM LIQUEURS,259,HEAVEN HILL BRANDS,68127,CAROLANS IRISH CREAM,12,1000,12.5,18.75,-12,-225.0,-12.0,-3.17
RINV-05329400157,2024-07-03,2633,HY-VEE #3 / BDI / DES MOINES,3221 SE 14TH ST,DES MOINES,50320.0,bytearray(b'\x01\x01\x00\x00\x00\x9a\xae4\xe4\x10fW\xc0M\x07@I\xf2\xc6D@'),,POLK,1022200.0,100% AGAVE TEQUILA,192,"MAST-JAGERMEISTER US, INC",88355,TEREMANA BLANCO TEQUILA,6,1000,18.46,27.69,-12,-332.28,-12.0,-3.17
RINV-05228700034,2024-04-18,3354,SAM'S CLUB 8238 / DAVENPORT,3845 ELMORE AVE.,DAVENPORT,52807.0,bytearray(b'\x01\x01\x00\x00\x00\xc9\x83\xedZ\xb4\xa1V\xc0\x9e\x9f\xf6\x1cW\xc7D@'),,SCOTT,1022100.0,MIXTO TEQUILA,421,SAZERAC COMPANY  INC,89577,MONTEZUMA GOLD,12,1000,7.5,11.25,-12,-135.0,-12.0,-3.17
RINV-05163600144,2024-03-04,2191,KEOKUK SPIRITS,1013 MAIN,KEOKUK,52632.0,bytearray(b'\x01\x01\x00\x00\x00\xd7L\xb9 \xcd\xd8V\xc0<Jb\x9f93D@'),,LEE,1011200.0,STRAIGHT BOURBON WHISKIES,65,JIM BEAM BRANDS,19070,JIM BEAM PET,6,1750,21.5,32.25,-6,-193.5,-10.5,-2.77
RINV-05064800052,2024-01-03,2652,HY-VEE DRUGSTORE / MASON CITY,875  4TH ST SW,MASON CITY,50401.0,bytearray(b'\x01\x01\x00\x00\x00\xa4\x85J\xaa\xb6MW\xc0\xa4 )6\xe7\x92E@'),,CERRO GORDO,1071000.0,COCKTAILS/RTD,395,PROXIMO,58838,JOSE CUERVO AUTHENTIC LIME MARGARITA,6,1750,8.74,13.11,-6,-78.66,-10.5,-2.77
RINV-04313200070,2022-10-12,4877,WORLD LIQUOR & TOBACCO,1775 NW 86TH ST,CLIVE,50325.0,bytearray(b'\x01\x01\x00\x00\x00\x1aO\x04q\x1eoW\xc06\x01\x86\xe5\xcf\xcdD@'),,POLK,1071000.0,COCKTAILS/RTD,395,PROXIMO,59162,1800 ULTIMATE PINEAPPLE MARGARITA PET,6,1750,10.04,15.06,-6,-90.36,-10.5,-2.77
RINV-04860600095,2023-09-21,2549,HY-VEE FOOD STORE (1271) / INDIANOLA,910 N JEFFERSON,INDIANOLA,50125.0,bytearray(b'\x01\x01\x00\x00\x00\xc6\x13\x07\xf1\x9dcW\xc0\xa3k\x9e\xa42\xafD@'),,WARREN,1031200.0,AMERICAN FLAVORED VODKA,260,DIAGEO AMERICAS,77994,"SMIRNOFF RED, WHITE & BERRY",6,1750,14.75,22.13,-6,-132.78,-10.5,-2.77
RINV-05111400054,2024-01-30,10200,"MUGHAL, INC. / WATERLOO",735 LOGAN AVE.,WATERLOO,50703.0,bytearray(b'\x01\x01\x00\x00\x00\xe1D$\xa5\xa1\x15W\xc0SP\xdd\x9eXAE@'),,BLACK HAWK,1022200.0,100% AGAVE TEQUILA,395,PROXIMO,87402,JOSE CUERVO ESPECIAL SILVER,48,200,3.63,5.45,-48,-261.6,-9.6,-2.53
RINV-05005400039,2023-12-06,3814,COSTCO WHOLESALE #788 / WDM,7205 MILLS CIVIC PKWY,WEST DES MOINES,50266.0,bytearray(b'\x01\x01\x00\x00\x00\x0bhxl\x91sW\xc0\xeb`Fv\xfa\xc7D@'),,DALLAS,1011200.0,STRAIGHT BOURBON WHISKIES,125,CEDAR RIDGE VINEYARDS LL,17206,CEDAR RIDGE BOURBON,6,750,18.67,28.01,-12,-336.12,-9.0,-2.37
RINV-05281100030,2024-06-03,6201,NEIGHBORHOOD TOBACCO OUTLET / MARION,2500 7TH AVENUE,MARION,52302.0,bytearray(b'\x01\x01\x00\x00\x00;3\x08Fz\xe5V\xc0\xdb\xe3\xf9\xcaK\x04E@'),,LINN,1031100.0,AMERICAN VODKAS,300,MCCORMICK DISTILLING CO.,36886,MCCORMICK 80PRF VODKA,12,750,3.64,5.46,-12,-65.52,-9.0,-2.37
RINV-05170600034,2024-03-12,5507,QUIK TRIP #559 / FLEUR,4021 FLEUR DR,DES MOINES,50321.0,bytearray(b'\x01\x01\x00\x00\x00zKg\x977iW\xc0\xc7\xceU\x9f\x1d\xc6D@'),,POLK,1031100.0,AMERICAN VODKAS,300,MCCORMICK DISTILLING CO.,36904,MCCORMICK 80PRF VODKA PET,24,375,1.84,2.76,-24,-66.24,-9.0,-2.37
RINV-04674100037,2023-06-06,10200,"MUGHAL, INC. / WATERLOO",735 LOGAN AVE.,WATERLOO,50703.0,bytearray(b'\x01\x01\x00\x00\x00\xe0D$\xa5\xa1\x15W\xc0XP\xdd\x9eXAE@'),,BLACK HA

2025-01-24 02:12:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 02:12:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 02:12:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 02:12:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 02:12:21 - snowflake.connector.connection - INFO - closed
2025-01-24 02:12:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 02:12:21 - root - INFO - SQL:
SELECT DISTINCT "category", "category_name"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   LIMIT 100;
Results:
category,category_name
1011700.0,CORN WHISKIES
1081030.0,COFFEE LIQUEURS
1081230.0,WHITE CREME DE CACAO
1062500.0,
1501100.0,HIGH PROOF BEER - AMERICAN
1082200.0,IMPORTED SCHNAPPS
1052100.0,IMPORTED BRANDIES
1062200.0,WHITE RUM
1062300.0,AGED DARK RUM
1701100.0,DECANTERS & SPECIALTY PACKAGES
1071000.0,COCKTAILS/RTD
1091200.0,NEUTRAL GRAIN SPIRITS
1082000.0,IMPORTED CORDIALS & LIQUEURS
1051150.0,MISCELLANEOUS  BRANDIES
1011300.0,SINGLE BARREL BOURBON WHISKIES
1032200.0,IMPORTED VODKA - MISC
1081015.0,IMPORTED AMARETTO
1071100.0,AMERICAN COCKTAILS
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY
1022300.0,MEZCAL
1701200.0,HOLIDAY VAP
1081240.0,GREEN CREME DE MENTHE
1701100.0,TEMPORARY & SPECIALTY PACKAGES
1081390.0,IMPORTED SCHNAPPS
1031100.0,AMERICAN VODKAS
1081600.0,WHISKEY LIQUEUR
1012400.0,JAPANESE WHISKY
1051100.0,APRICOT BRANDIES
1011400.0,TENNESSEE WHISKIES
1081400.0,TRIPLE SEC
1011600.0,STRAIGHT RYE WHISKIES
1031080.0,VODKA 80 PROOF
1011700.0,
1011500.0,STRAIGHT RYE WHISKIES
1081250.0,WHITE CREME DE MENTHE
1011800.0,IOWA DISTILLERY WHISKIES
1090000.0,DISTILLED SPIRITS SPECIALTY
1081370.0,WATERMELON SCHNAPPS
1081380.0,MISCELLANEOUS SCHNAPPS
1081340.0,ROOT BEER SCHNAPPS
1041100.0,AMERICAN DRY GINS
1051110.0,BLACKBERRY BRANDIES
1052010.0,IMPORTED GRAPE BRANDIES
1031100.0,100 PROOF VODKA
1062100.0,GOLD RUM
1041200.0,AMERICAN SLOE GINS
1081500.0,ROCK & RYE
1081900.0,MISC. AMERICAN CORDIALS & LIQUEURS
1081700.0,DISTILLED SPIRITS SPECIALTY
1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED
1081355.0,STRAWBERRY SCHNAPPS
1081305.0,APPLE SCHNAPPS
1041300.0,AMERICAN SLOE GINS
1082100.0,
1032080.0,IMPORTED VODKAS
1091400.0,IOWA DISTILLERIES
1022200.0,100% AGAVE TEQUILA
1051120.0,CHERRY BRANDIES
1081200.0,CREAM LIQUEURS
1082900.0,MISC. IMPORTED CORDIALS & LIQUEURS
1011100.0,BLENDED WHISKIES
1011250.0,SINGLE BARREL BOURBON WHISKIES
1082200.0,
1081220.0,DARK CREME DE CACAO
1031200.0,AMERICAN FLAVORED VODKA
1070000.0,COCKTAILS/RTD
1011600.0,CORN WHISKIES
1011300.0,TENNESSEE WHISKIES
1022200.0,
1012300.0,SINGLE MALT SCOTCH
1081000.0,AMERICAN CORDIALS & LIQUEURS
1051140.0,PEACH BRANDIES
1081315.0,CINNAMON SCHNAPPS
1041200.0,FLAVORED GIN
1081312.0,BUTTERSCOTCH SCHNAPPS
1012210.0,SINGLE MALT SCOTCH
1041150.0,FLAVORED GINS
1012200.0,SCOTCH WHISKIES
1081330.0,PEACH SCHNAPPS
1011400.0,BOTTLED IN BOND BOURBON
1032000.0,IMPORTED VODKAS
1091100.0,
1700000.0,TEMPORARY & SPECIALTY PACKAGES
1901000.0,SPECIAL ORDER ITEMS
1081300.0,PEPPERMINT SCHNAPPS
1051100.0,AMERICAN BRANDIES
1062400.0,SPICED RUM
1081365.0,TROPICAL FRUIT SCHNAPPS
1082100.0,IMPORTED CORDIALS & LIQUEURS
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY
1042100.0,IMPORTED DRY GINS
1062300.0,FLAVORED RUM
1032200.0,IMPORTED FLAVORED VODKA
1031090.0,OTHER PROOF VODKA
1081400.0,AMERICAN SCHNAPPS
1081210.0,CREME DE ALMOND
1081500.0,TRIPLE SEC
1062400.0,
1051010.0,AMERICAN GRAPE BRANDIES
1031200.0,VODKA FLAVORED

2025-01-24 02:12:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 02:12:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 02:12:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 02:12:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 02:12:23 - snowflake.connector.connection - INFO - closed
2025-01-24 02:12:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 02:12:23 - root - INFO - SQL:
SELECT MIN("date") AS "start_date", MAX("date") AS "end_date"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES";
Results:
start_date,end_date
2012-01-03,2024-09-30

2025-01-24 02:12:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 02:12:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 02:12:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 02:12:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 02:12:24 - snowflake.connector.connection - INFO - closed
2025-01-24 02:12:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 02:12:25 - root - INFO - SQL:
SELECT DATE_TRUNC('month', "date") AS "sale_month", COUNT(*) AS "num_sales"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   GROUP BY "sale_month"
   ORDER BY "sale_month"
   LIMIT 100;
Results:
sale_month,num_sales
2012-01-01,147770
2012-02-01,156728
2012-03-01,160535
2012-04-01,164970
2012-05-01,192270
2012-06-01,169344
2012-07-01,180983
2012-08-01,190763
2012-09-01,149230
2012-10-01,197168
2012-11-01,168615
2012-12-01,203683
2013-01-01,162997
2013-02-01,150846
2013-03-01,155189
2013-04-01,177752
2013-05-01,178481
2013-06-01,157047
2013-07-01,195087
2013-08-01,169615
2013-09-01,165463
2013-10-01,189553
2013-11-01,149057
2013-12-01,212676
2014-01-01,158228
2014-02-01,149853
2014-03-01,160399
2014-04-01,177106
2014-05-01,165048
2014-06-01,185136
2014-07-01,187997
2014-08-01,173094
2014-09-01,171399
2014-10-01,180683
2014-11-01,157228
2014-12-01,231625
2015-01-01,158795
2015-02-01,158636
2015-03-01,179195
2015-04-01,180736
2015-05-01,169613
2015-06-01,205269
2015-07-01,182494
2015-08-01,178742
2015-09-01,189607
2015-10-01,174460
2015-11-01,176337
2015-12-01,230599
2016-01-01,159083
2016-02-01,172613
2016-03-01,193373
2016-04-01,171314
2016-05-01,199812
2016-06-01,208530
2016-07-01,173150
2016-08-01,206093
2016-09-01,185409
2016-10-01,189070
2016-11-01,195943
2016-12-01,225503
2017-01-01,171825
2017-02-01,160636
2017-03-01,191376
2017-04-01,172927
2017-05-01,209386
2017-06-01,203522
2017-07-01,187824
2017-08-01,212123
2017-09-01,172334
2017-10-01,201145
2017-11-01,195011
2017-12-01,213167
2018-01-01,190636
2018-02-01,165349
2018-03-01,186658
2018-04-01,187376
2018-05-01,218829
2018-06-01,200682
2018-07-01,189807
2018-08-01,214837
2018-09-01,168729
2018-10-01,213648
2018-11-01,196608
2018-12-01,222399
2019-01-01,187751
2019-02-01,169732
2019-03-01,175898
2019-04-01,197285
2019-05-01,217698
2019-06-01,191634
2019-07-01,212719
2019-08-01,201650
2019-09-01,183682
2019-10-01,208036
2019-11-01,201009
2019-12-01,233251
2020-01-01,191430
2020-02-01,171814
2020-03-01,214064
2020-04-01,219677

2025-01-24 02:12:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 02:12:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 02:12:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 02:12:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 02:12:26 - snowflake.connector.connection - INFO - closed
2025-01-24 02:12:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 02:12:27 - root - INFO - SQL:
SELECT "category_name", SUM("volume_sold_liters") AS "total_volume_liters"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   GROUP BY "category_name"
   ORDER BY "total_volume_liters" DESC
   LIMIT 100;
Results:
category_name,total_volume_liters
AMERICAN VODKAS,43578325.989999995
CANADIAN WHISKIES,35353278.57000001
SPICED RUM,18085561.13
VODKA 80 PROOF,17797396.77
STRAIGHT BOURBON WHISKIES,13291240.160000002
WHISKEY LIQUEUR,11803035.06
IMPORTED VODKAS,10417847.389999999
BLENDED WHISKIES,10343125.129999999
COCKTAILS/RTD,7344877.079999998
TENNESSEE WHISKIES,6199089.470000001
FLAVORED RUM,5807658.770000001
AMERICAN FLAVORED VODKA,5654748.53
WHITE RUM,4705618.079999998
MIXTO TEQUILA,4690751.700000002
AMERICAN DRY GINS,4607653.109999999
CREAM LIQUEURS,4222257.319999999
100% AGAVE TEQUILA,4201076.459999999
AMERICAN SCHNAPPS,3931786.6799999992
PUERTO RICO & VIRGIN ISLANDS RUM,3889666.920000001
IMPORTED SCHNAPPS,3670160.72
TEQUILA,3351430.860000001
AMERICAN BRANDIES,3296756.1300000013
AMERICAN COCKTAILS,3206271.179999999
SCOTCH WHISKIES,3150192.29
VODKA FLAVORED,2907612.7600000002
IRISH WHISKIES,2818290.6400000006
IMPORTED CORDIALS & LIQUEURS,2680998.6899999995
TRIPLE SEC,2350501.66
IMPORTED DRY GINS,2310817.4900000007
TEMPORARY & SPECIALTY PACKAGES,2284119.1800000006
IMPORTED BRANDIES,2177553.7
IMPORTED FLAVORED VODKA,2038622.7999999996
AMERICAN CORDIALS & LIQUEURS,1908081.46
IMPORTED DISTILLED SPIRITS SPECIALTY,1848275.3599999994
MISC. IMPORTED CORDIALS & LIQUEURS,1453209.46
IMPORTED VODKA - MISC,1301889.4400000004
AMERICAN GRAPE BRANDIES,1293088.4699999997
STRAIGHT RYE WHISKIES,1179474.28
SPECIAL ORDER ITEMS,1175383.47
COFFEE LIQUEURS,1156503.3600000003
100 PROOF VODKA,959031.72
GOLD RUM,817480.3100000002
PEPPERMINT SCHNAPPS,789853.1800000003
SINGLE MALT SCOTCH,758599.15
DISTILLED SPIRITS SPECIALTY,754358.4700000001
MISC. AMERICAN CORDIALS & LIQUEURS,688978.18
IMPORTED GRAPE BRANDIES,659869.7899999999
DECANTERS & SPECIALTY PACKAGES,522822.8700000001
PEACH SCHNAPPS,518755.75000000006
AMERICAN AMARETTO,414314.4900000001
NEUTRAL GRAIN SPIRITS FLAVORED,412364.17
BLACKBERRY BRANDIES,373640.73000000004
AMERICAN DISTILLED SPIRITS SPECIALTY,305283.0300000001
NEUTRAL GRAIN SPIRITS,290027.92000000004
AGED DARK RUM,285129.8
APPLE SCHNAPPS,224426.81000000003
SINGLE BARREL BOURBON WHISKIES,203549.70000000004
,191247.9
BUTTERSCOTCH SCHNAPPS,190362.58
APRICOT BRANDIES,180888.7199999999
AMERICAN ALCOHOL,171628.80000000002
BOTTLED IN BOND BOURBON,168498.23
CINNAMON SCHNAPPS,151383.76999999993
WATERMELON SCHNAPPS,147316.75
GRAPE SCHNAPPS,133591.0
MISCELLANEOUS SCHNAPPS,133371.15
FLAVORED GIN,121226.04999999996
ROOT BEER SCHNAPPS,93714.25
JAMAICA RUM,65725.0
PEACH BRANDIES,64483.36000000002
IMPORTED AMARETTO,64228.78000000001
CORN WHISKIES,62460.400000000016
RASPBERRY SCHNAPPS,61734.5
MEZCAL,59139.799999999996
CHERRY BRANDIES,56881.819999999985
AMERICAN SLOE GINS,56105.0
TROPICAL FRUIT SCHNAPPS,54243.25
STRAWBERRY SCHNAPPS,54208.5
FLAVORED GINS,45033.450000000004
BARBADOS RUM,44283.07
GREEN CREME DE MENTHE,34282.5
WHITE CREME DE CACAO,26446.5
DARK CREME DE CACAO,24541.5
SPEARMINT SCHNAPPS,18743.25
MISCELLANEOUS  BRANDIES,16564.99
OTHER PROOF VODKA,13520.5
IOWA DISTILLERIES,12138.75
ROCK & RYE,9125.25
WHITE CREME DE MENTHE,7937.25
IOWA DISTILLERY WHISKIES,7452.37
LOW PROOF VODKA,6966.0
CREME DE ALMOND,4998.0
ANISETTE,4072.5
JAPANESE WHISKY,1313.7
AMARETTO - IMPORTED,1131.75
SCHNAPPS - IMPORTED,288.06
IMPORTED GINS,234.0
IMPORTED VODKA - CHERRY,222.0
DELISTED ITEMS,111.98000000000002
HOLIDAY VAP,106.89999999999999

2025-01-24 02:12:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 02:12:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 02:12:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 02:12:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 02:12:28 - snowflake.connector.connection - INFO - closed
2025-01-24 02:12:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 02:12:28 - root - INFO - SQL:
SELECT DATE_TRUNC('month', "date") AS "sale_month", "category_name", SUM("volume_sold_liters") AS "monthly_volume_liters"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   GROUP BY "sale_month", "category_name"
   ORDER BY "sale_month", "monthly_volume_liters" DESC
   LIMIT 100;
Results:
sale_month,category_name,monthly_volume_liters
2012-01-01,VODKA 80 PROOF,239276.21999999994
2012-01-01,CANADIAN WHISKIES,129605.65
2012-01-01,SPICED RUM,83884.33
2012-01-01,BLENDED WHISKIES,67090.80000000002
2012-01-01,PUERTO RICO & VIRGIN ISLANDS RUM,59032.55000000001
2012-01-01,STRAIGHT BOURBON WHISKIES,53386.65
2012-01-01,AMERICAN COCKTAILS,50729.25000000001
2012-01-01,IMPORTED VODKAS,43234.12999999998
2012-01-01,TEQUILA,43016.159999999996
2012-01-01,VODKA FLAVORED,40753.850000000006
2012-01-01,FLAVORED RUM,28902.119999999995
2012-01-01,AMERICAN DRY GINS,28517.210000000003
2012-01-01,IMPORTED SCHNAPPS,26458.480000000003
2012-01-01,MISC. IMPORTED CORDIALS & LIQUEURS,25854.41
2012-01-01,WHISKEY LIQUEUR,24708.829999999994
2012-01-01,TENNESSEE WHISKIES,24678.309999999994
2012-01-01,AMERICAN GRAPE BRANDIES,20746.229999999996
2012-01-01,SCOTCH WHISKIES,18373.059999999998
2012-01-01,IMPORTED VODKA - MISC,18280.940000000002
2012-01-01,CREAM LIQUEURS,18068.86
2012-01-01,MISC. AMERICAN CORDIALS & LIQUEURS,14408.49
2012-01-01,100 PROOF VODKA,14100.75
2012-01-01,PEPPERMINT SCHNAPPS,12748.23
2012-01-01,TRIPLE SEC,11289.5
2012-01-01,PEACH SCHNAPPS,9345.220000000001
2012-01-01,DISTILLED SPIRITS SPECIALTY,9261.75
2012-01-01,AMERICAN AMARETTO,8013.5
2012-01-01,IMPORTED DRY GINS,7838.710000000001
2012-01-01,BLACKBERRY BRANDIES,7161.85
2012-01-01,COFFEE LIQUEURS,7132.12
2012-01-01,IMPORTED GRAPE BRANDIES,7040.82
2012-01-01,IRISH WHISKIES,6428.459999999999
2012-01-01,STRAIGHT RYE WHISKIES,5481.37
2012-01-01,APPLE SCHNAPPS,5160.99
2012-01-01,BUTTERSCOTCH SCHNAPPS,4265.61
2012-01-01,CINNAMON SCHNAPPS,3796.8900000000003
2012-01-01,APRICOT BRANDIES,3403.62
2012-01-01,GRAPE SCHNAPPS,2912.0
2012-01-01,AMERICAN ALCOHOL,2850.0
2012-01-01,SINGLE MALT SCOTCH,2638.24
2012-01-01,DECANTERS & SPECIALTY PACKAGES,2574.7600000000007
2012-01-01,WATERMELON SCHNAPPS,2522.0
2012-01-01,MISCELLANEOUS SCHNAPPS,2234.15
2012-01-01,ROOT BEER SCHNAPPS,2002.25
2012-01-01,IMPORTED AMARETTO,1526.6600000000003
2012-01-01,RASPBERRY SCHNAPPS,1363.0
2012-01-01,TROPICAL FRUIT SCHNAPPS,1328.75
2012-01-01,STRAWBERRY SCHNAPPS,1156.5
2012-01-01,CHERRY BRANDIES,1091.2600000000002
2012-01-01,JAMAICA RUM,987.75
2012-01-01,FLAVORED GINS,592.5
2012-01-01,WHITE CREME DE CACAO,590.25
2012-01-01,AMERICAN SLOE GINS,554.5
2012-01-01,GREEN CREME DE MENTHE,550.5
2012-01-01,PEACH BRANDIES,545.25
2012-01-01,DARK CREME DE CACAO,411.0
2012-01-01,SPEARMINT SCHNAPPS,319.75
2012-01-01,BOTTLED IN BOND BOURBON,293.25
2012-01-01,SINGLE BARREL BOURBON WHISKIES,279.0
2012-01-01,MISCELLANEOUS  BRANDIES,241.5
2012-01-01,,210.75
2012-01-01,OTHER PROOF VODKA,207.75
2012-01-01,BARBADOS RUM,165.0
2012-01-01,CREME DE ALMOND,120.75
2012-01-01,ROCK & RYE,120.0
2012-01-01,WHITE CREME DE MENTHE,92.25
2012-01-01,ANISETTE,51.0
2012-01-01,SCHNAPPS - IMPORTED,45.0
2012-01-01,LOW PROOF VODKA,17.25
2012-01-01,IMPORTED VODKA - CHERRY,12.0
2012-02-01,VODKA 80 PROOF,242492.5300000001
2012-02-01,CANADIAN WHISKIES,234011.37
2012-02-01,SPICED RUM,104165.01000000001
2012-02-01,PUERTO RICO & VIRGIN ISLANDS RUM,65527.96999999999
2012-02-01,BLENDED WHISKIES,64533.06999999999
2012-02-01,STRAIGHT BOURBON WHISKIES,55334.090000000004
2012-02-01,TEQUILA,50106.09000000001
2012-02-01,IMPORTED VODKAS,47198.92
2012-02-01,AMERICAN COCKTAILS,43200.46000000002
2012-02-01,VODKA FLAVORED,39213.13
2012-02-01,TENNESSEE WHISKIES,31079.479999999992
2012-02-01,AMERICAN DRY GINS,31011.36
2012-02-01,MISC. IMPORTED CORDIALS & LIQUEURS,28062.440000000002
2012-02-01,FLAVORED RUM,27770.16
2012-02-01,WHISKEY LIQUEUR,27391.750000000004
2012-02-01,IMPORTED SCHNAPPS,26289.489999999998
2012-02-01,MISC. AMERICAN CORDIALS & LIQUEURS,22095.469999999998
2012-02-01,CREAM LIQUEURS,21083.790000000008
2012-02-01,SCOTCH WHISKIES,20511.149999999998
2012-02-01,IMPORTED VODKA - MISC,20453.409999999996
2012-02-01,AMERICAN GRAPE BRANDIES,20244.24
2012-02-01,100 PROOF VODKA,14163.0
2012-02-01,PEPPERMINT SCHNAPPS,12880.189999999997
2012-02-01,TRIPLE SEC,12369.5
2012-02-01,IRISH WHISKIES,11407.809999999998
2012-02-01,IMPORTED GRAPE BRANDIES,10588.62
2012-02-01,DISTILLED SPIRITS SPECIALTY,10545.5
2012-02-01,IMPORTED DRY GINS,9061.089999999997
2012-02-01,PEACH SCHNAPPS,8998.589999999998
2012-02-01,AMERICAN AMARETTO,8527.0

2025-01-24 02:12:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 02:12:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 02:12:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 02:12:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 02:12:30 - snowflake.connector.connection - INFO - closed
2025-01-24 02:12:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 02:12:30 - root - INFO - SQL:
SELECT
       "sale_month",
       "category_name",
       "monthly_volume_liters",
       "total_monthly_volume",
       ("monthly_volume_liters" / "total_monthly_volume") * 100 AS "percentage_contribution"
   FROM (
       SELECT
           DATE_TRUNC('month', "date") AS "sale_month",
           "category_name",
           SUM("volume_sold_liters") AS "monthly_volume_liters",
           SUM(SUM("volume_sold_liters")) OVER (PARTITION BY DATE_TRUNC('month', "date")) AS "total_monthly_volume"
       FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
       GROUP BY "sale_month", "category_name"
   )
   ORDER BY "sale_month", "percentage_contribution" DESC
   LIMIT 100;
Results:
Too long, hard cut:
sale_month,category_name,monthly_volume_liters,total_monthly_volume,percentage_contribution
2012-01-01,VODKA 80 PROOF,239276.21999999994,1212082.49,19.740918788456383
2012-01-01,CANADIAN WHISKIES,129605.65000000001,1212082.49,10.692807714762056
2012-01-01,SPICED RUM,83884.33000000002,1212082.49,6.920678311259164
2012-01-01,BLENDED WHISKIES,67090.8,1212082.49,5.535167825087549
2012-01-01,PUERTO RICO & VIRGIN ISLANDS RUM,59032.55000000001,1212082.49,4.870340961694778
2012-01-01,STRAIGHT BOURBON WHISKIES,53386.649999999994,1212082.49,4.404539331312343
2012-01-01,AMERICAN COCKTAILS,50729.25000000002,1212082.49,4.185296827446127
2012-01-01,IMPORTED VODKAS,43234.13,1212082.49,3.566929673243609
2012-01-01,TEQUILA,43016.159999999996,1212082.49,3.5489465737600083
2012-01-01,VODKA FLAVORED,40753.85,1212082.49,3.3623000361963813
2012-01-01,FLAVORED RUM,28902.119999999995,1212082.49,2.384501074675206
2012-01-01,AMERICAN DRY GINS,28517.210000000003,1212082.49,2.3527449852031115
2012-01-01,IMPORTED SCHNAPPS,26458.480000000007,1212082.49,2.182894334196677
2012-01-01,MISC. IMPORTED CORDIALS & LIQUEURS,25854.41,1212082.49,2.133056967104607
2012-01-01,WHISKEY LIQUEUR,24708.829999999994,1212082.49,2.0385435978041393
2012-01-01,TENNESSEE WHISKIES,24678.31,1212082.49,2.036025617365366
2012-01-01,AMERICAN GRAPE BRANDIES,20746.230000000003,1212082.49,1.7116186539416145
2012-01-01,SCOTCH WHISKIES,18373.059999999998,1212082.49,1.5158258741944204
2012-01-01,IMPORTED VODKA - MISC,18280.940000000002,1212082.49,1.5082257314021592
2012-01-01,CREAM LIQUEURS,18068.86,1212082.49,1.4907285724422932
2012-01-01,MISC. AMERICAN CORDIALS & LIQUEURS,14408.49,1212082.49,1.1887384001397463
2012-01-01,100 PROOF VODKA,14100.75,1212082.49,1.1633490390575645
2012-01-01,PEPPERMINT SCHNAPPS,12748.23,1212082.49,1.0517625743442593
2012-01-01,TRIPLE SEC,11289.5,1212082.49,0.9314135047029678
2012-01-01,PEACH SCHNAPPS,9345.220000000001,1212082.49,0.7710052803419346
2012-01-01,DISTILLED SPIRITS SPECIALTY,9261.75,1212082.49,0.7641187853476871
2012-01-01,AMERICAN AMARETTO,8013.5,1212082.49,0.6611348704492876
2012-01-01,IMPORTED DRY GINS,7838.710000000003,1212082.49,0.6467142347712657
2012-01-01,BLACKBERRY BRANDIES,7161.85,1212082.49,0.5908715008332478
2012-01-01,COFFEE LIQUEURS,7132.12,1212082.49,0.5884186974766049
2012-01-01,IMPORTED GRAPE BRANDIES,7040.820000000002,1212082.49,0.5808862068455425
2012-01-01,IRISH WHISKIES,6428.459999999999,1212082.49,0.5303648929042775
2012-01-01,STRAIGHT RYE WHISKIES,5481.37,1212082.49,0.4522274717457555
2012-01-01,APPLE SCHNAPPS,5160.99,1212082.49,0.4257952773494814
2012-01-01,BUTTERSCOTCH SCHNAPPS,4265.61,1212082.49,0.35192406747827865
2012-01-01,CINNAMON SCHNAPPS,3796.8900000000012,1212082.49,0.3132534321158291
2012-01-01,APRICOT BRANDIES,3403.62,1212082.49,0.2808076206100461
2012-01-01,GRAPE SCHNAPPS,2912.0,1212082.49,0.2402476748921602
2012-01-01,AMERICAN ALCOHOL,2850.0,1212082.49,0.23513251148442876
2012-01-01,SINGLE MALT SCOTCH,2638.24,1212082.49,0.21766175336795762
2012-01-01,DECANTERS & SPECIALTY PACKAGES,2574.76,1212082.49,0.21242448605952557
2012-01-01,WATERMELON SCHNAPPS,2522.0,1212082.49,0.20807164700481728
2012-01-01,MISCELLANEOUS SCHNAPPS,2234.15,1212082.49,0.18432326334489002
2012-01-01,ROOT BEER SCHNAPPS,2002.25,1212082.49,0.1651909021472623
2012-01-01,IMPORTED AMARETTO,1526.6600000000003,1212082.49,0.12595347367818177
2012-01-01,RASPBERRY SCHNAPPS,1363.0,1212082.49,0.11245109233448294
2012-01-01,TROPICAL FRUIT SCHNAPPS,1328.75,1212082.49,0.10962537706488938
2012-01-01,STRAWBERRY SCHNAPPS,1156.5,1212082.49,0.09541429808131294
2012-01-01,CHERRY BRANDIES,1091.2599999999998,1212082.49,0.09003182613420971
2012-01-01,JAMAICA RUM,987.75,1212082.49,0.0814919783223665
2012-01-01,FLAVORED GINS,592.5,1212082.49,0.04888281159807861
2012-01-01,WHITE CREME DE CACAO,590.25,1212082.49,0.048697180667959326
2012-01-01,AMERICAN SLOE GINS,554.5,1212082.49,0.04574771144495289
2012-01-01,GREEN CREME DE MENTHE,550.5,1212082.49,0.04541770090251861
2012-01-01,PEACH BRANDIES,545.25,1212082.49,0.04498456206557361
2012-01-01,DARK CREME DE CACAO,411.0,1212082.49,0.033908583235122886
2012-01-01,SPEARMINT SCHNAPPS,319.75,1212082.49,0.026380217735840737
2012-01-01,BOTTLED IN BOND BOURBON,293.25,1212082.49,0.02419389789221359
2012-01-01,SINGLE BARREL BOURBON WHISKIES,279.0,1212082.49,0.023018235334791446
2012-01-01,MISCELLANEOUS  BRANDIES,241.5,1212082.49,0.019924386499470016
2012-01-01,,210.75,1212082.49,0.017387430454506442
2012-01-01,OTHER PROOF VODKA,207.75,1212082.49,0.01713992254768073
2012-01-01,BARBADOS RUM,165.0,1212082.49,0.013612934875414297
2012-01-01,CREME DE ALMOND,120.75,1212082.49,0.009962193249735008
2012-01-01,ROCK & RYE,120.0,1212082.49,0.009900316273028578
2012-01-01,WHITE CREME DE MENTHE,92.25,1212082.49,0.00761086813489072
2012-01-01,ANISETTE,51.0,1212082.49,0.004207634416037146
2012-01-01,SCHNAPPS - IMPORTED,45.0,1212082.49,0.003712618602385717
2012-01-01,LOW PROOF VODKA,17.25,1212082.49,0.0014231704642478581
2012-01-01

2025-01-24 02:12:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 02:12:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 02:12:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 02:12:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 35
2025-01-24 02:12:32 - snowflake.connector.connection - INFO - closed
2025-01-24 02:12:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 02:12:32 - root - INFO - SQL:
SELECT
       "category_name",
       AVG("percentage_contribution") AS "average_monthly_percentage"
   FROM (
       SELECT
           DATE_TRUNC('month', "date") AS "sale_month",
           "category_name",
           SUM("volume_sold_liters") AS "monthly_volume_liters",
           SUM(SUM("volume_sold_liters")) OVER (PARTITION BY DATE_TRUNC('month', "date")) AS "total_monthly_volume",
           (SUM("volume_sold_liters") / SUM(SUM("volume_sold_liters")) OVER (PARTITION BY DATE_TRUNC('month', "date"))) * 100 AS "percentage_contribution"
       FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
       GROUP BY "sale_month", "category_name"
   )
   GROUP BY "category_name"
   HAVING AVG("percentage_contribution") >= 1
   ORDER BY "average_monthly_percentage" DESC
   LIMIT 100;
Results:
category_name,average_monthly_percentage
AMERICAN VODKAS,23.211560671643834
VODKA 80 PROOF,19.989118145977837
CANADIAN WHISKIES,12.846569201285469
SPICED RUM,6.63366832927565
STRAIGHT BOURBON WHISKIES,4.779229159342462
PUERTO RICO & VIRGIN ISLANDS RUM,4.38089716382291
WHISKEY LIQUEUR,4.2394859393384206
COCKTAILS/RTD,3.8749806651602934
BLENDED WHISKIES,3.8369418781008258
IMPORTED VODKAS,3.8143087242539204
TEQUILA,3.7768038168484925
AMERICAN COCKTAILS,3.614724515550464
VODKA FLAVORED,3.260047947039869
AMERICAN FLAVORED VODKA,3.0131590305263685
WHITE RUM,2.5156675926018517
MIXTO TEQUILA,2.496236997790848
TENNESSEE WHISKIES,2.2545534628173156
100% AGAVE TEQUILA,2.2011268984503145
AMERICAN SCHNAPPS,2.1070002633160443
FLAVORED RUM,2.1068569276398645
AMERICAN BRANDIES,1.7717188611942372
AMERICAN DRY GINS,1.7153390417300753
MISC. IMPORTED CORDIALS & LIQUEURS,1.6431442707250719
CREAM LIQUEURS,1.5341837293758047
IMPORTED VODKA - MISC,1.4644595366481572
AMERICAN GRAPE BRANDIES,1.4587593663076601
IMPORTED CORDIALS & LIQUEURS,1.4266010593150484
IMPORTED SCHNAPPS,1.3494648110187932
TEMPORARY & SPECIALTY PACKAGES,1.1949668899206516
SCOTCH WHISKIES,1.1672623847938821
IMPORTED BRANDIES,1.154497901468017
IMPORTED FLAVORED VODKA,1.0869783959016832
100 PROOF VODKA,1.0855406376304841
AMERICAN CORDIALS & LIQUEURS,1.0259900695077677
IRISH WHISKIES,1.0104208675045347

2025-01-24 02:12:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 02:12:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 02:12:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 02:12:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 02:12:34 - snowflake.connector.connection - INFO - closed
2025-01-24 02:12:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 02:12:34 - root - INFO - SQL:
SELECT
       t."sale_month",
       t."category_name",
       t."percentage_contribution"
   FROM (
       SELECT
           DATE_TRUNC('month', "date") AS "sale_month",
           "category_name",
           (SUM("volume_sold_liters") / SUM(SUM("volume_sold_liters")) OVER (PARTITION BY DATE_TRUNC('month', "date"))) * 100 AS "percentage_contribution"
       FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
       GROUP BY "sale_month", "category_name"
   ) t
   WHERE t."category_name" IN (
       SELECT "category_name"
       FROM (
           SELECT
               "category_name",
               AVG("percentage_contribution") AS "average_monthly_percentage"
           FROM (
               SELECT
                   DATE_TRUNC('month', "date") AS "sale_month",
                   "category_name",
                   (SUM("volume_sold_liters") / SUM(SUM("volume_sold_liters")) OVER (PARTITION BY DATE_TRUNC('month', "date"))) * 100 AS "percentage_contribution"
               FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
               GROUP BY "sale_month", "category_name"
           )
           GROUP BY "category_name"
           HAVING AVG("percentage_contribution") >= 1
       )
   )
   ORDER BY t."category_name", t."sale_month"
   LIMIT 100;
Results:
sale_month,category_name,percentage_contribution
2012-01-01,100 PROOF VODKA,1.1633490390575645
2012-02-01,100 PROOF VODKA,1.0214446914744806
2012-03-01,100 PROOF VODKA,1.189320800991667
2012-04-01,100 PROOF VODKA,0.9606774564584579
2012-05-01,100 PROOF VODKA,1.0328719358020448
2012-06-01,100 PROOF VODKA,1.0269458286500286
2012-07-01,100 PROOF VODKA,1.0672092671045843
2012-08-01,100 PROOF VODKA,1.163244180265713
2012-09-01,100 PROOF VODKA,1.0777589965629977
2012-10-01,100 PROOF VODKA,0.8636571850342041
2012-11-01,100 PROOF VODKA,1.0263766859746977
2012-12-01,100 PROOF VODKA,0.9059109084435057
2013-01-01,100 PROOF VODKA,1.0514944161018234
2013-02-01,100 PROOF VODKA,0.9956412801645793
2013-03-01,100 PROOF VODKA,1.254224461630033
2013-04-01,100 PROOF VODKA,1.0819590965282815
2013-05-01,100 PROOF VODKA,1.0734246943975043
2013-06-01,100 PROOF VODKA,1.3082074278499314
2013-07-01,100 PROOF VODKA,1.2476288679538126
2013-08-01,100 PROOF VODKA,1.3065736199901146
2013-09-01,100 PROOF VODKA,1.3108025430944017
2013-10-01,100 PROOF VODKA,0.9591945118244248
2013-11-01,100 PROOF VODKA,1.176099065928488
2013-12-01,100 PROOF VODKA,1.0129330996571948
2014-01-01,100 PROOF VODKA,1.0727819883134366
2014-02-01,100 PROOF VODKA,1.0297042632928717
2014-03-01,100 PROOF VODKA,1.1365943823634375
2014-04-01,100 PROOF VODKA,1.0113696732654947
2014-05-01,100 PROOF VODKA,1.0803778754105566
2014-06-01,100 PROOF VODKA,1.1021112899340182
2014-07-01,100 PROOF VODKA,1.136132445632187
2014-08-01,100 PROOF VODKA,1.1053297494842185
2014-09-01,100 PROOF VODKA,0.9838397138800449
2014-10-01,100 PROOF VODKA,0.9233434609174886
2014-11-01,100 PROOF VODKA,1.134407754393231
2014-12-01,100 PROOF VODKA,0.9819489784748188
2015-01-01,100 PROOF VODKA,1.1443977230379054
2015-02-01,100 PROOF VODKA,0.9754159375755758
2015-03-01,100 PROOF VODKA,1.256169628001813
2015-04-01,100 PROOF VODKA,1.3271292970921202
2015-05-01,100 PROOF VODKA,1.1279873156800002
2015-06-01,100 PROOF VODKA,1.2927714219959536
2015-07-01,100 PROOF VODKA,1.3340918255249117
2015-08-01,100 PROOF VODKA,1.3683618828733959
2015-09-01,100 PROOF VODKA,1.391113916041935
2015-10-01,100 PROOF VODKA,1.1112711785739104
2015-11-01,100 PROOF VODKA,1.3313012765078018
2015-12-01,100 PROOF VODKA,1.1967764345213394
2016-01-01,100 PROOF VODKA,1.427062788066734
2016-02-01,100 PROOF VODKA,4.791465898795506
2016-03-01,100 PROOF VODKA,0.06276826464941536
2016-04-01,100 PROOF VODKA,0.36643774760071834
2016-05-01,100 PROOF VODKA,0.05144572746591471
2016-06-01,100 PROOF VODKA,0.1196656161537226
2016-07-01,100 PROOF VODKA,0.07097153271761
2016-08-01,100 PROOF VODKA,0.06877865812850588
2016-08-01,100% AGAVE TEQUILA,0.05646463299049841
2016-09-01,100% AGAVE TEQUILA,1.0774844867190003
2016-10-01,100% AGAVE TEQUILA,1.0329247248349813
2016-11-01,100% AGAVE TEQUILA,1.344048876517322
2016-12-01,100% AGAVE TEQUILA,1.066953792860406
2017-01-01,100% AGAVE TEQUILA,1.2826389106910188
2017-02-01,100% AGAVE TEQUILA,1.1234865107873644
2017-03-01,100% AGAVE TEQUILA,1.2863767075737695
2017-04-01,100% AGAVE TEQUILA,1.6363200227104973
2017-05-01,100% AGAVE TEQUILA,1.5205531107754628
2017-06-01,100% AGAVE TEQUILA,1.3367510714741035
2017-07-01,100% AGAVE TEQUILA,1.3500706773825792
2017-08-01,100% AGAVE TEQUILA,1.471351363546685
2017-09-01,100% AGAVE TEQUILA,1.2268310840799344
2017-10-01,100% AGAVE TEQUILA,1.2177002135110022
2017-11-01,100% AGAVE TEQUILA,1.3673388717457475
2017-12-01,100% AGAVE TEQUILA,1.181445609255253
2018-01-01,100% AGAVE TEQUILA,1.2277317263473662
2018-02-01,100% AGAVE TEQUILA,1.2977254620921497
2018-03-01,100% AGAVE TEQUILA,1.4328527245623457
2018-04-01,100% AGAVE TEQUILA,1.5883718044712554
2018-05-01,100% AGAVE TEQUILA,1.557475113624334
2018-06-01,100% AGAVE TEQUILA,1.4929892772767217
2018-07-01,100% AGAVE TEQUILA,1.4698557906398295
2018-08-01,100% AGAVE TEQUILA,1.6170220120440542
2018-09-01,100% AGAVE TEQUILA,1.394958043013684
2018-10-01,100% AGAVE TEQUILA,1.6958839021890535
2018-11-01,100% AGAVE TEQUILA,1.4304599673962077
2018-12-01,100% AGAVE TEQUILA,1.2685784985116033
2019-01-01,100% AGAVE TEQUILA,1.374276024682227
2019-02-01,100% AGAVE TEQUILA,1.2216331826453672
2019-03-01,100% AGAVE TEQUILA,1.559269703842704
2019-04-01,100% AGAVE TEQUILA,2.1416953566532797
2019-05-01,100% AGAVE TEQUILA,1.8997582172419782
2019-06-01,100% AGAVE TEQUILA,2.2323397425855322
2019-07-01,100% AGAVE TEQUILA,1.8324010981530015
2019-08-01,100% AGAVE TEQUILA,1.6599297418595331
2019-09-01,100% AGAVE TEQUILA,1.321376424064385
2019-10-01,100% AGAVE TEQUILA,1.3406611667010975
2019-11-01,100% AGAVE TEQUILA,1.4927417595238661
2019-12-01,100% AGAVE TEQUILA,1.5764544941787462
2020-01-01,100% AGAVE TEQUILA,1.6611894703940742
2020-02-01,100% AGAVE TEQUILA,1.4654484075718315
2020-03-01,100% AGAVE TEQUILA,1.649588338958626

2025-01-24 02:12:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 02:12:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 02:12:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 02:12:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-24 02:12:36 - snowflake.connector.connection - INFO - closed
2025-01-24 02:12:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 02:13:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 02:13:05 - root - INFO - ```sql
SELECT
   DATE_TRUNC('month', "date") AS "sale_month",
   "category_name",
   (SUM("volume_sold_liters") / SUM(SUM("volume_sold_liters")) OVER (PARTITION BY DATE_TRUNC('month', "date"))) * 100 AS "percentage_contribution"
FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
GROUP BY "sale_month", "category_name"
ORDER BY "category_name", "sale_month"
LIMIT 100;
```
2025-01-24 02:13:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 02:13:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 02:13:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 02:13:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 02:13:06 - snowflake.connector.connection - INFO - closed
2025-01-24 02:13:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 02:14:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 02:14:17 - root - INFO - SQL:
SELECT
   DATE_TRUNC('month', "date") AS "sale_month",
   "category_name",
   (SUM("volume_sold_liters") / SUM(SUM("volume_sold_liters")) OVER (PARTITION BY DATE_TRUNC('month', "date"))) * 100 AS "percentage_contribution"
FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
GROUP BY "sale_month", "category_name"
ORDER BY "category_name", "sale_month"
LIMIT 100;
Results:
sale_month,category_name,percentage_contribution
2012-01-01,100 PROOF VODKA,1.1633490390575647
2012-02-01,100 PROOF VODKA,1.0214446914744808
2012-03-01,100 PROOF VODKA,1.1893208009916671
2012-04-01,100 PROOF VODKA,0.9606774564584579
2012-05-01,100 PROOF VODKA,1.0328719358020446
2012-06-01,100 PROOF VODKA,1.0269458286500288
2012-07-01,100 PROOF VODKA,1.0672092671045845
2012-08-01,100 PROOF VODKA,1.163244180265713
2012-09-01,100 PROOF VODKA,1.0777589965629983
2012-10-01,100 PROOF VODKA,0.8636571850342043
2012-11-01,100 PROOF VODKA,1.0263766859746977
2012-12-01,100 PROOF VODKA,0.9059109084435055
2013-01-01,100 PROOF VODKA,1.0514944161018231
2013-02-01,100 PROOF VODKA,0.9956412801645796
2013-03-01,100 PROOF VODKA,1.2542244616300335
2013-04-01,100 PROOF VODKA,1.0819590965282817
2013-05-01,100 PROOF VODKA,1.0734246943975045
2013-06-01,100 PROOF VODKA,1.3082074278499318
2013-07-01,100 PROOF VODKA,1.2476288679538123
2013-08-01,100 PROOF VODKA,1.306573619990115
2013-09-01,100 PROOF VODKA,1.3108025430944017
2013-10-01,100 PROOF VODKA,0.9591945118244244
2013-11-01,100 PROOF VODKA,1.176099065928488
2013-12-01,100 PROOF VODKA,1.0129330996571948
2014-01-01,100 PROOF VODKA,1.0727819883134366
2014-02-01,100 PROOF VODKA,1.0297042632928717
2014-03-01,100 PROOF VODKA,1.1365943823634377
2014-04-01,100 PROOF VODKA,1.011369673265495
2014-05-01,100 PROOF VODKA,1.0803778754105564
2014-06-01,100 PROOF VODKA,1.1021112899340182
2014-07-01,100 PROOF VODKA,1.1361324456321866
2014-08-01,100 PROOF VODKA,1.1053297494842187
2014-09-01,100 PROOF VODKA,0.9838397138800449
2014-10-01,100 PROOF VODKA,0.9233434609174886
2014-11-01,100 PROOF VODKA,1.1344077543932307
2014-12-01,100 PROOF VODKA,0.9819489784748183
2015-01-01,100 PROOF VODKA,1.1443977230379054
2015-02-01,100 PROOF VODKA,0.9754159375755753
2015-03-01,100 PROOF VODKA,1.2561696280018129
2015-04-01,100 PROOF VODKA,1.3271292970921202
2015-05-01,100 PROOF VODKA,1.1279873156800002
2015-06-01,100 PROOF VODKA,1.2927714219959543
2015-07-01,100 PROOF VODKA,1.3340918255249121
2015-08-01,100 PROOF VODKA,1.3683618828733957
2015-09-01,100 PROOF VODKA,1.391113916041935
2015-10-01,100 PROOF VODKA,1.1112711785739104
2015-11-01,100 PROOF VODKA,1.3313012765078023
2015-12-01,100 PROOF VODKA,1.1967764345213394
2016-01-01,100 PROOF VODKA,1.4270627880667341
2016-02-01,100 PROOF VODKA,4.791465898795506
2016-03-01,100 PROOF VODKA,0.06276826464941537
2016-04-01,100 PROOF VODKA,0.36643774760071823
2016-05-01,100 PROOF VODKA,0.05144572746591471
2016-06-01,100 PROOF VODKA,0.11966561615372256
2016-07-01,100 PROOF VODKA,0.07097153271761
2016-08-01,100 PROOF VODKA,0.06877865812850589
2016-08-01,100% AGAVE TEQUILA,0.05646463299049841
2016-09-01,100% AGAVE TEQUILA,1.0774844867190003
2016-10-01,100% AGAVE TEQUILA,1.0329247248349813
2016-11-01,100% AGAVE TEQUILA,1.344048876517322
2016-12-01,100% AGAVE TEQUILA,1.0669537928604063
2017-01-01,100% AGAVE TEQUILA,1.2826389106910192
2017-02-01,100% AGAVE TEQUILA,1.1234865107873642
2017-03-01,100% AGAVE TEQUILA,1.28637670757377
2017-04-01,100% AGAVE TEQUILA,1.6363200227104981
2017-05-01,100% AGAVE TEQUILA,1.5205531107754624
2017-06-01,100% AGAVE TEQUILA,1.336751071474104
2017-07-01,100% AGAVE TEQUILA,1.3500706773825792
2017-08-01,100% AGAVE TEQUILA,1.4713513635466848
2017-09-01,100% AGAVE TEQUILA,1.226831084079934
2017-10-01,100% AGAVE TEQUILA,1.2177002135110022
2017-11-01,100% AGAVE TEQUILA,1.367338871745748
2017-12-01,100% AGAVE TEQUILA,1.181445609255253
2018-01-01,100% AGAVE TEQUILA,1.2277317263473664
2018-02-01,100% AGAVE TEQUILA,1.2977254620921492
2018-03-01,100% AGAVE TEQUILA,1.4328527245623461
2018-04-01,100% AGAVE TEQUILA,1.5883718044712554
2018-05-01,100% AGAVE TEQUILA,1.557475113624334
2018-06-01,100% AGAVE TEQUILA,1.4929892772767213
2018-07-01,100% AGAVE TEQUILA,1.4698557906398297
2018-08-01,100% AGAVE TEQUILA,1.6170220120440535
2018-09-01,100% AGAVE TEQUILA,1.3949580430136843
2018-10-01,100% AGAVE TEQUILA,1.6958839021890528
2018-11-01,100% AGAVE TEQUILA,1.430459967396207
2018-12-01,100% AGAVE TEQUILA,1.2685784985116038
2019-01-01,100% AGAVE TEQUILA,1.374276024682227
2019-02-01,100% AGAVE TEQUILA,1.2216331826453668
2019-03-01,100% AGAVE TEQUILA,1.5592697038427041
2019-04-01,100% AGAVE TEQUILA,2.14169535665328
2019-05-01,100% AGAVE TEQUILA,1.8997582172419778
2019-06-01,100% AGAVE TEQUILA,2.2323397425855322
2019-07-01,100% AGAVE TEQUILA,1.8324010981530015
2019-08-01,100% AGAVE TEQUILA,1.6599297418595338
2019-09-01,100% AGAVE TEQUILA,1.321376424064385
2019-10-01,100% AGAVE TEQUILA,1.3406611667010975
2019-11-01,100% AGAVE TEQUILA,1.4927417595238661
2019-12-01,100% AGAVE TEQUILA,1.5764544941787466
2020-01-01,100% AGAVE TEQUILA,1.6611894703940744
2020-02-01,100% AGAVE TEQUILA,1.465448407571832
2020-03-01,100% AGAVE TEQUILA,1.6495883389586266

2025-01-24 02:14:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 02:14:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 02:14:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 02:14:18 - snowflake.connector.connection - INFO - closed
2025-01-24 02:14:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 02:14:57 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 02:14:57 - root - INFO - The error you're encountering is due to the misuse of window functions in conjunction with aggregate functions and `GROUP BY` clauses. Specifically, you cannot use window functions like `SUM() OVER()` on aggregated fields within the same `SELECT` clause that includes a `GROUP BY`.

**Error Explanation:**

- **Error Message:** `[SALES."volume_sold_liters"] is not a valid group by expression`
- **Cause:** In your subquery, you're using `SUM("volume_sold_liters")` and a window function `SUM("volume_sold_liters") OVER (...)` simultaneously, which conflicts with the `GROUP BY` clause.

To fix this, you need to compute the total monthly sales in a separate subquery or Common Table Expression (CTE) and then join it with your category monthly totals. This way, you avoid the conflict between window functions and aggregate functions within a grouped query.

**Corrected SQL Query:**

```sql
WITH category_monthly_totals AS (
    SELECT
        DATE_TRUNC('month', "date") AS "sale_month",
        "category_name",
        SUM("volume_sold_liters") AS "monthly_volume_liters"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    GROUP BY DATE_TRUNC('month', "date"), "category_name"
),
monthly_totals AS (
    SELECT
        DATE_TRUNC('month', "date") AS "sale_month",
        SUM("volume_sold_liters") AS "total_monthly_volume"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    GROUP BY DATE_TRUNC('month', "date")
)
SELECT
    cmt."category_name",
    VAR_SAMP((cmt."monthly_volume_liters" / mt."total_monthly_volume") * 100) AS "variance_in_percentage"
FROM category_monthly_totals cmt
JOIN monthly_totals mt ON cmt."sale_month" = mt."sale_month"
GROUP BY cmt."category_name"
ORDER BY "variance_in_percentage" DESC
LIMIT 100;
```

**Explanation:**

1. **Calculate Monthly Sales Volume per Category:**

   - The CTE `category_monthly_totals` computes the monthly sales volume for each liquor category by summing up the `"volume_sold_liters"` and grouping by `sale_month` and `"category_name"`.

   ```sql
   WITH category_monthly_totals AS (
       SELECT
           DATE_TRUNC('month', "date") AS "sale_month",
           "category_name",
           SUM("volume_sold_liters") AS "monthly_volume_liters"
       FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
       GROUP BY DATE_TRUNC('month', "date"), "category_name"
   ),
   ```

2. **Calculate Total Monthly Sales Volume:**

   - The CTE `monthly_totals` calculates the total sales volume for each month across all categories.

   ```sql
   monthly_totals AS (
       SELECT
           DATE_TRUNC('month', "date") AS "sale_month",
           SUM("volume_sold_liters") AS "total_monthly_volume"
       FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
       GROUP BY DATE_TRUNC('month', "date")
   )
   ```

3. **Compute Percentage Contribution and Variance:**

   - Join `category_monthly_totals` (`cmt`) with `monthly_totals` (`mt`) on `sale_month`.
   - Calculate the percentage contribution of each category for each month.
   - Use `VAR_SAMP` to calculate the variance of the percentage contributions over the months for each category.

   ```sql
   SELECT
       cmt."category_name",
       VAR_SAMP((cmt."monthly_volume_liters" / mt."total_monthly_volume") * 100) AS "variance_in_percentage"
   FROM category_monthly_totals cmt
   JOIN monthly_totals mt ON cmt."sale_month" = mt."sale_month"
   GROUP BY cmt."category_name"
   ORDER BY "variance_in_percentage" DESC
   LIMIT 100;
   ```

**Why This Works:**

- By separating the total monthly volume calculation into a different CTE and then joining it, we avoid using window functions directly on aggregated data within the same query block that contains a `GROUP BY`.
- This approach allows us to calculate the percentage contribution for each category without running into grouping issues.
- The `VAR_SAMP` function computes the variance of these percentage contributions, which is what you need to find the categories with the highest variability in their monthly sales percentages.

**Additional Notes:**

- Ensure that all column names are correctly referenced and enclosed in double quotations.
- Always check for divisions by zero when calculating percentages; in this dataset, it may not be an issue, but it's a good practice to include safeguards.
- If you need to filter the data for a specific 24-month period, you can add a `WHERE` clause in your CTEs:

  ```sql
  WHERE "date" >= DATEADD(month, -24, CURRENT_DATE)
  ```

By correcting the query this way, you should be able to execute it without errors and obtain the variance in percentage contributions for each liquor category.

---

**Remember:** When working with SQL, it's important to understand how aggregate functions, window functions, and `GROUP BY` clauses interact to avoid errors like the one you encountered.
2025-01-24 02:14:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 02:14:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 02:14:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 02:14:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 02:14:59 - snowflake.connector.connection - INFO - closed
2025-01-24 02:14:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 02:15:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 02:15:39 - root - INFO - SQL:
WITH category_monthly_totals AS (
    SELECT
        DATE_TRUNC('month', "date") AS "sale_month",
        "category_name",
        SUM("volume_sold_liters") AS "monthly_volume_liters"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    GROUP BY DATE_TRUNC('month', "date"), "category_name"
),
monthly_totals AS (
    SELECT
        DATE_TRUNC('month', "date") AS "sale_month",
        SUM("volume_sold_liters") AS "total_monthly_volume"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    GROUP BY DATE_TRUNC('month', "date")
)
SELECT
    cmt."category_name",
    VAR_SAMP((cmt."monthly_volume_liters" / mt."total_monthly_volume") * 100) AS "variance_in_percentage"
FROM category_monthly_totals cmt
JOIN monthly_totals mt ON cmt."sale_month" = mt."sale_month"
GROUP BY cmt."category_name"
ORDER BY "variance_in_percentage" DESC
LIMIT 100;
Results:
category_name,variance_in_percentage
AMERICAN WHISKIES,
DELISTED / SPECIAL ORDER ITEMS,
AMERICAN VODKAS,8.462597903337814
CANADIAN WHISKIES,5.614826018924614
VODKA 80 PROOF,3.150257274152049
COCKTAILS/RTD,2.5837255361237985
AMERICAN COCKTAILS,1.750868925854158
SPICED RUM,1.3857440139434631
WHISKEY LIQUEUR,0.7778761771791421
100% AGAVE TEQUILA,0.727239450803702
TEMPORARY & SPECIALTY PACKAGES,0.6813787123320924
STRAIGHT BOURBON WHISKIES,0.5983871558519062
IMPORTED VODKAS,0.5391904675252108
BLENDED WHISKIES,0.4735683348477357
DECANTERS & SPECIALTY PACKAGES,0.4394386970212799
CREAM LIQUEURS,0.39882105000838036
100 PROOF VODKA,0.37048770543842263
PUERTO RICO & VIRGIN ISLANDS RUM,0.23281973313297186
TEQUILA,0.209306755495319
WHITE RUM,0.2022224877009968
VODKA FLAVORED,0.18130788420240404
TENNESSEE WHISKIES,0.1738389739582847
DISTILLED SPIRITS SPECIALTY,0.17080129360890062
AMERICAN FLAVORED VODKA,0.16493145949869692
MIXTO TEQUILA,0.15955527588587065
AMERICAN DRY GINS,0.1570642244734157
SPECIAL ORDER ITEMS,0.14625862279121088
AMERICAN BRANDIES,0.11999227316761565
AMERICAN SCHNAPPS,0.1150479781768279
FLAVORED RUM,0.10909226095848787
IRISH WHISKIES,0.1070718887255627
MISC. AMERICAN CORDIALS & LIQUEURS,0.10605943105906494
IMPORTED DISTILLED SPIRITS SPECIALTY,0.10115158422010276
IMPORTED BRANDIES,0.09059952940941021
AMERICAN CORDIALS & LIQUEURS,0.07861072557784136
IMPORTED FLAVORED VODKA,0.06611497451274397
SCOTCH WHISKIES,0.06161922319680269
,0.0601991289314702
MISC. IMPORTED CORDIALS & LIQUEURS,0.05401311281166804
IMPORTED CORDIALS & LIQUEURS,0.0469397671976796
STRAIGHT RYE WHISKIES,0.04445865524340215
IMPORTED SCHNAPPS,0.04003570852909186
NEUTRAL GRAIN SPIRITS FLAVORED,0.02897719716197301
AMERICAN GRAPE BRANDIES,0.02334294471044058
IMPORTED GRAPE BRANDIES,0.02167326902284848
IMPORTED VODKA - MISC,0.02042668333867085
PEPPERMINT SCHNAPPS,0.020003021640362866
IMPORTED DRY GINS,0.018188591151905308
TRIPLE SEC,0.016234537928250237
COFFEE LIQUEURS,0.014274281222847515
AMERICAN DISTILLED SPIRITS SPECIALTY,0.010386006249250188
GOLD RUM,0.00899836848618646
BLACKBERRY BRANDIES,0.007779886505673849
PEACH SCHNAPPS,0.006592771128604286
AMERICAN AMARETTO,0.005969257613826092
APPLE SCHNAPPS,0.005015253019360247
AMERICAN ALCOHOL,0.004617374429861966
BUTTERSCOTCH SCHNAPPS,0.0037478078035864714
SINGLE MALT SCOTCH,0.0035935086703948525
CINNAMON SCHNAPPS,0.003325820647534809
NEUTRAL GRAIN SPIRITS,0.0030735181129679457
SINGLE BARREL BOURBON WHISKIES,0.002889134449097331
BOTTLED IN BOND BOURBON,0.002859275612982518
BARBADOS RUM,0.0025677098278757493
FLAVORED GIN,0.002101838937884464
APRICOT BRANDIES,0.00204273667146138
PEACH BRANDIES,0.0016903163465578203
GRAPE SCHNAPPS,0.0013584725141155853
IMPORTED AMARETTO,0.0008920233732357023
AGED DARK RUM,0.0007816821639731672
WATERMELON SCHNAPPS,0.0007499711073382265
GREEN CREME DE MENTHE,0.0006496791245085383
ROOT BEER SCHNAPPS,0.0005509151701852705
IOWA DISTILLERY WHISKIES,0.0005396259962914077
MISCELLANEOUS SCHNAPPS,0.0005334619840598717
CORN WHISKIES,0.00043216354489278
TROPICAL FRUIT SCHNAPPS,0.00036408909814686314
MISCELLANEOUS  BRANDIES,0.0003037219287822825
WHITE CREME DE CACAO,0.00030138359114893407
MEZCAL,0.000293308079034139
JAMAICA RUM,0.00027805127889013025
STRAWBERRY SCHNAPPS,0.00022102888948993699
CHERRY BRANDIES,0.00021548813130116897
RASPBERRY SCHNAPPS,0.00019439501661975048
JAPANESE WHISKY,0.00018378951315470404
DARK CREME DE CACAO,0.0001489497577921473
FLAVORED GINS,0.00010874939591879909
AMERICAN SLOE GINS,8.896180745593601e-05
LOW PROOF VODKA,8.771040756584952e-05
IOWA DISTILLERIES,6.29442249773582e-05
OTHER PROOF VODKA,2.5157486250355735e-05
WHITE CREME DE MENTHE,2.3852394813737155e-05
SPEARMINT SCHNAPPS,2.2485010190058764e-05
CREME DE ALMOND,1.922698119965624e-05
ROCK & RYE,1.282040590906722e-05
DELISTED ITEMS,5.298080499779464e-06
ANISETTE,3.3450915536834863e-06
SCHNAPPS - IMPORTED,2.7767536671910788e-06
AMARETTO - IMPORTED,2.6183521411544875e-06
HOLIDAY VAP,2.5724005995399038e-06

2025-01-24 02:15:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 02:15:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 02:15:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 02:15:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 02:15:41 - snowflake.connector.connection - INFO - closed
2025-01-24 02:15:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 02:15:41 - root - INFO - SQL:
SELECT *
FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
LIMIT 100
Results:
Too long, hard cut:
invoice_and_item_number,date,store_number,store_name,address,city,zip_code,store_location,county_number,county,category,category_name,vendor_number,vendor_name,item_number,item_description,pack,bottle_volume_ml,state_bottle_cost,state_bottle_retail,bottles_sold,sale_dollars,volume_sold_liters,volume_sold_gallons
RINV-05376800029,2024-08-08,10241,"FAREWAY STORES, INC. #237 / LE CLAIRE",1301 EAGLE RIDGE ROAD,LE CLAIRE,52753.0,bytearray(b'\x01\x01\x00\x00\x00 \x91\xc3\x1b\n\x97V\xc0\xe0\x12\x80\x7fJ\xcbD@'),,SCOTT,1031100.0,AMERICAN VODKAS,434,LUXCO INC,36308,HAWKEYE VODKA,6,1750,7.5,11.25,-12,-135.0,-21.0,-5.54
RINV-04825600013,2023-08-30,5512,CASEY'S GENERAL STORE #3639 / POSTVILLE,620 W TILDEN ST,POSTVILLE,52162.0,bytearray(b'\x01\x01\x00\x00\x00[\x7f\xa1\x00\x17\xe5V\xc0\x85.\xf5\xb4\xc2\x8aE@'),,ALLAMAKEE,1012100.0,CANADIAN WHISKIES,259,HEAVEN HILL BRANDS,10550,BLACK VELVET TOASTED CARAMEL,12,750,5.74,8.61,-24,-206.64,-18.0,-4.75
RINV-04673900228,2023-06-06,2633,HY-VEE #3 / BDI / DES MOINES,3221 SE 14TH ST,DES MOINES,50320.0,bytearray(b'\x01\x01\x00\x00\x00\x9a\xae4\xe4\x10fW\xc0M\x07@I\xf2\xc6D@'),,POLK,1041100.0,AMERICAN DRY GINS,421,SAZERAC COMPANY  INC,29287,BARTON GIN,12,1000,3.92,5.88,-12,-70.56,-12.0,-3.17
RINV-04933100044,2023-11-01,10227,GRIMES LIQUOR SHOP / GRIMES,3600 SOUTHEAST CROSSROADS DRIVE,GRIMES,50111.0,bytearray(b'\x01\x01\x00\x00\x00\x8a\xf1*\x03xqW\xc0q\xa2e\xf6\\\xd4D@'),,POLK,1062400.0,SPICED RUM,260,DIAGEO AMERICAS,43337,CAPTAIN MORGAN ORIGINAL SPICED,12,1000,12.99,19.49,-12,-233.88,-12.0,-3.17
RINV-04774000149,2023-07-27,3456,QUICK SHOP / CLEAR LAKE,904 N 8TH ST,CLEARLAKE,50428.0,bytearray(b'\x01\x01\x00\x00\x00\x13w\xc4:8XW\xc0\x98\x05\\UK\x92E@'),,CERRO GORDO,1081200.0,CREAM LIQUEURS,259,HEAVEN HILL BRANDS,68127,CAROLANS IRISH CREAM,12,1000,12.5,18.75,-12,-225.0,-12.0,-3.17
RINV-05329400157,2024-07-03,2633,HY-VEE #3 / BDI / DES MOINES,3221 SE 14TH ST,DES MOINES,50320.0,bytearray(b'\x01\x01\x00\x00\x00\x9a\xae4\xe4\x10fW\xc0M\x07@I\xf2\xc6D@'),,POLK,1022200.0,100% AGAVE TEQUILA,192,"MAST-JAGERMEISTER US, INC",88355,TEREMANA BLANCO TEQUILA,6,1000,18.46,27.69,-12,-332.28,-12.0,-3.17
RINV-05228700034,2024-04-18,3354,SAM'S CLUB 8238 / DAVENPORT,3845 ELMORE AVE.,DAVENPORT,52807.0,bytearray(b'\x01\x01\x00\x00\x00\xc9\x83\xedZ\xb4\xa1V\xc0\x9e\x9f\xf6\x1cW\xc7D@'),,SCOTT,1022100.0,MIXTO TEQUILA,421,SAZERAC COMPANY  INC,89577,MONTEZUMA GOLD,12,1000,7.5,11.25,-12,-135.0,-12.0,-3.17
RINV-05163600144,2024-03-04,2191,KEOKUK SPIRITS,1013 MAIN,KEOKUK,52632.0,bytearray(b'\x01\x01\x00\x00\x00\xd7L\xb9 \xcd\xd8V\xc0<Jb\x9f93D@'),,LEE,1011200.0,STRAIGHT BOURBON WHISKIES,65,JIM BEAM BRANDS,19070,JIM BEAM PET,6,1750,21.5,32.25,-6,-193.5,-10.5,-2.77
RINV-05064800052,2024-01-03,2652,HY-VEE DRUGSTORE / MASON CITY,875  4TH ST SW,MASON CITY,50401.0,bytearray(b'\x01\x01\x00\x00\x00\xa4\x85J\xaa\xb6MW\xc0\xa4 )6\xe7\x92E@'),,CERRO GORDO,1071000.0,COCKTAILS/RTD,395,PROXIMO,58838,JOSE CUERVO AUTHENTIC LIME MARGARITA,6,1750,8.74,13.11,-6,-78.66,-10.5,-2.77
RINV-04313200070,2022-10-12,4877,WORLD LIQUOR & TOBACCO,1775 NW 86TH ST,CLIVE,50325.0,bytearray(b'\x01\x01\x00\x00\x00\x1aO\x04q\x1eoW\xc06\x01\x86\xe5\xcf\xcdD@'),,POLK,1071000.0,COCKTAILS/RTD,395,PROXIMO,59162,1800 ULTIMATE PINEAPPLE MARGARITA PET,6,1750,10.04,15.06,-6,-90.36,-10.5,-2.77
RINV-04860600095,2023-09-21,2549,HY-VEE FOOD STORE (1271) / INDIANOLA,910 N JEFFERSON,INDIANOLA,50125.0,bytearray(b'\x01\x01\x00\x00\x00\xc6\x13\x07\xf1\x9dcW\xc0\xa3k\x9e\xa42\xafD@'),,WARREN,1031200.0,AMERICAN FLAVORED VODKA,260,DIAGEO AMERICAS,77994,"SMIRNOFF RED, WHITE & BERRY",6,1750,14.75,22.13,-6,-132.78,-10.5,-2.77
RINV-05111400054,2024-01-30,10200,"MUGHAL, INC. / WATERLOO",735 LOGAN AVE.,WATERLOO,50703.0,bytearray(b'\x01\x01\x00\x00\x00\xe1D$\xa5\xa1\x15W\xc0SP\xdd\x9eXAE@'),,BLACK HAWK,1022200.0,100% AGAVE TEQUILA,395,PROXIMO,87402,JOSE CUERVO ESPECIAL SILVER,48,200,3.63,5.45,-48,-261.6,-9.6,-2.53
RINV-05005400039,2023-12-06,3814,COSTCO WHOLESALE #788 / WDM,7205 MILLS CIVIC PKWY,WEST DES MOINES,50266.0,bytearray(b'\x01\x01\x00\x00\x00\x0bhxl\x91sW\xc0\xeb`Fv\xfa\xc7D@'),,DALLAS,1011200.0,STRAIGHT BOURBON WHISKIES,125,CEDAR RIDGE VINEYARDS LL,17206,CEDAR RIDGE BOURBON,6,750,18.67,28.01,-12,-336.12,-9.0,-2.37
RINV-05281100030,2024-06-03,6201,NEIGHBORHOOD TOBACCO OUTLET / MARION,2500 7TH AVENUE,MARION,52302.0,bytearray(b'\x01\x01\x00\x00\x00;3\x08Fz\xe5V\xc0\xdb\xe3\xf9\xcaK\x04E@'),,LINN,1031100.0,AMERICAN VODKAS,300,MCCORMICK DISTILLING CO.,36886,MCCORMICK 80PRF VODKA,12,750,3.64,5.46,-12,-65.52,-9.0,-2.37
RINV-05170600034,2024-03-12,5507,QUIK TRIP #559 / FLEUR,4021 FLEUR DR,DES MOINES,50321.0,bytearray(b'\x01\x01\x00\x00\x00zKg\x977iW\xc0\xc7\xceU\x9f\x1d\xc6D@'),,POLK,1031100.0,AMERICAN VODKAS,300,MCCORMICK DISTILLING CO.,36904,MCCORMICK 80PRF VODKA PET,24,375,1.84,2.76,-24,-66.24,-9.0,-2.37
RINV-04674100037,2023-06-06,10200,"MUGHAL, INC. / WATERLOO",735 LOGAN AVE.,WATERLOO,50703.0,bytearray(b'\x01\x01\x00\x00\x00\xe0D$\xa5\xa1\x15W\xc0XP\xdd\x9eXAE@'),,BLACK HA

2025-01-24 02:15:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 02:15:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 02:15:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 02:15:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 02:15:42 - snowflake.connector.connection - INFO - closed
2025-01-24 02:15:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 02:15:43 - root - INFO - SQL:
SELECT COUNT(DISTINCT DATE_TRUNC('month', "date")) AS "number_of_months"
FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
WHERE "date" IS NOT NULL
Results:
number_of_months
153

2025-01-24 02:15:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 02:15:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 02:15:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 02:15:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-24 02:15:44 - snowflake.connector.connection - INFO - closed
2025-01-24 02:15:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 02:15:45 - root - INFO - SQL:
SELECT "city", SUM("volume_sold_liters") AS "total_volume_liters"
FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
WHERE "city" IS NOT NULL AND "volume_sold_liters" IS NOT NULL
GROUP BY "city"
ORDER BY "total_volume_liters" DESC
LIMIT 10
Results:
city,total_volume_liters
DES MOINES,29962025.429999992
CEDAR RAPIDS,17998113.39
DAVENPORT,13386684.89
WEST DES MOINES,9991748.07
COUNCIL BLUFFS,8954213.540000001
WATERLOO,8870782.739999996
SIOUX CITY,8811817.32
IOWA CITY,8569564.110000001
DUBUQUE,7396188.73
AMES,7371778.889999998

2025-01-24 02:15:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 02:15:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 02:15:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 02:15:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 14
2025-01-24 02:15:46 - snowflake.connector.connection - INFO - closed
2025-01-24 02:15:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 02:15:47 - root - INFO - SQL:
SELECT DISTINCT "category_name"
FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
WHERE "category_name" IS NOT NULL AND "category_name" ILIKE '%WHISK%'
LIMIT 100
Results:
category_name
IMPORTED WHISKIES
TENNESSEE WHISKIES
IRISH WHISKIES
SCOTCH WHISKIES
SINGLE BARREL BOURBON WHISKIES
IOWA DISTILLERY WHISKIES
BLENDED WHISKIES
WHISKEY LIQUEUR
JAPANESE WHISKY
CORN WHISKIES
AMERICAN WHISKIES
CANADIAN WHISKIES
STRAIGHT BOURBON WHISKIES
STRAIGHT RYE WHISKIES

2025-01-24 02:15:47 - root - INFO - itercount: 0
2025-01-24 02:15:47 - root - INFO - Database Name: IOWA_LIQUOR_SALES
Schema Name: IOWA_LIQUOR_SALES
DDL describes table information.
,0
table_name,SALES
description,
DDL,"create or replace TABLE SALES (
	""invoice_and_item_number"" VARCHAR(16777216),
	""date"" DATE,
	""store_number"" VARCHAR(16777216),
	""store_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""zip_code"" VARCHAR(16777216),
	""store_location"" BINARY(8388608),
	""county_number"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""category"" VARCHAR(16777216),
	""category_name"" VARCHAR(16777216),
	""vendor_number"" VARCHAR(16777216),
	""vendor_name"" VARCHAR(16777216),
	""item_number"" VARCHAR(16777216),
	""item_description"" VARCHAR(16777216),
	""pack"" NUMBER(38,0),
	""bottle_volume_ml"" NUMBER(38,0),
	""state_bottle_cost"" FLOAT,
	""state_bottle_retail"" FLOAT,
	""bottles_sold"" NUMBER(38,0),
	""sale_dollars"" FLOAT,
	""volume_sold_liters"" FLOAT,
	""volume_sold_gallons"" FLOAT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'IOWA_LIQUOR_SALES': {'IOWA_LIQUOR_SALES': ['SALES']}}
Begin Exploring Related Columns
First, let's identify the relevant columns and their potential usage:

- **"date"**: Used to extract the month and year for aggregating sales over the 24-month period.
- **"category"**: Category code of the liquor; useful for grouping.
- **"category_name"**: Name of the liquor category; used for readability and grouping.
- **"volume_sold_liters"**: Sales volume in liters; used to calculate monthly sales volume and percentages.
- **"sale_dollars"**: Sales amount in dollars; could be used alternatively to volume for sales calculations.

Potential conditions that may be used:

- Filtering data within the last 24 months.
- Grouping data by month and category.
- Calculating average monthly contributions.
- Identifying categories with at least 1% average monthly sales volume.
- Calculating Pearson correlation coefficients between categories' monthly sales percentages.

Here are at least 10 different SQL queries to explore and understand the data:

1. **Retrieve a sample of sales data:**
   ```sql
   SELECT *
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   LIMIT 100;
   ```

2. **List distinct liquor categories:**
   ```sql
   SELECT DISTINCT "category", "category_name"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   LIMIT 100;
   ```

3. **Get the date range of the sales data:**
   ```sql
   SELECT MIN("date") AS "start_date", MAX("date") AS "end_date"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES";
   ```

4. **Count the number of sales records per month:**
   ```sql
   SELECT DATE_TRUNC('month', "date") AS "sale_month", COUNT(*) AS "num_sales"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   GROUP BY "sale_month"
   ORDER BY "sale_month"
   LIMIT 100;
   ```

5. **Calculate total sales volume per category over the entire period:**
   ```sql
   SELECT "category_name", SUM("volume_sold_liters") AS "total_volume_liters"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   GROUP BY "category_name"
   ORDER BY "total_volume_liters" DESC
   LIMIT 100;
   ```

6. **Calculate monthly sales volume per category:**
   ```sql
   SELECT DATE_TRUNC('month', "date") AS "sale_month", "category_name", SUM("volume_sold_liters") AS "monthly_volume_liters"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   GROUP BY "sale_month", "category_name"
   ORDER BY "sale_month", "monthly_volume_liters" DESC
   LIMIT 100;
   ```

7. **Compute each category's percentage contribution to monthly sales volume:**
   ```sql
   SELECT
       "sale_month",
       "category_name",
       "monthly_volume_liters",
       "total_monthly_volume",
       ("monthly_volume_liters" / "total_monthly_volume") * 100 AS "percentage_contribution"
   FROM (
       SELECT
           DATE_TRUNC('month', "date") AS "sale_month",
           "category_name",
           SUM("volume_sold_liters") AS "monthly_volume_liters",
           SUM(SUM("volume_sold_liters")) OVER (PARTITION BY DATE_TRUNC('month', "date")) AS "total_monthly_volume"
       FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
       GROUP BY "sale_month", "category_name"
   )
   ORDER BY "sale_month", "percentage_contribution" DESC
   LIMIT 100;
   ```

8. **Identify categories contributing an average of at least 1% to monthly sales volume over 24 months:**
   ```sql
   SELECT
       "category_name",
       AVG("percentage_contribution") AS "average_monthly_percentage"
   FROM (
       SELECT
           DATE_TRUNC('month', "date") AS "sale_month",
           "category_name",
           SUM("volume_sold_liters") AS "monthly_volume_liters",
           SUM(SUM("volume_sold_liters")) OVER (PARTITION BY DATE_TRUNC('month', "date")) AS "total_monthly_volume",
           (SUM("volume_sold_liters") / SUM(SUM("volume_sold_liters")) OVER (PARTITION BY DATE_TRUNC('month', "date"))) * 100 AS "percentage_contribution"
       FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
       GROUP BY "sale_month", "category_name"
   )
   GROUP BY "category_name"
   HAVING AVG("percentage_contribution") >= 1
   ORDER BY "average_monthly_percentage" DESC
   LIMIT 100;
   ```

9. **Extract monthly sales percentages for categories identified in the previous query:**
   ```sql
   SELECT
       t."sale_month",
       t."category_name",
       t."percentage_contribution"
   FROM (
       SELECT
           DATE_TRUNC('month', "date") AS "sale_month",
           "category_name",
           (SUM("volume_sold_liters") / SUM(SUM("volume_sold_liters")) OVER (PARTITION BY DATE_TRUNC('month', "date"))) * 100 AS "percentage_contribution"
       FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
       GROUP BY "sale_month", "category_name"
   ) t
   WHERE t."category_name" IN (
       SELECT "category_name"
       FROM (
           SELECT
               "category_name",
               AVG("percentage_contribution") AS "average_monthly_percentage"
           FROM (
               SELECT
                   DATE_TRUNC('month', "date") AS "sale_month",
                   "category_name",
                   (SUM("volume_sold_liters") / SUM(SUM("volume_sold_liters")) OVER (PARTITION BY DATE_TRUNC('month', "date"))) * 100 AS "percentage_contribution"
               FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
               GROUP BY "sale_month", "category_name"
           )
           GROUP BY "category_name"
           HAVING AVG("percentage_contribution") >= 1
       )
   )
   ORDER BY t."category_name", t."sale_month"
   LIMIT 100;
   ```

10. **Retrieve monthly sales percentages for a specific category (e.g., "Vodka"):**
    ```sql
    SELECT
        DATE_TRUNC('month', "date") AS "sale_month",
        "category_name",
        (SUM("volume_sold_liters") / SUM(SUM("volume_sold_liters")) OVER (PARTITION BY DATE_TRUNC('month', "date"))) * 100 AS "percentage_contribution"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "category_name" = 'VODKA'
    GROUP BY "sale_month", "category_name"
    ORDER BY "sale_month"
    LIMIT 100;
    ```

11. **Find categories with the highest variance in monthly sales percentages:**
    ```sql
    SELECT
        "category_name",
        VAR_SAMP("percentage_contribution") AS "variance_in_percentage"
    FROM (
        SELECT
            DATE_TRUNC('month', "date") AS "sale_month",
            "category_name",
            (SUM("volume_sold_liters") / SUM(SUM("volume_sold_liters")) OVER (PARTITION BY DATE_TRUNC('month', "date"))) * 100 AS "percentage_contribution"
        FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
        GROUP BY "sale_month", "category_name"
    )
    GROUP BY "category_name"
    ORDER BY "variance_in_percentage" DESC
    LIMIT 100;
    ```

12. **Check for any missing or null values in important columns:**
    ```sql
    SELECT *
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "category_name" IS NULL OR "volume_sold_liters" IS NULL OR "date" IS NULL
    LIMIT 100;
    ```

13. **Get the number of unique months in the dataset:**
    ```sql
    SELECT COUNT(DISTINCT DATE_TRUNC('month', "date")) AS "number_of_months"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES";
    ```

14. **List the top 10 cities by total sales volume:**
    ```sql
    SELECT "city", SUM("volume_sold_liters") AS "total_volume_liters"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    GROUP BY "city"
    ORDER BY "total_volume_liters" DESC
    LIMIT 10;
    ```

15. **Retrieve sales data for categories containing 'WHISKEY' in their names:**
    ```sql
    SELECT DISTINCT "category_name"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "category_name" ILIKE '%WHISKEY%'
    LIMIT 100;
    ```

These queries will help you:

- Understand the structure and range of the data.
- Identify the liquor categories and their contribution to sales volume.
- Calculate the average monthly sales percentage of each category.
- Determine which categories contribute at least 1% on average to monthly sales volume.
- Prepare data for calculating Pearson correlation coefficients between categories' sales percentages.

By executing and analyzing the results of these queries, you can collect the necessary data to proceed with the main task of identifying the two categories with the lowest Pearson correlation coefficient among those contributing at least 1% to monthly sales volume over 24 months.Query:
SELECT *
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   LIMIT 100;
Answer:
Too long, hard cut:
invoice_and_item_number,date,store_number,store_name,address,city,zip_code,store_location,county_number,county,category,category_name,vendor_number,vendor_name,item_number,item_description,pack,bottle_volume_ml,state_bottle_cost,state_bottle_retail,bottles_sold,sale_dollars,volume_sold_liters,volume_sold_gallons
RINV-05376800029,2024-08-08,10241,"FAREWAY STORES, INC. #237 / LE CLAIRE",1301 EAGLE RIDGE ROAD,LE CLAIRE,52753.0,bytearray(b'\x01\x01\x00\x00\x00 \x91\xc3\x1b\n\x97V\xc0\xe0\x12\x80\x7fJ\xcbD@'),,SCOTT,1031100.0,AMERICAN VODKAS,434,LUXCO INC,36308,HAWKEYE VODKA,6,1750,7.5,11.25,-12,-135.0,-21.0,-5.54
RINV-04825600013,2023-08-30,5512,CASEY'S GENERAL STORE #3639 / POSTVILLE,620 W TILDEN ST,POSTVILLE,52162.0,bytearray(b'\x01\x01\x00\x00\x00[\x7f\xa1\x00\x17\xe5V\xc0\x85.\xf5\xb4\xc2\x8aE@'),,ALLAMAKEE,1012100.0,CANADIAN WHISKIES,259,HEAVEN HILL BRANDS,10550,BLACK VELVET TOASTED CARAMEL,12,750,5.74,8.61,-24,-206.64,-18.0,-4.75
RINV-04673900228,2023-06-06,2633,HY-VEE #3 / BDI / DES MOINES,3221 SE 14TH ST,DES MOINES,50320.0,bytearray(b'\x01\x01\x00\x00\x00\x9a\xae4\xe4\x10fW\xc0M\x07@I\xf2\xc6D@'),,POLK,1041100.0,AMERICAN DRY GINS,421,SAZERAC COMPANY  INC,29287,BARTON GIN,12,1000,3.92,5.88,-12,-70.56,-12.0,-3.17
RINV-04933100044,2023-11-01,10227,GRIMES LIQUOR SHOP / GRIMES,3600 SOUTHEAST CROSSROADS DRIVE,GRIMES,50111.0,bytearray(b'\x01\x01\x00\x00\x00\x8a\xf1*\x03xqW\xc0q\xa2e\xf6\\\xd4D@'),,POLK,1062400.0,SPICED RUM,260,DIAGEO AMERICAS,43337,CAPTAIN MORGAN ORIGINAL SPICED,12,1000,12.99,19.49,-12,-233.88,-12.0,-3.17
RINV-04774000149,2023-07-27,3456,QUICK SHOP / CLEAR LAKE,904 N 8TH ST,CLEARLAKE,50428.0,bytearray(b'\x01\x01\x00\x00\x00\x13w\xc4:8XW\xc0\x98\x05\\UK\x92E@'),,CERRO GORDO,1081200.0,CREAM LIQUEURS,259,HEAVEN HILL BRANDS,68127,CAROLANS IRISH CREAM,12,1000,12.5,18.75,-12,-225.0,-12.0,-3.17
RINV-05329400157,2024-07-03,2633,HY-VEE #3 / BDI / DES MOINES,3221 SE 14TH ST,DES MOINES,50320.0,bytearray(b'\x01\x01\x00\x00\x00\x9a\xae4\xe4\x10fW\xc0M\x07@I\xf2\xc6D@'),,POLK,1022200.0,100% AGAVE TEQUILA,192,"MAST-JAGERMEISTER US, INC",88355,TEREMANA BLANCO TEQUILA,6,1000,18.46,27.69,-12,-332.28,-12.0,-3.17
RINV-05228700034,2024-04-18,3354,SAM'S CLUB 8238 / DAVENPORT,3845 ELMORE AVE.,DAVENPORT,52807.0,bytearray(b'\x01\x01\x00\x00\x00\xc9\x83\xedZ\xb4\xa1V\xc0\x9e\x9f\xf6\x1cW\xc7D@'),,SCOTT,1022100.0,MIXTO TEQUILA,421,SAZERAC COMPANY  INC,89577,MONTEZUMA GOLD,12,1000,7.5,11.25,-12,-135.0,-12.0,-3.17
RINV-05163600144,2024-03-04,2191,KEOKUK SPIRITS,1013 MAIN,KEOKUK,52632.0,bytearray(b'\x01\x01\x00\x00\x00\xd7L\xb9 \xcd\xd8V\xc0<Jb\x9f93D@'),,LEE,1011200.0,STRAIGHT BOURBON WHISKIES,65,JIM BEAM BRANDS,19070,JIM BEAM PET,6,1750,21.5,32.25,-6,-193.5,-10.5,-2.77
RINV-05064800052,2024-01-03,2652,HY-VEE DRUGSTORE / MASON CITY,875  4TH ST SW,MASON CITY,50401.0,bytearray(b'\x01\x01\x00\x00\x00\xa4\x85J\xaa\xb6MW\xc0\xa4 )6\xe7\x92E@'),,CERRO GORDO,1071000.0,COCKTAILS/RTD,395,PROXIMO,58838,JOSE CUERVO AUTHENTIC LIME MARGARITA,6,1750,8.74,13.11,-6,-78.66,-10.5,-2.77
RINV-04313200070,2022-10-12,4877,WORLD LIQUOR & TOBACCO,1775 NW 86TH ST,CLIVE,50325.0,bytearray(b'\x01\x01\x00\x00\x00\x1aO\x04q\x1eoW\xc06\x01\x86\xe5\xcf\xcdD@'),,POLK,1071000.0,COCKTAILS/RTD,395,PROXIMO,59162,1800 ULTIMATE PINEAPPLE MARGARITA PET,6,1750,10.04,15.06,-6,-90.36,-10.5,-2.77
RINV-04860600095,2023-09-21,2549,HY-VEE FOOD STORE (1271) / INDIANOLA,910 N JEFFERSON,INDIANOLA,50125.0,bytearray(b'\x01\x01\x00\x00\x00\xc6\x13\x07\xf1\x9dcW\xc0\xa3k\x9e\xa42\xafD@'),,WARREN,1031200.0,AMERICAN FLAVORED VODKA,260,DIAGEO AMERICAS,77994,"SMIRNOFF RED, WHITE & BERRY",6,1750,14.75,22.13,-6,-132.78,-10.5,-2.77
RINV-05111400054,2024-01-30,10200,"MUGHAL, INC. / WATERLOO",735 LOGAN AVE.,WATERLOO,50703.0,bytearray(b'\x01\x01\x00\x00\x00\xe1D$\xa5\xa1\x15W\xc0SP\xdd\x9eXAE@'),,BLACK HAWK,1022200.0,100% AGAVE TEQUILA,395,PROXIMO,87402,JOSE CUERVO ESPECIAL SILVER,48,200,3.63,5.45,-48,-261.6,-9.6,-2.53
RINV-05005400039,2023-12-06,3814,COSTCO WHOLESALE #788 / WDM,7205 MILLS CIVIC PKWY,WEST DES MOINES,50266.0,bytearray(b'\x01\x01\x00\x00\x00\x0bhxl\x91sW\xc0\xeb`Fv\xfa\xc7D@'),,DALLAS,1011200.0,STRAIGHT BOURBON WHISKIES,125,CEDAR RIDGE VINEYARDS LL,17206,CEDAR RIDGE BOURBON,6,750,18.67,28.01,-12,-336.12,-9.0,-2.37
RINV-05281100030,2024-06-03,6201,NEIGHBORHOOD TOBACCO OUTLET / MARION,2500 7TH AVENUE,MARION,52302.0,bytearray(b'\x01\x01\x00\x00\x00;3\x08Fz\xe5V\xc0\xdb\xe3\xf9\xcaK\x04E@'),,LINN,1031100.0,AMERICAN VODKAS,300,MCCORMICK DISTILLING CO.,36886,MCCORMICK 80PRF VODKA,12,750,3.64,5.46,-12,-65.52,-9.0,-2.37
RINV-05170600034,2024-03-12,5507,QUIK TRIP #559 / FLEUR,4021 FLEUR DR,DES MOINES,50321.0,bytearray(b'\x01\x01\x00\x00\x00zKg\x977iW\xc0\xc7\xceU\x9f\x1d\xc6D@'),,POLK,1031100.0,AMERICAN VODKAS,300,MCCORMICK DISTILLING CO.,36904,MCCORMICK 80PRF VODKA PET,24,375,1.84,2.76,-24,-66.24,-9.0,-2.37
RINV-04674100037,2023-06-06,10200,"MUGHAL, INC. / WATERLOO",735 LOGAN AVE.,WATERLOO,50703.0,bytearray(b'\x01\x01\x00\x00\x00\xe0D$\xa5\xa1\x15W\xc0XP\xdd\x9eXAE@'),,BLACK HA
Query:
SELECT DISTINCT "category", "category_name"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   LIMIT 100;
Answer:
category,category_name
1011700.0,CORN WHISKIES
1081030.0,COFFEE LIQUEURS
1081230.0,WHITE CREME DE CACAO
1062500.0,
1501100.0,HIGH PROOF BEER - AMERICAN
1082200.0,IMPORTED SCHNAPPS
1052100.0,IMPORTED BRANDIES
1062200.0,WHITE RUM
1062300.0,AGED DARK RUM
1701100.0,DECANTERS & SPECIALTY PACKAGES
1071000.0,COCKTAILS/RTD
1091200.0,NEUTRAL GRAIN SPIRITS
1082000.0,IMPORTED CORDIALS & LIQUEURS
1051150.0,MISCELLANEOUS  BRANDIES
1011300.0,SINGLE BARREL BOURBON WHISKIES
1032200.0,IMPORTED VODKA - MISC
1081015.0,IMPORTED AMARETTO
1071100.0,AMERICAN COCKTAILS
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY
1022300.0,MEZCAL
1701200.0,HOLIDAY VAP
1081240.0,GREEN CREME DE MENTHE
1701100.0,TEMPORARY & SPECIALTY PACKAGES
1081390.0,IMPORTED SCHNAPPS
1031100.0,AMERICAN VODKAS
1081600.0,WHISKEY LIQUEUR
1012400.0,JAPANESE WHISKY
1051100.0,APRICOT BRANDIES
1011400.0,TENNESSEE WHISKIES
1081400.0,TRIPLE SEC
1011600.0,STRAIGHT RYE WHISKIES
1031080.0,VODKA 80 PROOF
1011700.0,
1011500.0,STRAIGHT RYE WHISKIES
1081250.0,WHITE CREME DE MENTHE
1011800.0,IOWA DISTILLERY WHISKIES
1090000.0,DISTILLED SPIRITS SPECIALTY
1081370.0,WATERMELON SCHNAPPS
1081380.0,MISCELLANEOUS SCHNAPPS
1081340.0,ROOT BEER SCHNAPPS
1041100.0,AMERICAN DRY GINS
1051110.0,BLACKBERRY BRANDIES
1052010.0,IMPORTED GRAPE BRANDIES
1031100.0,100 PROOF VODKA
1062100.0,GOLD RUM
1041200.0,AMERICAN SLOE GINS
1081500.0,ROCK & RYE
1081900.0,MISC. AMERICAN CORDIALS & LIQUEURS
1081700.0,DISTILLED SPIRITS SPECIALTY
1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED
1081355.0,STRAWBERRY SCHNAPPS
1081305.0,APPLE SCHNAPPS
1041300.0,AMERICAN SLOE GINS
1082100.0,
1032080.0,IMPORTED VODKAS
1091400.0,IOWA DISTILLERIES
1022200.0,100% AGAVE TEQUILA
1051120.0,CHERRY BRANDIES
1081200.0,CREAM LIQUEURS
1082900.0,MISC. IMPORTED CORDIALS & LIQUEURS
1011100.0,BLENDED WHISKIES
1011250.0,SINGLE BARREL BOURBON WHISKIES
1082200.0,
1081220.0,DARK CREME DE CACAO
1031200.0,AMERICAN FLAVORED VODKA
1070000.0,COCKTAILS/RTD
1011600.0,CORN WHISKIES
1011300.0,TENNESSEE WHISKIES
1022200.0,
1012300.0,SINGLE MALT SCOTCH
1081000.0,AMERICAN CORDIALS & LIQUEURS
1051140.0,PEACH BRANDIES
1081315.0,CINNAMON SCHNAPPS
1041200.0,FLAVORED GIN
1081312.0,BUTTERSCOTCH SCHNAPPS
1012210.0,SINGLE MALT SCOTCH
1041150.0,FLAVORED GINS
1012200.0,SCOTCH WHISKIES
1081330.0,PEACH SCHNAPPS
1011400.0,BOTTLED IN BOND BOURBON
1032000.0,IMPORTED VODKAS
1091100.0,
1700000.0,TEMPORARY & SPECIALTY PACKAGES
1901000.0,SPECIAL ORDER ITEMS
1081300.0,PEPPERMINT SCHNAPPS
1051100.0,AMERICAN BRANDIES
1062400.0,SPICED RUM
1081365.0,TROPICAL FRUIT SCHNAPPS
1082100.0,IMPORTED CORDIALS & LIQUEURS
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY
1042100.0,IMPORTED DRY GINS
1062300.0,FLAVORED RUM
1032200.0,IMPORTED FLAVORED VODKA
1031090.0,OTHER PROOF VODKA
1081400.0,AMERICAN SCHNAPPS
1081210.0,CREME DE ALMOND
1081500.0,TRIPLE SEC
1062400.0,
1051010.0,AMERICAN GRAPE BRANDIES
1031200.0,VODKA FLAVORED
Query:
SELECT MIN("date") AS "start_date", MAX("date") AS "end_date"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES";
Answer:
start_date,end_date
2012-01-03,2024-09-30
Query:
SELECT DATE_TRUNC('month', "date") AS "sale_month", COUNT(*) AS "num_sales"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   GROUP BY "sale_month"
   ORDER BY "sale_month"
   LIMIT 100;
Answer:
sale_month,num_sales
2012-01-01,147770
2012-02-01,156728
2012-03-01,160535
2012-04-01,164970
2012-05-01,192270
2012-06-01,169344
2012-07-01,180983
2012-08-01,190763
2012-09-01,149230
2012-10-01,197168
2012-11-01,168615
2012-12-01,203683
2013-01-01,162997
2013-02-01,150846
2013-03-01,155189
2013-04-01,177752
2013-05-01,178481
2013-06-01,157047
2013-07-01,195087
2013-08-01,169615
2013-09-01,165463
2013-10-01,189553
2013-11-01,149057
2013-12-01,212676
2014-01-01,158228
2014-02-01,149853
2014-03-01,160399
2014-04-01,177106
2014-05-01,165048
2014-06-01,185136
2014-07-01,187997
2014-08-01,173094
2014-09-01,171399
2014-10-01,180683
2014-11-01,157228
2014-12-01,231625
2015-01-01,158795
2015-02-01,158636
2015-03-01,179195
2015-04-01,180736
2015-05-01,169613
2015-06-01,205269
2015-07-01,182494
2015-08-01,178742
2015-09-01,189607
2015-10-01,174460
2015-11-01,176337
2015-12-01,230599
2016-01-01,159083
2016-02-01,172613
2016-03-01,193373
2016-04-01,171314
2016-05-01,199812
2016-06-01,208530
2016-07-01,173150
2016-08-01,206093
2016-09-01,185409
2016-10-01,189070
2016-11-01,195943
2016-12-01,225503
2017-01-01,171825
2017-02-01,160636
2017-03-01,191376
2017-04-01,172927
2017-05-01,209386
2017-06-01,203522
2017-07-01,187824
2017-08-01,212123
2017-09-01,172334
2017-10-01,201145
2017-11-01,195011
2017-12-01,213167
2018-01-01,190636
2018-02-01,165349
2018-03-01,186658
2018-04-01,187376
2018-05-01,218829
2018-06-01,200682
2018-07-01,189807
2018-08-01,214837
2018-09-01,168729
2018-10-01,213648
2018-11-01,196608
2018-12-01,222399
2019-01-01,187751
2019-02-01,169732
2019-03-01,175898
2019-04-01,197285
2019-05-01,217698
2019-06-01,191634
2019-07-01,212719
2019-08-01,201650
2019-09-01,183682
2019-10-01,208036
2019-11-01,201009
2019-12-01,233251
2020-01-01,191430
2020-02-01,171814
2020-03-01,214064
2020-04-01,219677
Query:
SELECT "category_name", SUM("volume_sold_liters") AS "total_volume_liters"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   GROUP BY "category_name"
   ORDER BY "total_volume_liters" DESC
   LIMIT 100;
Answer:
category_name,total_volume_liters
AMERICAN VODKAS,43578325.989999995
CANADIAN WHISKIES,35353278.57000001
SPICED RUM,18085561.13
VODKA 80 PROOF,17797396.77
STRAIGHT BOURBON WHISKIES,13291240.160000002
WHISKEY LIQUEUR,11803035.06
IMPORTED VODKAS,10417847.389999999
BLENDED WHISKIES,10343125.129999999
COCKTAILS/RTD,7344877.079999998
TENNESSEE WHISKIES,6199089.470000001
FLAVORED RUM,5807658.770000001
AMERICAN FLAVORED VODKA,5654748.53
WHITE RUM,4705618.079999998
MIXTO TEQUILA,4690751.700000002
AMERICAN DRY GINS,4607653.109999999
CREAM LIQUEURS,4222257.319999999
100% AGAVE TEQUILA,4201076.459999999
AMERICAN SCHNAPPS,3931786.6799999992
PUERTO RICO & VIRGIN ISLANDS RUM,3889666.920000001
IMPORTED SCHNAPPS,3670160.72
TEQUILA,3351430.860000001
AMERICAN BRANDIES,3296756.1300000013
AMERICAN COCKTAILS,3206271.179999999
SCOTCH WHISKIES,3150192.29
VODKA FLAVORED,2907612.7600000002
IRISH WHISKIES,2818290.6400000006
IMPORTED CORDIALS & LIQUEURS,2680998.6899999995
TRIPLE SEC,2350501.66
IMPORTED DRY GINS,2310817.4900000007
TEMPORARY & SPECIALTY PACKAGES,2284119.1800000006
IMPORTED BRANDIES,2177553.7
IMPORTED FLAVORED VODKA,2038622.7999999996
AMERICAN CORDIALS & LIQUEURS,1908081.46
IMPORTED DISTILLED SPIRITS SPECIALTY,1848275.3599999994
MISC. IMPORTED CORDIALS & LIQUEURS,1453209.46
IMPORTED VODKA - MISC,1301889.4400000004
AMERICAN GRAPE BRANDIES,1293088.4699999997
STRAIGHT RYE WHISKIES,1179474.28
SPECIAL ORDER ITEMS,1175383.47
COFFEE LIQUEURS,1156503.3600000003
100 PROOF VODKA,959031.72
GOLD RUM,817480.3100000002
PEPPERMINT SCHNAPPS,789853.1800000003
SINGLE MALT SCOTCH,758599.15
DISTILLED SPIRITS SPECIALTY,754358.4700000001
MISC. AMERICAN CORDIALS & LIQUEURS,688978.18
IMPORTED GRAPE BRANDIES,659869.7899999999
DECANTERS & SPECIALTY PACKAGES,522822.8700000001
PEACH SCHNAPPS,518755.75000000006
AMERICAN AMARETTO,414314.4900000001
NEUTRAL GRAIN SPIRITS FLAVORED,412364.17
BLACKBERRY BRANDIES,373640.73000000004
AMERICAN DISTILLED SPIRITS SPECIALTY,305283.0300000001
NEUTRAL GRAIN SPIRITS,290027.92000000004
AGED DARK RUM,285129.8
APPLE SCHNAPPS,224426.81000000003
SINGLE BARREL BOURBON WHISKIES,203549.70000000004
,191247.9
BUTTERSCOTCH SCHNAPPS,190362.58
APRICOT BRANDIES,180888.7199999999
AMERICAN ALCOHOL,171628.80000000002
BOTTLED IN BOND BOURBON,168498.23
CINNAMON SCHNAPPS,151383.76999999993
WATERMELON SCHNAPPS,147316.75
GRAPE SCHNAPPS,133591.0
MISCELLANEOUS SCHNAPPS,133371.15
FLAVORED GIN,121226.04999999996
ROOT BEER SCHNAPPS,93714.25
JAMAICA RUM,65725.0
PEACH BRANDIES,64483.36000000002
IMPORTED AMARETTO,64228.78000000001
CORN WHISKIES,62460.400000000016
RASPBERRY SCHNAPPS,61734.5
MEZCAL,59139.799999999996
CHERRY BRANDIES,56881.819999999985
AMERICAN SLOE GINS,56105.0
TROPICAL FRUIT SCHNAPPS,54243.25
STRAWBERRY SCHNAPPS,54208.5
FLAVORED GINS,45033.450000000004
BARBADOS RUM,44283.07
GREEN CREME DE MENTHE,34282.5
WHITE CREME DE CACAO,26446.5
DARK CREME DE CACAO,24541.5
SPEARMINT SCHNAPPS,18743.25
MISCELLANEOUS  BRANDIES,16564.99
OTHER PROOF VODKA,13520.5
IOWA DISTILLERIES,12138.75
ROCK & RYE,9125.25
WHITE CREME DE MENTHE,7937.25
IOWA DISTILLERY WHISKIES,7452.37
LOW PROOF VODKA,6966.0
CREME DE ALMOND,4998.0
ANISETTE,4072.5
JAPANESE WHISKY,1313.7
AMARETTO - IMPORTED,1131.75
SCHNAPPS - IMPORTED,288.06
IMPORTED GINS,234.0
IMPORTED VODKA - CHERRY,222.0
DELISTED ITEMS,111.98000000000002
HOLIDAY VAP,106.89999999999999
Query:
SELECT DATE_TRUNC('month', "date") AS "sale_month", "category_name", SUM("volume_sold_liters") AS "monthly_volume_liters"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   GROUP BY "sale_month", "category_name"
   ORDER BY "sale_month", "monthly_volume_liters" DESC
   LIMIT 100;
Answer:
sale_month,category_name,monthly_volume_liters
2012-01-01,VODKA 80 PROOF,239276.21999999994
2012-01-01,CANADIAN WHISKIES,129605.65
2012-01-01,SPICED RUM,83884.33
2012-01-01,BLENDED WHISKIES,67090.80000000002
2012-01-01,PUERTO RICO & VIRGIN ISLANDS RUM,59032.55000000001
2012-01-01,STRAIGHT BOURBON WHISKIES,53386.65
2012-01-01,AMERICAN COCKTAILS,50729.25000000001
2012-01-01,IMPORTED VODKAS,43234.12999999998
2012-01-01,TEQUILA,43016.159999999996
2012-01-01,VODKA FLAVORED,40753.850000000006
2012-01-01,FLAVORED RUM,28902.119999999995
2012-01-01,AMERICAN DRY GINS,28517.210000000003
2012-01-01,IMPORTED SCHNAPPS,26458.480000000003
2012-01-01,MISC. IMPORTED CORDIALS & LIQUEURS,25854.41
2012-01-01,WHISKEY LIQUEUR,24708.829999999994
2012-01-01,TENNESSEE WHISKIES,24678.309999999994
2012-01-01,AMERICAN GRAPE BRANDIES,20746.229999999996
2012-01-01,SCOTCH WHISKIES,18373.059999999998
2012-01-01,IMPORTED VODKA - MISC,18280.940000000002
2012-01-01,CREAM LIQUEURS,18068.86
2012-01-01,MISC. AMERICAN CORDIALS & LIQUEURS,14408.49
2012-01-01,100 PROOF VODKA,14100.75
2012-01-01,PEPPERMINT SCHNAPPS,12748.23
2012-01-01,TRIPLE SEC,11289.5
2012-01-01,PEACH SCHNAPPS,9345.220000000001
2012-01-01,DISTILLED SPIRITS SPECIALTY,9261.75
2012-01-01,AMERICAN AMARETTO,8013.5
2012-01-01,IMPORTED DRY GINS,7838.710000000001
2012-01-01,BLACKBERRY BRANDIES,7161.85
2012-01-01,COFFEE LIQUEURS,7132.12
2012-01-01,IMPORTED GRAPE BRANDIES,7040.82
2012-01-01,IRISH WHISKIES,6428.459999999999
2012-01-01,STRAIGHT RYE WHISKIES,5481.37
2012-01-01,APPLE SCHNAPPS,5160.99
2012-01-01,BUTTERSCOTCH SCHNAPPS,4265.61
2012-01-01,CINNAMON SCHNAPPS,3796.8900000000003
2012-01-01,APRICOT BRANDIES,3403.62
2012-01-01,GRAPE SCHNAPPS,2912.0
2012-01-01,AMERICAN ALCOHOL,2850.0
2012-01-01,SINGLE MALT SCOTCH,2638.24
2012-01-01,DECANTERS & SPECIALTY PACKAGES,2574.7600000000007
2012-01-01,WATERMELON SCHNAPPS,2522.0
2012-01-01,MISCELLANEOUS SCHNAPPS,2234.15
2012-01-01,ROOT BEER SCHNAPPS,2002.25
2012-01-01,IMPORTED AMARETTO,1526.6600000000003
2012-01-01,RASPBERRY SCHNAPPS,1363.0
2012-01-01,TROPICAL FRUIT SCHNAPPS,1328.75
2012-01-01,STRAWBERRY SCHNAPPS,1156.5
2012-01-01,CHERRY BRANDIES,1091.2600000000002
2012-01-01,JAMAICA RUM,987.75
2012-01-01,FLAVORED GINS,592.5
2012-01-01,WHITE CREME DE CACAO,590.25
2012-01-01,AMERICAN SLOE GINS,554.5
2012-01-01,GREEN CREME DE MENTHE,550.5
2012-01-01,PEACH BRANDIES,545.25
2012-01-01,DARK CREME DE CACAO,411.0
2012-01-01,SPEARMINT SCHNAPPS,319.75
2012-01-01,BOTTLED IN BOND BOURBON,293.25
2012-01-01,SINGLE BARREL BOURBON WHISKIES,279.0
2012-01-01,MISCELLANEOUS  BRANDIES,241.5
2012-01-01,,210.75
2012-01-01,OTHER PROOF VODKA,207.75
2012-01-01,BARBADOS RUM,165.0
2012-01-01,CREME DE ALMOND,120.75
2012-01-01,ROCK & RYE,120.0
2012-01-01,WHITE CREME DE MENTHE,92.25
2012-01-01,ANISETTE,51.0
2012-01-01,SCHNAPPS - IMPORTED,45.0
2012-01-01,LOW PROOF VODKA,17.25
2012-01-01,IMPORTED VODKA - CHERRY,12.0
2012-02-01,VODKA 80 PROOF,242492.5300000001
2012-02-01,CANADIAN WHISKIES,234011.37
2012-02-01,SPICED RUM,104165.01000000001
2012-02-01,PUERTO RICO & VIRGIN ISLANDS RUM,65527.96999999999
2012-02-01,BLENDED WHISKIES,64533.06999999999
2012-02-01,STRAIGHT BOURBON WHISKIES,55334.090000000004
2012-02-01,TEQUILA,50106.09000000001
2012-02-01,IMPORTED VODKAS,47198.92
2012-02-01,AMERICAN COCKTAILS,43200.46000000002
2012-02-01,VODKA FLAVORED,39213.13
2012-02-01,TENNESSEE WHISKIES,31079.479999999992
2012-02-01,AMERICAN DRY GINS,31011.36
2012-02-01,MISC. IMPORTED CORDIALS & LIQUEURS,28062.440000000002
2012-02-01,FLAVORED RUM,27770.16
2012-02-01,WHISKEY LIQUEUR,27391.750000000004
2012-02-01,IMPORTED SCHNAPPS,26289.489999999998
2012-02-01,MISC. AMERICAN CORDIALS & LIQUEURS,22095.469999999998
2012-02-01,CREAM LIQUEURS,21083.790000000008
2012-02-01,SCOTCH WHISKIES,20511.149999999998
2012-02-01,IMPORTED VODKA - MISC,20453.409999999996
2012-02-01,AMERICAN GRAPE BRANDIES,20244.24
2012-02-01,100 PROOF VODKA,14163.0
2012-02-01,PEPPERMINT SCHNAPPS,12880.189999999997
2012-02-01,TRIPLE SEC,12369.5
2012-02-01,IRISH WHISKIES,11407.809999999998
2012-02-01,IMPORTED GRAPE BRANDIES,10588.62
2012-02-01,DISTILLED SPIRITS SPECIALTY,10545.5
2012-02-01,IMPORTED DRY GINS,9061.089999999997
2012-02-01,PEACH SCHNAPPS,8998.589999999998
2012-02-01,AMERICAN AMARETTO,8527.0
Query:
SELECT
       "sale_month",
       "category_name",
       "monthly_volume_liters",
       "total_monthly_volume",
       ("monthly_volume_liters" / "total_monthly_volume") * 100 AS "percentage_contribution"
   FROM (
       SELECT
           DATE_TRUNC('month', "date") AS "sale_month",
           "category_name",
           SUM("volume_sold_liters") AS "monthly_volume_liters",
           SUM(SUM("volume_sold_liters")) OVER (PARTITION BY DATE_TRUNC('month', "date")) AS "total_monthly_volume"
       FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
       GROUP BY "sale_month", "category_name"
   )
   ORDER BY "sale_month", "percentage_contribution" DESC
   LIMIT 100;
Answer:
Too long, hard cut:
sale_month,category_name,monthly_volume_liters,total_monthly_volume,percentage_contribution
2012-01-01,VODKA 80 PROOF,239276.21999999994,1212082.49,19.740918788456383
2012-01-01,CANADIAN WHISKIES,129605.65000000001,1212082.49,10.692807714762056
2012-01-01,SPICED RUM,83884.33000000002,1212082.49,6.920678311259164
2012-01-01,BLENDED WHISKIES,67090.8,1212082.49,5.535167825087549
2012-01-01,PUERTO RICO & VIRGIN ISLANDS RUM,59032.55000000001,1212082.49,4.870340961694778
2012-01-01,STRAIGHT BOURBON WHISKIES,53386.649999999994,1212082.49,4.404539331312343
2012-01-01,AMERICAN COCKTAILS,50729.25000000002,1212082.49,4.185296827446127
2012-01-01,IMPORTED VODKAS,43234.13,1212082.49,3.566929673243609
2012-01-01,TEQUILA,43016.159999999996,1212082.49,3.5489465737600083
2012-01-01,VODKA FLAVORED,40753.85,1212082.49,3.3623000361963813
2012-01-01,FLAVORED RUM,28902.119999999995,1212082.49,2.384501074675206
2012-01-01,AMERICAN DRY GINS,28517.210000000003,1212082.49,2.3527449852031115
2012-01-01,IMPORTED SCHNAPPS,26458.480000000007,1212082.49,2.182894334196677
2012-01-01,MISC. IMPORTED CORDIALS & LIQUEURS,25854.41,1212082.49,2.133056967104607
2012-01-01,WHISKEY LIQUEUR,24708.829999999994,1212082.49,2.0385435978041393
2012-01-01,TENNESSEE WHISKIES,24678.31,1212082.49,2.036025617365366
2012-01-01,AMERICAN GRAPE BRANDIES,20746.230000000003,1212082.49,1.7116186539416145
2012-01-01,SCOTCH WHISKIES,18373.059999999998,1212082.49,1.5158258741944204
2012-01-01,IMPORTED VODKA - MISC,18280.940000000002,1212082.49,1.5082257314021592
2012-01-01,CREAM LIQUEURS,18068.86,1212082.49,1.4907285724422932
2012-01-01,MISC. AMERICAN CORDIALS & LIQUEURS,14408.49,1212082.49,1.1887384001397463
2012-01-01,100 PROOF VODKA,14100.75,1212082.49,1.1633490390575645
2012-01-01,PEPPERMINT SCHNAPPS,12748.23,1212082.49,1.0517625743442593
2012-01-01,TRIPLE SEC,11289.5,1212082.49,0.9314135047029678
2012-01-01,PEACH SCHNAPPS,9345.220000000001,1212082.49,0.7710052803419346
2012-01-01,DISTILLED SPIRITS SPECIALTY,9261.75,1212082.49,0.7641187853476871
2012-01-01,AMERICAN AMARETTO,8013.5,1212082.49,0.6611348704492876
2012-01-01,IMPORTED DRY GINS,7838.710000000003,1212082.49,0.6467142347712657
2012-01-01,BLACKBERRY BRANDIES,7161.85,1212082.49,0.5908715008332478
2012-01-01,COFFEE LIQUEURS,7132.12,1212082.49,0.5884186974766049
2012-01-01,IMPORTED GRAPE BRANDIES,7040.820000000002,1212082.49,0.5808862068455425
2012-01-01,IRISH WHISKIES,6428.459999999999,1212082.49,0.5303648929042775
2012-01-01,STRAIGHT RYE WHISKIES,5481.37,1212082.49,0.4522274717457555
2012-01-01,APPLE SCHNAPPS,5160.99,1212082.49,0.4257952773494814
2012-01-01,BUTTERSCOTCH SCHNAPPS,4265.61,1212082.49,0.35192406747827865
2012-01-01,CINNAMON SCHNAPPS,3796.8900000000012,1212082.49,0.3132534321158291
2012-01-01,APRICOT BRANDIES,3403.62,1212082.49,0.2808076206100461
2012-01-01,GRAPE SCHNAPPS,2912.0,1212082.49,0.2402476748921602
2012-01-01,AMERICAN ALCOHOL,2850.0,1212082.49,0.23513251148442876
2012-01-01,SINGLE MALT SCOTCH,2638.24,1212082.49,0.21766175336795762
2012-01-01,DECANTERS & SPECIALTY PACKAGES,2574.76,1212082.49,0.21242448605952557
2012-01-01,WATERMELON SCHNAPPS,2522.0,1212082.49,0.20807164700481728
2012-01-01,MISCELLANEOUS SCHNAPPS,2234.15,1212082.49,0.18432326334489002
2012-01-01,ROOT BEER SCHNAPPS,2002.25,1212082.49,0.1651909021472623
2012-01-01,IMPORTED AMARETTO,1526.6600000000003,1212082.49,0.12595347367818177
2012-01-01,RASPBERRY SCHNAPPS,1363.0,1212082.49,0.11245109233448294
2012-01-01,TROPICAL FRUIT SCHNAPPS,1328.75,1212082.49,0.10962537706488938
2012-01-01,STRAWBERRY SCHNAPPS,1156.5,1212082.49,0.09541429808131294
2012-01-01,CHERRY BRANDIES,1091.2599999999998,1212082.49,0.09003182613420971
2012-01-01,JAMAICA RUM,987.75,1212082.49,0.0814919783223665
2012-01-01,FLAVORED GINS,592.5,1212082.49,0.04888281159807861
2012-01-01,WHITE CREME DE CACAO,590.25,1212082.49,0.048697180667959326
2012-01-01,AMERICAN SLOE GINS,554.5,1212082.49,0.04574771144495289
2012-01-01,GREEN CREME DE MENTHE,550.5,1212082.49,0.04541770090251861
2012-01-01,PEACH BRANDIES,545.25,1212082.49,0.04498456206557361
2012-01-01,DARK CREME DE CACAO,411.0,1212082.49,0.033908583235122886
2012-01-01,SPEARMINT SCHNAPPS,319.75,1212082.49,0.026380217735840737
2012-01-01,BOTTLED IN BOND BOURBON,293.25,1212082.49,0.02419389789221359
2012-01-01,SINGLE BARREL BOURBON WHISKIES,279.0,1212082.49,0.023018235334791446
2012-01-01,MISCELLANEOUS  BRANDIES,241.5,1212082.49,0.019924386499470016
2012-01-01,,210.75,1212082.49,0.017387430454506442
2012-01-01,OTHER PROOF VODKA,207.75,1212082.49,0.01713992254768073
2012-01-01,BARBADOS RUM,165.0,1212082.49,0.013612934875414297
2012-01-01,CREME DE ALMOND,120.75,1212082.49,0.009962193249735008
2012-01-01,ROCK & RYE,120.0,1212082.49,0.009900316273028578
2012-01-01,WHITE CREME DE MENTHE,92.25,1212082.49,0.00761086813489072
2012-01-01,ANISETTE,51.0,1212082.49,0.004207634416037146
2012-01-01,SCHNAPPS - IMPORTED,45.0,1212082.49,0.003712618602385717
2012-01-01,LOW PROOF VODKA,17.25,1212082.49,0.0014231704642478581
2012-01-01
Query:
SELECT
       "category_name",
       AVG("percentage_contribution") AS "average_monthly_percentage"
   FROM (
       SELECT
           DATE_TRUNC('month', "date") AS "sale_month",
           "category_name",
           SUM("volume_sold_liters") AS "monthly_volume_liters",
           SUM(SUM("volume_sold_liters")) OVER (PARTITION BY DATE_TRUNC('month', "date")) AS "total_monthly_volume",
           (SUM("volume_sold_liters") / SUM(SUM("volume_sold_liters")) OVER (PARTITION BY DATE_TRUNC('month', "date"))) * 100 AS "percentage_contribution"
       FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
       GROUP BY "sale_month", "category_name"
   )
   GROUP BY "category_name"
   HAVING AVG("percentage_contribution") >= 1
   ORDER BY "average_monthly_percentage" DESC
   LIMIT 100;
Answer:
category_name,average_monthly_percentage
AMERICAN VODKAS,23.211560671643834
VODKA 80 PROOF,19.989118145977837
CANADIAN WHISKIES,12.846569201285469
SPICED RUM,6.63366832927565
STRAIGHT BOURBON WHISKIES,4.779229159342462
PUERTO RICO & VIRGIN ISLANDS RUM,4.38089716382291
WHISKEY LIQUEUR,4.2394859393384206
COCKTAILS/RTD,3.8749806651602934
BLENDED WHISKIES,3.8369418781008258
IMPORTED VODKAS,3.8143087242539204
TEQUILA,3.7768038168484925
AMERICAN COCKTAILS,3.614724515550464
VODKA FLAVORED,3.260047947039869
AMERICAN FLAVORED VODKA,3.0131590305263685
WHITE RUM,2.5156675926018517
MIXTO TEQUILA,2.496236997790848
TENNESSEE WHISKIES,2.2545534628173156
100% AGAVE TEQUILA,2.2011268984503145
AMERICAN SCHNAPPS,2.1070002633160443
FLAVORED RUM,2.1068569276398645
AMERICAN BRANDIES,1.7717188611942372
AMERICAN DRY GINS,1.7153390417300753
MISC. IMPORTED CORDIALS & LIQUEURS,1.6431442707250719
CREAM LIQUEURS,1.5341837293758047
IMPORTED VODKA - MISC,1.4644595366481572
AMERICAN GRAPE BRANDIES,1.4587593663076601
IMPORTED CORDIALS & LIQUEURS,1.4266010593150484
IMPORTED SCHNAPPS,1.3494648110187932
TEMPORARY & SPECIALTY PACKAGES,1.1949668899206516
SCOTCH WHISKIES,1.1672623847938821
IMPORTED BRANDIES,1.154497901468017
IMPORTED FLAVORED VODKA,1.0869783959016832
100 PROOF VODKA,1.0855406376304841
AMERICAN CORDIALS & LIQUEURS,1.0259900695077677
IRISH WHISKIES,1.0104208675045347
Query:
SELECT
       t."sale_month",
       t."category_name",
       t."percentage_contribution"
   FROM (
       SELECT
           DATE_TRUNC('month', "date") AS "sale_month",
           "category_name",
           (SUM("volume_sold_liters") / SUM(SUM("volume_sold_liters")) OVER (PARTITION BY DATE_TRUNC('month', "date"))) * 100 AS "percentage_contribution"
       FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
       GROUP BY "sale_month", "category_name"
   ) t
   WHERE t."category_name" IN (
       SELECT "category_name"
       FROM (
           SELECT
               "category_name",
               AVG("percentage_contribution") AS "average_monthly_percentage"
           FROM (
               SELECT
                   DATE_TRUNC('month', "date") AS "sale_month",
                   "category_name",
                   (SUM("volume_sold_liters") / SUM(SUM("volume_sold_liters")) OVER (PARTITION BY DATE_TRUNC('month', "date"))) * 100 AS "percentage_contribution"
               FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
               GROUP BY "sale_month", "category_name"
           )
           GROUP BY "category_name"
           HAVING AVG("percentage_contribution") >= 1
       )
   )
   ORDER BY t."category_name", t."sale_month"
   LIMIT 100;
Answer:
sale_month,category_name,percentage_contribution
2012-01-01,100 PROOF VODKA,1.1633490390575645
2012-02-01,100 PROOF VODKA,1.0214446914744806
2012-03-01,100 PROOF VODKA,1.189320800991667
2012-04-01,100 PROOF VODKA,0.9606774564584579
2012-05-01,100 PROOF VODKA,1.0328719358020448
2012-06-01,100 PROOF VODKA,1.0269458286500286
2012-07-01,100 PROOF VODKA,1.0672092671045843
2012-08-01,100 PROOF VODKA,1.163244180265713
2012-09-01,100 PROOF VODKA,1.0777589965629977
2012-10-01,100 PROOF VODKA,0.8636571850342041
2012-11-01,100 PROOF VODKA,1.0263766859746977
2012-12-01,100 PROOF VODKA,0.9059109084435057
2013-01-01,100 PROOF VODKA,1.0514944161018234
2013-02-01,100 PROOF VODKA,0.9956412801645793
2013-03-01,100 PROOF VODKA,1.254224461630033
2013-04-01,100 PROOF VODKA,1.0819590965282815
2013-05-01,100 PROOF VODKA,1.0734246943975043
2013-06-01,100 PROOF VODKA,1.3082074278499314
2013-07-01,100 PROOF VODKA,1.2476288679538126
2013-08-01,100 PROOF VODKA,1.3065736199901146
2013-09-01,100 PROOF VODKA,1.3108025430944017
2013-10-01,100 PROOF VODKA,0.9591945118244248
2013-11-01,100 PROOF VODKA,1.176099065928488
2013-12-01,100 PROOF VODKA,1.0129330996571948
2014-01-01,100 PROOF VODKA,1.0727819883134366
2014-02-01,100 PROOF VODKA,1.0297042632928717
2014-03-01,100 PROOF VODKA,1.1365943823634375
2014-04-01,100 PROOF VODKA,1.0113696732654947
2014-05-01,100 PROOF VODKA,1.0803778754105566
2014-06-01,100 PROOF VODKA,1.1021112899340182
2014-07-01,100 PROOF VODKA,1.136132445632187
2014-08-01,100 PROOF VODKA,1.1053297494842185
2014-09-01,100 PROOF VODKA,0.9838397138800449
2014-10-01,100 PROOF VODKA,0.9233434609174886
2014-11-01,100 PROOF VODKA,1.134407754393231
2014-12-01,100 PROOF VODKA,0.9819489784748188
2015-01-01,100 PROOF VODKA,1.1443977230379054
2015-02-01,100 PROOF VODKA,0.9754159375755758
2015-03-01,100 PROOF VODKA,1.256169628001813
2015-04-01,100 PROOF VODKA,1.3271292970921202
2015-05-01,100 PROOF VODKA,1.1279873156800002
2015-06-01,100 PROOF VODKA,1.2927714219959536
2015-07-01,100 PROOF VODKA,1.3340918255249117
2015-08-01,100 PROOF VODKA,1.3683618828733959
2015-09-01,100 PROOF VODKA,1.391113916041935
2015-10-01,100 PROOF VODKA,1.1112711785739104
2015-11-01,100 PROOF VODKA,1.3313012765078018
2015-12-01,100 PROOF VODKA,1.1967764345213394
2016-01-01,100 PROOF VODKA,1.427062788066734
2016-02-01,100 PROOF VODKA,4.791465898795506
2016-03-01,100 PROOF VODKA,0.06276826464941536
2016-04-01,100 PROOF VODKA,0.36643774760071834
2016-05-01,100 PROOF VODKA,0.05144572746591471
2016-06-01,100 PROOF VODKA,0.1196656161537226
2016-07-01,100 PROOF VODKA,0.07097153271761
2016-08-01,100 PROOF VODKA,0.06877865812850588
2016-08-01,100% AGAVE TEQUILA,0.05646463299049841
2016-09-01,100% AGAVE TEQUILA,1.0774844867190003
2016-10-01,100% AGAVE TEQUILA,1.0329247248349813
2016-11-01,100% AGAVE TEQUILA,1.344048876517322
2016-12-01,100% AGAVE TEQUILA,1.066953792860406
2017-01-01,100% AGAVE TEQUILA,1.2826389106910188
2017-02-01,100% AGAVE TEQUILA,1.1234865107873644
2017-03-01,100% AGAVE TEQUILA,1.2863767075737695
2017-04-01,100% AGAVE TEQUILA,1.6363200227104973
2017-05-01,100% AGAVE TEQUILA,1.5205531107754628
2017-06-01,100% AGAVE TEQUILA,1.3367510714741035
2017-07-01,100% AGAVE TEQUILA,1.3500706773825792
2017-08-01,100% AGAVE TEQUILA,1.471351363546685
2017-09-01,100% AGAVE TEQUILA,1.2268310840799344
2017-10-01,100% AGAVE TEQUILA,1.2177002135110022
2017-11-01,100% AGAVE TEQUILA,1.3673388717457475
2017-12-01,100% AGAVE TEQUILA,1.181445609255253
2018-01-01,100% AGAVE TEQUILA,1.2277317263473662
2018-02-01,100% AGAVE TEQUILA,1.2977254620921497
2018-03-01,100% AGAVE TEQUILA,1.4328527245623457
2018-04-01,100% AGAVE TEQUILA,1.5883718044712554
2018-05-01,100% AGAVE TEQUILA,1.557475113624334
2018-06-01,100% AGAVE TEQUILA,1.4929892772767217
2018-07-01,100% AGAVE TEQUILA,1.4698557906398295
2018-08-01,100% AGAVE TEQUILA,1.6170220120440542
2018-09-01,100% AGAVE TEQUILA,1.394958043013684
2018-10-01,100% AGAVE TEQUILA,1.6958839021890535
2018-11-01,100% AGAVE TEQUILA,1.4304599673962077
2018-12-01,100% AGAVE TEQUILA,1.2685784985116033
2019-01-01,100% AGAVE TEQUILA,1.374276024682227
2019-02-01,100% AGAVE TEQUILA,1.2216331826453672
2019-03-01,100% AGAVE TEQUILA,1.559269703842704
2019-04-01,100% AGAVE TEQUILA,2.1416953566532797
2019-05-01,100% AGAVE TEQUILA,1.8997582172419782
2019-06-01,100% AGAVE TEQUILA,2.2323397425855322
2019-07-01,100% AGAVE TEQUILA,1.8324010981530015
2019-08-01,100% AGAVE TEQUILA,1.6599297418595331
2019-09-01,100% AGAVE TEQUILA,1.321376424064385
2019-10-01,100% AGAVE TEQUILA,1.3406611667010975
2019-11-01,100% AGAVE TEQUILA,1.4927417595238661
2019-12-01,100% AGAVE TEQUILA,1.5764544941787462
2020-01-01,100% AGAVE TEQUILA,1.6611894703940742
2020-02-01,100% AGAVE TEQUILA,1.4654484075718315
2020-03-01,100% AGAVE TEQUILA,1.649588338958626
Query:
SELECT
   DATE_TRUNC('month', "date") AS "sale_month",
   "category_name",
   (SUM("volume_sold_liters") / SUM(SUM("volume_sold_liters")) OVER (PARTITION BY DATE_TRUNC('month', "date"))) * 100 AS "percentage_contribution"
FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
GROUP BY "sale_month", "category_name"
ORDER BY "category_name", "sale_month"
LIMIT 100;
Answer:
sale_month,category_name,percentage_contribution
2012-01-01,100 PROOF VODKA,1.1633490390575647
2012-02-01,100 PROOF VODKA,1.0214446914744808
2012-03-01,100 PROOF VODKA,1.1893208009916671
2012-04-01,100 PROOF VODKA,0.9606774564584579
2012-05-01,100 PROOF VODKA,1.0328719358020446
2012-06-01,100 PROOF VODKA,1.0269458286500288
2012-07-01,100 PROOF VODKA,1.0672092671045845
2012-08-01,100 PROOF VODKA,1.163244180265713
2012-09-01,100 PROOF VODKA,1.0777589965629983
2012-10-01,100 PROOF VODKA,0.8636571850342043
2012-11-01,100 PROOF VODKA,1.0263766859746977
2012-12-01,100 PROOF VODKA,0.9059109084435055
2013-01-01,100 PROOF VODKA,1.0514944161018231
2013-02-01,100 PROOF VODKA,0.9956412801645796
2013-03-01,100 PROOF VODKA,1.2542244616300335
2013-04-01,100 PROOF VODKA,1.0819590965282817
2013-05-01,100 PROOF VODKA,1.0734246943975045
2013-06-01,100 PROOF VODKA,1.3082074278499318
2013-07-01,100 PROOF VODKA,1.2476288679538123
2013-08-01,100 PROOF VODKA,1.306573619990115
2013-09-01,100 PROOF VODKA,1.3108025430944017
2013-10-01,100 PROOF VODKA,0.9591945118244244
2013-11-01,100 PROOF VODKA,1.176099065928488
2013-12-01,100 PROOF VODKA,1.0129330996571948
2014-01-01,100 PROOF VODKA,1.0727819883134366
2014-02-01,100 PROOF VODKA,1.0297042632928717
2014-03-01,100 PROOF VODKA,1.1365943823634377
2014-04-01,100 PROOF VODKA,1.011369673265495
2014-05-01,100 PROOF VODKA,1.0803778754105564
2014-06-01,100 PROOF VODKA,1.1021112899340182
2014-07-01,100 PROOF VODKA,1.1361324456321866
2014-08-01,100 PROOF VODKA,1.1053297494842187
2014-09-01,100 PROOF VODKA,0.9838397138800449
2014-10-01,100 PROOF VODKA,0.9233434609174886
2014-11-01,100 PROOF VODKA,1.1344077543932307
2014-12-01,100 PROOF VODKA,0.9819489784748183
2015-01-01,100 PROOF VODKA,1.1443977230379054
2015-02-01,100 PROOF VODKA,0.9754159375755753
2015-03-01,100 PROOF VODKA,1.2561696280018129
2015-04-01,100 PROOF VODKA,1.3271292970921202
2015-05-01,100 PROOF VODKA,1.1279873156800002
2015-06-01,100 PROOF VODKA,1.2927714219959543
2015-07-01,100 PROOF VODKA,1.3340918255249121
2015-08-01,100 PROOF VODKA,1.3683618828733957
2015-09-01,100 PROOF VODKA,1.391113916041935
2015-10-01,100 PROOF VODKA,1.1112711785739104
2015-11-01,100 PROOF VODKA,1.3313012765078023
2015-12-01,100 PROOF VODKA,1.1967764345213394
2016-01-01,100 PROOF VODKA,1.4270627880667341
2016-02-01,100 PROOF VODKA,4.791465898795506
2016-03-01,100 PROOF VODKA,0.06276826464941537
2016-04-01,100 PROOF VODKA,0.36643774760071823
2016-05-01,100 PROOF VODKA,0.05144572746591471
2016-06-01,100 PROOF VODKA,0.11966561615372256
2016-07-01,100 PROOF VODKA,0.07097153271761
2016-08-01,100 PROOF VODKA,0.06877865812850589
2016-08-01,100% AGAVE TEQUILA,0.05646463299049841
2016-09-01,100% AGAVE TEQUILA,1.0774844867190003
2016-10-01,100% AGAVE TEQUILA,1.0329247248349813
2016-11-01,100% AGAVE TEQUILA,1.344048876517322
2016-12-01,100% AGAVE TEQUILA,1.0669537928604063
2017-01-01,100% AGAVE TEQUILA,1.2826389106910192
2017-02-01,100% AGAVE TEQUILA,1.1234865107873642
2017-03-01,100% AGAVE TEQUILA,1.28637670757377
2017-04-01,100% AGAVE TEQUILA,1.6363200227104981
2017-05-01,100% AGAVE TEQUILA,1.5205531107754624
2017-06-01,100% AGAVE TEQUILA,1.336751071474104
2017-07-01,100% AGAVE TEQUILA,1.3500706773825792
2017-08-01,100% AGAVE TEQUILA,1.4713513635466848
2017-09-01,100% AGAVE TEQUILA,1.226831084079934
2017-10-01,100% AGAVE TEQUILA,1.2177002135110022
2017-11-01,100% AGAVE TEQUILA,1.367338871745748
2017-12-01,100% AGAVE TEQUILA,1.181445609255253
2018-01-01,100% AGAVE TEQUILA,1.2277317263473664
2018-02-01,100% AGAVE TEQUILA,1.2977254620921492
2018-03-01,100% AGAVE TEQUILA,1.4328527245623461
2018-04-01,100% AGAVE TEQUILA,1.5883718044712554
2018-05-01,100% AGAVE TEQUILA,1.557475113624334
2018-06-01,100% AGAVE TEQUILA,1.4929892772767213
2018-07-01,100% AGAVE TEQUILA,1.4698557906398297
2018-08-01,100% AGAVE TEQUILA,1.6170220120440535
2018-09-01,100% AGAVE TEQUILA,1.3949580430136843
2018-10-01,100% AGAVE TEQUILA,1.6958839021890528
2018-11-01,100% AGAVE TEQUILA,1.430459967396207
2018-12-01,100% AGAVE TEQUILA,1.2685784985116038
2019-01-01,100% AGAVE TEQUILA,1.374276024682227
2019-02-01,100% AGAVE TEQUILA,1.2216331826453668
2019-03-01,100% AGAVE TEQUILA,1.5592697038427041
2019-04-01,100% AGAVE TEQUILA,2.14169535665328
2019-05-01,100% AGAVE TEQUILA,1.8997582172419778
2019-06-01,100% AGAVE TEQUILA,2.2323397425855322
2019-07-01,100% AGAVE TEQUILA,1.8324010981530015
2019-08-01,100% AGAVE TEQUILA,1.6599297418595338
2019-09-01,100% AGAVE TEQUILA,1.321376424064385
2019-10-01,100% AGAVE TEQUILA,1.3406611667010975
2019-11-01,100% AGAVE TEQUILA,1.4927417595238661
2019-12-01,100% AGAVE TEQUILA,1.5764544941787466
2020-01-01,100% AGAVE TEQUILA,1.6611894703940744
2020-02-01,100% AGAVE TEQUILA,1.465448407571832
2020-03-01,100% AGAVE TEQUILA,1.6495883389586266
Query:
WITH category_monthly_totals AS (
    SELECT
        DATE_TRUNC('month', "date") AS "sale_month",
        "category_name",
        SUM("volume_sold_liters") AS "monthly_volume_liters"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    GROUP BY DATE_TRUNC('month', "date"), "category_name"
),
monthly_totals AS (
    SELECT
        DATE_TRUNC('month', "date") AS "sale_month",
        SUM("volume_sold_liters") AS "total_monthly_volume"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    GROUP BY DATE_TRUNC('month', "date")
)
SELECT
    cmt."category_name",
    VAR_SAMP((cmt."monthly_volume_liters" / mt."total_monthly_volume") * 100) AS "variance_in_percentage"
FROM category_monthly_totals cmt
JOIN monthly_totals mt ON cmt."sale_month" = mt."sale_month"
GROUP BY cmt."category_name"
ORDER BY "variance_in_percentage" DESC
LIMIT 100;
Answer:
category_name,variance_in_percentage
AMERICAN WHISKIES,
DELISTED / SPECIAL ORDER ITEMS,
AMERICAN VODKAS,8.462597903337814
CANADIAN WHISKIES,5.614826018924614
VODKA 80 PROOF,3.150257274152049
COCKTAILS/RTD,2.5837255361237985
AMERICAN COCKTAILS,1.750868925854158
SPICED RUM,1.3857440139434631
WHISKEY LIQUEUR,0.7778761771791421
100% AGAVE TEQUILA,0.727239450803702
TEMPORARY & SPECIALTY PACKAGES,0.6813787123320924
STRAIGHT BOURBON WHISKIES,0.5983871558519062
IMPORTED VODKAS,0.5391904675252108
BLENDED WHISKIES,0.4735683348477357
DECANTERS & SPECIALTY PACKAGES,0.4394386970212799
CREAM LIQUEURS,0.39882105000838036
100 PROOF VODKA,0.37048770543842263
PUERTO RICO & VIRGIN ISLANDS RUM,0.23281973313297186
TEQUILA,0.209306755495319
WHITE RUM,0.2022224877009968
VODKA FLAVORED,0.18130788420240404
TENNESSEE WHISKIES,0.1738389739582847
DISTILLED SPIRITS SPECIALTY,0.17080129360890062
AMERICAN FLAVORED VODKA,0.16493145949869692
MIXTO TEQUILA,0.15955527588587065
AMERICAN DRY GINS,0.1570642244734157
SPECIAL ORDER ITEMS,0.14625862279121088
AMERICAN BRANDIES,0.11999227316761565
AMERICAN SCHNAPPS,0.1150479781768279
FLAVORED RUM,0.10909226095848787
IRISH WHISKIES,0.1070718887255627
MISC. AMERICAN CORDIALS & LIQUEURS,0.10605943105906494
IMPORTED DISTILLED SPIRITS SPECIALTY,0.10115158422010276
IMPORTED BRANDIES,0.09059952940941021
AMERICAN CORDIALS & LIQUEURS,0.07861072557784136
IMPORTED FLAVORED VODKA,0.06611497451274397
SCOTCH WHISKIES,0.06161922319680269
,0.0601991289314702
MISC. IMPORTED CORDIALS & LIQUEURS,0.05401311281166804
IMPORTED CORDIALS & LIQUEURS,0.0469397671976796
STRAIGHT RYE WHISKIES,0.04445865524340215
IMPORTED SCHNAPPS,0.04003570852909186
NEUTRAL GRAIN SPIRITS FLAVORED,0.02897719716197301
AMERICAN GRAPE BRANDIES,0.02334294471044058
IMPORTED GRAPE BRANDIES,0.02167326902284848
IMPORTED VODKA - MISC,0.02042668333867085
PEPPERMINT SCHNAPPS,0.020003021640362866
IMPORTED DRY GINS,0.018188591151905308
TRIPLE SEC,0.016234537928250237
COFFEE LIQUEURS,0.014274281222847515
AMERICAN DISTILLED SPIRITS SPECIALTY,0.010386006249250188
GOLD RUM,0.00899836848618646
BLACKBERRY BRANDIES,0.007779886505673849
PEACH SCHNAPPS,0.006592771128604286
AMERICAN AMARETTO,0.005969257613826092
APPLE SCHNAPPS,0.005015253019360247
AMERICAN ALCOHOL,0.004617374429861966
BUTTERSCOTCH SCHNAPPS,0.0037478078035864714
SINGLE MALT SCOTCH,0.0035935086703948525
CINNAMON SCHNAPPS,0.003325820647534809
NEUTRAL GRAIN SPIRITS,0.0030735181129679457
SINGLE BARREL BOURBON WHISKIES,0.002889134449097331
BOTTLED IN BOND BOURBON,0.002859275612982518
BARBADOS RUM,0.0025677098278757493
FLAVORED GIN,0.002101838937884464
APRICOT BRANDIES,0.00204273667146138
PEACH BRANDIES,0.0016903163465578203
GRAPE SCHNAPPS,0.0013584725141155853
IMPORTED AMARETTO,0.0008920233732357023
AGED DARK RUM,0.0007816821639731672
WATERMELON SCHNAPPS,0.0007499711073382265
GREEN CREME DE MENTHE,0.0006496791245085383
ROOT BEER SCHNAPPS,0.0005509151701852705
IOWA DISTILLERY WHISKIES,0.0005396259962914077
MISCELLANEOUS SCHNAPPS,0.0005334619840598717
CORN WHISKIES,0.00043216354489278
TROPICAL FRUIT SCHNAPPS,0.00036408909814686314
MISCELLANEOUS  BRANDIES,0.0003037219287822825
WHITE CREME DE CACAO,0.00030138359114893407
MEZCAL,0.000293308079034139
JAMAICA RUM,0.00027805127889013025
STRAWBERRY SCHNAPPS,0.00022102888948993699
CHERRY BRANDIES,0.00021548813130116897
RASPBERRY SCHNAPPS,0.00019439501661975048
JAPANESE WHISKY,0.00018378951315470404
DARK CREME DE CACAO,0.0001489497577921473
FLAVORED GINS,0.00010874939591879909
AMERICAN SLOE GINS,8.896180745593601e-05
LOW PROOF VODKA,8.771040756584952e-05
IOWA DISTILLERIES,6.29442249773582e-05
OTHER PROOF VODKA,2.5157486250355735e-05
WHITE CREME DE MENTHE,2.3852394813737155e-05
SPEARMINT SCHNAPPS,2.2485010190058764e-05
CREME DE ALMOND,1.922698119965624e-05
ROCK & RYE,1.282040590906722e-05
DELISTED ITEMS,5.298080499779464e-06
ANISETTE,3.3450915536834863e-06
SCHNAPPS - IMPORTED,2.7767536671910788e-06
AMARETTO - IMPORTED,2.6183521411544875e-06
HOLIDAY VAP,2.5724005995399038e-06
Query:
SELECT *
FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
LIMIT 100
Answer:
Too long, hard cut:
invoice_and_item_number,date,store_number,store_name,address,city,zip_code,store_location,county_number,county,category,category_name,vendor_number,vendor_name,item_number,item_description,pack,bottle_volume_ml,state_bottle_cost,state_bottle_retail,bottles_sold,sale_dollars,volume_sold_liters,volume_sold_gallons
RINV-05376800029,2024-08-08,10241,"FAREWAY STORES, INC. #237 / LE CLAIRE",1301 EAGLE RIDGE ROAD,LE CLAIRE,52753.0,bytearray(b'\x01\x01\x00\x00\x00 \x91\xc3\x1b\n\x97V\xc0\xe0\x12\x80\x7fJ\xcbD@'),,SCOTT,1031100.0,AMERICAN VODKAS,434,LUXCO INC,36308,HAWKEYE VODKA,6,1750,7.5,11.25,-12,-135.0,-21.0,-5.54
RINV-04825600013,2023-08-30,5512,CASEY'S GENERAL STORE #3639 / POSTVILLE,620 W TILDEN ST,POSTVILLE,52162.0,bytearray(b'\x01\x01\x00\x00\x00[\x7f\xa1\x00\x17\xe5V\xc0\x85.\xf5\xb4\xc2\x8aE@'),,ALLAMAKEE,1012100.0,CANADIAN WHISKIES,259,HEAVEN HILL BRANDS,10550,BLACK VELVET TOASTED CARAMEL,12,750,5.74,8.61,-24,-206.64,-18.0,-4.75
RINV-04673900228,2023-06-06,2633,HY-VEE #3 / BDI / DES MOINES,3221 SE 14TH ST,DES MOINES,50320.0,bytearray(b'\x01\x01\x00\x00\x00\x9a\xae4\xe4\x10fW\xc0M\x07@I\xf2\xc6D@'),,POLK,1041100.0,AMERICAN DRY GINS,421,SAZERAC COMPANY  INC,29287,BARTON GIN,12,1000,3.92,5.88,-12,-70.56,-12.0,-3.17
RINV-04933100044,2023-11-01,10227,GRIMES LIQUOR SHOP / GRIMES,3600 SOUTHEAST CROSSROADS DRIVE,GRIMES,50111.0,bytearray(b'\x01\x01\x00\x00\x00\x8a\xf1*\x03xqW\xc0q\xa2e\xf6\\\xd4D@'),,POLK,1062400.0,SPICED RUM,260,DIAGEO AMERICAS,43337,CAPTAIN MORGAN ORIGINAL SPICED,12,1000,12.99,19.49,-12,-233.88,-12.0,-3.17
RINV-04774000149,2023-07-27,3456,QUICK SHOP / CLEAR LAKE,904 N 8TH ST,CLEARLAKE,50428.0,bytearray(b'\x01\x01\x00\x00\x00\x13w\xc4:8XW\xc0\x98\x05\\UK\x92E@'),,CERRO GORDO,1081200.0,CREAM LIQUEURS,259,HEAVEN HILL BRANDS,68127,CAROLANS IRISH CREAM,12,1000,12.5,18.75,-12,-225.0,-12.0,-3.17
RINV-05329400157,2024-07-03,2633,HY-VEE #3 / BDI / DES MOINES,3221 SE 14TH ST,DES MOINES,50320.0,bytearray(b'\x01\x01\x00\x00\x00\x9a\xae4\xe4\x10fW\xc0M\x07@I\xf2\xc6D@'),,POLK,1022200.0,100% AGAVE TEQUILA,192,"MAST-JAGERMEISTER US, INC",88355,TEREMANA BLANCO TEQUILA,6,1000,18.46,27.69,-12,-332.28,-12.0,-3.17
RINV-05228700034,2024-04-18,3354,SAM'S CLUB 8238 / DAVENPORT,3845 ELMORE AVE.,DAVENPORT,52807.0,bytearray(b'\x01\x01\x00\x00\x00\xc9\x83\xedZ\xb4\xa1V\xc0\x9e\x9f\xf6\x1cW\xc7D@'),,SCOTT,1022100.0,MIXTO TEQUILA,421,SAZERAC COMPANY  INC,89577,MONTEZUMA GOLD,12,1000,7.5,11.25,-12,-135.0,-12.0,-3.17
RINV-05163600144,2024-03-04,2191,KEOKUK SPIRITS,1013 MAIN,KEOKUK,52632.0,bytearray(b'\x01\x01\x00\x00\x00\xd7L\xb9 \xcd\xd8V\xc0<Jb\x9f93D@'),,LEE,1011200.0,STRAIGHT BOURBON WHISKIES,65,JIM BEAM BRANDS,19070,JIM BEAM PET,6,1750,21.5,32.25,-6,-193.5,-10.5,-2.77
RINV-05064800052,2024-01-03,2652,HY-VEE DRUGSTORE / MASON CITY,875  4TH ST SW,MASON CITY,50401.0,bytearray(b'\x01\x01\x00\x00\x00\xa4\x85J\xaa\xb6MW\xc0\xa4 )6\xe7\x92E@'),,CERRO GORDO,1071000.0,COCKTAILS/RTD,395,PROXIMO,58838,JOSE CUERVO AUTHENTIC LIME MARGARITA,6,1750,8.74,13.11,-6,-78.66,-10.5,-2.77
RINV-04313200070,2022-10-12,4877,WORLD LIQUOR & TOBACCO,1775 NW 86TH ST,CLIVE,50325.0,bytearray(b'\x01\x01\x00\x00\x00\x1aO\x04q\x1eoW\xc06\x01\x86\xe5\xcf\xcdD@'),,POLK,1071000.0,COCKTAILS/RTD,395,PROXIMO,59162,1800 ULTIMATE PINEAPPLE MARGARITA PET,6,1750,10.04,15.06,-6,-90.36,-10.5,-2.77
RINV-04860600095,2023-09-21,2549,HY-VEE FOOD STORE (1271) / INDIANOLA,910 N JEFFERSON,INDIANOLA,50125.0,bytearray(b'\x01\x01\x00\x00\x00\xc6\x13\x07\xf1\x9dcW\xc0\xa3k\x9e\xa42\xafD@'),,WARREN,1031200.0,AMERICAN FLAVORED VODKA,260,DIAGEO AMERICAS,77994,"SMIRNOFF RED, WHITE & BERRY",6,1750,14.75,22.13,-6,-132.78,-10.5,-2.77
RINV-05111400054,2024-01-30,10200,"MUGHAL, INC. / WATERLOO",735 LOGAN AVE.,WATERLOO,50703.0,bytearray(b'\x01\x01\x00\x00\x00\xe1D$\xa5\xa1\x15W\xc0SP\xdd\x9eXAE@'),,BLACK HAWK,1022200.0,100% AGAVE TEQUILA,395,PROXIMO,87402,JOSE CUERVO ESPECIAL SILVER,48,200,3.63,5.45,-48,-261.6,-9.6,-2.53
RINV-05005400039,2023-12-06,3814,COSTCO WHOLESALE #788 / WDM,7205 MILLS CIVIC PKWY,WEST DES MOINES,50266.0,bytearray(b'\x01\x01\x00\x00\x00\x0bhxl\x91sW\xc0\xeb`Fv\xfa\xc7D@'),,DALLAS,1011200.0,STRAIGHT BOURBON WHISKIES,125,CEDAR RIDGE VINEYARDS LL,17206,CEDAR RIDGE BOURBON,6,750,18.67,28.01,-12,-336.12,-9.0,-2.37
RINV-05281100030,2024-06-03,6201,NEIGHBORHOOD TOBACCO OUTLET / MARION,2500 7TH AVENUE,MARION,52302.0,bytearray(b'\x01\x01\x00\x00\x00;3\x08Fz\xe5V\xc0\xdb\xe3\xf9\xcaK\x04E@'),,LINN,1031100.0,AMERICAN VODKAS,300,MCCORMICK DISTILLING CO.,36886,MCCORMICK 80PRF VODKA,12,750,3.64,5.46,-12,-65.52,-9.0,-2.37
RINV-05170600034,2024-03-12,5507,QUIK TRIP #559 / FLEUR,4021 FLEUR DR,DES MOINES,50321.0,bytearray(b'\x01\x01\x00\x00\x00zKg\x977iW\xc0\xc7\xceU\x9f\x1d\xc6D@'),,POLK,1031100.0,AMERICAN VODKAS,300,MCCORMICK DISTILLING CO.,36904,MCCORMICK 80PRF VODKA PET,24,375,1.84,2.76,-24,-66.24,-9.0,-2.37
RINV-04674100037,2023-06-06,10200,"MUGHAL, INC. / WATERLOO",735 LOGAN AVE.,WATERLOO,50703.0,bytearray(b'\x01\x01\x00\x00\x00\xe0D$\xa5\xa1\x15W\xc0XP\xdd\x9eXAE@'),,BLACK HA
Query:
SELECT COUNT(DISTINCT DATE_TRUNC('month', "date")) AS "number_of_months"
FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
WHERE "date" IS NOT NULL
Answer:
number_of_months
153
Query:
SELECT "city", SUM("volume_sold_liters") AS "total_volume_liters"
FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
WHERE "city" IS NOT NULL AND "volume_sold_liters" IS NOT NULL
GROUP BY "city"
ORDER BY "total_volume_liters" DESC
LIMIT 10
Answer:
city,total_volume_liters
DES MOINES,29962025.429999992
CEDAR RAPIDS,17998113.39
DAVENPORT,13386684.89
WEST DES MOINES,9991748.07
COUNCIL BLUFFS,8954213.540000001
WATERLOO,8870782.739999996
SIOUX CITY,8811817.32
IOWA CITY,8569564.110000001
DUBUQUE,7396188.73
AMES,7371778.889999998
Query:
SELECT DISTINCT "category_name"
FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
WHERE "category_name" IS NOT NULL AND "category_name" ILIKE '%WHISK%'
LIMIT 100
Answer:
category_name
IMPORTED WHISKIES
TENNESSEE WHISKIES
IRISH WHISKIES
SCOTCH WHISKIES
SINGLE BARREL BOURBON WHISKIES
IOWA DISTILLERY WHISKIES
BLENDED WHISKIES
WHISKEY LIQUEUR
JAPANESE WHISKY
CORN WHISKIES
AMERICAN WHISKIES
CANADIAN WHISKIES
STRAIGHT BOURBON WHISKIES
STRAIGHT RYE WHISKIES
End Exploring Related Columns
Task: Which two liquor categories, each contributing an average of at least 1% to monthly sales volume over 24 months, have the lowest Pearson correlation coefficient in their sales percentages?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To determine the two liquor categories that each contribute an average of at least 1% to monthly sales volume over 24 months and have the lowest Pearson correlation coefficient in their sales percentages, we need to analyze the sales data over that period.

Since the specific data is not provided, I can't compute the exact categories or correlation coefficient. However, the expected output format is:

```csv
Category1,Category2,Pearson_Correlation_Coefficient
category_name1:str,category_name2:str,coefficient_value:float
(Attention: answer in one row)
```

**Explanation:**

- **Category1** and **Category2**: The names of the two liquor categories that meet the criteria.
- **Pearson_Correlation_Coefficient**: The calculated correlation coefficient between their monthly sales percentages over the 24 months.

To complete this task, you would need to follow these steps:

1. **Calculate Monthly Sales Volume per Category:**
   - Aggregate the sales volume (`volume_sold_liters` or `sale_dollars`) for each category for each month over the 24-month period.
2. **Determine Categories Contributing at Least 1%:**
   - Calculate the total sales volume for each month.
   - Compute the average monthly contribution percentage of each category over the 24 months.
   - Identify categories with an average contribution of at least 1%.
3. **Compute Monthly Sales Percentages:**
   - For the selected categories, calculate their sales percentage of the total sales for each month.
4. **Calculate Pearson Correlation Coefficients:**
   - For each pair of categories identified in step 2, calculate the Pearson correlation coefficient of their monthly sales percentages over the 24 months.
5. **Identify the Lowest Correlation Pair:**
   - Compare the correlation coefficients to find the pair with the lowest value.

By following these steps with your dataset, you can fill in the output format with the specific category names and the correlation coefficient value..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'IOWA_LIQUOR_SALES': {'IOWA_LIQUOR_SALES': ['SALES']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-24 02:16:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 02:16:32 - root - INFO - ```sql
WITH last_24_months AS (
    SELECT 
        DATE_TRUNC('month', "date") AS "sale_month",
        "category_name",
        SUM("volume_sold_liters") AS "monthly_volume_liters"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= DATEADD(month, -24, (SELECT MAX("date") FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"))
    GROUP BY DATE_TRUNC('month', "date"), "category_name"
),
monthly_totals AS (
    SELECT 
        "sale_month",
        SUM("monthly_volume_liters") AS "total_monthly_volume"
    FROM last_24_months
    GROUP BY "sale_month"
),
category_percentages AS (
    SELECT 
        l24."sale_month",
        l24."category_name",
        (l24."monthly_volume_liters" / mt."total_monthly_volume") * 100 AS "percentage_contribution"
    FROM last_24_months l24
    JOIN monthly_totals mt ON l24."sale_month" = mt."sale_month"
),
category_average_percentages AS (
    SELECT
        "category_name",
        AVG("percentage_contribution") AS "average_percentage"
    FROM category_percentages
    GROUP BY "category_name"
    HAVING AVG("percentage_contribution") >= 1
),
filtered_category_percentages AS (
    SELECT
        cp."sale_month",
        cp."category_name",
        cp."percentage_contribution"
    FROM category_percentages cp
    INNER JOIN category_average_percentages cap ON cp."category_name" = cap."category_name"
),
corr_pairs AS (
    SELECT 
        t1."category_name" AS "category1",
        t2."category_name" AS "category2",
        CORR(t1."percentage_contribution", t2."percentage_contribution") AS "correlation_coefficient"
    FROM filtered_category_percentages t1
    JOIN filtered_category_percentages t2 ON t1."sale_month" = t2."sale_month" AND t1."category_name" < t2."category_name"
    GROUP BY t1."category_name", t2."category_name"
),
lowest_correlation AS (
    SELECT 
        "category1",
        "category2",
        "correlation_coefficient"
    FROM corr_pairs
    ORDER BY "correlation_coefficient" ASC
    LIMIT 1
)
SELECT * FROM lowest_correlation;
```
2025-01-24 02:16:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 02:16:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 02:16:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 02:16:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 02:16:33 - snowflake.connector.connection - INFO - closed
2025-01-24 02:16:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 02:16:34 - root - INFO - itercount: 1
2025-01-24 02:16:34 - root - INFO - 0
2025-01-24 02:16:34 - root - INFO - results: 
category1,category2,correlation_coefficient
AMERICAN FLAVORED VODKA,CREAM LIQUEURS,-0.7415375744964772


2025-01-24 02:16:34 - root - INFO - Please check the answer again by reviewing Which two liquor categories, each contributing an average of at least 1% to monthly sales volume over 24 months, have the lowest Pearson correlation coefficient in their sales percentages?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To determine the two liquor categories that each contribute an average of at least 1% to monthly sales volume over 24 months and have the lowest Pearson correlation coefficient in their sales percentages, we need to analyze the sales data over that period.

Since the specific data is not provided, I can't compute the exact categories or correlation coefficient. However, the expected output format is:

```csv
Category1,Category2,Pearson_Correlation_Coefficient
category_name1:str,category_name2:str,coefficient_value:float
(Attention: answer in one row)
```

**Explanation:**

- **Category1** and **Category2**: The names of the two liquor categories that meet the criteria.
- **Pearson_Correlation_Coefficient**: The calculated correlation coefficient between their monthly sales percentages over the 24 months.

To complete this task, you would need to follow these steps:

1. **Calculate Monthly Sales Volume per Category:**
   - Aggregate the sales volume (`volume_sold_liters` or `sale_dollars`) for each category for each month over the 24-month period.
2. **Determine Categories Contributing at Least 1%:**
   - Calculate the total sales volume for each month.
   - Compute the average monthly contribution percentage of each category over the 24 months.
   - Identify categories with an average contribution of at least 1%.
3. **Compute Monthly Sales Percentages:**
   - For the selected categories, calculate their sales percentage of the total sales for each month.
4. **Calculate Pearson Correlation Coefficients:**
   - For each pair of categories identified in step 2, calculate the Pearson correlation coefficient of their monthly sales percentages over the 24 months.
5. **Identify the Lowest Correlation Pair:**
   - Compare the correlation coefficients to find the pair with the lowest value.

By following these steps with your dataset, you can fill in the output format with the specific category names and the correlation coefficient value. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
category1,category2,correlation_coefficient
AMERICAN FLAVORED VODKA,CREAM LIQUEURS,-0.7415375744964772
Current sql:
WITH last_24_months AS (
    SELECT 
        DATE_TRUNC('month', "date") AS "sale_month",
        "category_name",
        SUM("volume_sold_liters") AS "monthly_volume_liters"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= DATEADD(month, -24, (SELECT MAX("date") FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"))
    GROUP BY DATE_TRUNC('month', "date"), "category_name"
),
monthly_totals AS (
    SELECT 
        "sale_month",
        SUM("monthly_volume_liters") AS "total_monthly_volume"
    FROM last_24_months
    GROUP BY "sale_month"
),
category_percentages AS (
    SELECT 
        l24."sale_month",
        l24."category_name",
        (l24."monthly_volume_liters" / mt."total_monthly_volume") * 100 AS "percentage_contribution"
    FROM last_24_months l24
    JOIN monthly_totals mt ON l24."sale_month" = mt."sale_month"
),
category_average_percentages AS (
    SELECT
        "category_name",
        AVG("percentage_contribution") AS "average_percentage"
    FROM category_percentages
    GROUP BY "category_name"
    HAVING AVG("percentage_contribution") >= 1
),
filtered_category_percentages AS (
    SELECT
        cp."sale_month",
        cp."category_name",
        cp."percentage_contribution"
    FROM category_percentages cp
    INNER JOIN category_average_percentages cap ON cp."category_name" = cap."category_name"
),
corr_pairs AS (
    SELECT 
        t1."category_name" AS "category1",
        t2."category_name" AS "category2",
        CORR(t1."percentage_contribution", t2."percentage_contribution") AS "correlation_coefficient"
    FROM filtered_category_percentages t1
    JOIN filtered_category_percentages t2 ON t1."sale_month" = t2."sale_month" AND t1."category_name" < t2."category_name"
    GROUP BY t1."category_name", t2."category_name"
),
lowest_correlation AS (
    SELECT 
        "category1",
        "category2",
        "correlation_coefficient"
    FROM corr_pairs
    ORDER BY "correlation_coefficient" ASC
    LIMIT 1
)
SELECT * FROM lowest_correlation;
2025-01-24 02:17:24 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 02:17:24 - root - INFO - ```sql
WITH last_24_months AS (
    SELECT 
        DATE_TRUNC('month', "date") AS "sale_month",
        "category_name",
        SUM("volume_sold_liters") AS "monthly_volume_liters"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= DATEADD(month, -24, (SELECT MAX("date") FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"))
    GROUP BY DATE_TRUNC('month', "date"), "category_name"
),
monthly_totals AS (
    SELECT 
        "sale_month",
        SUM("monthly_volume_liters") AS "total_monthly_volume"
    FROM last_24_months
    GROUP BY "sale_month"
),
category_percentages AS (
    SELECT 
        l24."sale_month",
        l24."category_name",
        (l24."monthly_volume_liters" / mt."total_monthly_volume") * 100 AS "percentage_contribution"
    FROM last_24_months l24
    JOIN monthly_totals mt ON l24."sale_month" = mt."sale_month"
),
category_average_percentages AS (
    SELECT
        "category_name",
        AVG("percentage_contribution") AS "average_percentage"
    FROM category_percentages
    GROUP BY "category_name"
    HAVING AVG("percentage_contribution") >= 1
),
filtered_category_percentages AS (
    SELECT
        cp."sale_month",
        cp."category_name",
        cp."percentage_contribution"
    FROM category_percentages cp
    INNER JOIN category_average_percentages cap ON cp."category_name" = cap."category_name"
),
corr_pairs AS (
    SELECT 
        t1."category_name" AS "category1",
        t2."category_name" AS "category2",
        CORR(t1."percentage_contribution", t2."percentage_contribution") AS "correlation_coefficient"
    FROM filtered_category_percentages t1
    JOIN filtered_category_percentages t2 ON t1."sale_month" = t2."sale_month" AND t1."category_name" < t2."category_name"
    GROUP BY t1."category_name", t2."category_name"
),
lowest_correlation AS (
    SELECT 
        "category1",
        "category2",
        ROUND("correlation_coefficient", 4) AS "correlation_coefficient"
    FROM corr_pairs
    ORDER BY "correlation_coefficient" ASC
    LIMIT 1
)
SELECT * FROM lowest_correlation;
```
2025-01-24 02:17:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 02:17:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 02:17:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 02:17:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 02:17:26 - snowflake.connector.connection - INFO - closed
2025-01-24 02:17:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 02:17:26 - root - INFO - itercount: 2
2025-01-24 02:17:26 - root - INFO - 0
2025-01-24 02:17:27 - root - INFO - Total iteration counts: 2
