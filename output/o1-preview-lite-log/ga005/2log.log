2025-01-29 20:43:43 - openai._base_client - INFO - Retrying request to /chat/completions in 0.494237 seconds
2025-01-29 20:44:07 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-29 20:44:09 - root - INFO - SQL:
SELECT DISTINCT `event_name`
FROM `firebase-public-project.analytics_153293282.events_20180709`
LIMIT 100;
Results:
event_name
os_update
screen_view
user_engagement
post_score
level_up
level_end
level_retry
level_start
level_complete
completed_5_levels
session_start
use_extra_steps
spend_virtual_currency
level_complete_quickplay
level_fail_quickplay
level_end_quickplay
level_start_quickplay
level_reset_quickplay
select_content
level_retry_quickplay
level_fail
no_more_extra_steps
ad_reward
level_reset
app_remove
app_exception
challenge_a_friend
firebase_campaign
error
app_update
first_open

2025-01-29 20:44:11 - root - INFO - SQL:
SELECT `event_name`, `event_timestamp`, `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_20180709`
WHERE `event_name` = 'session_start'
LIMIT 100;
Results:
event_name,event_timestamp,user_pseudo_id
session_start,1531157451210001,6E018CE86D4601A362A9154B2500348A
session_start,1531137357029000,23183C7A7E31451194345099C978F49E
session_start,1531167062916000,3B7AC9CAE2D7BB661BE66F3DE36DD005
session_start,1531163950703000,9D535D543FD07B8247DEADB4669FADE6
session_start,1531191769500000,9D535D543FD07B8247DEADB4669FADE6
session_start,1531176853965000,22DC6A6AE86C0AA33EBB8C3164A26925
session_start,1531180078828000,22DC6A6AE86C0AA33EBB8C3164A26925
session_start,1531146954008000,EF9E8CCCCBBB015CAE0C334AB1745417
session_start,1531178671964000,85FD06F19EBB6097388EEE0B207598B7
session_start,1531160215257001,9603F4B5ABFC1E48B0BF68C83669F845
session_start,1531132347638000,5217AB1A454DAED6243E1C9818BE6A20
session_start,1531134615535000,5217AB1A454DAED6243E1C9818BE6A20
session_start,1531161831808000,5217AB1A454DAED6243E1C9818BE6A20
session_start,1531179220064000,5217AB1A454DAED6243E1C9818BE6A20
session_start,1531184420010000,5217AB1A454DAED6243E1C9818BE6A20
session_start,1531174304324000,5256B2B115955E80DDB7449775D92325
session_start,1531172011087000,E0F91AA200D6F12DBE53B0D166AFD87B
session_start,1531176104215000,2F0F260BD7B876C346B41977D0D03D62
session_start,1531187925556000,2F0F260BD7B876C346B41977D0D03D62
session_start,1531187191553000,DB9F0F2561524A9EE1436805AAD70675
session_start,1531167691788000,E2B530ADD7430BEA6BC7F3D431C8A6FF
session_start,1531152140334000,71746D859E4E6D655FEE8FFBC3B6C7E9
session_start,1531200641990000,F26EC6056E284FDDEA7771F203B6BB8F
session_start,1531203639643000,F26EC6056E284FDDEA7771F203B6BB8F
session_start,1531197742205000,945DE7C965AFB12E35C3C992CF9847E2
session_start,1531154960311000,980DEC5BA17132A841D7D7A140333114
session_start,1531133833748000,0160043392B1572A375E5C3BE1BB0C31
session_start,1531147125094000,0373DF7959F6867CDFB1C905D39CE67C
session_start,1531193031386000,C6B7ED4E2FA4AABE5693A61B9A07753C
session_start,1531124847080000,C136A7CE1D0A52B8D4E5F144DF114EB7
session_start,1531141606959000,77F5E9A5630151C9E831156AEAB4DA11
session_start,1531134431573000,49309C5759610DBF6C829C0D4AB23943
session_start,1531148119063000,5F824D23AE3CF750894A96098818E789
session_start,1531125138282000,9F3EAF490630617EF2CB47A8BD2CBBCC
session_start,1531128994328000,9F3EAF490630617EF2CB47A8BD2CBBCC
session_start,1531148472001000,9F3EAF490630617EF2CB47A8BD2CBBCC
session_start,1531159360850000,9F3EAF490630617EF2CB47A8BD2CBBCC
session_start,1531172269047000,9F3EAF490630617EF2CB47A8BD2CBBCC
session_start,1531195034458000,9F3EAF490630617EF2CB47A8BD2CBBCC
session_start,1531138158501000,5C5A0787542CD24F1E19F9EB778BA766
session_start,1531171480376000,4BF98D09CA8359FC59ADAF56D00338F8

2025-01-29 20:44:12 - root - INFO - SQL:
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_20180709`
WHERE `event_name` = 'session_start'
LIMIT 100;
Results:
user_pseudo_id
6E018CE86D4601A362A9154B2500348A
23183C7A7E31451194345099C978F49E
3B7AC9CAE2D7BB661BE66F3DE36DD005
9D535D543FD07B8247DEADB4669FADE6
22DC6A6AE86C0AA33EBB8C3164A26925
EF9E8CCCCBBB015CAE0C334AB1745417
85FD06F19EBB6097388EEE0B207598B7
9603F4B5ABFC1E48B0BF68C83669F845
5217AB1A454DAED6243E1C9818BE6A20
5256B2B115955E80DDB7449775D92325
E0F91AA200D6F12DBE53B0D166AFD87B
2F0F260BD7B876C346B41977D0D03D62
DB9F0F2561524A9EE1436805AAD70675
E2B530ADD7430BEA6BC7F3D431C8A6FF
71746D859E4E6D655FEE8FFBC3B6C7E9
F26EC6056E284FDDEA7771F203B6BB8F
945DE7C965AFB12E35C3C992CF9847E2
980DEC5BA17132A841D7D7A140333114
0160043392B1572A375E5C3BE1BB0C31
0373DF7959F6867CDFB1C905D39CE67C
C6B7ED4E2FA4AABE5693A61B9A07753C
C136A7CE1D0A52B8D4E5F144DF114EB7
77F5E9A5630151C9E831156AEAB4DA11
49309C5759610DBF6C829C0D4AB23943
5F824D23AE3CF750894A96098818E789
9F3EAF490630617EF2CB47A8BD2CBBCC
5C5A0787542CD24F1E19F9EB778BA766
4BF98D09CA8359FC59ADAF56D00338F8
60603343AB8FEECD78B1009C957D193D
23A7E8D987ADCC38EB026096DC513F85
D7D49CC32C4A23AD56E8DEAE6878EC7B
B4394AD77C6DE7A5C7385C307F35F84F
3827BA312204EA6F6847DFA4222C90CC
4500595CA1FC3CBC6140A502240FB7B4
1F25763EC8BCAEC7FB069E81659A2153
706C748E6D1E0768BFEFE6362B5D3F67
F815B0069F973BFA743EF90A85224109
D0F280B12652EB0D74F6BC74AB13606F
4D084D38156128AAA060303AA91E689D
05F7B2C58D627CE948B06C10E39CDF91
3EF8FC940E379D53BBD3FEFDAF626BB2
E6FEE8B98E75EA5311FE004F98559A27
48AB910A8DE8485D4C34238EA61F782C
0E05F56141200FF41FCC0C7FA297FF08
AB32482D193E2CE166B59F82EF78D8BB
2F5B044B41268F6643EB4D0EF15D4E87
8E6F7A428C907165D78A2377ABEB7315
7566596A1D6ACA781692A7A0B89B06EF
A29EBFE2A58D7C4D6FDA23C3A53742FF
EF9C32CA65880162136061B25D24E05E
B56E67847E1AE8D6411A5ECCA26585CA
295D9E24D8DE65A010313E667131EF19
88A41BFED275BB69125BE1F5524F3B42
29845B6298FB882DF53607D21F0E1DF7
7F2B633C86B765201C93FDB6FF261143
60ACC539CFC3DB94C60921D5572C3A4D
4BDC831A6940071E2461D0B5293A329E
8D31836A6C3C14CE71056BED8925F0A4
D5F9D9AF22EF5073E10342973D48FB2C
17515C32D8E535AA8A1B18BA774BB90C
B275DC380CF75B352381D5419E397047
1B2FC37816CC4DDAACA97A75E685756F
6B9CFFB3E0DE6FA0C47B8410C4467F89
037DAC225F0C1E54657770CD201CDDA7
7537C0AA6291AC7B99DC4D2D695EEF1D
9038CCC5F7D7ABDA6E296D18FFDD1AAA
59BE43F3FE7AB3F91B016B56508D4C46
FFFE80A7B9667187D501CE6037876955
A65FAEAB5577A16B517735A9D9C54958
FEC117631F54C2699CB76603EBB98CF0
38DEEAB5F723A89A66CF180A175808D5
C795AFA7F574C2BB09D3647AD90A9719
84F5D9204EDAE98B3B542AEA93F40BED
FEDC59699D8832A11B88BFCCCAD0951D
D7EA8E3645EFFBD6443946179ED704A6
59454BAC415BB1F18517C6FD2C023E49
017CF202552235BBA4338E0D82A53F43
F19B8122771D0514F440E914B722656A
B75F91EB6C7FDA9A329567E763CF9E44
8EDB9A9856CDB5AFC42546106EE46734
8BE7BF90C971453A34C1FF6FF2A0ACAE
EBFE0623EF1109A89B392B9DF4375951
0B99B2EC1247C09535717331F816D42D
CA04708DA02378999ECB402481FF1AE4
E4196C5E0A92A22F69DE4E3AA288D6EE
2F5BBABE9DD0271DCD62E501F76DA736
10522BF919A454B898540F51FFDCB292
6D4F9673F3DADCB39EE913EFCA2AE282
359B5B95C8B1DF723D939A5A8AFF0904
D3F06F9B7BD9D7FC8758BF78BF0705E9
8040FC9C0479C3B9A74ED298DD8F357D
D299D5763E03F1CC4DA8550AF1B4CEE4
1F732B8A151B6C6249323BC65CA9C1F9

2025-01-29 20:44:14 - root - INFO - SQL:
SELECT `event_date`, `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_20180710`
WHERE `event_name` = 'session_start'
LIMIT 100;
Results:
event_date,user_pseudo_id
20180710,9D535D543FD07B8247DEADB4669FADE6
20180710,295D9E24D8DE65A010313E667131EF19
20180710,5217AB1A454DAED6243E1C9818BE6A20
20180710,5217AB1A454DAED6243E1C9818BE6A20
20180710,5217AB1A454DAED6243E1C9818BE6A20
20180710,5256B2B115955E80DDB7449775D92325
20180710,5256B2B115955E80DDB7449775D92325
20180710,0FF2FC480E70693841DCBFBB240F2E24
20180710,27A7A10FDC637E7E93B1EAB037530293
20180710,E2B530ADD7430BEA6BC7F3D431C8A6FF
20180710,F26EC6056E284FDDEA7771F203B6BB8F
20180710,224C6AE85D60A605AC6164FA86738DF6
20180710,59483477E9365F4C9A834CD88B37BA41
20180710,0373DF7959F6867CDFB1C905D39CE67C
20180710,0373DF7959F6867CDFB1C905D39CE67C
20180710,5D5895B1267014C54ECBE08864420979
20180710,094CDCB8EF23B9B55134A0B5E22DFFCB
20180710,49309C5759610DBF6C829C0D4AB23943
20180710,49309C5759610DBF6C829C0D4AB23943
20180710,9F3EAF490630617EF2CB47A8BD2CBBCC
20180710,9F3EAF490630617EF2CB47A8BD2CBBCC
20180710,9DE7361ACCDEA6541AD5EA55D59B1C78
20180710,9DE7361ACCDEA6541AD5EA55D59B1C78
20180710,60603343AB8FEECD78B1009C957D193D
20180710,48D0C822ACA6BD0B5FBA8ECD27CBB247
20180710,D7D49CC32C4A23AD56E8DEAE6878EC7B
20180710,FB9AD160115DC0E6F045BB654344287B
20180710,7E40E634997585B0C69B6F67C01C191B
20180710,1F25763EC8BCAEC7FB069E81659A2153
20180710,706C748E6D1E0768BFEFE6362B5D3F67
20180710,F815B0069F973BFA743EF90A85224109
20180710,D0F280B12652EB0D74F6BC74AB13606F
20180710,0AF862AFEB5358EBFDA7AFE3AC908844
20180710,0AF862AFEB5358EBFDA7AFE3AC908844
20180710,4D084D38156128AAA060303AA91E689D
20180710,4D084D38156128AAA060303AA91E689D
20180710,68149A4353C4E6C2AF49CF5F35FBB78C
20180710,3EF8FC940E379D53BBD3FEFDAF626BB2
20180710,3EF8FC940E379D53BBD3FEFDAF626BB2
20180710,3EF8FC940E379D53BBD3FEFDAF626BB2
20180710,2DB65B29C41328FF8AB9AC27B7C05537
20180710,2DB65B29C41328FF8AB9AC27B7C05537
20180710,E6FEE8B98E75EA5311FE004F98559A27
20180710,48AB910A8DE8485D4C34238EA61F782C
20180710,48AB910A8DE8485D4C34238EA61F782C
20180710,48AB910A8DE8485D4C34238EA61F782C
20180710,48AB910A8DE8485D4C34238EA61F782C
20180710,1CF315BC6864E7A71A81E47925E18A61
20180710,FA30269453141794E79B8F15EE0BA5B9
20180710,FA30269453141794E79B8F15EE0BA5B9
20180710,FA30269453141794E79B8F15EE0BA5B9
20180710,0E05F56141200FF41FCC0C7FA297FF08
20180710,0E05F56141200FF41FCC0C7FA297FF08
20180710,81D3DD49AA2304FD1ED8C498747B5FC6
20180710,F9E81248456FBD71D00697C06259396E
20180710,40B501E0460E254E289A776CFC31DCF2
20180710,40B501E0460E254E289A776CFC31DCF2
20180710,40B501E0460E254E289A776CFC31DCF2
20180710,40B501E0460E254E289A776CFC31DCF2
20180710,26E86A2E3E01E89467AE434BBF204817
20180710,AB32482D193E2CE166B59F82EF78D8BB
20180710,41CA0FA528C7227EA1E592DCC4733C40
20180710,2F5B044B41268F6643EB4D0EF15D4E87

2025-01-29 20:44:16 - root - INFO - SQL:
SELECT `user_pseudo_id`, `user_first_touch_timestamp`
FROM `firebase-public-project.analytics_153293282.events_20180710`
WHERE TIMESTAMP_MICROS(`user_first_touch_timestamp`) >= TIMESTAMP('2018-07-09')
LIMIT 100;
Results:
user_pseudo_id,user_first_touch_timestamp
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000

2025-01-29 20:44:17 - root - INFO - SQL:
SELECT `user_pseudo_id`, COUNT(*) as session_count
FROM `firebase-public-project.analytics_153293282.events_20180711`
WHERE `event_name` = 'session_start'
GROUP BY `user_pseudo_id`
LIMIT 100;
Results:
user_pseudo_id,session_count
56F37FD95FB21AB3976C83E803D7AEA7,1
40BA3CE848E99626DACC46BCCEE3E568,1
C2D9D55F57CC8CFF60599E1928594368,1
A8D7DCCA39D8703F2928AD2D7BBB6BE9,1
062964F7169622E4AEC91756FFB8261B,1
2684EA4DDB1F988E3C979AB15CFF601F,1
CB06B751DAD44BB7F228F8474686D404,2
5358D124C06358BCD5FEF67C87052AC2,1
2B0D8BD127A58843F3B4F8C8FE50CD77,1
5C813D5127BF4EC2AAB2B93A6406E223,1
E4C074EBC3729FB45CFA48D9F6EA4DFD,1
7410C5CC4FA11D31DB5F9B1D8ECD6BD0,1
2B5437C3C5064C97EA9DD2A8FCD99571,1
3FC8ECFC8F2976C5B56D0D782F36BD7F,2
50B9480303280C2408C4C77A8AFA9480,1
370CDFEE49990E4A9A1FBC0DC5C31C1C,1
D9AA0EC27AF47514DDB5C664A6EF758A,1
DA48D36D07835B1918BDF831AF83B5EF,2
EFB696A82D093B3AFBE92FF526DD5CEA,4
5E624075FDFE3003C34E1138546B2450,1
4B685109746904E9090CB41DE88508FD,1
898B790ACC7834117A9B2C98A8B6F1F5,2
225638B28A80341EEB04F1DFC144F30E,1
AFFBFB5A561C0DEA5ACAA4D33BC483A5,1
289F2AE59FE48FFF6DD12D0AB553C14E,1
86942BEBB6333C69BD5EADC72AC04A3E,1
E4C6FF8288DD4BFCDE93E2218E20643B,1
B1D1ED35873581A23E48C4CD03DDFF81,1
AFA6BA99FB329CB459E8E57FDE1DF9AE,1
7532B9EE7B6F844FF4ECB5DD8A864551,1
946428DDC28C630D510D763B6A925171,1
BB679B94B0DB34FAF2C2B541A6143F93,1
60432093BCE28FA117B03C2CA82C1E7A,1
F1555004E0D95599AF2F2B8EA130A9C3,1
9043DDF80C097DA753756B660DF78768,1
372D9BB5088C4E9000C65B06459B403A,4
263C111D407C5E17AC6310581C3B9255,1
0B427C5E490A982FADF586F82E797ACB,1
93CD991A5D10398F5534E4C196C59972,2
56AB5AA26CE53AB27D81C65372B450F5,1
1C9DAE1F278190CEEEEB70A8F4B28FE5,1
CA51DAF1373B5C2A16C174AFBD2132A4,1
7ED8C235689771F6B0F29BBF295A346F,1
13E6C8A193FF140F7D4222B569DD5B50,3
07DB546A94677E3F3203A8C30B9A4F11,1
686CB936AA9E0A81C377FC2604862AD2,1
D0969C741DF2022FBA9602C04823A358,1
F095A7DDC32D556FE7DFB25469062D5A,1
84E491A60BE52A4C6A438A89FADE283C,1
13798F47A0DF4CB2AC980AEC8C733DC3,1
96161BF2E55C7E32ED5F411432875ECB,1
297D261C85AC0E9A01BA1D0F9DD8A9B7,1
FDA4BBBCF1EA2D95CDD77BFC5F00A837,1
25FFAED0980E76F9D5541692299B1B81,1
8065F8E98407106A65D35195984B2258,1
077277C88E7D330761F5272DB2EEE43A,1
7D7B319DFFF03520EF50236B2C3FB008,1
7944286F80A3955AF83CAB9F7C88866D,1
E643F6549E6C7EA0FD01EF4BF7A40F76,1
77D5FF20DF909CDD790ED52FC94AF7BD,1
396CD60DADAB9CBA7DDCAF239B477135,4
880639B108797EEC419D56E8548D0BF2,1
29BF140A43CB250B891EE34D5CEB39E4,1
EF500E0CF578004836D1D38C8901862B,8
76690E22DDCE2B1FFA98C6A4376B8EA2,2
33E5EA9FE1E29AC3127D975A5494213D,1
328DC7FE55E8881B2EA668C9A2855BB7,3
C9ADDD0F70E255FD7105712C43C3A45F,1

2025-01-29 20:44:19 - root - INFO - SQL:
SELECT `user_pseudo_id`, ep.key, ep.value.string_value
FROM `firebase-public-project.analytics_153293282.events_20180712`,
    UNNEST(`event_params`) as ep
WHERE `event_name` = 'session_start'
LIMIT 100;
Results:
user_pseudo_id,key,string_value
5E9B9E20975EF45745B511D401456619,firebase_conversion,
5E9B9E20975EF45745B511D401456619,firebase_screen_class,main_menu
5E9B9E20975EF45745B511D401456619,firebase_event_origin,auto
5E9B9E20975EF45745B511D401456619,firebase_screen_id,
5E9B9E20975EF45745B511D401456619,firebase_conversion,
5E9B9E20975EF45745B511D401456619,firebase_screen_class,game_board
5E9B9E20975EF45745B511D401456619,firebase_event_origin,auto
5E9B9E20975EF45745B511D401456619,firebase_screen_id,
D7D49CC32C4A23AD56E8DEAE6878EC7B,firebase_conversion,
D7D49CC32C4A23AD56E8DEAE6878EC7B,firebase_screen_class,game_board
D7D49CC32C4A23AD56E8DEAE6878EC7B,firebase_event_origin,auto
D7D49CC32C4A23AD56E8DEAE6878EC7B,firebase_screen_id,
D7D49CC32C4A23AD56E8DEAE6878EC7B,firebase_conversion,
D7D49CC32C4A23AD56E8DEAE6878EC7B,firebase_screen_class,game_board
D7D49CC32C4A23AD56E8DEAE6878EC7B,firebase_event_origin,auto
D7D49CC32C4A23AD56E8DEAE6878EC7B,firebase_screen_id,
4EA4BB597E4AFD7B452F7C8669B5AC13,firebase_conversion,
4EA4BB597E4AFD7B452F7C8669B5AC13,firebase_screen_class,game_board
4EA4BB597E4AFD7B452F7C8669B5AC13,firebase_event_origin,auto
4EA4BB597E4AFD7B452F7C8669B5AC13,firebase_screen_id,
23183C7A7E31451194345099C978F49E,firebase_conversion,
23183C7A7E31451194345099C978F49E,firebase_screen_class,main_menu
23183C7A7E31451194345099C978F49E,firebase_event_origin,auto
23183C7A7E31451194345099C978F49E,firebase_screen_id,
23183C7A7E31451194345099C978F49E,firebase_conversion,
23183C7A7E31451194345099C978F49E,firebase_screen_class,game_board
23183C7A7E31451194345099C978F49E,firebase_event_origin,auto
23183C7A7E31451194345099C978F49E,firebase_screen_id,
EB681942FA18C6BF1AF2AC7ABA74D491,firebase_conversion,
EB681942FA18C6BF1AF2AC7ABA74D491,firebase_screen_class,game_board
EB681942FA18C6BF1AF2AC7ABA74D491,firebase_event_origin,auto
EB681942FA18C6BF1AF2AC7ABA74D491,firebase_screen_id,
53649082C25AB9A9CD1E394EBBA9CEF3,firebase_conversion,
53649082C25AB9A9CD1E394EBBA9CEF3,firebase_screen_class,game_board
53649082C25AB9A9CD1E394EBBA9CEF3,firebase_event_origin,auto
53649082C25AB9A9CD1E394EBBA9CEF3,firebase_screen_id,
53649082C25AB9A9CD1E394EBBA9CEF3,firebase_conversion,
53649082C25AB9A9CD1E394EBBA9CEF3,firebase_screen_class,level_select
53649082C25AB9A9CD1E394EBBA9CEF3,firebase_event_origin,auto
53649082C25AB9A9CD1E394EBBA9CEF3,firebase_screen_id,
08F14F3BCA030F81B447161BA8653B44,firebase_conversion,
08F14F3BCA030F81B447161BA8653B44,firebase_screen_class,game_board
08F14F3BCA030F81B447161BA8653B44,firebase_event_origin,auto
08F14F3BCA030F81B447161BA8653B44,firebase_screen_id,
3827BA312204EA6F6847DFA4222C90CC,firebase_conversion,
3827BA312204EA6F6847DFA4222C90CC,firebase_screen_class,game_board

2025-01-29 20:44:20 - root - INFO - SQL:
SELECT DISTINCT `user_pseudo_id`, `platform`
FROM `firebase-public-project.analytics_153293282.events_20180713`
WHERE `event_name` = 'session_start'
LIMIT 100;
Results:
user_pseudo_id,platform
9E635066BDD2E61E59252D382E0D2C61,ANDROID
23183C7A7E31451194345099C978F49E,ANDROID
3376C102EBF491B5CB84B43759FE3433,ANDROID
B29581947ADA95875735E29B397275CE,ANDROID
9D535D543FD07B8247DEADB4669FADE6,ANDROID
FB6DF2FE493D87177B8A640D71AE45DD,ANDROID
11351D26EFC914BDB62006215A68D1D4,ANDROID
295D9E24D8DE65A010313E667131EF19,ANDROID
5217AB1A454DAED6243E1C9818BE6A20,ANDROID
5256B2B115955E80DDB7449775D92325,ANDROID
D1F53693AA457A127407EBA024A07EE4,ANDROID
73980AF5B8954128337EB065CE75C773,ANDROID
CCF21A11C5F30A2F7787A0DD822F9126,ANDROID
026E9E99CF63F4AD31203F6B2E01949D,ANDROID
0160043392B1572A375E5C3BE1BB0C31,ANDROID
0373DF7959F6867CDFB1C905D39CE67C,ANDROID
77F5E9A5630151C9E831156AEAB4DA11,ANDROID
27954A1D70BCD7F326F926A5D5B666E6,ANDROID
82D556A8003F97B39A2D2E8E5520F9B6,ANDROID
52332E7857233EC06090B1059F0C6292,ANDROID
4BF98D09CA8359FC59ADAF56D00338F8,ANDROID
95E26DC518A7793A7E7C9D40BE914111,ANDROID
05407E04B9FA64CB63D8FA1D966AD6A2,ANDROID
DAC3C60A9BB7734F83F0C7478185AC4C,ANDROID
ACB0CC9AC2138D424084DC1D8C18F077,ANDROID
706C748E6D1E0768BFEFE6362B5D3F67,ANDROID
F815B0069F973BFA743EF90A85224109,ANDROID
D0F280B12652EB0D74F6BC74AB13606F,ANDROID
495466C2475D9A12548D8CEE1515A0A7,ANDROID
48AB910A8DE8485D4C34238EA61F782C,ANDROID
FA30269453141794E79B8F15EE0BA5B9,ANDROID
0E05F56141200FF41FCC0C7FA297FF08,ANDROID
75C683C1AE98FC6CCE6EA156C9E90A35,ANDROID
7ED4165854463C38F1D739A2014001D9,ANDROID
41CA0FA528C7227EA1E592DCC4733C40,ANDROID
DCEFBF52331910FC267F07111AD868F9,ANDROID
7566596A1D6ACA781692A7A0B89B06EF,ANDROID
CF06C47EAD622F909BFCC83FF4D0ECE8,ANDROID
23FB24C9178CBD3DEEB8BA90BA95FF02,ANDROID
F36044676636D14F86FD083DDD910E04,ANDROID
93E117D728FA61CDD42AE547CD74E89E,ANDROID
9D956C83A0AD889DDFCA96A7589A40AD,ANDROID
5145D8121071A9EA903A1098034962F6,ANDROID
C3295C36C51EAF010079266FB55EF2DD,ANDROID
F94E005EB49AFB8DA0A78030D4ABB44B,ANDROID
A8E58A0B45F20FF957312FA929CBD83F,ANDROID
757F371D73A59AA7B6FB5CF1E6483B33,ANDROID
D5F9D9AF22EF5073E10342973D48FB2C,ANDROID
17515C32D8E535AA8A1B18BA774BB90C,ANDROID
E99370642373A8367041E24044F15EA1,ANDROID
1B2FC37816CC4DDAACA97A75E685756F,ANDROID
037DAC225F0C1E54657770CD201CDDA7,ANDROID
5885B9A6C2FBB71AB1304B9EDB330B76,ANDROID
59BE43F3FE7AB3F91B016B56508D4C46,ANDROID
6B8035863BA8F90EDD28470F84922BB2,ANDROID
F4810B35D08410542741137BD5FD3326,ANDROID
21CE5B5B5AEC049C3D4CDA89C18B270F,ANDROID
E50F7AC0680FD87AD6CE6B6700D209A7,ANDROID
FEDC59699D8832A11B88BFCCCAD0951D,ANDROID
D7EA8E3645EFFBD6443946179ED704A6,ANDROID
96CE199B30A1BC1462AECDC118489DBC,ANDROID
3708BB99951B6561E2BAA0CB4AE9DBE7,ANDROID
48FEAB5E27D804CA5A51958469130938,ANDROID
0318C42AEF29C012B2BA556EEF7A7661,ANDROID
59454BAC415BB1F18517C6FD2C023E49,ANDROID

2025-01-29 20:44:22 - root - INFO - SQL:
SELECT `user_pseudo_id`, `event_date`
FROM `firebase-public-project.analytics_153293282.events_20180714`
WHERE `event_name` = 'session_start'
AND PARSE_DATE('%Y%m%d', `event_date`) >= DATE('2018-07-09')
LIMIT 100;
Results:
user_pseudo_id,event_date
F2D0B7E8667E4855BEFD39ECA3185BF7,20180714
F2D0B7E8667E4855BEFD39ECA3185BF7,20180714
654F30C1312F6C1A26DFDA9F076A62D8,20180714
9D535D543FD07B8247DEADB4669FADE6,20180714
9D535D543FD07B8247DEADB4669FADE6,20180714
9D535D543FD07B8247DEADB4669FADE6,20180714
9D535D543FD07B8247DEADB4669FADE6,20180714
807CEC0A6E124029C0885B53E1AE9F03,20180714
295D9E24D8DE65A010313E667131EF19,20180714
295D9E24D8DE65A010313E667131EF19,20180714
295D9E24D8DE65A010313E667131EF19,20180714
295D9E24D8DE65A010313E667131EF19,20180714
8E2C35F60CCD1ED58BBF43272984E73F,20180714
5217AB1A454DAED6243E1C9818BE6A20,20180714
5217AB1A454DAED6243E1C9818BE6A20,20180714
5256B2B115955E80DDB7449775D92325,20180714
5256B2B115955E80DDB7449775D92325,20180714
2F0F260BD7B876C346B41977D0D03D62,20180714
86C65934EDF946EBA8153BF74F0D55CE,20180714
73980AF5B8954128337EB065CE75C773,20180714
73980AF5B8954128337EB065CE75C773,20180714
CA586AC53F444FA7C73138A81445FBA0,20180714
FCA6DF8DBEE40D1953C3A64628A6F2F4,20180714
59483477E9365F4C9A834CD88B37BA41,20180714
B9D8DF9BE543DEFAEDC13BF8903A859A,20180714
B9D8DF9BE543DEFAEDC13BF8903A859A,20180714
026E9E99CF63F4AD31203F6B2E01949D,20180714
026E9E99CF63F4AD31203F6B2E01949D,20180714
026E9E99CF63F4AD31203F6B2E01949D,20180714
026E9E99CF63F4AD31203F6B2E01949D,20180714
026E9E99CF63F4AD31203F6B2E01949D,20180714
5D5895B1267014C54ECBE08864420979,20180714
C6B7ED4E2FA4AABE5693A61B9A07753C,20180714
C6B7ED4E2FA4AABE5693A61B9A07753C,20180714
06984AB55E6069C42FE61F3510F1522B,20180714
06984AB55E6069C42FE61F3510F1522B,20180714
49309C5759610DBF6C829C0D4AB23943,20180714
9F7B0D1BFB822F5E26E91E184E2E437C,20180714
54EEE6C24B723126E17219F5C0F6DE12,20180714
54EEE6C24B723126E17219F5C0F6DE12,20180714
4BF98D09CA8359FC59ADAF56D00338F8,20180714
4BF98D09CA8359FC59ADAF56D00338F8,20180714
D421E51FE6DBCC2D91906B185509AB57,20180714
05407E04B9FA64CB63D8FA1D966AD6A2,20180714
7E40E634997585B0C69B6F67C01C191B,20180714
3827BA312204EA6F6847DFA4222C90CC,20180714
5CDFC86835249BE3DB5E9F6778E344AD,20180714
5CDFC86835249BE3DB5E9F6778E344AD,20180714
F815B0069F973BFA743EF90A85224109,20180714
D0F280B12652EB0D74F6BC74AB13606F,20180714
D0F280B12652EB0D74F6BC74AB13606F,20180714
D0F280B12652EB0D74F6BC74AB13606F,20180714
DF0E6C6C5E4F3F34FEC6EE54FD945B05,20180714
E080406D26F71C9B8F331779CE8B82BA,20180714
3EF8FC940E379D53BBD3FEFDAF626BB2,20180714
16AD1C031AF106322F082EE8EA61C295,20180714
E6FEE8B98E75EA5311FE004F98559A27,20180714
C66BF8A9ACA5CD56597E18B0729181C4,20180714
C66BF8A9ACA5CD56597E18B0729181C4,20180714
DAC0EAB11F253D2173A6FAA79AF5DCAB,20180714
1CF315BC6864E7A71A81E47925E18A61,20180714
FA30269453141794E79B8F15EE0BA5B9,20180714
FA30269453141794E79B8F15EE0BA5B9,20180714

2025-01-29 20:44:24 - root - INFO - SQL:
SELECT `event_date`, COUNT(DISTINCT `user_pseudo_id`) as unique_users
FROM `firebase-public-project.analytics_153293282.events_20180715`
WHERE `event_name` = 'session_start'
GROUP BY `event_date`
LIMIT 100;
Results:
event_date,unique_users
20180715,360

2025-01-29 20:44:24 - root - INFO - itercount: 0
2025-01-29 20:44:24 - root - INFO - Database Name: firebase-public-project
Schema Name: analytics_153293282
DDL describes table information.
,0
table_name,events_20180801
ddl,"CREATE TABLE `firebase-public-project.analytics_153293282.events_20180801`
(
  event_date STRING,
  event_timestamp INT64,
  event_name STRING,
  event_params ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64>>>,
  event_previous_timestamp INT64,
  event_value_in_usd FLOAT64,
  event_bundle_sequence_id INT64,
  event_server_timestamp_offset INT64,
  user_id STRING,
  user_pseudo_id STRING,
  user_properties ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64, set_timestamp_micros INT64>>>,
  user_first_touch_timestamp INT64,
  user_ltv STRUCT<revenue FLOAT64, currency STRING>,
  device STRUCT<category STRING, mobile_brand_name STRING, mobile_model_name STRING, mobile_marketing_name STRING, mobile_os_hardware_model STRING, operating_system STRING, operating_system_version STRING, vendor_id STRING, advertising_id STRING, language STRING, is_limited_ad_tracking STRING, time_zone_offset_seconds INT64>,
  geo STRUCT<continent STRING, country STRING, region STRING, city STRING>,
  app_info STRUCT<id STRING, version STRING, install_store STRING, firebase_app_id STRING, install_source STRING>,
  traffic_source STRUCT<name STRING, medium STRING, source STRING>,
  stream_id STRING,
  platform STRING
);"

Some other tables have the similar structure: ['events_20180801', 'events_20180621', 'events_20180616', 'events_20180912', 'events_20180814', 'events_20180716', 'events_20181003', 'events_20180620', 'events_20180624', 'events_20180918', 'events_20180612', 'events_20180911', 'events_20180724', 'events_20180807', 'events_20180710', 'events_20180808', 'events_20180702', 'events_20180719', 'events_20180914', 'events_20180913', 'events_20180915', 'events_20180728', 'events_20180817', 'events_20180628', 'events_20180906', 'events_20180704', 'events_20180711', 'events_20180720', 'events_20180706', 'events_20180926', 'events_20180924', 'events_20180731', 'events_20180804', 'events_20180920', 'events_20180715', 'events_20180709', 'events_20180928', 'events_20180904', 'events_20180903', 'events_20180818', 'events_20180820', 'events_20180707', 'events_20180930', 'events_20180821', 'events_20180812', 'events_20180830', 'events_20180908', 'events_20180708', 'events_20180910', 'events_20180922', 'events_20180713', 'events_20180618', 'events_20180811', 'events_20181001', 'events_20180626', 'events_20180828', 'events_20180717', 'events_20180806', 'events_20180721', 'events_20180725', 'events_20180824', 'events_20180923', 'events_20180627', 'events_20180726', 'events_20180729', 'events_20180929', 'events_20180925', 'events_20180722', 'events_20180630', 'events_20180730', 'events_20180831', 'events_20180701', 'events_20180619', 'events_20180810', 'events_20180822', 'events_20180921', 'events_20180819', 'events_20180927', 'events_20180905', 'events_20180816', 'events_20180622', 'events_20180802', 'events_20180826', 'events_20180714', 'events_20180901', 'events_20180916', 'events_20180809', 'events_20181002', 'events_20180703', 'events_20180617', 'events_20180902', 'events_20180625', 'events_20180827', 'events_20180805', 'events_20180825', 'events_20180919', 'events_20180917', 'events_20180705', 'events_20180613', 'events_20180907', 'events_20180909', 'events_20180727', 'events_20180813', 'events_20180614', 'events_20180623', 'events_20180829', 'events_20180615', 'events_20180712', 'events_20180718', 'events_20180815', 'events_20180629', 'events_20180803', 'events_20180823', 'events_20180723']
External knowledge that might be helpful: 
How to Calculate User Retention in Big Query from Google Demo Game Analytics Data

As a Product / Website Analyst, I was pretty psyched to discover Google’s public Google Analytics 4 (GA4) gaming event dataset called `firebase-public-project.analytics_153293282.events_*`. The table allows experienced developers and learners alike to experiment with raw GA4 data in Big Query for free. Event data is basically a log of user interactions with your product for analysis .For newbies interested in learning more about event data and GA4, visit my prior blog. This article provides SQL queries for a quick table overview and explains how to utilize Google Big Query to calculate user retention.


What is Retention?
User retention rates are key indicators for whether your product team meets user needs. Improving retention is often central to long term growth strategies.

**Retention measure’s how often and for how long users tend to return to your product.**

The metric can be a powerful proxy for product usefulness and user opinion. Its analysis can reveal critical information like how well your site converts new visitors to users and which items and features are associated with users coming back. If user data is available, retention can also help a business understand the profiles of its most active users (power users). Finally, retention is a great guardrail metric for A/B tests. Successful, product oriented companies prioritize a healthy user bases over short term profits.


**Common Retention Calculation Strategies**

Two common strategies to calculate retention are: 

a) N-Day retention

b) Unbounded Retention.


a) For N-Day retention, analysts calculate how many users with certain characteristics return over successive periods. It is called N days because we define the length of each period. For example, with N=7 day retention, if User A becomes part of our cohort of interest on day 0 and returns to the product day 5 and day 15, they are counted as retained for week 1 (1–7 days) and week 3 (15–21 days) but not week 2 (8–14 days).


b) For Unbounded Retention, a user is counted as retained each week so long as their most recent product contact was after the week. For example, if User A becomes part of the cohort on day 0 and last returned to the site on day 21, they will be counted as retained in week 1 (1–7 days), week 2 (8–14 days), and week 3 (15–21 days) but not week 4 (22–28 days).

By calculating these metrics, companies can evaluate how well their products hold users’ interests. It also them closer to identifying the patterns that generate return users.



The table structure information is ({database name: {schema name: {table name}}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180612', 'events_20180613', 'events_20180614', 'events_20180615', 'events_20180616', 'events_20180617', 'events_20180618', 'events_20180619', 'events_20180620', 'events_20180621', 'events_20180622', 'events_20180623', 'events_20180624', 'events_20180625', 'events_20180626', 'events_20180627', 'events_20180628', 'events_20180629', 'events_20180630', 'events_20180701', 'events_20180702', 'events_20180703', 'events_20180704', 'events_20180705', 'events_20180706', 'events_20180707', 'events_20180708', 'events_20180709', 'events_20180710', 'events_20180711', 'events_20180712', 'events_20180713', 'events_20180714', 'events_20180715', 'events_20180716', 'events_20180717', 'events_20180718', 'events_20180719', 'events_20180720', 'events_20180721', 'events_20180722', 'events_20180723', 'events_20180724', 'events_20180725', 'events_20180726', 'events_20180727', 'events_20180728', 'events_20180729', 'events_20180730', 'events_20180731', 'events_20180801', 'events_20180802', 'events_20180803', 'events_20180804', 'events_20180805', 'events_20180806', 'events_20180807', 'events_20180808', 'events_20180809', 'events_20180810', 'events_20180811', 'events_20180812', 'events_20180813', 'events_20180814', 'events_20180815', 'events_20180816', 'events_20180817', 'events_20180818', 'events_20180819', 'events_20180820', 'events_20180821', 'events_20180822', 'events_20180823', 'events_20180824', 'events_20180825', 'events_20180826', 'events_20180827', 'events_20180828', 'events_20180829', 'events_20180830', 'events_20180831', 'events_20180901', 'events_20180902', 'events_20180903', 'events_20180904', 'events_20180905', 'events_20180906', 'events_20180907', 'events_20180908', 'events_20180909', 'events_20180910', 'events_20180911', 'events_20180912', 'events_20180913', 'events_20180914', 'events_20180915', 'events_20180916', 'events_20180917', 'events_20180918', 'events_20180919', 'events_20180920', 'events_20180921', 'events_20180922', 'events_20180923', 'events_20180924', 'events_20180925', 'events_20180926', 'events_20180927', 'events_20180928', 'events_20180929', 'events_20180930', 'events_20181001', 'events_20181002', 'events_20181003']}}
Begin Exploring Related Columns
Relevant columns and their potential usage:

- `event_name`: Used to identify 'session_start' events.
- `event_timestamp`: Used to determine when the event occurred.
- `event_date`: Used to get the date of the event in 'YYYYMMDD' format.
- `user_pseudo_id`: Unique identifier for each user.
- `user_first_touch_timestamp`: Used to determine the user's first interaction time with the app.
- `event_params`: May contain additional parameters related to events.
- `platform`: Could be used to segment users by platform (e.g., Android, iOS).

Conditions that may be used:

- `event_name = 'session_start'` to filter for session start events.
- `user_first_touch_timestamp >= TIMESTAMP('2018-07-09')` to include users who started using the app after July 9, 2018.
- `event_date` within specific date ranges to group events by week.
- Using `DISTINCT user_pseudo_id` to get unique users.

---

**1. Select distinct event names to understand the types of events:**

```sql
SELECT DISTINCT `event_name`
FROM `firebase-public-project.analytics_153293282.events_20180709`
LIMIT 100;
```

**2. List the first 100 session start events after July 9, 2018:**

```sql
SELECT `event_name`, `event_timestamp`, `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_20180709`
WHERE `event_name` = 'session_start'
LIMIT 100;
```

**3. Get the distinct user_pseudo_id of users who had a session start event on July 9, 2018:**

```sql
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_20180709`
WHERE `event_name` = 'session_start'
LIMIT 100;
```

**4. Retrieve event dates and user IDs for session start events:**

```sql
SELECT `event_date`, `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_20180710`
WHERE `event_name` = 'session_start'
LIMIT 100;
```

**5. Find the first touch timestamps for users who started after July 9, 2018:**

```sql
SELECT `user_pseudo_id`, `user_first_touch_timestamp`
FROM `firebase-public-project.analytics_153293282.events_20180710`
WHERE TIMESTAMP_MICROS(`user_first_touch_timestamp`) >= TIMESTAMP('2018-07-09')
LIMIT 100;
```

**6. Count the number of session start events per user on a specific day:**

```sql
SELECT `user_pseudo_id`, COUNT(*) as session_count
FROM `firebase-public-project.analytics_153293282.events_20180711`
WHERE `event_name` = 'session_start'
GROUP BY `user_pseudo_id`
LIMIT 100;
```

**7. Extract additional parameters from event_params for session start events:**

```sql
SELECT `user_pseudo_id`, ep.key, ep.value.string_value
FROM `firebase-public-project.analytics_153293282.events_20180712`,
    UNNEST(`event_params`) as ep
WHERE `event_name` = 'session_start'
LIMIT 100;
```

**8. Get users who had session_start events and their platforms:**

```sql
SELECT DISTINCT `user_pseudo_id`, `platform`
FROM `firebase-public-project.analytics_153293282.events_20180713`
WHERE `event_name` = 'session_start'
LIMIT 100;
```

**9. List users and the dates of their session_start events after July 9, 2018:**

```sql
SELECT `user_pseudo_id`, `event_date`
FROM `firebase-public-project.analytics_153293282.events_20180714`
WHERE `event_name` = 'session_start'
AND PARSE_DATE('%Y%m%d', `event_date`) >= DATE('2018-07-09')
LIMIT 100;
```

**10. Find the number of unique users per day who had a session_start event:**

```sql
SELECT `event_date`, COUNT(DISTINCT `user_pseudo_id`) as unique_users
FROM `firebase-public-project.analytics_153293282.events_20180715`
WHERE `event_name` = 'session_start'
GROUP BY `event_date`
LIMIT 100;
```

---

These queries help to understand the data structure and values in the relevant columns, which are essential for performing the cohort analysis based on session start events and user retention.Query:
SELECT DISTINCT `event_name`
FROM `firebase-public-project.analytics_153293282.events_20180709`
LIMIT 100;
Answer:
event_name
os_update
screen_view
user_engagement
post_score
level_up
level_end
level_retry
level_start
level_complete
completed_5_levels
session_start
use_extra_steps
spend_virtual_currency
level_complete_quickplay
level_fail_quickplay
level_end_quickplay
level_start_quickplay
level_reset_quickplay
select_content
level_retry_quickplay
level_fail
no_more_extra_steps
ad_reward
level_reset
app_remove
app_exception
challenge_a_friend
firebase_campaign
error
app_update
first_open
Query:
SELECT `event_name`, `event_timestamp`, `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_20180709`
WHERE `event_name` = 'session_start'
LIMIT 100;
Answer:
event_name,event_timestamp,user_pseudo_id
session_start,1531157451210001,6E018CE86D4601A362A9154B2500348A
session_start,1531137357029000,23183C7A7E31451194345099C978F49E
session_start,1531167062916000,3B7AC9CAE2D7BB661BE66F3DE36DD005
session_start,1531163950703000,9D535D543FD07B8247DEADB4669FADE6
session_start,1531191769500000,9D535D543FD07B8247DEADB4669FADE6
session_start,1531176853965000,22DC6A6AE86C0AA33EBB8C3164A26925
session_start,1531180078828000,22DC6A6AE86C0AA33EBB8C3164A26925
session_start,1531146954008000,EF9E8CCCCBBB015CAE0C334AB1745417
session_start,1531178671964000,85FD06F19EBB6097388EEE0B207598B7
session_start,1531160215257001,9603F4B5ABFC1E48B0BF68C83669F845
session_start,1531132347638000,5217AB1A454DAED6243E1C9818BE6A20
session_start,1531134615535000,5217AB1A454DAED6243E1C9818BE6A20
session_start,1531161831808000,5217AB1A454DAED6243E1C9818BE6A20
session_start,1531179220064000,5217AB1A454DAED6243E1C9818BE6A20
session_start,1531184420010000,5217AB1A454DAED6243E1C9818BE6A20
session_start,1531174304324000,5256B2B115955E80DDB7449775D92325
session_start,1531172011087000,E0F91AA200D6F12DBE53B0D166AFD87B
session_start,1531176104215000,2F0F260BD7B876C346B41977D0D03D62
session_start,1531187925556000,2F0F260BD7B876C346B41977D0D03D62
session_start,1531187191553000,DB9F0F2561524A9EE1436805AAD70675
session_start,1531167691788000,E2B530ADD7430BEA6BC7F3D431C8A6FF
session_start,1531152140334000,71746D859E4E6D655FEE8FFBC3B6C7E9
session_start,1531200641990000,F26EC6056E284FDDEA7771F203B6BB8F
session_start,1531203639643000,F26EC6056E284FDDEA7771F203B6BB8F
session_start,1531197742205000,945DE7C965AFB12E35C3C992CF9847E2
session_start,1531154960311000,980DEC5BA17132A841D7D7A140333114
session_start,1531133833748000,0160043392B1572A375E5C3BE1BB0C31
session_start,1531147125094000,0373DF7959F6867CDFB1C905D39CE67C
session_start,1531193031386000,C6B7ED4E2FA4AABE5693A61B9A07753C
session_start,1531124847080000,C136A7CE1D0A52B8D4E5F144DF114EB7
session_start,1531141606959000,77F5E9A5630151C9E831156AEAB4DA11
session_start,1531134431573000,49309C5759610DBF6C829C0D4AB23943
session_start,1531148119063000,5F824D23AE3CF750894A96098818E789
session_start,1531125138282000,9F3EAF490630617EF2CB47A8BD2CBBCC
session_start,1531128994328000,9F3EAF490630617EF2CB47A8BD2CBBCC
session_start,1531148472001000,9F3EAF490630617EF2CB47A8BD2CBBCC
session_start,1531159360850000,9F3EAF490630617EF2CB47A8BD2CBBCC
session_start,1531172269047000,9F3EAF490630617EF2CB47A8BD2CBBCC
session_start,1531195034458000,9F3EAF490630617EF2CB47A8BD2CBBCC
session_start,1531138158501000,5C5A0787542CD24F1E19F9EB778BA766
session_start,1531171480376000,4BF98D09CA8359FC59ADAF56D00338F8
Query:
SELECT DISTINCT `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_20180709`
WHERE `event_name` = 'session_start'
LIMIT 100;
Answer:
user_pseudo_id
6E018CE86D4601A362A9154B2500348A
23183C7A7E31451194345099C978F49E
3B7AC9CAE2D7BB661BE66F3DE36DD005
9D535D543FD07B8247DEADB4669FADE6
22DC6A6AE86C0AA33EBB8C3164A26925
EF9E8CCCCBBB015CAE0C334AB1745417
85FD06F19EBB6097388EEE0B207598B7
9603F4B5ABFC1E48B0BF68C83669F845
5217AB1A454DAED6243E1C9818BE6A20
5256B2B115955E80DDB7449775D92325
E0F91AA200D6F12DBE53B0D166AFD87B
2F0F260BD7B876C346B41977D0D03D62
DB9F0F2561524A9EE1436805AAD70675
E2B530ADD7430BEA6BC7F3D431C8A6FF
71746D859E4E6D655FEE8FFBC3B6C7E9
F26EC6056E284FDDEA7771F203B6BB8F
945DE7C965AFB12E35C3C992CF9847E2
980DEC5BA17132A841D7D7A140333114
0160043392B1572A375E5C3BE1BB0C31
0373DF7959F6867CDFB1C905D39CE67C
C6B7ED4E2FA4AABE5693A61B9A07753C
C136A7CE1D0A52B8D4E5F144DF114EB7
77F5E9A5630151C9E831156AEAB4DA11
49309C5759610DBF6C829C0D4AB23943
5F824D23AE3CF750894A96098818E789
9F3EAF490630617EF2CB47A8BD2CBBCC
5C5A0787542CD24F1E19F9EB778BA766
4BF98D09CA8359FC59ADAF56D00338F8
60603343AB8FEECD78B1009C957D193D
23A7E8D987ADCC38EB026096DC513F85
D7D49CC32C4A23AD56E8DEAE6878EC7B
B4394AD77C6DE7A5C7385C307F35F84F
3827BA312204EA6F6847DFA4222C90CC
4500595CA1FC3CBC6140A502240FB7B4
1F25763EC8BCAEC7FB069E81659A2153
706C748E6D1E0768BFEFE6362B5D3F67
F815B0069F973BFA743EF90A85224109
D0F280B12652EB0D74F6BC74AB13606F
4D084D38156128AAA060303AA91E689D
05F7B2C58D627CE948B06C10E39CDF91
3EF8FC940E379D53BBD3FEFDAF626BB2
E6FEE8B98E75EA5311FE004F98559A27
48AB910A8DE8485D4C34238EA61F782C
0E05F56141200FF41FCC0C7FA297FF08
AB32482D193E2CE166B59F82EF78D8BB
2F5B044B41268F6643EB4D0EF15D4E87
8E6F7A428C907165D78A2377ABEB7315
7566596A1D6ACA781692A7A0B89B06EF
A29EBFE2A58D7C4D6FDA23C3A53742FF
EF9C32CA65880162136061B25D24E05E
B56E67847E1AE8D6411A5ECCA26585CA
295D9E24D8DE65A010313E667131EF19
88A41BFED275BB69125BE1F5524F3B42
29845B6298FB882DF53607D21F0E1DF7
7F2B633C86B765201C93FDB6FF261143
60ACC539CFC3DB94C60921D5572C3A4D
4BDC831A6940071E2461D0B5293A329E
8D31836A6C3C14CE71056BED8925F0A4
D5F9D9AF22EF5073E10342973D48FB2C
17515C32D8E535AA8A1B18BA774BB90C
B275DC380CF75B352381D5419E397047
1B2FC37816CC4DDAACA97A75E685756F
6B9CFFB3E0DE6FA0C47B8410C4467F89
037DAC225F0C1E54657770CD201CDDA7
7537C0AA6291AC7B99DC4D2D695EEF1D
9038CCC5F7D7ABDA6E296D18FFDD1AAA
59BE43F3FE7AB3F91B016B56508D4C46
FFFE80A7B9667187D501CE6037876955
A65FAEAB5577A16B517735A9D9C54958
FEC117631F54C2699CB76603EBB98CF0
38DEEAB5F723A89A66CF180A175808D5
C795AFA7F574C2BB09D3647AD90A9719
84F5D9204EDAE98B3B542AEA93F40BED
FEDC59699D8832A11B88BFCCCAD0951D
D7EA8E3645EFFBD6443946179ED704A6
59454BAC415BB1F18517C6FD2C023E49
017CF202552235BBA4338E0D82A53F43
F19B8122771D0514F440E914B722656A
B75F91EB6C7FDA9A329567E763CF9E44
8EDB9A9856CDB5AFC42546106EE46734
8BE7BF90C971453A34C1FF6FF2A0ACAE
EBFE0623EF1109A89B392B9DF4375951
0B99B2EC1247C09535717331F816D42D
CA04708DA02378999ECB402481FF1AE4
E4196C5E0A92A22F69DE4E3AA288D6EE
2F5BBABE9DD0271DCD62E501F76DA736
10522BF919A454B898540F51FFDCB292
6D4F9673F3DADCB39EE913EFCA2AE282
359B5B95C8B1DF723D939A5A8AFF0904
D3F06F9B7BD9D7FC8758BF78BF0705E9
8040FC9C0479C3B9A74ED298DD8F357D
D299D5763E03F1CC4DA8550AF1B4CEE4
1F732B8A151B6C6249323BC65CA9C1F9
Query:
SELECT `event_date`, `user_pseudo_id`
FROM `firebase-public-project.analytics_153293282.events_20180710`
WHERE `event_name` = 'session_start'
LIMIT 100;
Answer:
event_date,user_pseudo_id
20180710,9D535D543FD07B8247DEADB4669FADE6
20180710,295D9E24D8DE65A010313E667131EF19
20180710,5217AB1A454DAED6243E1C9818BE6A20
20180710,5217AB1A454DAED6243E1C9818BE6A20
20180710,5217AB1A454DAED6243E1C9818BE6A20
20180710,5256B2B115955E80DDB7449775D92325
20180710,5256B2B115955E80DDB7449775D92325
20180710,0FF2FC480E70693841DCBFBB240F2E24
20180710,27A7A10FDC637E7E93B1EAB037530293
20180710,E2B530ADD7430BEA6BC7F3D431C8A6FF
20180710,F26EC6056E284FDDEA7771F203B6BB8F
20180710,224C6AE85D60A605AC6164FA86738DF6
20180710,59483477E9365F4C9A834CD88B37BA41
20180710,0373DF7959F6867CDFB1C905D39CE67C
20180710,0373DF7959F6867CDFB1C905D39CE67C
20180710,5D5895B1267014C54ECBE08864420979
20180710,094CDCB8EF23B9B55134A0B5E22DFFCB
20180710,49309C5759610DBF6C829C0D4AB23943
20180710,49309C5759610DBF6C829C0D4AB23943
20180710,9F3EAF490630617EF2CB47A8BD2CBBCC
20180710,9F3EAF490630617EF2CB47A8BD2CBBCC
20180710,9DE7361ACCDEA6541AD5EA55D59B1C78
20180710,9DE7361ACCDEA6541AD5EA55D59B1C78
20180710,60603343AB8FEECD78B1009C957D193D
20180710,48D0C822ACA6BD0B5FBA8ECD27CBB247
20180710,D7D49CC32C4A23AD56E8DEAE6878EC7B
20180710,FB9AD160115DC0E6F045BB654344287B
20180710,7E40E634997585B0C69B6F67C01C191B
20180710,1F25763EC8BCAEC7FB069E81659A2153
20180710,706C748E6D1E0768BFEFE6362B5D3F67
20180710,F815B0069F973BFA743EF90A85224109
20180710,D0F280B12652EB0D74F6BC74AB13606F
20180710,0AF862AFEB5358EBFDA7AFE3AC908844
20180710,0AF862AFEB5358EBFDA7AFE3AC908844
20180710,4D084D38156128AAA060303AA91E689D
20180710,4D084D38156128AAA060303AA91E689D
20180710,68149A4353C4E6C2AF49CF5F35FBB78C
20180710,3EF8FC940E379D53BBD3FEFDAF626BB2
20180710,3EF8FC940E379D53BBD3FEFDAF626BB2
20180710,3EF8FC940E379D53BBD3FEFDAF626BB2
20180710,2DB65B29C41328FF8AB9AC27B7C05537
20180710,2DB65B29C41328FF8AB9AC27B7C05537
20180710,E6FEE8B98E75EA5311FE004F98559A27
20180710,48AB910A8DE8485D4C34238EA61F782C
20180710,48AB910A8DE8485D4C34238EA61F782C
20180710,48AB910A8DE8485D4C34238EA61F782C
20180710,48AB910A8DE8485D4C34238EA61F782C
20180710,1CF315BC6864E7A71A81E47925E18A61
20180710,FA30269453141794E79B8F15EE0BA5B9
20180710,FA30269453141794E79B8F15EE0BA5B9
20180710,FA30269453141794E79B8F15EE0BA5B9
20180710,0E05F56141200FF41FCC0C7FA297FF08
20180710,0E05F56141200FF41FCC0C7FA297FF08
20180710,81D3DD49AA2304FD1ED8C498747B5FC6
20180710,F9E81248456FBD71D00697C06259396E
20180710,40B501E0460E254E289A776CFC31DCF2
20180710,40B501E0460E254E289A776CFC31DCF2
20180710,40B501E0460E254E289A776CFC31DCF2
20180710,40B501E0460E254E289A776CFC31DCF2
20180710,26E86A2E3E01E89467AE434BBF204817
20180710,AB32482D193E2CE166B59F82EF78D8BB
20180710,41CA0FA528C7227EA1E592DCC4733C40
20180710,2F5B044B41268F6643EB4D0EF15D4E87
Query:
SELECT `user_pseudo_id`, `user_first_touch_timestamp`
FROM `firebase-public-project.analytics_153293282.events_20180710`
WHERE TIMESTAMP_MICROS(`user_first_touch_timestamp`) >= TIMESTAMP('2018-07-09')
LIMIT 100;
Answer:
user_pseudo_id,user_first_touch_timestamp
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
Query:
SELECT `user_pseudo_id`, COUNT(*) as session_count
FROM `firebase-public-project.analytics_153293282.events_20180711`
WHERE `event_name` = 'session_start'
GROUP BY `user_pseudo_id`
LIMIT 100;
Answer:
user_pseudo_id,session_count
56F37FD95FB21AB3976C83E803D7AEA7,1
40BA3CE848E99626DACC46BCCEE3E568,1
C2D9D55F57CC8CFF60599E1928594368,1
A8D7DCCA39D8703F2928AD2D7BBB6BE9,1
062964F7169622E4AEC91756FFB8261B,1
2684EA4DDB1F988E3C979AB15CFF601F,1
CB06B751DAD44BB7F228F8474686D404,2
5358D124C06358BCD5FEF67C87052AC2,1
2B0D8BD127A58843F3B4F8C8FE50CD77,1
5C813D5127BF4EC2AAB2B93A6406E223,1
E4C074EBC3729FB45CFA48D9F6EA4DFD,1
7410C5CC4FA11D31DB5F9B1D8ECD6BD0,1
2B5437C3C5064C97EA9DD2A8FCD99571,1
3FC8ECFC8F2976C5B56D0D782F36BD7F,2
50B9480303280C2408C4C77A8AFA9480,1
370CDFEE49990E4A9A1FBC0DC5C31C1C,1
D9AA0EC27AF47514DDB5C664A6EF758A,1
DA48D36D07835B1918BDF831AF83B5EF,2
EFB696A82D093B3AFBE92FF526DD5CEA,4
5E624075FDFE3003C34E1138546B2450,1
4B685109746904E9090CB41DE88508FD,1
898B790ACC7834117A9B2C98A8B6F1F5,2
225638B28A80341EEB04F1DFC144F30E,1
AFFBFB5A561C0DEA5ACAA4D33BC483A5,1
289F2AE59FE48FFF6DD12D0AB553C14E,1
86942BEBB6333C69BD5EADC72AC04A3E,1
E4C6FF8288DD4BFCDE93E2218E20643B,1
B1D1ED35873581A23E48C4CD03DDFF81,1
AFA6BA99FB329CB459E8E57FDE1DF9AE,1
7532B9EE7B6F844FF4ECB5DD8A864551,1
946428DDC28C630D510D763B6A925171,1
BB679B94B0DB34FAF2C2B541A6143F93,1
60432093BCE28FA117B03C2CA82C1E7A,1
F1555004E0D95599AF2F2B8EA130A9C3,1
9043DDF80C097DA753756B660DF78768,1
372D9BB5088C4E9000C65B06459B403A,4
263C111D407C5E17AC6310581C3B9255,1
0B427C5E490A982FADF586F82E797ACB,1
93CD991A5D10398F5534E4C196C59972,2
56AB5AA26CE53AB27D81C65372B450F5,1
1C9DAE1F278190CEEEEB70A8F4B28FE5,1
CA51DAF1373B5C2A16C174AFBD2132A4,1
7ED8C235689771F6B0F29BBF295A346F,1
13E6C8A193FF140F7D4222B569DD5B50,3
07DB546A94677E3F3203A8C30B9A4F11,1
686CB936AA9E0A81C377FC2604862AD2,1
D0969C741DF2022FBA9602C04823A358,1
F095A7DDC32D556FE7DFB25469062D5A,1
84E491A60BE52A4C6A438A89FADE283C,1
13798F47A0DF4CB2AC980AEC8C733DC3,1
96161BF2E55C7E32ED5F411432875ECB,1
297D261C85AC0E9A01BA1D0F9DD8A9B7,1
FDA4BBBCF1EA2D95CDD77BFC5F00A837,1
25FFAED0980E76F9D5541692299B1B81,1
8065F8E98407106A65D35195984B2258,1
077277C88E7D330761F5272DB2EEE43A,1
7D7B319DFFF03520EF50236B2C3FB008,1
7944286F80A3955AF83CAB9F7C88866D,1
E643F6549E6C7EA0FD01EF4BF7A40F76,1
77D5FF20DF909CDD790ED52FC94AF7BD,1
396CD60DADAB9CBA7DDCAF239B477135,4
880639B108797EEC419D56E8548D0BF2,1
29BF140A43CB250B891EE34D5CEB39E4,1
EF500E0CF578004836D1D38C8901862B,8
76690E22DDCE2B1FFA98C6A4376B8EA2,2
33E5EA9FE1E29AC3127D975A5494213D,1
328DC7FE55E8881B2EA668C9A2855BB7,3
C9ADDD0F70E255FD7105712C43C3A45F,1
Query:
SELECT `user_pseudo_id`, ep.key, ep.value.string_value
FROM `firebase-public-project.analytics_153293282.events_20180712`,
    UNNEST(`event_params`) as ep
WHERE `event_name` = 'session_start'
LIMIT 100;
Answer:
user_pseudo_id,key,string_value
5E9B9E20975EF45745B511D401456619,firebase_conversion,
5E9B9E20975EF45745B511D401456619,firebase_screen_class,main_menu
5E9B9E20975EF45745B511D401456619,firebase_event_origin,auto
5E9B9E20975EF45745B511D401456619,firebase_screen_id,
5E9B9E20975EF45745B511D401456619,firebase_conversion,
5E9B9E20975EF45745B511D401456619,firebase_screen_class,game_board
5E9B9E20975EF45745B511D401456619,firebase_event_origin,auto
5E9B9E20975EF45745B511D401456619,firebase_screen_id,
D7D49CC32C4A23AD56E8DEAE6878EC7B,firebase_conversion,
D7D49CC32C4A23AD56E8DEAE6878EC7B,firebase_screen_class,game_board
D7D49CC32C4A23AD56E8DEAE6878EC7B,firebase_event_origin,auto
D7D49CC32C4A23AD56E8DEAE6878EC7B,firebase_screen_id,
D7D49CC32C4A23AD56E8DEAE6878EC7B,firebase_conversion,
D7D49CC32C4A23AD56E8DEAE6878EC7B,firebase_screen_class,game_board
D7D49CC32C4A23AD56E8DEAE6878EC7B,firebase_event_origin,auto
D7D49CC32C4A23AD56E8DEAE6878EC7B,firebase_screen_id,
4EA4BB597E4AFD7B452F7C8669B5AC13,firebase_conversion,
4EA4BB597E4AFD7B452F7C8669B5AC13,firebase_screen_class,game_board
4EA4BB597E4AFD7B452F7C8669B5AC13,firebase_event_origin,auto
4EA4BB597E4AFD7B452F7C8669B5AC13,firebase_screen_id,
23183C7A7E31451194345099C978F49E,firebase_conversion,
23183C7A7E31451194345099C978F49E,firebase_screen_class,main_menu
23183C7A7E31451194345099C978F49E,firebase_event_origin,auto
23183C7A7E31451194345099C978F49E,firebase_screen_id,
23183C7A7E31451194345099C978F49E,firebase_conversion,
23183C7A7E31451194345099C978F49E,firebase_screen_class,game_board
23183C7A7E31451194345099C978F49E,firebase_event_origin,auto
23183C7A7E31451194345099C978F49E,firebase_screen_id,
EB681942FA18C6BF1AF2AC7ABA74D491,firebase_conversion,
EB681942FA18C6BF1AF2AC7ABA74D491,firebase_screen_class,game_board
EB681942FA18C6BF1AF2AC7ABA74D491,firebase_event_origin,auto
EB681942FA18C6BF1AF2AC7ABA74D491,firebase_screen_id,
53649082C25AB9A9CD1E394EBBA9CEF3,firebase_conversion,
53649082C25AB9A9CD1E394EBBA9CEF3,firebase_screen_class,game_board
53649082C25AB9A9CD1E394EBBA9CEF3,firebase_event_origin,auto
53649082C25AB9A9CD1E394EBBA9CEF3,firebase_screen_id,
53649082C25AB9A9CD1E394EBBA9CEF3,firebase_conversion,
53649082C25AB9A9CD1E394EBBA9CEF3,firebase_screen_class,level_select
53649082C25AB9A9CD1E394EBBA9CEF3,firebase_event_origin,auto
53649082C25AB9A9CD1E394EBBA9CEF3,firebase_screen_id,
08F14F3BCA030F81B447161BA8653B44,firebase_conversion,
08F14F3BCA030F81B447161BA8653B44,firebase_screen_class,game_board
08F14F3BCA030F81B447161BA8653B44,firebase_event_origin,auto
08F14F3BCA030F81B447161BA8653B44,firebase_screen_id,
3827BA312204EA6F6847DFA4222C90CC,firebase_conversion,
3827BA312204EA6F6847DFA4222C90CC,firebase_screen_class,game_board
Query:
SELECT DISTINCT `user_pseudo_id`, `platform`
FROM `firebase-public-project.analytics_153293282.events_20180713`
WHERE `event_name` = 'session_start'
LIMIT 100;
Answer:
user_pseudo_id,platform
9E635066BDD2E61E59252D382E0D2C61,ANDROID
23183C7A7E31451194345099C978F49E,ANDROID
3376C102EBF491B5CB84B43759FE3433,ANDROID
B29581947ADA95875735E29B397275CE,ANDROID
9D535D543FD07B8247DEADB4669FADE6,ANDROID
FB6DF2FE493D87177B8A640D71AE45DD,ANDROID
11351D26EFC914BDB62006215A68D1D4,ANDROID
295D9E24D8DE65A010313E667131EF19,ANDROID
5217AB1A454DAED6243E1C9818BE6A20,ANDROID
5256B2B115955E80DDB7449775D92325,ANDROID
D1F53693AA457A127407EBA024A07EE4,ANDROID
73980AF5B8954128337EB065CE75C773,ANDROID
CCF21A11C5F30A2F7787A0DD822F9126,ANDROID
026E9E99CF63F4AD31203F6B2E01949D,ANDROID
0160043392B1572A375E5C3BE1BB0C31,ANDROID
0373DF7959F6867CDFB1C905D39CE67C,ANDROID
77F5E9A5630151C9E831156AEAB4DA11,ANDROID
27954A1D70BCD7F326F926A5D5B666E6,ANDROID
82D556A8003F97B39A2D2E8E5520F9B6,ANDROID
52332E7857233EC06090B1059F0C6292,ANDROID
4BF98D09CA8359FC59ADAF56D00338F8,ANDROID
95E26DC518A7793A7E7C9D40BE914111,ANDROID
05407E04B9FA64CB63D8FA1D966AD6A2,ANDROID
DAC3C60A9BB7734F83F0C7478185AC4C,ANDROID
ACB0CC9AC2138D424084DC1D8C18F077,ANDROID
706C748E6D1E0768BFEFE6362B5D3F67,ANDROID
F815B0069F973BFA743EF90A85224109,ANDROID
D0F280B12652EB0D74F6BC74AB13606F,ANDROID
495466C2475D9A12548D8CEE1515A0A7,ANDROID
48AB910A8DE8485D4C34238EA61F782C,ANDROID
FA30269453141794E79B8F15EE0BA5B9,ANDROID
0E05F56141200FF41FCC0C7FA297FF08,ANDROID
75C683C1AE98FC6CCE6EA156C9E90A35,ANDROID
7ED4165854463C38F1D739A2014001D9,ANDROID
41CA0FA528C7227EA1E592DCC4733C40,ANDROID
DCEFBF52331910FC267F07111AD868F9,ANDROID
7566596A1D6ACA781692A7A0B89B06EF,ANDROID
CF06C47EAD622F909BFCC83FF4D0ECE8,ANDROID
23FB24C9178CBD3DEEB8BA90BA95FF02,ANDROID
F36044676636D14F86FD083DDD910E04,ANDROID
93E117D728FA61CDD42AE547CD74E89E,ANDROID
9D956C83A0AD889DDFCA96A7589A40AD,ANDROID
5145D8121071A9EA903A1098034962F6,ANDROID
C3295C36C51EAF010079266FB55EF2DD,ANDROID
F94E005EB49AFB8DA0A78030D4ABB44B,ANDROID
A8E58A0B45F20FF957312FA929CBD83F,ANDROID
757F371D73A59AA7B6FB5CF1E6483B33,ANDROID
D5F9D9AF22EF5073E10342973D48FB2C,ANDROID
17515C32D8E535AA8A1B18BA774BB90C,ANDROID
E99370642373A8367041E24044F15EA1,ANDROID
1B2FC37816CC4DDAACA97A75E685756F,ANDROID
037DAC225F0C1E54657770CD201CDDA7,ANDROID
5885B9A6C2FBB71AB1304B9EDB330B76,ANDROID
59BE43F3FE7AB3F91B016B56508D4C46,ANDROID
6B8035863BA8F90EDD28470F84922BB2,ANDROID
F4810B35D08410542741137BD5FD3326,ANDROID
21CE5B5B5AEC049C3D4CDA89C18B270F,ANDROID
E50F7AC0680FD87AD6CE6B6700D209A7,ANDROID
FEDC59699D8832A11B88BFCCCAD0951D,ANDROID
D7EA8E3645EFFBD6443946179ED704A6,ANDROID
96CE199B30A1BC1462AECDC118489DBC,ANDROID
3708BB99951B6561E2BAA0CB4AE9DBE7,ANDROID
48FEAB5E27D804CA5A51958469130938,ANDROID
0318C42AEF29C012B2BA556EEF7A7661,ANDROID
59454BAC415BB1F18517C6FD2C023E49,ANDROID
Query:
SELECT `user_pseudo_id`, `event_date`
FROM `firebase-public-project.analytics_153293282.events_20180714`
WHERE `event_name` = 'session_start'
AND PARSE_DATE('%Y%m%d', `event_date`) >= DATE('2018-07-09')
LIMIT 100;
Answer:
user_pseudo_id,event_date
F2D0B7E8667E4855BEFD39ECA3185BF7,20180714
F2D0B7E8667E4855BEFD39ECA3185BF7,20180714
654F30C1312F6C1A26DFDA9F076A62D8,20180714
9D535D543FD07B8247DEADB4669FADE6,20180714
9D535D543FD07B8247DEADB4669FADE6,20180714
9D535D543FD07B8247DEADB4669FADE6,20180714
9D535D543FD07B8247DEADB4669FADE6,20180714
807CEC0A6E124029C0885B53E1AE9F03,20180714
295D9E24D8DE65A010313E667131EF19,20180714
295D9E24D8DE65A010313E667131EF19,20180714
295D9E24D8DE65A010313E667131EF19,20180714
295D9E24D8DE65A010313E667131EF19,20180714
8E2C35F60CCD1ED58BBF43272984E73F,20180714
5217AB1A454DAED6243E1C9818BE6A20,20180714
5217AB1A454DAED6243E1C9818BE6A20,20180714
5256B2B115955E80DDB7449775D92325,20180714
5256B2B115955E80DDB7449775D92325,20180714
2F0F260BD7B876C346B41977D0D03D62,20180714
86C65934EDF946EBA8153BF74F0D55CE,20180714
73980AF5B8954128337EB065CE75C773,20180714
73980AF5B8954128337EB065CE75C773,20180714
CA586AC53F444FA7C73138A81445FBA0,20180714
FCA6DF8DBEE40D1953C3A64628A6F2F4,20180714
59483477E9365F4C9A834CD88B37BA41,20180714
B9D8DF9BE543DEFAEDC13BF8903A859A,20180714
B9D8DF9BE543DEFAEDC13BF8903A859A,20180714
026E9E99CF63F4AD31203F6B2E01949D,20180714
026E9E99CF63F4AD31203F6B2E01949D,20180714
026E9E99CF63F4AD31203F6B2E01949D,20180714
026E9E99CF63F4AD31203F6B2E01949D,20180714
026E9E99CF63F4AD31203F6B2E01949D,20180714
5D5895B1267014C54ECBE08864420979,20180714
C6B7ED4E2FA4AABE5693A61B9A07753C,20180714
C6B7ED4E2FA4AABE5693A61B9A07753C,20180714
06984AB55E6069C42FE61F3510F1522B,20180714
06984AB55E6069C42FE61F3510F1522B,20180714
49309C5759610DBF6C829C0D4AB23943,20180714
9F7B0D1BFB822F5E26E91E184E2E437C,20180714
54EEE6C24B723126E17219F5C0F6DE12,20180714
54EEE6C24B723126E17219F5C0F6DE12,20180714
4BF98D09CA8359FC59ADAF56D00338F8,20180714
4BF98D09CA8359FC59ADAF56D00338F8,20180714
D421E51FE6DBCC2D91906B185509AB57,20180714
05407E04B9FA64CB63D8FA1D966AD6A2,20180714
7E40E634997585B0C69B6F67C01C191B,20180714
3827BA312204EA6F6847DFA4222C90CC,20180714
5CDFC86835249BE3DB5E9F6778E344AD,20180714
5CDFC86835249BE3DB5E9F6778E344AD,20180714
F815B0069F973BFA743EF90A85224109,20180714
D0F280B12652EB0D74F6BC74AB13606F,20180714
D0F280B12652EB0D74F6BC74AB13606F,20180714
D0F280B12652EB0D74F6BC74AB13606F,20180714
DF0E6C6C5E4F3F34FEC6EE54FD945B05,20180714
E080406D26F71C9B8F331779CE8B82BA,20180714
3EF8FC940E379D53BBD3FEFDAF626BB2,20180714
16AD1C031AF106322F082EE8EA61C295,20180714
E6FEE8B98E75EA5311FE004F98559A27,20180714
C66BF8A9ACA5CD56597E18B0729181C4,20180714
C66BF8A9ACA5CD56597E18B0729181C4,20180714
DAC0EAB11F253D2173A6FAA79AF5DCAB,20180714
1CF315BC6864E7A71A81E47925E18A61,20180714
FA30269453141794E79B8F15EE0BA5B9,20180714
FA30269453141794E79B8F15EE0BA5B9,20180714
Query:
SELECT `event_date`, COUNT(DISTINCT `user_pseudo_id`) as unique_users
FROM `firebase-public-project.analytics_153293282.events_20180715`
WHERE `event_name` = 'session_start'
GROUP BY `event_date`
LIMIT 100;
Answer:
event_date,unique_users
20180715,360
End Exploring Related Columns
Task: Conduct a weekly cohort analysis for user retention starting from July 9, 2018, grouping users by the week of their first session start event. Calculate the retention rates for each cohort in the subsequent two weeks. Specifically, measure the percentage of users from the original cohort who returned in week 2 (two weeks after their first session). Only include users whose first session start event occurred after July 9, 2018. The data is available up to October 2, 2018 (meaning the last cohort group is for the week of September 17, 2018). For this analysis, retention is calculated based on the first session start date, and cohorts are grouped weekly starting from the first session.

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
Cohort_Week_Start_Date,Retention_Rate_Percentage
2018-07-09,retention1:float
2018-07-16,retention2:float
2018-07-23,retention3:float
2018-07-30,retention4:float
2018-08-06,retention5:float
2018-08-13,retention6:float
2018-08-20,retention7:float
2018-08-27,retention8:float
2018-09-03,retention9:float
2018-09-10,retention10:float
2018-09-17,retention11:float
(Attention: answer in 11 rows)
```

For each weekly cohort starting from July 9, 2018, we calculated the retention rate in week 2 (two weeks after their first session) as the percentage of users who had their first session during the cohort week and returned during week 2 (days 8-14 after their first session week)..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180612', 'events_20180613', 'events_20180614', 'events_20180615', 'events_20180616', 'events_20180617', 'events_20180618', 'events_20180619', 'events_20180620', 'events_20180621', 'events_20180622', 'events_20180623', 'events_20180624', 'events_20180625', 'events_20180626', 'events_20180627', 'events_20180628', 'events_20180629', 'events_20180630', 'events_20180701', 'events_20180702', 'events_20180703', 'events_20180704', 'events_20180705', 'events_20180706', 'events_20180707', 'events_20180708', 'events_20180709', 'events_20180710', 'events_20180711', 'events_20180712', 'events_20180713', 'events_20180714', 'events_20180715', 'events_20180716', 'events_20180717', 'events_20180718', 'events_20180719', 'events_20180720', 'events_20180721', 'events_20180722', 'events_20180723', 'events_20180724', 'events_20180725', 'events_20180726', 'events_20180727', 'events_20180728', 'events_20180729', 'events_20180730', 'events_20180731', 'events_20180801', 'events_20180802', 'events_20180803', 'events_20180804', 'events_20180805', 'events_20180806', 'events_20180807', 'events_20180808', 'events_20180809', 'events_20180810', 'events_20180811', 'events_20180812', 'events_20180813', 'events_20180814', 'events_20180815', 'events_20180816', 'events_20180817', 'events_20180818', 'events_20180819', 'events_20180820', 'events_20180821', 'events_20180822', 'events_20180823', 'events_20180824', 'events_20180825', 'events_20180826', 'events_20180827', 'events_20180828', 'events_20180829', 'events_20180830', 'events_20180831', 'events_20180901', 'events_20180902', 'events_20180903', 'events_20180904', 'events_20180905', 'events_20180906', 'events_20180907', 'events_20180908', 'events_20180909', 'events_20180910', 'events_20180911', 'events_20180912', 'events_20180913', 'events_20180914', 'events_20180915', 'events_20180916', 'events_20180917', 'events_20180918', 'events_20180919', 'events_20180920', 'events_20180921', 'events_20180922', 'events_20180923', 'events_20180924', 'events_20180925', 'events_20180926', 'events_20180927', 'events_20180928', 'events_20180929', 'events_20180930', 'events_20181001', 'events_20181002', 'events_20181003']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-29 20:45:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-29 20:45:21 - root - INFO - ```sql
WITH first_sessions AS (
    SELECT 
        user_pseudo_id,
        MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_session_date
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE event_name = 'session_start'
      AND PARSE_DATE('%Y%m%d', event_date) >= DATE('2018-07-09')
      AND _TABLE_SUFFIX BETWEEN '20180709' AND '20181002'
    GROUP BY user_pseudo_id
),

user_cohorts AS (
    SELECT 
        user_pseudo_id,
        first_session_date,
        DATE_TRUNC(first_session_date, WEEK(MONDAY)) AS cohort_week_start_date,
        DATE_ADD(DATE_TRUNC(first_session_date, WEEK(MONDAY)), INTERVAL 7 DAY) AS week2_start_date,
        DATE_ADD(DATE_TRUNC(first_session_date, WEEK(MONDAY)), INTERVAL 13 DAY) AS week2_end_date
    FROM first_sessions
),

user_retention AS (
    SELECT 
        uc.user_pseudo_id,
        uc.cohort_week_start_date,
        IF(
            EXISTS (
                SELECT 1
                FROM `firebase-public-project.analytics_153293282.events_*` ev
                WHERE ev.user_pseudo_id = uc.user_pseudo_id
                  AND ev.event_name = 'session_start'
                  AND PARSE_DATE('%Y%m%d', ev.event_date) BETWEEN uc.week2_start_date AND uc.week2_end_date
                  AND _TABLE_SUFFIX BETWEEN FORMAT_DATE('%Y%m%d', uc.week2_start_date) AND FORMAT_DATE('%Y%m%d', uc.week2_end_date)
            ), 1, 0) AS is_retained_in_week2
    FROM user_cohorts uc
),

cohort_retention AS (
    SELECT 
        cohort_week_start_date AS Cohort_Week_Start_Date,
        COUNT(*) AS cohort_size,
        SUM(is_retained_in_week2) AS retained_users
    FROM user_retention
    GROUP BY Cohort_Week_Start_Date
)

SELECT 
    Cohort_Week_Start_Date,
    ROUND(100 * SAFE_DIVIDE(retained_users, cohort_size), 4) AS Retention_Rate_Percentage
FROM cohort_retention
ORDER BY Cohort_Week_Start_Date
LIMIT 11
```
2025-01-29 20:45:29 - root - INFO - itercount: 1
2025-01-29 20:45:29 - root - INFO - 0
2025-01-29 20:45:29 - root - INFO - results: 
Cohort_Week_Start_Date,Retention_Rate_Percentage
2018-07-09,42.117
2018-07-16,27.2487
2018-07-23,22.853
2018-07-30,19.4481
2018-08-06,19.1736
2018-08-13,22.1154
2018-08-20,16.9102
2018-08-27,23.7956
2018-09-03,27.4178
2018-09-10,17.2737
2018-09-17,19.871


2025-01-29 20:45:29 - root - INFO - Please check the answer again by reviewing Conduct a weekly cohort analysis for user retention starting from July 9, 2018, grouping users by the week of their first session start event. Calculate the retention rates for each cohort in the subsequent two weeks. Specifically, measure the percentage of users from the original cohort who returned in week 2 (two weeks after their first session). Only include users whose first session start event occurred after July 9, 2018. The data is available up to October 2, 2018 (meaning the last cohort group is for the week of September 17, 2018). For this analysis, retention is calculated based on the first session start date, and cohorts are grouped weekly starting from the first session., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Cohort_Week_Start_Date,Retention_Rate_Percentage
2018-07-09,retention1:float
2018-07-16,retention2:float
2018-07-23,retention3:float
2018-07-30,retention4:float
2018-08-06,retention5:float
2018-08-13,retention6:float
2018-08-20,retention7:float
2018-08-27,retention8:float
2018-09-03,retention9:float
2018-09-10,retention10:float
2018-09-17,retention11:float
(Attention: answer in 11 rows)
```

For each weekly cohort starting from July 9, 2018, we calculated the retention rate in week 2 (two weeks after their first session) as the percentage of users who had their first session during the cohort week and returned during week 2 (days 8-14 after their first session week). The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Cohort_Week_Start_Date,Retention_Rate_Percentage
2018-07-09,42.117
2018-07-16,27.2487
2018-07-23,22.853
2018-07-30,19.4481
2018-08-06,19.1736
2018-08-13,22.1154
2018-08-20,16.9102
2018-08-27,23.7956
2018-09-03,27.4178
2018-09-10,17.2737
2018-09-17,19.871
Current sql:
WITH first_sessions AS (
    SELECT 
        user_pseudo_id,
        MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_session_date
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE event_name = 'session_start'
      AND PARSE_DATE('%Y%m%d', event_date) >= DATE('2018-07-09')
      AND _TABLE_SUFFIX BETWEEN '20180709' AND '20181002'
    GROUP BY user_pseudo_id
),

user_cohorts AS (
    SELECT 
        user_pseudo_id,
        first_session_date,
        DATE_TRUNC(first_session_date, WEEK(MONDAY)) AS cohort_week_start_date,
        DATE_ADD(DATE_TRUNC(first_session_date, WEEK(MONDAY)), INTERVAL 7 DAY) AS week2_start_date,
        DATE_ADD(DATE_TRUNC(first_session_date, WEEK(MONDAY)), INTERVAL 13 DAY) AS week2_end_date
    FROM first_sessions
),

user_retention AS (
    SELECT 
        uc.user_pseudo_id,
        uc.cohort_week_start_date,
        IF(
            EXISTS (
                SELECT 1
                FROM `firebase-public-project.analytics_153293282.events_*` ev
                WHERE ev.user_pseudo_id = uc.user_pseudo_id
                  AND ev.event_name = 'session_start'
                  AND PARSE_DATE('%Y%m%d', ev.event_date) BETWEEN uc.week2_start_date AND uc.week2_end_date
                  AND _TABLE_SUFFIX BETWEEN FORMAT_DATE('%Y%m%d', uc.week2_start_date) AND FORMAT_DATE('%Y%m%d', uc.week2_end_date)
            ), 1, 0) AS is_retained_in_week2
    FROM user_cohorts uc
),

cohort_retention AS (
    SELECT 
        cohort_week_start_date AS Cohort_Week_Start_Date,
        COUNT(*) AS cohort_size,
        SUM(is_retained_in_week2) AS retained_users
    FROM user_retention
    GROUP BY Cohort_Week_Start_Date
)

SELECT 
    Cohort_Week_Start_Date,
    ROUND(100 * SAFE_DIVIDE(retained_users, cohort_size), 4) AS Retention_Rate_Percentage
FROM cohort_retention
ORDER BY Cohort_Week_Start_Date
LIMIT 11
2025-01-29 20:45:51 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-29 20:45:51 - root - INFO - ```sql
WITH first_sessions AS (
    SELECT 
        user_pseudo_id,
        MIN(PARSE_DATE('%Y%m%d', event_date)) AS first_session_date
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE event_name = 'session_start'
      AND PARSE_DATE('%Y%m%d', event_date) >= DATE('2018-07-09')
      AND _TABLE_SUFFIX BETWEEN '20180709' AND '20181002'
    GROUP BY user_pseudo_id
),

user_cohorts AS (
    SELECT 
        user_pseudo_id,
        first_session_date,
        DATE_TRUNC(first_session_date, WEEK(MONDAY)) AS cohort_week_start_date,
        DATE_ADD(DATE_TRUNC(first_session_date, WEEK(MONDAY)), INTERVAL 7 DAY) AS week2_start_date,
        DATE_ADD(DATE_TRUNC(first_session_date, WEEK(MONDAY)), INTERVAL 13 DAY) AS week2_end_date
    FROM first_sessions
),

user_retention AS (
    SELECT 
        uc.user_pseudo_id,
        uc.cohort_week_start_date,
        IF(
            EXISTS (
                SELECT 1
                FROM `firebase-public-project.analytics_153293282.events_*` ev
                WHERE ev.user_pseudo_id = uc.user_pseudo_id
                  AND ev.event_name = 'session_start'
                  AND PARSE_DATE('%Y%m%d', ev.event_date) BETWEEN uc.week2_start_date AND uc.week2_end_date
                  AND _TABLE_SUFFIX BETWEEN FORMAT_DATE('%Y%m%d', uc.week2_start_date) AND FORMAT_DATE('%Y%m%d', uc.week2_end_date)
            ), 1, 0) AS is_retained_in_week2
    FROM user_cohorts uc
),

cohort_retention AS (
    SELECT 
        cohort_week_start_date AS Cohort_Week_Start_Date,
        COUNT(*) AS cohort_size,
        SUM(is_retained_in_week2) AS retained_users
    FROM user_retention
    GROUP BY Cohort_Week_Start_Date
    ORDER BY Cohort_Week_Start_Date
    LIMIT 11
)

SELECT 
    Cohort_Week_Start_Date,
    ROUND(100 * SAFE_DIVIDE(retained_users, cohort_size), 4) AS Retention_Rate_Percentage
FROM cohort_retention;
```

```csv
Cohort_Week_Start_Date,Retention_Rate_Percentage
2018-07-09,42.1170
2018-07-16,27.2487
2018-07-23,22.8530
2018-07-30,19.4481
2018-08-06,19.1736
2018-08-13,22.1154
2018-08-20,16.9102
2018-08-27,23.7956
2018-09-03,27.4178
2018-09-10,17.2737
2018-09-17,19.8710
```
2025-01-29 20:45:59 - root - INFO - itercount: 2
2025-01-29 20:45:59 - root - INFO - 0
2025-01-29 20:45:59 - root - INFO - Total iteration counts: 2
