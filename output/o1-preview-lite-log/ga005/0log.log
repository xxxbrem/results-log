2025-01-29 20:43:43 - openai._base_client - INFO - Retrying request to /chat/completions in 0.412070 seconds
2025-01-29 20:44:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-29 20:44:46 - root - INFO - SQL:
SELECT DISTINCT `event_name`
   FROM `firebase-public-project.analytics_153293282.events_*`
   LIMIT 100
Results:
event_name
ad_reward
challenge_a_friend
os_update
in_app_purchase
user_engagement
level_fail_quickplay
completed_5_levels
session_start
select_content
level_complete_quickplay
level_complete
level_reset
firebase_campaign
challenge_accepted
level_retry_quickplay
use_extra_steps
app_remove
dynamic_link_first_open
app_clear_data
spend_virtual_currency
first_open
level_start
level_end
level_end_quickplay
level_reset_quickplay
app_update
dynamic_link_app_open
notification_foreground
screen_view
level_start_quickplay
post_score
level_up
level_retry
level_fail
app_exception
no_more_extra_steps
error

2025-01-29 20:44:52 - root - INFO - SQL:
SELECT `user_pseudo_id`, `event_timestamp`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start'
   LIMIT 100
Results:
user_pseudo_id,event_timestamp
9454C88D30154AF624E046D5C408797C,1536060531637000
525E3BEE74AD824923CC04FE45E45B40,1536109337485000
34ADF71F1AADCA26EC8008496F7CC87E,1536121800134000
C7DD86F06FD4AA8A0967E27E20750FCD,1536058109409000
841727B396264112EC75FEB26C57E25C,1536044648638000
7E74A2BB6BBF4746DEE15F957B315401,1536060224703000
7E74A2BB6BBF4746DEE15F957B315401,1536125855726000
17636078D57884AD7EA5406C60E2BD10,1536084452523000
873A800A72529CC5F0AA4B7B226A263F,1536121501221000
AF06A87FD3FD797F7FA3A44DFC445701,1536049969256000
5ACF1A6BFE350F7BB661BF389AF7E2F0,1536084880984000
1CEA99018BB20A7A426C128C1E972731,1536085136061000
A6F93D542BC785A045FD8B94CC3CFEC8,1536087160646000
A6F93D542BC785A045FD8B94CC3CFEC8,1536106523250000
FA30269453141794E79B8F15EE0BA5B9,1536060214577000
FA30269453141794E79B8F15EE0BA5B9,1536101286368000
FA30269453141794E79B8F15EE0BA5B9,1536115678468000
D76E55DD6D27E0A117FC536C0DC67677,1536092512760000
BE36C49B1AB3968D420923AEC4FDD7AE,1536044643965000
B281031313D47AC55834EC34B3802E68,1536079809858000
DE0CCACD4BB0DBB022445718217A0819,1536076114744001
1E1B4ADDF74F207EB5665FF0FAA02DD6,1536097901275000
90E348A71BE256C926E1F8A86314D583,1536120271601001
418C1FE4FF01EA36F511E5D9073F11BD,1536061558590000
418C1FE4FF01EA36F511E5D9073F11BD,1536109432539000
904877128B8889DDD71A38BDBCD21724,1536052942138000
904877128B8889DDD71A38BDBCD21724,1536072268460000
904877128B8889DDD71A38BDBCD21724,1536074452021000
904877128B8889DDD71A38BDBCD21724,1536126491366000
904877128B8889DDD71A38BDBCD21724,1536129447642000
1B2FC37816CC4DDAACA97A75E685756F,1536111502378000
B71CB5D517BE99FEEED64A0F57842032,1536122719027000
037DAC225F0C1E54657770CD201CDDA7,1536088265621000
4D6582BFA74C0705C44ED36CCB8CE527,1536092030260000
1E9F6BA9BD8C45633C26F42995A77775,1536071883575000
E70E3F402C9F812B2735740C621D79EE,1536065709501000
E70E3F402C9F812B2735740C621D79EE,1536087157556000
E70E3F402C9F812B2735740C621D79EE,1536089781386000
3682C2527BEE6BA0255321BB25DF44BB,1536129004220000
343B740C7B3BD9C2CFA46BF097A8856E,1536104155523000
FEDC59699D8832A11B88BFCCCAD0951D,1536068746877000
53866E32BA0ABFD846772D4B7B9B5921,1536060915219000
50D529BFD3EFEB1C8216DF9A321A552A,1536047240570000
50D529BFD3EFEB1C8216DF9A321A552A,1536108168654000
50D529BFD3EFEB1C8216DF9A321A552A,1536112786549000
3EDE8E7A50DE76AA2EC12DDD2AE3F9F4,1536092386728000
FC46AD58407EF0D1DAA6281AB4DE03A1,1536064357555001
39AE34F91B29542A8F0488F5B787B70F,1536115771287000
E4196C5E0A92A22F69DE4E3AA288D6EE,1536115635154000
3875A92B5F5C2BBA1355CED06A986079,1536049905479000
3875A92B5F5C2BBA1355CED06A986079,1536064508094000
3875A92B5F5C2BBA1355CED06A986079,1536105938205000
3875A92B5F5C2BBA1355CED06A986079,1536112516171000
3875A92B5F5C2BBA1355CED06A986079,1536116633694000
3875A92B5F5C2BBA1355CED06A986079,1536121132827000

2025-01-29 20:44:59 - root - INFO - SQL:
SELECT `user_pseudo_id`, `event_date`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
   LIMIT 100
Results:
user_pseudo_id,event_date
3376C102EBF491B5CB84B43759FE3433,20180802
023A2DB99CC3F70A4B71869C36952D74,20180802
023A2DB99CC3F70A4B71869C36952D74,20180802
4500595CA1FC3CBC6140A502240FB7B4,20180802
8C648AA8E1BED4F1A904777CD622F4FF,20180802
FC55032FC8C06EB1A1220D1ABD1164C9,20180802
9BC94B3773C8304A9E101AEBCFEF4A5F,20180802
9BC94B3773C8304A9E101AEBCFEF4A5F,20180802
295D9E24D8DE65A010313E667131EF19,20180802
295D9E24D8DE65A010313E667131EF19,20180802
295D9E24D8DE65A010313E667131EF19,20180802
295D9E24D8DE65A010313E667131EF19,20180802
5B4FD8662DAD71406319200659FDF420,20180802
E2B530ADD7430BEA6BC7F3D431C8A6FF,20180802
4BB019F8F6D1FE7BA78CA42A4698EF56,20180802
4BB019F8F6D1FE7BA78CA42A4698EF56,20180802
4CDB160C7A0483695AE6DB265C4E038F,20180802
9CED4A9B9E6B7ED5CCE07F6D752048E1,20180802
EACCA0856B7B7B2AEC2CB1808C1034E5,20180802
EACCA0856B7B7B2AEC2CB1808C1034E5,20180802
980DEC5BA17132A841D7D7A140333114,20180802
980DEC5BA17132A841D7D7A140333114,20180802
D69EBD56ECD257924A112BA6FDB75D27,20180802
5FC2FB966B4EF39E4FD7FDB6333714DC,20180802
9DE7361ACCDEA6541AD5EA55D59B1C78,20180802
9DE7361ACCDEA6541AD5EA55D59B1C78,20180802
9DE7361ACCDEA6541AD5EA55D59B1C78,20180802
4A93C01615B33FF5804AF8D19895247F,20180802
4A93C01615B33FF5804AF8D19895247F,20180802
7BD92FD0756E6D260B45D7B6D9670C17,20180802
5E9B9E20975EF45745B511D401456619,20180802
F3917138A3D4B03ADA1C2E77E3B84649,20180802
DA426D16B0EAB27DE1AC9D6E3418F400,20180802
DA426D16B0EAB27DE1AC9D6E3418F400,20180802
F7440C5660BC904383AFC518162113D0,20180802
53BB2C3D9C62AD1169788AF86C59750D,20180802
A6F3AC0345F0D29697A0E517CB4DC507,20180802
A6F3AC0345F0D29697A0E517CB4DC507,20180802
B99FD965B0874192EE94E8A8FE85EA9E,20180802
706C748E6D1E0768BFEFE6362B5D3F67,20180802
706C748E6D1E0768BFEFE6362B5D3F67,20180802
706C748E6D1E0768BFEFE6362B5D3F67,20180802
B05B44F98AC43EA887A1B78C3552A927,20180802
B05B44F98AC43EA887A1B78C3552A927,20180802
F815B0069F973BFA743EF90A85224109,20180802
D0F280B12652EB0D74F6BC74AB13606F,20180802
54405BB87CA5EE368EB42F411323631F,20180802
54405BB87CA5EE368EB42F411323631F,20180802
5A3C1C538553B1A5108163C4EB7F8D39,20180802
3EF8FC940E379D53BBD3FEFDAF626BB2,20180802
E6FEE8B98E75EA5311FE004F98559A27,20180802
6A2F4E7AB1816D2F6EC741BC92141766,20180802
6A2F4E7AB1816D2F6EC741BC92141766,20180802
6A2F4E7AB1816D2F6EC741BC92141766,20180802
67EBFEC8E68ED6187FFAD137465A3638,20180802
48AB910A8DE8485D4C34238EA61F782C,20180802
48AB910A8DE8485D4C34238EA61F782C,20180802
48AB910A8DE8485D4C34238EA61F782C,20180802
FA30269453141794E79B8F15EE0BA5B9,20180802
FA30269453141794E79B8F15EE0BA5B9,20180802
FA30269453141794E79B8F15EE0BA5B9,20180802
FA30269453141794E79B8F15EE0BA5B9,20180802
35CF08DA631AC27582D6A0FE710131F7,20180802

2025-01-29 20:45:05 - root - INFO - SQL:
SELECT `event_date`, COUNT(*) AS `session_count`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
   GROUP BY `event_date`
   ORDER BY `event_date`
   LIMIT 100
Results:
event_date,session_count
20180709,580
20180710,613
20180711,593
20180712,620
20180713,640
20180714,554
20180715,539
20180716,535
20180717,495
20180718,520
20180719,484
20180720,574
20180721,636
20180722,533
20180723,587
20180724,582
20180725,552
20180726,550
20180727,616
20180728,607
20180729,662
20180730,632
20180731,585
20180801,608
20180802,690
20180803,692
20180804,688
20180805,667
20180806,628
20180807,619
20180808,669
20180809,621
20180810,477
20180811,584
20180812,611
20180813,685
20180814,605
20180815,568
20180816,613
20180817,617
20180818,637
20180819,604
20180820,641
20180821,630
20180822,625
20180823,588
20180824,646
20180825,653
20180826,618
20180827,685
20180828,638
20180829,696
20180830,656
20180831,618
20180901,579
20180902,648
20180903,637
20180904,659
20180905,741
20180906,707
20180907,700
20180908,689
20180909,719
20180910,724
20180911,655
20180912,780
20180913,694
20180914,636
20180915,598
20180916,641
20180917,640
20180918,662
20180919,720
20180920,637
20180921,729
20180922,683
20180923,764
20180924,659
20180925,673
20180926,688
20180927,803
20180928,630
20180929,675
20180930,679
20181001,656
20181002,653
20181003,648

2025-01-29 20:45:11 - root - INFO - SQL:
SELECT DISTINCT `user_pseudo_id`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
   LIMIT 100
Results:
user_pseudo_id
9BC94B3773C8304A9E101AEBCFEF4A5F
73980AF5B8954128337EB065CE75C773
4A93C01615B33FF5804AF8D19895247F
C73D0BE8A6C303863FCE487F9996028C
26FACA90F8AA62D614E65FD30CD978AB
E5AFF3DE508996512D61B49A63D1D063
5F36B447AE0BD99BD05B4E84B057E556
3A4F5028A0CA512C0E2CCA1F36CE160D
6EDEC26E3CD2B1484254B15917E9F19B
C9CA9887D6B75FC79B920F29B5237CE1
214980227844539E15ABC4C4F3A79C28
C7BD490452F7CBF2D49339DF6F53072D
EB1A430BACB37E6EA72592BF838E64A6
80D8B94D9BCBA0C07218A15293BC91B9
520471500948F8B932423DE86347D2C1
004D2DFEB866BFB00427DB2F530C1F3D
27AABF18BF07DE5DCACA40BDAFCD21E1
04C1B862AFA39703243166C625EBBD40
080DB8B23066DE56D78C5F570FF5A019
40B501E0460E254E289A776CFC31DCF2
E6B6CAE2D200FC3EACF21DDE75402DCD
148AAE2C85735FF43C7590EC37054C17
C80CEE0983AB5B21D3F4B46089FDD9EB
7ED8C235689771F6B0F29BBF295A346F
C96C96A3BFA142C6B393183BDB2B9DDB
32E3FFAC452648CA8600591F432B926B
0C777BD44F304574371C97674DCD0702
8F6C5F7611B67A4A437FF283B6C10181
A19F659EA9BA36A3595F088F30A6B7E7
620DA7A49F07368EBCB917DB113BCEDC
80810BB18ADB73C9585D86058958AF35
788B593C9AFEBAEE6374CDA08F16FAC6
3376C102EBF491B5CB84B43759FE3433
8C648AA8E1BED4F1A904777CD622F4FF
D34924C19421D7E083FD387D97765F94
23A7E8D987ADCC38EB026096DC513F85
9278A7C15D0307622E7A0305C4091A91
4C3EAB9FC779FA2790F618E3D6AFC499
D3F06F9B7BD9D7FC8758BF78BF0705E9
17DC0E89E3ECED8B312BCC88BCE23548
490F592DDAB95F2590917ACA94B377C6
52556201335DD5EB3D333F4065503C3C
F47CF9AFCC314481CAF183DC6836965E
B2AC10B655AA834B86A4617280DD57D8
4C18E92173DBE0764C2CC29D174E3A46
B44CE073B21086F04503B93E25448C84
5EBF8502142E66A011B97904BE28B5DB
1CF315BC6864E7A71A81E47925E18A61
46B5EAFD9FE97971DE35E6A1876B7963
35DE008317AB2760503976FA63F51B61
6281B5ECD3AE4FEDA451D682B2EE0310
C464722AE0E9423DE721E72B8A524141
E59C013E06CD767FD8A536E288DF2780
17934EF7C1BC1CF2C7D942401FDE84CE
3B21B398D6518D48AD878537495DFADF
00D49153E0790E34D76523EEBEF459B2
5FED8FE4B11878AAFC4E53BDA3FBB56D
3BE174EF49A2015E782228B3E02E3CDA
0ED6BC1D319AB5BD1F245628EA47EDBB
A78340D66F35B9692E956BC94D20332D
7EAE2B4599B94A807DA2AF393F036C65
2B085FA1A52991A730A32F0C87F474D6
27EBD3EEECD253B2A30B2255280DD32D
5C2D9F2166A128926CB802B0941EF4C6
E5A284CF837E6F0973B9B7AE22561CDE
74DCDBEC89234F0E83AF6AD036DB27D0
52E08E4A2847DA44180FB6E41E91503D
4CC7B06FC12175C31ECBE1987A48DEA3
68C5F7CFAEAB93924B7B55D7129C0286
34587F7996F20BE4CC7DDEB96753D110
1CE03BB4BFFE9960A4E94D81D89355BC
F5E70A3073EA182872DD0BE8D8AB1786
F32D308B369814D18336A1ED6AF040E8
ED02B5FFD68A3242B0F6FDED925CD5DB
3346097B57AC50FEC68D31230E17BA39
F37E38D7873B155B9E405726147358B2
4EE0015622A90E4D434B33508394FC2E
8CCA0719F08368F316CB951B266ED5FC
AE3F42E7ED917EE6F5216DC1C79EA63C
AD0F414A967E7478F1CF2ED1B145F4AD
9FE14774A6A768A1C1BEBCE0DE0669A5
2201BA84231D7CC8147F47074DF99E1F
3C61120F4C807953BAE7A32CCE144B9B
7740CD7CDD8F6CD275974FC8C81065CD
30851A76407C708D397A7D2341980D37
E24D750CDF314F2688DC53B0ECB162FE
61879BEF3B028659993A9A1F399BFF77
6AA133F6731526630B1D51BF557E485B
EFF25E323404995318BF89248DC78753
44D4588D33F83DDF05E6FD25DD38B7C2
B0B8369C7B317332A28A914D018BD475
FD239DEE719F5BDDF4BC9381C6B84220
89BBCC1FFE24293BAA9904AC5BE09D0A

2025-01-29 20:45:18 - root - INFO - SQL:
SELECT `user_pseudo_id`, TIMESTAMP_MICROS(`event_timestamp`) AS `event_time`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
   LIMIT 100
Results:
user_pseudo_id,event_time
AF4F16A9D1C2CA93686E7CBD2EB349E3,2018-09-08 02:12:34.072001+00:00
AF4F16A9D1C2CA93686E7CBD2EB349E3,2018-09-08 05:43:51.185000+00:00
AF4F16A9D1C2CA93686E7CBD2EB349E3,2018-09-08 06:39:51.329000+00:00
295D9E24D8DE65A010313E667131EF19,2018-09-08 04:43:39.649000+00:00
FFD44153572065E379B7E96916F730B8,2018-09-07 15:50:26.797000+00:00
980DEC5BA17132A841D7D7A140333114,2018-09-07 14:07:00.660000+00:00
26C6707A34999C33D68CB0AB07341DB6,2018-09-07 10:33:56.625000+00:00
7E74A2BB6BBF4746DEE15F957B315401,2018-09-08 05:08:41.311000+00:00
17636078D57884AD7EA5406C60E2BD10,2018-09-07 14:13:49.668000+00:00
4BF98D09CA8359FC59ADAF56D00338F8,2018-09-07 15:59:18.811000+00:00
4BF98D09CA8359FC59ADAF56D00338F8,2018-09-07 17:55:25.524000+00:00
4BF98D09CA8359FC59ADAF56D00338F8,2018-09-07 19:32:55.247000+00:00
4BF98D09CA8359FC59ADAF56D00338F8,2018-09-07 20:48:58.012000+00:00
94B02BA3020E382B3456932FA88A03AC,2018-09-08 00:34:15.330000+00:00
F9B1FEA75B896DA727BC733173B19D60,2018-09-08 04:49:16.079000+00:00
1CF315BC6864E7A71A81E47925E18A61,2018-09-07 12:47:28.691000+00:00
FA30269453141794E79B8F15EE0BA5B9,2018-09-07 13:44:45.572000+00:00
0A26E7281EC31038AD42F28C930FFF90,2018-09-07 19:12:51.293000+00:00
0A26E7281EC31038AD42F28C930FFF90,2018-09-07 21:48:43.710000+00:00
0A26E7281EC31038AD42F28C930FFF90,2018-09-07 22:35:48.691000+00:00
0A26E7281EC31038AD42F28C930FFF90,2018-09-08 06:01:42.099000+00:00
BE36C49B1AB3968D420923AEC4FDD7AE,2018-09-07 07:21:27.191000+00:00
BE36C49B1AB3968D420923AEC4FDD7AE,2018-09-07 10:14:28.840000+00:00
459FD97ABE14D7762CD58C3A3104D183,2018-09-07 15:33:53.914000+00:00
E5AFF3DE508996512D61B49A63D1D063,2018-09-07 10:15:46.352000+00:00
5145D8121071A9EA903A1098034962F6,2018-09-07 19:25:08.501000+00:00
5145D8121071A9EA903A1098034962F6,2018-09-07 22:54:37.521000+00:00
A0EDEFE9E2CC092F97266CDF9DB5830F,2018-09-07 21:24:46.834000+00:00
F0186BDA8E7BF76675999CFDCFB10F6B,2018-09-07 09:57:22.504000+00:00
F0186BDA8E7BF76675999CFDCFB10F6B,2018-09-07 12:02:50.750000+00:00
418C1FE4FF01EA36F511E5D9073F11BD,2018-09-07 17:03:08.044000+00:00
418C1FE4FF01EA36F511E5D9073F11BD,2018-09-08 00:56:10.671000+00:00
904877128B8889DDD71A38BDBCD21724,2018-09-07 17:08:29.563000+00:00
904877128B8889DDD71A38BDBCD21724,2018-09-08 00:30:55.167000+00:00

2025-01-29 20:45:24 - root - INFO - SQL:
SELECT `user_pseudo_id`, MIN(TIMESTAMP_MICROS(`event_timestamp`)) AS `first_session_time`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
   GROUP BY `user_pseudo_id`
   LIMIT 100
Results:
user_pseudo_id,first_session_time
9DFCDD335DDCAAF5987FC07F7927BF34,2018-07-12 10:19:27.198000+00:00
D1F53693AA457A127407EBA024A07EE4,2018-07-12 04:58:15.013000+00:00
FFA9AE78B23263835F8AAED57713EBE9,2018-07-11 13:53:18.202000+00:00
0AF862AFEB5358EBFDA7AFE3AC908844,2018-07-10 13:54:56.284000+00:00
81D3DD49AA2304FD1ED8C498747B5FC6,2018-07-09 11:57:02.369000+00:00
93F2362648919544175333B636156F52,2018-07-11 01:39:23.121000+00:00
372D9BB5088C4E9000C65B06459B403A,2018-07-09 09:02:49.064000+00:00
C1648883A80997B611743D528CBFF926,2018-07-12 20:29:59.193000+00:00
301F195A323A825ED893DAC478C3B919,2018-07-12 13:49:17.878000+00:00
091770A1325101155A651F90D283DA35,2018-07-10 10:25:40.787000+00:00
5EB709BD6D577B03B138AF80E55ECB5B,2018-07-13 01:20:34.061000+00:00
9DE945166BCD4709696C5836317DDE47,2018-07-10 12:18:21.116000+00:00
DAA3F353F320A717A0C418A8205292B2,2018-07-11 12:10:40.647000+00:00
707AA337DA532FC4DFFED03866DF879F,2018-07-12 23:50:43.212000+00:00
D7EA8E3645EFFBD6443946179ED704A6,2018-07-09 12:42:22.840000+00:00
5788A16A3FF89DFC642034165C8932D8,2018-07-13 00:48:16.751000+00:00
E7CCB643C1D0028BF305EDD85397255E,2018-07-13 04:13:50.571000+00:00
7BAB96908472EF544DAC0E1951E96E84,2018-07-12 15:23:21.963000+00:00
FAB66F3229CC381629D6C426F9171D24,2018-07-12 21:53:56.952000+00:00
3A6736FD849F931397512E4693AE829B,2018-07-12 13:13:42.810000+00:00
03A9D32C44665A9E15CFCCEDC9F68EDB,2018-07-09 10:04:57.716000+00:00
F91F493916395FE4E16DE98B24388985,2018-07-09 16:04:43.831000+00:00
D842320AECB686B41C2F8E8876794D34,2018-07-10 04:34:05.093000+00:00
158D85747B252579015AE58305CBC8C1,2018-07-12 22:44:07.016000+00:00
EF0FBB41BE6F40A5CC1D68D8E1CD3591,2018-07-12 19:34:55.887000+00:00
C639CACA07D03F536F537ED779CF6599,2018-07-09 16:05:22.983000+00:00
C09F04828B07E4DFEF39DA5C4A976A90,2018-07-12 18:20:46.361000+00:00
278F45BFDAAC6EA9CED0999482E5C93E,2018-07-12 21:27:39.656000+00:00
D4C8E3E0EFC45C3D60AB3F0F305489AF,2018-07-12 07:04:25.205000+00:00
8F46EE0FFE423C4FA11B40E99045A05E,2018-07-12 14:22:47.978000+00:00
91D637F0D9FB259AD52773B1B20151BE,2018-07-10 11:11:42.748000+00:00
38232364F572A6A7820F31485458BE69,2018-07-12 21:05:09.211001+00:00

2025-01-29 20:45:31 - root - INFO - SQL:
SELECT `event_date`, COUNT(DISTINCT `user_pseudo_id`) AS `unique_users`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
   GROUP BY `event_date`
   ORDER BY `event_date`
   LIMIT 100
Results:
event_date,unique_users
20180709,380
20180710,405
20180711,390
20180712,403
20180713,422
20180714,358
20180715,360
20180716,352
20180717,324
20180718,344
20180719,309
20180720,385
20180721,439
20180722,372
20180723,389
20180724,389
20180725,361
20180726,369
20180727,419
20180728,418
20180729,444
20180730,433
20180731,392
20180801,393
20180802,450
20180803,489
20180804,474
20180805,450
20180806,439
20180807,426
20180808,450
20180809,416
20180810,326
20180811,406
20180812,415
20180813,455
20180814,395
20180815,368
20180816,404
20180817,411
20180818,438
20180819,410
20180820,420
20180821,424
20180822,406
20180823,376
20180824,440
20180825,443
20180826,416
20180827,438
20180828,422
20180829,447
20180830,443
20180831,412
20180901,406
20180902,444
20180903,428
20180904,420
20180905,477
20180906,461
20180907,488
20180908,476
20180909,501
20180910,483
20180911,424
20180912,500
20180913,452
20180914,434
20180915,389
20180916,417
20180917,424
20180918,450
20180919,481
20180920,413
20180921,487
20180922,477
20180923,525
20180924,427
20180925,450
20180926,472
20180927,573
20180928,450
20180929,468
20180930,472
20181001,431
20181002,442
20181003,428

2025-01-29 20:45:38 - root - INFO - SQL:
SELECT `user_pseudo_id`, COUNT(*) AS `session_starts`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
   GROUP BY `user_pseudo_id`
   ORDER BY `session_starts` DESC
   LIMIT 100
Results:
user_pseudo_id,session_starts
3875A92B5F5C2BBA1355CED06A986079,361
EB1A430BACB37E6EA72592BF838E64A6,350
EF500E0CF578004836D1D38C8901862B,327
CA04708DA02378999ECB402481FF1AE4,300
10B0D468B5E036E16D13DB53A65F2D49,283
FA30269453141794E79B8F15EE0BA5B9,281
472451071AED6FF801BC0FE66706FD27,278
959635567E419A061EECCCA478EDC718,278
B5395F8C2077B59B3D6C5719C0CA0339,277
372D9BB5088C4E9000C65B06459B403A,256
DA48D36D07835B1918BDF831AF83B5EF,249
05FB3382D94C7E963B408FD6CC357D33,245
74375465CD17299EBC7C75A1B4047EE0,244
EFB696A82D093B3AFBE92FF526DD5CEA,232
0C777BD44F304574371C97674DCD0702,225
0CAAA1B6F161BA4D363EB7A2DEF64A08,208
682A8CD0767A569DC68E7AA0201BFBA3,207
A0616D4E494DC3BCCB94B8B6E5B48380,203
13E6C8A193FF140F7D4222B569DD5B50,202
0E05F56141200FF41FCC0C7FA297FF08,201
F5DAD8DD17B689CF672D65A0A81CF4AC,195
40B501E0460E254E289A776CFC31DCF2,189
03A9D32C44665A9E15CFCCEDC9F68EDB,184
48AB910A8DE8485D4C34238EA61F782C,182
C80CEE0983AB5B21D3F4B46089FDD9EB,182
735123CE7AF980AD5B43F31CAF2890A0,171
CFA0F8C5E25A71062E573EF8E6BC9F76,169
487DE902636DD8A9844A2D61FE7BD568,163
2CA82928A35949DF7775D4BC04F0AEA1,162
DA856449658776EC6410C178742F54D7,160
229254D7C810F98F72C89A8060E194D4,150
42E6A7C3536775E3B8C3DB919AE9A452,149
0D17D0247F158FA3E40D21EFF46D1651,146
DF0E6C6C5E4F3F34FEC6EE54FD945B05,142
AD99B4950F9D70E0FD5E8563F2A664FB,141
47216088A078D06F9220263FAF964F10,140
8211CABE9A3F1FE1BF3154E0C8D30368,135
3B4A6FCA6DCB4C2749409DC4188A306E,131
E594F4CE9B23146A461021258CC7ACA2,126
328DC7FE55E8881B2EA668C9A2855BB7,125
724B99CB6F41846F3F6BB46C2F663F5E,123
E0664E9E7883956A6E3084FD68AA274B,123
BE36C49B1AB3968D420923AEC4FDD7AE,122
57EC50FBC6C7277B8EDCCE44C1352BD4,122
3DEB0C12C49AD19D7ACE68FA59E7ACD6,120
E4196C5E0A92A22F69DE4E3AA288D6EE,117
8D9D62A4402581BB1181D3AA73AD54E8,115
2F74E23BEA1E45E3897274EE4903DCC5,115
F655D26B0F7A4093F1D2FFBD5E61B09D,114
12E5626928FE0885DEEF068683E8BD63,113
C7E2273D8B11257FCCC915D27C1FCA24,113
74EFA3B9E98982CB94246D7F95DF29D0,111
C74B58C4CD2770A1E97D6DC13D42CCAC,107
0A26E7281EC31038AD42F28C930FFF90,104
295D9E24D8DE65A010313E667131EF19,104
86A6C9FB1A0C566CA168149788E71EFD,104
59454BAC415BB1F18517C6FD2C023E49,102
932AAF56DDE9C55359B9CCFA18E7FB95,102
5E09265F12D64B9FA85FF9427A0A7FB0,98
3D1B58553D2E2D4DD5DFCF251D5E23B2,96
A74C05E503F6274BAA9457B2265471F5,96
B63075B53A750A67A12F7F19ED5AA835,95
89BD2B0E233951461CF06C9B4FDA0D81,95
343B740C7B3BD9C2CFA46BF097A8856E,95
1213ED1E96B0A49B51C0F7683DB2ACCC,94
635808C1DDFBC662DC3015097E26E62A,94

2025-01-29 20:45:44 - root - INFO - SQL:
SELECT `user_pseudo_id`, DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))) AS `first_session_date`
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
    GROUP BY `user_pseudo_id`
    LIMIT 100
Results:
user_pseudo_id,first_session_date
5217AB1A454DAED6243E1C9818BE6A20,2018-07-09
0155220BAB309646CC7AC980AB75A212,2018-07-16
17636078D57884AD7EA5406C60E2BD10,2018-08-04
448F4402131C2DE70EC67F04D4BF5719,2018-07-28
2D644942A18A482A9AD370DA9F38B709,2018-08-06
BCEC642620FB741AA4EE43E0FC6C7A05,2018-07-15
1B959D672ABAE4A3BFB9D720D415E064,2018-08-04
C052BC38A0F39A40678E5AF5E7C84B77,2018-07-28
117AD1627465CC9E03AB5D8825D42E07,2018-07-12
488BE19C45D3D8B2DF02214BC19B44B4,2018-07-09
E512079B53179DF9A608CF4ADE47DE9D,2018-07-09
98578513E0F25350F961CDCBA9D3656F,2018-07-10
D6AE9E820354B2F2C1C3D94EF8958E58,2018-08-02
B2F661E88136265632545A030F09A88A,2018-08-05
1010A9A4D76FDDAB3C456113CC4E6C95,2018-08-06
487DE902636DD8A9844A2D61FE7BD568,2018-07-10
1B3AD9683D475EFB398E131DFE65AE61,2018-07-09
A20E7E669E319B0A1912A187C4169AEE,2018-08-06
24D41A78A6BB1244608DB32351B0658B,2018-07-17
136F2C0A18FA7D6A967EEBDC2C7E3346,2018-08-05
9BD663F05EA7660B40800C28E2BF59FC,2018-07-29
DF2C3B7E8FB37490F6F265867863951C,2018-07-13
2B9E05C9A73CE9EFCADC80CE582ADBA6,2018-08-06
37DEF17DD3761C66B7F56806F978E726,2018-07-10
A66F392F752B3A59F2644F4158644FF1,2018-08-06
01C784BDB7AF4DC8DAD6DCD21AF56E25,2018-07-12
E9DCE2D958652BD58E846DCE86BDD90A,2018-07-09
B7706BCDE12360F565E9F5DB0A5256D8,2018-07-21
31017A05A48B25FED4834F968D5D0F83,2018-07-30
E53BC2A0AD86417B443AF14EE3082C0F,2018-07-13
38383D77F69C1CAA39B0CAC891CB0E0B,2018-08-04
A6E7F3C2692459390F24A912B447B433,2018-08-07
2B86004D342C2EA67F3164372314F0C4,2018-07-09
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-08-08
2F0F260BD7B876C346B41977D0D03D62,2018-07-09
3883FF0DFAB40ECD4EA781FC0D1CE18A,2018-08-22
FA53C0AFAB68963E843CD8CB6828732D,2018-08-26
E659018965C45C6546EAC732D07DABB3,2018-08-24
EACCA0856B7B7B2AEC2CB1808C1034E5,2018-07-22
27951B102A564E3FF875726564A141FF,2018-08-20
A328A685EE92F31EE8F821757E643258,2018-08-26
7548E849537562672CF9C567B9C0EC87,2018-07-10
1EA594389C7D0B4A2C68817830B0FE81,2018-08-26
91F5161F80D1083CA7B37A08DEC9EC78,2018-07-18
528939A93F1D3693AD8A56F340B7D777,2018-08-04
55BF8BB2457C1E8B554058947A484334,2018-08-26
8375B114AFAD8A31DE54283525108F75,2018-08-18
E17CB4D71A4A2CD6C79933EAC4988694,2018-08-27
E6228DCFB35D51F80DFED104E56F0C36,2018-07-18

2025-01-29 20:45:51 - root - INFO - SQL:
SELECT `user_pseudo_id`, ep.key, ep.value.string_value
    FROM `firebase-public-project.analytics_153293282.events_*` AS t,
    UNNEST(t.event_params) AS ep
    WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
    LIMIT 100
Results:
user_pseudo_id,key,string_value
56F37FD95FB21AB3976C83E803D7AEA7,firebase_conversion,
56F37FD95FB21AB3976C83E803D7AEA7,firebase_screen_class,FIRootViewController
56F37FD95FB21AB3976C83E803D7AEA7,firebase_event_origin,auto
56F37FD95FB21AB3976C83E803D7AEA7,firebase_screen_id,
40BA3CE848E99626DACC46BCCEE3E568,firebase_conversion,
40BA3CE848E99626DACC46BCCEE3E568,firebase_screen_class,FIRootViewController
40BA3CE848E99626DACC46BCCEE3E568,firebase_event_origin,auto
40BA3CE848E99626DACC46BCCEE3E568,firebase_screen_id,
C2D9D55F57CC8CFF60599E1928594368,firebase_conversion,
C2D9D55F57CC8CFF60599E1928594368,firebase_screen_class,level_select
C2D9D55F57CC8CFF60599E1928594368,firebase_event_origin,auto
C2D9D55F57CC8CFF60599E1928594368,firebase_screen_id,
A8D7DCCA39D8703F2928AD2D7BBB6BE9,firebase_conversion,
A8D7DCCA39D8703F2928AD2D7BBB6BE9,firebase_screen_class,main_menu
A8D7DCCA39D8703F2928AD2D7BBB6BE9,firebase_event_origin,auto
A8D7DCCA39D8703F2928AD2D7BBB6BE9,firebase_screen_id,
062964F7169622E4AEC91756FFB8261B,firebase_conversion,
062964F7169622E4AEC91756FFB8261B,firebase_screen_class,main_menu
062964F7169622E4AEC91756FFB8261B,firebase_event_origin,auto
062964F7169622E4AEC91756FFB8261B,firebase_screen_id,
2684EA4DDB1F988E3C979AB15CFF601F,firebase_conversion,
2684EA4DDB1F988E3C979AB15CFF601F,firebase_screen_class,FIRootViewController
2684EA4DDB1F988E3C979AB15CFF601F,firebase_event_origin,auto
2684EA4DDB1F988E3C979AB15CFF601F,firebase_screen_id,
CB06B751DAD44BB7F228F8474686D404,firebase_conversion,
CB06B751DAD44BB7F228F8474686D404,firebase_screen_class,FIRootViewController
CB06B751DAD44BB7F228F8474686D404,firebase_event_origin,auto
CB06B751DAD44BB7F228F8474686D404,firebase_screen_id,
CB06B751DAD44BB7F228F8474686D404,firebase_conversion,
CB06B751DAD44BB7F228F8474686D404,firebase_screen_class,main_menu
CB06B751DAD44BB7F228F8474686D404,firebase_event_origin,auto
CB06B751DAD44BB7F228F8474686D404,firebase_screen_id,
5358D124C06358BCD5FEF67C87052AC2,firebase_conversion,
5358D124C06358BCD5FEF67C87052AC2,firebase_screen_class,main_menu
5358D124C06358BCD5FEF67C87052AC2,firebase_event_origin,auto
5358D124C06358BCD5FEF67C87052AC2,firebase_screen_id,
2B0D8BD127A58843F3B4F8C8FE50CD77,firebase_conversion,
2B0D8BD127A58843F3B4F8C8FE50CD77,firebase_screen_class,FIRootViewController
2B0D8BD127A58843F3B4F8C8FE50CD77,firebase_event_origin,auto
2B0D8BD127A58843F3B4F8C8FE50CD77,firebase_screen_id,
5C813D5127BF4EC2AAB2B93A6406E223,firebase_conversion,
5C813D5127BF4EC2AAB2B93A6406E223,firebase_screen_class,FIRootViewController
5C813D5127BF4EC2AAB2B93A6406E223,firebase_event_origin,auto
5C813D5127BF4EC2AAB2B93A6406E223,firebase_screen_id,
E4C074EBC3729FB45CFA48D9F6EA4DFD,firebase_conversion,
E4C074EBC3729FB45CFA48D9F6EA4DFD,firebase_screen_class,FIRootViewController

2025-01-29 20:45:59 - root - INFO - SQL:
SELECT DISTINCT first_sessions.`user_pseudo_id`
    FROM (
      SELECT `user_pseudo_id`, DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))) AS `first_session_date`
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
      GROUP BY `user_pseudo_id`
    ) AS first_sessions
    JOIN `firebase-public-project.analytics_153293282.events_*` AS later_sessions
    ON first_sessions.`user_pseudo_id` = later_sessions.`user_pseudo_id`
    WHERE later_sessions.`event_name` = 'session_start'
      AND DATE(TIMESTAMP_MICROS(later_sessions.`event_timestamp`)) BETWEEN DATE_ADD(first_sessions.`first_session_date`, INTERVAL 8 DAY)
      AND DATE_ADD(first_sessions.`first_session_date`, INTERVAL 14 DAY)
    LIMIT 100
Results:
user_pseudo_id
0990A2B8DA74612120226181689C6E66
BFE99B51F316372640BDD14B9625C0F2
7C8A5B2853B828A5756F5BFAB556D6A5
1756558602A5C14A5DD2AD4B696D2191
0D9B1C51FA357A1A3487036AA037F7D0
F4F4EAE9439622EA3CA9489A52E7230F
AC5BB8A4162F0D60D28B10AB440DBC26
A7AAA5EF977926DBCF801D15F83EE4A5
5C5A0787542CD24F1E19F9EB778BA766
FEDC59699D8832A11B88BFCCCAD0951D
CA04708DA02378999ECB402481FF1AE4
932AAF56DDE9C55359B9CCFA18E7FB95
10B0D468B5E036E16D13DB53A65F2D49
D924713CB1AF85AED83BC394B164B9DC
898B790ACC7834117A9B2C98A8B6F1F5
44759496F6F519B1A4BEF55BE55C631C
C74B58C4CD2770A1E97D6DC13D42CCAC
C464722AE0E9423DE721E72B8A524141
01CFFBBD46917B080573B3A5CC322BF7
8B47681C5D1B19C3927E92404548290D
EBD6BD1C68211E5C21E1EFE514BB53FF
AD7202B296F59F58E3DDD884E9E9F40B
35D099424972413F3E46BFCA86C15295
CAB46DA4D11234BBD6AD709F01CA8241
6F1C09DFB69D4CA8B61065E9A7CFE12A
3309297C1BDD033F918A40177CF78474
BCEE3264C03284FEA9D7E709182033EC
71381569682468BBBB8936278290D669
AFEAE67E8EED1A3F43A669B7EFCBA05A
8375B114AFAD8A31DE54283525108F75
E6850F5E0DAB3E339C6A36BDEECCA26F
8601A3659DC5C1F0444E5CCDA5ED3E14
E0CE2CA5D2D361E064F990D370644897
4ED41C0527A63A25FAF988181C8F4C24
B7706BCDE12360F565E9F5DB0A5256D8
27F00948B711510BB4C0BCCEDA9B8A45
1BB448F355B22AFE32A99DF1997D2D61
6DC8E9960F2EAE5C05215ADFC160359C
933A379D75E03C0CC1316F4956C9240F
7EBEF9ABE5C8F7D340BC26927366D13C
58930F51C20661E89F5DFDB969131080
CCE60CE7DBE296A7828A028094E21D51
6D24F421B34B2CFDCF3A9983CF63D647
33BA0F066B903D1C520E3F0D54A681A5
BE89C8EA9D132E6BD866F4B3A8B1E384
3C61120F4C807953BAE7A32CCE144B9B
18688C841952131D9A6A01B81C8F65F3
FBC96171D55D518A86075798B95B7FF9
1B7FF293CEB974A6F4E4788D705FF314
ADA0082F4F191F3A9C9CBD2E2EA4750E
BC7EA6EAB18533AF121D4115DDB03673
24D41A78A6BB1244608DB32351B0658B
DAC0EAB11F253D2173A6FAA79AF5DCAB
B1BEEB89E7F8A596AA10AB384169460A
728398B33BFD42D1E1C4E909C1875843
E19F04BAB15FBA761833F71BCF5D97D3
6EDEC26E3CD2B1484254B15917E9F19B
121F942791F0082A6F10BF15C814165E
DDB627A00E4213B6A69F35DB89681AF8
7FE1548D56FE9B87CE6C14374969B4A9
A68C4D0A3F32C3F7621CA7675E9F39A6
87A95949D12E9C9263482FB202E791BD
6A2F4E7AB1816D2F6EC741BC92141766
2B5ABA17A30D32531C09DAF2865F9E55
64BB7DFAE772A77F70FB63373D0808F5
DC8912881CD30A0D8D5E2EB666D22901
6597B6D4B733197AE65E3EB21E0C8DD6
E84BFE62196E059C66D049BA9A14061C
6F2C69DE0A77E619B2D3F1782F831F7D
4A81FE8E75C780C97EEE73A7574F0B4F
1B3AD9683D475EFB398E131DFE65AE61
BBDCBE2491658165B7F20540DE652E3A
488BE19C45D3D8B2DF02214BC19B44B4
51C58309304097EFF968922A83299000
091F09F594F7507A1D6D34D006A49CD9
2B90CE94C6039DF03E72FE15B5320ABA
841727B396264112EC75FEB26C57E25C
D621943131370A102FA24B981A929573
1954CEDB269C01AD957EE1DBCB9BF812
177581DC2CAB8BCC6A840B7F47A2FEA6
5256B2B115955E80DDB7449775D92325
AB32482D193E2CE166B59F82EF78D8BB
709FCE78A03255D6EF6678E1D98783E7
CB06B751DAD44BB7F228F8474686D404
7410C5CC4FA11D31DB5F9B1D8ECD6BD0
33E5EA9FE1E29AC3127D975A5494213D
B76F1841464BFF8CF3155EF7C1FD91E4
735123CE7AF980AD5B43F31CAF2890A0
0409A1CE83D1D4DC0F01E2DFA44ED555
6C40A2B1B7C2336EDCE4B9F346682A72
EAE280AC3E0FD529D1C8A9D83598A8C2
56A3ECD9106EA59DE52682BEFFFAC53C
C7F7B410934B11C89470FE40247243A1

2025-01-29 20:46:05 - root - INFO - SQL:
SELECT `user_pseudo_id`,
      DATE_TRUNC(DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))), WEEK(MONDAY)) AS `cohort_week`
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
    GROUP BY `user_pseudo_id`
    LIMIT 100
Results:
user_pseudo_id,cohort_week
0A26E7281EC31038AD42F28C930FFF90,2018-08-27
BE36C49B1AB3968D420923AEC4FDD7AE,2018-07-09
418C1FE4FF01EA36F511E5D9073F11BD,2018-07-09
E4196C5E0A92A22F69DE4E3AA288D6EE,2018-07-09
A7642D8075588A1BE483081F553C97DF,2018-09-03
BDF5C54603EA724BB06956930ADFBF0A,2018-08-27
F98CFD1DE0862FE7834C55DE6C9ADEF5,2018-09-03
1AE81ECA4F8037BEB8E0A33D8AA6F337,2018-09-03
D6C62D17A18603EEE645F28835D54DEA,2018-09-03
E216E68E4CF209367AEC7C92119229F9,2018-09-03
443E767D3A695AD330A2607746D3B14C,2018-09-03
6158C7CD861E2F83D6AA22CCF92AEE97,2018-08-27
FBE5BE5E3836527EC27D14834D72B911,2018-09-03
91A06057C6272653B6006D7A8791DF81,2018-07-09
F9C021D9A8B84158F73A8662D76E9EE9,2018-07-16
D697779AD56B2CC1C41B5A77E3BCA81F,2018-09-03
96161BF2E55C7E32ED5F411432875ECB,2018-07-09
EB96D4E588761A891B492920DB8CDC25,2018-08-27
9F833A0D7CCA8E4BB64D57511989AF5A,2018-08-27
3946E17DD4B99C0244B86633EC1BD7DF,2018-08-27
C3817B35D57C5C1BF6225FEC9BD16534,2018-07-09
79D16DA26AB14780B3F4723E0E57769F,2018-08-27
AF070F60DBF28F26A8885E8554418C0A,2018-09-03
682A8CD0767A569DC68E7AA0201BFBA3,2018-07-09
8C33815E0A269B776AAB4B60A4F7BC63,2018-07-16
EC69270A8257323F7E911D13FE39ADD8,2018-09-03
FAADDD7E6C919B97BC67A987BE177603,2018-09-03
6CDE3BE03DAF6243A5578BCBA2D2F398,2018-07-16
3B36DABA665909A2252F013BD95F5833,2018-09-03
E0937BA260FC4C21B4465D894F8BB1E6,2018-07-16
F5DAD8DD17B689CF672D65A0A81CF4AC,2018-07-09
51012EB79345170B6D17DCD2528288D3,2018-09-03
8211CABE9A3F1FE1BF3154E0C8D30368,2018-07-09
85DB15BDADAB65F9CC1E33B872745B87,2018-07-09
F33FDFA8692C90D2F7E62C4EB3E34C30,2018-09-03
626E752BEFB7A66231B9CBEB3B4FAB1C,2018-07-16
25B3D1AFECED8B78DA6FAF65B71AF56E,2018-07-23
65619C5EB2171A0C5F0F2FCC45621725,2018-07-16
106E569E2C783529C6941598B59E9743,2018-07-23
BF9F1996AE080A0FC6CD928098FE44C8,2018-07-23
7D12F08669A7F1D4E2D12FE42431C26F,2018-07-23
8EE868DE3A7CBBFC9FBEEEBE37FABF1F,2018-07-16
EBFE0623EF1109A89B392B9DF4375951,2018-07-09
B4C5C2B97C2365FCD1125CA367293008,2018-07-09
62DD70123C14207F97E6515DDE77D76D,2018-07-23
4888671BB1FED63688415ACCC4296344,2018-07-16
55F9FB7C14AA4BAB066EA326D4A2221B,2018-07-16
7EC89D833B1186688C4891B443292546,2018-07-16
E415D4A90F9A9D8B784B3BCE2F5678B5,2018-07-23
F84549673CED44D4809888E277BA64FA,2018-07-23
D9AA0EC27AF47514DDB5C664A6EF758A,2018-07-09
DB3B6E984B29883EA02F1A504A33730F,2018-07-09

2025-01-29 20:46:26 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-29 20:46:26 - root - INFO - The error you're encountering is because SQL doesn't allow aggregate functions inside the `GROUP BY` clause. In your query, `cohort_week` is calculated using an aggregate function (`MIN(event_timestamp)`), which cannot be used directly in `GROUP BY`.

To fix this, you can calculate the `cohort_week` for each user in a subquery or Common Table Expression (CTE), and then group by `cohort_week` in the outer query. Here's how you can modify your query:

```sql
WITH first_sessions AS (
  SELECT
    `user_pseudo_id`,
    DATE_TRUNC(DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))), WEEK(MONDAY)) AS `cohort_week`
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
  GROUP BY `user_pseudo_id`
)
SELECT
  `cohort_week`,
  COUNT(DISTINCT `user_pseudo_id`) AS `users_in_cohort`
FROM first_sessions
GROUP BY `cohort_week`
ORDER BY `cohort_week`
LIMIT 100
```

**Explanation:**

- **CTE (`first_sessions`):**
  - Calculates the first session timestamp for each user.
  - Determines the `cohort_week` by truncating the date to the start of the week (Monday).
- **Outer Query:**
  - Counts the distinct users in each `cohort_week`.
  - Groups the results by `cohort_week`.

This revised query avoids using an aggregate function in the `GROUP BY` clause, which should resolve the error. It will provide you with the number of users in each weekly cohort starting from July 9, 2018.

**Additional Tips:**

- Ensure that you have access to all the required tables and that your wildcard table selection (`events_*`) includes all relevant dates.
- When using `DATE_TRUNC` with `WEEK(MONDAY)`, it groups the dates by weeks starting on Monday, which aligns with your requirement.

**Sample Result Format:**

After running the corrected query, you should get results similar to:

```csv
cohort_week,users_in_cohort
2018-07-09,number_of_users
2018-07-16,number_of_users
2018-07-23,number_of_users
...
```

This will list the number of users in each cohort week, starting from July 9, 2018.
2025-01-29 20:47:36 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-29 20:47:36 - root - INFO - SQL:
WITH first_sessions AS (
  SELECT
    `user_pseudo_id`,
    DATE_TRUNC(DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))), WEEK(MONDAY)) AS `cohort_week`
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
  GROUP BY `user_pseudo_id`
)
SELECT
  `cohort_week`,
  COUNT(DISTINCT `user_pseudo_id`) AS `users_in_cohort`
FROM first_sessions
GROUP BY `cohort_week`
ORDER BY `cohort_week`
LIMIT 100
Results:
cohort_week,users_in_cohort
2018-07-09,1317
2018-07-16,749
2018-07-23,698
2018-07-30,760
2018-08-06,609
2018-08-13,524
2018-08-20,490
2018-08-27,643
2018-09-03,1089
2018-09-10,966
2018-09-17,750
2018-09-24,721
2018-10-01,291

2025-01-29 20:47:43 - root - INFO - SQL:
WITH cohorts AS (
  SELECT
    `user_pseudo_id`,
    DATE_TRUNC(DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))), WEEK(MONDAY)) AS `cohort_week`,
    DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))) AS `first_session_date`
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE `event_name` = 'session_start'
    AND `event_date` >= '20180709'
  GROUP BY `user_pseudo_id`
)
SELECT
  cohorts.`cohort_week`,
  COUNT(DISTINCT cohorts.`user_pseudo_id`) AS `retained_users`
FROM cohorts
JOIN `firebase-public-project.analytics_153293282.events_*` AS returns
  ON cohorts.`user_pseudo_id` = returns.`user_pseudo_id`
WHERE returns.`event_name` = 'session_start'
  AND DATE(TIMESTAMP_MICROS(returns.`event_timestamp`)) BETWEEN DATE_ADD(cohorts.`first_session_date`, INTERVAL 8 DAY)
    AND DATE_ADD(cohorts.`first_session_date`, INTERVAL 14 DAY)
GROUP BY cohorts.`cohort_week`
ORDER BY cohorts.`cohort_week`
LIMIT 100
Results:
cohort_week,retained_users
2018-07-09,540
2018-07-16,180
2018-07-23,132
2018-07-30,121
2018-08-06,78
2018-08-13,74
2018-08-20,53
2018-08-27,125
2018-09-03,288
2018-09-10,147
2018-09-17,70
2018-09-24,7

2025-01-29 20:47:49 - root - INFO - SQL:
WITH cohorts AS (
  SELECT
    `user_pseudo_id`,
    DATE_TRUNC(DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))), WEEK(MONDAY)) AS `cohort_week`,
    DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))) AS `first_session_date`
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE `event_name` = 'session_start'
    AND `event_date` >= '20180709'
  GROUP BY `user_pseudo_id`
),
cohort_sizes AS (
  SELECT
    `cohort_week`,
    COUNT(DISTINCT `user_pseudo_id`) AS `users_in_cohort`
  FROM cohorts
  GROUP BY `cohort_week`
),
retention_counts AS (
  SELECT
    cohorts.`cohort_week`,
    COUNT(DISTINCT cohorts.`user_pseudo_id`) AS `retained_users`
  FROM cohorts
  JOIN `firebase-public-project.analytics_153293282.events_*` AS returns
    ON cohorts.`user_pseudo_id` = returns.`user_pseudo_id`
  WHERE returns.`event_name` = 'session_start'
    AND DATE(TIMESTAMP_MICROS(returns.`event_timestamp`)) BETWEEN DATE_ADD(cohorts.`first_session_date`, INTERVAL 8 DAY)
      AND DATE_ADD(cohorts.`first_session_date`, INTERVAL 14 DAY)
  GROUP BY cohorts.`cohort_week`
)
SELECT
  cohort_sizes.`cohort_week`,
  (retention_counts.`retained_users` / cohort_sizes.`users_in_cohort`) * 100 AS `retention_rate_percentage`
FROM cohort_sizes
LEFT JOIN retention_counts
  ON cohort_sizes.`cohort_week` = retention_counts.`cohort_week`
ORDER BY cohort_sizes.`cohort_week`
LIMIT 100
Results:
cohort_week,retention_rate_percentage
2018-07-09,41.00227790432802
2018-07-16,24.03204272363151
2018-07-23,18.911174785100286
2018-07-30,15.921052631578947
2018-08-06,12.807881773399016
2018-08-13,14.122137404580155
2018-08-20,10.816326530612246
2018-08-27,19.440124416796266
2018-09-03,26.446280991735538
2018-09-10,15.217391304347828
2018-09-17,9.333333333333334
2018-09-24,0.9708737864077669
2018-10-01,

2025-01-29 20:47:49 - root - INFO - itercount: 0
2025-01-29 20:47:49 - root - INFO - Database Name: firebase-public-project
Schema Name: analytics_153293282
DDL describes table information.
,0
table_name,events_20180801
ddl,"CREATE TABLE `firebase-public-project.analytics_153293282.events_20180801`
(
  event_date STRING,
  event_timestamp INT64,
  event_name STRING,
  event_params ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64>>>,
  event_previous_timestamp INT64,
  event_value_in_usd FLOAT64,
  event_bundle_sequence_id INT64,
  event_server_timestamp_offset INT64,
  user_id STRING,
  user_pseudo_id STRING,
  user_properties ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64, set_timestamp_micros INT64>>>,
  user_first_touch_timestamp INT64,
  user_ltv STRUCT<revenue FLOAT64, currency STRING>,
  device STRUCT<category STRING, mobile_brand_name STRING, mobile_model_name STRING, mobile_marketing_name STRING, mobile_os_hardware_model STRING, operating_system STRING, operating_system_version STRING, vendor_id STRING, advertising_id STRING, language STRING, is_limited_ad_tracking STRING, time_zone_offset_seconds INT64>,
  geo STRUCT<continent STRING, country STRING, region STRING, city STRING>,
  app_info STRUCT<id STRING, version STRING, install_store STRING, firebase_app_id STRING, install_source STRING>,
  traffic_source STRUCT<name STRING, medium STRING, source STRING>,
  stream_id STRING,
  platform STRING
);"

Some other tables have the similar structure: ['events_20180801', 'events_20180621', 'events_20180616', 'events_20180912', 'events_20180814', 'events_20180716', 'events_20181003', 'events_20180620', 'events_20180624', 'events_20180918', 'events_20180612', 'events_20180911', 'events_20180724', 'events_20180807', 'events_20180710', 'events_20180808', 'events_20180702', 'events_20180719', 'events_20180914', 'events_20180913', 'events_20180915', 'events_20180728', 'events_20180817', 'events_20180628', 'events_20180906', 'events_20180704', 'events_20180711', 'events_20180720', 'events_20180706', 'events_20180926', 'events_20180924', 'events_20180731', 'events_20180804', 'events_20180920', 'events_20180715', 'events_20180709', 'events_20180928', 'events_20180904', 'events_20180903', 'events_20180818', 'events_20180820', 'events_20180707', 'events_20180930', 'events_20180821', 'events_20180812', 'events_20180830', 'events_20180908', 'events_20180708', 'events_20180910', 'events_20180922', 'events_20180713', 'events_20180618', 'events_20180811', 'events_20181001', 'events_20180626', 'events_20180828', 'events_20180717', 'events_20180806', 'events_20180721', 'events_20180725', 'events_20180824', 'events_20180923', 'events_20180627', 'events_20180726', 'events_20180729', 'events_20180929', 'events_20180925', 'events_20180722', 'events_20180630', 'events_20180730', 'events_20180831', 'events_20180701', 'events_20180619', 'events_20180810', 'events_20180822', 'events_20180921', 'events_20180819', 'events_20180927', 'events_20180905', 'events_20180816', 'events_20180622', 'events_20180802', 'events_20180826', 'events_20180714', 'events_20180901', 'events_20180916', 'events_20180809', 'events_20181002', 'events_20180703', 'events_20180617', 'events_20180902', 'events_20180625', 'events_20180827', 'events_20180805', 'events_20180825', 'events_20180919', 'events_20180917', 'events_20180705', 'events_20180613', 'events_20180907', 'events_20180909', 'events_20180727', 'events_20180813', 'events_20180614', 'events_20180623', 'events_20180829', 'events_20180615', 'events_20180712', 'events_20180718', 'events_20180815', 'events_20180629', 'events_20180803', 'events_20180823', 'events_20180723']
External knowledge that might be helpful: 
How to Calculate User Retention in Big Query from Google Demo Game Analytics Data

As a Product / Website Analyst, I was pretty psyched to discover Google’s public Google Analytics 4 (GA4) gaming event dataset called `firebase-public-project.analytics_153293282.events_*`. The table allows experienced developers and learners alike to experiment with raw GA4 data in Big Query for free. Event data is basically a log of user interactions with your product for analysis .For newbies interested in learning more about event data and GA4, visit my prior blog. This article provides SQL queries for a quick table overview and explains how to utilize Google Big Query to calculate user retention.


What is Retention?
User retention rates are key indicators for whether your product team meets user needs. Improving retention is often central to long term growth strategies.

**Retention measure’s how often and for how long users tend to return to your product.**

The metric can be a powerful proxy for product usefulness and user opinion. Its analysis can reveal critical information like how well your site converts new visitors to users and which items and features are associated with users coming back. If user data is available, retention can also help a business understand the profiles of its most active users (power users). Finally, retention is a great guardrail metric for A/B tests. Successful, product oriented companies prioritize a healthy user bases over short term profits.


**Common Retention Calculation Strategies**

Two common strategies to calculate retention are: 

a) N-Day retention

b) Unbounded Retention.


a) For N-Day retention, analysts calculate how many users with certain characteristics return over successive periods. It is called N days because we define the length of each period. For example, with N=7 day retention, if User A becomes part of our cohort of interest on day 0 and returns to the product day 5 and day 15, they are counted as retained for week 1 (1–7 days) and week 3 (15–21 days) but not week 2 (8–14 days).


b) For Unbounded Retention, a user is counted as retained each week so long as their most recent product contact was after the week. For example, if User A becomes part of the cohort on day 0 and last returned to the site on day 21, they will be counted as retained in week 1 (1–7 days), week 2 (8–14 days), and week 3 (15–21 days) but not week 4 (22–28 days).

By calculating these metrics, companies can evaluate how well their products hold users’ interests. It also them closer to identifying the patterns that generate return users.



The table structure information is ({database name: {schema name: {table name}}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180612', 'events_20180613', 'events_20180614', 'events_20180615', 'events_20180616', 'events_20180617', 'events_20180618', 'events_20180619', 'events_20180620', 'events_20180621', 'events_20180622', 'events_20180623', 'events_20180624', 'events_20180625', 'events_20180626', 'events_20180627', 'events_20180628', 'events_20180629', 'events_20180630', 'events_20180701', 'events_20180702', 'events_20180703', 'events_20180704', 'events_20180705', 'events_20180706', 'events_20180707', 'events_20180708', 'events_20180709', 'events_20180710', 'events_20180711', 'events_20180712', 'events_20180713', 'events_20180714', 'events_20180715', 'events_20180716', 'events_20180717', 'events_20180718', 'events_20180719', 'events_20180720', 'events_20180721', 'events_20180722', 'events_20180723', 'events_20180724', 'events_20180725', 'events_20180726', 'events_20180727', 'events_20180728', 'events_20180729', 'events_20180730', 'events_20180731', 'events_20180801', 'events_20180802', 'events_20180803', 'events_20180804', 'events_20180805', 'events_20180806', 'events_20180807', 'events_20180808', 'events_20180809', 'events_20180810', 'events_20180811', 'events_20180812', 'events_20180813', 'events_20180814', 'events_20180815', 'events_20180816', 'events_20180817', 'events_20180818', 'events_20180819', 'events_20180820', 'events_20180821', 'events_20180822', 'events_20180823', 'events_20180824', 'events_20180825', 'events_20180826', 'events_20180827', 'events_20180828', 'events_20180829', 'events_20180830', 'events_20180831', 'events_20180901', 'events_20180902', 'events_20180903', 'events_20180904', 'events_20180905', 'events_20180906', 'events_20180907', 'events_20180908', 'events_20180909', 'events_20180910', 'events_20180911', 'events_20180912', 'events_20180913', 'events_20180914', 'events_20180915', 'events_20180916', 'events_20180917', 'events_20180918', 'events_20180919', 'events_20180920', 'events_20180921', 'events_20180922', 'events_20180923', 'events_20180924', 'events_20180925', 'events_20180926', 'events_20180927', 'events_20180928', 'events_20180929', 'events_20180930', 'events_20181001', 'events_20181002', 'events_20181003']}}
Begin Exploring Related Columns
**Columns and their potential usage:**

- **`user_pseudo_id`**: Unique identifier for users; used to track individual users across events.
- **`event_name`**: Name of the event; used to filter for `'session_start'` events to identify when users start a session.
- **`event_timestamp`**: Timestamp of the event in microseconds since the Unix epoch; used to determine when events occur and to calculate the date of the first session.
- **`event_date`**: Date of the event in `'YYYYMMDD'` format; can be used to filter events by date.
- **`event_params`**: Repeated field containing event parameters; may contain additional information about events.
- **Conditions that may be used:**
  - **`event_name = 'session_start'`**: To filter for session start events.
  - **`event_date >= '20180709'`**: To include events occurring on or after July 9, 2018.
  - Converting **`event_timestamp`** to a readable date format to group events by week.
  - Aggregating data to compute retention rates for user cohorts.

---

**Sample BigQuery SQL queries:**

1. **List distinct event names to understand the types of events:**

   ```sql
   SELECT DISTINCT `event_name`
   FROM `firebase-public-project.analytics_153293282.events_*`
   LIMIT 100
   ```

2. **Retrieve user IDs and timestamps of session start events:**

   ```sql
   SELECT `user_pseudo_id`, `event_timestamp`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start'
   LIMIT 100
   ```

3. **Fetch user IDs and event dates for session start events after July 9, 2018:**

   ```sql
   SELECT `user_pseudo_id`, `event_date`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
   LIMIT 100
   ```

4. **Count the number of session starts per day after July 9, 2018:**

   ```sql
   SELECT `event_date`, COUNT(*) AS `session_count`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
   GROUP BY `event_date`
   ORDER BY `event_date`
   LIMIT 100
   ```

5. **List distinct user IDs who started sessions after July 9, 2018:**

   ```sql
   SELECT DISTINCT `user_pseudo_id`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
   LIMIT 100
   ```

6. **Select user IDs and converted event timestamps for session starts:**

   ```sql
   SELECT `user_pseudo_id`, TIMESTAMP_MICROS(`event_timestamp`) AS `event_time`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
   LIMIT 100
   ```

7. **Find the first session time for each user after July 9, 2018:**

   ```sql
   SELECT `user_pseudo_id`, MIN(TIMESTAMP_MICROS(`event_timestamp`)) AS `first_session_time`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
   GROUP BY `user_pseudo_id`
   LIMIT 100
   ```

8. **Calculate the number of unique users starting sessions each day:**

   ```sql
   SELECT `event_date`, COUNT(DISTINCT `user_pseudo_id`) AS `unique_users`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
   GROUP BY `event_date`
   ORDER BY `event_date`
   LIMIT 100
   ```

9. **List users with the number of session starts they have after July 9, 2018:**

   ```sql
   SELECT `user_pseudo_id`, COUNT(*) AS `session_starts`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
   GROUP BY `user_pseudo_id`
   ORDER BY `session_starts` DESC
   LIMIT 100
   ```

10. **Get the first session date for each user after July 9, 2018:**

    ```sql
    SELECT `user_pseudo_id`, DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))) AS `first_session_date`
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
    GROUP BY `user_pseudo_id`
    LIMIT 100
    ```

11. **Extract event parameters for session start events (advanced exploration):**

    ```sql
    SELECT `user_pseudo_id`, ep.key, ep.value.string_value
    FROM `firebase-public-project.analytics_153293282.events_*` AS t,
    UNNEST(t.event_params) AS ep
    WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
    LIMIT 100
    ```

12. **Identify users who returned in the second week after their first session:**

    ```sql
    SELECT DISTINCT first_sessions.`user_pseudo_id`
    FROM (
      SELECT `user_pseudo_id`, DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))) AS `first_session_date`
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
      GROUP BY `user_pseudo_id`
    ) AS first_sessions
    JOIN `firebase-public-project.analytics_153293282.events_*` AS later_sessions
    ON first_sessions.`user_pseudo_id` = later_sessions.`user_pseudo_id`
    WHERE later_sessions.`event_name` = 'session_start'
      AND DATE(TIMESTAMP_MICROS(later_sessions.`event_timestamp`)) BETWEEN DATE_ADD(first_sessions.`first_session_date`, INTERVAL 8 DAY)
      AND DATE_ADD(first_sessions.`first_session_date`, INTERVAL 14 DAY)
    LIMIT 100
    ```

13. **Group users into weekly cohorts based on their first session date:**

    ```sql
    SELECT `user_pseudo_id`,
      DATE_TRUNC(DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))), WEEK(MONDAY)) AS `cohort_week`
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
    GROUP BY `user_pseudo_id`
    LIMIT 100
    ```

14. **Count the number of users in each cohort week:**

    ```sql
    SELECT DATE_TRUNC(DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))), WEEK(MONDAY)) AS `cohort_week`,
      COUNT(DISTINCT `user_pseudo_id`) AS `users_in_cohort`
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
    GROUP BY `cohort_week`
    ORDER BY `cohort_week`
    LIMIT 100
    ```

15. **Calculate the number of users who returned in week 2 for each cohort:**

    ```sql
    SELECT cohorts.`cohort_week`, COUNT(DISTINCT returns.`user_pseudo_id`) AS `retained_users`
    FROM (
      SELECT `user_pseudo_id`,
        DATE_TRUNC(DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))), WEEK(MONDAY)) AS `cohort_week`,
        DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))) AS `first_session_date`
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
      GROUP BY `user_pseudo_id`
    ) AS cohorts
    JOIN `firebase-public-project.analytics_153293282.events_*` AS returns
    ON cohorts.`user_pseudo_id` = returns.`user_pseudo_id`
    WHERE returns.`event_name` = 'session_start'
      AND DATE(TIMESTAMP_MICROS(returns.`event_timestamp`)) BETWEEN DATE_ADD(cohorts.`first_session_date`, INTERVAL 8 DAY)
      AND DATE_ADD(cohorts.`first_session_date`, INTERVAL 14 DAY)
    GROUP BY cohorts.`cohort_week`
    ORDER BY cohorts.`cohort_week`
    LIMIT 100
    ```

16. **Calculate retention rates for each cohort in week 2 (combining previous queries):**

    ```sql
    SELECT
      cohorts.`cohort_week`,
      COUNT(DISTINCT returns.`user_pseudo_id`) / COUNT(DISTINCT cohorts.`user_pseudo_id`) * 100 AS `retention_rate_percentage`
    FROM (
      SELECT `user_pseudo_id`,
        DATE_TRUNC(DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))), WEEK(MONDAY)) AS `cohort_week`,
        DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))) AS `first_session_date`
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
      GROUP BY `user_pseudo_id`
    ) AS cohorts
    LEFT JOIN `firebase-public-project.analytics_153293282.events_*` AS returns
    ON cohorts.`user_pseudo_id` = returns.`user_pseudo_id`
      AND returns.`event_name` = 'session_start'
      AND DATE(TIMESTAMP_MICROS(returns.`event_timestamp`)) BETWEEN DATE_ADD(cohorts.`first_session_date`, INTERVAL 8 DAY)
      AND DATE_ADD(cohorts.`first_session_date`, INTERVAL 14 DAY)
    GROUP BY cohorts.`cohort_week`
    ORDER BY cohorts.`cohort_week`
    LIMIT 100
    ```

---

These queries progress from basic data exploration to more complex aggregations needed to conduct the weekly cohort analysis for user retention starting from July 9, 2018. They help in understanding the structure and values of the relevant columns and set the foundation for calculating retention rates as specified in the task.Query:
SELECT DISTINCT `event_name`
   FROM `firebase-public-project.analytics_153293282.events_*`
   LIMIT 100
Answer:
event_name
ad_reward
challenge_a_friend
os_update
in_app_purchase
user_engagement
level_fail_quickplay
completed_5_levels
session_start
select_content
level_complete_quickplay
level_complete
level_reset
firebase_campaign
challenge_accepted
level_retry_quickplay
use_extra_steps
app_remove
dynamic_link_first_open
app_clear_data
spend_virtual_currency
first_open
level_start
level_end
level_end_quickplay
level_reset_quickplay
app_update
dynamic_link_app_open
notification_foreground
screen_view
level_start_quickplay
post_score
level_up
level_retry
level_fail
app_exception
no_more_extra_steps
error
Query:
SELECT `user_pseudo_id`, `event_timestamp`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start'
   LIMIT 100
Answer:
user_pseudo_id,event_timestamp
9454C88D30154AF624E046D5C408797C,1536060531637000
525E3BEE74AD824923CC04FE45E45B40,1536109337485000
34ADF71F1AADCA26EC8008496F7CC87E,1536121800134000
C7DD86F06FD4AA8A0967E27E20750FCD,1536058109409000
841727B396264112EC75FEB26C57E25C,1536044648638000
7E74A2BB6BBF4746DEE15F957B315401,1536060224703000
7E74A2BB6BBF4746DEE15F957B315401,1536125855726000
17636078D57884AD7EA5406C60E2BD10,1536084452523000
873A800A72529CC5F0AA4B7B226A263F,1536121501221000
AF06A87FD3FD797F7FA3A44DFC445701,1536049969256000
5ACF1A6BFE350F7BB661BF389AF7E2F0,1536084880984000
1CEA99018BB20A7A426C128C1E972731,1536085136061000
A6F93D542BC785A045FD8B94CC3CFEC8,1536087160646000
A6F93D542BC785A045FD8B94CC3CFEC8,1536106523250000
FA30269453141794E79B8F15EE0BA5B9,1536060214577000
FA30269453141794E79B8F15EE0BA5B9,1536101286368000
FA30269453141794E79B8F15EE0BA5B9,1536115678468000
D76E55DD6D27E0A117FC536C0DC67677,1536092512760000
BE36C49B1AB3968D420923AEC4FDD7AE,1536044643965000
B281031313D47AC55834EC34B3802E68,1536079809858000
DE0CCACD4BB0DBB022445718217A0819,1536076114744001
1E1B4ADDF74F207EB5665FF0FAA02DD6,1536097901275000
90E348A71BE256C926E1F8A86314D583,1536120271601001
418C1FE4FF01EA36F511E5D9073F11BD,1536061558590000
418C1FE4FF01EA36F511E5D9073F11BD,1536109432539000
904877128B8889DDD71A38BDBCD21724,1536052942138000
904877128B8889DDD71A38BDBCD21724,1536072268460000
904877128B8889DDD71A38BDBCD21724,1536074452021000
904877128B8889DDD71A38BDBCD21724,1536126491366000
904877128B8889DDD71A38BDBCD21724,1536129447642000
1B2FC37816CC4DDAACA97A75E685756F,1536111502378000
B71CB5D517BE99FEEED64A0F57842032,1536122719027000
037DAC225F0C1E54657770CD201CDDA7,1536088265621000
4D6582BFA74C0705C44ED36CCB8CE527,1536092030260000
1E9F6BA9BD8C45633C26F42995A77775,1536071883575000
E70E3F402C9F812B2735740C621D79EE,1536065709501000
E70E3F402C9F812B2735740C621D79EE,1536087157556000
E70E3F402C9F812B2735740C621D79EE,1536089781386000
3682C2527BEE6BA0255321BB25DF44BB,1536129004220000
343B740C7B3BD9C2CFA46BF097A8856E,1536104155523000
FEDC59699D8832A11B88BFCCCAD0951D,1536068746877000
53866E32BA0ABFD846772D4B7B9B5921,1536060915219000
50D529BFD3EFEB1C8216DF9A321A552A,1536047240570000
50D529BFD3EFEB1C8216DF9A321A552A,1536108168654000
50D529BFD3EFEB1C8216DF9A321A552A,1536112786549000
3EDE8E7A50DE76AA2EC12DDD2AE3F9F4,1536092386728000
FC46AD58407EF0D1DAA6281AB4DE03A1,1536064357555001
39AE34F91B29542A8F0488F5B787B70F,1536115771287000
E4196C5E0A92A22F69DE4E3AA288D6EE,1536115635154000
3875A92B5F5C2BBA1355CED06A986079,1536049905479000
3875A92B5F5C2BBA1355CED06A986079,1536064508094000
3875A92B5F5C2BBA1355CED06A986079,1536105938205000
3875A92B5F5C2BBA1355CED06A986079,1536112516171000
3875A92B5F5C2BBA1355CED06A986079,1536116633694000
3875A92B5F5C2BBA1355CED06A986079,1536121132827000
Query:
SELECT `user_pseudo_id`, `event_date`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
   LIMIT 100
Answer:
user_pseudo_id,event_date
3376C102EBF491B5CB84B43759FE3433,20180802
023A2DB99CC3F70A4B71869C36952D74,20180802
023A2DB99CC3F70A4B71869C36952D74,20180802
4500595CA1FC3CBC6140A502240FB7B4,20180802
8C648AA8E1BED4F1A904777CD622F4FF,20180802
FC55032FC8C06EB1A1220D1ABD1164C9,20180802
9BC94B3773C8304A9E101AEBCFEF4A5F,20180802
9BC94B3773C8304A9E101AEBCFEF4A5F,20180802
295D9E24D8DE65A010313E667131EF19,20180802
295D9E24D8DE65A010313E667131EF19,20180802
295D9E24D8DE65A010313E667131EF19,20180802
295D9E24D8DE65A010313E667131EF19,20180802
5B4FD8662DAD71406319200659FDF420,20180802
E2B530ADD7430BEA6BC7F3D431C8A6FF,20180802
4BB019F8F6D1FE7BA78CA42A4698EF56,20180802
4BB019F8F6D1FE7BA78CA42A4698EF56,20180802
4CDB160C7A0483695AE6DB265C4E038F,20180802
9CED4A9B9E6B7ED5CCE07F6D752048E1,20180802
EACCA0856B7B7B2AEC2CB1808C1034E5,20180802
EACCA0856B7B7B2AEC2CB1808C1034E5,20180802
980DEC5BA17132A841D7D7A140333114,20180802
980DEC5BA17132A841D7D7A140333114,20180802
D69EBD56ECD257924A112BA6FDB75D27,20180802
5FC2FB966B4EF39E4FD7FDB6333714DC,20180802
9DE7361ACCDEA6541AD5EA55D59B1C78,20180802
9DE7361ACCDEA6541AD5EA55D59B1C78,20180802
9DE7361ACCDEA6541AD5EA55D59B1C78,20180802
4A93C01615B33FF5804AF8D19895247F,20180802
4A93C01615B33FF5804AF8D19895247F,20180802
7BD92FD0756E6D260B45D7B6D9670C17,20180802
5E9B9E20975EF45745B511D401456619,20180802
F3917138A3D4B03ADA1C2E77E3B84649,20180802
DA426D16B0EAB27DE1AC9D6E3418F400,20180802
DA426D16B0EAB27DE1AC9D6E3418F400,20180802
F7440C5660BC904383AFC518162113D0,20180802
53BB2C3D9C62AD1169788AF86C59750D,20180802
A6F3AC0345F0D29697A0E517CB4DC507,20180802
A6F3AC0345F0D29697A0E517CB4DC507,20180802
B99FD965B0874192EE94E8A8FE85EA9E,20180802
706C748E6D1E0768BFEFE6362B5D3F67,20180802
706C748E6D1E0768BFEFE6362B5D3F67,20180802
706C748E6D1E0768BFEFE6362B5D3F67,20180802
B05B44F98AC43EA887A1B78C3552A927,20180802
B05B44F98AC43EA887A1B78C3552A927,20180802
F815B0069F973BFA743EF90A85224109,20180802
D0F280B12652EB0D74F6BC74AB13606F,20180802
54405BB87CA5EE368EB42F411323631F,20180802
54405BB87CA5EE368EB42F411323631F,20180802
5A3C1C538553B1A5108163C4EB7F8D39,20180802
3EF8FC940E379D53BBD3FEFDAF626BB2,20180802
E6FEE8B98E75EA5311FE004F98559A27,20180802
6A2F4E7AB1816D2F6EC741BC92141766,20180802
6A2F4E7AB1816D2F6EC741BC92141766,20180802
6A2F4E7AB1816D2F6EC741BC92141766,20180802
67EBFEC8E68ED6187FFAD137465A3638,20180802
48AB910A8DE8485D4C34238EA61F782C,20180802
48AB910A8DE8485D4C34238EA61F782C,20180802
48AB910A8DE8485D4C34238EA61F782C,20180802
FA30269453141794E79B8F15EE0BA5B9,20180802
FA30269453141794E79B8F15EE0BA5B9,20180802
FA30269453141794E79B8F15EE0BA5B9,20180802
FA30269453141794E79B8F15EE0BA5B9,20180802
35CF08DA631AC27582D6A0FE710131F7,20180802
Query:
SELECT `event_date`, COUNT(*) AS `session_count`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
   GROUP BY `event_date`
   ORDER BY `event_date`
   LIMIT 100
Answer:
event_date,session_count
20180709,580
20180710,613
20180711,593
20180712,620
20180713,640
20180714,554
20180715,539
20180716,535
20180717,495
20180718,520
20180719,484
20180720,574
20180721,636
20180722,533
20180723,587
20180724,582
20180725,552
20180726,550
20180727,616
20180728,607
20180729,662
20180730,632
20180731,585
20180801,608
20180802,690
20180803,692
20180804,688
20180805,667
20180806,628
20180807,619
20180808,669
20180809,621
20180810,477
20180811,584
20180812,611
20180813,685
20180814,605
20180815,568
20180816,613
20180817,617
20180818,637
20180819,604
20180820,641
20180821,630
20180822,625
20180823,588
20180824,646
20180825,653
20180826,618
20180827,685
20180828,638
20180829,696
20180830,656
20180831,618
20180901,579
20180902,648
20180903,637
20180904,659
20180905,741
20180906,707
20180907,700
20180908,689
20180909,719
20180910,724
20180911,655
20180912,780
20180913,694
20180914,636
20180915,598
20180916,641
20180917,640
20180918,662
20180919,720
20180920,637
20180921,729
20180922,683
20180923,764
20180924,659
20180925,673
20180926,688
20180927,803
20180928,630
20180929,675
20180930,679
20181001,656
20181002,653
20181003,648
Query:
SELECT DISTINCT `user_pseudo_id`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
   LIMIT 100
Answer:
user_pseudo_id
9BC94B3773C8304A9E101AEBCFEF4A5F
73980AF5B8954128337EB065CE75C773
4A93C01615B33FF5804AF8D19895247F
C73D0BE8A6C303863FCE487F9996028C
26FACA90F8AA62D614E65FD30CD978AB
E5AFF3DE508996512D61B49A63D1D063
5F36B447AE0BD99BD05B4E84B057E556
3A4F5028A0CA512C0E2CCA1F36CE160D
6EDEC26E3CD2B1484254B15917E9F19B
C9CA9887D6B75FC79B920F29B5237CE1
214980227844539E15ABC4C4F3A79C28
C7BD490452F7CBF2D49339DF6F53072D
EB1A430BACB37E6EA72592BF838E64A6
80D8B94D9BCBA0C07218A15293BC91B9
520471500948F8B932423DE86347D2C1
004D2DFEB866BFB00427DB2F530C1F3D
27AABF18BF07DE5DCACA40BDAFCD21E1
04C1B862AFA39703243166C625EBBD40
080DB8B23066DE56D78C5F570FF5A019
40B501E0460E254E289A776CFC31DCF2
E6B6CAE2D200FC3EACF21DDE75402DCD
148AAE2C85735FF43C7590EC37054C17
C80CEE0983AB5B21D3F4B46089FDD9EB
7ED8C235689771F6B0F29BBF295A346F
C96C96A3BFA142C6B393183BDB2B9DDB
32E3FFAC452648CA8600591F432B926B
0C777BD44F304574371C97674DCD0702
8F6C5F7611B67A4A437FF283B6C10181
A19F659EA9BA36A3595F088F30A6B7E7
620DA7A49F07368EBCB917DB113BCEDC
80810BB18ADB73C9585D86058958AF35
788B593C9AFEBAEE6374CDA08F16FAC6
3376C102EBF491B5CB84B43759FE3433
8C648AA8E1BED4F1A904777CD622F4FF
D34924C19421D7E083FD387D97765F94
23A7E8D987ADCC38EB026096DC513F85
9278A7C15D0307622E7A0305C4091A91
4C3EAB9FC779FA2790F618E3D6AFC499
D3F06F9B7BD9D7FC8758BF78BF0705E9
17DC0E89E3ECED8B312BCC88BCE23548
490F592DDAB95F2590917ACA94B377C6
52556201335DD5EB3D333F4065503C3C
F47CF9AFCC314481CAF183DC6836965E
B2AC10B655AA834B86A4617280DD57D8
4C18E92173DBE0764C2CC29D174E3A46
B44CE073B21086F04503B93E25448C84
5EBF8502142E66A011B97904BE28B5DB
1CF315BC6864E7A71A81E47925E18A61
46B5EAFD9FE97971DE35E6A1876B7963
35DE008317AB2760503976FA63F51B61
6281B5ECD3AE4FEDA451D682B2EE0310
C464722AE0E9423DE721E72B8A524141
E59C013E06CD767FD8A536E288DF2780
17934EF7C1BC1CF2C7D942401FDE84CE
3B21B398D6518D48AD878537495DFADF
00D49153E0790E34D76523EEBEF459B2
5FED8FE4B11878AAFC4E53BDA3FBB56D
3BE174EF49A2015E782228B3E02E3CDA
0ED6BC1D319AB5BD1F245628EA47EDBB
A78340D66F35B9692E956BC94D20332D
7EAE2B4599B94A807DA2AF393F036C65
2B085FA1A52991A730A32F0C87F474D6
27EBD3EEECD253B2A30B2255280DD32D
5C2D9F2166A128926CB802B0941EF4C6
E5A284CF837E6F0973B9B7AE22561CDE
74DCDBEC89234F0E83AF6AD036DB27D0
52E08E4A2847DA44180FB6E41E91503D
4CC7B06FC12175C31ECBE1987A48DEA3
68C5F7CFAEAB93924B7B55D7129C0286
34587F7996F20BE4CC7DDEB96753D110
1CE03BB4BFFE9960A4E94D81D89355BC
F5E70A3073EA182872DD0BE8D8AB1786
F32D308B369814D18336A1ED6AF040E8
ED02B5FFD68A3242B0F6FDED925CD5DB
3346097B57AC50FEC68D31230E17BA39
F37E38D7873B155B9E405726147358B2
4EE0015622A90E4D434B33508394FC2E
8CCA0719F08368F316CB951B266ED5FC
AE3F42E7ED917EE6F5216DC1C79EA63C
AD0F414A967E7478F1CF2ED1B145F4AD
9FE14774A6A768A1C1BEBCE0DE0669A5
2201BA84231D7CC8147F47074DF99E1F
3C61120F4C807953BAE7A32CCE144B9B
7740CD7CDD8F6CD275974FC8C81065CD
30851A76407C708D397A7D2341980D37
E24D750CDF314F2688DC53B0ECB162FE
61879BEF3B028659993A9A1F399BFF77
6AA133F6731526630B1D51BF557E485B
EFF25E323404995318BF89248DC78753
44D4588D33F83DDF05E6FD25DD38B7C2
B0B8369C7B317332A28A914D018BD475
FD239DEE719F5BDDF4BC9381C6B84220
89BBCC1FFE24293BAA9904AC5BE09D0A
Query:
SELECT `user_pseudo_id`, TIMESTAMP_MICROS(`event_timestamp`) AS `event_time`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
   LIMIT 100
Answer:
user_pseudo_id,event_time
AF4F16A9D1C2CA93686E7CBD2EB349E3,2018-09-08 02:12:34.072001+00:00
AF4F16A9D1C2CA93686E7CBD2EB349E3,2018-09-08 05:43:51.185000+00:00
AF4F16A9D1C2CA93686E7CBD2EB349E3,2018-09-08 06:39:51.329000+00:00
295D9E24D8DE65A010313E667131EF19,2018-09-08 04:43:39.649000+00:00
FFD44153572065E379B7E96916F730B8,2018-09-07 15:50:26.797000+00:00
980DEC5BA17132A841D7D7A140333114,2018-09-07 14:07:00.660000+00:00
26C6707A34999C33D68CB0AB07341DB6,2018-09-07 10:33:56.625000+00:00
7E74A2BB6BBF4746DEE15F957B315401,2018-09-08 05:08:41.311000+00:00
17636078D57884AD7EA5406C60E2BD10,2018-09-07 14:13:49.668000+00:00
4BF98D09CA8359FC59ADAF56D00338F8,2018-09-07 15:59:18.811000+00:00
4BF98D09CA8359FC59ADAF56D00338F8,2018-09-07 17:55:25.524000+00:00
4BF98D09CA8359FC59ADAF56D00338F8,2018-09-07 19:32:55.247000+00:00
4BF98D09CA8359FC59ADAF56D00338F8,2018-09-07 20:48:58.012000+00:00
94B02BA3020E382B3456932FA88A03AC,2018-09-08 00:34:15.330000+00:00
F9B1FEA75B896DA727BC733173B19D60,2018-09-08 04:49:16.079000+00:00
1CF315BC6864E7A71A81E47925E18A61,2018-09-07 12:47:28.691000+00:00
FA30269453141794E79B8F15EE0BA5B9,2018-09-07 13:44:45.572000+00:00
0A26E7281EC31038AD42F28C930FFF90,2018-09-07 19:12:51.293000+00:00
0A26E7281EC31038AD42F28C930FFF90,2018-09-07 21:48:43.710000+00:00
0A26E7281EC31038AD42F28C930FFF90,2018-09-07 22:35:48.691000+00:00
0A26E7281EC31038AD42F28C930FFF90,2018-09-08 06:01:42.099000+00:00
BE36C49B1AB3968D420923AEC4FDD7AE,2018-09-07 07:21:27.191000+00:00
BE36C49B1AB3968D420923AEC4FDD7AE,2018-09-07 10:14:28.840000+00:00
459FD97ABE14D7762CD58C3A3104D183,2018-09-07 15:33:53.914000+00:00
E5AFF3DE508996512D61B49A63D1D063,2018-09-07 10:15:46.352000+00:00
5145D8121071A9EA903A1098034962F6,2018-09-07 19:25:08.501000+00:00
5145D8121071A9EA903A1098034962F6,2018-09-07 22:54:37.521000+00:00
A0EDEFE9E2CC092F97266CDF9DB5830F,2018-09-07 21:24:46.834000+00:00
F0186BDA8E7BF76675999CFDCFB10F6B,2018-09-07 09:57:22.504000+00:00
F0186BDA8E7BF76675999CFDCFB10F6B,2018-09-07 12:02:50.750000+00:00
418C1FE4FF01EA36F511E5D9073F11BD,2018-09-07 17:03:08.044000+00:00
418C1FE4FF01EA36F511E5D9073F11BD,2018-09-08 00:56:10.671000+00:00
904877128B8889DDD71A38BDBCD21724,2018-09-07 17:08:29.563000+00:00
904877128B8889DDD71A38BDBCD21724,2018-09-08 00:30:55.167000+00:00
Query:
SELECT `user_pseudo_id`, MIN(TIMESTAMP_MICROS(`event_timestamp`)) AS `first_session_time`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
   GROUP BY `user_pseudo_id`
   LIMIT 100
Answer:
user_pseudo_id,first_session_time
9DFCDD335DDCAAF5987FC07F7927BF34,2018-07-12 10:19:27.198000+00:00
D1F53693AA457A127407EBA024A07EE4,2018-07-12 04:58:15.013000+00:00
FFA9AE78B23263835F8AAED57713EBE9,2018-07-11 13:53:18.202000+00:00
0AF862AFEB5358EBFDA7AFE3AC908844,2018-07-10 13:54:56.284000+00:00
81D3DD49AA2304FD1ED8C498747B5FC6,2018-07-09 11:57:02.369000+00:00
93F2362648919544175333B636156F52,2018-07-11 01:39:23.121000+00:00
372D9BB5088C4E9000C65B06459B403A,2018-07-09 09:02:49.064000+00:00
C1648883A80997B611743D528CBFF926,2018-07-12 20:29:59.193000+00:00
301F195A323A825ED893DAC478C3B919,2018-07-12 13:49:17.878000+00:00
091770A1325101155A651F90D283DA35,2018-07-10 10:25:40.787000+00:00
5EB709BD6D577B03B138AF80E55ECB5B,2018-07-13 01:20:34.061000+00:00
9DE945166BCD4709696C5836317DDE47,2018-07-10 12:18:21.116000+00:00
DAA3F353F320A717A0C418A8205292B2,2018-07-11 12:10:40.647000+00:00
707AA337DA532FC4DFFED03866DF879F,2018-07-12 23:50:43.212000+00:00
D7EA8E3645EFFBD6443946179ED704A6,2018-07-09 12:42:22.840000+00:00
5788A16A3FF89DFC642034165C8932D8,2018-07-13 00:48:16.751000+00:00
E7CCB643C1D0028BF305EDD85397255E,2018-07-13 04:13:50.571000+00:00
7BAB96908472EF544DAC0E1951E96E84,2018-07-12 15:23:21.963000+00:00
FAB66F3229CC381629D6C426F9171D24,2018-07-12 21:53:56.952000+00:00
3A6736FD849F931397512E4693AE829B,2018-07-12 13:13:42.810000+00:00
03A9D32C44665A9E15CFCCEDC9F68EDB,2018-07-09 10:04:57.716000+00:00
F91F493916395FE4E16DE98B24388985,2018-07-09 16:04:43.831000+00:00
D842320AECB686B41C2F8E8876794D34,2018-07-10 04:34:05.093000+00:00
158D85747B252579015AE58305CBC8C1,2018-07-12 22:44:07.016000+00:00
EF0FBB41BE6F40A5CC1D68D8E1CD3591,2018-07-12 19:34:55.887000+00:00
C639CACA07D03F536F537ED779CF6599,2018-07-09 16:05:22.983000+00:00
C09F04828B07E4DFEF39DA5C4A976A90,2018-07-12 18:20:46.361000+00:00
278F45BFDAAC6EA9CED0999482E5C93E,2018-07-12 21:27:39.656000+00:00
D4C8E3E0EFC45C3D60AB3F0F305489AF,2018-07-12 07:04:25.205000+00:00
8F46EE0FFE423C4FA11B40E99045A05E,2018-07-12 14:22:47.978000+00:00
91D637F0D9FB259AD52773B1B20151BE,2018-07-10 11:11:42.748000+00:00
38232364F572A6A7820F31485458BE69,2018-07-12 21:05:09.211001+00:00
Query:
SELECT `event_date`, COUNT(DISTINCT `user_pseudo_id`) AS `unique_users`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
   GROUP BY `event_date`
   ORDER BY `event_date`
   LIMIT 100
Answer:
event_date,unique_users
20180709,380
20180710,405
20180711,390
20180712,403
20180713,422
20180714,358
20180715,360
20180716,352
20180717,324
20180718,344
20180719,309
20180720,385
20180721,439
20180722,372
20180723,389
20180724,389
20180725,361
20180726,369
20180727,419
20180728,418
20180729,444
20180730,433
20180731,392
20180801,393
20180802,450
20180803,489
20180804,474
20180805,450
20180806,439
20180807,426
20180808,450
20180809,416
20180810,326
20180811,406
20180812,415
20180813,455
20180814,395
20180815,368
20180816,404
20180817,411
20180818,438
20180819,410
20180820,420
20180821,424
20180822,406
20180823,376
20180824,440
20180825,443
20180826,416
20180827,438
20180828,422
20180829,447
20180830,443
20180831,412
20180901,406
20180902,444
20180903,428
20180904,420
20180905,477
20180906,461
20180907,488
20180908,476
20180909,501
20180910,483
20180911,424
20180912,500
20180913,452
20180914,434
20180915,389
20180916,417
20180917,424
20180918,450
20180919,481
20180920,413
20180921,487
20180922,477
20180923,525
20180924,427
20180925,450
20180926,472
20180927,573
20180928,450
20180929,468
20180930,472
20181001,431
20181002,442
20181003,428
Query:
SELECT `user_pseudo_id`, COUNT(*) AS `session_starts`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
   GROUP BY `user_pseudo_id`
   ORDER BY `session_starts` DESC
   LIMIT 100
Answer:
user_pseudo_id,session_starts
3875A92B5F5C2BBA1355CED06A986079,361
EB1A430BACB37E6EA72592BF838E64A6,350
EF500E0CF578004836D1D38C8901862B,327
CA04708DA02378999ECB402481FF1AE4,300
10B0D468B5E036E16D13DB53A65F2D49,283
FA30269453141794E79B8F15EE0BA5B9,281
472451071AED6FF801BC0FE66706FD27,278
959635567E419A061EECCCA478EDC718,278
B5395F8C2077B59B3D6C5719C0CA0339,277
372D9BB5088C4E9000C65B06459B403A,256
DA48D36D07835B1918BDF831AF83B5EF,249
05FB3382D94C7E963B408FD6CC357D33,245
74375465CD17299EBC7C75A1B4047EE0,244
EFB696A82D093B3AFBE92FF526DD5CEA,232
0C777BD44F304574371C97674DCD0702,225
0CAAA1B6F161BA4D363EB7A2DEF64A08,208
682A8CD0767A569DC68E7AA0201BFBA3,207
A0616D4E494DC3BCCB94B8B6E5B48380,203
13E6C8A193FF140F7D4222B569DD5B50,202
0E05F56141200FF41FCC0C7FA297FF08,201
F5DAD8DD17B689CF672D65A0A81CF4AC,195
40B501E0460E254E289A776CFC31DCF2,189
03A9D32C44665A9E15CFCCEDC9F68EDB,184
48AB910A8DE8485D4C34238EA61F782C,182
C80CEE0983AB5B21D3F4B46089FDD9EB,182
735123CE7AF980AD5B43F31CAF2890A0,171
CFA0F8C5E25A71062E573EF8E6BC9F76,169
487DE902636DD8A9844A2D61FE7BD568,163
2CA82928A35949DF7775D4BC04F0AEA1,162
DA856449658776EC6410C178742F54D7,160
229254D7C810F98F72C89A8060E194D4,150
42E6A7C3536775E3B8C3DB919AE9A452,149
0D17D0247F158FA3E40D21EFF46D1651,146
DF0E6C6C5E4F3F34FEC6EE54FD945B05,142
AD99B4950F9D70E0FD5E8563F2A664FB,141
47216088A078D06F9220263FAF964F10,140
8211CABE9A3F1FE1BF3154E0C8D30368,135
3B4A6FCA6DCB4C2749409DC4188A306E,131
E594F4CE9B23146A461021258CC7ACA2,126
328DC7FE55E8881B2EA668C9A2855BB7,125
724B99CB6F41846F3F6BB46C2F663F5E,123
E0664E9E7883956A6E3084FD68AA274B,123
BE36C49B1AB3968D420923AEC4FDD7AE,122
57EC50FBC6C7277B8EDCCE44C1352BD4,122
3DEB0C12C49AD19D7ACE68FA59E7ACD6,120
E4196C5E0A92A22F69DE4E3AA288D6EE,117
8D9D62A4402581BB1181D3AA73AD54E8,115
2F74E23BEA1E45E3897274EE4903DCC5,115
F655D26B0F7A4093F1D2FFBD5E61B09D,114
12E5626928FE0885DEEF068683E8BD63,113
C7E2273D8B11257FCCC915D27C1FCA24,113
74EFA3B9E98982CB94246D7F95DF29D0,111
C74B58C4CD2770A1E97D6DC13D42CCAC,107
0A26E7281EC31038AD42F28C930FFF90,104
295D9E24D8DE65A010313E667131EF19,104
86A6C9FB1A0C566CA168149788E71EFD,104
59454BAC415BB1F18517C6FD2C023E49,102
932AAF56DDE9C55359B9CCFA18E7FB95,102
5E09265F12D64B9FA85FF9427A0A7FB0,98
3D1B58553D2E2D4DD5DFCF251D5E23B2,96
A74C05E503F6274BAA9457B2265471F5,96
B63075B53A750A67A12F7F19ED5AA835,95
89BD2B0E233951461CF06C9B4FDA0D81,95
343B740C7B3BD9C2CFA46BF097A8856E,95
1213ED1E96B0A49B51C0F7683DB2ACCC,94
635808C1DDFBC662DC3015097E26E62A,94
Query:
SELECT `user_pseudo_id`, DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))) AS `first_session_date`
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
    GROUP BY `user_pseudo_id`
    LIMIT 100
Answer:
user_pseudo_id,first_session_date
5217AB1A454DAED6243E1C9818BE6A20,2018-07-09
0155220BAB309646CC7AC980AB75A212,2018-07-16
17636078D57884AD7EA5406C60E2BD10,2018-08-04
448F4402131C2DE70EC67F04D4BF5719,2018-07-28
2D644942A18A482A9AD370DA9F38B709,2018-08-06
BCEC642620FB741AA4EE43E0FC6C7A05,2018-07-15
1B959D672ABAE4A3BFB9D720D415E064,2018-08-04
C052BC38A0F39A40678E5AF5E7C84B77,2018-07-28
117AD1627465CC9E03AB5D8825D42E07,2018-07-12
488BE19C45D3D8B2DF02214BC19B44B4,2018-07-09
E512079B53179DF9A608CF4ADE47DE9D,2018-07-09
98578513E0F25350F961CDCBA9D3656F,2018-07-10
D6AE9E820354B2F2C1C3D94EF8958E58,2018-08-02
B2F661E88136265632545A030F09A88A,2018-08-05
1010A9A4D76FDDAB3C456113CC4E6C95,2018-08-06
487DE902636DD8A9844A2D61FE7BD568,2018-07-10
1B3AD9683D475EFB398E131DFE65AE61,2018-07-09
A20E7E669E319B0A1912A187C4169AEE,2018-08-06
24D41A78A6BB1244608DB32351B0658B,2018-07-17
136F2C0A18FA7D6A967EEBDC2C7E3346,2018-08-05
9BD663F05EA7660B40800C28E2BF59FC,2018-07-29
DF2C3B7E8FB37490F6F265867863951C,2018-07-13
2B9E05C9A73CE9EFCADC80CE582ADBA6,2018-08-06
37DEF17DD3761C66B7F56806F978E726,2018-07-10
A66F392F752B3A59F2644F4158644FF1,2018-08-06
01C784BDB7AF4DC8DAD6DCD21AF56E25,2018-07-12
E9DCE2D958652BD58E846DCE86BDD90A,2018-07-09
B7706BCDE12360F565E9F5DB0A5256D8,2018-07-21
31017A05A48B25FED4834F968D5D0F83,2018-07-30
E53BC2A0AD86417B443AF14EE3082C0F,2018-07-13
38383D77F69C1CAA39B0CAC891CB0E0B,2018-08-04
A6E7F3C2692459390F24A912B447B433,2018-08-07
2B86004D342C2EA67F3164372314F0C4,2018-07-09
102CC7D8CD5D3E861EACE1BAB97E61EC,2018-08-08
2F0F260BD7B876C346B41977D0D03D62,2018-07-09
3883FF0DFAB40ECD4EA781FC0D1CE18A,2018-08-22
FA53C0AFAB68963E843CD8CB6828732D,2018-08-26
E659018965C45C6546EAC732D07DABB3,2018-08-24
EACCA0856B7B7B2AEC2CB1808C1034E5,2018-07-22
27951B102A564E3FF875726564A141FF,2018-08-20
A328A685EE92F31EE8F821757E643258,2018-08-26
7548E849537562672CF9C567B9C0EC87,2018-07-10
1EA594389C7D0B4A2C68817830B0FE81,2018-08-26
91F5161F80D1083CA7B37A08DEC9EC78,2018-07-18
528939A93F1D3693AD8A56F340B7D777,2018-08-04
55BF8BB2457C1E8B554058947A484334,2018-08-26
8375B114AFAD8A31DE54283525108F75,2018-08-18
E17CB4D71A4A2CD6C79933EAC4988694,2018-08-27
E6228DCFB35D51F80DFED104E56F0C36,2018-07-18
Query:
SELECT `user_pseudo_id`, ep.key, ep.value.string_value
    FROM `firebase-public-project.analytics_153293282.events_*` AS t,
    UNNEST(t.event_params) AS ep
    WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
    LIMIT 100
Answer:
user_pseudo_id,key,string_value
56F37FD95FB21AB3976C83E803D7AEA7,firebase_conversion,
56F37FD95FB21AB3976C83E803D7AEA7,firebase_screen_class,FIRootViewController
56F37FD95FB21AB3976C83E803D7AEA7,firebase_event_origin,auto
56F37FD95FB21AB3976C83E803D7AEA7,firebase_screen_id,
40BA3CE848E99626DACC46BCCEE3E568,firebase_conversion,
40BA3CE848E99626DACC46BCCEE3E568,firebase_screen_class,FIRootViewController
40BA3CE848E99626DACC46BCCEE3E568,firebase_event_origin,auto
40BA3CE848E99626DACC46BCCEE3E568,firebase_screen_id,
C2D9D55F57CC8CFF60599E1928594368,firebase_conversion,
C2D9D55F57CC8CFF60599E1928594368,firebase_screen_class,level_select
C2D9D55F57CC8CFF60599E1928594368,firebase_event_origin,auto
C2D9D55F57CC8CFF60599E1928594368,firebase_screen_id,
A8D7DCCA39D8703F2928AD2D7BBB6BE9,firebase_conversion,
A8D7DCCA39D8703F2928AD2D7BBB6BE9,firebase_screen_class,main_menu
A8D7DCCA39D8703F2928AD2D7BBB6BE9,firebase_event_origin,auto
A8D7DCCA39D8703F2928AD2D7BBB6BE9,firebase_screen_id,
062964F7169622E4AEC91756FFB8261B,firebase_conversion,
062964F7169622E4AEC91756FFB8261B,firebase_screen_class,main_menu
062964F7169622E4AEC91756FFB8261B,firebase_event_origin,auto
062964F7169622E4AEC91756FFB8261B,firebase_screen_id,
2684EA4DDB1F988E3C979AB15CFF601F,firebase_conversion,
2684EA4DDB1F988E3C979AB15CFF601F,firebase_screen_class,FIRootViewController
2684EA4DDB1F988E3C979AB15CFF601F,firebase_event_origin,auto
2684EA4DDB1F988E3C979AB15CFF601F,firebase_screen_id,
CB06B751DAD44BB7F228F8474686D404,firebase_conversion,
CB06B751DAD44BB7F228F8474686D404,firebase_screen_class,FIRootViewController
CB06B751DAD44BB7F228F8474686D404,firebase_event_origin,auto
CB06B751DAD44BB7F228F8474686D404,firebase_screen_id,
CB06B751DAD44BB7F228F8474686D404,firebase_conversion,
CB06B751DAD44BB7F228F8474686D404,firebase_screen_class,main_menu
CB06B751DAD44BB7F228F8474686D404,firebase_event_origin,auto
CB06B751DAD44BB7F228F8474686D404,firebase_screen_id,
5358D124C06358BCD5FEF67C87052AC2,firebase_conversion,
5358D124C06358BCD5FEF67C87052AC2,firebase_screen_class,main_menu
5358D124C06358BCD5FEF67C87052AC2,firebase_event_origin,auto
5358D124C06358BCD5FEF67C87052AC2,firebase_screen_id,
2B0D8BD127A58843F3B4F8C8FE50CD77,firebase_conversion,
2B0D8BD127A58843F3B4F8C8FE50CD77,firebase_screen_class,FIRootViewController
2B0D8BD127A58843F3B4F8C8FE50CD77,firebase_event_origin,auto
2B0D8BD127A58843F3B4F8C8FE50CD77,firebase_screen_id,
5C813D5127BF4EC2AAB2B93A6406E223,firebase_conversion,
5C813D5127BF4EC2AAB2B93A6406E223,firebase_screen_class,FIRootViewController
5C813D5127BF4EC2AAB2B93A6406E223,firebase_event_origin,auto
5C813D5127BF4EC2AAB2B93A6406E223,firebase_screen_id,
E4C074EBC3729FB45CFA48D9F6EA4DFD,firebase_conversion,
E4C074EBC3729FB45CFA48D9F6EA4DFD,firebase_screen_class,FIRootViewController
Query:
SELECT DISTINCT first_sessions.`user_pseudo_id`
    FROM (
      SELECT `user_pseudo_id`, DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))) AS `first_session_date`
      FROM `firebase-public-project.analytics_153293282.events_*`
      WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
      GROUP BY `user_pseudo_id`
    ) AS first_sessions
    JOIN `firebase-public-project.analytics_153293282.events_*` AS later_sessions
    ON first_sessions.`user_pseudo_id` = later_sessions.`user_pseudo_id`
    WHERE later_sessions.`event_name` = 'session_start'
      AND DATE(TIMESTAMP_MICROS(later_sessions.`event_timestamp`)) BETWEEN DATE_ADD(first_sessions.`first_session_date`, INTERVAL 8 DAY)
      AND DATE_ADD(first_sessions.`first_session_date`, INTERVAL 14 DAY)
    LIMIT 100
Answer:
user_pseudo_id
0990A2B8DA74612120226181689C6E66
BFE99B51F316372640BDD14B9625C0F2
7C8A5B2853B828A5756F5BFAB556D6A5
1756558602A5C14A5DD2AD4B696D2191
0D9B1C51FA357A1A3487036AA037F7D0
F4F4EAE9439622EA3CA9489A52E7230F
AC5BB8A4162F0D60D28B10AB440DBC26
A7AAA5EF977926DBCF801D15F83EE4A5
5C5A0787542CD24F1E19F9EB778BA766
FEDC59699D8832A11B88BFCCCAD0951D
CA04708DA02378999ECB402481FF1AE4
932AAF56DDE9C55359B9CCFA18E7FB95
10B0D468B5E036E16D13DB53A65F2D49
D924713CB1AF85AED83BC394B164B9DC
898B790ACC7834117A9B2C98A8B6F1F5
44759496F6F519B1A4BEF55BE55C631C
C74B58C4CD2770A1E97D6DC13D42CCAC
C464722AE0E9423DE721E72B8A524141
01CFFBBD46917B080573B3A5CC322BF7
8B47681C5D1B19C3927E92404548290D
EBD6BD1C68211E5C21E1EFE514BB53FF
AD7202B296F59F58E3DDD884E9E9F40B
35D099424972413F3E46BFCA86C15295
CAB46DA4D11234BBD6AD709F01CA8241
6F1C09DFB69D4CA8B61065E9A7CFE12A
3309297C1BDD033F918A40177CF78474
BCEE3264C03284FEA9D7E709182033EC
71381569682468BBBB8936278290D669
AFEAE67E8EED1A3F43A669B7EFCBA05A
8375B114AFAD8A31DE54283525108F75
E6850F5E0DAB3E339C6A36BDEECCA26F
8601A3659DC5C1F0444E5CCDA5ED3E14
E0CE2CA5D2D361E064F990D370644897
4ED41C0527A63A25FAF988181C8F4C24
B7706BCDE12360F565E9F5DB0A5256D8
27F00948B711510BB4C0BCCEDA9B8A45
1BB448F355B22AFE32A99DF1997D2D61
6DC8E9960F2EAE5C05215ADFC160359C
933A379D75E03C0CC1316F4956C9240F
7EBEF9ABE5C8F7D340BC26927366D13C
58930F51C20661E89F5DFDB969131080
CCE60CE7DBE296A7828A028094E21D51
6D24F421B34B2CFDCF3A9983CF63D647
33BA0F066B903D1C520E3F0D54A681A5
BE89C8EA9D132E6BD866F4B3A8B1E384
3C61120F4C807953BAE7A32CCE144B9B
18688C841952131D9A6A01B81C8F65F3
FBC96171D55D518A86075798B95B7FF9
1B7FF293CEB974A6F4E4788D705FF314
ADA0082F4F191F3A9C9CBD2E2EA4750E
BC7EA6EAB18533AF121D4115DDB03673
24D41A78A6BB1244608DB32351B0658B
DAC0EAB11F253D2173A6FAA79AF5DCAB
B1BEEB89E7F8A596AA10AB384169460A
728398B33BFD42D1E1C4E909C1875843
E19F04BAB15FBA761833F71BCF5D97D3
6EDEC26E3CD2B1484254B15917E9F19B
121F942791F0082A6F10BF15C814165E
DDB627A00E4213B6A69F35DB89681AF8
7FE1548D56FE9B87CE6C14374969B4A9
A68C4D0A3F32C3F7621CA7675E9F39A6
87A95949D12E9C9263482FB202E791BD
6A2F4E7AB1816D2F6EC741BC92141766
2B5ABA17A30D32531C09DAF2865F9E55
64BB7DFAE772A77F70FB63373D0808F5
DC8912881CD30A0D8D5E2EB666D22901
6597B6D4B733197AE65E3EB21E0C8DD6
E84BFE62196E059C66D049BA9A14061C
6F2C69DE0A77E619B2D3F1782F831F7D
4A81FE8E75C780C97EEE73A7574F0B4F
1B3AD9683D475EFB398E131DFE65AE61
BBDCBE2491658165B7F20540DE652E3A
488BE19C45D3D8B2DF02214BC19B44B4
51C58309304097EFF968922A83299000
091F09F594F7507A1D6D34D006A49CD9
2B90CE94C6039DF03E72FE15B5320ABA
841727B396264112EC75FEB26C57E25C
D621943131370A102FA24B981A929573
1954CEDB269C01AD957EE1DBCB9BF812
177581DC2CAB8BCC6A840B7F47A2FEA6
5256B2B115955E80DDB7449775D92325
AB32482D193E2CE166B59F82EF78D8BB
709FCE78A03255D6EF6678E1D98783E7
CB06B751DAD44BB7F228F8474686D404
7410C5CC4FA11D31DB5F9B1D8ECD6BD0
33E5EA9FE1E29AC3127D975A5494213D
B76F1841464BFF8CF3155EF7C1FD91E4
735123CE7AF980AD5B43F31CAF2890A0
0409A1CE83D1D4DC0F01E2DFA44ED555
6C40A2B1B7C2336EDCE4B9F346682A72
EAE280AC3E0FD529D1C8A9D83598A8C2
56A3ECD9106EA59DE52682BEFFFAC53C
C7F7B410934B11C89470FE40247243A1
Query:
SELECT `user_pseudo_id`,
      DATE_TRUNC(DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))), WEEK(MONDAY)) AS `cohort_week`
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
    GROUP BY `user_pseudo_id`
    LIMIT 100
Answer:
user_pseudo_id,cohort_week
0A26E7281EC31038AD42F28C930FFF90,2018-08-27
BE36C49B1AB3968D420923AEC4FDD7AE,2018-07-09
418C1FE4FF01EA36F511E5D9073F11BD,2018-07-09
E4196C5E0A92A22F69DE4E3AA288D6EE,2018-07-09
A7642D8075588A1BE483081F553C97DF,2018-09-03
BDF5C54603EA724BB06956930ADFBF0A,2018-08-27
F98CFD1DE0862FE7834C55DE6C9ADEF5,2018-09-03
1AE81ECA4F8037BEB8E0A33D8AA6F337,2018-09-03
D6C62D17A18603EEE645F28835D54DEA,2018-09-03
E216E68E4CF209367AEC7C92119229F9,2018-09-03
443E767D3A695AD330A2607746D3B14C,2018-09-03
6158C7CD861E2F83D6AA22CCF92AEE97,2018-08-27
FBE5BE5E3836527EC27D14834D72B911,2018-09-03
91A06057C6272653B6006D7A8791DF81,2018-07-09
F9C021D9A8B84158F73A8662D76E9EE9,2018-07-16
D697779AD56B2CC1C41B5A77E3BCA81F,2018-09-03
96161BF2E55C7E32ED5F411432875ECB,2018-07-09
EB96D4E588761A891B492920DB8CDC25,2018-08-27
9F833A0D7CCA8E4BB64D57511989AF5A,2018-08-27
3946E17DD4B99C0244B86633EC1BD7DF,2018-08-27
C3817B35D57C5C1BF6225FEC9BD16534,2018-07-09
79D16DA26AB14780B3F4723E0E57769F,2018-08-27
AF070F60DBF28F26A8885E8554418C0A,2018-09-03
682A8CD0767A569DC68E7AA0201BFBA3,2018-07-09
8C33815E0A269B776AAB4B60A4F7BC63,2018-07-16
EC69270A8257323F7E911D13FE39ADD8,2018-09-03
FAADDD7E6C919B97BC67A987BE177603,2018-09-03
6CDE3BE03DAF6243A5578BCBA2D2F398,2018-07-16
3B36DABA665909A2252F013BD95F5833,2018-09-03
E0937BA260FC4C21B4465D894F8BB1E6,2018-07-16
F5DAD8DD17B689CF672D65A0A81CF4AC,2018-07-09
51012EB79345170B6D17DCD2528288D3,2018-09-03
8211CABE9A3F1FE1BF3154E0C8D30368,2018-07-09
85DB15BDADAB65F9CC1E33B872745B87,2018-07-09
F33FDFA8692C90D2F7E62C4EB3E34C30,2018-09-03
626E752BEFB7A66231B9CBEB3B4FAB1C,2018-07-16
25B3D1AFECED8B78DA6FAF65B71AF56E,2018-07-23
65619C5EB2171A0C5F0F2FCC45621725,2018-07-16
106E569E2C783529C6941598B59E9743,2018-07-23
BF9F1996AE080A0FC6CD928098FE44C8,2018-07-23
7D12F08669A7F1D4E2D12FE42431C26F,2018-07-23
8EE868DE3A7CBBFC9FBEEEBE37FABF1F,2018-07-16
EBFE0623EF1109A89B392B9DF4375951,2018-07-09
B4C5C2B97C2365FCD1125CA367293008,2018-07-09
62DD70123C14207F97E6515DDE77D76D,2018-07-23
4888671BB1FED63688415ACCC4296344,2018-07-16
55F9FB7C14AA4BAB066EA326D4A2221B,2018-07-16
7EC89D833B1186688C4891B443292546,2018-07-16
E415D4A90F9A9D8B784B3BCE2F5678B5,2018-07-23
F84549673CED44D4809888E277BA64FA,2018-07-23
D9AA0EC27AF47514DDB5C664A6EF758A,2018-07-09
DB3B6E984B29883EA02F1A504A33730F,2018-07-09
Query:
WITH first_sessions AS (
  SELECT
    `user_pseudo_id`,
    DATE_TRUNC(DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))), WEEK(MONDAY)) AS `cohort_week`
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE `event_name` = 'session_start' AND `event_date` >= '20180709'
  GROUP BY `user_pseudo_id`
)
SELECT
  `cohort_week`,
  COUNT(DISTINCT `user_pseudo_id`) AS `users_in_cohort`
FROM first_sessions
GROUP BY `cohort_week`
ORDER BY `cohort_week`
LIMIT 100
Answer:
cohort_week,users_in_cohort
2018-07-09,1317
2018-07-16,749
2018-07-23,698
2018-07-30,760
2018-08-06,609
2018-08-13,524
2018-08-20,490
2018-08-27,643
2018-09-03,1089
2018-09-10,966
2018-09-17,750
2018-09-24,721
2018-10-01,291
Query:
WITH cohorts AS (
  SELECT
    `user_pseudo_id`,
    DATE_TRUNC(DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))), WEEK(MONDAY)) AS `cohort_week`,
    DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))) AS `first_session_date`
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE `event_name` = 'session_start'
    AND `event_date` >= '20180709'
  GROUP BY `user_pseudo_id`
)
SELECT
  cohorts.`cohort_week`,
  COUNT(DISTINCT cohorts.`user_pseudo_id`) AS `retained_users`
FROM cohorts
JOIN `firebase-public-project.analytics_153293282.events_*` AS returns
  ON cohorts.`user_pseudo_id` = returns.`user_pseudo_id`
WHERE returns.`event_name` = 'session_start'
  AND DATE(TIMESTAMP_MICROS(returns.`event_timestamp`)) BETWEEN DATE_ADD(cohorts.`first_session_date`, INTERVAL 8 DAY)
    AND DATE_ADD(cohorts.`first_session_date`, INTERVAL 14 DAY)
GROUP BY cohorts.`cohort_week`
ORDER BY cohorts.`cohort_week`
LIMIT 100
Answer:
cohort_week,retained_users
2018-07-09,540
2018-07-16,180
2018-07-23,132
2018-07-30,121
2018-08-06,78
2018-08-13,74
2018-08-20,53
2018-08-27,125
2018-09-03,288
2018-09-10,147
2018-09-17,70
2018-09-24,7
Query:
WITH cohorts AS (
  SELECT
    `user_pseudo_id`,
    DATE_TRUNC(DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))), WEEK(MONDAY)) AS `cohort_week`,
    DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))) AS `first_session_date`
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE `event_name` = 'session_start'
    AND `event_date` >= '20180709'
  GROUP BY `user_pseudo_id`
),
cohort_sizes AS (
  SELECT
    `cohort_week`,
    COUNT(DISTINCT `user_pseudo_id`) AS `users_in_cohort`
  FROM cohorts
  GROUP BY `cohort_week`
),
retention_counts AS (
  SELECT
    cohorts.`cohort_week`,
    COUNT(DISTINCT cohorts.`user_pseudo_id`) AS `retained_users`
  FROM cohorts
  JOIN `firebase-public-project.analytics_153293282.events_*` AS returns
    ON cohorts.`user_pseudo_id` = returns.`user_pseudo_id`
  WHERE returns.`event_name` = 'session_start'
    AND DATE(TIMESTAMP_MICROS(returns.`event_timestamp`)) BETWEEN DATE_ADD(cohorts.`first_session_date`, INTERVAL 8 DAY)
      AND DATE_ADD(cohorts.`first_session_date`, INTERVAL 14 DAY)
  GROUP BY cohorts.`cohort_week`
)
SELECT
  cohort_sizes.`cohort_week`,
  (retention_counts.`retained_users` / cohort_sizes.`users_in_cohort`) * 100 AS `retention_rate_percentage`
FROM cohort_sizes
LEFT JOIN retention_counts
  ON cohort_sizes.`cohort_week` = retention_counts.`cohort_week`
ORDER BY cohort_sizes.`cohort_week`
LIMIT 100
Answer:
cohort_week,retention_rate_percentage
2018-07-09,41.00227790432802
2018-07-16,24.03204272363151
2018-07-23,18.911174785100286
2018-07-30,15.921052631578947
2018-08-06,12.807881773399016
2018-08-13,14.122137404580155
2018-08-20,10.816326530612246
2018-08-27,19.440124416796266
2018-09-03,26.446280991735538
2018-09-10,15.217391304347828
2018-09-17,9.333333333333334
2018-09-24,0.9708737864077669
2018-10-01,
End Exploring Related Columns
Task: Conduct a weekly cohort analysis for user retention starting from July 9, 2018, grouping users by the week of their first session start event. Calculate the retention rates for each cohort in the subsequent two weeks. Specifically, measure the percentage of users from the original cohort who returned in week 2 (two weeks after their first session). Only include users whose first session start event occurred after July 9, 2018. The data is available up to October 2, 2018 (meaning the last cohort group is for the week of September 17, 2018). For this analysis, retention is calculated based on the first session start date, and cohorts are grouped weekly starting from the first session.

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
Cohort_Week_Start_Date,Retention_Rate_Percentage
2018-07-09,retention1:float
2018-07-16,retention2:float
2018-07-23,retention3:float
2018-07-30,retention4:float
2018-08-06,retention5:float
2018-08-13,retention6:float
2018-08-20,retention7:float
2018-08-27,retention8:float
2018-09-03,retention9:float
2018-09-10,retention10:float
2018-09-17,retention11:float
(Attention: answer in 11 rows)
```

For each weekly cohort starting from July 9, 2018, we calculated the retention rate in week 2 (two weeks after their first session) as the percentage of users who had their first session during the cohort week and returned during week 2 (days 8-14 after their first session week)..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180612', 'events_20180613', 'events_20180614', 'events_20180615', 'events_20180616', 'events_20180617', 'events_20180618', 'events_20180619', 'events_20180620', 'events_20180621', 'events_20180622', 'events_20180623', 'events_20180624', 'events_20180625', 'events_20180626', 'events_20180627', 'events_20180628', 'events_20180629', 'events_20180630', 'events_20180701', 'events_20180702', 'events_20180703', 'events_20180704', 'events_20180705', 'events_20180706', 'events_20180707', 'events_20180708', 'events_20180709', 'events_20180710', 'events_20180711', 'events_20180712', 'events_20180713', 'events_20180714', 'events_20180715', 'events_20180716', 'events_20180717', 'events_20180718', 'events_20180719', 'events_20180720', 'events_20180721', 'events_20180722', 'events_20180723', 'events_20180724', 'events_20180725', 'events_20180726', 'events_20180727', 'events_20180728', 'events_20180729', 'events_20180730', 'events_20180731', 'events_20180801', 'events_20180802', 'events_20180803', 'events_20180804', 'events_20180805', 'events_20180806', 'events_20180807', 'events_20180808', 'events_20180809', 'events_20180810', 'events_20180811', 'events_20180812', 'events_20180813', 'events_20180814', 'events_20180815', 'events_20180816', 'events_20180817', 'events_20180818', 'events_20180819', 'events_20180820', 'events_20180821', 'events_20180822', 'events_20180823', 'events_20180824', 'events_20180825', 'events_20180826', 'events_20180827', 'events_20180828', 'events_20180829', 'events_20180830', 'events_20180831', 'events_20180901', 'events_20180902', 'events_20180903', 'events_20180904', 'events_20180905', 'events_20180906', 'events_20180907', 'events_20180908', 'events_20180909', 'events_20180910', 'events_20180911', 'events_20180912', 'events_20180913', 'events_20180914', 'events_20180915', 'events_20180916', 'events_20180917', 'events_20180918', 'events_20180919', 'events_20180920', 'events_20180921', 'events_20180922', 'events_20180923', 'events_20180924', 'events_20180925', 'events_20180926', 'events_20180927', 'events_20180928', 'events_20180929', 'events_20180930', 'events_20181001', 'events_20181002', 'events_20181003']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-29 20:48:24 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-29 20:48:24 - root - INFO - ```sql
WITH cohorts AS (
  SELECT
    `user_pseudo_id`,
    DATE_TRUNC(DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))), WEEK(MONDAY)) AS `Cohort_Week_Start_Date`,
    DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))) AS `first_session_date`
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE `event_name` = 'session_start'
    AND DATE(TIMESTAMP_MICROS(`event_timestamp`)) >= '2018-07-09'
    AND DATE(TIMESTAMP_MICROS(`event_timestamp`)) <= '2018-09-23'
  GROUP BY `user_pseudo_id`
),
cohort_sizes AS (
  SELECT
    `Cohort_Week_Start_Date`,
    COUNT(DISTINCT `user_pseudo_id`) AS `users_in_cohort`
  FROM cohorts
  GROUP BY `Cohort_Week_Start_Date`
),
retention_counts AS (
  SELECT
    cohorts.`Cohort_Week_Start_Date`,
    COUNT(DISTINCT cohorts.`user_pseudo_id`) AS `retained_users`
  FROM cohorts
  JOIN `firebase-public-project.analytics_153293282.events_*` AS returns
    ON cohorts.`user_pseudo_id` = returns.`user_pseudo_id`
  WHERE returns.`event_name` = 'session_start'
    AND DATE(TIMESTAMP_MICROS(returns.`event_timestamp`)) BETWEEN DATE_ADD(cohorts.`first_session_date`, INTERVAL 8 DAY)
      AND DATE_ADD(cohorts.`first_session_date`, INTERVAL 14 DAY)
  GROUP BY cohorts.`Cohort_Week_Start_Date`
)
SELECT
  cohort_sizes.`Cohort_Week_Start_Date`,
  ROUND((IFNULL(retention_counts.`retained_users`, 0) / cohort_sizes.`users_in_cohort`) * 100, 4) AS `Retention_Rate_Percentage`
FROM cohort_sizes
LEFT JOIN retention_counts
  ON cohort_sizes.`Cohort_Week_Start_Date` = retention_counts.`Cohort_Week_Start_Date`
WHERE cohort_sizes.`Cohort_Week_Start_Date` BETWEEN DATE('2018-07-09') AND DATE('2018-09-17')
ORDER BY cohort_sizes.`Cohort_Week_Start_Date`
LIMIT 11
```
2025-01-29 20:48:31 - root - INFO - itercount: 1
2025-01-29 20:48:31 - root - INFO - 0
2025-01-29 20:48:31 - root - INFO - results: 
Cohort_Week_Start_Date,Retention_Rate_Percentage
2018-07-09,40.8889
2018-07-16,24.0866
2018-07-23,18.9383
2018-07-30,15.9841
2018-08-06,12.8501
2018-08-13,14.1221
2018-08-20,10.8163
2018-08-27,19.4704
2018-09-03,26.4463
2018-09-10,15.2174
2018-09-17,9.3333


2025-01-29 20:48:31 - root - INFO - Please check the answer again by reviewing Conduct a weekly cohort analysis for user retention starting from July 9, 2018, grouping users by the week of their first session start event. Calculate the retention rates for each cohort in the subsequent two weeks. Specifically, measure the percentage of users from the original cohort who returned in week 2 (two weeks after their first session). Only include users whose first session start event occurred after July 9, 2018. The data is available up to October 2, 2018 (meaning the last cohort group is for the week of September 17, 2018). For this analysis, retention is calculated based on the first session start date, and cohorts are grouped weekly starting from the first session., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Cohort_Week_Start_Date,Retention_Rate_Percentage
2018-07-09,retention1:float
2018-07-16,retention2:float
2018-07-23,retention3:float
2018-07-30,retention4:float
2018-08-06,retention5:float
2018-08-13,retention6:float
2018-08-20,retention7:float
2018-08-27,retention8:float
2018-09-03,retention9:float
2018-09-10,retention10:float
2018-09-17,retention11:float
(Attention: answer in 11 rows)
```

For each weekly cohort starting from July 9, 2018, we calculated the retention rate in week 2 (two weeks after their first session) as the percentage of users who had their first session during the cohort week and returned during week 2 (days 8-14 after their first session week). The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Cohort_Week_Start_Date,Retention_Rate_Percentage
2018-07-09,40.8889
2018-07-16,24.0866
2018-07-23,18.9383
2018-07-30,15.9841
2018-08-06,12.8501
2018-08-13,14.1221
2018-08-20,10.8163
2018-08-27,19.4704
2018-09-03,26.4463
2018-09-10,15.2174
2018-09-17,9.3333
Current sql:
WITH cohorts AS (
  SELECT
    `user_pseudo_id`,
    DATE_TRUNC(DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))), WEEK(MONDAY)) AS `Cohort_Week_Start_Date`,
    DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))) AS `first_session_date`
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE `event_name` = 'session_start'
    AND DATE(TIMESTAMP_MICROS(`event_timestamp`)) >= '2018-07-09'
    AND DATE(TIMESTAMP_MICROS(`event_timestamp`)) <= '2018-09-23'
  GROUP BY `user_pseudo_id`
),
cohort_sizes AS (
  SELECT
    `Cohort_Week_Start_Date`,
    COUNT(DISTINCT `user_pseudo_id`) AS `users_in_cohort`
  FROM cohorts
  GROUP BY `Cohort_Week_Start_Date`
),
retention_counts AS (
  SELECT
    cohorts.`Cohort_Week_Start_Date`,
    COUNT(DISTINCT cohorts.`user_pseudo_id`) AS `retained_users`
  FROM cohorts
  JOIN `firebase-public-project.analytics_153293282.events_*` AS returns
    ON cohorts.`user_pseudo_id` = returns.`user_pseudo_id`
  WHERE returns.`event_name` = 'session_start'
    AND DATE(TIMESTAMP_MICROS(returns.`event_timestamp`)) BETWEEN DATE_ADD(cohorts.`first_session_date`, INTERVAL 8 DAY)
      AND DATE_ADD(cohorts.`first_session_date`, INTERVAL 14 DAY)
  GROUP BY cohorts.`Cohort_Week_Start_Date`
)
SELECT
  cohort_sizes.`Cohort_Week_Start_Date`,
  ROUND((IFNULL(retention_counts.`retained_users`, 0) / cohort_sizes.`users_in_cohort`) * 100, 4) AS `Retention_Rate_Percentage`
FROM cohort_sizes
LEFT JOIN retention_counts
  ON cohort_sizes.`Cohort_Week_Start_Date` = retention_counts.`Cohort_Week_Start_Date`
WHERE cohort_sizes.`Cohort_Week_Start_Date` BETWEEN DATE('2018-07-09') AND DATE('2018-09-17')
ORDER BY cohort_sizes.`Cohort_Week_Start_Date`
LIMIT 11
2025-01-29 20:49:04 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-29 20:49:04 - root - INFO - ```sql
WITH cohorts AS (
  SELECT
    `user_pseudo_id`,
    DATE_TRUNC(DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))), WEEK(MONDAY)) AS `Cohort_Week_Start_Date`,
    DATE(TIMESTAMP_MICROS(MIN(`event_timestamp`))) AS `first_session_date`
  FROM `firebase-public-project.analytics_153293282.events_*`
  WHERE `event_name` = 'session_start'
    AND DATE(TIMESTAMP_MICROS(`event_timestamp`)) >= '2018-07-09'
    AND DATE(TIMESTAMP_MICROS(`event_timestamp`)) <= '2018-09-23'
  GROUP BY `user_pseudo_id`
),
cohort_sizes AS (
  SELECT
    `Cohort_Week_Start_Date`,
    COUNT(DISTINCT `user_pseudo_id`) AS `users_in_cohort`
  FROM cohorts
  GROUP BY `Cohort_Week_Start_Date`
),
retention_counts AS (
  SELECT
    cohorts.`Cohort_Week_Start_Date`,
    COUNT(DISTINCT cohorts.`user_pseudo_id`) AS `retained_users`
  FROM cohorts
  JOIN `firebase-public-project.analytics_153293282.events_*` AS returns
    ON cohorts.`user_pseudo_id` = returns.`user_pseudo_id`
  WHERE returns.`event_name` = 'session_start'
    AND DATE(TIMESTAMP_MICROS(returns.`event_timestamp`)) BETWEEN DATE_ADD(cohorts.`first_session_date`, INTERVAL 8 DAY)
      AND DATE_ADD(cohorts.`first_session_date`, INTERVAL 14 DAY)
  GROUP BY cohorts.`Cohort_Week_Start_Date`
)
SELECT
  cohort_sizes.`Cohort_Week_Start_Date`,
  ROUND((IFNULL(retention_counts.`retained_users`, 0) / cohort_sizes.`users_in_cohort`) * 100, 4) AS `Retention_Rate_Percentage`
FROM cohort_sizes
LEFT JOIN retention_counts
  ON cohort_sizes.`Cohort_Week_Start_Date` = retention_counts.`Cohort_Week_Start_Date`
WHERE cohort_sizes.`Cohort_Week_Start_Date` BETWEEN DATE('2018-07-09') AND DATE('2018-09-17')
ORDER BY cohort_sizes.`Cohort_Week_Start_Date`
LIMIT 11
```
2025-01-29 20:49:11 - root - INFO - itercount: 2
2025-01-29 20:49:11 - root - INFO - 0
2025-01-29 20:49:11 - root - INFO - Total iteration counts: 2
