2025-01-26 20:14:21 - openai._base_client - INFO - Retrying request to /chat/completions in 0.471626 seconds
2025-01-26 20:16:00 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:16:02 - root - INFO - SQL:
SELECT p.id AS patient_id, n.family AS last_name
FROM `bigquery-public-data.fhir_synthea.patient` p,
UNNEST(p.name) AS n
WHERE LOWER(n.family) LIKE 'a%'
LIMIT 100;
Results:
patient_id,last_name
8032ad13-fc72-4a4e-b261-a3b49f50d941,Arias66
4a650a2f-292f-4848-b0c9-ec69aef45da1,Anderson154
efd1fa06-e1f9-41b8-b9c1-b98433294227,Armenta418
377c2220-ef23-4d9c-92a1-38bc5cf7160c,Araña824
0a167768-f29c-447c-a7af-47b8c2569d1d,Alonzo487
e3908397-0a9a-4bd1-a59f-d4869dffb12b,Agosto501
ce393e5a-fa61-49b3-b6b3-ef4385eaa05e,Alarcón922
d6e37e63-7baa-4cb7-9cd9-c80791cb73d9,Alonzo487
4cc91df1-d2d5-4e05-ad97-8fef8ca95251,Arteaga169
7d428e41-52f7-4da5-9e75-8ef83bd6f173,Amaya149
5d017d6e-2c18-4bf2-a6bb-3f1d4273953f,Archuleta517
7348042f-ba2c-4c08-b556-e209d0ba4436,Armstrong51
c23429d0-36da-4635-a995-f9d1969c33ed,Alcala54
9b339407-6ea3-4af3-822c-24e5c8d8ae24,Alanis890
0838849d-1912-4b57-ac3e-cf9f5417bd2b,Alanis890
8e034f99-9919-4139-8ed4-9833db502a19,Alcala54
8e034f99-9919-4139-8ed4-9833db502a19,Amador986
f28fb25f-1152-439a-a020-638f0fb89e2a,Anderson154
cc21f795-fdff-4ba2-91bb-2fd99d975330,Alarcón922
5be9c6db-616b-4a53-b016-9e433a344db5,Arredondo74
477a899e-1b9d-4708-8853-6ec902ec6b56,Adams676
9fff34d3-0ca5-4647-981c-318cd5d76e66,Aparicio848
6b9b06da-ec98-4fb5-a341-73fedbb8ee3a,Apodaca347
05ace685-be54-4909-a6e5-f87ec00d612a,Agosto501
8be0454a-f458-4f2d-9a22-8c903b64671e,Araña824
deb4ec0c-8242-4865-a554-68453680c1d4,Abernathy524
1656c34c-ec46-466b-80b4-d26a24f04c96,Arellano2
dbefd096-072a-4cb3-b581-4713cbfda254,Alfaro627
dcd38748-95d3-44eb-9021-d40eb08ab34e,Armijo730
b2df3c49-d099-497d-bcdf-aff76dc5a125,Atencio773
c2ff78c4-6187-44a4-af3a-b69fefc94a74,Alonzo487
d11aaf13-c799-4bc1-bdd4-e9633df7747c,Arellano2
816a8ac3-ce41-4884-ab58-d6acb68f3aa0,Alcaraz418
ab7957ea-e604-4e33-a89a-8391b043809a,Amador986
6c5683bb-0fc0-4283-bfe3-f4fc66694487,Abernathy524
0ead5f93-9c47-469c-b603-394b7ac8fd64,Abernathy524
d46a0f5c-10ef-4e9b-9fd6-1ed940cfef7d,Alonzo487
d46a0f5c-10ef-4e9b-9fd6-1ed940cfef7d,Arevalo970
59aa6977-9848-4cef-b00a-013656eaefe5,Aguirre875
eeb07fe8-5a14-4445-ab21-cd12d36cd3b9,Alva958
259e2cd4-7ba8-4f37-ba55-3410e4597912,Arredondo74
82b05ff3-8d7b-4c1e-8879-fd59888a42f0,Abernathy524
4a8a7419-fe30-47f9-8ad4-30c15140b3ad,Aparicio848
667d388e-3669-47a8-9a40-4320a8a4e980,Abbott774
9110049a-fa24-480d-aec0-c59291221b74,Arroyo916
ede41443-1b12-40ef-9bb9-10dc470b74f2,Alcántar600
3bfbd573-b9bc-42a9-a9cc-3ee827b1ecfc,Alonzo487
f8958356-31d2-4798-b752-3682a3e0bd59,Almanza534
095bca96-9006-4ef6-966f-ce02c81fa161,Abbott774
c0261a25-8221-44ab-97ad-4de3e82c1410,Aufderhar910
24707c06-8889-4507-a338-4dadf40818ac,Ankunding277
477604d9-1855-49dd-9e72-5b2310e1f036,Adams676
2a74a15b-dfbf-4487-943b-9a303ad6e80f,Abbott774
3478e948-a5d0-4ee8-8e12-ec5aca7df837,Aufderhar910
b47c7f5e-0939-48c0-99b8-b5ba80bd4f4a,Abbott774
83d00e41-8062-4d38-a7fa-fe9f6e00c110,Ankunding277
9bb587e2-f0f8-4b13-a96c-4e5e8b90bd7d,Aufderhar910
8ae1b460-60a3-43b2-a7cb-23976136ab97,Armstrong51
1e562e8e-dd93-4833-8265-93c58badb40a,Ankunding277
5e146d1d-4c3a-4276-9d34-26addb7637e1,Auer97
b82685dd-0d24-4ad8-8f58-4cbcde39962d,Anderson154
1db213cd-353e-47a2-a3b9-bd1717fe28b4,Abshire638

2025-01-26 20:16:03 - root - INFO - SQL:
SELECT p.id AS patient_id
FROM `bigquery-public-data.fhir_synthea.patient` p
WHERE p.deceased.boolean IS NOT TRUE
LIMIT 100;
Results:
patient_id
fa00b120-f9e9-41de-9dbb-c3380b8f5a0f
e571fb6d-ffcc-46e7-8a78-c3f093066d9f
84971c9e-1074-451b-a729-2bfd344cafa1
b0bd5ca1-a6ae-4065-b8d5-6fdae66b3706
269e13f6-7f5f-44ff-a821-7981939eed52
634e4aa8-6f96-40b5-8c1c-4fffe6602c1a
c885e763-9287-4097-bcb8-69b4971b90c1
f2ca3683-427d-4ba6-a9a8-e4082f544539
97d713c0-a256-4315-bc14-b64c92ef632b
8032ad13-fc72-4a4e-b261-a3b49f50d941
4a650a2f-292f-4848-b0c9-ec69aef45da1
efd1fa06-e1f9-41b8-b9c1-b98433294227
e19ed657-ef6b-453f-acc2-a83ebb02d0b5
fbaff489-95a6-4bb0-bf3e-784f261fed5e
d460db22-3269-4cae-bc2a-14248da4319b
cbc1e0a9-caf8-4f0e-8b1f-745041c79b94
377c2220-ef23-4d9c-92a1-38bc5cf7160c
141fbba7-6e7c-459b-8f46-c169f26815a6
6759d2b7-38b4-4798-97c0-d171a53e013a
60d4c002-16ad-4bee-a7b5-6d3c439f24b1
e42800f2-0131-46f7-8d50-79765f6690f2
b36d6b99-54f1-4714-b8ed-c9ce698f8669
0c8a7c60-4e2f-4892-9669-9e4c100f3714
b8857e9b-c89b-485a-bfd3-88ce2a1bed7b
88430cc1-fb79-4dc8-b452-475ff0b3826b
47c8ea59-f87d-45b4-8eb0-9ce7d89f667a
de558190-9339-460f-8ab8-03fe50107bd8
41dbee4d-d355-413f-a040-93ca037fe646
e194d708-8989-4e0c-a8e1-eda7351672ce
e9aaf98e-a8d1-4ed3-b819-8d31be1e23bb
cad4a6d3-fb15-46b6-b28b-e1a859fc8177
4bccdc85-c040-45dd-ada3-a55064439a01
dba01afb-7716-4b73-a645-d000e5316aea
b9b55f59-6f87-4100-bb81-63ec233b82dd
4046d1fb-e427-4a1f-88cd-968a0f553874
8dca4c3c-d2d5-460f-9168-5f18e5d29b2b
271c936d-bbd4-4bb0-aac9-809a14a05ef6
fdb661ec-55cb-4b93-afa2-d4b3149ec8da
18f2da6c-3c6c-49bf-b552-e5a0928837d2
a1a3e19f-3517-4ec1-9242-fa3050a5758b
3c2680a1-b43c-4235-9847-72fb2b68ae50
466cdc09-8fc8-4501-84fc-98364dd7d551
c86d9699-b4b1-48d3-8ddb-cdf3047f6ad0
2a283f6e-855b-477a-8edc-b24d45d85815
9af934bb-5cb2-4cac-96a1-e3016593ba87
4e80682c-c4ab-4b31-9c8f-9cf79cb39eec
0a167768-f29c-447c-a7af-47b8c2569d1d
e15f652e-8280-45b1-8f76-e02d7adbbdce
778975c8-f112-4bfa-94c0-3ca4af0f4756
32202944-d501-4b61-ba7b-d6d57d137d24
b548fb6a-ddcb-46d3-9e53-7e194b67f35a
e3908397-0a9a-4bd1-a59f-d4869dffb12b
004b807d-8af2-4b56-8476-9883e21ca399
a5fc3d65-b568-4da5-84d8-534699131169
4a2722fa-a07c-4f8f-aace-08e2f9ca2f16
75c6bad0-78f1-43c2-83b9-3e9695255d80
1d4e68d7-880f-4f3c-9436-f05831cb7bac
ce393e5a-fa61-49b3-b6b3-ef4385eaa05e
5e4a0f91-9fa9-4933-b232-6cf481e0474e
98a56443-8bb9-4054-a8d7-f5afc95e17ae
1d3118be-6168-4372-895e-7e096b4fb41f
ab3bf8af-124a-473b-a3cb-76ae45564cc0
336dffa5-ca4e-4cf3-ac91-0e1aaba48598
e397f53f-ff7a-4304-b0fa-ecefd2eb3161
576a1062-71d5-4ce7-96c9-d424ddd3ce74
772df8e6-2b47-4f93-b020-7e4af21cd6e2
8150fdde-ef55-4328-90cc-bfaf970d42d4
0d52fd3c-6769-41f9-a9f7-b5831a9e0821
d6e37e63-7baa-4cb7-9cd9-c80791cb73d9
a4ab38ad-7392-4961-9a24-fae29ef2157a
7859a29e-1494-425c-b4f9-2064295c85c1
21ee41a2-f384-4d1b-84b5-3d6f71094867
4336eeba-2805-4a29-89fb-f5a9674d4bdc
f8637589-b00f-4110-b4e9-68a1e8eaa52e
a6b6d532-e0cc-4ed0-a51d-543c49e8a396
7d10ea5d-d416-41c4-bdb4-f17214fef618
1a0a682e-3265-4f31-af7d-fd7c6fd18f93
e04fcfc1-2984-4e0c-9006-c7e90e002faf
681ed06a-b179-4aa8-852c-ea8d259abb46
158a6eae-5528-48ac-bec1-8d0aa7915fb3
a09c4f56-6f6f-441b-a4d5-54885d1faebc
932ae186-6880-4287-b570-32c9faea9df7
12b551f6-09b4-4a8a-a264-5812ee7104ff
77df8f34-896b-4d59-bc3f-c4c411a27b63
fcb3d4a0-59af-4c3d-8aab-5f5464e32a0b
a76175aa-a86b-4f3c-92f7-28912c357925
d5aca71b-d933-437b-897d-0b4aff154f33
b9b941f6-5218-4706-ad0a-f64526791d78
6feacaab-8b14-470f-8c2c-99c6600a6ae3
4e1a04d4-eb35-48f8-8d72-18b1f4c86ac1
3e2849cc-58f0-445f-ac08-66bde19546d2
4cc91df1-d2d5-4e05-ad97-8fef8ca95251
7d428e41-52f7-4da5-9e75-8ef83bd6f173

2025-01-26 20:16:05 - root - INFO - SQL:
SELECT p.id AS patient_id, n.family AS last_name
FROM `bigquery-public-data.fhir_synthea.patient` p,
UNNEST(p.name) AS n
WHERE p.deceased.boolean IS NOT TRUE
  AND LOWER(n.family) LIKE 'a%'
LIMIT 100;
Results:
patient_id,last_name
c295157a-a84e-4bd8-8584-8296d149d978,Alonso270
8319e658-4a44-4aa0-a2e8-f1a57abf2d88,Arreola736
53d8c141-c64a-4bd0-8b5d-759afa527d1b,Aparicio848
5b48d83a-74e0-4309-ba3a-86aeaafab091,Apodaca347
8a1c8c05-dd80-486c-aa01-2dd0504f688f,Ayala238
8a1c8c05-dd80-486c-aa01-2dd0504f688f,Alejandro916
a805a39e-e7bd-4c10-a6fd-8144318ecf33,Atencio773
e71f002c-e70f-4b16-a7b0-5a38a0fa0ff9,Adorno791
05ee566e-fe08-48bf-a031-3183c177d71b,Agosto501
d49d69e6-252b-4bc1-b706-882a6837d37f,Almaraz628
388b7595-ed9a-4ce9-a3af-c6d4f0d11801,Alvarado520
57f5e495-8894-43be-a19c-01d45f4cbd19,Agosto501
4d01b7a7-c541-4c2a-9b2c-54f49370d771,Abrego412
bc7c694e-cfb3-4d11-9849-e6c956db276a,Almonte426
b506efb0-3bed-4cd3-8d9a-b0dbeeb2138a,Abshire638
e65720ca-eaaa-45d0-a7d4-c5ac89be378e,Alejandro916
ceb7523f-ba7a-4525-9c0f-4c155c2cb4b6,Alejandro916
04db0933-359c-4a22-b20d-b0d90e6f4c1d,Arenas932
356d1f40-7ad5-42f3-82b2-42b41025ba26,Alanis890
02a56e10-f016-40b1-a258-375a523cee27,Anderson154
76b78875-c98d-47b5-8ffb-80d5a4e669f2,Armstrong51
dc660b45-a403-4b84-be44-dda77719b737,Alva958
39886b7f-cdfe-4763-9b69-6bdec67cb336,Acuña179
3d3e68c9-4d73-432e-a831-83c8d35802b6,Armenta418
9277d0ce-6e9c-4ce4-8a4d-9d84d83379d0,Armendáriz135
a98d9926-0c41-48c9-886f-62ff933a682f,Araña824
b7a594a7-5085-415e-a5cc-cb75f5bb38a3,Adams676
c426dacd-bec7-404f-8b45-44b3274a89b2,Avilés474
1087ffdc-5719-44bc-a555-b6496608a251,Anguiano812
fc9cc806-0e78-45fa-8a98-42790a5c44f1,Aufderhar910
6d26e7f9-1c47-43a6-9fe1-b65d05f60542,Aparicio848
231ec8df-f0d4-43b9-bee9-1c7151d20785,Arriaga291
c6a87284-9640-47d5-a7e0-fbf125706026,Alicea505
76d3c618-1892-43ef-ba9f-d8f217c3f72c,Arias66
e98ebbf3-25f4-4865-9b22-cd6d17d94d8e,Armendáriz135
a445dc8e-1a1e-4d86-87fa-a4a1f0ad15c3,Altenwerth646
104f467f-428c-47a5-97e8-247e66437d14,Almaraz628
2abbb073-952d-4b22-86ab-940a75f25c55,Aponte375
15e21607-ca96-49e0-87b5-5d1421910008,Aparicio848
a05196e0-6437-4778-8de3-0c33461eaf8b,Atencio773
114c57bc-6688-45aa-8764-e99a39bf2fad,Arreola736
b7840c6c-a571-4dfb-bcae-9ed0f49b9ac2,Arroyo916
701e5602-6ad8-4d85-be56-d5d3d1949220,Amaya149
49373865-203e-476c-9800-b4193217885e,Ayala238
4630be90-35e0-455a-8ea0-62c1493d8012,Archuleta517
ce1501c0-1cb2-4e02-ac30-43c10f0e40ef,Aufderhar910
bee98d4b-083e-482c-8ae5-03dd6b8db753,Abernathy524
de5b3688-cd27-4986-8c64-a1b363ffcfc8,Abshire638
ac62f17f-7712-461e-9278-b0cabb17d78f,Armstrong51
f2c58222-20cb-40bb-aecc-ffcd93324b72,Abshire638
6ab32895-b404-419b-9afa-f849821eaed4,Aufderhar910
5f2d7a71-d3b1-4a5d-843b-f4c04306507a,Altenwerth646
896bc5a1-eeb7-4817-8a7a-a21c2b2e66e4,Abshire638
241bb0d6-855a-4dfd-b496-329dda5e355b,Ankunding277
cebaf8b0-10f7-4247-a142-c073c508c126,Abshire638
f270cee5-40cb-4381-ada4-aec2039ee3cd,Aufderhar910
7a0615a4-1b5d-493a-b9bf-16fb40bb277c,Anderson154
77acdbe6-7136-4cb9-9f10-1683497a0f81,Adams676
515cb6d2-264c-4fc4-8464-cb908477bf30,Altenwerth646
4bb5da36-76c1-4ec3-a9bb-7e762876cbed,Adams676
662cdb73-45e2-4d68-8a30-0d43446b9f08,Altenwerth646
894eccb0-14f1-4b42-bb73-989592de65e8,Anderson154

2025-01-26 20:16:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:16:38 - root - INFO - The error you're encountering is due to how you've referenced the nested field `subject.reference` in your SQL query. In BigQuery, when accessing nested fields within a STRUCT, you should use dot notation **without enclosing the entire path in backticks**. Enclosing `subject.reference` in backticks makes BigQuery look for a field literally named `subject.reference`, which doesn't exist.

Here's the issue in your query:

```sql
SELECT c.`subject.reference` AS patient_reference, COUNT(*) AS condition_count
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.`subject.reference`
LIMIT 100;
```

**Correction:**

Remove the backticks around `subject.reference` so that BigQuery correctly interprets `subject` as a STRUCT and `reference` as a field within that STRUCT. The corrected query should look like this:

```sql
SELECT c.subject.reference AS patient_reference, COUNT(*) AS condition_count
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.subject.reference
LIMIT 100;
```

**Explanation:**

- **Accessing Nested Fields:** In BigQuery, when you have a nested field (like a STRUCT), you access its subfields using dot notation without backticks.
  - Correct: `c.subject.reference`
  - Incorrect: `c.\`subject.reference\`` (This looks for a field named `subject.reference` which doesn't exist.)

- **Backticks Usage:** Backticks are used to enclose identifiers (like table names, column names) that might otherwise be interpreted incorrectly due to spaces or special characters. However, when using dot notation for nested fields, do not enclose the entire path in backticks.

**Updated Query:**

```sql
SELECT c.subject.reference AS patient_reference, COUNT(*) AS condition_count
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.subject.reference
LIMIT 100;
```

**Next Steps:**

- **Run the Corrected Query:** Try running the updated query. It should execute without errors and return the count of conditions per patient.
  
- **Proceed with Analysis:** If you're building upon this query to analyze conditions for patients, you can now use `patient_reference` to join with the patient table or apply further filters.

**Additional Tip:**

- **Using Backticks with Nested Fields:** If you need to use backticks (for example, if your field names contain special characters or spaces), you should enclose each part separately. For instance:
  - `c.\`subject\`.\`reference\``

  But in this case, since `subject` and `reference` are standard field names without special characters, you can access them directly without backticks.

Let me know if you have any more questions or need further assistance!
2025-01-26 20:17:12 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:17:12 - root - INFO - I see that you're still encountering the same error when running your SQL query:

```sql
SELECT c.`subject.reference` AS patient_reference, COUNT(*) AS condition_count
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.`subject.reference`
LIMIT 100;
```

**Error Message:**

```
400 Name subject.reference not found inside c at [1:10]; reason: invalidQuery, location: query, message: Name subject.reference not found inside c at [1:10]
```

This error indicates that the field `subject.reference` does not exist within the table `c` (which is `condition`). Let's troubleshoot this step by step.

---

### **Understanding the Error**

- **Cause:** The field `subject.reference` is not found in the `condition` table.
- **Possible Reasons:**
  - The field `reference` may not exist within the `subject` STRUCT in the `condition` table.
  - There might be a typo or mismatch in the field names.
  - The field may have a different name, such as `subject.patientId` or `subject.id`.

---

### **Checking the Schema of the `condition` Table**

Let's examine the schema of the `condition` table, specifically the `subject` field, to identify the correct field to use.

**`condition` Table Schema Snippet:**

```plaintext
subject STRUCT<
  display STRING,
  groupId STRING,
  identifier STRUCT<...>,
  reference STRING,
  patientId STRING
>
```

**Fields within `subject`:**

- `display`
- `groupId`
- `identifier`
- `reference`
- `patientId`

---

### **Verifying Field Names**

Given the schema, `subject` in the `condition` table has the following fields:

- **`c.subject.reference`**: This field should exist based on the schema.
- **Possible Issues:**
  - The field `reference` might not be populated or could be null.
  - There might be a discrepancy between the schema and the actual data.

---

### **Testing the Fields**

To confirm the fields and their availability, let's run a simple query to inspect the `subject` field and its contents.

**Query to Inspect `subject` Fields:**

```sql
SELECT c.subject.*, c.id
FROM `bigquery-public-data.fhir_synthea.condition` c
LIMIT 10;
```

**Alternate Query to See Available Fields:**

```sql
SELECT c.id, c.subject
FROM `bigquery-public-data.fhir_synthea.condition` c
LIMIT 10;
```

**Steps:**

1. **Run the above query to see the actual fields available within `c.subject`.**
2. **Check if `reference` is present and contains data.**
3. **If `reference` is not available or empty, consider using an alternative field like `patientId`.**

---

### **Possible Solution**

Given that the error persists, it's possible that `c.subject.reference` is not the correct field to use. Instead, you might need to use `c.subject.patientId` or another available field.

**Updated Query Using `patientId`:**

```sql
SELECT c.subject.patientId AS patient_id, COUNT(*) AS condition_count
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.subject.patientId
LIMIT 100;
```

---

### **Explanation of Changes**

- **Changed Field:** Used `c.subject.patientId` instead of `c.subject.reference`.
- **Reason:** If `subject.reference` is not found, but `subject.patientId` exists, using it can correctly reference the patient.

**Important Note:**

- Ensure that the field you use to group by (`patient_id` in this case) matches the field available in the `condition` table and can be used to join with the patient IDs in the `patient` table.

---

### **Next Steps**

1. **Run the Updated Query:**

   ```sql
   SELECT c.subject.patientId AS patient_id, COUNT(*) AS condition_count
   FROM `bigquery-public-data.fhir_synthea.condition` c
   GROUP BY c.subject.patientId
   LIMIT 100;
   ```

   - **Expected Outcome:** This should execute without errors and provide you with the count of conditions per patient.

2. **Verify the Results:**

   - Check if `patient_id` values match the IDs in the `patient` table.
   - Ensure that the counts make sense (e.g., patients with multiple conditions have higher counts).

3. **Adjust Subsequent Queries:**

   - When joining with the `patient` table, join on `patient_id` instead of `patient_reference`.
   - Modify any other queries that use `subject.reference` to use the correct field.

---

### **Alternative Approach**

If neither `subject.reference` nor `subject.patientId` works, you can consider the following approach:

1. **List All Fields in `subject`:**

   ```sql
   SELECT
     ARRAY_TO_STRING(ARRAY_AGG(column_name), ', ') AS fields
   FROM
     `bigquery-public-data.fspa.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS`
   WHERE
     table_name = 'condition'
     AND column_name LIKE 'subject.%'
   ```

   - This query lists all fields under `subject`.

2. **Use Available Fields:**

   - Use one of the available fields to group by and join with the `patient` table.
   - Common fields might include `subject.id` or `subject.display`.

---

### **Final Adjusted Query for Your Task**

Assuming `patient_id` is the correct field, here's how you might adjust your overall query to find the conditions:

```sql
SELECT coding.display AS Condition_Name, coding.code AS Condition_Code, MAX(patient_med_counts.medication_count) AS Max_Number_of_Different_Meds_Prescribed
FROM (
  SELECT p.id AS patient_id, COUNT(DISTINCT med_coding.code) AS medication_count
  FROM `bigquery-public-data.fhir_synthea.patient` p,
  UNNEST(p.name) AS n
  JOIN `bigquery-public-data.fhir_synthea.medication_request` mr
    ON mr.subject.patientId = p.id
  JOIN UNNEST(mr.medication.codeableConcept.coding) AS med_coding
  WHERE p.deceased.boolean IS NOT TRUE
    AND LOWER(n.family) LIKE 'a%'
    AND (
      SELECT COUNT(*)
      FROM `bigquery-public-data.fhir_synthea.condition` c
      WHERE c.subject.patientId = p.id
    ) = 1
  GROUP BY p.id
) AS patient_med_counts
JOIN `bigquery-public-data.fhir_synthea.condition` c
  ON c.subject.patientId = patient_med_counts.patient_id
JOIN UNNEST(c.code.coding) AS coding
GROUP BY coding.display, coding.code
ORDER BY Max_Number_of_Different_Meds_Prescribed DESC
LIMIT 8;
```

**Note:**

- **Used `subject.patientId`** in place of `subject.reference`.
- **Adjusted JOIN conditions** to match on `patientId`.
- **Ensured that all references to patient IDs are consistent across tables.**

---

### **Conclusion**

The error you're encountering is due to the field `subject.reference` not existing in the `condition` table. By identifying and using the correct field, such as `subject.patientId`, you should be able to execute your query successfully.

---

### **Summary of Steps to Resolve the Error**

1. **Check the Schema:** Verify the exact field names in the `condition` table.
2. **Inspect Data:** Run simple queries to see the contents of `subject`.
3. **Adjust Field References:** Use the correct field to reference patients (e.g., `subject.patientId`).
4. **Update Queries:** Modify your queries accordingly to use the correct field names.
5. **Run and Test:** Execute the updated queries and verify the results.

---

If you continue to encounter issues, please let me know, and I'll be happy to assist further!
2025-01-26 20:18:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:18:01 - root - INFO - It appears you're still encountering the same error when running your SQL query:

```sql
SELECT c.`subject.reference` AS patient_reference, COUNT(*) AS condition_count
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.`subject.reference`
LIMIT 100;
```

**Error Message:**

```
400 Name subject.reference not found inside c at [1:10]; reason: invalidQuery, location: query, message: Name subject.reference not found inside c at [1:10]
```

This error occurs because BigQuery cannot find the field `subject.reference` in the table `c` (which is `bigquery-public-data.fhir_synthea.condition`). Let's investigate and resolve this issue.

---

### **Understanding the Error**

The error suggests that the field `subject.reference` does not exist in the `condition` table. This could be due to:

1. **Incorrect Field Name:** The field may have a different name.
2. **Incorrect Usage of Backticks:** Enclosing `subject.reference` in backticks may cause BigQuery to look for a field named exactly `subject.reference`, which doesn't exist.

---

### **Solving the Issue**

#### **1. Check the Structure of the `condition` Table**

Let's verify the fields available within the `subject` field of the `condition` table.

**Table Structure of `condition`:**

From the DDL provided, the `subject` field in the `condition` table is a STRUCT with the following fields:

```plaintext
subject STRUCT<
  display STRING,
  groupId STRING,
  identifier STRUCT<...>,
  reference STRING,
  patientId STRING
>
```

---

#### **2. Correct the Field Reference**

Given the structure, we should access the `reference` field within `subject` without enclosing it in backticks around the dot notation.

**Corrected Query:**

```sql
SELECT c.subject.reference AS patient_reference, COUNT(*) AS condition_count
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.subject.reference
LIMIT 100;
```

**Explanation:**

- **Remove Backticks:** Remove the backticks around `subject.reference`. When you enclose `subject.reference` in backticks like `` `subject.reference` ``, BigQuery looks for a field named `subject.reference`, which doesn't exist.
- **Use Dot Notation Properly:** Access the nested field using dot notation without backticks, as `c.subject.reference`.

---

#### **3. Verify Field Names and Cases**

BigQuery is case-sensitive regarding field names. Ensure that the field names are correctly cased.

- **Check for Correct Field Names:** Is the field named `reference`, or could it be `Reference`?
- **Field Existence:** Confirm that `subject.reference` exists in your table.

---

#### **4. View Available Fields in `subject`**

If the error persists, let's examine the fields available within `c.subject` to ensure `reference` exists.

**Query to Inspect `subject` Fields:**

```sql
SELECT
  c.subject,
  c.subject.*
FROM
  `bigquery-public-data.fhir_synthea.condition` c
LIMIT 10;
```

**Steps:**

- Run the above query to display the contents of `subject` and its nested fields.
- Check if the `reference` field is present and correctly named.

---

#### **5. Use an Alternative Field if Necessary**

If `subject.reference` does not exist, but a different field like `subject.patientId` is available, use that instead.

**Adjusted Query Using `subject.patientId`:**

```sql
SELECT c.subject.patientId AS patient_id, COUNT(*) AS condition_count
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.subject.patientId
LIMIT 100;
```

---

### **Possible Scenarios and Solutions**

#### **Scenario A: `subject.reference` Exists**

If `c.subject.reference` exists, the corrected query without backticks should work.

**Run:**

```sql
SELECT c.subject.reference AS patient_reference, COUNT(*) AS condition_count
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.subject.reference
LIMIT 100;
```

#### **Scenario B: `subject.reference` Does Not Exist**

If `subject.reference` does not exist, but `subject.patientId` does, use `subject.patientId`.

**Run:**

```sql
SELECT c.subject.patientId AS patient_id, COUNT(*) AS condition_count
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.subject.patientId
LIMIT 100;
```

---

### **Explanation of Backticks Usage**

- **Backticks in BigQuery:** Used to enclose identifiers (like table or column names) that might be reserved words or contain special characters.
- **Dot Notation:** When accessing nested fields, do not enclose the entire path in backticks. Instead, if needed, enclose each identifier separately.

**Incorrect:**

```sql
c.`subject.reference`
```

**Correct:**

```sql
c.subject.reference
```

Or, if special characters are involved:

```sql
c.`subject`.`reference`
```

---

### **Next Steps**

1. **Remove Backticks and Try Again:**

   - Remove the backticks around `subject.reference`.
   - Run the corrected query.

2. **Check for Field Existence:**

   - If the error persists, verify whether `subject.reference` exists.
   - Use `c.subject.patientId` if `reference` is not available.

3. **Adjust Joins and Conditions:**

   - If you use `subject.patientId`, ensure that you adjust your joins and conditions in subsequent queries accordingly.

---

### **Final Adjusted Query**

Assuming `subject.reference` exists and the issue was with backticks:

```sql
SELECT c.subject.reference AS patient_reference, COUNT(*) AS condition_count
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.subject.reference
LIMIT 100;
```

If `subject.reference` does not exist but `subject.patientId` does:

```sql
SELECT c.subject.patientId AS patient_reference, COUNT(*) AS condition_count
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.subject.patientId
LIMIT 100;
```

---

### **Additional Tips**

- **Check for Null Values:** Ensure that the `subject` field and its subfields are not null.
- **Consistency in Field Names:** Use consistent field names throughout your queries.
- **Field Name Accuracy:** Pay attention to singular vs. plural and any potential typos.

---

### **Conclusion**

The error you're encountering is due to BigQuery not finding the field `subject.reference` inside the `condition` table. By removing the backticks and ensuring that the field name is correct, you should be able to resolve the issue.

If you continue to experience problems, please run the query to inspect the contents of `subject` and share any findings or additional error messages, so I can assist you further.

Let me know if you need any more help!
2025-01-26 20:18:02 - root - INFO - SQL:
SELECT c.`subject.reference` AS patient_reference, COUNT(*) AS condition_count
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.`subject.reference`
LIMIT 100;
Results:
400 Name subject.reference not found inside c at [1:10]; reason: invalidQuery, location: query, message: Name subject.reference not found inside c at [1:10]

Location: US
Job ID: d9c2ba0a-0e36-4908-b35a-565528118884

2025-01-26 20:18:50 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:18:50 - root - INFO - I see that you're still encountering the same error when running your SQL query:

```sql
SELECT c.`subject.reference` AS patient_reference
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.`subject.reference`
HAVING COUNT(*) = 1
LIMIT 100;
```

**Error Message:**

```
400 Name subject.reference not found inside c at [1:10]; reason: invalidQuery, location: query, message: Name subject.reference not found inside c at [1:10]
```

---

### **Explanation of the Error**

The error is occurring because BigQuery cannot find a field named `subject.reference` within the table alias `c` (which represents the `condition` table). The issue arises due to how the nested field is being referenced in your query.

In BigQuery, when you enclose `subject.reference` within backticks like so: ``c.`subject.reference` ``, BigQuery interprets it as a single field name `subject.reference`, rather than accessing the `reference` field within the `subject` STRUCT.

---

### **Solution**

To fix this issue, you should:

1. **Remove the Backticks Around `subject.reference`:** Instead of enclosing `subject.reference` within backticks, access the nested field using dot notation without backticks.

2. **Ensure the Field Exists:** Verify that the `reference` field exists within the `subject` STRUCT in the `condition` table.

---

### **Corrected Query**

```sql
SELECT c.subject.reference AS patient_reference
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.subject.reference
HAVING COUNT(*) = 1
LIMIT 100;
```

**Explanation:**

- **Removed Backticks:** I removed the backticks around `subject.reference`. Now, BigQuery will correctly interpret `c.subject.reference` as accessing the `reference` field within the `subject` STRUCT of table `c`.

- **Accessing Nested Fields:** In BigQuery, to access a nested field within a STRUCT, you use dot notation without enclosing the entire path in backticks.

---

### **Verifying the Field `subject.reference`**

If you still encounter an error after removing the backticks, it's possible that the `reference` field does not exist within `subject` in the `condition` table. Let's verify the fields inside `subject`.

**Inspecting the Fields in `subject`:**

You can run the following query to see the available fields within `subject`:

```sql
SELECT
  c.subject
FROM
  `bigquery-public-data.fhir_synthea.condition` c
LIMIT 10;
```

Or to see all fields in `subject`:

```sql
SELECT
  c.subject.*,
  c.id
FROM
  `bigquery-public-data.fhir_synthea.condition` c
LIMIT 10;
```

**Check for Fields:**

- **Possible Fields in `subject`:**
  - `display`
  - `groupId`
  - `identifier`
  - `reference`
  - `patientId`

---

### **Alternative Field: Using `patientId`**

If `subject.reference` is not available, but `subject.patientId` exists, you can modify your query to use `subject.patientId`.

**Modified Query Using `subject.patientId`:**

```sql
SELECT c.subject.patientId AS patient_reference
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.subject.patientId
HAVING COUNT(*) = 1
LIMIT 100;
```

---

### **Summary**

- **Issue:** The error occurs because BigQuery cannot find a field named `subject.reference` when it is enclosed in backticks.

- **Resolution:** Remove the backticks around `subject.reference` and ensure the field exists in the table.

- **Alternative:** If `subject.reference` doesn't exist, use another relevant field like `subject.patientId`.

---

### **Testing the Corrected Query**

Please try running the corrected query:

```sql
SELECT c.subject.reference AS patient_reference
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.subject.reference
HAVING COUNT(*) = 1
LIMIT 100;
```

If it still doesn't work, try the alternative:

```sql
SELECT c.subject.patientId AS patient_reference
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.subject.patientId
HAVING COUNT(*) = 1
LIMIT 100;
```

---

### **Next Steps**

1. **Run the Corrected Query:** Execute the query without backticks around `subject.reference`.

2. **Verify Field Existence:** If the error persists, run a query to inspect the fields within `c.subject`.

3. **Adjust Your Query Accordingly:** Use the correct field (`reference` or `patientId`) based on what's available.

4. **Consistency in Joins and Conditions:** Ensure that you use the same field when joining with other tables, like `patient`.

---

### **Additional Information**

- **Backticks Usage:** In BigQuery, backticks are used to enclose identifiers (like table names or column names) that might contain special characters or are reserved keywords. When accessing nested fields, do not enclose the entire path in backticks.

  **Incorrect:**

  ```sql
  c.`subject.reference`
  ```

  **Correct:**

  ```sql
  c.subject.reference
  ```

- **Dot Notation:** Use dot notation to access nested fields within a STRUCT.

---

### **Conclusion**

The error you're experiencing is due to incorrect referencing of a nested field. By removing the backticks and ensuring you reference the correct field, you should be able to execute your query successfully.

Please let me know if you need further assistance or if you encounter any more issues.
2025-01-26 20:19:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:19:38 - root - INFO - I understand you're still encountering the same error when running your SQL query:

```sql
SELECT c.`subject.reference` AS patient_reference
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.`subject.reference`
HAVING COUNT(*) = 1
LIMIT 100;
```

**Error Message:**

```
400 Name subject.reference not found inside c at [1:10]; reason: invalidQuery, location: query, message: Name subject.reference not found inside c at [1:10]
```

---

### **Cause of the Error**

The error occurs because the field `subject.reference` does not exist in the `condition` table. Enclosing `subject.reference` in backticks makes BigQuery look for a field named literally `subject.reference`, which doesn't exist.

However, even without backticks, if the field `subject.reference` doesn't exist, you will still get an error.

---

### **Solution**

Let's find the correct field to use for the patient reference in the `condition` table.

#### **1. Inspect the `subject` Field in the `condition` Table**

Run the following query to see what fields are available within `subject`:

```sql
SELECT
  c.subject,
  c.subject.*
FROM
  `bigquery-public-data.fhir_synthea.condition` c
LIMIT 10;
```

**Explanation:**

- This query will display the `subject` field and all of its subfields for the first 10 records.
- You'll be able to see the exact field names available within `subject`.

#### **2. Identify the Available Fields**

Based on the schema provided and common FHIR structures, the `subject` field may contain the following subfields:

- `subject.patientId`
- `subject.reference`
- `subject.display`
- `subject.identifier`

**However**, given that you're receiving an error, it's likely that `subject.reference` does not exist in this dataset.

#### **3. Use `subject.patientId` Instead**

If `subject.patientId` is available, you can use it as the patient reference.

**Adjusted Query:**

```sql
SELECT c.subject.patientId AS patient_reference
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.subject.patientId
HAVING COUNT(*) = 1
LIMIT 100;
```

**Explanation:**

- We're now using `c.subject.patientId` instead of `c.subject.reference`.
- This should resolve the error if `patientId` exists within `subject`.

---

### **Verifying Field Existence**

To confirm that `subject.patientId` exists, you can run:

```sql
SELECT
  c.subject.patientId,
  c.subject.*
FROM
  `bigquery-public-data.fhir_synthea.condition` c
LIMIT 10;
```

If `patientId` is present and contains patient IDs, you can proceed with using it in your queries.

---

### **Adjusting the Original Query**

Now, let's adjust your query accordingly.

**Original Query with Adjustments:**

```sql
SELECT c.subject.patientId AS patient_reference
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.subject.patientId
HAVING COUNT(*) = 1
LIMIT 100;
```

**Additional Adjustments for Later Queries:**

When joining with the `patient` table or other tables, use `patient.id` and `condition.subject.patientId` to join the data.

---

### **Important Notes**

- **Backticks Usage:** In BigQuery, backticks are used to enclose identifiers that are reserved words or contain special characters. Do not enclose nested field paths in backticks as a whole. Instead, if necessary, enclose each part individually.

  **Incorrect:** `c.\`subject.reference\``

  **Correct:** `c.subject.reference` or `c.\`subject\`.\`reference\``

- **Field Names Are Case-Sensitive:** Ensure that you're using the correct case for field names. For example, `patientId` vs. `patientid`.

---

### **Testing the Adjusted Query**

Please try running the adjusted query:

```sql
SELECT c.subject.patientId AS patient_reference
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.subject.patientId
HAVING COUNT(*) = 1
LIMIT 100;
```

---

### **If `patientId` Does Not Exist**

If `subject.patientId` does not exist, check for other fields within `subject` that might reference the patient.

#### **3. Check for `subject.identifier`**

- If `subject.identifier` exists, it may contain the patient ID.
- However, `subject.identifier` may be an array or a struct, so additional handling may be needed.

**Example Query to Inspect `subject.identifier`:**

```sql
SELECT
  c.subject.identifier
FROM
  `bigquery-public-data.fhir_synthea.condition` c
LIMIT 10;
```

**Handling `subject.identifier`:**

- If `c.subject.identifier` is an array, you may need to `UNNEST` it.

**Example:**

```sql
SELECT
  ident.value AS patient_id
FROM
  `bigquery-public-data.fhir_synthea.condition` c,
  UNNEST(c.subject.identifier) AS ident
LIMIT 10;
```

#### **4. Use `subject.display` as a Last Resort**

- `subject.display` may contain the patient's name or ID.
- Check if it can be used to uniquely identify patients.

---

### **Summary**

- The error occurs because `subject.reference` does not exist in the `condition` table.
- Use `subject.patientId` if available.
- If not, inspect `subject` to find an appropriate field to reference the patient.
- Adjust your queries to use the correct field.

---

### **Final Recommendations**

1. **Inspect the `subject` Field:**

   - Run the queries to see which fields are available within `subject`.

2. **Adjust Your Queries:**

   - Use the appropriate field (`patientId`, `identifier`, etc.) based on your findings.

3. **Ensure Consistency:**

   - Use the same field throughout your queries when joining tables or applying filters.

4. **Test Incrementally:**

   - After adjusting the query, run it and verify the results before proceeding further.

---

### **Example of Adjusted Query for Your Task**

Assuming `subject.patientId` is available and can be used, here's how you can adjust your main query:

```sql
SELECT coding.display AS Condition_Name, coding.code AS Condition_Code, MAX(patient_med_counts.medication_count) AS Max_Number_of_Different_Meds_Prescribed
FROM (
  SELECT p.id AS patient_id, COUNT(DISTINCT med_coding.code) AS medication_count
  FROM `bigquery-public-data.fhir_synthea.patient` p,
  UNNEST(p.name) AS n
  JOIN `bigquery-public-data.fhir_synthea.medication_request` mr
    ON mr.subject.patientId = p.id
  JOIN UNNEST(mr.medication.codeableConcept.coding) AS med_coding
  WHERE p.deceased.boolean IS NOT TRUE
    AND LOWER(n.family) LIKE 'a%'
    AND (
      SELECT COUNT(*)
      FROM `bigquery-public-data.fhir_synthea.condition` c
      WHERE c.subject.patientId = p.id
    ) = 1
  GROUP BY p.id
) AS patient_med_counts
JOIN `bigquery-public-data.fhir_synthea.condition` c
  ON c.subject.patientId = patient_med_counts.patient_id
JOIN UNNEST(c.code.coding) AS coding
GROUP BY coding.display, coding.code
ORDER BY Max_Number_of_Different_Meds_Prescribed DESC
LIMIT 8;
```

---

Please let me know if you need further assistance or if you encounter any other issues!
2025-01-26 20:20:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:20:33 - root - INFO - I see that you're still encountering the same error when running your SQL query:

```sql
SELECT c.`subject.reference` AS patient_reference
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.`subject.reference`
HAVING COUNT(*) = 1
LIMIT 100;
```

**Error Message:**

```
400 Name subject.reference not found inside c at [1:10]; reason: invalidQuery
```

---

### **Explanation of the Error**

The error occurs because the field `subject.reference` does not exist within the `condition` table as you're referencing it. Enclosing `subject.reference` in backticks makes BigQuery look for a field named literally `subject.reference`, which doesn't exist.

Additionally, even without backticks, if `subject.reference` does not exist in the table schema, you'll still encounter an error.

---

### **Solution**

Let's identify the correct field to use:

#### **1. Inspect the Schema of the `condition` Table**

Let's examine the `subject` field within the `condition` table to find the appropriate field that references the patient.

You can run the following query to see the available fields:

```sql
SELECT c.subject.*
FROM `bigquery-public-data.fhir_synthea.condition` c
LIMIT 10;
```

---

#### **2. Identify Available Fields in `subject`**

From the dataset schema, the `subject` field in the `condition` table likely contains the following subfields:

- **`patientId`**: Contains the patient's ID. This is often used to reference the patient.
- **`reference`**: May or may not be present.
- **`identifier`**: Could contain patient identifiers.
- **`display`**: May contain the patient's name.

Given that `subject.reference` is causing an error, it's possible that `subject.patientId` is the correct field to use.

---

#### **3. Adjust Your Query to Use `subject.patientId`**

Here's the adjusted query:

```sql
SELECT c.subject.patientId AS patient_reference
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.subject.patientId
HAVING COUNT(*) = 1
LIMIT 100;
```

**Explanation:**

- **Replace `c.`subject.reference`** with `c.subject.patientId`.
- **Ensure No Backticks**: Do not enclose the field path in backticks unless necessary, and if you do, enclose each identifier separately.

---

### **Verify the Existence of `subject.patientId`**

To ensure that `subject.patientId` exists and contains the patient ID, run:

```sql
SELECT c.subject.patientId
FROM `bigquery-public-data.fhir_synthea.condition` c
WHERE c.subject.patientId IS NOT NULL
LIMIT 10;
```

If you get results, `subject.patientId` is the correct field to use.

---

### **Alternative Fields**

If `subject.patientId` does not exist, check for other fields:

#### **Option A: Using `subject.patient_id`**

Sometimes, field names can be slightly different, like `patient_id` instead of `patientId`.

**Try:**

```sql
SELECT c.subject.patient_id AS patient_reference
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.subject.patient_id
HAVING COUNT(*) = 1
LIMIT 100;
```

#### **Option B: Using `subject.reference` Without Backticks**

If `subject.reference` does exist but was being misreferenced due to backticks:

```sql
SELECT c.subject.reference AS patient_reference
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.subject.reference
HAVING COUNT(*) = 1
LIMIT 100;
```

---

### **Important Notes**

- **Backticks Usage**: In BigQuery, backticks are used to enclose identifiers (like table or column names) that might be reserved words or contain special characters. When accessing nested fields, do not enclose the entire path in backticks.

  **Incorrect:**

  ```sql
  c.`subject.reference`
  ```

  **Correct:**

  ```sql
  c.subject.reference
  ```

- **Field Names Are Case-Sensitive**: Ensure that you're using the correct case (`patientId` vs. `patient_id`).

---

### **Next Steps**

1. **Run the Adjusted Query**: Use `c.subject.patientId` without backticks.

2. **Inspect the Data**: If the query still fails, run a query to list all fields in `subject`:

   ```sql
   SELECT c.subject
   FROM `bigquery-public-data.fhir_synthea.condition` c
   LIMIT 10;
   ```

3. **Find the Correct Field**: Identify which field within `subject` contains the patient ID.

4. **Adjust Your Query Accordingly**: Modify your query to use the correct field.

---

### **Example of the Adjusted Query in Your Context**

Assuming `subject.patientId` is the correct field, here's how you can adjust your main query:

```sql
SELECT coding.display AS Condition_Name,
       coding.code AS Condition_Code,
       MAX(patient_med_counts.medication_count) AS Max_Number_of_Different_Meds_Prescribed
FROM (
  SELECT p.id AS patient_id,
         COUNT(DISTINCT med_coding.code) AS medication_count
  FROM `bigquery-public-data.fhir_synthea.patient` p,
       UNNEST(p.name) AS n
  JOIN `bigquery-public-data.fhir_synthea.medication_request` mr
    ON mr.subject.patientId = p.id
  JOIN UNNEST(mr.medication.codeableConcept.coding) AS med_coding
  WHERE p.deceased.boolean IS NOT TRUE
    AND LOWER(n.family) LIKE 'a%'
    AND (
      SELECT COUNT(*)
      FROM `bigquery-public-data.fhir_synthea.condition` c
      WHERE c.subject.patientId = p.id
    ) = 1
  GROUP BY p.id
) AS patient_med_counts
JOIN `bigquery-public-data.fhir_synthea.condition` c
  ON c.subject.patientId = patient_med_counts.patient_id
JOIN UNNEST(c.code.coding) AS coding
GROUP BY coding.display, coding.code
ORDER BY Max_Number_of_Different_Meds_Prescribed DESC
LIMIT 8;
```

---

### **Summary**

- **Issue**: The field `subject.reference` does not exist as referenced.
- **Solution**: Use `subject.patientId` or another valid field within `subject`.
- **Action**: Adjust your queries to reference existing fields without unnecessary backticks.

---

Please let me know if you have any questions or need further assistance!
2025-01-26 20:20:34 - root - INFO - SQL:
SELECT c.`subject.reference` AS patient_reference
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.`subject.reference`
HAVING COUNT(*) = 1
LIMIT 100;
Results:
400 Name subject.reference not found inside c at [1:10]; reason: invalidQuery, location: query, message: Name subject.reference not found inside c at [1:10]

Location: US
Job ID: e3b49b5c-28f4-4016-ae90-82dc88a3fc02

2025-01-26 20:20:36 - root - INFO - SQL:
SELECT c.id AS condition_id, coding.code AS condition_code, coding.display AS condition_name
FROM `bigquery-public-data.fhir_synthea.condition` c,
UNNEST(c.code.coding) AS coding
LIMIT 100;
Results:
condition_id,condition_code,condition_name
7c249213-3ea8-49b7-8e5e-a0fd0c8ffe93,1734006,Fracture of the vertebral column with spinal cord injury
33b0d2db-f403-43b3-820b-8838d0eebc7a,1734006,Fracture of the vertebral column with spinal cord injury
1ae511ec-c9b2-48e0-a5a8-763c72b75db5,1734006,Fracture of the vertebral column with spinal cord injury
bcc2fbd9-94b1-4ad1-9ed5-6feb734a4b07,1734006,Fracture of the vertebral column with spinal cord injury
6d59d9d0-6cb7-4f77-8e07-62dfd6358f06,1734006,Fracture of the vertebral column with spinal cord injury
e656df2b-3e3c-455b-b90f-2e76a488fe78,1734006,Fracture of the vertebral column with spinal cord injury
19548a9f-aad1-4b6a-afe6-bffa9d9ae5d0,1734006,Fracture of the vertebral column with spinal cord injury
822f9079-162c-4316-9a93-48ffc50d0d95,1734006,Fracture of the vertebral column with spinal cord injury
b0ed95c1-fff1-4186-8e4b-dac7b8ae35b7,1734006,Fracture of the vertebral column with spinal cord injury
ba394dd4-c1d9-44a5-b1ee-ff7bc86faa1e,1734006,Fracture of the vertebral column with spinal cord injury
966cf5b7-5297-44da-bc34-d513c3b7906e,1734006,Fracture of the vertebral column with spinal cord injury
a9865864-6b9c-4034-8b95-c680937687c9,1734006,Fracture of the vertebral column with spinal cord injury
9e0eb2ee-8d32-4cf8-8351-d264416bd1b5,1734006,Fracture of the vertebral column with spinal cord injury
ed9e1015-29fe-432d-a057-f9322f2c74fc,1734006,Fracture of the vertebral column with spinal cord injury
52b07731-cdcd-4bff-b085-5b52fe7fe1fe,1734006,Fracture of the vertebral column with spinal cord injury
436bd893-609a-4fa4-a64c-b962449c0ba2,1734006,Fracture of the vertebral column with spinal cord injury
3c34c57e-4497-4c0f-8fe6-5e5c18308aae,1734006,Fracture of the vertebral column with spinal cord injury
2da54a05-7d57-4245-ae1f-ea3b07c9d296,1734006,Fracture of the vertebral column with spinal cord injury
5d947e07-59b8-4744-8029-f5917f257191,1734006,Fracture of the vertebral column with spinal cord injury
c0d4afc1-0e2f-4042-a2ac-23aca316f900,1734006,Fracture of the vertebral column with spinal cord injury
ea8cdf09-64a7-4714-99e0-c3c379348691,1734006,Fracture of the vertebral column with spinal cord injury
46620e73-5db6-4b00-848a-f2751b43c361,1734006,Fracture of the vertebral column with spinal cord injury
2151378e-0735-41fd-93b6-3960022a7736,1734006,Fracture of the vertebral column with spinal cord injury
eb802576-b5e3-4dd3-a4f6-81bbbd7721f0,1734006,Fracture of the vertebral column with spinal cord injury
88cf7e1f-aa28-4fc8-aa7b-60da50c0a833,1734006,Fracture of the vertebral column with spinal cord injury
f165026e-74d4-420b-ad39-05d88c163b89,1734006,Fracture of the vertebral column with spinal cord injury
3d83d9f0-eb03-478f-931a-d2b34c2a0111,1734006,Fracture of the vertebral column with spinal cord injury
df37b95f-1329-42d5-955a-48905ee2a17f,5602001,Opioid abuse (disorder)
04b40727-8410-41d3-8a61-f2e6e7437e25,5602001,Opioid abuse (disorder)
7197914b-a2ae-4fe1-b6de-0b3e260c5d5c,5602001,Opioid abuse (disorder)
33bc953c-4bc5-44e5-b4fa-a41361522e7b,5602001,Opioid abuse (disorder)
ca4919df-80c8-4114-b4f8-d2332abbe7d1,5602001,Opioid abuse (disorder)

2025-01-26 20:21:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:21:14 - root - INFO - I see that you're encountering an error when running your SQL query:

```sql
SELECT mr.id AS medication_request_id, mr.`subject.reference` AS patient_reference, med_coding.code AS medication_code
FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
UNNEST(mr.medication.codeableConcept.coding) AS med_coding
LIMIT 100;
```

**Error Message:**

```
400 Name subject.reference not found inside mr at [1:43]; reason: invalidQuery, location: query, message: Name subject.reference not found inside mr at [1:43]
```

---

### **Explanation of the Error**

The error occurs because BigQuery cannot find the field `subject.reference` within the table alias `mr` (which represents the `medication_request` table). The issue is due to how you are referencing the nested field `subject.reference` in your query.

In BigQuery, when accessing nested fields within a STRUCT, you should use dot notation **without enclosing the entire path in backticks**. Enclosing `subject.reference` in backticks makes BigQuery look for a field named literally `subject.reference`, which does not exist.

---

### **Solution**

#### **1. Remove Backticks Around `subject.reference`**

To correctly reference the nested field, you should remove the backticks around `subject.reference` in your SELECT clause.

**Corrected Query:**

```sql
SELECT mr.id AS medication_request_id, mr.subject.reference AS patient_reference, med_coding.code AS medication_code
FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
UNNEST(mr.medication.codeableConcept.coding) AS med_coding
LIMIT 100;
```

**Explanation:**

- **Accessing Nested Fields:** Use dot notation to access nested fields within a STRUCT without enclosing the entire path in backticks.
- **Removing Backticks:** By removing the backticks, BigQuery correctly interprets `mr.subject.reference` as accessing the `reference` field within the `subject` STRUCT of the `medication_request` table.

---

#### **2. Verify that `subject.reference` Exists in `medication_request`**

Let's ensure that the field `subject.reference` actually exists in the `medication_request` table.

**Schema of `medication_request` Table (Excerpt):**

From the DDL provided:

```plaintext
subject STRUCT<
  display STRING,
  groupId STRING,
  identifier STRUCT<...>,
  reference STRING,
  patientId STRING
>
```

As we can see, `subject` is a STRUCT that contains the field `reference`.

---

### **Testing the Corrected Query**

Please try running the corrected query:

```sql
SELECT mr.id AS medication_request_id, mr.subject.reference AS patient_reference, med_coding.code AS medication_code
FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
UNNEST(mr.medication.codeableConcept.coding) AS med_coding
LIMIT 100;
```

**Expected Outcome:**

- The query should execute without errors.
- It will return the `medication_request_id`, the `patient_reference`, and the `medication_code` for each medication request.

---

### **Additional Explanation**

#### **Backticks Usage in BigQuery**

- **Purpose of Backticks:** Backticks are used to enclose identifiers (like table names or column names) that might be reserved words or contain special characters (e.g., spaces, hyphens).
- **Nested Fields and Dot Notation:** When accessing nested fields using dot notation, do not enclose the entire path in backticks.
  
  **Incorrect:**

  ```sql
  mr.`subject.reference`
  ```

  This makes BigQuery look for a field named `subject.reference`, which doesn't exist.

  **Correct:**

  ```sql
  mr.subject.reference
  ```

- **Enclosing Individual Identifiers:** If an individual field name requires backticks (e.g., because it contains special characters), you can enclose just that identifier.

  **Example:**

  ```sql
  mr.subject.`some-special-field`
  ```

---

#### **Accessing Nested Fields**

- **Dot Notation:** To access a nested field within a STRUCT, use dot notation without backticks.
- **STRUCT Fields:** In the `medication_request` table, `subject` is a STRUCT that contains several fields, including `reference`.

---

### **If You Encounter Further Errors**

#### **1. Verify Field Names and Cases**

- **Case Sensitivity:** BigQuery is case-sensitive regarding field names. Ensure that you are using the correct casing for field names.
- **Field Existence:** Confirm that `mr.subject.reference` exists and is populated in the data.

#### **2. Viewing Available Fields**

If you still experience issues, you can inspect the `subject` field to see available subfields.

**Query to Inspect `subject` Fields:**

```sql
SELECT mr.subject.*, mr.id
FROM `bigquery-public-data.fhir_synthea.medication_request` mr
LIMIT 10;
```

**Explanation:**

- This query will display all the subfields within `mr.subject` for the first 10 records.
- You can verify the exact field names available.

#### **3. Alternative Fields**

If `mr.subject.reference` does not exist, but `mr.subject.patientId` does, you can use `mr.subject.patientId` instead.

**Modified Query Using `patientId`:**

```sql
SELECT mr.id AS medication_request_id, mr.subject.patientId AS patient_id, med_coding.code AS medication_code
FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
UNNEST(mr.medication.codeableConcept.coding) AS med_coding
LIMIT 100;
```

---

### **Summary**

- **Issue:** The error occurred because `mr.`subject.reference` ` was incorrect due to the use of backticks.
- **Solution:** Remove the backticks and reference the nested field using dot notation: `mr.subject.reference`.
- **Action:** Run the corrected query to retrieve the desired data.

---

### **Final Corrected Query**

```sql
SELECT mr.id AS medication_request_id, mr.subject.reference AS patient_reference, med_coding.code AS medication_code
FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
UNNEST(mr.medication.codeableConcept.coding) AS med_coding
LIMIT 100;
```

---

### **Example Result**

After running the corrected query, you should get results similar to:

```plaintext
medication_request_id, patient_reference, medication_code
"12345", "Patient/abcde", "med_code_1"
"67890", "Patient/fghij", "med_code_2"
...
```

---

### **Next Steps**

- **Proceed with your Analysis:** With the corrected query, you can now proceed to analyze the medications prescribed to patients.
- **Apply Additional Conditions:** If needed, you can add `WHERE` clauses or join with other tables to filter or enrich your data.

---

### **Let Me Know if You Need Further Assistance**

If you have any more questions or encounter other issues, please let me know, and I'll be happy to help you further!
2025-01-26 20:21:53 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:21:53 - root - INFO - I see that you're still encountering the same error with your SQL query:

```sql
SELECT mr.id AS medication_request_id, mr.`subject.reference` AS patient_reference, med_coding.code AS medication_code
FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
UNNEST(mr.medication.codeableConcept.coding) AS med_coding
LIMIT 100;
```

**Error Message:**

```
400 Name subject.reference not found inside mr at [1:43]; reason: invalidQuery, location: query, message: Name subject.reference not found inside mr at [1:43]
```

---

### **Understanding the Error**

The error indicates that the field `subject.reference` does not exist within the `mr` (medication_request) table. This suggests that either:

1. The field `reference` does not exist within the `subject` STRUCT in the `medication_request` table.
2. There might be a mismatch in field names or a case sensitivity issue.

---

### **Solution**

#### **Step 1: Verify the Fields within `mr.subject`**

Let's check which fields are available within the `subject` STRUCT in the `medication_request` table. We can do this by running a simple query to inspect the schema.

**Query to Inspect `mr.subject`:**

```sql
SELECT mr.subject.*
FROM `bigquery-public-data.fhir_synthea.medication_request` mr
LIMIT 10;
```

**Explanation:**

- This query will display all the fields within the `subject` STRUCT for the first 10 records.
- It helps us identify the exact field names and their availability.

---

#### **Step 2: Identify the Correct Field**

From the schema or the results of the above query, we can determine which fields are available. Based on the DDL provided earlier, the `subject` STRUCT may contain fields like:

- `patientId`
- `reference`
- `display`

However, if `mr.subject.reference` is not found, it's possible that we should be using `mr.subject.patientId` instead.

---

#### **Step 3: Adjust the Query Using `mr.subject.patientId`**

Let's modify your query to use `mr.subject.patientId` as the patient reference.

**Adjusted Query:**

```sql
SELECT mr.id AS medication_request_id, mr.subject.patientId AS patient_id, med_coding.code AS medication_code
FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
UNNEST(mr.medication.codeableConcept.coding) AS med_coding
LIMIT 100;
```

**Explanation:**

- **Changed Field:** Replaced `mr.subject.reference` with `mr.subject.patientId`.
- **Reason:** If `subject.reference` does not exist but `subject.patientId` does, using `patientId` will allow us to retrieve the patient identifier.

---

#### **Step 4: Run the Adjusted Query**

Please run the adjusted query. It should execute without errors and return the following columns:

- `medication_request_id`: The ID of the medication request.
- `patient_id`: The patient identifier associated with the medication request.
- `medication_code`: The code of the medication prescribed.

---

### **Additional Information**

#### **Field Names in `medication_request` Table**

From the DDL provided, the `medication_request` table's `subject` field is defined as:

```plaintext
subject STRUCT<
  display STRING,
  groupId STRING,
  identifier STRUCT<...>,
  patientId STRING
>
```

**Note:**

- The `reference` field may not exist within `subject`.
- The `patientId` field is likely the correct field to use for patient identification.

#### **Case Sensitivity**

- Field names in BigQuery are case-sensitive.
- Ensure that you use `patientId` exactly as it appears in the schema.

---

### **Verification**

To confirm that `mr.subject.patientId` contains the patient IDs, you can run:

```sql
SELECT DISTINCT mr.subject.patientId
FROM `bigquery-public-data.fhir_synthea.medication_request` mr
WHERE mr.subject.patientId IS NOT NULL
LIMIT 10;
```

If this query returns patient IDs, then `patientId` is the correct field to use.

---

### **Proceeding with Your Analysis**

With the adjusted query, you can continue your analysis. When joining with the `patient` table or other tables, make sure to use `patientId` consistently.

**Example of a Join with the `patient` Table:**

```sql
SELECT mr.id AS medication_request_id, p.id AS patient_id, med_coding.code AS medication_code
FROM `bigquery-public-data.fhir_synthea.medication_request` mr
JOIN `bigquery-public-data.fhir_synthea.patient` p
  ON mr.subject.patientId = p.id
UNNEST(mr.medication.codeableConcept.coding) AS med_coding
LIMIT 100;
```

---

### **Summary**

- **Issue:** The field `mr.subject.reference` does not exist in the `medication_request` table.
- **Solution:** Use `mr.subject.patientId` instead to reference the patient.
- **Action:** Adjust your query to use `mr.subject.patientId` as shown above.
- **Verify Fields:** Always verify the schema or use exploratory queries to check available fields.

---

### **Let Me Know if You Need Further Assistance**

If you have any more questions or encounter other issues, please let me know, and I'll be happy to help you further!
2025-01-26 20:22:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:22:25 - root - INFO - I understand that you're still experiencing the same error when running your SQL query:

```sql
SELECT mr.id AS medication_request_id, mr.`subject.reference` AS patient_reference, med_coding.code AS medication_code
FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
UNNEST(mr.medication.codeableConcept.coding) AS med_coding
LIMIT 100;
```

**Error Message:**

```
400 Name subject.reference not found inside mr at [1:43]; reason: invalidQuery, location: query, message: Name subject.reference not found inside mr at [1:43]
```

---

### **Explanation of the Issue**

The error occurs because the field `subject.reference` does not exist in the `medication_request` table (`mr`). Enclosing `subject.reference` within backticks like ``mr.`subject.reference` `` causes BigQuery to look for a field named exactly `subject.reference`, which doesn't exist.

Even if you remove the backticks, if `subject.reference` is not a valid field in the `medication_request` table, you'll still encounter an error.

---

### **Solution**

#### **1. Verify Available Fields in `mr.subject`**

First, let's confirm which fields are available within the `subject` STRUCT of the `medication_request` table.

**Query to Inspect `mr.subject`:**

```sql
SELECT mr.subject.*
FROM `bigquery-public-data.fhir_synthea.medication_request` mr
LIMIT 10;
```

**Explanation:**

- This query selects all subfields within `mr.subject` for the first 10 records.
- It helps us identify the exact field names present.

---

#### **2. Identify the Correct Field**

Based on the dataset schema or the result of the above query, the `subject` STRUCT may contain fields like:

- `patientId`
- `display`
- `identifier`

**Possible Field to Use:**

- **`mr.subject.patientId`**: This field likely contains the patient ID corresponding to each medication request.

---

#### **3. Adjust Your Query**

Since `mr.subject.reference` does not exist, you can use `mr.subject.patientId` instead.

**Updated Query:**

```sql
SELECT mr.id AS medication_request_id, mr.subject.patientId AS patient_id, med_coding.code AS medication_code
FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
UNNEST(mr.medication.codeableConcept.coding) AS med_coding
LIMIT 100;
```

**Explanation:**

- **Replaced Field:** Changed `mr.subject.reference` to `mr.subject.patientId`.
- **No Backticks Needed:** Accessing nested fields using dot notation doesn't require backticks unless the field names contain special characters or are reserved words.

---

#### **4. Verify the Adjusted Query**

Please run the updated query above. It should execute without errors and return the following columns:

- **`medication_request_id`**: The ID of the medication request.
- **`patient_id`**: The patient ID associated with the medication request.
- **`medication_code`**: The code of the medication prescribed.

---

### **Additional Steps**

#### **A. Confirm Field Availability**

If you want to further confirm that `patientId` is the correct field, you can run:

```sql
SELECT DISTINCT mr.subject.patientId
FROM `bigquery-public-data.fhir_synthea.medication_request` mr
WHERE mr.subject.patientId IS NOT NULL
LIMIT 10;
```

This will display distinct patient IDs, verifying that `patientId` contains relevant data.

#### **B. Ensure Consistency in Joins**

When joining with the `patient` table or other tables, use `patientId` for consistency.

**Example Join with Patient Table:**

```sql
SELECT mr.id AS medication_request_id, p.id AS patient_id, med_coding.code AS medication_code
FROM `bigquery-public-data.fhir_synthea.medication_request` mr
JOIN `bigquery-public-data.fhir_synthea.patient` p
  ON mr.subject.patientId = p.id
UNNEST(mr.medication.codeableConcept.coding) AS med_coding
LIMIT 100;
```

---

### **Understanding Backticks and Field Access in BigQuery**

- **Backticks (`) Usage:**

  - Enclose identifiers that contain special characters or are reserved keywords.
  - Do **not** enclose dot notation paths in a single pair of backticks.
  - **Example of Correct Usage:**
    - If a field is named `reference.number`, and you need to use it as is, you can enclose it in backticks: `` `reference.number` ``.
  - **Example of Accessing Nested Fields:**
    - To access the `number` field within the `reference` STRUCT: `reference.number`

- **Dot Notation:**

  - Use dot notation to access nested fields within STRUCTs.
  - Do not enclose the entire path in backticks.

---

### **Recap and Final Recommendations**

- **Issue:** The field `subject.reference` does not exist in the `medication_request` table, leading to an error.
- **Solution:** Use `mr.subject.patientId` to reference the patient ID associated with each medication request.
- **Action:** Update your queries to use `mr.subject.patientId` instead of `mr.subject.reference`.

---

### **Extended Example for Your Analysis**

Given your goal, here's how you might adjust the larger query to find out which health conditions have the most types of medications per case, using `patientId`:

```sql
-- Step 1: Get patients who are alive, have last names starting with 'A', and have only one unique condition
WITH eligible_patients AS (
  SELECT p.id AS patient_id
  FROM `bigquery-public-data.fhir_synthea.patient` p,
  UNNEST(p.name) AS n
  WHERE p.deceased.boolean IS NOT TRUE
    AND LOWER(n.family) LIKE 'a%'
    AND (
      SELECT COUNT(DISTINCT c.id)
      FROM `bigquery-public-data.fhir_synthea.condition` c
      WHERE c.subject.patientId = p.id
    ) = 1
), 

-- Step 2: Count the number of different medications prescribed to each patient
patient_med_counts AS (
  SELECT mr.subject.patientId AS patient_id, COUNT(DISTINCT med_coding.code) AS medication_count
  FROM `bigquery-public-data.fhir_synthea.medication_request` mr
  JOIN eligible_patients ep ON mr.subject.patientId = ep.patient_id
  JOIN UNNEST(mr.medication.codeableConcept.coding) AS med_coding
  GROUP BY mr.subject.patientId
),

-- Step 3: Get the conditions for each patient
patient_conditions AS (
  SELECT c.subject.patientId AS patient_id, coding.code AS condition_code, coding.display AS condition_name
  FROM `bigquery-public-data.fhir_synthea.condition` c
  JOIN eligible_patients ep ON c.subject.patientId = ep.patient_id
  JOIN UNNEST(c.code.coding) AS coding
)

-- Final Step: Get the top eight conditions
SELECT pc.condition_name, pc.condition_code, MAX(pmc.medication_count) AS max_medications_prescribed
FROM patient_conditions pc
JOIN patient_med_counts pmc ON pc.patient_id = pmc.patient_id
GROUP BY pc.condition_name, pc.condition_code
ORDER BY max_medications_prescribed DESC
LIMIT 8;
```

---

### **Final Thoughts**

Please try running the adjusted queries. If you encounter any further issues or have additional questions, feel free to ask. I'm here to help you achieve your task successfully.
2025-01-26 20:22:26 - root - INFO - SQL:
SELECT mr.id AS medication_request_id, mr.`subject.reference` AS patient_reference, med_coding.code AS medication_code
FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
UNNEST(mr.medication.codeableConcept.coding) AS med_coding
LIMIT 100;
Results:
400 Name subject.reference not found inside mr at [1:43]; reason: invalidQuery, location: query, message: Name subject.reference not found inside mr at [1:43]

Location: US
Job ID: df9c375d-6a8c-495f-ad64-742c94bd4323

2025-01-26 20:23:06 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:23:06 - root - INFO - I see that you're still encountering the same error when trying to run your SQL query:

```sql
SELECT mr.`subject.reference` AS patient_reference, COUNT(DISTINCT med_coding.code) AS medication_count
FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
UNNEST(mr.medication.codeableConcept.coding) AS med_coding
GROUP BY mr.`subject.reference`
LIMIT 100;
```

**Error Message:**

```
400 Name subject.reference not found inside mr at [1:11]; reason: invalidQuery, location: query, message: Name subject.reference not found inside mr at [1:11]
```

---

### **Understanding the Error**

The error indicates that BigQuery cannot find the field `subject.reference` within the `medication_request` table (`mr`). The field `subject.reference` does not exist in the table schema, which is why you're receiving this error.

---

### **Solution**

#### **1. Verify the Available Fields in `mr.subject`**

Let's first check which fields are available within the `subject` STRUCT in the `medication_request` table. Based on the DDL provided and common FHIR structures, the `subject` field likely contains the following subfields:

- `patientId`
- `display`
- `identifier`
- (It seems that `reference` may not be present in this dataset.)

#### **2. Adjust the Query to Use `mr.subject.patientId`**

Since `mr.subject.reference` does not exist, you should use `mr.subject.patientId` instead. This field contains the patient ID associated with each medication request.

**Updated Query:**

```sql
SELECT mr.subject.patientId AS patient_reference, COUNT(DISTINCT med_coding.code) AS medication_count
FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
UNNEST(mr.medication.codeableConcept.coding) AS med_coding
GROUP BY mr.subject.patientId
LIMIT 100;
```

**Explanation:**

- **Changed Field:** Replaced `mr.subject.reference` with `mr.subject.patientId`.
- **Removed Backticks:** When accessing nested fields, use dot notation without enclosing the entire path in backticks.
- **Grouping:** Grouped by `mr.subject.patientId` to count medications per patient.

---

### **Testing the Adjusted Query**

Please run the updated query above. It should execute without errors and return the number of distinct medications prescribed to each patient.

---

### **Verifying the `subject` Fields**

To confirm the fields available within `mr.subject`, you can run the following query:

```sql
SELECT mr.subject.*, mr.id
FROM `bigquery-public-data.fhir_synthea.medication_request` mr
LIMIT 10;
```

**This will display the subfields within `subject`, allowing you to see if `patientId` is present.**

---

### **Additional Explanation**

#### **Why `subject.reference` Doesn't Work**

- The field `subject.reference` is not part of the `medication_request` table in this dataset.
- Misreferencing a field that doesn't exist leads to the `Name not found` error.

#### **Backticks Usage in BigQuery**

- **Purpose of Backticks:** Used to enclose identifiers (like table or column names) that contain special characters or are reserved words.
- **Nested Fields and Dot Notation:** Do not enclose the entire path in backticks when accessing nested fields.
  - **Incorrect:** ``mr.`subject.reference` ``
  - **Correct:** `mr.subject.patientId`

---

### **Proceeding with Your Analysis**

**If your goal is to count the number of different medications prescribed to each patient, you can proceed with the adjusted query.**

Example:

```sql
SELECT mr.subject.patientId AS patient_id, COUNT(DISTINCT med_coding.code) AS medication_count
FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
UNNEST(mr.medication.codeableConcept.coding) AS med_coding
GROUP BY mr.subject.patientId
LIMIT 100;
```

---

### **Applying Further Filters**

If you need to join this data with other tables or apply additional conditions (e.g., patients whose last names start with 'A'), ensure you use `patientId` for consistency.

**Example with Additional Conditions:**

```sql
-- Get patients whose last names start with 'A' and are alive
WITH patients_a AS (
  SELECT p.id AS patient_id
  FROM `bigquery-public-data.fhir_synthea.patient` p,
  UNNEST(p.name) AS n
  WHERE p.deceased.boolean IS NOT TRUE
    AND LOWER(n.family) LIKE 'a%'
),

-- Count medications for these patients
patient_med_counts AS (
  SELECT mr.subject.patientId AS patient_id, COUNT(DISTINCT med_coding.code) AS medication_count
  FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
  UNNEST(mr.medication.codeableConcept.coding) AS med_coding
  WHERE mr.subject.patientId IN (SELECT patient_id FROM patients_a)
  GROUP BY mr.subject.patientId
)

SELECT *
FROM patient_med_counts
LIMIT 100;
```

---

### **Final Steps to Complete Your Task**

1. **Identify Patients:**
   - Patients who are alive (`p.deceased.boolean IS NOT TRUE`).
   - Last names start with 'A' (`LOWER(n.family) LIKE 'a%'`).
   - Have only one unique condition (need to join with the `condition` table and filter accordingly).

2. **Count Medications:**
   - Use `mr.subject.patientId` to join medication requests to patients.
   - Count distinct medications prescribed to each patient.

3. **Identify Conditions:**
   - Retrieve condition codes and names from the `condition` table.
   - Use `c.subject.patientId` to join conditions to patients.

4. **Aggregate Data:**
   - For each condition, find the maximum number of different medications prescribed to any single patient with that condition.

5. **Select Top Eight Conditions:**
   - Order the results by the maximum number of medications.
   - Limit the results to the top eight conditions.

**Putting It All Together:**

```sql
-- Step 1: Identify Eligible Patients
WITH eligible_patients AS (
  SELECT p.id AS patient_id
  FROM `bigquery-public-data.fhir_synthea.patient` p,
  UNNEST(p.name) AS n
  WHERE p.deceased.boolean IS NOT TRUE
    AND LOWER(n.family) LIKE 'a%'
    AND (
      SELECT COUNT(DISTINCT c.id)
      FROM `bigquery-public-data.fhir_synthea.condition` c
      WHERE c.subject.patientId = p.id
    ) = 1
),

-- Step 2: Count Medications Per Patient
patient_med_counts AS (
  SELECT mr.subject.patientId AS patient_id, COUNT(DISTINCT med_coding.code) AS medication_count
  FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
  UNNEST(mr.medication.codeableConcept.coding) AS med_coding
  WHERE mr.subject.patientId IN (SELECT patient_id FROM eligible_patients)
  GROUP BY mr.subject.patientId
),

-- Step 3: Get Patient Conditions
patient_conditions AS (
  SELECT c.subject.patientId AS patient_id, coding.code AS condition_code, coding.display AS condition_name
  FROM `bigquery-public-data.fhir_synthea.condition` c,
  UNNEST(c.code.coding) AS coding
  WHERE c.subject.patientId IN (SELECT patient_id FROM eligible_patients)
)

-- Final Result: Top Eight Conditions
SELECT pc.condition_name, pc.condition_code, MAX(pmc.medication_count) AS Max_Number_of_Different_Meds_Prescribed
FROM patient_conditions pc
JOIN patient_med_counts pmc ON pc.patient_id = pmc.patient_id
GROUP BY pc.condition_name, pc.condition_code
ORDER BY Max_Number_of_Different_Meds_Prescribed DESC
LIMIT 8;
```

---

### **Conclusion**

- The field `mr.subject.reference` does not exist in the `medication_request` table.
- Use `mr.subject.patientId` instead to reference the patient ID.
- Adjust your queries accordingly, and ensure you're using the correct field names.
- Always verify the table schemas if you encounter errors.

---

### **Let Me Know if You Need Further Assistance**

If you have any more questions or need additional help, please feel free to ask!
2025-01-26 20:24:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:24:17 - root - INFO - I see that you're still encountering the same error when trying to run your SQL query:

```sql
SELECT mr.`subject.reference` AS patient_reference, COUNT(DISTINCT med_coding.code) AS medication_count
FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
UNNEST(mr.medication.codeableConcept.coding) AS med_coding
GROUP BY mr.`subject.reference`
LIMIT 100;
```

**Error Message:**

```
400 Name subject.reference not found inside mr at [1:11]; reason: invalidQuery, location: query, message: Name subject.reference not found inside mr at [1:11]
```

---

### **Understanding the Error**

The error indicates that BigQuery cannot find the field `subject.reference` within the `medication_request` table (`mr`). This suggests that either:

- The field `reference` does not exist within the `subject` STRUCT in the `medication_request` table.
- There might be a mismatch in field names or a case sensitivity issue.

---

### **Solution**

Let's address the problem step by step.

#### **Step 1: Verify the Fields within `mr.subject`**

Based on the table schema provided, the `medication_request` table's `subject` field is a STRUCT with the following subfields:

```plaintext
subject STRUCT<
  display STRING,
  groupId STRING,
  identifier STRUCT<...>,
  patientId STRING
>
```

**Note:** The field `subject.reference` does not exist in the schema. Instead, we have `subject.patientId`, which contains the patient ID associated with the medication request.

#### **Step 2: Adjust Your Query to Use `mr.subject.patientId`**

Since `subject.reference` does not exist, you should use `mr.subject.patientId` in your query.

**Corrected Query:**

```sql
SELECT mr.subject.patientId AS patient_reference, COUNT(DISTINCT med_coding.code) AS medication_count
FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
UNNEST(mr.medication.codeableConcept.coding) AS med_coding
GROUP BY mr.subject.patientId
LIMIT 100;
```

**Explanation:**

- **Changed Field:** Replaced `mr.`subject.reference` ` with `mr.subject.patientId`.
- **Removed Backticks:** When accessing nested fields, use dot notation without enclosing the entire path in backticks unless necessary.
- **Consistency:** This ensures you're using a valid field that exists in the table.

---

### **Testing the Corrected Query**

Please run the updated query above. It should execute without errors and return:

- **`patient_reference`**: The patient ID associated with each medication request.
- **`medication_count`**: The number of distinct medications prescribed to that patient.

---

### **Applying This to Your Original Task**

Given your goal to find out which health conditions have the most types of medications per case, for living patients whose last names start with 'A' and have only one unique condition, here's how you can proceed.

#### **Step 1: Identify Eligible Patients**

```sql
WITH eligible_patients AS (
  SELECT p.id AS patient_id
  FROM `bigquery-public-data.fhir_synthea.patient` p,
  UNNEST(p.name) AS n
  WHERE p.deceased.boolean IS NOT TRUE
    AND LOWER(n.family) LIKE 'a%'
)
```

- **Filters:**
  - Patients who are alive.
  - Patients whose last names start with 'A'.

#### **Step 2: Find Patients with Only One Unique Condition**

```sql
, patients_one_condition AS (
  SELECT c.subject.patientId AS patient_id
  FROM `bigquery-public-data.fhir_synthea.condition` c
  GROUP BY c.subject.patientId
  HAVING COUNT(DISTINCT c.id) = 1
)
```

- Groups conditions by patient and keeps only those with one unique condition.

#### **Step 3: Get Eligible Patients with One Condition**

```sql
, eligible_one_condition_patients AS (
  SELECT patient_id
  FROM eligible_patients
  INNER JOIN patients_one_condition USING (patient_id)
)
```

- Combines the two filters to get patients who meet both criteria.

#### **Step 4: Count Medications per Patient**

```sql
, patient_med_counts AS (
  SELECT mr.subject.patientId AS patient_id, COUNT(DISTINCT med_coding.code) AS medication_count
  FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
  UNNEST(mr.medication.codeableConcept.coding) AS med_coding
  WHERE mr.subject.patientId IN (SELECT patient_id FROM eligible_one_condition_patients)
  GROUP BY mr.subject.patientId
)
```

- Counts the number of distinct medications prescribed to each patient.

#### **Step 5: Get Conditions for Each Patient**

```sql
, patient_conditions AS (
  SELECT c.subject.patientId AS patient_id, coding.code AS condition_code, coding.display AS condition_name
  FROM `bigquery-public-data.fhir_synthea.condition` c,
  UNNEST(c.code.coding) AS coding
  WHERE c.subject.patientId IN (SELECT patient_id FROM eligible_one_condition_patients)
)
```

- Retrieves the condition code and name for each patient.

#### **Final Step: Aggregate and Get Top Eight Conditions**

```sql
SELECT
  pc.condition_name AS Condition_Name,
  pc.condition_code AS Condition_Code,
  MAX(pmc.medication_count) AS Max_Number_of_Different_Meds_Prescribed
FROM patient_conditions pc
JOIN patient_med_counts pmc ON pc.patient_id = pmc.patient_id
GROUP BY pc.condition_name, pc.condition_code
ORDER BY Max_Number_of_Different_Meds_Prescribed DESC
LIMIT 8;
```

- **Result:** The top eight conditions and their codes, ranked by the highest number of different medications prescribed to any single patient.

---

### **Full Query**

Putting it all together:

```sql
WITH eligible_patients AS (
  SELECT p.id AS patient_id
  FROM `bigquery-public-data.fhir_synthea.patient` p,
  UNNEST(p.name) AS n
  WHERE p.deceased.boolean IS NOT TRUE
    AND LOWER(n.family) LIKE 'a%'
), patients_one_condition AS (
  SELECT c.subject.patientId AS patient_id
  FROM `bigquery-public-data.fhir_synthea.condition` c
  GROUP BY c.subject.patientId
  HAVING COUNT(DISTINCT c.id) = 1
), eligible_one_condition_patients AS (
  SELECT patient_id
  FROM eligible_patients
  INNER JOIN patients_one_condition USING (patient_id)
), patient_med_counts AS (
  SELECT mr.subject.patientId AS patient_id, COUNT(DISTINCT med_coding.code) AS medication_count
  FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
  UNNEST(mr.medication.codeableConcept.coding) AS med_coding
  WHERE mr.subject.patientId IN (SELECT patient_id FROM eligible_one_condition_patients)
  GROUP BY mr.subject.patientId
), patient_conditions AS (
  SELECT c.subject.patientId AS patient_id, coding.code AS condition_code, coding.display AS condition_name
  FROM `bigquery-public-data.fhir_synthea.condition` c,
  UNNEST(c.code.coding) AS coding
  WHERE c.subject.patientId IN (SELECT patient_id FROM eligible_one_condition_patients)
)
SELECT
  pc.condition_name AS Condition_Name,
  pc.condition_code AS Condition_Code,
  MAX(pmc.medication_count) AS Max_Number_of_Different_Meds_Prescribed
FROM patient_conditions pc
JOIN patient_med_counts pmc ON pc.patient_id = pmc.patient_id
GROUP BY pc.condition_name, pc.condition_code
ORDER BY Max_Number_of_Different_Meds_Prescribed DESC
LIMIT 8;
```

---

### **Final Output**

Following the desired format, the result should be:

```csv
Condition_Name,Condition_Code,Max_Number_of_Different_Meds_Prescribed
Condition A,Code A,num_a
Condition B,Code B,num_b
Condition C,Code C,num_c
Condition D,Code D,num_d
Condition E,Code E,num_e
Condition F,Code F,num_f
Condition G,Code G,num_g
Condition H,Code H,num_h
(Attention: answer in eight rows)
```

---

### **Conclusion**

- **Issue:** The field `mr.`subject.reference` ` does not exist in the `medication_request` table.
- **Solution:** Use `mr.subject.patientId` instead to reference the patient ID.
- **Action:** Update your queries to use `mr.subject.patientId`.

---

Please try running the updated query, and let me know if you have any questions or need further assistance!
2025-01-26 20:25:16 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:25:16 - root - INFO - I see that you're still encountering the same error when trying to run your SQL query:

```sql
SELECT mr.`subject.reference` AS patient_reference, COUNT(DISTINCT med_coding.code) AS medication_count
FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
UNNEST(mr.medication.codeableConcept.coding) AS med_coding
GROUP BY mr.`subject.reference`
LIMIT 100;
```

**Error Message:**

```
400 Name subject.reference not found inside mr at [1:11]; reason: invalidQuery, location: query, message: Name subject.reference not found inside mr at [1:11]
```

---

### **Understanding the Error**

The error occurs because **the field `subject.reference` does not exist** within the `medication_request` table (`mr`). Enclosing `subject.reference` in backticks makes BigQuery look for a field named literally `subject.reference`, which isn't present in the table schema.

---

### **Solution**

#### **1. Identify the Correct Field**

In the `medication_request` table, the `subject` field is a STRUCT that contains patient information. The available fields within `subject` are likely:

- `patientId`
- `display`
- `identifier`

Since `subject.reference` doesn't exist, we should use `subject.patientId`, which contains the patient ID.

#### **2. Remove Backticks Around Field Names in Dot Notation**

When accessing nested fields using dot notation in BigQuery, do not enclose the entire path in backticks. Only use backticks for individual field names when necessary (e.g., if the field name contains special characters).

---

### **Corrected Query**

Here's your SQL query corrected:

```sql
SELECT mr.subject.patientId AS patient_reference, COUNT(DISTINCT med_coding.code) AS medication_count
FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
UNNEST(mr.medication.codeableConcept.coding) AS med_coding
GROUP BY mr.subject.patientId
LIMIT 100;
```

**Explanation:**

- **Replaced `mr.\`subject.reference\`` with `mr.subject.patientId`**: The `patientId` field correctly references the patient in the `subject` STRUCT.
- **Removed Backticks**: Backticks are not needed when using dot notation unless field names contain special characters.

---

### **Verifying the Fields in `mr.subject`**

To confirm that `subject.patientId` exists, you can run:

```sql
SELECT mr.subject.*
FROM `bigquery-public-data.fhir_synthea.medication_request` mr
LIMIT 10;
```

This will show all the fields available within `mr.subject`.

---

### **Applying This to Your Main Task**

Since you're aiming to find out which health conditions have the most types of medications per case, here's how you can adjust your queries:

#### **1. Identify Living Patients with Last Names Starting with 'A'**

```sql
WITH eligible_patients AS (
  SELECT p.id AS patient_id
  FROM `bigquery-public-data.fhir_synthea.patient` p,
  UNNEST(p.name) AS n
  WHERE p.deceased.boolean IS NOT TRUE
    AND LOWER(n.family) LIKE 'a%'
)
```

#### **2. Find Patients with Only One Unique Condition**

```sql
, patients_one_condition AS (
  SELECT c.subject.patientId AS patient_id
  FROM `bigquery-public-data.fhir_synthea.condition` c
  GROUP BY c.subject.patientId
  HAVING COUNT(DISTINCT c.id) = 1
)
```

#### **3. Combine Criteria to Get Eligible Patients**

```sql
, eligible_one_condition_patients AS (
  SELECT patient_id
  FROM eligible_patients
  INNER JOIN patients_one_condition USING (patient_id)
)
```

#### **4. Count Medications per Patient**

```sql
, patient_med_counts AS (
  SELECT mr.subject.patientId AS patient_id, COUNT(DISTINCT med_coding.code) AS medication_count
  FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
  UNNEST(mr.medication.codeableConcept.coding) AS med_coding
  WHERE mr.subject.patientId IN (SELECT patient_id FROM eligible_one_condition_patients)
  GROUP BY mr.subject.patientId
)
```

#### **5. Retrieve Conditions for Each Patient**

```sql
, patient_conditions AS (
  SELECT c.subject.patientId AS patient_id, coding.code AS condition_code, coding.display AS condition_name
  FROM `bigquery-public-data.fhir_synthea.condition` c,
  UNNEST(c.code.coding) AS coding
  WHERE c.subject.patientId IN (SELECT patient_id FROM eligible_one_condition_patients)
)
```

#### **6. Get the Top Eight Conditions**

```sql
SELECT
  pc.condition_name AS Condition_Name,
  pc.condition_code AS Condition_Code,
  MAX(pmc.medication_count) AS Max_Number_of_Different_Meds_Prescribed
FROM patient_conditions pc
JOIN patient_med_counts pmc ON pc.patient_id = pmc.patient_id
GROUP BY pc.condition_name, pc.condition_code
ORDER BY Max_Number_of_Different_Meds_Prescribed DESC
LIMIT 8;
```

---

### **Final Query**

Putting it all together:

```sql
WITH eligible_patients AS (
  SELECT p.id AS patient_id
  FROM `bigquery-public-data.fhir_synthea.patient` p,
  UNNEST(p.name) AS n
  WHERE p.deceased.boolean IS NOT TRUE
    AND LOWER(n.family) LIKE 'a%'
), patients_one_condition AS (
  SELECT c.subject.patientId AS patient_id
  FROM `bigquery-public-data.fhir_synthea.condition` c
  GROUP BY c.subject.patientId
  HAVING COUNT(DISTINCT c.id) = 1
), eligible_one_condition_patients AS (
  SELECT patient_id
  FROM eligible_patients
  INNER JOIN patients_one_condition USING (patient_id)
), patient_med_counts AS (
  SELECT mr.subject.patientId AS patient_id, COUNT(DISTINCT med_coding.code) AS medication_count
  FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
  UNNEST(mr.medication.codeableConcept.coding) AS med_coding
  WHERE mr.subject.patientId IN (SELECT patient_id FROM eligible_one_condition_patients)
  GROUP BY mr.subject.patientId
), patient_conditions AS (
  SELECT c.subject.patientId AS patient_id, coding.code AS condition_code, coding.display AS condition_name
  FROM `bigquery-public-data.fhir_synthea.condition` c,
  UNNEST(c.code.coding) AS coding
  WHERE c.subject.patientId IN (SELECT patient_id FROM eligible_one_condition_patients)
)
SELECT
  pc.condition_name AS Condition_Name,
  pc.condition_code AS Condition_Code,
  MAX(pmc.medication_count) AS Max_Number_of_Different_Meds_Prescribed
FROM patient_conditions pc
JOIN patient_med_counts pmc ON pc.patient_id = pmc.patient_id
GROUP BY pc.condition_name, pc.condition_code
ORDER BY Max_Number_of_Different_Meds_Prescribed DESC
LIMIT 8;
```

---

### **Expected Output Format**

The final result will be the top eight conditions ranked by the highest number of different medications prescribed to any single patient:

```csv
Condition_Name,Condition_Code,Max_Number_of_Different_Meds_Prescribed
condition_name1,str,code1,str,num1,int
condition_name2,str,code2,str,num2,int
condition_name3,str,code3,str,num3,int
condition_name4,str,code4,str,num4,int
condition_name5,str,code5,str,num5,int
condition_name6,str,code6,str,num6,int
condition_name7,str,code7,str,num7,int
condition_name8,str,code8,str,num8,int
(Attention: answer in eight rows)
```

---

### **Conclusion**

The error occurs because `subject.reference` is not a valid field in the `medication_request` table. By using `subject.patientId`, which correctly references the patient, you can resolve the error and proceed with your analysis.

If you have any further questions or need additional assistance, please let me know!
2025-01-26 20:25:17 - root - INFO - SQL:
SELECT mr.`subject.reference` AS patient_reference, COUNT(DISTINCT med_coding.code) AS medication_count
FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
UNNEST(mr.medication.codeableConcept.coding) AS med_coding
GROUP BY mr.`subject.reference`
LIMIT 100;
Results:
400 Name subject.reference not found inside mr at [1:11]; reason: invalidQuery, location: query, message: Name subject.reference not found inside mr at [1:11]

Location: US
Job ID: d82643b5-7ef9-4016-8c0a-d1e9deaf7071

2025-01-26 20:26:03 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:26:03 - root - INFO - I see that you're encountering an error when running your SQL query:

```sql
SELECT p.id AS patient_id
FROM `bigquery-public-data.fhir_synthea.patient` p,
UNNEST(p.name) AS n
WHERE p.deceased.boolean IS NOT TRUE
  AND LOWER(n.family) LIKE 'a%'
  AND (
        SELECT COUNT(*)
        FROM `bigquery-public-data.fhir_synthea.condition` c
        WHERE c.`subject.reference` = CONCAT('Patient/', p.id)
      ) = 1
LIMIT 100;
```

**Error Message:**

```
400 Name subject.reference not found inside c at [9:13]; reason: invalidQuery, location: query, message: Name subject.reference not found inside c at [9:13]
```

---

### **Explanation of the Error**

The error occurs because BigQuery cannot find the field `subject.reference` in the `condition` table alias `c`. This can be due to:

1. **Incorrect Field Name:** The field `subject.reference` does not exist in the `condition` table.
2. **Incorrect Use of Backticks:** Enclosing `subject.reference` in backticks as `c.\`subject.reference\`` makes BigQuery look for a field named exactly `subject.reference`, which doesn't exist.

---

### **Solution**

#### **1. Verify the Fields in the `condition` Table**

Let's check the structure of the `condition` table's `subject` field. From the DDL provided, `subject` has the following fields:

```plaintext
subject STRUCT<
  display STRING,
  groupId STRING,
  identifier STRUCT<...>,
  reference STRING,
  patientId STRING
>
```

So, the `subject` field contains:

- `subject.display`
- `subject.groupId`
- `subject.identifier`
- **`subject.patientId`**
- (Possibly) `subject.reference`

However, if `subject.reference` doesn't exist or is causing errors, we should use `subject.patientId`, which contains the patient ID.

#### **2. Remove Backticks and Access Fields Correctly**

When accessing nested fields, use dot notation without enclosing the entire path in backticks.

Replace:

```sql
WHERE c.`subject.reference` = CONCAT('Patient/', p.id)
```

With:

```sql
WHERE c.subject.patientId = p.id
```

**Explanation:**

- **Removed Backticks:** Do not enclose the entire field path in backticks. If necessary, enclose individual identifiers.
- **Changed Field:** Used `subject.patientId` instead of `subject.reference` for accurate patient reference.

---

### **Adjusted Query**

Here is the corrected SQL query:

```sql
SELECT p.id AS patient_id
FROM `bigquery-public-data.fhir_synthea.patient` p,
UNNEST(p.name) AS n
WHERE p.deceased.boolean IS NOT TRUE
  AND LOWER(n.family) LIKE 'a%'
  AND (
        SELECT COUNT(*)
        FROM `bigquery-public-data.fhir_synthea.condition` c
        WHERE c.subject.patientId = p.id
      ) = 1
LIMIT 100;
```

**Explanation:**

- **Filters:**
  - Patients who are alive.
  - Patients whose last names start with 'A'.
  - Patients who have only one unique condition.
- **Field Correction:** Using `c.subject.patientId` matches the patient ID directly, avoiding issues with non-existent fields.

---

### **Testing the Adjusted Query**

Please run the adjusted query. It should execute without errors and return a list of patient IDs satisfying the conditions.

---

### **Additional Notes**

- **Backticks Usage in BigQuery:**
  - Use backticks to enclose identifiers that contain special characters or are reserved keywords.
  - Do **not** enclose dot notation paths in backticks.
  - **Correct Usage:** `c.subject.patientId`
  - **Incorrect Usage:** `c.\`subject.patientId\`` or `c.\`subject.reference\``

- **Verifying Field Existence:**
  - To confirm available fields, you can run:
    ```sql
    SELECT c.subject.*
    FROM `bigquery-public-data.fhir_synthea.condition` c
    LIMIT 10;
    ```
    This will display all fields within `subject`.

---

### **Further Steps for Your Analysis**

**Adjust Other Queries Accordingly:**

Since `subject.reference` is not present, use `subject.patientId` in all related queries. For example, when joining tables or filtering data.

**Example Adjustment:**

- Original:
  ```sql
  WHERE mr.`subject.reference` = CONCAT('Patient/', p.id)
  ```
- Adjusted:
  ```sql
  WHERE mr.subject.patientId = p.id
  ```

---

### **Conclusion**

The error occurred because `subject.reference` does not exist in the `condition` table. By using `subject.patientId`, which correctly references the patient ID, you can resolve the error.

---

### **Need Further Assistance?**

If you have any questions or need additional help with your queries, please let me know, and I'll be happy to assist further!
2025-01-26 20:26:47 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:26:47 - root - INFO - I see that you're encountering an error with your SQL query:

```sql
SELECT p.id AS patient_id
FROM `bigquery-public-data.fhir_synthea.patient` p,
UNNEST(p.name) AS n
WHERE p.deceased.boolean IS NOT TRUE
  AND LOWER(n.family) LIKE 'a%'
  AND (
        SELECT COUNT(*)
        FROM `bigquery-public-data.fhir_synthea.condition` c
        WHERE c.`subject.reference` = CONCAT('Patient/', p.id)
      ) = 1
LIMIT 100;
```

**Error Message:**

```
400 Name subject.reference not found inside c at [9:17]; reason: invalidQuery, location: query, message: Name subject.reference not found inside c at [9:17]
```

---

### Explanation:

The error occurs because the field `subject.reference` does not exist in the `condition` table (`c`). When you enclose `subject.reference` in backticks as `c.\`subject.reference\``, BigQuery treats it as a single field name called `subject.reference`, which doesn't exist.

Moreover, even if you remove the backticks, the field `subject.reference` may not exist in the `condition` table schema.

---

### Solution:

#### 1. Verify the Fields in the `condition` Table:

Based on the schema of the `condition` table, the `subject` field is a STRUCT that may contain fields such as:

- `subject.patientId`
- `subject.display`
- `subject.groupId`

In this dataset, it's likely that `subject.patientId` is the field that references the patient's ID.

#### 2. Adjust Your Query:

Replace `c.\`subject.reference\`` with `c.subject.patientId` in your subquery. Also, remove the backticks when using dot notation to access nested fields.

---

### Corrected Query:

```sql
SELECT p.id AS patient_id
FROM `bigquery-public-data.fhir_synthea.patient` p,
UNNEST(p.name) AS n
WHERE p.deceased.boolean IS NOT TRUE
  AND LOWER(n.family) LIKE 'a%'
  AND (
        SELECT COUNT(*)
        FROM `bigquery-public-data.fhir_synthea.condition` c
        WHERE c.subject.patientId = p.id
      ) = 1
LIMIT 100;
```

**Explanation of Changes:**

- **Changed Field Name:** Replaced `c.\`subject.reference\`` with `c.subject.patientId`.
- **Removed Backticks:** When accessing nested fields using dot notation, do not enclose the field path in backticks.

---

### Additional Notes:

- **Removal of Backticks:**

  Backticks in BigQuery are used to enclose identifiers (like table or column names) that contain special characters or are reserved words. However, when accessing nested fields using dot notation, do not enclose the entire path in backticks.

  **Incorrect:** `c.\`subject.reference\``

  **Correct:** `c.subject.patientId`

- **Field Existence:**

  By using `c.subject.patientId`, you are referencing the patient ID directly, which should match the `p.id` from the `patient` table.

---

### Testing the Corrected Query:

Please try running the corrected query. It should execute without errors and return the `patient_id`s of patients who:

- Are alive (`p.deceased.boolean IS NOT TRUE`),
- Have a last name starting with 'A' (`LOWER(n.family) LIKE 'a%'`),
- Have exactly one condition associated with them (`SELECT COUNT(*) FROM ... = 1`).

---

### Proceeding with Your Analysis:

If this query runs successfully, you can proceed with the rest of your analysis, ensuring that any other references to `subject.reference` are updated to the correct field (`subject.patientId`).

---

### Example:

If you have other queries that use `subject.reference`, update them similarly.

**Before:**

```sql
WHERE c.`subject.reference` = CONCAT('Patient/', p.id)
```

**After:**

```sql
WHERE c.subject.patientId = p.id
```

---

### Summary:

- **Issue:** The field `subject.reference` does not exist in the `condition` table, leading to the error.
- **Solution:** Use `subject.patientId` instead to reference the patient ID.
- **Action:** Update your query to use `c.subject.patientId` without backticks.

---

If you continue to encounter issues or have further questions, feel free to ask for additional assistance.
2025-01-26 20:27:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:27:29 - root - INFO - I see that you're still encountering an error when running your SQL query:

```sql
SELECT p.id AS patient_id
FROM `bigquery-public-data.fhir_synthea.patient` p,
UNNEST(p.name) AS n
WHERE p.deceased.boolean IS NOT TRUE
  AND LOWER(n.family) LIKE 'a%'
  AND (
        SELECT COUNT(*)
        FROM `bigquery-public-data.fhir_synthea.condition` c
        WHERE c.`subject.reference` = CONCAT('Patient/', p.id)
      ) = 1
LIMIT 100;
```

**Error Message:**

```
400 Name subject.reference not found inside c at [9:17]; reason: invalidQuery, location: query, message: Name subject.reference not found inside c at [9:17]
```

---

### **Understanding the Issue**

The error occurs because the field `subject.reference` does not exist in the `condition` table (`c`). Additionally, enclosing `subject.reference` within backticks makes BigQuery look for a field named exactly `subject.reference`, which doesn't exist.

---

### **Solution**

#### **1. Verify the Fields in the `condition` Table**

Based on the schema of the `condition` table (`bigquery-public-data.fhir_synthea.condition`), the `subject` field is a STRUCT that contains the following fields:

- `subject.display` (STRING)
- `subject.groupId` (STRING)
- `subject.identifier` (STRUCT)
- **`subject.patientId` (STRING)**
- Possibly other fields, but **`subject.reference`** is not among them.

#### **2. Use the Correct Field**

Since `subject.reference` does not exist, you should use `subject.patientId` to reference the patient ID associated with each condition.

#### **3. Remove Backticks When Accessing Nested Fields**

In BigQuery, when accessing nested fields using dot notation, do not enclose the entire path in backticks. If a field name contains special characters or is a reserved word, you can enclose that specific part in backticks.

---

### **Corrected Query**

```sql
SELECT p.id AS patient_id
FROM `bigquery-public-data.fhir_synthea.patient` p,
UNNEST(p.name) AS n
WHERE p.deceased.boolean IS NOT TRUE
  AND LOWER(n.family) LIKE 'a%'
  AND (
        SELECT COUNT(*)
        FROM `bigquery-public-data.fhir_synthea.condition` c
        WHERE c.subject.patientId = p.id
      ) = 1
LIMIT 100;
```

**Explanation:**

- **Replaced Field:**
  - **From:** `c.`subject.reference``
  - **To:** `c.subject.patientId`
- **Removed Backticks:** Backticks are not needed when accessing nested fields unless a field name contains special characters.
- **Field Match:** `c.subject.patientId` matches the `p.id` field from the `patient` table.

---

### **Why Use `subject.patientId`?**

- **`subject.patientId`** contains the patient ID associated with each condition record.
- By comparing `c.subject.patientId = p.id`, you are effectively linking the condition records to the patients.

---

### **Testing the Corrected Query**

Please run the corrected query. It should execute without errors and return the patient IDs for patients who:

- Are **alive** (`p.deceased.boolean IS NOT TRUE`),
- Have a **last name starting with 'A'** (`LOWER(n.family) LIKE 'a%'`),
- Have **only one unique condition** (the subquery counts conditions per patient and filters to those with exactly one).

---

### **Additional Notes**

#### **Understanding Backticks in BigQuery**

- **Backticks (`)** are used to enclose identifiers (like table or column names) that contain special characters or are reserved words.
- **Do not** enclose the entire dot notation path in backticks.
- If you need to use backticks, apply them only to the specific identifier that requires them.

**Example:**

- **Incorrect:** `c.`subject.reference``
- **Correct:** `c.subject.reference` or `c.\`subject\`.\`reference\`` (if `subject` or `reference` needed backticks).

#### **Verifying the Schema**

If you're unsure about the fields available in a table or nested STRUCT, you can explore the schema or use a query to inspect it.

**Query to Inspect Fields:**

```sql
SELECT
  c.subject.*
FROM
  `bigquery-public-data.fhir_synthea.condition` c
LIMIT 10;
```

**This will display all the fields within `subject`, allowing you to confirm the available fields.**

---

### **Applying This Correction to Your Other Queries**

**Any other queries** where you're referencing `subject.reference` in the `condition` or `medication_request` tables should be updated similarly.

**For example, if you have:**

```sql
WHERE mr.`subject.reference` = CONCAT('Patient/', p.id)
```

**You should change it to:**

```sql
WHERE mr.subject.patientId = p.id
```

---

### **Summary**

- **Issue:** The field `subject.reference` does not exist in the `condition` table; thus, BigQuery cannot find it, causing the error.
- **Solution:** Replace `subject.reference` with `subject.patientId`, which correctly references the patient ID.
- **Action:** Modify your query to use `c.subject.patientId` without backticks.

---

### **Next Steps**

1. **Run the Corrected Query:**

   Execute the updated query to ensure it works correctly.

2. **Adjust Other Queries:**

   Review your other queries and replace any instances of `subject.reference` with `subject.patientId` or the appropriate field.

3. **Ensure Consistency:**

   When joining tables or filtering data based on patient IDs, consistently use the correct field (`patientId`).

---

### **Let Me Know If You Need Further Assistance**

If you have any questions or need additional help with your queries, please let me know, and I'll be happy to assist further!
2025-01-26 20:27:30 - root - INFO - SQL:
SELECT p.id AS patient_id
FROM `bigquery-public-data.fhir_synthea.patient` p,
UNNEST(p.name) AS n
WHERE p.deceased.boolean IS NOT TRUE
  AND LOWER(n.family) LIKE 'a%'
  AND (
        SELECT COUNT(*)
        FROM `bigquery-public-data.fhir_synthea.condition` c
        WHERE c.`subject.reference` = CONCAT('Patient/', p.id)
      ) = 1
LIMIT 100;
Results:
400 Name subject.reference not found inside c at [9:17]; reason: invalidQuery, location: query, message: Name subject.reference not found inside c at [9:17]

Location: US
Job ID: 31fe760c-e103-4af0-90b8-4da124776b87

2025-01-26 20:28:26 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:28:26 - root - INFO - I see that you're encountering an error when running your SQL query:

```sql
SELECT p.id AS patient_id, COUNT(DISTINCT med_coding.code) AS medication_count
FROM `bigquery-public-data.fhir_synthea.patient` p,
UNNEST(p.name) AS n
JOIN `bigquery-public-data.fhir_synthea.medication_request` mr
  ON mr.`subject.reference` = CONCAT('Patient/', p.id)
JOIN UNNEST(mr.medication.codeableConcept.coding) AS med_coding
WHERE p.deceased.boolean IS NOT TRUE
  AND LOWER(n.family) LIKE 'a%'
  AND (
    SELECT COUNT(*)
    FROM `bigquery-public-data.fhir_synthea.condition` c
    WHERE c.`subject.reference` = CONCAT('Patient/', p.id)
  ) = 1
GROUP BY p.id
LIMIT 100;
```

**Error Message:**

```
400 Name subject.reference not found inside mr at [5:9]; reason: invalidQuery, location: query, message: Name subject.reference not found inside mr at [5:9]
```

---

### **Explanation of the Error**

The error occurs because the field `subject.reference` does not exist in the `medication_request` table (`mr`). Enclosing `subject.reference` in backticks as `mr.\`subject.reference\`` causes BigQuery to look for a field named exactly `subject.reference`, which doesn't exist.

Similarly, in the subquery, `subject.reference` does not exist in the `condition` table (`c`).

---

### **Solution**

#### **1. Use the Correct Field Name**

In the `medication_request` and `condition` tables, the patient reference is stored in the `subject` STRUCT. Instead of `subject.reference`, you should use `subject.patientId`, which contains the patient ID.

#### **2. Remove Backticks and Access Fields Correctly**

Replace:

- `mr.\`subject.reference\`` with `mr.subject.patientId`
- `c.\`subject.reference\`` with `c.subject.patientId`

---

### **Corrected SQL Query**

Here's the adjusted query:

```sql
SELECT p.id AS patient_id, COUNT(DISTINCT med_coding.code) AS medication_count
FROM `bigquery-public-data.fhir_synthea.patient` p,
UNNEST(p.name) AS n
JOIN `bigquery-public-data.fhir_synthea.medication_request` mr
  ON mr.subject.patientId = p.id
JOIN UNNEST(mr.medication.codeableConcept.coding) AS med_coding
WHERE p.deceased.boolean IS NOT TRUE
  AND LOWER(n.family) LIKE 'a%'
  AND (
    SELECT COUNT(*)
    FROM `bigquery-public-data.fhir_synthea.condition` c
    WHERE c.subject.patientId = p.id
  ) = 1
GROUP BY p.id
LIMIT 100;
```

**Explanation:**

- **Joined `medication_request` (`mr`) to `patient` (`p`) using `mr.subject.patientId = p.id`.**
- **In the subquery, matched conditions to patients using `c.subject.patientId = p.id`.**
- **Removed backticks around field paths.**

---

### **Why This Works**

The `subject.patientId` field contains the patient ID in both the `medication_request` and `condition` tables. By matching `mr.subject.patientId` and `c.subject.patientId` with `p.id`, we correctly join the records.

---

### **Testing the Corrected Query**

Please run the adjusted query. It should execute without errors and provide you with the count of distinct medications prescribed to each patient who:

- Is alive.
- Has a last name starting with 'A'.
- Has only one unique condition.

---

### **Additional Notes**

- **Backticks Usage:** In BigQuery, backticks are used to enclose identifiers (like table or column names) that contain special characters or are reserved words. Do not enclose dot notation paths in backticks.

  - **Incorrect:** `mr.\`subject.reference\``
  - **Correct:** `mr.subject.patientId`

- **Verifying Field Names:** If you encounter a "Name not found" error, it's helpful to verify the available fields in the table schema or by running a query to inspect the fields.

---

### **Proceeding with Your Analysis**

With the corrected query, you can proceed to retrieve the top eight conditions as per your original task.

**Example Query to Get Top Eight Conditions:**

```sql
WITH eligible_patients AS (
  SELECT p.id AS patient_id
  FROM `bigquery-public-data.fhir_synthea.patient` p,
  UNNEST(p.name) AS n
  WHERE p.deceased.boolean IS NOT TRUE
    AND LOWER(n.family) LIKE 'a%'
    AND (
      SELECT COUNT(*)
      FROM `bigquery-public-data.fhir_synthea.condition` c
      WHERE c.subject.patientId = p.id
    ) = 1
),
patient_med_counts AS (
  SELECT mr.subject.patientId AS patient_id, COUNT(DISTINCT med_coding.code) AS medication_count
  FROM `bigquery-public-data.fhir_synthea.medication_request` mr
  JOIN eligible_patients ep ON mr.subject.patientId = ep.patient_id
  JOIN UNNEST(mr.medication.codeableConcept.coding) AS med_coding
  GROUP BY mr.subject.patientId
),
patient_conditions AS (
  SELECT c.subject.patientId AS patient_id, coding.code AS condition_code, coding.display AS condition_name
  FROM `bigquery-public-data.fhir_synthea.condition` c
  JOIN eligible_patients ep ON c.subject.patientId = ep.patient_id
  JOIN UNNEST(c.code.coding) AS coding
)
SELECT pc.condition_name AS Condition_Name,
       pc.condition_code AS Condition_Code,
       MAX(pmc.medication_count) AS Max_Number_of_Different_Meds_Prescribed
FROM patient_conditions pc
JOIN patient_med_counts pmc ON pc.patient_id = pmc.patient_id
GROUP BY pc.condition_name, pc.condition_code
ORDER BY Max_Number_of_Different_Meds_Prescribed DESC
LIMIT 8;
```

**Explanation:**

- **Eligible Patients:** Filters patients who are alive, whose last names start with 'A', and have only one unique condition.
- **Medication Counts:** Counts the number of different medications prescribed to each patient.
- **Patient Conditions:** Retrieves the condition name and code for each patient.
- **Final Selection:** Aggregates the data to find the top eight conditions with the highest number of different medications prescribed to any single patient.

---

### **Expected Output Format**

```csv
Condition_Name,Condition_Code,Max_Number_of_Different_Meds_Prescribed
condition_name1,condition_code1,num1
condition_name2,condition_code2,num2
condition_name3,condition_code3,num3
condition_name4,condition_code4,num4
condition_name5,condition_code5,num5
condition_name6,condition_code6,num6
condition_name7,condition_code7,num7
condition_name8,condition_code8,num8
(Attention: answer in eight rows)
```

---

Let me know if you have any questions or need further assistance!
2025-01-26 20:29:20 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:29:20 - root - INFO - I see that you're encountering an error when running your SQL query:

```sql
SELECT p.id AS patient_id, COUNT(DISTINCT med_coding.code) AS medication_count
FROM `bigquery-public-data.fhir_synthea.patient` p,
UNNEST(p.name) AS n
JOIN `bigquery-public-data.fhir_synthea.medication_request` mr
  ON mr.`subject.reference` = CONCAT('Patient/', p.id)
JOIN UNNEST(mr.medication.codeableConcept.coding) AS med_coding
WHERE p.deceased.boolean IS NOT TRUE
  AND LOWER(n.family) LIKE 'a%'
  AND (
    SELECT COUNT(*)
    FROM `bigquery-public-data.fhir_synthea.condition` c
    WHERE c.`subject.reference` = CONCAT('Patient/', p.id)
  ) = 1
GROUP BY p.id
LIMIT 100;
```

**Error Message:**

```
400 Name subject.reference not found inside mr at [5:9]; reason: invalidQuery, location: query, message: Name subject.reference not found inside mr at [5:9]
```

---

### **Explanation of the Error**

The error occurs because the field `subject.reference` does not exist in the `medication_request` table (`mr`). Enclosing `subject.reference` in backticks makes BigQuery look for a field named literally `subject.reference`, which doesn't exist.

Similarly, in your subquery, the `subject.reference` field does not exist in the `condition` table (`c`).

---

### **Solution**

To resolve this error, you need to:

1. **Use the Correct Field Name**

   In both the `medication_request` and `condition` tables, the patient reference is stored under `subject.patientId` instead of `subject.reference`. So, you should use `subject.patientId` to refer to the patient ID.

2. **Remove Backticks from Dot Notation**

   When accessing nested fields using dot notation in BigQuery, do not enclose the entire path in backticks. Only use backticks around individual field names if they contain special characters.

---

### **Corrected SQL Query**

Here is the corrected query:

```sql
SELECT p.id AS patient_id, COUNT(DISTINCT med_coding.code) AS medication_count
FROM `bigquery-public-data.fhir_synthea.patient` p,
UNNEST(p.name) AS n
JOIN `bigquery-public-data.fhir_synthea.medication_request` mr
  ON mr.subject.patientId = p.id
JOIN UNNEST(mr.medication.codeableConcept.coding) AS med_coding
WHERE p.deceased.boolean IS NOT TRUE
  AND LOWER(n.family) LIKE 'a%'
  AND (
    SELECT COUNT(*)
    FROM `bigquery-public-data.fhir_synthea.condition` c
    WHERE c.subject.patientId = p.id
  ) = 1
GROUP BY p.id
LIMIT 100;
```

**Explanation:**

- **Updated Join Condition:**

  - Replaced `mr.\`subject.reference\`` with `mr.subject.patientId` in the `JOIN` clause.
  - This correctly references the patient ID in the `medication_request` table.

- **Removed Backticks:**

  - Removed backticks around `subject.reference`. Dot notation doesn't require backticks unless the field names contain special characters.

- **Updated Subquery Condition:**

  - Replaced `c.\`subject.reference\`` with `c.subject.patientId` in the subquery.
  - This ensures you're using the proper field to reference the patient in the `condition` table.

---

### **Why This Correction Works**

- **Field `subject.patientId` Exists:**

  - The `subject` field in both `medication_request` and `condition` tables contains a `patientId` subfield that holds the patient's ID.
  
- **Consistency:**

  - By using `subject.patientId`, you ensure that you're correctly matching the patient's ID across all tables.

---

### **Additional Tips**

- **Inspecting Table Schemas:**

  - To confirm the fields available in a table or nested STRUCT, you can query the table's schema or select a few rows:

    ```sql
    SELECT mr.subject.*
    FROM `bigquery-public-data.fhir_synthea.medication_request` mr
    LIMIT 10;
    ```

- **Backticks Usage:**

  - Use backticks only when a field name contains special characters or is a reserved keyword.
  - Do not enclose dot notation paths in backticks.
  
    **Incorrect:** `mr.`subject.reference``

    **Correct:** `mr.subject.patientId`

---

### **Testing the Corrected Query**

Please run the corrected query provided above. It should execute without errors and return the number of distinct medications prescribed to each patient who:

- Is alive.
- Has a last name starting with 'A'.
- Has only one unique condition.

---

### **Proceeding with Your Analysis**

Now that we've corrected the query, you can use it to retrieve the data needed for your task.

**If your goal is to find the top eight conditions and their codes, ranked by the highest number of different medications prescribed to any single patient, you can build upon this query.**

**For example:**

```sql
WITH eligible_patients AS (
  SELECT p.id AS patient_id
  FROM `bigquery-public-data.fhir_synthea.patient` p,
  UNNEST(p.name) AS n
  WHERE p.deceased.boolean IS NOT TRUE
    AND LOWER(n.family) LIKE 'a%'
),
patients_with_one_condition AS (
  SELECT c.subject.patientId AS patient_id
  FROM `bigquery-public-data.fhir_synthea.condition` c
  GROUP BY c.subject.patientId
  HAVING COUNT(*) = 1
),
final_patients AS (
  SELECT ep.patient_id
  FROM eligible_patients ep
  JOIN patients_with_one_condition pwoc ON ep.patient_id = pwoc.patient_id
),
medication_counts AS (
  SELECT mr.subject.patientId AS patient_id, COUNT(DISTINCT med_coding.code) AS medication_count
  FROM `bigquery-public-data.fhir_synthea.medication_request` mr
  JOIN final_patients fp ON mr.subject.patientId = fp.patient_id
  JOIN UNNEST(mr.medication.codeableConcept.coding) AS med_coding
  GROUP BY mr.subject.patientId
),
patient_conditions AS (
  SELECT c.subject.patientId AS patient_id, coding.display AS condition_name, coding.code AS condition_code
  FROM `bigquery-public-data.fhir_synthea.condition` c
  JOIN final_patients fp ON c.subject.patientId = fp.patient_id
  JOIN UNNEST(c.code.coding) AS coding
)
SELECT
  pc.condition_name AS Condition_Name,
  pc.condition_code AS Condition_Code,
  MAX(mc.medication_count) AS Max_Number_of_Different_Meds_Prescribed
FROM patient_conditions pc
JOIN medication_counts mc ON pc.patient_id = mc.patient_id
GROUP BY pc.condition_name, pc.condition_code
ORDER BY Max_Number_of_Different_Meds_Prescribed DESC
LIMIT 8;
```

**This query:**

- Identifies patients who meet your criteria.
- Counts the number of different medications prescribed to each patient.
- Retrieves the condition name and code for each patient.
- Aggregates the data to find the conditions with the highest number of different medications prescribed.

---

### **Expected Output Format**

```csv
Condition_Name,Condition_Code,Max_Number_of_Different_Meds_Prescribed
condition_name1,str,condition_code1,str,num1,int
condition_name2,str,condition_code2,str,num2,int
condition_name3,str,condition_code3,str,num3,int
condition_name4,str,condition_code4,str,num4,int
condition_name5,str,condition_code5,str,num5,int
condition_name6,str,condition_code6,str,num6,int
condition_name7,str,condition_code7,str,num7,int
condition_name8,str,condition_code8,str,num8,int
(Attention: answer in eight rows)
```

---

### **Let Me Know If You Need Further Assistance**

If you have any questions or need additional help refining your query, please feel free to ask!
2025-01-26 20:30:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:30:25 - root - INFO - It seems you're still encountering the same error when running your SQL query:

```sql
SELECT p.id AS patient_id, COUNT(DISTINCT med_coding.code) AS medication_count
FROM `bigquery-public-data.fhir_synthea.patient` p,
UNNEST(p.name) AS n
JOIN `bigquery-public-data.fhir_synthea.medication_request` mr
  ON mr.`subject.reference` = CONCAT('Patient/', p.id)
JOIN UNNEST(mr.medication.codeableConcept.coding) AS med_coding
WHERE p.deceased.boolean IS NOT TRUE
  AND LOWER(n.family) LIKE 'a%'
  AND (
    SELECT COUNT(*)
    FROM `bigquery-public-data.fhir_synthea.condition` c
    WHERE c.`subject.reference` = CONCAT('Patient/', p.id)
  ) = 1
GROUP BY p.id
LIMIT 100;
```

**Error Message:**

```
400 Name subject.reference not found inside mr at [5:9]; reason: invalidQuery, location: query, message: Name subject.reference not found inside mr at [5:9]
```

---

### **Explanation of the Error**

The error occurs because the field `subject.reference` does not exist in the `medication_request` table (`mr`). Enclosing `subject.reference` in backticks as `mr.\`subject.reference\`` causes BigQuery to look for a field named exactly `subject.reference`, which doesn't exist.

Similarly, in your subquery, the field `subject.reference` does not exist in the `condition` table (`c`). This results in an error when you reference `c.\`subject.reference\`` in your subquery.

---

### **Solution**

To fix the error, you need to:

1. **Use the Correct Field Name**

   In the `medication_request` and `condition` tables, the patient identifier is present in the field `subject.patientId`, not `subject.reference`.

   So, you should replace `subject.reference` with `subject.patientId`.

2. **Remove Backticks Around Field Paths**

   When accessing nested fields using dot notation, do **not** enclose the entire path in backticks. Backticks are used to enclose identifiers that contain special characters or are reserved words, and should enclose only individual field names if necessary.

---

### **Corrected SQL Query**

Here's your query corrected with these changes:

```sql
SELECT p.id AS patient_id, COUNT(DISTINCT med_coding.code) AS medication_count
FROM `bigquery-public-data.fhir_synthea.patient` p,
UNNEST(p.name) AS n
JOIN `bigquery-public-data.fhir_synthea.medication_request` mr
  ON mr.subject.patientId = p.id
JOIN UNNEST(mr.medication.codeableConcept.coding) AS med_coding
WHERE p.deceased.boolean IS NOT TRUE
  AND LOWER(n.family) LIKE 'a%'
  AND (
    SELECT COUNT(*)
    FROM `bigquery-public-data.fhir_synthea.condition` c
    WHERE c.subject.patientId = p.id
  ) = 1
GROUP BY p.id
LIMIT 100;
```

**Explanation of Changes:**

- **Replaced `mr.\`subject.reference\`` with `mr.subject.patientId`**

  - The field `subject.patientId` contains the patient ID in the `medication_request` table.
  - This allows you to join `mr` with `p` using the correct patient identifier.

- **Replaced `c.\`subject.reference\`` with `c.subject.patientId`**

  - In the subquery, the field `subject.patientId` contains the patient ID in the `condition` table.
  - This allows you to correctly filter patients who have only one unique condition.

- **Removed Backticks Around Field Paths**

  - Backticks are not necessary unless the field name contains special characters or conflicts with reserved words.
  - When accessing nested fields with dot notation, do not enclose the entire path in backticks.

---

### **Testing the Corrected Query**

Please run the corrected query above. It should execute without errors and provide you with the count of distinct medications prescribed to patients who:

- Are alive
- Have last names starting with 'A'
- Have only one unique condition

---

### **Proceeding with Your Analysis**

With the corrected query working, you can now proceed to get the top eight conditions and their codes, ranked by the highest number of different medications prescribed to any single patient.

**Full Query to Complete Your Task:**

```sql
WITH eligible_patients AS (
  SELECT p.id AS patient_id
  FROM `bigquery-public-data.fhir_synthea.patient` p,
  UNNEST(p.name) AS n
  WHERE p.deceased.boolean IS NOT TRUE
    AND LOWER(n.family) LIKE 'a%'
    AND (
      SELECT COUNT(*)
      FROM `bigquery-public-data.fhir_synthea.condition` c
      WHERE c.subject.patientId = p.id
    ) = 1
),
patient_med_counts AS (
  SELECT mr.subject.patientId AS patient_id, COUNT(DISTINCT med_coding.code) AS medication_count
  FROM `bigquery-public-data.fhir_synthea.medication_request` mr
  JOIN eligible_patients ep ON mr.subject.patientId = ep.patient_id
  JOIN UNNEST(mr.medication.codeableConcept.coding) AS med_coding
  GROUP BY mr.subject.patientId
),
patient_conditions AS (
  SELECT c.subject.patientId AS patient_id, coding.display AS condition_name, coding.code AS condition_code
  FROM `bigquery-public-data.fhir_synthea.condition` c
  JOIN eligible_patients ep ON c.subject.patientId = ep.patient_id
  JOIN UNNEST(c.code.coding) AS coding
)
SELECT
  pc.condition_name AS Condition_Name,
  pc.condition_code AS Condition_Code,
  MAX(pmc.medication_count) AS Max_Number_of_Different_Meds_Prescribed
FROM patient_conditions pc
JOIN patient_med_counts pmc ON pc.patient_id = pmc.patient_id
GROUP BY pc.condition_name, pc.condition_code
ORDER BY Max_Number_of_Different_Meds_Prescribed DESC
LIMIT 8;
```

**Explanation:**

- **eligible_patients CTE:**

  - Selects patients who are alive, whose last names start with 'A', and who have only one unique condition.

- **patient_med_counts CTE:**

  - Counts the number of distinct medications prescribed to each eligible patient.

- **patient_conditions CTE:**

  - Retrieves the conditions associated with each eligible patient.

- **Final SELECT:**

  - Joins the medication counts with conditions.
  - Groups by condition name and code.
  - Orders by the maximum number of different medications prescribed.
  - Limits the result to the top eight conditions.

---

### **Final Output Format**

The result will be in the format:

```csv
Condition_Name,Condition_Code,Max_Number_of_Different_Meds_Prescribed
condition_name1,str,condition_code1,str,num1,int
condition_name2,str,condition_code2,str,num2,int
condition_name3,str,condition_code3,str,num3,int
condition_name4,str,condition_code4,str,num4,int
condition_name5,str,condition_code5,str,num5,int
condition_name6,str,condition_code6,str,num6,int
condition_name7,str,condition_code7,str,num7,int
condition_name8,str,condition_code8,str,num8,int
(Attention: answer in eight rows)
```

---

### **Conclusion**

By replacing `mr.\`subject.reference\`` and `c.\`subject.reference\`` with `mr.subject.patientId` and `c.subject.patientId`, respectively, you should be able to resolve the errors and successfully run your query.

Please try running the corrected query, and let me know if you encounter any further issues or need additional assistance.
2025-01-26 20:30:26 - root - INFO - itercount: 0
2025-01-26 20:30:26 - root - INFO - Database Name: bigquery-public-data
Schema Name: fhir_synthea
DDL describes table information.
,0
table_name,observation
ddl,"CREATE TABLE `bigquery-public-data.fhir_synthea.observation`
(
  basedOn ARRAY<STRUCT<carePlanId STRING, deviceRequestId STRING, immunizationRecommendationId STRING, medicationRequestId STRING, nutritionOrderId STRING, procedureRequestId STRING, referralRequestId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  bodySite STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>,
  comment STRING,
  dataAbsentReason STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>,
  device STRUCT<deviceId STRING, deviceMetricId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  identifier ARRAY<STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>>,
  implicitRules STRING,
  interpretation STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>,
  language STRING,
  method STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>,
  performer ARRAY<STRUCT<practitionerId STRING, organizationId STRING, patientId STRING, relatedPersonId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  referenceRange ARRAY<STRUCT<low STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, high STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, appliesTo ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, age STRUCT<low STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, high STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>>, text STRING>>,
  related ARRAY<STRUCT<type STRING, target STRUCT<observationId STRING, questionnaireResponseId STRING, sequenceId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>>,
  specimen STRUCT<specimenId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  text STRUCT<status STRING, div STRING>,
  category ARRAY<STRUCT<text STRING, coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>>>,
  code STRUCT<coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>, text STRING>,
  component ARRAY<STRUCT<dataAbsentReason STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, interpretation STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, referenceRange ARRAY<STRUCT<low STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, high STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, appliesTo ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, age STRUCT<low STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, high STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>>, text STRING>>, code STRUCT<coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>, text STRING>, value STRUCT<attachment STRUCT<contentType STRING, language STRING, data STRING, url STRING, size INT64, `hash` STRING, title STRING, creation STRING>, codeableConcept STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, dateTime STRING, period STRUCT<start STRING, `end` STRING>, `range` STRUCT<low STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, high STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>>, ratio STRUCT<numerator STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, denominator STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>>, sampledData STRUCT<origin STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, period FLOAT64, factor FLOAT64, lowerLimit FLOAT64, upperLimit FLOAT64, dimensions INT64, data STRING>, string STRING, time STRING, quantity STRUCT<comparator STRING, code STRING, system STRING, unit STRING, value FLOAT64>>>>,
  context STRUCT<display STRING, episodeOfCareId STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, encounterId STRING>,
  effective STRUCT<period STRUCT<start STRING, `end` STRING>, dateTime STRING>,
  id STRING,
  issued TIMESTAMP,
  meta STRUCT<lastUpdated TIMESTAMP, security ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, tag ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, versionId STRING, profile ARRAY<STRING>>,
  status STRING,
  subject STRUCT<deviceId STRING, display STRING, groupId STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, locationId STRING, reference STRING, patientId STRING>,
  value STRUCT<attachment STRUCT<contentType STRING, language STRING, data STRING, url STRING, size INT64, `hash` STRING, title STRING, creation STRING>, boolean BOOL, dateTime STRING, period STRUCT<start STRING, `end` STRING>, `range` STRUCT<low STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, high STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>>, ratio STRUCT<numerator STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, denominator STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>>, sampledData STRUCT<origin STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, period FLOAT64, factor FLOAT64, lowerLimit FLOAT64, upperLimit FLOAT64, dimensions INT64, data STRING>, time STRING, codeableConcept STRUCT<coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>, text STRING>, quantity STRUCT<comparator STRING, code STRING, system STRING, unit STRING, value FLOAT64>, string STRING>
);"

,1
table_name,immunization
ddl,"CREATE TABLE `bigquery-public-data.fhir_synthea.immunization`
(
  doseQuantity STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>,
  expirationDate STRING,
  explanation STRUCT<reason ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, reasonNotGiven ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>>,
  identifier ARRAY<STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>>,
  implicitRules STRING,
  language STRING,
  location STRUCT<locationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  lotNumber STRING,
  manufacturer STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  note ARRAY<STRUCT<author STRUCT<reference STRUCT<practitionerId STRING, patientId STRING, relatedPersonId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, string STRING>, time STRING, text STRING>>,
  practitioner ARRAY<STRUCT<role STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, actor STRUCT<practitionerId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>>,
  reaction ARRAY<STRUCT<date STRING, detail STRUCT<observationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, reported BOOL>>,
  reportOrigin STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>,
  route STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>,
  site STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>,
  text STRUCT<status STRING, div STRING>,
  vaccinationProtocol ARRAY<STRUCT<doseSequence INT64, description STRING, authority STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, series STRING, seriesDoses INT64, targetDisease ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, doseStatus STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, doseStatusReason STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>>,
  shr_action_PerformedContext_extension STRUCT<shr_action_Status_extension STRUCT<value STRUCT<code STRING>>>,
  date STRING,
  encounter STRUCT<display STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, encounterId STRING>,
  id STRING,
  meta STRUCT<lastUpdated TIMESTAMP, security ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, tag ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, versionId STRING, profile ARRAY<STRING>>,
  notGiven BOOL,
  patient STRUCT<display STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, patientId STRING>,
  primarySource BOOL,
  status STRING,
  vaccineCode STRUCT<coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>, text STRING>
);"

,2
table_name,procedure
ddl,"CREATE TABLE `bigquery-public-data.fhir_synthea.procedure`
(
  basedOn ARRAY<STRUCT<carePlanId STRING, procedureRequestId STRING, referralRequestId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  bodySite ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>,
  category STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>,
  complication ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>,
  complicationDetail ARRAY<STRUCT<conditionId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  definition ARRAY<STRUCT<planDefinitionId STRING, activityDefinitionId STRING, healthcareServiceId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  focalDevice ARRAY<STRUCT<action STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, manipulated STRUCT<deviceId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>>,
  followUp ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>,
  identifier ARRAY<STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>>,
  implicitRules STRING,
  language STRING,
  location STRUCT<locationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  notDone BOOL,
  notDoneReason STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>,
  note ARRAY<STRUCT<author STRUCT<reference STRUCT<practitionerId STRING, patientId STRING, relatedPersonId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, string STRING>, time STRING, text STRING>>,
  outcome STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>,
  partOf ARRAY<STRUCT<procedureId STRING, observationId STRING, medicationAdministrationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  performer ARRAY<STRUCT<role STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, actor STRUCT<practitionerId STRING, organizationId STRING, patientId STRING, relatedPersonId STRING, deviceId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, onBehalfOf STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>>,
  reasonCode ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>,
  report ARRAY<STRUCT<diagnosticReportId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  text STRUCT<status STRING, div STRING>,
  usedCode ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>,
  usedReference ARRAY<STRUCT<deviceId STRING, medicationId STRING, substanceId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  shr_action_PerformedContext_extension STRUCT<shr_action_Status_extension STRUCT<value STRUCT<code STRING>>>,
  code STRUCT<coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>, text STRING>,
  context STRUCT<display STRING, episodeOfCareId STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, encounterId STRING>,
  id STRING,
  meta STRUCT<lastUpdated TIMESTAMP, security ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, tag ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, versionId STRING, profile ARRAY<STRING>>,
  performed STRUCT<dateTime STRING, period STRUCT<`end` STRING, start STRING>>,
  reasonReference ARRAY<STRUCT<identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, observationId STRING, reference STRING, conditionId STRING, display STRING>>,
  status STRING,
  subject STRUCT<display STRING, groupId STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, patientId STRING>
);"

,3
table_name,organization
ddl,"CREATE TABLE `bigquery-public-data.fhir_synthea.organization`
(
  active BOOL,
  alias ARRAY<STRING>,
  endpoint ARRAY<STRUCT<endpointId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  implicitRules STRING,
  language STRING,
  partOf STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  text STRUCT<status STRING, div STRING>,
  address ARRAY<STRUCT<district STRING, period STRUCT<start STRING, `end` STRING>, text STRING, type STRING, use STRING, city STRING, country STRING, line ARRAY<STRING>, postalCode STRING, state STRING>>,
  contact ARRAY<STRUCT<address STRUCT<use STRING, type STRING, text STRING, line ARRAY<STRING>, city STRING, district STRING, state STRING, postalCode STRING, country STRING, period STRUCT<start STRING, `end` STRING>>, purpose STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, telecom ARRAY<STRUCT<system STRING, value STRING, use STRING, rank INT64, period STRUCT<start STRING, `end` STRING>>>, name STRUCT<family STRING, given ARRAY<STRING>, period STRUCT<start STRING, `end` STRING>, prefix ARRAY<STRING>, suffix ARRAY<STRING>, use STRING, text STRING>>>,
  id STRING,
  identifier ARRAY<STRUCT<assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>, period STRUCT<start STRING, `end` STRING>, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, use STRING, system STRING, value STRING>>,
  meta STRUCT<lastUpdated TIMESTAMP, security ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, tag ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, versionId STRING, profile ARRAY<STRING>>,
  name STRING,
  telecom ARRAY<STRUCT<period STRUCT<start STRING, `end` STRING>, rank INT64, use STRING, system STRING, value STRING>>,
  type ARRAY<STRUCT<coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>, text STRING>>
);"

,4
table_name,allergy_intolerance
ddl,"CREATE TABLE `bigquery-public-data.fhir_synthea.allergy_intolerance`
(
  asserter STRUCT<patientId STRING, relatedPersonId STRING, practitionerId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  identifier ARRAY<STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>>,
  implicitRules STRING,
  language STRING,
  lastOccurrence STRING,
  note ARRAY<STRUCT<author STRUCT<reference STRUCT<practitionerId STRING, patientId STRING, relatedPersonId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, string STRING>, time STRING, text STRING>>,
  onset STRUCT<dateTime STRING, age STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, period STRUCT<start STRING, `end` STRING>, `range` STRUCT<low STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, high STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>>, string STRING>,
  reaction ARRAY<STRUCT<substance STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, manifestation ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, description STRING, onset STRING, severity STRING, exposureRoute STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, note ARRAY<STRUCT<author STRUCT<reference STRUCT<practitionerId STRING, patientId STRING, relatedPersonId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, string STRING>, time STRING, text STRING>>>>,
  recorder STRUCT<practitionerId STRING, patientId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  text STRUCT<status STRING, div STRING>,
  assertedDate STRING,
  category ARRAY<STRING>,
  clinicalStatus STRING,
  code STRUCT<coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>, text STRING>,
  criticality STRING,
  id STRING,
  meta STRUCT<lastUpdated TIMESTAMP, security ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, tag ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, versionId STRING, profile ARRAY<STRING>>,
  patient STRUCT<display STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, patientId STRING>,
  type STRING,
  verificationStatus STRING
);"

,5
table_name,care_plan
ddl,"CREATE TABLE `bigquery-public-data.fhir_synthea.care_plan`
(
  author ARRAY<STRUCT<patientId STRING, practitionerId STRING, relatedPersonId STRING, organizationId STRING, careTeamId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  basedOn ARRAY<STRUCT<carePlanId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  careTeam ARRAY<STRUCT<careTeamId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  definition ARRAY<STRUCT<planDefinitionId STRING, questionnaireId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  description STRING,
  identifier ARRAY<STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>>,
  implicitRules STRING,
  language STRING,
  meta STRUCT<versionId STRING, lastUpdated TIMESTAMP, profile ARRAY<STRING>, security ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, tag ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>>,
  note ARRAY<STRUCT<author STRUCT<reference STRUCT<practitionerId STRING, patientId STRING, relatedPersonId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, string STRING>, time STRING, text STRING>>,
  partOf ARRAY<STRUCT<carePlanId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  replaces ARRAY<STRUCT<carePlanId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  supportingInfo ARRAY<STRUCT<resourceId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  text STRUCT<status STRING, div STRING>,
  title STRING,
  activity ARRAY<STRUCT<outcomeCodeableConcept ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, outcomeReference ARRAY<STRUCT<resourceId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>, progress ARRAY<STRUCT<author STRUCT<reference STRUCT<practitionerId STRING, patientId STRING, relatedPersonId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, string STRING>, time STRING, text STRING>>, reference STRUCT<appointmentId STRING, communicationRequestId STRING, deviceRequestId STRING, medicationRequestId STRING, nutritionOrderId STRING, taskId STRING, procedureRequestId STRING, referralRequestId STRING, visionPrescriptionId STRING, requestGroupId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, detail STRUCT<category STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, dailyAmount STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, definition STRUCT<planDefinitionId STRING, activityDefinitionId STRING, questionnaireId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, description STRING, goal ARRAY<STRUCT<goalId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>, location STRUCT<locationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, performer ARRAY<STRUCT<practitionerId STRING, organizationId STRING, relatedPersonId STRING, patientId STRING, careTeamId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>, product STRUCT<codeableConcept STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, reference STRUCT<medicationId STRING, substanceId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>, prohibited BOOL, quantity STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, reasonCode ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, reasonReference ARRAY<STRUCT<conditionId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>, scheduled STRUCT<timing STRUCT<event ARRAY<STRING>, repeat STRUCT<bounds STRUCT<duration STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, `range` STRUCT<low STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, high STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>>, period STRUCT<start STRING, `end` STRING>>, count INT64, countMax INT64, duration FLOAT64, durationMax FLOAT64, durationUnit STRING, frequency INT64, frequencyMax INT64, period FLOAT64, periodMax FLOAT64, periodUnit STRING, dayOfWeek ARRAY<STRING>, timeOfDay ARRAY<STRING>, `when` ARRAY<STRING>, offset INT64>, code STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, period STRUCT<start STRING, `end` STRING>, string STRING>, statusReason STRING, code STRUCT<coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>, text STRING>, status STRING>>>,
  addresses ARRAY<STRUCT<display STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, conditionId STRING>>,
  category ARRAY<STRUCT<coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>, text STRING>>,
  context STRUCT<display STRING, episodeOfCareId STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, encounterId STRING>,
  goal ARRAY<STRUCT<display STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, goalId STRING>>,
  id STRING,
  intent STRING,
  period STRUCT<`end` STRING, start STRING>,
  status STRING,
  subject STRUCT<display STRING, groupId STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, patientId STRING>
);"

,6
table_name,explanation_of_benefit
ddl,"CREATE TABLE `bigquery-public-data.fhir_synthea.explanation_of_benefit`
(
  accident STRUCT<date STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, location STRUCT<address STRUCT<use STRING, type STRING, text STRING, line ARRAY<STRING>, city STRING, district STRING, state STRING, postalCode STRING, country STRING, period STRUCT<start STRING, `end` STRING>>, reference STRUCT<locationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>>,
  addItem ARRAY<STRUCT<sequenceLinkId ARRAY<INT64>, revenue STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, category STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, service STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, modifier ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, fee STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, noteNumber ARRAY<INT64>, adjudication ARRAY<STRUCT<category STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, reason STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, amount STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, value FLOAT64>>, detail ARRAY<STRUCT<revenue STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, category STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, service STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, modifier ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, fee STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, noteNumber ARRAY<INT64>, adjudication ARRAY<STRUCT<category STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, reason STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, amount STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, value FLOAT64>>>>>>,
  benefitBalance ARRAY<STRUCT<category STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, subCategory STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, excluded BOOL, name STRING, description STRING, network STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, unit STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, term STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, financial ARRAY<STRUCT<type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, allowed STRUCT<unsignedInt INT64, string STRING, money STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>>, used STRUCT<unsignedInt INT64, money STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>>>>>>,
  claimResponse STRUCT<claimResponseId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  disposition STRING,
  employmentImpacted STRUCT<start STRING, `end` STRING>,
  enterer STRUCT<practitionerId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  facility STRUCT<locationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  form STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>,
  hospitalization STRUCT<start STRING, `end` STRING>,
  implicitRules STRING,
  information ARRAY<STRUCT<sequence INT64, category STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, code STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, timing STRUCT<date STRING, period STRUCT<start STRING, `end` STRING>>, value STRUCT<string STRING, quantity STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, attachment STRUCT<contentType STRING, language STRING, data STRING, url STRING, size INT64, `hash` STRING, title STRING, creation STRING>, reference STRUCT<resourceId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>, reason STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>>,
  insurer STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  language STRING,
  originalPrescription STRUCT<medicationRequestId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  outcome STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>,
  payee STRUCT<type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, resourceType STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, party STRUCT<practitionerId STRING, organizationId STRING, patientId STRING, relatedPersonId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  precedence INT64,
  prescription STRUCT<medicationRequestId STRING, visionPrescriptionId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  procedure ARRAY<STRUCT<sequence INT64, date STRING, procedure STRUCT<codeableConcept STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, reference STRUCT<procedureId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>>>,
  processNote ARRAY<STRUCT<number INT64, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, text STRING, language STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>>,
  related ARRAY<STRUCT<claim STRUCT<claimId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, relationship STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, reference STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>>, display STRING>>, display STRING>>>>,
  subType ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>,
  text STRUCT<status STRING, div STRING>,
  totalBenefit STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>,
  unallocDeductable STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>,
  StructureDefinition_bluebutton_inpatient_clm_mdcr_non_pmt_rsn_cd_extension STRUCT<value STRUCT<coding STRUCT<code STRING, display STRING, system STRING>>>,
  StructureDefinition_bluebutton_inpatient_clm_pass_thru_per_diem_amt_extension STRUCT<value STRUCT<money STRUCT<code STRING, system STRING, value FLOAT64>>>,
  StructureDefinition_bluebutton_inpatient_clm_pps_cptl_dsprprtnt_shr_amt_extension STRUCT<value STRUCT<money STRUCT<code STRING, system STRING, value FLOAT64>>>,
  StructureDefinition_bluebutton_inpatient_clm_pps_cptl_excptn_amt_extension STRUCT<value STRUCT<money STRUCT<code STRING, system STRING, value FLOAT64>>>,
  StructureDefinition_bluebutton_inpatient_clm_pps_cptl_fsp_amt_extension STRUCT<value STRUCT<money STRUCT<code STRING, system STRING, value FLOAT64>>>,
  StructureDefinition_bluebutton_inpatient_clm_pps_cptl_ime_amt_extension STRUCT<value STRUCT<money STRUCT<code STRING, system STRING, value FLOAT64>>>,
  StructureDefinition_bluebutton_inpatient_clm_pps_cptl_outlier_amt_extension STRUCT<value STRUCT<money STRUCT<code STRING, system STRING, value FLOAT64>>>,
  StructureDefinition_bluebutton_inpatient_clm_pps_old_cptl_hld_hrmls_amt_extension STRUCT<value STRUCT<money STRUCT<code STRING, system STRING, value FLOAT64>>>,
  StructureDefinition_bluebutton_inpatient_clm_tot_pps_cptl_amt_extension STRUCT<value STRUCT<money STRUCT<code STRING, system STRING, value FLOAT64>>>,
  StructureDefinition_bluebutton_inpatient_dsh_op_clm_val_amt_extension STRUCT<value STRUCT<money STRUCT<code STRING, system STRING, value FLOAT64>>>,
  StructureDefinition_bluebutton_inpatient_fi_num_extension STRUCT<value STRUCT<identifier STRUCT<system STRING, value STRING>>>,
  StructureDefinition_bluebutton_inpatient_ime_op_clm_val_amt_extension STRUCT<value STRUCT<money STRUCT<code STRING, system STRING, value FLOAT64>>>,
  StructureDefinition_bluebutton_inpatient_nch_bene_blood_ddctbl_lblty_am_extension STRUCT<value STRUCT<money STRUCT<code STRING, system STRING, value FLOAT64>>>,
  StructureDefinition_bluebutton_inpatient_nch_bene_ip_ddctbl_amt_extension STRUCT<value STRUCT<money STRUCT<code STRING, system STRING, value FLOAT64>>>,
  StructureDefinition_bluebutton_inpatient_nch_bene_pta_coinsrnc_lblty_amt_extension STRUCT<value STRUCT<money STRUCT<code STRING, system STRING, value FLOAT64>>>,
  StructureDefinition_bluebutton_inpatient_nch_drg_outlier_aprvd_pmt_amt_extension STRUCT<value STRUCT<money STRUCT<code STRING, system STRING, value FLOAT64>>>,
  StructureDefinition_bluebutton_inpatient_nch_ip_ncvrd_chrg_amt_extension STRUCT<value STRUCT<money STRUCT<code STRING, system STRING, value FLOAT64>>>,
  StructureDefinition_bluebutton_inpatient_nch_ip_tot_ddctn_amt_extension STRUCT<value STRUCT<money STRUCT<code STRING, system STRING, value FLOAT64>>>,
  StructureDefinition_bluebutton_inpatient_nch_profnl_cmpnt_chrg_amt_extension STRUCT<value STRUCT<money STRUCT<code STRING, system STRING, value FLOAT64>>>,
  StructureDefinition_bluebutton_inpatient_prpayamt_extension STRUCT<value STRUCT<money STRUCT<code STRING, system STRING, value FLOAT64>>>,
  StructureDefinition_bluebutton_outpatient_clm_mdcr_non_pmt_rsn_cd_extension STRUCT<value STRUCT<coding STRUCT<code STRING, display STRING, system STRING>>>,
  StructureDefinition_bluebutton_outpatient_clm_op_bene_pmt_amt_extension STRUCT<value STRUCT<money STRUCT<code STRING, system STRING, value FLOAT64>>>,
  StructureDefinition_bluebutton_outpatient_clm_op_prvdr_pmt_amt_extension STRUCT<value STRUCT<money STRUCT<code STRING, system STRING, value FLOAT64>>>,
  StructureDefinition_bluebutton_outpatient_fi_num_extension STRUCT<value STRUCT<identifier STRUCT<system STRING, value STRING>>>,
  StructureDefinition_bluebutton_outpatient_nch_bene_blood_ddctbl_lblty_am_extension STRUCT<value STRUCT<money STRUCT<code STRING, system STRING, value FLOAT64>>>,
  StructureDefinition_bluebutton_outpatient_nch_bene_ptb_coinsrnc_amt_extension STRUCT<value STRUCT<money STRUCT<code STRING, system STRING, value FLOAT64>>>,
  StructureDefinition_bluebutton_outpatient_nch_bene_ptb_ddctbl_amt_extension STRUCT<value STRUCT<money STRUCT<code STRING, system STRING, value FLOAT64>>>,
  StructureDefinition_bluebutton_outpatient_nch_profnl_cmpnt_chrg_amt_extension STRUCT<value STRUCT<money STRUCT<code STRING, system STRING, value FLOAT64>>>,
  StructureDefinition_bluebutton_outpatient_prpayamt_extension STRUCT<value STRUCT<money STRUCT<code STRING, system STRING, value FLOAT64>>>,
  billablePeriod STRUCT<StructureDefinition_bluebutton_inpatient_claim_query_cd_extension STRUCT<value STRUCT<coding STRUCT<code STRING, display STRING, system STRING>>>, StructureDefinition_bluebutton_outpatient_claim_query_cd_extension STRUCT<value STRUCT<coding STRUCT<code STRING, display STRING, system STRING>>>, `end` STRING, start STRING>,
  careTeam ARRAY<STRUCT<qualification STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, responsible BOOL, provider STRUCT<display STRING, organizationId STRING, practitionerId STRING, reference STRING, identifier STRUCT<assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>, period STRUCT<start STRING, `end` STRING>, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, use STRING, system STRING, value STRING>>, role STRUCT<text STRING, coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>>, sequence INT64>>,
  claim STRUCT<display STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, claimId STRING>,
  created STRING,
  diagnosis ARRAY<STRUCT<packageCode STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, StructureDefinition_bluebutton_inpatient_clm_poa_ind_sw1_extension STRUCT<value STRUCT<coding STRUCT<code STRING, display STRING, system STRING>>>, diagnosis STRUCT<codeableConcept STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, reference STRUCT<display STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, conditionId STRING>>, sequence INT64, type ARRAY<STRUCT<text STRING, coding ARRAY<STRUCT<display STRING, userSelected BOOL, version STRING, code STRING, system STRING>>>>>>,
  id STRING,
  identifier ARRAY<STRUCT<assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>, period STRUCT<start STRING, `end` STRING>, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, use STRING, system STRING, value STRING>>,
  insurance STRUCT<preAuthRef ARRAY<STRING>, coverage STRUCT<coverageId STRING, display STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING>>,
  item ARRAY<STRUCT<bodySite STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, careTeamLinkId ARRAY<INT64>, detail ARRAY<STRUCT<sequence INT64, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, revenue STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, category STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, service STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, modifier ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, programCode ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, quantity STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, unitPrice STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, factor FLOAT64, net STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, udi ARRAY<STRUCT<deviceId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>, noteNumber ARRAY<INT64>, adjudication ARRAY<STRUCT<category STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, reason STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, amount STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, value FLOAT64>>, subDetail ARRAY<STRUCT<sequence INT64, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, revenue STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, category STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, service STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, modifier ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, programCode ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, quantity STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, unitPrice STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, factor FLOAT64, net STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, udi ARRAY<STRUCT<deviceId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>, noteNumber ARRAY<INT64>, adjudication ARRAY<STRUCT<category STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, reason STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, amount STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, value FLOAT64>>>>>>, factor FLOAT64, modifier ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, noteNumber ARRAY<INT64>, procedureLinkId ARRAY<INT64>, programCode ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, quantity STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, revenue STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, subSite ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, udi ARRAY<STRUCT<deviceId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>, unitPrice STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, StructureDefinition_bluebutton_inpatient_rev_cntr_ndc_qty_extension STRUCT<value STRUCT<quantity STRUCT<value FLOAT64>>>, StructureDefinition_bluebutton_outpatient_rev_cntr_ndc_qty_extension STRUCT<value STRUCT<quantity STRUCT<value FLOAT64>>>, adjudication ARRAY<STRUCT<value FLOAT64, amount STRUCT<comparator STRING, unit STRING, code STRING, system STRING, value FLOAT64>, category STRUCT<text STRING, coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>>, reason STRUCT<text STRING, coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>>>>, category STRUCT<text STRING, coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>>, diagnosisLinkId ARRAY<INT64>, encounter ARRAY<STRUCT<display STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, encounterId STRING>>, informationLinkId ARRAY<INT64>, location STRUCT<address STRUCT<use STRING, type STRING, text STRING, line ARRAY<STRING>, city STRING, district STRING, state STRING, postalCode STRING, country STRING, period STRUCT<start STRING, `end` STRING>>, reference STRUCT<locationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, codeableConcept STRUCT<text STRING, coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>>>, net STRUCT<comparator STRING, unit STRING, code STRING, system STRING, value FLOAT64>, sequence INT64, service STRUCT<text STRING, StructureDefinition_bluebutton_outpatient_rev_cntr_ide_ndc_upc_num_extension STRUCT<value STRUCT<coding STRUCT<code STRING, display STRING, system STRING>>>, coding ARRAY<STRUCT<display STRING, userSelected BOOL, code STRING, system STRING, version STRING>>>, serviced STRUCT<date STRING, period STRUCT<`end` STRING, start STRING>>>>,
  meta STRUCT<lastUpdated TIMESTAMP, security ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, tag ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, versionId STRING, profile ARRAY<STRING>>,
  organization STRUCT<display STRING, organizationId STRING, reference STRING, identifier STRUCT<assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>, period STRUCT<start STRING, `end` STRING>, system STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, use STRING, value STRING>>,
  patient STRUCT<display STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, patientId STRING>,
  payment STRUCT<adjustment STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, adjustmentReason STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, date STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, amount STRUCT<comparator STRING, unit STRING, code STRING, system STRING, value FLOAT64>>,
  provider STRUCT<display STRING, practitionerId STRING, reference STRING, identifier STRUCT<assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>, period STRUCT<start STRING, `end` STRING>, system STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, use STRING, value STRING>>,
  referral STRUCT<display STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, referralRequestId STRING, reference STRING>,
  status STRING,
  totalCost STRUCT<comparator STRING, unit STRING, code STRING, system STRING, value FLOAT64>,
  type STRUCT<text STRING, coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>>
);"

,7
table_name,diagnostic_report
ddl,"CREATE TABLE `bigquery-public-data.fhir_synthea.diagnostic_report`
(
  basedOn ARRAY<STRUCT<carePlanId STRING, immunizationRecommendationId STRING, medicationRequestId STRING, nutritionOrderId STRING, procedureRequestId STRING, referralRequestId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  category STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>,
  codedDiagnosis ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>,
  conclusion STRING,
  identifier ARRAY<STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>>,
  image ARRAY<STRUCT<comment STRING, link STRUCT<mediaId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>>,
  imagingStudy ARRAY<STRUCT<imagingStudyId STRING, imagingManifestId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  implicitRules STRING,
  language STRING,
  meta STRUCT<versionId STRING, lastUpdated TIMESTAMP, profile ARRAY<STRING>, security ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, tag ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>>,
  performer ARRAY<STRUCT<role STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, actor STRUCT<practitionerId STRING, organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>>,
  presentedForm ARRAY<STRUCT<contentType STRING, language STRING, data STRING, url STRING, size INT64, `hash` STRING, title STRING, creation STRING>>,
  specimen ARRAY<STRUCT<specimenId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  text STRUCT<status STRING, div STRING>,
  code STRUCT<coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>, text STRING>,
  context STRUCT<display STRING, episodeOfCareId STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, encounterId STRING>,
  effective STRUCT<period STRUCT<start STRING, `end` STRING>, dateTime STRING>,
  id STRING,
  issued TIMESTAMP,
  result ARRAY<STRUCT<identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, display STRING, observationId STRING>>,
  status STRING,
  subject STRUCT<deviceId STRING, display STRING, groupId STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, locationId STRING, reference STRING, patientId STRING>
);"

,8
table_name,basic
ddl,"CREATE TABLE `bigquery-public-data.fhir_synthea.basic`
(
  author STRUCT<practitionerId STRING, patientId STRING, relatedPersonId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  created STRING,
  identifier ARRAY<STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>>,
  implicitRules STRING,
  language STRING,
  subject STRUCT<resourceId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  text STRUCT<status STRING, div STRING>,
  code STRUCT<text STRING, coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>>,
  id STRING,
  meta STRUCT<lastUpdated TIMESTAMP, security ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, tag ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, versionId STRING, profile ARRAY<STRING>>
);"

,9
table_name,patient
ddl,"CREATE TABLE `bigquery-public-data.fhir_synthea.patient`
(
  active BOOL,
  animal STRUCT<species STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, breed STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, genderStatus STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>,
  contact ARRAY<STRUCT<relationship ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, name STRUCT<use STRING, text STRING, family STRING, given ARRAY<STRING>, prefix ARRAY<STRING>, suffix ARRAY<STRING>, period STRUCT<start STRING, `end` STRING>>, telecom ARRAY<STRUCT<system STRING, value STRING, use STRING, rank INT64, period STRUCT<start STRING, `end` STRING>>>, address STRUCT<use STRING, type STRING, text STRING, line ARRAY<STRING>, city STRING, district STRING, state STRING, postalCode STRING, country STRING, period STRUCT<start STRING, `end` STRING>>, gender STRING, organization STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, period STRUCT<start STRING, `end` STRING>>>,
  generalPractitioner ARRAY<STRUCT<organizationId STRING, practitionerId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  implicitRules STRING,
  language STRING,
  link ARRAY<STRUCT<other STRUCT<patientId STRING, relatedPersonId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, type STRING>>,
  managingOrganization STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  photo ARRAY<STRUCT<contentType STRING, language STRING, data STRING, url STRING, size INT64, `hash` STRING, title STRING, creation STRING>>,
  birthPlace STRUCT<value STRUCT<address STRUCT<city STRING, country STRING, state STRING>>>,
  disability_adjusted_life_years STRUCT<value STRUCT<decimal FLOAT64>>,
  patient_mothersMaidenName STRUCT<value STRUCT<string STRING>>,
  quality_adjusted_life_years STRUCT<value STRUCT<decimal FLOAT64>>,
  shr_actor_FictionalPerson_extension STRUCT<value STRUCT<boolean BOOL>>,
  shr_demographics_SocialSecurityNumber_extension STRUCT<value STRUCT<string STRING>>,
  shr_entity_FathersName_extension STRUCT<value STRUCT<humanName STRUCT<text STRING>>>,
  shr_entity_Person_extension STRUCT<value STRUCT<reference STRUCT<basicId STRING>>>,
  us_core_birthsex STRUCT<value STRUCT<code STRING>>,
  us_core_ethnicity STRUCT<ombCategory STRUCT<value STRUCT<coding STRUCT<code STRING, display STRING, system STRING>>>, text STRUCT<value STRUCT<string STRING>>>,
  us_core_race STRUCT<ombCategory STRUCT<value STRUCT<coding STRUCT<code STRING, display STRING, system STRING>>>, text STRUCT<value STRUCT<string STRING>>>,
  address ARRAY<STRUCT<district STRING, period STRUCT<start STRING, `end` STRING>, text STRING, type STRING, use STRING, geolocation STRUCT<latitude STRUCT<value STRUCT<decimal FLOAT64>>, longitude STRUCT<value STRUCT<decimal FLOAT64>>>, city STRING, country STRING, line ARRAY<STRING>, postalCode STRING, state STRING>>,
  birthDate STRING,
  communication ARRAY<STRUCT<preferred BOOL, language STRUCT<coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>, text STRING>>>,
  deceased STRUCT<boolean BOOL, dateTime STRING>,
  gender STRING,
  id STRING,
  identifier ARRAY<STRUCT<assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>, period STRUCT<start STRING, `end` STRING>, use STRING, system STRING, type STRUCT<coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>, text STRING>, value STRING>>,
  maritalStatus STRUCT<coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>, text STRING>,
  meta STRUCT<lastUpdated TIMESTAMP, security ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, tag ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, versionId STRING, profile ARRAY<STRING>>,
  multipleBirth STRUCT<boolean BOOL, integer INT64>,
  name ARRAY<STRUCT<period STRUCT<start STRING, `end` STRING>, text STRING, family STRING, given ARRAY<STRING>, prefix ARRAY<STRING>, suffix ARRAY<STRING>, use STRING>>,
  telecom ARRAY<STRUCT<period STRUCT<start STRING, `end` STRING>, rank INT64, system STRING, use STRING, value STRING>>,
  text STRUCT<div STRING, status STRING>
);"

,10
table_name,imaging_study
ddl,"CREATE TABLE `bigquery-public-data.fhir_synthea.imaging_study`
(
  accession STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>>, display STRING>>, display STRING>>,
  availability STRING,
  basedOn ARRAY<STRUCT<referralRequestId STRING, carePlanId STRING, procedureRequestId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  description STRING,
  endpoint ARRAY<STRUCT<endpointId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  identifier ARRAY<STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>>,
  implicitRules STRING,
  interpreter ARRAY<STRUCT<practitionerId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  language STRING,
  meta STRUCT<versionId STRING, lastUpdated TIMESTAMP, profile ARRAY<STRING>, security ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, tag ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>>,
  modalityList ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>,
  procedureCode ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>,
  procedureReference ARRAY<STRUCT<procedureId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  reason STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>,
  referrer STRUCT<practitionerId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  text STRUCT<status STRING, div STRING>,
  context STRUCT<display STRING, episodeOfCareId STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, encounterId STRING>,
  id STRING,
  numberOfInstances INT64,
  numberOfSeries INT64,
  patient STRUCT<display STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, patientId STRING>,
  series ARRAY<STRUCT<description STRING, endpoint ARRAY<STRUCT<endpointId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>, laterality STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>, performer ARRAY<STRUCT<practitionerId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>, availability STRING, bodySite STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>, instance ARRAY<STRUCT<number INT64, sopClass STRING, title STRING, uid STRING>>, modality STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>, number INT64, numberOfInstances INT64, started STRING, uid STRING>>,
  started STRING,
  uid STRING
);"

,11
table_name,claim
ddl,"CREATE TABLE `bigquery-public-data.fhir_synthea.claim`
(
  accident STRUCT<date STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, location STRUCT<address STRUCT<use STRING, type STRING, text STRING, line ARRAY<STRING>, city STRING, district STRING, state STRING, postalCode STRING, country STRING, period STRUCT<start STRING, `end` STRING>>, reference STRUCT<locationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>>,
  careTeam ARRAY<STRUCT<sequence INT64, provider STRUCT<practitionerId STRING, organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, responsible BOOL, role STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, qualification STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>>,
  created STRING,
  employmentImpacted STRUCT<start STRING, `end` STRING>,
  enterer STRUCT<practitionerId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  facility STRUCT<locationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  fundsReserve STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>,
  hospitalization STRUCT<start STRING, `end` STRING>,
  identifier ARRAY<STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>>,
  implicitRules STRING,
  insurance ARRAY<STRUCT<sequence INT64, focal BOOL, coverage STRUCT<coverageId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, businessArrangement STRING, preAuthRef ARRAY<STRING>, claimResponse STRUCT<claimResponseId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>>,
  insurer STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  language STRING,
  meta STRUCT<versionId STRING, lastUpdated TIMESTAMP, profile ARRAY<STRING>, security ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, tag ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>>,
  originalPrescription STRUCT<medicationRequestId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  payee STRUCT<type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, resourceType STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>, party STRUCT<practitionerId STRING, organizationId STRING, patientId STRING, relatedPersonId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  priority STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>,
  provider STRUCT<practitionerId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  referral STRUCT<referralRequestId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  related ARRAY<STRUCT<claim STRUCT<claimId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, relationship STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, reference STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>>, display STRING>>, display STRING>>>>,
  subType ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>,
  text STRUCT<status STRING, div STRING>,
  type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>,
  billablePeriod STRUCT<`end` STRING, start STRING>,
  diagnosis ARRAY<STRUCT<packageCode STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, type ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, diagnosis STRUCT<codeableConcept STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, reference STRUCT<display STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, conditionId STRING>>, sequence INT64>>,
  id STRING,
  information ARRAY<STRUCT<code STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, reason STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, timing STRUCT<date STRING, period STRUCT<start STRING, `end` STRING>>, category STRUCT<text STRING, coding ARRAY<STRUCT<display STRING, userSelected BOOL, version STRING, code STRING, system STRING>>>, sequence INT64, value STRUCT<attachment STRUCT<contentType STRING, language STRING, data STRING, url STRING, size INT64, `hash` STRING, title STRING, creation STRING>, quantity STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, string STRING, reference STRUCT<display STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, resourceId STRING, immunizationId STRING>>>>,
  item ARRAY<STRUCT<bodySite STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, careTeamLinkId ARRAY<INT64>, category STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, detail ARRAY<STRUCT<sequence INT64, revenue STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, category STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, service STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, modifier ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, programCode ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, quantity STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, unitPrice STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, factor FLOAT64, net STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, udi ARRAY<STRUCT<deviceId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>, subDetail ARRAY<STRUCT<sequence INT64, revenue STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, category STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, service STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, modifier ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, programCode ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, quantity STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, unitPrice STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, factor FLOAT64, net STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, udi ARRAY<STRUCT<deviceId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>>>>>, factor FLOAT64, location STRUCT<codeableConcept STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, address STRUCT<use STRING, type STRING, text STRING, line ARRAY<STRING>, city STRING, district STRING, state STRING, postalCode STRING, country STRING, period STRUCT<start STRING, `end` STRING>>, reference STRUCT<locationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>, modifier ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, programCode ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, quantity STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, revenue STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, serviced STRUCT<date STRING, period STRUCT<start STRING, `end` STRING>>, subSite ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, udi ARRAY<STRUCT<deviceId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>, unitPrice STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, diagnosisLinkId ARRAY<INT64>, encounter ARRAY<STRUCT<display STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, encounterId STRING>>, informationLinkId ARRAY<INT64>, net STRUCT<comparator STRING, unit STRING, code STRING, system STRING, value FLOAT64>, procedureLinkId ARRAY<INT64>, sequence INT64, service STRUCT<text STRING, StructureDefinition_bluebutton_outpatient_rev_cntr_ide_ndc_upc_num_extension STRUCT<value STRUCT<coding STRUCT<code STRING, display STRING, system STRING>>>, coding ARRAY<STRUCT<display STRING, userSelected BOOL, code STRING, system STRING, version STRING>>>>>,
  organization STRUCT<display STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, organizationId STRING>,
  patient STRUCT<display STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, patientId STRING>,
  prescription STRUCT<display STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, visionPrescriptionId STRING, medicationRequestId STRING>,
  procedure ARRAY<STRUCT<date STRING, procedure STRUCT<codeableConcept STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, reference STRUCT<display STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, procedureId STRING>>, sequence INT64>>,
  status STRING,
  total STRUCT<comparator STRING, unit STRING, code STRING, system STRING, value FLOAT64>,
  use STRING
);"

,12
table_name,condition
ddl,"CREATE TABLE `bigquery-public-data.fhir_synthea.condition`
(
  asserter STRUCT<practitionerId STRING, patientId STRING, relatedPersonId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  bodySite ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>,
  evidence ARRAY<STRUCT<code ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, detail ARRAY<STRUCT<resourceId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>>>,
  identifier ARRAY<STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>>,
  implicitRules STRING,
  language STRING,
  note ARRAY<STRUCT<author STRUCT<reference STRUCT<practitionerId STRING, patientId STRING, relatedPersonId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, string STRING>, time STRING, text STRING>>,
  severity STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>,
  stage STRUCT<summary STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, assessment ARRAY<STRUCT<clinicalImpressionId STRING, diagnosticReportId STRING, observationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>>,
  text STRUCT<status STRING, div STRING>,
  abatement STRUCT<age STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, boolean BOOL, period STRUCT<start STRING, `end` STRING>, `range` STRUCT<low STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, high STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>>, string STRING, dateTime STRING>,
  assertedDate STRING,
  category ARRAY<STRUCT<text STRING, coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>>>,
  clinicalStatus STRING,
  code STRUCT<coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>, text STRING>,
  context STRUCT<display STRING, episodeOfCareId STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, encounterId STRING>,
  id STRING,
  meta STRUCT<lastUpdated TIMESTAMP, security ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, tag ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, versionId STRING, profile ARRAY<STRING>>,
  onset STRUCT<age STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, period STRUCT<start STRING, `end` STRING>, `range` STRUCT<low STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, high STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>>, string STRING, dateTime STRING>,
  subject STRUCT<display STRING, groupId STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, patientId STRING>,
  verificationStatus STRING
);"

,13
table_name,goal
ddl,"CREATE TABLE `bigquery-public-data.fhir_synthea.goal`
(
  addresses ARRAY<STRUCT<conditionId STRING, observationId STRING, medicationStatementId STRING, nutritionOrderId STRING, procedureRequestId STRING, riskAssessmentId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  category ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>,
  expressedBy STRUCT<patientId STRING, practitionerId STRING, relatedPersonId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  identifier ARRAY<STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>>,
  implicitRules STRING,
  language STRING,
  meta STRUCT<versionId STRING, lastUpdated TIMESTAMP, profile ARRAY<STRING>, security ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, tag ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>>,
  note ARRAY<STRUCT<author STRUCT<reference STRUCT<practitionerId STRING, patientId STRING, relatedPersonId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, string STRING>, time STRING, text STRING>>,
  outcomeCode ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>,
  outcomeReference ARRAY<STRUCT<observationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  priority STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>,
  start STRUCT<date STRING, codeableConcept STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>,
  statusDate STRING,
  statusReason STRING,
  subject STRUCT<patientId STRING, groupId STRING, organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  target STRUCT<measure STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, detail STRUCT<quantity STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, `range` STRUCT<low STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, high STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>>, codeableConcept STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, due STRUCT<date STRING, duration STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>>>,
  text STRUCT<status STRING, div STRING>,
  description STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>,
  id STRING,
  status STRING
);"

,14
table_name,encounter
ddl,"CREATE TABLE `bigquery-public-data.fhir_synthea.encounter`
(
  account ARRAY<STRUCT<accountId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  appointment STRUCT<appointmentId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  classHistory ARRAY<STRUCT<class STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>, period STRUCT<start STRING, `end` STRING>>>,
  diagnosis ARRAY<STRUCT<condition STRUCT<conditionId STRING, procedureId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, role STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, rank INT64>>,
  episodeOfCare ARRAY<STRUCT<episodeOfCareId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  identifier ARRAY<STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>>,
  implicitRules STRING,
  incomingReferral ARRAY<STRUCT<referralRequestId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  language STRING,
  length STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>,
  location ARRAY<STRUCT<location STRUCT<locationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, status STRING, period STRUCT<start STRING, `end` STRING>>>,
  partOf STRUCT<encounterId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  priority STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>,
  statusHistory ARRAY<STRUCT<status STRING, period STRUCT<start STRING, `end` STRING>>>,
  text STRUCT<status STRING, div STRING>,
  shr_action_PerformedContext_extension STRUCT<shr_action_Status_extension STRUCT<value STRUCT<code STRING>>>,
  class STRUCT<display STRING, userSelected BOOL, version STRING, code STRING, system STRING>,
  hospitalization STRUCT<admitSource STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, destination STRUCT<locationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, dietPreference ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, origin STRUCT<locationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, preAdmissionIdentifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>>, display STRING>>, display STRING>>, reAdmission STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, specialArrangement ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, specialCourtesy ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, dischargeDisposition STRUCT<coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>, text STRING>>,
  id STRING,
  meta STRUCT<lastUpdated TIMESTAMP, security ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, tag ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, versionId STRING, profile ARRAY<STRING>>,
  participant ARRAY<STRUCT<period STRUCT<start STRING, `end` STRING>, type ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>, individual STRUCT<display STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, relatedPersonId STRING, practitionerId STRING>>>,
  period STRUCT<`end` STRING, start STRING>,
  reason ARRAY<STRUCT<text STRING, coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>>>,
  serviceProvider STRUCT<display STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, organizationId STRING>,
  status STRING,
  subject STRUCT<display STRING, groupId STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, patientId STRING>,
  type ARRAY<STRUCT<coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>, text STRING>>
);"

,15
table_name,practitioner
ddl,"CREATE TABLE `bigquery-public-data.fhir_synthea.practitioner`
(
  birthDate STRING,
  communication ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>,
  implicitRules STRING,
  language STRING,
  meta STRUCT<versionId STRING, lastUpdated TIMESTAMP, profile ARRAY<STRING>, security ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, tag ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>>,
  photo ARRAY<STRUCT<contentType STRING, language STRING, data STRING, url STRING, size INT64, `hash` STRING, title STRING, creation STRING>>,
  qualification ARRAY<STRUCT<identifier ARRAY<STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>>, code STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, period STRUCT<start STRING, `end` STRING>, issuer STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>>,
  telecom ARRAY<STRUCT<system STRING, value STRING, use STRING, rank INT64, period STRUCT<start STRING, `end` STRING>>>,
  text STRUCT<status STRING, div STRING>,
  active BOOL,
  address ARRAY<STRUCT<district STRING, period STRUCT<start STRING, `end` STRING>, text STRING, type STRING, use STRING, city STRING, country STRING, line ARRAY<STRING>, postalCode STRING, state STRING>>,
  gender STRING,
  id STRING,
  identifier ARRAY<STRUCT<assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>, period STRUCT<start STRING, `end` STRING>, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, use STRING, system STRING, value STRING>>,
  name ARRAY<STRUCT<period STRUCT<start STRING, `end` STRING>, suffix ARRAY<STRING>, text STRING, use STRING, family STRING, given ARRAY<STRING>, prefix ARRAY<STRING>>>
);"

,16
table_name,medication_request
ddl,"CREATE TABLE `bigquery-public-data.fhir_synthea.medication_request`
(
  basedOn ARRAY<STRUCT<carePlanId STRING, medicationRequestId STRING, procedureRequestId STRING, referralRequestId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  category STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>,
  definition ARRAY<STRUCT<activityDefinitionId STRING, planDefinitionId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  detectedIssue ARRAY<STRUCT<detectedIssueId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  dispenseRequest STRUCT<validityPeriod STRUCT<start STRING, `end` STRING>, numberOfRepeatsAllowed INT64, quantity STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, expectedSupplyDuration STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, performer STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  eventHistory ARRAY<STRUCT<provenanceId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  groupIdentifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>>, display STRING>>, display STRING>>,
  identifier ARRAY<STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>>,
  implicitRules STRING,
  language STRING,
  note ARRAY<STRUCT<author STRUCT<reference STRUCT<practitionerId STRING, patientId STRING, relatedPersonId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, string STRING>, time STRING, text STRING>>,
  priorPrescription STRUCT<medicationRequestId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  priority STRING,
  reasonCode ARRAY<STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>,
  recorder STRUCT<practitionerId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>,
  substitution STRUCT<allowed BOOL, reason STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>>,
  supportingInformation ARRAY<STRUCT<resourceId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>>,
  text STRUCT<status STRING, div STRING>,
  shr_action_RequestedContext_extension STRUCT<shr_action_RequestIntent_extension STRUCT<value STRUCT<code STRING>>, shr_action_Status_extension STRUCT<value STRUCT<code STRING>>>,
  shr_base_ActionCode_extension STRUCT<value STRUCT<codeableConcept STRUCT<coding ARRAY<STRUCT<code STRING, display STRING, system STRING>>, text STRING>>>,
  authoredOn STRING,
  context STRUCT<display STRING, episodeOfCareId STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, encounterId STRING>,
  dosageInstruction ARRAY<STRUCT<maxDosePerAdministration STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, maxDosePerLifetime STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, maxDosePerPeriod STRUCT<numerator STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, denominator STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>>, method STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, patientInstruction STRING, rate STRUCT<ratio STRUCT<numerator STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, denominator STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>>, `range` STRUCT<low STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, high STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>>, quantity STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>>, route STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, site STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, text STRING, additionalInstruction ARRAY<STRUCT<coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>, text STRING>>, asNeeded STRUCT<codeableConcept STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, boolean BOOL>, dose STRUCT<`range` STRUCT<low STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, high STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>>, quantity STRUCT<code STRING, system STRING, unit STRING, value FLOAT64>>, sequence INT64, timing STRUCT<code STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, event ARRAY<STRING>, repeat STRUCT<bounds STRUCT<duration STRUCT<value FLOAT64, comparator STRING, unit STRING, system STRING, code STRING>, `range` STRUCT<low STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>, high STRUCT<value FLOAT64, unit STRING, system STRING, code STRING>>, period STRUCT<start STRING, `end` STRING>>, count INT64, countMax INT64, dayOfWeek ARRAY<STRING>, duration FLOAT64, durationMax FLOAT64, durationUnit STRING, frequencyMax INT64, offset INT64, periodMax FLOAT64, timeOfDay ARRAY<STRING>, `when` ARRAY<STRING>, frequency INT64, period FLOAT64, periodUnit STRING>>>>,
  id STRING,
  intent STRING,
  medication STRUCT<reference STRUCT<medicationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, display STRING>, codeableConcept STRUCT<coding ARRAY<STRUCT<userSelected BOOL, version STRING, code STRING, display STRING, system STRING>>, text STRING>>,
  meta STRUCT<lastUpdated TIMESTAMP, security ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, tag ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, versionId STRING, profile ARRAY<STRING>>,
  reasonReference ARRAY<STRUCT<display STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, observationId STRING, reference STRING, conditionId STRING>>,
  requester STRUCT<agent STRUCT<deviceId STRING, display STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, organizationId STRING, patientId STRING, reference STRING, relatedPersonId STRING, practitionerId STRING>, onBehalfOf STRUCT<display STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, organizationId STRING>>,
  status STRING,
  subject STRUCT<display STRING, groupId STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, identifier STRUCT<use STRING, type STRUCT<coding ARRAY<STRUCT<system STRING, version STRING, code STRING, display STRING, userSelected BOOL>>, text STRING>, system STRING, value STRING, period STRUCT<start STRING, `end` STRING>, assigner STRUCT<organizationId STRING, reference STRING, display STRING>>, display STRING>>, reference STRING, patientId STRING>
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'fhir_synthea': ['allergy_intolerance', 'basic', 'care_plan', 'claim', 'condition', 'diagnostic_report', 'encounter', 'explanation_of_benefit', 'goal', 'imaging_study', 'immunization', 'medication_request', 'observation', 'organization', 'patient', 'practitioner', 'procedure']}}
Begin Exploring Related Columns
Sure, let's consider which tables and columns are relevant to the task.

**Relevant Tables and Columns:**

1. **Table:** `bigquery-public-data.fhir_synthea.patient`
   - **`id`**: Patient's unique identifier. Used to join with other tables.
   - **`name`**: Contains the patient's names.
     - **`name.family`**: Patient's last name. Used to filter patients whose last names start with 'A'.
   - **`deceased.boolean`**: Indicates if the patient is deceased. Used to filter living patients.

2. **Table:** `bigquery-public-data.fhir_synthea.condition`
   - **`subject.reference`**: Reference to the patient (`Patient/{id}`). Used to join with the patient table.
   - **`code`**: Contains information about the condition.
     - **`code.coding`**: An array of coding systems for the condition.
       - **`code.coding.code`**: The condition code. Used to identify the condition.
       - **`code.coding.display`**: The name of the condition.

3. **Table:** `bigquery-public-data.fhir_synthea.medication_request`
   - **`subject.reference`**: Reference to the patient (`Patient/{id}`). Used to join with the patient table.
   - **`medication`**: Details about the prescribed medication.
     - **`medication.codeableConcept.coding`**: An array of coding systems for the medication.
       - **`medication.codeableConcept.coding.code`**: The medication code. Used to identify different medications.

**Conditions that may be used:**

- **Filter living patients whose last names start with 'A':**
  - `deceased.boolean IS NOT TRUE`
  - `LOWER(name.family) LIKE 'a%'`

- **Filter patients with only one unique condition:**
  - `COUNT(condition.id) = 1`

- **Count the number of different medications prescribed to each patient:**
  - `COUNT(DISTINCT medication.codeableConcept.coding.code)`

---

Now, let's write at least 10 BigQuery SQL queries to understand the data. Each query is different and explores the relevant columns.

---

**1. Retrieve patient IDs and last names of patients whose last names start with 'A'**

```sql
SELECT p.id AS patient_id, n.family AS last_name
FROM `bigquery-public-data.fhir_synthea.patient` p,
UNNEST(p.name) AS n
WHERE LOWER(n.family) LIKE 'a%'
LIMIT 100;
```

---

**2. Retrieve patient IDs of living patients (not deceased)**

```sql
SELECT p.id AS patient_id
FROM `bigquery-public-data.fhir_synthea.patient` p
WHERE p.deceased.boolean IS NOT TRUE
LIMIT 100;
```

---

**3. Retrieve patient IDs and last names of living patients whose last names start with 'A'**

```sql
SELECT p.id AS patient_id, n.family AS last_name
FROM `bigquery-public-data.fhir_synthea.patient` p,
UNNEST(p.name) AS n
WHERE p.deceased.boolean IS NOT TRUE
  AND LOWER(n.family) LIKE 'a%'
LIMIT 100;
```

---

**4. Count the number of conditions per patient**

```sql
SELECT c.`subject.reference` AS patient_reference, COUNT(*) AS condition_count
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.`subject.reference`
LIMIT 100;
```

---

**5. Find patients with only one unique condition**

```sql
SELECT c.`subject.reference` AS patient_reference
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.`subject.reference`
HAVING COUNT(*) = 1
LIMIT 100;
```

---

**6. Retrieve condition codes and names**

```sql
SELECT c.id AS condition_id, coding.code AS condition_code, coding.display AS condition_name
FROM `bigquery-public-data.fhir_synthea.condition` c,
UNNEST(c.code.coding) AS coding
LIMIT 100;
```

---

**7. Retrieve medication codes prescribed to patients**

```sql
SELECT mr.id AS medication_request_id, mr.`subject.reference` AS patient_reference, med_coding.code AS medication_code
FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
UNNEST(mr.medication.codeableConcept.coding) AS med_coding
LIMIT 100;
```

---

**8. Count the number of different medications prescribed to each patient**

```sql
SELECT mr.`subject.reference` AS patient_reference, COUNT(DISTINCT med_coding.code) AS medication_count
FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
UNNEST(mr.medication.codeableConcept.coding) AS med_coding
GROUP BY mr.`subject.reference`
LIMIT 100;
```

---

**9. Retrieve patient IDs of living patients whose last names start with 'A' and have only one unique condition**

```sql
SELECT p.id AS patient_id
FROM `bigquery-public-data.fhir_synthea.patient` p,
UNNEST(p.name) AS n
WHERE p.deceased.boolean IS NOT TRUE
  AND LOWER(n.family) LIKE 'a%'
  AND (
    SELECT COUNT(*)
    FROM `bigquery-public-data.fhir_synthea.condition` c
    WHERE c.`subject.reference` = CONCAT('Patient/', p.id)
  ) = 1
LIMIT 100;
```

---

**10. Count the number of different medications prescribed to each patient who meets the criteria**

```sql
SELECT p.id AS patient_id, COUNT(DISTINCT med_coding.code) AS medication_count
FROM `bigquery-public-data.fhir_synthea.patient` p,
UNNEST(p.name) AS n
JOIN `bigquery-public-data.fhir_synthea.medication_request` mr
  ON mr.`subject.reference` = CONCAT('Patient/', p.id)
JOIN UNNEST(mr.medication.codeableConcept.coding) AS med_coding
WHERE p.deceased.boolean IS NOT TRUE
  AND LOWER(n.family) LIKE 'a%'
  AND (
    SELECT COUNT(*)
    FROM `bigquery-public-data.fhir_synthea.condition` c
    WHERE c.`subject.reference` = CONCAT('Patient/', p.id)
  ) = 1
GROUP BY p.id
LIMIT 100;
```

---

**11. Retrieve condition codes and names for patients who meet the criteria**

```sql
SELECT DISTINCT coding.code AS condition_code, coding.display AS condition_name
FROM `bigquery-public-data.fhir_synthea.patient` p,
UNNEST(p.name) AS n
JOIN `bigquery-public-data.fhir_synthea.condition` c
  ON c.`subject.reference` = CONCAT('Patient/', p.id)
JOIN UNNEST(c.code.coding) AS coding
WHERE p.deceased.boolean IS NOT TRUE
  AND LOWER(n.family) LIKE 'a%'
  AND (
    SELECT COUNT(*)
    FROM `bigquery-public-data.fhir_synthea.condition` c2
    WHERE c2.`subject.reference` = CONCAT('Patient/', p.id)
  ) = 1
LIMIT 100;
```

---

**12. Get the maximum number of different medications prescribed to any single patient for each condition**

```sql
SELECT coding.code AS condition_code, coding.display AS condition_name, MAX(patient_med_counts.medication_count) AS max_medications_prescribed
FROM (
  SELECT p.id AS patient_id, COUNT(DISTINCT med_coding.code) AS medication_count
  FROM `bigquery-public-data.fhir_synthea.patient` p,
  UNNEST(p.name) AS n
  JOIN `bigquery-public-data.fhir_synthea.medication_request` mr
    ON mr.`subject.reference` = CONCAT('Patient/', p.id)
  JOIN UNNEST(mr.medication.codeableConcept.coding) AS med_coding
  WHERE p.deceased.boolean IS NOT TRUE
    AND LOWER(n.family) LIKE 'a%'
    AND (
      SELECT COUNT(*)
      FROM `bigquery-public-data.fhir_synthea.condition` c
      WHERE c.`subject.reference` = CONCAT('Patient/', p.id)
    ) = 1
  GROUP BY p.id
) AS patient_med_counts
JOIN `bigquery-public-data.fhir_synthea.condition` c
  ON c.`subject.reference` = CONCAT('Patient/', patient_med_counts.patient_id)
JOIN UNNEST(c.code.coding) AS coding
GROUP BY coding.code, coding.display
ORDER BY max_medications_prescribed DESC
LIMIT 100;
```

---

**13. List the top eight conditions and their codes, ranked by the highest number of different medications prescribed to any single patient**

```sql
SELECT coding.display AS Condition_Name, coding.code AS Condition_Code, MAX(patient_med_counts.medication_count) AS Max_Number_of_Different_Meds_Prescribed
FROM (
  SELECT p.id AS patient_id, COUNT(DISTINCT med_coding.code) AS medication_count
  FROM `bigquery-public-data.fhir_synthea.patient` p,
  UNNEST(p.name) AS n
  JOIN `bigquery-public-data.fhir_synthea.medication_request` mr
    ON mr.`subject.reference` = CONCAT('Patient/', p.id)
  JOIN UNNEST(mr.medication.codeableConcept.coding) AS med_coding
  WHERE p.deceased.boolean IS NOT TRUE
    AND LOWER(n.family) LIKE 'a%'
    AND (
      SELECT COUNT(*)
      FROM `bigquery-public-data.fhir_synthea.condition` c
      WHERE c.`subject.reference` = CONCAT('Patient/', p.id)
    ) = 1
  GROUP BY p.id
) AS patient_med_counts
JOIN `bigquery-public-data.fhir_synthea.condition` c
  ON c.`subject.reference` = CONCAT('Patient/', patient_med_counts.patient_id)
JOIN UNNEST(c.code.coding) AS coding
GROUP BY coding.display, coding.code
ORDER BY Max_Number_of_Different_Meds_Prescribed DESC
LIMIT 8;
```

---

These queries help us understand and explore the data required to complete the task. They progressively build from simple queries retrieving basic information to more complex ones that combine multiple tables and conditions to achieve the desired result.

Please note that due to the complexity of the data, some queries might need adjustments when run against the actual dataset. These queries are aimed at providing a clear pathway to solving the task.Query:
SELECT p.id AS patient_id, n.family AS last_name
FROM `bigquery-public-data.fhir_synthea.patient` p,
UNNEST(p.name) AS n
WHERE LOWER(n.family) LIKE 'a%'
LIMIT 100;
Answer:
patient_id,last_name
8032ad13-fc72-4a4e-b261-a3b49f50d941,Arias66
4a650a2f-292f-4848-b0c9-ec69aef45da1,Anderson154
efd1fa06-e1f9-41b8-b9c1-b98433294227,Armenta418
377c2220-ef23-4d9c-92a1-38bc5cf7160c,Araña824
0a167768-f29c-447c-a7af-47b8c2569d1d,Alonzo487
e3908397-0a9a-4bd1-a59f-d4869dffb12b,Agosto501
ce393e5a-fa61-49b3-b6b3-ef4385eaa05e,Alarcón922
d6e37e63-7baa-4cb7-9cd9-c80791cb73d9,Alonzo487
4cc91df1-d2d5-4e05-ad97-8fef8ca95251,Arteaga169
7d428e41-52f7-4da5-9e75-8ef83bd6f173,Amaya149
5d017d6e-2c18-4bf2-a6bb-3f1d4273953f,Archuleta517
7348042f-ba2c-4c08-b556-e209d0ba4436,Armstrong51
c23429d0-36da-4635-a995-f9d1969c33ed,Alcala54
9b339407-6ea3-4af3-822c-24e5c8d8ae24,Alanis890
0838849d-1912-4b57-ac3e-cf9f5417bd2b,Alanis890
8e034f99-9919-4139-8ed4-9833db502a19,Alcala54
8e034f99-9919-4139-8ed4-9833db502a19,Amador986
f28fb25f-1152-439a-a020-638f0fb89e2a,Anderson154
cc21f795-fdff-4ba2-91bb-2fd99d975330,Alarcón922
5be9c6db-616b-4a53-b016-9e433a344db5,Arredondo74
477a899e-1b9d-4708-8853-6ec902ec6b56,Adams676
9fff34d3-0ca5-4647-981c-318cd5d76e66,Aparicio848
6b9b06da-ec98-4fb5-a341-73fedbb8ee3a,Apodaca347
05ace685-be54-4909-a6e5-f87ec00d612a,Agosto501
8be0454a-f458-4f2d-9a22-8c903b64671e,Araña824
deb4ec0c-8242-4865-a554-68453680c1d4,Abernathy524
1656c34c-ec46-466b-80b4-d26a24f04c96,Arellano2
dbefd096-072a-4cb3-b581-4713cbfda254,Alfaro627
dcd38748-95d3-44eb-9021-d40eb08ab34e,Armijo730
b2df3c49-d099-497d-bcdf-aff76dc5a125,Atencio773
c2ff78c4-6187-44a4-af3a-b69fefc94a74,Alonzo487
d11aaf13-c799-4bc1-bdd4-e9633df7747c,Arellano2
816a8ac3-ce41-4884-ab58-d6acb68f3aa0,Alcaraz418
ab7957ea-e604-4e33-a89a-8391b043809a,Amador986
6c5683bb-0fc0-4283-bfe3-f4fc66694487,Abernathy524
0ead5f93-9c47-469c-b603-394b7ac8fd64,Abernathy524
d46a0f5c-10ef-4e9b-9fd6-1ed940cfef7d,Alonzo487
d46a0f5c-10ef-4e9b-9fd6-1ed940cfef7d,Arevalo970
59aa6977-9848-4cef-b00a-013656eaefe5,Aguirre875
eeb07fe8-5a14-4445-ab21-cd12d36cd3b9,Alva958
259e2cd4-7ba8-4f37-ba55-3410e4597912,Arredondo74
82b05ff3-8d7b-4c1e-8879-fd59888a42f0,Abernathy524
4a8a7419-fe30-47f9-8ad4-30c15140b3ad,Aparicio848
667d388e-3669-47a8-9a40-4320a8a4e980,Abbott774
9110049a-fa24-480d-aec0-c59291221b74,Arroyo916
ede41443-1b12-40ef-9bb9-10dc470b74f2,Alcántar600
3bfbd573-b9bc-42a9-a9cc-3ee827b1ecfc,Alonzo487
f8958356-31d2-4798-b752-3682a3e0bd59,Almanza534
095bca96-9006-4ef6-966f-ce02c81fa161,Abbott774
c0261a25-8221-44ab-97ad-4de3e82c1410,Aufderhar910
24707c06-8889-4507-a338-4dadf40818ac,Ankunding277
477604d9-1855-49dd-9e72-5b2310e1f036,Adams676
2a74a15b-dfbf-4487-943b-9a303ad6e80f,Abbott774
3478e948-a5d0-4ee8-8e12-ec5aca7df837,Aufderhar910
b47c7f5e-0939-48c0-99b8-b5ba80bd4f4a,Abbott774
83d00e41-8062-4d38-a7fa-fe9f6e00c110,Ankunding277
9bb587e2-f0f8-4b13-a96c-4e5e8b90bd7d,Aufderhar910
8ae1b460-60a3-43b2-a7cb-23976136ab97,Armstrong51
1e562e8e-dd93-4833-8265-93c58badb40a,Ankunding277
5e146d1d-4c3a-4276-9d34-26addb7637e1,Auer97
b82685dd-0d24-4ad8-8f58-4cbcde39962d,Anderson154
1db213cd-353e-47a2-a3b9-bd1717fe28b4,Abshire638
Query:
SELECT p.id AS patient_id
FROM `bigquery-public-data.fhir_synthea.patient` p
WHERE p.deceased.boolean IS NOT TRUE
LIMIT 100;
Answer:
patient_id
fa00b120-f9e9-41de-9dbb-c3380b8f5a0f
e571fb6d-ffcc-46e7-8a78-c3f093066d9f
84971c9e-1074-451b-a729-2bfd344cafa1
b0bd5ca1-a6ae-4065-b8d5-6fdae66b3706
269e13f6-7f5f-44ff-a821-7981939eed52
634e4aa8-6f96-40b5-8c1c-4fffe6602c1a
c885e763-9287-4097-bcb8-69b4971b90c1
f2ca3683-427d-4ba6-a9a8-e4082f544539
97d713c0-a256-4315-bc14-b64c92ef632b
8032ad13-fc72-4a4e-b261-a3b49f50d941
4a650a2f-292f-4848-b0c9-ec69aef45da1
efd1fa06-e1f9-41b8-b9c1-b98433294227
e19ed657-ef6b-453f-acc2-a83ebb02d0b5
fbaff489-95a6-4bb0-bf3e-784f261fed5e
d460db22-3269-4cae-bc2a-14248da4319b
cbc1e0a9-caf8-4f0e-8b1f-745041c79b94
377c2220-ef23-4d9c-92a1-38bc5cf7160c
141fbba7-6e7c-459b-8f46-c169f26815a6
6759d2b7-38b4-4798-97c0-d171a53e013a
60d4c002-16ad-4bee-a7b5-6d3c439f24b1
e42800f2-0131-46f7-8d50-79765f6690f2
b36d6b99-54f1-4714-b8ed-c9ce698f8669
0c8a7c60-4e2f-4892-9669-9e4c100f3714
b8857e9b-c89b-485a-bfd3-88ce2a1bed7b
88430cc1-fb79-4dc8-b452-475ff0b3826b
47c8ea59-f87d-45b4-8eb0-9ce7d89f667a
de558190-9339-460f-8ab8-03fe50107bd8
41dbee4d-d355-413f-a040-93ca037fe646
e194d708-8989-4e0c-a8e1-eda7351672ce
e9aaf98e-a8d1-4ed3-b819-8d31be1e23bb
cad4a6d3-fb15-46b6-b28b-e1a859fc8177
4bccdc85-c040-45dd-ada3-a55064439a01
dba01afb-7716-4b73-a645-d000e5316aea
b9b55f59-6f87-4100-bb81-63ec233b82dd
4046d1fb-e427-4a1f-88cd-968a0f553874
8dca4c3c-d2d5-460f-9168-5f18e5d29b2b
271c936d-bbd4-4bb0-aac9-809a14a05ef6
fdb661ec-55cb-4b93-afa2-d4b3149ec8da
18f2da6c-3c6c-49bf-b552-e5a0928837d2
a1a3e19f-3517-4ec1-9242-fa3050a5758b
3c2680a1-b43c-4235-9847-72fb2b68ae50
466cdc09-8fc8-4501-84fc-98364dd7d551
c86d9699-b4b1-48d3-8ddb-cdf3047f6ad0
2a283f6e-855b-477a-8edc-b24d45d85815
9af934bb-5cb2-4cac-96a1-e3016593ba87
4e80682c-c4ab-4b31-9c8f-9cf79cb39eec
0a167768-f29c-447c-a7af-47b8c2569d1d
e15f652e-8280-45b1-8f76-e02d7adbbdce
778975c8-f112-4bfa-94c0-3ca4af0f4756
32202944-d501-4b61-ba7b-d6d57d137d24
b548fb6a-ddcb-46d3-9e53-7e194b67f35a
e3908397-0a9a-4bd1-a59f-d4869dffb12b
004b807d-8af2-4b56-8476-9883e21ca399
a5fc3d65-b568-4da5-84d8-534699131169
4a2722fa-a07c-4f8f-aace-08e2f9ca2f16
75c6bad0-78f1-43c2-83b9-3e9695255d80
1d4e68d7-880f-4f3c-9436-f05831cb7bac
ce393e5a-fa61-49b3-b6b3-ef4385eaa05e
5e4a0f91-9fa9-4933-b232-6cf481e0474e
98a56443-8bb9-4054-a8d7-f5afc95e17ae
1d3118be-6168-4372-895e-7e096b4fb41f
ab3bf8af-124a-473b-a3cb-76ae45564cc0
336dffa5-ca4e-4cf3-ac91-0e1aaba48598
e397f53f-ff7a-4304-b0fa-ecefd2eb3161
576a1062-71d5-4ce7-96c9-d424ddd3ce74
772df8e6-2b47-4f93-b020-7e4af21cd6e2
8150fdde-ef55-4328-90cc-bfaf970d42d4
0d52fd3c-6769-41f9-a9f7-b5831a9e0821
d6e37e63-7baa-4cb7-9cd9-c80791cb73d9
a4ab38ad-7392-4961-9a24-fae29ef2157a
7859a29e-1494-425c-b4f9-2064295c85c1
21ee41a2-f384-4d1b-84b5-3d6f71094867
4336eeba-2805-4a29-89fb-f5a9674d4bdc
f8637589-b00f-4110-b4e9-68a1e8eaa52e
a6b6d532-e0cc-4ed0-a51d-543c49e8a396
7d10ea5d-d416-41c4-bdb4-f17214fef618
1a0a682e-3265-4f31-af7d-fd7c6fd18f93
e04fcfc1-2984-4e0c-9006-c7e90e002faf
681ed06a-b179-4aa8-852c-ea8d259abb46
158a6eae-5528-48ac-bec1-8d0aa7915fb3
a09c4f56-6f6f-441b-a4d5-54885d1faebc
932ae186-6880-4287-b570-32c9faea9df7
12b551f6-09b4-4a8a-a264-5812ee7104ff
77df8f34-896b-4d59-bc3f-c4c411a27b63
fcb3d4a0-59af-4c3d-8aab-5f5464e32a0b
a76175aa-a86b-4f3c-92f7-28912c357925
d5aca71b-d933-437b-897d-0b4aff154f33
b9b941f6-5218-4706-ad0a-f64526791d78
6feacaab-8b14-470f-8c2c-99c6600a6ae3
4e1a04d4-eb35-48f8-8d72-18b1f4c86ac1
3e2849cc-58f0-445f-ac08-66bde19546d2
4cc91df1-d2d5-4e05-ad97-8fef8ca95251
7d428e41-52f7-4da5-9e75-8ef83bd6f173
Query:
SELECT p.id AS patient_id, n.family AS last_name
FROM `bigquery-public-data.fhir_synthea.patient` p,
UNNEST(p.name) AS n
WHERE p.deceased.boolean IS NOT TRUE
  AND LOWER(n.family) LIKE 'a%'
LIMIT 100;
Answer:
patient_id,last_name
c295157a-a84e-4bd8-8584-8296d149d978,Alonso270
8319e658-4a44-4aa0-a2e8-f1a57abf2d88,Arreola736
53d8c141-c64a-4bd0-8b5d-759afa527d1b,Aparicio848
5b48d83a-74e0-4309-ba3a-86aeaafab091,Apodaca347
8a1c8c05-dd80-486c-aa01-2dd0504f688f,Ayala238
8a1c8c05-dd80-486c-aa01-2dd0504f688f,Alejandro916
a805a39e-e7bd-4c10-a6fd-8144318ecf33,Atencio773
e71f002c-e70f-4b16-a7b0-5a38a0fa0ff9,Adorno791
05ee566e-fe08-48bf-a031-3183c177d71b,Agosto501
d49d69e6-252b-4bc1-b706-882a6837d37f,Almaraz628
388b7595-ed9a-4ce9-a3af-c6d4f0d11801,Alvarado520
57f5e495-8894-43be-a19c-01d45f4cbd19,Agosto501
4d01b7a7-c541-4c2a-9b2c-54f49370d771,Abrego412
bc7c694e-cfb3-4d11-9849-e6c956db276a,Almonte426
b506efb0-3bed-4cd3-8d9a-b0dbeeb2138a,Abshire638
e65720ca-eaaa-45d0-a7d4-c5ac89be378e,Alejandro916
ceb7523f-ba7a-4525-9c0f-4c155c2cb4b6,Alejandro916
04db0933-359c-4a22-b20d-b0d90e6f4c1d,Arenas932
356d1f40-7ad5-42f3-82b2-42b41025ba26,Alanis890
02a56e10-f016-40b1-a258-375a523cee27,Anderson154
76b78875-c98d-47b5-8ffb-80d5a4e669f2,Armstrong51
dc660b45-a403-4b84-be44-dda77719b737,Alva958
39886b7f-cdfe-4763-9b69-6bdec67cb336,Acuña179
3d3e68c9-4d73-432e-a831-83c8d35802b6,Armenta418
9277d0ce-6e9c-4ce4-8a4d-9d84d83379d0,Armendáriz135
a98d9926-0c41-48c9-886f-62ff933a682f,Araña824
b7a594a7-5085-415e-a5cc-cb75f5bb38a3,Adams676
c426dacd-bec7-404f-8b45-44b3274a89b2,Avilés474
1087ffdc-5719-44bc-a555-b6496608a251,Anguiano812
fc9cc806-0e78-45fa-8a98-42790a5c44f1,Aufderhar910
6d26e7f9-1c47-43a6-9fe1-b65d05f60542,Aparicio848
231ec8df-f0d4-43b9-bee9-1c7151d20785,Arriaga291
c6a87284-9640-47d5-a7e0-fbf125706026,Alicea505
76d3c618-1892-43ef-ba9f-d8f217c3f72c,Arias66
e98ebbf3-25f4-4865-9b22-cd6d17d94d8e,Armendáriz135
a445dc8e-1a1e-4d86-87fa-a4a1f0ad15c3,Altenwerth646
104f467f-428c-47a5-97e8-247e66437d14,Almaraz628
2abbb073-952d-4b22-86ab-940a75f25c55,Aponte375
15e21607-ca96-49e0-87b5-5d1421910008,Aparicio848
a05196e0-6437-4778-8de3-0c33461eaf8b,Atencio773
114c57bc-6688-45aa-8764-e99a39bf2fad,Arreola736
b7840c6c-a571-4dfb-bcae-9ed0f49b9ac2,Arroyo916
701e5602-6ad8-4d85-be56-d5d3d1949220,Amaya149
49373865-203e-476c-9800-b4193217885e,Ayala238
4630be90-35e0-455a-8ea0-62c1493d8012,Archuleta517
ce1501c0-1cb2-4e02-ac30-43c10f0e40ef,Aufderhar910
bee98d4b-083e-482c-8ae5-03dd6b8db753,Abernathy524
de5b3688-cd27-4986-8c64-a1b363ffcfc8,Abshire638
ac62f17f-7712-461e-9278-b0cabb17d78f,Armstrong51
f2c58222-20cb-40bb-aecc-ffcd93324b72,Abshire638
6ab32895-b404-419b-9afa-f849821eaed4,Aufderhar910
5f2d7a71-d3b1-4a5d-843b-f4c04306507a,Altenwerth646
896bc5a1-eeb7-4817-8a7a-a21c2b2e66e4,Abshire638
241bb0d6-855a-4dfd-b496-329dda5e355b,Ankunding277
cebaf8b0-10f7-4247-a142-c073c508c126,Abshire638
f270cee5-40cb-4381-ada4-aec2039ee3cd,Aufderhar910
7a0615a4-1b5d-493a-b9bf-16fb40bb277c,Anderson154
77acdbe6-7136-4cb9-9f10-1683497a0f81,Adams676
515cb6d2-264c-4fc4-8464-cb908477bf30,Altenwerth646
4bb5da36-76c1-4ec3-a9bb-7e762876cbed,Adams676
662cdb73-45e2-4d68-8a30-0d43446b9f08,Altenwerth646
894eccb0-14f1-4b42-bb73-989592de65e8,Anderson154
Query:
SELECT c.`subject.reference` AS patient_reference, COUNT(*) AS condition_count
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.`subject.reference`
LIMIT 100;
Answer:
400 Name subject.reference not found inside c at [1:10]; reason: invalidQuery, location: query, message: Name subject.reference not found inside c at [1:10]

Location: US
Job ID: d9c2ba0a-0e36-4908-b35a-565528118884
Query:
SELECT c.`subject.reference` AS patient_reference
FROM `bigquery-public-data.fhir_synthea.condition` c
GROUP BY c.`subject.reference`
HAVING COUNT(*) = 1
LIMIT 100;
Answer:
400 Name subject.reference not found inside c at [1:10]; reason: invalidQuery, location: query, message: Name subject.reference not found inside c at [1:10]

Location: US
Job ID: e3b49b5c-28f4-4016-ae90-82dc88a3fc02
Query:
SELECT c.id AS condition_id, coding.code AS condition_code, coding.display AS condition_name
FROM `bigquery-public-data.fhir_synthea.condition` c,
UNNEST(c.code.coding) AS coding
LIMIT 100;
Answer:
condition_id,condition_code,condition_name
7c249213-3ea8-49b7-8e5e-a0fd0c8ffe93,1734006,Fracture of the vertebral column with spinal cord injury
33b0d2db-f403-43b3-820b-8838d0eebc7a,1734006,Fracture of the vertebral column with spinal cord injury
1ae511ec-c9b2-48e0-a5a8-763c72b75db5,1734006,Fracture of the vertebral column with spinal cord injury
bcc2fbd9-94b1-4ad1-9ed5-6feb734a4b07,1734006,Fracture of the vertebral column with spinal cord injury
6d59d9d0-6cb7-4f77-8e07-62dfd6358f06,1734006,Fracture of the vertebral column with spinal cord injury
e656df2b-3e3c-455b-b90f-2e76a488fe78,1734006,Fracture of the vertebral column with spinal cord injury
19548a9f-aad1-4b6a-afe6-bffa9d9ae5d0,1734006,Fracture of the vertebral column with spinal cord injury
822f9079-162c-4316-9a93-48ffc50d0d95,1734006,Fracture of the vertebral column with spinal cord injury
b0ed95c1-fff1-4186-8e4b-dac7b8ae35b7,1734006,Fracture of the vertebral column with spinal cord injury
ba394dd4-c1d9-44a5-b1ee-ff7bc86faa1e,1734006,Fracture of the vertebral column with spinal cord injury
966cf5b7-5297-44da-bc34-d513c3b7906e,1734006,Fracture of the vertebral column with spinal cord injury
a9865864-6b9c-4034-8b95-c680937687c9,1734006,Fracture of the vertebral column with spinal cord injury
9e0eb2ee-8d32-4cf8-8351-d264416bd1b5,1734006,Fracture of the vertebral column with spinal cord injury
ed9e1015-29fe-432d-a057-f9322f2c74fc,1734006,Fracture of the vertebral column with spinal cord injury
52b07731-cdcd-4bff-b085-5b52fe7fe1fe,1734006,Fracture of the vertebral column with spinal cord injury
436bd893-609a-4fa4-a64c-b962449c0ba2,1734006,Fracture of the vertebral column with spinal cord injury
3c34c57e-4497-4c0f-8fe6-5e5c18308aae,1734006,Fracture of the vertebral column with spinal cord injury
2da54a05-7d57-4245-ae1f-ea3b07c9d296,1734006,Fracture of the vertebral column with spinal cord injury
5d947e07-59b8-4744-8029-f5917f257191,1734006,Fracture of the vertebral column with spinal cord injury
c0d4afc1-0e2f-4042-a2ac-23aca316f900,1734006,Fracture of the vertebral column with spinal cord injury
ea8cdf09-64a7-4714-99e0-c3c379348691,1734006,Fracture of the vertebral column with spinal cord injury
46620e73-5db6-4b00-848a-f2751b43c361,1734006,Fracture of the vertebral column with spinal cord injury
2151378e-0735-41fd-93b6-3960022a7736,1734006,Fracture of the vertebral column with spinal cord injury
eb802576-b5e3-4dd3-a4f6-81bbbd7721f0,1734006,Fracture of the vertebral column with spinal cord injury
88cf7e1f-aa28-4fc8-aa7b-60da50c0a833,1734006,Fracture of the vertebral column with spinal cord injury
f165026e-74d4-420b-ad39-05d88c163b89,1734006,Fracture of the vertebral column with spinal cord injury
3d83d9f0-eb03-478f-931a-d2b34c2a0111,1734006,Fracture of the vertebral column with spinal cord injury
df37b95f-1329-42d5-955a-48905ee2a17f,5602001,Opioid abuse (disorder)
04b40727-8410-41d3-8a61-f2e6e7437e25,5602001,Opioid abuse (disorder)
7197914b-a2ae-4fe1-b6de-0b3e260c5d5c,5602001,Opioid abuse (disorder)
33bc953c-4bc5-44e5-b4fa-a41361522e7b,5602001,Opioid abuse (disorder)
ca4919df-80c8-4114-b4f8-d2332abbe7d1,5602001,Opioid abuse (disorder)
Query:
SELECT mr.id AS medication_request_id, mr.`subject.reference` AS patient_reference, med_coding.code AS medication_code
FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
UNNEST(mr.medication.codeableConcept.coding) AS med_coding
LIMIT 100;
Answer:
400 Name subject.reference not found inside mr at [1:43]; reason: invalidQuery, location: query, message: Name subject.reference not found inside mr at [1:43]

Location: US
Job ID: df9c375d-6a8c-495f-ad64-742c94bd4323
Query:
SELECT mr.`subject.reference` AS patient_reference, COUNT(DISTINCT med_coding.code) AS medication_count
FROM `bigquery-public-data.fhir_synthea.medication_request` mr,
UNNEST(mr.medication.codeableConcept.coding) AS med_coding
GROUP BY mr.`subject.reference`
LIMIT 100;
Answer:
400 Name subject.reference not found inside mr at [1:11]; reason: invalidQuery, location: query, message: Name subject.reference not found inside mr at [1:11]

Location: US
Job ID: d82643b5-7ef9-4016-8c0a-d1e9deaf7071
Query:
SELECT p.id AS patient_id
FROM `bigquery-public-data.fhir_synthea.patient` p,
UNNEST(p.name) AS n
WHERE p.deceased.boolean IS NOT TRUE
  AND LOWER(n.family) LIKE 'a%'
  AND (
        SELECT COUNT(*)
        FROM `bigquery-public-data.fhir_synthea.condition` c
        WHERE c.`subject.reference` = CONCAT('Patient/', p.id)
      ) = 1
LIMIT 100;
Answer:
400 Name subject.reference not found inside c at [9:17]; reason: invalidQuery, location: query, message: Name subject.reference not found inside c at [9:17]

Location: US
Job ID: 31fe760c-e103-4af0-90b8-4da124776b87
End Exploring Related Columns
Task: Could you find out which health conditions have the most types of medications per case, for living patients whose last names start with 'A' and have only one unique condition? I'd like to see the top eight conditions and their codes, ranked by the highest number of different meds prescribed to any single patient.

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: Here are the top eight conditions and their codes, ranked by the highest number of different medications prescribed to any single patient, for living patients whose last names start with 'A' and have only one unique condition.

```csv
Condition_Name,Condition_Code,Max_Number_of_Different_Meds_Prescribed
condition_name1:str,condition_code1:str,num1:int
condition_name2:str,condition_code2:str,num2:int
condition_name3:str,condition_code3:str,num3:int
condition_name4:str,condition_code4:str,num4:int
condition_name5:str,condition_code5:str,num5:int
condition_name6:str,condition_code6:str,num6:int
condition_name7:str,condition_code7:str,num7:int
condition_name8:str,condition_code8:str,num8:int
(Attention: answer in eight rows)
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'fhir_synthea': ['allergy_intolerance', 'basic', 'care_plan', 'claim', 'condition', 'diagnostic_report', 'encounter', 'explanation_of_benefit', 'goal', 'imaging_study', 'immunization', 'medication_request', 'observation', 'organization', 'patient', 'practitioner', 'procedure']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-26 20:31:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:31:17 - root - INFO - ```sql
WITH patients_meeting_criteria AS (
  SELECT p.id AS patient_id
  FROM `bigquery-public-data.fhir_synthea.patient` p
  JOIN UNNEST(p.name) AS n
  WHERE p.deceased.boolean IS NOT TRUE
    AND LOWER(n.family) LIKE 'a%'
    AND (
      SELECT COUNT(*)
      FROM `bigquery-public-data.fhir_synthea.condition` c
      WHERE c.subject.patientId = p.id
    ) = 1
),

patient_medication_counts AS (
  SELECT p.patient_id, COUNT(DISTINCT med_coding.code) AS medication_count
  FROM patients_meeting_criteria p
  LEFT JOIN `bigquery-public-data.fhir_synthea.medication_request` mr
    ON mr.subject.patientId = p.patient_id
  LEFT JOIN UNNEST(mr.medication.codeableConcept.coding) AS med_coding
  GROUP BY p.patient_id
),

patient_conditions AS (
  SELECT p.patient_id, coding.code AS condition_code, coding.display AS condition_name
  FROM patients_meeting_criteria p
  JOIN `bigquery-public-data.fhir_synthea.condition` c
    ON c.subject.patientId = p.patient_id
  JOIN UNNEST(c.code.coding) AS coding
)

SELECT
  pc.condition_name AS Condition_Name,
  pc.condition_code AS Condition_Code,
  MAX(pm.medication_count) AS Max_Number_of_Different_Meds_Prescribed
FROM patient_conditions pc
JOIN patient_medication_counts pm
  ON pc.patient_id = pm.patient_id
GROUP BY pc.condition_name, pc.condition_code
ORDER BY Max_Number_of_Different_Meds_Prescribed DESC
LIMIT 8
```
2025-01-26 20:31:21 - root - INFO - itercount: 1
2025-01-26 20:31:21 - root - INFO - 0
2025-01-26 20:31:21 - root - INFO - results: 
Condition_Name,Condition_Code,Max_Number_of_Different_Meds_Prescribed
Acute bronchitis (disorder),10509002,7
Viral sinusitis (disorder),444814009,6
Acute viral pharyngitis (disorder),195662009,6
Perennial allergic rhinitis,446096008,6
Sprain of ankle,44465007,6
Impacted molars,196416002,5
Normal pregnancy,72892002,5
Hypertension,38341003,5


2025-01-26 20:31:21 - root - INFO - Please check the answer again by reviewing Could you find out which health conditions have the most types of medications per case, for living patients whose last names start with 'A' and have only one unique condition? I'd like to see the top eight conditions and their codes, ranked by the highest number of different meds prescribed to any single patient., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: Here are the top eight conditions and their codes, ranked by the highest number of different medications prescribed to any single patient, for living patients whose last names start with 'A' and have only one unique condition.

```csv
Condition_Name,Condition_Code,Max_Number_of_Different_Meds_Prescribed
condition_name1:str,condition_code1:str,num1:int
condition_name2:str,condition_code2:str,num2:int
condition_name3:str,condition_code3:str,num3:int
condition_name4:str,condition_code4:str,num4:int
condition_name5:str,condition_code5:str,num5:int
condition_name6:str,condition_code6:str,num6:int
condition_name7:str,condition_code7:str,num7:int
condition_name8:str,condition_code8:str,num8:int
(Attention: answer in eight rows)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Condition_Name,Condition_Code,Max_Number_of_Different_Meds_Prescribed
Acute bronchitis (disorder),10509002,7
Viral sinusitis (disorder),444814009,6
Acute viral pharyngitis (disorder),195662009,6
Perennial allergic rhinitis,446096008,6
Sprain of ankle,44465007,6
Impacted molars,196416002,5
Normal pregnancy,72892002,5
Hypertension,38341003,5
Current sql:
WITH patients_meeting_criteria AS (
  SELECT p.id AS patient_id
  FROM `bigquery-public-data.fhir_synthea.patient` p
  JOIN UNNEST(p.name) AS n
  WHERE p.deceased.boolean IS NOT TRUE
    AND LOWER(n.family) LIKE 'a%'
    AND (
      SELECT COUNT(*)
      FROM `bigquery-public-data.fhir_synthea.condition` c
      WHERE c.subject.patientId = p.id
    ) = 1
),

patient_medication_counts AS (
  SELECT p.patient_id, COUNT(DISTINCT med_coding.code) AS medication_count
  FROM patients_meeting_criteria p
  LEFT JOIN `bigquery-public-data.fhir_synthea.medication_request` mr
    ON mr.subject.patientId = p.patient_id
  LEFT JOIN UNNEST(mr.medication.codeableConcept.coding) AS med_coding
  GROUP BY p.patient_id
),

patient_conditions AS (
  SELECT p.patient_id, coding.code AS condition_code, coding.display AS condition_name
  FROM patients_meeting_criteria p
  JOIN `bigquery-public-data.fhir_synthea.condition` c
    ON c.subject.patientId = p.patient_id
  JOIN UNNEST(c.code.coding) AS coding
)

SELECT
  pc.condition_name AS Condition_Name,
  pc.condition_code AS Condition_Code,
  MAX(pm.medication_count) AS Max_Number_of_Different_Meds_Prescribed
FROM patient_conditions pc
JOIN patient_medication_counts pm
  ON pc.patient_id = pm.patient_id
GROUP BY pc.condition_name, pc.condition_code
ORDER BY Max_Number_of_Different_Meds_Prescribed DESC
LIMIT 8
2025-01-26 20:32:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 20:32:14 - root - INFO - Here are the top eight conditions and their codes, ranked by the highest number of different medications prescribed to any single patient, for living patients whose last names start with 'A' and have only one unique condition.

```csv
Condition_Name,Condition_Code,Max_Number_of_Different_Meds_Prescribed
Acute bronchitis (disorder),10509002,7
Viral sinusitis (disorder),444814009,6
Acute viral pharyngitis (disorder),195662009,6
Perennial allergic rhinitis,446096008,6
Sprain of ankle,44465007,6
Impacted molars,196416002,5
Normal pregnancy,72892002,5
Hypertension,38341003,5
```

```sql
WITH patients_meeting_criteria AS (
  SELECT p.id AS patient_id
  FROM `bigquery-public-data.fhir_synthea.patient` p
  JOIN UNNEST(p.name) AS n
  WHERE p.deceased.boolean IS NOT TRUE
    AND LOWER(n.family) LIKE 'a%'
    AND (
      SELECT COUNT(*)
      FROM `bigquery-public-data.fhir_synthea.condition` c
      WHERE c.subject.patientId = p.id
    ) = 1
),

patient_medication_counts AS (
  SELECT p.patient_id, COUNT(DISTINCT med_coding.code) AS medication_count
  FROM patients_meeting_criteria p
  LEFT JOIN `bigquery-public-data.fhir_synthea.medication_request` mr
    ON mr.subject.patientId = p.patient_id
  LEFT JOIN UNNEST(mr.medication.codeableConcept.coding) AS med_coding
  GROUP BY p.patient_id
),

patient_conditions AS (
  SELECT p.patient_id, coding.code AS condition_code, coding.display AS condition_name
  FROM patients_meeting_criteria p
  JOIN `bigquery-public-data.fhir_synthea.condition` c
    ON c.subject.patientId = p.patient_id
  JOIN UNNEST(c.code.coding) AS coding
)

SELECT
  pc.condition_name AS Condition_Name,
  pc.condition_code AS Condition_Code,
  MAX(pm.medication_count) AS Max_Number_of_Different_Meds_Prescribed
FROM patient_conditions pc
JOIN patient_medication_counts pm
  ON pc.patient_id = pm.patient_id
GROUP BY pc.condition_name, pc.condition_code
ORDER BY Max_Number_of_Different_Meds_Prescribed DESC
LIMIT 8
```
2025-01-26 20:32:15 - root - INFO - itercount: 2
2025-01-26 20:32:15 - root - INFO - 0
2025-01-26 20:32:15 - root - INFO - Total iteration counts: 2
