2025-01-25 10:25:23 - openai._base_client - INFO - Retrying request to /chat/completions in 0.399104 seconds
2025-01-25 10:26:26 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:26:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:26:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:26:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:26:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:26:27 - snowflake.connector.connection - INFO - closed
2025-01-25 10:26:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:26:28 - root - INFO - SQL:
-- Query 1: List distinct assignee names in the PUBLICATIONS table
SELECT DISTINCT assignee.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."assignee_harmonized") assignee
LIMIT 100;
Results:
assignee_name
ACE BEDS CO LTD
FEDELI GIANCARLO
XIAOYING ZHAO
RONGHUA SUN
SERVIER LAB
ETA SRL
ODED MIRETZKY
MAGNETI MARELLI SPA
EXXON RESEARCH ENGINEERING CO
HOERR LOUIS A
PNEUMATIC SURGICAL APPLIANCE COMPANY
NINGGUO RUIPU SEALS CO LTD
XIAMEN BRANCH ZHONGSHAN HOSPITAL FUDAN UNIV
Shanghai hesheng machinery co ltd
DONGGUAN POLYMERS NEW MATERIAL TECH CO LTD
HOWELL THOMAS A
SHIM JAE J
MEGURO TAKESHI
ARNEY SHANE R
UBE MAT IND LTD
NICHIA CORP
ST MICROELECTRONICS ROUSSET
ZIMMER INC
SCINTOMICS GMBH
SUBARU CORP
HEFEI CAS LANRUI TECH CO LTD
BEXSON BIOMEDICAL INC
CRNOGORAC FERDO
CONTITECH VIBRATION CONTROL GMBH
ERWIN KOPPE OFEN UND HERDFABRI
Helicopterflug Großer GmbH
WEIR MINERALS AUSTRALIA LTD
OOO NI SKIJ I ATEROSKLER
KRAFT FOODS R & D INC
TAIWAN SEMICONDUCTOR MFG
GOTFRIED YECHIEL
VIVANT MEDICAL INC
CANON STAAR CO INC
KROPPE WILLIAM J
SURFACE SPECIALTIES AUSTRIA
HAMMONDS CARL L
ADDISON CLEAR WAVE LLC
HEWLETT PACKARD DEVELOPMENT CO LP
FWP IP APS
XU YINGQI
PANASONIC ECO SYS GUANGDONG CO
HOBOT TECH INC
TORBJORN AFDAL
HENRY DREYFUS
CHARMGLOW PRODUCTS INC
GE HEALTHCARE AS
KIOXIA CORP
STIERLEN MAQUET AG
ROOTPATH GENOMICS INC
PREC BIOSCIENCES INC
STANLEY WORKS LTD
CAMURUS AB
WWT SPOLKA Z OGRANICZONA ODPOWIEDZIALNOSCIA
EISEN EIKO
HESTAN COMMERCIAL CORP
SHADECRAFT INC
SONOS INC
NOVALEAD PHARMA INC
ARKRAY INC
ROCKWOOL INT
CHR HANSEN AS
RATHIN BHATTACHARJEE
LIBERTY NAT BANK AND TRUST COM
HAVERSTICK GEORGE W
MOBIPAYPOINT LTD
RIJK ZWAAN ZAADTEELT EN ZAADHANDEL BV
PROEKTNO IZYSKATELSKIJ NII GID
VB AUTOBATTERIE GMBH
AGRUPADA INVEST OFF
KLAESSIG OSKAR PAUL
FIRM OF OTTO URBAN
BAKONY FEM ES ELECTROMOSKESZULEK MUVEK
JOHNSON MARK T
ROCHE DIAGNOSTICS OPERATIONS INC
UNIV MASSACHUSETTS
ROSEMAN BRUCE
UNIV WICHITA STATE
AEGION COATING SERVICES LLC
COLE MAURY D
WALTERS SARA
FISHER CONTROLS INT
CHOI SANG-JUN
ABRAHAM FRANK
SKYLINE BIOMEDICAL INC
WAKAMONO joint stock company
P P H POLMAR” DIONIZY SZCZERBA
WIRTGEN GMBH
SHANGHAI KOHLER ELECTRONICS
TROUP JOHN H
KOTZIN
WILLIAM SCHEPLER
JOHNSON RES CORP
KIMBERLY CLARK CO
AJINOMOTO KK
PORMEDTEC CO LTD

2025-01-25 10:26:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:26:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:26:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:26:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:26:29 - snowflake.connector.connection - INFO - closed
2025-01-25 10:26:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:26:30 - root - INFO - SQL:
-- Query 2: Find patents assigned to DENSO CORP
SELECT t."publication_number", assignee.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."assignee_harmonized") assignee
WHERE assignee.value:"name"::STRING ILIKE '%DENSO CORP%'
LIMIT 100;
Results:
publication_number,assignee_name
US-2023394418-A1,DENSO CORP
DE-10129321-A1,DENSO CORP
DE-102011004946-A1,DENSO CORP
US-2023207423-A1,DENSO CORP
WO-2021199555-A1,DENSO CORP
US-2004178870-A1,DENSO CORP
US-2006152215-A1,DENSO CORP
US-2008082260-A1,DENSO CORP
US-2008227599-A1,DENSO CORP
US-2005011063-A1,DENSO CORP JAPAN
US-2005099251-A1,DENSO CORP
WO-2019039129-A1,DENSO CORP
WO-2020250719-A1,DENSO CORP
WO-2024162212-A1,DENSO CORP
EP-1703109-A2,DENSO CORP
US-2007085197-A1,DENSO CORP
US-2008015772-A1,DENSO CORP
DE-102007000293-B4,DENSO CORP
US-2015131232-A1,DENSO CORP
US-2018013266-A1,DENSO CORP
US-2007044473-A1,DENSO CORP
US-10790774-B2,DENSO CORP
US-10674314-B2,DENSO CORP
US-2007246361-A1,DENSO CORP
US-11639192-B2,DENSO CORP
DE-102008003948-B4,DENSO CORP
DE-102011055563-B4,DENSO CORP
DE-112016001259-B4,DENSO CORP
US-2003122645-A1,DENSO CORP
US-2009266335-A1,DENSO CORP
US-2007200067-A1,DENSO CORP
WO-2022264738-A1,DENSO CORP
DE-102005051791-A1,DENSO CORP
DE-102007024898-A1,DENSO CORP
DE-102019101566-A1,DENSO CORP
US-2019386508-A1,DENSO CORP
US-2024204505-A1,DENSO CORP
EP-3694087-B1,DENSO CORP
US-10872603-B2,DENSO CORP
EP-1533154-A1,DENSO CORP
WO-2023054546-A1,DENSO CORP
DE-102012206067-B4,DENSO CORP
DE-102009000817-A1,DENSO CORP
US-2019092325-A1,DENSO CORP
US-2009082909-A1,DENSO CORP
US-2019152298-A1,DENSO CORP
US-2021017924-A1,DENSO CORP
US-2021041508-A1,DENSO CORP
US-2003127934-A1,DENSO CORP
US-2006006756-A1,DENSO CORP
US-2022402829-A1,DENSO CORP
EP-4108567-A1,DENSO CORP
US-10838052-B2,DENSO CORP
US-12049179-B2,DENSO CORP
US-2021261142-A1,DENSO CORP
US-2021325116-A1,DENSO CORP
US-2022028029-A1,DENSO CORP
US-2022190113-A1,DENSO CORP
WO-2016121380-A1,DENSO CORP
WO-2017163620-A1,DENSO CORP
WO-2021187040-A1,DENSO CORP
US-2021010842-A1,DENSO CORP
US-2020361416-A1,DENSO CORP
US-2007289384-A1,DENSO CORP
US-7568400-B2,DENSO CORP
WO-2020004161-A1,DENSO CORP
WO-2021033757-A1,DENSO CORP
DE-102014209298-B4,DENSO CORP
DE-102006000312-B4,DENSO CORP
DE-102013101681-B4,DENSO CORP
US-6178292-B1,DENSO CORP
US-6989627-B2,DENSO CORP
US-7980219-B2,DENSO CORP
US-8676437-B2,DENSO CORP
US-2010158316-A1,DENSO CORP
US-2012046808-A1,DENSO CORP
US-7397287-B2,DENSO CORP
DE-102009004384-A1,DENSO CORP
DE-102013105851-A1,DENSO CORP
DE-102021120645-A1,DENSO CORP
JP-2004191321-A,DENSO CORP
DE-69911567-T9,DENSO CORP
US-2005046395-A1,DENSO CORP
US-2005209755-A1,DENSO CORP
US-2006057953-A1,DENSO CORP
DE-112022002330-T5,DENSO CORP
JP-2005069878-A,DENSO CORP
JP-2006029279-A,DENSO CORP
JP-2009024674-A,DENSO CORP
JP-2010199436-A,DENSO CORP
JP-2010230654-A,DENSO CORP
JP-2015130098-A,DENSO CORP
JP-2017100226-A,DENSO CORP
JP-2017149346-A,DENSO CORP
JP-2019066047-A,DENSO CORP
US-2006090736-A1,DENSO CORP
US-2017352950-A1,DENSO CORP
US-2018050307-A1,DENSO CORP
US-2018006520-A1,DENSO CORP
US-7833876-B2,DENSO CORP

2025-01-25 10:26:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:26:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:26:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:26:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:26:31 - snowflake.connector.connection - INFO - closed
2025-01-25 10:26:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:26:31 - root - INFO - SQL:
-- Query 3: Explore the structure of the "citation" field
SELECT t."publication_number", citation.value AS "citation_value"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."citation") citation
LIMIT 100;
Results:
Too long, hard cut:
publication_number,citation_value
IT-MI20100845-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-1654188-A"",
  ""type"": ""YA""
}"
IT-MI20100845-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2506292-A"",
  ""type"": ""XY""
}"
IT-MI20100845-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-4307918-A1"",
  ""type"": ""A""
}"
IT-MI20100845-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-19810417-A1"",
  ""type"": ""X""
}"
IT-MI20100845-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""WO-2008068591-A2"",
  ""type"": ""AD""
}"
IT-VI20090183-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""CH-326215-A"",
  ""type"": ""Y""
}"
IT-VI20090183-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-5134380-A"",
  ""type"": ""A""
}"
IT-VI20090183-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-5216409-A"",
  ""type"": ""XY""
}"
IT-VI20090183-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-5736637-A"",
  ""type"": ""Y""
}"
IT-VI20090183-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""EP-1411348-A1"",
  ""type"": ""A""
}"
IT-TO20100206-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-1580149-A1"",
  ""type"": ""X""
}"
IT-TO20100206-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-10252996-A1"",
  ""type"": ""X""
}"
IT-TO20100206-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""FR-2865440-A1"",
  ""type"": ""X""
}"
IT-TO20100206-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-102004046678-A1"",
  ""type"": ""X""
}"
IT-TO20100206-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""FR-2895705-A1"",
  ""type"": ""X""
}"
IT-PZ20150004-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": ""ANGELO BRACALELLO ET AL: \""Design and Production of a Chimeric Resilin-, Elastin-, and Collagen-Like Engineered Polypeptide\"", BIOMACROMOLECULES, vol. 12, no. 8, 8 August 2011 (2011-08-08), US, pages 2957 - 2965, XP055236188, ISSN: 1525-7797, DOI: 10.1021/bm2005388"",
  ""publication_number"": """",
  ""type"": ""I""
}"
IT-PZ20150004-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": ""LINQING LI ET AL: \""Resilin-Based Materials for Biomedical Applications\"", ACS MACRO LETTERS / AMERICAN CHEMICAL SOCIETY, vol. 2, no. 8, 20 August 2013 (2013-08-20), Washington, US, pages 635 - 640, XP055236178, ISSN: 2161-1653, DOI: 10.1021/mz4002194"",
  ""publication_number"": """",
  ""type"": ""A""
}"
IT-PZ20150004-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": ""LINQING LI ET AL: \""Tunable Mechanical Stability and Deformation Response of a Resilin-Based Elastomer\"", BIOMACROMOLECULES, vol. 12, no. 6, 10 May 2011 (2011-05-10), US, pages 2302 - 2310, XP055235959, ISSN: 1525-7797, DOI: 10.1021/bm200373p"",
  ""publication_number"": """",
  ""type"": ""A""
}"
IT-PZ20150004-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": ""MARICA MARTINO ET AL: \""Biopolymers and biomaterials based on elastomeric proteins\"", MACROMOLECULAR BIOSCIENCE, vol. 2, no. 7, 1 October 2002 (2002-10-01), pages 319 - 328, XP055235941, ISSN: 1616-5187, DOI: 10.1002/1616-5195(200209)2:7<319::AID-MABI319>3.0.CO;2-L"",
  ""publication_number"": """",
  ""type"": ""A""
}"
IT-PZ20150004-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": ""SBRANA F ET AL: \""Multiscale characterization of a chimeric biomimetic polypeptide for stem cell culture\"", BIOINSPIRATION & BIOMIMETICS, INSTITUTE OF PHYSICS PUBLISHING, BRISTOL, GB, vol. 7, no. 4, 24 August 2012 (2012-08-24), pages 46007, XP020235921, ISSN: 1748-3190, DOI: 10.1088/1748-3182/7/4/046007"",


2025-01-25 10:26:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:26:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:26:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:26:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:26:34 - snowflake.connector.connection - INFO - closed
2025-01-25 10:26:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:26:34 - root - INFO - SQL:
-- Query 4: List patents and their citations
SELECT t."publication_number" AS "citing_patent_number",
       cited.value:"publication_number"::STRING AS "cited_publication_number"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."citation") cited
LIMIT 100;
Results:
citing_patent_number,cited_publication_number
IT-MI20100845-A1,US-1654188-A
IT-MI20100845-A1,US-2506292-A
IT-MI20100845-A1,DE-4307918-A1
IT-MI20100845-A1,DE-19810417-A1
IT-MI20100845-A1,WO-2008068591-A2
IT-VI20090183-A1,CH-326215-A
IT-VI20090183-A1,US-5134380-A
IT-VI20090183-A1,US-5216409-A
IT-VI20090183-A1,US-5736637-A
IT-VI20090183-A1,EP-1411348-A1
IT-TO20100206-A1,DE-1580149-A1
IT-TO20100206-A1,DE-10252996-A1
IT-TO20100206-A1,FR-2865440-A1
IT-TO20100206-A1,DE-102004046678-A1
IT-TO20100206-A1,FR-2895705-A1
IT-PZ20150004-A1,
IT-PZ20150004-A1,
IT-PZ20150004-A1,
IT-PZ20150004-A1,
IT-PZ20150004-A1,
IT-UA20161603-A1,AU-551882-B2
IT-UA20161603-A1,EP-1881576-A1
IT-UA20161603-A1,GB-2465609-A
IT-UA20161603-A1,US-2013029541-A1
IT-UA20161603-A1,DE-102013101120-A1
IT-UA20161603-A1,US-2015200530-A1
IT-BO20080517-A1,DE-3030931-A1
IT-BO20080517-A1,US-5467567-A
IT-BO20080517-A1,US-5572847-A
IT-BO20080517-A1,EP-0744497-A1
IT-BO20080517-A1,DE-19732904-A1
IT-BO20080517-A1,EP-1072726-A1
IT-BO20080731-A1,FR-2781409-A1
IT-BO20080731-A1,US-2002158357-A1
IT-UB20160960-A1,US-6481795-B1
IT-UB20160960-A1,US-2009230743-A1
IT-UB20160960-A1,EP-2653196-A2
IT-UB20160960-A1,WO-2014085732-A1
IT-TO20090280-A1,DE-1238299-B
IT-TO20090280-A1,US-3358522-A
IT-TO20090280-A1,US-5083984-A
IT-TO20090280-A1,US-5277667-A
IT-TO20090280-A1,GB-2348262-A
IT-UB20160584-A1,US-668479-A
IT-UB20160584-A1,US-968952-A
IT-UB20160584-A1,US-1043743-A
IT-UB20160584-A1,US-1305661-A
IT-MI20101275-A1,DE-1034672-B
IT-MI20101275-A1,US-3630639-A
IT-MI20101275-A1,EP-0039977-A1
IT-MI20101275-A1,US-2005092392-A1
IT-MI20101275-A1,DE-10362075-A1
IT-MI20101275-A1,WO-2010028852-A2
IT-VA20090003-A1,EP-0737566-A1
IT-VA20090003-A1,WO-0043272-A1
IT-VA20090003-A1,WO-2004087527-A1
IT-VA20090003-A1,EP-1619137-A1
IT-VA20090003-A1,WO-2008086388-A1
IT-VA20090003-A1,DE-202008009634-U1
IT-RM20080370-A1,US-3406618-A
IT-RM20080370-A1,US-4131406-A
IT-RM20080370-A1,US-4231677-A
IT-RM20080370-A1,US-5033906-A
IT-RM20080370-A1,WO-0066857-A1
IT-RM20080370-A1,US-6595768-B1
IT-TV20130044-A1,US-5144899-A
IT-TV20130044-A1,JP-H05272046-A
IT-TV20130044-A1,WO-2004058415-A1
IT-TV20130044-A1,US-2004221780-A1
IT-TV20130044-A1,US-2005178309-A1
IT-TV20130044-A1,US-6957614-B1
IT-TV20130044-A1,US-2011297062-A1
IT-MI20091791-A1,WO-9822370-A1
IT-MI20091791-A1,US-6182823-B1
IT-MI20091791-A1,JP-2002059987-A
IT-MI20091791-A1,WO-0221531-A1
IT-MI20091791-A1,JP-2002345740-A
IT-MI20091791-A1,DE-20216034-U1
IT-MI20091791-A1,JP-2004352365-A
IT-MI20091791-A1,DE-10323914-A1
IT-MI20091791-A1,JP-2007112473-A
IT-MI20091791-A1,US-2008135430-A1
IT-UB20160009-A1,US-4168924-A
IT-UB20160009-A1,US-4288956-A
IT-UB20160009-A1,EP-0059466-A1
IT-UB20160009-A1,DE-3102120-A1
IT-UB20160009-A1,DE-3445187-A1
IT-UB20160009-A1,WO-9316247-A1
AT-514400-A1,DE-10149649-A1
AT-514400-A1,WO-2011024177-A1
CH-712732-A1,EP-0507299-A2
CH-712732-A1,US-5640508-A
CH-712732-A1,US-2004199817-A1
CH-712732-A1,US-2010287421-A1
CH-712732-A1,
FR-2894722-A1,GB-1247790-A
FR-2894722-A1,EP-0059939-A1
FR-2894722-A1,DE-3413740-A1
FR-2894722-A1,EP-0802580-A1
FR-2894722-A1,WO-03005491-A1

2025-01-25 10:26:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:26:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:26:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:26:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-25 10:26:35 - snowflake.connector.connection - INFO - closed
2025-01-25 10:26:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:27:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:27:25 - root - INFO - ```sql
SELECT citing_assignee.value:"name"::STRING AS "Assignee",
       cpc_def."titleFull" AS "CPC_Subclass_Title",
       COUNT(*) AS "Citation_Count"
FROM PATENTS.PATENTS.PUBLICATIONS t
LATERAL FLATTEN(input => t."assignee_harmonized") citing_assignee,
LATERAL FLATTEN(input => t."cpc") cpc_code,
LATERAL FLATTEN(input => t."citation") cited,
PATENTS.PATENTS.CPC_DEFINITION cpc_def
WHERE citing_assignee.value:"name"::STRING NOT ILIKE '%DENSO%'
  AND cpc_def."symbol" = SUBSTR(cpc_code.value:"code"::STRING, 1, 4)
  AND cited.value:"publication_number"::STRING IN (
    SELECT DISTINCT denso_patent."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS denso_patent
    LATERAL FLATTEN(input => denso_patent."assignee_harmonized") denso_assignee
    WHERE denso_assignee.value:"name"::STRING ILIKE '%DENSO%'
  )
GROUP BY citing_assignee.value:"name"::STRING, cpc_def."titleFull"
LIMIT 100;
```
2025-01-25 10:27:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:27:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:27:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:27:27 - snowflake.connector.connection - INFO - closed
2025-01-25 10:27:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:28:18 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:28:18 - root - INFO - ```sql
SELECT
    citing_assignee.value:"name"::STRING AS "Assignee",
    cpc_def."titleFull" AS "CPC_Subclass_Title",
    COUNT(*) AS "Citation_Count"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."assignee_harmonized") AS citing_assignee
CROSS JOIN LATERAL FLATTEN(input => t."cpc") AS cpc_code
CROSS JOIN LATERAL FLATTEN(input => t."citation") AS cited
JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_def ON cpc_def."symbol" = SUBSTR(cpc_code.value:"code"::STRING, 1, 4)
WHERE citing_assignee.value:"name"::STRING NOT ILIKE '%DENSO%'
  AND cited.value:"publication_number"::STRING IN (
    SELECT denso_patent."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS denso_patent
    CROSS JOIN LATERAL FLATTEN(input => denso_patent."assignee_harmonized") AS denso_assignee
    WHERE denso_assignee.value:"name"::STRING ILIKE '%DENSO%'
)
GROUP BY citing_assignee.value:"name"::STRING, cpc_def."titleFull"
LIMIT 100;
```
2025-01-25 10:28:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:28:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:28:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:31:40 - snowflake.connector.connection - INFO - closed
2025-01-25 10:31:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:32:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:32:33 - root - INFO - To address the timeout issue with your query, we need to optimize it to reduce the amount of data being processed. The original query scans the entire `PUBLICATIONS` table and flattens the `"citation"` field for every record, which is resource-intensive and can lead to timeouts.

Here's an optimized version of your query that uses the `EXISTS` clause to check for the presence of the specific cited publication without flattening the entire `"citation"` array for all records:

```sql
SELECT
    t."publication_number" AS "citing_patent_number",
    'US1234567' AS "cited_publication_number"
FROM
    PATENTS.PATENTS.PUBLICATIONS t
WHERE
    EXISTS (
        SELECT 1
        FROM TABLE(FLATTEN(INPUT => t."citation")) AS f
        WHERE f.value:"publication_number"::STRING = 'US1234567'
    )
LIMIT 100;
```

**Explanation:**

- **Use of `EXISTS`:** The `EXISTS` clause efficiently checks each patent to see if its `"citation"` array contains the specified publication number `'US1234567'` without unnecessarily flattening all records.
- **Avoids Full Table Flattening:** By evaluating the `"citation"` field on a per-record basis, we significantly reduce the amount of data processed, which helps prevent the timeout.
- **Specifying the Cited Publication Number:** Replace `'US1234567'` with the actual publication number of the DENSO CORP patent you're interested in.

**Additional Steps to Prevent Timeout:**

1. **Increase the Warehouse Size or Timeout Setting:** If possible, allocate more resources to your query by increasing the size of the virtual warehouse or adjusting the timeout settings.

2. **Add Additional Filters:** If you have information about the publication dates or other attributes of the citing patents, include additional `WHERE` conditions to narrow down the dataset. For example, filter by publication date:

   ```sql
   WHERE
       t."publication_date" > 20150000  -- Example date filter (YYYYMMDD)
       AND EXISTS ( ... )
   ```

3. **Verify the Existence of the Publication Number:** Ensure that the publication number `'US1234567'` exists in the dataset. If it doesn't, the query might be scanning unnecessarily.

4. **Limit the Number of Records Processed:** If you expect only a small number of citing patents, you might use `SAMPLE` to process a subset:

   ```sql
   FROM
       PATENTS.PATENTS.PUBLICATIONS t SAMPLE (10 PERCENT)
   ```

**Note:**

- Make sure to replace `'US1234567'` with the actual publication number of the DENSO CORP patent you are investigating.
- The `LIMIT 100` clause will return up to 100 citing patents that cite the specified DENSO CORP patent.

By optimizing the query in this way, you reduce the computational load and help ensure that the query completes without timing out.
2025-01-25 10:32:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:32:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:32:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:32:35 - snowflake.connector.connection - INFO - closed
2025-01-25 10:32:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:32:35 - root - INFO - SQL:
SELECT
    t."publication_number" AS "citing_patent_number",
    'US1234567' AS "cited_publication_number"
FROM
    PATENTS.PATENTS.PUBLICATIONS t
WHERE
    EXISTS (
        SELECT 1
        FROM TABLE(FLATTEN(INPUT => t."citation")) AS f
        WHERE f.value:"publication_number"::STRING = 'US1234567'
    )
LIMIT 100;
Results:
000603 (XX000): 01b9f218-0004-7d15-0001-11c300fa2ef2: SQL execution internal error:
Processing aborted due to error 370001:1309815285; incident 1005725.
2025-01-25 10:32:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:32:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:32:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:32:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:32:37 - snowflake.connector.connection - INFO - closed
2025-01-25 10:32:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:32:37 - root - INFO - SQL:
-- Query 6: Extract CPC codes for patents
SELECT t."publication_number", cpc_code.value:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."cpc") cpc_code
LIMIT 100;
Results:
publication_number,cpc_code
US-2004046148-A1,C23F1/26
US-2004046148-A1,H01L21/3212
US-2004046148-A1,C23F3/06
US-2004046148-A1,H01L21/32134
US-2004046148-A1,C23F3/06
US-2004046148-A1,C09G1/02
US-2004046148-A1,H01L21/32115
US-2004046148-A1,C23F3/04
US-2004046148-A1,C23F1/18
US-2004046148-A1,C09G1/02
US-2004046148-A1,C23F3/06
US-2004046148-A1,H01L21/32115
US-2004046148-A1,H01L21/3212
US-2004046148-A1,C23F1/18
US-2004046148-A1,C23F3/04
US-2004046148-A1,H01L21/32134
US-2004249430-A1,A61N1/05
US-2004249430-A1,A61N1/05
US-2004249430-A1,A61N1/056
US-2004249430-A1,A61N1/056
US-2004254481-A1,A61B7/04
US-2004254481-A1,A61B5/318
US-2004254481-A1,A61B7/04
US-2004254481-A1,A61B5/0816
US-2004254481-A1,A61B5/0816
US-2004254481-A1,A61B5/318
US-2004179568-A1,H01S5/0421
US-2004179568-A1,H01S5/3095
US-2004179568-A1,H01S5/3072
US-2004179568-A1,H01S5/02476
US-2004179568-A1,H01S5/0217
US-2004179568-A1,H01S5/18308
US-2004179568-A1,H01S5/18375
US-2004179568-A1,H01S5/18377
US-2004179568-A1,H01S5/04253
US-2004179568-A1,H01S5/04252
US-2004179568-A1,H01S5/18369
US-2004179568-A1,H01S5/18375
US-2004179568-A1,H01S5/18369
US-2004179568-A1,H01S5/18308
US-2004179568-A1,H01S5/0217
US-2004179568-A1,H01S5/3072
US-2004179568-A1,H01S5/02476
US-2004179568-A1,H01S5/18377
US-2004179568-A1,H01S5/0421
US-2004179568-A1,H01S5/3095
US-2004179568-A1,H01S5/04253
US-2004179568-A1,H01S5/04252
US-2004179568-A1,H01S5/18375
US-2004179568-A1,H01S5/3095
US-2004179568-A1,H01S5/18377
US-2004179568-A1,H01S5/02476
US-2004179568-A1,H01S5/0217
US-2004179568-A1,H01S5/18369
US-2004179568-A1,H01S5/18308
US-2004179568-A1,H01S5/0421
US-2004179568-A1,H01S5/3072
US-2004179568-A1,H01S5/04253
US-2004250894-A1,B27L7/00
US-2004250894-A1,B27L7/005
US-2004250894-A1,B27L7/00
US-2004250894-A1,B27L7/005
US-2005110223-A1,F16J15/0825
US-2005110223-A1,F16J15/0825
US-2005031765-A1,A23L7/126
US-2005031765-A1,A23L7/115
US-2005031765-A1,A23L7/126
US-2005031765-A1,A23L7/115
US-2005012526-A1,H03F3/45748
US-2005012526-A1,H03F2203/30015
US-2005012526-A1,H03F3/45179
US-2005012526-A1,H03F3/45941
US-2005012526-A1,H03F3/45941
US-2005012526-A1,H03F2203/45681
US-2005012526-A1,H03F2203/45292
US-2005012526-A1,H03F2203/30015
US-2005012526-A1,H03F2203/45082
US-2005012526-A1,H03F2203/45008
US-2005012526-A1,H03F3/45179
US-2005012526-A1,H03F3/45748
US-2005012526-A1,H03F3/3022
US-2005012526-A1,H03F2203/45082
US-2005012526-A1,H03F2203/45292
US-2005012526-A1,H03F2203/45008
US-2005012526-A1,H03F3/3022
US-2005012526-A1,H03F2203/45681
US-2006088579-A1,A61K47/12
US-2006088579-A1,A61K9/0014
US-2006088579-A1,A61K47/12
US-2006088579-A1,A61K47/22
US-2006088579-A1,A61K47/14
US-2006088579-A1,A61K47/10
US-2006088579-A1,A61K47/06
US-2006088579-A1,A61K47/14
US-2006088579-A1,A61K9/1075
US-2006088579-A1,A61K47/22
US-2006088579-A1,A61K9/1075
US-2006088579-A1,A61K47/06
US-2006088579-A1,A61K9/0014
US-2006088579-A1,A61K47/10

2025-01-25 10:32:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:32:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:32:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:32:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:32:39 - snowflake.connector.connection - INFO - closed
2025-01-25 10:32:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:32:39 - root - INFO - SQL:
-- Query 7: Extract primary CPC codes (where "first" is true)
SELECT t."publication_number", cpc_code.value:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."cpc") cpc_code
WHERE cpc_code.value:"first"::BOOLEAN = TRUE
LIMIT 100;
Results:
publication_number,cpc_code
US-2006215095-A1,G02F1/133788
US-2006215095-A1,G02F1/133788
US-2005219871-A1,H02M1/4225
US-2005219871-A1,H02M1/4225
US-2006225070-A1,G06F8/60
US-2006225070-A1,G06F8/60
US-2006223426-A1,B24B57/02
US-2006223426-A1,B24B57/02
US-2005282283-A1,C12N15/87
US-2005282283-A1,C12N15/87
US-2005191701-A1,C12N9/1007
US-2005191701-A1,C12N9/1007
US-2006250589-A1,G03F1/36
US-2006250589-A1,G03F1/36
US-2006133105-A1,H04Q9/04
US-2006133105-A1,G08C23/04
US-2006133105-A1,G08C23/04
US-2006264190-A1,H04B1/04
US-2006264190-A1,H04B1/04
US-2006272652-A1,G16H50/50
US-2006272652-A1,G16H50/50
US-2006280400-A1,G02B5/20
US-2006280400-A1,G02B6/29365
US-2006280400-A1,G02B6/29365
US-2005244554-A1,A01K15/026
US-2005244554-A1,A01K15/026
US-2006089742-A1,G05B19/4065
US-2006089742-A1,G05B19/4065
US-2006088772-A1,G03F1/20
US-2006088772-A1,G03F1/20
US-2005236657-A1,G11C29/50
US-2005236657-A1,G11C29/50
US-2006006745-A1,H02K21/16
US-2006006745-A1,H02K21/16
US-2007010420-A1,A01N37/44
US-2007010420-A1,A23B4/20
US-2006001827-A1,G02C5/001
US-2006001827-A1,G02C5/001
US-2006019148-A1,C01G37/027
US-2006019148-A1,C01G37/027
US-2006019148-A1,H01M8/10
US-2006023399-A1,B32B18/00
US-2006023399-A1,B32B18/00
US-2006029199-A1,H04M3/53333
US-2006029199-A1,H04M3/53333
US-2005275346-A1,H05B33/04
US-2005275346-A1,H10K50/125
US-2005275346-A1,H10K50/858
US-2005274394-A1,B32B7/12
US-2005274394-A1,B32B7/12
US-2006047298-A1,A61B5/037
US-2006047298-A1,A61B5/037
US-2006049749-A1,H10K50/854
US-2006049749-A1,H05B33/22
US-2007055408-A1,H02J3/06
US-2007055408-A1,H02J3/06
US-2006057776-A1,H01L23/3128
US-2006057776-A1,H01L23/3128
US-2007061156-A1,G06Q99/00
US-2007061156-A1,G06Q99/00
US-2006020170-A1,A61N5/1001
US-2006020170-A1,A61N5/1001
US-2006015009-A1,A61B1/00154
US-2006015009-A1,A61B1/00154
US-2006069023-A1,C12N15/8509
US-2006069023-A1,C12N15/8509
US-2007089984-A1,C23C14/3414
US-2007089984-A1,B22F3/15
US-2007089984-A1,C23C14/3414
US-2006106467-A1,F02D11/105
US-2006106467-A1,F02D11/105
US-2007095595-A1,B60R21/01516
US-2007095595-A1,B60R21/01516
US-2007095595-A1,B60R21/01516
US-2006120791-A1,B41J11/009
US-2006120791-A1,B41J11/009
US-2006068001-A1,A61K9/1652
US-2006068001-A1,A61K9/1652
US-2006115184-A1,H04N1/3935
US-2006115184-A1,G06T3/403
US-2006115184-A1,H04N1/3935
US-2006120084-A1,G03B21/16
US-2006120084-A1,G03B21/16
US-2006148712-A1,G01N33/5094
US-2006148712-A1,G01N33/5094
US-2006123024-A1,H04L61/4523
US-2006123024-A1,G06F16/285
US-2006131447-A1,F02M61/08
US-2006131447-A1,F02M61/08
US-2006136401-A1,G06F9/44521
US-2006136401-A1,G06F9/44521
US-2006135276-A1,A63B69/3688
US-2006135276-A1,A63B69/3688
US-2007296592-A1,G06K19/07749
US-2007296592-A1,G06K19/07749
US-2007142872-A1,A61N1/3787
US-2007142872-A1,A61N1/3787
US-2006155443-A1,E01C11/265
US-2006155443-A1,E01C11/265
US-2006160812-A1,C07C243/22

2025-01-25 10:32:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:32:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:32:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:32:40 - snowflake.connector.connection - INFO - closed
2025-01-25 10:32:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:33:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:33:10 - root - INFO - The error you're encountering:

```
SQL compilation error:
Lateral View cannot be on the left side of join
```

occurs because in Snowflake, you cannot have a `LATERAL FLATTEN` directly in the `FROM` clause when it's on the left side of a `JOIN`. To resolve this, you need to restructure your query to avoid this limitation.

**Corrected SQL Query:**

Here's how you can modify your query to eliminate the error:

```sql
SELECT DISTINCT cpc_data."cpc_code", d."titleFull" AS "cpc_title"
FROM (
    SELECT cpc_code.value:"code"::STRING AS "cpc_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    CROSS JOIN LATERAL FLATTEN(input => t."cpc") cpc_code
) AS cpc_data
LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION d
  ON d."symbol" = cpc_data."cpc_code"
LIMIT 100;
```

**Explanation:**

- **Subquery Usage:** We encapsulate the `LATERAL FLATTEN` operation within a subquery (`cpc_data`). This ensures the `LATERAL FLATTEN` is not directly on the left side of the `JOIN`.
  
- **CROSS JOIN LATERAL FLATTEN:** In the subquery, we use `CROSS JOIN LATERAL FLATTEN` to expand the `cpc` array from the `PUBLICATIONS` table.

- **Selecting the CPC Code:** We extract the `"code"` field from each `cpc` entry, casting it to `STRING` and aliasing it as `"cpc_code"`.

- **LEFT JOIN with CPC_DEFINITION:** Outside the subquery, we perform a `LEFT JOIN` between the extracted CPC codes and the `CPC_DEFINITION` table to get the full CPC titles.

**Alternative Query Including Publication Numbers:**

If you want to include the publication numbers along with the CPC codes and titles, you can modify the query as follows:

```sql
SELECT DISTINCT
    t_with_cpc."publication_number",
    t_with_cpc."cpc_code",
    d."titleFull" AS "cpc_title"
FROM (
    SELECT
        t."publication_number",
        cpc_code.value:"code"::STRING AS "cpc_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    CROSS JOIN LATERAL FLATTEN(input => t."cpc") cpc_code
) AS t_with_cpc
LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION d
  ON d."symbol" = t_with_cpc."cpc_code"
LIMIT 100;
```

**Notes:**

- **Avoiding the Error:** By moving the `LATERAL FLATTEN` into a subquery, we avoid placing it directly in the `FROM` clause where it would be on the left side of a `JOIN`, thus adhering to Snowflake's syntax requirements.

- **Adjusting Limitations:** The `LIMIT 100` clause limits the result set to 100 rows. Adjust this value as needed for your use case.

- **Including Additional Columns:** If you need more information from the `PUBLICATIONS` table (e.g., assignee names), you can include those in the subquery and adjust the outer query accordingly.

**Example Result:**

```csv
cpc_code,cpc_title
"A61K8/02","Cosmetics or similar toiletry preparations characterised by special physical form"
"H04L29/06","Arrangements, apparatus, circuits or systems for transmission of digital information"
"G06F1/16","Details not covered by groups G06F1/02-G06F1/14 and G06F3/00"
...
```

**Key Takeaways:**

- **Restructuring Queries:** When encountering syntax limitations, restructuring your query using subqueries or CTEs (Common Table Expressions) can often resolve the issue.

- **Understanding LATERAL FLATTEN:** The `LATERAL FLATTEN` function in Snowflake allows you to explode arrays (VARIANT fields) into multiple rows, but it has to be used carefully with respect to joins.

- **Joining with Other Tables:** After extracting the necessary data using `LATERAL FLATTEN`, you can perform joins with other tables as needed.

**Further Assistance:**

If you continue to experience issues or need additional help modifying the query for your specific requirements, feel free to ask, and I'll be glad to assist further.
2025-01-25 10:33:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:33:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:33:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:33:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:33:12 - snowflake.connector.connection - INFO - closed
2025-01-25 10:33:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:34:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:34:25 - root - INFO - SQL:
SELECT DISTINCT cpc_data."cpc_code", d."titleFull" AS "cpc_title"
FROM (
    SELECT cpc_code.value:"code"::STRING AS "cpc_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    CROSS JOIN LATERAL FLATTEN(input => t."cpc") cpc_code
) AS cpc_data
LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION d
  ON d."symbol" = cpc_data."cpc_code"
LIMIT 100;
Results:
Too long, hard cut:
cpc_code,cpc_title
C09J2301/308,"Additional features of adhesives in the form of films or foils characterized by the chemical, physicochemical or physical properties of the adhesive or the carrier the adhesive tape or sheet losing adhesive strength when being stretched, e.g. stretch adhesive"
G03F7/423,"Stripping or agents therefor using liquids only containing mineral acids or salts thereof, containing mineral oxidizing substances, e.g. peroxy compounds"
A61P1/16,"Drugs for disorders of the alimentary tract or the digestive system for liver or gallbladder disorders, e.g. hepatoprotective agents, cholagogues, litholytics"
Y02E10/52,PV systems with concentrators
B26D7/2628,Means for adjusting the position of the cutting member
A24F5/04,Bowls for pipes with holes for admitting air
H01L2224/48227,"Connecting between a semiconductor or solid-state body and an item not being a semiconductor or solid-state body, e.g. chip-to-substrate, chip-to-passive the body and the item being stacked the item being non-metallic, e.g. insulating substrate with or without metallisation connecting the wire to a bond pad of the item"
A63F13/12,
G06F13/4027,Coupling between buses using bus bridges
A61P9/06,Antiarrhythmics
H01L21/02129,"Forming insulating materials on a substrate characterised by the type of layer, e.g. type of material, porous/non-porous, pre-cursors, mixtures or laminates characterised by the material of the layer the material containing silicon the material containing Si, O, and at least one of H, N, C, F, or other non-metal elements, e.g. SiOC, SiOC:H or SiONC the material being boron or phosphorus doped silicon oxides, e.g. BPSG, BSG or PSG"
H01L2224/73253,Bump and layer connectors
H04L67/06,"Protocols specially adapted for file transfer, e.g. file transfer protocol [FTP]"
A61B17/7037,"Screws or hooks, wherein a rod-clamping part and a bone-anchoring part can pivot relative to each other wherein pivoting is blocked when the rod is clamped"
A61B17/7032,Screws or hooks with U-shaped head or back through which longitudinal rods pass
G06V10/75,"Organisation of the matching processes, e.g. simultaneous or sequential comparisons of image or video features; Coarse-fine approaches, e.g. multi-scale approaches; using context analysis; Selection of dictionaries"
G06F16/48,"Retrieval characterised by using metadata, e.g. metadata not derived from the content or metadata generated manually"
G02F1/1368,Active matrix addressed cells in which the switching element is a three-electrode device
G03G15/0877,Arrangements for metering and dispensing developer from a developer cartridge into the development unit
F05D2260/602,Drainage
A61K31/496,"Non-condensed piperazines containing further heterocyclic rings, e.g. rifampin, thiothixene or sparfloxacin"
F21S2/00,"Systems of lighting devices, not provided for in main groups F21S4/00 - F21S10/00 or F21S19/00, e.g. of modular construction"
G09G5/008,Clock recovery
A22B5/208,Band saws
C09D11/30,Inkjet printing inks
G09G2370/06,"Consumer Electronics Control, i.e. control of another device by a display or vice versa"
B32B2250/24,All layers being polymeric
C03C17/3618,"Coatings of type glass/inorganic compound/other inorganic layers, at least one layer being metallic"
B01J2219/00833,Plastic
A61L27/507,"Materials characterised by their function or physical properties, e.g. injectable or lubricating compositions, shape-memory materials, surface modified materials for artificial blood vessels"
G02B6/0045,Means for improving the coupling-out of light from the light guide provided on the surface of the light guide or in the bulk of it by shaping at least a portion of the light guide
H01L2924/00013,Fully indexed content
C07D333/18,Radicals substituted by singly bound hetero atoms other than halogen by sulfur atoms
H04L51/23,"Reliability checks, e.g. acknowledgments or fault reporting"
H04N1/00519,"Constructional details not otherwise provided for, e.g. housings, covers"
G08B31/00,Predictive alarm systems characterised by extrapolation or other computation using updated historic data
C08L2205/03,Polymer mixtures characterised by other features containing three or more polymers in a blend
H01L2924/01019,Potassium [K]
C09D7/43,Thickening agents
B29C45/14811,Multilayered articles
F16C33/102,Construction relative to lubrication with grease as lubricant
B60W10/22,Conjoint control of vehicle sub-units of different type or different function including control of suspension systems
C10J2300/0946,"Waste, e.g. MSW, tires, glass, tar sand, peat, paper, lignite, oil shale"
C07C51/412,"Preparation of salts of carboxylic acids by conversion of the acids, their salts, esters or anhydrides with the same carboxylic acid part"
B41J2/04588,"Control methods or devices therefor, e.g. driver circuits, control circuits using a specific waveform"
C02F2307/02,Location of water treatment or water treatment device as part of a bottle
A61B17/320783,"Atherectomy devices working by cutting or abrading; Similar devices speciall

2025-01-25 10:34:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:34:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:34:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:34:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:34:27 - snowflake.connector.connection - INFO - closed
2025-01-25 10:34:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:34:27 - root - INFO - SQL:
-- Query 9: List CPC definitions for subclasses (codes with length 4)
SELECT d."symbol" AS "cpc_code", d."titleFull" AS "cpc_title"
FROM PATENTS.PATENTS.CPC_DEFINITION d
WHERE LENGTH(d."symbol") = 4
LIMIT 100
Results:
Too long, hard cut:
cpc_code,cpc_title
A01H,NEW PLANTS OR NON-TRANSGENIC PROCESSES FOR OBTAINING THEM; PLANT REPRODUCTION BY TISSUE CULTURE TECHNIQUES
A01F,PROCESSING OF HARVESTED PRODUCE; HAY OR STRAW PRESSES; DEVICES FOR STORING AGRICULTURAL OR HORTICULTURAL PRODUCE
A01C,PLANTING; SOWING; FERTILISING
A01G,"HORTICULTURE; CULTIVATION OF VEGETABLES, FLOWERS, RICE, FRUIT, VINES, HOPS OR SEAWEED; FORESTRY; WATERING"
A01N,"PRESERVATION OF BODIES OF HUMANS OR ANIMALS OR PLANTS OR PARTS THEREOF; BIOCIDES, e.g. AS DISINFECTANTS, AS PESTICIDES OR AS HERBICIDES; PEST REPELLANTS OR ATTRACTANTS; PLANT GROWTH REGULATORS"
A01P,"BIOCIDAL, PEST REPELLANT, PEST ATTRACTANT OR PLANT GROWTH REGULATORY ACTIVITY OF CHEMICAL COMPOUNDS OR PREPARATIONS"
A01D,HARVESTING; MOWING
A01L,SHOEING OF ANIMALS
A01K,"ANIMAL HUSBANDRY; AVICULTURE; APICULTURE; PISCICULTURE; FISHING; REARING OR BREEDING ANIMALS, NOT OTHERWISE PROVIDED FOR; NEW BREEDS OF ANIMALS"
A01M,"CATCHING, TRAPPING OR SCARING OF ANIMALS; APPARATUS FOR THE DESTRUCTION OF NOXIOUS ANIMALS OR NOXIOUS PLANTS"
A01J,MANUFACTURE OF DAIRY PRODUCTS
A01B,"SOIL WORKING IN AGRICULTURE OR FORESTRY; PARTS, DETAILS, OR ACCESSORIES OF AGRICULTURAL MACHINES OR IMPLEMENTS, IN GENERAL"
A21D,"TREATMENT, e.g. PRESERVATION, OF FLOUR OR DOUGH, e.g. BY ADDITION OF MATERIALS; BAKING; BAKERY PRODUCTS; PRESERVATION THEREOF"
A21C,MACHINES OR EQUIPMENT FOR MAKING OR PROCESSING DOUGHS; HANDLING BAKED ARTICLES MADE FROM DOUGH
A21B,BAKERS' OVENS; MACHINES OR EQUIPMENT FOR BAKING
A22B,SLAUGHTERING
A22C,"PROCESSING MEAT, POULTRY, OR FISH"
A23P,"SHAPING OR WORKING OF FOODSTUFFS, NOT FULLY COVERED BY A SINGLE OTHER SUBCLASS"
A23C,"DAIRY PRODUCTS, e.g. MILK, BUTTER OR CHEESE; MILK OR CHEESE SUBSTITUTES; MAKING THEREOF"
A23J,PROTEIN COMPOSITIONS FOR FOODSTUFFS; WORKING-UP PROTEINS FOR FOODSTUFFS; PHOSPHATIDE COMPOSITIONS FOR FOODSTUFFS
A23K,FODDER
A23L,"FOODS, FOODSTUFFS, OR NON-ALCOHOLIC BEVERAGES, NOT COVERED BY SUBCLASSES A21D OR A23B-A23J; THEIR PREPARATION OR TREATMENT, e.g. COOKING, MODIFICATION OF NUTRITIVE QUALITIES, PHYSICAL TREATMENT; PRESERVATION OF FOODS OR FOODSTUFFS, IN GENERAL"
A23N,"MACHINES OR APPARATUS FOR TREATING HARVESTED FRUIT, VEGETABLES OR FLOWER BULBS IN BULK, NOT OTHERWISE PROVIDED FOR; PEELING VEGETABLES OR FRUIT IN BULK; APPARATUS FOR PREPARING ANIMAL FEEDING- STUFFS"
A23V,"INDEXING SCHEME RELATING TO FOODS, FOODSTUFFS OR NON-ALCOHOLIC BEVERAGES AND LACTIC OR PROPIONIC ACID BACTERIA USED IN FOODSTUFFS OR FOOD PREPARATION"
A23F,"COFFEE; TEA; THEIR SUBSTITUTES; MANUFACTURE, PREPARATION, OR INFUSION THEREOF"
A23G,"COCOA; COCOA PRODUCTS, e.g. CHOCOLATE; SUBSTITUTES FOR COCOA OR COCOA PRODUCTS; CONFECTIONERY; CHEWING GUM; ICE-CREAM; PREPARATION THEREOF"
A23B,"PRESERVING, e.g. BY CANNING, MEAT, FISH, EGGS, FRUIT, VEGETABLES, EDIBLE SEEDS; CHEMICAL RIPENING OF FRUIT OR VEGETABLES; THE PRESERVED, RIPENED, OR CANNED PRODUCTS"
A23D,"EDIBLE OILS OR FATS, e.g. MARGARINES, SHORTENINGS, COOKING OILS"
A24C,MACHINES FOR MAKING CIGARS OR CIGARETTES
A24D,CIGARS; CIGARETTES; TOBACCO SMOKE FILTERS; MOUTHPIECES FOR CIGARS OR CIGARETTES; MANUFACTURE OF TOBACCO SMOKE FILTERS OR MOUTHPIECES
A24F,SMOKERS' REQUISITES; MATCH BOXES; SIMULATED SMOKING DEVICES
A24B,MANUFACTURE OR PREPARATION OF TOBACCO FOR SMOKING OR CHEWING; TOBACCO; SNUFF
A41F,GARMENT FASTENINGS; SUSPENDERS
A41G,ARTIFICIAL FLOWERS; WIGS; MASKS; FEATHERS
A41B,SHIRTS; UNDERWEAR; BABY LINEN; HANDKERCHIEFS
A41D,OUTERWEAR; PROTECTIVE GARMENTS; ACCESSORIES
A41C,CORSETS; BRASSIERES
A41H,"APPLIANCES OR METHODS FOR MAKING CLOTHES, e.g. FOR DRESS-MAKING OR FOR TAILORING, NOT OTHERWISE PROVIDED FOR"
A42B,HATS; HEAD COVERINGS
A42C,"MANUFACTURING OR TRIMMING HEAD COVERINGS, e.g. HATS"
A43B,CHARACTERISTIC FEATURES OF FOOTWEAR; PARTS OF FOOTWEAR
A43C,FASTENINGS OR ATTACHMENTS OF FOOTWEAR; LACES IN GENERAL
A43D,"MACHINES, TOOLS, EQUIPMENT OR METHODS FOR MANUFACTURING OR REPAIRING FOOTWEAR"
A44D,"INDEXING SCHEME RELATING TO BUTTONS, PINS, BUCKLES OR SLIDE FASTENERS, AND TO JEWELLERY, BRACELETS OR OTHER PERSONAL ADORNMENTS"
A44B,"BUTTONS, PINS, BUCKLES, SLIDE FASTENERS, OR THE LIKE"
A44C,"PERSONAL ADORNMENTS, e.g. JEWELLERY; COINS"
A45F,TRAVELLING OR CAMP EQUIPMENT: SACKS OR PACKS CARRIED ON THE BODY
A45C,PURSES; LUGGAGE; HAND CARRIED BAGS
A45D,"HAIRDRESSING OR SHAVING EQUIPMENT; EQUIPMENT FOR COSMETICS OR COSMETIC TREATMENTS, e.g. FOR MANICURING OR PEDICURING"
A45B,WALKING STICKS; UMBRELLAS; LADIES' OR LIKE FANS
A46D,MANUFACTURE OF BRUSHES
A46B,BRUSHES
A47L,DOMESTIC WASHING OR CLEANING; SUCTION CLEANERS IN GENERAL
A47F,"SPECIAL FURNITURE, FITTINGS, OR ACCESSORIES FOR SHOPS, STOREHOUSES, BARS, RESTAURANTS OR THE LIKE; PAYING COUNTERS"
A47D,FURNITURE SPECIALLY ADAPTED FOR CHILDREN
A47G,HOUSEHOLD OR TABLE EQUIPMENT
A47K,SANITARY EQUIPMENT NOT OTHERWISE PROVIDED FOR; TOILET ACCESSORIES
A47H,FURNISHINGS FOR WINDOWS OR DOORS
A47B,TABLES; DESKS; OFFICE FURNITURE; CABINETS; DRAWERS; GENERAL DETAILS OF FURNITURE
A47C,CHAIRS; SOFAS; BEDS
A47J,KITCHEN EQUIPMENT; COFFEE MILLS; SPICE MILLS; AP

2025-01-25 10:34:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:34:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:34:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:34:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:34:29 - snowflake.connector.connection - INFO - closed
2025-01-25 10:34:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:34:29 - root - INFO - SQL:
-- Query 10: Extract the CPC subclass (first 4 characters) for patents
SELECT t."publication_number",
       SUBSTR(cpc_code.value:"code"::STRING, 1, 4) AS "cpc_subclass"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."cpc") AS cpc_code
LIMIT 100
Results:
publication_number,cpc_subclass
US-2006215095-A1,G02F
US-2006215095-A1,G02F
US-2006215095-A1,G02F
US-2006215095-A1,G02F
US-2006215095-A1,G02F
US-2006215095-A1,G02F
US-2006215095-A1,G02F
US-2006215095-A1,G02F
US-2005219871-A1,H02M
US-2005219871-A1,H02M
US-2005219871-A1,H02M
US-2005219871-A1,H02M
US-2005219871-A1,Y02B
US-2005219871-A1,Y02P
US-2005219871-A1,Y02P
US-2005219871-A1,Y02B
US-2006225070-A1,G06F
US-2006225070-A1,G06F
US-2006223426-A1,B24B
US-2006223426-A1,B24B
US-2005282283-A1,C12N
US-2005282283-A1,C12N
US-2005282283-A1,C12M
US-2005282283-A1,C12M
US-2005282283-A1,C12M
US-2005282283-A1,C12M
US-2005191701-A1,C12N
US-2005191701-A1,C12N
US-2006250589-A1,G03F
US-2006250589-A1,G05B
US-2006250589-A1,G03F
US-2006250589-A1,G05B
US-2006250589-A1,G03F
US-2006133105-A1,F21V
US-2006133105-A1,H04N
US-2006133105-A1,H04N
US-2006133105-A1,H04Q
US-2006133105-A1,F21V
US-2006133105-A1,H04N
US-2006133105-A1,H04N
US-2006133105-A1,H04N
US-2006133105-A1,H04N
US-2006133105-A1,F21L
US-2006133105-A1,H04N
US-2006133105-A1,H04N
US-2006133105-A1,G08C
US-2006133105-A1,G08C
US-2006133105-A1,F21L
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H04B
US-2006264190-A1,H04B
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H04B
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H04B
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006272652-A1,G16H
US-2006272652-A1,G16H
US-2006280400-A1,G02B
US-2006280400-A1,G02B
US-2006280400-A1,G02B
US-2006280400-A1,G02B
US-2006280400-A1,H04J
US-2006280400-A1,G02B
US-2006280400-A1,G02B
US-2006280400-A1,G02B
US-2006280400-A1,G02B
US-2006280400-A1,G02B
US-2006280400-A1,G02B
US-2006280400-A1,G02B
US-2006280400-A1,H04J
US-2006280400-A1,H04J
US-2005244554-A1,A23K
US-2005244554-A1,A01K
US-2005244554-A1,A23K
US-2005244554-A1,A23K
US-2005244554-A1,A23K
US-2005244554-A1,A01K
US-2005244554-A1,A23K
US-2005244554-A1,A23K
US-2005244554-A1,A23K
US-2005244554-A1,A23K
US-2006089742-A1,G05B
US-2006089742-A1,G05B
US-2006088772-A1,G03F
US-2006088772-A1,G03F

2025-01-25 10:34:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:34:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:34:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:34:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:34:30 - snowflake.connector.connection - INFO - closed
2025-01-25 10:34:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:34:31 - root - INFO - SQL:
-- Query 11: Join citing patents with their assignees and CPC subclasses
SELECT t."publication_number" AS "citing_patent_number",
       assignee.value:"name"::STRING AS "citing_assignee_name",
       SUBSTR(cpc_code.value:"code"::STRING, 1, 4) AS "cpc_subclass"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."assignee_harmonized") AS assignee
CROSS JOIN LATERAL FLATTEN(input => t."cpc") AS cpc_code
LIMIT 100
Results:
citing_patent_number,citing_assignee_name,cpc_subclass
US-2006215095-A1,LIU QIN,G02F
US-2006215095-A1,LIU QIN,G02F
US-2006215095-A1,LIU QIN,G02F
US-2006215095-A1,LIU QIN,G02F
US-2006215095-A1,LIU QIN,G02F
US-2006215095-A1,LIU QIN,G02F
US-2006215095-A1,LIU QIN,G02F
US-2006215095-A1,LIU QIN,G02F
US-2006215095-A1,NELSON CURT L,G02F
US-2006215095-A1,NELSON CURT L,G02F
US-2006215095-A1,NELSON CURT L,G02F
US-2006215095-A1,NELSON CURT L,G02F
US-2006215095-A1,NELSON CURT L,G02F
US-2006215095-A1,NELSON CURT L,G02F
US-2006215095-A1,NELSON CURT L,G02F
US-2006215095-A1,NELSON CURT L,G02F
US-2006215095-A1,COMBS GREGG,G02F
US-2006215095-A1,COMBS GREGG,G02F
US-2006215095-A1,COMBS GREGG,G02F
US-2006215095-A1,COMBS GREGG,G02F
US-2006215095-A1,COMBS GREGG,G02F
US-2006215095-A1,COMBS GREGG,G02F
US-2006215095-A1,COMBS GREGG,G02F
US-2006215095-A1,COMBS GREGG,G02F
US-2005219871-A1,LI HONG-CHUN,H02M
US-2005219871-A1,LI HONG-CHUN,H02M
US-2005219871-A1,LI HONG-CHUN,H02M
US-2005219871-A1,LI HONG-CHUN,H02M
US-2005219871-A1,LI HONG-CHUN,Y02B
US-2005219871-A1,LI HONG-CHUN,Y02P
US-2005219871-A1,LI HONG-CHUN,Y02P
US-2005219871-A1,LI HONG-CHUN,Y02B
US-2005219871-A1,TSAY CHEAN-LUNG,H02M
US-2005219871-A1,TSAY CHEAN-LUNG,H02M
US-2005219871-A1,TSAY CHEAN-LUNG,H02M
US-2005219871-A1,TSAY CHEAN-LUNG,H02M
US-2005219871-A1,TSAY CHEAN-LUNG,Y02B
US-2005219871-A1,TSAY CHEAN-LUNG,Y02P
US-2005219871-A1,TSAY CHEAN-LUNG,Y02P
US-2005219871-A1,TSAY CHEAN-LUNG,Y02B
US-2005219871-A1,CHEN DAN,H02M
US-2005219871-A1,CHEN DAN,H02M
US-2005219871-A1,CHEN DAN,H02M
US-2005219871-A1,CHEN DAN,H02M
US-2005219871-A1,CHEN DAN,Y02B
US-2005219871-A1,CHEN DAN,Y02P
US-2005219871-A1,CHEN DAN,Y02P
US-2005219871-A1,CHEN DAN,Y02B
US-2006225070-A1,IBM,G06F
US-2006225070-A1,IBM,G06F
US-2006223426-A1,GUTHRIE HUNG-CHIN,B24B
US-2006223426-A1,GUTHRIE HUNG-CHIN,B24B
US-2006223426-A1,NYSTROM JAMES C,B24B
US-2006223426-A1,NYSTROM JAMES C,B24B
US-2005282283-A1,VOZZA-BROWN LAURA,C12N
US-2005282283-A1,VOZZA-BROWN LAURA,C12N
US-2005282283-A1,VOZZA-BROWN LAURA,C12M
US-2005282283-A1,VOZZA-BROWN LAURA,C12M
US-2005282283-A1,VOZZA-BROWN LAURA,C12M
US-2005282283-A1,VOZZA-BROWN LAURA,C12M
US-2005282283-A1,YIM HARRY,C12N
US-2005282283-A1,YIM HARRY,C12N
US-2005282283-A1,YIM HARRY,C12M
US-2005282283-A1,YIM HARRY,C12M
US-2005282283-A1,YIM HARRY,C12M
US-2005282283-A1,YIM HARRY,C12M
US-2005282283-A1,CAMERON JOHN,C12N
US-2005282283-A1,CAMERON JOHN,C12N
US-2005282283-A1,CAMERON JOHN,C12M
US-2005282283-A1,CAMERON JOHN,C12M
US-2005282283-A1,CAMERON JOHN,C12M
US-2005282283-A1,CAMERON JOHN,C12M
US-2005282283-A1,O'BANION MATTHEW,C12N
US-2005282283-A1,O'BANION MATTHEW,C12N
US-2005282283-A1,O'BANION MATTHEW,C12M
US-2005282283-A1,O'BANION MATTHEW,C12M
US-2005282283-A1,O'BANION MATTHEW,C12M
US-2005282283-A1,O'BANION MATTHEW,C12M
US-2005282283-A1,HENRY ADAM S,C12N
US-2005282283-A1,HENRY ADAM S,C12N
US-2005282283-A1,HENRY ADAM S,C12M
US-2005282283-A1,HENRY ADAM S,C12M
US-2005282283-A1,HENRY ADAM S,C12M
US-2005282283-A1,HENRY ADAM S,C12M
US-2005282283-A1,OLIVIER LISA M,C12N
US-2005282283-A1,OLIVIER LISA M,C12N
US-2005282283-A1,OLIVIER LISA M,C12M
US-2005282283-A1,OLIVIER LISA M,C12M
US-2005282283-A1,OLIVIER LISA M,C12M
US-2005282283-A1,OLIVIER LISA M,C12M
US-2006250589-A1,EURLINGS MARKUS FRANCISCUS A,G03F
US-2006250589-A1,EURLINGS MARKUS FRANCISCUS A,G05B
US-2006250589-A1,EURLINGS MARKUS FRANCISCUS A,G03F
US-2006250589-A1,EURLINGS MARKUS FRANCISCUS A,G05B
US-2006250589-A1,EURLINGS MARKUS FRANCISCUS A,G03F
US-2006250589-A1,LAIDIG THOMAS,G03F
US-2006250589-A1,LAIDIG THOMAS,G05B
US-2006250589-A1,LAIDIG THOMAS,G03F
US-2006250589-A1,LAIDIG THOMAS,G05B
US-2006250589-A1,LAIDIG THOMAS,G03F

2025-01-25 10:34:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:34:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:34:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:34:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:34:32 - snowflake.connector.connection - INFO - closed
2025-01-25 10:34:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:34:33 - root - INFO - SQL:
-- Query 12: Explore the structure of "assignee_harmonized" field
SELECT t."publication_number", assignee.value AS "assignee_value"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."assignee_harmonized") AS assignee
LIMIT 100
Results:
Too long, hard cut:
publication_number,assignee_value
US-8210142-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""SUZUKI SHIGEMITSU""
}"
US-8210142-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""TOMA NAOTO""
}"
US-8210142-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""KANADA YOJI""
}"
US-8210142-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""MUKAIDE HIROKI""
}"
US-8210142-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""AISIN SEIKI""
}"
US-8338035-B2,"{
  ""country_code"": ""KR"",
  ""name"": ""CHIN SANG MUN""
}"
US-8338035-B2,"{
  ""country_code"": ""KR"",
  ""name"": ""KIM SAE HOON""
}"
US-8338035-B2,"{
  ""country_code"": ""KR"",
  ""name"": ""YANG YOO CHANG""
}"
US-8338035-B2,"{
  ""country_code"": ""KR"",
  ""name"": ""YIM CHUL HO""
}"
US-8338035-B2,"{
  ""country_code"": ""KR"",
  ""name"": ""BAECK SUK MIN""
}"
US-8338035-B2,"{
  ""country_code"": ""KR"",
  ""name"": ""HEO SEONG IL""
}"
US-8338035-B2,"{
  ""country_code"": ""KR"",
  ""name"": ""HYUNDAI MOTOR CO LTD""
}"
US-8338035-B2,"{
  ""country_code"": ""KR"",
  ""name"": ""KIA MOTORS CORP""
}"
US-8609829-B2,"{
  ""country_code"": ""US"",
  ""name"": ""BUNGO JENNIFER J""
}"
US-8609829-B2,"{
  ""country_code"": ""US"",
  ""name"": ""HOGAN JAMES J""
}"
US-8609829-B2,"{
  ""country_code"": ""US"",
  ""name"": ""POLLNER REINHOLD B""
}"
US-8609829-B2,"{
  ""country_code"": ""US"",
  ""name"": ""HUDSPETH MARIE K""
}"
US-8609829-B2,"{
  ""country_code"": ""US"",
  ""name"": ""KAPLAN SHANNON K""
}"
US-8609829-B2,"{
  ""country_code"": ""US"",
  ""name"": ""GOSLOW ELIZABETH M""
}"
US-8609829-B2,"{
  ""country_code"": ""US"",
  ""name"": ""GEN PROBE INC""
}"
US-8240274-B2,"{
  ""country_code"": ""US"",
  ""name"": ""GREENE MICHAEL E""
}"
US-8240274-B2,"{
  ""country_code"": ""US"",
  ""name"": ""JENNINGS BRYAN W""
}"
US-8240274-B2,"{
  ""country_code"": ""US"",
  ""name"": ""JONES TERRANCE L""
}"
US-8240274-B2,"{
  ""country_code"": ""US"",
  ""name"": ""CLEMMONS DAVID L""
}"
US-8240274-B2,"{
  ""country_code"": ""US"",
  ""name"": ""MID WEST METAL PRODUCTS CO INC""
}"
US-8904292-B2,"{
  ""country_code"": ""CN"",
  ""name"": ""Fan zhi-hua""
}"
US-8904292-B2,"{
  ""country_code"": ""US"",
  ""name"": ""AHLENIUS MARK T""
}"
US-8904292-B2,"{
  ""country_code"": ""US"",
  ""name"": ""DETTER CRAIG J""
}"
US-8904292-B2,"{
  ""country_code"": ""US"",
  ""name"": ""FERRANS JAMES C""
}"
US-8904292-B2,"{
  ""country_code"": ""CN"",
  ""name"": ""ZHAO KUN""
}"
US-8904292-B2,"{
  ""country_code"": ""US"",
  ""name"": ""MOTOROLA MOBILITY LLC""
}"
US-8480325-B2,"{
  ""country_code"": ""US"",
  ""name"": ""GALLARDO JOSE ANTONIO""
}"
US-8480325-B2,"{
  ""country_code"": ""US"",
  ""name"": ""ARIGALA PAINTING INC""
}"
US-9028758-B2,"{
  ""country_code"": ""IL"",
  ""name"": ""KEINAN ALEX""
}"
US-9028758-B2,"{
  ""country_code"": ""IL"",
  ""name"": ""MIROSHNICHENKO YEVGENY""
}"
US-9028758-B2,"{
  ""country_code"": ""IL"",
  ""name"": ""PARADNY MARK""
}"
US-9028758-B2,"{
  ""country_code"": ""IL"",
  ""name"": ""EXPLODET TECHNOLOGIES LTD""
}"
US-8462223-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""SUZUKI ASUKA""
}"
US-8462223-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""SONY CORP""
}"
US-7944609-B2,"{
  ""country_code"": ""US"",
  ""name"": ""ZETA INSTR INC""
}"
US-10236950-B2,"{
  ""country_code"": ""NL"",
  ""name"": ""WENTINK MAARTEN MENZO""
}"
US-10236950-B2,"{
  ""country_code"": ""US"",
  ""name"": ""QUALCOMM INC""
}"
US-8733262-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""NOGUCHI YOSHIO""
}"
US-8733262-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""SAITO JURI""
}"
US-8733262-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""KOTOBUKI & CO LTD""
}"
US-8733262-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""WESTEK INTERNAT CORP""
}"
US-8248448-B2,"{
  ""country_code"": ""US"",
  ""name"": ""FENG JINWEI""
}"
US-8248448-B2,"{
  ""country_code"": ""US"",
  ""name"": ""CHU PETER""
}"
US-8248448-B2,"{
  ""country_code"": ""US"",
  ""name"": ""DUNLAP WAYNE""
}"
US-8248448-B2,"{
  ""country_code"": ""US"",
  ""name"": ""GALLMEIER JONATHAN""
}"
US-8248448-B2,"{
  ""country_code"": ""US"",
  ""name"": ""NIMRI ALAIN""
}"
US-8248448-B2,"{
  ""country_code"": ""US"",
  ""name"": ""SCHAEFER STEPHEN P""
}"
US-8248448-B2,"{
  ""country_code"": ""US"",
  ""name"": ""POLYCOM INC""
}"
US-8590235-B2,"{
  ""country_code"": ""US"",
  ""name"": ""RESSO FRANK""
}"
US-8590235-B2,"{
  ""country_code"": ""US"",
  ""name"": ""JONES GEORGE""
}"
US-8590235-B2,"{
  ""country_code"": ""US"",
  ""name"": ""NELSON RON""
}"
US-8590235-B2,"{
  ""country_code"": ""US"",
  ""name"": ""HUBER MIKE""
}"
US-8590235-B2,"{
  ""country_code"": ""US"",
  ""name"": ""PIERSON JOHN""
}"
US-8590235-B2,"{
  ""country_code"": ""US"",
  ""name"": ""GARLAND IND INC""
}"
US-8086194-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""KOGA HISAO""
}"
US-8086194-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""KODAMA NOBUTAKA""
}"
US-8086194-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""KONISHI TAISUKE""
}"
US-8086194-B2,"{
  ""country_code

2025-01-25 10:34:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:34:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:34:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:34:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 12
2025-01-25 10:34:34 - snowflake.connector.connection - INFO - closed
2025-01-25 10:34:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:34:35 - root - INFO - SQL:
-- Query 13: Find all patents citing DENSO CORP patents, excluding DENSO CORP as citing assignee
SELECT t."publication_number" AS "citing_patent_number",
       assignee.value:"name"::STRING AS "citing_assignee_name",
       cited.value:"publication_number"::STRING AS "cited_publication_number"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."assignee_harmonized") AS assignee
CROSS JOIN LATERAL FLATTEN(input => t."citation") AS cited
WHERE cited.value:"publication_number"::STRING IN (
  SELECT denso_patent."publication_number"
  FROM PATENTS.PATENTS.PUBLICATIONS denso_patent
  CROSS JOIN LATERAL FLATTEN(input => denso_patent."assignee_harmonized") AS denso_assignee
  WHERE denso_assignee.value:"name"::STRING ILIKE '%DENSO CORP%'
)
AND assignee.value:"name"::STRING NOT ILIKE '%DENSO CORP%'
LIMIT 100
Results:
citing_patent_number,citing_assignee_name,cited_publication_number
CN-109203994-A,YAZAKI CORP,JP-2008089479-A
JP-2020117051-A,HONDA MOTOR CO LTD,JP-2008238870-A
US-8807647-B2,SAHASHI HIDEO,JP-2010104485-A
US-8807647-B2,TOYOTA BOSHOKU KK,JP-2010104485-A
US-10616959-B2,MAHLE INT GMBH,US-6178292-B1
US-9151260-B2,SUZUKI HISAO,JP-2004332657-A
US-9151260-B2,TOYOTA MOTOR CO LTD,JP-2004332657-A
US-10774689-B2,MAHLE INT GMBH,US-2007044473-A1
DE-102006000312-B4,TOYOTA MOTOR CO LTD,EP-1672346-A2
CN-108292892-A,FUJI ELECTRIC CO LTD,JP-2009071935-A
US-2015369515-A1,HYUNDAI MOTOR CO LTD,US-6178292-B1
US-2015369515-A1,KIA MOTORS CORP,US-6178292-B1

2025-01-25 10:34:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:34:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:34:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:34:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-25 10:34:36 - snowflake.connector.connection - INFO - closed
2025-01-25 10:34:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:34:36 - root - INFO - SQL:
-- Query 14: Count citations of DENSO CORP patents by other assignees
SELECT assignee.value:"name"::STRING AS "citing_assignee_name",
       COUNT(*) AS "citation_count"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."assignee_harmonized") AS assignee
CROSS JOIN LATERAL FLATTEN(input => t."citation") AS cited
WHERE cited.value:"publication_number"::STRING IN (
  SELECT denso_patent."publication_number"
  FROM PATENTS.PATENTS.PUBLICATIONS denso_patent
  CROSS JOIN LATERAL FLATTEN(input => denso_patent."assignee_harmonized") AS denso_assignee
  WHERE denso_assignee.value:"name"::STRING ILIKE '%DENSO CORP%'
)
AND assignee.value:"name"::STRING NOT ILIKE '%DENSO CORP%'
GROUP BY assignee.value:"name"::STRING
LIMIT 100
Results:
citing_assignee_name,citation_count
SUZUKI HISAO,1
TOYOTA BOSHOKU KK,1
SAHASHI HIDEO,1
YAZAKI CORP,1
MAHLE INT GMBH,2
HYUNDAI MOTOR CO LTD,1
HONDA MOTOR CO LTD,1
TOYOTA MOTOR CO LTD,2
KIA MOTORS CORP,1
FUJI ELECTRIC CO LTD,1

2025-01-25 10:34:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:34:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:34:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:34:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 10:34:38 - snowflake.connector.connection - INFO - closed
2025-01-25 10:34:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:34:38 - root - INFO - SQL:
-- Query 15: List CPC subclass titles for a given subclass code
SELECT d."symbol" AS "cpc_subclass", d."titleFull" AS "cpc_title"
FROM PATENTS.PATENTS.CPC_DEFINITION d
WHERE d."symbol" = 'H01M'  -- Example subclass code
LIMIT 100
Results:
cpc_subclass,cpc_title
H01M,"PROCESSES OR MEANS, e.g. BATTERIES, FOR THE DIRECT CONVERSION OF CHEMICAL ENERGY INTO ELECTRICAL ENERGY"

2025-01-25 10:34:38 - root - INFO - itercount: 0
2025-01-25 10:34:38 - root - INFO - Database Name: PATENTS
Schema Name: PATENTS
DDL describes table information.
,0
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,1
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""spif_publication_number"" VARCHAR(16777216),
	""spif_application_number"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""claims_localized_html"" VARIANT,
	""description_localized"" VARIANT,
	""description_localized_html"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""locarno"" VARIANT,
	""citation"" VARIANT,
	""parent"" VARIANT,
	""child"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,2
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

External knowledge that might be helpful: 
### IPC Codes: Handling Main IPC Code Selection

When dealing with the `ipc` field in the `patents-public-data.patents.publications` dataset, it is important to understand the structure of this field, especially the subfield `first`. This subfield is a boolean that indicates whether a given IPC code is the main code for the publication number in question. This is crucial because each patent publication can be associated with multiple IPC codes, signifying the various aspects of the technology covered by the patent.

However, not every publication in the dataset has a designated main IPC code. This lack of a clearly identified main IPC code complicates the process of determining the most relevant IPC code for each publication, as selecting a single IPC code from multiple possibilities without clear prioritization can lead to inconsistent or skewed analyses.

This approach ensures a more consistent and representative selection of IPC codes across the dataset, facilitating more accurate and meaningful analysis of patent trends and classifications. By focusing on the most frequently occurring 4-digit IPC code, the view helps overcome the limitations posed by the absence of a designated main IPC code, thereby enhancing the reliability of patent-related studies and insights derived from this data.

Here is an example

```
SELECT 
    t1.publication_number, 
    SUBSTR(ipc_u.code, 0, 4) as ipc4, 
    COUNT(
    SUBSTR(ipc_u.code, 0, 4)
    ) as ipc4_count 
FROM 
    `patents-public-data.patents.publications` t1, 
    UNNEST(ipc) AS ipc_u 
GROUP BY 
    t1.publication_number, 
    ipc4

```



# Text Embeddings (Similarity)

Patent documents are rich with textual data. In fact, most of the information contained in a patent document is text. This includes the `abstract_localized`, `description_localized`, and `claims_localized`. Textual data can be a powerful tool to analyze and compare patent scope and content across patents. However, before being able to use textual data, it needs to be vectorized or transformed into text embeddings that can be used by machine learning models. Therefore, creating text embeddings from the textual data of patents is necessary to compare patent contents. Technically speaking, running an NLP algorithm that creates embeddings for all U.S. patents is computationally difficult.

Nevertheless, Google runs their own machine learning algorithm which transforms patent text metadata into text embeddings which they report in `patents-public-data.google_patents_research.publications` table. The textual embeddings of one patent, without any knowledge on the algorithm being used to create them, are meaningless on their own. However, the embeddings are powerful when it comes to comparing textual content of two or more patents. Embeddings can be used to calculate a similarity score between any two patents. This similarity score is calculated by applying the dot product of the embeddings vector of the patents, as shown below:

The similarity \( \text{Similarty}_{i,k} \) between two patents \( i \) and \( k \) is calculated as the dot product of their embedding vectors:

\[
\text{Similarty}_{i,k} = \mathbf{v}_i \cdot \mathbf{v}_k
\]

where

\[
\mathbf{v}_i = [v_{i1}, v_{i2}, v_{i3}, \ldots, v_{iN}]
\]
and
\[
\mathbf{v}_k = [v_{k1}, v_{k2}, v_{k3}, \ldots, v_{kN}]
\]

are the embedding vectors for patents \( i \) and \( k \) respectively. The higher the dot product, the more similar the patents.





# Originality (Trajtenberg)

One of the most important measures of a patent is "basicness". The aspects of basicness are tough to measure. Nevertheless, some literature finds that important aspects of these measures are embodied in the relationship between the invention and the technological predcessors and successors it is connected to through, for example, patent citations. We can thus use patent citations to construct measures that identify basicness and appropriability. Trajtenberg et al. 1997 provide a number of these measures. They distinguish between:

1. Forward-looking measures: measures that are derived from the relationship between an invention and subsequent technologies that build upon it. These measures are thus constructed from the forward citations. One example of a forward-looking basicness measure they provide is Generality, which is calculated as:

\[
\text{GENERALITY}_i = 1 - \sum_{k=1}^{N_i} \left( \frac{\text{NCITING}_{G_k}}{\text{NCITING}_i} \right)
\]


2. Backward-looking measures: measures that are derived from the relationship between a given patent and the body of knowledge that preceded it. These measure are thus constructed from the backward citations. One example of a backward-looking basicness measure they provide is Orginality, which is calculated as:

\[
\text{ORIGINALITY}_i = 1 - \sum_{k=1}^{N_i} \left( \frac{\text{NCITED}_{i,k}}{\text{NCITED}_i} \right)
\]

With **NCITING** and **NCITED** defined as the number of patents citing the focal patent and the number of patents cited by the focal patent, respectively. Index `i` corresponds to the focal patent considered, and `k` is the index of patent classes. For example, **NCITED_2,3** refers to the number of patents in patent class 3 and cited by our focal patent 2.


The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **PUBLICATIONS Table:**
  - `"publication_number"`: Unique identifier for each patent publication; used to identify patents.
  - `"assignee_harmonized"`: VARIANT column containing assignee information; used to identify patents assigned to **DENSO CORP** and the assignees of citing patents.
  - `"citation"`: VARIANT column containing citations made by the patent; used to find patents that cite **DENSO CORP** patents.
  - `"cpc"`: VARIANT column containing CPC classification codes; used to identify the primary CPC subclasses associated with the patents.

- **CPC_DEFINITION Table:**
  - `"symbol"`: CPC code symbol; used to join with CPC codes from the `PUBLICATIONS` table.
  - `"titleFull"`: Full title of the CPC code; provides the description of the CPC subclass.

**Conditions That May Be Used:**

- **Assignee Conditions:**
  - Exclude citing patents where the assignee is **DENSO CORP** by filtering out records where the citing assignee's name contains "DENSO CORP".
  - Identify patents assigned to **DENSO CORP** by checking if the assignee's name contains "DENSO CORP".

- **Citation Conditions:**
  - Match cited patents' `"publication_number"` with the patents assigned to **DENSO CORP**.

- **CPC Code Conditions:**
  - Focus on the main categories of the CPC codes, possibly by extracting the first four characters of the CPC code to represent the subclass.
  - Use the `"first"` field in the `"cpc"` column to identify the primary CPC code if available.

**SQL Queries:**

```sql
-- Query 1: List distinct assignee names in the PUBLICATIONS table
SELECT DISTINCT assignee.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."assignee_harmonized") assignee
LIMIT 100;
```

```sql
-- Query 2: Find patents assigned to DENSO CORP
SELECT t."publication_number", assignee.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."assignee_harmonized") assignee
WHERE assignee.value:"name"::STRING ILIKE '%DENSO CORP%'
LIMIT 100;
```

```sql
-- Query 3: Explore the structure of the "citation" field
SELECT t."publication_number", citation.value AS "citation_value"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."citation") citation
LIMIT 100;
```

```sql
-- Query 4: List patents and their citations
SELECT t."publication_number" AS "citing_patent_number",
       cited.value:"publication_number"::STRING AS "cited_publication_number"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."citation") cited
LIMIT 100;
```

```sql
-- Query 5: Find patents that cite a specific DENSO CORP patent (e.g., US1234567)
SELECT t."publication_number" AS "citing_patent_number",
       cited.value:"publication_number"::STRING AS "cited_publication_number"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."citation") cited
WHERE cited.value:"publication_number"::STRING = 'US1234567'
LIMIT 100;
```

```sql
-- Query 6: Extract CPC codes for patents
SELECT t."publication_number", cpc_code.value:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."cpc") cpc_code
LIMIT 100;
```

```sql
-- Query 7: Extract primary CPC codes (where "first" is true)
SELECT t."publication_number", cpc_code.value:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."cpc") cpc_code
WHERE cpc_code.value:"first"::BOOLEAN = TRUE
LIMIT 100;
```

```sql
-- Query 8: Join CPC codes with their full titles from CPC_DEFINITION
SELECT DISTINCT cpc_code.value:"code"::STRING AS "cpc_code", d."titleFull" AS "cpc_title"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."cpc") cpc_code
LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION d
  ON d."symbol" = cpc_code.value:"code"::STRING
LIMIT 100;
```

```sql
-- Query 9: List CPC definitions for subclasses (codes with length 4)
SELECT d."symbol" AS "cpc_code", d."titleFull" AS "cpc_title"
FROM PATENTS.PATENTS.CPC_DEFINITION d
WHERE LENGTH(d."symbol") = 4
LIMIT 100;
```

```sql
-- Query 10: Extract the CPC subclass (first 4 characters) for patents
SELECT t."publication_number",
       SUBSTR(cpc_code.value:"code"::STRING, 1, 4) AS "cpc_subclass"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."cpc") cpc_code
LIMIT 100;
```

```sql
-- Query 11: Join citing patents with their assignees and CPC subclasses
SELECT t."publication_number" AS "citing_patent_number",
       assignee.value:"name"::STRING AS "citing_assignee_name",
       SUBSTR(cpc_code.value:"code"::STRING, 1, 4) AS "cpc_subclass"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."assignee_harmonized") assignee,
LATERAL FLATTEN(input => t."cpc") cpc_code
LIMIT 100;
```

```sql
-- Query 12: Explore the structure of "assignee_harmonized" field
SELECT t."publication_number", assignee.value AS "assignee_value"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."assignee_harmonized") assignee
LIMIT 100;
```

```sql
-- Query 13: Find all patents citing DENSO CORP patents, excluding DENSO CORP as citing assignee
SELECT t."publication_number" AS "citing_patent_number",
       assignee.value:"name"::STRING AS "citing_assignee_name",
       cited.value:"publication_number"::STRING AS "cited_publication_number"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."assignee_harmonized") assignee,
LATERAL FLATTEN(input => t."citation") cited
WHERE cited.value:"publication_number"::STRING IN (
  SELECT denso_patents."publication_number"
  FROM PATENTS.PATENTS.PUBLICATIONS denso_patents,
  LATERAL FLATTEN(input => denso_patents."assignee_harmonized") denso_assignee
  WHERE denso_assignee.value:"name"::STRING ILIKE '%DENSO CORP%'
)
AND assignee.value:"name"::STRING NOT ILIKE '%DENSO CORP%'
LIMIT 100;
```

```sql
-- Query 14: Count citations of DENSO CORP patents by other assignees
SELECT assignee.value:"name"::STRING AS "citing_assignee_name",
       COUNT(*) AS "citation_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."assignee_harmonized") assignee,
LATERAL FLATTEN(input => t."citation") cited
WHERE cited.value:"publication_number"::STRING IN (
  SELECT denso_patents."publication_number"
  FROM PATENTS.PATENTS.PUBLICATIONS denso_patents,
  LATERAL FLATTEN(input => denso_patents."assignee_harmonized") denso_assignee
  WHERE denso_assignee.value:"name"::STRING ILIKE '%DENSO CORP%'
)
AND assignee.value:"name"::STRING NOT ILIKE '%DENSO CORP%'
GROUP BY assignee.value:"name"::STRING
LIMIT 100;
```

```sql
-- Query 15: List CPC subclass titles for a given subclass code
SELECT d."symbol" AS "cpc_subclass", d."titleFull" AS "cpc_title"
FROM PATENTS.PATENTS.CPC_DEFINITION d
WHERE d."symbol" = 'H01M' -- Example subclass code
LIMIT 100;
```

**Explanation:**

The queries above are designed to explore the relevant tables and columns needed to address the task. They start from simple selections and gradually incorporate more complexity, such as joins and subqueries, to understand the relationships between patents, assignees, citations, and CPC codes.

- **Queries 1 & 2** extract assignee names and identify patents assigned to **DENSO CORP**.
- **Queries 3 to 5** explore the structure of the `"citation"` field and find patents that cite specific patents.
- **Queries 6 to 10** focus on extracting CPC codes and joining them with their definitions to get the full titles.
- **Queries 11 to 14** combine data from assignees, citations, and CPC codes to explore how patents assigned to **DENSO CORP** are cited by other assignees.
- **Query 15** retrieves the full title of a specific CPC subclass code from the `CPC_DEFINITION` table.

These queries help in understanding how to extract and manipulate the data necessary for the final analysis without directly providing the solution to the task.Query:
-- Query 1: List distinct assignee names in the PUBLICATIONS table
SELECT DISTINCT assignee.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."assignee_harmonized") assignee
LIMIT 100;
Answer:
assignee_name
ACE BEDS CO LTD
FEDELI GIANCARLO
XIAOYING ZHAO
RONGHUA SUN
SERVIER LAB
ETA SRL
ODED MIRETZKY
MAGNETI MARELLI SPA
EXXON RESEARCH ENGINEERING CO
HOERR LOUIS A
PNEUMATIC SURGICAL APPLIANCE COMPANY
NINGGUO RUIPU SEALS CO LTD
XIAMEN BRANCH ZHONGSHAN HOSPITAL FUDAN UNIV
Shanghai hesheng machinery co ltd
DONGGUAN POLYMERS NEW MATERIAL TECH CO LTD
HOWELL THOMAS A
SHIM JAE J
MEGURO TAKESHI
ARNEY SHANE R
UBE MAT IND LTD
NICHIA CORP
ST MICROELECTRONICS ROUSSET
ZIMMER INC
SCINTOMICS GMBH
SUBARU CORP
HEFEI CAS LANRUI TECH CO LTD
BEXSON BIOMEDICAL INC
CRNOGORAC FERDO
CONTITECH VIBRATION CONTROL GMBH
ERWIN KOPPE OFEN UND HERDFABRI
Helicopterflug Großer GmbH
WEIR MINERALS AUSTRALIA LTD
OOO NI SKIJ I ATEROSKLER
KRAFT FOODS R & D INC
TAIWAN SEMICONDUCTOR MFG
GOTFRIED YECHIEL
VIVANT MEDICAL INC
CANON STAAR CO INC
KROPPE WILLIAM J
SURFACE SPECIALTIES AUSTRIA
HAMMONDS CARL L
ADDISON CLEAR WAVE LLC
HEWLETT PACKARD DEVELOPMENT CO LP
FWP IP APS
XU YINGQI
PANASONIC ECO SYS GUANGDONG CO
HOBOT TECH INC
TORBJORN AFDAL
HENRY DREYFUS
CHARMGLOW PRODUCTS INC
GE HEALTHCARE AS
KIOXIA CORP
STIERLEN MAQUET AG
ROOTPATH GENOMICS INC
PREC BIOSCIENCES INC
STANLEY WORKS LTD
CAMURUS AB
WWT SPOLKA Z OGRANICZONA ODPOWIEDZIALNOSCIA
EISEN EIKO
HESTAN COMMERCIAL CORP
SHADECRAFT INC
SONOS INC
NOVALEAD PHARMA INC
ARKRAY INC
ROCKWOOL INT
CHR HANSEN AS
RATHIN BHATTACHARJEE
LIBERTY NAT BANK AND TRUST COM
HAVERSTICK GEORGE W
MOBIPAYPOINT LTD
RIJK ZWAAN ZAADTEELT EN ZAADHANDEL BV
PROEKTNO IZYSKATELSKIJ NII GID
VB AUTOBATTERIE GMBH
AGRUPADA INVEST OFF
KLAESSIG OSKAR PAUL
FIRM OF OTTO URBAN
BAKONY FEM ES ELECTROMOSKESZULEK MUVEK
JOHNSON MARK T
ROCHE DIAGNOSTICS OPERATIONS INC
UNIV MASSACHUSETTS
ROSEMAN BRUCE
UNIV WICHITA STATE
AEGION COATING SERVICES LLC
COLE MAURY D
WALTERS SARA
FISHER CONTROLS INT
CHOI SANG-JUN
ABRAHAM FRANK
SKYLINE BIOMEDICAL INC
WAKAMONO joint stock company
P P H POLMAR” DIONIZY SZCZERBA
WIRTGEN GMBH
SHANGHAI KOHLER ELECTRONICS
TROUP JOHN H
KOTZIN
WILLIAM SCHEPLER
JOHNSON RES CORP
KIMBERLY CLARK CO
AJINOMOTO KK
PORMEDTEC CO LTD
Query:
-- Query 2: Find patents assigned to DENSO CORP
SELECT t."publication_number", assignee.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."assignee_harmonized") assignee
WHERE assignee.value:"name"::STRING ILIKE '%DENSO CORP%'
LIMIT 100;
Answer:
publication_number,assignee_name
US-2023394418-A1,DENSO CORP
DE-10129321-A1,DENSO CORP
DE-102011004946-A1,DENSO CORP
US-2023207423-A1,DENSO CORP
WO-2021199555-A1,DENSO CORP
US-2004178870-A1,DENSO CORP
US-2006152215-A1,DENSO CORP
US-2008082260-A1,DENSO CORP
US-2008227599-A1,DENSO CORP
US-2005011063-A1,DENSO CORP JAPAN
US-2005099251-A1,DENSO CORP
WO-2019039129-A1,DENSO CORP
WO-2020250719-A1,DENSO CORP
WO-2024162212-A1,DENSO CORP
EP-1703109-A2,DENSO CORP
US-2007085197-A1,DENSO CORP
US-2008015772-A1,DENSO CORP
DE-102007000293-B4,DENSO CORP
US-2015131232-A1,DENSO CORP
US-2018013266-A1,DENSO CORP
US-2007044473-A1,DENSO CORP
US-10790774-B2,DENSO CORP
US-10674314-B2,DENSO CORP
US-2007246361-A1,DENSO CORP
US-11639192-B2,DENSO CORP
DE-102008003948-B4,DENSO CORP
DE-102011055563-B4,DENSO CORP
DE-112016001259-B4,DENSO CORP
US-2003122645-A1,DENSO CORP
US-2009266335-A1,DENSO CORP
US-2007200067-A1,DENSO CORP
WO-2022264738-A1,DENSO CORP
DE-102005051791-A1,DENSO CORP
DE-102007024898-A1,DENSO CORP
DE-102019101566-A1,DENSO CORP
US-2019386508-A1,DENSO CORP
US-2024204505-A1,DENSO CORP
EP-3694087-B1,DENSO CORP
US-10872603-B2,DENSO CORP
EP-1533154-A1,DENSO CORP
WO-2023054546-A1,DENSO CORP
DE-102012206067-B4,DENSO CORP
DE-102009000817-A1,DENSO CORP
US-2019092325-A1,DENSO CORP
US-2009082909-A1,DENSO CORP
US-2019152298-A1,DENSO CORP
US-2021017924-A1,DENSO CORP
US-2021041508-A1,DENSO CORP
US-2003127934-A1,DENSO CORP
US-2006006756-A1,DENSO CORP
US-2022402829-A1,DENSO CORP
EP-4108567-A1,DENSO CORP
US-10838052-B2,DENSO CORP
US-12049179-B2,DENSO CORP
US-2021261142-A1,DENSO CORP
US-2021325116-A1,DENSO CORP
US-2022028029-A1,DENSO CORP
US-2022190113-A1,DENSO CORP
WO-2016121380-A1,DENSO CORP
WO-2017163620-A1,DENSO CORP
WO-2021187040-A1,DENSO CORP
US-2021010842-A1,DENSO CORP
US-2020361416-A1,DENSO CORP
US-2007289384-A1,DENSO CORP
US-7568400-B2,DENSO CORP
WO-2020004161-A1,DENSO CORP
WO-2021033757-A1,DENSO CORP
DE-102014209298-B4,DENSO CORP
DE-102006000312-B4,DENSO CORP
DE-102013101681-B4,DENSO CORP
US-6178292-B1,DENSO CORP
US-6989627-B2,DENSO CORP
US-7980219-B2,DENSO CORP
US-8676437-B2,DENSO CORP
US-2010158316-A1,DENSO CORP
US-2012046808-A1,DENSO CORP
US-7397287-B2,DENSO CORP
DE-102009004384-A1,DENSO CORP
DE-102013105851-A1,DENSO CORP
DE-102021120645-A1,DENSO CORP
JP-2004191321-A,DENSO CORP
DE-69911567-T9,DENSO CORP
US-2005046395-A1,DENSO CORP
US-2005209755-A1,DENSO CORP
US-2006057953-A1,DENSO CORP
DE-112022002330-T5,DENSO CORP
JP-2005069878-A,DENSO CORP
JP-2006029279-A,DENSO CORP
JP-2009024674-A,DENSO CORP
JP-2010199436-A,DENSO CORP
JP-2010230654-A,DENSO CORP
JP-2015130098-A,DENSO CORP
JP-2017100226-A,DENSO CORP
JP-2017149346-A,DENSO CORP
JP-2019066047-A,DENSO CORP
US-2006090736-A1,DENSO CORP
US-2017352950-A1,DENSO CORP
US-2018050307-A1,DENSO CORP
US-2018006520-A1,DENSO CORP
US-7833876-B2,DENSO CORP
Query:
-- Query 3: Explore the structure of the "citation" field
SELECT t."publication_number", citation.value AS "citation_value"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."citation") citation
LIMIT 100;
Answer:
Too long, hard cut:
publication_number,citation_value
IT-MI20100845-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-1654188-A"",
  ""type"": ""YA""
}"
IT-MI20100845-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-2506292-A"",
  ""type"": ""XY""
}"
IT-MI20100845-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-4307918-A1"",
  ""type"": ""A""
}"
IT-MI20100845-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-19810417-A1"",
  ""type"": ""X""
}"
IT-MI20100845-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""WO-2008068591-A2"",
  ""type"": ""AD""
}"
IT-VI20090183-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""CH-326215-A"",
  ""type"": ""Y""
}"
IT-VI20090183-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-5134380-A"",
  ""type"": ""A""
}"
IT-VI20090183-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-5216409-A"",
  ""type"": ""XY""
}"
IT-VI20090183-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""US-5736637-A"",
  ""type"": ""Y""
}"
IT-VI20090183-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""EP-1411348-A1"",
  ""type"": ""A""
}"
IT-TO20100206-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-1580149-A1"",
  ""type"": ""X""
}"
IT-TO20100206-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-10252996-A1"",
  ""type"": ""X""
}"
IT-TO20100206-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""FR-2865440-A1"",
  ""type"": ""X""
}"
IT-TO20100206-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""DE-102004046678-A1"",
  ""type"": ""X""
}"
IT-TO20100206-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": """",
  ""publication_number"": ""FR-2895705-A1"",
  ""type"": ""X""
}"
IT-PZ20150004-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": ""ANGELO BRACALELLO ET AL: \""Design and Production of a Chimeric Resilin-, Elastin-, and Collagen-Like Engineered Polypeptide\"", BIOMACROMOLECULES, vol. 12, no. 8, 8 August 2011 (2011-08-08), US, pages 2957 - 2965, XP055236188, ISSN: 1525-7797, DOI: 10.1021/bm2005388"",
  ""publication_number"": """",
  ""type"": ""I""
}"
IT-PZ20150004-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": ""LINQING LI ET AL: \""Resilin-Based Materials for Biomedical Applications\"", ACS MACRO LETTERS / AMERICAN CHEMICAL SOCIETY, vol. 2, no. 8, 20 August 2013 (2013-08-20), Washington, US, pages 635 - 640, XP055236178, ISSN: 2161-1653, DOI: 10.1021/mz4002194"",
  ""publication_number"": """",
  ""type"": ""A""
}"
IT-PZ20150004-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": ""LINQING LI ET AL: \""Tunable Mechanical Stability and Deformation Response of a Resilin-Based Elastomer\"", BIOMACROMOLECULES, vol. 12, no. 6, 10 May 2011 (2011-05-10), US, pages 2302 - 2310, XP055235959, ISSN: 1525-7797, DOI: 10.1021/bm200373p"",
  ""publication_number"": """",
  ""type"": ""A""
}"
IT-PZ20150004-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": ""MARICA MARTINO ET AL: \""Biopolymers and biomaterials based on elastomeric proteins\"", MACROMOLECULAR BIOSCIENCE, vol. 2, no. 7, 1 October 2002 (2002-10-01), pages 319 - 328, XP055235941, ISSN: 1616-5187, DOI: 10.1002/1616-5195(200209)2:7<319::AID-MABI319>3.0.CO;2-L"",
  ""publication_number"": """",
  ""type"": ""A""
}"
IT-PZ20150004-A1,"{
  ""application_number"": """",
  ""category"": ""SEA"",
  ""filing_date"": 0,
  ""npl_text"": ""SBRANA F ET AL: \""Multiscale characterization of a chimeric biomimetic polypeptide for stem cell culture\"", BIOINSPIRATION & BIOMIMETICS, INSTITUTE OF PHYSICS PUBLISHING, BRISTOL, GB, vol. 7, no. 4, 24 August 2012 (2012-08-24), pages 46007, XP020235921, ISSN: 1748-3190, DOI: 10.1088/1748-3182/7/4/046007"",

Query:
-- Query 4: List patents and their citations
SELECT t."publication_number" AS "citing_patent_number",
       cited.value:"publication_number"::STRING AS "cited_publication_number"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."citation") cited
LIMIT 100;
Answer:
citing_patent_number,cited_publication_number
IT-MI20100845-A1,US-1654188-A
IT-MI20100845-A1,US-2506292-A
IT-MI20100845-A1,DE-4307918-A1
IT-MI20100845-A1,DE-19810417-A1
IT-MI20100845-A1,WO-2008068591-A2
IT-VI20090183-A1,CH-326215-A
IT-VI20090183-A1,US-5134380-A
IT-VI20090183-A1,US-5216409-A
IT-VI20090183-A1,US-5736637-A
IT-VI20090183-A1,EP-1411348-A1
IT-TO20100206-A1,DE-1580149-A1
IT-TO20100206-A1,DE-10252996-A1
IT-TO20100206-A1,FR-2865440-A1
IT-TO20100206-A1,DE-102004046678-A1
IT-TO20100206-A1,FR-2895705-A1
IT-PZ20150004-A1,
IT-PZ20150004-A1,
IT-PZ20150004-A1,
IT-PZ20150004-A1,
IT-PZ20150004-A1,
IT-UA20161603-A1,AU-551882-B2
IT-UA20161603-A1,EP-1881576-A1
IT-UA20161603-A1,GB-2465609-A
IT-UA20161603-A1,US-2013029541-A1
IT-UA20161603-A1,DE-102013101120-A1
IT-UA20161603-A1,US-2015200530-A1
IT-BO20080517-A1,DE-3030931-A1
IT-BO20080517-A1,US-5467567-A
IT-BO20080517-A1,US-5572847-A
IT-BO20080517-A1,EP-0744497-A1
IT-BO20080517-A1,DE-19732904-A1
IT-BO20080517-A1,EP-1072726-A1
IT-BO20080731-A1,FR-2781409-A1
IT-BO20080731-A1,US-2002158357-A1
IT-UB20160960-A1,US-6481795-B1
IT-UB20160960-A1,US-2009230743-A1
IT-UB20160960-A1,EP-2653196-A2
IT-UB20160960-A1,WO-2014085732-A1
IT-TO20090280-A1,DE-1238299-B
IT-TO20090280-A1,US-3358522-A
IT-TO20090280-A1,US-5083984-A
IT-TO20090280-A1,US-5277667-A
IT-TO20090280-A1,GB-2348262-A
IT-UB20160584-A1,US-668479-A
IT-UB20160584-A1,US-968952-A
IT-UB20160584-A1,US-1043743-A
IT-UB20160584-A1,US-1305661-A
IT-MI20101275-A1,DE-1034672-B
IT-MI20101275-A1,US-3630639-A
IT-MI20101275-A1,EP-0039977-A1
IT-MI20101275-A1,US-2005092392-A1
IT-MI20101275-A1,DE-10362075-A1
IT-MI20101275-A1,WO-2010028852-A2
IT-VA20090003-A1,EP-0737566-A1
IT-VA20090003-A1,WO-0043272-A1
IT-VA20090003-A1,WO-2004087527-A1
IT-VA20090003-A1,EP-1619137-A1
IT-VA20090003-A1,WO-2008086388-A1
IT-VA20090003-A1,DE-202008009634-U1
IT-RM20080370-A1,US-3406618-A
IT-RM20080370-A1,US-4131406-A
IT-RM20080370-A1,US-4231677-A
IT-RM20080370-A1,US-5033906-A
IT-RM20080370-A1,WO-0066857-A1
IT-RM20080370-A1,US-6595768-B1
IT-TV20130044-A1,US-5144899-A
IT-TV20130044-A1,JP-H05272046-A
IT-TV20130044-A1,WO-2004058415-A1
IT-TV20130044-A1,US-2004221780-A1
IT-TV20130044-A1,US-2005178309-A1
IT-TV20130044-A1,US-6957614-B1
IT-TV20130044-A1,US-2011297062-A1
IT-MI20091791-A1,WO-9822370-A1
IT-MI20091791-A1,US-6182823-B1
IT-MI20091791-A1,JP-2002059987-A
IT-MI20091791-A1,WO-0221531-A1
IT-MI20091791-A1,JP-2002345740-A
IT-MI20091791-A1,DE-20216034-U1
IT-MI20091791-A1,JP-2004352365-A
IT-MI20091791-A1,DE-10323914-A1
IT-MI20091791-A1,JP-2007112473-A
IT-MI20091791-A1,US-2008135430-A1
IT-UB20160009-A1,US-4168924-A
IT-UB20160009-A1,US-4288956-A
IT-UB20160009-A1,EP-0059466-A1
IT-UB20160009-A1,DE-3102120-A1
IT-UB20160009-A1,DE-3445187-A1
IT-UB20160009-A1,WO-9316247-A1
AT-514400-A1,DE-10149649-A1
AT-514400-A1,WO-2011024177-A1
CH-712732-A1,EP-0507299-A2
CH-712732-A1,US-5640508-A
CH-712732-A1,US-2004199817-A1
CH-712732-A1,US-2010287421-A1
CH-712732-A1,
FR-2894722-A1,GB-1247790-A
FR-2894722-A1,EP-0059939-A1
FR-2894722-A1,DE-3413740-A1
FR-2894722-A1,EP-0802580-A1
FR-2894722-A1,WO-03005491-A1
Query:
SELECT
    t."publication_number" AS "citing_patent_number",
    'US1234567' AS "cited_publication_number"
FROM
    PATENTS.PATENTS.PUBLICATIONS t
WHERE
    EXISTS (
        SELECT 1
        FROM TABLE(FLATTEN(INPUT => t."citation")) AS f
        WHERE f.value:"publication_number"::STRING = 'US1234567'
    )
LIMIT 100;
Answer:
000603 (XX000): 01b9f218-0004-7d15-0001-11c300fa2ef2: SQL execution internal error:
Processing aborted due to error 370001:1309815285; incident 1005725.Query:
-- Query 6: Extract CPC codes for patents
SELECT t."publication_number", cpc_code.value:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."cpc") cpc_code
LIMIT 100;
Answer:
publication_number,cpc_code
US-2004046148-A1,C23F1/26
US-2004046148-A1,H01L21/3212
US-2004046148-A1,C23F3/06
US-2004046148-A1,H01L21/32134
US-2004046148-A1,C23F3/06
US-2004046148-A1,C09G1/02
US-2004046148-A1,H01L21/32115
US-2004046148-A1,C23F3/04
US-2004046148-A1,C23F1/18
US-2004046148-A1,C09G1/02
US-2004046148-A1,C23F3/06
US-2004046148-A1,H01L21/32115
US-2004046148-A1,H01L21/3212
US-2004046148-A1,C23F1/18
US-2004046148-A1,C23F3/04
US-2004046148-A1,H01L21/32134
US-2004249430-A1,A61N1/05
US-2004249430-A1,A61N1/05
US-2004249430-A1,A61N1/056
US-2004249430-A1,A61N1/056
US-2004254481-A1,A61B7/04
US-2004254481-A1,A61B5/318
US-2004254481-A1,A61B7/04
US-2004254481-A1,A61B5/0816
US-2004254481-A1,A61B5/0816
US-2004254481-A1,A61B5/318
US-2004179568-A1,H01S5/0421
US-2004179568-A1,H01S5/3095
US-2004179568-A1,H01S5/3072
US-2004179568-A1,H01S5/02476
US-2004179568-A1,H01S5/0217
US-2004179568-A1,H01S5/18308
US-2004179568-A1,H01S5/18375
US-2004179568-A1,H01S5/18377
US-2004179568-A1,H01S5/04253
US-2004179568-A1,H01S5/04252
US-2004179568-A1,H01S5/18369
US-2004179568-A1,H01S5/18375
US-2004179568-A1,H01S5/18369
US-2004179568-A1,H01S5/18308
US-2004179568-A1,H01S5/0217
US-2004179568-A1,H01S5/3072
US-2004179568-A1,H01S5/02476
US-2004179568-A1,H01S5/18377
US-2004179568-A1,H01S5/0421
US-2004179568-A1,H01S5/3095
US-2004179568-A1,H01S5/04253
US-2004179568-A1,H01S5/04252
US-2004179568-A1,H01S5/18375
US-2004179568-A1,H01S5/3095
US-2004179568-A1,H01S5/18377
US-2004179568-A1,H01S5/02476
US-2004179568-A1,H01S5/0217
US-2004179568-A1,H01S5/18369
US-2004179568-A1,H01S5/18308
US-2004179568-A1,H01S5/0421
US-2004179568-A1,H01S5/3072
US-2004179568-A1,H01S5/04253
US-2004250894-A1,B27L7/00
US-2004250894-A1,B27L7/005
US-2004250894-A1,B27L7/00
US-2004250894-A1,B27L7/005
US-2005110223-A1,F16J15/0825
US-2005110223-A1,F16J15/0825
US-2005031765-A1,A23L7/126
US-2005031765-A1,A23L7/115
US-2005031765-A1,A23L7/126
US-2005031765-A1,A23L7/115
US-2005012526-A1,H03F3/45748
US-2005012526-A1,H03F2203/30015
US-2005012526-A1,H03F3/45179
US-2005012526-A1,H03F3/45941
US-2005012526-A1,H03F3/45941
US-2005012526-A1,H03F2203/45681
US-2005012526-A1,H03F2203/45292
US-2005012526-A1,H03F2203/30015
US-2005012526-A1,H03F2203/45082
US-2005012526-A1,H03F2203/45008
US-2005012526-A1,H03F3/45179
US-2005012526-A1,H03F3/45748
US-2005012526-A1,H03F3/3022
US-2005012526-A1,H03F2203/45082
US-2005012526-A1,H03F2203/45292
US-2005012526-A1,H03F2203/45008
US-2005012526-A1,H03F3/3022
US-2005012526-A1,H03F2203/45681
US-2006088579-A1,A61K47/12
US-2006088579-A1,A61K9/0014
US-2006088579-A1,A61K47/12
US-2006088579-A1,A61K47/22
US-2006088579-A1,A61K47/14
US-2006088579-A1,A61K47/10
US-2006088579-A1,A61K47/06
US-2006088579-A1,A61K47/14
US-2006088579-A1,A61K9/1075
US-2006088579-A1,A61K47/22
US-2006088579-A1,A61K9/1075
US-2006088579-A1,A61K47/06
US-2006088579-A1,A61K9/0014
US-2006088579-A1,A61K47/10
Query:
-- Query 7: Extract primary CPC codes (where "first" is true)
SELECT t."publication_number", cpc_code.value:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t,
LATERAL FLATTEN(input => t."cpc") cpc_code
WHERE cpc_code.value:"first"::BOOLEAN = TRUE
LIMIT 100;
Answer:
publication_number,cpc_code
US-2006215095-A1,G02F1/133788
US-2006215095-A1,G02F1/133788
US-2005219871-A1,H02M1/4225
US-2005219871-A1,H02M1/4225
US-2006225070-A1,G06F8/60
US-2006225070-A1,G06F8/60
US-2006223426-A1,B24B57/02
US-2006223426-A1,B24B57/02
US-2005282283-A1,C12N15/87
US-2005282283-A1,C12N15/87
US-2005191701-A1,C12N9/1007
US-2005191701-A1,C12N9/1007
US-2006250589-A1,G03F1/36
US-2006250589-A1,G03F1/36
US-2006133105-A1,H04Q9/04
US-2006133105-A1,G08C23/04
US-2006133105-A1,G08C23/04
US-2006264190-A1,H04B1/04
US-2006264190-A1,H04B1/04
US-2006272652-A1,G16H50/50
US-2006272652-A1,G16H50/50
US-2006280400-A1,G02B5/20
US-2006280400-A1,G02B6/29365
US-2006280400-A1,G02B6/29365
US-2005244554-A1,A01K15/026
US-2005244554-A1,A01K15/026
US-2006089742-A1,G05B19/4065
US-2006089742-A1,G05B19/4065
US-2006088772-A1,G03F1/20
US-2006088772-A1,G03F1/20
US-2005236657-A1,G11C29/50
US-2005236657-A1,G11C29/50
US-2006006745-A1,H02K21/16
US-2006006745-A1,H02K21/16
US-2007010420-A1,A01N37/44
US-2007010420-A1,A23B4/20
US-2006001827-A1,G02C5/001
US-2006001827-A1,G02C5/001
US-2006019148-A1,C01G37/027
US-2006019148-A1,C01G37/027
US-2006019148-A1,H01M8/10
US-2006023399-A1,B32B18/00
US-2006023399-A1,B32B18/00
US-2006029199-A1,H04M3/53333
US-2006029199-A1,H04M3/53333
US-2005275346-A1,H05B33/04
US-2005275346-A1,H10K50/125
US-2005275346-A1,H10K50/858
US-2005274394-A1,B32B7/12
US-2005274394-A1,B32B7/12
US-2006047298-A1,A61B5/037
US-2006047298-A1,A61B5/037
US-2006049749-A1,H10K50/854
US-2006049749-A1,H05B33/22
US-2007055408-A1,H02J3/06
US-2007055408-A1,H02J3/06
US-2006057776-A1,H01L23/3128
US-2006057776-A1,H01L23/3128
US-2007061156-A1,G06Q99/00
US-2007061156-A1,G06Q99/00
US-2006020170-A1,A61N5/1001
US-2006020170-A1,A61N5/1001
US-2006015009-A1,A61B1/00154
US-2006015009-A1,A61B1/00154
US-2006069023-A1,C12N15/8509
US-2006069023-A1,C12N15/8509
US-2007089984-A1,C23C14/3414
US-2007089984-A1,B22F3/15
US-2007089984-A1,C23C14/3414
US-2006106467-A1,F02D11/105
US-2006106467-A1,F02D11/105
US-2007095595-A1,B60R21/01516
US-2007095595-A1,B60R21/01516
US-2007095595-A1,B60R21/01516
US-2006120791-A1,B41J11/009
US-2006120791-A1,B41J11/009
US-2006068001-A1,A61K9/1652
US-2006068001-A1,A61K9/1652
US-2006115184-A1,H04N1/3935
US-2006115184-A1,G06T3/403
US-2006115184-A1,H04N1/3935
US-2006120084-A1,G03B21/16
US-2006120084-A1,G03B21/16
US-2006148712-A1,G01N33/5094
US-2006148712-A1,G01N33/5094
US-2006123024-A1,H04L61/4523
US-2006123024-A1,G06F16/285
US-2006131447-A1,F02M61/08
US-2006131447-A1,F02M61/08
US-2006136401-A1,G06F9/44521
US-2006136401-A1,G06F9/44521
US-2006135276-A1,A63B69/3688
US-2006135276-A1,A63B69/3688
US-2007296592-A1,G06K19/07749
US-2007296592-A1,G06K19/07749
US-2007142872-A1,A61N1/3787
US-2007142872-A1,A61N1/3787
US-2006155443-A1,E01C11/265
US-2006155443-A1,E01C11/265
US-2006160812-A1,C07C243/22
Query:
SELECT DISTINCT cpc_data."cpc_code", d."titleFull" AS "cpc_title"
FROM (
    SELECT cpc_code.value:"code"::STRING AS "cpc_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    CROSS JOIN LATERAL FLATTEN(input => t."cpc") cpc_code
) AS cpc_data
LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION d
  ON d."symbol" = cpc_data."cpc_code"
LIMIT 100;
Answer:
Too long, hard cut:
cpc_code,cpc_title
C09J2301/308,"Additional features of adhesives in the form of films or foils characterized by the chemical, physicochemical or physical properties of the adhesive or the carrier the adhesive tape or sheet losing adhesive strength when being stretched, e.g. stretch adhesive"
G03F7/423,"Stripping or agents therefor using liquids only containing mineral acids or salts thereof, containing mineral oxidizing substances, e.g. peroxy compounds"
A61P1/16,"Drugs for disorders of the alimentary tract or the digestive system for liver or gallbladder disorders, e.g. hepatoprotective agents, cholagogues, litholytics"
Y02E10/52,PV systems with concentrators
B26D7/2628,Means for adjusting the position of the cutting member
A24F5/04,Bowls for pipes with holes for admitting air
H01L2224/48227,"Connecting between a semiconductor or solid-state body and an item not being a semiconductor or solid-state body, e.g. chip-to-substrate, chip-to-passive the body and the item being stacked the item being non-metallic, e.g. insulating substrate with or without metallisation connecting the wire to a bond pad of the item"
A63F13/12,
G06F13/4027,Coupling between buses using bus bridges
A61P9/06,Antiarrhythmics
H01L21/02129,"Forming insulating materials on a substrate characterised by the type of layer, e.g. type of material, porous/non-porous, pre-cursors, mixtures or laminates characterised by the material of the layer the material containing silicon the material containing Si, O, and at least one of H, N, C, F, or other non-metal elements, e.g. SiOC, SiOC:H or SiONC the material being boron or phosphorus doped silicon oxides, e.g. BPSG, BSG or PSG"
H01L2224/73253,Bump and layer connectors
H04L67/06,"Protocols specially adapted for file transfer, e.g. file transfer protocol [FTP]"
A61B17/7037,"Screws or hooks, wherein a rod-clamping part and a bone-anchoring part can pivot relative to each other wherein pivoting is blocked when the rod is clamped"
A61B17/7032,Screws or hooks with U-shaped head or back through which longitudinal rods pass
G06V10/75,"Organisation of the matching processes, e.g. simultaneous or sequential comparisons of image or video features; Coarse-fine approaches, e.g. multi-scale approaches; using context analysis; Selection of dictionaries"
G06F16/48,"Retrieval characterised by using metadata, e.g. metadata not derived from the content or metadata generated manually"
G02F1/1368,Active matrix addressed cells in which the switching element is a three-electrode device
G03G15/0877,Arrangements for metering and dispensing developer from a developer cartridge into the development unit
F05D2260/602,Drainage
A61K31/496,"Non-condensed piperazines containing further heterocyclic rings, e.g. rifampin, thiothixene or sparfloxacin"
F21S2/00,"Systems of lighting devices, not provided for in main groups F21S4/00 - F21S10/00 or F21S19/00, e.g. of modular construction"
G09G5/008,Clock recovery
A22B5/208,Band saws
C09D11/30,Inkjet printing inks
G09G2370/06,"Consumer Electronics Control, i.e. control of another device by a display or vice versa"
B32B2250/24,All layers being polymeric
C03C17/3618,"Coatings of type glass/inorganic compound/other inorganic layers, at least one layer being metallic"
B01J2219/00833,Plastic
A61L27/507,"Materials characterised by their function or physical properties, e.g. injectable or lubricating compositions, shape-memory materials, surface modified materials for artificial blood vessels"
G02B6/0045,Means for improving the coupling-out of light from the light guide provided on the surface of the light guide or in the bulk of it by shaping at least a portion of the light guide
H01L2924/00013,Fully indexed content
C07D333/18,Radicals substituted by singly bound hetero atoms other than halogen by sulfur atoms
H04L51/23,"Reliability checks, e.g. acknowledgments or fault reporting"
H04N1/00519,"Constructional details not otherwise provided for, e.g. housings, covers"
G08B31/00,Predictive alarm systems characterised by extrapolation or other computation using updated historic data
C08L2205/03,Polymer mixtures characterised by other features containing three or more polymers in a blend
H01L2924/01019,Potassium [K]
C09D7/43,Thickening agents
B29C45/14811,Multilayered articles
F16C33/102,Construction relative to lubrication with grease as lubricant
B60W10/22,Conjoint control of vehicle sub-units of different type or different function including control of suspension systems
C10J2300/0946,"Waste, e.g. MSW, tires, glass, tar sand, peat, paper, lignite, oil shale"
C07C51/412,"Preparation of salts of carboxylic acids by conversion of the acids, their salts, esters or anhydrides with the same carboxylic acid part"
B41J2/04588,"Control methods or devices therefor, e.g. driver circuits, control circuits using a specific waveform"
C02F2307/02,Location of water treatment or water treatment device as part of a bottle
A61B17/320783,"Atherectomy devices working by cutting or abrading; Similar devices speciall
Query:
-- Query 9: List CPC definitions for subclasses (codes with length 4)
SELECT d."symbol" AS "cpc_code", d."titleFull" AS "cpc_title"
FROM PATENTS.PATENTS.CPC_DEFINITION d
WHERE LENGTH(d."symbol") = 4
LIMIT 100
Answer:
Too long, hard cut:
cpc_code,cpc_title
A01H,NEW PLANTS OR NON-TRANSGENIC PROCESSES FOR OBTAINING THEM; PLANT REPRODUCTION BY TISSUE CULTURE TECHNIQUES
A01F,PROCESSING OF HARVESTED PRODUCE; HAY OR STRAW PRESSES; DEVICES FOR STORING AGRICULTURAL OR HORTICULTURAL PRODUCE
A01C,PLANTING; SOWING; FERTILISING
A01G,"HORTICULTURE; CULTIVATION OF VEGETABLES, FLOWERS, RICE, FRUIT, VINES, HOPS OR SEAWEED; FORESTRY; WATERING"
A01N,"PRESERVATION OF BODIES OF HUMANS OR ANIMALS OR PLANTS OR PARTS THEREOF; BIOCIDES, e.g. AS DISINFECTANTS, AS PESTICIDES OR AS HERBICIDES; PEST REPELLANTS OR ATTRACTANTS; PLANT GROWTH REGULATORS"
A01P,"BIOCIDAL, PEST REPELLANT, PEST ATTRACTANT OR PLANT GROWTH REGULATORY ACTIVITY OF CHEMICAL COMPOUNDS OR PREPARATIONS"
A01D,HARVESTING; MOWING
A01L,SHOEING OF ANIMALS
A01K,"ANIMAL HUSBANDRY; AVICULTURE; APICULTURE; PISCICULTURE; FISHING; REARING OR BREEDING ANIMALS, NOT OTHERWISE PROVIDED FOR; NEW BREEDS OF ANIMALS"
A01M,"CATCHING, TRAPPING OR SCARING OF ANIMALS; APPARATUS FOR THE DESTRUCTION OF NOXIOUS ANIMALS OR NOXIOUS PLANTS"
A01J,MANUFACTURE OF DAIRY PRODUCTS
A01B,"SOIL WORKING IN AGRICULTURE OR FORESTRY; PARTS, DETAILS, OR ACCESSORIES OF AGRICULTURAL MACHINES OR IMPLEMENTS, IN GENERAL"
A21D,"TREATMENT, e.g. PRESERVATION, OF FLOUR OR DOUGH, e.g. BY ADDITION OF MATERIALS; BAKING; BAKERY PRODUCTS; PRESERVATION THEREOF"
A21C,MACHINES OR EQUIPMENT FOR MAKING OR PROCESSING DOUGHS; HANDLING BAKED ARTICLES MADE FROM DOUGH
A21B,BAKERS' OVENS; MACHINES OR EQUIPMENT FOR BAKING
A22B,SLAUGHTERING
A22C,"PROCESSING MEAT, POULTRY, OR FISH"
A23P,"SHAPING OR WORKING OF FOODSTUFFS, NOT FULLY COVERED BY A SINGLE OTHER SUBCLASS"
A23C,"DAIRY PRODUCTS, e.g. MILK, BUTTER OR CHEESE; MILK OR CHEESE SUBSTITUTES; MAKING THEREOF"
A23J,PROTEIN COMPOSITIONS FOR FOODSTUFFS; WORKING-UP PROTEINS FOR FOODSTUFFS; PHOSPHATIDE COMPOSITIONS FOR FOODSTUFFS
A23K,FODDER
A23L,"FOODS, FOODSTUFFS, OR NON-ALCOHOLIC BEVERAGES, NOT COVERED BY SUBCLASSES A21D OR A23B-A23J; THEIR PREPARATION OR TREATMENT, e.g. COOKING, MODIFICATION OF NUTRITIVE QUALITIES, PHYSICAL TREATMENT; PRESERVATION OF FOODS OR FOODSTUFFS, IN GENERAL"
A23N,"MACHINES OR APPARATUS FOR TREATING HARVESTED FRUIT, VEGETABLES OR FLOWER BULBS IN BULK, NOT OTHERWISE PROVIDED FOR; PEELING VEGETABLES OR FRUIT IN BULK; APPARATUS FOR PREPARING ANIMAL FEEDING- STUFFS"
A23V,"INDEXING SCHEME RELATING TO FOODS, FOODSTUFFS OR NON-ALCOHOLIC BEVERAGES AND LACTIC OR PROPIONIC ACID BACTERIA USED IN FOODSTUFFS OR FOOD PREPARATION"
A23F,"COFFEE; TEA; THEIR SUBSTITUTES; MANUFACTURE, PREPARATION, OR INFUSION THEREOF"
A23G,"COCOA; COCOA PRODUCTS, e.g. CHOCOLATE; SUBSTITUTES FOR COCOA OR COCOA PRODUCTS; CONFECTIONERY; CHEWING GUM; ICE-CREAM; PREPARATION THEREOF"
A23B,"PRESERVING, e.g. BY CANNING, MEAT, FISH, EGGS, FRUIT, VEGETABLES, EDIBLE SEEDS; CHEMICAL RIPENING OF FRUIT OR VEGETABLES; THE PRESERVED, RIPENED, OR CANNED PRODUCTS"
A23D,"EDIBLE OILS OR FATS, e.g. MARGARINES, SHORTENINGS, COOKING OILS"
A24C,MACHINES FOR MAKING CIGARS OR CIGARETTES
A24D,CIGARS; CIGARETTES; TOBACCO SMOKE FILTERS; MOUTHPIECES FOR CIGARS OR CIGARETTES; MANUFACTURE OF TOBACCO SMOKE FILTERS OR MOUTHPIECES
A24F,SMOKERS' REQUISITES; MATCH BOXES; SIMULATED SMOKING DEVICES
A24B,MANUFACTURE OR PREPARATION OF TOBACCO FOR SMOKING OR CHEWING; TOBACCO; SNUFF
A41F,GARMENT FASTENINGS; SUSPENDERS
A41G,ARTIFICIAL FLOWERS; WIGS; MASKS; FEATHERS
A41B,SHIRTS; UNDERWEAR; BABY LINEN; HANDKERCHIEFS
A41D,OUTERWEAR; PROTECTIVE GARMENTS; ACCESSORIES
A41C,CORSETS; BRASSIERES
A41H,"APPLIANCES OR METHODS FOR MAKING CLOTHES, e.g. FOR DRESS-MAKING OR FOR TAILORING, NOT OTHERWISE PROVIDED FOR"
A42B,HATS; HEAD COVERINGS
A42C,"MANUFACTURING OR TRIMMING HEAD COVERINGS, e.g. HATS"
A43B,CHARACTERISTIC FEATURES OF FOOTWEAR; PARTS OF FOOTWEAR
A43C,FASTENINGS OR ATTACHMENTS OF FOOTWEAR; LACES IN GENERAL
A43D,"MACHINES, TOOLS, EQUIPMENT OR METHODS FOR MANUFACTURING OR REPAIRING FOOTWEAR"
A44D,"INDEXING SCHEME RELATING TO BUTTONS, PINS, BUCKLES OR SLIDE FASTENERS, AND TO JEWELLERY, BRACELETS OR OTHER PERSONAL ADORNMENTS"
A44B,"BUTTONS, PINS, BUCKLES, SLIDE FASTENERS, OR THE LIKE"
A44C,"PERSONAL ADORNMENTS, e.g. JEWELLERY; COINS"
A45F,TRAVELLING OR CAMP EQUIPMENT: SACKS OR PACKS CARRIED ON THE BODY
A45C,PURSES; LUGGAGE; HAND CARRIED BAGS
A45D,"HAIRDRESSING OR SHAVING EQUIPMENT; EQUIPMENT FOR COSMETICS OR COSMETIC TREATMENTS, e.g. FOR MANICURING OR PEDICURING"
A45B,WALKING STICKS; UMBRELLAS; LADIES' OR LIKE FANS
A46D,MANUFACTURE OF BRUSHES
A46B,BRUSHES
A47L,DOMESTIC WASHING OR CLEANING; SUCTION CLEANERS IN GENERAL
A47F,"SPECIAL FURNITURE, FITTINGS, OR ACCESSORIES FOR SHOPS, STOREHOUSES, BARS, RESTAURANTS OR THE LIKE; PAYING COUNTERS"
A47D,FURNITURE SPECIALLY ADAPTED FOR CHILDREN
A47G,HOUSEHOLD OR TABLE EQUIPMENT
A47K,SANITARY EQUIPMENT NOT OTHERWISE PROVIDED FOR; TOILET ACCESSORIES
A47H,FURNISHINGS FOR WINDOWS OR DOORS
A47B,TABLES; DESKS; OFFICE FURNITURE; CABINETS; DRAWERS; GENERAL DETAILS OF FURNITURE
A47C,CHAIRS; SOFAS; BEDS
A47J,KITCHEN EQUIPMENT; COFFEE MILLS; SPICE MILLS; AP
Query:
-- Query 10: Extract the CPC subclass (first 4 characters) for patents
SELECT t."publication_number",
       SUBSTR(cpc_code.value:"code"::STRING, 1, 4) AS "cpc_subclass"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."cpc") AS cpc_code
LIMIT 100
Answer:
publication_number,cpc_subclass
US-2006215095-A1,G02F
US-2006215095-A1,G02F
US-2006215095-A1,G02F
US-2006215095-A1,G02F
US-2006215095-A1,G02F
US-2006215095-A1,G02F
US-2006215095-A1,G02F
US-2006215095-A1,G02F
US-2005219871-A1,H02M
US-2005219871-A1,H02M
US-2005219871-A1,H02M
US-2005219871-A1,H02M
US-2005219871-A1,Y02B
US-2005219871-A1,Y02P
US-2005219871-A1,Y02P
US-2005219871-A1,Y02B
US-2006225070-A1,G06F
US-2006225070-A1,G06F
US-2006223426-A1,B24B
US-2006223426-A1,B24B
US-2005282283-A1,C12N
US-2005282283-A1,C12N
US-2005282283-A1,C12M
US-2005282283-A1,C12M
US-2005282283-A1,C12M
US-2005282283-A1,C12M
US-2005191701-A1,C12N
US-2005191701-A1,C12N
US-2006250589-A1,G03F
US-2006250589-A1,G05B
US-2006250589-A1,G03F
US-2006250589-A1,G05B
US-2006250589-A1,G03F
US-2006133105-A1,F21V
US-2006133105-A1,H04N
US-2006133105-A1,H04N
US-2006133105-A1,H04Q
US-2006133105-A1,F21V
US-2006133105-A1,H04N
US-2006133105-A1,H04N
US-2006133105-A1,H04N
US-2006133105-A1,H04N
US-2006133105-A1,F21L
US-2006133105-A1,H04N
US-2006133105-A1,H04N
US-2006133105-A1,G08C
US-2006133105-A1,G08C
US-2006133105-A1,F21L
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H04B
US-2006264190-A1,H04B
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H04B
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H04B
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006264190-A1,H03F
US-2006272652-A1,G16H
US-2006272652-A1,G16H
US-2006280400-A1,G02B
US-2006280400-A1,G02B
US-2006280400-A1,G02B
US-2006280400-A1,G02B
US-2006280400-A1,H04J
US-2006280400-A1,G02B
US-2006280400-A1,G02B
US-2006280400-A1,G02B
US-2006280400-A1,G02B
US-2006280400-A1,G02B
US-2006280400-A1,G02B
US-2006280400-A1,G02B
US-2006280400-A1,H04J
US-2006280400-A1,H04J
US-2005244554-A1,A23K
US-2005244554-A1,A01K
US-2005244554-A1,A23K
US-2005244554-A1,A23K
US-2005244554-A1,A23K
US-2005244554-A1,A01K
US-2005244554-A1,A23K
US-2005244554-A1,A23K
US-2005244554-A1,A23K
US-2005244554-A1,A23K
US-2006089742-A1,G05B
US-2006089742-A1,G05B
US-2006088772-A1,G03F
US-2006088772-A1,G03F
Query:
-- Query 11: Join citing patents with their assignees and CPC subclasses
SELECT t."publication_number" AS "citing_patent_number",
       assignee.value:"name"::STRING AS "citing_assignee_name",
       SUBSTR(cpc_code.value:"code"::STRING, 1, 4) AS "cpc_subclass"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."assignee_harmonized") AS assignee
CROSS JOIN LATERAL FLATTEN(input => t."cpc") AS cpc_code
LIMIT 100
Answer:
citing_patent_number,citing_assignee_name,cpc_subclass
US-2006215095-A1,LIU QIN,G02F
US-2006215095-A1,LIU QIN,G02F
US-2006215095-A1,LIU QIN,G02F
US-2006215095-A1,LIU QIN,G02F
US-2006215095-A1,LIU QIN,G02F
US-2006215095-A1,LIU QIN,G02F
US-2006215095-A1,LIU QIN,G02F
US-2006215095-A1,LIU QIN,G02F
US-2006215095-A1,NELSON CURT L,G02F
US-2006215095-A1,NELSON CURT L,G02F
US-2006215095-A1,NELSON CURT L,G02F
US-2006215095-A1,NELSON CURT L,G02F
US-2006215095-A1,NELSON CURT L,G02F
US-2006215095-A1,NELSON CURT L,G02F
US-2006215095-A1,NELSON CURT L,G02F
US-2006215095-A1,NELSON CURT L,G02F
US-2006215095-A1,COMBS GREGG,G02F
US-2006215095-A1,COMBS GREGG,G02F
US-2006215095-A1,COMBS GREGG,G02F
US-2006215095-A1,COMBS GREGG,G02F
US-2006215095-A1,COMBS GREGG,G02F
US-2006215095-A1,COMBS GREGG,G02F
US-2006215095-A1,COMBS GREGG,G02F
US-2006215095-A1,COMBS GREGG,G02F
US-2005219871-A1,LI HONG-CHUN,H02M
US-2005219871-A1,LI HONG-CHUN,H02M
US-2005219871-A1,LI HONG-CHUN,H02M
US-2005219871-A1,LI HONG-CHUN,H02M
US-2005219871-A1,LI HONG-CHUN,Y02B
US-2005219871-A1,LI HONG-CHUN,Y02P
US-2005219871-A1,LI HONG-CHUN,Y02P
US-2005219871-A1,LI HONG-CHUN,Y02B
US-2005219871-A1,TSAY CHEAN-LUNG,H02M
US-2005219871-A1,TSAY CHEAN-LUNG,H02M
US-2005219871-A1,TSAY CHEAN-LUNG,H02M
US-2005219871-A1,TSAY CHEAN-LUNG,H02M
US-2005219871-A1,TSAY CHEAN-LUNG,Y02B
US-2005219871-A1,TSAY CHEAN-LUNG,Y02P
US-2005219871-A1,TSAY CHEAN-LUNG,Y02P
US-2005219871-A1,TSAY CHEAN-LUNG,Y02B
US-2005219871-A1,CHEN DAN,H02M
US-2005219871-A1,CHEN DAN,H02M
US-2005219871-A1,CHEN DAN,H02M
US-2005219871-A1,CHEN DAN,H02M
US-2005219871-A1,CHEN DAN,Y02B
US-2005219871-A1,CHEN DAN,Y02P
US-2005219871-A1,CHEN DAN,Y02P
US-2005219871-A1,CHEN DAN,Y02B
US-2006225070-A1,IBM,G06F
US-2006225070-A1,IBM,G06F
US-2006223426-A1,GUTHRIE HUNG-CHIN,B24B
US-2006223426-A1,GUTHRIE HUNG-CHIN,B24B
US-2006223426-A1,NYSTROM JAMES C,B24B
US-2006223426-A1,NYSTROM JAMES C,B24B
US-2005282283-A1,VOZZA-BROWN LAURA,C12N
US-2005282283-A1,VOZZA-BROWN LAURA,C12N
US-2005282283-A1,VOZZA-BROWN LAURA,C12M
US-2005282283-A1,VOZZA-BROWN LAURA,C12M
US-2005282283-A1,VOZZA-BROWN LAURA,C12M
US-2005282283-A1,VOZZA-BROWN LAURA,C12M
US-2005282283-A1,YIM HARRY,C12N
US-2005282283-A1,YIM HARRY,C12N
US-2005282283-A1,YIM HARRY,C12M
US-2005282283-A1,YIM HARRY,C12M
US-2005282283-A1,YIM HARRY,C12M
US-2005282283-A1,YIM HARRY,C12M
US-2005282283-A1,CAMERON JOHN,C12N
US-2005282283-A1,CAMERON JOHN,C12N
US-2005282283-A1,CAMERON JOHN,C12M
US-2005282283-A1,CAMERON JOHN,C12M
US-2005282283-A1,CAMERON JOHN,C12M
US-2005282283-A1,CAMERON JOHN,C12M
US-2005282283-A1,O'BANION MATTHEW,C12N
US-2005282283-A1,O'BANION MATTHEW,C12N
US-2005282283-A1,O'BANION MATTHEW,C12M
US-2005282283-A1,O'BANION MATTHEW,C12M
US-2005282283-A1,O'BANION MATTHEW,C12M
US-2005282283-A1,O'BANION MATTHEW,C12M
US-2005282283-A1,HENRY ADAM S,C12N
US-2005282283-A1,HENRY ADAM S,C12N
US-2005282283-A1,HENRY ADAM S,C12M
US-2005282283-A1,HENRY ADAM S,C12M
US-2005282283-A1,HENRY ADAM S,C12M
US-2005282283-A1,HENRY ADAM S,C12M
US-2005282283-A1,OLIVIER LISA M,C12N
US-2005282283-A1,OLIVIER LISA M,C12N
US-2005282283-A1,OLIVIER LISA M,C12M
US-2005282283-A1,OLIVIER LISA M,C12M
US-2005282283-A1,OLIVIER LISA M,C12M
US-2005282283-A1,OLIVIER LISA M,C12M
US-2006250589-A1,EURLINGS MARKUS FRANCISCUS A,G03F
US-2006250589-A1,EURLINGS MARKUS FRANCISCUS A,G05B
US-2006250589-A1,EURLINGS MARKUS FRANCISCUS A,G03F
US-2006250589-A1,EURLINGS MARKUS FRANCISCUS A,G05B
US-2006250589-A1,EURLINGS MARKUS FRANCISCUS A,G03F
US-2006250589-A1,LAIDIG THOMAS,G03F
US-2006250589-A1,LAIDIG THOMAS,G05B
US-2006250589-A1,LAIDIG THOMAS,G03F
US-2006250589-A1,LAIDIG THOMAS,G05B
US-2006250589-A1,LAIDIG THOMAS,G03F
Query:
-- Query 12: Explore the structure of "assignee_harmonized" field
SELECT t."publication_number", assignee.value AS "assignee_value"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."assignee_harmonized") AS assignee
LIMIT 100
Answer:
Too long, hard cut:
publication_number,assignee_value
US-8210142-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""SUZUKI SHIGEMITSU""
}"
US-8210142-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""TOMA NAOTO""
}"
US-8210142-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""KANADA YOJI""
}"
US-8210142-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""MUKAIDE HIROKI""
}"
US-8210142-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""AISIN SEIKI""
}"
US-8338035-B2,"{
  ""country_code"": ""KR"",
  ""name"": ""CHIN SANG MUN""
}"
US-8338035-B2,"{
  ""country_code"": ""KR"",
  ""name"": ""KIM SAE HOON""
}"
US-8338035-B2,"{
  ""country_code"": ""KR"",
  ""name"": ""YANG YOO CHANG""
}"
US-8338035-B2,"{
  ""country_code"": ""KR"",
  ""name"": ""YIM CHUL HO""
}"
US-8338035-B2,"{
  ""country_code"": ""KR"",
  ""name"": ""BAECK SUK MIN""
}"
US-8338035-B2,"{
  ""country_code"": ""KR"",
  ""name"": ""HEO SEONG IL""
}"
US-8338035-B2,"{
  ""country_code"": ""KR"",
  ""name"": ""HYUNDAI MOTOR CO LTD""
}"
US-8338035-B2,"{
  ""country_code"": ""KR"",
  ""name"": ""KIA MOTORS CORP""
}"
US-8609829-B2,"{
  ""country_code"": ""US"",
  ""name"": ""BUNGO JENNIFER J""
}"
US-8609829-B2,"{
  ""country_code"": ""US"",
  ""name"": ""HOGAN JAMES J""
}"
US-8609829-B2,"{
  ""country_code"": ""US"",
  ""name"": ""POLLNER REINHOLD B""
}"
US-8609829-B2,"{
  ""country_code"": ""US"",
  ""name"": ""HUDSPETH MARIE K""
}"
US-8609829-B2,"{
  ""country_code"": ""US"",
  ""name"": ""KAPLAN SHANNON K""
}"
US-8609829-B2,"{
  ""country_code"": ""US"",
  ""name"": ""GOSLOW ELIZABETH M""
}"
US-8609829-B2,"{
  ""country_code"": ""US"",
  ""name"": ""GEN PROBE INC""
}"
US-8240274-B2,"{
  ""country_code"": ""US"",
  ""name"": ""GREENE MICHAEL E""
}"
US-8240274-B2,"{
  ""country_code"": ""US"",
  ""name"": ""JENNINGS BRYAN W""
}"
US-8240274-B2,"{
  ""country_code"": ""US"",
  ""name"": ""JONES TERRANCE L""
}"
US-8240274-B2,"{
  ""country_code"": ""US"",
  ""name"": ""CLEMMONS DAVID L""
}"
US-8240274-B2,"{
  ""country_code"": ""US"",
  ""name"": ""MID WEST METAL PRODUCTS CO INC""
}"
US-8904292-B2,"{
  ""country_code"": ""CN"",
  ""name"": ""Fan zhi-hua""
}"
US-8904292-B2,"{
  ""country_code"": ""US"",
  ""name"": ""AHLENIUS MARK T""
}"
US-8904292-B2,"{
  ""country_code"": ""US"",
  ""name"": ""DETTER CRAIG J""
}"
US-8904292-B2,"{
  ""country_code"": ""US"",
  ""name"": ""FERRANS JAMES C""
}"
US-8904292-B2,"{
  ""country_code"": ""CN"",
  ""name"": ""ZHAO KUN""
}"
US-8904292-B2,"{
  ""country_code"": ""US"",
  ""name"": ""MOTOROLA MOBILITY LLC""
}"
US-8480325-B2,"{
  ""country_code"": ""US"",
  ""name"": ""GALLARDO JOSE ANTONIO""
}"
US-8480325-B2,"{
  ""country_code"": ""US"",
  ""name"": ""ARIGALA PAINTING INC""
}"
US-9028758-B2,"{
  ""country_code"": ""IL"",
  ""name"": ""KEINAN ALEX""
}"
US-9028758-B2,"{
  ""country_code"": ""IL"",
  ""name"": ""MIROSHNICHENKO YEVGENY""
}"
US-9028758-B2,"{
  ""country_code"": ""IL"",
  ""name"": ""PARADNY MARK""
}"
US-9028758-B2,"{
  ""country_code"": ""IL"",
  ""name"": ""EXPLODET TECHNOLOGIES LTD""
}"
US-8462223-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""SUZUKI ASUKA""
}"
US-8462223-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""SONY CORP""
}"
US-7944609-B2,"{
  ""country_code"": ""US"",
  ""name"": ""ZETA INSTR INC""
}"
US-10236950-B2,"{
  ""country_code"": ""NL"",
  ""name"": ""WENTINK MAARTEN MENZO""
}"
US-10236950-B2,"{
  ""country_code"": ""US"",
  ""name"": ""QUALCOMM INC""
}"
US-8733262-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""NOGUCHI YOSHIO""
}"
US-8733262-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""SAITO JURI""
}"
US-8733262-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""KOTOBUKI & CO LTD""
}"
US-8733262-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""WESTEK INTERNAT CORP""
}"
US-8248448-B2,"{
  ""country_code"": ""US"",
  ""name"": ""FENG JINWEI""
}"
US-8248448-B2,"{
  ""country_code"": ""US"",
  ""name"": ""CHU PETER""
}"
US-8248448-B2,"{
  ""country_code"": ""US"",
  ""name"": ""DUNLAP WAYNE""
}"
US-8248448-B2,"{
  ""country_code"": ""US"",
  ""name"": ""GALLMEIER JONATHAN""
}"
US-8248448-B2,"{
  ""country_code"": ""US"",
  ""name"": ""NIMRI ALAIN""
}"
US-8248448-B2,"{
  ""country_code"": ""US"",
  ""name"": ""SCHAEFER STEPHEN P""
}"
US-8248448-B2,"{
  ""country_code"": ""US"",
  ""name"": ""POLYCOM INC""
}"
US-8590235-B2,"{
  ""country_code"": ""US"",
  ""name"": ""RESSO FRANK""
}"
US-8590235-B2,"{
  ""country_code"": ""US"",
  ""name"": ""JONES GEORGE""
}"
US-8590235-B2,"{
  ""country_code"": ""US"",
  ""name"": ""NELSON RON""
}"
US-8590235-B2,"{
  ""country_code"": ""US"",
  ""name"": ""HUBER MIKE""
}"
US-8590235-B2,"{
  ""country_code"": ""US"",
  ""name"": ""PIERSON JOHN""
}"
US-8590235-B2,"{
  ""country_code"": ""US"",
  ""name"": ""GARLAND IND INC""
}"
US-8086194-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""KOGA HISAO""
}"
US-8086194-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""KODAMA NOBUTAKA""
}"
US-8086194-B2,"{
  ""country_code"": ""JP"",
  ""name"": ""KONISHI TAISUKE""
}"
US-8086194-B2,"{
  ""country_code
Query:
-- Query 13: Find all patents citing DENSO CORP patents, excluding DENSO CORP as citing assignee
SELECT t."publication_number" AS "citing_patent_number",
       assignee.value:"name"::STRING AS "citing_assignee_name",
       cited.value:"publication_number"::STRING AS "cited_publication_number"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."assignee_harmonized") AS assignee
CROSS JOIN LATERAL FLATTEN(input => t."citation") AS cited
WHERE cited.value:"publication_number"::STRING IN (
  SELECT denso_patent."publication_number"
  FROM PATENTS.PATENTS.PUBLICATIONS denso_patent
  CROSS JOIN LATERAL FLATTEN(input => denso_patent."assignee_harmonized") AS denso_assignee
  WHERE denso_assignee.value:"name"::STRING ILIKE '%DENSO CORP%'
)
AND assignee.value:"name"::STRING NOT ILIKE '%DENSO CORP%'
LIMIT 100
Answer:
citing_patent_number,citing_assignee_name,cited_publication_number
CN-109203994-A,YAZAKI CORP,JP-2008089479-A
JP-2020117051-A,HONDA MOTOR CO LTD,JP-2008238870-A
US-8807647-B2,SAHASHI HIDEO,JP-2010104485-A
US-8807647-B2,TOYOTA BOSHOKU KK,JP-2010104485-A
US-10616959-B2,MAHLE INT GMBH,US-6178292-B1
US-9151260-B2,SUZUKI HISAO,JP-2004332657-A
US-9151260-B2,TOYOTA MOTOR CO LTD,JP-2004332657-A
US-10774689-B2,MAHLE INT GMBH,US-2007044473-A1
DE-102006000312-B4,TOYOTA MOTOR CO LTD,EP-1672346-A2
CN-108292892-A,FUJI ELECTRIC CO LTD,JP-2009071935-A
US-2015369515-A1,HYUNDAI MOTOR CO LTD,US-6178292-B1
US-2015369515-A1,KIA MOTORS CORP,US-6178292-B1
Query:
-- Query 14: Count citations of DENSO CORP patents by other assignees
SELECT assignee.value:"name"::STRING AS "citing_assignee_name",
       COUNT(*) AS "citation_count"
FROM PATENTS.PATENTS.PUBLICATIONS t
CROSS JOIN LATERAL FLATTEN(input => t."assignee_harmonized") AS assignee
CROSS JOIN LATERAL FLATTEN(input => t."citation") AS cited
WHERE cited.value:"publication_number"::STRING IN (
  SELECT denso_patent."publication_number"
  FROM PATENTS.PATENTS.PUBLICATIONS denso_patent
  CROSS JOIN LATERAL FLATTEN(input => denso_patent."assignee_harmonized") AS denso_assignee
  WHERE denso_assignee.value:"name"::STRING ILIKE '%DENSO CORP%'
)
AND assignee.value:"name"::STRING NOT ILIKE '%DENSO CORP%'
GROUP BY assignee.value:"name"::STRING
LIMIT 100
Answer:
citing_assignee_name,citation_count
SUZUKI HISAO,1
TOYOTA BOSHOKU KK,1
SAHASHI HIDEO,1
YAZAKI CORP,1
MAHLE INT GMBH,2
HYUNDAI MOTOR CO LTD,1
HONDA MOTOR CO LTD,1
TOYOTA MOTOR CO LTD,2
KIA MOTORS CORP,1
FUJI ELECTRIC CO LTD,1
Query:
-- Query 15: List CPC subclass titles for a given subclass code
SELECT d."symbol" AS "cpc_subclass", d."titleFull" AS "cpc_title"
FROM PATENTS.PATENTS.CPC_DEFINITION d
WHERE d."symbol" = 'H01M'  -- Example subclass code
LIMIT 100
Answer:
cpc_subclass,cpc_title
H01M,"PROCESSES OR MEANS, e.g. BATTERIES, FOR THE DIRECT CONVERSION OF CHEMICAL ENERGY INTO ELECTRICAL ENERGY"
End Exploring Related Columns
Task: Which assignees, excluding DENSO CORP itself, have cited patents assigned to DENSO CORP, and what are the titles of the primary CPC subclasses associated with these citations? Provide the name of each citing assignee, the full title of the CPC subclass, and the count of citations grouped by the assignee and the CPC subclass title. Please focus specifically on the main categories of the CPC codes,

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Assignee,CPC_Subclass_Title,Citation_Count
assignee1:str,cpc_subclass_title1:str,count1:int
assignee2:str,cpc_subclass_title2:str,count2:int
...
```

**Explanation:**

To address this task, we first identify all patents assigned to **DENSO CORP** from the `PUBLICATIONS` table by filtering the `assignee_harmonized` field. Next, we find all patents that cite these DENSO CORP patents by examining the `citation` field in the same table, excluding any citations originating from DENSO CORP itself. For each citing patent, we retrieve the assignee's name and the primary CPC subclass code from the `cpc` field. We then join this CPC code with the `CPC_DEFINITION` table to obtain the full title of the CPC subclass. Finally, we group the results by the assignee and the CPC subclass title, counting the number of citations in each group. The focus on the main categories of the CPC codes ensures that we consider the primary technological areas relevant to the cited patents..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-25 10:35:15 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:35:15 - root - INFO - ```sql
WITH denso_patents AS (
    SELECT DISTINCT t."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee
    WHERE assignee.value:"name"::STRING ILIKE '%DENSO CORP%'
),
citations_to_denso AS (
    SELECT t."publication_number" AS "citing_patent_number",
           assignee.value:"name"::STRING AS "citing_assignee_name",
           SUBSTR(cpc_code.value:"code"::STRING, 1, 4) AS "cpc_subclass"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee,
    LATERAL FLATTEN(input => t."citation") cited,
    LATERAL FLATTEN(input => t."cpc") cpc_code
    WHERE cited.value:"publication_number"::STRING IN (
        SELECT "publication_number" FROM denso_patents
    )
    AND assignee.value:"name"::STRING NOT ILIKE '%DENSO CORP%'
    AND cpc_code.value:"first"::BOOLEAN = TRUE
),
citations_with_cpc_title AS (
    SELECT ctd."citing_assignee_name",
           ctd."cpc_subclass",
           cpc_def."titleFull" AS "cpc_subclass_title"
    FROM citations_to_denso ctd
    LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_def
    ON cpc_def."symbol" = ctd."cpc_subclass"
)

SELECT "citing_assignee_name" AS "Assignee",
       "cpc_subclass_title" AS "CPC_Subclass_Title",
       COUNT(*) AS "Citation_Count"
FROM citations_with_cpc_title
GROUP BY "citing_assignee_name", "cpc_subclass_title";
```
2025-01-25 10:35:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:35:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:35:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:35:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 13
2025-01-25 10:35:16 - snowflake.connector.connection - INFO - closed
2025-01-25 10:35:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:35:17 - root - INFO - itercount: 1
2025-01-25 10:35:17 - root - INFO - 0
2025-01-25 10:35:17 - root - INFO - results: 
Assignee,CPC_Subclass_Title,Citation_Count
TOYOTA BOSHOKU KK,SEATS SPECIALLY ADAPTED FOR VEHICLES; VEHICLE PASSENGER ACCOMMODATION NOT OTHERWISE PROVIDED FOR,2
KIA MOTORS CORP,"FLUID HEATERS, e.g. WATER OR AIR HEATERS, HAVING HEAT-GENERATING MEANS, e.g. HEAT PUMPS, IN GENERAL",3
TOYOTA MOTOR CO LTD,"IGNITION, OTHER THAN COMPRESSION IGNITION, FOR INTERNAL-COMBUSTION ENGINES; TESTING OF IGNITION TIMING IN COMPRESSION-IGNITION ENGINES",2
MAHLE INT GMBH,"ELECTRIC HEATING; ELECTRIC LIGHT SOURCES NOT OTHERWISE PROVIDED FOR; CIRCUIT ARRANGEMENTS FOR ELECTRIC LIGHT SOURCES, IN GENERAL",3
HONDA MOTOR CO LTD,PROPULSION OF ELECTRICALLY-PROPELLED VEHICLES; SUPPLYING ELECTRIC POWER FOR AUXILIARY EQUIPMENT OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRODYNAMIC BRAKE SYSTEMS FOR VEHICLES IN GENERAL; MAGNETIC SUSPENSION OR LEVITATION FOR VEHICLES; MONITORING OPERATING VARIABLES OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRIC SAFETY DEVICES FOR ELECTRICALLY-PROPELLED VEHICLES,3
HYUNDAI MOTOR CO LTD,"FLUID HEATERS, e.g. WATER OR AIR HEATERS, HAVING HEAT-GENERATING MEANS, e.g. HEAT PUMPS, IN GENERAL",3
TOYOTA MOTOR CO LTD,SUPPLYING COMBUSTION ENGINES IN GENERAL WITH COMBUSTIBLE MIXTURES OR CONSTITUENTS THEREOF,3
MAHLE INT GMBH,"FLUID HEATERS, e.g. WATER OR AIR HEATERS, HAVING HEAT-GENERATING MEANS, e.g. HEAT PUMPS, IN GENERAL",1
YAZAKI CORP,"ARRANGEMENT OR MOUNTING OF PROPULSION UNITS OR OF TRANSMISSIONS IN VEHICLES; ARRANGEMENT OR MOUNTING OF PLURAL DIVERSE PRIME-MOVERS IN VEHICLES; AUXILIARY DRIVES FOR VEHICLES; INSTRUMENTATION OR DASHBOARDS FOR VEHICLES; ARRANGEMENTS IN CONNECTION WITH COOLING, AIR INTAKE, GAS EXHAUST OR FUEL SUPPLY OF PROPULSION UNITS IN VEHICLES",2
FUJI ELECTRIC CO LTD,PRINTED CIRCUITS; CASINGS OR CONSTRUCTIONAL DETAILS OF ELECTRIC APPARATUS; MANUFACTURE OF ASSEMBLAGES OF ELECTRICAL COMPONENTS,2
SUZUKI HISAO,SUPPLYING COMBUSTION ENGINES IN GENERAL WITH COMBUSTIBLE MIXTURES OR CONSTITUENTS THEREOF,3
SAHASHI HIDEO,SEATS SPECIALLY ADAPTED FOR VEHICLES; VEHICLE PASSENGER ACCOMMODATION NOT OTHERWISE PROVIDED FOR,2
MAHLE INT GMBH,STEAM ENGINE PLANTS; STEAM ACCUMULATORS; ENGINE PLANTS NOT OTHERWISE PROVIDED FOR; ENGINES USING SPECIAL WORKING FLUIDS OR CYCLES,3


2025-01-25 10:35:17 - root - INFO - Please check the answer again by reviewing Which assignees, excluding DENSO CORP itself, have cited patents assigned to DENSO CORP, and what are the titles of the primary CPC subclasses associated with these citations? Provide the name of each citing assignee, the full title of the CPC subclass, and the count of citations grouped by the assignee and the CPC subclass title. Please focus specifically on the main categories of the CPC codes,, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Assignee,CPC_Subclass_Title,Citation_Count
assignee1:str,cpc_subclass_title1:str,count1:int
assignee2:str,cpc_subclass_title2:str,count2:int
...
```

**Explanation:**

To address this task, we first identify all patents assigned to **DENSO CORP** from the `PUBLICATIONS` table by filtering the `assignee_harmonized` field. Next, we find all patents that cite these DENSO CORP patents by examining the `citation` field in the same table, excluding any citations originating from DENSO CORP itself. For each citing patent, we retrieve the assignee's name and the primary CPC subclass code from the `cpc` field. We then join this CPC code with the `CPC_DEFINITION` table to obtain the full title of the CPC subclass. Finally, we group the results by the assignee and the CPC subclass title, counting the number of citations in each group. The focus on the main categories of the CPC codes ensures that we consider the primary technological areas relevant to the cited patents. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Assignee,CPC_Subclass_Title,Citation_Count
TOYOTA BOSHOKU KK,SEATS SPECIALLY ADAPTED FOR VEHICLES; VEHICLE PASSENGER ACCOMMODATION NOT OTHERWISE PROVIDED FOR,2
KIA MOTORS CORP,"FLUID HEATERS, e.g. WATER OR AIR HEATERS, HAVING HEAT-GENERATING MEANS, e.g. HEAT PUMPS, IN GENERAL",3
TOYOTA MOTOR CO LTD,"IGNITION, OTHER THAN COMPRESSION IGNITION, FOR INTERNAL-COMBUSTION ENGINES; TESTING OF IGNITION TIMING IN COMPRESSION-IGNITION ENGINES",2
MAHLE INT GMBH,"ELECTRIC HEATING; ELECTRIC LIGHT SOURCES NOT OTHERWISE PROVIDED FOR; CIRCUIT ARRANGEMENTS FOR ELECTRIC LIGHT SOURCES, IN GENERAL",3
HONDA MOTOR CO LTD,PROPULSION OF ELECTRICALLY-PROPELLED VEHICLES; SUPPLYING ELECTRIC POWER FOR AUXILIARY EQUIPMENT OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRODYNAMIC BRAKE SYSTEMS FOR VEHICLES IN GENERAL; MAGNETIC SUSPENSION OR LEVITATION FOR VEHICLES; MONITORING OPERATING VARIABLES OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRIC SAFETY DEVICES FOR ELECTRICALLY-PROPELLED VEHICLES,3
HYUNDAI MOTOR CO LTD,"FLUID HEATERS, e.g. WATER OR AIR HEATERS, HAVING HEAT-GENERATING MEANS, e.g. HEAT PUMPS, IN GENERAL",3
TOYOTA MOTOR CO LTD,SUPPLYING COMBUSTION ENGINES IN GENERAL WITH COMBUSTIBLE MIXTURES OR CONSTITUENTS THEREOF,3
MAHLE INT GMBH,"FLUID HEATERS, e.g. WATER OR AIR HEATERS, HAVING HEAT-GENERATING MEANS, e.g. HEAT PUMPS, IN GENERAL",1
YAZAKI CORP,"ARRANGEMENT OR MOUNTING OF PROPULSION UNITS OR OF TRANSMISSIONS IN VEHICLES; ARRANGEMENT OR MOUNTING OF PLURAL DIVERSE PRIME-MOVERS IN VEHICLES; AUXILIARY DRIVES FOR VEHICLES; INSTRUMENTATION OR DASHBOARDS FOR VEHICLES; ARRANGEMENTS IN CONNECTION WITH COOLING, AIR INTAKE, GAS EXHAUST OR FUEL SUPPLY OF PROPULSION UNITS IN VEHICLES",2
FUJI ELECTRIC CO LTD,PRINTED CIRCUITS; CASINGS OR CONSTRUCTIONAL DETAILS OF ELECTRIC APPARATUS; MANUFACTURE OF ASSEMBLAGES OF ELECTRICAL COMPONENTS,2
SUZUKI HISAO,SUPPLYING COMBUSTION ENGINES IN GENERAL WITH COMBUSTIBLE MIXTURES OR CONSTITUENTS THEREOF,3
SAHASHI HIDEO,SEATS SPECIALLY ADAPTED FOR VEHICLES; VEHICLE PASSENGER ACCOMMODATION NOT OTHERWISE PROVIDED FOR,2
MAHLE INT GMBH,STEAM ENGINE PLANTS; STEAM ACCUMULATORS; ENGINE PLANTS NOT OTHERWISE PROVIDED FOR; ENGINES USING SPECIAL WORKING FLUIDS OR CYCLES,3
Current sql:
WITH denso_patents AS (
    SELECT DISTINCT t."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee
    WHERE assignee.value:"name"::STRING ILIKE '%DENSO CORP%'
),
citations_to_denso AS (
    SELECT t."publication_number" AS "citing_patent_number",
           assignee.value:"name"::STRING AS "citing_assignee_name",
           SUBSTR(cpc_code.value:"code"::STRING, 1, 4) AS "cpc_subclass"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee,
    LATERAL FLATTEN(input => t."citation") cited,
    LATERAL FLATTEN(input => t."cpc") cpc_code
    WHERE cited.value:"publication_number"::STRING IN (
        SELECT "publication_number" FROM denso_patents
    )
    AND assignee.value:"name"::STRING NOT ILIKE '%DENSO CORP%'
    AND cpc_code.value:"first"::BOOLEAN = TRUE
),
citations_with_cpc_title AS (
    SELECT ctd."citing_assignee_name",
           ctd."cpc_subclass",
           cpc_def."titleFull" AS "cpc_subclass_title"
    FROM citations_to_denso ctd
    LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_def
    ON cpc_def."symbol" = ctd."cpc_subclass"
)

SELECT "citing_assignee_name" AS "Assignee",
       "cpc_subclass_title" AS "CPC_Subclass_Title",
       COUNT(*) AS "Citation_Count"
FROM citations_with_cpc_title
GROUP BY "citing_assignee_name", "cpc_subclass_title";
2025-01-25 10:36:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:36:01 - root - INFO - ```sql
WITH denso_patents AS (
    SELECT DISTINCT t."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee
    WHERE assignee.value:"name"::STRING ILIKE '%DENSO CORP%'
),
citations_to_denso AS (
    SELECT t."publication_number" AS "citing_patent_number",
           assignee.value:"name"::STRING AS "citing_assignee_name",
           REGEXP_SUBSTR(cpc_code.value:"code"::STRING, '^[A-Z]\d{2}[A-Z]?') AS "cpc_subclass"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee,
    LATERAL FLATTEN(input => t."citation") cited,
    LATERAL FLATTEN(input => t."cpc") cpc_code
    WHERE cited.value:"publication_number"::STRING IN (
        SELECT "publication_number" FROM denso_patents
    )
    AND assignee.value:"name"::STRING NOT ILIKE '%DENSO CORP%'
    AND cpc_code.value:"first"::BOOLEAN = TRUE
),
citations_with_cpc_title AS (
    SELECT ctd."citing_assignee_name",
           ctd."cpc_subclass",
           cpc_def."titleFull" AS "cpc_subclass_title"
    FROM citations_to_denso ctd
    LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_def
    ON cpc_def."symbol" = ctd."cpc_subclass"
)

SELECT "citing_assignee_name" AS "Assignee",
       "cpc_subclass_title" AS "CPC_Subclass_Title",
       COUNT(*) AS "Citation_Count"
FROM citations_with_cpc_title
GROUP BY "citing_assignee_name", "cpc_subclass_title";
```
2025-01-25 10:36:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:36:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:36:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:36:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-25 10:36:02 - snowflake.connector.connection - INFO - closed
2025-01-25 10:36:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:36:03 - root - INFO - itercount: 2
2025-01-25 10:36:03 - root - INFO - 0
2025-01-25 10:36:03 - root - INFO - results: 
Assignee,CPC_Subclass_Title,Citation_Count
SUZUKI HISAO,,3
TOYOTA MOTOR CO LTD,,5
YAZAKI CORP,,2
FUJI ELECTRIC CO LTD,,2
HONDA MOTOR CO LTD,,3
TOYOTA BOSHOKU KK,,2
KIA MOTORS CORP,,3
MAHLE INT GMBH,,7
HYUNDAI MOTOR CO LTD,,3
SAHASHI HIDEO,,2


2025-01-25 10:36:03 - root - INFO - Please check the answer again by reviewing Which assignees, excluding DENSO CORP itself, have cited patents assigned to DENSO CORP, and what are the titles of the primary CPC subclasses associated with these citations? Provide the name of each citing assignee, the full title of the CPC subclass, and the count of citations grouped by the assignee and the CPC subclass title. Please focus specifically on the main categories of the CPC codes,, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Assignee,CPC_Subclass_Title,Citation_Count
assignee1:str,cpc_subclass_title1:str,count1:int
assignee2:str,cpc_subclass_title2:str,count2:int
...
```

**Explanation:**

To address this task, we first identify all patents assigned to **DENSO CORP** from the `PUBLICATIONS` table by filtering the `assignee_harmonized` field. Next, we find all patents that cite these DENSO CORP patents by examining the `citation` field in the same table, excluding any citations originating from DENSO CORP itself. For each citing patent, we retrieve the assignee's name and the primary CPC subclass code from the `cpc` field. We then join this CPC code with the `CPC_DEFINITION` table to obtain the full title of the CPC subclass. Finally, we group the results by the assignee and the CPC subclass title, counting the number of citations in each group. The focus on the main categories of the CPC codes ensures that we consider the primary technological areas relevant to the cited patents. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Assignee,CPC_Subclass_Title,Citation_Count
SUZUKI HISAO,,3
TOYOTA MOTOR CO LTD,,5
YAZAKI CORP,,2
FUJI ELECTRIC CO LTD,,2
HONDA MOTOR CO LTD,,3
TOYOTA BOSHOKU KK,,2
KIA MOTORS CORP,,3
MAHLE INT GMBH,,7
HYUNDAI MOTOR CO LTD,,3
SAHASHI HIDEO,,2
Current sql:
WITH denso_patents AS (
    SELECT DISTINCT t."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee
    WHERE assignee.value:"name"::STRING ILIKE '%DENSO CORP%'
),
citations_to_denso AS (
    SELECT t."publication_number" AS "citing_patent_number",
           assignee.value:"name"::STRING AS "citing_assignee_name",
           REGEXP_SUBSTR(cpc_code.value:"code"::STRING, '^[A-Z]\d{2}[A-Z]?') AS "cpc_subclass"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee,
    LATERAL FLATTEN(input => t."citation") cited,
    LATERAL FLATTEN(input => t."cpc") cpc_code
    WHERE cited.value:"publication_number"::STRING IN (
        SELECT "publication_number" FROM denso_patents
    )
    AND assignee.value:"name"::STRING NOT ILIKE '%DENSO CORP%'
    AND cpc_code.value:"first"::BOOLEAN = TRUE
),
citations_with_cpc_title AS (
    SELECT ctd."citing_assignee_name",
           ctd."cpc_subclass",
           cpc_def."titleFull" AS "cpc_subclass_title"
    FROM citations_to_denso ctd
    LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_def
    ON cpc_def."symbol" = ctd."cpc_subclass"
)

SELECT "citing_assignee_name" AS "Assignee",
       "cpc_subclass_title" AS "CPC_Subclass_Title",
       COUNT(*) AS "Citation_Count"
FROM citations_with_cpc_title
GROUP BY "citing_assignee_name", "cpc_subclass_title";Empty results in Column ['CPC_Subclass_Title']. Please correct them.

2025-01-25 10:36:34 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:36:34 - root - INFO - ```sql
WITH denso_patents AS (
    SELECT DISTINCT t."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee
    WHERE assignee.value:"name"::STRING ILIKE '%DENSO CORP%'
),
citations_to_denso AS (
    SELECT t."publication_number" AS "citing_patent_number",
           assignee.value:"name"::STRING AS "citing_assignee_name",
           CONCAT(cpc_code.value:"section"::STRING, cpc_code.value:"class"::STRING, cpc_code.value:"subclass"::STRING) AS "cpc_subclass"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee,
    LATERAL FLATTEN(input => t."citation") cited,
    LATERAL FLATTEN(input => t."cpc") cpc_code
    WHERE cited.value:"publication_number"::STRING IN (
        SELECT "publication_number" FROM denso_patents
    )
    AND assignee.value:"name"::STRING NOT ILIKE '%DENSO CORP%'
    AND cpc_code.value:"first"::BOOLEAN = TRUE
),
citations_with_cpc_title AS (
    SELECT ctd."citing_assignee_name",
           ctd."cpc_subclass",
           cpc_def."titleFull" AS "cpc_subclass_title"
    FROM citations_to_denso ctd
    LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_def
    ON cpc_def."symbol" = ctd."cpc_subclass"
)

SELECT "citing_assignee_name" AS "Assignee",
       "cpc_subclass_title" AS "CPC_Subclass_Title",
       COUNT(*) AS "Citation_Count"
FROM citations_with_cpc_title
GROUP BY "citing_assignee_name", "cpc_subclass_title";
```
2025-01-25 10:36:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:36:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:36:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:36:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-25 10:36:39 - snowflake.connector.connection - INFO - closed
2025-01-25 10:36:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:36:40 - root - INFO - itercount: 3
2025-01-25 10:36:40 - root - INFO - 0
2025-01-25 10:36:40 - root - INFO - results: 
Assignee,CPC_Subclass_Title,Citation_Count
SUZUKI HISAO,,3
TOYOTA MOTOR CO LTD,,5
YAZAKI CORP,,2
FUJI ELECTRIC CO LTD,,2
HONDA MOTOR CO LTD,,3
TOYOTA BOSHOKU KK,,2
KIA MOTORS CORP,,3
MAHLE INT GMBH,,7
HYUNDAI MOTOR CO LTD,,3
SAHASHI HIDEO,,2


2025-01-25 10:36:40 - root - INFO - Please check the answer again by reviewing Which assignees, excluding DENSO CORP itself, have cited patents assigned to DENSO CORP, and what are the titles of the primary CPC subclasses associated with these citations? Provide the name of each citing assignee, the full title of the CPC subclass, and the count of citations grouped by the assignee and the CPC subclass title. Please focus specifically on the main categories of the CPC codes,, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Assignee,CPC_Subclass_Title,Citation_Count
assignee1:str,cpc_subclass_title1:str,count1:int
assignee2:str,cpc_subclass_title2:str,count2:int
...
```

**Explanation:**

To address this task, we first identify all patents assigned to **DENSO CORP** from the `PUBLICATIONS` table by filtering the `assignee_harmonized` field. Next, we find all patents that cite these DENSO CORP patents by examining the `citation` field in the same table, excluding any citations originating from DENSO CORP itself. For each citing patent, we retrieve the assignee's name and the primary CPC subclass code from the `cpc` field. We then join this CPC code with the `CPC_DEFINITION` table to obtain the full title of the CPC subclass. Finally, we group the results by the assignee and the CPC subclass title, counting the number of citations in each group. The focus on the main categories of the CPC codes ensures that we consider the primary technological areas relevant to the cited patents. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Assignee,CPC_Subclass_Title,Citation_Count
SUZUKI HISAO,,3
TOYOTA MOTOR CO LTD,,5
YAZAKI CORP,,2
FUJI ELECTRIC CO LTD,,2
HONDA MOTOR CO LTD,,3
TOYOTA BOSHOKU KK,,2
KIA MOTORS CORP,,3
MAHLE INT GMBH,,7
HYUNDAI MOTOR CO LTD,,3
SAHASHI HIDEO,,2
Current sql:
WITH denso_patents AS (
    SELECT DISTINCT t."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee
    WHERE assignee.value:"name"::STRING ILIKE '%DENSO CORP%'
),
citations_to_denso AS (
    SELECT t."publication_number" AS "citing_patent_number",
           assignee.value:"name"::STRING AS "citing_assignee_name",
           CONCAT(cpc_code.value:"section"::STRING, cpc_code.value:"class"::STRING, cpc_code.value:"subclass"::STRING) AS "cpc_subclass"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee,
    LATERAL FLATTEN(input => t."citation") cited,
    LATERAL FLATTEN(input => t."cpc") cpc_code
    WHERE cited.value:"publication_number"::STRING IN (
        SELECT "publication_number" FROM denso_patents
    )
    AND assignee.value:"name"::STRING NOT ILIKE '%DENSO CORP%'
    AND cpc_code.value:"first"::BOOLEAN = TRUE
),
citations_with_cpc_title AS (
    SELECT ctd."citing_assignee_name",
           ctd."cpc_subclass",
           cpc_def."titleFull" AS "cpc_subclass_title"
    FROM citations_to_denso ctd
    LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION cpc_def
    ON cpc_def."symbol" = ctd."cpc_subclass"
)

SELECT "citing_assignee_name" AS "Assignee",
       "cpc_subclass_title" AS "CPC_Subclass_Title",
       COUNT(*) AS "Citation_Count"
FROM citations_with_cpc_title
GROUP BY "citing_assignee_name", "cpc_subclass_title";Empty results in Column ['CPC_Subclass_Title']. Please correct them.

2025-01-25 10:37:26 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:37:26 - root - INFO - ```sql
WITH denso_patents AS (
    SELECT DISTINCT t."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee
    WHERE assignee.value:"name"::STRING ILIKE '%DENSO CORP%'
),
citations_to_denso AS (
    SELECT t."publication_number" AS "citing_patent_number",
           assignee.value:"name"::STRING AS "citing_assignee_name",
           SUBSTR(cpc_code.value:"code"::STRING, 1, 4) AS "cpc_subclass"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee,
    LATERAL FLATTEN(input => t."citation") cited,
    LATERAL FLATTEN(input => t."cpc") cpc_code
    WHERE cited.value:"publication_number"::STRING IN (
        SELECT "publication_number" FROM denso_patents
    )
    AND assignee.value:"name"::STRING NOT ILIKE '%DENSO CORP%'
    AND cpc_code.value:"first"::BOOLEAN = TRUE
),
cpc_subclasses AS (
    SELECT "symbol", "titleFull"
    FROM PATENTS.PATENTS.CPC_DEFINITION
    WHERE LENGTH("symbol") = 4
),
citations_with_cpc_title AS (
    SELECT ctd."citing_assignee_name",
           ctd."cpc_subclass",
           cpc_def."titleFull" AS "cpc_subclass_title"
    FROM citations_to_denso ctd
    LEFT JOIN cpc_subclasses cpc_def
    ON cpc_def."symbol" = ctd."cpc_subclass"
)

SELECT "citing_assignee_name" AS "Assignee",
       "cpc_subclass_title" AS "CPC_Subclass_Title",
       COUNT(*) AS "Citation_Count"
FROM citations_with_cpc_title
GROUP BY "citing_assignee_name", "cpc_subclass_title";
```
2025-01-25 10:37:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:37:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:37:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:37:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 13
2025-01-25 10:37:31 - snowflake.connector.connection - INFO - closed
2025-01-25 10:37:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:37:31 - root - INFO - itercount: 4
2025-01-25 10:37:31 - root - INFO - 0
2025-01-25 10:37:31 - root - INFO - Total iteration counts: 4
