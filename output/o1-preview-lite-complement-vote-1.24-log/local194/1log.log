2025-01-25 06:09:08 - openai._base_client - INFO - Retrying request to /chat/completions in 0.403249 seconds
2025-01-25 06:10:54 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 06:10:54 - root - INFO - SQL:
SELECT DISTINCT "actor_id", "first_name", "last_name"
   FROM "actor"
   LIMIT 100;
Results:
actor_id,first_name,last_name
1,PENELOPE,GUINESS
2,NICK,WAHLBERG
3,ED,CHASE
4,JENNIFER,DAVIS
5,JOHNNY,LOLLOBRIGIDA
6,BETTE,NICHOLSON
7,GRACE,MOSTEL
8,MATTHEW,JOHANSSON
9,JOE,SWANK
10,CHRISTIAN,GABLE
11,ZERO,CAGE
12,KARL,BERRY
13,UMA,WOOD
14,VIVIEN,BERGEN
15,CUBA,OLIVIER
16,FRED,COSTNER
17,HELEN,VOIGHT
18,DAN,TORN
19,BOB,FAWCETT
20,LUCILLE,TRACY
21,KIRSTEN,PALTROW
22,ELVIS,MARX
23,SANDRA,KILMER
24,CAMERON,STREEP
25,KEVIN,BLOOM
26,RIP,CRAWFORD
27,JULIA,MCQUEEN
28,WOODY,HOFFMAN
29,ALEC,WAYNE
30,SANDRA,PECK
31,SISSY,SOBIESKI
32,TIM,HACKMAN
33,MILLA,PECK
34,AUDREY,OLIVIER
35,JUDY,DEAN
36,BURT,DUKAKIS
37,VAL,BOLGER
38,TOM,MCKELLEN
39,GOLDIE,BRODY
40,JOHNNY,CAGE
41,JODIE,DEGENERES
42,TOM,MIRANDA
43,KIRK,JOVOVICH
44,NICK,STALLONE
45,REESE,KILMER
46,PARKER,GOLDBERG
47,JULIA,BARRYMORE
48,FRANCES,DAY-LEWIS
49,ANNE,CRONYN
50,NATALIE,HOPKINS
51,GARY,PHOENIX
52,CARMEN,HUNT
53,MENA,TEMPLE
54,PENELOPE,PINKETT
55,FAY,KILMER
56,DAN,HARRIS
57,JUDE,CRUISE
58,CHRISTIAN,AKROYD
59,DUSTIN,TAUTOU
60,HENRY,BERRY
61,CHRISTIAN,NEESON
62,JAYNE,NEESON
63,CAMERON,WRAY
64,RAY,JOHANSSON
65,ANGELA,HUDSON
66,MARY,TANDY
67,JESSICA,BAILEY
68,RIP,WINSLET
69,KENNETH,PALTROW
70,MICHELLE,MCCONAUGHEY
71,ADAM,GRANT
72,SEAN,WILLIAMS
73,GARY,PENN
74,MILLA,KEITEL
75,BURT,POSEY
76,ANGELINA,ASTAIRE
77,CARY,MCCONAUGHEY
78,GROUCHO,SINATRA
79,MAE,HOFFMAN
80,RALPH,CRUZ
81,SCARLETT,DAMON
82,WOODY,JOLIE
83,BEN,WILLIS
84,JAMES,PITT
85,MINNIE,ZELLWEGER
86,GREG,CHAPLIN
87,SPENCER,PECK
88,KENNETH,PESCI
89,CHARLIZE,DENCH
90,SEAN,GUINESS
91,CHRISTOPHER,BERRY
92,KIRSTEN,AKROYD
93,ELLEN,PRESLEY
94,KENNETH,TORN
95,DARYL,WAHLBERG
96,GENE,WILLIS
97,MEG,HAWKE
98,CHRIS,BRIDGES
99,JIM,MOSTEL
100,SPENCER,DEPP

2025-01-25 06:10:54 - root - INFO - SQL:
SELECT DISTINCT "film_id", "title"
   FROM "film"
   LIMIT 100;
Results:
film_id,title
1,ACADEMY DINOSAUR
2,ACE GOLDFINGER
3,ADAPTATION HOLES
4,AFFAIR PREJUDICE
5,AFRICAN EGG
6,AGENT TRUMAN
7,AIRPLANE SIERRA
8,AIRPORT POLLOCK
9,ALABAMA DEVIL
10,ALADDIN CALENDAR
11,ALAMO VIDEOTAPE
12,ALASKA PHANTOM
13,ALI FOREVER
14,ALICE FANTASIA
15,ALIEN CENTER
16,ALLEY EVOLUTION
17,ALONE TRIP
18,ALTER VICTORY
19,AMADEUS HOLY
20,AMELIE HELLFIGHTERS
21,AMERICAN CIRCUS
22,AMISTAD MIDSUMMER
23,ANACONDA CONFESSIONS
24,ANALYZE HOOSIERS
25,ANGELS LIFE
26,ANNIE IDENTITY
27,ANONYMOUS HUMAN
28,ANTHEM LUKE
29,ANTITRUST TOMATOES
30,ANYTHING SAVANNAH
31,APACHE DIVINE
32,APOCALYPSE FLAMINGOS
33,APOLLO TEEN
34,ARABIA DOGMA
35,ARACHNOPHOBIA ROLLERCOASTER
36,ARGONAUTS TOWN
37,ARIZONA BANG
38,ARK RIDGEMONT
39,ARMAGEDDON LOST
40,ARMY FLINTSTONES
41,ARSENIC INDEPENDENCE
42,ARTIST COLDBLOODED
43,ATLANTIS CAUSE
44,ATTACKS HATE
45,ATTRACTION NEWTON
46,AUTUMN CROW
47,BABY HALL
48,BACKLASH UNDEFEATED
49,BADMAN DAWN
50,BAKED CLEOPATRA
51,BALLOON HOMEWARD
52,BALLROOM MOCKINGBIRD
53,BANG KWAI
54,BANGER PINOCCHIO
55,BARBARELLA STREETCAR
56,BAREFOOT MANCHURIAN
57,BASIC EASY
58,BEACH HEARTBREAKERS
59,BEAR GRACELAND
60,BEAST HUNCHBACK
61,BEAUTY GREASE
62,BED HIGHBALL
63,BEDAZZLED MARRIED
64,BEETHOVEN EXORCIST
65,BEHAVIOR RUNAWAY
66,BENEATH RUSH
67,BERETS AGENT
68,BETRAYED REAR
69,BEVERLY OUTLAW
70,BIKINI BORROWERS
71,BILKO ANONYMOUS
72,BILL OTHERS
73,BINGO TALENTED
74,BIRCH ANTITRUST
75,BIRD INDEPENDENCE
76,BIRDCAGE CASPER
77,BIRDS PERDITION
78,BLACKOUT PRIVATE
79,BLADE POLISH
80,BLANKET BEVERLY
81,BLINDNESS GUN
82,BLOOD ARGONAUTS
83,BLUES INSTINCT
84,BOILED DARES
85,BONNIE HOLOCAUST
86,BOOGIE AMELIE
87,BOONDOCK BALLROOM
88,BORN SPINAL
89,BORROWERS BEDAZZLED
90,BOULEVARD MOB
91,BOUND CHEAPER
92,BOWFINGER GABLES
93,BRANNIGAN SUNRISE
94,BRAVEHEART HUMAN
95,BREAKFAST GOLDFINGER
96,BREAKING HOME
97,BRIDE INTRIGUE
98,BRIGHT ENCOUNTERS
99,BRINGING HYSTERICAL
100,BROOKLYN DESERT

2025-01-25 06:10:55 - root - INFO - SQL:
SELECT "payment_id", "rental_id", "amount"
   FROM "payment"
   LIMIT 100;
Results:
payment_id,rental_id,amount
1,76,2.99
2,573,0.99
3,1185,5.99
4,1422,0.99
5,1476,9.99
6,1725,4.99
7,2308,4.99
8,2363,0.99
9,3284,3.99
10,4526,5.99
11,4611,5.99
12,5244,4.99
13,5326,4.99
14,6163,7.99
15,7273,2.99
16,7841,4.99
17,8033,4.99
18,8074,0.99
19,8116,0.99
20,8326,2.99
21,9571,2.99
22,10437,4.99
23,11299,3.99
24,11367,0.99
25,11824,4.99
26,12250,0.99
27,13068,0.99
28,13176,2.99
29,14762,0.99
30,14825,1.99
31,15298,2.99
32,15315,5.99
33,320,4.99
34,2128,2.99
35,5636,2.99
36,5755,6.99
37,7346,4.99
38,7376,5.99
39,7459,5.99
40,8230,5.99
41,8598,2.99
42,8705,5.99
43,9031,4.99
44,9236,10.99
45,9248,0.99
46,9296,6.99
47,9465,6.99
48,10136,2.99
49,10466,0.99
50,10918,0.99
51,11087,5.99
52,11177,6.99
53,11256,2.99
54,11614,2.99
55,12963,2.99
56,14475,4.99
57,14743,5.99
58,15145,4.99
59,15907,4.99
60,435,1.99
61,830,2.99
62,1546,8.99
63,1726,6.99
64,1911,6.99
65,2628,2.99
66,4180,4.99
67,4725,4.99
68,7096,5.99
69,7503,10.99
70,7703,7.99
71,7724,6.99
72,7911,4.99
73,8086,4.99
74,8545,2.99
75,9226,1.99
76,9443,3.99
77,9595,2.99
78,9816,4.99
79,10597,5.99
80,12556,4.99
81,13403,8.99
82,13610,2.99
83,14699,8.99
84,15038,0.99
85,15619,2.99
86,1297,4.99
87,1633,0.99
88,1707,2.99
89,1735,0.99
90,2043,0.99
91,2642,5.99
92,7660,2.99
93,7718,2.99
94,8741,3.99
95,9100,5.99
96,9371,5.99
97,11069,0.99
98,11110,2.99
99,11529,4.99
100,12151,2.99

2025-01-25 06:10:55 - root - INFO - SQL:
SELECT "rental_id", "inventory_id", "customer_id"
   FROM "rental"
   LIMIT 100;
Results:
rental_id,inventory_id,customer_id
1,367,130
2,1525,459
3,1711,408
4,2452,333
5,2079,222
6,2792,549
7,3995,269
8,2346,239
9,2580,126
10,1824,399
11,4443,142
12,1584,261
13,2294,334
14,2701,446
15,3049,319
16,389,316
17,830,575
18,3376,19
19,1941,456
20,3517,185
21,146,388
22,727,509
23,4441,438
24,3273,350
25,3961,37
26,4371,371
27,1225,301
28,4068,232
29,611,44
30,3744,430
31,4482,369
32,3832,230
33,1681,272
34,2613,597
35,1286,484
36,1308,88
37,403,535
38,2540,302
39,4466,207
40,2638,413
41,1761,174
42,380,523
43,2578,532
44,3098,207
45,1853,436
46,3318,7
47,2211,35
48,1780,282
49,2965,498
50,1983,18
51,1257,256
52,4017,507
53,1255,569
54,2787,291
55,1139,131
56,1352,511
57,3938,6
58,3050,323
59,2884,408
60,330,470
61,4210,250
62,261,419
63,4008,383
64,79,368
65,3552,346
66,1162,86
67,239,119
68,4029,120
69,3207,305
70,2168,73
71,2408,100
72,2260,48
73,517,391
74,1744,265
75,3393,510
76,3021,1
77,1303,451
78,4067,135
79,3299,245
80,2478,314
81,2610,286
82,1388,427
83,466,131
84,1829,492
85,470,414
86,2275,266
87,1586,331
88,2221,53
89,2181,499
90,2984,25
91,139,267
92,775,302
93,4360,288
94,1675,197
95,178,400
96,3418,49
97,1283,263
98,2970,269
99,535,44
100,2599,208

2025-01-25 06:10:55 - root - INFO - SQL:
SELECT f."film_id", f."title", SUM(p."amount") AS "total_revenue"
   FROM "payment" p
   JOIN "rental" r ON p."rental_id" = r."rental_id"
   JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
   JOIN "film" f ON i."film_id" = f."film_id"
   GROUP BY f."film_id", f."title"
   ORDER BY "total_revenue" DESC
   LIMIT 100;
Results:
film_id,title,total_revenue
879,TELEGRAPH VOYAGE,231.73000000000008
973,WIFE TURN,223.69000000000008
1000,ZORRO ARK,214.69000000000008
369,GOODFELLAS SALUTE,209.69000000000005
764,SATURDAY LAMBS,204.72000000000006
893,TITANS JERK,201.71000000000006
897,TORQUE BOUND,198.72000000000006
403,HARRY IDAHO,195.70000000000007
460,INNOCENT USUAL,191.74000000000007
444,HUSTLER PARTY,190.78000000000003
670,PELICAN COMFORTS,188.74000000000004
127,CAT CONEHEADS,181.70000000000005
284,ENEMY ODDS,180.71000000000004
103,BUCKET BROTHERHOOD,180.66000000000005
715,RANGE MOONWALKER,179.73000000000002
563,MASSACRE USUAL,179.70000000000005
941,VIDEOTAPE ARSENIC,178.71000000000004
239,DOGMA FAMILY,178.70000000000002
31,APACHE DIVINE,178.69000000000003
938,VELVET TERMINATOR,177.74000000000004
244,DORADO NOTTING,176.73000000000002
327,FOOL MOCKINGBIRD,175.77
979,WITCHES PANIC,173.70000000000002
159,CLOSER BANG,172.72000000000003
767,SCALAWAG DUCK,172.68000000000004
745,ROSES TREASURE,171.72000000000003
865,SUNRISE LEAGUE,170.76000000000002
791,SHOW LORD,170.75000000000003
624,NIGHTMARE CHILL,169.75000000000003
771,SCORPION APOLLO,168.77
21,AMERICAN CIRCUS,167.78
174,CONFIDENTIAL INTERVIEW,164.71
551,MAIDEN HOME,163.76000000000002
775,SEATTLE EXPECATIONS,163.75
989,WORKING MICROCOSMOS,163.75
86,BOOGIE AMELIE,163.70000000000002
846,STING PERSONAL,159.79
527,LOLA AGENT,159.76
48,BACKLASH UNDEFEATED,158.81
575,MIDSUMMER GROUNDHOG,156.78
892,TITANIC BOONDOCK,154.76999999999998
838,STAGECOACH ARMAGEDDON,154.74
580,MINE TITANS,153.81
683,PITY BOUND,153.73999999999998
778,SECRETS PARADISE,152.8
408,HEAD STRANGER,152.78
267,EAGLES PANKY,152.77999999999997
972,WHISPERER GIANT,151.78
271,EASY GLADIATOR,150.76999999999998
579,MINDS TRUMAN,149.8
307,FELLOWSHIP AUTUMN,149.74
985,WONDERLAND CHRISTMAS,148.78
856,STREETCAR INTENTIONS,148.75
501,KISSING DOLLS,147.79999999999998
861,SUIT WALLS,147.79
902,TRADING PINOCCHIO,147.75
521,LIES TREATMENT,147.73
45,ATTRACTION NEWTON,146.76
330,FORRESTER COMANCHEROS,146.73
603,MOVIE SHAKESPEARE,145.73999999999998
911,TRIP NEWTON,145.72
350,GARDEN ISLAND,144.79999999999998
263,DURHAM PANKY,144.73999999999998
698,PRINCESS GIANT,142.73999999999998
112,CALENDAR GUNFIGHT,141.79
596,MOONSHINE CABIN,141.78999999999996
898,TOURIST PELICAN,141.77999999999997
843,STEEL SANTA,141.76999999999998
253,DRIFTER COMMANDMENTS,141.76
135,CHANCE RESURRECTION,141.73
320,FLAMINGOS CONNECTICUT,139.76999999999998
313,FIDELITY DEVIL,138.78999999999996
131,CENTER DINOSAUR,137.75999999999996
167,COMA HEAD,137.73999999999995
706,QUEEN LUKE,136.77999999999997
614,NAME DETECTIVE,136.76999999999998
172,CONEHEADS SMOOCHY,136.74999999999997
361,GLEAMING JAWBREAKER,136.69999999999996
702,PULP BEVERLY,136.69999999999996
995,YENTL IDAHO,135.76999999999998
324,FLINTSTONES HAPPINESS,134.82999999999998
971,WHALE BIKINI,134.81999999999996
439,HUNCHBACK IMPOSSIBLE,134.79999999999995
227,DETAILS PACKER,133.80999999999997
680,PINOCCHIO SIMON,133.79999999999998
869,SUSPECTS QUILLS,133.69999999999996
621,NETWORK PEAK,133.68999999999997
409,HEARTBREAKERS BRIGHT,132.79999999999995
61,BEAUTY GREASE,132.77999999999997
500,KISS GLORY,132.77999999999997
518,LIAISONS SWEET,131.77999999999997
10,ALADDIN CALENDAR,131.76999999999998
804,SLEEPING SUSPECTS,131.75999999999996
572,METROPOLIS COMA,131.73999999999998
73,BINGO TALENTED,131.70999999999995
734,ROAD ROXANNE,130.80999999999997
578,MILLION ACE,130.79999999999998
730,RIDGEMONT SUBMARINE,130.67999999999995
763,SATISFACTION CONFIDENTIAL,129.82999999999998
412,HEAVYWEIGHTS BEAST,129.76999999999995

2025-01-25 06:10:55 - root - INFO - SQL:
SELECT fa."film_id", COUNT(fa."actor_id") AS "actor_count"
   FROM "film_actor" fa
   GROUP BY fa."film_id"
   LIMIT 100;
Results:
film_id,actor_count
1,10
2,4
3,5
4,5
5,5
6,7
7,5
8,4
9,9
10,8
11,4
12,7
13,5
14,4
15,6
16,5
17,8
18,4
19,6
20,6
21,5
22,4
23,5
24,5
25,9
26,3
27,9
28,2
29,7
30,3
31,4
32,5
33,8
34,12
35,8
36,5
37,4
38,3
39,7
40,7
41,3
42,7
43,9
44,4
45,4
46,3
47,8
48,7
49,8
50,1
51,6
52,7
53,7
54,6
55,5
56,8
57,6
58,7
59,3
60,5
61,5
62,5
63,7
64,6
65,5
66,7
67,10
68,4
69,4
70,2
71,3
72,6
73,5
74,6
75,2
76,4
77,4
78,5
79,5
80,4
81,3
82,4
83,4
84,8
85,9
86,6
87,13
88,9
89,7
90,8
91,2
92,5
93,2
94,4
95,5
96,6
97,1
98,4
99,2
100,5

2025-01-25 06:11:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 06:11:39 - root - INFO - ```sql
SELECT
  a."first_name" || ' ' || a."last_name" AS "actor_name",
  f."title" AS "film_title",
  (tr."total_revenue" / ac."actor_count") AS "average_revenue_per_actor"
FROM "actor" a
JOIN "film_actor" fa ON a."actor_id" = fa."actor_id"
JOIN "film" f ON fa."film_id" = f."film_id"
JOIN (
  SELECT i."film_id", SUM(p."amount") AS "total_revenue"
  FROM "payment" p
  JOIN "rental" r ON p."rental_id" = r."rental_id"
  JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
  GROUP BY i."film_id"
) tr ON f."film_id" = tr."film_id"
JOIN (
  SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
  FROM "film_actor"
  GROUP BY "film_id"
) ac ON f."film_id" = ac."film_id"
ORDER BY a."actor_name", "average_revenue_per_actor" DESC
LIMIT 100;
```

This query retrieves each actor's films along with the average revenue per actor for each film, calculated by dividing the total film revenue equally among all actors in that film. The results are ordered by actor name and average revenue per actor in descending order.
2025-01-25 06:12:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 06:12:05 - root - INFO - ```sql
SELECT f."title", a."first_name" || ' ' || a."last_name" AS "actor_name"
FROM "film" f
JOIN "film_actor" fa ON f."film_id" = fa."film_id"
JOIN "actor" a ON fa."actor_id" = a."actor_id"
WHERE f."title" LIKE '%TARGET_FILM_TITLE%'
LIMIT 100;
```
2025-01-25 06:13:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 06:13:09 - root - INFO - ```sql
SELECT
  a."first_name" || ' ' || a."last_name" AS "actor_name",
  f."title" AS "film_title",
  (tr."total_revenue" / ac."actor_count") AS "average_revenue_per_actor"
FROM "actor" a
JOIN "film_actor" fa ON a."actor_id" = fa."actor_id"
JOIN "film" f ON fa."film_id" = f."film_id"
JOIN (
  SELECT i."film_id", SUM(p."amount") AS "total_revenue"
  FROM "payment" p
  JOIN "rental" r ON p."rental_id" = r."rental_id"
  JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
  GROUP BY i."film_id"
) tr ON f."film_id" = tr."film_id"
JOIN (
  SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
  FROM "film_actor"
  GROUP BY "film_id"
) ac ON f."film_id" = ac."film_id"
ORDER BY "actor_name", "average_revenue_per_actor" DESC
LIMIT 100;
```

**Explanation:**

The previous query was not returning data due to an error in referencing the column alias in the `ORDER BY` clause. Specifically, `"actor_name"` is an alias created in the `SELECT` clause and should not be prefixed with the table alias `"a"` in the `ORDER BY` clause.

This corrected query retrieves each actor's films along with the average revenue per actor for each film, calculated by dividing the total film revenue equally among all actors in that film. The results are ordered by the actor's name and the average revenue per actor in descending order.

**Notes:**

- The `ORDER BY` clause now correctly references `"actor_name"` without the table alias.

- By simplifying the query and correcting the alias usage, the query should now return data.

- If you're still encountering "No data found" errors, ensure that all joins are correct and that there is overlapping data between the tables. You can test smaller portions of the query to verify data exists at each join step.

**Sample Output Format:**

```csv
actor_name,film_title,average_revenue_per_actor
Penelope Guiness,Film Title 1,average_revenue1:float
Penelope Guiness,Film Title 2,average_revenue2:float
Penelope Guiness,Film Title 3,average_revenue3:float
Nick Wahlberg,Film Title 1,average_revenue1:float
Nick Wahlberg,Film Title 2,average_revenue2:float
Nick Wahlberg,Film Title 3,average_revenue3:float
...
```

This will provide a list of actors with their films and the calculated average revenue per actor for those films.
2025-01-25 06:14:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 06:14:39 - root - INFO - SQL:
SELECT
  a."first_name" || ' ' || a."last_name" AS "actor_name",
  f."title" AS "film_title",
  (tr."total_revenue" / ac."actor_count") AS "average_revenue_per_actor"
FROM "actor" a
JOIN "film_actor" fa ON a."actor_id" = fa."actor_id"
JOIN "film" f ON fa."film_id" = f."film_id"
JOIN (
  SELECT i."film_id", SUM(p."amount") AS "total_revenue"
  FROM "payment" p
  JOIN "rental" r ON p."rental_id" = r."rental_id"
  JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
  GROUP BY i."film_id"
) tr ON f."film_id" = tr."film_id"
JOIN (
  SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
  FROM "film_actor"
  GROUP BY "film_id"
) ac ON f."film_id" = ac."film_id"
ORDER BY "actor_name", "average_revenue_per_actor" DESC
LIMIT 100;
Results:
actor_name,film_title,average_revenue_per_actor
ADAM GRANT,SEABISCUIT PUNK,31.913333333333327
ADAM GRANT,OPERATION OPERATION,29.24333333333333
ADAM GRANT,TWISTED PIRATES,22.29666666666667
ADAM GRANT,ANNIE IDENTITY,19.926666666666673
ADAM GRANT,LOSER HUSTLER,17.77
ADAM GRANT,GROUNDHOG UNCUT,14.688571428571425
ADAM GRANT,IDOLS SNATCHERS,14.337499999999995
ADAM GRANT,WANDA CHAMBER,12.405714285714284
ADAM GRANT,FIREBALL PHILADELPHIA,12.158000000000003
ADAM GRANT,DISCIPLE MOTHER,5.972857142857143
ADAM GRANT,MIDNIGHT WESTWARD,5.0922222222222215
ADAM GRANT,MARS ROMAN,4.687142857142857
ADAM GRANT,HAPPINESS UNITED,4.588000000000001
ADAM GRANT,SPLENDOR PATTON,4.079
ADAM GRANT,GLORY TRACY,2.4916666666666667
ADAM GRANT,BALLROOM MOCKINGBIRD,1.5600000000000003
ADAM HOPPER,TORQUE BOUND,39.744000000000014
ADAM HOPPER,PRINCESS GIANT,28.547999999999995
ADAM HOPPER,BLINDNESS GUN,25.62
ADAM HOPPER,MOCKINGBIRD HOLLYWOOD,19.920000000000005
ADAM HOPPER,VACATION BOONDOCK,16.131666666666664
ADAM HOPPER,SLEEPY JAPANESE,15.466666666666667
ADAM HOPPER,SADDLE ANTITRUST,14.28666666666667
ADAM HOPPER,CLUELESS BUCKET,14.093749999999995
ADAM HOPPER,WORDS HUNTER,13.806666666666667
ADAM HOPPER,CLERKS ANGELS,12.732500000000002
ADAM HOPPER,OPEN AFRICAN,12.643333333333329
ADAM HOPPER,NOON PAPI,11.47166666666667
ADAM HOPPER,BLOOD ARGONAUTS,9.725000000000001
ADAM HOPPER,GREASE YOUTH,9.596666666666666
ADAM HOPPER,CHAMBER ITALIAN,9.411428571428573
ADAM HOPPER,MASKED BUBBLE,8.599999999999998
ADAM HOPPER,FICTION CHRISTMAS,7.351250000000001
ADAM HOPPER,GABLES METROPOLIS,7.226250000000004
ADAM HOPPER,TRAIN BUNCH,6.24
ADAM HOPPER,HEAVEN FREEDOM,5.882000000000003
ADAM HOPPER,TOWERS HURRICANE,3.2225000000000006
ADAM HOPPER,LOVERBOY ATTACKS,2.2088888888888887
AL GARLAND,BREAKFAST GOLDFINGER,21.965999999999994
AL GARLAND,DRIFTER COMMANDMENTS,20.25142857142857
AL GARLAND,SILVERADO GOLDFINGER,18.375999999999998
AL GARLAND,OSCAR GOLD,13.958333333333334
AL GARLAND,HOLIDAY GAMES,13.808333333333332
AL GARLAND,BILL OTHERS,11.30166666666667
AL GARLAND,VOICE PEACH,11.269999999999998
AL GARLAND,GLASS DYING,10.965000000000003
AL GARLAND,GRAIL FRANKENSTEIN,10.580000000000002
AL GARLAND,POTTER CONNECTICUT,10.404285714285717
AL GARLAND,PARK CITIZEN,10.153333333333334
AL GARLAND,DALMATIONS SWEDEN,9.800000000000002
AL GARLAND,HANDICAP BOONDOCK,9.102857142857147
AL GARLAND,WASTELAND DIVINE,8.308333333333337
AL GARLAND,HOUSE DYNAMITE,8.30777777777778
AL GARLAND,JACKET FRISCO,7.782000000000001
AL GARLAND,SLEUTH ORIENT,7.684285714285717
AL GARLAND,SENSE GREEK,6.847142857142858
AL GARLAND,ENOUGH RAGING,6.424444444444447
AL GARLAND,ROCK INSTINCT,6.103750000000002
AL GARLAND,SLIPPER FIDELITY,4.405714285714285
AL GARLAND,SPLENDOR PATTON,4.079
AL GARLAND,SPLASH GUMP,3.3860000000000006
AL GARLAND,VISION TORQUE,3.1860000000000004
AL GARLAND,CHITTY LOCK,2.2246153846153853
ALAN DREYFUSS,FIDELITY DEVIL,34.69749999999999
ALAN DREYFUSS,STRICTLY SCARFACE,28.442499999999992
ALAN DREYFUSS,BARBARELLA STREETCAR,19.349999999999998
ALAN DREYFUSS,RUSH GOODFELLAS,17.737999999999992
ALAN DREYFUSS,VAMPIRE WHALE,15.975999999999999
ALAN DREYFUSS,CLUELESS BUCKET,14.093749999999995
ALAN DREYFUSS,SAGEBRUSH CLUELESS,13.12
ALAN DREYFUSS,METAL ARMAGEDDON,12.968749999999996
ALAN DREYFUSS,BIRCH ANTITRUST,12.481666666666667
ALAN DREYFUSS,CLASH FREDDY,12.25
ALAN DREYFUSS,DIVIDE MONSTER,11.298333333333337
ALAN DREYFUSS,KICK SAVANNAH,10.300000000000002
ALAN DREYFUSS,BLANKET BEVERLY,10.220000000000002
ALAN DREYFUSS,JUMPING WRATH,9.969999999999999
ALAN DREYFUSS,STRANGELOVE DESIRE,9.639999999999999
ALAN DREYFUSS,BADMAN DAWN,9.59875
ALAN DREYFUSS,MAGUIRE APACHE,8.477500000000003
ALAN DREYFUSS,BULWORTH COMMANDMENTS,8.232500000000002
ALAN DREYFUSS,MONSTER SPARTACUS,7.40714285714286
ALAN DREYFUSS,MASSAGE IMAGE,6.653333333333335
ALAN DREYFUSS,UNCUT SUICIDES,6.551428571428573
ALAN DREYFUSS,LONELY ELEPHANT,6.487500000000001
ALAN DREYFUSS,HAUNTED ANTITRUST,6.388000000000001
ALAN DREYFUSS,UPTOWN YOUNG,5.554285714285716
ALAN DREYFUSS,POLISH BROOKLYN,2.4819999999999993
ALAN DREYFUSS,CRAZY HOME,2.0700000000000003
ALAN DREYFUSS,GREEDY ROOTS,1.9825000000000002
ALBERT JOHANSSON,UNDEFEATED DALMATIONS,38.26333333333332
ALBERT JOHANSSON,LEBOWSKI SOLDIERS,24.26333333333334
ALBERT JOHANSSON,REDEMPTION COMFORTS,22.759999999999994
ALBERT JOHANSSON,SWEDEN SHINING,22.361999999999995
ALBERT JOHANSSON,FIGHT JAWBREAKER,19.926666666666673
ALBERT JOHANSSON,HARPER DYING,19.45
ALBERT JOHANSSON,CANDLES GRAPES,18.39571428571428
ALBERT JOHANSSON,LEAGUE HELLFIGHTERS,17.638333333333332
ALBERT JOHANSSON,ROAD ROXANNE,16.351249999999997
ALBERT JOHANSSON,FLAMINGOS CONNECTICUT,15.529999999999998

2025-01-25 06:14:39 - root - INFO - SQL:
SELECT i."film_id", SUM(p."amount") AS "total_revenue"
FROM "payment" p
JOIN "rental" r ON p."rental_id" = r."rental_id"
JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
GROUP BY i."film_id"
LIMIT 100
Results:
film_id,total_revenue
1,36.769999999999996
2,52.93000000000001
3,37.88000000000002
4,91.77
5,51.88000000000002
6,126.78999999999996
7,82.85
8,102.81999999999998
9,71.88000000000001
10,131.76999999999998
11,35.75999999999999
12,44.74
13,54.91000000000001
15,90.77999999999999
16,52.86000000000002
17,62.82000000000002
18,32.779999999999994
19,33.78999999999999
20,67.9
21,167.78
22,70.79000000000002
23,60.79000000000002
24,55.86000000000002
25,119.77999999999997
26,59.780000000000015
27,17.87
28,85.85
29,37.90000000000001
30,46.91000000000001
31,178.69000000000003
32,30.940000000000005
34,22.869999999999997
35,114.75999999999998
37,104.78999999999998
39,45.790000000000006
40,41.84000000000001
42,69.84000000000002
43,87.75999999999999
44,101.83999999999999
45,146.76
46,84.89
47,45.92000000000001
48,158.81
49,76.79
50,79.84
51,98.77
52,10.920000000000002
53,22.93
54,42.78000000000001
55,96.74999999999999
56,66.82000000000002
57,90.78999999999999
58,64.83000000000003
59,107.77999999999997
60,76.89
61,132.77999999999997
62,24.940000000000005
63,16.87
64,16.89
65,100.86999999999999
66,16.900000000000002
67,78.78
68,91.85
69,115.78999999999998
70,98.82999999999998
71,102.86999999999999
72,67.81000000000002
73,131.70999999999995
74,74.89
75,63.890000000000015
76,23.91
77,111.81999999999998
78,91.72999999999999
79,34.78999999999999
80,40.88000000000001
81,76.86
82,38.900000000000006
83,84.78999999999999
84,77.85000000000001
85,32.83999999999999
86,163.70000000000002
88,59.88000000000002
89,27.77999999999999
90,63.820000000000014
91,50.76000000000001
92,56.890000000000015
93,74.88000000000001
94,16.950000000000003
95,109.82999999999997
96,51.87000000000002
97,21.809999999999995
98,92.86999999999999
99,71.80000000000001
100,116.78999999999996
101,101.73999999999997
102,35.940000000000005
103,180.66000000000005
104,55.890000000000015
105,21.839999999999996
106,32.93000000000001

2025-01-25 06:14:39 - root - INFO - SQL:
SELECT fa."film_id", COUNT(DISTINCT fa."actor_id") AS "actor_count"
FROM "film_actor" fa
GROUP BY fa."film_id"
LIMIT 100
Results:
film_id,actor_count
1,10
2,4
3,5
4,5
5,5
6,7
7,5
8,4
9,9
10,8
11,4
12,7
13,5
14,4
15,6
16,5
17,8
18,4
19,6
20,6
21,5
22,4
23,5
24,5
25,9
26,3
27,9
28,2
29,7
30,3
31,4
32,5
33,8
34,12
35,8
36,5
37,4
38,3
39,7
40,7
41,3
42,7
43,9
44,4
45,4
46,3
47,8
48,7
49,8
50,1
51,6
52,7
53,7
54,6
55,5
56,8
57,6
58,7
59,3
60,5
61,5
62,5
63,7
64,6
65,5
66,7
67,10
68,4
69,4
70,2
71,3
72,6
73,5
74,6
75,2
76,4
77,4
78,5
79,5
80,4
81,3
82,4
83,4
84,8
85,9
86,6
87,13
88,9
89,7
90,8
91,2
92,5
93,2
94,4
95,5
96,6
97,1
98,4
99,2
100,5

2025-01-25 06:14:39 - root - INFO - SQL:
SELECT f."film_id", f."title", tr."total_revenue", ac."actor_count"
FROM "film" f
JOIN (
  SELECT i."film_id", SUM(p."amount") AS "total_revenue"
  FROM "payment" p
  JOIN "rental" r ON p."rental_id" = r."rental_id"
  JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
  GROUP BY i."film_id"
) tr ON f."film_id" = tr."film_id"
JOIN (
  SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
  FROM "film_actor"
  GROUP BY "film_id"
) ac ON f."film_id" = ac."film_id"
LIMIT 100
Results:
film_id,title,total_revenue,actor_count
1,ACADEMY DINOSAUR,36.769999999999996,10
2,ACE GOLDFINGER,52.93000000000001,4
3,ADAPTATION HOLES,37.88000000000002,5
4,AFFAIR PREJUDICE,91.77,5
5,AFRICAN EGG,51.88000000000002,5
6,AGENT TRUMAN,126.78999999999996,7
7,AIRPLANE SIERRA,82.85,5
8,AIRPORT POLLOCK,102.81999999999998,4
9,ALABAMA DEVIL,71.88000000000001,9
10,ALADDIN CALENDAR,131.76999999999998,8
11,ALAMO VIDEOTAPE,35.75999999999999,4
12,ALASKA PHANTOM,44.74,7
13,ALI FOREVER,54.91000000000001,5
15,ALIEN CENTER,90.77999999999999,6
16,ALLEY EVOLUTION,52.86000000000002,5
17,ALONE TRIP,62.82000000000002,8
18,ALTER VICTORY,32.779999999999994,4
19,AMADEUS HOLY,33.78999999999999,6
20,AMELIE HELLFIGHTERS,67.9,6
21,AMERICAN CIRCUS,167.78,5
22,AMISTAD MIDSUMMER,70.79000000000002,4
23,ANACONDA CONFESSIONS,60.79000000000002,5
24,ANALYZE HOOSIERS,55.86000000000002,5
25,ANGELS LIFE,119.77999999999997,9
26,ANNIE IDENTITY,59.780000000000015,3
27,ANONYMOUS HUMAN,17.87,9
28,ANTHEM LUKE,85.85,2
29,ANTITRUST TOMATOES,37.90000000000001,7
30,ANYTHING SAVANNAH,46.91000000000001,3
31,APACHE DIVINE,178.69000000000003,4
32,APOCALYPSE FLAMINGOS,30.940000000000005,5
34,ARABIA DOGMA,22.869999999999997,12
35,ARACHNOPHOBIA ROLLERCOASTER,114.75999999999998,8
37,ARIZONA BANG,104.78999999999998,4
39,ARMAGEDDON LOST,45.790000000000006,7
40,ARMY FLINTSTONES,41.84000000000001,7
42,ARTIST COLDBLOODED,69.84000000000002,7
43,ATLANTIS CAUSE,87.75999999999999,9
44,ATTACKS HATE,101.83999999999999,4
45,ATTRACTION NEWTON,146.76,4
46,AUTUMN CROW,84.89,3
47,BABY HALL,45.92000000000001,8
48,BACKLASH UNDEFEATED,158.81,7
49,BADMAN DAWN,76.79,8
50,BAKED CLEOPATRA,79.84,1
51,BALLOON HOMEWARD,98.77,6
52,BALLROOM MOCKINGBIRD,10.920000000000002,7
53,BANG KWAI,22.93,7
54,BANGER PINOCCHIO,42.78000000000001,6
55,BARBARELLA STREETCAR,96.74999999999999,5
56,BAREFOOT MANCHURIAN,66.82000000000002,8
57,BASIC EASY,90.78999999999999,6
58,BEACH HEARTBREAKERS,64.83000000000003,7
59,BEAR GRACELAND,107.77999999999997,3
60,BEAST HUNCHBACK,76.89,5
61,BEAUTY GREASE,132.77999999999997,5
62,BED HIGHBALL,24.940000000000005,5
63,BEDAZZLED MARRIED,16.87,7
64,BEETHOVEN EXORCIST,16.89,6
65,BEHAVIOR RUNAWAY,100.86999999999999,5
66,BENEATH RUSH,16.900000000000002,7
67,BERETS AGENT,78.78,10
68,BETRAYED REAR,91.85,4
69,BEVERLY OUTLAW,115.78999999999998,4
70,BIKINI BORROWERS,98.82999999999998,2
71,BILKO ANONYMOUS,102.86999999999999,3
72,BILL OTHERS,67.81000000000002,6
73,BINGO TALENTED,131.70999999999995,5
74,BIRCH ANTITRUST,74.89,6
75,BIRD INDEPENDENCE,63.890000000000015,2
76,BIRDCAGE CASPER,23.91,4
77,BIRDS PERDITION,111.81999999999998,4
78,BLACKOUT PRIVATE,91.72999999999999,5
79,BLADE POLISH,34.78999999999999,5
80,BLANKET BEVERLY,40.88000000000001,4
81,BLINDNESS GUN,76.86,3
82,BLOOD ARGONAUTS,38.900000000000006,4
83,BLUES INSTINCT,84.78999999999999,4
84,BOILED DARES,77.85000000000001,8
85,BONNIE HOLOCAUST,32.83999999999999,9
86,BOOGIE AMELIE,163.70000000000002,6
88,BORN SPINAL,59.88000000000002,9
89,BORROWERS BEDAZZLED,27.77999999999999,7
90,BOULEVARD MOB,63.820000000000014,8
91,BOUND CHEAPER,50.76000000000001,2
92,BOWFINGER GABLES,56.890000000000015,5
93,BRANNIGAN SUNRISE,74.88000000000001,2
94,BRAVEHEART HUMAN,16.950000000000003,4
95,BREAKFAST GOLDFINGER,109.82999999999997,5
96,BREAKING HOME,51.87000000000002,6
97,BRIDE INTRIGUE,21.809999999999995,1
98,BRIGHT ENCOUNTERS,92.86999999999999,4
99,BRINGING HYSTERICAL,71.80000000000001,2
100,BROOKLYN DESERT,116.78999999999996,5
101,BROTHERHOOD BLANKET,101.73999999999997,5
102,BUBBLE GROSSE,35.940000000000005,3
103,BUCKET BROTHERHOOD,180.66000000000005,6
104,BUGSY SONG,55.890000000000015,2
105,BULL SHAWSHANK,21.839999999999996,8
106,BULWORTH COMMANDMENTS,32.93000000000001,4

2025-01-25 06:14:39 - root - INFO - SQL:
SELECT
  f."film_id",
  f."title",
  tr."total_revenue",
  ac."actor_count",
  tr."total_revenue" / ac."actor_count" AS "average_revenue_per_actor"
FROM "film" f
JOIN (
  SELECT i."film_id", SUM(p."amount") AS "total_revenue"
  FROM "payment" p
  JOIN "rental" r ON p."rental_id" = r."rental_id"
  JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
  GROUP BY i."film_id"
) tr ON f."film_id" = tr."film_id"
JOIN (
  SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
  FROM "film_actor"
  GROUP BY "film_id"
) ac ON f."film_id" = ac."film_id"
LIMIT 100
Results:
Too long, hard cut:
film_id,title,total_revenue,actor_count,average_revenue_per_actor
1,ACADEMY DINOSAUR,36.769999999999996,10,3.6769999999999996
2,ACE GOLDFINGER,52.93000000000001,4,13.232500000000002
3,ADAPTATION HOLES,37.88000000000002,5,7.576000000000003
4,AFFAIR PREJUDICE,91.77,5,18.354
5,AFRICAN EGG,51.88000000000002,5,10.376000000000003
6,AGENT TRUMAN,126.78999999999996,7,18.112857142857138
7,AIRPLANE SIERRA,82.85,5,16.57
8,AIRPORT POLLOCK,102.81999999999998,4,25.704999999999995
9,ALABAMA DEVIL,71.88000000000001,9,7.986666666666668
10,ALADDIN CALENDAR,131.76999999999998,8,16.471249999999998
11,ALAMO VIDEOTAPE,35.75999999999999,4,8.939999999999998
12,ALASKA PHANTOM,44.74,7,6.3914285714285715
13,ALI FOREVER,54.91000000000001,5,10.982000000000003
15,ALIEN CENTER,90.77999999999999,6,15.129999999999997
16,ALLEY EVOLUTION,52.86000000000002,5,10.572000000000005
17,ALONE TRIP,62.82000000000002,8,7.852500000000003
18,ALTER VICTORY,32.779999999999994,4,8.194999999999999
19,AMADEUS HOLY,33.78999999999999,6,5.631666666666665
20,AMELIE HELLFIGHTERS,67.9,6,11.316666666666668
21,AMERICAN CIRCUS,167.78,5,33.556
22,AMISTAD MIDSUMMER,70.79000000000002,4,17.697500000000005
23,ANACONDA CONFESSIONS,60.79000000000002,5,12.158000000000005
24,ANALYZE HOOSIERS,55.86000000000002,5,11.172000000000004
25,ANGELS LIFE,119.77999999999997,9,13.308888888888886
26,ANNIE IDENTITY,59.780000000000015,3,19.926666666666673
27,ANONYMOUS HUMAN,17.87,9,1.9855555555555557
28,ANTHEM LUKE,85.85,2,42.925
29,ANTITRUST TOMATOES,37.90000000000001,7,5.414285714285716
30,ANYTHING SAVANNAH,46.91000000000001,3,15.63666666666667
31,APACHE DIVINE,178.69000000000003,4,44.67250000000001
32,APOCALYPSE FLAMINGOS,30.940000000000005,5,6.188000000000001
34,ARABIA DOGMA,22.869999999999997,12,1.905833333333333
35,ARACHNOPHOBIA ROLLERCOASTER,114.75999999999998,8,14.344999999999997
37,ARIZONA BANG,104.78999999999998,4,26.197499999999994
39,ARMAGEDDON LOST,45.790000000000006,7,6.541428571428573
40,ARMY FLINTSTONES,41.84000000000001,7,5.977142857142859
42,ARTIST COLDBLOODED,69.84000000000002,7,9.97714285714286
43,ATLANTIS CAUSE,87.75999999999999,9,9.75111111111111
44,ATTACKS HATE,101.83999999999999,4,25.459999999999997
45,ATTRACTION NEWTON,146.76,4,36.69
46,AUTUMN CROW,84.89,3,28.296666666666667
47,BABY HALL,45.92000000000001,8,5.740000000000001
48,BACKLASH UNDEFEATED,158.81,7,22.687142857142856
49,BADMAN DAWN,76.79,8,9.59875
50,BAKED CLEOPATRA,79.84,1,79.84
51,BALLOON HOMEWARD,98.77,6,16.461666666666666
52,BALLROOM MOCKINGBIRD,10.920000000000002,7,1.5600000000000003
53,BANG KWAI,22.93,7,3.275714285714286
54,BANGER PINOCCHIO,42.78000000000001,6,7.130000000000002
55,BARBARELLA STREETCAR,96.74999999999999,5,19.349999999999998
56,BAREFOOT MANCHURIAN,66.82000000000002,8,8.352500000000003
57,BASIC EASY,90.78999999999999,6,15.131666666666666
58,BEACH HEARTBREAKERS,64.83000000000003,7,9.261428571428576
59,BEAR GRACELAND,107.77999999999997,3,35.926666666666655
60,BEAST HUNCHBACK,76.89,5,15.378
61,BEAUTY GREASE,132.77999999999997,5,26.555999999999994
62,BED HIGHBALL,24.940000000000005,5,4.988000000000001
63,BEDAZZLED MARRIED,16.87,7,2.41
64,BEETHOVEN EXORCIST,16.89,6,2.815
65,BEHAVIOR RUNAWAY,100.86999999999999,5,20.174
66,BENEATH RUSH,16.900000000000002,7,2.4142857142857146
67,BERETS AGENT,78.78,10,7.878
68,BETRAYED REAR,91.85,4,22.9625
69,BEVERLY OUTLAW,115.78999999999998,4,28.947499999999994
70,BIKINI BORROWERS,98.82999999999998,2,49.41499999999999
71,BILKO ANONYMOUS,102.86999999999999,3,34.29
72,BILL OTHERS,67.81000000000002,6,11.30166666666667
73,BINGO TALENTED,131.70999999999995,5,26.34199999999999
74,BIRCH ANTITRUST,74.89,6,12.481666666666667
75,BIRD INDEPENDENCE,63.890000000000015,2,31.945000000000007
76,BIRDCAGE CASPER,23.91,4,5.9775
77,BIRDS PERDITION,111.81999999999998,4,27.954999999999995
78,BLACKOUT PRIVATE,91.72999999999999,5,18.345999999999997
79,BLADE POLISH,34.78999999999999,5,6.957999999999998
80,BLANKET BEVERLY,40.88000000000001,4,10.220000000000002
81,BLINDNESS GUN,76.86,3,25.62
82,BLOOD ARGONAUTS,38.900000000000006,4,9.725000000000001
83,BLUES INSTINCT,84.78999999999999,4,21.197499999999998
84,BOILED DARES,77.85000000000001,8,9.731250000000001
85,BONNIE HOLOCAUST,32.83999999999999,9,3.6488888888888877
86,BOOGIE AMELIE,163.70000000000002,6,27.283333333333335
88,BORN SPINAL,59.88000000000002,9,6.653333333333335
89,BORROWERS BEDAZZLED,27.77999999999999,7,3.968571428571427
90,BOULEVARD MOB,63.820000000000014,8,7.977500000000002
91,BOUND CHEAPER,50.76000000000001,2,25.380000000000006
92,BOWFINGER GABLES,56.890000000000015,5,11.378000000000004
93,BRANNIGAN SUNRISE,74.88000000000001,2,37.440000000000005
94,BRAVEHEART HUMAN,16.950000000000003,4,4.237500000000001
95,BREAKFAST GOLDFINGER,109.82999999999997,5,21.965999999999994
96,BREAKING HOME,51.87000000000002,6,8.645000000000003
97,BRIDE INTRIGUE,21.809999999999995,1,21.809999999999995
98,BRIGHT ENCOUNTERS,92.86999999999999,4,23.217499999999998
99,BRINGING HYSTERICAL,71.80000000000001,2,35.900000000000006
100,BROOKLYN DESERT,116.789

2025-01-25 06:14:39 - root - INFO - SQL:
SELECT
  a."actor_id",
  a."first_name" || ' ' || a."last_name" AS "actor_name",
  f."title" AS "film_title",
  (tr."total_revenue" / ac."actor_count") AS "average_revenue_per_actor"
FROM "actor" a
JOIN "film_actor" fa ON a."actor_id" = fa."actor_id"
JOIN "film" f ON fa."film_id" = f."film_id"
JOIN (
  SELECT i."film_id", SUM(p."amount") AS "total_revenue"
  FROM "payment" p
  JOIN "rental" r ON p."rental_id" = r."rental_id"
  JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
  GROUP BY i."film_id"
) tr ON f."film_id" = tr."film_id"
JOIN (
  SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
  FROM "film_actor"
  GROUP BY "film_id"
) ac ON f."film_id" = ac."film_id"
ORDER BY a."actor_id", "average_revenue_per_actor" DESC
LIMIT 100
Results:
actor_id,actor_name,film_title,average_revenue_per_actor
1,PENELOPE GUINESS,RULES HUMAN,20.368
1,PENELOPE GUINESS,HUMAN GRAFFITI,20.212500000000002
1,PENELOPE GUINESS,CHEAPER CLYDE,18.4
1,PENELOPE GUINESS,ELEPHANT TROJAN,17.972
1,PENELOPE GUINESS,GLEAMING JAWBREAKER,17.087499999999995
1,PENELOPE GUINESS,LADY STAGE,14.853749999999996
1,PENELOPE GUINESS,COLOR PHILADELPHIA,13.394285714285713
1,PENELOPE GUINESS,ANGELS LIFE,13.308888888888886
1,PENELOPE GUINESS,ANACONDA CONFESSIONS,12.158000000000005
1,PENELOPE GUINESS,KING EVOLUTION,11.151666666666669
1,PENELOPE GUINESS,WIZARD COLDBLOODED,10.87111111111111
1,PENELOPE GUINESS,VERTIGO NORTHWEST,9.480000000000002
1,PENELOPE GUINESS,BULWORTH COMMANDMENTS,8.232500000000002
1,PENELOPE GUINESS,WESTWARD SEABISCUIT,6.29
1,PENELOPE GUINESS,ACADEMY DINOSAUR,3.6769999999999996
1,PENELOPE GUINESS,MULHOLLAND BEAST,3.655
1,PENELOPE GUINESS,SPLASH GUMP,3.3860000000000006
1,PENELOPE GUINESS,LANGUAGE COWBOY,3.3149999999999995
1,PENELOPE GUINESS,OKLAHOMA JUMANJI,0.66
2,NICK WAHLBERG,APACHE DIVINE,44.67250000000001
2,NICK WAHLBERG,JEKYLL FROGMEN,28.94333333333333
2,NICK WAHLBERG,GOODFELLAS SALUTE,26.211250000000007
2,NICK WAHLBERG,LIAISONS SWEET,21.963333333333328
2,NICK WAHLBERG,FIGHT JAWBREAKER,19.926666666666673
2,NICK WAHLBERG,CHISUM BEHAVIOR,18.4675
2,NICK WAHLBERG,CHAINSAW UPTOWN,16.894999999999996
2,NICK WAHLBERG,MALLRATS UNITED,15.55
2,NICK WAHLBERG,DESTINY SATURDAY,13.834285714285713
2,NICK WAHLBERG,FLASH WARS,13.267142857142856
2,NICK WAHLBERG,WARDROBE PHANTOM,11.716249999999999
2,NICK WAHLBERG,MAGUIRE APACHE,8.477500000000003
2,NICK WAHLBERG,ADAPTATION HOLES,7.576000000000003
2,NICK WAHLBERG,SMILE EARRING,7.362500000000002
2,NICK WAHLBERG,MASK PEACH,5.802727272727275
2,NICK WAHLBERG,BABY HALL,5.740000000000001
2,NICK WAHLBERG,INDIAN LOVE,5.084000000000001
2,NICK WAHLBERG,HAPPINESS UNITED,4.588000000000001
2,NICK WAHLBERG,GILBERT PELICAN,4.477500000000001
2,NICK WAHLBERG,JERSEY SASSY,4.437777777777779
2,NICK WAHLBERG,LUCKY FLYING,4.387000000000002
2,NICK WAHLBERG,BULL SHAWSHANK,2.7299999999999995
2,NICK WAHLBERG,RUSHMORE MERMAID,2.705714285714286
2,NICK WAHLBERG,DRACULA CRYSTAL,1.9069230769230763
3,ED CHASE,WHALE BIKINI,26.96399999999999
3,ED CHASE,FORREST SONS,17.564
3,ED CHASE,FRENCH HOLIDAY,14.689999999999998
3,ED CHASE,JEEPERS WEDDING,14.473333333333334
3,ED CHASE,FROST HEAD,10.957142857142857
3,ED CHASE,SPICE SORORITY,10.527272727272724
3,ED CHASE,ARTIST COLDBLOODED,9.97714285714286
3,ED CHASE,PLATOON INSTINCT,9.182000000000002
3,ED CHASE,WEDDING APOLLO,8.175999999999998
3,ED CHASE,ALONE TRIP,7.852500000000003
3,ED CHASE,WEEKEND PERSONAL,7.482000000000001
3,ED CHASE,CADDYSHACK JEDI,7.405714285714287
3,ED CHASE,IMAGE PRINCESS,6.987272727272727
3,ED CHASE,EVE RESURRECTION,6.821666666666668
3,ED CHASE,HUNTER ALTER,6.237500000000001
3,ED CHASE,ARMY FLINTSTONES,5.977142857142859
3,ED CHASE,COWBOY DOOM,5.786000000000001
3,ED CHASE,NECKLACE OUTBREAK,5.481250000000001
3,ED CHASE,LUCK OPUS,5.150000000000001
3,ED CHASE,HALLOWEEN NUTS,5.128571428571429
3,ED CHASE,YOUNG LANGUAGE,1.3860000000000001
4,JENNIFER DAVIS,SILVERADO GOLDFINGER,18.375999999999998
4,JENNIFER DAVIS,POSEIDON FOREVER,16.804999999999996
4,JENNIFER DAVIS,HANOVER GALAXY,14.118571428571427
4,JENNIFER DAVIS,ANGELS LIFE,13.308888888888886
4,JENNIFER DAVIS,ANACONDA CONFESSIONS,12.158000000000005
4,JENNIFER DAVIS,GHOSTBUSTERS ELF,11.91
4,JENNIFER DAVIS,NATIONAL STORY,11.83
4,JENNIFER DAVIS,REDS POCUS,10.582000000000003
4,JENNIFER DAVIS,BAREFOOT MANCHURIAN,8.352500000000003
4,JENNIFER DAVIS,SUBMARINE BED,8.077272727272726
4,JENNIFER DAVIS,BLADE POLISH,6.957999999999998
4,JENNIFER DAVIS,INSTINCT AIRPORT,6.620000000000001
4,JENNIFER DAVIS,JUMANJI BLADE,5.153333333333335
4,JENNIFER DAVIS,BED HIGHBALL,4.988000000000001
4,JENNIFER DAVIS,UNFORGIVEN ZOOLANDER,3.688571428571428
4,JENNIFER DAVIS,SPLASH GUMP,3.3860000000000006
4,JENNIFER DAVIS,RANDOM GO,2.454615384615385
4,JENNIFER DAVIS,GREEDY ROOTS,1.9825000000000002
4,JENNIFER DAVIS,OKLAHOMA JUMANJI,0.66
5,JOHNNY LOLLOBRIGIDA,SUNRISE LEAGUE,34.152
5,JOHNNY LOLLOBRIGIDA,GOODFELLAS SALUTE,26.211250000000007
5,JOHNNY LOLLOBRIGIDA,RIDGEMONT SUBMARINE,26.13599999999999
5,JOHNNY LOLLOBRIGIDA,ESCAPE METROPOLIS,20.1875
5,JOHNNY LOLLOBRIGIDA,HALL CASSIDY,19.767999999999994
5,JOHNNY LOLLOBRIGIDA,STAR OPERATION,17.357999999999997
5,JOHNNY LOLLOBRIGIDA,CONEHEADS SMOOCHY,15.194444444444441
5,JOHNNY LOLLOBRIGIDA,DADDY PITTSBURGH,15.174000000000001
5,JOHNNY LOLLOBRIGIDA,DAISY MENAGERIE,13.69142857142857
5,JOHNNY LOLLOBRIGIDA,METAL ARMAGEDDON,12.968749999999996
5,JOHNNY LOLLOBRIGIDA,PATTON INTERVIEW,11.418888888888889
5,JOHNNY LOLLOBRIGIDA,GRAIL FRANKENSTEIN,10.580000000000002
5,JOHNNY LOLLOBRIGIDA,LOVE SUICIDES,8.95
5,JOHNNY LOLLOBRIGIDA,POCUS PULP,8.748000000000001
5,JOHNNY LOLLOBRIGIDA,FIRE WOLVES,7.9860000000000015
5,JOHNNY LOLLOBRIGIDA,PACIFIC AMISTAD,7.845000000000002
5,JOHNNY LOLLOBRIGIDA,SMILE EARRING,7.362500000000002

2025-01-25 06:14:39 - root - INFO - SQL:
SELECT
  actor_films."actor_name",
  actor_films."film_title",
  actor_films."average_revenue_per_actor"
FROM (
  SELECT
    a."actor_id",
    a."first_name" || ' ' || a."last_name" AS "actor_name",
    f."title" AS "film_title",
    (tr."total_revenue" / ac."actor_count") AS "average_revenue_per_actor",
    ROW_NUMBER() OVER (PARTITION BY a."actor_id" ORDER BY (tr."total_revenue" / ac."actor_count") DESC) AS "rank"
  FROM "actor" a
  JOIN "film_actor" fa ON a."actor_id" = fa."actor_id"
  JOIN "film" f ON fa."film_id" = f."film_id"
  JOIN (
    SELECT i."film_id", SUM(p."amount") AS "total_revenue"
    FROM "payment" p
    JOIN "rental" r ON p."rental_id" = r."rental_id"
    JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
    GROUP BY i."film_id"
  ) tr ON f."film_id" = tr."film_id"
  JOIN (
    SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
    FROM "film_actor"
    GROUP BY "film_id"
  ) ac ON f."film_id" = ac."film_id"
) actor_films
WHERE actor_films."rank" <= 3
ORDER BY actor_films."actor_name", actor_films."average_revenue_per_actor" DESC
LIMIT 100
Results:
actor_name,film_title,average_revenue_per_actor
ADAM GRANT,SEABISCUIT PUNK,31.913333333333327
ADAM GRANT,OPERATION OPERATION,29.24333333333333
ADAM GRANT,TWISTED PIRATES,22.29666666666667
ADAM HOPPER,TORQUE BOUND,39.744000000000014
ADAM HOPPER,PRINCESS GIANT,28.547999999999995
ADAM HOPPER,BLINDNESS GUN,25.62
AL GARLAND,BREAKFAST GOLDFINGER,21.965999999999994
AL GARLAND,DRIFTER COMMANDMENTS,20.25142857142857
AL GARLAND,SILVERADO GOLDFINGER,18.375999999999998
ALAN DREYFUSS,FIDELITY DEVIL,34.69749999999999
ALAN DREYFUSS,STRICTLY SCARFACE,28.442499999999992
ALAN DREYFUSS,BARBARELLA STREETCAR,19.349999999999998
ALBERT JOHANSSON,UNDEFEATED DALMATIONS,38.26333333333332
ALBERT JOHANSSON,LEBOWSKI SOLDIERS,24.26333333333334
ALBERT JOHANSSON,REDEMPTION COMFORTS,22.759999999999994
ALBERT NOLTE,CAMELOT VACATION,50.86499999999998
ALBERT NOLTE,FLINTSTONES HAPPINESS,33.707499999999996
ALBERT NOLTE,MANCHURIAN CURTAIN,32.42500000000001
ALEC WAYNE,HUSTLER PARTY,47.69500000000001
ALEC WAYNE,REIGN GENTLEMEN,36.93333333333332
ALEC WAYNE,CENTER DINOSAUR,34.43999999999999
ANGELA HUDSON,MALTESE HOPE,123.77999999999996
ANGELA HUDSON,PITY BOUND,30.747999999999998
ANGELA HUDSON,ISLAND EXORCIST,28.58
ANGELA WITHERSPOON,CAT CONEHEADS,45.42500000000001
ANGELA WITHERSPOON,SECRET GROUNDHOG,38.929999999999986
ANGELA WITHERSPOON,BRINGING HYSTERICAL,35.900000000000006
ANGELINA ASTAIRE,SAMURAI LION,54.374999999999986
ANGELINA ASTAIRE,HUSTLER PARTY,47.69500000000001
ANGELINA ASTAIRE,INTENTIONS EMPIRE,39.415
ANNE CRONYN,APACHE DIVINE,44.67250000000001
ANNE CRONYN,MOON BUNCH,38.70999999999999
ANNE CRONYN,MINDS TRUMAN,24.96666666666667
AUDREY BAILEY,QUILLS BULL,25.209999999999997
AUDREY BAILEY,DISTURBING SCARFACE,22.435
AUDREY BAILEY,DRIFTER COMMANDMENTS,20.25142857142857
AUDREY OLIVIER,DORADO NOTTING,44.182500000000005
AUDREY OLIVIER,WHALE BIKINI,26.96399999999999
AUDREY OLIVIER,STING PERSONAL,22.827142857142857
BELA WALKEN,MIDSUMMER GROUNDHOG,78.39
BELA WALKEN,WHISPERER GIANT,50.593333333333334
BELA WALKEN,ENEMY ODDS,45.17750000000001
BEN HARRIS,MUSKETEERS WAIT,92.83
BEN HARRIS,TOURIST PELICAN,47.25999999999999
BEN HARRIS,BEAR GRACELAND,35.926666666666655
BEN WILLIS,GOODFELLAS SALUTE,26.211250000000007
BEN WILLIS,HEAVYWEIGHTS BEAST,25.95399999999999
BEN WILLIS,CHANCE RESURRECTION,23.621666666666666
BETTE NICHOLSON,BIKINI BORROWERS,49.41499999999999
BETTE NICHOLSON,TRADING PINOCCHIO,49.25
BETTE NICHOLSON,COLDBLOODED DARLING,22.459999999999997
BOB FAWCETT,PELICAN COMFORTS,37.748000000000005
BOB FAWCETT,CIRCUS YOUTH,30.42500000000001
BOB FAWCETT,RAGING AIRPLANE,28.289999999999996
BURT DUKAKIS,RANGE MOONWALKER,44.932500000000005
BURT DUKAKIS,BLINDNESS GUN,25.62
BURT DUKAKIS,TRUMAN CRAZY,20.294999999999995
BURT POSEY,MINDS TRUMAN,24.96666666666667
BURT POSEY,DESERT POSEIDON,23.761999999999993
BURT POSEY,SATURDAY LAMBS,22.746666666666673
BURT TEMPLE,ROSES TREASURE,34.34400000000001
BURT TEMPLE,BUCKET BROTHERHOOD,30.11000000000001
BURT TEMPLE,HEAVYWEIGHTS BEAST,25.95399999999999
CAMERON STREEP,PURE RUNNER,46.419999999999995
CAMERON STREEP,BLUES INSTINCT,21.197499999999998
CAMERON STREEP,MOVIE SHAKESPEARE,18.217499999999998
CAMERON WRAY,COMA HEAD,45.91333333333332
CAMERON WRAY,TITANS JERK,28.815714285714296
CAMERON WRAY,BINGO TALENTED,26.34199999999999
CAMERON ZELLWEGER,WIFE TURN,37.28166666666668
CAMERON ZELLWEGER,GRIT CLOCKWORK,36.89333333333332
CAMERON ZELLWEGER,HARRY IDAHO,32.61666666666668
CARMEN HUNT,TELEGRAPH VOYAGE,33.10428571428572
CARMEN HUNT,MOONSHINE CABIN,28.357999999999993
CARMEN HUNT,TEEN APOLLO,25.565999999999995
CARY MCCONAUGHEY,DOLLS RAGE,30.910000000000004
CARY MCCONAUGHEY,BINGO TALENTED,26.34199999999999
CARY MCCONAUGHEY,RULES HUMAN,20.368
CATE HARRIS,SCARFACE BANG,17.259999999999994
CATE HARRIS,ROLLERCOASTER BRINGING,15.300000000000004
CATE HARRIS,GREEK EVERYONE,13.957500000000005
CATE MCQUEEN,NAME DETECTIVE,45.589999999999996
CATE MCQUEEN,SNATCH SLIPPER,42.59333333333332
CATE MCQUEEN,SALUTE APOLLO,26.692499999999995
CHARLIZE DENCH,BUCKET BROTHERHOOD,30.11000000000001
CHARLIZE DENCH,JOON NORTHWEST,19.915000000000003
CHARLIZE DENCH,CANDLES GRAPES,18.39571428571428
CHRIS BRIDGES,CONVERSATION DOWNHILL,38.27666666666666
CHRIS BRIDGES,SATURN NAME,35.435
CHRIS BRIDGES,WONDERLAND CHRISTMAS,29.756
CHRIS DEPP,SCALAWAG DUCK,34.53600000000001
CHRIS DEPP,SABRINA MIDNIGHT,31.69749999999999
CHRIS DEPP,EAGLES PANKY,25.463333333333328
CHRISTIAN AKROYD,INNOCENT USUAL,63.913333333333355
CHRISTIAN AKROYD,SABRINA MIDNIGHT,31.69749999999999
CHRISTIAN AKROYD,OPERATION OPERATION,29.24333333333333
CHRISTIAN GABLE,DRAGONFLY STRANGERS,34.60666666666666
CHRISTIAN GABLE,GOLDFINGER SENSIBILITY,20.439999999999998
CHRISTIAN GABLE,WATERFRONT DELIVERANCE,20.304999999999996
CHRISTIAN NEESON,SCALAWAG DUCK,34.53600000000001

2025-01-25 06:14:39 - root - INFO - SQL:
SELECT
  a."actor_id",
  a."first_name" || ' ' || a."last_name" AS "actor_name",
  SUM(tr."total_revenue" / ac."actor_count") AS "total_average_revenue"
FROM "actor" a
JOIN "film_actor" fa ON a."actor_id" = fa."actor_id"
JOIN "film" f ON fa."film_id" = f."film_id"
JOIN (
  SELECT i."film_id", SUM(p."amount") AS "total_revenue"
  FROM "payment" p
  JOIN "rental" r ON p."rental_id" = r."rental_id"
  JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
  GROUP BY i."film_id"
) tr ON f."film_id" = tr."film_id"
JOIN (
  SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
  FROM "film_actor"
  GROUP BY "film_id"
) ac ON f."film_id" = ac."film_id"
GROUP BY a."actor_id", a."first_name", a."last_name"
ORDER BY "total_average_revenue" DESC
LIMIT 100
Results:
actor_id,actor_name,total_average_revenue
107,GINA DEGENERES,607.222749084249
142,JADA RYDER,546.9910119047618
102,WALTER TORN,542.0257847985348
65,ANGELA HUDSON,531.2862542735044
144,ANGELA WITHERSPOON,522.8858333333333
197,REESE WEST,511.3194072039073
181,MATTHEW CARREY,507.6837009379511
60,HENRY BERRY,506.704932900433
127,KEVIN GARLAND,494.1699606782107
198,MARY KEITEL,488.7295584415583
58,CHRISTIAN AKROYD,485.8391659451659
106,GROUCHO DUNST,483.4761259018758
90,SEAN GUINESS,480.81424531024527
26,RIP CRAWFORD,475.2172889610391
74,MILLA KEITEL,471.2873531746031
185,MICHAEL BOLGER,466.52034163059153
13,UMA WOOD,466.0097142857143
103,MATTHEW LEIGH,464.32435317460306
147,FAY WINSLET,460.1544862914862
50,NATALIE HOPKINS,450.2665970418471
81,SCARLETT DAMON,450.0970772005772
140,WHOOPI HURT,447.8008971861472
76,ANGELINA ASTAIRE,444.73329670329684
66,MARY TANDY,440.490024891775
117,RENEE TRACY,439.1718134920635
48,FRANCES DAY-LEWIS,437.1550476190476
45,REESE KILMER,434.2284660339661
196,BELA WALKEN,433.6079603174604
42,TOM MIRANDA,433.38969841269835
92,KIRSTEN AKROYD,428.61628896103906
125,ALBERT NOLTE,422.5861071428571
192,JOHN SUVARI,416.57629509379507
136,ED MANSFIELD,414.47372294372286
28,WOODY HOFFMAN,411.57804256854257
104,PENELOPE CRONYN,411.503488095238
70,MICHELLE MCCONAUGHEY,408.03595770895765
27,JULIA MCQUEEN,407.55167532467544
41,JODIE DEGENERES,407.4537722832722
151,GEOFFREY HESTON,407.4316717171716
111,CAMERON ZELLWEGER,405.0962665945167
17,HELEN VOIGHT,404.58936849261846
166,NICK DEGENERES,401.77243315018313
134,GENE HOPKINS,398.2082380952382
184,HUMPHREY GARLAND,397.1778217338218
23,SANDRA KILMER,395.40821645021634
86,GREG CHAPLIN,395.0029905372406
150,JAYNE NOLTE,394.9416551226552
83,BEN WILLIS,393.2984905372405
73,GARY PENN,390.54019155844156
21,KIRSTEN PALTROW,389.9673268398268
59,DUSTIN TAUTOU,389.2956865079364
108,WARREN NOLTE,387.7270487012986
94,KENNETH TORN,387.1891706349207
84,JAMES PITT,385.177686868687
146,ALBERT JOHANSSON,385.09842857142854
152,BEN HARRIS,382.52385461760457
139,EWAN GOODING,380.89083730158734
57,JUDE CRUISE,379.6853574481075
14,VIVIEN BERGEN,378.821507936508
101,SUSAN DAVIS,378.2139923687424
158,VIVIEN BASINGER,376.99321500721504
187,RENEE BALL,376.74979076479076
67,JESSICA BAILEY,376.1309761904762
39,GOLDIE BRODY,373.5916022588523
62,JAYNE NEESON,368.2951031746032
159,LAURA BRODY,362.56239610389616
149,RUSSELL TEMPLE,360.6881868131868
82,WOODY JOLIE,359.73663492063497
119,WARREN JACKMAN,359.41975505050505
16,FRED COSTNER,359.32163383838383
168,WILL WILSON,356.43369047619046
191,GREGORY GOODING,354.5910562770563
112,RUSSELL BACALL,352.67795543345534
29,ALEC WAYNE,352.64659595959597
175,WILLIAM HACKMAN,352.2957936507937
177,GENE MCKELLEN,346.6084415584416
164,HUMPHREY WILLIS,346.4399404761905
122,SALMA NOLTE,345.6363315295816
44,NICK STALLONE,345.097708874459
51,GARY PHOENIX,344.7477128427128
95,DARYL WAHLBERG,342.55151443001455
145,KIM ALLEN,341.1834206349207
72,SEAN WILLIAMS,340.48099847374846
53,MENA TEMPLE,339.33301587301594
105,SIDNEY CROWE,338.29100918525927
49,ANNE CRONYN,337.96353571428574
46,PARKER GOLDBERG,337.7927662337662
155,IAN TANDY,337.7346214896214
43,KIRK JOVOVICH,337.1613917748918
68,RIP WINSLET,337.013246031746
33,MILLA PECK,337.0014642857142
20,LUCILLE TRACY,335.7116196581197
37,VAL BOLGER,335.29531018981015
120,PENELOPE MONROE,334.54473845598847
78,GROUCHO SINATRA,334.4087463924964
64,RAY JOHANSSON,333.55023809523817
7,GRACE MOSTEL,333.4468015873016
34,AUDREY OLIVIER,331.71352777777776
169,KENNETH HOFFMAN,330.2713015873016
15,CUBA OLIVIER,329.75532251082257

2025-01-25 06:15:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 06:15:09 - root - INFO - ```sql
SELECT
  a."actor_id",
  a."first_name" || ' ' || a."last_name" AS "actor_name",
  SUM(COALESCE(tr."total_revenue", 0) / NULLIF(ac."actor_count", 0)) AS "total_average_revenue"
FROM "actor" a
JOIN "film_actor" fa ON a."actor_id" = fa."actor_id"
JOIN "film" f ON fa."film_id" = f."film_id"
LEFT JOIN (
  SELECT i."film_id", SUM(p."amount") AS "total_revenue"
  FROM "payment" p
  JOIN "rental" r ON p."rental_id" = r."rental_id"
  JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
  GROUP BY i."film_id"
) tr ON f."film_id" = tr."film_id"
LEFT JOIN (
  SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
  FROM "film_actor"
  GROUP BY "film_id"
) ac ON f."film_id" = ac."film_id"
GROUP BY a."actor_id", a."first_name", a."last_name"
HAVING SUM(COALESCE(tr."total_revenue", 0) / NULLIF(ac."actor_count", 0)) IS NOT NULL
ORDER BY "total_average_revenue" DESC
LIMIT 100;
```

**Explanation:**

The original query returned no data because there might be films without any rentals or payments, resulting in `NULL` values for `total_revenue`, or films with zero actors, causing a division by zero when calculating `average_revenue_per_actor`.

**Modifications Made:**

- **Used `LEFT JOIN`**: Changed the joins to `LEFT JOIN` for the subqueries `tr` (total revenue per film) and `ac` (actor count per film) to include films even if they have no associated payments or actor counts.

- **Handled `NULL` and Zero Values**:
  - Used `COALESCE(tr."total_revenue", 0)` to treat `NULL` total revenues as zero.
  - Used `NULLIF(ac."actor_count", 0)` to prevent division by zero when the actor count is zero. If `actor_count` is zero, `NULLIF` returns `NULL`, and the division yields `NULL`, which is ignored in the `SUM` aggregation.
  
- **Added `HAVING` Clause**:
  - Included a `HAVING` clause to exclude actors where the calculated `total_average_revenue` is `NULL`, ensuring only actors with valid revenue contributions are listed.

This corrected query calculates the total average revenue per actor by summing the average revenue per actor for each film they've appeared in, even if some films have no rentals or payments. It prevents division by zero and includes actors who might have appeared in films without recorded revenues.
2025-01-25 06:15:50 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 06:15:50 - root - INFO - SQL:
SELECT
  a."actor_id",
  a."first_name" || ' ' || a."last_name" AS "actor_name",
  SUM(COALESCE(tr."total_revenue", 0) / NULLIF(ac."actor_count", 0)) AS "total_average_revenue"
FROM "actor" a
JOIN "film_actor" fa ON a."actor_id" = fa."actor_id"
JOIN "film" f ON fa."film_id" = f."film_id"
LEFT JOIN (
  SELECT i."film_id", SUM(p."amount") AS "total_revenue"
  FROM "payment" p
  JOIN "rental" r ON p."rental_id" = r."rental_id"
  JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
  GROUP BY i."film_id"
) tr ON f."film_id" = tr."film_id"
LEFT JOIN (
  SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
  FROM "film_actor"
  GROUP BY "film_id"
) ac ON f."film_id" = ac."film_id"
GROUP BY a."actor_id", a."first_name", a."last_name"
HAVING SUM(COALESCE(tr."total_revenue", 0) / NULLIF(ac."actor_count", 0)) IS NOT NULL
ORDER BY "total_average_revenue" DESC
LIMIT 100;
Results:
actor_id,actor_name,total_average_revenue
107,GINA DEGENERES,607.222749084249
142,JADA RYDER,546.9910119047618
102,WALTER TORN,542.0257847985348
65,ANGELA HUDSON,531.2862542735044
144,ANGELA WITHERSPOON,522.8858333333333
197,REESE WEST,511.3194072039073
181,MATTHEW CARREY,507.6837009379511
60,HENRY BERRY,506.704932900433
127,KEVIN GARLAND,494.1699606782107
198,MARY KEITEL,488.7295584415583
58,CHRISTIAN AKROYD,485.8391659451659
106,GROUCHO DUNST,483.4761259018758
90,SEAN GUINESS,480.81424531024527
26,RIP CRAWFORD,475.2172889610391
74,MILLA KEITEL,471.2873531746031
185,MICHAEL BOLGER,466.52034163059153
13,UMA WOOD,466.0097142857143
103,MATTHEW LEIGH,464.32435317460306
147,FAY WINSLET,460.1544862914862
50,NATALIE HOPKINS,450.2665970418471
81,SCARLETT DAMON,450.0970772005772
140,WHOOPI HURT,447.8008971861472
76,ANGELINA ASTAIRE,444.73329670329684
66,MARY TANDY,440.490024891775
117,RENEE TRACY,439.1718134920635
48,FRANCES DAY-LEWIS,437.1550476190476
45,REESE KILMER,434.2284660339661
196,BELA WALKEN,433.6079603174604
42,TOM MIRANDA,433.38969841269835
92,KIRSTEN AKROYD,428.61628896103906
125,ALBERT NOLTE,422.5861071428571
192,JOHN SUVARI,416.57629509379507
136,ED MANSFIELD,414.47372294372286
28,WOODY HOFFMAN,411.57804256854257
104,PENELOPE CRONYN,411.503488095238
70,MICHELLE MCCONAUGHEY,408.03595770895765
27,JULIA MCQUEEN,407.55167532467544
41,JODIE DEGENERES,407.4537722832722
151,GEOFFREY HESTON,407.4316717171716
111,CAMERON ZELLWEGER,405.0962665945167
17,HELEN VOIGHT,404.58936849261846
166,NICK DEGENERES,401.77243315018313
134,GENE HOPKINS,398.2082380952382
184,HUMPHREY GARLAND,397.1778217338218
23,SANDRA KILMER,395.40821645021634
86,GREG CHAPLIN,395.0029905372406
150,JAYNE NOLTE,394.9416551226552
83,BEN WILLIS,393.2984905372405
73,GARY PENN,390.54019155844156
21,KIRSTEN PALTROW,389.9673268398268
59,DUSTIN TAUTOU,389.2956865079364
108,WARREN NOLTE,387.7270487012986
94,KENNETH TORN,387.1891706349207
84,JAMES PITT,385.177686868687
146,ALBERT JOHANSSON,385.09842857142854
152,BEN HARRIS,382.52385461760457
139,EWAN GOODING,380.89083730158734
57,JUDE CRUISE,379.6853574481075
14,VIVIEN BERGEN,378.821507936508
101,SUSAN DAVIS,378.2139923687424
158,VIVIEN BASINGER,376.99321500721504
187,RENEE BALL,376.74979076479076
67,JESSICA BAILEY,376.1309761904762
39,GOLDIE BRODY,373.5916022588523
62,JAYNE NEESON,368.2951031746032
159,LAURA BRODY,362.56239610389616
149,RUSSELL TEMPLE,360.6881868131868
82,WOODY JOLIE,359.73663492063497
119,WARREN JACKMAN,359.41975505050505
16,FRED COSTNER,359.32163383838383
168,WILL WILSON,356.43369047619046
191,GREGORY GOODING,354.5910562770563
112,RUSSELL BACALL,352.67795543345534
29,ALEC WAYNE,352.64659595959597
175,WILLIAM HACKMAN,352.2957936507937
177,GENE MCKELLEN,346.6084415584416
164,HUMPHREY WILLIS,346.4399404761905
122,SALMA NOLTE,345.6363315295816
44,NICK STALLONE,345.097708874459
51,GARY PHOENIX,344.7477128427128
95,DARYL WAHLBERG,342.55151443001455
145,KIM ALLEN,341.1834206349207
72,SEAN WILLIAMS,340.48099847374846
53,MENA TEMPLE,339.33301587301594
105,SIDNEY CROWE,338.29100918525927
49,ANNE CRONYN,337.96353571428574
46,PARKER GOLDBERG,337.7927662337662
155,IAN TANDY,337.7346214896214
43,KIRK JOVOVICH,337.1613917748918
68,RIP WINSLET,337.013246031746
33,MILLA PECK,337.0014642857142
20,LUCILLE TRACY,335.7116196581197
37,VAL BOLGER,335.29531018981015
120,PENELOPE MONROE,334.54473845598847
78,GROUCHO SINATRA,334.4087463924964
64,RAY JOHANSSON,333.55023809523817
7,GRACE MOSTEL,333.4468015873016
34,AUDREY OLIVIER,331.71352777777776
169,KENNETH HOFFMAN,330.2713015873016
15,CUBA OLIVIER,329.75532251082257

2025-01-25 06:15:50 - root - INFO - itercount: 0
2025-01-25 06:15:50 - root - INFO - Table: actorDDL:
CREATE TABLE actor (
  actor_id numeric NOT NULL ,
  first_name VARCHAR(45) NOT NULL,
  last_name VARCHAR(45) NOT NULL,
  last_update TIMESTAMP NOT NULL,
  PRIMARY KEY  (actor_id)
  )
Table: countryDDL:
CREATE TABLE country (
  country_id SMALLINT NOT NULL,
  country VARCHAR(50) NOT NULL,
  last_update TIMESTAMP,
  PRIMARY KEY  (country_id)
)
Table: cityDDL:
CREATE TABLE city (
  city_id int NOT NULL,
  city VARCHAR(50) NOT NULL,
  country_id SMALLINT NOT NULL,
  last_update TIMESTAMP NOT NULL,
  PRIMARY KEY  (city_id),
  CONSTRAINT fk_city_country FOREIGN KEY (country_id) REFERENCES country (country_id) ON DELETE NO ACTION ON UPDATE CASCADE
)
Table: addressDDL:
CREATE TABLE address (
  address_id int NOT NULL,
  address VARCHAR(50) NOT NULL,
  address2 VARCHAR(50) DEFAULT NULL,
  district VARCHAR(20) NOT NULL,
  city_id INT  NOT NULL,
  postal_code VARCHAR(10) DEFAULT NULL,
  phone VARCHAR(20) NOT NULL,
  last_update TIMESTAMP NOT NULL,
  PRIMARY KEY  (address_id),
  CONSTRAINT fk_address_city FOREIGN KEY (city_id) REFERENCES city (city_id) ON DELETE NO ACTION ON UPDATE CASCADE
)
Table: languageDDL:
CREATE TABLE language (
  language_id SMALLINT NOT NULL ,
  name CHAR(20) NOT NULL,
  last_update TIMESTAMP NOT NULL,
  PRIMARY KEY (language_id)
)
Table: categoryDDL:
CREATE TABLE category (
  category_id SMALLINT NOT NULL,
  name VARCHAR(25) NOT NULL,
  last_update TIMESTAMP NOT NULL,
  PRIMARY KEY  (category_id)
)
Table: customerDDL:
CREATE TABLE customer (
  customer_id INT NOT NULL,
  store_id INT NOT NULL,
  first_name VARCHAR(45) NOT NULL,
  last_name VARCHAR(45) NOT NULL,
  email VARCHAR(50) DEFAULT NULL,
  address_id INT NOT NULL,
  active CHAR(1) DEFAULT 'Y' NOT NULL,
  create_date TIMESTAMP NOT NULL,
  last_update TIMESTAMP NOT NULL,
  PRIMARY KEY  (customer_id),
  CONSTRAINT fk_customer_store FOREIGN KEY (store_id) REFERENCES store (store_id) ON DELETE NO ACTION ON UPDATE CASCADE,
  CONSTRAINT fk_customer_address FOREIGN KEY (address_id) REFERENCES address (address_id) ON DELETE NO ACTION ON UPDATE CASCADE
)
Table: filmDDL:
CREATE TABLE film (
  film_id int NOT NULL,
  title VARCHAR(255) NOT NULL,
  description BLOB SUB_TYPE TEXT DEFAULT NULL,
  release_year VARCHAR(4) DEFAULT NULL,
  language_id SMALLINT NOT NULL,
  original_language_id SMALLINT DEFAULT NULL,
  rental_duration SMALLINT  DEFAULT 3 NOT NULL,
  rental_rate DECIMAL(4,2) DEFAULT 4.99 NOT NULL,
  length SMALLINT DEFAULT NULL,
  replacement_cost DECIMAL(5,2) DEFAULT 19.99 NOT NULL,
  rating VARCHAR(10) DEFAULT 'G',
  special_features VARCHAR(100) DEFAULT NULL,
  last_update TIMESTAMP NOT NULL,
  PRIMARY KEY  (film_id),
  CONSTRAINT CHECK_special_features CHECK(special_features is null or
                                                           special_features like '%Trailers%' or
                                                           special_features like '%Commentaries%' or
                                                           special_features like '%Deleted Scenes%' or
                                                           special_features like '%Behind the Scenes%'),
  CONSTRAINT CHECK_special_rating CHECK(rating in ('G','PG','PG-13','R','NC-17')),
  CONSTRAINT fk_film_language FOREIGN KEY (language_id) REFERENCES language (language_id) ,
  CONSTRAINT fk_film_language_original FOREIGN KEY (original_language_id) REFERENCES language (language_id)
)
Table: film_actorDDL:
CREATE TABLE film_actor (
  actor_id INT NOT NULL,
  film_id  INT NOT NULL,
  last_update TIMESTAMP NOT NULL,
  PRIMARY KEY  (actor_id,film_id),
  CONSTRAINT fk_film_actor_actor FOREIGN KEY (actor_id) REFERENCES actor (actor_id) ON DELETE NO ACTION ON UPDATE CASCADE,
  CONSTRAINT fk_film_actor_film FOREIGN KEY (film_id) REFERENCES film (film_id) ON DELETE NO ACTION ON UPDATE CASCADE
)
Table: film_categoryDDL:
CREATE TABLE film_category (
  film_id INT NOT NULL,
  category_id SMALLINT  NOT NULL,
  last_update TIMESTAMP NOT NULL,
  PRIMARY KEY (film_id, category_id),
  CONSTRAINT fk_film_category_film FOREIGN KEY (film_id) REFERENCES film (film_id) ON DELETE NO ACTION ON UPDATE CASCADE,
  CONSTRAINT fk_film_category_category FOREIGN KEY (category_id) REFERENCES category (category_id) ON DELETE NO ACTION ON UPDATE CASCADE
)
Table: film_textDDL:
CREATE TABLE film_text (
  film_id SMALLINT NOT NULL,
  title VARCHAR(255) NOT NULL,
  description BLOB SUB_TYPE TEXT,
  PRIMARY KEY  (film_id)
)
Table: inventoryDDL:
CREATE TABLE inventory (
  inventory_id INT NOT NULL,
  film_id INT NOT NULL,
  store_id INT NOT NULL,
  last_update TIMESTAMP NOT NULL,
  PRIMARY KEY  (inventory_id),
  CONSTRAINT fk_inventory_store FOREIGN KEY (store_id) REFERENCES store (store_id) ON DELETE NO ACTION ON UPDATE CASCADE,
  CONSTRAINT fk_inventory_film FOREIGN KEY (film_id) REFERENCES film (film_id) ON DELETE NO ACTION ON UPDATE CASCADE
)
Table: staffDDL:
CREATE TABLE staff (
  staff_id SMALLINT NOT NULL,
  first_name VARCHAR(45) NOT NULL,
  last_name VARCHAR(45) NOT NULL,
  address_id INT NOT NULL,
  picture BLOB DEFAULT NULL,
  email VARCHAR(50) DEFAULT NULL,
  store_id INT NOT NULL,
  active SMALLINT DEFAULT 1 NOT NULL,
  username VARCHAR(16) NOT NULL,
  password VARCHAR(40) DEFAULT NULL,
  last_update TIMESTAMP NOT NULL,
  PRIMARY KEY  (staff_id),
  CONSTRAINT fk_staff_store FOREIGN KEY (store_id) REFERENCES store (store_id) ON DELETE NO ACTION ON UPDATE CASCADE,
  CONSTRAINT fk_staff_address FOREIGN KEY (address_id) REFERENCES address (address_id) ON DELETE NO ACTION ON UPDATE CASCADE
)
Table: storeDDL:
CREATE TABLE store (
  store_id INT NOT NULL,
  manager_staff_id SMALLINT NOT NULL,
  address_id INT NOT NULL,
  last_update TIMESTAMP NOT NULL,
  PRIMARY KEY  (store_id),
  CONSTRAINT fk_store_staff FOREIGN KEY (manager_staff_id) REFERENCES staff (staff_id) ,
  CONSTRAINT fk_store_address FOREIGN KEY (address_id) REFERENCES address (address_id)
)
Table: paymentDDL:
CREATE TABLE payment (
  payment_id int NOT NULL,
  customer_id INT  NOT NULL,
  staff_id SMALLINT NOT NULL,
  rental_id INT DEFAULT NULL,
  amount DECIMAL(5,2) NOT NULL,
  payment_date TIMESTAMP NOT NULL,
  last_update TIMESTAMP NOT NULL,
  PRIMARY KEY  (payment_id),
  CONSTRAINT fk_payment_rental FOREIGN KEY (rental_id) REFERENCES rental (rental_id) ON DELETE SET NULL ON UPDATE CASCADE,
  CONSTRAINT fk_payment_customer FOREIGN KEY (customer_id) REFERENCES customer (customer_id) ,
  CONSTRAINT fk_payment_staff FOREIGN KEY (staff_id) REFERENCES staff (staff_id)
)
Table: rentalDDL:
CREATE TABLE rental (
  rental_id INT NOT NULL,
  rental_date TIMESTAMP NOT NULL,
  inventory_id INT  NOT NULL,
  customer_id INT  NOT NULL,
  return_date TIMESTAMP DEFAULT NULL,
  staff_id SMALLINT  NOT NULL,
  last_update TIMESTAMP NOT NULL,
  PRIMARY KEY (rental_id),
  CONSTRAINT fk_rental_staff FOREIGN KEY (staff_id) REFERENCES staff (staff_id) ,
  CONSTRAINT fk_rental_inventory FOREIGN KEY (inventory_id) REFERENCES inventory (inventory_id) ,
  CONSTRAINT fk_rental_customer FOREIGN KEY (customer_id) REFERENCES customer (customer_id)
)
External knowledge that might be helpful: 
None
The table structure information is (table names): 
['actor', 'country', 'city', 'address', 'language', 'category', 'customer', 'film', 'film_actor', 'film_category', 'film_text', 'inventory', 'staff', 'store', 'payment', 'rental']
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **actor**
   - `"actor_id"`: Unique identifier for each actor. **Usage**: To join with `film_actor` to find films an actor has appeared in.
   - `"first_name"`: Actor's first name. **Usage**: To display the actor's name.
   - `"last_name"`: Actor's last name.

2. **film**
   - `"film_id"`: Unique identifier for each film. **Usage**: To join with `inventory` and `film_actor` to relate films to rentals and actors.
   - `"title"`: Title of the film. **Usage**: To display film titles.

3. **film_actor**
   - `"actor_id"`: References `actor(actor_id)`. **Usage**: To associate actors with films.
   - `"film_id"`: References `film(film_id)`.

4. **inventory**
   - `"inventory_id"`: Unique identifier for each inventory item. **Usage**: To join with `rental` to find rentals of specific films.
   - `"film_id"`: References `film(film_id)`.

5. **rental**
   - `"rental_id"`: Unique identifier for each rental. **Usage**: To join with `payment` and `inventory` to calculate revenue per film.
   - `"inventory_id"`: References `inventory(inventory_id)`.

6. **payment**
   - `"payment_id"`: Unique identifier for each payment.
   - `"rental_id"`: References `rental(rental_id)`. **Usage**: To associate payments with rentals.
   - `"amount"`: Payment amount. **Usage**: To calculate total revenue per film.

**Conditions That May Be Used:**

- Joining `payment` to `rental` on `"rental_id"` to find payments for rentals.
- Joining `rental` to `inventory` on `"inventory_id"` to relate rentals to films.
- Joining `inventory` to `film` on `"film_id"` to identify films rented.
- Joining `film_actor` to `film` and `actor` to associate actors with films.
- Grouping and aggregating data to calculate total revenue per film and average revenue per actor.
- Ordering results to identify top revenue-generating films per actor.

**SQL Queries:**

1. **List of All Actors:**

   ```sql
   SELECT DISTINCT "actor_id", "first_name", "last_name"
   FROM "actor"
   LIMIT 100;
   ```

2. **List of All Films:**

   ```sql
   SELECT DISTINCT "film_id", "title"
   FROM "film"
   LIMIT 100;
   ```

3. **List of All Payments:**

   ```sql
   SELECT "payment_id", "rental_id", "amount"
   FROM "payment"
   LIMIT 100;
   ```

4. **List of All Rentals:**

   ```sql
   SELECT "rental_id", "inventory_id", "customer_id"
   FROM "rental"
   LIMIT 100;
   ```

5. **List of Films with Total Revenue:**

   ```sql
   SELECT f."film_id", f."title", SUM(p."amount") AS "total_revenue"
   FROM "payment" p
   JOIN "rental" r ON p."rental_id" = r."rental_id"
   JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
   JOIN "film" f ON i."film_id" = f."film_id"
   GROUP BY f."film_id", f."title"
   ORDER BY "total_revenue" DESC
   LIMIT 100;
   ```

6. **Number of Actors in Each Film:**

   ```sql
   SELECT fa."film_id", COUNT(fa."actor_id") AS "actor_count"
   FROM "film_actor" fa
   GROUP BY fa."film_id"
   LIMIT 100;
   ```

7. **List of Actors in a Specific Film:**

   ```sql
   SELECT f."title", a."first_name", a."last_name"
   FROM "film" f
   JOIN "film_actor" fa ON f."film_id" = fa."film_id"
   JOIN "actor" a ON fa."actor_id" = a."actor_id"
   WHERE f."title" LIKE '%TARGET_FILM_TITLE%'
   LIMIT 100;
   ```

8. **Calculate Total Revenue per Film:**

   ```sql
   SELECT i."film_id", SUM(p."amount") AS "total_revenue"
   FROM "payment" p
   JOIN "rental" r ON p."rental_id" = r."rental_id"
   JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
   GROUP BY i."film_id"
   LIMIT 100;
   ```

9. **Calculate Actor Count per Film:**

   ```sql
   SELECT fa."film_id", COUNT(DISTINCT fa."actor_id") AS "actor_count"
   FROM "film_actor" fa
   GROUP BY fa."film_id"
   LIMIT 100;
   ```

10. **Combine Revenue and Actor Count per Film:**

    ```sql
    SELECT f."film_id", f."title", tr."total_revenue", ac."actor_count"
    FROM "film" f
    JOIN (
      SELECT i."film_id", SUM(p."amount") AS "total_revenue"
      FROM "payment" p
      JOIN "rental" r ON p."rental_id" = r."rental_id"
      JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
      GROUP BY i."film_id"
    ) tr ON f."film_id" = tr."film_id"
    JOIN (
      SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
      FROM "film_actor"
      GROUP BY "film_id"
    ) ac ON f."film_id" = ac."film_id"
    LIMIT 100;
    ```

11. **Calculate Average Revenue per Actor per Film:**

    ```sql
    SELECT
      f."film_id",
      f."title",
      tr."total_revenue",
      ac."actor_count",
      tr."total_revenue" / ac."actor_count" AS "average_revenue_per_actor"
    FROM "film" f
    JOIN (
      SELECT i."film_id", SUM(p."amount") AS "total_revenue"
      FROM "payment" p
      JOIN "rental" r ON p."rental_id" = r."rental_id"
      JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
      GROUP BY i."film_id"
    ) tr ON f."film_id" = tr."film_id"
    JOIN (
      SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
      FROM "film_actor"
      GROUP BY "film_id"
    ) ac ON f."film_id" = ac."film_id"
    LIMIT 100;
    ```

12. **List Films and Average Revenue per Actor for Each Actor:**

    ```sql
    SELECT
      a."actor_id",
      a."first_name" || ' ' || a."last_name" AS "actor_name",
      f."title" AS "film_title",
      (tr."total_revenue" / ac."actor_count") AS "average_revenue_per_actor"
    FROM "actor" a
    JOIN "film_actor" fa ON a."actor_id" = fa."actor_id"
    JOIN "film" f ON fa."film_id" = f."film_id"
    JOIN (
      SELECT i."film_id", SUM(p."amount") AS "total_revenue"
      FROM "payment" p
      JOIN "rental" r ON p."rental_id" = r."rental_id"
      JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
      GROUP BY i."film_id"
    ) tr ON f."film_id" = tr."film_id"
    JOIN (
      SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
      FROM "film_actor"
      GROUP BY "film_id"
    ) ac ON f."film_id" = ac."film_id"
    ORDER BY a."actor_id", "average_revenue_per_actor" DESC
    LIMIT 100;
    ```

13. **Top Three Revenue-Generating Films for Each Actor:**

    ```sql
    SELECT
      actor_films."actor_name",
      actor_films."film_title",
      actor_films."average_revenue_per_actor"
    FROM (
      SELECT
        a."actor_id",
        a."first_name" || ' ' || a."last_name" AS "actor_name",
        f."title" AS "film_title",
        (tr."total_revenue" / ac."actor_count") AS "average_revenue_per_actor",
        ROW_NUMBER() OVER (PARTITION BY a."actor_id" ORDER BY (tr."total_revenue" / ac."actor_count") DESC) AS "rank"
      FROM "actor" a
      JOIN "film_actor" fa ON a."actor_id" = fa."actor_id"
      JOIN "film" f ON fa."film_id" = f."film_id"
      JOIN (
        SELECT i."film_id", SUM(p."amount") AS "total_revenue"
        FROM "payment" p
        JOIN "rental" r ON p."rental_id" = r."rental_id"
        JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
        GROUP BY i."film_id"
      ) tr ON f."film_id" = tr."film_id"
      JOIN (
        SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
        FROM "film_actor"
        GROUP BY "film_id"
      ) ac ON f."film_id" = ac."film_id"
    ) actor_films
    WHERE actor_films."rank" <= 3
    ORDER BY actor_films."actor_name", actor_films."average_revenue_per_actor" DESC
    LIMIT 100;
    ```

    *Note: This query uses the `ROW_NUMBER()` window function to rank films per actor and select the top three. Make sure your SQLite version supports window functions (version 3.25 or higher).*

14. **List Total Revenue Generated by Each Actor Across All Films:**

    ```sql
    SELECT
      a."actor_id",
      a."first_name" || ' ' || a."last_name" AS "actor_name",
      SUM(tr."total_revenue" / ac."actor_count") AS "total_average_revenue"
    FROM "actor" a
    JOIN "film_actor" fa ON a."actor_id" = fa."actor_id"
    JOIN "film" f ON fa."film_id" = f."film_id"
    JOIN (
      SELECT i."film_id", SUM(p."amount") AS "total_revenue"
      FROM "payment" p
      JOIN "rental" r ON p."rental_id" = r."rental_id"
      JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
      GROUP BY i."film_id"
    ) tr ON f."film_id" = tr."film_id"
    JOIN (
      SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
      FROM "film_actor"
      GROUP BY "film_id"
    ) ac ON f."film_id" = ac."film_id"
    GROUP BY a."actor_id", a."first_name", a."last_name"
    ORDER BY "total_average_revenue" DESC
    LIMIT 100;
    ```

15. **List Actors Who Have Generated More Than a Certain Revenue Threshold:**

    ```sql
    SELECT
      a."actor_id",
      a."first_name" || ' ' || a."last_name" AS "actor_name",
      SUM(tr."total_revenue" / ac."actor_count") AS "total_average_revenue"
    FROM "actor" a
    JOIN "film_actor" fa ON a."actor_id" = fa."actor_id"
    JOIN "film" f ON fa."film_id" = f."film_id"
    JOIN (
      SELECT i."film_id", SUM(p."amount") AS "total_revenue"
      FROM "payment" p
      JOIN "rental" r ON p."rental_id" = r."rental_id"
      JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
      GROUP BY i."film_id"
    ) tr ON f."film_id" = tr."film_id"
    JOIN (
      SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
      FROM "film_actor"
      GROUP BY "film_id"
    ) ac ON f."film_id" = ac."film_id"
    GROUP BY a."actor_id", a."first_name", a."last_name"
    HAVING SUM(tr."total_revenue" / ac."actor_count") > 1000
    ORDER BY "total_average_revenue" DESC
    LIMIT 100;
    ```

**Explanation:**

The above queries progressively build upon each other to explore the relevant data:

- Queries 1-4 retrieve basic lists of actors, films, payments, and rentals.
- Queries 5-9 calculate total revenue per film and number of actors per film.
- Queries 10-12 combine revenue and actor count to compute average revenue per actor per film.
- Query 13 identifies the top three revenue-generating films for each actor by calculating the average revenue per actor and ranking the films.
- Queries 14-15 explore total revenue generated by each actor across all their films and filter actors based on revenue thresholds.

By executing these queries, you can gain a comprehensive understanding of the data and how to extract the required information for the task.

---

The final result would provide the list of the top three revenue-generating films for each actor, along with the average revenue per actor calculated by dividing the film's total revenue equally among all actors featured in that film.

**Note:** Ensure that your SQLite version supports window functions if you're using queries that include functions like `ROW_NUMBER()`.Query:
SELECT DISTINCT "actor_id", "first_name", "last_name"
   FROM "actor"
   LIMIT 100;
Answer:
actor_id,first_name,last_name
1,PENELOPE,GUINESS
2,NICK,WAHLBERG
3,ED,CHASE
4,JENNIFER,DAVIS
5,JOHNNY,LOLLOBRIGIDA
6,BETTE,NICHOLSON
7,GRACE,MOSTEL
8,MATTHEW,JOHANSSON
9,JOE,SWANK
10,CHRISTIAN,GABLE
11,ZERO,CAGE
12,KARL,BERRY
13,UMA,WOOD
14,VIVIEN,BERGEN
15,CUBA,OLIVIER
16,FRED,COSTNER
17,HELEN,VOIGHT
18,DAN,TORN
19,BOB,FAWCETT
20,LUCILLE,TRACY
21,KIRSTEN,PALTROW
22,ELVIS,MARX
23,SANDRA,KILMER
24,CAMERON,STREEP
25,KEVIN,BLOOM
26,RIP,CRAWFORD
27,JULIA,MCQUEEN
28,WOODY,HOFFMAN
29,ALEC,WAYNE
30,SANDRA,PECK
31,SISSY,SOBIESKI
32,TIM,HACKMAN
33,MILLA,PECK
34,AUDREY,OLIVIER
35,JUDY,DEAN
36,BURT,DUKAKIS
37,VAL,BOLGER
38,TOM,MCKELLEN
39,GOLDIE,BRODY
40,JOHNNY,CAGE
41,JODIE,DEGENERES
42,TOM,MIRANDA
43,KIRK,JOVOVICH
44,NICK,STALLONE
45,REESE,KILMER
46,PARKER,GOLDBERG
47,JULIA,BARRYMORE
48,FRANCES,DAY-LEWIS
49,ANNE,CRONYN
50,NATALIE,HOPKINS
51,GARY,PHOENIX
52,CARMEN,HUNT
53,MENA,TEMPLE
54,PENELOPE,PINKETT
55,FAY,KILMER
56,DAN,HARRIS
57,JUDE,CRUISE
58,CHRISTIAN,AKROYD
59,DUSTIN,TAUTOU
60,HENRY,BERRY
61,CHRISTIAN,NEESON
62,JAYNE,NEESON
63,CAMERON,WRAY
64,RAY,JOHANSSON
65,ANGELA,HUDSON
66,MARY,TANDY
67,JESSICA,BAILEY
68,RIP,WINSLET
69,KENNETH,PALTROW
70,MICHELLE,MCCONAUGHEY
71,ADAM,GRANT
72,SEAN,WILLIAMS
73,GARY,PENN
74,MILLA,KEITEL
75,BURT,POSEY
76,ANGELINA,ASTAIRE
77,CARY,MCCONAUGHEY
78,GROUCHO,SINATRA
79,MAE,HOFFMAN
80,RALPH,CRUZ
81,SCARLETT,DAMON
82,WOODY,JOLIE
83,BEN,WILLIS
84,JAMES,PITT
85,MINNIE,ZELLWEGER
86,GREG,CHAPLIN
87,SPENCER,PECK
88,KENNETH,PESCI
89,CHARLIZE,DENCH
90,SEAN,GUINESS
91,CHRISTOPHER,BERRY
92,KIRSTEN,AKROYD
93,ELLEN,PRESLEY
94,KENNETH,TORN
95,DARYL,WAHLBERG
96,GENE,WILLIS
97,MEG,HAWKE
98,CHRIS,BRIDGES
99,JIM,MOSTEL
100,SPENCER,DEPP
Query:
SELECT DISTINCT "film_id", "title"
   FROM "film"
   LIMIT 100;
Answer:
film_id,title
1,ACADEMY DINOSAUR
2,ACE GOLDFINGER
3,ADAPTATION HOLES
4,AFFAIR PREJUDICE
5,AFRICAN EGG
6,AGENT TRUMAN
7,AIRPLANE SIERRA
8,AIRPORT POLLOCK
9,ALABAMA DEVIL
10,ALADDIN CALENDAR
11,ALAMO VIDEOTAPE
12,ALASKA PHANTOM
13,ALI FOREVER
14,ALICE FANTASIA
15,ALIEN CENTER
16,ALLEY EVOLUTION
17,ALONE TRIP
18,ALTER VICTORY
19,AMADEUS HOLY
20,AMELIE HELLFIGHTERS
21,AMERICAN CIRCUS
22,AMISTAD MIDSUMMER
23,ANACONDA CONFESSIONS
24,ANALYZE HOOSIERS
25,ANGELS LIFE
26,ANNIE IDENTITY
27,ANONYMOUS HUMAN
28,ANTHEM LUKE
29,ANTITRUST TOMATOES
30,ANYTHING SAVANNAH
31,APACHE DIVINE
32,APOCALYPSE FLAMINGOS
33,APOLLO TEEN
34,ARABIA DOGMA
35,ARACHNOPHOBIA ROLLERCOASTER
36,ARGONAUTS TOWN
37,ARIZONA BANG
38,ARK RIDGEMONT
39,ARMAGEDDON LOST
40,ARMY FLINTSTONES
41,ARSENIC INDEPENDENCE
42,ARTIST COLDBLOODED
43,ATLANTIS CAUSE
44,ATTACKS HATE
45,ATTRACTION NEWTON
46,AUTUMN CROW
47,BABY HALL
48,BACKLASH UNDEFEATED
49,BADMAN DAWN
50,BAKED CLEOPATRA
51,BALLOON HOMEWARD
52,BALLROOM MOCKINGBIRD
53,BANG KWAI
54,BANGER PINOCCHIO
55,BARBARELLA STREETCAR
56,BAREFOOT MANCHURIAN
57,BASIC EASY
58,BEACH HEARTBREAKERS
59,BEAR GRACELAND
60,BEAST HUNCHBACK
61,BEAUTY GREASE
62,BED HIGHBALL
63,BEDAZZLED MARRIED
64,BEETHOVEN EXORCIST
65,BEHAVIOR RUNAWAY
66,BENEATH RUSH
67,BERETS AGENT
68,BETRAYED REAR
69,BEVERLY OUTLAW
70,BIKINI BORROWERS
71,BILKO ANONYMOUS
72,BILL OTHERS
73,BINGO TALENTED
74,BIRCH ANTITRUST
75,BIRD INDEPENDENCE
76,BIRDCAGE CASPER
77,BIRDS PERDITION
78,BLACKOUT PRIVATE
79,BLADE POLISH
80,BLANKET BEVERLY
81,BLINDNESS GUN
82,BLOOD ARGONAUTS
83,BLUES INSTINCT
84,BOILED DARES
85,BONNIE HOLOCAUST
86,BOOGIE AMELIE
87,BOONDOCK BALLROOM
88,BORN SPINAL
89,BORROWERS BEDAZZLED
90,BOULEVARD MOB
91,BOUND CHEAPER
92,BOWFINGER GABLES
93,BRANNIGAN SUNRISE
94,BRAVEHEART HUMAN
95,BREAKFAST GOLDFINGER
96,BREAKING HOME
97,BRIDE INTRIGUE
98,BRIGHT ENCOUNTERS
99,BRINGING HYSTERICAL
100,BROOKLYN DESERT
Query:
SELECT "payment_id", "rental_id", "amount"
   FROM "payment"
   LIMIT 100;
Answer:
payment_id,rental_id,amount
1,76,2.99
2,573,0.99
3,1185,5.99
4,1422,0.99
5,1476,9.99
6,1725,4.99
7,2308,4.99
8,2363,0.99
9,3284,3.99
10,4526,5.99
11,4611,5.99
12,5244,4.99
13,5326,4.99
14,6163,7.99
15,7273,2.99
16,7841,4.99
17,8033,4.99
18,8074,0.99
19,8116,0.99
20,8326,2.99
21,9571,2.99
22,10437,4.99
23,11299,3.99
24,11367,0.99
25,11824,4.99
26,12250,0.99
27,13068,0.99
28,13176,2.99
29,14762,0.99
30,14825,1.99
31,15298,2.99
32,15315,5.99
33,320,4.99
34,2128,2.99
35,5636,2.99
36,5755,6.99
37,7346,4.99
38,7376,5.99
39,7459,5.99
40,8230,5.99
41,8598,2.99
42,8705,5.99
43,9031,4.99
44,9236,10.99
45,9248,0.99
46,9296,6.99
47,9465,6.99
48,10136,2.99
49,10466,0.99
50,10918,0.99
51,11087,5.99
52,11177,6.99
53,11256,2.99
54,11614,2.99
55,12963,2.99
56,14475,4.99
57,14743,5.99
58,15145,4.99
59,15907,4.99
60,435,1.99
61,830,2.99
62,1546,8.99
63,1726,6.99
64,1911,6.99
65,2628,2.99
66,4180,4.99
67,4725,4.99
68,7096,5.99
69,7503,10.99
70,7703,7.99
71,7724,6.99
72,7911,4.99
73,8086,4.99
74,8545,2.99
75,9226,1.99
76,9443,3.99
77,9595,2.99
78,9816,4.99
79,10597,5.99
80,12556,4.99
81,13403,8.99
82,13610,2.99
83,14699,8.99
84,15038,0.99
85,15619,2.99
86,1297,4.99
87,1633,0.99
88,1707,2.99
89,1735,0.99
90,2043,0.99
91,2642,5.99
92,7660,2.99
93,7718,2.99
94,8741,3.99
95,9100,5.99
96,9371,5.99
97,11069,0.99
98,11110,2.99
99,11529,4.99
100,12151,2.99
Query:
SELECT "rental_id", "inventory_id", "customer_id"
   FROM "rental"
   LIMIT 100;
Answer:
rental_id,inventory_id,customer_id
1,367,130
2,1525,459
3,1711,408
4,2452,333
5,2079,222
6,2792,549
7,3995,269
8,2346,239
9,2580,126
10,1824,399
11,4443,142
12,1584,261
13,2294,334
14,2701,446
15,3049,319
16,389,316
17,830,575
18,3376,19
19,1941,456
20,3517,185
21,146,388
22,727,509
23,4441,438
24,3273,350
25,3961,37
26,4371,371
27,1225,301
28,4068,232
29,611,44
30,3744,430
31,4482,369
32,3832,230
33,1681,272
34,2613,597
35,1286,484
36,1308,88
37,403,535
38,2540,302
39,4466,207
40,2638,413
41,1761,174
42,380,523
43,2578,532
44,3098,207
45,1853,436
46,3318,7
47,2211,35
48,1780,282
49,2965,498
50,1983,18
51,1257,256
52,4017,507
53,1255,569
54,2787,291
55,1139,131
56,1352,511
57,3938,6
58,3050,323
59,2884,408
60,330,470
61,4210,250
62,261,419
63,4008,383
64,79,368
65,3552,346
66,1162,86
67,239,119
68,4029,120
69,3207,305
70,2168,73
71,2408,100
72,2260,48
73,517,391
74,1744,265
75,3393,510
76,3021,1
77,1303,451
78,4067,135
79,3299,245
80,2478,314
81,2610,286
82,1388,427
83,466,131
84,1829,492
85,470,414
86,2275,266
87,1586,331
88,2221,53
89,2181,499
90,2984,25
91,139,267
92,775,302
93,4360,288
94,1675,197
95,178,400
96,3418,49
97,1283,263
98,2970,269
99,535,44
100,2599,208
Query:
SELECT f."film_id", f."title", SUM(p."amount") AS "total_revenue"
   FROM "payment" p
   JOIN "rental" r ON p."rental_id" = r."rental_id"
   JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
   JOIN "film" f ON i."film_id" = f."film_id"
   GROUP BY f."film_id", f."title"
   ORDER BY "total_revenue" DESC
   LIMIT 100;
Answer:
film_id,title,total_revenue
879,TELEGRAPH VOYAGE,231.73000000000008
973,WIFE TURN,223.69000000000008
1000,ZORRO ARK,214.69000000000008
369,GOODFELLAS SALUTE,209.69000000000005
764,SATURDAY LAMBS,204.72000000000006
893,TITANS JERK,201.71000000000006
897,TORQUE BOUND,198.72000000000006
403,HARRY IDAHO,195.70000000000007
460,INNOCENT USUAL,191.74000000000007
444,HUSTLER PARTY,190.78000000000003
670,PELICAN COMFORTS,188.74000000000004
127,CAT CONEHEADS,181.70000000000005
284,ENEMY ODDS,180.71000000000004
103,BUCKET BROTHERHOOD,180.66000000000005
715,RANGE MOONWALKER,179.73000000000002
563,MASSACRE USUAL,179.70000000000005
941,VIDEOTAPE ARSENIC,178.71000000000004
239,DOGMA FAMILY,178.70000000000002
31,APACHE DIVINE,178.69000000000003
938,VELVET TERMINATOR,177.74000000000004
244,DORADO NOTTING,176.73000000000002
327,FOOL MOCKINGBIRD,175.77
979,WITCHES PANIC,173.70000000000002
159,CLOSER BANG,172.72000000000003
767,SCALAWAG DUCK,172.68000000000004
745,ROSES TREASURE,171.72000000000003
865,SUNRISE LEAGUE,170.76000000000002
791,SHOW LORD,170.75000000000003
624,NIGHTMARE CHILL,169.75000000000003
771,SCORPION APOLLO,168.77
21,AMERICAN CIRCUS,167.78
174,CONFIDENTIAL INTERVIEW,164.71
551,MAIDEN HOME,163.76000000000002
775,SEATTLE EXPECATIONS,163.75
989,WORKING MICROCOSMOS,163.75
86,BOOGIE AMELIE,163.70000000000002
846,STING PERSONAL,159.79
527,LOLA AGENT,159.76
48,BACKLASH UNDEFEATED,158.81
575,MIDSUMMER GROUNDHOG,156.78
892,TITANIC BOONDOCK,154.76999999999998
838,STAGECOACH ARMAGEDDON,154.74
580,MINE TITANS,153.81
683,PITY BOUND,153.73999999999998
778,SECRETS PARADISE,152.8
408,HEAD STRANGER,152.78
267,EAGLES PANKY,152.77999999999997
972,WHISPERER GIANT,151.78
271,EASY GLADIATOR,150.76999999999998
579,MINDS TRUMAN,149.8
307,FELLOWSHIP AUTUMN,149.74
985,WONDERLAND CHRISTMAS,148.78
856,STREETCAR INTENTIONS,148.75
501,KISSING DOLLS,147.79999999999998
861,SUIT WALLS,147.79
902,TRADING PINOCCHIO,147.75
521,LIES TREATMENT,147.73
45,ATTRACTION NEWTON,146.76
330,FORRESTER COMANCHEROS,146.73
603,MOVIE SHAKESPEARE,145.73999999999998
911,TRIP NEWTON,145.72
350,GARDEN ISLAND,144.79999999999998
263,DURHAM PANKY,144.73999999999998
698,PRINCESS GIANT,142.73999999999998
112,CALENDAR GUNFIGHT,141.79
596,MOONSHINE CABIN,141.78999999999996
898,TOURIST PELICAN,141.77999999999997
843,STEEL SANTA,141.76999999999998
253,DRIFTER COMMANDMENTS,141.76
135,CHANCE RESURRECTION,141.73
320,FLAMINGOS CONNECTICUT,139.76999999999998
313,FIDELITY DEVIL,138.78999999999996
131,CENTER DINOSAUR,137.75999999999996
167,COMA HEAD,137.73999999999995
706,QUEEN LUKE,136.77999999999997
614,NAME DETECTIVE,136.76999999999998
172,CONEHEADS SMOOCHY,136.74999999999997
361,GLEAMING JAWBREAKER,136.69999999999996
702,PULP BEVERLY,136.69999999999996
995,YENTL IDAHO,135.76999999999998
324,FLINTSTONES HAPPINESS,134.82999999999998
971,WHALE BIKINI,134.81999999999996
439,HUNCHBACK IMPOSSIBLE,134.79999999999995
227,DETAILS PACKER,133.80999999999997
680,PINOCCHIO SIMON,133.79999999999998
869,SUSPECTS QUILLS,133.69999999999996
621,NETWORK PEAK,133.68999999999997
409,HEARTBREAKERS BRIGHT,132.79999999999995
61,BEAUTY GREASE,132.77999999999997
500,KISS GLORY,132.77999999999997
518,LIAISONS SWEET,131.77999999999997
10,ALADDIN CALENDAR,131.76999999999998
804,SLEEPING SUSPECTS,131.75999999999996
572,METROPOLIS COMA,131.73999999999998
73,BINGO TALENTED,131.70999999999995
734,ROAD ROXANNE,130.80999999999997
578,MILLION ACE,130.79999999999998
730,RIDGEMONT SUBMARINE,130.67999999999995
763,SATISFACTION CONFIDENTIAL,129.82999999999998
412,HEAVYWEIGHTS BEAST,129.76999999999995
Query:
SELECT fa."film_id", COUNT(fa."actor_id") AS "actor_count"
   FROM "film_actor" fa
   GROUP BY fa."film_id"
   LIMIT 100;
Answer:
film_id,actor_count
1,10
2,4
3,5
4,5
5,5
6,7
7,5
8,4
9,9
10,8
11,4
12,7
13,5
14,4
15,6
16,5
17,8
18,4
19,6
20,6
21,5
22,4
23,5
24,5
25,9
26,3
27,9
28,2
29,7
30,3
31,4
32,5
33,8
34,12
35,8
36,5
37,4
38,3
39,7
40,7
41,3
42,7
43,9
44,4
45,4
46,3
47,8
48,7
49,8
50,1
51,6
52,7
53,7
54,6
55,5
56,8
57,6
58,7
59,3
60,5
61,5
62,5
63,7
64,6
65,5
66,7
67,10
68,4
69,4
70,2
71,3
72,6
73,5
74,6
75,2
76,4
77,4
78,5
79,5
80,4
81,3
82,4
83,4
84,8
85,9
86,6
87,13
88,9
89,7
90,8
91,2
92,5
93,2
94,4
95,5
96,6
97,1
98,4
99,2
100,5
Query:
SELECT
  a."first_name" || ' ' || a."last_name" AS "actor_name",
  f."title" AS "film_title",
  (tr."total_revenue" / ac."actor_count") AS "average_revenue_per_actor"
FROM "actor" a
JOIN "film_actor" fa ON a."actor_id" = fa."actor_id"
JOIN "film" f ON fa."film_id" = f."film_id"
JOIN (
  SELECT i."film_id", SUM(p."amount") AS "total_revenue"
  FROM "payment" p
  JOIN "rental" r ON p."rental_id" = r."rental_id"
  JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
  GROUP BY i."film_id"
) tr ON f."film_id" = tr."film_id"
JOIN (
  SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
  FROM "film_actor"
  GROUP BY "film_id"
) ac ON f."film_id" = ac."film_id"
ORDER BY "actor_name", "average_revenue_per_actor" DESC
LIMIT 100;
Answer:
actor_name,film_title,average_revenue_per_actor
ADAM GRANT,SEABISCUIT PUNK,31.913333333333327
ADAM GRANT,OPERATION OPERATION,29.24333333333333
ADAM GRANT,TWISTED PIRATES,22.29666666666667
ADAM GRANT,ANNIE IDENTITY,19.926666666666673
ADAM GRANT,LOSER HUSTLER,17.77
ADAM GRANT,GROUNDHOG UNCUT,14.688571428571425
ADAM GRANT,IDOLS SNATCHERS,14.337499999999995
ADAM GRANT,WANDA CHAMBER,12.405714285714284
ADAM GRANT,FIREBALL PHILADELPHIA,12.158000000000003
ADAM GRANT,DISCIPLE MOTHER,5.972857142857143
ADAM GRANT,MIDNIGHT WESTWARD,5.0922222222222215
ADAM GRANT,MARS ROMAN,4.687142857142857
ADAM GRANT,HAPPINESS UNITED,4.588000000000001
ADAM GRANT,SPLENDOR PATTON,4.079
ADAM GRANT,GLORY TRACY,2.4916666666666667
ADAM GRANT,BALLROOM MOCKINGBIRD,1.5600000000000003
ADAM HOPPER,TORQUE BOUND,39.744000000000014
ADAM HOPPER,PRINCESS GIANT,28.547999999999995
ADAM HOPPER,BLINDNESS GUN,25.62
ADAM HOPPER,MOCKINGBIRD HOLLYWOOD,19.920000000000005
ADAM HOPPER,VACATION BOONDOCK,16.131666666666664
ADAM HOPPER,SLEEPY JAPANESE,15.466666666666667
ADAM HOPPER,SADDLE ANTITRUST,14.28666666666667
ADAM HOPPER,CLUELESS BUCKET,14.093749999999995
ADAM HOPPER,WORDS HUNTER,13.806666666666667
ADAM HOPPER,CLERKS ANGELS,12.732500000000002
ADAM HOPPER,OPEN AFRICAN,12.643333333333329
ADAM HOPPER,NOON PAPI,11.47166666666667
ADAM HOPPER,BLOOD ARGONAUTS,9.725000000000001
ADAM HOPPER,GREASE YOUTH,9.596666666666666
ADAM HOPPER,CHAMBER ITALIAN,9.411428571428573
ADAM HOPPER,MASKED BUBBLE,8.599999999999998
ADAM HOPPER,FICTION CHRISTMAS,7.351250000000001
ADAM HOPPER,GABLES METROPOLIS,7.226250000000004
ADAM HOPPER,TRAIN BUNCH,6.24
ADAM HOPPER,HEAVEN FREEDOM,5.882000000000003
ADAM HOPPER,TOWERS HURRICANE,3.2225000000000006
ADAM HOPPER,LOVERBOY ATTACKS,2.2088888888888887
AL GARLAND,BREAKFAST GOLDFINGER,21.965999999999994
AL GARLAND,DRIFTER COMMANDMENTS,20.25142857142857
AL GARLAND,SILVERADO GOLDFINGER,18.375999999999998
AL GARLAND,OSCAR GOLD,13.958333333333334
AL GARLAND,HOLIDAY GAMES,13.808333333333332
AL GARLAND,BILL OTHERS,11.30166666666667
AL GARLAND,VOICE PEACH,11.269999999999998
AL GARLAND,GLASS DYING,10.965000000000003
AL GARLAND,GRAIL FRANKENSTEIN,10.580000000000002
AL GARLAND,POTTER CONNECTICUT,10.404285714285717
AL GARLAND,PARK CITIZEN,10.153333333333334
AL GARLAND,DALMATIONS SWEDEN,9.800000000000002
AL GARLAND,HANDICAP BOONDOCK,9.102857142857147
AL GARLAND,WASTELAND DIVINE,8.308333333333337
AL GARLAND,HOUSE DYNAMITE,8.30777777777778
AL GARLAND,JACKET FRISCO,7.782000000000001
AL GARLAND,SLEUTH ORIENT,7.684285714285717
AL GARLAND,SENSE GREEK,6.847142857142858
AL GARLAND,ENOUGH RAGING,6.424444444444447
AL GARLAND,ROCK INSTINCT,6.103750000000002
AL GARLAND,SLIPPER FIDELITY,4.405714285714285
AL GARLAND,SPLENDOR PATTON,4.079
AL GARLAND,SPLASH GUMP,3.3860000000000006
AL GARLAND,VISION TORQUE,3.1860000000000004
AL GARLAND,CHITTY LOCK,2.2246153846153853
ALAN DREYFUSS,FIDELITY DEVIL,34.69749999999999
ALAN DREYFUSS,STRICTLY SCARFACE,28.442499999999992
ALAN DREYFUSS,BARBARELLA STREETCAR,19.349999999999998
ALAN DREYFUSS,RUSH GOODFELLAS,17.737999999999992
ALAN DREYFUSS,VAMPIRE WHALE,15.975999999999999
ALAN DREYFUSS,CLUELESS BUCKET,14.093749999999995
ALAN DREYFUSS,SAGEBRUSH CLUELESS,13.12
ALAN DREYFUSS,METAL ARMAGEDDON,12.968749999999996
ALAN DREYFUSS,BIRCH ANTITRUST,12.481666666666667
ALAN DREYFUSS,CLASH FREDDY,12.25
ALAN DREYFUSS,DIVIDE MONSTER,11.298333333333337
ALAN DREYFUSS,KICK SAVANNAH,10.300000000000002
ALAN DREYFUSS,BLANKET BEVERLY,10.220000000000002
ALAN DREYFUSS,JUMPING WRATH,9.969999999999999
ALAN DREYFUSS,STRANGELOVE DESIRE,9.639999999999999
ALAN DREYFUSS,BADMAN DAWN,9.59875
ALAN DREYFUSS,MAGUIRE APACHE,8.477500000000003
ALAN DREYFUSS,BULWORTH COMMANDMENTS,8.232500000000002
ALAN DREYFUSS,MONSTER SPARTACUS,7.40714285714286
ALAN DREYFUSS,MASSAGE IMAGE,6.653333333333335
ALAN DREYFUSS,UNCUT SUICIDES,6.551428571428573
ALAN DREYFUSS,LONELY ELEPHANT,6.487500000000001
ALAN DREYFUSS,HAUNTED ANTITRUST,6.388000000000001
ALAN DREYFUSS,UPTOWN YOUNG,5.554285714285716
ALAN DREYFUSS,POLISH BROOKLYN,2.4819999999999993
ALAN DREYFUSS,CRAZY HOME,2.0700000000000003
ALAN DREYFUSS,GREEDY ROOTS,1.9825000000000002
ALBERT JOHANSSON,UNDEFEATED DALMATIONS,38.26333333333332
ALBERT JOHANSSON,LEBOWSKI SOLDIERS,24.26333333333334
ALBERT JOHANSSON,REDEMPTION COMFORTS,22.759999999999994
ALBERT JOHANSSON,SWEDEN SHINING,22.361999999999995
ALBERT JOHANSSON,FIGHT JAWBREAKER,19.926666666666673
ALBERT JOHANSSON,HARPER DYING,19.45
ALBERT JOHANSSON,CANDLES GRAPES,18.39571428571428
ALBERT JOHANSSON,LEAGUE HELLFIGHTERS,17.638333333333332
ALBERT JOHANSSON,ROAD ROXANNE,16.351249999999997
ALBERT JOHANSSON,FLAMINGOS CONNECTICUT,15.529999999999998
Query:
SELECT i."film_id", SUM(p."amount") AS "total_revenue"
FROM "payment" p
JOIN "rental" r ON p."rental_id" = r."rental_id"
JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
GROUP BY i."film_id"
LIMIT 100
Answer:
film_id,total_revenue
1,36.769999999999996
2,52.93000000000001
3,37.88000000000002
4,91.77
5,51.88000000000002
6,126.78999999999996
7,82.85
8,102.81999999999998
9,71.88000000000001
10,131.76999999999998
11,35.75999999999999
12,44.74
13,54.91000000000001
15,90.77999999999999
16,52.86000000000002
17,62.82000000000002
18,32.779999999999994
19,33.78999999999999
20,67.9
21,167.78
22,70.79000000000002
23,60.79000000000002
24,55.86000000000002
25,119.77999999999997
26,59.780000000000015
27,17.87
28,85.85
29,37.90000000000001
30,46.91000000000001
31,178.69000000000003
32,30.940000000000005
34,22.869999999999997
35,114.75999999999998
37,104.78999999999998
39,45.790000000000006
40,41.84000000000001
42,69.84000000000002
43,87.75999999999999
44,101.83999999999999
45,146.76
46,84.89
47,45.92000000000001
48,158.81
49,76.79
50,79.84
51,98.77
52,10.920000000000002
53,22.93
54,42.78000000000001
55,96.74999999999999
56,66.82000000000002
57,90.78999999999999
58,64.83000000000003
59,107.77999999999997
60,76.89
61,132.77999999999997
62,24.940000000000005
63,16.87
64,16.89
65,100.86999999999999
66,16.900000000000002
67,78.78
68,91.85
69,115.78999999999998
70,98.82999999999998
71,102.86999999999999
72,67.81000000000002
73,131.70999999999995
74,74.89
75,63.890000000000015
76,23.91
77,111.81999999999998
78,91.72999999999999
79,34.78999999999999
80,40.88000000000001
81,76.86
82,38.900000000000006
83,84.78999999999999
84,77.85000000000001
85,32.83999999999999
86,163.70000000000002
88,59.88000000000002
89,27.77999999999999
90,63.820000000000014
91,50.76000000000001
92,56.890000000000015
93,74.88000000000001
94,16.950000000000003
95,109.82999999999997
96,51.87000000000002
97,21.809999999999995
98,92.86999999999999
99,71.80000000000001
100,116.78999999999996
101,101.73999999999997
102,35.940000000000005
103,180.66000000000005
104,55.890000000000015
105,21.839999999999996
106,32.93000000000001
Query:
SELECT fa."film_id", COUNT(DISTINCT fa."actor_id") AS "actor_count"
FROM "film_actor" fa
GROUP BY fa."film_id"
LIMIT 100
Answer:
film_id,actor_count
1,10
2,4
3,5
4,5
5,5
6,7
7,5
8,4
9,9
10,8
11,4
12,7
13,5
14,4
15,6
16,5
17,8
18,4
19,6
20,6
21,5
22,4
23,5
24,5
25,9
26,3
27,9
28,2
29,7
30,3
31,4
32,5
33,8
34,12
35,8
36,5
37,4
38,3
39,7
40,7
41,3
42,7
43,9
44,4
45,4
46,3
47,8
48,7
49,8
50,1
51,6
52,7
53,7
54,6
55,5
56,8
57,6
58,7
59,3
60,5
61,5
62,5
63,7
64,6
65,5
66,7
67,10
68,4
69,4
70,2
71,3
72,6
73,5
74,6
75,2
76,4
77,4
78,5
79,5
80,4
81,3
82,4
83,4
84,8
85,9
86,6
87,13
88,9
89,7
90,8
91,2
92,5
93,2
94,4
95,5
96,6
97,1
98,4
99,2
100,5
Query:
SELECT f."film_id", f."title", tr."total_revenue", ac."actor_count"
FROM "film" f
JOIN (
  SELECT i."film_id", SUM(p."amount") AS "total_revenue"
  FROM "payment" p
  JOIN "rental" r ON p."rental_id" = r."rental_id"
  JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
  GROUP BY i."film_id"
) tr ON f."film_id" = tr."film_id"
JOIN (
  SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
  FROM "film_actor"
  GROUP BY "film_id"
) ac ON f."film_id" = ac."film_id"
LIMIT 100
Answer:
film_id,title,total_revenue,actor_count
1,ACADEMY DINOSAUR,36.769999999999996,10
2,ACE GOLDFINGER,52.93000000000001,4
3,ADAPTATION HOLES,37.88000000000002,5
4,AFFAIR PREJUDICE,91.77,5
5,AFRICAN EGG,51.88000000000002,5
6,AGENT TRUMAN,126.78999999999996,7
7,AIRPLANE SIERRA,82.85,5
8,AIRPORT POLLOCK,102.81999999999998,4
9,ALABAMA DEVIL,71.88000000000001,9
10,ALADDIN CALENDAR,131.76999999999998,8
11,ALAMO VIDEOTAPE,35.75999999999999,4
12,ALASKA PHANTOM,44.74,7
13,ALI FOREVER,54.91000000000001,5
15,ALIEN CENTER,90.77999999999999,6
16,ALLEY EVOLUTION,52.86000000000002,5
17,ALONE TRIP,62.82000000000002,8
18,ALTER VICTORY,32.779999999999994,4
19,AMADEUS HOLY,33.78999999999999,6
20,AMELIE HELLFIGHTERS,67.9,6
21,AMERICAN CIRCUS,167.78,5
22,AMISTAD MIDSUMMER,70.79000000000002,4
23,ANACONDA CONFESSIONS,60.79000000000002,5
24,ANALYZE HOOSIERS,55.86000000000002,5
25,ANGELS LIFE,119.77999999999997,9
26,ANNIE IDENTITY,59.780000000000015,3
27,ANONYMOUS HUMAN,17.87,9
28,ANTHEM LUKE,85.85,2
29,ANTITRUST TOMATOES,37.90000000000001,7
30,ANYTHING SAVANNAH,46.91000000000001,3
31,APACHE DIVINE,178.69000000000003,4
32,APOCALYPSE FLAMINGOS,30.940000000000005,5
34,ARABIA DOGMA,22.869999999999997,12
35,ARACHNOPHOBIA ROLLERCOASTER,114.75999999999998,8
37,ARIZONA BANG,104.78999999999998,4
39,ARMAGEDDON LOST,45.790000000000006,7
40,ARMY FLINTSTONES,41.84000000000001,7
42,ARTIST COLDBLOODED,69.84000000000002,7
43,ATLANTIS CAUSE,87.75999999999999,9
44,ATTACKS HATE,101.83999999999999,4
45,ATTRACTION NEWTON,146.76,4
46,AUTUMN CROW,84.89,3
47,BABY HALL,45.92000000000001,8
48,BACKLASH UNDEFEATED,158.81,7
49,BADMAN DAWN,76.79,8
50,BAKED CLEOPATRA,79.84,1
51,BALLOON HOMEWARD,98.77,6
52,BALLROOM MOCKINGBIRD,10.920000000000002,7
53,BANG KWAI,22.93,7
54,BANGER PINOCCHIO,42.78000000000001,6
55,BARBARELLA STREETCAR,96.74999999999999,5
56,BAREFOOT MANCHURIAN,66.82000000000002,8
57,BASIC EASY,90.78999999999999,6
58,BEACH HEARTBREAKERS,64.83000000000003,7
59,BEAR GRACELAND,107.77999999999997,3
60,BEAST HUNCHBACK,76.89,5
61,BEAUTY GREASE,132.77999999999997,5
62,BED HIGHBALL,24.940000000000005,5
63,BEDAZZLED MARRIED,16.87,7
64,BEETHOVEN EXORCIST,16.89,6
65,BEHAVIOR RUNAWAY,100.86999999999999,5
66,BENEATH RUSH,16.900000000000002,7
67,BERETS AGENT,78.78,10
68,BETRAYED REAR,91.85,4
69,BEVERLY OUTLAW,115.78999999999998,4
70,BIKINI BORROWERS,98.82999999999998,2
71,BILKO ANONYMOUS,102.86999999999999,3
72,BILL OTHERS,67.81000000000002,6
73,BINGO TALENTED,131.70999999999995,5
74,BIRCH ANTITRUST,74.89,6
75,BIRD INDEPENDENCE,63.890000000000015,2
76,BIRDCAGE CASPER,23.91,4
77,BIRDS PERDITION,111.81999999999998,4
78,BLACKOUT PRIVATE,91.72999999999999,5
79,BLADE POLISH,34.78999999999999,5
80,BLANKET BEVERLY,40.88000000000001,4
81,BLINDNESS GUN,76.86,3
82,BLOOD ARGONAUTS,38.900000000000006,4
83,BLUES INSTINCT,84.78999999999999,4
84,BOILED DARES,77.85000000000001,8
85,BONNIE HOLOCAUST,32.83999999999999,9
86,BOOGIE AMELIE,163.70000000000002,6
88,BORN SPINAL,59.88000000000002,9
89,BORROWERS BEDAZZLED,27.77999999999999,7
90,BOULEVARD MOB,63.820000000000014,8
91,BOUND CHEAPER,50.76000000000001,2
92,BOWFINGER GABLES,56.890000000000015,5
93,BRANNIGAN SUNRISE,74.88000000000001,2
94,BRAVEHEART HUMAN,16.950000000000003,4
95,BREAKFAST GOLDFINGER,109.82999999999997,5
96,BREAKING HOME,51.87000000000002,6
97,BRIDE INTRIGUE,21.809999999999995,1
98,BRIGHT ENCOUNTERS,92.86999999999999,4
99,BRINGING HYSTERICAL,71.80000000000001,2
100,BROOKLYN DESERT,116.78999999999996,5
101,BROTHERHOOD BLANKET,101.73999999999997,5
102,BUBBLE GROSSE,35.940000000000005,3
103,BUCKET BROTHERHOOD,180.66000000000005,6
104,BUGSY SONG,55.890000000000015,2
105,BULL SHAWSHANK,21.839999999999996,8
106,BULWORTH COMMANDMENTS,32.93000000000001,4
Query:
SELECT
  f."film_id",
  f."title",
  tr."total_revenue",
  ac."actor_count",
  tr."total_revenue" / ac."actor_count" AS "average_revenue_per_actor"
FROM "film" f
JOIN (
  SELECT i."film_id", SUM(p."amount") AS "total_revenue"
  FROM "payment" p
  JOIN "rental" r ON p."rental_id" = r."rental_id"
  JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
  GROUP BY i."film_id"
) tr ON f."film_id" = tr."film_id"
JOIN (
  SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
  FROM "film_actor"
  GROUP BY "film_id"
) ac ON f."film_id" = ac."film_id"
LIMIT 100
Answer:
Too long, hard cut:
film_id,title,total_revenue,actor_count,average_revenue_per_actor
1,ACADEMY DINOSAUR,36.769999999999996,10,3.6769999999999996
2,ACE GOLDFINGER,52.93000000000001,4,13.232500000000002
3,ADAPTATION HOLES,37.88000000000002,5,7.576000000000003
4,AFFAIR PREJUDICE,91.77,5,18.354
5,AFRICAN EGG,51.88000000000002,5,10.376000000000003
6,AGENT TRUMAN,126.78999999999996,7,18.112857142857138
7,AIRPLANE SIERRA,82.85,5,16.57
8,AIRPORT POLLOCK,102.81999999999998,4,25.704999999999995
9,ALABAMA DEVIL,71.88000000000001,9,7.986666666666668
10,ALADDIN CALENDAR,131.76999999999998,8,16.471249999999998
11,ALAMO VIDEOTAPE,35.75999999999999,4,8.939999999999998
12,ALASKA PHANTOM,44.74,7,6.3914285714285715
13,ALI FOREVER,54.91000000000001,5,10.982000000000003
15,ALIEN CENTER,90.77999999999999,6,15.129999999999997
16,ALLEY EVOLUTION,52.86000000000002,5,10.572000000000005
17,ALONE TRIP,62.82000000000002,8,7.852500000000003
18,ALTER VICTORY,32.779999999999994,4,8.194999999999999
19,AMADEUS HOLY,33.78999999999999,6,5.631666666666665
20,AMELIE HELLFIGHTERS,67.9,6,11.316666666666668
21,AMERICAN CIRCUS,167.78,5,33.556
22,AMISTAD MIDSUMMER,70.79000000000002,4,17.697500000000005
23,ANACONDA CONFESSIONS,60.79000000000002,5,12.158000000000005
24,ANALYZE HOOSIERS,55.86000000000002,5,11.172000000000004
25,ANGELS LIFE,119.77999999999997,9,13.308888888888886
26,ANNIE IDENTITY,59.780000000000015,3,19.926666666666673
27,ANONYMOUS HUMAN,17.87,9,1.9855555555555557
28,ANTHEM LUKE,85.85,2,42.925
29,ANTITRUST TOMATOES,37.90000000000001,7,5.414285714285716
30,ANYTHING SAVANNAH,46.91000000000001,3,15.63666666666667
31,APACHE DIVINE,178.69000000000003,4,44.67250000000001
32,APOCALYPSE FLAMINGOS,30.940000000000005,5,6.188000000000001
34,ARABIA DOGMA,22.869999999999997,12,1.905833333333333
35,ARACHNOPHOBIA ROLLERCOASTER,114.75999999999998,8,14.344999999999997
37,ARIZONA BANG,104.78999999999998,4,26.197499999999994
39,ARMAGEDDON LOST,45.790000000000006,7,6.541428571428573
40,ARMY FLINTSTONES,41.84000000000001,7,5.977142857142859
42,ARTIST COLDBLOODED,69.84000000000002,7,9.97714285714286
43,ATLANTIS CAUSE,87.75999999999999,9,9.75111111111111
44,ATTACKS HATE,101.83999999999999,4,25.459999999999997
45,ATTRACTION NEWTON,146.76,4,36.69
46,AUTUMN CROW,84.89,3,28.296666666666667
47,BABY HALL,45.92000000000001,8,5.740000000000001
48,BACKLASH UNDEFEATED,158.81,7,22.687142857142856
49,BADMAN DAWN,76.79,8,9.59875
50,BAKED CLEOPATRA,79.84,1,79.84
51,BALLOON HOMEWARD,98.77,6,16.461666666666666
52,BALLROOM MOCKINGBIRD,10.920000000000002,7,1.5600000000000003
53,BANG KWAI,22.93,7,3.275714285714286
54,BANGER PINOCCHIO,42.78000000000001,6,7.130000000000002
55,BARBARELLA STREETCAR,96.74999999999999,5,19.349999999999998
56,BAREFOOT MANCHURIAN,66.82000000000002,8,8.352500000000003
57,BASIC EASY,90.78999999999999,6,15.131666666666666
58,BEACH HEARTBREAKERS,64.83000000000003,7,9.261428571428576
59,BEAR GRACELAND,107.77999999999997,3,35.926666666666655
60,BEAST HUNCHBACK,76.89,5,15.378
61,BEAUTY GREASE,132.77999999999997,5,26.555999999999994
62,BED HIGHBALL,24.940000000000005,5,4.988000000000001
63,BEDAZZLED MARRIED,16.87,7,2.41
64,BEETHOVEN EXORCIST,16.89,6,2.815
65,BEHAVIOR RUNAWAY,100.86999999999999,5,20.174
66,BENEATH RUSH,16.900000000000002,7,2.4142857142857146
67,BERETS AGENT,78.78,10,7.878
68,BETRAYED REAR,91.85,4,22.9625
69,BEVERLY OUTLAW,115.78999999999998,4,28.947499999999994
70,BIKINI BORROWERS,98.82999999999998,2,49.41499999999999
71,BILKO ANONYMOUS,102.86999999999999,3,34.29
72,BILL OTHERS,67.81000000000002,6,11.30166666666667
73,BINGO TALENTED,131.70999999999995,5,26.34199999999999
74,BIRCH ANTITRUST,74.89,6,12.481666666666667
75,BIRD INDEPENDENCE,63.890000000000015,2,31.945000000000007
76,BIRDCAGE CASPER,23.91,4,5.9775
77,BIRDS PERDITION,111.81999999999998,4,27.954999999999995
78,BLACKOUT PRIVATE,91.72999999999999,5,18.345999999999997
79,BLADE POLISH,34.78999999999999,5,6.957999999999998
80,BLANKET BEVERLY,40.88000000000001,4,10.220000000000002
81,BLINDNESS GUN,76.86,3,25.62
82,BLOOD ARGONAUTS,38.900000000000006,4,9.725000000000001
83,BLUES INSTINCT,84.78999999999999,4,21.197499999999998
84,BOILED DARES,77.85000000000001,8,9.731250000000001
85,BONNIE HOLOCAUST,32.83999999999999,9,3.6488888888888877
86,BOOGIE AMELIE,163.70000000000002,6,27.283333333333335
88,BORN SPINAL,59.88000000000002,9,6.653333333333335
89,BORROWERS BEDAZZLED,27.77999999999999,7,3.968571428571427
90,BOULEVARD MOB,63.820000000000014,8,7.977500000000002
91,BOUND CHEAPER,50.76000000000001,2,25.380000000000006
92,BOWFINGER GABLES,56.890000000000015,5,11.378000000000004
93,BRANNIGAN SUNRISE,74.88000000000001,2,37.440000000000005
94,BRAVEHEART HUMAN,16.950000000000003,4,4.237500000000001
95,BREAKFAST GOLDFINGER,109.82999999999997,5,21.965999999999994
96,BREAKING HOME,51.87000000000002,6,8.645000000000003
97,BRIDE INTRIGUE,21.809999999999995,1,21.809999999999995
98,BRIGHT ENCOUNTERS,92.86999999999999,4,23.217499999999998
99,BRINGING HYSTERICAL,71.80000000000001,2,35.900000000000006
100,BROOKLYN DESERT,116.789
Query:
SELECT
  a."actor_id",
  a."first_name" || ' ' || a."last_name" AS "actor_name",
  f."title" AS "film_title",
  (tr."total_revenue" / ac."actor_count") AS "average_revenue_per_actor"
FROM "actor" a
JOIN "film_actor" fa ON a."actor_id" = fa."actor_id"
JOIN "film" f ON fa."film_id" = f."film_id"
JOIN (
  SELECT i."film_id", SUM(p."amount") AS "total_revenue"
  FROM "payment" p
  JOIN "rental" r ON p."rental_id" = r."rental_id"
  JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
  GROUP BY i."film_id"
) tr ON f."film_id" = tr."film_id"
JOIN (
  SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
  FROM "film_actor"
  GROUP BY "film_id"
) ac ON f."film_id" = ac."film_id"
ORDER BY a."actor_id", "average_revenue_per_actor" DESC
LIMIT 100
Answer:
actor_id,actor_name,film_title,average_revenue_per_actor
1,PENELOPE GUINESS,RULES HUMAN,20.368
1,PENELOPE GUINESS,HUMAN GRAFFITI,20.212500000000002
1,PENELOPE GUINESS,CHEAPER CLYDE,18.4
1,PENELOPE GUINESS,ELEPHANT TROJAN,17.972
1,PENELOPE GUINESS,GLEAMING JAWBREAKER,17.087499999999995
1,PENELOPE GUINESS,LADY STAGE,14.853749999999996
1,PENELOPE GUINESS,COLOR PHILADELPHIA,13.394285714285713
1,PENELOPE GUINESS,ANGELS LIFE,13.308888888888886
1,PENELOPE GUINESS,ANACONDA CONFESSIONS,12.158000000000005
1,PENELOPE GUINESS,KING EVOLUTION,11.151666666666669
1,PENELOPE GUINESS,WIZARD COLDBLOODED,10.87111111111111
1,PENELOPE GUINESS,VERTIGO NORTHWEST,9.480000000000002
1,PENELOPE GUINESS,BULWORTH COMMANDMENTS,8.232500000000002
1,PENELOPE GUINESS,WESTWARD SEABISCUIT,6.29
1,PENELOPE GUINESS,ACADEMY DINOSAUR,3.6769999999999996
1,PENELOPE GUINESS,MULHOLLAND BEAST,3.655
1,PENELOPE GUINESS,SPLASH GUMP,3.3860000000000006
1,PENELOPE GUINESS,LANGUAGE COWBOY,3.3149999999999995
1,PENELOPE GUINESS,OKLAHOMA JUMANJI,0.66
2,NICK WAHLBERG,APACHE DIVINE,44.67250000000001
2,NICK WAHLBERG,JEKYLL FROGMEN,28.94333333333333
2,NICK WAHLBERG,GOODFELLAS SALUTE,26.211250000000007
2,NICK WAHLBERG,LIAISONS SWEET,21.963333333333328
2,NICK WAHLBERG,FIGHT JAWBREAKER,19.926666666666673
2,NICK WAHLBERG,CHISUM BEHAVIOR,18.4675
2,NICK WAHLBERG,CHAINSAW UPTOWN,16.894999999999996
2,NICK WAHLBERG,MALLRATS UNITED,15.55
2,NICK WAHLBERG,DESTINY SATURDAY,13.834285714285713
2,NICK WAHLBERG,FLASH WARS,13.267142857142856
2,NICK WAHLBERG,WARDROBE PHANTOM,11.716249999999999
2,NICK WAHLBERG,MAGUIRE APACHE,8.477500000000003
2,NICK WAHLBERG,ADAPTATION HOLES,7.576000000000003
2,NICK WAHLBERG,SMILE EARRING,7.362500000000002
2,NICK WAHLBERG,MASK PEACH,5.802727272727275
2,NICK WAHLBERG,BABY HALL,5.740000000000001
2,NICK WAHLBERG,INDIAN LOVE,5.084000000000001
2,NICK WAHLBERG,HAPPINESS UNITED,4.588000000000001
2,NICK WAHLBERG,GILBERT PELICAN,4.477500000000001
2,NICK WAHLBERG,JERSEY SASSY,4.437777777777779
2,NICK WAHLBERG,LUCKY FLYING,4.387000000000002
2,NICK WAHLBERG,BULL SHAWSHANK,2.7299999999999995
2,NICK WAHLBERG,RUSHMORE MERMAID,2.705714285714286
2,NICK WAHLBERG,DRACULA CRYSTAL,1.9069230769230763
3,ED CHASE,WHALE BIKINI,26.96399999999999
3,ED CHASE,FORREST SONS,17.564
3,ED CHASE,FRENCH HOLIDAY,14.689999999999998
3,ED CHASE,JEEPERS WEDDING,14.473333333333334
3,ED CHASE,FROST HEAD,10.957142857142857
3,ED CHASE,SPICE SORORITY,10.527272727272724
3,ED CHASE,ARTIST COLDBLOODED,9.97714285714286
3,ED CHASE,PLATOON INSTINCT,9.182000000000002
3,ED CHASE,WEDDING APOLLO,8.175999999999998
3,ED CHASE,ALONE TRIP,7.852500000000003
3,ED CHASE,WEEKEND PERSONAL,7.482000000000001
3,ED CHASE,CADDYSHACK JEDI,7.405714285714287
3,ED CHASE,IMAGE PRINCESS,6.987272727272727
3,ED CHASE,EVE RESURRECTION,6.821666666666668
3,ED CHASE,HUNTER ALTER,6.237500000000001
3,ED CHASE,ARMY FLINTSTONES,5.977142857142859
3,ED CHASE,COWBOY DOOM,5.786000000000001
3,ED CHASE,NECKLACE OUTBREAK,5.481250000000001
3,ED CHASE,LUCK OPUS,5.150000000000001
3,ED CHASE,HALLOWEEN NUTS,5.128571428571429
3,ED CHASE,YOUNG LANGUAGE,1.3860000000000001
4,JENNIFER DAVIS,SILVERADO GOLDFINGER,18.375999999999998
4,JENNIFER DAVIS,POSEIDON FOREVER,16.804999999999996
4,JENNIFER DAVIS,HANOVER GALAXY,14.118571428571427
4,JENNIFER DAVIS,ANGELS LIFE,13.308888888888886
4,JENNIFER DAVIS,ANACONDA CONFESSIONS,12.158000000000005
4,JENNIFER DAVIS,GHOSTBUSTERS ELF,11.91
4,JENNIFER DAVIS,NATIONAL STORY,11.83
4,JENNIFER DAVIS,REDS POCUS,10.582000000000003
4,JENNIFER DAVIS,BAREFOOT MANCHURIAN,8.352500000000003
4,JENNIFER DAVIS,SUBMARINE BED,8.077272727272726
4,JENNIFER DAVIS,BLADE POLISH,6.957999999999998
4,JENNIFER DAVIS,INSTINCT AIRPORT,6.620000000000001
4,JENNIFER DAVIS,JUMANJI BLADE,5.153333333333335
4,JENNIFER DAVIS,BED HIGHBALL,4.988000000000001
4,JENNIFER DAVIS,UNFORGIVEN ZOOLANDER,3.688571428571428
4,JENNIFER DAVIS,SPLASH GUMP,3.3860000000000006
4,JENNIFER DAVIS,RANDOM GO,2.454615384615385
4,JENNIFER DAVIS,GREEDY ROOTS,1.9825000000000002
4,JENNIFER DAVIS,OKLAHOMA JUMANJI,0.66
5,JOHNNY LOLLOBRIGIDA,SUNRISE LEAGUE,34.152
5,JOHNNY LOLLOBRIGIDA,GOODFELLAS SALUTE,26.211250000000007
5,JOHNNY LOLLOBRIGIDA,RIDGEMONT SUBMARINE,26.13599999999999
5,JOHNNY LOLLOBRIGIDA,ESCAPE METROPOLIS,20.1875
5,JOHNNY LOLLOBRIGIDA,HALL CASSIDY,19.767999999999994
5,JOHNNY LOLLOBRIGIDA,STAR OPERATION,17.357999999999997
5,JOHNNY LOLLOBRIGIDA,CONEHEADS SMOOCHY,15.194444444444441
5,JOHNNY LOLLOBRIGIDA,DADDY PITTSBURGH,15.174000000000001
5,JOHNNY LOLLOBRIGIDA,DAISY MENAGERIE,13.69142857142857
5,JOHNNY LOLLOBRIGIDA,METAL ARMAGEDDON,12.968749999999996
5,JOHNNY LOLLOBRIGIDA,PATTON INTERVIEW,11.418888888888889
5,JOHNNY LOLLOBRIGIDA,GRAIL FRANKENSTEIN,10.580000000000002
5,JOHNNY LOLLOBRIGIDA,LOVE SUICIDES,8.95
5,JOHNNY LOLLOBRIGIDA,POCUS PULP,8.748000000000001
5,JOHNNY LOLLOBRIGIDA,FIRE WOLVES,7.9860000000000015
5,JOHNNY LOLLOBRIGIDA,PACIFIC AMISTAD,7.845000000000002
5,JOHNNY LOLLOBRIGIDA,SMILE EARRING,7.362500000000002
Query:
SELECT
  actor_films."actor_name",
  actor_films."film_title",
  actor_films."average_revenue_per_actor"
FROM (
  SELECT
    a."actor_id",
    a."first_name" || ' ' || a."last_name" AS "actor_name",
    f."title" AS "film_title",
    (tr."total_revenue" / ac."actor_count") AS "average_revenue_per_actor",
    ROW_NUMBER() OVER (PARTITION BY a."actor_id" ORDER BY (tr."total_revenue" / ac."actor_count") DESC) AS "rank"
  FROM "actor" a
  JOIN "film_actor" fa ON a."actor_id" = fa."actor_id"
  JOIN "film" f ON fa."film_id" = f."film_id"
  JOIN (
    SELECT i."film_id", SUM(p."amount") AS "total_revenue"
    FROM "payment" p
    JOIN "rental" r ON p."rental_id" = r."rental_id"
    JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
    GROUP BY i."film_id"
  ) tr ON f."film_id" = tr."film_id"
  JOIN (
    SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
    FROM "film_actor"
    GROUP BY "film_id"
  ) ac ON f."film_id" = ac."film_id"
) actor_films
WHERE actor_films."rank" <= 3
ORDER BY actor_films."actor_name", actor_films."average_revenue_per_actor" DESC
LIMIT 100
Answer:
actor_name,film_title,average_revenue_per_actor
ADAM GRANT,SEABISCUIT PUNK,31.913333333333327
ADAM GRANT,OPERATION OPERATION,29.24333333333333
ADAM GRANT,TWISTED PIRATES,22.29666666666667
ADAM HOPPER,TORQUE BOUND,39.744000000000014
ADAM HOPPER,PRINCESS GIANT,28.547999999999995
ADAM HOPPER,BLINDNESS GUN,25.62
AL GARLAND,BREAKFAST GOLDFINGER,21.965999999999994
AL GARLAND,DRIFTER COMMANDMENTS,20.25142857142857
AL GARLAND,SILVERADO GOLDFINGER,18.375999999999998
ALAN DREYFUSS,FIDELITY DEVIL,34.69749999999999
ALAN DREYFUSS,STRICTLY SCARFACE,28.442499999999992
ALAN DREYFUSS,BARBARELLA STREETCAR,19.349999999999998
ALBERT JOHANSSON,UNDEFEATED DALMATIONS,38.26333333333332
ALBERT JOHANSSON,LEBOWSKI SOLDIERS,24.26333333333334
ALBERT JOHANSSON,REDEMPTION COMFORTS,22.759999999999994
ALBERT NOLTE,CAMELOT VACATION,50.86499999999998
ALBERT NOLTE,FLINTSTONES HAPPINESS,33.707499999999996
ALBERT NOLTE,MANCHURIAN CURTAIN,32.42500000000001
ALEC WAYNE,HUSTLER PARTY,47.69500000000001
ALEC WAYNE,REIGN GENTLEMEN,36.93333333333332
ALEC WAYNE,CENTER DINOSAUR,34.43999999999999
ANGELA HUDSON,MALTESE HOPE,123.77999999999996
ANGELA HUDSON,PITY BOUND,30.747999999999998
ANGELA HUDSON,ISLAND EXORCIST,28.58
ANGELA WITHERSPOON,CAT CONEHEADS,45.42500000000001
ANGELA WITHERSPOON,SECRET GROUNDHOG,38.929999999999986
ANGELA WITHERSPOON,BRINGING HYSTERICAL,35.900000000000006
ANGELINA ASTAIRE,SAMURAI LION,54.374999999999986
ANGELINA ASTAIRE,HUSTLER PARTY,47.69500000000001
ANGELINA ASTAIRE,INTENTIONS EMPIRE,39.415
ANNE CRONYN,APACHE DIVINE,44.67250000000001
ANNE CRONYN,MOON BUNCH,38.70999999999999
ANNE CRONYN,MINDS TRUMAN,24.96666666666667
AUDREY BAILEY,QUILLS BULL,25.209999999999997
AUDREY BAILEY,DISTURBING SCARFACE,22.435
AUDREY BAILEY,DRIFTER COMMANDMENTS,20.25142857142857
AUDREY OLIVIER,DORADO NOTTING,44.182500000000005
AUDREY OLIVIER,WHALE BIKINI,26.96399999999999
AUDREY OLIVIER,STING PERSONAL,22.827142857142857
BELA WALKEN,MIDSUMMER GROUNDHOG,78.39
BELA WALKEN,WHISPERER GIANT,50.593333333333334
BELA WALKEN,ENEMY ODDS,45.17750000000001
BEN HARRIS,MUSKETEERS WAIT,92.83
BEN HARRIS,TOURIST PELICAN,47.25999999999999
BEN HARRIS,BEAR GRACELAND,35.926666666666655
BEN WILLIS,GOODFELLAS SALUTE,26.211250000000007
BEN WILLIS,HEAVYWEIGHTS BEAST,25.95399999999999
BEN WILLIS,CHANCE RESURRECTION,23.621666666666666
BETTE NICHOLSON,BIKINI BORROWERS,49.41499999999999
BETTE NICHOLSON,TRADING PINOCCHIO,49.25
BETTE NICHOLSON,COLDBLOODED DARLING,22.459999999999997
BOB FAWCETT,PELICAN COMFORTS,37.748000000000005
BOB FAWCETT,CIRCUS YOUTH,30.42500000000001
BOB FAWCETT,RAGING AIRPLANE,28.289999999999996
BURT DUKAKIS,RANGE MOONWALKER,44.932500000000005
BURT DUKAKIS,BLINDNESS GUN,25.62
BURT DUKAKIS,TRUMAN CRAZY,20.294999999999995
BURT POSEY,MINDS TRUMAN,24.96666666666667
BURT POSEY,DESERT POSEIDON,23.761999999999993
BURT POSEY,SATURDAY LAMBS,22.746666666666673
BURT TEMPLE,ROSES TREASURE,34.34400000000001
BURT TEMPLE,BUCKET BROTHERHOOD,30.11000000000001
BURT TEMPLE,HEAVYWEIGHTS BEAST,25.95399999999999
CAMERON STREEP,PURE RUNNER,46.419999999999995
CAMERON STREEP,BLUES INSTINCT,21.197499999999998
CAMERON STREEP,MOVIE SHAKESPEARE,18.217499999999998
CAMERON WRAY,COMA HEAD,45.91333333333332
CAMERON WRAY,TITANS JERK,28.815714285714296
CAMERON WRAY,BINGO TALENTED,26.34199999999999
CAMERON ZELLWEGER,WIFE TURN,37.28166666666668
CAMERON ZELLWEGER,GRIT CLOCKWORK,36.89333333333332
CAMERON ZELLWEGER,HARRY IDAHO,32.61666666666668
CARMEN HUNT,TELEGRAPH VOYAGE,33.10428571428572
CARMEN HUNT,MOONSHINE CABIN,28.357999999999993
CARMEN HUNT,TEEN APOLLO,25.565999999999995
CARY MCCONAUGHEY,DOLLS RAGE,30.910000000000004
CARY MCCONAUGHEY,BINGO TALENTED,26.34199999999999
CARY MCCONAUGHEY,RULES HUMAN,20.368
CATE HARRIS,SCARFACE BANG,17.259999999999994
CATE HARRIS,ROLLERCOASTER BRINGING,15.300000000000004
CATE HARRIS,GREEK EVERYONE,13.957500000000005
CATE MCQUEEN,NAME DETECTIVE,45.589999999999996
CATE MCQUEEN,SNATCH SLIPPER,42.59333333333332
CATE MCQUEEN,SALUTE APOLLO,26.692499999999995
CHARLIZE DENCH,BUCKET BROTHERHOOD,30.11000000000001
CHARLIZE DENCH,JOON NORTHWEST,19.915000000000003
CHARLIZE DENCH,CANDLES GRAPES,18.39571428571428
CHRIS BRIDGES,CONVERSATION DOWNHILL,38.27666666666666
CHRIS BRIDGES,SATURN NAME,35.435
CHRIS BRIDGES,WONDERLAND CHRISTMAS,29.756
CHRIS DEPP,SCALAWAG DUCK,34.53600000000001
CHRIS DEPP,SABRINA MIDNIGHT,31.69749999999999
CHRIS DEPP,EAGLES PANKY,25.463333333333328
CHRISTIAN AKROYD,INNOCENT USUAL,63.913333333333355
CHRISTIAN AKROYD,SABRINA MIDNIGHT,31.69749999999999
CHRISTIAN AKROYD,OPERATION OPERATION,29.24333333333333
CHRISTIAN GABLE,DRAGONFLY STRANGERS,34.60666666666666
CHRISTIAN GABLE,GOLDFINGER SENSIBILITY,20.439999999999998
CHRISTIAN GABLE,WATERFRONT DELIVERANCE,20.304999999999996
CHRISTIAN NEESON,SCALAWAG DUCK,34.53600000000001
Query:
SELECT
  a."actor_id",
  a."first_name" || ' ' || a."last_name" AS "actor_name",
  SUM(tr."total_revenue" / ac."actor_count") AS "total_average_revenue"
FROM "actor" a
JOIN "film_actor" fa ON a."actor_id" = fa."actor_id"
JOIN "film" f ON fa."film_id" = f."film_id"
JOIN (
  SELECT i."film_id", SUM(p."amount") AS "total_revenue"
  FROM "payment" p
  JOIN "rental" r ON p."rental_id" = r."rental_id"
  JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
  GROUP BY i."film_id"
) tr ON f."film_id" = tr."film_id"
JOIN (
  SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
  FROM "film_actor"
  GROUP BY "film_id"
) ac ON f."film_id" = ac."film_id"
GROUP BY a."actor_id", a."first_name", a."last_name"
ORDER BY "total_average_revenue" DESC
LIMIT 100
Answer:
actor_id,actor_name,total_average_revenue
107,GINA DEGENERES,607.222749084249
142,JADA RYDER,546.9910119047618
102,WALTER TORN,542.0257847985348
65,ANGELA HUDSON,531.2862542735044
144,ANGELA WITHERSPOON,522.8858333333333
197,REESE WEST,511.3194072039073
181,MATTHEW CARREY,507.6837009379511
60,HENRY BERRY,506.704932900433
127,KEVIN GARLAND,494.1699606782107
198,MARY KEITEL,488.7295584415583
58,CHRISTIAN AKROYD,485.8391659451659
106,GROUCHO DUNST,483.4761259018758
90,SEAN GUINESS,480.81424531024527
26,RIP CRAWFORD,475.2172889610391
74,MILLA KEITEL,471.2873531746031
185,MICHAEL BOLGER,466.52034163059153
13,UMA WOOD,466.0097142857143
103,MATTHEW LEIGH,464.32435317460306
147,FAY WINSLET,460.1544862914862
50,NATALIE HOPKINS,450.2665970418471
81,SCARLETT DAMON,450.0970772005772
140,WHOOPI HURT,447.8008971861472
76,ANGELINA ASTAIRE,444.73329670329684
66,MARY TANDY,440.490024891775
117,RENEE TRACY,439.1718134920635
48,FRANCES DAY-LEWIS,437.1550476190476
45,REESE KILMER,434.2284660339661
196,BELA WALKEN,433.6079603174604
42,TOM MIRANDA,433.38969841269835
92,KIRSTEN AKROYD,428.61628896103906
125,ALBERT NOLTE,422.5861071428571
192,JOHN SUVARI,416.57629509379507
136,ED MANSFIELD,414.47372294372286
28,WOODY HOFFMAN,411.57804256854257
104,PENELOPE CRONYN,411.503488095238
70,MICHELLE MCCONAUGHEY,408.03595770895765
27,JULIA MCQUEEN,407.55167532467544
41,JODIE DEGENERES,407.4537722832722
151,GEOFFREY HESTON,407.4316717171716
111,CAMERON ZELLWEGER,405.0962665945167
17,HELEN VOIGHT,404.58936849261846
166,NICK DEGENERES,401.77243315018313
134,GENE HOPKINS,398.2082380952382
184,HUMPHREY GARLAND,397.1778217338218
23,SANDRA KILMER,395.40821645021634
86,GREG CHAPLIN,395.0029905372406
150,JAYNE NOLTE,394.9416551226552
83,BEN WILLIS,393.2984905372405
73,GARY PENN,390.54019155844156
21,KIRSTEN PALTROW,389.9673268398268
59,DUSTIN TAUTOU,389.2956865079364
108,WARREN NOLTE,387.7270487012986
94,KENNETH TORN,387.1891706349207
84,JAMES PITT,385.177686868687
146,ALBERT JOHANSSON,385.09842857142854
152,BEN HARRIS,382.52385461760457
139,EWAN GOODING,380.89083730158734
57,JUDE CRUISE,379.6853574481075
14,VIVIEN BERGEN,378.821507936508
101,SUSAN DAVIS,378.2139923687424
158,VIVIEN BASINGER,376.99321500721504
187,RENEE BALL,376.74979076479076
67,JESSICA BAILEY,376.1309761904762
39,GOLDIE BRODY,373.5916022588523
62,JAYNE NEESON,368.2951031746032
159,LAURA BRODY,362.56239610389616
149,RUSSELL TEMPLE,360.6881868131868
82,WOODY JOLIE,359.73663492063497
119,WARREN JACKMAN,359.41975505050505
16,FRED COSTNER,359.32163383838383
168,WILL WILSON,356.43369047619046
191,GREGORY GOODING,354.5910562770563
112,RUSSELL BACALL,352.67795543345534
29,ALEC WAYNE,352.64659595959597
175,WILLIAM HACKMAN,352.2957936507937
177,GENE MCKELLEN,346.6084415584416
164,HUMPHREY WILLIS,346.4399404761905
122,SALMA NOLTE,345.6363315295816
44,NICK STALLONE,345.097708874459
51,GARY PHOENIX,344.7477128427128
95,DARYL WAHLBERG,342.55151443001455
145,KIM ALLEN,341.1834206349207
72,SEAN WILLIAMS,340.48099847374846
53,MENA TEMPLE,339.33301587301594
105,SIDNEY CROWE,338.29100918525927
49,ANNE CRONYN,337.96353571428574
46,PARKER GOLDBERG,337.7927662337662
155,IAN TANDY,337.7346214896214
43,KIRK JOVOVICH,337.1613917748918
68,RIP WINSLET,337.013246031746
33,MILLA PECK,337.0014642857142
20,LUCILLE TRACY,335.7116196581197
37,VAL BOLGER,335.29531018981015
120,PENELOPE MONROE,334.54473845598847
78,GROUCHO SINATRA,334.4087463924964
64,RAY JOHANSSON,333.55023809523817
7,GRACE MOSTEL,333.4468015873016
34,AUDREY OLIVIER,331.71352777777776
169,KENNETH HOFFMAN,330.2713015873016
15,CUBA OLIVIER,329.75532251082257
Query:
SELECT
  a."actor_id",
  a."first_name" || ' ' || a."last_name" AS "actor_name",
  SUM(COALESCE(tr."total_revenue", 0) / NULLIF(ac."actor_count", 0)) AS "total_average_revenue"
FROM "actor" a
JOIN "film_actor" fa ON a."actor_id" = fa."actor_id"
JOIN "film" f ON fa."film_id" = f."film_id"
LEFT JOIN (
  SELECT i."film_id", SUM(p."amount") AS "total_revenue"
  FROM "payment" p
  JOIN "rental" r ON p."rental_id" = r."rental_id"
  JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
  GROUP BY i."film_id"
) tr ON f."film_id" = tr."film_id"
LEFT JOIN (
  SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
  FROM "film_actor"
  GROUP BY "film_id"
) ac ON f."film_id" = ac."film_id"
GROUP BY a."actor_id", a."first_name", a."last_name"
HAVING SUM(COALESCE(tr."total_revenue", 0) / NULLIF(ac."actor_count", 0)) IS NOT NULL
ORDER BY "total_average_revenue" DESC
LIMIT 100;
Answer:
actor_id,actor_name,total_average_revenue
107,GINA DEGENERES,607.222749084249
142,JADA RYDER,546.9910119047618
102,WALTER TORN,542.0257847985348
65,ANGELA HUDSON,531.2862542735044
144,ANGELA WITHERSPOON,522.8858333333333
197,REESE WEST,511.3194072039073
181,MATTHEW CARREY,507.6837009379511
60,HENRY BERRY,506.704932900433
127,KEVIN GARLAND,494.1699606782107
198,MARY KEITEL,488.7295584415583
58,CHRISTIAN AKROYD,485.8391659451659
106,GROUCHO DUNST,483.4761259018758
90,SEAN GUINESS,480.81424531024527
26,RIP CRAWFORD,475.2172889610391
74,MILLA KEITEL,471.2873531746031
185,MICHAEL BOLGER,466.52034163059153
13,UMA WOOD,466.0097142857143
103,MATTHEW LEIGH,464.32435317460306
147,FAY WINSLET,460.1544862914862
50,NATALIE HOPKINS,450.2665970418471
81,SCARLETT DAMON,450.0970772005772
140,WHOOPI HURT,447.8008971861472
76,ANGELINA ASTAIRE,444.73329670329684
66,MARY TANDY,440.490024891775
117,RENEE TRACY,439.1718134920635
48,FRANCES DAY-LEWIS,437.1550476190476
45,REESE KILMER,434.2284660339661
196,BELA WALKEN,433.6079603174604
42,TOM MIRANDA,433.38969841269835
92,KIRSTEN AKROYD,428.61628896103906
125,ALBERT NOLTE,422.5861071428571
192,JOHN SUVARI,416.57629509379507
136,ED MANSFIELD,414.47372294372286
28,WOODY HOFFMAN,411.57804256854257
104,PENELOPE CRONYN,411.503488095238
70,MICHELLE MCCONAUGHEY,408.03595770895765
27,JULIA MCQUEEN,407.55167532467544
41,JODIE DEGENERES,407.4537722832722
151,GEOFFREY HESTON,407.4316717171716
111,CAMERON ZELLWEGER,405.0962665945167
17,HELEN VOIGHT,404.58936849261846
166,NICK DEGENERES,401.77243315018313
134,GENE HOPKINS,398.2082380952382
184,HUMPHREY GARLAND,397.1778217338218
23,SANDRA KILMER,395.40821645021634
86,GREG CHAPLIN,395.0029905372406
150,JAYNE NOLTE,394.9416551226552
83,BEN WILLIS,393.2984905372405
73,GARY PENN,390.54019155844156
21,KIRSTEN PALTROW,389.9673268398268
59,DUSTIN TAUTOU,389.2956865079364
108,WARREN NOLTE,387.7270487012986
94,KENNETH TORN,387.1891706349207
84,JAMES PITT,385.177686868687
146,ALBERT JOHANSSON,385.09842857142854
152,BEN HARRIS,382.52385461760457
139,EWAN GOODING,380.89083730158734
57,JUDE CRUISE,379.6853574481075
14,VIVIEN BERGEN,378.821507936508
101,SUSAN DAVIS,378.2139923687424
158,VIVIEN BASINGER,376.99321500721504
187,RENEE BALL,376.74979076479076
67,JESSICA BAILEY,376.1309761904762
39,GOLDIE BRODY,373.5916022588523
62,JAYNE NEESON,368.2951031746032
159,LAURA BRODY,362.56239610389616
149,RUSSELL TEMPLE,360.6881868131868
82,WOODY JOLIE,359.73663492063497
119,WARREN JACKMAN,359.41975505050505
16,FRED COSTNER,359.32163383838383
168,WILL WILSON,356.43369047619046
191,GREGORY GOODING,354.5910562770563
112,RUSSELL BACALL,352.67795543345534
29,ALEC WAYNE,352.64659595959597
175,WILLIAM HACKMAN,352.2957936507937
177,GENE MCKELLEN,346.6084415584416
164,HUMPHREY WILLIS,346.4399404761905
122,SALMA NOLTE,345.6363315295816
44,NICK STALLONE,345.097708874459
51,GARY PHOENIX,344.7477128427128
95,DARYL WAHLBERG,342.55151443001455
145,KIM ALLEN,341.1834206349207
72,SEAN WILLIAMS,340.48099847374846
53,MENA TEMPLE,339.33301587301594
105,SIDNEY CROWE,338.29100918525927
49,ANNE CRONYN,337.96353571428574
46,PARKER GOLDBERG,337.7927662337662
155,IAN TANDY,337.7346214896214
43,KIRK JOVOVICH,337.1613917748918
68,RIP WINSLET,337.013246031746
33,MILLA PECK,337.0014642857142
20,LUCILLE TRACY,335.7116196581197
37,VAL BOLGER,335.29531018981015
120,PENELOPE MONROE,334.54473845598847
78,GROUCHO SINATRA,334.4087463924964
64,RAY JOHANSSON,333.55023809523817
7,GRACE MOSTEL,333.4468015873016
34,AUDREY OLIVIER,331.71352777777776
169,KENNETH HOFFMAN,330.2713015873016
15,CUBA OLIVIER,329.75532251082257
End Exploring Related Columns
Task: Please provide a list of the top three revenue-generating films for each actor, along with the average revenue per actor in those films, calculated by dividing the total film revenue equally among the actors for each film.

Please answer only one complete SQL in sqlite dialect in ```sql``` format.
Usage example: ```sql
SELECT DISTINCT "column_name" FROM "table_name" WHERE ... ``` (Replace "table_name" with the actual table name. Enclose table and column names with double quotations if they contain special characters or match reserved keywords.)
Follow the answer format like: Below is the list of the top three revenue-generating films for each actor, along with the average revenue per actor in those films:

```csv
actor_name,film_title,average_revenue_per_actor
actor1_name:str,film1_title:str,average_revenue1:float
actor1_name:str,film2_title:str,average_revenue2:float
actor1_name:str,film3_title:str,average_revenue3:float
actor2_name:str,film1_title:str,average_revenue1:float
actor2_name:str,film2_title:str,average_revenue2:float
actor2_name:str,film3_title:str,average_revenue3:float
...
```

In this table, each actor is listed alongside their top three films based on total revenue generated. The average revenue per actor for each film is calculated by dividing the film's total revenue equally among all actors featured in that film..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: 

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-25 06:16:23 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 06:16:23 - root - INFO - ```sql
WITH film_revenue AS (
    SELECT i."film_id", SUM(p."amount") AS "total_revenue"
    FROM "payment" p
    JOIN "rental" r ON p."rental_id" = r."rental_id"
    JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
    GROUP BY i."film_id"
),
film_actor_count AS (
    SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
    FROM "film_actor"
    GROUP BY "film_id"
),
film_avg_revenue AS (
    SELECT fr."film_id", fr."total_revenue", fac."actor_count",
           (fr."total_revenue" / fac."actor_count") AS "avg_revenue_per_actor"
    FROM film_revenue fr
    JOIN film_actor_count fac ON fr."film_id" = fac."film_id"
),
actor_films AS (
    SELECT a."actor_id", a."first_name" || ' ' || a."last_name" AS "actor_name",
           f."film_id", f."title" AS "film_title"
    FROM "actor" a
    JOIN "film_actor" fa ON a."actor_id" = fa."actor_id"
    JOIN "film" f ON fa."film_id" = f."film_id"
)
SELECT "actor_name", "film_title", "avg_revenue_per_actor"
FROM (
    SELECT af."actor_name", af."film_title", far."avg_revenue_per_actor",
           ROW_NUMBER() OVER (
               PARTITION BY af."actor_name"
               ORDER BY far."avg_revenue_per_actor" DESC
           ) AS "rank"
    FROM actor_films af
    JOIN film_avg_revenue far ON af."film_id" = far."film_id"
)
WHERE "rank" <= 3
ORDER BY "actor_name", "avg_revenue_per_actor" DESC;
```
2025-01-25 06:16:23 - root - INFO - itercount: 1
2025-01-25 06:16:23 - root - INFO - 0
2025-01-25 06:16:23 - root - INFO - results: 
actor_name,film_title,avg_revenue_per_actor
ADAM GRANT,SEABISCUIT PUNK,31.913333333333327
ADAM GRANT,OPERATION OPERATION,29.24333333333333
ADAM GRANT,TWISTED PIRATES,22.29666666666667
ADAM HOPPER,TORQUE BOUND,39.744000000000014
ADAM HOPPER,PRINCESS GIANT,28.547999999999995
ADAM HOPPER,BLINDNESS GUN,25.62
AL GARLAND,BREAKFAST GOLDFINGER,21.965999999999994
AL GARLAND,DRIFTER COMMANDMENTS,20.25142857142857
AL GARLAND,SILVERADO GOLDFINGER,18.375999999999998
ALAN DREYFUSS,FIDELITY DEVIL,34.69749999999999
ALAN DREYFUSS,STRICTLY SCARFACE,28.442499999999992
ALAN DREYFUSS,BARBARELLA STREETCAR,19.349999999999998
ALBERT JOHANSSON,UNDEFEATED DALMATIONS,38.26333333333332
ALBERT JOHANSSON,LEBOWSKI SOLDIERS,24.26333333333334
ALBERT JOHANSSON,REDEMPTION COMFORTS,22.759999999999994
ALBERT NOLTE,CAMELOT VACATION,50.86499999999998
ALBERT NOLTE,FLINTSTONES HAPPINESS,33.707499999999996
ALBERT NOLTE,MANCHURIAN CURTAIN,32.42500000000001
ALEC WAYNE,HUSTLER PARTY,47.69500000000001
ALEC WAYNE,REIGN GENTLEMEN,36.93333333333332
ALEC WAYNE,CENTER DINOSAUR,34.43999999999999
ANGELA HUDSON,MALTESE HOPE,123.77999999999996
ANGELA HUDSON,PITY BOUND,30.747999999999998
ANGELA HUDSON,ISLAND EXORCIST,28.58
ANGELA WITHERSPOON,CAT CONEHEADS,45.42500000000001
ANGELA WITHERSPOON,SECRET GROUNDHOG,38.929999999999986
ANGELA WITHERSPOON,BRINGING HYSTERICAL,35.900000000000006
ANGELINA ASTAIRE,SAMURAI LION,54.374999999999986
ANGELINA ASTAIRE,HUSTLER PARTY,47.69500000000001
ANGELINA ASTAIRE,INTENTIONS EMPIRE,39.415
ANNE CRONYN,APACHE DIVINE,44.67250000000001
ANNE CRONYN,MOON BUNCH,38.70999999999999
ANNE CRONYN,MINDS TRUMAN,24.96666666666667
AUDREY BAILEY,QUILLS BULL,25.209999999999997
AUDREY BAILEY,DISTURBING SCARFACE,22.435
AUDREY BAILEY,DRIFTER COMMANDMENTS,20.25142857142857
AUDREY OLIVIER,DORADO NOTTING,44.182500000000005
AUDREY OLIVIER,WHALE BIKINI,26.96399999999999
AUDREY OLIVIER,STING PERSONAL,22.827142857142857
BELA WALKEN,MIDSUMMER GROUNDHOG,78.39
BELA WALKEN,WHISPERER GIANT,50.593333333333334
BELA WALKEN,ENEMY ODDS,45.17750000000001
BEN HARRIS,MUSKETEERS WAIT,92.83
BEN HARRIS,TOURIST PELICAN,47.25999999999999
BEN HARRIS,BEAR GRACELAND,35.926666666666655
BEN WILLIS,GOODFELLAS SALUTE,26.211250000000007
BEN WILLIS,HEAVYWEIGHTS BEAST,25.95399999999999
BEN WILLIS,CHANCE RESURRECTION,23.621666666666666
BETTE NICHOLSON,BIKINI BORROWERS,49.41499999999999
BETTE NICHOLSON,TRADING PINOCCHIO,49.25
BETTE NICHOLSON,COLDBLOODED DARLING,22.459999999999997
BOB FAWCETT,PELICAN COMFORTS,37.748000000000005
BOB FAWCETT,CIRCUS YOUTH,30.42500000000001
BOB FAWCETT,RAGING AIRPLANE,28.289999999999996
BURT DUKAKIS,RANGE MOONWALKER,44.932500000000005
BURT DUKAKIS,BLINDNESS GUN,25.62
BURT DUKAKIS,TRUMAN CRAZY,20.294999999999995
BURT POSEY,MINDS TRUMAN,24.96666666666667
BURT POSEY,DESERT POSEIDON,23.761999999999993
BURT POSEY,SATURDAY LAMBS,22.746666666666673
BURT TEMPLE,ROSES TREASURE,34.34400000000001
BURT TEMPLE,BUCKET BROTHERHOOD,30.11000000000001
BURT TEMPLE,HEAVYWEIGHTS BEAST,25.95399999999999
CAMERON STREEP,PURE RUNNER,46.419999999999995
CAMERON STREEP,BLUES INSTINCT,21.197499999999998
CAMERON STREEP,MOVIE SHAKESPEARE,18.217499999999998
CAMERON WRAY,COMA HEAD,45.91333333333332
CAMERON WRAY,TITANS JERK,28.815714285714296
CAMERON WRAY,BINGO TALENTED,26.34199999999999
CAMERON ZELLWEGER,WIFE TURN,37.28166666666668
CAMERON ZELLWEGER,GRIT CLOCKWORK,36.89333333333332
CAMERON ZELLWEGER,HARRY IDAHO,32.61666666666668
CARMEN HUNT,TELEGRAPH VOYAGE,33.10428571428572
CARMEN HUNT,MOONSHINE CABIN,28.357999999999993
CARMEN HUNT,TEEN APOLLO,25.565999999999995
CARY MCCONAUGHEY,DOLLS RAGE,30.910000000000004
CARY MCCONAUGHEY,BINGO TALENTED,26.34199999999999
CARY MCCONAUGHEY,RULES HUMAN,20.368
CATE HARRIS,SCARFACE BANG,17.259999999999994
CATE HARRIS,ROLLERCOASTER BRINGING,15.300000000000004
CATE HARRIS,GREEK EVERYONE,13.957500000000005
CATE MCQUEEN,NAME DETECTIVE,45.589999999999996
CATE MCQUEEN,SNATCH SLIPPER,42.59333333333332
CATE MCQUEEN,SALUTE APOLLO,26.692499999999995
CHARLIZE DENCH,BUCKET BROTHERHOOD,30.11000000000001
CHARLIZE DENCH,JOON NORTHWEST,19.915000000000003
CHARLIZE DENCH,CANDLES GRAPES,18.39571428571428
CHRIS BRIDGES,CONVERSATION DOWNHILL,38.27666666666666
CHRIS BRIDGES,SATURN NAME,35.435
CHRIS BRIDGES,WONDERLAND CHRISTMAS,29.756
CHRIS DEPP,SCALAWAG DUCK,34.53600000000001
CHRIS DEPP,SABRINA MIDNIGHT,31.69749999999999
CHRIS DEPP,EAGLES PANKY,25.463333333333328
CHRISTIAN AKROYD,INNOCENT USUAL,63.913333333333355
CHRISTIAN AKROYD,SABRINA MIDNIGHT,31.69749999999999
CHRISTIAN AKROYD,OPERATION OPERATION,29.24333333333333
CHRISTIAN GABLE,DRAGONFLY STRANGERS,34.60666666666666
CHRISTIAN GABLE,GOLDFINGER SENSIBILITY,20.439999999999998
CHRISTIAN GABLE,WATERFRONT DELIVERANCE,20.304999999999996
CHRISTIAN NEESON,SCALAWAG DUCK,34.53600000000001
CHRISTIAN NEESON,LIAISONS SWEET,21.963333333333328
CHRISTIAN NEESON,FELLOWSHIP AUTUMN,21.391428571428573
CHRISTOPHER BERRY,VIDEOTAPE ARSENIC,35.742000000000004
CHRISTOPHER BERRY,BACKLASH UNDEFEATED,22.687142857142856
CHRISTOPHER BERRY,SUGAR WONKA,21.165999999999997
CHRISTOPHER WEST,HUSTLER PARTY,47.69500000000001
CHRISTOPHER WEST,ATTRACTION NEWTON,36.69
CHRISTOPHER WEST,TIMBERLAND SKY,30.922499999999985
CUBA ALLEN,CINCINATTI WHISPERER,21.967499999999998
CUBA ALLEN,METROPOLIS COMA,21.956666666666663
CUBA ALLEN,ROBBERS JOON,21.137999999999995
CUBA BIRCH,EDGE KISSING,30.95
CUBA BIRCH,LOST BIRD,21.62666666666667
CUBA BIRCH,GREATEST NORTH,18.284999999999993
CUBA OLIVIER,APACHE DIVINE,44.67250000000001
CUBA OLIVIER,ROSES TREASURE,34.34400000000001
CUBA OLIVIER,WONDERLAND CHRISTMAS,29.756
DAN HARRIS,TITANS JERK,28.815714285714296
DAN HARRIS,GHOST GROUNDHOG,23.95799999999999
DAN HARRIS,STEERS ARMAGEDDON,21.4625
DAN STREEP,JEKYLL FROGMEN,28.94333333333333
DAN STREEP,HEAVYWEIGHTS BEAST,25.95399999999999
DAN STREEP,BACKLASH UNDEFEATED,22.687142857142856
DAN TORN,INNOCENT USUAL,63.913333333333355
DAN TORN,TUXEDO MILE,25.62333333333333
DAN TORN,ATTACKS HATE,25.459999999999997
DARYL CRAWFORD,SLEEPLESS MONSOON,30.44999999999999
DARYL CRAWFORD,ISLAND EXORCIST,28.58
DARYL CRAWFORD,STRICTLY SCARFACE,28.442499999999992
DARYL WAHLBERG,EXPECATIONS NATURAL,36.93999999999999
DARYL WAHLBERG,POND SEATTLE,21.603333333333342
DARYL WAHLBERG,MAIDEN HOME,20.470000000000002
DEBBIE AKROYD,GALAXY SWEETHEARTS,38.60666666666666
DEBBIE AKROYD,FLINTSTONES HAPPINESS,33.707499999999996
DEBBIE AKROYD,STEPMOM DREAM,26.199999999999996
DUSTIN TAUTOU,VIRTUAL SPOILERS,39.286666666666655
DUSTIN TAUTOU,CONVERSATION DOWNHILL,38.27666666666666
DUSTIN TAUTOU,AUTUMN CROW,28.296666666666667
ED CHASE,WHALE BIKINI,26.96399999999999
ED CHASE,FORREST SONS,17.564
ED CHASE,FRENCH HOLIDAY,14.689999999999998
ED GUINESS,CENTER DINOSAUR,34.43999999999999
ED GUINESS,CLOSER BANG,28.786666666666672
ED GUINESS,PRINCESS GIANT,28.547999999999995
ED MANSFIELD,EASY GLADIATOR,50.25666666666666
ED MANSFIELD,SOMETHING DUCK,42.603333333333325
ED MANSFIELD,FALCON VOLUME,31.942499999999992
ELLEN PRESLEY,NETWORK PEAK,44.563333333333325
ELLEN PRESLEY,BILKO ANONYMOUS,34.29
ELLEN PRESLEY,TURN STAR,23.620000000000005
ELVIS MARX,EXPECATIONS NATURAL,36.93999999999999
ELVIS MARX,GANGS PRIDE,28.182499999999994
ELVIS MARX,SEATTLE EXPECATIONS,27.291666666666668
EMILY DEE,HOLLOW JEOPARDY,24.950000000000006
EMILY DEE,SCARFACE BANG,17.259999999999994
EMILY DEE,SHREK LICENSE,15.616666666666672
EWAN GOODING,ENEMY ODDS,45.17750000000001
EWAN GOODING,GRADUATE LORD,26.420000000000012
EWAN GOODING,QUEEN LUKE,22.796666666666663
FAY KILMER,SECRET GROUNDHOG,38.929999999999986
FAY KILMER,HARRY IDAHO,32.61666666666668
FAY KILMER,BIRD INDEPENDENCE,31.945000000000007
FAY WINSLET,MASSACRE USUAL,59.90000000000001
FAY WINSLET,DRAGONFLY STRANGERS,34.60666666666666
FAY WINSLET,CENTER DINOSAUR,34.43999999999999
FAY WOOD,DORADO NOTTING,44.182500000000005
FAY WOOD,GANGS PRIDE,28.182499999999994
FAY WOOD,SEATTLE EXPECATIONS,27.291666666666668
FRANCES DAY-LEWIS,UNDEFEATED DALMATIONS,38.26333333333332
FRANCES DAY-LEWIS,BRINGING HYSTERICAL,35.900000000000006
FRANCES DAY-LEWIS,MARRIED GO,32.89999999999999
FRANCES TOMEI,AMERICAN CIRCUS,33.556
FRANCES TOMEI,GOODFELLAS SALUTE,26.211250000000007
FRANCES TOMEI,ESCAPE METROPOLIS,20.1875
FRED COSTNER,EASY GLADIATOR,50.25666666666666
FRED COSTNER,MIRACLE VIRTUAL,44.91000000000001
FRED COSTNER,EAGLES PANKY,25.463333333333328
GARY PENN,SOUTH WAIT,53.889999999999986
GARY PENN,VIRTUAL SPOILERS,39.286666666666655
GARY PENN,ATTRACTION NEWTON,36.69
GARY PHOENIX,HEAD STRANGER,76.39
GARY PHOENIX,TIMBERLAND SKY,30.922499999999985
GARY PHOENIX,BUCKET BROTHERHOOD,30.11000000000001
GENE HOPKINS,NIGHTMARE CHILL,84.87500000000001
GENE HOPKINS,TORQUE BOUND,39.744000000000014
GENE HOPKINS,PITY BOUND,30.747999999999998
GENE MCKELLEN,MASSACRE USUAL,59.90000000000001
GENE MCKELLEN,PITY BOUND,30.747999999999998
GENE MCKELLEN,BOOGIE AMELIE,27.283333333333335
GENE WILLIS,DORADO NOTTING,44.182500000000005
GENE WILLIS,AIRPORT POLLOCK,25.704999999999995
GENE WILLIS,SECRETS PARADISE,25.46666666666667
GEOFFREY HESTON,KISSING DOLLS,49.26666666666666
GEOFFREY HESTON,COMA HEAD,45.91333333333332
GEOFFREY HESTON,GRIT CLOCKWORK,36.89333333333332
GINA DEGENERES,WIFE TURN,37.28166666666668
GINA DEGENERES,CHARIOTS CONSPIRACY,35.89500000000001
GINA DEGENERES,TELEGRAPH VOYAGE,33.10428571428572
GOLDIE BRODY,BILKO ANONYMOUS,34.29
GOLDIE BRODY,MARRIED GO,32.89999999999999
GOLDIE BRODY,PITY BOUND,30.747999999999998
GRACE MOSTEL,SLEEPLESS MONSOON,30.44999999999999
GRACE MOSTEL,TRACY CIDER,28.58
GRACE MOSTEL,STING PERSONAL,22.827142857142857
GREG CHAPLIN,SAMURAI LION,54.374999999999986
GREG CHAPLIN,FORWARD TEMPLE,42.89333333333332
GREG CHAPLIN,TITANS JERK,28.815714285714296
GREGORY GOODING,OPERATION OPERATION,29.24333333333333
GREGORY GOODING,MOONSHINE CABIN,28.357999999999993
GREGORY GOODING,SEATTLE EXPECATIONS,27.291666666666668
GRETA KEITEL,ARIZONA BANG,26.197499999999994
GRETA KEITEL,SATURDAY LAMBS,22.746666666666673
GRETA KEITEL,ANNIE IDENTITY,19.926666666666673
GRETA MALDEN,CONVERSATION DOWNHILL,38.27666666666666
GRETA MALDEN,WIFE TURN,37.28166666666668
GRETA MALDEN,CLOSER BANG,28.786666666666672
GROUCHO DUNST,HUNCHBACK IMPOSSIBLE,67.39999999999998
GROUCHO DUNST,GOLD RIVER,47.42999999999999
GROUCHO DUNST,MARRIED GO,32.89999999999999
GROUCHO SINATRA,DYING MAKER,46.91499999999999
GROUCHO SINATRA,PELICAN COMFORTS,37.748000000000005
GROUCHO SINATRA,SCALAWAG DUCK,34.53600000000001
GROUCHO WILLIAMS,JINGLE SAGEBRUSH,35.435
GROUCHO WILLIAMS,FANTASIA PARK,24.60333333333334
GROUCHO WILLIAMS,BROOKLYN DESERT,23.357999999999993
HARRISON BALE,WONDERLAND CHRISTMAS,29.756
HARRISON BALE,FANTASIA PARK,24.60333333333334
HARRISON BALE,STING PERSONAL,22.827142857142857
HARVEY HOPE,LOCK REAR,25.42000000000001
HARVEY HOPE,DOWNHILL ENOUGH,21.1875
HARVEY HOPE,RULES HUMAN,20.368
HELEN VOIGHT,CAT CONEHEADS,45.42500000000001
HELEN VOIGHT,FIDELITY DEVIL,34.69749999999999
HELEN VOIGHT,LIES TREATMENT,21.104285714285712
HENRY BERRY,APACHE DIVINE,44.67250000000001
HENRY BERRY,FREDDY STORM,42.25666666666665
HENRY BERRY,CHICKEN HELLFIGHTERS,34.39000000000001
HUMPHREY GARLAND,MINE TITANS,76.905
HUMPHREY GARLAND,ROSES TREASURE,34.34400000000001
HUMPHREY GARLAND,WONDERLAND CHRISTMAS,29.756
HUMPHREY WILLIS,PIRATES ROXANNE,51.78
HUMPHREY WILLIS,FLINTSTONES HAPPINESS,33.707499999999996
HUMPHREY WILLIS,PRINCESS GIANT,28.547999999999995
IAN TANDY,ZORRO ARK,71.56333333333336
IAN TANDY,VIDEOTAPE ARSENIC,35.742000000000004
IAN TANDY,DEER VIRGINIAN,32.23999999999999
JADA RYDER,MIDSUMMER GROUNDHOG,78.39
JADA RYDER,KISSING DOLLS,49.26666666666666
JADA RYDER,GARDEN ISLAND,48.26666666666666
JAMES PITT,INNOCENT USUAL,63.913333333333355
JAMES PITT,STEEL SANTA,47.25666666666666
JAMES PITT,WILLOW TRACY,29.420000000000012
JANE JACKMAN,BACKLASH UNDEFEATED,22.687142857142856
JANE JACKMAN,HOPE TOOTSIE,18.955000000000002
JANE JACKMAN,SILVERADO GOLDFINGER,18.375999999999998
JAYNE NEESON,EDGE KISSING,30.95
JAYNE NEESON,INTERVIEW LIAISONS,25.75999999999999
JAYNE NEESON,DARLING BREAKING,24.955000000000005
JAYNE NOLTE,BIRD INDEPENDENCE,31.945000000000007
JAYNE NOLTE,STRANGERS GRAFFITI,24.765999999999995
JAYNE NOLTE,ENGLISH BULWORTH,20.739999999999995
JAYNE SILVERSTONE,HARRY IDAHO,32.61666666666668
JAYNE SILVERSTONE,QUEEN LUKE,22.796666666666663
JAYNE SILVERSTONE,CAUSE DATE,21.464999999999993
JEFF SILVERSTONE,SPARTACUS CHEAPER,20.303333333333338
JEFF SILVERSTONE,PARADISE SABRINA,19.955
JEFF SILVERSTONE,MUSCLE BRIGHT,19.139999999999993
JENNIFER DAVIS,SILVERADO GOLDFINGER,18.375999999999998
JENNIFER DAVIS,POSEIDON FOREVER,16.804999999999996
JENNIFER DAVIS,HANOVER GALAXY,14.118571428571427
JESSICA BAILEY,HEAD STRANGER,76.39
JESSICA BAILEY,WHISPERER GIANT,50.593333333333334
JESSICA BAILEY,DORADO NOTTING,44.182500000000005
JIM MOSTEL,METROPOLIS COMA,21.956666666666663
JIM MOSTEL,LEAGUE HELLFIGHTERS,17.638333333333332
JIM MOSTEL,AIRPLANE SIERRA,16.57
JODIE DEGENERES,BEVERLY OUTLAW,28.947499999999994
JODIE DEGENERES,CLOSER BANG,28.786666666666672
JODIE DEGENERES,MOONSHINE CABIN,28.357999999999993
JOE SWANK,SUNRISE LEAGUE,34.152
JOE SWANK,LEBOWSKI SOLDIERS,24.26333333333334
JOE SWANK,LAWLESS VISION,21.709999999999997
JOHN SUVARI,NAME DETECTIVE,45.589999999999996
JOHN SUVARI,BEVERLY OUTLAW,28.947499999999994
JOHN SUVARI,RAGING AIRPLANE,28.289999999999996
JOHNNY CAGE,REIGN GENTLEMEN,36.93333333333332
JOHNNY CAGE,LIES TREATMENT,21.104285714285712
JOHNNY CAGE,VELVET TERMINATOR,19.748888888888892
JOHNNY LOLLOBRIGIDA,SUNRISE LEAGUE,34.152
JOHNNY LOLLOBRIGIDA,GOODFELLAS SALUTE,26.211250000000007
JOHNNY LOLLOBRIGIDA,RIDGEMONT SUBMARINE,26.13599999999999
JON CHASE,VIRTUAL SPOILERS,39.286666666666655
JON CHASE,BINGO TALENTED,26.34199999999999
JON CHASE,SUGAR WONKA,21.165999999999997
JUDE CRUISE,CAMELOT VACATION,50.86499999999998
JUDE CRUISE,SCALAWAG DUCK,34.53600000000001
JUDE CRUISE,TIMBERLAND SKY,30.922499999999985
JUDY DEAN,GUNFIGHTER MUSSOLINI,17.220000000000002
JUDY DEAN,ROCKETEER MOTHER,16.667142857142846
JUDY DEAN,ALADDIN CALENDAR,16.471249999999998
JULIA BARRYMORE,PELICAN COMFORTS,37.748000000000005
JULIA BARRYMORE,WIFE TURN,37.28166666666668
JULIA BARRYMORE,SECRETARY ROUGE,18.80333333333333
JULIA FAWCETT,CLOSER BANG,28.786666666666672
JULIA FAWCETT,RIDGEMONT SUBMARINE,26.13599999999999
JULIA FAWCETT,DAY UNFAITHFUL,21.971999999999998
JULIA MCQUEEN,FREDDY STORM,42.25666666666665
JULIA MCQUEEN,WONKA SEA,33.41000000000001
JULIA MCQUEEN,SLEEPLESS MONSOON,30.44999999999999
JULIA ZELLWEGER,MINDS TRUMAN,24.96666666666667
JULIA ZELLWEGER,HOLLOW JEOPARDY,24.950000000000006
JULIA ZELLWEGER,DETECTIVE VISION,22.910000000000007
JULIANNE DENCH,RIDGEMONT SUBMARINE,26.13599999999999
JULIANNE DENCH,DISTURBING SCARFACE,22.435
JULIANNE DENCH,CINCINATTI WHISPERER,21.967499999999998
KARL BERRY,ARIZONA BANG,26.197499999999994
KARL BERRY,STAGECOACH ARMAGEDDON,25.790000000000003
KARL BERRY,BOUND CHEAPER,25.380000000000006
KENNETH HOFFMAN,TORQUE BOUND,39.744000000000014
KENNETH HOFFMAN,BRANNIGAN SUNRISE,37.440000000000005
KENNETH HOFFMAN,GANGS PRIDE,28.182499999999994
KENNETH PALTROW,SHOW LORD,85.37500000000001
KENNETH PALTROW,FALCON VOLUME,31.942499999999992
KENNETH PALTROW,REDEMPTION COMFORTS,22.759999999999994
KENNETH PESCI,DISTURBING SCARFACE,22.435
KENNETH PESCI,FARGO GANDHI,22.351999999999997
KENNETH PESCI,PEAK FOREVER,21.159999999999993
KENNETH TORN,WORKING MICROCOSMOS,32.75
KENNETH TORN,SEATTLE EXPECATIONS,27.291666666666668
KENNETH TORN,GHOST GROUNDHOG,23.95799999999999
KEVIN BLOOM,AMERICAN CIRCUS,33.556
KEVIN BLOOM,SABRINA MIDNIGHT,31.69749999999999
KEVIN BLOOM,BOOGIE AMELIE,27.283333333333335
KEVIN GARLAND,SHOW LORD,85.37500000000001
KEVIN GARLAND,GRIT CLOCKWORK,36.89333333333332
KEVIN GARLAND,TRIP NEWTON,36.43
KIM ALLEN,JINGLE SAGEBRUSH,35.435
KIM ALLEN,TITANS JERK,28.815714285714296
KIM ALLEN,LOLA AGENT,26.626666666666665
KIRK JOVOVICH,FORRESTER COMANCHEROS,48.91
KIRK JOVOVICH,NETWORK PEAK,44.563333333333325
KIRK JOVOVICH,TUXEDO MILE,25.62333333333333
KIRSTEN AKROYD,BUCKET BROTHERHOOD,30.11000000000001
KIRSTEN AKROYD,HURRICANE AFFAIR,28.586666666666662
KIRSTEN AKROYD,BUGSY SONG,27.945000000000007
KIRSTEN PALTROW,CHICKEN HELLFIGHTERS,34.39000000000001
KIRSTEN PALTROW,SLEEPING SUSPECTS,32.93999999999999
KIRSTEN PALTROW,TITANS JERK,28.815714285714296
LAURA BRODY,SHOCK CABIN,99.69999999999997
LAURA BRODY,CAT CONEHEADS,45.42500000000001
LAURA BRODY,SOMETHING DUCK,42.603333333333325
LAURENCE BULLOCK,FISH OPUS,54.374999999999986
LAURENCE BULLOCK,EXPECATIONS NATURAL,36.93999999999999
LAURENCE BULLOCK,STREETCAR INTENTIONS,21.25
LISA MONROE,ZORRO ARK,71.56333333333336
LISA MONROE,HANKY OCTOBER,38.91333333333332
LISA MONROE,QUILLS BULL,25.209999999999997
LIZA BERGMAN,ENEMY ODDS,45.17750000000001
LIZA BERGMAN,PAYCHECK WAIT,33.946666666666665
LIZA BERGMAN,DEER VIRGINIAN,32.23999999999999
LUCILLE DEE,TELEGRAPH VOYAGE,33.10428571428572
LUCILLE DEE,WORKING MICROCOSMOS,32.75
LUCILLE DEE,HARRY IDAHO,32.61666666666668
LUCILLE TRACY,LOLA AGENT,26.626666666666665
LUCILLE TRACY,COLDBLOODED DARLING,22.459999999999997
LUCILLE TRACY,EGG IGBY,21.157999999999994
MAE HOFFMAN,SECRET GROUNDHOG,38.929999999999986
MAE HOFFMAN,EAGLES PANKY,25.463333333333328
MAE HOFFMAN,TURN STAR,23.620000000000005
MARY KEITEL,STEEL SANTA,47.25666666666666
MARY KEITEL,INTENTIONS EMPIRE,39.415
MARY KEITEL,ROSES TREASURE,34.34400000000001
MARY TANDY,PHILADELPHIA WIFE,59.38999999999998
MARY TANDY,GARDEN ISLAND,48.26666666666666
MARY TANDY,FALCON VOLUME,31.942499999999992
MATTHEW CARREY,TRIP NEWTON,36.43
MATTHEW CARREY,HARRY IDAHO,32.61666666666668
MATTHEW CARREY,CIRCUS YOUTH,30.42500000000001
MATTHEW JOHANSSON,CAMPUS REMEMBER,30.269999999999996
MATTHEW JOHANSSON,SUGAR WONKA,21.165999999999997
MATTHEW JOHANSSON,SCORPION APOLLO,21.09625
MATTHEW LEIGH,GIANT TROOPERS,106.71999999999997
MATTHEW LEIGH,EASY GLADIATOR,50.25666666666666
MATTHEW LEIGH,DAWN POND,21.469999999999995
MEG HAWKE,SABRINA MIDNIGHT,31.69749999999999
MEG HAWKE,LIAISONS SWEET,21.963333333333328
MEG HAWKE,VACATION BOONDOCK,16.131666666666664
MENA HOPPER,CORE SUIT,25.954999999999995
MENA HOPPER,SATURDAY LAMBS,22.746666666666673
MENA HOPPER,CHASING FIGHT,22.161999999999995
MENA TEMPLE,INTERVIEW LIAISONS,25.75999999999999
MENA TEMPLE,WASH HEAVENLY,23.953999999999994
MENA TEMPLE,LIAISONS SWEET,21.963333333333328
MERYL ALLEN,BOOGIE AMELIE,27.283333333333335
MERYL ALLEN,CHANCE RESURRECTION,23.621666666666666
MERYL ALLEN,BRIGHT ENCOUNTERS,23.217499999999998
MERYL GIBSON,PRINCESS GIANT,28.547999999999995
MERYL GIBSON,HUNGER ROOF,22.869999999999994
MERYL GIBSON,EGG IGBY,21.157999999999994
MICHAEL BENING,TELEGRAPH VOYAGE,33.10428571428572
MICHAEL BENING,BEAUTY GREASE,26.555999999999994
MICHAEL BENING,IGBY MAKER,19.961999999999996
MICHAEL BOLGER,DYING MAKER,46.91499999999999
MICHAEL BOLGER,SOMETHING DUCK,42.603333333333325
MICHAEL BOLGER,WIFE TURN,37.28166666666668
MICHELLE MCCONAUGHEY,BAKED CLEOPATRA,79.84
MICHELLE MCCONAUGHEY,DETAILS PACKER,66.90499999999999
MICHELLE MCCONAUGHEY,SOUTH WAIT,53.889999999999986
MILLA KEITEL,TRADING PINOCCHIO,49.25
MILLA KEITEL,PURE RUNNER,46.419999999999995
MILLA KEITEL,ANTHEM LUKE,42.925
MILLA PECK,WHISPERER GIANT,50.593333333333334
MILLA PECK,SEATTLE EXPECATIONS,27.291666666666668
MILLA PECK,TEEN APOLLO,25.565999999999995
MINNIE KILMER,HUSTLER PARTY,47.69500000000001
MINNIE KILMER,JASON TRAP,20.151999999999994
MINNIE KILMER,VELVET TERMINATOR,19.748888888888892
MINNIE ZELLWEGER,RAGING AIRPLANE,28.289999999999996
MINNIE ZELLWEGER,DAY UNFAITHFUL,21.971999999999998
MINNIE ZELLWEGER,PICKUP DRIVING,19.767999999999997
MORGAN HOPKINS,REIGN GENTLEMEN,36.93333333333332
MORGAN HOPKINS,HARRY IDAHO,32.61666666666668
MORGAN HOPKINS,STAGECOACH ARMAGEDDON,25.790000000000003
MORGAN MCDORMAND,SUIT WALLS,29.558
MORGAN MCDORMAND,WASH HEAVENLY,23.953999999999994
MORGAN MCDORMAND,BETRAYED REAR,22.9625
MORGAN WILLIAMS,ROSES TREASURE,34.34400000000001
MORGAN WILLIAMS,TUXEDO MILE,25.62333333333333
MORGAN WILLIAMS,FARGO GANDHI,22.351999999999997
NATALIE HOPKINS,FOOL MOCKINGBIRD,87.885
NATALIE HOPKINS,NETWORK PEAK,44.563333333333325
NATALIE HOPKINS,TORQUE BOUND,39.744000000000014
NICK DEGENERES,MINE TITANS,76.905
NICK DEGENERES,ZORRO ARK,71.56333333333336
NICK DEGENERES,SUPER WYOMING,28.956666666666663
NICK STALLONE,TRADING PINOCCHIO,49.25
NICK STALLONE,TEEN APOLLO,25.565999999999995
NICK STALLONE,STRANGERS GRAFFITI,24.765999999999995
NICK WAHLBERG,APACHE DIVINE,44.67250000000001
NICK WAHLBERG,JEKYLL FROGMEN,28.94333333333333
NICK WAHLBERG,GOODFELLAS SALUTE,26.211250000000007
OLYMPIA PFEIFFER,TOURIST PELICAN,47.25999999999999
OLYMPIA PFEIFFER,HANKY OCTOBER,38.91333333333332
OLYMPIA PFEIFFER,OTHERS SOUP,19.942500000000003
OPRAH KILMER,ANTHEM LUKE,42.925
OPRAH KILMER,HEARTBREAKERS BRIGHT,26.55999999999999
OPRAH KILMER,STEERS ARMAGEDDON,21.4625
PARKER GOLDBERG,CONFIDENTIAL INTERVIEW,82.355
PARKER GOLDBERG,FISH OPUS,54.374999999999986
PARKER GOLDBERG,INCH JET,19.163999999999994
PENELOPE CRONYN,BIKINI BORROWERS,49.41499999999999
PENELOPE CRONYN,ROCKY WAR,35.946666666666665
PENELOPE CRONYN,BEAR GRACELAND,35.926666666666655
PENELOPE GUINESS,RULES HUMAN,20.368
PENELOPE GUINESS,HUMAN GRAFFITI,20.212500000000002
PENELOPE GUINESS,CHEAPER CLYDE,18.4
PENELOPE MONROE,TOURIST PELICAN,47.25999999999999
PENELOPE MONROE,RANGE MOONWALKER,44.932500000000005
PENELOPE MONROE,TRIP NEWTON,36.43
PENELOPE PINKETT,SUIT WALLS,29.558
PENELOPE PINKETT,CORE SUIT,25.954999999999995
PENELOPE PINKETT,SATURDAY LAMBS,22.746666666666673
RALPH CRUZ,WITCHES PANIC,43.425000000000004
RALPH CRUZ,THIN SAGEBRUSH,36.945
RALPH CRUZ,VIDEOTAPE ARSENIC,35.742000000000004
RAY JOHANSSON,MANCHURIAN CURTAIN,32.42500000000001
RAY JOHANSSON,ISLAND EXORCIST,28.58
RAY JOHANSSON,ARIZONA BANG,26.197499999999994
REESE KILMER,FORRESTER COMANCHEROS,48.91
REESE KILMER,SCALAWAG DUCK,34.53600000000001
REESE KILMER,CAMPUS REMEMBER,30.269999999999996
REESE WEST,YENTL IDAHO,135.76999999999998
REESE WEST,WITCHES PANIC,43.425000000000004
REESE WEST,GOODFELLAS SALUTE,26.211250000000007
RENEE BALL,CAT CONEHEADS,45.42500000000001
RENEE BALL,BINGO TALENTED,26.34199999999999
RENEE BALL,GHOST GROUNDHOG,23.95799999999999
RENEE TRACY,COMA HEAD,45.91333333333332
RENEE TRACY,ROCKY WAR,35.946666666666665
RENEE TRACY,MILLION ACE,26.159999999999997
RICHARD PENN,HANKY OCTOBER,38.91333333333332
RICHARD PENN,LEBOWSKI SOLDIERS,24.26333333333334
RICHARD PENN,DARKO DORADO,20.7225
RIP CRAWFORD,FOOL MOCKINGBIRD,87.885
RIP CRAWFORD,RANGE MOONWALKER,44.932500000000005
RIP CRAWFORD,BRANNIGAN SUNRISE,37.440000000000005
RIP WINSLET,FORWARD TEMPLE,42.89333333333332
RIP WINSLET,ATTRACTION NEWTON,36.69
RIP WINSLET,WHALE BIKINI,26.96399999999999
RITA REYNOLDS,SNATCH SLIPPER,42.59333333333332
RITA REYNOLDS,IMPOSSIBLE PREJUDICE,24.953333333333333
RITA REYNOLDS,BEHAVIOR RUNAWAY,20.174
RIVER DEAN,TEEN APOLLO,25.565999999999995
RIVER DEAN,DOGMA FAMILY,25.528571428571432
RIVER DEAN,QUEEN LUKE,22.796666666666663
ROCK DUKAKIS,WORKING MICROCOSMOS,32.75
ROCK DUKAKIS,SEABISCUIT PUNK,31.913333333333327
ROCK DUKAKIS,HEAVYWEIGHTS BEAST,25.95399999999999
RUSSELL BACALL,SUNRISE LEAGUE,34.152
RUSSELL BACALL,PAYCHECK WAIT,33.946666666666665
RUSSELL BACALL,HURRICANE AFFAIR,28.586666666666662
RUSSELL CLOSE,RANGE MOONWALKER,44.932500000000005
RUSSELL CLOSE,CALIFORNIA BIRDS,41.94
RUSSELL CLOSE,VIDEOTAPE ARSENIC,35.742000000000004
RUSSELL TEMPLE,GOLD RIVER,47.42999999999999
RUSSELL TEMPLE,PELICAN COMFORTS,37.748000000000005
RUSSELL TEMPLE,CLOSER BANG,28.786666666666672
SALMA NOLTE,DETAILS PACKER,66.90499999999999
SALMA NOLTE,FALCON VOLUME,31.942499999999992
SALMA NOLTE,WASH HEAVENLY,23.953999999999994
SANDRA KILMER,SLEEPING SUSPECTS,32.93999999999999
SANDRA KILMER,CANDIDATE PERDITION,24.202499999999997
SANDRA KILMER,STREETCAR INTENTIONS,21.25
SANDRA PECK,BEVERLY OUTLAW,28.947499999999994
SANDRA PECK,BIRDS PERDITION,27.954999999999995
SANDRA PECK,STAGECOACH ARMAGEDDON,25.790000000000003
SCARLETT BENING,SNATCH SLIPPER,42.59333333333332
SCARLETT BENING,CALIFORNIA BIRDS,41.94
SCARLETT BENING,SEATTLE EXPECATIONS,27.291666666666668
SCARLETT DAMON,BEAR GRACELAND,35.926666666666655
SCARLETT DAMON,LOLA AGENT,26.626666666666665
SCARLETT DAMON,MILLION ACE,26.159999999999997
SEAN GUINESS,PHILADELPHIA WIFE,59.38999999999998
SEAN GUINESS,FORRESTER COMANCHEROS,48.91
SEAN GUINESS,TRACY CIDER,28.58
SEAN WILLIAMS,FORWARD TEMPLE,42.89333333333332
SEAN WILLIAMS,SUNRISE LEAGUE,34.152
SEAN WILLIAMS,SEABISCUIT PUNK,31.913333333333327
SIDNEY CROWE,AMERICAN CIRCUS,33.556
SIDNEY CROWE,TITANS JERK,28.815714285714296
SIDNEY CROWE,DOGMA FAMILY,25.528571428571432
SISSY SOBIESKI,FERRIS MOTHER,79.83
SISSY SOBIESKI,ROCKY WAR,35.946666666666665
SISSY SOBIESKI,GREEK EVERYONE,13.957500000000005
SPENCER DEPP,MASSACRE USUAL,59.90000000000001
SPENCER DEPP,WITCHES PANIC,43.425000000000004
SPENCER DEPP,SALUTE APOLLO,26.692499999999995
SPENCER PECK,WASH HEAVENLY,23.953999999999994
SPENCER PECK,QUEEN LUKE,22.796666666666663
SPENCER PECK,BACKLASH UNDEFEATED,22.687142857142856
SUSAN DAVIS,VIDEOTAPE ARSENIC,35.742000000000004
SUSAN DAVIS,GOODFELLAS SALUTE,26.211250000000007
SUSAN DAVIS,AIRPORT POLLOCK,25.704999999999995
SYLVESTER DERN,CONFIDENTIAL INTERVIEW,82.355
SYLVESTER DERN,BIRDS PERDITION,27.954999999999995
SYLVESTER DERN,BACKLASH UNDEFEATED,22.687142857142856
THORA TEMPLE,GALAXY SWEETHEARTS,38.60666666666666
THORA TEMPLE,TELEGRAPH VOYAGE,33.10428571428572
THORA TEMPLE,INTERVIEW LIAISONS,25.75999999999999
TIM HACKMAN,PACKER MADIGAN,60.78000000000002
TIM HACKMAN,BUCKET BROTHERHOOD,30.11000000000001
TIM HACKMAN,BEHAVIOR RUNAWAY,20.174
TOM MCKELLEN,KISSING DOLLS,49.26666666666666
TOM MCKELLEN,MISSION ZOOLANDER,25.363999999999994
TOM MCKELLEN,EGG IGBY,21.157999999999994
TOM MIRANDA,UNDEFEATED DALMATIONS,38.26333333333332
TOM MIRANDA,SUNRISE LEAGUE,34.152
TOM MIRANDA,SUIT WALLS,29.558
UMA WOOD,LOLITA WORLD,48.90000000000001
UMA WOOD,STEEL SANTA,47.25666666666666
UMA WOOD,TORQUE BOUND,39.744000000000014
VAL BOLGER,WORKING MICROCOSMOS,32.75
VAL BOLGER,METROPOLIS COMA,21.956666666666663
VAL BOLGER,DRIFTER COMMANDMENTS,20.25142857142857
VIVIEN BASINGER,TELEGRAPH VOYAGE,33.10428571428572
VIVIEN BASINGER,MINORITY KISS,27.89
VIVIEN BASINGER,JERICHO MULAN,24.707499999999996
VIVIEN BERGEN,ENEMY ODDS,45.17750000000001
VIVIEN BERGEN,SALUTE APOLLO,26.692499999999995
VIVIEN BERGEN,SATURDAY LAMBS,22.746666666666673
WALTER TORN,NIGHTMARE CHILL,84.87500000000001
WALTER TORN,WITCHES PANIC,43.425000000000004
WALTER TORN,FREDDY STORM,42.25666666666665
WARREN JACKMAN,NAME DETECTIVE,45.589999999999996
WARREN JACKMAN,AMERICAN CIRCUS,33.556
WARREN JACKMAN,HEAVYWEIGHTS BEAST,25.95399999999999
WARREN NOLTE,GARDEN ISLAND,48.26666666666666
WARREN NOLTE,CHARADE DUFFEL,26.950000000000003
WARREN NOLTE,FANTASIA PARK,24.60333333333334
WHOOPI HURT,PELICAN COMFORTS,37.748000000000005
WHOOPI HURT,STRICTLY SCARFACE,28.442499999999992
WHOOPI HURT,BIRDS PERDITION,27.954999999999995
WILL WILSON,SLEEPING SUSPECTS,32.93999999999999
WILL WILSON,CAMPUS REMEMBER,30.269999999999996
WILL WILSON,HUMAN GRAFFITI,20.212500000000002
WILLIAM HACKMAN,HUNCHBACK IMPOSSIBLE,67.39999999999998
WILLIAM HACKMAN,MOONSHINE CABIN,28.357999999999993
WILLIAM HACKMAN,SECRETS PARADISE,25.46666666666667
WOODY HOFFMAN,WIFE TURN,37.28166666666668
WOODY HOFFMAN,TELEGRAPH VOYAGE,33.10428571428572
WOODY HOFFMAN,SNOWMAN ROLLERCOASTER,24.256666666666675
WOODY JOLIE,TRIP NEWTON,36.43
WOODY JOLIE,WONDERLAND CHRISTMAS,29.756
WOODY JOLIE,TITANS JERK,28.815714285714296
ZERO CAGE,THIN SAGEBRUSH,36.945
ZERO CAGE,STRANGERS GRAFFITI,24.765999999999995
ZERO CAGE,VELVET TERMINATOR,19.748888888888892


2025-01-25 06:16:23 - root - INFO - Please check the answer again by reviewing Please provide a list of the top three revenue-generating films for each actor, along with the average revenue per actor in those films, calculated by dividing the total film revenue equally among the actors for each film., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: Below is the list of the top three revenue-generating films for each actor, along with the average revenue per actor in those films:

```csv
actor_name,film_title,average_revenue_per_actor
actor1_name:str,film1_title:str,average_revenue1:float
actor1_name:str,film2_title:str,average_revenue2:float
actor1_name:str,film3_title:str,average_revenue3:float
actor2_name:str,film1_title:str,average_revenue1:float
actor2_name:str,film2_title:str,average_revenue2:float
actor2_name:str,film3_title:str,average_revenue3:float
...
```

In this table, each actor is listed alongside their top three films based on total revenue generated. The average revenue per actor for each film is calculated by dividing the film's total revenue equally among all actors featured in that film. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Too long, hard cut:
actor_name,film_title,avg_revenue_per_actor
ADAM GRANT,SEABISCUIT PUNK,31.913333333333327
ADAM GRANT,OPERATION OPERATION,29.24333333333333
ADAM GRANT,TWISTED PIRATES,22.29666666666667
ADAM HOPPER,TORQUE BOUND,39.744000000000014
ADAM HOPPER,PRINCESS GIANT,28.547999999999995
ADAM HOPPER,BLINDNESS GUN,25.62
AL GARLAND,BREAKFAST GOLDFINGER,21.965999999999994
AL GARLAND,DRIFTER COMMANDMENTS,20.25142857142857
AL GARLAND,SILVERADO GOLDFINGER,18.375999999999998
ALAN DREYFUSS,FIDELITY DEVIL,34.69749999999999
ALAN DREYFUSS,STRICTLY SCARFACE,28.442499999999992
ALAN DREYFUSS,BARBARELLA STREETCAR,19.349999999999998
ALBERT JOHANSSON,UNDEFEATED DALMATIONS,38.26333333333332
ALBERT JOHANSSON,LEBOWSKI SOLDIERS,24.26333333333334
ALBERT JOHANSSON,REDEMPTION COMFORTS,22.759999999999994
ALBERT NOLTE,CAMELOT VACATION,50.86499999999998
ALBERT NOLTE,FLINTSTONES HAPPINESS,33.707499999999996
ALBERT NOLTE,MANCHURIAN CURTAIN,32.42500000000001
ALEC WAYNE,HUSTLER PARTY,47.69500000000001
ALEC WAYNE,REIGN GENTLEMEN,36.93333333333332
ALEC WAYNE,CENTER DINOSAUR,34.43999999999999
ANGELA HUDSON,MALTESE HOPE,123.77999999999996
ANGELA HUDSON,PITY BOUND,30.747999999999998
ANGELA HUDSON,ISLAND EXORCIST,28.58
ANGELA WITHERSPOON,CAT CONEHEADS,45.42500000000001
ANGELA WITHERSPOON,SECRET GROUNDHOG,38.929999999999986
ANGELA WITHERSPOON,BRINGING HYSTERICAL,35.900000000000006
ANGELINA ASTAIRE,SAMURAI LION,54.374999999999986
ANGELINA ASTAIRE,HUSTLER PARTY,47.69500000000001
ANGELINA ASTAIRE,INTENTIONS EMPIRE,39.415
ANNE CRONYN,APACHE DIVINE,44.67250000000001
ANNE CRONYN,MOON BUNCH,38.70999999999999
ANNE CRONYN,MINDS TRUMAN,24.96666666666667
AUDREY BAILEY,QUILLS BULL,25.209999999999997
AUDREY BAILEY,DISTURBING SCARFACE,22.435
AUDREY BAILEY,DRIFTER COMMANDMENTS,20.25142857142857
AUDREY OLIVIER,DORADO NOTTING,44.182500000000005
AUDREY OLIVIER,WHALE BIKINI,26.96399999999999
AUDREY OLIVIER,STING PERSONAL,22.827142857142857
BELA WALKEN,MIDSUMMER GROUNDHOG,78.39
BELA WALKEN,WHISPERER GIANT,50.593333333333334
BELA WALKEN,ENEMY ODDS,45.17750000000001
BEN HARRIS,MUSKETEERS WAIT,92.83
BEN HARRIS,TOURIST PELICAN,47.25999999999999
BEN HARRIS,BEAR GRACELAND,35.926666666666655
BEN WILLIS,GOODFELLAS SALUTE,26.211250000000007
BEN WILLIS,HEAVYWEIGHTS BEAST,25.95399999999999
BEN WILLIS,CHANCE RESURRECTION,23.621666666666666
BETTE NICHOLSON,BIKINI BORROWERS,49.41499999999999
BETTE NICHOLSON,TRADING PINOCCHIO,49.25
BETTE NICHOLSON,COLDBLOODED DARLING,22.459999999999997
BOB FAWCETT,PELICAN COMFORTS,37.748000000000005
BOB FAWCETT,CIRCUS YOUTH,30.42500000000001
BOB FAWCETT,RAGING AIRPLANE,28.289999999999996
BURT DUKAKIS,RANGE MOONWALKER,44.932500000000005
BURT DUKAKIS,BLINDNESS GUN,25.62
BURT DUKAKIS,TRUMAN CRAZY,20.294999999999995
BURT POSEY,MINDS TRUMAN,24.96666666666667
BURT POSEY,DESERT POSEIDON,23.761999999999993
BURT POSEY,SATURDAY LAMBS,22.746666666666673
BURT TEMPLE,ROSES TREASURE,34.34400000000001
BURT TEMPLE,BUCKET BROTHERHOOD,30.11000000000001
BURT TEMPLE,HEAVYWEIGHTS BEAST,25.95399999999999
CAMERON STREEP,PURE RUNNER,46.419999999999995
CAMERON STREEP,BLUES INSTINCT,21.197499999999998
CAMERON STREEP,MOVIE SHAKESPEARE,18.217499999999998
CAMERON WRAY,COMA HEAD,45.91333333333332
CAMERON WRAY,TITANS JERK,28.815714285714296
CAMERON WRAY,BINGO TALENTED,26.34199999999999
CAMERON ZELLWEGER,WIFE TURN,37.28166666666668
CAMERON ZELLWEGER,GRIT CLOCKWORK,36.89333333333332
CAMERON ZELLWEGER,HARRY IDAHO,32.61666666666668
CARMEN HUNT,TELEGRAPH VOYAGE,33.10428571428572
CARMEN HUNT,MOONSHINE CABIN,28.357999999999993
CARMEN HUNT,TEEN APOLLO,25.565999999999995
CARY MCCONAUGHEY,DOLLS RAGE,30.910000000000004
CARY MCCONAUGHEY,BINGO TALENTED,26.34199999999999
CARY MCCONAUGHEY,RULES HUMAN,20.368
CATE HARRIS,SCARFACE BANG,17.259999999999994
CATE HARRIS,ROLLERCOASTER BRINGING,15.300000000000004
CATE HARRIS,GREEK EVERYONE,13.957500000000005
CATE MCQUEEN,NAME DETECTIVE,45.589999999999996
CATE MCQUEEN,SNATCH SLIPPER,42.59333333333332
CATE MCQUEEN,SALUTE APOLLO,26.692499999999995
CHARLIZE DENCH,BUCKET BROTHERHOOD,30.11000000000001
CHARLIZE DENCH,JOON NORTHWEST,19.915000000000003
CHARLIZE DENCH,CANDLES GRAPES,18.39571428571428
CHRIS BRIDGES,CONVERSATION DOWNHILL,38.27666666666666
CHRIS BRIDGES,SATURN NAME,35.435
CHRIS BRIDGES,WONDERLAND CHRISTMAS,29.756
CHRIS DEPP,SCALAWAG DUCK,34.53600000000001
CHRIS DEPP,SABRINA MIDNIGHT,31.69749999999999
CHRIS DEPP,EAGLES PANKY,25.463333333333328
CHRISTIAN AKROYD,INNOCENT USUAL,63.913333333333355
CHRISTIAN AKROYD,SABRINA MIDNIGHT,31.69749999999999
CHRISTIAN AKROYD,OPERATION OPERATION,29.24333333333333
CHRISTIAN GABLE,DRAGONFLY STRANGERS,34.60666666666666
CHRISTIAN GABLE,GOLDFINGER SENSIBILITY,20.439999999999998
CHRISTIAN GABLE,WATERFRONT DELIVERANCE,20.304999999999996
CHRISTIAN NEESON,SCALAWAG DUCK,34.53600000000001
CHRISTIAN NEESON,LIAISONS SWEET,21.963333333333328
CHRISTIAN NEESON,FELLOWSHIP AUTUMN,21.391428571428573
CHRISTOPHER BERRY,VIDEOTAPE ARSENIC,35.742000000000004
CHRISTOPHER BERRY,BACKLASH UNDEFEATED,22.687142857142856
CHRISTOPHER BERRY,SUGAR WONKA,21.165999999999997
CHRISTOPHER WEST,HUSTLER PARTY,47.69500000000001
CHRISTOPHER WEST,ATTRACTION NEWTON,36.69
CHRISTOPHER WEST,TIMBERLAND SKY,30.922499999999985
CUBA ALLEN,CINCINATTI WHISPERER,21.967499999999998
CUBA ALLEN,METROPOLIS COMA,21.956666666666663
CUBA ALLEN,ROBBERS JOON,21.137999999999995
CUBA BIRCH,EDGE KISSING,30.95
CUBA BIRCH,LOST BIRD,21.62666666666667
CUBA BIRCH,GREATEST NORTH,18.284999999999993
CUBA OLIVIER,APACHE DIVINE,44.67250000000001
CUBA OLIVIER,ROSES TREASURE,34.34400000000001
CUBA OLIVIER,WONDERLAND CHRISTMAS,29.756
DAN HARRIS,TITANS JERK,28.815714285714296
DAN HARRIS,GHOST GROUNDHOG,23.95799999999999
DAN HARRIS,STEERS ARMAGEDDON,21.4625
DAN STREEP,JEKYLL FROGMEN,28.94333333333333
DAN STREEP,HEAVYWEIGHTS BEAST,25.95399999999999
DAN STREEP,BACKLASH UNDEFEATED,22.687142857142856
DAN TORN,INNOCENT USUAL,63.913333333333355
DAN TORN,TUXEDO MILE,25.62333333333333
DAN TORN,ATTACKS HATE,25.459999999999997
DARYL CRAWFORD,SLEEPLESS MONSOON,30.44999999999999
DARYL CRAWFORD,ISLAND EXORCIST,28.58
DARYL CRAWFORD,STRICTLY SCARFACE,28.442499999999992
DARYL WAHLBERG,EXPECATIONS NATURAL,36.93999999999999
DARYL WAHLBERG,POND SEATTLE,21.603333333333342
DARYL WAHLBERG,MAIDEN HOME,20.470000000000002
DEBBIE AKROYD,GALAXY SWEETHEARTS,38.60666666666666
DEBBIE AKROYD,FLINTSTONES HAPPINESS,33.707499999999996
DEBBIE AKROYD,STEPMOM DREAM,26.199999999999996
DUSTIN TAUTOU,VIRTUAL SPOILERS,39.286666666666655
DUSTIN TAUTOU,CONVERSATION DOWNHILL,38.27666666666666
DUSTIN TAUTOU,AUTUMN CROW,28.296666666666667
ED CHASE,WHALE BIKINI,26.96399999999999
ED CHASE,FORREST SONS,17.564
ED CHASE,FRENCH HOLIDAY,14.689999999999998
ED GUINESS,CENTER DINOSAUR,34.43999999999999
ED GUINESS,CLOSER BANG,28.786666666666672
ED GUINESS,PRINCESS GIANT,28.547999999999995
ED MANSFIELD,EASY GLADIATOR,50.25666666666666
ED MANSFIELD,SOMETHING DUCK,42.603333333333325
ED MANSFIELD,FALCON VOLUME,31.942499999999992
ELLEN PRESLEY,NETWORK PEAK,44.563333333333325
ELLEN PRESLEY,BILKO ANONYMOUS,34.29
ELLEN PRESLEY,TURN STAR,23.620000000000005
ELVIS MARX,EXPECATIONS NATURAL,36.93999999999999
ELVIS MARX,GANGS PRIDE,28.182499999999994
ELVIS MARX,SEATTLE EXPECATIONS,27.291666666666668
EMILY DEE,HOLLOW JEOPARDY,24.950000000000006
EMILY DEE,SCARFACE BANG,17.259999999999994
EMILY DEE,SHREK LICENSE,15.616666666666672
EWAN GOODING,ENEMY ODDS,45.17750000000001
EWAN GOODING,GRADUATE LORD,26.420000000000012
EWAN GOODING,QUEEN LUKE,22.796666666666663
FAY KILMER,SECRET GROUNDHOG,38.929999999999986
FAY KILMER,HARRY IDAHO,32.61666666666668
FAY KILMER,BIRD INDEPENDENCE,31.945000000000007
FAY WINSLET,MASSACRE USUAL,59.90000000000001
FAY WINSLET,DRAGONFLY STRANGERS,34.60666666666666
FAY WINSLET,CENTER DINOSAUR,34.43999999999999
FAY WOOD,DORADO NOTTING,44.182500000000005
FAY WOOD,GANGS PRIDE,28.182499999999994
FAY WOOD,SEATTLE EXPECATIONS,27.291666666666668
FRANCES DAY-LEWIS,UNDEFEATED DALMATIONS,38.26333333333332
FRANCES DAY-LEWIS,BRINGING HYSTERICAL,35.900000000000006
FRANCES DAY-LEWIS,MARRIED GO,32.89999999999999
FRANCES TOMEI,AMERICAN CIRCUS,33.556
FRANCES TOMEI,GOODFELLAS SALUTE,26.211250000000007
FRANCES TOMEI,ESCAPE METROPOLIS,20.1875
FRED COSTNER,EASY GLADIATOR,50.25666666666666
FRED COSTNER,MIRACLE VIRTUAL,44.91000000000001
FRED COSTNER,EAGLES PANKY,25.463333333333328
GARY PENN,SOUTH WAIT,53.889999999999986
GARY PENN,VIRTUAL SPOILERS,39.286666666666655
GARY PENN,ATTRACTION NEWTON,36.69
GARY PHOENIX,HEAD STRANGER,76.39
GARY PHOENIX,TIMBERLAND SKY,30.922499999999985
GARY PHOENIX,BUCKET BROTHERHOOD,30.11000000000001
GENE HOPKINS,NIGHTMARE CHILL,84.87500000000001
GENE HOPKINS,TORQUE BOUND,39.744000000000014
GENE HOPKINS,PITY BOUND,30.747999999999998
GENE MCKELLEN,MASSACRE USUAL,59.90000000000001
GENE MCKELLEN,PITY BOUND,30.747999999999998
GENE MCKELLEN,BOOGIE AMELIE,27.283333333333335
GENE WILLIS,DORADO NOTTING,44.182500000000005
GENE WILLIS,AIRPORT POLLOCK,25.704999999999995
GENE WILLIS,SECRETS PARADISE,25.46666666666667
GEOFFREY HESTON,KISSING DOLLS,49.26666666666666
GEOFFREY HESTON,COMA HEAD,45.91333333333332
GEOFFREY HESTON,GRIT CLOCKWORK,36.89333333333332
GINA DEGENERES,WIFE TURN,37.28166666666668
GINA DEGENERES,CHARIOTS CONSPIRACY,35.89500000000001
GINA DEGENERES,TELEGRAPH VOYAGE,33.10428571428572
GOLDIE BRODY,BILKO ANONYMOUS,34.29
GOLDIE BRODY,MARRIED GO,32.89999999999999
GOLDIE BRODY,PITY BOUND,30.747999999999998
GRACE MOSTEL,SLEEPLESS MONSOON,30.44999999999999
GRACE MOSTEL,TRACY CIDER,28.58
GRACE MOSTEL,STING PERSONAL,22.827142857142857
GREG CHAPLIN,SAMURAI LION,54.374999999999986
GREG CHAPLIN,FORWARD TEMPLE,42.89333333333332
GREG CHAPLIN,TITANS JERK,28.815714285714296
GREGORY GOODING,OPERATION OPERATION,29.24333333333333
GREGORY GOODING,MOONSHINE CABIN,28.357999999999993
GREGORY GOODING,SEATTLE EXPECATIONS,27.291666666666668
GRETA KEITEL,ARIZONA BANG,26.197499999999994
GRETA KEITEL,SATURDAY LAMBS,22.746666666666673
GRETA KEITEL,ANNIE IDENTITY,19.926666666666673
GRETA MALDEN,CONVERSATION DOWNHILL,38.27666666666666
GRETA MALDEN,WIFE TURN,37.28166666666668
GRETA MALD
Current sql:
WITH film_revenue AS (
    SELECT i."film_id", SUM(p."amount") AS "total_revenue"
    FROM "payment" p
    JOIN "rental" r ON p."rental_id" = r."rental_id"
    JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
    GROUP BY i."film_id"
),
film_actor_count AS (
    SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
    FROM "film_actor"
    GROUP BY "film_id"
),
film_avg_revenue AS (
    SELECT fr."film_id", fr."total_revenue", fac."actor_count",
           (fr."total_revenue" / fac."actor_count") AS "avg_revenue_per_actor"
    FROM film_revenue fr
    JOIN film_actor_count fac ON fr."film_id" = fac."film_id"
),
actor_films AS (
    SELECT a."actor_id", a."first_name" || ' ' || a."last_name" AS "actor_name",
           f."film_id", f."title" AS "film_title"
    FROM "actor" a
    JOIN "film_actor" fa ON a."actor_id" = fa."actor_id"
    JOIN "film" f ON fa."film_id" = f."film_id"
)
SELECT "actor_name", "film_title", "avg_revenue_per_actor"
FROM (
    SELECT af."actor_name", af."film_title", far."avg_revenue_per_actor",
           ROW_NUMBER() OVER (
               PARTITION BY af."actor_name"
               ORDER BY far."avg_revenue_per_actor" DESC
           ) AS "rank"
    FROM actor_films af
    JOIN film_avg_revenue far ON af."film_id" = far."film_id"
)
WHERE "rank" <= 3
ORDER BY "actor_name", "avg_revenue_per_actor" DESC;
2025-01-25 06:16:42 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 06:16:42 - root - INFO - ```sql
WITH film_revenue AS (
    SELECT i."film_id", SUM(p."amount") AS "total_revenue"
    FROM "payment" p
    JOIN "rental" r ON p."rental_id" = r."rental_id"
    JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
    GROUP BY i."film_id"
),
film_actor_count AS (
    SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
    FROM "film_actor"
    GROUP BY "film_id"
),
film_avg_revenue AS (
    SELECT fr."film_id", fr."total_revenue", fac."actor_count",
           (fr."total_revenue" / fac."actor_count") AS "average_revenue_per_actor"
    FROM film_revenue fr
    JOIN film_actor_count fac ON fr."film_id" = fac."film_id"
),
actor_films AS (
    SELECT a."actor_id", a."first_name" || ' ' || a."last_name" AS "actor_name",
           f."film_id", f."title" AS "film_title"
    FROM "actor" a
    JOIN "film_actor" fa ON a."actor_id" = fa."actor_id"
    JOIN "film" f ON fa."film_id" = f."film_id"
)
SELECT "actor_name", "film_title", ROUND("average_revenue_per_actor", 4) AS "average_revenue_per_actor"
FROM (
    SELECT af."actor_name", af."film_title", far."average_revenue_per_actor",
           ROW_NUMBER() OVER (
               PARTITION BY af."actor_name"
               ORDER BY far."average_revenue_per_actor" DESC
           ) AS "rank"
    FROM actor_films af
    JOIN film_avg_revenue far ON af."film_id" = far."film_id"
)
WHERE "rank" <= 3
ORDER BY "actor_name", "average_revenue_per_actor" DESC;
```
2025-01-25 06:16:42 - root - INFO - itercount: 2
2025-01-25 06:16:42 - root - INFO - 0
2025-01-25 06:16:42 - root - INFO - results: 
actor_name,film_title,average_revenue_per_actor
ADAM GRANT,SEABISCUIT PUNK,31.9133
ADAM GRANT,OPERATION OPERATION,29.2433
ADAM GRANT,TWISTED PIRATES,22.2967
ADAM HOPPER,TORQUE BOUND,39.744
ADAM HOPPER,PRINCESS GIANT,28.548
ADAM HOPPER,BLINDNESS GUN,25.62
AL GARLAND,BREAKFAST GOLDFINGER,21.966
AL GARLAND,DRIFTER COMMANDMENTS,20.2514
AL GARLAND,SILVERADO GOLDFINGER,18.376
ALAN DREYFUSS,FIDELITY DEVIL,34.6975
ALAN DREYFUSS,STRICTLY SCARFACE,28.4425
ALAN DREYFUSS,BARBARELLA STREETCAR,19.35
ALBERT JOHANSSON,UNDEFEATED DALMATIONS,38.2633
ALBERT JOHANSSON,LEBOWSKI SOLDIERS,24.2633
ALBERT JOHANSSON,REDEMPTION COMFORTS,22.76
ALBERT NOLTE,CAMELOT VACATION,50.865
ALBERT NOLTE,FLINTSTONES HAPPINESS,33.7075
ALBERT NOLTE,MANCHURIAN CURTAIN,32.425
ALEC WAYNE,HUSTLER PARTY,47.695
ALEC WAYNE,REIGN GENTLEMEN,36.9333
ALEC WAYNE,CENTER DINOSAUR,34.44
ANGELA HUDSON,MALTESE HOPE,123.78
ANGELA HUDSON,PITY BOUND,30.748
ANGELA HUDSON,ISLAND EXORCIST,28.58
ANGELA WITHERSPOON,CAT CONEHEADS,45.425
ANGELA WITHERSPOON,SECRET GROUNDHOG,38.93
ANGELA WITHERSPOON,BRINGING HYSTERICAL,35.9
ANGELINA ASTAIRE,SAMURAI LION,54.375
ANGELINA ASTAIRE,HUSTLER PARTY,47.695
ANGELINA ASTAIRE,INTENTIONS EMPIRE,39.415
ANNE CRONYN,APACHE DIVINE,44.6725
ANNE CRONYN,MOON BUNCH,38.71
ANNE CRONYN,MINDS TRUMAN,24.9667
AUDREY BAILEY,QUILLS BULL,25.21
AUDREY BAILEY,DISTURBING SCARFACE,22.435
AUDREY BAILEY,DRIFTER COMMANDMENTS,20.2514
AUDREY OLIVIER,DORADO NOTTING,44.1825
AUDREY OLIVIER,WHALE BIKINI,26.964
AUDREY OLIVIER,STING PERSONAL,22.8271
BELA WALKEN,MIDSUMMER GROUNDHOG,78.39
BELA WALKEN,WHISPERER GIANT,50.5933
BELA WALKEN,ENEMY ODDS,45.1775
BEN HARRIS,MUSKETEERS WAIT,92.83
BEN HARRIS,TOURIST PELICAN,47.26
BEN HARRIS,BEAR GRACELAND,35.9267
BEN WILLIS,GOODFELLAS SALUTE,26.2113
BEN WILLIS,HEAVYWEIGHTS BEAST,25.954
BEN WILLIS,CHANCE RESURRECTION,23.6217
BETTE NICHOLSON,BIKINI BORROWERS,49.415
BETTE NICHOLSON,TRADING PINOCCHIO,49.25
BETTE NICHOLSON,COLDBLOODED DARLING,22.46
BOB FAWCETT,PELICAN COMFORTS,37.748
BOB FAWCETT,CIRCUS YOUTH,30.425
BOB FAWCETT,RAGING AIRPLANE,28.29
BURT DUKAKIS,RANGE MOONWALKER,44.9325
BURT DUKAKIS,BLINDNESS GUN,25.62
BURT DUKAKIS,TRUMAN CRAZY,20.295
BURT POSEY,MINDS TRUMAN,24.9667
BURT POSEY,DESERT POSEIDON,23.762
BURT POSEY,SATURDAY LAMBS,22.7467
BURT TEMPLE,ROSES TREASURE,34.344
BURT TEMPLE,BUCKET BROTHERHOOD,30.11
BURT TEMPLE,HEAVYWEIGHTS BEAST,25.954
CAMERON STREEP,PURE RUNNER,46.42
CAMERON STREEP,BLUES INSTINCT,21.1975
CAMERON STREEP,MOVIE SHAKESPEARE,18.2175
CAMERON WRAY,COMA HEAD,45.9133
CAMERON WRAY,TITANS JERK,28.8157
CAMERON WRAY,BINGO TALENTED,26.342
CAMERON ZELLWEGER,WIFE TURN,37.2817
CAMERON ZELLWEGER,GRIT CLOCKWORK,36.8933
CAMERON ZELLWEGER,HARRY IDAHO,32.6167
CARMEN HUNT,TELEGRAPH VOYAGE,33.1043
CARMEN HUNT,MOONSHINE CABIN,28.358
CARMEN HUNT,TEEN APOLLO,25.566
CARY MCCONAUGHEY,DOLLS RAGE,30.91
CARY MCCONAUGHEY,BINGO TALENTED,26.342
CARY MCCONAUGHEY,RULES HUMAN,20.368
CATE HARRIS,SCARFACE BANG,17.26
CATE HARRIS,ROLLERCOASTER BRINGING,15.3
CATE HARRIS,GREEK EVERYONE,13.9575
CATE MCQUEEN,NAME DETECTIVE,45.59
CATE MCQUEEN,SNATCH SLIPPER,42.5933
CATE MCQUEEN,SALUTE APOLLO,26.6925
CHARLIZE DENCH,BUCKET BROTHERHOOD,30.11
CHARLIZE DENCH,JOON NORTHWEST,19.915
CHARLIZE DENCH,CANDLES GRAPES,18.3957
CHRIS BRIDGES,CONVERSATION DOWNHILL,38.2767
CHRIS BRIDGES,SATURN NAME,35.435
CHRIS BRIDGES,WONDERLAND CHRISTMAS,29.756
CHRIS DEPP,SCALAWAG DUCK,34.536
CHRIS DEPP,SABRINA MIDNIGHT,31.6975
CHRIS DEPP,EAGLES PANKY,25.4633
CHRISTIAN AKROYD,INNOCENT USUAL,63.9133
CHRISTIAN AKROYD,SABRINA MIDNIGHT,31.6975
CHRISTIAN AKROYD,OPERATION OPERATION,29.2433
CHRISTIAN GABLE,DRAGONFLY STRANGERS,34.6067
CHRISTIAN GABLE,GOLDFINGER SENSIBILITY,20.44
CHRISTIAN GABLE,WATERFRONT DELIVERANCE,20.305
CHRISTIAN NEESON,SCALAWAG DUCK,34.536
CHRISTIAN NEESON,LIAISONS SWEET,21.9633
CHRISTIAN NEESON,FELLOWSHIP AUTUMN,21.3914
CHRISTOPHER BERRY,VIDEOTAPE ARSENIC,35.742
CHRISTOPHER BERRY,BACKLASH UNDEFEATED,22.6871
CHRISTOPHER BERRY,SUGAR WONKA,21.166
CHRISTOPHER WEST,HUSTLER PARTY,47.695
CHRISTOPHER WEST,ATTRACTION NEWTON,36.69
CHRISTOPHER WEST,TIMBERLAND SKY,30.9225
CUBA ALLEN,CINCINATTI WHISPERER,21.9675
CUBA ALLEN,METROPOLIS COMA,21.9567
CUBA ALLEN,ROBBERS JOON,21.138
CUBA BIRCH,EDGE KISSING,30.95
CUBA BIRCH,LOST BIRD,21.6267
CUBA BIRCH,GREATEST NORTH,18.285
CUBA OLIVIER,APACHE DIVINE,44.6725
CUBA OLIVIER,ROSES TREASURE,34.344
CUBA OLIVIER,WONDERLAND CHRISTMAS,29.756
DAN HARRIS,TITANS JERK,28.8157
DAN HARRIS,GHOST GROUNDHOG,23.958
DAN HARRIS,STEERS ARMAGEDDON,21.4625
DAN STREEP,JEKYLL FROGMEN,28.9433
DAN STREEP,HEAVYWEIGHTS BEAST,25.954
DAN STREEP,BACKLASH UNDEFEATED,22.6871
DAN TORN,INNOCENT USUAL,63.9133
DAN TORN,TUXEDO MILE,25.6233
DAN TORN,ATTACKS HATE,25.46
DARYL CRAWFORD,SLEEPLESS MONSOON,30.45
DARYL CRAWFORD,ISLAND EXORCIST,28.58
DARYL CRAWFORD,STRICTLY SCARFACE,28.4425
DARYL WAHLBERG,EXPECATIONS NATURAL,36.94
DARYL WAHLBERG,POND SEATTLE,21.6033
DARYL WAHLBERG,MAIDEN HOME,20.47
DEBBIE AKROYD,GALAXY SWEETHEARTS,38.6067
DEBBIE AKROYD,FLINTSTONES HAPPINESS,33.7075
DEBBIE AKROYD,STEPMOM DREAM,26.2
DUSTIN TAUTOU,VIRTUAL SPOILERS,39.2867
DUSTIN TAUTOU,CONVERSATION DOWNHILL,38.2767
DUSTIN TAUTOU,AUTUMN CROW,28.2967
ED CHASE,WHALE BIKINI,26.964
ED CHASE,FORREST SONS,17.564
ED CHASE,FRENCH HOLIDAY,14.69
ED GUINESS,CENTER DINOSAUR,34.44
ED GUINESS,CLOSER BANG,28.7867
ED GUINESS,PRINCESS GIANT,28.548
ED MANSFIELD,EASY GLADIATOR,50.2567
ED MANSFIELD,SOMETHING DUCK,42.6033
ED MANSFIELD,FALCON VOLUME,31.9425
ELLEN PRESLEY,NETWORK PEAK,44.5633
ELLEN PRESLEY,BILKO ANONYMOUS,34.29
ELLEN PRESLEY,TURN STAR,23.62
ELVIS MARX,EXPECATIONS NATURAL,36.94
ELVIS MARX,GANGS PRIDE,28.1825
ELVIS MARX,SEATTLE EXPECATIONS,27.2917
EMILY DEE,HOLLOW JEOPARDY,24.95
EMILY DEE,SCARFACE BANG,17.26
EMILY DEE,SHREK LICENSE,15.6167
EWAN GOODING,ENEMY ODDS,45.1775
EWAN GOODING,GRADUATE LORD,26.42
EWAN GOODING,QUEEN LUKE,22.7967
FAY KILMER,SECRET GROUNDHOG,38.93
FAY KILMER,HARRY IDAHO,32.6167
FAY KILMER,BIRD INDEPENDENCE,31.945
FAY WINSLET,MASSACRE USUAL,59.9
FAY WINSLET,DRAGONFLY STRANGERS,34.6067
FAY WINSLET,CENTER DINOSAUR,34.44
FAY WOOD,DORADO NOTTING,44.1825
FAY WOOD,GANGS PRIDE,28.1825
FAY WOOD,SEATTLE EXPECATIONS,27.2917
FRANCES DAY-LEWIS,UNDEFEATED DALMATIONS,38.2633
FRANCES DAY-LEWIS,BRINGING HYSTERICAL,35.9
FRANCES DAY-LEWIS,MARRIED GO,32.9
FRANCES TOMEI,AMERICAN CIRCUS,33.556
FRANCES TOMEI,GOODFELLAS SALUTE,26.2113
FRANCES TOMEI,ESCAPE METROPOLIS,20.1875
FRED COSTNER,EASY GLADIATOR,50.2567
FRED COSTNER,MIRACLE VIRTUAL,44.91
FRED COSTNER,EAGLES PANKY,25.4633
GARY PENN,SOUTH WAIT,53.89
GARY PENN,VIRTUAL SPOILERS,39.2867
GARY PENN,ATTRACTION NEWTON,36.69
GARY PHOENIX,HEAD STRANGER,76.39
GARY PHOENIX,TIMBERLAND SKY,30.9225
GARY PHOENIX,BUCKET BROTHERHOOD,30.11
GENE HOPKINS,NIGHTMARE CHILL,84.875
GENE HOPKINS,TORQUE BOUND,39.744
GENE HOPKINS,PITY BOUND,30.748
GENE MCKELLEN,MASSACRE USUAL,59.9
GENE MCKELLEN,PITY BOUND,30.748
GENE MCKELLEN,BOOGIE AMELIE,27.2833
GENE WILLIS,DORADO NOTTING,44.1825
GENE WILLIS,AIRPORT POLLOCK,25.705
GENE WILLIS,SECRETS PARADISE,25.4667
GEOFFREY HESTON,KISSING DOLLS,49.2667
GEOFFREY HESTON,COMA HEAD,45.9133
GEOFFREY HESTON,GRIT CLOCKWORK,36.8933
GINA DEGENERES,WIFE TURN,37.2817
GINA DEGENERES,CHARIOTS CONSPIRACY,35.895
GINA DEGENERES,TELEGRAPH VOYAGE,33.1043
GOLDIE BRODY,BILKO ANONYMOUS,34.29
GOLDIE BRODY,MARRIED GO,32.9
GOLDIE BRODY,PITY BOUND,30.748
GRACE MOSTEL,SLEEPLESS MONSOON,30.45
GRACE MOSTEL,TRACY CIDER,28.58
GRACE MOSTEL,STING PERSONAL,22.8271
GREG CHAPLIN,SAMURAI LION,54.375
GREG CHAPLIN,FORWARD TEMPLE,42.8933
GREG CHAPLIN,TITANS JERK,28.8157
GREGORY GOODING,OPERATION OPERATION,29.2433
GREGORY GOODING,MOONSHINE CABIN,28.358
GREGORY GOODING,SEATTLE EXPECATIONS,27.2917
GRETA KEITEL,ARIZONA BANG,26.1975
GRETA KEITEL,SATURDAY LAMBS,22.7467
GRETA KEITEL,ANNIE IDENTITY,19.9267
GRETA MALDEN,CONVERSATION DOWNHILL,38.2767
GRETA MALDEN,WIFE TURN,37.2817
GRETA MALDEN,CLOSER BANG,28.7867
GROUCHO DUNST,HUNCHBACK IMPOSSIBLE,67.4
GROUCHO DUNST,GOLD RIVER,47.43
GROUCHO DUNST,MARRIED GO,32.9
GROUCHO SINATRA,DYING MAKER,46.915
GROUCHO SINATRA,PELICAN COMFORTS,37.748
GROUCHO SINATRA,SCALAWAG DUCK,34.536
GROUCHO WILLIAMS,JINGLE SAGEBRUSH,35.435
GROUCHO WILLIAMS,FANTASIA PARK,24.6033
GROUCHO WILLIAMS,BROOKLYN DESERT,23.358
HARRISON BALE,WONDERLAND CHRISTMAS,29.756
HARRISON BALE,FANTASIA PARK,24.6033
HARRISON BALE,STING PERSONAL,22.8271
HARVEY HOPE,LOCK REAR,25.42
HARVEY HOPE,DOWNHILL ENOUGH,21.1875
HARVEY HOPE,RULES HUMAN,20.368
HELEN VOIGHT,CAT CONEHEADS,45.425
HELEN VOIGHT,FIDELITY DEVIL,34.6975
HELEN VOIGHT,LIES TREATMENT,21.1043
HENRY BERRY,APACHE DIVINE,44.6725
HENRY BERRY,FREDDY STORM,42.2567
HENRY BERRY,CHICKEN HELLFIGHTERS,34.39
HUMPHREY GARLAND,MINE TITANS,76.905
HUMPHREY GARLAND,ROSES TREASURE,34.344
HUMPHREY GARLAND,WONDERLAND CHRISTMAS,29.756
HUMPHREY WILLIS,PIRATES ROXANNE,51.78
HUMPHREY WILLIS,FLINTSTONES HAPPINESS,33.7075
HUMPHREY WILLIS,PRINCESS GIANT,28.548
IAN TANDY,ZORRO ARK,71.5633
IAN TANDY,VIDEOTAPE ARSENIC,35.742
IAN TANDY,DEER VIRGINIAN,32.24
JADA RYDER,MIDSUMMER GROUNDHOG,78.39
JADA RYDER,KISSING DOLLS,49.2667
JADA RYDER,GARDEN ISLAND,48.2667
JAMES PITT,INNOCENT USUAL,63.9133
JAMES PITT,STEEL SANTA,47.2567
JAMES PITT,WILLOW TRACY,29.42
JANE JACKMAN,BACKLASH UNDEFEATED,22.6871
JANE JACKMAN,HOPE TOOTSIE,18.955
JANE JACKMAN,SILVERADO GOLDFINGER,18.376
JAYNE NEESON,EDGE KISSING,30.95
JAYNE NEESON,INTERVIEW LIAISONS,25.76
JAYNE NEESON,DARLING BREAKING,24.955
JAYNE NOLTE,BIRD INDEPENDENCE,31.945
JAYNE NOLTE,STRANGERS GRAFFITI,24.766
JAYNE NOLTE,ENGLISH BULWORTH,20.74
JAYNE SILVERSTONE,HARRY IDAHO,32.6167
JAYNE SILVERSTONE,QUEEN LUKE,22.7967
JAYNE SILVERSTONE,CAUSE DATE,21.465
JEFF SILVERSTONE,SPARTACUS CHEAPER,20.3033
JEFF SILVERSTONE,PARADISE SABRINA,19.955
JEFF SILVERSTONE,MUSCLE BRIGHT,19.14
JENNIFER DAVIS,SILVERADO GOLDFINGER,18.376
JENNIFER DAVIS,POSEIDON FOREVER,16.805
JENNIFER DAVIS,HANOVER GALAXY,14.1186
JESSICA BAILEY,HEAD STRANGER,76.39
JESSICA BAILEY,WHISPERER GIANT,50.5933
JESSICA BAILEY,DORADO NOTTING,44.1825
JIM MOSTEL,METROPOLIS COMA,21.9567
JIM MOSTEL,LEAGUE HELLFIGHTERS,17.6383
JIM MOSTEL,AIRPLANE SIERRA,16.57
JODIE DEGENERES,BEVERLY OUTLAW,28.9475
JODIE DEGENERES,CLOSER BANG,28.7867
JODIE DEGENERES,MOONSHINE CABIN,28.358
JOE SWANK,SUNRISE LEAGUE,34.152
JOE SWANK,LEBOWSKI SOLDIERS,24.2633
JOE SWANK,LAWLESS VISION,21.71
JOHN SUVARI,NAME DETECTIVE,45.59
JOHN SUVARI,BEVERLY OUTLAW,28.9475
JOHN SUVARI,RAGING AIRPLANE,28.29
JOHNNY CAGE,REIGN GENTLEMEN,36.9333
JOHNNY CAGE,LIES TREATMENT,21.1043
JOHNNY CAGE,VELVET TERMINATOR,19.7489
JOHNNY LOLLOBRIGIDA,SUNRISE LEAGUE,34.152
JOHNNY LOLLOBRIGIDA,GOODFELLAS SALUTE,26.2113
JOHNNY LOLLOBRIGIDA,RIDGEMONT SUBMARINE,26.136
JON CHASE,VIRTUAL SPOILERS,39.2867
JON CHASE,BINGO TALENTED,26.342
JON CHASE,SUGAR WONKA,21.166
JUDE CRUISE,CAMELOT VACATION,50.865
JUDE CRUISE,SCALAWAG DUCK,34.536
JUDE CRUISE,TIMBERLAND SKY,30.9225
JUDY DEAN,GUNFIGHTER MUSSOLINI,17.22
JUDY DEAN,ROCKETEER MOTHER,16.6671
JUDY DEAN,ALADDIN CALENDAR,16.4713
JULIA BARRYMORE,PELICAN COMFORTS,37.748
JULIA BARRYMORE,WIFE TURN,37.2817
JULIA BARRYMORE,SECRETARY ROUGE,18.8033
JULIA FAWCETT,CLOSER BANG,28.7867
JULIA FAWCETT,RIDGEMONT SUBMARINE,26.136
JULIA FAWCETT,DAY UNFAITHFUL,21.972
JULIA MCQUEEN,FREDDY STORM,42.2567
JULIA MCQUEEN,WONKA SEA,33.41
JULIA MCQUEEN,SLEEPLESS MONSOON,30.45
JULIA ZELLWEGER,MINDS TRUMAN,24.9667
JULIA ZELLWEGER,HOLLOW JEOPARDY,24.95
JULIA ZELLWEGER,DETECTIVE VISION,22.91
JULIANNE DENCH,RIDGEMONT SUBMARINE,26.136
JULIANNE DENCH,DISTURBING SCARFACE,22.435
JULIANNE DENCH,CINCINATTI WHISPERER,21.9675
KARL BERRY,ARIZONA BANG,26.1975
KARL BERRY,STAGECOACH ARMAGEDDON,25.79
KARL BERRY,BOUND CHEAPER,25.38
KENNETH HOFFMAN,TORQUE BOUND,39.744
KENNETH HOFFMAN,BRANNIGAN SUNRISE,37.44
KENNETH HOFFMAN,GANGS PRIDE,28.1825
KENNETH PALTROW,SHOW LORD,85.375
KENNETH PALTROW,FALCON VOLUME,31.9425
KENNETH PALTROW,REDEMPTION COMFORTS,22.76
KENNETH PESCI,DISTURBING SCARFACE,22.435
KENNETH PESCI,FARGO GANDHI,22.352
KENNETH PESCI,PEAK FOREVER,21.16
KENNETH TORN,WORKING MICROCOSMOS,32.75
KENNETH TORN,SEATTLE EXPECATIONS,27.2917
KENNETH TORN,GHOST GROUNDHOG,23.958
KEVIN BLOOM,AMERICAN CIRCUS,33.556
KEVIN BLOOM,SABRINA MIDNIGHT,31.6975
KEVIN BLOOM,BOOGIE AMELIE,27.2833
KEVIN GARLAND,SHOW LORD,85.375
KEVIN GARLAND,GRIT CLOCKWORK,36.8933
KEVIN GARLAND,TRIP NEWTON,36.43
KIM ALLEN,JINGLE SAGEBRUSH,35.435
KIM ALLEN,TITANS JERK,28.8157
KIM ALLEN,LOLA AGENT,26.6267
KIRK JOVOVICH,FORRESTER COMANCHEROS,48.91
KIRK JOVOVICH,NETWORK PEAK,44.5633
KIRK JOVOVICH,TUXEDO MILE,25.6233
KIRSTEN AKROYD,BUCKET BROTHERHOOD,30.11
KIRSTEN AKROYD,HURRICANE AFFAIR,28.5867
KIRSTEN AKROYD,BUGSY SONG,27.945
KIRSTEN PALTROW,CHICKEN HELLFIGHTERS,34.39
KIRSTEN PALTROW,SLEEPING SUSPECTS,32.94
KIRSTEN PALTROW,TITANS JERK,28.8157
LAURA BRODY,SHOCK CABIN,99.7
LAURA BRODY,CAT CONEHEADS,45.425
LAURA BRODY,SOMETHING DUCK,42.6033
LAURENCE BULLOCK,FISH OPUS,54.375
LAURENCE BULLOCK,EXPECATIONS NATURAL,36.94
LAURENCE BULLOCK,STREETCAR INTENTIONS,21.25
LISA MONROE,ZORRO ARK,71.5633
LISA MONROE,HANKY OCTOBER,38.9133
LISA MONROE,QUILLS BULL,25.21
LIZA BERGMAN,ENEMY ODDS,45.1775
LIZA BERGMAN,PAYCHECK WAIT,33.9467
LIZA BERGMAN,DEER VIRGINIAN,32.24
LUCILLE DEE,TELEGRAPH VOYAGE,33.1043
LUCILLE DEE,WORKING MICROCOSMOS,32.75
LUCILLE DEE,HARRY IDAHO,32.6167
LUCILLE TRACY,LOLA AGENT,26.6267
LUCILLE TRACY,COLDBLOODED DARLING,22.46
LUCILLE TRACY,EGG IGBY,21.158
MAE HOFFMAN,SECRET GROUNDHOG,38.93
MAE HOFFMAN,EAGLES PANKY,25.4633
MAE HOFFMAN,TURN STAR,23.62
MARY KEITEL,STEEL SANTA,47.2567
MARY KEITEL,INTENTIONS EMPIRE,39.415
MARY KEITEL,ROSES TREASURE,34.344
MARY TANDY,PHILADELPHIA WIFE,59.39
MARY TANDY,GARDEN ISLAND,48.2667
MARY TANDY,FALCON VOLUME,31.9425
MATTHEW CARREY,TRIP NEWTON,36.43
MATTHEW CARREY,HARRY IDAHO,32.6167
MATTHEW CARREY,CIRCUS YOUTH,30.425
MATTHEW JOHANSSON,CAMPUS REMEMBER,30.27
MATTHEW JOHANSSON,SUGAR WONKA,21.166
MATTHEW JOHANSSON,SCORPION APOLLO,21.0963
MATTHEW LEIGH,GIANT TROOPERS,106.72
MATTHEW LEIGH,EASY GLADIATOR,50.2567
MATTHEW LEIGH,DAWN POND,21.47
MEG HAWKE,SABRINA MIDNIGHT,31.6975
MEG HAWKE,LIAISONS SWEET,21.9633
MEG HAWKE,VACATION BOONDOCK,16.1317
MENA HOPPER,CORE SUIT,25.955
MENA HOPPER,SATURDAY LAMBS,22.7467
MENA HOPPER,CHASING FIGHT,22.162
MENA TEMPLE,INTERVIEW LIAISONS,25.76
MENA TEMPLE,WASH HEAVENLY,23.954
MENA TEMPLE,LIAISONS SWEET,21.9633
MERYL ALLEN,BOOGIE AMELIE,27.2833
MERYL ALLEN,CHANCE RESURRECTION,23.6217
MERYL ALLEN,BRIGHT ENCOUNTERS,23.2175
MERYL GIBSON,PRINCESS GIANT,28.548
MERYL GIBSON,HUNGER ROOF,22.87
MERYL GIBSON,EGG IGBY,21.158
MICHAEL BENING,TELEGRAPH VOYAGE,33.1043
MICHAEL BENING,BEAUTY GREASE,26.556
MICHAEL BENING,IGBY MAKER,19.962
MICHAEL BOLGER,DYING MAKER,46.915
MICHAEL BOLGER,SOMETHING DUCK,42.6033
MICHAEL BOLGER,WIFE TURN,37.2817
MICHELLE MCCONAUGHEY,BAKED CLEOPATRA,79.84
MICHELLE MCCONAUGHEY,DETAILS PACKER,66.905
MICHELLE MCCONAUGHEY,SOUTH WAIT,53.89
MILLA KEITEL,TRADING PINOCCHIO,49.25
MILLA KEITEL,PURE RUNNER,46.42
MILLA KEITEL,ANTHEM LUKE,42.925
MILLA PECK,WHISPERER GIANT,50.5933
MILLA PECK,SEATTLE EXPECATIONS,27.2917
MILLA PECK,TEEN APOLLO,25.566
MINNIE KILMER,HUSTLER PARTY,47.695
MINNIE KILMER,JASON TRAP,20.152
MINNIE KILMER,VELVET TERMINATOR,19.7489
MINNIE ZELLWEGER,RAGING AIRPLANE,28.29
MINNIE ZELLWEGER,DAY UNFAITHFUL,21.972
MINNIE ZELLWEGER,PICKUP DRIVING,19.768
MORGAN HOPKINS,REIGN GENTLEMEN,36.9333
MORGAN HOPKINS,HARRY IDAHO,32.6167
MORGAN HOPKINS,STAGECOACH ARMAGEDDON,25.79
MORGAN MCDORMAND,SUIT WALLS,29.558
MORGAN MCDORMAND,WASH HEAVENLY,23.954
MORGAN MCDORMAND,BETRAYED REAR,22.9625
MORGAN WILLIAMS,ROSES TREASURE,34.344
MORGAN WILLIAMS,TUXEDO MILE,25.6233
MORGAN WILLIAMS,FARGO GANDHI,22.352
NATALIE HOPKINS,FOOL MOCKINGBIRD,87.885
NATALIE HOPKINS,NETWORK PEAK,44.5633
NATALIE HOPKINS,TORQUE BOUND,39.744
NICK DEGENERES,MINE TITANS,76.905
NICK DEGENERES,ZORRO ARK,71.5633
NICK DEGENERES,SUPER WYOMING,28.9567
NICK STALLONE,TRADING PINOCCHIO,49.25
NICK STALLONE,TEEN APOLLO,25.566
NICK STALLONE,STRANGERS GRAFFITI,24.766
NICK WAHLBERG,APACHE DIVINE,44.6725
NICK WAHLBERG,JEKYLL FROGMEN,28.9433
NICK WAHLBERG,GOODFELLAS SALUTE,26.2113
OLYMPIA PFEIFFER,TOURIST PELICAN,47.26
OLYMPIA PFEIFFER,HANKY OCTOBER,38.9133
OLYMPIA PFEIFFER,OTHERS SOUP,19.9425
OPRAH KILMER,ANTHEM LUKE,42.925
OPRAH KILMER,HEARTBREAKERS BRIGHT,26.56
OPRAH KILMER,STEERS ARMAGEDDON,21.4625
PARKER GOLDBERG,CONFIDENTIAL INTERVIEW,82.355
PARKER GOLDBERG,FISH OPUS,54.375
PARKER GOLDBERG,INCH JET,19.164
PENELOPE CRONYN,BIKINI BORROWERS,49.415
PENELOPE CRONYN,ROCKY WAR,35.9467
PENELOPE CRONYN,BEAR GRACELAND,35.9267
PENELOPE GUINESS,RULES HUMAN,20.368
PENELOPE GUINESS,HUMAN GRAFFITI,20.2125
PENELOPE GUINESS,CHEAPER CLYDE,18.4
PENELOPE MONROE,TOURIST PELICAN,47.26
PENELOPE MONROE,RANGE MOONWALKER,44.9325
PENELOPE MONROE,TRIP NEWTON,36.43
PENELOPE PINKETT,SUIT WALLS,29.558
PENELOPE PINKETT,CORE SUIT,25.955
PENELOPE PINKETT,SATURDAY LAMBS,22.7467
RALPH CRUZ,WITCHES PANIC,43.425
RALPH CRUZ,THIN SAGEBRUSH,36.945
RALPH CRUZ,VIDEOTAPE ARSENIC,35.742
RAY JOHANSSON,MANCHURIAN CURTAIN,32.425
RAY JOHANSSON,ISLAND EXORCIST,28.58
RAY JOHANSSON,ARIZONA BANG,26.1975
REESE KILMER,FORRESTER COMANCHEROS,48.91
REESE KILMER,SCALAWAG DUCK,34.536
REESE KILMER,CAMPUS REMEMBER,30.27
REESE WEST,YENTL IDAHO,135.77
REESE WEST,WITCHES PANIC,43.425
REESE WEST,GOODFELLAS SALUTE,26.2113
RENEE BALL,CAT CONEHEADS,45.425
RENEE BALL,BINGO TALENTED,26.342
RENEE BALL,GHOST GROUNDHOG,23.958
RENEE TRACY,COMA HEAD,45.9133
RENEE TRACY,ROCKY WAR,35.9467
RENEE TRACY,MILLION ACE,26.16
RICHARD PENN,HANKY OCTOBER,38.9133
RICHARD PENN,LEBOWSKI SOLDIERS,24.2633
RICHARD PENN,DARKO DORADO,20.7225
RIP CRAWFORD,FOOL MOCKINGBIRD,87.885
RIP CRAWFORD,RANGE MOONWALKER,44.9325
RIP CRAWFORD,BRANNIGAN SUNRISE,37.44
RIP WINSLET,FORWARD TEMPLE,42.8933
RIP WINSLET,ATTRACTION NEWTON,36.69
RIP WINSLET,WHALE BIKINI,26.964
RITA REYNOLDS,SNATCH SLIPPER,42.5933
RITA REYNOLDS,IMPOSSIBLE PREJUDICE,24.9533
RITA REYNOLDS,BEHAVIOR RUNAWAY,20.174
RIVER DEAN,TEEN APOLLO,25.566
RIVER DEAN,DOGMA FAMILY,25.5286
RIVER DEAN,QUEEN LUKE,22.7967
ROCK DUKAKIS,WORKING MICROCOSMOS,32.75
ROCK DUKAKIS,SEABISCUIT PUNK,31.9133
ROCK DUKAKIS,HEAVYWEIGHTS BEAST,25.954
RUSSELL BACALL,SUNRISE LEAGUE,34.152
RUSSELL BACALL,PAYCHECK WAIT,33.9467
RUSSELL BACALL,HURRICANE AFFAIR,28.5867
RUSSELL CLOSE,RANGE MOONWALKER,44.9325
RUSSELL CLOSE,CALIFORNIA BIRDS,41.94
RUSSELL CLOSE,VIDEOTAPE ARSENIC,35.742
RUSSELL TEMPLE,GOLD RIVER,47.43
RUSSELL TEMPLE,PELICAN COMFORTS,37.748
RUSSELL TEMPLE,CLOSER BANG,28.7867
SALMA NOLTE,DETAILS PACKER,66.905
SALMA NOLTE,FALCON VOLUME,31.9425
SALMA NOLTE,WASH HEAVENLY,23.954
SANDRA KILMER,SLEEPING SUSPECTS,32.94
SANDRA KILMER,CANDIDATE PERDITION,24.2025
SANDRA KILMER,STREETCAR INTENTIONS,21.25
SANDRA PECK,BEVERLY OUTLAW,28.9475
SANDRA PECK,BIRDS PERDITION,27.955
SANDRA PECK,STAGECOACH ARMAGEDDON,25.79
SCARLETT BENING,SNATCH SLIPPER,42.5933
SCARLETT BENING,CALIFORNIA BIRDS,41.94
SCARLETT BENING,SEATTLE EXPECATIONS,27.2917
SCARLETT DAMON,BEAR GRACELAND,35.9267
SCARLETT DAMON,LOLA AGENT,26.6267
SCARLETT DAMON,MILLION ACE,26.16
SEAN GUINESS,PHILADELPHIA WIFE,59.39
SEAN GUINESS,FORRESTER COMANCHEROS,48.91
SEAN GUINESS,TRACY CIDER,28.58
SEAN WILLIAMS,FORWARD TEMPLE,42.8933
SEAN WILLIAMS,SUNRISE LEAGUE,34.152
SEAN WILLIAMS,SEABISCUIT PUNK,31.9133
SIDNEY CROWE,AMERICAN CIRCUS,33.556
SIDNEY CROWE,TITANS JERK,28.8157
SIDNEY CROWE,DOGMA FAMILY,25.5286
SISSY SOBIESKI,FERRIS MOTHER,79.83
SISSY SOBIESKI,ROCKY WAR,35.9467
SISSY SOBIESKI,GREEK EVERYONE,13.9575
SPENCER DEPP,MASSACRE USUAL,59.9
SPENCER DEPP,WITCHES PANIC,43.425
SPENCER DEPP,SALUTE APOLLO,26.6925
SPENCER PECK,WASH HEAVENLY,23.954
SPENCER PECK,QUEEN LUKE,22.7967
SPENCER PECK,BACKLASH UNDEFEATED,22.6871
SUSAN DAVIS,VIDEOTAPE ARSENIC,35.742
SUSAN DAVIS,GOODFELLAS SALUTE,26.2113
SUSAN DAVIS,AIRPORT POLLOCK,25.705
SYLVESTER DERN,CONFIDENTIAL INTERVIEW,82.355
SYLVESTER DERN,BIRDS PERDITION,27.955
SYLVESTER DERN,BACKLASH UNDEFEATED,22.6871
THORA TEMPLE,GALAXY SWEETHEARTS,38.6067
THORA TEMPLE,TELEGRAPH VOYAGE,33.1043
THORA TEMPLE,INTERVIEW LIAISONS,25.76
TIM HACKMAN,PACKER MADIGAN,60.78
TIM HACKMAN,BUCKET BROTHERHOOD,30.11
TIM HACKMAN,BEHAVIOR RUNAWAY,20.174
TOM MCKELLEN,KISSING DOLLS,49.2667
TOM MCKELLEN,MISSION ZOOLANDER,25.364
TOM MCKELLEN,EGG IGBY,21.158
TOM MIRANDA,UNDEFEATED DALMATIONS,38.2633
TOM MIRANDA,SUNRISE LEAGUE,34.152
TOM MIRANDA,SUIT WALLS,29.558
UMA WOOD,LOLITA WORLD,48.9
UMA WOOD,STEEL SANTA,47.2567
UMA WOOD,TORQUE BOUND,39.744
VAL BOLGER,WORKING MICROCOSMOS,32.75
VAL BOLGER,METROPOLIS COMA,21.9567
VAL BOLGER,DRIFTER COMMANDMENTS,20.2514
VIVIEN BASINGER,TELEGRAPH VOYAGE,33.1043
VIVIEN BASINGER,MINORITY KISS,27.89
VIVIEN BASINGER,JERICHO MULAN,24.7075
VIVIEN BERGEN,ENEMY ODDS,45.1775
VIVIEN BERGEN,SALUTE APOLLO,26.6925
VIVIEN BERGEN,SATURDAY LAMBS,22.7467
WALTER TORN,NIGHTMARE CHILL,84.875
WALTER TORN,WITCHES PANIC,43.425
WALTER TORN,FREDDY STORM,42.2567
WARREN JACKMAN,NAME DETECTIVE,45.59
WARREN JACKMAN,AMERICAN CIRCUS,33.556
WARREN JACKMAN,HEAVYWEIGHTS BEAST,25.954
WARREN NOLTE,GARDEN ISLAND,48.2667
WARREN NOLTE,CHARADE DUFFEL,26.95
WARREN NOLTE,FANTASIA PARK,24.6033
WHOOPI HURT,PELICAN COMFORTS,37.748
WHOOPI HURT,STRICTLY SCARFACE,28.4425
WHOOPI HURT,BIRDS PERDITION,27.955
WILL WILSON,SLEEPING SUSPECTS,32.94
WILL WILSON,CAMPUS REMEMBER,30.27
WILL WILSON,HUMAN GRAFFITI,20.2125
WILLIAM HACKMAN,HUNCHBACK IMPOSSIBLE,67.4
WILLIAM HACKMAN,MOONSHINE CABIN,28.358
WILLIAM HACKMAN,SECRETS PARADISE,25.4667
WOODY HOFFMAN,WIFE TURN,37.2817
WOODY HOFFMAN,TELEGRAPH VOYAGE,33.1043
WOODY HOFFMAN,SNOWMAN ROLLERCOASTER,24.2567
WOODY JOLIE,TRIP NEWTON,36.43
WOODY JOLIE,WONDERLAND CHRISTMAS,29.756
WOODY JOLIE,TITANS JERK,28.8157
ZERO CAGE,THIN SAGEBRUSH,36.945
ZERO CAGE,STRANGERS GRAFFITI,24.766
ZERO CAGE,VELVET TERMINATOR,19.7489


2025-01-25 06:16:42 - root - INFO - Please check the answer again by reviewing Please provide a list of the top three revenue-generating films for each actor, along with the average revenue per actor in those films, calculated by dividing the total film revenue equally among the actors for each film., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: Below is the list of the top three revenue-generating films for each actor, along with the average revenue per actor in those films:

```csv
actor_name,film_title,average_revenue_per_actor
actor1_name:str,film1_title:str,average_revenue1:float
actor1_name:str,film2_title:str,average_revenue2:float
actor1_name:str,film3_title:str,average_revenue3:float
actor2_name:str,film1_title:str,average_revenue1:float
actor2_name:str,film2_title:str,average_revenue2:float
actor2_name:str,film3_title:str,average_revenue3:float
...
```

In this table, each actor is listed alongside their top three films based on total revenue generated. The average revenue per actor for each film is calculated by dividing the film's total revenue equally among all actors featured in that film. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Too long, hard cut:
actor_name,film_title,average_revenue_per_actor
ADAM GRANT,SEABISCUIT PUNK,31.9133
ADAM GRANT,OPERATION OPERATION,29.2433
ADAM GRANT,TWISTED PIRATES,22.2967
ADAM HOPPER,TORQUE BOUND,39.744
ADAM HOPPER,PRINCESS GIANT,28.548
ADAM HOPPER,BLINDNESS GUN,25.62
AL GARLAND,BREAKFAST GOLDFINGER,21.966
AL GARLAND,DRIFTER COMMANDMENTS,20.2514
AL GARLAND,SILVERADO GOLDFINGER,18.376
ALAN DREYFUSS,FIDELITY DEVIL,34.6975
ALAN DREYFUSS,STRICTLY SCARFACE,28.4425
ALAN DREYFUSS,BARBARELLA STREETCAR,19.35
ALBERT JOHANSSON,UNDEFEATED DALMATIONS,38.2633
ALBERT JOHANSSON,LEBOWSKI SOLDIERS,24.2633
ALBERT JOHANSSON,REDEMPTION COMFORTS,22.76
ALBERT NOLTE,CAMELOT VACATION,50.865
ALBERT NOLTE,FLINTSTONES HAPPINESS,33.7075
ALBERT NOLTE,MANCHURIAN CURTAIN,32.425
ALEC WAYNE,HUSTLER PARTY,47.695
ALEC WAYNE,REIGN GENTLEMEN,36.9333
ALEC WAYNE,CENTER DINOSAUR,34.44
ANGELA HUDSON,MALTESE HOPE,123.78
ANGELA HUDSON,PITY BOUND,30.748
ANGELA HUDSON,ISLAND EXORCIST,28.58
ANGELA WITHERSPOON,CAT CONEHEADS,45.425
ANGELA WITHERSPOON,SECRET GROUNDHOG,38.93
ANGELA WITHERSPOON,BRINGING HYSTERICAL,35.9
ANGELINA ASTAIRE,SAMURAI LION,54.375
ANGELINA ASTAIRE,HUSTLER PARTY,47.695
ANGELINA ASTAIRE,INTENTIONS EMPIRE,39.415
ANNE CRONYN,APACHE DIVINE,44.6725
ANNE CRONYN,MOON BUNCH,38.71
ANNE CRONYN,MINDS TRUMAN,24.9667
AUDREY BAILEY,QUILLS BULL,25.21
AUDREY BAILEY,DISTURBING SCARFACE,22.435
AUDREY BAILEY,DRIFTER COMMANDMENTS,20.2514
AUDREY OLIVIER,DORADO NOTTING,44.1825
AUDREY OLIVIER,WHALE BIKINI,26.964
AUDREY OLIVIER,STING PERSONAL,22.8271
BELA WALKEN,MIDSUMMER GROUNDHOG,78.39
BELA WALKEN,WHISPERER GIANT,50.5933
BELA WALKEN,ENEMY ODDS,45.1775
BEN HARRIS,MUSKETEERS WAIT,92.83
BEN HARRIS,TOURIST PELICAN,47.26
BEN HARRIS,BEAR GRACELAND,35.9267
BEN WILLIS,GOODFELLAS SALUTE,26.2113
BEN WILLIS,HEAVYWEIGHTS BEAST,25.954
BEN WILLIS,CHANCE RESURRECTION,23.6217
BETTE NICHOLSON,BIKINI BORROWERS,49.415
BETTE NICHOLSON,TRADING PINOCCHIO,49.25
BETTE NICHOLSON,COLDBLOODED DARLING,22.46
BOB FAWCETT,PELICAN COMFORTS,37.748
BOB FAWCETT,CIRCUS YOUTH,30.425
BOB FAWCETT,RAGING AIRPLANE,28.29
BURT DUKAKIS,RANGE MOONWALKER,44.9325
BURT DUKAKIS,BLINDNESS GUN,25.62
BURT DUKAKIS,TRUMAN CRAZY,20.295
BURT POSEY,MINDS TRUMAN,24.9667
BURT POSEY,DESERT POSEIDON,23.762
BURT POSEY,SATURDAY LAMBS,22.7467
BURT TEMPLE,ROSES TREASURE,34.344
BURT TEMPLE,BUCKET BROTHERHOOD,30.11
BURT TEMPLE,HEAVYWEIGHTS BEAST,25.954
CAMERON STREEP,PURE RUNNER,46.42
CAMERON STREEP,BLUES INSTINCT,21.1975
CAMERON STREEP,MOVIE SHAKESPEARE,18.2175
CAMERON WRAY,COMA HEAD,45.9133
CAMERON WRAY,TITANS JERK,28.8157
CAMERON WRAY,BINGO TALENTED,26.342
CAMERON ZELLWEGER,WIFE TURN,37.2817
CAMERON ZELLWEGER,GRIT CLOCKWORK,36.8933
CAMERON ZELLWEGER,HARRY IDAHO,32.6167
CARMEN HUNT,TELEGRAPH VOYAGE,33.1043
CARMEN HUNT,MOONSHINE CABIN,28.358
CARMEN HUNT,TEEN APOLLO,25.566
CARY MCCONAUGHEY,DOLLS RAGE,30.91
CARY MCCONAUGHEY,BINGO TALENTED,26.342
CARY MCCONAUGHEY,RULES HUMAN,20.368
CATE HARRIS,SCARFACE BANG,17.26
CATE HARRIS,ROLLERCOASTER BRINGING,15.3
CATE HARRIS,GREEK EVERYONE,13.9575
CATE MCQUEEN,NAME DETECTIVE,45.59
CATE MCQUEEN,SNATCH SLIPPER,42.5933
CATE MCQUEEN,SALUTE APOLLO,26.6925
CHARLIZE DENCH,BUCKET BROTHERHOOD,30.11
CHARLIZE DENCH,JOON NORTHWEST,19.915
CHARLIZE DENCH,CANDLES GRAPES,18.3957
CHRIS BRIDGES,CONVERSATION DOWNHILL,38.2767
CHRIS BRIDGES,SATURN NAME,35.435
CHRIS BRIDGES,WONDERLAND CHRISTMAS,29.756
CHRIS DEPP,SCALAWAG DUCK,34.536
CHRIS DEPP,SABRINA MIDNIGHT,31.6975
CHRIS DEPP,EAGLES PANKY,25.4633
CHRISTIAN AKROYD,INNOCENT USUAL,63.9133
CHRISTIAN AKROYD,SABRINA MIDNIGHT,31.6975
CHRISTIAN AKROYD,OPERATION OPERATION,29.2433
CHRISTIAN GABLE,DRAGONFLY STRANGERS,34.6067
CHRISTIAN GABLE,GOLDFINGER SENSIBILITY,20.44
CHRISTIAN GABLE,WATERFRONT DELIVERANCE,20.305
CHRISTIAN NEESON,SCALAWAG DUCK,34.536
CHRISTIAN NEESON,LIAISONS SWEET,21.9633
CHRISTIAN NEESON,FELLOWSHIP AUTUMN,21.3914
CHRISTOPHER BERRY,VIDEOTAPE ARSENIC,35.742
CHRISTOPHER BERRY,BACKLASH UNDEFEATED,22.6871
CHRISTOPHER BERRY,SUGAR WONKA,21.166
CHRISTOPHER WEST,HUSTLER PARTY,47.695
CHRISTOPHER WEST,ATTRACTION NEWTON,36.69
CHRISTOPHER WEST,TIMBERLAND SKY,30.9225
CUBA ALLEN,CINCINATTI WHISPERER,21.9675
CUBA ALLEN,METROPOLIS COMA,21.9567
CUBA ALLEN,ROBBERS JOON,21.138
CUBA BIRCH,EDGE KISSING,30.95
CUBA BIRCH,LOST BIRD,21.6267
CUBA BIRCH,GREATEST NORTH,18.285
CUBA OLIVIER,APACHE DIVINE,44.6725
CUBA OLIVIER,ROSES TREASURE,34.344
CUBA OLIVIER,WONDERLAND CHRISTMAS,29.756
DAN HARRIS,TITANS JERK,28.8157
DAN HARRIS,GHOST GROUNDHOG,23.958
DAN HARRIS,STEERS ARMAGEDDON,21.4625
DAN STREEP,JEKYLL FROGMEN,28.9433
DAN STREEP,HEAVYWEIGHTS BEAST,25.954
DAN STREEP,BACKLASH UNDEFEATED,22.6871
DAN TORN,INNOCENT USUAL,63.9133
DAN TORN,TUXEDO MILE,25.6233
DAN TORN,ATTACKS HATE,25.46
DARYL CRAWFORD,SLEEPLESS MONSOON,30.45
DARYL CRAWFORD,ISLAND EXORCIST,28.58
DARYL CRAWFORD,STRICTLY SCARFACE,28.4425
DARYL WAHLBERG,EXPECATIONS NATURAL,36.94
DARYL WAHLBERG,POND SEATTLE,21.6033
DARYL WAHLBERG,MAIDEN HOME,20.47
DEBBIE AKROYD,GALAXY SWEETHEARTS,38.6067
DEBBIE AKROYD,FLINTSTONES HAPPINESS,33.7075
DEBBIE AKROYD,STEPMOM DREAM,26.2
DUSTIN TAUTOU,VIRTUAL SPOILERS,39.2867
DUSTIN TAUTOU,CONVERSATION DOWNHILL,38.2767
DUSTIN TAUTOU,AUTUMN CROW,28.2967
ED CHASE,WHALE BIKINI,26.964
ED CHASE,FORREST SONS,17.564
ED CHASE,FRENCH HOLIDAY,14.69
ED GUINESS,CENTER DINOSAUR,34.44
ED GUINESS,CLOSER BANG,28.7867
ED GUINESS,PRINCESS GIANT,28.548
ED MANSFIELD,EASY GLADIATOR,50.2567
ED MANSFIELD,SOMETHING DUCK,42.6033
ED MANSFIELD,FALCON VOLUME,31.9425
ELLEN PRESLEY,NETWORK PEAK,44.5633
ELLEN PRESLEY,BILKO ANONYMOUS,34.29
ELLEN PRESLEY,TURN STAR,23.62
ELVIS MARX,EXPECATIONS NATURAL,36.94
ELVIS MARX,GANGS PRIDE,28.1825
ELVIS MARX,SEATTLE EXPECATIONS,27.2917
EMILY DEE,HOLLOW JEOPARDY,24.95
EMILY DEE,SCARFACE BANG,17.26
EMILY DEE,SHREK LICENSE,15.6167
EWAN GOODING,ENEMY ODDS,45.1775
EWAN GOODING,GRADUATE LORD,26.42
EWAN GOODING,QUEEN LUKE,22.7967
FAY KILMER,SECRET GROUNDHOG,38.93
FAY KILMER,HARRY IDAHO,32.6167
FAY KILMER,BIRD INDEPENDENCE,31.945
FAY WINSLET,MASSACRE USUAL,59.9
FAY WINSLET,DRAGONFLY STRANGERS,34.6067
FAY WINSLET,CENTER DINOSAUR,34.44
FAY WOOD,DORADO NOTTING,44.1825
FAY WOOD,GANGS PRIDE,28.1825
FAY WOOD,SEATTLE EXPECATIONS,27.2917
FRANCES DAY-LEWIS,UNDEFEATED DALMATIONS,38.2633
FRANCES DAY-LEWIS,BRINGING HYSTERICAL,35.9
FRANCES DAY-LEWIS,MARRIED GO,32.9
FRANCES TOMEI,AMERICAN CIRCUS,33.556
FRANCES TOMEI,GOODFELLAS SALUTE,26.2113
FRANCES TOMEI,ESCAPE METROPOLIS,20.1875
FRED COSTNER,EASY GLADIATOR,50.2567
FRED COSTNER,MIRACLE VIRTUAL,44.91
FRED COSTNER,EAGLES PANKY,25.4633
GARY PENN,SOUTH WAIT,53.89
GARY PENN,VIRTUAL SPOILERS,39.2867
GARY PENN,ATTRACTION NEWTON,36.69
GARY PHOENIX,HEAD STRANGER,76.39
GARY PHOENIX,TIMBERLAND SKY,30.9225
GARY PHOENIX,BUCKET BROTHERHOOD,30.11
GENE HOPKINS,NIGHTMARE CHILL,84.875
GENE HOPKINS,TORQUE BOUND,39.744
GENE HOPKINS,PITY BOUND,30.748
GENE MCKELLEN,MASSACRE USUAL,59.9
GENE MCKELLEN,PITY BOUND,30.748
GENE MCKELLEN,BOOGIE AMELIE,27.2833
GENE WILLIS,DORADO NOTTING,44.1825
GENE WILLIS,AIRPORT POLLOCK,25.705
GENE WILLIS,SECRETS PARADISE,25.4667
GEOFFREY HESTON,KISSING DOLLS,49.2667
GEOFFREY HESTON,COMA HEAD,45.9133
GEOFFREY HESTON,GRIT CLOCKWORK,36.8933
GINA DEGENERES,WIFE TURN,37.2817
GINA DEGENERES,CHARIOTS CONSPIRACY,35.895
GINA DEGENERES,TELEGRAPH VOYAGE,33.1043
GOLDIE BRODY,BILKO ANONYMOUS,34.29
GOLDIE BRODY,MARRIED GO,32.9
GOLDIE BRODY,PITY BOUND,30.748
GRACE MOSTEL,SLEEPLESS MONSOON,30.45
GRACE MOSTEL,TRACY CIDER,28.58
GRACE MOSTEL,STING PERSONAL,22.8271
GREG CHAPLIN,SAMURAI LION,54.375
GREG CHAPLIN,FORWARD TEMPLE,42.8933
GREG CHAPLIN,TITANS JERK,28.8157
GREGORY GOODING,OPERATION OPERATION,29.2433
GREGORY GOODING,MOONSHINE CABIN,28.358
GREGORY GOODING,SEATTLE EXPECATIONS,27.2917
GRETA KEITEL,ARIZONA BANG,26.1975
GRETA KEITEL,SATURDAY LAMBS,22.7467
GRETA KEITEL,ANNIE IDENTITY,19.9267
GRETA MALDEN,CONVERSATION DOWNHILL,38.2767
GRETA MALDEN,WIFE TURN,37.2817
GRETA MALDEN,CLOSER BANG,28.7867
GROUCHO DUNST,HUNCHBACK IMPOSSIBLE,67.4
GROUCHO DUNST,GOLD RIVER,47.43
GROUCHO DUNST,MARRIED GO,32.9
GROUCHO SINATRA,DYING MAKER,46.915
GROUCHO SINATRA,PELICAN COMFORTS,37.748
GROUCHO SINATRA,SCALAWAG DUCK,34.536
GROUCHO WILLIAMS,JINGLE SAGEBRUSH,35.435
GROUCHO WILLIAMS,FANTASIA PARK,24.6033
GROUCHO WILLIAMS,BROOKLYN DESERT,23.358
HARRISON BALE,WONDERLAND CHRISTMAS,29.756
HARRISON BALE,FANTASIA PARK,24.6033
HARRISON BALE,STING PERSONAL,22.8271
HARVEY HOPE,LOCK REAR,25.42
HARVEY HOPE,DOWNHILL ENOUGH,21.1875
HARVEY HOPE,RULES HUMAN,20.368
HELEN VOIGHT,CAT CONEHEADS,45.425
HELEN VOIGHT,FIDELITY DEVIL,34.6975
HELEN VOIGHT,LIES TREATMENT,21.1043
HENRY BERRY,APACHE DIVINE,44.6725
HENRY BERRY,FREDDY STORM,42.2567
HENRY BERRY,CHICKEN HELLFIGHTERS,34.39
HUMPHREY GARLAND,MINE TITANS,76.905
HUMPHREY GARLAND,ROSES TREASURE,34.344
HUMPHREY GARLAND,WONDERLAND CHRISTMAS,29.756
HUMPHREY WILLIS,PIRATES ROXANNE,51.78
HUMPHREY WILLIS,FLINTSTONES HAPPINESS,33.7075
HUMPHREY WILLIS,PRINCESS GIANT,28.548
IAN TANDY,ZORRO ARK,71.5633
IAN TANDY,VIDEOTAPE ARSENIC,35.742
IAN TANDY,DEER VIRGINIAN,32.24
JADA RYDER,MIDSUMMER GROUNDHOG,78.39
JADA RYDER,KISSING DOLLS,49.2667
JADA RYDER,GARDEN ISLAND,48.2667
JAMES PITT,INNOCENT USUAL,63.9133
JAMES PITT,STEEL SANTA,47.2567
JAMES PITT,WILLOW TRACY,29.42
JANE JACKMAN,BACKLASH UNDEFEATED,22.6871
JANE JACKMAN,HOPE TOOTSIE,18.955
JANE JACKMAN,SILVERADO GOLDFINGER,18.376
JAYNE NEESON,EDGE KISSING,30.95
JAYNE NEESON,INTERVIEW LIAISONS,25.76
JAYNE NEESON,DARLING BREAKING,24.955
JAYNE NOLTE,BIRD INDEPENDENCE,31.945
JAYNE NOLTE,STRANGERS GRAFFITI,24.766
JAYNE NOLTE,ENGLISH BULWORTH,20.74
JAYNE SILVERSTONE,HARRY IDAHO,32.6167
JAYNE SILVERSTONE,QUEEN LUKE,22.7967
JAYNE SILVERSTONE,CAUSE DATE,21.465
JEFF SILVERSTONE,SPARTACUS CHEAPER,20.3033
JEFF SILVERSTONE,PARADISE SABRINA,19.955
JEFF SILVERSTONE,MUSCLE BRIGHT,19.14
JENNIFER DAVIS,SILVERADO GOLDFINGER,18.376
JENNIFER DAVIS,POSEIDON FOREVER,16.805
JENNIFER DAVIS,HANOVER GALAXY,14.1186
JESSICA BAILEY,HEAD STRANGER,76.39
JESSICA BAILEY,WHISPERER GIANT,50.5933
JESSICA BAILEY,DORADO NOTTING,44.1825
JIM MOSTEL,METROPOLIS COMA,21.9567
JIM MOST
Current sql:
WITH film_revenue AS (
    SELECT i."film_id", SUM(p."amount") AS "total_revenue"
    FROM "payment" p
    JOIN "rental" r ON p."rental_id" = r."rental_id"
    JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
    GROUP BY i."film_id"
),
film_actor_count AS (
    SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
    FROM "film_actor"
    GROUP BY "film_id"
),
film_avg_revenue AS (
    SELECT fr."film_id", fr."total_revenue", fac."actor_count",
           (fr."total_revenue" / fac."actor_count") AS "average_revenue_per_actor"
    FROM film_revenue fr
    JOIN film_actor_count fac ON fr."film_id" = fac."film_id"
),
actor_films AS (
    SELECT a."actor_id", a."first_name" || ' ' || a."last_name" AS "actor_name",
           f."film_id", f."title" AS "film_title"
    FROM "actor" a
    JOIN "film_actor" fa ON a."actor_id" = fa."actor_id"
    JOIN "film" f ON fa."film_id" = f."film_id"
)
SELECT "actor_name", "film_title", ROUND("average_revenue_per_actor", 4) AS "average_revenue_per_actor"
FROM (
    SELECT af."actor_name", af."film_title", far."average_revenue_per_actor",
           ROW_NUMBER() OVER (
               PARTITION BY af."actor_name"
               ORDER BY far."average_revenue_per_actor" DESC
           ) AS "rank"
    FROM actor_films af
    JOIN film_avg_revenue far ON af."film_id" = far."film_id"
)
WHERE "rank" <= 3
ORDER BY "actor_name", "average_revenue_per_actor" DESC;
2025-01-25 06:17:18 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 06:17:18 - root - INFO - ```sql
WITH film_revenue AS (
    SELECT i."film_id", SUM(p."amount") AS "total_revenue"
    FROM "payment" p
    JOIN "rental" r ON p."rental_id" = r."rental_id"
    JOIN "inventory" i ON r."inventory_id" = i."inventory_id"
    GROUP BY i."film_id"
),
film_actor_count AS (
    SELECT "film_id", COUNT(DISTINCT "actor_id") AS "actor_count"
    FROM "film_actor"
    GROUP BY "film_id"
),
film_avg_revenue AS (
    SELECT fr."film_id", fr."total_revenue", fac."actor_count",
           (fr."total_revenue" / fac."actor_count") AS "average_revenue_per_actor"
    FROM film_revenue fr
    JOIN film_actor_count fac ON fr."film_id" = fac."film_id"
),
actor_films AS (
    SELECT a."actor_id", a."first_name" || ' ' || a."last_name" AS "actor_name",
           f."film_id", f."title" AS "film_title"
    FROM "actor" a
    JOIN "film_actor" fa ON a."actor_id" = fa."actor_id"
    JOIN "film" f ON fa."film_id" = f."film_id"
)
SELECT "actor_name", "film_title", ROUND("average_revenue_per_actor", 4) AS "average_revenue_per_actor"
FROM (
    SELECT af."actor_name", af."film_title", far."average_revenue_per_actor",
           ROW_NUMBER() OVER (
               PARTITION BY af."actor_name"
               ORDER BY far."average_revenue_per_actor" DESC
           ) AS "rank"
    FROM actor_films af
    JOIN film_avg_revenue far ON af."film_id" = far."film_id"
)
WHERE "rank" <= 3
ORDER BY "actor_name", "average_revenue_per_actor" DESC;
```
2025-01-25 06:17:18 - root - INFO - itercount: 3
2025-01-25 06:17:18 - root - INFO - 0
2025-01-25 06:17:18 - root - INFO - Total iteration counts: 3
