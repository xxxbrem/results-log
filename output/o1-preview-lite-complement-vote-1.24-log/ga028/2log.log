2025-01-27 01:20:17 - openai._base_client - INFO - Retrying request to /chat/completions in 0.375615 seconds
2025-01-27 01:21:26 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:21:28 - root - INFO - SQL:
SELECT
     user_pseudo_id,
     TIMESTAMP_MICROS(user_first_touch_timestamp) AS first_touch_time
   FROM
     `firebase-public-project.analytics_153293282.events_*`
   WHERE
     _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
   LIMIT 100;
Results:
user_pseudo_id,first_touch_time
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
0AF67C1A1C8F3785609B4210C3E04FC8,2017-07-01 01:40:40.150000+00:00
0AF67C1A1C8F3785609B4210C3E04FC8,2017-07-01 01:40:40.150000+00:00
0AF67C1A1C8F3785609B4210C3E04FC8,2017-07-01 01:40:40.150000+00:00
0AF67C1A1C8F3785609B4210C3E04FC8,2017-07-01 01:40:40.150000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00

2025-01-27 01:21:30 - root - INFO - SQL:
SELECT DISTINCT
     user_pseudo_id,
     event_date
   FROM
     `firebase-public-project.analytics_153293282.events_*`
   WHERE
     _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
   LIMIT 100;
Results:
user_pseudo_id,event_date
654F30C1312F6C1A26DFDA9F076A62D8,20180702
65D7715C409E6A38667447CE2B52AFFE,20180702
B205B117C82A24AA95E663FFB7D04718,20180702
EF9E8CCCCBBB015CAE0C334AB1745417,20180702
83D8C7F90DAF2C832F05A9DDD8693135,20180702
093642BD46204EB5F950303CE696BC18,20180702
0F67E233B19D2898229CD156974A93AE,20180702
5217AB1A454DAED6243E1C9818BE6A20,20180702
C6EAD483A8AF7EE9B0ADE6D7CE5DD698,20180702
58230465C695B0FDDDAE08A481FAEECC,20180702
38D4084307B6D1CEA37A48981753428E,20180702
0373DF7959F6867CDFB1C905D39CE67C,20180702
5D5895B1267014C54ECBE08864420979,20180702
D34924C19421D7E083FD387D97765F94,20180702
C136A7CE1D0A52B8D4E5F144DF114EB7,20180702
49309C5759610DBF6C829C0D4AB23943,20180702
92B0B6F48ECE132C7E502F94798FE205,20180702
4BF98D09CA8359FC59ADAF56D00338F8,20180702
08D399C66188D9A356AFAD5E2B2BA45E,20180702
909A16079F7183140ACF4C71A6CCDF3D,20180702
3031EAD1E9D35306A37A0F3DC3B84A0A,20180702
05407E04B9FA64CB63D8FA1D966AD6A2,20180702
3A58859E074B02E8FB1CAEA291636112,20180702
5CDFC86835249BE3DB5E9F6778E344AD,20180702
706C748E6D1E0768BFEFE6362B5D3F67,20180702
F815B0069F973BFA743EF90A85224109,20180702
D0F280B12652EB0D74F6BC74AB13606F,20180702
4D084D38156128AAA060303AA91E689D,20180702
3EF8FC940E379D53BBD3FEFDAF626BB2,20180702
DE4912FBC5F915C027000A8A6FF44F85,20180702
E6FEE8B98E75EA5311FE004F98559A27,20180702
E2D6E7FE36B7CDD0789CC8F03CC747E0,20180702
48AB910A8DE8485D4C34238EA61F782C,20180702
50FEAE9ECFE22E951E8810622A2E8F66,20180702
4A47422A455E62E3529DE4F9F3BFAF66,20180702
2F5B044B41268F6643EB4D0EF15D4E87,20180702
E8710E77072D6674A93E46DFEF725587,20180702
7101B4232F5B26A9C987C54F8717DCDC,20180702
4948BEDE78FC6EBA9899F26BF5C53897,20180702
88A41BFED275BB69125BE1F5524F3B42,20180702
A064A84CD3CF7058F39333D6212E8615,20180702
A87A30159D909E2356F72AAC76F26707,20180702
7842C62D45ECE888132F21C9F4417B21,20180702
672B24B51143CC66DCBAA0FA88C38D57,20180702
7AE4084BAA29B1987E51BF2964646805,20180702
2F8E2DBB938D2E43C2D171AF5F35EEF8,20180702
29845B6298FB882DF53607D21F0E1DF7,20180702
76BB576278338D2E508DE5D705241B47,20180702
92BF054A90804B6D65F11D7CDFCDDEFC,20180702
7207044281C74501C14233463AAD9A71,20180702
4BDC831A6940071E2461D0B5293A329E,20180702
3DEB0C12C49AD19D7ACE68FA59E7ACD6,20180702
B7701369F8598A25DED0499DAD3BE85D,20180702
A74EFE8BDAC26101B308D57A18B746CF,20180702
920DB84FCC0F4421650B9E257E33180B,20180702
AE920B86560554C0BE3F888EDBA2BBF7,20180702
037DAC225F0C1E54657770CD201CDDA7,20180702
64BA3BB3BD757CE7000D38CB7125E6DA,20180702
E50F7AC0680FD87AD6CE6B6700D209A7,20180702
7D613AF4DA0F508C7090E96FD73B7E6D,20180702
C795AFA7F574C2BB09D3647AD90A9719,20180702
936906C2CB90CE437DBFC01BBD96BA39,20180702
FEDC59699D8832A11B88BFCCCAD0951D,20180702

2025-01-27 01:21:32 - root - INFO - SQL:
SELECT
     COUNT(DISTINCT user_pseudo_id) AS total_new_users
   FROM
     `firebase-public-project.analytics_153293282.events_*`
   WHERE
     _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
     AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08';
Results:
total_new_users
222

2025-01-27 01:21:34 - root - INFO - SQL:
SELECT
     event_name,
     COUNT(*) AS event_count
   FROM
     `firebase-public-project.analytics_153293282.events_20180702`
   GROUP BY
     event_name
   ORDER BY
     event_count DESC
   LIMIT 100;
Results:
event_name,event_count
screen_view,20378
user_engagement,11605
level_start_quickplay,4493
level_end_quickplay,3068
post_score,2144
level_complete_quickplay,1896
level_fail_quickplay,1173
select_content,942
level_reset_quickplay,916
session_start,621
level_start,560
level_end,396
level_retry_quickplay,387
level_retry,357
level_up,248
level_complete,229
level_fail,148
spend_virtual_currency,85
level_reset,72
use_extra_steps,55
app_exception,54
firebase_campaign,38
first_open,27
no_more_extra_steps,22
os_update,19
ad_reward,18
error,15
app_remove,13
completed_5_levels,11
app_update,8
challenge_a_friend,1
app_clear_data,1

2025-01-27 01:21:36 - root - INFO - SQL:
SELECT
     event_date,
     COUNT(*) AS event_count
   FROM
     `firebase-public-project.analytics_153293282.events_*`
   WHERE
     _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
   GROUP BY
     event_date
   ORDER BY
     event_date
   LIMIT 100;
Results:
event_date,event_count
20180702,50000
20180703,50000
20180704,50000
20180705,50000
20180706,50000
20180707,50000
20180708,50000

2025-01-27 01:21:40 - root - INFO - SQL:
SELECT
     user_pseudo_id,
     TIMESTAMP_MICROS(user_first_touch_timestamp) AS first_touch_time
   FROM
     `firebase-public-project.analytics_153293282.events_*`
   LIMIT 100;
Results:
user_pseudo_id,first_touch_time
486D0900B48B18D315367260129BFFB6,2018-09-17 15:59:58.402000+00:00
45FB547C5857493104687C234EDCDE37,2018-08-06 06:39:24.982000+00:00
45FB547C5857493104687C234EDCDE37,2018-08-06 06:39:24.982000+00:00
45FB547C5857493104687C234EDCDE37,2018-08-06 06:39:24.982000+00:00
45FB547C5857493104687C234EDCDE37,2018-08-06 06:39:24.982000+00:00
45FB547C5857493104687C234EDCDE37,2018-08-06 06:39:24.982000+00:00
45FB547C5857493104687C234EDCDE37,2018-08-06 06:39:24.982000+00:00
45FB547C5857493104687C234EDCDE37,2018-08-06 06:39:24.982000+00:00
45FB547C5857493104687C234EDCDE37,2018-08-06 06:39:24.982000+00:00
45FB547C5857493104687C234EDCDE37,2018-08-06 06:39:24.982000+00:00
45FB547C5857493104687C234EDCDE37,2018-08-06 06:39:24.982000+00:00
45FB547C5857493104687C234EDCDE37,2018-08-06 06:39:24.982000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
A2616A0876190B8C349DE35A9AF631B9,2018-08-31 19:49:38.623000+00:00
A2616A0876190B8C349DE35A9AF631B9,2018-08-31 19:49:38.623000+00:00
A2616A0876190B8C349DE35A9AF631B9,2018-08-31 19:49:38.623000+00:00
A2616A0876190B8C349DE35A9AF631B9,2018-08-31 19:49:38.623000+00:00
A2616A0876190B8C349DE35A9AF631B9,2018-08-31 19:49:38.623000+00:00
A2616A0876190B8C349DE35A9AF631B9,2018-08-31 19:49:38.623000+00:00

2025-01-27 01:21:43 - root - INFO - SQL:
SELECT DISTINCT
     user_pseudo_id
   FROM
     `firebase-public-project.analytics_153293282.events_*`
   WHERE
     _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
   LIMIT 100;
Results:
user_pseudo_id
654F30C1312F6C1A26DFDA9F076A62D8
65D7715C409E6A38667447CE2B52AFFE
B205B117C82A24AA95E663FFB7D04718
EF9E8CCCCBBB015CAE0C334AB1745417
83D8C7F90DAF2C832F05A9DDD8693135
093642BD46204EB5F950303CE696BC18
0F67E233B19D2898229CD156974A93AE
5217AB1A454DAED6243E1C9818BE6A20
C6EAD483A8AF7EE9B0ADE6D7CE5DD698
58230465C695B0FDDDAE08A481FAEECC
38D4084307B6D1CEA37A48981753428E
0373DF7959F6867CDFB1C905D39CE67C
5D5895B1267014C54ECBE08864420979
D34924C19421D7E083FD387D97765F94
C136A7CE1D0A52B8D4E5F144DF114EB7
49309C5759610DBF6C829C0D4AB23943
92B0B6F48ECE132C7E502F94798FE205
4BF98D09CA8359FC59ADAF56D00338F8
08D399C66188D9A356AFAD5E2B2BA45E
909A16079F7183140ACF4C71A6CCDF3D
3031EAD1E9D35306A37A0F3DC3B84A0A
05407E04B9FA64CB63D8FA1D966AD6A2
3A58859E074B02E8FB1CAEA291636112
5CDFC86835249BE3DB5E9F6778E344AD
706C748E6D1E0768BFEFE6362B5D3F67
F815B0069F973BFA743EF90A85224109
D0F280B12652EB0D74F6BC74AB13606F
4D084D38156128AAA060303AA91E689D
3EF8FC940E379D53BBD3FEFDAF626BB2
DE4912FBC5F915C027000A8A6FF44F85
E6FEE8B98E75EA5311FE004F98559A27
E2D6E7FE36B7CDD0789CC8F03CC747E0
48AB910A8DE8485D4C34238EA61F782C
50FEAE9ECFE22E951E8810622A2E8F66
4A47422A455E62E3529DE4F9F3BFAF66
2F5B044B41268F6643EB4D0EF15D4E87
E8710E77072D6674A93E46DFEF725587
7101B4232F5B26A9C987C54F8717DCDC
4948BEDE78FC6EBA9899F26BF5C53897
88A41BFED275BB69125BE1F5524F3B42
A064A84CD3CF7058F39333D6212E8615
A87A30159D909E2356F72AAC76F26707
7842C62D45ECE888132F21C9F4417B21
672B24B51143CC66DCBAA0FA88C38D57
7AE4084BAA29B1987E51BF2964646805
2F8E2DBB938D2E43C2D171AF5F35EEF8
29845B6298FB882DF53607D21F0E1DF7
76BB576278338D2E508DE5D705241B47
92BF054A90804B6D65F11D7CDFCDDEFC
7207044281C74501C14233463AAD9A71
4BDC831A6940071E2461D0B5293A329E
3DEB0C12C49AD19D7ACE68FA59E7ACD6
B7701369F8598A25DED0499DAD3BE85D
A74EFE8BDAC26101B308D57A18B746CF
920DB84FCC0F4421650B9E257E33180B
AE920B86560554C0BE3F888EDBA2BBF7
037DAC225F0C1E54657770CD201CDDA7
64BA3BB3BD757CE7000D38CB7125E6DA
E50F7AC0680FD87AD6CE6B6700D209A7
7D613AF4DA0F508C7090E96FD73B7E6D
C795AFA7F574C2BB09D3647AD90A9719
936906C2CB90CE437DBFC01BBD96BA39
FEDC59699D8832A11B88BFCCCAD0951D
D7EA8E3645EFFBD6443946179ED704A6
59454BAC415BB1F18517C6FD2C023E49
27859DA5E38F4C681DA4FBF0CFB9F306
E451D416F972019604F1456533FF3858
60CFF65B640769B6FD3BC9593EDF7C1D
AFE7A3E11C66E71FA9EA7B138700EC44
5E694DE02688C2FDDEA38A6946A4CC3F
B75F91EB6C7FDA9A329567E763CF9E44
D739D483CCD20D4651E4A75ADEE94064
53866E32BA0ABFD846772D4B7B9B5921
7480AE90D76538F44A066A153F448198
8EDB9A9856CDB5AFC42546106EE46734
3EDE8E7A50DE76AA2EC12DDD2AE3F9F4
257A35EA0A92B4B2F8FB4BA3F8B4C3D8
60FAC27D8495BF33C2AE5283A7B07005
84D135997D8A4D9CB35D4ECA46EF6861
EBFE0623EF1109A89B392B9DF4375951
11A8D6037368A4C4508B11ADB4353BC4
CA04708DA02378999ECB402481FF1AE4
664F913ED3B54941B5F0886D94E01623
C87CDC0C4F86B10B7467281D516929B5
2F5BBABE9DD0271DCD62E501F76DA736
028CAE01A9F16A228177C973451441A1
4CE503AE5B4C4F67A00474CE380CCC39
3D03A380687FE3369E93915D50C572CB
4DA8863CD8D2C860F6BB73579BC6F5C9
EA9A16D9042286D55399A418CC7A28F3
117AD1627465CC9E03AB5D8825D42E07
D3F06F9B7BD9D7FC8758BF78BF0705E9
8040FC9C0479C3B9A74ED298DD8F357D

2025-01-27 01:21:45 - root - INFO - SQL:
SELECT
     user_pseudo_id,
     COUNT(*) AS event_count
   FROM
     `firebase-public-project.analytics_153293282.events_*`
   WHERE
     _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
   GROUP BY
     user_pseudo_id
   ORDER BY
     event_count DESC
   LIMIT 100;
Results:
user_pseudo_id,event_count
2F74E23BEA1E45E3897274EE4903DCC5,8525
56B9CBB6CB58106DCCF3CAD660232CB2,8093
CC88655DF7CDE5E8225BA20B5D6EC59B,7997
B63075B53A750A67A12F7F19ED5AA835,7756
05FB3382D94C7E963B408FD6CC357D33,5522
58F3D672BBC613680624015D5BC3ADDB,5464
10B0D468B5E036E16D13DB53A65F2D49,5293
3DEB0C12C49AD19D7ACE68FA59E7ACD6,5158
39A0592805168E5D5B3C3687A7472628,4830
8040FC9C0479C3B9A74ED298DD8F357D,4747
5217AB1A454DAED6243E1C9818BE6A20,4682
5E93E43C911DE1ECEA0A7C50390C57A9,4163
D4F4DAEF5BE38E5C67FD72BB1F082EBF,3750
22DC6A6AE86C0AA33EBB8C3164A26925,3325
CABE7E24215A5C36862658A36AE5CE12,3275
4D33ED6DCCD63BBED146B6060B307CAF,3146
12E5626928FE0885DEEF068683E8BD63,3132
EBFE0623EF1109A89B392B9DF4375951,2789
EF500E0CF578004836D1D38C8901862B,2784
472451071AED6FF801BC0FE66706FD27,2719
0CAAA1B6F161BA4D363EB7A2DEF64A08,2650
3875A92B5F5C2BBA1355CED06A986079,2594
DF0E6C6C5E4F3F34FEC6EE54FD945B05,2564
370CDFEE49990E4A9A1FBC0DC5C31C1C,2521
8BE7BF90C971453A34C1FF6FF2A0ACAE,2506
1B3AD9683D475EFB398E131DFE65AE61,2506
0D17D0247F158FA3E40D21EFF46D1651,2498
FFA9AE78B23263835F8AAED57713EBE9,2485
66E8EE325A3E6369E607998DFE9E13F1,2425
53A5A4C271525BAA74298747E100C376,2375
EFBDEC168A2BF8C727B060B2E231724E,2348
8F6C5F7611B67A4A437FF283B6C10181,2344
74375465CD17299EBC7C75A1B4047EE0,2317
004D2DFEB866BFB00427DB2F530C1F3D,2244
31D7BB4CF721D8676B85F73077F4304E,2189
03A9D32C44665A9E15CFCCEDC9F68EDB,2161
C8685B0DFA2C4B4E6E6EA72894C30F6F,2145
C74B58C4CD2770A1E97D6DC13D42CCAC,2071
56E8EC9522573BD1BAD8E18AD2E33C9A,2066
42E6A7C3536775E3B8C3DB919AE9A452,1967
48AB910A8DE8485D4C34238EA61F782C,1835
2DB65B29C41328FF8AB9AC27B7C05537,1789
C6DE585349744A40725DB0AB17041BA3,1738
8BD465AC77DC9D8B4C597BF35950FDA3,1713
BE74418BE7B7466F6FE2969CA79FA919,1678
734AC9568F0674F7BBE59D45B5B90EA7,1676
E6FEE8B98E75EA5311FE004F98559A27,1646
DDF187DB0391034487C7D3B8C681E0B0,1613
4EF964D59282E5A2C8692D30F011256B,1463
5E09265F12D64B9FA85FF9427A0A7FB0,1439
FA30269453141794E79B8F15EE0BA5B9,1381
FDA4BBBCF1EA2D95CDD77BFC5F00A837,1369
48C8A04DA2A666406E943C164A94D0B3,1366
B5395F8C2077B59B3D6C5719C0CA0339,1321
1213ED1E96B0A49B51C0F7683DB2ACCC,1282
BBDCBE2491658165B7F20540DE652E3A,1269
0B08423CCD5F1503B5A8B306FFED999C,1244
47216088A078D06F9220263FAF964F10,1229
F5DAD8DD17B689CF672D65A0A81CF4AC,1218
08D399C66188D9A356AFAD5E2B2BA45E,1205
418C1FE4FF01EA36F511E5D9073F11BD,1108
EFB696A82D093B3AFBE92FF526DD5CEA,1080
9B18A1CBA96D52D05CFA7CB7C9011EDE,1059
4193343164266373A13B35D5D04053E2,1057
E53BC2A0AD86417B443AF14EE3082C0F,1050
00D49153E0790E34D76523EEBEF459B2,1040
B78DB4E683651327A612372A48B5734C,1036

2025-01-27 01:22:26 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:22:26 - root - INFO - ```sql
SELECT
  ep.key,
  COALESCE(ep.value.string_value,
           CAST(ep.value.int_value AS STRING),
           CAST(ep.value.float_value AS STRING),
           CAST(ep.value.double_value AS STRING)) AS value
FROM
  `firebase-public-project.analytics_153293282.events_20180702`,
  UNNEST(event_params) AS ep
WHERE
  COALESCE(ep.value.string_value,
           ep.value.int_value,
           ep.value.float_value,
           ep.value.double_value) IS NOT NULL
LIMIT 100;
```
2025-01-27 01:22:49 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:22:49 - root - INFO - ```sql
SELECT
  ep.key,
  COALESCE(
    ep.value.string_value,
    CAST(ep.value.int_value AS STRING),
    CAST(ep.value.float_value AS STRING),
    CAST(ep.value.double_value AS STRING)
  ) AS value
FROM
  `firebase-public-project.analytics_153293282.events_20180702`,
  UNNEST(event_params) AS ep
WHERE
  COALESCE(
    ep.value.string_value,
    CAST(ep.value.int_value AS STRING),
    CAST(ep.value.float_value AS STRING),
    CAST(ep.value.double_value AS STRING)
  ) IS NOT NULL
LIMIT 100;
```

This query extracts non-empty key-value pairs from the `event_params` array by unnesting it and using `COALESCE` to combine different value types into a single `value` column. The `CAST` functions convert numeric types to strings for consistent typing, which resolves the `COALESCE` function error.
2025-01-27 01:24:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:24:09 - root - INFO - SQL:
SELECT
  ep.key,
  COALESCE(
    ep.value.string_value,
    CAST(ep.value.int_value AS STRING),
    CAST(ep.value.float_value AS STRING),
    CAST(ep.value.double_value AS STRING)
  ) AS value
FROM
  `firebase-public-project.analytics_153293282.events_20180702`,
  UNNEST(event_params) AS ep
WHERE
  COALESCE(
    ep.value.string_value,
    CAST(ep.value.int_value AS STRING),
    CAST(ep.value.float_value AS STRING),
    CAST(ep.value.double_value AS STRING)
  ) IS NOT NULL
LIMIT 100;
Results:
key,value
value,22
firebase_screen_class,game_board
firebase_event_origin,app+gtm
firebase_screen_id,-3260873074173490837
board,S
value,22
firebase_screen_class,game_board
firebase_event_origin,app+gtm
firebase_screen_id,8126232848982224228
board,S
value,22
firebase_screen_class,game_board
firebase_event_origin,app+gtm
firebase_screen_id,8126232848982224228
board,S
firebase_conversion,1
firebase_screen_class,game_board
firebase_event_origin,auto
firebase_screen_id,-3260873074173490837
firebase_previous_id,-3260873074173490845
firebase_screen_class,FloodItActivity
firebase_event_origin,auto
firebase_screen_id,-3260873074173490838
firebase_previous_class,main_menu
firebase_previous_id,-3260873074173490838
firebase_screen_class,game_board
firebase_event_origin,auto
firebase_screen_id,-3260873074173490837
firebase_previous_class,FloodItActivity
firebase_previous_id,-3260873074173490837
firebase_screen_class,ExtraStepsActivity
firebase_event_origin,auto
firebase_screen_id,-3260873074173490799
firebase_previous_class,game_board
firebase_previous_id,-3260873074173490799
firebase_screen_class,shop_menu
firebase_event_origin,auto
firebase_screen_id,-3260873074173490798
firebase_previous_class,ExtraStepsActivity
firebase_previous_id,-3260873074173490798
firebase_screen_class,game_board
firebase_event_origin,auto
firebase_screen_id,-3260873074173490837
firebase_previous_class,shop_menu
firebase_previous_id,-3260873074173490837
firebase_screen_class,GameFinishedActivity
firebase_event_origin,auto
firebase_screen_id,-3260873074173490785
firebase_previous_class,game_board
firebase_previous_id,-3260873074173490785
firebase_screen_class,game_over
firebase_event_origin,auto
firebase_screen_id,-3260873074173490784
firebase_previous_class,GameFinishedActivity
firebase_previous_id,-3260873074173490784
firebase_screen_class,game_board
firebase_event_origin,auto
firebase_screen_id,-3260873074173490837
firebase_previous_class,game_over
firebase_previous_id,-3260873074173490837
firebase_screen_class,ExtraStepsActivity
firebase_event_origin,auto
firebase_screen_id,-3260873074173490728
firebase_previous_class,game_board
firebase_previous_id,-3260873074173490728
firebase_screen_class,shop_menu
firebase_event_origin,auto
firebase_screen_id,-3260873074173490727
firebase_previous_class,ExtraStepsActivity
firebase_previous_id,-3260873074173490727
firebase_screen_class,AdActivity
firebase_event_origin,auto
firebase_screen_id,-3260873074173490717
firebase_previous_class,shop_menu
firebase_previous_id,-3260873074173490717
firebase_screen_class,shop_menu
firebase_event_origin,auto
firebase_screen_id,-3260873074173490727
firebase_previous_class,AdActivity
firebase_previous_id,-3260873074173490727
firebase_screen_class,game_board
firebase_event_origin,auto
firebase_screen_id,-3260873074173490837
firebase_previous_class,shop_menu
firebase_previous_id,-3260873074173490837
firebase_screen_class,GameFinishedActivity
firebase_event_origin,auto
firebase_screen_id,-3260873074173490700
firebase_previous_class,game_board
firebase_previous_id,-3260873074173490700

2025-01-27 01:24:11 - root - INFO - SQL:
SELECT
  platform,
  COUNT(*) AS event_count
FROM
  `firebase-public-project.analytics_153293282.events_*`
WHERE
  _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
GROUP BY
  platform
ORDER BY
  event_count DESC
LIMIT 100
Results:
platform,event_count
ANDROID,239668
IOS,110332

2025-01-27 01:24:12 - root - INFO - SQL:
SELECT
  device.category,
  device.mobile_brand_name,
  device.mobile_model_name
FROM
  `firebase-public-project.analytics_153293282.events_20180702`
LIMIT 100
Results:
category,mobile_brand_name,mobile_model_name
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset

2025-01-27 01:24:15 - root - INFO - SQL:
SELECT DISTINCT
  e1.user_pseudo_id
FROM
  `firebase-public-project.analytics_153293282.events_*` AS e1
WHERE
  _TABLE_SUFFIX BETWEEN '20180709' AND '20180715'
  AND e1.user_pseudo_id IN (
    SELECT DISTINCT
      user_pseudo_id
    FROM
      `firebase-public-project.analytics_153293282.events_*`
    WHERE
      _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
      AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08'
  )
LIMIT 100
Results:
user_pseudo_id
295D9E24D8DE65A010313E667131EF19
5256B2B115955E80DDB7449775D92325
E2372AFD5CBA85F1395201FB687AEC46
08F14F3BCA030F81B447161BA8653B44
FD9223BA1689E43F814C545A5FEBA7F4
370CDFEE49990E4A9A1FBC0DC5C31C1C
4109514A07FD2A10C61DA26ED8F826CA
9FEE80E475ED50AAF174B4F17563C16D
C74B58C4CD2770A1E97D6DC13D42CCAC
0160043392B1572A375E5C3BE1BB0C31
48D0C822ACA6BD0B5FBA8ECD27CBB247
D7D49CC32C4A23AD56E8DEAE6878EC7B
8BE7BF90C971453A34C1FF6FF2A0ACAE
077BC7302275F4E34731C2780C166C02
159002C6F393752AD79B3C2E8C7104C7
E4C074EBC3729FB45CFA48D9F6EA4DFD
FCA08F9B0DCB6E33A74F672CE7F73BE3
B179C315ED033642C37F45179C9E0B13
22DC6A6AE86C0AA33EBB8C3164A26925
75C683C1AE98FC6CCE6EA156C9E90A35
9B27F8491DC5DA23D369F31250BD8D65
7537C0AA6291AC7B99DC4D2D695EEF1D
6DC90DD09DF860E7C60C00BF36906CB3
2920B9D90561E521425DE4849FAAD1D7
AD4F00389084ECC4B5362689C228EB0F
FA5EFC7F0862BE935CF3C0BCCE5C38F1
F92B2FB00F381010F8895FDFB47A8331
E8755950FCC0CDF1F62E9024153DD624
28E44B5D5095EF494073AC47353F64C9
07A6B44E67F46615D8569A26774E5C33
3FFB1DF94D148994075041E8643DD788
DA534A42414330FBADC1AE6777F86EB5
4A81FE8E75C780C97EEE73A7574F0B4F
FFA9AE78B23263835F8AAED57713EBE9
09CAEE95CE99F27D00EA630EEDBCECA2
78B5D31EFEA7F4689CEB2CF7A9E4C4E5
461EEAF2B9223AE1D44C0E8DCE64876C
E09BE20A9F0680A1E1EB51633DF0D0AD
A0D023B78197471C25961C29691BEF85
CF06C47EAD622F909BFCC83FF4D0ECE8
0D6A346C85BF606BE12F9A70FC20A7B7
50D8D0C89D69EDAE2F04E43E90DB59C1
88E6D3D4433BA2B424A6D5D23A871B97
FAC23931821B151AD13B4E7B3CA3987B
051F80A715267A0035D626F7EB86ABBD
E9B5EC78F1F4D6F90B5AFB34D09697F2
52EF42933AD38302C75702C3D38BFFAE
3E8023DB1D342304C2D6BD56705C4687
FB581F2AC74E08CD38CCAAA9A99F0217
7ED4165854463C38F1D739A2014001D9
3D01D6221D54D40DC42C3D6FBCCEC926
A51128E8CFDD686155CB07E35B410A57
669EC0276AC761CB67555E361C534C6A
4BF45CB17DDBF06D87F4002632E0A1BC

2025-01-27 01:24:18 - root - INFO - SQL:
SELECT
  COUNT(DISTINCT e1.user_pseudo_id) AS retained_users_week1
FROM
  `firebase-public-project.analytics_153293282.events_*` AS e1
WHERE
  _TABLE_SUFFIX BETWEEN '20180709' AND '20180715'
  AND e1.user_pseudo_id IN (
    SELECT DISTINCT
      user_pseudo_id
    FROM
      `firebase-public-project.analytics_153293282.events_*`
    WHERE
      _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
      AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08'
  )
Results:
retained_users_week1
54

2025-01-27 01:24:20 - root - INFO - SQL:
SELECT
  e1.event_name,
  COUNT(*) AS event_count
FROM
  `firebase-public-project.analytics_153293282.events_*` AS e1
WHERE
  _TABLE_SUFFIX BETWEEN '20180709' AND '20180715'
  AND e1.user_pseudo_id IN (
    SELECT DISTINCT
      user_pseudo_id
    FROM
      `firebase-public-project.analytics_153293282.events_*`
    WHERE
      _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
      AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08'
  )
GROUP BY
  e1.event_name
ORDER BY
  event_count DESC
LIMIT 100
Results:
event_name,event_count
screen_view,8724
user_engagement,5049
level_start_quickplay,1113
level_end_quickplay,1009
post_score,680
level_start,585
level_fail_quickplay,518
level_complete_quickplay,491
level_end,479
level_retry,435
select_content,295
level_fail,290
level_up,189
level_complete,165
session_start,144
level_retry_quickplay,110
level_reset,59
level_reset_quickplay,38
use_extra_steps,13
spend_virtual_currency,13
app_exception,8
no_more_extra_steps,5
completed_5_levels,5
ad_reward,4
app_remove,3
challenge_a_friend,2

2025-01-27 01:24:22 - root - INFO - SQL:
SELECT
  up.key,
  COALESCE(
    up.value.string_value,
    CAST(up.value.int_value AS STRING),
    CAST(up.value.float_value AS STRING),
    CAST(up.value.double_value AS STRING)
  ) AS value
FROM (
  SELECT
    user_pseudo_id,
    user_properties
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
    AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08'
), UNNEST(user_properties) AS up
LIMIT 100
Results:
key,value
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5

2025-01-27 01:24:26 - root - INFO - SQL:
SELECT
  week,
  COUNT(DISTINCT user_pseudo_id) AS retained_users
FROM (
  SELECT
    user_pseudo_id,
    CASE
      WHEN event_date BETWEEN '20180702' AND '20180708' THEN 'Week0'
      WHEN event_date BETWEEN '20180709' AND '20180715' THEN 'Week1'
      WHEN event_date BETWEEN '20180716' AND '20180722' THEN 'Week2'
      WHEN event_date BETWEEN '20180723' AND '20180729' THEN 'Week3'
      WHEN event_date BETWEEN '20180730' AND '20180805' THEN 'Week4'
      ELSE 'Other'
    END AS week
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    _TABLE_SUFFIX BETWEEN '20180702' AND '20180805'
    AND user_pseudo_id IN (
      SELECT DISTINCT
        user_pseudo_id
      FROM
        `firebase-public-project.analytics_153293282.events_*`
      WHERE
        _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
        AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08'
    )
)
WHERE
  week IN ('Week0', 'Week1', 'Week2', 'Week3', 'Week4')
GROUP BY
  week
ORDER BY
  week
LIMIT 100
Results:
week,retained_users
Week0,222
Week1,54
Week2,37
Week3,35
Week4,15

2025-01-27 01:24:28 - root - INFO - SQL:
SELECT
  week,
  COUNT(*) AS total_events
FROM (
  SELECT
    CASE
      WHEN event_date BETWEEN '20180702' AND '20180708' THEN 'Week0'
      WHEN event_date BETWEEN '20180709' AND '20180715' THEN 'Week1'
      WHEN event_date BETWEEN '20180716' AND '20180722' THEN 'Week2'
      WHEN event_date BETWEEN '20180723' AND '20180729' THEN 'Week3'
      WHEN event_date BETWEEN '20180730' AND '20180805' THEN 'Week4'
      ELSE 'Other'
    END AS week
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    _TABLE_SUFFIX BETWEEN '20180702' AND '20180805'
    AND user_pseudo_id IN (
      SELECT DISTINCT
        user_pseudo_id
      FROM
        `firebase-public-project.analytics_153293282.events_*`
      WHERE
        _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
        AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08'
    )
)
WHERE
  week IN ('Week0', 'Week1', 'Week2', 'Week3', 'Week4')
GROUP BY
  week
ORDER BY
  week
LIMIT 100
Results:
week,total_events
Week0,43961
Week1,20426
Week2,15120
Week3,11727
Week4,9681

2025-01-27 01:24:36 - root - INFO - SQL:
SELECT
  event_name,
  COUNT(*) AS event_count
FROM
  `firebase-public-project.analytics_153293282.events_*`
WHERE
  _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
  AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08'
GROUP BY
  event_name
ORDER BY
  event_count DESC
LIMIT 100
Results:
event_name,event_count
screen_view,17682
user_engagement,10603
level_start,1817
level_start_quickplay,1811
post_score,1536
level_end,1425
level_end_quickplay,1341
level_retry,1244
level_up,939
select_content,929
level_complete,808
level_fail_quickplay,744
level_complete_quickplay,597
level_fail,486
session_start,386
level_reset_quickplay,288
firebase_campaign,274
spend_virtual_currency,210
first_open,196
level_reset,193
level_retry_quickplay,133
use_extra_steps,101
completed_5_levels,63
no_more_extra_steps,47
app_remove,44
app_exception,26
ad_reward,14
challenge_a_friend,8
error,8
app_update,4
os_update,3
dynamic_link_first_open,1

2025-01-27 01:24:38 - root - INFO - SQL:
SELECT
  geo.continent,
  geo.country,
  geo.region,
  geo.city,
  COUNT(DISTINCT user_pseudo_id) AS user_count
FROM
  `firebase-public-project.analytics_153293282.events_*`
WHERE
  _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
  AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08'
GROUP BY
  geo.continent,
  geo.country,
  geo.region,
  geo.city
ORDER BY
  user_count DESC
LIMIT 100
Results:
continent,country,region,city,user_count
Americas,United States,,,95
Asia,India,,,23
Americas,Canada,,,12
Europe,United Kingdom,,,12
Oceania,Australia,,,8
Asia,Japan,,,5
Asia,Pakistan,,,5
Asia,Vietnam,,,5
Americas,Brazil,,,4
Asia,United Arab Emirates,,,4
Africa,Egypt,,,3
Americas,United States,Texas,Dallas,3
Americas,Colombia,,,3
Europe,Germany,,,3
Asia,Philippines,,,3
Oceania,New Zealand,,,3
Americas,United States,Washington,Seattle,2
Asia,China,,,2
Oceania,Australia,New South Wales,Sydney,2
Asia,Saudi Arabia,,,2
Africa,South Africa,,,2
Americas,Mexico,,,2
Europe,Netherlands,,,2
Americas,United States,Illinois,Chicago,2
Europe,Latvia,,,1
Asia,Jordan,,,1
Asia,Singapore,,,1
Americas,Ecuador,,,1
Asia,Nepal,,,1
Asia,Bangladesh,,,1
Africa,Zambia,,,1
Asia,Bangladesh,,,1
Asia,Indonesia,,,1
Africa,Zimbabwe,,,1
Americas,United States,New York,New York,1
Africa,Zambia,,,1
Africa,Uganda,,,1
Asia,Hong Kong,,,1
Europe,Italy,,,1
Europe,Ireland,,,1
Africa,Tunisia,,,1
Americas,Argentina,,,1
Asia,Taiwan,,,1

2025-01-27 01:25:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:25:08 - root - INFO - ```sql
SELECT
  event_name,
  COUNT(*) AS event_count
FROM
  `firebase-public-project.analytics_153293282.events_*`
WHERE
  _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
GROUP BY
  event_name
ORDER BY
  event_count DESC
LIMIT 100;
```
2025-01-27 01:25:45 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:25:45 - root - INFO - SQL:
SELECT
  event_name,
  COUNT(*) AS event_count
FROM
  `firebase-public-project.analytics_153293282.events_*`
WHERE
  _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
GROUP BY
  event_name
ORDER BY
  event_count DESC
LIMIT 100;
Results:
event_name,event_count
screen_view,142638
user_engagement,81342
level_start_quickplay,31311
level_end_quickplay,21742
post_score,15470
level_complete_quickplay,13522
level_fail_quickplay,8220
level_reset_quickplay,6486
select_content,6347
level_start,4013
session_start,4010
level_end,2947
level_retry,2444
level_up,1948
level_retry_quickplay,1925
level_complete,1591
level_fail,1000
spend_virtual_currency,536
level_reset,422
use_extra_steps,380
app_exception,376
firebase_campaign,314
first_open,205
no_more_extra_steps,150
os_update,141
app_remove,132
completed_5_levels,108
ad_reward,101
app_update,90
error,62
challenge_a_friend,20
dynamic_link_app_open,3
app_clear_data,2
challenge_accepted,1
dynamic_link_first_open,1

2025-01-27 01:25:47 - root - INFO - SQL:
SELECT
  up.key,
  COALESCE(
    up.value.string_value,
    CAST(up.value.int_value AS STRING),
    CAST(up.value.float_value AS STRING),
    CAST(up.value.double_value AS STRING)
  ) AS value
FROM (
  SELECT
    user_pseudo_id,
    user_properties
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
), UNNEST(user_properties) AS up
LIMIT 100
Results:
key,value
plays_quickplay,true
num_levels_available,30
firebase_last_notification,4857993083614758445
firebase_exp_4,1
plays_progressive,true
firebase_exp_1,0
first_open_time,1476908354977000
ad_frequency,2
initial_extra_steps,3
plays_quickplay,true
num_levels_available,30
firebase_last_notification,2902228027551633195
plays_progressive,true
firebase_exp_1,1
first_open_time,1469220942645000
ad_frequency,2
initial_extra_steps,20
plays_quickplay,true
num_levels_available,30
firebase_last_notification,2902228027551633195
plays_progressive,true
firebase_exp_1,1
first_open_time,1469220942645000
ad_frequency,2
initial_extra_steps,20
plays_quickplay,true
num_levels_available,30
firebase_last_notification,2902228027551633195
plays_progressive,true
firebase_exp_1,1
first_open_time,1469220942645000
ad_frequency,2
initial_extra_steps,20
plays_quickplay,true
num_levels_available,30
firebase_last_notification,2902228027551633195
plays_progressive,true
firebase_exp_1,1
first_open_time,1469220942645000
ad_frequency,2
initial_extra_steps,20
plays_quickplay,true
num_levels_available,30
firebase_last_notification,2902228027551633195
plays_progressive,true
firebase_exp_1,1
first_open_time,1469220942645000
ad_frequency,2
initial_extra_steps,20
plays_quickplay,true
num_levels_available,30
firebase_last_notification,2902228027551633195
plays_progressive,true
firebase_exp_1,1
first_open_time,1469220942645000
ad_frequency,2
initial_extra_steps,20
plays_quickplay,true
num_levels_available,30
firebase_last_notification,2902228027551633195
plays_progressive,true
firebase_exp_1,1
first_open_time,1469220942645000
ad_frequency,2
initial_extra_steps,20
plays_quickplay,true
num_levels_available,30
firebase_last_notification,2902228027551633195
plays_progressive,true
firebase_exp_1,1
first_open_time,1469220942645000
ad_frequency,2
initial_extra_steps,20
plays_quickplay,true
num_levels_available,30
firebase_last_notification,2902228027551633195
plays_progressive,true
firebase_exp_1,1
first_open_time,1469220942645000
ad_frequency,2
initial_extra_steps,20
plays_quickplay,true
num_levels_available,30
firebase_last_notification,2902228027551633195
plays_progressive,true
firebase_exp_1,1
first_open_time,1469220942645000
ad_frequency,2
initial_extra_steps,20
plays_quickplay,true
num_levels_available,30
firebase_last_notification,2902228027551633195
plays_progressive,true
firebase_exp_1,1
first_open_time,1469220942645000
ad_frequency,2
initial_extra_steps,20
plays_quickplay,true
num_levels_available,30
firebase_last_notification,2902228027551633195

2025-01-27 01:25:49 - root - INFO - SQL:
SELECT
  event_name,
  COUNT(*) AS event_count
FROM
  `firebase-public-project.analytics_153293282.events_*`
WHERE
  _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
GROUP BY
  event_name
ORDER BY
  event_count DESC
LIMIT 100
Results:
event_name,event_count
screen_view,142638
user_engagement,81342
level_start_quickplay,31311
level_end_quickplay,21742
post_score,15470
level_complete_quickplay,13522
level_fail_quickplay,8220
level_reset_quickplay,6486
select_content,6347
level_start,4013
session_start,4010
level_end,2947
level_retry,2444
level_up,1948
level_retry_quickplay,1925
level_complete,1591
level_fail,1000
spend_virtual_currency,536
level_reset,422
use_extra_steps,380
app_exception,376
firebase_campaign,314
first_open,205
no_more_extra_steps,150
os_update,141
app_remove,132
completed_5_levels,108
ad_reward,101
app_update,90
error,62
challenge_a_friend,20
dynamic_link_app_open,3
app_clear_data,2
challenge_accepted,1
dynamic_link_first_open,1

2025-01-27 01:25:51 - root - INFO - SQL:
SELECT
  geo.continent,
  geo.country,
  geo.region,
  geo.city,
  COUNT(DISTINCT user_pseudo_id) AS user_count
FROM
  `firebase-public-project.analytics_153293282.events_*`
WHERE
  _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
GROUP BY
  geo.continent,
  geo.country,
  geo.region,
  geo.city
ORDER BY
  user_count DESC
LIMIT 100
Results:
continent,country,region,city,user_count
Americas,United States,,,934
Europe,United Kingdom,,,70
Americas,Canada,,,67
Asia,India,,,56
Oceania,Australia,,,54
Asia,Japan,,,53
Europe,Germany,,,37
Americas,United States,Texas,Dallas,23
Americas,Mexico,,,22
Europe,France,,,21
Americas,United States,New York,New York,20
Americas,Brazil,,,19
Americas,United States,Illinois,Chicago,18
Asia,Pakistan,,,18
Americas,United States,Washington,Seattle,16
Europe,Netherlands,,,13
Europe,Spain,,,12
Oceania,New Zealand,,,10
Asia,China,,,8
Europe,Sweden,,,8
Europe,Austria,,,7
Asia,Indonesia,,,7
Oceania,Australia,New South Wales,Sydney,7
Asia,United Arab Emirates,,,7
Africa,South Africa,,,7
Asia,Philippines,,,7
Americas,United States,Georgia,Atlanta,6
Asia,Vietnam,,,6
Asia,Saudi Arabia,,,5
Africa,Egypt,,,5
Americas,United States,California,Los Angeles,5
Asia,Israel,,,5
Asia,Turkey,,,4
Americas,Colombia,,,4
Asia,Hong Kong,,,4
Europe,Belgium,,,4
Asia,Taiwan,,,4
Europe,Russia,,,4
Asia,Thailand,,,4
Asia,Jordan,,,3
Asia,Lebanon,,,3
Africa,Tunisia,,,3
Europe,Poland,,,3
Americas,Argentina,,,3
Asia,Bangladesh,,,3
Africa,Algeria,,,2
Asia,Singapore,,,2
Americas,Chile,,,2
Europe,Ireland,,,2
Europe,Romania,,,2
Africa,Zimbabwe,,,2
Europe,Italy,,,2
Americas,Dominican Republic,,,2

2025-01-27 01:26:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:26:39 - root - INFO - ```sql
SELECT
  e.event_name,
  ep.key AS param_key,
  COALESCE(
    ep.value.string_value,
    CAST(ep.value.int_value AS STRING),
    CAST(ep.value.float_value AS STRING),
    CAST(ep.value.double_value AS STRING)
  ) AS param_value
FROM
  `firebase-public-project.analytics_153293282.events_*` AS e,
  UNNEST(e.event_params) AS ep
WHERE
  _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
  AND e.event_name = 'spend_virtual_currency'
LIMIT 100;
```
2025-01-27 01:27:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:27:25 - root - INFO - SQL:
SELECT
  e.event_name,
  ep.key AS param_key,
  COALESCE(
    ep.value.string_value,
    CAST(ep.value.int_value AS STRING),
    CAST(ep.value.float_value AS STRING),
    CAST(ep.value.double_value AS STRING)
  ) AS param_value
FROM
  `firebase-public-project.analytics_153293282.events_*` AS e,
  UNNEST(e.event_params) AS ep
WHERE
  _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
  AND e.event_name = 'spend_virtual_currency'
LIMIT 100;
Results:
event_name,param_key,param_value
spend_virtual_currency,virtual_currency_name,steps
spend_virtual_currency,firebase_screen_class,game_board
spend_virtual_currency,item_name,0
spend_virtual_currency,firebase_event_origin,app+gtm
spend_virtual_currency,value,3
spend_virtual_currency,firebase_screen_id,2875908802993843912
spend_virtual_currency,virtual_currency_name,steps
spend_virtual_currency,firebase_screen_class,game_board
spend_virtual_currency,item_name,0
spend_virtual_currency,firebase_event_origin,app+gtm
spend_virtual_currency,value,1
spend_virtual_currency,firebase_screen_id,-5355191908706758779
spend_virtual_currency,virtual_currency_name,steps
spend_virtual_currency,firebase_screen_class,game_board
spend_virtual_currency,item_name,27
spend_virtual_currency,firebase_event_origin,app+gtm
spend_virtual_currency,value,3
spend_virtual_currency,firebase_screen_id,-8937516193509133143
spend_virtual_currency,virtual_currency_name,steps
spend_virtual_currency,firebase_screen_class,game_board
spend_virtual_currency,item_name,27
spend_virtual_currency,firebase_event_origin,app+gtm
spend_virtual_currency,value,3
spend_virtual_currency,firebase_screen_id,-8937516193509133143
spend_virtual_currency,virtual_currency_name,steps
spend_virtual_currency,firebase_screen_class,game_board
spend_virtual_currency,item_name,27
spend_virtual_currency,firebase_event_origin,app+gtm
spend_virtual_currency,value,3
spend_virtual_currency,firebase_screen_id,-8937516193509133143
spend_virtual_currency,virtual_currency_name,steps
spend_virtual_currency,firebase_screen_class,game_board
spend_virtual_currency,item_name,27
spend_virtual_currency,firebase_event_origin,app+gtm
spend_virtual_currency,value,1
spend_virtual_currency,firebase_screen_id,-8937516193509133143
spend_virtual_currency,virtual_currency_name,steps
spend_virtual_currency,firebase_screen_class,game_board
spend_virtual_currency,item_name,0
spend_virtual_currency,firebase_event_origin,app+gtm
spend_virtual_currency,value,2
spend_virtual_currency,firebase_screen_id,-6379018998194245772
spend_virtual_currency,virtual_currency_name,steps
spend_virtual_currency,firebase_screen_class,game_board
spend_virtual_currency,item_name,0
spend_virtual_currency,firebase_event_origin,app+gtm
spend_virtual_currency,value,1
spend_virtual_currency,firebase_screen_id,-6379018998194245772
spend_virtual_currency,virtual_currency_name,steps
spend_virtual_currency,firebase_screen_class,game_board
spend_virtual_currency,item_name,0

2025-01-27 01:27:46 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:27:46 - root - INFO - ```sql
SELECT
  e.event_name,
  ep.key AS param_key,
  COALESCE(
    ep.value.string_value,
    CAST(ep.value.int_value AS STRING),
    CAST(ep.value.float_value AS STRING),
    CAST(ep.value.double_value AS STRING)
  ) AS param_value
FROM
  `firebase-public-project.analytics_153293282.events_*` AS e,
  UNNEST(e.event_params) AS ep
WHERE
  _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
LIMIT 100;
```

*Explanation:* To ensure that data is returned, I've simplified the query by removing the condition `AND e.event_name = 'spend_virtual_currency'`. This will retrieve event parameters for all event types during the specified date range (July 2, 2018, to July 8, 2018). This adjustment increases the likelihood of retrieving data and allows for broader analysis of event parameters within that week.
2025-01-27 01:28:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:28:14 - root - INFO - SQL:
SELECT
  e.event_name,
  ep.key AS param_key,
  COALESCE(
    ep.value.string_value,
    CAST(ep.value.int_value AS STRING),
    CAST(ep.value.float_value AS STRING),
    CAST(ep.value.double_value AS STRING)
  ) AS param_value
FROM
  `firebase-public-project.analytics_153293282.events_*` AS e,
  UNNEST(e.event_params) AS ep
WHERE
  _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
LIMIT 100;
Results:
event_name,param_key,param_value
level_complete_quickplay,value,22
level_complete_quickplay,firebase_screen_class,game_board
level_complete_quickplay,firebase_event_origin,app+gtm
level_complete_quickplay,firebase_screen_id,-6439668580712960495
level_complete_quickplay,board,S
level_complete_quickplay,value,22
level_complete_quickplay,firebase_screen_class,game_board
level_complete_quickplay,firebase_event_origin,app+gtm
level_complete_quickplay,firebase_screen_id,7012838875361052825
level_complete_quickplay,board,S
level_complete_quickplay,value,21
level_complete_quickplay,firebase_screen_class,game_board
level_complete_quickplay,firebase_event_origin,app+gtm
level_complete_quickplay,firebase_screen_id,-860441632611151047
level_complete_quickplay,board,S
level_complete_quickplay,value,18
level_complete_quickplay,firebase_screen_class,game_board
level_complete_quickplay,firebase_event_origin,app+gtm
level_complete_quickplay,firebase_screen_id,-860441632611151047
level_complete_quickplay,board,S
screen_view,firebase_previous_id,-6439668580712960502
screen_view,firebase_screen_class,main_menu
screen_view,firebase_event_origin,auto
screen_view,firebase_screen_id,-6439668580712960501
screen_view,firebase_previous_class,MainMenuActivity
screen_view,firebase_previous_id,-6439668580712960501
screen_view,firebase_screen_class,FloodItActivity
screen_view,firebase_event_origin,auto
screen_view,firebase_screen_id,-6439668580712960496
screen_view,firebase_previous_class,main_menu
screen_view,firebase_previous_id,-6439668580712960496
screen_view,firebase_screen_class,game_board
screen_view,firebase_event_origin,auto
screen_view,firebase_screen_id,-6439668580712960495
screen_view,firebase_previous_class,FloodItActivity
screen_view,firebase_previous_id,-6439668580712960495
screen_view,firebase_screen_class,ExtraStepsActivity
screen_view,firebase_event_origin,auto
screen_view,firebase_screen_id,-6439668580712960481
screen_view,firebase_previous_class,game_board
screen_view,firebase_previous_id,-6439668580712960481
screen_view,firebase_screen_class,shop_menu
screen_view,firebase_event_origin,auto
screen_view,firebase_screen_id,-6439668580712960480
screen_view,firebase_previous_class,ExtraStepsActivity
screen_view,firebase_previous_id,-6439668580712960480
screen_view,firebase_screen_class,game_board
screen_view,firebase_event_origin,auto
screen_view,firebase_screen_id,-6439668580712960495
screen_view,firebase_previous_class,shop_menu
screen_view,firebase_previous_id,-6439668580712960495

2025-01-27 01:28:17 - root - INFO - SQL:
SELECT
  geo.continent,
  geo.country,
  COUNT(DISTINCT user_pseudo_id) AS user_count
FROM
  `firebase-public-project.analytics_153293282.events_*`
WHERE
  _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
  AND geo.continent IS NOT NULL
GROUP BY
  geo.continent,
  geo.country
ORDER BY
  user_count DESC
LIMIT 100
Results:
continent,country,user_count
Americas,United States,1001
Europe,United Kingdom,70
Americas,Canada,67
Oceania,Australia,56
Asia,India,56
Asia,Japan,53
Europe,Germany,37
Americas,Mexico,22
Europe,France,21
Americas,Brazil,19
Asia,Pakistan,18
Europe,Spain,13
Europe,Netherlands,13
Oceania,New Zealand,10
Europe,Sweden,8
Asia,China,8
Asia,Philippines,7
Africa,South Africa,7
Asia,United Arab Emirates,7
Europe,Austria,7
Asia,Indonesia,7
Asia,Vietnam,6
Asia,Israel,5
Africa,Egypt,5
Asia,Saudi Arabia,5
Asia,Taiwan,4
Asia,Hong Kong,4
Americas,Colombia,4
Asia,Turkey,4
Europe,Belgium,4
Asia,Thailand,4
Asia,Bangladesh,4
Europe,Russia,4
Africa,Tunisia,3
Asia,Jordan,3
Asia,Lebanon,3
Europe,Poland,3
Americas,Argentina,3
Europe,Ukraine,2
Europe,Ireland,2
Europe,Portugal,2
Europe,Italy,2
Americas,Dominican Republic,2
Asia,Malaysia,2
Americas,Panama,2
Asia,Qatar,2
Asia,Singapore,2
Europe,Hungary,2
Asia,Nepal,2
Americas,Chile,2
Africa,Algeria,2
Europe,Slovenia,2
Europe,Romania,2
Africa,Zimbabwe,2
Asia,South Korea,2
Africa,Morocco,2
Asia,Kuwait,1
Asia,Mongolia,1
Europe,Lithuania,1
Europe,Serbia,1
Africa,Tanzania,1
Europe,Slovakia,1
(not set),,1
Europe,Estonia,1
Americas,Honduras,1
Americas,Guadeloupe,1
Asia,Sri Lanka,1
Asia,Cambodia,1
Americas,El Salvador,1
Americas,Ecuador,1
Europe,Latvia,1
Asia,Cyprus,1
Europe,Norway,1
Africa,Uganda,1
Americas,Costa Rica,1
Oceania,Guam,1
Americas,Peru,1
Europe,Switzerland,1
Americas,Trinidad & Tobago,1
Europe,Belarus,1

2025-01-27 01:28:17 - root - INFO - itercount: 0
2025-01-27 01:28:17 - root - INFO - Database Name: firebase-public-project
Schema Name: analytics_153293282
DDL describes table information.
,0
table_name,events_20180801
ddl,"CREATE TABLE `firebase-public-project.analytics_153293282.events_20180801`
(
  event_date STRING,
  event_timestamp INT64,
  event_name STRING,
  event_params ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64>>>,
  event_previous_timestamp INT64,
  event_value_in_usd FLOAT64,
  event_bundle_sequence_id INT64,
  event_server_timestamp_offset INT64,
  user_id STRING,
  user_pseudo_id STRING,
  user_properties ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64, set_timestamp_micros INT64>>>,
  user_first_touch_timestamp INT64,
  user_ltv STRUCT<revenue FLOAT64, currency STRING>,
  device STRUCT<category STRING, mobile_brand_name STRING, mobile_model_name STRING, mobile_marketing_name STRING, mobile_os_hardware_model STRING, operating_system STRING, operating_system_version STRING, vendor_id STRING, advertising_id STRING, language STRING, is_limited_ad_tracking STRING, time_zone_offset_seconds INT64>,
  geo STRUCT<continent STRING, country STRING, region STRING, city STRING>,
  app_info STRUCT<id STRING, version STRING, install_store STRING, firebase_app_id STRING, install_source STRING>,
  traffic_source STRUCT<name STRING, medium STRING, source STRING>,
  stream_id STRING,
  platform STRING
);"

Some other tables have the similar structure: ['events_20180801', 'events_20180621', 'events_20180616', 'events_20180912', 'events_20180814', 'events_20180716', 'events_20181003', 'events_20180620', 'events_20180624', 'events_20180918', 'events_20180612', 'events_20180911', 'events_20180724', 'events_20180807', 'events_20180710', 'events_20180808', 'events_20180702', 'events_20180719', 'events_20180914', 'events_20180913', 'events_20180915', 'events_20180728', 'events_20180817', 'events_20180628', 'events_20180906', 'events_20180704', 'events_20180711', 'events_20180720', 'events_20180706', 'events_20180926', 'events_20180924', 'events_20180731', 'events_20180804', 'events_20180920', 'events_20180715', 'events_20180709', 'events_20180928', 'events_20180904', 'events_20180903', 'events_20180818', 'events_20180820', 'events_20180707', 'events_20180930', 'events_20180821', 'events_20180812', 'events_20180830', 'events_20180908', 'events_20180708', 'events_20180910', 'events_20180922', 'events_20180713', 'events_20180618', 'events_20180811', 'events_20181001', 'events_20180626', 'events_20180828', 'events_20180717', 'events_20180806', 'events_20180721', 'events_20180725', 'events_20180824', 'events_20180923', 'events_20180627', 'events_20180726', 'events_20180729', 'events_20180929', 'events_20180925', 'events_20180722', 'events_20180630', 'events_20180730', 'events_20180831', 'events_20180701', 'events_20180619', 'events_20180810', 'events_20180822', 'events_20180921', 'events_20180819', 'events_20180927', 'events_20180905', 'events_20180816', 'events_20180622', 'events_20180802', 'events_20180826', 'events_20180714', 'events_20180901', 'events_20180916', 'events_20180809', 'events_20181002', 'events_20180703', 'events_20180617', 'events_20180902', 'events_20180625', 'events_20180827', 'events_20180805', 'events_20180825', 'events_20180919', 'events_20180917', 'events_20180705', 'events_20180613', 'events_20180907', 'events_20180909', 'events_20180727', 'events_20180813', 'events_20180614', 'events_20180623', 'events_20180829', 'events_20180615', 'events_20180712', 'events_20180718', 'events_20180815', 'events_20180629', 'events_20180803', 'events_20180823', 'events_20180723']
External knowledge that might be helpful: 
How to Calculate User Retention in Big Query from Google Demo Game Analytics Data

As a Product / Website Analyst, I was pretty psyched to discover Googles public Google Analytics 4 (GA4) gaming event dataset called `firebase-public-project.analytics_153293282.events_*`. The table allows experienced developers and learners alike to experiment with raw GA4 data in Big Query for free. Event data is basically a log of user interactions with your product for analysis .For newbies interested in learning more about event data and GA4, visit my prior blog. This article provides SQL queries for a quick table overview and explains how to utilize Google Big Query to calculate user retention.


What is Retention?
User retention rates are key indicators for whether your product team meets user needs. Improving retention is often central to long term growth strategies.

**Retention measures how often and for how long users tend to return to your product.**

The metric can be a powerful proxy for product usefulness and user opinion. Its analysis can reveal critical information like how well your site converts new visitors to users and which items and features are associated with users coming back. If user data is available, retention can also help a business understand the profiles of its most active users (power users). Finally, retention is a great guardrail metric for A/B tests. Successful, product oriented companies prioritize a healthy user bases over short term profits.


**Common Retention Calculation Strategies**

Two common strategies to calculate retention are: 

a) N-Day retention

b) Unbounded Retention.


a) For N-Day retention, analysts calculate how many users with certain characteristics return over successive periods. It is called N days because we define the length of each period. For example, with N=7 day retention, if User A becomes part of our cohort of interest on day 0 and returns to the product day 5 and day 15, they are counted as retained for week 1 (17 days) and week 3 (1521 days) but not week 2 (814 days).


b) For Unbounded Retention, a user is counted as retained each week so long as their most recent product contact was after the week. For example, if User A becomes part of the cohort on day 0 and last returned to the site on day 21, they will be counted as retained in week 1 (17 days), week 2 (814 days), and week 3 (1521 days) but not week 4 (2228 days).

By calculating these metrics, companies can evaluate how well their products hold users interests. It also them closer to identifying the patterns that generate return users.



The table structure information is ({database name: {schema name: {table name}}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180612', 'events_20180613', 'events_20180614', 'events_20180615', 'events_20180616', 'events_20180617', 'events_20180618', 'events_20180619', 'events_20180620', 'events_20180621', 'events_20180622', 'events_20180623', 'events_20180624', 'events_20180625', 'events_20180626', 'events_20180627', 'events_20180628', 'events_20180629', 'events_20180630', 'events_20180701', 'events_20180702', 'events_20180703', 'events_20180704', 'events_20180705', 'events_20180706', 'events_20180707', 'events_20180708', 'events_20180709', 'events_20180710', 'events_20180711', 'events_20180712', 'events_20180713', 'events_20180714', 'events_20180715', 'events_20180716', 'events_20180717', 'events_20180718', 'events_20180719', 'events_20180720', 'events_20180721', 'events_20180722', 'events_20180723', 'events_20180724', 'events_20180725', 'events_20180726', 'events_20180727', 'events_20180728', 'events_20180729', 'events_20180730', 'events_20180731', 'events_20180801', 'events_20180802', 'events_20180803', 'events_20180804', 'events_20180805', 'events_20180806', 'events_20180807', 'events_20180808', 'events_20180809', 'events_20180810', 'events_20180811', 'events_20180812', 'events_20180813', 'events_20180814', 'events_20180815', 'events_20180816', 'events_20180817', 'events_20180818', 'events_20180819', 'events_20180820', 'events_20180821', 'events_20180822', 'events_20180823', 'events_20180824', 'events_20180825', 'events_20180826', 'events_20180827', 'events_20180828', 'events_20180829', 'events_20180830', 'events_20180831', 'events_20180901', 'events_20180902', 'events_20180903', 'events_20180904', 'events_20180905', 'events_20180906', 'events_20180907', 'events_20180908', 'events_20180909', 'events_20180910', 'events_20180911', 'events_20180912', 'events_20180913', 'events_20180914', 'events_20180915', 'events_20180916', 'events_20180917', 'events_20180918', 'events_20180919', 'events_20180920', 'events_20180921', 'events_20180922', 'events_20180923', 'events_20180924', 'events_20180925', 'events_20180926', 'events_20180927', 'events_20180928', 'events_20180929', 'events_20180930', 'events_20181001', 'events_20181002', 'events_20181003']}}
Begin Exploring Related Columns
**Relevant Columns and Their Potential Usage:**

- `user_pseudo_id` (STRING): Unique identifier for each user. Used to track individual users across events.
- `user_first_touch_timestamp` (INT64): Timestamp of the user's first interaction with the app. Used to identify new users during a specific period.
- `event_date` (STRING): Date of the event in 'YYYYMMDD' format. Used to filter events within specific dates.
- `event_timestamp` (INT64): Exact timestamp of the event. Can be converted to datetime for precise time analysis.
- `event_name` (STRING): Name of the event (e.g., 'first_open'). Useful for filtering specific types of events.
- `platform` (STRING): Platform used (e.g., iOS, Android). Can be used for platform-specific analysis.
- `event_params` (ARRAY<STRUCT>): Contains key-value pairs of event parameters. Useful for detailed event information.
- `user_properties` (ARRAY<STRUCT>): Contains key-value pairs of user properties. Can provide additional user details.

**Conditions That May Be Used:**

- Filter users whose `user_first_touch_timestamp` falls between '2018-07-02' and '2018-07-08' to identify new users during Week 0.
- Use `_TABLE_SUFFIX BETWEEN '20180702' AND '20180708'` to query events during Week 0.
- Use `_TABLE_SUFFIX` with appropriate date ranges to query events in subsequent weeks (Week 1 to Week 4).
- Use `DISTINCT` on `user_pseudo_id` to get unique users.
- Convert `user_first_touch_timestamp` and `event_timestamp` from microseconds to datetime using `TIMESTAMP_MICROS`.

---

**Sample BigQuery SQL Queries:**

1. **Retrieve a Sample of `user_pseudo_id` and `user_first_touch_timestamp` from Week 0:**

   ```sql
   SELECT
     user_pseudo_id,
     TIMESTAMP_MICROS(user_first_touch_timestamp) AS first_touch_time
   FROM
     `firebase-public-project.analytics_153293282.events_*`
   WHERE
     _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
   LIMIT 100;
   ```

2. **List Distinct `user_pseudo_id` and Their `event_date` During Week 0:**

   ```sql
   SELECT DISTINCT
     user_pseudo_id,
     event_date
   FROM
     `firebase-public-project.analytics_153293282.events_*`
   WHERE
     _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
   LIMIT 100;
   ```

3. **Count the Total Number of New Users in Week 0:**

   ```sql
   SELECT
     COUNT(DISTINCT user_pseudo_id) AS total_new_users
   FROM
     `firebase-public-project.analytics_153293282.events_*`
   WHERE
     _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
     AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08';
   ```

4. **Get Event Names and Their Counts on July 2, 2018:**

   ```sql
   SELECT
     event_name,
     COUNT(*) AS event_count
   FROM
     `firebase-public-project.analytics_153293282.events_20180702`
   GROUP BY
     event_name
   ORDER BY
     event_count DESC
   LIMIT 100;
   ```

5. **Retrieve Event Counts per `event_date` During Week 0:**

   ```sql
   SELECT
     event_date,
     COUNT(*) AS event_count
   FROM
     `firebase-public-project.analytics_153293282.events_*`
   WHERE
     _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
   GROUP BY
     event_date
   ORDER BY
     event_date
   LIMIT 100;
   ```

6. **Sample `user_pseudo_id` and Their First Touch Time Across All Data:**

   ```sql
   SELECT
     user_pseudo_id,
     TIMESTAMP_MICROS(user_first_touch_timestamp) AS first_touch_time
   FROM
     `firebase-public-project.analytics_153293282.events_*`
   LIMIT 100;
   ```

7. **List Distinct Users Who Used the App in Week 0:**

   ```sql
   SELECT DISTINCT
     user_pseudo_id
   FROM
     `firebase-public-project.analytics_153293282.events_*`
   WHERE
     _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
   LIMIT 100;
   ```

8. **Count the Number of Events per User During Week 0:**

   ```sql
   SELECT
     user_pseudo_id,
     COUNT(*) AS event_count
   FROM
     `firebase-public-project.analytics_153293282.events_*`
   WHERE
     _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
   GROUP BY
     user_pseudo_id
   ORDER BY
     event_count DESC
   LIMIT 100;
   ```

9. **Extract Event Parameters Keys and Values from Events on July 2, 2018:**

   ```sql
   SELECT
     ep.key,
     ep.value.string_value,
     ep.value.int_value,
     ep.value.float_value,
     ep.value.double_value
   FROM
     `firebase-public-project.analytics_153293282.events_20180702`,
     UNNEST(event_params) AS ep
   LIMIT 100;
   ```

10. **Get Counts of Different Platforms Used During Week 0:**

    ```sql
    SELECT
      platform,
      COUNT(*) AS event_count
    FROM
      `firebase-public-project.analytics_153293282.events_*`
    WHERE
      _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
    GROUP BY
      platform
    ORDER BY
      event_count DESC
    LIMIT 100;
    ```

11. **Retrieve Sample Device Information from Events on July 2, 2018:**

    ```sql
    SELECT
      device.category,
      device.mobile_brand_name,
      device.mobile_model_name
    FROM
      `firebase-public-project.analytics_153293282.events_20180702`
    LIMIT 100;
    ```

12. **Find Users with Events in Week 1 Who Were New Users in Week 0:**

    ```sql
    SELECT DISTINCT
      e1.user_pseudo_id
    FROM
      `firebase-public-project.analytics_153293282.events_*` AS e1
    WHERE
      _TABLE_SUFFIX BETWEEN '20180709' AND '20180715'
      AND e1.user_pseudo_id IN (
        SELECT DISTINCT
          user_pseudo_id
        FROM
          `firebase-public-project.analytics_153293282.events_*`
        WHERE
          _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
          AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08'
      )
    LIMIT 100;
    ```

13. **Count the Number of Retained Users in Week 1:**

    ```sql
    SELECT
      COUNT(DISTINCT e1.user_pseudo_id) AS retained_users_week1
    FROM
      `firebase-public-project.analytics_153293282.events_*` AS e1
    WHERE
      _TABLE_SUFFIX BETWEEN '20180709' AND '20180715'
      AND e1.user_pseudo_id IN (
        SELECT DISTINCT
          user_pseudo_id
        FROM
          `firebase-public-project.analytics_153293282.events_*`
        WHERE
          _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
          AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08'
      );
    ```

14. **List Event Names for Retained Users in Week 1:**

    ```sql
    SELECT
      e1.event_name,
      COUNT(*) AS event_count
    FROM
      `firebase-public-project.analytics_153293282.events_*` AS e1
    WHERE
      _TABLE_SUFFIX BETWEEN '20180709' AND '20180715'
      AND e1.user_pseudo_id IN (
        SELECT DISTINCT
          user_pseudo_id
        FROM
          `firebase-public-project.analytics_153293282.events_*`
        WHERE
          _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
          AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08'
      )
    GROUP BY
      e1.event_name
    ORDER BY
      event_count DESC
    LIMIT 100;
    ```

15. **Get User Properties for New Users in Week 0:**

    ```sql
    SELECT
      up.key,
      up.value.string_value,
      up.value.int_value,
      up.value.float_value,
      up.value.double_value
    FROM
      `firebase-public-project.analytics_153293282.events_*`,
      UNNEST(user_properties) AS up
    WHERE
      _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
      AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08'
    LIMIT 100;
    ```

16. **Count Retained Users for Each Week from Week 0 to Week 4:**

    (Note: This query provides counts for all weeks.)

    ```sql
    SELECT
      week,
      COUNT(DISTINCT user_pseudo_id) AS retained_users
    FROM (
      SELECT
        user_pseudo_id,
        CASE
          WHEN event_date BETWEEN '20180702' AND '20180708' THEN 'Week0'
          WHEN event_date BETWEEN '20180709' AND '20180715' THEN 'Week1'
          WHEN event_date BETWEEN '20180716' AND '20180722' THEN 'Week2'
          WHEN event_date BETWEEN '20180723' AND '20180729' THEN 'Week3'
          WHEN event_date BETWEEN '20180730' AND '20180805' THEN 'Week4'
          ELSE 'Other'
        END AS week
      FROM
        `firebase-public-project.analytics_153293282.events_*`
      WHERE
        _TABLE_SUFFIX BETWEEN '20180702' AND '20180805'
        AND user_pseudo_id IN (
          SELECT DISTINCT
            user_pseudo_id
          FROM
            `firebase-public-project.analytics_153293282.events_*`
          WHERE
            _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
            AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08'
        )
    )
    WHERE
      week IN ('Week0', 'Week1', 'Week2', 'Week3', 'Week4')
    GROUP BY
      week
    ORDER BY
      week
    LIMIT 100;
    ```

17. **Calculate the Total Number of Events per Week for New Users from Week 0 to Week 4:**

    ```sql
    SELECT
      week,
      COUNT(*) AS total_events
    FROM (
      SELECT
        CASE
          WHEN event_date BETWEEN '20180702' AND '20180708' THEN 'Week0'
          WHEN event_date BETWEEN '20180709' AND '20180715' THEN 'Week1'
          WHEN event_date BETWEEN '20180716' AND '20180722' THEN 'Week2'
          WHEN event_date BETWEEN '20180723' AND '20180729' THEN 'Week3'
          WHEN event_date BETWEEN '20180730' AND '20180805' THEN 'Week4'
          ELSE 'Other'
        END AS week
      FROM
        `firebase-public-project.analytics_153293282.events_*`
      WHERE
        _TABLE_SUFFIX BETWEEN '20180702' AND '20180805'
        AND user_pseudo_id IN (
          SELECT DISTINCT
            user_pseudo_id
          FROM
            `firebase-public-project.analytics_153293282.events_*`
          WHERE
            _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
            AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08'
        )
    )
    WHERE
      week IN ('Week0', 'Week1', 'Week2', 'Week3', 'Week4')
    GROUP BY
      week
    ORDER BY
      week
    LIMIT 100;
    ```

18. **Identify the Most Common `event_name` for New Users in Week 0:**

    ```sql
    SELECT
      event_name,
      COUNT(*) AS event_count
    FROM
      `firebase-public-project.analytics_153293282.events_*`
    WHERE
      _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
      AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08'
    GROUP BY
      event_name
    ORDER BY
      event_count DESC
    LIMIT 100;
    ```

19. **Get Geo-location Data for New Users in Week 0:**

    ```sql
    SELECT
      geo.continent,
      geo.country,
      geo.region,
      geo.city,
      COUNT(DISTINCT user_pseudo_id) AS user_count
    FROM
      `firebase-public-project.analytics_153293282.events_*`
    WHERE
      _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
      AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08'
    GROUP BY
      geo.continent,
      geo.country,
      geo.region,
      geo.city
    ORDER BY
      user_count DESC
    LIMIT 100;
    ```

20. **Check `event_value_in_usd` for Transactions Made by New Users in Week 0:**

    ```sql
    SELECT
      event_name,
      event_value_in_usd,
      COUNT(*) AS event_count
    FROM
      `firebase-public-project.analytics_153293282.events_*`
    WHERE
      _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
      AND event_value_in_usd IS NOT NULL
      AND user_pseudo_id IN (
        SELECT DISTINCT
          user_pseudo_id
        FROM
          `firebase-public-project.analytics_153293282.events_*`
        WHERE
          _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
          AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08'
      )
    GROUP BY
      event_name,
      event_value_in_usd
    ORDER BY
      event_count DESC
    LIMIT 100;
    ```

These queries help in understanding the data related to the 7-day retention analysis for users who first used the app during the week starting on **July 2, 2018**. By examining these queries, we can explore the necessary columns, conditions, and data patterns that are relevant to performing the retention analysis from Week 0 through Week 4.Query:
SELECT
     user_pseudo_id,
     TIMESTAMP_MICROS(user_first_touch_timestamp) AS first_touch_time
   FROM
     `firebase-public-project.analytics_153293282.events_*`
   WHERE
     _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
   LIMIT 100;
Answer:
user_pseudo_id,first_touch_time
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
BC1AF9C485B77D96242B88EE5085B1E5,2016-05-30 02:56:28.921000+00:00
0AF67C1A1C8F3785609B4210C3E04FC8,2017-07-01 01:40:40.150000+00:00
0AF67C1A1C8F3785609B4210C3E04FC8,2017-07-01 01:40:40.150000+00:00
0AF67C1A1C8F3785609B4210C3E04FC8,2017-07-01 01:40:40.150000+00:00
0AF67C1A1C8F3785609B4210C3E04FC8,2017-07-01 01:40:40.150000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
23183C7A7E31451194345099C978F49E,2017-08-09 15:04:01.184000+00:00
Query:
SELECT DISTINCT
     user_pseudo_id,
     event_date
   FROM
     `firebase-public-project.analytics_153293282.events_*`
   WHERE
     _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
   LIMIT 100;
Answer:
user_pseudo_id,event_date
654F30C1312F6C1A26DFDA9F076A62D8,20180702
65D7715C409E6A38667447CE2B52AFFE,20180702
B205B117C82A24AA95E663FFB7D04718,20180702
EF9E8CCCCBBB015CAE0C334AB1745417,20180702
83D8C7F90DAF2C832F05A9DDD8693135,20180702
093642BD46204EB5F950303CE696BC18,20180702
0F67E233B19D2898229CD156974A93AE,20180702
5217AB1A454DAED6243E1C9818BE6A20,20180702
C6EAD483A8AF7EE9B0ADE6D7CE5DD698,20180702
58230465C695B0FDDDAE08A481FAEECC,20180702
38D4084307B6D1CEA37A48981753428E,20180702
0373DF7959F6867CDFB1C905D39CE67C,20180702
5D5895B1267014C54ECBE08864420979,20180702
D34924C19421D7E083FD387D97765F94,20180702
C136A7CE1D0A52B8D4E5F144DF114EB7,20180702
49309C5759610DBF6C829C0D4AB23943,20180702
92B0B6F48ECE132C7E502F94798FE205,20180702
4BF98D09CA8359FC59ADAF56D00338F8,20180702
08D399C66188D9A356AFAD5E2B2BA45E,20180702
909A16079F7183140ACF4C71A6CCDF3D,20180702
3031EAD1E9D35306A37A0F3DC3B84A0A,20180702
05407E04B9FA64CB63D8FA1D966AD6A2,20180702
3A58859E074B02E8FB1CAEA291636112,20180702
5CDFC86835249BE3DB5E9F6778E344AD,20180702
706C748E6D1E0768BFEFE6362B5D3F67,20180702
F815B0069F973BFA743EF90A85224109,20180702
D0F280B12652EB0D74F6BC74AB13606F,20180702
4D084D38156128AAA060303AA91E689D,20180702
3EF8FC940E379D53BBD3FEFDAF626BB2,20180702
DE4912FBC5F915C027000A8A6FF44F85,20180702
E6FEE8B98E75EA5311FE004F98559A27,20180702
E2D6E7FE36B7CDD0789CC8F03CC747E0,20180702
48AB910A8DE8485D4C34238EA61F782C,20180702
50FEAE9ECFE22E951E8810622A2E8F66,20180702
4A47422A455E62E3529DE4F9F3BFAF66,20180702
2F5B044B41268F6643EB4D0EF15D4E87,20180702
E8710E77072D6674A93E46DFEF725587,20180702
7101B4232F5B26A9C987C54F8717DCDC,20180702
4948BEDE78FC6EBA9899F26BF5C53897,20180702
88A41BFED275BB69125BE1F5524F3B42,20180702
A064A84CD3CF7058F39333D6212E8615,20180702
A87A30159D909E2356F72AAC76F26707,20180702
7842C62D45ECE888132F21C9F4417B21,20180702
672B24B51143CC66DCBAA0FA88C38D57,20180702
7AE4084BAA29B1987E51BF2964646805,20180702
2F8E2DBB938D2E43C2D171AF5F35EEF8,20180702
29845B6298FB882DF53607D21F0E1DF7,20180702
76BB576278338D2E508DE5D705241B47,20180702
92BF054A90804B6D65F11D7CDFCDDEFC,20180702
7207044281C74501C14233463AAD9A71,20180702
4BDC831A6940071E2461D0B5293A329E,20180702
3DEB0C12C49AD19D7ACE68FA59E7ACD6,20180702
B7701369F8598A25DED0499DAD3BE85D,20180702
A74EFE8BDAC26101B308D57A18B746CF,20180702
920DB84FCC0F4421650B9E257E33180B,20180702
AE920B86560554C0BE3F888EDBA2BBF7,20180702
037DAC225F0C1E54657770CD201CDDA7,20180702
64BA3BB3BD757CE7000D38CB7125E6DA,20180702
E50F7AC0680FD87AD6CE6B6700D209A7,20180702
7D613AF4DA0F508C7090E96FD73B7E6D,20180702
C795AFA7F574C2BB09D3647AD90A9719,20180702
936906C2CB90CE437DBFC01BBD96BA39,20180702
FEDC59699D8832A11B88BFCCCAD0951D,20180702
Query:
SELECT
     COUNT(DISTINCT user_pseudo_id) AS total_new_users
   FROM
     `firebase-public-project.analytics_153293282.events_*`
   WHERE
     _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
     AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08';
Answer:
total_new_users
222
Query:
SELECT
     event_name,
     COUNT(*) AS event_count
   FROM
     `firebase-public-project.analytics_153293282.events_20180702`
   GROUP BY
     event_name
   ORDER BY
     event_count DESC
   LIMIT 100;
Answer:
event_name,event_count
screen_view,20378
user_engagement,11605
level_start_quickplay,4493
level_end_quickplay,3068
post_score,2144
level_complete_quickplay,1896
level_fail_quickplay,1173
select_content,942
level_reset_quickplay,916
session_start,621
level_start,560
level_end,396
level_retry_quickplay,387
level_retry,357
level_up,248
level_complete,229
level_fail,148
spend_virtual_currency,85
level_reset,72
use_extra_steps,55
app_exception,54
firebase_campaign,38
first_open,27
no_more_extra_steps,22
os_update,19
ad_reward,18
error,15
app_remove,13
completed_5_levels,11
app_update,8
challenge_a_friend,1
app_clear_data,1
Query:
SELECT
     event_date,
     COUNT(*) AS event_count
   FROM
     `firebase-public-project.analytics_153293282.events_*`
   WHERE
     _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
   GROUP BY
     event_date
   ORDER BY
     event_date
   LIMIT 100;
Answer:
event_date,event_count
20180702,50000
20180703,50000
20180704,50000
20180705,50000
20180706,50000
20180707,50000
20180708,50000
Query:
SELECT
     user_pseudo_id,
     TIMESTAMP_MICROS(user_first_touch_timestamp) AS first_touch_time
   FROM
     `firebase-public-project.analytics_153293282.events_*`
   LIMIT 100;
Answer:
user_pseudo_id,first_touch_time
486D0900B48B18D315367260129BFFB6,2018-09-17 15:59:58.402000+00:00
45FB547C5857493104687C234EDCDE37,2018-08-06 06:39:24.982000+00:00
45FB547C5857493104687C234EDCDE37,2018-08-06 06:39:24.982000+00:00
45FB547C5857493104687C234EDCDE37,2018-08-06 06:39:24.982000+00:00
45FB547C5857493104687C234EDCDE37,2018-08-06 06:39:24.982000+00:00
45FB547C5857493104687C234EDCDE37,2018-08-06 06:39:24.982000+00:00
45FB547C5857493104687C234EDCDE37,2018-08-06 06:39:24.982000+00:00
45FB547C5857493104687C234EDCDE37,2018-08-06 06:39:24.982000+00:00
45FB547C5857493104687C234EDCDE37,2018-08-06 06:39:24.982000+00:00
45FB547C5857493104687C234EDCDE37,2018-08-06 06:39:24.982000+00:00
45FB547C5857493104687C234EDCDE37,2018-08-06 06:39:24.982000+00:00
45FB547C5857493104687C234EDCDE37,2018-08-06 06:39:24.982000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
B390E09582A6DEF9545267A37C78B809,2016-06-21 05:17:13.813000+00:00
A2616A0876190B8C349DE35A9AF631B9,2018-08-31 19:49:38.623000+00:00
A2616A0876190B8C349DE35A9AF631B9,2018-08-31 19:49:38.623000+00:00
A2616A0876190B8C349DE35A9AF631B9,2018-08-31 19:49:38.623000+00:00
A2616A0876190B8C349DE35A9AF631B9,2018-08-31 19:49:38.623000+00:00
A2616A0876190B8C349DE35A9AF631B9,2018-08-31 19:49:38.623000+00:00
A2616A0876190B8C349DE35A9AF631B9,2018-08-31 19:49:38.623000+00:00
Query:
SELECT DISTINCT
     user_pseudo_id
   FROM
     `firebase-public-project.analytics_153293282.events_*`
   WHERE
     _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
   LIMIT 100;
Answer:
user_pseudo_id
654F30C1312F6C1A26DFDA9F076A62D8
65D7715C409E6A38667447CE2B52AFFE
B205B117C82A24AA95E663FFB7D04718
EF9E8CCCCBBB015CAE0C334AB1745417
83D8C7F90DAF2C832F05A9DDD8693135
093642BD46204EB5F950303CE696BC18
0F67E233B19D2898229CD156974A93AE
5217AB1A454DAED6243E1C9818BE6A20
C6EAD483A8AF7EE9B0ADE6D7CE5DD698
58230465C695B0FDDDAE08A481FAEECC
38D4084307B6D1CEA37A48981753428E
0373DF7959F6867CDFB1C905D39CE67C
5D5895B1267014C54ECBE08864420979
D34924C19421D7E083FD387D97765F94
C136A7CE1D0A52B8D4E5F144DF114EB7
49309C5759610DBF6C829C0D4AB23943
92B0B6F48ECE132C7E502F94798FE205
4BF98D09CA8359FC59ADAF56D00338F8
08D399C66188D9A356AFAD5E2B2BA45E
909A16079F7183140ACF4C71A6CCDF3D
3031EAD1E9D35306A37A0F3DC3B84A0A
05407E04B9FA64CB63D8FA1D966AD6A2
3A58859E074B02E8FB1CAEA291636112
5CDFC86835249BE3DB5E9F6778E344AD
706C748E6D1E0768BFEFE6362B5D3F67
F815B0069F973BFA743EF90A85224109
D0F280B12652EB0D74F6BC74AB13606F
4D084D38156128AAA060303AA91E689D
3EF8FC940E379D53BBD3FEFDAF626BB2
DE4912FBC5F915C027000A8A6FF44F85
E6FEE8B98E75EA5311FE004F98559A27
E2D6E7FE36B7CDD0789CC8F03CC747E0
48AB910A8DE8485D4C34238EA61F782C
50FEAE9ECFE22E951E8810622A2E8F66
4A47422A455E62E3529DE4F9F3BFAF66
2F5B044B41268F6643EB4D0EF15D4E87
E8710E77072D6674A93E46DFEF725587
7101B4232F5B26A9C987C54F8717DCDC
4948BEDE78FC6EBA9899F26BF5C53897
88A41BFED275BB69125BE1F5524F3B42
A064A84CD3CF7058F39333D6212E8615
A87A30159D909E2356F72AAC76F26707
7842C62D45ECE888132F21C9F4417B21
672B24B51143CC66DCBAA0FA88C38D57
7AE4084BAA29B1987E51BF2964646805
2F8E2DBB938D2E43C2D171AF5F35EEF8
29845B6298FB882DF53607D21F0E1DF7
76BB576278338D2E508DE5D705241B47
92BF054A90804B6D65F11D7CDFCDDEFC
7207044281C74501C14233463AAD9A71
4BDC831A6940071E2461D0B5293A329E
3DEB0C12C49AD19D7ACE68FA59E7ACD6
B7701369F8598A25DED0499DAD3BE85D
A74EFE8BDAC26101B308D57A18B746CF
920DB84FCC0F4421650B9E257E33180B
AE920B86560554C0BE3F888EDBA2BBF7
037DAC225F0C1E54657770CD201CDDA7
64BA3BB3BD757CE7000D38CB7125E6DA
E50F7AC0680FD87AD6CE6B6700D209A7
7D613AF4DA0F508C7090E96FD73B7E6D
C795AFA7F574C2BB09D3647AD90A9719
936906C2CB90CE437DBFC01BBD96BA39
FEDC59699D8832A11B88BFCCCAD0951D
D7EA8E3645EFFBD6443946179ED704A6
59454BAC415BB1F18517C6FD2C023E49
27859DA5E38F4C681DA4FBF0CFB9F306
E451D416F972019604F1456533FF3858
60CFF65B640769B6FD3BC9593EDF7C1D
AFE7A3E11C66E71FA9EA7B138700EC44
5E694DE02688C2FDDEA38A6946A4CC3F
B75F91EB6C7FDA9A329567E763CF9E44
D739D483CCD20D4651E4A75ADEE94064
53866E32BA0ABFD846772D4B7B9B5921
7480AE90D76538F44A066A153F448198
8EDB9A9856CDB5AFC42546106EE46734
3EDE8E7A50DE76AA2EC12DDD2AE3F9F4
257A35EA0A92B4B2F8FB4BA3F8B4C3D8
60FAC27D8495BF33C2AE5283A7B07005
84D135997D8A4D9CB35D4ECA46EF6861
EBFE0623EF1109A89B392B9DF4375951
11A8D6037368A4C4508B11ADB4353BC4
CA04708DA02378999ECB402481FF1AE4
664F913ED3B54941B5F0886D94E01623
C87CDC0C4F86B10B7467281D516929B5
2F5BBABE9DD0271DCD62E501F76DA736
028CAE01A9F16A228177C973451441A1
4CE503AE5B4C4F67A00474CE380CCC39
3D03A380687FE3369E93915D50C572CB
4DA8863CD8D2C860F6BB73579BC6F5C9
EA9A16D9042286D55399A418CC7A28F3
117AD1627465CC9E03AB5D8825D42E07
D3F06F9B7BD9D7FC8758BF78BF0705E9
8040FC9C0479C3B9A74ED298DD8F357D
Query:
SELECT
     user_pseudo_id,
     COUNT(*) AS event_count
   FROM
     `firebase-public-project.analytics_153293282.events_*`
   WHERE
     _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
   GROUP BY
     user_pseudo_id
   ORDER BY
     event_count DESC
   LIMIT 100;
Answer:
user_pseudo_id,event_count
2F74E23BEA1E45E3897274EE4903DCC5,8525
56B9CBB6CB58106DCCF3CAD660232CB2,8093
CC88655DF7CDE5E8225BA20B5D6EC59B,7997
B63075B53A750A67A12F7F19ED5AA835,7756
05FB3382D94C7E963B408FD6CC357D33,5522
58F3D672BBC613680624015D5BC3ADDB,5464
10B0D468B5E036E16D13DB53A65F2D49,5293
3DEB0C12C49AD19D7ACE68FA59E7ACD6,5158
39A0592805168E5D5B3C3687A7472628,4830
8040FC9C0479C3B9A74ED298DD8F357D,4747
5217AB1A454DAED6243E1C9818BE6A20,4682
5E93E43C911DE1ECEA0A7C50390C57A9,4163
D4F4DAEF5BE38E5C67FD72BB1F082EBF,3750
22DC6A6AE86C0AA33EBB8C3164A26925,3325
CABE7E24215A5C36862658A36AE5CE12,3275
4D33ED6DCCD63BBED146B6060B307CAF,3146
12E5626928FE0885DEEF068683E8BD63,3132
EBFE0623EF1109A89B392B9DF4375951,2789
EF500E0CF578004836D1D38C8901862B,2784
472451071AED6FF801BC0FE66706FD27,2719
0CAAA1B6F161BA4D363EB7A2DEF64A08,2650
3875A92B5F5C2BBA1355CED06A986079,2594
DF0E6C6C5E4F3F34FEC6EE54FD945B05,2564
370CDFEE49990E4A9A1FBC0DC5C31C1C,2521
8BE7BF90C971453A34C1FF6FF2A0ACAE,2506
1B3AD9683D475EFB398E131DFE65AE61,2506
0D17D0247F158FA3E40D21EFF46D1651,2498
FFA9AE78B23263835F8AAED57713EBE9,2485
66E8EE325A3E6369E607998DFE9E13F1,2425
53A5A4C271525BAA74298747E100C376,2375
EFBDEC168A2BF8C727B060B2E231724E,2348
8F6C5F7611B67A4A437FF283B6C10181,2344
74375465CD17299EBC7C75A1B4047EE0,2317
004D2DFEB866BFB00427DB2F530C1F3D,2244
31D7BB4CF721D8676B85F73077F4304E,2189
03A9D32C44665A9E15CFCCEDC9F68EDB,2161
C8685B0DFA2C4B4E6E6EA72894C30F6F,2145
C74B58C4CD2770A1E97D6DC13D42CCAC,2071
56E8EC9522573BD1BAD8E18AD2E33C9A,2066
42E6A7C3536775E3B8C3DB919AE9A452,1967
48AB910A8DE8485D4C34238EA61F782C,1835
2DB65B29C41328FF8AB9AC27B7C05537,1789
C6DE585349744A40725DB0AB17041BA3,1738
8BD465AC77DC9D8B4C597BF35950FDA3,1713
BE74418BE7B7466F6FE2969CA79FA919,1678
734AC9568F0674F7BBE59D45B5B90EA7,1676
E6FEE8B98E75EA5311FE004F98559A27,1646
DDF187DB0391034487C7D3B8C681E0B0,1613
4EF964D59282E5A2C8692D30F011256B,1463
5E09265F12D64B9FA85FF9427A0A7FB0,1439
FA30269453141794E79B8F15EE0BA5B9,1381
FDA4BBBCF1EA2D95CDD77BFC5F00A837,1369
48C8A04DA2A666406E943C164A94D0B3,1366
B5395F8C2077B59B3D6C5719C0CA0339,1321
1213ED1E96B0A49B51C0F7683DB2ACCC,1282
BBDCBE2491658165B7F20540DE652E3A,1269
0B08423CCD5F1503B5A8B306FFED999C,1244
47216088A078D06F9220263FAF964F10,1229
F5DAD8DD17B689CF672D65A0A81CF4AC,1218
08D399C66188D9A356AFAD5E2B2BA45E,1205
418C1FE4FF01EA36F511E5D9073F11BD,1108
EFB696A82D093B3AFBE92FF526DD5CEA,1080
9B18A1CBA96D52D05CFA7CB7C9011EDE,1059
4193343164266373A13B35D5D04053E2,1057
E53BC2A0AD86417B443AF14EE3082C0F,1050
00D49153E0790E34D76523EEBEF459B2,1040
B78DB4E683651327A612372A48B5734C,1036
Query:
SELECT
  ep.key,
  COALESCE(
    ep.value.string_value,
    CAST(ep.value.int_value AS STRING),
    CAST(ep.value.float_value AS STRING),
    CAST(ep.value.double_value AS STRING)
  ) AS value
FROM
  `firebase-public-project.analytics_153293282.events_20180702`,
  UNNEST(event_params) AS ep
WHERE
  COALESCE(
    ep.value.string_value,
    CAST(ep.value.int_value AS STRING),
    CAST(ep.value.float_value AS STRING),
    CAST(ep.value.double_value AS STRING)
  ) IS NOT NULL
LIMIT 100;
Answer:
key,value
value,22
firebase_screen_class,game_board
firebase_event_origin,app+gtm
firebase_screen_id,-3260873074173490837
board,S
value,22
firebase_screen_class,game_board
firebase_event_origin,app+gtm
firebase_screen_id,8126232848982224228
board,S
value,22
firebase_screen_class,game_board
firebase_event_origin,app+gtm
firebase_screen_id,8126232848982224228
board,S
firebase_conversion,1
firebase_screen_class,game_board
firebase_event_origin,auto
firebase_screen_id,-3260873074173490837
firebase_previous_id,-3260873074173490845
firebase_screen_class,FloodItActivity
firebase_event_origin,auto
firebase_screen_id,-3260873074173490838
firebase_previous_class,main_menu
firebase_previous_id,-3260873074173490838
firebase_screen_class,game_board
firebase_event_origin,auto
firebase_screen_id,-3260873074173490837
firebase_previous_class,FloodItActivity
firebase_previous_id,-3260873074173490837
firebase_screen_class,ExtraStepsActivity
firebase_event_origin,auto
firebase_screen_id,-3260873074173490799
firebase_previous_class,game_board
firebase_previous_id,-3260873074173490799
firebase_screen_class,shop_menu
firebase_event_origin,auto
firebase_screen_id,-3260873074173490798
firebase_previous_class,ExtraStepsActivity
firebase_previous_id,-3260873074173490798
firebase_screen_class,game_board
firebase_event_origin,auto
firebase_screen_id,-3260873074173490837
firebase_previous_class,shop_menu
firebase_previous_id,-3260873074173490837
firebase_screen_class,GameFinishedActivity
firebase_event_origin,auto
firebase_screen_id,-3260873074173490785
firebase_previous_class,game_board
firebase_previous_id,-3260873074173490785
firebase_screen_class,game_over
firebase_event_origin,auto
firebase_screen_id,-3260873074173490784
firebase_previous_class,GameFinishedActivity
firebase_previous_id,-3260873074173490784
firebase_screen_class,game_board
firebase_event_origin,auto
firebase_screen_id,-3260873074173490837
firebase_previous_class,game_over
firebase_previous_id,-3260873074173490837
firebase_screen_class,ExtraStepsActivity
firebase_event_origin,auto
firebase_screen_id,-3260873074173490728
firebase_previous_class,game_board
firebase_previous_id,-3260873074173490728
firebase_screen_class,shop_menu
firebase_event_origin,auto
firebase_screen_id,-3260873074173490727
firebase_previous_class,ExtraStepsActivity
firebase_previous_id,-3260873074173490727
firebase_screen_class,AdActivity
firebase_event_origin,auto
firebase_screen_id,-3260873074173490717
firebase_previous_class,shop_menu
firebase_previous_id,-3260873074173490717
firebase_screen_class,shop_menu
firebase_event_origin,auto
firebase_screen_id,-3260873074173490727
firebase_previous_class,AdActivity
firebase_previous_id,-3260873074173490727
firebase_screen_class,game_board
firebase_event_origin,auto
firebase_screen_id,-3260873074173490837
firebase_previous_class,shop_menu
firebase_previous_id,-3260873074173490837
firebase_screen_class,GameFinishedActivity
firebase_event_origin,auto
firebase_screen_id,-3260873074173490700
firebase_previous_class,game_board
firebase_previous_id,-3260873074173490700
Query:
SELECT
  platform,
  COUNT(*) AS event_count
FROM
  `firebase-public-project.analytics_153293282.events_*`
WHERE
  _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
GROUP BY
  platform
ORDER BY
  event_count DESC
LIMIT 100
Answer:
platform,event_count
ANDROID,239668
IOS,110332
Query:
SELECT
  device.category,
  device.mobile_brand_name,
  device.mobile_model_name
FROM
  `firebase-public-project.analytics_153293282.events_20180702`
LIMIT 100
Answer:
category,mobile_brand_name,mobile_model_name
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
mobile,not available in demo dataset,not available in demo dataset
Query:
SELECT DISTINCT
  e1.user_pseudo_id
FROM
  `firebase-public-project.analytics_153293282.events_*` AS e1
WHERE
  _TABLE_SUFFIX BETWEEN '20180709' AND '20180715'
  AND e1.user_pseudo_id IN (
    SELECT DISTINCT
      user_pseudo_id
    FROM
      `firebase-public-project.analytics_153293282.events_*`
    WHERE
      _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
      AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08'
  )
LIMIT 100
Answer:
user_pseudo_id
295D9E24D8DE65A010313E667131EF19
5256B2B115955E80DDB7449775D92325
E2372AFD5CBA85F1395201FB687AEC46
08F14F3BCA030F81B447161BA8653B44
FD9223BA1689E43F814C545A5FEBA7F4
370CDFEE49990E4A9A1FBC0DC5C31C1C
4109514A07FD2A10C61DA26ED8F826CA
9FEE80E475ED50AAF174B4F17563C16D
C74B58C4CD2770A1E97D6DC13D42CCAC
0160043392B1572A375E5C3BE1BB0C31
48D0C822ACA6BD0B5FBA8ECD27CBB247
D7D49CC32C4A23AD56E8DEAE6878EC7B
8BE7BF90C971453A34C1FF6FF2A0ACAE
077BC7302275F4E34731C2780C166C02
159002C6F393752AD79B3C2E8C7104C7
E4C074EBC3729FB45CFA48D9F6EA4DFD
FCA08F9B0DCB6E33A74F672CE7F73BE3
B179C315ED033642C37F45179C9E0B13
22DC6A6AE86C0AA33EBB8C3164A26925
75C683C1AE98FC6CCE6EA156C9E90A35
9B27F8491DC5DA23D369F31250BD8D65
7537C0AA6291AC7B99DC4D2D695EEF1D
6DC90DD09DF860E7C60C00BF36906CB3
2920B9D90561E521425DE4849FAAD1D7
AD4F00389084ECC4B5362689C228EB0F
FA5EFC7F0862BE935CF3C0BCCE5C38F1
F92B2FB00F381010F8895FDFB47A8331
E8755950FCC0CDF1F62E9024153DD624
28E44B5D5095EF494073AC47353F64C9
07A6B44E67F46615D8569A26774E5C33
3FFB1DF94D148994075041E8643DD788
DA534A42414330FBADC1AE6777F86EB5
4A81FE8E75C780C97EEE73A7574F0B4F
FFA9AE78B23263835F8AAED57713EBE9
09CAEE95CE99F27D00EA630EEDBCECA2
78B5D31EFEA7F4689CEB2CF7A9E4C4E5
461EEAF2B9223AE1D44C0E8DCE64876C
E09BE20A9F0680A1E1EB51633DF0D0AD
A0D023B78197471C25961C29691BEF85
CF06C47EAD622F909BFCC83FF4D0ECE8
0D6A346C85BF606BE12F9A70FC20A7B7
50D8D0C89D69EDAE2F04E43E90DB59C1
88E6D3D4433BA2B424A6D5D23A871B97
FAC23931821B151AD13B4E7B3CA3987B
051F80A715267A0035D626F7EB86ABBD
E9B5EC78F1F4D6F90B5AFB34D09697F2
52EF42933AD38302C75702C3D38BFFAE
3E8023DB1D342304C2D6BD56705C4687
FB581F2AC74E08CD38CCAAA9A99F0217
7ED4165854463C38F1D739A2014001D9
3D01D6221D54D40DC42C3D6FBCCEC926
A51128E8CFDD686155CB07E35B410A57
669EC0276AC761CB67555E361C534C6A
4BF45CB17DDBF06D87F4002632E0A1BC
Query:
SELECT
  COUNT(DISTINCT e1.user_pseudo_id) AS retained_users_week1
FROM
  `firebase-public-project.analytics_153293282.events_*` AS e1
WHERE
  _TABLE_SUFFIX BETWEEN '20180709' AND '20180715'
  AND e1.user_pseudo_id IN (
    SELECT DISTINCT
      user_pseudo_id
    FROM
      `firebase-public-project.analytics_153293282.events_*`
    WHERE
      _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
      AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08'
  )
Answer:
retained_users_week1
54
Query:
SELECT
  e1.event_name,
  COUNT(*) AS event_count
FROM
  `firebase-public-project.analytics_153293282.events_*` AS e1
WHERE
  _TABLE_SUFFIX BETWEEN '20180709' AND '20180715'
  AND e1.user_pseudo_id IN (
    SELECT DISTINCT
      user_pseudo_id
    FROM
      `firebase-public-project.analytics_153293282.events_*`
    WHERE
      _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
      AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08'
  )
GROUP BY
  e1.event_name
ORDER BY
  event_count DESC
LIMIT 100
Answer:
event_name,event_count
screen_view,8724
user_engagement,5049
level_start_quickplay,1113
level_end_quickplay,1009
post_score,680
level_start,585
level_fail_quickplay,518
level_complete_quickplay,491
level_end,479
level_retry,435
select_content,295
level_fail,290
level_up,189
level_complete,165
session_start,144
level_retry_quickplay,110
level_reset,59
level_reset_quickplay,38
use_extra_steps,13
spend_virtual_currency,13
app_exception,8
no_more_extra_steps,5
completed_5_levels,5
ad_reward,4
app_remove,3
challenge_a_friend,2
Query:
SELECT
  up.key,
  COALESCE(
    up.value.string_value,
    CAST(up.value.int_value AS STRING),
    CAST(up.value.float_value AS STRING),
    CAST(up.value.double_value AS STRING)
  ) AS value
FROM (
  SELECT
    user_pseudo_id,
    user_properties
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
    AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08'
), UNNEST(user_properties) AS up
LIMIT 100
Answer:
key,value
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
plays_quickplay,true
num_levels_available,30
plays_progressive,true
firebase_exp_1,1
first_open_time,1530584740063000
ad_frequency,2
initial_extra_steps,5
Query:
SELECT
  week,
  COUNT(DISTINCT user_pseudo_id) AS retained_users
FROM (
  SELECT
    user_pseudo_id,
    CASE
      WHEN event_date BETWEEN '20180702' AND '20180708' THEN 'Week0'
      WHEN event_date BETWEEN '20180709' AND '20180715' THEN 'Week1'
      WHEN event_date BETWEEN '20180716' AND '20180722' THEN 'Week2'
      WHEN event_date BETWEEN '20180723' AND '20180729' THEN 'Week3'
      WHEN event_date BETWEEN '20180730' AND '20180805' THEN 'Week4'
      ELSE 'Other'
    END AS week
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    _TABLE_SUFFIX BETWEEN '20180702' AND '20180805'
    AND user_pseudo_id IN (
      SELECT DISTINCT
        user_pseudo_id
      FROM
        `firebase-public-project.analytics_153293282.events_*`
      WHERE
        _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
        AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08'
    )
)
WHERE
  week IN ('Week0', 'Week1', 'Week2', 'Week3', 'Week4')
GROUP BY
  week
ORDER BY
  week
LIMIT 100
Answer:
week,retained_users
Week0,222
Week1,54
Week2,37
Week3,35
Week4,15
Query:
SELECT
  week,
  COUNT(*) AS total_events
FROM (
  SELECT
    CASE
      WHEN event_date BETWEEN '20180702' AND '20180708' THEN 'Week0'
      WHEN event_date BETWEEN '20180709' AND '20180715' THEN 'Week1'
      WHEN event_date BETWEEN '20180716' AND '20180722' THEN 'Week2'
      WHEN event_date BETWEEN '20180723' AND '20180729' THEN 'Week3'
      WHEN event_date BETWEEN '20180730' AND '20180805' THEN 'Week4'
      ELSE 'Other'
    END AS week
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    _TABLE_SUFFIX BETWEEN '20180702' AND '20180805'
    AND user_pseudo_id IN (
      SELECT DISTINCT
        user_pseudo_id
      FROM
        `firebase-public-project.analytics_153293282.events_*`
      WHERE
        _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
        AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08'
    )
)
WHERE
  week IN ('Week0', 'Week1', 'Week2', 'Week3', 'Week4')
GROUP BY
  week
ORDER BY
  week
LIMIT 100
Answer:
week,total_events
Week0,43961
Week1,20426
Week2,15120
Week3,11727
Week4,9681
Query:
SELECT
  event_name,
  COUNT(*) AS event_count
FROM
  `firebase-public-project.analytics_153293282.events_*`
WHERE
  _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
  AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08'
GROUP BY
  event_name
ORDER BY
  event_count DESC
LIMIT 100
Answer:
event_name,event_count
screen_view,17682
user_engagement,10603
level_start,1817
level_start_quickplay,1811
post_score,1536
level_end,1425
level_end_quickplay,1341
level_retry,1244
level_up,939
select_content,929
level_complete,808
level_fail_quickplay,744
level_complete_quickplay,597
level_fail,486
session_start,386
level_reset_quickplay,288
firebase_campaign,274
spend_virtual_currency,210
first_open,196
level_reset,193
level_retry_quickplay,133
use_extra_steps,101
completed_5_levels,63
no_more_extra_steps,47
app_remove,44
app_exception,26
ad_reward,14
challenge_a_friend,8
error,8
app_update,4
os_update,3
dynamic_link_first_open,1
Query:
SELECT
  geo.continent,
  geo.country,
  geo.region,
  geo.city,
  COUNT(DISTINCT user_pseudo_id) AS user_count
FROM
  `firebase-public-project.analytics_153293282.events_*`
WHERE
  _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
  AND DATE(TIMESTAMP_MICROS(user_first_touch_timestamp)) BETWEEN '2018-07-02' AND '2018-07-08'
GROUP BY
  geo.continent,
  geo.country,
  geo.region,
  geo.city
ORDER BY
  user_count DESC
LIMIT 100
Answer:
continent,country,region,city,user_count
Americas,United States,,,95
Asia,India,,,23
Americas,Canada,,,12
Europe,United Kingdom,,,12
Oceania,Australia,,,8
Asia,Japan,,,5
Asia,Pakistan,,,5
Asia,Vietnam,,,5
Americas,Brazil,,,4
Asia,United Arab Emirates,,,4
Africa,Egypt,,,3
Americas,United States,Texas,Dallas,3
Americas,Colombia,,,3
Europe,Germany,,,3
Asia,Philippines,,,3
Oceania,New Zealand,,,3
Americas,United States,Washington,Seattle,2
Asia,China,,,2
Oceania,Australia,New South Wales,Sydney,2
Asia,Saudi Arabia,,,2
Africa,South Africa,,,2
Americas,Mexico,,,2
Europe,Netherlands,,,2
Americas,United States,Illinois,Chicago,2
Europe,Latvia,,,1
Asia,Jordan,,,1
Asia,Singapore,,,1
Americas,Ecuador,,,1
Asia,Nepal,,,1
Asia,Bangladesh,,,1
Africa,Zambia,,,1
Asia,Bangladesh,,,1
Asia,Indonesia,,,1
Africa,Zimbabwe,,,1
Americas,United States,New York,New York,1
Africa,Zambia,,,1
Africa,Uganda,,,1
Asia,Hong Kong,,,1
Europe,Italy,,,1
Europe,Ireland,,,1
Africa,Tunisia,,,1
Americas,Argentina,,,1
Asia,Taiwan,,,1
Query:
SELECT
  event_name,
  COUNT(*) AS event_count
FROM
  `firebase-public-project.analytics_153293282.events_*`
WHERE
  _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
GROUP BY
  event_name
ORDER BY
  event_count DESC
LIMIT 100;
Answer:
event_name,event_count
screen_view,142638
user_engagement,81342
level_start_quickplay,31311
level_end_quickplay,21742
post_score,15470
level_complete_quickplay,13522
level_fail_quickplay,8220
level_reset_quickplay,6486
select_content,6347
level_start,4013
session_start,4010
level_end,2947
level_retry,2444
level_up,1948
level_retry_quickplay,1925
level_complete,1591
level_fail,1000
spend_virtual_currency,536
level_reset,422
use_extra_steps,380
app_exception,376
firebase_campaign,314
first_open,205
no_more_extra_steps,150
os_update,141
app_remove,132
completed_5_levels,108
ad_reward,101
app_update,90
error,62
challenge_a_friend,20
dynamic_link_app_open,3
app_clear_data,2
challenge_accepted,1
dynamic_link_first_open,1
Query:
SELECT
  up.key,
  COALESCE(
    up.value.string_value,
    CAST(up.value.int_value AS STRING),
    CAST(up.value.float_value AS STRING),
    CAST(up.value.double_value AS STRING)
  ) AS value
FROM (
  SELECT
    user_pseudo_id,
    user_properties
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
), UNNEST(user_properties) AS up
LIMIT 100
Answer:
key,value
plays_quickplay,true
num_levels_available,30
firebase_last_notification,4857993083614758445
firebase_exp_4,1
plays_progressive,true
firebase_exp_1,0
first_open_time,1476908354977000
ad_frequency,2
initial_extra_steps,3
plays_quickplay,true
num_levels_available,30
firebase_last_notification,2902228027551633195
plays_progressive,true
firebase_exp_1,1
first_open_time,1469220942645000
ad_frequency,2
initial_extra_steps,20
plays_quickplay,true
num_levels_available,30
firebase_last_notification,2902228027551633195
plays_progressive,true
firebase_exp_1,1
first_open_time,1469220942645000
ad_frequency,2
initial_extra_steps,20
plays_quickplay,true
num_levels_available,30
firebase_last_notification,2902228027551633195
plays_progressive,true
firebase_exp_1,1
first_open_time,1469220942645000
ad_frequency,2
initial_extra_steps,20
plays_quickplay,true
num_levels_available,30
firebase_last_notification,2902228027551633195
plays_progressive,true
firebase_exp_1,1
first_open_time,1469220942645000
ad_frequency,2
initial_extra_steps,20
plays_quickplay,true
num_levels_available,30
firebase_last_notification,2902228027551633195
plays_progressive,true
firebase_exp_1,1
first_open_time,1469220942645000
ad_frequency,2
initial_extra_steps,20
plays_quickplay,true
num_levels_available,30
firebase_last_notification,2902228027551633195
plays_progressive,true
firebase_exp_1,1
first_open_time,1469220942645000
ad_frequency,2
initial_extra_steps,20
plays_quickplay,true
num_levels_available,30
firebase_last_notification,2902228027551633195
plays_progressive,true
firebase_exp_1,1
first_open_time,1469220942645000
ad_frequency,2
initial_extra_steps,20
plays_quickplay,true
num_levels_available,30
firebase_last_notification,2902228027551633195
plays_progressive,true
firebase_exp_1,1
first_open_time,1469220942645000
ad_frequency,2
initial_extra_steps,20
plays_quickplay,true
num_levels_available,30
firebase_last_notification,2902228027551633195
plays_progressive,true
firebase_exp_1,1
first_open_time,1469220942645000
ad_frequency,2
initial_extra_steps,20
plays_quickplay,true
num_levels_available,30
firebase_last_notification,2902228027551633195
plays_progressive,true
firebase_exp_1,1
first_open_time,1469220942645000
ad_frequency,2
initial_extra_steps,20
plays_quickplay,true
num_levels_available,30
firebase_last_notification,2902228027551633195
plays_progressive,true
firebase_exp_1,1
first_open_time,1469220942645000
ad_frequency,2
initial_extra_steps,20
plays_quickplay,true
num_levels_available,30
firebase_last_notification,2902228027551633195
Query:
SELECT
  event_name,
  COUNT(*) AS event_count
FROM
  `firebase-public-project.analytics_153293282.events_*`
WHERE
  _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
GROUP BY
  event_name
ORDER BY
  event_count DESC
LIMIT 100
Answer:
event_name,event_count
screen_view,142638
user_engagement,81342
level_start_quickplay,31311
level_end_quickplay,21742
post_score,15470
level_complete_quickplay,13522
level_fail_quickplay,8220
level_reset_quickplay,6486
select_content,6347
level_start,4013
session_start,4010
level_end,2947
level_retry,2444
level_up,1948
level_retry_quickplay,1925
level_complete,1591
level_fail,1000
spend_virtual_currency,536
level_reset,422
use_extra_steps,380
app_exception,376
firebase_campaign,314
first_open,205
no_more_extra_steps,150
os_update,141
app_remove,132
completed_5_levels,108
ad_reward,101
app_update,90
error,62
challenge_a_friend,20
dynamic_link_app_open,3
app_clear_data,2
challenge_accepted,1
dynamic_link_first_open,1
Query:
SELECT
  geo.continent,
  geo.country,
  geo.region,
  geo.city,
  COUNT(DISTINCT user_pseudo_id) AS user_count
FROM
  `firebase-public-project.analytics_153293282.events_*`
WHERE
  _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
GROUP BY
  geo.continent,
  geo.country,
  geo.region,
  geo.city
ORDER BY
  user_count DESC
LIMIT 100
Answer:
continent,country,region,city,user_count
Americas,United States,,,934
Europe,United Kingdom,,,70
Americas,Canada,,,67
Asia,India,,,56
Oceania,Australia,,,54
Asia,Japan,,,53
Europe,Germany,,,37
Americas,United States,Texas,Dallas,23
Americas,Mexico,,,22
Europe,France,,,21
Americas,United States,New York,New York,20
Americas,Brazil,,,19
Americas,United States,Illinois,Chicago,18
Asia,Pakistan,,,18
Americas,United States,Washington,Seattle,16
Europe,Netherlands,,,13
Europe,Spain,,,12
Oceania,New Zealand,,,10
Asia,China,,,8
Europe,Sweden,,,8
Europe,Austria,,,7
Asia,Indonesia,,,7
Oceania,Australia,New South Wales,Sydney,7
Asia,United Arab Emirates,,,7
Africa,South Africa,,,7
Asia,Philippines,,,7
Americas,United States,Georgia,Atlanta,6
Asia,Vietnam,,,6
Asia,Saudi Arabia,,,5
Africa,Egypt,,,5
Americas,United States,California,Los Angeles,5
Asia,Israel,,,5
Asia,Turkey,,,4
Americas,Colombia,,,4
Asia,Hong Kong,,,4
Europe,Belgium,,,4
Asia,Taiwan,,,4
Europe,Russia,,,4
Asia,Thailand,,,4
Asia,Jordan,,,3
Asia,Lebanon,,,3
Africa,Tunisia,,,3
Europe,Poland,,,3
Americas,Argentina,,,3
Asia,Bangladesh,,,3
Africa,Algeria,,,2
Asia,Singapore,,,2
Americas,Chile,,,2
Europe,Ireland,,,2
Europe,Romania,,,2
Africa,Zimbabwe,,,2
Europe,Italy,,,2
Americas,Dominican Republic,,,2
Query:
SELECT
  e.event_name,
  ep.key AS param_key,
  COALESCE(
    ep.value.string_value,
    CAST(ep.value.int_value AS STRING),
    CAST(ep.value.float_value AS STRING),
    CAST(ep.value.double_value AS STRING)
  ) AS param_value
FROM
  `firebase-public-project.analytics_153293282.events_*` AS e,
  UNNEST(e.event_params) AS ep
WHERE
  _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
  AND e.event_name = 'spend_virtual_currency'
LIMIT 100;
Answer:
event_name,param_key,param_value
spend_virtual_currency,virtual_currency_name,steps
spend_virtual_currency,firebase_screen_class,game_board
spend_virtual_currency,item_name,0
spend_virtual_currency,firebase_event_origin,app+gtm
spend_virtual_currency,value,3
spend_virtual_currency,firebase_screen_id,2875908802993843912
spend_virtual_currency,virtual_currency_name,steps
spend_virtual_currency,firebase_screen_class,game_board
spend_virtual_currency,item_name,0
spend_virtual_currency,firebase_event_origin,app+gtm
spend_virtual_currency,value,1
spend_virtual_currency,firebase_screen_id,-5355191908706758779
spend_virtual_currency,virtual_currency_name,steps
spend_virtual_currency,firebase_screen_class,game_board
spend_virtual_currency,item_name,27
spend_virtual_currency,firebase_event_origin,app+gtm
spend_virtual_currency,value,3
spend_virtual_currency,firebase_screen_id,-8937516193509133143
spend_virtual_currency,virtual_currency_name,steps
spend_virtual_currency,firebase_screen_class,game_board
spend_virtual_currency,item_name,27
spend_virtual_currency,firebase_event_origin,app+gtm
spend_virtual_currency,value,3
spend_virtual_currency,firebase_screen_id,-8937516193509133143
spend_virtual_currency,virtual_currency_name,steps
spend_virtual_currency,firebase_screen_class,game_board
spend_virtual_currency,item_name,27
spend_virtual_currency,firebase_event_origin,app+gtm
spend_virtual_currency,value,3
spend_virtual_currency,firebase_screen_id,-8937516193509133143
spend_virtual_currency,virtual_currency_name,steps
spend_virtual_currency,firebase_screen_class,game_board
spend_virtual_currency,item_name,27
spend_virtual_currency,firebase_event_origin,app+gtm
spend_virtual_currency,value,1
spend_virtual_currency,firebase_screen_id,-8937516193509133143
spend_virtual_currency,virtual_currency_name,steps
spend_virtual_currency,firebase_screen_class,game_board
spend_virtual_currency,item_name,0
spend_virtual_currency,firebase_event_origin,app+gtm
spend_virtual_currency,value,2
spend_virtual_currency,firebase_screen_id,-6379018998194245772
spend_virtual_currency,virtual_currency_name,steps
spend_virtual_currency,firebase_screen_class,game_board
spend_virtual_currency,item_name,0
spend_virtual_currency,firebase_event_origin,app+gtm
spend_virtual_currency,value,1
spend_virtual_currency,firebase_screen_id,-6379018998194245772
spend_virtual_currency,virtual_currency_name,steps
spend_virtual_currency,firebase_screen_class,game_board
spend_virtual_currency,item_name,0
Query:
SELECT
  e.event_name,
  ep.key AS param_key,
  COALESCE(
    ep.value.string_value,
    CAST(ep.value.int_value AS STRING),
    CAST(ep.value.float_value AS STRING),
    CAST(ep.value.double_value AS STRING)
  ) AS param_value
FROM
  `firebase-public-project.analytics_153293282.events_*` AS e,
  UNNEST(e.event_params) AS ep
WHERE
  _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
LIMIT 100;
Answer:
event_name,param_key,param_value
level_complete_quickplay,value,22
level_complete_quickplay,firebase_screen_class,game_board
level_complete_quickplay,firebase_event_origin,app+gtm
level_complete_quickplay,firebase_screen_id,-6439668580712960495
level_complete_quickplay,board,S
level_complete_quickplay,value,22
level_complete_quickplay,firebase_screen_class,game_board
level_complete_quickplay,firebase_event_origin,app+gtm
level_complete_quickplay,firebase_screen_id,7012838875361052825
level_complete_quickplay,board,S
level_complete_quickplay,value,21
level_complete_quickplay,firebase_screen_class,game_board
level_complete_quickplay,firebase_event_origin,app+gtm
level_complete_quickplay,firebase_screen_id,-860441632611151047
level_complete_quickplay,board,S
level_complete_quickplay,value,18
level_complete_quickplay,firebase_screen_class,game_board
level_complete_quickplay,firebase_event_origin,app+gtm
level_complete_quickplay,firebase_screen_id,-860441632611151047
level_complete_quickplay,board,S
screen_view,firebase_previous_id,-6439668580712960502
screen_view,firebase_screen_class,main_menu
screen_view,firebase_event_origin,auto
screen_view,firebase_screen_id,-6439668580712960501
screen_view,firebase_previous_class,MainMenuActivity
screen_view,firebase_previous_id,-6439668580712960501
screen_view,firebase_screen_class,FloodItActivity
screen_view,firebase_event_origin,auto
screen_view,firebase_screen_id,-6439668580712960496
screen_view,firebase_previous_class,main_menu
screen_view,firebase_previous_id,-6439668580712960496
screen_view,firebase_screen_class,game_board
screen_view,firebase_event_origin,auto
screen_view,firebase_screen_id,-6439668580712960495
screen_view,firebase_previous_class,FloodItActivity
screen_view,firebase_previous_id,-6439668580712960495
screen_view,firebase_screen_class,ExtraStepsActivity
screen_view,firebase_event_origin,auto
screen_view,firebase_screen_id,-6439668580712960481
screen_view,firebase_previous_class,game_board
screen_view,firebase_previous_id,-6439668580712960481
screen_view,firebase_screen_class,shop_menu
screen_view,firebase_event_origin,auto
screen_view,firebase_screen_id,-6439668580712960480
screen_view,firebase_previous_class,ExtraStepsActivity
screen_view,firebase_previous_id,-6439668580712960480
screen_view,firebase_screen_class,game_board
screen_view,firebase_event_origin,auto
screen_view,firebase_screen_id,-6439668580712960495
screen_view,firebase_previous_class,shop_menu
screen_view,firebase_previous_id,-6439668580712960495
Query:
SELECT
  geo.continent,
  geo.country,
  COUNT(DISTINCT user_pseudo_id) AS user_count
FROM
  `firebase-public-project.analytics_153293282.events_*`
WHERE
  _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
  AND geo.continent IS NOT NULL
GROUP BY
  geo.continent,
  geo.country
ORDER BY
  user_count DESC
LIMIT 100
Answer:
continent,country,user_count
Americas,United States,1001
Europe,United Kingdom,70
Americas,Canada,67
Oceania,Australia,56
Asia,India,56
Asia,Japan,53
Europe,Germany,37
Americas,Mexico,22
Europe,France,21
Americas,Brazil,19
Asia,Pakistan,18
Europe,Spain,13
Europe,Netherlands,13
Oceania,New Zealand,10
Europe,Sweden,8
Asia,China,8
Asia,Philippines,7
Africa,South Africa,7
Asia,United Arab Emirates,7
Europe,Austria,7
Asia,Indonesia,7
Asia,Vietnam,6
Asia,Israel,5
Africa,Egypt,5
Asia,Saudi Arabia,5
Asia,Taiwan,4
Asia,Hong Kong,4
Americas,Colombia,4
Asia,Turkey,4
Europe,Belgium,4
Asia,Thailand,4
Asia,Bangladesh,4
Europe,Russia,4
Africa,Tunisia,3
Asia,Jordan,3
Asia,Lebanon,3
Europe,Poland,3
Americas,Argentina,3
Europe,Ukraine,2
Europe,Ireland,2
Europe,Portugal,2
Europe,Italy,2
Americas,Dominican Republic,2
Asia,Malaysia,2
Americas,Panama,2
Asia,Qatar,2
Asia,Singapore,2
Europe,Hungary,2
Asia,Nepal,2
Americas,Chile,2
Africa,Algeria,2
Europe,Slovenia,2
Europe,Romania,2
Africa,Zimbabwe,2
Asia,South Korea,2
Africa,Morocco,2
Asia,Kuwait,1
Asia,Mongolia,1
Europe,Lithuania,1
Europe,Serbia,1
Africa,Tanzania,1
Europe,Slovakia,1
(not set),,1
Europe,Estonia,1
Americas,Honduras,1
Americas,Guadeloupe,1
Asia,Sri Lanka,1
Asia,Cambodia,1
Americas,El Salvador,1
Americas,Ecuador,1
Europe,Latvia,1
Asia,Cyprus,1
Europe,Norway,1
Africa,Uganda,1
Americas,Costa Rica,1
Oceania,Guam,1
Americas,Peru,1
Europe,Switzerland,1
Americas,Trinidad & Tobago,1
Europe,Belarus,1
End Exploring Related Columns
Task: Please perform a 7-day retention analysis for users who first used the app during the week starting on July 2, 2018. Provide the total number of these new users and the number of retained users for each week from Week 0 (the initial week) through Week 4.

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
Week,Total_New_Users,Number_of_Retained_Users
Week0,total_new_users:int,retained_users:int
Week1,total_new_users:int,retained_users:int
Week2,total_new_users:int,retained_users:int
Week3,total_new_users:int,retained_users:int
Week4,total_new_users:int,retained_users:int
```

This table shows the 7-day retention analysis for users who first used the app during the week starting on July 2, 2018 (Week 0). The `Total_New_Users` column represents the total number of new users in that cohort, and the `Number_of_Retained_Users` column indicates how many of these users returned during each subsequent week (Week 0 through Week 4)..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180612', 'events_20180613', 'events_20180614', 'events_20180615', 'events_20180616', 'events_20180617', 'events_20180618', 'events_20180619', 'events_20180620', 'events_20180621', 'events_20180622', 'events_20180623', 'events_20180624', 'events_20180625', 'events_20180626', 'events_20180627', 'events_20180628', 'events_20180629', 'events_20180630', 'events_20180701', 'events_20180702', 'events_20180703', 'events_20180704', 'events_20180705', 'events_20180706', 'events_20180707', 'events_20180708', 'events_20180709', 'events_20180710', 'events_20180711', 'events_20180712', 'events_20180713', 'events_20180714', 'events_20180715', 'events_20180716', 'events_20180717', 'events_20180718', 'events_20180719', 'events_20180720', 'events_20180721', 'events_20180722', 'events_20180723', 'events_20180724', 'events_20180725', 'events_20180726', 'events_20180727', 'events_20180728', 'events_20180729', 'events_20180730', 'events_20180731', 'events_20180801', 'events_20180802', 'events_20180803', 'events_20180804', 'events_20180805', 'events_20180806', 'events_20180807', 'events_20180808', 'events_20180809', 'events_20180810', 'events_20180811', 'events_20180812', 'events_20180813', 'events_20180814', 'events_20180815', 'events_20180816', 'events_20180817', 'events_20180818', 'events_20180819', 'events_20180820', 'events_20180821', 'events_20180822', 'events_20180823', 'events_20180824', 'events_20180825', 'events_20180826', 'events_20180827', 'events_20180828', 'events_20180829', 'events_20180830', 'events_20180831', 'events_20180901', 'events_20180902', 'events_20180903', 'events_20180904', 'events_20180905', 'events_20180906', 'events_20180907', 'events_20180908', 'events_20180909', 'events_20180910', 'events_20180911', 'events_20180912', 'events_20180913', 'events_20180914', 'events_20180915', 'events_20180916', 'events_20180917', 'events_20180918', 'events_20180919', 'events_20180920', 'events_20180921', 'events_20180922', 'events_20180923', 'events_20180924', 'events_20180925', 'events_20180926', 'events_20180927', 'events_20180928', 'events_20180929', 'events_20180930', 'events_20181001', 'events_20181002', 'events_20181003']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-27 01:28:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:28:56 - root - INFO - ```sql
WITH new_users AS (
  SELECT
    DISTINCT `user_pseudo_id`
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
    AND DATE(TIMESTAMP_MICROS(`user_first_touch_timestamp`)) BETWEEN '2018-07-02' AND '2018-07-08'
),
user_events AS (
  SELECT
    `user_pseudo_id`,
    CASE
      WHEN `event_date` BETWEEN '20180702' AND '20180708' THEN 'Week0'
      WHEN `event_date` BETWEEN '20180709' AND '20180715' THEN 'Week1'
      WHEN `event_date` BETWEEN '20180716' AND '20180722' THEN 'Week2'
      WHEN `event_date` BETWEEN '20180723' AND '20180729' THEN 'Week3'
      WHEN `event_date` BETWEEN '20180730' AND '20180805' THEN 'Week4'
      ELSE NULL
    END AS `Week`
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    _TABLE_SUFFIX BETWEEN '20180702' AND '20180805'
    AND `user_pseudo_id` IN (SELECT `user_pseudo_id` FROM new_users)
),
retention AS (
  SELECT
    `Week`,
    COUNT(DISTINCT `user_pseudo_id`) AS `Number_of_Retained_Users`
  FROM
    user_events
  WHERE
    `Week` IS NOT NULL
  GROUP BY
    `Week`
),
total_new_users AS (
  SELECT COUNT(*) AS `Total_New_Users` FROM new_users
)
SELECT
  r.`Week`,
  t.`Total_New_Users`,
  r.`Number_of_Retained_Users`
FROM
  retention r CROSS JOIN total_new_users t
ORDER BY
  r.`Week`;
```
2025-01-27 01:28:59 - root - INFO - itercount: 1
2025-01-27 01:28:59 - root - INFO - 0
2025-01-27 01:28:59 - root - INFO - results: 
Week,Total_New_Users,Number_of_Retained_Users
Week0,222,222
Week1,222,54
Week2,222,37
Week3,222,35
Week4,222,15


2025-01-27 01:28:59 - root - INFO - Please check the answer again by reviewing Please perform a 7-day retention analysis for users who first used the app during the week starting on July 2, 2018. Provide the total number of these new users and the number of retained users for each week from Week 0 (the initial week) through Week 4., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Week,Total_New_Users,Number_of_Retained_Users
Week0,total_new_users:int,retained_users:int
Week1,total_new_users:int,retained_users:int
Week2,total_new_users:int,retained_users:int
Week3,total_new_users:int,retained_users:int
Week4,total_new_users:int,retained_users:int
```

This table shows the 7-day retention analysis for users who first used the app during the week starting on July 2, 2018 (Week 0). The `Total_New_Users` column represents the total number of new users in that cohort, and the `Number_of_Retained_Users` column indicates how many of these users returned during each subsequent week (Week 0 through Week 4). The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Week,Total_New_Users,Number_of_Retained_Users
Week0,222,222
Week1,222,54
Week2,222,37
Week3,222,35
Week4,222,15
Current sql:
WITH new_users AS (
  SELECT
    DISTINCT `user_pseudo_id`
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
    AND DATE(TIMESTAMP_MICROS(`user_first_touch_timestamp`)) BETWEEN '2018-07-02' AND '2018-07-08'
),
user_events AS (
  SELECT
    `user_pseudo_id`,
    CASE
      WHEN `event_date` BETWEEN '20180702' AND '20180708' THEN 'Week0'
      WHEN `event_date` BETWEEN '20180709' AND '20180715' THEN 'Week1'
      WHEN `event_date` BETWEEN '20180716' AND '20180722' THEN 'Week2'
      WHEN `event_date` BETWEEN '20180723' AND '20180729' THEN 'Week3'
      WHEN `event_date` BETWEEN '20180730' AND '20180805' THEN 'Week4'
      ELSE NULL
    END AS `Week`
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    _TABLE_SUFFIX BETWEEN '20180702' AND '20180805'
    AND `user_pseudo_id` IN (SELECT `user_pseudo_id` FROM new_users)
),
retention AS (
  SELECT
    `Week`,
    COUNT(DISTINCT `user_pseudo_id`) AS `Number_of_Retained_Users`
  FROM
    user_events
  WHERE
    `Week` IS NOT NULL
  GROUP BY
    `Week`
),
total_new_users AS (
  SELECT COUNT(*) AS `Total_New_Users` FROM new_users
)
SELECT
  r.`Week`,
  t.`Total_New_Users`,
  r.`Number_of_Retained_Users`
FROM
  retention r CROSS JOIN total_new_users t
ORDER BY
  r.`Week`;
2025-01-27 01:29:12 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 01:29:12 - root - INFO - ```sql
WITH new_users AS (
  SELECT
    DISTINCT `user_pseudo_id`
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    _TABLE_SUFFIX BETWEEN '20180702' AND '20180708'
    AND DATE(TIMESTAMP_MICROS(`user_first_touch_timestamp`)) BETWEEN '2018-07-02' AND '2018-07-08'
),
user_events AS (
  SELECT
    `user_pseudo_id`,
    CASE
      WHEN `event_date` BETWEEN '20180702' AND '20180708' THEN 'Week0'
      WHEN `event_date` BETWEEN '20180709' AND '20180715' THEN 'Week1'
      WHEN `event_date` BETWEEN '20180716' AND '20180722' THEN 'Week2'
      WHEN `event_date` BETWEEN '20180723' AND '20180729' THEN 'Week3'
      WHEN `event_date` BETWEEN '20180730' AND '20180805' THEN 'Week4'
      ELSE NULL
    END AS `Week`
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    _TABLE_SUFFIX BETWEEN '20180702' AND '20180805'
    AND `user_pseudo_id` IN (SELECT `user_pseudo_id` FROM new_users)
),
retention AS (
  SELECT
    `Week`,
    COUNT(DISTINCT `user_pseudo_id`) AS `Number_of_Retained_Users`
  FROM
    user_events
  WHERE
    `Week` IS NOT NULL
  GROUP BY
    `Week`
),
total_new_users AS (
  SELECT COUNT(*) AS `Total_New_Users` FROM new_users
)
SELECT
  r.`Week`,
  t.`Total_New_Users`,
  r.`Number_of_Retained_Users`
FROM
  retention r CROSS JOIN total_new_users t
ORDER BY
  r.`Week`;
```
2025-01-27 01:29:16 - root - INFO - itercount: 2
2025-01-27 01:29:16 - root - INFO - 0
2025-01-27 01:29:16 - root - INFO - Total iteration counts: 2
