2025-01-28 01:34:11 - openai._base_client - INFO - Retrying request to /chat/completions in 0.441586 seconds
2025-01-28 01:35:07 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-28 01:35:09 - root - INFO - SQL:
-- Query 1: List distinct counties in the sales table
SELECT DISTINCT county
FROM `bigquery-public-data.iowa_liquor_sales.sales`
LIMIT 100;
Results:
county
GREENE
JOHNSON
STORY
BUCHANAN
CARROLL
HUMBOLDT
BUENA VISTA
JACKSON
JEFFERSON
EL PASO
DALLAS
MILLS
MARION
HANCOCK
POCAHONTAS
LUCAS
MONROE
WAYNE
UNION
ALLAMAKEE
HOWARD
TAYLOR
RINGGOLD
CLAYTON
HARDIN
BENTON
CERRO GORDO
DUBUQUE
WINNESHIEK
WASHINGTON
CRAWFORD
ADAIR
DICKINSON
GRUNDY
PALO ALTO
WAPELLO
LOUISA
FLOYD
KEOKUK
DES MOINES
PLYMOUTH
FREMONT
SHELBY
MAHASKA
HAMILTON
GUTHRIE
MADISON
POWESHIEK
O'BRIEN
CALHOUN
BREMER
DECATUR
BLACK HAWK
VAN BUREN
POTTAWATTAMIE
POLK
TAMA
DELAWARE
LINN
CLAY
IOWA
LEE
KOSSUTH
WRIGHT
CEDAR
AUDUBON
DAVIS
SCOTT
CASS
FAYETTE
WOODBURY
JASPER
WARREN
IDA
CLARKE
CLINTON
SIOUX
MONONA
MUSCATINE
ADAMS
MONTGOMERY
FRANKLIN
BUTLER
OSCEOLA
MARSHALL
""
MITCHELL
PAGE
JONES
LYON
BOONE
HARRISON
EMMET
WORTH
WINNEBAGO
SAC
WEBSTER
HENRY
APPANOOSE
CHICKASAW

2025-01-28 01:35:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-28 01:35:37 - root - INFO - ```sql
SELECT date, zip_code, sale_dollars, category_name, item_description
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE county = 'DUBUQUE'
  AND date BETWEEN '2022-01-01' AND '2022-12-31'
LIMIT 100;
```
2025-01-28 01:36:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-28 01:36:38 - root - INFO - SQL:
SELECT date, zip_code, sale_dollars, category_name, item_description
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE county = 'DUBUQUE'
  AND date BETWEEN '2022-01-01' AND '2022-12-31'
LIMIT 100;
Results:
date,zip_code,sale_dollars,category_name,item_description
2022-01-03,52001.0,12.75,CANADIAN WHISKIES,BLACK VELVET MINI
2022-05-23,52003.0,7.5,BLENDED WHISKIES,BIRD DOG STRAWBERRY MINI
2022-12-27,52001.0,17.25,TENNESSEE WHISKIES,JACK DANIELS OLD #7 BLACK LABEL MINI
2022-01-10,52002.0,11.21,AMERICAN VODKAS,SMIRNOFF 80PRF MINI
2022-08-02,52003.0,19.2,AMERICAN VODKAS,TITOS HANDMADE VODKA MINI
2022-07-22,52001.0,38.7,WHISKEY LIQUEUR,FIREBALL CINNAMON WHISKEY MINI DISPENSER
2022-02-21,52002.0,6.45,CREAM LIQUEURS,TEQUILA ROSE LIQUEUR MINI
2022-04-18,52003,7.26,AMERICAN CORDIALS & LIQUEURS,KINKY PINK MINI
2022-09-12,52002,6.45,AMERICAN SCHNAPPS,99 BANANAS MINI
2022-10-17,52003,7.74,WHISKEY LIQUEUR,SOUTHERN COMFORT MINI
2022-07-18,52001.0,18.5,MIXTO TEQUILA,JOSE CUERVO ESPECIAL REPOSADO MINI
2022-06-13,52001.0,22.42,AMERICAN VODKAS,SMIRNOFF 80PRF MINI
2022-11-14,52001.0,14.4,SPICED RUM,CAPTAIN MORGAN ORIGINAL SPICED MINI
2022-04-25,52002,77.4,WHISKEY LIQUEUR,FIREBALL CINNAMON WHISKEY MINI DISPENSER
2022-08-12,52033.0,22.42,AMERICAN VODKAS,SMIRNOFF PEACH LEMONADE MINI
2022-11-18,52002.0,26.26,NEUTRAL GRAIN SPIRITS FLAVORED,OLE SMOKY BANANA PUDDING CREAM MOONSHINE MINI
2022-08-22,52002,26.26,NEUTRAL GRAIN SPIRITS FLAVORED,OLE SMOKY HUNCH PUNCH MOONSHINE MINI
2022-12-02,52001.0,232.2,WHISKEY LIQUEUR,FIREBALL CINNAMON WHISKEY PARTY BUCKET
2022-05-06,52001.0,21.15,AMERICAN VODKAS,MCCORMICK 80PRF VODKA MINI
2022-06-20,52001.0,19.35,AMERICAN FLAVORED VODKA,TRULY PINEAPPLE MANGO MINI
2022-11-21,52001.0,60.75,IMPORTED SCHNAPPS,RUMPLE MINZE PEPPERMINT SCHNAPPS LIQUEUR MINI
2022-12-05,52002.0,43.56,AMERICAN CORDIALS & LIQUEURS,KINKY PINK MINI
2022-07-22,52001.0,88.2,IMPORTED FLAVORED VODKA,ABSOLUT LIME MINI
2022-08-16,52001,77.4,AMERICAN CORDIALS & LIQUEURS,99 SALTED CARAMEL MINI
2022-01-10,52001.0,77.4,AMERICAN SCHNAPPS,99 PEPPERMINT MINI
2022-01-24,52001.0,77.4,AMERICAN SCHNAPPS,99 FRUITS MINI
2022-01-31,52001.0,74.4,AMERICAN VODKAS,HAWKEYE VODKA MINI
2022-01-17,52001.0,82.8,AMERICAN VODKAS,SEAGRAMS EXTRA SMOOTH VODKA MINI
2022-12-16,52033.0,134.52,AMERICAN VODKAS,SMIRNOFF 80PRF MINI
2022-02-07,52001.0,86.4,SPICED RUM,CAPTAIN MORGAN ORIGINAL SPICED MINI

2025-01-28 01:36:40 - root - INFO - SQL:
-- Query 3: List distinct category names containing 'bourbon'
SELECT DISTINCT category_name
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE LOWER(category_name) LIKE '%bourbon%'
LIMIT 100
Results:
category_name
SINGLE BARREL BOURBON WHISKIES
STRAIGHT BOURBON WHISKIES
BOTTLED IN BOND BOURBON

2025-01-28 01:36:42 - root - INFO - SQL:
-- Query 4: View Bourbon Whiskey sales records in Dubuque County in 2022
SELECT date, zip_code, sale_dollars, category_name, item_description
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE county = 'DUBUQUE'
  AND (LOWER(category_name) LIKE '%bourbon%' OR LOWER(item_description) LIKE '%bourbon%')
  AND date BETWEEN '2022-01-01' AND '2022-12-31'
LIMIT 100
Results:
date,zip_code,sale_dollars,category_name,item_description
2022-03-14,52001.0,45.0,BOTTLED IN BOND BOURBON,HENRY MCKENNA SINGLE BARREL 10YR
2022-04-05,52001,33.75,STRAIGHT BOURBON WHISKIES,MAKERS MARK CASK STRENGTH
2022-05-13,52033.0,45.74,STRAIGHT BOURBON WHISKIES,WOODFORD RESERVE DOUBLE OAKED
2022-01-14,52001.0,42.0,STRAIGHT BOURBON WHISKIES,MAKERS MARK REPLICA
2022-05-20,52001.0,60.0,STRAIGHT BOURBON WHISKIES,YELLOWSTONE SELECT
2022-01-31,52003.0,105.75,STRAIGHT BOURBON WHISKIES,BULLEIT BOURBON 10YR
2022-01-14,52040.0,81.45,STRAIGHT BOURBON WHISKIES,CEDAR RIDGE BOURBON
2022-05-23,52003.0,96.75,STRAIGHT BOURBON WHISKIES,MAKERS 46
2022-10-31,52001.0,56.25,STRAIGHT BOURBON WHISKIES,OLD TUB
2022-07-11,52002.0,65.25,STRAIGHT BOURBON WHISKIES,WILD TURKEY 101
2022-04-29,52001,75.0,STRAIGHT BOURBON WHISKIES,FOUR ROSES BOURBON
2022-04-29,52001,33.0,STRAIGHT BOURBON WHISKIES,OLD CROW
2022-09-23,52002,202.5,STRAIGHT BOURBON WHISKIES,BASIL HAYDEN 8YR
2022-10-10,52003,168.06,STRAIGHT BOURBON WHISKIES,CEDAR RIDGE BOURBON
2022-08-26,52053,154.44,SINGLE BARREL BOURBON WHISKIES,EAGLE RARE
2022-11-11,52001.0,180.0,STRAIGHT BOURBON WHISKIES,GEORGE REMUS STRAIGHT BOURBON
2022-03-04,52001.0,57.42,STRAIGHT BOURBON WHISKIES,BENCHMARK OLD NO 8
2022-04-29,52002,189.0,STRAIGHT BOURBON WHISKIES,WILD TURKEY LONGBRANCH
2022-03-29,52002.0,100.8,STRAIGHT BOURBON WHISKIES,JIM BEAM APPLE
2022-02-28,52003.0,405.0,STRAIGHT BOURBON WHISKIES,BASIL HAYDEN 8YR
2022-05-13,52002.0,153.0,STRAIGHT BOURBON WHISKIES,EVAN WILLIAMS BLACK PET
2022-09-12,52002,73.8,STRAIGHT BOURBON WHISKIES,TEN HIGH PET
2022-09-23,52001,261.0,STRAIGHT BOURBON WHISKIES,WILD TURKEY 101
2022-09-23,52056,198.0,STRAIGHT BOURBON WHISKIES,JIM BEAM VANILLA
2022-08-05,52001.0,148.5,STRAIGHT BOURBON WHISKIES,EVAN WILLIAMS BLACK
2022-12-16,52001.0,306.0,STRAIGHT BOURBON WHISKIES,MAKERS MARK
2022-07-29,52002.0,306.0,STRAIGHT BOURBON WHISKIES,MAKERS MARK
2022-10-28,52040.0,94.5,STRAIGHT BOURBON WHISKIES,OLD CROW
2022-11-21,52001.0,94.5,STRAIGHT BOURBON WHISKIES,OLD CROW
2022-10-17,52003,405.0,STRAIGHT BOURBON WHISKIES,MAKERS MARK

2025-01-28 01:36:44 - root - INFO - SQL:
-- Query 5: Calculate total Bourbon sales per zip code in Dubuque County in 2022
SELECT zip_code, SUM(sale_dollars) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE county = 'DUBUQUE'
  AND (LOWER(category_name) LIKE '%bourbon%' OR LOWER(item_description) LIKE '%bourbon%')
  AND date BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY zip_code
ORDER BY total_sales DESC
LIMIT 100
Results:
zip_code,total_sales
52001.0,288573.87999999983
52002.0,221033.71000000008
52001,128849.78000000007
52003.0,108208.14999999998
52002,108101.2
52040.0,50785.31000000001
52003,38364.95
52068.0,15087.849999999999
52040,12312.56
52033.0,8580.220000000001
52056.0,8114.429999999999
52068,7676.33
52033,4248.46
52053.0,3420.06
52056,3318.43
52053,791.22
52046,403.2
52046.0,396.0

2025-01-28 01:36:46 - root - INFO - SQL:
-- Query 6: Identify the zip code with the third-highest total Bourbon sales
SELECT zip_code, SUM(sale_dollars) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE county = 'DUBUQUE'
  AND (LOWER(category_name) LIKE '%bourbon%' OR LOWER(item_description) LIKE '%bourbon%')
  AND date BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY zip_code
ORDER BY total_sales DESC
LIMIT 3
Results:
zip_code,total_sales
52001.0,288573.8799999999
52002.0,221033.71000000005
52001,128849.78000000004

2025-01-28 01:37:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-28 01:37:10 - root - INFO - ```sql
SELECT zip_code, SUM(sale_dollars) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE county = 'DUBUQUE'
  AND category_name LIKE '%BOURBON%'
  AND date BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY zip_code
ORDER BY total_sales DESC
LIMIT 3;
```
2025-01-28 01:38:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-28 01:38:01 - root - INFO - SQL:
SELECT zip_code, SUM(sale_dollars) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE county = 'DUBUQUE'
  AND category_name LIKE '%BOURBON%'
  AND date BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY zip_code
ORDER BY total_sales DESC
LIMIT 3;
Results:
zip_code,total_sales
52001.0,274592.1299999999
52002.0,214591.93000000002
52001,125387.84000000011

2025-01-28 01:38:03 - root - INFO - SQL:
-- Query 8: Retrieve population aged 21 and over for all zip codes
SELECT zipcode, SUM(population) AS population_over_21
FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010`
WHERE minimum_age >= 21
GROUP BY zipcode
LIMIT 100
Results:
zipcode,population_over_21
28645,35338
97361,7480
3104,25003
93292,25626
85745,26789
21402,2516
72076,26436
71107,23211
48111,30551
19530,10371
13501,26203
95757,25722
96797,52015
95991,26995
85719,28491
31558,13833
84401,23164
66502,31445
54935,30345
78840,31654
80906,28155
19425,9241
68157,3637
70719,3071
75231,24958
6241,4883
47872,6966
53040,5867
70341,3140
75009,5762
20736,6267
33981,7789
48657,5990
62557,5602
41844,860
41041,5174
45887,3329
48009,14812
6354,4379
7821,6541
7823,5843
37187,4921
49302,5188
49866,5875
72744,3709
1462,7438
15223,5605
22046,11809
33449,7525
99723,2591
22124,12672
31808,4820
34224,13330
45152,7910
75021,5938
87740,5981
97331,204
97496,5653
75042,24383
64076,6732
93609,3553
93730,6943
6355,10213
97232,9974
11757,33548
28110,33590
5488,5636
43964,7318
46571,2963
60484,4234
75703,27297
3036,3273
21252,174
27048,6322
43125,9045
97487,6277
39079,1106
15062,5963
48359,5443
49057,4518
10970,7668
45875,7634
70392,5846
1057,6292
28461,13165
55425,6672
31047,7573
41139,6238
46124,5905
46373,9706
61705,8281
78112,5085
46202,13060
35962,5521
66012,7929
98438,216
85131,13882
65711,7007
28429,5951
88103,161

2025-01-28 01:38:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-28 01:38:38 - root - INFO - ```sql
SELECT zipcode, SUM(population) AS population_over_21
FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010`
WHERE minimum_age IS NOT NULL AND minimum_age >= 21
GROUP BY zipcode
LIMIT 100;
```
2025-01-28 01:39:42 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-28 01:39:42 - root - INFO - SQL:
SELECT zipcode, SUM(population) AS population_over_21
FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010`
WHERE minimum_age IS NOT NULL AND minimum_age >= 21
GROUP BY zipcode
LIMIT 100;
Results:
zipcode,population_over_21
54403,17731
72903,19019
85255,27900
92801,41039
28601,36361
10040,31656
44622,13963
95382,24901
11706,44262
97225,19096
11378,26359
48180,44686
62040,32088
75229,22089
78040,25804
14304,23340
33165,44302
44333,14308
7438,8228
21154,4773
52748,5983
57533,1453
74436,3544
79347,4856
2814,5606
19939,4701
32776,7406
42327,2977
46160,4705
16801,32417
11752,6819
19506,5374
50841,2150
62230,4470
11935,2583
12569,7202
64865,4134
66607,6840
7755,4561
19129,8296
33597,5883
34946,4395
44730,4593
77879,3601
20902,35232
1944,3818
29456,18622
30656,10767
34602,5475
46590,3130
76148,16113
90250,63494
20872,8976
29148,4863
60420,4709
97535,3850
7524,8323
8824,8345
48623,10217
62640,2851
79339,4852
3109,7615
72634,3614
28513,7417
32311,12871
49677,4816
56360,2908
76877,3446
10464,3624
39705,10092
39845,5777
73077,5205
85303,18225
53219,25771
37212,13010
61080,7373
76039,24322
78061,7601
28901,4065
97383,6640
51503,26088
62859,4231
76001,19613
21208,26035
27249,9165
68370,1613
98328,7487
60449,6596
64075,8028
96795,6863
45213,8924
49646,6085
87109,30545
21102,8388
70422,9772
77012,13228
67661,2570
70346,7465
98045,9842
14201,8398

2025-01-28 01:40:06 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-28 01:40:06 - root - INFO - ```sql
SELECT zipcode, SUM(population) AS total_population
FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010`
GROUP BY zipcode
LIMIT 100;
```
2025-01-28 01:40:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-28 01:40:29 - root - INFO - SQL:
SELECT zipcode, SUM(population) AS total_population
FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010`
GROUP BY zipcode
LIMIT 100;
Results:
zipcode,total_population
36773,1536
84317,6912
24479,4611
98314,9987
15229,41475
45030,53763
20765,1542
17238,5382
19074,17670
6475,30726
97838,76038
20886,99846
38017,145926
1505,13065
37211,224265
59213,2316
39152,3852
56382,4620
15522,36108
27539,56076
15866,783
68437,783
14859,3087
27520,109071
32225,157455
45132,786
62631,786
1378,2322
59868,6162
97623,6930
33463,161298
73548,1557
50478,2325
13082,14613
85911,5400
31825,6936
79036,15384
60526,40728
63126,45336
16244,795
43412,13086
5156,27678
84653,23841
98664,65313
74636,804
12489,3876
63332,3876
83334,6180
55369,97572
77075,112164
31784,2343
53537,2343
63626,3111
98303,3111
30555,6183
15437,7719
80828,10023
89139,91431
68318,1578
50236,4650
5673,7722
72438,7722
78023,73002
93552,114474
727,175146
64686,813
42451,2349
79411,23853
13061,3120
56211,1587
19543,17715
18504,63795
49312,822
75063,105270
49241,7737
19025,16185
14551,16953
77357,59961
78410,79161
33877,828
87715,1596
78385,831
23128,3135
44708,75327
91324,83007
58504,73026
40870,837
50237,9285
54479,12357
2653,17733
92118,70725
71839,840
52171,3144
42051,8520
78247,147528
37645,15435
17976,20811
77040,135243
16855,846
61321,846

2025-01-28 01:40:31 - root - INFO - SQL:
-- Query 11: List distinct age ranges in the population data
SELECT DISTINCT minimum_age, maximum_age
FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010`
LIMIT 100
Results:
minimum_age,maximum_age
,
85.0,
0.0,4.0
5.0,9.0
10.0,14.0
15.0,17.0
18.0,19.0
20.0,20.0
21.0,21.0
22.0,24.0
25.0,29.0
30.0,34.0
35.0,39.0
40.0,44.0
45.0,49.0
50.0,54.0
55.0,59.0
60.0,61.0
62.0,64.0
65.0,66.0
67.0,69.0
70.0,74.0
75.0,79.0
80.0,84.0

2025-01-28 01:40:33 - root - INFO - SQL:
-- Query 12: Find stores located in Dubuque County with Bourbon sales
SELECT DISTINCT store_name, address, city, zip_code
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE county = 'DUBUQUE'
  AND category_name LIKE '%BOURBON%'
  AND date BETWEEN '2022-01-01' AND '2022-12-31'
LIMIT 100
Results:
store_name,address,city,zip_code
SID'S BEVERAGE SHOP,2727 DODGE ST,DUBUQUE,52003
WALGREENS #11942 / DUBUQUE,345 E 20TH ST,DUBUQUE,52001.0
HARTIG DRUG COMPANY #8/UNIVERSITY,1600 UNIVERSITY AVE,DUBUQUE,52001
WALGREENS #06154 / DUBUQUE,2260 JOHN F KENNEDY RD,DUBUQUE,52002
WALGREENS #11942 / DUBUQUE,345 E 20TH ST,DUBUQUE,52001
CASEY'S GENERAL STORE #2420 / DUBUQUE,2699 ROCKDALE,DUBUQUE,52003
TOBACCO OUTLET PLUS #504 / DUBUQUE,"806 WACKER DR., STE 140",DUBUQUE,52001
HARTIG DRUG COMPANY #8/UNIVERSITY,1600 UNIVERSITY AVE,DUBUQUE,52001.0
DUBUQUE WINE & SPIRITS,3305 ASBURY RD,DUBUQUE,52002.0
EICHMAN ENTERPRISES INC / SAGEVILLE,11941 HWY 52 N,SAGEVILLE,52002.0
HY-VEE DYERSVILLE DOLLAR FRESH,1201 12TH AVE SE,DYERSVILLE,52040
CASEY'S GENERAL STORE #2561 / FARLEY,"306, 1ST ST SW",FARLEY,52046.0
CASEY'S GENERAL STORE #77 / CASCADE,717 1ST  AVE,CASCADE,52033.0
LUXEMBURG LIQUOR TOBACCO & GAS,101 W MAIN ST,LUXEMBURG,52056
HY-VEE FOOD STORE #1 (1159) / DUBUQUE,3500 DODGE ST,DUBUQUE,52001.0
CASEY'S GENERAL STORE #2561 / FARLEY,"306, 1ST ST SW",FARLEY,52046
BIG 10 MART,2100 JFK RD,DUBUQUE,52001
BEECHER LIQUOR / DUBUQUE,1691 ASBURY RD,DUBUQUE,52001
TARGET STORE T-0086 / DUBUQUE,3500 DODGE ST,DUBUQUE,52003.0
HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001
KWIK STOP 16TH STREET #325,1210 E 16TH ST,DUBUQUE,52001
CASEY'S GENERAL STORE #3077 / PEOSTA,236 PEOSTA ST,PEOSTA,52068.0
CASEY'S GENERAL STORE #77 / CASCADE,717 1ST  AVE,CASCADE,52033
BEECHER LIQUOR / DUBUQUE,1691 ASBURY RD,DUBUQUE,52001.0
HARTIG DRUG CO #6 / DYERSVILLE,711  16TH AVE SE,DYERSVILLE,52040.0
HY-VEE C-STORE #3 / DUBUQUE,300 S LOCUST,DUBUQUE,52003
CATFISH CHARLIE'S,1630 EAST 16TH ST,DUBUQUE,52001.0
KWIK STOP FOOD MART,2360 CENTRAL,DUBUQUE,52001.0
KWIK STOP C-STORES / DUBUQUE,2335 UNIVERSITY AVE,DUBUQUE,52001
RANDY'S NEIGHBORHOOD MARKET / DYERSVILLE,733 16TH AVE SE,DYERSVILLE,52040.0
HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001.0
MAIN ST MARKET  /  HOLY CROSS,"882, MAIN ST",HOLY CROSS,52053
BIG 10 MART #12 / DUBUQUE,405 RHOMBERG,DUBUQUE,52001
HY-VEE FAST AND FRESH - DUBUQUE,2435 NW ARTERIAL,DUBUQUE,52002.0
CASEY'S GENERAL STORE #1065 / ASBURY,5505 ASBURY RD,DUBUQUE,52002.0
RANDY'S NEIGHBORHOOD MARKET / DYERSVILLE,733 16TH AVE SE,DYERSVILLE,52040
CASEY'S GENERAL STORE #1065 / ASBURY,5505 ASBURY RD,DUBUQUE,52002
KWIK STOP C-STORES / DUBUQUE,2335 UNIVERSITY AVE,DUBUQUE,52001.0
HY-VEE FAST AND FRESH - DUBUQUE,2435 NW ARTERIAL,DUBUQUE,52002
CASEY'S GENERAL STORE #2421 / DUBUQUE,4003 PERU RD,DUBUQUE,52001
TOBACCO OUTLET PLUS #504 / DUBUQUE,"806 WACKER DR., STE 140",DUBUQUE,52001.0
CASEY'S GENERAL STORE #3473 / DUBUQU,"1072, CEDAR CROSS RD",DUBUQUE,52003

2025-01-28 01:40:36 - root - INFO - SQL:
-- Query 13: Check for zip codes in sales data not present in population data
SELECT DISTINCT sales.zip_code
FROM `bigquery-public-data.iowa_liquor_sales.sales` AS sales
LEFT JOIN `bigquery-public-data.census_bureau_usa.population_by_zip_2010` AS pop
  ON CAST(sales.zip_code AS STRING) = pop.zipcode
WHERE pop.zipcode IS NULL
LIMIT 100
Results:
zip_code
50588.0
50257.0
52747.0
52003.0
50248.0
52318.0
50210.0
51559.0
50171.0
50459.0
50511.0
52043.0
51101.0
51640.0
52057.0
52228.0
50060.0
50249.0
50157.0
50472.0
52084
50161.0
50174.0
52151.0
52248.0
50525.0
52069.0
51005.0
52053.0
50421.0
52655.0
50315.0
50201.0
51534.0
51301.0
52802.0
52339.0
51334.0
51566.0
51579.0
52218.0
50265.0
50033.0
51331.0
50250.0
50225.0
50677.0
52205.0
51106.0
52627.0
50054.0
52336.0
52316.0
51241.0
50627.0
50667.0
50659.0
51039.0
51055.0
51025.0
51551.0
52322.0
52358.0
52590.0
52328.0
52333.0
51525.0
50144.0
52623.0
52035.0
52647.0
50015
50516.0
50643.0
50313.0
51035.0
52076.0
50702.0
52302.0
52537.0
52214.0
50219.0
52401.0
50014.0
52544.0
52087.0
52253.0
52356.0
50849.0
50585.0
50423.0
51248.0
50213.0
50268.0
52345.0
50251.0
50162.0
50529.0
52658.0
50641.0

2025-01-28 01:40:37 - root - INFO - SQL:
-- Query 14: List item descriptions containing 'bourbon' in sales records
SELECT DISTINCT item_description
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE item_description LIKE '%BOURBON%'
LIMIT 100
Results:
item_description
BROTHERS BOND STRAIGHT BOURBON WHISKEY
BULLEIT BOURBON BARREL STRENGTH
CHICKEN COCK KENTUCKY STRAIGHT BOURBON
DAVIESS COUNTY KENTUCKY STRAIGHT BOURBON WHISKEY
FISTFUL OF BOURBON
REDWOOD EMPIRE PIPE DREAM BOURBON
OAK & EDEN BOURBON & SPIRE
HA WELLER ANTIQUE BOURBON
SAVAGE & COOKE BOURBON WHISKEY
OLD ELK 8 YEAR WHEATED BOURBON
OLD ELK STRAIGHT BOURBON SHERRY CASK FINISH
TIM SMITH SOUTHERN RESERVE BOURBON
CODY ROAD BOURBON W/ROCKS GLASS
RUDDELLS MILL KENTUCKY STRAIGHT BOURBON WHISKEY
ANGEL'S ENVY BOURBON PORT FINISHED
FOUNDRY BOURBON
JEFFERSONS OCEAN WHEATED BOURBON
OAK & EDEN SPIRE SELECT BOURBON AMBURANA BUY THE BARREL
BARRELL BOURBON PRIVATE RELEASE
JTS BROWN BOURBON
STEEPLE RIDGE BOTTLED IN BOND 4 GRAIN BOURBON
VIRGIL KAINE CHEF SERIES GINGER INFUSED BOURBON
CEDAR RIDGE CASK FINISHED BOURBON
BARENJAGER HONEY AND BOURBON
ANCIENT AGE BOURBON 80PRF
CODY ROAD BOURBON - CF STAFF PICK
HA WILDERNESS TRAIL BIB KENTUCKY BOURBON 6YR
OLD WELLER 107 ANTIQUE BOURBON 7YR HA
CONCIERE BOURBON
TRAILS END BOURBON
WEST CORK BOURBON CASK IRISH WHISKEY
STELLUM BLACK BOURBON
MATTINGLY & MOORE BOURBON
VIRGIN BOURBON 101
BARRELL BOURBON BATCH 023
CHAPIN & GORE STR BOURBON(DNO)
PEERLESS HIGH RYE KENTUCKY STRAIGHT BOURBON WHISKEY
BARREL BOURBON BATCH 24
HA KINGS COUNTY DISTILLERY BARREL STRENGTH STRAIGHT BOURBON
ROCK TOWN ARKANSAS BOURBON WHISKEY
BARRELL BOURBON BATCH 023 DNO
CODY ROAD BOURBON BUY THE BARREL
PUNI ITALIAN WHISKY - GOLD EX BOURBON CASK 5 YR
KOVAL SINGLE BARREL BOURBON WHISKEY BUY THE BARREL
BOURBON COUNTY PACK
HA HEAVEN HILL GRAIN TO GLASS WHEATED BOURBON
BULLEIT BOURBON WHISKEY W/ MUG
1792 BOTTLED IN BOND BOURBON
CEDAR RIDGE BOURBON
VERY OLD BARTON BOURBON CRAFTED 80PRF
RUSSELLS RESERVE SINGLE BARREL BOURBON
BP BRECKENRIDGE BOURBON WHISKEY RESERVE BLEND ALPHA
LEADSLINGERS BOURBON WHISKEY 10YR
G & W BOURBON
BP WILDERNESS TRAIL WHEATED BOURBON FAMILY RESERVE
KNOB CREEK BOURBON
BUZZARDS ROOST TOASTED AMERICAN OAK STRAIGHT BOURBON
BP JEFFERSONS RESERVE BOURBON BARREL
OAK & EDEN BOURBON & BREW
RIEGERS BOTTLED IN BOND STRAIGHT BOURBON
BROTHERHOOD BOURBON
NORTH FOREST KREME MAPLE BOURBON PECAN MINI
WHISTLEPIG PIGGYBACK RYE & BOURBON SPLIT PACK
WOODINVILLE PORT FINISHED BOURBON
SOOH BARRELL BOURBON DOVETAIL WHISKEY
HORSE SOLDIER SMALL BATCH BOURBON WHISKEY
BULLIET BOURBON W/2 CERAMIC MUGS
RED STATE BOURBON
CEDAR RIDGE BOURBON BUY THE BARREL
BURNSIDE BOURBON
BIRD DOG BOURBON W/4-50MLS
PENELOPE BOURBON TOASTED BARREL FINISH USE CODE 21065
BUCK BOURBON 8YR
BENCHMARK NO. 8 BOURBON WHISKEY
BRECKENRIDGE DISTILLERS HIGH PROOF BLEND BOURBON
CEDAR RIDGE PRIVATE CASK IOWA BOURBON SELECTION BARREL BUY
BALCONES TEXAS POT STILL BOURBON VAP W/ ROCKS GLASSES
HUDSON FOUR GRAIN BOURBON
UNRESTRICTED WHEATED STRAIGHT BOURBON WHISKEY BOTTLED IN BON
OLD ELK 8YR WHEATED BOURBON
DARK ARTS WHISKEY HOUSE (CORE) BOURBON (RED) SBW FINISHED WI
HIGH WEST AMERICAN PRAIRIE BOURBON BARREL SELECT (MACVIN)
CHICKEN COCK CHANTICLEER COGNAC FINISH BOURBON
CENTURY FARMS PRAIRIE STATES BOURBON - PERSONALIZED
HA HORSE SOLDIER COMMANDERS SELECT VI BOURBON

2025-01-28 01:40:39 - root - INFO - SQL:
-- Query 15: Calculate total Bourbon sales by city in Dubuque County in 2022
SELECT city, SUM(sale_dollars) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE county = 'DUBUQUE'
  AND category_name LIKE '%BOURBON%'
  AND date BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY city
ORDER BY total_sales DESC
LIMIT 100
Results:
city,total_sales
DUBUQUE,862007.69
DYERSVILLE,61103.05
PEOSTA,22748.57999999999
CASCADE,12828.680000000002
LUXEMBURG,10784.500000000002
HOLY CROSS,4211.28
SAGEVILLE,1479.6999999999998
FARLEY,799.2

2025-01-28 01:40:39 - root - INFO - itercount: 0
2025-01-28 01:40:39 - root - INFO - Database Name: bigquery-public-data
Schema Name: census_bureau_usa
DDL describes table information.
,0
table_name,population_by_zip_2010
ddl,"CREATE TABLE `bigquery-public-data.census_bureau_usa.population_by_zip_2010`
(
  geo_id STRING OPTIONS(description=""Geo code""),
  zipcode STRING NOT NULL OPTIONS(description=""Five digit ZIP Code Tabulation Area Census Code""),
  population INT64 OPTIONS(description=""The total count of the population for this segment.""),
  minimum_age INT64 OPTIONS(description=""The minimum age in the age range. If null, this indicates the row as a total for male, female, or overall population.""),
  maximum_age INT64 OPTIONS(description=""The maximum age in the age range. If null, this indicates the row as having no maximum (such as 85 and over) or the row is a total of the male, female, or overall population.""),
  gender STRING OPTIONS(description=""male or female. If empty, the row is a total population summary."")
)
OPTIONS(
  labels=[(""freebqcovid"", """")]
);"

Some other tables have the similar structure: ['population_by_zip_2010', 'population_by_zip_2000']
Database Name: bigquery-public-data
Schema Name: iowa_liquor_sales
DDL describes table information.
,0
table_name,sales
ddl,"CREATE TABLE `bigquery-public-data.iowa_liquor_sales.sales`
(
  invoice_and_item_number STRING OPTIONS(description=""Concatenated invoice and line number associated with the liquor order. This provides a unique identifier for the individual liquor products included in the store order.""),
  date DATE OPTIONS(description=""Date of order""),
  store_number STRING OPTIONS(description=""Unique number assigned to the store who ordered the liquor.""),
  store_name STRING OPTIONS(description=""Name of store who ordered the liquor.""),
  address STRING OPTIONS(description=""Address of store who ordered the liquor.""),
  city STRING OPTIONS(description=""City where the store who ordered the liquor is located""),
  zip_code STRING OPTIONS(description=""Zip code where the store who ordered the liquor is located""),
  store_location GEOGRAPHY OPTIONS(description=""Location of store who ordered the liquor. The Address, City, State and Zip Code are geocoded to provide geographic coordinates. Accuracy of geocoding is dependent on how well the address is interpreted and the completeness of the reference data used.""),
  county_number STRING OPTIONS(description=""Iowa county number for the county where store who ordered the liquor is located""),
  county STRING OPTIONS(description=""County where the store who ordered the liquor is located""),
  category STRING OPTIONS(description=""Category code associated with the liquor ordered""),
  category_name STRING OPTIONS(description=""Category of the liquor ordered.""),
  vendor_number STRING OPTIONS(description=""The vendor number of the company for the brand of liquor ordered""),
  vendor_name STRING OPTIONS(description=""The vendor name of the company for the brand of liquor ordered""),
  item_number STRING OPTIONS(description=""Item number for the individual liquor product ordered.""),
  item_description STRING OPTIONS(description=""Description of the individual liquor product ordered.""),
  pack INT64 OPTIONS(description=""The number of bottles in a case for the liquor ordered""),
  bottle_volume_ml INT64 OPTIONS(description=""Volume of each liquor bottle ordered in milliliters.""),
  state_bottle_cost FLOAT64 OPTIONS(description=""The amount that Alcoholic Beverages Division paid for each bottle of liquor ordered""),
  state_bottle_retail FLOAT64 OPTIONS(description=""The amount the store paid for each bottle of liquor ordered""),
  bottles_sold INT64 OPTIONS(description=""The number of bottles of liquor ordered by the store""),
  sale_dollars FLOAT64 OPTIONS(description=""Total cost of liquor order (number of bottles multiplied by the state bottle retail)""),
  volume_sold_liters FLOAT64 OPTIONS(description=""Total volume of liquor ordered in liters. (i.e. (Bottle Volume (ml) x Bottles Sold)/1,000)\""""),
  volume_sold_gallons FLOAT64 OPTIONS(description=""Total volume of liquor ordered in gallons. (i.e. (Bottle Volume (ml) x Bottles Sold)/3785.411784)\"""")
)
OPTIONS(
  description=""Sales Dataset""
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'census_bureau_usa': ['population_by_zip_2000', 'population_by_zip_2010'], 'iowa_liquor_sales': ['sales']}}
Begin Exploring Related Columns
Considered relevant columns and potential usage:

From `bigquery-public-data.iowa_liquor_sales.sales`:

- `date`: To filter sales data for the year 2022.
- `county`: To select records from Dubuque County.
- `zip_code`: To identify and group sales by zip code.
- `sale_dollars`: To calculate total sales amounts.
- `category_name`: To identify Bourbon Whiskey sales.
- `item_description`: To further filter Bourbon Whiskey items.
- `bottles_sold`: To analyze sales volume.
- `store_name`: Potentially to verify store locations.
- `city`: Additional geographic filtering if needed.

Conditions that may be used:

- `date` BETWEEN '2022-01-01' AND '2022-12-31' to select sales in 2022.
- `county` = 'Dubuque' to filter records for Dubuque County.
- `category_name` LIKE '%bourbon%' OR `item_description` LIKE '%bourbon%' to identify Bourbon Whiskey sales.
- Using `LOWER` function for case-insensitive matching.
- Grouping by `zip_code` to aggregate sales per zip code.

From `bigquery-public-data.census_bureau_usa.population_by_zip_2010`:

- `zipcode`: To match zip codes with sales data.
- `population`: To obtain population counts.
- `minimum_age`, `maximum_age`: To filter population aged 21 and over.

Conditions that may be used:

- `minimum_age` >= 21 OR `maximum_age` >= 21 to select the population aged 21 and over.

Here are 10 BigQuery SQL queries to understand the data:

```sql
-- Query 1: List distinct counties in the sales table
SELECT DISTINCT county
FROM `bigquery-public-data.iowa_liquor_sales.sales`
LIMIT 100;
```

```sql
-- Query 2: List distinct zip codes in Dubuque County
SELECT DISTINCT zip_code
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE county = 'Dubuque'
LIMIT 100;
```

```sql
-- Query 3: List distinct category names containing 'bourbon'
SELECT DISTINCT category_name
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE LOWER(category_name) LIKE '%bourbon%'
LIMIT 100;
```

```sql
-- Query 4: View Bourbon Whiskey sales records in Dubuque County in 2022
SELECT date, zip_code, sale_dollars, category_name, item_description
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE county = 'Dubuque'
  AND (LOWER(category_name) LIKE '%bourbon%' OR LOWER(item_description) LIKE '%bourbon%')
  AND date BETWEEN '2022-01-01' AND '2022-12-31'
LIMIT 100;
```

```sql
-- Query 5: Calculate total Bourbon sales per zip code in Dubuque County in 2022
SELECT zip_code, SUM(sale_dollars) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE county = 'Dubuque'
  AND (LOWER(category_name) LIKE '%bourbon%' OR LOWER(item_description) LIKE '%bourbon%')
  AND date BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY zip_code
ORDER BY total_sales DESC
LIMIT 100;
```

```sql
-- Query 6: Identify the zip code with the third-highest total Bourbon sales
SELECT zip_code, SUM(sale_dollars) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE county = 'Dubuque'
  AND (LOWER(category_name) LIKE '%bourbon%' OR LOWER(item_description) LIKE '%bourbon%')
  AND date BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY zip_code
ORDER BY total_sales DESC
LIMIT 3;
```

```sql
-- Query 7: Get monthly Bourbon sales for the third-highest zip code
SELECT EXTRACT(MONTH FROM date) AS month, SUM(sale_dollars) AS monthly_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE county = 'Dubuque'
  AND zip_code = 'ZIP_CODE_HERE'  -- Replace with actual zip code from Query 6
  AND (LOWER(category_name) LIKE '%bourbon%' OR LOWER(item_description) LIKE '%bourbon%')
  AND date BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY month
ORDER BY month
LIMIT 12;
```

```sql
-- Query 8: Retrieve population aged 21 and over for all zip codes
SELECT zipcode, SUM(population) AS population_over_21
FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010`
WHERE (minimum_age >= 21 OR maximum_age >= 21)
GROUP BY zipcode
LIMIT 100;
```

```sql
-- Query 9: Get population aged 21 and over for the specific zip code
SELECT zipcode, SUM(population) AS population_over_21
FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010`
WHERE zipcode = 'ZIP_CODE_HERE'  -- Replace with actual zip code from Query 6
  AND (minimum_age >= 21 OR maximum_age >= 21)
GROUP BY zipcode
LIMIT 1;
```

```sql
-- Query 10: Calculate per capita monthly Bourbon sales for the zip code
SELECT
  EXTRACT(MONTH FROM date) AS month,
  SUM(sale_dollars) / population_over_21 AS per_capita_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales` AS sales
JOIN (
  SELECT zipcode, SUM(population) AS population_over_21
  FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010`
  WHERE zipcode = 'ZIP_CODE_HERE'  -- Replace with actual zip code from Query 6
    AND (minimum_age >= 21 OR maximum_age >= 21)
  GROUP BY zipcode
) AS pop
ON sales.zip_code = pop.zipcode
WHERE sales.county = 'Dubuque'
  AND sales.zip_code = 'ZIP_CODE_HERE'  -- Replace with actual zip code from Query 6
  AND (LOWER(sales.category_name) LIKE '%bourbon%' OR LOWER(sales.item_description) LIKE '%bourbon%')
  AND sales.date BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY month, population_over_21
ORDER BY month
LIMIT 12;
```

Additional queries:

```sql
-- Query 11: List distinct age ranges in the population data
SELECT DISTINCT minimum_age, maximum_age
FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010`
ORDER BY minimum_age
LIMIT 100;
```

```sql
-- Query 12: Find stores located in Dubuque County with Bourbon sales
SELECT DISTINCT store_name, address, city, zip_code
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE county = 'Dubuque'
  AND (LOWER(category_name) LIKE '%bourbon%' OR LOWER(item_description) LIKE '%bourbon%')
  AND date BETWEEN '2022-01-01' AND '2022-12-31'
LIMIT 100;
```

```sql
-- Query 13: Check for zip codes in sales data not present in population data
SELECT DISTINCT sales.zip_code
FROM `bigquery-public-data.iowa_liquor_sales.sales` AS sales
LEFT JOIN `bigquery-public-data.census_bureau_usa.population_by_zip_2010` AS pop
  ON sales.zip_code = pop.zipcode
WHERE pop.zipcode IS NULL
LIMIT 100;
```

```sql
-- Query 14: List item descriptions containing 'bourbon' in sales records
SELECT DISTINCT item_description
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE LOWER(item_description) LIKE '%bourbon%'
LIMIT 100;
```

```sql
-- Query 15: Calculate total Bourbon sales by city in Dubuque County in 2022
SELECT city, SUM(sale_dollars) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE county = 'Dubuque'
  AND (LOWER(category_name) LIKE '%bourbon%' OR LOWER(item_description) LIKE '%bourbon%')
  AND date BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY city
ORDER BY total_sales DESC
LIMIT 100;
```

These queries help explore and understand the relevant data needed to calculate the monthly per capita Bourbon Whiskey sales in 2022 for the specified zip code in Dubuque County, considering only the population aged 21 and over.Query:
-- Query 1: List distinct counties in the sales table
SELECT DISTINCT county
FROM `bigquery-public-data.iowa_liquor_sales.sales`
LIMIT 100;
Answer:
county
GREENE
JOHNSON
STORY
BUCHANAN
CARROLL
HUMBOLDT
BUENA VISTA
JACKSON
JEFFERSON
EL PASO
DALLAS
MILLS
MARION
HANCOCK
POCAHONTAS
LUCAS
MONROE
WAYNE
UNION
ALLAMAKEE
HOWARD
TAYLOR
RINGGOLD
CLAYTON
HARDIN
BENTON
CERRO GORDO
DUBUQUE
WINNESHIEK
WASHINGTON
CRAWFORD
ADAIR
DICKINSON
GRUNDY
PALO ALTO
WAPELLO
LOUISA
FLOYD
KEOKUK
DES MOINES
PLYMOUTH
FREMONT
SHELBY
MAHASKA
HAMILTON
GUTHRIE
MADISON
POWESHIEK
O'BRIEN
CALHOUN
BREMER
DECATUR
BLACK HAWK
VAN BUREN
POTTAWATTAMIE
POLK
TAMA
DELAWARE
LINN
CLAY
IOWA
LEE
KOSSUTH
WRIGHT
CEDAR
AUDUBON
DAVIS
SCOTT
CASS
FAYETTE
WOODBURY
JASPER
WARREN
IDA
CLARKE
CLINTON
SIOUX
MONONA
MUSCATINE
ADAMS
MONTGOMERY
FRANKLIN
BUTLER
OSCEOLA
MARSHALL
""
MITCHELL
PAGE
JONES
LYON
BOONE
HARRISON
EMMET
WORTH
WINNEBAGO
SAC
WEBSTER
HENRY
APPANOOSE
CHICKASAW
Query:
SELECT date, zip_code, sale_dollars, category_name, item_description
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE county = 'DUBUQUE'
  AND date BETWEEN '2022-01-01' AND '2022-12-31'
LIMIT 100;
Answer:
date,zip_code,sale_dollars,category_name,item_description
2022-01-03,52001.0,12.75,CANADIAN WHISKIES,BLACK VELVET MINI
2022-05-23,52003.0,7.5,BLENDED WHISKIES,BIRD DOG STRAWBERRY MINI
2022-12-27,52001.0,17.25,TENNESSEE WHISKIES,JACK DANIELS OLD #7 BLACK LABEL MINI
2022-01-10,52002.0,11.21,AMERICAN VODKAS,SMIRNOFF 80PRF MINI
2022-08-02,52003.0,19.2,AMERICAN VODKAS,TITOS HANDMADE VODKA MINI
2022-07-22,52001.0,38.7,WHISKEY LIQUEUR,FIREBALL CINNAMON WHISKEY MINI DISPENSER
2022-02-21,52002.0,6.45,CREAM LIQUEURS,TEQUILA ROSE LIQUEUR MINI
2022-04-18,52003,7.26,AMERICAN CORDIALS & LIQUEURS,KINKY PINK MINI
2022-09-12,52002,6.45,AMERICAN SCHNAPPS,99 BANANAS MINI
2022-10-17,52003,7.74,WHISKEY LIQUEUR,SOUTHERN COMFORT MINI
2022-07-18,52001.0,18.5,MIXTO TEQUILA,JOSE CUERVO ESPECIAL REPOSADO MINI
2022-06-13,52001.0,22.42,AMERICAN VODKAS,SMIRNOFF 80PRF MINI
2022-11-14,52001.0,14.4,SPICED RUM,CAPTAIN MORGAN ORIGINAL SPICED MINI
2022-04-25,52002,77.4,WHISKEY LIQUEUR,FIREBALL CINNAMON WHISKEY MINI DISPENSER
2022-08-12,52033.0,22.42,AMERICAN VODKAS,SMIRNOFF PEACH LEMONADE MINI
2022-11-18,52002.0,26.26,NEUTRAL GRAIN SPIRITS FLAVORED,OLE SMOKY BANANA PUDDING CREAM MOONSHINE MINI
2022-08-22,52002,26.26,NEUTRAL GRAIN SPIRITS FLAVORED,OLE SMOKY HUNCH PUNCH MOONSHINE MINI
2022-12-02,52001.0,232.2,WHISKEY LIQUEUR,FIREBALL CINNAMON WHISKEY PARTY BUCKET
2022-05-06,52001.0,21.15,AMERICAN VODKAS,MCCORMICK 80PRF VODKA MINI
2022-06-20,52001.0,19.35,AMERICAN FLAVORED VODKA,TRULY PINEAPPLE MANGO MINI
2022-11-21,52001.0,60.75,IMPORTED SCHNAPPS,RUMPLE MINZE PEPPERMINT SCHNAPPS LIQUEUR MINI
2022-12-05,52002.0,43.56,AMERICAN CORDIALS & LIQUEURS,KINKY PINK MINI
2022-07-22,52001.0,88.2,IMPORTED FLAVORED VODKA,ABSOLUT LIME MINI
2022-08-16,52001,77.4,AMERICAN CORDIALS & LIQUEURS,99 SALTED CARAMEL MINI
2022-01-10,52001.0,77.4,AMERICAN SCHNAPPS,99 PEPPERMINT MINI
2022-01-24,52001.0,77.4,AMERICAN SCHNAPPS,99 FRUITS MINI
2022-01-31,52001.0,74.4,AMERICAN VODKAS,HAWKEYE VODKA MINI
2022-01-17,52001.0,82.8,AMERICAN VODKAS,SEAGRAMS EXTRA SMOOTH VODKA MINI
2022-12-16,52033.0,134.52,AMERICAN VODKAS,SMIRNOFF 80PRF MINI
2022-02-07,52001.0,86.4,SPICED RUM,CAPTAIN MORGAN ORIGINAL SPICED MINI
Query:
-- Query 3: List distinct category names containing 'bourbon'
SELECT DISTINCT category_name
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE LOWER(category_name) LIKE '%bourbon%'
LIMIT 100
Answer:
category_name
SINGLE BARREL BOURBON WHISKIES
STRAIGHT BOURBON WHISKIES
BOTTLED IN BOND BOURBON
Query:
-- Query 4: View Bourbon Whiskey sales records in Dubuque County in 2022
SELECT date, zip_code, sale_dollars, category_name, item_description
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE county = 'DUBUQUE'
  AND (LOWER(category_name) LIKE '%bourbon%' OR LOWER(item_description) LIKE '%bourbon%')
  AND date BETWEEN '2022-01-01' AND '2022-12-31'
LIMIT 100
Answer:
date,zip_code,sale_dollars,category_name,item_description
2022-03-14,52001.0,45.0,BOTTLED IN BOND BOURBON,HENRY MCKENNA SINGLE BARREL 10YR
2022-04-05,52001,33.75,STRAIGHT BOURBON WHISKIES,MAKERS MARK CASK STRENGTH
2022-05-13,52033.0,45.74,STRAIGHT BOURBON WHISKIES,WOODFORD RESERVE DOUBLE OAKED
2022-01-14,52001.0,42.0,STRAIGHT BOURBON WHISKIES,MAKERS MARK REPLICA
2022-05-20,52001.0,60.0,STRAIGHT BOURBON WHISKIES,YELLOWSTONE SELECT
2022-01-31,52003.0,105.75,STRAIGHT BOURBON WHISKIES,BULLEIT BOURBON 10YR
2022-01-14,52040.0,81.45,STRAIGHT BOURBON WHISKIES,CEDAR RIDGE BOURBON
2022-05-23,52003.0,96.75,STRAIGHT BOURBON WHISKIES,MAKERS 46
2022-10-31,52001.0,56.25,STRAIGHT BOURBON WHISKIES,OLD TUB
2022-07-11,52002.0,65.25,STRAIGHT BOURBON WHISKIES,WILD TURKEY 101
2022-04-29,52001,75.0,STRAIGHT BOURBON WHISKIES,FOUR ROSES BOURBON
2022-04-29,52001,33.0,STRAIGHT BOURBON WHISKIES,OLD CROW
2022-09-23,52002,202.5,STRAIGHT BOURBON WHISKIES,BASIL HAYDEN 8YR
2022-10-10,52003,168.06,STRAIGHT BOURBON WHISKIES,CEDAR RIDGE BOURBON
2022-08-26,52053,154.44,SINGLE BARREL BOURBON WHISKIES,EAGLE RARE
2022-11-11,52001.0,180.0,STRAIGHT BOURBON WHISKIES,GEORGE REMUS STRAIGHT BOURBON
2022-03-04,52001.0,57.42,STRAIGHT BOURBON WHISKIES,BENCHMARK OLD NO 8
2022-04-29,52002,189.0,STRAIGHT BOURBON WHISKIES,WILD TURKEY LONGBRANCH
2022-03-29,52002.0,100.8,STRAIGHT BOURBON WHISKIES,JIM BEAM APPLE
2022-02-28,52003.0,405.0,STRAIGHT BOURBON WHISKIES,BASIL HAYDEN 8YR
2022-05-13,52002.0,153.0,STRAIGHT BOURBON WHISKIES,EVAN WILLIAMS BLACK PET
2022-09-12,52002,73.8,STRAIGHT BOURBON WHISKIES,TEN HIGH PET
2022-09-23,52001,261.0,STRAIGHT BOURBON WHISKIES,WILD TURKEY 101
2022-09-23,52056,198.0,STRAIGHT BOURBON WHISKIES,JIM BEAM VANILLA
2022-08-05,52001.0,148.5,STRAIGHT BOURBON WHISKIES,EVAN WILLIAMS BLACK
2022-12-16,52001.0,306.0,STRAIGHT BOURBON WHISKIES,MAKERS MARK
2022-07-29,52002.0,306.0,STRAIGHT BOURBON WHISKIES,MAKERS MARK
2022-10-28,52040.0,94.5,STRAIGHT BOURBON WHISKIES,OLD CROW
2022-11-21,52001.0,94.5,STRAIGHT BOURBON WHISKIES,OLD CROW
2022-10-17,52003,405.0,STRAIGHT BOURBON WHISKIES,MAKERS MARK
Query:
-- Query 5: Calculate total Bourbon sales per zip code in Dubuque County in 2022
SELECT zip_code, SUM(sale_dollars) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE county = 'DUBUQUE'
  AND (LOWER(category_name) LIKE '%bourbon%' OR LOWER(item_description) LIKE '%bourbon%')
  AND date BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY zip_code
ORDER BY total_sales DESC
LIMIT 100
Answer:
zip_code,total_sales
52001.0,288573.87999999983
52002.0,221033.71000000008
52001,128849.78000000007
52003.0,108208.14999999998
52002,108101.2
52040.0,50785.31000000001
52003,38364.95
52068.0,15087.849999999999
52040,12312.56
52033.0,8580.220000000001
52056.0,8114.429999999999
52068,7676.33
52033,4248.46
52053.0,3420.06
52056,3318.43
52053,791.22
52046,403.2
52046.0,396.0
Query:
-- Query 6: Identify the zip code with the third-highest total Bourbon sales
SELECT zip_code, SUM(sale_dollars) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE county = 'DUBUQUE'
  AND (LOWER(category_name) LIKE '%bourbon%' OR LOWER(item_description) LIKE '%bourbon%')
  AND date BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY zip_code
ORDER BY total_sales DESC
LIMIT 3
Answer:
zip_code,total_sales
52001.0,288573.8799999999
52002.0,221033.71000000005
52001,128849.78000000004
Query:
SELECT zip_code, SUM(sale_dollars) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE county = 'DUBUQUE'
  AND category_name LIKE '%BOURBON%'
  AND date BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY zip_code
ORDER BY total_sales DESC
LIMIT 3;
Answer:
zip_code,total_sales
52001.0,274592.1299999999
52002.0,214591.93000000002
52001,125387.84000000011
Query:
-- Query 8: Retrieve population aged 21 and over for all zip codes
SELECT zipcode, SUM(population) AS population_over_21
FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010`
WHERE minimum_age >= 21
GROUP BY zipcode
LIMIT 100
Answer:
zipcode,population_over_21
28645,35338
97361,7480
3104,25003
93292,25626
85745,26789
21402,2516
72076,26436
71107,23211
48111,30551
19530,10371
13501,26203
95757,25722
96797,52015
95991,26995
85719,28491
31558,13833
84401,23164
66502,31445
54935,30345
78840,31654
80906,28155
19425,9241
68157,3637
70719,3071
75231,24958
6241,4883
47872,6966
53040,5867
70341,3140
75009,5762
20736,6267
33981,7789
48657,5990
62557,5602
41844,860
41041,5174
45887,3329
48009,14812
6354,4379
7821,6541
7823,5843
37187,4921
49302,5188
49866,5875
72744,3709
1462,7438
15223,5605
22046,11809
33449,7525
99723,2591
22124,12672
31808,4820
34224,13330
45152,7910
75021,5938
87740,5981
97331,204
97496,5653
75042,24383
64076,6732
93609,3553
93730,6943
6355,10213
97232,9974
11757,33548
28110,33590
5488,5636
43964,7318
46571,2963
60484,4234
75703,27297
3036,3273
21252,174
27048,6322
43125,9045
97487,6277
39079,1106
15062,5963
48359,5443
49057,4518
10970,7668
45875,7634
70392,5846
1057,6292
28461,13165
55425,6672
31047,7573
41139,6238
46124,5905
46373,9706
61705,8281
78112,5085
46202,13060
35962,5521
66012,7929
98438,216
85131,13882
65711,7007
28429,5951
88103,161
Query:
SELECT zipcode, SUM(population) AS population_over_21
FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010`
WHERE minimum_age IS NOT NULL AND minimum_age >= 21
GROUP BY zipcode
LIMIT 100;
Answer:
zipcode,population_over_21
54403,17731
72903,19019
85255,27900
92801,41039
28601,36361
10040,31656
44622,13963
95382,24901
11706,44262
97225,19096
11378,26359
48180,44686
62040,32088
75229,22089
78040,25804
14304,23340
33165,44302
44333,14308
7438,8228
21154,4773
52748,5983
57533,1453
74436,3544
79347,4856
2814,5606
19939,4701
32776,7406
42327,2977
46160,4705
16801,32417
11752,6819
19506,5374
50841,2150
62230,4470
11935,2583
12569,7202
64865,4134
66607,6840
7755,4561
19129,8296
33597,5883
34946,4395
44730,4593
77879,3601
20902,35232
1944,3818
29456,18622
30656,10767
34602,5475
46590,3130
76148,16113
90250,63494
20872,8976
29148,4863
60420,4709
97535,3850
7524,8323
8824,8345
48623,10217
62640,2851
79339,4852
3109,7615
72634,3614
28513,7417
32311,12871
49677,4816
56360,2908
76877,3446
10464,3624
39705,10092
39845,5777
73077,5205
85303,18225
53219,25771
37212,13010
61080,7373
76039,24322
78061,7601
28901,4065
97383,6640
51503,26088
62859,4231
76001,19613
21208,26035
27249,9165
68370,1613
98328,7487
60449,6596
64075,8028
96795,6863
45213,8924
49646,6085
87109,30545
21102,8388
70422,9772
77012,13228
67661,2570
70346,7465
98045,9842
14201,8398
Query:
SELECT zipcode, SUM(population) AS total_population
FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010`
GROUP BY zipcode
LIMIT 100;
Answer:
zipcode,total_population
36773,1536
84317,6912
24479,4611
98314,9987
15229,41475
45030,53763
20765,1542
17238,5382
19074,17670
6475,30726
97838,76038
20886,99846
38017,145926
1505,13065
37211,224265
59213,2316
39152,3852
56382,4620
15522,36108
27539,56076
15866,783
68437,783
14859,3087
27520,109071
32225,157455
45132,786
62631,786
1378,2322
59868,6162
97623,6930
33463,161298
73548,1557
50478,2325
13082,14613
85911,5400
31825,6936
79036,15384
60526,40728
63126,45336
16244,795
43412,13086
5156,27678
84653,23841
98664,65313
74636,804
12489,3876
63332,3876
83334,6180
55369,97572
77075,112164
31784,2343
53537,2343
63626,3111
98303,3111
30555,6183
15437,7719
80828,10023
89139,91431
68318,1578
50236,4650
5673,7722
72438,7722
78023,73002
93552,114474
727,175146
64686,813
42451,2349
79411,23853
13061,3120
56211,1587
19543,17715
18504,63795
49312,822
75063,105270
49241,7737
19025,16185
14551,16953
77357,59961
78410,79161
33877,828
87715,1596
78385,831
23128,3135
44708,75327
91324,83007
58504,73026
40870,837
50237,9285
54479,12357
2653,17733
92118,70725
71839,840
52171,3144
42051,8520
78247,147528
37645,15435
17976,20811
77040,135243
16855,846
61321,846
Query:
-- Query 11: List distinct age ranges in the population data
SELECT DISTINCT minimum_age, maximum_age
FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010`
LIMIT 100
Answer:
minimum_age,maximum_age
,
85.0,
0.0,4.0
5.0,9.0
10.0,14.0
15.0,17.0
18.0,19.0
20.0,20.0
21.0,21.0
22.0,24.0
25.0,29.0
30.0,34.0
35.0,39.0
40.0,44.0
45.0,49.0
50.0,54.0
55.0,59.0
60.0,61.0
62.0,64.0
65.0,66.0
67.0,69.0
70.0,74.0
75.0,79.0
80.0,84.0
Query:
-- Query 12: Find stores located in Dubuque County with Bourbon sales
SELECT DISTINCT store_name, address, city, zip_code
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE county = 'DUBUQUE'
  AND category_name LIKE '%BOURBON%'
  AND date BETWEEN '2022-01-01' AND '2022-12-31'
LIMIT 100
Answer:
store_name,address,city,zip_code
SID'S BEVERAGE SHOP,2727 DODGE ST,DUBUQUE,52003
WALGREENS #11942 / DUBUQUE,345 E 20TH ST,DUBUQUE,52001.0
HARTIG DRUG COMPANY #8/UNIVERSITY,1600 UNIVERSITY AVE,DUBUQUE,52001
WALGREENS #06154 / DUBUQUE,2260 JOHN F KENNEDY RD,DUBUQUE,52002
WALGREENS #11942 / DUBUQUE,345 E 20TH ST,DUBUQUE,52001
CASEY'S GENERAL STORE #2420 / DUBUQUE,2699 ROCKDALE,DUBUQUE,52003
TOBACCO OUTLET PLUS #504 / DUBUQUE,"806 WACKER DR., STE 140",DUBUQUE,52001
HARTIG DRUG COMPANY #8/UNIVERSITY,1600 UNIVERSITY AVE,DUBUQUE,52001.0
DUBUQUE WINE & SPIRITS,3305 ASBURY RD,DUBUQUE,52002.0
EICHMAN ENTERPRISES INC / SAGEVILLE,11941 HWY 52 N,SAGEVILLE,52002.0
HY-VEE DYERSVILLE DOLLAR FRESH,1201 12TH AVE SE,DYERSVILLE,52040
CASEY'S GENERAL STORE #2561 / FARLEY,"306, 1ST ST SW",FARLEY,52046.0
CASEY'S GENERAL STORE #77 / CASCADE,717 1ST  AVE,CASCADE,52033.0
LUXEMBURG LIQUOR TOBACCO & GAS,101 W MAIN ST,LUXEMBURG,52056
HY-VEE FOOD STORE #1 (1159) / DUBUQUE,3500 DODGE ST,DUBUQUE,52001.0
CASEY'S GENERAL STORE #2561 / FARLEY,"306, 1ST ST SW",FARLEY,52046
BIG 10 MART,2100 JFK RD,DUBUQUE,52001
BEECHER LIQUOR / DUBUQUE,1691 ASBURY RD,DUBUQUE,52001
TARGET STORE T-0086 / DUBUQUE,3500 DODGE ST,DUBUQUE,52003.0
HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001
KWIK STOP 16TH STREET #325,1210 E 16TH ST,DUBUQUE,52001
CASEY'S GENERAL STORE #3077 / PEOSTA,236 PEOSTA ST,PEOSTA,52068.0
CASEY'S GENERAL STORE #77 / CASCADE,717 1ST  AVE,CASCADE,52033
BEECHER LIQUOR / DUBUQUE,1691 ASBURY RD,DUBUQUE,52001.0
HARTIG DRUG CO #6 / DYERSVILLE,711  16TH AVE SE,DYERSVILLE,52040.0
HY-VEE C-STORE #3 / DUBUQUE,300 S LOCUST,DUBUQUE,52003
CATFISH CHARLIE'S,1630 EAST 16TH ST,DUBUQUE,52001.0
KWIK STOP FOOD MART,2360 CENTRAL,DUBUQUE,52001.0
KWIK STOP C-STORES / DUBUQUE,2335 UNIVERSITY AVE,DUBUQUE,52001
RANDY'S NEIGHBORHOOD MARKET / DYERSVILLE,733 16TH AVE SE,DYERSVILLE,52040.0
HY-VEE FOOD STORE / DUBUQUE,3500 DODGE ST,DUBUQUE,52001.0
MAIN ST MARKET  /  HOLY CROSS,"882, MAIN ST",HOLY CROSS,52053
BIG 10 MART #12 / DUBUQUE,405 RHOMBERG,DUBUQUE,52001
HY-VEE FAST AND FRESH - DUBUQUE,2435 NW ARTERIAL,DUBUQUE,52002.0
CASEY'S GENERAL STORE #1065 / ASBURY,5505 ASBURY RD,DUBUQUE,52002.0
RANDY'S NEIGHBORHOOD MARKET / DYERSVILLE,733 16TH AVE SE,DYERSVILLE,52040
CASEY'S GENERAL STORE #1065 / ASBURY,5505 ASBURY RD,DUBUQUE,52002
KWIK STOP C-STORES / DUBUQUE,2335 UNIVERSITY AVE,DUBUQUE,52001.0
HY-VEE FAST AND FRESH - DUBUQUE,2435 NW ARTERIAL,DUBUQUE,52002
CASEY'S GENERAL STORE #2421 / DUBUQUE,4003 PERU RD,DUBUQUE,52001
TOBACCO OUTLET PLUS #504 / DUBUQUE,"806 WACKER DR., STE 140",DUBUQUE,52001.0
CASEY'S GENERAL STORE #3473 / DUBUQU,"1072, CEDAR CROSS RD",DUBUQUE,52003
Query:
-- Query 13: Check for zip codes in sales data not present in population data
SELECT DISTINCT sales.zip_code
FROM `bigquery-public-data.iowa_liquor_sales.sales` AS sales
LEFT JOIN `bigquery-public-data.census_bureau_usa.population_by_zip_2010` AS pop
  ON CAST(sales.zip_code AS STRING) = pop.zipcode
WHERE pop.zipcode IS NULL
LIMIT 100
Answer:
zip_code
50588.0
50257.0
52747.0
52003.0
50248.0
52318.0
50210.0
51559.0
50171.0
50459.0
50511.0
52043.0
51101.0
51640.0
52057.0
52228.0
50060.0
50249.0
50157.0
50472.0
52084
50161.0
50174.0
52151.0
52248.0
50525.0
52069.0
51005.0
52053.0
50421.0
52655.0
50315.0
50201.0
51534.0
51301.0
52802.0
52339.0
51334.0
51566.0
51579.0
52218.0
50265.0
50033.0
51331.0
50250.0
50225.0
50677.0
52205.0
51106.0
52627.0
50054.0
52336.0
52316.0
51241.0
50627.0
50667.0
50659.0
51039.0
51055.0
51025.0
51551.0
52322.0
52358.0
52590.0
52328.0
52333.0
51525.0
50144.0
52623.0
52035.0
52647.0
50015
50516.0
50643.0
50313.0
51035.0
52076.0
50702.0
52302.0
52537.0
52214.0
50219.0
52401.0
50014.0
52544.0
52087.0
52253.0
52356.0
50849.0
50585.0
50423.0
51248.0
50213.0
50268.0
52345.0
50251.0
50162.0
50529.0
52658.0
50641.0
Query:
-- Query 14: List item descriptions containing 'bourbon' in sales records
SELECT DISTINCT item_description
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE item_description LIKE '%BOURBON%'
LIMIT 100
Answer:
item_description
BROTHERS BOND STRAIGHT BOURBON WHISKEY
BULLEIT BOURBON BARREL STRENGTH
CHICKEN COCK KENTUCKY STRAIGHT BOURBON
DAVIESS COUNTY KENTUCKY STRAIGHT BOURBON WHISKEY
FISTFUL OF BOURBON
REDWOOD EMPIRE PIPE DREAM BOURBON
OAK & EDEN BOURBON & SPIRE
HA WELLER ANTIQUE BOURBON
SAVAGE & COOKE BOURBON WHISKEY
OLD ELK 8 YEAR WHEATED BOURBON
OLD ELK STRAIGHT BOURBON SHERRY CASK FINISH
TIM SMITH SOUTHERN RESERVE BOURBON
CODY ROAD BOURBON W/ROCKS GLASS
RUDDELLS MILL KENTUCKY STRAIGHT BOURBON WHISKEY
ANGEL'S ENVY BOURBON PORT FINISHED
FOUNDRY BOURBON
JEFFERSONS OCEAN WHEATED BOURBON
OAK & EDEN SPIRE SELECT BOURBON AMBURANA BUY THE BARREL
BARRELL BOURBON PRIVATE RELEASE
JTS BROWN BOURBON
STEEPLE RIDGE BOTTLED IN BOND 4 GRAIN BOURBON
VIRGIL KAINE CHEF SERIES GINGER INFUSED BOURBON
CEDAR RIDGE CASK FINISHED BOURBON
BARENJAGER HONEY AND BOURBON
ANCIENT AGE BOURBON 80PRF
CODY ROAD BOURBON - CF STAFF PICK
HA WILDERNESS TRAIL BIB KENTUCKY BOURBON 6YR
OLD WELLER 107 ANTIQUE BOURBON 7YR HA
CONCIERE BOURBON
TRAILS END BOURBON
WEST CORK BOURBON CASK IRISH WHISKEY
STELLUM BLACK BOURBON
MATTINGLY & MOORE BOURBON
VIRGIN BOURBON 101
BARRELL BOURBON BATCH 023
CHAPIN & GORE STR BOURBON(DNO)
PEERLESS HIGH RYE KENTUCKY STRAIGHT BOURBON WHISKEY
BARREL BOURBON BATCH 24
HA KINGS COUNTY DISTILLERY BARREL STRENGTH STRAIGHT BOURBON
ROCK TOWN ARKANSAS BOURBON WHISKEY
BARRELL BOURBON BATCH 023 DNO
CODY ROAD BOURBON BUY THE BARREL
PUNI ITALIAN WHISKY - GOLD EX BOURBON CASK 5 YR
KOVAL SINGLE BARREL BOURBON WHISKEY BUY THE BARREL
BOURBON COUNTY PACK
HA HEAVEN HILL GRAIN TO GLASS WHEATED BOURBON
BULLEIT BOURBON WHISKEY W/ MUG
1792 BOTTLED IN BOND BOURBON
CEDAR RIDGE BOURBON
VERY OLD BARTON BOURBON CRAFTED 80PRF
RUSSELLS RESERVE SINGLE BARREL BOURBON
BP BRECKENRIDGE BOURBON WHISKEY RESERVE BLEND ALPHA
LEADSLINGERS BOURBON WHISKEY 10YR
G & W BOURBON
BP WILDERNESS TRAIL WHEATED BOURBON FAMILY RESERVE
KNOB CREEK BOURBON
BUZZARDS ROOST TOASTED AMERICAN OAK STRAIGHT BOURBON
BP JEFFERSONS RESERVE BOURBON BARREL
OAK & EDEN BOURBON & BREW
RIEGERS BOTTLED IN BOND STRAIGHT BOURBON
BROTHERHOOD BOURBON
NORTH FOREST KREME MAPLE BOURBON PECAN MINI
WHISTLEPIG PIGGYBACK RYE & BOURBON SPLIT PACK
WOODINVILLE PORT FINISHED BOURBON
SOOH BARRELL BOURBON DOVETAIL WHISKEY
HORSE SOLDIER SMALL BATCH BOURBON WHISKEY
BULLIET BOURBON W/2 CERAMIC MUGS
RED STATE BOURBON
CEDAR RIDGE BOURBON BUY THE BARREL
BURNSIDE BOURBON
BIRD DOG BOURBON W/4-50MLS
PENELOPE BOURBON TOASTED BARREL FINISH USE CODE 21065
BUCK BOURBON 8YR
BENCHMARK NO. 8 BOURBON WHISKEY
BRECKENRIDGE DISTILLERS HIGH PROOF BLEND BOURBON
CEDAR RIDGE PRIVATE CASK IOWA BOURBON SELECTION BARREL BUY
BALCONES TEXAS POT STILL BOURBON VAP W/ ROCKS GLASSES
HUDSON FOUR GRAIN BOURBON
UNRESTRICTED WHEATED STRAIGHT BOURBON WHISKEY BOTTLED IN BON
OLD ELK 8YR WHEATED BOURBON
DARK ARTS WHISKEY HOUSE (CORE) BOURBON (RED) SBW FINISHED WI
HIGH WEST AMERICAN PRAIRIE BOURBON BARREL SELECT (MACVIN)
CHICKEN COCK CHANTICLEER COGNAC FINISH BOURBON
CENTURY FARMS PRAIRIE STATES BOURBON - PERSONALIZED
HA HORSE SOLDIER COMMANDERS SELECT VI BOURBON
Query:
-- Query 15: Calculate total Bourbon sales by city in Dubuque County in 2022
SELECT city, SUM(sale_dollars) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE county = 'DUBUQUE'
  AND category_name LIKE '%BOURBON%'
  AND date BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY city
ORDER BY total_sales DESC
LIMIT 100
Answer:
city,total_sales
DUBUQUE,862007.69
DYERSVILLE,61103.05
PEOSTA,22748.57999999999
CASCADE,12828.680000000002
LUXEMBURG,10784.500000000002
HOLY CROSS,4211.28
SAGEVILLE,1479.6999999999998
FARLEY,799.2
End Exploring Related Columns
Task: Display the monthly per capita Bourbon Whiskey sales in 2022 for the zip code with the third-highest total sales in Dubuque County, considering only the population aged 21 and over.

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: Here is the monthly per capita Bourbon Whiskey sales in 2022 for the zip code with the third-highest total sales in Dubuque County, considering only the population aged 21 and over:

```csv
Month,Per_Capita_Sales
Jan-2022,sales:float
Feb-2022,sales:float
Mar-2022,sales:float
Apr-2022,sales:float
May-2022,sales:float
Jun-2022,sales:float
Jul-2022,sales:float
Aug-2022,sales:float
Sep-2022,sales:float
Oct-2022,sales:float
Nov-2022,sales:float
Dec-2022,sales:float
```
(Attention: answer in 12 rows).
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'census_bureau_usa': ['population_by_zip_2000', 'population_by_zip_2010'], 'iowa_liquor_sales': ['sales']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-28 01:41:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-28 01:41:17 - root - INFO - Here is the monthly per capita Bourbon Whiskey sales in 2022 for the zip code with the third-highest total sales in Dubuque County, considering only the population aged 21 and over:

```sql
WITH sales_data AS (
  SELECT
    EXTRACT(MONTH FROM date) AS month,
    SUM(sale_dollars) AS total_sales,
    REGEXP_REPLACE(zip_code, r'\.0+$', '') AS zip_code_std
  FROM `bigquery-public-data.iowa_liquor_sales.sales`
  WHERE county = 'DUBUQUE'
    AND date BETWEEN '2022-01-01' AND '2022-12-31'
    AND (LOWER(category_name) LIKE '%bourbon%' OR LOWER(item_description) LIKE '%bourbon%')
  GROUP BY month, zip_code_std
),
monthly_sales AS (
  SELECT month, total_sales
  FROM sales_data
  WHERE zip_code_std = '52001'
),
population AS (
  SELECT SUM(population) AS population_over_21
  FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010`
  WHERE zipcode = '52001'
    AND minimum_age >= 21
)

SELECT
  FORMAT_DATE('%b-2022', DATE(2022, month, 1)) AS Month,
  ROUND(total_sales / population.population_over_21, 4) AS Per_Capita_Sales
FROM monthly_sales
CROSS JOIN population
ORDER BY month;
```
2025-01-28 01:41:19 - root - INFO - itercount: 1
2025-01-28 01:41:19 - root - INFO - 0
2025-01-28 01:41:19 - root - INFO - results: 
Month,Per_Capita_Sales
Apr-2022,1.1807
Aug-2022,1.5635
Dec-2022,1.636
Feb-2022,1.0968
Jan-2022,0.9037
Jul-2022,1.2355
Jun-2022,0.8604
Mar-2022,0.8374
May-2022,0.8641
Nov-2022,1.1009
Oct-2022,1.0372
Sep-2022,1.1365


2025-01-28 01:41:19 - root - INFO - Please check the answer again by reviewing Display the monthly per capita Bourbon Whiskey sales in 2022 for the zip code with the third-highest total sales in Dubuque County, considering only the population aged 21 and over., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: Here is the monthly per capita Bourbon Whiskey sales in 2022 for the zip code with the third-highest total sales in Dubuque County, considering only the population aged 21 and over:

```csv
Month,Per_Capita_Sales
Jan-2022,sales:float
Feb-2022,sales:float
Mar-2022,sales:float
Apr-2022,sales:float
May-2022,sales:float
Jun-2022,sales:float
Jul-2022,sales:float
Aug-2022,sales:float
Sep-2022,sales:float
Oct-2022,sales:float
Nov-2022,sales:float
Dec-2022,sales:float
```
(Attention: answer in 12 rows) The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Month,Per_Capita_Sales
Apr-2022,1.1807
Aug-2022,1.5635
Dec-2022,1.636
Feb-2022,1.0968
Jan-2022,0.9037
Jul-2022,1.2355
Jun-2022,0.8604
Mar-2022,0.8374
May-2022,0.8641
Nov-2022,1.1009
Oct-2022,1.0372
Sep-2022,1.1365
Current sql:
WITH sales_data AS (
  SELECT
    EXTRACT(MONTH FROM date) AS month,
    SUM(sale_dollars) AS total_sales,
    REGEXP_REPLACE(zip_code, r'\.0+$', '') AS zip_code_std
  FROM `bigquery-public-data.iowa_liquor_sales.sales`
  WHERE county = 'DUBUQUE'
    AND date BETWEEN '2022-01-01' AND '2022-12-31'
    AND (LOWER(category_name) LIKE '%bourbon%' OR LOWER(item_description) LIKE '%bourbon%')
  GROUP BY month, zip_code_std
),
monthly_sales AS (
  SELECT month, total_sales
  FROM sales_data
  WHERE zip_code_std = '52001'
),
population AS (
  SELECT SUM(population) AS population_over_21
  FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010`
  WHERE zipcode = '52001'
    AND minimum_age >= 21
)

SELECT
  FORMAT_DATE('%b-2022', DATE(2022, month, 1)) AS Month,
  ROUND(total_sales / population.population_over_21, 4) AS Per_Capita_Sales
FROM monthly_sales
CROSS JOIN population
ORDER BY month;
2025-01-28 01:41:45 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-28 01:41:45 - root - INFO - Here is the monthly per capita Bourbon Whiskey sales in 2022 for the zip code with the third-highest total sales in Dubuque County, considering only the population aged 21 and over:

```sql
WITH sales_data AS (
  SELECT
    EXTRACT(MONTH FROM date) AS month,
    SUM(sale_dollars) AS total_sales,
    REGEXP_REPLACE(CAST(zip_code AS STRING), r'\.0+$', '') AS zip_code_std
  FROM `bigquery-public-data.iowa_liquor_sales.sales`
  WHERE county = 'DUBUQUE'
    AND date BETWEEN '2022-01-01' AND '2022-12-31'
    AND (LOWER(category_name) LIKE '%bourbon%' OR LOWER(item_description) LIKE '%bourbon%')
  GROUP BY month, zip_code_std
),
monthly_sales AS (
  SELECT month, total_sales
  FROM sales_data
  WHERE zip_code_std = '52003'
),
population AS (
  SELECT SUM(population) AS population_over_21
  FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010`
  WHERE zipcode = '52003'
    AND minimum_age >= 21
)

SELECT
  FORMAT_DATE('%b-2022', DATE(2022, month, 1)) AS Month,
  ROUND(total_sales / population.population_over_21, 4) AS Per_Capita_Sales
FROM monthly_sales
CROSS JOIN population
ORDER BY month;
```
2025-01-28 01:41:47 - root - INFO - itercount: 2
2025-01-28 01:41:47 - root - INFO - 0
2025-01-28 01:41:47 - root - INFO - results: 
Month,Per_Capita_Sales
Apr-2022,1.3695
Aug-2022,1.4927
Dec-2022,1.6748
Feb-2022,1.0012
Jan-2022,1.3337
Jul-2022,1.2228
Jun-2022,0.8893
Mar-2022,0.9012
May-2022,1.0246
Nov-2022,1.1825
Oct-2022,1.4411
Sep-2022,1.2989


2025-01-28 01:41:47 - root - INFO - Please check the answer again by reviewing Display the monthly per capita Bourbon Whiskey sales in 2022 for the zip code with the third-highest total sales in Dubuque County, considering only the population aged 21 and over., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: Here is the monthly per capita Bourbon Whiskey sales in 2022 for the zip code with the third-highest total sales in Dubuque County, considering only the population aged 21 and over:

```csv
Month,Per_Capita_Sales
Jan-2022,sales:float
Feb-2022,sales:float
Mar-2022,sales:float
Apr-2022,sales:float
May-2022,sales:float
Jun-2022,sales:float
Jul-2022,sales:float
Aug-2022,sales:float
Sep-2022,sales:float
Oct-2022,sales:float
Nov-2022,sales:float
Dec-2022,sales:float
```
(Attention: answer in 12 rows) The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Month,Per_Capita_Sales
Apr-2022,1.3695
Aug-2022,1.4927
Dec-2022,1.6748
Feb-2022,1.0012
Jan-2022,1.3337
Jul-2022,1.2228
Jun-2022,0.8893
Mar-2022,0.9012
May-2022,1.0246
Nov-2022,1.1825
Oct-2022,1.4411
Sep-2022,1.2989
Current sql:
WITH sales_data AS (
  SELECT
    EXTRACT(MONTH FROM date) AS month,
    SUM(sale_dollars) AS total_sales,
    REGEXP_REPLACE(CAST(zip_code AS STRING), r'\.0+$', '') AS zip_code_std
  FROM `bigquery-public-data.iowa_liquor_sales.sales`
  WHERE county = 'DUBUQUE'
    AND date BETWEEN '2022-01-01' AND '2022-12-31'
    AND (LOWER(category_name) LIKE '%bourbon%' OR LOWER(item_description) LIKE '%bourbon%')
  GROUP BY month, zip_code_std
),
monthly_sales AS (
  SELECT month, total_sales
  FROM sales_data
  WHERE zip_code_std = '52003'
),
population AS (
  SELECT SUM(population) AS population_over_21
  FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010`
  WHERE zipcode = '52003'
    AND minimum_age >= 21
)

SELECT
  FORMAT_DATE('%b-2022', DATE(2022, month, 1)) AS Month,
  ROUND(total_sales / population.population_over_21, 4) AS Per_Capita_Sales
FROM monthly_sales
CROSS JOIN population
ORDER BY month;
2025-01-28 01:42:07 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-28 01:42:07 - root - INFO - Here is the monthly per capita Bourbon Whiskey sales in 2022 for the zip code with the third-highest total sales in Dubuque County, considering only the population aged 21 and over:

```sql
WITH sales_data AS (
  SELECT
    EXTRACT(MONTH FROM date) AS month,
    SUM(sale_dollars) AS total_sales,
    REGEXP_REPLACE(CAST(zip_code AS STRING), r'\.0+$', '') AS zip_code_std
  FROM `bigquery-public-data.iowa_liquor_sales.sales`
  WHERE county = 'DUBUQUE'
    AND date BETWEEN '2022-01-01' AND '2022-12-31'
    AND (LOWER(category_name) LIKE '%bourbon%' OR LOWER(item_description) LIKE '%bourbon%')
  GROUP BY month, zip_code_std
),
monthly_sales AS (
  SELECT month, total_sales
  FROM sales_data
  WHERE zip_code_std = '52003'
),
population AS (
  SELECT SUM(population) AS population_over_21
  FROM `bigquery-public-data.census_bureau_usa.population_by_zip_2010`
  WHERE zipcode = '52003'
    AND minimum_age >= 21
)

SELECT
  FORMAT_DATE('%b-2022', DATE(2022, month, 1)) AS Month,
  ROUND(total_sales / population.population_over_21, 4) AS Per_Capita_Sales
FROM monthly_sales
CROSS JOIN population
ORDER BY month;
```
2025-01-28 01:42:09 - root - INFO - itercount: 3
2025-01-28 01:42:09 - root - INFO - 0
2025-01-28 01:42:09 - root - INFO - Total iteration counts: 3
