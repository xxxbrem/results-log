2025-01-27 07:00:46 - openai._base_client - INFO - Retrying request to /chat/completions in 0.428580 seconds
2025-01-27 07:01:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 07:01:35 - root - INFO - SQL:
SELECT DISTINCT `user_pseudo_id`, `user_first_touch_timestamp`
   FROM `firebase-public-project.analytics_153293282.events_201809*`
   WHERE EXTRACT(MONTH FROM TIMESTAMP_MICROS(`user_first_touch_timestamp`)) = 9
     AND EXTRACT(YEAR FROM TIMESTAMP_MICROS(`user_first_touch_timestamp`)) = 2018
   LIMIT 100;
Results:
user_pseudo_id,user_first_touch_timestamp
9BFA45225ECA7CD4D2A9F956B875CF85,1536252841631000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
AAE4779C1A0F48E482C71DE95A4FA0E1,1536250316038000
B743E27EAEE69B2DD8730CBC77BEC072,1536218334240000
9F5BB05E83166A05D957BD8709452328,1536098922240000
A7642D8075588A1BE483081F553C97DF,1536023893952000
CDB49D27B3BBEDBB8CCF4DC7667E337E,1536264015401000
63550F65F0818B874ADA2B18C463AB21,1535942088041000
D6C62D17A18603EEE645F28835D54DEA,1536037006803000
AFF35810D9962CD8476636476A2831D8,1536246915955000
DF2035402F934E7B23D97854C02A1F09,1536239302803000
626009813D7731D71D9DD3D396969BB8,1536125876733000
FBE5BE5E3836527EC27D14834D72B911,1535983155261000
386EE7D00E029293C53C2ED7319EF520,1535984279068000
9434EE4CFDFE0F5BCFE40126A569F3BB,1536285147163000
8AFAFD6D7E79149C91BCAE1995E0CF47,1536016575547000
891646F131CE2CCADB5D6676A104CB9D,1536301611312000
EB4432A4BDAAB8F5135FCB36503ADC7D,1536218182096000
3114BB0EE700894607B258BC4706797C,1535996857253000
58870D4568AC2C4018EEFB6DC4C482B1,1536266754437000
66AFD4A2B8BC073FC2021F5C42CC7C86,1536219413946000
96685CED0793A219EFE8976477D7DA56,1536186767086000
A1D0D1B1F6207F2A909227367541C6A8,1536286657613000
C96F1CB586725A7D165BCF665C131114,1536242048001000
D62EDD239EF72D80713B3414F1A7C541,1535880212225000
AE0411EC55F2110C13B66F25B7EFBF6B,1536274454849000
F73A0D4A6FB35C664DDAE0F4F145F8B0,1535977576310000
F2D468D41FB8611C8741B01EA2E1F0EA,1536280157153000
7107B8B93B285616D099D9010F6AD834,1536115583995000
4059062E59F3605CE7A574DCD9997571,1536342135786000
4549717C06BAFE84FB1FFE5DDBD7EB2E,1536473880826000
A01A048A0E5413157039C956EB8CC1F7,1536301208546000
09309F331FA528745E330964AF4AAAD8,1536587870540000
AFF1ED962C29150288A2946235923125,1536862632351000
E700BD83FAFB7509FE2F45F2D7554326,1536895641663000
29D150D22AF86AA1AE6B56F5B9123D43,1536843947316000
501EC0B173398B023AB5B9A315FFD673,1536464926260000
65F8E2B80A986C0FDF372EF08A031483,1536894048713000
70D2F634EB46DA3061AADBA078ADF7E9,1536895369745000
596FCBD95E3C6C24EC450B4BB7F12D18,1536855961339000
E75BB9320BCFA56BF42AAC320A56CBAE,1536649943600000
7F2D59D791EB2BFCE7DC5B694C3FE456,1536846791130000
AC14AD9D158A2A5449E120A33D5B55BB,1536867225978000
337A3F347AE32CE90A631DF3028500A5,1536893318746000
FF2D6D2366E710D0FBF8BF00D2081ADF,1536890514607000
AC86F727F3237AD98B97B536AE6A8035,1536777677934000
35929D52C47DAC927FFFE0BA6F8343E4,1536861877539000
957033925A8B7F2A2C2F4577E786632D,1536760864920000
DFD440E5A6ED9EB7BEE70013C9CB82DE,1536853410754000
819D386099AA9B435B3F4B261D3553F9,1536900346679000

2025-01-27 07:01:41 - root - INFO - SQL:
SELECT DISTINCT `event_name`
   FROM `firebase-public-project.analytics_153293282.events_*`
   LIMIT 100;
Results:
event_name
level_complete
level_reset
firebase_campaign
challenge_accepted
os_update
in_app_purchase
level_end_quickplay
level_reset_quickplay
app_update
dynamic_link_app_open
notification_foreground
challenge_a_friend
level_fail_quickplay
user_engagement
completed_5_levels
use_extra_steps
level_retry_quickplay
app_remove
dynamic_link_first_open
app_clear_data
select_content
level_complete_quickplay
session_start
level_start
level_end
spend_virtual_currency
first_open
screen_view
app_exception
level_start_quickplay
post_score
level_up
no_more_extra_steps
level_retry
level_fail
error
ad_reward

2025-01-27 07:01:47 - root - INFO - SQL:
SELECT `event_name`, `user_pseudo_id`, `event_timestamp`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'app_exception'
   LIMIT 100;
Results:
event_name,user_pseudo_id,event_timestamp
app_exception,8E2CA56C1FD81A095DECAEDE6F2ED626,1529870477611003
app_exception,8E2CA56C1FD81A095DECAEDE6F2ED626,1529878542015030
app_exception,8E2CA56C1FD81A095DECAEDE6F2ED626,1529878653520012
app_exception,8E2CA56C1FD81A095DECAEDE6F2ED626,1529878760952011
app_exception,8E2CA56C1FD81A095DECAEDE6F2ED626,1529878937377014
app_exception,FA30269453141794E79B8F15EE0BA5B9,1529836008874002
app_exception,32A6DDD2FF644EEC9C87F474040389DA,1529836049301013
app_exception,1B2FC37816CC4DDAACA97A75E685756F,1529827489236002
app_exception,20381657DAEE3E67B8DCF5A716C059D2,1529876114014003
app_exception,7AD772ABC639D8C0C7F1C05ECC7818F0,1529850675256025
app_exception,326651F167D600272DA4EC5EE0618D07,1529869953304049
app_exception,326651F167D600272DA4EC5EE0618D07,1529870253317023
app_exception,326651F167D600272DA4EC5EE0618D07,1529870291142011
app_exception,5635A012FC2AC25176B2B2BC4BFE8026,1529851174412031
app_exception,326651F167D600272DA4EC5EE0618D07,1529869164888019
app_exception,326651F167D600272DA4EC5EE0618D07,1529869384517016
app_exception,326651F167D600272DA4EC5EE0618D07,1529869482645014
app_exception,326651F167D600272DA4EC5EE0618D07,1529869556456011
app_exception,326651F167D600272DA4EC5EE0618D07,1529869703025011
app_exception,6FE6726C48A23DADF583469EF441941F,1529896937299007
app_exception,6FE6726C48A23DADF583469EF441941F,1529897227287040
app_exception,6FE6726C48A23DADF583469EF441941F,1529897211103052
app_exception,A1DE82672878364D12AFCED708CBE594,1529869986586004
app_exception,D6F5820E5B2C721C1677E1BC873B074A,1529903621665014
app_exception,C3326C2CCF5D46173E4973A13512B163,1529901990758004
app_exception,827C78D61F55043F0E925C03F0311FAF,1529862225095003
app_exception,E5A2CB7A471E740E758BE5E2E0C79BC2,1529838963179040
app_exception,E5A2CB7A471E740E758BE5E2E0C79BC2,1529840394341151
app_exception,D4F4DAEF5BE38E5C67FD72BB1F082EBF,1529853268850002
app_exception,DF7B1F6B6AEF483760B6439EF91BC26A,1529898810351001
app_exception,30F6F3C74D5D408E5F9A76E20F4D2BB3,1529850795892005
app_exception,E080406D26F71C9B8F331779CE8B82BA,1529840831719002
app_exception,59FBE83E879F468A15B415CD8301B346,1528882476269019
app_exception,59FBE83E879F468A15B415CD8301B346,1528882760651010
app_exception,59FBE83E879F468A15B415CD8301B346,1528882833103010
app_exception,7566596A1D6ACA781692A7A0B89B06EF,1528911496161002
app_exception,635BE6A3D887B6B3517FCF2324C4C1E0,1528925028404003
app_exception,9243996A4E06EC1505D57AFDF7E84E66,1528916497305014
app_exception,6895EEFC23B59DB13A9B9A7EED6A766F,1528956277865011
app_exception,6895EEFC23B59DB13A9B9A7EED6A766F,1528956422260012
app_exception,6895EEFC23B59DB13A9B9A7EED6A766F,1528956459149019

2025-01-27 07:01:53 - root - INFO - SQL:
SELECT `event_name`, `user_pseudo_id`, `event_timestamp`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'app_remove'
   LIMIT 100;
Results:
event_name,user_pseudo_id,event_timestamp
app_remove,8046473848C0E0F86B801F15D438D7A3,1532310283108106
app_remove,8137A61045BFE96DD2B6B833C6803642,1532293361378016
app_remove,DA00B27EE3A7FA06D967B74E0D440E5E,1532256138516042
app_remove,32C3039A18B8BC54D469BD784E3E65F8,1532293867230000
app_remove,50C0AAC23307E008A37574D40D607CCD,1532244140538001
app_remove,DC930EB0BCF5A8A2233B766CEB3EA42D,1532279711773000
app_remove,A83713EF270EA35A03A4784C0A3662A9,1532313082083000
app_remove,CE37961A20C06C1ACE22288FA9851B39,1532315685481182
app_remove,F00520A971B304A0B45AF31AECC75826,1532243299706010
app_remove,D01606C77D7658EC936CCB4C37A838D9,1532270925160000
app_remove,4704A291A6B5E598E364EBDCBCCC9446,1532258685108000
app_remove,824D686213A09439DBCCC406B0739558,1532305044920027
app_remove,66716FE2A831B1606A2507E6ABF10F68,1532275600060000
app_remove,8E5E12F3522FBBD21F72548309DB2C33,1532293488397000
app_remove,46CD1BC25288939026C6A0107240C77C,1532323540531000
app_remove,8365302EA50623D13816D680993C07AC,1532329115609000
app_remove,95E62884FEEE94C5CFD56F7BE33697FA,1532312102459000
app_remove,75D4077943E2281AEBA789BB5E0E2780,1532243578535000
app_remove,0F24544604D3C9D09AFCEDF0804673CB,1532328500679000
app_remove,CEF9B763F040531679C7B86A1F05F6DD,1532258694006000
app_remove,AF22CF225D76C2405C85DEE54231D1DC,1532246898428048
app_remove,569FEAF5DD2B400D3CDDEC44777EC627,1532316824784000
app_remove,53649082C25AB9A9CD1E394EBBA9CEF3,1531390454302009
app_remove,872063888F20EFD35EEBA3D16C953853,1531416777326000
app_remove,A87A30159D909E2356F72AAC76F26707,1531442042403000
app_remove,8E2768C381113D72B39CCE7961BE5481,1531421217337032
app_remove,C00AEA479F0CF6F16BFEF6DE644F76FC,1531435661961000
app_remove,BECAE3B757D93900084EF7404D609D4E,1531402968080016
app_remove,55CA70077121BAB756139482239C7337,1531456246237001
app_remove,07091112737131E5726D839AA3917CC9,1531425020419000
app_remove,80DDC8E9AEBDBEEC1DD485E207430740,1531412704595000
app_remove,B386B3D771140CCEE8CC603EA7F282A4,1531432546223000
app_remove,3854B836FDA5CDA15382843A8EA25684,1531438885848000
app_remove,C2C8E0E8C41AA5C46818FF7008C353F4,1531422113552266
app_remove,09BDD816257873A6FD3E231C5DE598D3,1531416041272011
app_remove,67428F96A060BAEDF71D7805BFE20D00,1531448682565000
app_remove,6900CA1B70E56BF02E5A59B43BCD73EC,1531430439051000
app_remove,2276FE6CB99CED85F2A038871B9D2E0C,1531384062164000
app_remove,E4D0CD43ECF1890C6D20D2EC09153E02,1531410460664000
app_remove,16535A918ADAE06E4E30A71918B6E92B,1531443624176000
app_remove,9DAAF8ABC5DFA8F18FC4FD1897EAF19E,1531410922465000
app_remove,68E7D392F7438427575FBDB8B518265F,1531399670057000
app_remove,837F7400F8D751E5E5FCD6818FF7E9A2,1531463904957000

2025-01-27 07:01:59 - root - INFO - SQL:
SELECT `user_pseudo_id`,
     MIN(TIMESTAMP_MICROS(`event_timestamp`)) AS `uninstall_time`,
     MIN(TIMESTAMP_MICROS(`user_first_touch_timestamp`)) AS `first_open_time`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'app_remove'
   GROUP BY `user_pseudo_id`
   HAVING TIMESTAMP_DIFF(MIN(TIMESTAMP_MICROS(`event_timestamp`)), MIN(TIMESTAMP_MICROS(`user_first_touch_timestamp`)), DAY) <= 7
   LIMIT 100;
Results:
user_pseudo_id,uninstall_time,first_open_time
7705D52DD2286DC2E6DB831A2E129E94,2018-09-10 20:49:34.534044+00:00,2018-09-10 01:49:22.346000+00:00
DD0CB20147767F174CE7F130D2E66FF1,2018-08-17 18:02:04.104000+00:00,2018-08-17 17:07:38.476000+00:00
533E79DF88C5D3B27AB10A32F8185503,2018-08-21 23:59:14.497000+00:00,2018-08-21 23:23:18.933000+00:00
316C65000A6DC054CDBDFF5123898C68,2018-07-11 17:20:12.646000+00:00,2018-07-11 15:31:46.853000+00:00
8A8767DAACDC3F673378BD6B3574C061,2018-07-11 12:27:33.154000+00:00,2018-07-10 23:57:27.585000+00:00
2C8294A0EF5FF73A6C43819F67D450F4,2018-09-10 05:58:48.121006+00:00,2018-09-10 03:25:26.253000+00:00
F9231C977F262065AFA5F376C746E0ED,2018-09-27 18:28:07.047000+00:00,2018-09-25 17:54:21.738000+00:00
0018E9BAF92AFA2FFFCDCB5F48A3B134,2018-10-02 11:06:02.107000+00:00,2018-10-02 11:05:46.281000+00:00
A33B3E5D320A35A5BA168F271D6BC956,2018-10-02 10:09:33.058000+00:00,2018-10-02 10:07:57.142000+00:00
6B41795D5E5B7339E007330941C9E201,2018-06-19 15:35:56.955000+00:00,2018-06-16 00:16:54.339000+00:00
22758EB02AC5EADF2CB2F8533D85603A,2018-07-24 04:44:55.056051+00:00,2018-07-24 03:58:35.306000+00:00
0F668D1FE72425834C6A5EE9F4F53BCD,2018-07-24 05:07:35.964000+00:00,2018-07-23 19:53:22.393000+00:00
FB1F87054CBD0625890297427AAAD990,2018-07-31 23:30:47.913000+00:00,2018-07-24 04:38:47.537000+00:00
FA1CBA7312F0DDF83E2EE1573E400043,2018-07-31 20:50:40.190026+00:00,2018-07-31 20:48:53.987000+00:00
1290BCB61140CAF8CE8A5E8FFBEF16B2,2018-08-01 02:10:06.303026+00:00,2018-08-01 02:08:55.163000+00:00
28BAFBF9921B80B84EF45326F2CF9746,2018-07-31 15:13:53.683000+00:00,2018-07-31 12:31:18.935000+00:00
B79FEE3597E3C4A3B5A38FE33B684341,2018-09-11 19:32:27.122022+00:00,2018-09-11 19:32:00.188000+00:00
F37788083CD17FEF93F66A5A8CFA9BCD,2018-09-11 22:51:03.714004+00:00,2018-09-11 22:39:48.810000+00:00
41B8B6917AC3C354AC6A10CDC715FDDB,2018-09-11 16:47:37.978013+00:00,2018-09-11 16:45:40.745000+00:00
289290E298ED08B95B10DE971359B101,2018-09-11 17:29:43.196182+00:00,2018-09-11 17:14:25.192000+00:00

2025-01-27 07:02:05 - root - INFO - SQL:
SELECT DISTINCT `user_pseudo_id`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE EXTRACT(MONTH FROM TIMESTAMP_MICROS(`user_first_touch_timestamp`)) = 9
     AND EXTRACT(YEAR FROM TIMESTAMP_MICROS(`user_first_touch_timestamp`)) = 2018
     AND `event_name` = 'app_remove'
     AND TIMESTAMP_DIFF(TIMESTAMP_MICROS(`event_timestamp`), TIMESTAMP_MICROS(`user_first_touch_timestamp`), DAY) <= 7
   LIMIT 100;
Results:
user_pseudo_id
782A0F243E58A79260C76789CDD139AA
8BE102266AF2AEC727AE08D0A5241DE0
80FD9717450806029DA432E39BBB5DFD
1CE53B7BFD311B79EBE02347FAA21B4C
E67AAD89794950F36FFE36E8DA277021
C83DB20A4364A88C81A58AC7B47EC995
3EBDD6F7B6591A3C86A571852D3E7338
D65E01E352085FB9B51FC7556D8653D9
703E9B982BBB52A7374FB3A73A657191
E98C2033935E43DBA50950F7039FF492
FF2D6D2366E710D0FBF8BF00D2081ADF
5DA9B900E7C9F71714FB1AE9DA631C83
E22B5A1417E856AC0E9C8B633B59AAA0
A759925C7E035CA52AC6C214671DDBBE
6E54FCD5F4543ACDB7412812A857FD74
50B507B8C1BD14FA0BC9BE6991513DFE
57E7A689A86A94D750A4C68220DDD679
4ABF69A40A3BC6057CD49D74A6C18AC2
9153C9C8AAD9E53057C0869DECD75472
7B6CA3391592F0D3B11865D782C685CF
B7F7B01204A87A92985FCEE1F9880681
273B2F85FFD9D20FA585DFC61CAF3CDE
6D6EB70E837A5007BE550C44FF276440
97D9D96077AD3E8859BF5C54C873E59D
B9D800D33FDCF7AF2157CB66910A0797
DAD134C77F7E09BC552E290534CB90E8
02508ACF3E0BA4D0C4770C03817AFDE3
0EFA419FF8D1FB5BAA12E4794D511937
03C8FFC95DEC2C1E87EB4646970FC12E
61814C6B80D24FFDE5FEB59D61FD5B1C
B9DFF32CBEB23C14C0CA2E839FBFA852
8310DC2A15DC92C13DF598D4C7C35F9C
D7EF597CFE7E3923048F66F89F156165
1BDCB994173E8A509680B6351EE6A3AE
063FC523E013130DB87EA578A4BDEF4A
8BFC094ADB7C9840E2F95B2921F9336B
127A3DF5245F2E0AEB1085403FBBD713
3B2F510266EE4C430F9105E6D77F9084
77538D72AC418FA45C2D6CDBEB4BBF49
CD1D906FB130FF55A227F2DE79F0C15A
14CDD9706D24046F309F81C86687A25C
06651B7BD90A9520B007ECEBF08EE9D6
CAB801638B9B8022310A07629D49EBCA
2CEFE82BDD9A12BE3F9F09083C8812A4
B6F60284DE6FD9D98BE07E37EE989CBE
86E29652B3E743AF9DB8812104B797B6
EB94D0269C6F5FFF876CEE91940B1FF1
3980D574A7D5B9088AAAFCBFD18FB050
DFD440E5A6ED9EB7BEE70013C9CB82DE
5DD61074AA5F92DE0CE1F00516BFDBF5
1CD1D85F7C39D7814EB1A4C55646D717
4A2A03B50BDA6AC1687703BD39A91E3E
9EAAC1C6222FFE3D209C02C81C20F2A2
2DCC8C777D4D165D7539553D047B32F5
A33DE80957EE65767566B772BC3E8BA5
E1FEA6BA9D049EF343C2D18C13E32756
CFF34B5186EB1563295F0058BBC7CC0B
0798BB6B8C026CEFB003241B31932B67
95475D4BC44186852209441392FC7F92
376E71CB4C92528ABE7D6FDC9CBCDA09
2DC473377FAF752C77B586711AA66A90
E6BD402E986856BE45A107744EA310EC
3F512C35009AAC06F811B31413462B45
D963E509346C0E5358ECFE56AF3BB2ED
D8B77A575B5308D161F95ACF515F9772
108522345C425B9AEB5F83FE07C1A3A4
EEC7FA9B9E05990005FF736DCCADC24A
242B37810A135CF0A8CA54D6B21D3250
9F162037940FC15E9F3A3E9DFCA4D2AE
A51A3E253AE3F2668DC50CB1AE96D60E
B3234CECCA15CEE80BDE39DA9D8AE687
C6928D8A0DAE782911786BF2C5614279
B6084E4BDF1F19A277C07ACB37026177
622765D1DD641D4F0115C9DDD63F05EF
9EEF99CE81B3CB2D6AD1C850953E2871
B43BC1AF8B548310005F04BC42441D96
92CF66DE321FE11709C46304D5A99F1D
97380FCE77BAB6B251B50DDE4ABD8F8A
408354544760D27F10CCA7CF9B4E43D3
4C2614370EF19318C141072F3EBFB9EC
BE042BC1484A69E1731FB487C1AD34B9
C1F519708675990E7A5FC68A65396327
78E9738DC83BE674052BD4621BB2F113
B79FEE3597E3C4A3B5A38FE33B684341
F37788083CD17FEF93F66A5A8CFA9BCD
41B8B6917AC3C354AC6A10CDC715FDDB
289290E298ED08B95B10DE971359B101
92400633510BB9E545007254608CF161
E5E4C7E5600DD124D56BA0B0FF41B07C
70D2F634EB46DA3061AADBA078ADF7E9
8FEAB3AAF7434731E003747C511F06DE
EF6D6B0B8836E4B95ED7D8FCBAF0BF6C
2C8294A0EF5FF73A6C43819F67D450F4

2025-01-27 07:02:10 - root - INFO - SQL:
SELECT COUNT(DISTINCT `user_pseudo_id`) AS `crash_user_count`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'app_exception'
   LIMIT 100;
Results:
crash_user_count
789

2025-01-27 07:02:16 - root - INFO - SQL:
SELECT DISTINCT `user_pseudo_id`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` IN ('app_remove', 'app_exception')
   GROUP BY `user_pseudo_id`
   HAVING COUNT(DISTINCT CASE WHEN `event_name` = 'app_remove' THEN 1 END) > 0
     AND COUNT(DISTINCT CASE WHEN `event_name` = 'app_exception' THEN 1 END) > 0
   LIMIT 100;
Results:
user_pseudo_id
25D6702EA0A98A6284D9FFCEA0D764A4
F815B786873376C0A296AB5731FB8524
50FEAE9ECFE22E951E8810622A2E8F66
FF67B1C2BDF236F255703B1F4CD41EB4
503AB1BC9E19C89B0425ED404E60F062
9BC94B3773C8304A9E101AEBCFEF4A5F
A4CEEF26271DB9DC4A825B9E6DD8D8CA
2C42FD4D96863B75026B71D2BDEC620A
1F91CA88C5E106304CDBD9C769FEC3E4
5E694DE02688C2FDDEA38A6946A4CC3F
21DA809CF1B07A7E8D2D73D9030FEEBC
7207044281C74501C14233463AAD9A71
02084E10F9F1052182B5602D6CDC50BA
D7C4BD696A49356175EE064AC6195452
1756558602A5C14A5DD2AD4B696D2191
0B74484DD41F519B4810A14A953CAA18
79CAA00790D06BC25052329F4ED99BFC
32A6DDD2FF644EEC9C87F474040389DA
6AC7CD91D56EECD5451A8FA289528AB8
8EDCB7851F10B51350C78C208BEF4A4E
34752CBB38EC5E1730FADC1F8D348B92
CF3F621F23B4C697E784B0998A1DB94E
6B8035863BA8F90EDD28470F84922BB2
8E6F7A428C907165D78A2377ABEB7315
CF62C17E245938F28D9A86634660A2FD
A622BBB66D14F224D949A6A86B87D4BA
EDD7CD144CF227FB54453390F3C06408
F7C26C99D64FCE9BC900822234927579
8E1749E5A26DD54E346476A289854E93
FA944230F31FE2B6FB255BFC9679C0F8
EE2010FFDAF663BCC722160AB9954A1E
635BE6A3D887B6B3517FCF2324C4C1E0
B240CAEDDBC7AEE341900E113CED23DC
0F668D1FE72425834C6A5EE9F4F53BCD
6702A2EA5F6159151ECDF9937BB44AAD
7CBF44EFDDB9E6401F31786BEE071196
3D7382CF3E5091189D2961E0EA3A2ACE
23670FFEF0FFC29FF59EA8E1A82E3A93
3D9CD866FA73F2327C3B63DF16A477D9
E1A3C786B2E4D56629EE808A3A174995
C1018981990B7AE4E03EBF648564C3CE
139C75296C846C004181A2A4A80C13C2
2920B9D90561E521425DE4849FAAD1D7
B7E6580376A092AF1D8ED36A96EEF943
522BA55B8CE6E00DBC4CDC5DC232E3F1
2FF4899DE9DDAA94D3744575196D9206
906CE0DA38E7D9DE597CA459CC907950
C2C8E0E8C41AA5C46818FF7008C353F4
6DAF0604F8AE54374593DBB13DD2BFD6
154287464C4F84AF86699BC92AA1DAB5
FD807541F1DE049B5D16ED3EE2DCF160
3E8245CE87EEDBDF995B682A717AE2FC
4D38AF508E466CDF5FF6FD9F93892F1E
793008133AFD953B70E6B9037D70D2A6
C0AA6F95B35D0D803F47B299269E716D
BC6503564939EA61982B7111F9051C50
9B18A1CBA96D52D05CFA7CB7C9011EDE
9664FAE9A17FD550BE78549EEA2773AC
171871CA6AF9A891FB7B3E19CD144B2E
97B422DCCB84169BF11FF0168929E31B
59FBE83E879F468A15B415CD8301B346
5256B2B115955E80DDB7449775D92325
747538074CEC9FE551F488F3E47F9FD9
A20E7E669E319B0A1912A187C4169AEE
5346C62F49BF2E6C1199456F16604B3C
9A10BF8F0166076BD918A5027396A46B
CE56946091344ADC2D0AB88D49B83ED1
619893E8C20EEB450207B65496CDBCC5
B7D2B63ABE215157570ABD2E2E6EC9BE
78CEA7AA04666D7924A253A4AA4C1F4C
6A2F4E7AB1816D2F6EC741BC92141766
BB4B254D4020E22E9CE5885C8AB28F87
14820087732D43CA92C816CA22E9FDCD
DDFE0B623F523F68FF0A338D5B6F3FB8
44561FB4558913850A7857FC521C1C42
9739CF7747700632F707FE234CEA7C00
FD9223BA1689E43F814C545A5FEBA7F4
EECDCA8076D5842922767F5C08957B17
20381657DAEE3E67B8DCF5A716C059D2
7E438E53A94A9E6EA6531E272C86F512
788B593C9AFEBAEE6374CDA08F16FAC6
DA426D16B0EAB27DE1AC9D6E3418F400
0CCC9C71BC84C8B2503B9EE93191D263
A64D09F4DE2FB21E17EE29D7B77081EB
667B1425546E7502CD66F9DF0C6321C1
DF2FC56E807EAF16E852AEAB67E0127A
1A3C9B890548F1BCE865FC5422E08672
C006BDD387158B17AD45F2BC0F346048
8AB29C262591541BA945BF48D74DB5F5
9F0513E2CCD4655D6EB7C59AE8C5BF9B
B83E97CDE1FCF1D681206DFFC5F1898E
C11D2CEE54EF4DC4655B7D87BC1B7F1C
8E2768C381113D72B39CCE7961BE5481

2025-01-27 07:02:21 - root - INFO - SQL:
SELECT `user_pseudo_id`,
     ep.key,
     ep.value.string_value
   FROM `firebase-public-project.analytics_153293282.events_*`,
     UNNEST(`event_params`) AS ep
   WHERE `event_name` = 'app_exception'
   LIMIT 100;
Results:
user_pseudo_id,key,string_value
DA426D16B0EAB27DE1AC9D6E3418F400,fatal,
DA426D16B0EAB27DE1AC9D6E3418F400,firebase_screen_class,shop_menu
DA426D16B0EAB27DE1AC9D6E3418F400,firebase_event_origin,clx
DA426D16B0EAB27DE1AC9D6E3418F400,firebase_screen_id,
DA426D16B0EAB27DE1AC9D6E3418F400,timestamp,
5BFDC0426DE9C09CA5FF18E4982F2506,fatal,
5BFDC0426DE9C09CA5FF18E4982F2506,firebase_screen_class,shop_menu
5BFDC0426DE9C09CA5FF18E4982F2506,firebase_event_origin,clx
5BFDC0426DE9C09CA5FF18E4982F2506,firebase_screen_id,
5BFDC0426DE9C09CA5FF18E4982F2506,timestamp,
7CBF44EFDDB9E6401F31786BEE071196,fatal,
7CBF44EFDDB9E6401F31786BEE071196,firebase_screen_class,shop_menu
7CBF44EFDDB9E6401F31786BEE071196,firebase_event_origin,clx
7CBF44EFDDB9E6401F31786BEE071196,firebase_screen_id,
7CBF44EFDDB9E6401F31786BEE071196,timestamp,
4BDC831A6940071E2461D0B5293A329E,fatal,
4BDC831A6940071E2461D0B5293A329E,firebase_event_origin,clx
4BDC831A6940071E2461D0B5293A329E,timestamp,
7FD3B52661B5030E97AA98C6449BA790,fatal,
7FD3B52661B5030E97AA98C6449BA790,firebase_screen_class,shop_menu
7FD3B52661B5030E97AA98C6449BA790,firebase_event_origin,clx
7FD3B52661B5030E97AA98C6449BA790,firebase_screen_id,
7FD3B52661B5030E97AA98C6449BA790,timestamp,
D3F06F9B7BD9D7FC8758BF78BF0705E9,fatal,
D3F06F9B7BD9D7FC8758BF78BF0705E9,firebase_screen_class,shop_menu
D3F06F9B7BD9D7FC8758BF78BF0705E9,firebase_event_origin,clx
D3F06F9B7BD9D7FC8758BF78BF0705E9,firebase_screen_id,
D3F06F9B7BD9D7FC8758BF78BF0705E9,timestamp,
72F09205C195C6255BB88E9207C9CD49,fatal,
72F09205C195C6255BB88E9207C9CD49,firebase_screen_class,shop_menu
72F09205C195C6255BB88E9207C9CD49,firebase_event_origin,clx
72F09205C195C6255BB88E9207C9CD49,firebase_screen_id,
72F09205C195C6255BB88E9207C9CD49,timestamp,
C006BDD387158B17AD45F2BC0F346048,fatal,
C006BDD387158B17AD45F2BC0F346048,firebase_screen_class,shop_menu
C006BDD387158B17AD45F2BC0F346048,firebase_event_origin,clx
C006BDD387158B17AD45F2BC0F346048,firebase_screen_id,
C006BDD387158B17AD45F2BC0F346048,timestamp,
F08C95B4C15C48637756D065797987ED,fatal,
F08C95B4C15C48637756D065797987ED,firebase_event_origin,clx
F08C95B4C15C48637756D065797987ED,timestamp,
E9E777B58E17AE5695695BD3B68B255F,fatal,
E9E777B58E17AE5695695BD3B68B255F,firebase_event_origin,clx
E9E777B58E17AE5695695BD3B68B255F,timestamp,
0CAAA1B6F161BA4D363EB7A2DEF64A08,fatal,
0CAAA1B6F161BA4D363EB7A2DEF64A08,firebase_event_origin,clx
0CAAA1B6F161BA4D363EB7A2DEF64A08,timestamp,
B5F3D00E28A57C9522F2DEE3CB903DD1,fatal,
B5F3D00E28A57C9522F2DEE3CB903DD1,firebase_screen_class,shop_menu

2025-01-27 07:02:23 - root - INFO - SQL:
SELECT COUNT(DISTINCT `user_pseudo_id`) AS `total_new_users`
    FROM `firebase-public-project.analytics_153293282.events_201809*`
    WHERE `event_name` = 'first_open'
    LIMIT 100;
Results:
total_new_users
1349

2025-01-27 07:02:30 - root - INFO - SQL:
SELECT DISTINCT `user_pseudo_id`
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `event_name` = 'app_remove'
      AND `user_pseudo_id` NOT IN (
        SELECT DISTINCT `user_pseudo_id`
        FROM `firebase-public-project.analytics_153293282.events_*`
        WHERE `event_name` = 'app_exception'
      )
    LIMIT 100;
Results:
user_pseudo_id
FD034D7D200F23C38A941FE5BD5F1042
B6B8C0DA3E4895115A7C8E09B23AA079
E83D71D465C83BB00F6C0C5DBA5466CA
FF4280B9B55198495A46A8D157D337D5
0393E8CD10D9BAF3E2F06D31395151E6
985F451F66CBDE8F3D4AF608CDEF5B46
8D8EE6C485ED68C57C0461D6E9F74F2E
7B33416E0219E1C01561CA9F5917551B
B4BF7DC0B389F9822DEFF9A0DD821CEB
A161D33D29F8E607E3D4AD6314CA30BE
3A1B5A55C33A7EF1A37C909A753606B8
2CC80ED018DB2338C8A0B887DEBA1AB5
C4F3977886A116E9EC70CC984A966477
56F52601C8B237D2D80176B6AF256D1C
ACEC237EDDCD21DE77B2FE430409E4A1
8E2A5EB88B14BD966171099E577DC1B1
528A3C7818ED6D6B4DBC32588DECFF79
2B26B53D4CD155A3EF1FF0A91D339D3E
5E55193500989E57EBB5BD16E059B975
0EBB3115DF5D11266CFF1EBC5B08106A
A87A30159D909E2356F72AAC76F26707
7FA49E8C954E096C4F779C75D5ACEA89
F9231C977F262065AFA5F376C746E0ED
F476C649BB127FA13E0E91F3D662F0B6
E3048636D8BFB4E0D668CE6FE9F69AE4
F94C109612F167FE0ADFE5064B60B46D
91A2560153399B4323A14CD148CB2F1B
5050A23C57CDD81051C3B1D54D545334
2E98271C4DE172F7AA1BB10FDEEA3913
622CE5108E0572C1006A11FF399522B2
82EC0357F7A97115EB30AFC798B49EFA
F0133C453901CA70C9101F0550E81AB3
525465FDD7403389EEC1845BA52C6471
58E93B5F7024A0F13362F708E164A718
962AD93C16D677E4EA7E360D561B76E2
67ACBBE2B2AF1E5B1A94D33F2BCF101A
8137A61045BFE96DD2B6B833C6803642
DC930EB0BCF5A8A2233B766CEB3EA42D
66716FE2A831B1606A2507E6ABF10F68
60FAC27D8495BF33C2AE5283A7B07005
011068A78F16C35DE89A649B12D640DA
F470625FCD13350142D1FAB619BEDE53
A6D1D1E727DC7BECB3C3B06E0BE5BB63
C88B1D3F6DEC26E03432899B55EE420B
EAA452C246E3CCD96ACAE0634C16443E
BF8C377689B7FCE5F3CF99EFB606DD5C
86FB984815DDC86C8079F9EA4C705ECE
E270414CD8C904F7BB039FB243540B3E
A8A510DCC86FAD0C92CD0081E04EE829
6AA53FDC098AAE06E8F06E9D6475B41D
CB46ED7A0C52CC8F5BF3F695631CFCF2
BFEDE353E3CCE9028D1ACB8CB3760A80
B66386AB66C4C30AB58129141BB76125
99893A88D6E3FC238CF49C830005E049
92D613354268A0E592A3032CFE1D7987
4A74F895139C481B907A37EE5D25BA1B
E68A264ADBA1C799CEC92C1B6D234E2A
122B9693B647802ACC0727BF5A36F75E
77E2DDCA98F2FCF01699468B1B06D01E
B8976A95667DCA1F0986ADFE24AAEEC0
2AFDF5157A3653573A891CCB3BB20C89
FD9F628C7B3A0A9EB266FC7FCC5E597F
E6DACB396AFBAD52C3AAA62AAAFED1B2
4D5153DEBE069E129263E067172E3F7B
10CD441F79B53D8F7E281C38ACBEE2C3
C98FE4C10160A105798C65E6AA160974
40972A87661D837BA8B80C3EF122FDD9
78F8F9830EBD020AFAA6B6608E673C62
E536827798DB693614D14B2B727EF743
EB77017C771046704B0582544C3F9328
2F5BBABE9DD0271DCD62E501F76DA736
FFFF9A8B436FAAA293AE33E8C6D3ED66
E515909D096AFF6A5E06A2EDCD9FCA22
94F34B922E39558292B971D631807132
8C988A305F1F269E13D776EF0E1576BC
656809A54882C03F52A8EA425D8352C9
0EC790DED453E8256A40DA3139407C97
B175B187062693360BCBADC4160F8D88
7064BC64E47E869B36967E854748969E
B2912116E7B957900D6B69D4E50F0F9A
91FEBAE4337BFA2EF7E6F50DA0D40432
2CFE23AC4E3C6529D39BDADA1EF99C52
2C7A0851C697F03694BF4364695CA6C0
BA68AFBA94C53DA2DE67AA683078AD2A
F811FA3ECC2BA9F049E5A216FAFA301B
7C8D8B75790229C5B05F6D31E9BE6254
DECC7F229E296F92B5F1C66174132690
0FCCC37C632A22AA9C16512A56828CDE
FB36A16D10ED7285C7FEBAAB0A0F992C
88AED337A2425080A1E6CE737B0B3915
56BB8C5154AD6D11F06903EBC42DF594
0E0E5EF07B4518BBC1E1CBA7C79D8DB1
419E69F8025E933569B444DF46127292

2025-01-27 07:02:37 - root - INFO - SQL:
SELECT `user_pseudo_id`,
      MIN(IF(`event_name` = 'first_open', TIMESTAMP_MICROS(`event_timestamp`), NULL)) AS `first_open_time`,
      MIN(IF(`event_name` = 'app_remove', TIMESTAMP_MICROS(`event_timestamp`), NULL)) AS `uninstall_time`,
      TIMESTAMP_DIFF(
        MIN(IF(`event_name` = 'app_remove', TIMESTAMP_MICROS(`event_timestamp`), NULL)),
        MIN(IF(`event_name` = 'first_open', TIMESTAMP_MICROS(`event_timestamp`), NULL)),
        DAY
      ) AS `days_between`
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `event_name` IN ('first_open', 'app_remove')
    GROUP BY `user_pseudo_id`
    HAVING `days_between` <= 7
    LIMIT 100;
Results:
user_pseudo_id,first_open_time,uninstall_time,days_between
A1CCD9D935CD30A3A49B3A78204315BE,2018-07-17 02:28:33.440000+00:00,2018-07-18 02:46:40.488047+00:00,1
BCBFBC1CAB6A1C8FB6A443268548C35B,2018-07-17 01:53:34.610000+00:00,2018-07-17 12:20:43.081014+00:00,0
8BFC094ADB7C9840E2F95B2921F9336B,2018-09-19 10:12:25.802000+00:00,2018-09-19 10:28:10.483049+00:00,0
127A3DF5245F2E0AEB1085403FBBD713,2018-09-19 13:58:42.538000+00:00,2018-09-19 14:26:14.222000+00:00,0
EEB0505F178AA612B26B78143CDF7C09,2018-06-20 19:49:44.836000+00:00,2018-06-20 19:50:28.243000+00:00,0
6102A2D13134745137E3678B3DA4068B,2018-06-14 06:23:59.249000+00:00,2018-06-16 00:56:56.595000+00:00,1
824D686213A09439DBCCC406B0739558,2018-07-23 00:17:07.404000+00:00,2018-07-23 00:17:24.920027+00:00,0
FDA8A551D26C1E9B42E57170401C8AB5,2018-07-21 00:45:53.528000+00:00,2018-07-21 00:47:53.453011+00:00,0
D4B90F489AEED383CB46669EEEB12E92,2018-07-30 02:09:14.224000+00:00,2018-08-01 22:44:19.739000+00:00,2
7C7C8524146AA5006BE260A041101DF3,2018-08-01 13:38:30.234000+00:00,2018-08-02 03:38:08.019004+00:00,0
C59286E780962666D2A9C13A478542C8,2018-08-01 09:29:27.193000+00:00,2018-08-01 09:41:54.751004+00:00,0
171871CA6AF9A891FB7B3E19CD144B2E,2018-08-02 05:14:39.826000+00:00,2018-08-02 16:27:10.994016+00:00,0
2B6D0DB9D76C581ACB986BBE2408220C,2018-08-13 04:52:51.597000+00:00,2018-08-13 06:20:31.388005+00:00,0
567422321BBB432EC2CC014A510E61BD,2018-08-10 08:57:22.445000+00:00,2018-08-13 06:10:06.144015+00:00,2
8BC72D1925A8866050D5A6FB01148518,2018-08-12 15:30:44.487000+00:00,2018-08-15 14:47:52.289000+00:00,2
EE2010FFDAF663BCC722160AB9954A1E,2018-08-12 14:32:51.184000+00:00,2018-08-14 01:38:11.580075+00:00,1
F27F046DF960AB50CE65B9F4364C981E,2018-08-12 14:11:51.032000+00:00,2018-08-15 08:05:57.679014+00:00,2
50B507B8C1BD14FA0BC9BE6991513DFE,2018-09-15 17:05:54.410000+00:00,2018-09-16 05:45:05.940182+00:00,0
57E7A689A86A94D750A4C68220DDD679,2018-09-14 02:44:58.356000+00:00,2018-09-15 09:41:22.055000+00:00,1

2025-01-27 07:02:41 - root - INFO - SQL:
SELECT `user_pseudo_id`,
      TIMESTAMP_MICROS(`user_first_touch_timestamp`) AS `first_touch_time`
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE EXTRACT(MONTH FROM TIMESTAMP_MICROS(`user_first_touch_timestamp`)) = 9
      AND EXTRACT(YEAR FROM TIMESTAMP_MICROS(`user_first_touch_timestamp`)) = 2018
    LIMIT 100;
Results:
user_pseudo_id,first_touch_time
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00

2025-01-27 07:02:48 - root - INFO - SQL:
SELECT COUNT(DISTINCT `user_pseudo_id`) AS `uninstall_without_crash`
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `event_name` = 'app_remove'
      AND `user_pseudo_id` NOT IN (
        SELECT DISTINCT `user_pseudo_id`
        FROM `firebase-public-project.analytics_153293282.events_*`
        WHERE `event_name` = 'app_exception'
      )
    LIMIT 100;
Results:
uninstall_without_crash
2524

2025-01-27 07:02:54 - root - INFO - SQL:
SELECT `user_pseudo_id`, `event_name`, COUNT(*) AS `event_count`
    FROM `firebase-public-project.analytics_153293282.events_*`
    GROUP BY `user_pseudo_id`, `event_name`
    ORDER BY `event_count` DESC
    LIMIT 100;
Results:
user_pseudo_id,event_name,event_count
EF500E0CF578004836D1D38C8901862B,screen_view,56698
959635567E419A061EECCCA478EDC718,screen_view,48223
86A6C9FB1A0C566CA168149788E71EFD,screen_view,32886
3875A92B5F5C2BBA1355CED06A986079,screen_view,26792
3DEB0C12C49AD19D7ACE68FA59E7ACD6,screen_view,25431
B63075B53A750A67A12F7F19ED5AA835,level_start_quickplay,24641
EF500E0CF578004836D1D38C8901862B,user_engagement,23708
B63075B53A750A67A12F7F19ED5AA835,level_reset_quickplay,22599
0E05F56141200FF41FCC0C7FA297FF08,screen_view,21356
E0664E9E7883956A6E3084FD68AA274B,screen_view,21300
959635567E419A061EECCCA478EDC718,user_engagement,21094
12E5626928FE0885DEEF068683E8BD63,screen_view,20834
05FB3382D94C7E963B408FD6CC357D33,screen_view,20790
10B0D468B5E036E16D13DB53A65F2D49,screen_view,20116
2F74E23BEA1E45E3897274EE4903DCC5,screen_view,19602
56B9CBB6CB58106DCCF3CAD660232CB2,screen_view,19492
8F6C5F7611B67A4A437FF283B6C10181,screen_view,18381
3875A92B5F5C2BBA1355CED06A986079,user_engagement,18241
472451071AED6FF801BC0FE66706FD27,screen_view,18109
86A6C9FB1A0C566CA168149788E71EFD,user_engagement,16158
3DEB0C12C49AD19D7ACE68FA59E7ACD6,user_engagement,14764
57EC50FBC6C7277B8EDCCE44C1352BD4,screen_view,14697
05FB3382D94C7E963B408FD6CC357D33,user_engagement,14332
81B593104D9F960033D17F056E51C92B,screen_view,13488
295D9E24D8DE65A010313E667131EF19,screen_view,13231
EFB696A82D093B3AFBE92FF526DD5CEA,screen_view,12925
3B4A6FCA6DCB4C2749409DC4188A306E,screen_view,12206
1386E5CC85E430BBC566EC1019DC3C32,screen_view,11893
C6DE585349744A40725DB0AB17041BA3,screen_view,11818
B63075B53A750A67A12F7F19ED5AA835,screen_view,11672
5E09265F12D64B9FA85FF9427A0A7FB0,screen_view,11637
42E6A7C3536775E3B8C3DB919AE9A452,screen_view,11472
48AB910A8DE8485D4C34238EA61F782C,screen_view,11431
0E05F56141200FF41FCC0C7FA297FF08,user_engagement,11312
0B08423CCD5F1503B5A8B306FFED999C,screen_view,11220
CABE7E24215A5C36862658A36AE5CE12,screen_view,11074
0D17D0247F158FA3E40D21EFF46D1651,screen_view,10968
472451071AED6FF801BC0FE66706FD27,user_engagement,10857
4EF964D59282E5A2C8692D30F011256B,level_start_quickplay,10792
E0664E9E7883956A6E3084FD68AA274B,user_engagement,10428
74375465CD17299EBC7C75A1B4047EE0,screen_view,10378
4EF964D59282E5A2C8692D30F011256B,level_reset_quickplay,10317
F866B1D9D660101FF4C436E5D93D2C08,screen_view,10064
CABE7E24215A5C36862658A36AE5CE12,user_engagement,10008
B63075B53A750A67A12F7F19ED5AA835,user_engagement,9848
959635567E419A061EECCCA478EDC718,level_start_quickplay,9551
8802C1F08F68501AB77C5097CD19CE1A,level_start_quickplay,9524

2025-01-27 07:02:54 - root - INFO - itercount: 0
2025-01-27 07:02:54 - root - INFO - Database Name: firebase-public-project
Schema Name: analytics_153293282
DDL describes table information.
,0
table_name,events_20180801
ddl,"CREATE TABLE `firebase-public-project.analytics_153293282.events_20180801`
(
  event_date STRING,
  event_timestamp INT64,
  event_name STRING,
  event_params ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64>>>,
  event_previous_timestamp INT64,
  event_value_in_usd FLOAT64,
  event_bundle_sequence_id INT64,
  event_server_timestamp_offset INT64,
  user_id STRING,
  user_pseudo_id STRING,
  user_properties ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64, set_timestamp_micros INT64>>>,
  user_first_touch_timestamp INT64,
  user_ltv STRUCT<revenue FLOAT64, currency STRING>,
  device STRUCT<category STRING, mobile_brand_name STRING, mobile_model_name STRING, mobile_marketing_name STRING, mobile_os_hardware_model STRING, operating_system STRING, operating_system_version STRING, vendor_id STRING, advertising_id STRING, language STRING, is_limited_ad_tracking STRING, time_zone_offset_seconds INT64>,
  geo STRUCT<continent STRING, country STRING, region STRING, city STRING>,
  app_info STRUCT<id STRING, version STRING, install_store STRING, firebase_app_id STRING, install_source STRING>,
  traffic_source STRUCT<name STRING, medium STRING, source STRING>,
  stream_id STRING,
  platform STRING
);"

Some other tables have the similar structure: ['events_20180801', 'events_20180621', 'events_20180616', 'events_20180912', 'events_20180814', 'events_20180716', 'events_20181003', 'events_20180620', 'events_20180624', 'events_20180918', 'events_20180612', 'events_20180911', 'events_20180724', 'events_20180807', 'events_20180710', 'events_20180808', 'events_20180702', 'events_20180719', 'events_20180914', 'events_20180913', 'events_20180915', 'events_20180728', 'events_20180817', 'events_20180628', 'events_20180906', 'events_20180704', 'events_20180711', 'events_20180720', 'events_20180706', 'events_20180926', 'events_20180924', 'events_20180731', 'events_20180804', 'events_20180920', 'events_20180715', 'events_20180709', 'events_20180928', 'events_20180904', 'events_20180903', 'events_20180818', 'events_20180820', 'events_20180707', 'events_20180930', 'events_20180821', 'events_20180812', 'events_20180830', 'events_20180908', 'events_20180708', 'events_20180910', 'events_20180922', 'events_20180713', 'events_20180618', 'events_20180811', 'events_20181001', 'events_20180626', 'events_20180828', 'events_20180717', 'events_20180806', 'events_20180721', 'events_20180725', 'events_20180824', 'events_20180923', 'events_20180627', 'events_20180726', 'events_20180729', 'events_20180929', 'events_20180925', 'events_20180722', 'events_20180630', 'events_20180730', 'events_20180831', 'events_20180701', 'events_20180619', 'events_20180810', 'events_20180822', 'events_20180921', 'events_20180819', 'events_20180927', 'events_20180905', 'events_20180816', 'events_20180622', 'events_20180802', 'events_20180826', 'events_20180714', 'events_20180901', 'events_20180916', 'events_20180809', 'events_20181002', 'events_20180703', 'events_20180617', 'events_20180902', 'events_20180625', 'events_20180827', 'events_20180805', 'events_20180825', 'events_20180919', 'events_20180917', 'events_20180705', 'events_20180613', 'events_20180907', 'events_20180909', 'events_20180727', 'events_20180813', 'events_20180614', 'events_20180623', 'events_20180829', 'events_20180615', 'events_20180712', 'events_20180718', 'events_20180815', 'events_20180629', 'events_20180803', 'events_20180823', 'events_20180723']
External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180612', 'events_20180613', 'events_20180614', 'events_20180615', 'events_20180616', 'events_20180617', 'events_20180618', 'events_20180619', 'events_20180620', 'events_20180621', 'events_20180622', 'events_20180623', 'events_20180624', 'events_20180625', 'events_20180626', 'events_20180627', 'events_20180628', 'events_20180629', 'events_20180630', 'events_20180701', 'events_20180702', 'events_20180703', 'events_20180704', 'events_20180705', 'events_20180706', 'events_20180707', 'events_20180708', 'events_20180709', 'events_20180710', 'events_20180711', 'events_20180712', 'events_20180713', 'events_20180714', 'events_20180715', 'events_20180716', 'events_20180717', 'events_20180718', 'events_20180719', 'events_20180720', 'events_20180721', 'events_20180722', 'events_20180723', 'events_20180724', 'events_20180725', 'events_20180726', 'events_20180727', 'events_20180728', 'events_20180729', 'events_20180730', 'events_20180731', 'events_20180801', 'events_20180802', 'events_20180803', 'events_20180804', 'events_20180805', 'events_20180806', 'events_20180807', 'events_20180808', 'events_20180809', 'events_20180810', 'events_20180811', 'events_20180812', 'events_20180813', 'events_20180814', 'events_20180815', 'events_20180816', 'events_20180817', 'events_20180818', 'events_20180819', 'events_20180820', 'events_20180821', 'events_20180822', 'events_20180823', 'events_20180824', 'events_20180825', 'events_20180826', 'events_20180827', 'events_20180828', 'events_20180829', 'events_20180830', 'events_20180831', 'events_20180901', 'events_20180902', 'events_20180903', 'events_20180904', 'events_20180905', 'events_20180906', 'events_20180907', 'events_20180908', 'events_20180909', 'events_20180910', 'events_20180911', 'events_20180912', 'events_20180913', 'events_20180914', 'events_20180915', 'events_20180916', 'events_20180917', 'events_20180918', 'events_20180919', 'events_20180920', 'events_20180921', 'events_20180922', 'events_20180923', 'events_20180924', 'events_20180925', 'events_20180926', 'events_20180927', 'events_20180928', 'events_20180929', 'events_20180930', 'events_20181001', 'events_20181002', 'events_20181003']}}
Begin Exploring Related Columns
**Relevant columns and their potential usage:**

- **`user_pseudo_id`**: Unique identifier for each user; used to track individual user activity.
- **`user_first_touch_timestamp`**: Timestamp when the user first opened the app; used to identify users who first opened the app in September 2018.
- **`event_name`**: Name of the event; used to identify events like `'first_open'`, `'app_exception'`, and `'app_remove'`.
- **`event_timestamp`**: Timestamp of each event; used to calculate the time between the first open and uninstall events.
- **`event_date`**: Date of the event in `YYYYMMDD` format; helps in filtering data for specific dates.
- **`event_params`**: Array of key-value pairs containing additional event information.
- **`platform`**: Platform of the device; may be useful to filter by device type if needed.
- **`app_info.id`**: Application ID; useful if data contains multiple apps.
- **`device.advertising_id`**: Advertising ID; another user identifier which could be useful for cross-referencing.
- **`user_properties`**: Array containing user properties; might hold additional useful attributes.

**Conditions that may be used:**

- Users whose **`user_first_touch_timestamp`** falls within September 2018.
- Users who have an **`event_name`** of `'app_exception'` (indicating an app crash).
- Users who have an **`event_name`** of `'app_remove'` or similar (indicating an uninstall).
- Calculating the time difference between **`user_first_touch_timestamp`** and **`event_timestamp`** of uninstall event to check if uninstalled within seven days.
- Filtering events where **`event_name`** is `'first_open'`, `'app_exception'`, or uninstall events.
- Using **`event_params`** to extract specific parameters if needed.

---

**Sample BigQuery SQL queries:**

1. **Retrieve users who first opened the app in September 2018:**

   ```sql
   SELECT DISTINCT `user_pseudo_id`, `user_first_touch_timestamp`
   FROM `firebase-public-project.analytics_153293282.events_201809*`
   WHERE EXTRACT(MONTH FROM TIMESTAMP_MICROS(`user_first_touch_timestamp`)) = 9
     AND EXTRACT(YEAR FROM TIMESTAMP_MICROS(`user_first_touch_timestamp`)) = 2018
   LIMIT 100;
   ```

2. **List all event names to understand possible uninstall and crash events:**

   ```sql
   SELECT DISTINCT `event_name`
   FROM `firebase-public-project.analytics_153293282.events_*`
   LIMIT 100;
   ```

3. **Get events related to app crashes ('app_exception'):**

   ```sql
   SELECT `event_name`, `user_pseudo_id`, `event_timestamp`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'app_exception'
   LIMIT 100;
   ```

4. **Get events that may indicate uninstalls (assuming 'app_remove'):**

   ```sql
   SELECT `event_name`, `user_pseudo_id`, `event_timestamp`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'app_remove'
   LIMIT 100;
   ```

5. **Find users who uninstalled within seven days of first open:**

   ```sql
   SELECT `user_pseudo_id`,
     MIN(TIMESTAMP_MICROS(`event_timestamp`)) AS `uninstall_time`,
     MIN(TIMESTAMP_MICROS(`user_first_touch_timestamp`)) AS `first_open_time`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'app_remove'
   GROUP BY `user_pseudo_id`
   HAVING TIMESTAMP_DIFF(MIN(TIMESTAMP_MICROS(`event_timestamp`)), MIN(TIMESTAMP_MICROS(`user_first_touch_timestamp`)), DAY) <= 7
   LIMIT 100;
   ```

6. **Combine users who first opened in September 2018 and uninstalled within seven days:**

   ```sql
   SELECT DISTINCT `user_pseudo_id`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE EXTRACT(MONTH FROM TIMESTAMP_MICROS(`user_first_touch_timestamp`)) = 9
     AND EXTRACT(YEAR FROM TIMESTAMP_MICROS(`user_first_touch_timestamp`)) = 2018
     AND `event_name` = 'app_remove'
     AND TIMESTAMP_DIFF(TIMESTAMP_MICROS(`event_timestamp`), TIMESTAMP_MICROS(`user_first_touch_timestamp`), DAY) <= 7
   LIMIT 100;
   ```

7. **Count of users who experienced an app crash:**

   ```sql
   SELECT COUNT(DISTINCT `user_pseudo_id`) AS `crash_user_count`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'app_exception'
   LIMIT 100;
   ```

8. **List users who both uninstalled within seven days and experienced a crash:**

   ```sql
   SELECT DISTINCT `user_pseudo_id`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` IN ('app_remove', 'app_exception')
   GROUP BY `user_pseudo_id`
   HAVING COUNT(DISTINCT CASE WHEN `event_name` = 'app_remove' THEN 1 END) > 0
     AND COUNT(DISTINCT CASE WHEN `event_name` = 'app_exception' THEN 1 END) > 0
   LIMIT 100;
   ```

9. **Extract additional parameters from `event_params` for app crashes:**

   ```sql
   SELECT `user_pseudo_id`,
     ep.key,
     ep.value.string_value
   FROM `firebase-public-project.analytics_153293282.events_*`,
     UNNEST(`event_params`) AS ep
   WHERE `event_name` = 'app_exception'
   LIMIT 100;
   ```

10. **Get the count of total users who first opened in September 2018:**

    ```sql
    SELECT COUNT(DISTINCT `user_pseudo_id`) AS `total_new_users`
    FROM `firebase-public-project.analytics_153293282.events_201809*`
    WHERE `event_name` = 'first_open'
    LIMIT 100;
    ```

11. **Identify users who uninstalled but did not experience a crash:**

    ```sql
    SELECT DISTINCT `user_pseudo_id`
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `event_name` = 'app_remove'
      AND `user_pseudo_id` NOT IN (
        SELECT DISTINCT `user_pseudo_id`
        FROM `firebase-public-project.analytics_153293282.events_*`
        WHERE `event_name` = 'app_exception'
      )
    LIMIT 100;
    ```

12. **Calculate the time difference between first open and uninstall events for each user:**

    ```sql
    SELECT `user_pseudo_id`,
      MIN(IF(`event_name` = 'first_open', TIMESTAMP_MICROS(`event_timestamp`), NULL)) AS `first_open_time`,
      MIN(IF(`event_name` = 'app_remove', TIMESTAMP_MICROS(`event_timestamp`), NULL)) AS `uninstall_time`,
      TIMESTAMP_DIFF(
        MIN(IF(`event_name` = 'app_remove', TIMESTAMP_MICROS(`event_timestamp`), NULL)),
        MIN(IF(`event_name` = 'first_open', TIMESTAMP_MICROS(`event_timestamp`), NULL)),
        DAY
      ) AS `days_between`
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `event_name` IN ('first_open', 'app_remove')
    GROUP BY `user_pseudo_id`
    HAVING `days_between` <= 7
    LIMIT 100;
    ```

13. **Retrieve users' first open dates for verification:**

    ```sql
    SELECT `user_pseudo_id`,
      TIMESTAMP_MICROS(`user_first_touch_timestamp`) AS `first_touch_time`
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE EXTRACT(MONTH FROM TIMESTAMP_MICROS(`user_first_touch_timestamp`)) = 9
      AND EXTRACT(YEAR FROM TIMESTAMP_MICROS(`user_first_touch_timestamp`)) = 2018
    LIMIT 100;
    ```

14. **Find the number of users who uninstalled within seven days without experiencing a crash:**

    ```sql
    SELECT COUNT(DISTINCT `user_pseudo_id`) AS `uninstall_without_crash`
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `event_name` = 'app_remove'
      AND `user_pseudo_id` NOT IN (
        SELECT DISTINCT `user_pseudo_id`
        FROM `firebase-public-project.analytics_153293282.events_*`
        WHERE `event_name` = 'app_exception'
      )
    LIMIT 100;
    ```

15. **Check the frequency of events per user to understand user behavior:**

    ```sql
    SELECT `user_pseudo_id`, `event_name`, COUNT(*) AS `event_count`
    FROM `firebase-public-project.analytics_153293282.events_*`
    GROUP BY `user_pseudo_id`, `event_name`
    ORDER BY `event_count` DESC
    LIMIT 100;
    ```

These queries help in understanding the data and retrieving necessary information such as users who first opened the app in September 2018, those who uninstalled within seven days, and those who experienced an app crash. They also assist in identifying event names and examining event parameters for more detailed analysis.Query:
SELECT DISTINCT `user_pseudo_id`, `user_first_touch_timestamp`
   FROM `firebase-public-project.analytics_153293282.events_201809*`
   WHERE EXTRACT(MONTH FROM TIMESTAMP_MICROS(`user_first_touch_timestamp`)) = 9
     AND EXTRACT(YEAR FROM TIMESTAMP_MICROS(`user_first_touch_timestamp`)) = 2018
   LIMIT 100;
Answer:
user_pseudo_id,user_first_touch_timestamp
9BFA45225ECA7CD4D2A9F956B875CF85,1536252841631000
5DA9B900E7C9F71714FB1AE9DA631C83,1535823083751000
AAE4779C1A0F48E482C71DE95A4FA0E1,1536250316038000
B743E27EAEE69B2DD8730CBC77BEC072,1536218334240000
9F5BB05E83166A05D957BD8709452328,1536098922240000
A7642D8075588A1BE483081F553C97DF,1536023893952000
CDB49D27B3BBEDBB8CCF4DC7667E337E,1536264015401000
63550F65F0818B874ADA2B18C463AB21,1535942088041000
D6C62D17A18603EEE645F28835D54DEA,1536037006803000
AFF35810D9962CD8476636476A2831D8,1536246915955000
DF2035402F934E7B23D97854C02A1F09,1536239302803000
626009813D7731D71D9DD3D396969BB8,1536125876733000
FBE5BE5E3836527EC27D14834D72B911,1535983155261000
386EE7D00E029293C53C2ED7319EF520,1535984279068000
9434EE4CFDFE0F5BCFE40126A569F3BB,1536285147163000
8AFAFD6D7E79149C91BCAE1995E0CF47,1536016575547000
891646F131CE2CCADB5D6676A104CB9D,1536301611312000
EB4432A4BDAAB8F5135FCB36503ADC7D,1536218182096000
3114BB0EE700894607B258BC4706797C,1535996857253000
58870D4568AC2C4018EEFB6DC4C482B1,1536266754437000
66AFD4A2B8BC073FC2021F5C42CC7C86,1536219413946000
96685CED0793A219EFE8976477D7DA56,1536186767086000
A1D0D1B1F6207F2A909227367541C6A8,1536286657613000
C96F1CB586725A7D165BCF665C131114,1536242048001000
D62EDD239EF72D80713B3414F1A7C541,1535880212225000
AE0411EC55F2110C13B66F25B7EFBF6B,1536274454849000
F73A0D4A6FB35C664DDAE0F4F145F8B0,1535977576310000
F2D468D41FB8611C8741B01EA2E1F0EA,1536280157153000
7107B8B93B285616D099D9010F6AD834,1536115583995000
4059062E59F3605CE7A574DCD9997571,1536342135786000
4549717C06BAFE84FB1FFE5DDBD7EB2E,1536473880826000
A01A048A0E5413157039C956EB8CC1F7,1536301208546000
09309F331FA528745E330964AF4AAAD8,1536587870540000
AFF1ED962C29150288A2946235923125,1536862632351000
E700BD83FAFB7509FE2F45F2D7554326,1536895641663000
29D150D22AF86AA1AE6B56F5B9123D43,1536843947316000
501EC0B173398B023AB5B9A315FFD673,1536464926260000
65F8E2B80A986C0FDF372EF08A031483,1536894048713000
70D2F634EB46DA3061AADBA078ADF7E9,1536895369745000
596FCBD95E3C6C24EC450B4BB7F12D18,1536855961339000
E75BB9320BCFA56BF42AAC320A56CBAE,1536649943600000
7F2D59D791EB2BFCE7DC5B694C3FE456,1536846791130000
AC14AD9D158A2A5449E120A33D5B55BB,1536867225978000
337A3F347AE32CE90A631DF3028500A5,1536893318746000
FF2D6D2366E710D0FBF8BF00D2081ADF,1536890514607000
AC86F727F3237AD98B97B536AE6A8035,1536777677934000
35929D52C47DAC927FFFE0BA6F8343E4,1536861877539000
957033925A8B7F2A2C2F4577E786632D,1536760864920000
DFD440E5A6ED9EB7BEE70013C9CB82DE,1536853410754000
819D386099AA9B435B3F4B261D3553F9,1536900346679000
Query:
SELECT DISTINCT `event_name`
   FROM `firebase-public-project.analytics_153293282.events_*`
   LIMIT 100;
Answer:
event_name
level_complete
level_reset
firebase_campaign
challenge_accepted
os_update
in_app_purchase
level_end_quickplay
level_reset_quickplay
app_update
dynamic_link_app_open
notification_foreground
challenge_a_friend
level_fail_quickplay
user_engagement
completed_5_levels
use_extra_steps
level_retry_quickplay
app_remove
dynamic_link_first_open
app_clear_data
select_content
level_complete_quickplay
session_start
level_start
level_end
spend_virtual_currency
first_open
screen_view
app_exception
level_start_quickplay
post_score
level_up
no_more_extra_steps
level_retry
level_fail
error
ad_reward
Query:
SELECT `event_name`, `user_pseudo_id`, `event_timestamp`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'app_exception'
   LIMIT 100;
Answer:
event_name,user_pseudo_id,event_timestamp
app_exception,8E2CA56C1FD81A095DECAEDE6F2ED626,1529870477611003
app_exception,8E2CA56C1FD81A095DECAEDE6F2ED626,1529878542015030
app_exception,8E2CA56C1FD81A095DECAEDE6F2ED626,1529878653520012
app_exception,8E2CA56C1FD81A095DECAEDE6F2ED626,1529878760952011
app_exception,8E2CA56C1FD81A095DECAEDE6F2ED626,1529878937377014
app_exception,FA30269453141794E79B8F15EE0BA5B9,1529836008874002
app_exception,32A6DDD2FF644EEC9C87F474040389DA,1529836049301013
app_exception,1B2FC37816CC4DDAACA97A75E685756F,1529827489236002
app_exception,20381657DAEE3E67B8DCF5A716C059D2,1529876114014003
app_exception,7AD772ABC639D8C0C7F1C05ECC7818F0,1529850675256025
app_exception,326651F167D600272DA4EC5EE0618D07,1529869953304049
app_exception,326651F167D600272DA4EC5EE0618D07,1529870253317023
app_exception,326651F167D600272DA4EC5EE0618D07,1529870291142011
app_exception,5635A012FC2AC25176B2B2BC4BFE8026,1529851174412031
app_exception,326651F167D600272DA4EC5EE0618D07,1529869164888019
app_exception,326651F167D600272DA4EC5EE0618D07,1529869384517016
app_exception,326651F167D600272DA4EC5EE0618D07,1529869482645014
app_exception,326651F167D600272DA4EC5EE0618D07,1529869556456011
app_exception,326651F167D600272DA4EC5EE0618D07,1529869703025011
app_exception,6FE6726C48A23DADF583469EF441941F,1529896937299007
app_exception,6FE6726C48A23DADF583469EF441941F,1529897227287040
app_exception,6FE6726C48A23DADF583469EF441941F,1529897211103052
app_exception,A1DE82672878364D12AFCED708CBE594,1529869986586004
app_exception,D6F5820E5B2C721C1677E1BC873B074A,1529903621665014
app_exception,C3326C2CCF5D46173E4973A13512B163,1529901990758004
app_exception,827C78D61F55043F0E925C03F0311FAF,1529862225095003
app_exception,E5A2CB7A471E740E758BE5E2E0C79BC2,1529838963179040
app_exception,E5A2CB7A471E740E758BE5E2E0C79BC2,1529840394341151
app_exception,D4F4DAEF5BE38E5C67FD72BB1F082EBF,1529853268850002
app_exception,DF7B1F6B6AEF483760B6439EF91BC26A,1529898810351001
app_exception,30F6F3C74D5D408E5F9A76E20F4D2BB3,1529850795892005
app_exception,E080406D26F71C9B8F331779CE8B82BA,1529840831719002
app_exception,59FBE83E879F468A15B415CD8301B346,1528882476269019
app_exception,59FBE83E879F468A15B415CD8301B346,1528882760651010
app_exception,59FBE83E879F468A15B415CD8301B346,1528882833103010
app_exception,7566596A1D6ACA781692A7A0B89B06EF,1528911496161002
app_exception,635BE6A3D887B6B3517FCF2324C4C1E0,1528925028404003
app_exception,9243996A4E06EC1505D57AFDF7E84E66,1528916497305014
app_exception,6895EEFC23B59DB13A9B9A7EED6A766F,1528956277865011
app_exception,6895EEFC23B59DB13A9B9A7EED6A766F,1528956422260012
app_exception,6895EEFC23B59DB13A9B9A7EED6A766F,1528956459149019
Query:
SELECT `event_name`, `user_pseudo_id`, `event_timestamp`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'app_remove'
   LIMIT 100;
Answer:
event_name,user_pseudo_id,event_timestamp
app_remove,8046473848C0E0F86B801F15D438D7A3,1532310283108106
app_remove,8137A61045BFE96DD2B6B833C6803642,1532293361378016
app_remove,DA00B27EE3A7FA06D967B74E0D440E5E,1532256138516042
app_remove,32C3039A18B8BC54D469BD784E3E65F8,1532293867230000
app_remove,50C0AAC23307E008A37574D40D607CCD,1532244140538001
app_remove,DC930EB0BCF5A8A2233B766CEB3EA42D,1532279711773000
app_remove,A83713EF270EA35A03A4784C0A3662A9,1532313082083000
app_remove,CE37961A20C06C1ACE22288FA9851B39,1532315685481182
app_remove,F00520A971B304A0B45AF31AECC75826,1532243299706010
app_remove,D01606C77D7658EC936CCB4C37A838D9,1532270925160000
app_remove,4704A291A6B5E598E364EBDCBCCC9446,1532258685108000
app_remove,824D686213A09439DBCCC406B0739558,1532305044920027
app_remove,66716FE2A831B1606A2507E6ABF10F68,1532275600060000
app_remove,8E5E12F3522FBBD21F72548309DB2C33,1532293488397000
app_remove,46CD1BC25288939026C6A0107240C77C,1532323540531000
app_remove,8365302EA50623D13816D680993C07AC,1532329115609000
app_remove,95E62884FEEE94C5CFD56F7BE33697FA,1532312102459000
app_remove,75D4077943E2281AEBA789BB5E0E2780,1532243578535000
app_remove,0F24544604D3C9D09AFCEDF0804673CB,1532328500679000
app_remove,CEF9B763F040531679C7B86A1F05F6DD,1532258694006000
app_remove,AF22CF225D76C2405C85DEE54231D1DC,1532246898428048
app_remove,569FEAF5DD2B400D3CDDEC44777EC627,1532316824784000
app_remove,53649082C25AB9A9CD1E394EBBA9CEF3,1531390454302009
app_remove,872063888F20EFD35EEBA3D16C953853,1531416777326000
app_remove,A87A30159D909E2356F72AAC76F26707,1531442042403000
app_remove,8E2768C381113D72B39CCE7961BE5481,1531421217337032
app_remove,C00AEA479F0CF6F16BFEF6DE644F76FC,1531435661961000
app_remove,BECAE3B757D93900084EF7404D609D4E,1531402968080016
app_remove,55CA70077121BAB756139482239C7337,1531456246237001
app_remove,07091112737131E5726D839AA3917CC9,1531425020419000
app_remove,80DDC8E9AEBDBEEC1DD485E207430740,1531412704595000
app_remove,B386B3D771140CCEE8CC603EA7F282A4,1531432546223000
app_remove,3854B836FDA5CDA15382843A8EA25684,1531438885848000
app_remove,C2C8E0E8C41AA5C46818FF7008C353F4,1531422113552266
app_remove,09BDD816257873A6FD3E231C5DE598D3,1531416041272011
app_remove,67428F96A060BAEDF71D7805BFE20D00,1531448682565000
app_remove,6900CA1B70E56BF02E5A59B43BCD73EC,1531430439051000
app_remove,2276FE6CB99CED85F2A038871B9D2E0C,1531384062164000
app_remove,E4D0CD43ECF1890C6D20D2EC09153E02,1531410460664000
app_remove,16535A918ADAE06E4E30A71918B6E92B,1531443624176000
app_remove,9DAAF8ABC5DFA8F18FC4FD1897EAF19E,1531410922465000
app_remove,68E7D392F7438427575FBDB8B518265F,1531399670057000
app_remove,837F7400F8D751E5E5FCD6818FF7E9A2,1531463904957000
Query:
SELECT `user_pseudo_id`,
     MIN(TIMESTAMP_MICROS(`event_timestamp`)) AS `uninstall_time`,
     MIN(TIMESTAMP_MICROS(`user_first_touch_timestamp`)) AS `first_open_time`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'app_remove'
   GROUP BY `user_pseudo_id`
   HAVING TIMESTAMP_DIFF(MIN(TIMESTAMP_MICROS(`event_timestamp`)), MIN(TIMESTAMP_MICROS(`user_first_touch_timestamp`)), DAY) <= 7
   LIMIT 100;
Answer:
user_pseudo_id,uninstall_time,first_open_time
7705D52DD2286DC2E6DB831A2E129E94,2018-09-10 20:49:34.534044+00:00,2018-09-10 01:49:22.346000+00:00
DD0CB20147767F174CE7F130D2E66FF1,2018-08-17 18:02:04.104000+00:00,2018-08-17 17:07:38.476000+00:00
533E79DF88C5D3B27AB10A32F8185503,2018-08-21 23:59:14.497000+00:00,2018-08-21 23:23:18.933000+00:00
316C65000A6DC054CDBDFF5123898C68,2018-07-11 17:20:12.646000+00:00,2018-07-11 15:31:46.853000+00:00
8A8767DAACDC3F673378BD6B3574C061,2018-07-11 12:27:33.154000+00:00,2018-07-10 23:57:27.585000+00:00
2C8294A0EF5FF73A6C43819F67D450F4,2018-09-10 05:58:48.121006+00:00,2018-09-10 03:25:26.253000+00:00
F9231C977F262065AFA5F376C746E0ED,2018-09-27 18:28:07.047000+00:00,2018-09-25 17:54:21.738000+00:00
0018E9BAF92AFA2FFFCDCB5F48A3B134,2018-10-02 11:06:02.107000+00:00,2018-10-02 11:05:46.281000+00:00
A33B3E5D320A35A5BA168F271D6BC956,2018-10-02 10:09:33.058000+00:00,2018-10-02 10:07:57.142000+00:00
6B41795D5E5B7339E007330941C9E201,2018-06-19 15:35:56.955000+00:00,2018-06-16 00:16:54.339000+00:00
22758EB02AC5EADF2CB2F8533D85603A,2018-07-24 04:44:55.056051+00:00,2018-07-24 03:58:35.306000+00:00
0F668D1FE72425834C6A5EE9F4F53BCD,2018-07-24 05:07:35.964000+00:00,2018-07-23 19:53:22.393000+00:00
FB1F87054CBD0625890297427AAAD990,2018-07-31 23:30:47.913000+00:00,2018-07-24 04:38:47.537000+00:00
FA1CBA7312F0DDF83E2EE1573E400043,2018-07-31 20:50:40.190026+00:00,2018-07-31 20:48:53.987000+00:00
1290BCB61140CAF8CE8A5E8FFBEF16B2,2018-08-01 02:10:06.303026+00:00,2018-08-01 02:08:55.163000+00:00
28BAFBF9921B80B84EF45326F2CF9746,2018-07-31 15:13:53.683000+00:00,2018-07-31 12:31:18.935000+00:00
B79FEE3597E3C4A3B5A38FE33B684341,2018-09-11 19:32:27.122022+00:00,2018-09-11 19:32:00.188000+00:00
F37788083CD17FEF93F66A5A8CFA9BCD,2018-09-11 22:51:03.714004+00:00,2018-09-11 22:39:48.810000+00:00
41B8B6917AC3C354AC6A10CDC715FDDB,2018-09-11 16:47:37.978013+00:00,2018-09-11 16:45:40.745000+00:00
289290E298ED08B95B10DE971359B101,2018-09-11 17:29:43.196182+00:00,2018-09-11 17:14:25.192000+00:00
Query:
SELECT DISTINCT `user_pseudo_id`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE EXTRACT(MONTH FROM TIMESTAMP_MICROS(`user_first_touch_timestamp`)) = 9
     AND EXTRACT(YEAR FROM TIMESTAMP_MICROS(`user_first_touch_timestamp`)) = 2018
     AND `event_name` = 'app_remove'
     AND TIMESTAMP_DIFF(TIMESTAMP_MICROS(`event_timestamp`), TIMESTAMP_MICROS(`user_first_touch_timestamp`), DAY) <= 7
   LIMIT 100;
Answer:
user_pseudo_id
782A0F243E58A79260C76789CDD139AA
8BE102266AF2AEC727AE08D0A5241DE0
80FD9717450806029DA432E39BBB5DFD
1CE53B7BFD311B79EBE02347FAA21B4C
E67AAD89794950F36FFE36E8DA277021
C83DB20A4364A88C81A58AC7B47EC995
3EBDD6F7B6591A3C86A571852D3E7338
D65E01E352085FB9B51FC7556D8653D9
703E9B982BBB52A7374FB3A73A657191
E98C2033935E43DBA50950F7039FF492
FF2D6D2366E710D0FBF8BF00D2081ADF
5DA9B900E7C9F71714FB1AE9DA631C83
E22B5A1417E856AC0E9C8B633B59AAA0
A759925C7E035CA52AC6C214671DDBBE
6E54FCD5F4543ACDB7412812A857FD74
50B507B8C1BD14FA0BC9BE6991513DFE
57E7A689A86A94D750A4C68220DDD679
4ABF69A40A3BC6057CD49D74A6C18AC2
9153C9C8AAD9E53057C0869DECD75472
7B6CA3391592F0D3B11865D782C685CF
B7F7B01204A87A92985FCEE1F9880681
273B2F85FFD9D20FA585DFC61CAF3CDE
6D6EB70E837A5007BE550C44FF276440
97D9D96077AD3E8859BF5C54C873E59D
B9D800D33FDCF7AF2157CB66910A0797
DAD134C77F7E09BC552E290534CB90E8
02508ACF3E0BA4D0C4770C03817AFDE3
0EFA419FF8D1FB5BAA12E4794D511937
03C8FFC95DEC2C1E87EB4646970FC12E
61814C6B80D24FFDE5FEB59D61FD5B1C
B9DFF32CBEB23C14C0CA2E839FBFA852
8310DC2A15DC92C13DF598D4C7C35F9C
D7EF597CFE7E3923048F66F89F156165
1BDCB994173E8A509680B6351EE6A3AE
063FC523E013130DB87EA578A4BDEF4A
8BFC094ADB7C9840E2F95B2921F9336B
127A3DF5245F2E0AEB1085403FBBD713
3B2F510266EE4C430F9105E6D77F9084
77538D72AC418FA45C2D6CDBEB4BBF49
CD1D906FB130FF55A227F2DE79F0C15A
14CDD9706D24046F309F81C86687A25C
06651B7BD90A9520B007ECEBF08EE9D6
CAB801638B9B8022310A07629D49EBCA
2CEFE82BDD9A12BE3F9F09083C8812A4
B6F60284DE6FD9D98BE07E37EE989CBE
86E29652B3E743AF9DB8812104B797B6
EB94D0269C6F5FFF876CEE91940B1FF1
3980D574A7D5B9088AAAFCBFD18FB050
DFD440E5A6ED9EB7BEE70013C9CB82DE
5DD61074AA5F92DE0CE1F00516BFDBF5
1CD1D85F7C39D7814EB1A4C55646D717
4A2A03B50BDA6AC1687703BD39A91E3E
9EAAC1C6222FFE3D209C02C81C20F2A2
2DCC8C777D4D165D7539553D047B32F5
A33DE80957EE65767566B772BC3E8BA5
E1FEA6BA9D049EF343C2D18C13E32756
CFF34B5186EB1563295F0058BBC7CC0B
0798BB6B8C026CEFB003241B31932B67
95475D4BC44186852209441392FC7F92
376E71CB4C92528ABE7D6FDC9CBCDA09
2DC473377FAF752C77B586711AA66A90
E6BD402E986856BE45A107744EA310EC
3F512C35009AAC06F811B31413462B45
D963E509346C0E5358ECFE56AF3BB2ED
D8B77A575B5308D161F95ACF515F9772
108522345C425B9AEB5F83FE07C1A3A4
EEC7FA9B9E05990005FF736DCCADC24A
242B37810A135CF0A8CA54D6B21D3250
9F162037940FC15E9F3A3E9DFCA4D2AE
A51A3E253AE3F2668DC50CB1AE96D60E
B3234CECCA15CEE80BDE39DA9D8AE687
C6928D8A0DAE782911786BF2C5614279
B6084E4BDF1F19A277C07ACB37026177
622765D1DD641D4F0115C9DDD63F05EF
9EEF99CE81B3CB2D6AD1C850953E2871
B43BC1AF8B548310005F04BC42441D96
92CF66DE321FE11709C46304D5A99F1D
97380FCE77BAB6B251B50DDE4ABD8F8A
408354544760D27F10CCA7CF9B4E43D3
4C2614370EF19318C141072F3EBFB9EC
BE042BC1484A69E1731FB487C1AD34B9
C1F519708675990E7A5FC68A65396327
78E9738DC83BE674052BD4621BB2F113
B79FEE3597E3C4A3B5A38FE33B684341
F37788083CD17FEF93F66A5A8CFA9BCD
41B8B6917AC3C354AC6A10CDC715FDDB
289290E298ED08B95B10DE971359B101
92400633510BB9E545007254608CF161
E5E4C7E5600DD124D56BA0B0FF41B07C
70D2F634EB46DA3061AADBA078ADF7E9
8FEAB3AAF7434731E003747C511F06DE
EF6D6B0B8836E4B95ED7D8FCBAF0BF6C
2C8294A0EF5FF73A6C43819F67D450F4
Query:
SELECT COUNT(DISTINCT `user_pseudo_id`) AS `crash_user_count`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` = 'app_exception'
   LIMIT 100;
Answer:
crash_user_count
789
Query:
SELECT DISTINCT `user_pseudo_id`
   FROM `firebase-public-project.analytics_153293282.events_*`
   WHERE `event_name` IN ('app_remove', 'app_exception')
   GROUP BY `user_pseudo_id`
   HAVING COUNT(DISTINCT CASE WHEN `event_name` = 'app_remove' THEN 1 END) > 0
     AND COUNT(DISTINCT CASE WHEN `event_name` = 'app_exception' THEN 1 END) > 0
   LIMIT 100;
Answer:
user_pseudo_id
25D6702EA0A98A6284D9FFCEA0D764A4
F815B786873376C0A296AB5731FB8524
50FEAE9ECFE22E951E8810622A2E8F66
FF67B1C2BDF236F255703B1F4CD41EB4
503AB1BC9E19C89B0425ED404E60F062
9BC94B3773C8304A9E101AEBCFEF4A5F
A4CEEF26271DB9DC4A825B9E6DD8D8CA
2C42FD4D96863B75026B71D2BDEC620A
1F91CA88C5E106304CDBD9C769FEC3E4
5E694DE02688C2FDDEA38A6946A4CC3F
21DA809CF1B07A7E8D2D73D9030FEEBC
7207044281C74501C14233463AAD9A71
02084E10F9F1052182B5602D6CDC50BA
D7C4BD696A49356175EE064AC6195452
1756558602A5C14A5DD2AD4B696D2191
0B74484DD41F519B4810A14A953CAA18
79CAA00790D06BC25052329F4ED99BFC
32A6DDD2FF644EEC9C87F474040389DA
6AC7CD91D56EECD5451A8FA289528AB8
8EDCB7851F10B51350C78C208BEF4A4E
34752CBB38EC5E1730FADC1F8D348B92
CF3F621F23B4C697E784B0998A1DB94E
6B8035863BA8F90EDD28470F84922BB2
8E6F7A428C907165D78A2377ABEB7315
CF62C17E245938F28D9A86634660A2FD
A622BBB66D14F224D949A6A86B87D4BA
EDD7CD144CF227FB54453390F3C06408
F7C26C99D64FCE9BC900822234927579
8E1749E5A26DD54E346476A289854E93
FA944230F31FE2B6FB255BFC9679C0F8
EE2010FFDAF663BCC722160AB9954A1E
635BE6A3D887B6B3517FCF2324C4C1E0
B240CAEDDBC7AEE341900E113CED23DC
0F668D1FE72425834C6A5EE9F4F53BCD
6702A2EA5F6159151ECDF9937BB44AAD
7CBF44EFDDB9E6401F31786BEE071196
3D7382CF3E5091189D2961E0EA3A2ACE
23670FFEF0FFC29FF59EA8E1A82E3A93
3D9CD866FA73F2327C3B63DF16A477D9
E1A3C786B2E4D56629EE808A3A174995
C1018981990B7AE4E03EBF648564C3CE
139C75296C846C004181A2A4A80C13C2
2920B9D90561E521425DE4849FAAD1D7
B7E6580376A092AF1D8ED36A96EEF943
522BA55B8CE6E00DBC4CDC5DC232E3F1
2FF4899DE9DDAA94D3744575196D9206
906CE0DA38E7D9DE597CA459CC907950
C2C8E0E8C41AA5C46818FF7008C353F4
6DAF0604F8AE54374593DBB13DD2BFD6
154287464C4F84AF86699BC92AA1DAB5
FD807541F1DE049B5D16ED3EE2DCF160
3E8245CE87EEDBDF995B682A717AE2FC
4D38AF508E466CDF5FF6FD9F93892F1E
793008133AFD953B70E6B9037D70D2A6
C0AA6F95B35D0D803F47B299269E716D
BC6503564939EA61982B7111F9051C50
9B18A1CBA96D52D05CFA7CB7C9011EDE
9664FAE9A17FD550BE78549EEA2773AC
171871CA6AF9A891FB7B3E19CD144B2E
97B422DCCB84169BF11FF0168929E31B
59FBE83E879F468A15B415CD8301B346
5256B2B115955E80DDB7449775D92325
747538074CEC9FE551F488F3E47F9FD9
A20E7E669E319B0A1912A187C4169AEE
5346C62F49BF2E6C1199456F16604B3C
9A10BF8F0166076BD918A5027396A46B
CE56946091344ADC2D0AB88D49B83ED1
619893E8C20EEB450207B65496CDBCC5
B7D2B63ABE215157570ABD2E2E6EC9BE
78CEA7AA04666D7924A253A4AA4C1F4C
6A2F4E7AB1816D2F6EC741BC92141766
BB4B254D4020E22E9CE5885C8AB28F87
14820087732D43CA92C816CA22E9FDCD
DDFE0B623F523F68FF0A338D5B6F3FB8
44561FB4558913850A7857FC521C1C42
9739CF7747700632F707FE234CEA7C00
FD9223BA1689E43F814C545A5FEBA7F4
EECDCA8076D5842922767F5C08957B17
20381657DAEE3E67B8DCF5A716C059D2
7E438E53A94A9E6EA6531E272C86F512
788B593C9AFEBAEE6374CDA08F16FAC6
DA426D16B0EAB27DE1AC9D6E3418F400
0CCC9C71BC84C8B2503B9EE93191D263
A64D09F4DE2FB21E17EE29D7B77081EB
667B1425546E7502CD66F9DF0C6321C1
DF2FC56E807EAF16E852AEAB67E0127A
1A3C9B890548F1BCE865FC5422E08672
C006BDD387158B17AD45F2BC0F346048
8AB29C262591541BA945BF48D74DB5F5
9F0513E2CCD4655D6EB7C59AE8C5BF9B
B83E97CDE1FCF1D681206DFFC5F1898E
C11D2CEE54EF4DC4655B7D87BC1B7F1C
8E2768C381113D72B39CCE7961BE5481
Query:
SELECT `user_pseudo_id`,
     ep.key,
     ep.value.string_value
   FROM `firebase-public-project.analytics_153293282.events_*`,
     UNNEST(`event_params`) AS ep
   WHERE `event_name` = 'app_exception'
   LIMIT 100;
Answer:
user_pseudo_id,key,string_value
DA426D16B0EAB27DE1AC9D6E3418F400,fatal,
DA426D16B0EAB27DE1AC9D6E3418F400,firebase_screen_class,shop_menu
DA426D16B0EAB27DE1AC9D6E3418F400,firebase_event_origin,clx
DA426D16B0EAB27DE1AC9D6E3418F400,firebase_screen_id,
DA426D16B0EAB27DE1AC9D6E3418F400,timestamp,
5BFDC0426DE9C09CA5FF18E4982F2506,fatal,
5BFDC0426DE9C09CA5FF18E4982F2506,firebase_screen_class,shop_menu
5BFDC0426DE9C09CA5FF18E4982F2506,firebase_event_origin,clx
5BFDC0426DE9C09CA5FF18E4982F2506,firebase_screen_id,
5BFDC0426DE9C09CA5FF18E4982F2506,timestamp,
7CBF44EFDDB9E6401F31786BEE071196,fatal,
7CBF44EFDDB9E6401F31786BEE071196,firebase_screen_class,shop_menu
7CBF44EFDDB9E6401F31786BEE071196,firebase_event_origin,clx
7CBF44EFDDB9E6401F31786BEE071196,firebase_screen_id,
7CBF44EFDDB9E6401F31786BEE071196,timestamp,
4BDC831A6940071E2461D0B5293A329E,fatal,
4BDC831A6940071E2461D0B5293A329E,firebase_event_origin,clx
4BDC831A6940071E2461D0B5293A329E,timestamp,
7FD3B52661B5030E97AA98C6449BA790,fatal,
7FD3B52661B5030E97AA98C6449BA790,firebase_screen_class,shop_menu
7FD3B52661B5030E97AA98C6449BA790,firebase_event_origin,clx
7FD3B52661B5030E97AA98C6449BA790,firebase_screen_id,
7FD3B52661B5030E97AA98C6449BA790,timestamp,
D3F06F9B7BD9D7FC8758BF78BF0705E9,fatal,
D3F06F9B7BD9D7FC8758BF78BF0705E9,firebase_screen_class,shop_menu
D3F06F9B7BD9D7FC8758BF78BF0705E9,firebase_event_origin,clx
D3F06F9B7BD9D7FC8758BF78BF0705E9,firebase_screen_id,
D3F06F9B7BD9D7FC8758BF78BF0705E9,timestamp,
72F09205C195C6255BB88E9207C9CD49,fatal,
72F09205C195C6255BB88E9207C9CD49,firebase_screen_class,shop_menu
72F09205C195C6255BB88E9207C9CD49,firebase_event_origin,clx
72F09205C195C6255BB88E9207C9CD49,firebase_screen_id,
72F09205C195C6255BB88E9207C9CD49,timestamp,
C006BDD387158B17AD45F2BC0F346048,fatal,
C006BDD387158B17AD45F2BC0F346048,firebase_screen_class,shop_menu
C006BDD387158B17AD45F2BC0F346048,firebase_event_origin,clx
C006BDD387158B17AD45F2BC0F346048,firebase_screen_id,
C006BDD387158B17AD45F2BC0F346048,timestamp,
F08C95B4C15C48637756D065797987ED,fatal,
F08C95B4C15C48637756D065797987ED,firebase_event_origin,clx
F08C95B4C15C48637756D065797987ED,timestamp,
E9E777B58E17AE5695695BD3B68B255F,fatal,
E9E777B58E17AE5695695BD3B68B255F,firebase_event_origin,clx
E9E777B58E17AE5695695BD3B68B255F,timestamp,
0CAAA1B6F161BA4D363EB7A2DEF64A08,fatal,
0CAAA1B6F161BA4D363EB7A2DEF64A08,firebase_event_origin,clx
0CAAA1B6F161BA4D363EB7A2DEF64A08,timestamp,
B5F3D00E28A57C9522F2DEE3CB903DD1,fatal,
B5F3D00E28A57C9522F2DEE3CB903DD1,firebase_screen_class,shop_menu
Query:
SELECT COUNT(DISTINCT `user_pseudo_id`) AS `total_new_users`
    FROM `firebase-public-project.analytics_153293282.events_201809*`
    WHERE `event_name` = 'first_open'
    LIMIT 100;
Answer:
total_new_users
1349
Query:
SELECT DISTINCT `user_pseudo_id`
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `event_name` = 'app_remove'
      AND `user_pseudo_id` NOT IN (
        SELECT DISTINCT `user_pseudo_id`
        FROM `firebase-public-project.analytics_153293282.events_*`
        WHERE `event_name` = 'app_exception'
      )
    LIMIT 100;
Answer:
user_pseudo_id
FD034D7D200F23C38A941FE5BD5F1042
B6B8C0DA3E4895115A7C8E09B23AA079
E83D71D465C83BB00F6C0C5DBA5466CA
FF4280B9B55198495A46A8D157D337D5
0393E8CD10D9BAF3E2F06D31395151E6
985F451F66CBDE8F3D4AF608CDEF5B46
8D8EE6C485ED68C57C0461D6E9F74F2E
7B33416E0219E1C01561CA9F5917551B
B4BF7DC0B389F9822DEFF9A0DD821CEB
A161D33D29F8E607E3D4AD6314CA30BE
3A1B5A55C33A7EF1A37C909A753606B8
2CC80ED018DB2338C8A0B887DEBA1AB5
C4F3977886A116E9EC70CC984A966477
56F52601C8B237D2D80176B6AF256D1C
ACEC237EDDCD21DE77B2FE430409E4A1
8E2A5EB88B14BD966171099E577DC1B1
528A3C7818ED6D6B4DBC32588DECFF79
2B26B53D4CD155A3EF1FF0A91D339D3E
5E55193500989E57EBB5BD16E059B975
0EBB3115DF5D11266CFF1EBC5B08106A
A87A30159D909E2356F72AAC76F26707
7FA49E8C954E096C4F779C75D5ACEA89
F9231C977F262065AFA5F376C746E0ED
F476C649BB127FA13E0E91F3D662F0B6
E3048636D8BFB4E0D668CE6FE9F69AE4
F94C109612F167FE0ADFE5064B60B46D
91A2560153399B4323A14CD148CB2F1B
5050A23C57CDD81051C3B1D54D545334
2E98271C4DE172F7AA1BB10FDEEA3913
622CE5108E0572C1006A11FF399522B2
82EC0357F7A97115EB30AFC798B49EFA
F0133C453901CA70C9101F0550E81AB3
525465FDD7403389EEC1845BA52C6471
58E93B5F7024A0F13362F708E164A718
962AD93C16D677E4EA7E360D561B76E2
67ACBBE2B2AF1E5B1A94D33F2BCF101A
8137A61045BFE96DD2B6B833C6803642
DC930EB0BCF5A8A2233B766CEB3EA42D
66716FE2A831B1606A2507E6ABF10F68
60FAC27D8495BF33C2AE5283A7B07005
011068A78F16C35DE89A649B12D640DA
F470625FCD13350142D1FAB619BEDE53
A6D1D1E727DC7BECB3C3B06E0BE5BB63
C88B1D3F6DEC26E03432899B55EE420B
EAA452C246E3CCD96ACAE0634C16443E
BF8C377689B7FCE5F3CF99EFB606DD5C
86FB984815DDC86C8079F9EA4C705ECE
E270414CD8C904F7BB039FB243540B3E
A8A510DCC86FAD0C92CD0081E04EE829
6AA53FDC098AAE06E8F06E9D6475B41D
CB46ED7A0C52CC8F5BF3F695631CFCF2
BFEDE353E3CCE9028D1ACB8CB3760A80
B66386AB66C4C30AB58129141BB76125
99893A88D6E3FC238CF49C830005E049
92D613354268A0E592A3032CFE1D7987
4A74F895139C481B907A37EE5D25BA1B
E68A264ADBA1C799CEC92C1B6D234E2A
122B9693B647802ACC0727BF5A36F75E
77E2DDCA98F2FCF01699468B1B06D01E
B8976A95667DCA1F0986ADFE24AAEEC0
2AFDF5157A3653573A891CCB3BB20C89
FD9F628C7B3A0A9EB266FC7FCC5E597F
E6DACB396AFBAD52C3AAA62AAAFED1B2
4D5153DEBE069E129263E067172E3F7B
10CD441F79B53D8F7E281C38ACBEE2C3
C98FE4C10160A105798C65E6AA160974
40972A87661D837BA8B80C3EF122FDD9
78F8F9830EBD020AFAA6B6608E673C62
E536827798DB693614D14B2B727EF743
EB77017C771046704B0582544C3F9328
2F5BBABE9DD0271DCD62E501F76DA736
FFFF9A8B436FAAA293AE33E8C6D3ED66
E515909D096AFF6A5E06A2EDCD9FCA22
94F34B922E39558292B971D631807132
8C988A305F1F269E13D776EF0E1576BC
656809A54882C03F52A8EA425D8352C9
0EC790DED453E8256A40DA3139407C97
B175B187062693360BCBADC4160F8D88
7064BC64E47E869B36967E854748969E
B2912116E7B957900D6B69D4E50F0F9A
91FEBAE4337BFA2EF7E6F50DA0D40432
2CFE23AC4E3C6529D39BDADA1EF99C52
2C7A0851C697F03694BF4364695CA6C0
BA68AFBA94C53DA2DE67AA683078AD2A
F811FA3ECC2BA9F049E5A216FAFA301B
7C8D8B75790229C5B05F6D31E9BE6254
DECC7F229E296F92B5F1C66174132690
0FCCC37C632A22AA9C16512A56828CDE
FB36A16D10ED7285C7FEBAAB0A0F992C
88AED337A2425080A1E6CE737B0B3915
56BB8C5154AD6D11F06903EBC42DF594
0E0E5EF07B4518BBC1E1CBA7C79D8DB1
419E69F8025E933569B444DF46127292
Query:
SELECT `user_pseudo_id`,
      MIN(IF(`event_name` = 'first_open', TIMESTAMP_MICROS(`event_timestamp`), NULL)) AS `first_open_time`,
      MIN(IF(`event_name` = 'app_remove', TIMESTAMP_MICROS(`event_timestamp`), NULL)) AS `uninstall_time`,
      TIMESTAMP_DIFF(
        MIN(IF(`event_name` = 'app_remove', TIMESTAMP_MICROS(`event_timestamp`), NULL)),
        MIN(IF(`event_name` = 'first_open', TIMESTAMP_MICROS(`event_timestamp`), NULL)),
        DAY
      ) AS `days_between`
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `event_name` IN ('first_open', 'app_remove')
    GROUP BY `user_pseudo_id`
    HAVING `days_between` <= 7
    LIMIT 100;
Answer:
user_pseudo_id,first_open_time,uninstall_time,days_between
A1CCD9D935CD30A3A49B3A78204315BE,2018-07-17 02:28:33.440000+00:00,2018-07-18 02:46:40.488047+00:00,1
BCBFBC1CAB6A1C8FB6A443268548C35B,2018-07-17 01:53:34.610000+00:00,2018-07-17 12:20:43.081014+00:00,0
8BFC094ADB7C9840E2F95B2921F9336B,2018-09-19 10:12:25.802000+00:00,2018-09-19 10:28:10.483049+00:00,0
127A3DF5245F2E0AEB1085403FBBD713,2018-09-19 13:58:42.538000+00:00,2018-09-19 14:26:14.222000+00:00,0
EEB0505F178AA612B26B78143CDF7C09,2018-06-20 19:49:44.836000+00:00,2018-06-20 19:50:28.243000+00:00,0
6102A2D13134745137E3678B3DA4068B,2018-06-14 06:23:59.249000+00:00,2018-06-16 00:56:56.595000+00:00,1
824D686213A09439DBCCC406B0739558,2018-07-23 00:17:07.404000+00:00,2018-07-23 00:17:24.920027+00:00,0
FDA8A551D26C1E9B42E57170401C8AB5,2018-07-21 00:45:53.528000+00:00,2018-07-21 00:47:53.453011+00:00,0
D4B90F489AEED383CB46669EEEB12E92,2018-07-30 02:09:14.224000+00:00,2018-08-01 22:44:19.739000+00:00,2
7C7C8524146AA5006BE260A041101DF3,2018-08-01 13:38:30.234000+00:00,2018-08-02 03:38:08.019004+00:00,0
C59286E780962666D2A9C13A478542C8,2018-08-01 09:29:27.193000+00:00,2018-08-01 09:41:54.751004+00:00,0
171871CA6AF9A891FB7B3E19CD144B2E,2018-08-02 05:14:39.826000+00:00,2018-08-02 16:27:10.994016+00:00,0
2B6D0DB9D76C581ACB986BBE2408220C,2018-08-13 04:52:51.597000+00:00,2018-08-13 06:20:31.388005+00:00,0
567422321BBB432EC2CC014A510E61BD,2018-08-10 08:57:22.445000+00:00,2018-08-13 06:10:06.144015+00:00,2
8BC72D1925A8866050D5A6FB01148518,2018-08-12 15:30:44.487000+00:00,2018-08-15 14:47:52.289000+00:00,2
EE2010FFDAF663BCC722160AB9954A1E,2018-08-12 14:32:51.184000+00:00,2018-08-14 01:38:11.580075+00:00,1
F27F046DF960AB50CE65B9F4364C981E,2018-08-12 14:11:51.032000+00:00,2018-08-15 08:05:57.679014+00:00,2
50B507B8C1BD14FA0BC9BE6991513DFE,2018-09-15 17:05:54.410000+00:00,2018-09-16 05:45:05.940182+00:00,0
57E7A689A86A94D750A4C68220DDD679,2018-09-14 02:44:58.356000+00:00,2018-09-15 09:41:22.055000+00:00,1
Query:
SELECT `user_pseudo_id`,
      TIMESTAMP_MICROS(`user_first_touch_timestamp`) AS `first_touch_time`
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE EXTRACT(MONTH FROM TIMESTAMP_MICROS(`user_first_touch_timestamp`)) = 9
      AND EXTRACT(YEAR FROM TIMESTAMP_MICROS(`user_first_touch_timestamp`)) = 2018
    LIMIT 100;
Answer:
user_pseudo_id,first_touch_time
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
E271C38BE1E3E9E9A1D4DE0A5CF3FA3E,2018-09-04 05:56:37.598000+00:00
Query:
SELECT COUNT(DISTINCT `user_pseudo_id`) AS `uninstall_without_crash`
    FROM `firebase-public-project.analytics_153293282.events_*`
    WHERE `event_name` = 'app_remove'
      AND `user_pseudo_id` NOT IN (
        SELECT DISTINCT `user_pseudo_id`
        FROM `firebase-public-project.analytics_153293282.events_*`
        WHERE `event_name` = 'app_exception'
      )
    LIMIT 100;
Answer:
uninstall_without_crash
2524
Query:
SELECT `user_pseudo_id`, `event_name`, COUNT(*) AS `event_count`
    FROM `firebase-public-project.analytics_153293282.events_*`
    GROUP BY `user_pseudo_id`, `event_name`
    ORDER BY `event_count` DESC
    LIMIT 100;
Answer:
user_pseudo_id,event_name,event_count
EF500E0CF578004836D1D38C8901862B,screen_view,56698
959635567E419A061EECCCA478EDC718,screen_view,48223
86A6C9FB1A0C566CA168149788E71EFD,screen_view,32886
3875A92B5F5C2BBA1355CED06A986079,screen_view,26792
3DEB0C12C49AD19D7ACE68FA59E7ACD6,screen_view,25431
B63075B53A750A67A12F7F19ED5AA835,level_start_quickplay,24641
EF500E0CF578004836D1D38C8901862B,user_engagement,23708
B63075B53A750A67A12F7F19ED5AA835,level_reset_quickplay,22599
0E05F56141200FF41FCC0C7FA297FF08,screen_view,21356
E0664E9E7883956A6E3084FD68AA274B,screen_view,21300
959635567E419A061EECCCA478EDC718,user_engagement,21094
12E5626928FE0885DEEF068683E8BD63,screen_view,20834
05FB3382D94C7E963B408FD6CC357D33,screen_view,20790
10B0D468B5E036E16D13DB53A65F2D49,screen_view,20116
2F74E23BEA1E45E3897274EE4903DCC5,screen_view,19602
56B9CBB6CB58106DCCF3CAD660232CB2,screen_view,19492
8F6C5F7611B67A4A437FF283B6C10181,screen_view,18381
3875A92B5F5C2BBA1355CED06A986079,user_engagement,18241
472451071AED6FF801BC0FE66706FD27,screen_view,18109
86A6C9FB1A0C566CA168149788E71EFD,user_engagement,16158
3DEB0C12C49AD19D7ACE68FA59E7ACD6,user_engagement,14764
57EC50FBC6C7277B8EDCCE44C1352BD4,screen_view,14697
05FB3382D94C7E963B408FD6CC357D33,user_engagement,14332
81B593104D9F960033D17F056E51C92B,screen_view,13488
295D9E24D8DE65A010313E667131EF19,screen_view,13231
EFB696A82D093B3AFBE92FF526DD5CEA,screen_view,12925
3B4A6FCA6DCB4C2749409DC4188A306E,screen_view,12206
1386E5CC85E430BBC566EC1019DC3C32,screen_view,11893
C6DE585349744A40725DB0AB17041BA3,screen_view,11818
B63075B53A750A67A12F7F19ED5AA835,screen_view,11672
5E09265F12D64B9FA85FF9427A0A7FB0,screen_view,11637
42E6A7C3536775E3B8C3DB919AE9A452,screen_view,11472
48AB910A8DE8485D4C34238EA61F782C,screen_view,11431
0E05F56141200FF41FCC0C7FA297FF08,user_engagement,11312
0B08423CCD5F1503B5A8B306FFED999C,screen_view,11220
CABE7E24215A5C36862658A36AE5CE12,screen_view,11074
0D17D0247F158FA3E40D21EFF46D1651,screen_view,10968
472451071AED6FF801BC0FE66706FD27,user_engagement,10857
4EF964D59282E5A2C8692D30F011256B,level_start_quickplay,10792
E0664E9E7883956A6E3084FD68AA274B,user_engagement,10428
74375465CD17299EBC7C75A1B4047EE0,screen_view,10378
4EF964D59282E5A2C8692D30F011256B,level_reset_quickplay,10317
F866B1D9D660101FF4C436E5D93D2C08,screen_view,10064
CABE7E24215A5C36862658A36AE5CE12,user_engagement,10008
B63075B53A750A67A12F7F19ED5AA835,user_engagement,9848
959635567E419A061EECCCA478EDC718,level_start_quickplay,9551
8802C1F08F68501AB77C5097CD19CE1A,level_start_quickplay,9524
End Exploring Related Columns
Task: For all users who first opened the app in September 2018 and then uninstalled within seven days, I want to know what percentage of them experienced an app crash.

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
Percentage_of_users_who_experienced_app_crash
value:0<=float<=100
(Attention: answer in one row)
```

This value represents the percentage of users who first opened the app in September 2018, uninstalled within seven days, and experienced an app crash during that period..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'firebase-public-project': {'analytics_153293282': ['events_20180612', 'events_20180613', 'events_20180614', 'events_20180615', 'events_20180616', 'events_20180617', 'events_20180618', 'events_20180619', 'events_20180620', 'events_20180621', 'events_20180622', 'events_20180623', 'events_20180624', 'events_20180625', 'events_20180626', 'events_20180627', 'events_20180628', 'events_20180629', 'events_20180630', 'events_20180701', 'events_20180702', 'events_20180703', 'events_20180704', 'events_20180705', 'events_20180706', 'events_20180707', 'events_20180708', 'events_20180709', 'events_20180710', 'events_20180711', 'events_20180712', 'events_20180713', 'events_20180714', 'events_20180715', 'events_20180716', 'events_20180717', 'events_20180718', 'events_20180719', 'events_20180720', 'events_20180721', 'events_20180722', 'events_20180723', 'events_20180724', 'events_20180725', 'events_20180726', 'events_20180727', 'events_20180728', 'events_20180729', 'events_20180730', 'events_20180731', 'events_20180801', 'events_20180802', 'events_20180803', 'events_20180804', 'events_20180805', 'events_20180806', 'events_20180807', 'events_20180808', 'events_20180809', 'events_20180810', 'events_20180811', 'events_20180812', 'events_20180813', 'events_20180814', 'events_20180815', 'events_20180816', 'events_20180817', 'events_20180818', 'events_20180819', 'events_20180820', 'events_20180821', 'events_20180822', 'events_20180823', 'events_20180824', 'events_20180825', 'events_20180826', 'events_20180827', 'events_20180828', 'events_20180829', 'events_20180830', 'events_20180831', 'events_20180901', 'events_20180902', 'events_20180903', 'events_20180904', 'events_20180905', 'events_20180906', 'events_20180907', 'events_20180908', 'events_20180909', 'events_20180910', 'events_20180911', 'events_20180912', 'events_20180913', 'events_20180914', 'events_20180915', 'events_20180916', 'events_20180917', 'events_20180918', 'events_20180919', 'events_20180920', 'events_20180921', 'events_20180922', 'events_20180923', 'events_20180924', 'events_20180925', 'events_20180926', 'events_20180927', 'events_20180928', 'events_20180929', 'events_20180930', 'events_20181001', 'events_20181002', 'events_20181003']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-27 07:03:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 07:03:38 - root - INFO - ```sql
WITH first_open_users AS (
  SELECT
    DISTINCT user_pseudo_id,
    TIMESTAMP_MICROS(MIN(user_first_touch_timestamp)) AS first_open_time
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    EXTRACT(MONTH FROM TIMESTAMP_MICROS(user_first_touch_timestamp)) = 9
    AND EXTRACT(YEAR FROM TIMESTAMP_MICROS(user_first_touch_timestamp)) = 2018
  GROUP BY
    user_pseudo_id
),
uninstalled_users AS (
  SELECT
    user_pseudo_id,
    TIMESTAMP_MICROS(MIN(event_timestamp)) AS uninstall_time
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    event_name = 'app_remove'
  GROUP BY
    user_pseudo_id
),
first_seven_days_uninstalls AS (
  SELECT
    f.user_pseudo_id,
    f.first_open_time,
    u.uninstall_time
  FROM
    first_open_users f
  JOIN
    uninstalled_users u
  ON
    f.user_pseudo_id = u.user_pseudo_id
  WHERE
    TIMESTAMP_DIFF(u.uninstall_time, f.first_open_time, DAY) <= 7
),
crash_events AS (
  SELECT
    user_pseudo_id,
    TIMESTAMP_MICROS(event_timestamp) AS crash_time
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    event_name = 'app_exception'
),
users_with_crashes AS (
  SELECT
    DISTINCT f.user_pseudo_id
  FROM
    first_seven_days_uninstalls f
  JOIN
    crash_events c
  ON
    f.user_pseudo_id = c.user_pseudo_id
  WHERE
    c.crash_time BETWEEN f.first_open_time AND f.uninstall_time
    OR c.crash_time BETWEEN f.first_open_time AND TIMESTAMP_ADD(f.first_open_time, INTERVAL 7 DAY)
),
totals AS (
  SELECT
    COUNT(DISTINCT user_pseudo_id) AS total_users
  FROM
    first_seven_days_uninstalls
),
crashed AS (
  SELECT
    COUNT(DISTINCT user_pseudo_id) AS crashed_users
  FROM
    users_with_crashes
)
SELECT
  ROUND((crashed.crashed_users / totals.total_users) * 100, 4) AS Percentage_of_users_who_experienced_app_crash
FROM
  totals,
  crashed;
```
2025-01-27 07:03:44 - root - INFO - itercount: 1
2025-01-27 07:03:44 - root - INFO - 0
2025-01-27 07:03:44 - root - INFO - results: 
Percentage_of_users_who_experienced_app_crash
2.7778


2025-01-27 07:03:44 - root - INFO - Please check the answer again by reviewing For all users who first opened the app in September 2018 and then uninstalled within seven days, I want to know what percentage of them experienced an app crash., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Percentage_of_users_who_experienced_app_crash
value:0<=float<=100
(Attention: answer in one row)
```

This value represents the percentage of users who first opened the app in September 2018, uninstalled within seven days, and experienced an app crash during that period. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Percentage_of_users_who_experienced_app_crash
2.7778
Current sql:
WITH first_open_users AS (
  SELECT
    DISTINCT user_pseudo_id,
    TIMESTAMP_MICROS(MIN(user_first_touch_timestamp)) AS first_open_time
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    EXTRACT(MONTH FROM TIMESTAMP_MICROS(user_first_touch_timestamp)) = 9
    AND EXTRACT(YEAR FROM TIMESTAMP_MICROS(user_first_touch_timestamp)) = 2018
  GROUP BY
    user_pseudo_id
),
uninstalled_users AS (
  SELECT
    user_pseudo_id,
    TIMESTAMP_MICROS(MIN(event_timestamp)) AS uninstall_time
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    event_name = 'app_remove'
  GROUP BY
    user_pseudo_id
),
first_seven_days_uninstalls AS (
  SELECT
    f.user_pseudo_id,
    f.first_open_time,
    u.uninstall_time
  FROM
    first_open_users f
  JOIN
    uninstalled_users u
  ON
    f.user_pseudo_id = u.user_pseudo_id
  WHERE
    TIMESTAMP_DIFF(u.uninstall_time, f.first_open_time, DAY) <= 7
),
crash_events AS (
  SELECT
    user_pseudo_id,
    TIMESTAMP_MICROS(event_timestamp) AS crash_time
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    event_name = 'app_exception'
),
users_with_crashes AS (
  SELECT
    DISTINCT f.user_pseudo_id
  FROM
    first_seven_days_uninstalls f
  JOIN
    crash_events c
  ON
    f.user_pseudo_id = c.user_pseudo_id
  WHERE
    c.crash_time BETWEEN f.first_open_time AND f.uninstall_time
    OR c.crash_time BETWEEN f.first_open_time AND TIMESTAMP_ADD(f.first_open_time, INTERVAL 7 DAY)
),
totals AS (
  SELECT
    COUNT(DISTINCT user_pseudo_id) AS total_users
  FROM
    first_seven_days_uninstalls
),
crashed AS (
  SELECT
    COUNT(DISTINCT user_pseudo_id) AS crashed_users
  FROM
    users_with_crashes
)
SELECT
  ROUND((crashed.crashed_users / totals.total_users) * 100, 4) AS Percentage_of_users_who_experienced_app_crash
FROM
  totals,
  crashed;
2025-01-27 07:04:26 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 07:04:26 - root - INFO - ```sql
WITH first_open_users AS (
  SELECT
    DISTINCT user_pseudo_id,
    TIMESTAMP_MICROS(MIN(user_first_touch_timestamp)) AS first_open_time
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    EXTRACT(MONTH FROM TIMESTAMP_MICROS(user_first_touch_timestamp)) = 9
    AND EXTRACT(YEAR FROM TIMESTAMP_MICROS(user_first_touch_timestamp)) = 2018
  GROUP BY
    user_pseudo_id
),
uninstalled_users AS (
  SELECT
    user_pseudo_id,
    TIMESTAMP_MICROS(MIN(event_timestamp)) AS uninstall_time
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    event_name = 'app_remove'
  GROUP BY
    user_pseudo_id
),
first_seven_days_uninstalls AS (
  SELECT
    f.user_pseudo_id,
    f.first_open_time,
    u.uninstall_time
  FROM
    first_open_users f
  JOIN
    uninstalled_users u
  ON
    f.user_pseudo_id = u.user_pseudo_id
  WHERE
    TIMESTAMP_DIFF(u.uninstall_time, f.first_open_time, DAY) <= 7
),
crash_events AS (
  SELECT
    user_pseudo_id,
    TIMESTAMP_MICROS(event_timestamp) AS crash_time
  FROM
    `firebase-public-project.analytics_153293282.events_*`
  WHERE
    event_name = 'app_exception'
),
users_with_crashes AS (
  SELECT
    DISTINCT f.user_pseudo_id
  FROM
    first_seven_days_uninstalls f
  JOIN
    crash_events c
  ON
    f.user_pseudo_id = c.user_pseudo_id
  WHERE
    c.crash_time BETWEEN f.first_open_time AND f.uninstall_time
    OR c.crash_time BETWEEN f.first_open_time AND TIMESTAMP_ADD(f.first_open_time, INTERVAL 7 DAY)
),
totals AS (
  SELECT
    COUNT(DISTINCT user_pseudo_id) AS total_users
  FROM
    first_seven_days_uninstalls
),
crashed AS (
  SELECT
    COUNT(DISTINCT user_pseudo_id) AS crashed_users
  FROM
    users_with_crashes
)
SELECT
  ROUND((crashed.crashed_users / totals.total_users) * 100, 4) AS Percentage_of_users_who_experienced_app_crash
FROM
  totals,
  crashed;
```
2025-01-27 07:04:32 - root - INFO - itercount: 2
2025-01-27 07:04:32 - root - INFO - 0
2025-01-27 07:04:32 - root - INFO - Total iteration counts: 2
