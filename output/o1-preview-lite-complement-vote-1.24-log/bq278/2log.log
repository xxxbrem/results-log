2025-01-24 23:38:25 - openai._base_client - INFO - Retrying request to /chat/completions in 0.444041 seconds
2025-01-24 23:39:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 23:39:35 - root - INFO - SQL:
SELECT DISTINCT `state_name`
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
   LIMIT 100;
Results:
state_name
Pennsylvania
District of Columbia
Indiana
Texas
California
South Carolina
New Jersey
New York
Minnesota
Maryland
Alabama
Ohio
Michigan
Illinois
Colorado
Massachusetts
Maine
Delaware
Montana
Arizona
Connecticut
Virginia
West Virginia
Wisconsin
Missouri
Nebraska
Washington
Rhode Island
New Hampshire
Kentucky
Iowa
Wyoming
North Carolina
Kansas
Georgia
Florida
Oregon
Alaska
Tennessee
Oklahoma
Utah
Ponce
South Dakota
Louisiana
Vermont
Arkansas
Guaynabo
San Juan
North Dakota
Idaho
Nevada
Cataño
New Mexico
Mississippi
Toa Baja
Toa Alta
Bayamón
Trujillo Alto
Carolina
Aguadilla
Arecibo
Hawaii
Canóvanas
Mayagüez
Hormigueros
Dorado
Corozal
Baja California
Moca

2025-01-24 23:39:36 - root - INFO - SQL:
SELECT DISTINCT `state_name`
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
   LIMIT 100;
Results:
state_name
Pennsylvania
District of Columbia
New York
Delaware
Maryland
New Jersey
Virginia
Florida
Illinois
Indiana
Louisiana
Michigan
Minnesota
New Hampshire
South Carolina
Texas
Arizona
California
Colorado
Iowa
Ohio
Mayagüez
Georgia
North Carolina
Tennessee
Wisconsin
Alaska
Kansas
Maine
Missouri
Nebraska
North Dakota
West Virginia
Connecticut
Kentucky
Massachusetts
Montana
South Dakota
Utah
Washington
Idaho
Nevada
Rhode Island
Wyoming
Ponce
Mississippi
Oregon
Aguadilla
San Juan
Oklahoma
Vermont
Carolina
Alabama
Bayamón
Arkansas
Toa Alta
Trujillo Alto
Canóvanas
Cataño
Guaynabo
New Mexico
Toa Baja
Hawaii
Hormigueros
Arecibo
Dorado
Hatillo
Cabo Rojo
Loíza
Moca

2025-01-24 23:39:38 - root - INFO - SQL:
SELECT
     `state_name`,
     SUM(`count_qualified`) AS total_buildings_available
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
   GROUP BY `state_name`
   LIMIT 100;
Results:
state_name,total_buildings_available
Pennsylvania,1954585
District of Columbia,76385
Indiana,1116413
Texas,5476777
California,8607224
South Carolina,907878
New Jersey,1629714
New York,2502541
Minnesota,769481
Maryland,705396
Alabama,813312
Ohio,2192109
Michigan,1846232
Illinois,2052522
Colorado,1031389
Massachusetts,1000732
Maine,99960
Delaware,147431
Montana,118654
Arizona,1753531
Connecticut,607976
Virginia,963270
West Virginia,154869
Wisconsin,900028
Missouri,1031097
Nebraska,283330
Washington,1510869
Rhode Island,202865
New Hampshire,107012
Kentucky,577255
Iowa,350073
Wyoming,53068
North Carolina,1416043
Kansas,417118
Georgia,1502091
Florida,4814177
Oregon,772441
Alaska,57138
Tennessee,1102947
Oklahoma,700888
Utah,572530
Ponce,18706
South Dakota,72847
Louisiana,864431
Vermont,19504
Arkansas,369725
Guaynabo,12113
San Juan,44665
North Dakota,77117
Idaho,311671
Nevada,569104
Cataño,2860
New Mexico,365713
Mississippi,324867
Toa Baja,6976
Toa Alta,1123
Bayamón,33260
Trujillo Alto,2854
Carolina,19237
Aguadilla,5844
Arecibo,4433
Hawaii,204227
Canóvanas,2182
Mayagüez,7348
Hormigueros,1194
Dorado,3064
Corozal,15
Baja California,1
Moca,1

2025-01-24 23:39:40 - root - INFO - SQL:
SELECT
     `state_name`,
     SUM(`count_qualified`) AS total_buildings_available
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
   GROUP BY `state_name`
   LIMIT 100;
Results:
state_name,total_buildings_available
Pennsylvania,1956097
District of Columbia,76464
New York,2506035
Delaware,147535
Maryland,705813
New Jersey,1632773
Virginia,963792
Florida,4817871
Illinois,2055456
Indiana,1117000
Louisiana,865003
Michigan,1847255
Minnesota,770077
New Hampshire,107103
South Carolina,908394
Texas,5480573
Arizona,1754534
California,8617901
Colorado,1032067
Iowa,350284
Ohio,2194900
Mayagüez,7284
Georgia,1503687
North Carolina,1416843
Tennessee,1105463
Wisconsin,900707
Alaska,57169
Kansas,417333
Maine,100065
Missouri,1032104
Nebraska,283467
North Dakota,77129
West Virginia,155047
Connecticut,608869
Kentucky,575985
Massachusetts,1002203
Montana,118683
South Dakota,72867
Utah,573155
Washington,1511814
Idaho,311878
Nevada,569461
Rhode Island,203167
Wyoming,53090
Ponce,18091
Mississippi,325095
Oregon,773130
Aguadilla,5852
San Juan,44341
Oklahoma,701280
Vermont,19530
Carolina,19688
Alabama,814213
Bayamón,33466
Arkansas,370016
Toa Alta,1345
Trujillo Alto,2873
Canóvanas,2099
Cataño,2764
Guaynabo,11603
New Mexico,365962
Toa Baja,6517
Hawaii,204390
Hormigueros,1264
Arecibo,3962
Dorado,3067
Hatillo,224
Cabo Rojo,2
Loíza,40
Moca,1

2025-01-24 23:39:41 - root - INFO - SQL:
SELECT
     `state_name`,
     AVG(`percent_covered`) AS avg_percent_covered
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
   GROUP BY `state_name`
   LIMIT 100;
Results:
state_name,avg_percent_covered
Pennsylvania,79.069678971782
District of Columbia,81.96327798463948
Indiana,72.70729951623908
Texas,81.35349870837823
California,89.7807005015948
South Carolina,68.2990652629294
New Jersey,88.22893832760151
New York,85.2767396257726
Minnesota,83.07005491274445
Maryland,71.16030669975413
Alabama,65.3636415604924
Ohio,79.33516702608132
Michigan,76.11109096649122
Illinois,81.52174935109402
Colorado,81.12936471319748
Massachusetts,81.69850341980238
Maine,63.10106887979922
Delaware,77.33200952927507
Montana,69.92868695582882
Arizona,87.4686382928109
Connecticut,77.1032770026374
Virginia,70.44108422452726
West Virginia,66.83908549978548
Wisconsin,78.21393285262626
Missouri,80.34422515005369
Nebraska,80.37294823445419
Washington,83.21639552127758
Rhode Island,83.84201456517948
New Hampshire,50.142312161287336
Kentucky,75.34738154677154
Iowa,72.26174249883248
Wyoming,78.96861340065534
North Carolina,63.19407091476492
Kansas,78.0015186723769
Georgia,72.02704651939652
Florida,82.98495071423179
Oregon,76.67033698320564
Alaska,88.96629632261681
Tennessee,74.46006733391977
Oklahoma,76.98000635053326
Utah,76.16223561464697
Ponce,87.8721771073327
South Dakota,52.45083205685707
Louisiana,74.02401966050749
Vermont,79.35918973288328
Arkansas,64.03184484226828
Guaynabo,96.69070837371878
San Juan,98.24550518972346
North Dakota,78.53210718919708
Idaho,77.44616743720586
Nevada,80.35806150420439
Cataño,95.55259585846524
New Mexico,73.56221925571539
Mississippi,72.63111176104802
Toa Baja,96.83583571162676
Toa Alta,83.18994043679682
Bayamón,97.36410651881141
Trujillo Alto,93.46999728482216
Carolina,88.9530773741177
Aguadilla,93.15526870442538
Arecibo,77.87529184298847
Hawaii,85.77323256083754
Canóvanas,66.34040239260467
Mayagüez,93.56904274340901
Hormigueros,58.690744920993225
Dorado,78.27859026612323
Corozal,1.2121212121212122
Baja California,0.06743088334457181
Moca,0.36900369003690037

2025-01-24 23:39:43 - root - INFO - SQL:
SELECT
     `state_name`,
     AVG(`percent_covered`) AS avg_percent_covered
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
   GROUP BY `state_name`
   LIMIT 100;
Results:
state_name,avg_percent_covered
Pennsylvania,92.68306466974028
District of Columbia,85.31731546190417
New York,87.0165466642333
Delaware,85.27792503329303
Maryland,80.03630516726585
New Jersey,124.22007839679846
Virginia,90.9867152039755
Florida,99.634633695383
Illinois,91.65385121185525
Indiana,102.8845689736421
Louisiana,113.44943038082391
Michigan,96.31663324257916
Minnesota,90.42832750511005
New Hampshire,82.68678043934635
South Carolina,95.4739597522511
Texas,89.86343251034099
Arizona,109.64577014936981
California,93.22199775185501
Colorado,90.80594676965516
Iowa,92.502375228341
Ohio,100.1957983798896
Mayagüez,129.17712026429936
Georgia,96.5545833414853
North Carolina,111.00378212601835
Tennessee,96.22961807019115
Wisconsin,93.19365253852426
Alaska,83.13432918928937
Kansas,89.95113875826723
Maine,85.2430142664818
Missouri,89.17689216788044
Nebraska,93.4175734888357
North Dakota,88.55661024596186
West Virginia,134.70406557147317
Connecticut,87.30600764926562
Kentucky,94.62267354085361
Massachusetts,87.21982464135503
Montana,80.417314727058
South Dakota,82.78193284825556
Utah,93.1267398386917
Washington,102.21900785046982
Idaho,84.46661050804313
Nevada,98.16257499733604
Rhode Island,91.74013630607044
Wyoming,75.88811972405551
Ponce,91.56236721318227
Mississippi,110.38685412641182
Oregon,92.07550262671668
Aguadilla,95.93904539313897
San Juan,361.1600438845386
Oklahoma,90.58936275851076
Vermont,102.79805757806196
Carolina,118.61155203088134
Alabama,118.15181543509544
Bayamón,98.86868696240633
Arkansas,94.08798696727425
Toa Alta,1710.7408116079805
Trujillo Alto,2040.5624934431326
Canóvanas,111.11231184290489
Cataño,1977.1135751398197
Guaynabo,111.26805227548675
New Mexico,90.19310294856486
Toa Baja,108.024984187698
Hawaii,92.40890122239375
Hormigueros,72.03823210284625
Arecibo,239.55162200350406
Dorado,133.84216326057313
Hatillo,38.851761427901465
Cabo Rojo,5.0
Loíza,85.48387096774194
Moca,0.8264462809917356

2025-01-24 23:39:44 - root - INFO - SQL:
SELECT
     `state_name`,
     AVG(`percent_qualified`) AS avg_percent_suitable
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
   GROUP BY `state_name`
   LIMIT 100;
Results:
state_name,avg_percent_suitable
Pennsylvania,79.50152162654115
District of Columbia,75.11488176242612
Indiana,80.98704273615948
Texas,89.34929795432048
California,88.41052498683767
South Carolina,80.08563002130778
New Jersey,76.2982184524033
New York,77.40818366695972
Minnesota,72.02677785988111
Maryland,78.21436738373333
Alabama,81.8829916901213
Ohio,82.3972375933493
Michigan,79.04143589637181
Illinois,81.22551550568922
Colorado,83.07765032579091
Massachusetts,73.94909266069014
Maine,63.636668811497685
Delaware,79.8784853981143
Montana,74.89138821125226
Arizona,93.81479777093914
Connecticut,72.29881131803256
Virginia,77.44664178774819
West Virginia,82.71154300892734
Wisconsin,80.06679188975764
Missouri,82.55774214780112
Nebraska,86.88101043865281
Washington,84.03996306007771
Rhode Island,75.47806245993256
New Hampshire,68.14373199300623
Kentucky,86.8544077014831
Iowa,78.45999338382977
Wyoming,78.76528710918183
North Carolina,76.83151102623702
Kansas,83.90980882904063
Georgia,76.48404856671777
Florida,90.85016886522152
Oregon,85.56283254708079
Alaska,78.00984454758942
Tennessee,83.65948527656549
Oklahoma,90.68830861474277
Utah,85.93581601402279
Ponce,91.44872619683593
South Dakota,76.16484077656689
Louisiana,85.77600943642521
Vermont,79.59947754095191
Arkansas,80.53295880502694
Guaynabo,88.43952681035891
San Juan,91.33009202920344
North Dakota,80.68802648949996
Idaho,85.81752126830315
Nevada,92.41557021018673
Cataño,91.19644888529244
New Mexico,90.66469204457194
Mississippi,82.19166818603287
Toa Baja,89.3900563813429
Toa Alta,89.33969769291966
Bayamón,91.28405960797262
Trujillo Alto,88.81837244579282
Carolina,93.41220105410267
Aguadilla,94.31143379125443
Arecibo,93.40742399641678
Hawaii,94.93133340007105
Canóvanas,89.42622950819673
Mayagüez,91.3667202708606
Hormigueros,91.84615384615384
Dorado,93.84379785604901
Corozal,93.75
Baja California,20.0
Moca,100.0

2025-01-24 23:39:46 - root - INFO - SQL:
SELECT
     `state_name`,
     AVG(`percent_qualified`) AS avg_percent_suitable
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
   GROUP BY `state_name`
   LIMIT 100;
Results:
state_name,avg_percent_suitable
Pennsylvania,68.85707992410279
District of Columbia,63.397058540850374
New York,70.38240073336407
Delaware,71.13500821025058
Maryland,69.81305560602681
New Jersey,72.49284036555359
Virginia,70.2980366020228
Florida,83.27936582037205
Illinois,75.07039880322085
Indiana,74.41629924942166
Louisiana,82.17435382731465
Michigan,72.87447311567942
Minnesota,64.55495274901152
New Hampshire,67.94157124181982
South Carolina,73.39684628969712
Texas,83.60340471279216
Arizona,90.40516782276121
California,84.42610938177233
Colorado,80.5215995892791
Iowa,67.55135102465918
Ohio,76.22748275975313
Mayagüez,88.31524322675783
Georgia,68.6019145687061
North Carolina,68.1827711551925
Tennessee,76.2726721379218
Wisconsin,74.55363214741567
Alaska,67.38914863482441
Kansas,74.4583819109252
Maine,65.17547802899195
Missouri,76.33668998450831
Nebraska,80.62010526352873
North Dakota,75.36655521628283
West Virginia,71.81141828837345
Connecticut,65.75337434981019
Kentucky,80.79952498243406
Massachusetts,72.28938390680631
Montana,72.2771405120219
South Dakota,73.13011785666349
Utah,84.22705043917746
Washington,74.39266638906405
Idaho,75.9107679289549
Nevada,90.79523059001973
Rhode Island,75.69773905575144
Wyoming,78.68145154613299
Ponce,89.9396040617879
Mississippi,70.47452389375442
Oregon,79.6266440199705
Aguadilla,89.84303986917155
San Juan,90.20467196383028
Oklahoma,87.7429909469715
Vermont,68.89857488088953
Carolina,91.95012311270571
Alabama,75.70646896201119
Bayamón,90.54093297303565
Arkansas,73.57608276947256
Toa Alta,87.95785274938672
Trujillo Alto,86.22386755943712
Canóvanas,82.97908947936548
Cataño,86.57358974659549
Guaynabo,89.77135936863131
New Mexico,87.26558195086373
Toa Baja,90.59109586594275
Hawaii,90.28828623458985
Hormigueros,91.17801424826256
Arecibo,94.19097896614889
Dorado,94.55205024605395
Hatillo,91.4722740602506
Cabo Rojo,100.0
Loíza,75.47169811320755
Moca,100.0

2025-01-24 23:39:48 - root - INFO - SQL:
SELECT
     `state_name`,
     SUM(`number_of_panels_total`) AS total_potential_panel_count
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
   GROUP BY `state_name`
   LIMIT 100;
Results:
state_name,total_potential_panel_count
Pennsylvania,133004637
District of Columbia,3937623
Indiana,93048465
Texas,480505530
California,652983168
South Carolina,79183940
New Jersey,116249897
New York,157857812
Minnesota,65464154
Maryland,47560886
Alabama,77298546
Ohio,171022353
Michigan,147391827
Illinois,163236997
Colorado,69150828
Massachusetts,68609324
Maine,7689271
Delaware,10742839
Montana,9181610
Arizona,147238408
Connecticut,43269892
Virginia,74735305
West Virginia,11336559
Wisconsin,82263947
Missouri,83816328
Nebraska,21495882
Washington,107756625
Rhode Island,12914100
New Hampshire,9037409
Kentucky,47570216
Iowa,29910958
Wyoming,3843267
North Carolina,123962977
Kansas,36723960
Georgia,139653741
Florida,462105732
Oregon,61510848
Alaska,5447225
Tennessee,101108289
Oklahoma,60455902
Utah,43988756
Ponce,1162806
South Dakota,6372371
Louisiana,80134650
Vermont,1988764
Arkansas,35933867
Guaynabo,986943
San Juan,3423143
North Dakota,8128226
Idaho,23026001
Nevada,43540016
Cataño,186311
New Mexico,29552308
Mississippi,32127017
Toa Baja,371052
Toa Alta,88675
Bayamón,2098880
Trujillo Alto,196126
Carolina,1481427
Aguadilla,432049
Arecibo,345214
Hawaii,19835765
Canóvanas,160471
Mayagüez,571212
Hormigueros,54608
Dorado,199254
Corozal,1667
Baja California,23
Moca,28

2025-01-24 23:39:49 - root - INFO - SQL:
SELECT
      `state_name`,
      SUM(`number_of_panels_total`) AS total_potential_panel_count
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
    GROUP BY `state_name`
    LIMIT 100;
Results:
state_name,total_potential_panel_count
Pennsylvania,133691622
District of Columbia,3983844
New York,158794563
Delaware,10771425
Maryland,47690643
New Jersey,117024321
Virginia,74914378
Florida,463123814
Illinois,164256874
Indiana,93311273
Louisiana,80308875
Michigan,147876313
Minnesota,65662303
New Hampshire,9054358
South Carolina,79312131
Texas,481747719
Arizona,147450436
California,654784266
Colorado,69425443
Iowa,29953011
Ohio,171901350
Mayagüez,567212
Georgia,140138439
North Carolina,124233257
Tennessee,101762224
Wisconsin,82459475
Alaska,5462549
Kansas,36827430
Maine,7720530
Missouri,84085928
Nebraska,21582607
North Dakota,8138951
West Virginia,11387665
Connecticut,43575214
Kentucky,47393349
Massachusetts,69012277
Montana,9189162
South Dakota,6377373
Utah,44105531
Washington,107938035
Idaho,23093899
Nevada,43616656
Rhode Island,13001474
Wyoming,3848056
Ponce,1165041
Mississippi,32218920
Oregon,61617355
Aguadilla,432711
San Juan,3375014
Oklahoma,60560124
Vermont,2012472
Carolina,1554053
Alabama,77644088
Bayamón,2134598
Arkansas,36012747
Toa Alta,73394
Trujillo Alto,197851
Canóvanas,139475
Cataño,168020
Guaynabo,984133
New Mexico,29605361
Toa Baja,362967
Hawaii,19873246
Hormigueros,59807
Arecibo,306604
Dorado,199501
Hatillo,25246
Cabo Rojo,668
Loíza,1693
Moca,28

2025-01-24 23:39:51 - root - INFO - SQL:
SELECT
      `state_name`,
      SUM(`kw_total`) AS total_kw_capacity
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
    GROUP BY `state_name`
    LIMIT 100;
Results:
state_name,total_kw_capacity
Pennsylvania,33251159.25
District of Columbia,984405.75
Indiana,23262116.25
Texas,120126382.5
California,163245792.0
South Carolina,19795985.0
New Jersey,29062474.25
New York,39464453.0
Minnesota,16366038.5
Maryland,11890221.5
Alabama,19324636.5
Ohio,42755588.25
Michigan,36847956.75
Illinois,40809249.25
Colorado,17287707.0
Massachusetts,17152331.0
Maine,1922317.75
Delaware,2685709.75
Montana,2295402.5
Arizona,36809602.0
Connecticut,10817473.0
Virginia,18683826.25
West Virginia,2834139.75
Wisconsin,20565986.75
Missouri,20954082.0
Nebraska,5373970.5
Washington,26939156.25
Rhode Island,3228525.0
New Hampshire,2259352.25
Kentucky,11892554.0
Iowa,7477739.5
Wyoming,960816.75
North Carolina,30990744.25
Kansas,9180990.0
Georgia,34913435.25
Florida,115526433.0
Oregon,15377712.0
Alaska,1361806.25
Tennessee,25277072.25
Oklahoma,15113975.5
Utah,10997189.0
Ponce,290701.5
South Dakota,1593092.75
Louisiana,20033662.5
Vermont,497191.0
Arkansas,8983466.75
Guaynabo,246735.75
San Juan,855785.75
North Dakota,2032056.5
Idaho,5756500.25
Nevada,10885004.0
Cataño,46577.75
New Mexico,7388077.0
Mississippi,8031754.25
Toa Baja,92763.0
Toa Alta,22168.75
Bayamón,524720.0
Trujillo Alto,49031.5
Carolina,370356.75
Aguadilla,108012.25
Arecibo,86303.5
Hawaii,4958941.25
Canóvanas,40117.75
Mayagüez,142803.0
Hormigueros,13652.0
Dorado,49813.5
Corozal,416.75
Baja California,5.75
Moca,7.0

2025-01-24 23:39:53 - root - INFO - SQL:
SELECT
      `state_name`,
      SUM(`kw_total`) AS total_kw_capacity
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
    GROUP BY `state_name`
    LIMIT 100;
Results:
state_name,total_kw_capacity
Pennsylvania,33422905.5
District of Columbia,995961.0
New York,39698640.75
Delaware,2692856.25
Maryland,11922660.75
New Jersey,29256080.25
Virginia,18728594.5
Florida,115780953.5
Illinois,41064218.5
Indiana,23327818.25
Louisiana,20077218.75
Michigan,36969078.25
Minnesota,16415575.75
New Hampshire,2263589.5
South Carolina,19828032.75
Texas,120436929.75
Arizona,36862609.0
California,163696066.5
Colorado,17356360.75
Iowa,7488252.75
Ohio,42975337.5
Mayagüez,141803.0
Georgia,35034609.75
North Carolina,31058314.25
Tennessee,25440556.0
Wisconsin,20614868.75
Alaska,1365637.25
Kansas,9206857.5
Maine,1930132.5
Missouri,21021482.0
Nebraska,5395651.75
North Dakota,2034737.75
West Virginia,2846916.25
Connecticut,10893803.5
Kentucky,11848337.25
Massachusetts,17253069.25
Montana,2297290.5
South Dakota,1594343.25
Utah,11026382.75
Washington,26984508.75
Idaho,5773474.75
Nevada,10904164.0
Rhode Island,3250368.5
Wyoming,962014.0
Ponce,291260.25
Mississippi,8054730.0
Oregon,15404338.75
Aguadilla,108177.75
San Juan,843753.5
Oklahoma,15140031.0
Vermont,503118.0
Carolina,388513.25
Alabama,19411022.0
Bayamón,533649.5
Arkansas,9003186.75
Toa Alta,18348.5
Trujillo Alto,49462.75
Canóvanas,34868.75
Cataño,42005.0
Guaynabo,246033.25
New Mexico,7401340.25
Toa Baja,90741.75
Hawaii,4968311.5
Hormigueros,14951.75
Arecibo,76651.0
Dorado,49875.25
Hatillo,6311.5
Cabo Rojo,167.0
Loíza,423.25
Moca,7.0

2025-01-24 23:39:54 - root - INFO - SQL:
SELECT
      `state_name`,
      SUM(`yearly_sunlight_kwh_total`) AS total_energy_generation_potential
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
    GROUP BY `state_name`
    LIMIT 100;
Results:
state_name,total_energy_generation_potential
Pennsylvania,38013732231.37533
District of Columbia,1195714591.0355346
Indiana,26851041383.544178
Texas,160039623751.7003
California,242638396940.61914
South Carolina,25650182524.803123
New Jersey,33904852397.54702
New York,44831446454.667114
Minnesota,18617438249.15694
Maryland,14360334548.562899
Alabama,24646969095.84594
Ohio,48048536615.67794
Michigan,40840033399.25273
Illinois,47047851222.0221
Colorado,24570049923.14742
Massachusetts,19399236401.382397
Maine,2189004685.1428585
Delaware,3213827406.3591805
Montana,2709785572.9772887
Arizona,59043009935.29779
Connecticut,12350145123.452477
Virginia,23113080773.399204
West Virginia,3257389195.7982974
Wisconsin,23486482672.124508
Missouri,26038971734.146763
Nebraska,6698087315.291833
Washington,27430232929.40039
Rhode Island,3701710212.1397314
New Hampshire,2550456273.8240113
Kentucky,14104070608.58099
Iowa,8830596479.387407
Wyoming,1300665963.824701
North Carolina,39519833527.209785
Kansas,11849160234.79061
Georgia,44581060812.03675
Florida,157617914915.22388
Oregon,16486992928.991993
Alaska,1089086633.2073154
Tennessee,30966907026.811638
Oklahoma,20183717271.261906
Utah,15209638303.221924
Ponce,384801553.74663687
South Dakota,1964549826.541555
Louisiana,25827876726.134453
Vermont,545353715.0415835
Arkansas,11336956069.406752
Guaynabo,342637380.99474514
San Juan,1195075494.0901492
North Dakota,2295970930.981845
Idaho,7504231760.321071
Nevada,17206349924.62255
Cataño,65981195.478601106
New Mexico,12187002098.50356
Mississippi,10378294594.571173
Toa Baja,131548735.53740233
Toa Alta,31279276.972485356
Bayamón,738592635.6176331
Trujillo Alto,68412270.15056156
Carolina,527251268.02654415
Aguadilla,159844295.74992672
Arecibo,123956987.1142212

2025-01-24 23:39:56 - root - INFO - SQL:
SELECT
      `state_name`,
      SUM(`yearly_sunlight_kwh_total`) AS total_energy_generation_potential
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
    GROUP BY `state_name`
    LIMIT 100;
Results:
state_name,total_energy_generation_potential
Pennsylvania,38210009215.75754
District of Columbia,1209717858.7960448
New York,45100394878.66945
Delaware,3222438352.7232127
Maryland,14399236326.491194
New Jersey,34132296027.41457
Virginia,23169044381.25025
Florida,157971622252.88815
Illinois,47344747566.823105
Indiana,26928123257.6459
Louisiana,25885642034.581646
Michigan,40976609871.52638
Minnesota,18673751434.616875
New Hampshire,2555251276.1719847
South Carolina,25692275291.339386
Texas,160458070556.08887
Arizona,59127893265.42813
California,243304846869.2122
Colorado,24667013678.519062
Iowa,8843145869.399498
Ohio,48300160986.35468
Mayagüez,202552659.3214233
Georgia,44737933517.874825
North Carolina,39607264848.00487
Tennessee,31169276299.068546
Wisconsin,23542559983.903282
Alaska,1092118868.9737976
Kansas,11882464352.00895
Maine,2197957054.0975833
Missouri,26123174340.937073
Nebraska,6725165429.18344
North Dakota,2299032486.1953635
West Virginia,3272165883.9079356
Connecticut,12438466928.172302
Kentucky,14048103923.893393
Massachusetts,19514148116.753475
Montana,2711943864.901141
South Dakota,1966083346.8824437
Utah,15249940379.663126
Washington,27475803851.394135
Idaho,7526956885.239661
Nevada,17236108170.27167
Rhode Island,3726814813.7138777
Wyoming,1302268164.537671
Ponce,385731295.9626892
Mississippi,10408673466.612555
Oregon,16514535968.386452
Aguadilla,160079112.7508179
San Juan,1177674698.064478
Oklahoma,20218586198.69937
Vermont,551942863.0689392
Carolina,553262399.3939756
Alabama,24759196398.254772
Bayamón,751085531.8753115
Arkansas,11362387314.959015
Toa Alta,25725431.5722229
Trujillo Alto,69008952.58372192
Canóvanas,49976173.37449949
Cataño,59578578.596868895
Guaynabo,342005084.6763793
New Mexico,12208818476.493706

2025-01-24 23:39:58 - root - INFO - SQL:
SELECT
      `state_name`,
      SUM(`carbon_offset_metric_tons`) AS total_carbon_dioxide_offset
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
    GROUP BY `state_name`
    LIMIT 100;
Results:
state_name,total_carbon_dioxide_offset
Pennsylvania,25546821.485438094
District of Columbia,759829.5491657512
Indiana,22222230.94097572
Texas,79820466.39724967
California,66878632.22406627
South Carolina,15057615.542086853
New Jersey,21299363.23969605
New York,21798509.308366332
Minnesota,9432736.431870202
Maryland,9317029.141011484
Alabama,15723425.934489224
Ohio,39776810.46321089
Michigan,32063411.389291123
Illinois,38776748.30638689
Colorado,14960304.146578386
Massachusetts,8399385.428188123
Maine,947591.4564713889
Delaware,2042260.7933182449
Montana,720554.5926224514
Arizona,25357559.299180172
Connecticut,5347366.443614537
Virginia,14534537.818791235
West Virginia,2696642.543676341
Wisconsin,18493486.254009772
Missouri,20922455.467775125
Nebraska,3393835.3477551313
Washington,7293347.1851032255
Rhode Island,1602800.1897457635
New Hampshire,1104316.148032614
Kentucky,10935523.832197243
Iowa,4474350.521690869
Wyoming,399141.771538283
North Carolina,23311951.926996794
Kansas,8225046.276933068
Georgia,26673519.941978425
Florida,84572912.49373847
Oregon,4384028.977048004
Alaska,448709.5001029907
Tennessee,23508638.576180194
Oklahoma,13653148.546175594
Utah,4044369.724602101
Ponce,258970.92094872275
South Dakota,1047147.0385288498
Louisiana,16083222.605670763
Vermont,236132.86981235375
Arkansas,7146339.221664684
Guaynabo,230594.49018257228
San Juan,804284.1778948522
North Dakota,1163339.1647784074
Idaho,1995437.8357183507
Nevada,6541464.54058874
Cataño,44405.25458387743
New Mexico,5184507.9049262395
Mississippi,6657377.043182844
Toa Baja,88532.11963429808
Toa Alta,21050.91074946186
Bayamón,497071.83661161206
Trujillo Alto,46041.3645230469
Carolina,354839.38441194326
Aguadilla,107574.99307295939
Arecibo,83422.88329775061
Hawaii,4657525.910539113
Canóvanas,38726.67058507054
Mayagüez,137284.59180836374
Hormigueros,13057.408935665711

2025-01-24 23:39:59 - root - INFO - SQL:
SELECT
      `state_name`,
      SUM(`carbon_offset_metric_tons`) AS total_carbon_dioxide_offset
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
    GROUP BY `state_name`
    LIMIT 100;
Results:
state_name,total_carbon_dioxide_offset
Pennsylvania,25679219.80437739
District of Columbia,768728.0745405233
New York,21932730.052032925
Delaware,2047732.7107329234
Maryland,9341908.182602106
New Jersey,21441825.25895088
Virginia,14570516.61273872
Florida,84762071.96637782
Illinois,39019478.60061409
Indiana,22286009.07525565
Louisiana,16119065.632724497
Michigan,32170938.264395673
Minnesota,9461269.60415691
New Hampshire,1106392.3375477034
South Carolina,15082325.953191793
Texas,80026572.096204
Arizona,25393752.120932516
California,67060256.55990341
Colorado,15019343.801609268
Iowa,4480709.137428613
Ohio,39985118.69480569
Mayagüez,136317.66351863468
Georgia,26767856.473523572
North Carolina,23363984.23961257
Tennessee,23662867.396383435
Wisconsin,18538719.21183869
Alaska,449958.7974072521
Kansas,8248164.194144529
Maine,951467.7454093616
Missouri,20988770.94279072
Nebraska,3407555.4824368763
North Dakota,1164890.4157271704
West Virginia,2708875.4834375717
Connecticut,5385610.01469212
Kentucky,10893849.027434945
Massachusetts,8448829.999860715
Montana,721128.5004524507
South Dakota,1047973.7956763804
Utah,4055086.3829833143
Washington,7305348.12157799
Idaho,2001480.6360385304
Nevada,6552267.614581585
Rhode Island,1613670.2387647687
Wyoming,399567.8100756294
Ponce,259596.63619231156
Mississippi,6675246.399348798
Oregon,4391352.901025001
Aguadilla,107733.02459435826
San Juan,792573.4658976336
Oklahoma,13676736.48241065
Vermont,238985.90700712064
Carolina,372344.8403529482
Alabama,15792877.15528394
Bayamón,505479.538757477
Arkansas,7162306.228122599
Toa Alta,17313.180368415116
Trujillo Alto,46442.93098691624
Canóvanas,33633.896532571576
Cataño,40096.302153202625
Guaynabo,230168.95562252367
New Mexico,5193766.818696549
Toa Baja,86581.46720940566
Hawaii,4666457.000837703
Hormigueros,14312.409783773297
Arecibo,74104.26841802277
Dorado,47475.16902867142

2025-01-24 23:40:01 - root - INFO - SQL:
SELECT
      `state_name`,
      SUM(`count_qualified` - `existing_installs_count`) AS gap_in_potential_installations
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
    GROUP BY `state_name`
    LIMIT 100;
Results:
state_name,gap_in_potential_installations
Pennsylvania,1950183
District of Columbia,75943
Indiana,1115426
Texas,5462650
California,8275950
South Carolina,906615
New Jersey,1617086
New York,2483797
Minnesota,767964
Maryland,699332
Alabama,812768
Ohio,2189269
Michigan,1844515
Illinois,2050075
Colorado,1007054
Massachusetts,985382
Maine,99600
Delaware,147343
Montana,118393
Arizona,1713835
Connecticut,602708
Virginia,960863
West Virginia,154789
Wisconsin,898115
Missouri,1028243
Nebraska,283121
Washington,1505113
Rhode Island,202494
New Hampshire,106750
Kentucky,576530
Iowa,349825
Wyoming,53039
North Carolina,1413133
Kansas,416381
Georgia,1500185
Florida,4708885
Oregon,763794
Alaska,57055
Tennessee,1101641
Oklahoma,700086
Utah,569369
Ponce,18706
South Dakota,72826
Louisiana,856210
Vermont,19373
Arkansas,369486
Guaynabo,12113
San Juan,44665
North Dakota,77093
Idaho,311142
Nevada,556366
Cataño,2860
New Mexico,361964
Mississippi,324511
Toa Baja,6976
Toa Alta,1123
Bayamón,33260
Trujillo Alto,2854
Carolina,19237
Aguadilla,5844
Arecibo,4433
Hawaii,178851
Canóvanas,2182
Mayagüez,7348
Hormigueros,1194
Dorado,3064
Corozal,15
Baja California,1
Moca,1

2025-01-24 23:40:02 - root - INFO - SQL:
SELECT
      `state_name`,
      SUM(`count_qualified` - `existing_installs_count`) AS gap_in_potential_installations
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
    GROUP BY `state_name`
    LIMIT 100;
Results:
state_name,gap_in_potential_installations
Pennsylvania,1951689
District of Columbia,76022
New York,2487240
Delaware,147447
Maryland,699742
New Jersey,1620118
Virginia,961383
Florida,4712507
Illinois,2053003
Indiana,1116012
Louisiana,856780
Michigan,1845535
Minnesota,768559
New Hampshire,106841
South Carolina,907128
Texas,5466434
Arizona,1714808
California,8286083
Colorado,1007705
Iowa,350036
Ohio,2192055
Mayagüez,7284
Georgia,1501780
North Carolina,1413932
Tennessee,1104151
Wisconsin,898793
Alaska,57086
Kansas,416595
Maine,99705
Missouri,1029240
Nebraska,283257
North Dakota,77105
West Virginia,154967
Connecticut,603585
Kentucky,575262
Massachusetts,986834
Montana,118421
South Dakota,72846
Utah,569989
Washington,1506055
Idaho,311349
Nevada,556715
Rhode Island,202796
Wyoming,53061
Ponce,18091
Mississippi,324739
Oregon,764477
Aguadilla,5852
San Juan,44341
Oklahoma,700478
Vermont,19399
Carolina,19688
Alabama,813666
Bayamón,33466
Arkansas,369777
Toa Alta,1345
Trujillo Alto,2873
Canóvanas,2099
Cataño,2764
Guaynabo,11603
New Mexico,362213
Toa Baja,6517
Hawaii,178998
Hormigueros,1264
Arecibo,3962
Dorado,3067
Hatillo,224
Cabo Rojo,2
Loíza,40
Moca,1

2025-01-24 23:40:04 - root - INFO - SQL:
SELECT
      `region_name` AS postal_code,
      `state_name`,
      `count_qualified` AS buildings_available
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
    ORDER BY `count_qualified` DESC
    LIMIT 100;
Results:
postal_code,state_name,buildings_available
79936,Texas,31973
77449,Texas,31637
77494,Texas,31622
32162,Florida,30403
75034,Texas,27743
77084,Texas,26876
77479,Texas,26867
78660,Texas,26231
77573,Texas,26002
77584,Texas,25423
73099,Oklahoma,24905
92345,California,24776
63376,Missouri,24104
75052,Texas,23925
77429,Texas,23882
92592,California,23608
92336,California,23471
94565,California,23381
78613,Texas,23374
93722,California,23281
37013,Tennessee,23261
78130,Texas,23003
85308,Arizona,22975
92503,California,22287
37042,Tennessee,22262
90650,California,22217
74012,Oklahoma,22160
76244,Texas,22142
95630,California,21939
60629,Illinois,21658
87114,New Mexico,21643
92683,California,21638
23464,Virginia,21557
99301,Washington,21553
87120,New Mexico,21382
77433,Texas,21269
45011,Ohio,21237
75002,Texas,21228
91710,California,21196
73160,Oklahoma,21133
87121,New Mexico,21091
93065,California,21028
94558,California,20962
93274,California,20943
87105,New Mexico,20879
85032,Arizona,20823
77379,Texas,20693
83709,Idaho,20639
28269,North Carolina,20639
78521,Texas,20611
78245,Texas,20592
93307,California,20571
77450,Texas,20536
95747,California,20506
95624,California,20449
85142,Arizona,20431
30906,Georgia,20356
87124,New Mexico,20329
85225,Arizona,20288
85364,Arizona,20162
93230,California,20141
66062,Kansas,20120
77845,Texas,20082

2025-01-24 23:40:06 - root - INFO - SQL:
SELECT
      `region_name` AS census_tract,
      `state_name`,
      `yearly_sunlight_kwh_total` AS energy_generation_potential
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
    ORDER BY `yearly_sunlight_kwh_total` DESC
    LIMIT 100;
Results:
census_tract,state_name,energy_generation_potential
47157022600,Tennessee,824835336.382654
06071012700,California,672633880.6769227
49035114500,Utah,646815810.9101747
12119911200,Florida,612472661.2934877
48113010000,Texas,596378778.0511045
48157673101,Texas,515412281.1148439
32031003101,Nevada,511767546.9111937
12086009010,Florida,509790663.9146789
06037532400,California,494440288.77725846
06001441503,California,494428190.00062877
06059075515,California,460455954.2349241
13121010303,Georgia,437384016.95564574
53033029206,Washington,415369613.41289943
06107001003,California,401439786.70664066
12095017103,Florida,394718229.3980347
12086009100,Florida,389068991.7813536
06001437101,California,383833595.86531395
13051010700,Georgia,347668706.0473267
06071002110,California,345228265.38629764
12115002712,Florida,343766645.7025698
34023008502,New Jersey,340096252.8597841
06037408202,California,336447383.25806886
06071000504,California,335910081.93043214
06085505006,California,334944852.1465209
34023008900,New Jersey,334336354.7164731
06037543305,California,333712284.70682347
06071002204,California,332907476.2624328
48329010114,Texas,332146690.99438506
04013112512,Arizona,331902060.7204588
26163558300,Michigan,323275191.8054076
06073008511,California,319731157.1123412
12111382108,Florida,314462540.85859376
29095015500,Missouri,310765274.00772125
48113018506,Texas,306231533.58079815
17197880202,Illinois,306153332.4264712
39017011123,Ohio,302443549.49872124
04013216816,Arizona,301257244.01858544
06077003803,California,293563857.67392576
06073008350,California,290592934.93217754
31055007409,Nebraska,289847584.6571406
48039660602,Texas,287282457.24771124
29189213102,Missouri,287187871.59714353
29047022100,Missouri,286575658.50643927
22051024202,Louisiana,285289860.9176331
48201540100,Texas,284763524.03508955
12095017104,Florida,281938241.19138205
13121007805,Georgia,278343462.3308834

2025-01-24 23:40:06 - root - INFO - itercount: 0
2025-01-24 23:40:06 - root - INFO - Database Name: bigquery-public-data
Schema Name: sunroof_solar
DDL describes table information.
,0
table_name,solar_potential_by_postal_code
ddl,"CREATE TABLE `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
(
  region_name STRING OPTIONS(description=""Postal Code""),
  state_name STRING OPTIONS(description=""Name of the state containing that region""),
  lat_max FLOAT64 OPTIONS(description=""maximum latitude for that region""),
  lat_min FLOAT64 OPTIONS(description=""minimum latitude for that region""),
  lng_max FLOAT64 OPTIONS(description=""maximum longitude for that region""),
  lng_min FLOAT64 OPTIONS(description=""minimum longitude for that region""),
  lat_avg FLOAT64 OPTIONS(description=""average latitude for that region""),
  lng_avg FLOAT64 OPTIONS(description=""average longitude for that region""),
  yearly_sunlight_kwh_kw_threshold_avg FLOAT64 OPTIONS(description=""75% of the optimimum sunlight in the county containing that zip code""),
  count_qualified INT64 OPTIONS(description=""# of buildings in Google Maps that are suitable for solar""),
  percent_covered FLOAT64 OPTIONS(description=""% of buildings in Google Maps covered by Project Sunroof""),
  percent_qualified FLOAT64 OPTIONS(description=""% of buildings covered by Project Sunroof that are suitable for solar""),
  number_of_panels_n INT64 OPTIONS(description=""# of solar panels potential for north-facing roof space in that region, assuming 1.650m x 0.992m panels""),
  number_of_panels_s INT64 OPTIONS(description=""# of solar panels potential for south-facing roof space in that region, assuming 1.650m x 0.992m panels""),
  number_of_panels_e INT64 OPTIONS(description=""# of solar panels potential for east-facing roof space in that region, assuming 1.650m x 0.992m panels""),
  number_of_panels_w INT64 OPTIONS(description=""# of solar panels potential for west-facing roof space in that region, assuming 1.650m x 0.992m panels""),
  number_of_panels_f INT64 OPTIONS(description=""# of solar panels potential for flat roof space in that region, assuming 1.650m x 0.992m panels""),
  number_of_panels_median INT64 OPTIONS(description=""# of panels that fit on the median roof""),
  number_of_panels_total INT64 OPTIONS(description=""# of solar panels potential for all roof space in that region, assuming 1.650m 0.992m panels""),
  kw_median FLOAT64 OPTIONS(description=""kW of solar potential for the median building in that region (assuming 250 watts per panel)""),
  kw_total FLOAT64 OPTIONS(description=""# of kW of solar potential for all roof types in that region (assuming 250 watts per panel)""),
  yearly_sunlight_kwh_n FLOAT64 OPTIONS(description=""total solar energy generation potential for north-facing roof space in that region""),
  yearly_sunlight_kwh_s FLOAT64 OPTIONS(description=""total solar energy generation potential for south-facing roof space in that region""),
  yearly_sunlight_kwh_e FLOAT64 OPTIONS(description=""total solar energy generation potential for east-facing roof space in that region""),
  yearly_sunlight_kwh_w FLOAT64 OPTIONS(description=""total solar energy generation potential for west-facing roof space in that region""),
  yearly_sunlight_kwh_f FLOAT64 OPTIONS(description=""total solar energy generation potential for flat roof space in that region""),
  yearly_sunlight_kwh_median FLOAT64 OPTIONS(description=""kWh/kw/yr for the median roof, in DC (not AC) terms""),
  yearly_sunlight_kwh_total FLOAT64 OPTIONS(description=""total solar energy generation potential for all roof space in that region""),
  install_size_kw_buckets STRING OPTIONS(description=""# of buildings with potential for various installation size buckets. Format is a JSON array, where each element is a tuple containing (1) lower bound of bucket, in kW, and (2) number of buildings in that bucket.""),
  carbon_offset_metric_tons FLOAT64 OPTIONS(description=""The potential carbon dioxide abatement of the solar capacity that meets the technical potential criteria. The calculation uses eGRID subregion CO2 equivalent non-baseload output emission rates. https://www.epa.gov/sites/production/files/2015-10/documents/egrid2012_summarytables_0.pdf""),
  existing_installs_count INT64 OPTIONS(description=""# of buildings estimated to have a solar installation, at time of data collection""),
  center_point GEOGRAPHY
)
OPTIONS(
  description=""Sunroof Solar Potential By Postal Code""
);"

,1
table_name,solar_potential_by_censustract
ddl,"CREATE TABLE `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
(
  region_name STRING OPTIONS(description=""Census Tract""),
  state_name STRING OPTIONS(description=""Name of the state containing that region""),
  lat_max FLOAT64 OPTIONS(description=""maximum latitude for that region""),
  lat_min FLOAT64 OPTIONS(description=""minimum latitude for that region""),
  lng_max FLOAT64 OPTIONS(description=""maximum longitude for that region""),
  lng_min FLOAT64 OPTIONS(description=""minimum longitude for that region""),
  lat_avg FLOAT64 OPTIONS(description=""average latitude for that region""),
  lng_avg FLOAT64 OPTIONS(description=""average longitude for that region""),
  yearly_sunlight_kwh_kw_threshold_avg FLOAT64 OPTIONS(description=""75% of the optimimum sunlight in the county containing that zip code""),
  count_qualified INT64 OPTIONS(description=""# of buildings in Google Maps that are suitable for solar""),
  percent_covered FLOAT64 OPTIONS(description=""% of buildings in Google Maps covered by Project Sunroof""),
  percent_qualified FLOAT64 OPTIONS(description=""% of buildings covered by Project Sunroof that are suitable for solar""),
  number_of_panels_n INT64 OPTIONS(description=""# of solar panels potential for north-facing roof space in that region, assuming 1.650m x 0.992m panels""),
  number_of_panels_s INT64 OPTIONS(description=""# of solar panels potential for south-facing roof space in that region, assuming 1.650m x 0.992m panels""),
  number_of_panels_e INT64 OPTIONS(description=""# of solar panels potential for east-facing roof space in that region, assuming 1.650m x 0.992m panels""),
  number_of_panels_w INT64 OPTIONS(description=""# of solar panels potential for west-facing roof space in that region, assuming 1.650m x 0.992m panels""),
  number_of_panels_f INT64 OPTIONS(description=""# of solar panels potential for flat roof space in that region, assuming 1.650m x 0.992m panels""),
  number_of_panels_median INT64 OPTIONS(description=""# of panels that fit on the median roof""),
  number_of_panels_total INT64 OPTIONS(description=""# of solar panels potential for all roof space in that region, assuming 1.650m 0.992m panels""),
  kw_median FLOAT64 OPTIONS(description=""kW of solar potential for the median building in that region (assuming 250 watts per panel)""),
  kw_total FLOAT64 OPTIONS(description=""# of kW of solar potential for all roof types in that region (assuming 250 watts per panel)""),
  yearly_sunlight_kwh_n FLOAT64 OPTIONS(description=""total solar energy generation potential for north-facing roof space in that region""),
  yearly_sunlight_kwh_s FLOAT64 OPTIONS(description=""total solar energy generation potential for south-facing roof space in that region""),
  yearly_sunlight_kwh_e FLOAT64 OPTIONS(description=""total solar energy generation potential for east-facing roof space in that region""),
  yearly_sunlight_kwh_w FLOAT64 OPTIONS(description=""total solar energy generation potential for west-facing roof space in that region""),
  yearly_sunlight_kwh_f FLOAT64 OPTIONS(description=""total solar energy generation potential for flat roof space in that region""),
  yearly_sunlight_kwh_median FLOAT64 OPTIONS(description=""kWh/kw/yr for the median roof, in DC (not AC) terms""),
  yearly_sunlight_kwh_total FLOAT64 OPTIONS(description=""total solar energy generation potential for all roof space in that region""),
  install_size_kw_buckets STRING OPTIONS(description=""# of buildings with potential for various installation size buckets. Format is a JSON array, where each element is a tuple containing (1) lower bound of bucket, in kW, and (2) number of buildings in that bucket.""),
  carbon_offset_metric_tons FLOAT64 OPTIONS(description=""The potential carbon dioxide abatement of the solar capacity that meets the technical potential criteria. The calculation uses eGRID subregion CO2 equivalent non-baseload output emission rates. https://www.epa.gov/sites/production/files/2015-10/documents/egrid2012_summarytables_0.pdf""),
  existing_installs_count INT64 OPTIONS(description=""# of buildings estimated to have a solar installation, at time of data collection""),
  center_point GEOGRAPHY
)
OPTIONS(
  description=""Sunroof Solar Potential By Census Tract""
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'sunroof_solar': ['solar_potential_by_censustract', 'solar_potential_by_postal_code']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

**Table 1**: `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`

- **`state_name`**: Used to identify the state for each postal code region.
- **`region_name`**: The postal code of the region.
- **`count_qualified`**: Number of buildings available for solar installations.
- **`percent_covered`**: Percentage of buildings covered by Project Sunroof.
- **`percent_qualified`**: Percentage of buildings suitable for solar installations.
- **`number_of_panels_total`**: Total potential panel count in the region.
- **`kw_total`**: Total kilowatt capacity potential in the region.
- **`yearly_sunlight_kwh_total`**: Energy generation potential in kilowatt-hours.
- **`carbon_offset_metric_tons`**: Potential carbon dioxide offset in metric tons.
- **`existing_installs_count`**: Number of buildings estimated to have a solar installation.
- **Conditions**: Can filter or group data by `state_name` to compare states.

**Table 2**: `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`

- **`state_name`**: Used to identify the state for each census tract region.
- **`region_name`**: The census tract code of the region.
- **`count_qualified`**: Number of buildings available for solar installations.
- **`percent_covered`**: Percentage of buildings covered by Project Sunroof.
- **`percent_qualified`**: Percentage of buildings suitable for solar installations.
- **`number_of_panels_total`**: Total potential panel count in the region.
- **`kw_total`**: Total kilowatt capacity potential in the region.
- **`yearly_sunlight_kwh_total`**: Energy generation potential in kilowatt-hours.
- **`carbon_offset_metric_tons`**: Potential carbon dioxide offset in metric tons.
- **`existing_installs_count`**: Number of buildings estimated to have a solar installation.
- **Conditions**: Can filter or group data by `state_name` to compare states.

**Potential Usage of Columns:**

- **`state_name`**: Group data by state for comparison.
- **`count_qualified`**: Determine the number of buildings available for solar installations.
- **`percent_covered`**: Assess the coverage of Project Sunroof in each region.
- **`percent_qualified`**: Evaluate the percentage of buildings suitable for solar.
- **`number_of_panels_total`**: Calculate the total potential panel count.
- **`kw_total`**: Compute the total kilowatt capacity potential.
- **`yearly_sunlight_kwh_total`**: Estimate the energy generation potential.
- **`carbon_offset_metric_tons`**: Calculate the potential carbon dioxide offset.
- **`existing_installs_count`**: Find the gap in potential installations by comparing with `count_qualified`.

---

**BigQuery SQL Queries:**

1. **List distinct states from the postal code table:**

   ```sql
   SELECT DISTINCT `state_name`
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
   LIMIT 100;
   ```

2. **List distinct states from the census tract table:**

   ```sql
   SELECT DISTINCT `state_name`
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
   LIMIT 100;
   ```

3. **Retrieve the number of buildings available for solar installations by state (postal code level):**

   ```sql
   SELECT
     `state_name`,
     SUM(`count_qualified`) AS total_buildings_available
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
   GROUP BY `state_name`
   LIMIT 100;
   ```

4. **Retrieve the number of buildings available for solar installations by state (census tract level):**

   ```sql
   SELECT
     `state_name`,
     SUM(`count_qualified`) AS total_buildings_available
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
   GROUP BY `state_name`
   LIMIT 100;
   ```

5. **Calculate the average percentage covered by Project Sunroof for each state (postal code level):**

   ```sql
   SELECT
     `state_name`,
     AVG(`percent_covered`) AS avg_percent_covered
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
   GROUP BY `state_name`
   LIMIT 100;
   ```

6. **Calculate the average percentage covered by Project Sunroof for each state (census tract level):**

   ```sql
   SELECT
     `state_name`,
     AVG(`percent_covered`) AS avg_percent_covered
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
   GROUP BY `state_name`
   LIMIT 100;
   ```

7. **Compute the percentage of buildings suitable for solar for each state (postal code level):**

   ```sql
   SELECT
     `state_name`,
     AVG(`percent_qualified`) AS avg_percent_suitable
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
   GROUP BY `state_name`
   LIMIT 100;
   ```

8. **Compute the percentage of buildings suitable for solar for each state (census tract level):**

   ```sql
   SELECT
     `state_name`,
     AVG(`percent_qualified`) AS avg_percent_suitable
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
   GROUP BY `state_name`
   LIMIT 100;
   ```

9. **Get total potential panel count by state (postal code level):**

   ```sql
   SELECT
     `state_name`,
     SUM(`number_of_panels_total`) AS total_potential_panel_count
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
   GROUP BY `state_name`
   LIMIT 100;
   ```

10. **Get total potential panel count by state (census tract level):**

    ```sql
    SELECT
      `state_name`,
      SUM(`number_of_panels_total`) AS total_potential_panel_count
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
    GROUP BY `state_name`
    LIMIT 100;
    ```

11. **Calculate total kilowatt capacity by state (postal code level):**

    ```sql
    SELECT
      `state_name`,
      SUM(`kw_total`) AS total_kw_capacity
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
    GROUP BY `state_name`
    LIMIT 100;
    ```

12. **Calculate total kilowatt capacity by state (census tract level):**

    ```sql
    SELECT
      `state_name`,
      SUM(`kw_total`) AS total_kw_capacity
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
    GROUP BY `state_name`
    LIMIT 100;
    ```

13. **Compute total energy generation potential by state (postal code level):**

    ```sql
    SELECT
      `state_name`,
      SUM(`yearly_sunlight_kwh_total`) AS total_energy_generation_potential
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
    GROUP BY `state_name`
    LIMIT 100;
    ```

14. **Compute total energy generation potential by state (census tract level):**

    ```sql
    SELECT
      `state_name`,
      SUM(`yearly_sunlight_kwh_total`) AS total_energy_generation_potential
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
    GROUP BY `state_name`
    LIMIT 100;
    ```

15. **Calculate total carbon dioxide offset by state (postal code level):**

    ```sql
    SELECT
      `state_name`,
      SUM(`carbon_offset_metric_tons`) AS total_carbon_dioxide_offset
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
    GROUP BY `state_name`
    LIMIT 100;
    ```

16. **Calculate total carbon dioxide offset by state (census tract level):**

    ```sql
    SELECT
      `state_name`,
      SUM(`carbon_offset_metric_tons`) AS total_carbon_dioxide_offset
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
    GROUP BY `state_name`
    LIMIT 100;
    ```

17. **Determine the gap in potential installations by state (postal code level):**

    ```sql
    SELECT
      `state_name`,
      SUM(`count_qualified` - `existing_installs_count`) AS gap_in_potential_installations
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
    GROUP BY `state_name`
    LIMIT 100;
    ```

18. **Determine the gap in potential installations by state (census tract level):**

    ```sql
    SELECT
      `state_name`,
      SUM(`count_qualified` - `existing_installs_count`) AS gap_in_potential_installations
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
    GROUP BY `state_name`
    LIMIT 100;
    ```

19. **List the top 100 postal codes with the highest number of buildings suitable for solar installations:**

    ```sql
    SELECT
      `region_name` AS postal_code,
      `state_name`,
      `count_qualified` AS buildings_available
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
    ORDER BY `count_qualified` DESC
    LIMIT 100;
    ```

20. **List the top 100 census tracts with the highest energy generation potential:**

    ```sql
    SELECT
      `region_name` AS census_tract,
      `state_name`,
      `yearly_sunlight_kwh_total` AS energy_generation_potential
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
    ORDER BY `yearly_sunlight_kwh_total` DESC
    LIMIT 100;
    ```

---

These SQL queries are designed to help understand the values in the relevant columns and facilitate a detailed comparison of the solar potential for each state at both the postal code and census tract levels. The queries cover various aspects such as the number of buildings available for solar installations, percentages covered and suitable for solar, total potential panel counts, kilowatt capacities, energy generation potentials, carbon dioxide offsets, and gaps in potential installations.

By executing these queries, you can gather the necessary data to perform the detailed comparison as specified in the task.Query:
SELECT DISTINCT `state_name`
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
   LIMIT 100;
Answer:
state_name
Pennsylvania
District of Columbia
Indiana
Texas
California
South Carolina
New Jersey
New York
Minnesota
Maryland
Alabama
Ohio
Michigan
Illinois
Colorado
Massachusetts
Maine
Delaware
Montana
Arizona
Connecticut
Virginia
West Virginia
Wisconsin
Missouri
Nebraska
Washington
Rhode Island
New Hampshire
Kentucky
Iowa
Wyoming
North Carolina
Kansas
Georgia
Florida
Oregon
Alaska
Tennessee
Oklahoma
Utah
Ponce
South Dakota
Louisiana
Vermont
Arkansas
Guaynabo
San Juan
North Dakota
Idaho
Nevada
Cataño
New Mexico
Mississippi
Toa Baja
Toa Alta
Bayamón
Trujillo Alto
Carolina
Aguadilla
Arecibo
Hawaii
Canóvanas
Mayagüez
Hormigueros
Dorado
Corozal
Baja California
Moca
Query:
SELECT DISTINCT `state_name`
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
   LIMIT 100;
Answer:
state_name
Pennsylvania
District of Columbia
New York
Delaware
Maryland
New Jersey
Virginia
Florida
Illinois
Indiana
Louisiana
Michigan
Minnesota
New Hampshire
South Carolina
Texas
Arizona
California
Colorado
Iowa
Ohio
Mayagüez
Georgia
North Carolina
Tennessee
Wisconsin
Alaska
Kansas
Maine
Missouri
Nebraska
North Dakota
West Virginia
Connecticut
Kentucky
Massachusetts
Montana
South Dakota
Utah
Washington
Idaho
Nevada
Rhode Island
Wyoming
Ponce
Mississippi
Oregon
Aguadilla
San Juan
Oklahoma
Vermont
Carolina
Alabama
Bayamón
Arkansas
Toa Alta
Trujillo Alto
Canóvanas
Cataño
Guaynabo
New Mexico
Toa Baja
Hawaii
Hormigueros
Arecibo
Dorado
Hatillo
Cabo Rojo
Loíza
Moca
Query:
SELECT
     `state_name`,
     SUM(`count_qualified`) AS total_buildings_available
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
   GROUP BY `state_name`
   LIMIT 100;
Answer:
state_name,total_buildings_available
Pennsylvania,1954585
District of Columbia,76385
Indiana,1116413
Texas,5476777
California,8607224
South Carolina,907878
New Jersey,1629714
New York,2502541
Minnesota,769481
Maryland,705396
Alabama,813312
Ohio,2192109
Michigan,1846232
Illinois,2052522
Colorado,1031389
Massachusetts,1000732
Maine,99960
Delaware,147431
Montana,118654
Arizona,1753531
Connecticut,607976
Virginia,963270
West Virginia,154869
Wisconsin,900028
Missouri,1031097
Nebraska,283330
Washington,1510869
Rhode Island,202865
New Hampshire,107012
Kentucky,577255
Iowa,350073
Wyoming,53068
North Carolina,1416043
Kansas,417118
Georgia,1502091
Florida,4814177
Oregon,772441
Alaska,57138
Tennessee,1102947
Oklahoma,700888
Utah,572530
Ponce,18706
South Dakota,72847
Louisiana,864431
Vermont,19504
Arkansas,369725
Guaynabo,12113
San Juan,44665
North Dakota,77117
Idaho,311671
Nevada,569104
Cataño,2860
New Mexico,365713
Mississippi,324867
Toa Baja,6976
Toa Alta,1123
Bayamón,33260
Trujillo Alto,2854
Carolina,19237
Aguadilla,5844
Arecibo,4433
Hawaii,204227
Canóvanas,2182
Mayagüez,7348
Hormigueros,1194
Dorado,3064
Corozal,15
Baja California,1
Moca,1
Query:
SELECT
     `state_name`,
     SUM(`count_qualified`) AS total_buildings_available
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
   GROUP BY `state_name`
   LIMIT 100;
Answer:
state_name,total_buildings_available
Pennsylvania,1956097
District of Columbia,76464
New York,2506035
Delaware,147535
Maryland,705813
New Jersey,1632773
Virginia,963792
Florida,4817871
Illinois,2055456
Indiana,1117000
Louisiana,865003
Michigan,1847255
Minnesota,770077
New Hampshire,107103
South Carolina,908394
Texas,5480573
Arizona,1754534
California,8617901
Colorado,1032067
Iowa,350284
Ohio,2194900
Mayagüez,7284
Georgia,1503687
North Carolina,1416843
Tennessee,1105463
Wisconsin,900707
Alaska,57169
Kansas,417333
Maine,100065
Missouri,1032104
Nebraska,283467
North Dakota,77129
West Virginia,155047
Connecticut,608869
Kentucky,575985
Massachusetts,1002203
Montana,118683
South Dakota,72867
Utah,573155
Washington,1511814
Idaho,311878
Nevada,569461
Rhode Island,203167
Wyoming,53090
Ponce,18091
Mississippi,325095
Oregon,773130
Aguadilla,5852
San Juan,44341
Oklahoma,701280
Vermont,19530
Carolina,19688
Alabama,814213
Bayamón,33466
Arkansas,370016
Toa Alta,1345
Trujillo Alto,2873
Canóvanas,2099
Cataño,2764
Guaynabo,11603
New Mexico,365962
Toa Baja,6517
Hawaii,204390
Hormigueros,1264
Arecibo,3962
Dorado,3067
Hatillo,224
Cabo Rojo,2
Loíza,40
Moca,1
Query:
SELECT
     `state_name`,
     AVG(`percent_covered`) AS avg_percent_covered
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
   GROUP BY `state_name`
   LIMIT 100;
Answer:
state_name,avg_percent_covered
Pennsylvania,79.069678971782
District of Columbia,81.96327798463948
Indiana,72.70729951623908
Texas,81.35349870837823
California,89.7807005015948
South Carolina,68.2990652629294
New Jersey,88.22893832760151
New York,85.2767396257726
Minnesota,83.07005491274445
Maryland,71.16030669975413
Alabama,65.3636415604924
Ohio,79.33516702608132
Michigan,76.11109096649122
Illinois,81.52174935109402
Colorado,81.12936471319748
Massachusetts,81.69850341980238
Maine,63.10106887979922
Delaware,77.33200952927507
Montana,69.92868695582882
Arizona,87.4686382928109
Connecticut,77.1032770026374
Virginia,70.44108422452726
West Virginia,66.83908549978548
Wisconsin,78.21393285262626
Missouri,80.34422515005369
Nebraska,80.37294823445419
Washington,83.21639552127758
Rhode Island,83.84201456517948
New Hampshire,50.142312161287336
Kentucky,75.34738154677154
Iowa,72.26174249883248
Wyoming,78.96861340065534
North Carolina,63.19407091476492
Kansas,78.0015186723769
Georgia,72.02704651939652
Florida,82.98495071423179
Oregon,76.67033698320564
Alaska,88.96629632261681
Tennessee,74.46006733391977
Oklahoma,76.98000635053326
Utah,76.16223561464697
Ponce,87.8721771073327
South Dakota,52.45083205685707
Louisiana,74.02401966050749
Vermont,79.35918973288328
Arkansas,64.03184484226828
Guaynabo,96.69070837371878
San Juan,98.24550518972346
North Dakota,78.53210718919708
Idaho,77.44616743720586
Nevada,80.35806150420439
Cataño,95.55259585846524
New Mexico,73.56221925571539
Mississippi,72.63111176104802
Toa Baja,96.83583571162676
Toa Alta,83.18994043679682
Bayamón,97.36410651881141
Trujillo Alto,93.46999728482216
Carolina,88.9530773741177
Aguadilla,93.15526870442538
Arecibo,77.87529184298847
Hawaii,85.77323256083754
Canóvanas,66.34040239260467
Mayagüez,93.56904274340901
Hormigueros,58.690744920993225
Dorado,78.27859026612323
Corozal,1.2121212121212122
Baja California,0.06743088334457181
Moca,0.36900369003690037
Query:
SELECT
     `state_name`,
     AVG(`percent_covered`) AS avg_percent_covered
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
   GROUP BY `state_name`
   LIMIT 100;
Answer:
state_name,avg_percent_covered
Pennsylvania,92.68306466974028
District of Columbia,85.31731546190417
New York,87.0165466642333
Delaware,85.27792503329303
Maryland,80.03630516726585
New Jersey,124.22007839679846
Virginia,90.9867152039755
Florida,99.634633695383
Illinois,91.65385121185525
Indiana,102.8845689736421
Louisiana,113.44943038082391
Michigan,96.31663324257916
Minnesota,90.42832750511005
New Hampshire,82.68678043934635
South Carolina,95.4739597522511
Texas,89.86343251034099
Arizona,109.64577014936981
California,93.22199775185501
Colorado,90.80594676965516
Iowa,92.502375228341
Ohio,100.1957983798896
Mayagüez,129.17712026429936
Georgia,96.5545833414853
North Carolina,111.00378212601835
Tennessee,96.22961807019115
Wisconsin,93.19365253852426
Alaska,83.13432918928937
Kansas,89.95113875826723
Maine,85.2430142664818
Missouri,89.17689216788044
Nebraska,93.4175734888357
North Dakota,88.55661024596186
West Virginia,134.70406557147317
Connecticut,87.30600764926562
Kentucky,94.62267354085361
Massachusetts,87.21982464135503
Montana,80.417314727058
South Dakota,82.78193284825556
Utah,93.1267398386917
Washington,102.21900785046982
Idaho,84.46661050804313
Nevada,98.16257499733604
Rhode Island,91.74013630607044
Wyoming,75.88811972405551
Ponce,91.56236721318227
Mississippi,110.38685412641182
Oregon,92.07550262671668
Aguadilla,95.93904539313897
San Juan,361.1600438845386
Oklahoma,90.58936275851076
Vermont,102.79805757806196
Carolina,118.61155203088134
Alabama,118.15181543509544
Bayamón,98.86868696240633
Arkansas,94.08798696727425
Toa Alta,1710.7408116079805
Trujillo Alto,2040.5624934431326
Canóvanas,111.11231184290489
Cataño,1977.1135751398197
Guaynabo,111.26805227548675
New Mexico,90.19310294856486
Toa Baja,108.024984187698
Hawaii,92.40890122239375
Hormigueros,72.03823210284625
Arecibo,239.55162200350406
Dorado,133.84216326057313
Hatillo,38.851761427901465
Cabo Rojo,5.0
Loíza,85.48387096774194
Moca,0.8264462809917356
Query:
SELECT
     `state_name`,
     AVG(`percent_qualified`) AS avg_percent_suitable
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
   GROUP BY `state_name`
   LIMIT 100;
Answer:
state_name,avg_percent_suitable
Pennsylvania,79.50152162654115
District of Columbia,75.11488176242612
Indiana,80.98704273615948
Texas,89.34929795432048
California,88.41052498683767
South Carolina,80.08563002130778
New Jersey,76.2982184524033
New York,77.40818366695972
Minnesota,72.02677785988111
Maryland,78.21436738373333
Alabama,81.8829916901213
Ohio,82.3972375933493
Michigan,79.04143589637181
Illinois,81.22551550568922
Colorado,83.07765032579091
Massachusetts,73.94909266069014
Maine,63.636668811497685
Delaware,79.8784853981143
Montana,74.89138821125226
Arizona,93.81479777093914
Connecticut,72.29881131803256
Virginia,77.44664178774819
West Virginia,82.71154300892734
Wisconsin,80.06679188975764
Missouri,82.55774214780112
Nebraska,86.88101043865281
Washington,84.03996306007771
Rhode Island,75.47806245993256
New Hampshire,68.14373199300623
Kentucky,86.8544077014831
Iowa,78.45999338382977
Wyoming,78.76528710918183
North Carolina,76.83151102623702
Kansas,83.90980882904063
Georgia,76.48404856671777
Florida,90.85016886522152
Oregon,85.56283254708079
Alaska,78.00984454758942
Tennessee,83.65948527656549
Oklahoma,90.68830861474277
Utah,85.93581601402279
Ponce,91.44872619683593
South Dakota,76.16484077656689
Louisiana,85.77600943642521
Vermont,79.59947754095191
Arkansas,80.53295880502694
Guaynabo,88.43952681035891
San Juan,91.33009202920344
North Dakota,80.68802648949996
Idaho,85.81752126830315
Nevada,92.41557021018673
Cataño,91.19644888529244
New Mexico,90.66469204457194
Mississippi,82.19166818603287
Toa Baja,89.3900563813429
Toa Alta,89.33969769291966
Bayamón,91.28405960797262
Trujillo Alto,88.81837244579282
Carolina,93.41220105410267
Aguadilla,94.31143379125443
Arecibo,93.40742399641678
Hawaii,94.93133340007105
Canóvanas,89.42622950819673
Mayagüez,91.3667202708606
Hormigueros,91.84615384615384
Dorado,93.84379785604901
Corozal,93.75
Baja California,20.0
Moca,100.0
Query:
SELECT
     `state_name`,
     AVG(`percent_qualified`) AS avg_percent_suitable
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
   GROUP BY `state_name`
   LIMIT 100;
Answer:
state_name,avg_percent_suitable
Pennsylvania,68.85707992410279
District of Columbia,63.397058540850374
New York,70.38240073336407
Delaware,71.13500821025058
Maryland,69.81305560602681
New Jersey,72.49284036555359
Virginia,70.2980366020228
Florida,83.27936582037205
Illinois,75.07039880322085
Indiana,74.41629924942166
Louisiana,82.17435382731465
Michigan,72.87447311567942
Minnesota,64.55495274901152
New Hampshire,67.94157124181982
South Carolina,73.39684628969712
Texas,83.60340471279216
Arizona,90.40516782276121
California,84.42610938177233
Colorado,80.5215995892791
Iowa,67.55135102465918
Ohio,76.22748275975313
Mayagüez,88.31524322675783
Georgia,68.6019145687061
North Carolina,68.1827711551925
Tennessee,76.2726721379218
Wisconsin,74.55363214741567
Alaska,67.38914863482441
Kansas,74.4583819109252
Maine,65.17547802899195
Missouri,76.33668998450831
Nebraska,80.62010526352873
North Dakota,75.36655521628283
West Virginia,71.81141828837345
Connecticut,65.75337434981019
Kentucky,80.79952498243406
Massachusetts,72.28938390680631
Montana,72.2771405120219
South Dakota,73.13011785666349
Utah,84.22705043917746
Washington,74.39266638906405
Idaho,75.9107679289549
Nevada,90.79523059001973
Rhode Island,75.69773905575144
Wyoming,78.68145154613299
Ponce,89.9396040617879
Mississippi,70.47452389375442
Oregon,79.6266440199705
Aguadilla,89.84303986917155
San Juan,90.20467196383028
Oklahoma,87.7429909469715
Vermont,68.89857488088953
Carolina,91.95012311270571
Alabama,75.70646896201119
Bayamón,90.54093297303565
Arkansas,73.57608276947256
Toa Alta,87.95785274938672
Trujillo Alto,86.22386755943712
Canóvanas,82.97908947936548
Cataño,86.57358974659549
Guaynabo,89.77135936863131
New Mexico,87.26558195086373
Toa Baja,90.59109586594275
Hawaii,90.28828623458985
Hormigueros,91.17801424826256
Arecibo,94.19097896614889
Dorado,94.55205024605395
Hatillo,91.4722740602506
Cabo Rojo,100.0
Loíza,75.47169811320755
Moca,100.0
Query:
SELECT
     `state_name`,
     SUM(`number_of_panels_total`) AS total_potential_panel_count
   FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
   GROUP BY `state_name`
   LIMIT 100;
Answer:
state_name,total_potential_panel_count
Pennsylvania,133004637
District of Columbia,3937623
Indiana,93048465
Texas,480505530
California,652983168
South Carolina,79183940
New Jersey,116249897
New York,157857812
Minnesota,65464154
Maryland,47560886
Alabama,77298546
Ohio,171022353
Michigan,147391827
Illinois,163236997
Colorado,69150828
Massachusetts,68609324
Maine,7689271
Delaware,10742839
Montana,9181610
Arizona,147238408
Connecticut,43269892
Virginia,74735305
West Virginia,11336559
Wisconsin,82263947
Missouri,83816328
Nebraska,21495882
Washington,107756625
Rhode Island,12914100
New Hampshire,9037409
Kentucky,47570216
Iowa,29910958
Wyoming,3843267
North Carolina,123962977
Kansas,36723960
Georgia,139653741
Florida,462105732
Oregon,61510848
Alaska,5447225
Tennessee,101108289
Oklahoma,60455902
Utah,43988756
Ponce,1162806
South Dakota,6372371
Louisiana,80134650
Vermont,1988764
Arkansas,35933867
Guaynabo,986943
San Juan,3423143
North Dakota,8128226
Idaho,23026001
Nevada,43540016
Cataño,186311
New Mexico,29552308
Mississippi,32127017
Toa Baja,371052
Toa Alta,88675
Bayamón,2098880
Trujillo Alto,196126
Carolina,1481427
Aguadilla,432049
Arecibo,345214
Hawaii,19835765
Canóvanas,160471
Mayagüez,571212
Hormigueros,54608
Dorado,199254
Corozal,1667
Baja California,23
Moca,28
Query:
SELECT
      `state_name`,
      SUM(`number_of_panels_total`) AS total_potential_panel_count
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
    GROUP BY `state_name`
    LIMIT 100;
Answer:
state_name,total_potential_panel_count
Pennsylvania,133691622
District of Columbia,3983844
New York,158794563
Delaware,10771425
Maryland,47690643
New Jersey,117024321
Virginia,74914378
Florida,463123814
Illinois,164256874
Indiana,93311273
Louisiana,80308875
Michigan,147876313
Minnesota,65662303
New Hampshire,9054358
South Carolina,79312131
Texas,481747719
Arizona,147450436
California,654784266
Colorado,69425443
Iowa,29953011
Ohio,171901350
Mayagüez,567212
Georgia,140138439
North Carolina,124233257
Tennessee,101762224
Wisconsin,82459475
Alaska,5462549
Kansas,36827430
Maine,7720530
Missouri,84085928
Nebraska,21582607
North Dakota,8138951
West Virginia,11387665
Connecticut,43575214
Kentucky,47393349
Massachusetts,69012277
Montana,9189162
South Dakota,6377373
Utah,44105531
Washington,107938035
Idaho,23093899
Nevada,43616656
Rhode Island,13001474
Wyoming,3848056
Ponce,1165041
Mississippi,32218920
Oregon,61617355
Aguadilla,432711
San Juan,3375014
Oklahoma,60560124
Vermont,2012472
Carolina,1554053
Alabama,77644088
Bayamón,2134598
Arkansas,36012747
Toa Alta,73394
Trujillo Alto,197851
Canóvanas,139475
Cataño,168020
Guaynabo,984133
New Mexico,29605361
Toa Baja,362967
Hawaii,19873246
Hormigueros,59807
Arecibo,306604
Dorado,199501
Hatillo,25246
Cabo Rojo,668
Loíza,1693
Moca,28
Query:
SELECT
      `state_name`,
      SUM(`kw_total`) AS total_kw_capacity
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
    GROUP BY `state_name`
    LIMIT 100;
Answer:
state_name,total_kw_capacity
Pennsylvania,33251159.25
District of Columbia,984405.75
Indiana,23262116.25
Texas,120126382.5
California,163245792.0
South Carolina,19795985.0
New Jersey,29062474.25
New York,39464453.0
Minnesota,16366038.5
Maryland,11890221.5
Alabama,19324636.5
Ohio,42755588.25
Michigan,36847956.75
Illinois,40809249.25
Colorado,17287707.0
Massachusetts,17152331.0
Maine,1922317.75
Delaware,2685709.75
Montana,2295402.5
Arizona,36809602.0
Connecticut,10817473.0
Virginia,18683826.25
West Virginia,2834139.75
Wisconsin,20565986.75
Missouri,20954082.0
Nebraska,5373970.5
Washington,26939156.25
Rhode Island,3228525.0
New Hampshire,2259352.25
Kentucky,11892554.0
Iowa,7477739.5
Wyoming,960816.75
North Carolina,30990744.25
Kansas,9180990.0
Georgia,34913435.25
Florida,115526433.0
Oregon,15377712.0
Alaska,1361806.25
Tennessee,25277072.25
Oklahoma,15113975.5
Utah,10997189.0
Ponce,290701.5
South Dakota,1593092.75
Louisiana,20033662.5
Vermont,497191.0
Arkansas,8983466.75
Guaynabo,246735.75
San Juan,855785.75
North Dakota,2032056.5
Idaho,5756500.25
Nevada,10885004.0
Cataño,46577.75
New Mexico,7388077.0
Mississippi,8031754.25
Toa Baja,92763.0
Toa Alta,22168.75
Bayamón,524720.0
Trujillo Alto,49031.5
Carolina,370356.75
Aguadilla,108012.25
Arecibo,86303.5
Hawaii,4958941.25
Canóvanas,40117.75
Mayagüez,142803.0
Hormigueros,13652.0
Dorado,49813.5
Corozal,416.75
Baja California,5.75
Moca,7.0
Query:
SELECT
      `state_name`,
      SUM(`kw_total`) AS total_kw_capacity
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
    GROUP BY `state_name`
    LIMIT 100;
Answer:
state_name,total_kw_capacity
Pennsylvania,33422905.5
District of Columbia,995961.0
New York,39698640.75
Delaware,2692856.25
Maryland,11922660.75
New Jersey,29256080.25
Virginia,18728594.5
Florida,115780953.5
Illinois,41064218.5
Indiana,23327818.25
Louisiana,20077218.75
Michigan,36969078.25
Minnesota,16415575.75
New Hampshire,2263589.5
South Carolina,19828032.75
Texas,120436929.75
Arizona,36862609.0
California,163696066.5
Colorado,17356360.75
Iowa,7488252.75
Ohio,42975337.5
Mayagüez,141803.0
Georgia,35034609.75
North Carolina,31058314.25
Tennessee,25440556.0
Wisconsin,20614868.75
Alaska,1365637.25
Kansas,9206857.5
Maine,1930132.5
Missouri,21021482.0
Nebraska,5395651.75
North Dakota,2034737.75
West Virginia,2846916.25
Connecticut,10893803.5
Kentucky,11848337.25
Massachusetts,17253069.25
Montana,2297290.5
South Dakota,1594343.25
Utah,11026382.75
Washington,26984508.75
Idaho,5773474.75
Nevada,10904164.0
Rhode Island,3250368.5
Wyoming,962014.0
Ponce,291260.25
Mississippi,8054730.0
Oregon,15404338.75
Aguadilla,108177.75
San Juan,843753.5
Oklahoma,15140031.0
Vermont,503118.0
Carolina,388513.25
Alabama,19411022.0
Bayamón,533649.5
Arkansas,9003186.75
Toa Alta,18348.5
Trujillo Alto,49462.75
Canóvanas,34868.75
Cataño,42005.0
Guaynabo,246033.25
New Mexico,7401340.25
Toa Baja,90741.75
Hawaii,4968311.5
Hormigueros,14951.75
Arecibo,76651.0
Dorado,49875.25
Hatillo,6311.5
Cabo Rojo,167.0
Loíza,423.25
Moca,7.0
Query:
SELECT
      `state_name`,
      SUM(`yearly_sunlight_kwh_total`) AS total_energy_generation_potential
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
    GROUP BY `state_name`
    LIMIT 100;
Answer:
state_name,total_energy_generation_potential
Pennsylvania,38013732231.37533
District of Columbia,1195714591.0355346
Indiana,26851041383.544178
Texas,160039623751.7003
California,242638396940.61914
South Carolina,25650182524.803123
New Jersey,33904852397.54702
New York,44831446454.667114
Minnesota,18617438249.15694
Maryland,14360334548.562899
Alabama,24646969095.84594
Ohio,48048536615.67794
Michigan,40840033399.25273
Illinois,47047851222.0221
Colorado,24570049923.14742
Massachusetts,19399236401.382397
Maine,2189004685.1428585
Delaware,3213827406.3591805
Montana,2709785572.9772887
Arizona,59043009935.29779
Connecticut,12350145123.452477
Virginia,23113080773.399204
West Virginia,3257389195.7982974
Wisconsin,23486482672.124508
Missouri,26038971734.146763
Nebraska,6698087315.291833
Washington,27430232929.40039
Rhode Island,3701710212.1397314
New Hampshire,2550456273.8240113
Kentucky,14104070608.58099
Iowa,8830596479.387407
Wyoming,1300665963.824701
North Carolina,39519833527.209785
Kansas,11849160234.79061
Georgia,44581060812.03675
Florida,157617914915.22388
Oregon,16486992928.991993
Alaska,1089086633.2073154
Tennessee,30966907026.811638
Oklahoma,20183717271.261906
Utah,15209638303.221924
Ponce,384801553.74663687
South Dakota,1964549826.541555
Louisiana,25827876726.134453
Vermont,545353715.0415835
Arkansas,11336956069.406752
Guaynabo,342637380.99474514
San Juan,1195075494.0901492
North Dakota,2295970930.981845
Idaho,7504231760.321071
Nevada,17206349924.62255
Cataño,65981195.478601106
New Mexico,12187002098.50356
Mississippi,10378294594.571173
Toa Baja,131548735.53740233
Toa Alta,31279276.972485356
Bayamón,738592635.6176331
Trujillo Alto,68412270.15056156
Carolina,527251268.02654415
Aguadilla,159844295.74992672
Arecibo,123956987.1142212
Query:
SELECT
      `state_name`,
      SUM(`yearly_sunlight_kwh_total`) AS total_energy_generation_potential
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
    GROUP BY `state_name`
    LIMIT 100;
Answer:
state_name,total_energy_generation_potential
Pennsylvania,38210009215.75754
District of Columbia,1209717858.7960448
New York,45100394878.66945
Delaware,3222438352.7232127
Maryland,14399236326.491194
New Jersey,34132296027.41457
Virginia,23169044381.25025
Florida,157971622252.88815
Illinois,47344747566.823105
Indiana,26928123257.6459
Louisiana,25885642034.581646
Michigan,40976609871.52638
Minnesota,18673751434.616875
New Hampshire,2555251276.1719847
South Carolina,25692275291.339386
Texas,160458070556.08887
Arizona,59127893265.42813
California,243304846869.2122
Colorado,24667013678.519062
Iowa,8843145869.399498
Ohio,48300160986.35468
Mayagüez,202552659.3214233
Georgia,44737933517.874825
North Carolina,39607264848.00487
Tennessee,31169276299.068546
Wisconsin,23542559983.903282
Alaska,1092118868.9737976
Kansas,11882464352.00895
Maine,2197957054.0975833
Missouri,26123174340.937073
Nebraska,6725165429.18344
North Dakota,2299032486.1953635
West Virginia,3272165883.9079356
Connecticut,12438466928.172302
Kentucky,14048103923.893393
Massachusetts,19514148116.753475
Montana,2711943864.901141
South Dakota,1966083346.8824437
Utah,15249940379.663126
Washington,27475803851.394135
Idaho,7526956885.239661
Nevada,17236108170.27167
Rhode Island,3726814813.7138777
Wyoming,1302268164.537671
Ponce,385731295.9626892
Mississippi,10408673466.612555
Oregon,16514535968.386452
Aguadilla,160079112.7508179
San Juan,1177674698.064478
Oklahoma,20218586198.69937
Vermont,551942863.0689392
Carolina,553262399.3939756
Alabama,24759196398.254772
Bayamón,751085531.8753115
Arkansas,11362387314.959015
Toa Alta,25725431.5722229
Trujillo Alto,69008952.58372192
Canóvanas,49976173.37449949
Cataño,59578578.596868895
Guaynabo,342005084.6763793
New Mexico,12208818476.493706
Query:
SELECT
      `state_name`,
      SUM(`carbon_offset_metric_tons`) AS total_carbon_dioxide_offset
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
    GROUP BY `state_name`
    LIMIT 100;
Answer:
state_name,total_carbon_dioxide_offset
Pennsylvania,25546821.485438094
District of Columbia,759829.5491657512
Indiana,22222230.94097572
Texas,79820466.39724967
California,66878632.22406627
South Carolina,15057615.542086853
New Jersey,21299363.23969605
New York,21798509.308366332
Minnesota,9432736.431870202
Maryland,9317029.141011484
Alabama,15723425.934489224
Ohio,39776810.46321089
Michigan,32063411.389291123
Illinois,38776748.30638689
Colorado,14960304.146578386
Massachusetts,8399385.428188123
Maine,947591.4564713889
Delaware,2042260.7933182449
Montana,720554.5926224514
Arizona,25357559.299180172
Connecticut,5347366.443614537
Virginia,14534537.818791235
West Virginia,2696642.543676341
Wisconsin,18493486.254009772
Missouri,20922455.467775125
Nebraska,3393835.3477551313
Washington,7293347.1851032255
Rhode Island,1602800.1897457635
New Hampshire,1104316.148032614
Kentucky,10935523.832197243
Iowa,4474350.521690869
Wyoming,399141.771538283
North Carolina,23311951.926996794
Kansas,8225046.276933068
Georgia,26673519.941978425
Florida,84572912.49373847
Oregon,4384028.977048004
Alaska,448709.5001029907
Tennessee,23508638.576180194
Oklahoma,13653148.546175594
Utah,4044369.724602101
Ponce,258970.92094872275
South Dakota,1047147.0385288498
Louisiana,16083222.605670763
Vermont,236132.86981235375
Arkansas,7146339.221664684
Guaynabo,230594.49018257228
San Juan,804284.1778948522
North Dakota,1163339.1647784074
Idaho,1995437.8357183507
Nevada,6541464.54058874
Cataño,44405.25458387743
New Mexico,5184507.9049262395
Mississippi,6657377.043182844
Toa Baja,88532.11963429808
Toa Alta,21050.91074946186
Bayamón,497071.83661161206
Trujillo Alto,46041.3645230469
Carolina,354839.38441194326
Aguadilla,107574.99307295939
Arecibo,83422.88329775061
Hawaii,4657525.910539113
Canóvanas,38726.67058507054
Mayagüez,137284.59180836374
Hormigueros,13057.408935665711
Query:
SELECT
      `state_name`,
      SUM(`carbon_offset_metric_tons`) AS total_carbon_dioxide_offset
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
    GROUP BY `state_name`
    LIMIT 100;
Answer:
state_name,total_carbon_dioxide_offset
Pennsylvania,25679219.80437739
District of Columbia,768728.0745405233
New York,21932730.052032925
Delaware,2047732.7107329234
Maryland,9341908.182602106
New Jersey,21441825.25895088
Virginia,14570516.61273872
Florida,84762071.96637782
Illinois,39019478.60061409
Indiana,22286009.07525565
Louisiana,16119065.632724497
Michigan,32170938.264395673
Minnesota,9461269.60415691
New Hampshire,1106392.3375477034
South Carolina,15082325.953191793
Texas,80026572.096204
Arizona,25393752.120932516
California,67060256.55990341
Colorado,15019343.801609268
Iowa,4480709.137428613
Ohio,39985118.69480569
Mayagüez,136317.66351863468
Georgia,26767856.473523572
North Carolina,23363984.23961257
Tennessee,23662867.396383435
Wisconsin,18538719.21183869
Alaska,449958.7974072521
Kansas,8248164.194144529
Maine,951467.7454093616
Missouri,20988770.94279072
Nebraska,3407555.4824368763
North Dakota,1164890.4157271704
West Virginia,2708875.4834375717
Connecticut,5385610.01469212
Kentucky,10893849.027434945
Massachusetts,8448829.999860715
Montana,721128.5004524507
South Dakota,1047973.7956763804
Utah,4055086.3829833143
Washington,7305348.12157799
Idaho,2001480.6360385304
Nevada,6552267.614581585
Rhode Island,1613670.2387647687
Wyoming,399567.8100756294
Ponce,259596.63619231156
Mississippi,6675246.399348798
Oregon,4391352.901025001
Aguadilla,107733.02459435826
San Juan,792573.4658976336
Oklahoma,13676736.48241065
Vermont,238985.90700712064
Carolina,372344.8403529482
Alabama,15792877.15528394
Bayamón,505479.538757477
Arkansas,7162306.228122599
Toa Alta,17313.180368415116
Trujillo Alto,46442.93098691624
Canóvanas,33633.896532571576
Cataño,40096.302153202625
Guaynabo,230168.95562252367
New Mexico,5193766.818696549
Toa Baja,86581.46720940566
Hawaii,4666457.000837703
Hormigueros,14312.409783773297
Arecibo,74104.26841802277
Dorado,47475.16902867142
Query:
SELECT
      `state_name`,
      SUM(`count_qualified` - `existing_installs_count`) AS gap_in_potential_installations
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
    GROUP BY `state_name`
    LIMIT 100;
Answer:
state_name,gap_in_potential_installations
Pennsylvania,1950183
District of Columbia,75943
Indiana,1115426
Texas,5462650
California,8275950
South Carolina,906615
New Jersey,1617086
New York,2483797
Minnesota,767964
Maryland,699332
Alabama,812768
Ohio,2189269
Michigan,1844515
Illinois,2050075
Colorado,1007054
Massachusetts,985382
Maine,99600
Delaware,147343
Montana,118393
Arizona,1713835
Connecticut,602708
Virginia,960863
West Virginia,154789
Wisconsin,898115
Missouri,1028243
Nebraska,283121
Washington,1505113
Rhode Island,202494
New Hampshire,106750
Kentucky,576530
Iowa,349825
Wyoming,53039
North Carolina,1413133
Kansas,416381
Georgia,1500185
Florida,4708885
Oregon,763794
Alaska,57055
Tennessee,1101641
Oklahoma,700086
Utah,569369
Ponce,18706
South Dakota,72826
Louisiana,856210
Vermont,19373
Arkansas,369486
Guaynabo,12113
San Juan,44665
North Dakota,77093
Idaho,311142
Nevada,556366
Cataño,2860
New Mexico,361964
Mississippi,324511
Toa Baja,6976
Toa Alta,1123
Bayamón,33260
Trujillo Alto,2854
Carolina,19237
Aguadilla,5844
Arecibo,4433
Hawaii,178851
Canóvanas,2182
Mayagüez,7348
Hormigueros,1194
Dorado,3064
Corozal,15
Baja California,1
Moca,1
Query:
SELECT
      `state_name`,
      SUM(`count_qualified` - `existing_installs_count`) AS gap_in_potential_installations
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
    GROUP BY `state_name`
    LIMIT 100;
Answer:
state_name,gap_in_potential_installations
Pennsylvania,1951689
District of Columbia,76022
New York,2487240
Delaware,147447
Maryland,699742
New Jersey,1620118
Virginia,961383
Florida,4712507
Illinois,2053003
Indiana,1116012
Louisiana,856780
Michigan,1845535
Minnesota,768559
New Hampshire,106841
South Carolina,907128
Texas,5466434
Arizona,1714808
California,8286083
Colorado,1007705
Iowa,350036
Ohio,2192055
Mayagüez,7284
Georgia,1501780
North Carolina,1413932
Tennessee,1104151
Wisconsin,898793
Alaska,57086
Kansas,416595
Maine,99705
Missouri,1029240
Nebraska,283257
North Dakota,77105
West Virginia,154967
Connecticut,603585
Kentucky,575262
Massachusetts,986834
Montana,118421
South Dakota,72846
Utah,569989
Washington,1506055
Idaho,311349
Nevada,556715
Rhode Island,202796
Wyoming,53061
Ponce,18091
Mississippi,324739
Oregon,764477
Aguadilla,5852
San Juan,44341
Oklahoma,700478
Vermont,19399
Carolina,19688
Alabama,813666
Bayamón,33466
Arkansas,369777
Toa Alta,1345
Trujillo Alto,2873
Canóvanas,2099
Cataño,2764
Guaynabo,11603
New Mexico,362213
Toa Baja,6517
Hawaii,178998
Hormigueros,1264
Arecibo,3962
Dorado,3067
Hatillo,224
Cabo Rojo,2
Loíza,40
Moca,1
Query:
SELECT
      `region_name` AS postal_code,
      `state_name`,
      `count_qualified` AS buildings_available
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
    ORDER BY `count_qualified` DESC
    LIMIT 100;
Answer:
postal_code,state_name,buildings_available
79936,Texas,31973
77449,Texas,31637
77494,Texas,31622
32162,Florida,30403
75034,Texas,27743
77084,Texas,26876
77479,Texas,26867
78660,Texas,26231
77573,Texas,26002
77584,Texas,25423
73099,Oklahoma,24905
92345,California,24776
63376,Missouri,24104
75052,Texas,23925
77429,Texas,23882
92592,California,23608
92336,California,23471
94565,California,23381
78613,Texas,23374
93722,California,23281
37013,Tennessee,23261
78130,Texas,23003
85308,Arizona,22975
92503,California,22287
37042,Tennessee,22262
90650,California,22217
74012,Oklahoma,22160
76244,Texas,22142
95630,California,21939
60629,Illinois,21658
87114,New Mexico,21643
92683,California,21638
23464,Virginia,21557
99301,Washington,21553
87120,New Mexico,21382
77433,Texas,21269
45011,Ohio,21237
75002,Texas,21228
91710,California,21196
73160,Oklahoma,21133
87121,New Mexico,21091
93065,California,21028
94558,California,20962
93274,California,20943
87105,New Mexico,20879
85032,Arizona,20823
77379,Texas,20693
83709,Idaho,20639
28269,North Carolina,20639
78521,Texas,20611
78245,Texas,20592
93307,California,20571
77450,Texas,20536
95747,California,20506
95624,California,20449
85142,Arizona,20431
30906,Georgia,20356
87124,New Mexico,20329
85225,Arizona,20288
85364,Arizona,20162
93230,California,20141
66062,Kansas,20120
77845,Texas,20082
Query:
SELECT
      `region_name` AS census_tract,
      `state_name`,
      `yearly_sunlight_kwh_total` AS energy_generation_potential
    FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
    ORDER BY `yearly_sunlight_kwh_total` DESC
    LIMIT 100;
Answer:
census_tract,state_name,energy_generation_potential
47157022600,Tennessee,824835336.382654
06071012700,California,672633880.6769227
49035114500,Utah,646815810.9101747
12119911200,Florida,612472661.2934877
48113010000,Texas,596378778.0511045
48157673101,Texas,515412281.1148439
32031003101,Nevada,511767546.9111937
12086009010,Florida,509790663.9146789
06037532400,California,494440288.77725846
06001441503,California,494428190.00062877
06059075515,California,460455954.2349241
13121010303,Georgia,437384016.95564574
53033029206,Washington,415369613.41289943
06107001003,California,401439786.70664066
12095017103,Florida,394718229.3980347
12086009100,Florida,389068991.7813536
06001437101,California,383833595.86531395
13051010700,Georgia,347668706.0473267
06071002110,California,345228265.38629764
12115002712,Florida,343766645.7025698
34023008502,New Jersey,340096252.8597841
06037408202,California,336447383.25806886
06071000504,California,335910081.93043214
06085505006,California,334944852.1465209
34023008900,New Jersey,334336354.7164731
06037543305,California,333712284.70682347
06071002204,California,332907476.2624328
48329010114,Texas,332146690.99438506
04013112512,Arizona,331902060.7204588
26163558300,Michigan,323275191.8054076
06073008511,California,319731157.1123412
12111382108,Florida,314462540.85859376
29095015500,Missouri,310765274.00772125
48113018506,Texas,306231533.58079815
17197880202,Illinois,306153332.4264712
39017011123,Ohio,302443549.49872124
04013216816,Arizona,301257244.01858544
06077003803,California,293563857.67392576
06073008350,California,290592934.93217754
31055007409,Nebraska,289847584.6571406
48039660602,Texas,287282457.24771124
29189213102,Missouri,287187871.59714353
29047022100,Missouri,286575658.50643927
22051024202,Louisiana,285289860.9176331
48201540100,Texas,284763524.03508955
12095017104,Florida,281938241.19138205
13121007805,Georgia,278343462.3308834
End Exploring Related Columns
Task: Can you provide a detailed comparison of the solar potential for each state, distinguishing between postal code and census tract levels? Include the number of buildings available for solar installations, the percentage covered by Project Sunroof, the percentage suitable for solar, total potential panel count, total kilowatt capacity, energy generation potential, carbon dioxide offset, and the gap in potential installations.

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
State_Name,Level,Number_of_Buildings_Available,Percentage_Covered_by_Sunroof,Percentage_Suitable_for_Solar,Total_Potential_Panel_Count,Total_Kilowatt_Capacity,Energy_Generation_Potential,Carbon_Dioxide_Offset,Gap_in_Potential_Installations
state1:str,Postal_Code,num_buildings:int,percent_covered:0<=float<=100,percent_suitable:0<=float<=100,total_panels:int,kw_capacity:float,energy_potential:float,co2_offset:float,installation_gap:int
state1:str,Census_Tract,num_buildings:int,percent_covered:0<=float<=100,percent_suitable:0<=float<=100,total_panels:int,kw_capacity:float,energy_potential:float,co2_offset:float,installation_gap:int
state2:str,Postal_Code,num_buildings:int,percent_covered:0<=float<=100,percent_suitable:0<=float<=100,total_panels:int,kw_capacity:float,energy_potential:float,co2_offset:float,installation_gap:int
state2:str,Census_Tract,num_buildings:int,percent_covered:0<=float<=100,percent_suitable:0<=float<=100,total_panels:int,kw_capacity:float,energy_potential:float,co2_offset:float,installation_gap:int
...
```

**Explanation:**

The table above provides a detailed comparison of the solar potential for each state, distinguishing between postal code and census tract levels. The columns include:

- **State_Name**: The name of the state.
- **Level**: The data aggregation level (`Postal_Code` or `Census_Tract`).
- **Number_of_Buildings_Available**: Number of buildings available for solar installations (`int`).
- **Percentage_Covered_by_Sunroof**: Percentage of buildings covered by Project Sunroof (`float` between 0 and 100).
- **Percentage_Suitable_for_Solar**: Percentage of buildings suitable for solar installations (`float` between 0 and 100).
- **Total_Potential_Panel_Count**: Total potential number of solar panels (`int`).
- **Total_Kilowatt_Capacity**: Total potential kilowatt capacity (`float`).
- **Energy_Generation_Potential**: Potential energy generation (`float`).
- **Carbon_Dioxide_Offset**: Potential carbon dioxide offset (`float`).
- **Gap_in_Potential_Installations**: Difference between the potential installations and existing installations (`int`).

Each state is listed twice to compare the data at the postal code level and the census tract level. This comparison highlights differences in solar potential assessments based on the granularity of the data. The `Gap_in_Potential_Installations` represents the untapped opportunity for solar installations in each state..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'sunroof_solar': ['solar_potential_by_censustract', 'solar_potential_by_postal_code']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-24 23:40:53 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 23:40:53 - root - INFO - ```sql
SELECT
  state_name AS State_Name,
  Level,
  SUM(count_qualified) AS Number_of_Buildings_Available,
  AVG(percent_covered) AS Percentage_Covered_by_Sunroof,
  AVG(percent_qualified) AS Percentage_Suitable_for_Solar,
  SUM(number_of_panels_total) AS Total_Potential_Panel_Count,
  SUM(kw_total) AS Total_Kilowatt_Capacity,
  SUM(yearly_sunlight_kwh_total) AS Energy_Generation_Potential,
  SUM(carbon_offset_metric_tons) AS Carbon_Dioxide_Offset,
  SUM(count_qualified - existing_installs_count) AS Gap_in_Potential_Installations
FROM (
  SELECT 
    `state_name`,
    'Postal_Code' AS Level,
    `count_qualified`,
    `percent_covered`,
    `percent_qualified`,
    `number_of_panels_total`,
    `kw_total`,
    `yearly_sunlight_kwh_total`,
    `carbon_offset_metric_tons`,
    `existing_installs_count`
  FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
  UNION ALL
  SELECT 
    `state_name`,
    'Census_Tract' AS Level,
    `count_qualified`,
    `percent_covered`,
    `percent_qualified`,
    `number_of_panels_total`,
    `kw_total`,
    `yearly_sunlight_kwh_total`,
    `carbon_offset_metric_tons`,
    `existing_installs_count`
  FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
) AS combined_data
GROUP BY state_name, Level
ORDER BY state_name, Level;
```
2025-01-24 23:40:55 - root - INFO - itercount: 1
2025-01-24 23:40:55 - root - INFO - 0
2025-01-24 23:40:55 - root - INFO - results: 
State_Name,Level,Number_of_Buildings_Available,Percentage_Covered_by_Sunroof,Percentage_Suitable_for_Solar,Total_Potential_Panel_Count,Total_Kilowatt_Capacity,Energy_Generation_Potential,Carbon_Dioxide_Offset,Gap_in_Potential_Installations
Aguadilla,Census_Tract,5852,95.93904539313897,89.84303986917155,432711,108177.75,160079112.7508179,107733.02459435826,5852
Aguadilla,Postal_Code,5844,93.15526870442538,94.31143379125443,432049,108012.25,159844295.74992672,107574.99307295939,5844
Alabama,Census_Tract,814213,118.15181543509544,75.70646896201119,77644088,19411022.0,24759196398.254772,15792877.15528394,813666
Alabama,Postal_Code,813312,65.3636415604924,81.8829916901213,77298546,19324636.5,24646969095.84594,15723425.934489224,812768
Alaska,Census_Tract,57169,83.13432918928937,67.38914863482441,5462549,1365637.25,1092118868.9737976,449958.7974072521,57086
Alaska,Postal_Code,57138,88.96629632261681,78.00984454758942,5447225,1361806.25,1089086633.2073154,448709.5001029907,57055
Arecibo,Census_Tract,3962,239.55162200350406,94.19097896614889,306604,76651.0,110110577.36539915,74104.26841802277,3962
Arecibo,Postal_Code,4433,77.87529184298847,93.40742399641678,345214,86303.5,123956987.1142212,83422.88329775061,4433
Arizona,Census_Tract,1754534,109.64577014936981,90.40516782276121,147450436,36862609.0,59127893265.42813,25393752.120932516,1714808
Arizona,Postal_Code,1753531,87.4686382928109,93.81479777093914,147238408,36809602.0,59043009935.29779,25357559.299180172,1713835
Arkansas,Census_Tract,370016,94.08798696727425,73.57608276947256,36012747,9003186.75,11362387314.959015,7162306.228122599,369777
Arkansas,Postal_Code,369725,64.03184484226828,80.53295880502694,35933867,8983466.75,11336956069.406752,7146339.221664684,369486
Baja California,Postal_Code,1,0.06743088334457181,20.0,23,5.75,8322.02979736328,0.0,1
Bayamón,Census_Tract,33466,98.86868696240633,90.54093297303565,2134598,533649.5,751085531.8753115,505479.538757477,33466
Bayamón,Postal_Code,33260,97.36410651881141,91.28405960797262,2098880,524720.0,738592635.6176331,497071.83661161206,33260
Cabo Rojo,Census_Tract,2,5.0,100.0,668,167.0,236279.58453979492,159.01583819991797,2
California,Census_Tract,8617901,93.22199775185501,84.42610938177233,654784266,163696066.5,243304846869.2122,67060256.55990341,8286083
California,Postal_Code,8607224,89.7807005015948,88.41052498683767,652983168,163245792.0,242638396940.61914,66878632.22406627,8275950
Canóvanas,Census_Tract,2099,111.11231184290489,82.97908947936548,139475,34868.75,49976173.37449949,33633.896532571576,2099
Canóvanas,Postal_Code,2182,66.34040239260467,89.42622950819673,160471,40117.75,57543460.70198363,38726.67058507054,2182
Carolina,Census_Tract,19688,118.61155203088134,91.95012311270571,1554053,388513.25,553262399.3939756,372344.8403529482,19688
Carolina,Postal_Code,19237,88.9530773741177,93.41220105410267,1481427,370356.75,527251268.02654415,354839.38441194326,19237
Cataño,Census_Tract,2764,1977.1135751398197,86.57358974659549,168020,42005.0,59578578.596868895,40096.302153202625,2764
Cataño,Postal_Code,2860,95.55259585846524,91.19644888529244,186311,46577.75,65981195.478601106,44405.25458387743,2860
Colorado,Census_Tract,1032067,90.80594676965516,80.5215995892791,69425443,17356360.75,24667013678.519062,15019343.801609268,1007705
Colorado,Postal_Code,1031389,81.12936471319748,83.07765032579091,69150828,17287707.0,24570049923.14742,14960304.146578386,1007054
Connecticut,Census_Tract,608869,87.30600764926562,65.75337434981019,43575214,10893803.5,12438466928.172302,5385610.01469212,603585
Connecticut,Postal_Code,607976,77.1032770026374,72.29881131803256,43269892,10817473.0,12350145123.452477,5347366.443614537,602708
Corozal,Postal_Code,15,1.2121212121212122,93.75,1667,416.75,587979.9845764162,395.7097278391667,15
Delaware,Census_Tract,147535,85.27792503329303,71.13500821025058,10771425,2692856.25,3222438352.7232127,2047732.7107329234,147447
Delaware,Postal_Code,147431,77.33200952927507,79.8784853981143,10742839,2685709.75,3213827406.3591805,2042260.7933182449,147343
District of Columbia,Census_Tract,76464,85.31731546190417,63.397058540850374,3983844,995961.0,1209717858.7960448,768728.0745405233,76022
District of Columbia,Postal_Code,76385,81.96327798463948,75.11488176242612,3937623,984405.75,1195714591.0355346,759829.5491657512,75943
Dorado,Census_Tract,3067,133.84216326057313,94.55205024605395,199501,49875.25,70542741.78618774,47475.16902867142,3067
Dorado,Postal_Code,3064,78.27859026612323,93.84379785604901,199254,49813.5,70454673.23659058,47415.8990148845,3064
Florida,Census_Tract,4817871,99.634633695383,83.27936582037205,463123814,115780953.5,157971622252.88815,84762071.96637782,4712507
Florida,Postal_Code,4814177,82.98495071423179,90.85016886522152,462105732,115526433.0,157617914915.22388,84572912.49373847,4708885
Georgia,Census_Tract,1503687,96.5545833414853,68.6019145687061,140138439,35034609.75,44737933517.874825,26767856.473523572,1501780
Georgia,Postal_Code,1502091,72.02704651939652,76.48404856671777,139653741,34913435.25,44581060812.03675,26673519.941978425,1500185
Guaynabo,Census_Tract,11603,111.26805227548675,89.77135936863131,984133,246033.25,342005084.6763793,230168.95562252367,11603
Guaynabo,Postal_Code,12113,96.69070837371878,88.43952681035891,986943,246735.75,342637380.99474514,230594.49018257228,12113
Hatillo,Census_Tract,224,38.851761427901465,91.4722740602506,25246,6311.5,9067192.223126221,6102.208001967081,224
Hawaii,Census_Tract,204390,92.40890122239375,90.28828623458985,19873246,4968311.5,7415195492.545843,4666457.000837703,178998
Hawaii,Postal_Code,204227,85.77323256083754,94.93133340007105,19835765,4958941.25,7400954705.80918,4657525.910539113,178851
Hormigueros,Census_Tract,1264,72.03823210284625,91.17801424826256,59807,14951.75,21266625.23529052,14312.409783773297,1264
Hormigueros,Postal_Code,1194,58.690744920993225,91.84615384615384,54608,13652.0,19401835.649896257,13057.408935665711,1194
Idaho,Census_Tract,311878,84.46661050804313,75.9107679289549,23093899,5773474.75,7526956885.239661,2001480.6360385304,311349
Idaho,Postal_Code,311671,77.44616743720586,85.81752126830315,23026001,5756500.25,7504231760.321071,1995437.8357183507,311142
Illinois,Census_Tract,2055456,91.65385121185525,75.07039880322085,164256874,41064218.5,47344747566.823105,39019478.60061409,2053003
Illinois,Postal_Code,2052522,81.52174935109402,81.22551550568922,163236997,40809249.25,47047851222.0221,38776748.30638689,2050075
Indiana,Census_Tract,1117000,102.8845689736421,74.41629924942166,93311273,23327818.25,26928123257.6459,22286009.07525565,1116012
Indiana,Postal_Code,1116413,72.70729951623908,80.98704273615948,93048465,23262116.25,26851041383.544178,22222230.94097572,1115426
Iowa,Census_Tract,350284,92.502375228341,67.55135102465918,29953011,7488252.75,8843145869.399498,4480709.137428613,350036
Iowa,Postal_Code,350073,72.26174249883248,78.45999338382977,29910958,7477739.5,8830596479.387407,4474350.521690869,349825
Kansas,Census_Tract,417333,89.95113875826723,74.4583819109252,36827430,9206857.5,11882464352.00895,8248164.194144529,416595
Kansas,Postal_Code,417118,78.0015186723769,83.90980882904063,36723960,9180990.0,11849160234.79061,8225046.276933068,416381
Kentucky,Census_Tract,575985,94.62267354085361,80.79952498243406,47393349,11848337.25,14048103923.893393,10893849.027434945,575262
Kentucky,Postal_Code,577255,75.34738154677154,86.8544077014831,47570216,11892554.0,14104070608.58099,10935523.832197243,576530
Louisiana,Census_Tract,865003,113.44943038082391,82.17435382731465,80308875,20077218.75,25885642034.581646,16119065.632724497,856780
Louisiana,Postal_Code,864431,74.02401966050749,85.77600943642521,80134650,20033662.5,25827876726.134453,16083222.605670763,856210
Loíza,Census_Tract,40,85.48387096774194,75.47169811320755,1693,423.25,595043.1626098631,400.46323702419204,40
Maine,Census_Tract,100065,85.2430142664818,65.17547802899195,7720530,1930132.5,2197957054.0975833,951467.7454093616,99705
Maine,Postal_Code,99960,63.10106887979922,63.636668811497685,7689271,1922317.75,2189004685.1428585,947591.4564713889,99600
Maryland,Census_Tract,705813,80.03630516726585,69.81305560602681,47690643,11922660.75,14399236326.491194,9341908.182602106,699742
Maryland,Postal_Code,705396,71.16030669975413,78.21436738373333,47560886,11890221.5,14360334548.562899,9317029.141011484,699332
Massachusetts,Census_Tract,1002203,87.21982464135503,72.28938390680631,69012277,17253069.25,19514148116.753475,8448829.999860715,986834
Massachusetts,Postal_Code,1000732,81.69850341980238,73.94909266069014,68609324,17152331.0,19399236401.382397,8399385.428188123,985382
Mayagüez,Census_Tract,7284,129.17712026429936,88.31524322675783,567212,141803.0,202552659.3214233,136317.66351863468,7284
Mayagüez,Postal_Code,7348,93.56904274340901,91.3667202708606,571212,142803.0,203989405.60508427,137284.59180836374,7348
Michigan,Census_Tract,1847255,96.31663324257916,72.87447311567942,147876313,36969078.25,40976609871.52638,32170938.264395673,1845535
Michigan,Postal_Code,1846232,76.11109096649122,79.04143589637181,147391827,36847956.75,40840033399.25273,32063411.389291123,1844515
Minnesota,Census_Tract,770077,90.42832750511005,64.55495274901152,65662303,16415575.75,18673751434.616875,9461269.60415691,768559
Minnesota,Postal_Code,769481,83.07005491274445,72.02677785988111,65464154,16366038.5,18617438249.15694,9432736.431870202,767964
Mississippi,Census_Tract,325095,110.38685412641182,70.47452389375442,32218920,8054730.0,10408673466.612555,6675246.399348798,324739
Mississippi,Postal_Code,324867,72.63111176104802,82.19166818603287,32127017,8031754.25,10378294594.571173,6657377.043182844,324511
Missouri,Census_Tract,1032104,89.17689216788044,76.33668998450831,84085928,21021482.0,26123174340.937073,20988770.94279072,1029240
Missouri,Postal_Code,1031097,80.34422515005369,82.55774214780112,83816328,20954082.0,26038971734.146763,20922455.467775125,1028243
Moca,Census_Tract,1,0.8264462809917356,100.0,28,7.0,8580.857080078125,5.774905113871622,1
Moca,Postal_Code,1,0.36900369003690037,100.0,28,7.0,8580.857080078125,5.774905113871622,1
Montana,Census_Tract,118683,80.417314727058,72.2771405120219,9189162,2297290.5,2711943864.901141,721128.5004524507,118421
Montana,Postal_Code,118654,69.92868695582882,74.89138821125226,9181610,2295402.5,2709785572.9772887,720554.5926224514,118393
Nebraska,Census_Tract,283467,93.4175734888357,80.62010526352873,21582607,5395651.75,6725165429.18344,3407555.4824368763,283257
Nebraska,Postal_Code,283330,80.37294823445419,86.88101043865281,21495882,5373970.5,6698087315.291833,3393835.3477551313,283121
Nevada,Census_Tract,569461,98.16257499733604,90.79523059001973,43616656,10904164.0,17236108170.27167,6552267.614581585,556715
Nevada,Postal_Code,569104,80.35806150420439,92.41557021018673,43540016,10885004.0,17206349924.62255,6541464.54058874,556366
New Hampshire,Census_Tract,107103,82.68678043934635,67.94157124181982,9054358,2263589.5,2555251276.1719847,1106392.3375477034,106841
New Hampshire,Postal_Code,107012,50.142312161287336,68.14373199300623,9037409,2259352.25,2550456273.8240113,1104316.148032614,106750
New Jersey,Census_Tract,1632773,124.22007839679846,72.49284036555359,117024321,29256080.25,34132296027.41457,21441825.25895088,1620118
New Jersey,Postal_Code,1629714,88.22893832760151,76.2982184524033,116249897,29062474.25,33904852397.54702,21299363.23969605,1617086
New Mexico,Census_Tract,365962,90.19310294856486,87.26558195086373,29605361,7401340.25,12208818476.493706,5193766.818696549,362213
New Mexico,Postal_Code,365713,73.56221925571539,90.66469204457194,29552308,7388077.0,12187002098.50356,5184507.9049262395,361964
New York,Census_Tract,2506035,87.0165466642333,70.38240073336407,158794563,39698640.75,45100394878.66945,21932730.052032925,2487240
New York,Postal_Code,2502541,85.2767396257726,77.40818366695972,157857812,39464453.0,44831446454.667114,21798509.308366332,2483797
North Carolina,Census_Tract,1416843,111.00378212601835,68.1827711551925,124233257,31058314.25,39607264848.00487,23363984.23961257,1413932
North Carolina,Postal_Code,1416043,63.19407091476492,76.83151102623702,123962977,30990744.25,39519833527.209785,23311951.926996794,1413133
North Dakota,Census_Tract,77129,88.55661024596186,75.36655521628283,8138951,2034737.75,2299032486.1953635,1164890.4157271704,77105
North Dakota,Postal_Code,77117,78.53210718919708,80.68802648949996,8128226,2032056.5,2295970930.981845,1163339.1647784074,77093
Ohio,Census_Tract,2194900,100.1957983798896,76.22748275975313,171901350,42975337.5,48300160986.35468,39985118.69480569,2192055
Ohio,Postal_Code,2192109,79.33516702608132,82.3972375933493,171022353,42755588.25,48048536615.67794,39776810.46321089,2189269
Oklahoma,Census_Tract,701280,90.58936275851076,87.7429909469715,60560124,15140031.0,20218586198.69937,13676736.48241065,700478
Oklahoma,Postal_Code,700888,76.98000635053326,90.68830861474277,60455902,15113975.5,20183717271.261906,13653148.546175594,700086
Oregon,Census_Tract,773130,92.07550262671668,79.6266440199705,61617355,15404338.75,16514535968.386452,4391352.901025001,764477
Oregon,Postal_Code,772441,76.67033698320564,85.56283254708079,61510848,15377712.0,16486992928.991993,4384028.977048004,763794
Pennsylvania,Census_Tract,1956097,92.68306466974028,68.85707992410279,133691622,33422905.5,38210009215.75754,25679219.80437739,1951689
Pennsylvania,Postal_Code,1954585,79.069678971782,79.50152162654115,133004637,33251159.25,38013732231.37533,25546821.485438094,1950183
Ponce,Census_Tract,18091,91.56236721318227,89.9396040617879,1165041,291260.25,385731295.9626892,259596.63619231156,18091
Ponce,Postal_Code,18706,87.8721771073327,91.44872619683593,1162806,290701.5,384801553.74663687,258970.92094872275,18706
Rhode Island,Census_Tract,203167,91.74013630607044,75.69773905575144,13001474,3250368.5,3726814813.7138777,1613670.2387647687,202796
Rhode Island,Postal_Code,202865,83.84201456517948,75.47806245993256,12914100,3228525.0,3701710212.1397314,1602800.1897457635,202494
San Juan,Census_Tract,44341,361.1600438845386,90.20467196383028,3375014,843753.5,1177674698.064478,792573.4658976336,44341
San Juan,Postal_Code,44665,98.24550518972346,91.33009202920344,3423143,855785.75,1195075494.0901492,804284.1778948522,44665
South Carolina,Census_Tract,908394,95.4739597522511,73.39684628969712,79312131,19828032.75,25692275291.339386,15082325.953191793,907128
South Carolina,Postal_Code,907878,68.2990652629294,80.08563002130778,79183940,19795985.0,25650182524.803123,15057615.542086853,906615
South Dakota,Census_Tract,72867,82.78193284825556,73.13011785666349,6377373,1594343.25,1966083346.8824437,1047973.7956763804,72846
South Dakota,Postal_Code,72847,52.45083205685707,76.16484077656689,6372371,1593092.75,1964549826.541555,1047147.0385288498,72826
Tennessee,Census_Tract,1105463,96.22961807019115,76.2726721379218,101762224,25440556.0,31169276299.068546,23662867.396383435,1104151
Tennessee,Postal_Code,1102947,74.46006733391977,83.65948527656549,101108289,25277072.25,30966907026.811638,23508638.576180194,1101641
Texas,Census_Tract,5480573,89.86343251034099,83.60340471279216,481747719,120436929.75,160458070556.08887,80026572.096204,5466434
Texas,Postal_Code,5476777,81.35349870837823,89.34929795432048,480505530,120126382.5,160039623751.7003,79820466.39724967,5462650
Toa Alta,Census_Tract,1345,1710.7408116079805,87.95785274938672,73394,18348.5,25725431.5722229,17313.180368415116,1345
Toa Alta,Postal_Code,1123,83.18994043679682,89.33969769291966,88675,22168.75,31279276.972485356,21050.91074946186,1123
Toa Baja,Census_Tract,6517,108.024984187698,90.59109586594275,362967,90741.75,128650286.23981933,86581.46720940566,6517
Toa Baja,Postal_Code,6976,96.83583571162676,89.3900563813429,371052,92763.0,131548735.53740233,88532.11963429808,6976
Trujillo Alto,Census_Tract,2873,2040.5624934431326,86.22386755943712,197851,49462.75,69008952.58372192,46442.93098691624,2873
Trujillo Alto,Postal_Code,2854,93.46999728482216,88.81837244579282,196126,49031.5,68412270.15056156,46041.3645230469,2854
Utah,Census_Tract,573155,93.1267398386917,84.22705043917746,44105531,11026382.75,15249940379.663126,4055086.3829833143,569989
Utah,Postal_Code,572530,76.16223561464697,85.93581601402279,43988756,10997189.0,15209638303.221924,4044369.724602101,569369
Vermont,Census_Tract,19530,102.79805757806196,68.89857488088953,2012472,503118.0,551942863.0689392,238985.90700712064,19399
Vermont,Postal_Code,19504,79.35918973288328,79.59947754095191,1988764,497191.0,545353715.0415835,236132.86981235375,19373
Virginia,Census_Tract,963792,90.9867152039755,70.2980366020228,74914378,18728594.5,23169044381.25025,14570516.61273872,961383
Virginia,Postal_Code,963270,70.44108422452726,77.44664178774819,74735305,18683826.25,23113080773.399204,14534537.818791235,960863
Washington,Census_Tract,1511814,102.21900785046982,74.39266638906405,107938035,26984508.75,27475803851.394135,7305348.12157799,1506055
Washington,Postal_Code,1510869,83.21639552127758,84.03996306007771,107756625,26939156.25,27430232929.40039,7293347.1851032255,1505113
West Virginia,Census_Tract,155047,134.70406557147317,71.81141828837345,11387665,2846916.25,3272165883.9079356,2708875.4834375717,154967
West Virginia,Postal_Code,154869,66.83908549978548,82.71154300892734,11336559,2834139.75,3257389195.7982974,2696642.543676341,154789
Wisconsin,Census_Tract,900707,93.19365253852426,74.55363214741567,82459475,20614868.75,23542559983.903282,18538719.21183869,898793
Wisconsin,Postal_Code,900028,78.21393285262626,80.06679188975764,82263947,20565986.75,23486482672.124508,18493486.254009772,898115
Wyoming,Census_Tract,53090,75.88811972405551,78.68145154613299,3848056,962014.0,1302268164.537671,399567.8100756294,53061
Wyoming,Postal_Code,53068,78.96861340065534,78.76528710918183,3843267,960816.75,1300665963.824701,399141.771538283,53039


2025-01-24 23:40:55 - root - INFO - Please check the answer again by reviewing Can you provide a detailed comparison of the solar potential for each state, distinguishing between postal code and census tract levels? Include the number of buildings available for solar installations, the percentage covered by Project Sunroof, the percentage suitable for solar, total potential panel count, total kilowatt capacity, energy generation potential, carbon dioxide offset, and the gap in potential installations., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
State_Name,Level,Number_of_Buildings_Available,Percentage_Covered_by_Sunroof,Percentage_Suitable_for_Solar,Total_Potential_Panel_Count,Total_Kilowatt_Capacity,Energy_Generation_Potential,Carbon_Dioxide_Offset,Gap_in_Potential_Installations
state1:str,Postal_Code,num_buildings:int,percent_covered:0<=float<=100,percent_suitable:0<=float<=100,total_panels:int,kw_capacity:float,energy_potential:float,co2_offset:float,installation_gap:int
state1:str,Census_Tract,num_buildings:int,percent_covered:0<=float<=100,percent_suitable:0<=float<=100,total_panels:int,kw_capacity:float,energy_potential:float,co2_offset:float,installation_gap:int
state2:str,Postal_Code,num_buildings:int,percent_covered:0<=float<=100,percent_suitable:0<=float<=100,total_panels:int,kw_capacity:float,energy_potential:float,co2_offset:float,installation_gap:int
state2:str,Census_Tract,num_buildings:int,percent_covered:0<=float<=100,percent_suitable:0<=float<=100,total_panels:int,kw_capacity:float,energy_potential:float,co2_offset:float,installation_gap:int
...
```

**Explanation:**

The table above provides a detailed comparison of the solar potential for each state, distinguishing between postal code and census tract levels. The columns include:

- **State_Name**: The name of the state.
- **Level**: The data aggregation level (`Postal_Code` or `Census_Tract`).
- **Number_of_Buildings_Available**: Number of buildings available for solar installations (`int`).
- **Percentage_Covered_by_Sunroof**: Percentage of buildings covered by Project Sunroof (`float` between 0 and 100).
- **Percentage_Suitable_for_Solar**: Percentage of buildings suitable for solar installations (`float` between 0 and 100).
- **Total_Potential_Panel_Count**: Total potential number of solar panels (`int`).
- **Total_Kilowatt_Capacity**: Total potential kilowatt capacity (`float`).
- **Energy_Generation_Potential**: Potential energy generation (`float`).
- **Carbon_Dioxide_Offset**: Potential carbon dioxide offset (`float`).
- **Gap_in_Potential_Installations**: Difference between the potential installations and existing installations (`int`).

Each state is listed twice to compare the data at the postal code level and the census tract level. This comparison highlights differences in solar potential assessments based on the granularity of the data. The `Gap_in_Potential_Installations` represents the untapped opportunity for solar installations in each state. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Too long, hard cut:
State_Name,Level,Number_of_Buildings_Available,Percentage_Covered_by_Sunroof,Percentage_Suitable_for_Solar,Total_Potential_Panel_Count,Total_Kilowatt_Capacity,Energy_Generation_Potential,Carbon_Dioxide_Offset,Gap_in_Potential_Installations
Aguadilla,Census_Tract,5852,95.93904539313897,89.84303986917155,432711,108177.75,160079112.7508179,107733.02459435826,5852
Aguadilla,Postal_Code,5844,93.15526870442538,94.31143379125443,432049,108012.25,159844295.74992672,107574.99307295939,5844
Alabama,Census_Tract,814213,118.15181543509544,75.70646896201119,77644088,19411022.0,24759196398.254772,15792877.15528394,813666
Alabama,Postal_Code,813312,65.3636415604924,81.8829916901213,77298546,19324636.5,24646969095.84594,15723425.934489224,812768
Alaska,Census_Tract,57169,83.13432918928937,67.38914863482441,5462549,1365637.25,1092118868.9737976,449958.7974072521,57086
Alaska,Postal_Code,57138,88.96629632261681,78.00984454758942,5447225,1361806.25,1089086633.2073154,448709.5001029907,57055
Arecibo,Census_Tract,3962,239.55162200350406,94.19097896614889,306604,76651.0,110110577.36539915,74104.26841802277,3962
Arecibo,Postal_Code,4433,77.87529184298847,93.40742399641678,345214,86303.5,123956987.1142212,83422.88329775061,4433
Arizona,Census_Tract,1754534,109.64577014936981,90.40516782276121,147450436,36862609.0,59127893265.42813,25393752.120932516,1714808
Arizona,Postal_Code,1753531,87.4686382928109,93.81479777093914,147238408,36809602.0,59043009935.29779,25357559.299180172,1713835
Arkansas,Census_Tract,370016,94.08798696727425,73.57608276947256,36012747,9003186.75,11362387314.959015,7162306.228122599,369777
Arkansas,Postal_Code,369725,64.03184484226828,80.53295880502694,35933867,8983466.75,11336956069.406752,7146339.221664684,369486
Baja California,Postal_Code,1,0.06743088334457181,20.0,23,5.75,8322.02979736328,0.0,1
Bayamón,Census_Tract,33466,98.86868696240633,90.54093297303565,2134598,533649.5,751085531.8753115,505479.538757477,33466
Bayamón,Postal_Code,33260,97.36410651881141,91.28405960797262,2098880,524720.0,738592635.6176331,497071.83661161206,33260
Cabo Rojo,Census_Tract,2,5.0,100.0,668,167.0,236279.58453979492,159.01583819991797,2
California,Census_Tract,8617901,93.22199775185501,84.42610938177233,654784266,163696066.5,243304846869.2122,67060256.55990341,8286083
California,Postal_Code,8607224,89.7807005015948,88.41052498683767,652983168,163245792.0,242638396940.61914,66878632.22406627,8275950
Canóvanas,Census_Tract,2099,111.11231184290489,82.97908947936548,139475,34868.75,49976173.37449949,33633.896532571576,2099
Canóvanas,Postal_Code,2182,66.34040239260467,89.42622950819673,160471,40117.75,57543460.70198363,38726.67058507054,2182
Carolina,Census_Tract,19688,118.61155203088134,91.95012311270571,1554053,388513.25,553262399.3939756,372344.8403529482,19688
Carolina,Postal_Code,19237,88.9530773741177,93.41220105410267,1481427,370356.75,527251268.02654415,354839.38441194326,19237
Cataño,Census_Tract,2764,1977.1135751398197,86.57358974659549,168020,42005.0,59578578.596868895,40096.302153202625,2764
Cataño,Postal_Code,2860,95.55259585846524,91.19644888529244,186311,46577.75,65981195.478601106,44405.25458387743,2860
Colorado,Census_Tract,1032067,90.80594676965516,80.5215995892791,69425443,17356360.75,24667013678.519062,15019343.801609268,1007705
Colorado,Postal_Code,1031389,81.12936471319748,83.07765032579091,69150828,17287707.0,24570049923.14742,14960304.146578386,1007054
Connecticut,Census_Tract,608869,87.30600764926562,65.75337434981019,43575214,10893803.5,12438466928.172302,5385610.01469212,603585
Connecticut,Postal_Code,607976,77.1032770026374,72.29881131803256,43269892,10817473.0,12350145123.452477,5347366.443614537,602708
Corozal,Postal_Code,15,1.2121212121212122,93.75,1667,416.75,587979.9845764162,395.7097278391667,15
Delaware,Census_Tract,147535,85.27792503329303,71.13500821025058,10771425,2692856.25,3222438352.7232127,2047732.7107329234,147447
Delaware,Postal_Code,147431,77.33200952927507,79.8784853981143,10742839,2685709.75,3213827406.3591805,2042260.7933182449,147343
District of Columbia,Census_Tract,76464,85.31731546190417,63.397058540850374,3983844,995961.0,1209717858.7960448,768728.0745405233,76022
District of Columbia,Postal_Code,76385,81.96327798463948,75.11488176242612,3937623,984405.75,1195714591.0355346,759829.5491657512,75943
Dorado,Census_Tract,3067,133.84216326057313,94.55205024605395,199501,49875.25,70542741.78618774,47475.16902867142,3067
Dorado,Postal_Code,3064,78.27859026612323,93.84379785604901,199254,49813.5,70454673.23659058,47415.8990148845,3064
Florida,Census_Tract,4817871,99.634633695383,83.27936582037205,463123814,115780953.5,157971622252.88815,84762071.96637782,4712507
Florida,Postal_Code,4814177,82.98495071423179,90.85016886522152,462105732,115526433.0,157617914915.22388,84572912.49373847,4708885
Georgia,Census_Tract,1503687,96.5545833414853,68.6019145687061,140138439,35034609.75,44737933517.874825,26767856.473523572,1501780
Georgia,Postal_Code,1502091,72.02704651939652,76.48404856671777,139653741,34913435.25,44581060812.03675,26673519.941978425,1500185
Guaynabo,Census_Tract,11603,111.26805227548675,89.77135936863131,984133,246033.25,342005084.6763793,230168.95562252367,11603
Guaynabo,Postal_Code,12113,96.69070837371878,88.43952681035891,986943,246735.75,342637380.99474514,230594.49018257228,12113
Hatillo,Census_Tract,224,38.851761427901465,91.4722740602506,25246,6311.5,9067192.223126221,6102.208001967081,224
Hawaii,Census_Tract,204390,92.40890122239375,90.28828623458985,19873246,4968311.5,7415195492.545843,4666457.000837703,178998
Hawaii,Postal_Code,204227,85.77323256083754,94.93133340007105,19835765,4958941.25,7400954705.80918,4657525.910539113,178851
Hormigueros,Census_Tract,1264,72.03823210284625,91.17801424826256,59807,14951.75,21266625.23529052,14312.409783773297,1264
Hormigueros,Postal_Code,1194,58.690744920993225,91.84615384615384,54608,13652.0,19401835.649896257,13057.408935665711,1194
Idaho,Census_Tract,311878,84.46661050804313,75.9107679289549,23093899,5773474.75,7526956885.239661,2001480.6360385304,311349
Idaho,Postal_Code,311671,77.44616743720586,85.81752126830315,23026001,5756500.25,7504231760.321071,1995437.8357183507,311142
Illinois,Census_Tract,2055456,91.65385121185525,75.07039880322085,164256874,41064218.5,47344747566.823105,39019478.60061409,2053003
Illinois,Postal_Code,2052522,81.52174935109402,81.22551550568922,163236997,40809249.25,47047851222.0221,38776748.30638689,2050075
Indiana,Census_Tract,1117000,102.8845689736421,74.41629924942166,93311273,23327818.25,26928123257.6459,22286009.07525565,1116012
Indiana,Postal_Code,1116413,72.70729951623908,80.98704273615948,93048465,23262116.25,26851041383.544178,22222230.94097572,1115426
Iowa,Census_Tract,350284,92.502375228341,67.55135102465918,29953011,7488252.75,8843145869.399498,4480709.137428613,350036
Iowa,Postal_Code,350073,72.26174249883248,78.45999338382977,29910958,7477739.5,8830596479.387407,4474350.521690869,349825
Kansas,Census_Tract,417333,89.95113875826723,74.4583819109252,36827430,9206857.5,11882464352.00895,8248164.194144529,416595
Kansas,Postal_Code,417118,78.0015186723769,83.90980882904063,36723960,9180990.0,11849160234.79061,8225046.276933068,416381
Kentucky,Census_Tract,575985,94.62267354085361,80.79952498243406,47393349,11848337.25,14048103923.893393,10893849.027434945,575262
Kentucky,Postal_Code,577255,75.34738154677154,86.8544077014831,47570216,11892554.0,14104070608.58099,10935523.832197243,576530
Louisiana,Census_Tract,865003,113.44943038082391,82.17435382731465,80308875,20077218.75,25885642034.581646,16119065.632724497,856780
Louisiana,Postal_Code,864431,74.02401966050749,85.77600943642521,80134650,20033662.5,25827876726.134453,16083222.605670763,856210
Loíza,Census_Tract,40,85.48387096774194,75.47169811320755,1693,423.25,595043.1626098631,400.46323702419204,40
Maine,Census_Tract,100065,85.2430142664818,65.17547802899195,7720530,1930132.5,2197957054.0975833,951467.7454093616,99705
Maine,Postal_Code,99960,63.10106887979922,63.636668811497685,7689271,1922317.75,2189004685.1428585,947591.4564713889,99600
Maryland,Census_Tract,705813,80.03630516726585,69.81305560602681,47690643,11922660.75,14399236326.491194,9341908.182602106,699742
Maryland,Postal_Code,705396,71.16030669975413,78.21436738373333,47560886,11890221.5,14360334548.562899,9317029.141011484,699332
Massachusetts,Census_Tract,1002203,87.21982464135503,72.28938390680631,69012277,17253069.25,19514148116.753475,8448829.999860715,986834
Massachusetts,Postal_Code,1000732,81.69850341980238,73.94909266069014,68609324,17152331.0,19399236401.382397,8399385.428188123,985382
Mayagüez,Census_Tract,7284,129.17712026429936,88.31524322675783,567212,141803.0,202552659.3214233,136317.66351863468,7284
Mayagüez,Postal_Code,7348,93.56904274340901,91.3667202708606,571212,142803.0,203989405.60508427,137284.59180836374,7348
Michigan,Census_Tract,1847255,96.31663324257916,72.87447311567942,147876313,36969078.25,40976609871.52638,32170938.264395673,1845535
Michigan,Postal_Code,1846232,76.11109096649122,79.04143589637181,147391827,36847956.75,40840033399.25273,32063411.389291123,1844515
Minnesota,Census_Tract,770077,90.42832750511005,64.55495274901152,65662303,16415575.75,18673751434.616875,9461269.60415691,768559
Minnesota,Postal_Code,769481,83.07005491274445,72.02677785988111,65464154,16366038.5,18617438249.15694,9432736.431870202,767964
Mississippi,Census_Tract,325095,110.38685412641182,70.47452389375442,32218920,8054730.0,10408673466.612555,6675246.399348798,324739
Mississippi,Postal_Code,324867,72.63111176104802,82.19166818603287,32127017,8031754.25,10378294594.571173,6657377.043182844,324511
Missouri,Census_Tract,1032104,89.17689216788044,76.33668998450831,84085928,21021482.0,26123174340.937073,20988770.94279072,1029240
Missouri,Postal_Code,1031097,80.34422515005369,82.55774214780112,83816328,20954082.0,26038971734.146763,20922455.467775125,1028243
Moca,Census_Tract,1,0.8264462809917356,100.0,28,7.0,8580.857080078125,5.774905113871622,1
Moca,Postal_Code,1,0.369003690036
Current sql:
SELECT
  state_name AS State_Name,
  Level,
  SUM(count_qualified) AS Number_of_Buildings_Available,
  AVG(percent_covered) AS Percentage_Covered_by_Sunroof,
  AVG(percent_qualified) AS Percentage_Suitable_for_Solar,
  SUM(number_of_panels_total) AS Total_Potential_Panel_Count,
  SUM(kw_total) AS Total_Kilowatt_Capacity,
  SUM(yearly_sunlight_kwh_total) AS Energy_Generation_Potential,
  SUM(carbon_offset_metric_tons) AS Carbon_Dioxide_Offset,
  SUM(count_qualified - existing_installs_count) AS Gap_in_Potential_Installations
FROM (
  SELECT 
    `state_name`,
    'Postal_Code' AS Level,
    `count_qualified`,
    `percent_covered`,
    `percent_qualified`,
    `number_of_panels_total`,
    `kw_total`,
    `yearly_sunlight_kwh_total`,
    `carbon_offset_metric_tons`,
    `existing_installs_count`
  FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
  UNION ALL
  SELECT 
    `state_name`,
    'Census_Tract' AS Level,
    `count_qualified`,
    `percent_covered`,
    `percent_qualified`,
    `number_of_panels_total`,
    `kw_total`,
    `yearly_sunlight_kwh_total`,
    `carbon_offset_metric_tons`,
    `existing_installs_count`
  FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
) AS combined_data
GROUP BY state_name, Level
ORDER BY state_name, Level;
2025-01-24 23:41:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 23:41:56 - root - INFO - ```sql
SELECT
  state_name AS State_Name,
  Level,
  SUM(count_qualified) AS Number_of_Buildings_Available,
  ROUND(SUM(percent_covered * count_qualified) / SUM(count_qualified), 4) AS Percentage_Covered_by_Sunroof,
  ROUND(SUM(percent_qualified * count_qualified) / SUM(count_qualified), 4) AS Percentage_Suitable_for_Solar,
  SUM(number_of_panels_total) AS Total_Potential_Panel_Count,
  ROUND(SUM(kw_total), 4) AS Total_Kilowatt_Capacity,
  ROUND(SUM(yearly_sunlight_kwh_total), 4) AS Energy_Generation_Potential,
  ROUND(SUM(carbon_offset_metric_tons), 4) AS Carbon_Dioxide_Offset,
  SUM(count_qualified - existing_installs_count) AS Gap_in_Potential_Installations
FROM (
  SELECT 
    `state_name`,
    'Postal_Code' AS Level,
    `count_qualified`,
    `percent_covered`,
    `percent_qualified`,
    `number_of_panels_total`,
    `kw_total`,
    `yearly_sunlight_kwh_total`,
    `carbon_offset_metric_tons`,
    `existing_installs_count`
  FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
  UNION ALL
  SELECT 
    `state_name`,
    'Census_Tract' AS Level,
    `count_qualified`,
    `percent_covered`,
    `percent_qualified`,
    `number_of_panels_total`,
    `kw_total`,
    `yearly_sunlight_kwh_total`,
    `carbon_offset_metric_tons`,
    `existing_installs_count`
  FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
) AS combined_data
GROUP BY state_name, Level
ORDER BY state_name, Level;
```
2025-01-24 23:41:58 - root - INFO - itercount: 2
2025-01-24 23:41:58 - root - INFO - 0
2025-01-24 23:41:58 - root - INFO - results: 
State_Name,Level,Number_of_Buildings_Available,Percentage_Covered_by_Sunroof,Percentage_Suitable_for_Solar,Total_Potential_Panel_Count,Total_Kilowatt_Capacity,Energy_Generation_Potential,Carbon_Dioxide_Offset,Gap_in_Potential_Installations
Aguadilla,Census_Tract,5852,102.6771,89.8728,432711,108177.75,160079112.7508,107733.0246,5852
Aguadilla,Postal_Code,5844,85.9779,89.2853,432049,108012.25,159844295.7499,107574.9931,5844
Alabama,Census_Tract,814213,117.1417,83.4422,77644088,19411022.0,24759196398.2548,15792877.1553,813666
Alabama,Postal_Code,813312,84.6189,83.0311,77298546,19324636.5,24646969095.8459,15723425.9345,812768
Alaska,Census_Tract,57169,97.7069,77.1183,5462549,1365637.25,1092118868.9738,449958.7974,57086
Alaska,Postal_Code,57138,91.8543,76.4557,5447225,1361806.25,1089086633.2073,448709.5001,57055
Arecibo,Census_Tract,3962,106.5759,92.9233,306604,76651.0,110110577.3654,74104.2684,3962
Arecibo,Postal_Code,4433,68.3132,92.8637,345214,86303.5,123956987.1142,83422.8833,4433
Arizona,Census_Tract,1754534,112.7498,95.7883,147450436,36862609.0,59127893265.4281,25393752.1209,1714808
Arizona,Postal_Code,1753531,94.202,95.6034,147238408,36809602.0,59043009935.2978,25357559.2992,1713835
Arkansas,Census_Tract,370016,104.9215,81.6401,36012747,9003186.75,11362387314.959,7162306.2281,369777
Arkansas,Postal_Code,369725,81.319,81.251,35933867,8983466.75,11336956069.4068,7146339.2217,369486
Baja California,Postal_Code,1,0.0674,20.0,23,5.75,8322.0298,0.0,1
Bayamón,Census_Tract,33466,104.9045,92.5301,2134598,533649.5,751085531.8753,505479.5388,33466
Bayamón,Postal_Code,33260,96.8035,92.4762,2098880,524720.0,738592635.6176,497071.8366,33260
Cabo Rojo,Census_Tract,2,5.0,100.0,668,167.0,236279.5845,159.0158,2
California,Census_Tract,8617901,100.7769,91.8884,654784266,163696066.5,243304846869.2122,67060256.5599,8286083
California,Postal_Code,8607224,94.9349,91.7225,652983168,163245792.0,242638396940.6191,66878632.2241,8275950
Canóvanas,Census_Tract,2099,126.1455,89.417,139475,34868.75,49976173.3745,33633.8965,2099
Canóvanas,Postal_Code,2182,66.3404,89.4262,160471,40117.75,57543460.702,38726.6706,2182
Carolina,Census_Tract,19688,130.4953,93.208,1554053,388513.25,553262399.394,372344.8404,19688
Carolina,Postal_Code,19237,96.1993,92.9825,1481427,370356.75,527251268.0265,354839.3844,19237
Cataño,Census_Tract,2764,2318.7993,84.1471,168020,42005.0,59578578.5969,40096.3022,2764
Cataño,Postal_Code,2860,95.9873,84.2299,186311,46577.75,65981195.4786,44405.2546,2860
Colorado,Census_Tract,1032067,99.382,87.3887,69425443,17356360.75,24667013678.5191,15019343.8016,1007705
Colorado,Postal_Code,1031389,92.3492,86.9502,69150828,17287707.0,24570049923.1474,14960304.1466,1007054
Connecticut,Census_Tract,608869,102.114,75.6909,43575214,10893803.5,12438466928.1723,5385610.0147,603585
Connecticut,Postal_Code,607976,93.1452,75.2947,43269892,10817473.0,12350145123.4525,5347366.4436,602708
Corozal,Postal_Code,15,1.2121,93.75,1667,416.75,587979.9846,395.7097,15
Delaware,Census_Tract,147535,98.1468,81.0526,10771425,2692856.25,3222438352.7232,2047732.7107,147447
Delaware,Postal_Code,147431,88.4306,80.5924,10742839,2685709.75,3213827406.3592,2042260.7933,147343
District of Columbia,Census_Tract,76464,96.2662,68.6055,3983844,995961.0,1209717858.796,768728.0745,76022
District of Columbia,Postal_Code,76385,93.51,67.5099,3937623,984405.75,1195714591.0355,759829.5492,75943
Dorado,Census_Tract,3067,156.2504,93.8616,199501,49875.25,70542741.7862,47475.169,3067
Dorado,Postal_Code,3064,78.2786,93.8438,199254,49813.5,70454673.2366,47415.899,3064
Florida,Census_Tract,4817871,113.7956,92.4466,463123814,115780953.5,157971622252.8882,84762071.9664,4712507
Florida,Postal_Code,4814177,91.0336,92.267,462105732,115526433.0,157617914915.2239,84572912.4937,4708885
Georgia,Census_Tract,1503687,103.9667,77.703,140138439,35034609.75,44737933517.8748,26767856.4735,1501780
Georgia,Postal_Code,1502091,87.6348,77.0059,139653741,34913435.25,44581060812.0368,26673519.942,1500185
Guaynabo,Census_Tract,11603,122.362,90.19,984133,246033.25,342005084.6764,230168.9556,11603
Guaynabo,Postal_Code,12113,96.9722,90.2743,986943,246735.75,342637380.9947,230594.4902,12113
Hatillo,Census_Tract,224,39.6954,91.5679,25246,6311.5,9067192.2231,6102.208,224
Hawaii,Census_Tract,204390,99.854,96.7516,19873246,4968311.5,7415195492.5458,4666457.0008,178998
Hawaii,Postal_Code,204227,93.6117,96.521,19835765,4958941.25,7400954705.8092,4657525.9105,178851
Hormigueros,Census_Tract,1264,85.3507,91.3319,59807,14951.75,21266625.2353,14312.4098,1264
Hormigueros,Postal_Code,1194,58.6907,91.8462,54608,13652.0,19401835.6499,13057.4089,1194
Idaho,Census_Tract,311878,99.5828,88.4102,23093899,5773474.75,7526956885.2397,2001480.636,311349
Idaho,Postal_Code,311671,86.2886,87.8866,23026001,5756500.25,7504231760.3211,1995437.8357,311142
Illinois,Census_Tract,2055456,99.4503,82.4251,164256874,41064218.5,47344747566.8231,39019478.6006,2053003
Illinois,Postal_Code,2052522,94.1639,81.9017,163236997,40809249.25,47047851222.0221,38776748.3064,2050075
Indiana,Census_Tract,1117000,107.4949,83.5302,93311273,23327818.25,26928123257.6459,22286009.0753,1116012
Indiana,Postal_Code,1116413,89.28,83.1329,93048465,23262116.25,26851041383.5442,22222230.941,1115426
Iowa,Census_Tract,350284,102.9644,76.745,29953011,7488252.75,8843145869.3995,4480709.1374,350036
Iowa,Postal_Code,350073,89.6262,75.7694,29910958,7477739.5,8830596479.3874,4474350.5217,349825
Kansas,Census_Tract,417333,98.0098,83.9946,36827430,9206857.5,11882464352.0089,8248164.1941,416595
Kansas,Postal_Code,417118,92.9171,83.2838,36723960,9180990.0,11849160234.7906,8225046.2769,416381
Kentucky,Census_Tract,575985,106.2873,88.4129,47393349,11848337.25,14048103923.8934,10893849.0274,575262
Kentucky,Postal_Code,577255,88.3918,88.2304,47570216,11892554.0,14104070608.581,10935523.8322,576530
Louisiana,Census_Tract,865003,111.4292,88.5937,80308875,20077218.75,25885642034.5816,16119065.6327,856780
Louisiana,Postal_Code,864431,89.4997,88.403,80134650,20033662.5,25827876726.1345,16083222.6057,856210
Loíza,Census_Tract,40,85.4839,75.4717,1693,423.25,595043.1626,400.4632,40
Maine,Census_Tract,100065,99.6737,70.8887,7720530,1930132.5,2197957054.0976,951467.7454,99705
Maine,Postal_Code,99960,85.8237,70.6686,7689271,1922317.75,2189004685.1429,947591.4565,99600
Maryland,Census_Tract,705813,100.1918,81.829,47690643,11922660.75,14399236326.4912,9341908.1826,699742
Maryland,Postal_Code,705396,90.5485,81.0993,47560886,11890221.5,14360334548.5629,9317029.141,699332
Massachusetts,Census_Tract,1002203,96.8198,75.8199,69012277,17253069.25,19514148116.7535,8448829.9999,986834
Massachusetts,Postal_Code,1000732,92.2107,75.578,68609324,17152331.0,19399236401.3824,8399385.4282,985382
Mayagüez,Census_Tract,7284,102.6285,87.7009,567212,141803.0,202552659.3214,136317.6635,7284
Mayagüez,Postal_Code,7348,91.212,87.3703,571212,142803.0,203989405.6051,137284.5918,7348
Michigan,Census_Tract,1847255,102.7059,79.5776,147876313,36969078.25,40976609871.5264,32170938.2644,1845535
Michigan,Postal_Code,1846232,91.3597,78.9736,147391827,36847956.75,40840033399.2527,32063411.3893,1844515
Minnesota,Census_Tract,770077,98.8849,74.1141,65662303,16415575.75,18673751434.6169,9461269.6042,768559
Minnesota,Postal_Code,769481,93.0672,73.235,65464154,16366038.5,18617438249.1569,9432736.4319,767964
Mississippi,Census_Tract,325095,106.8825,83.7411,32218920,8054730.0,10408673466.6126,6675246.3993,324739
Mississippi,Postal_Code,324867,84.7175,83.0735,32127017,8031754.25,10378294594.5712,6657377.0432,324511
Missouri,Census_Tract,1032104,99.7993,85.8823,84085928,21021482.0,26123174340.9371,20988770.9428,1029240
Missouri,Postal_Code,1031097,91.893,85.4572,83816328,20954082.0,26038971734.1468,20922455.4678,1028243
Moca,Census_Tract,1,0.8264,100.0,28,7.0,8580.8571,5.7749,1
Moca,Postal_Code,1,0.369,100.0,28,7.0,8580.8571,5.7749,1
Montana,Census_Tract,118683,98.4553,82.504,9189162,2297290.5,2711943864.9011,721128.5005,118421
Montana,Postal_Code,118654,86.7237,81.7899,9181610,2295402.5,2709785572.9773,720554.5926,118393
Nebraska,Census_Tract,283467,99.2024,87.153,21582607,5395651.75,6725165429.1834,3407555.4824,283257
Nebraska,Postal_Code,283330,94.2932,86.7233,21495882,5373970.5,6698087315.2918,3393835.3478,283121
Nevada,Census_Tract,569461,106.0972,95.6038,43616656,10904164.0,17236108170.2717,6552267.6146,556715
Nevada,Postal_Code,569104,90.5697,95.4496,43540016,10885004.0,17206349924.6226,6541464.5406,556366
New Hampshire,Census_Tract,107103,96.5118,73.1833,9054358,2263589.5,2555251276.172,1106392.3375,106841
New Hampshire,Postal_Code,107012,79.6352,72.7282,9037409,2259352.25,2550456273.824,1104316.148,106750
New Jersey,Census_Tract,1632773,180.3647,79.7761,117024321,29256080.25,34132296027.4146,21441825.259,1620118
New Jersey,Postal_Code,1629714,93.8135,79.3217,116249897,29062474.25,33904852397.547,21299363.2397,1617086
New Mexico,Census_Tract,365962,99.8252,94.7718,29605361,7401340.25,12208818476.4937,5193766.8187,362213
New Mexico,Postal_Code,365713,88.6097,94.6619,29552308,7388077.0,12187002098.5036,5184507.9049,361964
New York,Census_Tract,2506035,99.8119,81.4466,158794563,39698640.75,45100394878.6694,21932730.052,2487240
New York,Postal_Code,2502541,94.4776,80.9982,157857812,39464453.0,44831446454.6671,21798509.3084,2483797
North Carolina,Census_Tract,1416843,114.8098,78.2507,124233257,31058314.25,39607264848.0049,23363984.2396,1413932
North Carolina,Postal_Code,1416043,82.3685,77.4421,123962977,30990744.25,39519833527.2098,23311951.927,1413133
North Dakota,Census_Tract,77129,99.0986,85.1161,8138951,2034737.75,2299032486.1954,1164890.4157,77105
North Dakota,Postal_Code,77117,85.0906,83.2333,8128226,2032056.5,2295970930.9818,1163339.1648,77093
Ohio,Census_Tract,2194900,105.8734,84.0311,171901350,42975337.5,48300160986.3547,39985118.6948,2192055
Ohio,Postal_Code,2192109,92.7458,83.7021,171022353,42755588.25,48048536615.6779,39776810.4632,2189269
Oklahoma,Census_Tract,701280,98.207,93.1875,60560124,15140031.0,20218586198.6994,13676736.4824,700478
Oklahoma,Postal_Code,700888,90.2294,93.0316,60455902,15113975.5,20183717271.2619,13653148.5462,700086
Oregon,Census_Tract,773130,102.3687,86.9653,61617355,15404338.75,16514535968.3865,4391352.901,764477
Oregon,Postal_Code,772441,87.6135,86.6299,61510848,15377712.0,16486992928.992,4384028.977,763794
Pennsylvania,Census_Tract,1956097,108.7311,79.861,133691622,33422905.5,38210009215.7575,25679219.8044,1951689
Pennsylvania,Postal_Code,1954585,90.2522,79.2241,133004637,33251159.25,38013732231.3753,25546821.4854,1950183
Ponce,Census_Tract,18091,101.7601,89.234,1165041,291260.25,385731295.9627,259596.6362,18091
Ponce,Postal_Code,18706,87.6562,88.7032,1162806,290701.5,384801553.7466,258970.9209,18706
Rhode Island,Census_Tract,203167,98.8348,79.5516,13001474,3250368.5,3726814813.7139,1613670.2388,202796
Rhode Island,Postal_Code,202865,95.3153,79.3227,12914100,3228525.0,3701710212.1397,1602800.1897,202494
San Juan,Census_Tract,44341,327.6011,90.2588,3375014,843753.5,1177674698.0645,792573.4659,44341
San Juan,Postal_Code,44665,97.3163,89.9963,3423143,855785.75,1195075494.0901,804284.1779,44665
South Carolina,Census_Tract,908394,103.8594,81.7265,79312131,19828032.75,25692275291.3394,15082325.9532,907128
South Carolina,Postal_Code,907878,82.7579,81.1985,79183940,19795985.0,25650182524.8031,15057615.5421,906615
South Dakota,Census_Tract,72867,94.4318,82.9698,6377373,1594343.25,1966083346.8824,1047973.7957,72846
South Dakota,Postal_Code,72847,80.6494,82.1441,6372371,1593092.75,1964549826.5416,1047147.0385,72826
Tennessee,Census_Tract,1105463,103.5017,85.0651,101762224,25440556.0,31169276299.0685,23662867.3964,1104151
Tennessee,Postal_Code,1102947,87.6697,84.7502,101108289,25277072.25,30966907026.8116,23508638.5762,1101641
Texas,Census_Tract,5480573,99.1845,91.4428,481747719,120436929.75,160458070556.0889,80026572.0962,5466434
Texas,Postal_Code,5476777,90.1362,91.2113,480505530,120126382.5,160039623751.7003,79820466.3972,5462650
Toa Alta,Census_Tract,1345,2943.2252,88.2894,73394,18348.5,25725431.5722,17313.1804,1345
Toa Alta,Postal_Code,1123,83.1899,89.3397,88675,22168.75,31279276.9725,21050.9107,1123
Toa Baja,Census_Tract,6517,119.6034,89.4998,362967,90741.75,128650286.2398,86581.4672,6517
Toa Baja,Postal_Code,6976,96.8358,89.3901,371052,92763.0,131548735.5374,88532.1196,6976
Trujillo Alto,Census_Tract,2873,1641.1418,88.8017,197851,49462.75,69008952.5837,46442.931,2873
Trujillo Alto,Postal_Code,2854,87.0544,88.3592,196126,49031.5,68412270.1506,46041.3645,2854
Utah,Census_Tract,573155,104.1464,91.2427,44105531,11026382.75,15249940379.6631,4055086.383,569989
Utah,Postal_Code,572530,88.6258,91.023,43988756,10997189.0,15209638303.2219,4044369.7246,569369
Vermont,Census_Tract,19530,124.4414,76.6753,2012472,503118.0,551942863.0689,238985.907,19399
Vermont,Postal_Code,19504,91.3908,76.4683,1988764,497191.0,545353715.0416,236132.8698,19373
Virginia,Census_Tract,963792,102.7681,78.027,74914378,18728594.5,23169044381.2503,14570516.6127,961383
Virginia,Postal_Code,963270,88.8298,77.2901,74735305,18683826.25,23113080773.3992,14534537.8188,960863
Washington,Census_Tract,1511814,107.912,84.8675,107938035,26984508.75,27475803851.3941,7305348.1216,1506055
Washington,Postal_Code,1510869,89.9232,84.4239,107756625,26939156.25,27430232929.4004,7293347.1851,1505113
West Virginia,Census_Tract,155047,160.4826,82.9551,11387665,2846916.25,3272165883.9079,2708875.4834,154967
West Virginia,Postal_Code,154869,83.3773,82.6566,11336559,2834139.75,3257389195.7983,2696642.5437,154789
Wisconsin,Census_Tract,900707,102.4432,80.7256,82459475,20614868.75,23542559983.9033,18538719.2118,898793
Wisconsin,Postal_Code,900028,90.8207,80.241,82263947,20565986.75,23486482672.1245,18493486.254,898115
Wyoming,Census_Tract,53090,95.1006,86.5754,3848056,962014.0,1302268164.5377,399567.8101,53061
Wyoming,Postal_Code,53068,81.0431,86.1117,3843267,960816.75,1300665963.8247,399141.7715,53039


2025-01-24 23:41:58 - root - INFO - Please check the answer again by reviewing Can you provide a detailed comparison of the solar potential for each state, distinguishing between postal code and census tract levels? Include the number of buildings available for solar installations, the percentage covered by Project Sunroof, the percentage suitable for solar, total potential panel count, total kilowatt capacity, energy generation potential, carbon dioxide offset, and the gap in potential installations., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
State_Name,Level,Number_of_Buildings_Available,Percentage_Covered_by_Sunroof,Percentage_Suitable_for_Solar,Total_Potential_Panel_Count,Total_Kilowatt_Capacity,Energy_Generation_Potential,Carbon_Dioxide_Offset,Gap_in_Potential_Installations
state1:str,Postal_Code,num_buildings:int,percent_covered:0<=float<=100,percent_suitable:0<=float<=100,total_panels:int,kw_capacity:float,energy_potential:float,co2_offset:float,installation_gap:int
state1:str,Census_Tract,num_buildings:int,percent_covered:0<=float<=100,percent_suitable:0<=float<=100,total_panels:int,kw_capacity:float,energy_potential:float,co2_offset:float,installation_gap:int
state2:str,Postal_Code,num_buildings:int,percent_covered:0<=float<=100,percent_suitable:0<=float<=100,total_panels:int,kw_capacity:float,energy_potential:float,co2_offset:float,installation_gap:int
state2:str,Census_Tract,num_buildings:int,percent_covered:0<=float<=100,percent_suitable:0<=float<=100,total_panels:int,kw_capacity:float,energy_potential:float,co2_offset:float,installation_gap:int
...
```

**Explanation:**

The table above provides a detailed comparison of the solar potential for each state, distinguishing between postal code and census tract levels. The columns include:

- **State_Name**: The name of the state.
- **Level**: The data aggregation level (`Postal_Code` or `Census_Tract`).
- **Number_of_Buildings_Available**: Number of buildings available for solar installations (`int`).
- **Percentage_Covered_by_Sunroof**: Percentage of buildings covered by Project Sunroof (`float` between 0 and 100).
- **Percentage_Suitable_for_Solar**: Percentage of buildings suitable for solar installations (`float` between 0 and 100).
- **Total_Potential_Panel_Count**: Total potential number of solar panels (`int`).
- **Total_Kilowatt_Capacity**: Total potential kilowatt capacity (`float`).
- **Energy_Generation_Potential**: Potential energy generation (`float`).
- **Carbon_Dioxide_Offset**: Potential carbon dioxide offset (`float`).
- **Gap_in_Potential_Installations**: Difference between the potential installations and existing installations (`int`).

Each state is listed twice to compare the data at the postal code level and the census tract level. This comparison highlights differences in solar potential assessments based on the granularity of the data. The `Gap_in_Potential_Installations` represents the untapped opportunity for solar installations in each state. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Too long, hard cut:
State_Name,Level,Number_of_Buildings_Available,Percentage_Covered_by_Sunroof,Percentage_Suitable_for_Solar,Total_Potential_Panel_Count,Total_Kilowatt_Capacity,Energy_Generation_Potential,Carbon_Dioxide_Offset,Gap_in_Potential_Installations
Aguadilla,Census_Tract,5852,102.6771,89.8728,432711,108177.75,160079112.7508,107733.0246,5852
Aguadilla,Postal_Code,5844,85.9779,89.2853,432049,108012.25,159844295.7499,107574.9931,5844
Alabama,Census_Tract,814213,117.1417,83.4422,77644088,19411022.0,24759196398.2548,15792877.1553,813666
Alabama,Postal_Code,813312,84.6189,83.0311,77298546,19324636.5,24646969095.8459,15723425.9345,812768
Alaska,Census_Tract,57169,97.7069,77.1183,5462549,1365637.25,1092118868.9738,449958.7974,57086
Alaska,Postal_Code,57138,91.8543,76.4557,5447225,1361806.25,1089086633.2073,448709.5001,57055
Arecibo,Census_Tract,3962,106.5759,92.9233,306604,76651.0,110110577.3654,74104.2684,3962
Arecibo,Postal_Code,4433,68.3132,92.8637,345214,86303.5,123956987.1142,83422.8833,4433
Arizona,Census_Tract,1754534,112.7498,95.7883,147450436,36862609.0,59127893265.4281,25393752.1209,1714808
Arizona,Postal_Code,1753531,94.202,95.6034,147238408,36809602.0,59043009935.2978,25357559.2992,1713835
Arkansas,Census_Tract,370016,104.9215,81.6401,36012747,9003186.75,11362387314.959,7162306.2281,369777
Arkansas,Postal_Code,369725,81.319,81.251,35933867,8983466.75,11336956069.4068,7146339.2217,369486
Baja California,Postal_Code,1,0.0674,20.0,23,5.75,8322.0298,0.0,1
Bayamón,Census_Tract,33466,104.9045,92.5301,2134598,533649.5,751085531.8753,505479.5388,33466
Bayamón,Postal_Code,33260,96.8035,92.4762,2098880,524720.0,738592635.6176,497071.8366,33260
Cabo Rojo,Census_Tract,2,5.0,100.0,668,167.0,236279.5845,159.0158,2
California,Census_Tract,8617901,100.7769,91.8884,654784266,163696066.5,243304846869.2122,67060256.5599,8286083
California,Postal_Code,8607224,94.9349,91.7225,652983168,163245792.0,242638396940.6191,66878632.2241,8275950
Canóvanas,Census_Tract,2099,126.1455,89.417,139475,34868.75,49976173.3745,33633.8965,2099
Canóvanas,Postal_Code,2182,66.3404,89.4262,160471,40117.75,57543460.702,38726.6706,2182
Carolina,Census_Tract,19688,130.4953,93.208,1554053,388513.25,553262399.394,372344.8404,19688
Carolina,Postal_Code,19237,96.1993,92.9825,1481427,370356.75,527251268.0265,354839.3844,19237
Cataño,Census_Tract,2764,2318.7993,84.1471,168020,42005.0,59578578.5969,40096.3022,2764
Cataño,Postal_Code,2860,95.9873,84.2299,186311,46577.75,65981195.4786,44405.2546,2860
Colorado,Census_Tract,1032067,99.382,87.3887,69425443,17356360.75,24667013678.5191,15019343.8016,1007705
Colorado,Postal_Code,1031389,92.3492,86.9502,69150828,17287707.0,24570049923.1474,14960304.1466,1007054
Connecticut,Census_Tract,608869,102.114,75.6909,43575214,10893803.5,12438466928.1723,5385610.0147,603585
Connecticut,Postal_Code,607976,93.1452,75.2947,43269892,10817473.0,12350145123.4525,5347366.4436,602708
Corozal,Postal_Code,15,1.2121,93.75,1667,416.75,587979.9846,395.7097,15
Delaware,Census_Tract,147535,98.1468,81.0526,10771425,2692856.25,3222438352.7232,2047732.7107,147447
Delaware,Postal_Code,147431,88.4306,80.5924,10742839,2685709.75,3213827406.3592,2042260.7933,147343
District of Columbia,Census_Tract,76464,96.2662,68.6055,3983844,995961.0,1209717858.796,768728.0745,76022
District of Columbia,Postal_Code,76385,93.51,67.5099,3937623,984405.75,1195714591.0355,759829.5492,75943
Dorado,Census_Tract,3067,156.2504,93.8616,199501,49875.25,70542741.7862,47475.169,3067
Dorado,Postal_Code,3064,78.2786,93.8438,199254,49813.5,70454673.2366,47415.899,3064
Florida,Census_Tract,4817871,113.7956,92.4466,463123814,115780953.5,157971622252.8882,84762071.9664,4712507
Florida,Postal_Code,4814177,91.0336,92.267,462105732,115526433.0,157617914915.2239,84572912.4937,4708885
Georgia,Census_Tract,1503687,103.9667,77.703,140138439,35034609.75,44737933517.8748,26767856.4735,1501780
Georgia,Postal_Code,1502091,87.6348,77.0059,139653741,34913435.25,44581060812.0368,26673519.942,1500185
Guaynabo,Census_Tract,11603,122.362,90.19,984133,246033.25,342005084.6764,230168.9556,11603
Guaynabo,Postal_Code,12113,96.9722,90.2743,986943,246735.75,342637380.9947,230594.4902,12113
Hatillo,Census_Tract,224,39.6954,91.5679,25246,6311.5,9067192.2231,6102.208,224
Hawaii,Census_Tract,204390,99.854,96.7516,19873246,4968311.5,7415195492.5458,4666457.0008,178998
Hawaii,Postal_Code,204227,93.6117,96.521,19835765,4958941.25,7400954705.8092,4657525.9105,178851
Hormigueros,Census_Tract,1264,85.3507,91.3319,59807,14951.75,21266625.2353,14312.4098,1264
Hormigueros,Postal_Code,1194,58.6907,91.8462,54608,13652.0,19401835.6499,13057.4089,1194
Idaho,Census_Tract,311878,99.5828,88.4102,23093899,5773474.75,7526956885.2397,2001480.636,311349
Idaho,Postal_Code,311671,86.2886,87.8866,23026001,5756500.25,7504231760.3211,1995437.8357,311142
Illinois,Census_Tract,2055456,99.4503,82.4251,164256874,41064218.5,47344747566.8231,39019478.6006,2053003
Illinois,Postal_Code,2052522,94.1639,81.9017,163236997,40809249.25,47047851222.0221,38776748.3064,2050075
Indiana,Census_Tract,1117000,107.4949,83.5302,93311273,23327818.25,26928123257.6459,22286009.0753,1116012
Indiana,Postal_Code,1116413,89.28,83.1329,93048465,23262116.25,26851041383.5442,22222230.941,1115426
Iowa,Census_Tract,350284,102.9644,76.745,29953011,7488252.75,8843145869.3995,4480709.1374,350036
Iowa,Postal_Code,350073,89.6262,75.7694,29910958,7477739.5,8830596479.3874,4474350.5217,349825
Kansas,Census_Tract,417333,98.0098,83.9946,36827430,9206857.5,11882464352.0089,8248164.1941,416595
Kansas,Postal_Code,417118,92.9171,83.2838,36723960,9180990.0,11849160234.7906,8225046.2769,416381
Kentucky,Census_Tract,575985,106.2873,88.4129,47393349,11848337.25,14048103923.8934,10893849.0274,575262
Kentucky,Postal_Code,577255,88.3918,88.2304,47570216,11892554.0,14104070608.581,10935523.8322,576530
Louisiana,Census_Tract,865003,111.4292,88.5937,80308875,20077218.75,25885642034.5816,16119065.6327,856780
Louisiana,Postal_Code,864431,89.4997,88.403,80134650,20033662.5,25827876726.1345,16083222.6057,856210
Loíza,Census_Tract,40,85.4839,75.4717,1693,423.25,595043.1626,400.4632,40
Maine,Census_Tract,100065,99.6737,70.8887,7720530,1930132.5,2197957054.0976,951467.7454,99705
Maine,Postal_Code,99960,85.8237,70.6686,7689271,1922317.75,2189004685.1429,947591.4565,99600
Maryland,Census_Tract,705813,100.1918,81.829,47690643,11922660.75,14399236326.4912,9341908.1826,699742
Maryland,Postal_Code,705396,90.5485,81.0993,47560886,11890221.5,14360334548.5629,9317029.141,699332
Massachusetts,Census_Tract,1002203,96.8198,75.8199,69012277,17253069.25,19514148116.7535,8448829.9999,986834
Massachusetts,Postal_Code,1000732,92.2107,75.578,68609324,17152331.0,19399236401.3824,8399385.4282,985382
Mayagüez,Census_Tract,7284,102.6285,87.7009,567212,141803.0,202552659.3214,136317.6635,7284
Mayagüez,Postal_Code,7348,91.212,87.3703,571212,142803.0,203989405.6051,137284.5918,7348
Michigan,Census_Tract,1847255,102.7059,79.5776,147876313,36969078.25,40976609871.5264,32170938.2644,1845535
Michigan,Postal_Code,1846232,91.3597,78.9736,147391827,36847956.75,40840033399.2527,32063411.3893,1844515
Minnesota,Census_Tract,770077,98.8849,74.1141,65662303,16415575.75,18673751434.6169,9461269.6042,768559
Minnesota,Postal_Code,769481,93.0672,73.235,65464154,16366038.5,18617438249.1569,9432736.4319,767964
Mississippi,Census_Tract,325095,106.8825,83.7411,32218920,8054730.0,10408673466.6126,6675246.3993,324739
Mississippi,Postal_Code,324867,84.7175,83.0735,32127017,8031754.25,10378294594.5712,6657377.0432,324511
Missouri,Census_Tract,1032104,99.7993,85.8823,84085928,21021482.0,26123174340.9371,20988770.9428,1029240
Missouri,Postal_Code,1031097,91.893,85.4572,83816328,20954082.0,26038971734.1468,20922455.4678,1028243
Moca,Census_Tract,1,0.8264,100.0,28,7.0,8580.8571,5.7749,1
Moca,Postal_Code,1,0.369,100.0,28,7.0,8580.8571,5.7749,1
Montana,Census_Tract,118683,98.4553,82.504,9189162,2297290.5,2711943864.9011,721128.5005,118421
Montana,Postal_Code,118654,86.7237,81.7899,9181610,2295402.5,2709785572.9773,720554.5926,118393
Nebraska,Census_Tract,283467,99.2024,87.153,21582607,5395651.75,6725165429.1834,3407555.4824,283257
Nebraska,Postal_Code,283330,94.2932,86.7233,21495882,5373970.5,6698087315.2918,3393835.3478,283121
Nevada,Census_Tract,569461,106.0972,95.6038,43616656,10904164.0,17236108170.2717,6552267.6146,556715
Nevada,Postal_Code,569104,90.5697,95.4496,43540016,10885004.0,17206349924.6226,6541464.5406,556366
New Hampshire,Census_Tract,107103,96.5118,73.1833,9054358,2263589.5,2555251276.172,1106392.3375,106841
New Hampshire,Postal_Code,107012,79.6352,72.7282,9037409,2259352.25,2550456273.824,1104316.148,106750
New Jersey,Census_Tract,1632773,180.3647,79.7761,117024321,29256080.25,34132296027.4146,21441825.259,1620118
New Jersey,Postal_Code,1629714,93.8135,79.3217,116249897,29062474.25,33904852397.547,21299363.2397,1617086
New Mexico,Census_Tract,365962,99.8252,94.7718,29605361,7401340.25,12208818476.4937,5193766.8187,362213
New Mexico,Postal_Code,365713,88.6097,94.6619,29552308,7388077.0,12187002098.5036,5184507.9049,361964
New York,Census_Tract,2506035,99.8119,81.4466,158794563,39698640.75,45100394878.6694,21932730.052,2487240
New York,Postal_Code,2502541,94.4776,80.9982,157857812,39464453.0,44831446454.6671,21798509.3084,2483797
North Carolina,Census_Tract,1416843,114.8098,78.2507,124233257,31058314.25,39607264848.0049,23363984.2396,1413932
North Carolina,Postal_Code,1416043,82.3685,77.4421,123962977,30990744.25,39519833527.2098,23311951.927,1413133
North Dakota,Census_Tract,77129,99.0986,85.1161,8138951,2034737.75,2299032486.1954,1164890.4157,77105
North Dakota,Postal_Code,77117,85.0906,83.2333,8128226,2032056.5,2295970930.9818,1163339.1648,77093
Ohio,Census_Tract,2194900,105.8734,84.0311,171901350,42975337.5,48300160986.3547,39985118.6948,2192055
Ohio,Postal_Code,2192109,92.7458,83.7021,171022353,42755588.25,48048536615.6779,39776810.4632,2189269
Oklahoma,Census_Tract,701280,98.207,93.1875,60560124,15140031.0,20218586198.6994,13676736.4
Current sql:
SELECT
  state_name AS State_Name,
  Level,
  SUM(count_qualified) AS Number_of_Buildings_Available,
  ROUND(SUM(percent_covered * count_qualified) / SUM(count_qualified), 4) AS Percentage_Covered_by_Sunroof,
  ROUND(SUM(percent_qualified * count_qualified) / SUM(count_qualified), 4) AS Percentage_Suitable_for_Solar,
  SUM(number_of_panels_total) AS Total_Potential_Panel_Count,
  ROUND(SUM(kw_total), 4) AS Total_Kilowatt_Capacity,
  ROUND(SUM(yearly_sunlight_kwh_total), 4) AS Energy_Generation_Potential,
  ROUND(SUM(carbon_offset_metric_tons), 4) AS Carbon_Dioxide_Offset,
  SUM(count_qualified - existing_installs_count) AS Gap_in_Potential_Installations
FROM (
  SELECT 
    `state_name`,
    'Postal_Code' AS Level,
    `count_qualified`,
    `percent_covered`,
    `percent_qualified`,
    `number_of_panels_total`,
    `kw_total`,
    `yearly_sunlight_kwh_total`,
    `carbon_offset_metric_tons`,
    `existing_installs_count`
  FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
  UNION ALL
  SELECT 
    `state_name`,
    'Census_Tract' AS Level,
    `count_qualified`,
    `percent_covered`,
    `percent_qualified`,
    `number_of_panels_total`,
    `kw_total`,
    `yearly_sunlight_kwh_total`,
    `carbon_offset_metric_tons`,
    `existing_installs_count`
  FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
) AS combined_data
GROUP BY state_name, Level
ORDER BY state_name, Level;
2025-01-24 23:42:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 23:42:22 - root - INFO - ```sql
SELECT
  state_name AS State_Name,
  Level,
  SUM(count_qualified) AS Number_of_Buildings_Available,
  ROUND(SUM(percent_covered * count_qualified) / SUM(count_qualified), 4) AS Percentage_Covered_by_Sunroof,
  ROUND(SUM(percent_qualified * count_qualified) / SUM(count_qualified), 4) AS Percentage_Suitable_for_Solar,
  SUM(number_of_panels_total) AS Total_Potential_Panel_Count,
  ROUND(SUM(kw_total), 4) AS Total_Kilowatt_Capacity,
  ROUND(SUM(yearly_sunlight_kwh_total), 4) AS Energy_Generation_Potential,
  ROUND(SUM(carbon_offset_metric_tons), 4) AS Carbon_Dioxide_Offset,
  SUM(count_qualified - existing_installs_count) AS Gap_in_Potential_Installations
FROM (
  SELECT 
    `state_name`,
    'Postal_Code' AS Level,
    `count_qualified`,
    `percent_covered`,
    `percent_qualified`,
    `number_of_panels_total`,
    `kw_total`,
    `yearly_sunlight_kwh_total`,
    `carbon_offset_metric_tons`,
    `existing_installs_count`
  FROM `bigquery-public-data.sunroof_solar.solar_potential_by_postal_code`
  UNION ALL
  SELECT 
    `state_name`,
    'Census_Tract' AS Level,
    `count_qualified`,
    `percent_covered`,
    `percent_qualified`,
    `number_of_panels_total`,
    `kw_total`,
    `yearly_sunlight_kwh_total`,
    `carbon_offset_metric_tons`,
    `existing_installs_count`
  FROM `bigquery-public-data.sunroof_solar.solar_potential_by_censustract`
) AS combined_data
GROUP BY state_name, Level
ORDER BY state_name, Level;
```
2025-01-24 23:42:24 - root - INFO - itercount: 3
2025-01-24 23:42:24 - root - INFO - 0
2025-01-24 23:42:24 - root - INFO - Total iteration counts: 3
