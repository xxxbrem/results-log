2025-01-27 21:46:17 - openai._base_client - INFO - Retrying request to /chat/completions in 0.391987 seconds
2025-01-27 21:46:46 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 21:46:46 - root - INFO - SQL:
-- Query 1: Get distinct order statuses
SELECT DISTINCT "order_status"
FROM "olist_orders"
LIMIT 100
Results:
order_status
delivered
invoiced
shipped
processing
unavailable
canceled
created
approved

2025-01-27 21:46:46 - root - INFO - SQL:
-- Query 2: Count of orders per order status
SELECT "order_status", COUNT(*) as "order_count"
FROM "olist_orders"
GROUP BY "order_status"
LIMIT 100
Results:
order_status,order_count
approved,2
canceled,625
created,5
delivered,96478
invoiced,314
processing,301
shipped,1107
unavailable,609

2025-01-27 21:46:46 - root - INFO - SQL:
-- Query 3: List of unique customers
SELECT DISTINCT "customer_unique_id"
FROM "olist_customers"
LIMIT 100
Results:
customer_unique_id
861eff4711a542e4b93843c6dd7febb0
290c77bc529b7ac935b93aa66c333dc3
060e732b5b29e8181a18229c7b0b2b5e
259dac757896d24d7702b9acbbff3f3c
345ecd01c38d18a9036ed96c73b8d066
4c93744516667ad3b8f1fb645a3116a4
addec96d2e059c80c30fe6871d30d177
57b2a98a409812fe9618067b6b8ebe4f
1175e95fb47ddff9de6b2b06188f7e0d
9afe194fb833f79e300e37e580171f22
2a7745e1ed516b289ed9b29c7d0539a5
2a46fb94aef5cbeeb850418118cee090
918dc87cd72cd9f6ed4bd442ed785235
295c05e81917928d76245e842748184d
3151a81801c8386361b62277d7fa5ecf
21f748a16f4e1688a9014eb3ee6fa325
5c2991dbd08bbf3cf410713c4de5a0b5
b6e99561fe6f34a55b0b7da92f8ed775
7f3a72e8f988c6e735ba118d54f47458
3e6fd6b2f0d499456a6a6820a40f2d79
e607ede0e63436308660236f5a52da5e
a96d5cfa0d3181817e2b946f921ea021
482441ea6a06b1f72fe9784756c0ea75
4390ddbb6276a66ff1736a6710205dca
a5844ba4bfc8d0cc61d13027c7e63bcc
5f102dd37243f152aec3607970aad100
9c0096673baf55453a50073f12d1a37f
2e6a42a9b5cbb0da62988694f18ee295
4d221875624017bc47b4d1ce7314a5b7
a8654e2af5da6bb72f52c22b164855e1
424aca6872c5bab80780a8dec03b7516
bf4862777db128507e9efcc789215e9b
e9dd12dca17352644a959d9dea133935
e079b18794454de9d2be5c12b4392294
ef07ba9aa5226f77264ffa5762b2280b
85d234692f7bee8d6fea586e237334b6
fe3634ccefbcdb0537b45fd589e32e8e
40febde16f4718a5def537786473b0be
07d190f123147d9e89d4b922543d7948
dd992305cba295d997f263dbdf4e8c2e
86085586aaa8c5f47ed0b400da64c59d
5ad58a4e6a1a656b6bed070cadbaa003
c9158d089637ab443c78984d20da7fc0
66cc90195ca44cc7ac6a1cd0e1e1e7b2
91ec50a00ae74d0a229d2efdf4344e1e
d251c190ca75786e9ab937982d60d1d4
233896de79986082f1f479f1f85281cb
a8ae36a2bb6c2bbc3b5d62ede131c9ef
8d46223c91cbeb93e0930ca8bd8ffca2
e021e698833bdeb89dfef3acb2e91f37
27cf4b153010911a0957150255a6c6db
7ce5b57a120a2da6a804afa58ffcbfb5
d33eeadf54cb883e79be640f38c32cdc
3da7750bf3c1dbd724624a60a9f5942b
d85547cd859833520b311b4458a14c1c
3af0b2f7654f613ff1527b997a2ac57e
3d49f4455a3947c8dd7e972b3ad8cb76
b03e9d9818ee170e9d6b983803c7d406
a302a693d5722d95984e6472150b9391
c80da60feddb7cf8325bd104032e314a
a2b8841410cf77619574d311cd06fd5e
7677c213007e9a6ec9267ea50b5ce5bc
0c17f9ac28cbd7323f0f4043e9db5907
332cf4e83e16004ba7dca932ce82475b
0d516ca029d6a28d5cfddd80b27a26dc
b3548d0cec408ae13d143bb4eeebaa6c
c3293e875ffb1116018edf76d24e52a2
d89e05e2d23c3d8247aeecd07758004b
dad5018ffc0de85eb72f72575b552784
95700615deef776ed32faa08f0be634e
b157c176c3fe04914fde33f2dc8b878a
d4397835ae287e492b186d497099439a
76b029c87118a29f2e3de420f5ec2fa2
7eaa86786b5955ab188db287f4726d79
b436a108536c1dabbc1d3e808d782df9
cd076285a12f40041b32f5ad8c98699f
cf6d4152d758efc43910e0141ae5b912
468d559ef2dcd2bea6d8db78959fb90f
7556f182460418cf30957e6ce377c674
e5dbefdfdf3eff75c8e6cd655f128279
67d21c8bea9d6017d1b124d3879dd815
fd2d5fdb84e65fa6b54b98b0e2df5645
d491a65a6ef3c04e145d37395996bad7
6edd17d0a29e2d4057e694afee5eaa3b
bf6e263ffc1f89999827615522b0aa45
6d3f61e35d0422fd8cae65b1798784be
a9a77b4e25980b7ca58cb71f878abb27
eca666aec08df69fe31aa9a11d4a3302
7a380cb5434e6b6b5b37d45bb99dbe8a
463093247faa080167d77f2e6d1b297d
914b142462685e3161cf3a9f4152a028
e235442a956c524e6c141141171f5801
4a4de987b37555970ffcc9608d858a72
44e9a1246448bd68a2e3bf0f1966c57a
b4d6e1b900d99b52e901860bc1f44e35
809353196a0456095716566dd226bb48
9e1f719fe5b17b9c51905fee6d6385c1
94b731a41867b47c3856e324840c4c99
694cb45ff29b603ac2acd51016770097
9dbb05f5577e862337b93feb8f358839

2025-01-27 21:46:46 - root - INFO - SQL:
-- Query 4: Mapping of customer_id to customer_unique_id
SELECT "customer_id", "customer_unique_id"
FROM "olist_customers"
LIMIT 100
Results:
Too long, hard cut:
customer_id,customer_unique_id
06b8999e2fba1a1fbc88172c00ba8bc7,861eff4711a542e4b93843c6dd7febb0
18955e83d337fd6b2def6b18a428ac77,290c77bc529b7ac935b93aa66c333dc3
4e7b3e00288586ebd08712fdd0374a03,060e732b5b29e8181a18229c7b0b2b5e
b2b6027bc5c5109e529d4dc6358b12c3,259dac757896d24d7702b9acbbff3f3c
4f2d8ab171c80ec8364f7c12e35b23ad,345ecd01c38d18a9036ed96c73b8d066
879864dab9bc3047522c92c82e1212b8,4c93744516667ad3b8f1fb645a3116a4
fd826e7cf63160e536e0908c76c3f441,addec96d2e059c80c30fe6871d30d177
5e274e7a0c3809e14aba7ad5aae0d407,57b2a98a409812fe9618067b6b8ebe4f
5adf08e34b2e993982a47070956c5c65,1175e95fb47ddff9de6b2b06188f7e0d
4b7139f34592b3a31687243a302fa75b,9afe194fb833f79e300e37e580171f22
9fb35e4ed6f0a14a4977cd9aea4042bb,2a7745e1ed516b289ed9b29c7d0539a5
5aa9e4fdd4dfd20959cad2d772509598,2a46fb94aef5cbeeb850418118cee090
b2d1536598b73a9abd18e0d75d92f0a3,918dc87cd72cd9f6ed4bd442ed785235
eabebad39a88bb6f5b52376faec28612,295c05e81917928d76245e842748184d
1f1c7bf1c9b041b292af6c1c4470b753,3151a81801c8386361b62277d7fa5ecf
206f3129c0e4d7d0b9550426023f0a08,21f748a16f4e1688a9014eb3ee6fa325
a7c125a0a07b75146167b7f04a7f8e98,5c2991dbd08bbf3cf410713c4de5a0b5
c5c61596a3b6bd0cee5766992c48a9a1,b6e99561fe6f34a55b0b7da92f8ed775
9b8ce803689b3562defaad4613ef426f,7f3a72e8f988c6e735ba118d54f47458
49d0ea0986edde72da777f15456a0ee0,3e6fd6b2f0d499456a6a6820a40f2d79
154c4ded6991bdfa3cd249d11abf4130,e607ede0e63436308660236f5a52da5e
690172ab319622688d3b4df42f676898,a96d5cfa0d3181817e2b946f921ea021
2938121a40a20953c43caa8c98787fcb,482441ea6a06b1f72fe9784756c0ea75
237098a64674ae89babdc426746260fc,4390ddbb6276a66ff1736a6710205dca
cb721d7b4f271fd87011c4c83462c076,a5844ba4bfc8d0cc61d13027c7e63bcc
f681356046d9fde60e70c73a18d65ea2,5f102dd37243f152aec3607970aad100
167bd30a409e3e4127df5a9408ebd394,9c0096673baf55453a50073f12d1a37f
6e359a57a91f84095cc64e1b351aef8c,2e6a42a9b5cbb0da62988694f18ee295
e0eea8f69a457b3f1fa246e44c9ebefd,4d221875624017bc47b4d1ce7314a5b7
e3109970a3fe8021d5ff82c577ce5606,a8654e2af5da6bb72f52c22b164855e1
261cb4f92498ca05d5bd1a327a261d9c,424aca6872c5bab80780a8dec03b7516
6f92779347724b67e44e3224f3b4cffd,bf4862777db128507e9efcc789215e9b
2d5831cb2dff7cdefba62e950ae3dc7b,e9dd12dca17352644a959d9dea133935
b2bed119388167a954382cca36c4777f,e079b18794454de9d2be5c12b4392294
469634941c27cd844170935a3cf60b95,ef07ba9aa5226f77264ffa5762b2280b
df0aa5b8586495e0ddf6b601122e43a1,85d234692f7bee8d6fea586e237334b6
41c8f4b570869791379a925899a6af8a,fe3634ccefbcdb0537b45fd589e32e8e
54f755c3fd2709231f9964a1430c5218,40febde16f4718a5def537786473b0be
4c06b42fbf7b97ab10779cda5549cd1c,07d190f123147d9e89d4b922543d7948
b6368ca0f56d4632f44d58ca431487b2,dd992305cba295d997f263dbdf4e8c2e
4a0e66fd30684aa1409cd1b66fec77cc,86085586aaa8c5f47ed0b400da64c59d
c168abb9077b7821adae01dc1f0886c5,5ad58a4e6a1a656b6bed070cadbaa003
a3b0fda37bae14cf754877bed475e80c,c9158d089637ab443c78984d20da7fc0
0ccd415657ae8a6cd1c71b00155a019e,66cc90195ca44cc7ac6a1cd0e1e1e7b2
c532a74a3ebf1bacce2e2bcce3783317,91ec50a00ae74d0a229d2efdf4344e1e
19cecb194f54e614b70d971306a9931b,d251c190ca75786e9ab937982d60d1d4
f34a6e874087ec1f0e3dab9fdf659c5d,233896de79986082f1f479f1f85281cb
c132855c926907970dcf6f2bf0b33a24,a8ae36a2bb6c2bbc3b5d62ede131c9ef
df85b96ba2ce3e49bde101b1614f52ac,8d46223c91cbeb93e0930ca8bd8ffca2
4d27341acd30a36bca39008ee9bb9050,e021e698833bdeb89dfef3acb2e91f37
d3b6830d18c7de943d1e707d1f061d40,27cf4b153010911a0957150255a6c6db
79de53946db384e2d7a9bd131792ad17,7ce5b57a120a2da6a804afa58ffcbfb5
a562ab1e728449e3461829dfe2e36f73,d33eeadf54cb883e79be640f38c32cdc
b64ed91eab98972150bdaf77ca921934,3da7750bf3c1dbd724624a60a9f5942b
8247b5583327ab8be19f96e1fb82f77b,d85547cd859833520b311b4458a14c1c
8fcaa9368903f3a9a28aeaff28c14638,3af0b2f7654f613ff1527b997a2ac57e
a9b0d1c26105279e1b8edc63d06bd668,3d49f4455a3947c8dd7e972b3ad8cb76
aa9f03ecd3728c9bd12e6d962c66c7cb,b03e9d9818ee170e9d6b983803c7d406
230c0d740401730c7197d16376893525,a302a693d5722d95984e6472150b9391
a905baa530258422594f1b05615bd225,c80da60feddb7cf8325bd104032e314a
4fa19f7da692e6bf9602aaad3c372eda,a2b8841410cf77619574d311cd06fd5e
03f846ad03437d864a8d2a22976dcafe,7677c213007e9a6ec9267ea50b5ce5bc
de4e13fd7d6469c5ada77d0843c55e42,0c17f9ac28cbd7323f0f4043e9db5907
8276de07ef25225d412b8462d73f8664,332cf4e83e16004ba7dca932ce82475b
cc32707d2e2f7c92ab449f9b28154809,0d516ca029d6a28d5cfddd80b27a26dc
a02f66c3af7b16eec19ddcd98b645fe3,b3548d0cec408ae13d143bb4eeebaa6c
26acee41e2f75689a5615892f06ea0bd,c3293e875ffb1116018edf76d24e52a2
f64cdee66599119324ce57a97e43700d,d89e05e2d23c3d8247aeecd07758004b
7ab7a537b678b6dd73d825ff6ee7be9d,dad5018ffc0de85eb72f72575b552784
7300450cedf7e4c35c243c4a03c1e8a6,95700615deef776ed32faa08f0be634e
4c7241af24b5344cb01fe687643de4fe,b157c176c3fe04914fde33f2dc8b878a
97e126f19a6f04b3462619f36862bcd2,d4397835ae287e492b186d497099439a
6d27a9361e591da38c87a5e70253f3f2,76b029c87118a29f2e3de420f5ec2fa2
6810c3dc47f641181fcc7f73275c3d19,7eaa86786b5955ab188db287f4726d79
b514422efcf14bef34858a0829bef189,b436a108536c1dabbc1d3e808d782df9
0aae2862f8eac77f10a

2025-01-27 21:46:46 - root - INFO - SQL:
-- Query 5: Orders with 'delivered' status
SELECT "order_id", "customer_id", "order_status"
FROM "olist_orders"
WHERE "order_status" = 'delivered'
LIMIT 100
Results:
Too long, hard cut:
order_id,customer_id,order_status
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,delivered
53cdb2fc8bc7dce0b6741e2150273451,b0830fb4747a6c6d20dea0b8c802d7ef,delivered
47770eb9100c2d0c44946d9cf07ec65d,41ce2a54c0b03bf3443c3d931a367089,delivered
949d5b44dbf5de918fe9c16f97b45f8a,f88197465ea7920adcdbec7375364d82,delivered
ad21c59c0840e6cb83a9ceb5573f8159,8ab97904e6daea8866dbdbc4fb7aad2c,delivered
a4591c265e18cb1dcee52889e2d8acc3,503740e9ca751ccdda7ba28e9ab8f608,delivered
6514b8ad8028c9f2cc2374ded245783f,9bdf08b4b3b52b5526ff42d37d47f222,delivered
76c6e866289321a7c93b82b54852dc33,f54a9f0e6b351c431402b8461ea51999,delivered
e69bfb5eb88e0ed6a785585b27e16dbf,31ad1d1b63eb9962463f764d4e6e0c9d,delivered
e6ce16cb79ec1d90b1da9085a6118aeb,494dded5b201313c64ed7f100595b95c,delivered
34513ce0c4fab462a55830c0989c7edb,7711cf624183d843aafe81855097bc37,delivered
82566a660a982b15fb86e904c8d32918,d3e3b74c766bc6214e0c830b17ee2341,delivered
5ff96c15d0b717ac6ad1f3d77225a350,19402a48fe860416adf93348aba37740,delivered
432aaf21d85167c2c86ec9448c4e42cc,3df704f53d3f1d4818840b34ec672a9f,delivered
dcb36b511fcac050b97cd5c05de84dc3,3b6828a50ffe546942b7a473d70ac0fc,delivered
403b97836b0c04a622354cf531062e5f,738b086814c6fcc74b8cc583f8516ee3,delivered
116f0b09343b49556bbad5f35bee0cdf,3187789bec990987628d7a9beb4dd6ac,delivered
85ce859fd6dc634de8d2f1e290444043,059f7fc5719c7da6cbafe370971a8d70,delivered
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,delivered
203096f03d82e0dffbc41ebc2e2bcfb7,d2b091571da224a1b36412c18bc3bbfe,delivered
f848643eec1d69395095eb3840d2051e,4fa1cd166fa598be6de80fa84eaade43,delivered
2807d0e504d6d4894d41672727bc139f,72ae281627a6102d9b3718528b420f8a,delivered
95266dbfb7e20354baba07964dac78d5,a166da34890074091a942054b36e4265,delivered
f3e7c359154d965827355f39d6b1fdac,62b423aab58096ca514ba6aa06be2f98,delivered
fbf9ac61453ac646ce8ad9783d7d0af6,3a874b4d4c4b6543206ff5d89287f0c3,delivered
acce194856392f074dbf9dada14d8d82,7e20bf5ca92da68200643bda76c504c6,delivered
dd78f560c270f1909639c11b925620ea,8b212b9525f9e74e85e37ed6df37693e,delivered
91b2a010e1e45e6ba3d133fa997597be,cce89a605105b148387c52e286ac8335,delivered
ecab90c9933c58908d3d6add7c6f5ae3,761df82feda9778854c6dafdaeb567e4,delivered
f70a0aff17df5a6cdd9a7196128bd354,456dc10730fbdba34615447ea195d643,delivered
1790eea0b567cf50911c057cf20f90f9,52142aa69d8d0e1247ab0cada0f76023,delivered
989225ba6d0ebd5873335f7e01de2ae7,816f8653d5361cbf94e58c33f2502a5c,delivered
d887b52c6516beb39e8cd44a5f8b60f7,d9ef95f98d8da3b492bb8c0447910498,delivered
b276e4f8c0fb86bd82fce576f21713e0,cf8ffeddf027932e51e4eae73b384059,delivered
8563039e855156e48fccee4d611a3196,5f16605299d698660e0606f7eae2d2f9,delivered
60550084e6b4c0cb89a87df1f3e5ebd9,f5458ddc3545711efa883dd7ae7c4497,delivered
5acce57f8d9dfd55fa48e212a641a69d,295ae9b35379e077273387ff64354b6f,delivered
434d158e96bdd6972ad6e6d73ddcfd22,2a1dfb647f32f4390e7b857c67458536,delivered
7206b86ea789983f7a273ea7fa0bc2a8,3391c4bc11a817e7973e498b0b023158,delivered
1e7aff52cdbb2451ace09d0f848c3699,ddaff536587109b89777e0353215e150,delivered
6ea2f835b4556291ffdc53fa0b3b95e8,c7340080e394356141681bd4c9b8fe31,delivered
948097deef559c742e7ce321e5e58919,8644be24d48806bc3a88fd59fb47ceb1,delivered
d22e9fa5731b9e30e8b27afcdc2f8563,756fb9391752dad934e0fe3733378e57,delivered
6ebaec694d7025e2ad4a05dba887c032,4f28355e5c17a4a42d3ce2439a1d4501,delivered
d17dc4a904426827ca80f2ccb3a6be56,569cf68214806a39acc0f39344aea67f,delivered
25f4376934e13d3508486352e11a5db0,12fd2740039676063a874b9567dfa651,delivered
5820a1100976432c7968a52da59e9364,2b56e94c2f66f2d97cfa63356f69cee8,delivered
2ce1ad82022c1ba30c2079502ac725aa,7f2178c5d771e17f507d3c1637339298,delivered
138849fd84dff2fb4ca70a0a34c4aa1c,9b18f3fc296990b97854e351334a32f6,delivered
47aa4816b27ba60ec948cd019cc1afc1,148348ff65384b4249b762579532e248,delivered
9faeb9b2746b9d7526aef5acb08e2aa0,79183cd650e2bb0d475b0067d45946ac,delivered
641fb0752bf5b5940c376b3a8bb9dc52,f5afca14dfa9dc64251cf2b45c54c363,delivered
e425680f760cbc130be3e53a9773c584,f178c1827f67a8467b0385b7378d951a,delivered
40c5e18f7d112b59b3e5113a59a905b3,67407057a7d5ee17d1cd09523f484d13,delivered
734e7d1bbaeb2ff82521ca0fe6fb6f79,2932d241d1f31e6df6c701d52370ae02,delivered
66e4624ae69e7dc89bd50222b59f581f,684fa6da5134b9e4dab731e00011712d,delivered
a685d016c8a26f71a0bb67821070e398,911e4c37f5cafe1604fe6767034bf1ae,delivered
2edfd6d1f0b4cd0db4bf37b1b224d855,241e78de29b3090cfa1b5d73a8130c72,delivered
68873cf91053cd11e6b49a766db5af1a,4632eb5a8f175f6fe020520ae0c678f3,delivered
f346ad4ee8f630e5e4ddaf862a34e6dd,dd5095632e3953fc0947b8ab5176b0be,delivered
8f06cc6465925031568537b815f1198d,9916715c2ab6ee1710c9c32f0a534ad2,delivered
ccbabeb0b02433bd0fcbac46e70339f2,c77ee2d8ba1614a4d489a44166894938,delivered
688052146432ef8253587b930b01a06d,81e08b08e5ed4472008030d70327c71f,delivered
f271576bed568e896f99eb710cd3a6f8,5dda11942d4f77bee3a46d71e442aec4,delivered
686541986ecfb7d9296eb67719973bf0,74805bc388861fa350ed2fade8444e0b,delivered
68e48e68da1f50f7c5838ea75e

2025-01-27 21:46:46 - root - INFO - SQL:
-- Query 6: Payment values for each order
SELECT "order_id", "payment_value"
FROM "olist_order_payments"
LIMIT 100
Results:
order_id,payment_value
b81ef226f3fe1789b1e8b2acac839d17,99.33
a9810da82917af2d9aefd1278f1dcfa0,24.39
25e8ea4e93396b6fa0d3dd708e76c1bd,65.71
ba78997921bbcdc1373bb41e913ab953,107.78
42fdf880ba16b47b59251dd489d4441a,128.45
298fcdf1f73eb413e4d26d01b25bc1cd,96.12
771ee386b001f06208a7419e4fc1bbd7,81.16
3d7239c394a212faae122962df514ac7,51.84
1f78449c87a54faf9e96e88ba1491fa9,341.09
0573b5e23cbd798006520e1d5b4c6714,51.95
d88e0d5fa41661ce03cf6cf336527646,188.73
2480f727e869fdeb397244a21b721b67,141.9
616105c9352a9668c38303ad44e056cd,75.78
cf95215a722f3ebf29e6bbab87a29e61,102.66
769214176682788a92801d8907fa1b40,105.28
12e5cfe0e4716b59afb0e0f4a3bd6570,157.45
61059985a6fc0ad64e95d9944caacdad,132.04
79da3f5fe31ad1e454f06f95dc032ad5,98.94
8ac09207f415d55acff302df7d6a895c,244.15
b2349a3f20dfbeef62e7b31baa22f84b,136.71
5a1f6d22f7dfb061ef29216b9af687a1,47.69
4214cda550ece8ee66441f459dc33a8c,170.57
adfbf6c2a620196f9a3ec747491c72b7,67.5
4d680edbaa7d3d9bed69532957368a03,353.09
8cd68144cdb62dc0d60848cf8616d2a4,330.66
5cfd514482e22bc992e7693f0e3e8df7,45.17
d0a945f85ba1074b60aac97ade7e240e,541.0
c39414c195d0f94c9d9c35e7c6ed4f1a,139.22
5d9c5817e278892b7498d90bfa28ade8,290.16
b69b9260e79a0da00e15f48de1bd2524,283.34
f45074ae38f2e01d9b854ec8d40362ff,13.78
81cedc4d2132eb6f512354166e51b187,30.28
595f598849d89203c28d05d0fbf3f92e,26.58
f9d0ec2fa088ac583e1ccd15b6686073,89.68
e647bf617de735448a4ba54f8910393c,65.09
b2bb080b6bc860118a246fd9b6fad6da,173.84
23f10f509600c30cf2852f9dbdf28fc3,103.49
f86f6472fa9f395d8d9a6751ca118afb,64.03
1dcf0c8cd36ffaf57784fbdc90079310,157.15
00d8d65b666158b633f96054d31af43b,130.88
cf30fe76d1505192acee1c6dccb15545,47.72
d3e774a185c0b1b2286ffd6c70abe2e6,117.74
32b1d8f3789a57f1f752e20ac7404b4c,56.6
c10d412026c4077b8e83acf0fea04eee,266.16
56c3277583e16009c925fdf116df420f,31.38
0e0441786430b7cfcd0d91f822ea4c99,121.49
6ffb3f1686bceae3466facf7e02ce3fb,32.0
afef48d3c8a0b1b7c9b7f8f922fb5674,153.41
c0db7d31ace61fc360a3eaa34dd3457c,65.71
d574338f566ca28dd67820f48ec1f1d8,278.22
1807cc736321f14baa58ef39cf6e5989,91.66
e8977f709bbb0367f51b589e6325f991,132.51
2e2c60b99754ae1e4d8b18846cfec9f2,542.66
1ffb3c1929b16d9c1aec1958e11b3e9b,166.04
95442deb81a5d91c97c0df96b431634a,368.98
10af96a0689260134307879127ac1952,113.2
85eef2d342b0de363c45c1bc324729c5,99.43
aa964845f1de8125410aea8b73e9e1ec,27.35
343348b1e29e9fa9e7b6ab1027f9177d,43.77
ad4098a257676ea4d394fb3bbbf36ca3,68.49
3e0c3cab458e8b3cc8d1d38ecb7e7775,105.53
3ab4eea6776259ae8dfbabaeffece352,387.8
10d9871bed9fb8d0887d3b9022edd1ff,84.14
c108072ab31ec90a754129c171577f5f,210.82
fc662bafa52d2ef16078f6f6141009d6,90.05
4217849b1ff18a9270fe048eabc4dc45,67.88
795c16acb4e3c30dfa5b6827727ef488,37.58
55e2d723733c45033e71cb4d44690234,89.63
947e9c6bfd83a06953c420ef92d3da6e,69.46
60e43c5f5ba559d9dd19357ed72cb2f2,78.3
e3e9e3295f4e1512167c232a0aaae8a5,50.8
460d57443ffdcaeba240360239747cf7,34.0
4cb51127f19f7254b320efe1718477dd,77.1
110d9355d6338eab0a65a0cacdde5434,566.4
42f5954cda381bd032934ee38c453711,402.42
3689194c14ad4e2e7361ebd1df0e77b0,57.53
97c111c4f22dfa1089a9c0b5338dcc79,44.01
4b2d035932915aa9c2a0d4d84cd6d3b0,187.51
e1b4ee0e390fbac1dec439d72b45a115,77.7
fee72a68ce935ebf2939fe72f27d3d9b,48.68
4d3bfdf4c7d6578ea445d588371ae10e,77.29
4c2e1a95586c815795a324d1599e7b5a,117.71
c9f23db8a1cb725df9bdb3383bd72b38,169.34
8e47a04b25d7a7075064e8e0bd2e0318,37.61
723e462ce1ee50e024887c0b403130f3,13.8
fa2ea4b6e84c1c0fc4f3a6d468c55183,227.12
fb1a2a1296f822405a946cbdfc0d3ed6,34.78
198298d54f269d8c5fe89e85a859af61,342.56
b19ca559688b49e8cf7f88c1aa3f0009,73.34
5be8d4719fe2e3669e2d07dddf3b6b0c,117.85
4a02e985c7239d866a632f07ed20d9c0,48.62
3e17eef8a8bd0131c7aed90d7508799e,53.99
f8d323a2702fed37f0229965f7e9f8b3,51.14
de4090fd9b7900d46323b0c7c36b7128,121.45
17e5131fe1d4b1a8dc14d4a66914f9d7,73.34
20f136d890c31a62486c809f91a5b098,117.68
557cc2675910c4a6c9b54ad276f25097,56.77
d60a89ab9bc1e68834465ae630c3343e,115.59
3ba2d0012b1f34bc6ccbc31c4ba69f93,60.07
d46f45b0d795bcf47a19d301710e63fe,27.27

2025-01-27 21:46:46 - root - INFO - SQL:
-- Query 7: Total payment per order_id
SELECT "order_id", SUM("payment_value") as "total_payment"
FROM "olist_order_payments"
GROUP BY "order_id"
LIMIT 100
Results:
order_id,total_payment
00010242fe8c5a6d1ba2dd792cb16214,72.19
00018f77f2f0320c557190d7a144bdd3,259.83
000229ec398224ef6ca0657da4fc703e,216.87
00024acbcdf0a6daa1e931b038114c75,25.78
00042b26cf59d7ce69dfabb4e55b4fd9,218.04
00048cc3ae777c65dbb7d2a0634bc1ea,34.59
00054e8431b9d7675808bcb819fb4a32,31.75
000576fe39319847cbb9d288c5617fa6,880.75
0005a1a1728c9d785b8e2b08b904576c,157.6
0005f50442cb953dcd1d21e1fb923495,65.39
00061f2a7bc09da83e415a52dc8a4af1,68.87
00063b381e2406b52ad429470734ebd5,57.98
0006ec9db01a64e59a68b2c340bf65a7,97.32
0008288aa423d2a3f00fcb17cd7d8719,126.54
0009792311464db532ff765bf7b182ae,127.55
0009c9a17f916a706d71784483a5d643,650.34
000aed2e25dbad2f9ddb70584c5a2ded,152.77
000c3e6612759851cc3cbb4b83257986,112.71
000e562887b1f2006d75e0be9558292e,41.11
000e63d38ae8c00bbcb5a30573b99628,56.78
000e906b789b55f64edcb1f84030f90d,33.84
000f25f4d72195062c040b12dce9a18a,164.39
001021efaa8636c29475e7734483457d,64.1
0010b2e5201cc5f1ae7e9c6cc8f5bd00,65.5
0010dedd556712d7bb69a19cb7bbd37a,111.12
00119ff934e539cf26f92b9ef0cdfed8,236.88
0011d82c4b53e22e84023405fb467e57,315.33
00125cb692d04887809806618a2a145f,135.41
00130c0eee84a3d909e75bc08c5c3ca1,35.84
0013503b13da1eac686219390b7d641b,137.22
00137e170939bba5a3134e2386413108,421.65
001427c0ec99cf8af737bd88e92fd444,83.25
00143d0f86d6fbd9f9b38ab440ac16f5,109.29
0014ae671de39511f7575066200733b7,30.6
0015ebb40fb17286bea51d4607c4733c,37.0
00169e31ef4b29deaae414f9a5e95929,55.11
0016dfedd97fc2950e388d2971d718c7,70.55000000000001
0017afd5076e074a48f1f1a4c7bac9c5,853.39
001862358bf858722e1e2ae000cfed8b,113.71
0019c29108428acffd089c36103c9440,79.85
001ab0a7578dd66cd4b0a71f5b6e1e41,127.56
001ac194d4a326a6fa99b581e9a3d963,62.54
001b76dd48a5b1eee3e87778daa40df8,95.0
001c85b5f68d2be0cb0797afc9e8ce9a,112.71
001d8f0e34a38c37f7dba2a37d4eba8b,53.54
001daeb0eddc45b999bad0801ad9d273,55.12
001dbc16dc51075e987543d23a0507c7,87.9
001e7ba991be1b19605ca0316e7130f9,213.21
001e7cf2ad6bef3ade12ebc56ceaf0f3,51.1
0020262c8a370bd5a174ea6a2a267321,100.55
0020a222f55eb79a372d0efee3cca688,45.09
002175704e8b209f61b9ad5cfd92b60e,123.11
00229e4e43f7a7e0b9dd819ad43268d3,91.39
0025081dcf9330f9a5052ae82c6ce396,33.18
00254baeb6c932b0a8aeead91fbd02b5,193.01
00259a44fcad3fc0474329e925d14fc3,34.09
0025c5d1a8ca53a240ec2634bb4492ea,419.39
002611a77fe03d076285fd4ca95db77c,156.75
002691433f09002ac9ca0c4e8dbb8ead,120.43
0026a368634b6e6f34f33b1499773a30,164.8
00275bce676303c3bfd7292aefdfa223,293.36
00276d5c3491fbf55305e26891040df9,68.12
002834535f7a609a5c68266f173fa59e,57.17
0028de0ca693a1bb26448916a81105cc,45.3
002955b0acc63d04f6724a31967e82bd,135.59
0029c5db35ef291ce99d1262012e7daa,514.37
0029f17cf0e7640c5cb6825af681303f,113.44
002af7fa9eb99d1456bceb6a13d6fc0b,109.45
002b430ff89b3a24c31a1170acbbedea,265.55
002b4e6fa42cd4a22cc86abc18fe9c05,119.57
002c9def9c9b951b1bec6d50753c9891,173.8
002d040018d12a3853c059f7f23ab5b1,169.84
002f16b7bc4530031b7d90f791b12d8a,284.13
002f19a65a2ddd70a090297872e6d64e,77.28999999999999
002f98c0f7efd42638ed6100ca699b42,93.62
0030d783f979fbc5981e75613b057344,78.27
0030ff924c38549807645976adeef2c0,292.24
00310b0c75bb13015ec4d82d341865a4,55.28
00324b3eda39ba5ecce3945823e3594c,110.07
0032d07457ae9c806c79368d7d9ce96b,186.19
003324c70b19a16798817b2b3640e721,234.7
00335b686d693c7d72deeb12f8e89227,80.79
00335f75ea6a4455b524a8dd177067f5,177.01
00337fe25a3780b3424d9ad7c5a4b35e,139.68
003423b755b562962a6225a8de40d12e,261.33
00345f338696283410b7977d2e3efc89,67.34
0035246a40f520710769010f752e7507,99.11
0035c0b07126fe9c24a325216fb96064,150.44
0035e6b7ade84b3f5b86bd49814793df,34.0
0036757472ece3dde52fd4bfd929c90e,203.03
0036887767dea4bd43b1a88cd0d9477a,423.63
00378c6c981f234634c0b9d6128df6dd,52.85
003822434f91204da0a51fe4cf2aba18,175.16
0039500db36d50d7d0bfaf23723550f3,203.23
003a7f59d7e08a9c61d9e2881fe6459c,134.28
003a94f778ef8cfd50247c8c1b582257,57.98
003cc6161d7a2593f2525cce0c330d32,97.9
003d0634280ff3d1d3a54459349a6899,228.89
003d804eef0e1b856881cd18e0cc0d4c,312.74
003d9fc84ad902adf2265248b5ffe1a4,94.74

2025-01-27 21:46:53 - root - INFO - SQL:
-- Query 8: Number of delivered orders per customer_unique_id
SELECT c."customer_unique_id", COUNT(*) as "delivered_orders"
FROM "olist_orders" o
JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
WHERE o."order_status" = 'delivered'
GROUP BY c."customer_unique_id"
ORDER BY "delivered_orders" DESC
LIMIT 100
Results:
customer_unique_id,delivered_orders
8d50f5eadf50201ccdcedfb9e2ac8455,15
3e43e6105506432c953e165fb2acf44c,9
ca77025e7201e3b30c44b472ff346268,7
6469f99c1f9dfae7733b25662e7f1782,7
1b6c7548a2a1f9037c1fd3ddfed95f33,7
f0e310a6839dce9de1638e0fe5ab282a,6
dc813062e0fc23409cd255f7f53c7074,6
63cfc61cee11cbe306bff5857d00bfe4,6
47c1a3033b8b77b3ab6e109eb4d5fdf3,6
12f5d6e1cbf93dafd9dcc19095df0b3d,6
fe81bb32c243a86b2f86fbf053fe6140,5
de34b16117594161a6a89c50b289d35a,5
b4e4f24de1e8725b74e4a1f4975116ed,5
74cb1ad7e6d5674325c1f99b5ea30d82,5
5e8f38a9a1c023f3db718edcf926a2db,5
56c8638e7c058b98aae6d74d2dd6ea23,5
4e65032f1f574189fb793bac5a867bbc,5
394ac4de8f3acb14253c177f0e15bc58,5
35ecdf6858edc6427223b64804cf028e,5
f64ec6d8dd29940264cd0bbb5ecade8a,4
f34cd7fd85a1f8baff886edf09567be3,4
ec7f1811826ab04a27a92197bc40c888,4
d3359a56d96666ac0c21bb01e7a61c95,4
c8460e4251689ba205045f3ea17884a1,4
c37cc6c1a59d81460a3059744f7ada1c,4
b896655e2083a1d76b7b85df8fc86e40,4
b39dde6dd619943190a8cc9aa6db38a4,4
b2bd387fdc3cf05931f0f897d607dc88,4
b08fab27d47a1eb6deda07bfd965ad43,4
acea6bd29b8c1e3c6a8b266a8fb4475e,4
a7657330b1c135f3acd420326e335b2c,4
a73c5464692d3bc09d64e3edefae9015,4
a239b8e2fbce33780f1f1912e2ee5275,4
a1874c5550d2f0bc14cc122164603713,4
a0abd26659c9914690cbd3320d39fd96,4
9cc5a07f169a1606fd347a56683e6ea6,4
83e7958a94bd7f74a9414d8782f87628,4
795c1622cf7a53d63d324e862349d01c,4
738ffcf1017b584e9d2684b36e07469c,4
7305430719d715992b00be82af4a6aa8,4
6358b15ef7fa9b1210f1a5735cabd3d9,4
4facc2e6fbc2bffab2fea92d2b4aa7e4,4
397b44d5bb99eabf54ea9c2b41ebb905,4
2ddc001b620bd90d0f4378cfde1db887,4
25a560b9a6006157838aab1bdbd68624,4
12d8b5ed661190a3a08183644dfc504d,4
08e5b38d7948d37fbb2a59fc5e175ab1,4
ff922bdd6bafcdf99cb90d7f39cea5b3,3
fe59d5878cd80080edbd29b5a0a4e1cf,3
fd8ccc89be43894d2553494c71a61fd8,3
fc719c11b4dce594f47e1f9aa739a3a2,3
f8bc1d81f395f6239a2a5ab1b9edf1ab,3
f4d1502ace38b0df6f052a5544add9f4,3
f11821d908830e74ad782532ebed897a,3
f0fd988c7c2a4cba167138a8adada6ca,3
e9b87dccd9c326a3325385087eb0150c,3
e78838df9c44e102b6ac84cc5eea7d5c,3
e68e1b61896163cdd7f8e07b2ae814c9,3
e53fd5575f1418397aae732c5755b6fc,3
e4b98eebb8983cade8610c0def59f705,3
e3301490c373db9263c15a73172d0c6f,3
e325e139452a1ca05f5a33acedd7d94f,3
e30b83af13d6ff0b0f427b2a67c43b39,3
e2492e4188991b6276a4a62a287a5451,3
e226254ce0c6d5b7a7ef7218c9b5b518,3
e13e8b789e5a8e6fe1445f924a4ed4f6,3
e12f7f1e96f1f9f6361572028a1fad5a,3
e1224167b1a3f92781c2ff55b0b794be,3
e0c99ffdcd8891130985ac90cd2d8eec,3
e0836a97eaae86ac4adc26fbb334a527,3
e016365b624d1755f3e2d0e8f1631ebb,3
df946ef265626b1e0a425292815ddead,3
dc48b0a1b0e6abb6586f322c189f6b93,3
db07fd2ad9869f8356b1fbeefdac31e8,3
db03954a9a1cc5e71f6e0f73e81a628c,3
da2b78576894a7f95d45bfd20250cc54,3
d7624d219b6ffad980e91412174db310,3
d75acd4c5b7b4dfd32b9d9172b195419,3
d6df1c8cb71c59d9b52d828dc6d0f5b3,3
d64023c35e5c1452ce568e993ac12c86,3
d4a5e9f19897de65433c9d97bf4b9f8e,3
d44ccec15f5f86d14d6a2cfa67da1975,3
d3882d7abd0c66064d740d7ed04dd1ef,3
d387ea85dc301a91740e31360d355686,3
d26c616e241736e0c1c1ab14150239e7,3
d132b863416f85f2abb1a988ca05dd12,3
d02cbb85434c84acabb8e81bbf064d3e,3
cfa69922f9968e0e6271647abda09b09,3
cef29e793e232d30250331804cdb7000,3
cecc19ff12c206e6368dd1e9c22a848d,3
cd11a0920c498edb1da9ecd2d31aa599,3
cbd08b04b3f301152b7570da5e9c8cc4,3
ca994abc57b0bd7981d91d0061b3d8d6,3
c9b3b24308b1a4587ffa3e60fafc2b1f,3
c7c19110042036e6266adc998cbf1289,3
c76762dfb642ac154475239639f7f8f4,3
c6df3869c263531ebd51f0454a353605,3
c4fe9fc8b5e1b4f9992db983d0429854,3
c2919fbdb45366551c1e80d5cb35cd3f,3
c25d2fb6d22e04ce43c3652e3cacadad,3

2025-01-27 21:47:04 - root - INFO - SQL:
-- Query 9: Average payment value per customer_unique_id
SELECT c."customer_unique_id", AVG(p."payment_value") as "average_payment"
FROM "olist_orders" o
JOIN "olist_order_payments" p ON o."order_id" = p."order_id"
JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
WHERE o."order_status" = 'delivered'
GROUP BY c."customer_unique_id"
LIMIT 100
Results:
customer_unique_id,average_payment
0000366f3b9a7992bf8c76cfdf3221e2,141.9
0000b849f77a49e4a4ce2b2a4ca5be3f,27.19
0000f46a3911fa3c0805444483337064,86.22
0000f6ccb0745a6a4b88665a16c9f078,43.62
0004aac84e0df4da2b147fca70cf8255,196.89
0004bd2a26a76fe21f786e4fbd80607f,166.98
00050ab1314c0e55a6ca13cf7181fecf,35.38
00053a61a98854899e70ed204dd4bafe,419.18
0005e1862207bf6ccc02e4228effd9a0,150.12
0005ef4cd20d2893f0d9fbd94d3c0d97,129.76
0006fdc98a402fceb4eb0ee528f6a8d4,29.0
00082cbe03e478190aadbea78542e933,126.26
00090324bbad0e9342388303bb71ba0a,63.66
000949456b182f53c18b68d6babc79c1,82.05
000a5ad9c4601d2bbdd9ed765d5213b3,91.28
000bfa1d2f1a41876493be685390d6d3,46.85
000c8bdb58a29e7115cfc257230fb21b,29.0
000d460961d6dbfa3ec6c9f5805769e1,36.68
000de6019bb59f34c099a907c151d855,257.44
000e309254ab1fc5ba99dd469d36bdb4,39.21
000ec5bff359e1c0ad76a81a45cb598f,27.75
000ed48ceeb6f4bf8ad021a10a3c7b43,20.75
000fbf0473c10fc1ab6f8d2d286ce20c,362.38
0010a452c6d13139e50b57f19f52e04e,325.93
0010fb34b966d44409382af9e8fd5b77,61.8
001147e649a7b1afd577e873841632dd,212.16
00115fc7123b5310cf6d3a3aa932699e,76.11
0011805441c0d1b68b48002f1d005526,297.14
0011857aff0e5871ce5eb429f21cdaf5,192.83
0011c98589159d6149979563c504cb21,117.94
0012929d977a8d7280bb277c1e5f589d,155.65
0014a5a58da615f7b01a4f5e194bf5ea,99.82
0015752e079902b12cd00b9b7596276b,74.82
00172711b30d52eea8b313a7f2cced02,122.07
00191a9719ef48ebb5860b130347bf33,58.86
001926cef41060fae572e2e7b30bd2a4,91.21
001928b561575b2821c92254a2327d06,164.81
00196c4c9a3af7dd2ad10eade69c926f,37.58
00196fdb2bf9edfc35e88ebfbcf8d781,27.0
0019da6aa6bcb27cc32f1249bd12da05,87.71
0019e8c501c85848ac0966d45226fa1d,197.27
001a2bf0e46c684031af91fb2bce149d,36.73
001a34eb30ecb8e3aacb07c475ca4dd1,161.71
001a3a8e11d76c9a366c31a4aa2cc529,24.23
001ae5a1788703d64536c30362503e49,135.08
001deb796b28a3a128d6113857569aa4,63.33
001f3c4211216384d5fe59b041ce1461,35.84
002043098f10ba39a4600b6c52fbfe3c,237.81
002311514717ca8b65b09a26cdf7b91a,124.32
0023557a94bef0038066b5d1b3dc763e,107.44
002471155ecd08d208d1376720e2a907,92.18
00256bf7b05c08f6a5849df3d0a64f1f,57.73
0025795df7a7d077c4c90162fa820085,214.08
0027324a96d26a2bc7d69262f83c8403,46.78
0028a7d8db7b0247652509358ad8d755,177.435
0028cfeb9dfcd3628a56d5b6400deef5,118.2
00293787e2aec37a9c253b63fdfe2049,257.87
002aba8c1af80acacef6e011f9f23262,217.74
002ae492472e45ad6ebeb7a625409392,218.66
002b4cd83fabaffaa475f78ea5ef3e08,64.42
002bdeb33da5b1b3ce8b9c822f749c82,38.09
002cdf87d4c03f08f7eb4551a923affc,228.67
002d3bd901608f67c3fc11eaaa842b13,28.76
002d71b244beb91ca7030b15ab526446,130.56
002da6dde369f6a8b4c999ed61eb5a87,52.38
002eb8b96288f3804e21d2777ac29895,137.99
002ed12115742033f015cb3c269ccf68,109.79
002ef00822613c94613e60e03b169fef,114.04
002feefec5af0a3b26ee7839c66d205e,77.57
003035f5ec76f2220098377482de93c9,62.47
003162bf0351f47a1a247992b8b9b42d,536.6
00324c9f4d710e7bac5c5ba679714430,54.89
0032c76b20340da25249092a268ce66c,144.94
0032ca69771a7758ce643258bb9e4ac7,62.45
0033f4a2887e07e25aa1204d482f41ba,425.04
00344274804f3b8003de1b0562ae01df,226.23
0034c76b7e6a17d738375b99afc2f01e,44.23
0035029989e6fc5cf030918a5f9f2037,546.12
003650b504826ea534e02eba0ab58dd5,21.77
0036a074f98b80c4f1fc33dbbcf9c552,42.62
0036b4a3d09ad551a5188c2e374da402,162.77
0036d365b138cc0ee06bed755bcb5044,109.5
00370dfde3d012c420d29657afc2fc8b,237.0
00377a18050b898b93e2c774be9947db,65.78
0037aa56b017c105c3a9d47af71fff98,443.73
0037d2bbb9ebc39d9114aea27ee16d72,143.73
0037eb1ff742ee2e71ba887f65f3c6f3,228.79
003800162424b7b5b3d75c9cf22a66e7,107.81
00391594070baf8603f5fdc1d0c6a48c,119.32
003a5571a07dcf09bf117d13d2980ba3,181.82
003a7a8eb096ed3cbf713d2def1ca701,157.46
003ac9408252444b489b1bfc013f5f8c,36.98
003ae409f37c3c30cb1c974af3a42692,216.32
003c2067070f5b3d923235b1ea1cc17b,147.38
003c457932a554e4df13834237b1ed00,142.51
003d56767e53e08671de00da3fba8d40,178.59
003db7adfcdc49857b095a50191b6c9d,542.66
003e28cb6fab8a0901bff9229612375f,137.26
003e2af81ea3c72fbdd093f07724a4de,63.74
003f4901fdb60ae9c1e2538b84c208e1,162.79

2025-01-27 21:47:17 - root - INFO - SQL:
-- Query 10: Customer details with delivered orders and average payment
SELECT c."customer_unique_id", c."customer_city", c."customer_state",
       COUNT(*) as "delivered_orders", AVG(p."payment_value") as "average_payment"
FROM "olist_orders" o
JOIN "olist_order_payments" p ON o."order_id" = p."order_id"
JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
WHERE o."order_status" = 'delivered'
GROUP BY c."customer_unique_id", c."customer_city", c."customer_state"
ORDER BY "delivered_orders" DESC
LIMIT 100
Results:
Too long, hard cut:
customer_unique_id,customer_city,customer_state,delivered_orders,average_payment
9a736b248f67d166d2fbb006bcb877c3,sao paulo,SP,33,7.075454545454543
569aa12b73b5f7edeaa6f2a01603e381,sao paulo,SP,26,2.4107692307692306
f9ae226291893fda10af7965268fb7f6,guarulhos,SP,23,22.65521739130435
2524dcec233c3766f2c2b22f69fd65f4,tupa,SP,22,1.856818181818182
24f12460aad399ba18f4ed2c2fbab65d,campinas,SP,19,4.354210526315789
6fbc7cdadbb522125f4b27ae9dee4060,rio de janeiro,RJ,19,10.82842105263158
1d2435aa3b858d45c707c9fc25e18779,rio de janeiro,RJ,16,9.22375
25ba76039a1caff121dfcb0d66e54780,cabo frio,RJ,15,5.799333333333333
8d50f5eadf50201ccdcedfb9e2ac8455,sao paulo,SP,15,58.61799999999999
c4b224d2c784bae11ae98b6ae9f2454c,sao paulo,SP,15,49.384
1bc3d5e384c365c86cf79078f32eb495,embu-guacu,SP,14,7.183571428571428
301d1ce5a76b7e1bc47e5115bf5eb6ba,palmas,TO,14,37.825
94a19681bf6faa3c6ce3e2df1c2d97cb,sao paulo,SP,14,14.408571428571431
7293e0b38ab0dab128e6bfb7239c37ad,sao paulo,SP,13,8.25153846153846
74adf920dbd3d2e6e9f18acd88b2fd41,ubatuba,SP,13,7.863076923076926
aae867e923db95a5af878ffec19ebd8c,sao paulo,SP,13,14.37846153846154
c411c8b6dbaffd467263f87a23f2cf52,sao paulo,SP,13,16.103846153846153
024676cef113f6c81db6c5b8d29e5ee9,sao paulo,SP,12,5.298333333333333
39c7f8c4e4552af113351a650816296c,sao jose dos pinhais,PR,12,5.830833333333334
85963fd37bfd387aa6d915d8a1065486,atibaia,SP,12,73.28666666666668
90807fdb59eec2152bc977feeb6e47e7,suzano,SP,12,8.9875
db1af3fd6b23ac3873ef02619d548f9c,itaqui,RS,12,27.435000000000002
0fc594155e889688ea4477afcd26a134,ilheus,BA,11,19.12636363636363
2f8b722d3e62bb8a9860c7a29ad2b60f,sumare,SP,11,20.718181818181815
43128f4462af59091a28f9141a3ee7ba,itaborai,RJ,11,12.49818181818182
a378caa847f8b44d00411d34449359d1,sao jose dos campos,SP,11,7.006363636363636
b0f3a98136fb0e22d808f855bd430970,canoas,RS,11,13.377272727272727
c96dac240f97b3f694b804e6406af73d,cabo frio,RJ,11,7.969090909090909
ff4bb0e2cade5df30146a1d570ae777d,bom jesus dos perdoes,SP,11,28.890909090909098
1d37df739a7cdbd28609dc2954cc2c75,sao joao de meriti,RJ,10,13.799000000000001
3806104dbbc3d14c17b091b3b8e38d59,sao paulo,SP,10,15.424000000000001
afc3f49cfd0567e08a8c452beb212c04,taubate,SP,10,9.065999999999999
ed917c786a8a3e411eae87aeca27cb27,cruz alta,RS,10,28.881999999999998
0fff4016f4008007ba2bb7d63ebae39d,mogi das cruzes,SP,9,13.520000000000001
182ebbe49711dd49de4fbbdf4a999c10,sao paulo,SP,9,62.84222222222221
2eba6acde8e5a52e86f94b2c6224a986,franca,SP,9,21.008888888888887
3069f30fbf3f30057b1b4ff36c72208e,rio de janeiro,RJ,9,13.094444444444443
3e43e6105506432c953e165fb2acf44c,praia grande,SP,9,130.29555555555555
495fe7ae31686381c8145b2936e761dc,rio de janeiro,RJ,9,33.68888888888889
6bd5b501f37638859ccc1dc94cce730d,carapicuiba,SP,9,3.776666666666667
a4d4a76b47ccec27db5ea63da11debf5,salvador,BA,9,34.80333333333333
e0ff4805ba6693550d1db7d374c477c9,conselheiro lafaiete,MG,9,8.575555555555557
08d8fd00898e7cc99d6e32c74d7d3ce5,campos dos goytacazes,RJ,8,4.375
096e351116755fe4c3c1e48eaf301a41,sao paulo,SP,8,27.18625
142f18a4a7cd370e40b64f34baf14a6a,sao jose dos pinhais,PR,8,4.9399999999999995
1b6c7548a2a1f9037c1fd3ddfed95f33,ituiutaba,MG,8,119.87625000000001
311b7759da40d8d24724a882f0641308,goiania,GO,8,77.76
a52327252e5d68739d85eadb7dd461e4,franca,SP,8,21.465
aad0fb3a1680f7a08d9b8de7da72e1cc,rio de janeiro,RJ,8,12.28875
ab719d1153364ba40df26f5e44c6192a,brotas,SP,8,11.48125
c63a8c4fb13043a3fbe33bd17c69d17d,caucaia,CE,8,4.2425
f0fd988c7c2a4cba167138a8adada6ca,cansancao,BA,8,21.942500000000003
31628ac4d85d1c46ebf7dad444adcbe3,paraty,RJ,7,23.401428571428568
4532ac5f2f4f8c943a41d1ba00bd6c6d,goiania,GO,7,19.225714285714282
56437a026e07b2b2271b8742aee81fb9,indaiatuba,SP,7,39.55714285714286
58b051c30d684ac12a2049a49c856203,feira de santana,BA,7,6.67
6469f99c1f9dfae7733b25662e7f1782,santos,SP,7,108.40428571428572
6acc5385a15c441abe050fc7abda50bf,salvador,BA,7,58.62428571428571
6f35424ab0a4f25807ac4e03b155832e,rio de janeiro,RJ,7,44.25714285714286
7019c99575147f8ea1bbf0a6e281bbf9,rio de janeiro,RJ,7,22.107142857142858
7634efb2f26e897125a36155a6f92889,sao paulo,SP,7,14.448571428571428
79f3d6597edbdbed1545a11e3d2fa280,contagem,MG,7,9.557142857142859
7f6fd66526ed914998d483cff9b7bdd7,natal,RN,7,146.53
8d3a01dad8496e7c850d5b3d580c8e90,sao paulo,SP,7,9.304285714285713
90f323e9f0948ddd96c6f6a8ecc75830,tijucas,SC,7,35.028571428571425
9620623f9ea546719cb3cd99bbb879a9,paulinia,SP,7,15.831428571428573
96ce642e637cf74a0d3023db31e59d16,adamantina,SP,7,45.790000000000006
993d47c24f159f09b8904941581211b3,curitiba,PR,7,18.67142857142857
bddc05c034061c84f92fe1710bfa5fe4,sao joaquim da barra,SP,7,31.934285714285718
be74c431147c32ab2d7c7cef5e4a995f,caxias do sul,RS,7,205.20857142857145
c5610cd24fef40cd91dbc4f45183eef0,sao paulo,SP,7,9.847142857142858
ca77025e7201e3b30c44b472ff346268,recife,PE,7,160.38857142857142
cea1537ac1a5e083b8626a93f85475cc,sao vicente,SP,7,5.96
cfaec087ed620ecebc6e6f82fe276fe2,goiania,GO,7,9.892857142857142
dd162f2be22e534992b3f874cc57eda0,guaruja,SP,7,1

2025-01-27 21:47:26 - root - INFO - SQL:
-- Query 11: Top 3 customers with the most delivered orders
SELECT c."customer_unique_id", c."customer_city", c."customer_state",
       COUNT(*) as "delivered_orders"
FROM "olist_orders" o
JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
WHERE o."order_status" = 'delivered'
GROUP BY c."customer_unique_id", c."customer_city", c."customer_state"
ORDER BY "delivered_orders" DESC
LIMIT 3
Results:
customer_unique_id,customer_city,customer_state,delivered_orders
8d50f5eadf50201ccdcedfb9e2ac8455,sao paulo,SP,15
3e43e6105506432c953e165fb2acf44c,praia grande,SP,9
1b6c7548a2a1f9037c1fd3ddfed95f33,ituiutaba,MG,7

2025-01-27 21:47:44 - root - INFO - SQL:
-- Query 12: Payment details for orders of the top 3 customers
WITH top_customers AS (
  SELECT c."customer_unique_id"
  FROM "olist_orders" o
  JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
  WHERE o."order_status" = 'delivered'
  GROUP BY c."customer_unique_id"
  ORDER BY COUNT(*) DESC
  LIMIT 3
)
SELECT c."customer_unique_id", p."payment_value"
FROM "olist_orders" o
JOIN "olist_order_payments" p ON o."order_id" = p."order_id"
JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
JOIN top_customers tc ON c."customer_unique_id" = tc."customer_unique_id"
WHERE o."order_status" = 'delivered'
LIMIT 100
Results:
customer_unique_id,payment_value
8d50f5eadf50201ccdcedfb9e2ac8455,34.44
3e43e6105506432c953e165fb2acf44c,364.18
8d50f5eadf50201ccdcedfb9e2ac8455,53.38
8d50f5eadf50201ccdcedfb9e2ac8455,51.75
ca77025e7201e3b30c44b472ff346268,213.68
ca77025e7201e3b30c44b472ff346268,94.2
8d50f5eadf50201ccdcedfb9e2ac8455,38.66
3e43e6105506432c953e165fb2acf44c,115.4
8d50f5eadf50201ccdcedfb9e2ac8455,166.71
8d50f5eadf50201ccdcedfb9e2ac8455,62.95
ca77025e7201e3b30c44b472ff346268,95.56
ca77025e7201e3b30c44b472ff346268,192.12
3e43e6105506432c953e165fb2acf44c,65.1
8d50f5eadf50201ccdcedfb9e2ac8455,21.77
8d50f5eadf50201ccdcedfb9e2ac8455,21.77
3e43e6105506432c953e165fb2acf44c,130.58
3e43e6105506432c953e165fb2acf44c,98.72
3e43e6105506432c953e165fb2acf44c,76.17
8d50f5eadf50201ccdcedfb9e2ac8455,81.89
ca77025e7201e3b30c44b472ff346268,78.86
8d50f5eadf50201ccdcedfb9e2ac8455,96.4
8d50f5eadf50201ccdcedfb9e2ac8455,107.85
8d50f5eadf50201ccdcedfb9e2ac8455,51.75
3e43e6105506432c953e165fb2acf44c,65.87
ca77025e7201e3b30c44b472ff346268,159.23
8d50f5eadf50201ccdcedfb9e2ac8455,30.41
8d50f5eadf50201ccdcedfb9e2ac8455,21.77
3e43e6105506432c953e165fb2acf44c,132.95
ca77025e7201e3b30c44b472ff346268,289.07
3e43e6105506432c953e165fb2acf44c,123.69
8d50f5eadf50201ccdcedfb9e2ac8455,37.77

2025-01-27 21:48:11 - root - INFO - SQL:
-- Query 13: Average payment value for top 3 customers
WITH top_customers AS (
  SELECT c."customer_unique_id", c."customer_city", c."customer_state"
  FROM "olist_orders" o
  JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
  WHERE o."order_status" = 'delivered'
  GROUP BY c."customer_unique_id"
  ORDER BY COUNT(*) DESC
  LIMIT 3
)
SELECT tc."customer_unique_id", tc."customer_city", tc."customer_state",
       AVG(p."payment_value") as "average_payment"
FROM "olist_orders" o
JOIN "olist_order_payments" p ON o."order_id" = p."order_id"
JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
JOIN top_customers tc ON c."customer_unique_id" = tc."customer_unique_id"
WHERE o."order_status" = 'delivered'
GROUP BY tc."customer_unique_id", tc."customer_city", tc."customer_state"
LIMIT 100
Results:
customer_unique_id,customer_city,customer_state,average_payment
3e43e6105506432c953e165fb2acf44c,praia grande,SP,130.29555555555555
8d50f5eadf50201ccdcedfb9e2ac8455,sao paulo,SP,58.61799999999999
ca77025e7201e3b30c44b472ff346268,recife,PE,160.3885714285714

2025-01-27 21:48:11 - root - INFO - itercount: 0
2025-01-27 21:48:11 - root - INFO - Table: olist_customersDDL:
CREATE TABLE olist_customers (
	customer_id TEXT, 
	customer_unique_id TEXT, 
	customer_zip_code_prefix BIGINT, 
	customer_city TEXT, 
	customer_state TEXT
)
Table: olist_sellersDDL:
CREATE TABLE olist_sellers (
	seller_id TEXT, 
	seller_zip_code_prefix BIGINT, 
	seller_city TEXT, 
	seller_state TEXT
)
Table: olist_order_reviewsDDL:
CREATE TABLE olist_order_reviews (
	review_id TEXT, 
	order_id TEXT, 
	review_score BIGINT, 
	review_comment_title TEXT, 
	review_comment_message TEXT, 
	review_creation_date TEXT, 
	review_answer_timestamp TEXT
)
Table: olist_order_itemsDDL:
CREATE TABLE olist_order_items (
	order_id TEXT, 
	order_item_id BIGINT, 
	product_id TEXT, 
	seller_id TEXT, 
	shipping_limit_date TEXT, 
	price FLOAT, 
	freight_value FLOAT
)
Table: olist_productsDDL:
CREATE TABLE olist_products (
	product_id TEXT, 
	product_category_name TEXT, 
	product_name_lenght FLOAT, 
	product_description_lenght FLOAT, 
	product_photos_qty FLOAT, 
	product_weight_g FLOAT, 
	product_length_cm FLOAT, 
	product_height_cm FLOAT, 
	product_width_cm FLOAT
)
Table: olist_geolocationDDL:
CREATE TABLE olist_geolocation (
	geolocation_zip_code_prefix BIGINT, 
	geolocation_lat FLOAT, 
	geolocation_lng FLOAT, 
	geolocation_city TEXT, 
	geolocation_state TEXT
)
Table: product_category_name_translationDDL:
CREATE TABLE product_category_name_translation (
	product_category_name TEXT, 
	product_category_name_english TEXT
)
Table: olist_ordersDDL:
CREATE TABLE olist_orders (
	order_id TEXT, 
	customer_id TEXT, 
	order_status TEXT, 
	order_purchase_timestamp TEXT, 
	order_approved_at TEXT, 
	order_delivered_carrier_date TEXT, 
	order_delivered_customer_date TEXT, 
	order_estimated_delivery_date TEXT
)
Table: olist_order_paymentsDDL:
CREATE TABLE olist_order_payments (
	order_id TEXT, 
	payment_sequential BIGINT, 
	payment_type TEXT, 
	payment_installments BIGINT, 
	payment_value FLOAT
)
Table: olist_products_datasetDDL:
CREATE TABLE olist_products_dataset (
	"index" BIGINT, 
	product_id TEXT, 
	product_category_name TEXT, 
	product_name_lenght FLOAT, 
	product_description_lenght FLOAT, 
	product_photos_qty FLOAT, 
	product_weight_g FLOAT, 
	product_length_cm FLOAT, 
	product_height_cm FLOAT, 
	product_width_cm FLOAT
)
External knowledge that might be helpful: 
None
The table structure information is (table names): 
['olist_customers', 'olist_sellers', 'olist_order_reviews', 'olist_order_items', 'olist_products', 'olist_geolocation', 'product_category_name_translation', 'olist_orders', 'olist_order_payments', 'olist_products_dataset']
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **Table:** `olist_customers`
   - `customer_id`: to join with orders.
   - `customer_unique_id`: unique identifier for customers across multiple orders.
   - `customer_city`: customer's city.
   - `customer_state`: customer's state.

2. **Table:** `olist_orders`
   - `order_id`: to join with payments.
   - `customer_id`: to join with customers.
   - `order_status`: to filter for delivered orders.

3. **Table:** `olist_order_payments`
   - `order_id`: to join with orders.
   - `payment_value`: payment amount for each order.

**Potential Usage of Columns:**

- **`customer_unique_id`**: To uniquely identify customers and aggregate their orders.
- **`order_status`**: To filter orders that are delivered.
- **`payment_value`**: To calculate the average payment value per customer.
- **`customer_city`, `customer_state`**: To retrieve the location of customers.

**Conditions that may be used:**

- **`order_status = 'delivered'`**: To consider only delivered orders.

---

Below are at least 10 SQLite SQL queries from simple to complex to understand the related data:

```sql
-- Query 1: Get distinct order statuses
SELECT DISTINCT "order_status"
FROM "olist_orders"
LIMIT 100;

-- Query 2: Count of orders per order status
SELECT "order_status", COUNT(*) as "order_count"
FROM "olist_orders"
GROUP BY "order_status"
LIMIT 100;

-- Query 3: List of unique customers
SELECT DISTINCT "customer_unique_id"
FROM "olist_customers"
LIMIT 100;

-- Query 4: Mapping of customer_id to customer_unique_id
SELECT "customer_id", "customer_unique_id"
FROM "olist_customers"
LIMIT 100;

-- Query 5: Orders with 'delivered' status
SELECT "order_id", "customer_id", "order_status"
FROM "olist_orders"
WHERE "order_status" = 'delivered'
LIMIT 100;

-- Query 6: Payment values for each order
SELECT "order_id", "payment_value"
FROM "olist_order_payments"
LIMIT 100;

-- Query 7: Total payment per order_id
SELECT "order_id", SUM("payment_value") as "total_payment"
FROM "olist_order_payments"
GROUP BY "order_id"
LIMIT 100;

-- Query 8: Number of delivered orders per customer_unique_id
SELECT c."customer_unique_id", COUNT(*) as "delivered_orders"
FROM "olist_orders" o
JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
WHERE o."order_status" = 'delivered'
GROUP BY c."customer_unique_id"
ORDER BY "delivered_orders" DESC
LIMIT 100;

-- Query 9: Average payment value per customer_unique_id
SELECT c."customer_unique_id", AVG(p."payment_value") as "average_payment"
FROM "olist_orders" o
JOIN "olist_order_payments" p ON o."order_id" = p."order_id"
JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
WHERE o."order_status" = 'delivered'
GROUP BY c."customer_unique_id"
LIMIT 100;

-- Query 10: Customer details with delivered orders and average payment
SELECT c."customer_unique_id", c."customer_city", c."customer_state",
       COUNT(*) as "delivered_orders", AVG(p."payment_value") as "average_payment"
FROM "olist_orders" o
JOIN "olist_order_payments" p ON o."order_id" = p."order_id"
JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
WHERE o."order_status" = 'delivered'
GROUP BY c."customer_unique_id", c."customer_city", c."customer_state"
ORDER BY "delivered_orders" DESC
LIMIT 100;

-- Query 11: Top 3 customers with the most delivered orders
SELECT c."customer_unique_id", c."customer_city", c."customer_state",
       COUNT(*) as "delivered_orders"
FROM "olist_orders" o
JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
WHERE o."order_status" = 'delivered'
GROUP BY c."customer_unique_id", c."customer_city", c."customer_state"
ORDER BY "delivered_orders" DESC
LIMIT 3;

-- Query 12: Payment details for orders of the top 3 customers
WITH top_customers AS (
  SELECT c."customer_unique_id"
  FROM "olist_orders" o
  JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
  WHERE o."order_status" = 'delivered'
  GROUP BY c."customer_unique_id"
  ORDER BY COUNT(*) DESC
  LIMIT 3
)
SELECT c."customer_unique_id", p."payment_value"
FROM "olist_orders" o
JOIN "olist_order_payments" p ON o."order_id" = p."order_id"
JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
JOIN top_customers tc ON c."customer_unique_id" = tc."customer_unique_id"
WHERE o."order_status" = 'delivered'
LIMIT 100;

-- Query 13: Average payment value for top 3 customers
WITH top_customers AS (
  SELECT c."customer_unique_id", c."customer_city", c."customer_state"
  FROM "olist_orders" o
  JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
  WHERE o."order_status" = 'delivered'
  GROUP BY c."customer_unique_id"
  ORDER BY COUNT(*) DESC
  LIMIT 3
)
SELECT tc."customer_unique_id", tc."customer_city", tc."customer_state",
       AVG(p."payment_value") as "average_payment"
FROM "olist_orders" o
JOIN "olist_order_payments" p ON o."order_id" = p."order_id"
JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
JOIN top_customers tc ON c."customer_unique_id" = tc."customer_unique_id"
WHERE o."order_status" = 'delivered'
GROUP BY tc."customer_unique_id", tc."customer_city", tc."customer_state"
LIMIT 100;
```

Each of these queries helps to understand the data and how it relates to the task of calculating the average payment value, city, and state for the top 3 customers with the most delivered orders.Query:
-- Query 1: Get distinct order statuses
SELECT DISTINCT "order_status"
FROM "olist_orders"
LIMIT 100
Answer:
order_status
delivered
invoiced
shipped
processing
unavailable
canceled
created
approved
Query:
-- Query 2: Count of orders per order status
SELECT "order_status", COUNT(*) as "order_count"
FROM "olist_orders"
GROUP BY "order_status"
LIMIT 100
Answer:
order_status,order_count
approved,2
canceled,625
created,5
delivered,96478
invoiced,314
processing,301
shipped,1107
unavailable,609
Query:
-- Query 3: List of unique customers
SELECT DISTINCT "customer_unique_id"
FROM "olist_customers"
LIMIT 100
Answer:
customer_unique_id
861eff4711a542e4b93843c6dd7febb0
290c77bc529b7ac935b93aa66c333dc3
060e732b5b29e8181a18229c7b0b2b5e
259dac757896d24d7702b9acbbff3f3c
345ecd01c38d18a9036ed96c73b8d066
4c93744516667ad3b8f1fb645a3116a4
addec96d2e059c80c30fe6871d30d177
57b2a98a409812fe9618067b6b8ebe4f
1175e95fb47ddff9de6b2b06188f7e0d
9afe194fb833f79e300e37e580171f22
2a7745e1ed516b289ed9b29c7d0539a5
2a46fb94aef5cbeeb850418118cee090
918dc87cd72cd9f6ed4bd442ed785235
295c05e81917928d76245e842748184d
3151a81801c8386361b62277d7fa5ecf
21f748a16f4e1688a9014eb3ee6fa325
5c2991dbd08bbf3cf410713c4de5a0b5
b6e99561fe6f34a55b0b7da92f8ed775
7f3a72e8f988c6e735ba118d54f47458
3e6fd6b2f0d499456a6a6820a40f2d79
e607ede0e63436308660236f5a52da5e
a96d5cfa0d3181817e2b946f921ea021
482441ea6a06b1f72fe9784756c0ea75
4390ddbb6276a66ff1736a6710205dca
a5844ba4bfc8d0cc61d13027c7e63bcc
5f102dd37243f152aec3607970aad100
9c0096673baf55453a50073f12d1a37f
2e6a42a9b5cbb0da62988694f18ee295
4d221875624017bc47b4d1ce7314a5b7
a8654e2af5da6bb72f52c22b164855e1
424aca6872c5bab80780a8dec03b7516
bf4862777db128507e9efcc789215e9b
e9dd12dca17352644a959d9dea133935
e079b18794454de9d2be5c12b4392294
ef07ba9aa5226f77264ffa5762b2280b
85d234692f7bee8d6fea586e237334b6
fe3634ccefbcdb0537b45fd589e32e8e
40febde16f4718a5def537786473b0be
07d190f123147d9e89d4b922543d7948
dd992305cba295d997f263dbdf4e8c2e
86085586aaa8c5f47ed0b400da64c59d
5ad58a4e6a1a656b6bed070cadbaa003
c9158d089637ab443c78984d20da7fc0
66cc90195ca44cc7ac6a1cd0e1e1e7b2
91ec50a00ae74d0a229d2efdf4344e1e
d251c190ca75786e9ab937982d60d1d4
233896de79986082f1f479f1f85281cb
a8ae36a2bb6c2bbc3b5d62ede131c9ef
8d46223c91cbeb93e0930ca8bd8ffca2
e021e698833bdeb89dfef3acb2e91f37
27cf4b153010911a0957150255a6c6db
7ce5b57a120a2da6a804afa58ffcbfb5
d33eeadf54cb883e79be640f38c32cdc
3da7750bf3c1dbd724624a60a9f5942b
d85547cd859833520b311b4458a14c1c
3af0b2f7654f613ff1527b997a2ac57e
3d49f4455a3947c8dd7e972b3ad8cb76
b03e9d9818ee170e9d6b983803c7d406
a302a693d5722d95984e6472150b9391
c80da60feddb7cf8325bd104032e314a
a2b8841410cf77619574d311cd06fd5e
7677c213007e9a6ec9267ea50b5ce5bc
0c17f9ac28cbd7323f0f4043e9db5907
332cf4e83e16004ba7dca932ce82475b
0d516ca029d6a28d5cfddd80b27a26dc
b3548d0cec408ae13d143bb4eeebaa6c
c3293e875ffb1116018edf76d24e52a2
d89e05e2d23c3d8247aeecd07758004b
dad5018ffc0de85eb72f72575b552784
95700615deef776ed32faa08f0be634e
b157c176c3fe04914fde33f2dc8b878a
d4397835ae287e492b186d497099439a
76b029c87118a29f2e3de420f5ec2fa2
7eaa86786b5955ab188db287f4726d79
b436a108536c1dabbc1d3e808d782df9
cd076285a12f40041b32f5ad8c98699f
cf6d4152d758efc43910e0141ae5b912
468d559ef2dcd2bea6d8db78959fb90f
7556f182460418cf30957e6ce377c674
e5dbefdfdf3eff75c8e6cd655f128279
67d21c8bea9d6017d1b124d3879dd815
fd2d5fdb84e65fa6b54b98b0e2df5645
d491a65a6ef3c04e145d37395996bad7
6edd17d0a29e2d4057e694afee5eaa3b
bf6e263ffc1f89999827615522b0aa45
6d3f61e35d0422fd8cae65b1798784be
a9a77b4e25980b7ca58cb71f878abb27
eca666aec08df69fe31aa9a11d4a3302
7a380cb5434e6b6b5b37d45bb99dbe8a
463093247faa080167d77f2e6d1b297d
914b142462685e3161cf3a9f4152a028
e235442a956c524e6c141141171f5801
4a4de987b37555970ffcc9608d858a72
44e9a1246448bd68a2e3bf0f1966c57a
b4d6e1b900d99b52e901860bc1f44e35
809353196a0456095716566dd226bb48
9e1f719fe5b17b9c51905fee6d6385c1
94b731a41867b47c3856e324840c4c99
694cb45ff29b603ac2acd51016770097
9dbb05f5577e862337b93feb8f358839
Query:
-- Query 4: Mapping of customer_id to customer_unique_id
SELECT "customer_id", "customer_unique_id"
FROM "olist_customers"
LIMIT 100
Answer:
Too long, hard cut:
customer_id,customer_unique_id
06b8999e2fba1a1fbc88172c00ba8bc7,861eff4711a542e4b93843c6dd7febb0
18955e83d337fd6b2def6b18a428ac77,290c77bc529b7ac935b93aa66c333dc3
4e7b3e00288586ebd08712fdd0374a03,060e732b5b29e8181a18229c7b0b2b5e
b2b6027bc5c5109e529d4dc6358b12c3,259dac757896d24d7702b9acbbff3f3c
4f2d8ab171c80ec8364f7c12e35b23ad,345ecd01c38d18a9036ed96c73b8d066
879864dab9bc3047522c92c82e1212b8,4c93744516667ad3b8f1fb645a3116a4
fd826e7cf63160e536e0908c76c3f441,addec96d2e059c80c30fe6871d30d177
5e274e7a0c3809e14aba7ad5aae0d407,57b2a98a409812fe9618067b6b8ebe4f
5adf08e34b2e993982a47070956c5c65,1175e95fb47ddff9de6b2b06188f7e0d
4b7139f34592b3a31687243a302fa75b,9afe194fb833f79e300e37e580171f22
9fb35e4ed6f0a14a4977cd9aea4042bb,2a7745e1ed516b289ed9b29c7d0539a5
5aa9e4fdd4dfd20959cad2d772509598,2a46fb94aef5cbeeb850418118cee090
b2d1536598b73a9abd18e0d75d92f0a3,918dc87cd72cd9f6ed4bd442ed785235
eabebad39a88bb6f5b52376faec28612,295c05e81917928d76245e842748184d
1f1c7bf1c9b041b292af6c1c4470b753,3151a81801c8386361b62277d7fa5ecf
206f3129c0e4d7d0b9550426023f0a08,21f748a16f4e1688a9014eb3ee6fa325
a7c125a0a07b75146167b7f04a7f8e98,5c2991dbd08bbf3cf410713c4de5a0b5
c5c61596a3b6bd0cee5766992c48a9a1,b6e99561fe6f34a55b0b7da92f8ed775
9b8ce803689b3562defaad4613ef426f,7f3a72e8f988c6e735ba118d54f47458
49d0ea0986edde72da777f15456a0ee0,3e6fd6b2f0d499456a6a6820a40f2d79
154c4ded6991bdfa3cd249d11abf4130,e607ede0e63436308660236f5a52da5e
690172ab319622688d3b4df42f676898,a96d5cfa0d3181817e2b946f921ea021
2938121a40a20953c43caa8c98787fcb,482441ea6a06b1f72fe9784756c0ea75
237098a64674ae89babdc426746260fc,4390ddbb6276a66ff1736a6710205dca
cb721d7b4f271fd87011c4c83462c076,a5844ba4bfc8d0cc61d13027c7e63bcc
f681356046d9fde60e70c73a18d65ea2,5f102dd37243f152aec3607970aad100
167bd30a409e3e4127df5a9408ebd394,9c0096673baf55453a50073f12d1a37f
6e359a57a91f84095cc64e1b351aef8c,2e6a42a9b5cbb0da62988694f18ee295
e0eea8f69a457b3f1fa246e44c9ebefd,4d221875624017bc47b4d1ce7314a5b7
e3109970a3fe8021d5ff82c577ce5606,a8654e2af5da6bb72f52c22b164855e1
261cb4f92498ca05d5bd1a327a261d9c,424aca6872c5bab80780a8dec03b7516
6f92779347724b67e44e3224f3b4cffd,bf4862777db128507e9efcc789215e9b
2d5831cb2dff7cdefba62e950ae3dc7b,e9dd12dca17352644a959d9dea133935
b2bed119388167a954382cca36c4777f,e079b18794454de9d2be5c12b4392294
469634941c27cd844170935a3cf60b95,ef07ba9aa5226f77264ffa5762b2280b
df0aa5b8586495e0ddf6b601122e43a1,85d234692f7bee8d6fea586e237334b6
41c8f4b570869791379a925899a6af8a,fe3634ccefbcdb0537b45fd589e32e8e
54f755c3fd2709231f9964a1430c5218,40febde16f4718a5def537786473b0be
4c06b42fbf7b97ab10779cda5549cd1c,07d190f123147d9e89d4b922543d7948
b6368ca0f56d4632f44d58ca431487b2,dd992305cba295d997f263dbdf4e8c2e
4a0e66fd30684aa1409cd1b66fec77cc,86085586aaa8c5f47ed0b400da64c59d
c168abb9077b7821adae01dc1f0886c5,5ad58a4e6a1a656b6bed070cadbaa003
a3b0fda37bae14cf754877bed475e80c,c9158d089637ab443c78984d20da7fc0
0ccd415657ae8a6cd1c71b00155a019e,66cc90195ca44cc7ac6a1cd0e1e1e7b2
c532a74a3ebf1bacce2e2bcce3783317,91ec50a00ae74d0a229d2efdf4344e1e
19cecb194f54e614b70d971306a9931b,d251c190ca75786e9ab937982d60d1d4
f34a6e874087ec1f0e3dab9fdf659c5d,233896de79986082f1f479f1f85281cb
c132855c926907970dcf6f2bf0b33a24,a8ae36a2bb6c2bbc3b5d62ede131c9ef
df85b96ba2ce3e49bde101b1614f52ac,8d46223c91cbeb93e0930ca8bd8ffca2
4d27341acd30a36bca39008ee9bb9050,e021e698833bdeb89dfef3acb2e91f37
d3b6830d18c7de943d1e707d1f061d40,27cf4b153010911a0957150255a6c6db
79de53946db384e2d7a9bd131792ad17,7ce5b57a120a2da6a804afa58ffcbfb5
a562ab1e728449e3461829dfe2e36f73,d33eeadf54cb883e79be640f38c32cdc
b64ed91eab98972150bdaf77ca921934,3da7750bf3c1dbd724624a60a9f5942b
8247b5583327ab8be19f96e1fb82f77b,d85547cd859833520b311b4458a14c1c
8fcaa9368903f3a9a28aeaff28c14638,3af0b2f7654f613ff1527b997a2ac57e
a9b0d1c26105279e1b8edc63d06bd668,3d49f4455a3947c8dd7e972b3ad8cb76
aa9f03ecd3728c9bd12e6d962c66c7cb,b03e9d9818ee170e9d6b983803c7d406
230c0d740401730c7197d16376893525,a302a693d5722d95984e6472150b9391
a905baa530258422594f1b05615bd225,c80da60feddb7cf8325bd104032e314a
4fa19f7da692e6bf9602aaad3c372eda,a2b8841410cf77619574d311cd06fd5e
03f846ad03437d864a8d2a22976dcafe,7677c213007e9a6ec9267ea50b5ce5bc
de4e13fd7d6469c5ada77d0843c55e42,0c17f9ac28cbd7323f0f4043e9db5907
8276de07ef25225d412b8462d73f8664,332cf4e83e16004ba7dca932ce82475b
cc32707d2e2f7c92ab449f9b28154809,0d516ca029d6a28d5cfddd80b27a26dc
a02f66c3af7b16eec19ddcd98b645fe3,b3548d0cec408ae13d143bb4eeebaa6c
26acee41e2f75689a5615892f06ea0bd,c3293e875ffb1116018edf76d24e52a2
f64cdee66599119324ce57a97e43700d,d89e05e2d23c3d8247aeecd07758004b
7ab7a537b678b6dd73d825ff6ee7be9d,dad5018ffc0de85eb72f72575b552784
7300450cedf7e4c35c243c4a03c1e8a6,95700615deef776ed32faa08f0be634e
4c7241af24b5344cb01fe687643de4fe,b157c176c3fe04914fde33f2dc8b878a
97e126f19a6f04b3462619f36862bcd2,d4397835ae287e492b186d497099439a
6d27a9361e591da38c87a5e70253f3f2,76b029c87118a29f2e3de420f5ec2fa2
6810c3dc47f641181fcc7f73275c3d19,7eaa86786b5955ab188db287f4726d79
b514422efcf14bef34858a0829bef189,b436a108536c1dabbc1d3e808d782df9
0aae2862f8eac77f10a
Query:
-- Query 5: Orders with 'delivered' status
SELECT "order_id", "customer_id", "order_status"
FROM "olist_orders"
WHERE "order_status" = 'delivered'
LIMIT 100
Answer:
Too long, hard cut:
order_id,customer_id,order_status
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,delivered
53cdb2fc8bc7dce0b6741e2150273451,b0830fb4747a6c6d20dea0b8c802d7ef,delivered
47770eb9100c2d0c44946d9cf07ec65d,41ce2a54c0b03bf3443c3d931a367089,delivered
949d5b44dbf5de918fe9c16f97b45f8a,f88197465ea7920adcdbec7375364d82,delivered
ad21c59c0840e6cb83a9ceb5573f8159,8ab97904e6daea8866dbdbc4fb7aad2c,delivered
a4591c265e18cb1dcee52889e2d8acc3,503740e9ca751ccdda7ba28e9ab8f608,delivered
6514b8ad8028c9f2cc2374ded245783f,9bdf08b4b3b52b5526ff42d37d47f222,delivered
76c6e866289321a7c93b82b54852dc33,f54a9f0e6b351c431402b8461ea51999,delivered
e69bfb5eb88e0ed6a785585b27e16dbf,31ad1d1b63eb9962463f764d4e6e0c9d,delivered
e6ce16cb79ec1d90b1da9085a6118aeb,494dded5b201313c64ed7f100595b95c,delivered
34513ce0c4fab462a55830c0989c7edb,7711cf624183d843aafe81855097bc37,delivered
82566a660a982b15fb86e904c8d32918,d3e3b74c766bc6214e0c830b17ee2341,delivered
5ff96c15d0b717ac6ad1f3d77225a350,19402a48fe860416adf93348aba37740,delivered
432aaf21d85167c2c86ec9448c4e42cc,3df704f53d3f1d4818840b34ec672a9f,delivered
dcb36b511fcac050b97cd5c05de84dc3,3b6828a50ffe546942b7a473d70ac0fc,delivered
403b97836b0c04a622354cf531062e5f,738b086814c6fcc74b8cc583f8516ee3,delivered
116f0b09343b49556bbad5f35bee0cdf,3187789bec990987628d7a9beb4dd6ac,delivered
85ce859fd6dc634de8d2f1e290444043,059f7fc5719c7da6cbafe370971a8d70,delivered
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,delivered
203096f03d82e0dffbc41ebc2e2bcfb7,d2b091571da224a1b36412c18bc3bbfe,delivered
f848643eec1d69395095eb3840d2051e,4fa1cd166fa598be6de80fa84eaade43,delivered
2807d0e504d6d4894d41672727bc139f,72ae281627a6102d9b3718528b420f8a,delivered
95266dbfb7e20354baba07964dac78d5,a166da34890074091a942054b36e4265,delivered
f3e7c359154d965827355f39d6b1fdac,62b423aab58096ca514ba6aa06be2f98,delivered
fbf9ac61453ac646ce8ad9783d7d0af6,3a874b4d4c4b6543206ff5d89287f0c3,delivered
acce194856392f074dbf9dada14d8d82,7e20bf5ca92da68200643bda76c504c6,delivered
dd78f560c270f1909639c11b925620ea,8b212b9525f9e74e85e37ed6df37693e,delivered
91b2a010e1e45e6ba3d133fa997597be,cce89a605105b148387c52e286ac8335,delivered
ecab90c9933c58908d3d6add7c6f5ae3,761df82feda9778854c6dafdaeb567e4,delivered
f70a0aff17df5a6cdd9a7196128bd354,456dc10730fbdba34615447ea195d643,delivered
1790eea0b567cf50911c057cf20f90f9,52142aa69d8d0e1247ab0cada0f76023,delivered
989225ba6d0ebd5873335f7e01de2ae7,816f8653d5361cbf94e58c33f2502a5c,delivered
d887b52c6516beb39e8cd44a5f8b60f7,d9ef95f98d8da3b492bb8c0447910498,delivered
b276e4f8c0fb86bd82fce576f21713e0,cf8ffeddf027932e51e4eae73b384059,delivered
8563039e855156e48fccee4d611a3196,5f16605299d698660e0606f7eae2d2f9,delivered
60550084e6b4c0cb89a87df1f3e5ebd9,f5458ddc3545711efa883dd7ae7c4497,delivered
5acce57f8d9dfd55fa48e212a641a69d,295ae9b35379e077273387ff64354b6f,delivered
434d158e96bdd6972ad6e6d73ddcfd22,2a1dfb647f32f4390e7b857c67458536,delivered
7206b86ea789983f7a273ea7fa0bc2a8,3391c4bc11a817e7973e498b0b023158,delivered
1e7aff52cdbb2451ace09d0f848c3699,ddaff536587109b89777e0353215e150,delivered
6ea2f835b4556291ffdc53fa0b3b95e8,c7340080e394356141681bd4c9b8fe31,delivered
948097deef559c742e7ce321e5e58919,8644be24d48806bc3a88fd59fb47ceb1,delivered
d22e9fa5731b9e30e8b27afcdc2f8563,756fb9391752dad934e0fe3733378e57,delivered
6ebaec694d7025e2ad4a05dba887c032,4f28355e5c17a4a42d3ce2439a1d4501,delivered
d17dc4a904426827ca80f2ccb3a6be56,569cf68214806a39acc0f39344aea67f,delivered
25f4376934e13d3508486352e11a5db0,12fd2740039676063a874b9567dfa651,delivered
5820a1100976432c7968a52da59e9364,2b56e94c2f66f2d97cfa63356f69cee8,delivered
2ce1ad82022c1ba30c2079502ac725aa,7f2178c5d771e17f507d3c1637339298,delivered
138849fd84dff2fb4ca70a0a34c4aa1c,9b18f3fc296990b97854e351334a32f6,delivered
47aa4816b27ba60ec948cd019cc1afc1,148348ff65384b4249b762579532e248,delivered
9faeb9b2746b9d7526aef5acb08e2aa0,79183cd650e2bb0d475b0067d45946ac,delivered
641fb0752bf5b5940c376b3a8bb9dc52,f5afca14dfa9dc64251cf2b45c54c363,delivered
e425680f760cbc130be3e53a9773c584,f178c1827f67a8467b0385b7378d951a,delivered
40c5e18f7d112b59b3e5113a59a905b3,67407057a7d5ee17d1cd09523f484d13,delivered
734e7d1bbaeb2ff82521ca0fe6fb6f79,2932d241d1f31e6df6c701d52370ae02,delivered
66e4624ae69e7dc89bd50222b59f581f,684fa6da5134b9e4dab731e00011712d,delivered
a685d016c8a26f71a0bb67821070e398,911e4c37f5cafe1604fe6767034bf1ae,delivered
2edfd6d1f0b4cd0db4bf37b1b224d855,241e78de29b3090cfa1b5d73a8130c72,delivered
68873cf91053cd11e6b49a766db5af1a,4632eb5a8f175f6fe020520ae0c678f3,delivered
f346ad4ee8f630e5e4ddaf862a34e6dd,dd5095632e3953fc0947b8ab5176b0be,delivered
8f06cc6465925031568537b815f1198d,9916715c2ab6ee1710c9c32f0a534ad2,delivered
ccbabeb0b02433bd0fcbac46e70339f2,c77ee2d8ba1614a4d489a44166894938,delivered
688052146432ef8253587b930b01a06d,81e08b08e5ed4472008030d70327c71f,delivered
f271576bed568e896f99eb710cd3a6f8,5dda11942d4f77bee3a46d71e442aec4,delivered
686541986ecfb7d9296eb67719973bf0,74805bc388861fa350ed2fade8444e0b,delivered
68e48e68da1f50f7c5838ea75e
Query:
-- Query 6: Payment values for each order
SELECT "order_id", "payment_value"
FROM "olist_order_payments"
LIMIT 100
Answer:
order_id,payment_value
b81ef226f3fe1789b1e8b2acac839d17,99.33
a9810da82917af2d9aefd1278f1dcfa0,24.39
25e8ea4e93396b6fa0d3dd708e76c1bd,65.71
ba78997921bbcdc1373bb41e913ab953,107.78
42fdf880ba16b47b59251dd489d4441a,128.45
298fcdf1f73eb413e4d26d01b25bc1cd,96.12
771ee386b001f06208a7419e4fc1bbd7,81.16
3d7239c394a212faae122962df514ac7,51.84
1f78449c87a54faf9e96e88ba1491fa9,341.09
0573b5e23cbd798006520e1d5b4c6714,51.95
d88e0d5fa41661ce03cf6cf336527646,188.73
2480f727e869fdeb397244a21b721b67,141.9
616105c9352a9668c38303ad44e056cd,75.78
cf95215a722f3ebf29e6bbab87a29e61,102.66
769214176682788a92801d8907fa1b40,105.28
12e5cfe0e4716b59afb0e0f4a3bd6570,157.45
61059985a6fc0ad64e95d9944caacdad,132.04
79da3f5fe31ad1e454f06f95dc032ad5,98.94
8ac09207f415d55acff302df7d6a895c,244.15
b2349a3f20dfbeef62e7b31baa22f84b,136.71
5a1f6d22f7dfb061ef29216b9af687a1,47.69
4214cda550ece8ee66441f459dc33a8c,170.57
adfbf6c2a620196f9a3ec747491c72b7,67.5
4d680edbaa7d3d9bed69532957368a03,353.09
8cd68144cdb62dc0d60848cf8616d2a4,330.66
5cfd514482e22bc992e7693f0e3e8df7,45.17
d0a945f85ba1074b60aac97ade7e240e,541.0
c39414c195d0f94c9d9c35e7c6ed4f1a,139.22
5d9c5817e278892b7498d90bfa28ade8,290.16
b69b9260e79a0da00e15f48de1bd2524,283.34
f45074ae38f2e01d9b854ec8d40362ff,13.78
81cedc4d2132eb6f512354166e51b187,30.28
595f598849d89203c28d05d0fbf3f92e,26.58
f9d0ec2fa088ac583e1ccd15b6686073,89.68
e647bf617de735448a4ba54f8910393c,65.09
b2bb080b6bc860118a246fd9b6fad6da,173.84
23f10f509600c30cf2852f9dbdf28fc3,103.49
f86f6472fa9f395d8d9a6751ca118afb,64.03
1dcf0c8cd36ffaf57784fbdc90079310,157.15
00d8d65b666158b633f96054d31af43b,130.88
cf30fe76d1505192acee1c6dccb15545,47.72
d3e774a185c0b1b2286ffd6c70abe2e6,117.74
32b1d8f3789a57f1f752e20ac7404b4c,56.6
c10d412026c4077b8e83acf0fea04eee,266.16
56c3277583e16009c925fdf116df420f,31.38
0e0441786430b7cfcd0d91f822ea4c99,121.49
6ffb3f1686bceae3466facf7e02ce3fb,32.0
afef48d3c8a0b1b7c9b7f8f922fb5674,153.41
c0db7d31ace61fc360a3eaa34dd3457c,65.71
d574338f566ca28dd67820f48ec1f1d8,278.22
1807cc736321f14baa58ef39cf6e5989,91.66
e8977f709bbb0367f51b589e6325f991,132.51
2e2c60b99754ae1e4d8b18846cfec9f2,542.66
1ffb3c1929b16d9c1aec1958e11b3e9b,166.04
95442deb81a5d91c97c0df96b431634a,368.98
10af96a0689260134307879127ac1952,113.2
85eef2d342b0de363c45c1bc324729c5,99.43
aa964845f1de8125410aea8b73e9e1ec,27.35
343348b1e29e9fa9e7b6ab1027f9177d,43.77
ad4098a257676ea4d394fb3bbbf36ca3,68.49
3e0c3cab458e8b3cc8d1d38ecb7e7775,105.53
3ab4eea6776259ae8dfbabaeffece352,387.8
10d9871bed9fb8d0887d3b9022edd1ff,84.14
c108072ab31ec90a754129c171577f5f,210.82
fc662bafa52d2ef16078f6f6141009d6,90.05
4217849b1ff18a9270fe048eabc4dc45,67.88
795c16acb4e3c30dfa5b6827727ef488,37.58
55e2d723733c45033e71cb4d44690234,89.63
947e9c6bfd83a06953c420ef92d3da6e,69.46
60e43c5f5ba559d9dd19357ed72cb2f2,78.3
e3e9e3295f4e1512167c232a0aaae8a5,50.8
460d57443ffdcaeba240360239747cf7,34.0
4cb51127f19f7254b320efe1718477dd,77.1
110d9355d6338eab0a65a0cacdde5434,566.4
42f5954cda381bd032934ee38c453711,402.42
3689194c14ad4e2e7361ebd1df0e77b0,57.53
97c111c4f22dfa1089a9c0b5338dcc79,44.01
4b2d035932915aa9c2a0d4d84cd6d3b0,187.51
e1b4ee0e390fbac1dec439d72b45a115,77.7
fee72a68ce935ebf2939fe72f27d3d9b,48.68
4d3bfdf4c7d6578ea445d588371ae10e,77.29
4c2e1a95586c815795a324d1599e7b5a,117.71
c9f23db8a1cb725df9bdb3383bd72b38,169.34
8e47a04b25d7a7075064e8e0bd2e0318,37.61
723e462ce1ee50e024887c0b403130f3,13.8
fa2ea4b6e84c1c0fc4f3a6d468c55183,227.12
fb1a2a1296f822405a946cbdfc0d3ed6,34.78
198298d54f269d8c5fe89e85a859af61,342.56
b19ca559688b49e8cf7f88c1aa3f0009,73.34
5be8d4719fe2e3669e2d07dddf3b6b0c,117.85
4a02e985c7239d866a632f07ed20d9c0,48.62
3e17eef8a8bd0131c7aed90d7508799e,53.99
f8d323a2702fed37f0229965f7e9f8b3,51.14
de4090fd9b7900d46323b0c7c36b7128,121.45
17e5131fe1d4b1a8dc14d4a66914f9d7,73.34
20f136d890c31a62486c809f91a5b098,117.68
557cc2675910c4a6c9b54ad276f25097,56.77
d60a89ab9bc1e68834465ae630c3343e,115.59
3ba2d0012b1f34bc6ccbc31c4ba69f93,60.07
d46f45b0d795bcf47a19d301710e63fe,27.27
Query:
-- Query 7: Total payment per order_id
SELECT "order_id", SUM("payment_value") as "total_payment"
FROM "olist_order_payments"
GROUP BY "order_id"
LIMIT 100
Answer:
order_id,total_payment
00010242fe8c5a6d1ba2dd792cb16214,72.19
00018f77f2f0320c557190d7a144bdd3,259.83
000229ec398224ef6ca0657da4fc703e,216.87
00024acbcdf0a6daa1e931b038114c75,25.78
00042b26cf59d7ce69dfabb4e55b4fd9,218.04
00048cc3ae777c65dbb7d2a0634bc1ea,34.59
00054e8431b9d7675808bcb819fb4a32,31.75
000576fe39319847cbb9d288c5617fa6,880.75
0005a1a1728c9d785b8e2b08b904576c,157.6
0005f50442cb953dcd1d21e1fb923495,65.39
00061f2a7bc09da83e415a52dc8a4af1,68.87
00063b381e2406b52ad429470734ebd5,57.98
0006ec9db01a64e59a68b2c340bf65a7,97.32
0008288aa423d2a3f00fcb17cd7d8719,126.54
0009792311464db532ff765bf7b182ae,127.55
0009c9a17f916a706d71784483a5d643,650.34
000aed2e25dbad2f9ddb70584c5a2ded,152.77
000c3e6612759851cc3cbb4b83257986,112.71
000e562887b1f2006d75e0be9558292e,41.11
000e63d38ae8c00bbcb5a30573b99628,56.78
000e906b789b55f64edcb1f84030f90d,33.84
000f25f4d72195062c040b12dce9a18a,164.39
001021efaa8636c29475e7734483457d,64.1
0010b2e5201cc5f1ae7e9c6cc8f5bd00,65.5
0010dedd556712d7bb69a19cb7bbd37a,111.12
00119ff934e539cf26f92b9ef0cdfed8,236.88
0011d82c4b53e22e84023405fb467e57,315.33
00125cb692d04887809806618a2a145f,135.41
00130c0eee84a3d909e75bc08c5c3ca1,35.84
0013503b13da1eac686219390b7d641b,137.22
00137e170939bba5a3134e2386413108,421.65
001427c0ec99cf8af737bd88e92fd444,83.25
00143d0f86d6fbd9f9b38ab440ac16f5,109.29
0014ae671de39511f7575066200733b7,30.6
0015ebb40fb17286bea51d4607c4733c,37.0
00169e31ef4b29deaae414f9a5e95929,55.11
0016dfedd97fc2950e388d2971d718c7,70.55000000000001
0017afd5076e074a48f1f1a4c7bac9c5,853.39
001862358bf858722e1e2ae000cfed8b,113.71
0019c29108428acffd089c36103c9440,79.85
001ab0a7578dd66cd4b0a71f5b6e1e41,127.56
001ac194d4a326a6fa99b581e9a3d963,62.54
001b76dd48a5b1eee3e87778daa40df8,95.0
001c85b5f68d2be0cb0797afc9e8ce9a,112.71
001d8f0e34a38c37f7dba2a37d4eba8b,53.54
001daeb0eddc45b999bad0801ad9d273,55.12
001dbc16dc51075e987543d23a0507c7,87.9
001e7ba991be1b19605ca0316e7130f9,213.21
001e7cf2ad6bef3ade12ebc56ceaf0f3,51.1
0020262c8a370bd5a174ea6a2a267321,100.55
0020a222f55eb79a372d0efee3cca688,45.09
002175704e8b209f61b9ad5cfd92b60e,123.11
00229e4e43f7a7e0b9dd819ad43268d3,91.39
0025081dcf9330f9a5052ae82c6ce396,33.18
00254baeb6c932b0a8aeead91fbd02b5,193.01
00259a44fcad3fc0474329e925d14fc3,34.09
0025c5d1a8ca53a240ec2634bb4492ea,419.39
002611a77fe03d076285fd4ca95db77c,156.75
002691433f09002ac9ca0c4e8dbb8ead,120.43
0026a368634b6e6f34f33b1499773a30,164.8
00275bce676303c3bfd7292aefdfa223,293.36
00276d5c3491fbf55305e26891040df9,68.12
002834535f7a609a5c68266f173fa59e,57.17
0028de0ca693a1bb26448916a81105cc,45.3
002955b0acc63d04f6724a31967e82bd,135.59
0029c5db35ef291ce99d1262012e7daa,514.37
0029f17cf0e7640c5cb6825af681303f,113.44
002af7fa9eb99d1456bceb6a13d6fc0b,109.45
002b430ff89b3a24c31a1170acbbedea,265.55
002b4e6fa42cd4a22cc86abc18fe9c05,119.57
002c9def9c9b951b1bec6d50753c9891,173.8
002d040018d12a3853c059f7f23ab5b1,169.84
002f16b7bc4530031b7d90f791b12d8a,284.13
002f19a65a2ddd70a090297872e6d64e,77.28999999999999
002f98c0f7efd42638ed6100ca699b42,93.62
0030d783f979fbc5981e75613b057344,78.27
0030ff924c38549807645976adeef2c0,292.24
00310b0c75bb13015ec4d82d341865a4,55.28
00324b3eda39ba5ecce3945823e3594c,110.07
0032d07457ae9c806c79368d7d9ce96b,186.19
003324c70b19a16798817b2b3640e721,234.7
00335b686d693c7d72deeb12f8e89227,80.79
00335f75ea6a4455b524a8dd177067f5,177.01
00337fe25a3780b3424d9ad7c5a4b35e,139.68
003423b755b562962a6225a8de40d12e,261.33
00345f338696283410b7977d2e3efc89,67.34
0035246a40f520710769010f752e7507,99.11
0035c0b07126fe9c24a325216fb96064,150.44
0035e6b7ade84b3f5b86bd49814793df,34.0
0036757472ece3dde52fd4bfd929c90e,203.03
0036887767dea4bd43b1a88cd0d9477a,423.63
00378c6c981f234634c0b9d6128df6dd,52.85
003822434f91204da0a51fe4cf2aba18,175.16
0039500db36d50d7d0bfaf23723550f3,203.23
003a7f59d7e08a9c61d9e2881fe6459c,134.28
003a94f778ef8cfd50247c8c1b582257,57.98
003cc6161d7a2593f2525cce0c330d32,97.9
003d0634280ff3d1d3a54459349a6899,228.89
003d804eef0e1b856881cd18e0cc0d4c,312.74
003d9fc84ad902adf2265248b5ffe1a4,94.74
Query:
-- Query 8: Number of delivered orders per customer_unique_id
SELECT c."customer_unique_id", COUNT(*) as "delivered_orders"
FROM "olist_orders" o
JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
WHERE o."order_status" = 'delivered'
GROUP BY c."customer_unique_id"
ORDER BY "delivered_orders" DESC
LIMIT 100
Answer:
customer_unique_id,delivered_orders
8d50f5eadf50201ccdcedfb9e2ac8455,15
3e43e6105506432c953e165fb2acf44c,9
ca77025e7201e3b30c44b472ff346268,7
6469f99c1f9dfae7733b25662e7f1782,7
1b6c7548a2a1f9037c1fd3ddfed95f33,7
f0e310a6839dce9de1638e0fe5ab282a,6
dc813062e0fc23409cd255f7f53c7074,6
63cfc61cee11cbe306bff5857d00bfe4,6
47c1a3033b8b77b3ab6e109eb4d5fdf3,6
12f5d6e1cbf93dafd9dcc19095df0b3d,6
fe81bb32c243a86b2f86fbf053fe6140,5
de34b16117594161a6a89c50b289d35a,5
b4e4f24de1e8725b74e4a1f4975116ed,5
74cb1ad7e6d5674325c1f99b5ea30d82,5
5e8f38a9a1c023f3db718edcf926a2db,5
56c8638e7c058b98aae6d74d2dd6ea23,5
4e65032f1f574189fb793bac5a867bbc,5
394ac4de8f3acb14253c177f0e15bc58,5
35ecdf6858edc6427223b64804cf028e,5
f64ec6d8dd29940264cd0bbb5ecade8a,4
f34cd7fd85a1f8baff886edf09567be3,4
ec7f1811826ab04a27a92197bc40c888,4
d3359a56d96666ac0c21bb01e7a61c95,4
c8460e4251689ba205045f3ea17884a1,4
c37cc6c1a59d81460a3059744f7ada1c,4
b896655e2083a1d76b7b85df8fc86e40,4
b39dde6dd619943190a8cc9aa6db38a4,4
b2bd387fdc3cf05931f0f897d607dc88,4
b08fab27d47a1eb6deda07bfd965ad43,4
acea6bd29b8c1e3c6a8b266a8fb4475e,4
a7657330b1c135f3acd420326e335b2c,4
a73c5464692d3bc09d64e3edefae9015,4
a239b8e2fbce33780f1f1912e2ee5275,4
a1874c5550d2f0bc14cc122164603713,4
a0abd26659c9914690cbd3320d39fd96,4
9cc5a07f169a1606fd347a56683e6ea6,4
83e7958a94bd7f74a9414d8782f87628,4
795c1622cf7a53d63d324e862349d01c,4
738ffcf1017b584e9d2684b36e07469c,4
7305430719d715992b00be82af4a6aa8,4
6358b15ef7fa9b1210f1a5735cabd3d9,4
4facc2e6fbc2bffab2fea92d2b4aa7e4,4
397b44d5bb99eabf54ea9c2b41ebb905,4
2ddc001b620bd90d0f4378cfde1db887,4
25a560b9a6006157838aab1bdbd68624,4
12d8b5ed661190a3a08183644dfc504d,4
08e5b38d7948d37fbb2a59fc5e175ab1,4
ff922bdd6bafcdf99cb90d7f39cea5b3,3
fe59d5878cd80080edbd29b5a0a4e1cf,3
fd8ccc89be43894d2553494c71a61fd8,3
fc719c11b4dce594f47e1f9aa739a3a2,3
f8bc1d81f395f6239a2a5ab1b9edf1ab,3
f4d1502ace38b0df6f052a5544add9f4,3
f11821d908830e74ad782532ebed897a,3
f0fd988c7c2a4cba167138a8adada6ca,3
e9b87dccd9c326a3325385087eb0150c,3
e78838df9c44e102b6ac84cc5eea7d5c,3
e68e1b61896163cdd7f8e07b2ae814c9,3
e53fd5575f1418397aae732c5755b6fc,3
e4b98eebb8983cade8610c0def59f705,3
e3301490c373db9263c15a73172d0c6f,3
e325e139452a1ca05f5a33acedd7d94f,3
e30b83af13d6ff0b0f427b2a67c43b39,3
e2492e4188991b6276a4a62a287a5451,3
e226254ce0c6d5b7a7ef7218c9b5b518,3
e13e8b789e5a8e6fe1445f924a4ed4f6,3
e12f7f1e96f1f9f6361572028a1fad5a,3
e1224167b1a3f92781c2ff55b0b794be,3
e0c99ffdcd8891130985ac90cd2d8eec,3
e0836a97eaae86ac4adc26fbb334a527,3
e016365b624d1755f3e2d0e8f1631ebb,3
df946ef265626b1e0a425292815ddead,3
dc48b0a1b0e6abb6586f322c189f6b93,3
db07fd2ad9869f8356b1fbeefdac31e8,3
db03954a9a1cc5e71f6e0f73e81a628c,3
da2b78576894a7f95d45bfd20250cc54,3
d7624d219b6ffad980e91412174db310,3
d75acd4c5b7b4dfd32b9d9172b195419,3
d6df1c8cb71c59d9b52d828dc6d0f5b3,3
d64023c35e5c1452ce568e993ac12c86,3
d4a5e9f19897de65433c9d97bf4b9f8e,3
d44ccec15f5f86d14d6a2cfa67da1975,3
d3882d7abd0c66064d740d7ed04dd1ef,3
d387ea85dc301a91740e31360d355686,3
d26c616e241736e0c1c1ab14150239e7,3
d132b863416f85f2abb1a988ca05dd12,3
d02cbb85434c84acabb8e81bbf064d3e,3
cfa69922f9968e0e6271647abda09b09,3
cef29e793e232d30250331804cdb7000,3
cecc19ff12c206e6368dd1e9c22a848d,3
cd11a0920c498edb1da9ecd2d31aa599,3
cbd08b04b3f301152b7570da5e9c8cc4,3
ca994abc57b0bd7981d91d0061b3d8d6,3
c9b3b24308b1a4587ffa3e60fafc2b1f,3
c7c19110042036e6266adc998cbf1289,3
c76762dfb642ac154475239639f7f8f4,3
c6df3869c263531ebd51f0454a353605,3
c4fe9fc8b5e1b4f9992db983d0429854,3
c2919fbdb45366551c1e80d5cb35cd3f,3
c25d2fb6d22e04ce43c3652e3cacadad,3
Query:
-- Query 9: Average payment value per customer_unique_id
SELECT c."customer_unique_id", AVG(p."payment_value") as "average_payment"
FROM "olist_orders" o
JOIN "olist_order_payments" p ON o."order_id" = p."order_id"
JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
WHERE o."order_status" = 'delivered'
GROUP BY c."customer_unique_id"
LIMIT 100
Answer:
customer_unique_id,average_payment
0000366f3b9a7992bf8c76cfdf3221e2,141.9
0000b849f77a49e4a4ce2b2a4ca5be3f,27.19
0000f46a3911fa3c0805444483337064,86.22
0000f6ccb0745a6a4b88665a16c9f078,43.62
0004aac84e0df4da2b147fca70cf8255,196.89
0004bd2a26a76fe21f786e4fbd80607f,166.98
00050ab1314c0e55a6ca13cf7181fecf,35.38
00053a61a98854899e70ed204dd4bafe,419.18
0005e1862207bf6ccc02e4228effd9a0,150.12
0005ef4cd20d2893f0d9fbd94d3c0d97,129.76
0006fdc98a402fceb4eb0ee528f6a8d4,29.0
00082cbe03e478190aadbea78542e933,126.26
00090324bbad0e9342388303bb71ba0a,63.66
000949456b182f53c18b68d6babc79c1,82.05
000a5ad9c4601d2bbdd9ed765d5213b3,91.28
000bfa1d2f1a41876493be685390d6d3,46.85
000c8bdb58a29e7115cfc257230fb21b,29.0
000d460961d6dbfa3ec6c9f5805769e1,36.68
000de6019bb59f34c099a907c151d855,257.44
000e309254ab1fc5ba99dd469d36bdb4,39.21
000ec5bff359e1c0ad76a81a45cb598f,27.75
000ed48ceeb6f4bf8ad021a10a3c7b43,20.75
000fbf0473c10fc1ab6f8d2d286ce20c,362.38
0010a452c6d13139e50b57f19f52e04e,325.93
0010fb34b966d44409382af9e8fd5b77,61.8
001147e649a7b1afd577e873841632dd,212.16
00115fc7123b5310cf6d3a3aa932699e,76.11
0011805441c0d1b68b48002f1d005526,297.14
0011857aff0e5871ce5eb429f21cdaf5,192.83
0011c98589159d6149979563c504cb21,117.94
0012929d977a8d7280bb277c1e5f589d,155.65
0014a5a58da615f7b01a4f5e194bf5ea,99.82
0015752e079902b12cd00b9b7596276b,74.82
00172711b30d52eea8b313a7f2cced02,122.07
00191a9719ef48ebb5860b130347bf33,58.86
001926cef41060fae572e2e7b30bd2a4,91.21
001928b561575b2821c92254a2327d06,164.81
00196c4c9a3af7dd2ad10eade69c926f,37.58
00196fdb2bf9edfc35e88ebfbcf8d781,27.0
0019da6aa6bcb27cc32f1249bd12da05,87.71
0019e8c501c85848ac0966d45226fa1d,197.27
001a2bf0e46c684031af91fb2bce149d,36.73
001a34eb30ecb8e3aacb07c475ca4dd1,161.71
001a3a8e11d76c9a366c31a4aa2cc529,24.23
001ae5a1788703d64536c30362503e49,135.08
001deb796b28a3a128d6113857569aa4,63.33
001f3c4211216384d5fe59b041ce1461,35.84
002043098f10ba39a4600b6c52fbfe3c,237.81
002311514717ca8b65b09a26cdf7b91a,124.32
0023557a94bef0038066b5d1b3dc763e,107.44
002471155ecd08d208d1376720e2a907,92.18
00256bf7b05c08f6a5849df3d0a64f1f,57.73
0025795df7a7d077c4c90162fa820085,214.08
0027324a96d26a2bc7d69262f83c8403,46.78
0028a7d8db7b0247652509358ad8d755,177.435
0028cfeb9dfcd3628a56d5b6400deef5,118.2
00293787e2aec37a9c253b63fdfe2049,257.87
002aba8c1af80acacef6e011f9f23262,217.74
002ae492472e45ad6ebeb7a625409392,218.66
002b4cd83fabaffaa475f78ea5ef3e08,64.42
002bdeb33da5b1b3ce8b9c822f749c82,38.09
002cdf87d4c03f08f7eb4551a923affc,228.67
002d3bd901608f67c3fc11eaaa842b13,28.76
002d71b244beb91ca7030b15ab526446,130.56
002da6dde369f6a8b4c999ed61eb5a87,52.38
002eb8b96288f3804e21d2777ac29895,137.99
002ed12115742033f015cb3c269ccf68,109.79
002ef00822613c94613e60e03b169fef,114.04
002feefec5af0a3b26ee7839c66d205e,77.57
003035f5ec76f2220098377482de93c9,62.47
003162bf0351f47a1a247992b8b9b42d,536.6
00324c9f4d710e7bac5c5ba679714430,54.89
0032c76b20340da25249092a268ce66c,144.94
0032ca69771a7758ce643258bb9e4ac7,62.45
0033f4a2887e07e25aa1204d482f41ba,425.04
00344274804f3b8003de1b0562ae01df,226.23
0034c76b7e6a17d738375b99afc2f01e,44.23
0035029989e6fc5cf030918a5f9f2037,546.12
003650b504826ea534e02eba0ab58dd5,21.77
0036a074f98b80c4f1fc33dbbcf9c552,42.62
0036b4a3d09ad551a5188c2e374da402,162.77
0036d365b138cc0ee06bed755bcb5044,109.5
00370dfde3d012c420d29657afc2fc8b,237.0
00377a18050b898b93e2c774be9947db,65.78
0037aa56b017c105c3a9d47af71fff98,443.73
0037d2bbb9ebc39d9114aea27ee16d72,143.73
0037eb1ff742ee2e71ba887f65f3c6f3,228.79
003800162424b7b5b3d75c9cf22a66e7,107.81
00391594070baf8603f5fdc1d0c6a48c,119.32
003a5571a07dcf09bf117d13d2980ba3,181.82
003a7a8eb096ed3cbf713d2def1ca701,157.46
003ac9408252444b489b1bfc013f5f8c,36.98
003ae409f37c3c30cb1c974af3a42692,216.32
003c2067070f5b3d923235b1ea1cc17b,147.38
003c457932a554e4df13834237b1ed00,142.51
003d56767e53e08671de00da3fba8d40,178.59
003db7adfcdc49857b095a50191b6c9d,542.66
003e28cb6fab8a0901bff9229612375f,137.26
003e2af81ea3c72fbdd093f07724a4de,63.74
003f4901fdb60ae9c1e2538b84c208e1,162.79
Query:
-- Query 10: Customer details with delivered orders and average payment
SELECT c."customer_unique_id", c."customer_city", c."customer_state",
       COUNT(*) as "delivered_orders", AVG(p."payment_value") as "average_payment"
FROM "olist_orders" o
JOIN "olist_order_payments" p ON o."order_id" = p."order_id"
JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
WHERE o."order_status" = 'delivered'
GROUP BY c."customer_unique_id", c."customer_city", c."customer_state"
ORDER BY "delivered_orders" DESC
LIMIT 100
Answer:
Too long, hard cut:
customer_unique_id,customer_city,customer_state,delivered_orders,average_payment
9a736b248f67d166d2fbb006bcb877c3,sao paulo,SP,33,7.075454545454543
569aa12b73b5f7edeaa6f2a01603e381,sao paulo,SP,26,2.4107692307692306
f9ae226291893fda10af7965268fb7f6,guarulhos,SP,23,22.65521739130435
2524dcec233c3766f2c2b22f69fd65f4,tupa,SP,22,1.856818181818182
24f12460aad399ba18f4ed2c2fbab65d,campinas,SP,19,4.354210526315789
6fbc7cdadbb522125f4b27ae9dee4060,rio de janeiro,RJ,19,10.82842105263158
1d2435aa3b858d45c707c9fc25e18779,rio de janeiro,RJ,16,9.22375
25ba76039a1caff121dfcb0d66e54780,cabo frio,RJ,15,5.799333333333333
8d50f5eadf50201ccdcedfb9e2ac8455,sao paulo,SP,15,58.61799999999999
c4b224d2c784bae11ae98b6ae9f2454c,sao paulo,SP,15,49.384
1bc3d5e384c365c86cf79078f32eb495,embu-guacu,SP,14,7.183571428571428
301d1ce5a76b7e1bc47e5115bf5eb6ba,palmas,TO,14,37.825
94a19681bf6faa3c6ce3e2df1c2d97cb,sao paulo,SP,14,14.408571428571431
7293e0b38ab0dab128e6bfb7239c37ad,sao paulo,SP,13,8.25153846153846
74adf920dbd3d2e6e9f18acd88b2fd41,ubatuba,SP,13,7.863076923076926
aae867e923db95a5af878ffec19ebd8c,sao paulo,SP,13,14.37846153846154
c411c8b6dbaffd467263f87a23f2cf52,sao paulo,SP,13,16.103846153846153
024676cef113f6c81db6c5b8d29e5ee9,sao paulo,SP,12,5.298333333333333
39c7f8c4e4552af113351a650816296c,sao jose dos pinhais,PR,12,5.830833333333334
85963fd37bfd387aa6d915d8a1065486,atibaia,SP,12,73.28666666666668
90807fdb59eec2152bc977feeb6e47e7,suzano,SP,12,8.9875
db1af3fd6b23ac3873ef02619d548f9c,itaqui,RS,12,27.435000000000002
0fc594155e889688ea4477afcd26a134,ilheus,BA,11,19.12636363636363
2f8b722d3e62bb8a9860c7a29ad2b60f,sumare,SP,11,20.718181818181815
43128f4462af59091a28f9141a3ee7ba,itaborai,RJ,11,12.49818181818182
a378caa847f8b44d00411d34449359d1,sao jose dos campos,SP,11,7.006363636363636
b0f3a98136fb0e22d808f855bd430970,canoas,RS,11,13.377272727272727
c96dac240f97b3f694b804e6406af73d,cabo frio,RJ,11,7.969090909090909
ff4bb0e2cade5df30146a1d570ae777d,bom jesus dos perdoes,SP,11,28.890909090909098
1d37df739a7cdbd28609dc2954cc2c75,sao joao de meriti,RJ,10,13.799000000000001
3806104dbbc3d14c17b091b3b8e38d59,sao paulo,SP,10,15.424000000000001
afc3f49cfd0567e08a8c452beb212c04,taubate,SP,10,9.065999999999999
ed917c786a8a3e411eae87aeca27cb27,cruz alta,RS,10,28.881999999999998
0fff4016f4008007ba2bb7d63ebae39d,mogi das cruzes,SP,9,13.520000000000001
182ebbe49711dd49de4fbbdf4a999c10,sao paulo,SP,9,62.84222222222221
2eba6acde8e5a52e86f94b2c6224a986,franca,SP,9,21.008888888888887
3069f30fbf3f30057b1b4ff36c72208e,rio de janeiro,RJ,9,13.094444444444443
3e43e6105506432c953e165fb2acf44c,praia grande,SP,9,130.29555555555555
495fe7ae31686381c8145b2936e761dc,rio de janeiro,RJ,9,33.68888888888889
6bd5b501f37638859ccc1dc94cce730d,carapicuiba,SP,9,3.776666666666667
a4d4a76b47ccec27db5ea63da11debf5,salvador,BA,9,34.80333333333333
e0ff4805ba6693550d1db7d374c477c9,conselheiro lafaiete,MG,9,8.575555555555557
08d8fd00898e7cc99d6e32c74d7d3ce5,campos dos goytacazes,RJ,8,4.375
096e351116755fe4c3c1e48eaf301a41,sao paulo,SP,8,27.18625
142f18a4a7cd370e40b64f34baf14a6a,sao jose dos pinhais,PR,8,4.9399999999999995
1b6c7548a2a1f9037c1fd3ddfed95f33,ituiutaba,MG,8,119.87625000000001
311b7759da40d8d24724a882f0641308,goiania,GO,8,77.76
a52327252e5d68739d85eadb7dd461e4,franca,SP,8,21.465
aad0fb3a1680f7a08d9b8de7da72e1cc,rio de janeiro,RJ,8,12.28875
ab719d1153364ba40df26f5e44c6192a,brotas,SP,8,11.48125
c63a8c4fb13043a3fbe33bd17c69d17d,caucaia,CE,8,4.2425
f0fd988c7c2a4cba167138a8adada6ca,cansancao,BA,8,21.942500000000003
31628ac4d85d1c46ebf7dad444adcbe3,paraty,RJ,7,23.401428571428568
4532ac5f2f4f8c943a41d1ba00bd6c6d,goiania,GO,7,19.225714285714282
56437a026e07b2b2271b8742aee81fb9,indaiatuba,SP,7,39.55714285714286
58b051c30d684ac12a2049a49c856203,feira de santana,BA,7,6.67
6469f99c1f9dfae7733b25662e7f1782,santos,SP,7,108.40428571428572
6acc5385a15c441abe050fc7abda50bf,salvador,BA,7,58.62428571428571
6f35424ab0a4f25807ac4e03b155832e,rio de janeiro,RJ,7,44.25714285714286
7019c99575147f8ea1bbf0a6e281bbf9,rio de janeiro,RJ,7,22.107142857142858
7634efb2f26e897125a36155a6f92889,sao paulo,SP,7,14.448571428571428
79f3d6597edbdbed1545a11e3d2fa280,contagem,MG,7,9.557142857142859
7f6fd66526ed914998d483cff9b7bdd7,natal,RN,7,146.53
8d3a01dad8496e7c850d5b3d580c8e90,sao paulo,SP,7,9.304285714285713
90f323e9f0948ddd96c6f6a8ecc75830,tijucas,SC,7,35.028571428571425
9620623f9ea546719cb3cd99bbb879a9,paulinia,SP,7,15.831428571428573
96ce642e637cf74a0d3023db31e59d16,adamantina,SP,7,45.790000000000006
993d47c24f159f09b8904941581211b3,curitiba,PR,7,18.67142857142857
bddc05c034061c84f92fe1710bfa5fe4,sao joaquim da barra,SP,7,31.934285714285718
be74c431147c32ab2d7c7cef5e4a995f,caxias do sul,RS,7,205.20857142857145
c5610cd24fef40cd91dbc4f45183eef0,sao paulo,SP,7,9.847142857142858
ca77025e7201e3b30c44b472ff346268,recife,PE,7,160.38857142857142
cea1537ac1a5e083b8626a93f85475cc,sao vicente,SP,7,5.96
cfaec087ed620ecebc6e6f82fe276fe2,goiania,GO,7,9.892857142857142
dd162f2be22e534992b3f874cc57eda0,guaruja,SP,7,1
Query:
-- Query 11: Top 3 customers with the most delivered orders
SELECT c."customer_unique_id", c."customer_city", c."customer_state",
       COUNT(*) as "delivered_orders"
FROM "olist_orders" o
JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
WHERE o."order_status" = 'delivered'
GROUP BY c."customer_unique_id", c."customer_city", c."customer_state"
ORDER BY "delivered_orders" DESC
LIMIT 3
Answer:
customer_unique_id,customer_city,customer_state,delivered_orders
8d50f5eadf50201ccdcedfb9e2ac8455,sao paulo,SP,15
3e43e6105506432c953e165fb2acf44c,praia grande,SP,9
1b6c7548a2a1f9037c1fd3ddfed95f33,ituiutaba,MG,7
Query:
-- Query 12: Payment details for orders of the top 3 customers
WITH top_customers AS (
  SELECT c."customer_unique_id"
  FROM "olist_orders" o
  JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
  WHERE o."order_status" = 'delivered'
  GROUP BY c."customer_unique_id"
  ORDER BY COUNT(*) DESC
  LIMIT 3
)
SELECT c."customer_unique_id", p."payment_value"
FROM "olist_orders" o
JOIN "olist_order_payments" p ON o."order_id" = p."order_id"
JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
JOIN top_customers tc ON c."customer_unique_id" = tc."customer_unique_id"
WHERE o."order_status" = 'delivered'
LIMIT 100
Answer:
customer_unique_id,payment_value
8d50f5eadf50201ccdcedfb9e2ac8455,34.44
3e43e6105506432c953e165fb2acf44c,364.18
8d50f5eadf50201ccdcedfb9e2ac8455,53.38
8d50f5eadf50201ccdcedfb9e2ac8455,51.75
ca77025e7201e3b30c44b472ff346268,213.68
ca77025e7201e3b30c44b472ff346268,94.2
8d50f5eadf50201ccdcedfb9e2ac8455,38.66
3e43e6105506432c953e165fb2acf44c,115.4
8d50f5eadf50201ccdcedfb9e2ac8455,166.71
8d50f5eadf50201ccdcedfb9e2ac8455,62.95
ca77025e7201e3b30c44b472ff346268,95.56
ca77025e7201e3b30c44b472ff346268,192.12
3e43e6105506432c953e165fb2acf44c,65.1
8d50f5eadf50201ccdcedfb9e2ac8455,21.77
8d50f5eadf50201ccdcedfb9e2ac8455,21.77
3e43e6105506432c953e165fb2acf44c,130.58
3e43e6105506432c953e165fb2acf44c,98.72
3e43e6105506432c953e165fb2acf44c,76.17
8d50f5eadf50201ccdcedfb9e2ac8455,81.89
ca77025e7201e3b30c44b472ff346268,78.86
8d50f5eadf50201ccdcedfb9e2ac8455,96.4
8d50f5eadf50201ccdcedfb9e2ac8455,107.85
8d50f5eadf50201ccdcedfb9e2ac8455,51.75
3e43e6105506432c953e165fb2acf44c,65.87
ca77025e7201e3b30c44b472ff346268,159.23
8d50f5eadf50201ccdcedfb9e2ac8455,30.41
8d50f5eadf50201ccdcedfb9e2ac8455,21.77
3e43e6105506432c953e165fb2acf44c,132.95
ca77025e7201e3b30c44b472ff346268,289.07
3e43e6105506432c953e165fb2acf44c,123.69
8d50f5eadf50201ccdcedfb9e2ac8455,37.77
Query:
-- Query 13: Average payment value for top 3 customers
WITH top_customers AS (
  SELECT c."customer_unique_id", c."customer_city", c."customer_state"
  FROM "olist_orders" o
  JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
  WHERE o."order_status" = 'delivered'
  GROUP BY c."customer_unique_id"
  ORDER BY COUNT(*) DESC
  LIMIT 3
)
SELECT tc."customer_unique_id", tc."customer_city", tc."customer_state",
       AVG(p."payment_value") as "average_payment"
FROM "olist_orders" o
JOIN "olist_order_payments" p ON o."order_id" = p."order_id"
JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
JOIN top_customers tc ON c."customer_unique_id" = tc."customer_unique_id"
WHERE o."order_status" = 'delivered'
GROUP BY tc."customer_unique_id", tc."customer_city", tc."customer_state"
LIMIT 100
Answer:
customer_unique_id,customer_city,customer_state,average_payment
3e43e6105506432c953e165fb2acf44c,praia grande,SP,130.29555555555555
8d50f5eadf50201ccdcedfb9e2ac8455,sao paulo,SP,58.61799999999999
ca77025e7201e3b30c44b472ff346268,recife,PE,160.3885714285714
End Exploring Related Columns
Task: Please calculate the average payment value, city, and state for the top 3 customers with the most delivered orders.

Please answer only one complete SQL in sqlite dialect in ```sql``` format.
Usage example: ```sql
SELECT DISTINCT "column_name" FROM "table_name" WHERE ... ``` (Replace "table_name" with the actual table name. Enclose table and column names with double quotations if they contain special characters or match reserved keywords.)
Follow the answer format like: To calculate the average payment value, city, and state for the top 3 customers with the most delivered orders, we first identify the customers who have the highest number of orders with a status of 'delivered'. For these top 3 customers, we then compute their average payment value from all their orders and retrieve their associated city and state information.

```csv
customer_unique_id,average_payment_value,customer_city,customer_state
cust_id1:str,avg_payment1:float,city1:str,state1:str
cust_id2:str,avg_payment2:float,city2:str,state2:str
cust_id3:str,avg_payment3:float,city3:str,state3:str
(Attention: answer in three rows)
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: 

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-27 21:48:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 21:48:39 - root - INFO - To calculate the average payment value, city, and state for the top 3 customers with the most delivered orders, we first identify the customers who have the highest number of orders with a status of 'delivered'. For these top 3 customers, we then compute their average payment value from all their orders and retrieve their associated city and state information.

```sql
WITH customer_order_counts AS (
    SELECT c."customer_unique_id", c."customer_city", c."customer_state", COUNT(*) as "delivered_orders"
    FROM "olist_orders" o
    INNER JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
    WHERE o."order_status" = 'delivered'
    GROUP BY c."customer_unique_id", c."customer_city", c."customer_state"
),
top_customers AS (
    SELECT "customer_unique_id", "customer_city", "customer_state"
    FROM customer_order_counts
    ORDER BY "delivered_orders" DESC
    LIMIT 3
)
SELECT tc."customer_unique_id", AVG(p."payment_value") as "average_payment_value",
       tc."customer_city", tc."customer_state"
FROM "olist_orders" o
INNER JOIN "olist_order_payments" p ON o."order_id" = p."order_id"
INNER JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
INNER JOIN top_customers tc ON c."customer_unique_id" = tc."customer_unique_id"
WHERE o."order_status" = 'delivered'
GROUP BY tc."customer_unique_id", tc."customer_city", tc."customer_state";
```
2025-01-27 21:49:06 - root - INFO - itercount: 1
2025-01-27 21:49:06 - root - INFO - 0
2025-01-27 21:49:06 - root - INFO - results: 
customer_unique_id,average_payment_value,customer_city,customer_state
1b6c7548a2a1f9037c1fd3ddfed95f33,119.87625,ituiutaba,MG
3e43e6105506432c953e165fb2acf44c,130.29555555555555,praia grande,SP
8d50f5eadf50201ccdcedfb9e2ac8455,58.61799999999999,sao paulo,SP


2025-01-27 21:49:06 - root - INFO - Please check the answer again by reviewing Please calculate the average payment value, city, and state for the top 3 customers with the most delivered orders., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: To calculate the average payment value, city, and state for the top 3 customers with the most delivered orders, we first identify the customers who have the highest number of orders with a status of 'delivered'. For these top 3 customers, we then compute their average payment value from all their orders and retrieve their associated city and state information.

```csv
customer_unique_id,average_payment_value,customer_city,customer_state
cust_id1:str,avg_payment1:float,city1:str,state1:str
cust_id2:str,avg_payment2:float,city2:str,state2:str
cust_id3:str,avg_payment3:float,city3:str,state3:str
(Attention: answer in three rows)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
customer_unique_id,average_payment_value,customer_city,customer_state
1b6c7548a2a1f9037c1fd3ddfed95f33,119.87625,ituiutaba,MG
3e43e6105506432c953e165fb2acf44c,130.29555555555555,praia grande,SP
8d50f5eadf50201ccdcedfb9e2ac8455,58.61799999999999,sao paulo,SP
Current sql:
WITH customer_order_counts AS (
    SELECT c."customer_unique_id", c."customer_city", c."customer_state", COUNT(*) as "delivered_orders"
    FROM "olist_orders" o
    INNER JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
    WHERE o."order_status" = 'delivered'
    GROUP BY c."customer_unique_id", c."customer_city", c."customer_state"
),
top_customers AS (
    SELECT "customer_unique_id", "customer_city", "customer_state"
    FROM customer_order_counts
    ORDER BY "delivered_orders" DESC
    LIMIT 3
)
SELECT tc."customer_unique_id", AVG(p."payment_value") as "average_payment_value",
       tc."customer_city", tc."customer_state"
FROM "olist_orders" o
INNER JOIN "olist_order_payments" p ON o."order_id" = p."order_id"
INNER JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
INNER JOIN top_customers tc ON c."customer_unique_id" = tc."customer_unique_id"
WHERE o."order_status" = 'delivered'
GROUP BY tc."customer_unique_id", tc."customer_city", tc."customer_state";
2025-01-27 21:49:45 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 21:49:45 - root - INFO - To calculate the average payment value, city, and state for the top 3 customers with the most delivered orders, we first identify the customers who have the highest number of orders with a status of 'delivered'. For these top 3 customers, we then compute their average payment value from all their orders and retrieve their associated city and state information.

```csv
customer_unique_id,average_payment_value,customer_city,customer_state
1b6c7548a2a1f9037c1fd3ddfed95f33,119.8763,ituiutaba,MG
3e43e6105506432c953e165fb2acf44c,130.2956,praia grande,SP
8d50f5eadf50201ccdcedfb9e2ac8455,58.6180,sao paulo,SP
```

```sql
WITH customer_order_counts AS (
    SELECT c."customer_unique_id", c."customer_city", c."customer_state", COUNT(*) AS "delivered_orders"
    FROM "olist_orders" o
    INNER JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
    WHERE o."order_status" = 'delivered'
    GROUP BY c."customer_unique_id", c."customer_city", c."customer_state"
),
top_customers AS (
    SELECT "customer_unique_id", "customer_city", "customer_state"
    FROM customer_order_counts
    ORDER BY "delivered_orders" DESC, "customer_unique_id" ASC
    LIMIT 3
)
SELECT tc."customer_unique_id", ROUND(AVG(p."payment_value"), 4) AS "average_payment_value",
       tc."customer_city", tc."customer_state"
FROM "olist_orders" o
INNER JOIN "olist_order_payments" p ON o."order_id" = p."order_id"
INNER JOIN "olist_customers" c ON o."customer_id" = c."customer_id"
INNER JOIN top_customers tc ON c."customer_unique_id" = tc."customer_unique_id"
WHERE o."order_status" = 'delivered'
GROUP BY tc."customer_unique_id", tc."customer_city", tc."customer_state";
```
2025-01-27 21:50:14 - root - INFO - itercount: 2
2025-01-27 21:50:14 - root - INFO - 0
2025-01-27 21:50:14 - root - INFO - Total iteration counts: 2
