2025-01-24 07:55:38 - openai._base_client - INFO - Retrying request to /chat/completions in 0.473141 seconds
2025-01-24 07:56:12 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 07:56:12 - root - INFO - SQL:
SELECT "company_id", "date_joined", "year_founded"
   FROM "companies_dates"
   LIMIT 100;
Results:
company_id,date_joined,year_founded
109,2020-09-08T00:00:00.000,2004
821,2019-05-16T00:00:00.000,2009
153,2019-07-11T00:00:00.000,2016
972,2018-10-17T00:00:00.000,2016
1022,2021-06-02T00:00:00.000,2013
433,2021-04-17T00:00:00.000,2013
747,2018-03-27T00:00:00.000,2011
902,2021-01-27T00:00:00.000,2015
1065,2021-06-01T00:00:00.000,2015
388,2018-05-30T00:00:00.000,2009
748,2019-02-14T00:00:00.000,2009
189,2017-06-24T00:00:00.000,1919
848,2021-06-01T00:00:00.000,2019
556,2022-02-15T00:00:00.000,2011
999,2021-11-17T00:00:00.000,2020
396,2021-10-21T00:00:00.000,2021
931,2021-09-24T00:00:00.000,2020
364,2019-02-01T00:00:00.000,2015
732,2022-01-27T00:00:00.000,2017
906,2021-06-10T00:00:00.000,2017
72,2015-01-23T00:00:00.000,2006
983,2019-08-22T00:00:00.000,1999
898,2022-01-25T00:00:00.000,2015
844,2021-07-07T00:00:00.000,2018
894,2021-12-06T00:00:00.000,2020
813,2021-08-10T00:00:00.000,2017
743,2020-12-24T00:00:00.000,2015
226,2021-01-24T00:00:00.000,2020
963,2021-10-05T00:00:00.000,2017
764,2021-12-07T00:00:00.000,2018
839,2021-12-28T00:00:00.000,2016
1033,2021-01-27T00:00:00.000,2006
725,2022-01-25T00:00:00.000,2010
549,2021-09-22T00:00:00.000,2016
667,2015-01-16T00:00:00.000,2014
755,2021-09-08T00:00:00.000,2017
782,2022-01-31T00:00:00.000,2021
175,2019-06-25T00:00:00.000,2011
398,2021-10-15T00:00:00.000,2017
814,2021-11-16T00:00:00.000,2014
436,2017-04-14T00:00:00.000,2006
1046,2021-06-16T00:00:00.000,2014
565,2021-04-21T00:00:00.000,2013
781,2021-08-31T00:00:00.000,2018
997,2021-12-06T00:00:00.000,2011
194,2021-03-18T00:00:00.000,2001
249,2021-06-29T00:00:00.000,2019
434,2021-05-19T00:00:00.000,2014
1035,2021-11-18T00:00:00.000,2020
969,2022-01-26T00:00:00.000,2014
1018,2021-02-18T00:00:00.000,2011
355,2021-09-14T00:00:00.000,2017
934,2020-03-17T00:00:00.000,2011
1054,2021-05-18T00:00:00.000,2016
901,2021-11-08T00:00:00.000,2020
173,2021-12-20T00:00:00.000,2018
738,2022-01-11T00:00:00.000,2018
422,2022-02-16T00:00:00.000,2019
830,2021-03-30T00:00:00.000,2017
1004,2021-05-24T00:00:00.000,2016
951,2015-03-06T00:00:00.000,2011
734,2022-01-27T00:00:00.000,2012
1063,2021-11-10T00:00:00.000,2018
623,2015-04-21T00:00:00.000,2013
846,2019-10-21T00:00:00.000,2015
823,2019-05-21T00:00:00.000,2000
944,2021-07-22T00:00:00.000,2005
1030,2021-08-09T00:00:00.000,2019
824,2016-04-14T00:00:00.000,2012
930,2022-02-22T00:00:00.000,2017
370,2018-07-09T00:00:00.000,2010
618,2018-10-18T00:00:00.000,2009
456,2020-01-29T00:00:00.000,2016
893,2021-09-02T00:00:00.000,2020
812,2022-03-31T00:00:00.000,2019
1001,2020-09-21T00:00:00.000,2020
703,2021-12-02T00:00:00.000,2018
884,2021-12-14T00:00:00.000,2020
404,2021-03-19T00:00:00.000,2010
952,2022-03-30T00:00:00.000,2021
625,2020-01-28T00:00:00.000,2012
971,2021-11-02T00:00:00.000,2015
796,2017-07-20T00:00:00.000,2012
909,2022-01-27T00:00:00.000,2015
587,2018-05-17T00:00:00.000,2014
273,2022-04-05T00:00:00.000,2013
771,2021-09-28T00:00:00.000,2017
758,2021-12-21T00:00:00.000,2016
652,2021-06-15T00:00:00.000,2015
8,2017-12-20T00:00:00.000,2015
760,2020-11-17T00:00:00.000,2016
394,2022-01-31T00:00:00.000,2016
393,2021-09-27T00:00:00.000,2013
870,2021-02-16T00:00:00.000,2016
804,2021-09-16T00:00:00.000,2019
1041,2021-11-02T00:00:00.000,2015
443,2022-03-17T00:00:00.000,2017
978,2021-01-07T00:00:00.000,2015
612,2021-12-31T00:00:00.000,2016
714,2017-10-17T00:00:00.000,2021

2025-01-24 07:56:12 - root - INFO - SQL:
SELECT DISTINCT "industry"
   FROM "companies_industries"
   LIMIT 100;
Results:
industry
Fintech
Internet software & services
E-commerce & direct-to-consumer
Health
Consumer & retail
Hardware
Other
Mobile & telecommunications
Artificial intelligence
Auto & transportation
Cybersecurity
Data management & analytics
Edtech
"""Supply chain, logistics, & delivery"""
Travel

2025-01-24 07:56:12 - root - INFO - SQL:
SELECT "company_id", "industry"
   FROM "companies_industries"
   LIMIT 100;
Results:
company_id,industry
316,Fintech
162,Fintech
803,Fintech
278,Internet software & services
983,Fintech
951,E-commerce & direct-to-consumer
650,Internet software & services
450,Fintech
556,Internet software & services
318,Fintech
889,E-commerce & direct-to-consumer
189,Health
848,Fintech
556,Internet software & services
999,Internet software & services
396,Fintech
931,Consumer & retail
364,E-commerce & direct-to-consumer
732,Fintech
906,Hardware
72,Hardware
983,Fintech
898,Internet software & services
844,Fintech
894,Fintech
813,Fintech
743,Other
226,Mobile & telecommunications
963,Fintech
764,Fintech
839,E-commerce & direct-to-consumer
1033,Internet software & services
725,Health
549,Artificial intelligence
667,Mobile & telecommunications
755,Fintech
782,Fintech
175,Fintech
398,Fintech
814,E-commerce & direct-to-consumer
436,Artificial intelligence
1046,Artificial intelligence
565,Artificial intelligence
781,Internet software & services
997,E-commerce & direct-to-consumer
194,Internet software & services
249,Fintech
434,Auto & transportation
1035,Cybersecurity
969,Data management & analytics
1018,Other
355,Internet software & services
934,E-commerce & direct-to-consumer
1054,Fintech
901,Cybersecurity
173,Internet software & services
738,Fintech
422,Internet software & services
830,Health
1004,Other
951,E-commerce & direct-to-consumer
734,Internet software & services
1063,Fintech
623,Fintech
846,Data management & analytics
823,Fintech
944,Fintech
1030,Artificial intelligence
824,E-commerce & direct-to-consumer
930,Internet software & services
370,Data management & analytics
618,E-commerce & direct-to-consumer
456,Cybersecurity
893,E-commerce & direct-to-consumer
812,Other
1001,Other
703,Cybersecurity
884,Health
404,Cybersecurity
952,Internet software & services
625,Internet software & services
971,Internet software & services
796,Edtech
909,Fintech
587,Artificial intelligence
273,Health
771,Internet software & services
758,Internet software & services
652,Internet software & services
8,Consumer & retail
760,Mobile & telecommunications
394,Health
393,Fintech
870,Other
804,Artificial intelligence
1041,Internet software & services
443,Artificial intelligence
978,Internet software & services
612,Auto & transportation
714,Mobile & telecommunications

2025-01-24 07:56:12 - root - INFO - SQL:
SELECT "company_id", "valuation"
   FROM "companies_funding"
   WHERE "valuation" >= 1000000000
   LIMIT 100;
Results:
company_id,valuation
548,2000000000
645,1000000000
615,1000000000
51,10000000000
680,1000000000
457,2000000000
429,2000000000
933,1000000000
568,2000000000
478,2000000000
881,1000000000
189,4000000000
848,1000000000
556,2000000000
999,1000000000
396,2000000000
931,1000000000
364,2000000000
732,1000000000
906,1000000000
72,8000000000
983,1000000000
898,1000000000
844,1000000000
894,1000000000
813,1000000000
743,1000000000
226,4000000000
963,1000000000
764,1000000000
839,1000000000
1033,1000000000
725,1000000000
549,2000000000
667,1000000000
755,1000000000
782,1000000000
175,4000000000
398,2000000000
814,1000000000
436,2000000000
1046,1000000000
565,2000000000
781,1000000000
997,1000000000
194,4000000000
249,3000000000
434,2000000000
1035,1000000000
969,1000000000
1018,1000000000
355,2000000000
934,1000000000
1054,1000000000
901,1000000000
173,4000000000
738,1000000000
422,2000000000
830,1000000000
1004,1000000000
951,1000000000
734,1000000000
1063,1000000000
623,1000000000
846,1000000000
823,1000000000
944,1000000000
1030,1000000000
824,1000000000
930,1000000000
370,2000000000
618,1000000000
456,2000000000
893,1000000000
812,1000000000
1001,1000000000
703,1000000000
884,1000000000
404,2000000000
952,1000000000
625,1000000000
971,1000000000
796,1000000000
909,1000000000
587,2000000000
273,3000000000
771,1000000000
1005,1000000000
758,1000000000
652,1000000000
8,38000000000
760,1000000000
394,2000000000
393,2000000000
870,1000000000
804,1000000000
1041,1000000000
443,2000000000
978,1000000000
612,1000000000

2025-01-24 07:56:12 - root - INFO - SQL:
SELECT "company_id", "date_joined"
   FROM "companies_dates"
   WHERE "date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
   LIMIT 100;
Results:
company_id,date_joined
109,2020-09-08T00:00:00.000
821,2019-05-16T00:00:00.000
153,2019-07-11T00:00:00.000
1022,2021-06-02T00:00:00.000
433,2021-04-17T00:00:00.000
902,2021-01-27T00:00:00.000
1065,2021-06-01T00:00:00.000
748,2019-02-14T00:00:00.000
848,2021-06-01T00:00:00.000
999,2021-11-17T00:00:00.000
396,2021-10-21T00:00:00.000
931,2021-09-24T00:00:00.000
364,2019-02-01T00:00:00.000
906,2021-06-10T00:00:00.000
983,2019-08-22T00:00:00.000
844,2021-07-07T00:00:00.000
894,2021-12-06T00:00:00.000
813,2021-08-10T00:00:00.000
743,2020-12-24T00:00:00.000
226,2021-01-24T00:00:00.000
963,2021-10-05T00:00:00.000
764,2021-12-07T00:00:00.000
839,2021-12-28T00:00:00.000
1033,2021-01-27T00:00:00.000
549,2021-09-22T00:00:00.000
755,2021-09-08T00:00:00.000
175,2019-06-25T00:00:00.000
398,2021-10-15T00:00:00.000
814,2021-11-16T00:00:00.000
1046,2021-06-16T00:00:00.000
565,2021-04-21T00:00:00.000
781,2021-08-31T00:00:00.000
997,2021-12-06T00:00:00.000
194,2021-03-18T00:00:00.000
249,2021-06-29T00:00:00.000
434,2021-05-19T00:00:00.000
1035,2021-11-18T00:00:00.000
1018,2021-02-18T00:00:00.000
355,2021-09-14T00:00:00.000
934,2020-03-17T00:00:00.000
1054,2021-05-18T00:00:00.000
901,2021-11-08T00:00:00.000
173,2021-12-20T00:00:00.000
830,2021-03-30T00:00:00.000
1004,2021-05-24T00:00:00.000
1063,2021-11-10T00:00:00.000
846,2019-10-21T00:00:00.000
823,2019-05-21T00:00:00.000
944,2021-07-22T00:00:00.000
1030,2021-08-09T00:00:00.000
456,2020-01-29T00:00:00.000
893,2021-09-02T00:00:00.000
1001,2020-09-21T00:00:00.000
703,2021-12-02T00:00:00.000
884,2021-12-14T00:00:00.000
404,2021-03-19T00:00:00.000
625,2020-01-28T00:00:00.000
971,2021-11-02T00:00:00.000
771,2021-09-28T00:00:00.000
758,2021-12-21T00:00:00.000
652,2021-06-15T00:00:00.000
760,2020-11-17T00:00:00.000
393,2021-09-27T00:00:00.000
870,2021-02-16T00:00:00.000
804,2021-09-16T00:00:00.000
1041,2021-11-02T00:00:00.000
978,2021-01-07T00:00:00.000
421,2020-11-16T00:00:00.000
449,2021-07-03T00:00:00.000
1022,2021-06-02T00:00:00.000
644,2021-01-25T00:00:00.000
718,2021-09-30T00:00:00.000
920,2021-08-10T00:00:00.000
1048,2021-09-30T00:00:00.000
1024,2021-04-22T00:00:00.000
929,2021-12-22T00:00:00.000
863,2021-12-07T00:00:00.000
662,2020-12-21T00:00:00.000
1027,2021-06-24T00:00:00.000
783,2021-03-26T00:00:00.000
592,2021-11-17T00:00:00.000
1023,2021-01-26T00:00:00.000
1051,2021-11-03T00:00:00.000
633,2021-04-07T00:00:00.000
635,2021-06-02T00:00:00.000
697,2021-12-20T00:00:00.000
886,2021-03-30T00:00:00.000
798,2021-02-11T00:00:00.000
1008,2021-11-08T00:00:00.000
701,2020-12-31T00:00:00.000
825,2021-10-13T00:00:00.000
344,2021-06-29T00:00:00.000
643,2021-12-15T00:00:00.000
509,2021-08-04T00:00:00.000
979,2021-02-25T00:00:00.000
1031,2021-10-07T00:00:00.000
817,2021-05-04T00:00:00.000
943,2019-03-22T00:00:00.000
975,2021-04-30T00:00:00.000
647,2020-12-10T00:00:00.000

2025-01-24 07:56:12 - root - INFO - SQL:
SELECT ci."industry", COUNT(*) AS "new_unicorns"
   FROM "companies_dates" cd
   JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
   WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
   GROUP BY ci."industry"
   LIMIT 100;
Results:
industry,new_unicorns
"""Supply chain, logistics, & delivery""",36
Artificial intelligence,53
Auto & transportation,14
Consumer & retail,11
Cybersecurity,38
Data management & analytics,31
E-commerce & direct-to-consumer,76
Edtech,17
Fintech,179
Hardware,15
Health,52
Internet software & services,156
Mobile & telecommunications,18
Other,43
Travel,7

2025-01-24 07:56:12 - root - INFO - SQL:
SELECT ci."industry", COUNT(*) AS "new_unicorns"
   FROM "companies_dates" cd
   JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
   WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
   GROUP BY ci."industry"
   ORDER BY "new_unicorns" DESC
   LIMIT 1;
Results:
industry,new_unicorns
Fintech,179

2025-01-24 07:56:12 - root - INFO - SQL:
SELECT CAST(COUNT(*) AS FLOAT) / 3 AS "average_new_unicorns_per_year"
   FROM "companies_dates" cd
   JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
   WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
     AND ci."industry" = (
       SELECT ci."industry"
       FROM "companies_dates" cd
       JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
       WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
       GROUP BY ci."industry"
       ORDER BY COUNT(*) DESC
       LIMIT 1
     )
   LIMIT 100;
Results:
average_new_unicorns_per_year
59.666666666666664

2025-01-24 07:56:12 - root - INFO - SQL:
SELECT STRFTIME('%Y', cd."date_joined") AS "year", COUNT(*) AS "new_unicorns"
   FROM "companies_dates" cd
   JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
   WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
     AND ci."industry" = (
       SELECT ci."industry"
       FROM "companies_dates" cd
       JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
       WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
       GROUP BY ci."industry"
       ORDER BY COUNT(*) DESC
       LIMIT 1
     )
   GROUP BY "year"
   ORDER BY "year" ASC
   LIMIT 100;
Results:
year,new_unicorns
2019,21
2020,18
2021,140

2025-01-24 07:56:12 - root - INFO - SQL:
SELECT cd."company_id", ci."industry", cd."date_joined"
    FROM "companies_dates" cd
    JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
    WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
      AND ci."industry" = (
        SELECT ci."industry"
        FROM "companies_dates" cd
        JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
        WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
        GROUP BY ci."industry"
        ORDER BY COUNT(*) DESC
        LIMIT 1
      )
    LIMIT 100;
Results:
company_id,industry,date_joined
316,Fintech,2021-05-26T00:00:00.000
162,Fintech,2020-01-24T00:00:00.000
983,Fintech,2019-08-22T00:00:00.000
450,Fintech,2021-04-29T00:00:00.000
318,Fintech,2020-01-07T00:00:00.000
848,Fintech,2021-06-01T00:00:00.000
396,Fintech,2021-10-21T00:00:00.000
983,Fintech,2019-08-22T00:00:00.000
844,Fintech,2021-07-07T00:00:00.000
894,Fintech,2021-12-06T00:00:00.000
813,Fintech,2021-08-10T00:00:00.000
963,Fintech,2021-10-05T00:00:00.000
764,Fintech,2021-12-07T00:00:00.000
755,Fintech,2021-09-08T00:00:00.000
175,Fintech,2019-06-25T00:00:00.000
398,Fintech,2021-10-15T00:00:00.000
249,Fintech,2021-06-29T00:00:00.000
1054,Fintech,2021-05-18T00:00:00.000
1063,Fintech,2021-11-10T00:00:00.000
823,Fintech,2019-05-21T00:00:00.000
944,Fintech,2021-07-22T00:00:00.000
393,Fintech,2021-09-27T00:00:00.000
449,Fintech,2021-07-03T00:00:00.000
718,Fintech,2021-09-30T00:00:00.000
920,Fintech,2021-08-10T00:00:00.000
662,Fintech,2020-12-21T00:00:00.000
1027,Fintech,2021-06-24T00:00:00.000
783,Fintech,2021-03-26T00:00:00.000
1023,Fintech,2021-01-26T00:00:00.000
942,Fintech,2021-04-20T00:00:00.000
579,Fintech,2021-10-06T00:00:00.000
769,Fintech,2021-05-18T00:00:00.000
452,Fintech,2021-06-08T00:00:00.000
361,Fintech,2021-09-15T00:00:00.000
82,Fintech,2021-07-27T00:00:00.000
44,Fintech,2021-10-08T00:00:00.000
53,Fintech,2021-11-01T00:00:00.000
91,Fintech,2019-05-06T00:00:00.000
1014,Fintech,2021-04-09T00:00:00.000
327,Fintech,2021-03-11T00:00:00.000
641,Fintech,2019-07-16T00:00:00.000
484,Fintech,2021-09-07T00:00:00.000
837,Fintech,2021-03-09T00:00:00.000
880,Fintech,2021-07-01T00:00:00.000
834,Fintech,2021-05-20T00:00:00.000
1064,Fintech,2021-09-14T00:00:00.000
414,Fintech,2021-03-24T00:00:00.000
446,Fintech,2021-09-02T00:00:00.000
356,Fintech,2019-03-25T00:00:00.000
619,Fintech,2021-05-24T00:00:00.000
649,Fintech,2021-02-18T00:00:00.000
770,Fintech,2021-07-21T00:00:00.000
676,Fintech,2021-08-04T00:00:00.000
861,Fintech,2021-05-17T00:00:00.000
858,Fintech,2021-10-04T00:00:00.000
1026,Fintech,2021-11-28T00:00:00.000
630,Fintech,2021-10-13T00:00:00.000
621,Fintech,2021-04-11T00:00:00.000
990,Fintech,2021-09-09T00:00:00.000
418,Fintech,2021-05-25T00:00:00.000
959,Fintech,2021-12-08T00:00:00.000
1049,Fintech,2021-09-21T00:00:00.000
485,Fintech,2021-11-09T00:00:00.000
534,Fintech,2021-05-06T00:00:00.000
550,Fintech,2021-06-18T00:00:00.000
980,Fintech,2021-07-13T00:00:00.000
138,Fintech,2021-03-31T00:00:00.000
806,Fintech,2021-07-27T00:00:00.000
47,Fintech,2019-12-20T00:00:00.000
84,Fintech,2020-07-01T00:00:00.000
303,Fintech,2021-08-24T00:00:00.000
14,Fintech,2019-03-05T00:00:00.000
6,Fintech,2019-05-02T00:00:00.000
12,Fintech,2021-07-20T00:00:00.000
67,Fintech,2019-01-10T00:00:00.000
155,Fintech,2020-12-02T00:00:00.000
522,Fintech,2021-10-06T00:00:00.000
552,Fintech,2021-05-31T00:00:00.000
895,Fintech,2021-04-13T00:00:00.000
785,Fintech,2021-02-17T00:00:00.000
708,Fintech,2021-06-08T00:00:00.000
390,Fintech,2021-05-18T00:00:00.000
684,Fintech,2021-07-14T00:00:00.000
206,Fintech,2021-08-10T00:00:00.000
1036,Fintech,2021-10-11T00:00:00.000
304,Fintech,2021-03-09T00:00:00.000
325,Fintech,2021-06-21T00:00:00.000
730,Fintech,2021-09-29T00:00:00.000
936,Fintech,2021-08-04T00:00:00.000
351,Fintech,2021-10-14T00:00:00.000
602,Fintech,2021-11-10T00:00:00.000
802,Fintech,2021-06-16T00:00:00.000
429,Fintech,2021-05-24T00:00:00.000
517,Fintech,2021-09-08T00:00:00.000
467,Fintech,2021-04-19T00:00:00.000
596,Fintech,2020-10-06T00:00:00.000
208,Fintech,2020-11-23T00:00:00.000
1003,Fintech,2021-01-19T00:00:00.000
558,Fintech,2021-08-13T00:00:00.000
739,Fintech,2021-09-29T00:00:00.000

2025-01-24 07:56:12 - root - INFO - itercount: 0
2025-01-24 07:56:12 - root - INFO - Table: pizza_namesDDL:
CREATE TABLE "pizza_names" (
"pizza_id" INTEGER,
  "pizza_name" TEXT
)
Table: companies_fundingDDL:
CREATE TABLE "companies_funding" (
"company_id" INTEGER,
  "valuation" INTEGER,
  "funding" INTEGER,
  "select_investors" TEXT
)
Table: pizza_customer_ordersDDL:
CREATE TABLE "pizza_customer_orders" (
"order_id" INTEGER,
  "customer_id" INTEGER,
  "pizza_id" INTEGER,
  "exclusions" TEXT,
  "extras" TEXT,
  "order_time" TEXT
)
Table: pizza_toppingsDDL:
CREATE TABLE "pizza_toppings" (
"topping_id" INTEGER,
  "topping_name" TEXT
)
Table: treesDDL:
CREATE TABLE "trees" (
"idx" INTEGER,
  "tree_id" INTEGER,
  "tree_dbh" INTEGER,
  "stump_diam" INTEGER,
  "status" TEXT,
  "health" TEXT,
  "spc_latin" TEXT,
  "spc_common" TEXT,
  "address" TEXT,
  "zipcode" INTEGER,
  "borocode" INTEGER,
  "boroname" TEXT,
  "nta_name" TEXT,
  "state" TEXT,
  "latitude" REAL,
  "longitude" REAL
)
Table: pizza_recipesDDL:
CREATE TABLE "pizza_recipes" (
"pizza_id" INTEGER,
  "toppings" TEXT
)
Table: statisticsDDL:
CREATE TABLE "statistics" (
"date" TEXT,
  "state" TEXT,
  "total_cases" INTEGER,
  "total_deaths" INTEGER
)
Table: income_treesDDL:
CREATE TABLE "income_trees" (
"zipcode" INTEGER,
  "Estimate_Total" INTEGER,
  "Margin_of_Error_Total" INTEGER,
  "Estimate_Median_income" INTEGER,
  "Margin_of_Error_Median_income" INTEGER,
  "Estimate_Mean_income" INTEGER,
  "Margin_of_Error_Mean_income" INTEGER
)
Table: pizza_clean_runner_ordersDDL:
CREATE TABLE "pizza_clean_runner_orders" (
"order_id" INTEGER,
  "runner_id" INTEGER,
  "pickup_time" TEXT,
  "distance" REAL,
  "duration" REAL,
  "cancellation" TEXT
)
Table: pizza_runner_ordersDDL:
CREATE TABLE "pizza_runner_orders" (
"order_id" INTEGER,
  "runner_id" INTEGER,
  "pickup_time" TEXT,
  "distance" TEXT,
  "duration" TEXT,
  "cancellation" TEXT
)
Table: word_listDDL:
CREATE TABLE "word_list" (
"words" TEXT
)
Table: companies_datesDDL:
CREATE TABLE "companies_dates" (
"company_id" INTEGER,
  "date_joined" TEXT,
  "year_founded" INTEGER
)
Table: pizza_get_extrasDDL:
CREATE TABLE "pizza_get_extras" (
"row_id" INTEGER,
  "order_id" INTEGER,
  "extras" INTEGER,
  "extras_count" INTEGER
)
Table: pizza_get_exclusionsDDL:
CREATE TABLE "pizza_get_exclusions" (
"row_id" INTEGER,
  "order_id" INTEGER,
  "exclusions" INTEGER,
  "total_exclusions" INTEGER
)
Table: pizza_clean_customer_ordersDDL:
CREATE TABLE "pizza_clean_customer_orders" (
"order_id" INTEGER,
  "customer_id" INTEGER,
  "pizza_id" INTEGER,
  "exclusions" TEXT,
  "extras" TEXT,
  "order_time" TEXT
)
Table: companies_industriesDDL:
CREATE TABLE "companies_industries" (
"company_id" INTEGER,
  "industry" TEXT
)
Table: pizza_runnersDDL:
CREATE TABLE "pizza_runners" (
"runner_id" INTEGER,
  "registration_date" TEXT
)
External knowledge that might be helpful: 
None
The table structure information is (table names): 
['pizza_names', 'companies_funding', 'pizza_customer_orders', 'pizza_toppings', 'trees', 'pizza_recipes', 'statistics', 'income_trees', 'pizza_clean_runner_orders', 'pizza_runner_orders', 'word_list', 'companies_dates', 'pizza_get_extras', 'pizza_get_exclusions', 'pizza_clean_customer_orders', 'companies_industries', 'pizza_runners']
Begin Exploring Related Columns
### Relevant Tables and Columns

**1. `companies_dates`**
   - `company_id`: Used to uniquely identify each company.
   - `date_joined`: Potentially represents the date when a company became a unicorn.
   - `year_founded`: The year the company was founded.

**2. `companies_industries`**
   - `company_id`: Used to link with the `companies_dates` table.
   - `industry`: Indicates the industry to which each company belongs.

**3. `companies_funding`**
   - `company_id`: Used to link with other company-related tables.
   - `valuation`: The company's valuation, which can indicate unicorn status (valuation ≥ $1 billion).
   - `funding`: The amount of funding received by the company.
   - `select_investors`: Information about investors, which might be useful for further analysis.

### Potential Conditions

- **Time Frame**: We are interested in companies that became unicorns between **2019** and **2021**.
- **Unicorn Status**: Companies with a valuation of **$1 billion** or more.
- **Top Industry**: The industry with the highest number of new unicorns during the specified period.

### SQL Queries to Explore the Data

1. **List all companies with their joining dates and founding years**
   ```sql
   SELECT "company_id", "date_joined", "year_founded"
   FROM "companies_dates"
   LIMIT 100;
   ```

2. **Retrieve all distinct industries**
   ```sql
   SELECT DISTINCT "industry"
   FROM "companies_industries"
   LIMIT 100;
   ```

3. **List companies and their industries**
   ```sql
   SELECT "company_id", "industry"
   FROM "companies_industries"
   LIMIT 100;
   ```

4. **Find companies with valuations of $1 billion or more**
   ```sql
   SELECT "company_id", "valuation"
   FROM "companies_funding"
   WHERE "valuation" >= 1000000000
   LIMIT 100;
   ```

5. **List companies that became unicorns between 2019 and 2021**
   ```sql
   SELECT "company_id", "date_joined"
   FROM "companies_dates"
   WHERE "date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
   LIMIT 100;
   ```

6. **Count new unicorns per industry from 2019 to 2021**
   ```sql
   SELECT ci."industry", COUNT(*) AS "new_unicorns"
   FROM "companies_dates" cd
   JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
   WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
   GROUP BY ci."industry"
   LIMIT 100;
   ```

7. **Identify the top industry with the most new unicorns (2019-2021)**
   ```sql
   SELECT ci."industry", COUNT(*) AS "new_unicorns"
   FROM "companies_dates" cd
   JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
   WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
   GROUP BY ci."industry"
   ORDER BY "new_unicorns" DESC
   LIMIT 1;
   ```

8. **Calculate the average number of new unicorns per year in the top industry**
   ```sql
   SELECT CAST(COUNT(*) AS FLOAT) / 3 AS "average_new_unicorns_per_year"
   FROM "companies_dates" cd
   JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
   WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
     AND ci."industry" = (
       SELECT ci."industry"
       FROM "companies_dates" cd
       JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
       WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
       GROUP BY ci."industry"
       ORDER BY COUNT(*) DESC
       LIMIT 1
     )
   LIMIT 100;
   ```

9. **Number of new unicorns per year in the top industry**
   ```sql
   SELECT STRFTIME('%Y', cd."date_joined") AS "year", COUNT(*) AS "new_unicorns"
   FROM "companies_dates" cd
   JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
   WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
     AND ci."industry" = (
       SELECT ci."industry"
       FROM "companies_dates" cd
       JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
       WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
       GROUP BY ci."industry"
       ORDER BY COUNT(*) DESC
       LIMIT 1
     )
   GROUP BY "year"
   ORDER BY "year" ASC
   LIMIT 100;
   ```

10. **List of companies in the top industry that became unicorns between 2019 and 2021**
    ```sql
    SELECT cd."company_id", ci."industry", cd."date_joined"
    FROM "companies_dates" cd
    JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
    WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
      AND ci."industry" = (
        SELECT ci."industry"
        FROM "companies_dates" cd
        JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
        WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
        GROUP BY ci."industry"
        ORDER BY COUNT(*) DESC
        LIMIT 1
      )
    LIMIT 100;
    ```

These queries progressively explore the dataset to calculate the average number of new unicorn companies per year in the top industry from **2019** to **2021**.Query:
SELECT "company_id", "date_joined", "year_founded"
   FROM "companies_dates"
   LIMIT 100;
Answer:
company_id,date_joined,year_founded
109,2020-09-08T00:00:00.000,2004
821,2019-05-16T00:00:00.000,2009
153,2019-07-11T00:00:00.000,2016
972,2018-10-17T00:00:00.000,2016
1022,2021-06-02T00:00:00.000,2013
433,2021-04-17T00:00:00.000,2013
747,2018-03-27T00:00:00.000,2011
902,2021-01-27T00:00:00.000,2015
1065,2021-06-01T00:00:00.000,2015
388,2018-05-30T00:00:00.000,2009
748,2019-02-14T00:00:00.000,2009
189,2017-06-24T00:00:00.000,1919
848,2021-06-01T00:00:00.000,2019
556,2022-02-15T00:00:00.000,2011
999,2021-11-17T00:00:00.000,2020
396,2021-10-21T00:00:00.000,2021
931,2021-09-24T00:00:00.000,2020
364,2019-02-01T00:00:00.000,2015
732,2022-01-27T00:00:00.000,2017
906,2021-06-10T00:00:00.000,2017
72,2015-01-23T00:00:00.000,2006
983,2019-08-22T00:00:00.000,1999
898,2022-01-25T00:00:00.000,2015
844,2021-07-07T00:00:00.000,2018
894,2021-12-06T00:00:00.000,2020
813,2021-08-10T00:00:00.000,2017
743,2020-12-24T00:00:00.000,2015
226,2021-01-24T00:00:00.000,2020
963,2021-10-05T00:00:00.000,2017
764,2021-12-07T00:00:00.000,2018
839,2021-12-28T00:00:00.000,2016
1033,2021-01-27T00:00:00.000,2006
725,2022-01-25T00:00:00.000,2010
549,2021-09-22T00:00:00.000,2016
667,2015-01-16T00:00:00.000,2014
755,2021-09-08T00:00:00.000,2017
782,2022-01-31T00:00:00.000,2021
175,2019-06-25T00:00:00.000,2011
398,2021-10-15T00:00:00.000,2017
814,2021-11-16T00:00:00.000,2014
436,2017-04-14T00:00:00.000,2006
1046,2021-06-16T00:00:00.000,2014
565,2021-04-21T00:00:00.000,2013
781,2021-08-31T00:00:00.000,2018
997,2021-12-06T00:00:00.000,2011
194,2021-03-18T00:00:00.000,2001
249,2021-06-29T00:00:00.000,2019
434,2021-05-19T00:00:00.000,2014
1035,2021-11-18T00:00:00.000,2020
969,2022-01-26T00:00:00.000,2014
1018,2021-02-18T00:00:00.000,2011
355,2021-09-14T00:00:00.000,2017
934,2020-03-17T00:00:00.000,2011
1054,2021-05-18T00:00:00.000,2016
901,2021-11-08T00:00:00.000,2020
173,2021-12-20T00:00:00.000,2018
738,2022-01-11T00:00:00.000,2018
422,2022-02-16T00:00:00.000,2019
830,2021-03-30T00:00:00.000,2017
1004,2021-05-24T00:00:00.000,2016
951,2015-03-06T00:00:00.000,2011
734,2022-01-27T00:00:00.000,2012
1063,2021-11-10T00:00:00.000,2018
623,2015-04-21T00:00:00.000,2013
846,2019-10-21T00:00:00.000,2015
823,2019-05-21T00:00:00.000,2000
944,2021-07-22T00:00:00.000,2005
1030,2021-08-09T00:00:00.000,2019
824,2016-04-14T00:00:00.000,2012
930,2022-02-22T00:00:00.000,2017
370,2018-07-09T00:00:00.000,2010
618,2018-10-18T00:00:00.000,2009
456,2020-01-29T00:00:00.000,2016
893,2021-09-02T00:00:00.000,2020
812,2022-03-31T00:00:00.000,2019
1001,2020-09-21T00:00:00.000,2020
703,2021-12-02T00:00:00.000,2018
884,2021-12-14T00:00:00.000,2020
404,2021-03-19T00:00:00.000,2010
952,2022-03-30T00:00:00.000,2021
625,2020-01-28T00:00:00.000,2012
971,2021-11-02T00:00:00.000,2015
796,2017-07-20T00:00:00.000,2012
909,2022-01-27T00:00:00.000,2015
587,2018-05-17T00:00:00.000,2014
273,2022-04-05T00:00:00.000,2013
771,2021-09-28T00:00:00.000,2017
758,2021-12-21T00:00:00.000,2016
652,2021-06-15T00:00:00.000,2015
8,2017-12-20T00:00:00.000,2015
760,2020-11-17T00:00:00.000,2016
394,2022-01-31T00:00:00.000,2016
393,2021-09-27T00:00:00.000,2013
870,2021-02-16T00:00:00.000,2016
804,2021-09-16T00:00:00.000,2019
1041,2021-11-02T00:00:00.000,2015
443,2022-03-17T00:00:00.000,2017
978,2021-01-07T00:00:00.000,2015
612,2021-12-31T00:00:00.000,2016
714,2017-10-17T00:00:00.000,2021
Query:
SELECT DISTINCT "industry"
   FROM "companies_industries"
   LIMIT 100;
Answer:
industry
Fintech
Internet software & services
E-commerce & direct-to-consumer
Health
Consumer & retail
Hardware
Other
Mobile & telecommunications
Artificial intelligence
Auto & transportation
Cybersecurity
Data management & analytics
Edtech
"""Supply chain, logistics, & delivery"""
Travel
Query:
SELECT "company_id", "industry"
   FROM "companies_industries"
   LIMIT 100;
Answer:
company_id,industry
316,Fintech
162,Fintech
803,Fintech
278,Internet software & services
983,Fintech
951,E-commerce & direct-to-consumer
650,Internet software & services
450,Fintech
556,Internet software & services
318,Fintech
889,E-commerce & direct-to-consumer
189,Health
848,Fintech
556,Internet software & services
999,Internet software & services
396,Fintech
931,Consumer & retail
364,E-commerce & direct-to-consumer
732,Fintech
906,Hardware
72,Hardware
983,Fintech
898,Internet software & services
844,Fintech
894,Fintech
813,Fintech
743,Other
226,Mobile & telecommunications
963,Fintech
764,Fintech
839,E-commerce & direct-to-consumer
1033,Internet software & services
725,Health
549,Artificial intelligence
667,Mobile & telecommunications
755,Fintech
782,Fintech
175,Fintech
398,Fintech
814,E-commerce & direct-to-consumer
436,Artificial intelligence
1046,Artificial intelligence
565,Artificial intelligence
781,Internet software & services
997,E-commerce & direct-to-consumer
194,Internet software & services
249,Fintech
434,Auto & transportation
1035,Cybersecurity
969,Data management & analytics
1018,Other
355,Internet software & services
934,E-commerce & direct-to-consumer
1054,Fintech
901,Cybersecurity
173,Internet software & services
738,Fintech
422,Internet software & services
830,Health
1004,Other
951,E-commerce & direct-to-consumer
734,Internet software & services
1063,Fintech
623,Fintech
846,Data management & analytics
823,Fintech
944,Fintech
1030,Artificial intelligence
824,E-commerce & direct-to-consumer
930,Internet software & services
370,Data management & analytics
618,E-commerce & direct-to-consumer
456,Cybersecurity
893,E-commerce & direct-to-consumer
812,Other
1001,Other
703,Cybersecurity
884,Health
404,Cybersecurity
952,Internet software & services
625,Internet software & services
971,Internet software & services
796,Edtech
909,Fintech
587,Artificial intelligence
273,Health
771,Internet software & services
758,Internet software & services
652,Internet software & services
8,Consumer & retail
760,Mobile & telecommunications
394,Health
393,Fintech
870,Other
804,Artificial intelligence
1041,Internet software & services
443,Artificial intelligence
978,Internet software & services
612,Auto & transportation
714,Mobile & telecommunications
Query:
SELECT "company_id", "valuation"
   FROM "companies_funding"
   WHERE "valuation" >= 1000000000
   LIMIT 100;
Answer:
company_id,valuation
548,2000000000
645,1000000000
615,1000000000
51,10000000000
680,1000000000
457,2000000000
429,2000000000
933,1000000000
568,2000000000
478,2000000000
881,1000000000
189,4000000000
848,1000000000
556,2000000000
999,1000000000
396,2000000000
931,1000000000
364,2000000000
732,1000000000
906,1000000000
72,8000000000
983,1000000000
898,1000000000
844,1000000000
894,1000000000
813,1000000000
743,1000000000
226,4000000000
963,1000000000
764,1000000000
839,1000000000
1033,1000000000
725,1000000000
549,2000000000
667,1000000000
755,1000000000
782,1000000000
175,4000000000
398,2000000000
814,1000000000
436,2000000000
1046,1000000000
565,2000000000
781,1000000000
997,1000000000
194,4000000000
249,3000000000
434,2000000000
1035,1000000000
969,1000000000
1018,1000000000
355,2000000000
934,1000000000
1054,1000000000
901,1000000000
173,4000000000
738,1000000000
422,2000000000
830,1000000000
1004,1000000000
951,1000000000
734,1000000000
1063,1000000000
623,1000000000
846,1000000000
823,1000000000
944,1000000000
1030,1000000000
824,1000000000
930,1000000000
370,2000000000
618,1000000000
456,2000000000
893,1000000000
812,1000000000
1001,1000000000
703,1000000000
884,1000000000
404,2000000000
952,1000000000
625,1000000000
971,1000000000
796,1000000000
909,1000000000
587,2000000000
273,3000000000
771,1000000000
1005,1000000000
758,1000000000
652,1000000000
8,38000000000
760,1000000000
394,2000000000
393,2000000000
870,1000000000
804,1000000000
1041,1000000000
443,2000000000
978,1000000000
612,1000000000
Query:
SELECT "company_id", "date_joined"
   FROM "companies_dates"
   WHERE "date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
   LIMIT 100;
Answer:
company_id,date_joined
109,2020-09-08T00:00:00.000
821,2019-05-16T00:00:00.000
153,2019-07-11T00:00:00.000
1022,2021-06-02T00:00:00.000
433,2021-04-17T00:00:00.000
902,2021-01-27T00:00:00.000
1065,2021-06-01T00:00:00.000
748,2019-02-14T00:00:00.000
848,2021-06-01T00:00:00.000
999,2021-11-17T00:00:00.000
396,2021-10-21T00:00:00.000
931,2021-09-24T00:00:00.000
364,2019-02-01T00:00:00.000
906,2021-06-10T00:00:00.000
983,2019-08-22T00:00:00.000
844,2021-07-07T00:00:00.000
894,2021-12-06T00:00:00.000
813,2021-08-10T00:00:00.000
743,2020-12-24T00:00:00.000
226,2021-01-24T00:00:00.000
963,2021-10-05T00:00:00.000
764,2021-12-07T00:00:00.000
839,2021-12-28T00:00:00.000
1033,2021-01-27T00:00:00.000
549,2021-09-22T00:00:00.000
755,2021-09-08T00:00:00.000
175,2019-06-25T00:00:00.000
398,2021-10-15T00:00:00.000
814,2021-11-16T00:00:00.000
1046,2021-06-16T00:00:00.000
565,2021-04-21T00:00:00.000
781,2021-08-31T00:00:00.000
997,2021-12-06T00:00:00.000
194,2021-03-18T00:00:00.000
249,2021-06-29T00:00:00.000
434,2021-05-19T00:00:00.000
1035,2021-11-18T00:00:00.000
1018,2021-02-18T00:00:00.000
355,2021-09-14T00:00:00.000
934,2020-03-17T00:00:00.000
1054,2021-05-18T00:00:00.000
901,2021-11-08T00:00:00.000
173,2021-12-20T00:00:00.000
830,2021-03-30T00:00:00.000
1004,2021-05-24T00:00:00.000
1063,2021-11-10T00:00:00.000
846,2019-10-21T00:00:00.000
823,2019-05-21T00:00:00.000
944,2021-07-22T00:00:00.000
1030,2021-08-09T00:00:00.000
456,2020-01-29T00:00:00.000
893,2021-09-02T00:00:00.000
1001,2020-09-21T00:00:00.000
703,2021-12-02T00:00:00.000
884,2021-12-14T00:00:00.000
404,2021-03-19T00:00:00.000
625,2020-01-28T00:00:00.000
971,2021-11-02T00:00:00.000
771,2021-09-28T00:00:00.000
758,2021-12-21T00:00:00.000
652,2021-06-15T00:00:00.000
760,2020-11-17T00:00:00.000
393,2021-09-27T00:00:00.000
870,2021-02-16T00:00:00.000
804,2021-09-16T00:00:00.000
1041,2021-11-02T00:00:00.000
978,2021-01-07T00:00:00.000
421,2020-11-16T00:00:00.000
449,2021-07-03T00:00:00.000
1022,2021-06-02T00:00:00.000
644,2021-01-25T00:00:00.000
718,2021-09-30T00:00:00.000
920,2021-08-10T00:00:00.000
1048,2021-09-30T00:00:00.000
1024,2021-04-22T00:00:00.000
929,2021-12-22T00:00:00.000
863,2021-12-07T00:00:00.000
662,2020-12-21T00:00:00.000
1027,2021-06-24T00:00:00.000
783,2021-03-26T00:00:00.000
592,2021-11-17T00:00:00.000
1023,2021-01-26T00:00:00.000
1051,2021-11-03T00:00:00.000
633,2021-04-07T00:00:00.000
635,2021-06-02T00:00:00.000
697,2021-12-20T00:00:00.000
886,2021-03-30T00:00:00.000
798,2021-02-11T00:00:00.000
1008,2021-11-08T00:00:00.000
701,2020-12-31T00:00:00.000
825,2021-10-13T00:00:00.000
344,2021-06-29T00:00:00.000
643,2021-12-15T00:00:00.000
509,2021-08-04T00:00:00.000
979,2021-02-25T00:00:00.000
1031,2021-10-07T00:00:00.000
817,2021-05-04T00:00:00.000
943,2019-03-22T00:00:00.000
975,2021-04-30T00:00:00.000
647,2020-12-10T00:00:00.000
Query:
SELECT ci."industry", COUNT(*) AS "new_unicorns"
   FROM "companies_dates" cd
   JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
   WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
   GROUP BY ci."industry"
   LIMIT 100;
Answer:
industry,new_unicorns
"""Supply chain, logistics, & delivery""",36
Artificial intelligence,53
Auto & transportation,14
Consumer & retail,11
Cybersecurity,38
Data management & analytics,31
E-commerce & direct-to-consumer,76
Edtech,17
Fintech,179
Hardware,15
Health,52
Internet software & services,156
Mobile & telecommunications,18
Other,43
Travel,7
Query:
SELECT ci."industry", COUNT(*) AS "new_unicorns"
   FROM "companies_dates" cd
   JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
   WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
   GROUP BY ci."industry"
   ORDER BY "new_unicorns" DESC
   LIMIT 1;
Answer:
industry,new_unicorns
Fintech,179
Query:
SELECT CAST(COUNT(*) AS FLOAT) / 3 AS "average_new_unicorns_per_year"
   FROM "companies_dates" cd
   JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
   WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
     AND ci."industry" = (
       SELECT ci."industry"
       FROM "companies_dates" cd
       JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
       WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
       GROUP BY ci."industry"
       ORDER BY COUNT(*) DESC
       LIMIT 1
     )
   LIMIT 100;
Answer:
average_new_unicorns_per_year
59.666666666666664
Query:
SELECT STRFTIME('%Y', cd."date_joined") AS "year", COUNT(*) AS "new_unicorns"
   FROM "companies_dates" cd
   JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
   WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
     AND ci."industry" = (
       SELECT ci."industry"
       FROM "companies_dates" cd
       JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
       WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
       GROUP BY ci."industry"
       ORDER BY COUNT(*) DESC
       LIMIT 1
     )
   GROUP BY "year"
   ORDER BY "year" ASC
   LIMIT 100;
Answer:
year,new_unicorns
2019,21
2020,18
2021,140
Query:
SELECT cd."company_id", ci."industry", cd."date_joined"
    FROM "companies_dates" cd
    JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
    WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
      AND ci."industry" = (
        SELECT ci."industry"
        FROM "companies_dates" cd
        JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
        WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
        GROUP BY ci."industry"
        ORDER BY COUNT(*) DESC
        LIMIT 1
      )
    LIMIT 100;
Answer:
company_id,industry,date_joined
316,Fintech,2021-05-26T00:00:00.000
162,Fintech,2020-01-24T00:00:00.000
983,Fintech,2019-08-22T00:00:00.000
450,Fintech,2021-04-29T00:00:00.000
318,Fintech,2020-01-07T00:00:00.000
848,Fintech,2021-06-01T00:00:00.000
396,Fintech,2021-10-21T00:00:00.000
983,Fintech,2019-08-22T00:00:00.000
844,Fintech,2021-07-07T00:00:00.000
894,Fintech,2021-12-06T00:00:00.000
813,Fintech,2021-08-10T00:00:00.000
963,Fintech,2021-10-05T00:00:00.000
764,Fintech,2021-12-07T00:00:00.000
755,Fintech,2021-09-08T00:00:00.000
175,Fintech,2019-06-25T00:00:00.000
398,Fintech,2021-10-15T00:00:00.000
249,Fintech,2021-06-29T00:00:00.000
1054,Fintech,2021-05-18T00:00:00.000
1063,Fintech,2021-11-10T00:00:00.000
823,Fintech,2019-05-21T00:00:00.000
944,Fintech,2021-07-22T00:00:00.000
393,Fintech,2021-09-27T00:00:00.000
449,Fintech,2021-07-03T00:00:00.000
718,Fintech,2021-09-30T00:00:00.000
920,Fintech,2021-08-10T00:00:00.000
662,Fintech,2020-12-21T00:00:00.000
1027,Fintech,2021-06-24T00:00:00.000
783,Fintech,2021-03-26T00:00:00.000
1023,Fintech,2021-01-26T00:00:00.000
942,Fintech,2021-04-20T00:00:00.000
579,Fintech,2021-10-06T00:00:00.000
769,Fintech,2021-05-18T00:00:00.000
452,Fintech,2021-06-08T00:00:00.000
361,Fintech,2021-09-15T00:00:00.000
82,Fintech,2021-07-27T00:00:00.000
44,Fintech,2021-10-08T00:00:00.000
53,Fintech,2021-11-01T00:00:00.000
91,Fintech,2019-05-06T00:00:00.000
1014,Fintech,2021-04-09T00:00:00.000
327,Fintech,2021-03-11T00:00:00.000
641,Fintech,2019-07-16T00:00:00.000
484,Fintech,2021-09-07T00:00:00.000
837,Fintech,2021-03-09T00:00:00.000
880,Fintech,2021-07-01T00:00:00.000
834,Fintech,2021-05-20T00:00:00.000
1064,Fintech,2021-09-14T00:00:00.000
414,Fintech,2021-03-24T00:00:00.000
446,Fintech,2021-09-02T00:00:00.000
356,Fintech,2019-03-25T00:00:00.000
619,Fintech,2021-05-24T00:00:00.000
649,Fintech,2021-02-18T00:00:00.000
770,Fintech,2021-07-21T00:00:00.000
676,Fintech,2021-08-04T00:00:00.000
861,Fintech,2021-05-17T00:00:00.000
858,Fintech,2021-10-04T00:00:00.000
1026,Fintech,2021-11-28T00:00:00.000
630,Fintech,2021-10-13T00:00:00.000
621,Fintech,2021-04-11T00:00:00.000
990,Fintech,2021-09-09T00:00:00.000
418,Fintech,2021-05-25T00:00:00.000
959,Fintech,2021-12-08T00:00:00.000
1049,Fintech,2021-09-21T00:00:00.000
485,Fintech,2021-11-09T00:00:00.000
534,Fintech,2021-05-06T00:00:00.000
550,Fintech,2021-06-18T00:00:00.000
980,Fintech,2021-07-13T00:00:00.000
138,Fintech,2021-03-31T00:00:00.000
806,Fintech,2021-07-27T00:00:00.000
47,Fintech,2019-12-20T00:00:00.000
84,Fintech,2020-07-01T00:00:00.000
303,Fintech,2021-08-24T00:00:00.000
14,Fintech,2019-03-05T00:00:00.000
6,Fintech,2019-05-02T00:00:00.000
12,Fintech,2021-07-20T00:00:00.000
67,Fintech,2019-01-10T00:00:00.000
155,Fintech,2020-12-02T00:00:00.000
522,Fintech,2021-10-06T00:00:00.000
552,Fintech,2021-05-31T00:00:00.000
895,Fintech,2021-04-13T00:00:00.000
785,Fintech,2021-02-17T00:00:00.000
708,Fintech,2021-06-08T00:00:00.000
390,Fintech,2021-05-18T00:00:00.000
684,Fintech,2021-07-14T00:00:00.000
206,Fintech,2021-08-10T00:00:00.000
1036,Fintech,2021-10-11T00:00:00.000
304,Fintech,2021-03-09T00:00:00.000
325,Fintech,2021-06-21T00:00:00.000
730,Fintech,2021-09-29T00:00:00.000
936,Fintech,2021-08-04T00:00:00.000
351,Fintech,2021-10-14T00:00:00.000
602,Fintech,2021-11-10T00:00:00.000
802,Fintech,2021-06-16T00:00:00.000
429,Fintech,2021-05-24T00:00:00.000
517,Fintech,2021-09-08T00:00:00.000
467,Fintech,2021-04-19T00:00:00.000
596,Fintech,2020-10-06T00:00:00.000
208,Fintech,2020-11-23T00:00:00.000
1003,Fintech,2021-01-19T00:00:00.000
558,Fintech,2021-08-13T00:00:00.000
739,Fintech,2021-09-29T00:00:00.000
End Exploring Related Columns
Task: Can you help me calculate the average number of new unicorn companies per year in the top industry from 2019 to 2021?

Please answer only one complete SQL in sqlite dialect in ```sql``` format.
Usage example: ```sql
SELECT DISTINCT "column_name" FROM "table_name" WHERE ... ``` (Replace "table_name" with the actual table name. Enclose table and column names with double quotations if they contain special characters or match reserved keywords.)
Follow the answer format like: ```csv
average_number_of_new_unicorns_per_year
1
(Attention: answer in one row)
```

Explanation:
From 2019 to 2021, the top industry with the highest number of new unicorn companies is Fintech. Over these three years, there were a total of 3 new unicorn companies in the Fintech industry, resulting in an average of 1 new unicorn company per year..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: 

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-24 07:57:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 07:57:22 - root - INFO - ```sql
SELECT CAST(COUNT(DISTINCT cd."company_id") AS FLOAT) / 3 AS "average_number_of_new_unicorns_per_year"
FROM "companies_dates" cd
JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
JOIN "companies_funding" cf ON cd."company_id" = cf."company_id"
WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
  AND cf."valuation" >= 1000000000
  AND ci."industry" = (
    SELECT ci2."industry"
    FROM "companies_dates" cd2
    JOIN "companies_industries" ci2 ON cd2."company_id" = ci2."company_id"
    JOIN "companies_funding" cf2 ON cd2."company_id" = cf2."company_id"
    WHERE cd2."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
      AND cf2."valuation" >= 1000000000
    GROUP BY ci2."industry"
    ORDER BY COUNT(DISTINCT cd2."company_id") DESC
    LIMIT 1
  );
```

```csv
average_number_of_new_unicorns_per_year
59.6667
```
2025-01-24 07:57:22 - root - INFO - itercount: 1
2025-01-24 07:57:22 - root - INFO - 0
2025-01-24 07:57:22 - root - INFO - results: 
average_number_of_new_unicorns_per_year
57.666666666666664


2025-01-24 07:57:22 - root - INFO - Please check the answer again by reviewing Can you help me calculate the average number of new unicorn companies per year in the top industry from 2019 to 2021?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
average_number_of_new_unicorns_per_year
1
(Attention: answer in one row)
```

Explanation:
From 2019 to 2021, the top industry with the highest number of new unicorn companies is Fintech. Over these three years, there were a total of 3 new unicorn companies in the Fintech industry, resulting in an average of 1 new unicorn company per year. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
average_number_of_new_unicorns_per_year
57.666666666666664
Current sql:
SELECT CAST(COUNT(DISTINCT cd."company_id") AS FLOAT) / 3 AS "average_number_of_new_unicorns_per_year"
FROM "companies_dates" cd
JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
JOIN "companies_funding" cf ON cd."company_id" = cf."company_id"
WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
  AND cf."valuation" >= 1000000000
  AND ci."industry" = (
    SELECT ci2."industry"
    FROM "companies_dates" cd2
    JOIN "companies_industries" ci2 ON cd2."company_id" = ci2."company_id"
    JOIN "companies_funding" cf2 ON cd2."company_id" = cf2."company_id"
    WHERE cd2."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
      AND cf2."valuation" >= 1000000000
    GROUP BY ci2."industry"
    ORDER BY COUNT(DISTINCT cd2."company_id") DESC
    LIMIT 1
  );
2025-01-24 07:58:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 07:58:14 - root - INFO - ```sql
SELECT ROUND(CAST(COUNT(DISTINCT cd."company_id") AS FLOAT) / 3, 4) AS "average_number_of_new_unicorns_per_year"
FROM "companies_dates" cd
JOIN "companies_industries" ci ON cd."company_id" = ci."company_id"
JOIN "companies_funding" cf ON cd."company_id" = cf."company_id"
WHERE cd."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
  AND cf."valuation" >= 1000000000
  AND ci."industry" = (
    SELECT ci2."industry"
    FROM "companies_dates" cd2
    JOIN "companies_industries" ci2 ON cd2."company_id" = ci2."company_id"
    JOIN "companies_funding" cf2 ON cd2."company_id" = cf2."company_id"
    WHERE cd2."date_joined" BETWEEN '2019-01-01' AND '2021-12-31'
      AND cf2."valuation" >= 1000000000
    GROUP BY ci2."industry"
    ORDER BY COUNT(DISTINCT cd2."company_id") DESC
    LIMIT 1
  );
```

```csv
average_number_of_new_unicorns_per_year
57.6667
```
2025-01-24 07:58:14 - root - INFO - itercount: 2
2025-01-24 07:58:14 - root - INFO - 0
2025-01-24 07:58:14 - root - INFO - Total iteration counts: 2
