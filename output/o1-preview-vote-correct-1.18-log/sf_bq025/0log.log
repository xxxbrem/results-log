2025-01-18 21:53:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 21:54:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 21:54:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 21:54:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 21:54:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 21:54:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 101
2025-01-18 21:54:15 - snowflake.connector.connection - INFO - closed
2025-01-18 21:54:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 21:54:15 - root - INFO - SQL:
SELECT DISTINCT "year"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION
    LIMIT 1000;
Results:
year
1950
1951
1952
1953
1954
1955
1956
1957
1958
1959
1960
1961
1962
1963
1964
1968
1969
1971
1972
1979
1981
1982
1983
1986
1992
1993
1995
1996
1999
2010
2013
2019
2027
2029
2035
1974
1977
1980
1989
2002
2003
2007
2016
2018
2033
2034
2039
2048
2037
1966
1973
1976
1984
1990
1997
2001
2006
2011
2012
2020
2021
2023
2025
2047
2050
1965
1967
1970
1975
1978
1987
1991
1994
1998
2000
2014
2017
2022
2024
2028
2030
2031
2032
2038
2046
2005
2026
2040
2044
2004
1985
2008
2009
2015
2042
2043
2045
1988
2036
2041
2049

2025-01-18 21:54:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 21:54:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 21:54:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 21:54:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 101
2025-01-18 21:54:16 - snowflake.connector.connection - INFO - closed
2025-01-18 21:54:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 21:54:17 - root - INFO - SQL:
SELECT DISTINCT "year"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGESPECIFIC
    LIMIT 1000;
Results:
year
2001
2002
2003
2004
2005
2006
2007
2008
2009
2010
2011
2012
2013
2015
2016
2018
2014
2019
2021
2023
2024
2026
2028
2029
2033
2034
2035
2036
2037
2039
2030
2038
2048
1981
1983
1986
1987
1990
1995
1989
1979
1978
1977
1972
1975
1955
1957
1968
1969
2017
2020
2022
2025
2027
2031
2032
2040
2041
2044
2045
2046
2047
1980
1982
1984
1985
1991
1992
1993
1996
1997
1998
2000
1976
1970
1971
1974
1950
1953
1954
1956
1958
1959
1960
1961
1962
1963
1964
1965
2042
2043
2050
1988
1999
1994
1973
1951
1952
1966
1967
2049

2025-01-18 21:54:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 21:54:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 21:54:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 21:54:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 101
2025-01-18 21:54:18 - snowflake.connector.connection - INFO - closed
2025-01-18 21:54:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 21:54:19 - root - INFO - SQL:
SELECT DISTINCT "age"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGESPECIFIC
    ORDER BY "age"
    LIMIT 1000;
Results:
age
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100

2025-01-18 21:54:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 21:54:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 21:54:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 21:54:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-18 21:54:20 - snowflake.connector.connection - INFO - closed
2025-01-18 21:54:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 21:54:20 - root - INFO - SQL:
SELECT DISTINCT "sex"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGESPECIFIC
    LIMIT 1000;
Results:
sex
Male
Female

2025-01-18 21:54:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 21:54:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 21:54:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 21:54:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 228
2025-01-18 21:54:21 - snowflake.connector.connection - INFO - closed
2025-01-18 21:54:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 21:54:22 - root - INFO - SQL:
SELECT DISTINCT "country_code", "country_name"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION
    LIMIT 1000;
Results:
country_code,country_name
AA,Aruba
AC,Antigua and Barbuda
AE,United Arab Emirates
AF,Afghanistan
AG,Algeria
AJ,Azerbaijan
AL,Albania
AM,Armenia
AN,Andorra
AO,Angola
AQ,American Samoa
AR,Argentina
AS,Australia
AU,Austria
AV,Anguilla
BA,Bahrain
BC,Botswana
BB,Barbados
BD,Bermuda
BE,Belgium
BG,Bangladesh
BH,Belize
BK,Bosnia and Herzegovina
BL,Bolivia
BM,Burma
BP,Solomon Islands
BR,Brazil
BY,Burundi
CA,Canada
CB,Cambodia
CD,Chad
CF,Congo (Brazzaville)
CG,Congo (Kinshasa)
CI,Chile
CJ,Cayman Islands
CM,Cameroon
CQ,Northern Mariana Islands
CT,Central African Republic
CU,Cuba
CW,Cook Islands
CY,Cyprus
DA,Denmark
DJ,Djibouti
DR,Dominican Republic
EN,Estonia
GH,Ghana
GJ,Grenada
GY,Guyana
HA,Haiti
HO,Honduras
ID,Indonesia
IS,Israel
KR,Kiribati
KU,Kuwait
MA,Madagascar
MH,Montserrat
PK,Pakistan
MO,Morocco
OD,South Sudan
RI,Serbia
RP,Philippines
TB,Saint Barthelemy
TU,Turkey
BN,Benin
BO,Belarus
BT,Bhutan
BU,Bulgaria
BX,Brunei
BF,"Bahamas, The"
CE,Sri Lanka
CH,China
CN,Comoros
CO,Colombia
CS,Costa Rica
DO,Dominica
EC,Ecuador
EG,Egypt
EI,Ireland
EK,Equatorial Guinea
ER,Eritrea
ES,El Salvador
ET,Ethiopia
EZ,Czechia
FI,Finland
FM,"Micronesia, Federated States of"
FR,France
GG,Georgia
GI,Gibraltar
GK,Guernsey
GL,Greenland
GM,Germany
GQ,Guam
GR,Greece
GT,Guatemala
GV,Guinea
HK,Hong Kong
HR,Croatia
HU,Hungary
IR,Iran
IV,Cote d'Ivoire
IZ,Iraq
JE,Jersey
JO,Jordan
KE,Kenya
KG,Kyrgyzstan
KN,"Korea, North"
KS,"Korea, South"
KV,Kosovo
LA,Laos
LG,Latvia
LS,Liechtenstein
LT,Lesotho
LU,Luxembourg
LY,Libya
MD,Moldova
MG,Mongolia
MJ,Montenegro
MK,Macedonia
MN,Monaco
MR,Mauritania
MX,Mexico
MY,Malaysia
MZ,Mozambique
NI,Nigeria
NO,Norway
NP,Nepal
NR,Nauru
NS,Suriname
PM,Panama
PP,Papua New Guinea
PS,Palau
RO,Romania
RQ,Puerto Rico
SA,Saudi Arabia
SE,Seychelles
SI,Slovenia
SN,Singapore
SO,Somalia
ST,Saint Lucia
SW,Sweden
SY,Syria
SZ,Switzerland
TK,Turks and Caicos Islands
TW,Taiwan
UC,Curacao
UK,United Kingdom
UZ,Uzbekistan
VC,Saint Vincent and the Grenadines
WF,Wallis and Futuna
WZ,Eswatini
CV,Cabo Verde
FO,Faroe Islands
FP,French Polynesia
GA,"Gambia, The"
GB,Gabon
FJ,Fiji
GZ,Gaza Strip
IC,Iceland
IM,Isle of Man
IN,India
JA,Japan
JM,Jamaica
KZ,Kazakhstan
LE,Lebanon
LH,Lithuania
LI,Liberia
LO,Slovakia
MC,Macau
MI,Malawi
ML,Mali
MP,Mauritius
MU,Oman
MV,Maldives
NC,New Caledonia
NG,Niger
NH,Vanuatu
NL,Netherlands
NN,Sint Maarten
NU,Nicaragua
NZ,New Zealand
PA,Paraguay
PL,Poland
PE,Peru
PO,Portugal
PU,Guinea-Bissau
QA,Qatar
RM,Marshall Islands
RN,Saint Martin
RS,Russia
RW,Rwanda
SB,Saint Pierre and Miquelon
SC,Saint Kitts and Nevis
SF,South Africa
SH,"Saint Helena, Ascension, and Tristan da Cunha"
SL,Sierra Leone
SP,Spain
TD,Trinidad and Tobago
TN,Tonga
TO,Togo
TP,Sao Tome and Principe
TS,Tunisia
TT,Timor-Leste
SU,Sudan
TI,Tajikistan
TV,Tuvalu
TZ,Tanzania
UG,Uganda
UP,Ukraine
UV,Burkina Faso
UY,Uruguay
VE,Venezuela
VI,"Virgin Islands, British"
WA,Namibia
WE,West Bank
WI,Western Sahara
YM,Yemen
ZA,Zambia
ZI,Zimbabwe
IT,Italy
MT,Malta
SG,Senegal
SM,San Marino
TH,Thailand
TX,Turkmenistan
US,United States
VM,Vietnam
VQ,"Virgin Islands, U.S."
WS,Samoa

2025-01-18 21:54:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 21:54:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 21:54:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 21:54:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 228
2025-01-18 21:54:23 - snowflake.connector.connection - INFO - closed
2025-01-18 21:54:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 21:54:24 - root - INFO - SQL:
SELECT DISTINCT "country_code", "country_name"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGESPECIFIC
    LIMIT 1000;
Results:
country_code,country_name
NR,Nauru
NS,Suriname
NZ,New Zealand
OD,South Sudan
PE,Peru
PK,Pakistan
PL,Poland
PM,Panama
PO,Portugal
PP,Papua New Guinea
PS,Palau
QA,Qatar
RI,Serbia
RM,Marshall Islands
RN,Saint Martin
RO,Romania
RP,Philippines
RQ,Puerto Rico
RS,Russia
RW,Rwanda
SA,Saudi Arabia
SB,Saint Pierre and Miquelon
SC,Saint Kitts and Nevis
SF,South Africa
SH,"Saint Helena, Ascension, and Tristan da Cunha"
SI,Slovenia
SW,Sweden
SY,Syria
SZ,Switzerland
TB,Saint Barthelemy
TD,Trinidad and Tobago
TK,Turks and Caicos Islands
GJ,Grenada
GK,Guernsey
GM,Germany
GQ,Guam
GT,Guatemala
GY,Guyana
HK,Hong Kong
HU,Hungary
ID,Indonesia
IS,Israel
KN,"Korea, North"
LU,Luxembourg
LY,Libya
TU,Turkey
TV,Tuvalu
TZ,Tanzania
UK,United Kingdom
UZ,Uzbekistan
VC,Saint Vincent and the Grenadines
WA,Namibia
WF,Wallis and Futuna
NL,Netherlands
AC,Antigua and Barbuda
AQ,American Samoa
BB,Barbados
BE,Belgium
BH,Belize
BK,Bosnia and Herzegovina
DR,Dominican Republic
CF,Congo (Brazzaville)
DJ,Djibouti
PU,Guinea-Bissau
SE,Seychelles
SG,Senegal
SM,San Marino
SN,Singapore
SP,Spain
ST,Saint Lucia
SU,Sudan
TH,Thailand
TI,Tajikistan
TN,Tonga
GI,Gibraltar
GL,Greenland
GR,Greece
IC,Iceland
IM,Isle of Man
IN,India
JE,Jersey
JO,Jordan
KE,Kenya
KG,Kyrgyzstan
KR,Kiribati
KS,"Korea, South"
KU,Kuwait
KZ,Kazakhstan
LA,Laos
LG,Latvia
LH,Lithuania
LS,Liechtenstein
LT,Lesotho
TO,Togo
TS,Tunisia
TT,Timor-Leste
TW,Taiwan
UC,Curacao
US,United States
UV,Burkina Faso
VE,Venezuela
VI,"Virgin Islands, British"
VQ,"Virgin Islands, U.S."
WZ,Eswatini
ZA,Zambia
ZI,Zimbabwe
MG,Mongolia
MH,Montserrat
MJ,Montenegro
MK,Macedonia
ML,Mali
MN,Monaco
MO,Morocco
MR,Mauritania
MY,Malaysia
MZ,Mozambique
NG,Niger
NO,Norway
AA,Aruba
AE,United Arab Emirates
AF,Afghanistan
AL,Albania
AN,Andorra
AU,Austria
AV,Anguilla
BA,Bahrain
BC,Botswana
BD,Bermuda
BF,"Bahamas, The"
BG,Bangladesh
BL,Bolivia
BO,Belarus
BP,Solomon Islands
BX,Brunei
BY,Burundi
CD,Chad
CE,Sri Lanka
CI,Chile
CJ,Cayman Islands
CW,Cook Islands
CY,Cyprus
EI,Ireland
EN,Estonia
ER,Eritrea
ET,Ethiopia
FI,Finland
CT,Central African Republic
GH,Ghana
GV,Guinea
MA,Madagascar
NU,Nicaragua
GG,Georgia
GZ,Gaza Strip
HR,Croatia
IR,Iran
IZ,Iraq
JA,Japan
JM,Jamaica
KV,Kosovo
LO,Slovakia
TP,Sao Tome and Principe
TX,Turkmenistan
UP,Ukraine
UY,Uruguay
VM,Vietnam
WE,West Bank
MC,Macau
MD,Moldova
MI,Malawi
MP,Mauritius
MT,Malta
MU,Oman
MV,Maldives
MX,Mexico
NC,New Caledonia
NH,Vanuatu
NN,Sint Maarten
AG,Algeria
AJ,Azerbaijan
AM,Armenia
AR,Argentina
AS,Australia
BN,Benin
BU,Bulgaria
CA,Canada
CM,Cameroon
CN,Comoros
CQ,Northern Mariana Islands
CS,Costa Rica
CU,Cuba
CV,Cabo Verde
DA,Denmark
DO,Dominica
EC,Ecuador
EG,Egypt
EK,Equatorial Guinea
ES,El Salvador
EZ,Czechia
FM,"Micronesia, Federated States of"
FP,French Polynesia
FR,France
GB,Gabon
AO,Angola
BM,Burma
BT,Bhutan
CB,Cambodia
CG,Congo (Kinshasa)
CO,Colombia
HO,Honduras
IV,Cote d'Ivoire
NI,Nigeria
NP,Nepal
PA,Paraguay
SL,Sierra Leone
SO,Somalia
WI,Western Sahara
IT,Italy
WS,Samoa
YM,Yemen
CH,China
FJ,Fiji
GA,"Gambia, The"
HA,Haiti
LE,Lebanon
LI,Liberia
UG,Uganda
FO,Faroe Islands
BR,Brazil

2025-01-18 21:54:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 21:54:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 21:54:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 21:54:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 21:54:25 - snowflake.connector.connection - INFO - closed
2025-01-18 21:54:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 21:54:26 - root - INFO - SQL:
SELECT *
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGESPECIFIC
    WHERE "year" = 2020 AND "age" < 20
    LIMIT 1000;
Results:
Too long, hard cut:
country_code,country_name,year,sex,population,age
NR,Nauru,2020,Male,96,0
NR,Nauru,2020,Male,94,1
NR,Nauru,2020,Male,94,2
NR,Nauru,2020,Male,97,3
NR,Nauru,2020,Male,95,4
NR,Nauru,2020,Male,96,5
NR,Nauru,2020,Male,95,6
NR,Nauru,2020,Male,96,7
NR,Nauru,2020,Male,94,8
NR,Nauru,2020,Male,95,9
NR,Nauru,2020,Male,92,10
NR,Nauru,2020,Male,91,11
NR,Nauru,2020,Male,87,12
NR,Nauru,2020,Male,83,13
NR,Nauru,2020,Male,32,14
NR,Nauru,2020,Male,61,15
NR,Nauru,2020,Male,57,16
NR,Nauru,2020,Male,67,17
NR,Nauru,2020,Male,78,18
NR,Nauru,2020,Male,89,19
NS,Suriname,2020,Male,4584,0
NS,Suriname,2020,Male,4611,1
NS,Suriname,2020,Male,4633,2
NS,Suriname,2020,Male,4645,3
NS,Suriname,2020,Male,4668,4
NS,Suriname,2020,Male,4710,5
NS,Suriname,2020,Male,4756,6
NS,Suriname,2020,Male,4795,7
NS,Suriname,2020,Male,4825,8
NS,Suriname,2020,Male,4851,9
NS,Suriname,2020,Male,4950,10
NS,Suriname,2020,Male,5119,11
NS,Suriname,2020,Male,5289,12
NS,Suriname,2020,Male,5256,13
NS,Suriname,2020,Male,4950,14
NS,Suriname,2020,Male,4884,15
NS,Suriname,2020,Male,5092,16
NS,Suriname,2020,Male,5405,17
NS,Suriname,2020,Male,5479,18
NS,Suriname,2020,Male,5358,19
NZ,New Zealand,2020,Male,30387,0
NZ,New Zealand,2020,Male,30367,1
NZ,New Zealand,2020,Male,30432,2
NZ,New Zealand,2020,Male,30471,3
NZ,New Zealand,2020,Male,30449,4
NZ,New Zealand,2020,Male,30421,5
NZ,New Zealand,2020,Male,30418,6
NZ,New Zealand,2020,Male,30458,7
NZ,New Zealand,2020,Male,30523,8
NZ,New Zealand,2020,Male,30600,9
NZ,New Zealand,2020,Male,30721,10
NZ,New Zealand,2020,Male,30841,11
NZ,New Zealand,2020,Male,30982,12
NZ,New Zealand,2020,Male,31161,13
NZ,New Zealand,2020,Male,30948,14
NZ,New Zealand,2020,Male,30781,15
NZ,New Zealand,2020,Male,30698,16
NZ,New Zealand,2020,Male,29923,17
NZ,New Zealand,2020,Male,29914,18
NZ,New Zealand,2020,Male,31045,19
OD,South Sudan,2020,Male,196634,0
OD,South Sudan,2020,Male,181688,1
OD,South Sudan,2020,Male,167036,2
OD,South Sudan,2020,Male,156650,3
OD,South Sudan,2020,Male,146822,4
OD,South Sudan,2020,Male,150359,5
OD,South Sudan,2020,Male,153801,6
OD,South Sudan,2020,Male,152786,7
OD,South Sudan,2020,Male,145386,8
OD,South Sudan,2020,Male,138287,9
OD,South Sudan,2020,Male,134867,10
OD,South Sudan,2020,Male,129623,11
OD,South Sudan,2020,Male,128956,12
OD,South Sudan,2020,Male,128189,13
OD,South Sudan,2020,Male,127450,14
OD,South Sudan,2020,Male,125067,15
OD,South Sudan,2020,Male,124483,16
OD,South Sudan,2020,Male,123422,17
OD,South Sudan,2020,Male,123567,18
OD,South Sudan,2020,Male,122257,19
PE,Peru,2020,Male,273591,0
PE,Peru,2020,Male,274123,1
PE,Peru,2020,Male,274702,2
PE,Peru,2020,Male,275056,3
PE,Peru,2020,Male,275165,4
PE,Peru,2020,Male,275559,5
PE,Peru,2020,Male,276247,6
PE,Peru,2020,Male,276753,7
PE,Peru,2020,Male,277093,8
PE,Peru,2020,Male,277263,9
PE,Peru,2020,Male,276987,10
PE,Peru,2020,Male,276270,11
PE,Peru,2020,Male,275411,12
PE,Peru,2020,Male,274435,13
PE,Peru,2020,Male,273330,14
PE,Peru,2020,Male,272076,15
PE,Peru,2020,Male,271771,16
PE,Peru,2020,Male,272262,17
PE,Peru,2020,Male,272292,18
PE,Peru,2020,Male,271916,19
PK,Pakistan,2020,Male,2187767,0
PK,Pakistan,2020,Male,2160346,1
PK,Pakistan,2020,Male,2151300,2
PK,Pakistan,2020,Male,2142941,3
PK,Pakistan,2020,Male,2131889,4
PK,Pakistan,2020,Male,2133370,5
PK,Pakistan,2020,Male,2146795,6
PK,Pakistan,2020,Male,2155138,7
PK,Pakistan,2020,Male,2158706,8
PK,Pakistan,2020,Male,2157865,9
PK,Pakistan,2020,Male,2167883,10
PK,Pakistan,2020,Male,2188779,11
PK,Pakistan,2020,Male,2205219,12
PK,Pakistan,2020,Male,2216227,13
PK,Pakistan,2020,Male,2223357,14
PK,Pakistan,2020,Male,2237008,15
PK,Pakistan,2020,Male,2258962,16
PK,Pakistan,2020,Male,2274813,17
PK,Pakistan,2020,Male,2279317,18
PK,Pakistan,2020,Male,2278105,19
PL,Poland,2020,Male,176979,0
PL,Poland,2020,Male,180941,1
PL,Poland,2020,Male,184762,2
PL,Poland,2020,Male,188335,3
PL,Poland,2020,Male,191564,4
PL,Poland,2020,Male,194253,5
PL,Poland,2020,Male,196305,6
PL,Poland,2020,Male,197710,7
PL,Poland,2020,Male,198566,8
PL,Poland,2020,Male,205984,9
PL,Poland,2020,Male,212946,10
PL,Poland,2020,Male,211665,11
PL,Poland,2020,Male,203440,12
PL,Poland,2020,Male,190528,13
PL,Poland,2020,Male,184540,14
PL,Poland,2020,Male,182428,15
PL,Poland,2020,Male,179105,16
PL,Poland,2020,Male,178506,17
PL,Poland,2020,Male,182827,18
PL,Poland,2020,Male,188871,19
PM,Panama,2020,Male,33690,0
PM,Panama,2020,Male,33740,1
PM,Panama,2020,Male,33772,2
PM,Panama,2020,Male,33770,3
PM,Panama,2020,Male,33745,4
PM,Panama,2020,Male,33750,5
PM,Panama,2020,Male,33797,6
PM,Panama,2020,Male,33800,7
PM,Panama,2020,Male,33749,8
PM,Panama,2020,Male,33693,9
PM,Panama,2020,Male,33801,10
PM,Panama,2020,Male,34054,11
PM,Panama,2020,Male,34287,12
PM,Panama,2020,Male,34490,13
PM,Panama,2020,Male,33993,14
PM,Panama,2020,Male,33135,15
PM,Panama,2020,Male,32588,16
PM,Panama,2020,Male,32260,17
PM,Panama,2020,Male,32748,18
PM,Panama,2020,Male,33485,19
PO,Portugal,2020,Male,42564,0
PO,Portugal,2020,Male,43022,1
PO,Portugal,2020,Male,43600,2
PO,Portugal,2020,Male,44258,3
PO,Portugal,2020,Male,44050,4


2025-01-18 21:54:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 21:54:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 21:54:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 21:54:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 228
2025-01-18 21:54:27 - snowflake.connector.connection - INFO - closed
2025-01-18 21:54:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 21:54:27 - root - INFO - SQL:
SELECT "country_code", "country_name", "midyear_population"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION
    WHERE "year" = 2020
    LIMIT 1000;
Results:
country_code,country_name,midyear_population
AA,Aruba,119428
AC,Antigua and Barbuda,98179
AE,United Arab Emirates,9992083
AF,Afghanistan,36643815
AG,Algeria,42972878
AJ,Azerbaijan,10205810
AL,Albania,3074579
AM,Armenia,3021324
AN,Andorra,85635
AO,Angola,32522339
AQ,American Samoa,49437
AR,Argentina,45479118
AS,Australia,23938599
AU,Austria,8859449
AV,Anguilla,18090
BA,Bahrain,1505003
BB,Barbados,294560
BC,Botswana,2317233
BD,Bermuda,71750
BE,Belgium,11720716
BF,"Bahamas, The",337721
BG,Bangladesh,162650853
BH,Belize,399598
BK,Bosnia and Herzegovina,3835586
BL,Bolivia,11639909
BM,Burma,56590071
BN,Benin,11956340
BO,Belarus,9477918
BP,Solomon Islands,685097
BR,Brazil,211715973
BT,Bhutan,782318
BU,Bulgaria,6966899
BX,Brunei,464478
BY,Burundi,12631974
CA,Canada,36387359
CB,Cambodia,16926984
CD,Chad,16877357
CE,Sri Lanka,22889201
CF,Congo (Brazzaville),5293070
CG,Congo (Kinshasa),89249735
CH,China,1394015977
CI,Chile,18186770
CJ,Cayman Islands,61944
CM,Cameroon,26969408
CN,Comoros,846281
CO,Colombia,49084841
CQ,Northern Mariana Islands,51433
CS,Costa Rica,5097988
CT,Central African Republic,5990855
CU,Cuba,11059062
CV,Cabo Verde,583255
CW,Cook Islands,8574
CY,Cyprus,1266676
DA,Denmark,5869410
DJ,Djibouti,921804
DO,Dominica,74243
DR,Dominican Republic,10499707
EC,Ecuador,16904867
EG,Egypt,104124440
EI,Ireland,5176569
EK,Equatorial Guinea,836178
EN,Estonia,1228624
ER,Eritrea,6081196
ES,El Salvador,6217074
ET,Ethiopia,114640234
EZ,Czechia,10702498
FI,Finland,5571665
FJ,Fiji,935974
FM,"Micronesia, Federated States of",102436
FO,Faroe Islands,51628
FP,French Polynesia,295121
FR,France,67848156
GA,"Gambia, The",2173999
GB,Gabon,2230908
GG,Georgia,4930030
GH,Ghana,29340248
GI,Gibraltar,29581
GJ,Grenada,113094
GK,Guernsey,67052
GL,Greenland,57616
GM,Germany,80159662
GQ,Guam,168485
GR,Greece,10742032
GT,Guatemala,17153288
GV,Guinea,12527440
GY,Guyana,750204
GZ,Gaza Strip,1918221
HA,Haiti,11067777
HK,Hong Kong,7249907
HO,Honduras,9465127
HR,Croatia,4227746
HU,Hungary,9771827
IC,Iceland,350734
ID,Indonesia,267026366
IM,Isle of Man,90499
IN,India,1326093247
IR,Iran,84923314
IS,Israel,8675475
IT,Italy,62402659
IV,Cote d'Ivoire,27481086
IZ,Iraq,42212862
JA,Japan,125507472
JE,Jersey,101073
JM,Jamaica,2808570
JO,Jordan,10820644
KE,Kenya,49858045
KG,Kyrgyzstan,5964897
KN,"Korea, North",25643466
KR,Kiribati,111796
KS,"Korea, South",51835110
KU,Kuwait,2993706
KV,Kosovo,1932774
KZ,Kazakhstan,19091949
LA,Laos,7447396
LE,Lebanon,5469612
LG,Latvia,1881232
LH,Lithuania,2731464
LI,Liberia,5073296
LO,Slovakia,5440602
LS,Liechtenstein,39137
LT,Lesotho,1969334
LU,Luxembourg,628381
LY,Libya,6942544
MA,Madagascar,26955737
MC,Macau,614458
MD,Moldova,3364496
MG,Mongolia,3168026
MH,Montserrat,5373
MI,Malawi,21196629
MJ,Montenegro,609859
MK,Macedonia,2125971
ML,Mali,19553397
MN,Monaco,30940
MO,Morocco,34955862
MP,Mauritius,1379365
MR,Mauritania,4005475
MT,Malta,457267
MU,Oman,3634689
MV,Maldives,391904
MX,Mexico,128649565
MY,Malaysia,32652083
MZ,Mozambique,28603070
NC,New Caledonia,290009
NG,Niger,21151442
NH,Vanuatu,298333
NI,Nigeria,214028302
NL,Netherlands,17280397
NN,Sint Maarten,43847
NO,Norway,5467439
NP,Nepal,30327877
NR,Nauru,9785
NS,Suriname,609569
NU,Nicaragua,6203441
NZ,New Zealand,4614669
OD,South Sudan,10561244
PA,Paraguay,7191685
PE,Peru,31914989
PK,Pakistan,213719471
PL,Poland,38282325
PM,Panama,3894082
PO,Portugal,10302674
PP,Papua New Guinea,7259456
PS,Palau,21685
PU,Guinea-Bissau,1927104
QA,Qatar,2444174
RI,Serbia,7012165
RM,Marshall Islands,77917
RN,Saint Martin,32556
RO,Romania,21302893
RP,Philippines,109180815
RQ,Puerto Rico,3189068
RS,Russia,141722205
RW,Rwanda,12712431
SA,Saudi Arabia,34173498
SB,Saint Pierre and Miquelon,5347
SC,Saint Kitts and Nevis,53821
SE,Seychelles,95981
SF,South Africa,56463617
SG,Senegal,15736368
SH,"Saint Helena, Ascension, and Tristan da Cunha",7862
SI,Slovenia,2102678
SL,Sierra Leone,6624933
SM,San Marino,34232
SN,Singapore,6209660
SO,Somalia,11757124
SP,Spain,50015792
ST,Saint Lucia,166487
SU,Sudan,45561556
SW,Sweden,10202491
SY,Syria,22346237
SZ,Switzerland,8403994
TB,Saint Barthelemy,7122
TD,Trinidad and Tobago,1208789
TH,Thailand,68977400
TI,Tajikistan,8873669
TK,Turks and Caicos Islands,55926
TN,Tonga,106095
TO,Togo,8608444
TP,Sao Tome and Principe,211122
TS,Tunisia,11721177
TT,Timor-Leste,1383723
TU,Turkey,82017514
TV,Tuvalu,11342
TW,Taiwan,23603049
TX,Turkmenistan,5528627
TZ,Tanzania,58552845
UC,Curacao,151345
UG,Uganda,43517666
UK,United Kingdom,65761117
UP,Ukraine,43922939
US,United States,334503458
UV,Burkina Faso,20835401
UY,Uruguay,3387605
UZ,Uzbekistan,30565411
VC,Saint Vincent and the Grenadines,101390
VE,Venezuela,32442058
VI,"Virgin Islands, British",37381
VM,Vietnam,98721275
VQ,"Virgin Islands, U.S.",106235
WA,Namibia,2630073
WE,West Bank,2900034
WF,Wallis and Futuna,15854
WI,Western Sahara,652271
WS,Samoa,203774
WZ,Eswatini,1104479
YM,Yemen,29884405
ZA,Zambia,17426623
ZI,Zimbabwe,14546314

2025-01-18 21:54:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 21:54:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 21:54:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 21:54:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-18 21:54:29 - snowflake.connector.connection - INFO - closed
2025-01-18 21:54:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 21:54:29 - root - INFO - SQL:
SELECT DISTINCT "sex"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGESPECIFIC
    WHERE "year" = 2020
    LIMIT 1000;
Results:
sex
Male
Female

2025-01-18 21:54:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 21:54:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 21:54:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 21:54:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-18 21:54:30 - snowflake.connector.connection - INFO - closed
2025-01-18 21:54:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 21:55:03 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 21:55:03 - root - INFO - ```sql
SELECT
    mp."country_name",
    SUM(mpa."population") AS total_population_under_20,
    mp."midyear_population" AS total_midyear_population,
    (SUM(mpa."population") / mp."midyear_population") * 100 AS percentage_under_20
FROM
    CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGESPECIFIC mpa
JOIN
    CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION mp
ON
    mpa."country_code" = mp."country_code" AND mpa."year" = mp."year"
WHERE
    mpa."year" = 2020 AND mpa."age" < 20
GROUP BY
    mp."country_name", mp."midyear_population"
ORDER BY
    percentage_under_20 DESC
LIMIT 10;
```
2025-01-18 21:55:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 21:55:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 21:55:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 21:55:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-18 21:55:05 - snowflake.connector.connection - INFO - closed
2025-01-18 21:55:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 21:55:05 - root - INFO - SQL:
SELECT
    mp."country_name",
    SUM(mpa."population") AS total_population_under_20,
    mp."midyear_population" AS total_midyear_population,
    (SUM(mpa."population") / mp."midyear_population") * 100 AS percentage_under_20
FROM
    CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGESPECIFIC mpa
JOIN
    CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION mp
ON
    mpa."country_code" = mp."country_code" AND mpa."year" = mp."year"
WHERE
    mpa."year" = 2020 AND mpa."age" < 20
GROUP BY
    mp."country_name", mp."midyear_population"
ORDER BY
    percentage_under_20 DESC
LIMIT 10;
Results:
country_name,TOTAL_POPULATION_UNDER_20,TOTAL_MIDYEAR_POPULATION,PERCENTAGE_UNDER_20
Niger,12498275,21151442,59.089500
Uganda,25564420,43517666,58.744900
Chad,9890342,16877357,58.601200
Mali,11408590,19553397,58.345800
Angola,18948312,32522339,58.262500
Malawi,12065049,21196629,56.919700
Zambia,9860261,17426623,56.581600
Burundi,7045417,12631974,55.774500
Mozambique,15917856,28603070,55.650900
Burkina Faso,11437351,20835401,54.893800

2025-01-18 21:55:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 21:55:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 21:55:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 21:55:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 22
2025-01-18 21:55:07 - snowflake.connector.connection - INFO - closed
2025-01-18 21:55:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 21:55:07 - root - INFO - SQL:
SELECT DISTINCT "starting_age", "ending_age"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_5YR_AGE_SEX
    ORDER BY "starting_age"
    LIMIT 1000;
Results:
starting_age,ending_age
0,0
0,4
5,9
10,14
15,19
20,24
25,29
30,34
35,39
40,44
45,49
50,54
55,59
60,64
65,69
70,74
75,79
80,84
85,89
90,94
95,99
100,0

2025-01-18 21:55:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 21:55:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 21:55:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 21:55:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-18 21:55:09 - snowflake.connector.connection - INFO - closed
2025-01-18 21:55:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 21:55:09 - root - INFO - SQL:
SELECT DISTINCT "total_flag"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_5YR_AGE_SEX
    LIMIT 1000;
Results:
total_flag
*
A

2025-01-18 21:55:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 21:55:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 21:55:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 21:55:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-18 21:55:11 - snowflake.connector.connection - INFO - closed
2025-01-18 21:55:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 21:55:11 - root - INFO - SQL:
SELECT *
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_5YR_AGE_SEX
    WHERE "year" = 2020 AND "starting_age" < 20
    LIMIT 1000;
Results:
Too long, hard cut:
country_code,country_name,year,total_flag,starting_age,age_group_indicator,ending_age,midyear_population,midyear_population_male,midyear_population_female
AA,Aruba,2020,*,0,+,0,119428,56491,62937
AC,Antigua and Barbuda,2020,*,0,+,0,98179,46320,51859
AE,United Arab Emirates,2020,*,0,+,0,9992083,7186974,2805109
AF,Afghanistan,2020,*,0,+,0,36643815,18557871,18085944
AG,Algeria,2020,*,0,+,0,42972878,21770912,21201966
AJ,Azerbaijan,2020,*,0,+,0,10205810,5061260,5144550
AL,Albania,2020,*,0,+,0,3074579,1518421,1556158
AM,Armenia,2020,*,0,+,0,3021324,1470550,1550774
AN,Andorra,2020,*,0,+,0,85635,43960,41675
AO,Angola,2020,*,0,+,0,32522339,15846967,16675372
AQ,American Samoa,2020,*,0,+,0,49437,24669,24768
AR,Argentina,2020,*,0,+,0,45479118,22506182,22972936
AS,Australia,2020,*,0,+,0,23938599,12004390,11934209
AU,Austria,2020,*,0,+,0,8859449,4338457,4520992
AV,Anguilla,2020,*,0,+,0,18090,8555,9535
BA,Bahrain,2020,*,0,+,0,1505003,911044,593959
BB,Barbados,2020,*,0,+,0,294560,142372,152188
BC,Botswana,2020,*,0,+,0,2317233,1113254,1203979
BD,Bermuda,2020,*,0,+,0,71750,34693,37057
BE,Belgium,2020,*,0,+,0,11720716,5776934,5943782
BF,"Bahamas, The",2020,*,0,+,0,337721,165549,172172
BG,Bangladesh,2020,*,0,+,0,162650853,79959419,82691434
BH,Belize,2020,*,0,+,0,399598,200148,199450
BK,Bosnia and Herzegovina,2020,*,0,+,0,3835586,1869297,1966289
BL,Bolivia,2020,*,0,+,0,11639909,5759719,5880190
BM,Burma,2020,*,0,+,0,56590071,27908385,28681686
BN,Benin,2020,*,0,+,0,11956340,6018154,5938186
BO,Belarus,2020,*,0,+,0,9477918,4408657,5069261
BP,Solomon Islands,2020,*,0,+,0,685097,349817,335280
BR,Brazil,2020,*,0,+,0,211715973,104241576,107474397
BT,Bhutan,2020,*,0,+,0,782318,406892,375426
BU,Bulgaria,2020,*,0,+,0,6966899,3395545,3571354
BX,Brunei,2020,*,0,+,0,464478,227530,236948
BY,Burundi,2020,*,0,+,0,12631974,6293246,6338728
CA,Canada,2020,*,0,+,0,36387359,18039233,18348126
CB,Cambodia,2020,*,0,+,0,16926984,8240844,8686140
CD,Chad,2020,*,0,+,0,16877357,8351473,8525884
CE,Sri Lanka,2020,*,0,+,0,22889201,11172459,11716742
CF,Congo (Brazzaville),2020,*,0,+,0,5293070,2653336,2639734
CG,Congo (Kinshasa),2020,*,0,+,0,89249735,44535192,44714543
CH,China,2020,*,0,+,0,1394015977,715630046,678385931
CI,Chile,2020,*,0,+,0,18186770,8938796,9247974
CJ,Cayman Islands,2020,*,0,+,0,61944,30148,31796
CM,Cameroon,2020,*,0,+,0,26969408,13518253,13451155
CN,Comoros,2020,*,0,+,0,846281,409219,437062
CO,Colombia,2020,*,0,+,0,49084841,24255454,24829387
CQ,Northern Mariana Islands,2020,*,0,+,0,51433,27298,24135
CS,Costa Rica,2020,*,0,+,0,5097988,2554050,2543938
CT,Central African Republic,2020,*,0,+,0,5990855,2977238,3013617
CU,Cuba,2020,*,0,+,0,11059062,5498768,5560294
CV,Cabo Verde,2020,*,0,+,0,583255,283318,299937
CW,Cook Islands,2020,*,0,+,0,8574,4409,4165
CY,Cyprus,2020,*,0,+,0,1266676,647166,619510
DA,Denmark,2020,*,0,+,0,5869410,2923788,2945622
DJ,Djibouti,2020,*,0,+,0,921804,419229,502575
DO,Dominica,2020,*,0,+,0,74243,37502,36741
DR,Dominican Republic,2020,*,0,+,0,10499707,5308983,5190724
EC,Ecuador,2020,*,0,+,0,16904867,8387914,8516953
EG,Egypt,2020,*,0,+,0,104124440,53203274,50921166
EI,Ireland,2020,*,0,+,0,5176569,2585243,2591326
EK,Equatorial Guinea,2020,*,0,+,0,836178,417585,418593
EN,Estonia,2020,*,0,+,0,1228624,576410,652214
ER,Eritrea,2020,*,0,+,0,6081196,2993644,3087552
ES,El Salvador,2020,*,0,+,0,6217074,2984204,3232870
ET,Ethiopia,2020,*,0,+,0,114640234,56928264,57711970
EZ,Czechia,2020,*,0,+,0,10702498,5269287,5433211
FI,Finland,2020,*,0,+,0,5571665,2744743,2826922
FJ,Fiji,2020,*,0,+,0,935974,474793,461181
FM,"Micronesia, Federated States of",2020,*,0,+,0,102436,50361,52075
FO,Faroe Islands,2020,*,0,+,0,51628,26783,24845
FP,French Polynesia,2020,*,0,+,0,295121,150945,144176
FR,France,2020,*,0,+,0,67848156,33226264,34621892
GA,"Gambia, The",2020,*,0,+,0,2173999,1073546,1100453
GB,Gabon,2020,*,0,+,0,2230908,1158764,1072144
GG,Georgia,2020,*,0,+,0,4930030,2359060,2570970
GH,Ghana,2020,*,0,+,0,29340248,14460542,14879706
GI,Gibraltar,2020,*,0,+,0,29581,14829,14752
GJ,Grenada,2020,*,0,+,0,113094,57355,55739
GK,Guernsey,2020,*,0,+,0,67052,33309,33743
GL,Greenland,2020,*,0,+,0,57616,29958,27658
GM,Germany,2020,*,0,+,0,80159662,39315349,40844313
GQ,Guam,2020,*,0,+,0,168485,86733,81752
GR,Greece,2020,*,0,+,0,10742032,5234464,5507568
GT,Guatemala,2020,*,0,+,0,17153288,8510685,8642603
GV,Guinea,2020,*,0,+,0,12527440,6256267,6271173
GY,Guyana,2020,*,0,+,0,750204,378146,372058
GZ,Gaza Strip,2020,*,0,+,0,1918221,968624,949597
HA,Haiti,2020,*,0,+,0,11067777,5466449,5601328
HK,Hong Kong,2020,*,0,+,0,7249907,3361342,3888565
HO,Honduras,2020,*,0,+,0,9465127,4768364,4696763
HR,Croatia,2020,*,0,+,0,4227746,2039258,2188488
HU,Hungary,2020,*,0,+,0,9771827,4660271,5111556
IC,Iceland,2020,*,0,+,0,350734,175677,175057
ID,Indonesia,2020,*,0,+,0,267026366,133643347,133383019
IM,Isle of Man,2020,*,0,+,0,90499,45403,45096
IN,India,2020,*,0,+,0,1326093247,688215563,637877684
IR,Iran,2020,*,0,+,0,84923314,43050667,41872647
IS,Israel,2020,*,0,+,0,8675475,4361465,4314

2025-01-18 21:55:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 21:55:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 21:55:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 21:55:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 456
2025-01-18 21:55:13 - snowflake.connector.connection - INFO - closed
2025-01-18 21:55:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 21:55:13 - root - INFO - SQL:
SELECT "country_code", "country_name", "sex", "population_age_0", "population_age_1", "population_age_2"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGE_SEX
    WHERE "year" = 2020
    LIMIT 1000;
Results:
Too long, hard cut:
country_code,country_name,sex,population_age_0,population_age_1,population_age_2
AA,Aruba,Male,720,720,716
AA,Aruba,Female,710,710,710
AC,Antigua and Barbuda,Male,767,766,765
AC,Antigua and Barbuda,Female,733,733,732
AE,United Arab Emirates,Male,48917,49999,51018
AE,United Arab Emirates,Female,46286,47471,48598
AF,Afghanistan,Male,631283,590431,569228
AF,Afghanistan,Female,608877,571631,551135
AG,Algeria,Male,437515,445066,452500
AG,Algeria,Female,416875,424157,431128
AJ,Azerbaijan,Male,75405,77103,78878
AJ,Azerbaijan,Female,70994,71885,72835
AL,Albania,Male,20602,20611,20558
AL,Albania,Female,19087,19017,18892
AM,Armenia,Male,18761,19208,19609
AM,Armenia,Female,17120,17424,17685
AN,Andorra,Male,310,317,326
AN,Andorra,Female,291,298,305
AO,Angola,Male,660500,629185,606737
AO,Angola,Female,646300,619198,598705
AQ,American Samoa,Male,451,455,460
AQ,American Samoa,Female,426,431,435
AR,Argentina,Male,373421,374765,376335
AR,Argentina,Female,350922,352258,353783
AS,Australia,Male,146041,145824,145527
AS,Australia,Female,138505,138301,138022
AU,Austria,Male,43096,43154,43139
AU,Austria,Female,40960,41025,41020
AV,Anguilla,Male,125,137,137
AV,Anguilla,Female,120,130,132
BA,Bahrain,Male,9588,9585,9565
BA,Bahrain,Female,9353,9349,9333
BB,Barbados,Male,1665,1673,1682
BB,Barbados,Female,1650,1660,1670
BC,Botswana,Male,24031,23984,23970
BC,Botswana,Female,23434,23409,23406
BD,Bermuda,Male,405,406,404
BD,Bermuda,Female,398,398,399
BE,Belgium,Male,66858,67344,67772
BE,Belgium,Female,63773,64226,64622
BF,"Bahamas, The",Male,2515,2519,2520
BF,"Bahamas, The",Female,2442,2446,2448
BG,Bangladesh,Male,1465727,1458492,1453988
BG,Bangladesh,Female,1414944,1409341,1405349
BH,Belize,Male,4456,4454,4458
BH,Belize,Female,4254,4255,4261
BK,Bosnia and Herzegovina,Male,17040,17201,17336
BK,Bosnia and Herzegovina,Female,15899,16050,16177
BL,Bolivia,Male,120629,119896,119784
BL,Bolivia,Female,115477,115018,114949
BM,Burma,Male,483056,484850,488353
BM,Burma,Female,457897,460170,463532
BN,Benin,Male,195933,189880,185751
BN,Benin,Female,187431,182014,178096
BO,Belarus,Male,47004,48305,49619
BO,Belarus,Female,44377,45609,46856
BP,Solomon Islands,Male,8128,8031,7957
BP,Solomon Islands,Female,7744,7625,7532
BR,Brazil,Male,1451503,1455327,1460979
BR,Brazil,Female,1389711,1395083,1401298
BT,Bhutan,Male,6421,6422,6441
BT,Bhutan,Female,6117,6117,6138
BU,Bulgaria,Male,29744,30363,30971
BU,Bulgaria,Female,28060,28648,29228
BX,Brunei,Male,3870,3836,3799
BX,Brunei,Female,3700,3660,3611
BY,Burundi,Male,242843,232238,224221
BY,Burundi,Female,237877,228476,220683
CA,Canada,Male,188828,189456,189892
CA,Canada,Female,179031,179954,180695
CB,Cambodia,Male,178385,177626,177458
CB,Cambodia,Female,172283,172421,172593
CD,Chad,Male,335946,320036,308761
CD,Chad,Female,325657,311867,301103
CE,Sri Lanka,Male,165707,167704,169835
CE,Sri Lanka,Female,159595,161504,163526
CF,Congo (Brazzaville),Male,83218,81097,79785
CF,Congo (Brazzaville),Female,81366,79495,78196
CG,Congo (Kinshasa),Male,1344639,1308647,1285409
CG,Congo (Kinshasa),Female,1312359,1281776,1261550
CH,China,Male,8535239,8695128,8824913
CH,China,Female,7649472,7747703,7814760
CI,Chile,Male,121259,121758,122179
CI,Chile,Female,116419,116910,117325
CJ,Cayman Islands,Male,378,388,385
CJ,Cayman Islands,Female,372,381,378
CM,Cameroon,Male,445204,430721,418475
CM,Cameroon,Female,434671,421699,410437
CN,Comoros,Male,9742,9673,9732
CN,Comoros,Female,9591,9612,9701
CO,Colombia,Male,384246,385064,385802
CO,Colombia,Female,364285,365370,366218
CQ,Northern Mariana Islands,Male,410,404,400
CQ,Northern Mariana Islands,Female,353,348,344
CS,Costa Rica,Male,38461,38648,38815
CS,Costa Rica,Female,36682,36869,37031
CT,Central African Republic,Male,94218,89761,87430
CT,Central African Republic,Female,92571,88592,86370
CU,Cuba,Male,59271,60051,60782
CU,Cuba,Female,55967,56710,57405
CV,Cabo Verde,Male,5551,5511,5467
CV,Cabo Verde,Female,5420,5394,5358
CW,Cook Islands,Male,58,57,58
CW,Cook Islands,Female,55,54,54
CY,Cyprus,Male,7045,7064,7076
CY,Cyprus,Female,6726,6743,6747
DA,Denmark,Male,33332,33048,32798
DA,Denmark,Female,31331,31099,30893
DJ,Djibouti,Male,10208,9953,9767
DJ,Djibouti,Female,10000,9804,9638
DO,Dominica,Male,548,553,556
DO,Dominica,Female,524,529,531
DR,Dominican Republic,Male,96797,96386,96052
DR,Dominican Republic,Female,93432,93074,92754
EC,Ecuador,Male,145510,145824,146233
EC,Ecuador,Female,139290,139744,140198
EG,Egypt,Male,1428011,1407238,1392536
EG,Egypt,Female,1344028,1323272,1307850
EI,Ireland,Male,34832,35508,36173
EI,Ireland,Female,32989,33657,34318
EK,Equatorial Guinea,Male,12393,11995,11774
EK,Equatorial Guinea,Female,12061,11665,11433
EN,Estonia,Male,5928,6106,6272
EN,Estonia,Female,5659,5833,5997
ER,Eritrea,Male,82518,80973,79711
ER,Eritrea,Female,80941,79723,78545
ES,El Salvador,Male,49330,49367,49417
ES,El Salvador,Female,47115,47102,47086
ET,Ethiopia,Male,1945938,1881410,1832627
ET,Ethiopia,Female,1908975,1855078,1809787
EZ,Czechia,Male,49247,50204,51140
EZ,Czechia,Female,46672,47528,48367

2025-01-18 21:55:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 21:55:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 21:55:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 21:55:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 21
2025-01-18 21:55:15 - snowflake.connector.connection - INFO - closed
2025-01-18 21:55:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 21:55:15 - root - INFO - SQL:
SELECT DISTINCT "max_age"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGE_SEX
    LIMIT 1000;
Results:
max_age
100
97
99
96
95
94
93
92
91
90
89
87
88
84
80
83
85
98
81
86
82

2025-01-18 21:55:15 - root - INFO - itercount: 0
2025-01-18 21:55:15 - root - INFO - Database Name: CENSUS_BUREAU_INTERNATIONAL
Schema Name: CENSUS_BUREAU_INTERNATIONAL
DDL describes table information.
,0
table_name,AGE_SPECIFIC_FERTILITY_RATES
description,
DDL,"create or replace TABLE AGE_SPECIFIC_FERTILITY_RATES (
	""country_code"" VARCHAR(16777216),
	""country_name"" VARCHAR(16777216),
	""year"" NUMBER(38,0),
	""fertility_rate_15_19"" FLOAT,
	""fertility_rate_20_24"" FLOAT,
	""fertility_rate_25_29"" FLOAT,
	""fertility_rate_30_34"" FLOAT,
	""fertility_rate_35_39"" FLOAT,
	""fertility_rate_40_44"" FLOAT,
	""fertility_rate_45_49"" FLOAT,
	""total_fertility_rate"" FLOAT,
	""gross_reproduction_rate"" FLOAT,
	""sex_ratio_at_birth"" FLOAT
);"

,1
table_name,MIDYEAR_POPULATION
description,
DDL,"create or replace TABLE MIDYEAR_POPULATION (
	""country_code"" VARCHAR(16777216),
	""country_name"" VARCHAR(16777216),
	""year"" NUMBER(38,0),
	""midyear_population"" NUMBER(38,0)
);"

,2
table_name,MIDYEAR_POPULATION_5YR_AGE_SEX
description,
DDL,"create or replace TABLE MIDYEAR_POPULATION_5YR_AGE_SEX (
	""country_code"" VARCHAR(16777216),
	""country_name"" VARCHAR(16777216),
	""year"" NUMBER(38,0),
	""total_flag"" VARCHAR(16777216),
	""starting_age"" NUMBER(38,0),
	""age_group_indicator"" VARCHAR(16777216),
	""ending_age"" NUMBER(38,0),
	""midyear_population"" NUMBER(38,0),
	""midyear_population_male"" NUMBER(38,0),
	""midyear_population_female"" NUMBER(38,0)
);"

,3
table_name,BIRTH_DEATH_GROWTH_RATES
description,
DDL,"create or replace TABLE BIRTH_DEATH_GROWTH_RATES (
	""country_code"" VARCHAR(16777216),
	""country_name"" VARCHAR(16777216),
	""year"" NUMBER(38,0),
	""crude_birth_rate"" FLOAT,
	""crude_death_rate"" FLOAT,
	""net_migration"" FLOAT,
	""rate_natural_increase"" FLOAT,
	""growth_rate"" FLOAT
);"

,4
table_name,COUNTRY_NAMES_AREA
description,
DDL,"create or replace TABLE COUNTRY_NAMES_AREA (
	""country_code"" VARCHAR(16777216),
	""country_name"" VARCHAR(16777216),
	""country_area"" FLOAT
);"

,5
table_name,MIDYEAR_POPULATION_AGESPECIFIC
description,
DDL,"create or replace TABLE MIDYEAR_POPULATION_AGESPECIFIC (
	""country_code"" VARCHAR(16777216),
	""country_name"" VARCHAR(16777216),
	""year"" NUMBER(38,0),
	""sex"" VARCHAR(16777216),
	""population"" NUMBER(38,0),
	""age"" NUMBER(38,0)
);"

,6
table_name,MORTALITY_LIFE_EXPECTANCY
description,
DDL,"create or replace TABLE MORTALITY_LIFE_EXPECTANCY (
	""country_code"" VARCHAR(16777216),
	""country_name"" VARCHAR(16777216),
	""year"" NUMBER(38,0),
	""infant_mortality"" FLOAT,
	""infant_mortality_male"" FLOAT,
	""infant_mortality_female"" FLOAT,
	""life_expectancy"" FLOAT,
	""life_expectancy_male"" FLOAT,
	""life_expectancy_female"" FLOAT,
	""mortality_rate_under5"" FLOAT,
	""mortality_rate_under5_male"" FLOAT,
	""mortality_rate_under5_female"" FLOAT,
	""mortality_rate_1to4"" FLOAT,
	""mortality_rate_1to4_male"" FLOAT,
	""mortality_rate_1to4_female"" FLOAT
);"

,7
table_name,MIDYEAR_POPULATION_AGE_SEX
description,
DDL,"create or replace TABLE MIDYEAR_POPULATION_AGE_SEX (
	""country_code"" VARCHAR(16777216),
	""country_name"" VARCHAR(16777216),
	""year"" NUMBER(38,0),
	""sex"" VARCHAR(16777216),
	""max_age"" NUMBER(38,0),
	""population_age_0"" NUMBER(38,0),
	""population_age_1"" NUMBER(38,0),
	""population_age_2"" NUMBER(38,0),
	""population_age_3"" NUMBER(38,0),
	""population_age_4"" NUMBER(38,0),
	""population_age_5"" NUMBER(38,0),
	""population_age_6"" NUMBER(38,0),
	""population_age_7"" NUMBER(38,0),
	""population_age_8"" NUMBER(38,0),
	""population_age_9"" NUMBER(38,0),
	""population_age_10"" NUMBER(38,0),
	""population_age_11"" NUMBER(38,0),
	""population_age_12"" NUMBER(38,0),
	""population_age_13"" NUMBER(38,0),
	""population_age_14"" NUMBER(38,0),
	""population_age_15"" NUMBER(38,0),
	""population_age_16"" NUMBER(38,0),
	""population_age_17"" NUMBER(38,0),
	""population_age_18"" NUMBER(38,0),
	""population_age_19"" NUMBER(38,0),
	""population_age_20"" NUMBER(38,0),
	""population_age_21"" NUMBER(38,0),
	""population_age_22"" NUMBER(38,0),
	""population_age_23"" NUMBER(38,0),
	""population_age_24"" NUMBER(38,0),
	""population_age_25"" NUMBER(38,0),
	""population_age_26"" NUMBER(38,0),
	""population_age_27"" NUMBER(38,0),
	""population_age_28"" NUMBER(38,0),
	""population_age_29"" NUMBER(38,0),
	""population_age_30"" NUMBER(38,0),
	""population_age_31"" NUMBER(38,0),
	""population_age_32"" NUMBER(38,0),
	""population_age_33"" NUMBER(38,0),
	""population_age_34"" NUMBER(38,0),
	""population_age_35"" NUMBER(38,0),
	""population_age_36"" NUMBER(38,0),
	""population_age_37"" NUMBER(38,0),
	""population_age_38"" NUMBER(38,0),
	""population_age_39"" NUMBER(38,0),
	""population_age_40"" NUMBER(38,0),
	""population_age_41"" NUMBER(38,0),
	""population_age_42"" NUMBER(38,0),
	""population_age_43"" NUMBER(38,0),
	""population_age_44"" NUMBER(38,0),
	""population_age_45"" NUMBER(38,0),
	""population_age_46"" NUMBER(38,0),
	""population_age_47"" NUMBER(38,0),
	""population_age_48"" NUMBER(38,0),
	""population_age_49"" NUMBER(38,0),
	""population_age_50"" NUMBER(38,0),
	""population_age_51"" NUMBER(38,0),
	""population_age_52"" NUMBER(38,0),
	""population_age_53"" NUMBER(38,0),
	""population_age_54"" NUMBER(38,0),
	""population_age_55"" NUMBER(38,0),
	""population_age_56"" NUMBER(38,0),
	""population_age_57"" NUMBER(38,0),
	""population_age_58"" NUMBER(38,0),
	""population_age_59"" NUMBER(38,0),
	""population_age_60"" NUMBER(38,0),
	""population_age_61"" NUMBER(38,0),
	""population_age_62"" NUMBER(38,0),
	""population_age_63"" NUMBER(38,0),
	""population_age_64"" NUMBER(38,0),
	""population_age_65"" NUMBER(38,0),
	""population_age_66"" NUMBER(38,0),
	""population_age_67"" NUMBER(38,0),
	""population_age_68"" NUMBER(38,0),
	""population_age_69"" NUMBER(38,0),
	""population_age_70"" NUMBER(38,0),
	""population_age_71"" NUMBER(38,0),
	""population_age_72"" NUMBER(38,0),
	""population_age_73"" NUMBER(38,0),
	""population_age_74"" NUMBER(38,0),
	""population_age_75"" NUMBER(38,0),
	""population_age_76"" NUMBER(38,0),
	""population_age_77"" NUMBER(38,0),
	""population_age_78"" NUMBER(38,0),
	""population_age_79"" NUMBER(38,0),
	""population_age_80"" NUMBER(38,0),
	""population_age_81"" NUMBER(38,0),
	""population_age_82"" NUMBER(38,0),
	""population_age_83"" NUMBER(38,0),
	""population_age_84"" NUMBER(38,0),
	""population_age_85"" NUMBER(38,0),
	""population_age_86"" NUMBER(38,0),
	""population_age_87"" NUMBER(38,0),
	""population_age_88"" NUMBER(38,0),
	""population_age_89"" NUMBER(38,0),
	""population_age_90"" NUMBER(38,0),
	""population_age_91"" NUMBER(38,0),
	""population_age_92"" NUMBER(38,0),
	""population_age_93"" NUMBER(38,0),
	""population_age_94"" NUMBER(38,0),
	""population_age_95"" NUMBER(38,0),
	""population_age_96"" NUMBER(38,0),
	""population_age_97"" NUMBER(38,0),
	""population_age_98"" NUMBER(38,0),
	""population_age_99"" NUMBER(38,0),
	""population_age_100"" NUMBER(38,0)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'CENSUS_BUREAU_INTERNATIONAL': {'CENSUS_BUREAU_INTERNATIONAL': ['AGE_SPECIFIC_FERTILITY_RATES', 'BIRTH_DEATH_GROWTH_RATES', 'COUNTRY_NAMES_AREA', 'MIDYEAR_POPULATION', 'MIDYEAR_POPULATION_5YR_AGE_SEX', 'MIDYEAR_POPULATION_AGESPECIFIC', 'MIDYEAR_POPULATION_AGE_SEX', 'MORTALITY_LIFE_EXPECTANCY']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

To accomplish the task, we need to identify which tables and columns provide the necessary data to calculate the percentage of the population under 20 years old for each country in 2020.

**Tables:**

1. **`MIDYEAR_POPULATION_AGESPECIFIC`**
   - Contains population counts for each specific age, by country, year, and sex.

2. **`MIDYEAR_POPULATION`**
   - Contains the total midyear population for each country and year.

**Columns and Potential Usage:**

- **From `MIDYEAR_POPULATION_AGESPECIFIC`:**
  - `"country_code"`: Used to uniquely identify each country and to join between tables.
  - `"country_name"`: Name of the country; useful for display.
  - `"year"`: To filter records for the year **2020** (`"year" = 2020`).
  - `"age"`: To select populations under 20 years old (`"age" < 20`).
  - `"sex"`: To account for male, female, or total populations; may need to sum if separate.
  - `"population"`: The population count for a specific age, sex, country, and year.

- **From `MIDYEAR_POPULATION`:**
  - `"country_code"`: Used to uniquely identify each country and to join between tables.
  - `"country_name"`: Name of the country; useful for display.
  - `"year"`: To filter records for the year **2020** (`"year" = 2020`).
  - `"midyear_population"`: The total midyear population for the country and year.

**Conditions That May Be Used:**

- `"year" = 2020`: To focus on data from the year 2020.
- `"age" < 20`: To select population counts for ages under 20.
- `"sex" = 'Total'` or summing over `"sex"`: Depending on whether total population by age is available or if we need to sum male and female populations.

---

**SQL Queries to Explore the Data:**

1. **List Available Years in `MIDYEAR_POPULATION`:**

    ```sql
    SELECT DISTINCT "year"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION
    LIMIT 1000;
    ```

2. **List Available Years in `MIDYEAR_POPULATION_AGESPECIFIC`:**

    ```sql
    SELECT DISTINCT "year"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGESPECIFIC
    LIMIT 1000;
    ```

3. **List Distinct Ages in `MIDYEAR_POPULATION_AGESPECIFIC`:**

    ```sql
    SELECT DISTINCT "age"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGESPECIFIC
    ORDER BY "age"
    LIMIT 1000;
    ```

4. **Check Values of the `"sex"` Column in `MIDYEAR_POPULATION_AGESPECIFIC`:**

    ```sql
    SELECT DISTINCT "sex"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGESPECIFIC
    LIMIT 1000;
    ```

5. **List Country Codes and Names in `MIDYEAR_POPULATION`:**

    ```sql
    SELECT DISTINCT "country_code", "country_name"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION
    LIMIT 1000;
    ```

6. **List Country Codes and Names in `MIDYEAR_POPULATION_AGESPECIFIC`:**

    ```sql
    SELECT DISTINCT "country_code", "country_name"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGESPECIFIC
    LIMIT 1000;
    ```

7. **Retrieve Population Data for Ages Under 20 in 2020 from `MIDYEAR_POPULATION_AGESPECIFIC`:**

    ```sql
    SELECT *
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGESPECIFIC
    WHERE "year" = 2020 AND "age" < 20
    LIMIT 1000;
    ```

8. **Retrieve Total Midyear Population for Countries in 2020 from `MIDYEAR_POPULATION`:**

    ```sql
    SELECT "country_code", "country_name", "midyear_population"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION
    WHERE "year" = 2020
    LIMIT 1000;
    ```

9. **Check if `"sex"` Column Has a 'Total' Category in `MIDYEAR_POPULATION_AGESPECIFIC`:**

    ```sql
    SELECT DISTINCT "sex"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGESPECIFIC
    WHERE "year" = 2020
    LIMIT 1000;
    ```

10. **Retrieve Population Data for a Specific Country in 2020 from `MIDYEAR_POPULATION_AGESPECIFIC`:**

    ```sql
    SELECT *
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGESPECIFIC
    WHERE "country_code" = 'COUNTRY_CODE' AND "year" = 2020
    LIMIT 1000;
    ```

11. **List Distinct Starting and Ending Ages in `MIDYEAR_POPULATION_5YR_AGE_SEX`:**

    ```sql
    SELECT DISTINCT "starting_age", "ending_age"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_5YR_AGE_SEX
    ORDER BY "starting_age"
    LIMIT 1000;
    ```

12. **Check Values of `"total_flag"` in `MIDYEAR_POPULATION_5YR_AGE_SEX`:**

    ```sql
    SELECT DISTINCT "total_flag"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_5YR_AGE_SEX
    LIMIT 1000;
    ```

13. **Retrieve Population Data for Age Groups Under 20 in 2020 from `MIDYEAR_POPULATION_5YR_AGE_SEX`:**

    ```sql
    SELECT *
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_5YR_AGE_SEX
    WHERE "year" = 2020 AND "starting_age" < 20
    LIMIT 1000;
    ```

14. **Check Population Counts by Age and Sex in `MIDYEAR_POPULATION_AGE_SEX`:**

    ```sql
    SELECT "country_code", "country_name", "sex", "population_age_0", "population_age_1", "population_age_2"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGE_SEX
    WHERE "year" = 2020
    LIMIT 1000;
    ```

15. **List Distinct Values of `"max_age"` in `MIDYEAR_POPULATION_AGE_SEX`:**

    ```sql
    SELECT DISTINCT "max_age"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGE_SEX
    LIMIT 1000;
    ```

---

**Note:** Replace `'COUNTRY_CODE'` in query 10 with an actual country code (e.g., `'US'` for the United States) to retrieve data for a specific country.

These queries will help in understanding the structure and content of the relevant tables and columns, which is essential before constructing the final query to solve the task.Query:
SELECT DISTINCT "year"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION
    LIMIT 1000;
Answer:
year
1950
1951
1952
1953
1954
1955
1956
1957
1958
1959
1960
1961
1962
1963
1964
1968
1969
1971
1972
1979
1981
1982
1983
1986
1992
1993
1995
1996
1999
2010
2013
2019
2027
2029
2035
1974
1977
1980
1989
2002
2003
2007
2016
2018
2033
2034
2039
2048
2037
1966
1973
1976
1984
1990
1997
2001
2006
2011
2012
2020
2021
2023
2025
2047
2050
1965
1967
1970
1975
1978
1987
1991
1994
1998
2000
2014
2017
2022
2024
2028
2030
2031
2032
2038
2046
2005
2026
2040
2044
2004
1985
2008
2009
2015
2042
2043
2045
1988
2036
2041
2049
Query:
SELECT DISTINCT "year"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGESPECIFIC
    LIMIT 1000;
Answer:
year
2001
2002
2003
2004
2005
2006
2007
2008
2009
2010
2011
2012
2013
2015
2016
2018
2014
2019
2021
2023
2024
2026
2028
2029
2033
2034
2035
2036
2037
2039
2030
2038
2048
1981
1983
1986
1987
1990
1995
1989
1979
1978
1977
1972
1975
1955
1957
1968
1969
2017
2020
2022
2025
2027
2031
2032
2040
2041
2044
2045
2046
2047
1980
1982
1984
1985
1991
1992
1993
1996
1997
1998
2000
1976
1970
1971
1974
1950
1953
1954
1956
1958
1959
1960
1961
1962
1963
1964
1965
2042
2043
2050
1988
1999
1994
1973
1951
1952
1966
1967
2049
Query:
SELECT DISTINCT "age"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGESPECIFIC
    ORDER BY "age"
    LIMIT 1000;
Answer:
age
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
Query:
SELECT DISTINCT "sex"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGESPECIFIC
    LIMIT 1000;
Answer:
sex
Male
Female
Query:
SELECT DISTINCT "country_code", "country_name"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION
    LIMIT 1000;
Answer:
country_code,country_name
AA,Aruba
AC,Antigua and Barbuda
AE,United Arab Emirates
AF,Afghanistan
AG,Algeria
AJ,Azerbaijan
AL,Albania
AM,Armenia
AN,Andorra
AO,Angola
AQ,American Samoa
AR,Argentina
AS,Australia
AU,Austria
AV,Anguilla
BA,Bahrain
BC,Botswana
BB,Barbados
BD,Bermuda
BE,Belgium
BG,Bangladesh
BH,Belize
BK,Bosnia and Herzegovina
BL,Bolivia
BM,Burma
BP,Solomon Islands
BR,Brazil
BY,Burundi
CA,Canada
CB,Cambodia
CD,Chad
CF,Congo (Brazzaville)
CG,Congo (Kinshasa)
CI,Chile
CJ,Cayman Islands
CM,Cameroon
CQ,Northern Mariana Islands
CT,Central African Republic
CU,Cuba
CW,Cook Islands
CY,Cyprus
DA,Denmark
DJ,Djibouti
DR,Dominican Republic
EN,Estonia
GH,Ghana
GJ,Grenada
GY,Guyana
HA,Haiti
HO,Honduras
ID,Indonesia
IS,Israel
KR,Kiribati
KU,Kuwait
MA,Madagascar
MH,Montserrat
PK,Pakistan
MO,Morocco
OD,South Sudan
RI,Serbia
RP,Philippines
TB,Saint Barthelemy
TU,Turkey
BN,Benin
BO,Belarus
BT,Bhutan
BU,Bulgaria
BX,Brunei
BF,"Bahamas, The"
CE,Sri Lanka
CH,China
CN,Comoros
CO,Colombia
CS,Costa Rica
DO,Dominica
EC,Ecuador
EG,Egypt
EI,Ireland
EK,Equatorial Guinea
ER,Eritrea
ES,El Salvador
ET,Ethiopia
EZ,Czechia
FI,Finland
FM,"Micronesia, Federated States of"
FR,France
GG,Georgia
GI,Gibraltar
GK,Guernsey
GL,Greenland
GM,Germany
GQ,Guam
GR,Greece
GT,Guatemala
GV,Guinea
HK,Hong Kong
HR,Croatia
HU,Hungary
IR,Iran
IV,Cote d'Ivoire
IZ,Iraq
JE,Jersey
JO,Jordan
KE,Kenya
KG,Kyrgyzstan
KN,"Korea, North"
KS,"Korea, South"
KV,Kosovo
LA,Laos
LG,Latvia
LS,Liechtenstein
LT,Lesotho
LU,Luxembourg
LY,Libya
MD,Moldova
MG,Mongolia
MJ,Montenegro
MK,Macedonia
MN,Monaco
MR,Mauritania
MX,Mexico
MY,Malaysia
MZ,Mozambique
NI,Nigeria
NO,Norway
NP,Nepal
NR,Nauru
NS,Suriname
PM,Panama
PP,Papua New Guinea
PS,Palau
RO,Romania
RQ,Puerto Rico
SA,Saudi Arabia
SE,Seychelles
SI,Slovenia
SN,Singapore
SO,Somalia
ST,Saint Lucia
SW,Sweden
SY,Syria
SZ,Switzerland
TK,Turks and Caicos Islands
TW,Taiwan
UC,Curacao
UK,United Kingdom
UZ,Uzbekistan
VC,Saint Vincent and the Grenadines
WF,Wallis and Futuna
WZ,Eswatini
CV,Cabo Verde
FO,Faroe Islands
FP,French Polynesia
GA,"Gambia, The"
GB,Gabon
FJ,Fiji
GZ,Gaza Strip
IC,Iceland
IM,Isle of Man
IN,India
JA,Japan
JM,Jamaica
KZ,Kazakhstan
LE,Lebanon
LH,Lithuania
LI,Liberia
LO,Slovakia
MC,Macau
MI,Malawi
ML,Mali
MP,Mauritius
MU,Oman
MV,Maldives
NC,New Caledonia
NG,Niger
NH,Vanuatu
NL,Netherlands
NN,Sint Maarten
NU,Nicaragua
NZ,New Zealand
PA,Paraguay
PL,Poland
PE,Peru
PO,Portugal
PU,Guinea-Bissau
QA,Qatar
RM,Marshall Islands
RN,Saint Martin
RS,Russia
RW,Rwanda
SB,Saint Pierre and Miquelon
SC,Saint Kitts and Nevis
SF,South Africa
SH,"Saint Helena, Ascension, and Tristan da Cunha"
SL,Sierra Leone
SP,Spain
TD,Trinidad and Tobago
TN,Tonga
TO,Togo
TP,Sao Tome and Principe
TS,Tunisia
TT,Timor-Leste
SU,Sudan
TI,Tajikistan
TV,Tuvalu
TZ,Tanzania
UG,Uganda
UP,Ukraine
UV,Burkina Faso
UY,Uruguay
VE,Venezuela
VI,"Virgin Islands, British"
WA,Namibia
WE,West Bank
WI,Western Sahara
YM,Yemen
ZA,Zambia
ZI,Zimbabwe
IT,Italy
MT,Malta
SG,Senegal
SM,San Marino
TH,Thailand
TX,Turkmenistan
US,United States
VM,Vietnam
VQ,"Virgin Islands, U.S."
WS,Samoa
Query:
SELECT DISTINCT "country_code", "country_name"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGESPECIFIC
    LIMIT 1000;
Answer:
country_code,country_name
NR,Nauru
NS,Suriname
NZ,New Zealand
OD,South Sudan
PE,Peru
PK,Pakistan
PL,Poland
PM,Panama
PO,Portugal
PP,Papua New Guinea
PS,Palau
QA,Qatar
RI,Serbia
RM,Marshall Islands
RN,Saint Martin
RO,Romania
RP,Philippines
RQ,Puerto Rico
RS,Russia
RW,Rwanda
SA,Saudi Arabia
SB,Saint Pierre and Miquelon
SC,Saint Kitts and Nevis
SF,South Africa
SH,"Saint Helena, Ascension, and Tristan da Cunha"
SI,Slovenia
SW,Sweden
SY,Syria
SZ,Switzerland
TB,Saint Barthelemy
TD,Trinidad and Tobago
TK,Turks and Caicos Islands
GJ,Grenada
GK,Guernsey
GM,Germany
GQ,Guam
GT,Guatemala
GY,Guyana
HK,Hong Kong
HU,Hungary
ID,Indonesia
IS,Israel
KN,"Korea, North"
LU,Luxembourg
LY,Libya
TU,Turkey
TV,Tuvalu
TZ,Tanzania
UK,United Kingdom
UZ,Uzbekistan
VC,Saint Vincent and the Grenadines
WA,Namibia
WF,Wallis and Futuna
NL,Netherlands
AC,Antigua and Barbuda
AQ,American Samoa
BB,Barbados
BE,Belgium
BH,Belize
BK,Bosnia and Herzegovina
DR,Dominican Republic
CF,Congo (Brazzaville)
DJ,Djibouti
PU,Guinea-Bissau
SE,Seychelles
SG,Senegal
SM,San Marino
SN,Singapore
SP,Spain
ST,Saint Lucia
SU,Sudan
TH,Thailand
TI,Tajikistan
TN,Tonga
GI,Gibraltar
GL,Greenland
GR,Greece
IC,Iceland
IM,Isle of Man
IN,India
JE,Jersey
JO,Jordan
KE,Kenya
KG,Kyrgyzstan
KR,Kiribati
KS,"Korea, South"
KU,Kuwait
KZ,Kazakhstan
LA,Laos
LG,Latvia
LH,Lithuania
LS,Liechtenstein
LT,Lesotho
TO,Togo
TS,Tunisia
TT,Timor-Leste
TW,Taiwan
UC,Curacao
US,United States
UV,Burkina Faso
VE,Venezuela
VI,"Virgin Islands, British"
VQ,"Virgin Islands, U.S."
WZ,Eswatini
ZA,Zambia
ZI,Zimbabwe
MG,Mongolia
MH,Montserrat
MJ,Montenegro
MK,Macedonia
ML,Mali
MN,Monaco
MO,Morocco
MR,Mauritania
MY,Malaysia
MZ,Mozambique
NG,Niger
NO,Norway
AA,Aruba
AE,United Arab Emirates
AF,Afghanistan
AL,Albania
AN,Andorra
AU,Austria
AV,Anguilla
BA,Bahrain
BC,Botswana
BD,Bermuda
BF,"Bahamas, The"
BG,Bangladesh
BL,Bolivia
BO,Belarus
BP,Solomon Islands
BX,Brunei
BY,Burundi
CD,Chad
CE,Sri Lanka
CI,Chile
CJ,Cayman Islands
CW,Cook Islands
CY,Cyprus
EI,Ireland
EN,Estonia
ER,Eritrea
ET,Ethiopia
FI,Finland
CT,Central African Republic
GH,Ghana
GV,Guinea
MA,Madagascar
NU,Nicaragua
GG,Georgia
GZ,Gaza Strip
HR,Croatia
IR,Iran
IZ,Iraq
JA,Japan
JM,Jamaica
KV,Kosovo
LO,Slovakia
TP,Sao Tome and Principe
TX,Turkmenistan
UP,Ukraine
UY,Uruguay
VM,Vietnam
WE,West Bank
MC,Macau
MD,Moldova
MI,Malawi
MP,Mauritius
MT,Malta
MU,Oman
MV,Maldives
MX,Mexico
NC,New Caledonia
NH,Vanuatu
NN,Sint Maarten
AG,Algeria
AJ,Azerbaijan
AM,Armenia
AR,Argentina
AS,Australia
BN,Benin
BU,Bulgaria
CA,Canada
CM,Cameroon
CN,Comoros
CQ,Northern Mariana Islands
CS,Costa Rica
CU,Cuba
CV,Cabo Verde
DA,Denmark
DO,Dominica
EC,Ecuador
EG,Egypt
EK,Equatorial Guinea
ES,El Salvador
EZ,Czechia
FM,"Micronesia, Federated States of"
FP,French Polynesia
FR,France
GB,Gabon
AO,Angola
BM,Burma
BT,Bhutan
CB,Cambodia
CG,Congo (Kinshasa)
CO,Colombia
HO,Honduras
IV,Cote d'Ivoire
NI,Nigeria
NP,Nepal
PA,Paraguay
SL,Sierra Leone
SO,Somalia
WI,Western Sahara
IT,Italy
WS,Samoa
YM,Yemen
CH,China
FJ,Fiji
GA,"Gambia, The"
HA,Haiti
LE,Lebanon
LI,Liberia
UG,Uganda
FO,Faroe Islands
BR,Brazil
Query:
SELECT *
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGESPECIFIC
    WHERE "year" = 2020 AND "age" < 20
    LIMIT 1000;
Answer:
Too long, hard cut:
country_code,country_name,year,sex,population,age
NR,Nauru,2020,Male,96,0
NR,Nauru,2020,Male,94,1
NR,Nauru,2020,Male,94,2
NR,Nauru,2020,Male,97,3
NR,Nauru,2020,Male,95,4
NR,Nauru,2020,Male,96,5
NR,Nauru,2020,Male,95,6
NR,Nauru,2020,Male,96,7
NR,Nauru,2020,Male,94,8
NR,Nauru,2020,Male,95,9
NR,Nauru,2020,Male,92,10
NR,Nauru,2020,Male,91,11
NR,Nauru,2020,Male,87,12
NR,Nauru,2020,Male,83,13
NR,Nauru,2020,Male,32,14
NR,Nauru,2020,Male,61,15
NR,Nauru,2020,Male,57,16
NR,Nauru,2020,Male,67,17
NR,Nauru,2020,Male,78,18
NR,Nauru,2020,Male,89,19
NS,Suriname,2020,Male,4584,0
NS,Suriname,2020,Male,4611,1
NS,Suriname,2020,Male,4633,2
NS,Suriname,2020,Male,4645,3
NS,Suriname,2020,Male,4668,4
NS,Suriname,2020,Male,4710,5
NS,Suriname,2020,Male,4756,6
NS,Suriname,2020,Male,4795,7
NS,Suriname,2020,Male,4825,8
NS,Suriname,2020,Male,4851,9
NS,Suriname,2020,Male,4950,10
NS,Suriname,2020,Male,5119,11
NS,Suriname,2020,Male,5289,12
NS,Suriname,2020,Male,5256,13
NS,Suriname,2020,Male,4950,14
NS,Suriname,2020,Male,4884,15
NS,Suriname,2020,Male,5092,16
NS,Suriname,2020,Male,5405,17
NS,Suriname,2020,Male,5479,18
NS,Suriname,2020,Male,5358,19
NZ,New Zealand,2020,Male,30387,0
NZ,New Zealand,2020,Male,30367,1
NZ,New Zealand,2020,Male,30432,2
NZ,New Zealand,2020,Male,30471,3
NZ,New Zealand,2020,Male,30449,4
NZ,New Zealand,2020,Male,30421,5
NZ,New Zealand,2020,Male,30418,6
NZ,New Zealand,2020,Male,30458,7
NZ,New Zealand,2020,Male,30523,8
NZ,New Zealand,2020,Male,30600,9
NZ,New Zealand,2020,Male,30721,10
NZ,New Zealand,2020,Male,30841,11
NZ,New Zealand,2020,Male,30982,12
NZ,New Zealand,2020,Male,31161,13
NZ,New Zealand,2020,Male,30948,14
NZ,New Zealand,2020,Male,30781,15
NZ,New Zealand,2020,Male,30698,16
NZ,New Zealand,2020,Male,29923,17
NZ,New Zealand,2020,Male,29914,18
NZ,New Zealand,2020,Male,31045,19
OD,South Sudan,2020,Male,196634,0
OD,South Sudan,2020,Male,181688,1
OD,South Sudan,2020,Male,167036,2
OD,South Sudan,2020,Male,156650,3
OD,South Sudan,2020,Male,146822,4
OD,South Sudan,2020,Male,150359,5
OD,South Sudan,2020,Male,153801,6
OD,South Sudan,2020,Male,152786,7
OD,South Sudan,2020,Male,145386,8
OD,South Sudan,2020,Male,138287,9
OD,South Sudan,2020,Male,134867,10
OD,South Sudan,2020,Male,129623,11
OD,South Sudan,2020,Male,128956,12
OD,South Sudan,2020,Male,128189,13
OD,South Sudan,2020,Male,127450,14
OD,South Sudan,2020,Male,125067,15
OD,South Sudan,2020,Male,124483,16
OD,South Sudan,2020,Male,123422,17
OD,South Sudan,2020,Male,123567,18
OD,South Sudan,2020,Male,122257,19
PE,Peru,2020,Male,273591,0
PE,Peru,2020,Male,274123,1
PE,Peru,2020,Male,274702,2
PE,Peru,2020,Male,275056,3
PE,Peru,2020,Male,275165,4
PE,Peru,2020,Male,275559,5
PE,Peru,2020,Male,276247,6
PE,Peru,2020,Male,276753,7
PE,Peru,2020,Male,277093,8
PE,Peru,2020,Male,277263,9
PE,Peru,2020,Male,276987,10
PE,Peru,2020,Male,276270,11
PE,Peru,2020,Male,275411,12
PE,Peru,2020,Male,274435,13
PE,Peru,2020,Male,273330,14
PE,Peru,2020,Male,272076,15
PE,Peru,2020,Male,271771,16
PE,Peru,2020,Male,272262,17
PE,Peru,2020,Male,272292,18
PE,Peru,2020,Male,271916,19
PK,Pakistan,2020,Male,2187767,0
PK,Pakistan,2020,Male,2160346,1
PK,Pakistan,2020,Male,2151300,2
PK,Pakistan,2020,Male,2142941,3
PK,Pakistan,2020,Male,2131889,4
PK,Pakistan,2020,Male,2133370,5
PK,Pakistan,2020,Male,2146795,6
PK,Pakistan,2020,Male,2155138,7
PK,Pakistan,2020,Male,2158706,8
PK,Pakistan,2020,Male,2157865,9
PK,Pakistan,2020,Male,2167883,10
PK,Pakistan,2020,Male,2188779,11
PK,Pakistan,2020,Male,2205219,12
PK,Pakistan,2020,Male,2216227,13
PK,Pakistan,2020,Male,2223357,14
PK,Pakistan,2020,Male,2237008,15
PK,Pakistan,2020,Male,2258962,16
PK,Pakistan,2020,Male,2274813,17
PK,Pakistan,2020,Male,2279317,18
PK,Pakistan,2020,Male,2278105,19
PL,Poland,2020,Male,176979,0
PL,Poland,2020,Male,180941,1
PL,Poland,2020,Male,184762,2
PL,Poland,2020,Male,188335,3
PL,Poland,2020,Male,191564,4
PL,Poland,2020,Male,194253,5
PL,Poland,2020,Male,196305,6
PL,Poland,2020,Male,197710,7
PL,Poland,2020,Male,198566,8
PL,Poland,2020,Male,205984,9
PL,Poland,2020,Male,212946,10
PL,Poland,2020,Male,211665,11
PL,Poland,2020,Male,203440,12
PL,Poland,2020,Male,190528,13
PL,Poland,2020,Male,184540,14
PL,Poland,2020,Male,182428,15
PL,Poland,2020,Male,179105,16
PL,Poland,2020,Male,178506,17
PL,Poland,2020,Male,182827,18
PL,Poland,2020,Male,188871,19
PM,Panama,2020,Male,33690,0
PM,Panama,2020,Male,33740,1
PM,Panama,2020,Male,33772,2
PM,Panama,2020,Male,33770,3
PM,Panama,2020,Male,33745,4
PM,Panama,2020,Male,33750,5
PM,Panama,2020,Male,33797,6
PM,Panama,2020,Male,33800,7
PM,Panama,2020,Male,33749,8
PM,Panama,2020,Male,33693,9
PM,Panama,2020,Male,33801,10
PM,Panama,2020,Male,34054,11
PM,Panama,2020,Male,34287,12
PM,Panama,2020,Male,34490,13
PM,Panama,2020,Male,33993,14
PM,Panama,2020,Male,33135,15
PM,Panama,2020,Male,32588,16
PM,Panama,2020,Male,32260,17
PM,Panama,2020,Male,32748,18
PM,Panama,2020,Male,33485,19
PO,Portugal,2020,Male,42564,0
PO,Portugal,2020,Male,43022,1
PO,Portugal,2020,Male,43600,2
PO,Portugal,2020,Male,44258,3
PO,Portugal,2020,Male,44050,4

Query:
SELECT "country_code", "country_name", "midyear_population"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION
    WHERE "year" = 2020
    LIMIT 1000;
Answer:
country_code,country_name,midyear_population
AA,Aruba,119428
AC,Antigua and Barbuda,98179
AE,United Arab Emirates,9992083
AF,Afghanistan,36643815
AG,Algeria,42972878
AJ,Azerbaijan,10205810
AL,Albania,3074579
AM,Armenia,3021324
AN,Andorra,85635
AO,Angola,32522339
AQ,American Samoa,49437
AR,Argentina,45479118
AS,Australia,23938599
AU,Austria,8859449
AV,Anguilla,18090
BA,Bahrain,1505003
BB,Barbados,294560
BC,Botswana,2317233
BD,Bermuda,71750
BE,Belgium,11720716
BF,"Bahamas, The",337721
BG,Bangladesh,162650853
BH,Belize,399598
BK,Bosnia and Herzegovina,3835586
BL,Bolivia,11639909
BM,Burma,56590071
BN,Benin,11956340
BO,Belarus,9477918
BP,Solomon Islands,685097
BR,Brazil,211715973
BT,Bhutan,782318
BU,Bulgaria,6966899
BX,Brunei,464478
BY,Burundi,12631974
CA,Canada,36387359
CB,Cambodia,16926984
CD,Chad,16877357
CE,Sri Lanka,22889201
CF,Congo (Brazzaville),5293070
CG,Congo (Kinshasa),89249735
CH,China,1394015977
CI,Chile,18186770
CJ,Cayman Islands,61944
CM,Cameroon,26969408
CN,Comoros,846281
CO,Colombia,49084841
CQ,Northern Mariana Islands,51433
CS,Costa Rica,5097988
CT,Central African Republic,5990855
CU,Cuba,11059062
CV,Cabo Verde,583255
CW,Cook Islands,8574
CY,Cyprus,1266676
DA,Denmark,5869410
DJ,Djibouti,921804
DO,Dominica,74243
DR,Dominican Republic,10499707
EC,Ecuador,16904867
EG,Egypt,104124440
EI,Ireland,5176569
EK,Equatorial Guinea,836178
EN,Estonia,1228624
ER,Eritrea,6081196
ES,El Salvador,6217074
ET,Ethiopia,114640234
EZ,Czechia,10702498
FI,Finland,5571665
FJ,Fiji,935974
FM,"Micronesia, Federated States of",102436
FO,Faroe Islands,51628
FP,French Polynesia,295121
FR,France,67848156
GA,"Gambia, The",2173999
GB,Gabon,2230908
GG,Georgia,4930030
GH,Ghana,29340248
GI,Gibraltar,29581
GJ,Grenada,113094
GK,Guernsey,67052
GL,Greenland,57616
GM,Germany,80159662
GQ,Guam,168485
GR,Greece,10742032
GT,Guatemala,17153288
GV,Guinea,12527440
GY,Guyana,750204
GZ,Gaza Strip,1918221
HA,Haiti,11067777
HK,Hong Kong,7249907
HO,Honduras,9465127
HR,Croatia,4227746
HU,Hungary,9771827
IC,Iceland,350734
ID,Indonesia,267026366
IM,Isle of Man,90499
IN,India,1326093247
IR,Iran,84923314
IS,Israel,8675475
IT,Italy,62402659
IV,Cote d'Ivoire,27481086
IZ,Iraq,42212862
JA,Japan,125507472
JE,Jersey,101073
JM,Jamaica,2808570
JO,Jordan,10820644
KE,Kenya,49858045
KG,Kyrgyzstan,5964897
KN,"Korea, North",25643466
KR,Kiribati,111796
KS,"Korea, South",51835110
KU,Kuwait,2993706
KV,Kosovo,1932774
KZ,Kazakhstan,19091949
LA,Laos,7447396
LE,Lebanon,5469612
LG,Latvia,1881232
LH,Lithuania,2731464
LI,Liberia,5073296
LO,Slovakia,5440602
LS,Liechtenstein,39137
LT,Lesotho,1969334
LU,Luxembourg,628381
LY,Libya,6942544
MA,Madagascar,26955737
MC,Macau,614458
MD,Moldova,3364496
MG,Mongolia,3168026
MH,Montserrat,5373
MI,Malawi,21196629
MJ,Montenegro,609859
MK,Macedonia,2125971
ML,Mali,19553397
MN,Monaco,30940
MO,Morocco,34955862
MP,Mauritius,1379365
MR,Mauritania,4005475
MT,Malta,457267
MU,Oman,3634689
MV,Maldives,391904
MX,Mexico,128649565
MY,Malaysia,32652083
MZ,Mozambique,28603070
NC,New Caledonia,290009
NG,Niger,21151442
NH,Vanuatu,298333
NI,Nigeria,214028302
NL,Netherlands,17280397
NN,Sint Maarten,43847
NO,Norway,5467439
NP,Nepal,30327877
NR,Nauru,9785
NS,Suriname,609569
NU,Nicaragua,6203441
NZ,New Zealand,4614669
OD,South Sudan,10561244
PA,Paraguay,7191685
PE,Peru,31914989
PK,Pakistan,213719471
PL,Poland,38282325
PM,Panama,3894082
PO,Portugal,10302674
PP,Papua New Guinea,7259456
PS,Palau,21685
PU,Guinea-Bissau,1927104
QA,Qatar,2444174
RI,Serbia,7012165
RM,Marshall Islands,77917
RN,Saint Martin,32556
RO,Romania,21302893
RP,Philippines,109180815
RQ,Puerto Rico,3189068
RS,Russia,141722205
RW,Rwanda,12712431
SA,Saudi Arabia,34173498
SB,Saint Pierre and Miquelon,5347
SC,Saint Kitts and Nevis,53821
SE,Seychelles,95981
SF,South Africa,56463617
SG,Senegal,15736368
SH,"Saint Helena, Ascension, and Tristan da Cunha",7862
SI,Slovenia,2102678
SL,Sierra Leone,6624933
SM,San Marino,34232
SN,Singapore,6209660
SO,Somalia,11757124
SP,Spain,50015792
ST,Saint Lucia,166487
SU,Sudan,45561556
SW,Sweden,10202491
SY,Syria,22346237
SZ,Switzerland,8403994
TB,Saint Barthelemy,7122
TD,Trinidad and Tobago,1208789
TH,Thailand,68977400
TI,Tajikistan,8873669
TK,Turks and Caicos Islands,55926
TN,Tonga,106095
TO,Togo,8608444
TP,Sao Tome and Principe,211122
TS,Tunisia,11721177
TT,Timor-Leste,1383723
TU,Turkey,82017514
TV,Tuvalu,11342
TW,Taiwan,23603049
TX,Turkmenistan,5528627
TZ,Tanzania,58552845
UC,Curacao,151345
UG,Uganda,43517666
UK,United Kingdom,65761117
UP,Ukraine,43922939
US,United States,334503458
UV,Burkina Faso,20835401
UY,Uruguay,3387605
UZ,Uzbekistan,30565411
VC,Saint Vincent and the Grenadines,101390
VE,Venezuela,32442058
VI,"Virgin Islands, British",37381
VM,Vietnam,98721275
VQ,"Virgin Islands, U.S.",106235
WA,Namibia,2630073
WE,West Bank,2900034
WF,Wallis and Futuna,15854
WI,Western Sahara,652271
WS,Samoa,203774
WZ,Eswatini,1104479
YM,Yemen,29884405
ZA,Zambia,17426623
ZI,Zimbabwe,14546314
Query:
SELECT DISTINCT "sex"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGESPECIFIC
    WHERE "year" = 2020
    LIMIT 1000;
Answer:
sex
Male
Female
Query:
SELECT
    mp."country_name",
    SUM(mpa."population") AS total_population_under_20,
    mp."midyear_population" AS total_midyear_population,
    (SUM(mpa."population") / mp."midyear_population") * 100 AS percentage_under_20
FROM
    CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGESPECIFIC mpa
JOIN
    CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION mp
ON
    mpa."country_code" = mp."country_code" AND mpa."year" = mp."year"
WHERE
    mpa."year" = 2020 AND mpa."age" < 20
GROUP BY
    mp."country_name", mp."midyear_population"
ORDER BY
    percentage_under_20 DESC
LIMIT 10;
Answer:
country_name,TOTAL_POPULATION_UNDER_20,TOTAL_MIDYEAR_POPULATION,PERCENTAGE_UNDER_20
Niger,12498275,21151442,59.089500
Uganda,25564420,43517666,58.744900
Chad,9890342,16877357,58.601200
Mali,11408590,19553397,58.345800
Angola,18948312,32522339,58.262500
Malawi,12065049,21196629,56.919700
Zambia,9860261,17426623,56.581600
Burundi,7045417,12631974,55.774500
Mozambique,15917856,28603070,55.650900
Burkina Faso,11437351,20835401,54.893800
Query:
SELECT DISTINCT "starting_age", "ending_age"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_5YR_AGE_SEX
    ORDER BY "starting_age"
    LIMIT 1000;
Answer:
starting_age,ending_age
0,0
0,4
5,9
10,14
15,19
20,24
25,29
30,34
35,39
40,44
45,49
50,54
55,59
60,64
65,69
70,74
75,79
80,84
85,89
90,94
95,99
100,0
Query:
SELECT DISTINCT "total_flag"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_5YR_AGE_SEX
    LIMIT 1000;
Answer:
total_flag
*
A
Query:
SELECT *
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_5YR_AGE_SEX
    WHERE "year" = 2020 AND "starting_age" < 20
    LIMIT 1000;
Answer:
Too long, hard cut:
country_code,country_name,year,total_flag,starting_age,age_group_indicator,ending_age,midyear_population,midyear_population_male,midyear_population_female
AA,Aruba,2020,*,0,+,0,119428,56491,62937
AC,Antigua and Barbuda,2020,*,0,+,0,98179,46320,51859
AE,United Arab Emirates,2020,*,0,+,0,9992083,7186974,2805109
AF,Afghanistan,2020,*,0,+,0,36643815,18557871,18085944
AG,Algeria,2020,*,0,+,0,42972878,21770912,21201966
AJ,Azerbaijan,2020,*,0,+,0,10205810,5061260,5144550
AL,Albania,2020,*,0,+,0,3074579,1518421,1556158
AM,Armenia,2020,*,0,+,0,3021324,1470550,1550774
AN,Andorra,2020,*,0,+,0,85635,43960,41675
AO,Angola,2020,*,0,+,0,32522339,15846967,16675372
AQ,American Samoa,2020,*,0,+,0,49437,24669,24768
AR,Argentina,2020,*,0,+,0,45479118,22506182,22972936
AS,Australia,2020,*,0,+,0,23938599,12004390,11934209
AU,Austria,2020,*,0,+,0,8859449,4338457,4520992
AV,Anguilla,2020,*,0,+,0,18090,8555,9535
BA,Bahrain,2020,*,0,+,0,1505003,911044,593959
BB,Barbados,2020,*,0,+,0,294560,142372,152188
BC,Botswana,2020,*,0,+,0,2317233,1113254,1203979
BD,Bermuda,2020,*,0,+,0,71750,34693,37057
BE,Belgium,2020,*,0,+,0,11720716,5776934,5943782
BF,"Bahamas, The",2020,*,0,+,0,337721,165549,172172
BG,Bangladesh,2020,*,0,+,0,162650853,79959419,82691434
BH,Belize,2020,*,0,+,0,399598,200148,199450
BK,Bosnia and Herzegovina,2020,*,0,+,0,3835586,1869297,1966289
BL,Bolivia,2020,*,0,+,0,11639909,5759719,5880190
BM,Burma,2020,*,0,+,0,56590071,27908385,28681686
BN,Benin,2020,*,0,+,0,11956340,6018154,5938186
BO,Belarus,2020,*,0,+,0,9477918,4408657,5069261
BP,Solomon Islands,2020,*,0,+,0,685097,349817,335280
BR,Brazil,2020,*,0,+,0,211715973,104241576,107474397
BT,Bhutan,2020,*,0,+,0,782318,406892,375426
BU,Bulgaria,2020,*,0,+,0,6966899,3395545,3571354
BX,Brunei,2020,*,0,+,0,464478,227530,236948
BY,Burundi,2020,*,0,+,0,12631974,6293246,6338728
CA,Canada,2020,*,0,+,0,36387359,18039233,18348126
CB,Cambodia,2020,*,0,+,0,16926984,8240844,8686140
CD,Chad,2020,*,0,+,0,16877357,8351473,8525884
CE,Sri Lanka,2020,*,0,+,0,22889201,11172459,11716742
CF,Congo (Brazzaville),2020,*,0,+,0,5293070,2653336,2639734
CG,Congo (Kinshasa),2020,*,0,+,0,89249735,44535192,44714543
CH,China,2020,*,0,+,0,1394015977,715630046,678385931
CI,Chile,2020,*,0,+,0,18186770,8938796,9247974
CJ,Cayman Islands,2020,*,0,+,0,61944,30148,31796
CM,Cameroon,2020,*,0,+,0,26969408,13518253,13451155
CN,Comoros,2020,*,0,+,0,846281,409219,437062
CO,Colombia,2020,*,0,+,0,49084841,24255454,24829387
CQ,Northern Mariana Islands,2020,*,0,+,0,51433,27298,24135
CS,Costa Rica,2020,*,0,+,0,5097988,2554050,2543938
CT,Central African Republic,2020,*,0,+,0,5990855,2977238,3013617
CU,Cuba,2020,*,0,+,0,11059062,5498768,5560294
CV,Cabo Verde,2020,*,0,+,0,583255,283318,299937
CW,Cook Islands,2020,*,0,+,0,8574,4409,4165
CY,Cyprus,2020,*,0,+,0,1266676,647166,619510
DA,Denmark,2020,*,0,+,0,5869410,2923788,2945622
DJ,Djibouti,2020,*,0,+,0,921804,419229,502575
DO,Dominica,2020,*,0,+,0,74243,37502,36741
DR,Dominican Republic,2020,*,0,+,0,10499707,5308983,5190724
EC,Ecuador,2020,*,0,+,0,16904867,8387914,8516953
EG,Egypt,2020,*,0,+,0,104124440,53203274,50921166
EI,Ireland,2020,*,0,+,0,5176569,2585243,2591326
EK,Equatorial Guinea,2020,*,0,+,0,836178,417585,418593
EN,Estonia,2020,*,0,+,0,1228624,576410,652214
ER,Eritrea,2020,*,0,+,0,6081196,2993644,3087552
ES,El Salvador,2020,*,0,+,0,6217074,2984204,3232870
ET,Ethiopia,2020,*,0,+,0,114640234,56928264,57711970
EZ,Czechia,2020,*,0,+,0,10702498,5269287,5433211
FI,Finland,2020,*,0,+,0,5571665,2744743,2826922
FJ,Fiji,2020,*,0,+,0,935974,474793,461181
FM,"Micronesia, Federated States of",2020,*,0,+,0,102436,50361,52075
FO,Faroe Islands,2020,*,0,+,0,51628,26783,24845
FP,French Polynesia,2020,*,0,+,0,295121,150945,144176
FR,France,2020,*,0,+,0,67848156,33226264,34621892
GA,"Gambia, The",2020,*,0,+,0,2173999,1073546,1100453
GB,Gabon,2020,*,0,+,0,2230908,1158764,1072144
GG,Georgia,2020,*,0,+,0,4930030,2359060,2570970
GH,Ghana,2020,*,0,+,0,29340248,14460542,14879706
GI,Gibraltar,2020,*,0,+,0,29581,14829,14752
GJ,Grenada,2020,*,0,+,0,113094,57355,55739
GK,Guernsey,2020,*,0,+,0,67052,33309,33743
GL,Greenland,2020,*,0,+,0,57616,29958,27658
GM,Germany,2020,*,0,+,0,80159662,39315349,40844313
GQ,Guam,2020,*,0,+,0,168485,86733,81752
GR,Greece,2020,*,0,+,0,10742032,5234464,5507568
GT,Guatemala,2020,*,0,+,0,17153288,8510685,8642603
GV,Guinea,2020,*,0,+,0,12527440,6256267,6271173
GY,Guyana,2020,*,0,+,0,750204,378146,372058
GZ,Gaza Strip,2020,*,0,+,0,1918221,968624,949597
HA,Haiti,2020,*,0,+,0,11067777,5466449,5601328
HK,Hong Kong,2020,*,0,+,0,7249907,3361342,3888565
HO,Honduras,2020,*,0,+,0,9465127,4768364,4696763
HR,Croatia,2020,*,0,+,0,4227746,2039258,2188488
HU,Hungary,2020,*,0,+,0,9771827,4660271,5111556
IC,Iceland,2020,*,0,+,0,350734,175677,175057
ID,Indonesia,2020,*,0,+,0,267026366,133643347,133383019
IM,Isle of Man,2020,*,0,+,0,90499,45403,45096
IN,India,2020,*,0,+,0,1326093247,688215563,637877684
IR,Iran,2020,*,0,+,0,84923314,43050667,41872647
IS,Israel,2020,*,0,+,0,8675475,4361465,4314
Query:
SELECT "country_code", "country_name", "sex", "population_age_0", "population_age_1", "population_age_2"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGE_SEX
    WHERE "year" = 2020
    LIMIT 1000;
Answer:
Too long, hard cut:
country_code,country_name,sex,population_age_0,population_age_1,population_age_2
AA,Aruba,Male,720,720,716
AA,Aruba,Female,710,710,710
AC,Antigua and Barbuda,Male,767,766,765
AC,Antigua and Barbuda,Female,733,733,732
AE,United Arab Emirates,Male,48917,49999,51018
AE,United Arab Emirates,Female,46286,47471,48598
AF,Afghanistan,Male,631283,590431,569228
AF,Afghanistan,Female,608877,571631,551135
AG,Algeria,Male,437515,445066,452500
AG,Algeria,Female,416875,424157,431128
AJ,Azerbaijan,Male,75405,77103,78878
AJ,Azerbaijan,Female,70994,71885,72835
AL,Albania,Male,20602,20611,20558
AL,Albania,Female,19087,19017,18892
AM,Armenia,Male,18761,19208,19609
AM,Armenia,Female,17120,17424,17685
AN,Andorra,Male,310,317,326
AN,Andorra,Female,291,298,305
AO,Angola,Male,660500,629185,606737
AO,Angola,Female,646300,619198,598705
AQ,American Samoa,Male,451,455,460
AQ,American Samoa,Female,426,431,435
AR,Argentina,Male,373421,374765,376335
AR,Argentina,Female,350922,352258,353783
AS,Australia,Male,146041,145824,145527
AS,Australia,Female,138505,138301,138022
AU,Austria,Male,43096,43154,43139
AU,Austria,Female,40960,41025,41020
AV,Anguilla,Male,125,137,137
AV,Anguilla,Female,120,130,132
BA,Bahrain,Male,9588,9585,9565
BA,Bahrain,Female,9353,9349,9333
BB,Barbados,Male,1665,1673,1682
BB,Barbados,Female,1650,1660,1670
BC,Botswana,Male,24031,23984,23970
BC,Botswana,Female,23434,23409,23406
BD,Bermuda,Male,405,406,404
BD,Bermuda,Female,398,398,399
BE,Belgium,Male,66858,67344,67772
BE,Belgium,Female,63773,64226,64622
BF,"Bahamas, The",Male,2515,2519,2520
BF,"Bahamas, The",Female,2442,2446,2448
BG,Bangladesh,Male,1465727,1458492,1453988
BG,Bangladesh,Female,1414944,1409341,1405349
BH,Belize,Male,4456,4454,4458
BH,Belize,Female,4254,4255,4261
BK,Bosnia and Herzegovina,Male,17040,17201,17336
BK,Bosnia and Herzegovina,Female,15899,16050,16177
BL,Bolivia,Male,120629,119896,119784
BL,Bolivia,Female,115477,115018,114949
BM,Burma,Male,483056,484850,488353
BM,Burma,Female,457897,460170,463532
BN,Benin,Male,195933,189880,185751
BN,Benin,Female,187431,182014,178096
BO,Belarus,Male,47004,48305,49619
BO,Belarus,Female,44377,45609,46856
BP,Solomon Islands,Male,8128,8031,7957
BP,Solomon Islands,Female,7744,7625,7532
BR,Brazil,Male,1451503,1455327,1460979
BR,Brazil,Female,1389711,1395083,1401298
BT,Bhutan,Male,6421,6422,6441
BT,Bhutan,Female,6117,6117,6138
BU,Bulgaria,Male,29744,30363,30971
BU,Bulgaria,Female,28060,28648,29228
BX,Brunei,Male,3870,3836,3799
BX,Brunei,Female,3700,3660,3611
BY,Burundi,Male,242843,232238,224221
BY,Burundi,Female,237877,228476,220683
CA,Canada,Male,188828,189456,189892
CA,Canada,Female,179031,179954,180695
CB,Cambodia,Male,178385,177626,177458
CB,Cambodia,Female,172283,172421,172593
CD,Chad,Male,335946,320036,308761
CD,Chad,Female,325657,311867,301103
CE,Sri Lanka,Male,165707,167704,169835
CE,Sri Lanka,Female,159595,161504,163526
CF,Congo (Brazzaville),Male,83218,81097,79785
CF,Congo (Brazzaville),Female,81366,79495,78196
CG,Congo (Kinshasa),Male,1344639,1308647,1285409
CG,Congo (Kinshasa),Female,1312359,1281776,1261550
CH,China,Male,8535239,8695128,8824913
CH,China,Female,7649472,7747703,7814760
CI,Chile,Male,121259,121758,122179
CI,Chile,Female,116419,116910,117325
CJ,Cayman Islands,Male,378,388,385
CJ,Cayman Islands,Female,372,381,378
CM,Cameroon,Male,445204,430721,418475
CM,Cameroon,Female,434671,421699,410437
CN,Comoros,Male,9742,9673,9732
CN,Comoros,Female,9591,9612,9701
CO,Colombia,Male,384246,385064,385802
CO,Colombia,Female,364285,365370,366218
CQ,Northern Mariana Islands,Male,410,404,400
CQ,Northern Mariana Islands,Female,353,348,344
CS,Costa Rica,Male,38461,38648,38815
CS,Costa Rica,Female,36682,36869,37031
CT,Central African Republic,Male,94218,89761,87430
CT,Central African Republic,Female,92571,88592,86370
CU,Cuba,Male,59271,60051,60782
CU,Cuba,Female,55967,56710,57405
CV,Cabo Verde,Male,5551,5511,5467
CV,Cabo Verde,Female,5420,5394,5358
CW,Cook Islands,Male,58,57,58
CW,Cook Islands,Female,55,54,54
CY,Cyprus,Male,7045,7064,7076
CY,Cyprus,Female,6726,6743,6747
DA,Denmark,Male,33332,33048,32798
DA,Denmark,Female,31331,31099,30893
DJ,Djibouti,Male,10208,9953,9767
DJ,Djibouti,Female,10000,9804,9638
DO,Dominica,Male,548,553,556
DO,Dominica,Female,524,529,531
DR,Dominican Republic,Male,96797,96386,96052
DR,Dominican Republic,Female,93432,93074,92754
EC,Ecuador,Male,145510,145824,146233
EC,Ecuador,Female,139290,139744,140198
EG,Egypt,Male,1428011,1407238,1392536
EG,Egypt,Female,1344028,1323272,1307850
EI,Ireland,Male,34832,35508,36173
EI,Ireland,Female,32989,33657,34318
EK,Equatorial Guinea,Male,12393,11995,11774
EK,Equatorial Guinea,Female,12061,11665,11433
EN,Estonia,Male,5928,6106,6272
EN,Estonia,Female,5659,5833,5997
ER,Eritrea,Male,82518,80973,79711
ER,Eritrea,Female,80941,79723,78545
ES,El Salvador,Male,49330,49367,49417
ES,El Salvador,Female,47115,47102,47086
ET,Ethiopia,Male,1945938,1881410,1832627
ET,Ethiopia,Female,1908975,1855078,1809787
EZ,Czechia,Male,49247,50204,51140
EZ,Czechia,Female,46672,47528,48367
Query:
SELECT DISTINCT "max_age"
    FROM CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL.MIDYEAR_POPULATION_AGE_SEX
    LIMIT 1000;
Answer:
max_age
100
97
99
96
95
94
93
92
91
90
89
87
88
84
80
83
85
98
81
86
82
End Exploring Related Columns
Task: Provide a list of the top 10 countries for the year 2020, ordered by the highest percentage of their population under 20 years old. For each country, include the total population under 20 years old, the total midyear population, and the percentage of the population that is under 20 years old.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: SELECT S."Column_Name" FROM {Database Name}.{Schema Name}.{Table_name} (ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
country_name,total_population_under_20,total_midyear_population,percentage_under_20
country1:str,pop_under20:int,pop_total:int,percentage:0<=float<=100
country2:str,pop_under20:int,pop_total:int,percentage:0<=float<=100
country3:str,pop_under20:int,pop_total:int,percentage:0<=float<=100
country4:str,pop_under20:int,pop_total:int,percentage:0<=float<=100
country5:str,pop_under20:int,pop_total:int,percentage:0<=float<=100
country6:str,pop_under20:int,pop_total:int,percentage:0<=float<=100
country7:str,pop_under20:int,pop_total:int,percentage:0<=float<=100
country8:str,pop_under20:int,pop_total:int,percentage:0<=float<=100
country9:str,pop_under20:int,pop_total:int,percentage:0<=float<=100
country10:str,pop_under20:int,pop_total:int,percentage:0<=float<=100
```

**Explanation:**

The table above lists the top 10 countries for the year 2020 ordered by the highest percentage of their population under 20 years old. For each country, it includes:
- `country_name`: The name of the country.
- `total_population_under_20`: The total number of people under 20 years old.
- `total_midyear_population`: The total midyear population.
- `percentage_under_20`: The percentage of the population that is under 20 years old (a value between 0 and 100)..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'CENSUS_BUREAU_INTERNATIONAL': {'CENSUS_BUREAU_INTERNATIONAL': ['AGE_SPECIFIC_FERTILITY_RATES', 'BIRTH_DEATH_GROWTH_RATES', 'COUNTRY_NAMES_AREA', 'MIDYEAR_POPULATION', 'MIDYEAR_POPULATION_5YR_AGE_SEX', 'MIDYEAR_POPULATION_AGESPECIFIC', 'MIDYEAR_POPULATION_AGE_SEX', 'MORTALITY_LIFE_EXPECTANCY']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-18 21:55:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 21:55:38 - root - INFO - ```sql
SELECT
    mp."country_name",
    SUM(mpa."population") AS total_population_under_20,
    mp."midyear_population" AS total_midyear_population,
    ROUND((SUM(mpa."population") / mp."midyear_population") * 100, 4) AS percentage_under_20
FROM
    CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL."MIDYEAR_POPULATION_AGESPECIFIC" mpa
JOIN
    CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL."MIDYEAR_POPULATION" mp
    ON mpa."country_code" = mp."country_code" AND mpa."year" = mp."year"
WHERE
    mpa."year" = 2020
    AND mpa."age" < 20
GROUP BY
    mp."country_name", mp."midyear_population"
ORDER BY
    percentage_under_20 DESC NULLS LAST
LIMIT 10;
```
2025-01-18 21:55:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 21:55:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 21:55:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 21:55:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-18 21:55:39 - snowflake.connector.connection - INFO - closed
2025-01-18 21:55:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 21:55:40 - root - INFO - itercount: 1
2025-01-18 21:55:40 - root - INFO - 0
2025-01-18 21:55:40 - root - INFO - results: 
country_name,TOTAL_POPULATION_UNDER_20,TOTAL_MIDYEAR_POPULATION,PERCENTAGE_UNDER_20
Niger,12498275,21151442,59.0895
Uganda,25564420,43517666,58.7449
Chad,9890342,16877357,58.6012
Mali,11408590,19553397,58.3458
Angola,18948312,32522339,58.2625
Malawi,12065049,21196629,56.9197
Zambia,9860261,17426623,56.5816
Burundi,7045417,12631974,55.7745
Mozambique,15917856,28603070,55.6509
Burkina Faso,11437351,20835401,54.8938


2025-01-18 21:55:40 - root - INFO - Please check the answer again by reviewing Provide a list of the top 10 countries for the year 2020, ordered by the highest percentage of their population under 20 years old. For each country, include the total population under 20 years old, the total midyear population, and the percentage of the population that is under 20 years old., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
country_name,total_population_under_20,total_midyear_population,percentage_under_20
country1:str,pop_under20:int,pop_total:int,percentage:0<=float<=100
country2:str,pop_under20:int,pop_total:int,percentage:0<=float<=100
country3:str,pop_under20:int,pop_total:int,percentage:0<=float<=100
country4:str,pop_under20:int,pop_total:int,percentage:0<=float<=100
country5:str,pop_under20:int,pop_total:int,percentage:0<=float<=100
country6:str,pop_under20:int,pop_total:int,percentage:0<=float<=100
country7:str,pop_under20:int,pop_total:int,percentage:0<=float<=100
country8:str,pop_under20:int,pop_total:int,percentage:0<=float<=100
country9:str,pop_under20:int,pop_total:int,percentage:0<=float<=100
country10:str,pop_under20:int,pop_total:int,percentage:0<=float<=100
```

**Explanation:**

The table above lists the top 10 countries for the year 2020 ordered by the highest percentage of their population under 20 years old. For each country, it includes:
- `country_name`: The name of the country.
- `total_population_under_20`: The total number of people under 20 years old.
- `total_midyear_population`: The total midyear population.
- `percentage_under_20`: The percentage of the population that is under 20 years old (a value between 0 and 100). The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
country_name,TOTAL_POPULATION_UNDER_20,TOTAL_MIDYEAR_POPULATION,PERCENTAGE_UNDER_20
Niger,12498275,21151442,59.0895
Uganda,25564420,43517666,58.7449
Chad,9890342,16877357,58.6012
Mali,11408590,19553397,58.3458
Angola,18948312,32522339,58.2625
Malawi,12065049,21196629,56.9197
Zambia,9860261,17426623,56.5816
Burundi,7045417,12631974,55.7745
Mozambique,15917856,28603070,55.6509
Burkina Faso,11437351,20835401,54.8938
Current sql:
SELECT
    mp."country_name",
    SUM(mpa."population") AS total_population_under_20,
    mp."midyear_population" AS total_midyear_population,
    ROUND((SUM(mpa."population") / mp."midyear_population") * 100, 4) AS percentage_under_20
FROM
    CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL."MIDYEAR_POPULATION_AGESPECIFIC" mpa
JOIN
    CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL."MIDYEAR_POPULATION" mp
    ON mpa."country_code" = mp."country_code" AND mpa."year" = mp."year"
WHERE
    mpa."year" = 2020
    AND mpa."age" < 20
GROUP BY
    mp."country_name", mp."midyear_population"
ORDER BY
    percentage_under_20 DESC NULLS LAST
LIMIT 10;
2025-01-18 21:56:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-18 21:56:05 - root - INFO - ```sql
SELECT
    mp."country_name",
    SUM(mpa."population") AS total_population_under_20,
    mp."midyear_population" AS total_midyear_population,
    ROUND((SUM(mpa."population") / mp."midyear_population") * 100, 4) AS percentage_under_20
FROM
    CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL."MIDYEAR_POPULATION_AGESPECIFIC" mpa
JOIN
    CENSUS_BUREAU_INTERNATIONAL.CENSUS_BUREAU_INTERNATIONAL."MIDYEAR_POPULATION" mp
    ON mpa."country_code" = mp."country_code" AND mpa."year" = mp."year"
WHERE
    mpa."year" = 2020
    AND mpa."age" < 20
GROUP BY
    mp."country_name", mp."midyear_population"
ORDER BY
    percentage_under_20 DESC NULLS LAST
LIMIT 10;
```
2025-01-18 21:56:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-18 21:56:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-18 21:56:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-18 21:56:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-18 21:56:06 - snowflake.connector.connection - INFO - closed
2025-01-18 21:56:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-18 21:56:06 - root - INFO - itercount: 2
2025-01-18 21:56:06 - root - INFO - 0
2025-01-18 21:56:06 - root - INFO - Total iteration counts: 2
