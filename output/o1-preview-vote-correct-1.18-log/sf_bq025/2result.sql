SELECT
    "MIDYEAR_POPULATION_AGESPECIFIC"."country_name" AS "Country_Name",
    SUM("MIDYEAR_POPULATION_AGESPECIFIC"."population") AS "Population_Under_20",
    "MIDYEAR_POPULATION"."midyear_population" AS "Total_Midyear_Population",
    ROUND(
        (SUM("MIDYEAR_POPULATION_AGESPECIFIC"."population") / NULLIF("MIDYEAR_POPULATION"."midyear_population", 0)) * 100,
        4
    ) AS "Percentage_Under_20"
FROM
    "CENSUS_BUREAU_INTERNATIONAL"."CENSUS_BUREAU_INTERNATIONAL"."MIDYEAR_POPULATION_AGESPECIFIC"
JOIN
    "CENSUS_BUREAU_INTERNATIONAL"."CENSUS_BUREAU_INTERNATIONAL"."MIDYEAR_POPULATION"
    ON
        "MIDYEAR_POPULATION_AGESPECIFIC"."country_code" = "MIDYEAR_POPULATION"."country_code"
        AND "MIDYEAR_POPULATION_AGESPECIFIC"."year" = "MIDYEAR_POPULATION"."year"
WHERE
    "MIDYEAR_POPULATION_AGESPECIFIC"."year" = 2020
    AND "MIDYEAR_POPULATION_AGESPECIFIC"."age" < 20
GROUP BY
    "MIDYEAR_POPULATION_AGESPECIFIC"."country_name",
    "MIDYEAR_POPULATION"."midyear_population"
ORDER BY
    "Percentage_Under_20" DESC NULLS LAST,
    "Country_Name" ASC
LIMIT 10;