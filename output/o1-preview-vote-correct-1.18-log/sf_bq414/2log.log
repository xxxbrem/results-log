2025-01-19 10:03:34 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 10:04:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 10:04:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 10:04:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 10:04:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 10:04:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-01-19 10:04:33 - snowflake.connector.connection - INFO - closed
2025-01-19 10:04:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 10:04:34 - root - INFO - SQL:
SELECT DISTINCT "department"
   FROM THE_MET.THE_MET.OBJECTS
   LIMIT 1000;
Results:
department
Asian Art
Islamic Art
Photographs
Medieval Art
The Cloisters
The Libraries
Arms and Armor
Costume Institute
European Paintings
Drawings and Prints
Greek and Roman Art
Musical Instruments
Ancient Near Eastern Art
Robert Lehman Collection
Modern and Contemporary Art
American Paintings and Sculpture
"Arts of Africa, Oceania, and the Americas"
American Decorative Arts
European Sculpture and Decorative Arts
Egyptian Art

2025-01-19 10:04:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 10:04:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 10:04:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 10:04:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 10:04:36 - snowflake.connector.connection - INFO - closed
2025-01-19 10:04:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 10:04:36 - root - INFO - SQL:
SELECT DISTINCT "title"
   FROM THE_MET.THE_MET.OBJECTS
   WHERE "title" ILIKE '%book%'
   LIMIT 1000;
Results:
Too long, hard cut:
title
明     郭詡     稱書圖     軸|Weighing Books
明     杜堇     伏生授經圖   軸|The Scholar Fu Sheng Transmitting the Book of Documents
画本宝能縷|Picture Book of Brocades with Precious Threads (Ehon takara no itosuji)
絵本松のしらべ|Picture Book on the Music of the Pine Trees (Ehon matsu no shirabe)
『和国諸職絵尽　諸織 絵本鏡』|A Picture Book Mirror of Various Occupations (Wakoku shoshoku ezukushi)
Ehon Asakayama|絵本浅香山|Picture Book: Mount Asaka (Ehon Asakayama)
Ehon Ogurayama|絵本小倉山|Picture Book: Ogura Hill (Ehon Ogurayama)
Ehon Himetsubaki|繪本女貞木|Picture Book: Camellia (Ehon Himetsubaki)
『繪本小倉山』|Picture Book of Ogura Hill (Ehon ogurayama)
『繪本小松原』|Picture Book of Komatsubara (Ehon komatsubara)
『寫山樓畫本』|Shazanrō (Bunchō) Picture Book (Shazanrō ehon)
『絵本時世粧』|Picture Book of Modern Figures of Fashion (Ehon imayō sugata)
絵本吾妻遊|Ehon Azuma asobi|Picture Book of Amusements of the Eastern Capital (Ehon Azuma asobi)
Ehon Momochidori Kyōka-awase|百千鳥狂歌合|Myriad Birds: Picture Book of Playful Verse (Momo chidori kyōka-awase)
潮干のつと|Gifts from the Ebb Tide (The Shell Book) (Shiohi no tsuto)
繪本四季花|Picture Book of Flowers of the Four Seasons (Ehon shiki no hana)
『画本狂歌山満多山』|Picture Book of Kyōka Poems: Mountains upon Mountains (Ehon kyōka yama mata yama)
『絵本和漢誉』|Picture Book on Heroes of China and Japan (Ehon wakan no homare)
絵本和歌夷 「龢謌夷」|Picture Book with Playful Poems for the Young God Ebisu
画本虫撰|Picture Book of Crawling Creatures (The Insect Book) (Ehon mushi erami)
『青楼繪本年中行事』|Yoshiwara Picture Book of New Year’s Festivities (Seirō ehon nenjū gyōji)
『暁斎漫画』|Kyōsai Sketchbook (Kyōsai manga)
"『閨の雛形』　正月|Plate from the Erotic Book Mounds of Dyed Colors: A Pattern Book for the Boudoir (Someiro no yama neya no hinagata), First Month"
"『画本虫撰』  「虻」「芋虫」|Horsefly (abu); Green Caterpillar, imomushi, from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』   「松虫」「虫蛍」|Tree cricket (Matsumushi); Firefly (Hotaru), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"画本虫撰　バッタと蟷螂|Cone-headed Grasshopper or Locust, (batta); Praying Mantis (Tōrō or Kamakiri), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"四季の花|Women on a Bridge, from the illustrated book Flowers of the Four Seasons"
"四季の花|A Child Lighting Fireworks, from the illustrated book Flowers of the Four Seasons"
"四季の花|Girls Getting on Board a Boat, from the illustrated book Flowers of the Four Seasons"
"四季の花|New Year's Games, from the printed book Flowers of the Four Seasons (Shiki no hana)"
"『雛形若菜初模様　玉や内　しら玉』|The Courtesan Shiratama of the Tamaya Brothel, from the series “A Pat-tern Book of the Year’s First Designs, Fresh as Spring Herbs” (“Hinagata wakana hatsu moyō”)"
"『雛形若菜初模様　四ツ目屋内　にしき木』|The Courtesan Nishikigi of the Yotsumeya Brothel, from the series “A Pattern Book of the Year’s First Designs, Fresh as Spring Herbs” (“Hinagata wakana hatsu moyō”)"
"『雛形若菜の初模様　扇屋内　七越』|The Courtesan Nanakoshi of the Ōgiya Brothel, from the series “A Pat-tern Book of the Year’s First Designs, Fresh as Spring Herbs” (“Hinagata wakana no hatsu moyō”)"
"『画本虫撰』   「けら」「はさみむし」|Mole Cricket (Kera); Earwig, (Hasami-mushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』「蝸牛」「轡虫」|Land Snail (Katatsumuri); Giant Katydid (Kutsuwamushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"Kamakura no Koshi|The Filial Son at Kamakura, From the Book: Sasekishu"
"『雛形若菜の初模様　つたや内　人まち』|The Courtesan Hitomachi of the Tsutaya Brothel, from the series “A Pat-tern Book of the Year’s First Designs, Fresh as Spring Herbs” (“Hinagata wakana no hatsu moyō”)"
[Woman in Robes Reading a Book]
[Seated Man Pointing to a Passage in an Open Book]
"Manuscript Illumination with the Visitation in an Initial D, from a Choir Book"
"Manuscript Leaf with Adoration of the Holy Name, from a Book of Hours"
The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans
"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work"
"London Chair-Makers' and Carvers' Book of Prices, for Workmanship..."
"The Oxford Drawing Book to which is added, Lessons in Flower Drawing"
A Booke of Christian Prayers
"Sketch Book Containing 182 drawings on 91 leaves. One of a series used by the artist on his Italian trip, 1750–52; Sketches made in Milan, Turin, Florence, and Rome."
Compendium of Architectural Books by Sebastiano Serlio (Books I-V)
The Architecture of A. Palladio in Four Books containing a Short Treatise on the Five Orders (L'Architecture de A. Palladio en quatre livres... / Il quattro libri dell'architettura)
Book of Designs [for Ironwork]
"St. Luke, seated on a cloud with an open book in both hands, a bull lying at his feet, from a series of the four evangelists after Agostino Veneziano, which are in turn after Giulio Romano"
"Dialectic: a young woman standing in a decorated interior and touching her right index finger to her left middle finger in a counting gesture, at he

2025-01-19 10:04:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 10:04:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 10:04:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 10:04:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 120
2025-01-19 10:04:37 - snowflake.connector.connection - INFO - closed
2025-01-19 10:04:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 10:04:38 - root - INFO - SQL:
SELECT "object_id", "title"
   FROM THE_MET.THE_MET.OBJECTS
   WHERE "department" = 'The Libraries'
   LIMIT 1000;
Results:
Too long, hard cut:
object_id,title
682011,Dialogo sobre hua nova obra no Rio Tejo ...
681546,De' ragguagli di Parnaso: Centuria prima-seconda
681534,"Contes et nouvelles de Bocace florentin : traduction libre, accommodée au gout de ce temps, & enrichie de figures en taille-douce gravées par Mr. Romain de Hooge"
681389,"Uffizio della Settimana Santa : colle rubriche volgari, argomenti de' Salmi, spiegazione delle cerimonie e misterj, con osservazioni, e riflessioni divote dell'abate Alessandro Mazzinelli"
591832,"Academie de l'espee; ou se domonstrent par reigles mathématiques sur le fondement d'un cercle mystérieux, la théorie et pratique des vrais . . ."
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans
591831,"Descriptio pbvlicae gratvlationis, spectacvlorvm et lvdorvm, in aventv sereniss: Principis Ernesti Archidvcis Avstriae Dvcis Vrgvndiae"
591865,Morte d'Arthur
591848,"The Holy Land, Syria, Idumea, Arabia, Egypt & Nubia"
591863,"Catalogue of the Collection of Jewels and Precious Works of Art, the Property of  J. Pierpont Morgan"
681573,"Les oeuvres morales de Mr. Diderot : contenant son traité De l'amitié, et celui Des passions"
682013,L'eschole de Salerne en vers burlesques & duo poemata macaronica: de bello huguenotico: et De gestis magnanimi & prudentissimi Baldi
681149,Bibliorum Sacrorum Vulgatae versionis
681556,Mémoires du Comte de Grammont : histoire amoureuse de la cour d'Angleterre sous Charles II / par Antoine Hamilton ; préface et notes par Benjamin Pifteau
681388,"Traité de Plutarque, sur la manière de discerner un flatteur d'avec un ami et Le banquet des sept sages: dialogue du même auteur revu & corrigé sur des manuscrits de la Bibliothèque du roi; avec une version françoise & des notes"
680835,"L'art de former les jardins modernes, ou, L'art des jardins anglois : traduit de l'anglois : à quoi le traducteur a ajouté un discours préliminaire sur l'origine de l'art, des notes sur le texte, & une description détaillée des jardins de Stowe, accompagnée du plan"
681547,"De l'imitation de Jesus-Christ, traduction nouvelle ; ornée de figures en taille-douce"
681545,Contes et nouvelles en vers par Jean de la Fontaine
682014,Figures françoises et comiques nouvellement inventées par M. Watteau; Figures de modes dessinées et gravées à l'eau forte par Watteau; a terminées au buin par Thomassin le fils
681128,"Les aventures de Télémaque, fils d'Ulysse par M. de Fénélon ; avec figures en taille-douce, dessinées par MM. Cochin et Moreau le jeune"
682012,Epistole eroiche di P. Ovidio Nasone
681563,"Oeuvres de Moliere : avec des remarques grammaticales, des avertissemens et des observations sur chaque piéce, par M. Bret"
716648,"Planches pour l'Encyclopédie, ou pour le Dictionaire raisonné des sciences, des arts libéraux, et des arts méchaniques, avec leur explication"
705290,博古圖錄
715005,三禮圖
739504,Examples of Chinese ornament selected from objects in the South Kensington Museum and other collections
726677,"The sunshade, the glove, the muff"
716639,"Encyclopédie, ou Dictionnaire raisonné des sciences, des arts et des métiers, par une société de gens de lettres"
699505,"Dialogos de la pintvra : sv defensa, origen, essecia, definicion, modos y diferencias"
697348,Der aller durchleuchtigisten und grosmächtigen Kayser ... Königen ... Herren vom Adel ... Bildtnussen und kurtz Beschreibungen ihrer so wol in Fridts- als Kriegszzeiten verrichten fürnembsten Thaten und Handlungen : deren Waffen und Rüstungen ... auss allen Landen der Welt ... in dem Schloss Ombrass ... zu ewiger Gedächtnuss auffbehalten werden ...
681349,"Calendrier belgique, curieux et utile, contenant les evenemens historiques sur les jours de l'an, et les travaux à faire dans les jardins en chaque mois de l'année, la description des tableaux remarquables, que l'on trouve dans la ville de Gand, avec les noms des peintres pour l'annėe MDCCLXXII"
591837,Le pitture e sculture di Brescia che sono esposte al pubblico con un' appendice di alcune private gallerie
591862,"Edwin Davis French, A Memorial: His Life, His Art"
591836,Il Ritratto di Venezia
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found"
738466,Modern chromatics : with applications to art and industry
700032,Petri Gyllii De Bosporo thracio libri III ; Petri Gyllii De topographia Constantinopoleos
700050,"Traité de l'horlogerie, méchanique et pratique, approuvé par l'Academie royale des sciences"
738463,"The principles of harmony and contrast of colours, and their applications to the arts"
704714,Mr. Vanderbilt's house and collection
700240,"The cabinet-maker and upholsterer's guide, or, Repository of designs for every article of household furniture, in the newest and most approved taste : displaying a great variety of patterns for chairs, stools ... in the plainest and most enriched styles : with a scale to each, and an e

2025-01-19 10:04:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 10:04:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 10:04:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 10:04:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 229
2025-01-19 10:04:41 - snowflake.connector.connection - INFO - closed
2025-01-19 10:04:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 10:04:41 - root - INFO - SQL:
SELECT "object_id", "cropHintsAnnotation"
   FROM THE_MET.THE_MET.VISION_API_DATA
   WHERE "cropHintsAnnotation" IS NOT NULL
   LIMIT 1000;
Results:
Too long, hard cut:
object_id,cropHintsAnnotation
205225,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 1063,
            ""y"": 0
          },
          {
            ""x"": 1063,
            ""y"": 1935
          },
          {
            ""x"": 0,
            ""y"": 1935
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 4.599999785423279e-01
    }
  ]
}"
357059,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 899,
            ""y"": 0
          },
          {
            ""x"": 899,
            ""y"": 795
          },
          {
            ""x"": 0,
            ""y"": 795
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.599999845027924e-01
    }
  ]
}"
333993,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 840,
            ""y"": 0
          },
          {
            ""x"": 840,
            ""y"": 1175
          },
          {
            ""x"": 0,
            ""y"": 1175
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.999999761581421e-01
    }
  ]
}"
38169,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 1499,
            ""y"": 0
          },
          {
            ""x"": 1499,
            ""y"": 1999
          },
          {
            ""x"": 0,
            ""y"": 1999
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 1.599999904632568e+00
    }
  ]
}"
44833,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 1499,
            ""y"": 0
          },
          {
            ""x"": 1499,
            ""y"": 1999
          },
          {
            ""x"": 0,
            ""y"": 1999
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 1.230000019073486e+00
    }
  ]
}"
548510,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 1014,
            ""y"": 0
          },
          {
            ""x"": 1014,
            ""y"": 1456
          },
          {
            ""x"": 0,
            ""y"": 1456
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 2.829999923706055e+00
    }
  ]
}"
391673,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2603,
            ""y"": 0
          },
          {
            ""x"": 2603,
            ""y"": 2959
          },
          {
            ""x"": 0,
            ""y"": 2959
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 5.699999928474426e-01
    }
  ]
}"
387059,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2742,
            ""y"": 0
          },
          {
            ""x"": 2742,
            ""y"": 3651
          },
          {
            ""x"": 0,
            ""y"": 3651
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.499999940395355e-01
    }
  ]
}"
74832,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2911,
            ""y"": 0
          },
          {
            ""x"": 2911,
            ""y"": 3879
          },
          {
            ""x"": 0,
            ""y"": 3879
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 4.799999892711639e-01
    }
  ]
}"
17571,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2879,
            ""y"": 0
          },
          {
            ""x"": 2879,
            ""y"": 3838
          },
          {
            ""x"": 0,
            ""y"": 3838
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 1.459999918937683e+00
    }
  ]
}"
437454,"{


2025-01-19 10:04:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 10:04:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 10:04:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 10:04:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 10:04:42 - snowflake.connector.connection - INFO - closed
2025-01-19 10:04:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 10:04:43 - root - INFO - SQL:
SELECT t."object_id", f.value:"confidence"::FLOAT AS "cropConfidence"
   FROM THE_MET.THE_MET.VISION_API_DATA t,
   LATERAL FLATTEN(input => t."cropHintsAnnotation":"cropHints") f
   LIMIT 1000;
Results:
Too long, hard cut:
object_id,cropConfidence
463536,1.0
286038,1.0
467486,1.0
386444,1.0
343968,1.0
288535,1.0
17449,1.0
343402,1.0
261387,1.0
342591,1.0
263135,1.0
361703,1.0
729624,1.0
385957,1.0
659124,1.0
345721,1.0
196356,1.0
339707,1.0
367415,1.0
398595,1.0
55574,1.0
197750,1.0
229095,1.0
471848,1.0
436731,1.0
198587,1.0
340058,1.0
349162,1.0
452670,1.0
342501,1.0
37895,1.0
399212,1.0
54652,1.0
11777,1.0
459002,1.0
11372,1.0
397694,1.0
206589,1.0
338515,1.0
364382,1.0
436770,1.0
10401,1.0
64534,1.0
471995,1.0
385089,1.0
342748,1.0
436911,1.0
102243,1.0
11798,1.0
11707,1.0
437490,1.0
438820,1.0
437703,1.0
475487,1.0
459040,1.0
291887,1.0
436664,1.0
463545,1.0
191777,1.0
349309,1.0
467808,1.0
205239,1.0
58026,1.0
269254,1.0
428639,1.0
260058,1.0
237070,1.0
260182,1.0
237754,1.0
45445,1.0
60060,1.0
403086,1.0
700206,1.0
371456,1.0
464151,1.0
187761,1.0
188903,1.0
398499,1.0
204625,1.0
206168,1.0
434111,1.0
393331,1.0
362267,1.0
16665,1.0
288561,1.0
250549,1.0
343201,1.0
1683,1.0
387537,1.0
391793,1.0
399237,1.0
14942,1.0
55423,1.0
195760,1.0
260113,1.0
37125,1.0
364839,1.0
366887,1.0
463765,1.0
451972,1.0
189163,1.0
56753,1.0
203111,1.0
190623,1.0
360642,1.0
202343,1.0
36707,1.0
189644,1.0
382454,1.0
56027,1.0
390689,1.0
59185,1.0
189700,1.0
194324,1.0
386145,1.0
642888,1.0
431358,1.0
302131,1.0
46445,1.0
268128,1.0
51416,1.0
286615,1.0
387541,1.0
367468,1.0
392932,1.0
434603,1.0
260140,1.0
269271,1.0
437069,1.0
460208,1.0
473465,1.0
156808,1.0
464299,1.0
204722,1.0
454344,1.0
36654,1.0
41933,1.0
438026,1.0
11274,1.0
189712,1.0
383935,1.0
63832,1.0
399691,1.0
442749,1.0
625354,1.0
38582,1.0
339119,1.0
55199,1.0
342463,1.0
227026,1.0
407167,1.0
704827,1.0
435691,1.0
436738,1.0
337665,1.0
377467,1.0
459019,1.0
271746,1.0
631422,1.0
436759,1.0
365816,1.0
12731,1.0
451283,1.0
208809,1.0
399545,1.0
249164,1.0
435766,1.0
73439,1.0
339543,1.0
10337,1.0
459015,1.0
437422,1.0
667926,1.0
459023,1.0
249232,1.0
435702,1.0
467508,1.0
435754,1.0
391053,1.0
350970,1.0
369533,1.0
453683,1.0
356476,1.0
436103,1.0
488733,1.0
10389,1.0
58263,1.0
13050,0.29999998211860657
37993,1.0
436892,1.0
656826,1.0
392687,1.0
359151,1.0
337761,1.0
361613,1.0
730790,1.0
286173,1.0
269253,1.0
344140,1.0
260348,1.0
388833,1.0
712946,1.0
260126,1.0
436900,1.0
339559,1.0
342502,1.0
54660,1.0
437004,1.0
194541,1.0
260175,0.5999999642372131
363737,1.0
2783,1.0
452125,1.0
199486,1.0
716639,1.0
54849,1.0
310365,1.0
37807,1.0
436802,1.0
389888,1.0
551108,1.0
435653,1.0
471218,1.0
435763,1.0
436835,1.0
266256,1.0
437268,1.0
436850,1.0
12552,1.0
200564,1.0
260352,1.0
198903,1.0
190119,1.0
335497,1.0
294508,1.0
461549,1.0
206726,1.0
386450,1.0
464286,1.0
471559,1.0
679466,1.0
189944,1.0
471122,1.0
193428,1.0
203376,1.0
187556,1.0
5207,1.0
446583,1.0
11471,1.0
44377,1.0
44384,1.0
682991,1.0
396179,1.0
55419,1.0
44365,1.0
56024,1.0
395469,1.0
342852,1.0
717610,1.0
400806,1.0
398754,1.0
436661,1.0
650943,1.0
193649,1.0
308544,1.0
37881,1.0
371350,1.0
480520,1.0
469947,1.0
291865,1.0
391445,1.0
339498,1.0
342882,1.0
342608,1.0
352216,0.29999998211860657
306752,1.0
271733,1.0
73626,1.0
372777,1.0
365590,1.0
10791,1.0
364281,1.0
365693,1.0
10928,1.0
387577,1.0
370771,1.0
37186,1.0
393209,1.0
337266,1.0
388957,1.0
394628,1.0
339515,1.0
414492,1.0
383921,1.0
410182,1.0
338422,0.29999998211860657
369156,1.0
348596,1.0
678732,1.0
203203,1.0
340976,1.0
261016,1.0
410050,1.0
400836,1.0
467466,1.0
467935,1.0
409982,1.0
414746,1.0
334626,1.0
254207,1.0
4249,1.0
4199,1.0
4209,1.0
4241,1.0
435719,1.0
11603,1.0
56748,1.0
403635,1.0
340262,1.0
15089,1.0
685801,1.0
397498,1.0
472322,1.0
471962,1.0
460419,1.0
260285,1.0
726543,1.0
366993,1.0
55968,1.0
285781,1.0
544689,1.0
544693,0.29999998211860657
394436,1.0
50799,1.0
345808,1.0
208998,1.0
189298,1.0
623053,1.0
391175,1.0
53926,1.0
435834,1.0
246992,0.29999998211860657
322367,1.0
412823,1.0
387572,1.0
73555,1.0
339492,1.0
357054,1.0
414695,1.0
391517,1.0
392595,1.0
428774,1.0
10466,1.0
335405,1.0
371555,1.0
368343,1.0
261801,1.0
54624,1.0
394340,1.0
285465,1.0
54870,1.0
194110,1.0
428755,1.0
196160,1.0
15025,1.0
549533,1.0
263193,1.0
242193,1.0
343111,1.0
189551,1.0
465955,1.0
737547,1.0
363904,1.0
364069,1.0
54499,1.0
470282,1.0
288515,1.0
337263,1.0
45241,1.0
645240,1.0
416247,1.0
348790,1.0
339554,1.0
250968,1.0
206819,1.0
543873,1.0
471055,1.0
623067,1.0
471557,1.0
459205,1.0
12563,1.0
261590,1.0
198277,1.0
337168,1.0
506089,1.0
374026,1.0
36607,1.0
467941,1.0
341201,1.0
349127,1.0
437866,1.0
206049,1.0
242318,1.0
633310,1.0
10961,1.0
343310,1.0
252916,1.0
288159,1.0
205109,1.0
38481,1.0
55320,1.0
11842,1.0
193822,1.0
11408,1.0
348978,1.0
670559,1.0
395879,1.0
38646,1.0
55397,1.0
436190,1.0
207814,1.0
255899,1.0
367190,1.0
54819,1.0
470265,1.0
250655,1.0
206873,1.0
10970,1.0
459399,1.0
359089,1.0
11489,1.0
435709,1.0
53181,1.0
254915,1.0
406441,1.0
56602,1.0
103035,1.0
633569,1.0
11512,1.0
646609,1.0
242375,1.0
192720,1.0
385670,1.0
45493,0.29999998211860657
288528,1.0
231788,1.0
207397,1.0
45494,1.0
204169,1.0
335536,1.0
469877,1.

2025-01-19 10:04:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 10:04:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 10:04:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 10:04:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 10:04:45 - snowflake.connector.connection - INFO - closed
2025-01-19 10:04:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 10:04:45 - root - INFO - SQL:
SELECT DISTINCT t."object_id"
   FROM THE_MET.THE_MET.VISION_API_DATA t,
   LATERAL FLATTEN(input => t."cropHintsAnnotation":"cropHints") f
   WHERE f.value:"confidence"::FLOAT > 0.5
   LIMIT 1000;
Results:
Too long, hard cut:
object_id
437177
196587
399542
209272
397692
56835
435852
464124
463742
199485
466107
370485
382755
505616
646460
55273
468318
467471
388772
390083
12917
399213
60164
437798
198906
37943
449008
469940
246807
201588
435745
459039
466561
188970
10077
437740
437722
73415
438387
367538
266259
361830
299311
199487
186804
13043
463038
285789
286636
12717
459045
460152
55323
188885
306162
227723
471903
437330
679157
54569
44359
269243
460151
436760
55266
186798
471976
361703
10401
436911
459040
45445
343201
197750
467808
434111
55423
37125
390689
383935
249232
730790
389888
385089
451972
382454
156808
55199
459015
453683
436835
339559
436850
900
364208
288214
186800
386355
398521
464306
437819
438025
469932
193450
386457
392523
383358
452017
437855
704977
336882
291921
229601
267233
442183
156426
459005
392464
435848
437100
445280
436048
10184
339941
349133
55746
339836
269236
338973
45249
436410
380487
10353
446577
464275
466201
367415
51416
464286
436840
209042
156804
470874
11627
363260
717610
37186
467466
414746
4209
467941
205109
342608
678732
11603
340262
412823
263193
54499
348790
506089
10961
436190
358365
645240
374026
242318
435709
192720
436205
428022
261480
261347
54678
189351
291939
335751
197997
187145
203576
467523
436461
195345
415389
461448
383686
349097
392843
460166
291869
369299
670999
205194
469891
435585
437414
708058
357164
271736
437555
386451
398655
288154
291873
398594
435682
17187
390698
460077
334306
334884
435908
269875
716365
285466
392618
436918
702752
291890
37141
435899
205267
201454
736059
260350
294515
370452
464588
436261
652270
36668
382932
435822
205630
292002
44376
659502
390467
437250
262992
712180
288162
455041
467462
548438
204272
437650
437777
399439
190537
635401
339942
436099
446285
657683
650860
204484
468105
470346
436604
435727
668074
269252
55879
466277
371107
416247
76971
387496
56742
260112
54878
645448
227763
238577
291878
385063
54827
437491
682989
55262
437028
11133
341770
269251
333993
437454
467679
288012
384064
436542
193614
394309
458996
488853
326695
334772
402847
392327
460207
392937
37385
698490
288126
290476
4205
4200
371590
45261
351416
45322
478972
4203
343737
408902
13245
547690
207160
358160
342743
239425
471068
286833
282191
451258
204267
344913
249180
4140
436519
307013
643540
435947
549501
385669
49567
367000
436267
13345
12554
435984
6788
365096
242035
195965
447801
388713
114709
395492
263206
625912
13786
403077
390688
471824
644110
342531
316594
455057
306204
57649
248809
376674
289329
286582
199990
36841
252955
656747
32840
73429
436537
464277
359455
407171
45313
32830
268354
460236
342525
352198
339675
670908
56756
436180
335942
194181
471942
198992
463555
459059
385969
359909
458998
684336
336508
464135
287770
260185
288160
286165
63812
463039
199489
260115
399217
393290
260118
189964
291857
696392
335420
388970
294445
268109
438467
468317
301973
430870
55216
55209
288532
366522
437912
437336
437743
459198
437244
464281
361605
467648
390082
20495
459950
467640
285692
186317
200837
12644
464494
707785
458992
44355
466192
306155
392469
371141
56764
289308
335156
321519
324791
255905
323706
504881
8743
324142
124497
228544
32356
556947
44940
420483
190652
244063
588371
558135
243821
252165
323259
38049
25286
244259
308782
43289
323884
569903
552199
590424
229721
544004
317305
648081
557955
35189
323387
324072
62087
250417
26255
254830
454117
250597
501525
467174
467272
55154
58699
317314
466713
467598
551367
308195
236558
644994
416702
339097
8737
29656
61141
250605
30764
251333
549438
323125
501529
382668
422120
323227
23161
215003
206317
251409
550065
252180
473637
468786
309118
407283
243473
250629
409746
241776
229631
206361
549664
249867
478524
647495
471704
5651
321818
410450
250377
454854
590342
29763
448815
214070
44089
732470
5197
369701
244400
196718
251909
243009
65240
214051
732474
643563
443874
325626
8748
16667
268025
505093
548861
559122
427207
257299
23703
548136
248532
474836
323546
466661
250374
23444
565430
325258
23506
14126
556817
736910
444799
324376
474894
474750
3787
588372
32784
705848
250472
252756
479299
35004
309094
58920
323417
244377
444793
23099
559161
694344
75040
414762
70332
452664
326893
59438
323663
503616
261880
73223
372612
307560
307625
250557
478211
660767
326480
244432
317511
471708
58645
465486
225109
448285
394039
742354
452164
452047
449092
448173
59214
32782
399741
428374
445463
68246
547707
503951
546465
448788
8732
216529
209933
33412
651980
739651
33752
545529
470123
420761
406892
450296
406565
251904
257596
571801
123184
546310
250381
41742
551271
567651
9726
323101
650913
644915
40319
315806
549234
559517
26242
8008
75134
61355
316862
504525
246364
309954
570795
213912
569882
251913
25340
250608
222061
726169
570808
450185
309007
569911
467258
252142
213791
213870
325004
726170
565407
287938
327133
268089
78257
269328
503247
248227
717663
251901
326733
308193
729590
264895
17804
647084
203905
186377
697455
647054
317330
197389
324499
246230
343063
317033
551458
472837
45562
407432
502969
502136

2025-01-19 10:04:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 10:04:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 10:04:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 10:04:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-19 10:04:46 - snowflake.connector.connection - INFO - closed
2025-01-19 10:04:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 10:04:47 - root - INFO - SQL:
SELECT DISTINCT "metadata_date"
   FROM THE_MET.THE_MET.OBJECTS
   LIMIT 1000;
Results:
metadata_date
1486368016000000

2025-01-19 10:04:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 10:04:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 10:04:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 10:04:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 10:04:48 - snowflake.connector.connection - INFO - closed
2025-01-19 10:04:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 10:04:48 - root - INFO - SQL:
SELECT "object_id", TO_VARCHAR(TO_TIMESTAMP("metadata_date"), 'YYYY-MM-DD') AS "formatted_metadata_date"
   FROM THE_MET.THE_MET.OBJECTS
   LIMIT 1000;
Results:
Too long, hard cut:
object_id,formatted_metadata_date
646996,47103097-05-20
77916,47103097-05-20
38009,47103097-05-20
37988,47103097-05-20
74660,47103097-05-20
74674,47103097-05-20
74675,47103097-05-20
74677,47103097-05-20
74685,47103097-05-20
65595,47103097-05-20
73261,47103097-05-20
38042,47103097-05-20
39894,47103097-05-20
64891,47103097-05-20
65590,47103097-05-20
65594,47103097-05-20
40445,47103097-05-20
45063,47103097-05-20
40069,47103097-05-20
40070,47103097-05-20
37964,47103097-05-20
75084,47103097-05-20
75085,47103097-05-20
75086,47103097-05-20
75087,47103097-05-20
75088,47103097-05-20
75089,47103097-05-20
75090,47103097-05-20
75091,47103097-05-20
75092,47103097-05-20
75093,47103097-05-20
75094,47103097-05-20
75095,47103097-05-20
75096,47103097-05-20
75097,47103097-05-20
75098,47103097-05-20
75099,47103097-05-20
75100,47103097-05-20
75101,47103097-05-20
75102,47103097-05-20
75103,47103097-05-20
75104,47103097-05-20
75105,47103097-05-20
75106,47103097-05-20
75107,47103097-05-20
75108,47103097-05-20
75109,47103097-05-20
75110,47103097-05-20
75111,47103097-05-20
75112,47103097-05-20
75113,47103097-05-20
75114,47103097-05-20
75115,47103097-05-20
75116,47103097-05-20
75117,47103097-05-20
75118,47103097-05-20
75119,47103097-05-20
75120,47103097-05-20
75121,47103097-05-20
75122,47103097-05-20
75123,47103097-05-20
75124,47103097-05-20
75125,47103097-05-20
75126,47103097-05-20
75127,47103097-05-20
75128,47103097-05-20
75129,47103097-05-20
75130,47103097-05-20
75131,47103097-05-20
75132,47103097-05-20
75133,47103097-05-20
75134,47103097-05-20
75135,47103097-05-20
75136,47103097-05-20
75137,47103097-05-20
75138,47103097-05-20
75139,47103097-05-20
75140,47103097-05-20
75141,47103097-05-20
75142,47103097-05-20
75143,47103097-05-20
75145,47103097-05-20
75146,47103097-05-20
75147,47103097-05-20
75148,47103097-05-20
75149,47103097-05-20
75150,47103097-05-20
75151,47103097-05-20
75152,47103097-05-20
75153,47103097-05-20
54912,47103097-05-20
38448,47103097-05-20
40429,47103097-05-20
40432,47103097-05-20
73188,47103097-05-20
74683,47103097-05-20
72589,47103097-05-20
74656,47103097-05-20
64046,47103097-05-20
39899,47103097-05-20
36145,47103097-05-20
49665,47103097-05-20
36130,47103097-05-20
36435,47103097-05-20
36036,47103097-05-20
36072,47103097-05-20
49133,47103097-05-20
65620,47103097-05-20
40021,47103097-05-20
49453,47103097-05-20
49134,47103097-05-20
65075,47103097-05-20
41468,47103097-05-20
40507,47103097-05-20
40052,47103097-05-20
35995,47103097-05-20
35999,47103097-05-20
36003,47103097-05-20
45786,47103097-05-20
73669,47103097-05-20
49179,47103097-05-20
49226,47103097-05-20
51727,47103097-05-20
51705,47103097-05-20
51528,47103097-05-20
51656,47103097-05-20
51644,47103097-05-20
36129,47103097-05-20
51770,47103097-05-20
64029,47103097-05-20
60764,47103097-05-20
51902,47103097-05-20
64045,47103097-05-20
36439,47103097-05-20
40285,47103097-05-20
40107,47103097-05-20
40180,47103097-05-20
40194,47103097-05-20
40060,47103097-05-20
40058,47103097-05-20
45684,47103097-05-20
45746,47103097-05-20
39766,47103097-05-20
45749,47103097-05-20
44574,47103097-05-20
45775,47103097-05-20
45780,47103097-05-20
51865,47103097-05-20
77914,47103097-05-20
48875,47103097-05-20
48955,47103097-05-20
48954,47103097-05-20
49025,47103097-05-20
49029,47103097-05-20
56553,47103097-05-20
41780,47103097-05-20
39625,47103097-05-20
48931,47103097-05-20
48928,47103097-05-20
48959,47103097-05-20
49129,47103097-05-20
49146,47103097-05-20
49147,47103097-05-20
49163,47103097-05-20
51894,47103097-05-20
36132,47103097-05-20
51900,47103097-05-20
75814,47103097-05-20
54308,47103097-05-20
55495,47103097-05-20
49473,47103097-05-20
35987,47103097-05-20
44570,47103097-05-20
40105,47103097-05-20
40509,47103097-05-20
42329,47103097-05-20
39918,47103097-05-20
39919,47103097-05-20
40103,47103097-05-20
40104,47103097-05-20
41777,47103097-05-20
41860,47103097-05-20
40018,47103097-05-20
41778,47103097-05-20
41782,47103097-05-20
63196,47103097-05-20
63185,47103097-05-20
49047,47103097-05-20
50549,47103097-05-20
53924,47103097-05-20
53925,47103097-05-20
53926,47103097-05-20
53927,47103097-05-20
53928,47103097-05-20
53929,47103097-05-20
42323,47103097-05-20
36236,47103097-05-20
36098,47103097-05-20
72711,47103097-05-20
72712,47103097-05-20
36201,47103097-05-20
44567,47103097-05-20
49617,47103097-05-20
36208,47103097-05-20
36205,47103097-05-20
36206,47103097-05-20
36211,47103097-05-20
36210,47103097-05-20
36216,47103097-05-20
49629,47103097-05-20
49630,47103097-05-20
41504,47103097-05-20
49603,47103097-05-20
49604,47103097-05-20
49605,47103097-05-20
49607,47103097-05-20
36202,47103097-05-20
49608,47103097-05-20
49606,47103097-05-20
49614,47103097-05-20
49615,47103097-05-20
49663,47103097-05-20
49664,47103097-05-20
49626,47103097-05-20
49627,47103097-05-20
36222,47103097-05-20
36224,47103097-05-20
49623,47103097-05-20
40311,47103097-05-20
45652,47103097-05-20
39901,47103097-05-20
39959,47103097-05-20
51762,47103097-05-20
40062,47103097-05-20
40057,47103097-05-20
40094,47103097-05-20
36052,471

2025-01-19 10:04:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 10:04:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 10:04:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 10:04:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 10:04:50 - snowflake.connector.connection - INFO - closed
2025-01-19 10:04:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 10:04:50 - root - INFO - SQL:
SELECT DISTINCT o."object_id"
   FROM THE_MET.THE_MET.OBJECTS o
   JOIN THE_MET.THE_MET.VISION_API_DATA v ON o."object_id" = v."object_id"
   LIMIT 1000;
Results:
Too long, hard cut:
object_id
2704
308689
546942
204339
343127
578666
202859
104470
201749
239562
113100
393606
449595
308332
546355
226289
568716
90391
388318
453272
196116
340669
506171
447997
310223
214796
325122
345467
75091
9595
438947
681278
285647
559821
189458
562094
37216
12182
445763
450642
5419
199611
227360
67391
59408
247783
55583
62974
662608
200413
309966
406563
188922
203055
478568
371380
555174
72238
44426
261845
124281
216309
21919
40927
457103
706476
47379
463793
198114
450362
325404
390599
422167
198525
58006
195003
119817
114692
457652
240352
209420
188252
42427
552608
437585
410925
551448
407097
194942
407117
188790
336026
5289
50060
502513
307663
316963
246607
261842
12440
245736
557048
244998
543956
188673
437278
459218
287224
104125
33416
55166
68945
237794
339364
371330
229917
363718
248996
339329
190932
2408
222298
322041
53294
2416
470655
239820
53829
187333
340883
547214
422679
288483
342718
242983
370772
252367
58774
483721
823
186301
66746
191804
255180
251134
693149
403983
548918
22067
196881
411307
67933
314494
26327
12834
414878
38406
550160
547995
412508
205025
327706
37915
259152
443429
336919
204903
464137
465537
326569
15807
323504
460185
471572
355297
464566
481037
334118
35629
403876
325661
457316
67544
565871
251402
230414
244603
226694
192752
9524
70494
254598
157645
26505
12536
459756
364657
546319
562783
680079
90509
35060
367283
49457
377640
356327
307641
11625
460911
56864
463400
247677
228953
238890
706447
200075
409358
361716
205579
287227
50567
202452
391036
225069
373934
209332
173651
457436
444199
58940
69748
391283
639405
316578
82106
12592
479199
339570
376110
444840
23396
204157
378036
1218
119566
575747
196820
248903
237244
338109
342218
201341
50910
358404
448856
58068
36012
259583
382652
197660
206121
449010
195268
437637
323960
418593
450455
187528
417082
569414
554596
545033
451359
209811
245345
454666
67545
57442
504201
43187
450132
245457
69832
263219
243795
345033
215128
429577
559797
443619
394016
252392
342590
343059
3115
219215
571945
465583
257058
413447
345491
453299
196921
588380
189855
210720
52709
365723
50573
400084
662923
22965
624385
451933
58507
400876
475243
19022
45251
659539
483311
443823
55014
396339
204773
659792
217269
327288
63819
59148
55482
451734
65947
68385
156171
27144
226358
548995
445502
416148
36888
215354
222421
465046
443778
318649
469942
577208
121214
407562
206032
223055
66737
364110
552304
545185
396961
336767
43157
671046
214228
230476
219561
12607
213469
322209
325260
222656
467233
204646
37256
261879
369623
13261
372991
103642
222954
549709
193590
359471
86410
652440
69419
198916
550253
8247
248778
3984
415234
255152
446239
446349
203436
288478
223568
347404
16479
156406
339104
358955
322240
386602
244132
214012
59434
287368
446749
544918
249764
209715
193609
66211
217194
53301
62094
437311
408555
22070
21304
694395
463240
112933
14307
214013
222763
503844
247850
68909
386092
680464
267987
56069
361656
52471
408387
355377
227192
479299
549079
324194
186434
243266
60626
340690
264982
573130
363050
5179
559049
675898
666123
22876
56922
548861
46970
244892
241006
710927
360519
219348
62198
571089
466754
317567
623386
360743
256149
705848
623258
37980
369251
422120
158967
549444
45222
423149
223496
447928
13597
198158
60125
3858
348339
336339
253044
124189
45274
256062
436274
384888
251197
51689
428762
249005
339191
36657
72223
201353
64336
1999
338222
363506
570666
68355
340835
19099
191825
115295
25998
192362
308667
13749
406656
193723
55737
412057
47853
39371
505681
13761
247626
216991
54418
394031
227841
43810
477767
50859
34910
656846
393665
435727
37186
54499
460166
1130
652955
389415
243899
62907
44118
205984
243818
470868
190588
222408
247468
562061
193502
356271
70179
553616
45063
192669
395306
30850
462952
464474
39806
194633
446891
66172
5769
415672
436279
227393
309186
68808
505378
445280
339941
549152
246399
644197
544006
26598
51478
400955
505106
545016
11488
3441
549703
216725
412823
451149
323613
240089
369242
5850
267665
660008
241423
168761
228808
436436
373153
240128
196999
51416
10353
62227
26309
239155
458958
21185
209571
436461
90999
219262
466626
307937
548969
403674
464905
384959
14626
323353
447006
377434
251053
684053
192080
463039
370485
661791
16319
369356
341660
324310
386617
192048
26568
5133
251138
414932
364742
348771
70670
316713
310218
69717
685806
341439
670645
204120
60283
414949
224317
444423
659075
43039
327381
554326
324800
553870
202382
65837
316818
415603
336855
321658
13799
221970
463870
385484
221857
437273
40871
346399
400618
443296
207934
10141
465980
419903
407801
567611
65986
410444
570431
22394
218093
435788
395546
552455
545203
383824
334422
66524
199891
2487
704860
448081
400020
467909
452027
53281
26529
168342
13074
47115
69838
200309
238889
343212
671523
398043
51150
475263
36512
544238
13621
411473
560420
55814
243638
21355
463702
383677
476394
325897
274
546352
221309
288136
460320
54328
336529
406730
342876
548469
22768
7913
202457
548114
242380
221130
386408
446115
474512
251544
4

2025-01-19 10:04:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 10:04:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 10:04:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 10:04:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-19 10:04:51 - snowflake.connector.connection - INFO - closed
2025-01-19 10:04:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 10:04:52 - root - INFO - SQL:
SELECT "object_id", "title"
    FROM THE_MET.THE_MET.OBJECTS
    WHERE "department" = 'The Libraries' AND "title" ILIKE '%book%'
    LIMIT 1000;
Results:
object_id,title
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found"
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts"
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work"
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc."

2025-01-19 10:04:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 10:04:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 10:04:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 10:04:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-19 10:04:54 - snowflake.connector.connection - INFO - closed
2025-01-19 10:04:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 10:04:54 - root - INFO - SQL:
SELECT t."object_id", f.value
    FROM THE_MET.THE_MET.VISION_API_DATA t,
    LATERAL FLATTEN(input => t."cropHintsAnnotation") f
    LIMIT 1000;
Results:
Too long, hard cut:
object_id,VALUE
395469,"[
  {
    ""boundingPoly"": {
      ""vertices"": [
        {
          ""x"": 403,
          ""y"": 0
        },
        {
          ""x"": 2247,
          ""y"": 0
        },
        {
          ""x"": 2247,
          ""y"": 2892
        },
        {
          ""x"": 403,
          ""y"": 2892
        }
      ]
    },
    ""confidence"": 1.000000000000000e+00,
    ""importanceFraction"": 3.299999833106995e-01
  }
]"
342852,"[
  {
    ""boundingPoly"": {
      ""vertices"": [
        {
          ""x"": 0,
          ""y"": 0
        },
        {
          ""x"": 3422,
          ""y"": 0
        },
        {
          ""x"": 3422,
          ""y"": 2475
        },
        {
          ""x"": 0,
          ""y"": 2475
        }
      ]
    },
    ""confidence"": 1.000000000000000e+00,
    ""importanceFraction"": 3.499999940395355e-01
  }
]"
717610,"[
  {
    ""boundingPoly"": {
      ""vertices"": [
        {
          ""x"": 0,
          ""y"": 0
        },
        {
          ""x"": 1632,
          ""y"": 0
        },
        {
          ""x"": 1632,
          ""y"": 1112
        },
        {
          ""x"": 0,
          ""y"": 1112
        }
      ]
    },
    ""confidence"": 1.000000000000000e+00,
    ""importanceFraction"": 3.599999845027924e-01
  }
]"
400806,"[
  {
    ""boundingPoly"": {
      ""vertices"": [
        {
          ""x"": 0,
          ""y"": 0
        },
        {
          ""x"": 3723,
          ""y"": 0
        },
        {
          ""x"": 3723,
          ""y"": 2579
        },
        {
          ""x"": 0,
          ""y"": 2579
        }
      ]
    },
    ""confidence"": 1.000000000000000e+00,
    ""importanceFraction"": 3.499999940395355e-01
  }
]"
398754,"[
  {
    ""boundingPoly"": {
      ""vertices"": [
        {
          ""x"": 0,
          ""y"": 0
        },
        {
          ""x"": 2403,
          ""y"": 0
        },
        {
          ""x"": 2403,
          ""y"": 3444
        },
        {
          ""x"": 0,
          ""y"": 3444
        }
      ]
    },
    ""confidence"": 1.000000000000000e+00,
    ""importanceFraction"": 1.389999985694885e+00
  }
]"
436661,"[
  {
    ""boundingPoly"": {
      ""vertices"": [
        {
          ""x"": 187,
          ""y"": 0
        },
        {
          ""x"": 3431,
          ""y"": 0
        },
        {
          ""x"": 3431,
          ""y"": 3617
        },
        {
          ""x"": 187,
          ""y"": 3617
        }
      ]
    },
    ""confidence"": 1.000000000000000e+00,
    ""importanceFraction"": 5.899999737739563e-01
  }
]"
650943,"[
  {
    ""boundingPoly"": {
      ""vertices"": [
        {
          ""x"": 298,
          ""y"": 0
        },
        {
          ""x"": 2008,
          ""y"": 0
        },
        {
          ""x"": 2008,
          ""y"": 3064
        },
        {
          ""x"": 298,
          ""y"": 3064
        }
      ]
    },
    ""confidence"": 1.000000000000000e+00,
    ""importanceFraction"": 6.100000143051147e-01
  }
]"
193649,"[
  {
    ""boundingPoly"": {
      ""vertices"": [
        {
          ""x"": 0,
          ""y"": 0
        },
        {
          ""x"": 2977,
          ""y"": 0
        },
        {
          ""x"": 2977,
          ""y"": 3721
        },
        {
          ""x"": 0,
          ""y"": 3721
        }
      ]
    },
    ""confidence"": 1.000000000000000e+00,
    ""importanceFraction"": 3.599999845027924e-01
  }
]"
308544,"[
  {
    ""boundingPoly"": {
      ""vertices"": [
        {
          ""x"": 0,
          ""y"": 0
        },
        {
          ""x"": 3140,
          ""y"": 0
        },
        {
          ""x"": 3140,
          ""y"": 3999
        },
        {
          ""x"": 0,
          ""y"": 3999
        }
      ]
    },
    ""confidence"": 1.000000000000000e+00,
    ""importanceFraction"": 5.500000119209290e-01
  }
]"
37881,"[
  {
    ""boundingPoly"": {
      ""vertices"": [
        {
          ""x"": 0,
          ""y"": 0
        },
        {
          ""x"": 2883,
          ""y"": 0
        },
        {
          ""x"": 2883,
          ""y"": 3739
        },
        {
          ""x"": 0,
          ""y"": 3739
        }
      ]
    },
    ""confidence"": 1.000000000000000e+00,
    ""importanceFraction"": 3.599999845027924e-01
  }
]"
371350,"[
  {
    ""boundingPoly"": {
      ""vertices"": [
        {
          ""x"": 0,
          ""y"": 0
        },
        {
          ""x"": 2640,
          ""y"": 0
        },
        {
          ""x"": 2640,
          ""y"": 3574
        },
        {
          ""x"": 0,
          ""y"": 3574
        }
      ]
    },
    ""confidence"": 1.000000000000000e+00,
    ""importanceFraction"": 4.499999880790710e-01
  }
]"
480520,"[
  {
    ""boundingPoly"": {
      ""vertices"": [
        {
          ""x"": 535,
          ""y"": 0
        },
        {
          ""x"": 2589,
          ""y"": 0
        },
        {
          ""x"": 2589,
          ""y"": 3721
        },
        {
          ""x"": 535,
    

2025-01-19 10:04:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 10:04:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 10:04:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 10:04:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7
2025-01-19 10:04:56 - snowflake.connector.connection - INFO - closed
2025-01-19 10:04:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 10:04:56 - root - INFO - SQL:
SELECT DISTINCT f.value:"confidence"::FLOAT AS "cropConfidence"
    FROM THE_MET.THE_MET.VISION_API_DATA t,
    LATERAL FLATTEN(input => t."cropHintsAnnotation":"cropHints") f
    WHERE f.value:"confidence" IS NOT NULL
    LIMIT 1000;
Results:
cropConfidence
0.8999999761581421
0.29999998211860657
0.7999999523162842
0.5
1.0
0.5999999642372131
0.699999988079071

2025-01-19 10:04:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 10:04:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 10:04:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 10:04:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 10:04:58 - snowflake.connector.connection - INFO - closed
2025-01-19 10:04:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 10:04:58 - root - INFO - SQL:
SELECT "metadata_date", TRY_TO_DATE("metadata_date"::VARCHAR) AS "date_value"
    FROM THE_MET.THE_MET.OBJECTS
    LIMIT 1000;
Results:
Too long, hard cut:
metadata_date,date_value
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,20

2025-01-19 10:04:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 10:04:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 10:04:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 10:04:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-19 10:04:59 - snowflake.connector.connection - INFO - closed
2025-01-19 10:05:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 10:05:00 - root - INFO - SQL:
SELECT t."object_id", f.value:"confidence"::FLOAT AS "cropConfidence"
    FROM THE_MET.THE_MET.VISION_API_DATA t,
    LATERAL FLATTEN(input => t."cropHintsAnnotation":"cropHints") f
    WHERE f.value:"confidence"::FLOAT > 0.5
    LIMIT 1000;
Results:
Too long, hard cut:
object_id,cropConfidence
395469,1.0
342852,1.0
717610,1.0
400806,1.0
398754,1.0
436661,1.0
650943,1.0
193649,1.0
308544,1.0
37881,1.0
371350,1.0
480520,1.0
469947,1.0
291865,1.0
391445,1.0
339498,1.0
342882,1.0
342608,1.0
306752,1.0
271733,1.0
73626,1.0
372777,1.0
365590,1.0
10791,1.0
364281,1.0
365693,1.0
10928,1.0
387577,1.0
370771,1.0
37186,1.0
393209,1.0
337266,1.0
388957,1.0
394628,1.0
339515,1.0
414492,1.0
383921,1.0
410182,1.0
369156,1.0
348596,1.0
678732,1.0
203203,1.0
340976,1.0
261016,1.0
410050,1.0
400836,1.0
467466,1.0
467935,1.0
409982,1.0
414746,1.0
334626,1.0
254207,1.0
4249,1.0
4199,1.0
4209,1.0
4241,1.0
435719,1.0
11603,1.0
56748,1.0
403635,1.0
340262,1.0
15089,1.0
685801,1.0
397498,1.0
472322,1.0
471962,1.0
460419,1.0
260285,1.0
726543,1.0
366993,1.0
55968,1.0
285781,1.0
544689,1.0
394436,1.0
50799,1.0
345808,1.0
208998,1.0
189298,1.0
623053,1.0
391175,1.0
53926,1.0
435834,1.0
322367,1.0
412823,1.0
387572,1.0
73555,1.0
339492,1.0
357054,1.0
414695,1.0
391517,1.0
392595,1.0
428774,1.0
10466,1.0
335405,1.0
371555,1.0
368343,1.0
261801,1.0
54624,1.0
394340,1.0
285465,1.0
54870,1.0
194110,1.0
428755,1.0
196160,1.0
15025,1.0
549533,1.0
263193,1.0
242193,1.0
343111,1.0
189551,1.0
465955,1.0
737547,1.0
363904,1.0
364069,1.0
54499,1.0
470282,1.0
288515,1.0
337263,1.0
45241,1.0
645240,1.0
416247,1.0
348790,1.0
339554,1.0
250968,1.0
206819,1.0
543873,1.0
471055,1.0
623067,1.0
463536,1.0
286038,1.0
467486,1.0
386444,1.0
343968,1.0
288535,1.0
17449,1.0
343402,1.0
261387,1.0
342591,1.0
263135,1.0
361703,1.0
729624,1.0
385957,1.0
659124,1.0
345721,1.0
196356,1.0
339707,1.0
367415,1.0
398595,1.0
55574,1.0
197750,1.0
229095,1.0
471848,1.0
436731,1.0
198587,1.0
340058,1.0
349162,1.0
452670,1.0
342501,1.0
37895,1.0
399212,1.0
54652,1.0
11777,1.0
459002,1.0
11372,1.0
397694,1.0
206589,1.0
338515,1.0
364382,1.0
436770,1.0
10401,1.0
64534,1.0
471995,1.0
385089,1.0
342748,1.0
436911,1.0
102243,1.0
11798,1.0
11707,1.0
437490,1.0
438820,1.0
437703,1.0
475487,1.0
459040,1.0
291887,1.0
436664,1.0
463545,1.0
191777,1.0
349309,1.0
467808,1.0
205239,1.0
58026,1.0
269254,1.0
428639,1.0
260058,1.0
237070,1.0
260182,1.0
237754,1.0
45445,1.0
60060,1.0
403086,1.0
700206,1.0
371456,1.0
464151,1.0
187761,1.0
188903,1.0
398499,1.0
204625,1.0
206168,1.0
434111,1.0
393331,1.0
362267,1.0
16665,1.0
288561,1.0
250549,1.0
343201,1.0
1683,1.0
387537,1.0
391793,1.0
399237,1.0
14942,1.0
55423,1.0
195760,1.0
260113,1.0
37125,1.0
364839,1.0
366887,1.0
463765,1.0
451972,1.0
189163,1.0
56753,1.0
203111,1.0
190623,1.0
360642,1.0
202343,1.0
36707,1.0
189644,1.0
382454,1.0
56027,1.0
390689,1.0
59185,1.0
189700,1.0
194324,1.0
386145,1.0
642888,1.0
431358,1.0
302131,1.0
46445,1.0
268128,1.0
51416,1.0
286615,1.0
387541,1.0
367468,1.0
392932,1.0
434603,1.0
260140,1.0
269271,1.0
437069,1.0
460208,1.0
473465,1.0
156808,1.0
464299,1.0
204722,1.0
454344,1.0
36654,1.0
41933,1.0
438026,1.0
11274,1.0
189712,1.0
383935,1.0
63832,1.0
399691,1.0
442749,1.0
625354,1.0
38582,1.0
339119,1.0
55199,1.0
342463,1.0
227026,1.0
407167,1.0
704827,1.0
435691,1.0
436738,1.0
337665,1.0
377467,1.0
459019,1.0
271746,1.0
631422,1.0
436759,1.0
365816,1.0
12731,1.0
451283,1.0
208809,1.0
399545,1.0
249164,1.0
435766,1.0
73439,1.0
339543,1.0
10337,1.0
459015,1.0
437422,1.0
667926,1.0
459023,1.0
249232,1.0
435702,1.0
467508,1.0
435754,1.0
391053,1.0
350970,1.0
369533,1.0
453683,1.0
356476,1.0
436103,1.0
488733,1.0
10389,1.0
58263,1.0
37993,1.0
436892,1.0
656826,1.0
392687,1.0
359151,1.0
337761,1.0
361613,1.0
730790,1.0
286173,1.0
269253,1.0
344140,1.0
260348,1.0
388833,1.0
712946,1.0
260126,1.0
436900,1.0
339559,1.0
342502,1.0
54660,1.0
437004,1.0
194541,1.0
260175,0.5999999642372131
363737,1.0
2783,1.0
452125,1.0
199486,1.0
716639,1.0
54849,1.0
310365,1.0
37807,1.0
436802,1.0
389888,1.0
551108,1.0
435653,1.0
471218,1.0
435763,1.0
436835,1.0
266256,1.0
437268,1.0
436850,1.0
12552,1.0
200564,1.0
260352,1.0
198903,1.0
190119,1.0
335497,1.0
294508,1.0
461549,1.0
206726,1.0
386450,1.0
464286,1.0
471559,1.0
679466,1.0
189944,1.0
471122,1.0
193428,1.0
203376,1.0
187556,1.0
5207,1.0
446583,1.0
11471,1.0
44377,1.0
44384,1.0
682991,1.0
396179,1.0
55419,1.0
44365,1.0
56024,1.0
471557,1.0
459205,1.0
12563,1.0
261590,1.0
198277,1.0
337168,1.0
506089,1.0
374026,1.0
36607,1.0
467941,1.0
341201,1.0
349127,1.0
437866,1.0
206049,1.0
242318,1.0
633310,1.0
10961,1.0
343310,1.0
252916,1.0
288159,1.0
205109,1.0
38481,1.0
55320,1.0
11842,1.0
193822,1.0
11408,1.0
348978,1.0
670559,1.0
395879,1.0
38646,1.0
55397,1.0
436190,1.0
207814,1.0
255899,1.0
367190,1.0
54819,1.0
470265,1.0
250655,1.0
206873,1.0
10970,1.0
459399,1.0
359089,1.0
11489,1.0
435709,1.0
53181,1.0
254915,1.0
406441,1.0
56602,1.0
103035,1.0
633569,1.0
11512,1.0
646609,1.0
242375,1.0
192720,1.0
385670,1.0
288528,1.0
231788,1.0
207397,1.0
45494,1.0
204169,1.0
335536,1.0
469877,1.0
12707,1.0
54678,1.0
469719,1.0
403218,1.0
548343,1.0
436205,1.0
251493,1.0
358785,1.0
436912,1.0
205413,1.0
406435,1.0
205461,1.0
452121,1.0
428022,1.0
191486

2025-01-19 10:05:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 10:05:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 10:05:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 10:05:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-19 10:05:01 - snowflake.connector.connection - INFO - closed
2025-01-19 10:05:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 10:05:02 - root - INFO - SQL:
SELECT MIN("metadata_date") AS "min_date", MAX("metadata_date") AS "max_date"
    FROM THE_MET.THE_MET.OBJECTS;
Results:
min_date,max_date
1486368016000000,1486368016000000

2025-01-19 10:05:02 - root - INFO - itercount: 0
2025-01-19 10:05:02 - root - INFO - Database Name: THE_MET
Schema Name: THE_MET
DDL describes table information.
,0
table_name,VISION_API_DATA
description,
DDL,"create or replace TABLE VISION_API_DATA (
	""object_id"" NUMBER(38,0),
	""faceAnnotations"" VARIANT,
	""landmarkAnnotations"" VARIANT,
	""cropHintsAnnotation"" VARIANT,
	""logoAnnotations"" VARIANT,
	""labelAnnotations"" VARIANT,
	""textAnnotations"" VARIANT,
	""fullTextAnnotation"" VARCHAR(16777216),
	""imagePropertiesAnnotation"" VARIANT,
	""safeSearchAnnotation"" VARCHAR(16777216),
	""webDetection"" VARIANT
);"

,1
table_name,IMAGES
description,
DDL,"create or replace TABLE IMAGES (
	""object_id"" NUMBER(38,0),
	""public_caption"" VARCHAR(16777216),
	""title"" VARCHAR(16777216),
	""original_image_url"" VARCHAR(16777216),
	""caption"" VARCHAR(16777216),
	""is_oasc"" BOOLEAN,
	""gcs_url"" VARCHAR(16777216)
);"

,2
table_name,OBJECTS
description,
DDL,"create or replace TABLE OBJECTS (
	""object_number"" VARCHAR(16777216),
	""is_highlight"" BOOLEAN,
	""is_public_domain"" BOOLEAN,
	""object_id"" NUMBER(38,0),
	""department"" VARCHAR(16777216),
	""object_name"" VARCHAR(16777216),
	""title"" VARCHAR(16777216),
	""culture"" VARCHAR(16777216),
	""period"" VARCHAR(16777216),
	""dynasty"" VARCHAR(16777216),
	""reign"" VARCHAR(16777216),
	""portfolio"" VARCHAR(16777216),
	""artist_role"" VARCHAR(16777216),
	""artist_prefix"" VARCHAR(16777216),
	""artist_display_name"" VARCHAR(16777216),
	""artist_display_bio"" VARCHAR(16777216),
	""artist_suffix"" VARCHAR(16777216),
	""artist_alpha_sort"" VARCHAR(16777216),
	""artist_nationality"" VARCHAR(16777216),
	""artist_begin_date"" VARCHAR(16777216),
	""artist_end_date"" VARCHAR(16777216),
	""object_date"" VARCHAR(16777216),
	""object_begin_date"" NUMBER(38,0),
	""object_end_date"" NUMBER(38,0),
	""medium"" VARCHAR(16777216),
	""dimensions"" VARCHAR(16777216),
	""credit_line"" VARCHAR(16777216),
	""geography_type"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""subregion"" VARCHAR(16777216),
	""locale"" VARCHAR(16777216),
	""locus"" VARCHAR(16777216),
	""excavation"" VARCHAR(16777216),
	""river"" VARCHAR(16777216),
	""classification"" VARCHAR(16777216),
	""rights_and_reproduction"" VARCHAR(16777216),
	""link_resource"" VARCHAR(16777216),
	""metadata_date"" NUMBER(38,0),
	""repository"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'THE_MET': {'THE_MET': ['IMAGES', 'OBJECTS', 'VISION_API_DATA']}}
Begin Exploring Related Columns
**Columns and their potential usage:**

- **`"object_id"`** (from OBJECTS and VISION_API_DATA): Used to join the OBJECTS and VISION_API_DATA tables.
- **`"title"`** (from OBJECTS): To select the title and filter objects where the title contains the word "book".
- **`"department"`** (from OBJECTS): To filter objects belonging to the department "The Libraries".
- **`"metadata_date"`** (from OBJECTS): To retrieve and format the metadata date into 'YYYY-MM-DD' format.
- **`"cropHintsAnnotation"`** (from VISION_API_DATA): VARIANT column containing crop hints data.
- **`"cropConfidence"`** (extracted from `cropHintsAnnotation`): To filter objects where the `cropConfidence` is greater than 0.5.

**Conditions that may be used:**

- WHERE `"department"` = 'The Libraries'
- WHERE `"title"` ILIKE '%book%'
- WHERE `"cropConfidence"` > 0.5

---

**SQL Queries to understand the data:**

1. **Retrieve distinct departments in the OBJECTS table:**

   ```sql
   SELECT DISTINCT "department"
   FROM THE_MET.THE_MET.OBJECTS
   LIMIT 1000;
   ```

2. **Find titles containing the word 'book' (case-insensitive):**

   ```sql
   SELECT DISTINCT "title"
   FROM THE_MET.THE_MET.OBJECTS
   WHERE "title" ILIKE '%book%'
   LIMIT 1000;
   ```

3. **Get object IDs and titles from the department 'The Libraries':**

   ```sql
   SELECT "object_id", "title"
   FROM THE_MET.THE_MET.OBJECTS
   WHERE "department" = 'The Libraries'
   LIMIT 1000;
   ```

4. **Explore the content of `cropHintsAnnotation` in VISION_API_DATA:**

   ```sql
   SELECT "object_id", "cropHintsAnnotation"
   FROM THE_MET.THE_MET.VISION_API_DATA
   WHERE "cropHintsAnnotation" IS NOT NULL
   LIMIT 1000;
   ```

5. **Flatten `cropHintsAnnotation` to extract the `confidence` values:**

   ```sql
   SELECT t."object_id", f.value:"confidence"::FLOAT AS "cropConfidence"
   FROM THE_MET.THE_MET.VISION_API_DATA t,
   LATERAL FLATTEN(input => t."cropHintsAnnotation":"cropHints") f
   LIMIT 1000;
   ```

6. **Find object IDs where `cropConfidence` is greater than 0.5:**

   ```sql
   SELECT DISTINCT t."object_id"
   FROM THE_MET.THE_MET.VISION_API_DATA t,
   LATERAL FLATTEN(input => t."cropHintsAnnotation":"cropHints") f
   WHERE f.value:"confidence"::FLOAT > 0.5
   LIMIT 1000;
   ```

7. **List distinct `metadata_date` values to understand their format:**

   ```sql
   SELECT DISTINCT "metadata_date"
   FROM THE_MET.THE_MET.OBJECTS
   LIMIT 1000;
   ```

8. **Attempt to format `metadata_date` into 'YYYY-MM-DD':**

   ```sql
   SELECT "object_id", TO_VARCHAR(TO_TIMESTAMP("metadata_date"), 'YYYY-MM-DD') AS "formatted_metadata_date"
   FROM THE_MET.THE_MET.OBJECTS
   LIMIT 1000;
   ```

9. **Identify object IDs present in both OBJECTS and VISION_API_DATA:**

   ```sql
   SELECT DISTINCT o."object_id"
   FROM THE_MET.THE_MET.OBJECTS o
   JOIN THE_MET.THE_MET.VISION_API_DATA v ON o."object_id" = v."object_id"
   LIMIT 1000;
   ```

10. **Retrieve object IDs and titles where the title contains 'book' and the department is 'The Libraries':**

    ```sql
    SELECT "object_id", "title"
    FROM THE_MET.THE_MET.OBJECTS
    WHERE "department" = 'The Libraries' AND "title" ILIKE '%book%'
    LIMIT 1000;
    ```

11. **Inspect the structure of `cropHintsAnnotation`:**

    ```sql
    SELECT t."object_id", f.value
    FROM THE_MET.THE_MET.VISION_API_DATA t,
    LATERAL FLATTEN(input => t."cropHintsAnnotation") f
    LIMIT 1000;
    ```

12. **Extract unique `cropConfidence` values:**

    ```sql
    SELECT DISTINCT f.value:"confidence"::FLOAT AS "cropConfidence"
    FROM THE_MET.THE_MET.VISION_API_DATA t,
    LATERAL FLATTEN(input => t."cropHintsAnnotation":"cropHints") f
    WHERE f.value:"confidence" IS NOT NULL
    LIMIT 1000;
    ```

13. **Check if `metadata_date` can be converted to a date format:**

    ```sql
    SELECT "metadata_date", TRY_TO_DATE("metadata_date"::VARCHAR) AS "date_value"
    FROM THE_MET.THE_MET.OBJECTS
    LIMIT 1000;
    ```

14. **Find object IDs with `cropConfidence` greater than 0.5 and their confidence values:**

    ```sql
    SELECT t."object_id", f.value:"confidence"::FLOAT AS "cropConfidence"
    FROM THE_MET.THE_MET.VISION_API_DATA t,
    LATERAL FLATTEN(input => t."cropHintsAnnotation":"cropHints") f
    WHERE f.value:"confidence"::FLOAT > 0.5
    LIMIT 1000;
    ```

15. **Determine the range of `metadata_date` values:**

    ```sql
    SELECT MIN("metadata_date") AS "min_date", MAX("metadata_date") AS "max_date"
    FROM THE_MET.THE_MET.OBJECTS;
    ```

These queries help understand the necessary columns and data needed to construct the final query for the task without directly providing the answer.Query:
SELECT DISTINCT "department"
   FROM THE_MET.THE_MET.OBJECTS
   LIMIT 1000;
Answer:
department
Asian Art
Islamic Art
Photographs
Medieval Art
The Cloisters
The Libraries
Arms and Armor
Costume Institute
European Paintings
Drawings and Prints
Greek and Roman Art
Musical Instruments
Ancient Near Eastern Art
Robert Lehman Collection
Modern and Contemporary Art
American Paintings and Sculpture
"Arts of Africa, Oceania, and the Americas"
American Decorative Arts
European Sculpture and Decorative Arts
Egyptian Art
Query:
SELECT DISTINCT "title"
   FROM THE_MET.THE_MET.OBJECTS
   WHERE "title" ILIKE '%book%'
   LIMIT 1000;
Answer:
Too long, hard cut:
title
明     郭詡     稱書圖     軸|Weighing Books
明     杜堇     伏生授經圖   軸|The Scholar Fu Sheng Transmitting the Book of Documents
画本宝能縷|Picture Book of Brocades with Precious Threads (Ehon takara no itosuji)
絵本松のしらべ|Picture Book on the Music of the Pine Trees (Ehon matsu no shirabe)
『和国諸職絵尽　諸織 絵本鏡』|A Picture Book Mirror of Various Occupations (Wakoku shoshoku ezukushi)
Ehon Asakayama|絵本浅香山|Picture Book: Mount Asaka (Ehon Asakayama)
Ehon Ogurayama|絵本小倉山|Picture Book: Ogura Hill (Ehon Ogurayama)
Ehon Himetsubaki|繪本女貞木|Picture Book: Camellia (Ehon Himetsubaki)
『繪本小倉山』|Picture Book of Ogura Hill (Ehon ogurayama)
『繪本小松原』|Picture Book of Komatsubara (Ehon komatsubara)
『寫山樓畫本』|Shazanrō (Bunchō) Picture Book (Shazanrō ehon)
『絵本時世粧』|Picture Book of Modern Figures of Fashion (Ehon imayō sugata)
絵本吾妻遊|Ehon Azuma asobi|Picture Book of Amusements of the Eastern Capital (Ehon Azuma asobi)
Ehon Momochidori Kyōka-awase|百千鳥狂歌合|Myriad Birds: Picture Book of Playful Verse (Momo chidori kyōka-awase)
潮干のつと|Gifts from the Ebb Tide (The Shell Book) (Shiohi no tsuto)
繪本四季花|Picture Book of Flowers of the Four Seasons (Ehon shiki no hana)
『画本狂歌山満多山』|Picture Book of Kyōka Poems: Mountains upon Mountains (Ehon kyōka yama mata yama)
『絵本和漢誉』|Picture Book on Heroes of China and Japan (Ehon wakan no homare)
絵本和歌夷 「龢謌夷」|Picture Book with Playful Poems for the Young God Ebisu
画本虫撰|Picture Book of Crawling Creatures (The Insect Book) (Ehon mushi erami)
『青楼繪本年中行事』|Yoshiwara Picture Book of New Year’s Festivities (Seirō ehon nenjū gyōji)
『暁斎漫画』|Kyōsai Sketchbook (Kyōsai manga)
"『閨の雛形』　正月|Plate from the Erotic Book Mounds of Dyed Colors: A Pattern Book for the Boudoir (Someiro no yama neya no hinagata), First Month"
"『画本虫撰』  「虻」「芋虫」|Horsefly (abu); Green Caterpillar, imomushi, from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』   「松虫」「虫蛍」|Tree cricket (Matsumushi); Firefly (Hotaru), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"画本虫撰　バッタと蟷螂|Cone-headed Grasshopper or Locust, (batta); Praying Mantis (Tōrō or Kamakiri), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"四季の花|Women on a Bridge, from the illustrated book Flowers of the Four Seasons"
"四季の花|A Child Lighting Fireworks, from the illustrated book Flowers of the Four Seasons"
"四季の花|Girls Getting on Board a Boat, from the illustrated book Flowers of the Four Seasons"
"四季の花|New Year's Games, from the printed book Flowers of the Four Seasons (Shiki no hana)"
"『雛形若菜初模様　玉や内　しら玉』|The Courtesan Shiratama of the Tamaya Brothel, from the series “A Pat-tern Book of the Year’s First Designs, Fresh as Spring Herbs” (“Hinagata wakana hatsu moyō”)"
"『雛形若菜初模様　四ツ目屋内　にしき木』|The Courtesan Nishikigi of the Yotsumeya Brothel, from the series “A Pattern Book of the Year’s First Designs, Fresh as Spring Herbs” (“Hinagata wakana hatsu moyō”)"
"『雛形若菜の初模様　扇屋内　七越』|The Courtesan Nanakoshi of the Ōgiya Brothel, from the series “A Pat-tern Book of the Year’s First Designs, Fresh as Spring Herbs” (“Hinagata wakana no hatsu moyō”)"
"『画本虫撰』   「けら」「はさみむし」|Mole Cricket (Kera); Earwig, (Hasami-mushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』「蝸牛」「轡虫」|Land Snail (Katatsumuri); Giant Katydid (Kutsuwamushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"Kamakura no Koshi|The Filial Son at Kamakura, From the Book: Sasekishu"
"『雛形若菜の初模様　つたや内　人まち』|The Courtesan Hitomachi of the Tsutaya Brothel, from the series “A Pat-tern Book of the Year’s First Designs, Fresh as Spring Herbs” (“Hinagata wakana no hatsu moyō”)"
[Woman in Robes Reading a Book]
[Seated Man Pointing to a Passage in an Open Book]
"Manuscript Illumination with the Visitation in an Initial D, from a Choir Book"
"Manuscript Leaf with Adoration of the Holy Name, from a Book of Hours"
The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans
"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work"
"London Chair-Makers' and Carvers' Book of Prices, for Workmanship..."
"The Oxford Drawing Book to which is added, Lessons in Flower Drawing"
A Booke of Christian Prayers
"Sketch Book Containing 182 drawings on 91 leaves. One of a series used by the artist on his Italian trip, 1750–52; Sketches made in Milan, Turin, Florence, and Rome."
Compendium of Architectural Books by Sebastiano Serlio (Books I-V)
The Architecture of A. Palladio in Four Books containing a Short Treatise on the Five Orders (L'Architecture de A. Palladio en quatre livres... / Il quattro libri dell'architettura)
Book of Designs [for Ironwork]
"St. Luke, seated on a cloud with an open book in both hands, a bull lying at his feet, from a series of the four evangelists after Agostino Veneziano, which are in turn after Giulio Romano"
"Dialectic: a young woman standing in a decorated interior and touching her right index finger to her left middle finger in a counting gesture, at he
Query:
SELECT "object_id", "title"
   FROM THE_MET.THE_MET.OBJECTS
   WHERE "department" = 'The Libraries'
   LIMIT 1000;
Answer:
Too long, hard cut:
object_id,title
682011,Dialogo sobre hua nova obra no Rio Tejo ...
681546,De' ragguagli di Parnaso: Centuria prima-seconda
681534,"Contes et nouvelles de Bocace florentin : traduction libre, accommodée au gout de ce temps, & enrichie de figures en taille-douce gravées par Mr. Romain de Hooge"
681389,"Uffizio della Settimana Santa : colle rubriche volgari, argomenti de' Salmi, spiegazione delle cerimonie e misterj, con osservazioni, e riflessioni divote dell'abate Alessandro Mazzinelli"
591832,"Academie de l'espee; ou se domonstrent par reigles mathématiques sur le fondement d'un cercle mystérieux, la théorie et pratique des vrais . . ."
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans
591831,"Descriptio pbvlicae gratvlationis, spectacvlorvm et lvdorvm, in aventv sereniss: Principis Ernesti Archidvcis Avstriae Dvcis Vrgvndiae"
591865,Morte d'Arthur
591848,"The Holy Land, Syria, Idumea, Arabia, Egypt & Nubia"
591863,"Catalogue of the Collection of Jewels and Precious Works of Art, the Property of  J. Pierpont Morgan"
681573,"Les oeuvres morales de Mr. Diderot : contenant son traité De l'amitié, et celui Des passions"
682013,L'eschole de Salerne en vers burlesques & duo poemata macaronica: de bello huguenotico: et De gestis magnanimi & prudentissimi Baldi
681149,Bibliorum Sacrorum Vulgatae versionis
681556,Mémoires du Comte de Grammont : histoire amoureuse de la cour d'Angleterre sous Charles II / par Antoine Hamilton ; préface et notes par Benjamin Pifteau
681388,"Traité de Plutarque, sur la manière de discerner un flatteur d'avec un ami et Le banquet des sept sages: dialogue du même auteur revu & corrigé sur des manuscrits de la Bibliothèque du roi; avec une version françoise & des notes"
680835,"L'art de former les jardins modernes, ou, L'art des jardins anglois : traduit de l'anglois : à quoi le traducteur a ajouté un discours préliminaire sur l'origine de l'art, des notes sur le texte, & une description détaillée des jardins de Stowe, accompagnée du plan"
681547,"De l'imitation de Jesus-Christ, traduction nouvelle ; ornée de figures en taille-douce"
681545,Contes et nouvelles en vers par Jean de la Fontaine
682014,Figures françoises et comiques nouvellement inventées par M. Watteau; Figures de modes dessinées et gravées à l'eau forte par Watteau; a terminées au buin par Thomassin le fils
681128,"Les aventures de Télémaque, fils d'Ulysse par M. de Fénélon ; avec figures en taille-douce, dessinées par MM. Cochin et Moreau le jeune"
682012,Epistole eroiche di P. Ovidio Nasone
681563,"Oeuvres de Moliere : avec des remarques grammaticales, des avertissemens et des observations sur chaque piéce, par M. Bret"
716648,"Planches pour l'Encyclopédie, ou pour le Dictionaire raisonné des sciences, des arts libéraux, et des arts méchaniques, avec leur explication"
705290,博古圖錄
715005,三禮圖
739504,Examples of Chinese ornament selected from objects in the South Kensington Museum and other collections
726677,"The sunshade, the glove, the muff"
716639,"Encyclopédie, ou Dictionnaire raisonné des sciences, des arts et des métiers, par une société de gens de lettres"
699505,"Dialogos de la pintvra : sv defensa, origen, essecia, definicion, modos y diferencias"
697348,Der aller durchleuchtigisten und grosmächtigen Kayser ... Königen ... Herren vom Adel ... Bildtnussen und kurtz Beschreibungen ihrer so wol in Fridts- als Kriegszzeiten verrichten fürnembsten Thaten und Handlungen : deren Waffen und Rüstungen ... auss allen Landen der Welt ... in dem Schloss Ombrass ... zu ewiger Gedächtnuss auffbehalten werden ...
681349,"Calendrier belgique, curieux et utile, contenant les evenemens historiques sur les jours de l'an, et les travaux à faire dans les jardins en chaque mois de l'année, la description des tableaux remarquables, que l'on trouve dans la ville de Gand, avec les noms des peintres pour l'annėe MDCCLXXII"
591837,Le pitture e sculture di Brescia che sono esposte al pubblico con un' appendice di alcune private gallerie
591862,"Edwin Davis French, A Memorial: His Life, His Art"
591836,Il Ritratto di Venezia
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found"
738466,Modern chromatics : with applications to art and industry
700032,Petri Gyllii De Bosporo thracio libri III ; Petri Gyllii De topographia Constantinopoleos
700050,"Traité de l'horlogerie, méchanique et pratique, approuvé par l'Academie royale des sciences"
738463,"The principles of harmony and contrast of colours, and their applications to the arts"
704714,Mr. Vanderbilt's house and collection
700240,"The cabinet-maker and upholsterer's guide, or, Repository of designs for every article of household furniture, in the newest and most approved taste : displaying a great variety of patterns for chairs, stools ... in the plainest and most enriched styles : with a scale to each, and an e
Query:
SELECT "object_id", "cropHintsAnnotation"
   FROM THE_MET.THE_MET.VISION_API_DATA
   WHERE "cropHintsAnnotation" IS NOT NULL
   LIMIT 1000;
Answer:
Too long, hard cut:
object_id,cropHintsAnnotation
205225,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 1063,
            ""y"": 0
          },
          {
            ""x"": 1063,
            ""y"": 1935
          },
          {
            ""x"": 0,
            ""y"": 1935
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 4.599999785423279e-01
    }
  ]
}"
357059,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 899,
            ""y"": 0
          },
          {
            ""x"": 899,
            ""y"": 795
          },
          {
            ""x"": 0,
            ""y"": 795
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.599999845027924e-01
    }
  ]
}"
333993,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 840,
            ""y"": 0
          },
          {
            ""x"": 840,
            ""y"": 1175
          },
          {
            ""x"": 0,
            ""y"": 1175
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.999999761581421e-01
    }
  ]
}"
38169,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 1499,
            ""y"": 0
          },
          {
            ""x"": 1499,
            ""y"": 1999
          },
          {
            ""x"": 0,
            ""y"": 1999
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 1.599999904632568e+00
    }
  ]
}"
44833,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 1499,
            ""y"": 0
          },
          {
            ""x"": 1499,
            ""y"": 1999
          },
          {
            ""x"": 0,
            ""y"": 1999
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 1.230000019073486e+00
    }
  ]
}"
548510,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 1014,
            ""y"": 0
          },
          {
            ""x"": 1014,
            ""y"": 1456
          },
          {
            ""x"": 0,
            ""y"": 1456
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 2.829999923706055e+00
    }
  ]
}"
391673,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2603,
            ""y"": 0
          },
          {
            ""x"": 2603,
            ""y"": 2959
          },
          {
            ""x"": 0,
            ""y"": 2959
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 5.699999928474426e-01
    }
  ]
}"
387059,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2742,
            ""y"": 0
          },
          {
            ""x"": 2742,
            ""y"": 3651
          },
          {
            ""x"": 0,
            ""y"": 3651
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.499999940395355e-01
    }
  ]
}"
74832,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2911,
            ""y"": 0
          },
          {
            ""x"": 2911,
            ""y"": 3879
          },
          {
            ""x"": 0,
            ""y"": 3879
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 4.799999892711639e-01
    }
  ]
}"
17571,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2879,
            ""y"": 0
          },
          {
            ""x"": 2879,
            ""y"": 3838
          },
          {
            ""x"": 0,
            ""y"": 3838
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 1.459999918937683e+00
    }
  ]
}"
437454,"{

Query:
SELECT t."object_id", f.value:"confidence"::FLOAT AS "cropConfidence"
   FROM THE_MET.THE_MET.VISION_API_DATA t,
   LATERAL FLATTEN(input => t."cropHintsAnnotation":"cropHints") f
   LIMIT 1000;
Answer:
Too long, hard cut:
object_id,cropConfidence
463536,1.0
286038,1.0
467486,1.0
386444,1.0
343968,1.0
288535,1.0
17449,1.0
343402,1.0
261387,1.0
342591,1.0
263135,1.0
361703,1.0
729624,1.0
385957,1.0
659124,1.0
345721,1.0
196356,1.0
339707,1.0
367415,1.0
398595,1.0
55574,1.0
197750,1.0
229095,1.0
471848,1.0
436731,1.0
198587,1.0
340058,1.0
349162,1.0
452670,1.0
342501,1.0
37895,1.0
399212,1.0
54652,1.0
11777,1.0
459002,1.0
11372,1.0
397694,1.0
206589,1.0
338515,1.0
364382,1.0
436770,1.0
10401,1.0
64534,1.0
471995,1.0
385089,1.0
342748,1.0
436911,1.0
102243,1.0
11798,1.0
11707,1.0
437490,1.0
438820,1.0
437703,1.0
475487,1.0
459040,1.0
291887,1.0
436664,1.0
463545,1.0
191777,1.0
349309,1.0
467808,1.0
205239,1.0
58026,1.0
269254,1.0
428639,1.0
260058,1.0
237070,1.0
260182,1.0
237754,1.0
45445,1.0
60060,1.0
403086,1.0
700206,1.0
371456,1.0
464151,1.0
187761,1.0
188903,1.0
398499,1.0
204625,1.0
206168,1.0
434111,1.0
393331,1.0
362267,1.0
16665,1.0
288561,1.0
250549,1.0
343201,1.0
1683,1.0
387537,1.0
391793,1.0
399237,1.0
14942,1.0
55423,1.0
195760,1.0
260113,1.0
37125,1.0
364839,1.0
366887,1.0
463765,1.0
451972,1.0
189163,1.0
56753,1.0
203111,1.0
190623,1.0
360642,1.0
202343,1.0
36707,1.0
189644,1.0
382454,1.0
56027,1.0
390689,1.0
59185,1.0
189700,1.0
194324,1.0
386145,1.0
642888,1.0
431358,1.0
302131,1.0
46445,1.0
268128,1.0
51416,1.0
286615,1.0
387541,1.0
367468,1.0
392932,1.0
434603,1.0
260140,1.0
269271,1.0
437069,1.0
460208,1.0
473465,1.0
156808,1.0
464299,1.0
204722,1.0
454344,1.0
36654,1.0
41933,1.0
438026,1.0
11274,1.0
189712,1.0
383935,1.0
63832,1.0
399691,1.0
442749,1.0
625354,1.0
38582,1.0
339119,1.0
55199,1.0
342463,1.0
227026,1.0
407167,1.0
704827,1.0
435691,1.0
436738,1.0
337665,1.0
377467,1.0
459019,1.0
271746,1.0
631422,1.0
436759,1.0
365816,1.0
12731,1.0
451283,1.0
208809,1.0
399545,1.0
249164,1.0
435766,1.0
73439,1.0
339543,1.0
10337,1.0
459015,1.0
437422,1.0
667926,1.0
459023,1.0
249232,1.0
435702,1.0
467508,1.0
435754,1.0
391053,1.0
350970,1.0
369533,1.0
453683,1.0
356476,1.0
436103,1.0
488733,1.0
10389,1.0
58263,1.0
13050,0.29999998211860657
37993,1.0
436892,1.0
656826,1.0
392687,1.0
359151,1.0
337761,1.0
361613,1.0
730790,1.0
286173,1.0
269253,1.0
344140,1.0
260348,1.0
388833,1.0
712946,1.0
260126,1.0
436900,1.0
339559,1.0
342502,1.0
54660,1.0
437004,1.0
194541,1.0
260175,0.5999999642372131
363737,1.0
2783,1.0
452125,1.0
199486,1.0
716639,1.0
54849,1.0
310365,1.0
37807,1.0
436802,1.0
389888,1.0
551108,1.0
435653,1.0
471218,1.0
435763,1.0
436835,1.0
266256,1.0
437268,1.0
436850,1.0
12552,1.0
200564,1.0
260352,1.0
198903,1.0
190119,1.0
335497,1.0
294508,1.0
461549,1.0
206726,1.0
386450,1.0
464286,1.0
471559,1.0
679466,1.0
189944,1.0
471122,1.0
193428,1.0
203376,1.0
187556,1.0
5207,1.0
446583,1.0
11471,1.0
44377,1.0
44384,1.0
682991,1.0
396179,1.0
55419,1.0
44365,1.0
56024,1.0
395469,1.0
342852,1.0
717610,1.0
400806,1.0
398754,1.0
436661,1.0
650943,1.0
193649,1.0
308544,1.0
37881,1.0
371350,1.0
480520,1.0
469947,1.0
291865,1.0
391445,1.0
339498,1.0
342882,1.0
342608,1.0
352216,0.29999998211860657
306752,1.0
271733,1.0
73626,1.0
372777,1.0
365590,1.0
10791,1.0
364281,1.0
365693,1.0
10928,1.0
387577,1.0
370771,1.0
37186,1.0
393209,1.0
337266,1.0
388957,1.0
394628,1.0
339515,1.0
414492,1.0
383921,1.0
410182,1.0
338422,0.29999998211860657
369156,1.0
348596,1.0
678732,1.0
203203,1.0
340976,1.0
261016,1.0
410050,1.0
400836,1.0
467466,1.0
467935,1.0
409982,1.0
414746,1.0
334626,1.0
254207,1.0
4249,1.0
4199,1.0
4209,1.0
4241,1.0
435719,1.0
11603,1.0
56748,1.0
403635,1.0
340262,1.0
15089,1.0
685801,1.0
397498,1.0
472322,1.0
471962,1.0
460419,1.0
260285,1.0
726543,1.0
366993,1.0
55968,1.0
285781,1.0
544689,1.0
544693,0.29999998211860657
394436,1.0
50799,1.0
345808,1.0
208998,1.0
189298,1.0
623053,1.0
391175,1.0
53926,1.0
435834,1.0
246992,0.29999998211860657
322367,1.0
412823,1.0
387572,1.0
73555,1.0
339492,1.0
357054,1.0
414695,1.0
391517,1.0
392595,1.0
428774,1.0
10466,1.0
335405,1.0
371555,1.0
368343,1.0
261801,1.0
54624,1.0
394340,1.0
285465,1.0
54870,1.0
194110,1.0
428755,1.0
196160,1.0
15025,1.0
549533,1.0
263193,1.0
242193,1.0
343111,1.0
189551,1.0
465955,1.0
737547,1.0
363904,1.0
364069,1.0
54499,1.0
470282,1.0
288515,1.0
337263,1.0
45241,1.0
645240,1.0
416247,1.0
348790,1.0
339554,1.0
250968,1.0
206819,1.0
543873,1.0
471055,1.0
623067,1.0
471557,1.0
459205,1.0
12563,1.0
261590,1.0
198277,1.0
337168,1.0
506089,1.0
374026,1.0
36607,1.0
467941,1.0
341201,1.0
349127,1.0
437866,1.0
206049,1.0
242318,1.0
633310,1.0
10961,1.0
343310,1.0
252916,1.0
288159,1.0
205109,1.0
38481,1.0
55320,1.0
11842,1.0
193822,1.0
11408,1.0
348978,1.0
670559,1.0
395879,1.0
38646,1.0
55397,1.0
436190,1.0
207814,1.0
255899,1.0
367190,1.0
54819,1.0
470265,1.0
250655,1.0
206873,1.0
10970,1.0
459399,1.0
359089,1.0
11489,1.0
435709,1.0
53181,1.0
254915,1.0
406441,1.0
56602,1.0
103035,1.0
633569,1.0
11512,1.0
646609,1.0
242375,1.0
192720,1.0
385670,1.0
45493,0.29999998211860657
288528,1.0
231788,1.0
207397,1.0
45494,1.0
204169,1.0
335536,1.0
469877,1.
Query:
SELECT DISTINCT t."object_id"
   FROM THE_MET.THE_MET.VISION_API_DATA t,
   LATERAL FLATTEN(input => t."cropHintsAnnotation":"cropHints") f
   WHERE f.value:"confidence"::FLOAT > 0.5
   LIMIT 1000;
Answer:
Too long, hard cut:
object_id
437177
196587
399542
209272
397692
56835
435852
464124
463742
199485
466107
370485
382755
505616
646460
55273
468318
467471
388772
390083
12917
399213
60164
437798
198906
37943
449008
469940
246807
201588
435745
459039
466561
188970
10077
437740
437722
73415
438387
367538
266259
361830
299311
199487
186804
13043
463038
285789
286636
12717
459045
460152
55323
188885
306162
227723
471903
437330
679157
54569
44359
269243
460151
436760
55266
186798
471976
361703
10401
436911
459040
45445
343201
197750
467808
434111
55423
37125
390689
383935
249232
730790
389888
385089
451972
382454
156808
55199
459015
453683
436835
339559
436850
900
364208
288214
186800
386355
398521
464306
437819
438025
469932
193450
386457
392523
383358
452017
437855
704977
336882
291921
229601
267233
442183
156426
459005
392464
435848
437100
445280
436048
10184
339941
349133
55746
339836
269236
338973
45249
436410
380487
10353
446577
464275
466201
367415
51416
464286
436840
209042
156804
470874
11627
363260
717610
37186
467466
414746
4209
467941
205109
342608
678732
11603
340262
412823
263193
54499
348790
506089
10961
436190
358365
645240
374026
242318
435709
192720
436205
428022
261480
261347
54678
189351
291939
335751
197997
187145
203576
467523
436461
195345
415389
461448
383686
349097
392843
460166
291869
369299
670999
205194
469891
435585
437414
708058
357164
271736
437555
386451
398655
288154
291873
398594
435682
17187
390698
460077
334306
334884
435908
269875
716365
285466
392618
436918
702752
291890
37141
435899
205267
201454
736059
260350
294515
370452
464588
436261
652270
36668
382932
435822
205630
292002
44376
659502
390467
437250
262992
712180
288162
455041
467462
548438
204272
437650
437777
399439
190537
635401
339942
436099
446285
657683
650860
204484
468105
470346
436604
435727
668074
269252
55879
466277
371107
416247
76971
387496
56742
260112
54878
645448
227763
238577
291878
385063
54827
437491
682989
55262
437028
11133
341770
269251
333993
437454
467679
288012
384064
436542
193614
394309
458996
488853
326695
334772
402847
392327
460207
392937
37385
698490
288126
290476
4205
4200
371590
45261
351416
45322
478972
4203
343737
408902
13245
547690
207160
358160
342743
239425
471068
286833
282191
451258
204267
344913
249180
4140
436519
307013
643540
435947
549501
385669
49567
367000
436267
13345
12554
435984
6788
365096
242035
195965
447801
388713
114709
395492
263206
625912
13786
403077
390688
471824
644110
342531
316594
455057
306204
57649
248809
376674
289329
286582
199990
36841
252955
656747
32840
73429
436537
464277
359455
407171
45313
32830
268354
460236
342525
352198
339675
670908
56756
436180
335942
194181
471942
198992
463555
459059
385969
359909
458998
684336
336508
464135
287770
260185
288160
286165
63812
463039
199489
260115
399217
393290
260118
189964
291857
696392
335420
388970
294445
268109
438467
468317
301973
430870
55216
55209
288532
366522
437912
437336
437743
459198
437244
464281
361605
467648
390082
20495
459950
467640
285692
186317
200837
12644
464494
707785
458992
44355
466192
306155
392469
371141
56764
289308
335156
321519
324791
255905
323706
504881
8743
324142
124497
228544
32356
556947
44940
420483
190652
244063
588371
558135
243821
252165
323259
38049
25286
244259
308782
43289
323884
569903
552199
590424
229721
544004
317305
648081
557955
35189
323387
324072
62087
250417
26255
254830
454117
250597
501525
467174
467272
55154
58699
317314
466713
467598
551367
308195
236558
644994
416702
339097
8737
29656
61141
250605
30764
251333
549438
323125
501529
382668
422120
323227
23161
215003
206317
251409
550065
252180
473637
468786
309118
407283
243473
250629
409746
241776
229631
206361
549664
249867
478524
647495
471704
5651
321818
410450
250377
454854
590342
29763
448815
214070
44089
732470
5197
369701
244400
196718
251909
243009
65240
214051
732474
643563
443874
325626
8748
16667
268025
505093
548861
559122
427207
257299
23703
548136
248532
474836
323546
466661
250374
23444
565430
325258
23506
14126
556817
736910
444799
324376
474894
474750
3787
588372
32784
705848
250472
252756
479299
35004
309094
58920
323417
244377
444793
23099
559161
694344
75040
414762
70332
452664
326893
59438
323663
503616
261880
73223
372612
307560
307625
250557
478211
660767
326480
244432
317511
471708
58645
465486
225109
448285
394039
742354
452164
452047
449092
448173
59214
32782
399741
428374
445463
68246
547707
503951
546465
448788
8732
216529
209933
33412
651980
739651
33752
545529
470123
420761
406892
450296
406565
251904
257596
571801
123184
546310
250381
41742
551271
567651
9726
323101
650913
644915
40319
315806
549234
559517
26242
8008
75134
61355
316862
504525
246364
309954
570795
213912
569882
251913
25340
250608
222061
726169
570808
450185
309007
569911
467258
252142
213791
213870
325004
726170
565407
287938
327133
268089
78257
269328
503247
248227
717663
251901
326733
308193
729590
264895
17804
647084
203905
186377
697455
647054
317330
197389
324499
246230
343063
317033
551458
472837
45562
407432
502969
502136
Query:
SELECT DISTINCT "metadata_date"
   FROM THE_MET.THE_MET.OBJECTS
   LIMIT 1000;
Answer:
metadata_date
1486368016000000
Query:
SELECT "object_id", TO_VARCHAR(TO_TIMESTAMP("metadata_date"), 'YYYY-MM-DD') AS "formatted_metadata_date"
   FROM THE_MET.THE_MET.OBJECTS
   LIMIT 1000;
Answer:
Too long, hard cut:
object_id,formatted_metadata_date
646996,47103097-05-20
77916,47103097-05-20
38009,47103097-05-20
37988,47103097-05-20
74660,47103097-05-20
74674,47103097-05-20
74675,47103097-05-20
74677,47103097-05-20
74685,47103097-05-20
65595,47103097-05-20
73261,47103097-05-20
38042,47103097-05-20
39894,47103097-05-20
64891,47103097-05-20
65590,47103097-05-20
65594,47103097-05-20
40445,47103097-05-20
45063,47103097-05-20
40069,47103097-05-20
40070,47103097-05-20
37964,47103097-05-20
75084,47103097-05-20
75085,47103097-05-20
75086,47103097-05-20
75087,47103097-05-20
75088,47103097-05-20
75089,47103097-05-20
75090,47103097-05-20
75091,47103097-05-20
75092,47103097-05-20
75093,47103097-05-20
75094,47103097-05-20
75095,47103097-05-20
75096,47103097-05-20
75097,47103097-05-20
75098,47103097-05-20
75099,47103097-05-20
75100,47103097-05-20
75101,47103097-05-20
75102,47103097-05-20
75103,47103097-05-20
75104,47103097-05-20
75105,47103097-05-20
75106,47103097-05-20
75107,47103097-05-20
75108,47103097-05-20
75109,47103097-05-20
75110,47103097-05-20
75111,47103097-05-20
75112,47103097-05-20
75113,47103097-05-20
75114,47103097-05-20
75115,47103097-05-20
75116,47103097-05-20
75117,47103097-05-20
75118,47103097-05-20
75119,47103097-05-20
75120,47103097-05-20
75121,47103097-05-20
75122,47103097-05-20
75123,47103097-05-20
75124,47103097-05-20
75125,47103097-05-20
75126,47103097-05-20
75127,47103097-05-20
75128,47103097-05-20
75129,47103097-05-20
75130,47103097-05-20
75131,47103097-05-20
75132,47103097-05-20
75133,47103097-05-20
75134,47103097-05-20
75135,47103097-05-20
75136,47103097-05-20
75137,47103097-05-20
75138,47103097-05-20
75139,47103097-05-20
75140,47103097-05-20
75141,47103097-05-20
75142,47103097-05-20
75143,47103097-05-20
75145,47103097-05-20
75146,47103097-05-20
75147,47103097-05-20
75148,47103097-05-20
75149,47103097-05-20
75150,47103097-05-20
75151,47103097-05-20
75152,47103097-05-20
75153,47103097-05-20
54912,47103097-05-20
38448,47103097-05-20
40429,47103097-05-20
40432,47103097-05-20
73188,47103097-05-20
74683,47103097-05-20
72589,47103097-05-20
74656,47103097-05-20
64046,47103097-05-20
39899,47103097-05-20
36145,47103097-05-20
49665,47103097-05-20
36130,47103097-05-20
36435,47103097-05-20
36036,47103097-05-20
36072,47103097-05-20
49133,47103097-05-20
65620,47103097-05-20
40021,47103097-05-20
49453,47103097-05-20
49134,47103097-05-20
65075,47103097-05-20
41468,47103097-05-20
40507,47103097-05-20
40052,47103097-05-20
35995,47103097-05-20
35999,47103097-05-20
36003,47103097-05-20
45786,47103097-05-20
73669,47103097-05-20
49179,47103097-05-20
49226,47103097-05-20
51727,47103097-05-20
51705,47103097-05-20
51528,47103097-05-20
51656,47103097-05-20
51644,47103097-05-20
36129,47103097-05-20
51770,47103097-05-20
64029,47103097-05-20
60764,47103097-05-20
51902,47103097-05-20
64045,47103097-05-20
36439,47103097-05-20
40285,47103097-05-20
40107,47103097-05-20
40180,47103097-05-20
40194,47103097-05-20
40060,47103097-05-20
40058,47103097-05-20
45684,47103097-05-20
45746,47103097-05-20
39766,47103097-05-20
45749,47103097-05-20
44574,47103097-05-20
45775,47103097-05-20
45780,47103097-05-20
51865,47103097-05-20
77914,47103097-05-20
48875,47103097-05-20
48955,47103097-05-20
48954,47103097-05-20
49025,47103097-05-20
49029,47103097-05-20
56553,47103097-05-20
41780,47103097-05-20
39625,47103097-05-20
48931,47103097-05-20
48928,47103097-05-20
48959,47103097-05-20
49129,47103097-05-20
49146,47103097-05-20
49147,47103097-05-20
49163,47103097-05-20
51894,47103097-05-20
36132,47103097-05-20
51900,47103097-05-20
75814,47103097-05-20
54308,47103097-05-20
55495,47103097-05-20
49473,47103097-05-20
35987,47103097-05-20
44570,47103097-05-20
40105,47103097-05-20
40509,47103097-05-20
42329,47103097-05-20
39918,47103097-05-20
39919,47103097-05-20
40103,47103097-05-20
40104,47103097-05-20
41777,47103097-05-20
41860,47103097-05-20
40018,47103097-05-20
41778,47103097-05-20
41782,47103097-05-20
63196,47103097-05-20
63185,47103097-05-20
49047,47103097-05-20
50549,47103097-05-20
53924,47103097-05-20
53925,47103097-05-20
53926,47103097-05-20
53927,47103097-05-20
53928,47103097-05-20
53929,47103097-05-20
42323,47103097-05-20
36236,47103097-05-20
36098,47103097-05-20
72711,47103097-05-20
72712,47103097-05-20
36201,47103097-05-20
44567,47103097-05-20
49617,47103097-05-20
36208,47103097-05-20
36205,47103097-05-20
36206,47103097-05-20
36211,47103097-05-20
36210,47103097-05-20
36216,47103097-05-20
49629,47103097-05-20
49630,47103097-05-20
41504,47103097-05-20
49603,47103097-05-20
49604,47103097-05-20
49605,47103097-05-20
49607,47103097-05-20
36202,47103097-05-20
49608,47103097-05-20
49606,47103097-05-20
49614,47103097-05-20
49615,47103097-05-20
49663,47103097-05-20
49664,47103097-05-20
49626,47103097-05-20
49627,47103097-05-20
36222,47103097-05-20
36224,47103097-05-20
49623,47103097-05-20
40311,47103097-05-20
45652,47103097-05-20
39901,47103097-05-20
39959,47103097-05-20
51762,47103097-05-20
40062,47103097-05-20
40057,47103097-05-20
40094,47103097-05-20
36052,471
Query:
SELECT DISTINCT o."object_id"
   FROM THE_MET.THE_MET.OBJECTS o
   JOIN THE_MET.THE_MET.VISION_API_DATA v ON o."object_id" = v."object_id"
   LIMIT 1000;
Answer:
Too long, hard cut:
object_id
2704
308689
546942
204339
343127
578666
202859
104470
201749
239562
113100
393606
449595
308332
546355
226289
568716
90391
388318
453272
196116
340669
506171
447997
310223
214796
325122
345467
75091
9595
438947
681278
285647
559821
189458
562094
37216
12182
445763
450642
5419
199611
227360
67391
59408
247783
55583
62974
662608
200413
309966
406563
188922
203055
478568
371380
555174
72238
44426
261845
124281
216309
21919
40927
457103
706476
47379
463793
198114
450362
325404
390599
422167
198525
58006
195003
119817
114692
457652
240352
209420
188252
42427
552608
437585
410925
551448
407097
194942
407117
188790
336026
5289
50060
502513
307663
316963
246607
261842
12440
245736
557048
244998
543956
188673
437278
459218
287224
104125
33416
55166
68945
237794
339364
371330
229917
363718
248996
339329
190932
2408
222298
322041
53294
2416
470655
239820
53829
187333
340883
547214
422679
288483
342718
242983
370772
252367
58774
483721
823
186301
66746
191804
255180
251134
693149
403983
548918
22067
196881
411307
67933
314494
26327
12834
414878
38406
550160
547995
412508
205025
327706
37915
259152
443429
336919
204903
464137
465537
326569
15807
323504
460185
471572
355297
464566
481037
334118
35629
403876
325661
457316
67544
565871
251402
230414
244603
226694
192752
9524
70494
254598
157645
26505
12536
459756
364657
546319
562783
680079
90509
35060
367283
49457
377640
356327
307641
11625
460911
56864
463400
247677
228953
238890
706447
200075
409358
361716
205579
287227
50567
202452
391036
225069
373934
209332
173651
457436
444199
58940
69748
391283
639405
316578
82106
12592
479199
339570
376110
444840
23396
204157
378036
1218
119566
575747
196820
248903
237244
338109
342218
201341
50910
358404
448856
58068
36012
259583
382652
197660
206121
449010
195268
437637
323960
418593
450455
187528
417082
569414
554596
545033
451359
209811
245345
454666
67545
57442
504201
43187
450132
245457
69832
263219
243795
345033
215128
429577
559797
443619
394016
252392
342590
343059
3115
219215
571945
465583
257058
413447
345491
453299
196921
588380
189855
210720
52709
365723
50573
400084
662923
22965
624385
451933
58507
400876
475243
19022
45251
659539
483311
443823
55014
396339
204773
659792
217269
327288
63819
59148
55482
451734
65947
68385
156171
27144
226358
548995
445502
416148
36888
215354
222421
465046
443778
318649
469942
577208
121214
407562
206032
223055
66737
364110
552304
545185
396961
336767
43157
671046
214228
230476
219561
12607
213469
322209
325260
222656
467233
204646
37256
261879
369623
13261
372991
103642
222954
549709
193590
359471
86410
652440
69419
198916
550253
8247
248778
3984
415234
255152
446239
446349
203436
288478
223568
347404
16479
156406
339104
358955
322240
386602
244132
214012
59434
287368
446749
544918
249764
209715
193609
66211
217194
53301
62094
437311
408555
22070
21304
694395
463240
112933
14307
214013
222763
503844
247850
68909
386092
680464
267987
56069
361656
52471
408387
355377
227192
479299
549079
324194
186434
243266
60626
340690
264982
573130
363050
5179
559049
675898
666123
22876
56922
548861
46970
244892
241006
710927
360519
219348
62198
571089
466754
317567
623386
360743
256149
705848
623258
37980
369251
422120
158967
549444
45222
423149
223496
447928
13597
198158
60125
3858
348339
336339
253044
124189
45274
256062
436274
384888
251197
51689
428762
249005
339191
36657
72223
201353
64336
1999
338222
363506
570666
68355
340835
19099
191825
115295
25998
192362
308667
13749
406656
193723
55737
412057
47853
39371
505681
13761
247626
216991
54418
394031
227841
43810
477767
50859
34910
656846
393665
435727
37186
54499
460166
1130
652955
389415
243899
62907
44118
205984
243818
470868
190588
222408
247468
562061
193502
356271
70179
553616
45063
192669
395306
30850
462952
464474
39806
194633
446891
66172
5769
415672
436279
227393
309186
68808
505378
445280
339941
549152
246399
644197
544006
26598
51478
400955
505106
545016
11488
3441
549703
216725
412823
451149
323613
240089
369242
5850
267665
660008
241423
168761
228808
436436
373153
240128
196999
51416
10353
62227
26309
239155
458958
21185
209571
436461
90999
219262
466626
307937
548969
403674
464905
384959
14626
323353
447006
377434
251053
684053
192080
463039
370485
661791
16319
369356
341660
324310
386617
192048
26568
5133
251138
414932
364742
348771
70670
316713
310218
69717
685806
341439
670645
204120
60283
414949
224317
444423
659075
43039
327381
554326
324800
553870
202382
65837
316818
415603
336855
321658
13799
221970
463870
385484
221857
437273
40871
346399
400618
443296
207934
10141
465980
419903
407801
567611
65986
410444
570431
22394
218093
435788
395546
552455
545203
383824
334422
66524
199891
2487
704860
448081
400020
467909
452027
53281
26529
168342
13074
47115
69838
200309
238889
343212
671523
398043
51150
475263
36512
544238
13621
411473
560420
55814
243638
21355
463702
383677
476394
325897
274
546352
221309
288136
460320
54328
336529
406730
342876
548469
22768
7913
202457
548114
242380
221130
386408
446115
474512
251544
4
Query:
SELECT "object_id", "title"
    FROM THE_MET.THE_MET.OBJECTS
    WHERE "department" = 'The Libraries' AND "title" ILIKE '%book%'
    LIMIT 1000;
Answer:
object_id,title
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found"
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts"
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work"
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc."
Query:
SELECT t."object_id", f.value
    FROM THE_MET.THE_MET.VISION_API_DATA t,
    LATERAL FLATTEN(input => t."cropHintsAnnotation") f
    LIMIT 1000;
Answer:
Too long, hard cut:
object_id,VALUE
395469,"[
  {
    ""boundingPoly"": {
      ""vertices"": [
        {
          ""x"": 403,
          ""y"": 0
        },
        {
          ""x"": 2247,
          ""y"": 0
        },
        {
          ""x"": 2247,
          ""y"": 2892
        },
        {
          ""x"": 403,
          ""y"": 2892
        }
      ]
    },
    ""confidence"": 1.000000000000000e+00,
    ""importanceFraction"": 3.299999833106995e-01
  }
]"
342852,"[
  {
    ""boundingPoly"": {
      ""vertices"": [
        {
          ""x"": 0,
          ""y"": 0
        },
        {
          ""x"": 3422,
          ""y"": 0
        },
        {
          ""x"": 3422,
          ""y"": 2475
        },
        {
          ""x"": 0,
          ""y"": 2475
        }
      ]
    },
    ""confidence"": 1.000000000000000e+00,
    ""importanceFraction"": 3.499999940395355e-01
  }
]"
717610,"[
  {
    ""boundingPoly"": {
      ""vertices"": [
        {
          ""x"": 0,
          ""y"": 0
        },
        {
          ""x"": 1632,
          ""y"": 0
        },
        {
          ""x"": 1632,
          ""y"": 1112
        },
        {
          ""x"": 0,
          ""y"": 1112
        }
      ]
    },
    ""confidence"": 1.000000000000000e+00,
    ""importanceFraction"": 3.599999845027924e-01
  }
]"
400806,"[
  {
    ""boundingPoly"": {
      ""vertices"": [
        {
          ""x"": 0,
          ""y"": 0
        },
        {
          ""x"": 3723,
          ""y"": 0
        },
        {
          ""x"": 3723,
          ""y"": 2579
        },
        {
          ""x"": 0,
          ""y"": 2579
        }
      ]
    },
    ""confidence"": 1.000000000000000e+00,
    ""importanceFraction"": 3.499999940395355e-01
  }
]"
398754,"[
  {
    ""boundingPoly"": {
      ""vertices"": [
        {
          ""x"": 0,
          ""y"": 0
        },
        {
          ""x"": 2403,
          ""y"": 0
        },
        {
          ""x"": 2403,
          ""y"": 3444
        },
        {
          ""x"": 0,
          ""y"": 3444
        }
      ]
    },
    ""confidence"": 1.000000000000000e+00,
    ""importanceFraction"": 1.389999985694885e+00
  }
]"
436661,"[
  {
    ""boundingPoly"": {
      ""vertices"": [
        {
          ""x"": 187,
          ""y"": 0
        },
        {
          ""x"": 3431,
          ""y"": 0
        },
        {
          ""x"": 3431,
          ""y"": 3617
        },
        {
          ""x"": 187,
          ""y"": 3617
        }
      ]
    },
    ""confidence"": 1.000000000000000e+00,
    ""importanceFraction"": 5.899999737739563e-01
  }
]"
650943,"[
  {
    ""boundingPoly"": {
      ""vertices"": [
        {
          ""x"": 298,
          ""y"": 0
        },
        {
          ""x"": 2008,
          ""y"": 0
        },
        {
          ""x"": 2008,
          ""y"": 3064
        },
        {
          ""x"": 298,
          ""y"": 3064
        }
      ]
    },
    ""confidence"": 1.000000000000000e+00,
    ""importanceFraction"": 6.100000143051147e-01
  }
]"
193649,"[
  {
    ""boundingPoly"": {
      ""vertices"": [
        {
          ""x"": 0,
          ""y"": 0
        },
        {
          ""x"": 2977,
          ""y"": 0
        },
        {
          ""x"": 2977,
          ""y"": 3721
        },
        {
          ""x"": 0,
          ""y"": 3721
        }
      ]
    },
    ""confidence"": 1.000000000000000e+00,
    ""importanceFraction"": 3.599999845027924e-01
  }
]"
308544,"[
  {
    ""boundingPoly"": {
      ""vertices"": [
        {
          ""x"": 0,
          ""y"": 0
        },
        {
          ""x"": 3140,
          ""y"": 0
        },
        {
          ""x"": 3140,
          ""y"": 3999
        },
        {
          ""x"": 0,
          ""y"": 3999
        }
      ]
    },
    ""confidence"": 1.000000000000000e+00,
    ""importanceFraction"": 5.500000119209290e-01
  }
]"
37881,"[
  {
    ""boundingPoly"": {
      ""vertices"": [
        {
          ""x"": 0,
          ""y"": 0
        },
        {
          ""x"": 2883,
          ""y"": 0
        },
        {
          ""x"": 2883,
          ""y"": 3739
        },
        {
          ""x"": 0,
          ""y"": 3739
        }
      ]
    },
    ""confidence"": 1.000000000000000e+00,
    ""importanceFraction"": 3.599999845027924e-01
  }
]"
371350,"[
  {
    ""boundingPoly"": {
      ""vertices"": [
        {
          ""x"": 0,
          ""y"": 0
        },
        {
          ""x"": 2640,
          ""y"": 0
        },
        {
          ""x"": 2640,
          ""y"": 3574
        },
        {
          ""x"": 0,
          ""y"": 3574
        }
      ]
    },
    ""confidence"": 1.000000000000000e+00,
    ""importanceFraction"": 4.499999880790710e-01
  }
]"
480520,"[
  {
    ""boundingPoly"": {
      ""vertices"": [
        {
          ""x"": 535,
          ""y"": 0
        },
        {
          ""x"": 2589,
          ""y"": 0
        },
        {
          ""x"": 2589,
          ""y"": 3721
        },
        {
          ""x"": 535,
    
Query:
SELECT DISTINCT f.value:"confidence"::FLOAT AS "cropConfidence"
    FROM THE_MET.THE_MET.VISION_API_DATA t,
    LATERAL FLATTEN(input => t."cropHintsAnnotation":"cropHints") f
    WHERE f.value:"confidence" IS NOT NULL
    LIMIT 1000;
Answer:
cropConfidence
0.8999999761581421
0.29999998211860657
0.7999999523162842
0.5
1.0
0.5999999642372131
0.699999988079071
Query:
SELECT "metadata_date", TRY_TO_DATE("metadata_date"::VARCHAR) AS "date_value"
    FROM THE_MET.THE_MET.OBJECTS
    LIMIT 1000;
Answer:
Too long, hard cut:
metadata_date,date_value
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,2017-02-06
1486368016000000,20
Query:
SELECT t."object_id", f.value:"confidence"::FLOAT AS "cropConfidence"
    FROM THE_MET.THE_MET.VISION_API_DATA t,
    LATERAL FLATTEN(input => t."cropHintsAnnotation":"cropHints") f
    WHERE f.value:"confidence"::FLOAT > 0.5
    LIMIT 1000;
Answer:
Too long, hard cut:
object_id,cropConfidence
395469,1.0
342852,1.0
717610,1.0
400806,1.0
398754,1.0
436661,1.0
650943,1.0
193649,1.0
308544,1.0
37881,1.0
371350,1.0
480520,1.0
469947,1.0
291865,1.0
391445,1.0
339498,1.0
342882,1.0
342608,1.0
306752,1.0
271733,1.0
73626,1.0
372777,1.0
365590,1.0
10791,1.0
364281,1.0
365693,1.0
10928,1.0
387577,1.0
370771,1.0
37186,1.0
393209,1.0
337266,1.0
388957,1.0
394628,1.0
339515,1.0
414492,1.0
383921,1.0
410182,1.0
369156,1.0
348596,1.0
678732,1.0
203203,1.0
340976,1.0
261016,1.0
410050,1.0
400836,1.0
467466,1.0
467935,1.0
409982,1.0
414746,1.0
334626,1.0
254207,1.0
4249,1.0
4199,1.0
4209,1.0
4241,1.0
435719,1.0
11603,1.0
56748,1.0
403635,1.0
340262,1.0
15089,1.0
685801,1.0
397498,1.0
472322,1.0
471962,1.0
460419,1.0
260285,1.0
726543,1.0
366993,1.0
55968,1.0
285781,1.0
544689,1.0
394436,1.0
50799,1.0
345808,1.0
208998,1.0
189298,1.0
623053,1.0
391175,1.0
53926,1.0
435834,1.0
322367,1.0
412823,1.0
387572,1.0
73555,1.0
339492,1.0
357054,1.0
414695,1.0
391517,1.0
392595,1.0
428774,1.0
10466,1.0
335405,1.0
371555,1.0
368343,1.0
261801,1.0
54624,1.0
394340,1.0
285465,1.0
54870,1.0
194110,1.0
428755,1.0
196160,1.0
15025,1.0
549533,1.0
263193,1.0
242193,1.0
343111,1.0
189551,1.0
465955,1.0
737547,1.0
363904,1.0
364069,1.0
54499,1.0
470282,1.0
288515,1.0
337263,1.0
45241,1.0
645240,1.0
416247,1.0
348790,1.0
339554,1.0
250968,1.0
206819,1.0
543873,1.0
471055,1.0
623067,1.0
463536,1.0
286038,1.0
467486,1.0
386444,1.0
343968,1.0
288535,1.0
17449,1.0
343402,1.0
261387,1.0
342591,1.0
263135,1.0
361703,1.0
729624,1.0
385957,1.0
659124,1.0
345721,1.0
196356,1.0
339707,1.0
367415,1.0
398595,1.0
55574,1.0
197750,1.0
229095,1.0
471848,1.0
436731,1.0
198587,1.0
340058,1.0
349162,1.0
452670,1.0
342501,1.0
37895,1.0
399212,1.0
54652,1.0
11777,1.0
459002,1.0
11372,1.0
397694,1.0
206589,1.0
338515,1.0
364382,1.0
436770,1.0
10401,1.0
64534,1.0
471995,1.0
385089,1.0
342748,1.0
436911,1.0
102243,1.0
11798,1.0
11707,1.0
437490,1.0
438820,1.0
437703,1.0
475487,1.0
459040,1.0
291887,1.0
436664,1.0
463545,1.0
191777,1.0
349309,1.0
467808,1.0
205239,1.0
58026,1.0
269254,1.0
428639,1.0
260058,1.0
237070,1.0
260182,1.0
237754,1.0
45445,1.0
60060,1.0
403086,1.0
700206,1.0
371456,1.0
464151,1.0
187761,1.0
188903,1.0
398499,1.0
204625,1.0
206168,1.0
434111,1.0
393331,1.0
362267,1.0
16665,1.0
288561,1.0
250549,1.0
343201,1.0
1683,1.0
387537,1.0
391793,1.0
399237,1.0
14942,1.0
55423,1.0
195760,1.0
260113,1.0
37125,1.0
364839,1.0
366887,1.0
463765,1.0
451972,1.0
189163,1.0
56753,1.0
203111,1.0
190623,1.0
360642,1.0
202343,1.0
36707,1.0
189644,1.0
382454,1.0
56027,1.0
390689,1.0
59185,1.0
189700,1.0
194324,1.0
386145,1.0
642888,1.0
431358,1.0
302131,1.0
46445,1.0
268128,1.0
51416,1.0
286615,1.0
387541,1.0
367468,1.0
392932,1.0
434603,1.0
260140,1.0
269271,1.0
437069,1.0
460208,1.0
473465,1.0
156808,1.0
464299,1.0
204722,1.0
454344,1.0
36654,1.0
41933,1.0
438026,1.0
11274,1.0
189712,1.0
383935,1.0
63832,1.0
399691,1.0
442749,1.0
625354,1.0
38582,1.0
339119,1.0
55199,1.0
342463,1.0
227026,1.0
407167,1.0
704827,1.0
435691,1.0
436738,1.0
337665,1.0
377467,1.0
459019,1.0
271746,1.0
631422,1.0
436759,1.0
365816,1.0
12731,1.0
451283,1.0
208809,1.0
399545,1.0
249164,1.0
435766,1.0
73439,1.0
339543,1.0
10337,1.0
459015,1.0
437422,1.0
667926,1.0
459023,1.0
249232,1.0
435702,1.0
467508,1.0
435754,1.0
391053,1.0
350970,1.0
369533,1.0
453683,1.0
356476,1.0
436103,1.0
488733,1.0
10389,1.0
58263,1.0
37993,1.0
436892,1.0
656826,1.0
392687,1.0
359151,1.0
337761,1.0
361613,1.0
730790,1.0
286173,1.0
269253,1.0
344140,1.0
260348,1.0
388833,1.0
712946,1.0
260126,1.0
436900,1.0
339559,1.0
342502,1.0
54660,1.0
437004,1.0
194541,1.0
260175,0.5999999642372131
363737,1.0
2783,1.0
452125,1.0
199486,1.0
716639,1.0
54849,1.0
310365,1.0
37807,1.0
436802,1.0
389888,1.0
551108,1.0
435653,1.0
471218,1.0
435763,1.0
436835,1.0
266256,1.0
437268,1.0
436850,1.0
12552,1.0
200564,1.0
260352,1.0
198903,1.0
190119,1.0
335497,1.0
294508,1.0
461549,1.0
206726,1.0
386450,1.0
464286,1.0
471559,1.0
679466,1.0
189944,1.0
471122,1.0
193428,1.0
203376,1.0
187556,1.0
5207,1.0
446583,1.0
11471,1.0
44377,1.0
44384,1.0
682991,1.0
396179,1.0
55419,1.0
44365,1.0
56024,1.0
471557,1.0
459205,1.0
12563,1.0
261590,1.0
198277,1.0
337168,1.0
506089,1.0
374026,1.0
36607,1.0
467941,1.0
341201,1.0
349127,1.0
437866,1.0
206049,1.0
242318,1.0
633310,1.0
10961,1.0
343310,1.0
252916,1.0
288159,1.0
205109,1.0
38481,1.0
55320,1.0
11842,1.0
193822,1.0
11408,1.0
348978,1.0
670559,1.0
395879,1.0
38646,1.0
55397,1.0
436190,1.0
207814,1.0
255899,1.0
367190,1.0
54819,1.0
470265,1.0
250655,1.0
206873,1.0
10970,1.0
459399,1.0
359089,1.0
11489,1.0
435709,1.0
53181,1.0
254915,1.0
406441,1.0
56602,1.0
103035,1.0
633569,1.0
11512,1.0
646609,1.0
242375,1.0
192720,1.0
385670,1.0
288528,1.0
231788,1.0
207397,1.0
45494,1.0
204169,1.0
335536,1.0
469877,1.0
12707,1.0
54678,1.0
469719,1.0
403218,1.0
548343,1.0
436205,1.0
251493,1.0
358785,1.0
436912,1.0
205413,1.0
406435,1.0
205461,1.0
452121,1.0
428022,1.0
191486
Query:
SELECT MIN("metadata_date") AS "min_date", MAX("metadata_date") AS "max_date"
    FROM THE_MET.THE_MET.OBJECTS;
Answer:
min_date,max_date
1486368016000000,1486368016000000
End Exploring Related Columns
Task: Retrieve the object id, title, and the formatted metadata date (as a string in 'YYYY-MM-DD' format) for objects in the "The Libraries" department where the cropConfidence is greater than 0.5, the object's title contains the word "book".

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: SELECT S."Column_Name" FROM {Database Name}.{Schema Name}.{Table_name} (ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
object_id,title,metadata_date
object_id1:int,title1:str,YYYY-MM-DD
object_id2:int,title2:str,YYYY-MM-DD
...
```

This table lists the `object_id`, `title`, and formatted `metadata_date` (in 'YYYY-MM-DD' format) for objects in the "The Libraries" department where the `cropConfidence` is greater than 0.5 and the object's title contains the word "book"..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'THE_MET': {'THE_MET': ['IMAGES', 'OBJECTS', 'VISION_API_DATA']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-19 10:05:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 10:05:32 - root - INFO - ```sql
SELECT
    o."object_id",
    o."title",
    TO_VARCHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1000000), 'YYYY-MM-DD') AS "metadata_date"
FROM
    THE_MET.THE_MET.OBJECTS o
JOIN
    THE_MET.THE_MET.VISION_API_DATA v ON o."object_id" = v."object_id",
    LATERAL FLATTEN(input => v."cropHintsAnnotation":"cropHints") f
WHERE
    f.value:"confidence"::FLOAT > 0.5
    AND o."department" = 'The Libraries'
    AND o."title" ILIKE '%book%';
```
2025-01-19 10:05:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 10:05:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 10:05:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 10:05:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-19 10:05:33 - snowflake.connector.connection - INFO - closed
2025-01-19 10:05:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 10:05:33 - root - INFO - itercount: 1
2025-01-19 10:05:33 - root - INFO - 0
2025-01-19 10:05:33 - root - INFO - results: 
object_id,title,metadata_date
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc.",2017-02-06
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06


2025-01-19 10:05:33 - root - INFO - Please check the answer again by reviewing Retrieve the object id, title, and the formatted metadata date (as a string in 'YYYY-MM-DD' format) for objects in the "The Libraries" department where the cropConfidence is greater than 0.5, the object's title contains the word "book"., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
object_id,title,metadata_date
object_id1:int,title1:str,YYYY-MM-DD
object_id2:int,title2:str,YYYY-MM-DD
...
```

This table lists the `object_id`, `title`, and formatted `metadata_date` (in 'YYYY-MM-DD' format) for objects in the "The Libraries" department where the `cropConfidence` is greater than 0.5 and the object's title contains the word "book". The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
object_id,title,metadata_date
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc.",2017-02-06
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
Current sql:
SELECT
    o."object_id",
    o."title",
    TO_VARCHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1000000), 'YYYY-MM-DD') AS "metadata_date"
FROM
    THE_MET.THE_MET.OBJECTS o
JOIN
    THE_MET.THE_MET.VISION_API_DATA v ON o."object_id" = v."object_id",
    LATERAL FLATTEN(input => v."cropHintsAnnotation":"cropHints") f
WHERE
    f.value:"confidence"::FLOAT > 0.5
    AND o."department" = 'The Libraries'
    AND o."title" ILIKE '%book%';For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'

2025-01-19 10:06:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 10:06:08 - root - INFO - ```sql
SELECT
    o."object_id",
    o."title",
    TO_VARCHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1000000), 'YYYY-MM-DD') AS "metadata_date"
FROM
    THE_MET.THE_MET.OBJECTS o
JOIN
    THE_MET.THE_MET.VISION_API_DATA v ON o."object_id" = v."object_id",
    LATERAL FLATTEN(input => v."cropHintsAnnotation":"cropHints") f
WHERE
    f.value:"confidence"::FLOAT > 0.5
    AND o."department" = 'The Libraries'
    AND o."title" LIKE '%book%';
```
2025-01-19 10:06:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 10:06:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 10:06:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 10:06:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 4
2025-01-19 10:06:09 - snowflake.connector.connection - INFO - closed
2025-01-19 10:06:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 10:06:10 - root - INFO - itercount: 2
2025-01-19 10:06:10 - root - INFO - 0
2025-01-19 10:06:10 - root - INFO - results: 
object_id,title,metadata_date
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06


2025-01-19 10:06:10 - root - INFO - Please check the answer again by reviewing Retrieve the object id, title, and the formatted metadata date (as a string in 'YYYY-MM-DD' format) for objects in the "The Libraries" department where the cropConfidence is greater than 0.5, the object's title contains the word "book"., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
object_id,title,metadata_date
object_id1:int,title1:str,YYYY-MM-DD
object_id2:int,title2:str,YYYY-MM-DD
...
```

This table lists the `object_id`, `title`, and formatted `metadata_date` (in 'YYYY-MM-DD' format) for objects in the "The Libraries" department where the `cropConfidence` is greater than 0.5 and the object's title contains the word "book". The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
object_id,title,metadata_date
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
Current sql:
SELECT
    o."object_id",
    o."title",
    TO_VARCHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1000000), 'YYYY-MM-DD') AS "metadata_date"
FROM
    THE_MET.THE_MET.OBJECTS o
JOIN
    THE_MET.THE_MET.VISION_API_DATA v ON o."object_id" = v."object_id",
    LATERAL FLATTEN(input => v."cropHintsAnnotation":"cropHints") f
WHERE
    f.value:"confidence"::FLOAT > 0.5
    AND o."department" = 'The Libraries'
    AND o."title" LIKE '%book%';For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'

2025-01-19 10:06:43 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 10:06:43 - root - INFO - ```sql
SELECT
    o."object_id",
    o."title",
    TO_VARCHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1000000), 'YYYY-MM-DD') AS "metadata_date"
FROM
    THE_MET.THE_MET.OBJECTS o
JOIN
    THE_MET.THE_MET.VISION_API_DATA v ON o."object_id" = v."object_id",
    LATERAL FLATTEN(input => v."cropHintsAnnotation":"cropHints") f
WHERE
    f.value:"confidence"::FLOAT > 0.5
    AND o."department" = 'The Libraries'
    AND o."title" LIKE '%book%';
```

```csv
object_id,title,metadata_date
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,"The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans",2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
```
2025-01-19 10:06:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-19 10:06:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-19 10:06:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-19 10:06:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 4
2025-01-19 10:06:45 - snowflake.connector.connection - INFO - closed
2025-01-19 10:06:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-19 10:06:45 - root - INFO - itercount: 3
2025-01-19 10:06:45 - root - INFO - 0
2025-01-19 10:06:45 - root - INFO - Total iteration counts: 3
